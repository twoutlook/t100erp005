<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<add_points prog="aglt420" std_prog="aglt420" erpver="1.0" module="AGL" ver="1" env="s" zone="t10prd" booking="Y" type="M" identity="s" section_flag="N" designer_ver="1.0">
  <other>
    <code_template value="F" status=""/>
    <free_style value="N" status=""/>
    <start_arg value="" status=""/>
  </other>
  <point name="function.aglt420_glceld_desc" order="1" ver="1" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 查詢帳套相關資料
# Memo...........:
# Usage..........: CALL aglt420_glceld_desc(p_glaald)
#                  RETURNING 回传参数
# Input parameter: 
# Return code....: 
# Date & Author..: 
# Modify.........:
################################################################################
PRIVATE FUNCTION aglt420_glceld_desc(p_glaald)
   DEFINE p_glaald    LIKE glaa_t.glaald
   
    INITIALIZE g_ref_fields TO NULL
    LET g_ref_fields[1] = p_glaald 
    CALL ap_ref_array2(g_ref_fields,"SELECT glaal002 FROM glaal_t WHERE glaalent='"||g_enterprise||"' AND glaalld=? AND glaal001='"||g_dlang||"'","") RETURNING g_rtn_fields
    LET g_glce_m.glceld_desc=g_rtn_fields[1]
    #依据对应的主账套编码，抓取对应法人，币别，汇率参照编号，会计科目参照编号,关账日期
   SELECT glaacomp,glaa001,glaa002,glaa003,glaa004,glaa005,glaa013,
          glaa015,glaa016,glaa017,glaa018,glaa019,glaa020,
          glaa021,glaa022,glaa025,glaa026,glaa121
     INTO g_glaacomp,g_glaa001,g_glaa002,g_glaa003,g_glaa004,g_glaa005,g_glaa013,
          g_glaa015,g_glaa016,g_glaa017,g_glaa018,g_glaa019,g_glaa020,
          g_glaa021,g_glaa022,g_glaa025,g_glaa026,g_glaa121
     FROM glaa_t
    WHERE glaaent = g_enterprise
      AND glaald = p_glaald 
   LET g_glce_m.glcecomp = g_glaacomp
   LET g_glce_m.glaa001 = g_glaa001
   LET g_glce_m.glaa016 = g_glaa016
   LET g_glce_m.glaa020 = g_glaa020
   
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] =g_glce_m.glcecomp
   CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_glce_m.glcecomp_desc= g_rtn_fields[1]
   
   #取本幣的金额小數位數
   CALL s_curr_sel_ooaj004(g_glaa026,g_glce_m.glaa001) RETURNING g_ooaj004
   IF g_glaa015 = 'Y' THEN
      CALL cl_set_comp_visible("glaa016,page_3",TRUE)
      #取本位幣二的金额小數位數
      CALL s_curr_sel_ooaj004(g_glaa026,g_glce_m.glaa016) RETURNING g_ooaj004_2
   ELSE                                    
      CALL cl_set_comp_visible("glaa016,page_3",FALSE)
   END IF                                  
                                           
   IF g_glaa019 = 'Y' THEN                 
      CALL cl_set_comp_visible("glaa020,page_4",TRUE)
      #取本位幣三的金额小數位數
      CALL s_curr_sel_ooaj004(g_glaa026,g_glce_m.glaa020) RETURNING g_ooaj004_3
   ELSE                                    
      CALL cl_set_comp_visible("glaa020,page_4",FALSE)
   END IF
END FUNCTION]]>
  </point>
  <point name="function.aglt420_insert_glcf" order="2" ver="1" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 自動產生單身glcf_t資料
# Memo...........:
# Usage..........: CALL aglt420_insert_glcf()
#                  RETURNING r_success
# Input parameter: 
# Return code....: 
# Date & Author..: 
# Modify.........:
################################################################################
PRIVATE FUNCTION aglt420_insert_glcf()
   DEFINE r_success           LIKE type_t.num5
   DEFINE l_glcf              RECORD LIKE glcf_t.*
   DEFINE l_sql               STRING
   DEFINE l_date              LIKE type_t.dat
   DEFINE l_glab005_1         LIKE glab_t.glab005
   DEFINE l_glab005_2         LIKE glab_t.glab005
   DEFINE l_cnt               LIKE type_t.num5
   #固定核算项
   DEFINE l_glad007           LIKE glad_t.glad007     #部門管理否
   DEFINE l_glad008           LIKE glad_t.glad008     #利潤成本中心管理
   DEFINE l_glad009           LIKE glad_t.glad009     #區域管理
   DEFINE l_glad010           LIKE glad_t.glad010     #交易客商管理
   DEFINE l_glad027           LIKE glad_t.glad027     #账款客商管理
   DEFINE l_glad011           LIKE glad_t.glad011     #客群管理否
   DEFINE l_glad012           LIKE glad_t.glad012     #產品類別
   DEFINE l_glad013           LIKE glad_t.glad013     #人員
   DEFINE l_glad015           LIKE glad_t.glad015     #专案管理否
   DEFINE l_glad016           LIKE glad_t.glad016     #wbs管理
   DEFINE l_glad031           LIKE glad_t.glad031     #經營方式管理否
   DEFINE l_glad032           LIKE glad_t.glad032     #渠道管理否
   DEFINE l_glad033           LIKE glad_t.glad033     #品牌管理否
   #自由核算项                 
   DEFINE l_glad017           LIKE glad_t.glad017     #自由核算项一
   DEFINE l_glad018           LIKE glad_t.glad018     #自由核算项二
   DEFINE l_glad019           LIKE glad_t.glad019     #自由核算项三
   DEFINE l_glad020           LIKE glad_t.glad020     #自由核算项四
   DEFINE l_glad021           LIKE glad_t.glad021     #自由核算项五
   DEFINE l_glad022           LIKE glad_t.glad022     #自由核算项六
   DEFINE l_glad023           LIKE glad_t.glad023     #自由核算项七
   DEFINE l_glad024           LIKE glad_t.glad024     #自由核算项八
   DEFINE l_glad025           LIKE glad_t.glad025     #自由核算项九
   DEFINE l_glad026           LIKE glad_t.glad026     #自由核算项十
   
   LET l_cnt = 0
   SELECT COUNT(*) INTO l_cnt FROM glcd_t 
   WHERE glcdent = g_enterprise AND glcdld = g_glce_m.glceld
   IF l_cnt = 0 THEN
      INITIALIZE g_errparam TO NULL 
      LET g_errparam.extend = g_glce_m.glceld,'/',g_glce_m.glce001,'/',g_glce_m.glce002
      LET g_errparam.code   = 'agl-00294'
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      RETURN FALSE
   END IF
   
   #重評價匯兌收益
   SELECT glab005 INTO l_glab005_1 FROM glab_t
    WHERE glabent = g_enterprise AND glabld = g_glce_m.glceld 
     AND glab001 = '25' AND glab002 = '8318' AND glab003 = '8318_11'
   #重評價匯兌損失  
   SELECT glab005 INTO l_glab005_2 FROM glab_t
    WHERE glabent = g_enterprise AND glabld = g_glce_m.glceld 
      AND glab001 = '25' AND glab002 = '8318' AND glab003 = '8318_12'
   IF cl_null(l_glab005_1) OR cl_null(l_glab005_2) THEN
      INITIALIZE g_errparam TO NULL 
      LET g_errparam.extend = l_glcf.glcfld
      LET g_errparam.code   = 'agl-00293'
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      RETURN FALSE
   END IF
   
   LET r_success = TRUE
   CALL cl_err_collect_init()
   #抓取當期最後一天
   SELECT MAX(glav004) INTO l_date FROM glav_t
    WHERE glavent=g_enterprise AND glav001=g_glaa003
      AND glav002=g_glce_m.glce001 AND glav006=g_glce_m.glce002
             
   LET l_sql="SELECT glar001,glar009,glar012,glar013,glar014,glar015,glar016,glar017,glar018,",
             "       glar019,glar051,glar052,glar053,glar020,glar022,glar023,glar024,glar025,",
             "       glar026,glar027,glar028,glar029,glar030,glar031,glar032,glar033,",
             "       SUM(glar010-glar011),",
             "       SUM(glar005-glar006),SUM(glar034-glar035),SUM(glar036-glar037)",
             "  FROM glar_t",
             " WHERE glarent = ",g_enterprise," AND glarld ='",g_glce_m.glceld,"'",
             "   AND glar002 = ",g_glce_m.glce001," AND glar003 <= ",g_glce_m.glce002,
             "   AND glar001 IN (SELECT glcd001 FROM glcd_t ",
             "                    WHERE glcdent = ",g_enterprise," AND glcdld = '",g_glce_m.glceld,"'",
             "                  )",
             "   AND glar009 <> '",g_glaa001,"'",
             " GROUP BY glar001,glar009,glar012,glar013,glar014,glar015,glar016,glar017,glar018,",
             "          glar019,glar051,glar052,glar053,glar020,glar022,glar023,glar024,glar025,",
             "          glar026,glar027,glar028,glar029,glar030,glar031,glar032,glar033 ",
             " ORDER BY glar001,glar009,glar012,glar013,glar014,glar015,glar016,glar017,glar018,",
             "          glar019,glar051,glar052,glar053,glar020,glar022,glar023,glar024,glar025,",
             "          glar026,glar027,glar028,glar029,glar030,glar031,glar032,glar033 "
             
   PREPARE aglt420_sel_glar_pr FROM l_sql
   DECLARE aglt420_sel_glar_cs CURSOR FOR aglt420_sel_glar_pr
   
   INITIALIZE l_glcf.* TO NULL
   LET l_glcf.glcfent = g_enterprise
   LET l_glcf.glcfcomp= g_glce_m.glcecomp
   LET l_glcf.glcfld  = g_glce_m.glceld
   LET l_glcf.glcf001 = g_glce_m.glce001
   LET l_glcf.glcf002 = g_glce_m.glce002
   #摘要
   LET l_glcf.glcf072 = g_glce_m.glce004
   LET l_glcf.glcf073 = g_glce_m.glce004
   
   FOREACH aglt420_sel_glar_cs INTO l_glcf.glcf003,l_glcf.glcf005,
                                    l_glcf.glcf023,l_glcf.glcf024,l_glcf.glcf025,l_glcf.glcf026,
                                    l_glcf.glcf027,l_glcf.glcf028,l_glcf.glcf029,l_glcf.glcf030,
                                    l_glcf.glcf031,l_glcf.glcf032,l_glcf.glcf033,l_glcf.glcf034,
                                    l_glcf.glcf035,l_glcf.glcf036,l_glcf.glcf037,l_glcf.glcf038,
                                    l_glcf.glcf039,l_glcf.glcf040,l_glcf.glcf041,l_glcf.glcf042,
                                    l_glcf.glcf043,l_glcf.glcf044,l_glcf.glcf045,l_glcf.glcf046,
                                    l_glcf.glcf006,l_glcf.glcf008,l_glcf.glcf013,l_glcf.glcf018
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = 'FOREACH'
         LET g_errparam.code   = SQLCA.sqlcode
         LET g_errparam.popup  = FALSE 
         CALL cl_err()
         EXIT FOREACH
      END IF
      
      #原幣餘額
      IF l_glcf.glcf006 < 0 THEN #餘額在貸方
         LET l_glcf.glcf007 = l_glcf.glcf006 * (-1) 
         LET l_glcf.glcf006 = 0
      ELSE #餘額在借方
         LET l_glcf.glcf007 = 0
      END IF
      #本幣餘額
      IF l_glcf.glcf008 < 0 THEN #餘額在貸方
         LET l_glcf.glcf009 = l_glcf.glcf008 * (-1)
         LET l_glcf.glcf008 = 0
      ELSE #餘額在借方
         LET l_glcf.glcf009 = 0
      END IF
      #重估本位币一汇率/本位幣二匯率/本位幣三匯率
      CALL s_fin_get_exchange_rate(l_glcf.glcfld,l_glcf.glcf001,l_glcf.glcf002,l_glcf.glcf005,'31')
      RETURNING  l_glcf.glcf010,l_glcf.glcf015,l_glcf.glcf020
      #重估餘額
      LET l_glcf.glcf011 = (l_glcf.glcf006 + l_glcf.glcf007) * l_glcf.glcf010
      CALL s_num_round('1',l_glcf.glcf011,g_ooaj004) RETURNING l_glcf.glcf011
      #匯兌損益
      #LET l_glcf.glcf012 = l_glcf.glcf011 - (l_glcf.glcf008 + l_glcf.glcf009)
      ##晓峰确认调整逻辑
      ##若原币是借方余额,则汇差=重估的金额-本币借方余额
      ##若原币是贷方金额,则汇差=重估的金额-本币贷方余额
      LET l_glcf.glcf012 = 0
      IF l_glcf.glcf006 > 0 AND l_glcf.glcf007 = 0 THEN  #原币余额在借方
         IF l_glcf.glcf008 > 0 THEN
            LET l_glcf.glcf012 = l_glcf.glcf011 - l_glcf.glcf008
         ELSE
            LET l_glcf.glcf012 = l_glcf.glcf011 + l_glcf.glcf009
         END IF
      END IF
      IF l_glcf.glcf007 > 0 AND l_glcf.glcf006 = 0 THEN  #原币余额在贷方
         IF l_glcf.glcf009 > 0 THEN
            LET l_glcf.glcf012 = l_glcf.glcf011 - l_glcf.glcf009
         ELSE
            LET l_glcf.glcf012 = l_glcf.glcf011 + l_glcf.glcf008
         END IF
      END IF
      #當匯兌損益=0時，無需記錄
      IF l_glcf.glcf012 = 0 THEN
         CONTINUE FOREACH
      END IF
      
      #本位币二
      IF g_glaa015 = 'Y' THEN
         IF l_glcf.glcf013 < 0 THEN
            LET l_glcf.glcf014 = l_glcf.glcf013 * (-1)
            LET l_glcf.glcf013 = 0
         ELSE
            LET l_glcf.glcf014 = 0
         END IF
         #重估本位币二汇率
         IF g_glaa017='1' THEN #依交易原幣轉換
            #重估餘額
            LET l_glcf.glcf016 = (l_glcf.glcf006 + l_glcf.glcf007) * l_glcf.glcf015
         ELSE #依帳簿幣別
            #重估餘額
            LET l_glcf.glcf016 = (l_glcf.glcf008 + l_glcf.glcf009) * l_glcf.glcf015
         END IF
         CALL s_num_round('1',l_glcf.glcf016,g_ooaj004_2) RETURNING l_glcf.glcf016
         #匯兌損益
         LET l_glcf.glcf017 = l_glcf.glcf016 - (l_glcf.glcf013 +l_glcf.glcf014)
      ELSE
         LET l_glcf.glcf013 = 0
         LET l_glcf.glcf014 = 0
         LET l_glcf.glcf015 = 0
         LET l_glcf.glcf016 = 0
         LET l_glcf.glcf017 = 0
      END IF
      #本位币三
      IF g_glaa019 = 'Y' THEN
         IF l_glcf.glcf018 < 0 THEN
            LET l_glcf.glcf019 = l_glcf.glcf018 * (-1)
            LET l_glcf.glcf018 = 0
         ELSE
            LET l_glcf.glcf019 = 0
         END IF
         #重估本位币二汇率
         IF g_glaa021='1' THEN #依交易原幣轉換
            #重估餘額
            LET l_glcf.glcf021 = (l_glcf.glcf006 + l_glcf.glcf007) * l_glcf.glcf020
         ELSE #依帳簿幣別
            #重估餘額
            LET l_glcf.glcf021 = (l_glcf.glcf008 + l_glcf.glcf009) * l_glcf.glcf020
         END IF
         CALL s_num_round('1',l_glcf.glcf021,g_ooaj004_3) RETURNING l_glcf.glcf021
         #匯兌損益
         LET l_glcf.glcf022 = l_glcf.glcf021 - (l_glcf.glcf018 +l_glcf.glcf019) 
      ELSE
         LET l_glcf.glcf018 = 0
         LET l_glcf.glcf019 = 0
         LET l_glcf.glcf020 = 0
         LET l_glcf.glcf021 = 0
         LET l_glcf.glcf022 = 0
      END IF
      
      #匯出科目
      IF l_glcf.glcf012 > 0 THEN
         LET l_glcf.glcf047 = l_glab005_1
      ELSE
         LET l_glcf.glcf047 = l_glab005_2
      END IF
      
      #组合码
      LET l_glcf.glcf004 = l_glcf.glcf005,l_glcf.glcf023
      #启用固定核算项
      CALL s_voucher_fix_acc_open_chk(g_glce_m.glceld,l_glcf.glcf003)
      RETURNING l_glad007,l_glad008,l_glad009,l_glad010,l_glad027,l_glad011,l_glad012,l_glad013,l_glad015,l_glad016,l_glad031,l_glad032,l_glad033
        
      #启用自由核算项
      SELECT glad017,glad018,glad019,glad020,glad021,glad022,glad023,glad024,glad025,glad026
        INTO l_glad017,l_glad018,l_glad019,l_glad020,l_glad021,l_glad022,l_glad023,l_glad024,l_glad025,l_glad026
        FROM glad_t
       WHERE gladent = g_enterprise AND gladld = g_glce_m.glceld AND glad001 = l_glcf.glcf003
       
      #該科目做部門管理時
      IF l_glad007 = 'Y' THEN
         IF cl_null(l_glcf.glcf024) THEN
            LET l_glcf.glcf024 = ' '
         END IF 
         LET l_glcf.glcf004 = l_glcf.glcf004,l_glcf.glcf024    
      END IF
       
      #該科目做利潤成本管理時
      IF l_glad008 = 'Y' THEN
         IF cl_null(l_glcf.glcf025) THEN
            LET l_glcf.glcf025 = ' '
         END IF
         LET l_glcf.glcf004 = l_glcf.glcf004,l_glcf.glcf025    
      END IF
      
      #該科目做區域管理時 
      IF l_glad009 = 'Y' THEN
         IF cl_null(l_glcf.glcf026) THEN
            LET l_glcf.glcf026 = ' '
         END IF
         LET l_glcf.glcf004 = l_glcf.glcf004,l_glcf.glcf026
      END IF
          
      #做交易客商管理
      IF l_glad010 = 'Y' THEN
         IF cl_null(l_glcf.glcf027) THEN
            LET l_glcf.glcf027 = ' '
         END IF
         LET l_glcf.glcf004 = l_glcf.glcf004,l_glcf.glcf027
      END IF
          
      #做账款客商管理
      IF l_glad027 = 'Y' THEN
         IF cl_null(l_glcf.glcf028) THEN
            LET l_glcf.glcf028 = ' '
         END IF
         LET l_glcf.glcf004 = l_glcf.glcf004,l_glcf.glcf028
      END IF  
       
      #該科目做客群管理時
      IF l_glad011 = 'Y' THEN
         IF cl_null(l_glcf.glcf029) THEN
            LET l_glcf.glcf029 = ' '
         END IF
         LET l_glcf.glcf004 = l_glcf.glcf004,l_glcf.glcf029
      END IF
          
      #該科目做產品分類管理時，不可空白  
      IF l_glad012 = 'Y' THEN
         IF cl_null(l_glcf.glcf030) THEN
            LET l_glcf.glcf030 = ' '
         END IF
         LET l_glcf.glcf004 = l_glcf.glcf004,l_glcf.glcf030
      END IF
      
      #該科目做經營方式管理時，不可空白  
      IF l_glad031 = 'Y' THEN
         IF cl_null(l_glcf.glcf031) THEN
            LET l_glcf.glcf031 = ' '
         END IF       
         LET l_glcf.glcf004 = l_glcf.glcf004,l_glcf.glcf031
      END IF
      
      #該科目做渠道管理時，不可空白  
      IF l_glad032 = 'Y' THEN
         IF cl_null(l_glcf.glcf032) THEN
            LET l_glcf.glcf032 = ' '
         END IF       
         LET l_glcf.glcf004 = l_glcf.glcf004,l_glcf.glcf032
      END IF
      
      #該科目做品牌管理時，不可空白  
      IF l_glad033 = 'Y' THEN
         IF cl_null(l_glcf.glcf033) THEN
            LET l_glcf.glcf033 = ' '
         END IF       
         LET l_glcf.glcf004 = l_glcf.glcf004,l_glcf.glcf033
      END IF
         
      #該科目做人員管理時，不可空白  
      IF l_glad013 = 'Y' THEN
         IF cl_null(l_glcf.glcf034) THEN
            LET l_glcf.glcf034 = ' '
         END IF
         LET l_glcf.glcf004 = l_glcf.glcf004,l_glcf.glcf034
      END IF
         
      #該科目做專案管理時，不可空白  
      IF l_glad015 = 'Y' THEN
         IF cl_null(l_glcf.glcf035) THEN
            LET l_glcf.glcf035 = ' '
         END IF
         LET l_glcf.glcf004 = l_glcf.glcf004,l_glcf.glcf035
      END IF
      #該科目做WBS管理時，不可空白  
      IF l_glad016 = 'Y' THEN
         IF cl_null(l_glcf.glcf036) THEN
            LET l_glcf.glcf036 = ' '
         END IF
         LET l_glcf.glcf004 = l_glcf.glcf004,l_glcf.glcf036
      END IF
          
      #该科目启用自由核算项一
      IF l_glad017 = 'Y'  THEN 
         IF cl_null(l_glcf.glcf037) THEN
            LET l_glcf.glcf037 = ' '
         END IF 
         LET l_glcf.glcf004 = l_glcf.glcf004,l_glcf.glcf037
      END IF
      
      #该科目启用自由核算项二
      IF l_glad018 = 'Y'  THEN
         IF cl_null(l_glcf.glcf038) THEN
            LET l_glcf.glcf038 = ' '
         END IF 
         LET l_glcf.glcf004 = l_glcf.glcf004,l_glcf.glcf038
      END IF

      #该科目启用自由核算项三
      IF l_glad019 = 'Y'  THEN
         IF cl_null(l_glcf.glcf039) THEN
            LET l_glcf.glcf039 = ' '
         END IF 
         LET l_glcf.glcf004 = l_glcf.glcf004,l_glcf.glcf039
      END IF
      
      #该科目启用自由核算项四
      IF l_glad020 = 'Y'  THEN
         IF cl_null(l_glcf.glcf040) THEN
            LET l_glcf.glcf040 = ' '
         END IF 
         LET l_glcf.glcf004 = l_glcf.glcf004,l_glcf.glcf040
      END IF
      
       #该科目启用自由核算项五
      IF l_glad021 = 'Y'  THEN
         IF cl_null(l_glcf.glcf041) THEN
            LET l_glcf.glcf041 = ' '
         END IF 
         LET l_glcf.glcf004 = l_glcf.glcf004,l_glcf.glcf041
      END IF
      
      #该科目启用自由核算项六
      IF l_glad022 = 'Y'  THEN
         IF cl_null(l_glcf.glcf042) THEN
            LET l_glcf.glcf042 = ' '
         END IF 
         LET l_glcf.glcf004 = l_glcf.glcf004,l_glcf.glcf042
      END IF
       
      #该科目启用自由核算项七
      IF l_glad023 = 'Y'  THEN
         IF cl_null(l_glcf.glcf043) THEN
            LET l_glcf.glcf043 = ' '
         END IF 
         LET l_glcf.glcf004 = l_glcf.glcf004,l_glcf.glcf043
      END IF
      
      #该科目启用自由核算项八
      IF l_glad024 = 'Y'  THEN
         IF cl_null(l_glcf.glcf044) THEN
            LET l_glcf.glcf044 = ' '
         END IF 
         LET l_glcf.glcf004 = l_glcf.glcf004,l_glcf.glcf044
      END IF
   
      #该科目启用自由核算项九
      IF l_glad025 = 'Y'  THEN
         IF cl_null(l_glcf.glcf045) THEN
            LET l_glcf.glcf045 = ' '
         END IF 
         LET l_glcf.glcf004 = l_glcf.glcf004,l_glcf.glcf045
      END IF
          
      #该科目启用自由核算项十
      IF l_glad026 = 'Y'  THEN
         IF cl_null(l_glcf.glcf046) THEN
            LET l_glcf.glcf046 = ' '
         END IF 
         LET l_glcf.glcf004 = l_glcf.glcf004,l_glcf.glcf046
      END IF
      
      #匯差科目
      #启用固定核算项
      CALL s_voucher_fix_acc_open_chk(g_glce_m.glceld,l_glcf.glcf047)
      RETURNING l_glad007,l_glad008,l_glad009,l_glad010,l_glad027,l_glad011,l_glad012,l_glad013,l_glad015,l_glad016,l_glad031,l_glad032,l_glad033
        
      #启用自由核算项
      SELECT glad017,glad018,glad019,glad020,glad021,glad022,glad023,glad024,glad025,glad026
        INTO l_glad017,l_glad018,l_glad019,l_glad020,l_glad021,l_glad022,l_glad023,l_glad024,l_glad025,l_glad026
        FROM glad_t
       WHERE gladent = g_enterprise AND gladld = g_glce_m.glceld AND glad001 = l_glcf.glcf047
       
      #營運據點
      LET l_glcf.glcf048 = l_glcf.glcf023
      #該科目做部門管理
      IF l_glad007 <> 'Y' OR l_glad007 IS NULL THEN
         LET l_glcf.glcf049 = ' ' 
      ELSE
         LET l_glcf.glcf049 = l_glcf.glcf024
         IF cl_null(l_glcf.glcf049) THEN
            LET l_glcf.glcf049 = g_glce_m.glce003
         END IF         
         IF cl_null(l_glcf.glcf049) THEN
            #依據登入用戶抓取所在部門
            SELECT ooag003 INTO l_glcf.glcf049 FROM ooag_t
             WHERE ooagent = g_enterprise
               AND ooag001 = g_user
         END IF
      END IF 
      #該科目做利潤成本管理時
      IF l_glad008 <> 'Y' OR l_glad008 IS NULL THEN
         LET l_glcf.glcf050 = ' '   
      ELSE
         LET l_glcf.glcf050 = l_glcf.glcf025
         IF cl_null(l_glcf.glcf050) THEN
            SELECT ooeg004 INTO l_glcf.glcf050 FROM ooeg_t 
             WHERE ooegent = g_enterprise 
               AND ooeg001 = (SELECT ooag003 FROM ooag_t WHERE ooagent = g_enterprise AND ooag001 = g_user)
         END IF
      END IF 
      #該科目做區域管理時
      IF l_glad009 <> 'Y' OR l_glad009 IS NULL THEN
         LET l_glcf.glcf051 = ' '
      ELSE
         LET l_glcf.glcf051 = l_glcf.glcf026
         IF cl_null(l_glcf.glcf051) THEN
            CALL s_voucher_get_fix_default_value(l_glcf.glcfld,l_glcf.glcf047,'4') RETURNING l_glcf.glcf051
         END IF
      END IF 
      #該科目做客商管理
      IF l_glad010 <> 'Y' OR l_glad010 IS NULL THEN
         LET l_glcf.glcf052 = ' '
      ELSE
         LET l_glcf.glcf052 = l_glcf.glcf027
         IF cl_null(l_glcf.glcf052) THEN
            CALL s_voucher_get_fix_default_value(l_glcf.glcfld,l_glcf.glcf047,'5') RETURNING l_glcf.glcf052
         END IF
      END IF 
      #該科目做账款客商管理時
      IF l_glad027 <> 'Y' OR l_glad027 IS NULL THEN
         LET l_glcf.glcf053 = ' '
      ELSE
         LET l_glcf.glcf053 = l_glcf.glcf028
         IF cl_null(l_glcf.glcf053) THEN
            CALL s_voucher_get_fix_default_value(l_glcf.glcfld,l_glcf.glcf047,'6') RETURNING l_glcf.glcf053
         END IF
      END IF 
      #該科目做客群管理時
      IF l_glad011 <> 'Y' OR l_glad011 IS NULL THEN
         LET l_glcf.glcf054 = ' '     
      ELSE
         LET l_glcf.glcf054 = l_glcf.glcf029
         IF cl_null(l_glcf.glcf054) THEN
            CALL s_voucher_get_fix_default_value(l_glcf.glcfld,l_glcf.glcf047,'7') RETURNING l_glcf.glcf054
         END IF   
      END IF 
      #該科目做產品分類管理時，
      IF l_glad012 <> 'Y' OR l_glad012 IS NULL THEN
         LET l_glcf.glcf055 = ' '    
      ELSE
         LET l_glcf.glcf055 = l_glcf.glcf030
         IF cl_null(l_glcf.glcf055) THEN
            CALL s_voucher_get_fix_default_value(l_glcf.glcfld,l_glcf.glcf047,'8') RETURNING l_glcf.glcf055
         END IF
      END IF 
      #該科目做经营方式管理時，
      IF l_glad031 <> 'Y' OR l_glad031 IS NULL THEN
         LET l_glcf.glcf056 = ' '   
      ELSE
         LET l_glcf.glcf056 = l_glcf.glcf031
         IF cl_null(l_glcf.glcf056) THEN
            CALL s_voucher_get_fix_default_value(l_glcf.glcfld,l_glcf.glcf047,'9') RETURNING l_glcf.glcf056
         END IF
      END IF
      #該科目做渠道管理時，
      IF l_glad032 <> 'Y' OR l_glad032 IS NULL THEN
         LET l_glcf.glcf057 = ' '    
      ELSE
         LET l_glcf.glcf057 = l_glcf.glcf032
         IF cl_null(l_glcf.glcf057) THEN
            CALL s_voucher_get_fix_default_value(l_glcf.glcfld,l_glcf.glcf047,'10') RETURNING l_glcf.glcf057
         END IF
      END IF
      #該科目做品牌管理時，
      IF l_glad033 <> 'Y' OR l_glad033 IS NULL THEN
         LET l_glcf.glcf058 = ' '    
      ELSE
         LET l_glcf.glcf058 = l_glcf.glcf033
         IF cl_null(l_glcf.glcf058) THEN
            CALL s_voucher_get_fix_default_value(l_glcf.glcfld,l_glcf.glcf047,'11') RETURNING l_glcf.glcf058
         END IF
      END IF
      #該科目做人員管理時，
      IF l_glad013 <> 'Y' OR l_glad013 IS NULL THEN
         LET l_glcf.glcf059 = ' '    
      ELSE
         LET l_glcf.glcf059 = l_glcf.glcf034
         IF cl_null(l_glcf.glcf059) THEN
            LET l_glcf.glcf059 = g_user
         END IF
      END IF 
      #該科目做專案管理時，
      IF l_glad015 <> 'Y' OR l_glad015 IS NULL THEN
         LET l_glcf.glcf060 = ' '     
      ELSE
         LET l_glcf.glcf060= l_glcf.glcf035
         IF cl_null(l_glcf.glcf060) THEN
            CALL s_voucher_get_fix_default_value(l_glcf.glcfld,l_glcf.glcf047,'13') RETURNING l_glcf.glcf060
         END IF 
      END IF 
      #該科目做WBS管理時，
      IF l_glad016 <> 'Y' OR l_glad016 IS NULL THEN
         LET l_glcf.glcf061 = ' '   
      ELSE
         LET l_glcf.glcf061= l_glcf.glcf036
         IF cl_null(l_glcf.glcf061) THEN
            CALL s_voucher_get_fix_default_value(l_glcf.glcfld,l_glcf.glcf047,'14') RETURNING l_glcf.glcf061
         END IF
      END IF 
      #核算项一
      IF l_glad017 <> 'Y' OR l_glad017 IS NULL THEN
         LET l_glcf.glcf062 = ' '   
      ELSE
         LET l_glcf.glcf062= l_glcf.glcf037
         IF cl_null(l_glcf.glcf062) THEN
            CALL s_voucher_get_fix_default_value(l_glcf.glcfld,l_glcf.glcf047,'15') RETURNING l_glcf.glcf062
         END IF
      END IF 
      #核算项二
      IF l_glad018 <> 'Y' OR l_glad018 IS NULL THEN
         LET l_glcf.glcf063 = ' '   
      ELSE
         LET l_glcf.glcf063= l_glcf.glcf038
         IF cl_null(l_glcf.glcf063) THEN
            CALL s_voucher_get_fix_default_value(l_glcf.glcfld,l_glcf.glcf047,'16') RETURNING l_glcf.glcf063
         END IF
      END IF
      #核算项三
      IF l_glad019 <> 'Y' OR l_glad019 IS NULL THEN
         LET l_glcf.glcf064 = ' '  
      ELSE
         LET l_glcf.glcf064= l_glcf.glcf039
         IF cl_null(l_glcf.glcf064) THEN
            CALL s_voucher_get_fix_default_value(l_glcf.glcfld,l_glcf.glcf047,'17') RETURNING l_glcf.glcf064
         END IF   
      END IF
      #核算项四
      IF l_glad020 <> 'Y' OR l_glad020 IS NULL THEN
         LET l_glcf.glcf065 = ' '   
      ELSE
         LET l_glcf.glcf065= l_glcf.glcf040
         IF cl_null(l_glcf.glcf065) THEN
            CALL s_voucher_get_fix_default_value(l_glcf.glcfld,l_glcf.glcf047,'18') RETURNING l_glcf.glcf065
         END IF
      END IF
      #核算项五
      IF l_glad021 <> 'Y' OR l_glad021 IS NULL THEN
         LET l_glcf.glcf066 = ' '   
      ELSE
         LET l_glcf.glcf066= l_glcf.glcf041
         IF cl_null(l_glcf.glcf066) THEN
            CALL s_voucher_get_fix_default_value(l_glcf.glcfld,l_glcf.glcf047,'19') RETURNING l_glcf.glcf066
         END IF
      END IF
      #核算项四六
      IF l_glad022 <> 'Y' OR l_glad022 IS NULL THEN
         LET l_glcf.glcf067 = ' '   
      ELSE
         LET l_glcf.glcf067= l_glcf.glcf042
         IF cl_null(l_glcf.glcf067) THEN
            CALL s_voucher_get_fix_default_value(l_glcf.glcfld,l_glcf.glcf047,'20') RETURNING l_glcf.glcf067
         END IF
      END IF
      #核算项七
      IF l_glad023 <> 'Y' OR l_glad023 IS NULL THEN
         LET l_glcf.glcf068 = ' '   
      ELSE
         LET l_glcf.glcf068= l_glcf.glcf043
         IF cl_null(l_glcf.glcf068) THEN
            CALL s_voucher_get_fix_default_value(l_glcf.glcfld,l_glcf.glcf047,'21') RETURNING l_glcf.glcf068
         END IF
      END IF
      #核算项八
      IF l_glad024 <> 'Y' OR l_glad024 IS NULL THEN
         LET l_glcf.glcf069 = ' '   
      ELSE
         LET l_glcf.glcf069= l_glcf.glcf044
         IF cl_null(l_glcf.glcf069) THEN
            CALL s_voucher_get_fix_default_value(l_glcf.glcfld,l_glcf.glcf047,'22') RETURNING l_glcf.glcf069
         END IF
      END IF
      #核算项九
      IF l_glad025 <> 'Y' OR l_glad025 IS NULL THEN
         LET l_glcf.glcf070 = ' '   
      ELSE
         LET l_glcf.glcf070= l_glcf.glcf045
         IF cl_null(l_glcf.glcf070) THEN
            CALL s_voucher_get_fix_default_value(l_glcf.glcfld,l_glcf.glcf047,'23') RETURNING l_glcf.glcf070
         END IF
      END IF
      #核算项十
      IF l_glad026 <> 'Y' OR l_glad026 IS NULL THEN
         LET l_glcf.glcf071 = ' '   
      ELSE
         LET l_glcf.glcf071= l_glcf.glcf046
         IF cl_null(l_glcf.glcf071) THEN
            CALL s_voucher_get_fix_default_value(l_glcf.glcfld,l_glcf.glcf047,'24') RETURNING l_glcf.glcf071
         END IF
      END IF
      
      INSERT INTO glcf_t(glcfent,glcfcomp,glcfld,glcf001,glcf002,glcf003,
                         glcf004,glcf005,glcf006,glcf007,glcf008,glcf009,
                         glcf010,glcf011,glcf012,glcf013,glcf014,glcf015,
                         glcf016,glcf017,glcf018,glcf019,glcf020,glcf021,
                         glcf022,glcf023,glcf024,glcf025,glcf026,glcf027,
                         glcf028,glcf029,glcf030,glcf031,glcf032,glcf033,
                         glcf034,glcf035,glcf036,glcf037,glcf038,glcf039,
                         glcf040,glcf041,glcf042,glcf043,glcf044,glcf045,
                         glcf046,glcf047,glcf048,glcf049,glcf050,glcf051,
                         glcf052,glcf053,glcf054,glcf055,glcf056,glcf057,
                         glcf058,glcf059,glcf060,glcf061,glcf062,glcf063,
                         glcf064,glcf065,glcf066,glcf067,glcf068,glcf069,
                         glcf070,glcf071,glcf072,glcf073)
      VALUES(l_glcf.glcfent,l_glcf.glcfcomp,l_glcf.glcfld,l_glcf.glcf001,l_glcf.glcf002,l_glcf.glcf003,
             l_glcf.glcf004,l_glcf.glcf005,l_glcf.glcf006,l_glcf.glcf007,l_glcf.glcf008,l_glcf.glcf009,
             l_glcf.glcf010,l_glcf.glcf011,l_glcf.glcf012,l_glcf.glcf013,l_glcf.glcf014,l_glcf.glcf015,
             l_glcf.glcf016,l_glcf.glcf017,l_glcf.glcf018,l_glcf.glcf019,l_glcf.glcf020,l_glcf.glcf021,
             l_glcf.glcf022,l_glcf.glcf023,l_glcf.glcf024,l_glcf.glcf025,l_glcf.glcf026,l_glcf.glcf027,
             l_glcf.glcf028,l_glcf.glcf029,l_glcf.glcf030,l_glcf.glcf031,l_glcf.glcf032,l_glcf.glcf033,
             l_glcf.glcf034,l_glcf.glcf035,l_glcf.glcf036,l_glcf.glcf037,l_glcf.glcf038,l_glcf.glcf039,
             l_glcf.glcf040,l_glcf.glcf041,l_glcf.glcf042,l_glcf.glcf043,l_glcf.glcf044,l_glcf.glcf045,
             l_glcf.glcf046,l_glcf.glcf047,l_glcf.glcf048,l_glcf.glcf049,l_glcf.glcf050,l_glcf.glcf051,
             l_glcf.glcf052,l_glcf.glcf053,l_glcf.glcf054,l_glcf.glcf055,l_glcf.glcf056,l_glcf.glcf057,
             l_glcf.glcf058,l_glcf.glcf059,l_glcf.glcf060,l_glcf.glcf061,l_glcf.glcf062,l_glcf.glcf063,
             l_glcf.glcf064,l_glcf.glcf065,l_glcf.glcf066,l_glcf.glcf067,l_glcf.glcf068,l_glcf.glcf069,
             l_glcf.glcf070,l_glcf.glcf071,l_glcf.glcf072,l_glcf.glcf073)
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = 'ins glcf_t'
         LET g_errparam.code   = SQLCA.sqlcode
         LET g_errparam.popup  = FALSE 
         CALL cl_err()
         LET r_success = FALSE
      END IF
   END FOREACH
   
   #判断是否有需要重评价的科目
   LET l_cnt=0
   SELECT COUNT(*) INTO l_cnt FROM glcf_t
   WHERE glcfent=g_enterprise AND glcfld=g_glce_m.glceld 
   AND glcf001=g_glce_m.glce001 AND glcf002=g_glce_m.glce002
   IF l_cnt=0 THEN
      INITIALIZE g_errparam TO NULL 
      LET g_errparam.extend = g_glce_m.glceld,'/',g_glce_m.glce001,'/',g_glce_m.glce002
      LET g_errparam.code   = 'agl-00294'
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET r_success = FALSE
   END IF
   
   IF r_success = FALSE THEN
      CALL cl_err_collect_show()
   END IF
   RETURN r_success
END FUNCTION]]>
  </point>
  <point name="function.aglt420_glcf003_desc" order="3" ver="1" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 科目說明
# Memo...........:
# Usage..........: CALL aglt420_glcf003_desc()
#                  RETURNING r_desc
# Input parameter: 
# Return code....: 
# Date & Author..: 
# Modify.........:
################################################################################
PRIVATE FUNCTION aglt420_glcf003_desc()
   DEFINE l_glaq002_desc      LIKE glacl_t.glacl004
   DEFINE r_glaq002           STRING
   DEFINE r_str               STRING
   DEFINE l_desc              STRING
   
   #抓取科目名称
   LET l_glaq002_desc = ''
   SELECT glacl004 INTO l_glaq002_desc FROM glacl_t
    WHERE glaclent = g_enterprise
      AND glacl001 = g_glaa004
      AND glacl002 = g_glcf_d[l_ac].glcf003
      AND glacl003 = g_dlang   
   #组合名称以及核算项
   LET r_glaq002 = ''
   LET r_str = ''
   SELECT glcf023,glcf024,glcf025,glcf026,glcf027,
          glcf028,glcf029,glcf030,glcf031,glcf032,
          glcf033,glcf034,glcf035,glcf036
     INTO g_glce_m.glcf023,g_glce_m.glcf024,g_glce_m.glcf025,g_glce_m.glcf026,g_glce_m.glcf027,
          g_glce_m.glcf028,g_glce_m.glcf029,g_glce_m.glcf030,g_glce_m.glcf031,g_glce_m.glcf032,
          g_glce_m.glcf033,g_glce_m.glcf034,g_glce_m.glcf035,g_glce_m.glcf036
     FROM glcf_t
    WHERE glcfent=g_enterprise AND glcfld=g_glce_m.glceld AND glcf001=g_glce_m.glce001
      AND glcf002=g_glce_m.glce002 AND glcf003=g_glcf_d[l_ac].glcf003
      AND glcf004=g_glcf_d[l_ac].glcf004 AND glcf005=g_glcf_d[l_ac].glcf005
#   #營運據點
#   IF NOT cl_null(g_glce_m.glcf023) THEN
#      CALL s_desc_get_department_desc(g_glce_m.glcf023) RETURNING g_glce_m.glcf023_desc
#      LET r_glaq002 = g_glce_m.glcf023_desc    
#      LET r_str=g_glce_m.glcf023   
#   END IF
   #部门
   IF NOT cl_null(g_glce_m.glcf024) THEN
      CALL s_desc_get_department_desc(g_glce_m.glcf024) RETURNING g_glce_m.glcf024_desc
      IF NOT cl_null(r_glaq002) THEN
         LET r_glaq002 = r_glaq002 ,'-',g_glce_m.glcf024_desc
      ELSE
         LET r_glaq002 = g_glce_m.glcf024_desc
      END IF
      IF NOT cl_null(r_str) THEN
         LET r_str=r_str,'-',g_glce_m.glcf024
      ELSE
         LET r_str=g_glce_m.glcf024
      END IF    
   END IF 
   #成本利润中心
   IF NOT cl_null(g_glce_m.glcf025) THEN
      CALL s_desc_get_department_desc(g_glce_m.glcf025) RETURNING g_glce_m.glcf025_desc
      IF NOT cl_null(r_glaq002) THEN
         LET r_glaq002 = r_glaq002 ,'-',g_glce_m.glcf025_desc
      ELSE
         LET r_glaq002 = g_glce_m.glcf025_desc
      END IF
      IF NOT cl_null(r_str) THEN
         LET r_str=r_str,'-',g_glce_m.glcf025
      ELSE
         LET r_str=g_glce_m.glcf025
      END IF
   END IF 
   
   #区域
   IF NOT cl_null(g_glce_m.glcf026) THEN 
      CALL s_desc_get_acc_desc('287',g_glce_m.glcf026) RETURNING g_glce_m.glcf026_desc   
      IF NOT cl_null(r_glaq002) THEN
         LET r_glaq002 = r_glaq002 ,'-',g_glce_m.glcf026_desc
      ELSE
         LET r_glaq002 = g_glce_m.glcf026_desc
      END IF
      IF NOT cl_null(r_str) THEN
         LET r_str=r_str,'-',g_glce_m.glcf026
      ELSE
         LET r_str=g_glce_m.glcf026
      END IF      
   END IF 
   #交易客商
   IF NOT cl_null(g_glce_m.glcf027) THEN
      CALL s_desc_get_trading_partner_abbr_desc(g_glce_m.glcf027) RETURNING g_glce_m.glcf027_desc
      IF NOT cl_null(r_glaq002) THEN
         LET r_glaq002 = r_glaq002 ,'-',g_glce_m.glcf027_desc
      ELSE
         LET r_glaq002 = g_glce_m.glcf027_desc
      END IF 
      IF NOT cl_null(r_str) THEN
         LET r_str=r_str,'-',g_glce_m.glcf027
      ELSE
         LET r_str=g_glce_m.glcf027
      END IF      
   END IF 
   #帐款客商
   IF NOT cl_null(g_glce_m.glcf028) THEN
      CALL s_desc_get_trading_partner_abbr_desc(g_glce_m.glcf028) RETURNING g_glce_m.glcf028_desc
      IF NOT cl_null(r_glaq002) THEN
         LET r_glaq002 = r_glaq002 ,'-',g_glce_m.glcf028_desc
      ELSE
         LET r_glaq002 = g_glce_m.glcf028_desc
      END IF
      IF NOT cl_null(r_str) THEN
         LET r_str=r_str,'-',g_glce_m.glcf028
      ELSE
         LET r_str=g_glce_m.glcf028
      END IF      
   END IF 
   #客群
   IF NOT cl_null(g_glce_m.glcf029) THEN
      CALL s_desc_get_acc_desc('281',g_glce_m.glcf029) RETURNING g_glce_m.glcf029_desc
      IF NOT cl_null(r_glaq002) THEN
         LET r_glaq002 = r_glaq002 ,'-',g_glce_m.glcf029_desc
      ELSE
         LET r_glaq002 = g_glce_m.glcf029_desc
      END IF
      IF NOT cl_null(r_str) THEN
         LET r_str=r_str,'-',g_glce_m.glcf029
      ELSE
         LET r_str=g_glce_m.glcf029
      END IF      
   END IF 
   
   #產品分類
   IF NOT cl_null(g_glce_m.glcf030) THEN
      CALL s_desc_get_rtaxl003_desc(g_glce_m.glcf030) RETURNING g_glce_m.glcf030_desc
      IF NOT cl_null(r_glaq002) THEN
         LET r_glaq002 = r_glaq002 ,'-',g_glce_m.glcf030_desc
      ELSE
         LET r_glaq002 = g_glce_m.glcf030_desc
      END IF
      IF NOT cl_null(r_str) THEN
         LET r_str=r_str,'-',g_glce_m.glcf030
      ELSE
         LET r_str=g_glce_m.glcf030
      END IF      
   END IF 
   
   #經營方式
   IF NOT cl_null(g_glce_m.glcf031) THEN
      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = '6013'
      LET g_ref_fields[2] = g_glce_m.glcf031
      CALL ap_ref_array2(g_ref_fields,"SELECT gzcbl004 FROM gzcbl_t WHERE gzcbl001=? AND gzcbl002=? AND gzcbl003='"||g_dlang||"'","") RETURNING g_rtn_fields
      LET l_desc = g_rtn_fields[1]
      
      IF NOT cl_null(r_glaq002) THEN
         LET r_glaq002 = r_glaq002 ,'-',l_desc
      ELSE
         LET r_glaq002 = l_desc
      END IF
      IF NOT cl_null(r_str) THEN
         LET r_str=r_str,'-',g_glce_m.glcf031
      ELSE
         LET r_str=g_glce_m.glcf031
      END IF      
   END IF 
   
   #渠道
   IF NOT cl_null(g_glce_m.glcf032) THEN
      CALL s_desc_get_oojdl003_desc(g_glce_m.glcf032) RETURNING g_glce_m.glcf032_desc
      IF NOT cl_null(r_glaq002) THEN
         LET r_glaq002 = r_glaq002 ,'-',g_glce_m.glcf032_desc
      ELSE
         LET r_glaq002 = g_glce_m.glcf032_desc
      END IF
      IF NOT cl_null(r_str) THEN
         LET r_str=r_str,'-',g_glce_m.glcf032
      ELSE
         LET r_str=g_glce_m.glcf032
      END IF      
   END IF 
   
   #品牌
   IF NOT cl_null(g_glce_m.glcf033) THEN
      CALL s_desc_get_acc_desc('2002',g_glce_m.glcf033) RETURNING g_glce_m.glcf033_desc
      IF NOT cl_null(r_glaq002) THEN
         LET r_glaq002 = r_glaq002 ,'-',g_glce_m.glcf033_desc
      ELSE
         LET r_glaq002 = g_glce_m.glcf033_desc
      END IF
      IF NOT cl_null(r_str) THEN
         LET r_str=r_str,'-',g_glce_m.glcf033
      ELSE
         LET r_str=g_glce_m.glcf033
      END IF      
   END IF 
   
   #人员
   IF NOT cl_null(g_glce_m.glcf034) THEN
       CALL s_desc_get_person_desc(g_glce_m.glcf034) RETURNING g_glce_m.glcf034_desc
      IF NOT cl_null(r_glaq002) THEN
         LET r_glaq002 = r_glaq002 ,'-',g_glce_m.glcf034_desc
      ELSE
         LET r_glaq002 = g_glce_m.glcf034_desc
      END IF
      IF NOT cl_null(r_str) THEN
         LET r_str=r_str,'-',g_glce_m.glcf034
      ELSE
         LET r_str=g_glce_m.glcf034
      END IF      
   END IF 

   #专案编号
   IF NOT cl_null(g_glce_m.glcf035) THEN
      CALL s_desc_get_project_desc(g_glce_m.glcf035) RETURNING g_glce_m.glcf035_desc
      IF NOT cl_null(r_glaq002) THEN
         LET r_glaq002 = r_glaq002 ,'-',g_glce_m.glcf035_desc
      ELSE
         LET r_glaq002 = g_glce_m.glcf035_desc
      END IF
      IF NOT cl_null(r_str) THEN
         LET r_str=r_str,'-',g_glce_m.glcf035
      ELSE
         LET r_str=g_glce_m.glcf035
      END IF      
   END IF 
   #WBS
   IF NOT cl_null(g_glce_m.glcf036) THEN
      CALL s_desc_get_wbs_desc(g_glce_m.glcf035,g_glce_m.glcf036) RETURNING g_glce_m.glcf036_desc
      IF NOT cl_null(r_glaq002) THEN
         LET r_glaq002 = r_glaq002 ,'-',g_glce_m.glcf036_desc
      ELSE
         LET r_glaq002 = g_glce_m.glcf036_desc
      END IF
      IF NOT cl_null(r_str) THEN
         LET r_str=r_str,'-',g_glce_m.glcf036
      ELSE
         LET r_str=g_glce_m.glcf036
      END IF      
   END IF 
   #组合科目名称以及核算项
   LET r_glaq002 = l_glaq002_desc,'\n',
                   r_glaq002
   IF NOT cl_null(r_str) THEN
      LET r_str="(",r_str,")"
   END IF                
   RETURN r_glaq002,r_str            
END FUNCTION]]>
  </point>
  <point name="function.aglt420_set_fix_visible" order="4" ver="1" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 設置匯差頁簽核算項顯示
# Memo...........:
# Usage..........: CALL aglt420_set_fix_visible(p_glcf047)
#                  RETURNING 回传参数
# Input parameter: 
# Return code....: 
# Date & Author..: 
# Modify.........:
################################################################################
PRIVATE FUNCTION aglt420_set_fix_visible(p_glcf047)
   DEFINE p_glcf047       LIKE glcf_t.glcf047
   DEFINE l_glad007       LIKE glad_t.glad007     #部門管理否
   DEFINE l_glad008       LIKE glad_t.glad008     #利潤成本中心管理
   DEFINE l_glad009       LIKE glad_t.glad009     #區域管理
   DEFINE l_glad010       LIKE glad_t.glad010     #交易客商管理
   DEFINE l_glad027       LIKE glad_t.glad027     #账款客商管理
   DEFINE l_glad011       LIKE glad_t.glad011     #客群管理否
   DEFINE l_glad012       LIKE glad_t.glad012     #產品類別
   DEFINE l_glad013       LIKE glad_t.glad013     #人員
   DEFINE l_glad015       LIKE glad_t.glad015     #专案管理否
   DEFINE l_glad016       LIKE glad_t.glad016     #wbs管理
   DEFINE l_glad031       LIKE glad_t.glad031     #經營方式管理否
   DEFINE l_glad032       LIKE glad_t.glad032     #渠道管理否
   DEFINE l_glad033       LIKE glad_t.glad033     #品牌管理否
   #自由核算項
   DEFINE l_glad017       LIKE glad_t.glad017 
   DEFINE l_glad018       LIKE glad_t.glad018
   DEFINE l_glad019       LIKE glad_t.glad019
   DEFINE l_glad020       LIKE glad_t.glad020
   DEFINE l_glad021       LIKE glad_t.glad021
   DEFINE l_glad022       LIKE glad_t.glad022
   DEFINE l_glad023       LIKE glad_t.glad023
   DEFINE l_glad024       LIKE glad_t.glad024
   DEFINE l_glad025       LIKE glad_t.glad025
   DEFINE l_glad026       LIKE glad_t.glad026
   
   SELECT glad007,glad008,glad009,glad010,glad027,glad011,glad012,glad013,
          glad015,glad016,glad031,glad032,glad033,
          glad017,glad018,glad019,glad020,glad021,glad022,
          glad023,glad024,glad025,glad026            
     INTO l_glad007,l_glad008,l_glad009,l_glad010,l_glad027,l_glad011,l_glad012,l_glad013,
          l_glad015,l_glad016,l_glad031,l_glad032,l_glad033,
          l_glad017,l_glad018,l_glad019,l_glad020,l_glad021,l_glad022,
          l_glad023,l_glad024,l_glad025,l_glad026
     FROM glad_t
   WHERE gladent = g_enterprise
     AND gladld = g_glce_m.glceld
     AND glad001 = p_glcf047
   #部門
   IF l_glad007 = 'Y' THEN
      CALL cl_set_comp_visible("glcf049_desc",TRUE)
   END IF
   #利潤/成本中心
   IF l_glad008 = 'Y' THEN
      CALL cl_set_comp_visible("glcf050_desc",TRUE)
   END IF
   #區域
   IF l_glad009 = 'Y' THEN
      CALL cl_set_comp_visible("glcf051_desc",TRUE)
   END IF
   #交易客商
   IF l_glad010 = 'Y' THEN
      CALL cl_set_comp_visible("glcf052_desc",TRUE)
   END IF
   #账款客商
   IF l_glad027 = 'Y' THEN
      CALL cl_set_comp_visible("glcf053_desc",TRUE)
   END IF
   #客群
   IF l_glad011 = 'Y' THEN
      CALL cl_set_comp_visible("glcf054_desc",TRUE)
   END IF
   #產品類別
   IF l_glad012 = 'Y' THEN
      CALL cl_set_comp_visible("glcf055_desc",TRUE)
   END IF
   #經營方式
   IF l_glad031 = 'Y' THEN
      CALL cl_set_comp_visible("glcf056",TRUE)
   END IF
   #渠道
   IF l_glad032 = 'Y' THEN
      CALL cl_set_comp_visible("glcf057_desc",TRUE)
   END IF
   #品牌
   IF l_glad033 = 'Y' THEN
      CALL cl_set_comp_visible("glcf058_desc",TRUE)
   END IF
   #人員
   IF l_glad013 = 'Y' THEN
      CALL cl_set_comp_visible("glcf059_desc",TRUE)
   END IF
   #专案
   IF l_glad015 = 'Y' THEN
      CALL cl_set_comp_visible("glcf060",TRUE)
   END IF
   #WBS
   IF l_glad016 = 'Y' THEN
      CALL cl_set_comp_visible("glcf061",TRUE)
   END IF
   #自由核算項一
   IF l_glad017 = 'Y' THEN
      CALL cl_set_comp_visible("glcf062_desc",TRUE)
   END IF
   #自由核算項二
   IF l_glad018 = 'Y' THEN
      CALL cl_set_comp_visible("glcf063_desc",TRUE)
   END IF
   #自由核算項三
   IF l_glad019 = 'Y' THEN
      CALL cl_set_comp_visible("glcf064_desc",TRUE)
   END IF
   #自由核算項四
   IF l_glad020 = 'Y' THEN
      CALL cl_set_comp_visible("glcf065_desc",TRUE)
   END IF
   #自由核算項五
   IF l_glad021 = 'Y' THEN
      CALL cl_set_comp_visible("glcf066_desc",TRUE)
   END IF
   #自由核算項六
   IF l_glad022 = 'Y' THEN
      CALL cl_set_comp_visible("glcf067_desc",TRUE)
   END IF
   #自由核算項七
   IF l_glad023 = 'Y' THEN
      CALL cl_set_comp_visible("glcf068_desc",TRUE)
   END IF
   #自由核算項八
   IF l_glad024 = 'Y' THEN
      CALL cl_set_comp_visible("glcf069_desc",TRUE)
   END IF
   #自由核算項九
   IF l_glad025 = 'Y' THEN
      CALL cl_set_comp_visible("glcf070_desc",TRUE)
   END IF
   #自由核算項十
   IF l_glad026 = 'Y' THEN
      CALL cl_set_comp_visible("glcf071_desc",TRUE)
   END IF
END FUNCTION]]>
  </point>
  <point name="function.aglt420_frozen_show" order="5" ver="1" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 畫面凍結部分--核算項顯示
# Memo...........:
# Usage..........: CALL aglt420_frozen_show()
#                  RETURNING 回传参数
# Input parameter: 
# Return code....: 
# Date & Author..: 
# Modify.........:
################################################################################
PRIVATE FUNCTION aglt420_frozen_show()
   DEFINE l_glad001         LIKE glad_t.glad001
   DEFINE l_desc            STRING
   
   IF l_ac<=0 THEN
      RETURN
   END IF
   LET g_aw = g_curr_diag.getCurrentItem()
   IF g_aw <> "s_detail4" THEN
      SELECT glcf023,glcf024,glcf025,glcf026,glcf027,
             glcf028,glcf029,glcf030,glcf031,glcf032,
             glcf033,glcf034,glcf035,glcf036,
             glcf037,glcf038,glcf039,glcf040,glcf041,
             glcf042,glcf043,glcf044,glcf045,glcf046
        INTO g_glce_m.glcf023,g_glce_m.glcf024,g_glce_m.glcf025,g_glce_m.glcf026,g_glce_m.glcf027,
             g_glce_m.glcf028,g_glce_m.glcf029,g_glce_m.glcf030,g_glce_m.glcf031,g_glce_m.glcf032,
             g_glce_m.glcf033,g_glce_m.glcf034,g_glce_m.glcf035,g_glce_m.glcf036,
             g_glce_m.glcf037,g_glce_m.glcf038,g_glce_m.glcf039,g_glce_m.glcf040,g_glce_m.glcf041,
             g_glce_m.glcf042,g_glce_m.glcf043,g_glce_m.glcf044,g_glce_m.glcf045,g_glce_m.glcf046
        FROM glcf_t
       WHERE glcfent=g_enterprise AND glcfld=g_glce_m.glceld AND glcf001=g_glce_m.glce001
         AND glcf002=g_glce_m.glce002 AND glcf003=g_glcf_d[l_ac].glcf003
         AND glcf004=g_glcf_d[l_ac].glcf004 AND glcf005=g_glcf_d[l_ac].glcf005
      LET l_glad001 = g_glcf_d[l_ac].glcf003
   ELSE
      LET g_glce_m.glcf023 = g_glcf4_d[l_ac].glcf048
      LET g_glce_m.glcf024 = g_glcf4_d[l_ac].glcf049
      LET g_glce_m.glcf025 = g_glcf4_d[l_ac].glcf050
      LET g_glce_m.glcf026 = g_glcf4_d[l_ac].glcf051
      LET g_glce_m.glcf027 = g_glcf4_d[l_ac].glcf052
      LET g_glce_m.glcf028 = g_glcf4_d[l_ac].glcf053
      LET g_glce_m.glcf029 = g_glcf4_d[l_ac].glcf054
      LET g_glce_m.glcf030 = g_glcf4_d[l_ac].glcf055
      LET g_glce_m.glcf031 = g_glcf4_d[l_ac].glcf056
      LET g_glce_m.glcf032 = g_glcf4_d[l_ac].glcf057
      LET g_glce_m.glcf033 = g_glcf4_d[l_ac].glcf058
      LET g_glce_m.glcf034 = g_glcf4_d[l_ac].glcf059
      LET g_glce_m.glcf035 = g_glcf4_d[l_ac].glcf060
      LET g_glce_m.glcf036 = g_glcf4_d[l_ac].glcf061
      LET g_glce_m.glcf037 = g_glcf4_d[l_ac].glcf062
      LET g_glce_m.glcf038 = g_glcf4_d[l_ac].glcf063
      LET g_glce_m.glcf039 = g_glcf4_d[l_ac].glcf064
      LET g_glce_m.glcf040 = g_glcf4_d[l_ac].glcf065
      LET g_glce_m.glcf041 = g_glcf4_d[l_ac].glcf066
      LET g_glce_m.glcf042 = g_glcf4_d[l_ac].glcf067
      LET g_glce_m.glcf043 = g_glcf4_d[l_ac].glcf068
      LET g_glce_m.glcf044 = g_glcf4_d[l_ac].glcf069
      LET g_glce_m.glcf045 = g_glcf4_d[l_ac].glcf070
      LET g_glce_m.glcf046 = g_glcf4_d[l_ac].glcf071
      LET l_glad001 = g_glcf4_d[l_ac].glcf003
   END IF
   #營運據點
   CALL s_desc_get_department_desc(g_glce_m.glcf023) RETURNING g_glce_m.glcf023_desc
   #部門
   CALL s_desc_get_department_desc(g_glce_m.glcf024) RETURNING g_glce_m.glcf024_desc
   #利潤成本中心
   CALL s_desc_get_department_desc(g_glce_m.glcf025) RETURNING g_glce_m.glcf025_desc
   #區域
   CALL s_desc_get_acc_desc('287',g_glce_m.glcf026) RETURNING g_glce_m.glcf026_desc 
   #交易客商
   CALL s_desc_get_trading_partner_abbr_desc(g_glce_m.glcf027) RETURNING g_glce_m.glcf027_desc
   #帳款客戶
   CALL s_desc_get_trading_partner_abbr_desc(g_glce_m.glcf027) RETURNING g_glce_m.glcf027_desc
   #客群
   CALL s_desc_get_acc_desc('281',g_glce_m.glcf029) RETURNING g_glce_m.glcf029_desc
   #產品分類
   CALL s_desc_get_rtaxl003_desc(g_glce_m.glcf030) RETURNING g_glce_m.glcf030_desc
   #渠道
   CALL s_desc_get_oojdl003_desc(g_glce_m.glcf032) RETURNING g_glce_m.glcf032_desc
   #品牌
   CALL s_desc_get_acc_desc('2002',g_glce_m.glcf033) RETURNING g_glce_m.glcf033_desc
   #人員
   CALL s_desc_get_person_desc(g_glce_m.glcf034) RETURNING g_glce_m.glcf034_desc
   #专案
   CALL s_desc_get_project_desc(g_glce_m.glcf035) RETURNING g_glce_m.glcf035_desc
   #WBS
   CALL s_desc_get_wbs_desc(g_glce_m.glcf035,g_glce_m.glcf036) RETURNING g_glce_m.glcf036_desc
   
   #自由核算项启用设置
   SELECT glad017,glad0171,glad0172,glad018,glad0181,glad0182,
          glad019,glad0191,glad0192,glad020,glad0201,glad0202,
          glad021,glad0211,glad0212,glad022,glad0221,glad0222,
          glad023,glad0231,glad0232,glad024,glad0221,glad0242,
          glad025,glad0251,glad0252,glad026,glad0261,glad0262
     INTO g_glad017,g_glad0171,g_glad0172,g_glad018,g_glad0181,g_glad0182,
          g_glad019,g_glad0191,g_glad0192,g_glad020,g_glad0201,g_glad0202,
          g_glad021,g_glad0211,g_glad0212,g_glad022,g_glad0221,g_glad0222,
          g_glad023,g_glad0231,g_glad0232,g_glad024,g_glad0241,g_glad0242,
          g_glad025,g_glad0251,g_glad0252,g_glad026,g_glad0261,g_glad0262
     FROM glad_t
    WHERE gladent = g_enterprise
      AND gladld = g_glce_m.glceld
      AND glad001 = l_glad001
   #自由核算項一
   CALL s_voucher_free_account_desc(g_glad0171,g_glce_m.glcf037) RETURNING l_desc
   DISPLAY l_desc TO FORMONLY.glcf037_desc
   #自由核算項二
   CALL s_voucher_free_account_desc(g_glad0181,g_glce_m.glcf038) RETURNING l_desc
   DISPLAY l_desc TO FORMONLY.glcf038_desc
   #自由核算項三
   CALL s_voucher_free_account_desc(g_glad0191,g_glce_m.glcf039) RETURNING l_desc
   DISPLAY l_desc TO FORMONLY.glcf039_desc
   #自由核算項四
   CALL s_voucher_free_account_desc(g_glad0201,g_glce_m.glcf040) RETURNING l_desc
   DISPLAY l_desc TO FORMONLY.glcf040_desc
   #自由核算項五
   CALL s_voucher_free_account_desc(g_glad0211,g_glce_m.glcf041) RETURNING l_desc
   DISPLAY l_desc TO FORMONLY.glcf041_desc
   #自由核算項六
   CALL s_voucher_free_account_desc(g_glad0221,g_glce_m.glcf042) RETURNING l_desc
   DISPLAY l_desc TO FORMONLY.glcf042_desc
   #自由核算項七
   CALL s_voucher_free_account_desc(g_glad0231,g_glce_m.glcf043) RETURNING l_desc
   DISPLAY l_desc TO FORMONLY.glcf043_desc
   #自由核算項八
   CALL s_voucher_free_account_desc(g_glad0241,g_glce_m.glcf044) RETURNING l_desc
   DISPLAY l_desc TO FORMONLY.glcf044_desc
   #自由核算項九
   CALL s_voucher_free_account_desc(g_glad0251,g_glce_m.glcf045) RETURNING l_desc
   DISPLAY l_desc TO FORMONLY.glcf045_desc
   #自由核算項十
   CALL s_voucher_free_account_desc(g_glad0261,g_glce_m.glcf046) RETURNING l_desc
   DISPLAY l_desc TO FORMONLY.glcf046_desc
   
   DISPLAY BY NAME g_glce_m.glcf023,g_glce_m.glcf023_desc,g_glce_m.glcf024,g_glce_m.glcf024_desc,
                   g_glce_m.glcf025,g_glce_m.glcf025_desc,g_glce_m.glcf026,g_glce_m.glcf026_desc,
                   g_glce_m.glcf027,g_glce_m.glcf027_desc,g_glce_m.glcf028,g_glce_m.glcf028_desc,
                   g_glce_m.glcf029,g_glce_m.glcf029_desc,g_glce_m.glcf030,g_glce_m.glcf030_desc,
                   g_glce_m.glcf031,g_glce_m.glcf032,g_glce_m.glcf032_desc,
                   g_glce_m.glcf033,g_glce_m.glcf033_desc,g_glce_m.glcf034,g_glce_m.glcf034_desc,
                   g_glce_m.glcf035,g_glce_m.glcf036,
                   g_glce_m.glcf037,g_glce_m.glcf038,g_glce_m.glcf039,g_glce_m.glcf040,g_glce_m.glcf041,
                   g_glce_m.glcf042,g_glce_m.glcf043,g_glce_m.glcf044,g_glce_m.glcf045,g_glce_m.glcf046
END FUNCTION]]>
  </point>
  <point name="function.aglt420_detail_show_2" order="6" ver="1" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 顯示匯差核算項資料
# Memo...........:
# Usage..........: CALL aglt420_detail_show_2()
#                  RETURNING 回传参数
# Input parameter: 
# Return code....: 
# Date & Author..:
# Modify.........:
################################################################################
PRIVATE FUNCTION aglt420_detail_show_2()
   IF l_ac >0 THEN
      #營運據點
      CALL s_desc_get_department_desc(g_glcf4_d[l_ac].glcf048) RETURNING g_glcf4_d[l_ac].glcf048_desc
      LET g_glcf4_d[l_ac].glcf048_desc = g_glcf4_d[l_ac].glcf048,'\n',g_glcf4_d[l_ac].glcf048_desc
      
      #部門
      CALL s_desc_get_department_desc(g_glcf4_d[l_ac].glcf049) RETURNING g_glcf4_d[l_ac].glcf049_desc
      LET g_glcf4_d[l_ac].glcf049_desc = g_glcf4_d[l_ac].glcf049,'\n',g_glcf4_d[l_ac].glcf049_desc
      
      #利潤成本中心
      CALL s_desc_get_department_desc(g_glcf4_d[l_ac].glcf050) RETURNING g_glcf4_d[l_ac].glcf050_desc
      LET g_glcf4_d[l_ac].glcf050_desc = g_glcf4_d[l_ac].glcf050,'\n',g_glcf4_d[l_ac].glcf050_desc
      
      #區域
      CALL s_desc_get_acc_desc('287',g_glcf4_d[l_ac].glcf051) RETURNING g_glcf4_d[l_ac].glcf051_desc
      LET g_glcf4_d[l_ac].glcf051_desc = g_glcf4_d[l_ac].glcf051,'\n',g_glcf4_d[l_ac].glcf051_desc
      
      #交易客商
      CALL s_desc_get_trading_partner_abbr_desc(g_glcf4_d[l_ac].glcf052) RETURNING g_glcf4_d[l_ac].glcf052_desc
      LET g_glcf4_d[l_ac].glcf052_desc = g_glcf4_d[l_ac].glcf052,'\n',g_glcf4_d[l_ac].glcf052_desc
      
      #帳款客戶
      CALL s_desc_get_trading_partner_abbr_desc(g_glcf4_d[l_ac].glcf053) RETURNING g_glcf4_d[l_ac].glcf053_desc
      LET g_glcf4_d[l_ac].glcf053_desc = g_glcf4_d[l_ac].glcf053,'\n',g_glcf4_d[l_ac].glcf053_desc
      
      #客群
      CALL s_desc_get_acc_desc('281',g_glcf4_d[l_ac].glcf054) RETURNING g_glcf4_d[l_ac].glcf054_desc
      LET g_glcf4_d[l_ac].glcf054_desc = g_glcf4_d[l_ac].glcf054,'\n',g_glcf4_d[l_ac].glcf054_desc
      
      #產品分類
      CALL s_desc_get_rtaxl003_desc(g_glcf4_d[l_ac].glcf055) RETURNING g_glcf4_d[l_ac].glcf055_desc
      LET g_glcf4_d[l_ac].glcf055_desc = g_glcf4_d[l_ac].glcf055,'\n',g_glcf4_d[l_ac].glcf055_desc
      
      #渠道
      CALL s_desc_get_oojdl003_desc(g_glcf4_d[l_ac].glcf057) RETURNING g_glcf4_d[l_ac].glcf057_desc
      LET g_glcf4_d[l_ac].glcf057_desc = g_glcf4_d[l_ac].glcf057,'\n',g_glcf4_d[l_ac].glcf057_desc
      
      #品牌
      CALL s_desc_get_acc_desc('2002',g_glcf4_d[l_ac].glcf058) RETURNING g_glcf4_d[l_ac].glcf058_desc
      LET g_glcf4_d[l_ac].glcf058_desc = g_glcf4_d[l_ac].glcf058,'\n',g_glcf4_d[l_ac].glcf058_desc
      
      #人員
      CALL s_desc_get_person_desc(g_glcf4_d[l_ac].glcf059) RETURNING g_glcf4_d[l_ac].glcf059_desc
      LET g_glcf4_d[l_ac].glcf059_desc = g_glcf4_d[l_ac].glcf059,'\n',g_glcf4_d[l_ac].glcf059_desc
      
      #专案
      CALL s_desc_get_project_desc(g_glcf4_d[l_ac].glcf060) RETURNING g_glcf4_d[l_ac].glcf060_desc
      LET g_glcf4_d[l_ac].glcf060_desc = g_glcf4_d[l_ac].glcf060,'\n',g_glcf4_d[l_ac].glcf060_desc
      
      #WBS
      CALL s_desc_get_wbs_desc(g_glcf4_d[l_ac].glcf060,g_glcf4_d[l_ac].glcf061) RETURNING g_glcf4_d[l_ac].glcf061_desc
      LET g_glcf4_d[l_ac].glcf061_desc = g_glcf4_d[l_ac].glcf061,'\n',g_glcf4_d[l_ac].glcf061_desc
      
      
      #自由核算项启用设置
      SELECT glad017,glad0171,glad0172,glad018,glad0181,glad0182,
             glad019,glad0191,glad0192,glad020,glad0201,glad0202,
             glad021,glad0211,glad0212,glad022,glad0221,glad0222,
             glad023,glad0231,glad0232,glad024,glad0221,glad0242,
             glad025,glad0251,glad0252,glad026,glad0261,glad0262
        INTO g_glad017,g_glad0171,g_glad0172,g_glad018,g_glad0181,g_glad0182,
             g_glad019,g_glad0191,g_glad0192,g_glad020,g_glad0201,g_glad0202,
             g_glad021,g_glad0211,g_glad0212,g_glad022,g_glad0221,g_glad0222,
             g_glad023,g_glad0231,g_glad0232,g_glad024,g_glad0241,g_glad0242,
             g_glad025,g_glad0251,g_glad0252,g_glad026,g_glad0261,g_glad0262
        FROM glad_t
       WHERE gladent = g_enterprise
         AND gladld = g_glce_m.glceld
         AND glad001 = g_glcf4_d[l_ac].glcf047
      #自由核算項一
      CALL s_voucher_free_account_desc(g_glad0171,g_glcf4_d[l_ac].glcf062) RETURNING g_glcf4_d[l_ac].glcf062_desc
      LET g_glcf4_d[l_ac].glcf062_desc = g_glcf4_d[l_ac].glcf062,'\n',g_glcf4_d[l_ac].glcf062_desc
      #自由核算項二
      CALL s_voucher_free_account_desc(g_glad0181,g_glcf4_d[l_ac].glcf063) RETURNING g_glcf4_d[l_ac].glcf063_desc
      LET g_glcf4_d[l_ac].glcf063_desc = g_glcf4_d[l_ac].glcf063,'\n',g_glcf4_d[l_ac].glcf063_desc
      #自由核算項三
      CALL s_voucher_free_account_desc(g_glad0191,g_glcf4_d[l_ac].glcf064) RETURNING g_glcf4_d[l_ac].glcf064_desc
      LET g_glcf4_d[l_ac].glcf064_desc = g_glcf4_d[l_ac].glcf064,'\n',g_glcf4_d[l_ac].glcf064_desc
      #自由核算項四
      CALL s_voucher_free_account_desc(g_glad0201,g_glcf4_d[l_ac].glcf065) RETURNING g_glcf4_d[l_ac].glcf065_desc
      LET g_glcf4_d[l_ac].glcf065_desc = g_glcf4_d[l_ac].glcf065,'\n',g_glcf4_d[l_ac].glcf065_desc
      #自由核算項五
      CALL s_voucher_free_account_desc(g_glad0211,g_glcf4_d[l_ac].glcf066) RETURNING g_glcf4_d[l_ac].glcf066_desc
      LET g_glcf4_d[l_ac].glcf066_desc = g_glcf4_d[l_ac].glcf066,'\n',g_glcf4_d[l_ac].glcf066_desc
      #自由核算項六
      CALL s_voucher_free_account_desc(g_glad0221,g_glcf4_d[l_ac].glcf067) RETURNING g_glcf4_d[l_ac].glcf067_desc
      LET g_glcf4_d[l_ac].glcf067_desc = g_glcf4_d[l_ac].glcf067,'\n',g_glcf4_d[l_ac].glcf067_desc
      #自由核算項七
      CALL s_voucher_free_account_desc(g_glad0231,g_glcf4_d[l_ac].glcf068) RETURNING g_glcf4_d[l_ac].glcf068_desc
      LET g_glcf4_d[l_ac].glcf068_desc = g_glcf4_d[l_ac].glcf068,'\n',g_glcf4_d[l_ac].glcf068_desc
      #自由核算項八
      CALL s_voucher_free_account_desc(g_glad0241,g_glcf4_d[l_ac].glcf069) RETURNING g_glcf4_d[l_ac].glcf069_desc
      LET g_glcf4_d[l_ac].glcf069_desc = g_glcf4_d[l_ac].glcf069,'\n',g_glcf4_d[l_ac].glcf069_desc
      #自由核算項九
      CALL s_voucher_free_account_desc(g_glad0251,g_glcf4_d[l_ac].glcf070) RETURNING g_glcf4_d[l_ac].glcf070_desc
      LET g_glcf4_d[l_ac].glcf070_desc = g_glcf4_d[l_ac].glcf070,'\n',g_glcf4_d[l_ac].glcf070_desc
      #自由核算項十
      CALL s_voucher_free_account_desc(g_glad0261,g_glcf4_d[l_ac].glcf071) RETURNING g_glcf4_d[l_ac].glcf071_desc
      LET g_glcf4_d[l_ac].glcf071_desc = g_glcf4_d[l_ac].glcf071,'\n',g_glcf4_d[l_ac].glcf071_desc
      
   END IF
END FUNCTION]]>
  </point>
  <point name="function.aglt420_free_acc_open_chk" order="7" ver="1" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 科目啟用自由核算項檢查
# Memo...........:
# Usage..........: CALL aglt420_free_acc_open_chk(p_glcf047)
#                  RETURNING 回传参数
# Input parameter: 
# Return code....: 
# Date & Author..: 
# Modify.........:
################################################################################
PRIVATE FUNCTION aglt420_free_acc_open_chk(p_glcf047)
   DEFINE p_glcf047     LIKE glcf_t.glcf047
   DEFINE r_flag        LIKE type_t.num5
   #是否做自由科目核算项管理A
   DEFINE l_glad017     LIKE glad_t.glad017
   DEFINE l_glad018     LIKE glad_t.glad018
   DEFINE l_glad019     LIKE glad_t.glad019
   DEFINE l_glad020     LIKE glad_t.glad020
   DEFINE l_glad021     LIKE glad_t.glad021
   DEFINE l_glad022     LIKE glad_t.glad022
   DEFINE l_glad023     LIKE glad_t.glad023
   DEFINE l_glad024     LIKE glad_t.glad024
   DEFINE l_glad025     LIKE glad_t.glad025
   DEFINE l_glad026     LIKE glad_t.glad026
   
   #总体说明：若启用该核算项管理则对应控制方式为2.必须输入不检查，3.必须输入必检查，则栏位不可空白，为1时可以空白，否则栏位不可进去
   SELECT glad017,glad018,glad019,glad020,glad021,glad022,glad023,glad024,
          glad025,glad026
     INTO l_glad017,l_glad018,l_glad019,l_glad020,l_glad021,
          l_glad022,l_glad023,l_glad024,l_glad025,l_glad026
    FROM  glad_t
    WHERE gladent = g_enterprise
      AND gladld =  g_glce_m.glceld
      AND glad001 = p_glcf047

   LET r_flag = 0 
   #啟用自由核算項一
   IF l_glad017 = 'Y'  THEN
      LET r_flag = r_flag+1   
   END IF

   #啟用自由核算項二
   IF l_glad018 = 'Y'  THEN
      LET r_flag = r_flag+1   
   END IF

   #啟用自由核算項三
   IF l_glad019 = 'Y'  THEN
      LET r_flag = r_flag+1   
   END IF

   #啟用自由核算項四
   IF l_glad020 = 'Y'  THEN
      LET r_flag = r_flag+1   
   END IF

   #啟用自由核算項五
   IF l_glad021 = 'Y'  THEN
      LET r_flag = r_flag+1   
   END IF
   
   #啟用自由核算項六
   IF l_glad022 = 'Y'  THEN
      LET r_flag = r_flag+1   
   END IF

   #啟用自由核算項七
   IF l_glad023 = 'Y'  THEN
      LET r_flag = r_flag+1   
   END IF

   #啟用自由核算項八
   IF l_glad024 = 'Y'  THEN
      LET r_flag = r_flag+1   
   END IF

   #啟用自由核算項九
   IF l_glad025 = 'Y'  THEN
      LET r_flag = r_flag+1   
   END IF

   #啟用自由核算項十
   IF l_glad026 = 'Y'  THEN
      LET r_flag = r_flag+1   
   END IF
   
   RETURN r_flag
END FUNCTION]]>
  </point>
  <point name="function.aglt420_fix_acc" order="8" ver="1" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 固定核算項維護
# Memo...........:
# Usage..........: CALL aglt420_fix_acc()
#                  RETURNING 回传参数
# Input parameter: 
# Return code....: 
# Date & Author..: 
# Modify.........:
################################################################################
PRIVATE FUNCTION aglt420_fix_acc()
   DEFINE l_date       LIKE type_t.dat
   DEFINE l_today      LIKE glce_t.glcemoddt
   DEFINE l_success    LIKE type_t.num5
   
   #开立状态资料才可进行此操作
   IF g_glce_m.glcestus <> 'N' THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = 'agl-00052'
      LET g_errparam.extend = 'mod fix_account'
      LET g_errparam.popup = TRUE
      CALL cl_err()
      RETURN
   END IF
   #单身无资料不需开出画面
   IF g_detail_idx =0 OR cl_null(g_detail_idx) OR l_ac<=0  THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = -400
      LET g_errparam.extend = ''
      LET g_errparam.popup = FALSE
      CALL cl_err()
      RETURN
   END IF
   #当该年度+期别的最后一天小于等于账套关账日期时，不可异动该单据
   CALL aglt420_date_chk() RETURNING l_success
   IF l_success = FALSE THEN
      RETURN
   END IF
   #核算項
   LET g_glcf_r.glcf048 = g_glcf4_d[l_ac].glcf048
   LET g_glcf_r.glcf049 = g_glcf4_d[l_ac].glcf049
   LET g_glcf_r.glcf050 = g_glcf4_d[l_ac].glcf050
   LET g_glcf_r.glcf051 = g_glcf4_d[l_ac].glcf051
   LET g_glcf_r.glcf052 = g_glcf4_d[l_ac].glcf052
   LET g_glcf_r.glcf053 = g_glcf4_d[l_ac].glcf053
   LET g_glcf_r.glcf054 = g_glcf4_d[l_ac].glcf054
   LET g_glcf_r.glcf055 = g_glcf4_d[l_ac].glcf055
   LET g_glcf_r.glcf056 = g_glcf4_d[l_ac].glcf056
   LET g_glcf_r.glcf057 = g_glcf4_d[l_ac].glcf057
   LET g_glcf_r.glcf058 = g_glcf4_d[l_ac].glcf058
   LET g_glcf_r.glcf059 = g_glcf4_d[l_ac].glcf059
   LET g_glcf_r.glcf060 = g_glcf4_d[l_ac].glcf060
   LET g_glcf_r.glcf061 = g_glcf4_d[l_ac].glcf061
   LET g_glcf_r.glcf062 = g_glcf4_d[l_ac].glcf062
   LET g_glcf_r.glcf063 = g_glcf4_d[l_ac].glcf063
   LET g_glcf_r.glcf064 = g_glcf4_d[l_ac].glcf064
   LET g_glcf_r.glcf065 = g_glcf4_d[l_ac].glcf065
   LET g_glcf_r.glcf066 = g_glcf4_d[l_ac].glcf066
   LET g_glcf_r.glcf067 = g_glcf4_d[l_ac].glcf067
   LET g_glcf_r.glcf068 = g_glcf4_d[l_ac].glcf068
   LET g_glcf_r.glcf069 = g_glcf4_d[l_ac].glcf069
   LET g_glcf_r.glcf070 = g_glcf4_d[l_ac].glcf070
   LET g_glcf_r.glcf071 = g_glcf4_d[l_ac].glcf071
   #抓取當期最後一天
   SELECT MAX(glav004) INTO l_date FROM glav_t
    WHERE glavent=g_enterprise AND glav001=g_glaa003
      AND glav002=g_glce_m.glce001 AND glav006=g_glce_m.glce002
   CALL aglt310_02('',g_glce_m.glceld,'',l_date,g_glcf4_d[l_ac].glcf047_desc,'','aglt420',g_glcf_r.*)
   RETURNING g_glcf4_d[l_ac].glcf048,g_glcf4_d[l_ac].glcf049,g_glcf4_d[l_ac].glcf050,
             g_glcf4_d[l_ac].glcf051,g_glcf4_d[l_ac].glcf052,g_glcf4_d[l_ac].glcf053,
             g_glcf4_d[l_ac].glcf054,g_glcf4_d[l_ac].glcf055,g_glcf4_d[l_ac].glcf056,
             g_glcf4_d[l_ac].glcf057,g_glcf4_d[l_ac].glcf058,g_glcf4_d[l_ac].glcf059,
             g_glcf4_d[l_ac].glcf060,g_glcf4_d[l_ac].glcf061,g_glcf4_d[l_ac].glcf062,
             g_glcf4_d[l_ac].glcf063,g_glcf4_d[l_ac].glcf064,g_glcf4_d[l_ac].glcf065,
             g_glcf4_d[l_ac].glcf066,g_glcf4_d[l_ac].glcf067,g_glcf4_d[l_ac].glcf068,
             g_glcf4_d[l_ac].glcf069,g_glcf4_d[l_ac].glcf070,g_glcf4_d[l_ac].glcf071,
             g_glcf_r.glbc004
  
   #更新数据库
   CALL s_transaction_begin()

   #更新固定核算項
   UPDATE glcf_t SET glcf048 = g_glcf4_d[l_ac].glcf048,
                     glcf049 = g_glcf4_d[l_ac].glcf049,
                     glcf050 = g_glcf4_d[l_ac].glcf050,
                     glcf051 = g_glcf4_d[l_ac].glcf051,
                     glcf052 = g_glcf4_d[l_ac].glcf052,
                     glcf053 = g_glcf4_d[l_ac].glcf053,
                     glcf054 = g_glcf4_d[l_ac].glcf054,
                     glcf055 = g_glcf4_d[l_ac].glcf055,
                     glcf056 = g_glcf4_d[l_ac].glcf056,
                     glcf057 = g_glcf4_d[l_ac].glcf057,
                     glcf058 = g_glcf4_d[l_ac].glcf058,
                     glcf059 = g_glcf4_d[l_ac].glcf059,
                     glcf060 = g_glcf4_d[l_ac].glcf060,
                     glcf061 = g_glcf4_d[l_ac].glcf061,
                     glcf062 = g_glcf4_d[l_ac].glcf062,
                     glcf063 = g_glcf4_d[l_ac].glcf063,
                     glcf064 = g_glcf4_d[l_ac].glcf064,
                     glcf065 = g_glcf4_d[l_ac].glcf065,
                     glcf066 = g_glcf4_d[l_ac].glcf066,
                     glcf067 = g_glcf4_d[l_ac].glcf067,
                     glcf068 = g_glcf4_d[l_ac].glcf068,
                     glcf069 = g_glcf4_d[l_ac].glcf069,
                     glcf070 = g_glcf4_d[l_ac].glcf070,
                     glcf071 = g_glcf4_d[l_ac].glcf071
    WHERE glcfent = g_enterprise AND glcfld = g_glce_m.glceld
      AND glcf001 = g_glce_m.glce001 AND glcf002 = g_glce_m.glce002
      AND glcf003 = g_glcf4_d[l_ac].glcf003 AND glcf004 = g_glcf4_d[l_ac].glcf004
      AND glcf005 = g_glcf4_d[l_ac].glcf005
   
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "update glcf_t"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      CALL s_transaction_end('N','0')
      RETURN
   END IF
   #更新單頭異動日期
   LET l_today = cl_get_current()
   UPDATE glce_t SET glcemodid = g_user,
                     glcemoddt = l_today
   WHERE glceent = g_enterprise AND glceld = g_glce_m.glceld
     AND glce001 = g_glce_m.glce001 AND glce002 = g_glce_m.glce002    
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "update glce_t"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      CALL s_transaction_end('N','0')
      RETURN
   END IF
   
   CALL s_transaction_end('Y','0') 
   
   #顯示單身
   CALL aglt420_detail_show_2()
   #重新抓取单身冻结部分显示               
   CALL aglt420_frozen_show()
END FUNCTION]]>
  </point>
  <point name="function.aglt420_free_acc" order="9" ver="1" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 自由核算項維護
# Memo...........:
# Usage..........: CALL aglt420_free_acc()
#                  RETURNING 回传参数
# Input parameter: 
# Return code....: 
# Date & Author..: 
# Modify.........:
################################################################################
PRIVATE FUNCTION aglt420_free_acc()
   DEFINE l_today      LIKE glce_t.glcemoddt
   DEFINE l_success    LIKE type_t.num5
   
   #开立状态资料才可进行此操作
   IF g_glce_m.glcestus <> 'N' THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = 'agl-00052'
      LET g_errparam.extend = 'mod free_account'
      LET g_errparam.popup = TRUE
      CALL cl_err()
      RETURN
   END IF
   #单身无资料不需开出画面
   IF g_detail_idx =0 OR cl_null(g_detail_idx) OR l_ac<=0  THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = -400
      LET g_errparam.extend = ''
      LET g_errparam.popup = FALSE
      CALL cl_err()
      RETURN
   END IF 
   #当该年度+期别的最后一天小于等于账套关账日期时，不可异动该单据
   CALL aglt420_date_chk() RETURNING l_success
   IF l_success = FALSE THEN
      RETURN
   END IF
#   CALL aglt310_03(g_glce_m.glceld,'','',g_glce_m.glceld,"aglt420",g_glce_m.glce001,g_glce_m.glce002,g_glcf4_d[l_ac].glcf004)
#   RETURNING g_glcf4_d[l_ac].glcf062,g_glcf4_d[l_ac].glcf063,g_glcf4_d[l_ac].glcf064,g_glcf4_d[l_ac].glcf065,
#             g_glcf4_d[l_ac].glcf066,g_glcf4_d[l_ac].glcf067,g_glcf4_d[l_ac].glcf068,g_glcf4_d[l_ac].glcf069,
#             g_glcf4_d[l_ac].glcf070,g_glcf4_d[l_ac].glcf071
   
   #更新数据库
   CALL s_transaction_begin()

   #更新固定核算項
   UPDATE glcf_t SET glcf062 = g_glcf4_d[l_ac].glcf062,
                     glcf063 = g_glcf4_d[l_ac].glcf063,
                     glcf064 = g_glcf4_d[l_ac].glcf064,
                     glcf065 = g_glcf4_d[l_ac].glcf065,
                     glcf066 = g_glcf4_d[l_ac].glcf066,
                     glcf067 = g_glcf4_d[l_ac].glcf067,
                     glcf068 = g_glcf4_d[l_ac].glcf068,
                     glcf069 = g_glcf4_d[l_ac].glcf069,
                     glcf070 = g_glcf4_d[l_ac].glcf070,
                     glcf071 = g_glcf4_d[l_ac].glcf071
    WHERE glcfent = g_enterprise AND glcfld = g_glce_m.glceld
      AND glcf001 = g_glce_m.glce001 AND glcf002 = g_glce_m.glce002
      AND glcf003 = g_glcf4_d[l_ac].glcf003 AND glcf004 = g_glcf4_d[l_ac].glcf004
      AND glcf005 = g_glcf4_d[l_ac].glcf005
   
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "update glcf_t"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      CALL s_transaction_end('N','0')
      RETURN
   END IF
   #更新單頭異動日期
   LET l_today = cl_get_current()
   UPDATE glce_t SET glcemodid = g_user,
                     glcemoddt = l_today
   WHERE glceent = g_enterprise AND glceld = g_glap_m.glapld
     AND glce001 = g_glce_m.glce001 AND glce002 = g_glce_m.glce002    
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "update glce_t"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      CALL s_transaction_end('N','0')
      RETURN
   END IF
   
   CALL s_transaction_end('Y','0') 
   
   #顯示單身
   CALL aglt420_detail_show_2()
   #重新抓取单身冻结部分显示               
   CALL aglt420_frozen_show()
END FUNCTION]]>
  </point>
  <point name="function.aglt420_voucher" order="10" ver="1" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 傳票拋轉
# Memo...........:
# Usage..........: CALL aglt420_voucher()
# Modify.........:
################################################################################
PRIVATE FUNCTION aglt420_voucher()
   DEFINE l_success    LIKE type_t.num5
   
   IF g_glce_m.glceld IS NULL THEN
      INITIALIZE g_errparam TO NULL 
      LET g_errparam.extend = "" 
      LET g_errparam.code   = "std-00003" 
      LET g_errparam.popup  = FALSE 
      CALL cl_err()
      RETURN
   END IF
   
   IF g_glce_m.glcestus <> 'Y' THEN
      INITIALIZE g_errparam TO NULL 
      LET g_errparam.extend = g_glce_m.glceld
      LET g_errparam.code   = "anm-00185" 
      LET g_errparam.popup  = FALSE 
      CALL cl_err()
      RETURN
   END IF
   
   #当该年度+期别的最后一天小于等于账套关账日期时，不可异动该单据
   CALL aglt420_date_chk() RETURNING l_success
   IF l_success = FALSE THEN
      RETURN
   END IF
   
   IF NOT cl_null(g_glce_m.glce005) THEN
      INITIALIZE g_errparam TO NULL 
      LET g_errparam.extend = g_glce_m.glceld
      LET g_errparam.code   = "anm-00198" 
      LET g_errparam.popup  = FALSE 
      CALL cl_err()
      RETURN
   END IF
   #拋轉傳票
   CALL aglt420_01(g_glce_m.glceld,g_glce_m.glcecomp,g_glce_m.glce001,g_glce_m.glce002) RETURNING g_glce_m.glce005
   IF NOT cl_null(g_glce_m.glce005) THEN
      INITIALIZE g_errparam TO NULL 
      LET g_errparam.extend = g_glce_m.glceld
      LET g_errparam.code   = "axr-00119"
      LET g_errparam.popup  = FALSE      
      CALL cl_err()    
      DISPLAY BY NAME g_glce_m.glce005
   ELSE
      INITIALIZE g_errparam TO NULL 
      LET g_errparam.extend = g_glce_m.glceld
      LET g_errparam.code   = "axr-00120"
      LET g_errparam.popup  = FALSE      
      CALL cl_err()    
      LET g_glce_m.glce005=''
      DISPLAY BY NAME g_glce_m.glce005
   END IF
END FUNCTION]]>
  </point>
  <point name="function.aglt420_un_voucher" order="11" ver="1" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 傳票還原
# Memo...........:
# Usage..........: CALL aglt420_un_voucher()
# Modify.........:
################################################################################
PRIVATE FUNCTION aglt420_un_voucher()
   DEFINE l_cnt         LIKE type_t.num5
   DEFINE l_glapdocdt   LIKE glap_t.glapdocdt
   DEFINE l_success     LIKE type_t.num5
   DEFINE l_wc          STRING
   
   IF g_glce_m.glceld IS NULL THEN
      INITIALIZE g_errparam TO NULL 
      LET g_errparam.extend = "" 
      LET g_errparam.code   = "std-00003" 
      LET g_errparam.popup  = FALSE 
      CALL cl_err()
      RETURN
   END IF
   
   #当该年度+期别的最后一天小于等于账套关账日期时，不可异动该单据
   CALL aglt420_date_chk() RETURNING l_success
   IF l_success = FALSE THEN
      RETURN
   END IF
   
   IF cl_null(g_glce_m.glce005) THEN
      INITIALIZE g_errparam TO NULL 
      LET g_errparam.extend = g_glce_m.glceld
      LET g_errparam.code   = "anm-00186" 
      LET g_errparam.popup  = FALSE 
      CALL cl_err()
      RETURN
   END IF
   
   SELECT COUNT(*) INTO l_cnt FROM glap_t
   WHERE glapent=g_enterprise AND glapld=g_glce_m.glceld 
   AND glapdocno=g_glce_m.glce005 AND glapstus <>'N'
   IF l_cnt >0 THEN
      INITIALIZE g_errparam TO NULL 
      LET g_errparam.extend = g_glce_m.glce005 
      LET g_errparam.code   = "axr-00076" 
      LET g_errparam.popup  = FALSE 
      CALL cl_err()
      RETURN
   END IF
   
   #刪除傳票
   CALL s_transaction_begin()
   SELECT glapdocdt INTO l_glapdocdt FROM glap_t 
    WHERE glapent=g_enterprise AND glapld=g_glce_m.glceld AND glapdocno=g_glce_m.glce005
   DELETE FROM glap_t 
   WHERE glapent=g_enterprise AND glapld=g_glce_m.glceld AND glapdocno=g_glce_m.glce005 
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL 
      LET g_errparam.extend = "delete glap_t"
      LET g_errparam.code   = SQLCA.SQLCODE
      LET g_errparam.popup  = TRUE      
      CALL cl_err()
      CALL s_transaction_end('N','0') 
      RETURN
   END IF
   #更新自动编码最大号
   LET g_prog = 'aglt310'
   IF NOT s_aooi200_fin_del_docno(g_glce_m.glceld,g_glce_m.glce005,l_glapdocdt) THEN
      CALL s_transaction_end('N','0')
      RETURN
   END IF
   LET g_prog = 'aglt420'   
   DELETE FROM glaq_t 
   WHERE glaqent=g_enterprise AND glaqld=g_glce_m.glceld AND glaqdocno=g_glce_m.glce005
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL 
      LET g_errparam.extend = "delete glaq_t"
      LET g_errparam.code   = SQLCA.SQLCODE
      LET g_errparam.popup  = TRUE      
      CALL cl_err()
      CALL s_transaction_end('N','0') 
      RETURN
   END IF 
   
   #现金变动码
   DELETE FROM glbc_t
      WHERE glbcent=g_enterprise AND glbcld=g_glce_m.glceld AND glbcdocno=g_glce_m.glce005
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = "delete glbc_t" 
         LET g_errparam.code   = SQLCA.sqlcode 
         LET g_errparam.popup  = FALSE 
         CALL cl_err()
         CALL s_transaction_end('N','0')
         RETURN
      END IF
      
   IF g_glaa121 = 'Y' THEN 
      LET l_wc = "glgadocno = '",g_glce_m.glcedocno,"'"
      CALL s_pre_voucher_upd('GL','TH',g_glce_m.glceld,'','','',l_wc) RETURNING l_success
      IF l_success = FALSE THEN 
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = "update glce_t"
         LET g_errparam.code   = SQLCA.SQLCODE
         LET g_errparam.popup  = TRUE      
         CALL cl_err()
         CALL s_transaction_end('N','0') 
         RETURN
      END IF
   END IF
   
   UPDATE glce_t SET glce005='' 
    WHERE glceent=g_enterprise AND glceld=g_glce_m.glceld
      AND glce001=g_glce_m.glce001 AND glce002=g_glce_m.glce002
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL 
      LET g_errparam.extend = "update glce_t"
      LET g_errparam.code   = SQLCA.SQLCODE
      LET g_errparam.popup  = TRUE      
      CALL cl_err()
      CALL s_transaction_end('N','0') 
      RETURN
   END IF 
   CALL s_transaction_end('Y','0') 
   INITIALIZE g_errparam TO NULL 
   LET g_errparam.extend = g_glce_m.glceld
   LET g_errparam.code   = "adz-00217"
   LET g_errparam.popup  = FALSE      
   CALL cl_err()    
   LET g_glce_m.glce005=''
   DISPLAY BY NAME g_glce_m.glce005
END FUNCTION]]>
  </point>
  <point name="function.aglt420_free_acc_show" order="12" ver="1" cite_std="N" new="Y" status="d" src="s" readonly="" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 抓取自由核算項的說明顯示
# Memo...........:
# Usage..........: CALL aglt420_free_acc_show(p_glad001)
#                  RETURNING 回传参数
# Input parameter: 
# Return code....: 
# Date & Author..: 
# Modify.........:
################################################################################
PRIVATE FUNCTION aglt420_free_acc_show(p_glad001)
   DEFINE p_glad001       LIKE glad_t.glad001
END FUNCTION]]>
  </point>
  <point name="function.aglt420_date_chk" order="12" ver="1" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 检查该年度+期别的最后一天是否小于等于账套关账日期，如果小于等于不可异动该资料
# Memo...........:
# Usage..........: CALL aglt420_date_chk()
#                  RETURNING r_success
# Input parameter: 
# Return code....: r_success   判断结果
# Date & Author..: 2015/5/25 By 02599
# Modify.........:
################################################################################
PRIVATE FUNCTION aglt420_date_chk()
   DEFINE l_glaa003       LIKE glaa_t.glaa003
   DEFINE l_glaa013       LIKE glaa_t.glaa013
   DEFINE r_success       LIKE type_t.num5
   DEFINE l_date          LIKE type_t.dat
   
   LET r_success = TRUE
   
   #抓取账套关账日期
   SELECT glaa013,glaa003 INTO l_glaa013,l_glaa003 FROM glaa_t
    WHERE glaaent=g_enterprise AND glaald=g_glce_m.glceld
    IF cl_null(l_glaa013) THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = g_glce_m.glceld
      LET g_errparam.code   = 'agl-00344'
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      RETURN r_success
   END IF
   
   #抓取该年度+期别最后一天
   SELECT MAX(glav004) INTO l_date FROM glav_t
    WHERE glavent=g_enterprise AND glav001=l_glaa003 
      AND glav002=g_glce_m.glce001 AND glav006=g_glce_m.glce002
   IF l_date <= l_glaa013 THEN
      LET r_success = FALSE
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = l_date
      LET g_errparam.code   = 'agl-00350'
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      RETURN r_success
   END IF
   RETURN r_success
END FUNCTION]]>
  </point>
  <point name="function.aglt420_free_account_desc" order="13" ver="1" cite_std="N" new="Y" status="d" src="s" readonly="" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 自由核算項說明
# Memo...........:
# Usage..........: CALL aglt420_free_account_desc(p_glaf001,p_glaf002)
#                  RETURNING r_desc 
# Input parameter: p_glaf001      自由核算項類型
#                : p_glaf002      自由核算項值
# Return code....: r_desc         自由核算項說明
# Date & Author..: 
# Modify.........:
################################################################################
PRIVATE FUNCTION aglt420_free_account_desc(p_glaf001,p_glaf002)
   DEFINE p_glaf001     LIKE glaf_t.glaf001
   DEFINE p_glaf002     LIKE glaf_t.glaf002
   DEFINE l_glae002     LIKE glae_t.glae002     #资料来源
   DEFINE l_sql         STRING                  #组的抓取资料的sql
   DEFINE r_desc        STRING
   
   #自由核算项
   LET l_glae002 = ''
   LET l_sql = ''
   SELECT glae002 INTO l_glae002 FROM glae_t
    WHERE glaeent = g_enterprise
      AND glae001 = p_glaf001
   IF l_glae002 = '2' THEN
      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] =p_glaf001
      LET g_ref_fields[2] =p_glaf002
      CALL ap_ref_array2(g_ref_fields,"SELECT glafl004 FROM glafl_t WHERE glaflent='"||g_enterprise||"' AND glafl001=? AND glafl002=? AND glafl003='"||g_dlang||"'","") RETURNING g_rtn_fields
      LET r_desc= g_rtn_fields[1]
   ELSE
      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = p_glaf002
      CALL aglt310_02_make_sql_desc(p_glaf001) RETURNING l_sql
      CALL ap_ref_array2(g_ref_fields,l_sql,"") RETURNING g_rtn_fields
      LET r_desc= g_rtn_fields[1]
   END IF
   
   RETURN r_desc   
END FUNCTION]]>
  </point>
  <point name="b_fill.define" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   DEFINE l_desc,l_str   STRING
   DEFINE l_glcf047      LIKE glcf_t.glcf047]]>
  </point>
  <point name="b_fill.fill" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[         #科目(核算項編號)+名称+核算项组合
         CALL aglt420_glcf003_desc() RETURNING l_desc,l_str
         LET g_glcf_d[l_ac].glcf003_desc = g_glcf_d[l_ac].glcf003,l_str,'\n',l_desc
         LET g_glcf2_d[l_ac].glcf003_2_desc = g_glcf_d[l_ac].glcf003_desc
         LET g_glcf3_d[l_ac].glcf003_3_desc = g_glcf_d[l_ac].glcf003_desc
         LET g_glcf4_d[l_ac].glcf003_4_desc = g_glcf_d[l_ac].glcf003_desc
         #匯差科目
         CALL s_desc_get_account_desc(g_glce_m.glceld,g_glcf4_d[l_ac].glcf047) RETURNING l_desc
         LET g_glcf4_d[l_ac].glcf047_desc = g_glcf4_d[l_ac].glcf047,'\n',l_desc
         #顯示匯差核算項資料
         CALL aglt420_detail_show_2()]]>
  </point>
  <point name="browser_fill.before_foreach" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   LET l_wc = l_wc," AND glceld='",g_glaald,"' "]]>
  </point>
  <point name="browser_fill.other_fill" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   #核算項
   CALL cl_set_comp_visible("glcf049_desc,glcf050_desc,glcf051_desc,glcf052_desc,glcf053_desc,glcf054_desc,
                             glcf055_desc,glcf056,glcf057_desc,glcf058_desc,glcf059_desc,glcf060,glcf061",FALSE)
   #自由核算項
   CALL cl_set_comp_visible("glcf062_desc,glcf063_desc,glcf064_desc,glcf065_desc,glcf066_desc,
                             glcf067_desc,glcf068_desc,glcf069_desc,glcf070_desc,glcf071_desc",FALSE)
   LET g_sql="SELECT DISTINCT glcf047 FROM glcf_t",
             " WHERE glcfent=",g_enterprise," AND glcfld='",g_glce_m.glceld,"'",
             "   AND glcf001=",g_glce_m.glce001," AND glcf002=",g_glce_m.glce002,
             " ORDER BY glcf047 "
   PREPARE aglt420_pb1 FROM g_sql
   DECLARE b_fill_cs1 CURSOR FOR aglt420_pb1
   FOREACH b_fill_cs1 INTO l_glcf047
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = "FOREACH:b_fill_cs1" 
         LET g_errparam.code   = SQLCA.sqlcode 
         LET g_errparam.popup  = TRUE 
         CALL cl_err()
         EXIT FOREACH
      END IF
      CALL aglt420_set_fix_visible(l_glcf047)
   END FOREACH]]>
  </point>
  <point name="construct.c.glaa001" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_ooai001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO glaa001  #顯示到畫面上
            NEXT FIELD glaa001                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.glaa016" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_ooai001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO glaa016  #顯示到畫面上
            NEXT FIELD glaa016                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.glaa020" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_ooai001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO glaa020  #顯示到畫面上
            NEXT FIELD glaa020                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.glce003" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_ooef001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO glce003  #顯示到畫面上
            NEXT FIELD glce003                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.glce005" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_glce005()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO glce005  #顯示到畫面上
            NEXT FIELD glce005                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.glce006" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #應用 a08 樣板自動產生(Version:2)
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c' 
            LET g_qryparam.reqry = FALSE
            CALL q_nmai002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO glce006  #顯示到畫面上
            NEXT FIELD glce006                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.glcecnfid" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_ooag001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO glcecnfid  #顯示到畫面上
            NEXT FIELD glcecnfid                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.glcecomp" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_ooef001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO glcecomp  #顯示到畫面上
            NEXT FIELD glcecomp                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.glcecrtdp" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_ooeg001_9()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO glcecrtdp  #顯示到畫面上
            NEXT FIELD glcecrtdp                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.glcecrtid" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_ooag001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO glcecrtid  #顯示到畫面上
            NEXT FIELD glcecrtid                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.glceld" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.arg1 = g_user 
            LET g_qryparam.arg2 = g_dept
            CALL q_authorised_ld()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO glceld  #顯示到畫面上
            NEXT FIELD glceld                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.glcemodid" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_ooag001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO glcemodid  #顯示到畫面上
            NEXT FIELD glcemodid                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.glceowndp" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_ooeg001_9()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO glceowndp  #顯示到畫面上
            NEXT FIELD glceowndp                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.glceownid" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_ooag001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO glceownid  #顯示到畫面上
            NEXT FIELD glceownid                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.glcf023" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_ooef001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO glcf023  #顯示到畫面上
            NEXT FIELD glcf023                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.glcf024" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_ooeg001_4()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO glcf024  #顯示到畫面上
            NEXT FIELD glcf024                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.glcf025" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.where = "ooeg003 IN ('1','2','3')"
            CALL q_ooef001_4()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO glcf025  #顯示到畫面上
            NEXT FIELD glcf025                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.glcf026" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_oocq002_287()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO glcf026  #顯示到畫面上
            NEXT FIELD glcf026                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.glcf027" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_pmaa001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO glcf027  #顯示到畫面上
            NEXT FIELD glcf027                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.glcf028" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_pmaa001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO glcf028  #顯示到畫面上
            NEXT FIELD glcf028                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.glcf029" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_oocq002_281()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO glcf029  #顯示到畫面上
            NEXT FIELD glcf029                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.glcf030" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_rtax001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO glcf030  #顯示到畫面上
            NEXT FIELD glcf030                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.glcf032" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_oojd001_2()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO glcf032  #顯示到畫面上
            NEXT FIELD glcf032                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.glcf033" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_oocq002_2002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO glcf033  #顯示到畫面上
            NEXT FIELD glcf033                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.glcf034" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_ooag001_8()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO glcf034  #顯示到畫面上
            NEXT FIELD glcf034                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.glcf035" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.state = 'c'
            CALL q_pjba001()                          #呼叫開窗
            DISPLAY g_qryparam.return1 TO glcf035     #顯示到畫面上
            NEXT FIELD glcf035]]>
  </point>
  <point name="construct.c.glcf036" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.state = 'c'
            LET g_qryparam.where = "pjbb012='1' "
            CALL q_pjbb002()                          #呼叫開窗
            DISPLAY g_qryparam.return1 TO glcf036     #顯示到畫面上
            NEXT FIELD glcf036]]>
  </point>
  <point name="construct.c.glcf037" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_glaf002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO glcf037  #顯示到畫面上
            NEXT FIELD glcf037                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.glcf038" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_glaf002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO glcf038  #顯示到畫面上
            NEXT FIELD glcf038                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.glcf039" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_glaf002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO glcf039  #顯示到畫面上
            NEXT FIELD glcf039                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.glcf040" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_glaf002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO glcf040  #顯示到畫面上
            NEXT FIELD glcf040                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.glcf041" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_glaf002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO glcf041  #顯示到畫面上
            NEXT FIELD glcf041                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.glcf042" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_glaf002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO glcf042  #顯示到畫面上
            NEXT FIELD glcf042                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.glcf043" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_glaf002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO glcf043  #顯示到畫面上
            NEXT FIELD glcf043                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.glcf044" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_glaf002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO glcf044  #顯示到畫面上
            NEXT FIELD glcf044                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.glcf045" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_glaf002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO glcf045  #顯示到畫面上
            NEXT FIELD glcf045                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.glcf046" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_glaf002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO glcf046  #顯示到畫面上
            NEXT FIELD glcf046                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page1.glcf003" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL aglt310_04()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO glcf003  #顯示到畫面上
            NEXT FIELD glcf003                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page1.glcf003_desc" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL aglt310_04()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO glcf003_desc  #顯示到畫面上
            NEXT FIELD glcf003_desc                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page1.glcf005" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_ooai001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO glcf005  #顯示到畫面上
            NEXT FIELD glcf005                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page2.glcf003_2_desc" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL aglt310_04()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO glcf003_2_desc  #顯示到畫面上
            NEXT FIELD glcf003_2_desc                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page3.glcf003_3_desc" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL aglt310_04()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO glcf003_3_desc  #顯示到畫面上
            NEXT FIELD glcf003_3_desc                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page4.glcf003_4_desc" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL aglt310_04()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO glcf003_4_desc  #顯示到畫面上
            NEXT FIELD glcf003_4_desc                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page4.glcf047_desc" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL aglt310_04()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO glcf047_desc  #顯示到畫面上
            NEXT FIELD glcf047_desc                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page4.glcf048_desc" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_ooef001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO glcf048_desc  #顯示到畫面上
            NEXT FIELD glcf048_desc                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page4.glcf049_desc" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_ooeg001_4()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO glcf049_desc  #顯示到畫面上
            NEXT FIELD glcf049_desc                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page4.glcf050_desc" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.where = "ooeg003 IN ('1','2','3')"
            CALL q_ooeg001_4()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO glcf050_desc  #顯示到畫面上
            NEXT FIELD glcf050_desc                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page4.glcf051_desc" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_oocq002_287()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO glcf051_desc  #顯示到畫面上
            NEXT FIELD glcf051_desc                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page4.glcf052_desc" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_pmaa001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO glcf052_desc  #顯示到畫面上
            NEXT FIELD glcf052_desc                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page4.glcf053" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_pmaa001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO glcf053_desc  #顯示到畫面上
            NEXT FIELD glcf053_desc ]]>
  </point>
  <point name="construct.c.page4.glcf054_desc" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_oocq002_281()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO glcf054_desc  #顯示到畫面上
            NEXT FIELD glcf054_desc                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page4.glcf055_desc" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_rtax001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO glcf055_desc  #顯示到畫面上
            NEXT FIELD glcf055_desc                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page4.glcf057_desc" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_oojd001_2()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO glcf057_desc  #顯示到畫面上
            NEXT FIELD glcf057_desc                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page4.glcf058_desc" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_oocq002_2002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO glcf058_desc  #顯示到畫面上
            NEXT FIELD glcf058_desc                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page4.glcf059_desc" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_ooag001_8()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO glcf059_desc  #顯示到畫面上
            NEXT FIELD glcf059_desc                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page4.glcf060_desc" order="" ver="1" cite_std="" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #應用 a08 樣板自動產生(Version:2)
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c' 
            LET g_qryparam.reqry = FALSE
            CALL q_pjba001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO glcf060_desc  #顯示到畫面上
            NEXT FIELD glcf060_desc                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page4.glcf061_desc" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #應用 a08 樣板自動產生(Version:2)
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c' 
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.where = "pjbb012='1'"
            CALL q_pjbb002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO glcf061_desc  #顯示到畫面上
            NEXT FIELD glcf061_desc                     #返回原欄位
    

]]>
  </point>
  <point name="cs.head.before_construct" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            DISPLAY g_glaald TO glceld              #帐别
            DISPLAY g_glaacomp TO glcecomp          #法人 
            DISPLAY g_glaa001 TO glaa001       #币别
            DISPLAY g_glaa016 TO glaa016
            DISPLAY g_glaa020 TO glaa020]]>
  </point>
  <point name="delete.before_ask" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   IF g_glce_m.glcestus <> 'N' THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = 'agl-00313'
      LET g_errparam.extend = g_glce_m.glceld
      LET g_errparam.popup = TRUE
      CALL cl_err()
      CLOSE aglt420_cl
      CALL s_transaction_end('N','0')
      RETURN
   END IF
   #当该年度+期别的最后一天小于等于账套关账日期时，不可异动该单据
   CALL aglt420_date_chk() RETURNING l_success
   IF l_success = FALSE THEN
      CLOSE aglt420_cl
      CALL s_transaction_end('N','0')
      RETURN
   END IF]]>
  </point>
  <point name="delete.body.a_delete" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[      #當改帳套採用分錄底稿時，同步刪除同步底稿資料
      IF g_glaa121 = 'Y' THEN
         CALL s_aglt420_pre_voucher_del('GL','TH',g_glce_m.glceld,g_glce_m.glce001,g_glce_m.glce002)
         RETURNING l_success
         IF l_success = FALSE THEN
            INITIALIZE g_errparam TO NULL 
            LET g_errparam.extend = "glga_t" 
            LET g_errparam.code   = SQLCA.sqlcode 
            LET g_errparam.popup  = FALSE 
            CALL cl_err()
            CALL s_transaction_end('N','0')
            RETURN
         END IF
      END IF]]>
  </point>
  <point name="delete.define" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   DEFINE  l_success       LIKE type_t.num5]]>
  </point>
  <point name="detail_show.before" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   ]]>
  </point>
  <point name="global.variable" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[DEFINE g_glaald              LIKE glaa_t.glaald
#依据当前账别，抓取账别所归属的法人，使用币别，汇率参照表号，会计科目参照表号，关账日期
DEFINE g_glaacomp    LIKE glaa_t.glaacomp
DEFINE g_glaa001     LIKE glaa_t.glaa001
DEFINE g_glaa002     LIKE glaa_t.glaa002
DEFINE g_glaa003     LIKE glaa_t.glaa003
DEFINE g_glaa004     LIKE glaa_t.glaa004
DEFINE g_glaa005     LIKE glaa_t.glaa005
DEFINE g_glaa013     LIKE glaa_t.glaa013
DEFINE g_glaa015     LIKE glaa_t.glaa015
DEFINE g_glaa016     LIKE glaa_t.glaa016
DEFINE g_glaa017     LIKE glaa_t.glaa017
DEFINE g_glaa018     LIKE glaa_t.glaa018
DEFINE g_glaa019     LIKE glaa_t.glaa019
DEFINE g_glaa020     LIKE glaa_t.glaa020
DEFINE g_glaa021     LIKE glaa_t.glaa021
DEFINE g_glaa022     LIKE glaa_t.glaa022
DEFINE g_glaa025     LIKE glaa_t.glaa025
DEFINE g_glaa026     LIKE glaa_t.glaa026
DEFINE g_glaa121     LIKE glaa_t.glaa121
DEFINE g_ooaj004     LIKE ooaj_t.ooaj004
DEFINE g_ooaj004_2   LIKE ooaj_t.ooaj004
DEFINE g_ooaj004_3   LIKE ooaj_t.ooaj004
#自由核算項
DEFINE g_glad017        LIKE glad_t.glad017
DEFINE g_glad0171       LIKE glad_t.glad0171 
DEFINE g_glad0172       LIKE glad_t.glad0172 
DEFINE g_glad018        LIKE glad_t.glad018
DEFINE g_glad0181       LIKE glad_t.glad0181
DEFINE g_glad0182       LIKE glad_t.glad0182
DEFINE g_glad019        LIKE glad_t.glad019
DEFINE g_glad0191       LIKE glad_t.glad0191
DEFINE g_glad0192       LIKE glad_t.glad0192
DEFINE g_glad020        LIKE glad_t.glad020
DEFINE g_glad0201       LIKE glad_t.glad0201
DEFINE g_glad0202       LIKE glad_t.glad0202
DEFINE g_glad021        LIKE glad_t.glad021
DEFINE g_glad0211       LIKE glad_t.glad0211
DEFINE g_glad0212       LIKE glad_t.glad0212
DEFINE g_glad022        LIKE glad_t.glad022
DEFINE g_glad0221       LIKE glad_t.glad0221
DEFINE g_glad0222       LIKE glad_t.glad0222
DEFINE g_glad023        LIKE glad_t.glad023
DEFINE g_glad0231       LIKE glad_t.glad0231
DEFINE g_glad0232       LIKE glad_t.glad0232
DEFINE g_glad024        LIKE glad_t.glad024
DEFINE g_glad0241       LIKE glad_t.glad0241
DEFINE g_glad0242       LIKE glad_t.glad0242
DEFINE g_glad025        LIKE glad_t.glad025
DEFINE g_glad0251       LIKE glad_t.glad0251
DEFINE g_glad0252       LIKE glad_t.glad0252
DEFINE g_glad026        LIKE glad_t.glad026
DEFINE g_glad0261       LIKE glad_t.glad0261
DEFINE g_glad0262       LIKE glad_t.glad0262
type type_g_glcf_r       RECORD
       glcf048           LIKE glcf_t.glcf048,
       glcf049           LIKE glcf_t.glcf049,
       glcf050           LIKE glcf_t.glcf050,
       glcf051           LIKE glcf_t.glcf051,
       glcf052           LIKE glcf_t.glcf052,
       glcf053           LIKE glcf_t.glcf053,
       glcf054           LIKE glcf_t.glcf054,
       glcf055           LIKE glcf_t.glcf055,
       glcf056           LIKE glcf_t.glcf056,
       glcf057           LIKE glcf_t.glcf057, 
       glcf058           LIKE glcf_t.glcf058,
       glcf059           LIKE glcf_t.glcf059,
       glcf060           LIKE glcf_t.glcf060,
       glcf061           LIKE glcf_t.glcf061, 
       glcf062           LIKE glcf_t.glcf062, 
       glcf063           LIKE glcf_t.glcf063, 
       glcf064           LIKE glcf_t.glcf064, 
       glcf065           LIKE glcf_t.glcf065, 
       glcf066           LIKE glcf_t.glcf066, 
       glcf067           LIKE glcf_t.glcf067, 
       glcf068           LIKE glcf_t.glcf068, 
       glcf069           LIKE glcf_t.glcf069, 
       glcf070           LIKE glcf_t.glcf070, 
       glcf071           LIKE glcf_t.glcf071,
       glbc004           LIKE glbc_t.glbc004
       END RECORD
DEFINE g_glcf_r          type_g_glcf_r
]]>
  </point>
  <point name="init.define" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   DEFINE l_success     LIKE type_t.num5
   DEFINE l_pass        LIKE type_t.num5]]>
  </point>
  <point name="init.init" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   LET g_glaald = ''
   IF cl_null(g_glaald) THEN
      CALL s_ld_bookno()  RETURNING l_success,g_glaald
      IF l_success = FALSE THEN
         RETURN 
      END IF
   END IF
   IF NOT cl_null(g_glaald) THEN
      CALL s_ld_chk_authorization(g_user,g_glaald) RETURNING l_pass
      IF l_pass = FALSE THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = 'agl-00164'
         LET g_errparam.extend = g_glaald
         LET g_errparam.popup = TRUE
         CALL cl_err()
         RETURN
      END IF
   END IF
   CALL aglt420_glceld_desc(g_glaald)
   IF g_glaa121 = 'Y' THEN
      CALL cl_set_toolbaritem_visible('open_pre',TRUE)
   ELSE
      CALL cl_set_toolbaritem_visible('open_pre',FALSE)
   END IF
   CALL cl_set_combo_scc('glcf031','6013')
   CALL cl_set_combo_scc('glcf056','6013')
   CALL s_voucher_cre_ar_tmp_table() RETURNING l_success
   CALL s_pre_voucher_cre_tmp_table() RETURNING l_success
   CALL s_fin_continue_no_tmp()]]>
  </point>
  <point name="input.a.glce001" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            #確認資料無重複
            IF  NOT cl_null(g_glce_m.glceld) AND NOT cl_null(g_glce_m.glce001) AND NOT cl_null(g_glce_m.glce002) THEN 
               IF p_cmd = 'a' OR ( p_cmd = 'u' AND (g_glce_m.glceld != g_glceld_t  OR g_glce_m.glce001 != g_glce001_t  OR g_glce_m.glce002 != g_glce002_t )) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM glce_t WHERE "||"glceent = '" ||g_enterprise|| "' AND "||"glceld = '"||g_glce_m.glceld ||"' AND "|| "glce001 = '"||g_glce_m.glce001 ||"' AND "|| "glce002 = '"||g_glce_m.glce002 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            IF NOT cl_null(g_glce_m.glce001) AND NOT cl_null(g_glce_m.glce002) THEN
               #当该年度+期别的最后一天小于等于账套关账日期时，不可异动该单据
               CALL aglt420_date_chk() RETURNING l_success
               IF l_success = FALSE THEN
                  NEXT FIELD CURRENT
               END IF
            END IF

]]>
  </point>
  <point name="input.a.glce002" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            #確認資料無重複
            IF  NOT cl_null(g_glce_m.glceld) AND NOT cl_null(g_glce_m.glce001) AND NOT cl_null(g_glce_m.glce002) THEN 
               IF p_cmd = 'a' OR ( p_cmd = 'u' AND (g_glce_m.glceld != g_glceld_t  OR g_glce_m.glce001 != g_glce001_t  OR g_glce_m.glce002 != g_glce002_t )) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM glce_t WHERE "||"glceent = '" ||g_enterprise|| "' AND "||"glceld = '"||g_glce_m.glceld ||"' AND "|| "glce001 = '"||g_glce_m.glce001 ||"' AND "|| "glce002 = '"||g_glce_m.glce002 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

            IF NOT cl_null(g_glce_m.glce001) AND NOT cl_null(g_glce_m.glce002) THEN
               #当该年度+期别的最后一天小于等于账套关账日期时，不可异动该单据
               CALL aglt420_date_chk() RETURNING l_success
               IF l_success = FALSE THEN
                  NEXT FIELD CURRENT
               END IF
            END IF
]]>
  </point>
  <point name="input.a.glce003" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_glce_m.glce003) THEN 
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_glce_m.glce003

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_ooef001") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 
               ELSE
                  #檢查失敗時後續處理
                  LET g_glce_m.glce003 = g_glce_m_t.glce003
                  CALL s_desc_get_department_desc(g_glce_m.glce003) RETURNING g_glce_m.glce003_desc
                  DISPLAY BY NAME g_glce_m.glce003_desc
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
            CALL s_desc_get_department_desc(g_glce_m.glce003) RETURNING g_glce_m.glce003_desc
            DISPLAY BY NAME g_glce_m.glce003_desc

]]>
  </point>
  <point name="input.a.glce006" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_glce_m.glce006) THEN
               LET l_nmaistus='N'
               SELECT nmaistus INTO l_nmaistus FROM nmai_t 
                WHERE nmaient=g_enterprise AND nmai001=g_glaa005
                  AND nmai002=g_glce_m.glce006
               IF SQLCA.sqlcode THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = SQLCA.sqlcode
                  LET g_errparam.extend = g_glce_m.glce006
                  LET g_errparam.popup = FALSE
                  CALL cl_err()

                  LET g_glce_m.glce006=g_glce_m_t.glce006
                  NEXT FIELD glce006
               END IF
               IF l_nmaistus<>'Y' THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = 'abg-00002'
                  LET g_errparam.extend = g_glce_m.glce006
                  LET g_errparam.popup = FALSE
                  CALL cl_err()

                  LET g_glce_m.glce006=g_glce_m_t.glce006
                  NEXT FIELD glce006
               END IF
            END IF
            CALL s_desc_get_nmail004_desc(g_glaa005,g_glce_m.glce006)  RETURNING g_glce_m.glce006_desc
            DISPLAY BY NAME g_glce_m.glce006_desc
]]>
  </point>
  <point name="input.a.glcecomp" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_glce_m.glcecomp
            CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_glce_m.glcecomp_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_glce_m.glcecomp_desc

]]>
  </point>
  <point name="input.a.glceld" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_glce_m.glceld) THEN 
#此段落由子樣板a19產生
               #校驗代值
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_glce_m.glceld

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_glaald") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 
               ELSE
                  #檢查失敗時後續處理
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_glce_m.glceld
            CALL ap_ref_array2(g_ref_fields,"SELECT glaal002 FROM glaal_t WHERE glaalent='"||g_enterprise||"' AND glaalld=? AND glaal001='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_glce_m.glceld_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_glce_m.glceld_desc

            #此段落由子樣板a05產生
            #確認資料無重複
            IF  NOT cl_null(g_glce_m.glceld) AND NOT cl_null(g_glce_m.glce001) AND NOT cl_null(g_glce_m.glce002) THEN 
               IF p_cmd = 'a' OR ( p_cmd = 'u' AND (g_glce_m.glceld != g_glceld_t  OR g_glce_m.glce001 != g_glce001_t  OR g_glce_m.glce002 != g_glce002_t )) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM glce_t WHERE "||"glceent = '" ||g_enterprise|| "' AND "||"glceld = '"||g_glce_m.glceld ||"' AND "|| "glce001 = '"||g_glce_m.glce001 ||"' AND "|| "glce002 = '"||g_glce_m.glce002 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page1.glcf003" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            #確認資料無重複
            IF  g_glce_m.glceld IS NOT NULL AND g_glce_m.glce001 IS NOT NULL AND g_glce_m.glce002 IS NOT NULL AND g_glcf_d[g_detail_idx].glcf003 IS NOT NULL AND g_glcf_d[g_detail_idx].glcf004 IS NOT NULL AND g_glcf_d[g_detail_idx].glcf005 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_glce_m.glceld != g_glceld_t OR g_glce_m.glce001 != g_glce001_t OR g_glce_m.glce002 != g_glce002_t OR g_glcf_d[g_detail_idx].glcf003 != g_glcf_d_t.glcf003 OR g_glcf_d[g_detail_idx].glcf004 != g_glcf_d_t.glcf004 OR g_glcf_d[g_detail_idx].glcf005 != g_glcf_d_t.glcf005)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM glcf_t WHERE "||"glcfent = '" ||g_enterprise|| "' AND "||"glcfld = '"||g_glce_m.glceld ||"' AND "|| "glcf001 = '"||g_glce_m.glce001 ||"' AND "|| "glcf002 = '"||g_glce_m.glce002 ||"' AND "|| "glcf003 = '"||g_glcf_d[g_detail_idx].glcf003 ||"' AND "|| "glcf004 = '"||g_glcf_d[g_detail_idx].glcf004 ||"' AND "|| "glcf005 = '"||g_glcf_d[g_detail_idx].glcf005 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page1.glcf004" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            #確認資料無重複
            IF  g_glce_m.glceld IS NOT NULL AND g_glce_m.glce001 IS NOT NULL AND g_glce_m.glce002 IS NOT NULL AND g_glcf_d[g_detail_idx].glcf003 IS NOT NULL AND g_glcf_d[g_detail_idx].glcf004 IS NOT NULL AND g_glcf_d[g_detail_idx].glcf005 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_glce_m.glceld != g_glceld_t OR g_glce_m.glce001 != g_glce001_t OR g_glce_m.glce002 != g_glce002_t OR g_glcf_d[g_detail_idx].glcf003 != g_glcf_d_t.glcf003 OR g_glcf_d[g_detail_idx].glcf004 != g_glcf_d_t.glcf004 OR g_glcf_d[g_detail_idx].glcf005 != g_glcf_d_t.glcf005)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM glcf_t WHERE "||"glcfent = '" ||g_enterprise|| "' AND "||"glcfld = '"||g_glce_m.glceld ||"' AND "|| "glcf001 = '"||g_glce_m.glce001 ||"' AND "|| "glcf002 = '"||g_glce_m.glce002 ||"' AND "|| "glcf003 = '"||g_glcf_d[g_detail_idx].glcf003 ||"' AND "|| "glcf004 = '"||g_glcf_d[g_detail_idx].glcf004 ||"' AND "|| "glcf005 = '"||g_glcf_d[g_detail_idx].glcf005 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page1.glcf005" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            #確認資料無重複
            IF  g_glce_m.glceld IS NOT NULL AND g_glce_m.glce001 IS NOT NULL AND g_glce_m.glce002 IS NOT NULL AND g_glcf_d[g_detail_idx].glcf003 IS NOT NULL AND g_glcf_d[g_detail_idx].glcf004 IS NOT NULL AND g_glcf_d[g_detail_idx].glcf005 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_glce_m.glceld != g_glceld_t OR g_glce_m.glce001 != g_glce001_t OR g_glce_m.glce002 != g_glce002_t OR g_glcf_d[g_detail_idx].glcf003 != g_glcf_d_t.glcf003 OR g_glcf_d[g_detail_idx].glcf004 != g_glcf_d_t.glcf004 OR g_glcf_d[g_detail_idx].glcf005 != g_glcf_d_t.glcf005)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM glcf_t WHERE "||"glcfent = '" ||g_enterprise|| "' AND "||"glcfld = '"||g_glce_m.glceld ||"' AND "|| "glcf001 = '"||g_glce_m.glce001 ||"' AND "|| "glcf002 = '"||g_glce_m.glce002 ||"' AND "|| "glcf003 = '"||g_glcf_d[g_detail_idx].glcf003 ||"' AND "|| "glcf004 = '"||g_glcf_d[g_detail_idx].glcf004 ||"' AND "|| "glcf005 = '"||g_glcf_d[g_detail_idx].glcf005 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page2.glcf003_2" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            #確認資料無重複
            IF  g_glce_m.glceld IS NOT NULL AND g_glce_m.glce001 IS NOT NULL AND g_glce_m.glce002 IS NOT NULL AND g_glcf2_d[g_detail_idx].glcf003 IS NOT NULL AND g_glcf2_d[g_detail_idx].glcf004 IS NOT NULL AND g_glcf2_d[g_detail_idx].glcf005 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_glce_m.glceld != g_glceld_t OR g_glce_m.glce001 != g_glce001_t OR g_glce_m.glce002 != g_glce002_t OR g_glcf2_d[g_detail_idx].glcf003 != g_glcf2_d_t.glcf003 OR g_glcf2_d[g_detail_idx].glcf004 != g_glcf2_d_t.glcf004 OR g_glcf2_d[g_detail_idx].glcf005 != g_glcf2_d_t.glcf005)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM glcf_t WHERE "||"glcfent = '" ||g_enterprise|| "' AND "||"glcfld = '"||g_glce_m.glceld ||"' AND "|| "glcf001 = '"||g_glce_m.glce001 ||"' AND "|| "glcf002 = '"||g_glce_m.glce002 ||"' AND "|| "glcf003 = '"||g_glcf2_d[g_detail_idx].glcf003 ||"' AND "|| "glcf004 = '"||g_glcf2_d[g_detail_idx].glcf004 ||"' AND "|| "glcf005 = '"||g_glcf2_d[g_detail_idx].glcf005 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page2.glcf004_2" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            #確認資料無重複
            IF  g_glce_m.glceld IS NOT NULL AND g_glce_m.glce001 IS NOT NULL AND g_glce_m.glce002 IS NOT NULL AND g_glcf2_d[g_detail_idx].glcf003 IS NOT NULL AND g_glcf2_d[g_detail_idx].glcf004 IS NOT NULL AND g_glcf2_d[g_detail_idx].glcf005 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_glce_m.glceld != g_glceld_t OR g_glce_m.glce001 != g_glce001_t OR g_glce_m.glce002 != g_glce002_t OR g_glcf2_d[g_detail_idx].glcf003 != g_glcf2_d_t.glcf003 OR g_glcf2_d[g_detail_idx].glcf004 != g_glcf2_d_t.glcf004 OR g_glcf2_d[g_detail_idx].glcf005 != g_glcf2_d_t.glcf005)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM glcf_t WHERE "||"glcfent = '" ||g_enterprise|| "' AND "||"glcfld = '"||g_glce_m.glceld ||"' AND "|| "glcf001 = '"||g_glce_m.glce001 ||"' AND "|| "glcf002 = '"||g_glce_m.glce002 ||"' AND "|| "glcf003 = '"||g_glcf2_d[g_detail_idx].glcf003 ||"' AND "|| "glcf004 = '"||g_glcf2_d[g_detail_idx].glcf004 ||"' AND "|| "glcf005 = '"||g_glcf2_d[g_detail_idx].glcf005 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page2.glcf005_2" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            #確認資料無重複
            IF  g_glce_m.glceld IS NOT NULL AND g_glce_m.glce001 IS NOT NULL AND g_glce_m.glce002 IS NOT NULL AND g_glcf2_d[g_detail_idx].glcf003 IS NOT NULL AND g_glcf2_d[g_detail_idx].glcf004 IS NOT NULL AND g_glcf2_d[g_detail_idx].glcf005 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_glce_m.glceld != g_glceld_t OR g_glce_m.glce001 != g_glce001_t OR g_glce_m.glce002 != g_glce002_t OR g_glcf2_d[g_detail_idx].glcf003 != g_glcf2_d_t.glcf003 OR g_glcf2_d[g_detail_idx].glcf004 != g_glcf2_d_t.glcf004 OR g_glcf2_d[g_detail_idx].glcf005 != g_glcf2_d_t.glcf005)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM glcf_t WHERE "||"glcfent = '" ||g_enterprise|| "' AND "||"glcfld = '"||g_glce_m.glceld ||"' AND "|| "glcf001 = '"||g_glce_m.glce001 ||"' AND "|| "glcf002 = '"||g_glce_m.glce002 ||"' AND "|| "glcf003 = '"||g_glcf2_d[g_detail_idx].glcf003 ||"' AND "|| "glcf004 = '"||g_glcf2_d[g_detail_idx].glcf004 ||"' AND "|| "glcf005 = '"||g_glcf2_d[g_detail_idx].glcf005 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page3.glcf003_3" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            #確認資料無重複
            IF  g_glce_m.glceld IS NOT NULL AND g_glce_m.glce001 IS NOT NULL AND g_glce_m.glce002 IS NOT NULL AND g_glcf3_d[g_detail_idx].glcf003 IS NOT NULL AND g_glcf3_d[g_detail_idx].glcf004 IS NOT NULL AND g_glcf3_d[g_detail_idx].glcf005 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_glce_m.glceld != g_glceld_t OR g_glce_m.glce001 != g_glce001_t OR g_glce_m.glce002 != g_glce002_t OR g_glcf3_d[g_detail_idx].glcf003 != g_glcf3_d_t.glcf003 OR g_glcf3_d[g_detail_idx].glcf004 != g_glcf3_d_t.glcf004 OR g_glcf3_d[g_detail_idx].glcf005 != g_glcf3_d_t.glcf005)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM glcf_t WHERE "||"glcfent = '" ||g_enterprise|| "' AND "||"glcfld = '"||g_glce_m.glceld ||"' AND "|| "glcf001 = '"||g_glce_m.glce001 ||"' AND "|| "glcf002 = '"||g_glce_m.glce002 ||"' AND "|| "glcf003 = '"||g_glcf3_d[g_detail_idx].glcf003 ||"' AND "|| "glcf004 = '"||g_glcf3_d[g_detail_idx].glcf004 ||"' AND "|| "glcf005 = '"||g_glcf3_d[g_detail_idx].glcf005 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page3.glcf004_3" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            #確認資料無重複
            IF  g_glce_m.glceld IS NOT NULL AND g_glce_m.glce001 IS NOT NULL AND g_glce_m.glce002 IS NOT NULL AND g_glcf3_d[g_detail_idx].glcf003 IS NOT NULL AND g_glcf3_d[g_detail_idx].glcf004 IS NOT NULL AND g_glcf3_d[g_detail_idx].glcf005 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_glce_m.glceld != g_glceld_t OR g_glce_m.glce001 != g_glce001_t OR g_glce_m.glce002 != g_glce002_t OR g_glcf3_d[g_detail_idx].glcf003 != g_glcf3_d_t.glcf003 OR g_glcf3_d[g_detail_idx].glcf004 != g_glcf3_d_t.glcf004 OR g_glcf3_d[g_detail_idx].glcf005 != g_glcf3_d_t.glcf005)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM glcf_t WHERE "||"glcfent = '" ||g_enterprise|| "' AND "||"glcfld = '"||g_glce_m.glceld ||"' AND "|| "glcf001 = '"||g_glce_m.glce001 ||"' AND "|| "glcf002 = '"||g_glce_m.glce002 ||"' AND "|| "glcf003 = '"||g_glcf3_d[g_detail_idx].glcf003 ||"' AND "|| "glcf004 = '"||g_glcf3_d[g_detail_idx].glcf004 ||"' AND "|| "glcf005 = '"||g_glcf3_d[g_detail_idx].glcf005 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page3.glcf005_3" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            #確認資料無重複
            IF  g_glce_m.glceld IS NOT NULL AND g_glce_m.glce001 IS NOT NULL AND g_glce_m.glce002 IS NOT NULL AND g_glcf3_d[g_detail_idx].glcf003 IS NOT NULL AND g_glcf3_d[g_detail_idx].glcf004 IS NOT NULL AND g_glcf3_d[g_detail_idx].glcf005 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_glce_m.glceld != g_glceld_t OR g_glce_m.glce001 != g_glce001_t OR g_glce_m.glce002 != g_glce002_t OR g_glcf3_d[g_detail_idx].glcf003 != g_glcf3_d_t.glcf003 OR g_glcf3_d[g_detail_idx].glcf004 != g_glcf3_d_t.glcf004 OR g_glcf3_d[g_detail_idx].glcf005 != g_glcf3_d_t.glcf005)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM glcf_t WHERE "||"glcfent = '" ||g_enterprise|| "' AND "||"glcfld = '"||g_glce_m.glceld ||"' AND "|| "glcf001 = '"||g_glce_m.glce001 ||"' AND "|| "glcf002 = '"||g_glce_m.glce002 ||"' AND "|| "glcf003 = '"||g_glcf3_d[g_detail_idx].glcf003 ||"' AND "|| "glcf004 = '"||g_glcf3_d[g_detail_idx].glcf004 ||"' AND "|| "glcf005 = '"||g_glcf3_d[g_detail_idx].glcf005 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page4.glcf003_4" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            #確認資料無重複
            IF  g_glce_m.glceld IS NOT NULL AND g_glce_m.glce001 IS NOT NULL AND g_glce_m.glce002 IS NOT NULL AND g_glcf4_d[g_detail_idx].glcf003 IS NOT NULL AND g_glcf4_d[g_detail_idx].glcf004 IS NOT NULL AND g_glcf4_d[g_detail_idx].glcf005 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_glce_m.glceld != g_glceld_t OR g_glce_m.glce001 != g_glce001_t OR g_glce_m.glce002 != g_glce002_t OR g_glcf4_d[g_detail_idx].glcf003 != g_glcf4_d_t.glcf003 OR g_glcf4_d[g_detail_idx].glcf004 != g_glcf4_d_t.glcf004 OR g_glcf4_d[g_detail_idx].glcf005 != g_glcf4_d_t.glcf005)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM glcf_t WHERE "||"glcfent = '" ||g_enterprise|| "' AND "||"glcfld = '"||g_glce_m.glceld ||"' AND "|| "glcf001 = '"||g_glce_m.glce001 ||"' AND "|| "glcf002 = '"||g_glce_m.glce002 ||"' AND "|| "glcf003 = '"||g_glcf4_d[g_detail_idx].glcf003 ||"' AND "|| "glcf004 = '"||g_glcf4_d[g_detail_idx].glcf004 ||"' AND "|| "glcf005 = '"||g_glcf4_d[g_detail_idx].glcf005 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page4.glcf004_4" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            #確認資料無重複
            IF  g_glce_m.glceld IS NOT NULL AND g_glce_m.glce001 IS NOT NULL AND g_glce_m.glce002 IS NOT NULL AND g_glcf4_d[g_detail_idx].glcf003 IS NOT NULL AND g_glcf4_d[g_detail_idx].glcf004 IS NOT NULL AND g_glcf4_d[g_detail_idx].glcf005 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_glce_m.glceld != g_glceld_t OR g_glce_m.glce001 != g_glce001_t OR g_glce_m.glce002 != g_glce002_t OR g_glcf4_d[g_detail_idx].glcf003 != g_glcf4_d_t.glcf003 OR g_glcf4_d[g_detail_idx].glcf004 != g_glcf4_d_t.glcf004 OR g_glcf4_d[g_detail_idx].glcf005 != g_glcf4_d_t.glcf005)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM glcf_t WHERE "||"glcfent = '" ||g_enterprise|| "' AND "||"glcfld = '"||g_glce_m.glceld ||"' AND "|| "glcf001 = '"||g_glce_m.glce001 ||"' AND "|| "glcf002 = '"||g_glce_m.glce002 ||"' AND "|| "glcf003 = '"||g_glcf4_d[g_detail_idx].glcf003 ||"' AND "|| "glcf004 = '"||g_glcf4_d[g_detail_idx].glcf004 ||"' AND "|| "glcf005 = '"||g_glcf4_d[g_detail_idx].glcf005 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page4.glcf005_4" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            #確認資料無重複
            IF  g_glce_m.glceld IS NOT NULL AND g_glce_m.glce001 IS NOT NULL AND g_glce_m.glce002 IS NOT NULL AND g_glcf4_d[g_detail_idx].glcf003 IS NOT NULL AND g_glcf4_d[g_detail_idx].glcf004 IS NOT NULL AND g_glcf4_d[g_detail_idx].glcf005 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_glce_m.glceld != g_glceld_t OR g_glce_m.glce001 != g_glce001_t OR g_glce_m.glce002 != g_glce002_t OR g_glcf4_d[g_detail_idx].glcf003 != g_glcf4_d_t.glcf003 OR g_glcf4_d[g_detail_idx].glcf004 != g_glcf4_d_t.glcf004 OR g_glcf4_d[g_detail_idx].glcf005 != g_glcf4_d_t.glcf005)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM glcf_t WHERE "||"glcfent = '" ||g_enterprise|| "' AND "||"glcfld = '"||g_glce_m.glceld ||"' AND "|| "glcf001 = '"||g_glce_m.glce001 ||"' AND "|| "glcf002 = '"||g_glce_m.glce002 ||"' AND "|| "glcf003 = '"||g_glcf4_d[g_detail_idx].glcf003 ||"' AND "|| "glcf004 = '"||g_glcf4_d[g_detail_idx].glcf004 ||"' AND "|| "glcf005 = '"||g_glcf4_d[g_detail_idx].glcf005 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page4.glcf047" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.a.page4.glcf047_desc" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_glcf4_d[l_ac].glcf047_desc) THEN
               IF l_cmd='a' OR (l_cmd='u' AND (g_glcf4_d[l_ac].glcf047_desc <> g_glcf4_d_t.glcf047 OR cl_null(g_glcf4_d_t.glcf047))) THEN
                  CALL s_voucher_glaq002_chk(g_glce_m.glceld,g_glcf4_d[l_ac].glcf047_desc)
                  IF NOT cl_null(g_errno) THEN
                     INITIALIZE g_errparam TO NULL
                     LET g_errparam.code = g_errno
                     LET g_errparam.extend = g_glcf4_d[l_ac].glcf047_desc
                     LET g_errparam.popup = TRUE
                     CALL cl_err()
                  
                     LET g_glcf4_d[l_ac].glcf047_desc = g_glcf4_d_t.glcf047_desc
                     NEXT FIELD glcf047_desc                  
                  END IF 
                  LET g_glcf4_d[l_ac].glcf047 = g_glcf4_d[l_ac].glcf047_desc
                              
                  #核算项維護
                  CALL aglt310_02('',g_glce_m.glceld,'',l_date,g_glcf4_d[l_ac].glcf047_desc,'','aglt420',g_glcf_r.*) 
                  RETURNING g_glcf4_d[l_ac].glcf048,g_glcf4_d[l_ac].glcf049,g_glcf4_d[l_ac].glcf050,
                            g_glcf4_d[l_ac].glcf051,g_glcf4_d[l_ac].glcf052,g_glcf4_d[l_ac].glcf053,
                            g_glcf4_d[l_ac].glcf054,g_glcf4_d[l_ac].glcf055,g_glcf4_d[l_ac].glcf056,
                            g_glcf4_d[l_ac].glcf057,g_glcf4_d[l_ac].glcf058,g_glcf4_d[l_ac].glcf059,
                            g_glcf4_d[l_ac].glcf060,g_glcf4_d[l_ac].glcf061,g_glcf4_d[l_ac].glcf062,
                            g_glcf4_d[l_ac].glcf063,g_glcf4_d[l_ac].glcf064,g_glcf4_d[l_ac].glcf065,
                            g_glcf4_d[l_ac].glcf066,g_glcf4_d[l_ac].glcf067,g_glcf4_d[l_ac].glcf068,
                            g_glcf4_d[l_ac].glcf069,g_glcf4_d[l_ac].glcf070,g_glcf4_d[l_ac].glcf071,
                            g_glcf_r.glbc004
                            
                  CALL aglt420_detail_show_2()
                  DISPLAY BY NAME g_glcf4_d[l_ac].glcf048_desc,g_glcf4_d[l_ac].glcf049_desc,g_glcf4_d[l_ac].glcf050_desc,
                                  g_glcf4_d[l_ac].glcf051_desc,g_glcf4_d[l_ac].glcf052_desc,g_glcf4_d[l_ac].glcf053_desc,
                                  g_glcf4_d[l_ac].glcf054_desc,g_glcf4_d[l_ac].glcf055_desc,g_glcf4_d[l_ac].glcf056,
                                  g_glcf4_d[l_ac].glcf057_desc,g_glcf4_d[l_ac].glcf058_desc,g_glcf4_d[l_ac].glcf059_desc,
                                  g_glcf4_d[l_ac].glcf060,g_glcf4_d[l_ac].glcf061,
                                  g_glcf4_d[l_ac].glcf062_desc,g_glcf4_d[l_ac].glcf063_desc,g_glcf4_d[l_ac].glcf064_desc,
                                  g_glcf4_d[l_ac].glcf065_desc,g_glcf4_d[l_ac].glcf066_desc,g_glcf4_d[l_ac].glcf067_desc,
                                  g_glcf4_d[l_ac].glcf068_desc,g_glcf4_d[l_ac].glcf069_desc,g_glcf4_d[l_ac].glcf070_desc,
                                  g_glcf4_d[l_ac].glcf071_desc
                  #自由核算项启用设置
                  SELECT glad017,glad0171,glad0172,glad018,glad0181,glad0182,
                         glad019,glad0191,glad0192,glad020,glad0201,glad0202,
                         glad021,glad0211,glad0212,glad022,glad0221,glad0222,
                         glad023,glad0231,glad0232,glad024,glad0221,glad0242,
                         glad025,glad0251,glad0252,glad026,glad0261,glad0262
                   INTO  g_glad017,g_glad0171,g_glad0172,g_glad018,g_glad0181,g_glad0182,
                         g_glad019,g_glad0191,g_glad0192,g_glad020,g_glad0201,g_glad0202,
                         g_glad021,g_glad0211,g_glad0212,g_glad022,g_glad0221,g_glad0222,
                         g_glad023,g_glad0231,g_glad0232,g_glad024,g_glad0241,g_glad0242,
                         g_glad025,g_glad0251,g_glad0252,g_glad026,g_glad0261,g_glad0262
                   FROM  glad_t
                   WHERE gladent = g_enterprise
                     AND gladld = g_glce_m.glceld
                     AND glad001 = g_glcf4_d[l_ac].glcf047
                  #判斷科目是否已存在單身中，如果不存在則需要設置核算項欄位顯示
                  LET l_cnt=0
                  SELECT COUNT(*) INTO l_cnt FROM glcf_t 
                   WHERE glcfent=g_enterprise AND glcfld=g_glce_m.glceld AND glcf001=g_glce_m.glce001
                     AND glcf002=g_glce_m.glce002 AND glcf003=g_glcf4_d[l_ac].glcf047 
                  IF l_cnt=0 THEN
                     CALL aglt420_set_fix_visible(g_glcf4_d[l_ac].glcf047)
                  END IF
               END IF
            END IF 
            CALL s_desc_get_account_desc(g_glce_m.glceld,g_glcf4_d[l_ac].glcf047_desc) RETURNING l_desc
            LET g_glcf4_d[l_ac].glcf047_desc = g_glcf4_d[l_ac].glcf047_desc,'\n',l_desc]]>
  </point>
  <point name="input.a.page4.glcf048_desc" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_glcf4_d[l_ac].glcf048_desc) THEN
               CALL s_voucher_glaq017_chk(g_glcf4_d[l_ac].glcf048_desc)
               IF NOT cl_null(g_errno) THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = g_errno
                  LET g_errparam.extend = g_glcf4_d[l_ac].glcf048_desc
                  LET g_errparam.popup = TRUE
                  CALL cl_err()
                  LET g_glcf4_d[l_ac].glcf048_desc = g_glcf4_d_t.glcf048_desc
                  NEXT FIELD glcf048_desc
               END IF
               LET g_glcf4_d[l_ac].glcf048 = g_glcf4_d[l_ac].glcf048_desc
            END IF
            CALL s_desc_get_department_desc(g_glcf4_d[l_ac].glcf048) RETURNING l_desc
            LET g_glcf4_d[l_ac].glcf048_desc = g_glcf4_d[l_ac].glcf048_desc,'\n',l_desc]]>
  </point>
  <point name="input.a.page4.glcf049_desc" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_glcf4_d[l_ac].glcf049_desc) THEN
               CALL s_department_chk(g_glcf4_d[l_ac].glcf049_desc,l_date) RETURNING l_success
               IF l_success = FALSE THEN
#                  INITIALIZE g_errparam TO NULL
#                  LET g_errparam.code = g_errno
#                  LET g_errparam.extend = g_glcf4_d[l_ac].glcf049_desc
#                  LET g_errparam.popup = TRUE
#                  CALL cl_err()
                  LET g_glcf4_d[l_ac].glcf049_desc = g_glcf4_d_t.glcf049_desc
                  NEXT FIELD glcf049_desc
               END IF
               LET g_glcf4_d[l_ac].glcf049 = g_glcf4_d[l_ac].glcf049_desc
            END IF
            CALL s_desc_get_department_desc(g_glcf4_d[l_ac].glcf049) RETURNING l_desc
            LET g_glcf4_d[l_ac].glcf049_desc = g_glcf4_d[l_ac].glcf049_desc,'\n',l_desc]]>
  </point>
  <point name="input.a.page4.glcf050_desc" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_glcf4_d[l_ac].glcf050_desc) THEN
               CALL s_voucher_glaq019_chk(g_glcf4_d[l_ac].glcf050_desc,l_date) 
               IF NOT cl_null(g_errno) THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = g_errno
                  LET g_errparam.extend = g_glcf4_d[l_ac].glcf050_desc
                  LET g_errparam.popup = TRUE
                  CALL cl_err()
                  LET g_glcf4_d[l_ac].glcf050_desc = g_glcf4_d_t.glcf050_desc
                  NEXT FIELD glcf050_desc
               END IF
               LET g_glcf4_d[l_ac].glcf050 = g_glcf4_d[l_ac].glcf050_desc
            END IF
            CALL s_desc_get_department_desc(g_glcf4_d[l_ac].glcf050) RETURNING l_desc
            LET g_glcf4_d[l_ac].glcf050_desc = g_glcf4_d[l_ac].glcf050_desc,'\n',l_desc]]>
  </point>
  <point name="input.a.page4.glcf051_desc" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_glcf4_d[l_ac].glcf051_desc) THEN
               CALL s_azzi650_chk_exist('287',g_glcf4_d[l_ac].glcf051_desc) RETURNING l_success
               IF NOT l_success THEN
#                  INITIALIZE g_errparam TO NULL
#                  LET g_errparam.code = g_errno
#                  LET g_errparam.extend = g_glcf4_d[l_ac].glcf051_desc
#                  LET g_errparam.popup = TRUE
#                  CALL cl_err()
                  LET g_glcf4_d[l_ac].glcf051_desc = g_glcf4_d_t.glcf051_desc
                  NEXT FIELD glcf051_desc
               END IF
               LET g_glcf4_d[l_ac].glcf051 = g_glcf4_d[l_ac].glcf051_desc
            END IF
            CALL s_desc_get_acc_desc('287',g_glcf4_d[l_ac].glcf051) RETURNING l_desc
            LET g_glcf4_d[l_ac].glcf051_desc = g_glcf4_d[l_ac].glcf051_desc,'\n',l_desc]]>
  </point>
  <point name="input.a.page4.glcf052_desc" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_glcf4_d[l_ac].glcf052_desc) THEN
               CALL s_voucher_glaq021_chk(g_glcf4_d[l_ac].glcf052_desc) 
               IF NOT cl_null(g_errno) THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = g_errno
                  LET g_errparam.extend = g_glcf4_d[l_ac].glcf052_desc
                  LET g_errparam.popup = TRUE
                  CALL cl_err()
                  LET g_glcf4_d[l_ac].glcf052_desc = g_glcf4_d_t.glcf052_desc
                  NEXT FIELD glcf052_desc
               END IF
               LET g_glcf4_d[l_ac].glcf052 = g_glcf4_d[l_ac].glcf052_desc
            END IF
            CALL s_desc_get_trading_partner_abbr_desc(g_glcf4_d[l_ac].glcf052) RETURNING l_desc
            LET g_glcf4_d[l_ac].glcf052_desc = g_glcf4_d[l_ac].glcf052_desc,'\n',l_desc]]>
  </point>
  <point name="input.a.page4.glcf053_desc" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_glcf4_d[l_ac].glcf053_desc) THEN
               CALL s_voucher_glaq021_chk(g_glcf4_d[l_ac].glcf053_desc) 
               IF NOT cl_null(g_errno) THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = g_errno
                  LET g_errparam.extend = g_glcf4_d[l_ac].glcf053_desc
                  LET g_errparam.popup = TRUE
                  CALL cl_err()
                  LET g_glcf4_d[l_ac].glcf053_desc = g_glcf4_d_t.glcf053_desc
                  NEXT FIELD glcf053_desc
               END IF
               LET g_glcf4_d[l_ac].glcf053 = g_glcf4_d[l_ac].glcf053_desc
            END IF
            CALL s_desc_get_trading_partner_abbr_desc(g_glcf4_d[l_ac].glcf053_desc) RETURNING l_desc
            LET g_glcf4_d[l_ac].glcf053_desc = g_glcf4_d[l_ac].glcf053_desc,'\n',l_desc]]>
  </point>
  <point name="input.a.page4.glcf054_desc" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_glcf4_d[l_ac].glcf054_desc) THEN
               CALL s_azzi650_chk_exist('281',g_glcf4_d[l_ac].glcf054_desc) RETURNING l_success 
               IF NOT l_success THEN
#                  INITIALIZE g_errparam TO NULL
#                  LET g_errparam.code = g_errno
#                  LET g_errparam.extend = g_glcf4_d[l_ac].glcf054_desc
#                  LET g_errparam.popup = TRUE
#                  CALL cl_err()
                  LET g_glcf4_d[l_ac].glcf054_desc = g_glcf4_d_t.glcf054_desc
                  NEXT FIELD glcf054_desc
               END IF
               LET g_glcf4_d[l_ac].glcf054 = g_glcf4_d[l_ac].glcf054_desc
            END IF
            CALL s_desc_get_acc_desc('281',g_glcf4_d[l_ac].glcf051) RETURNING l_desc
            LET g_glcf4_d[l_ac].glcf054_desc = g_glcf4_d[l_ac].glcf054_desc,'\n',l_desc]]>
  </point>
  <point name="input.a.page4.glcf055_desc" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_glcf4_d[l_ac].glcf055_desc) THEN
               CALL s_voucher_glaq024_chk(g_glcf4_d[l_ac].glcf055_desc) 
               IF NOT cl_null(g_errno) THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = g_errno
                  LET g_errparam.extend = g_glcf4_d[l_ac].glcf055_desc
                  LET g_errparam.popup = TRUE
                  CALL cl_err()
                  LET g_glcf4_d[l_ac].glcf055_desc = g_glcf4_d_t.glcf055_desc
                  NEXT FIELD glcf055_desc
               END IF
               LET g_glcf4_d[l_ac].glcf055 = g_glcf4_d[l_ac].glcf055_desc
            END IF
            CALL s_desc_get_rtaxl003_desc(g_glcf4_d[l_ac].glcf055_desc) RETURNING l_desc
            LET g_glcf4_d[l_ac].glcf055_desc = g_glcf4_d[l_ac].glcf055_desc,'\n',l_desc]]>
  </point>
  <point name="input.a.page4.glcf056" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.a.page4.glcf057_desc" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_glcf4_d[l_ac].glcf057_desc) THEN
               CALL s_voucher_glaq052_chk(g_glcf4_d[l_ac].glcf057_desc) 
               IF NOT cl_null(g_errno) THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = g_errno
                  LET g_errparam.extend = g_glcf4_d[l_ac].glcf057_desc
                  LET g_errparam.popup = TRUE
                  CALL cl_err()
                  LET g_glcf4_d[l_ac].glcf057_desc = g_glcf4_d_t.glcf057_desc
                  NEXT FIELD glcf057_desc
               END IF
               LET g_glcf4_d[l_ac].glcf057 = g_glcf4_d[l_ac].glcf057_desc
            END IF
            CALL s_desc_get_oojdl003_desc(g_glcf4_d[l_ac].glcf057_desc) RETURNING l_desc
            LET g_glcf4_d[l_ac].glcf057_desc = g_glcf4_d[l_ac].glcf057_desc,'\n',l_desc]]>
  </point>
  <point name="input.a.page4.glcf058_desc" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_glcf4_d[l_ac].glcf058_desc) THEN
               CALL s_azzi650_chk_exist('2002',g_glcf4_d[l_ac].glcf058_desc) RETURNING l_success
               IF NOT l_success THEN
#                  INITIALIZE g_errparam TO NULL
#                  LET g_errparam.code = g_errno
#                  LET g_errparam.extend = g_glcf4_d[l_ac].glcf058_desc
#                  LET g_errparam.popup = TRUE
#                  CALL cl_err()
                  LET g_glcf4_d[l_ac].glcf058_desc = g_glcf4_d_t.glcf058_desc
                  NEXT FIELD glcf058_desc
               END IF
               LET g_glcf4_d[l_ac].glcf058 = g_glcf4_d[l_ac].glcf058_desc
            END IF
            CALL s_desc_get_acc_desc('2002',g_glcf4_d[l_ac].glcf058) RETURNING l_desc
            LET g_glcf4_d[l_ac].glcf058_desc = g_glcf4_d[l_ac].glcf058_desc,'\n',l_desc]]>
  </point>
  <point name="input.a.page4.glcf059_desc" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_glcf4_d[l_ac].glcf059_desc) THEN
               CALL s_employee_chk(g_glcf4_d[l_ac].glcf059_desc) RETURNING l_success
               IF NOT l_success THEN
#                  INITIALIZE g_errparam TO NULL
#                  LET g_errparam.code = g_errno
#                  LET g_errparam.extend = g_glcf4_d[l_ac].glcf059_desc
#                  LET g_errparam.popup = TRUE
#                  CALL cl_err()
                  LET g_glcf4_d[l_ac].glcf059_desc = g_glcf4_d_t.glcf059_desc
                  NEXT FIELD glcf059_desc
               END IF
               LET g_glcf4_d[l_ac].glcf059 = g_glcf4_d[l_ac].glcf059_desc
            END IF
            CALL s_desc_get_person_desc(g_glcf4_d[l_ac].glcf059) RETURNING l_desc
            LET g_glcf4_d[l_ac].glcf059_desc = g_glcf4_d[l_ac].glcf059_desc,'\n',l_desc]]>
  </point>
  <point name="input.a.page4.glcf060" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="input.a.page4.glcf060_desc" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_glcf4_d[l_ac].glcf060_desc) THEN
               CALL s_aap_project_chk(g_glcf4_d[l_ac].glcf060_desc) RETURNING l_success,g_errno
               IF NOT l_success THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = g_errno
                  LET g_errparam.extend = g_glcf4_d[l_ac].glcf060_desc
                  LET g_errparam.popup = TRUE
                  CALL cl_err()
                  LET g_glcf4_d[l_ac].glcf060_desc = g_glcf4_d_t.glcf060_desc
                  NEXT FIELD glcf060_desc
               END IF
               LET g_glcf4_d[l_ac].glcf060 = g_glcf4_d[l_ac].glcf060_desc
            END IF
            CALL s_desc_get_project_desc(g_glcf4_d[l_ac].glcf060) RETURNING l_desc
            LET g_glcf4_d[l_ac].glcf060_desc = g_glcf4_d[l_ac].glcf060_desc,'\n',l_desc]]>
  </point>
  <point name="input.a.page4.glcf061_desc" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_glcf4_d[l_ac].glcf061_desc) THEN
               CALL s_voucher_glaq028_chk(g_glcf4_d[l_ac].glcf060,g_glcf4_d[l_ac].glcf061_desc) 
               IF NOT cl_null(g_errno) THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = g_errno
                  LET g_errparam.extend = g_glcf4_d[l_ac].glcf061_desc
                  LET g_errparam.popup = TRUE
                  CALL cl_err()
                  LET g_glcf4_d[l_ac].glcf061_desc = g_glcf4_d_t.glcf061_desc
                  NEXT FIELD glcf061_desc
               END IF
               LET g_glcf4_d[l_ac].glcf061 = g_glcf4_d[l_ac].glcf061_desc
            END IF
            CALL s_desc_get_wbs_desc(g_glcf4_d[l_ac].glcf060,g_glcf4_d[l_ac].glcf061) RETURNING l_desc
            LET g_glcf4_d[l_ac].glcf061_desc = g_glcf4_d[l_ac].glcf061_desc,'\n',l_desc]]>
  </point>
  <point name="input.a.page4.glcf062_desc" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_glcf4_d[l_ac].glcf062_desc) THEN
               CALL s_voucher_free_account_chk(g_glad0171,g_glcf4_d[l_ac].glcf062_desc,g_glad0172) RETURNING l_errno
               IF NOT cl_null(l_errno) THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = l_errno
                  LET g_errparam.extend = g_glcf4_d[l_ac].glcf062_desc
                  LET g_errparam.popup = TRUE
                  CALL cl_err()
                  LET g_glcf4_d[l_ac].glcf062_desc = g_glcf4_d_t.glcf062_desc
                  NEXT FIELD glcf062_desc
               END IF
               LET g_glcf4_d[l_ac].glcf062 = g_glcf4_d[l_ac].glcf062_desc
            END IF
            CALL s_voucher_free_account_desc(g_glad0171,g_glcf4_d[l_ac].glcf062) RETURNING l_desc
            LET g_glcf4_d[l_ac].glcf062_desc = g_glcf4_d[l_ac].glcf062,'\n',l_desc]]>
  </point>
  <point name="input.a.page4.glcf063_desc" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_glcf4_d[l_ac].glcf063_desc) THEN
               CALL s_voucher_free_account_chk(g_glad0181,g_glcf4_d[l_ac].glcf063_desc,g_glad0182) RETURNING l_errno
               IF NOT cl_null(l_errno) THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = l_errno
                  LET g_errparam.extend = g_glcf4_d[l_ac].glcf063_desc
                  LET g_errparam.popup = TRUE
                  CALL cl_err()
                  LET g_glcf4_d[l_ac].glcf063_desc = g_glcf4_d_t.glcf063_desc
                  NEXT FIELD glcf063_desc
               END IF
               LET g_glcf4_d[l_ac].glcf063 = g_glcf4_d[l_ac].glcf063_desc
            END IF
            CALL s_voucher_free_account_desc(g_glad0181,g_glcf4_d[l_ac].glcf063) RETURNING l_desc
            LET g_glcf4_d[l_ac].glcf063_desc = g_glcf4_d[l_ac].glcf063,'\n',l_desc]]>
  </point>
  <point name="input.a.page4.glcf064_desc" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_glcf4_d[l_ac].glcf064_desc) THEN
               CALL s_voucher_free_account_chk(g_glad0191,g_glcf4_d[l_ac].glcf064_desc,g_glad0192) RETURNING l_errno
               IF NOT cl_null(l_errno) THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = l_errno
                  LET g_errparam.extend = g_glcf4_d[l_ac].glcf064_desc
                  LET g_errparam.popup = TRUE
                  CALL cl_err()
                  LET g_glcf4_d[l_ac].glcf064_desc = g_glcf4_d_t.glcf064_desc
                  NEXT FIELD glcf064_desc
               END IF
               LET g_glcf4_d[l_ac].glcf064 = g_glcf4_d[l_ac].glcf064_desc
            END IF
            CALL s_voucher_free_account_desc(g_glad0191,g_glcf4_d[l_ac].glcf064) RETURNING l_desc
            LET g_glcf4_d[l_ac].glcf064_desc = g_glcf4_d[l_ac].glcf069,'\n',l_desc]]>
  </point>
  <point name="input.a.page4.glcf065_desc" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_glcf4_d[l_ac].glcf065_desc) THEN
               CALL s_voucher_free_account_chk(g_glad0201,g_glcf4_d[l_ac].glcf065_desc,g_glad0202) RETURNING l_errno
               IF NOT cl_null(l_errno) THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = l_errno
                  LET g_errparam.extend = g_glcf4_d[l_ac].glcf065_desc
                  LET g_errparam.popup = TRUE
                  CALL cl_err()
                  LET g_glcf4_d[l_ac].glcf065_desc = g_glcf4_d_t.glcf065_desc
                  NEXT FIELD glcf065_desc
               END IF
               LET g_glcf4_d[l_ac].glcf065 = g_glcf4_d[l_ac].glcf065_desc
            END IF
            CALL s_voucher_free_account_desc(g_glad0201,g_glcf4_d[l_ac].glcf065) RETURNING l_desc
            LET g_glcf4_d[l_ac].glcf065_desc = g_glcf4_d[l_ac].glcf065,'\n',l_desc]]>
  </point>
  <point name="input.a.page4.glcf066_desc" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_glcf4_d[l_ac].glcf066_desc) THEN
               CALL s_voucher_free_account_chk(g_glad0211,g_glcf4_d[l_ac].glcf066_desc,g_glad0212) RETURNING l_errno
               IF NOT cl_null(l_errno) THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = l_errno
                  LET g_errparam.extend = g_glcf4_d[l_ac].glcf066_desc
                  LET g_errparam.popup = TRUE
                  CALL cl_err()
                  LET g_glcf4_d[l_ac].glcf066_desc = g_glcf4_d_t.glcf066_desc
                  NEXT FIELD glcf066_desc
               END IF
               LET g_glcf4_d[l_ac].glcf066 = g_glcf4_d[l_ac].glcf066_desc
            END IF
            CALL s_voucher_free_account_desc(g_glad0211,g_glcf4_d[l_ac].glcf066) RETURNING l_desc
            LET g_glcf4_d[l_ac].glcf066_desc = g_glcf4_d[l_ac].glcf066,'\n',l_desc]]>
  </point>
  <point name="input.a.page4.glcf067_desc" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_glcf4_d[l_ac].glcf067_desc) THEN
               CALL s_voucher_free_account_chk(g_glad0221,g_glcf4_d[l_ac].glcf067_desc,g_glad0222) RETURNING l_errno
               IF NOT cl_null(l_errno) THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = l_errno
                  LET g_errparam.extend = g_glcf4_d[l_ac].glcf067_desc
                  LET g_errparam.popup = TRUE
                  CALL cl_err()
                  LET g_glcf4_d[l_ac].glcf067_desc = g_glcf4_d_t.glcf067_desc
                  NEXT FIELD glcf067_desc
               END IF
               LET g_glcf4_d[l_ac].glcf067 = g_glcf4_d[l_ac].glcf067_desc
            END IF
            CALL s_voucher_free_account_desc(g_glad0221,g_glcf4_d[l_ac].glcf067) RETURNING l_desc
            LET g_glcf4_d[l_ac].glcf067_desc = g_glcf4_d[l_ac].glcf067,'\n',l_desc]]>
  </point>
  <point name="input.a.page4.glcf068_desc" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_glcf4_d[l_ac].glcf068_desc) THEN
               CALL s_voucher_free_account_chk(g_glad0231,g_glcf4_d[l_ac].glcf068_desc,g_glad0232) RETURNING l_errno
               IF NOT cl_null(l_errno) THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = l_errno
                  LET g_errparam.extend = g_glcf4_d[l_ac].glcf068_desc
                  LET g_errparam.popup = TRUE
                  CALL cl_err()
                  LET g_glcf4_d[l_ac].glcf068_desc = g_glcf4_d_t.glcf068_desc
                  NEXT FIELD glcf068_desc
               END IF
               LET g_glcf4_d[l_ac].glcf068 = g_glcf4_d[l_ac].glcf068_desc
            END IF
            CALL s_voucher_free_account_desc(g_glad0231,g_glcf4_d[l_ac].glcf068) RETURNING l_desc
            LET g_glcf4_d[l_ac].glcf068_desc = g_glcf4_d[l_ac].glcf068,'\n',l_desc]]>
  </point>
  <point name="input.a.page4.glcf069_desc" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_glcf4_d[l_ac].glcf069_desc) THEN
               CALL s_voucher_free_account_chk(g_glad0241,g_glcf4_d[l_ac].glcf069_desc,g_glad0242) RETURNING l_errno
               IF NOT cl_null(l_errno) THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = l_errno
                  LET g_errparam.extend = g_glcf4_d[l_ac].glcf069_desc
                  LET g_errparam.popup = TRUE
                  CALL cl_err()
                  LET g_glcf4_d[l_ac].glcf069_desc = g_glcf4_d_t.glcf069_desc
                  NEXT FIELD glcf069_desc
               END IF
               LET g_glcf4_d[l_ac].glcf069 = g_glcf4_d[l_ac].glcf069_desc
            END IF
            CALL s_voucher_free_account_desc(g_glad0241,g_glcf4_d[l_ac].glcf069) RETURNING l_desc
            LET g_glcf4_d[l_ac].glcf069_desc = g_glcf4_d[l_ac].glcf069,'\n',l_desc]]>
  </point>
  <point name="input.a.page4.glcf070_desc" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_glcf4_d[l_ac].glcf070_desc) THEN
               CALL s_voucher_free_account_chk(g_glad0251,g_glcf4_d[l_ac].glcf070_desc,g_glad0252) RETURNING l_errno
               IF NOT cl_null(l_errno) THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = l_errno
                  LET g_errparam.extend = g_glcf4_d[l_ac].glcf070_desc
                  LET g_errparam.popup = TRUE
                  CALL cl_err()
                  LET g_glcf4_d[l_ac].glcf070_desc = g_glcf4_d_t.glcf070_desc
                  NEXT FIELD glcf070_desc
               END IF
               LET g_glcf4_d[l_ac].glcf070 = g_glcf4_d[l_ac].glcf070_desc
            END IF
            CALL s_voucher_free_account_desc(g_glad0251,g_glcf4_d[l_ac].glcf070) RETURNING l_desc
            LET g_glcf4_d[l_ac].glcf070_desc = g_glcf4_d[l_ac].glcf070,'\n',l_desc]]>
  </point>
  <point name="input.a.page4.glcf071_desc" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_glcf4_d[l_ac].glcf071_desc) THEN
               CALL s_voucher_free_account_chk(g_glad0261,g_glcf4_d[l_ac].glcf071_desc,g_glad0262) RETURNING l_errno
               IF NOT cl_null(l_errno) THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = l_errno
                  LET g_errparam.extend = g_glcf4_d[l_ac].glcf071_desc
                  LET g_errparam.popup = TRUE
                  CALL cl_err()
                  LET g_glcf4_d[l_ac].glcf071_desc = g_glcf4_d_t.glcf071_desc
                  NEXT FIELD glcf071_desc
               END IF
               LET g_glcf4_d[l_ac].glcf071 = g_glcf4_d[l_ac].glcf071_desc
            END IF
            CALL s_voucher_free_account_desc(g_glad0261,g_glcf4_d[l_ac].glcf071) RETURNING l_desc
            LET g_glcf4_d[l_ac].glcf071_desc = g_glcf4_d[l_ac].glcf071,'\n',l_desc]]>
  </point>
  <point name="input.b.page4.glcf047_desc" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_glcf4_d[l_ac].glcf047_desc = g_glcf4_d[l_ac].glcf047
            #核算項
            LET g_glcf_r.glcf048 = g_glcf4_d[l_ac].glcf048
            LET g_glcf_r.glcf049 = g_glcf4_d[l_ac].glcf049
            LET g_glcf_r.glcf050 = g_glcf4_d[l_ac].glcf050
            LET g_glcf_r.glcf051 = g_glcf4_d[l_ac].glcf051
            LET g_glcf_r.glcf052 = g_glcf4_d[l_ac].glcf052
            LET g_glcf_r.glcf053 = g_glcf4_d[l_ac].glcf053
            LET g_glcf_r.glcf054 = g_glcf4_d[l_ac].glcf054
            LET g_glcf_r.glcf055 = g_glcf4_d[l_ac].glcf055
            LET g_glcf_r.glcf056 = g_glcf4_d[l_ac].glcf056
            LET g_glcf_r.glcf057 = g_glcf4_d[l_ac].glcf057
            LET g_glcf_r.glcf058 = g_glcf4_d[l_ac].glcf058
            LET g_glcf_r.glcf059 = g_glcf4_d[l_ac].glcf059
            LET g_glcf_r.glcf060 = g_glcf4_d[l_ac].glcf060
            LET g_glcf_r.glcf061 = g_glcf4_d[l_ac].glcf061
            LET g_glcf_r.glcf062 = g_glcf4_d[l_ac].glcf062
            LET g_glcf_r.glcf063 = g_glcf4_d[l_ac].glcf063
            LET g_glcf_r.glcf064 = g_glcf4_d[l_ac].glcf064
            LET g_glcf_r.glcf065 = g_glcf4_d[l_ac].glcf065
            LET g_glcf_r.glcf066 = g_glcf4_d[l_ac].glcf066
            LET g_glcf_r.glcf067 = g_glcf4_d[l_ac].glcf067
            LET g_glcf_r.glcf068 = g_glcf4_d[l_ac].glcf068
            LET g_glcf_r.glcf069 = g_glcf4_d[l_ac].glcf069
            LET g_glcf_r.glcf070 = g_glcf4_d[l_ac].glcf070
            LET g_glcf_r.glcf071 = g_glcf4_d[l_ac].glcf071]]>
  </point>
  <point name="input.b.page4.glcf048_desc" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_glcf4_d[l_ac].glcf048_desc = g_glcf4_d[l_ac].glcf048]]>
  </point>
  <point name="input.b.page4.glcf049_desc" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_glcf4_d[l_ac].glcf049_desc = g_glcf4_d[l_ac].glcf049
            IF cl_null(g_glcf4_d[l_ac].glcf049_desc) AND NOT cl_null(g_glce_m.glce003) THEN
               LET g_glcf4_d[l_ac].glcf049_desc = g_glce_m.glce003
            END IF]]>
  </point>
  <point name="input.b.page4.glcf050_desc" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_glcf4_d[l_ac].glcf050_desc = g_glcf4_d[l_ac].glcf050]]>
  </point>
  <point name="input.b.page4.glcf051_desc" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_glcf4_d[l_ac].glcf051_desc = g_glcf4_d[l_ac].glcf051]]>
  </point>
  <point name="input.b.page4.glcf052_desc" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_glcf4_d[l_ac].glcf052_desc = g_glcf4_d[l_ac].glcf052]]>
  </point>
  <point name="input.b.page4.glcf053_desc" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_glcf4_d[l_ac].glcf053_desc = g_glcf4_d[l_ac].glcf053]]>
  </point>
  <point name="input.b.page4.glcf054_desc" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_glcf4_d[l_ac].glcf054_desc = g_glcf4_d[l_ac].glcf054]]>
  </point>
  <point name="input.b.page4.glcf055_desc" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_glcf4_d[l_ac].glcf055_desc = g_glcf4_d[l_ac].glcf055]]>
  </point>
  <point name="input.b.page4.glcf057_desc" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_glcf4_d[l_ac].glcf057_desc = g_glcf4_d[l_ac].glcf057]]>
  </point>
  <point name="input.b.page4.glcf058_desc" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_glcf4_d[l_ac].glcf058_desc = g_glcf4_d[l_ac].glcf058]]>
  </point>
  <point name="input.b.page4.glcf059_desc" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_glcf4_d[l_ac].glcf059_desc = g_glcf4_d[l_ac].glcf059]]>
  </point>
  <point name="input.b.page4.glcf060_desc" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_glcf4_d[l_ac].glcf060_desc = g_glcf4_d[l_ac].glcf060]]>
  </point>
  <point name="input.b.page4.glcf061_desc" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_glcf4_d[l_ac].glcf061_desc = g_glcf4_d[l_ac].glcf061]]>
  </point>
  <point name="input.b.page4.glcf062_desc" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_glcf4_d[l_ac].glcf062_desc = g_glcf4_d[l_ac].glcf062]]>
  </point>
  <point name="input.b.page4.glcf063_desc" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_glcf4_d[l_ac].glcf063_desc = g_glcf4_d[l_ac].glcf063]]>
  </point>
  <point name="input.b.page4.glcf064_desc" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_glcf4_d[l_ac].glcf064_desc = g_glcf4_d[l_ac].glcf064]]>
  </point>
  <point name="input.b.page4.glcf065_desc" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_glcf4_d[l_ac].glcf065_desc = g_glcf4_d[l_ac].glcf065]]>
  </point>
  <point name="input.b.page4.glcf066_desc" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_glcf4_d[l_ac].glcf066_desc = g_glcf4_d[l_ac].glcf066]]>
  </point>
  <point name="input.b.page4.glcf067_desc" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_glcf4_d[l_ac].glcf067_desc = g_glcf4_d[l_ac].glcf067]]>
  </point>
  <point name="input.b.page4.glcf068_desc" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_glcf4_d[l_ac].glcf068_desc = g_glcf4_d[l_ac].glcf068]]>
  </point>
  <point name="input.b.page4.glcf069_desc" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_glcf4_d[l_ac].glcf069_desc = g_glcf4_d[l_ac].glcf069]]>
  </point>
  <point name="input.b.page4.glcf070_desc" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_glcf4_d[l_ac].glcf070_desc = g_glcf4_d[l_ac].glcf070]]>
  </point>
  <point name="input.b.page4.glcf071_desc" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_glcf4_d[l_ac].glcf071_desc = g_glcf4_d[l_ac].glcf071]]>
  </point>
  <point name="input.before_input" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   #抓取當期最後一天
   SELECT MAX(glav004) INTO l_date FROM glav_t
    WHERE glavent=g_enterprise AND glav001=g_glaa003
      AND glav002=g_glce_m.glce001 AND glav006=g_glce_m.glce002]]>
  </point>
  <point name="input.body4.before_row" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #匯差科目
            CALL s_desc_get_account_desc(g_glce_m.glceld,g_glcf4_d[l_ac].glcf047) RETURNING l_desc
            LET g_glcf4_d[l_ac].glcf047_desc = g_glcf4_d[l_ac].glcf047,'\n',l_desc
            #顯示匯差核算項資料
            CALL aglt420_detail_show_2()
            #顯示凍結資料
            CALL aglt420_frozen_show()
            DISPLAY BY NAME g_glcf4_d[l_ac].glcf048_desc,g_glcf4_d[l_ac].glcf049_desc,g_glcf4_d[l_ac].glcf050_desc,
                            g_glcf4_d[l_ac].glcf051_desc,g_glcf4_d[l_ac].glcf052_desc,g_glcf4_d[l_ac].glcf053_desc,
                            g_glcf4_d[l_ac].glcf054_desc,g_glcf4_d[l_ac].glcf055_desc,g_glcf4_d[l_ac].glcf056,
                            g_glcf4_d[l_ac].glcf057_desc,g_glcf4_d[l_ac].glcf058_desc,g_glcf4_d[l_ac].glcf059_desc,
                            g_glcf4_d[l_ac].glcf060,g_glcf4_d[l_ac].glcf061,g_glcf4_d[l_ac].glcf047_desc,
                            g_glcf4_d[l_ac].glcf062_desc,g_glcf4_d[l_ac].glcf063_desc,g_glcf4_d[l_ac].glcf064_desc,
                            g_glcf4_d[l_ac].glcf065_desc,g_glcf4_d[l_ac].glcf066_desc,g_glcf4_d[l_ac].glcf067_desc,
                            g_glcf4_d[l_ac].glcf068_desc,g_glcf4_d[l_ac].glcf069_desc,g_glcf4_d[l_ac].glcf070_desc,
                            g_glcf4_d[l_ac].glcf071_desc
                            
            IF NOT cl_null(g_glcf4_d[l_ac].glcf047) THEN
               SELECT glad017,glad0171,glad0172,glad018,glad0181,glad0182,
                      glad019,glad0191,glad0192,glad020,glad0201,glad0202,
                      glad021,glad0211,glad0212,glad022,glad0221,glad0222,
                      glad023,glad0231,glad0232,glad024,glad0221,glad0242,
                      glad025,glad0251,glad0252,glad026,glad0261,glad0262
                INTO  g_glad017,g_glad0171,g_glad0172,g_glad018,g_glad0181,g_glad0182,
                      g_glad019,g_glad0191,g_glad0192,g_glad020,g_glad0201,g_glad0202,
                      g_glad021,g_glad0211,g_glad0212,g_glad022,g_glad0221,g_glad0222,
                      g_glad023,g_glad0231,g_glad0232,g_glad024,g_glad0241,g_glad0242,
                      g_glad025,g_glad0251,g_glad0252,g_glad026,g_glad0261,g_glad0262
                FROM  glad_t
                WHERE gladent = g_enterprise
                  AND gladld = g_glce_m.glceld
                  AND glad001 = g_glcf4_d[l_ac].glcf047
            END IF]]>
  </point>
  <point name="input.c.glaa001" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_glce_m.glaa001             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "" #s

            
            CALL q_ooai001()                                #呼叫開窗

            LET g_glce_m.glaa001 = g_qryparam.return1              

            DISPLAY g_glce_m.glaa001 TO glaa001              #

            NEXT FIELD glaa001                          #返回原欄位

]]>
  </point>
  <point name="input.c.glaa016" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_glce_m.glaa016             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "" #s

            
            CALL q_ooai001()                                #呼叫開窗

            LET g_glce_m.glaa016 = g_qryparam.return1              

            DISPLAY g_glce_m.glaa016 TO glaa016              #

            NEXT FIELD glaa016                          #返回原欄位

]]>
  </point>
  <point name="input.c.glaa020" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_glce_m.glaa020             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "" #s

            
            CALL q_ooai001()                                #呼叫開窗

            LET g_glce_m.glaa020 = g_qryparam.return1              

            DISPLAY g_glce_m.glaa020 TO glaa020              #

            NEXT FIELD glaa020                          #返回原欄位

]]>
  </point>
  <point name="input.c.glce003" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_glce_m.glce003             #給予default值
            LET g_qryparam.default2 = "" #g_glce_m.ooefl003 #說明(簡稱)
            #給予arg
            LET g_qryparam.arg1 = "" #s

            
            CALL q_ooef001()                                #呼叫開窗

            LET g_glce_m.glce003 = g_qryparam.return1              
            #LET g_glce_m.ooefl003 = g_qryparam.return2 
            DISPLAY g_glce_m.glce003 TO glce003              #
            #DISPLAY g_glce_m.ooefl003 TO ooefl003 #說明(簡稱)
            NEXT FIELD glce003                          #返回原欄位

]]>
  </point>
  <point name="input.c.glce006" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #應用 a07 樣板自動產生(Version:2)   
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_glce_m.glce006             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "" #s
             LET g_qryparam.where="nmai001='",g_glaa005,"'"

            CALL q_nmai002()                                #呼叫開窗

            LET g_glce_m.glce006 = g_qryparam.return1              

            DISPLAY g_glce_m.glce006 TO glce006              #

            NEXT FIELD glce006                          #返回原欄位

]]>
  </point>
  <point name="input.c.glcecomp" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_glce_m.glcecomp             #給予default值
            LET g_qryparam.default2 = "" #g_glce_m.ooefl003 #說明(簡稱)
            #給予arg
            LET g_qryparam.arg1 = "" #s

            
            CALL q_ooef001()                                #呼叫開窗

            LET g_glce_m.glcecomp = g_qryparam.return1              
            #LET g_glce_m.ooefl003 = g_qryparam.return2 
            DISPLAY g_glce_m.glcecomp TO glcecomp              #
            #DISPLAY g_glce_m.ooefl003 TO ooefl003 #說明(簡稱)
            NEXT FIELD glcecomp                          #返回原欄位

]]>
  </point>
  <point name="input.c.glceld" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_glce_m.glceld             #給予default值

            #給予arg
            LET g_qryparam.arg1 = g_user #s
            LET g_qryparam.arg2 = g_dept #s
            
            CALL q_authorised_ld()                                #呼叫開窗

            LET g_glce_m.glceld = g_qryparam.return1              

            DISPLAY g_glce_m.glceld TO glceld              #

            NEXT FIELD glceld                          #返回原欄位

]]>
  </point>
  <point name="input.c.page1.glcf003" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_glcf_d[l_ac].glcf003             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "" #s

            
            CALL aglt310_04()                                #呼叫開窗

            LET g_glcf_d[l_ac].glcf003 = g_qryparam.return1              

            DISPLAY g_glcf_d[l_ac].glcf003 TO glcf003              #

            NEXT FIELD glcf003                          #返回原欄位

]]>
  </point>
  <point name="input.c.page1.glcf005" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_glcf_d[l_ac].glcf005             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "" #s

            
            CALL q_ooai001()                                #呼叫開窗

            LET g_glcf_d[l_ac].glcf005 = g_qryparam.return1              

            DISPLAY g_glcf_d[l_ac].glcf005 TO glcf005              #

            NEXT FIELD glcf005                          #返回原欄位

]]>
  </point>
  <point name="input.c.page4.glcf047_desc" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_glcf4_d[l_ac].glcf047_desc             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "" #s
            LET g_qryparam.where = "glac001 = '",g_glaa004,"' AND  glac003 <>'1' AND glac006 = '1'"
            
            CALL aglt310_04()                                #呼叫開窗

            LET g_glcf4_d[l_ac].glcf047_desc = g_qryparam.return1              

            DISPLAY g_glcf4_d[l_ac].glcf047_desc TO glcf047_desc              #

            NEXT FIELD glcf047_desc                          #返回原欄位

]]>
  </point>
  <point name="input.c.page4.glcf048_desc" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_glcf4_d[l_ac].glcf048_desc             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "" #s

            
            CALL q_ooef001()                                #呼叫開窗

            LET g_glcf4_d[l_ac].glcf048_desc = g_qryparam.return1              

            DISPLAY g_glcf4_d[l_ac].glcf048_desc TO glcf048_desc              #

            NEXT FIELD glcf048_desc                          #返回原欄位

]]>
  </point>
  <point name="input.c.page4.glcf049_desc" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_glcf4_d[l_ac].glcf049_desc             #給予default值
            LET g_qryparam.default2 = "" #g_glcf4_d[l_ac].ooeg001 #部門編號
            #給予arg
            LET g_qryparam.arg1 = l_date #s

            
            CALL q_ooeg001_4()                                #呼叫開窗

            LET g_glcf4_d[l_ac].glcf049_desc = g_qryparam.return1              
            #LET g_glcf4_d[l_ac].ooeg001 = g_qryparam.return2 
            DISPLAY g_glcf4_d[l_ac].glcf049_desc TO glcf049_desc              #
            #DISPLAY g_glcf4_d[l_ac].ooeg001 TO ooeg001 #部門編號
            NEXT FIELD glcf049_desc                          #返回原欄位

]]>
  </point>
  <point name="input.c.page4.glcf050_desc" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_glcf4_d[l_ac].glcf050_desc             #給予default值
            LET g_qryparam.default2 = "" #g_glcf4_d[l_ac].ooefl003 #說明(簡稱)
            #給予arg
            LET g_qryparam.arg1 = "" #s

            
            CALL q_ooeg001_5()                                #呼叫開窗

            LET g_glcf4_d[l_ac].glcf050_desc = g_qryparam.return1              
            #LET g_glcf4_d[l_ac].ooefl003 = g_qryparam.return2 
            DISPLAY g_glcf4_d[l_ac].glcf050_desc TO glcf050_desc              #
            #DISPLAY g_glcf4_d[l_ac].ooefl003 TO ooefl003 #說明(簡稱)
            NEXT FIELD glcf050_desc                          #返回原欄位

]]>
  </point>
  <point name="input.c.page4.glcf051_desc" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_glcf4_d[l_ac].glcf051_desc             #給予default值
            LET g_qryparam.default2 = "" #g_glcf4_d[l_ac].oocq002 #應用分類碼
            #給予arg
            LET g_qryparam.arg1 = "" #s

            
            CALL q_oocq002_287()                                #呼叫開窗

            LET g_glcf4_d[l_ac].glcf051_desc = g_qryparam.return1              
            #LET g_glcf4_d[l_ac].oocq002 = g_qryparam.return2 
            DISPLAY g_glcf4_d[l_ac].glcf051_desc TO glcf051_desc              #
            #DISPLAY g_glcf4_d[l_ac].oocq002 TO oocq002 #應用分類碼
            NEXT FIELD glcf051_desc                          #返回原欄位

]]>
  </point>
  <point name="input.c.page4.glcf052_desc" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_glcf4_d[l_ac].glcf052_desc             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "" #s

            
            CALL q_pmaa001()                                #呼叫開窗

            LET g_glcf4_d[l_ac].glcf052_desc = g_qryparam.return1              

            DISPLAY g_glcf4_d[l_ac].glcf052_desc TO glcf052_desc              #

            NEXT FIELD glcf052_desc                          #返回原欄位

]]>
  </point>
  <point name="input.c.page4.glcf053_desc" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_glcf4_d[l_ac].glcf053_desc             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "" #s

            
            CALL q_pmaa001()                                #呼叫開窗

            LET g_glcf4_d[l_ac].glcf053_desc = g_qryparam.return1              

            DISPLAY g_glcf4_d[l_ac].glcf053_desc TO glcf053_desc              #

            NEXT FIELD glcf053_desc  ]]>
  </point>
  <point name="input.c.page4.glcf054_desc" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_glcf4_d[l_ac].glcf054_desc             #給予default值
            LET g_qryparam.default2 = "" #g_glcf4_d[l_ac].oocq002 #應用分類碼
            #給予arg
            LET g_qryparam.arg1 = "" #s

            
            CALL q_oocq002_281()                                #呼叫開窗

            LET g_glcf4_d[l_ac].glcf054_desc = g_qryparam.return1              
            #LET g_glcf4_d[l_ac].oocq002 = g_qryparam.return2 
            DISPLAY g_glcf4_d[l_ac].glcf054_desc TO glcf054_desc              #
            #DISPLAY g_glcf4_d[l_ac].oocq002 TO oocq002 #應用分類碼
            NEXT FIELD glcf054_desc                          #返回原欄位

]]>
  </point>
  <point name="input.c.page4.glcf055_desc" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_glcf4_d[l_ac].glcf055_desc             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "" #s

            
            CALL q_rtax001()                                #呼叫開窗

            LET g_glcf4_d[l_ac].glcf055_desc = g_qryparam.return1              

            DISPLAY g_glcf4_d[l_ac].glcf055_desc TO glcf055_desc              #

            NEXT FIELD glcf055_desc                          #返回原欄位

]]>
  </point>
  <point name="input.c.page4.glcf057_desc" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_glcf4_d[l_ac].glcf057_desc             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "" #s

            
            CALL q_oojd001_2()                                #呼叫開窗

            LET g_glcf4_d[l_ac].glcf057_desc = g_qryparam.return1              

            DISPLAY g_glcf4_d[l_ac].glcf057_desc TO glcf057_desc              #

            NEXT FIELD glcf057_desc                          #返回原欄位

]]>
  </point>
  <point name="input.c.page4.glcf058_desc" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_glcf4_d[l_ac].glcf058_desc             #給予default值
            LET g_qryparam.default2 = "" #g_glcf4_d[l_ac].oocq002 #應用分類碼
            #給予arg
            LET g_qryparam.arg1 = "" #s

            
            CALL q_oocq002_2002()                                #呼叫開窗

            LET g_glcf4_d[l_ac].glcf058_desc = g_qryparam.return1              
            #LET g_glcf4_d[l_ac].oocq002 = g_qryparam.return2 
            DISPLAY g_glcf4_d[l_ac].glcf058_desc TO glcf058_desc              #
            #DISPLAY g_glcf4_d[l_ac].oocq002 TO oocq002 #應用分類碼
            NEXT FIELD glcf058_desc                          #返回原欄位

]]>
  </point>
  <point name="input.c.page4.glcf059_desc" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_glcf4_d[l_ac].glcf059_desc             #給予default值
            LET g_qryparam.default2 = "" #g_glcf4_d[l_ac].oofa011 #全名
            #給予arg
            LET g_qryparam.arg1 = "" #s

            
            CALL q_ooag001_8()                                #呼叫開窗

            LET g_glcf4_d[l_ac].glcf059_desc = g_qryparam.return1              
            #LET g_glcf4_d[l_ac].oofa011 = g_qryparam.return2 
            DISPLAY g_glcf4_d[l_ac].glcf059_desc TO glcf059_desc              #
            #DISPLAY g_glcf4_d[l_ac].oofa011 TO oofa011 #全名
            NEXT FIELD glcf059_desc                          #返回原欄位

]]>
  </point>
  <point name="input.c.page4.glcf060_desc" order="" ver="1" cite_std="" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #應用 a07 樣板自動產生(Version:2)   
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_glcf4_d[l_ac].glcf060_desc             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "" #s


            CALL q_pjba001()                                #呼叫開窗

            LET g_glcf4_d[l_ac].glcf060_desc = g_qryparam.return1              

            DISPLAY g_glcf4_d[l_ac].glcf060_desc TO glcf060_desc              #

            NEXT FIELD glcf060_desc                          #返回原欄位

]]>
  </point>
  <point name="input.c.page4.glcf061_desc" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #應用 a07 樣板自動產生(Version:2)   
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_glcf4_d[l_ac].glcf061_desc             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "" #s

            IF NOT cl_null(g_glcf4_d[l_ac].glcf060) THEN
               LET g_qryparam.where = "pjbb012='1' AND pjbb001='",g_glcf4_d[l_ac].glcf060,"'"
            ELSE
               LET g_qryparam.where = "pjbb012='1'"
            END IF
            CALL q_pjbb002()                                #呼叫開窗

            LET g_glcf4_d[l_ac].glcf061_desc = g_qryparam.return1              

            DISPLAY g_glcf4_d[l_ac].glcf061_desc TO glcf061_desc              #

            NEXT FIELD glcf061_desc                          #返回原欄位

]]>
  </point>
  <point name="input.define" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   DEFINE  l_success             LIKE type_t.num5
   DEFINE  l_date,l_date1        LIKE type_t.dat
   DEFINE  l_desc                STRING
   DEFINE  l_errno               STRING
   DEFINE  l_nmaistus            LIKE nmai_t.nmaistus]]>
  </point>
  <point name="input.g.page4.glcf056" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_glcf4_d[l_ac].glcf056) THEN
               CALL s_voucher_glaq051_chk(g_glcf4_d[l_ac].glcf056) 
               IF NOT cl_null(g_errno) THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = g_errno
                  LET g_errparam.extend = g_glcf4_d[l_ac].glcf056
                  LET g_errparam.popup = TRUE
                  CALL cl_err()

                  LET g_glcf4_d[l_ac].glcf056 = g_glcf4_d_t.glcf056
                  NEXT FIELD glcf056
               END IF
            END IF]]>
  </point>
  <point name="input.head.b_insert" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[               #單據編號：帳別+年度+期別+当期最大天数組成流水號
               #抓取當期最後一天
               SELECT MAX(glav004) INTO l_date FROM glav_t
                WHERE glavent=g_enterprise AND glav001=g_glaa003
                  AND glav002=g_glce_m.glce001 AND glav006=g_glce_m.glce002
               IF g_glce_m.glce002 <10 THEN
                  LET g_glce_m.glcedocno=g_glce_m.glceld,g_glce_m.glce001 USING "<<<<",'0',g_glce_m.glce002 USING "<<",DAY(l_date) USING "<<<<"
               ELSE
                  LET g_glce_m.glcedocno=g_glce_m.glceld,g_glce_m.glce001 USING "<<<<",g_glce_m.glce002 USING "<<",DAY(l_date) USING "<<<<"
               END IF]]>
  </point>
  <point name="input.head.m_insert" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[               CALL aglt420_insert_glcf() RETURNING l_success
               IF l_success = FALSE THEN
                  CALL s_transaction_end('N','0')
                  NEXT FIELD glce001
               ELSE
                  CALL aglt420_b_fill()
               END IF]]>
  </point>
  <point name="input.m.before_input" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF p_cmd = 'a' THEN
               #帳套
               LET g_glce_m.glceld = g_glaald
               CALL aglt420_glceld_desc(g_glaald)
               #年度/期別
               LET g_glce_m.glce001 = YEAR(g_today)
               LET g_glce_m.glce002 = MONTH(g_today)
               DISPLAY BY NAME g_glce_m.glceld,g_glce_m.glceld_desc,g_glce_m.glcecomp,g_glce_m.glcecomp_desc,
                               g_glce_m.glaa001,g_glce_m.glaa016,g_glce_m.glaa020,g_glce_m.glce001,
                               g_glce_m.glce002
            END IF]]>
  </point>
  <point name="main.exit" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   DROP TABLE s_voucher_ar_tmp;
   DROP TABLE s_voucher_ar_group;
   DROP TABLE s_voucher_glbc;
   DROP TABLE s_pre_voucher_tmp;]]>
  </point>
  <point name="menu.exchange_ld" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[               CALL aglt310_01(g_glce_m.glceld) RETURNING g_glaald
               
               #依据对应的主账套编码，抓取对应法人，币别，汇率参照编号，会计科目参照编号,关账日期
               CALL aglt420_glceld_desc(g_glaald)
                
                IF cl_null(g_wc) THEN
                   LET g_wc = '1=1'
                END IF 
                LET g_wc2 = ' 1=1']]>
  </point>
  <point name="menu.open_aglt310_02" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[               #固定核算項維護
               CALL aglt420_fix_acc()]]>
  </point>
  <point name="menu.open_aglt310_03" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[               #自由核算項維護
               CALL aglt420_free_acc()]]>
  </point>
  <point name="menu.open_aglt420_01" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[               CALL aglt420_voucher()]]>
  </point>
  <point name="menu.open_axrt300_13" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[               IF NOT cl_null(g_glce_m.glce005) THEN
                  INITIALIZE g_errparam TO NULL 
                  LET g_errparam.extend = g_glce_m.glceld
                  LET g_errparam.code   = "aap-00052" 
                  LET g_errparam.popup  = FALSE 
                  CALL cl_err()
               ELSE
                  IF g_glaa121 = 'Y' THEN   
                     #抓取分录底稿的单号、单据日期
                     SELECT glgadocno,glgadocdt INTO l_glgadocno,l_glgadocdt FROM glga_t
                      WHERE glgaent = g_enterprise 
                        AND glgald  = g_glce_m.glceld
                        AND glga002 = g_glce_m.glce001
                        AND glga004 = g_glce_m.glce002
                        AND glga100 = 'GL'
                        AND glga101 = 'TH'
                     CALL s_pre_voucher('GL','TH',g_glce_m.glceld,l_glgadocno,l_glgadocdt)
                  ELSE 
                     LET l_wc = "",g_glce_m.glce001 USING '<<<<'," AND glce002=",g_glce_m.glce002
                     CALL axrt300_13('GL',g_glce_m.glceld,l_wc,'1')
                  END IF
               END IF]]>
  </point>
  <point name="menu.open_pre" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[               IF g_glce_m.glcestus <> 'N' THEN 
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = 'axr-00270'
                  LET g_errparam.extend = ''
                  LET g_errparam.popup = TRUE
                  CALL cl_err()
                     
                  EXIT DIALOG
               END IF
               #当该年度+期别的最后一天小于等于账套关账日期时，不可异动该单据
               CALL aglt420_date_chk() RETURNING l_success
               IF l_success = FALSE THEN
                  EXIT DIALOG
               END IF
               CALL s_transaction_begin()
               CALL cl_err_collect_init()
               
               IF NOT cl_null(g_glce_m.glceld) AND NOT cl_null(g_glce_m.glce001) AND NOT cl_null(g_glce_m.glce002) THEN 
                  CALL s_aglt420_pre_voucher_ins('GL','TH',g_glce_m.glceld,g_glce_m.glce001,g_glce_m.glce002,'1') RETURNING l_success
                  IF l_success THEN
                     CALL s_transaction_end('Y','1')
                  ELSE
                     CALL s_transaction_end('N','1')     
                  END IF
               END IF
               CALL cl_err_collect_show()]]>
  </point>
  <point name="menu.prog_glce005" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[               #應用 a41 樣板自動產生(Version:2)
               #使用JSON格式組合參數與作業編號(串查)
               IF NOT cl_null(g_glce_m.glce005) THEN
                  INITIALIZE la_param.* TO NULL
                  LET la_param.prog     = 'aglt310'
                  LET la_param.param[1] = g_glce_m.glceld
                  LET la_param.param[2] = g_glce_m.glce005
                  
                  LET ls_js = util.JSON.stringify(la_param)
                  CALL cl_cmdrun_wait(ls_js)
               END IF

]]>
  </point>
  <point name="menu.prog_glcf034" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[               IF NOT cl_null(g_glce_m.glcf034) THEN
                  CALL cl_user_contact("aooi130", "ooag_t", "ooag002", "ooag001",g_glce_m.glcf034)
               END IF
]]>
  </point>
  <point name="menu.un_voucher" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[               CALL aglt420_un_voucher()]]>
  </point>
  <point name="modify.after_show" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   IF g_glce_m.glcestus <> 'N' THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = 'agl-00313'
      LET g_errparam.extend = g_glce_m.glceld
      LET g_errparam.popup = TRUE
      CALL cl_err()
      CLOSE aglt420_cl
      CALL s_transaction_end('N','0')
      RETURN
   END IF
   #当该年度+期别的最后一天小于等于账套关账日期时，不可异动该单据
   CALL aglt420_date_chk() RETURNING l_success
   IF l_success = FALSE THEN
      CLOSE aglt420_cl
      CALL s_transaction_end('N','0')
      RETURN
   END IF]]>
  </point>
  <point name="modify.define" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   DEFINE l_success    LIKE type_t.num5]]>
  </point>
  <point name="set_act_no_visible.set_act_no_visible" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   IF g_glce_m.glcestus <> 'N' THEN
      CALL cl_set_act_visible("modify,modify_detail,delete",FALSE)
   END IF]]>
  </point>
  <point name="set_act_visible.set_act_visible" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   IF g_glce_m.glcestus = 'N' THEN
      CALL cl_set_act_visible('modify,modify_detail,delete',TRUE)
   END IF]]>
  </point>
  <point name="set_act_visible_b.set_act_visible_b" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="set_entry.after_control" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   CALL cl_set_comp_entry("glceld",FALSE)]]>
  </point>
  <point name="set_no_entry.after_control" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   IF p_cmd = 'u' THEN
      CALL cl_set_comp_entry("glce001,glce002",FALSE)
   END IF ]]>
  </point>
  <point name="show.after" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   #顯示畫面凍結部分---固定核算項
   CALL aglt420_frozen_show()
   IF g_glaa121 = 'Y' THEN
      CALL cl_set_toolbaritem_visible('open_pre',TRUE)
   ELSE
      CALL cl_set_toolbaritem_visible('open_pre',FALSE)
   END IF]]>
  </point>
  <point name="show.before" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   CALL aglt420_glceld_desc(g_glce_m.glceld)
   IF g_glce_m.glcestus <> 'N' THEN
      CALL cl_set_act_visible('modify,modify_detail,delete',FALSE)
   ELSE
      CALL cl_set_act_visible('modify,modify_detail,delete',TRUE)
   END IF
   CALL s_desc_get_nmail004_desc(g_glaa005,g_glce_m.glce006)  RETURNING g_glce_m.glce006_desc
   DISPLAY BY NAME g_glce_m.glce006_desc]]>
  </point>
  <point name="show.head.reference" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   ]]>
  </point>
  <point name="statechange.after_refresh" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   IF g_glce_m.glcestus = 'X' THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = 'anm-00044'
      LET g_errparam.extend = g_glce_m.glcedocno
      LET g_errparam.popup = TRUE
      CALL cl_err()
      CLOSE aglt420_cl
      CALL s_transaction_end('N','0')
      RETURN
   END IF
   #当该年度+期别的最后一天小于等于账套关账日期时，不可异动该单据
   CALL aglt420_date_chk() RETURNING l_success
   IF l_success = FALSE THEN
      CLOSE aglt420_cl
      CALL s_transaction_end('N','0')
      RETURN
   END IF]]>
  </point>
  <point name="statechange.b_update" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   IF g_glaa121 = 'Y' AND l_success = TRUE THEN 
      LET l_wc = " glga002 = ",g_glce_m.glce001," AND glga004 = ",g_glce_m.glce002
      CALL s_pre_voucher_upd('GL','TH',g_glce_m.glceld,lc_state,g_glce_m.glcedocno,'',l_wc) RETURNING l_success
   END IF
   CALL cl_err_collect_show()
   IF l_success = FALSE THEN
      CALL s_transaction_end('N','0')
      CLOSE aglt420_cl
      RETURN
   ELSE
      CALL s_transaction_end('Y','0')
   END IF]]>
  </point>
  <point name="statechange.before_menu" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[      CALL cl_set_act_visible("confirmed,unconfirmed,invalid",FALSE)
      CASE g_glce_m.glcestus
         WHEN "N"
            CALL cl_set_act_visible("confirmed,invalid",TRUE)   
         WHEN "Y"
            CALL cl_set_act_visible("unconfirmed",TRUE)
         WHEN "X"
            RETURN
      END CASE
      
      LET l_success=TRUE]]>
  </point>
  <point name="statechange.confirmed" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            CALL cl_err_collect_init()
            CALL s_aglt420_conf_chk(g_glce_m.glceld,g_glce_m.glce001,g_glce_m.glce002) RETURNING l_success
            IF l_success = TRUE THEN
               CALL s_aglt420_conf_upd(g_glce_m.glceld,g_glce_m.glce001,g_glce_m.glce002) RETURNING l_success
            END IF]]>
  </point>
  <point name="statechange.define" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   DEFINE l_success      LIKE type_t.num5
   DEFINE l_wc           STRING]]>
  </point>
  <point name="statechange.invalid" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            CALL cl_err_collect_init()
            CALL s_aglt420_void_chk(g_glce_m.glceld,g_glce_m.glce001,g_glce_m.glce002) RETURNING l_success
            IF l_success = TRUE THEN
               CALL s_aglt420_void_upd(g_glce_m.glceld,g_glce_m.glce001,g_glce_m.glce002) RETURNING l_success
            END IF]]>
  </point>
  <point name="statechange.open" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            CALL s_aglt420_unconf_chk(g_glce_m.glceld,g_glce_m.glce001,g_glce_m.glce002) RETURNING l_success
            IF l_success = TRUE THEN
               CALL s_aglt420_unconf_upd(g_glce_m.glceld,g_glce_m.glce001,g_glce_m.glce002) RETURNING l_success
            END IF]]>
  </point>
  <point name="statechange.unconfirmed" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            CALL cl_err_collect_init()
            CALL s_aglt420_unconf_chk(g_glce_m.glceld,g_glce_m.glce001,g_glce_m.glce002) RETURNING l_success
            IF l_success = TRUE THEN
               CALL s_aglt420_unconf_upd(g_glce_m.glceld,g_glce_m.glce001,g_glce_m.glce002) RETURNING l_success
            END IF]]>
  </point>
  <point name="statechange.valid" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            CALL s_aglt420_conf_chk(g_glce_m.glceld,g_glce_m.glce001,g_glce_m.glce002) RETURNING l_success
            IF l_success = TRUE THEN
               CALL s_aglt420_conf_upd(g_glce_m.glceld,g_glce_m.glce001,g_glce_m.glce002) RETURNING l_success
            END IF]]>
  </point>
  <point name="statechange.void" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            CALL s_aglt420_void_chk(g_glce_m.glceld,g_glce_m.glce001,g_glce_m.glce002) RETURNING l_success
            IF l_success = TRUE THEN
               CALL s_aglt420_void_upd(g_glce_m.glceld,g_glce_m.glce001,g_glce_m.glce002) RETURNING l_success
            END IF]]>
  </point>
  <point name="ui_dialog.before_dialog2" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[               ]]>
  </point>
  <point name="ui_dialog.body2.before_row" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[               CALL aglt420_frozen_show()]]>
  </point>
  <point name="ui_dialog.body3.before_row" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[               CALL aglt420_frozen_show()]]>
  </point>
  <point name="ui_dialog.body4.before_row" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[               CALL aglt420_frozen_show()]]>
  </point>
  <point name="ui_dialog.define" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   DEFINE l_wc      LIKE type_t.chr20
   DEFINE l_docdt   LIKE type_t.dat
   DEFINE l_glgadocno LIKE glga_t.glgadocno
   DEFINE l_glgadocdt LIKE glga_t.glgadocdt
   DEFINE l_success   LIKE type_t.num5]]>
  </point>
  <point name="ui_dialog.page1.before_row" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[               CALL aglt420_frozen_show()]]>
  </point>
  <section id="aglt420.action_chk" ver="2" status="" src="s" readonly="">
    <![CDATA[#+ 修改/刪除前行為檢查(是否可允許此動作), 若有其他行為須管控也可透過此段落
PRIVATE FUNCTION aglt420_action_chk()
   #add-point:action_chk段define
   {<point name="action_chk.define" edit="s"/>}
   #end add-point
   #add-point:action_chk段define(客製用)
   {<point name="action_chk.define_customerization" edit="c"/>}
   #end add-point
   
   #add-point:action_chk段action_chk
   {<point name="action_chk.action_chk"/>}
   #end add-point
   
   RETURN TRUE
   
END FUNCTION
]]>
  </section>
  <section id="aglt420.b_fill" ver="6" status="" src="s" readonly="">
    <![CDATA[#+ 單身陣列填充
PRIVATE FUNCTION aglt420_b_fill()
   DEFINE p_wc2      STRING
   DEFINE li_idx     LIKE type_t.num10
   #add-point:b_fill段define
   {<point name="b_fill.define" edit="s"/>}
   #end add-point     
   #add-point:b_fill段define(客製用)
   {<point name="b_fill.define_customerization" edit="c"/>}
   #end add-point     
 
   CALL g_glcf_d.clear()    #g_glcf_d 單頭及單身 
   CALL g_glcf2_d.clear()
   CALL g_glcf3_d.clear()
   CALL g_glcf4_d.clear()
 
 
   #add-point:b_fill段sql_before
   {<point name="b_fill.sql_before"/>}
   #end add-point
   
   #判斷是否填充
   IF aglt420_fill_chk(1) THEN
      #切換上下筆時不重組SQL
      IF g_action_choice <> 'fetch' OR cl_null(g_action_choice) THEN
         LET g_sql = "SELECT  UNIQUE glcf003,glcf004,glcf005,glcf006,glcf007,glcf008,glcf009,glcf010, 
             glcf011,glcf012,glcf073,glcf003,glcf004,glcf005,glcf013,glcf014,glcf015,glcf016,glcf017, 
             glcf003,glcf004,glcf005,glcf018,glcf019,glcf020,glcf021,glcf022,glcf003,glcf004,glcf005, 
             glcf047,glcf048,glcf049,glcf050,glcf051,glcf052,glcf053,glcf054,glcf055,glcf056,glcf057, 
             glcf058,glcf059,glcf060,glcf061,glcf062,glcf063,glcf064,glcf065,glcf066,glcf067,glcf068, 
             glcf069,glcf070,glcf071,glcf072  FROM glcf_t",   
                     " INNER JOIN glce_t ON glceld = glcfld ",
                     " AND glce001 = glcf001 ",
                     " AND glce002 = glcf002 ",
 
                     #"",
                     
                     "",
                     
                     " WHERE glcfent=? AND glcfld=? AND glcf001=? AND glcf002=?"
         LET g_sql = cl_sql_add_mask(g_sql)              #遮蔽特定資料
         #add-point:b_fill段sql_before
         {<point name="b_fill.body.fill_sql"/>}
         #end add-point
         IF NOT cl_null(g_wc2_table1) THEN
            LET g_sql = g_sql CLIPPED, " AND ", g_wc2_table1 CLIPPED
         END IF
         
         #子單身的WC
         
         
         LET g_sql = g_sql, " ORDER BY glcf_t.glcf003,glcf_t.glcf004,glcf_t.glcf005"
         
         #add-point:單身填充控制
         {<point name="b_fill.sql"/>}
         #end add-point
         
         LET g_sql = cl_sql_add_mask(g_sql)              #遮蔽特定資料
         PREPARE aglt420_pb FROM g_sql
         DECLARE b_fill_cs CURSOR FOR aglt420_pb
      END IF
      
      LET g_cnt = l_ac
      LET l_ac = 1
      
      OPEN b_fill_cs USING g_enterprise,g_glce_m.glceld,g_glce_m.glce001,g_glce_m.glce002
                                               
      FOREACH b_fill_cs INTO g_glcf_d[l_ac].glcf003,g_glcf_d[l_ac].glcf004,g_glcf_d[l_ac].glcf005,g_glcf_d[l_ac].glcf006, 
          g_glcf_d[l_ac].glcf007,g_glcf_d[l_ac].glcf008,g_glcf_d[l_ac].glcf009,g_glcf_d[l_ac].glcf010, 
          g_glcf_d[l_ac].glcf011,g_glcf_d[l_ac].glcf012,g_glcf_d[l_ac].glcf073,g_glcf2_d[l_ac].glcf003, 
          g_glcf2_d[l_ac].glcf004,g_glcf2_d[l_ac].glcf005,g_glcf2_d[l_ac].glcf013,g_glcf2_d[l_ac].glcf014, 
          g_glcf2_d[l_ac].glcf015,g_glcf2_d[l_ac].glcf016,g_glcf2_d[l_ac].glcf017,g_glcf3_d[l_ac].glcf003, 
          g_glcf3_d[l_ac].glcf004,g_glcf3_d[l_ac].glcf005,g_glcf3_d[l_ac].glcf018,g_glcf3_d[l_ac].glcf019, 
          g_glcf3_d[l_ac].glcf020,g_glcf3_d[l_ac].glcf021,g_glcf3_d[l_ac].glcf022,g_glcf4_d[l_ac].glcf003, 
          g_glcf4_d[l_ac].glcf004,g_glcf4_d[l_ac].glcf005,g_glcf4_d[l_ac].glcf047,g_glcf4_d[l_ac].glcf048, 
          g_glcf4_d[l_ac].glcf049,g_glcf4_d[l_ac].glcf050,g_glcf4_d[l_ac].glcf051,g_glcf4_d[l_ac].glcf052, 
          g_glcf4_d[l_ac].glcf053,g_glcf4_d[l_ac].glcf054,g_glcf4_d[l_ac].glcf055,g_glcf4_d[l_ac].glcf056, 
          g_glcf4_d[l_ac].glcf057,g_glcf4_d[l_ac].glcf058,g_glcf4_d[l_ac].glcf059,g_glcf4_d[l_ac].glcf060, 
          g_glcf4_d[l_ac].glcf061,g_glcf4_d[l_ac].glcf062,g_glcf4_d[l_ac].glcf063,g_glcf4_d[l_ac].glcf064, 
          g_glcf4_d[l_ac].glcf065,g_glcf4_d[l_ac].glcf066,g_glcf4_d[l_ac].glcf067,g_glcf4_d[l_ac].glcf068, 
          g_glcf4_d[l_ac].glcf069,g_glcf4_d[l_ac].glcf070,g_glcf4_d[l_ac].glcf071,g_glcf4_d[l_ac].glcf072 

         IF SQLCA.sqlcode THEN
            INITIALIZE g_errparam TO NULL 
            LET g_errparam.extend = "FOREACH:" 
            LET g_errparam.code   = SQLCA.sqlcode 
            LET g_errparam.popup  = TRUE 
            CALL cl_err()
            EXIT FOREACH
         END IF
        
         #add-point:b_fill段資料填充
         {<point name="b_fill.fill"/>}
         #end add-point
      
         IF l_ac > g_max_rec THEN
            IF g_error_show = 1 THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = l_ac
               LET g_errparam.code   = 9035 
               LET g_errparam.popup  = TRUE 
               CALL cl_err()
            END IF
            EXIT FOREACH
         END IF
         
         LET l_ac = l_ac + 1
      END FOREACH
      LET g_error_show = 0
   
   END IF
   
 
   
   #add-point:browser_fill段其他table處理
   {<point name="browser_fill.other_fill"/>}
   #end add-point
   
   CALL g_glcf_d.deleteElement(g_glcf_d.getLength())
   CALL g_glcf2_d.deleteElement(g_glcf2_d.getLength())
   CALL g_glcf3_d.deleteElement(g_glcf3_d.getLength())
   CALL g_glcf4_d.deleteElement(g_glcf4_d.getLength())
 
   
 
   LET l_ac = g_cnt
   LET g_cnt = 0  
   
   FREE aglt420_pb
 
   
   LET li_idx = l_ac
   
   #遮罩相關處理
   FOR l_ac = 1 TO g_glcf_d.getLength()
      LET g_glcf_d_mask_o[l_ac].* =  g_glcf_d[l_ac].*
      CALL aglt420_glcf_t_mask()
      LET g_glcf_d_mask_n[l_ac].* =  g_glcf_d[l_ac].*
   END FOR
   
   LET g_glcf2_d_mask_o.* =  g_glcf2_d.*
   FOR l_ac = 1 TO g_glcf2_d.getLength()
      LET g_glcf2_d_mask_o[l_ac].* =  g_glcf2_d[l_ac].*
      CALL aglt420_glcf_t_mask()
      LET g_glcf2_d_mask_n[l_ac].* =  g_glcf2_d[l_ac].*
   END FOR
   LET g_glcf3_d_mask_o.* =  g_glcf3_d.*
   FOR l_ac = 1 TO g_glcf3_d.getLength()
      LET g_glcf3_d_mask_o[l_ac].* =  g_glcf3_d[l_ac].*
      CALL aglt420_glcf_t_mask()
      LET g_glcf3_d_mask_n[l_ac].* =  g_glcf3_d[l_ac].*
   END FOR
   LET g_glcf4_d_mask_o.* =  g_glcf4_d.*
   FOR l_ac = 1 TO g_glcf4_d.getLength()
      LET g_glcf4_d_mask_o[l_ac].* =  g_glcf4_d[l_ac].*
      CALL aglt420_glcf_t_mask()
      LET g_glcf4_d_mask_n[l_ac].* =  g_glcf4_d[l_ac].*
   END FOR
 
   
   LET l_ac = li_idx
   
   CALL cl_ap_performance_next_end()
 
END FUNCTION
]]>
  </section>
  <section id="aglt420.b_fill2" ver="4" status="" src="s" readonly="">
    <![CDATA[#+ 單身陣列填充2
PRIVATE FUNCTION aglt420_b_fill2(pi_idx)
   DEFINE pi_idx          LIKE type_t.num10
   DEFINE li_ac           LIKE type_t.num10
   DEFINE ls_chk          LIKE type_t.chr1
   #add-point:b_fill2段define
   {<point name="b_fill2.define" edit="s"/>}
   #end add-point
   #add-point:b_fill2段define(客製用)
   {<point name="b_fill2.define_customerization" edit="c"/>}
   #end add-point
   
   LET li_ac = l_ac 
   
   IF g_detail_idx <= 0 THEN
      RETURN
   END IF
   
 
      
 
      
   #add-point:單身填充後
   {<point name="b_fill2.after_fill" />}
   #end add-point
    
   LET l_ac = li_ac
   
   CALL aglt420_detail_show()
   
END FUNCTION
]]>
  </section>
  <section id="aglt420.browser_fill" ver="10" status="" src="s" readonly="">
    <![CDATA[#+ 瀏覽頁簽資料填充
PRIVATE FUNCTION aglt420_browser_fill(ps_page_action)
   DEFINE ps_page_action    STRING
   DEFINE l_wc              STRING
   DEFINE l_wc2             STRING
   DEFINE l_sql             STRING
   DEFINE l_sub_sql         STRING
   DEFINE l_sql_rank        STRING
   #add-point:browser_fill段define
   {<point name="browser_fill.define" edit="s"/>}
   #end add-point   
   #add-point:browser_fill段define(客製用)
   {<point name="browser_fill.define_customerization" edit="c"/>}
   #end add-point   
   
   #add-point:browser_fill段動作開始前
   {<point name="browser_fill.before_browser_fill"/>}
   #end add-point
   
   IF cl_null(g_wc) THEN
      LET g_wc = " 1=1"
   END IF
   IF cl_null(g_wc2) THEN
      LET g_wc2 = " 1=1"
   END IF
   LET l_wc  = g_wc.trim() 
   LET l_wc2 = g_wc2.trim()
 
   #add-point:browser_fill,foreach前
   {<point name="browser_fill.before_foreach"/>}
   #end add-point
   
   IF g_wc2 <> " 1=1" THEN
      #單身有輸入搜尋條件                      
      LET l_sub_sql = " SELECT UNIQUE glceld,glce001,glce002 ",
                      " FROM glce_t ",
                      " ",
                      " LEFT JOIN glcf_t ON glcfent = glceent AND glceld = glcfld AND glce001 = glcf001 AND glce002 = glcf002 ", "  ",
                      #add-point:browser_fill段sql(glcf_t1)
                      {<point name="browser_fill.cnt.join.}"/>}
                      #end add-point
 
 
                      " ", 
                      " ", 
                      " WHERE glceent = '" ||g_enterprise|| "' AND glcfent = '" ||g_enterprise|| "' AND ",l_wc, " AND ", l_wc2, cl_sql_add_filter("glce_t")
   ELSE
      #單身未輸入搜尋條件
      LET l_sub_sql = " SELECT UNIQUE glceld,glce001,glce002 ",
                      " FROM glce_t ", 
                      "  ",
                      "  ",
                      " WHERE glceent = '" ||g_enterprise|| "' AND ",l_wc CLIPPED, cl_sql_add_filter("glce_t")
   END IF
   
   #add-point:browser_fill,cnt wc
   {<point name="browser_fill.cnt_sqlwc"/>}
   #end add-point
   
   LET g_sql = " SELECT COUNT(*) FROM (",l_sub_sql,")"
   
   #add-point:browser_fill,count前
   {<point name="browser_fill.before_count"/>}
   #end add-point
   
   PREPARE header_cnt_pre FROM g_sql
   EXECUTE header_cnt_pre INTO g_browser_cnt   #總筆數
   FREE header_cnt_pre
    
   IF g_browser_cnt > g_max_browse THEN
      IF g_error_show = 1 THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = g_browser_cnt
         LET g_errparam.code   = 9035 
         LET g_errparam.popup  = TRUE 
         CALL cl_err()
      END IF
      LET g_browser_cnt = g_max_browse
   END IF
   
   DISPLAY g_browser_cnt TO FORMONLY.b_count   #總筆數的顯示
   DISPLAY g_browser_cnt TO FORMONLY.h_count   #總筆數的顯示
 
   #根據行為確定資料填充位置及WC
   IF cl_null(g_add_browse) THEN
      #清除畫面
      CLEAR FORM                
      INITIALIZE g_glce_m.* TO NULL
      CALL g_glcf_d.clear()        
      CALL g_glcf2_d.clear() 
      CALL g_glcf3_d.clear() 
      CALL g_glcf4_d.clear() 
 
      #add-point:browser_fill g_add_browse段額外處理
      {<point name="browser_fill.add_browse.other"/>}
      #end add-point   
      CALL g_browser.clear()
      LET g_cnt = 1
   ELSE
      LET l_wc  = g_add_browse
      LET l_wc2 = " 1=1" 
      LET g_cnt = g_current_idx
   END IF
 
   #依照t0.glceld,t0.glce001,t0.glce002 Browser欄位定義(取代原本bs_sql功能)
   #考量到單身可能下條件, 所以此處需join單身所有table
   #DISTINCT是為了避免在join時出現重複的資料(如果不加DISTINCT則須在程式中過濾)
   LET g_sql = " SELECT DISTINCT t0.glcestus,t0.glceld,t0.glce001,t0.glce002 ",
               " FROM glce_t t0",
               "  ",
               "  LEFT JOIN glcf_t ON glcfent = glceent AND glceld = glcfld AND glce001 = glcf001 AND glce002 = glcf002 ", "  ", 
               #add-point:browser_fill段sql(glcf_t1)
               {<point name="browser_fill.join.glcf_t1"/>}
               #end add-point
 
 
               "  ",
               
               " WHERE t0.glceent = '" ||g_enterprise|| "' AND ",l_wc," AND ",l_wc2, cl_sql_add_filter("glce_t")
   #add-point:browser_fill,sql wc
   {<point name="browser_fill.fill_sqlwc"/>}
   #end add-point
   LET g_sql = g_sql, " ORDER BY glceld,glce001,glce002 ",g_order
 
   #add-point:browser_fill,before_prepare
   {<point name="browser_fill.before_prepare"/>}
   #end add-point
        
   #LET g_sql = cl_sql_add_tabid(g_sql,"glce_t") #WC重組
   LET g_sql = cl_sql_add_mask(g_sql) #遮蔽特定資料
   PREPARE browse_pre FROM g_sql
   DECLARE browse_cur CURSOR FOR browse_pre
   
   #add-point:browser_fill段open cursor
   {<point name="browser_fill.open"/>}
   #end add-point
   
   FOREACH browse_cur INTO g_browser[g_cnt].b_statepic,g_browser[g_cnt].b_glceld,g_browser[g_cnt].b_glce001, 
       g_browser[g_cnt].b_glce002
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = 'foreach:' 
         LET g_errparam.code   = SQLCA.sqlcode 
         LET g_errparam.popup  = TRUE 
         CALL cl_err()
         EXIT FOREACH
      END IF
  
      #add-point:browser_fill段reference
      {<point name="browser_fill.reference"/>}
      #end add-point
  
  
            #應用 a24 樣板自動產生(Version:2)
      #browser顯示圖片
      CASE g_browser[g_cnt].b_statepic
         WHEN "N"
            LET g_browser[g_cnt].b_statepic = "stus/16/unconfirmed.png"
         WHEN "Y"
            LET g_browser[g_cnt].b_statepic = "stus/16/confirmed.png"
         WHEN "X"
            LET g_browser[g_cnt].b_statepic = "stus/16/invalid.png"
         
      END CASE
 
 
      LET g_cnt = g_cnt + 1
      IF g_cnt > g_max_browse THEN
         EXIT FOREACH
      END IF
      
   END FOREACH
   
   #清空g_add_browse, 並指定指標位置
   IF NOT cl_null(g_add_browse) THEN
      LET g_add_browse = ""
      CALL g_curr_diag.setCurrentRow("s_browse",g_current_idx)
   END IF
   
   IF cl_null(g_browser[g_cnt].b_glceld) THEN
      CALL g_browser.deleteElement(g_cnt)
   END IF
   
   LET g_header_cnt  = g_browser.getLength()
   LET g_browser_cnt = g_browser.getLength()
   
   #筆數顯示
   IF g_browser_cnt > 0 THEN
      DISPLAY g_browser_idx TO FORMONLY.b_index #當下筆數
      DISPLAY g_browser_cnt TO FORMONLY.b_count #總筆數
      DISPLAY g_browser_idx TO FORMONLY.h_index #當下筆數
      DISPLAY g_browser_cnt TO FORMONLY.h_count #總筆數
      DISPLAY g_detail_idx  TO FORMONLY.idx     #單身當下筆數
      DISPLAY g_detail_cnt  TO FORMONLY.cnt     #單身總筆數
   ELSE
      DISPLAY '' TO FORMONLY.b_index #當下筆數
      DISPLAY '' TO FORMONLY.b_count #總筆數
      DISPLAY '' TO FORMONLY.h_index #當下筆數
      DISPLAY '' TO FORMONLY.h_count #總筆數
      DISPLAY '' TO FORMONLY.idx     #單身當下筆數
      DISPLAY '' TO FORMONLY.cnt     #單身總筆數
   END IF
 
   LET g_rec_b = g_cnt - 1
   LET g_detail_cnt = g_rec_b
   LET g_cnt = 0
   
   FREE browse_pre
   
   #若無資料則關閉相關功能
   IF g_browser_cnt = 0 THEN
      CALL cl_set_act_visible("statechange,modify,modify_detail,delete,reproduce,mainhidden", FALSE)
      CALL cl_navigator_setting(0,0)
   ELSE
      CALL cl_set_act_visible("mainhidden", TRUE)
   END IF
                  
   
   #add-point:browser_fill段結束前
   {<point name="browser_fill.after"/>}
   #end add-point   
 
END FUNCTION
]]>
  </section>
  <section id="aglt420.construct" ver="16" status="" src="s" readonly="">
    <![CDATA[#+ QBE資料查詢
PRIVATE FUNCTION aglt420_construct()
   DEFINE ls_return   STRING
   DEFINE ls_result   STRING 
   DEFINE ls_wc       STRING 
   DEFINE la_wc       DYNAMIC ARRAY OF RECORD
          tableid     STRING,
          wc          STRING
          END RECORD
   DEFINE li_idx      LIKE type_t.num10
   #add-point:cs段define
   {<point name="cs.define" edit="s"/>}
   #end add-point    
   #add-point:cs段define(客製用)
   {<point name="cs.define_customerization" edit="c"/>}
   #end add-point    
    
   #清除畫面
   CLEAR FORM                
   INITIALIZE g_glce_m.* TO NULL
   CALL g_glcf_d.clear()        
   CALL g_glcf2_d.clear() 
   CALL g_glcf3_d.clear() 
   CALL g_glcf4_d.clear() 
 
   
   LET g_action_choice = ""
    
   INITIALIZE g_wc TO NULL
   INITIALIZE g_wc2 TO NULL
   
   INITIALIZE g_wc2_table1 TO NULL
 
    
   LET g_qryparam.state = 'c'
   
   #add-point:cs段開始前
   {<point name="cs.before_construct"/>}
   #end add-point 
   
   #使用DIALOG包住 單頭CONSTRUCT及單身CONSTRUCT
   DIALOG ATTRIBUTES(UNBUFFERED,FIELD ORDER FORM)
      
      #單頭
      CONSTRUCT BY NAME g_wc ON glce001,glce002,glce003,glce004,glce006,glce006_desc,glce005,glcedocno, 
          glcestus,glceownid,glceowndp,glcecrtid,glcecrtdp,glcecrtdt,glcemodid,glcemoddt,glcecnfid,glcecnfdt, 
          glcf023,glcf024,glcf025,glcf026,glcf027,glcf028,glcf029,glcf030,glcf031,glcf032,glcf033,glcf034, 
          glcf035,glcf035_desc,glcf036,glcf036_desc,glcf037,glcf038,glcf039,glcf040,glcf041,glcf042, 
          glcf043,glcf044,glcf045,glcf046
 
         BEFORE CONSTRUCT
            #add-point:cs段before_construct
            {<point name="cs.head.before_construct"/>}
            #end add-point 
            
         #公用欄位開窗相關處理
         #應用 a11 樣板自動產生(Version:2)
         #共用欄位查詢處理  
         ##----<<glcecrtdt>>----
         AFTER FIELD glcecrtdt
            CALL FGL_DIALOG_GETBUFFER() RETURNING ls_result
            IF NOT cl_null(ls_result) THEN
               IF NOT cl_chk_date_symbol(ls_result) THEN
                  LET ls_result = cl_add_date_extra_cond(ls_result)
               END IF
            END IF
            CALL FGL_DIALOG_SETBUFFER(ls_result)
 
         #----<<glcemoddt>>----
         AFTER FIELD glcemoddt
            CALL FGL_DIALOG_GETBUFFER() RETURNING ls_result
            IF NOT cl_null(ls_result) THEN
               IF NOT cl_chk_date_symbol(ls_result) THEN
                  LET ls_result = cl_add_date_extra_cond(ls_result)
               END IF
            END IF
            CALL FGL_DIALOG_SETBUFFER(ls_result)
         
         #----<<glcecnfdt>>----
         AFTER FIELD glcecnfdt
            CALL FGL_DIALOG_GETBUFFER() RETURNING ls_result
            IF NOT cl_null(ls_result) THEN
               IF NOT cl_chk_date_symbol(ls_result) THEN
                  LET ls_result = cl_add_date_extra_cond(ls_result)
               END IF
            END IF
            CALL FGL_DIALOG_SETBUFFER(ls_result)
         
         #----<<glcepstdt>>----
 
 
            
         #一般欄位開窗相關處理    
                  #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glce001
            #add-point:BEFORE FIELD glce001
            {<point name="construct.b.glce001" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glce001
            
            #add-point:AFTER FIELD glce001
            {<point name="construct.a.glce001" />}
            #END add-point
            
 
         #Ctrlp:construct.c.glce001
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glce001
            #add-point:ON ACTION controlp INFIELD glce001
            {<point name="construct.c.glce001" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glce002
            #add-point:BEFORE FIELD glce002
            {<point name="construct.b.glce002" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glce002
            
            #add-point:AFTER FIELD glce002
            {<point name="construct.a.glce002" />}
            #END add-point
            
 
         #Ctrlp:construct.c.glce002
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glce002
            #add-point:ON ACTION controlp INFIELD glce002
            {<point name="construct.c.glce002" />}
            #END add-point
 
         #Ctrlp:construct.c.glce003
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glce003
            #add-point:ON ACTION controlp INFIELD glce003
            {<point name="construct.c.glce003" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glce003
            #add-point:BEFORE FIELD glce003
            {<point name="construct.b.glce003" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glce003
            
            #add-point:AFTER FIELD glce003
            {<point name="construct.a.glce003" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glce004
            #add-point:BEFORE FIELD glce004
            {<point name="construct.b.glce004" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glce004
            
            #add-point:AFTER FIELD glce004
            {<point name="construct.a.glce004" />}
            #END add-point
            
 
         #Ctrlp:construct.c.glce004
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glce004
            #add-point:ON ACTION controlp INFIELD glce004
            {<point name="construct.c.glce004" />}
            #END add-point
 
         #Ctrlp:construct.c.glce006
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glce006
            #add-point:ON ACTION controlp INFIELD glce006
            {<point name="construct.c.glce006" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glce006
            #add-point:BEFORE FIELD glce006
            {<point name="construct.b.glce006" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glce006
            
            #add-point:AFTER FIELD glce006
            {<point name="construct.a.glce006" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glce006_desc
            #add-point:BEFORE FIELD glce006_desc
            {<point name="construct.b.glce006_desc" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glce006_desc
            
            #add-point:AFTER FIELD glce006_desc
            {<point name="construct.a.glce006_desc" />}
            #END add-point
            
 
         #Ctrlp:construct.c.glce006_desc
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glce006_desc
            #add-point:ON ACTION controlp INFIELD glce006_desc
            {<point name="construct.c.glce006_desc" />}
            #END add-point
 
         #Ctrlp:construct.c.glce005
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glce005
            #add-point:ON ACTION controlp INFIELD glce005
            {<point name="construct.c.glce005" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glce005
            #add-point:BEFORE FIELD glce005
            {<point name="construct.b.glce005" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glce005
            
            #add-point:AFTER FIELD glce005
            {<point name="construct.a.glce005" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcedocno
            #add-point:BEFORE FIELD glcedocno
            {<point name="construct.b.glcedocno" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcedocno
            
            #add-point:AFTER FIELD glcedocno
            {<point name="construct.a.glcedocno" />}
            #END add-point
            
 
         #Ctrlp:construct.c.glcedocno
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcedocno
            #add-point:ON ACTION controlp INFIELD glcedocno
            {<point name="construct.c.glcedocno" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcestus
            #add-point:BEFORE FIELD glcestus
            {<point name="construct.b.glcestus" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcestus
            
            #add-point:AFTER FIELD glcestus
            {<point name="construct.a.glcestus" />}
            #END add-point
            
 
         #Ctrlp:construct.c.glcestus
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcestus
            #add-point:ON ACTION controlp INFIELD glcestus
            {<point name="construct.c.glcestus" />}
            #END add-point
 
         #Ctrlp:construct.c.glceownid
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glceownid
            #add-point:ON ACTION controlp INFIELD glceownid
            {<point name="construct.c.glceownid" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glceownid
            #add-point:BEFORE FIELD glceownid
            {<point name="construct.b.glceownid" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glceownid
            
            #add-point:AFTER FIELD glceownid
            {<point name="construct.a.glceownid" />}
            #END add-point
            
 
         #Ctrlp:construct.c.glceowndp
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glceowndp
            #add-point:ON ACTION controlp INFIELD glceowndp
            {<point name="construct.c.glceowndp" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glceowndp
            #add-point:BEFORE FIELD glceowndp
            {<point name="construct.b.glceowndp" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glceowndp
            
            #add-point:AFTER FIELD glceowndp
            {<point name="construct.a.glceowndp" />}
            #END add-point
            
 
         #Ctrlp:construct.c.glcecrtid
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcecrtid
            #add-point:ON ACTION controlp INFIELD glcecrtid
            {<point name="construct.c.glcecrtid" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcecrtid
            #add-point:BEFORE FIELD glcecrtid
            {<point name="construct.b.glcecrtid" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcecrtid
            
            #add-point:AFTER FIELD glcecrtid
            {<point name="construct.a.glcecrtid" />}
            #END add-point
            
 
         #Ctrlp:construct.c.glcecrtdp
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcecrtdp
            #add-point:ON ACTION controlp INFIELD glcecrtdp
            {<point name="construct.c.glcecrtdp" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcecrtdp
            #add-point:BEFORE FIELD glcecrtdp
            {<point name="construct.b.glcecrtdp" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcecrtdp
            
            #add-point:AFTER FIELD glcecrtdp
            {<point name="construct.a.glcecrtdp" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcecrtdt
            #add-point:BEFORE FIELD glcecrtdt
            {<point name="construct.b.glcecrtdt" />}
            #END add-point
 
         #Ctrlp:construct.c.glcemodid
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcemodid
            #add-point:ON ACTION controlp INFIELD glcemodid
            {<point name="construct.c.glcemodid" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcemodid
            #add-point:BEFORE FIELD glcemodid
            {<point name="construct.b.glcemodid" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcemodid
            
            #add-point:AFTER FIELD glcemodid
            {<point name="construct.a.glcemodid" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcemoddt
            #add-point:BEFORE FIELD glcemoddt
            {<point name="construct.b.glcemoddt" />}
            #END add-point
 
         #Ctrlp:construct.c.glcecnfid
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcecnfid
            #add-point:ON ACTION controlp INFIELD glcecnfid
            {<point name="construct.c.glcecnfid" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcecnfid
            #add-point:BEFORE FIELD glcecnfid
            {<point name="construct.b.glcecnfid" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcecnfid
            
            #add-point:AFTER FIELD glcecnfid
            {<point name="construct.a.glcecnfid" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcecnfdt
            #add-point:BEFORE FIELD glcecnfdt
            {<point name="construct.b.glcecnfdt" />}
            #END add-point
 
         #Ctrlp:construct.c.glcf023
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf023
            #add-point:ON ACTION controlp INFIELD glcf023
            {<point name="construct.c.glcf023" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf023
            #add-point:BEFORE FIELD glcf023
            {<point name="construct.b.glcf023" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf023
            
            #add-point:AFTER FIELD glcf023
            {<point name="construct.a.glcf023" />}
            #END add-point
            
 
         #Ctrlp:construct.c.glcf024
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf024
            #add-point:ON ACTION controlp INFIELD glcf024
            {<point name="construct.c.glcf024" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf024
            #add-point:BEFORE FIELD glcf024
            {<point name="construct.b.glcf024" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf024
            
            #add-point:AFTER FIELD glcf024
            {<point name="construct.a.glcf024" />}
            #END add-point
            
 
         #Ctrlp:construct.c.glcf025
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf025
            #add-point:ON ACTION controlp INFIELD glcf025
            {<point name="construct.c.glcf025" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf025
            #add-point:BEFORE FIELD glcf025
            {<point name="construct.b.glcf025" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf025
            
            #add-point:AFTER FIELD glcf025
            {<point name="construct.a.glcf025" />}
            #END add-point
            
 
         #Ctrlp:construct.c.glcf026
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf026
            #add-point:ON ACTION controlp INFIELD glcf026
            {<point name="construct.c.glcf026" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf026
            #add-point:BEFORE FIELD glcf026
            {<point name="construct.b.glcf026" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf026
            
            #add-point:AFTER FIELD glcf026
            {<point name="construct.a.glcf026" />}
            #END add-point
            
 
         #Ctrlp:construct.c.glcf027
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf027
            #add-point:ON ACTION controlp INFIELD glcf027
            {<point name="construct.c.glcf027" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf027
            #add-point:BEFORE FIELD glcf027
            {<point name="construct.b.glcf027" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf027
            
            #add-point:AFTER FIELD glcf027
            {<point name="construct.a.glcf027" />}
            #END add-point
            
 
         #Ctrlp:construct.c.glcf028
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf028
            #add-point:ON ACTION controlp INFIELD glcf028
            {<point name="construct.c.glcf028" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf028
            #add-point:BEFORE FIELD glcf028
            {<point name="construct.b.glcf028" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf028
            
            #add-point:AFTER FIELD glcf028
            {<point name="construct.a.glcf028" />}
            #END add-point
            
 
         #Ctrlp:construct.c.glcf029
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf029
            #add-point:ON ACTION controlp INFIELD glcf029
            {<point name="construct.c.glcf029" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf029
            #add-point:BEFORE FIELD glcf029
            {<point name="construct.b.glcf029" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf029
            
            #add-point:AFTER FIELD glcf029
            {<point name="construct.a.glcf029" />}
            #END add-point
            
 
         #Ctrlp:construct.c.glcf030
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf030
            #add-point:ON ACTION controlp INFIELD glcf030
            {<point name="construct.c.glcf030" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf030
            #add-point:BEFORE FIELD glcf030
            {<point name="construct.b.glcf030" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf030
            
            #add-point:AFTER FIELD glcf030
            {<point name="construct.a.glcf030" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf031
            #add-point:BEFORE FIELD glcf031
            {<point name="construct.b.glcf031" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf031
            
            #add-point:AFTER FIELD glcf031
            {<point name="construct.a.glcf031" />}
            #END add-point
            
 
         #Ctrlp:construct.c.glcf031
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf031
            #add-point:ON ACTION controlp INFIELD glcf031
            {<point name="construct.c.glcf031" />}
            #END add-point
 
         #Ctrlp:construct.c.glcf032
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf032
            #add-point:ON ACTION controlp INFIELD glcf032
            {<point name="construct.c.glcf032" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf032
            #add-point:BEFORE FIELD glcf032
            {<point name="construct.b.glcf032" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf032
            
            #add-point:AFTER FIELD glcf032
            {<point name="construct.a.glcf032" />}
            #END add-point
            
 
         #Ctrlp:construct.c.glcf033
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf033
            #add-point:ON ACTION controlp INFIELD glcf033
            {<point name="construct.c.glcf033" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf033
            #add-point:BEFORE FIELD glcf033
            {<point name="construct.b.glcf033" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf033
            
            #add-point:AFTER FIELD glcf033
            {<point name="construct.a.glcf033" />}
            #END add-point
            
 
         #Ctrlp:construct.c.glcf034
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf034
            #add-point:ON ACTION controlp INFIELD glcf034
            {<point name="construct.c.glcf034" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf034
            #add-point:BEFORE FIELD glcf034
            {<point name="construct.b.glcf034" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf034
            
            #add-point:AFTER FIELD glcf034
            {<point name="construct.a.glcf034" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf035
            #add-point:BEFORE FIELD glcf035
            {<point name="construct.b.glcf035" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf035
            
            #add-point:AFTER FIELD glcf035
            {<point name="construct.a.glcf035" />}
            #END add-point
            
 
         #Ctrlp:construct.c.glcf035
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf035
            #add-point:ON ACTION controlp INFIELD glcf035
            {<point name="construct.c.glcf035" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf035_desc
            #add-point:BEFORE FIELD glcf035_desc
            {<point name="construct.b.glcf035_desc" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf035_desc
            
            #add-point:AFTER FIELD glcf035_desc
            {<point name="construct.a.glcf035_desc" />}
            #END add-point
            
 
         #Ctrlp:construct.c.glcf035_desc
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf035_desc
            #add-point:ON ACTION controlp INFIELD glcf035_desc
            {<point name="construct.c.glcf035_desc" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf036
            #add-point:BEFORE FIELD glcf036
            {<point name="construct.b.glcf036" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf036
            
            #add-point:AFTER FIELD glcf036
            {<point name="construct.a.glcf036" />}
            #END add-point
            
 
         #Ctrlp:construct.c.glcf036
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf036
            #add-point:ON ACTION controlp INFIELD glcf036
            {<point name="construct.c.glcf036" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf036_desc
            #add-point:BEFORE FIELD glcf036_desc
            {<point name="construct.b.glcf036_desc" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf036_desc
            
            #add-point:AFTER FIELD glcf036_desc
            {<point name="construct.a.glcf036_desc" />}
            #END add-point
            
 
         #Ctrlp:construct.c.glcf036_desc
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf036_desc
            #add-point:ON ACTION controlp INFIELD glcf036_desc
            {<point name="construct.c.glcf036_desc" />}
            #END add-point
 
         #Ctrlp:construct.c.glcf037
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf037
            #add-point:ON ACTION controlp INFIELD glcf037
            {<point name="construct.c.glcf037" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf037
            #add-point:BEFORE FIELD glcf037
            {<point name="construct.b.glcf037" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf037
            
            #add-point:AFTER FIELD glcf037
            {<point name="construct.a.glcf037" />}
            #END add-point
            
 
         #Ctrlp:construct.c.glcf038
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf038
            #add-point:ON ACTION controlp INFIELD glcf038
            {<point name="construct.c.glcf038" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf038
            #add-point:BEFORE FIELD glcf038
            {<point name="construct.b.glcf038" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf038
            
            #add-point:AFTER FIELD glcf038
            {<point name="construct.a.glcf038" />}
            #END add-point
            
 
         #Ctrlp:construct.c.glcf039
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf039
            #add-point:ON ACTION controlp INFIELD glcf039
            {<point name="construct.c.glcf039" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf039
            #add-point:BEFORE FIELD glcf039
            {<point name="construct.b.glcf039" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf039
            
            #add-point:AFTER FIELD glcf039
            {<point name="construct.a.glcf039" />}
            #END add-point
            
 
         #Ctrlp:construct.c.glcf040
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf040
            #add-point:ON ACTION controlp INFIELD glcf040
            {<point name="construct.c.glcf040" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf040
            #add-point:BEFORE FIELD glcf040
            {<point name="construct.b.glcf040" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf040
            
            #add-point:AFTER FIELD glcf040
            {<point name="construct.a.glcf040" />}
            #END add-point
            
 
         #Ctrlp:construct.c.glcf041
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf041
            #add-point:ON ACTION controlp INFIELD glcf041
            {<point name="construct.c.glcf041" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf041
            #add-point:BEFORE FIELD glcf041
            {<point name="construct.b.glcf041" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf041
            
            #add-point:AFTER FIELD glcf041
            {<point name="construct.a.glcf041" />}
            #END add-point
            
 
         #Ctrlp:construct.c.glcf042
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf042
            #add-point:ON ACTION controlp INFIELD glcf042
            {<point name="construct.c.glcf042" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf042
            #add-point:BEFORE FIELD glcf042
            {<point name="construct.b.glcf042" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf042
            
            #add-point:AFTER FIELD glcf042
            {<point name="construct.a.glcf042" />}
            #END add-point
            
 
         #Ctrlp:construct.c.glcf043
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf043
            #add-point:ON ACTION controlp INFIELD glcf043
            {<point name="construct.c.glcf043" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf043
            #add-point:BEFORE FIELD glcf043
            {<point name="construct.b.glcf043" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf043
            
            #add-point:AFTER FIELD glcf043
            {<point name="construct.a.glcf043" />}
            #END add-point
            
 
         #Ctrlp:construct.c.glcf044
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf044
            #add-point:ON ACTION controlp INFIELD glcf044
            {<point name="construct.c.glcf044" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf044
            #add-point:BEFORE FIELD glcf044
            {<point name="construct.b.glcf044" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf044
            
            #add-point:AFTER FIELD glcf044
            {<point name="construct.a.glcf044" />}
            #END add-point
            
 
         #Ctrlp:construct.c.glcf045
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf045
            #add-point:ON ACTION controlp INFIELD glcf045
            {<point name="construct.c.glcf045" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf045
            #add-point:BEFORE FIELD glcf045
            {<point name="construct.b.glcf045" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf045
            
            #add-point:AFTER FIELD glcf045
            {<point name="construct.a.glcf045" />}
            #END add-point
            
 
         #Ctrlp:construct.c.glcf046
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf046
            #add-point:ON ACTION controlp INFIELD glcf046
            {<point name="construct.c.glcf046" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf046
            #add-point:BEFORE FIELD glcf046
            {<point name="construct.b.glcf046" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf046
            
            #add-point:AFTER FIELD glcf046
            {<point name="construct.a.glcf046" />}
            #END add-point
            
 
 
         
      END CONSTRUCT
 
      #單身根據table分拆construct
      CONSTRUCT g_wc2_table1 ON glcf003,glcf003_desc,glcf004,glcf005,glcf006,glcf007,glcf008,glcf009, 
          glcf010,glcf011,glcf012,glcf073,edit1,glcf003_2_desc,glcf013,glcf014,glcf015,glcf016,glcf017, 
          edit2,glcf003_3_desc,glcf018,glcf019,glcf020,glcf021,glcf022,edit3,glcf003_4_desc,glcf047, 
          glcf047_desc,glcf048,glcf048_desc,glcf049,glcf049_desc,glcf050,glcf050_desc,glcf051,glcf051_desc, 
          glcf052,glcf052_desc,glcf053,glcf053_desc,glcf054,glcf054_desc,glcf055,glcf055_desc,glcf056, 
          glcf057,glcf057_desc,glcf058,glcf058_desc,glcf059,glcf059_desc,glcf060,glcf060_desc,glcf061, 
          glcf061_desc,glcf062,glcf062_desc,glcf063,glcf063_desc,glcf064,glcf064_desc,glcf065,glcf065_desc, 
          glcf066,glcf066_desc,glcf067,glcf067_desc,glcf068,glcf068_desc,glcf069,glcf069_desc,glcf070, 
          glcf070_desc,glcf071,glcf071_desc,glcf072,edit4
           FROM s_detail1[1].glcf003,s_detail1[1].glcf003_desc,s_detail1[1].glcf004,s_detail1[1].glcf005, 
               s_detail1[1].glcf006,s_detail1[1].glcf007,s_detail1[1].glcf008,s_detail1[1].glcf009,s_detail1[1].glcf010, 
               s_detail1[1].glcf011,s_detail1[1].glcf012,s_detail1[1].glcf073,s_detail1[1].edit1,s_detail2[1].glcf003_2_desc, 
               s_detail2[1].glcf013,s_detail2[1].glcf014,s_detail2[1].glcf015,s_detail2[1].glcf016,s_detail2[1].glcf017, 
               s_detail2[1].edit2,s_detail3[1].glcf003_3_desc,s_detail3[1].glcf018,s_detail3[1].glcf019, 
               s_detail3[1].glcf020,s_detail3[1].glcf021,s_detail3[1].glcf022,s_detail3[1].edit3,s_detail4[1].glcf003_4_desc, 
               s_detail4[1].glcf047,s_detail4[1].glcf047_desc,s_detail4[1].glcf048,s_detail4[1].glcf048_desc, 
               s_detail4[1].glcf049,s_detail4[1].glcf049_desc,s_detail4[1].glcf050,s_detail4[1].glcf050_desc, 
               s_detail4[1].glcf051,s_detail4[1].glcf051_desc,s_detail4[1].glcf052,s_detail4[1].glcf052_desc, 
               s_detail4[1].glcf053,s_detail4[1].glcf053_desc,s_detail4[1].glcf054,s_detail4[1].glcf054_desc, 
               s_detail4[1].glcf055,s_detail4[1].glcf055_desc,s_detail4[1].glcf056,s_detail4[1].glcf057, 
               s_detail4[1].glcf057_desc,s_detail4[1].glcf058,s_detail4[1].glcf058_desc,s_detail4[1].glcf059, 
               s_detail4[1].glcf059_desc,s_detail4[1].glcf060,s_detail4[1].glcf060_desc,s_detail4[1].glcf061, 
               s_detail4[1].glcf061_desc,s_detail4[1].glcf062,s_detail4[1].glcf062_desc,s_detail4[1].glcf063, 
               s_detail4[1].glcf063_desc,s_detail4[1].glcf064,s_detail4[1].glcf064_desc,s_detail4[1].glcf065, 
               s_detail4[1].glcf065_desc,s_detail4[1].glcf066,s_detail4[1].glcf066_desc,s_detail4[1].glcf067, 
               s_detail4[1].glcf067_desc,s_detail4[1].glcf068,s_detail4[1].glcf068_desc,s_detail4[1].glcf069, 
               s_detail4[1].glcf069_desc,s_detail4[1].glcf070,s_detail4[1].glcf070_desc,s_detail4[1].glcf071, 
               s_detail4[1].glcf071_desc,s_detail4[1].glcf072,s_detail4[1].edit4
                      
         BEFORE CONSTRUCT
            #add-point:cs段before_construct
            {<point name="cs.body.before_construct"/>}
            #end add-point 
            
       #單身公用欄位開窗相關處理
       
         
       #單身一般欄位開窗相關處理
                #Ctrlp:construct.c.page1.glcf003
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf003
            #add-point:ON ACTION controlp INFIELD glcf003
            {<point name="construct.c.page1.glcf003" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf003
            #add-point:BEFORE FIELD glcf003
            {<point name="construct.b.page1.glcf003" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf003
            
            #add-point:AFTER FIELD glcf003
            {<point name="construct.a.page1.glcf003" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.glcf003_desc
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf003_desc
            #add-point:ON ACTION controlp INFIELD glcf003_desc
            {<point name="construct.c.page1.glcf003_desc" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf003_desc
            #add-point:BEFORE FIELD glcf003_desc
            {<point name="construct.b.page1.glcf003_desc" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf003_desc
            
            #add-point:AFTER FIELD glcf003_desc
            {<point name="construct.a.page1.glcf003_desc" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf004
            #add-point:BEFORE FIELD glcf004
            {<point name="construct.b.page1.glcf004" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf004
            
            #add-point:AFTER FIELD glcf004
            {<point name="construct.a.page1.glcf004" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.glcf004
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf004
            #add-point:ON ACTION controlp INFIELD glcf004
            {<point name="construct.c.page1.glcf004" />}
            #END add-point
 
         #Ctrlp:construct.c.page1.glcf005
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf005
            #add-point:ON ACTION controlp INFIELD glcf005
            {<point name="construct.c.page1.glcf005" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf005
            #add-point:BEFORE FIELD glcf005
            {<point name="construct.b.page1.glcf005" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf005
            
            #add-point:AFTER FIELD glcf005
            {<point name="construct.a.page1.glcf005" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf006
            #add-point:BEFORE FIELD glcf006
            {<point name="construct.b.page1.glcf006" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf006
            
            #add-point:AFTER FIELD glcf006
            {<point name="construct.a.page1.glcf006" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.glcf006
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf006
            #add-point:ON ACTION controlp INFIELD glcf006
            {<point name="construct.c.page1.glcf006" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf007
            #add-point:BEFORE FIELD glcf007
            {<point name="construct.b.page1.glcf007" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf007
            
            #add-point:AFTER FIELD glcf007
            {<point name="construct.a.page1.glcf007" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.glcf007
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf007
            #add-point:ON ACTION controlp INFIELD glcf007
            {<point name="construct.c.page1.glcf007" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf008
            #add-point:BEFORE FIELD glcf008
            {<point name="construct.b.page1.glcf008" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf008
            
            #add-point:AFTER FIELD glcf008
            {<point name="construct.a.page1.glcf008" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.glcf008
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf008
            #add-point:ON ACTION controlp INFIELD glcf008
            {<point name="construct.c.page1.glcf008" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf009
            #add-point:BEFORE FIELD glcf009
            {<point name="construct.b.page1.glcf009" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf009
            
            #add-point:AFTER FIELD glcf009
            {<point name="construct.a.page1.glcf009" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.glcf009
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf009
            #add-point:ON ACTION controlp INFIELD glcf009
            {<point name="construct.c.page1.glcf009" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf010
            #add-point:BEFORE FIELD glcf010
            {<point name="construct.b.page1.glcf010" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf010
            
            #add-point:AFTER FIELD glcf010
            {<point name="construct.a.page1.glcf010" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.glcf010
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf010
            #add-point:ON ACTION controlp INFIELD glcf010
            {<point name="construct.c.page1.glcf010" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf011
            #add-point:BEFORE FIELD glcf011
            {<point name="construct.b.page1.glcf011" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf011
            
            #add-point:AFTER FIELD glcf011
            {<point name="construct.a.page1.glcf011" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.glcf011
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf011
            #add-point:ON ACTION controlp INFIELD glcf011
            {<point name="construct.c.page1.glcf011" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf012
            #add-point:BEFORE FIELD glcf012
            {<point name="construct.b.page1.glcf012" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf012
            
            #add-point:AFTER FIELD glcf012
            {<point name="construct.a.page1.glcf012" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.glcf012
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf012
            #add-point:ON ACTION controlp INFIELD glcf012
            {<point name="construct.c.page1.glcf012" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf073
            #add-point:BEFORE FIELD glcf073
            {<point name="construct.b.page1.glcf073" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf073
            
            #add-point:AFTER FIELD glcf073
            {<point name="construct.a.page1.glcf073" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.glcf073
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf073
            #add-point:ON ACTION controlp INFIELD glcf073
            {<point name="construct.c.page1.glcf073" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD edit1
            #add-point:BEFORE FIELD edit1
            {<point name="construct.b.page1.edit1" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD edit1
            
            #add-point:AFTER FIELD edit1
            {<point name="construct.a.page1.edit1" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.edit1
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD edit1
            #add-point:ON ACTION controlp INFIELD edit1
            {<point name="construct.c.page1.edit1" />}
            #END add-point
 
         #Ctrlp:construct.c.page2.glcf003_2_desc
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf003_2_desc
            #add-point:ON ACTION controlp INFIELD glcf003_2_desc
            {<point name="construct.c.page2.glcf003_2_desc" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf003_2_desc
            #add-point:BEFORE FIELD glcf003_2_desc
            {<point name="construct.b.page2.glcf003_2_desc" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf003_2_desc
            
            #add-point:AFTER FIELD glcf003_2_desc
            {<point name="construct.a.page2.glcf003_2_desc" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf013
            #add-point:BEFORE FIELD glcf013
            {<point name="construct.b.page2.glcf013" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf013
            
            #add-point:AFTER FIELD glcf013
            {<point name="construct.a.page2.glcf013" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page2.glcf013
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf013
            #add-point:ON ACTION controlp INFIELD glcf013
            {<point name="construct.c.page2.glcf013" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf014
            #add-point:BEFORE FIELD glcf014
            {<point name="construct.b.page2.glcf014" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf014
            
            #add-point:AFTER FIELD glcf014
            {<point name="construct.a.page2.glcf014" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page2.glcf014
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf014
            #add-point:ON ACTION controlp INFIELD glcf014
            {<point name="construct.c.page2.glcf014" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf015
            #add-point:BEFORE FIELD glcf015
            {<point name="construct.b.page2.glcf015" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf015
            
            #add-point:AFTER FIELD glcf015
            {<point name="construct.a.page2.glcf015" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page2.glcf015
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf015
            #add-point:ON ACTION controlp INFIELD glcf015
            {<point name="construct.c.page2.glcf015" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf016
            #add-point:BEFORE FIELD glcf016
            {<point name="construct.b.page2.glcf016" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf016
            
            #add-point:AFTER FIELD glcf016
            {<point name="construct.a.page2.glcf016" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page2.glcf016
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf016
            #add-point:ON ACTION controlp INFIELD glcf016
            {<point name="construct.c.page2.glcf016" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf017
            #add-point:BEFORE FIELD glcf017
            {<point name="construct.b.page2.glcf017" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf017
            
            #add-point:AFTER FIELD glcf017
            {<point name="construct.a.page2.glcf017" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page2.glcf017
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf017
            #add-point:ON ACTION controlp INFIELD glcf017
            {<point name="construct.c.page2.glcf017" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD edit2
            #add-point:BEFORE FIELD edit2
            {<point name="construct.b.page2.edit2" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD edit2
            
            #add-point:AFTER FIELD edit2
            {<point name="construct.a.page2.edit2" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page2.edit2
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD edit2
            #add-point:ON ACTION controlp INFIELD edit2
            {<point name="construct.c.page2.edit2" />}
            #END add-point
 
         #Ctrlp:construct.c.page3.glcf003_3_desc
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf003_3_desc
            #add-point:ON ACTION controlp INFIELD glcf003_3_desc
            {<point name="construct.c.page3.glcf003_3_desc" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf003_3_desc
            #add-point:BEFORE FIELD glcf003_3_desc
            {<point name="construct.b.page3.glcf003_3_desc" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf003_3_desc
            
            #add-point:AFTER FIELD glcf003_3_desc
            {<point name="construct.a.page3.glcf003_3_desc" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf018
            #add-point:BEFORE FIELD glcf018
            {<point name="construct.b.page3.glcf018" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf018
            
            #add-point:AFTER FIELD glcf018
            {<point name="construct.a.page3.glcf018" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.glcf018
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf018
            #add-point:ON ACTION controlp INFIELD glcf018
            {<point name="construct.c.page3.glcf018" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf019
            #add-point:BEFORE FIELD glcf019
            {<point name="construct.b.page3.glcf019" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf019
            
            #add-point:AFTER FIELD glcf019
            {<point name="construct.a.page3.glcf019" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.glcf019
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf019
            #add-point:ON ACTION controlp INFIELD glcf019
            {<point name="construct.c.page3.glcf019" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf020
            #add-point:BEFORE FIELD glcf020
            {<point name="construct.b.page3.glcf020" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf020
            
            #add-point:AFTER FIELD glcf020
            {<point name="construct.a.page3.glcf020" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.glcf020
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf020
            #add-point:ON ACTION controlp INFIELD glcf020
            {<point name="construct.c.page3.glcf020" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf021
            #add-point:BEFORE FIELD glcf021
            {<point name="construct.b.page3.glcf021" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf021
            
            #add-point:AFTER FIELD glcf021
            {<point name="construct.a.page3.glcf021" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.glcf021
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf021
            #add-point:ON ACTION controlp INFIELD glcf021
            {<point name="construct.c.page3.glcf021" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf022
            #add-point:BEFORE FIELD glcf022
            {<point name="construct.b.page3.glcf022" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf022
            
            #add-point:AFTER FIELD glcf022
            {<point name="construct.a.page3.glcf022" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.glcf022
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf022
            #add-point:ON ACTION controlp INFIELD glcf022
            {<point name="construct.c.page3.glcf022" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD edit3
            #add-point:BEFORE FIELD edit3
            {<point name="construct.b.page3.edit3" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD edit3
            
            #add-point:AFTER FIELD edit3
            {<point name="construct.a.page3.edit3" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.edit3
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD edit3
            #add-point:ON ACTION controlp INFIELD edit3
            {<point name="construct.c.page3.edit3" />}
            #END add-point
 
         #Ctrlp:construct.c.page4.glcf003_4_desc
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf003_4_desc
            #add-point:ON ACTION controlp INFIELD glcf003_4_desc
            {<point name="construct.c.page4.glcf003_4_desc" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf003_4_desc
            #add-point:BEFORE FIELD glcf003_4_desc
            {<point name="construct.b.page4.glcf003_4_desc" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf003_4_desc
            
            #add-point:AFTER FIELD glcf003_4_desc
            {<point name="construct.a.page4.glcf003_4_desc" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf047
            #add-point:BEFORE FIELD glcf047
            {<point name="construct.b.page4.glcf047" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf047
            
            #add-point:AFTER FIELD glcf047
            {<point name="construct.a.page4.glcf047" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.glcf047
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf047
            #add-point:ON ACTION controlp INFIELD glcf047
            {<point name="construct.c.page4.glcf047" />}
            #END add-point
 
         #Ctrlp:construct.c.page4.glcf047_desc
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf047_desc
            #add-point:ON ACTION controlp INFIELD glcf047_desc
            {<point name="construct.c.page4.glcf047_desc" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf047_desc
            #add-point:BEFORE FIELD glcf047_desc
            {<point name="construct.b.page4.glcf047_desc" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf047_desc
            
            #add-point:AFTER FIELD glcf047_desc
            {<point name="construct.a.page4.glcf047_desc" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf048
            #add-point:BEFORE FIELD glcf048
            {<point name="construct.b.page4.glcf048" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf048
            
            #add-point:AFTER FIELD glcf048
            {<point name="construct.a.page4.glcf048" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.glcf048
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf048
            #add-point:ON ACTION controlp INFIELD glcf048
            {<point name="construct.c.page4.glcf048" />}
            #END add-point
 
         #Ctrlp:construct.c.page4.glcf048_desc
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf048_desc
            #add-point:ON ACTION controlp INFIELD glcf048_desc
            {<point name="construct.c.page4.glcf048_desc" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf048_desc
            #add-point:BEFORE FIELD glcf048_desc
            {<point name="construct.b.page4.glcf048_desc" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf048_desc
            
            #add-point:AFTER FIELD glcf048_desc
            {<point name="construct.a.page4.glcf048_desc" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf049
            #add-point:BEFORE FIELD glcf049
            {<point name="construct.b.page4.glcf049" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf049
            
            #add-point:AFTER FIELD glcf049
            {<point name="construct.a.page4.glcf049" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.glcf049
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf049
            #add-point:ON ACTION controlp INFIELD glcf049
            {<point name="construct.c.page4.glcf049" />}
            #END add-point
 
         #Ctrlp:construct.c.page4.glcf049_desc
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf049_desc
            #add-point:ON ACTION controlp INFIELD glcf049_desc
            {<point name="construct.c.page4.glcf049_desc" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf049_desc
            #add-point:BEFORE FIELD glcf049_desc
            {<point name="construct.b.page4.glcf049_desc" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf049_desc
            
            #add-point:AFTER FIELD glcf049_desc
            {<point name="construct.a.page4.glcf049_desc" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf050
            #add-point:BEFORE FIELD glcf050
            {<point name="construct.b.page4.glcf050" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf050
            
            #add-point:AFTER FIELD glcf050
            {<point name="construct.a.page4.glcf050" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.glcf050
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf050
            #add-point:ON ACTION controlp INFIELD glcf050
            {<point name="construct.c.page4.glcf050" />}
            #END add-point
 
         #Ctrlp:construct.c.page4.glcf050_desc
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf050_desc
            #add-point:ON ACTION controlp INFIELD glcf050_desc
            {<point name="construct.c.page4.glcf050_desc" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf050_desc
            #add-point:BEFORE FIELD glcf050_desc
            {<point name="construct.b.page4.glcf050_desc" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf050_desc
            
            #add-point:AFTER FIELD glcf050_desc
            {<point name="construct.a.page4.glcf050_desc" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf051
            #add-point:BEFORE FIELD glcf051
            {<point name="construct.b.page4.glcf051" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf051
            
            #add-point:AFTER FIELD glcf051
            {<point name="construct.a.page4.glcf051" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.glcf051
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf051
            #add-point:ON ACTION controlp INFIELD glcf051
            {<point name="construct.c.page4.glcf051" />}
            #END add-point
 
         #Ctrlp:construct.c.page4.glcf051_desc
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf051_desc
            #add-point:ON ACTION controlp INFIELD glcf051_desc
            {<point name="construct.c.page4.glcf051_desc" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf051_desc
            #add-point:BEFORE FIELD glcf051_desc
            {<point name="construct.b.page4.glcf051_desc" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf051_desc
            
            #add-point:AFTER FIELD glcf051_desc
            {<point name="construct.a.page4.glcf051_desc" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf052
            #add-point:BEFORE FIELD glcf052
            {<point name="construct.b.page4.glcf052" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf052
            
            #add-point:AFTER FIELD glcf052
            {<point name="construct.a.page4.glcf052" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.glcf052
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf052
            #add-point:ON ACTION controlp INFIELD glcf052
            {<point name="construct.c.page4.glcf052" />}
            #END add-point
 
         #Ctrlp:construct.c.page4.glcf052_desc
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf052_desc
            #add-point:ON ACTION controlp INFIELD glcf052_desc
            {<point name="construct.c.page4.glcf052_desc" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf052_desc
            #add-point:BEFORE FIELD glcf052_desc
            {<point name="construct.b.page4.glcf052_desc" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf052_desc
            
            #add-point:AFTER FIELD glcf052_desc
            {<point name="construct.a.page4.glcf052_desc" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf053
            #add-point:BEFORE FIELD glcf053
            {<point name="construct.b.page4.glcf053" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf053
            
            #add-point:AFTER FIELD glcf053
            {<point name="construct.a.page4.glcf053" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.glcf053
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf053
            #add-point:ON ACTION controlp INFIELD glcf053
            {<point name="construct.c.page4.glcf053" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf053_desc
            #add-point:BEFORE FIELD glcf053_desc
            {<point name="construct.b.page4.glcf053_desc" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf053_desc
            
            #add-point:AFTER FIELD glcf053_desc
            {<point name="construct.a.page4.glcf053_desc" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.glcf053_desc
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf053_desc
            #add-point:ON ACTION controlp INFIELD glcf053_desc
            {<point name="construct.c.page4.glcf053_desc" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf054
            #add-point:BEFORE FIELD glcf054
            {<point name="construct.b.page4.glcf054" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf054
            
            #add-point:AFTER FIELD glcf054
            {<point name="construct.a.page4.glcf054" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.glcf054
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf054
            #add-point:ON ACTION controlp INFIELD glcf054
            {<point name="construct.c.page4.glcf054" />}
            #END add-point
 
         #Ctrlp:construct.c.page4.glcf054_desc
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf054_desc
            #add-point:ON ACTION controlp INFIELD glcf054_desc
            {<point name="construct.c.page4.glcf054_desc" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf054_desc
            #add-point:BEFORE FIELD glcf054_desc
            {<point name="construct.b.page4.glcf054_desc" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf054_desc
            
            #add-point:AFTER FIELD glcf054_desc
            {<point name="construct.a.page4.glcf054_desc" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf055
            #add-point:BEFORE FIELD glcf055
            {<point name="construct.b.page4.glcf055" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf055
            
            #add-point:AFTER FIELD glcf055
            {<point name="construct.a.page4.glcf055" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.glcf055
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf055
            #add-point:ON ACTION controlp INFIELD glcf055
            {<point name="construct.c.page4.glcf055" />}
            #END add-point
 
         #Ctrlp:construct.c.page4.glcf055_desc
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf055_desc
            #add-point:ON ACTION controlp INFIELD glcf055_desc
            {<point name="construct.c.page4.glcf055_desc" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf055_desc
            #add-point:BEFORE FIELD glcf055_desc
            {<point name="construct.b.page4.glcf055_desc" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf055_desc
            
            #add-point:AFTER FIELD glcf055_desc
            {<point name="construct.a.page4.glcf055_desc" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf056
            #add-point:BEFORE FIELD glcf056
            {<point name="construct.b.page4.glcf056" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf056
            
            #add-point:AFTER FIELD glcf056
            {<point name="construct.a.page4.glcf056" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.glcf056
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf056
            #add-point:ON ACTION controlp INFIELD glcf056
            {<point name="construct.c.page4.glcf056" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf057
            #add-point:BEFORE FIELD glcf057
            {<point name="construct.b.page4.glcf057" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf057
            
            #add-point:AFTER FIELD glcf057
            {<point name="construct.a.page4.glcf057" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.glcf057
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf057
            #add-point:ON ACTION controlp INFIELD glcf057
            {<point name="construct.c.page4.glcf057" />}
            #END add-point
 
         #Ctrlp:construct.c.page4.glcf057_desc
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf057_desc
            #add-point:ON ACTION controlp INFIELD glcf057_desc
            {<point name="construct.c.page4.glcf057_desc" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf057_desc
            #add-point:BEFORE FIELD glcf057_desc
            {<point name="construct.b.page4.glcf057_desc" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf057_desc
            
            #add-point:AFTER FIELD glcf057_desc
            {<point name="construct.a.page4.glcf057_desc" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf058
            #add-point:BEFORE FIELD glcf058
            {<point name="construct.b.page4.glcf058" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf058
            
            #add-point:AFTER FIELD glcf058
            {<point name="construct.a.page4.glcf058" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.glcf058
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf058
            #add-point:ON ACTION controlp INFIELD glcf058
            {<point name="construct.c.page4.glcf058" />}
            #END add-point
 
         #Ctrlp:construct.c.page4.glcf058_desc
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf058_desc
            #add-point:ON ACTION controlp INFIELD glcf058_desc
            {<point name="construct.c.page4.glcf058_desc" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf058_desc
            #add-point:BEFORE FIELD glcf058_desc
            {<point name="construct.b.page4.glcf058_desc" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf058_desc
            
            #add-point:AFTER FIELD glcf058_desc
            {<point name="construct.a.page4.glcf058_desc" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf059
            #add-point:BEFORE FIELD glcf059
            {<point name="construct.b.page4.glcf059" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf059
            
            #add-point:AFTER FIELD glcf059
            {<point name="construct.a.page4.glcf059" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.glcf059
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf059
            #add-point:ON ACTION controlp INFIELD glcf059
            {<point name="construct.c.page4.glcf059" />}
            #END add-point
 
         #Ctrlp:construct.c.page4.glcf059_desc
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf059_desc
            #add-point:ON ACTION controlp INFIELD glcf059_desc
            {<point name="construct.c.page4.glcf059_desc" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf059_desc
            #add-point:BEFORE FIELD glcf059_desc
            {<point name="construct.b.page4.glcf059_desc" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf059_desc
            
            #add-point:AFTER FIELD glcf059_desc
            {<point name="construct.a.page4.glcf059_desc" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf060
            #add-point:BEFORE FIELD glcf060
            {<point name="construct.b.page4.glcf060" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf060
            
            #add-point:AFTER FIELD glcf060
            {<point name="construct.a.page4.glcf060" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.glcf060
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf060
            #add-point:ON ACTION controlp INFIELD glcf060
            {<point name="construct.c.page4.glcf060" />}
            #END add-point
 
         #Ctrlp:construct.c.page4.glcf060_desc
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf060_desc
            #add-point:ON ACTION controlp INFIELD glcf060_desc
            {<point name="construct.c.page4.glcf060_desc" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf060_desc
            #add-point:BEFORE FIELD glcf060_desc
            {<point name="construct.b.page4.glcf060_desc" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf060_desc
            
            #add-point:AFTER FIELD glcf060_desc
            {<point name="construct.a.page4.glcf060_desc" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf061
            #add-point:BEFORE FIELD glcf061
            {<point name="construct.b.page4.glcf061" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf061
            
            #add-point:AFTER FIELD glcf061
            {<point name="construct.a.page4.glcf061" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.glcf061
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf061
            #add-point:ON ACTION controlp INFIELD glcf061
            {<point name="construct.c.page4.glcf061" />}
            #END add-point
 
         #Ctrlp:construct.c.page4.glcf061_desc
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf061_desc
            #add-point:ON ACTION controlp INFIELD glcf061_desc
            {<point name="construct.c.page4.glcf061_desc" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf061_desc
            #add-point:BEFORE FIELD glcf061_desc
            {<point name="construct.b.page4.glcf061_desc" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf061_desc
            
            #add-point:AFTER FIELD glcf061_desc
            {<point name="construct.a.page4.glcf061_desc" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf062
            #add-point:BEFORE FIELD glcf062
            {<point name="construct.b.page4.glcf062" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf062
            
            #add-point:AFTER FIELD glcf062
            {<point name="construct.a.page4.glcf062" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.glcf062
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf062
            #add-point:ON ACTION controlp INFIELD glcf062
            {<point name="construct.c.page4.glcf062" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf062_desc
            #add-point:BEFORE FIELD glcf062_desc
            {<point name="construct.b.page4.glcf062_desc" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf062_desc
            
            #add-point:AFTER FIELD glcf062_desc
            {<point name="construct.a.page4.glcf062_desc" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.glcf062_desc
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf062_desc
            #add-point:ON ACTION controlp INFIELD glcf062_desc
            {<point name="construct.c.page4.glcf062_desc" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf063
            #add-point:BEFORE FIELD glcf063
            {<point name="construct.b.page4.glcf063" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf063
            
            #add-point:AFTER FIELD glcf063
            {<point name="construct.a.page4.glcf063" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.glcf063
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf063
            #add-point:ON ACTION controlp INFIELD glcf063
            {<point name="construct.c.page4.glcf063" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf063_desc
            #add-point:BEFORE FIELD glcf063_desc
            {<point name="construct.b.page4.glcf063_desc" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf063_desc
            
            #add-point:AFTER FIELD glcf063_desc
            {<point name="construct.a.page4.glcf063_desc" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.glcf063_desc
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf063_desc
            #add-point:ON ACTION controlp INFIELD glcf063_desc
            {<point name="construct.c.page4.glcf063_desc" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf064
            #add-point:BEFORE FIELD glcf064
            {<point name="construct.b.page4.glcf064" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf064
            
            #add-point:AFTER FIELD glcf064
            {<point name="construct.a.page4.glcf064" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.glcf064
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf064
            #add-point:ON ACTION controlp INFIELD glcf064
            {<point name="construct.c.page4.glcf064" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf064_desc
            #add-point:BEFORE FIELD glcf064_desc
            {<point name="construct.b.page4.glcf064_desc" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf064_desc
            
            #add-point:AFTER FIELD glcf064_desc
            {<point name="construct.a.page4.glcf064_desc" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.glcf064_desc
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf064_desc
            #add-point:ON ACTION controlp INFIELD glcf064_desc
            {<point name="construct.c.page4.glcf064_desc" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf065
            #add-point:BEFORE FIELD glcf065
            {<point name="construct.b.page4.glcf065" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf065
            
            #add-point:AFTER FIELD glcf065
            {<point name="construct.a.page4.glcf065" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.glcf065
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf065
            #add-point:ON ACTION controlp INFIELD glcf065
            {<point name="construct.c.page4.glcf065" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf065_desc
            #add-point:BEFORE FIELD glcf065_desc
            {<point name="construct.b.page4.glcf065_desc" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf065_desc
            
            #add-point:AFTER FIELD glcf065_desc
            {<point name="construct.a.page4.glcf065_desc" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.glcf065_desc
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf065_desc
            #add-point:ON ACTION controlp INFIELD glcf065_desc
            {<point name="construct.c.page4.glcf065_desc" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf066
            #add-point:BEFORE FIELD glcf066
            {<point name="construct.b.page4.glcf066" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf066
            
            #add-point:AFTER FIELD glcf066
            {<point name="construct.a.page4.glcf066" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.glcf066
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf066
            #add-point:ON ACTION controlp INFIELD glcf066
            {<point name="construct.c.page4.glcf066" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf066_desc
            #add-point:BEFORE FIELD glcf066_desc
            {<point name="construct.b.page4.glcf066_desc" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf066_desc
            
            #add-point:AFTER FIELD glcf066_desc
            {<point name="construct.a.page4.glcf066_desc" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.glcf066_desc
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf066_desc
            #add-point:ON ACTION controlp INFIELD glcf066_desc
            {<point name="construct.c.page4.glcf066_desc" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf067
            #add-point:BEFORE FIELD glcf067
            {<point name="construct.b.page4.glcf067" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf067
            
            #add-point:AFTER FIELD glcf067
            {<point name="construct.a.page4.glcf067" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.glcf067
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf067
            #add-point:ON ACTION controlp INFIELD glcf067
            {<point name="construct.c.page4.glcf067" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf067_desc
            #add-point:BEFORE FIELD glcf067_desc
            {<point name="construct.b.page4.glcf067_desc" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf067_desc
            
            #add-point:AFTER FIELD glcf067_desc
            {<point name="construct.a.page4.glcf067_desc" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.glcf067_desc
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf067_desc
            #add-point:ON ACTION controlp INFIELD glcf067_desc
            {<point name="construct.c.page4.glcf067_desc" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf068
            #add-point:BEFORE FIELD glcf068
            {<point name="construct.b.page4.glcf068" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf068
            
            #add-point:AFTER FIELD glcf068
            {<point name="construct.a.page4.glcf068" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.glcf068
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf068
            #add-point:ON ACTION controlp INFIELD glcf068
            {<point name="construct.c.page4.glcf068" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf068_desc
            #add-point:BEFORE FIELD glcf068_desc
            {<point name="construct.b.page4.glcf068_desc" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf068_desc
            
            #add-point:AFTER FIELD glcf068_desc
            {<point name="construct.a.page4.glcf068_desc" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.glcf068_desc
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf068_desc
            #add-point:ON ACTION controlp INFIELD glcf068_desc
            {<point name="construct.c.page4.glcf068_desc" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf069
            #add-point:BEFORE FIELD glcf069
            {<point name="construct.b.page4.glcf069" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf069
            
            #add-point:AFTER FIELD glcf069
            {<point name="construct.a.page4.glcf069" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.glcf069
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf069
            #add-point:ON ACTION controlp INFIELD glcf069
            {<point name="construct.c.page4.glcf069" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf069_desc
            #add-point:BEFORE FIELD glcf069_desc
            {<point name="construct.b.page4.glcf069_desc" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf069_desc
            
            #add-point:AFTER FIELD glcf069_desc
            {<point name="construct.a.page4.glcf069_desc" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.glcf069_desc
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf069_desc
            #add-point:ON ACTION controlp INFIELD glcf069_desc
            {<point name="construct.c.page4.glcf069_desc" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf070
            #add-point:BEFORE FIELD glcf070
            {<point name="construct.b.page4.glcf070" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf070
            
            #add-point:AFTER FIELD glcf070
            {<point name="construct.a.page4.glcf070" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.glcf070
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf070
            #add-point:ON ACTION controlp INFIELD glcf070
            {<point name="construct.c.page4.glcf070" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf070_desc
            #add-point:BEFORE FIELD glcf070_desc
            {<point name="construct.b.page4.glcf070_desc" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf070_desc
            
            #add-point:AFTER FIELD glcf070_desc
            {<point name="construct.a.page4.glcf070_desc" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.glcf070_desc
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf070_desc
            #add-point:ON ACTION controlp INFIELD glcf070_desc
            {<point name="construct.c.page4.glcf070_desc" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf071
            #add-point:BEFORE FIELD glcf071
            {<point name="construct.b.page4.glcf071" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf071
            
            #add-point:AFTER FIELD glcf071
            {<point name="construct.a.page4.glcf071" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.glcf071
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf071
            #add-point:ON ACTION controlp INFIELD glcf071
            {<point name="construct.c.page4.glcf071" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf071_desc
            #add-point:BEFORE FIELD glcf071_desc
            {<point name="construct.b.page4.glcf071_desc" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf071_desc
            
            #add-point:AFTER FIELD glcf071_desc
            {<point name="construct.a.page4.glcf071_desc" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.glcf071_desc
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf071_desc
            #add-point:ON ACTION controlp INFIELD glcf071_desc
            {<point name="construct.c.page4.glcf071_desc" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf072
            #add-point:BEFORE FIELD glcf072
            {<point name="construct.b.page4.glcf072" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf072
            
            #add-point:AFTER FIELD glcf072
            {<point name="construct.a.page4.glcf072" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.glcf072
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf072
            #add-point:ON ACTION controlp INFIELD glcf072
            {<point name="construct.c.page4.glcf072" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD edit4
            #add-point:BEFORE FIELD edit4
            {<point name="construct.b.page4.edit4" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD edit4
            
            #add-point:AFTER FIELD edit4
            {<point name="construct.a.page4.edit4" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.edit4
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD edit4
            #add-point:ON ACTION controlp INFIELD edit4
            {<point name="construct.c.page4.edit4" />}
            #END add-point
 
   
       
      END CONSTRUCT
      
 
      
 
      
      #add-point:cs段add_cs(本段內只能出現新的CONSTRUCT指令)
      {<point name="cs.add_cs"/>}
      #end add-point
 
      BEFORE DIALOG
         CALL cl_qbe_init()
         #add-point:cs段b_dialog
         {<point name="cs.b_dialog"/>}
         #end add-point  
 
      #查詢方案列表
      ON ACTION qbe_select
         LET ls_wc = ""
         CALL cl_qbe_list("c") RETURNING ls_wc
         IF NOT cl_null(ls_wc) THEN
            CALL util.JSON.parse(ls_wc, la_wc)
            INITIALIZE g_wc, g_wc2, g_wc2_table1, g_wc2_extend TO NULL
 
            FOR li_idx = 1 TO la_wc.getLength()
               CASE
                  WHEN la_wc[li_idx].tableid = "glce_t" 
                     LET g_wc = la_wc[li_idx].wc
                  WHEN la_wc[li_idx].tableid = "glcf_t" 
                     LET g_wc2_table1 = la_wc[li_idx].wc
 
               END CASE
            END FOR
         END IF
    
      #條件儲存為方案
      ON ACTION qbe_save
         CALL cl_qbe_save()
 
      ON ACTION accept
         ACCEPT DIALOG
 
      ON ACTION cancel
         LET INT_FLAG = 1
         EXIT DIALOG 
 
      #交談指令共用ACTION
      &include "common_action.4gl" 
         CONTINUE DIALOG
   END DIALOG
   
   #組合g_wc2
   LET g_wc2 = g_wc2_table1
 
 
 
   
   #add-point:cs段結束前
   {<point name="cs.after_construct"/>}
   #end add-point    
 
   IF INT_FLAG THEN
      RETURN
   END IF
 
END FUNCTION
]]>
  </section>
  <section id="aglt420.default_search" ver="5" status="" src="s" readonly="">
    <![CDATA[#+ 外部參數搜尋
PRIVATE FUNCTION aglt420_default_search()
   DEFINE li_idx     LIKE type_t.num10
   DEFINE li_cnt     LIKE type_t.num10
   DEFINE ls_wc      STRING
   DEFINE la_wc      DYNAMIC ARRAY OF RECORD
          tableid    STRING,
          wc         STRING
          END RECORD
   DEFINE ls_where   STRING
   #add-point:default_search段define
   {<point name="default_search.define" edit="s"/>}
   #end add-point  
   #add-point:default_search段define(客製用)
   {<point name="default_search.define_customerization" edit="c"/>}
   #end add-point  
   
   #add-point:default_search段開始前
   {<point name="default_search.before"/>}
   #end add-point  
   
   LET g_pagestart = 1
   
   IF cl_null(g_order) THEN
      LET g_order = "ASC"
   END IF
   
   IF NOT cl_null(g_argv[01]) THEN
      LET ls_wc = ls_wc, " glceld = '", g_argv[01], "' AND "
   END IF
   
   IF NOT cl_null(g_argv[02]) THEN
      LET ls_wc = ls_wc, " glce001 = '", g_argv[02], "' AND "
   END IF
   IF NOT cl_null(g_argv[03]) THEN
      LET ls_wc = ls_wc, " glce002 = '", g_argv[03], "' AND "
   END IF
 
   
   #add-point:default_search段after sql
   {<point name="default_search.after_sql"/>}
   #end add-point  
   
   IF NOT cl_null(ls_wc) THEN
      LET g_wc = ls_wc.subString(1,ls_wc.getLength()-5)
      LET g_default = TRUE
   ELSE
      #若無外部參數則預設為1=2
      LET g_default = FALSE
      
      #預設查詢條件
      CALL cl_qbe_get_default_qryplan() RETURNING ls_where
      IF NOT cl_null(ls_where) THEN
         CALL util.JSON.parse(ls_where, la_wc)
         INITIALIZE g_wc, g_wc2,g_wc2_table1,g_wc2_extend TO NULL
 
         FOR li_idx = 1 TO la_wc.getLength()
            CASE
               WHEN la_wc[li_idx].tableid = "glce_t" 
                  LET g_wc = la_wc[li_idx].wc
               WHEN la_wc[li_idx].tableid = "glcf_t" 
                  LET g_wc2_table1 = la_wc[li_idx].wc
 
               WHEN la_wc[li_idx].tableid = "EXTENDWC"
                  LET g_wc2_extend = la_wc[li_idx].wc
            END CASE
         END FOR
         IF NOT cl_null(g_wc) OR NOT cl_null(g_wc2_table1) 
 
            OR NOT cl_null(g_wc2_extend)
            THEN
            #組合g_wc2
            IF g_wc2_table1 <> " 1=1" AND NOT cl_null(g_wc2_table1) THEN
               LET g_wc2 = g_wc2_table1
            END IF
 
            IF g_wc2_extend <> " 1=1" AND NOT cl_null(g_wc2_extend) THEN
               LET g_wc2 = g_wc2 ," AND ", g_wc2_extend
            END IF
         
            IF g_wc2.subString(1,5) = " AND " THEN
               LET g_wc2 = g_wc2.subString(6,g_wc2.getLength())
            END IF
         END IF
      END IF
    
      IF cl_null(g_wc) AND cl_null(g_wc2) THEN
         LET g_wc = " 1=2"
      END IF
   END IF
   
   #add-point:default_search段結束前
   {<point name="default_search.after"/>}
   #end add-point  
 
   IF g_wc.getIndexOf(" 1=2", 1) THEN
      LET g_default = TRUE
   END IF
 
 
END FUNCTION
]]>
  </section>
  <section id="aglt420.delete" ver="14" status="" src="s" readonly="">
    <![CDATA[#+ 資料刪除
PRIVATE FUNCTION aglt420_delete()
   DEFINE  l_var_keys      DYNAMIC ARRAY OF STRING
   DEFINE  l_field_keys    DYNAMIC ARRAY OF STRING
   DEFINE  l_vars          DYNAMIC ARRAY OF STRING
   DEFINE  l_fields        DYNAMIC ARRAY OF STRING
   DEFINE  l_var_keys_bak  DYNAMIC ARRAY OF STRING
   #add-point:delete段define
   {<point name="delete.define" edit="s"/>}
   #end add-point     
   #add-point:delete段define(客製用)
   {<point name="delete.define_customerization" edit="c"/>}
   #end add-point     
   
   IF g_glce_m.glceld IS NULL
   OR g_glce_m.glce001 IS NULL
   OR g_glce_m.glce002 IS NULL
 
   THEN
      INITIALIZE g_errparam TO NULL 
      LET g_errparam.extend = "" 
      LET g_errparam.code   = "std-00003" 
      LET g_errparam.popup  = FALSE 
      CALL cl_err()
      RETURN
   END IF
   
   
   
   CALL s_transaction_begin()
 
   OPEN aglt420_cl USING g_enterprise,g_glce_m.glceld,g_glce_m.glce001,g_glce_m.glce002
   IF STATUS THEN
      INITIALIZE g_errparam TO NULL 
      LET g_errparam.extend = "OPEN aglt420_cl:" 
      LET g_errparam.code   = STATUS 
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      CLOSE aglt420_cl
      CALL s_transaction_end('N','0')
      RETURN
   END IF
 
   #顯示最新的資料
   EXECUTE aglt420_master_referesh USING g_glce_m.glceld,g_glce_m.glce001,g_glce_m.glce002 INTO g_glce_m.glceld, 
       g_glce_m.glcecomp,g_glce_m.glce001,g_glce_m.glce002,g_glce_m.glce003,g_glce_m.glce004,g_glce_m.glce006, 
       g_glce_m.glce005,g_glce_m.glcedocno,g_glce_m.glcestus,g_glce_m.glceownid,g_glce_m.glceowndp,g_glce_m.glcecrtid, 
       g_glce_m.glcecrtdp,g_glce_m.glcecrtdt,g_glce_m.glcemodid,g_glce_m.glcemoddt,g_glce_m.glcecnfid, 
       g_glce_m.glcecnfdt,g_glce_m.glceld_desc,g_glce_m.glcecomp_desc,g_glce_m.glce003_desc,g_glce_m.glceownid_desc, 
       g_glce_m.glceowndp_desc,g_glce_m.glcecrtid_desc,g_glce_m.glcecrtdp_desc,g_glce_m.glcemodid_desc, 
       g_glce_m.glcecnfid_desc
   
   #檢查是否允許此動作
   IF NOT aglt420_action_chk() THEN
      RETURN
   END IF
   
   #遮罩相關處理
   LET g_glce_m_mask_o.* =  g_glce_m.*
   CALL aglt420_glce_t_mask()
   LET g_glce_m_mask_n.* =  g_glce_m.*
   
   CALL aglt420_show()
   
   #add-point:delete段before ask
   {<point name="delete.before_ask"/>}
   #end add-point 
 
   IF cl_ask_del_master() THEN              #確認一下
   
      #add-point:單頭刪除前
      {<point name="delete.head.b_delete" mark="Y"/>}
      #end add-point   
      
      #應用 a47 樣板自動產生(Version:2)
      #刪除相關文件
      CALL aglt420_set_pk_array()
      #add-point:相關文件刪除前
      {<point name="delete.befroe.related_document_remove"/>}
      #end add-point   
      CALL cl_doc_remove()  
 
 
  
  
      #資料備份
      LET g_glceld_t = g_glce_m.glceld
      LET g_glce001_t = g_glce_m.glce001
      LET g_glce002_t = g_glce_m.glce002
 
 
      DELETE FROM glce_t
       WHERE glceent = g_enterprise AND glceld = g_glce_m.glceld
         AND glce001 = g_glce_m.glce001
         AND glce002 = g_glce_m.glce002
 
       
      #add-point:單頭刪除中
      {<point name="delete.head.m_delete"/>}
      #end add-point
       
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = g_glce_m.glceld 
         LET g_errparam.code   = SQLCA.sqlcode 
         LET g_errparam.popup  = FALSE 
         CALL cl_err()
         CALL s_transaction_end('N','0')
         RETURN
      END IF
      
      #add-point:單頭刪除後
      {<point name="delete.head.a_delete"/>}
      #end add-point
  
      #add-point:單身刪除前
      {<point name="delete.body.b_delete" mark="Y"/>}
      #end add-point
      
      DELETE FROM glcf_t
       WHERE glcfent = g_enterprise AND glcfld = g_glce_m.glceld
         AND glcf001 = g_glce_m.glce001
         AND glcf002 = g_glce_m.glce002
 
 
      #add-point:單身刪除中
      {<point name="delete.body.m_delete"/>}
      #end add-point
         
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = "glcf_t" 
         LET g_errparam.code   = SQLCA.sqlcode 
         LET g_errparam.popup  = FALSE 
         CALL cl_err()
         CALL s_transaction_end('N','0')
         RETURN
      END IF    
 
      #add-point:單身刪除後
      {<point name="delete.body.a_delete"/>}
      #end add-point
      
            
                                                               
 
 
 
      
      #修改歷程記錄(刪除)
      IF NOT cl_log_modified_record('','') THEN 
         CLOSE aglt420_cl
         CALL s_transaction_end('N','0')
         RETURN
      END IF
             
      CLEAR FORM
      CALL g_glcf_d.clear() 
      CALL g_glcf2_d.clear()       
      CALL g_glcf3_d.clear()       
      CALL g_glcf4_d.clear()       
 
     
      CALL aglt420_ui_browser_refresh()  
      #CALL aglt420_ui_headershow()  
      #CALL aglt420_ui_detailshow()
      
      IF g_browser_cnt > 0 THEN 
         #CALL aglt420_browser_fill("")
         CALL aglt420_fetch('P')
         DISPLAY g_browser_cnt TO FORMONLY.h_count   #總筆數的顯示
         DISPLAY g_browser_cnt TO FORMONLY.b_count   #總筆數的顯示
      ELSE
         CLEAR FORM
      END IF
 
      #add-point:多語言刪除
      {<point name="delete.lang.before_delete"/>}
      #end add-point
      
      #單頭多語言刪除
      
      
      #單身多語言刪除
      
 
 
   
      #add-point:多語言刪除
      {<point name="delete.lang.delete"/>}
      #end add-point
   
   END IF
 
   CALL s_transaction_end('Y','0')
   CLOSE aglt420_cl
 
   #功能已完成,通報訊息中心
   CALL aglt420_msgcentre_notify('delete')
    
END FUNCTION
]]>
  </section>
  <section id="aglt420.delete_b" ver="8" status="" src="s" readonly="">
    <![CDATA[#+ 刪除單身後其他table連動
PRIVATE FUNCTION aglt420_delete_b(ps_table,ps_keys_bak,ps_page)
   DEFINE ps_table    STRING
   DEFINE ps_page     STRING
   DEFINE ps_keys_bak DYNAMIC ARRAY OF VARCHAR(500)
   DEFINE ls_group    STRING
   DEFINE li_idx      LIKE type_t.num10
   #add-point:delete_b段define
   {<point name="delete_b.define" edit="s"/>}
   #end add-point     
   #add-point:delete_b段define(客製用)
   {<point name="delete_b.define_customerization" edit="c"/>}
   #end add-point     
 
   LET g_update = TRUE  
   
   #判斷是否是同一群組的table
   LET ls_group = "'1','2','3','4',"
   IF ls_group.getIndexOf(ps_page,1) > 0 THEN
      #add-point:delete_b段刪除前
      {<point name="delete_b.b_delete" mark="Y"/>}
      #end add-point    
      DELETE FROM glcf_t
       WHERE glcfent = g_enterprise AND
         glcfld = ps_keys_bak[1] AND glcf001 = ps_keys_bak[2] AND glcf002 = ps_keys_bak[3] AND glcf003 = ps_keys_bak[4] AND glcf004 = ps_keys_bak[5] AND glcf005 = ps_keys_bak[6]
      #add-point:delete_b段刪除中
      {<point name="delete_b.m_delete"/>}
      #end add-point    
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = "" 
         LET g_errparam.code   = SQLCA.sqlcode 
         LET g_errparam.popup  = FALSE 
         CALL cl_err()
         RETURN FALSE
      END IF
      LET li_idx = g_detail_idx
      IF ps_page <> "'1'" THEN 
         CALL g_glcf_d.deleteElement(li_idx) 
      END IF 
      IF ps_page <> "'2'" THEN 
         CALL g_glcf2_d.deleteElement(li_idx) 
      END IF 
      IF ps_page <> "'3'" THEN 
         CALL g_glcf3_d.deleteElement(li_idx) 
      END IF 
      IF ps_page <> "'4'" THEN 
         CALL g_glcf4_d.deleteElement(li_idx) 
      END IF 
 
   END IF
   
 
   
 
   
   #add-point:delete_b段other
   {<point name="delete_b.other"/>}
   #end add-point  
   
   RETURN TRUE
   
END FUNCTION
]]>
  </section>
  <section id="aglt420.description" ver="1" status="" src="s" readonly="">
    <![CDATA[#應用 a00 樣板自動產生(Version:1)
#+ Version..: T100-ERP-1.00.00(SD版次:1,PR版次:1) Build-000052
#+ 
#+ Filename...: aglt420
#+ Description: 總帳期末調匯維護作業
#+ Creator....: 02599(2014-11-06 22:47:59)
#+ Modifier...: 02599(2014-12-12 18:06:40) -SD/PR-
]]>
  </section>
  <section id="aglt420.detail_reproduce" ver="4" status="" src="s" readonly="">
    <![CDATA[#+ 單身自動複製
PRIVATE FUNCTION aglt420_detail_reproduce()
   DEFINE ls_sql      STRING
   DEFINE ld_date     DATETIME YEAR TO SECOND
   DEFINE l_detail    RECORD LIKE glcf_t.*
 
 
   #add-point:delete段define
   {<point name="detail_reproduce.define" edit="s"/>}
   #end add-point    
   #add-point:delete段define(客製用)
   {<point name="detail_reproduce.define_customerization" edit="c"/>}
   #end add-point    
   
   CALL s_transaction_begin()
   
   LET ld_date = cl_get_current()
   
   DROP TABLE aglt420_detail
   
   #add-point:單身複製前1
   {<point name="detail_reproduce.body.table1.b_insert" mark="Y"/>}
   #end add-point
   
   #CREATE TEMP TABLE
   LET ls_sql = "CREATE GLOBAL TEMPORARY TABLE aglt420_detail AS ",
                "SELECT * FROM glcf_t "
   PREPARE repro_tbl FROM ls_sql
   EXECUTE repro_tbl
   FREE repro_tbl
                
   #將符合條件的資料丟入TEMP TABLE
   INSERT INTO aglt420_detail SELECT * FROM glcf_t 
                                         WHERE glcfent = g_enterprise AND glcfld = g_glceld_t
                                         AND glcf001 = g_glce001_t
                                         AND glcf002 = g_glce002_t
 
   
   #將key修正為調整後   
   UPDATE aglt420_detail 
      #更新key欄位
      SET glcfld = g_glce_m.glceld
          , glcf001 = g_glce_m.glce001
          , glcf002 = g_glce_m.glce002
 
      #更新共用欄位
      
 
   #add-point:單身修改前
   {<point name="detail_reproduce.body.table1.b_update"/>}
   #end add-point                                       
  
   #將資料塞回原table   
   INSERT INTO glcf_t SELECT * FROM aglt420_detail
   
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL 
      LET g_errparam.extend = "reproduce" 
      LET g_errparam.code   = SQLCA.sqlcode 
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      RETURN
   END IF
   
   #add-point:單身複製中1
   {<point name="detail_reproduce.body.table1.m_insert"/>}
   #end add-point
   
   #刪除TEMP TABLE
   DROP TABLE aglt420_detail
   
   #add-point:單身複製後1
   {<point name="detail_reproduce.body.table1.a_insert"/>}
   #end add-point
 
 
   
 
   
   #多語言複製段落
   
   
   CALL s_transaction_end('Y','0')
   
   #已新增完, 調整資料內容(修改時使用)
   LET g_glceld_t = g_glce_m.glceld
   LET g_glce001_t = g_glce_m.glce001
   LET g_glce002_t = g_glce_m.glce002
 
   
END FUNCTION
]]>
  </section>
  <section id="aglt420.detail_show" ver="3" status="" src="s" readonly="">
    <![CDATA[#+ 第二階單身reference
PRIVATE FUNCTION aglt420_detail_show()
   #add-point:detail_show段define
   {<point name="detail_show.define" edit="s"/>}
   #end add-point  
   #add-point:detail_show段define(客製用)
   {<point name="detail_show.define_customerization" edit="c"/>}
   #end add-point  
   
   #add-point:detail_show段之前
   {<point name="detail_show.before"/>}
   #end add-point
   
   #add-point:detail_show段之後
   {<point name="detail_show.after"/>}
   #end add-point
   
END FUNCTION
]]>
  </section>
  <section id="aglt420.fetch" ver="9" status="" src="s" readonly="">
    <![CDATA[#+ 指定PK後抓取單頭其他資料
PRIVATE FUNCTION aglt420_fetch(p_flag)
   DEFINE p_flag     LIKE type_t.chr1
   DEFINE ls_msg     STRING
   #add-point:fetch段define
   {<point name="fetch.define" edit="s"/>}
   #end add-point    
   #add-point:fetch段define(客製用)
   {<point name="fetch.define_customerization" edit="c"/>}
   #end add-point    
   
   IF g_browser_cnt = 0 THEN
      RETURN
   END IF
 
   CALL cl_ap_performance_next_start()
   CASE p_flag
      WHEN 'F' 
         LET g_current_idx = 1
      WHEN 'L'  
         LET g_current_idx = g_browser.getLength()              
      WHEN 'P'
         IF g_current_idx > 1 THEN               
            LET g_current_idx = g_current_idx - 1
         END IF 
      WHEN 'N'
         IF g_current_idx < g_header_cnt THEN
            LET g_current_idx =  g_current_idx + 1
         END IF        
      WHEN '/'
         IF (NOT g_no_ask) THEN    
            CALL cl_set_act_visible("accept,cancel", TRUE)    
            CALL cl_getmsg('fetch',g_lang) RETURNING ls_msg
            LET INT_FLAG = 0
 
            PROMPT ls_msg CLIPPED,':' FOR g_jump
               #交談指令共用ACTION
               &include "common_action.4gl" 
            END PROMPT
 
            CALL cl_set_act_visible("accept,cancel", FALSE)    
            IF INT_FLAG THEN
                LET INT_FLAG = 0
                EXIT CASE  
            END IF           
         END IF
         
         IF g_jump > 0 AND g_jump <= g_browser.getLength() THEN
             LET g_current_idx = g_jump
         END IF
         LET g_no_ask = FALSE  
   END CASE 
 
   
   LET g_current_row = g_current_idx
   LET g_detail_cnt = g_header_cnt                  
   
   #單身總筆數顯示
   IF g_detail_cnt > 0 THEN
      #若單身有資料時, idx至少為1
      IF g_detail_idx <= 0 THEN
         LET g_detail_idx = 1
      END IF
      DISPLAY g_detail_idx TO FORMONLY.idx  
   ELSE
      LET g_detail_idx = 0
      DISPLAY '' TO FORMONLY.idx    
   END IF
   
   #瀏覽頁筆數顯示
   LET g_pagestart = g_current_idx
   DISPLAY g_pagestart TO FORMONLY.b_index   #當下筆數
   DISPLAY g_pagestart TO FORMONLY.h_index   #當下筆數
   
   CALL cl_navigator_setting( g_pagestart, g_browser_cnt )
 
   #代表沒有資料
   IF g_current_idx = 0 OR g_browser.getLength() = 0 THEN
      RETURN
   END IF
   
   #超出範圍
   IF g_current_idx > g_browser.getLength() THEN
      LET g_current_idx = g_browser.getLength()
   END IF
   
   LET g_glce_m.glceld = g_browser[g_current_idx].b_glceld
   LET g_glce_m.glce001 = g_browser[g_current_idx].b_glce001
   LET g_glce_m.glce002 = g_browser[g_current_idx].b_glce002
 
   
   #重讀DB,因TEMP有不被更新特性
   EXECUTE aglt420_master_referesh USING g_glce_m.glceld,g_glce_m.glce001,g_glce_m.glce002 INTO g_glce_m.glceld, 
       g_glce_m.glcecomp,g_glce_m.glce001,g_glce_m.glce002,g_glce_m.glce003,g_glce_m.glce004,g_glce_m.glce006, 
       g_glce_m.glce005,g_glce_m.glcedocno,g_glce_m.glcestus,g_glce_m.glceownid,g_glce_m.glceowndp,g_glce_m.glcecrtid, 
       g_glce_m.glcecrtdp,g_glce_m.glcecrtdt,g_glce_m.glcemodid,g_glce_m.glcemoddt,g_glce_m.glcecnfid, 
       g_glce_m.glcecnfdt,g_glce_m.glceld_desc,g_glce_m.glcecomp_desc,g_glce_m.glce003_desc,g_glce_m.glceownid_desc, 
       g_glce_m.glceowndp_desc,g_glce_m.glcecrtid_desc,g_glce_m.glcecrtdp_desc,g_glce_m.glcemodid_desc, 
       g_glce_m.glcecnfid_desc
   
   #遮罩相關處理
   LET g_glce_m_mask_o.* =  g_glce_m.*
   CALL aglt420_glce_t_mask()
   LET g_glce_m_mask_n.* =  g_glce_m.*
   
   #根據資料狀態切換action狀態
   CALL cl_set_act_visible("statechange,modify,modify_detail,delete,reproduce", TRUE)
   CALL aglt420_set_act_visible()   
   CALL aglt420_set_act_no_visible()
   
   #add-point:fetch段action控制
   {<point name="fetch.action_control"/>}
   #end add-point  
   
   
   
   #add-point:fetch結束前
   {<point name="fetch.after" />}
   #end add-point
   
   #保存單頭舊值
   LET g_glce_m_t.* = g_glce_m.*
   LET g_glce_m_o.* = g_glce_m.*
   
   LET g_data_owner = g_glce_m.glceownid      
   LET g_data_dept  = g_glce_m.glceowndp
   
   #重新顯示   
   CALL aglt420_show()
 
   
 
END FUNCTION
]]>
  </section>
  <section id="aglt420.fill_chk" ver="4" status="" src="s" readonly="">
    <![CDATA[#+ 單身填充確認
PRIVATE FUNCTION aglt420_fill_chk(ps_idx)
   DEFINE ps_idx        LIKE type_t.chr10
   #add-point:fill_chk段define
   {<point name="fill_chk.define" edit="s"/>}
   #end add-point
   #add-point:fill_chk段define(客製用)
   {<point name="fill_chk.define_customerization" edit="c"/>}
   #end add-point
   
   #add-point:fill_chk段before_chk
   {<point name="fill_chk.before_chk"/>}
   #end add-point
   
   #此funtion功能暫時停用(2015/1/12)
   #無論傳入值為何皆回傳true(代表要填充該單身)
 
   #全部為1=1 or null時回傳true
   IF (cl_null(g_wc2_table1) OR g_wc2_table1.trim() = '1=1') THEN
      #add-point:fill_chk段other_chk
      {<point name="fill_chk.other_chk"/>}
      #end add-point
      RETURN TRUE
   END IF
   
   #add-point:fill_chk段after_chk
   {<point name="fill_chk.after_chk"/>}
   #end add-point
   
   RETURN TRUE
 
END FUNCTION
]]>
  </section>
  <section id="aglt420.global" ver="31" status="" src="s" readonly="">
    <![CDATA[#應用 t01 樣板自動產生(Version:39)
{<point name="global.memo" />}
        
IMPORT os
IMPORT util
IMPORT FGL lib_cl_dlg
#add-point:增加匯入項目
{<point name="global.import" />}
#end add-point
 
SCHEMA ds 
 
GLOBALS "../../cfg/top_global.inc"
 
#add-point:增加匯入變數檔
{<point name="global.inc" />}
#end add-point
 
#單頭 type 宣告
PRIVATE type type_g_glce_m        RECORD
       glceld LIKE glce_t.glceld, 
   glceld_desc LIKE type_t.chr80, 
   glcecomp LIKE glce_t.glcecomp, 
   glcecomp_desc LIKE type_t.chr80, 
   glaa001 LIKE glaa_t.glaa001, 
   glaa016 LIKE glaa_t.glaa016, 
   glaa020 LIKE glaa_t.glaa020, 
   glce001 LIKE glce_t.glce001, 
   glce002 LIKE glce_t.glce002, 
   glce003 LIKE glce_t.glce003, 
   glce003_desc LIKE type_t.chr80, 
   glce004 LIKE glce_t.glce004, 
   glce006 LIKE glce_t.glce006, 
   glce006_desc LIKE type_t.chr80, 
   glce005 LIKE glce_t.glce005, 
   glcedocno LIKE glce_t.glcedocno, 
   glcestus LIKE glce_t.glcestus, 
   glceownid LIKE glce_t.glceownid, 
   glceownid_desc LIKE type_t.chr80, 
   glceowndp LIKE glce_t.glceowndp, 
   glceowndp_desc LIKE type_t.chr80, 
   glcecrtid LIKE glce_t.glcecrtid, 
   glcecrtid_desc LIKE type_t.chr80, 
   glcecrtdp LIKE glce_t.glcecrtdp, 
   glcecrtdp_desc LIKE type_t.chr80, 
   glcecrtdt LIKE glce_t.glcecrtdt, 
   glcemodid LIKE glce_t.glcemodid, 
   glcemodid_desc LIKE type_t.chr80, 
   glcemoddt LIKE glce_t.glcemoddt, 
   glcecnfid LIKE glce_t.glcecnfid, 
   glcecnfid_desc LIKE type_t.chr80, 
   glcecnfdt LIKE glce_t.glcecnfdt, 
   glcf023 LIKE glcf_t.glcf023, 
   glcf023_desc LIKE type_t.chr80, 
   glcf024 LIKE glcf_t.glcf024, 
   glcf024_desc LIKE type_t.chr80, 
   glcf025 LIKE glcf_t.glcf025, 
   glcf025_desc LIKE type_t.chr80, 
   glcf026 LIKE glcf_t.glcf026, 
   glcf026_desc LIKE type_t.chr80, 
   glcf027 LIKE glcf_t.glcf027, 
   glcf027_desc LIKE type_t.chr80, 
   glcf028 LIKE glcf_t.glcf028, 
   glcf028_desc LIKE type_t.chr80, 
   glcf029 LIKE glcf_t.glcf029, 
   glcf029_desc LIKE type_t.chr80, 
   glcf030 LIKE glcf_t.glcf030, 
   glcf030_desc LIKE type_t.chr80, 
   glcf031 LIKE glcf_t.glcf031, 
   glcf032 LIKE glcf_t.glcf032, 
   glcf032_desc LIKE type_t.chr80, 
   glcf033 LIKE glcf_t.glcf033, 
   glcf033_desc LIKE type_t.chr80, 
   glcf034 LIKE glcf_t.glcf034, 
   glcf034_desc LIKE type_t.chr80, 
   glcf035 LIKE glcf_t.glcf035, 
   glcf035_desc LIKE type_t.chr80, 
   glcf036 LIKE glcf_t.glcf036, 
   glcf036_desc LIKE type_t.chr80, 
   glcf037 LIKE glcf_t.glcf037, 
   glcf038 LIKE glcf_t.glcf038, 
   glcf039 LIKE glcf_t.glcf039, 
   glcf040 LIKE glcf_t.glcf040, 
   glcf041 LIKE glcf_t.glcf041, 
   glcf042 LIKE glcf_t.glcf042, 
   glcf043 LIKE glcf_t.glcf043, 
   glcf044 LIKE glcf_t.glcf044, 
   glcf045 LIKE glcf_t.glcf045, 
   glcf046 LIKE glcf_t.glcf046
       END RECORD
 
#單身 type 宣告
PRIVATE TYPE type_g_glcf_d        RECORD
       glcf003 LIKE glcf_t.glcf003, 
   glcf003_desc LIKE type_t.chr500, 
   glcf004 LIKE glcf_t.glcf004, 
   glcf005 LIKE glcf_t.glcf005, 
   glcf006 LIKE glcf_t.glcf006, 
   glcf007 LIKE glcf_t.glcf007, 
   glcf008 LIKE glcf_t.glcf008, 
   glcf009 LIKE glcf_t.glcf009, 
   glcf010 LIKE glcf_t.glcf010, 
   glcf011 LIKE glcf_t.glcf011, 
   glcf012 LIKE glcf_t.glcf012, 
   glcf073 LIKE glcf_t.glcf073, 
   edit1 LIKE type_t.chr500
       END RECORD
PRIVATE TYPE type_g_glcf2_d RECORD
       glcf003 LIKE glcf_t.glcf003, 
   glcf003_2_desc LIKE type_t.chr500, 
   glcf004 LIKE glcf_t.glcf004, 
   glcf005 LIKE glcf_t.glcf005, 
   glcf013 LIKE glcf_t.glcf013, 
   glcf014 LIKE glcf_t.glcf014, 
   glcf015 LIKE glcf_t.glcf015, 
   glcf016 LIKE glcf_t.glcf016, 
   glcf017 LIKE glcf_t.glcf017, 
   edit2 LIKE type_t.chr500
       END RECORD
PRIVATE TYPE type_g_glcf3_d RECORD
       glcf003 LIKE glcf_t.glcf003, 
   glcf003_3_desc LIKE type_t.chr500, 
   glcf004 LIKE glcf_t.glcf004, 
   glcf005 LIKE glcf_t.glcf005, 
   glcf018 LIKE glcf_t.glcf018, 
   glcf019 LIKE glcf_t.glcf019, 
   glcf020 LIKE glcf_t.glcf020, 
   glcf021 LIKE glcf_t.glcf021, 
   glcf022 LIKE glcf_t.glcf022, 
   edit3 LIKE type_t.chr500
       END RECORD
PRIVATE TYPE type_g_glcf4_d RECORD
       glcf003 LIKE glcf_t.glcf003, 
   glcf003_4_desc LIKE type_t.chr500, 
   glcf004 LIKE glcf_t.glcf004, 
   glcf005 LIKE glcf_t.glcf005, 
   glcf047 LIKE glcf_t.glcf047, 
   glcf047_desc LIKE type_t.chr500, 
   glcf048 LIKE glcf_t.glcf048, 
   glcf048_desc LIKE type_t.chr500, 
   glcf049 LIKE glcf_t.glcf049, 
   glcf049_desc LIKE type_t.chr500, 
   glcf050 LIKE glcf_t.glcf050, 
   glcf050_desc LIKE type_t.chr500, 
   glcf051 LIKE glcf_t.glcf051, 
   glcf051_desc LIKE type_t.chr500, 
   glcf052 LIKE glcf_t.glcf052, 
   glcf052_desc LIKE type_t.chr500, 
   glcf053 LIKE glcf_t.glcf053, 
   glcf053_desc LIKE type_t.chr500, 
   glcf054 LIKE glcf_t.glcf054, 
   glcf054_desc LIKE type_t.chr500, 
   glcf055 LIKE glcf_t.glcf055, 
   glcf055_desc LIKE type_t.chr500, 
   glcf056 LIKE glcf_t.glcf056, 
   glcf057 LIKE glcf_t.glcf057, 
   glcf057_desc LIKE type_t.chr500, 
   glcf058 LIKE glcf_t.glcf058, 
   glcf058_desc LIKE type_t.chr500, 
   glcf059 LIKE glcf_t.glcf059, 
   glcf059_desc LIKE type_t.chr500, 
   glcf060 LIKE glcf_t.glcf060, 
   glcf060_desc LIKE type_t.chr500, 
   glcf061 LIKE glcf_t.glcf061, 
   glcf061_desc LIKE type_t.chr500, 
   glcf062 LIKE glcf_t.glcf062, 
   glcf062_desc LIKE type_t.chr500, 
   glcf063 LIKE glcf_t.glcf063, 
   glcf063_desc LIKE type_t.chr500, 
   glcf064 LIKE glcf_t.glcf064, 
   glcf064_desc LIKE type_t.chr500, 
   glcf065 LIKE glcf_t.glcf065, 
   glcf065_desc LIKE type_t.chr500, 
   glcf066 LIKE glcf_t.glcf066, 
   glcf066_desc LIKE type_t.chr500, 
   glcf067 LIKE glcf_t.glcf067, 
   glcf067_desc LIKE type_t.chr500, 
   glcf068 LIKE glcf_t.glcf068, 
   glcf068_desc LIKE type_t.chr500, 
   glcf069 LIKE glcf_t.glcf069, 
   glcf069_desc LIKE type_t.chr500, 
   glcf070 LIKE glcf_t.glcf070, 
   glcf070_desc LIKE type_t.chr500, 
   glcf071 LIKE glcf_t.glcf071, 
   glcf071_desc LIKE type_t.chr500, 
   glcf072 LIKE glcf_t.glcf072, 
   edit4 LIKE type_t.chr500
       END RECORD
 
 
PRIVATE TYPE type_browser RECORD
         b_statepic     LIKE type_t.chr50,
            b_glceld LIKE glce_t.glceld,
      b_glce001 LIKE glce_t.glce001,
      b_glce002 LIKE glce_t.glce002
       END RECORD
       
#模組變數(Module Variables)
DEFINE g_glce_m          type_g_glce_m
DEFINE g_glce_m_t        type_g_glce_m
DEFINE g_glce_m_o        type_g_glce_m
DEFINE g_glce_m_mask_o   type_g_glce_m #轉換遮罩前資料
DEFINE g_glce_m_mask_n   type_g_glce_m #轉換遮罩後資料
 
   DEFINE g_glceld_t LIKE glce_t.glceld
DEFINE g_glce001_t LIKE glce_t.glce001
DEFINE g_glce002_t LIKE glce_t.glce002
 
 
DEFINE g_glcf_d          DYNAMIC ARRAY OF type_g_glcf_d
DEFINE g_glcf_d_t        type_g_glcf_d
DEFINE g_glcf_d_o        type_g_glcf_d
DEFINE g_glcf_d_mask_o   DYNAMIC ARRAY OF type_g_glcf_d #轉換遮罩前資料
DEFINE g_glcf_d_mask_n   DYNAMIC ARRAY OF type_g_glcf_d #轉換遮罩後資料
DEFINE g_glcf2_d          DYNAMIC ARRAY OF type_g_glcf2_d
DEFINE g_glcf2_d_t        type_g_glcf2_d
DEFINE g_glcf2_d_o        type_g_glcf2_d
DEFINE g_glcf2_d_mask_o   DYNAMIC ARRAY OF type_g_glcf2_d #轉換遮罩前資料
DEFINE g_glcf2_d_mask_n   DYNAMIC ARRAY OF type_g_glcf2_d #轉換遮罩後資料
DEFINE g_glcf3_d          DYNAMIC ARRAY OF type_g_glcf3_d
DEFINE g_glcf3_d_t        type_g_glcf3_d
DEFINE g_glcf3_d_o        type_g_glcf3_d
DEFINE g_glcf3_d_mask_o   DYNAMIC ARRAY OF type_g_glcf3_d #轉換遮罩前資料
DEFINE g_glcf3_d_mask_n   DYNAMIC ARRAY OF type_g_glcf3_d #轉換遮罩後資料
DEFINE g_glcf4_d          DYNAMIC ARRAY OF type_g_glcf4_d
DEFINE g_glcf4_d_t        type_g_glcf4_d
DEFINE g_glcf4_d_o        type_g_glcf4_d
DEFINE g_glcf4_d_mask_o   DYNAMIC ARRAY OF type_g_glcf4_d #轉換遮罩前資料
DEFINE g_glcf4_d_mask_n   DYNAMIC ARRAY OF type_g_glcf4_d #轉換遮罩後資料
 
 
DEFINE g_browser         DYNAMIC ARRAY OF type_browser
DEFINE g_browser_f       DYNAMIC ARRAY OF type_browser
 
 
DEFINE g_wc                  STRING
DEFINE g_wc_t                STRING
DEFINE g_wc2                 STRING                          #單身CONSTRUCT結果
DEFINE g_wc2_table1          STRING
 
 
DEFINE g_wc2_extend          STRING
DEFINE g_wc_filter           STRING
DEFINE g_wc_filter_t         STRING
 
DEFINE g_sql                 STRING
DEFINE g_forupd_sql          STRING
DEFINE g_cnt                 LIKE type_t.num10
DEFINE g_current_idx         LIKE type_t.num10     
DEFINE g_jump                LIKE type_t.num10        
DEFINE g_no_ask              LIKE type_t.num5        
DEFINE g_rec_b               LIKE type_t.num10           
DEFINE l_ac                  LIKE type_t.num10    
DEFINE g_curr_diag           ui.Dialog                     #Current Dialog
    
DEFINE g_pagestart           LIKE type_t.num10           
DEFINE gwin_curr             ui.Window                     #Current Window
DEFINE gfrm_curr             ui.Form                       #Current Form
DEFINE g_page_action         STRING                        #page action
DEFINE g_header_hidden       LIKE type_t.num5              #隱藏單頭
DEFINE g_worksheet_hidden    LIKE type_t.num5              #隱藏工作Panel
DEFINE g_page                STRING                        #第幾頁
DEFINE g_state               STRING       
DEFINE g_header_cnt          LIKE type_t.num10
DEFINE g_detail_cnt          LIKE type_t.num10              #單身總筆數
DEFINE g_detail_idx          LIKE type_t.num10              #單身目前所在筆數
DEFINE g_detail_idx2         LIKE type_t.num10              #單身2目前所在筆數
DEFINE g_browser_cnt         LIKE type_t.num10              #Browser總筆數
DEFINE g_browser_idx         LIKE type_t.num10              #Browser目前所在筆數
DEFINE g_temp_idx            LIKE type_t.num10              #Browser目前所在筆數(暫存用)
DEFINE g_order               STRING                        #查詢排序欄位
                                                        
DEFINE g_current_row         LIKE type_t.num10              #Browser所在筆數
DEFINE g_current_sw          BOOLEAN                       #Browser所在筆數用開關
DEFINE g_current_page        LIKE type_t.num10              #目前所在頁數
DEFINE g_insert              LIKE type_t.chr5              #是否導到其他page
 
DEFINE g_ref_fields          DYNAMIC ARRAY OF VARCHAR(500) #ap_ref用陣列
DEFINE g_ref_vars            DYNAMIC ARRAY OF VARCHAR(500) #ap_ref用陣列
DEFINE g_rtn_fields          DYNAMIC ARRAY OF VARCHAR(500) #ap_ref用陣列
DEFINE gs_keys               DYNAMIC ARRAY OF VARCHAR(500) #同步資料用陣列
DEFINE gs_keys_bak           DYNAMIC ARRAY OF VARCHAR(500) #同步資料用陣列
DEFINE g_bfill               LIKE type_t.chr5              #是否刷新單身
DEFINE g_error_show          LIKE type_t.num5              #是否顯示筆數提示訊息
DEFINE g_master_insert       BOOLEAN                       #確認單頭資料是否寫入
 
DEFINE g_wc_frozen           STRING                        #凍結欄位使用
DEFINE g_chk                 BOOLEAN                       #助記碼判斷用
DEFINE g_aw                  STRING                        #確定當下點擊的單身
DEFINE g_default             BOOLEAN                       #是否有外部參數查詢
DEFINE g_log1                STRING                        #log用
DEFINE g_log2                STRING                        #log用
DEFINE g_loc                 LIKE type_t.chr5              #判斷游標所在位置
DEFINE g_add_browse          STRING                        #新增填充用WC
DEFINE g_update              BOOLEAN                       #確定單頭/身是否異動過
 
#add-point:自定義模組變數(Module Variable)
{<point name="global.variable" edit="s"/>}
#end add-point
 
#add-point:自定義客戶專用模組變數(Module Variable)
{<point name="global.variable_customerization" edit="c"/>}
#end add-point
 
#add-point:傳入參數說明(global.argv)
{<point name="global.argv"/>}
#end add-point
]]>
  </section>
  <section id="aglt420.idx_chk" ver="3" status="" src="s" readonly="">
    <![CDATA[#+ 顯示正確的單身資料筆數
PRIVATE FUNCTION aglt420_idx_chk()
   #add-point:idx_chk段define
   {<point name="idx_chk.define" edit="s"/>}
   #end add-point  
   #add-point:idx_chk段define(客製用)
   {<point name="idx_chk.define_customerization" edit="c"/>}
   #end add-point  
   
   IF g_current_page = 1 THEN
      LET g_detail_idx = g_curr_diag.getCurrentRow("s_detail1")
      IF g_detail_idx > g_glcf_d.getLength() THEN
         LET g_detail_idx = g_glcf_d.getLength()
      END IF
      IF g_detail_idx = 0 AND g_glcf_d.getLength() <> 0 THEN
         LET g_detail_idx = 1
      END IF
      DISPLAY g_detail_idx TO FORMONLY.idx
      DISPLAY g_glcf_d.getLength() TO FORMONLY.cnt
   END IF
   
   IF g_current_page = 2 THEN
      LET g_detail_idx = g_curr_diag.getCurrentRow("s_detail2")
      IF g_detail_idx > g_glcf2_d.getLength() THEN
         LET g_detail_idx = g_glcf2_d.getLength()
      END IF
      IF g_detail_idx = 0 AND g_glcf2_d.getLength() <> 0 THEN
         LET g_detail_idx = 1
      END IF
      DISPLAY g_detail_idx TO FORMONLY.idx
      DISPLAY g_glcf2_d.getLength() TO FORMONLY.cnt
   END IF
   IF g_current_page = 3 THEN
      LET g_detail_idx = g_curr_diag.getCurrentRow("s_detail3")
      IF g_detail_idx > g_glcf3_d.getLength() THEN
         LET g_detail_idx = g_glcf3_d.getLength()
      END IF
      IF g_detail_idx = 0 AND g_glcf3_d.getLength() <> 0 THEN
         LET g_detail_idx = 1
      END IF
      DISPLAY g_detail_idx TO FORMONLY.idx
      DISPLAY g_glcf3_d.getLength() TO FORMONLY.cnt
   END IF
   IF g_current_page = 4 THEN
      LET g_detail_idx = g_curr_diag.getCurrentRow("s_detail4")
      IF g_detail_idx > g_glcf4_d.getLength() THEN
         LET g_detail_idx = g_glcf4_d.getLength()
      END IF
      IF g_detail_idx = 0 AND g_glcf4_d.getLength() <> 0 THEN
         LET g_detail_idx = 1
      END IF
      DISPLAY g_detail_idx TO FORMONLY.idx
      DISPLAY g_glcf4_d.getLength() TO FORMONLY.cnt
   END IF
 
   
   #add-point:idx_chk段other
   {<point name="idx_chk.other"/>}
   #end add-point  
   
END FUNCTION
]]>
  </section>
  <section id="aglt420.init" ver="6" status="" src="s" readonly="">
    <![CDATA[#+ 瀏覽頁簽資料初始化
PRIVATE FUNCTION aglt420_init()
   #add-point:init段define
   {<point name="init.define" edit="s"/>}
   #end add-point    
   #add-point:init段define(客製用)
   {<point name="init.define_customerization" edit="c"/>}
   #end add-point    
 
   LET g_bfill       = "Y"
   LET g_detail_idx  = 1 #第一層單身指標
   LET g_detail_idx2 = 1 #第二層單身指標
   LET g_error_show  = 1
   LET l_ac = 1 #單身指標
      CALL cl_set_combo_scc_part('glcestus','13','N,Y,X')
 
   
   LET gwin_curr = ui.Window.getCurrent()  #取得現行畫面
   LET gfrm_curr = gwin_curr.getForm()     #取出物件化後的畫面物件
 
   #add-point:畫面資料初始化
   {<point name="init.init"/>}
   #end add-point
   
   #初始化搜尋條件
   CALL aglt420_default_search()
    
END FUNCTION
]]>
  </section>
  <section id="aglt420.input" ver="12" status="" src="s" readonly="">
    <![CDATA[#+ 資料輸入
PRIVATE FUNCTION aglt420_input(p_cmd)
   DEFINE  p_cmd                 LIKE type_t.chr1
   DEFINE  l_cmd_t               LIKE type_t.chr1
   DEFINE  l_cmd                 LIKE type_t.chr1
   DEFINE  l_n                   LIKE type_t.num10                #檢查重複用  
   DEFINE  l_cnt                 LIKE type_t.num10                #檢查重複用  
   DEFINE  l_lock_sw             LIKE type_t.chr1                #單身鎖住否  
   DEFINE  l_allow_insert        LIKE type_t.num5                #可新增否 
   DEFINE  l_allow_delete        LIKE type_t.num5                #可刪除否  
   DEFINE  l_count               LIKE type_t.num10
   DEFINE  l_i                   LIKE type_t.num10
   DEFINE  l_insert              BOOLEAN
   DEFINE  ls_return             STRING
   DEFINE  l_var_keys            DYNAMIC ARRAY OF STRING
   DEFINE  l_field_keys          DYNAMIC ARRAY OF STRING
   DEFINE  l_vars                DYNAMIC ARRAY OF STRING
   DEFINE  l_fields              DYNAMIC ARRAY OF STRING
   DEFINE  l_var_keys_bak        DYNAMIC ARRAY OF STRING
   DEFINE  lb_reproduce          BOOLEAN
   DEFINE  li_reproduce          LIKE type_t.num10
   DEFINE  li_reproduce_target   LIKE type_t.num10
   DEFINE  ls_keys               DYNAMIC ARRAY OF VARCHAR(500)
   #add-point:input段define
   {<point name="input.define" edit="s"/>}
   #end add-point  
   #add-point:input段define(客製用)
   {<point name="input.define_customerization" edit="c"/>}
   #end add-point  
   
   #先做狀態判定
   IF p_cmd = 'r' THEN
      LET l_cmd_t = 'r'
      LET p_cmd   = 'a'
   ELSE
      LET l_cmd_t = p_cmd
   END IF   
   
   #將資料輸出到畫面上
   DISPLAY BY NAME g_glce_m.glceld,g_glce_m.glceld_desc,g_glce_m.glcecomp,g_glce_m.glcecomp_desc,g_glce_m.glaa001, 
       g_glce_m.glaa016,g_glce_m.glaa020,g_glce_m.glce001,g_glce_m.glce002,g_glce_m.glce003,g_glce_m.glce003_desc, 
       g_glce_m.glce004,g_glce_m.glce006,g_glce_m.glce006_desc,g_glce_m.glce005,g_glce_m.glcedocno,g_glce_m.glcestus, 
       g_glce_m.glceownid,g_glce_m.glceownid_desc,g_glce_m.glceowndp,g_glce_m.glceowndp_desc,g_glce_m.glcecrtid, 
       g_glce_m.glcecrtid_desc,g_glce_m.glcecrtdp,g_glce_m.glcecrtdp_desc,g_glce_m.glcecrtdt,g_glce_m.glcemodid, 
       g_glce_m.glcemodid_desc,g_glce_m.glcemoddt,g_glce_m.glcecnfid,g_glce_m.glcecnfid_desc,g_glce_m.glcecnfdt, 
       g_glce_m.glcf023,g_glce_m.glcf023_desc,g_glce_m.glcf024,g_glce_m.glcf024_desc,g_glce_m.glcf025, 
       g_glce_m.glcf025_desc,g_glce_m.glcf026,g_glce_m.glcf026_desc,g_glce_m.glcf027,g_glce_m.glcf027_desc, 
       g_glce_m.glcf028,g_glce_m.glcf028_desc,g_glce_m.glcf029,g_glce_m.glcf029_desc,g_glce_m.glcf030, 
       g_glce_m.glcf030_desc,g_glce_m.glcf031,g_glce_m.glcf032,g_glce_m.glcf032_desc,g_glce_m.glcf033, 
       g_glce_m.glcf033_desc,g_glce_m.glcf034,g_glce_m.glcf034_desc,g_glce_m.glcf035,g_glce_m.glcf035_desc, 
       g_glce_m.glcf036,g_glce_m.glcf036_desc,g_glce_m.glcf037,g_glce_m.glcf038,g_glce_m.glcf039,g_glce_m.glcf040, 
       g_glce_m.glcf041,g_glce_m.glcf042,g_glce_m.glcf043,g_glce_m.glcf044,g_glce_m.glcf045,g_glce_m.glcf046 

   
   #切換畫面
 
   CALL cl_set_head_visible("","YES")  
 
   LET l_insert = FALSE
   LET g_action_choice = ""
 
   #add-point:input段define_sql
   {<point name="input.define_sql" mark="Y"/>}
   #end add-point 
   LET g_forupd_sql = "SELECT glcf003,glcf004,glcf005,glcf006,glcf007,glcf008,glcf009,glcf010,glcf011, 
       glcf012,glcf073,glcf003,glcf004,glcf005,glcf013,glcf014,glcf015,glcf016,glcf017,glcf003,glcf004, 
       glcf005,glcf018,glcf019,glcf020,glcf021,glcf022,glcf003,glcf004,glcf005,glcf047,glcf048,glcf049, 
       glcf050,glcf051,glcf052,glcf053,glcf054,glcf055,glcf056,glcf057,glcf058,glcf059,glcf060,glcf061, 
       glcf062,glcf063,glcf064,glcf065,glcf066,glcf067,glcf068,glcf069,glcf070,glcf071,glcf072 FROM  
       glcf_t WHERE glcfent=? AND glcfld=? AND glcf001=? AND glcf002=? AND glcf003=? AND glcf004=? AND  
       glcf005=? FOR UPDATE"
   #add-point:input段define_sql
   {<point name="input.after_define_sql"/>}
   #end add-point 
   LET g_forupd_sql = cl_sql_forupd(g_forupd_sql)
   LET g_forupd_sql = cl_sql_add_mask(g_forupd_sql)              #遮蔽特定資料
   DECLARE aglt420_bcl CURSOR FROM g_forupd_sql
   
 
   
 
 
   #add-point:input段define_sql
   {<point name="input.other_sql"/>}
   #end add-point 
 
   LET l_allow_insert = cl_auth_detail_input("insert")
   LET l_allow_delete = cl_auth_detail_input("delete")
   LET g_qryparam.state = 'i'
   
   #控制key欄位可否輸入
   CALL aglt420_set_entry(p_cmd)
   #add-point:set_entry後
   {<point name="input.after_set_entry"/>}
   #end add-point
   CALL aglt420_set_no_entry(p_cmd)
 
   DISPLAY BY NAME g_glce_m.glceld,g_glce_m.glce001,g_glce_m.glce002,g_glce_m.glce003,g_glce_m.glce004, 
       g_glce_m.glce006,g_glce_m.glce005,g_glce_m.glcedocno,g_glce_m.glcestus
   
   LET lb_reproduce = FALSE
   
   #關閉被遮罩相關欄位輸入, 無法確定USER是否會需要輸入此欄位
   #因此先行關閉, 若有需要可於下方add-point中自行開啟
   CALL cl_mask_set_no_entry()
   
   #add-point:資料輸入前
   {<point name="input.before_input"/>}
   #end add-point
   
   DIALOG ATTRIBUTES(UNBUFFERED,FIELD ORDER FORM)
]]>
  </section>
  <section id="aglt420.input.body" ver="17" status="" src="s" readonly="">
    <![CDATA[   
      #Page1 預設值產生於此處
      INPUT ARRAY g_glcf_d FROM s_detail1.*
          ATTRIBUTE(COUNT = g_rec_b,WITHOUT DEFAULTS, #MAXCOUNT = g_max_rec,
                  INSERT ROW = FALSE, 
                  DELETE ROW = FALSE,
                  APPEND ROW = FALSE)
 
         #自訂ACTION(detail_input,page_1)
         
         
         BEFORE INPUT
            #add-point:資料輸入前
            {<point name="input.body.before_input2"/>}
            #end add-point
            IF g_insert = 'Y' AND NOT cl_null(g_insert) THEN 
              CALL FGL_SET_ARR_CURR(g_glcf_d.getLength()+1) 
              LET g_insert = 'N' 
           END IF 
 
            CALL aglt420_b_fill()
            #如果一直都在單身1則控制筆數位置
            IF g_loc = 'm' AND g_rec_b != 0 THEN
               CALL FGL_SET_ARR_CURR(g_detail_idx)
            END IF
            LET g_loc = 'm'
            LET g_rec_b = g_glcf_d.getLength()
            #add-point:資料輸入前
            {<point name="input.d.before_input"/>}
            #end add-point
         
         BEFORE ROW
            #add-point:modify段before row2
            {<point name="input.body.before_row2"/>}
            #end add-point  
            LET l_insert = FALSE
            LET l_cmd = ''
            LET l_ac = ARR_CURR()
            LET g_detail_idx = l_ac
            LET g_current_page = 1
            
            LET l_lock_sw = 'N'            #DEFAULT
            LET l_n = ARR_COUNT()
            DISPLAY l_ac TO FORMONLY.idx
         
            CALL s_transaction_begin()
            OPEN aglt420_cl USING g_enterprise,g_glce_m.glceld,g_glce_m.glce001,g_glce_m.glce002
            IF STATUS THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = "OPEN aglt420_cl:" 
               LET g_errparam.code   = STATUS 
               LET g_errparam.popup  = TRUE 
               CALL cl_err()
               CLOSE aglt420_cl
               CALL s_transaction_end('N','0')
               RETURN
            END IF
            
            LET g_rec_b = g_glcf_d.getLength()
            
            IF g_rec_b >= l_ac 
               AND g_glcf_d[l_ac].glcf003 IS NOT NULL
               AND g_glcf_d[l_ac].glcf004 IS NOT NULL
               AND g_glcf_d[l_ac].glcf005 IS NOT NULL
 
            THEN
               LET l_cmd='u'
               LET g_glcf_d_t.* = g_glcf_d[l_ac].*  #BACKUP
               LET g_glcf_d_o.* = g_glcf_d[l_ac].*  #BACKUP
               CALL aglt420_set_entry_b(l_cmd)
               #add-point:modify段after_set_entry_b
               {<point name="input.body.after_set_entry_b"/>}
               #end add-point  
               CALL aglt420_set_no_entry_b(l_cmd)
               IF NOT aglt420_lock_b("glcf_t","'1'") THEN
                  LET l_lock_sw='Y'
               ELSE
                  FETCH aglt420_bcl INTO g_glcf_d[l_ac].glcf003,g_glcf_d[l_ac].glcf004,g_glcf_d[l_ac].glcf005, 
                      g_glcf_d[l_ac].glcf006,g_glcf_d[l_ac].glcf007,g_glcf_d[l_ac].glcf008,g_glcf_d[l_ac].glcf009, 
                      g_glcf_d[l_ac].glcf010,g_glcf_d[l_ac].glcf011,g_glcf_d[l_ac].glcf012,g_glcf_d[l_ac].glcf073, 
                      g_glcf2_d[l_ac].glcf003,g_glcf2_d[l_ac].glcf004,g_glcf2_d[l_ac].glcf005,g_glcf2_d[l_ac].glcf013, 
                      g_glcf2_d[l_ac].glcf014,g_glcf2_d[l_ac].glcf015,g_glcf2_d[l_ac].glcf016,g_glcf2_d[l_ac].glcf017, 
                      g_glcf3_d[l_ac].glcf003,g_glcf3_d[l_ac].glcf004,g_glcf3_d[l_ac].glcf005,g_glcf3_d[l_ac].glcf018, 
                      g_glcf3_d[l_ac].glcf019,g_glcf3_d[l_ac].glcf020,g_glcf3_d[l_ac].glcf021,g_glcf3_d[l_ac].glcf022, 
                      g_glcf4_d[l_ac].glcf003,g_glcf4_d[l_ac].glcf004,g_glcf4_d[l_ac].glcf005,g_glcf4_d[l_ac].glcf047, 
                      g_glcf4_d[l_ac].glcf048,g_glcf4_d[l_ac].glcf049,g_glcf4_d[l_ac].glcf050,g_glcf4_d[l_ac].glcf051, 
                      g_glcf4_d[l_ac].glcf052,g_glcf4_d[l_ac].glcf053,g_glcf4_d[l_ac].glcf054,g_glcf4_d[l_ac].glcf055, 
                      g_glcf4_d[l_ac].glcf056,g_glcf4_d[l_ac].glcf057,g_glcf4_d[l_ac].glcf058,g_glcf4_d[l_ac].glcf059, 
                      g_glcf4_d[l_ac].glcf060,g_glcf4_d[l_ac].glcf061,g_glcf4_d[l_ac].glcf062,g_glcf4_d[l_ac].glcf063, 
                      g_glcf4_d[l_ac].glcf064,g_glcf4_d[l_ac].glcf065,g_glcf4_d[l_ac].glcf066,g_glcf4_d[l_ac].glcf067, 
                      g_glcf4_d[l_ac].glcf068,g_glcf4_d[l_ac].glcf069,g_glcf4_d[l_ac].glcf070,g_glcf4_d[l_ac].glcf071, 
                      g_glcf4_d[l_ac].glcf072
                  IF SQLCA.sqlcode THEN
                     INITIALIZE g_errparam TO NULL 
                     LET g_errparam.extend = g_glcf_d_t.glcf003 
                     LET g_errparam.code   = SQLCA.sqlcode 
                     LET g_errparam.popup  = TRUE 
                     CALL cl_err()
                     LET l_lock_sw = "Y"
                  END IF
                  
                  #遮罩相關處理
                  LET g_glcf_d_mask_o[l_ac].* =  g_glcf_d[l_ac].*
                  CALL aglt420_glcf_t_mask()
                  LET g_glcf_d_mask_n[l_ac].* =  g_glcf_d[l_ac].*
                  
                  LET g_bfill = "N"
                  CALL aglt420_show()
                  LET g_bfill = "Y"
                  
                  CALL cl_show_fld_cont()
               END IF
            ELSE
               LET l_cmd='a'
            END IF
            #add-point:modify段before row
            {<point name="input.body.before_row"/>}
            #end add-point  
            #其他table資料備份(確定是否更改用)
            
            #其他table進行lock
            
        
         BEFORE INSERT
            
            LET l_insert = TRUE
            LET l_n = ARR_COUNT()
            LET l_cmd = 'a'
            INITIALIZE g_glcf_d[l_ac].* TO NULL 
            INITIALIZE g_glcf_d_t.* TO NULL 
            INITIALIZE g_glcf_d_o.* TO NULL 
            #公用欄位給值(單身)
            
            #自定義預設值
            
            #add-point:modify段before備份
            {<point name="input.body.insert.before_bak"/>}
            #end add-point
            LET g_glcf_d_t.* = g_glcf_d[l_ac].*     #新輸入資料
            LET g_glcf_d_o.* = g_glcf_d[l_ac].*     #新輸入資料
            CALL cl_show_fld_cont()
            CALL aglt420_set_entry_b(l_cmd)
            #add-point:modify段after_set_entry_b
            {<point name="input.body.insert.after_set_entry_b"/>}
            #end add-point
            CALL aglt420_set_no_entry_b(l_cmd)
            IF lb_reproduce THEN
               LET lb_reproduce = FALSE
               LET g_glcf_d[li_reproduce_target].* = g_glcf_d[li_reproduce].*
               LET g_glcf2_d[li_reproduce_target].* = g_glcf2_d[li_reproduce].*
               LET g_glcf3_d[li_reproduce_target].* = g_glcf3_d[li_reproduce].*
               LET g_glcf4_d[li_reproduce_target].* = g_glcf4_d[li_reproduce].*
 
               LET g_glcf_d[li_reproduce_target].glcf003 = NULL
               LET g_glcf_d[li_reproduce_target].glcf004 = NULL
               LET g_glcf_d[li_reproduce_target].glcf005 = NULL
 
            END IF
            
            #add-point:modify段before insert
            {<point name="input.body.before_insert"/>}
            #end add-point  
  
         AFTER INSERT
            LET l_insert = FALSE
            IF INT_FLAG THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = '' 
               LET g_errparam.code   = 9001 
               LET g_errparam.popup  = FALSE 
               CALL cl_err()
               LET INT_FLAG = 0
               CANCEL INSERT
            END IF
               
            #add-point:單身新增
            {<point name="input.body.b_a_insert"/>}
            #end add-point
               
            LET l_count = 1  
            SELECT COUNT(*) INTO l_count FROM glcf_t 
             WHERE glcfent = g_enterprise AND glcfld = g_glce_m.glceld
               AND glcf001 = g_glce_m.glce001
               AND glcf002 = g_glce_m.glce002
 
               AND glcf003 = g_glcf_d[l_ac].glcf003
               AND glcf004 = g_glcf_d[l_ac].glcf004
               AND glcf005 = g_glcf_d[l_ac].glcf005
 
                
            #資料未重複, 插入新增資料
            IF l_count = 0 THEN 
               #add-point:單身新增前
               {<point name="input.body.b_insert"/>}
               #end add-point
            
               #同步新增到同層的table
                              INITIALIZE gs_keys TO NULL 
               LET gs_keys[1] = g_glce_m.glceld
               LET gs_keys[2] = g_glce_m.glce001
               LET gs_keys[3] = g_glce_m.glce002
               LET gs_keys[4] = g_glcf_d[g_detail_idx].glcf003
               LET gs_keys[5] = g_glcf_d[g_detail_idx].glcf004
               LET gs_keys[6] = g_glcf_d[g_detail_idx].glcf005
               CALL aglt420_insert_b('glcf_t',gs_keys,"'1'")
                           
               #add-point:單身新增後
               {<point name="input.body.a_insert"/>}
               #end add-point
            ELSE    
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = 'INSERT' 
               LET g_errparam.code   = "std-00006" 
               LET g_errparam.popup  = TRUE 
               CALL cl_err()
               INITIALIZE g_glcf_d[l_ac].* TO NULL
               CALL s_transaction_end('N','0')
               CANCEL INSERT
            END IF
 
            IF SQLCA.SQLcode  THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = "glcf_t" 
               LET g_errparam.code   = SQLCA.sqlcode 
               LET g_errparam.popup  = TRUE 
               CALL cl_err()
               CALL s_transaction_end('N','0')                    
               CANCEL INSERT
            ELSE
               #先刷新資料
               #CALL aglt420_b_fill()
               #資料多語言用-增/改
               
               #add-point:input段-after_insert
               {<point name="input.body.a_insert2"/>}
               #end add-point
               CALL s_transaction_end('Y','0')
               #ERROR 'INSERT O.K'
               LET g_rec_b = g_rec_b + 1
            END IF
              
         BEFORE DELETE                            #是否取消單身
            IF l_cmd = 'a' THEN
               LET l_cmd='d'
               #add-point:單身刪除後(=d)
               {<point name="input.body.after_delete_d"/>}
               #end add-point
            ELSE
               IF NOT cl_ask_del_detail() THEN
                  CANCEL DELETE
               END IF
               IF l_lock_sw = "Y" THEN
                  INITIALIZE g_errparam TO NULL 
                  LET g_errparam.extend = "" 
                  LET g_errparam.code   = -263 
                  LET g_errparam.popup  = TRUE 
                  CALL cl_err()
                  CANCEL DELETE
               END IF
               
               #add-point:單身刪除前
               {<point name="input.body.b_delete" mark="Y"/>}
               #end add-point 
               
               #取得該筆資料key值
               INITIALIZE gs_keys TO NULL
               LET gs_keys[01] = g_glce_m.glceld
               LET gs_keys[gs_keys.getLength()+1] = g_glce_m.glce001
               LET gs_keys[gs_keys.getLength()+1] = g_glce_m.glce002
 
               LET gs_keys[gs_keys.getLength()+1] = g_glcf_d_t.glcf003
               LET gs_keys[gs_keys.getLength()+1] = g_glcf_d_t.glcf004
               LET gs_keys[gs_keys.getLength()+1] = g_glcf_d_t.glcf005
 
            
               #刪除同層單身
               IF NOT aglt420_delete_b('glcf_t',gs_keys,"'1'") THEN
                  CALL s_transaction_end('N','0')
                  CLOSE aglt420_bcl
                  CANCEL DELETE
               END IF
    
               #刪除下層單身
               IF NOT aglt420_key_delete_b(gs_keys,'glcf_t') THEN
                  CALL s_transaction_end('N','0')
                  CLOSE aglt420_bcl
                  CANCEL DELETE
               END IF
               
               #刪除多語言
               
               
               #add-point:單身刪除中
               {<point name="input.body.m_delete"/>}
               #end add-point 
               
               CALL s_transaction_end('Y','0')
               CLOSE aglt420_bcl
            
               LET g_rec_b = g_rec_b-1
               #add-point:單身刪除後
               {<point name="input.body.a_delete"/>}
               #end add-point
               LET l_count = g_glcf_d.getLength()
               
               #add-point:單身刪除後(<>d)
               {<point name="input.body.after_delete"/>}
               #end add-point
            END IF
 
         AFTER DELETE
            #如果是最後一筆
            IF l_ac = (g_glcf_d.getLength() + 1) THEN
               CALL FGL_SET_ARR_CURR(l_ac-1)
            END IF
 
                  #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf003
            #add-point:BEFORE FIELD glcf003
            {<point name="input.b.page1.glcf003" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf003
            
            #add-point:AFTER FIELD glcf003
            {<point name="input.a.page1.glcf003" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE glcf003
            #add-point:ON CHANGE glcf003
            {<point name="input.g.page1.glcf003" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf003_desc
            #add-point:BEFORE FIELD glcf003_desc
            {<point name="input.b.page1.glcf003_desc" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf003_desc
            
            #add-point:AFTER FIELD glcf003_desc
            {<point name="input.a.page1.glcf003_desc" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE glcf003_desc
            #add-point:ON CHANGE glcf003_desc
            {<point name="input.g.page1.glcf003_desc" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf004
            #add-point:BEFORE FIELD glcf004
            {<point name="input.b.page1.glcf004" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf004
            
            #add-point:AFTER FIELD glcf004
            {<point name="input.a.page1.glcf004" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE glcf004
            #add-point:ON CHANGE glcf004
            {<point name="input.g.page1.glcf004" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf005
            #add-point:BEFORE FIELD glcf005
            {<point name="input.b.page1.glcf005" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf005
            
            #add-point:AFTER FIELD glcf005
            {<point name="input.a.page1.glcf005" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE glcf005
            #add-point:ON CHANGE glcf005
            {<point name="input.g.page1.glcf005" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf006
            #add-point:BEFORE FIELD glcf006
            {<point name="input.b.page1.glcf006" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf006
            
            #add-point:AFTER FIELD glcf006
            {<point name="input.a.page1.glcf006" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE glcf006
            #add-point:ON CHANGE glcf006
            {<point name="input.g.page1.glcf006" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf007
            #add-point:BEFORE FIELD glcf007
            {<point name="input.b.page1.glcf007" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf007
            
            #add-point:AFTER FIELD glcf007
            {<point name="input.a.page1.glcf007" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE glcf007
            #add-point:ON CHANGE glcf007
            {<point name="input.g.page1.glcf007" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf008
            #add-point:BEFORE FIELD glcf008
            {<point name="input.b.page1.glcf008" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf008
            
            #add-point:AFTER FIELD glcf008
            {<point name="input.a.page1.glcf008" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE glcf008
            #add-point:ON CHANGE glcf008
            {<point name="input.g.page1.glcf008" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf009
            #add-point:BEFORE FIELD glcf009
            {<point name="input.b.page1.glcf009" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf009
            
            #add-point:AFTER FIELD glcf009
            {<point name="input.a.page1.glcf009" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE glcf009
            #add-point:ON CHANGE glcf009
            {<point name="input.g.page1.glcf009" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf010
            #add-point:BEFORE FIELD glcf010
            {<point name="input.b.page1.glcf010" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf010
            
            #add-point:AFTER FIELD glcf010
            {<point name="input.a.page1.glcf010" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE glcf010
            #add-point:ON CHANGE glcf010
            {<point name="input.g.page1.glcf010" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf011
            #add-point:BEFORE FIELD glcf011
            {<point name="input.b.page1.glcf011" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf011
            
            #add-point:AFTER FIELD glcf011
            {<point name="input.a.page1.glcf011" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE glcf011
            #add-point:ON CHANGE glcf011
            {<point name="input.g.page1.glcf011" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf012
            #add-point:BEFORE FIELD glcf012
            {<point name="input.b.page1.glcf012" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf012
            
            #add-point:AFTER FIELD glcf012
            {<point name="input.a.page1.glcf012" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE glcf012
            #add-point:ON CHANGE glcf012
            {<point name="input.g.page1.glcf012" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf073
            #add-point:BEFORE FIELD glcf073
            {<point name="input.b.page1.glcf073" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf073
            
            #add-point:AFTER FIELD glcf073
            {<point name="input.a.page1.glcf073" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE glcf073
            #add-point:ON CHANGE glcf073
            {<point name="input.g.page1.glcf073" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD edit1
            #add-point:BEFORE FIELD edit1
            {<point name="input.b.page1.edit1" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD edit1
            
            #add-point:AFTER FIELD edit1
            {<point name="input.a.page1.edit1" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE edit1
            #add-point:ON CHANGE edit1
            {<point name="input.g.page1.edit1" />}
            #END add-point 
 
 
                  #Ctrlp:input.c.page1.glcf003
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf003
            #add-point:ON ACTION controlp INFIELD glcf003
            {<point name="input.c.page1.glcf003" />}
            #END add-point
 
         #Ctrlp:input.c.page1.glcf003_desc
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf003_desc
            #add-point:ON ACTION controlp INFIELD glcf003_desc
            {<point name="input.c.page1.glcf003_desc" />}
            #END add-point
 
         #Ctrlp:input.c.page1.glcf004
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf004
            #add-point:ON ACTION controlp INFIELD glcf004
            {<point name="input.c.page1.glcf004" />}
            #END add-point
 
         #Ctrlp:input.c.page1.glcf005
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf005
            #add-point:ON ACTION controlp INFIELD glcf005
            {<point name="input.c.page1.glcf005" />}
            #END add-point
 
         #Ctrlp:input.c.page1.glcf006
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf006
            #add-point:ON ACTION controlp INFIELD glcf006
            {<point name="input.c.page1.glcf006" />}
            #END add-point
 
         #Ctrlp:input.c.page1.glcf007
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf007
            #add-point:ON ACTION controlp INFIELD glcf007
            {<point name="input.c.page1.glcf007" />}
            #END add-point
 
         #Ctrlp:input.c.page1.glcf008
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf008
            #add-point:ON ACTION controlp INFIELD glcf008
            {<point name="input.c.page1.glcf008" />}
            #END add-point
 
         #Ctrlp:input.c.page1.glcf009
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf009
            #add-point:ON ACTION controlp INFIELD glcf009
            {<point name="input.c.page1.glcf009" />}
            #END add-point
 
         #Ctrlp:input.c.page1.glcf010
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf010
            #add-point:ON ACTION controlp INFIELD glcf010
            {<point name="input.c.page1.glcf010" />}
            #END add-point
 
         #Ctrlp:input.c.page1.glcf011
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf011
            #add-point:ON ACTION controlp INFIELD glcf011
            {<point name="input.c.page1.glcf011" />}
            #END add-point
 
         #Ctrlp:input.c.page1.glcf012
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf012
            #add-point:ON ACTION controlp INFIELD glcf012
            {<point name="input.c.page1.glcf012" />}
            #END add-point
 
         #Ctrlp:input.c.page1.glcf073
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf073
            #add-point:ON ACTION controlp INFIELD glcf073
            {<point name="input.c.page1.glcf073" />}
            #END add-point
 
         #Ctrlp:input.c.page1.edit1
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD edit1
            #add-point:ON ACTION controlp INFIELD edit1
            {<point name="input.c.page1.edit1" />}
            #END add-point
 
 
 
         ON ROW CHANGE
            IF INT_FLAG THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = '' 
               LET g_errparam.code   = 9001 
               LET g_errparam.popup  = FALSE 
               CALL cl_err()
               LET INT_FLAG = 0
               LET g_glcf_d[l_ac].* = g_glcf_d_t.*
               CLOSE aglt420_bcl
               CALL s_transaction_end('N','0')
               EXIT DIALOG 
            END IF
              
            IF l_lock_sw = 'Y' THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = g_glcf_d[l_ac].glcf003 
               LET g_errparam.code   = -263 
               LET g_errparam.popup  = TRUE 
               CALL cl_err()
               LET g_glcf_d[l_ac].* = g_glcf_d_t.*
            ELSE
            
               #add-point:單身修改前
               {<point name="input.body.b_update" mark="Y"/>}
               #end add-point
               
               #寫入修改者/修改日期資訊(單身)
               
      
               #將遮罩欄位還原
               CALL aglt420_glcf_t_mask_restore('restore_mask_o')
      
               UPDATE glcf_t SET (glcfld,glcf001,glcf002,glcf003,glcf004,glcf005,glcf006,glcf007,glcf008, 
                   glcf009,glcf010,glcf011,glcf012,glcf073,glcf013,glcf014,glcf015,glcf016,glcf017,glcf018, 
                   glcf019,glcf020,glcf021,glcf022,glcf047,glcf048,glcf049,glcf050,glcf051,glcf052,glcf053, 
                   glcf054,glcf055,glcf056,glcf057,glcf058,glcf059,glcf060,glcf061,glcf062,glcf063,glcf064, 
                   glcf065,glcf066,glcf067,glcf068,glcf069,glcf070,glcf071,glcf072) = (g_glce_m.glceld, 
                   g_glce_m.glce001,g_glce_m.glce002,g_glcf_d[l_ac].glcf003,g_glcf_d[l_ac].glcf004,g_glcf_d[l_ac].glcf005, 
                   g_glcf_d[l_ac].glcf006,g_glcf_d[l_ac].glcf007,g_glcf_d[l_ac].glcf008,g_glcf_d[l_ac].glcf009, 
                   g_glcf_d[l_ac].glcf010,g_glcf_d[l_ac].glcf011,g_glcf_d[l_ac].glcf012,g_glcf_d[l_ac].glcf073, 
                   g_glcf2_d[l_ac].glcf013,g_glcf2_d[l_ac].glcf014,g_glcf2_d[l_ac].glcf015,g_glcf2_d[l_ac].glcf016, 
                   g_glcf2_d[l_ac].glcf017,g_glcf3_d[l_ac].glcf018,g_glcf3_d[l_ac].glcf019,g_glcf3_d[l_ac].glcf020, 
                   g_glcf3_d[l_ac].glcf021,g_glcf3_d[l_ac].glcf022,g_glcf4_d[l_ac].glcf047,g_glcf4_d[l_ac].glcf048, 
                   g_glcf4_d[l_ac].glcf049,g_glcf4_d[l_ac].glcf050,g_glcf4_d[l_ac].glcf051,g_glcf4_d[l_ac].glcf052, 
                   g_glcf4_d[l_ac].glcf053,g_glcf4_d[l_ac].glcf054,g_glcf4_d[l_ac].glcf055,g_glcf4_d[l_ac].glcf056, 
                   g_glcf4_d[l_ac].glcf057,g_glcf4_d[l_ac].glcf058,g_glcf4_d[l_ac].glcf059,g_glcf4_d[l_ac].glcf060, 
                   g_glcf4_d[l_ac].glcf061,g_glcf4_d[l_ac].glcf062,g_glcf4_d[l_ac].glcf063,g_glcf4_d[l_ac].glcf064, 
                   g_glcf4_d[l_ac].glcf065,g_glcf4_d[l_ac].glcf066,g_glcf4_d[l_ac].glcf067,g_glcf4_d[l_ac].glcf068, 
                   g_glcf4_d[l_ac].glcf069,g_glcf4_d[l_ac].glcf070,g_glcf4_d[l_ac].glcf071,g_glcf4_d[l_ac].glcf072) 

                WHERE glcfent = g_enterprise AND glcfld = g_glce_m.glceld 
                  AND glcf001 = g_glce_m.glce001 
                  AND glcf002 = g_glce_m.glce002 
 
                  AND glcf003 = g_glcf_d_t.glcf003 #項次   
                  AND glcf004 = g_glcf_d_t.glcf004  
                  AND glcf005 = g_glcf_d_t.glcf005  
 
                  
               #add-point:單身修改中
               {<point name="input.body.m_update"/>}
               #end add-point
               CASE
                  WHEN SQLCA.sqlerrd[3] = 0  #更新不到的處理
                     INITIALIZE g_errparam TO NULL 
                     LET g_errparam.extend = "glcf_t" 
                     LET g_errparam.code   = "std-00009" 
                     LET g_errparam.popup  = TRUE 
                     CALL cl_err()
                     CALL s_transaction_end('N','0')
                     LET g_glcf_d[l_ac].* = g_glcf_d_t.*
                  WHEN SQLCA.sqlcode #其他錯誤
                     INITIALIZE g_errparam TO NULL 
                     LET g_errparam.extend = "glcf_t" 
                     LET g_errparam.code   = SQLCA.sqlcode 
                     LET g_errparam.popup  = TRUE 
                     CALL cl_err()                   
                     CALL s_transaction_end('N','0')
                     LET g_glcf_d[l_ac].* = g_glcf_d_t.*  
                  OTHERWISE
                                    INITIALIZE gs_keys TO NULL 
               LET gs_keys[1] = g_glce_m.glceld
               LET gs_keys_bak[1] = g_glceld_t
               LET gs_keys[2] = g_glce_m.glce001
               LET gs_keys_bak[2] = g_glce001_t
               LET gs_keys[3] = g_glce_m.glce002
               LET gs_keys_bak[3] = g_glce002_t
               LET gs_keys[4] = g_glcf_d[g_detail_idx].glcf003
               LET gs_keys_bak[4] = g_glcf_d_t.glcf003
               LET gs_keys[5] = g_glcf_d[g_detail_idx].glcf004
               LET gs_keys_bak[5] = g_glcf_d_t.glcf004
               LET gs_keys[6] = g_glcf_d[g_detail_idx].glcf005
               LET gs_keys_bak[6] = g_glcf_d_t.glcf005
               CALL aglt420_update_b('glcf_t',gs_keys,gs_keys_bak,"'1'")
                     #資料多語言用-增/改
                     
               END CASE
 
               #將遮罩欄位進行遮蔽
               CALL aglt420_glcf_t_mask_restore('restore_mask_n')
               
               #判斷key是否有改變
               INITIALIZE gs_keys TO NULL
               IF NOT(g_glcf_d[g_detail_idx].glcf003 = g_glcf_d_t.glcf003 
                  AND g_glcf_d[g_detail_idx].glcf004 = g_glcf_d_t.glcf004 
                  AND g_glcf_d[g_detail_idx].glcf005 = g_glcf_d_t.glcf005 
 
                  ) THEN
                  LET gs_keys[01] = g_glce_m.glceld
                  LET gs_keys[gs_keys.getLength()+1] = g_glce_m.glce001
                  LET gs_keys[gs_keys.getLength()+1] = g_glce_m.glce002
 
                  LET gs_keys[gs_keys.getLength()+1] = g_glcf_d_t.glcf003
                  LET gs_keys[gs_keys.getLength()+1] = g_glcf_d_t.glcf004
                  LET gs_keys[gs_keys.getLength()+1] = g_glcf_d_t.glcf005
 
                  CALL aglt420_key_update_b(gs_keys,'glcf_t')
               END IF
               
               #修改歷程記錄(單身修改)
               LET g_log1 = util.JSON.stringify(g_glce_m),util.JSON.stringify(g_glcf_d_t)
               LET g_log2 = util.JSON.stringify(g_glce_m),util.JSON.stringify(g_glcf_d[l_ac])
               IF NOT cl_log_modified_record_d(g_log1,g_log2) THEN 
                  CALL s_transaction_end('N','0')
               END IF
               
               #add-point:單身修改後
               {<point name="input.body.a_update"/>}
               #end add-point
 
            END IF
            
         AFTER ROW
            #add-point:單身after_row
            {<point name="input.body.after_row"/>}
            #end add-point
            CALL aglt420_unlock_b("glcf_t","'1'")
            CALL s_transaction_end('Y','0')
            #其他table進行unlock
            #add-point:單身after_row2
            {<point name="input.body.after_row2"/>}
            #end add-point
              
         AFTER INPUT
            #add-point:input段after input 
            {<point name="input.body.after_input"/>}
            #end add-point 
 
         ON ACTION controlo    
            CALL FGL_SET_ARR_CURR(g_glcf_d.getLength()+1)
            LET lb_reproduce = TRUE
            LET li_reproduce = l_ac
            LET li_reproduce_target = g_glcf_d.getLength()+1
            
         #ON ACTION cancel
         #   LET INT_FLAG = 1
         #   LET g_detail_idx = 1
         #   EXIT DIALOG 
 
      END INPUT
      
      INPUT ARRAY g_glcf2_d FROM s_detail2.*
         ATTRIBUTE(COUNT = g_rec_b,WITHOUT DEFAULTS, #MAXCOUNT = g_max_rec,
                 INSERT ROW = FALSE, #此頁面insert功能由產生器控制, 手動之設定無效! 

                 DELETE ROW = FALSE,
                 APPEND ROW = FALSE)
                 
         #自訂ACTION(detail_input,page_2)
         
         
         BEFORE INPUT
            #add-point:資料輸入前
            {<point name="input.body2.before_input2"/>}
            #end add-point
            
            CALL aglt420_b_fill()
            #如果一直都在單身1則控制筆數位置
            IF g_loc = 'd' AND g_rec_b != 0 THEN
               CALL FGL_SET_ARR_CURR(g_detail_idx)
            END IF
            LET g_loc = 'd'
            LET g_rec_b = g_glcf2_d.getLength()
            #add-point:資料輸入前
            {<point name="input.body2.before_input"/>}
            #end add-point
            
         BEFORE INSERT
            LET g_insert = 'Y' 
            NEXT FIELD glcf003
 
            LET l_insert = TRUE
            LET l_n = ARR_COUNT()
            LET l_cmd = 'a'
            INITIALIZE g_glcf2_d[l_ac].* TO NULL 
            INITIALIZE g_glcf2_d_t.* TO NULL 
            INITIALIZE g_glcf2_d_o.* TO NULL 
            #公用欄位給值(單身2)
            
            #自定義預設值(單身2)
            
            #add-point:modify段before備份
            {<point name="input.body2.insert.before_bak"/>}
            #end add-point
            LET g_glcf2_d_t.* = g_glcf2_d[l_ac].*     #新輸入資料
            LET g_glcf2_d_o.* = g_glcf2_d[l_ac].*     #新輸入資料
            CALL cl_show_fld_cont()
            CALL aglt420_set_entry_b(l_cmd)
            #add-point:modify段after_set_entry_b
            {<point name="input.body2.insert.after_set_entry_b"/>}
            #end add-point
            CALL aglt420_set_no_entry_b(l_cmd)
            IF lb_reproduce THEN
               LET lb_reproduce = FALSE
               LET g_glcf_d[li_reproduce_target].* = g_glcf_d[li_reproduce].*
               LET g_glcf2_d[li_reproduce_target].* = g_glcf2_d[li_reproduce].*
               LET g_glcf3_d[li_reproduce_target].* = g_glcf3_d[li_reproduce].*
               LET g_glcf4_d[li_reproduce_target].* = g_glcf4_d[li_reproduce].*
 
               LET g_glcf2_d[li_reproduce_target].glcf003 = NULL
               LET g_glcf2_d[li_reproduce_target].glcf004 = NULL
               LET g_glcf2_d[li_reproduce_target].glcf005 = NULL
            END IF
            
            #add-point:modify段before insert
            {<point name="input.body2.before_insert"/>}
            #end add-point  
            
         BEFORE ROW     
            #add-point:modify段before row2
            {<point name="input.body2.before_row2"/>}
            #end add-point  
            LET l_insert = FALSE
            LET l_cmd = ''
            LET l_ac = ARR_CURR()
            LET g_detail_idx = l_ac
            LET g_current_page = 2
              
            LET l_lock_sw = 'N'            #DEFAULT
            LET l_n = ARR_COUNT()
            DISPLAY l_ac TO FORMONLY.idx
         
            CALL s_transaction_begin()
            OPEN aglt420_cl USING g_enterprise,g_glce_m.glceld,g_glce_m.glce001,g_glce_m.glce002
            IF STATUS THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = "OPEN aglt420_cl:" 
               LET g_errparam.code   = STATUS 
               LET g_errparam.popup  = TRUE 
               CALL cl_err()
               CLOSE aglt420_cl
               CALL s_transaction_end('N','0')
               RETURN
            END IF
            
            LET g_rec_b = g_glcf2_d.getLength()
            
            IF g_rec_b >= l_ac 
               AND g_glcf2_d[l_ac].glcf003 IS NOT NULL
               AND g_glcf2_d[l_ac].glcf004 IS NOT NULL
               AND g_glcf2_d[l_ac].glcf005 IS NOT NULL
            THEN 
               LET l_cmd='u'
               LET g_glcf2_d_t.* = g_glcf2_d[l_ac].*  #BACKUP
               LET g_glcf2_d_o.* = g_glcf2_d[l_ac].*  #BACKUP
               CALL aglt420_set_entry_b(l_cmd)
               #add-point:modify段after_set_entry_b
               {<point name="input.body2.after_set_entry_b"/>}
               #end add-point  
               CALL aglt420_set_no_entry_b(l_cmd)
               IF NOT aglt420_lock_b("glcf_t","'2'") THEN
                  LET l_lock_sw='Y'
               ELSE
                  FETCH aglt420_bcl INTO g_glcf_d[l_ac].glcf003,g_glcf_d[l_ac].glcf004,g_glcf_d[l_ac].glcf005, 
                      g_glcf_d[l_ac].glcf006,g_glcf_d[l_ac].glcf007,g_glcf_d[l_ac].glcf008,g_glcf_d[l_ac].glcf009, 
                      g_glcf_d[l_ac].glcf010,g_glcf_d[l_ac].glcf011,g_glcf_d[l_ac].glcf012,g_glcf_d[l_ac].glcf073, 
                      g_glcf2_d[l_ac].glcf003,g_glcf2_d[l_ac].glcf004,g_glcf2_d[l_ac].glcf005,g_glcf2_d[l_ac].glcf013, 
                      g_glcf2_d[l_ac].glcf014,g_glcf2_d[l_ac].glcf015,g_glcf2_d[l_ac].glcf016,g_glcf2_d[l_ac].glcf017, 
                      g_glcf3_d[l_ac].glcf003,g_glcf3_d[l_ac].glcf004,g_glcf3_d[l_ac].glcf005,g_glcf3_d[l_ac].glcf018, 
                      g_glcf3_d[l_ac].glcf019,g_glcf3_d[l_ac].glcf020,g_glcf3_d[l_ac].glcf021,g_glcf3_d[l_ac].glcf022, 
                      g_glcf4_d[l_ac].glcf003,g_glcf4_d[l_ac].glcf004,g_glcf4_d[l_ac].glcf005,g_glcf4_d[l_ac].glcf047, 
                      g_glcf4_d[l_ac].glcf048,g_glcf4_d[l_ac].glcf049,g_glcf4_d[l_ac].glcf050,g_glcf4_d[l_ac].glcf051, 
                      g_glcf4_d[l_ac].glcf052,g_glcf4_d[l_ac].glcf053,g_glcf4_d[l_ac].glcf054,g_glcf4_d[l_ac].glcf055, 
                      g_glcf4_d[l_ac].glcf056,g_glcf4_d[l_ac].glcf057,g_glcf4_d[l_ac].glcf058,g_glcf4_d[l_ac].glcf059, 
                      g_glcf4_d[l_ac].glcf060,g_glcf4_d[l_ac].glcf061,g_glcf4_d[l_ac].glcf062,g_glcf4_d[l_ac].glcf063, 
                      g_glcf4_d[l_ac].glcf064,g_glcf4_d[l_ac].glcf065,g_glcf4_d[l_ac].glcf066,g_glcf4_d[l_ac].glcf067, 
                      g_glcf4_d[l_ac].glcf068,g_glcf4_d[l_ac].glcf069,g_glcf4_d[l_ac].glcf070,g_glcf4_d[l_ac].glcf071, 
                      g_glcf4_d[l_ac].glcf072
                  IF SQLCA.sqlcode THEN
                     INITIALIZE g_errparam TO NULL 
                     LET g_errparam.extend = '' 
                     LET g_errparam.code   = SQLCA.sqlcode 
                     LET g_errparam.popup  = TRUE 
                     CALL cl_err()
                     LET l_lock_sw = "Y"
                  END IF
                  
                  #遮罩相關處理
                  LET g_glcf2_d_mask_o[l_ac].* =  g_glcf2_d[l_ac].*
                  CALL aglt420_glcf_t_mask()
                  LET g_glcf2_d_mask_n[l_ac].* =  g_glcf2_d[l_ac].*
                  
                  LET g_bfill = "N"
                  CALL aglt420_show()
                  LET g_bfill = "Y"
                  
                  CALL cl_show_fld_cont()
               END IF
            ELSE
               LET l_cmd='a'
            END IF
            #add-point:modify段before row
            {<point name="input.body2.before_row"/>}
            #end add-point  
            #其他table資料備份(確定是否更改用)
            
            #其他table進行lock
            
            
         BEFORE DELETE                            #是否取消單身
            IF l_cmd = 'a' THEN
               LET l_cmd='d'
               #add-point:單身AFTER DELETE (=d)
               {<point name="input.body2.after_delete_d"/>}
               #end add-point
            ELSE
               IF NOT cl_ask_del_detail() THEN
                  CANCEL DELETE
               END IF
               IF l_lock_sw = "Y" THEN
                  INITIALIZE g_errparam TO NULL 
                  LET g_errparam.extend = "" 
                  LET g_errparam.code   = -263 
                  LET g_errparam.popup  = TRUE 
                  CALL cl_err()
                  CANCEL DELETE
               END IF
               
               #add-point:單身2刪除前
               {<point name="input.body2.b_delete" mark="Y"/>}
               #end add-point    
                  
               #取得該筆資料key值
               INITIALIZE gs_keys TO NULL
               LET gs_keys[01] = g_glce_m.glceld
               LET gs_keys[gs_keys.getLength()+1] = g_glce_m.glce001
               LET gs_keys[gs_keys.getLength()+1] = g_glce_m.glce002
               LET gs_keys[gs_keys.getLength()+1] = g_glcf2_d_t.glcf003
               LET gs_keys[gs_keys.getLength()+1] = g_glcf2_d_t.glcf004
               LET gs_keys[gs_keys.getLength()+1] = g_glcf2_d_t.glcf005
            
               #刪除同層單身
               IF NOT aglt420_delete_b('glcf_t',gs_keys,"'2'") THEN
                  CALL s_transaction_end('N','0')
                  CLOSE aglt420_bcl
                  CANCEL DELETE
               END IF
    
               #刪除下層單身
               IF NOT aglt420_key_delete_b(gs_keys,'glcf_t') THEN
                  CALL s_transaction_end('N','0')
                  CLOSE aglt420_bcl
                  CANCEL DELETE
               END IF
               
               #刪除多語言
               
               
               #add-point:單身2刪除中
               {<point name="input.body2.m_delete"/>}
               #end add-point    
               
               CALL s_transaction_end('Y','0')
               CLOSE aglt420_bcl
               LET g_rec_b = g_rec_b-1
               
               #add-point:單身2刪除後
               {<point name="input.body2.a_delete"/>}
               #end add-point
               LET l_count = g_glcf_d.getLength()
               
               #add-point:單身刪除後(<>d)
               {<point name="input.body2.after_delete"/>}
               #end add-point
            END IF 
         AFTER DELETE
            #如果是最後一筆
            IF l_ac = (g_glcf2_d.getLength() + 1) THEN
               CALL FGL_SET_ARR_CURR(l_ac-1)
            END IF
 
         AFTER INSERT    
            LET l_insert = FALSE
            IF INT_FLAG THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = '' 
               LET g_errparam.code   = 9001 
               LET g_errparam.popup  = FALSE 
               CALL cl_err()
               LET INT_FLAG = 0
               CANCEL INSERT
            END IF
               
            #add-point:單身2新增前
            {<point name="input.body2.b_a_insert"/>}
            #end add-point
               
            LET l_count = 1  
            SELECT COUNT(*) INTO l_count FROM glcf_t 
             WHERE glcfent = g_enterprise AND glcfld = g_glce_m.glceld
               AND glcf001 = g_glce_m.glce001
               AND glcf002 = g_glce_m.glce002
               AND glcf003 = g_glcf2_d[l_ac].glcf003
               AND glcf004 = g_glcf2_d[l_ac].glcf004
               AND glcf005 = g_glcf2_d[l_ac].glcf005
                
            #資料未重複, 插入新增資料
            IF l_count = 0 THEN 
               #add-point:單身2新增前
               {<point name="input.body2.b_insert"/>}
               #end add-point
            
                              INITIALIZE gs_keys TO NULL 
               LET gs_keys[1] = g_glce_m.glceld
               LET gs_keys[2] = g_glce_m.glce001
               LET gs_keys[3] = g_glce_m.glce002
               LET gs_keys[4] = g_glcf2_d[g_detail_idx].glcf003
               LET gs_keys[5] = g_glcf2_d[g_detail_idx].glcf004
               LET gs_keys[6] = g_glcf2_d[g_detail_idx].glcf005
               CALL aglt420_insert_b('glcf_t',gs_keys,"'2'")
                           
               #add-point:單身新增後2
               {<point name="input.body2.a_insert"/>}
               #end add-point
            ELSE    
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = 'INSERT' 
               LET g_errparam.code   = "std-00006" 
               LET g_errparam.popup  = TRUE 
               CALL cl_err()
               INITIALIZE g_glcf_d[l_ac].* TO NULL
               CALL s_transaction_end('N','0')
               CANCEL INSERT
            END IF
 
            IF SQLCA.SQLcode  THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = "glcf_t" 
               LET g_errparam.code   = SQLCA.sqlcode 
               LET g_errparam.popup  = TRUE 
               CALL cl_err()
               CALL s_transaction_end('N','0')                    
               CANCEL INSERT
            ELSE
               #先刷新資料
               #CALL aglt420_b_fill()
               #資料多語言用-增/改
               
               #add-point:單身新增後
               {<point name="input.body2.after_insert"/>}
               #end add-point
               CALL s_transaction_end('Y','0')
               #ERROR 'INSERT O.K'
               LET g_rec_b = g_rec_b + 1
            END IF
            
         ON ROW CHANGE 
            IF INT_FLAG THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = '' 
               LET g_errparam.code   = 9001 
               LET g_errparam.popup  = FALSE 
               CALL cl_err()
               LET INT_FLAG = 0
               LET g_glcf2_d[l_ac].* = g_glcf2_d_t.*
               CLOSE aglt420_bcl
               CALL s_transaction_end('N','0')
               EXIT DIALOG 
            END IF
            
            IF l_lock_sw = 'Y' THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = '' 
               LET g_errparam.code   = -263 
               LET g_errparam.popup  = TRUE 
               CALL cl_err()
               LET g_glcf2_d[l_ac].* = g_glcf2_d_t.*
            ELSE
               #add-point:單身page2修改前
               {<point name="input.body2.b_update" mark="Y"/>}
               #end add-point
               
               #寫入修改者/修改日期資訊(單身2)
               
               
               #將遮罩欄位還原
               CALL aglt420_glcf_t_mask_restore('restore_mask_o')
                              
               UPDATE glcf_t SET (glcfld,glcf001,glcf002,glcf003,glcf004,glcf005,glcf006,glcf007,glcf008, 
                   glcf009,glcf010,glcf011,glcf012,glcf073,glcf013,glcf014,glcf015,glcf016,glcf017,glcf018, 
                   glcf019,glcf020,glcf021,glcf022,glcf047,glcf048,glcf049,glcf050,glcf051,glcf052,glcf053, 
                   glcf054,glcf055,glcf056,glcf057,glcf058,glcf059,glcf060,glcf061,glcf062,glcf063,glcf064, 
                   glcf065,glcf066,glcf067,glcf068,glcf069,glcf070,glcf071,glcf072) = (g_glce_m.glceld, 
                   g_glce_m.glce001,g_glce_m.glce002,g_glcf_d[l_ac].glcf003,g_glcf_d[l_ac].glcf004,g_glcf_d[l_ac].glcf005, 
                   g_glcf_d[l_ac].glcf006,g_glcf_d[l_ac].glcf007,g_glcf_d[l_ac].glcf008,g_glcf_d[l_ac].glcf009, 
                   g_glcf_d[l_ac].glcf010,g_glcf_d[l_ac].glcf011,g_glcf_d[l_ac].glcf012,g_glcf_d[l_ac].glcf073, 
                   g_glcf2_d[l_ac].glcf013,g_glcf2_d[l_ac].glcf014,g_glcf2_d[l_ac].glcf015,g_glcf2_d[l_ac].glcf016, 
                   g_glcf2_d[l_ac].glcf017,g_glcf3_d[l_ac].glcf018,g_glcf3_d[l_ac].glcf019,g_glcf3_d[l_ac].glcf020, 
                   g_glcf3_d[l_ac].glcf021,g_glcf3_d[l_ac].glcf022,g_glcf4_d[l_ac].glcf047,g_glcf4_d[l_ac].glcf048, 
                   g_glcf4_d[l_ac].glcf049,g_glcf4_d[l_ac].glcf050,g_glcf4_d[l_ac].glcf051,g_glcf4_d[l_ac].glcf052, 
                   g_glcf4_d[l_ac].glcf053,g_glcf4_d[l_ac].glcf054,g_glcf4_d[l_ac].glcf055,g_glcf4_d[l_ac].glcf056, 
                   g_glcf4_d[l_ac].glcf057,g_glcf4_d[l_ac].glcf058,g_glcf4_d[l_ac].glcf059,g_glcf4_d[l_ac].glcf060, 
                   g_glcf4_d[l_ac].glcf061,g_glcf4_d[l_ac].glcf062,g_glcf4_d[l_ac].glcf063,g_glcf4_d[l_ac].glcf064, 
                   g_glcf4_d[l_ac].glcf065,g_glcf4_d[l_ac].glcf066,g_glcf4_d[l_ac].glcf067,g_glcf4_d[l_ac].glcf068, 
                   g_glcf4_d[l_ac].glcf069,g_glcf4_d[l_ac].glcf070,g_glcf4_d[l_ac].glcf071,g_glcf4_d[l_ac].glcf072)  
                   #自訂欄位頁簽
                WHERE glcfent = g_enterprise AND glcfld = g_glce_m.glceld
                  AND glcf001 = g_glce_m.glce001
                  AND glcf002 = g_glce_m.glce002
                  AND glcf003 = g_glcf2_d_t.glcf003 #項次 
                  AND glcf004 = g_glcf2_d_t.glcf004
                  AND glcf005 = g_glcf2_d_t.glcf005
                  
               #add-point:單身page2修改中
               {<point name="input.body2.m_update"/>}
               #end add-point
                  
               CASE
                  WHEN SQLCA.sqlerrd[3] = 0  #更新不到的處理
                     INITIALIZE g_errparam TO NULL 
                     LET g_errparam.extend = "glcf_t" 
                     LET g_errparam.code   = "std-00009" 
                     LET g_errparam.popup  = TRUE 
                     CALL cl_err()
                     CALL s_transaction_end('N','0')
                     LET g_glcf2_d[l_ac].* = g_glcf2_d_t.*
                  WHEN SQLCA.sqlcode #其他錯誤
                     INITIALIZE g_errparam TO NULL 
                     LET g_errparam.extend = "glcf_t" 
                     LET g_errparam.code   = SQLCA.sqlcode 
                     LET g_errparam.popup  = TRUE 
                     CALL cl_err()
                     CALL s_transaction_end('N','0')
                     LET g_glcf2_d[l_ac].* = g_glcf2_d_t.*
                  OTHERWISE
                                    INITIALIZE gs_keys TO NULL 
               LET gs_keys[1] = g_glce_m.glceld
               LET gs_keys_bak[1] = g_glceld_t
               LET gs_keys[2] = g_glce_m.glce001
               LET gs_keys_bak[2] = g_glce001_t
               LET gs_keys[3] = g_glce_m.glce002
               LET gs_keys_bak[3] = g_glce002_t
               LET gs_keys[4] = g_glcf2_d[g_detail_idx].glcf003
               LET gs_keys_bak[4] = g_glcf2_d_t.glcf003
               LET gs_keys[5] = g_glcf2_d[g_detail_idx].glcf004
               LET gs_keys_bak[5] = g_glcf2_d_t.glcf004
               LET gs_keys[6] = g_glcf2_d[g_detail_idx].glcf005
               LET gs_keys_bak[6] = g_glcf2_d_t.glcf005
               CALL aglt420_update_b('glcf_t',gs_keys,gs_keys_bak,"'2'")
                     #資料多語言用-增/改
                     
               END CASE
               
               #將遮罩欄位進行遮蔽
               CALL aglt420_glcf_t_mask_restore('restore_mask_n')
               
               #判斷key是否有改變
               INITIALIZE gs_keys TO NULL
               IF NOT (g_glcf2_d[g_detail_idx].glcf003 = g_glcf2_d_t.glcf003 
                  AND g_glcf2_d[g_detail_idx].glcf004 = g_glcf2_d_t.glcf004 
                  AND g_glcf2_d[g_detail_idx].glcf005 = g_glcf2_d_t.glcf005 
                  ) THEN
                  LET gs_keys[01] = g_glce_m.glceld
                  LET gs_keys[gs_keys.getLength()+1] = g_glce_m.glce001
                  LET gs_keys[gs_keys.getLength()+1] = g_glce_m.glce002
                  LET gs_keys[gs_keys.getLength()+1] = g_glcf2_d_t.glcf003
                  LET gs_keys[gs_keys.getLength()+1] = g_glcf2_d_t.glcf004
                  LET gs_keys[gs_keys.getLength()+1] = g_glcf2_d_t.glcf005
                  CALL aglt420_key_update_b(gs_keys,'glcf_t')
               END IF
               
               #修改歷程記錄(單身修改)
               LET g_log1 = util.JSON.stringify(g_glce_m),util.JSON.stringify(g_glcf2_d_t)
               LET g_log2 = util.JSON.stringify(g_glce_m),util.JSON.stringify(g_glcf2_d[l_ac])
               IF NOT cl_log_modified_record_d(g_log1,g_log2) THEN 
                  CALL s_transaction_end('N','0')
               END IF
               
               #add-point:單身page2修改後
               {<point name="input.body2.a_update"/>}
               #end add-point
            END IF
         
                  #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf003_2_desc
            #add-point:BEFORE FIELD glcf003_2_desc
            {<point name="input.b.page2.glcf003_2_desc" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf003_2_desc
            
            #add-point:AFTER FIELD glcf003_2_desc
            {<point name="input.a.page2.glcf003_2_desc" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE glcf003_2_desc
            #add-point:ON CHANGE glcf003_2_desc
            {<point name="input.g.page2.glcf003_2_desc" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf013
            #add-point:BEFORE FIELD glcf013
            {<point name="input.b.page2.glcf013" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf013
            
            #add-point:AFTER FIELD glcf013
            {<point name="input.a.page2.glcf013" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE glcf013
            #add-point:ON CHANGE glcf013
            {<point name="input.g.page2.glcf013" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf014
            #add-point:BEFORE FIELD glcf014
            {<point name="input.b.page2.glcf014" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf014
            
            #add-point:AFTER FIELD glcf014
            {<point name="input.a.page2.glcf014" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE glcf014
            #add-point:ON CHANGE glcf014
            {<point name="input.g.page2.glcf014" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf015
            #add-point:BEFORE FIELD glcf015
            {<point name="input.b.page2.glcf015" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf015
            
            #add-point:AFTER FIELD glcf015
            {<point name="input.a.page2.glcf015" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE glcf015
            #add-point:ON CHANGE glcf015
            {<point name="input.g.page2.glcf015" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf016
            #add-point:BEFORE FIELD glcf016
            {<point name="input.b.page2.glcf016" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf016
            
            #add-point:AFTER FIELD glcf016
            {<point name="input.a.page2.glcf016" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE glcf016
            #add-point:ON CHANGE glcf016
            {<point name="input.g.page2.glcf016" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf017
            #add-point:BEFORE FIELD glcf017
            {<point name="input.b.page2.glcf017" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf017
            
            #add-point:AFTER FIELD glcf017
            {<point name="input.a.page2.glcf017" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE glcf017
            #add-point:ON CHANGE glcf017
            {<point name="input.g.page2.glcf017" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD edit2
            #add-point:BEFORE FIELD edit2
            {<point name="input.b.page2.edit2" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD edit2
            
            #add-point:AFTER FIELD edit2
            {<point name="input.a.page2.edit2" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE edit2
            #add-point:ON CHANGE edit2
            {<point name="input.g.page2.edit2" />}
            #END add-point 
 
 
                  #Ctrlp:input.c.page2.glcf003_2_desc
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf003_2_desc
            #add-point:ON ACTION controlp INFIELD glcf003_2_desc
            {<point name="input.c.page2.glcf003_2_desc" />}
            #END add-point
 
         #Ctrlp:input.c.page2.glcf013
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf013
            #add-point:ON ACTION controlp INFIELD glcf013
            {<point name="input.c.page2.glcf013" />}
            #END add-point
 
         #Ctrlp:input.c.page2.glcf014
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf014
            #add-point:ON ACTION controlp INFIELD glcf014
            {<point name="input.c.page2.glcf014" />}
            #END add-point
 
         #Ctrlp:input.c.page2.glcf015
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf015
            #add-point:ON ACTION controlp INFIELD glcf015
            {<point name="input.c.page2.glcf015" />}
            #END add-point
 
         #Ctrlp:input.c.page2.glcf016
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf016
            #add-point:ON ACTION controlp INFIELD glcf016
            {<point name="input.c.page2.glcf016" />}
            #END add-point
 
         #Ctrlp:input.c.page2.glcf017
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf017
            #add-point:ON ACTION controlp INFIELD glcf017
            {<point name="input.c.page2.glcf017" />}
            #END add-point
 
         #Ctrlp:input.c.page2.edit2
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD edit2
            #add-point:ON ACTION controlp INFIELD edit2
            {<point name="input.c.page2.edit2" />}
            #END add-point
 
 
 
         AFTER ROW
            #add-point:單身page2 after_row
            {<point name="input.body2.after_row"/>}
            #end add-point
            LET l_ac = ARR_CURR()
            IF INT_FLAG THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = '' 
               LET g_errparam.code   = 9001 
               LET g_errparam.popup  = FALSE 
               CALL cl_err()
               LET INT_FLAG = 0
               IF l_cmd = 'u' THEN
                  LET g_glcf2_d[l_ac].* = g_glcf2_d_t.*
               END IF
               CLOSE aglt420_bcl
               CALL s_transaction_end('N','0')
               EXIT DIALOG 
            END IF
            
            #其他table進行unlock
            
            CALL aglt420_unlock_b("glcf_t","'2'")
            CALL s_transaction_end('Y','0')
            #add-point:單身page2 after_row2
            {<point name="input.body2.after_row2"/>}
            #end add-point
 
         AFTER INPUT
            #add-point:input段after input 
            {<point name="input.body2.after_input"/>}
            #end add-point   
    
         ON ACTION controlo
            CALL FGL_SET_ARR_CURR(g_glcf2_d.getLength()+1)
            LET lb_reproduce = TRUE
            LET li_reproduce = l_ac
            LET li_reproduce_target = g_glcf2_d.getLength()+1
 
      END INPUT
      INPUT ARRAY g_glcf3_d FROM s_detail3.*
         ATTRIBUTE(COUNT = g_rec_b,WITHOUT DEFAULTS, #MAXCOUNT = g_max_rec,
                 INSERT ROW = FALSE, #此頁面insert功能由產生器控制, 手動之設定無效! 

                 DELETE ROW = FALSE,
                 APPEND ROW = FALSE)
                 
         #自訂ACTION(detail_input,page_3)
         
         
         BEFORE INPUT
            #add-point:資料輸入前
            {<point name="input.body3.before_input2"/>}
            #end add-point
            
            CALL aglt420_b_fill()
            #如果一直都在單身1則控制筆數位置
            IF g_loc = 'd' AND g_rec_b != 0 THEN
               CALL FGL_SET_ARR_CURR(g_detail_idx)
            END IF
            LET g_loc = 'd'
            LET g_rec_b = g_glcf3_d.getLength()
            #add-point:資料輸入前
            {<point name="input.body3.before_input"/>}
            #end add-point
            
         BEFORE INSERT
            LET g_insert = 'Y' 
            NEXT FIELD glcf003
 
            LET l_insert = TRUE
            LET l_n = ARR_COUNT()
            LET l_cmd = 'a'
            INITIALIZE g_glcf3_d[l_ac].* TO NULL 
            INITIALIZE g_glcf3_d_t.* TO NULL 
            INITIALIZE g_glcf3_d_o.* TO NULL 
            #公用欄位給值(單身3)
            
            #自定義預設值(單身3)
            
            #add-point:modify段before備份
            {<point name="input.body3.insert.before_bak"/>}
            #end add-point
            LET g_glcf3_d_t.* = g_glcf3_d[l_ac].*     #新輸入資料
            LET g_glcf3_d_o.* = g_glcf3_d[l_ac].*     #新輸入資料
            CALL cl_show_fld_cont()
            CALL aglt420_set_entry_b(l_cmd)
            #add-point:modify段after_set_entry_b
            {<point name="input.body3.insert.after_set_entry_b"/>}
            #end add-point
            CALL aglt420_set_no_entry_b(l_cmd)
            IF lb_reproduce THEN
               LET lb_reproduce = FALSE
               LET g_glcf_d[li_reproduce_target].* = g_glcf_d[li_reproduce].*
               LET g_glcf2_d[li_reproduce_target].* = g_glcf2_d[li_reproduce].*
               LET g_glcf3_d[li_reproduce_target].* = g_glcf3_d[li_reproduce].*
               LET g_glcf4_d[li_reproduce_target].* = g_glcf4_d[li_reproduce].*
 
               LET g_glcf3_d[li_reproduce_target].glcf003 = NULL
               LET g_glcf3_d[li_reproduce_target].glcf004 = NULL
               LET g_glcf3_d[li_reproduce_target].glcf005 = NULL
            END IF
            
            #add-point:modify段before insert
            {<point name="input.body3.before_insert"/>}
            #end add-point  
            
         BEFORE ROW     
            #add-point:modify段before row2
            {<point name="input.body3.before_row2"/>}
            #end add-point  
            LET l_insert = FALSE
            LET l_cmd = ''
            LET l_ac = ARR_CURR()
            LET g_detail_idx = l_ac
            LET g_current_page = 3
              
            LET l_lock_sw = 'N'            #DEFAULT
            LET l_n = ARR_COUNT()
            DISPLAY l_ac TO FORMONLY.idx
         
            CALL s_transaction_begin()
            OPEN aglt420_cl USING g_enterprise,g_glce_m.glceld,g_glce_m.glce001,g_glce_m.glce002
            IF STATUS THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = "OPEN aglt420_cl:" 
               LET g_errparam.code   = STATUS 
               LET g_errparam.popup  = TRUE 
               CALL cl_err()
               CLOSE aglt420_cl
               CALL s_transaction_end('N','0')
               RETURN
            END IF
            
            LET g_rec_b = g_glcf3_d.getLength()
            
            IF g_rec_b >= l_ac 
               AND g_glcf3_d[l_ac].glcf003 IS NOT NULL
               AND g_glcf3_d[l_ac].glcf004 IS NOT NULL
               AND g_glcf3_d[l_ac].glcf005 IS NOT NULL
            THEN 
               LET l_cmd='u'
               LET g_glcf3_d_t.* = g_glcf3_d[l_ac].*  #BACKUP
               LET g_glcf3_d_o.* = g_glcf3_d[l_ac].*  #BACKUP
               CALL aglt420_set_entry_b(l_cmd)
               #add-point:modify段after_set_entry_b
               {<point name="input.body3.after_set_entry_b"/>}
               #end add-point  
               CALL aglt420_set_no_entry_b(l_cmd)
               IF NOT aglt420_lock_b("glcf_t","'3'") THEN
                  LET l_lock_sw='Y'
               ELSE
                  FETCH aglt420_bcl INTO g_glcf_d[l_ac].glcf003,g_glcf_d[l_ac].glcf004,g_glcf_d[l_ac].glcf005, 
                      g_glcf_d[l_ac].glcf006,g_glcf_d[l_ac].glcf007,g_glcf_d[l_ac].glcf008,g_glcf_d[l_ac].glcf009, 
                      g_glcf_d[l_ac].glcf010,g_glcf_d[l_ac].glcf011,g_glcf_d[l_ac].glcf012,g_glcf_d[l_ac].glcf073, 
                      g_glcf2_d[l_ac].glcf003,g_glcf2_d[l_ac].glcf004,g_glcf2_d[l_ac].glcf005,g_glcf2_d[l_ac].glcf013, 
                      g_glcf2_d[l_ac].glcf014,g_glcf2_d[l_ac].glcf015,g_glcf2_d[l_ac].glcf016,g_glcf2_d[l_ac].glcf017, 
                      g_glcf3_d[l_ac].glcf003,g_glcf3_d[l_ac].glcf004,g_glcf3_d[l_ac].glcf005,g_glcf3_d[l_ac].glcf018, 
                      g_glcf3_d[l_ac].glcf019,g_glcf3_d[l_ac].glcf020,g_glcf3_d[l_ac].glcf021,g_glcf3_d[l_ac].glcf022, 
                      g_glcf4_d[l_ac].glcf003,g_glcf4_d[l_ac].glcf004,g_glcf4_d[l_ac].glcf005,g_glcf4_d[l_ac].glcf047, 
                      g_glcf4_d[l_ac].glcf048,g_glcf4_d[l_ac].glcf049,g_glcf4_d[l_ac].glcf050,g_glcf4_d[l_ac].glcf051, 
                      g_glcf4_d[l_ac].glcf052,g_glcf4_d[l_ac].glcf053,g_glcf4_d[l_ac].glcf054,g_glcf4_d[l_ac].glcf055, 
                      g_glcf4_d[l_ac].glcf056,g_glcf4_d[l_ac].glcf057,g_glcf4_d[l_ac].glcf058,g_glcf4_d[l_ac].glcf059, 
                      g_glcf4_d[l_ac].glcf060,g_glcf4_d[l_ac].glcf061,g_glcf4_d[l_ac].glcf062,g_glcf4_d[l_ac].glcf063, 
                      g_glcf4_d[l_ac].glcf064,g_glcf4_d[l_ac].glcf065,g_glcf4_d[l_ac].glcf066,g_glcf4_d[l_ac].glcf067, 
                      g_glcf4_d[l_ac].glcf068,g_glcf4_d[l_ac].glcf069,g_glcf4_d[l_ac].glcf070,g_glcf4_d[l_ac].glcf071, 
                      g_glcf4_d[l_ac].glcf072
                  IF SQLCA.sqlcode THEN
                     INITIALIZE g_errparam TO NULL 
                     LET g_errparam.extend = '' 
                     LET g_errparam.code   = SQLCA.sqlcode 
                     LET g_errparam.popup  = TRUE 
                     CALL cl_err()
                     LET l_lock_sw = "Y"
                  END IF
                  
                  #遮罩相關處理
                  LET g_glcf3_d_mask_o[l_ac].* =  g_glcf3_d[l_ac].*
                  CALL aglt420_glcf_t_mask()
                  LET g_glcf3_d_mask_n[l_ac].* =  g_glcf3_d[l_ac].*
                  
                  LET g_bfill = "N"
                  CALL aglt420_show()
                  LET g_bfill = "Y"
                  
                  CALL cl_show_fld_cont()
               END IF
            ELSE
               LET l_cmd='a'
            END IF
            #add-point:modify段before row
            {<point name="input.body3.before_row"/>}
            #end add-point  
            #其他table資料備份(確定是否更改用)
            
            #其他table進行lock
            
            
         BEFORE DELETE                            #是否取消單身
            IF l_cmd = 'a' THEN
               LET l_cmd='d'
               #add-point:單身AFTER DELETE (=d)
               {<point name="input.body3.after_delete_d"/>}
               #end add-point
            ELSE
               IF NOT cl_ask_del_detail() THEN
                  CANCEL DELETE
               END IF
               IF l_lock_sw = "Y" THEN
                  INITIALIZE g_errparam TO NULL 
                  LET g_errparam.extend = "" 
                  LET g_errparam.code   = -263 
                  LET g_errparam.popup  = TRUE 
                  CALL cl_err()
                  CANCEL DELETE
               END IF
               
               #add-point:單身3刪除前
               {<point name="input.body3.b_delete" mark="Y"/>}
               #end add-point    
                  
               #取得該筆資料key值
               INITIALIZE gs_keys TO NULL
               LET gs_keys[01] = g_glce_m.glceld
               LET gs_keys[gs_keys.getLength()+1] = g_glce_m.glce001
               LET gs_keys[gs_keys.getLength()+1] = g_glce_m.glce002
               LET gs_keys[gs_keys.getLength()+1] = g_glcf3_d_t.glcf003
               LET gs_keys[gs_keys.getLength()+1] = g_glcf3_d_t.glcf004
               LET gs_keys[gs_keys.getLength()+1] = g_glcf3_d_t.glcf005
            
               #刪除同層單身
               IF NOT aglt420_delete_b('glcf_t',gs_keys,"'3'") THEN
                  CALL s_transaction_end('N','0')
                  CLOSE aglt420_bcl
                  CANCEL DELETE
               END IF
    
               #刪除下層單身
               IF NOT aglt420_key_delete_b(gs_keys,'glcf_t') THEN
                  CALL s_transaction_end('N','0')
                  CLOSE aglt420_bcl
                  CANCEL DELETE
               END IF
               
               #刪除多語言
               
               
               #add-point:單身3刪除中
               {<point name="input.body3.m_delete"/>}
               #end add-point    
               
               CALL s_transaction_end('Y','0')
               CLOSE aglt420_bcl
               LET g_rec_b = g_rec_b-1
               
               #add-point:單身3刪除後
               {<point name="input.body3.a_delete"/>}
               #end add-point
               LET l_count = g_glcf_d.getLength()
               
               #add-point:單身刪除後(<>d)
               {<point name="input.body3.after_delete"/>}
               #end add-point
            END IF 
         AFTER DELETE
            #如果是最後一筆
            IF l_ac = (g_glcf3_d.getLength() + 1) THEN
               CALL FGL_SET_ARR_CURR(l_ac-1)
            END IF
 
         AFTER INSERT    
            LET l_insert = FALSE
            IF INT_FLAG THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = '' 
               LET g_errparam.code   = 9001 
               LET g_errparam.popup  = FALSE 
               CALL cl_err()
               LET INT_FLAG = 0
               CANCEL INSERT
            END IF
               
            #add-point:單身3新增前
            {<point name="input.body3.b_a_insert"/>}
            #end add-point
               
            LET l_count = 1  
            SELECT COUNT(*) INTO l_count FROM glcf_t 
             WHERE glcfent = g_enterprise AND glcfld = g_glce_m.glceld
               AND glcf001 = g_glce_m.glce001
               AND glcf002 = g_glce_m.glce002
               AND glcf003 = g_glcf3_d[l_ac].glcf003
               AND glcf004 = g_glcf3_d[l_ac].glcf004
               AND glcf005 = g_glcf3_d[l_ac].glcf005
                
            #資料未重複, 插入新增資料
            IF l_count = 0 THEN 
               #add-point:單身3新增前
               {<point name="input.body3.b_insert"/>}
               #end add-point
            
                              INITIALIZE gs_keys TO NULL 
               LET gs_keys[1] = g_glce_m.glceld
               LET gs_keys[2] = g_glce_m.glce001
               LET gs_keys[3] = g_glce_m.glce002
               LET gs_keys[4] = g_glcf3_d[g_detail_idx].glcf003
               LET gs_keys[5] = g_glcf3_d[g_detail_idx].glcf004
               LET gs_keys[6] = g_glcf3_d[g_detail_idx].glcf005
               CALL aglt420_insert_b('glcf_t',gs_keys,"'3'")
                           
               #add-point:單身新增後3
               {<point name="input.body3.a_insert"/>}
               #end add-point
            ELSE    
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = 'INSERT' 
               LET g_errparam.code   = "std-00006" 
               LET g_errparam.popup  = TRUE 
               CALL cl_err()
               INITIALIZE g_glcf_d[l_ac].* TO NULL
               CALL s_transaction_end('N','0')
               CANCEL INSERT
            END IF
 
            IF SQLCA.SQLcode  THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = "glcf_t" 
               LET g_errparam.code   = SQLCA.sqlcode 
               LET g_errparam.popup  = TRUE 
               CALL cl_err()
               CALL s_transaction_end('N','0')                    
               CANCEL INSERT
            ELSE
               #先刷新資料
               #CALL aglt420_b_fill()
               #資料多語言用-增/改
               
               #add-point:單身新增後
               {<point name="input.body3.after_insert"/>}
               #end add-point
               CALL s_transaction_end('Y','0')
               #ERROR 'INSERT O.K'
               LET g_rec_b = g_rec_b + 1
            END IF
            
         ON ROW CHANGE 
            IF INT_FLAG THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = '' 
               LET g_errparam.code   = 9001 
               LET g_errparam.popup  = FALSE 
               CALL cl_err()
               LET INT_FLAG = 0
               LET g_glcf3_d[l_ac].* = g_glcf3_d_t.*
               CLOSE aglt420_bcl
               CALL s_transaction_end('N','0')
               EXIT DIALOG 
            END IF
            
            IF l_lock_sw = 'Y' THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = '' 
               LET g_errparam.code   = -263 
               LET g_errparam.popup  = TRUE 
               CALL cl_err()
               LET g_glcf3_d[l_ac].* = g_glcf3_d_t.*
            ELSE
               #add-point:單身page3修改前
               {<point name="input.body3.b_update" mark="Y"/>}
               #end add-point
               
               #寫入修改者/修改日期資訊(單身3)
               
               
               #將遮罩欄位還原
               CALL aglt420_glcf_t_mask_restore('restore_mask_o')
                              
               UPDATE glcf_t SET (glcfld,glcf001,glcf002,glcf003,glcf004,glcf005,glcf006,glcf007,glcf008, 
                   glcf009,glcf010,glcf011,glcf012,glcf073,glcf013,glcf014,glcf015,glcf016,glcf017,glcf018, 
                   glcf019,glcf020,glcf021,glcf022,glcf047,glcf048,glcf049,glcf050,glcf051,glcf052,glcf053, 
                   glcf054,glcf055,glcf056,glcf057,glcf058,glcf059,glcf060,glcf061,glcf062,glcf063,glcf064, 
                   glcf065,glcf066,glcf067,glcf068,glcf069,glcf070,glcf071,glcf072) = (g_glce_m.glceld, 
                   g_glce_m.glce001,g_glce_m.glce002,g_glcf_d[l_ac].glcf003,g_glcf_d[l_ac].glcf004,g_glcf_d[l_ac].glcf005, 
                   g_glcf_d[l_ac].glcf006,g_glcf_d[l_ac].glcf007,g_glcf_d[l_ac].glcf008,g_glcf_d[l_ac].glcf009, 
                   g_glcf_d[l_ac].glcf010,g_glcf_d[l_ac].glcf011,g_glcf_d[l_ac].glcf012,g_glcf_d[l_ac].glcf073, 
                   g_glcf2_d[l_ac].glcf013,g_glcf2_d[l_ac].glcf014,g_glcf2_d[l_ac].glcf015,g_glcf2_d[l_ac].glcf016, 
                   g_glcf2_d[l_ac].glcf017,g_glcf3_d[l_ac].glcf018,g_glcf3_d[l_ac].glcf019,g_glcf3_d[l_ac].glcf020, 
                   g_glcf3_d[l_ac].glcf021,g_glcf3_d[l_ac].glcf022,g_glcf4_d[l_ac].glcf047,g_glcf4_d[l_ac].glcf048, 
                   g_glcf4_d[l_ac].glcf049,g_glcf4_d[l_ac].glcf050,g_glcf4_d[l_ac].glcf051,g_glcf4_d[l_ac].glcf052, 
                   g_glcf4_d[l_ac].glcf053,g_glcf4_d[l_ac].glcf054,g_glcf4_d[l_ac].glcf055,g_glcf4_d[l_ac].glcf056, 
                   g_glcf4_d[l_ac].glcf057,g_glcf4_d[l_ac].glcf058,g_glcf4_d[l_ac].glcf059,g_glcf4_d[l_ac].glcf060, 
                   g_glcf4_d[l_ac].glcf061,g_glcf4_d[l_ac].glcf062,g_glcf4_d[l_ac].glcf063,g_glcf4_d[l_ac].glcf064, 
                   g_glcf4_d[l_ac].glcf065,g_glcf4_d[l_ac].glcf066,g_glcf4_d[l_ac].glcf067,g_glcf4_d[l_ac].glcf068, 
                   g_glcf4_d[l_ac].glcf069,g_glcf4_d[l_ac].glcf070,g_glcf4_d[l_ac].glcf071,g_glcf4_d[l_ac].glcf072)  
                   #自訂欄位頁簽
                WHERE glcfent = g_enterprise AND glcfld = g_glce_m.glceld
                  AND glcf001 = g_glce_m.glce001
                  AND glcf002 = g_glce_m.glce002
                  AND glcf003 = g_glcf3_d_t.glcf003 #項次 
                  AND glcf004 = g_glcf3_d_t.glcf004
                  AND glcf005 = g_glcf3_d_t.glcf005
                  
               #add-point:單身page3修改中
               {<point name="input.body3.m_update"/>}
               #end add-point
                  
               CASE
                  WHEN SQLCA.sqlerrd[3] = 0  #更新不到的處理
                     INITIALIZE g_errparam TO NULL 
                     LET g_errparam.extend = "glcf_t" 
                     LET g_errparam.code   = "std-00009" 
                     LET g_errparam.popup  = TRUE 
                     CALL cl_err()
                     CALL s_transaction_end('N','0')
                     LET g_glcf3_d[l_ac].* = g_glcf3_d_t.*
                  WHEN SQLCA.sqlcode #其他錯誤
                     INITIALIZE g_errparam TO NULL 
                     LET g_errparam.extend = "glcf_t" 
                     LET g_errparam.code   = SQLCA.sqlcode 
                     LET g_errparam.popup  = TRUE 
                     CALL cl_err()
                     CALL s_transaction_end('N','0')
                     LET g_glcf3_d[l_ac].* = g_glcf3_d_t.*
                  OTHERWISE
                                    INITIALIZE gs_keys TO NULL 
               LET gs_keys[1] = g_glce_m.glceld
               LET gs_keys_bak[1] = g_glceld_t
               LET gs_keys[2] = g_glce_m.glce001
               LET gs_keys_bak[2] = g_glce001_t
               LET gs_keys[3] = g_glce_m.glce002
               LET gs_keys_bak[3] = g_glce002_t
               LET gs_keys[4] = g_glcf3_d[g_detail_idx].glcf003
               LET gs_keys_bak[4] = g_glcf3_d_t.glcf003
               LET gs_keys[5] = g_glcf3_d[g_detail_idx].glcf004
               LET gs_keys_bak[5] = g_glcf3_d_t.glcf004
               LET gs_keys[6] = g_glcf3_d[g_detail_idx].glcf005
               LET gs_keys_bak[6] = g_glcf3_d_t.glcf005
               CALL aglt420_update_b('glcf_t',gs_keys,gs_keys_bak,"'3'")
                     #資料多語言用-增/改
                     
               END CASE
               
               #將遮罩欄位進行遮蔽
               CALL aglt420_glcf_t_mask_restore('restore_mask_n')
               
               #判斷key是否有改變
               INITIALIZE gs_keys TO NULL
               IF NOT (g_glcf3_d[g_detail_idx].glcf003 = g_glcf3_d_t.glcf003 
                  AND g_glcf3_d[g_detail_idx].glcf004 = g_glcf3_d_t.glcf004 
                  AND g_glcf3_d[g_detail_idx].glcf005 = g_glcf3_d_t.glcf005 
                  ) THEN
                  LET gs_keys[01] = g_glce_m.glceld
                  LET gs_keys[gs_keys.getLength()+1] = g_glce_m.glce001
                  LET gs_keys[gs_keys.getLength()+1] = g_glce_m.glce002
                  LET gs_keys[gs_keys.getLength()+1] = g_glcf3_d_t.glcf003
                  LET gs_keys[gs_keys.getLength()+1] = g_glcf3_d_t.glcf004
                  LET gs_keys[gs_keys.getLength()+1] = g_glcf3_d_t.glcf005
                  CALL aglt420_key_update_b(gs_keys,'glcf_t')
               END IF
               
               #修改歷程記錄(單身修改)
               LET g_log1 = util.JSON.stringify(g_glce_m),util.JSON.stringify(g_glcf3_d_t)
               LET g_log2 = util.JSON.stringify(g_glce_m),util.JSON.stringify(g_glcf3_d[l_ac])
               IF NOT cl_log_modified_record_d(g_log1,g_log2) THEN 
                  CALL s_transaction_end('N','0')
               END IF
               
               #add-point:單身page3修改後
               {<point name="input.body3.a_update"/>}
               #end add-point
            END IF
         
                  #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf003_3_desc
            #add-point:BEFORE FIELD glcf003_3_desc
            {<point name="input.b.page3.glcf003_3_desc" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf003_3_desc
            
            #add-point:AFTER FIELD glcf003_3_desc
            {<point name="input.a.page3.glcf003_3_desc" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE glcf003_3_desc
            #add-point:ON CHANGE glcf003_3_desc
            {<point name="input.g.page3.glcf003_3_desc" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf018
            #add-point:BEFORE FIELD glcf018
            {<point name="input.b.page3.glcf018" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf018
            
            #add-point:AFTER FIELD glcf018
            {<point name="input.a.page3.glcf018" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE glcf018
            #add-point:ON CHANGE glcf018
            {<point name="input.g.page3.glcf018" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf019
            #add-point:BEFORE FIELD glcf019
            {<point name="input.b.page3.glcf019" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf019
            
            #add-point:AFTER FIELD glcf019
            {<point name="input.a.page3.glcf019" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE glcf019
            #add-point:ON CHANGE glcf019
            {<point name="input.g.page3.glcf019" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf020
            #add-point:BEFORE FIELD glcf020
            {<point name="input.b.page3.glcf020" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf020
            
            #add-point:AFTER FIELD glcf020
            {<point name="input.a.page3.glcf020" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE glcf020
            #add-point:ON CHANGE glcf020
            {<point name="input.g.page3.glcf020" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf021
            #add-point:BEFORE FIELD glcf021
            {<point name="input.b.page3.glcf021" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf021
            
            #add-point:AFTER FIELD glcf021
            {<point name="input.a.page3.glcf021" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE glcf021
            #add-point:ON CHANGE glcf021
            {<point name="input.g.page3.glcf021" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf022
            #add-point:BEFORE FIELD glcf022
            {<point name="input.b.page3.glcf022" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf022
            
            #add-point:AFTER FIELD glcf022
            {<point name="input.a.page3.glcf022" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE glcf022
            #add-point:ON CHANGE glcf022
            {<point name="input.g.page3.glcf022" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD edit3
            #add-point:BEFORE FIELD edit3
            {<point name="input.b.page3.edit3" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD edit3
            
            #add-point:AFTER FIELD edit3
            {<point name="input.a.page3.edit3" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE edit3
            #add-point:ON CHANGE edit3
            {<point name="input.g.page3.edit3" />}
            #END add-point 
 
 
                  #Ctrlp:input.c.page3.glcf003_3_desc
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf003_3_desc
            #add-point:ON ACTION controlp INFIELD glcf003_3_desc
            {<point name="input.c.page3.glcf003_3_desc" />}
            #END add-point
 
         #Ctrlp:input.c.page3.glcf018
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf018
            #add-point:ON ACTION controlp INFIELD glcf018
            {<point name="input.c.page3.glcf018" />}
            #END add-point
 
         #Ctrlp:input.c.page3.glcf019
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf019
            #add-point:ON ACTION controlp INFIELD glcf019
            {<point name="input.c.page3.glcf019" />}
            #END add-point
 
         #Ctrlp:input.c.page3.glcf020
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf020
            #add-point:ON ACTION controlp INFIELD glcf020
            {<point name="input.c.page3.glcf020" />}
            #END add-point
 
         #Ctrlp:input.c.page3.glcf021
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf021
            #add-point:ON ACTION controlp INFIELD glcf021
            {<point name="input.c.page3.glcf021" />}
            #END add-point
 
         #Ctrlp:input.c.page3.glcf022
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf022
            #add-point:ON ACTION controlp INFIELD glcf022
            {<point name="input.c.page3.glcf022" />}
            #END add-point
 
         #Ctrlp:input.c.page3.edit3
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD edit3
            #add-point:ON ACTION controlp INFIELD edit3
            {<point name="input.c.page3.edit3" />}
            #END add-point
 
 
 
         AFTER ROW
            #add-point:單身page3 after_row
            {<point name="input.body3.after_row"/>}
            #end add-point
            LET l_ac = ARR_CURR()
            IF INT_FLAG THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = '' 
               LET g_errparam.code   = 9001 
               LET g_errparam.popup  = FALSE 
               CALL cl_err()
               LET INT_FLAG = 0
               IF l_cmd = 'u' THEN
                  LET g_glcf3_d[l_ac].* = g_glcf3_d_t.*
               END IF
               CLOSE aglt420_bcl
               CALL s_transaction_end('N','0')
               EXIT DIALOG 
            END IF
            
            #其他table進行unlock
            
            CALL aglt420_unlock_b("glcf_t","'3'")
            CALL s_transaction_end('Y','0')
            #add-point:單身page3 after_row2
            {<point name="input.body3.after_row2"/>}
            #end add-point
 
         AFTER INPUT
            #add-point:input段after input 
            {<point name="input.body3.after_input"/>}
            #end add-point   
    
         ON ACTION controlo
            CALL FGL_SET_ARR_CURR(g_glcf3_d.getLength()+1)
            LET lb_reproduce = TRUE
            LET li_reproduce = l_ac
            LET li_reproduce_target = g_glcf3_d.getLength()+1
 
      END INPUT
      INPUT ARRAY g_glcf4_d FROM s_detail4.*
         ATTRIBUTE(COUNT = g_rec_b,WITHOUT DEFAULTS, #MAXCOUNT = g_max_rec,
                 INSERT ROW = FALSE, #此頁面insert功能由產生器控制, 手動之設定無效! 

                 DELETE ROW = FALSE,
                 APPEND ROW = FALSE)
                 
         #自訂ACTION(detail_input,page_4)
         
         
         BEFORE INPUT
            #add-point:資料輸入前
            {<point name="input.body4.before_input2"/>}
            #end add-point
            
            CALL aglt420_b_fill()
            #如果一直都在單身1則控制筆數位置
            IF g_loc = 'd' AND g_rec_b != 0 THEN
               CALL FGL_SET_ARR_CURR(g_detail_idx)
            END IF
            LET g_loc = 'd'
            LET g_rec_b = g_glcf4_d.getLength()
            #add-point:資料輸入前
            {<point name="input.body4.before_input"/>}
            #end add-point
            
         BEFORE INSERT
            LET g_insert = 'Y' 
            NEXT FIELD glcf003
 
            LET l_insert = TRUE
            LET l_n = ARR_COUNT()
            LET l_cmd = 'a'
            INITIALIZE g_glcf4_d[l_ac].* TO NULL 
            INITIALIZE g_glcf4_d_t.* TO NULL 
            INITIALIZE g_glcf4_d_o.* TO NULL 
            #公用欄位給值(單身4)
            
            #自定義預設值(單身4)
            
            #add-point:modify段before備份
            {<point name="input.body4.insert.before_bak"/>}
            #end add-point
            LET g_glcf4_d_t.* = g_glcf4_d[l_ac].*     #新輸入資料
            LET g_glcf4_d_o.* = g_glcf4_d[l_ac].*     #新輸入資料
            CALL cl_show_fld_cont()
            CALL aglt420_set_entry_b(l_cmd)
            #add-point:modify段after_set_entry_b
            {<point name="input.body4.insert.after_set_entry_b"/>}
            #end add-point
            CALL aglt420_set_no_entry_b(l_cmd)
            IF lb_reproduce THEN
               LET lb_reproduce = FALSE
               LET g_glcf_d[li_reproduce_target].* = g_glcf_d[li_reproduce].*
               LET g_glcf2_d[li_reproduce_target].* = g_glcf2_d[li_reproduce].*
               LET g_glcf3_d[li_reproduce_target].* = g_glcf3_d[li_reproduce].*
               LET g_glcf4_d[li_reproduce_target].* = g_glcf4_d[li_reproduce].*
 
               LET g_glcf4_d[li_reproduce_target].glcf003 = NULL
               LET g_glcf4_d[li_reproduce_target].glcf004 = NULL
               LET g_glcf4_d[li_reproduce_target].glcf005 = NULL
            END IF
            
            #add-point:modify段before insert
            {<point name="input.body4.before_insert"/>}
            #end add-point  
            
         BEFORE ROW     
            #add-point:modify段before row2
            {<point name="input.body4.before_row2"/>}
            #end add-point  
            LET l_insert = FALSE
            LET l_cmd = ''
            LET l_ac = ARR_CURR()
            LET g_detail_idx = l_ac
            LET g_current_page = 4
              
            LET l_lock_sw = 'N'            #DEFAULT
            LET l_n = ARR_COUNT()
            DISPLAY l_ac TO FORMONLY.idx
         
            CALL s_transaction_begin()
            OPEN aglt420_cl USING g_enterprise,g_glce_m.glceld,g_glce_m.glce001,g_glce_m.glce002
            IF STATUS THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = "OPEN aglt420_cl:" 
               LET g_errparam.code   = STATUS 
               LET g_errparam.popup  = TRUE 
               CALL cl_err()
               CLOSE aglt420_cl
               CALL s_transaction_end('N','0')
               RETURN
            END IF
            
            LET g_rec_b = g_glcf4_d.getLength()
            
            IF g_rec_b >= l_ac 
               AND g_glcf4_d[l_ac].glcf003 IS NOT NULL
               AND g_glcf4_d[l_ac].glcf004 IS NOT NULL
               AND g_glcf4_d[l_ac].glcf005 IS NOT NULL
            THEN 
               LET l_cmd='u'
               LET g_glcf4_d_t.* = g_glcf4_d[l_ac].*  #BACKUP
               LET g_glcf4_d_o.* = g_glcf4_d[l_ac].*  #BACKUP
               CALL aglt420_set_entry_b(l_cmd)
               #add-point:modify段after_set_entry_b
               {<point name="input.body4.after_set_entry_b"/>}
               #end add-point  
               CALL aglt420_set_no_entry_b(l_cmd)
               IF NOT aglt420_lock_b("glcf_t","'4'") THEN
                  LET l_lock_sw='Y'
               ELSE
                  FETCH aglt420_bcl INTO g_glcf_d[l_ac].glcf003,g_glcf_d[l_ac].glcf004,g_glcf_d[l_ac].glcf005, 
                      g_glcf_d[l_ac].glcf006,g_glcf_d[l_ac].glcf007,g_glcf_d[l_ac].glcf008,g_glcf_d[l_ac].glcf009, 
                      g_glcf_d[l_ac].glcf010,g_glcf_d[l_ac].glcf011,g_glcf_d[l_ac].glcf012,g_glcf_d[l_ac].glcf073, 
                      g_glcf2_d[l_ac].glcf003,g_glcf2_d[l_ac].glcf004,g_glcf2_d[l_ac].glcf005,g_glcf2_d[l_ac].glcf013, 
                      g_glcf2_d[l_ac].glcf014,g_glcf2_d[l_ac].glcf015,g_glcf2_d[l_ac].glcf016,g_glcf2_d[l_ac].glcf017, 
                      g_glcf3_d[l_ac].glcf003,g_glcf3_d[l_ac].glcf004,g_glcf3_d[l_ac].glcf005,g_glcf3_d[l_ac].glcf018, 
                      g_glcf3_d[l_ac].glcf019,g_glcf3_d[l_ac].glcf020,g_glcf3_d[l_ac].glcf021,g_glcf3_d[l_ac].glcf022, 
                      g_glcf4_d[l_ac].glcf003,g_glcf4_d[l_ac].glcf004,g_glcf4_d[l_ac].glcf005,g_glcf4_d[l_ac].glcf047, 
                      g_glcf4_d[l_ac].glcf048,g_glcf4_d[l_ac].glcf049,g_glcf4_d[l_ac].glcf050,g_glcf4_d[l_ac].glcf051, 
                      g_glcf4_d[l_ac].glcf052,g_glcf4_d[l_ac].glcf053,g_glcf4_d[l_ac].glcf054,g_glcf4_d[l_ac].glcf055, 
                      g_glcf4_d[l_ac].glcf056,g_glcf4_d[l_ac].glcf057,g_glcf4_d[l_ac].glcf058,g_glcf4_d[l_ac].glcf059, 
                      g_glcf4_d[l_ac].glcf060,g_glcf4_d[l_ac].glcf061,g_glcf4_d[l_ac].glcf062,g_glcf4_d[l_ac].glcf063, 
                      g_glcf4_d[l_ac].glcf064,g_glcf4_d[l_ac].glcf065,g_glcf4_d[l_ac].glcf066,g_glcf4_d[l_ac].glcf067, 
                      g_glcf4_d[l_ac].glcf068,g_glcf4_d[l_ac].glcf069,g_glcf4_d[l_ac].glcf070,g_glcf4_d[l_ac].glcf071, 
                      g_glcf4_d[l_ac].glcf072
                  IF SQLCA.sqlcode THEN
                     INITIALIZE g_errparam TO NULL 
                     LET g_errparam.extend = '' 
                     LET g_errparam.code   = SQLCA.sqlcode 
                     LET g_errparam.popup  = TRUE 
                     CALL cl_err()
                     LET l_lock_sw = "Y"
                  END IF
                  
                  #遮罩相關處理
                  LET g_glcf4_d_mask_o[l_ac].* =  g_glcf4_d[l_ac].*
                  CALL aglt420_glcf_t_mask()
                  LET g_glcf4_d_mask_n[l_ac].* =  g_glcf4_d[l_ac].*
                  
                  LET g_bfill = "N"
                  CALL aglt420_show()
                  LET g_bfill = "Y"
                  
                  CALL cl_show_fld_cont()
               END IF
            ELSE
               LET l_cmd='a'
            END IF
            #add-point:modify段before row
            {<point name="input.body4.before_row"/>}
            #end add-point  
            #其他table資料備份(確定是否更改用)
            
            #其他table進行lock
            
            
         BEFORE DELETE                            #是否取消單身
            IF l_cmd = 'a' THEN
               LET l_cmd='d'
               #add-point:單身AFTER DELETE (=d)
               {<point name="input.body4.after_delete_d"/>}
               #end add-point
            ELSE
               IF NOT cl_ask_del_detail() THEN
                  CANCEL DELETE
               END IF
               IF l_lock_sw = "Y" THEN
                  INITIALIZE g_errparam TO NULL 
                  LET g_errparam.extend = "" 
                  LET g_errparam.code   = -263 
                  LET g_errparam.popup  = TRUE 
                  CALL cl_err()
                  CANCEL DELETE
               END IF
               
               #add-point:單身4刪除前
               {<point name="input.body4.b_delete" mark="Y"/>}
               #end add-point    
                  
               #取得該筆資料key值
               INITIALIZE gs_keys TO NULL
               LET gs_keys[01] = g_glce_m.glceld
               LET gs_keys[gs_keys.getLength()+1] = g_glce_m.glce001
               LET gs_keys[gs_keys.getLength()+1] = g_glce_m.glce002
               LET gs_keys[gs_keys.getLength()+1] = g_glcf4_d_t.glcf003
               LET gs_keys[gs_keys.getLength()+1] = g_glcf4_d_t.glcf004
               LET gs_keys[gs_keys.getLength()+1] = g_glcf4_d_t.glcf005
            
               #刪除同層單身
               IF NOT aglt420_delete_b('glcf_t',gs_keys,"'4'") THEN
                  CALL s_transaction_end('N','0')
                  CLOSE aglt420_bcl
                  CANCEL DELETE
               END IF
    
               #刪除下層單身
               IF NOT aglt420_key_delete_b(gs_keys,'glcf_t') THEN
                  CALL s_transaction_end('N','0')
                  CLOSE aglt420_bcl
                  CANCEL DELETE
               END IF
               
               #刪除多語言
               
               
               #add-point:單身4刪除中
               {<point name="input.body4.m_delete"/>}
               #end add-point    
               
               CALL s_transaction_end('Y','0')
               CLOSE aglt420_bcl
               LET g_rec_b = g_rec_b-1
               
               #add-point:單身4刪除後
               {<point name="input.body4.a_delete"/>}
               #end add-point
               LET l_count = g_glcf_d.getLength()
               
               #add-point:單身刪除後(<>d)
               {<point name="input.body4.after_delete"/>}
               #end add-point
            END IF 
         AFTER DELETE
            #如果是最後一筆
            IF l_ac = (g_glcf4_d.getLength() + 1) THEN
               CALL FGL_SET_ARR_CURR(l_ac-1)
            END IF
 
         AFTER INSERT    
            LET l_insert = FALSE
            IF INT_FLAG THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = '' 
               LET g_errparam.code   = 9001 
               LET g_errparam.popup  = FALSE 
               CALL cl_err()
               LET INT_FLAG = 0
               CANCEL INSERT
            END IF
               
            #add-point:單身4新增前
            {<point name="input.body4.b_a_insert"/>}
            #end add-point
               
            LET l_count = 1  
            SELECT COUNT(*) INTO l_count FROM glcf_t 
             WHERE glcfent = g_enterprise AND glcfld = g_glce_m.glceld
               AND glcf001 = g_glce_m.glce001
               AND glcf002 = g_glce_m.glce002
               AND glcf003 = g_glcf4_d[l_ac].glcf003
               AND glcf004 = g_glcf4_d[l_ac].glcf004
               AND glcf005 = g_glcf4_d[l_ac].glcf005
                
            #資料未重複, 插入新增資料
            IF l_count = 0 THEN 
               #add-point:單身4新增前
               {<point name="input.body4.b_insert"/>}
               #end add-point
            
                              INITIALIZE gs_keys TO NULL 
               LET gs_keys[1] = g_glce_m.glceld
               LET gs_keys[2] = g_glce_m.glce001
               LET gs_keys[3] = g_glce_m.glce002
               LET gs_keys[4] = g_glcf4_d[g_detail_idx].glcf003
               LET gs_keys[5] = g_glcf4_d[g_detail_idx].glcf004
               LET gs_keys[6] = g_glcf4_d[g_detail_idx].glcf005
               CALL aglt420_insert_b('glcf_t',gs_keys,"'4'")
                           
               #add-point:單身新增後4
               {<point name="input.body4.a_insert"/>}
               #end add-point
            ELSE    
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = 'INSERT' 
               LET g_errparam.code   = "std-00006" 
               LET g_errparam.popup  = TRUE 
               CALL cl_err()
               INITIALIZE g_glcf_d[l_ac].* TO NULL
               CALL s_transaction_end('N','0')
               CANCEL INSERT
            END IF
 
            IF SQLCA.SQLcode  THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = "glcf_t" 
               LET g_errparam.code   = SQLCA.sqlcode 
               LET g_errparam.popup  = TRUE 
               CALL cl_err()
               CALL s_transaction_end('N','0')                    
               CANCEL INSERT
            ELSE
               #先刷新資料
               #CALL aglt420_b_fill()
               #資料多語言用-增/改
               
               #add-point:單身新增後
               {<point name="input.body4.after_insert"/>}
               #end add-point
               CALL s_transaction_end('Y','0')
               #ERROR 'INSERT O.K'
               LET g_rec_b = g_rec_b + 1
            END IF
            
         ON ROW CHANGE 
            IF INT_FLAG THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = '' 
               LET g_errparam.code   = 9001 
               LET g_errparam.popup  = FALSE 
               CALL cl_err()
               LET INT_FLAG = 0
               LET g_glcf4_d[l_ac].* = g_glcf4_d_t.*
               CLOSE aglt420_bcl
               CALL s_transaction_end('N','0')
               EXIT DIALOG 
            END IF
            
            IF l_lock_sw = 'Y' THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = '' 
               LET g_errparam.code   = -263 
               LET g_errparam.popup  = TRUE 
               CALL cl_err()
               LET g_glcf4_d[l_ac].* = g_glcf4_d_t.*
            ELSE
               #add-point:單身page4修改前
               {<point name="input.body4.b_update" mark="Y"/>}
               #end add-point
               
               #寫入修改者/修改日期資訊(單身4)
               
               
               #將遮罩欄位還原
               CALL aglt420_glcf_t_mask_restore('restore_mask_o')
                              
               UPDATE glcf_t SET (glcfld,glcf001,glcf002,glcf003,glcf004,glcf005,glcf006,glcf007,glcf008, 
                   glcf009,glcf010,glcf011,glcf012,glcf073,glcf013,glcf014,glcf015,glcf016,glcf017,glcf018, 
                   glcf019,glcf020,glcf021,glcf022,glcf047,glcf048,glcf049,glcf050,glcf051,glcf052,glcf053, 
                   glcf054,glcf055,glcf056,glcf057,glcf058,glcf059,glcf060,glcf061,glcf062,glcf063,glcf064, 
                   glcf065,glcf066,glcf067,glcf068,glcf069,glcf070,glcf071,glcf072) = (g_glce_m.glceld, 
                   g_glce_m.glce001,g_glce_m.glce002,g_glcf_d[l_ac].glcf003,g_glcf_d[l_ac].glcf004,g_glcf_d[l_ac].glcf005, 
                   g_glcf_d[l_ac].glcf006,g_glcf_d[l_ac].glcf007,g_glcf_d[l_ac].glcf008,g_glcf_d[l_ac].glcf009, 
                   g_glcf_d[l_ac].glcf010,g_glcf_d[l_ac].glcf011,g_glcf_d[l_ac].glcf012,g_glcf_d[l_ac].glcf073, 
                   g_glcf2_d[l_ac].glcf013,g_glcf2_d[l_ac].glcf014,g_glcf2_d[l_ac].glcf015,g_glcf2_d[l_ac].glcf016, 
                   g_glcf2_d[l_ac].glcf017,g_glcf3_d[l_ac].glcf018,g_glcf3_d[l_ac].glcf019,g_glcf3_d[l_ac].glcf020, 
                   g_glcf3_d[l_ac].glcf021,g_glcf3_d[l_ac].glcf022,g_glcf4_d[l_ac].glcf047,g_glcf4_d[l_ac].glcf048, 
                   g_glcf4_d[l_ac].glcf049,g_glcf4_d[l_ac].glcf050,g_glcf4_d[l_ac].glcf051,g_glcf4_d[l_ac].glcf052, 
                   g_glcf4_d[l_ac].glcf053,g_glcf4_d[l_ac].glcf054,g_glcf4_d[l_ac].glcf055,g_glcf4_d[l_ac].glcf056, 
                   g_glcf4_d[l_ac].glcf057,g_glcf4_d[l_ac].glcf058,g_glcf4_d[l_ac].glcf059,g_glcf4_d[l_ac].glcf060, 
                   g_glcf4_d[l_ac].glcf061,g_glcf4_d[l_ac].glcf062,g_glcf4_d[l_ac].glcf063,g_glcf4_d[l_ac].glcf064, 
                   g_glcf4_d[l_ac].glcf065,g_glcf4_d[l_ac].glcf066,g_glcf4_d[l_ac].glcf067,g_glcf4_d[l_ac].glcf068, 
                   g_glcf4_d[l_ac].glcf069,g_glcf4_d[l_ac].glcf070,g_glcf4_d[l_ac].glcf071,g_glcf4_d[l_ac].glcf072)  
                   #自訂欄位頁簽
                WHERE glcfent = g_enterprise AND glcfld = g_glce_m.glceld
                  AND glcf001 = g_glce_m.glce001
                  AND glcf002 = g_glce_m.glce002
                  AND glcf003 = g_glcf4_d_t.glcf003 #項次 
                  AND glcf004 = g_glcf4_d_t.glcf004
                  AND glcf005 = g_glcf4_d_t.glcf005
                  
               #add-point:單身page4修改中
               {<point name="input.body4.m_update"/>}
               #end add-point
                  
               CASE
                  WHEN SQLCA.sqlerrd[3] = 0  #更新不到的處理
                     INITIALIZE g_errparam TO NULL 
                     LET g_errparam.extend = "glcf_t" 
                     LET g_errparam.code   = "std-00009" 
                     LET g_errparam.popup  = TRUE 
                     CALL cl_err()
                     CALL s_transaction_end('N','0')
                     LET g_glcf4_d[l_ac].* = g_glcf4_d_t.*
                  WHEN SQLCA.sqlcode #其他錯誤
                     INITIALIZE g_errparam TO NULL 
                     LET g_errparam.extend = "glcf_t" 
                     LET g_errparam.code   = SQLCA.sqlcode 
                     LET g_errparam.popup  = TRUE 
                     CALL cl_err()
                     CALL s_transaction_end('N','0')
                     LET g_glcf4_d[l_ac].* = g_glcf4_d_t.*
                  OTHERWISE
                                    INITIALIZE gs_keys TO NULL 
               LET gs_keys[1] = g_glce_m.glceld
               LET gs_keys_bak[1] = g_glceld_t
               LET gs_keys[2] = g_glce_m.glce001
               LET gs_keys_bak[2] = g_glce001_t
               LET gs_keys[3] = g_glce_m.glce002
               LET gs_keys_bak[3] = g_glce002_t
               LET gs_keys[4] = g_glcf4_d[g_detail_idx].glcf003
               LET gs_keys_bak[4] = g_glcf4_d_t.glcf003
               LET gs_keys[5] = g_glcf4_d[g_detail_idx].glcf004
               LET gs_keys_bak[5] = g_glcf4_d_t.glcf004
               LET gs_keys[6] = g_glcf4_d[g_detail_idx].glcf005
               LET gs_keys_bak[6] = g_glcf4_d_t.glcf005
               CALL aglt420_update_b('glcf_t',gs_keys,gs_keys_bak,"'4'")
                     #資料多語言用-增/改
                     
               END CASE
               
               #將遮罩欄位進行遮蔽
               CALL aglt420_glcf_t_mask_restore('restore_mask_n')
               
               #判斷key是否有改變
               INITIALIZE gs_keys TO NULL
               IF NOT (g_glcf4_d[g_detail_idx].glcf003 = g_glcf4_d_t.glcf003 
                  AND g_glcf4_d[g_detail_idx].glcf004 = g_glcf4_d_t.glcf004 
                  AND g_glcf4_d[g_detail_idx].glcf005 = g_glcf4_d_t.glcf005 
                  ) THEN
                  LET gs_keys[01] = g_glce_m.glceld
                  LET gs_keys[gs_keys.getLength()+1] = g_glce_m.glce001
                  LET gs_keys[gs_keys.getLength()+1] = g_glce_m.glce002
                  LET gs_keys[gs_keys.getLength()+1] = g_glcf4_d_t.glcf003
                  LET gs_keys[gs_keys.getLength()+1] = g_glcf4_d_t.glcf004
                  LET gs_keys[gs_keys.getLength()+1] = g_glcf4_d_t.glcf005
                  CALL aglt420_key_update_b(gs_keys,'glcf_t')
               END IF
               
               #修改歷程記錄(單身修改)
               LET g_log1 = util.JSON.stringify(g_glce_m),util.JSON.stringify(g_glcf4_d_t)
               LET g_log2 = util.JSON.stringify(g_glce_m),util.JSON.stringify(g_glcf4_d[l_ac])
               IF NOT cl_log_modified_record_d(g_log1,g_log2) THEN 
                  CALL s_transaction_end('N','0')
               END IF
               
               #add-point:單身page4修改後
               {<point name="input.body4.a_update"/>}
               #end add-point
            END IF
         
                  #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf003_4_desc
            #add-point:BEFORE FIELD glcf003_4_desc
            {<point name="input.b.page4.glcf003_4_desc" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf003_4_desc
            
            #add-point:AFTER FIELD glcf003_4_desc
            {<point name="input.a.page4.glcf003_4_desc" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE glcf003_4_desc
            #add-point:ON CHANGE glcf003_4_desc
            {<point name="input.g.page4.glcf003_4_desc" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf047
            #add-point:BEFORE FIELD glcf047
            {<point name="input.b.page4.glcf047" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf047
            
            #add-point:AFTER FIELD glcf047
            {<point name="input.a.page4.glcf047" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE glcf047
            #add-point:ON CHANGE glcf047
            {<point name="input.g.page4.glcf047" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf047_desc
            #add-point:BEFORE FIELD glcf047_desc
            {<point name="input.b.page4.glcf047_desc" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf047_desc
            
            #add-point:AFTER FIELD glcf047_desc
            {<point name="input.a.page4.glcf047_desc" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE glcf047_desc
            #add-point:ON CHANGE glcf047_desc
            {<point name="input.g.page4.glcf047_desc" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf048
            #add-point:BEFORE FIELD glcf048
            {<point name="input.b.page4.glcf048" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf048
            
            #add-point:AFTER FIELD glcf048
            {<point name="input.a.page4.glcf048" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE glcf048
            #add-point:ON CHANGE glcf048
            {<point name="input.g.page4.glcf048" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf048_desc
            #add-point:BEFORE FIELD glcf048_desc
            {<point name="input.b.page4.glcf048_desc" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf048_desc
            
            #add-point:AFTER FIELD glcf048_desc
            {<point name="input.a.page4.glcf048_desc" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE glcf048_desc
            #add-point:ON CHANGE glcf048_desc
            {<point name="input.g.page4.glcf048_desc" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf049
            #add-point:BEFORE FIELD glcf049
            {<point name="input.b.page4.glcf049" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf049
            
            #add-point:AFTER FIELD glcf049
            {<point name="input.a.page4.glcf049" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE glcf049
            #add-point:ON CHANGE glcf049
            {<point name="input.g.page4.glcf049" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf049_desc
            #add-point:BEFORE FIELD glcf049_desc
            {<point name="input.b.page4.glcf049_desc" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf049_desc
            
            #add-point:AFTER FIELD glcf049_desc
            {<point name="input.a.page4.glcf049_desc" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE glcf049_desc
            #add-point:ON CHANGE glcf049_desc
            {<point name="input.g.page4.glcf049_desc" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf050
            #add-point:BEFORE FIELD glcf050
            {<point name="input.b.page4.glcf050" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf050
            
            #add-point:AFTER FIELD glcf050
            {<point name="input.a.page4.glcf050" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE glcf050
            #add-point:ON CHANGE glcf050
            {<point name="input.g.page4.glcf050" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf050_desc
            #add-point:BEFORE FIELD glcf050_desc
            {<point name="input.b.page4.glcf050_desc" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf050_desc
            
            #add-point:AFTER FIELD glcf050_desc
            {<point name="input.a.page4.glcf050_desc" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE glcf050_desc
            #add-point:ON CHANGE glcf050_desc
            {<point name="input.g.page4.glcf050_desc" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf051
            #add-point:BEFORE FIELD glcf051
            {<point name="input.b.page4.glcf051" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf051
            
            #add-point:AFTER FIELD glcf051
            {<point name="input.a.page4.glcf051" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE glcf051
            #add-point:ON CHANGE glcf051
            {<point name="input.g.page4.glcf051" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf051_desc
            #add-point:BEFORE FIELD glcf051_desc
            {<point name="input.b.page4.glcf051_desc" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf051_desc
            
            #add-point:AFTER FIELD glcf051_desc
            {<point name="input.a.page4.glcf051_desc" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE glcf051_desc
            #add-point:ON CHANGE glcf051_desc
            {<point name="input.g.page4.glcf051_desc" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf052
            #add-point:BEFORE FIELD glcf052
            {<point name="input.b.page4.glcf052" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf052
            
            #add-point:AFTER FIELD glcf052
            {<point name="input.a.page4.glcf052" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE glcf052
            #add-point:ON CHANGE glcf052
            {<point name="input.g.page4.glcf052" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf052_desc
            #add-point:BEFORE FIELD glcf052_desc
            {<point name="input.b.page4.glcf052_desc" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf052_desc
            
            #add-point:AFTER FIELD glcf052_desc
            {<point name="input.a.page4.glcf052_desc" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE glcf052_desc
            #add-point:ON CHANGE glcf052_desc
            {<point name="input.g.page4.glcf052_desc" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf053
            #add-point:BEFORE FIELD glcf053
            {<point name="input.b.page4.glcf053" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf053
            
            #add-point:AFTER FIELD glcf053
            {<point name="input.a.page4.glcf053" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE glcf053
            #add-point:ON CHANGE glcf053
            {<point name="input.g.page4.glcf053" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf053_desc
            #add-point:BEFORE FIELD glcf053_desc
            {<point name="input.b.page4.glcf053_desc" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf053_desc
            
            #add-point:AFTER FIELD glcf053_desc
            {<point name="input.a.page4.glcf053_desc" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE glcf053_desc
            #add-point:ON CHANGE glcf053_desc
            {<point name="input.g.page4.glcf053_desc" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf054
            #add-point:BEFORE FIELD glcf054
            {<point name="input.b.page4.glcf054" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf054
            
            #add-point:AFTER FIELD glcf054
            {<point name="input.a.page4.glcf054" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE glcf054
            #add-point:ON CHANGE glcf054
            {<point name="input.g.page4.glcf054" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf054_desc
            #add-point:BEFORE FIELD glcf054_desc
            {<point name="input.b.page4.glcf054_desc" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf054_desc
            
            #add-point:AFTER FIELD glcf054_desc
            {<point name="input.a.page4.glcf054_desc" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE glcf054_desc
            #add-point:ON CHANGE glcf054_desc
            {<point name="input.g.page4.glcf054_desc" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf055
            #add-point:BEFORE FIELD glcf055
            {<point name="input.b.page4.glcf055" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf055
            
            #add-point:AFTER FIELD glcf055
            {<point name="input.a.page4.glcf055" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE glcf055
            #add-point:ON CHANGE glcf055
            {<point name="input.g.page4.glcf055" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf055_desc
            #add-point:BEFORE FIELD glcf055_desc
            {<point name="input.b.page4.glcf055_desc" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf055_desc
            
            #add-point:AFTER FIELD glcf055_desc
            {<point name="input.a.page4.glcf055_desc" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE glcf055_desc
            #add-point:ON CHANGE glcf055_desc
            {<point name="input.g.page4.glcf055_desc" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf056
            #add-point:BEFORE FIELD glcf056
            {<point name="input.b.page4.glcf056" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf056
            
            #add-point:AFTER FIELD glcf056
            {<point name="input.a.page4.glcf056" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE glcf056
            #add-point:ON CHANGE glcf056
            {<point name="input.g.page4.glcf056" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf057
            #add-point:BEFORE FIELD glcf057
            {<point name="input.b.page4.glcf057" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf057
            
            #add-point:AFTER FIELD glcf057
            {<point name="input.a.page4.glcf057" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE glcf057
            #add-point:ON CHANGE glcf057
            {<point name="input.g.page4.glcf057" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf057_desc
            #add-point:BEFORE FIELD glcf057_desc
            {<point name="input.b.page4.glcf057_desc" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf057_desc
            
            #add-point:AFTER FIELD glcf057_desc
            {<point name="input.a.page4.glcf057_desc" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE glcf057_desc
            #add-point:ON CHANGE glcf057_desc
            {<point name="input.g.page4.glcf057_desc" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf058
            #add-point:BEFORE FIELD glcf058
            {<point name="input.b.page4.glcf058" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf058
            
            #add-point:AFTER FIELD glcf058
            {<point name="input.a.page4.glcf058" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE glcf058
            #add-point:ON CHANGE glcf058
            {<point name="input.g.page4.glcf058" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf058_desc
            #add-point:BEFORE FIELD glcf058_desc
            {<point name="input.b.page4.glcf058_desc" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf058_desc
            
            #add-point:AFTER FIELD glcf058_desc
            {<point name="input.a.page4.glcf058_desc" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE glcf058_desc
            #add-point:ON CHANGE glcf058_desc
            {<point name="input.g.page4.glcf058_desc" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf059
            #add-point:BEFORE FIELD glcf059
            {<point name="input.b.page4.glcf059" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf059
            
            #add-point:AFTER FIELD glcf059
            {<point name="input.a.page4.glcf059" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE glcf059
            #add-point:ON CHANGE glcf059
            {<point name="input.g.page4.glcf059" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf059_desc
            #add-point:BEFORE FIELD glcf059_desc
            {<point name="input.b.page4.glcf059_desc" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf059_desc
            
            #add-point:AFTER FIELD glcf059_desc
            {<point name="input.a.page4.glcf059_desc" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE glcf059_desc
            #add-point:ON CHANGE glcf059_desc
            {<point name="input.g.page4.glcf059_desc" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf060
            #add-point:BEFORE FIELD glcf060
            {<point name="input.b.page4.glcf060" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf060
            
            #add-point:AFTER FIELD glcf060
            {<point name="input.a.page4.glcf060" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE glcf060
            #add-point:ON CHANGE glcf060
            {<point name="input.g.page4.glcf060" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf060_desc
            #add-point:BEFORE FIELD glcf060_desc
            {<point name="input.b.page4.glcf060_desc" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf060_desc
            
            #add-point:AFTER FIELD glcf060_desc
            {<point name="input.a.page4.glcf060_desc" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE glcf060_desc
            #add-point:ON CHANGE glcf060_desc
            {<point name="input.g.page4.glcf060_desc" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf061
            #add-point:BEFORE FIELD glcf061
            {<point name="input.b.page4.glcf061" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf061
            
            #add-point:AFTER FIELD glcf061
            {<point name="input.a.page4.glcf061" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE glcf061
            #add-point:ON CHANGE glcf061
            {<point name="input.g.page4.glcf061" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf061_desc
            #add-point:BEFORE FIELD glcf061_desc
            {<point name="input.b.page4.glcf061_desc" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf061_desc
            
            #add-point:AFTER FIELD glcf061_desc
            {<point name="input.a.page4.glcf061_desc" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE glcf061_desc
            #add-point:ON CHANGE glcf061_desc
            {<point name="input.g.page4.glcf061_desc" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf062
            #add-point:BEFORE FIELD glcf062
            {<point name="input.b.page4.glcf062" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf062
            
            #add-point:AFTER FIELD glcf062
            {<point name="input.a.page4.glcf062" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE glcf062
            #add-point:ON CHANGE glcf062
            {<point name="input.g.page4.glcf062" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf062_desc
            #add-point:BEFORE FIELD glcf062_desc
            {<point name="input.b.page4.glcf062_desc" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf062_desc
            
            #add-point:AFTER FIELD glcf062_desc
            {<point name="input.a.page4.glcf062_desc" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE glcf062_desc
            #add-point:ON CHANGE glcf062_desc
            {<point name="input.g.page4.glcf062_desc" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf063
            #add-point:BEFORE FIELD glcf063
            {<point name="input.b.page4.glcf063" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf063
            
            #add-point:AFTER FIELD glcf063
            {<point name="input.a.page4.glcf063" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE glcf063
            #add-point:ON CHANGE glcf063
            {<point name="input.g.page4.glcf063" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf063_desc
            #add-point:BEFORE FIELD glcf063_desc
            {<point name="input.b.page4.glcf063_desc" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf063_desc
            
            #add-point:AFTER FIELD glcf063_desc
            {<point name="input.a.page4.glcf063_desc" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE glcf063_desc
            #add-point:ON CHANGE glcf063_desc
            {<point name="input.g.page4.glcf063_desc" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf064
            #add-point:BEFORE FIELD glcf064
            {<point name="input.b.page4.glcf064" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf064
            
            #add-point:AFTER FIELD glcf064
            {<point name="input.a.page4.glcf064" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE glcf064
            #add-point:ON CHANGE glcf064
            {<point name="input.g.page4.glcf064" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf064_desc
            #add-point:BEFORE FIELD glcf064_desc
            {<point name="input.b.page4.glcf064_desc" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf064_desc
            
            #add-point:AFTER FIELD glcf064_desc
            {<point name="input.a.page4.glcf064_desc" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE glcf064_desc
            #add-point:ON CHANGE glcf064_desc
            {<point name="input.g.page4.glcf064_desc" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf065
            #add-point:BEFORE FIELD glcf065
            {<point name="input.b.page4.glcf065" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf065
            
            #add-point:AFTER FIELD glcf065
            {<point name="input.a.page4.glcf065" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE glcf065
            #add-point:ON CHANGE glcf065
            {<point name="input.g.page4.glcf065" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf065_desc
            #add-point:BEFORE FIELD glcf065_desc
            {<point name="input.b.page4.glcf065_desc" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf065_desc
            
            #add-point:AFTER FIELD glcf065_desc
            {<point name="input.a.page4.glcf065_desc" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE glcf065_desc
            #add-point:ON CHANGE glcf065_desc
            {<point name="input.g.page4.glcf065_desc" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf066
            #add-point:BEFORE FIELD glcf066
            {<point name="input.b.page4.glcf066" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf066
            
            #add-point:AFTER FIELD glcf066
            {<point name="input.a.page4.glcf066" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE glcf066
            #add-point:ON CHANGE glcf066
            {<point name="input.g.page4.glcf066" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf066_desc
            #add-point:BEFORE FIELD glcf066_desc
            {<point name="input.b.page4.glcf066_desc" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf066_desc
            
            #add-point:AFTER FIELD glcf066_desc
            {<point name="input.a.page4.glcf066_desc" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE glcf066_desc
            #add-point:ON CHANGE glcf066_desc
            {<point name="input.g.page4.glcf066_desc" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf067
            #add-point:BEFORE FIELD glcf067
            {<point name="input.b.page4.glcf067" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf067
            
            #add-point:AFTER FIELD glcf067
            {<point name="input.a.page4.glcf067" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE glcf067
            #add-point:ON CHANGE glcf067
            {<point name="input.g.page4.glcf067" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf067_desc
            #add-point:BEFORE FIELD glcf067_desc
            {<point name="input.b.page4.glcf067_desc" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf067_desc
            
            #add-point:AFTER FIELD glcf067_desc
            {<point name="input.a.page4.glcf067_desc" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE glcf067_desc
            #add-point:ON CHANGE glcf067_desc
            {<point name="input.g.page4.glcf067_desc" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf068
            #add-point:BEFORE FIELD glcf068
            {<point name="input.b.page4.glcf068" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf068
            
            #add-point:AFTER FIELD glcf068
            {<point name="input.a.page4.glcf068" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE glcf068
            #add-point:ON CHANGE glcf068
            {<point name="input.g.page4.glcf068" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf068_desc
            #add-point:BEFORE FIELD glcf068_desc
            {<point name="input.b.page4.glcf068_desc" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf068_desc
            
            #add-point:AFTER FIELD glcf068_desc
            {<point name="input.a.page4.glcf068_desc" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE glcf068_desc
            #add-point:ON CHANGE glcf068_desc
            {<point name="input.g.page4.glcf068_desc" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf069
            #add-point:BEFORE FIELD glcf069
            {<point name="input.b.page4.glcf069" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf069
            
            #add-point:AFTER FIELD glcf069
            {<point name="input.a.page4.glcf069" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE glcf069
            #add-point:ON CHANGE glcf069
            {<point name="input.g.page4.glcf069" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf069_desc
            #add-point:BEFORE FIELD glcf069_desc
            {<point name="input.b.page4.glcf069_desc" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf069_desc
            
            #add-point:AFTER FIELD glcf069_desc
            {<point name="input.a.page4.glcf069_desc" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE glcf069_desc
            #add-point:ON CHANGE glcf069_desc
            {<point name="input.g.page4.glcf069_desc" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf070
            #add-point:BEFORE FIELD glcf070
            {<point name="input.b.page4.glcf070" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf070
            
            #add-point:AFTER FIELD glcf070
            {<point name="input.a.page4.glcf070" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE glcf070
            #add-point:ON CHANGE glcf070
            {<point name="input.g.page4.glcf070" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf070_desc
            #add-point:BEFORE FIELD glcf070_desc
            {<point name="input.b.page4.glcf070_desc" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf070_desc
            
            #add-point:AFTER FIELD glcf070_desc
            {<point name="input.a.page4.glcf070_desc" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE glcf070_desc
            #add-point:ON CHANGE glcf070_desc
            {<point name="input.g.page4.glcf070_desc" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf071
            #add-point:BEFORE FIELD glcf071
            {<point name="input.b.page4.glcf071" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf071
            
            #add-point:AFTER FIELD glcf071
            {<point name="input.a.page4.glcf071" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE glcf071
            #add-point:ON CHANGE glcf071
            {<point name="input.g.page4.glcf071" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf071_desc
            #add-point:BEFORE FIELD glcf071_desc
            {<point name="input.b.page4.glcf071_desc" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf071_desc
            
            #add-point:AFTER FIELD glcf071_desc
            {<point name="input.a.page4.glcf071_desc" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE glcf071_desc
            #add-point:ON CHANGE glcf071_desc
            {<point name="input.g.page4.glcf071_desc" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcf072
            #add-point:BEFORE FIELD glcf072
            {<point name="input.b.page4.glcf072" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcf072
            
            #add-point:AFTER FIELD glcf072
            {<point name="input.a.page4.glcf072" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE glcf072
            #add-point:ON CHANGE glcf072
            {<point name="input.g.page4.glcf072" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD edit4
            #add-point:BEFORE FIELD edit4
            {<point name="input.b.page4.edit4" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD edit4
            
            #add-point:AFTER FIELD edit4
            {<point name="input.a.page4.edit4" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE edit4
            #add-point:ON CHANGE edit4
            {<point name="input.g.page4.edit4" />}
            #END add-point 
 
 
                  #Ctrlp:input.c.page4.glcf003_4_desc
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf003_4_desc
            #add-point:ON ACTION controlp INFIELD glcf003_4_desc
            {<point name="input.c.page4.glcf003_4_desc" />}
            #END add-point
 
         #Ctrlp:input.c.page4.glcf047
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf047
            #add-point:ON ACTION controlp INFIELD glcf047
            {<point name="input.c.page4.glcf047" />}
            #END add-point
 
         #Ctrlp:input.c.page4.glcf047_desc
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf047_desc
            #add-point:ON ACTION controlp INFIELD glcf047_desc
            {<point name="input.c.page4.glcf047_desc" />}
            #END add-point
 
         #Ctrlp:input.c.page4.glcf048
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf048
            #add-point:ON ACTION controlp INFIELD glcf048
            {<point name="input.c.page4.glcf048" />}
            #END add-point
 
         #Ctrlp:input.c.page4.glcf048_desc
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf048_desc
            #add-point:ON ACTION controlp INFIELD glcf048_desc
            {<point name="input.c.page4.glcf048_desc" />}
            #END add-point
 
         #Ctrlp:input.c.page4.glcf049
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf049
            #add-point:ON ACTION controlp INFIELD glcf049
            {<point name="input.c.page4.glcf049" />}
            #END add-point
 
         #Ctrlp:input.c.page4.glcf049_desc
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf049_desc
            #add-point:ON ACTION controlp INFIELD glcf049_desc
            {<point name="input.c.page4.glcf049_desc" />}
            #END add-point
 
         #Ctrlp:input.c.page4.glcf050
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf050
            #add-point:ON ACTION controlp INFIELD glcf050
            {<point name="input.c.page4.glcf050" />}
            #END add-point
 
         #Ctrlp:input.c.page4.glcf050_desc
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf050_desc
            #add-point:ON ACTION controlp INFIELD glcf050_desc
            {<point name="input.c.page4.glcf050_desc" />}
            #END add-point
 
         #Ctrlp:input.c.page4.glcf051
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf051
            #add-point:ON ACTION controlp INFIELD glcf051
            {<point name="input.c.page4.glcf051" />}
            #END add-point
 
         #Ctrlp:input.c.page4.glcf051_desc
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf051_desc
            #add-point:ON ACTION controlp INFIELD glcf051_desc
            {<point name="input.c.page4.glcf051_desc" />}
            #END add-point
 
         #Ctrlp:input.c.page4.glcf052
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf052
            #add-point:ON ACTION controlp INFIELD glcf052
            {<point name="input.c.page4.glcf052" />}
            #END add-point
 
         #Ctrlp:input.c.page4.glcf052_desc
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf052_desc
            #add-point:ON ACTION controlp INFIELD glcf052_desc
            {<point name="input.c.page4.glcf052_desc" />}
            #END add-point
 
         #Ctrlp:input.c.page4.glcf053
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf053
            #add-point:ON ACTION controlp INFIELD glcf053
            {<point name="input.c.page4.glcf053" />}
            #END add-point
 
         #Ctrlp:input.c.page4.glcf053_desc
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf053_desc
            #add-point:ON ACTION controlp INFIELD glcf053_desc
            {<point name="input.c.page4.glcf053_desc" />}
            #END add-point
 
         #Ctrlp:input.c.page4.glcf054
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf054
            #add-point:ON ACTION controlp INFIELD glcf054
            {<point name="input.c.page4.glcf054" />}
            #END add-point
 
         #Ctrlp:input.c.page4.glcf054_desc
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf054_desc
            #add-point:ON ACTION controlp INFIELD glcf054_desc
            {<point name="input.c.page4.glcf054_desc" />}
            #END add-point
 
         #Ctrlp:input.c.page4.glcf055
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf055
            #add-point:ON ACTION controlp INFIELD glcf055
            {<point name="input.c.page4.glcf055" />}
            #END add-point
 
         #Ctrlp:input.c.page4.glcf055_desc
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf055_desc
            #add-point:ON ACTION controlp INFIELD glcf055_desc
            {<point name="input.c.page4.glcf055_desc" />}
            #END add-point
 
         #Ctrlp:input.c.page4.glcf056
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf056
            #add-point:ON ACTION controlp INFIELD glcf056
            {<point name="input.c.page4.glcf056" />}
            #END add-point
 
         #Ctrlp:input.c.page4.glcf057
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf057
            #add-point:ON ACTION controlp INFIELD glcf057
            {<point name="input.c.page4.glcf057" />}
            #END add-point
 
         #Ctrlp:input.c.page4.glcf057_desc
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf057_desc
            #add-point:ON ACTION controlp INFIELD glcf057_desc
            {<point name="input.c.page4.glcf057_desc" />}
            #END add-point
 
         #Ctrlp:input.c.page4.glcf058
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf058
            #add-point:ON ACTION controlp INFIELD glcf058
            {<point name="input.c.page4.glcf058" />}
            #END add-point
 
         #Ctrlp:input.c.page4.glcf058_desc
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf058_desc
            #add-point:ON ACTION controlp INFIELD glcf058_desc
            {<point name="input.c.page4.glcf058_desc" />}
            #END add-point
 
         #Ctrlp:input.c.page4.glcf059
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf059
            #add-point:ON ACTION controlp INFIELD glcf059
            {<point name="input.c.page4.glcf059" />}
            #END add-point
 
         #Ctrlp:input.c.page4.glcf059_desc
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf059_desc
            #add-point:ON ACTION controlp INFIELD glcf059_desc
            {<point name="input.c.page4.glcf059_desc" />}
            #END add-point
 
         #Ctrlp:input.c.page4.glcf060
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf060
            #add-point:ON ACTION controlp INFIELD glcf060
            {<point name="input.c.page4.glcf060" />}
            #END add-point
 
         #Ctrlp:input.c.page4.glcf060_desc
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf060_desc
            #add-point:ON ACTION controlp INFIELD glcf060_desc
            {<point name="input.c.page4.glcf060_desc" />}
            #END add-point
 
         #Ctrlp:input.c.page4.glcf061
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf061
            #add-point:ON ACTION controlp INFIELD glcf061
            {<point name="input.c.page4.glcf061" />}
            #END add-point
 
         #Ctrlp:input.c.page4.glcf061_desc
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf061_desc
            #add-point:ON ACTION controlp INFIELD glcf061_desc
            {<point name="input.c.page4.glcf061_desc" />}
            #END add-point
 
         #Ctrlp:input.c.page4.glcf062
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf062
            #add-point:ON ACTION controlp INFIELD glcf062
            {<point name="input.c.page4.glcf062" />}
            #END add-point
 
         #Ctrlp:input.c.page4.glcf062_desc
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf062_desc
            #add-point:ON ACTION controlp INFIELD glcf062_desc
            {<point name="input.c.page4.glcf062_desc" />}
            #END add-point
 
         #Ctrlp:input.c.page4.glcf063
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf063
            #add-point:ON ACTION controlp INFIELD glcf063
            {<point name="input.c.page4.glcf063" />}
            #END add-point
 
         #Ctrlp:input.c.page4.glcf063_desc
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf063_desc
            #add-point:ON ACTION controlp INFIELD glcf063_desc
            {<point name="input.c.page4.glcf063_desc" />}
            #END add-point
 
         #Ctrlp:input.c.page4.glcf064
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf064
            #add-point:ON ACTION controlp INFIELD glcf064
            {<point name="input.c.page4.glcf064" />}
            #END add-point
 
         #Ctrlp:input.c.page4.glcf064_desc
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf064_desc
            #add-point:ON ACTION controlp INFIELD glcf064_desc
            {<point name="input.c.page4.glcf064_desc" />}
            #END add-point
 
         #Ctrlp:input.c.page4.glcf065
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf065
            #add-point:ON ACTION controlp INFIELD glcf065
            {<point name="input.c.page4.glcf065" />}
            #END add-point
 
         #Ctrlp:input.c.page4.glcf065_desc
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf065_desc
            #add-point:ON ACTION controlp INFIELD glcf065_desc
            {<point name="input.c.page4.glcf065_desc" />}
            #END add-point
 
         #Ctrlp:input.c.page4.glcf066
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf066
            #add-point:ON ACTION controlp INFIELD glcf066
            {<point name="input.c.page4.glcf066" />}
            #END add-point
 
         #Ctrlp:input.c.page4.glcf066_desc
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf066_desc
            #add-point:ON ACTION controlp INFIELD glcf066_desc
            {<point name="input.c.page4.glcf066_desc" />}
            #END add-point
 
         #Ctrlp:input.c.page4.glcf067
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf067
            #add-point:ON ACTION controlp INFIELD glcf067
            {<point name="input.c.page4.glcf067" />}
            #END add-point
 
         #Ctrlp:input.c.page4.glcf067_desc
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf067_desc
            #add-point:ON ACTION controlp INFIELD glcf067_desc
            {<point name="input.c.page4.glcf067_desc" />}
            #END add-point
 
         #Ctrlp:input.c.page4.glcf068
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf068
            #add-point:ON ACTION controlp INFIELD glcf068
            {<point name="input.c.page4.glcf068" />}
            #END add-point
 
         #Ctrlp:input.c.page4.glcf068_desc
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf068_desc
            #add-point:ON ACTION controlp INFIELD glcf068_desc
            {<point name="input.c.page4.glcf068_desc" />}
            #END add-point
 
         #Ctrlp:input.c.page4.glcf069
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf069
            #add-point:ON ACTION controlp INFIELD glcf069
            {<point name="input.c.page4.glcf069" />}
            #END add-point
 
         #Ctrlp:input.c.page4.glcf069_desc
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf069_desc
            #add-point:ON ACTION controlp INFIELD glcf069_desc
            {<point name="input.c.page4.glcf069_desc" />}
            #END add-point
 
         #Ctrlp:input.c.page4.glcf070
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf070
            #add-point:ON ACTION controlp INFIELD glcf070
            {<point name="input.c.page4.glcf070" />}
            #END add-point
 
         #Ctrlp:input.c.page4.glcf070_desc
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf070_desc
            #add-point:ON ACTION controlp INFIELD glcf070_desc
            {<point name="input.c.page4.glcf070_desc" />}
            #END add-point
 
         #Ctrlp:input.c.page4.glcf071
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf071
            #add-point:ON ACTION controlp INFIELD glcf071
            {<point name="input.c.page4.glcf071" />}
            #END add-point
 
         #Ctrlp:input.c.page4.glcf071_desc
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf071_desc
            #add-point:ON ACTION controlp INFIELD glcf071_desc
            {<point name="input.c.page4.glcf071_desc" />}
            #END add-point
 
         #Ctrlp:input.c.page4.glcf072
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcf072
            #add-point:ON ACTION controlp INFIELD glcf072
            {<point name="input.c.page4.glcf072" />}
            #END add-point
 
         #Ctrlp:input.c.page4.edit4
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD edit4
            #add-point:ON ACTION controlp INFIELD edit4
            {<point name="input.c.page4.edit4" />}
            #END add-point
 
 
 
         AFTER ROW
            #add-point:單身page4 after_row
            {<point name="input.body4.after_row"/>}
            #end add-point
            LET l_ac = ARR_CURR()
            IF INT_FLAG THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = '' 
               LET g_errparam.code   = 9001 
               LET g_errparam.popup  = FALSE 
               CALL cl_err()
               LET INT_FLAG = 0
               IF l_cmd = 'u' THEN
                  LET g_glcf4_d[l_ac].* = g_glcf4_d_t.*
               END IF
               CLOSE aglt420_bcl
               CALL s_transaction_end('N','0')
               EXIT DIALOG 
            END IF
            
            #其他table進行unlock
            
            CALL aglt420_unlock_b("glcf_t","'4'")
            CALL s_transaction_end('Y','0')
            #add-point:單身page4 after_row2
            {<point name="input.body4.after_row2"/>}
            #end add-point
 
         AFTER INPUT
            #add-point:input段after input 
            {<point name="input.body4.after_input"/>}
            #end add-point   
    
         ON ACTION controlo
            CALL FGL_SET_ARR_CURR(g_glcf4_d.getLength()+1)
            LET lb_reproduce = TRUE
            LET li_reproduce = l_ac
            LET li_reproduce_target = g_glcf4_d.getLength()+1
 
      END INPUT
 
      
 
 
 
]]>
  </section>
  <section id="aglt420.input.head" ver="16" status="" src="s" readonly="">
    <![CDATA[      #單頭段
      INPUT BY NAME g_glce_m.glceld,g_glce_m.glce001,g_glce_m.glce002,g_glce_m.glce003,g_glce_m.glce004, 
          g_glce_m.glce006,g_glce_m.glce005,g_glce_m.glcedocno,g_glce_m.glcestus 
         ATTRIBUTE(WITHOUT DEFAULTS)
         
         #自訂ACTION(master_input)
         
     
         BEFORE INPUT
            IF s_transaction_chk("N",0) THEN
               CALL s_transaction_begin()
            END IF
            OPEN aglt420_cl USING g_enterprise,g_glce_m.glceld,g_glce_m.glce001,g_glce_m.glce002
            IF STATUS THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = "OPEN aglt420_cl:" 
               LET g_errparam.code   = STATUS 
               LET g_errparam.popup  = TRUE 
               CALL cl_err()
               CLOSE aglt420_cl
               CALL s_transaction_end('N','0')
               RETURN
            END IF
            
            IF l_cmd_t = 'r' THEN
               
            END IF
            #因應離開單頭後已寫入資料庫, 若重新回到單頭則視為修改
            #因此需於此處開啟/關閉欄位
            CALL aglt420_set_entry(p_cmd)
            #add-point:資料輸入前
            {<point name="input.m.before_input"/>}
            #end add-point
            CALL aglt420_set_no_entry(p_cmd)
    
                  #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glceld
            
            #add-point:AFTER FIELD glceld
            {<point name="input.a.glceld" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glceld
            #add-point:BEFORE FIELD glceld
            {<point name="input.b.glceld" />}
            #END add-point
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE glceld
            #add-point:ON CHANGE glceld
            {<point name="input.g.glceld" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glce001
            #add-point:BEFORE FIELD glce001
            {<point name="input.b.glce001" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glce001
            
            #add-point:AFTER FIELD glce001
            {<point name="input.a.glce001" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE glce001
            #add-point:ON CHANGE glce001
            {<point name="input.g.glce001" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glce002
            #add-point:BEFORE FIELD glce002
            {<point name="input.b.glce002" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glce002
            
            #add-point:AFTER FIELD glce002
            {<point name="input.a.glce002" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE glce002
            #add-point:ON CHANGE glce002
            {<point name="input.g.glce002" />}
            #END add-point 
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glce003
            
            #add-point:AFTER FIELD glce003
            {<point name="input.a.glce003" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glce003
            #add-point:BEFORE FIELD glce003
            {<point name="input.b.glce003" />}
            #END add-point
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE glce003
            #add-point:ON CHANGE glce003
            {<point name="input.g.glce003" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glce004
            #add-point:BEFORE FIELD glce004
            {<point name="input.b.glce004" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glce004
            
            #add-point:AFTER FIELD glce004
            {<point name="input.a.glce004" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE glce004
            #add-point:ON CHANGE glce004
            {<point name="input.g.glce004" />}
            #END add-point 
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glce006
            
            #add-point:AFTER FIELD glce006
            {<point name="input.a.glce006" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glce006
            #add-point:BEFORE FIELD glce006
            {<point name="input.b.glce006" />}
            #END add-point
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE glce006
            #add-point:ON CHANGE glce006
            {<point name="input.g.glce006" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glce005
            #add-point:BEFORE FIELD glce005
            {<point name="input.b.glce005" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glce005
            
            #add-point:AFTER FIELD glce005
            {<point name="input.a.glce005" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE glce005
            #add-point:ON CHANGE glce005
            {<point name="input.g.glce005" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcedocno
            #add-point:BEFORE FIELD glcedocno
            {<point name="input.b.glcedocno" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcedocno
            
            #add-point:AFTER FIELD glcedocno
            {<point name="input.a.glcedocno" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE glcedocno
            #add-point:ON CHANGE glcedocno
            {<point name="input.g.glcedocno" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD glcestus
            #add-point:BEFORE FIELD glcestus
            {<point name="input.b.glcestus" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD glcestus
            
            #add-point:AFTER FIELD glcestus
            {<point name="input.a.glcestus" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE glcestus
            #add-point:ON CHANGE glcestus
            {<point name="input.g.glcestus" />}
            #END add-point 
 
 #欄位檢查
                  #Ctrlp:input.c.glceld
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glceld
            #add-point:ON ACTION controlp INFIELD glceld
            {<point name="input.c.glceld" />}
            #END add-point
 
         #Ctrlp:input.c.glce001
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glce001
            #add-point:ON ACTION controlp INFIELD glce001
            {<point name="input.c.glce001" />}
            #END add-point
 
         #Ctrlp:input.c.glce002
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glce002
            #add-point:ON ACTION controlp INFIELD glce002
            {<point name="input.c.glce002" />}
            #END add-point
 
         #Ctrlp:input.c.glce003
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glce003
            #add-point:ON ACTION controlp INFIELD glce003
            {<point name="input.c.glce003" />}
            #END add-point
 
         #Ctrlp:input.c.glce004
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glce004
            #add-point:ON ACTION controlp INFIELD glce004
            {<point name="input.c.glce004" />}
            #END add-point
 
         #Ctrlp:input.c.glce006
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glce006
            #add-point:ON ACTION controlp INFIELD glce006
            {<point name="input.c.glce006" />}
            #END add-point
 
         #Ctrlp:input.c.glce005
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glce005
            #add-point:ON ACTION controlp INFIELD glce005
            {<point name="input.c.glce005" />}
            #END add-point
 
         #Ctrlp:input.c.glcedocno
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcedocno
            #add-point:ON ACTION controlp INFIELD glcedocno
            {<point name="input.c.glcedocno" />}
            #END add-point
 
         #Ctrlp:input.c.glcestus
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD glcestus
            #add-point:ON ACTION controlp INFIELD glcestus
            {<point name="input.c.glcestus" />}
            #END add-point
 
 #欄位開窗
            
         AFTER INPUT
            IF INT_FLAG THEN
               EXIT DIALOG
            END IF
 
            #CALL cl_err_collect_show()      #錯誤訊息統整顯示
            #CALL cl_showmsg()
            DISPLAY BY NAME g_glce_m.glceld,g_glce_m.glce001,g_glce_m.glce002
                        
            #add-point:單頭INPUT後
            {<point name="input.head.after_input"/>}
            #end add-point
                        
            IF p_cmd <> 'u' THEN
    
               CALL s_transaction_begin()
               
               #add-point:單頭新增前
               {<point name="input.head.b_insert" mark="Y"/>}
               #end add-point
               
               INSERT INTO glce_t (glceent,glceld,glcecomp,glce001,glce002,glce003,glce004,glce006,glce005, 
                   glcedocno,glcestus,glceownid,glceowndp,glcecrtid,glcecrtdp,glcecrtdt,glcemodid,glcemoddt, 
                   glcecnfid,glcecnfdt)
               VALUES (g_enterprise,g_glce_m.glceld,g_glce_m.glcecomp,g_glce_m.glce001,g_glce_m.glce002, 
                   g_glce_m.glce003,g_glce_m.glce004,g_glce_m.glce006,g_glce_m.glce005,g_glce_m.glcedocno, 
                   g_glce_m.glcestus,g_glce_m.glceownid,g_glce_m.glceowndp,g_glce_m.glcecrtid,g_glce_m.glcecrtdp, 
                   g_glce_m.glcecrtdt,g_glce_m.glcemodid,g_glce_m.glcemoddt,g_glce_m.glcecnfid,g_glce_m.glcecnfdt)  

               IF SQLCA.sqlcode THEN
                  INITIALIZE g_errparam TO NULL 
                  LET g_errparam.extend = "g_glce_m" 
                  LET g_errparam.code   = SQLCA.sqlcode 
                  LET g_errparam.popup  = TRUE 
                  CALL cl_err()
                  CALL s_transaction_end('N','0')
                  NEXT FIELD CURRENT
               END IF
               
               #add-point:單頭新增中
               {<point name="input.head.m_insert"/>}
               #end add-point
               
               
               
               
               #add-point:單頭新增後
               {<point name="input.head.a_insert"/>}
               #end add-point
               CALL s_transaction_end('Y','0') 
               
               IF l_cmd_t = 'r' AND p_cmd = 'a' THEN
                  CALL aglt420_detail_reproduce()
                  #因應特定程式需求, 重新刷新單身資料
                  CALL aglt420_b_fill()
                  CALL aglt420_b_fill2('0')
               END IF
               
               #add-point:單頭新增後
               {<point name="input.head.a_insert2"/>}
               #end add-point
               
               LET g_master_insert = TRUE
               
               LET p_cmd = 'u'
            ELSE
               CALL s_transaction_begin()
            
               #add-point:單頭修改前
               {<point name="input.head.b_update" mark="Y"/>}
               #end add-point
               
               #將遮罩欄位還原
               CALL aglt420_glce_t_mask_restore('restore_mask_o')
               
               UPDATE glce_t SET (glceld,glcecomp,glce001,glce002,glce003,glce004,glce006,glce005,glcedocno, 
                   glcestus,glceownid,glceowndp,glcecrtid,glcecrtdp,glcecrtdt,glcemodid,glcemoddt,glcecnfid, 
                   glcecnfdt) = (g_glce_m.glceld,g_glce_m.glcecomp,g_glce_m.glce001,g_glce_m.glce002, 
                   g_glce_m.glce003,g_glce_m.glce004,g_glce_m.glce006,g_glce_m.glce005,g_glce_m.glcedocno, 
                   g_glce_m.glcestus,g_glce_m.glceownid,g_glce_m.glceowndp,g_glce_m.glcecrtid,g_glce_m.glcecrtdp, 
                   g_glce_m.glcecrtdt,g_glce_m.glcemodid,g_glce_m.glcemoddt,g_glce_m.glcecnfid,g_glce_m.glcecnfdt) 

                WHERE glceent = g_enterprise AND glceld = g_glceld_t
                  AND glce001 = g_glce001_t
                  AND glce002 = g_glce002_t
 
               IF SQLCA.sqlcode THEN
                  INITIALIZE g_errparam TO NULL 
                  LET g_errparam.extend = "glce_t" 
                  LET g_errparam.code   = SQLCA.sqlcode 
                  LET g_errparam.popup  = TRUE 
                  CALL cl_err()
                  CALL s_transaction_end('N','0')
                  NEXT FIELD CURRENT
               END IF
               
               #add-point:單頭修改中
               {<point name="input.head.m_update"/>}
               #end add-point
               
               
               
               
               #將遮罩欄位進行遮蔽
               CALL aglt420_glce_t_mask_restore('restore_mask_n')
               
               #修改歷程記錄(單頭修改)
               LET g_log1 = util.JSON.stringify(g_glce_m_t)
               LET g_log2 = util.JSON.stringify(g_glce_m)
               IF NOT cl_log_modified_record(g_log1,g_log2) THEN 
                  CALL s_transaction_end('N','0')
               ELSE
                  CALL s_transaction_end('Y','0')
               END IF
               
               #add-point:單頭修改後
               {<point name="input.head.a_update"/>}
               #end add-point
            END IF
            
            LET g_glceld_t = g_glce_m.glceld
            LET g_glce001_t = g_glce_m.glce001
            LET g_glce002_t = g_glce_m.glce002
 
            
      END INPUT
   
]]>
  </section>
  <section id="aglt420.input.other" ver="3" status="" src="s" readonly="">
    <![CDATA[      
      #add-point:自定義input
      {<point name="input.more_input"/>}
      #end add-point
    
      BEFORE DIALOG 
         #CALL cl_err_collect_init()    
         #add-point:input段before dialog
         {<point name="input.before_dialog"/>}
         #end add-point    
         #重新導回資料到正確位置上
         CALL DIALOG.setCurrentRow("s_detail1",g_detail_idx)      
         CALL DIALOG.setCurrentRow("s_detail2",g_detail_idx)
         CALL DIALOG.setCurrentRow("s_detail3",g_detail_idx)
         CALL DIALOG.setCurrentRow("s_detail4",g_detail_idx)
 
         #新增時強制從單頭開始填
         IF p_cmd = 'a' THEN
            #add-point:input段next_field
            {<point name="input.next_field"/>}
            #end add-point  
            NEXT FIELD glceld
         ELSE
            CASE g_aw
               WHEN "s_detail1"
                  NEXT FIELD glcf003
               WHEN "s_detail2"
                  NEXT FIELD glcf003_2
               WHEN "s_detail3"
                  NEXT FIELD glcf003_3
               WHEN "s_detail4"
                  NEXT FIELD glcf003_4
 
               #add-point:input段modify_detail 
               {<point name="input.modify_detail.other"/>}
               #end add-point  
            END CASE
         END IF
      
      AFTER DIALOG
         #add-point:input段after_dialog
         {<point name="input.after_dialog"/>}
         #end add-point    
         
      ON ACTION controlf
         CALL cl_set_focus_form(ui.Interface.getRootNode()) RETURNING g_fld_name,g_frm_name
         CALL cl_fldhelp(g_frm_name,g_fld_name,g_lang)
 
      ON ACTION controlr
         CALL cl_show_req_fields()
 
      ON ACTION controls
         IF g_header_hidden THEN
            CALL gfrm_curr.setElementHidden("vb_master",0)
            CALL gfrm_curr.setElementImage("controls","small/arr-u.png")
            LET g_header_hidden = 0     #visible
         ELSE
            CALL gfrm_curr.setElementHidden("vb_master",1)
            CALL gfrm_curr.setElementImage("controls","small/arr-d.png")
            LET g_header_hidden = 1     #hidden     
         END IF
 
      ON ACTION accept
         #add-point:input段accept 
         {<point name="input.accept"/>}
         #end add-point    
         ACCEPT DIALOG
        
      ON ACTION cancel      #在dialog button (放棄)
         #add-point:input段cancel
         {<point name="input.cancel"/>}
         #end add-point  
         LET INT_FLAG = TRUE 
         LET g_detail_idx  = 1
         LET g_detail_idx2 = 1
         EXIT DIALOG
 
      ON ACTION close       #在dialog 右上角 (X)
         #add-point:input段close
         {<point name="input.close"/>}
         #end add-point  
         LET INT_FLAG = TRUE 
         EXIT DIALOG
 
      ON ACTION exit        #toolbar 離開
         #add-point:input段exit
         {<point name="input.exit"/>}
         #end add-point
         LET INT_FLAG = TRUE 
         EXIT DIALOG
 
      #交談指令共用ACTION
      &include "common_action.4gl" 
         CONTINUE DIALOG 
   END DIALOG
    
   #add-point:input段after input 
   {<point name="input.after_input"/>}
   #end add-point    
 
END FUNCTION
]]>
  </section>
  <section id="aglt420.insert" ver="16" status="" src="s" readonly="">
    <![CDATA[#+ 資料新增
PRIVATE FUNCTION aglt420_insert()
   #add-point:insert段define
   {<point name="insert.define" edit="s"/>}
   #end add-point    
   #add-point:insert段define(客製用)
   {<point name="insert.define_customerization" edit="c"/>}
   #end add-point    
   
   #清畫面欄位內容
   CLEAR FORM                    
   CALL g_glcf_d.clear()   
   CALL g_glcf2_d.clear()  
   CALL g_glcf3_d.clear()  
   CALL g_glcf4_d.clear()  
 
 
   INITIALIZE g_glce_m.* LIKE glce_t.*             #DEFAULT 設定
   
   LET g_glceld_t = NULL
   LET g_glce001_t = NULL
   LET g_glce002_t = NULL
 
   
   LET g_master_insert = FALSE
   
   #add-point:insert段before
   {<point name="insert.before"/>}
   #end add-point    
   
   CALL s_transaction_begin()
   WHILE TRUE
      #公用欄位給值(單頭)
      #應用 a14 樣板自動產生(Version:4)    
      #公用欄位新增給值  
      LET g_glce_m.glceownid = g_user
      LET g_glce_m.glceowndp = g_dept
      LET g_glce_m.glcecrtid = g_user
      LET g_glce_m.glcecrtdp = g_dept 
      LET g_glce_m.glcecrtdt = cl_get_current()
      LET g_glce_m.glcemodid = g_user
      LET g_glce_m.glcemoddt = cl_get_current()
      LET g_glce_m.glcestus = 'N'
 
 
 
      #append欄位給值
      
     
      #一般欄位給值
            LET g_glce_m.glcestus = "N"
 
  
      #add-point:單頭預設值
      {<point name="insert.default"/>}
      #end add-point 
      
      #保存單頭舊值(用於資料輸入錯誤還原預設值時使用)
      LET g_glce_m_t.* = g_glce_m.*
      LET g_glce_m_o.* = g_glce_m.*
      
      #顯示狀態(stus)圖片
            #應用 a21 樣板自動產生(Version:2)
	  #根據當下狀態碼顯示圖片
      CASE g_glce_m.glcestus 
         WHEN "N"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/unconfirmed.png")
         WHEN "Y"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/confirmed.png")
         WHEN "X"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/invalid.png")
         
      END CASE
 
 
    
      CALL aglt420_input("a")
      
      #add-point:單頭輸入後
      {<point name="insert.after_insert"/>}
      #end add-point
      
      IF INT_FLAG THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = '' 
         LET g_errparam.code   = 9001 
         LET g_errparam.popup  = FALSE 
         CALL cl_err()
         CALL s_transaction_end('N','0')
         LET INT_FLAG = 0
      END IF
      
      IF NOT g_master_insert THEN
         DISPLAY g_detail_cnt  TO FORMONLY.h_count    #總筆數
         DISPLAY g_current_idx TO FORMONLY.h_index    #當下筆數
         INITIALIZE g_glce_m.* TO NULL
         INITIALIZE g_glcf_d TO NULL
         INITIALIZE g_glcf2_d TO NULL
         INITIALIZE g_glcf3_d TO NULL
         INITIALIZE g_glcf4_d TO NULL
 
         #add-point:取消新增後
         {<point name="insert.cancel"/>}
         #end add-point 
         CALL aglt420_show()
         RETURN
      END IF
      
      LET INT_FLAG = 0
      #CALL g_glcf_d.clear()
      #CALL g_glcf2_d.clear()
      #CALL g_glcf3_d.clear()
      #CALL g_glcf4_d.clear()
 
 
      LET g_rec_b = 0
      CALL s_transaction_end('Y','0')
      EXIT WHILE
        
   END WHILE
   
   #根據資料狀態切換action狀態
   CALL cl_set_act_visible("statechange,modify,modify_detail,delete,reproduce", TRUE)
   CALL aglt420_set_act_visible()   
   CALL aglt420_set_act_no_visible()
   
   #將新增的資料併入搜尋條件中
   LET g_glceld_t = g_glce_m.glceld
   LET g_glce001_t = g_glce_m.glce001
   LET g_glce002_t = g_glce_m.glce002
 
   
   #組合新增資料的條件
   LET g_add_browse = " glceent = '" ||g_enterprise|| "' AND",
                      " glceld = '", g_glce_m.glceld, "' "
                      ," AND glce001 = '", g_glce_m.glce001, "' "
                      ," AND glce002 = '", g_glce_m.glce002, "' "
 
                      
   #add-point:組合新增資料的條件後
   {<point name="insert.after.add_browse"/>}
   #end add-point
      
   #填到最後面
   LET g_current_idx = g_browser.getLength() + 1
   CALL aglt420_browser_fill("")
   
   DISPLAY g_browser_cnt TO FORMONLY.h_count    #總筆數
   DISPLAY g_current_idx TO FORMONLY.h_index    #當下筆數
   CALL cl_navigator_setting(g_current_idx, g_browser_cnt)
   
   CLOSE aglt420_cl
   
   CALL aglt420_idx_chk()
   
   #撈取異動後的資料(主要是帶出reference)
   EXECUTE aglt420_master_referesh USING g_glce_m.glceld,g_glce_m.glce001,g_glce_m.glce002 INTO g_glce_m.glceld, 
       g_glce_m.glcecomp,g_glce_m.glce001,g_glce_m.glce002,g_glce_m.glce003,g_glce_m.glce004,g_glce_m.glce006, 
       g_glce_m.glce005,g_glce_m.glcedocno,g_glce_m.glcestus,g_glce_m.glceownid,g_glce_m.glceowndp,g_glce_m.glcecrtid, 
       g_glce_m.glcecrtdp,g_glce_m.glcecrtdt,g_glce_m.glcemodid,g_glce_m.glcemoddt,g_glce_m.glcecnfid, 
       g_glce_m.glcecnfdt,g_glce_m.glceld_desc,g_glce_m.glcecomp_desc,g_glce_m.glce003_desc,g_glce_m.glceownid_desc, 
       g_glce_m.glceowndp_desc,g_glce_m.glcecrtid_desc,g_glce_m.glcecrtdp_desc,g_glce_m.glcemodid_desc, 
       g_glce_m.glcecnfid_desc
   
   #遮罩相關處理
   LET g_glce_m_mask_o.* =  g_glce_m.*
   CALL aglt420_glce_t_mask()
   LET g_glce_m_mask_n.* =  g_glce_m.*
   
   #將資料顯示到畫面上
   DISPLAY BY NAME g_glce_m.glceld,g_glce_m.glceld_desc,g_glce_m.glcecomp,g_glce_m.glcecomp_desc,g_glce_m.glaa001, 
       g_glce_m.glaa016,g_glce_m.glaa020,g_glce_m.glce001,g_glce_m.glce002,g_glce_m.glce003,g_glce_m.glce003_desc, 
       g_glce_m.glce004,g_glce_m.glce006,g_glce_m.glce006_desc,g_glce_m.glce005,g_glce_m.glcedocno,g_glce_m.glcestus, 
       g_glce_m.glceownid,g_glce_m.glceownid_desc,g_glce_m.glceowndp,g_glce_m.glceowndp_desc,g_glce_m.glcecrtid, 
       g_glce_m.glcecrtid_desc,g_glce_m.glcecrtdp,g_glce_m.glcecrtdp_desc,g_glce_m.glcecrtdt,g_glce_m.glcemodid, 
       g_glce_m.glcemodid_desc,g_glce_m.glcemoddt,g_glce_m.glcecnfid,g_glce_m.glcecnfid_desc,g_glce_m.glcecnfdt, 
       g_glce_m.glcf023,g_glce_m.glcf023_desc,g_glce_m.glcf024,g_glce_m.glcf024_desc,g_glce_m.glcf025, 
       g_glce_m.glcf025_desc,g_glce_m.glcf026,g_glce_m.glcf026_desc,g_glce_m.glcf027,g_glce_m.glcf027_desc, 
       g_glce_m.glcf028,g_glce_m.glcf028_desc,g_glce_m.glcf029,g_glce_m.glcf029_desc,g_glce_m.glcf030, 
       g_glce_m.glcf030_desc,g_glce_m.glcf031,g_glce_m.glcf032,g_glce_m.glcf032_desc,g_glce_m.glcf033, 
       g_glce_m.glcf033_desc,g_glce_m.glcf034,g_glce_m.glcf034_desc,g_glce_m.glcf035,g_glce_m.glcf035_desc, 
       g_glce_m.glcf036,g_glce_m.glcf036_desc,g_glce_m.glcf037,g_glce_m.glcf038,g_glce_m.glcf039,g_glce_m.glcf040, 
       g_glce_m.glcf041,g_glce_m.glcf042,g_glce_m.glcf043,g_glce_m.glcf044,g_glce_m.glcf045,g_glce_m.glcf046 

   
   #add-point:新增結束後
   {<point name="insert.after"/>}
   #end add-point 
   
   #功能已完成,通報訊息中心
   CALL aglt420_msgcentre_notify('insert')
   
END FUNCTION
]]>
  </section>
  <section id="aglt420.insert_b" ver="6" status="" src="s" readonly="">
    <![CDATA[#+ 新增單身後其他table連動
PRIVATE FUNCTION aglt420_insert_b(ps_table,ps_keys,ps_page)
   DEFINE ps_table    STRING
   DEFINE ps_page     STRING
   DEFINE ps_keys     DYNAMIC ARRAY OF VARCHAR(500)
   DEFINE ls_group    STRING
   DEFINE ls_page     STRING
   DEFINE li_idx      LIKE type_t.num10
   #add-point:insert_b段define
   {<point name="insert_b.define" edit="s"/>}
   #end add-point     
   #add-point:insert_b段define(客製用)
   {<point name="insert_b.define_customerization" edit="c"/>}
   #end add-point     
   
   LET g_update = TRUE  
   
   #判斷是否是同一群組的table
   LET ls_group = "'1','2','3','4',"
   IF ls_group.getIndexOf(ps_page,1) > 0 THEN
      #add-point:insert_b段資料新增前
      {<point name="insert_b.before_insert" mark="Y"/>}
      #end add-point 
      INSERT INTO glcf_t
                  (glcfent,
                   glcfld,glcf001,glcf002,
                   glcf003,glcf004,glcf005
                   ,glcf006,glcf007,glcf008,glcf009,glcf010,glcf011,glcf012,glcf073,glcf013,glcf014,glcf015,glcf016,glcf017,glcf018,glcf019,glcf020,glcf021,glcf022,glcf047,glcf048,glcf049,glcf050,glcf051,glcf052,glcf053,glcf054,glcf055,glcf056,glcf057,glcf058,glcf059,glcf060,glcf061,glcf062,glcf063,glcf064,glcf065,glcf066,glcf067,glcf068,glcf069,glcf070,glcf071,glcf072) 
            VALUES(g_enterprise,
                   ps_keys[1],ps_keys[2],ps_keys[3],ps_keys[4],ps_keys[5],ps_keys[6]
                   ,g_glcf_d[g_detail_idx].glcf006,g_glcf_d[g_detail_idx].glcf007,g_glcf_d[g_detail_idx].glcf008, 
                       g_glcf_d[g_detail_idx].glcf009,g_glcf_d[g_detail_idx].glcf010,g_glcf_d[g_detail_idx].glcf011, 
                       g_glcf_d[g_detail_idx].glcf012,g_glcf_d[g_detail_idx].glcf073,g_glcf2_d[g_detail_idx].glcf013, 
                       g_glcf2_d[g_detail_idx].glcf014,g_glcf2_d[g_detail_idx].glcf015,g_glcf2_d[g_detail_idx].glcf016, 
                       g_glcf2_d[g_detail_idx].glcf017,g_glcf3_d[g_detail_idx].glcf018,g_glcf3_d[g_detail_idx].glcf019, 
                       g_glcf3_d[g_detail_idx].glcf020,g_glcf3_d[g_detail_idx].glcf021,g_glcf3_d[g_detail_idx].glcf022, 
                       g_glcf4_d[g_detail_idx].glcf047,g_glcf4_d[g_detail_idx].glcf048,g_glcf4_d[g_detail_idx].glcf049, 
                       g_glcf4_d[g_detail_idx].glcf050,g_glcf4_d[g_detail_idx].glcf051,g_glcf4_d[g_detail_idx].glcf052, 
                       g_glcf4_d[g_detail_idx].glcf053,g_glcf4_d[g_detail_idx].glcf054,g_glcf4_d[g_detail_idx].glcf055, 
                       g_glcf4_d[g_detail_idx].glcf056,g_glcf4_d[g_detail_idx].glcf057,g_glcf4_d[g_detail_idx].glcf058, 
                       g_glcf4_d[g_detail_idx].glcf059,g_glcf4_d[g_detail_idx].glcf060,g_glcf4_d[g_detail_idx].glcf061, 
                       g_glcf4_d[g_detail_idx].glcf062,g_glcf4_d[g_detail_idx].glcf063,g_glcf4_d[g_detail_idx].glcf064, 
                       g_glcf4_d[g_detail_idx].glcf065,g_glcf4_d[g_detail_idx].glcf066,g_glcf4_d[g_detail_idx].glcf067, 
                       g_glcf4_d[g_detail_idx].glcf068,g_glcf4_d[g_detail_idx].glcf069,g_glcf4_d[g_detail_idx].glcf070, 
                       g_glcf4_d[g_detail_idx].glcf071,g_glcf4_d[g_detail_idx].glcf072)
      #add-point:insert_b段資料新增中
      {<point name="insert_b.m_insert"/>}
      #end add-point 
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = "glcf_t" 
         LET g_errparam.code   = SQLCA.sqlcode 
         LET g_errparam.popup  = FALSE 
         CALL cl_err()
      END IF
      
      LET li_idx = g_detail_idx
      IF ps_page <> "'1'" THEN 
         CALL g_glcf_d.insertElement(li_idx) 
      END IF 
      IF ps_page <> "'2'" THEN 
         CALL g_glcf2_d.insertElement(li_idx) 
      END IF 
      IF ps_page <> "'3'" THEN 
         CALL g_glcf3_d.insertElement(li_idx) 
      END IF 
      IF ps_page <> "'4'" THEN 
         CALL g_glcf4_d.insertElement(li_idx) 
      END IF 
 
      #add-point:insert_b段資料新增後
      {<point name="insert_b.after_insert"/>}
      #end add-point 
   END IF
   
 
   
 
   
   #add-point:insert_b段other
   {<point name="insert_b.other"/>}
   #end add-point     
   
END FUNCTION
]]>
  </section>
  <section id="aglt420.key_delete_b" ver="4" status="" src="s" readonly="">
    <![CDATA[#+ 上層單身刪除後, 連帶刪除下層單身key欄位
PRIVATE FUNCTION aglt420_key_delete_b(ps_keys_bak,ps_table)
   DEFINE ps_keys_bak DYNAMIC ARRAY OF VARCHAR(500)
   DEFINE ps_table    STRING
   #add-point:delete_b段define
   {<point name="key_delete_b.define" edit="s"/>}
   #end add-point
   #add-point:delete_b段define(客製用)
   {<point name="key_delete_b.define_customerization" edit="c"/>}
   #end add-point
   
 
   
   RETURN TRUE
   
END FUNCTION
]]>
  </section>
  <section id="aglt420.key_update_b" ver="3" status="" src="s" readonly="">
    <![CDATA[#+ 上層單身key欄位變動後, 連帶修正下層單身key欄位
PRIVATE FUNCTION aglt420_key_update_b(ps_keys_bak,ps_table)
   DEFINE ps_keys_bak DYNAMIC ARRAY OF VARCHAR(500)
   DEFINE ps_table    STRING
   #add-point:update_b段define
   {<point name="key_update_b.define" edit="s"/>}
   #end add-point
   #add-point:update_b段define(客製用)
   {<point name="key_update_b.define_customerization" edit="c"/>}
   #end add-point
   
 
   
END FUNCTION
]]>
  </section>
  <section id="aglt420.lock_b" ver="4" status="" src="s" readonly="">
    <![CDATA[#+ 連動lock其他單身table資料
PRIVATE FUNCTION aglt420_lock_b(ps_table,ps_page)
   DEFINE ps_page     STRING
   DEFINE ps_table    STRING
   DEFINE ls_group    STRING
   #add-point:lock_b段define
   {<point name="lock_b.define" edit="s"/>}
   #end add-point   
   #add-point:lock_b段define(客製用)
   {<point name="lock_b.define_customerization" edit="c"/>}
   #end add-point   
    
   #先刷新資料
   #CALL aglt420_b_fill()
   
   #鎖定整組table
   #LET ls_group = "'1','2','3','4',"
   #僅鎖定自身table
   LET ls_group = "glcf_t"
   
   IF ls_group.getIndexOf(ps_table,1) THEN
      OPEN aglt420_bcl USING g_enterprise,
                                       g_glce_m.glceld,g_glce_m.glce001,g_glce_m.glce002,g_glcf_d[g_detail_idx].glcf003, 
                                           g_glcf_d[g_detail_idx].glcf004,g_glcf_d[g_detail_idx].glcf005  
                                               
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = "aglt420_bcl" 
         LET g_errparam.code   = SQLCA.sqlcode 
         LET g_errparam.popup  = TRUE 
         CALL cl_err()
         RETURN FALSE
      END IF
   END IF
                                    
 
   
 
   
   #add-point:lock_b段other
   {<point name="lock_b.other"/>}
   #end add-point  
   
   RETURN TRUE
 
END FUNCTION
]]>
  </section>
  <section id="aglt420.main" ver="10" status="" src="s" readonly="">
    <![CDATA[#應用 a26 樣板自動產生(Version:4)
#+ 作業開始(主程式類型)
MAIN
   #add-point:main段define
   {<point name="main.define" edit="s"/>}
   #end add-point   
   #add-point:main段define(客製用)
   {<point name="main.define_customerization" edit="c"/>}
   #end add-point   
 
   OPTIONS
   INPUT NO WRAP
   DEFER INTERRUPT
   
   #設定SQL錯誤記錄方式 (模組內定義有效)
   WHENEVER ERROR CALL cl_err_msg_log
       
   #依模組進行系統初始化設定(系統設定)
   CALL cl_ap_init("agl","")
 
   #add-point:作業初始化
   {<point name="main.init" />}
   #end add-point
   
   
 
   #LOCK CURSOR (identifier)
   #add-point:SQL_define
   {<point name="main.define_sql" />}
   #end add-point
   LET g_forupd_sql = " SELECT glceld,'',glcecomp,'','','','',glce001,glce002,glce003,'',glce004,glce006, 
       '',glce005,glcedocno,glcestus,glceownid,'',glceowndp,'',glcecrtid,'',glcecrtdp,'',glcecrtdt,glcemodid, 
       '',glcemoddt,glcecnfid,'',glcecnfdt,'','','','','','','','','','','','','','','','','','','', 
       '','','','','','','','','','','','','','','','','',''", 
                      " FROM glce_t",
                      " WHERE glceent= ? AND glceld=? AND glce001=? AND glce002=? FOR UPDATE"
   #add-point:SQL_define
   {<point name="main.after_define_sql"/>}
   #end add-point
   LET g_forupd_sql = cl_sql_forupd(g_forupd_sql)                #轉換不同資料庫語法
   LET g_forupd_sql = cl_sql_add_mask(g_forupd_sql)              #遮蔽特定資料
   DECLARE aglt420_cl CURSOR FROM g_forupd_sql                 # LOCK CURSOR
 
   LET g_sql = " SELECT UNIQUE t0.glceld,t0.glcecomp,t0.glce001,t0.glce002,t0.glce003,t0.glce004,t0.glce006, 
       t0.glce005,t0.glcedocno,t0.glcestus,t0.glceownid,t0.glceowndp,t0.glcecrtid,t0.glcecrtdp,t0.glcecrtdt, 
       t0.glcemodid,t0.glcemoddt,t0.glcecnfid,t0.glcecnfdt,t1.glaal002 ,t2.ooefl003 ,t3.ooefl003 ,t4.ooag011 , 
       t5.ooefl003 ,t6.ooag011 ,t7.ooefl003 ,t8.ooag011 ,t9.ooag011",
               " FROM glce_t t0",
                              " LEFT JOIN glaal_t t1 ON t1.glaalent='"||g_enterprise||"' AND t1.glaalld=t0.glceld AND t1.glaal001='"||g_dlang||"' ",
               " LEFT JOIN ooefl_t t2 ON t2.ooeflent='"||g_enterprise||"' AND t2.ooefl001=t0.glcecomp AND t2.ooefl002='"||g_dlang||"' ",
               " LEFT JOIN ooefl_t t3 ON t3.ooeflent='"||g_enterprise||"' AND t3.ooefl001=t0.glce003 AND t3.ooefl002='"||g_dlang||"' ",
               " LEFT JOIN ooag_t t4 ON t4.ooagent='"||g_enterprise||"' AND t4.ooag001=t0.glceownid  ",
               " LEFT JOIN ooefl_t t5 ON t5.ooeflent='"||g_enterprise||"' AND t5.ooefl001=t0.glceowndp AND t5.ooefl002='"||g_dlang||"' ",
               " LEFT JOIN ooag_t t6 ON t6.ooagent='"||g_enterprise||"' AND t6.ooag001=t0.glcecrtid  ",
               " LEFT JOIN ooefl_t t7 ON t7.ooeflent='"||g_enterprise||"' AND t7.ooefl001=t0.glcecrtdp AND t7.ooefl002='"||g_dlang||"' ",
               " LEFT JOIN ooag_t t8 ON t8.ooagent='"||g_enterprise||"' AND t8.ooag001=t0.glcemodid  ",
               " LEFT JOIN ooag_t t9 ON t9.ooagent='"||g_enterprise||"' AND t9.ooag001=t0.glcecnfid  ",
 
               " WHERE t0.glceent = '" ||g_enterprise|| "' AND t0.glceld = ? AND t0.glce001 = ? AND t0.glce002 = ?"
   LET g_sql = cl_sql_add_mask(g_sql)              #遮蔽特定資料
   #add-point:SQL_define
   {<point name="main.after_refresh_sql"/>}
   #end add-point
   PREPARE aglt420_master_referesh FROM g_sql
 
    
 
   
   IF g_bgjob = "Y" THEN
      #add-point:Service Call
      {<point name="main.servicecall" />}
      #end add-point
   ELSE
      #畫面開啟 (identifier)
      OPEN WINDOW w_aglt420 WITH FORM cl_ap_formpath("agl",g_code)
   
      #瀏覽頁簽資料初始化
      CALL cl_ui_init()
   
      #程式初始化
      CALL aglt420_init()   
 
      #進入選單 Menu (="N")
      CALL aglt420_ui_dialog() 
      
      #add-point:畫面關閉前
      {<point name="main.before_close" />}
      #end add-point
 
      #畫面關閉
      CLOSE WINDOW w_aglt420
      
   END IF 
   
   CLOSE aglt420_cl
   
   
 
   #add-point:作業離開前
   {<point name="main.exit" />}
   #end add-point
 
   #離開作業
   CALL cl_ap_exitprogram("0")
END MAIN
 
 
]]>
  </section>
  <section id="aglt420.mask_functions" ver="1" status="" src="s" readonly="">
    <![CDATA[&include "erp/agl/aglt420_mask.4gl"
]]>
  </section>
  <section id="aglt420.modify" ver="12" status="" src="s" readonly="">
    <![CDATA[#+ 資料修改
PRIVATE FUNCTION aglt420_modify()
   DEFINE l_new_key    DYNAMIC ARRAY OF STRING
   DEFINE l_old_key    DYNAMIC ARRAY OF STRING
   DEFINE l_field_key  DYNAMIC ARRAY OF STRING
   DEFINE l_wc2_table1          STRING
 
 
   #add-point:modify段define
   {<point name="modify.define" edit="s"/>}
   #end add-point    
   #add-point:modify段define(客製用)
   {<point name="modify.define_customerization" edit="c"/>}
   #end add-point    
   
   #保存單頭舊值
   LET g_glce_m_t.* = g_glce_m.*
   LET g_glce_m_o.* = g_glce_m.*
   
   IF g_glce_m.glceld IS NULL
   OR g_glce_m.glce001 IS NULL
   OR g_glce_m.glce002 IS NULL
 
   THEN
      INITIALIZE g_errparam TO NULL 
      LET g_errparam.extend = "" 
      LET g_errparam.code   = "std-00003" 
      LET g_errparam.popup  = FALSE 
      CALL cl_err()
      RETURN
   END IF
 
   ERROR ""
  
   LET g_glceld_t = g_glce_m.glceld
   LET g_glce001_t = g_glce_m.glce001
   LET g_glce002_t = g_glce_m.glce002
 
   CALL s_transaction_begin()
   
   OPEN aglt420_cl USING g_enterprise,g_glce_m.glceld,g_glce_m.glce001,g_glce_m.glce002
   IF STATUS THEN
      INITIALIZE g_errparam TO NULL 
      LET g_errparam.extend = "OPEN aglt420_cl:" 
      LET g_errparam.code   = STATUS 
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      CLOSE aglt420_cl
      CALL s_transaction_end('N','0')
      RETURN
   END IF
 
   #顯示最新的資料
   EXECUTE aglt420_master_referesh USING g_glce_m.glceld,g_glce_m.glce001,g_glce_m.glce002 INTO g_glce_m.glceld, 
       g_glce_m.glcecomp,g_glce_m.glce001,g_glce_m.glce002,g_glce_m.glce003,g_glce_m.glce004,g_glce_m.glce006, 
       g_glce_m.glce005,g_glce_m.glcedocno,g_glce_m.glcestus,g_glce_m.glceownid,g_glce_m.glceowndp,g_glce_m.glcecrtid, 
       g_glce_m.glcecrtdp,g_glce_m.glcecrtdt,g_glce_m.glcemodid,g_glce_m.glcemoddt,g_glce_m.glcecnfid, 
       g_glce_m.glcecnfdt,g_glce_m.glceld_desc,g_glce_m.glcecomp_desc,g_glce_m.glce003_desc,g_glce_m.glceownid_desc, 
       g_glce_m.glceowndp_desc,g_glce_m.glcecrtid_desc,g_glce_m.glcecrtdp_desc,g_glce_m.glcemodid_desc, 
       g_glce_m.glcecnfid_desc
   
   #檢查是否允許此動作
   IF NOT aglt420_action_chk() THEN
      RETURN
   END IF
   
   #遮罩相關處理
   LET g_glce_m_mask_o.* =  g_glce_m.*
   CALL aglt420_glce_t_mask()
   LET g_glce_m_mask_n.* =  g_glce_m.*
   
   
   
   #add-point:modify段show之前
   {<point name="modify.before_show"/>}
   #end add-point  
   
   #LET l_wc2_table1 = g_wc2_table1
   #LET g_wc2_table1 = " 1=1"
 
 
   
   CALL aglt420_show()
   #add-point:modify段show之後
   {<point name="modify.after_show"/>}
   #end add-point
   
   #LET g_wc2_table1 = l_wc2_table1
 
 
    
   WHILE TRUE
      LET g_glceld_t = g_glce_m.glceld
      LET g_glce001_t = g_glce_m.glce001
      LET g_glce002_t = g_glce_m.glce002
 
      
      #寫入修改者/修改日期資訊(單頭)
      LET g_glce_m.glcemodid = g_user 
LET g_glce_m.glcemoddt = cl_get_current()
LET g_glce_m.glcemodid_desc = cl_get_username(g_glce_m.glcemodid)
      
      #add-point:modify段修改前
      {<point name="modify.before_input"/>}
      #end add-point
      
      #欄位更改
      LET g_loc = 'n'
      LET g_update = FALSE
      CALL aglt420_input("u")
      LET g_loc = 'n'
 
      #add-point:modify段修改後
      {<point name="modify.after_input"/>}
      #end add-point
      
      IF g_update OR NOT INT_FLAG THEN
         #若有modid跟moddt則進行update
         UPDATE glce_t SET (glcemodid,glcemoddt) = (g_glce_m.glcemodid,g_glce_m.glcemoddt)
          WHERE glceent = g_enterprise AND glceld = g_glceld_t
            AND glce001 = g_glce001_t
            AND glce002 = g_glce002_t
 
      END IF
    
      IF INT_FLAG THEN
         LET INT_FLAG = 0
         LET g_glce_m.* = g_glce_m_t.*
         CALL aglt420_show()
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = '' 
         LET g_errparam.code   = 9001 
         LET g_errparam.popup  = FALSE 
         CALL cl_err()
         CALL s_transaction_end('N','0')
         RETURN
      END IF 
                  
      #若單頭key欄位有變更
      IF g_glce_m.glceld != g_glceld_t 
      OR g_glce_m.glce001 != g_glce001_t 
      OR g_glce_m.glce002 != g_glce002_t 
 
      THEN
         CALL s_transaction_begin()
         
         #add-point:單身fk修改前
         {<point name="modify.body.b_fk_update" mark="Y"/>}
         #end add-point
         
         #更新單身key值
         UPDATE glcf_t SET glcfld = g_glce_m.glceld
                                       ,glcf001 = g_glce_m.glce001
                                       ,glcf002 = g_glce_m.glce002
 
          WHERE glcfent = g_enterprise AND glcfld = g_glceld_t
            AND glcf001 = g_glce001_t
            AND glcf002 = g_glce002_t
 
            
         #add-point:單身fk修改中
         {<point name="modify.body.m_fk_update"/>}
         #end add-point
 
         CASE
            WHEN SQLCA.sqlerrd[3] = 0  #更新不到的處理
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = "glcf_t" 
               LET g_errparam.code   = "std-00009" 
               LET g_errparam.popup  = TRUE 
               CALL cl_err()
               CALL s_transaction_end('N','0')
               CONTINUE WHILE
            WHEN SQLCA.sqlcode #其他錯誤
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = "glcf_t" 
               LET g_errparam.code   = SQLCA.sqlcode 
               LET g_errparam.popup  = TRUE 
               CALL cl_err()
               CALL s_transaction_end('N','0')
               CONTINUE WHILE
         END CASE
         
         #add-point:單身fk修改後
         {<point name="modify.body.a_fk_update"/>}
         #end add-point
         
 
         
 
         
         #UPDATE 多語言table key值
         
         
         
         
 
         CALL s_transaction_end('Y','0')
      END IF
    
      EXIT WHILE
   END WHILE
 
   #根據資料狀態切換action狀態
   CALL cl_set_act_visible("statechange,modify,modify_detail,delete,reproduce", TRUE)
   CALL aglt420_set_act_visible()   
   CALL aglt420_set_act_no_visible()
 
   #組合新增資料的條件
   LET g_add_browse = " glceent = '" ||g_enterprise|| "' AND",
                      " glceld = '", g_glce_m.glceld, "' "
                      ," AND glce001 = '", g_glce_m.glce001, "' "
                      ," AND glce002 = '", g_glce_m.glce002, "' "
 
   #填到對應位置
   CALL aglt420_browser_fill("")
 
   CLOSE aglt420_cl
   
   CALL s_transaction_end('Y','0')
 
   #功能已完成,通報訊息中心
   CALL aglt420_msgcentre_notify('modify')
 
END FUNCTION   
]]>
  </section>
  <section id="aglt420.msgcentre_notify" ver="3" status="" src="s" readonly="">
    <![CDATA[#應用 a66 樣板自動產生(Version:3)
PRIVATE FUNCTION aglt420_msgcentre_notify(lc_state)
   DEFINE lc_state LIKE type_t.chr80
   #add-point:msgcentre_notify段define
   {<point name="msgcentre_notify.define" edit="s"/>}
   #end add-point
   #add-point:msgcentre_notify段define
   {<point name="msgcentre_notify.define_customerization" edit="c"/>}
   #end add-point   
   
   INITIALIZE g_msgparam TO NULL
 
   #action-id與狀態填寫
   LET g_msgparam.state = lc_state
 
   #PK資料填寫
   CALL aglt420_set_pk_array()
   #單頭資料填寫
   LET g_msgparam.data[1] = util.JSON.stringify(g_glce_m)
 
   #add-point:msgcentre其他通知
   {<point name="msgcentre_notify.process"/>}
   #end add-point
 
   #呼叫訊息中心傳遞本關完成訊息
   CALL cl_msgcentre_notify()
 
END FUNCTION
 
 
]]>
  </section>
  <section id="aglt420.other_dialog" ver="1" status="" src="s" readonly="">
    <![CDATA[   
]]>
  </section>
  <section id="aglt420.other_function" ver="1" status="" src="s" readonly="">
    <![CDATA[{<point name="other.function"/>}
]]>
  </section>
  <section id="aglt420.query" ver="5" status="" src="s" readonly="">
    <![CDATA[#+ 資料查詢QBE功能準備
PRIVATE FUNCTION aglt420_query()
   DEFINE ls_wc STRING
   #add-point:query段define
   {<point name="query.define" edit="s"/>}
   #end add-point   
   #add-point:query段define(客製用)
   {<point name="query.define_customerization" edit="c"/>}
   #end add-point   
   
   #切換畫面
   
   LET ls_wc = g_wc
   
   LET INT_FLAG = 0
   CALL cl_navigator_setting( g_current_idx, g_detail_cnt )
   ERROR ""
   
   #清除畫面及相關資料
   CLEAR FORM
   CALL g_browser.clear()       
   CALL g_glcf_d.clear()
   CALL g_glcf2_d.clear()
   CALL g_glcf3_d.clear()
   CALL g_glcf4_d.clear()
 
   
   #add-point:query段other
   {<point name="query.other"/>}
   #end add-point   
   
   DISPLAY '' TO FORMONLY.idx
   DISPLAY '' TO FORMONLY.cnt
   DISPLAY '' TO FORMONLY.b_index
   DISPLAY '' TO FORMONLY.b_count
   DISPLAY '' TO FORMONLY.h_index
   DISPLAY '' TO FORMONLY.h_count
   
   CALL aglt420_construct()
 
   IF INT_FLAG THEN
      #取消查詢
      LET INT_FLAG = 0
      LET g_wc = ls_wc
      CALL aglt420_browser_fill("")
      CALL aglt420_fetch("")
      RETURN
   END IF
   
   #儲存WC資訊
   CALL cl_dlg_save_user_latestqry("("||g_wc||") AND ("||g_wc2||")")
   
   #搜尋後資料初始化 
   LET g_detail_cnt  = 0
   LET g_current_idx = 1
   LET g_current_row = 0
   LET g_detail_idx  = 1
   LET g_detail_idx2 = 1
   LET g_error_show  = 1
   LET g_wc_filter   = ""
   LET l_ac = 1
   CALL FGL_SET_ARR_CURR(1)
   CALL aglt420_browser_fill("F")
         
   IF g_browser_cnt = 0 THEN
      INITIALIZE g_errparam TO NULL 
      LET g_errparam.extend = "" 
      LET g_errparam.code   = "-100" 
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
   ELSE
      CALL aglt420_fetch("F") 
      #顯示單身筆數
      CALL aglt420_idx_chk()
   END IF
 
END FUNCTION
]]>
  </section>
  <section id="aglt420.reproduce" ver="15" status="" src="s" readonly="">
    <![CDATA[#+ 資料複製
PRIVATE FUNCTION aglt420_reproduce()
   DEFINE l_newno     LIKE glce_t.glceld 
   DEFINE l_oldno     LIKE glce_t.glceld 
   DEFINE l_newno02     LIKE glce_t.glce001 
   DEFINE l_oldno02     LIKE glce_t.glce001 
   DEFINE l_newno03     LIKE glce_t.glce002 
   DEFINE l_oldno03     LIKE glce_t.glce002 
 
   DEFINE l_master    RECORD LIKE glce_t.*
   DEFINE l_detail    RECORD LIKE glcf_t.*
 
 
   DEFINE l_cnt       LIKE type_t.num10
   #add-point:reproduce段define
   {<point name="reproduce.define" edit="s"/>}
   #end add-point   
   #add-point:reproduce段define(客製用)
   {<point name="reproduce.define_customerization" edit="c"/>}
   #end add-point   
   
   #切換畫面
   
   LET g_master_insert = FALSE
   
   IF g_glce_m.glceld IS NULL
   OR g_glce_m.glce001 IS NULL
   OR g_glce_m.glce002 IS NULL
 
   THEN
      INITIALIZE g_errparam TO NULL 
      LET g_errparam.extend = "" 
      LET g_errparam.code   = "std-00003" 
      LET g_errparam.popup  = FALSE 
      CALL cl_err()
      RETURN
   END IF
    
   LET g_glceld_t = g_glce_m.glceld
   LET g_glce001_t = g_glce_m.glce001
   LET g_glce002_t = g_glce_m.glce002
 
    
   LET g_glce_m.glceld = ""
   LET g_glce_m.glce001 = ""
   LET g_glce_m.glce002 = ""
 
 
   CALL cl_set_head_visible("","YES")
 
   #公用欄位給予預設值
   #應用 a14 樣板自動產生(Version:4)    
      #公用欄位新增給值  
      LET g_glce_m.glceownid = g_user
      LET g_glce_m.glceowndp = g_dept
      LET g_glce_m.glcecrtid = g_user
      LET g_glce_m.glcecrtdp = g_dept 
      LET g_glce_m.glcecrtdt = cl_get_current()
      LET g_glce_m.glcemodid = g_user
      LET g_glce_m.glcemoddt = cl_get_current()
      LET g_glce_m.glcestus = 'N'
 
 
   
   CALL s_transaction_begin()
   
   #add-point:複製輸入前
   {<point name="reproduce.head.b_input"/>}
   #end add-point
   
   #顯示狀態(stus)圖片
         #應用 a21 樣板自動產生(Version:2)
	  #根據當下狀態碼顯示圖片
      CASE g_glce_m.glcestus 
         WHEN "N"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/unconfirmed.png")
         WHEN "Y"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/confirmed.png")
         WHEN "X"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/invalid.png")
         
      END CASE
 
 
   
   #清空key欄位的desc
      LET g_glce_m.glceld_desc = ''
   DISPLAY BY NAME g_glce_m.glceld_desc
 
   
   CALL aglt420_input("r")
   
   IF INT_FLAG AND NOT g_master_insert THEN
      INITIALIZE g_errparam TO NULL 
      LET g_errparam.extend = '' 
      LET g_errparam.code   = 9001 
      LET g_errparam.popup  = FALSE 
      CALL cl_err()
      CALL s_transaction_end('N','0')
      LET INT_FLAG = 0
      DISPLAY g_detail_cnt  TO FORMONLY.h_count    #總筆數
      DISPLAY g_current_idx TO FORMONLY.h_index    #當下筆數
      LET INT_FLAG = 0
      INITIALIZE g_glce_m.* TO NULL
      INITIALIZE g_glcf_d TO NULL
      INITIALIZE g_glcf2_d TO NULL
      INITIALIZE g_glcf3_d TO NULL
      INITIALIZE g_glcf4_d TO NULL
 
      #add-point:複製取消後
      {<point name="reproduce.cancel" />}
      #end add-point
      CALL aglt420_show()
      RETURN
   END IF
   
   #根據資料狀態切換action狀態
   CALL cl_set_act_visible("statechange,modify,modify_detail,delete,reproduce", TRUE)
   CALL aglt420_set_act_visible()   
   CALL aglt420_set_act_no_visible()
   
   #將新增的資料併入搜尋條件中
   LET g_glceld_t = g_glce_m.glceld
   LET g_glce001_t = g_glce_m.glce001
   LET g_glce002_t = g_glce_m.glce002
 
   
   #組合新增資料的條件
   LET g_add_browse = " glceent = '" ||g_enterprise|| "' AND",
                      " glceld = '", g_glce_m.glceld, "' "
                      ," AND glce001 = '", g_glce_m.glce001, "' "
                      ," AND glce002 = '", g_glce_m.glce002, "' "
 
   #填到最後面
   LET g_current_idx = g_browser.getLength() + 1
   CALL aglt420_browser_fill("")
   
   DISPLAY g_browser_cnt TO FORMONLY.h_count    #總筆數
   DISPLAY g_current_idx TO FORMONLY.h_index    #當下筆數
   CALL cl_navigator_setting(g_current_idx, g_browser_cnt)
   
   #add-point:完成複製段落後
   {<point name="reproduce.after_reproduce" />}
   #end add-point
   
   CALL aglt420_idx_chk()
   
   #功能已完成,通報訊息中心
   CALL aglt420_msgcentre_notify('reproduce')
 
END FUNCTION
]]>
  </section>
  <section id="aglt420.set_act_no_visible" ver="3" status="" src="s" readonly="">
    <![CDATA[#+ 單頭權限關閉
PRIVATE FUNCTION aglt420_set_act_no_visible()
   #add-point:set_act_no_visible段define
   {<point name="set_act_no_visible.define" edit="s"/>}
   #end add-point   
   #add-point:set_act_no_visible段define(客製用)
   {<point name="set_act_no_visible.define_customerization" edit="c"/>}
   #end add-point   
   #add-point:set_act_no_visible段
   {<point name="set_act_no_visible.set_act_no_visible"/>}
   #end add-point   
END FUNCTION
]]>
  </section>
  <section id="aglt420.set_act_no_visible_b" ver="3" status="" src="s" readonly="">
    <![CDATA[#+ 單身權限關閉
PRIVATE FUNCTION aglt420_set_act_no_visible_b()
   #add-point:set_act_no_visible_b段define
   {<point name="set_act_no_visible_b.define" edit="s"/>}
   #end add-point   
   #add-point:set_act_no_visible_b段define(客製用)
   {<point name="set_act_no_visible_b.define_customerization" edit="c"/>}
   #end add-point   
   #add-point:set_act_no_visible_b段
   {<point name="set_act_no_visible_b.set_act_no_visible_b"/>}
   #end add-point   
END FUNCTION
]]>
  </section>
  <section id="aglt420.set_act_visible" ver="3" status="" src="s" readonly="">
    <![CDATA[#+ 單頭權限開啟
PRIVATE FUNCTION aglt420_set_act_visible()
   #add-point:set_act_visible段define
   {<point name="set_act_visible.define" edit="s"/>}
   #end add-point   
   #add-point:set_act_visible段define(客製用)
   {<point name="set_act_visible.define_customerization" edit="c"/>}
   #end add-point   
   #add-point:set_act_visible段
   {<point name="set_act_visible.set_act_visible"/>}
   #end add-point   
END FUNCTION
]]>
  </section>
  <section id="aglt420.set_act_visible_b" ver="3" status="" src="s" readonly="">
    <![CDATA[#+ 單身權限開啟
PRIVATE FUNCTION aglt420_set_act_visible_b()
   #add-point:set_act_visible_b段define
   {<point name="set_act_visible_b.define" edit="s"/>}
   #end add-point   
   #add-point:set_act_visible_b段define(客製用)
   {<point name="set_act_visible_b.define_customerization" edit="c"/>}
   #end add-point   
   #add-point:set_act_visible_b段
   {<point name="set_act_visible_b.set_act_visible_b"/>}
   #end add-point   
END FUNCTION
]]>
  </section>
  <section id="aglt420.set_entry" ver="6" status="" src="s" readonly="">
    <![CDATA[#+ 單頭欄位開啟設定
PRIVATE FUNCTION aglt420_set_entry(p_cmd)
   DEFINE p_cmd   LIKE type_t.chr1  
   #add-point:set_entry段define
   {<point name="set_entry.define" edit="s"/>}
   #end add-point       
   #add-point:set_entry段define(客製用)
   {<point name="set_entry.define_customerization" edit="c"/>}
   #end add-point       
   
   CALL cl_set_comp_entry("glcedocno,glceld",TRUE)
   
   IF p_cmd = 'a' THEN
      CALL cl_set_comp_entry("glceld,glce001,glce002",TRUE)
      #根據azzi850使用者身分開關特定欄位
      IF NOT cl_null(g_no_entry) THEN
         CALL cl_set_comp_entry(g_no_entry,TRUE)
      END IF
      #add-point:set_entry段欄位控制
      {<point name="set_entry.field_control"/>}
      #end add-point  
   END IF
   
   #add-point:set_entry段欄位控制後
   {<point name="set_entry.after_control"/>}
   #end add-point 
 
END FUNCTION
]]>
  </section>
  <section id="aglt420.set_entry_b" ver="3" status="" src="s" readonly="">
    <![CDATA[#+ 單身欄位開啟設定
PRIVATE FUNCTION aglt420_set_entry_b(p_cmd)
   DEFINE p_cmd   LIKE type_t.chr1   
   #add-point:set_entry_b段define
   {<point name="set_entry_b.define" edit="s"/>}
   #end add-point     
   #add-point:set_entry_b段define(客製用)
   {<point name="set_entry_b.define_customerization" edit="c"/>}
   #end add-point     
    
   IF p_cmd = 'a' THEN
      CALL cl_set_comp_entry("",TRUE)
      #add-point:set_entry段欄位控制
      {<point name="set_entry_b.field_control"/>}
      #end add-point  
   END IF
   
   #add-point:set_entry_b段
   {<point name="set_entry_b.set_entry_b"/>}
   #end add-point  
END FUNCTION
]]>
  </section>
  <section id="aglt420.set_no_entry" ver="6" status="" src="s" readonly="">
    <![CDATA[#+ 單頭欄位關閉設定
PRIVATE FUNCTION aglt420_set_no_entry(p_cmd)
   DEFINE p_cmd   LIKE type_t.chr1   
   #add-point:set_no_entry段define
   {<point name="set_no_entry.define" edit="s"/>}
   #end add-point     
   #add-point:set_no_entry段define(客製用)
   {<point name="set_no_entry.define_customerization" edit="c"/>}
   #end add-point     
   
   IF p_cmd = 'u' AND g_chkey = 'N' THEN
      CALL cl_set_comp_entry("glceld,glce001,glce002",FALSE)
      #根據azzi850使用者身分開關特定欄位
      IF NOT cl_null(g_no_entry) THEN
         CALL cl_set_comp_entry(g_no_entry,FALSE)
      END IF
      #add-point:set_no_entry段欄位控制
      {<point name="set_no_entry.field_control"/>}
      #end add-point 
   END IF 
   
   IF p_cmd = 'u' THEN
      CALL cl_set_comp_entry("glcedocno,glceld",FALSE)
   END IF 
   
   #add-point:set_no_entry段欄位控制後
   {<point name="set_no_entry.after_control"/>}
   #end add-point 
 
END FUNCTION
]]>
  </section>
  <section id="aglt420.set_no_entry_b" ver="3" status="" src="s" readonly="">
    <![CDATA[#+ 單身欄位關閉設定
PRIVATE FUNCTION aglt420_set_no_entry_b(p_cmd)
   DEFINE p_cmd   LIKE type_t.chr1   
   #add-point:set_no_entry_b段define
   {<point name="set_no_entry_b.define" edit="s"/>}
   #end add-point    
   #add-point:set_no_entry_b段define(客製用)
   {<point name="set_no_entry_b.define_customerization" edit="c"/>}
   #end add-point    
   
   IF p_cmd = 'u' AND g_chkey = 'N' THEN
      CALL cl_set_comp_entry("",FALSE)
      #add-point:set_no_entry_b段欄位控制
      {<point name="set_no_entry_b.field_control"/>}
      #end add-point 
   END IF 
   
   #add-point:set_no_entry_b段
   {<point name="set_no_entry_b.set_no_entry_b"/>}
   #end add-point     
END FUNCTION
]]>
  </section>
  <section id="aglt420.set_pk_array" ver="5" status="" src="s" readonly="">
    <![CDATA[   #應用 a51 樣板自動產生(Version:5)
#+ 給予pk_array內容
PRIVATE FUNCTION aglt420_set_pk_array()
   #add-point:set_pk_array段define
   {<point name="set_pk_array.define" edit="s"/>}
   #end add-point
   #add-point:set_pk_array段define
   {<point name="set_pk_array.define_customerization" edit="c"/>}
   #end add-point
   
   #add-point:set_pk_array段之前
   {<point name="set_pk_array.before"/>}
   #end add-point  
   
   #若l_ac<=0代表沒有資料
   IF l_ac <= 0 THEN
      RETURN
   END IF
   
   CALL g_pk_array.clear()
   LET g_pk_array[1].values = g_glce_m.glceld
   LET g_pk_array[1].column = 'glceld'
   LET g_pk_array[2].values = g_glce_m.glce001
   LET g_pk_array[2].column = 'glce001'
   LET g_pk_array[3].values = g_glce_m.glce002
   LET g_pk_array[3].column = 'glce002'
   
   #add-point:set_pk_array段之後
   {<point name="set_pk_array.after"/>}
   #end add-point  
   
END FUNCTION
 
 
]]>
  </section>
  <section id="aglt420.show" ver="14" status="" src="s" readonly="">
    <![CDATA[#+ 單頭資料重新顯示及單身資料重抓
PRIVATE FUNCTION aglt420_show()
   DEFINE l_ac_t    LIKE type_t.num10
   #add-point:show段define
   {<point name="show.define" edit="s"/>}
   #end add-point  
   #add-point:show段define(客製用)
   {<point name="show.define_customerization" edit="c"/>}
   #end add-point  
   
   #add-point:show段之前
   {<point name="show.before"/>}
   #end add-point
   
   
   
   IF g_bfill = "Y" THEN
      CALL aglt420_b_fill() #單身填充
      CALL aglt420_b_fill2('0') #單身填充
   END IF
     
   #帶出公用欄位reference值
   #應用 a12 樣板自動產生(Version:3)
 
 
   
   #顯示followup圖示
   #應用 a48 樣板自動產生(Version:2)
   CALL aglt420_set_pk_array()
   #add-point:ON ACTION agendum
   {<point name="show.follow_pic"/>}
   #END add-point
   CALL cl_user_overview_set_follow_pic()
  
 
 
   
   LET l_ac_t = l_ac
   
   #讀入ref值(單頭)
   #add-point:show段reference
   {<point name="show.head.reference"/>}
   #end add-point
   
   #遮罩相關處理
   LET g_glce_m_mask_o.* =  g_glce_m.*
   CALL aglt420_glce_t_mask()
   LET g_glce_m_mask_n.* =  g_glce_m.*
   
   #將資料輸出到畫面上
   DISPLAY BY NAME g_glce_m.glceld,g_glce_m.glceld_desc,g_glce_m.glcecomp,g_glce_m.glcecomp_desc,g_glce_m.glaa001, 
       g_glce_m.glaa016,g_glce_m.glaa020,g_glce_m.glce001,g_glce_m.glce002,g_glce_m.glce003,g_glce_m.glce003_desc, 
       g_glce_m.glce004,g_glce_m.glce006,g_glce_m.glce006_desc,g_glce_m.glce005,g_glce_m.glcedocno,g_glce_m.glcestus, 
       g_glce_m.glceownid,g_glce_m.glceownid_desc,g_glce_m.glceowndp,g_glce_m.glceowndp_desc,g_glce_m.glcecrtid, 
       g_glce_m.glcecrtid_desc,g_glce_m.glcecrtdp,g_glce_m.glcecrtdp_desc,g_glce_m.glcecrtdt,g_glce_m.glcemodid, 
       g_glce_m.glcemodid_desc,g_glce_m.glcemoddt,g_glce_m.glcecnfid,g_glce_m.glcecnfid_desc,g_glce_m.glcecnfdt, 
       g_glce_m.glcf023,g_glce_m.glcf023_desc,g_glce_m.glcf024,g_glce_m.glcf024_desc,g_glce_m.glcf025, 
       g_glce_m.glcf025_desc,g_glce_m.glcf026,g_glce_m.glcf026_desc,g_glce_m.glcf027,g_glce_m.glcf027_desc, 
       g_glce_m.glcf028,g_glce_m.glcf028_desc,g_glce_m.glcf029,g_glce_m.glcf029_desc,g_glce_m.glcf030, 
       g_glce_m.glcf030_desc,g_glce_m.glcf031,g_glce_m.glcf032,g_glce_m.glcf032_desc,g_glce_m.glcf033, 
       g_glce_m.glcf033_desc,g_glce_m.glcf034,g_glce_m.glcf034_desc,g_glce_m.glcf035,g_glce_m.glcf035_desc, 
       g_glce_m.glcf036,g_glce_m.glcf036_desc,g_glce_m.glcf037,g_glce_m.glcf038,g_glce_m.glcf039,g_glce_m.glcf040, 
       g_glce_m.glcf041,g_glce_m.glcf042,g_glce_m.glcf043,g_glce_m.glcf044,g_glce_m.glcf045,g_glce_m.glcf046 

   
   #顯示狀態(stus)圖片
         #應用 a21 樣板自動產生(Version:2)
	  #根據當下狀態碼顯示圖片
      CASE g_glce_m.glcestus 
         WHEN "N"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/unconfirmed.png")
         WHEN "Y"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/confirmed.png")
         WHEN "X"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/invalid.png")
         
      END CASE
 
 
   
   #讀入ref值(單身)
   FOR l_ac = 1 TO g_glcf_d.getLength()
      #add-point:show段單身reference
      {<point name="show.body.reference"/>}
      #end add-point
   END FOR
   
   FOR l_ac = 1 TO g_glcf2_d.getLength()
      #add-point:show段單身reference
      {<point name="show.body2.reference"/>}
      #end add-point
   END FOR
   FOR l_ac = 1 TO g_glcf3_d.getLength()
      #add-point:show段單身reference
      {<point name="show.body3.reference"/>}
      #end add-point
   END FOR
   FOR l_ac = 1 TO g_glcf4_d.getLength()
      #add-point:show段單身reference
      {<point name="show.body4.reference"/>}
      #end add-point
   END FOR
 
   
    
   
   #add-point:show段other
   {<point name="show.other"/>}
   #end add-point  
   
   LET l_ac = l_ac_t
   
   #移動上下筆可以連動切換資料
   CALL cl_show_fld_cont()     
 
   CALL aglt420_detail_show()
 
   #add-point:show段之後
   {<point name="show.after"/>}
   #end add-point
   
END FUNCTION
]]>
  </section>
  <section id="aglt420.signature" ver="1" status="" src="s" readonly="">
    <![CDATA[   
]]>
  </section>
  <section id="aglt420.state_change" ver="15" status="" src="s" readonly="">
    <![CDATA[   #應用 a09 樣板自動產生(Version:12)
#+ 確認碼變更 
PRIVATE FUNCTION aglt420_statechange()
   DEFINE lc_state LIKE type_t.chr5
   #add-point:statechange段define
   {<point name="statechange.define" edit="s"/>}
   #end add-point  
   #add-point:statechange段define(客製用)
   {<point name="statechange.define_customerization" edit="c"/>}
   #end add-point  
   
   #add-point:statechange段開始前
   {<point name="statechange.before"/>}
   #end add-point  
   
   ERROR ""     #清空畫面右下側ERROR區塊
 
   IF g_glce_m.glceld IS NULL
      OR g_glce_m.glce001 IS NULL      OR g_glce_m.glce002 IS NULL
   THEN
      INITIALIZE g_errparam TO NULL 
      LET g_errparam.extend = "" 
      LET g_errparam.code   = "std-00003" 
      LET g_errparam.popup  = FALSE 
      CALL cl_err()
      RETURN
   END IF
 
   CALL s_transaction_begin()
   
   OPEN aglt420_cl USING g_enterprise,g_glce_m.glceld,g_glce_m.glce001,g_glce_m.glce002
   IF STATUS THEN
      INITIALIZE g_errparam TO NULL 
      LET g_errparam.extend = "OPEN aglt420_cl:" 
      LET g_errparam.code   = STATUS 
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      CLOSE aglt420_cl
      CALL s_transaction_end('N','0')
      RETURN
   END IF
   
   #顯示最新的資料
   EXECUTE aglt420_master_referesh USING g_glce_m.glceld,g_glce_m.glce001,g_glce_m.glce002 INTO g_glce_m.glceld, 
       g_glce_m.glcecomp,g_glce_m.glce001,g_glce_m.glce002,g_glce_m.glce003,g_glce_m.glce004,g_glce_m.glce006, 
       g_glce_m.glce005,g_glce_m.glcedocno,g_glce_m.glcestus,g_glce_m.glceownid,g_glce_m.glceowndp,g_glce_m.glcecrtid, 
       g_glce_m.glcecrtdp,g_glce_m.glcecrtdt,g_glce_m.glcemodid,g_glce_m.glcemoddt,g_glce_m.glcecnfid, 
       g_glce_m.glcecnfdt,g_glce_m.glceld_desc,g_glce_m.glcecomp_desc,g_glce_m.glce003_desc,g_glce_m.glceownid_desc, 
       g_glce_m.glceowndp_desc,g_glce_m.glcecrtid_desc,g_glce_m.glcecrtdp_desc,g_glce_m.glcemodid_desc, 
       g_glce_m.glcecnfid_desc
 
   #檢查是否允許此動作
   IF NOT aglt420_action_chk() THEN
      CLOSE aglt420_cl
      CALL s_transaction_end('N','0')
      RETURN
   END IF
 
   #將資料顯示到畫面上
   DISPLAY BY NAME g_glce_m.glceld,g_glce_m.glceld_desc,g_glce_m.glcecomp,g_glce_m.glcecomp_desc,g_glce_m.glaa001, 
       g_glce_m.glaa016,g_glce_m.glaa020,g_glce_m.glce001,g_glce_m.glce002,g_glce_m.glce003,g_glce_m.glce003_desc, 
       g_glce_m.glce004,g_glce_m.glce006,g_glce_m.glce006_desc,g_glce_m.glce005,g_glce_m.glcedocno,g_glce_m.glcestus, 
       g_glce_m.glceownid,g_glce_m.glceownid_desc,g_glce_m.glceowndp,g_glce_m.glceowndp_desc,g_glce_m.glcecrtid, 
       g_glce_m.glcecrtid_desc,g_glce_m.glcecrtdp,g_glce_m.glcecrtdp_desc,g_glce_m.glcecrtdt,g_glce_m.glcemodid, 
       g_glce_m.glcemodid_desc,g_glce_m.glcemoddt,g_glce_m.glcecnfid,g_glce_m.glcecnfid_desc,g_glce_m.glcecnfdt, 
       g_glce_m.glcf023,g_glce_m.glcf023_desc,g_glce_m.glcf024,g_glce_m.glcf024_desc,g_glce_m.glcf025, 
       g_glce_m.glcf025_desc,g_glce_m.glcf026,g_glce_m.glcf026_desc,g_glce_m.glcf027,g_glce_m.glcf027_desc, 
       g_glce_m.glcf028,g_glce_m.glcf028_desc,g_glce_m.glcf029,g_glce_m.glcf029_desc,g_glce_m.glcf030, 
       g_glce_m.glcf030_desc,g_glce_m.glcf031,g_glce_m.glcf032,g_glce_m.glcf032_desc,g_glce_m.glcf033, 
       g_glce_m.glcf033_desc,g_glce_m.glcf034,g_glce_m.glcf034_desc,g_glce_m.glcf035,g_glce_m.glcf035_desc, 
       g_glce_m.glcf036,g_glce_m.glcf036_desc,g_glce_m.glcf037,g_glce_m.glcf038,g_glce_m.glcf039,g_glce_m.glcf040, 
       g_glce_m.glcf041,g_glce_m.glcf042,g_glce_m.glcf043,g_glce_m.glcf044,g_glce_m.glcf045,g_glce_m.glcf046 

 
   CASE g_glce_m.glcestus
      WHEN "N"
         CALL gfrm_curr.setElementImage("statechange", "stus/32/unconfirmed.png")
      WHEN "Y"
         CALL gfrm_curr.setElementImage("statechange", "stus/32/confirmed.png")
      WHEN "X"
         CALL gfrm_curr.setElementImage("statechange", "stus/32/invalid.png")
      
   END CASE
 
   #add-point:資料刷新後
   {<point name="statechange.after_refresh"/>}
   #end add-point
 
   MENU "" ATTRIBUTES (STYLE="popup")
      BEFORE MENU
         HIDE OPTION "approved"
         HIDE OPTION "rejection"
         CASE g_glce_m.glcestus
            
            WHEN "N"
               HIDE OPTION "unconfirmed"
            WHEN "Y"
               HIDE OPTION "confirmed"
            WHEN "X"
               HIDE OPTION "invalid"
         END CASE
     
      #add-point:menu前
      {<point name="statechange.before_menu"/>}
      #end add-point
      
      
	  
      ON ACTION unconfirmed
         IF cl_auth_chk_act("unconfirmed") THEN
            LET lc_state = "N"
            #add-point:action控制
            {<point name="statechange.unconfirmed"/>}
            #end add-point
         END IF
         EXIT MENU
      ON ACTION confirmed
         IF cl_auth_chk_act("confirmed") THEN
            LET lc_state = "Y"
            #add-point:action控制
            {<point name="statechange.confirmed"/>}
            #end add-point
         END IF
         EXIT MENU
      ON ACTION invalid
         IF cl_auth_chk_act("invalid") THEN
            LET lc_state = "X"
            #add-point:action控制
            {<point name="statechange.invalid"/>}
            #end add-point
         END IF
         EXIT MENU
 
      #add-point:stus控制
      {<point name="statechange.more_control"/>}
      #end add-point
      
   END MENU
   
   #確認被選取的狀態碼在清單中
   IF (lc_state <> "N" 
      AND lc_state <> "Y"
      AND lc_state <> "X"
      ) OR 
      g_glce_m.glcestus = lc_state OR cl_null(lc_state) THEN
      CLOSE aglt420_cl
      CALL s_transaction_end('N','0')
      RETURN
   END IF
   
   #add-point:stus修改前
   {<point name="statechange.b_update"/>}
   #end add-point
   
   LET g_glce_m.glcemodid = g_user
   LET g_glce_m.glcemoddt = cl_get_current()
   LET g_glce_m.glcestus = lc_state
   
   #異動狀態碼欄位/修改人/修改日期
   UPDATE glce_t 
      SET (glcestus,glcemodid,glcemoddt) 
        = (g_glce_m.glcestus,g_glce_m.glcemodid,g_glce_m.glcemoddt)     
    WHERE glceent = g_enterprise AND glceld = g_glce_m.glceld
      AND glce001 = g_glce_m.glce001      AND glce002 = g_glce_m.glce002
    
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL 
      LET g_errparam.extend = "" 
      LET g_errparam.code   = SQLCA.sqlcode 
      LET g_errparam.popup  = FALSE 
      CALL cl_err()
   ELSE
      CASE lc_state
         WHEN "N"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/unconfirmed.png")
         WHEN "Y"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/confirmed.png")
         WHEN "X"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/invalid.png")
         
      END CASE
    
      #撈取異動後的資料
      EXECUTE aglt420_master_referesh USING g_glce_m.glceld,g_glce_m.glce001,g_glce_m.glce002 INTO g_glce_m.glceld, 
          g_glce_m.glcecomp,g_glce_m.glce001,g_glce_m.glce002,g_glce_m.glce003,g_glce_m.glce004,g_glce_m.glce006, 
          g_glce_m.glce005,g_glce_m.glcedocno,g_glce_m.glcestus,g_glce_m.glceownid,g_glce_m.glceowndp, 
          g_glce_m.glcecrtid,g_glce_m.glcecrtdp,g_glce_m.glcecrtdt,g_glce_m.glcemodid,g_glce_m.glcemoddt, 
          g_glce_m.glcecnfid,g_glce_m.glcecnfdt,g_glce_m.glceld_desc,g_glce_m.glcecomp_desc,g_glce_m.glce003_desc, 
          g_glce_m.glceownid_desc,g_glce_m.glceowndp_desc,g_glce_m.glcecrtid_desc,g_glce_m.glcecrtdp_desc, 
          g_glce_m.glcemodid_desc,g_glce_m.glcecnfid_desc
      
      #將資料顯示到畫面上
      DISPLAY BY NAME g_glce_m.glceld,g_glce_m.glceld_desc,g_glce_m.glcecomp,g_glce_m.glcecomp_desc, 
          g_glce_m.glaa001,g_glce_m.glaa016,g_glce_m.glaa020,g_glce_m.glce001,g_glce_m.glce002,g_glce_m.glce003, 
          g_glce_m.glce003_desc,g_glce_m.glce004,g_glce_m.glce006,g_glce_m.glce006_desc,g_glce_m.glce005, 
          g_glce_m.glcedocno,g_glce_m.glcestus,g_glce_m.glceownid,g_glce_m.glceownid_desc,g_glce_m.glceowndp, 
          g_glce_m.glceowndp_desc,g_glce_m.glcecrtid,g_glce_m.glcecrtid_desc,g_glce_m.glcecrtdp,g_glce_m.glcecrtdp_desc, 
          g_glce_m.glcecrtdt,g_glce_m.glcemodid,g_glce_m.glcemodid_desc,g_glce_m.glcemoddt,g_glce_m.glcecnfid, 
          g_glce_m.glcecnfid_desc,g_glce_m.glcecnfdt,g_glce_m.glcf023,g_glce_m.glcf023_desc,g_glce_m.glcf024, 
          g_glce_m.glcf024_desc,g_glce_m.glcf025,g_glce_m.glcf025_desc,g_glce_m.glcf026,g_glce_m.glcf026_desc, 
          g_glce_m.glcf027,g_glce_m.glcf027_desc,g_glce_m.glcf028,g_glce_m.glcf028_desc,g_glce_m.glcf029, 
          g_glce_m.glcf029_desc,g_glce_m.glcf030,g_glce_m.glcf030_desc,g_glce_m.glcf031,g_glce_m.glcf032, 
          g_glce_m.glcf032_desc,g_glce_m.glcf033,g_glce_m.glcf033_desc,g_glce_m.glcf034,g_glce_m.glcf034_desc, 
          g_glce_m.glcf035,g_glce_m.glcf035_desc,g_glce_m.glcf036,g_glce_m.glcf036_desc,g_glce_m.glcf037, 
          g_glce_m.glcf038,g_glce_m.glcf039,g_glce_m.glcf040,g_glce_m.glcf041,g_glce_m.glcf042,g_glce_m.glcf043, 
          g_glce_m.glcf044,g_glce_m.glcf045,g_glce_m.glcf046
   END IF
 
   #add-point:stus修改後
   {<point name="statechange.a_update"/>}
   #end add-point
 
   #add-point:statechange段結束前
   {<point name="statechange.after"/>}
   #end add-point  
 
   CLOSE aglt420_cl
   CALL s_transaction_end('Y','0')
 
   #功能已完成,通報訊息中心
   CALL aglt420_msgcentre_notify('statechange:'||lc_state)
   
END FUNCTION
 
 
]]>
  </section>
  <section id="aglt420.status_show" ver="1" status="" src="s" readonly="">
    <![CDATA[PRIVATE FUNCTION aglt420_status_show()
   #add-point:status_show段define
   {<point name="status_show.define" edit="s"/>}
   #end add-point
   #add-point:status_show段define(客製用)
   {<point name="status_show.define_customerization" edit="c"/>}
   #end add-point
   
   #add-point:status_show段status_show
   {<point name="status_show.status_show"/>}
   #end add-point
END FUNCTION
]]>
  </section>
  <section id="aglt420.ui_browser_refresh" ver="4" status="" src="s" readonly="">
    <![CDATA[#+ 瀏覽頁簽資料重新顯示
PRIVATE FUNCTION aglt420_ui_browser_refresh()
   DEFINE l_i  LIKE type_t.num10
   #add-point:ui_browser_refresh段define
   {<point name="ui_browser_refresh.define" edit="s"/>}
   #end add-point    
   #add-point:ui_browser_refresh段define(客製用)
   {<point name="ui_browser_refresh.define_customerization" edit="c"/>}
   #end add-point    
   
   LET g_browser_cnt = g_browser.getLength()
   LET g_header_cnt  = g_browser.getLength()
   FOR l_i =1 TO g_browser.getLength()
      IF g_browser[l_i].b_glceld = g_glce_m.glceld 
         AND g_browser[l_i].b_glce001 = g_glce_m.glce001 
         AND g_browser[l_i].b_glce002 = g_glce_m.glce002 
 
         THEN
         CALL g_browser.deleteElement(l_i)
         EXIT FOR
      END IF
   END FOR
   LET g_browser_cnt = g_browser_cnt - 1
   LET g_header_cnt = g_header_cnt - 1
    
   #若無資料則關閉相關功能
   IF g_browser_cnt = 0 THEN
      CALL cl_set_act_visible("statechange,modify,modify_detail,delete,reproduce,mainhidden", FALSE)
      CALL cl_navigator_setting(0,0)
      CLEAR FORM
   ELSE
      CALL cl_set_act_visible("mainhidden", TRUE)
   END IF
   
   #add-point:ui_browser_refresh段after
   {<point name="ui_browser_refresh.after"/>}
   #end add-point    
   
END FUNCTION
]]>
  </section>
  <section id="aglt420.ui_detailshow" ver="3" status="" src="s" readonly="">
    <![CDATA[#+ 單身資料重新顯示
PRIVATE FUNCTION aglt420_ui_detailshow()
   #add-point:ui_detailshow段define
   {<point name="ui_detailshow.define" edit="s"/>}
   #end add-point    
   #add-point:ui_detailshow段define(客製用)
   {<point name="ui_detailshow.define_customerization" edit="c"/>}
   #end add-point    
   
   #add-point:ui_detailshow段before
   {<point name="ui_detailshow.before"/>}
   #end add-point    
   
   IF g_curr_diag IS NOT NULL THEN
      CALL g_curr_diag.setCurrentRow("s_detail1",g_detail_idx)      
      CALL g_curr_diag.setCurrentRow("s_detail2",g_detail_idx)
      CALL g_curr_diag.setCurrentRow("s_detail3",g_detail_idx)
      CALL g_curr_diag.setCurrentRow("s_detail4",g_detail_idx)
 
   END IF
   
   #add-point:ui_detailshow段after
   {<point name="ui_detailshow.after"/>}
   #end add-point    
   
END FUNCTION
]]>
  </section>
  <section id="aglt420.ui_dialog" ver="29" status="" src="s" readonly="">
    <![CDATA[#+ 功能選單
PRIVATE FUNCTION aglt420_ui_dialog()
   DEFINE li_idx     LIKE type_t.num10
   DEFINE ls_wc      STRING
   DEFINE lb_first   BOOLEAN
   DEFINE la_wc      DYNAMIC ARRAY OF RECORD
          tableid    STRING,
          wc         STRING
          END RECORD
   DEFINE la_param   RECORD
          prog       STRING,
          actionid   STRING,
          background LIKE type_t.chr1,
          param      DYNAMIC ARRAY OF STRING
          END RECORD
   DEFINE ls_js      STRING
   DEFINE la_output  DYNAMIC ARRAY OF STRING   #報表元件鬆耦合使用
   #add-point:ui_dialog段define
   {<point name="ui_dialog.define" edit="s"/>}
   #end add-point
   #add-point:ui_dialog段define(客製用)
   {<point name="ui_dialog.define_customerization" edit="c"/>}
   #end add-point
   
   CALL cl_set_act_visible("accept,cancel", FALSE)
 
   
   #action default動作
   #應用 a42 樣板自動產生(Version:2)
   #進入程式時預設執行的動作
   CASE g_actdefault
      WHEN "insert"
         LET g_action_choice="insert"
         LET g_actdefault = ""
         IF cl_auth_chk_act("insert") THEN
            CALL aglt420_insert()
            #add-point:ON ACTION insert
            {<point name="menu.default.insert" />}
            #END add-point
         END IF
 
      #add-point:action default自訂
      {<point name="ui_dialog.action_default"/>}
      #end add-point
      OTHERWISE
   END CASE
 
 
   
   LET lb_first = TRUE
   
   #add-point:ui_dialog段before dialog 
   {<point name="ui_dialog.before_dialog"/>}
   #end add-point
   
   WHILE TRUE 
   
      IF g_action_choice = "logistics" THEN
         #清除畫面及相關資料
         CLEAR FORM
         CALL g_browser.clear()       
         INITIALIZE g_glce_m.* TO NULL
         CALL g_glcf_d.clear()
         CALL g_glcf2_d.clear()
         CALL g_glcf3_d.clear()
         CALL g_glcf4_d.clear()
 
         LET g_wc  = ' 1=2'
         LET g_wc2 = ' 1=1'
         LET g_action_choice = ""
         CALL aglt420_init()
      END IF
   
            
      DIALOG ATTRIBUTES(UNBUFFERED,FIELD ORDER FORM)
 
    
         DISPLAY ARRAY g_glcf_d TO s_detail1.* ATTRIBUTES(COUNT=g_rec_b) #page1  
    
            BEFORE ROW
               #顯示單身筆數
               CALL aglt420_idx_chk()
               #確定當下選擇的筆數
               LET l_ac = DIALOG.getCurrentRow("s_detail1")
               LET g_detail_idx = l_ac
               
               #add-point:page1, before row動作
               {<point name="ui_dialog.page1.before_row"/>}
               #end add-point
               
            BEFORE DISPLAY
               #如果一直都在單身1則控制筆數位置
               IF g_loc = 'm' THEN
                  CALL FGL_SET_ARR_CURR(g_detail_idx)
               END IF
               LET g_loc = 'm'
               LET l_ac = DIALOG.getCurrentRow("s_detail1")
               LET g_current_page = 1
               #顯示單身筆數
               CALL aglt420_idx_chk()
               #add-point:page1自定義行為
               {<point name="ui_dialog.page1.before_display"/>}
               #end add-point
               
            #自訂ACTION(detail_show,page_1)
            
               
            #add-point:page1自定義行為
            {<point name="ui_dialog.page1.action"/>}
            #end add-point
               
         END DISPLAY
        
         #第一階單身段落
         DISPLAY ARRAY g_glcf2_d TO s_detail2.* ATTRIBUTES(COUNT=g_rec_b)  
    
            BEFORE ROW
               #顯示單身筆數
               CALL aglt420_idx_chk()
               LET l_ac = DIALOG.getCurrentRow("s_detail2")
               LET g_detail_idx = l_ac
               
               #add-point:page2, before row動作
               {<point name="ui_dialog.body2.before_row"/>}
               #end add-point
               
            BEFORE DISPLAY
               #如果一直都在單身1則控制筆數位置
               IF g_loc = 'm' THEN
                  CALL FGL_SET_ARR_CURR(g_detail_idx)
               END IF
               LET g_loc = 'm'
               LET l_ac = DIALOG.getCurrentRow("s_detail2")
               LET g_current_page = 2
               #顯示單身筆數
               CALL aglt420_idx_chk()
               #add-point:page2自定義行為
               {<point name="ui_dialog.body2.before_display"/>}
               #end add-point
      
            #自訂ACTION(detail_show,page_2)
            
         
            #add-point:page2自定義行為
            {<point name="ui_dialog.body2.action"/>}
            #end add-point
         
         END DISPLAY
         #第一階單身段落
         DISPLAY ARRAY g_glcf3_d TO s_detail3.* ATTRIBUTES(COUNT=g_rec_b)  
    
            BEFORE ROW
               #顯示單身筆數
               CALL aglt420_idx_chk()
               LET l_ac = DIALOG.getCurrentRow("s_detail3")
               LET g_detail_idx = l_ac
               
               #add-point:page3, before row動作
               {<point name="ui_dialog.body3.before_row"/>}
               #end add-point
               
            BEFORE DISPLAY
               #如果一直都在單身1則控制筆數位置
               IF g_loc = 'm' THEN
                  CALL FGL_SET_ARR_CURR(g_detail_idx)
               END IF
               LET g_loc = 'm'
               LET l_ac = DIALOG.getCurrentRow("s_detail3")
               LET g_current_page = 3
               #顯示單身筆數
               CALL aglt420_idx_chk()
               #add-point:page3自定義行為
               {<point name="ui_dialog.body3.before_display"/>}
               #end add-point
      
            #自訂ACTION(detail_show,page_3)
            
         
            #add-point:page3自定義行為
            {<point name="ui_dialog.body3.action"/>}
            #end add-point
         
         END DISPLAY
         #第一階單身段落
         DISPLAY ARRAY g_glcf4_d TO s_detail4.* ATTRIBUTES(COUNT=g_rec_b)  
    
            BEFORE ROW
               #顯示單身筆數
               CALL aglt420_idx_chk()
               LET l_ac = DIALOG.getCurrentRow("s_detail4")
               LET g_detail_idx = l_ac
               
               #add-point:page4, before row動作
               {<point name="ui_dialog.body4.before_row"/>}
               #end add-point
               
            BEFORE DISPLAY
               #如果一直都在單身1則控制筆數位置
               IF g_loc = 'm' THEN
                  CALL FGL_SET_ARR_CURR(g_detail_idx)
               END IF
               LET g_loc = 'm'
               LET l_ac = DIALOG.getCurrentRow("s_detail4")
               LET g_current_page = 4
               #顯示單身筆數
               CALL aglt420_idx_chk()
               #add-point:page4自定義行為
               {<point name="ui_dialog.body4.before_display"/>}
               #end add-point
      
            #自訂ACTION(detail_show,page_4)
            
         
            #add-point:page4自定義行為
            {<point name="ui_dialog.body4.action"/>}
            #end add-point
         
         END DISPLAY
 
         
 
         
         #add-point:ui_dialog段自定義display array
         {<point name="ui_dialog.more_displayarray"/>}
         #end add-point
         
      
         BEFORE DIALOG
            #先填充browser資料
            CALL aglt420_browser_fill("")
            CALL cl_notice()
            CALL cl_navigator_setting(g_current_idx, g_detail_cnt)
            LET g_curr_diag = ui.DIALOG.getCurrent()
            LET g_current_sw = FALSE
            #回歸舊筆數位置 (回到當時異動的筆數)
            
            #確保g_current_idx位於正常區間內
            #小於,等於0則指到第1筆
            IF g_current_idx <= 0 THEN
               LET g_current_idx = 1
            END IF
            #超過最大筆數則指到最後1筆
            IF g_current_idx > g_browser.getLength() THEN
               LEt g_current_idx = g_browser.getLength()
            END IF 
            
            LET g_current_sw = TRUE
            LET g_current_row = g_current_idx #目前指標
            
            #有資料才進行fetch
            IF g_current_idx <> 0 THEN
               CALL aglt420_fetch('') # reload data
            END IF
            #LET g_detail_idx = 1
            CALL aglt420_ui_detailshow() #Setting the current row 
            
            #筆數顯示
            LET g_current_page = 1
            CALL aglt420_idx_chk()
            CALL cl_ap_performance_cal()
            #add-point:ui_dialog段before_dialog2
            {<point name="ui_dialog.before_dialog2"/>}
            #end add-point
 
         #狀態碼切換
         ON ACTION statechange
            LET g_action_choice = "statechange"
            CALL aglt420_statechange()
            #根據資料狀態切換action狀態
            CALL cl_set_act_visible("statechange,modify,modify_detail,delete,reproduce", TRUE)
            CALL aglt420_set_act_visible()   
            CALL aglt420_set_act_no_visible()
            IF NOT (g_glce_m.glceld IS NULL
              OR g_glce_m.glce001 IS NULL
              OR g_glce_m.glce002 IS NULL
 
              ) THEN
               #組合條件
               LET g_add_browse = " glceent = '" ||g_enterprise|| "' AND",
                                  " glceld = '", g_glce_m.glceld, "' "
                                  ," AND glce001 = '", g_glce_m.glce001, "' "
                                  ," AND glce002 = '", g_glce_m.glce002, "' "
 
               #填到對應位置
               CALL aglt420_browser_fill("")
            END IF
         
          
         #查詢方案選擇 
         ON ACTION queryplansel
            CALL cl_dlg_qryplan_select() RETURNING ls_wc
            #不是空條件才寫入g_wc跟重新找資料
            IF NOT cl_null(ls_wc) THEN
               CALL util.JSON.parse(ls_wc, la_wc)
               INITIALIZE g_wc, g_wc2,g_wc2_table1,g_wc2_extend TO NULL
 
               FOR li_idx = 1 TO la_wc.getLength()
                  CASE
                     WHEN la_wc[li_idx].tableid = "glce_t" 
                        LET g_wc = la_wc[li_idx].wc
                     WHEN la_wc[li_idx].tableid = "glcf_t" 
                        LET g_wc2_table1 = la_wc[li_idx].wc
 
                     WHEN la_wc[li_idx].tableid = "EXTENDWC"
                        LET g_wc2_extend = la_wc[li_idx].wc
                  END CASE
               END FOR
               IF NOT cl_null(g_wc) OR NOT cl_null(g_wc2_table1) 
 
                  OR NOT cl_null(g_wc2_extend)
                  THEN
                  #組合g_wc2
                  IF g_wc2_table1 <> " 1=1" AND NOT cl_null(g_wc2_table1) THEN
                     LET g_wc2 = g_wc2_table1
                  END IF
 
                  IF g_wc2_extend <> " 1=1" AND NOT cl_null(g_wc2_extend) THEN
                     LET g_wc2 = g_wc2 ," AND ", g_wc2_extend
                  END IF
 
                  IF g_wc2.subString(1,5) = " AND " THEN
                     LET g_wc2 = g_wc2.subString(6,g_wc2.getLength())
                  END IF
               END IF
               CALL aglt420_browser_fill("F")   #browser_fill()會將notice區塊清空
            END IF
         
         #查詢方案選擇
         ON ACTION qbe_select
            CALL cl_qbe_list("m") RETURNING ls_wc
            IF NOT cl_null(ls_wc) THEN
               CALL util.JSON.parse(ls_wc, la_wc)
               INITIALIZE g_wc, g_wc2,g_wc2_table1,g_wc2_extend TO NULL
 
               FOR li_idx = 1 TO la_wc.getLength()
                  CASE
                     WHEN la_wc[li_idx].tableid = "glce_t" 
                        LET g_wc = la_wc[li_idx].wc
                     WHEN la_wc[li_idx].tableid = "glcf_t" 
                        LET g_wc2_table1 = la_wc[li_idx].wc
 
                     WHEN la_wc[li_idx].tableid = "EXTENDWC"
                        LET g_wc2_extend = la_wc[li_idx].wc
                  END CASE
               END FOR
               IF NOT cl_null(g_wc) OR NOT cl_null(g_wc2_table1)
 
                  OR NOT cl_null(g_wc2_extend)
                  THEN
                  IF g_wc2_table1 <> " 1=1" AND NOT cl_null(g_wc2_table1) THEN
                     LET g_wc2 = g_wc2_table1
                  END IF
 
                  IF g_wc2_extend <> " 1=1" AND NOT cl_null(g_wc2_extend) THEN
                     LET g_wc2 = g_wc2 ," AND ", g_wc2_extend
                  END IF
                  IF g_wc2.subString(1,5) = " AND " THEN
                     LET g_wc2 = g_wc2.subString(6,g_wc2.getLength())
                  END IF
                  #取得條件後需要重查、跳到結果第一筆資料的功能程式段
                  CALL aglt420_browser_fill("F")
                  IF g_browser_cnt = 0 THEN
                     INITIALIZE g_errparam TO NULL 
                     LET g_errparam.extend = "" 
                     LET g_errparam.code   = "-100" 
                     LET g_errparam.popup  = TRUE 
                     CALL cl_err()
                     CLEAR FORM
                  ELSE
                     CALL aglt420_fetch("F")
                  END IF
               END IF
            END IF
            #重新搜尋會將notice區塊清空,此處不可用EXIT DIALOG, SUBDIALOG重讀會導致部分變數消失
          
         
         
         ON ACTION first
            LET g_action_choice = "fetch"
            CALL aglt420_fetch('F')
            LET g_current_row = g_current_idx
            LET g_curr_diag = ui.DIALOG.getCurrent()
            CALL aglt420_idx_chk()
            
         ON ACTION previous
            LET g_action_choice = "fetch"
            CALL aglt420_fetch('P')
            LET g_current_row = g_current_idx
            LET g_curr_diag = ui.DIALOG.getCurrent()
            CALL aglt420_idx_chk()
            
         ON ACTION jump
            LET g_action_choice = "fetch"
            CALL aglt420_fetch('/')
            LET g_current_row = g_current_idx
            LET g_curr_diag = ui.DIALOG.getCurrent()
            CALL aglt420_idx_chk()
            
         ON ACTION next
            LET g_action_choice = "fetch"
            CALL aglt420_fetch('N')
            LET g_current_row = g_current_idx
            LET g_curr_diag = ui.DIALOG.getCurrent()
            CALL aglt420_idx_chk()
            
         ON ACTION last
            LET g_action_choice = "fetch"
            CALL aglt420_fetch('L')
            LET g_current_row = g_current_idx
            LET g_curr_diag = ui.DIALOG.getCurrent()
            CALL aglt420_idx_chk()
          
         #excel匯出功能          
         ON ACTION exporttoexcel
            LET g_action_choice="exporttoexcel"
            IF cl_auth_chk_act("exporttoexcel") THEN
               #browser
               CALL g_export_node.clear()
               IF g_main_hidden = 1 THEN
                  LET g_export_node[1] = base.typeInfo.create(g_browser)
                  LET g_export_id[1]   = "s_browse"
                  CALL cl_export_to_excel()
               #非browser
               ELSE
                  LET g_export_node[1] = base.typeInfo.create(g_glcf_d)
                  LET g_export_id[1]   = "s_detail1"
                  LET g_export_node[2] = base.typeInfo.create(g_glcf2_d)
                  LET g_export_id[2]   = "s_detail2"
                  LET g_export_node[3] = base.typeInfo.create(g_glcf3_d)
                  LET g_export_id[3]   = "s_detail3"
                  LET g_export_node[4] = base.typeInfo.create(g_glcf4_d)
                  LET g_export_id[4]   = "s_detail4"
 
                  #add-point:ON ACTION exporttoexcel
                  {<point name="menu.exporttoexcel" />}
                  #END add-point
                  CALL cl_export_to_excel_getpage()
                  CALL cl_export_to_excel()
               END IF
            END IF
        
         ON ACTION close
            LET INT_FLAG = FALSE
            LET g_action_choice = "exit"
            EXIT DIALOG
          
         ON ACTION exit
            LET g_action_choice = "exit"
            EXIT DIALOG
    
         #主頁摺疊
         ON ACTION mainhidden       
            IF g_main_hidden THEN
               CALL gfrm_curr.setElementHidden("mainlayout",0)
               CALL gfrm_curr.setElementHidden("worksheet",1)
               LET g_main_hidden = 0
            ELSE
               CALL gfrm_curr.setElementHidden("mainlayout",1)
               CALL gfrm_curr.setElementHidden("worksheet",0)
               LET g_main_hidden = 1
               CALL cl_notice()
            END IF
            
       
         #單頭摺疊，可利用hot key "Alt-s"開啟/關閉單頭
         ON ACTION controls     
            IF g_header_hidden THEN
               CALL gfrm_curr.setElementHidden("vb_master",0)
               CALL gfrm_curr.setElementImage("controls","small/arr-u.png")
               LET g_header_hidden = 0     #visible
            ELSE
               CALL gfrm_curr.setElementHidden("vb_master",1)
               CALL gfrm_curr.setElementImage("controls","small/arr-d.png")
               LET g_header_hidden = 1     #hidden     
            END IF
    
         
         #應用 a43 樣板自動產生(Version:2)
         ON ACTION modify
            LET g_action_choice="modify"
            IF cl_auth_chk_act("modify") THEN
               LET g_aw = ''
               CALL aglt420_modify()
               #add-point:ON ACTION modify
               {<point name="menu.modify" />}
               #END add-point
               
            END IF
 
 
 
         #應用 a43 樣板自動產生(Version:2)
         ON ACTION modify_detail
            LET g_action_choice="modify_detail"
            IF cl_auth_chk_act("modify") THEN
               LET g_aw = g_curr_diag.getCurrentItem()
               CALL aglt420_modify()
               #add-point:ON ACTION modify_detail
               {<point name="menu.modify_detail" />}
               #END add-point
               
            END IF
 
 
 
         #應用 a43 樣板自動產生(Version:2)
         ON ACTION open_aglt420_01
            LET g_action_choice="open_aglt420_01"
            IF cl_auth_chk_act("open_aglt420_01") THEN
               
               #add-point:ON ACTION open_aglt420_01
               {<point name="menu.open_aglt420_01" />}
               #END add-point
               
            END IF
 
 
 
         #應用 a43 樣板自動產生(Version:2)
         ON ACTION open_pre
            LET g_action_choice="open_pre"
            IF cl_auth_chk_act("open_pre") THEN
               
               #add-point:ON ACTION open_pre
               {<point name="menu.open_pre" />}
               #END add-point
               
            END IF
 
 
 
         #應用 a43 樣板自動產生(Version:2)
         ON ACTION delete
            LET g_action_choice="delete"
            IF cl_auth_chk_act("delete") THEN
               CALL aglt420_delete()
               #add-point:ON ACTION delete
               {<point name="menu.delete" />}
               #END add-point
               
            END IF
 
 
 
         #應用 a43 樣板自動產生(Version:2)
         ON ACTION insert
            LET g_action_choice="insert"
            IF cl_auth_chk_act("insert") THEN
               CALL aglt420_insert()
               #add-point:ON ACTION insert
               {<point name="menu.insert" />}
               #END add-point
               
            END IF
 
 
 
         #應用 a43 樣板自動產生(Version:2)
         ON ACTION output
            LET g_action_choice="output"
            IF cl_auth_chk_act("output") THEN
               
               #add-point:ON ACTION output
               {<point name="menu.output" />}
               #END add-point
               &include "erp/agl/aglt420_rep.4gl"
               
            END IF
 
 
 
         #應用 a43 樣板自動產生(Version:2)
         ON ACTION reproduce
            LET g_action_choice="reproduce"
            IF cl_auth_chk_act("reproduce") THEN
               CALL aglt420_reproduce()
               #add-point:ON ACTION reproduce
               {<point name="menu.reproduce" />}
               #END add-point
               
            END IF
 
 
 
         #應用 a43 樣板自動產生(Version:2)
         ON ACTION open_aglt310_02
            LET g_action_choice="open_aglt310_02"
            IF cl_auth_chk_act("open_aglt310_02") THEN
               
               #add-point:ON ACTION open_aglt310_02
               {<point name="menu.open_aglt310_02" />}
               #END add-point
               
            END IF
 
 
 
         #應用 a43 樣板自動產生(Version:2)
         ON ACTION query
            LET g_action_choice="query"
            IF cl_auth_chk_act("query") THEN
               CALL aglt420_query()
               #add-point:ON ACTION query
               {<point name="menu.query" />}
               #END add-point
               #應用 a59 樣板自動產生(Version:2)  
               CALL g_curr_diag.setCurrentRow("s_detail1",1)
               CALL g_curr_diag.setCurrentRow("s_detail2",1)
               CALL g_curr_diag.setCurrentRow("s_detail3",1)
               CALL g_curr_diag.setCurrentRow("s_detail4",1)
 
 
 
            END IF
 
 
 
         #應用 a43 樣板自動產生(Version:2)
         ON ACTION un_voucher
            LET g_action_choice="un_voucher"
            IF cl_auth_chk_act("un_voucher") THEN
               
               #add-point:ON ACTION un_voucher
               {<point name="menu.un_voucher" />}
               #END add-point
               
            END IF
 
 
 
         #應用 a43 樣板自動產生(Version:2)
         ON ACTION exchange_ld
            LET g_action_choice="exchange_ld"
            IF cl_auth_chk_act("exchange_ld") THEN
               
               #add-point:ON ACTION exchange_ld
               {<point name="menu.exchange_ld" />}
               #END add-point
               
            END IF
 
 
 
         #應用 a43 樣板自動產生(Version:2)
         ON ACTION open_axrt300_13
            LET g_action_choice="open_axrt300_13"
            IF cl_auth_chk_act("open_axrt300_13") THEN
               
               #add-point:ON ACTION open_axrt300_13
               {<point name="menu.open_axrt300_13" />}
               #END add-point
               
            END IF
 
 
 
         #應用 a43 樣板自動產生(Version:2)
         ON ACTION prog_glce005
            LET g_action_choice="prog_glce005"
            IF cl_auth_chk_act("prog_glce005") THEN
               
               #add-point:ON ACTION prog_glce005
               {<point name="menu.prog_glce005" />}
               #END add-point
               
            END IF
 
 
 
         #應用 a43 樣板自動產生(Version:2)
         ON ACTION prog_glcf034
            LET g_action_choice="prog_glcf034"
            IF cl_auth_chk_act("prog_glcf034") THEN
               
               #add-point:ON ACTION prog_glcf034
               {<point name="menu.prog_glcf034" />}
               #END add-point
               
            END IF
 
 
 
         
         #應用 a46 樣板自動產生(Version:2)
         #新增相關文件
         ON ACTION related_document
            CALL aglt420_set_pk_array()
            IF cl_auth_chk_act("related_document") THEN
               #add-point:ON ACTION related_document
               {<point name="ui_dialog.dialog.related_document"/>}
               #END add-point
               CALL cl_doc()
            END IF
            
         ON ACTION agendum
            CALL aglt420_set_pk_array()
            #add-point:ON ACTION agendum
            {<point name="ui_dialog.dialog.agendum"/>}
            #END add-point
            CALL cl_user_overview()
            CALL cl_user_overview_set_follow_pic()
         
         ON ACTION followup
            CALL aglt420_set_pk_array()
            #add-point:ON ACTION followup
            {<point name="ui_dialog.dialog.followup"/>}
            #END add-point
            CALL cl_user_overview_follow('')
 
 
         
         #主選單用ACTION
         &include "main_menu_exit_dialog.4gl"
         &include "relating_action.4gl"
    
         #交談指令共用ACTION
         &include "common_action.4gl" 
            CONTINUE DIALOG
      END DIALOG
    
      IF g_action_choice = "exit" AND NOT cl_null(g_action_choice) THEN
         #add-point:ui_dialog段離開dialog前
         {<point name="ui_dialog.b_exit"/>}
         #end add-point
         EXIT WHILE
      END IF
    
   END WHILE    
      
   CALL cl_set_act_visible("accept,cancel", TRUE)
    
END FUNCTION
]]>
  </section>
  <section id="aglt420.ui_headershow" ver="7" status="" src="s" readonly="">
    <![CDATA[#+ 單頭資料重新顯示
PRIVATE FUNCTION aglt420_ui_headershow()
   #add-point:ui_headershow段define
   {<point name="ui_headershow.define" edit="s"/>}
   #end add-point    
   #add-point:ui_headershow段define(客製用)
   {<point name="ui_headershow.define_customerization" edit="c"/>}
   #end add-point    
   
   LET g_glce_m.glceld = g_browser[g_current_idx].b_glceld   
   LET g_glce_m.glce001 = g_browser[g_current_idx].b_glce001   
   LET g_glce_m.glce002 = g_browser[g_current_idx].b_glce002   
 
   EXECUTE aglt420_master_referesh USING g_glce_m.glceld,g_glce_m.glce001,g_glce_m.glce002 INTO g_glce_m.glceld, 
       g_glce_m.glcecomp,g_glce_m.glce001,g_glce_m.glce002,g_glce_m.glce003,g_glce_m.glce004,g_glce_m.glce006, 
       g_glce_m.glce005,g_glce_m.glcedocno,g_glce_m.glcestus,g_glce_m.glceownid,g_glce_m.glceowndp,g_glce_m.glcecrtid, 
       g_glce_m.glcecrtdp,g_glce_m.glcecrtdt,g_glce_m.glcemodid,g_glce_m.glcemoddt,g_glce_m.glcecnfid, 
       g_glce_m.glcecnfdt,g_glce_m.glceld_desc,g_glce_m.glcecomp_desc,g_glce_m.glce003_desc,g_glce_m.glceownid_desc, 
       g_glce_m.glceowndp_desc,g_glce_m.glcecrtid_desc,g_glce_m.glcecrtdp_desc,g_glce_m.glcemodid_desc, 
       g_glce_m.glcecnfid_desc
   CALL aglt420_glce_t_mask()
   CALL aglt420_show()
      
END FUNCTION
]]>
  </section>
  <section id="aglt420.unlock_b" ver="3" status="" src="s" readonly="">
    <![CDATA[#+ 連動unlock其他單身table資料
PRIVATE FUNCTION aglt420_unlock_b(ps_table,ps_page)
   DEFINE ps_page     STRING
   DEFINE ps_table    STRING
   DEFINE ls_group    STRING
   #add-point:unlock_b段define
   {<point name="unlock_b.define" edit="s"/>}
   #end add-point  
   #add-point:unlock_b段define(客製用)
   {<point name="unlock_b.define_customerization" edit="c"/>}
   #end add-point  
    
   LET ls_group = "'1','2','3','4',"
   
   IF ls_group.getIndexOf(ps_page,1) THEN
      CLOSE aglt420_bcl
   END IF
   
 
   
 
 
   #add-point:unlock_b段other
   {<point name="unlock_b.other"/>}
   #end add-point  
 
END FUNCTION
]]>
  </section>
  <section id="aglt420.update_b" ver="6" status="" src="s" readonly="">
    <![CDATA[#+ 修改單身後其他table連動
PRIVATE FUNCTION aglt420_update_b(ps_table,ps_keys,ps_keys_bak,ps_page)
   DEFINE ps_table         STRING
   DEFINE ps_page          STRING
   DEFINE ps_keys          DYNAMIC ARRAY OF VARCHAR(500)
   DEFINE ps_keys_bak      DYNAMIC ARRAY OF VARCHAR(500)
   DEFINE ls_group         STRING
   DEFINE li_idx           LIKE type_t.num10 
   DEFINE lb_chk           BOOLEAN
   DEFINE l_new_key        DYNAMIC ARRAY OF STRING
   DEFINE l_old_key        DYNAMIC ARRAY OF STRING
   DEFINE l_field_key      DYNAMIC ARRAY OF STRING
   #add-point:update_b段define
   {<point name="update_b.define" edit="s"/>}
   #end add-point   
   #add-point:update_b段define(客製用)
   {<point name="update_b.define_customerization" edit="c"/>}
   #end add-point   
   
   LET g_update = TRUE   
   
   #判斷key是否有改變
   LET lb_chk = TRUE
   FOR li_idx = 1 TO ps_keys.getLength()
      IF ps_keys[li_idx] <> ps_keys_bak[li_idx] THEN
         LET lb_chk = FALSE
         EXIT FOR
      END IF
   END FOR
   
   #不需要做處理
   IF lb_chk THEN
      RETURN
   END IF
   
   #判斷是否是同一群組的table
   LET ls_group = "'1','2','3','4',"
   IF ls_group.getIndexOf(ps_page,1) > 0 AND ps_table <> "glcf_t" THEN
      #add-point:update_b段修改前
      {<point name="update_b.before_update" mark="Y"/>}
      #end add-point 
      
      #將遮罩欄位還原
      CALL aglt420_glcf_t_mask_restore('restore_mask_o')
               
      UPDATE glcf_t 
         SET (glcfld,glcf001,glcf002,
              glcf003,glcf004,glcf005
              ,glcf006,glcf007,glcf008,glcf009,glcf010,glcf011,glcf012,glcf073,glcf013,glcf014,glcf015,glcf016,glcf017,glcf018,glcf019,glcf020,glcf021,glcf022,glcf047,glcf048,glcf049,glcf050,glcf051,glcf052,glcf053,glcf054,glcf055,glcf056,glcf057,glcf058,glcf059,glcf060,glcf061,glcf062,glcf063,glcf064,glcf065,glcf066,glcf067,glcf068,glcf069,glcf070,glcf071,glcf072) 
              = 
             (ps_keys[1],ps_keys[2],ps_keys[3],ps_keys[4],ps_keys[5],ps_keys[6]
              ,g_glcf_d[g_detail_idx].glcf006,g_glcf_d[g_detail_idx].glcf007,g_glcf_d[g_detail_idx].glcf008, 
                  g_glcf_d[g_detail_idx].glcf009,g_glcf_d[g_detail_idx].glcf010,g_glcf_d[g_detail_idx].glcf011, 
                  g_glcf_d[g_detail_idx].glcf012,g_glcf_d[g_detail_idx].glcf073,g_glcf2_d[g_detail_idx].glcf013, 
                  g_glcf2_d[g_detail_idx].glcf014,g_glcf2_d[g_detail_idx].glcf015,g_glcf2_d[g_detail_idx].glcf016, 
                  g_glcf2_d[g_detail_idx].glcf017,g_glcf3_d[g_detail_idx].glcf018,g_glcf3_d[g_detail_idx].glcf019, 
                  g_glcf3_d[g_detail_idx].glcf020,g_glcf3_d[g_detail_idx].glcf021,g_glcf3_d[g_detail_idx].glcf022, 
                  g_glcf4_d[g_detail_idx].glcf047,g_glcf4_d[g_detail_idx].glcf048,g_glcf4_d[g_detail_idx].glcf049, 
                  g_glcf4_d[g_detail_idx].glcf050,g_glcf4_d[g_detail_idx].glcf051,g_glcf4_d[g_detail_idx].glcf052, 
                  g_glcf4_d[g_detail_idx].glcf053,g_glcf4_d[g_detail_idx].glcf054,g_glcf4_d[g_detail_idx].glcf055, 
                  g_glcf4_d[g_detail_idx].glcf056,g_glcf4_d[g_detail_idx].glcf057,g_glcf4_d[g_detail_idx].glcf058, 
                  g_glcf4_d[g_detail_idx].glcf059,g_glcf4_d[g_detail_idx].glcf060,g_glcf4_d[g_detail_idx].glcf061, 
                  g_glcf4_d[g_detail_idx].glcf062,g_glcf4_d[g_detail_idx].glcf063,g_glcf4_d[g_detail_idx].glcf064, 
                  g_glcf4_d[g_detail_idx].glcf065,g_glcf4_d[g_detail_idx].glcf066,g_glcf4_d[g_detail_idx].glcf067, 
                  g_glcf4_d[g_detail_idx].glcf068,g_glcf4_d[g_detail_idx].glcf069,g_glcf4_d[g_detail_idx].glcf070, 
                  g_glcf4_d[g_detail_idx].glcf071,g_glcf4_d[g_detail_idx].glcf072) 
         WHERE glcfent = g_enterprise AND glcfld = ps_keys_bak[1] AND glcf001 = ps_keys_bak[2] AND glcf002 = ps_keys_bak[3] AND glcf003 = ps_keys_bak[4] AND glcf004 = ps_keys_bak[5] AND glcf005 = ps_keys_bak[6]
      #add-point:update_b段修改中
      {<point name="update_b.m_update"/>}
      #end add-point   
      CASE
         WHEN SQLCA.sqlerrd[3] = 0  #更新不到的處理
            INITIALIZE g_errparam TO NULL 
            LET g_errparam.extend = "glcf_t" 
            LET g_errparam.code   = "std-00009" 
            LET g_errparam.popup  = TRUE 
            CALL cl_err()
            CALL s_transaction_end('N','0')
         WHEN SQLCA.sqlcode #其他錯誤
            INITIALIZE g_errparam TO NULL 
            LET g_errparam.extend = "glcf_t" 
            LET g_errparam.code   = SQLCA.sqlcode 
            LET g_errparam.popup  = TRUE 
            CALL cl_err()
            CALL s_transaction_end('N','0')
         OTHERWISE
            
      END CASE
      
      #將遮罩欄位進行遮蔽
      CALL aglt420_glcf_t_mask_restore('restore_mask_n')
               
      #add-point:update_b段修改後
      {<point name="update_b.after_update"/>}
      #end add-point  
   END IF
   
 
   
 
   
   #add-point:update_b段other
   {<point name="update_b.other"/>}
   #end add-point  
   
END FUNCTION
]]>
  </section>
</add_points>
