#該程式未解開Section, 採用最新樣板產出!
{<section id="aglp570.description" >}
#應用 a00 樣板自動產生(Version:3)
#+ Standard Version.....: SD版次:0008(2014-12-24 10:21:33), PR版次:0008(2016-11-29 10:34:30)
#+ Customerized Version.: SD版次:0000(1900-01-01 00:00:00), PR版次:0000(1900-01-01 00:00:00)
#+ Build......: 000329
#+ Filename...: aglp570
#+ Description: 會計科目轉換作業
#+ Creator....: 02599(2014-07-04 09:48:35)
#+ Modifier...: 02599 -SD/PR- 02481
 
{</section>}
 
{<section id="aglp570.global" >}
#應用 p01 樣板自動產生(Version:19)
#add-point:填寫註解說明 name="global.memo" name="global.memo"
#150814-00006#1   2015/10/23 by 02599   科目表glac_t ,glad_t 增加栏位
#160318-00005#17  2016/03/29 by 07675   將重複內容的錯誤訊息置換為公用錯誤訊息
#160816-00027#1   2016/08/22 By 02599   更新其它模組(非總帳)檔案中含會計科目編號欄位.原科目編號為新明細科目編號
#161128-00061#1   2016/11/29 by 02481  标准程式定义采用宣告模式,弃用.*写法
#end add-point
#add-point:填寫註解說明(客製用) name="global.memo_customerization"

#end add-point
 
IMPORT os
IMPORT util
IMPORT FGL lib_cl_schedule
#add-point:增加匯入項目 name="global.import"

#end add-point
 
SCHEMA ds
 
GLOBALS "../../cfg/top_global.inc"
GLOBALS "../../cfg/top_schedule.inc"
GLOBALS
   DEFINE gwin_curr2  ui.Window
   DEFINE gfrm_curr2  ui.Form
   DEFINE gi_hiden_asign       LIKE type_t.num5
   DEFINE gi_hiden_exec        LIKE type_t.num5
   DEFINE gi_hiden_spec        LIKE type_t.num5
   DEFINE gi_hiden_exec_end    LIKE type_t.num5
   DEFINE g_chk_jobid          LIKE type_t.num5
END GLOBALS
 
PRIVATE TYPE type_parameter RECORD
   #add-point:自定背景執行須傳遞的參數(Module Variable) name="global.parameter"
   
   #end add-point
        wc               STRING
                     END RECORD
 
DEFINE g_sql             STRING        #組 sql 用
DEFINE g_forupd_sql      STRING        #SELECT ... FOR UPDATE  SQL
DEFINE g_error_show      LIKE type_t.num5
DEFINE g_jobid           STRING
DEFINE g_wc              STRING
 
PRIVATE TYPE type_master RECORD
       glac001 LIKE glac_t.glac001, 
   glac001_desc LIKE type_t.chr80, 
   glac002_s LIKE type_t.chr500, 
   glac002_s_desc LIKE type_t.chr80, 
   glac002_p LIKE type_t.chr500, 
   glacl004 LIKE type_t.chr500, 
   sel LIKE type_t.chr500, 
   ooba002 LIKE ooba_t.ooba002, 
   glap002 LIKE glap_t.glap002, 
   glap004 LIKE glap_t.glap004, 
   glac002 LIKE glac_t.glac002, 
   glac002_desc LIKE type_t.chr80, 
   stagenow LIKE type_t.chr80,
       wc               STRING
       END RECORD
 
#模組變數(Module Variables)
DEFINE g_master type_master
 
#add-point:自定義模組變數(Module Variable) name="global.variable"
DEFINE g_ref_fields             DYNAMIC ARRAY OF VARCHAR(500) #ap_ref用陣列 
DEFINE g_rtn_fields             DYNAMIC ARRAY OF VARCHAR(500) #ap_ref用陣列

DEFINE g_glapld                  LIKE glap_t.glapld       #帐别
DEFINE g_glaacomp                LIKE glaa_t.glaacomp     #法人
DEFINE g_glaa001                 LIKE glaa_t.glaa001      #币别
DEFINE g_glaa004                 LIKE glaa_t.glaa004      #会计科目参照表号
DEFINE g_glaa024                 LIKE glaa_t.glaa024      #单据别参照表号
#161128-00061#1----modify------begin-----------
#DEFINE g_glad                    RECORD LIKE glad_t.*
#DEFINE g_glap                    RECORD LIKE glap_t.*
#DEFINE g_glaq                    RECORD LIKE glaq_t.*
DEFINE g_glap RECORD  #傳票憑證單頭檔
       glapent LIKE glap_t.glapent, #企業編號
       glapld LIKE glap_t.glapld, #帳套
       glapcomp LIKE glap_t.glapcomp, #法人
       glapdocno LIKE glap_t.glapdocno, #單號
       glapdocdt LIKE glap_t.glapdocdt, #單據日期
       glap001 LIKE glap_t.glap001, #傳票性質
       glap002 LIKE glap_t.glap002, #會計年度
       glap003 LIKE glap_t.glap003, #會計季別
       glap004 LIKE glap_t.glap004, #會計期別
       glap005 LIKE glap_t.glap005, #會計周別
       glap006 LIKE glap_t.glap006, #收支科目
       glap007 LIKE glap_t.glap007, #來源碼
       glap008 LIKE glap_t.glap008, #帳款類型
       glap009 LIKE glap_t.glap009, #總號
       glap010 LIKE glap_t.glap010, #借方總金額
       glap011 LIKE glap_t.glap011, #貸方總金額
       glap012 LIKE glap_t.glap012, #列印次數
       glap013 LIKE glap_t.glap013, #附件張數
       glap014 LIKE glap_t.glap014, #外幣憑證否
       glap015 LIKE glap_t.glap015, #原傳票編號
       glap016 LIKE glap_t.glap016, #來源帳套編號
       glap017 LIKE glap_t.glap017, #來源傳票編號
       glapownid LIKE glap_t.glapownid, #資料所有者
       glapowndp LIKE glap_t.glapowndp, #資料所屬部門
       glapcrtid LIKE glap_t.glapcrtid, #資料建立者
       glapcrtdp LIKE glap_t.glapcrtdp, #資料建立部門
       glapcrtdt LIKE glap_t.glapcrtdt, #資料創建日
       glapmodid LIKE glap_t.glapmodid, #資料修改者
       glapmoddt LIKE glap_t.glapmoddt, #最近修改日
       glapcnfid LIKE glap_t.glapcnfid, #資料確認者
       glapcnfdt LIKE glap_t.glapcnfdt, #資料確認日
       glappstid LIKE glap_t.glappstid, #資料過帳者
       glappstdt LIKE glap_t.glappstdt, #資料過帳日
       glapstus LIKE glap_t.glapstus    #狀態碼
       END RECORD
       
DEFINE g_glaq RECORD  #傳票憑證單身檔
       glaqent LIKE glaq_t.glaqent, #企業編號
       glaqcomp LIKE glaq_t.glaqcomp, #法人
       glaqld LIKE glaq_t.glaqld, #帳套
       glaqdocno LIKE glaq_t.glaqdocno, #單號
       glaqseq LIKE glaq_t.glaqseq, #項次
       glaq001 LIKE glaq_t.glaq001, #摘要
       glaq002 LIKE glaq_t.glaq002, #科目編號
       glaq003 LIKE glaq_t.glaq003, #借方金額
       glaq004 LIKE glaq_t.glaq004, #貸方金額
       glaq005 LIKE glaq_t.glaq005, #交易幣別
       glaq006 LIKE glaq_t.glaq006, #匯率
       glaq007 LIKE glaq_t.glaq007, #計價單位
       glaq008 LIKE glaq_t.glaq008, #數量
       glaq009 LIKE glaq_t.glaq009, #單價
       glaq010 LIKE glaq_t.glaq010, #原幣金額
       glaq011 LIKE glaq_t.glaq011, #票據編碼
       glaq012 LIKE glaq_t.glaq012, #票據日期
       glaq013 LIKE glaq_t.glaq013, #申請人
       glaq014 LIKE glaq_t.glaq014, #銀行帳號
       glaq015 LIKE glaq_t.glaq015, #款別編號
       glaq016 LIKE glaq_t.glaq016, #收支專案
       glaq017 LIKE glaq_t.glaq017, #營運據點
       glaq018 LIKE glaq_t.glaq018, #部門
       glaq019 LIKE glaq_t.glaq019, #利潤/成本中心
       glaq020 LIKE glaq_t.glaq020, #區域
       glaq021 LIKE glaq_t.glaq021, #收付款客商
       glaq022 LIKE glaq_t.glaq022, #帳款客戶
       glaq023 LIKE glaq_t.glaq023, #客群
       glaq024 LIKE glaq_t.glaq024, #產品類別
       glaq025 LIKE glaq_t.glaq025, #人員
       glaq026 LIKE glaq_t.glaq026, #no use
       glaq027 LIKE glaq_t.glaq027, #專案編號
       glaq028 LIKE glaq_t.glaq028, #WBS
       glaq029 LIKE glaq_t.glaq029, #自由核算項一
       glaq030 LIKE glaq_t.glaq030, #自由核算項二
       glaq031 LIKE glaq_t.glaq031, #自由核算項三
       glaq032 LIKE glaq_t.glaq032, #自由核算項四
       glaq033 LIKE glaq_t.glaq033, #自由核算項五
       glaq034 LIKE glaq_t.glaq034, #自由核算項六
       glaq035 LIKE glaq_t.glaq035, #自由核算項七
       glaq036 LIKE glaq_t.glaq036, #自由核算項八
       glaq037 LIKE glaq_t.glaq037, #自由核算項九
       glaq038 LIKE glaq_t.glaq038, #自由核算項十
       glaq039 LIKE glaq_t.glaq039, #匯率(本位幣二)
       glaq040 LIKE glaq_t.glaq040, #借方金額(本位幣二)
       glaq041 LIKE glaq_t.glaq041, #貸方金額(本位幣二)
       glaq042 LIKE glaq_t.glaq042, #匯率(本位幣三)
       glaq043 LIKE glaq_t.glaq043, #借方金額(本位幣三)
       glaq044 LIKE glaq_t.glaq044, #貸方金額(本位幣三)
       glaq051 LIKE glaq_t.glaq051, #經營方式
       glaq052 LIKE glaq_t.glaq052, #渠道
       glaq053 LIKE glaq_t.glaq053  #品牌
       END RECORD
DEFINE g_glad RECORD  #帳套科目管理設定檔
       gladent LIKE glad_t.gladent, #企業編號
       gladownid LIKE glad_t.gladownid, #資料所有者
       gladowndp LIKE glad_t.gladowndp, #資料所屬部門
       gladcrtid LIKE glad_t.gladcrtid, #資料建立者
       gladcrtdp LIKE glad_t.gladcrtdp, #資料建立部門
       gladcrtdt LIKE glad_t.gladcrtdt, #資料創建日
       gladmodid LIKE glad_t.gladmodid, #資料修改者
       gladmoddt LIKE glad_t.gladmoddt, #最近修改日
       gladstus LIKE glad_t.gladstus, #狀態碼
       gladld LIKE glad_t.gladld, #帳套
       glad001 LIKE glad_t.glad001, #會計科目編號
       glad002 LIKE glad_t.glad002, #是否按餘額類型產生分錄
       glad003 LIKE glad_t.glad003, #啟用傳票項次細項立沖
       glad004 LIKE glad_t.glad004, #傳票項次異動別
       glad005 LIKE glad_t.glad005, #是否啟用數量金額式
       glad006 LIKE glad_t.glad006, #借方現金變動碼
       glad007 LIKE glad_t.glad007, #啟用部門管理
       glad008 LIKE glad_t.glad008, #啟用利潤成本管理
       glad009 LIKE glad_t.glad009, #啟用區域管理
       glad010 LIKE glad_t.glad010, #啟用收付款客商管理
       glad011 LIKE glad_t.glad011, #啟用客群管理
       glad012 LIKE glad_t.glad012, #啟用產品類別管理
       glad013 LIKE glad_t.glad013, #啟用人員管理
       glad014 LIKE glad_t.glad014, #no use
       glad015 LIKE glad_t.glad015, #啟用專案管理
       glad016 LIKE glad_t.glad016, #啟用WBS管理
       glad017 LIKE glad_t.glad017, #啟用自由核算項一
       glad0171 LIKE glad_t.glad0171, #自由核算項一類型編號
       glad0172 LIKE glad_t.glad0172, #自由核算項一控制方式
       glad018 LIKE glad_t.glad018, #啟用自由核算項二
       glad0181 LIKE glad_t.glad0181, #自由核算項二類型編號
       glad0182 LIKE glad_t.glad0182, #自由核算項二控制方式
       glad019 LIKE glad_t.glad019, #啟用自由核算項三
       glad0191 LIKE glad_t.glad0191, #自由核算項三類型編號
       glad0192 LIKE glad_t.glad0192, #自由核算項三控制方式
       glad020 LIKE glad_t.glad020, #啟用自由核算項四
       glad0201 LIKE glad_t.glad0201, #自由核算項四類型編號
       glad0202 LIKE glad_t.glad0202, #自由核算項四控制方式
       glad021 LIKE glad_t.glad021, #啟用自由核算項五
       glad0211 LIKE glad_t.glad0211, #自由核算項五類型編號
       glad0212 LIKE glad_t.glad0212, #自由核算項五控制方式
       glad022 LIKE glad_t.glad022, #啟用自由核算項六
       glad0221 LIKE glad_t.glad0221, #自由核算項六類型編號
       glad0222 LIKE glad_t.glad0222, #自由核算項六控制方式
       glad023 LIKE glad_t.glad023, #啟用自由核算項七
       glad0231 LIKE glad_t.glad0231, #自由核算項七類型編號
       glad0232 LIKE glad_t.glad0232, #自由核算項七控制方式
       glad024 LIKE glad_t.glad024, #啟用自由核算項八
       glad0241 LIKE glad_t.glad0241, #自由核算項八類型編號
       glad0242 LIKE glad_t.glad0242, #自由核算項八控制方式
       glad025 LIKE glad_t.glad025, #啟用自由核算項九
       glad0251 LIKE glad_t.glad0251, #自由核算項九類型編號
       glad0252 LIKE glad_t.glad0252, #自由核算項九控制方式
       glad026 LIKE glad_t.glad026, #啟用自由核算項十
       glad0261 LIKE glad_t.glad0261, #自由核算項十類型編號
       glad0262 LIKE glad_t.glad0262, #自由核算項十控制方式
       glad027 LIKE glad_t.glad027, #啟用帳款客商管理
       glad030 LIKE glad_t.glad030, #是否進行預算管控
       glad031 LIKE glad_t.glad031, #啟用經營方式管理
       glad032 LIKE glad_t.glad032, #啟用渠道管理
       glad033 LIKE glad_t.glad033, #啟用品牌管理
       glad034 LIKE glad_t.glad034, #科目做多幣別管理
       glad035 LIKE glad_t.glad035, #是否是子系統科目
       glad036 LIKE glad_t.glad036  #貸方現金變動碼
       END RECORD

#161128-00061#1----modify------end-----------
#end add-point
 
#add-point:自定義客戶專用模組變數(Module Variable) name="global.variable_customerization"

#end add-point
 
#add-point:傳入參數說明 name="global.argv"

#end add-point
 
{</section>}
 
{<section id="aglp570.main" >}
MAIN
   #add-point:main段define (客製用) name="main.define_customerization"
   
   #end add-point 
   DEFINE ls_js    STRING
   DEFINE lc_param type_parameter  
   #add-point:main段define name="main.define"
   
   #end add-point 
  
   #設定SQL錯誤記錄方式 (模組內定義有效)
   WHENEVER ERROR CALL cl_err_msg_log
 
   #add-point:初始化前定義 name="main.before_ap_init"
   
   #end add-point
   #依模組進行系統初始化設定(系統設定)
   CALL cl_ap_init("agl","")
 
   #add-point:定義背景狀態與整理進入需用參數ls_js name="main.background"
   
   #end add-point
 
   #背景(Y) 或半背景(T) 時不做主畫面開窗
   IF g_bgjob = "Y" OR g_bgjob = "T" THEN
      #排程參數由01開始，若不是1開始，表示有保留參數
      LET ls_js = g_argv[01]
     #CALL util.JSON.parse(ls_js,g_master)   #p類主要使用l_param,此處不解析
      #add-point:Service Call name="main.servicecall"
      
      #end add-point
      CALL aglp570_process(ls_js)
   ELSE
      #畫面開啟 (identifier)
      OPEN WINDOW w_aglp570 WITH FORM cl_ap_formpath("agl",g_code)
 
      #瀏覽頁簽資料初始化
      CALL cl_ui_init()
 
      #程式初始化
      CALL aglp570_init()
 
      #進入選單 Menu (="N")
      CALL aglp570_ui_dialog()
 
      #add-point:畫面關閉前 name="main.before_close"
      
      #end add-point
      #畫面關閉
      CLOSE WINDOW w_aglp570
   END IF
 
   #add-point:作業離開前 name="main.exit"
   
   #end add-point
 
   #離開作業
   CALL cl_ap_exitprogram("0")
END MAIN
 
{</section>}
 
{<section id="aglp570.init" >}
#+ 初始化作業
PRIVATE FUNCTION aglp570_init()
 
   #add-point:init段define (客製用) name="init.define_customerization"
   
   #end add-point
   #add-point:ui_dialog段define name="init.define"
   DEFINE l_success     LIKE type_t.num5
   #end add-point
 
   LET g_error_show = 1
   LET gwin_curr2 = ui.Window.getCurrent()
   LET gfrm_curr2 = gwin_curr2.getForm()
   CALL cl_schedule_import_4fd()
   CALL cl_set_combo_scc("gzpa003","75")
   IF cl_get_para(g_enterprise,"","E-SYS-0005") = "N" THEN
       CALL cl_set_comp_visible("scheduling_page,history_page",FALSE)
   END IF 
   #add-point:畫面資料初始化 name="init.init"
   #當前營運據點對應的法人編號之主帳別設置的科目參照表號
   #获取账别
   CALL s_ld_bookno()  RETURNING l_success,g_glapld
   IF l_success = FALSE THEN
      RETURN 
   END IF 
   #依据对应的主账套编码，抓取法人,账簿币别，会计科目参照编号
   SELECT glaacomp,glaa001,glaa004,glaa024 INTO g_glaacomp,g_glaa001,g_glaa004,g_glaa024
     FROM glaa_t
    WHERE glaaent = g_enterprise
      AND glaald = g_glapld
   #end add-point
   
END FUNCTION
 
{</section>}
 
{<section id="aglp570.ui_dialog" >}
#+ 選單功能實際執行處
PRIVATE FUNCTION aglp570_ui_dialog()
 
   #add-point:ui_dialog段define (客製用) name="ui_dialog.define_customerization"
   
   #end add-point
   DEFINE li_exit  LIKE type_t.num5    #判別是否為離開作業
   DEFINE li_idx   LIKE type_t.num10
   DEFINE ls_js    STRING
   DEFINE ls_wc    STRING
   DEFINE l_dialog ui.DIALOG
   DEFINE lc_param type_parameter
   #add-point:ui_dialog段define name="ui_dialog.define"
   
   #end add-point
   
   #add-point:ui_dialog段before dialog name="ui_dialog.before_dialog"
   CLEAR FORM
   INITIALIZE g_master.* TO NULL
   #end add-point
 
   WHILE TRUE
      #add-point:ui_dialog段before dialog2 name="ui_dialog.before_dialog2"
      
      #end add-point
 
      DIALOG ATTRIBUTES(UNBUFFERED,FIELD ORDER FORM)
         #應用 a57 樣板自動產生(Version:3)
         INPUT BY NAME g_master.glac001,g_master.glac002_s,g_master.glac002_p,g_master.glacl004,g_master.sel, 
             g_master.ooba002,g_master.glap002,g_master.glap004,g_master.glac002 
            ATTRIBUTE(WITHOUT DEFAULTS)
            
            #自訂ACTION(master_input)
            
         #應用 a43 樣板自動產生(Version:4)
         ON ACTION update_item
            LET g_action_choice="update_item"
            IF cl_auth_chk_act("update_item") THEN
               
               #add-point:ON ACTION update_item name="input.master_input.update_item"
               IF NOT cl_null(g_master.glac002_p)  THEN
                  CALL n_glacl(g_master.glac001,g_master.glac002_p)
                  INITIALIZE g_ref_fields TO NULL
                  LET g_ref_fields[1] = g_master.glac002_p
                  CALL ap_ref_array2(g_ref_fields," SELECT glacl004 FROM glacl_t WHERE glaclent = '"
                      ||g_enterprise||"' AND glacl001 ='"||g_master.glac001||"'  AND glacl002 = ? AND glacl003 = '"||g_dlang||"'","") RETURNING g_rtn_fields
                  LET g_master.glacl004 = g_rtn_fields[1]
                  DISPLAY g_master.glacl004 TO glacl004
               END IF
               #END add-point
            END IF
 
 
 
 
         
            BEFORE INPUT
               #add-point:資料輸入前 name="input.m.before_input"
               #预设值
               LET g_master.glac001 =  g_glaa004
               CALL aglp570_glac001_desc() RETURNING g_master.glac001_desc
               DISPLAY g_master.glac001_desc TO glac001_desc
               LET g_master.sel = 1
               LET g_master.glap002 = ''
               LET g_master.glap004 = ''
               CALL cl_set_comp_entry('ooba002,glap002,glap004,glac002',FALSE)
               #end add-point
         
                     #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD glac001
            
            #add-point:AFTER FIELD glac001 name="input.a.glac001"
            DISPLAY '' TO glac001_desc
            IF NOT cl_null(g_master.glac001) THEN
               CALL aglp570_glac001_chk()
               IF NOT cl_null(g_errno) THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = g_errno
                  LET g_errparam.extend = g_master.glac001
                  #160318-00005#17  --add--str
                   LET g_errparam.replace[1] ='aooi070'
                   LET g_errparam.replace[2] = cl_get_progname('aooi070',g_lang,"2")
                   LET g_errparam.exeprog    ='aooi070'
                   #160318-00005#17 --add--end
                  LET g_errparam.popup = FALSE
                  CALL cl_err()

                  LET g_master.glac001 = ''
                  DISPLAY '' TO glac001_desc
                  NEXT FIELD glac001
               END IF 
               LET g_glaa004=g_master.glac001
            END IF 
            CALL aglp570_glac001_desc() RETURNING g_master.glac001_desc
            DISPLAY g_master.glac001_desc TO glac001_desc 
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD glac001
            #add-point:BEFORE FIELD glac001 name="input.b.glac001"
            
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE glac001
            #add-point:ON CHANGE glac001 name="input.g.glac001"
            
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD glac002_s
            
            #add-point:AFTER FIELD glac002_s name="input.a.glac002_s"
            DISPLAY '' TO glac002_s_desc
            IF NOT cl_null(g_master.glac002_s) THEN
               CALL aglp570_glac002_chk(g_master.glac002_s,'1')
               IF NOT cl_null(g_errno) THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = g_errno
                  LET g_errparam.extend = g_master.glac002_s
                  #160318-00005#17  --add--str
                   LET g_errparam.replace[1] ='agli020'
                   LET g_errparam.replace[2] = cl_get_progname('agli020',g_lang,"2")
                   LET g_errparam.exeprog    ='agli020'
                  #160318-00005#17 --add--end
                  LET g_errparam.popup = FALSE
                  CALL cl_err()

                  LET g_master.glac002_s = ''
                  DISPLAY '' TO glac002_s_desc
                  NEXT FIELD glac002_s
               END IF
               IF g_master.glac002_s == g_master.glac002 THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = 'agl-00152'
                  LET g_errparam.extend = g_master.glac002_s
                  LET g_errparam.popup = FALSE
                  CALL cl_err()

                  NEXT FIELD glac002_s
               END IF 
            END IF 
            CALL aglp570_glac002_desc(g_master.glac002_s) RETURNING g_master.glac002_s_desc
            DISPLAY g_master.glac002_s_desc TO glac002_s_desc
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD glac002_s
            #add-point:BEFORE FIELD glac002_s name="input.b.glac002_s"
            
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE glac002_s
            #add-point:ON CHANGE glac002_s name="input.g.glac002_s"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD glac002_p
            #add-point:BEFORE FIELD glac002_p name="input.b.glac002_p"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD glac002_p
            
            #add-point:AFTER FIELD glac002_p name="input.a.glac002_p"
            IF NOT cl_null(g_master.glac002_p) THEN
               CALL aglp570_glac002_chk2()
               IF NOT cl_null(g_errno) THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = g_errno
                  LET g_errparam.extend = g_master.glac002_p
                  LET g_errparam.popup = FALSE
                  CALL cl_err()

                  LET g_master.glac002_p = ''
                  NEXT FIELD glac002_p
               END IF 
            END IF 
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE glac002_p
            #add-point:ON CHANGE glac002_p name="input.g.glac002_p"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD glacl004
            #add-point:BEFORE FIELD glacl004 name="input.b.glacl004"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD glacl004
            
            #add-point:AFTER FIELD glacl004 name="input.a.glacl004"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE glacl004
            #add-point:ON CHANGE glacl004 name="input.g.glacl004"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD sel
            #add-point:BEFORE FIELD sel name="input.b.sel"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD sel
            
            #add-point:AFTER FIELD sel name="input.a.sel"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE sel
            #add-point:ON CHANGE sel name="input.g.sel"
            IF g_master.sel = '1' THEN
               CALL cl_set_comp_entry('ooba002,glap002,glap004,glac002',FALSE)
               LET g_master.ooba002 = ''
               LET g_master.glap002 = ''
               LET g_master.glap004 = ''
            ELSE
               CALL cl_set_comp_entry('ooba002,glap002,glap004,glac002',TRUE)
               LET g_master.ooba002 = 'GL1'             #该单别维护的几个账套下先给默认的
               LET g_master.glap002 = YEAR(g_today)
               LET g_master.glap004 = MONTH(g_today)
            END IF
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD ooba002
            #add-point:BEFORE FIELD ooba002 name="input.b.ooba002"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD ooba002
            
            #add-point:AFTER FIELD ooba002 name="input.a.ooba002"
            IF NOT cl_null(g_master.ooba002)  THEN
               CALL aglp570_docno_chk()
               IF NOT cl_null(g_errno) THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = g_errno
                  LET g_errparam.extend = g_master.ooba002
                  #160318-00005#17  --add--str
                   LET g_errparam.replace[1] ='aooi200'
                   LET g_errparam.replace[2] = cl_get_progname('aooi200',g_lang,"2")
                   LET g_errparam.exeprog    ='aooi200'
                   #160318-00005#17  --add--end
                  LET g_errparam.popup = FALSE
                  CALL cl_err()

                  LET g_master.ooba002 = ''
                  NEXT FIELD ooba002
               END IF 
            END IF 
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE ooba002
            #add-point:ON CHANGE ooba002 name="input.g.ooba002"
            
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD glap002
            #應用 a15 樣板自動產生(Version:3)
            #確認欄位值在特定區間內
            IF NOT cl_ap_chk_range(g_master.glap002,"1000.000","1","9999.000","1","azz-00087",1) THEN
               NEXT FIELD glap002
            END IF 
 
 
 
            #add-point:AFTER FIELD glap002 name="input.a.glap002"
            IF NOT cl_null(g_master.glap002) THEN 
            END IF 


            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD glap002
            #add-point:BEFORE FIELD glap002 name="input.b.glap002"
            
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE glap002
            #add-point:ON CHANGE glap002 name="input.g.glap002"
            
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD glap004
            #應用 a15 樣板自動產生(Version:3)
            #確認欄位值在特定區間內
            IF NOT cl_ap_chk_range(g_master.glap004,"1.000","1","13.000","1","azz-00087",1) THEN
               NEXT FIELD glap004
            END IF 
 
 
 
            #add-point:AFTER FIELD glap004 name="input.a.glap004"
            IF NOT cl_null(g_master.glap004) THEN 
            END IF 


            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD glap004
            #add-point:BEFORE FIELD glap004 name="input.b.glap004"
            
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE glap004
            #add-point:ON CHANGE glap004 name="input.g.glap004"
            
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD glac002
            
            #add-point:AFTER FIELD glac002 name="input.a.glac002"
            DISPLAY '' TO glac002_desc
            IF NOT cl_null(g_master.glac002) THEN
               CALL aglp570_glac002_chk(g_master.glac002,'2')
               IF NOT cl_null(g_errno) THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = g_errno
                  LET g_errparam.extend = g_master.glac002
                  #160318-00005#17  --add--str
                   LET g_errparam.replace[1] ='agli020'
                   LET g_errparam.replace[2] = cl_get_progname('agli020',g_lang,"2")
                   LET g_errparam.exeprog    ='agli020'
                  #160318-00005#17 --add--end
                  LET g_errparam.popup = FALSE
                  CALL cl_err()

                  LET g_master.glac002 = ''
                  DISPLAY '' TO glac002_desc
                  NEXT FIELD glac002
               END IF
               IF g_master.glac002_s == g_master.glac002 THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = 'agl-00152'
                  LET g_errparam.extend = g_master.glac002
                  LET g_errparam.popup = FALSE
                  CALL cl_err()

                  NEXT FIELD glac002
               END IF                
            END IF 
            CALL aglp570_glac002_desc(g_master.glac002) RETURNING g_master.glac002_desc
            DISPLAY g_master.glac002_desc TO glac002_desc
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD glac002
            #add-point:BEFORE FIELD glac002 name="input.b.glac002"
            
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE glac002
            #add-point:ON CHANGE glac002 name="input.g.glac002"
            
            #END add-point 
 
 
 
                     #Ctrlp:input.c.glac001
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD glac001
            #add-point:ON ACTION controlp INFIELD glac001 name="input.c.glac001"
            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_master.glac001             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "" #

            
            CALL q_glac001()                                #呼叫開窗

            LET g_master.glac001 = g_qryparam.return1              
            CALL aglp570_glac001_desc() RETURNING g_master.glac001_desc
            DISPLAY g_master.glac001_desc TO glac001_desc
            DISPLAY g_master.glac001 TO glac001              #

            NEXT FIELD glac001                          #返回原欄位


            #END add-point
 
 
         #Ctrlp:input.c.glac002_s
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD glac002_s
            #add-point:ON ACTION controlp INFIELD glac002_s name="input.c.glac002_s"
            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_master.glac002_s             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "" #
            LET g_qryparam.where = "glac001 = '",g_master.glac001,"' AND glac003<>'1' AND glac006 = '1'"    #须为明细活独立科目+账户性质
            
            CALL q_glac002()                                #呼叫開窗

            LET g_master.glac002_s = g_qryparam.return1              
            CALL aglp570_glac002_desc(g_master.glac002_s) RETURNING g_master.glac002_s_desc
            DISPLAY g_master.glac002_s_desc TO glac002_s_desc
            DISPLAY g_master.glac002_s TO glac002_s              #

            NEXT FIELD glac002_s                          #返回原欄位


            #END add-point
 
 
         #Ctrlp:input.c.glac002_p
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD glac002_p
            #add-point:ON ACTION controlp INFIELD glac002_p name="input.c.glac002_p"
            
            #END add-point
 
 
         #Ctrlp:input.c.glacl004
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD glacl004
            #add-point:ON ACTION controlp INFIELD glacl004 name="input.c.glacl004"
            
            #END add-point
 
 
         #Ctrlp:input.c.sel
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD sel
            #add-point:ON ACTION controlp INFIELD sel name="input.c.sel"
            
            #END add-point
 
 
         #Ctrlp:input.c.ooba002
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD ooba002
            #add-point:ON ACTION controlp INFIELD ooba002 name="input.c.ooba002"
            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_master.ooba002             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "" #
            LET g_qryparam.where = "ooba001 = '",g_glaa024,"' AND oobx002 = 'AGL' AND oobx003 = 'aglt310' "
            
            CALL q_ooba002_4()                                #呼叫開窗

            LET g_master.ooba002 = g_qryparam.return1              

            DISPLAY g_master.ooba002 TO ooba002              #

            NEXT FIELD ooba002                          #返回原欄位


            #END add-point
 
 
         #Ctrlp:input.c.glap002
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD glap002
            #add-point:ON ACTION controlp INFIELD glap002 name="input.c.glap002"
            
            #END add-point
 
 
         #Ctrlp:input.c.glap004
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD glap004
            #add-point:ON ACTION controlp INFIELD glap004 name="input.c.glap004"
            
            #END add-point
 
 
         #Ctrlp:input.c.glac002
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD glac002
            #add-point:ON ACTION controlp INFIELD glac002 name="input.c.glac002"
            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_master.glac002             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "" #
            LET g_qryparam.where = "glac001 = '",g_master.glac001,"' AND glac003='2' AND glac006 = '1'"    #须为明细科目+账户性质
            
            CALL q_glac002()                                #呼叫開窗

            LET g_master.glac002 = g_qryparam.return1              
            CALL aglp570_glac002_desc(g_master.glac002) RETURNING g_master.glac002_desc
            DISPLAY g_master.glac002_desc TO glac002_desc
            DISPLAY g_master.glac002 TO glac002              #

            NEXT FIELD glac002                          #返回原欄位


            #END add-point
 
 
 
               
            AFTER INPUT
               #add-point:資料輸入後 name="input.m.after_input"
               
               #end add-point
               
            #add-point:其他管控(on row change, etc...) name="input.other"
            
            #end add-point
         END INPUT
 
 
 
         
         #應用 a58 樣板自動產生(Version:3)
         CONSTRUCT BY NAME g_master.wc ON glacl004
            BEFORE CONSTRUCT
               #add-point:cs段before_construct name="cs.head.before_construct"
               
               #end add-point 
         
            #公用欄位開窗相關處理
            
               
            #一般欄位開窗相關處理    
                     #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD glacl004
            #add-point:BEFORE FIELD glacl004 name="construct.b.glacl004"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD glacl004
            
            #add-point:AFTER FIELD glacl004 name="construct.a.glacl004"
            
            #END add-point
            
 
 
         #Ctrlp:construct.c.glacl004
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD glacl004
            #add-point:ON ACTION controlp INFIELD glacl004 name="construct.c.glacl004"
            
            #END add-point
 
 
 
            
            #add-point:其他管控 name="cs.other"
            
            #end add-point
            
         END CONSTRUCT
 
 
 
      
         #add-point:ui_dialog段construct name="ui_dialog.more_construct"
         
         #end add-point
         #add-point:ui_dialog段input name="ui_dialog.more_input"
         
         #end add-point
         #add-point:ui_dialog段自定義display array name="ui_dialog.more_displayarray"
         
         #end add-point
 
         SUBDIALOG lib_cl_schedule.cl_schedule_setting
         SUBDIALOG lib_cl_schedule.cl_schedule_setting_exec_call
         SUBDIALOG lib_cl_schedule.cl_schedule_select_show_history
         SUBDIALOG lib_cl_schedule.cl_schedule_show_history
 
         BEFORE DIALOG
            LET l_dialog = ui.DIALOG.getCurrent()
            CALL aglp570_get_buffer(l_dialog)
            #add-point:ui_dialog段before dialog name="ui_dialog.before_dialog3"
            
            #end add-point
 
         ON ACTION batch_execute
            LET g_action_choice = "batch_execute"
            ACCEPT DIALOG
 
         #add-point:ui_dialog段before_qbeclear name="ui_dialog.before_qbeclear"
         
         #end add-point
 
         ON ACTION qbeclear         
            CLEAR FORM
            INITIALIZE g_master.* TO NULL   #畫面變數清空
            INITIALIZE lc_param.* TO NULL   #傳遞參數變數清空
            #add-point:ui_dialog段qbeclear name="ui_dialog.qbeclear"
            
            #end add-point
 
         ON ACTION history_fill
            CALL cl_schedule_history_fill()
 
         ON ACTION close
            LET INT_FLAG = TRUE
            EXIT DIALOG
         
         ON ACTION exit
            LET INT_FLAG = TRUE
            EXIT DIALOG
 
         #add-point:ui_dialog段action name="ui_dialog.more_action"
         
         #end add-point
 
         #主選單用ACTION
         &include "main_menu_exit_dialog.4gl"
         &include "relating_action.4gl"
         #交談指令共用ACTION
         &include "common_action.4gl"
            CONTINUE DIALOG
      END DIALOG
 
      IF g_action_choice = "logistics" THEN
         #清除畫面及相關資料
         CLEAR FORM   
         INITIALIZE g_master.* TO NULL
         LET g_wc  = ' 1=2'
         LET g_action_choice = ""
         CALL aglp570_init()
         CONTINUE WHILE
      END IF
 
      #檢查批次設定是否有錯(或未設定完成)
      IF NOT cl_schedule_exec_check() THEN
         CONTINUE WHILE
      END IF
      
      LET lc_param.wc = g_master.wc    #把畫面上的wc傳遞到參數變數
      #請在下方的add-point內進行把畫面的輸入資料(g_master)轉換到傳遞參數變數(lc_param)的動作
      #add-point:ui_dialog段exit dialog name="process.exit_dialog"
      
      #end add-point
 
      LET ls_js = util.JSON.stringify(lc_param)  #r類使用g_master/p類使用lc_param
 
      IF INT_FLAG THEN
         LET INT_FLAG = FALSE
         EXIT WHILE
      ELSE
         IF g_chk_jobid THEN 
            LET g_jobid = g_schedule.gzpa001
         ELSE 
            LET g_jobid = cl_schedule_get_jobid(g_prog)
         END IF 
 
         #依照指定模式執行報表列印
         CASE 
            WHEN g_schedule.gzpa003 = "0"
                 CALL aglp570_process(ls_js)
 
            WHEN g_schedule.gzpa003 = "1"
                 LET ls_js = aglp570_transfer_argv(ls_js)
                 CALL cl_cmdrun(ls_js)
 
            WHEN g_schedule.gzpa003 = "2"
                 CALL cl_schedule_update_data(g_jobid,ls_js)
 
            WHEN g_schedule.gzpa003 = "3"
                 CALL cl_schedule_update_data(g_jobid,ls_js)
         END CASE  
 
         IF g_schedule.gzpa003 = "2" OR g_schedule.gzpa003 = "3" THEN 
            CALL cl_ask_confirm3("std-00014","") #設定完成
         END IF    
         LET g_schedule.gzpa003 = "0" #預設一開始 立即於前景執行
 
         #add-point:ui_dialog段after schedule name="process.after_schedule"
         
         #end add-point
 
         #欄位初始資訊 
         CALL cl_schedule_init_info("all",g_schedule.gzpa003) 
         LET gi_hiden_asign = FALSE 
         LET gi_hiden_exec = FALSE 
         LET gi_hiden_spec = FALSE 
         LET gi_hiden_exec_end = FALSE 
         CALL cl_schedule_hidden()
      END IF
   END WHILE
 
END FUNCTION
 
{</section>}
 
{<section id="aglp570.transfer_argv" >}
#+ 轉換本地參數至cmdrun參數內,準備進入背景執行
PRIVATE FUNCTION aglp570_transfer_argv(ls_js)
 
   #add-point:transfer_agrv段define (客製用) name="transfer_agrv.define_customerization"
   
   #end add-point
   DEFINE ls_js       STRING
   DEFINE la_cmdrun   RECORD
             prog       STRING,
             actionid   STRING,
             background LIKE type_t.chr1,
             param      DYNAMIC ARRAY OF STRING
                  END RECORD
   DEFINE la_param    type_parameter
   #add-point:transfer_agrv段define name="transfer_agrv.define"
   
   #end add-point
 
   LET la_cmdrun.prog = g_prog
   LET la_cmdrun.background = "Y"
   LET la_cmdrun.param[1] = ls_js
 
   #add-point:transfer.argv段程式內容 name="transfer.argv.define"
   
   #end add-point
 
   RETURN util.JSON.stringify( la_cmdrun )
END FUNCTION
 
{</section>}
 
{<section id="aglp570.process" >}
#+ 資料處理   (r類使用g_master為主處理/p類使用l_param為主)
PRIVATE FUNCTION aglp570_process(ls_js)
 
   #add-point:process段define (客製用) name="process.define_customerization"
   
   #end add-point
   DEFINE ls_js         STRING
   DEFINE lc_param      type_parameter
   DEFINE li_stus       LIKE type_t.num5
   DEFINE li_count      LIKE type_t.num10  #progressbar計量
   DEFINE ls_sql        STRING             #主SQL
   DEFINE li_p01_status LIKE type_t.num5
   #add-point:process段define name="process.define"
   DEFINE l_flag      LIKE type_t.num5
   #end add-point
 
  #INITIALIZE lc_param TO NULL           #p類不可以清空
   CALL util.JSON.parse(ls_js,lc_param)  #r類作業被t類呼叫時使用, p類主要解開參數處
   LET li_p01_status = 1
 
  #IF lc_param.wc IS NOT NULL THEN
  #   LET g_bgjob = "T"       #特殊情況,此為t類作業鬆耦合串入報表主程式使用
  #END IF
 
   #add-point:process段前處理 name="process.pre_process"
   INITIALIZE g_glad.* TO NULL
   #错误信息汇总初始化
   CALL cl_err_collect_init()
   CALL s_transaction_begin() 
   LET g_success = 'Y'
   IF g_master.sel = '1'  THEN
     #更新會科基本資料及科目相關歷史資料
      CALL aglp570_sel_1()
   ELSE
     #更新會科基本資料並產生科餘結轉的傳票
      CALL aglp570_sel_2()
   END IF 
   IF g_success = 'N' THEN
      CALL s_transaction_end('N','0')
      CALL cl_err_collect_show() 
      CALL cl_ask_end2(2) RETURNING l_flag
   ELSE
      CALL s_transaction_end('Y','0')
      CALL cl_err_collect_show() 
      CALL cl_ask_end2(1) RETURNING l_flag
   END IF
   #end add-point
 
   #預先計算progressbar迴圈次數
   IF g_bgjob <> "Y" THEN
      #add-point:process段count_progress name="process.count_progress"
      
      #end add-point
   END IF
 
   #主SQL及相關FOREACH前置處理
#  DECLARE aglp570_process_cs CURSOR FROM ls_sql
#  FOREACH aglp570_process_cs INTO
   #add-point:process段process name="process.process"
   
   #end add-point
#  END FOREACH
 
   IF g_bgjob = "N" THEN
      #前景作業完成處理
      #add-point:process段foreground完成處理 name="process.foreground_finish"
      
      #end add-point
      CALL cl_ask_confirm3("std-00012","")
   ELSE
      #背景作業完成處理
      #add-point:process段background完成處理 name="process.background_finish"
      
      #end add-point
      CALL cl_schedule_exec_call(li_p01_status)
   END IF
 
   #呼叫訊息中心傳遞本關完成訊息
   CALL aglp570_msgcentre_notify()
 
END FUNCTION
 
{</section>}
 
{<section id="aglp570.get_buffer" >}
PRIVATE FUNCTION aglp570_get_buffer(p_dialog)
 
   #add-point:process段define (客製用) name="get_buffer.define_customerization"
   
   #end add-point
   DEFINE p_dialog   ui.DIALOG
   #add-point:process段define name="get_buffer.define"
   
   #end add-point
 
   
   LET g_master.glac001 = p_dialog.getFieldBuffer('glac001')
   LET g_master.glac002_s = p_dialog.getFieldBuffer('glac002_s')
   LET g_master.glac002_p = p_dialog.getFieldBuffer('glac002_p')
   LET g_master.glacl004 = p_dialog.getFieldBuffer('glacl004')
   LET g_master.sel = p_dialog.getFieldBuffer('sel')
   LET g_master.ooba002 = p_dialog.getFieldBuffer('ooba002')
   LET g_master.glap002 = p_dialog.getFieldBuffer('glap002')
   LET g_master.glap004 = p_dialog.getFieldBuffer('glap004')
   LET g_master.glac002 = p_dialog.getFieldBuffer('glac002')
 
   CALL cl_schedule_get_buffer(p_dialog)
 
   #add-point:get_buffer段其他欄位處理 name="get_buffer.others"
   
   #end add-point
END FUNCTION
 
{</section>}
 
{<section id="aglp570.msgcentre_notify" >}
PRIVATE FUNCTION aglp570_msgcentre_notify()
 
   #add-point:process段define (客製用) name="msgcentre_notify.define_customerization"
   
   #end add-point
   DEFINE lc_state LIKE type_t.chr5
   #add-point:process段define name="msgcentre_notify.define"
   
   #end add-point
 
   INITIALIZE g_msgparam TO NULL
 
   #action-id與狀態填寫
   LET g_msgparam.state = "process"
 
   #add-point:msgcentre其他通知 name="msg_centre.process"
   
   #end add-point
 
   #呼叫訊息中心傳遞本關完成訊息
   CALL cl_msgcentre_notify()
 
END FUNCTION
 
{</section>}
 
{<section id="aglp570.other_function" readonly="Y" >}
#add-point:自定義元件(Function) name="other.function"

#会计科目参照表号说明
PRIVATE FUNCTION aglp570_glac001_desc()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = '0'
   LET g_ref_fields[2] = g_master.glac001
   CALL ap_ref_array2(g_ref_fields,"SELECT ooall004 FROM ooall_t WHERE ooallent='"||g_enterprise||"' AND ooall001=? AND ooall002=? AND ooall003='"||g_dlang||"'","") RETURNING g_rtn_fields
   RETURN  g_rtn_fields[1]  
END FUNCTION

#科目说明
PRIVATE FUNCTION aglp570_glac002_desc(p_glac002)
   DEFINE p_glac002    LIKE glac_t.glac002
    
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_master.glac001
   LET g_ref_fields[2] = p_glac002
   CALL ap_ref_array2(g_ref_fields,"SELECT glacl004 FROM glacl_t WHERE glaclent='"||g_enterprise||"' AND glacl001 = ? AND glacl002 = ? AND glacl003='"||g_dlang||"'","") RETURNING g_rtn_fields
   RETURN  g_rtn_fields[1]
END FUNCTION

#会计科目参照表号检查
PRIVATE FUNCTION aglp570_glac001_chk()
   DEFINE l_ooalstus    LIKE glaa_t.glaastus
    
    LET g_errno = ''
    SELECT ooalstus INTO l_ooalstus FROM ooal_t 
     WHERE ooalent = g_enterprise
       AND ooal001 = '0'
       AND ooal002 = g_master.glac001
    CASE
       WHEN sqlca.sqlcode  = 100    LET g_errno = 'agl-00007'
       WHEN l_ooalstus = 'N'        LET g_errno = 'sub-01302'  #160318-00005#17 mod 'agl-00004'  
    END CASE
END FUNCTION

#科目值检查
PRIVATE FUNCTION aglp570_glac002_chk(p_glac002,p_flag)
   DEFINE p_glac002    LIKE glap_t.glap006
   DEFINE p_flag       LIKE type_t.chr1         #标记是原科目还是过滤科目，1：原，2：过滤
   DEFINE l_glacstus   LIKE glac_t.glacstus
   DEFINE l_glac003    LIKE glac_t.glac003
   DEFINE l_glac006    LIKE glac_t.glac006
   
   LET g_errno = ''
   SELECT glacstus,glac003,glac006 INTO l_glacstus,l_glac003,l_glac006 FROM glac_t
    WHERE glacent = g_enterprise
      AND glac001 = g_master.glac001  #会计科目参照表号
      AND glac002 = p_glac002
       
   CASE
      WHEN SQLCA.SQLCODE = 100   LET g_errno = 'agl-00011'
      WHEN l_glacstus = 'N'      LET g_errno = 'sub-01302'  #160318-00005#17 mod #'agl-00012'
      WHEN l_glac003 = '1'       LET g_errno = 'agl-00013'  #必须为非统治类科目
      WHEN l_glac006 <>'1'       LET g_errno = 'agl-00030'     #须为账户性质   
      WHEN l_glac003 <> '2'      
      IF p_flag = '2'  THEN
         LET g_errno  ='agl-00146'  #科目须为明细科目
      END IF     
      
   END CASE   
END FUNCTION

#新明细科目检查
PRIVATE FUNCTION aglp570_glac002_chk2()
   DEFINE l_count        LIKE type_t.num5
    
    LET g_errno = ''
    SELECT count(*) INTO l_count FROM glac_t
     WHERE glacent = g_enterprise
       AND glac001 = g_master.glac001
       AND glac002 = g_master.glac002_p
    IF l_count > 0 THEN
       LET g_errno = 'agl-00147'
    END IF 
END FUNCTION

#单别检查
PRIVATE FUNCTION aglp570_docno_chk()
   DEFINE p_glapdocno      LIKE glap_t.glapdocno
   DEFINE l_oobastus       LIKE ooba_t.oobastus
   
   SELECT oobastus INTO l_oobastus 
     FROM ooba_t LEFT OUTER JOIN oobx_t ON (oobaent=oobxent AND ooba002=oobx001)
    WHERE oobaent = g_enterprise
      AND ooba001 = g_glaa024        #单据别参照表号
      AND ooba002 = g_master.ooba002        #单据别
      AND oobx002 = 'AGL'
      AND oobx003 ='aglt310'         #单据性质
   CASE
      WHEN SQLCA.SQLCODE =100  LET g_errno = 'aim-00056'
      WHEN l_oobastus = 'N'    LET g_errno = 'sub-01302'  #160318-00005#17 mod 'aim-00057'
   END CASE
END FUNCTION

#更新會科基本資料及科目相關歷史資料
#※本作業提供獨立科目轉明細科目/明細科目轉統制科目的批次轉換程序
#新增的这个科目为旧科目的明细科目，层级99，旧科目转为统治，如果旧科目为明细则层级+1，否则层级不变
PRIVATE FUNCTION aglp570_sel_1()
   DEFINE l_sql       STRING
   
    #1.新增會計科目基本資料檔(glac_t,glacl_t,glacs_t)
    #  會計科目=劃面上輸入的新明細科目編號
　  #  其餘欄位=抓原科目編號的對應欄位值
    #2.更新原會計科目編號為統制科目
    #  
    #3.重新計算新舊科目對應的科目層級並回寫該欄位
    #4.新增帳別科目管理設定檔(glad_t)
    #針對使用本參照表的所有帳別,依上述會計科目的新增規則,同步更新帳別科目管理設定檔資料
    CALL aglp570_ins_acc()     
    #5.更新總帳模組各相關檔案.参照表号为当前营运中心参照表的所有帐别下的，原科目編號為新明細科目編號
    # -檔案清單如下:
    #  會計傳票單頭檔(glap_t).glap006
    #  會計傳票單身檔(glaq_t).glaq002
    #  會計科目期餘額檔(glar_t).glar001
    #  傳票摘要彈性預設檔(glah_t).glah001
    #  自由核算項彈性預設檔(glag_t).glag001
    #  會計科目設限檔(glak_t).glak003
    #  報表結構設定單身檔(glaj_t).glaj009/glaj010
    #  常用分攤傳票單身檔(glam_t).glam002/glam005/glam006
    #  常用分攤傳票金額來源檔(glan_t).glan001
    #  帳別科目對應檔(glaw_t).glaw002/glaw004
    #  科目核算項設置默認值表(glas_t).glas001
    UPDATE glap_t SET glap006 = g_master.glac002_p
                WHERE glapent = g_enterprise
                  AND glapld IN( SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise
                                                             AND glaa004 = g_glaa004)
                  AND glap006 = g_master.glac002_s   
    IF SQLCA.SQLCODE THEN
#       CALL cl_errmsg('UPD_glap006','','',SQLCA.SQLCODE,1) 
       INITIALIZE g_errparam TO NULL
       LET g_errparam.extend = 'UPD_glap006'
       LET g_errparam.code   = sqlca.sqlcode
       LET g_errparam.popup  = TRUE 
       CALL cl_err()
       LET g_success = 'N'
    END IF 
    
    UPDATE glaq_t SET glaq002 = g_master.glac002_p
                WHERE glaqent = g_enterprise
                  AND glaqld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise
                                                             AND glaa004 = g_glaa004)
                  AND glaq002 = g_master.glac002_s     
    IF SQLCA.SQLCODE THEN
#       CALL cl_errmsg('UPD_glaq002','','',SQLCA.SQLCODE,1) 
       INITIALIZE g_errparam TO NULL
       LET g_errparam.extend = 'UPD_glaq002'
       LET g_errparam.code   = sqlca.sqlcode
       LET g_errparam.popup  = TRUE 
       CALL cl_err()
       LET g_success = 'N'
    END IF 
    
    UPDATE glar_t SET glar001 = g_master.glac002_p
                WHERE glarent = g_enterprise
                  AND glarld IN( SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise
                                                             AND glaa004 = g_glaa004)
                  AND glar001 = g_master.glac002_s    
    IF SQLCA.SQLCODE THEN
#       CALL cl_errmsg('UPD_glar001','','',SQLCA.SQLCODE,1)
       INITIALIZE g_errparam TO NULL
       LET g_errparam.extend = 'UPD_glar001'
       LET g_errparam.code   = sqlca.sqlcode
       LET g_errparam.popup  = TRUE 
       CALL cl_err()
       LET g_success = 'N'
    END IF 
    
    UPDATE glah_t SET glah001 = g_master.glac002_p
                WHERE glahent = g_enterprise
                  AND glahld IN( SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise
                                                             AND glaa004 = g_glaa004)
                  AND glah001 = g_master.glac002_s 
    IF SQLCA.SQLCODE THEN
#       CALL cl_errmsg('UPD_glah001','','',SQLCA.SQLCODE,1) 
       INITIALIZE g_errparam TO NULL
       LET g_errparam.extend = 'UPD_glah001'
       LET g_errparam.code   = sqlca.sqlcode
       LET g_errparam.popup  = TRUE 
       CALL cl_err()
       LET g_success = 'N'
    END IF 
    
    UPDATE glag_t SET glag001 = g_master.glac002_p
                WHERE glagent = g_enterprise
                  AND glagld IN( SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise
                                                             AND glaa004 = g_glaa004)
                  AND glag001 = g_master.glac002_s 
    IF SQLCA.SQLCODE THEN
#       CALL cl_errmsg('UPD_glag001','','',SQLCA.SQLCODE,1) 
       INITIALIZE g_errparam TO NULL
       LET g_errparam.extend = 'UPD_glag001'
       LET g_errparam.code   = sqlca.sqlcode
       LET g_errparam.popup  = TRUE 
       CALL cl_err()
       LET g_success = 'N'
    END IF 

    UPDATE glak_t SET glak003 = g_master.glac002_p
                WHERE glakent = g_enterprise
                  AND glakld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise
                                                             AND glaa004 = g_glaa004)
                  AND glak003 = g_master.glac002_s 
    IF SQLCA.SQLCODE THEN
#       CALL cl_errmsg('UPD_glak003','','',SQLCA.SQLCODE,1) 
       INITIALIZE g_errparam TO NULL
       LET g_errparam.extend = 'UPD_glak003'
       LET g_errparam.code   = sqlca.sqlcode
       LET g_errparam.popup  = TRUE 
       CALL cl_err()
       LET g_success = 'N'
    END IF 
    
    #UPDATE glaj_t SET glaj009 = g_master.glac002_p
    #            WHERE glajent = g_enterprise
    #              AND glaj009 = g_master.glac002_s 
    #IF SQLCA.SQLCODE THEN
    #   CALL cl_errmsg('UPD_glaj009','','',SQLCA.SQLCODE,1) 
    #   LET g_success = 'N'
    #END IF 
    #
    #UPDATE glaj_t SET glaj010 = g_master.glac002_p
    #            WHERE glajent = g_enterprise
    #              AND glaj010 = g_master.glac002_s 
    #IF SQLCA.SQLCODE THEN
    #   CALL cl_errmsg('UPD_glaj010','','',SQLCA.SQLCODE,1) 
    #   LET g_success = 'N'
    #END IF 
    
    UPDATE glam_t SET glam002 = g_master.glac002_p
                WHERE glament = g_enterprise
                  AND glamld IN( SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise
                                                             AND glaa004 = g_glaa004)
                  AND glam002 = g_master.glac002_s 
    IF SQLCA.SQLCODE THEN
#       CALL cl_errmsg('UPD_glam002','','',SQLCA.SQLCODE,1) 
       INITIALIZE g_errparam TO NULL
       LET g_errparam.extend = 'UPD_glam002'
       LET g_errparam.code   = sqlca.sqlcode
       LET g_errparam.popup  = TRUE 
       CALL cl_err()
       LET g_success = 'N'
    END IF 
    
    UPDATE glam_t SET glam005 = g_master.glac002_p
                WHERE glament = g_enterprise
                  AND glamld IN( SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise
                                                             AND glaa004 = g_glaa004)
                  AND glam005 = g_master.glac002_s 
    IF SQLCA.SQLCODE THEN
#       CALL cl_errmsg('UPD_glam005','','',SQLCA.SQLCODE,1) 
       INITIALIZE g_errparam TO NULL
       LET g_errparam.extend = 'UPD_glam005'
       LET g_errparam.code   = sqlca.sqlcode
       LET g_errparam.popup  = TRUE 
       CALL cl_err()
       LET g_success = 'N'
    END IF 
    
    UPDATE glam_t SET glam006 = g_master.glac002_p
                WHERE glament = g_enterprise
                  AND glamld IN( SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise
                                                             AND glaa004 = g_glaa004)
                  AND glam006 = g_master.glac002_s 
    IF SQLCA.SQLCODE THEN
#       CALL cl_errmsg('UPD_glam006','','',SQLCA.SQLCODE,1) 
       INITIALIZE g_errparam TO NULL
       LET g_errparam.extend = 'UPD_glam006'
       LET g_errparam.code   = sqlca.sqlcode
       LET g_errparam.popup  = TRUE 
       CALL cl_err()
       LET g_success = 'N'
    END IF 
    
    UPDATE glan_t SET glan001 = g_master.glac002_p
                WHERE glanent = g_enterprise
                  AND glanld IN( SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise
                                                             AND glaa004 = g_glaa004)
                  AND glan001 = g_master.glac002_s 
    IF SQLCA.SQLCODE THEN
#       CALL cl_errmsg('UPD_glan001','','',SQLCA.SQLCODE,1) 
       INITIALIZE g_errparam TO NULL
       LET g_errparam.extend = 'UPD_glan001'
       LET g_errparam.code   = sqlca.sqlcode
       LET g_errparam.popup  = TRUE 
       CALL cl_err()
       LET g_success = 'N'
    END IF 
    
    UPDATE glaw_t SET glaw002 = g_master.glac002_p
                WHERE glawent = g_enterprise
                  AND glaw001 IN( SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise
                                                             AND glaa004 = g_glaa004)                                         
                  AND glaw002 = g_master.glac002_s 
    IF SQLCA.SQLCODE THEN
#       CALL cl_errmsg('UPD_glaw002','','',SQLCA.SQLCODE,1) 
       INITIALIZE g_errparam TO NULL
       LET g_errparam.extend = 'UPD_glaw002'
       LET g_errparam.code   = sqlca.sqlcode
       LET g_errparam.popup  = TRUE 
       CALL cl_err()
       LET g_success = 'N'
    END IF 
    
    UPDATE glaw_t SET glaw004 = g_master.glac002_p
                WHERE glawent = g_enterprise
                  AND glaw003 IN ( SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise
                                                             AND glaa004 = g_glaa004)   
                  AND glaw004 = g_master.glac002_s
    IF SQLCA.SQLCODE THEN
#       CALL cl_errmsg('UPD_glaw004','','',SQLCA.SQLCODE,1) 
       INITIALIZE g_errparam TO NULL
       LET g_errparam.extend = 'UPD_glaw004'
       LET g_errparam.code   = sqlca.sqlcode
       LET g_errparam.popup  = TRUE 
       CALL cl_err()
       LET g_success = 'N'
    END IF  

   #2015/02/11--02599--add--str--
   UPDATE glas_t SET glas001 = g_master.glac002_p
                WHERE glasent = g_enterprise
                  AND glasld IN( SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise
                                                             AND glaa004 = g_glaa004)
                  AND glas001 = g_master.glac002_s    
    IF SQLCA.SQLCODE THEN
       INITIALIZE g_errparam TO NULL
       LET g_errparam.extend = 'UPD_glas001'
       LET g_errparam.code   = sqlca.sqlcode
       LET g_errparam.popup  = TRUE 
       CALL cl_err()
       LET g_success = 'N'
    END IF
   #2015/02/11--02599--add--end 
   #6.更新其它模組(非總帳)檔案中含會計科目編號欄位.原科目編號為新明細科目編號
   #  -檔案清單如下: (涉及其他模組規格,待補)
   #160816-00027#1--add--str--
   #----------------------------AGL----------------------------(S)
   #glab005	會計科目編號一
   UPDATE glab_t SET glab005=g_master.glac002_p
    WHERE glabent = g_enterprise
      AND glabld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND glab005 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'UPD_glab005'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #glab006	會計科目編號二
   UPDATE glab_t SET glab006=g_master.glac002_p
    WHERE glabent = g_enterprise
      AND glabld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND glab006 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'UPD_glab006'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #glab007	會計科目編號三
   UPDATE glab_t SET glab007=g_master.glac002_p
    WHERE glabent = g_enterprise
      AND glabld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND glab007 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'UPD_glab007'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #glab008	會計科目編號四
   UPDATE glab_t SET glab008=g_master.glac002_p
    WHERE glabent = g_enterprise
      AND glabld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND glab008 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'UPD_glab008'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #glab009	會計科目編號五
   UPDATE glab_t SET glab009=g_master.glac002_p
    WHERE glabent = g_enterprise
      AND glabld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND glab009 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'UPD_glab009'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #glab012	会计科目编号六
   UPDATE glab_t SET glab012=g_master.glac002_p
    WHERE glabent = g_enterprise
      AND glabld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND glab012 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'UPD_glab012'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #glab013	會計科目編號七
   UPDATE glab_t SET glab013=g_master.glac002_p
    WHERE glabent = g_enterprise
      AND glabld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND glab013 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'UPD_glab013'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #glab016	代收銀收款科目(流通)
   UPDATE glab_t SET glab016=g_master.glac002_p
    WHERE glabent = g_enterprise
      AND glabld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND glab016 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'UPD_glab016'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #glai002	會計科目編號
   UPDATE glai_t SET glai002=g_master.glac002_p
    WHERE glaient = g_enterprise
      AND glai001 = g_glaa004
      AND glai002 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'UPD_glai002'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #glaj002	會計科目編號
   UPDATE glaj_t SET glaj002=g_master.glac002_p
    WHERE glajent = g_enterprise
      AND glaj001 = g_glaa004
      AND glaj002 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'UPD_glaj002'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #glat007	科目
   UPDATE glat_t SET glat007=g_master.glac002_p
    WHERE glatent = g_enterprise
      AND glatld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND glat007 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'UPD_glat007'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #glax002	科目編號
   UPDATE glax_t SET glax002=g_master.glac002_p
    WHERE glaxent = g_enterprise
      AND glaxld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND glax002 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'UPD_glax002'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #glay002	科目編號
   UPDATE glay_t SET glay002=g_master.glac002_p
    WHERE glayent = g_enterprise
      AND glayld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND glay002 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'UPD_glay002'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #glaz003	會計科目
   UPDATE glaz_t SET glaz003=g_master.glac002_p
    WHERE glazent = g_enterprise
      AND glazld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND glaz003 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'UPD_glaz003'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #glbe002	科目編號
   UPDATE glbe_t SET glbe002=g_master.glac002_p
    WHERE glbeent = g_enterprise
      AND glbeld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND glbe002 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update glbe002'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #glbf004	科目編號
   UPDATE glbf_t SET glbf004=g_master.glac002_p
    WHERE glbfent = g_enterprise
      AND glbfld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND glbf004 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update glbf004'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #glcc002	存货科目编号
   UPDATE glcc_t SET glcc002=g_master.glac002_p
    WHERE glccent = g_enterprise
      AND glccld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND glcc002 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update glcc002'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #glcc003	进货(收入)科目编号
   UPDATE glcc_t SET glcc003=g_master.glac002_p
    WHERE glccent = g_enterprise
      AND glccld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND glcc003 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update glcc003'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #glcc004	在制(销货成本)科目
   UPDATE glcc_t SET glcc004=g_master.glac002_p
    WHERE glccent = g_enterprise
      AND glccld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND glcc004 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update glcc004'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #glcc005	委外加工费科目
   UPDATE glcc_t SET glcc005=g_master.glac002_p
    WHERE glccent = g_enterprise
      AND glccld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND glcc005 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update glcc005'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #glcc006	会计科目编号(预留２)
   UPDATE glcc_t SET glcc006=g_master.glac002_p
    WHERE glccent = g_enterprise
      AND glccld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND glcc006 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update glcc006'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #glcc017	科目六(制费三）
   UPDATE glcc_t SET glcc017=g_master.glac002_p
    WHERE glccent = g_enterprise
      AND glccld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND glcc017 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update glcc017'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #glcc018	科目七(制费四）
   UPDATE glcc_t SET glcc018=g_master.glac002_p
    WHERE glccent = g_enterprise
      AND glccld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND glcc018 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update glcc018'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #glcc019	科目八(制费五）
   UPDATE glcc_t SET glcc019=g_master.glac002_p
    WHERE glccent = g_enterprise
      AND glccld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND glcc019 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update glcc019'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #glcc020	標準成本價差科目
   UPDATE glcc_t SET glcc020=g_master.glac002_p
    WHERE glccent = g_enterprise
      AND glccld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND glcc020 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update glcc020'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #glcd001	科目编号
   UPDATE glcd_t SET glcd001=g_master.glac002_p
    WHERE glcdent = g_enterprise
      AND glcdld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND glcd001 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update glcd001'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #glcf003	科目編號
   UPDATE glcf_t SET glcf003=g_master.glac002_p
    WHERE glcfent = g_enterprise
      AND glcfld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND glcf003 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update glcf003'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #glcf047	匯差科目
   UPDATE glcf_t SET glcf047=g_master.glac002_p
    WHERE glcfent = g_enterprise
      AND glcfld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND glcf047 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update glcf047'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #glch002	綜合損益類科目
   UPDATE glch_t SET glch002=g_master.glac002_p
    WHERE glchent = g_enterprise
      AND glchld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND glch002 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update glch002'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #glch003	權益類對應科目
   UPDATE glch_t SET glch003=g_master.glac002_p
    WHERE glchent = g_enterprise
      AND glchld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND glch003 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update glch003'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #glch004	結轉類科目
   UPDATE glch_t SET glch004=g_master.glac002_p
    WHERE glchent = g_enterprise
      AND glchld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND glch004 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update glch004'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #gldf006	來源科目編號
   UPDATE gldf_t SET gldf006=g_master.glac002_p
    WHERE gldfent = g_enterprise
      AND gldf002 IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND gldf006 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update gldf006'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #gldf007	合併科目編號
   UPDATE gldf_t SET gldf007=g_master.glac002_p
    WHERE gldfent = g_enterprise
      AND gldf004 IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND gldf007 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update gldf007'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #gldh003	科目編號
   UPDATE gldh_t SET gldh003=g_master.glac002_p
    WHERE gldhent = g_enterprise
      AND gldh002 IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND gldh003 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update gldh003'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #gldu015	內部交易收入科目
   UPDATE gldu_t SET gldu015=g_master.glac002_p
    WHERE glduent = g_enterprise
      AND glduld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND gldu015 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update gldu015'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #gldu016	內部交易成本科目
   UPDATE gldu_t SET gldu016=g_master.glac002_p
    WHERE glduent = g_enterprise
      AND glduld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND gldu016 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update gldu016'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #gldu017	未實現損益科目
   UPDATE gldu_t SET gldu017=g_master.glac002_p
    WHERE glduent = g_enterprise
      AND glduld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND gldu017 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update gldu017'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #gldv016	未實現損益科目
   UPDATE gldv_t SET gldv016=g_master.glac002_p
    WHERE gldvent = g_enterprise
      AND gldvld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND gldv016 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update gldv016'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #gldv017	攤銷科目
   UPDATE gldv_t SET gldv017=g_master.glac002_p
    WHERE gldvent = g_enterprise
      AND gldvld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND gldv017 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update gldv017'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #gldv018	費用科目
   UPDATE gldv_t SET gldv018=g_master.glac002_p
    WHERE gldvent = g_enterprise
      AND gldvld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND gldv018 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update gldv018'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #glfc003	起始科目
   UPDATE glfc_t SET glfc003=g_master.glac002_p
    WHERE glfcent = g_enterprise
      AND glfc002 = g_glaa004
      AND glfc003 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update glfc003'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #glfc004	截止科目
   UPDATE glfc_t SET glfc004=g_master.glac002_p
    WHERE glfcent = g_enterprise
      AND glfc002 = g_glaa004
      AND glfc004 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update glfc004'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #glgb002	科目編號
   UPDATE glgb_t SET glgb002=g_master.glac002_p
    WHERE glgbent = g_enterprise
      AND glgbld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND glgb002 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update glgb002'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #----------------------------AGL----------------------------(E)
   
   #----------------------------AAP----------------------------(S)
   #apca030	差異科目
   UPDATE apca_t SET apca030=g_master.glac002_p
    WHERE apcaent = g_enterprise
      AND apcald IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND apca030 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update apca030'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #apca035	應付(貸方)科目編號
   UPDATE apca_t SET apca035=g_master.glac002_p
    WHERE apcaent = g_enterprise
      AND apcald IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND apca035 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update apca035'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #apca036	費用(借方)科目編號
   UPDATE apca_t SET apca036=g_master.glac002_p
    WHERE apcaent = g_enterprise
      AND apcald IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND apca036 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update apca036'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #apcb021	費用會計科目
   UPDATE apcb_t SET apcb021=g_master.glac002_p
    WHERE apcbent = g_enterprise
      AND apcbld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND apcb021 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update apcb021'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #apcb029	應付帳款科目
   UPDATE apcb_t SET apcb029=g_master.glac002_p
    WHERE apcbent = g_enterprise
      AND apcbld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND apcb029 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update apcb029'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #apce016	沖銷科目
   UPDATE apce_t SET apce016=g_master.glac002_p
    WHERE apceent = g_enterprise
      AND apceld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND apce016 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update apce016'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #apcf021	待沖銷應付會科
   UPDATE apcf_t SET apcf021=g_master.glac002_p
    WHERE apcfent = g_enterprise
      AND apcfld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND apcf021 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update apcf021'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #apcf022	待沖銷未稅會科
   UPDATE apcf_t SET apcf022=g_master.glac002_p
    WHERE apcfent = g_enterprise
      AND apcfld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND apcf022 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update apcf022'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #apcf023	待沖銷稅額會科
   UPDATE apcf_t SET apcf023=g_master.glac002_p
    WHERE apcfent = g_enterprise
      AND apcfld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND apcf023 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update apcf023'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #apcf024	沖銷價差科目
   UPDATE apcf_t SET apcf024=g_master.glac002_p
    WHERE apcfent = g_enterprise
      AND apcfld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND apcf024 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update apcf024'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #apcf025	沖銷會匯差科目  
   UPDATE apcf_t SET apcf025=g_master.glac002_p
    WHERE apcfent = g_enterprise
      AND apcfld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND apcf025 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update apcf025'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #apdc007	目的會計科目
   UPDATE apdc_t SET apdc007=g_master.glac002_p
    WHERE apdcent = g_enterprise
      AND apdcld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND apdc007 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update apdc007'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #apde016	沖銷會科
   UPDATE apde_t SET apde016=g_master.glac002_p
    WHERE apdeent = g_enterprise
      AND apdeld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND apde016 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update apde016'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #apeb016	沖銷科目
   UPDATE apeb_t SET apeb016=g_master.glac002_p
    WHERE apebent = g_enterprise
      AND apebld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND apeb016 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update apeb016'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   
   #apfb016	沖銷科目
   UPDATE apfb_t SET apfb016=g_master.glac002_p
    WHERE apfbent = g_enterprise
      AND apfbld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND apfb016 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update apfb016'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #apfc014	來源沖銷科目
   UPDATE apfc_t SET apfc014=g_master.glac002_p
    WHERE apfcent = g_enterprise
      AND apfcld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND apfc014 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update apfc014'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #apfd007	目的會計科目
   UPDATE apfd_t SET apfd007=g_master.glac002_p
    WHERE apfdent = g_enterprise
      AND apfdld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND apfd007 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update apfd007'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #apfe016	沖銷科目
   UPDATE apfe_t SET apfe016=g_master.glac002_p
    WHERE apfeent = g_enterprise
      AND apfeld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND apfe016 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update apfe016'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #apgc004	費用科目
   UPDATE apgc_t SET apgc004=g_master.glac002_p
    WHERE apgcent = g_enterprise
      AND apgccomp IN (SELECT glaacomp FROM glaa_t 
                        WHERE glaaent = g_enterprise AND glaa004 = g_glaa004 
                          AND (glaa014 = 'Y' OR glaa008='Y'))
      AND apgc004 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update apgc004'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #----------------------------AAP----------------------------(E)
   
   #----------------------------ABG----------------------------(S)
   #bgao003	會計科目編號
   UPDATE bgao_t SET bgao003=g_master.glac002_p
    WHERE bgaoent = g_enterprise
      AND bgao002 = g_glaa004
      AND bgao003 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update bgao003'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #----------------------------ABG----------------------------(E)
   
   #----------------------------AFA----------------------------(S)
   #faae003	折舊費用科目編號
   UPDATE faae_t SET faae003=g_master.glac002_p
    WHERE faaeent = g_enterprise
      AND faaeld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND faae003 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update faae003'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #faag006	折舊費用科目
   UPDATE faag_t SET faag006=g_master.glac002_p
    WHERE faagent = g_enterprise
      AND faagld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND faag006 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update faag006'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #faag009	變動比率分子科目
   UPDATE faag_t SET faag009=g_master.glac002_p
    WHERE faagent = g_enterprise
      AND faagld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND faag009 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update faag009'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #faaj023	資產科目
   UPDATE faaj_t SET faaj023=g_master.glac002_p
    WHERE faajent = g_enterprise
      AND faajld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND faaj023 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update faaj023'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #faaj024	累折科目
   UPDATE faaj_t SET faaj024=g_master.glac002_p
    WHERE faajent = g_enterprise
      AND faajld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND faaj024 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update faaj024'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #faaj025	折舊科目
   UPDATE faaj_t SET faaj025=g_master.glac002_p
    WHERE faajent = g_enterprise
      AND faajld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND faaj025 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update faaj025'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #faaj026	減值準備科目
   UPDATE faaj_t SET faaj026=g_master.glac002_p
    WHERE faajent = g_enterprise
      AND faajld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND faaj026 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update faaj026'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #faam020	資產科目
   UPDATE faam_t SET faam020=g_master.glac002_p
    WHERE faament = g_enterprise
      AND faamld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND faam020 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update faam020'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #faam021	累折科目
   UPDATE faam_t SET faam021=g_master.glac002_p
    WHERE faament = g_enterprise
      AND faamld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND faam021 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update faam021'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #faam022	折舊科目
   UPDATE faam_t SET faam022=g_master.glac002_p
    WHERE faament = g_enterprise
      AND faamld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND faam022 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update faam022'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #faam023	減值準備科目
   UPDATE faam_t SET faam023=g_master.glac002_p
    WHERE faament = g_enterprise
      AND faamld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND faam023 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update faam023'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #fabb015	资产科目
   UPDATE fabb_t SET fabb015=g_master.glac002_p
    WHERE fabbent = g_enterprise
      AND fabbcomp IN (SELECT glaacomp FROM glaa_t 
                        WHERE glaaent = g_enterprise AND glaa004 = g_glaa004 AND glaa014='Y')
      AND fabb015 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update fabb015'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #fabb017	累折科目
   UPDATE fabb_t SET fabb017=g_master.glac002_p
    WHERE fabbent = g_enterprise
      AND fabbcomp IN (SELECT glaacomp FROM glaa_t 
                        WHERE glaaent = g_enterprise AND glaa004 = g_glaa004 AND glaa014='Y')
      AND fabb017 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update fabb017'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #fabb019	折旧科目
   UPDATE fabb_t SET fabb019=g_master.glac002_p
    WHERE fabbent = g_enterprise
      AND fabbcomp IN (SELECT glaacomp FROM glaa_t 
                        WHERE glaaent = g_enterprise AND glaa004 = g_glaa004 AND glaa014='Y')
      AND fabb019 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update fabb019'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #fabb021	减值准备科目
   UPDATE fabb_t SET fabb021=g_master.glac002_p
    WHERE fabbent = g_enterprise
      AND fabbcomp IN (SELECT glaacomp FROM glaa_t 
                        WHERE glaaent = g_enterprise AND glaa004 = g_glaa004 AND glaa014='Y')
      AND fabb021 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update fabb021'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #fabh021	異動科目
   UPDATE fabh_t SET fabh021=g_master.glac002_p
    WHERE fabhent = g_enterprise
      AND fabhld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND fabh021 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update fabh021'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #fabh022	調整成本
   UPDATE fabh_t SET fabh022=g_master.glac002_p
    WHERE fabhent = g_enterprise
      AND fabhld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND fabh022 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update fabh022'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #fabh023	累計折舊科目
   UPDATE fabh_t SET fabh023=g_master.glac002_p
    WHERE fabhent = g_enterprise
      AND fabhld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND fabh023 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update fabh023'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #fabh024	資產科目
   UPDATE fabh_t SET fabh024=g_master.glac002_p
    WHERE fabhent = g_enterprise
      AND fabhld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND fabh024 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update fabh024'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #fabh025	減值準備科目
   UPDATE fabh_t SET fabh025=g_master.glac002_p
    WHERE fabhent = g_enterprise
      AND fabhld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND fabh025 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update fabh025'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #fabh074	保險費用科目
   UPDATE fabh_t SET fabh074=g_master.glac002_p
    WHERE fabhent = g_enterprise
      AND fabhld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND fabh074 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update fabh074'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #fabo024	異動科目
   UPDATE fabo_t SET fabo024=g_master.glac002_p
    WHERE faboent = g_enterprise
      AND fabold IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND fabo024 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update fabo024'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #fabo026	累折科目
   UPDATE fabo_t SET fabo026=g_master.glac002_p
    WHERE faboent = g_enterprise
      AND fabold IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND fabo026 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update fabo026'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #fabo027	減值準備科目
   UPDATE fabo_t SET fabo027=g_master.glac002_p
    WHERE faboent = g_enterprise
      AND fabold IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND fabo027 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update fabo027'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #fabo028	資產科目
   UPDATE fabo_t SET fabo028=g_master.glac002_p
    WHERE faboent = g_enterprise
      AND fabold IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND fabo028 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update fabo028'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #fabo029	應收帳款科目
   UPDATE fabo_t SET fabo029=g_master.glac002_p
    WHERE faboent = g_enterprise
      AND fabold IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND fabo029 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update fabo029'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #fabo030	稅額科目
   UPDATE fabo_t SET fabo030=g_master.glac002_p
    WHERE faboent = g_enterprise
      AND fabold IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND fabo030 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update fabo030'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #fabp013	資產科目
   UPDATE fabp_t SET fabp013=g_master.glac002_p
    WHERE fabpent = g_enterprise
      AND fabpld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND fabp013 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update fabp013'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #fabp014	累折科目
   UPDATE fabp_t SET fabp014=g_master.glac002_p
    WHERE fabpent = g_enterprise
      AND fabpld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND fabp014 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update fabp014'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #fabp015	折舊科目
   UPDATE fabp_t SET fabp015=g_master.glac002_p
    WHERE fabpent = g_enterprise
      AND fabpld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND fabp015 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update fabp015'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #fabp016	減值準備科目
   UPDATE fabp_t SET fabp016=g_master.glac002_p
    WHERE fabpent = g_enterprise
      AND fabpld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND fabp016 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update fabp016'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #fabp023	異動後資產科目
   UPDATE fabp_t SET fabp023=g_master.glac002_p
    WHERE fabpent = g_enterprise
      AND fabpld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND fabp023 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update fabp023'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #fabp024	異動後累折科目
   UPDATE fabp_t SET fabp024=g_master.glac002_p
    WHERE fabpent = g_enterprise
      AND fabpld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND fabp024 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update fabp024'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #fabp025	異動後折舊科目
   UPDATE fabp_t SET fabp025=g_master.glac002_p
    WHERE fabpent = g_enterprise
      AND fabpld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND fabp025 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update fabp025'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #fabp026	異動後減值準備科目
   UPDATE fabp_t SET fabp026=g_master.glac002_p
    WHERE fabpent = g_enterprise
      AND fabpld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND fabp026 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update fabp026'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #fabs007	借方科目
   UPDATE fabs_t SET fabs007=g_master.glac002_p
    WHERE fabsent = g_enterprise
      AND fabsld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND fabs007 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update fabs007'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #fabs008	貸方科目
   UPDATE fabs_t SET fabs008=g_master.glac002_p
    WHERE fabsent = g_enterprise
      AND fabsld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND fabs008 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update fabs008'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #fabu019	累折科目
   UPDATE fabu_t SET fabu019=g_master.glac002_p
    WHERE fabuent = g_enterprise
      AND fabuld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND fabu019 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update fabu019'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #fabu020	減值準備科目
   UPDATE fabu_t SET fabu020=g_master.glac002_p
    WHERE fabuent = g_enterprise
      AND fabuld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND fabu020 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update fabu020'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #fabu021	資產科目
   UPDATE fabu_t SET fabu021=g_master.glac002_p
    WHERE fabuent = g_enterprise
      AND fabuld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND fabu021 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update fabu021'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #fabu022	應付帳款科目
   UPDATE fabu_t SET fabu022=g_master.glac002_p
    WHERE fabuent = g_enterprise
      AND fabuld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND fabu022 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update fabu022'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #fabu023	稅額科目
   UPDATE fabu_t SET fabu023=g_master.glac002_p
    WHERE fabuent = g_enterprise
      AND fabuld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND fabu023 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update fabu023'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #----------------------------AFA----------------------------(E)

   #----------------------------AFM----------------------------(S)
   #fmab003	融資本金面值科目
   UPDATE fmab_t SET fmab003=g_master.glac002_p
    WHERE fmabent = g_enterprise
      AND fmab002 = g_glaa004
      AND fmab003 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update fmab003'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #fmab004	利息調整科目
   UPDATE fmab_t SET fmab004=g_master.glac002_p
    WHERE fmabent = g_enterprise
      AND fmab002 = g_glaa004
      AND fmab004 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update fmab004'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #fmab005	保證費用科目
   UPDATE fmab_t SET fmab005=g_master.glac002_p
    WHERE fmabent = g_enterprise
      AND fmab002 = g_glaa004
      AND fmab005 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update fmab005'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #fmab006	承銷費用科目
   UPDATE fmab_t SET fmab006=g_master.glac002_p
    WHERE fmabent = g_enterprise
      AND fmab002 = g_glaa004
      AND fmab006 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update fmab006'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #fmab007	簽證費用科目
   UPDATE fmab_t SET fmab007=g_master.glac002_p
    WHERE fmabent = g_enterprise
      AND fmab002 = g_glaa004
      AND fmab007 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update fmab007'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #fmab008	交割服務費用科目
   UPDATE fmab_t SET fmab008=g_master.glac002_p
    WHERE fmabent = g_enterprise
      AND fmab002 = g_glaa004
      AND fmab008 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update fmab008'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #fmab009	費用化利息科目
   UPDATE fmab_t SET fmab009=g_master.glac002_p
    WHERE fmabent = g_enterprise
      AND fmab002 = g_glaa004
      AND fmab009 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update fmab009'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #fmab010	應付利息科目
   UPDATE fmab_t SET fmab010=g_master.glac002_p
    WHERE fmabent = g_enterprise
      AND fmab002 = g_glaa004
      AND fmab010 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update fmab010'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #fmab011	LC折價科目
   UPDATE fmab_t SET fmab011=g_master.glac002_p
    WHERE fmabent = g_enterprise
      AND fmab002 = g_glaa004
      AND fmab011 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update fmab011'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #fmaf008	匯兌損失科目CR
   UPDATE fmaf_t SET fmaf008=g_master.glac002_p
    WHERE fmafent = g_enterprise
      AND fmaf002 IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND fmaf008 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update fmaf008'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #fmaf009	匯兌收益科目DR
   UPDATE fmaf_t SET fmaf009=g_master.glac002_p
    WHERE fmafent = g_enterprise
      AND fmaf002 IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND fmaf009 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update fmaf009'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #fmcu012	科目
   UPDATE fmcu_t SET fmcu012=g_master.glac002_p
    WHERE fmcuent = g_enterprise
      AND fmcudocno IN (SELECT fmctdocno FROM fmct_t 
                         WHERE fmctent = g_enterprise 
                           AND fmctld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004))
      AND fmcu012 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update fmcu012'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #fmcu013	對方科目
   UPDATE fmcu_t SET fmcu013=g_master.glac002_p
    WHERE fmcuent = g_enterprise
      AND fmcudocno IN (SELECT fmctdocno FROM fmct_t 
                         WHERE fmctent = g_enterprise 
                           AND fmctld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004))
      AND fmcu013 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update fmcu013'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #fmdg033	重評價會計科目
   UPDATE fmdg_t SET fmdg033=g_master.glac002_p
    WHERE fmdgent = g_enterprise
      AND fmdgld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND fmdg033 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update fmdg033'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #fmdg034	科目
   UPDATE fmdg_t SET fmdg034=g_master.glac002_p
    WHERE fmdgent = g_enterprise
      AND fmdgld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND fmdg034 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update fmdg034'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #fmmb003	投資本金科目
   UPDATE fmmb_t SET fmmb003=g_master.glac002_p
    WHERE fmmbent = g_enterprise
      AND fmmb002 IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND fmmb003 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update fmmb003'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #fmmb004	公允價值變動科目
   UPDATE fmmb_t SET fmmb004=g_master.glac002_p
    WHERE fmmbent = g_enterprise
      AND fmmb002 IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND fmmb004 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update fmmb004'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #fmmb005	應收股利/利息科目
   UPDATE fmmb_t SET fmmb005=g_master.glac002_p
    WHERE fmmbent = g_enterprise
      AND fmmb002 IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND fmmb005 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update fmmb005'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #fmmb006	公允價值變動損益科目
   UPDATE fmmb_t SET fmmb006=g_master.glac002_p
    WHERE fmmbent = g_enterprise
      AND fmmb002 IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND fmmb006 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update fmmb006'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #fmmb007	交割服務費用科目
   UPDATE fmmb_t SET fmmb007=g_master.glac002_p
    WHERE fmmbent = g_enterprise
      AND fmmb002 IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND fmmb007 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update fmmb007'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #fmmb008	投資收益科目
   UPDATE fmmb_t SET fmmb008=g_master.glac002_p
    WHERE fmmbent = g_enterprise
      AND fmmb002 IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND fmmb008 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update fmmb008'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #fmmb009	利息調整科目
   UPDATE fmmb_t SET fmmb009=g_master.glac002_p
    WHERE fmmbent = g_enterprise
      AND fmmb002 IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND fmmb009 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update fmmb009'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #fmmb010	已宣告未發放股利科目
   UPDATE fmmb_t SET fmmb010=g_master.glac002_p
    WHERE fmmbent = g_enterprise
      AND fmmb002 IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND fmmb010 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update fmmb010'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #fmmb011	已到期未領取利息科目
   UPDATE fmmb_t SET fmmb011=g_master.glac002_p
    WHERE fmmbent = g_enterprise
      AND fmmb002 IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND fmmb011 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update fmmb011'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #fmmb012	公允價值變動損失科目
   UPDATE fmmb_t SET fmmb012=g_master.glac002_p
    WHERE fmmbent = g_enterprise
      AND fmmb002 IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND fmmb012 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update fmmb012'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #fmmb013	投資損失科目
   UPDATE fmmb_t SET fmmb013=g_master.glac002_p
    WHERE fmmbent = g_enterprise
      AND fmmb002 IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND fmmb013 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update fmmb013'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #fmmb014	匯兌收益科目
   UPDATE fmmb_t SET fmmb014=g_master.glac002_p
    WHERE fmmbent = g_enterprise
      AND fmmb002 IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND fmmb014 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update fmmb014'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #fmmb015	匯兌損失科目
   UPDATE fmmb_t SET fmmb015=g_master.glac002_p
    WHERE fmmbent = g_enterprise
      AND fmmb002 IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND fmmb015 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update fmmb015'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #fmmb016	利息收入科目
   UPDATE fmmb_t SET fmmb016=g_master.glac002_p
    WHERE fmmbent = g_enterprise
      AND fmmb002 IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND fmmb016 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update fmmb016'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #fmmd003	科目編號
   UPDATE fmmd_t SET fmmd003=g_master.glac002_p
    WHERE fmmdent = g_enterprise
      AND fmmdld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND fmmd003 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update fmmd003'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #fmmm006	會計科目
   UPDATE fmmm_t SET fmmm006=g_master.glac002_p
    WHERE fmmment = g_enterprise
      AND fmmm001 IN (SELECT fmmldocno FROM fmml_t 
                         WHERE fmmlent = g_enterprise 
                           AND fmml003 IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004))
      AND fmmm006 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update fmmm006'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #fmmm046	對方科目
   UPDATE fmmm_t SET fmmm046=g_master.glac002_p
    WHERE fmmment = g_enterprise
      AND fmmm001 IN (SELECT fmmldocno FROM fmml_t 
                         WHERE fmmlent = g_enterprise 
                           AND fmml003 IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004))
      AND fmmm046 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update fmmm046'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #fmmr011	公允價值變動科目
   UPDATE fmmr_t SET fmmr011=g_master.glac002_p
    WHERE fmmrent = g_enterprise
      AND fmmrdocno IN (SELECT fmmqdocno FROM fmmq_t 
                         WHERE fmmqent = g_enterprise 
                           AND fmmq001 IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004))
      AND fmmr011 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update fmmr011'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #fmmr012	公允價值損益科目
   UPDATE fmmr_t SET fmmr012=g_master.glac002_p
    WHERE fmmrent = g_enterprise
      AND fmmrdocno IN (SELECT fmmqdocno FROM fmmq_t 
                         WHERE fmmqent = g_enterprise 
                           AND fmmq001 IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004))
      AND fmmr012 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update fmmr012'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #fmmx029	會計科目
   UPDATE fmmx_t SET fmmx029=g_master.glac002_p
    WHERE fmmxent = g_enterprise
      AND fmmxdocno IN (SELECT fmmwdocno FROM fmmw_t 
                         WHERE fmmwent = g_enterprise 
                           AND fmmw001 IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004))
      AND fmmx029 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update fmmx029'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #fmmx030	利息費用科目
   UPDATE fmmx_t SET fmmx030=g_master.glac002_p
    WHERE fmmxent = g_enterprise
      AND fmmxdocno IN (SELECT fmmwdocno FROM fmmw_t 
                         WHERE fmmwent = g_enterprise 
                           AND fmmw001 IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004))
      AND fmmx030 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update fmmx030'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #fmmx033	對方科目
   UPDATE fmmx_t SET fmmx033=g_master.glac002_p
    WHERE fmmxent = g_enterprise
      AND fmmxdocno IN (SELECT fmmwdocno FROM fmmw_t 
                         WHERE fmmwent = g_enterprise 
                           AND fmmw001 IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004))
      AND fmmx033 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update fmmx033'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #fmnb028	重評價會計科目
   UPDATE fmnb_t SET fmnb028=g_master.glac002_p
    WHERE fmnbent = g_enterprise
      AND fmnbdocno IN (SELECT fmnadocno FROM fmna_t 
                         WHERE fmnaent = g_enterprise 
                           AND fmna001 IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004))
      AND fmnb028 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update fmnb028'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #fmnb029	科目
   UPDATE fmnb_t SET fmnb029=g_master.glac002_p
    WHERE fmnbent = g_enterprise
      AND fmnbdocno IN (SELECT fmnadocno FROM fmna_t 
                         WHERE fmnaent = g_enterprise 
                           AND fmna001 IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004))
      AND fmnb029 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update fmnb029'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #fmnc003	資金帳戶科目
   UPDATE fmnc_t SET fmnc003=g_master.glac002_p
    WHERE fmncent = g_enterprise
      AND fmnc001 IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND fmnc003 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update fmnc003'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #fmnf029	收入科目
   UPDATE fmnf_t SET fmnf029=g_master.glac002_p
    WHERE fmnfent = g_enterprise
      AND fmnfdocno IN (SELECT fmnedocno FROM fmne_t 
                         WHERE fmneent = g_enterprise 
                           AND fmne001 IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004))
      AND fmnf029 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update fmnf029'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #fmnf030	利息費用科目
   UPDATE fmnf_t SET fmnf030=g_master.glac002_p
    WHERE fmnfent = g_enterprise
      AND fmnfdocno IN (SELECT fmnedocno FROM fmne_t 
                         WHERE fmneent = g_enterprise 
                           AND fmne001 IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004))
      AND fmnf030 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update fmnf030'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #fmnf031	對方科目
   UPDATE fmnf_t SET fmnf031=g_master.glac002_p
    WHERE fmnfent = g_enterprise
      AND fmnfdocno IN (SELECT fmnedocno FROM fmne_t 
                         WHERE fmneent = g_enterprise 
                           AND fmne001 IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004))
      AND fmnf031 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update fmnf031'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #fmng020	應收股利/利息科目DR
   UPDATE fmng_t SET fmng020=g_master.glac002_p
    WHERE fmngent = g_enterprise
      AND fmngdocno IN (SELECT fmmudocno FROM fmmu_t 
                         WHERE fmmuent = g_enterprise 
                           AND fmmu001 IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004))
      AND fmng020 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update fmng020'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #fmng021	利息調整科目
   UPDATE fmng_t SET fmng021=g_master.glac002_p
    WHERE fmngent = g_enterprise
      AND fmngdocno IN (SELECT fmmudocno FROM fmmu_t 
                         WHERE fmmuent = g_enterprise 
                           AND fmmu001 IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004))
      AND fmng021 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update fmng021'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #fmng022	投資收益科目CR
   UPDATE fmng_t SET fmng022=g_master.glac002_p
    WHERE fmngent = g_enterprise
      AND fmngdocno IN (SELECT fmmudocno FROM fmmu_t 
                         WHERE fmmuent = g_enterprise 
                           AND fmmu001 IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004))
      AND fmng022 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update fmng022'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #----------------------------AFM----------------------------(E)
   
   #----------------------------ANM----------------------------(S)
   #nmbb063	对方会科
   UPDATE nmbb_t SET nmbb063=g_master.glac002_p
    WHERE nmbbent = g_enterprise
      AND nmbbcomp IN (SELECT glaacomp FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004 AND glaa014='Y')
      AND nmbb063 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update nmbb063'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #nmbt029	科目
   UPDATE nmbt_t SET nmbt029=g_master.glac002_p
    WHERE nmbtent = g_enterprise
      AND nmbtld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND nmbt029 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update nmbt029'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #nmbt030	對方科目
   UPDATE nmbt_t SET nmbt030=g_master.glac002_p
    WHERE nmbtent = g_enterprise
      AND nmbtld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND nmbt030 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update nmbt030'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #nmck033	對方會科
   UPDATE nmck_t SET nmck033=g_master.glac002_p
    WHERE nmckent = g_enterprise
      AND nmckcomp IN (SELECT glaacomp FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004 AND glaa014='Y')
      AND nmck033 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update nmck033'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #nmcl003	對方會科
   UPDATE nmcl_t SET nmcl003=g_master.glac002_p
    WHERE nmclent = g_enterprise
      AND nmclcomp IN (SELECT glaacomp FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004 AND glaa014='Y')
      AND nmcl003 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update nmcl003'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #nmcm004	會科代碼
   UPDATE nmcm_t SET nmcm004=g_master.glac002_p
    WHERE nmcment = g_enterprise
      AND nmcmcomp IN (SELECT glaacomp FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004 AND glaa014='Y')
      AND nmcm004 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update nmcm004'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #nmcy018	應收付科目
   UPDATE nmcy_t SET nmcy018=g_master.glac002_p
    WHERE nmcyent = g_enterprise
      AND nmcyld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND nmcy018 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update nmcy018'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #nmcy040	科目
   UPDATE nmcy_t SET nmcy040=g_master.glac002_p
    WHERE nmcyent = g_enterprise
      AND nmcyld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND nmcy040 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update nmcy040'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #nmde015	會計科目
   UPDATE nmde_t SET nmde015=g_master.glac002_p
    WHERE nmdeent = g_enterprise
      AND nmdeld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND nmde015 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update nmde015'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #nmed011	對方會科
   UPDATE nmed_t SET nmed011=g_master.glac002_p
    WHERE nmedent = g_enterprise
      AND nmedcomp IN (SELECT glaacomp FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004 AND glaa014='Y')
      AND nmed011 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update nmed011'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #----------------------------ANM----------------------------(E)
   
   #----------------------------AOO----------------------------(S)
   #oobg004	收支科目
   UPDATE oobg_t SET oobg004=g_master.glac002_p
    WHERE oobgent = g_enterprise
      AND oobg001 IN (SELECT glaa024 FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004 AND glaa014='Y')
      AND oobg004 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update oobg004'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #----------------------------AOO----------------------------(E)
   
   #----------------------------APJ----------------------------(S)
   #pjbx005	科目編號
   UPDATE pjbx_t SET pjbx005=g_master.glac002_p
    WHERE pjbxent = g_enterprise
      AND pjbxld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND pjbx005 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update pjbx005'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #pjbz010	科目编号
   UPDATE pjbz_t SET pjbz010=g_master.glac002_p
    WHERE pjbzent = g_enterprise
      AND pjbzld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND pjbz010 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update pjbz010'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #----------------------------APJ----------------------------(E)
   
   #----------------------------AXC----------------------------(S)
   #xcan002	科目编号
   UPDATE xcan_t SET xcan002=g_master.glac002_p
    WHERE xcanent = g_enterprise
      AND xcanld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND xcan002 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update xcan002'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #xcaq003	分攤對象科目編碼
   UPDATE xcaq_t SET xcaq003=g_master.glac002_p
    WHERE xcaqent = g_enterprise
      AND xcaqld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND xcaq003 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update xcaq003'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #xcar002	科目編號
   UPDATE xcar_t SET xcar002=g_master.glac002_p
    WHERE xcarent = g_enterprise
      AND xcarld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND xcar002 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update xcar002'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #xcay001	科目
   UPDATE xcay_t SET xcay001=g_master.glac002_p
    WHERE xcayent = g_enterprise
      AND xcayld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND xcay001 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update xcay001'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #xcba005	科目編號
   UPDATE xcba_t SET xcba005=g_master.glac002_p
    WHERE xcbaent = g_enterprise
      AND xcbald IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND xcba005 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update xcba005'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #xcbj011	會計科目
   UPDATE xcbj_t SET xcbj011=g_master.glac002_p
    WHERE xcbjent = g_enterprise
      AND xcbjld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND xcbj011 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update xcbj011'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #xcbl010	科目編號
   UPDATE xcbl_t SET xcbl010=g_master.glac002_p
    WHERE xcblent = g_enterprise
      AND xcblld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND xcbl010 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update xcbl010'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #xccj032	存貨科目編號
   UPDATE xccj_t SET xccj032=g_master.glac002_p
    WHERE xccjent = g_enterprise
      AND xccjld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND xccj032 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update xccj032'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #xccj033	費用成本科目
   UPDATE xccj_t SET xccj033=g_master.glac002_p
    WHERE xccjent = g_enterprise
      AND xccjld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND xccj033 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update xccj033'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #xccj034	收入科目編號
   UPDATE xccj_t SET xccj034=g_master.glac002_p
    WHERE xccjent = g_enterprise
      AND xccjld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND xccj034 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update xccj034'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #xcck032	存貨科目
   UPDATE xcck_t SET xcck032=g_master.glac002_p
    WHERE xcckent = g_enterprise
      AND xcckld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND xcck032 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update xcck032'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #xcck033	費用成本科目
   UPDATE xcck_t SET xcck033=g_master.glac002_p
    WHERE xcckent = g_enterprise
      AND xcckld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND xcck033 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update xcck033'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #xcck034	收入科目
   UPDATE xcck_t SET xcck034=g_master.glac002_p
    WHERE xcckent = g_enterprise
      AND xcckld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND xcck034 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update xcck034'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #xccl032	存貨科目
   UPDATE xccl_t SET xccl032=g_master.glac002_p
    WHERE xcclent = g_enterprise
      AND xcclld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND xccl032 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update xccl032'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #xccl033	費用成本科目
   UPDATE xccl_t SET xccl033=g_master.glac002_p
    WHERE xcclent = g_enterprise
      AND xcclld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND xccl033 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update xccl033'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #xccl034	收入科目
   UPDATE xccl_t SET xccl034=g_master.glac002_p
    WHERE xcclent = g_enterprise
      AND xcclld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND xccl034 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update xccl034'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #xccm032	存貨科目
   UPDATE xccm_t SET xccm032=g_master.glac002_p
    WHERE xccment = g_enterprise
      AND xccmld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND xccm032 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update xccm032'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #xccm033	費用成本科目
   UPDATE xccm_t SET xccm033=g_master.glac002_p
    WHERE xccment = g_enterprise
      AND xccmld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND xccm033 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update xccm033'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #xccm034	收入科目
   UPDATE xccm_t SET xccm034=g_master.glac002_p
    WHERE xccment = g_enterprise
      AND xccmld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND xccm034 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update xccm034'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #xccs032	存貨科目
   UPDATE xccs_t SET xccs032=g_master.glac002_p
    WHERE xccsent = g_enterprise
      AND xccsld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND xccs032 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update xccs032'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #xccs033	費用成本科目
   UPDATE xccs_t SET xccs033=g_master.glac002_p
    WHERE xccsent = g_enterprise
      AND xccsld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND xccs033 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update xccs033'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #xccs034	收入科目
   UPDATE xccs_t SET xccs034=g_master.glac002_p
    WHERE xccsent = g_enterprise
      AND xccsld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND xccs034 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update xccs034'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #xccw032	存貨科目
   UPDATE xccw_t SET xccw032=g_master.glac002_p
    WHERE xccwent = g_enterprise
      AND xccwld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND xccw032 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update xccw032'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #xccw033	費用成本科目
   UPDATE xccw_t SET xccw033=g_master.glac002_p
    WHERE xccwent = g_enterprise
      AND xccwld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND xccw033 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update xccw033'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #xccw034	收入科目
   UPDATE xccw_t SET xccw034=g_master.glac002_p
    WHERE xccwent = g_enterprise
      AND xccwld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND xccw034 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update xccw034'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #xcdj032	存貨科目
   UPDATE xcdj_t SET xcdj032=g_master.glac002_p
    WHERE xcdjent = g_enterprise
      AND xcdjld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND xcdj032 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update xcdj032'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #xcdj033	費用成本科目
   UPDATE xcdj_t SET xcdj033=g_master.glac002_p
    WHERE xcdjent = g_enterprise
      AND xcdjld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND xcdj033 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update xcdj033'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #xcdj034	收入科目
   UPDATE xcdj_t SET xcdj034=g_master.glac002_p
    WHERE xcdjent = g_enterprise
      AND xcdjld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND xcdj034 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update xcdj034'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #xcdk032	存貨科目
   UPDATE xcdk_t SET xcdk032=g_master.glac002_p
    WHERE xcdkent = g_enterprise
      AND xcdkld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND xcdk032 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update xcdk032'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #xcdk033	費用成本科目
   UPDATE xcdk_t SET xcdk033=g_master.glac002_p
    WHERE xcdkent = g_enterprise
      AND xcdkld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND xcdk033 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update xcdk033'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #xcdk034	收入科目
   UPDATE xcdk_t SET xcdk034=g_master.glac002_p
    WHERE xcdkent = g_enterprise
      AND xcdkld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND xcdk034 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update xcdk034'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #xcdl032	存貨科目
   UPDATE xcdl_t SET xcdl032=g_master.glac002_p
    WHERE xcdlent = g_enterprise
      AND xcdlld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND xcdl032 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update xcdl032'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #xcdl033	費用成本科目
   UPDATE xcdl_t SET xcdl033=g_master.glac002_p
    WHERE xcdlent = g_enterprise
      AND xcdlld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND xcdl033 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update xcdl033'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #xcdl034	收入科目
   UPDATE xcdl_t SET xcdl034=g_master.glac002_p
    WHERE xcdlent = g_enterprise
      AND xcdlld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND xcdl034 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update xcdl034'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #xcdm032	存貨科目
   UPDATE xcdm_t SET xcdm032=g_master.glac002_p
    WHERE xcdment = g_enterprise
      AND xcdmld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND xcdm032 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update xcdm032'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #xcdm033	費用成本科目
   UPDATE xcdm_t SET xcdm033=g_master.glac002_p
    WHERE xcdment = g_enterprise
      AND xcdmld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND xcdm033 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update xcdm033'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #xcdm034	收入科目
   UPDATE xcdm_t SET xcdm034=g_master.glac002_p
    WHERE xcdment = g_enterprise
      AND xcdmld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND xcdm034 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update xcdm034'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #xcdr011	會計科目
   UPDATE xcdr_t SET xcdr011=g_master.glac002_p
    WHERE xcdrent = g_enterprise
      AND xcdrld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND xcdr011 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update xcdr011'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #xcds032	存貨科目
   UPDATE xcds_t SET xcds032=g_master.glac002_p
    WHERE xcdsent = g_enterprise
      AND xcdsld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND xcds032 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update xcds032'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #xcds033	費用成本科目
   UPDATE xcds_t SET xcds033=g_master.glac002_p
    WHERE xcdsent = g_enterprise
      AND xcdsld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND xcds033 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update xcds033'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #xcds034	收入科目
   UPDATE xcds_t SET xcds034=g_master.glac002_p
    WHERE xcdsent = g_enterprise
      AND xcdsld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND xcds034 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update xcds034'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #xcdw032	存貨科目
   UPDATE xcdw_t SET xcdw032=g_master.glac002_p
    WHERE xcdwent = g_enterprise
      AND xcdwld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND xcdw032 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update xcdw032'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #xcdw033	費用成本科目
   UPDATE xcdw_t SET xcdw033=g_master.glac002_p
    WHERE xcdwent = g_enterprise
      AND xcdwld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND xcdw033 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update xcdw033'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #xcdw034	收入科目
   UPDATE xcdw_t SET xcdw034=g_master.glac002_p
    WHERE xcdwent = g_enterprise
      AND xcdwld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND xcdw034 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update xcdw034'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #xceb101	科目編號
   UPDATE xceb_t SET xceb101=g_master.glac002_p
    WHERE xcebent = g_enterprise
      AND xcebld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND xceb101 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update xceb101'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #xcec101	科目編號
   UPDATE xcec_t SET xcec101=g_master.glac002_p
    WHERE xcecent = g_enterprise
      AND xcecld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND xcec101 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update xcec101'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #xced101	科目編號
   UPDATE xced_t SET xced101=g_master.glac002_p
    WHERE xcedent = g_enterprise
      AND xcedld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND xced101 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update xced101'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #xced102	摘要
   UPDATE xced_t SET xced102=g_master.glac002_p
    WHERE xcedent = g_enterprise
      AND xcedld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND xced102 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update xced102'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #xcjf028	收入成本存貨科目
   UPDATE xcjf_t SET xcjf028=g_master.glac002_p
    WHERE xcjfent = g_enterprise
      AND xcjfld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND xcjf028 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update xcjf028'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #xcjf029	對方科目
   UPDATE xcjf_t SET xcjf029=g_master.glac002_p
    WHERE xcjfent = g_enterprise
      AND xcjfld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND xcjf029 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update xcjf029'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #xckb022	科目編號
   UPDATE xckb_t SET xckb022=g_master.glac002_p
    WHERE xckbent = g_enterprise
      AND xckbld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND xckb022 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update xckb022'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #xckc005	科目編號
   UPDATE xckc_t SET xckc005=g_master.glac002_p
    WHERE xckcent = g_enterprise
      AND xckcld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND xckc005 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update xckc005'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #----------------------------AXC----------------------------(E)
   
   #----------------------------AXR----------------------------(S)
   #xrak007	遞延認列收入科目
   UPDATE xrak_t SET xrak007=g_master.glac002_p
    WHERE xrakent = g_enterprise
      AND xrakld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND xrak007 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update xrak007'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #xrca035	應收(借方)科目編號
   UPDATE xrca_t SET xrca035=g_master.glac002_p
    WHERE xrcaent = g_enterprise
      AND xrcald IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND xrca035 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update xrca035'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #xrca036	收入(貸方)科目編號
   UPDATE xrca_t SET xrca036=g_master.glac002_p
    WHERE xrcaent = g_enterprise
      AND xrcald IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND xrca036 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update xrca036'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #xrcb021	收入會計科目
   UPDATE xrcb_t SET xrcb021=g_master.glac002_p
    WHERE xrcbent = g_enterprise
      AND xrcbld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND xrcb021 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update xrcb021'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #xrcb029	應收帳款科目
   UPDATE xrcb_t SET xrcb029=g_master.glac002_p
    WHERE xrcbent = g_enterprise
      AND xrcbld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND xrcb029 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update xrcb029'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #xrcb058	預收科目
   UPDATE xrcb_t SET xrcb058=g_master.glac002_p
    WHERE xrcbent = g_enterprise
      AND xrcbld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND xrcb058 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update xrcb058'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #xrcb059	代收銀科目
   UPDATE xrcb_t SET xrcb059=g_master.glac002_p
    WHERE xrcbent = g_enterprise
      AND xrcbld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND xrcb059 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update xrcb059'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #xrcd009	稅額會計科目
   UPDATE xrcd_t SET xrcd009=g_master.glac002_p
    WHERE xrcdent = g_enterprise
      AND xrcdld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND xrcd009 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update xrcd009'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #xrce016	沖銷科目
   UPDATE xrce_t SET xrce016=g_master.glac002_p
    WHERE xrceent = g_enterprise
      AND xrceld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND xrce016 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update xrce016'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #xrcf021	应收暂估会科
   UPDATE xrcf_t SET xrcf021=g_master.glac002_p
    WHERE xrcfent = g_enterprise
      AND xrcfld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND xrcf021 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update xrcf021'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #xrcf022	暂估未税（收入）会科
   UPDATE xrcf_t SET xrcf022=g_master.glac002_p
    WHERE xrcfent = g_enterprise
      AND xrcfld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND xrcf022 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update xrcf022'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #xrcf023	暂估税额会科
   UPDATE xrcf_t SET xrcf023=g_master.glac002_p
    WHERE xrcfent = g_enterprise
      AND xrcfld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND xrcf023 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update xrcf023'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #xrcf024	冲销差异科目
   UPDATE xrcf_t SET xrcf024=g_master.glac002_p
    WHERE xrcfent = g_enterprise
      AND xrcfld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND xrcf024 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update xrcf024'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #xrcf025	冲销汇率差异科目
   UPDATE xrcf_t SET xrcf025=g_master.glac002_p
    WHERE xrcfent = g_enterprise
      AND xrcfld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND xrcf025 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update xrcf025'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #xrde016	沖銷會科
   UPDATE xrde_t SET xrde016=g_master.glac002_p
    WHERE xrdeent = g_enterprise
      AND xrdeld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND xrde016 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update xrde016'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #xrea019	應收付科目
   UPDATE xrea_t SET xrea019=g_master.glac002_p
    WHERE xreaent = g_enterprise
      AND xreald IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND xrea019 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update xrea019'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #xreb019	應收科目
   UPDATE xreb_t SET xreb019=g_master.glac002_p
    WHERE xrebent = g_enterprise
      AND xrebld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND xreb019 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update xreb019'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #xreb034	重評價會計科目
   UPDATE xreb_t SET xreb034=g_master.glac002_p
    WHERE xrebent = g_enterprise
      AND xrebld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND xreb034 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update xreb034'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #xref011	應收科目
   UPDATE xref_t SET xref011=g_master.glac002_p
    WHERE xrefent = g_enterprise
      AND xrefld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND xref011 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update xref011'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #xref012	收入科目
   UPDATE xref_t SET xref012=g_master.glac002_p
    WHERE xrefent = g_enterprise
      AND xrefld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND xref012 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update xref012'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #xreh019	应收科目
   UPDATE xreh_t SET xreh019=g_master.glac002_p
    WHERE xrehent = g_enterprise
      AND xrehld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND xreh019 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update xreh019'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #xreh034	重评价会科
   UPDATE xreh_t SET xreh034=g_master.glac002_p
    WHERE xrehent = g_enterprise
      AND xrehld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND xreh034 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update xreh034'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #xrek019	壞帳科目
   UPDATE xrek_t SET xrek019=g_master.glac002_p
    WHERE xrekent = g_enterprise
      AND xrekld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND xrek019 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update xrek019'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #xrek041	備抵科目
   UPDATE xrek_t SET xrek041=g_master.glac002_p
    WHERE xrekent = g_enterprise
      AND xrekld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND xrek041 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update xrek041'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #xren019	應收付科目
   UPDATE xren_t SET xren019=g_master.glac002_p
    WHERE xrenent = g_enterprise
      AND xrendocno IN (SELECT xremdocno FROM xrem_t
                         WHERE xrement=g_enterprise 
                           AND xremld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004))
      AND xren019 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update xren019'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #xren042	稅別會科
   UPDATE xren_t SET xren042=g_master.glac002_p
    WHERE xrenent = g_enterprise
      AND xrendocno IN (SELECT xremdocno FROM xrem_t
                         WHERE xrement=g_enterprise 
                           AND xremld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004))
      AND xren042 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update xren042'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #xren043	暫估費用/暫估收入科目
   UPDATE xren_t SET xren043=g_master.glac002_p
    WHERE xrenent = g_enterprise
      AND xrendocno IN (SELECT xremdocno FROM xrem_t
                         WHERE xrement=g_enterprise 
                           AND xremld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004))
      AND xren043 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update xren043'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #xreo009	遞延科目
   UPDATE xreo_t SET xreo009=g_master.glac002_p
    WHERE xreoent = g_enterprise
      AND xreold IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND xreo009 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update xreo009'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #xreq012	遞延科目
   UPDATE xreq_t SET xreq012=g_master.glac002_p
    WHERE xreqent = g_enterprise
      AND xreqld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND xreq012 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update xreq012'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #xreq013	沖轉認列收入科目
   UPDATE xreq_t SET xreq013=g_master.glac002_p
    WHERE xreqent = g_enterprise
      AND xreqld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND xreq013 = g_master.glac002_s    
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'update xreq013'
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N'
   END IF
   #----------------------------AXR----------------------------(E)
   #160816-00027#1--add--end
　 #7.依系統整體標準將上述更新寫入log檔(整體標準log機制未定,待補）
END FUNCTION

#更新會科基本資料並產生科餘結轉的傳票
PRIVATE FUNCTION aglp570_sel_2()
   DEFINE l_sql   STRING
   DEFINE l_sum           LIKE glar_t.glar005    
   DEFINE l_sum1          LIKE glar_t.glar005    #借方金额
   DEFINE l_sum2          LIKE glar_t.glar006    #贷方金额
   DEFINE l_today         DATETIME YEAR TO SECOND
   DEFINE l_glac005       LIKE glac_t.glac005     #层级
   DEFINE l_glac006       LIKE glac_t.glac006     #科目性质
   DEFINE l_success       LIKE type_t.num5
   DEFINE l_glapdocno     LIKE glap_t.glapdocno
   DEFINE l_cnt           LIKE type_t.num5
   DEFINE l_glaald        LIKE glaa_t.glaald
   DEFINE ld_date         DATETIME YEAR TO SECOND
   #161128-00061#1----modify------begin-----------
   #DEFINE l_glaq_m        RECORD LIKE glaq_t.*
   DEFINE l_glaq_m RECORD  #傳票憑證單身檔
       glaqent LIKE glaq_t.glaqent, #企業編號
       glaqcomp LIKE glaq_t.glaqcomp, #法人
       glaqld LIKE glaq_t.glaqld, #帳套
       glaqdocno LIKE glaq_t.glaqdocno, #單號
       glaqseq LIKE glaq_t.glaqseq, #項次
       glaq001 LIKE glaq_t.glaq001, #摘要
       glaq002 LIKE glaq_t.glaq002, #科目編號
       glaq003 LIKE glaq_t.glaq003, #借方金額
       glaq004 LIKE glaq_t.glaq004, #貸方金額
       glaq005 LIKE glaq_t.glaq005, #交易幣別
       glaq006 LIKE glaq_t.glaq006, #匯率
       glaq007 LIKE glaq_t.glaq007, #計價單位
       glaq008 LIKE glaq_t.glaq008, #數量
       glaq009 LIKE glaq_t.glaq009, #單價
       glaq010 LIKE glaq_t.glaq010, #原幣金額
       glaq011 LIKE glaq_t.glaq011, #票據編碼
       glaq012 LIKE glaq_t.glaq012, #票據日期
       glaq013 LIKE glaq_t.glaq013, #申請人
       glaq014 LIKE glaq_t.glaq014, #銀行帳號
       glaq015 LIKE glaq_t.glaq015, #款別編號
       glaq016 LIKE glaq_t.glaq016, #收支專案
       glaq017 LIKE glaq_t.glaq017, #營運據點
       glaq018 LIKE glaq_t.glaq018, #部門
       glaq019 LIKE glaq_t.glaq019, #利潤/成本中心
       glaq020 LIKE glaq_t.glaq020, #區域
       glaq021 LIKE glaq_t.glaq021, #收付款客商
       glaq022 LIKE glaq_t.glaq022, #帳款客戶
       glaq023 LIKE glaq_t.glaq023, #客群
       glaq024 LIKE glaq_t.glaq024, #產品類別
       glaq025 LIKE glaq_t.glaq025, #人員
       glaq026 LIKE glaq_t.glaq026, #no use
       glaq027 LIKE glaq_t.glaq027, #專案編號
       glaq028 LIKE glaq_t.glaq028, #WBS
       glaq029 LIKE glaq_t.glaq029, #自由核算項一
       glaq030 LIKE glaq_t.glaq030, #自由核算項二
       glaq031 LIKE glaq_t.glaq031, #自由核算項三
       glaq032 LIKE glaq_t.glaq032, #自由核算項四
       glaq033 LIKE glaq_t.glaq033, #自由核算項五
       glaq034 LIKE glaq_t.glaq034, #自由核算項六
       glaq035 LIKE glaq_t.glaq035, #自由核算項七
       glaq036 LIKE glaq_t.glaq036, #自由核算項八
       glaq037 LIKE glaq_t.glaq037, #自由核算項九
       glaq038 LIKE glaq_t.glaq038, #自由核算項十
       glaq039 LIKE glaq_t.glaq039, #匯率(本位幣二)
       glaq040 LIKE glaq_t.glaq040, #借方金額(本位幣二)
       glaq041 LIKE glaq_t.glaq041, #貸方金額(本位幣二)
       glaq042 LIKE glaq_t.glaq042, #匯率(本位幣三)
       glaq043 LIKE glaq_t.glaq043, #借方金額(本位幣三)
       glaq044 LIKE glaq_t.glaq044, #貸方金額(本位幣三)
       glaq051 LIKE glaq_t.glaq051, #經營方式
       glaq052 LIKE glaq_t.glaq052, #渠道
       glaq053 LIKE glaq_t.glaq053  #品牌
       END RECORD
#161128-00061#1----modify------end-----------      
   DEFINE l_glaq              DYNAMIC ARRAY OF RECORD 
          glaq002             LIKE glaq_t.glaq002,
          glaq003             LIKE glaq_t.glaq003,
          glaq004             LIKE glaq_t.glaq004,
          glaq010             LIKE glaq_t.glaq010  
          END RECORD
   DEFINE l_glaa003       LIKE glaa_t.glaa003
   DEFINE l_glaa024       LIKE glaa_t.glaa024    

   #1.新增會計科目基本資料檔(glac_t,glacl_t,glacs_t)及帳別科目管理設定檔(glad_t)
      #規則同步驟A.1~4  
      CALL aglp570_ins_acc()
   #2.計算原會計科目截至'啟用年度期別'之前的餘額總合並產生一張將原會科餘額轉入過渡科目的傳票憑證(一借一貸)
   #  傳票單別=劃面上指定的單別,單號依標準取號
   #  傳票日期=劃面上指定的啟用年度期別第一日(如輸入年期= 2013/06, 則傳票日期=2013/06/01)
   #  傳票性質='TR'科餘結轉
   #  IF 原會計科目餘額總合=借餘
   #     傳票單身兩筆(一借一貸):
   #     科目編號(借)=劃面上輸入的過渡科目
   #     科目編號(貸)=原會計科目編號
   #  IF 原會計科目餘額總合=貸餘
   #     傳票單身兩筆(一借一貸):
   #     科目編號(借)=原會計科目編號
   #     科目編號(貸)=劃面上輸入的過渡科目
   #  借貸方金額=計算出的原會計科目餘額
    
   INITIALIZE g_glap.* TO NULL
   INITIALIZE g_glaq.* TO NULL
   INITIALIZE l_glaq_m.* TO NULL
   CALL l_glaq.clear()
   #==========传票单头赋值==================   
   LET g_glap.glapent = g_enterprise
   LET g_glap.glapdocno = g_master.ooba002
   LET g_glap.glapcomp = g_glaacomp
   LET g_glap.glapdocdt = MDY(g_master.glap004,1,g_master.glap002)    
   LET g_glap.glap001 = '1'
   LET g_glap.glap002 = g_master.glap002
   LET g_glap.glap004 = g_master.glap004
   LET g_glap.glap007 = 'TR'
   LET g_glap.glapstus = 'Y'
   LET g_glap.glapcrtid = g_user
   LET g_glap.glapcrtdt = cl_get_current()
   LET g_glap.glapownid = g_user
   LET g_glap.glapowndp = g_dept
   LET g_glap.glapcrtid = g_user
   LET g_glap.glapcrtdp = g_dept 
   LET g_glap.glapcrtdt = cl_get_current()
   LET g_glap.glapcnfid = g_user
   LET g_glap.glapcnfdt = cl_get_current()
   LET ld_date = cl_get_current()
   #=============单身给值=========================
   LET g_glaq.glaqent = g_enterprise
   LET g_glaq.glaqld=g_glap.glapld
   LET g_glaq.glaqdocno = g_glap.glapdocno
   LET g_glaq.glaqcomp = g_glap.glapcomp
   #科目+借贷金额+原币金额
   SELECT SUM(glar005),SUM(glar006) INTO l_sum1,l_sum2 FROM glar_t
    WHERE glarent = g_enterprise
      AND glarld IN (SELECT glaald FROM glaa_t WHERE glaaent = g_enterprise AND glaa004 = g_glaa004)
      AND glar001 = g_master.glac002_s
      AND ((glar002 = g_master.glap002 AND glar003 < g_master.glap004) OR (glar002 < g_master.glap002))
   IF cl_null(l_sum1) THEN LET l_sum1 = 0  END IF 
   IF cl_null(l_sum2) THEN LET l_sum2 = 0  END IF
   IF l_sum1 = 0 AND l_sum2 = 0  THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = 'agl-00159'
      LET g_errparam.extend = ''
      LET g_errparam.popup = FALSE
      CALL cl_err()

      RETURN
   END IF     
   IF l_sum1 - l_sum2 > 0 THEN                 #借余
      LET l_glaq[1].glaq002 = g_master.glac002        #借：劃面上輸入的過渡科目
      LET l_glaq[1].glaq003 = l_sum1
      LET l_glaq[1].glaq004 = 0
      LET l_glaq[1].glaq010 = l_sum1
      LET l_glaq[2].glaq002 = g_master.glac002_s      #贷：原會計科目編號
      LET l_glaq[2].glaq003 = 0
      LET l_glaq[2].glaq004 = l_sum1
      LET l_glaq[2].glaq010 = l_sum1
      LET g_glap.glap010 = l_sum1
      LET g_glap.glap011 = l_sum1
   ELSE                                        #贷余，当借贷相等科目给那边都是一样 
      LET l_glaq[1].glaq002 = g_master.glac002_s      #借：原會計科目編號
      LET l_glaq[1].glaq003 = l_sum2
      LET l_glaq[1].glaq004 = 0
      LET l_glaq[1].glaq010 = l_sum2
      LET l_glaq[2].glaq002 = g_master.glac002        #贷：劃面上輸入的過渡科目
      LET l_glaq[2].glaq003 = 0
      LET l_glaq[2].glaq004 = l_sum2
      LET l_glaq[2].glaq010 = l_sum2
      LET g_glap.glap010 = l_sum2
      LET g_glap.glap011 = l_sum2
   END IF 
   LET g_glaq.glaq005 = g_glaa001
   LET g_glaq.glaq006 = 1
      
   #该参照表号下面的对应的帐别，每个帐别都要产生一套'TR'凭证
   LET l_glaald = ''
   LET l_sql = " SELECT glaald FROM glaa_t WHERE glaaent = '",g_enterprise,"'",
                                           " AND glaa004 = '",g_glaa004,"'",
                                           " ORDER BY glaald "
   PREPARE aglp570_ins_pre1 FROM l_sql
   DECLARE aglp570_ins_cs1  CURSOR FOR aglp570_ins_pre1
   IF SQLCA.SQLCODE THEN
#      CALL cl_errmsg('','','',SQLCA.SQLCODE,1)
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = ''
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N' 
   END IF  
   #抓取原會計科目截至'啟用年度期別'之前的餘額總合並產生一張將原會科餘額轉入過渡科目的傳票憑證(一借一貸)
   #抓取glaq的资料，将原资料借贷互置，并且将原科目编号用新科目代替
   #161128-00061#1----modify------begin-----------
   #LET l_sql = " SELECT * FROM glaq_t ",
   LET l_sql = " SELECT glaqent,glaqcomp,glaqld,glaqdocno,glaqseq,glaq001,glaq002,glaq003,glaq004,glaq005,",
               "glaq006,glaq007,glaq008,glaq009,glaq010,glaq011,glaq012,glaq013,glaq014,glaq015,glaq016,",
               "glaq017,glaq018,glaq019,glaq020,glaq021,glaq022,glaq023,glaq024,glaq025,glaq026,glaq027,",
               "glaq028,glaq029,glaq030,glaq031,glaq032,glaq033,glaq034,glaq035,glaq036,glaq037,glaq038,",
               "glaq039,glaq040,glaq041,glaq042,glaq043,glaq044,glaq051,glaq052,glaq053 FROM glaq_t ",
   #161128-00061#1----modify------end-----------
               "  WHERE glaqent = '",g_enterprise,"'",
               "    AND glaqld = ? ",
               "    AND glaqdocno = ? ",
               " ORDER BY glaqseq "                  
   PREPARE aglp570_glaq_pre2  FROM l_sql
   DECLARE aglp570_glaq_cs2   CURSOR FOR aglp570_glaq_pre2
   IF SQLCA.SQLCODE THEN
#      CALL cl_errmsg('','','',SQLCA.SQLCODE,1)
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = ''
      LET g_errparam.code   = sqlca.sqlcode
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET g_success = 'N' 
   END IF  
      
   FOREACH aglp570_ins_cs1  INTO l_glaald   
      IF SQLCA.SQLCODE THEN
#         CALL cl_errmsg('','FOREACH','',SQLCA.SQLCODE,1)
         INITIALIZE g_errparam TO NULL
         LET g_errparam.extend = 'FOREACH'
         LET g_errparam.code   = sqlca.sqlcode
         LET g_errparam.popup  = TRUE 
         CALL cl_err()
         LET g_success = 'N' 
         EXIT FOREACH
      END IF  
      LET g_glap.glapld = l_glaald 
      #會計週期表號、單據參照表號
      SELECT glaa003,glaa024 INTO l_glaa003,l_glaa024 FROM glaa_t
      WHERE glaaent=g_enterprise AND glaald=g_glap.glapld
      
      CALL s_aooi200_fin_gen_docno(g_glap.glapld,l_glaa024,l_glaa003,g_master.ooba002,g_glap.glapdocdt,'aglt310') RETURNING l_success,l_glapdocno
      IF l_success = FALSE THEN
         LET g_success = 'N'      
         RETURN
      END IF           
      LET g_glap.glapdocno = l_glapdocno           
      #============INSERT_glap============== 
      #161128-00061#1----modify------begin-----------        
      #INSERT INTO glap_t VALUES(g_glap.*)
      INSERT INTO glap_t (glapent,glapld,glapcomp,glapdocno,glapdocdt,glap001,glap002,glap003,glap004,
                          glap005,glap006,glap007,glap008,glap009,glap010,glap011,glap012,glap013,glap014,
                          glap015,glap016,glap017,glapownid,glapowndp,glapcrtid,glapcrtdp,glapcrtdt,glapmodid,
                          glapmoddt,glapcnfid,glapcnfdt,glappstid,glappstdt,glapstus)
       VALUES(g_glap.glapent,g_glap.glapld,g_glap.glapcomp,g_glap.glapdocno,g_glap.glapdocdt,g_glap.glap001,g_glap.glap002,g_glap.glap003,g_glap.glap004,
              g_glap.glap005,g_glap.glap006,g_glap.glap007,g_glap.glap008,g_glap.glap009,g_glap.glap010,g_glap.glap011,g_glap.glap012,g_glap.glap013,g_glap.glap014,
              g_glap.glap015,g_glap.glap016,g_glap.glap017,g_glap.glapownid,g_glap.glapowndp,g_glap.glapcrtid,g_glap.glapcrtdp,g_glap.glapcrtdt,g_glap.glapmodid,
              g_glap.glapmoddt,g_glap.glapcnfid,g_glap.glapcnfdt,g_glap.glappstid,g_glap.glappstdt,g_glap.glapstus)
      #161128-00061#1----modify------end-----------
       
      IF SQLCA.sqlcode THEN
#         CALL cl_errmsg('INS_glap_sel_2',g_glap.glapdocno,'',SQLCA.SQLCODE,1)
         INITIALIZE g_errparam TO NULL
         LET g_errparam.extend = 'INS_glap_sel_2'
         LET g_errparam.code   = sqlca.sqlcode
         LET g_errparam.popup  = TRUE 
         CALL cl_err()
         LET g_success = 'N' 
      END IF
      UPDATE glap_t SET glapcrtdt = ld_date,
                        glapcnfdt = ld_date
      WHERE glapent = g_enterprise
        AND glapld = g_glap.glapld
        AND glapdocno = g_glap.glapdocno
      IF SQLCA.SQLCODE THEN
#         CALL cl_errmsg('UPD_glap_sel_2',g_glap.glapdocno,'',SQLCA.SQLCODE,1)
         INITIALIZE g_errparam TO NULL
         LET g_errparam.extend = 'UPD_glap_sel_2'
         LET g_errparam.code   = sqlca.sqlcode
         LET g_errparam.popup  = TRUE 
         CALL cl_err()
         LET g_success = 'N' 
      END IF
      
      #============INSERT_glaq==============
      LET g_glaq.glaqld = g_glap.glapld
      LET g_glaq.glaqdocno = g_glap.glapdocno
      IF g_success = 'Y' THEN    
         FOR l_cnt =1 TO 2
            #INS---glaq_t
            LET g_glaq.glaqseq = l_cnt 
            LET g_glaq.glaq002 = l_glaq[l_cnt].glaq002
            LET g_glaq.glaq003 = l_glaq[l_cnt].glaq003
            LET g_glaq.glaq004 = l_glaq[l_cnt].glaq004
            #設置核算項默認值
            CALL aglp570_fix_acc_open(g_glaq.glaqld,g_glaq.glaq002)
            
            #161128-00061#1----modify------begin-----------
            #INSERT INTO glaq_t VALUES (g_glaq.*)
             INSERT INTO glaq_t (glaqent,glaqcomp,glaqld,glaqdocno,glaqseq,glaq001,glaq002,glaq003,glaq004,glaq005,
                                 glaq006,glaq007,glaq008,glaq009,glaq010,glaq011,glaq012,glaq013,glaq014,glaq015,
                                 glaq016,glaq017,glaq018,glaq019,glaq020,glaq021,glaq022,glaq023,glaq024,glaq025,
                                 glaq026,glaq027,glaq028,glaq029,glaq030,glaq031,glaq032,glaq033,glaq034,glaq035,
                                 glaq036,glaq037,glaq038,glaq039,glaq040,glaq041,glaq042,glaq043,glaq044,glaq051,
                                 glaq052,glaq053)
              VALUES (g_glaq.glaqent,g_glaq.glaqcomp,g_glaq.glaqld,g_glaq.glaqdocno,g_glaq.glaqseq,g_glaq.glaq001,g_glaq.glaq002,g_glaq.glaq003,g_glaq.glaq004,g_glaq.glaq005,
                      g_glaq.glaq006,g_glaq.glaq007,g_glaq.glaq008,g_glaq.glaq009,g_glaq.glaq010,g_glaq.glaq011,g_glaq.glaq012,g_glaq.glaq013,g_glaq.glaq014,g_glaq.glaq015,
                      g_glaq.glaq016,g_glaq.glaq017,g_glaq.glaq018,g_glaq.glaq019,g_glaq.glaq020,g_glaq.glaq021,g_glaq.glaq022,g_glaq.glaq023,g_glaq.glaq024,g_glaq.glaq025,
                      g_glaq.glaq026,g_glaq.glaq027,g_glaq.glaq028,g_glaq.glaq029,g_glaq.glaq030,g_glaq.glaq031,g_glaq.glaq032,g_glaq.glaq033,g_glaq.glaq034,g_glaq.glaq035,
                      g_glaq.glaq036,g_glaq.glaq037,g_glaq.glaq038,g_glaq.glaq039,g_glaq.glaq040,g_glaq.glaq041,g_glaq.glaq042,g_glaq.glaq043,g_glaq.glaq044,g_glaq.glaq051,
                      g_glaq.glaq052,g_glaq.glaq053)
            #161128-00061#1----modify------end-----------
          
            IF SQLCA.SQLCODE THEN
#               CALL cl_errmsg('INS_glaq_sel_2',g_glap.glapdocno,'',SQLCA.SQLCODE,1)
               INITIALIZE g_errparam TO NULL
               LET g_errparam.extend = 'INS_glaq_sel_2'
               LET g_errparam.code   = sqlca.sqlcode
               LET g_errparam.popup  = TRUE 
               CALL cl_err()
               LET g_success = 'N' 
            END IF 
         END FOR
      END IF 
      #RT传票过账
      CALL s_voucher_post_chk(g_glap.glapld,g_glap.glapdocno) RETURNING l_success
      IF l_success = TRUE THEN
         CALL s_voucher_post_upd(g_glap.glapld,g_glap.glapdocno) RETURNING l_success
      END IF 
      IF l_success = FALSE THEN
         LET g_success = 'N'
      END IF
         
      #3.產生一張將過渡科目餘額轉入新明細科目的傳票憑證(一借一貸)
      # 將步驟B.1.產生的傳票借貸反轉後, 原會計科目編號以新明細科目編號取代,其餘欄位取值方法同步驟B.1.         
      CALL s_aooi200_fin_gen_docno(g_glap.glapld,l_glaa024,l_glaa003,g_master.ooba002,g_glap.glapdocdt,'aglt310') RETURNING l_success,l_glapdocno
      IF l_success = FALSE THEN
         LET g_success = 'N'      
         RETURN
      END IF
      LET g_glap.glapdocno = l_glapdocno
      #161128-00061#1----modify------begin-----------        
      #INSERT INTO glap_t VALUES(g_glap.*)
      INSERT INTO glap_t (glapent,glapld,glapcomp,glapdocno,glapdocdt,glap001,glap002,glap003,glap004,
                          glap005,glap006,glap007,glap008,glap009,glap010,glap011,glap012,glap013,glap014,
                          glap015,glap016,glap017,glapownid,glapowndp,glapcrtid,glapcrtdp,glapcrtdt,glapmodid,
                          glapmoddt,glapcnfid,glapcnfdt,glappstid,glappstdt,glapstus)
       VALUES(g_glap.glapent,g_glap.glapld,g_glap.glapcomp,g_glap.glapdocno,g_glap.glapdocdt,g_glap.glap001,g_glap.glap002,g_glap.glap003,g_glap.glap004,
              g_glap.glap005,g_glap.glap006,g_glap.glap007,g_glap.glap008,g_glap.glap009,g_glap.glap010,g_glap.glap011,g_glap.glap012,g_glap.glap013,g_glap.glap014,
              g_glap.glap015,g_glap.glap016,g_glap.glap017,g_glap.glapownid,g_glap.glapowndp,g_glap.glapcrtid,g_glap.glapcrtdp,g_glap.glapcrtdt,g_glap.glapmodid,
              g_glap.glapmoddt,g_glap.glapcnfid,g_glap.glapcnfdt,g_glap.glappstid,g_glap.glappstdt,g_glap.glapstus)
      #161128-00061#1----modify------end-----------
      IF SQLCA.sqlcode THEN
#         CALL cl_errmsg('INS_glap_sel_22',g_glap.glapdocno,'',SQLCA.SQLCODE,1)
         INITIALIZE g_errparam TO NULL
         LET g_errparam.extend = 'INS_glap_sel_22'
         LET g_errparam.code   = sqlca.sqlcode
         LET g_errparam.popup  = TRUE 
         CALL cl_err()
         LET g_success = 'N' 
      END IF
      UPDATE glap_t SET glapcrtdt = ld_date,
                        glapcnfdt = ld_date
      WHERE glapent = g_enterprise
        AND glapld = g_glap.glapld
        AND glapdocno = g_glap.glapdocno
      IF SQLCA.SQLCODE THEN
#         CALL cl_errmsg('UPD_glap_sel_22',g_glap.glapdocno,'',SQLCA.SQLCODE,1)
         INITIALIZE g_errparam TO NULL
         LET g_errparam.extend = 'UPD_glap_sel_22'
         LET g_errparam.code   = sqlca.sqlcode
         LET g_errparam.popup  = TRUE 
         CALL cl_err()
         LET g_success = 'N' 
      END IF 
      #============INSERT_glaq==============
      OPEN aglp570_glaq_cs2 USING l_glaald,g_glaq.glaqdocno
      FOREACH aglp570_glaq_cs2  INTO l_glaq_m.*
         IF SQLCA.SQLCODE THEN
#            CALL cl_errmsg('','FOREACH','',SQLCA.SQLCODE,1)
            INITIALIZE g_errparam TO NULL
            LET g_errparam.extend = 'FOREACH'
            LET g_errparam.code   = sqlca.sqlcode
            LET g_errparam.popup  = TRUE 
            CALL cl_err()
            LET g_success = 'N' 
            EXIT FOREACH
         END IF
         LET l_glaq_m.glaqdocno = l_glapdocno         
         LET l_sum = l_glaq_m.glaq003
         LET l_glaq_m.glaq003 = l_glaq_m.glaq004
         LET l_glaq_m.glaq004 = l_sum
         IF l_glaq_m.glaq002 == g_master.glac002_s  THEN
            LET l_glaq_m.glaq002 = g_master.glac002_p
         END IF
         
         #161128-00061#1----modify------begin-----------
         #INSERT INTO glaq_t VALUES (l_glaq_m.*)
          INSERT INTO glaq_t (glaqent,glaqcomp,glaqld,glaqdocno,glaqseq,glaq001,glaq002,glaq003,glaq004,glaq005,
                              glaq006,glaq007,glaq008,glaq009,glaq010,glaq011,glaq012,glaq013,glaq014,glaq015,
                              glaq016,glaq017,glaq018,glaq019,glaq020,glaq021,glaq022,glaq023,glaq024,glaq025,
                              glaq026,glaq027,glaq028,glaq029,glaq030,glaq031,glaq032,glaq033,glaq034,glaq035,
                              glaq036,glaq037,glaq038,glaq039,glaq040,glaq041,glaq042,glaq043,glaq044,glaq051,
                              glaq052,glaq053)
           VALUES (l_glaq_m.glaqent,l_glaq_m.glaqcomp,l_glaq_m.glaqld,l_glaq_m.glaqdocno,l_glaq_m.glaqseq,l_glaq_m.glaq001,l_glaq_m.glaq002,l_glaq_m.glaq003,l_glaq_m.glaq004,l_glaq_m.glaq005,
                   l_glaq_m.glaq006,l_glaq_m.glaq007,l_glaq_m.glaq008,l_glaq_m.glaq009,l_glaq_m.glaq010,l_glaq_m.glaq011,l_glaq_m.glaq012,l_glaq_m.glaq013,l_glaq_m.glaq014,l_glaq_m.glaq015,
                   l_glaq_m.glaq016,l_glaq_m.glaq017,l_glaq_m.glaq018,l_glaq_m.glaq019,l_glaq_m.glaq020,l_glaq_m.glaq021,l_glaq_m.glaq022,l_glaq_m.glaq023,l_glaq_m.glaq024,l_glaq_m.glaq025,
                   l_glaq_m.glaq026,l_glaq_m.glaq027,l_glaq_m.glaq028,l_glaq_m.glaq029,l_glaq_m.glaq030,l_glaq_m.glaq031,l_glaq_m.glaq032,l_glaq_m.glaq033,l_glaq_m.glaq034,l_glaq_m.glaq035,
                   l_glaq_m.glaq036,l_glaq_m.glaq037,l_glaq_m.glaq038,l_glaq_m.glaq039,l_glaq_m.glaq040,l_glaq_m.glaq041,l_glaq_m.glaq042,l_glaq_m.glaq043,l_glaq_m.glaq044,l_glaq_m.glaq051,
                   l_glaq_m.glaq052,l_glaq_m.glaq053)
         #161128-00061#1----modify------end-----------
            
         IF SQLCA.SQLCODE THEN
#            CALL cl_errmsg('INS_glaq_sel_22',l_glaq_m.glaqdocno,'',SQLCA.SQLCODE,1)
            INITIALIZE g_errparam TO NULL
            LET g_errparam.extend = 'INS_glaq_sel_22'
            LET g_errparam.code   = sqlca.sqlcode
            LET g_errparam.popup  = TRUE 
            CALL cl_err()
            LET g_success = 'N' 
         END IF 
      END FOREACH 
      #RT传票过账
      CALL s_voucher_post_chk(g_glap.glapld,g_glap.glapdocno) RETURNING l_success
      IF l_success = TRUE THEN
         CALL s_voucher_post_upd(g_glap.glapld,g_glap.glapdocno) RETURNING l_success
      END IF 
      IF l_success = FALSE THEN
         LET g_success = 'N'
      END IF 
   END FOREACH  
END FUNCTION

#新增科目档
#新科目为旧科目的明细科目，层级99，旧科目转为统治，如果旧科目为明细则层级+1，否则层级不变
PRIVATE FUNCTION aglp570_ins_acc()
   DEFINE l_sql       STRING    
   DEFINE l_today     DATETIME YEAR TO SECOND
   DEFINE l_glac005   LIKE glac_t.glac005     #层级
   DEFINE l_glac003   LIKE glac_t.glac003     #科目性质
   DEFINE l_n         LIKE type_t.num5


   #1.新增會計科目基本資料檔(glac_t,glacl_t,glacs_t)
   #  會計科目=劃面上輸入的新明細科目編號
　 #  其餘欄位=抓原科目編號的對應欄位值
   #新增主档
   LET l_today = cl_get_current()
   LET l_sql = " INSERT INTO glac_t(glacent,glac001,glac002,glac003,glac004,glac005,glac006,glac007,glac008,",
               "                    glac009,glac010,glac011,glac012,glac013,glac014,glac015,glac016,glac017,",
               "                    glac018,glac019,glac020,glac021,glac022,glac023,glac025,glac026,glac027,glac028,glac029,glac030,",
               #150814-00006#1--add--str--
               "                    glac031,glac032,glac035,glac036,glac041,glac0411,glac0412,glac042,glac0421,glac0422,",
               "                    glac043,glac0431,glac0432,glac044,glac0441,glac0442,glac045,glac0451,glac0452,",
               "                    glac046,glac0461,glac0462,glac047,glac0471,glac0472,glac048,glac0481,glac0482,",
               "                    glac049,glac0491,glac0492,glac050,glac0501,glac0502,",
               #150814-00006#1--add--end
               "                    glacstus,glaccrtid,glaccrtdp,glacownid,glacowndp)",
               " SELECT glacent,glac001,'",g_master.glac002_p,"','2','",g_master.glac002_s,"','99',glac006,glac007,glac008,",
               "        glac009,glac010,glac011,glac012,glac013,glac014,glac015,glac016,glac017,",
               "        glac018,glac019,glac020,glac021,glac022,glac023,glac025,glac026,glac027,glac028,glac029,glac030,",
               #150814-00006#1--add--str--
               "        glac031,glac032,glac035,glac036,glac041,glac0411,glac0412,glac042,glac0421,glac0422,",
               "        glac043,glac0431,glac0432,glac044,glac0441,glac0442,glac045,glac0451,glac0452,",
               "        glac046,glac0461,glac0462,glac047,glac0471,glac0472,glac048,glac0481,glac0482,",
               "        glac049,glac0491,glac0492,glac050,glac0501,glac0502,",
               #150814-00006#1--add--end
               "        glacstus,'",g_user,"','",g_dept,"','",g_user,"','",g_dept,"' ",
               "   FROM glac_t ",
               "  WHERE glacent = '",g_enterprise,"'",
               "    AND glac001 = '",g_master.glac001,"'",
               "    AND glac002 = '",g_master.glac002_s,"'"
    PREPARE aglp570_glac_pre   FROM l_sql
    EXECUTE aglp570_glac_pre
    IF SQLCA.SQLCODE THEN
#       CALL cl_errmsg('glac002',g_master.glac002_s,'',SQLCA.SQLCODE,1) 
       INITIALIZE g_errparam TO NULL
       LET g_errparam.extend = g_master.glac002_s
       LET g_errparam.code   = sqlca.sqlcode
       LET g_errparam.popup  = TRUE 
       CALL cl_err()
       LET g_success = 'N'
    END IF
    UPDATE glac_t SET glaccrtdt = l_today
     WHERE glacent = g_enterprise
       AND glac001 = g_master.glac001
       AND glac002 = g_master.glac002_p
    IF SQLCA.SQLCODE THEN
#       CALL cl_errmsg('UPD date',g_master.glac002_p,'',SQLCA.SQLCODE,1)
       INITIALIZE g_errparam TO NULL
       LET g_errparam.extend = g_master.glac002_p
       LET g_errparam.code   = sqlca.sqlcode
       LET g_errparam.popup  = TRUE 
       CALL cl_err()
       LET g_success = 'N' 
    END IF 
    #新增多语言档
    #先判断对语言是否已经存在
    SELECT COUNT(*) INTO l_n  FROM glacl_t WHERE glaclent = g_enterprise
                                             AND glacl001 = g_master.glac001
                                             AND glacl002 = g_master.glac002_p
    IF l_n = 0 THEN                                             
       LET l_sql = " INSERT INTO glacl_t(glaclent,glacl001,glacl002,glacl003,glacl004,glacl005)",
                   " SELECT glaclent,glacl001,'",g_master.glac002_p,"',glacl003,'",g_master.glacl004,"',glacl005",
                   "   FROM glacl_t ",
                   "  WHERE glaclent = '",g_enterprise,"'",
                   "    AND glacl001 = '",g_master.glac001,"'",
                   "    AND glacl002 = '",g_master.glac002_s,"'"
       PREPARE aglp570_glacl_pre   FROM l_sql
       EXECUTE aglp570_glacl_pre
       IF SQLCA.SQLCODE THEN
#          CALL cl_errmsg('glacl002',g_master.glac002_s,'',SQLCA.SQLCODE,1)
          INITIALIZE g_errparam TO NULL
          LET g_errparam.extend = g_master.glac002_s
          LET g_errparam.code   = sqlca.sqlcode
          LET g_errparam.popup  = TRUE 
          CALL cl_err()
          LET g_success = 'N'
       END IF 
    END IF 
    #新增提速档
    LET l_sql = " INSERT INTO glacs_t(glacsent,glacs001,glacs002,glacs003,glacs004)",
                " SELECT glacsent,glacs001,'",g_master.glac002_p,"',glacs003,glacs004",
                "   FROM glacs_t ",
                "  WHERE glacsent = '",g_enterprise,"'",
                "    AND glacs001 = '",g_master.glac001,"'",
                "    AND glacs002 = '",g_master.glac002_s,"'"
    PREPARE aglp570_glacs_pre   FROM l_sql
    EXECUTE aglp570_glacs_pre
    IF SQLCA.SQLCODE THEN
#       CALL cl_errmsg('glacs002',g_master.glac002_s,'',SQLCA.SQLCODE,1) 
       INITIALIZE g_errparam TO NULL
       LET g_errparam.extend = g_master.glac002_s
       LET g_errparam.code   = sqlca.sqlcode
       LET g_errparam.popup  = TRUE 
       CALL cl_err()
       LET g_success = 'N'
    END IF 
    
    #2.更新原會計科目編號為統制科目,
    #3.重新計算新舊科目對應的科目層級並回寫該欄位
    #科目层级：统治下为统治最末层为明细 
    SELECT glac003 INTO l_glac003 FROM glac_t
     WHERE glacent = g_enterprise
       AND glac001 = g_master.glac001
       AND glac002 = g_master.glac002_s
    
    SELECT glac005 INTO l_glac005 FROM glac_t
     WHERE glacent = g_enterprise
       AND glac001 = g_master.glac001
       AND glac002 = ( SELECT glac004 FROM glac_t WHERE glacent = g_enterprise 
                                                    AND glac001 = g_master.glac001
                                                    AND glac002 = g_master.glac002_s)    
    #若为明细科目则产生的下一层级为明细，自己作为统治科目,层级+1，否则层级不变
    IF l_glac003 = '2' THEN  
       LET l_glac005 = l_glac005+1
    END IF  
    UPDATE glac_t SET glac003 = '1',
                      glac005 = l_glac005  
     WHERE glacent = g_enterprise
       AND glac001 = g_master.glac001
       AND glac002 = g_master.glac002_s
    IF SQLCA.SQLCODE THEN
#       CALL cl_errmsg('glac003','','',SQLCA.SQLCODE,1) 
       INITIALIZE g_errparam TO NULL
       LET g_errparam.extend = ''
       LET g_errparam.code   = sqlca.sqlcode
       LET g_errparam.popup  = TRUE 
       CALL cl_err()
       LET g_success = 'N'
    END IF 
    
    #4.新增帳別科目管理設定檔(glad_t)
    #針對使用本參照表的所有帳別,依上述會計科目的新增規則,同步更新帳別科目管理設定檔資料
    #161128-00061#1----modify------begin-----------
    #LET l_sql = " SELECT * FROM glad_t  ",
    LET l_sql = " SELECT gladent,gladownid,gladowndp,gladcrtid,gladcrtdp,gladcrtdt,gladmodid,gladmoddt,",
                "gladstus,gladld,glad001,glad002,glad003,glad004,glad005,glad006,glad007,glad008,glad009,",
                "glad010,glad011,glad012,glad013,glad014,glad015,glad016,glad017,glad0171,glad0172,glad018,",
                "glad0181,glad0182,glad019,glad0191,glad0192,glad020,glad0201,glad0202,glad021,glad0211,",
                "glad0212,glad022,glad0221,glad0222,glad023,glad0231,glad0232,glad024,glad0241,glad0242,",
                "glad025,glad0251,glad0252,glad026,glad0261,glad0262,glad027,glad030,glad031,glad032,",
                "glad033,glad034,glad035,glad036 FROM glad_t  ",
    #161128-00061#1----modify------end-----------
                "  WHERE gladent = '",g_enterprise,"'",
                "    AND gladld IN (SELECT glaald FROM glaa_t WHERE glaaent = '",g_enterprise,"'
                                                                 AND glaa004 = '",g_glaa004,"')" ,
                "    AND glad001 = '",g_master.glac002_s,"'",
                "   ORDER BY gladld "      
    
    PREPARE aglp570_glad_pre FROM l_sql
    DECLARE aglp570_glad_cs CURSOR FOR aglp570_glad_pre
    IF SQLCA.SQLCODE THEN
#       CALL cl_errmsg('','','',SQLCA.SQLCODE,1)
       INITIALIZE g_errparam TO NULL
       LET g_errparam.extend = ''
       LET g_errparam.code   = sqlca.sqlcode
       LET g_errparam.popup  = TRUE 
       CALL cl_err()
       LET g_success = 'N'
    END IF 
    OPEN aglp570_glad_cs
    FOREACH  aglp570_glad_cs  INTO  g_glad.*
       IF SQLCA.SQLCODE THEN
#          CALL cl_errmsg('','FOREACH','',SQLCA.SQLCODE,1) 
          INITIALIZE g_errparam TO NULL
          LET g_errparam.extend = 'FOREACH'
          LET g_errparam.code   = sqlca.sqlcode
          LET g_errparam.popup  = TRUE 
          CALL cl_err()
          LET g_success = 'N'
          EXIT FOREACH
       END IF 
       LET g_glad.glad001 = g_master.glac002_p
       LET g_glad.gladcrtid = g_user
       LET g_glad.gladcrtdt = cl_get_current()
       LET g_glad.gladcrtdp = g_dept
       LET g_glad.gladownid = g_user
       LET g_glad.gladowndp = g_dept
       #161128-00061#1----modify------begin-----------
       #INSERT INTO glad_t VALUES(g_glad.*)
       INSERT INTO glad_t (gladent,gladownid,gladowndp,gladcrtid,gladcrtdp,gladcrtdt,gladmodid,gladmoddt,
                           gladstus,gladld,glad001,glad002,glad003,glad004,glad005,glad006,glad007,glad008,
                           glad009,glad010,glad011,glad012,glad013,glad014,glad015,glad016,glad017,glad0171,
                           glad0172,glad018,glad0181,glad0182,glad019,glad0191,glad0192,glad020,glad0201,
                           glad0202,glad021,glad0211,glad0212,glad022,glad0221,glad0222,glad023,glad0231,
                           glad0232,glad024,glad0241,glad0242,glad025,glad0251,glad0252,glad026,glad0261,
                           glad0262,glad027,glad030,glad031,glad032,glad033,glad034,glad035,glad036)
        VALUES(g_glad.gladent,g_glad.gladownid,g_glad.gladowndp,g_glad.gladcrtid,g_glad.gladcrtdp,g_glad.gladcrtdt,g_glad.gladmodid,g_glad.gladmoddt,
               g_glad.gladstus,g_glad.gladld,g_glad.glad001,g_glad.glad002,g_glad.glad003,g_glad.glad004,g_glad.glad005,g_glad.glad006,g_glad.glad007,g_glad.glad008,
               g_glad.glad009,g_glad.glad010,g_glad.glad011,g_glad.glad012,g_glad.glad013,g_glad.glad014,g_glad.glad015,g_glad.glad016,g_glad.glad017,g_glad.glad0171,
               g_glad.glad0172,g_glad.glad018,g_glad.glad0181,g_glad.glad0182,g_glad.glad019,g_glad.glad0191,g_glad.glad0192,g_glad.glad020,g_glad.glad0201,
               g_glad.glad0202,g_glad.glad021,g_glad.glad0211,g_glad.glad0212,g_glad.glad022,g_glad.glad0221,g_glad.glad0222,g_glad.glad023,g_glad.glad0231,
               g_glad.glad0232,g_glad.glad024,g_glad.glad0241,g_glad.glad0242,g_glad.glad025,g_glad.glad0251,g_glad.glad0252,g_glad.glad026,g_glad.glad0261,
               g_glad.glad0262,g_glad.glad027,g_glad.glad030,g_glad.glad031,g_glad.glad032,g_glad.glad033,g_glad.glad034,g_glad.glad035,g_glad.glad036)
       #161128-00061#1----modify------end-----------
       IF SQLCA.SQLCODE THEN
#          CALL cl_errmsg('','INS_glad','',SQLCA.SQLCODE,1) 
          INITIALIZE g_errparam TO NULL
          LET g_errparam.extend = 'INS_glad'
          LET g_errparam.code   = sqlca.sqlcode
          LET g_errparam.popup  = TRUE 
          CALL cl_err()
          LET g_success = 'N'
       END IF 
    END FOREACH 
END FUNCTION

################################################################################
# Descriptions...: 設置未啟用的核算項為空格
# Memo...........:
# Usage..........: CALL aglp570_fix_acc_open(p_glaqld,p_glaq002)
# Input parameter: p_glaqld       帳套
#                : p_glaq002      科目編號
# Date & Author..: 2015/02/11 By 02599
# Modify.........:
################################################################################
PRIVATE FUNCTION aglp570_fix_acc_open(p_glaqld,p_glaq002)
    DEFINE p_glaqld        LIKE glaq_t.glaqld
   DEFINE p_glaq002       LIKE glaq_t.glaq002
   #科目核算项
   DEFINE l_glad007       LIKE glad_t.glad007
   DEFINE l_glad008       LIKE glad_t.glad008
   DEFINE l_glad009       LIKE glad_t.glad009
   DEFINE l_glad010       LIKE glad_t.glad010
   DEFINE l_glad027       LIKE glad_t.glad027
   DEFINE l_glad011       LIKE glad_t.glad011
   DEFINE l_glad012       LIKE glad_t.glad012
   DEFINE l_glad013       LIKE glad_t.glad013
   DEFINE l_glad015       LIKE glad_t.glad015
   DEFINE l_glad016       LIKE glad_t.glad016
   DEFINE l_glad031       LIKE glad_t.glad031
   DEFINE l_glad032       LIKE glad_t.glad032
   DEFINE l_glad033       LIKE glad_t.glad033
   #自由核算项
   DEFINE l_glad017       LIKE glad_t.glad017     #自由核算项一
   DEFINE l_glad018       LIKE glad_t.glad018     #自由核算项二
   DEFINE l_glad019       LIKE glad_t.glad019     #自由核算项三
   DEFINE l_glad020       LIKE glad_t.glad020     #自由核算项四
   DEFINE l_glad021       LIKE glad_t.glad021     #自由核算项五
   DEFINE l_glad022       LIKE glad_t.glad022     #自由核算项六
   DEFINE l_glad023       LIKE glad_t.glad023     #自由核算项七
   DEFINE l_glad024       LIKE glad_t.glad024     #自由核算项八
   DEFINE l_glad025       LIKE glad_t.glad025     #自由核算项九
   DEFINE l_glad026       LIKE glad_t.glad026     #自由核算项十
   
   CALL s_voucher_fix_acc_open_chk(p_glaqld,p_glaq002)
   RETURNING l_glad007,l_glad008,l_glad009,l_glad010,l_glad027,l_glad011,l_glad012,l_glad013,l_glad015,l_glad016,l_glad031,l_glad032,l_glad033
   #自由核算项
   SELECT glad017,glad018,glad019,glad020,glad021,glad022,glad023,glad024,glad025,glad026
     INTO l_glad017,l_glad018,l_glad019,l_glad020,l_glad021,l_glad022,l_glad023,l_glad024,l_glad025,l_glad026
     FROM glad_t
    WHERE gladent = g_enterprise
      AND gladld = p_glaqld
      AND glad001 = p_glaq002
   #營運據點
   IF cl_null(g_glaq.glaq017) THEN
      SELECT glaacomp INTO g_glaq.glaq017 FROM glaa_t WHERE glaaent=g_enterprise AND glaald=p_glaqld
   END IF
   #該科目做部門管理
   IF l_glad007 <> 'Y' OR l_glad007 IS NULL THEN
      LET g_glaq.glaq018 = ' ' 
   ELSE
      IF cl_null(g_glaq.glaq018) THEN
         #依據登入用戶抓取所在部門
         SELECT ooag003 INTO g_glaq.glaq018 FROM ooag_t
          WHERE ooagent = g_enterprise
            AND ooag001 = g_user
      END IF
   END IF 
   #該科目做利潤成本管理時
   IF l_glad008 <> 'Y' OR l_glad008 IS NULL THEN
      LET g_glaq.glaq019 = ' '   
   ELSE
      IF cl_null(g_glaq.glaq019) THEN
         SELECT ooeg004 INTO g_glaq.glaq019 FROM ooeg_t 
          WHERE ooegent = g_enterprise 
            AND ooeg001 = (SELECT ooag003 FROM ooag_t WHERE ooagent = g_enterprise AND ooag001 = g_user)
      END IF
   END IF 
   #該科目做區域管理時
   IF l_glad009 <> 'Y' OR l_glad009 IS NULL THEN
      LET g_glaq.glaq020 = ' '
   ELSE
      IF cl_null(g_glaq.glaq020) THEN
         CALL s_voucher_get_fix_default_value(p_glaqld,p_glaq002,'4') RETURNING g_glaq.glaq020
      END IF
   END IF 
   #該科目做客商管理
   IF l_glad010 <> 'Y' OR l_glad010 IS NULL THEN
      LET g_glaq.glaq021 = ' '
   ELSE
      IF cl_null(g_glaq.glaq021) THEN
         CALL s_voucher_get_fix_default_value(p_glaqld,p_glaq002,'5') RETURNING g_glaq.glaq021
      END IF
   END IF 
   #該科目做账款客商管理時
   IF l_glad027 <> 'Y' OR l_glad027 IS NULL THEN
      LET g_glaq.glaq022 = ' '
   ELSE
      IF cl_null(g_glaq.glaq022) THEN
         CALL s_voucher_get_fix_default_value(p_glaqld,p_glaq002,'6') RETURNING g_glaq.glaq022
      END IF
   END IF 
   #該科目做客群管理時
   IF l_glad011 <> 'Y' OR l_glad011 IS NULL THEN
      LET g_glaq.glaq023 = ' '     
   ELSE
      IF cl_null(g_glaq.glaq023) THEN
         CALL s_voucher_get_fix_default_value(p_glaqld,p_glaq002,'7') RETURNING g_glaq.glaq023
      END IF   
   END IF 
   #該科目做產品分類管理時，
   IF l_glad012 <> 'Y' OR l_glad012 IS NULL THEN
      LET g_glaq.glaq024 = ' '    
   ELSE
      IF cl_null(g_glaq.glaq024) THEN
         CALL s_voucher_get_fix_default_value(p_glaqld,p_glaq002,'8') RETURNING g_glaq.glaq024
      END IF
   END IF 
   #該科目做经营方式管理時，
   IF l_glad031 <> 'Y' OR l_glad031 IS NULL THEN
      LET g_glaq.glaq051 = ' '   
   ELSE
      IF cl_null(g_glaq.glaq051) THEN
         CALL s_voucher_get_fix_default_value(p_glaqld,p_glaq002,'9') RETURNING g_glaq.glaq051
      END IF
   END IF
   #該科目做渠道管理時，
   IF l_glad032 <> 'Y' OR l_glad032 IS NULL THEN
      LET g_glaq.glaq052 = ' '    
   ELSE
      IF cl_null(g_glaq.glaq052) THEN
         CALL s_voucher_get_fix_default_value(p_glaqld,p_glaq002,'10') RETURNING g_glaq.glaq052
      END IF
   END IF
   #該科目做品牌管理時，
   IF l_glad033 <> 'Y' OR l_glad033 IS NULL THEN
      LET g_glaq.glaq053 = ' '    
   ELSE
      IF cl_null(g_glaq.glaq053) THEN
         CALL s_voucher_get_fix_default_value(p_glaqld,p_glaq002,'11') RETURNING g_glaq.glaq053
      END IF
   END IF
   #該科目做人員管理時，
   IF l_glad013 <> 'Y' OR l_glad013 IS NULL THEN
      LET g_glaq.glaq025 = ' '    
   ELSE
      LET g_glaq.glaq025 = g_user
   END IF 
   #該科目做專案管理時，
   IF l_glad015 <> 'Y' OR l_glad015 IS NULL THEN
      LET g_glaq.glaq027 = ' '     
   ELSE
      IF cl_null(g_glaq.glaq027) THEN
         CALL s_voucher_get_fix_default_value(p_glaqld,p_glaq002,'13') RETURNING g_glaq.glaq027
      END IF 
   END IF 
   #該科目做WBS管理時，
   IF l_glad016 <> 'Y' OR l_glad016 IS NULL THEN
      LET g_glaq.glaq028 = ' '   
   ELSE
      IF cl_null(g_glaq.glaq028) THEN
         CALL s_voucher_get_fix_default_value(p_glaqld,p_glaq002,'14') RETURNING g_glaq.glaq028
      END IF
   END IF 
   #核算项一
   IF l_glad017 <> 'Y' OR l_glad017 IS NULL THEN
      LET g_glaq.glaq029 = ' '   
   ELSE
      IF cl_null(g_glaq.glaq029) THEN
         CALL s_voucher_get_fix_default_value(p_glaqld,p_glaq002,'15') RETURNING g_glaq.glaq029
      END IF
   END IF 
   #核算项二
   IF l_glad018 <> 'Y' OR l_glad018 IS NULL THEN
      LET g_glaq.glaq030 = ' '   
   ELSE
      IF cl_null(g_glaq.glaq030) THEN
         CALL s_voucher_get_fix_default_value(p_glaqld,p_glaq002,'16') RETURNING g_glaq.glaq030
      END IF
   END IF
   #核算项三
   IF l_glad019 <> 'Y' OR l_glad019 IS NULL THEN
      LET g_glaq.glaq031 = ' '  
   ELSE
      IF cl_null(g_glaq.glaq031) THEN
         CALL s_voucher_get_fix_default_value(p_glaqld,p_glaq002,'17') RETURNING g_glaq.glaq031
      END IF   
   END IF
   #核算项四
   IF l_glad020 <> 'Y' OR l_glad020 IS NULL THEN
      LET g_glaq.glaq032 = ' '   
   ELSE
      IF cl_null(g_glaq.glaq032) THEN
         CALL s_voucher_get_fix_default_value(p_glaqld,p_glaq002,'18') RETURNING g_glaq.glaq032
      END IF
   END IF
   #核算项五
   IF l_glad021 <> 'Y' OR l_glad021 IS NULL THEN
      LET g_glaq.glaq033 = ' '   
   ELSE
      IF cl_null(g_glaq.glaq033) THEN
         CALL s_voucher_get_fix_default_value(p_glaqld,p_glaq002,'19') RETURNING g_glaq.glaq033
      END IF
   END IF
   #核算项四六
   IF l_glad022 <> 'Y' OR l_glad022 IS NULL THEN
      LET g_glaq.glaq034 = ' '   
   ELSE
      IF cl_null(g_glaq.glaq034) THEN
         CALL s_voucher_get_fix_default_value(p_glaqld,p_glaq002,'20') RETURNING g_glaq.glaq034
      END IF
   END IF
   #核算项七
   IF l_glad023 <> 'Y' OR l_glad023 IS NULL THEN
      LET g_glaq.glaq035 = ' '   
   ELSE
      IF cl_null(g_glaq.glaq035) THEN
         CALL s_voucher_get_fix_default_value(p_glaqld,p_glaq002,'21') RETURNING g_glaq.glaq035
      END IF
   END IF
   #核算项八
   IF l_glad024 <> 'Y' OR l_glad024 IS NULL THEN
      LET g_glaq.glaq036 = ' '   
   ELSE
      IF cl_null(g_glaq.glaq036) THEN
         CALL s_voucher_get_fix_default_value(p_glaqld,p_glaq002,'22') RETURNING g_glaq.glaq036
      END IF
   END IF
   #核算项九
   IF l_glad025 <> 'Y' OR l_glad025 IS NULL THEN
      LET g_glaq.glaq037 = ' '   
   ELSE
      IF cl_null(g_glaq.glaq037) THEN
         CALL s_voucher_get_fix_default_value(p_glaqld,p_glaq002,'23') RETURNING g_glaq.glaq037
      END IF
   END IF
   #核算项十
   IF l_glad026 <> 'Y' OR l_glad026 IS NULL THEN
      LET g_glaq.glaq038 = ' '   
   ELSE
      IF cl_null(g_glaq.glaq038) THEN
         CALL s_voucher_get_fix_default_value(p_glaqld,p_glaq002,'24') RETURNING g_glaq.glaq038
      END IF
   END IF
END FUNCTION

#end add-point
 
{</section>}
 
