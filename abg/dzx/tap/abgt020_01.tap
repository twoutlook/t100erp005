<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<add_points prog="abgt020_01" std_prog="abgt020_01" erpver="1.0" module="ABG" ver="1" env="s" zone="t10dev" normal_style="Y" booking="Y">
  <point name="input.a.bgaz001" order="0" ver="1" cite_std="" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  NOT cl_null(g_bgaz_m.bgaz001) AND NOT cl_null(g_bgaz_m.bgaz002) AND NOT cl_null(g_bgaz_m.bgaz003) AND NOT cl_null(g_bgaz_m.bgaz004) AND NOT cl_null(g_bgaz_m.bgaz005) THEN 
               IF p_cmd = 'a' OR ( p_cmd = 'u' AND ( p_cmd = 'u' AND (g_bgaz_m.bgaz001 != g_bgaz001_t  OR g_bgaz_m.bgaz002 != g_bgaz002_t  OR g_bgaz_m.bgaz003 != g_bgaz003_t  OR g_bgaz_m.bgaz004 != g_bgaz004_t  OR g_bgaz_m.bgaz005 != g_bgaz005_t ))) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM bgaz_t WHERE "||"bgazent = '" ||g_enterprise|| "' AND "||"bgaz001 = '"||g_bgaz_m.bgaz001 ||"' AND "|| "bgaz002 = '"||g_bgaz_m.bgaz002 ||"' AND "|| "bgaz003 = '"||g_bgaz_m.bgaz003 ||"' AND "|| "bgaz004 = '"||g_bgaz_m.bgaz004 ||"' AND "|| "bgaz005 = '"||g_bgaz_m.bgaz005 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF


]]>
  </point>
  <point name="input.a.bgaz002" order="0" ver="1" cite_std="" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  NOT cl_null(g_bgaz_m.bgaz001) AND NOT cl_null(g_bgaz_m.bgaz002) AND NOT cl_null(g_bgaz_m.bgaz003) AND NOT cl_null(g_bgaz_m.bgaz004) AND NOT cl_null(g_bgaz_m.bgaz005) THEN 
               IF p_cmd = 'a' OR ( p_cmd = 'u' AND ( p_cmd = 'u' AND (g_bgaz_m.bgaz001 != g_bgaz001_t  OR g_bgaz_m.bgaz002 != g_bgaz002_t  OR g_bgaz_m.bgaz003 != g_bgaz003_t  OR g_bgaz_m.bgaz004 != g_bgaz004_t  OR g_bgaz_m.bgaz005 != g_bgaz005_t ))) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM bgaz_t WHERE "||"bgazent = '" ||g_enterprise|| "' AND "||"bgaz001 = '"||g_bgaz_m.bgaz001 ||"' AND "|| "bgaz002 = '"||g_bgaz_m.bgaz002 ||"' AND "|| "bgaz003 = '"||g_bgaz_m.bgaz003 ||"' AND "|| "bgaz004 = '"||g_bgaz_m.bgaz004 ||"' AND "|| "bgaz005 = '"||g_bgaz_m.bgaz005 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF


]]>
  </point>
  <point name="input.a.bgaz003" order="0" ver="1" cite_std="" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  NOT cl_null(g_bgaz_m.bgaz001) AND NOT cl_null(g_bgaz_m.bgaz002) AND NOT cl_null(g_bgaz_m.bgaz003) AND NOT cl_null(g_bgaz_m.bgaz004) AND NOT cl_null(g_bgaz_m.bgaz005) THEN 
               IF p_cmd = 'a' OR ( p_cmd = 'u' AND ( p_cmd = 'u' AND (g_bgaz_m.bgaz001 != g_bgaz001_t  OR g_bgaz_m.bgaz002 != g_bgaz002_t  OR g_bgaz_m.bgaz003 != g_bgaz003_t  OR g_bgaz_m.bgaz004 != g_bgaz004_t  OR g_bgaz_m.bgaz005 != g_bgaz005_t ))) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM bgaz_t WHERE "||"bgazent = '" ||g_enterprise|| "' AND "||"bgaz001 = '"||g_bgaz_m.bgaz001 ||"' AND "|| "bgaz002 = '"||g_bgaz_m.bgaz002 ||"' AND "|| "bgaz003 = '"||g_bgaz_m.bgaz003 ||"' AND "|| "bgaz004 = '"||g_bgaz_m.bgaz004 ||"' AND "|| "bgaz005 = '"||g_bgaz_m.bgaz005 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF


]]>
  </point>
  <point name="input.a.bgaz004" order="0" ver="1" cite_std="" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  NOT cl_null(g_bgaz_m.bgaz001) AND NOT cl_null(g_bgaz_m.bgaz002) AND NOT cl_null(g_bgaz_m.bgaz003) AND NOT cl_null(g_bgaz_m.bgaz004) AND NOT cl_null(g_bgaz_m.bgaz005) THEN 
               IF p_cmd = 'a' OR ( p_cmd = 'u' AND ( p_cmd = 'u' AND (g_bgaz_m.bgaz001 != g_bgaz001_t  OR g_bgaz_m.bgaz002 != g_bgaz002_t  OR g_bgaz_m.bgaz003 != g_bgaz003_t  OR g_bgaz_m.bgaz004 != g_bgaz004_t  OR g_bgaz_m.bgaz005 != g_bgaz005_t ))) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM bgaz_t WHERE "||"bgazent = '" ||g_enterprise|| "' AND "||"bgaz001 = '"||g_bgaz_m.bgaz001 ||"' AND "|| "bgaz002 = '"||g_bgaz_m.bgaz002 ||"' AND "|| "bgaz003 = '"||g_bgaz_m.bgaz003 ||"' AND "|| "bgaz004 = '"||g_bgaz_m.bgaz004 ||"' AND "|| "bgaz005 = '"||g_bgaz_m.bgaz005 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF


]]>
  </point>
  <point name="input.a.bgaz005" order="0" ver="1" cite_std="" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  NOT cl_null(g_bgaz_m.bgaz001) AND NOT cl_null(g_bgaz_m.bgaz002) AND NOT cl_null(g_bgaz_m.bgaz003) AND NOT cl_null(g_bgaz_m.bgaz004) AND NOT cl_null(g_bgaz_m.bgaz005) THEN 
               IF p_cmd = 'a' OR ( p_cmd = 'u' AND ( p_cmd = 'u' AND (g_bgaz_m.bgaz001 != g_bgaz001_t  OR g_bgaz_m.bgaz002 != g_bgaz002_t  OR g_bgaz_m.bgaz003 != g_bgaz003_t  OR g_bgaz_m.bgaz004 != g_bgaz004_t  OR g_bgaz_m.bgaz005 != g_bgaz005_t ))) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM bgaz_t WHERE "||"bgazent = '" ||g_enterprise|| "' AND "||"bgaz001 = '"||g_bgaz_m.bgaz001 ||"' AND "|| "bgaz002 = '"||g_bgaz_m.bgaz002 ||"' AND "|| "bgaz003 = '"||g_bgaz_m.bgaz003 ||"' AND "|| "bgaz004 = '"||g_bgaz_m.bgaz004 ||"' AND "|| "bgaz005 = '"||g_bgaz_m.bgaz005 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF


]]>
  </point>
  <point name="function.abgt020_01_free_desc" order="1" ver="1" cite_std="N" cite_ver="" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[#+自定義維度說明
PRIVATE FUNCTION abgt020_01_free_desc(p_bgaz039)
   DEFINE p_bgaz039     LIKE bgaz_t.bgaz039   
   
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] =p_bgaz039
   LET g_ref_fields[2] =g_bgaz_m.bgaz028
   CALL ap_ref_array2(g_ref_fields,"SELECT glafl004 FROM glafl_t WHERE glaflent='"||g_enterprise||"' AND glafl001=? AND glafl002=? AND glafl003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_bgaz_m.bgaz028_desc= g_rtn_fields[1]

   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] =p_bgaz039
   LET g_ref_fields[2] =g_bgaz_m.bgaz029
   CALL ap_ref_array2(g_ref_fields,"SELECT glafl004 FROM glafl_t WHERE glaflent='"||g_enterprise||"' AND glafl001=? AND glafl002=? AND glafl003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_bgaz_m.bgaz029_desc= g_rtn_fields[1]

   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] =p_bgaz039
   LET g_ref_fields[2] =g_bgaz_m.bgaz030
   CALL ap_ref_array2(g_ref_fields,"SELECT glafl004 FROM glafl_t WHERE glaflent='"||g_enterprise||"' AND glafl001=? AND glafl002=? AND glafl003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_bgaz_m.bgaz030_desc= g_rtn_fields[1]

   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] =p_bgaz039
   LET g_ref_fields[2] =g_bgaz_m.bgaz031
   CALL ap_ref_array2(g_ref_fields,"SELECT glafl004 FROM glafl_t WHERE glaflent='"||g_enterprise||"' AND glafl001=? AND glafl002=? AND glafl003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_bgaz_m.bgaz031_desc= g_rtn_fields[1]

   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] =p_bgaz039
   LET g_ref_fields[2] =g_bgaz_m.bgaz032
   CALL ap_ref_array2(g_ref_fields,"SELECT glafl004 FROM glafl_t WHERE glaflent='"||g_enterprise||"' AND glafl001=? AND glafl002=? AND glafl003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_bgaz_m.bgaz032_desc= g_rtn_fields[1]

   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] =p_bgaz039
   LET g_ref_fields[2] =g_bgaz_m.bgaz033
   CALL ap_ref_array2(g_ref_fields,"SELECT glafl004 FROM glafl_t WHERE glaflent='"||g_enterprise||"' AND glafl001=? AND glafl002=? AND glafl003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_bgaz_m.bgaz033_desc= g_rtn_fields[1]

   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] =p_bgaz039
   LET g_ref_fields[2] =g_bgaz_m.bgaz034
   CALL ap_ref_array2(g_ref_fields,"SELECT glafl004 FROM glafl_t WHERE glaflent='"||g_enterprise||"' AND glafl001=? AND glafl002=? AND glafl003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_bgaz_m.bgaz034_desc= g_rtn_fields[1]

   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] =p_bgaz039
   LET g_ref_fields[2] =g_bgaz_m.bgaz035
   CALL ap_ref_array2(g_ref_fields,"SELECT glafl004 FROM glafl_t WHERE glaflent='"||g_enterprise||"' AND glafl001=? AND glafl002=? AND glafl003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_bgaz_m.bgaz035_desc= g_rtn_fields[1]

   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] =p_bgaz039
   LET g_ref_fields[2] =g_bgaz_m.bgaz036
   CALL ap_ref_array2(g_ref_fields,"SELECT glafl004 FROM glafl_t WHERE glaflent='"||g_enterprise||"' AND glafl001=? AND glafl002=? AND glafl003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_bgaz_m.bgaz036_desc= g_rtn_fields[1]

   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] =p_bgaz039
   LET g_ref_fields[2] =g_bgaz_m.bgaz037
   CALL ap_ref_array2(g_ref_fields,"SELECT glafl004 FROM glafl_t WHERE glaflent='"||g_enterprise||"' AND glafl001=? AND glafl002=? AND glafl003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_bgaz_m.bgaz037_desc= g_rtn_fields[1]
END FUNCTION]]>
  </point>
  <point name="function.abgt020_01_free_chk" order="2" ver="1" cite_std="N" cite_ver="" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[#+ 自定义维度检查
PRIVATE FUNCTION abgt020_01_free_chk(p_glaf001,p_glaf002)
   DEFINE p_glaf001      LIKE glaf_t.glaf001
   DEFINE p_glaf002      LIKE glaf_t.glaf002
   DEFINE r_errno        LIKE type_t.chr10      #错误编号
   DEFINE l_glafstus     LIKE glaf_t.glafstus
   DEFINE l_glae002      LIKE glae_t.glae002
   DEFINE l_glae003      LIKE glae_t.glae003
   DEFINE l_glae004      LIKE glae_t.glae004
   DEFINE l_cnt          LIKE type_t.num5

     LET r_errno = ''
      #.抓出改类型对应的资料来源，来源档案，来源编号栏位
      SELECT glae002,glae003,glae004 INTO l_glae002,l_glae003,l_glae004 FROM glae_t
       WHERE glaeent = g_enterprise
         AND glae001 = p_glaf001
      #来源类型为1.‘基本资料’，則檢核來源編號欄位是否存在,檢核核算项值的合理性
      IF l_glae002 = '1' THEN
         SELECT count(*) INTO l_cnt FROM dzeb_t
          WHERE dzeb001 = l_glae003
            AND dzeb002 = l_glae004
         IF l_cnt = 0  THEN
            LET r_errno = 'agl-00073'
            RETURN r_errno
         END IF
         #1.检查资料的有效存在
         SELECT glafstus INTO l_glafstus FROM glaf_t
          WHERE glafent = g_enterprise
            AND glaf001 = p_glaf001
            AND glaf002 = p_glaf002
          IF  SQLCA.SQLCODE = 100  THEN
               LET r_errno = 'agl-00062'
               RETURN r_errno
          END IF
          IF  l_glafstus = 'N'  THEN
              LET g_errno = 'agl-00063'
              RETURN r_errno
          END IF
      END IF
      #来源类型为2.预设值，則輸入值應檢核是否存在自由核算項資料檔,檢核核算项值的合理性
      IF l_glae002 = '2' THEN
         SELECT glafstus INTO l_glafstus FROM glaf_t
             WHERE glafent = g_enterprise
               AND glaf001 = p_glaf001
               AND glaf002 = p_glaf002
         IF SQLCA.SQLCODE = 100  THEN
            LET r_errno = 'agl-00062'
            RETURN r_errno
          END IF
         IF l_glafstus = 'N'  THEN
            LET g_errno = 'agl-00063'
            RETURN r_errno
         END IF    
      END IF
      #若来源类型为3.'自行輸入'則user可任意輸入且不需檢核
      RETURN r_errno
END FUNCTION]]>
  </point>
  <point name="global.variable" order="" ver="1" cite_std="N" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[DEFINE g_bgaz_m_t       type_g_bgaz_m]]>
  </point>
  <point name="input.a.bgaz028" order="" ver="1" cite_std="N" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            DISPLAY '' TO bgaz028_desc
            IF NOT cl_null(g_bgaz_m.bgaz028) THEN
               CALL abgt020_01_free_chk(p_bgaz039,g_bgaz_m.bgaz028) RETURNING l_errno
               IF NOT cl_null(l_errno) THEN
                  CALL cl_err(g_bgaz_m.bgaz028,l_errno,1)
                  LET g_bgaz_m.bgaz028 = g_bgaz_m_t.bgaz028
                  CALL abgt020_01_free_desc(p_bgaz039)
                  DISPLAY BY NAME g_bgaz_m.bgaz028_desc
                  NEXT FIELD bgaz028
               END IF
            END IF
            CALL abgt020_01_free_desc(p_bgaz039)
            DISPLAY BY NAME g_bgaz_m.bgaz028_desc]]>
  </point>
  <point name="input.a.bgaz029" order="" ver="1" cite_std="N" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            DISPLAY '' TO bgaz029_desc
            IF NOT cl_null(g_bgaz_m.bgaz029) THEN
               CALL abgt020_01_free_chk(p_bgaz039,g_bgaz_m.bgaz029) RETURNING l_errno
               IF NOT cl_null(l_errno) THEN
                  CALL cl_err(g_bgaz_m.bgaz029,l_errno,1)
                  LET g_bgaz_m.bgaz029 = g_bgaz_m_t.bgaz029
                  CALL abgt020_01_free_desc(p_bgaz039)
                  DISPLAY BY NAME g_bgaz_m.bgaz029_desc
                  NEXT FIELD bgaz029
               END IF
            END IF
            CALL abgt020_01_free_desc(p_bgaz039)
            DISPLAY BY NAME g_bgaz_m.bgaz029_desc]]>
  </point>
  <point name="input.a.bgaz030" order="" ver="1" cite_std="N" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[             DISPLAY '' TO bgaz030_desc
            IF NOT cl_null(g_bgaz_m.bgaz030) THEN
               CALL abgt020_01_free_chk(p_bgaz039,g_bgaz_m.bgaz030) RETURNING l_errno
               IF NOT cl_null(l_errno) THEN
                  CALL cl_err(g_bgaz_m.bgaz030,l_errno,1)
                  LET g_bgaz_m.bgaz030 = g_bgaz_m_t.bgaz030
                  CALL abgt020_01_free_desc(p_bgaz039)
                  DISPLAY BY NAME g_bgaz_m.bgaz030_desc
                  NEXT FIELD bgaz030
               END IF
            END IF
            CALL abgt020_01_free_desc(p_bgaz039)
            DISPLAY BY NAME g_bgaz_m.bgaz030_desc]]>
  </point>
  <point name="input.a.bgaz031" order="" ver="1" cite_std="N" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[             DISPLAY '' TO bgaz031_desc
            IF NOT cl_null(g_bgaz_m.bgaz031) THEN
               CALL abgt020_01_free_chk(p_bgaz039,g_bgaz_m.bgaz031) RETURNING l_errno
               IF NOT cl_null(l_errno) THEN
                  CALL cl_err(g_bgaz_m.bgaz031,l_errno,1)
                  LET g_bgaz_m.bgaz031 = g_bgaz_m_t.bgaz031
                  CALL abgt020_01_free_desc(p_bgaz039)
                  DISPLAY BY NAME g_bgaz_m.bgaz031_desc
                  NEXT FIELD bgaz031
               END IF
            END IF
            CALL abgt020_01_free_desc(p_bgaz039)
            DISPLAY BY NAME g_bgaz_m.bgaz031_desc]]>
  </point>
  <point name="input.a.bgaz032" order="" ver="1" cite_std="N" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[             DISPLAY '' TO bgaz032_desc
            IF NOT cl_null(g_bgaz_m.bgaz032) THEN
               CALL abgt020_01_free_chk(p_bgaz039,g_bgaz_m.bgaz032) RETURNING l_errno
               IF NOT cl_null(l_errno) THEN
                  CALL cl_err(g_bgaz_m.bgaz032,l_errno,1)
                  LET g_bgaz_m.bgaz032 = g_bgaz_m_t.bgaz032
                  CALL abgt020_01_free_desc(p_bgaz039)
                  DISPLAY BY NAME g_bgaz_m.bgaz032_desc
                  NEXT FIELD bgaz032
               END IF
            END IF
            CALL abgt020_01_free_desc(p_bgaz039)
            DISPLAY BY NAME g_bgaz_m.bgaz032_desc]]>
  </point>
  <point name="input.a.bgaz033" order="" ver="1" cite_std="N" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[             DISPLAY '' TO bgaz033_desc
            IF NOT cl_null(g_bgaz_m.bgaz033) THEN
               CALL abgt020_01_free_chk(p_bgaz039,g_bgaz_m.bgaz033) RETURNING l_errno
               IF NOT cl_null(l_errno) THEN
                  CALL cl_err(g_bgaz_m.bgaz033,l_errno,1)
                  LET g_bgaz_m.bgaz033 = g_bgaz_m_t.bgaz033
                  CALL abgt020_01_free_desc(p_bgaz039)
                  DISPLAY BY NAME g_bgaz_m.bgaz033_desc
                  NEXT FIELD bgaz028
               END IF
            END IF
            CALL abgt020_01_free_desc(p_bgaz039)
            DISPLAY BY NAME g_bgaz_m.bgaz033_desc]]>
  </point>
  <point name="input.a.bgaz034" order="" ver="1" cite_std="N" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[             DISPLAY '' TO bgaz034_desc
            IF NOT cl_null(g_bgaz_m.bgaz034) THEN
               CALL abgt020_01_free_chk(p_bgaz039,g_bgaz_m.bgaz034) RETURNING l_errno
               IF NOT cl_null(l_errno) THEN
                  CALL cl_err(g_bgaz_m.bgaz034,l_errno,1)
                  LET g_bgaz_m.bgaz034 = g_bgaz_m_t.bgaz034
                  CALL abgt020_01_free_desc(p_bgaz039)
                  DISPLAY BY NAME g_bgaz_m.bgaz034_desc
                  NEXT FIELD bgaz034
               END IF
            END IF
            CALL abgt020_01_free_desc(p_bgaz039)
            DISPLAY BY NAME g_bgaz_m.bgaz034_desc]]>
  </point>
  <point name="input.a.bgaz035" order="" ver="1" cite_std="N" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            DISPLAY '' TO bgaz035_desc
            IF NOT cl_null(g_bgaz_m.bgaz035) THEN
               CALL abgt020_01_free_chk(p_bgaz039,g_bgaz_m.bgaz035) RETURNING l_errno
               IF NOT cl_null(l_errno) THEN
                  CALL cl_err(g_bgaz_m.bgaz035,l_errno,1)
                  LET g_bgaz_m.bgaz035 = g_bgaz_m_t.bgaz035
                  CALL abgt020_01_free_desc(p_bgaz039)
                  DISPLAY BY NAME g_bgaz_m.bgaz035_desc
                  NEXT FIELD bgaz035
               END IF
            END IF
            CALL abgt020_01_free_desc(p_bgaz039)
            DISPLAY BY NAME g_bgaz_m.bgaz035_desc]]>
  </point>
  <point name="input.a.bgaz036" order="" ver="1" cite_std="N" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[             DISPLAY '' TO bgaz036_desc
            IF NOT cl_null(g_bgaz_m.bgaz036) THEN
               CALL abgt020_01_free_chk(p_bgaz039,g_bgaz_m.bgaz036) RETURNING l_errno
               IF NOT cl_null(l_errno) THEN
                  CALL cl_err(g_bgaz_m.bgaz036,l_errno,1)
                  LET g_bgaz_m.bgaz036 = g_bgaz_m_t.bgaz036
                  CALL abgt020_01_free_desc(p_bgaz039)
                  DISPLAY BY NAME g_bgaz_m.bgaz036_desc
                  NEXT FIELD bgaz036
               END IF
            END IF
            CALL abgt020_01_free_desc(p_bgaz039)
            DISPLAY BY NAME g_bgaz_m.bgaz036_desc]]>
  </point>
  <point name="input.a.bgaz037" order="" ver="1" cite_std="N" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[             DISPLAY '' TO bgaz037_desc
            IF NOT cl_null(g_bgaz_m.bgaz037) THEN
               CALL abgt020_01_free_chk(p_bgaz039,g_bgaz_m.bgaz037) RETURNING l_errno
               IF NOT cl_null(l_errno) THEN
                  CALL cl_err(g_bgaz_m.bgaz037,l_errno,1)
                  LET g_bgaz_m.bgaz037 = g_bgaz_m_t.bgaz037
                  CALL abgt020_01_free_desc(p_bgaz039)
                  DISPLAY BY NAME g_bgaz_m.bgaz037_desc
                  NEXT FIELD bgaz037
               END IF
            END IF
            CALL abgt020_01_free_desc(p_bgaz039)
            DISPLAY BY NAME g_bgaz_m.bgaz037_desc]]>
  </point>
  <point name="input.before_input" order="" ver="1" cite_std="N" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #如果原来存在资料，则先拉出显示
            SELECT bgaz028,bgaz029,bgaz030,bgaz031,bgaz032,
                   bgaz033,bgaz034,bgaz035,bgaz036,bgaz037
              INTO g_bgaz_m.bgaz028,g_bgaz_m.bgaz029,g_bgaz_m.bgaz030,g_bgaz_m.bgaz031,g_bgaz_m.bgaz032,
                   g_bgaz_m.bgaz033,g_bgaz_m.bgaz034,g_bgaz_m.bgaz035,g_bgaz_m.bgaz036,g_bgaz_m.bgaz037              
              FROM bgaz_t
              WHERE bgazent = g_enterprise
                AND bgaz001 = p_bgaz001
                AND bgaz002 = p_bgaz002
                AND bgaz003 = p_bgaz003
                AND bgaz004 = p_bgaz004
            #旧值备份
            LET g_bgaz_m_t.* = g_bgaz_m.*
            CALL abgt020_01_free_desc(p_bgaz039)
            DISPLAY BY NAME g_bgaz_m.*
                        ]]>
  </point>
  <point name="input.c.bgaz028" order="" ver="1" cite_std="N" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #開窗i段
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_bgaz_m.bgaz028             #給予default值
            LET g_qryparam.default2 = "" #g_bgaz_m.glafl004 #說明

            #給予arg
            CALL q_glaf002()                                #呼叫開窗

            LET g_bgaz_m.bgaz029 = g_qryparam.return1              #將開窗取得的值回傳到變數
            LET g_bgaz_m.bgaz029_desc = g_qryparam.return2 #說明

            DISPLAY g_bgaz_m.bgaz028 TO bgaz028              #顯示到畫面上
            DISPLAY g_bgaz_m.bgaz028_desc TO bgaz028_desc    #說明
            
            NEXT FIELD bgaz028 ]]>
  </point>
  <point name="input.c.bgaz029" order="" ver="1" cite_std="N" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[             #開窗i段
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_bgaz_m.bgaz029             #給予default值
            LET g_qryparam.default2 = "" #g_bgaz_m.glafl004 #說明

            #給予arg
            CALL q_glaf002()                                #呼叫開窗

            LET g_bgaz_m.bgaz029 = g_qryparam.return1              #將開窗取得的值回傳到變數
            LET g_bgaz_m.bgaz029_desc = g_qryparam.return2 #說明

            DISPLAY g_bgaz_m.bgaz029 TO bgaz029              #顯示到畫面上
            DISPLAY g_bgaz_m.bgaz029_desc TO bgaz029_desc    #說明
            
            NEXT FIELD bgaz029 ]]>
  </point>
  <point name="input.c.bgaz030" order="" ver="1" cite_std="N" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[             #開窗i段
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_bgaz_m.bgaz030             #給予default值
            LET g_qryparam.default2 = "" #g_bgaz_m.glafl004 #說明

            #給予arg
            CALL q_glaf002()                                #呼叫開窗

            LET g_bgaz_m.bgaz030 = g_qryparam.return1              #將開窗取得的值回傳到變數
            LET g_bgaz_m.bgaz030_desc = g_qryparam.return2 #說明

            DISPLAY g_bgaz_m.bgaz030 TO bgaz030              #顯示到畫面上
            DISPLAY g_bgaz_m.bgaz030_desc TO bgaz030_desc    #說明
            
            NEXT FIELD bgaz030 ]]>
  </point>
  <point name="input.c.bgaz031" order="" ver="1" cite_std="N" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[             #開窗i段
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_bgaz_m.bgaz031             #給予default值
            LET g_qryparam.default2 = "" #g_bgaz_m.glafl004 #說明

            #給予arg
            CALL q_glaf002()                                #呼叫開窗

            LET g_bgaz_m.bgaz031 = g_qryparam.return1              #將開窗取得的值回傳到變數
            LET g_bgaz_m.bgaz031_desc = g_qryparam.return2 #說明

            DISPLAY g_bgaz_m.bgaz031 TO bgaz031              #顯示到畫面上
            DISPLAY g_bgaz_m.bgaz031_desc TO bgaz031_desc    #說明
            
            NEXT FIELD bgaz031 ]]>
  </point>
  <point name="input.c.bgaz032" order="" ver="1" cite_std="N" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[             #開窗i段
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_bgaz_m.bgaz032             #給予default值
            LET g_qryparam.default2 = "" #g_bgaz_m.glafl004 #說明

            #給予arg
            CALL q_glaf002()                                #呼叫開窗

            LET g_bgaz_m.bgaz032 = g_qryparam.return1              #將開窗取得的值回傳到變數
            LET g_bgaz_m.bgaz032_desc = g_qryparam.return2 #說明

            DISPLAY g_bgaz_m.bgaz032 TO bgaz032              #顯示到畫面上
            DISPLAY g_bgaz_m.bgaz032_desc TO bgaz032_desc    #說明
            
            NEXT FIELD bgaz032 ]]>
  </point>
  <point name="input.c.bgaz033" order="" ver="1" cite_std="N" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[             #開窗i段
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_bgaz_m.bgaz033             #給予default值
            LET g_qryparam.default2 = "" #g_bgaz_m.glafl004 #說明

            #給予arg
            CALL q_glaf002()                                #呼叫開窗

            LET g_bgaz_m.bgaz029 = g_qryparam.return1              #將開窗取得的值回傳到變數
            LET g_bgaz_m.bgaz029_desc = g_qryparam.return2 #說明

            DISPLAY g_bgaz_m.bgaz033 TO bgaz033              #顯示到畫面上
            DISPLAY g_bgaz_m.bgaz033_desc TO bgaz033_desc    #說明
            
            NEXT FIELD bgaz033 ]]>
  </point>
  <point name="input.c.bgaz034" order="" ver="1" cite_std="N" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[             #開窗i段
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_bgaz_m.bgaz034             #給予default值
            LET g_qryparam.default2 = "" #g_bgaz_m.glafl004 #說明

            #給予arg
            CALL q_glaf002()                                #呼叫開窗

            LET g_bgaz_m.bgaz034 = g_qryparam.return1              #將開窗取得的值回傳到變數
            LET g_bgaz_m.bgaz034_desc = g_qryparam.return2 #說明

            DISPLAY g_bgaz_m.bgaz034 TO bgaz034              #顯示到畫面上
            DISPLAY g_bgaz_m.bgaz034_desc TO bgaz034_desc    #說明
            
            NEXT FIELD bgaz034 ]]>
  </point>
  <point name="input.c.bgaz035" order="" ver="1" cite_std="N" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[             #開窗i段
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_bgaz_m.bgaz035             #給予default值
            LET g_qryparam.default2 = "" #g_bgaz_m.glafl004 #說明

            #給予arg
            CALL q_glaf002()                                #呼叫開窗

            LET g_bgaz_m.bgaz035 = g_qryparam.return1              #將開窗取得的值回傳到變數
            LET g_bgaz_m.bgaz035_desc = g_qryparam.return2 #說明

            DISPLAY g_bgaz_m.bgaz035 TO bgaz035              #顯示到畫面上
            DISPLAY g_bgaz_m.bgaz035_desc TO bgaz035_desc    #說明
            
            NEXT FIELD bgaz035 ]]>
  </point>
  <point name="input.c.bgaz036" order="" ver="1" cite_std="N" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[             #開窗i段
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_bgaz_m.bgaz036             #給予default值
            LET g_qryparam.default2 = "" #g_bgaz_m.glafl004 #說明

            #給予arg
            CALL q_glaf002()                                #呼叫開窗

            LET g_bgaz_m.bgaz036 = g_qryparam.return1              #將開窗取得的值回傳到變數
            LET g_bgaz_m.bgaz036_desc = g_qryparam.return2 #說明

            DISPLAY g_bgaz_m.bgaz036 TO bgaz036              #顯示到畫面上
            DISPLAY g_bgaz_m.bgaz036_desc TO bgaz036_desc    #說明
            
            NEXT FIELD bgaz036 ]]>
  </point>
  <point name="input.c.bgaz037" order="" ver="1" cite_std="N" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[             #開窗i段
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_bgaz_m.bgaz037             #給予default值
            LET g_qryparam.default2 = "" #g_bgaz_m.glafl004 #說明

            #給予arg
            CALL q_glaf002()                                #呼叫開窗

            LET g_bgaz_m.bgaz037 = g_qryparam.return1              #將開窗取得的值回傳到變數
            LET g_bgaz_m.bgaz037_desc = g_qryparam.return2 #說明

            DISPLAY g_bgaz_m.bgaz037 TO bgaz037              #顯示到畫面上
            DISPLAY g_bgaz_m.bgaz037_desc TO bgaz037_desc    #說明
            
            NEXT FIELD bgaz037 ]]>
  </point>
  <point name="input.define" order="" ver="1" cite_std="N" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[   #傳入參數
   DEFINE p_bgaw001              LIKE bgaw_t.bgaw001    #樣表編號
   DEFINE p_bgaz039              LIKE bgaz_t.bgaz039    #自定義維度控制类型 
   DEFINE p_bgaz001              LIKE bgaz_t.bgaz001    #预算编号
   DEFINE p_bgaz002              LIKE bgaz_t.bgaz002    #版本
   DEFINE p_bgaz003              LIKE bgaz_t.bgaz003    #预算组织
   DEFINE p_bgaz004              LIKE bgaz_t.bgaz004    #预算项目
   #是否启用改自由维度
   DEFINE l_flag1         LIKE type_t.chr5
   DEFINE l_flag2         LIKE type_t.chr5
   DEFINE l_flag3         LIKE type_t.chr5
   DEFINE l_flag4         LIKE type_t.chr5
   DEFINE l_flag5         LIKE type_t.chr5
   DEFINE l_flag6         LIKE type_t.chr5
   DEFINE l_flag7         LIKE type_t.chr5
   DEFINE l_flag8         LIKE type_t.chr5
   DEFINE l_flag9         LIKE type_t.chr5
   DEFINE l_flag10        LIKE type_t.chr5
   #其他定义项
   DEFINE l_bgaw005       LIKE bgaw_t.bgaw005
   DEFINE l_errno         LIKE type_t.chr80]]>
  </point>
  <point name="input.get_var" order="" ver="1" cite_std="N" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[   p_bgaw001,p_bgaz039,p_bgaz001,p_bgaz002,p_bgaz003,p_bgaz004]]>
  </point>
  <point name="input.post_input" order="" ver="1" cite_std="N" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[   IF INT_FLAG THEN
      LET INT_FLAG = FALSE
      RETURN  g_bgaz_m_t.bgaz028,g_bgaz_m_t.bgaz029,g_bgaz_m_t.bgaz030,g_bgaz_m_t.bgaz031,g_bgaz_m_t.bgaz032,
              g_bgaz_m_t.bgaz033,g_bgaz_m_t.bgaz034,g_bgaz_m_t.bgaz035,g_bgaz_m_t.bgaz036,g_bgaz_m_t.bgaz037
   END IF
      RETURN  g_bgaz_m.bgaz028,g_bgaz_m.bgaz029,g_bgaz_m.bgaz030,g_bgaz_m.bgaz031,g_bgaz_m.bgaz032,
              g_bgaz_m.bgaz033,g_bgaz_m.bgaz034,g_bgaz_m.bgaz035,g_bgaz_m.bgaz036,g_bgaz_m.bgaz037   ]]>
  </point>
  <point name="input.pre_input" order="" ver="1" cite_std="N" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[   #资料检查
   IF cl_null(p_bgaz001) OR cl_null(p_bgaz002) OR cl_null(p_bgaz003) OR cl_null(p_bgaz004)
      OR cl_null(p_bgaz039) OR cl_null(p_bgaw001) THEN
      CALL cl_err('',-400,0)
      RETURN      
   END IF    
   #初值
   INITIALIZE g_bgaz_m_t.*  TO NULL
   LET g_qryparam.where = "glaf001 = '",p_bgaz039,"'" #自由核算項類型
   #從abgi210中抓取自由維度使用否的情況
   LET l_flag1 =''   LET l_flag2 = ''
   LET l_flag3 =''   LET l_flag4 = ''
   LET l_flag5 =''   LET l_flag6 = ''
   LET l_flag7 =''   LET l_flag8 = ''
   LET l_flag9 =''   LET l_flag10 = ''

   FOR l_count = 12 TO 21
       SELECT bgaw005 INTO l_bgaw005 FROM bgaw_t
        WHERE bgawent = g_enterprise
          AND bgaw001 = p_bgaw001    #樣表編號
          AND bgaw002 = l_count
        #自定義維度一  
        IF l_count = 12   THEN
           IF l_bgaw005 = 'Y' THEN
              CALL cl_set_comp_required('bgaz028',TRUE)
           ELSE
              CALL cl_set_comp_entry('bgaw028',FALSE)           
           END IF 
        END IF 
         #自定義維度二
        IF l_count = 13   THEN
           IF l_bgaw005 = 'Y' THEN
              CALL cl_set_comp_required('bgaz029',TRUE)
           ELSE
              CALL cl_set_comp_entry('bgaw029',FALSE)           
           END IF 
        END IF 
         #自定義維度三  
        IF l_count = 14   THEN
           IF l_bgaw005 = 'Y' THEN
              CALL cl_set_comp_required('bgaz030',TRUE)
           ELSE
              CALL cl_set_comp_entry('bgaw030',FALSE)           
           END IF 
        END IF 
         #自定義維度四  
        IF l_count = 15   THEN
           IF l_bgaw005 = 'Y' THEN
              CALL cl_set_comp_required('bgaz031',TRUE)
           ELSE
              CALL cl_set_comp_entry('bgaz031',FALSE)           
           END IF 
        END IF 
         #自定義維度五  
        IF l_count = 16   THEN
           IF l_bgaw005 = 'Y' THEN
              CALL cl_set_comp_required('bgaz032',TRUE)
           ELSE
              CALL cl_set_comp_entry('bgaz032',FALSE)           
           END IF 
        END IF 
         #自定義維度六  
        IF l_count = 17   THEN
           IF l_bgaw005 = 'Y' THEN
              CALL cl_set_comp_required('bgaz033',TRUE)
           ELSE
              CALL cl_set_comp_entry('bgaz033',FALSE)           
           END IF 
        END IF 
         #自定義維度七  
        IF l_count = 18   THEN
           IF l_bgaw005 = 'Y' THEN
              CALL cl_set_comp_required('bgaz034',TRUE)
           ELSE
              CALL cl_set_comp_entry('bgaz034',FALSE)           
           END IF 
        END IF 
         #自定義維度八  
        IF l_count = 19   THEN
           IF l_bgaw005 = 'Y' THEN
              CALL cl_set_comp_required('bgaz035',TRUE)
           ELSE
              CALL cl_set_comp_entry('bgaz035',FALSE)           
           END IF 
        END IF 
         #自定義維度九 
        IF l_count = 20   THEN
           IF l_bgaw005 = 'Y' THEN
              CALL cl_set_comp_required('bgaz036',TRUE)
           ELSE
              CALL cl_set_comp_entry('bgaz036',FALSE)           
           END IF 
        END IF 
         #自定義維度十  
        IF l_count = 21   THEN
           IF l_bgaw005 = 'Y' THEN
              CALL cl_set_comp_required('bgaz037',TRUE)
           ELSE
              CALL cl_set_comp_entry('bgaz037',FALSE)           
           END IF 
        END IF      
   END FOR  
   #抓取]]>
  </point>
</add_points>
