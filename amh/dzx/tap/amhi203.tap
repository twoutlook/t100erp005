<add_points prog="amhi203" std_prog="amhi203" erpver="1.0" module="AMH" ver="1" env="s" zone="t10dev" booking="Y">
  <point name="construct.c.mhac001" cite_std="N" status="u" ver="1" src="s" new="N" order="0" cite_ver="" mark_hard="N">
<![CDATA[                        #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_mhaa001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO mhac001  #顯示到畫面上

            NEXT FIELD mhac001                     #返回原欄位

]]>
</point>
  <point name="construct.c.mhac002" cite_std="N" status="u" ver="1" src="s" new="N" order="0" cite_ver="" mark_hard="N">
<![CDATA[                        #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_mhab002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO mhac002  #顯示到畫面上

            NEXT FIELD mhac002                     #返回原欄位

]]>
</point>
  <point name="construct.c.mhacsite" cite_std="N" status="u" ver="1" src="s" new="N" order="0" cite_ver="" mark_hard="N">
<![CDATA[                        #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			LET g_qryparam.arg2 = '2'
            CALL q_ooed004()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO mhacsite  #顯示到畫面上

            NEXT FIELD mhacsite                     #返回原欄位

]]>
</point>
  <point name="construct.c.mhacunit" cite_std="N" status="" ver="1" src="s" new="N" order="0" cite_ver="" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooed004()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO mhacunit  #顯示到畫面上

            NEXT FIELD mhacunit                     #返回原欄位

]]>
</point>
  <point name="construct.c.page1.mhac003" cite_std="N" status="u" ver="1" src="s" new="N" order="0" cite_ver="" mark_hard="N">
<![CDATA[                        #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_mhac003()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO mhac003  #顯示到畫面上

            NEXT FIELD mhac003                     #返回原欄位

]]>
</point>
  <point name="construct.c.page2.mhaccrtdp" cite_std="N" status="" ver="1" src="s" new="N" order="0" cite_ver="" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooea001_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO mhaccrtdp  #顯示到畫面上

            NEXT FIELD mhaccrtdp                     #返回原欄位

]]>
</point>
  <point name="construct.c.page2.mhaccrtid" cite_std="N" status="" ver="1" src="s" new="N" order="0" cite_ver="" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooag001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO mhaccrtid  #顯示到畫面上

            NEXT FIELD mhaccrtid                     #返回原欄位

]]>
</point>
  <point name="construct.c.page2.mhacmodid" cite_std="N" status="" ver="1" src="s" new="N" order="0" cite_ver="" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooag001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO mhacmodid  #顯示到畫面上

            NEXT FIELD mhacmodid                     #返回原欄位

]]>
</point>
  <point name="construct.c.page2.mhacowndp" cite_std="N" status="" ver="1" src="s" new="N" order="0" cite_ver="" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooea001_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO mhacowndp  #顯示到畫面上

            NEXT FIELD mhacowndp                     #返回原欄位

]]>
</point>
  <point name="construct.c.page2.mhacownid" cite_std="N" status="" ver="1" src="s" new="N" order="0" cite_ver="" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooag001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO mhacownid  #顯示到畫面上

            NEXT FIELD mhacownid                     #返回原欄位

]]>
</point>
  <point name="input.a.mhac001" cite_std="N" status="u" ver="1" src="s" new="N" order="0" cite_ver="" mark_hard="N">
<![CDATA[                        #此段落由子樣板a05產生
            LET g_mhac_m.mhac001_desc = null
            DISPLAY BY NAME g_mhac_m.mhac001_desc
            IF  NOT cl_null(g_mhac_m.mhac001) AND NOT cl_null(g_mhac_m.mhac002) THEN 
               IF p_cmd = 'a' OR ( p_cmd = 'u' AND (g_mhac_m.mhac001 != g_mhac001_t  OR g_mhac_m.mhac002 != g_mhac002_t )) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM mhac_t WHERE "||"mhacent = '" ||g_enterprise|| "' AND "||"mhac001 = '"||g_mhac_m.mhac001 ||"' AND "|| "mhac002 = '"||g_mhac_m.mhac002 ||"'",'std-00004',0) THEN 
                     LET g_mhac_m.mhac001 = g_mhac_m_t.mhac001
                     CALL amhi203_mhac001_ref()
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF


            IF NOT cl_null(g_mhac_m.mhac001) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_mhac_m.mhac001
               LET g_chkparam.arg2 = g_mhac_m.mhacsite
                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_mhaa001") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 

               ELSE
                  #檢查失敗時後續處理
                  LET g_mhac_m.mhac001 = g_mhac_m_t.mhac001
                  CALL amhi203_mhac001_ref()
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
            IF NOT cl_null(g_mhac_m.mhac001) AND NOT cl_null(g_mhac_m.mhac002) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_mhac_m.mhac002
               LET g_chkparam.arg2 = g_mhac_m.mhac001

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_mhab002") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 

               ELSE
                  #檢查失敗時後續處理
                  LET g_mhac_m.mhac001 = g_mhac_m_t.mhac001
                  CALL amhi203_mhac001_ref()
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
            CALL amhi203_mhac001_ref()
]]>
</point>
  <point name="input.a.mhac002" cite_std="N" status="u" ver="1" src="s" new="N" order="0" cite_ver="" mark_hard="N">
<![CDATA[                        #此段落由子樣板a05產生
            LET g_mhac_m.mhac002_desc = null
            DISPLAY BY NAME g_mhac_m.mhac002_desc
            IF  NOT cl_null(g_mhac_m.mhac001) AND NOT cl_null(g_mhac_m.mhac002) THEN 
               IF p_cmd = 'a' OR ( p_cmd = 'u' AND (g_mhac_m.mhac001 != g_mhac001_t  OR g_mhac_m.mhac002 != g_mhac002_t )) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM mhac_t WHERE "||"mhacent = '" ||g_enterprise|| "' AND "||"mhac001 = '"||g_mhac_m.mhac001 ||"' AND "|| "mhac002 = '"||g_mhac_m.mhac002 ||"'",'std-00004',0) THEN 
                     LET g_mhac_m.mhac002 = g_mhac_m_t.mhac002
                     CALL amhi203_mhac002_ref()
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF


            IF NOT cl_null(g_mhac_m.mhac002) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_mhac_m.mhac002
               LET g_chkparam.arg2 = g_mhac_m.mhac001

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_mhab002") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 

               ELSE
                  #檢查失敗時後續處理
                  LET g_mhac_m.mhac002 = g_mhac_m_t.mhac002
                  CALL amhi203_mhac002_ref()
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
            CALL amhi203_mhac002_ref()
]]>
</point>
  <point name="input.a.mhacsite" cite_std="N" status="u" ver="1" src="s" new="N" order="0" cite_ver="" mark_hard="N">
<![CDATA[                        LET g_mhac_m.mhacsite_desc = NULL
            DISPLAY BY NAME g_mhac_m.mhacsite_desc
            IF NOT cl_null(g_mhac_m.mhacsite) THEN
            IF p_cmd = 'a' OR ( p_cmd = 'u' AND (g_mhac_m.mhacsite != g_mhac_m_t.mhacsite or g_mhac_m_t.mhacsite is null )) THEN  
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL

               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_mhac_m.mhacsite
               LET g_chkparam.arg2 = '2'
               LET g_chkparam.arg3 = g_site


               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_ooed004") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME

               ELSE
                  #檢查失敗時後續處理
                  LET g_mhac_m.mhacsite = g_mhac_m_t.mhacsite
                  CALL amhi203_mhacsite_ref()
                  NEXT FIELD CURRENT
               END IF
               IF NOT cl_null(g_mhac_m.mhac001) THEN 
                  #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
                  INITIALIZE g_chkparam.* TO NULL
               
                  #設定g_chkparam.*的參數
                  LET g_chkparam.arg1 = g_mhac_m.mhac001
                  LET g_chkparam.arg2 = g_mhac_m.mhacsite
                  
                  #呼叫檢查存在並帶值的library
                  IF cl_chk_exist("v_mhaa001") THEN 
                  ELSE
                     #檢查失敗時後續處理
                     LET g_mhac_m.mhacsite = g_mhac_m_t.mhacsite
                     CALL amhi203_mhacsite_ref()
                     NEXT FIELD CURRENT
                  END IF
               END IF 
               IF NOT cl_null(g_mhac_m.mhac001) AND NOT cl_null(g_mhac_m.mhac002) THEN 
                  #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
                  INITIALIZE g_chkparam.* TO NULL
               
                  #設定g_chkparam.*的參數
                  LET g_chkparam.arg1 = g_mhac_m.mhac002
                  LET g_chkparam.arg2 = g_mhac_m.mhac001 
                  #呼叫檢查存在並帶值的library
                  IF cl_chk_exist("v_mhab002") THEN

                  ELSE
                     #檢查失敗時後續處理
                     LET g_mhac_m.mhacsite = g_mhac_m_t.mhacsite
                     CALL amhi203_mhacsite_ref()
                     NEXT FIELD CURRENT
                  END IF
               END IF 
            END IF
            end if
            CALL amhi203_mhacsite_ref()
]]>
</point>
  <point name="input.a.mhacunit" cite_std="N" status="" ver="1" src="s" new="N" order="0" cite_ver="" mark_hard="N">
<![CDATA[            LET g_mhac_m.mhacunit_desc = null
            DISPLAY BY NAME g_mhac_m.mhacunit_desc
            IF NOT cl_null(g_mhac_m.mhacunit) THEN
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL

               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_mhac_m.mhacunit
               LET g_chkparam.arg2 = '2'
               LET g_chkparam.arg3 = g_site


               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_ooed004") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME

               ELSE
                  #檢查失敗時後續處理
                  LET g_mhac_m.mhacunit = g_mhac_m_t.mhacunit
                  CALL amhi203_mhacunit_ref()
                  NEXT FIELD CURRENT
               END IF
            end if
            CALL amhi203_mhacunit_ref()
]]>
</point>
  <point name="input.a.page1.mhac003" cite_std="N" status="u" ver="1" src="s" new="N" order="0" cite_ver="" mark_hard="N">
<![CDATA[                        #此段落由子樣板a05產生
            IF  g_mhac_m.mhac001 IS NOT NULL AND g_mhac_m.mhac002 IS NOT NULL AND g_mhac_d[g_detail_idx].mhac003 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_mhac_m.mhac001 != g_mhac001_t OR g_mhac_m.mhac002 != g_mhac002_t OR g_mhac_d[g_detail_idx].mhac003 != g_mhac_d_t.mhac003)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM mhac_t WHERE "||"mhacent = '" ||g_enterprise|| "' AND "||"mhac001 = '"||g_mhac_m.mhac001 ||"' AND "|| "mhac002 = '"||g_mhac_m.mhac002 ||"' AND "|| "mhac003 = '"||g_mhac_d[g_detail_idx].mhac003 ||"'",'std-00004',0) THEN 
                     let g_mhac_d[l_ac].mhac003 = g_mhac_d_t.mhac003
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
</point>
  <point name="input.a.page2.mhac003_2" cite_std="N" status="" ver="1" src="s" new="N" order="0" cite_ver="" mark_hard="N">
<![CDATA[            #此段落由子樣板a05產生
            IF  g_mhac_m.mhac001 IS NOT NULL AND g_mhac_m.mhac002 IS NOT NULL AND g_mhac2_d[g_detail_idx].mhac003 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_mhac_m.mhac001 != g_mhac001_t OR g_mhac_m.mhac002 != g_mhac002_t OR g_mhac2_d[g_detail_idx].mhac003 != g_mhac2_d_t.mhac003)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM mhac_t WHERE "||"mhacent = '" ||g_enterprise|| "' AND "||"mhac001 = '"||g_mhac_m.mhac001 ||"' AND "|| "mhac002 = '"||g_mhac_m.mhac002 ||"' AND "|| "mhac003 = '"||g_mhac2_d[g_detail_idx].mhac003 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
</point>
  <point name="input.c.mhac001" cite_std="N" status="u" ver="1" src="s" new="N" order="0" cite_ver="" mark_hard="N">
<![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_mhac_m.mhac001             #給予default值
            LET g_qryparam.where = " mhaasite='",g_mhac_m.mhacsite,"'"
            #給予arg

            CALL q_mhaa001()                                #呼叫開窗

            LET g_mhac_m.mhac001 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_mhac_m.mhac001 TO mhac001              #顯示到畫面上
            CALL amhi203_mhac001_ref() 
            NEXT FIELD mhac001                          #返回原欄位

]]>
</point>
  <point name="input.c.mhac002" cite_std="N" status="u" ver="1" src="s" new="N" order="0" cite_ver="" mark_hard="N">
<![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_mhac_m.mhac002             #給予default值
            LET g_qryparam.where = "mhab001='",g_mhac_m.mhac001,"' "
            #給予arg

            CALL q_mhab002()                                #呼叫開窗

            LET g_mhac_m.mhac002 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_mhac_m.mhac002 TO mhac002              #顯示到畫面上
            CALL amhi203_mhac002_ref() 
            NEXT FIELD mhac002                          #返回原欄位

]]>
</point>
  <point name="input.c.mhacsite" cite_std="N" status="u" ver="1" src="s" new="N" order="0" cite_ver="" mark_hard="N">
<![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_mhac_m.mhacsite             #給予default值

            #給予arg
            LET g_qryparam.arg1 = g_site #
            LET g_qryparam.arg2 = "2" #

            CALL q_ooed004()                                #呼叫開窗

            LET g_mhac_m.mhacsite = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_mhac_m.mhacsite TO mhacsite              #顯示到畫面上
            CALL amhi203_mhacsite_ref() 
            NEXT FIELD mhacsite                          #返回原欄位

]]>
</point>
  <point name="input.c.mhacunit" cite_std="N" status="" ver="1" src="s" new="N" order="0" cite_ver="" mark_hard="N">
<![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_mhac_m.mhacunit             #給予default值

            #給予arg
            LET g_qryparam.arg1 = g_site #
            LET g_qryparam.arg2 = "2" #

            CALL q_ooed004()                                #呼叫開窗

            LET g_mhac_m.mhacunit = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_mhac_m.mhacunit TO mhacunit              #顯示到畫面上
            CALL amhi203_mhacunit_ref() 
            NEXT FIELD mhacunit                          #返回原欄位

]]>
</point>
  <point name="ref_show.body.reference" cite_std="N" status="u" ver="1" src="s" new="N" order="0" cite_ver="" mark_hard="N">
<![CDATA[         INITIALIZE g_ref_fields TO NULL 
   LET g_ref_fields[1] = g_mhac_m.mhac001
   LET g_ref_fields[2] = g_mhac_m.mhac002
   LET g_ref_fields[3] = g_mhac_d[l_ac].mhac003
   CALL ap_ref_array2(g_ref_fields," SELECT mhacl005 FROM mhacl_t WHERE mhaclent = '"||g_enterprise||"' AND mhacl001 = ? AND mhacl002 = ? AND mhacl003 = ? AND mhacl004 = '"||g_dlang||"'","") RETURNING g_rtn_fields 
   LET g_mhac_d[l_ac].mhacl005 = g_rtn_fields[1] 
   DISPLAY BY NAME g_mhac_d[l_ac].mhacl005
   
      INITIALIZE g_ref_fields TO NULL 
      LET g_ref_fields[1] = g_mhac_m.mhac001
      LET g_ref_fields[2] = g_mhac_m.mhac002
      LET g_ref_fields[3] = g_mhac_d[l_ac].mhac003
      CALL ap_ref_array2(g_ref_fields," SELECT mhacl006 FROM mhacl_t WHERE mhaclent = '"||g_enterprise||"' AND mhacl001 = ? AND mhacl002 = ? AND mhacl003 = ? AND mhacl004 = '"||g_dlang||"'","") RETURNING g_rtn_fields 
      LET g_mhac_d[l_ac].mhacl006 = g_rtn_fields[1] 
      DISPLAY BY NAME g_mhac_d[l_ac].mhacl006
      call amhi203_mhacunit_ref()]]>
</point>
  <point name="ref_show.body2.reference" cite_std="N" status="u" ver="1" src="s" new="N" order="0" cite_ver="" mark_hard="N">
<![CDATA[                  INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_mhac2_d[l_ac].mhacownid
            CALL ap_ref_array2(g_ref_fields,"SELECT oofa011 FROM oofa_t WHERE oofaent='"||g_enterprise||"' AND oofa002='2' AND oofa003=? ","") RETURNING g_rtn_fields
            LET g_mhac2_d[l_ac].mhacownid_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_mhac2_d[l_ac].mhacownid_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_mhac2_d[l_ac].mhacowndp
            CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_mhac2_d[l_ac].mhacowndp_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_mhac2_d[l_ac].mhacowndp_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_mhac2_d[l_ac].mhaccrtid
            CALL ap_ref_array2(g_ref_fields,"SELECT oofa011 FROM oofa_t WHERE oofaent='"||g_enterprise||"' AND oofa002='2' AND oofa003=? ","") RETURNING g_rtn_fields
            LET g_mhac2_d[l_ac].mhaccrtid_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_mhac2_d[l_ac].mhaccrtid_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_mhac2_d[l_ac].mhaccrtdp
            CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_mhac2_d[l_ac].mhaccrtdp_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_mhac2_d[l_ac].mhaccrtdp_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_mhac2_d[l_ac].mhacmodid
            CALL ap_ref_array2(g_ref_fields,"SELECT oofa011 FROM oofa_t WHERE oofaent='"||g_enterprise||"' AND oofa002='2' AND oofa003=? ","") RETURNING g_rtn_fields
            LET g_mhac2_d[l_ac].mhacmodid_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_mhac2_d[l_ac].mhacmodid_desc
]]>
</point>
  <point name="ref_show.head.reference" cite_std="N" status="u" ver="1" src="s" new="N" order="0" cite_ver="" mark_hard="N">
<![CDATA[               

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_mhac_m.mhacsite
            CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_mhac_m.mhacsite_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_mhac_m.mhacsite_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_mhac_m.mhac001
            CALL ap_ref_array2(g_ref_fields,"SELECT mhaal003 FROM mhaal_t WHERE mhaalent='"||g_enterprise||"' AND mhaal001=? AND mhaal002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_mhac_m.mhac001_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_mhac_m.mhac001_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_mhac_m.mhac001
            LET g_ref_fields[2] = g_mhac_m.mhac002
            CALL ap_ref_array2(g_ref_fields,"SELECT mhabl004 FROM mhabl_t WHERE mhablent='"||g_enterprise||"' AND mhabl001=? AND mhabl002=? AND mhabl003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_mhac_m.mhac002_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_mhac_m.mhac002_desc
]]>
</point>
  <point name="function.amhi203_mhacunit_ref" cite_std="N" status="" ver="1" src="s" new="Y" order="1" cite_ver="" mark_hard="N">
<![CDATA[#display mhacunit
PRIVATE FUNCTION amhi203_mhacunit_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_mhac_d[l_ac].mhacunit
   CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_mhac_d[l_ac].mhacunit_desc = '', g_rtn_fields[1] , ''
   DISPLAY   g_mhac_d[l_ac].mhacunit_desc to s_detail1[l_ac].mhacunit_desc
END FUNCTION]]>
</point>
  <point name="function.amhi203_mhacsite_ref" cite_std="N" status="" ver="1" src="s" new="Y" order="2" cite_ver="" mark_hard="N">
<![CDATA[#display mhacsite
PRIVATE FUNCTION amhi203_mhacsite_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_mhac_m.mhacsite
   CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_mhac_m.mhacsite_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_mhac_m.mhacsite_desc
END FUNCTION]]>
</point>
  <point name="function.amhi203_mhac001_ref" cite_std="N" status="" ver="1" src="s" new="Y" order="3" cite_ver="" mark_hard="N">
<![CDATA[#display mhac001
PRIVATE FUNCTION amhi203_mhac001_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_mhac_m.mhac001
   CALL ap_ref_array2(g_ref_fields,"SELECT mhaal003 FROM mhaal_t WHERE mhaalent='"||g_enterprise||"' AND mhaal001=? AND mhaal002='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_mhac_m.mhac001_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_mhac_m.mhac001_desc
END FUNCTION]]>
</point>
  <point name="function.amhi203_mhac002_ref" cite_std="N" status="" ver="1" src="s" new="Y" order="4" cite_ver="" mark_hard="N">
<![CDATA[#display mhac002
PRIVATE FUNCTION amhi203_mhac002_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_mhac_m.mhac001
   LET g_ref_fields[2] = g_mhac_m.mhac002
   CALL ap_ref_array2(g_ref_fields,"SELECT mhabl004 FROM mhabl_t WHERE mhablent='"||g_enterprise||"' AND mhabl001=? AND mhabl002=? AND mhabl003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_mhac_m.mhac002_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_mhac_m.mhac002_desc
END FUNCTION]]>
</point>
  <point name="function.amhi203_chk_mhacstus" cite_std="N" status="" ver="1" src="s" new="Y" order="5" cite_ver="" mark_hard="N">
<![CDATA[#chk mhacstus
PRIVATE FUNCTION amhi203_chk_mhacstus()
   DEFINE  l_cnt   LIKE type_t.num5
   DEFINE  l_cnt1  LIKE type_t.num5
   DEFINE  l_success  LIKE type_t.num5
   DEFINE  l_errno    STRING
   LET l_cnt = 0
   LET l_cnt1 = 0
   LET l_success = TRUE
   LET l_errno = NULL
   IF g_mhac_d[l_ac].mhacstus='N' THEN
      
         SELECT count(*) INTO l_cnt1 FROM mhad_t WHERE mhadent = g_enterprise
            AND mhad001 = g_mhac_m.mhac001 AND mhad002 = g_mhac_m.mhac002
            AND mhad003 = g_mhac_d_t.mhac003 
            AND mhadstus = 'Y'
         IF l_cnt1<=0 THEN
            RETURN l_success,l_errno
         ELSE
            IF cl_ask_confirm('amh-00016') THEN
               LET l_success = TRUE
               RETURN l_success,l_errno
            ELSE
               LET l_success = FALSE
               RETURN l_success,l_errno
            END IF
         END IF         
            
   END IF 
#   IF g_mhac_d[l_ac].mhacstus='N' THEN
#      SELECT sum(mhad005),sum(mhad006),sum(mhad007) 
#         INTO l_mhad005,l_mhad006,l_mhad007
#        FROM mhad_t
#       WHERE mhadent = g_enterprise AND mhad001=g_mhac_m.mhac001
#         AND mhad002 = g_mhac_d[l_ac].mhac002
#      LET l_mhac003=l_mhad005+ g_mhac_d[l_ac].mhac003
#      LET l_mhac004=l_mhad006+ g_mhac_d[l_ac].mhac004
#      LET l_mhac005=l_mhad007+ g_mhac_d[l_ac].mhac005
#      IF l_mhac005> g_mhac_d[l_ac].mhac006 THEN
#         LET l_errno = "amh-00009"
#         LET l_success = FALSE
#         RETURN l_success,l_errno
#      END IF
#      IF l_mhac006> g_mhac_d[l_ac].mhac007 THEN
#         LET l_errno = "amh-00010"
#         LET l_success = FALSE
#         RETURN l_success,l_errno
#      END IF      
#   END IF 
      
   RETURN l_success,l_errno
END FUNCTION]]>
</point>
  <point name="function.amhi203_mhacstus" cite_std="N" status="" ver="1" src="s" new="Y" order="6" cite_ver="" mark_hard="N">
<![CDATA[#chk mhacstus
PRIVATE FUNCTION amhi203_mhacstus()
   DEFINE  l_cnt   like type_t.num5
   DEFINE  l_cnt1  LIKE type_t.num5
   DEFINE  l_success  LIKE type_t.num5
   DEFINE  l_errno    STRING
   DEFINE  l_mhad005 LIKE mhad_t.mhad005
   DEFINE  l_mhad006 LIKE mhad_t.mhad006
   DEFINE  l_mhad007 LIKE mhad_t.mhad007
   DEFINE  l_mhab006 LIKE mhab_t.mhab006
   DEFINE  l_mhab007 LIKE mhab_t.mhab007
   DEFINE  l_mhac004_1 LIKE mhac_t.mhac004
   DEFINE  l_mhac005_1 LIKE mhac_t.mhac005
   DEFINE  l_mhac006_1 LIKE mhac_t.mhac006
   
   DEFINE  l_mhac004 LIKE mhac_t.mhac004
   DEFINE  l_mhac005 LIKE mhac_t.mhac005
   DEFINE  l_mhac006 LIKE mhac_t.mhac006

   LET l_cnt = 0
   LET l_cnt1 = 0
   LET l_success = TRUE
   LET l_errno = NULL
   IF g_mhac_d[l_ac].mhacstus='Y' THEN
      LET l_cnt=0
      LET l_cnt1=0
      SELECT count(*) INTO l_cnt FROM mhab_t WHERE mhab001=g_mhac_m.mhac001
         AND mhab002 = g_mhac_m.mhac002 AND mhabent = g_enterprise 
         AND mhabsite = g_mhac_m.mhacsite AND mhabstus='Y'
      IF l_cnt<=0 THEN
         LET l_errno = "amh-00018"
         LET l_success = FALSE
         RETURN l_success,l_errno
      END IF 
      SELECT sum(mhad005),sum(mhad006),sum(mhad007) 
         INTO l_mhad005,l_mhad006,l_mhad007
        FROM mhad_t
       WHERE mhadent = g_enterprise AND mhad001=g_mhac_m.mhac001
         AND mhad002 = g_mhac_m.mhac002   AND mhadstus='Y'
      SELECT sum(mhac004),sum(mhac005),sum(mhac006)
        INTO l_mhac004,l_mhac005,l_mhac006
        FROM mhac_t
       WHERE mhac001 = g_mhac_m.mhac001 AND mhac002 = g_mhac_m.mhac002
         AND mhacstus = 'Y' AND mhacent = g_enterprise
      select sum(mhab006),sum(mhab007)
        into l_mhab006,l_mhab007
        from mhab_t where  mhab001 = g_mhac_m.mhac001 AND mhab002 = g_mhac_m.mhac002
         AND mhabstus = 'Y' AND mhabent = g_enterprise 
            
      IF cl_null(l_mhad005) THEN
         LET l_mhad005 = 0
      END IF
      IF cl_null(l_mhad006) THEN
         LET l_mhad006 = 0
      END IF
      IF cl_null(l_mhad007) THEN
         LET l_mhad007 = 0
      END IF
      IF cl_null(l_mhac004) THEN
         LET l_mhac004 = 0
      END IF
      IF cl_null(l_mhac005) THEN
         LET l_mhac005 = 0
      END IF
      IF cl_null(l_mhac006) THEN
         LET l_mhac006 = 0
      END IF
      let l_mhac004_1=g_mhac_d[l_ac].mhac004
      let l_mhac005_1=g_mhac_d[l_ac].mhac005
      let l_mhac006_1=g_mhac_d[l_ac].mhac006
      IF cl_null(l_mhac004_1) THEN
         LET l_mhac004_1 = 0
      END IF
      IF cl_null(l_mhac005_1) THEN
         LET l_mhac005_1 = 0
      END IF
      IF cl_null(l_mhac006_1) THEN
         LET l_mhac006_1 = 0
      END IF      
      LET l_mhac006=l_mhac006+l_mhac006_1
      LET l_mhac004=l_mhac004+l_mhac004_1
      LET l_mhac005=l_mhac005+l_mhac005_1
      
      IF l_mhac004> l_mhad005 THEN
         LET l_errno = "amh-00020"
         LET l_success = FALSE
         RETURN l_success,l_errno
      END IF
      IF not cl_null(l_mhab006) THEN
         IF l_mhac004> l_mhab006 THEN
            LET l_errno = "amh-00009"
            LET l_success = FALSE
            RETURN l_success,l_errno
         END IF
      end if   
      IF l_mhac005> l_mhad006 THEN
         LET l_errno = "amh-00021"
         LET l_success = FALSE
         RETURN l_success,l_errno
      END IF
      IF cl_null(l_mhab007) THEN
         IF l_mhac005> l_mhab007 THEN
            LET l_errno = "amh-00010"
            LET l_success = FALSE
            RETURN l_success,l_errno
         END IF
      end if   
      IF l_mhac006> l_mhad007 THEN
         LET l_errno = "amh-00022"
         LET l_success = FALSE
         RETURN l_success,l_errno
      END IF
            
   END IF
   RETURN l_success,l_errno
END FUNCTION]]>
</point>
  <point name="b_fill.fill" cite_std="N" status="u" ver="1" src="s" new="N" order="" cite_ver="" mark_hard="N">
<![CDATA[                  let g_mhac2_d[l_ac].mhac003 = g_mhac_d[l_ac].mhac003]]>
</point>
  <point name="construct.c.page1.mhacunit" cite_std="N" status="u" ver="1" src="s" new="N" order="" cite_ver="" mark_hard="N">
<![CDATA[                        #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			LET g_qryparam.arg2 = '2'
            CALL q_ooed004()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO mhacunit  #顯示到畫面上

            NEXT FIELD mhacunit                     #返回原欄位

]]>
</point>
  <point name="delete.body.a_single_delete" cite_std="N" status="u" ver="1" src="s" new="N" order="" cite_ver="" mark_hard="N">
<![CDATA[      DELETE FROM mhacl_t
    WHERE mhaclent = g_enterprise AND mhacl001 = g_mhac_m.mhac001 AND
                              mhacl002 = g_mhac_m.mhac002 AND


          mhacl003 = g_mhac_d_t.mhac003
   IF SQLCA.sqlcode THEN
      CALL cl_err("mhacl_t",SQLCA.sqlcode,1)
      RETURN FALSE 
   END IF
   SELECT count(*) INTO l_cnt FROM mhad_t
    WHERE mhadent = g_enterprise AND mhad001=g_mhac_m.mhac001
      AND mhad002 = g_mhac_m.mhac002 AND mhad003 = g_mhac_d_t.mhac003 AND mhadsite = g_mhac_m.mhacsite
   IF l_cnt>0 THEN
      CALL amhi203_update_ooef() RETURNING l_success
      IF l_success=false THEN
         CALL s_transaction_end('N','0')
         RETURN
      END IF
   END IF   ]]>
</point>
  <point name="delete.body.b_delete" cite_std="N" status="u" ver="1" src="s" new="N" order="" cite_ver="" mark_hard="N">
<![CDATA[            select count(*) into l_cnt from mhad_t where mhadent = g_enterprise and mhad001 = g_mhac_m.mhac001
         and mhad002 = g_mhac_m.mhac002
      if l_cnt >0 then
         call cl_err("mhad_t","amh-00014",1)
         return
      end if
      DELETE FROM mhacl_t WHERE mhaclent = g_enterprise AND mhacl001 = g_mhac_m.mhac001
                                                               AND mhacl002 = g_mhac_m.mhac002
      IF SQLCA.sqlcode THEN
         CALL cl_err("mhac_t",SQLCA.sqlcode,0)
         CALL s_transaction_end('N','0')
      END IF
      select count(*) into l_cnt from mhad_t where mhadent = g_enterprise and mhad001 = g_mhac_m.mhac001
         and mhad002 = g_mhac_m.mhac002
      IF l_cnt >0 THEN
         CALL amhi203_update_ooef() RETURNING l_success
         IF l_success=false THEN
            CALL s_transaction_end('N','0')
            RETURN
         END IF
      END IF
            ]]>
</point>
  <point name="delete.define" cite_std="N" status="u" ver="1" src="s" new="N" order="" cite_ver="" mark_hard="N">
<![CDATA[      DEFINE  l_cnt           LIKE type_t.num5
   DEFINE  l_success       LIKE type_t.num5]]>
</point>
  <point name="global.variable" cite_std="N" status="" ver="1" src="s" new="N" order="" cite_ver="" mark_hard="N">
<![CDATA[DEFINE g_i                   LIKE type_t.num5
DEFINE g_mhad005             LIKE mhad_t.mhad005
DEFINE g_mhad006             LIKE mhad_t.mhad006
DEFINE g_mhad007             LIKE mhad_t.mhad007]]>
</point>
  <point name="input.a.page1.mhac004" cite_std="N" status="u" ver="1" src="s" new="N" order="" cite_ver="" mark_hard="N">
<![CDATA[                        IF NOT cl_null(g_mhac_d[l_ac].mhac004) THEN 
            END IF 
]]>
</point>
  <point name="input.a.page1.mhac005" cite_std="N" status="u" ver="1" src="s" new="N" order="" cite_ver="" mark_hard="N">
<![CDATA[                        IF NOT cl_null(g_mhac_d[l_ac].mhac005) THEN 
            END IF 
]]>
</point>
  <point name="input.a.page1.mhac006" cite_std="N" status="u" ver="1" src="s" new="N" order="" cite_ver="" mark_hard="N">
<![CDATA[                        IF NOT cl_null(g_mhac_d[l_ac].mhac006) THEN 
            END IF 
]]>
</point>
  <point name="input.a.page1.mhacstus" cite_std="N" status="u" ver="1" src="s" new="N" order="" cite_ver="" mark_hard="N">
<![CDATA[                        IF  g_mhac_d[l_ac].mhacstus IS NOT NULL THEN 
               IF l_cmd='a' or ( l_cmd = 'u' AND (g_mhac_d[l_ac].mhacstus != g_mhac_d_t.mhacstus OR g_mhac_d_t.mhacstus IS NULL )) THEN 
                  CALL amhi203_chk_mhacstus()
                  RETURNING g_success,g_errno
                  IF g_success THEN
                     LET g_i = TRUE
                  ELSE
                     LET g_i = FALSE
                     LET g_mhac_d[l_ac].mhacstus = g_mhac_d_t.mhacstus
                     NEXT FIELD mhacstus                      
                  END IF
                  CALL amhi203_mhacstus()
                  RETURNING g_success,g_errno
                  IF g_success THEN

                  ELSE
                     call cl_err(g_mhac_d[l_ac].mhacstus,g_errno,1)
                     LET g_mhac_d[l_ac].mhacstus = g_mhac_d_t.mhacstus
                     NEXT FIELD mhacstus                      
                  END IF
               END IF
            END IF]]>
</point>
  <point name="input.a.page1.mhacunit" cite_std="N" status="u" ver="1" src="s" new="N" order="" cite_ver="" mark_hard="N">
<![CDATA[                        LET g_mhac_d[l_ac].mhacunit_desc = null
            DISPLAY  g_mhac_d[l_ac].mhacunit_desc to s_detail1[l_ac].mhacunit_desc
            IF NOT cl_null(g_mhac_d[l_ac].mhacunit) THEN
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺
               INITIALIZE g_chkparam.* TO NULL

               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_mhac_d[l_ac].mhacunit
               LET g_chkparam.arg2 = '2'
               LET g_chkparam.arg3 = g_site


               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_ooed004") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME

               ELSE
                  #檢查失敗時後續處理
                  LET g_mhac_d[l_ac].mhacunit = g_mhac_d_t.mhacunit
                  CALL amhi203_mhacunit_ref()
                  NEXT FIELD CURRENT
               END IF
            end if
            CALL amhi203_mhacunit_ref()
            ]]>
</point>
  <point name="input.body.b_delete" cite_std="N" status="u" ver="1" src="s" new="N" order="" cite_ver="" mark_hard="N">
<![CDATA[                              select count(*) into l_cnt1 from mhad_t where mhadent = g_enterprise and mhad001 = g_mhac_m.mhac001
                  and mhad002 = g_mhac_m.mhac002 and mhad003=g_mhac_d_t.mhac003
               if l_cnt1 >0 then
                  call cl_err("mhac_t","amh-00014",1)
                  CANCEL DELETE
               end if]]>
</point>
  <point name="input.body.b_update" cite_std="N" status="u" ver="1" src="s" new="N" order="" cite_ver="" mark_hard="N">
<![CDATA[                              IF g_mhac_d[l_ac].mhacstus <> g_mhac_d_t.mhacstus AND g_mhac_d_t.mhacstus='Y' AND g_i=true THEN
                  UPDATE mhad_t SET mhadstus = g_mhac_d[l_ac].mhacstus
                   WHERE mhadent = g_enterprise AND mhad001=g_mhac_m.mhac001
                     AND mhad002 = g_mhac_m.mhac002  AND mhad003 = g_mhac_d_t.mhac003
                     and mhadsite = g_mhac_m.mhacsite
                  IF SQLCA.sqlcode THEN
                     CALL cl_err("mhac_t",SQLCA.sqlcode,1)
                     CALL s_transaction_end('N','0')
                     RETURN
                  END IF
                  
                  select sum(mhad005),sum(mhad006),sum(mhad007) 
                    into g_mhad005,g_mhad006,g_mhad007
                    from mhad_t
                   where mhadent = g_enterprise AND mhad001=g_mhac_m.mhac001
                     and mhadstus='Y' and mhadsite = g_mhac_m.mhacsite 
                     
                  update mhaa_t set mhaa002=g_mhad005,mhaa003 = g_mhad006,mhaa004 = g_mhad007
                   where mhaaent = g_enterprise AND mhaa001=g_mhac_m.mhac001
                     and mhaasite = g_mhac_m.mhacsite                 
                  IF SQLCA.sqlcode THEN
                     CALL cl_err("mhac_t",SQLCA.sqlcode,1)
                     CALL s_transaction_end('N','0')
                     RETURN
                  END IF
                  select sum(mhad005),sum(mhad006),sum(mhad007) 
                    into g_mhad005,g_mhad006,g_mhad007
                    from mhad_t
                   where mhadent = g_enterprise AND mhad001=g_mhac_m.mhac001
                     and mhad002 = g_mhac_m.mhac002
                     and mhadstus='Y' and mhadsite = g_mhac_m.mhacsite 
                  update mhab_t set mhab003=g_mhad005,mhab004 = g_mhad006,mhab005 = g_mhad007
                   where mhabent = g_enterprise AND mhab001=g_mhac_m.mhac001
                     and mhab002 = g_mhac_m.mhac002 
                     and mhabsite = g_mhac_m.mhacsite                 
                  
                  IF SQLCA.sqlcode THEN
                     CALL cl_err("mhab_t",SQLCA.sqlcode,1)
                     CALL s_transaction_end('N','0')
                     RETURN
                  END IF
                  SELECT count(*) INTO l_cnt FROM mhad_t
                   WHERE mhadent = g_enterprise AND mhad001=g_mhac_m.mhac001
                     AND mhad002 = g_mhac_m.mhac002 AND mhad003 = g_mhac_d_t.mhac003 AND mhadsite = g_mhac_m.mhacsite
                  IF l_cnt>0 THEN
                     CALL amhi203_update_ooef() RETURNING l_success
                     IF l_success=false THEN
                        CALL s_transaction_end('N','0')
                        RETURN
                     END IF
                  END IF
               END IF  
               select sum(mhad005),sum(mhad006),sum(mhad007) 
                 into g_mhac_d[l_ac].mhac004,g_mhac_d[l_ac].mhac005,g_mhac_d[l_ac].mhac006
                 from mhad_t
                where mhadent = g_enterprise AND mhad001=g_mhac_m.mhac001
                  and mhad002 = g_mhac_m.mhac002 and mhad003 = g_mhac_d_t.mhac003 and mhadstus='Y' and mhadsite = g_mhac_m.mhacsite
               IF SQLCA.sqlcode THEN
                  CALL cl_err("mhac_t",SQLCA.sqlcode,1)
                  CALL s_transaction_end('N','0')
                  RETURN
               END IF
                              ]]>
</point>
  <point name="input.body.before_insert" cite_std="N" status="u" ver="1" src="s" new="N" order="" cite_ver="" mark_hard="N">
<![CDATA[                        LET g_mhac_d[l_ac].mhacunit = g_site
            CALL amhi203_mhacunit_ref()
            SELECT count(*) INTO l_cnt FROM mhab_t WHERE mhab001=g_mhac_m.mhac001
               AND mhab002 = g_mhac_m.mhac002 AND mhabent = g_enterprise 
               AND mhabsite = g_mhac_m.mhacsite AND mhabstus='Y'
            IF l_cnt<=0 THEN
               LET g_mhac_d[l_ac].mhacstus = "N"
            END IF
            LET g_mhac_d_t.mhacstus=g_mhac_d[l_ac].mhacstus]]>
</point>
  <point name="input.c.page1.mhacunit" cite_std="N" status="u" ver="1" src="s" new="N" order="" cite_ver="" mark_hard="N">
<![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_mhac_d[l_ac].mhacunit             #給予default值

            #給予arg
            LET g_qryparam.arg1 = g_site #
            LET g_qryparam.arg2 = "2" #

            CALL q_ooed004()                                #呼叫開窗

            LET g_mhac_d[l_ac].mhacunit = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_mhac_d[l_ac].mhacunit TO mhacunit              #顯示到畫面上
            call amhi203_mhacunit_ref()
            NEXT FIELD mhacunit                          #返回原欄位

]]>
</point>
  <point name="input.define" cite_std="N" status="u" ver="1" src="s" new="N" order="" cite_ver="" mark_hard="N">
<![CDATA[      DEFINE  l_cnt1                LIKE type_t.num5
   DEFINE  l_success             LIKE type_t.num5]]>
</point>
  <point name="input.detail_input.page1.update_item" cite_std="N" status="u" ver="1" src="s" new="N" order="" cite_ver="" mark_hard="N">
<![CDATA[                        LET g_action_choice="update_item"
            IF cl_auth_chk_act("update_item") THEN
               #add-point:ON ACTION update_item
               IF NOT cl_null(g_mhac_d[l_ac].mhac003)  THEN
                  CALL n_mhacl(g_mhac_m.mhac001,g_mhac_m.mhac002,g_mhac_d[l_ac].mhac003)
                  INITIALIZE g_ref_fields TO NULL
                  LET g_ref_fields[1] = g_mhac_m.mhac001
                  LET g_ref_fields[2] = g_mhac_m.mhac002
                  LET g_ref_fields[3] = g_mhac_d[l_ac].mhac003

                  CALL ap_ref_array2(g_ref_fields," SELECT mhacl005,mhacl006 FROM mhacl_t WHERE mhaclent = '"
                      ||g_enterprise||"' AND mhacl001 = ?  AND mhacl002 = ?  AND mhacl003 = ? AND mhacl004 = '"||g_dlang||"'","") RETURNING g_rtn_fields
                  LET g_mhac_d[l_ac].mhacl005 = g_rtn_fields[1]
                  LET g_mhac_d[l_ac].mhacl006 = g_rtn_fields[2]

                  DISPLAY BY NAME g_mhac_d[l_ac].mhacl005
                  DISPLAY BY NAME g_mhac_d[l_ac].mhacl006
               END IF
            END IF]]>
</point>
  <point name="input.head.b_input" cite_std="N" status="u" ver="1" src="s" new="N" order="" cite_ver="" mark_hard="N">
<![CDATA[                        IF l_cmd_t = 'r' THEN
            else
               CALL amhi203_set_entry(p_cmd)
               CALL amhi203_set_no_entry(p_cmd)            
            END IF]]>
</point>
  <point name="insert.default" cite_std="N" status="u" ver="1" src="s" new="N" order="" cite_ver="" mark_hard="N">
<![CDATA[            LET g_mhac_m.mhacsite = g_site
      CALL amhi203_mhacsite_ref()
      LET g_mhac_m_t.* = g_mhac_m.*]]>
</point>
  <point name="reproduce.head.b_input" cite_std="N" status="u" ver="1" src="s" new="N" order="" cite_ver="" mark_hard="N">
<![CDATA[      LET g_mhac_m.mhac001_desc = ""
   LET g_mhac_m.mhac002_desc = ""
   DISPLAY BY NAME g_mhac_m.mhac001_desc,g_mhac_m.mhac002_desc]]>
</point>
  <point name="global.memo" cite_std="N" status="" ver="" src="" new="Y" order="">
<![CDATA[]]>
</point>
  <point name="global.import" cite_std="N" status="" ver="" src="" new="Y" order="">
<![CDATA[]]>
</point>
  <point name="global.argv" cite_std="N" status="" ver="" src="" new="Y" order="">
<![CDATA[]]>
</point>
  <point name="main.define" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[   ]]>
</point>
  <point name="main.init" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[   ]]>
</point>
  <point name="main.define_sql" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[   ]]>
</point>
  <point name="main.after_define_sql" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[   ]]>
</point>
  <point name="main.servicecall" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[      ]]>
</point>
  <point name="main.before_close" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[      ]]>
</point>
  <point name="main.exit" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[   ]]>
</point>
  <point name="init.define" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[   ]]>
</point>
  <point name="init.init" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[   ]]>
</point>
  <point name="ui_dialog.define" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[   ]]>
</point>
  <point name="ui_dialog.before_dialog" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[   ]]>
</point>
  <point name="ui_dialog.body.before_row" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[               ]]>
</point>
  <point name="ui_dialog.page1.action" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[            ]]>
</point>
  <point name="ui_dialog.body2.before_row" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[               ]]>
</point>
  <point name="ui_dialog.body2.action" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[            ]]>
</point>
  <point name="ui_dialog.more_displayarray" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[         ]]>
</point>
  <point name="ui_dialog.before_dialog2" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[            ]]>
</point>
  <point name="menu.delete" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[               ]]>
</point>
  <point name="menu.insert" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[               ]]>
</point>
  <point name="menu.modify" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[               ]]>
</point>
  <point name="menu.modify_detail" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[               ]]>
</point>
  <point name="menu.output" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[               ]]>
</point>
  <point name="menu.query" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[               ]]>
</point>
  <point name="menu.reproduce" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[               ]]>
</point>
  <point name="browser_search.define" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[   ]]>
</point>
  <point name="browser_fill.define" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[   ]]>
</point>
  <point name="browser_fill.before_browser_fill" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[   ]]>
</point>
  <point name="browser_fill.before_count" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[   ]]>
</point>
  <point name="browser_fill.reference" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[      ]]>
</point>
  <point name="ui_headershow.define" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[   ]]>
</point>
  <point name="ui_detailshow.define" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[   ]]>
</point>
  <point name="ui_detailshow.before" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[   ]]>
</point>
  <point name="ui_detailshow.more" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[      ]]>
</point>
  <point name="ui_detailshow.after" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[   ]]>
</point>
  <point name="ui_browser_refresh.define" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[   ]]>
</point>
  <point name="cs.define" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[   ]]>
</point>
  <point name="cs.head.before" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[   ]]>
</point>
  <point name="cs.head.before_construct" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[            ]]>
</point>
  <point name="construct.b.mhacsite" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[            ]]>
</point>
  <point name="construct.a.mhacsite" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[            ]]>
</point>
  <point name="construct.b.mhac001" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[            ]]>
</point>
  <point name="construct.a.mhac001" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[            ]]>
</point>
  <point name="construct.b.mhac002" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[            ]]>
</point>
  <point name="construct.a.mhac002" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[            ]]>
</point>
  <point name="cs.body.before_construct" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[            ]]>
</point>
  <point name="construct.b.page1.mhacstus" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[            ]]>
</point>
  <point name="construct.a.page1.mhacstus" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[            ]]>
</point>
  <point name="construct.c.page1.mhacstus" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[            ]]>
</point>
  <point name="construct.b.page1.mhacunit" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[            ]]>
</point>
  <point name="construct.a.page1.mhacunit" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[            ]]>
</point>
  <point name="construct.b.page1.mhac003" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[            ]]>
</point>
  <point name="construct.a.page1.mhac003" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[            ]]>
</point>
  <point name="construct.b.page1.mhacl005" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[            ]]>
</point>
  <point name="construct.a.page1.mhacl005" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[            ]]>
</point>
  <point name="construct.c.page1.mhacl005" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[            ]]>
</point>
  <point name="construct.b.page1.mhacl006" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[            ]]>
</point>
  <point name="construct.a.page1.mhacl006" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[            ]]>
</point>
  <point name="construct.c.page1.mhacl006" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[            ]]>
</point>
  <point name="construct.b.page1.mhac004" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[            ]]>
</point>
  <point name="construct.a.page1.mhac004" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[            ]]>
</point>
  <point name="construct.c.page1.mhac004" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[            ]]>
</point>
  <point name="construct.b.page1.mhac005" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[            ]]>
</point>
  <point name="construct.a.page1.mhac005" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[            ]]>
</point>
  <point name="construct.c.page1.mhac005" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[            ]]>
</point>
  <point name="construct.b.page1.mhac006" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[            ]]>
</point>
  <point name="construct.a.page1.mhac006" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[            ]]>
</point>
  <point name="construct.c.page1.mhac006" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[            ]]>
</point>
  <point name="cs.more_construct" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[      ]]>
</point>
  <point name="cs.before_dialog" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[         ]]>
</point>
  <point name="cs.after_construct" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[   ]]>
</point>
  <point name="filter.add_cs" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[      ]]>
</point>
  <point name="filter.b_dialog" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[         ]]>
</point>
  <point name="query.define" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[   ]]>
</point>
  <point name="query.befroe_query" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[   ]]>
</point>
  <point name="fetch.define" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[   ]]>
</point>
  <point name="fetch.before_fetch" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[   ]]>
</point>
  <point name="insert.define" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[   ]]>
</point>
  <point name="insert.before" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[   ]]>
</point>
  <point name="insert.after_insert" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[      ]]>
</point>
  <point name="insert.after_insert2" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[      ]]>
</point>
  <point name="modify.define" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[   ]]>
</point>
  <point name="modify.before_input" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[      ]]>
</point>
  <point name="modify.after_input" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[      ]]>
</point>
  <point name="modify.b_key_update" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[         ]]>
</point>
  <point name="modify.m_key_update" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[         ]]>
</point>
  <point name="modify.a_key_update" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[         ]]>
</point>
  <point name="input.define_sql" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[   ]]>
</point>
  <point name="input.after_define_sql" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[   ]]>
</point>
  <point name="input.after_set_entry" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[   ]]>
</point>
  <point name="input.after_set_no_entry" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[   ]]>
</point>
  <point name="input.before_input" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[   ]]>
</point>
  <point name="input.b.mhacsite" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[            ]]>
</point>
  <point name="input.g.mhacsite" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[            ]]>
</point>
  <point name="input.b.mhac001" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[            ]]>
</point>
  <point name="input.g.mhac001" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[            ]]>
</point>
  <point name="input.b.mhac002" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[            ]]>
</point>
  <point name="input.g.mhac002" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[            ]]>
</point>
  <point name="input.head.b_update" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[               ]]>
</point>
  <point name="input.head.m_update" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[               ]]>
</point>
  <point name="input.head.a_update" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[                     ]]>
</point>
  <point name="input.head.a_insert" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[               ]]>
</point>
  <point name="input.body.before_input" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[            ]]>
</point>
  <point name="input.body.before_row" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[            ]]>
</point>
  <point name="input.body.b_insert" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[               ]]>
</point>
  <point name="input.body.m_insert" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[               ]]>
</point>
  <point name="input.body.a_insert" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[               ]]>
</point>
  <point name="input.body.after_insert" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[            ]]>
</point>
  <point name="input.body.a_delete" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[            ]]>
</point>
  <point name="input.body.after_delete" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[            ]]>
</point>
  <point name="input.b.page1.mhacstus" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[            ]]>
</point>
  <point name="input.g.page1.mhacstus" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[            ]]>
</point>
  <point name="input.b.page1.mhacunit" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[            ]]>
</point>
  <point name="input.g.page1.mhacunit" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[            ]]>
</point>
  <point name="input.b.page1.mhac003" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[            ]]>
</point>
  <point name="input.g.page1.mhac003" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[            ]]>
</point>
  <point name="input.b.page1.mhacl005" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[            ]]>
</point>
  <point name="input.a.page1.mhacl005" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[            ]]>
</point>
  <point name="input.g.page1.mhacl005" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[            ]]>
</point>
  <point name="input.b.page1.mhacl006" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[            ]]>
</point>
  <point name="input.a.page1.mhacl006" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[            ]]>
</point>
  <point name="input.g.page1.mhacl006" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[            ]]>
</point>
  <point name="input.b.page1.mhac004" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[            ]]>
</point>
  <point name="input.g.page1.mhac004" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[            ]]>
</point>
  <point name="input.b.page1.mhac005" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[            ]]>
</point>
  <point name="input.g.page1.mhac005" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[            ]]>
</point>
  <point name="input.b.page1.mhac006" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[            ]]>
</point>
  <point name="input.g.page1.mhac006" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[            ]]>
</point>
  <point name="input.c.page1.mhacstus" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[            ]]>
</point>
  <point name="input.c.page1.mhac003" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[            ]]>
</point>
  <point name="input.c.page1.mhacl005" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[            ]]>
</point>
  <point name="input.c.page1.mhacl006" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[            ]]>
</point>
  <point name="input.c.page1.mhac004" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[            ]]>
</point>
  <point name="input.c.page1.mhac005" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[            ]]>
</point>
  <point name="input.c.page1.mhac006" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[            ]]>
</point>
  <point name="input.body.m_update" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[               ]]>
</point>
  <point name="input.body.a_update" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[               ]]>
</point>
  <point name="input.body.after_input" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[            ]]>
</point>
  <point name="input.body2.action" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[         ]]>
</point>
  <point name="input.more_inputarray" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[      ]]>
</point>
  <point name="input.before_dialog" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[         ]]>
</point>
  <point name="input.after_input" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[   ]]>
</point>
  <point name="show.define" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[   ]]>
</point>
  <point name="show.before" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[   ]]>
</point>
  <point name="show.after" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[   ]]>
</point>
  <point name="ref_show.define" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[   ]]>
</point>
  <point name="reproduce.define" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[   ]]>
</point>
  <point name="reproduce.after_reproduce" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[   ]]>
</point>
  <point name="detail_reproduce.define" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[   ]]>
</point>
  <point name="detail_reproduce.body.table1.b_insert" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[   ]]>
</point>
  <point name="detail_reproduce.body.table1.m_insert" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[   ]]>
</point>
  <point name="detail_reproduce.body.table1.a_insert" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[   ]]>
</point>
  <point name="detail_reproduce.body.lang0.b_insert" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[   ]]>
</point>
  <point name="detail_reproduce.lang0.table1.m_insert" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[   ]]>
</point>
  <point name="detail_reproduce.lang0.table1.a_insert" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[   ]]>
</point>
  <point name="delete.body.m_delete" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[      ]]>
</point>
  <point name="delete.body.a_delete" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[      ]]>
</point>
  <point name="b_fill.define" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[   ]]>
</point>
  <point name="b_fill.sql_before" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[   ]]>
</point>
  <point name="b_fill.sql_after" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[   ]]>
</point>
  <point name="bfill.foreach" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[         ]]>
</point>
  <point name="b_fill.more" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[   ]]>
</point>
  <point name="b_fill2.define" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[   ]]>
</point>
  <point name="b_fill2.after_fill" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[   ]]>
</point>
  <point name="before_delete.define" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[      DEFINE l_cnt  LIKE type_t.num5
   DEFINE l_success  LIKE type_t.num5]]>
</point>
  <point name="delete.body.b_single_delete" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[   ]]>
</point>
  <point name="delete.body.m_single_delete" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[   ]]>
</point>
  <point name="delete_b.define" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[   ]]>
</point>
  <point name="insert_b.define" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[   ]]>
</point>
  <point name="update_b.define" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[   ]]>
</point>
  <point name="lock_b.define" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[   ]]>
</point>
  <point name="unlock_b.define" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[   ]]>
</point>
  <point name="set_entry.define" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[   ]]>
</point>
  <point name="set_entry.field_control" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[      ]]>
</point>
  <point name="set_entry.after_control" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[   ]]>
</point>
  <point name="set_no_entry.define" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[   ]]>
</point>
  <point name="set_no_entry.field_control" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[      ]]>
</point>
  <point name="set_no_entry.after_control" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[   ]]>
</point>
  <point name="set_entry_b.define" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[   ]]>
</point>
  <point name="set_entry_b.set_entry_b" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[   ]]>
</point>
  <point name="set_no_entry_b.define" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[   ]]>
</point>
  <point name="set_no_entry_b.set_no_entry_b段" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[   ]]>
</point>
  <point name="default_search.define" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[   ]]>
</point>
  <point name="default_search.before" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[   ]]>
</point>
  <point name="default_search.after" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[   ]]>
</point>
  <point name="fill_chk.define" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[   ]]>
</point>
  <point name="fill_chk.other" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[   ]]>
</point>
  <point name="modify_detail_chk.define" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[   ]]>
</point>
  <point name="modify_detail_chk.before" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[   ]]>
</point>
  <point name="modify_detail_chk.page_control" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[      ]]>
</point>
  <point name="modify_detail_chk.after" cite_std="N" status="u" ver="" src="" new="Y" order="">
<![CDATA[   ]]>
</point>
  <point name="function.amhi203_update_ooef" cite_std="N" status="u" ver="" src="" new="Y" order="7">
<![CDATA[##update ooef111,ooef112,ooef113
PRIVATE FUNCTION amhi203_update_ooef()
DEFINE l_mhad005   LIKE ooef_t.ooef111
DEFINE l_mhad006   LIKE ooef_t.ooef112
DEFINE l_mhad007   LIKE ooef_t.ooef113
DEFINE l_success   LIKE type_t.num5

   LET l_success=true

   SELECT sum(mhad005),sum(mhad006),sum(mhad007)
     INTO l_mhad005,l_mhad006,l_mhad007
     FROM mhad_t
    WHERE mhadsite=g_mhac_m.mhacsite AND mhadstus='Y'
   UPDATE ooef_t SET ooef111=l_mhad005,
                     ooef112=l_mhad006,
                     ooef113=l_mhad007
    WHERE ooefent=g_enterprise AND ooef001=g_mhac_m.mhacsite
   IF SQLCA.sqlcode THEN
      CALL cl_err("mhad_t",SQLCA.sqlcode,1)
      LET l_success=false 
      RETURN l_success 
   END IF
   RETURN l_success
END FUNCTION]]>
</point>
</add_points>