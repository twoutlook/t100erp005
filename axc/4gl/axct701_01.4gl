#該程式未解開Section, 採用最新樣板產出!
{<section id="axct701_01.description" >}
#應用 a00 樣板自動產生(Version:3)
#+ Standard Version.....: SD版次:0065(2016-12-06 10:40:11), PR版次:0065(2017-04-13 13:21:12)
#+ Customerized Version.: SD版次:0000(1900-01-01 00:00:00), PR版次:0000(1900-01-01 00:00:00)
#+ Build......: 000292
#+ Filename...: axct701_01
#+ Description: 資料批次產生
#+ Creator....: 01531(2014-04-16 09:46:52)
#+ Modifier...: 05384 -SD/PR- 08171
 
{</section>}
 
{<section id="axct701_01.global" >}
#應用 c01b 樣板自動產生(Version:10)
#add-point:填寫註解說明 name="global.memo"
#150812-00010#3     2015/08/28 By apo       屬於調整時,改取axci201調整科目
#150824-00001#4     2015/10/09 By zhangllc  增加发出商品的两支作业axct711,axct712
#151013-00019#7     2015/10/28 By Reanna    axct707帳款對象改抓aooi100的"據點對應客戶/廠商編號"
#151208-00020#2     2015/12/15 By Sarah     增加給值xceb109=axct201的xcbl024,xceb107=axct201的xcbl025
#151202-00017#2     2015/12/17 BY zhujing   增加项目结转成本 axct714
#160106-00014#1     2016/2/27  By lixiang   增加價差量差成本差異分攤的類型 '15'axct716 對應的處理邏輯
#151202-00017#1     2016/03/14 By xianghui  增加项目成本投入成本 axct713
#160318-00005#47    160401     by pengxin   修正azzi920重复定义之错误讯息
#160420-00016#1     2016/04/20 By Dido      1.axct707 增加 xcck020 為 304 條件
#                                           2.axct709 依據費用類型為 1 時給予生產成本-直接人工科目,其他則給予生產成本-製造費用科目
#160422-00008#1     2016/04/22 By 02040     axct706調整條件和axcq512抓取xcck資料一致
#160318-00025#47    2016/04/29 By 07959     將重複內容的錯誤訊息置換為公用錯誤訊息(r.v)
#160511-00045#2     2016/05/13 By 02040     axct709第二單身取xcce_t資料時，依存貨科目判斷，若有啟用科目部門管理(agli031)，THEN 部門xcec108=成本中心xcbk004；
#                                           若有啟用科目成本中心管理(agli031)，成本中心xcec114=成本中心xcbk004
#160616-00047#1     2016/06/17 By 02040     axct709製費分攤憑証產生排除axct201類型為 1.人工 
#160607-00026#1     2016/06/17 By 02040     axct702效能調整
#160617-00002#4     2016/06/20 By zhujing   axct716 傳入axct701_01參數改為'16', 對應作業代號
#150906-00001#2     2016/06/24 By lixh      委外加工结转凭证的科目抓取改进，现在委外工单的在制科目是跟一般工单的在制科目是一样的，应改成与委外工单独立设置在制科目的方式。
#160701-00012#2     2016/07/04 By 02040     核算項內容應由xcck_t的相應欄位值帶入
#160706-00021#3     2016/07/15 By 02097     axct711轉入:不含當月(期)出貨且己開發票者。
#160706-00021#4     2016/07/15 By 02097     axct712发出商品转出,1.取前期发出商品，本期轉出开票者。(本月出货直接开票的在axct706产生)
#160706-00021#4     2016/07/15 By 02097     axct706修改axct706	銷貨成本傳票產生方式
#160705-00042#11    2016/07/15 By sakura    查詢程式段q_ooba002_1開窗，呼叫開窗前的g_qryparam.arg若是要傳入程式代號，要改傳入g_prog
#160802-00020#1     2016/08/03 By Saraah    增加帳套權限管控
#160816-00015#1     2016/08/03 By 02040     1.sfaa資料統一抓取；2.axct701_01_ins(),axct701_01_ins_2(),axct701_01_ins_5()抓取工單sfaa068成本中心寫入xceb108和xcec108；
#                                           3.axct701_01_ins_11()抓取出貨單單頭的業務部門xmdk004寫入xceb108和xcec108；
#160816-00041#2     2016/08/23 By 02040     增加axct717調撥憑證
#160816-00015#2     2016/08/23 By 02040     axct707,708,科目取值要先取xcck的里面的值，如果为空，再以成本中心的部门aooi125对应的费用性质串到agli180取科目。
#160812-00020#1     2016/08/25 By 02040     axct706 數量跟金額需乘上-1，讓銷售出庫的數量與金額呈現正數，銷退才呈現負數
#160818-00013#1     2016/08/30 By 02040     axct705 差異轉入明細金額應為正數
#160901-00005#1     2016/09/01 By 02040     axct711 寫入xcec給予預設值有誤
#160901-00002#1     2016/09/02 By 02040     axct702 寫入xcec時，DL+OH+SUB科目應為空；第二單身未抓到工單類型
#160829-00005#2     2016/09/02 By 02040     axct702整批產生效能優化
#160902-00048#3     2016/09/05 By 02040     條件增加ENT 
#160817-00046#1     2016/09/08 by 02295     在产生单据编号时，不应用单据日期xcea001，而应用成本年期(xcea004+005)对应的会计年期的最后一天
#160906-00041#1     2016/09/10 By 02040     axct708產生單據時，應取雜收發的實際成本和axct707金額的差額
#160813-00002#1     2016/09/10 By 02040     工單號一張會由多個成本域領料，因此拿掉工單單頭的成本域對單身的成本域的條件
#160907-00003#6     2016/09/14 By 02295     增加在製轉出成本與工單入庫標準成本差異憑證(axct715)
#161013-00051#1     2016/10/18 By shiun     整批調整據點組織開窗
#161026-00056#1     2016/10/28 By 02295     axct713资料来源抓取调整
#161108-00040#1     2016/11/08 By zhujing   axct714结转数量=结转数量/100,作为进度。成本金额=材料+人工+加工费+制费一~五
#161109-00085#18    2016/11/17 By 08993     整批調整系統星號寫法
#161109-00085#19    2016/11/17 By 08993     整批調整系統星號寫法
#161118-00015#1     2016/11/18 By Sarah     檢查單據日期不可小於等於成本關帳日期
#161116-00023#1     2016/11/23 By 00768     axct708对比到axct707,会有一对多的情况存在，造成计算结果的错误
#                                           (这样的缺点，画面上就会可能显示多笔相同的数据，只数量金额不同，不能汇总显示了，这点可以考虑要否将参考单号、项次显示出来，主体不影响数据的正确性)
#161109-00085#63    2016/12/01 By 08171     整批調整系統星號寫法
#161124-00011#2     2016/12/06 By shiun     整批產生增加QBE條件，單身明細產生時, 依QBE條件限定範圍.
#161109-00032#6     2016/12/26 By lixiang   項目管理功能追加：修改axct713 项目投入分录：士兴是抓303X，产品改抓309X
#161229-00044#1     2016/12/30 By lixiang   axct713产生的资料数量、金额未带出
#161215-00040#1     2016/12/30 By 01727     优化axct701/axct702程序执行效能
#161215-00040#2     2016/12/30 By 01727     优化axct711/axct712程序执行效能
#170105-00011#1     2017/01/12 By 02295     优化axct710程序执行效能
#170105-00011#2     2017/01/12 By 02295     优化axct708程序执行效能
#170113-00045#1     2017/01/13 By 06694     FUNCTION axct701_01_ins_5() xcee304、xcci304 需要乘上 -1。
#160824-00007#365   2017/01/16 By lori      舊植備份處理調整
#170105-00011#3     2017/01/12 By 02295     优化axct706程序执行效能
#170105-00011#4     2017/01/12 By 02295     优化axct709程序执行效能
#170105-00011#5     2017/01/12 By 02295     优化axct707程序执行效能
#170105-00011#6     2017/01/12 By 02295     优化axct703程序执行效能
#170105-00067#1     2017/02/07 By 06694     AXCQ200报表已经有转出成本数据，AXCT712发出商品转入生成分录
#170105-00011#7     2017/01/12 By 02295     优化axct704程序执行效能
#170105-00011#8     2017/01/12 By 02295     优化axct705程序执行效能
#170207-00058#1     2017/02/09 By 06694     將 axct701_01_ins_7()、axct701_01_ins_8() 項次清空語法 mark。
#170213-00053#1     2017/02/14 By charles4m 1. UPDATE sourse_ins_tmp  SET sfaa028 條件 ooeg001 敢為 xceb108 2. 將 UPDATE sourse_ins_tmp SET xceb108 搬到第 1 點 SQL 之前。
#170214-00020#1     2017/02/14 By charles4m 將 DSCTP 改為  g_xcea_m.xceacomp
#170214-00050#1     2017/02/14 By charles4m 取第二單身xcec 的SQL中多了一個左括號
#170208-00044#1     2017/02/15 By 06694     主要是科目抓的順序造成，將順序改為 [收入及成本科目設置] 並改抓 glcc003  > [存貨類課目設置]。
#170208-00046#1     2017/02/15 By 06694     成本分群沒抓到，導致無法取到科目，抓 imag011 更新 sfaasite。
#170215-00035#1     2017/02/16 By charles4m 修正科目抓取等错误
#170216-00046#1     2017/02/17 By charles4m PREPARE axct701_9_upd_xcec108_1 /axct701_9_upd_xcec114_1 的 SQL 字串連接錯誤，少了 ,"'"
#170216-00050#1     2017/02/17 By charles4m 調整在 EXECUTE axct701_9_ins_xcec_01 之後，成本分群沒抓到，導致無法取到科目，抓 imag011 更新 sfaasite
#170214-00017#1     2017/02/17 By charles4m axct709 委外科目 xcec101 抓取 glcc004
#170221-00041#1     2017/02/21 By 02111     1: SELECT glcc_t 的 SQL 都必須加上 DISTINCT。
#                                           2: 所有axct7xx 程式都需要補上取 imag011 寫入品類。
#                                           3: 有用發出商品則科目改捉 發出商品科目(glcc006)。
#170214-00014#1     2017/02/22 By 02111     1: axct701 xceb109 請參照 xceb111 方式給值。
#                                           2: axct706、axct707、axct708 xceb109 請給來源為 xckk022。
#170116-00010#1     2017/02/24 By 02040     axct711發出商品轉入扣除已轉出的判斷，調整為是否開立發票
#170306-00063#1     2017/03/07 By 02111     1. axct705 無法批次產生差異資料。
#                                           2. axct706 金額需要負數取正以及SQL錯誤與法。
#170302-00035#1     2017/03/10 By 02295     axct705第三单身处理
#170313-00084#1     2017/03/14 By 02295     axct709第二单身摘要取错  应取axci202的axct709对应的摘要，现在取为axct708的； 
#                                           axct707第二单身摘要取错  应取axci202的axct707对应的摘要，现在取为axct708的； 
#                                           axct710第一单身摘要取错  应取axci202的axct710对应的摘要，现在取为axct701的。
#170310-00047#1     2017/03/15 By 02295     axct708第一单身科目该抓axci201中杂项进出差异转出科目
#170317-00012#1     2017/03/17 By 02111     axct709人工憑證沒有產生。
#170322-00125#1     2017/03/23 By 06948     axct712金额改为正，sql改善双引号，axct706排除发出商品未开票
#170324-00054#1     2017/03/25 By fionchen  將呼叫axct701_01_create_tmp搬到transaction前
#170327-00045#1     2017/03/27 By 02111     PREPARE axct701_9_ins_xcec_01 FROM g_sql mark AND xcbk005 <> '1'。
#160711-00040#35    2017/03/28 By 08734     T類作業的單別開窗的where條件(找CALL q_ooba002_開頭的)增加如下程式段
#                                           CALL s_control_get_docno_sql(g_user,g_dept) RETURNING l_success,l_sql1
#170217-00057#1     2017/03/29 By Reanna    增加axct719作業(專案費用分攤帳務作業)
#170323-00078#1     2017/04/13 By 08171     axct708如果沒有差異，不用顯示數據，即為0的數據不用顯示。
#end add-point
#add-point:填寫註解說明(客製用) name="global.memo_customerization"

#end add-point
 
IMPORT os
IMPORT FGL lib_cl_dlg
#add-point:增加匯入項目 name="global.import"

#end add-point
 
SCHEMA ds
 
GLOBALS "../../cfg/top_global.inc"
 
#add-point:增加匯入變數檔 name="global.inc" name="global.inc"
#160802-00020#1-s add
GLOBALS "../../axc/4gl/axct701.inc"
#160802-00020#1-e add
#end add-point
 
#單頭 type 宣告
PRIVATE type type_g_xcea_m        RECORD
       xceald LIKE xcea_t.xceald, 
   xceald_desc LIKE type_t.chr80, 
   xceacomp LIKE xcea_t.xceacomp, 
   xceacomp_desc LIKE type_t.chr80, 
   xcea003 LIKE xcea_t.xcea003, 
   xcea003_desc LIKE type_t.chr80, 
   xcea004 LIKE xcea_t.xcea004, 
   xcea005 LIKE xcea_t.xcea005, 
   xceadocno LIKE xcea_t.xceadocno, 
   xcea001 LIKE xcea_t.xcea001, 
   xcea006 LIKE xcea_t.xcea006, 
   xcea006_desc LIKE type_t.chr80, 
   xcea007 LIKE xcea_t.xcea007, 
   xcea007_desc LIKE type_t.chr80, 
   xcan001 LIKE xcan_t.xcan001
       END RECORD
	   
#add-point:自定義模組變數(Module Variable)(請盡量不要在客製環境修改此段落內容, 否則將後續patch的調整需人工處理) name="global.variable"
DEFINE g_bdate      LIKE glav_t.glav004 #起始年度+期別對應的起始截止日期
DEFINE g_edate      LIKE glav_t.glav004
DEFINE g_glaa001    LIKE glaa_t.glaa001
DEFINE g_glaa003    LIKE glaa_t.glaa003
DEFINE g_glaa004    LIKE glaa_t.glaa004
DEFINE g_glaa015    LIKE glaa_t.glaa015
DEFINE g_glaa016    LIKE glaa_t.glaa016
DEFINE g_glaa017    LIKE glaa_t.glaa017   #160920-00002#1
DEFINE g_glaa018    LIKE glaa_t.glaa018
DEFINE g_glaa019    LIKE glaa_t.glaa019
DEFINE g_glaa020    LIKE glaa_t.glaa020
DEFINE g_glaa021    LIKE glaa_t.glaa021   #160920-00002#1
DEFINE g_glaa022    LIKE glaa_t.glaa022
DEFINE g_glaa024    LIKE glaa_t.glaa024
DEFINE g_prog_name1 LIKE type_t.chr20
DEFINE g_xcea002    LIKE xcea_t.xcea002
DEFINE g_sql,g_sql1,g_sql2   STRING
DEFINE g_sql3       STRING          #160106-00014#1 add
DEFINE g_wc         STRING          #160106-00014#1 add
DEFINE g_wc2        STRING          #161124-00011#2-add
DEFINE g_xcea_m_o   type_g_xcea_m   #160824-00007#365 170116 by lori add
#end add-point
 
DEFINE g_xcea_m        type_g_xcea_m
 
   DEFINE g_xceald_t LIKE xcea_t.xceald
DEFINE g_xceadocno_t LIKE xcea_t.xceadocno
 
 
DEFINE g_ref_fields          DYNAMIC ARRAY OF VARCHAR(500) #ap_ref用陣列
DEFINE g_rtn_fields          DYNAMIC ARRAY OF VARCHAR(500) #ap_ref用陣列
 
#add-point:自定義客戶專用模組變數(Module Variable) name="global.variable_customerization"

#end add-point
 
#add-point:傳入參數說明(global.argv) name="global.argv"
 
#end add-point
 
{</section>}
 
{<section id="axct701_01.input" >}
#+ 資料輸入
PUBLIC FUNCTION axct701_01(--)
   #add-point:input段變數傳入 name="input.get_var"
   p_xcea002	
   #end add-point
   )
   #add-point:input段define name="input.define_customerization"
   
   #end add-point
   DEFINE l_ac_t          LIKE type_t.num10       #未取消的ARRAY CNT 
   DEFINE l_allow_insert  LIKE type_t.num5        #可新增否 
   DEFINE l_allow_delete  LIKE type_t.num5        #可刪除否  
   DEFINE l_count         LIKE type_t.num10
   DEFINE l_insert        LIKE type_t.num5
   DEFINE p_cmd           LIKE type_t.chr5
   #add-point:input段define(請盡量不要在客製環境修改此段落內容, 否則將後續patch的調整需人工處理) name="input.define"
   DEFINE l_success       LIKE type_t.chr1
   DEFINE l_n             LIKE type_t.chr5
   DEFINE p_xcea002       LIKE xcea_t.xcea002
   DEFINE l_sql           STRING              #160607-00026#1 add
   DEFINE r_success       LIKE type_t.num10   #160802-00020#1 add
   DEFINE l_glaa003       LIKE glaa_t.glaa003 #160817-00046#1
   DEFINE l_bdate         LIKE xcea_t.xcea001 #160817-00046#1
   DEFINE l_edate         LIKE xcea_t.xcea001 #160817-00046#1
   DEFINE l_date          DATE                #161118-00015#1 add
   DEFINE l_sql1          STRING   #160711-00040#35 add
   #end add-point
   
   #畫面開啟 (identifier)
   OPEN WINDOW w_axct701_01 WITH FORM cl_ap_formpath("axc","axct701_01")
 
   #瀏覽頁簽資料初始化
   CALL cl_ui_init()
   
   LET g_qryparam.state = "i"
   LET p_cmd = 'a'
   
   #輸入前處理
   #add-point:單頭前置處理 name="input.pre_input"
   WHENEVER ERROR CALL cl_err_msg_log
   
   LET g_xcea002=p_xcea002
   
   #160106-00014#1--add---begin---
   #差異科目類型的QBE
   #160617-00002#4 mod-S
#  IF g_xcea002 <> '15' THEN   #axct716
   IF g_xcea002 <> '16' THEN   #axct716   
   #160617-00002#4 mod-E
      CALL cl_set_comp_visible('group_1',FALSE)  
   END IF
   #160106-00014#1--add---end---
   #160907-00003#6---add---s
   IF g_xcea002 = '15' THEN   #axct715   
      CALL cl_set_comp_visible('group_1',FALSE)  
   END IF 
   #160907-00003#6---add---e   
   #161124-00011#2-add-s
   CALL cl_set_combo_scc("xcco010",'8916')
   IF g_xcea002 = '3' THEN   #axct703   
      CALL cl_set_comp_visible('lbl_xcco010_1,lbl_xcco009_1,group_1,xcco009,xcco010',TRUE)
      CALL cl_set_comp_visible('xcan001',FALSE)
   END IF 
   #161124-00011#2-add-e
   #end add-point
  
   DIALOG ATTRIBUTES(UNBUFFERED,FIELD ORDER FORM)
   
      #輸入開始
      INPUT BY NAME g_xcea_m.xceald,g_xcea_m.xceacomp,g_xcea_m.xcea003,g_xcea_m.xcea004,g_xcea_m.xcea005, 
          g_xcea_m.xceadocno,g_xcea_m.xcea001,g_xcea_m.xcea006,g_xcea_m.xcea007 ATTRIBUTE(WITHOUT DEFAULTS) 
 
         
         #自訂ACTION
         #add-point:單頭前置處理 name="input.action"
  
         #end add-point
         
         #自訂ACTION(master_input)
         
         
         BEFORE INPUT
            #add-point:單頭輸入前處理 name="input.before_input"
            LET g_xcea_m.xceald = ''
            LET g_xcea_m.xceacomp = ''
            LET g_xcea_m.xcea003 = ''
            LET g_xcea_m.xcea004 = ''
            LET g_xcea_m.xcea005 = ''
            LET g_xcea_m.xceadocno = ''
            LET g_xcea_m.xcea001 = ''
            LET g_xcea_m.xcea006 = g_user
            LET g_xcea_m.xcea007 = g_dept
            LET g_xcea_m.xcea001 = g_today
            
            LET g_xcea_m.xcea006_desc = s_desc_get_person_desc(g_xcea_m.xcea006)
            LET g_xcea_m.xcea007_desc = s_desc_get_department_desc(g_xcea_m.xcea007)
            DISPLAY BY NAME g_xcea_m.xcea006_desc,g_xcea_m.xcea007_desc
            
            CALL s_axc_set_site_default() RETURNING g_xcea_m.xceacomp,g_xcea_m.xceald,g_xcea_m.xcea004,g_xcea_m.xcea005,g_xcea_m.xcea003
            DISPLAY BY NAME g_xcea_m.xcea004,g_xcea_m.xcea005,g_xcea_m.xcea001
            #160817-00046#1---add---s
            #根据画面资料抓取会计日期最后一天的日期作为单据别编号获取的传入日期
            LET l_glaa003 = ''
            LET l_bdate = ''
            LET l_edate = ''
            SELECT glaa003 INTO l_glaa003
              FROM glaa_t
             WHERE glaaent = g_enterprise
               AND glaald = g_xcea_m.xceald
            CALL s_fin_date_get_period_range(l_glaa003,g_xcea_m.xcea004,g_xcea_m.xcea005)
              RETURNING l_bdate,l_edate
            IF NOT cl_null(l_edate) THEN
               LET g_xcea_m.xcea001 = l_edate
            END IF
            #160817-00046#1---add---e
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xcea_m.xceacomp
            CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xcea_m.xceacomp_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xcea_m.xceacomp_desc 
            
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xcea_m.xceald
            CALL ap_ref_array2(g_ref_fields,"SELECT glaal002 FROM glaal_t WHERE glaalent='"||g_enterprise||"' AND glaalld=? AND glaal001='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xcea_m.xceald_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xcea_m.xceald_desc
            
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xcea_m.xcea003
            CALL ap_ref_array2(g_ref_fields,"SELECT xcatl003 FROM xcatl_t WHERE xcatlent='"||g_enterprise||"' AND xcatl001=? AND xcatl002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xcea_m.xcea003_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xcea_m.xcea003_desc
            
            CALL axct701_01_get_glaa()   #160824-00007#365 add
            
            CASE g_xcea002
               WHEN '1'  LET g_prog_name1 = 'axct701'
               WHEN '2'  LET g_prog_name1 = 'axct702'
               WHEN '3'  LET g_prog_name1 = 'axct703'
               WHEN '4'  LET g_prog_name1 = 'axct704'
               WHEN '5'  LET g_prog_name1 = 'axct705'
               WHEN '6'  LET g_prog_name1 = 'axct706'
               WHEN '7'  LET g_prog_name1 = 'axct707'
               WHEN '8'  LET g_prog_name1 = 'axct708'
               WHEN '9'  LET g_prog_name1 = 'axct709'
               WHEN '10' LET g_prog_name1 = 'axct710'
               WHEN '11' LET g_prog_name1 = 'axct711'  #add zhangllc 151009
               WHEN '12' LET g_prog_name1 = 'axct712'  #add zhangllc 151009
               WHEN '13' LET g_prog_name1 = 'axct713'  #add zhujing 2015-12-16
               WHEN '14' LET g_prog_name1 = 'axct714'  #add zhujing 2015-12-16
               WHEN '15' LET g_prog_name1 = 'axct715'  #160907-00003#6
               #160617-00002#4 mod-S
#               WHEN '15' LET g_prog_name1 = 'axct716' #160106-00014#1 add
               WHEN '16' LET g_prog_name1 = 'axct716'
               #160617-00002#4 mod-E
               WHEN '17' LET g_prog_name1 = 'axct717'  #160816-00041#2 add
               WHEN '19' LET g_prog_name1 = 'axct719'  #170217-00057#1
            END CASE
            CALL cl_set_comp_entry("xcea003",FALSE)
            LET g_xcea_m_o.* = g_xcea_m.*   #160824-00007#365 170116 by lori add
            #end add-point
          
                  #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD xceald
            
            #add-point:AFTER FIELD xceald name="input.a.xceald"
            #此段落由子樣板a05產生
            IF  NOT cl_null(g_xcea_m.xceald) AND NOT cl_null(g_xcea_m.xceadocno) THEN 
               IF p_cmd = 'a' OR ( p_cmd = 'u' AND (g_xcea_m.xceald != g_xceald_t  OR g_xcea_m.xceadocno != g_xceadocno_t )) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xcea_t WHERE "||"xceaent = '" ||g_enterprise|| "' AND "||"xceald = '"||g_xcea_m.xceald ||"' AND "|| "xceadocno = '"||g_xcea_m.xceadocno ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            
            IF NOT cl_null(g_xcea_m.xceald) THEN
               IF g_xcea_m_o.xceald <> g_xcea_m.xceald OR cl_null(g_xcea_m_o.xceald) THEN   #160824-00007#365 170116 by lori add
                  #檢查是否存在 帳別資料檔 中
                  IF NOT ap_chk_isExist(g_xcea_m.xceald,"SELECT COUNT(*) FROM glaa_t WHERE "||"glaaent = '" ||g_enterprise|| "' AND "||"glaald = ? ",'agl-00016',1) THEN
                    #LET g_xcea_m.xceald = g_xceald_t          #160824-00007#365 170116 by lori mark
                     LET g_xcea_m.xceald = g_xcea_m_o.xceald   #160824-00007#365 170116 by lori add
                     DISPLAY BY NAME g_xcea_m.xceald           #160824-00007#365 170116 by lori add
                     CALL axct701_01_get_xceald_desc()
                     CALL axct701_01_get_xceacomp_desc()                  
                     NEXT FIELD CURRENT
                  END IF   
                  
                  #檢查是否 有效
#                  IF NOT ap_chk_isExist(g_xcea_m.xceald,"SELECT COUNT(*) FROM glaa_t WHERE "||"glaaent = '" ||g_enterprise|| "' AND "||"glaald = ? AND glaastus = 'Y'",'agl-00051',1) THEN     #160318-00005#47  mark
                  IF NOT ap_chk_isExist(g_xcea_m.xceald,"SELECT COUNT(*) FROM glaa_t WHERE "||"glaaent = '" ||g_enterprise|| "' AND "||"glaald = ? AND glaastus = 'Y'",'sub-01302','agli010') THEN #160318-00005#47  add
                    #LET g_xcea_m.xceald = g_xceald_t          #160824-00007#365 170116 by lori mark
                     LET g_xcea_m.xceald = g_xcea_m_o.xceald   #160824-00007#365 170116 by lori add
                     DISPLAY BY NAME g_xcea_m.xceald           #160824-00007#365 170116 by lori add
                     CALL axct701_01_get_xceald_desc()
                     CALL axct701_01_get_xceacomp_desc()                  
                     NEXT FIELD CURRENT
                  END IF
               
#160802-00020#1-s add
                  #增加帳套權限檢查
                  CALL s_fin_ld_chk(g_xcea_m.xceald,g_user,'N') RETURNING r_success,g_errno
                  IF NOT r_success THEN
                    #LET g_xcea_m.xceald = g_xceald_t          #160824-00007#365 170116 by lori mark
                     LET g_xcea_m.xceald = g_xcea_m_o.xceald   #160824-00007#365 170116 by lori add
                     DISPLAY BY NAME g_xcea_m.xceald           #160824-00007#365 170116 by lori add
                     INITIALIZE g_errparam.* TO NULL
                     LET g_errparam.extend = ''
                     LET g_errparam.code = g_errno                  
                     LET g_errparam.replace[1] = 'agli010'
                     LET g_errparam.replace[2] = cl_get_progname('agli010',g_lang,"2")
                     LET g_errparam.exeprog = 'agli010'                  
                     LET g_errparam.popup = TRUE
                     CALL cl_err()
                     NEXT FIELD CURRENT
                  END IF
#160802-00020#1-e add

                  #160824-00007#365 170116 by lori add---(S)
                  CALL axct701_01_get_glaa()
                  
                  #默認帶出帳套歸屬法人
                  CALL axct701_01_get_xceacomp()
                  
                  #默認年度月份為當前成本計算年度期別
                  IF NOT cl_null(g_xcea_m.xceacomp) THEN
                     CALL cl_get_para(g_enterprise,g_xcea_m.xceacomp,'S-FIN-6010') RETURNING g_xcea_m.xcea004
                     CALL cl_get_para(g_enterprise,g_xcea_m.xceacomp,'S-FIN-6011') RETURNING g_xcea_m.xcea005
                     DISPLAY BY NAME g_xcea_m.xcea004,g_xcea_m.xcea005               
                  END IF
            
                  #160824-00007#365 170116 by lori add---(E)
               END IF   #160824-00007#365 170116 by lori add
            END IF   
            
            #160824-00007#365 170116 by lori mark---(S)
            #IF NOT cl_null(g_xcea_m.xceald) THEN 
            #   CALL axct701_01_get_glaa()
            #END IF 
            #
            ##默認帶出帳套歸屬法人
            #IF NOT cl_null(g_xcea_m.xceald) THEN 
            #   CALL axct701_01_get_xceacomp()
            #END IF
            ##默認年度月份為當前成本計算年度期別
            #IF NOT cl_null(g_xcea_m.xceacomp) THEN
            #   CALL cl_get_para(g_enterprise,g_xcea_m.xceacomp,'S-FIN-6010') RETURNING g_xcea_m.xcea004
            #   CALL cl_get_para(g_enterprise,g_xcea_m.xceacomp,'S-FIN-6011') RETURNING g_xcea_m.xcea005
            #   DISPLAY BY NAME g_xcea_m.xcea004,g_xcea_m.xcea005               
            #END IF
            #160824-00007#365 170116 by lori mark---(E)
            
            CALL axct701_01_get_xceald_desc()
            CALL axct701_01_get_xceacomp_desc()
            
           #160824-00007#365 170116 by lori mod---(S) 
           #LET g_xceald_t = g_xcea_m.xceald          #160802-00020#1 add   
            LET g_xcea_m_o.xceald = g_xcea_m.xceald   
            LET g_xcea_m_o.xcea004 = g_xcea_m.xcea004
            LET g_xcea_m_o.xcea005 = g_xcea_m.xcea005
           #160824-00007#365 170116 by lori mod---(E)
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD xceald
            #add-point:BEFORE FIELD xceald name="input.b.xceald"
            
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE xceald
            #add-point:ON CHANGE xceald name="input.g.xceald"
            
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD xceacomp
            
            #add-point:AFTER FIELD xceacomp name="input.a.xceacomp"
            #CALL axct701_01_get_xceacomp_desc()


            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD xceacomp
            #add-point:BEFORE FIELD xceacomp name="input.b.xceacomp"
            
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE xceacomp
            #add-point:ON CHANGE xceacomp name="input.g.xceacomp"
            
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD xcea003
            
            #add-point:AFTER FIELD xcea003 name="input.a.xcea003"
            IF NOT cl_null(g_xcea_m.xcea003) THEN 
               IF g_xcea_m.xcea003 <> g_xcea_m_o.xcea003 OR cl_null(g_xcea_m_o.xcea003) THEN   #160824-00007#365 170116 by lori add
                  #檢查是否存在于 成本類型設置檔 中
                  IF NOT ap_chk_isExist(g_xcea_m.xcea003,"SELECT COUNT(*) FROM xcat_t WHERE "||"xcatent = '" ||g_enterprise|| "' AND "||"xcat001 = ? ",'agl-00194',1) THEN
                    #LET g_xcea_m.xcea003 = ''                   #160824-00007#365 170116 by lori mark
                     LET g_xcea_m.xcea003 = g_xcea_m_o.xcea003   #160824-00007#365 170116 by lori add  
                     DISPLAY BY NAME g_xcea_m.xcea003            #160824-00007#365 170116 by lori add
                     
                     CALL axct701_01_get_xcea003_desc()                  
                     NEXT FIELD CURRENT
                  END IF
                  
                  #檢查是否 有效
#                  IF NOT ap_chk_isExist(g_xcea_m.xcea003,"SELECT COUNT(*) FROM xcat_t WHERE "||"xcatent = '" ||g_enterprise|| "' AND "||"xcat001 = ? AND xcatstus = 'Y' ",'agl-00195',1) THEN   #160318-00005#47  mark
                  IF NOT ap_chk_isExist(g_xcea_m.xcea003,"SELECT COUNT(*) FROM xcat_t WHERE "||"xcatent = '" ||g_enterprise|| "' AND "||"xcat001 = ? AND xcatstus = 'Y' ",'sub-01302','axci100') THEN   #160318-00005#47  add
                    #LET g_xcea_m.xcea003 = ''                   #160824-00007#365 170116 by lori mark
                     LET g_xcea_m.xcea003 = g_xcea_m_o.xcea003   #160824-00007#365 170116 by lori add  
                     DISPLAY BY NAME g_xcea_m.xcea003            #160824-00007#365 170116 by lori add
                     
                     CALL axct701_01_get_xcea003_desc()                  
                     NEXT FIELD CURRENT
                  END IF  
               END IF   #160824-00007#365 170116 by lori add                  
            END IF
            
            CALL axct701_01_get_xcea003_desc() 

            LET g_xcea_m_o.xcea003 = g_xcea_m.xcea003   #160824-00007#365 170116 by lori add  
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD xcea003
            #add-point:BEFORE FIELD xcea003 name="input.b.xcea003"
            
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE xcea003
            #add-point:ON CHANGE xcea003 name="input.g.xcea003"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD xcea004
            #add-point:BEFORE FIELD xcea004 name="input.b.xcea004"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD xcea004
            
            #add-point:AFTER FIELD xcea004 name="input.a.xcea004"
            IF NOT cl_null(g_xcea_m.xcea004) THEN  
               IF g_xcea_m.xcea004 <> g_xcea_m_o.xcea004 OR cl_null(g_xcea_m_o.xcea004) THEN   #160824-00007#365 170116 by lori add
                  IF NOT s_fin_date_chk_year(g_xcea_m.xcea004) THEN
                    #LET g_xcea_m.xcea004 = ''                   #160824-00007#365 170116 by lori mark
                     LET g_xcea_m.xcea004 = g_xcea_m_o.xcea004   #160824-00007#365 170116 by lori add  
                     DISPLAY BY NAME g_xcea_m.xcea004
                     INITIALIZE g_errparam TO NULL
                     LET g_errparam.code = 'aoo-00113'
                     LET g_errparam.extend = g_xcea_m.xcea004
                     LET g_errparam.popup = TRUE
                     CALL cl_err()
                  
                     NEXT FIELD CURRENT
                  END IF
               END IF   #160824-00007#365 170116 by lori add
            END IF   
            
            IF NOT cl_null(g_xcea_m.xcea004) AND NOT cl_null(g_xcea_m.xcea005) AND NOT cl_null(g_xcea_m.xceald) THEN
               CALL s_fin_date_get_period_range(g_glaa003,g_xcea_m.xcea004,g_xcea_m.xcea005)
                   RETURNING g_bdate,g_edate               
            END IF
            
            LET g_xcea_m_o.xcea004 = g_xcea_m.xcea004   #160824-00007#365 170116 by lori add  
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE xcea004
            #add-point:ON CHANGE xcea004 name="input.g.xcea004"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD xcea005
            #add-point:BEFORE FIELD xcea005 name="input.b.xcea005"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD xcea005
            
            #add-point:AFTER FIELD xcea005 name="input.a.xcea005"
            IF NOT cl_null(g_xcea_m.xcea005) THEN 
               IF g_xcea_m.xcea005 <> g_xcea_m_o.xcea005 OR cl_null(g_xcea_m_o.xcea005) THEN   #160824-00007#365 170116 by lori add  
                  IF g_xcea_m.xcea005 < 1 OR g_xcea_m.xcea005 > 13 THEN
                    #LET g_xcea_m.xcea005 = ''                   #160824-00007#365 170116 by lori mark
                     LET g_xcea_m.xcea005 = g_xcea_m_o.xcea005   #160824-00007#365 170116 by lori add 
                     DISPLAY BY NAME g_xcea_m.xcea005            #160824-00007#365 170116 by lori add                       
                     INITIALIZE g_errparam TO NULL
                     LET g_errparam.code = 'amm-00106'
                     LET g_errparam.extend = ''
                     LET g_errparam.popup = TRUE
                     CALL cl_err()
                  
                     NEXT FIELD CURRENT          
                  END IF
               END IF   #160824-00007#365 170116 by lori add  
            END IF
            
            IF NOT cl_null(g_xcea_m.xcea005) AND NOT cl_null(g_xcea_m.xceald) THEN                 
               IF NOT s_fin_date_chk_period(g_glaa003,g_xcea_m.xcea004,g_xcea_m.xcea005) THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = 'afa-00119'
                  LET g_errparam.extend = g_xcea_m.xcea005
                  LET g_errparam.popup = TRUE
                  CALL cl_err()

                 #LET g_xcea_m.xcea005 = ''                   #160824-00007#365 170116 by lori mark
                  LET g_xcea_m.xcea005 = g_xcea_m_o.xcea005   #160824-00007#365 170116 by lori add 
                  DISPLAY BY NAME g_xcea_m.xcea005
                  NEXT FIELD CURRENT
               END IF
            END IF            
            
            IF NOT cl_null(g_xcea_m.xcea004) AND NOT cl_null(g_xcea_m.xcea005) AND NOT cl_null(g_xcea_m.xceald) THEN
               CALL s_fin_date_get_period_range(g_glaa003,g_xcea_m.xcea004,g_xcea_m.xcea005)
                   RETURNING g_bdate,g_edate               
            END IF
           
            #LET g_xcea_m.xcea005 = g_xcea_m_o.xcea005   #160824-00007#365 170116 by lori add #170105-00067#1 mark 
            LET g_xcea_m_o.xcea005 = g_xcea_m.xcea005   #170105-00067#1 add
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE xcea005
            #add-point:ON CHANGE xcea005 name="input.g.xcea005"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD xceadocno
            #add-point:BEFORE FIELD xceadocno name="input.b.xceadocno"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD xceadocno
            
            #add-point:AFTER FIELD xceadocno name="input.a.xceadocno"
            #此段落由子樣板a05產生
            IF  NOT cl_null(g_xcea_m.xceald) AND NOT cl_null(g_xcea_m.xceadocno) THEN 
               IF p_cmd = 'a' OR ( p_cmd = 'u' AND (g_xcea_m.xceald != g_xceald_t  OR g_xcea_m.xceadocno != g_xceadocno_t )) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xcea_t WHERE "||"xceaent = '" ||g_enterprise|| "' AND "||"xceald = '"||g_xcea_m.xceald ||"' AND "|| "xceadocno = '"||g_xcea_m.xceadocno ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
                  IF NOT s_aooi200_fin_chk_docno(g_xcea_m.xceald,'','',g_xcea_m.xceadocno,g_xcea_m.xcea001,g_prog_name1) THEN
                     LET g_xcea_m.xceadocno = g_xceadocno_t
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            



            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE xceadocno
            #add-point:ON CHANGE xceadocno name="input.g.xceadocno"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD xcea001
            #add-point:BEFORE FIELD xcea001 name="input.b.xcea001"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD xcea001
            
            #add-point:AFTER FIELD xcea001 name="input.a.xcea001"
#161118-00015#1-s add
            #檢查單據日期不可小於等於成本關帳日期
            CALL cl_get_para(g_enterprise,g_xcea_m.xceacomp,'S-FIN-6012') RETURNING l_date            
            IF g_xcea_m.xcea001 <= l_date THEN
               INITIALIZE g_errparam TO NULL
               LET g_errparam.code = 'axc-00226'
               LET g_errparam.extend = ''
               LET g_errparam.popup = TRUE
               CALL cl_err()
               NEXT FIELD xcea001
            END IF
#161118-00015#1-e add
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE xcea001
            #add-point:ON CHANGE xcea001 name="input.g.xcea001"
            
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD xcea006
            
            #add-point:AFTER FIELD xcea006 name="input.a.xcea006"

            IF NOT cl_null(g_xcea_m.xcea006) THEN
               SELECT DISTINCT ooag003 INTO g_xcea_m.xcea007
                 FROM ooag_t
                 WHERE ooagent = g_enterprise
                   AND ooag001 = g_xcea_m.xcea006
                 ORDER BY ooag003
                 
               CALL s_desc_get_department_desc(g_xcea_m.xcea007) RETURNING g_xcea_m.xcea007_desc
               DISPLAY BY NAME g_xcea_m.xcea007
               DISPLAY g_xcea_m.xcea007_desc TO xcea007_desc
            END IF

            CALL s_desc_get_person_desc(g_xcea_m.xcea006) RETURNING g_xcea_m.xcea006_desc
            DISPLAY g_xcea_m.xcea006_desc TO xcea006_desc
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD xcea006
            #add-point:BEFORE FIELD xcea006 name="input.b.xcea006"
            
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE xcea006
            #add-point:ON CHANGE xcea006 name="input.g.xcea006"
            
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD xcea007
            
            #add-point:AFTER FIELD xcea007 name="input.a.xcea007"

#            IF NOT cl_null(g_xcea_m.xcea007) THEN
#              #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
#              INITIALIZE g_chkparam.* TO NULL
#              #設定g_chkparam.*的參數
#              LET g_chkparam.arg1 = g_xcea_m.xcea007
#              LET g_chkparam.arg2 = g_xcea_m.xcea001
#              
#              #呼叫檢查存在並帶值的library
#              IF NOT cl_chk_exist('v_ooeg001') THEN
#                 #檢查失敗時後續處理
#                 LET g_xcea_m.xcea007 = ''
#                 NEXT FIELD xcea007
#              END IF
#            END IF
            CALL s_desc_get_department_desc(g_xcea_m.xcea007) RETURNING g_xcea_m.xcea007_desc
            DISPLAY g_xcea_m.xcea007_desc TO xcea007_desc
            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD xcea007
            #add-point:BEFORE FIELD xcea007 name="input.b.xcea007"
            
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE xcea007
            #add-point:ON CHANGE xcea007 name="input.g.xcea007"
            
            #END add-point 
 
 
 #欄位檢查
                  #Ctrlp:input.c.xceald
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD xceald
            #add-point:ON ACTION controlp INFIELD xceald name="input.c.xceald"
            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_xcea_m.xceald             #給予default值
            #給予arg
            LET g_qryparam.arg1 = g_user
            LET g_qryparam.arg2 = g_dept
#160802-00020#1-s add
            #增加帳套過濾條件
            IF NOT cl_null(g_wc_cs_ld) THEN
               LET g_qryparam.where = " glaald IN ",g_wc_cs_ld
            END IF
#160802-00020#1-e add
            CALL q_authorised_ld()                                #呼叫開窗
            LET g_xcea_m.xceald = g_qryparam.return1              
            CALL axct701_01_get_xceald_desc()
            DISPLAY g_xcea_m.xceald TO xceald
            DISPLAY g_xcea_m.xceald_desc TO xceald_desc
            NEXT FIELD xceald                                     #返回原欄位
            #END add-point
 
 
         #Ctrlp:input.c.xceacomp
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD xceacomp
            #add-point:ON ACTION controlp INFIELD xceacomp name="input.c.xceacomp"
            #此段落由子樣板a07產生            
            #開窗i段
#            INITIALIZE g_qryparam.* TO NULL
#            LET g_qryparam.state = 'i'
#            LET g_qryparam.reqry = FALSE
#
#            LET g_qryparam.default1 = g_xcea_m.xceacomp             #給予default值
#
#            #給予arg
#            LET g_qryparam.arg1 = "" #
#
#            #mod--161013-00051#1 By shiun--(S)
##            CALL q_ooef001_8()                                #呼叫開窗
#            CALL q_ooef001_2()
#            #mod--161013-00051#1 By shiun--(E)
#
#            LET g_xcea_m.xceacomp = g_qryparam.return1              
#
#            DISPLAY g_xcea_m.xceacomp TO xceacomp              #
#
#            NEXT FIELD xceacomp                          #返回原欄位


            #END add-point
 
 
         #Ctrlp:input.c.xcea003
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD xcea003
            #add-point:ON ACTION controlp INFIELD xcea003 name="input.c.xcea003"
            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xcea_m.xcea003             #給予default值
            
            CALL q_xcat001()                                #呼叫開窗

            LET g_xcea_m.xcea003 = g_qryparam.return1              

            CALL axct701_01_get_xcea003_desc() 

            DISPLAY g_xcea_m.xcea003 TO xcea003              #
            DISPLAY g_xcea_m.xcea003_desc TO xcea003_desc

            NEXT FIELD xcea003                          #返回原欄位


            #END add-point
 
 
         #Ctrlp:input.c.xcea004
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD xcea004
            #add-point:ON ACTION controlp INFIELD xcea004 name="input.c.xcea004"
            
            #END add-point
 
 
         #Ctrlp:input.c.xcea005
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD xcea005
            #add-point:ON ACTION controlp INFIELD xcea005 name="input.c.xcea005"
            
            #END add-point
 
 
         #Ctrlp:input.c.xceadocno
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD xceadocno
            #add-point:ON ACTION controlp INFIELD xceadocno name="input.c.xceadocno"
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xcea_m.xceadocno             #給予default值

            #給予arg
               
            LET g_qryparam.arg1 = g_glaa024
            #LET g_qryparam.arg2 = g_prog_name1   #160705-00042#11 160715 by sakura mark
            LET g_qryparam.arg2 = g_prog          #160705-00042#11 160715 by sakura add
            #160711-00040#35 add(S)
            CALL s_control_get_docno_sql(g_user,g_dept)
                RETURNING l_success,l_sql1
            IF NOT cl_null(l_sql1) THEN
               LET g_qryparam.where = l_sql1
            END IF
            #160711-00040#35 add(E)
            CALL q_ooba002_1()                                #呼叫開窗

            LET g_xcea_m.xceadocno = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xcea_m.xceadocno TO xceadocno              #顯示到畫面上
            
            NEXT FIELD xceadocno 
            #END add-point
 
 
         #Ctrlp:input.c.xcea001
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD xcea001
            #add-point:ON ACTION controlp INFIELD xcea001 name="input.c.xcea001"
            
            #END add-point
 
 
         #Ctrlp:input.c.xcea006
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD xcea006
            #add-point:ON ACTION controlp INFIELD xcea006 name="input.c.xcea006"
            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xcea_m.xcea006             #給予default值

            IF NOT cl_null(g_xcea_m.xcea007) THEN
               LET g_qryparam.where = " ooag003 = '",g_xcea_m.xcea007,"'"
            END IF

            CALL q_ooag001()                                #呼叫開窗

            LET g_xcea_m.xcea006 = g_qryparam.return1              

            CALL s_desc_get_person_desc(g_xcea_m.xcea006) RETURNING g_xcea_m.xcea006_desc
            
            DISPLAY g_xcea_m.xcea006 TO xcea006              #
            DISPLAY g_xcea_m.xcea006_desc TO xcea006_desc 

            LET g_qryparam.where = '' 

            NEXT FIELD xcea006                          #返回原欄位


            #END add-point
 
 
         #Ctrlp:input.c.xcea007
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD xcea007
            #add-point:ON ACTION controlp INFIELD xcea007 name="input.c.xcea007"
            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xcea_m.xcea007             #給予default值
 
            IF NOT cl_null(g_xcea_m.xcea006) THEN
               LET g_qryparam.where = " ooag001 = '",g_xcea_m.xcea006,"'"
               CALL q_ooag003_1()
            ELSE
               LET g_qryparam.arg1 = g_today  
               CALL q_ooeg001() 
            END IF  

            LET g_xcea_m.xcea007 = g_qryparam.return1              
 
            CALL s_desc_get_department_desc(g_xcea_m.xcea007) RETURNING g_xcea_m.xcea007_desc
            DISPLAY g_xcea_m.xcea007 TO xcea007              #
            DISPLAY g_xcea_m.xcea007_desc TO xcea007_desc  
            
            NEXT FIELD xcea007                          #返回原欄位


            #END add-point
 
 
 #欄位開窗
 
         AFTER INPUT
            #add-point:單頭輸入後處理 name="input.after_input"
            IF INT_FLAG THEN
               RETURN '',''
            END IF
#检查成本计算类型，取消，关闭时不用检查，只有按确定才会检查
            IF NOT cl_null(g_xcea_m.xcea003) THEN 
               #檢查是否存在于 成本類型設置檔 中
               IF NOT ap_chk_isExist(g_xcea_m.xcea003,"SELECT COUNT(*) FROM xcat_t WHERE "||"xcatent = '" ||g_enterprise|| "' AND "||"xcat001 = ? ",'agl-00194',1) THEN
                  LET g_xcea_m.xcea003 = ''
                  CALL axct701_01_get_xcea003_desc()                  
                  NEXT FIELD xceald
               END IF
               
               #檢查是否 有效
#               IF NOT ap_chk_isExist(g_xcea_m.xcea003,"SELECT COUNT(*) FROM xcat_t WHERE "||"xcatent = '" ||g_enterprise|| "' AND "||"xcat001 = ? AND xcatstus = 'Y' ",'agl-00195',1) THEN   #160318-00005#47  mark
               IF NOT ap_chk_isExist(g_xcea_m.xcea003,"SELECT COUNT(*) FROM xcat_t WHERE "||"xcatent = '" ||g_enterprise|| "' AND "||"xcat001 = ? AND xcatstus = 'Y' ",'sub-01302','axci100') THEN   #160318-00005#47   add
                  LET g_xcea_m.xcea003 = ''
                  CALL axct701_01_get_xcea003_desc()                  
                  NEXT FIELD xceald
               END IF  
            ELSE
               INITIALIZE g_errparam TO NULL
               LET g_errparam.code = 'axc-00706'
               LET g_errparam.extend = ''
               LET g_errparam.popup = TRUE
               CALL cl_err()
               NEXT FIELD xceald            
            END IF
            #end add-point
            
      END INPUT
    
      #add-point:自定義input name="input.more_input"
      #160106-00014#1--add---begin---
      #差異科目類型的QBE
      CONSTRUCT BY NAME g_wc ON xcan001
      
          BEFORE CONSTRUCT
          
          ON ACTION controlp INFIELD xcan001
            #add-point:ON ACTION controlp INFIELD xcan001
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c' 
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.where = " xcanld = '",g_xcea_m.xceald,"' "
            CALL q_xcan001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xcan001  #顯示到畫面上
            NEXT FIELD xcan001                     #返回原欄位
    
          
      END CONSTRUCT
      #160106-00014#1--add---end---
      #161124-00011#2-add-s
      CONSTRUCT BY NAME g_wc2 ON xcco009,xcco010
      
          BEFORE CONSTRUCT
          
          ON ACTION controlp INFIELD xcco009
            #add-point:ON ACTION controlp INFIELD xcco009
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c' 
            LET g_qryparam.reqry = FALSE
            CALL q_xcco009()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xcco009  #顯示到畫面上
            NEXT FIELD xcco009                     #返回原欄位
    
          
      END CONSTRUCT
      #161124-00011#2-add-e
      #end add-point
    
      #公用action
      ON ACTION accept
         ACCEPT DIALOG
        
      ON ACTION cancel
         LET INT_FLAG = TRUE 
         EXIT DIALOG
 
      ON ACTION close
         LET INT_FLAG = TRUE 
         EXIT DIALOG
 
      ON ACTION exit
         LET INT_FLAG = TRUE 
         EXIT DIALOG
   
      #交談指令共用ACTION
      &include "common_action.4gl" 
         CONTINUE DIALOG 
   END DIALOG
 
   #add-point:畫面關閉前 name="input.before_close"
   
   #end add-point
   
   #畫面關閉
   CLOSE WINDOW w_axct701_01 
   
   #add-point:input段after input name="input.post_input"
   IF INT_FLAG THEN
      RETURN '',''
   END IF

   CALL axct701_01_create_tmp()  #170324-00054#1 add
   
   CALL s_transaction_begin()
   CALL cl_err_collect_init() #汇总错误讯息初始化
   #160607-00026#1-s-add
   #161109-00085#20-s mod
#   LET l_sql = "SELECT * FROM glad_t ",   #161109-00085#20-s mark
   #161109-00085#63 --s mark
   #LET l_sql = "SELECT gladent,gladownid,gladowndp,gladcrtid,gladcrtdp,gladcrtdt,gladmodid,gladmoddt,
   #                    gladstus,gladld,glad001,glad002,glad003,glad004,glad005,glad006,glad007,glad008,
   #                    glad009,glad010,glad011,glad012,glad013,glad014,glad015,glad016,glad017,glad0171,
   #                    glad0172,glad018,glad0181,glad0182,glad019,glad0191,glad0192,glad020,glad0201,
   #                    glad0202,glad021,glad0211,glad0212,glad022,glad0221,glad0222,glad023,glad0231,
   #                    glad0232,glad024,glad0241,glad0242,glad025,glad0251,glad0252,glad026,glad0261,
   #                    glad0262,glad027,glad030,glad031,glad032,glad033,glad034,glad035,glad036 
   #               FROM glad_t ",
   #161109-00085#63 --e mark
   #161109-00085#63 --s add
   LET l_sql = " SELECT gladent,gladownid,gladowndp,gladcrtid,gladcrtdp, ",
               "        gladcrtdt,gladmodid,gladmoddt,gladstus,gladld,",
               "        glad001,glad002,glad003,glad004,glad005, ",
               "        glad006,glad007,glad008,glad009,glad010, ",
               "        glad011,glad012,glad013,glad014,glad015, ",
               "        glad016,glad017,glad0171,glad0172,glad018, ",
               "        glad0181,glad0182,glad019,glad0191,glad0192, ",
               "        glad020,glad0201,glad0202,glad021,glad0211, ",
               "        glad0212,glad022,glad0221,glad0222,glad023, ",
               "        glad0231,glad0232,glad024,glad0241,glad0242, ",
               "        glad025,glad0251,glad0252,glad026,glad0261, ",
               "        glad0262,glad027,glad030,glad031,glad032, ",
               "        glad033,glad034,gladud001,gladud002,gladud003, ",
               "        gladud004,gladud005,gladud006,gladud007,gladud008, ",
               "        gladud009,gladud010,gladud011,gladud012,gladud013, ",
               "        gladud014,gladud015,gladud016,gladud017,gladud018, ",
               "        gladud019,gladud020,gladud021,gladud022,gladud023, ",
               "        gladud024,gladud025,gladud026,gladud027,gladud028, ",
               "        gladud029,gladud030,glad035,glad036 ",
               "   FROM glad_t ",
   #161109-00085#63 --e add
   #161109-00085#20-e mod
               " WHERE gladent = ",g_enterprise,
               "   AND gladld  = ?  AND glad001 = ? "
    DECLARE axct701_01_glad_prep CURSOR FROM l_sql 
   #160607-00026#1-e-add

   CASE g_xcea002
      WHEN '1'   #axct701
         CALL axct701_01_check('1') RETURNING l_success
         IF l_success = TRUE THEN 
            CALL axct701_01_ins() RETURNING l_success
         END IF
      WHEN '2'   #axct702
         CALL axct701_01_check('2') RETURNING l_success
         IF l_success = TRUE THEN
            CALL axct701_01_ins_2() RETURNING l_success
         END IF
      WHEN '3'   #axct703
         CALL axct701_01_check('3') RETURNING l_success
         IF l_success = TRUE THEN
            CALL axct701_01_ins_3() RETURNING l_success
         END IF
      WHEN '4'   #axct704
         CALL axct701_01_check('4') RETURNING l_success
         IF l_success = TRUE THEN
            CALL axct701_01_ins_4() RETURNING l_success
         END IF
      WHEN '5'   #axct705
         CALL axct701_01_check('5') RETURNING l_success
         IF l_success = TRUE THEN
            CALL axct701_01_ins_5() RETURNING l_success
         END IF
      WHEN '6'   #axct706
         CALL axct701_01_check('6') RETURNING l_success
         IF l_success = TRUE THEN
            CALL axct701_01_ins_6() RETURNING l_success
         END IF
      WHEN '7'   #axct707
         CALL axct701_01_check('7') RETURNING l_success
         IF l_success = TRUE THEN
            CALL axct701_01_ins_7() RETURNING l_success
         END IF
      WHEN '8'   #axct708
         CALL axct701_01_check('8') RETURNING l_success
         IF l_success = TRUE THEN
            CALL axct701_01_ins_8() RETURNING l_success
         END IF
      WHEN '9'   #axct709
         CALL axct701_01_check('9') RETURNING l_success
         IF l_success = TRUE THEN
            CALL axct701_01_ins_9() RETURNING l_success
         END IF
      WHEN '10'  #axct710
         CALL axct701_01_check('10') RETURNING l_success
         IF l_success = TRUE THEN
            CALL axct701_01_ins_10() RETURNING l_success
         END IF
      #add zhangllc 151009 --begin
      WHEN '11'  #axct711
         CALL axct701_01_check('11') RETURNING l_success
         IF l_success = TRUE THEN
            CALL axct701_01_ins_11() RETURNING l_success
         END IF
      WHEN '12'  #axct712
         CALL axct701_01_check('12') RETURNING l_success
         IF l_success = TRUE THEN
            CALL axct701_01_ins_11() RETURNING l_success
         END IF
      #add zhangllc 151009 --end
      #add zhujing 2015-12-16 --begin
      WHEN '13'  #axct713
         CALL axct701_01_check('13') RETURNING l_success
         IF l_success = TRUE THEN
            CALL axct701_01_ins_13() RETURNING l_success
         END IF
      WHEN '14'  #axct714
         CALL axct701_01_check('14') RETURNING l_success
         IF l_success = TRUE THEN
            CALL axct701_01_ins_14() RETURNING l_success
         END IF
      #add zhujing 2015-12-16 --end
      #160907-00003#6---add---s
      WHEN '15'  #axct715
         CALL axct701_01_check('15') RETURNING l_success
         IF l_success = TRUE THEN
            CALL axct701_01_ins_15() RETURNING l_success
         END IF
      #160907-00003#6---add---e
      #160106-00014#1--add---begin---
      #160617-00002#4 mod-S
#      WHEN '15'   #axct716
#         CALL axct701_01_check('15') RETURNING l_success
      WHEN '16'   #axct716
         CALL axct701_01_check('16') RETURNING l_success
         IF l_success = TRUE THEN
#            CALL axct701_01_ins_15() RETURNING l_success
            CALL axct701_01_ins_16() RETURNING l_success
         END IF
      #160617-00002#4 mod-E
      #160106-00014#1--add---end---
      #160816-00041#2-s-add
      WHEN '17'   #axct716
         CALL axct701_01_check('17') RETURNING l_success
         IF l_success = TRUE THEN
            CALL axct701_01_ins_17() RETURNING l_success
         END IF
      #160816-00041#2-e-add
      #170217-00057#1 add ------
      WHEN '19'   #axct719
         CALL axct701_01_check('18') RETURNING l_success
         IF l_success = TRUE THEN
            CALL axct701_01_ins_19() RETURNING l_success
         END IF
      #170217-00057#1 add end---
   END CASE
   
   FREE axct701_01_glad_prep #160607-00026#1
   
   CALL axct701_01_del_all() RETURNING l_success   #没有单身，则删除单头，同时提示无资料产生
   IF l_success = 'Y' THEN      
      CALL s_transaction_end('Y','0')
   ELSE
      CALL s_transaction_end('N','0')
   END IF
   CALL cl_err_collect_show()
   IF l_success = 'Y' THEN
      RETURN g_xcea_m.xceald,g_xcea_m.xceadocno
   ELSE
      RETURN '',''
   END IF
   #end add-point    
   
END FUNCTION
 
{</section>}
 
{<section id="axct701_01.other_dialog" readonly="Y" >}

 
{</section>}
 
{<section id="axct701_01.other_function" readonly="Y" >}

################################################################################
# Descriptions...: 獲取帳套說明
# Memo...........:
# Usage..........: CALL axct701_01_get_xceald_desc()
# Input parameter:  
# Return code....:  
# Date & Author..: 2014/4/16 By 01531
# Modify.........:
################################################################################
PRIVATE FUNCTION axct701_01_get_xceald_desc()
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xcea_m.xceald
            CALL ap_ref_array2(g_ref_fields,"SELECT glaal002 FROM glaal_t WHERE glaalent='"||g_enterprise||"' AND glaalld=? AND glaal001='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xcea_m.xceald_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xcea_m.xceald_desc
END FUNCTION

################################################################################
# Descriptions...: 默認帶出帳套的所屬法人
# Memo...........:
# Usage..........: CALL axct701_01_get_xceacomp()
# Input parameter:  
# Return code....:  
# Date & Author..: 2014/4/16 By 01531
# Modify.........:
################################################################################
PRIVATE FUNCTION axct701_01_get_xceacomp()
   SELECT glaacomp INTO g_xcea_m.xceacomp FROM glaa_t
    WHERE glaaent = g_enterprise
      AND glaald = g_xcea_m.xceald
   CALL axct701_01_get_xceacomp_desc()   
   DISPLAY BY NAME g_xcea_m.xceacomp,g_xcea_m.xceacomp_desc

   LET g_xcea_m_o.xceacomp = g_xcea_m.xceacomp   #160824-00007#365 170116 by lori add
END FUNCTION

################################################################################
# Descriptions...: 獲取成本計算類型說明
# Memo...........:
# Usage..........: CALL axct701_01_get_xcea003_desc()
# Input parameter:  
# Return code....:  
# Date & Author..: 2014/4/16 By 01531
# Modify.........:
################################################################################
PRIVATE FUNCTION axct701_01_get_xcea003_desc()
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xcea_m.xcea003
            CALL ap_ref_array2(g_ref_fields,"SELECT xcatl003 FROM xcatl_t WHERE xcatlent='"||g_enterprise||"' AND xcatl001=? AND xcatl002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xcea_m.xcea003_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xcea_m.xcea003_desc
END FUNCTION

################################################################################
# Descriptions...: 根據帳套獲取相關資料
# Memo...........:
# Usage..........: CALL axct701_01_get_glaa()
# Input parameter:  
# Return code....:  
# Date & Author..: 2014/4/16 By 01531
# Modify.........:
################################################################################
PRIVATE FUNCTION axct701_01_get_glaa()
   #會計週期參照表、會計科目參照表、單據別參照表
   SELECT glaa001,glaa003,glaa004,glaa015,glaa016,glaa017,glaa018,glaa019,glaa020,glaa021,glaa022,glaa024,glaa120       #160920-00002#1 add glaa017,glaa021
     INTO g_glaa001,g_glaa003,g_glaa004,g_glaa015,g_glaa017,g_glaa016,g_glaa018,g_glaa019,g_glaa020,g_glaa021,g_glaa022,g_glaa024,g_xcea_m.xcea003   #160920-00002#1 add glaa017,glaa021
     FROM glaa_t
    WHERE glaaent = g_enterprise 
      AND glaald = g_xcea_m.xceald  


    INITIALIZE g_ref_fields TO NULL
    LET g_ref_fields[1] = g_xcea_m.xcea003
    CALL ap_ref_array2(g_ref_fields,"SELECT xcatl003 FROM xcatl_t WHERE xcatlent='"||g_enterprise||"' AND xcatl001=? AND xcatl002='"||g_dlang||"'","") RETURNING g_rtn_fields
    LET g_xcea_m.xcea003_desc = '', g_rtn_fields[1] , ''
    DISPLAY BY NAME g_xcea_m.xcea003_desc
    
    LET g_xcea_m_o.xcea003 = g_xcea_m.xcea003   #160824-00007#365 170116 by lori add
END FUNCTION

################################################################################
# Descriptions...: 建立临时表
# Memo...........:
# Usage..........: CALL axct701_01_create_tmp()
#                  RETURNING 
# Input parameter: 
# Return code....: 
# Date & Author..: 2016/12/20 By 01727
# Modify.........: 161215-00040#1
################################################################################
PRIVATE FUNCTION axct701_01_create_tmp()

   DROP TABLE sourse_ins_tmp
   CREATE TEMP TABLE sourse_ins_tmp(
      xcebent        LIKE xceb_t.xcebent,
      xcebcomp       LIKE xceb_t.xcebcomp,
      xcebld         LIKE xceb_t.xcebld,
      xcebdocno      LIKE xceb_t.xcebdocno,
      xcebseq        LIKE xceb_t.xcebseq,
      xceb001        LIKE xceb_t.xceb001,
      xceb002        LIKE xceb_t.xceb002,
      xceb003        LIKE xceb_t.xceb003,
      xceb004        LIKE xceb_t.xceb004,
      xceb005        LIKE xceb_t.xceb005,
      xceb101        LIKE xceb_t.xceb101,
      xceb102        LIKE xceb_t.xceb102,
      xceb103        LIKE xceb_t.xceb103,
      xceb110        LIKE xceb_t.xceb110,
      xceb111        LIKE xceb_t.xceb111,
      xceb112        LIKE xceb_t.xceb112,
      xceb113        LIKE xceb_t.xceb113,
      xceb114        LIKE xceb_t.xceb114,
      xceb115        LIKE xceb_t.xceb115,
      xceb116        LIKE xceb_t.xceb116,
      xceb117        LIKE xceb_t.xceb117,
      xceb118        LIKE xceb_t.xceb118,
      xceb119        LIKE xceb_t.xceb119,
      xceb120        LIKE xceb_t.xceb120,
      xceb201        LIKE xceb_t.xceb201,
      xceb202        LIKE xceb_t.xceb202,
      xceb202a       LIKE xceb_t.xceb202a,
      xceb202b       LIKE xceb_t.xceb202b,
      xceb202c       LIKE xceb_t.xceb202c,
      xceb202d       LIKE xceb_t.xceb202d,
      xceb202e       LIKE xceb_t.xceb202e,
      xceb202f       LIKE xceb_t.xceb202f,
      xceb202g       LIKE xceb_t.xceb202g,
      xceb202h       LIKE xceb_t.xceb202h,
      xceb212        LIKE xceb_t.xceb212,
      xceb212a       LIKE xceb_t.xceb212a,
      xceb212b       LIKE xceb_t.xceb212b,
      xceb212c       LIKE xceb_t.xceb212c,
      xceb212d       LIKE xceb_t.xceb212d,
      xceb212e       LIKE xceb_t.xceb212e,
      xceb212f       LIKE xceb_t.xceb212f,
      xceb212g       LIKE xceb_t.xceb212g,
      xceb212h       LIKE xceb_t.xceb212h,
      xceb222        LIKE xceb_t.xceb222,
      xceb222a       LIKE xceb_t.xceb222a,
      xceb222b       LIKE xceb_t.xceb222b,
      xceb222c       LIKE xceb_t.xceb222c,
      xceb222d       LIKE xceb_t.xceb222d,
      xceb222e       LIKE xceb_t.xceb222e,
      xceb222f       LIKE xceb_t.xceb222f,
      xceb222g       LIKE xceb_t.xceb222g,
      xceb222h       LIKE xceb_t.xceb222h,
      xceb301        LIKE xceb_t.xceb301,
      xceb302        LIKE xceb_t.xceb302,
      xceb107        LIKE xceb_t.xceb107,
      xceb108        LIKE xceb_t.xceb108,
      xceb109        LIKE xceb_t.xceb109,
      xceb121        LIKE xceb_t.xceb121,
      xceb122        LIKE xceb_t.xceb122,
      xceb123        LIKE xceb_t.xceb123,
      xceb124        LIKE xceb_t.xceb124,
      xceb125        LIKE xceb_t.xceb125,
      xceb126        LIKE xceb_t.xceb126,
      xceb127        LIKE xceb_t.xceb127,
      xceb128        LIKE xceb_t.xceb128,
      xceb129        LIKE xceb_t.xceb129,
      xceb130        LIKE xceb_t.xceb130,
      xceb131        LIKE xceb_t.xceb131,
      xceb132        LIKE xceb_t.xceb132,
      sfaa009        LIKE sfaa_t.sfaa009,
      sfaasite       LIKE sfaa_t.sfaasite,
      sfaa028        LIKE sfaa_t.sfaa028,
      sfaa029        LIKE sfaa_t.sfaa029,
      sfaa052        LIKE sfaa_t.sfaa052,
      sfaa057        LIKE sfaa_t.sfaa057
   )

   DROP TABLE sourse_ins_tmp1
   CREATE TEMP TABLE sourse_ins_tmp1(
      xcecent        LIKE xcec_t.xcecent,
      xceccomp       LIKE xcec_t.xceccomp,
      xcecld         LIKE xcec_t.xcecld,
      xcecdocno      LIKE xcec_t.xcecdocno,
      xcecseq        LIKE xcec_t.xcecseq,
      xcec001        LIKE xcec_t.xcec001,
      xcec002        LIKE xcec_t.xcec002,
      xcec003        LIKE xcec_t.xcec003,
      xcec004        LIKE xcec_t.xcec004,
      xcec005        LIKE xcec_t.xcec005,
      xcec101        LIKE xcec_t.xcec101,
      xcec102        LIKE xcec_t.xcec102,
      xcec103        LIKE xcec_t.xcec103,
      xcec110        LIKE xcec_t.xcec110,
      xcec111        LIKE xcec_t.xcec111,
      xcec112        LIKE xcec_t.xcec112,
      xcec113        LIKE xcec_t.xcec113,
      xcec114        LIKE xcec_t.xcec114,
      xcec115        LIKE xcec_t.xcec115,
      xcec116        LIKE xcec_t.xcec116,
      xcec117        LIKE xcec_t.xcec117,
      xcec118        LIKE xcec_t.xcec118,
      xcec119        LIKE xcec_t.xcec119,
      xcec120        LIKE xcec_t.xcec120,
      xcec201        LIKE xcec_t.xcec201,
      xcec202        LIKE xcec_t.xcec202,
      xcec202a       LIKE xcec_t.xcec202a,
      xcec202b       LIKE xcec_t.xcec202b,
      xcec202c       LIKE xcec_t.xcec202c,
      xcec202d       LIKE xcec_t.xcec202d,
      xcec202e       LIKE xcec_t.xcec202e,
      xcec202f       LIKE xcec_t.xcec202f,
      xcec202g       LIKE xcec_t.xcec202g,
      xcec202h       LIKE xcec_t.xcec202h,
      xcec212        LIKE xcec_t.xcec212,
      xcec212a       LIKE xcec_t.xcec212a,
      xcec212b       LIKE xcec_t.xcec212b,
      xcec212c       LIKE xcec_t.xcec212c,
      xcec212d       LIKE xcec_t.xcec212d,
      xcec212e       LIKE xcec_t.xcec212e,
      xcec212f       LIKE xcec_t.xcec212f,
      xcec212g       LIKE xcec_t.xcec212g,
      xcec212h       LIKE xcec_t.xcec212h,
      xcec222        LIKE xcec_t.xcec222,
      xcec222a       LIKE xcec_t.xcec222a,
      xcec222b       LIKE xcec_t.xcec222b,
      xcec222c       LIKE xcec_t.xcec222c,
      xcec222d       LIKE xcec_t.xcec222d,
      xcec222e       LIKE xcec_t.xcec222e,
      xcec222f       LIKE xcec_t.xcec222f,
      xcec222g       LIKE xcec_t.xcec222g,
      xcec222h       LIKE xcec_t.xcec222h,
      xcec301        LIKE xcec_t.xcec301,
      xcec302        LIKE xcec_t.xcec302,
      xcec107        LIKE xcec_t.xcec107,
      xcec108        LIKE xcec_t.xcec108,
      xcec109        LIKE xcec_t.xcec109,
      xcec121        LIKE xcec_t.xcec121,
      xcec122        LIKE xcec_t.xcec122,
      xcec123        LIKE xcec_t.xcec123,
      xcec124        LIKE xcec_t.xcec124,
      xcec125        LIKE xcec_t.xcec125,
      xcec126        LIKE xcec_t.xcec126,
      xcec127        LIKE xcec_t.xcec127,
      xcec128        LIKE xcec_t.xcec128,
      xcec129        LIKE xcec_t.xcec129,
      xcec130        LIKE xcec_t.xcec130,
      sfaa009        LIKE sfaa_t.sfaa009,
      sfaasite       LIKE sfaa_t.sfaasite,
      sfaa028        LIKE sfaa_t.sfaa028,
      sfaa029        LIKE sfaa_t.sfaa029,
      sfaa052        LIKE sfaa_t.sfaa052,
      sfaa057        LIKE sfaa_t.sfaa057
   )

   DROP TABLE sourse_ins_tmp3
   CREATE TEMP TABLE sourse_ins_tmp3(
xcecent        LIKE xcec_t.xcecent,
xceccomp       LIKE xcec_t.xceccomp,
xcecld         LIKE xcec_t.xcecld,
xcecdocno      LIKE xcec_t.xcecdocno,
xcec102        LIKE xcec_t.xcec102,
xcec114        LIKE xcec_t.xcec114,
xcec113        LIKE xcec_t.xcec113,
xcec111        LIKE xcec_t.xcec111,
xcec117        LIKE xcec_t.xcec117,
xcec119        LIKE xcec_t.xcec119,
xcec120        LIKE xcec_t.xcec120,
xcec108        LIKE xcec_t.xcec108, #170215-00035#1 add
xcec202b       LIKE xcec_t.xcec202b,
xcec202c       LIKE xcec_t.xcec202c,
xcec202d       LIKE xcec_t.xcec202d,
xcec202e       LIKE xcec_t.xcec202e,
xcec202f       LIKE xcec_t.xcec202f,
xcec202g       LIKE xcec_t.xcec202g,
xcec202h       LIKE xcec_t.xcec202h,
xcec212b       LIKE xcec_t.xcec212b,
xcec212c       LIKE xcec_t.xcec212c,
xcec212d       LIKE xcec_t.xcec212d,
xcec212e       LIKE xcec_t.xcec212e,
xcec212f       LIKE xcec_t.xcec212f,
xcec212g       LIKE xcec_t.xcec212g,
xcec212h       LIKE xcec_t.xcec212h,
xcec222b       LIKE xcec_t.xcec222b,
xcec222c       LIKE xcec_t.xcec222c,
xcec222d       LIKE xcec_t.xcec222d,
xcec222e       LIKE xcec_t.xcec222e,
xcec222f       LIKE xcec_t.xcec222f,
xcec222g       LIKE xcec_t.xcec222g,
xcec222h       LIKE xcec_t.xcec222h,
xcec101        LIKE xcec_t.xcec101,
flag           LIKE type_t.chr10
   )

END FUNCTION

################################################################################
# Descriptions...: 獲取法人說明
# Memo...........:
# Usage..........: CALL  axct701_01_get_xceacomp_desc()
# Input parameter:  
# Return code....:  
# Date & Author..: 2014/4/16 By 01531
# Modify.........:
################################################################################
PRIVATE FUNCTION axct701_01_get_xceacomp_desc()
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xcea_m.xceacomp
            CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xcea_m.xceacomp_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xcea_m.xceacomp_desc
END FUNCTION

################################################################################
# Descriptions...: 新增xced
# Memo...........:
# Usage..........: CALL axct701_01_ins_xced()
# Input parameter:  
# Return code....:  
# Date & Author..: 2014/4/20 By 01531
# Modify.........:
################################################################################
PRIVATE FUNCTION axct701_01_ins_xced()
#161215-00040#1 Add  ---(S)---   因效能优化,程序逻辑完全重写,旧代码保存在axct701_01_ins_xced_bak中
DEFINE l_success       LIKE type_t.num5
DEFINE l_errno         LIKE gzze_t.gzze001

   CASE  
      WHEN g_xcea002='1'   #axct701
      #xcec_t中ADJUST元件彙總-xced
         LET g_sql = "INSERT INTO sourse_ins_tmp3(xcecent,xceccomp,xcecld,xcecdocno,
                            xcec102,xcec114,xcec113,xcec111,xcec117,xcec119,xcec120,
                            xcec202b,xcec202c,xcec202d,xcec202e,xcec202f,xcec202g,xcec202h,
                            xcec212b,xcec212c,xcec212d,xcec212e,xcec212f,xcec212g,xcec212h,
                            xcec222b,xcec222c,xcec222d,xcec222e,xcec222f,xcec222g,xcec222h,xcec101,flag)",               
                     " SELECT xcecent,xceccomp,xcecld,xcecdocno,xcec102,xcec114,xcec113,xcec111,xcec117,xcec119,xcec120,",
                     "        SUM(xcec202b) xcec202b,SUM(xcec202c) xcec202c,SUM(xcec202d) xcec202d,SUM(xcec202e) xcec202e,",
                     "        SUM(xcec202f) xcec202f,SUM(xcec202g) xcec202g,SUM(xcec202h) xcec202h, ",
                     "        SUM(xcec212b) xcec212b,SUM(xcec212c) xcec212c,SUM(xcec212d) xcec212d,SUM(xcec212e) xcec212e,",
                     "        SUM(xcec212f) xcec212f,SUM(xcec212g) xcec212g,SUM(xcec212h) xcec212h, ",
                     "        SUM(xcec222b) xcec222b,SUM(xcec222c) xcec222c,SUM(xcec222d) xcec222d,SUM(xcec222e) xcec222e,",
                     "        SUM(xcec222f) xcec222f,SUM(xcec222g) xcec222g,SUM(xcec222h) xcec222h, ",
                     "        (SELECT glab005 FROM glab_t WHERE glabent = xcecent AND glabld = xcecld AND glab001 = '60' AND glab002 = '8912' AND glab003 = ?),?",
                     "   FROM xcec_t",
                     "  WHERE xcecent = '",g_enterprise,"' AND xcecld = '",g_xcea_m.xceald,"'",
                     "    AND xcecdocno = '",g_xcea_m.xceadocno,"'", 
                     "    AND xcec004 = 'ADJUST' ",
                     "  GROUP BY xcecent,xceccomp,xcecld,xcecdocno,xcec102,xcec114,xcec113,xcec111,xcec117,xcec119,xcec120 ",
                     "  ORDER BY xcec102,xcec114,xcec113,xcec111,xcec117,xcec119,xcec120 "
         PREPARE axct701_01_ins_tmp3 FROM g_sql
         EXECUTE axct701_01_ins_tmp3 USING '2' ,'1'
         EXECUTE axct701_01_ins_tmp3 USING '15','2'
         EXECUTE axct701_01_ins_tmp3 USING '3' ,'3'
         EXECUTE axct701_01_ins_tmp3 USING '11','4'
         EXECUTE axct701_01_ins_tmp3 USING '12','5'
         EXECUTE axct701_01_ins_tmp3 USING '13','6'
         EXECUTE axct701_01_ins_tmp3 USING '14','7'

         LET g_sql = "INSERT INTO xced_t( xcedent,xcedcomp, xcedld,xceddocno,xcedseq, ",
                     "                    xced001, xced101,xced102,  xced110,xced111, ",
                     "                    xced112, xced113,xced114,  xced115,xced116, ",
                     "                    xced117, xced118,xced119,  xced120,xced202, ",
                     "                    xced212, xced222,xced301,  xced107,xced108, ",
                     "                    xced109, xced121,xced122,  xced123,xced124, ",
                     "                    xced125, xced126,xced127,  xced128,xced129, ",
                     "                    xced130, xced302)",
                     " SELECT xcecent,xceccomp,xcecld,xcecdocno,rownum,
                            1,xcec101,xcec102,'',xcec111,
                            '',xcec113,xcec114,'','',
                            xcec117,'',xcec119,xcec120,
                            CASE WHEN flag = '1' THEN xcec202b WHEN flag = '2' THEN xcec202c WHEN flag = '3' THEN xcec202d WHEN flag = '4' THEN xcec202e WHEN flag = '5' THEN xcec202f WHEN flag = '6' THEN xcec202g WHEN flag = '7' THEN xcec202h ELSE 0 END,
                            CASE WHEN flag = '1' THEN xcec212b WHEN flag = '2' THEN xcec212c WHEN flag = '3' THEN xcec212d WHEN flag = '4' THEN xcec212e WHEN flag = '5' THEN xcec212f WHEN flag = '6' THEN xcec212g WHEN flag = '7' THEN xcec212h ELSE 0 END,
                            CASE WHEN flag = '1' THEN xcec222b WHEN flag = '2' THEN xcec222c WHEN flag = '3' THEN xcec222d WHEN flag = '4' THEN xcec222e WHEN flag = '5' THEN xcec222f WHEN flag = '6' THEN xcec222g WHEN flag = '7' THEN xcec222h ELSE 0 END,
                            '','','','','','','','','','','','','','',''
                         FROM sourse_ins_tmp3
                       ORDER BY xcec102,xcec114,xcec113,xcec111,xcec117,xcec119,xcec120 "
         PREPARE axct701_ins_xced FROM g_sql
         EXECUTE axct701_ins_xced

      WHEN g_xcea002='2' OR g_xcea002='5'  #axct702,axct705
         #xcec_t中DL+OH_SUB元件彙總-xced  
         LET g_sql = "INSERT INTO sourse_ins_tmp3(xcecent,xceccomp,xcecld,xcecdocno,
                            xcec102,xcec114,xcec113,xcec111,xcec117,xcec119,xcec120,
                            xcec202b,xcec202c,xcec202d,xcec202e,xcec202f,xcec202g,xcec202h,
                            xcec212b,xcec212c,xcec212d,xcec212e,xcec212f,xcec212g,xcec212h,
                            xcec222b,xcec222c,xcec222d,xcec222e,xcec222f,xcec222g,xcec222h,xcec101,xcec108,flag)", #170215-00035#1 add xcec108              
                     " SELECT xcecent,xceccomp,xcecld,xcecdocno,xcec102,xcec114,xcec113,xcec111,xcec117,xcec119,xcec120,",
                     "        SUM(xcec202b) xcec202b,SUM(xcec202c) xcec202c,SUM(xcec202d) xcec202d,SUM(xcec202e) xcec202e,",
                     "        SUM(xcec202f) xcec202f,SUM(xcec202g) xcec202g,SUM(xcec202h) xcec202h, ",
                     "        SUM(xcec212b) xcec212b,SUM(xcec212c) xcec212c,SUM(xcec212d) xcec212d,SUM(xcec212e) xcec212e,",
                     "        SUM(xcec212f) xcec212f,SUM(xcec212g) xcec212g,SUM(xcec212h) xcec212h, ",
                     "        SUM(xcec222b) xcec222b,SUM(xcec222c) xcec222c,SUM(xcec222d) xcec222d,SUM(xcec222e) xcec222e,",
                     "        SUM(xcec222f) xcec222f,SUM(xcec222g) xcec222g,SUM(xcec222h) xcec222h, ",
                     "        (SELECT glab005 FROM glab_t WHERE glabent = xcecent AND glabld = xcecld AND glab001 = '60' AND glab002 = '8912' AND glab003 = ?),xcec108,?",#170215-00035#1 add xcec108
                     "   FROM xcec_t",
                     "  WHERE xcecent = '",g_enterprise,"' AND xcecld = '",g_xcea_m.xceald,"'",
                     "    AND xcecdocno = '",g_xcea_m.xceadocno,"'", 
                     "    AND xcec004 = 'DL+OH+SUB' ",
                     "  GROUP BY xcecent,xceccomp,xcecld,xcecdocno,xcec102,xcec114,xcec113,xcec111,xcec117,xcec119,xcec120,xcec108 ", #170215-00035#1 add xcec108
                     "  ORDER BY xcec102,xcec114,xcec113,xcec111,xcec117,xcec119,xcec120,xcec108 "   #170215-00035#1 
         PREPARE axct701_01_ins_tmp7 FROM g_sql
         EXECUTE axct701_01_ins_tmp7 USING '2' ,'1'
         EXECUTE axct701_01_ins_tmp7 USING '15','2'
         EXECUTE axct701_01_ins_tmp7 USING '3' ,'3'
         EXECUTE axct701_01_ins_tmp7 USING '11','4'
         EXECUTE axct701_01_ins_tmp7 USING '12','5'
         EXECUTE axct701_01_ins_tmp7 USING '13','6'
         EXECUTE axct701_01_ins_tmp7 USING '14','7'

        #170215-00035#1 ---add (s)--- 不需要部门的改为空格
         LET g_sql =     " MERGE INTO sourse_ins_tmp3                               ",
                         " USING (SELECT glad001,glad007 FROM glad_t       ",
                         " WHERE gladent = ",g_enterprise,
                         "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                         "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad007 = 'N'   ) ",
                         "    WHEN MATCHED THEN                            ",
                         "    UPDATE SET xcec108 = ' '"
         PREPARE axct701_01_meg_xced108 FROM g_sql
         EXECUTE axct701_01_meg_xced108
        #170215-00035#1 ---add (e)--- 

         LET g_sql = "INSERT INTO xced_t( xcedent,xcedcomp, xcedld,xceddocno,xcedseq, ",
                     "                    xced001, xced101,xced102,  xced110,xced111, ",
                     "                    xced112, xced113,xced114,  xced115,xced116, ",
                     "                    xced117, xced118,xced119,  xced120,xced202, ",
                     "                    xced212, xced222,xced301,  xced107,xced108, ",
                     "                    xced109, xced121,xced122,  xced123,xced124, ",
                     "                    xced125, xced126,xced127,  xced128,xced129, ",
                     "                    xced130, xced302)",
                     " SELECT xcecent,xceccomp,xcecld,xcecdocno,rownum,
                            1,xcec101,xcec102,'',xcec111,
                            '',xcec113,xcec114,'','',
                            xcec117,'',xcec119,xcec120,
                            CASE WHEN flag = '1' THEN xcec202b WHEN flag = '2' THEN xcec202c WHEN flag = '3' THEN xcec202d WHEN flag = '4' THEN xcec202e WHEN flag = '5' THEN xcec202f WHEN flag = '6' THEN xcec202g WHEN flag = '7' THEN xcec202h ELSE 0 END,
                            CASE WHEN flag = '1' THEN xcec212b WHEN flag = '2' THEN xcec212c WHEN flag = '3' THEN xcec212d WHEN flag = '4' THEN xcec212e WHEN flag = '5' THEN xcec212f WHEN flag = '6' THEN xcec212g WHEN flag = '7' THEN xcec212h ELSE 0 END,
                            CASE WHEN flag = '1' THEN xcec222b WHEN flag = '2' THEN xcec222c WHEN flag = '3' THEN xcec222d WHEN flag = '4' THEN xcec222e WHEN flag = '5' THEN xcec222f WHEN flag = '6' THEN xcec222g WHEN flag = '7' THEN xcec222h ELSE 0 END,
                            '','',xcec108,'','','','','','','','','','','','' 
                         FROM sourse_ins_tmp3
                       ORDER BY xcec102,xcec114,xcec113,xcec111,xcec117,xcec119,xcec120,xcec108 "   #170215-00035#1 上面全是空格那行，一个空格改成了xcec108,同时这里也要加上xcec108
         PREPARE axct701_ins_xced2 FROM g_sql
         EXECUTE axct701_ins_xced2

   END CASE

   RETURN g_success 
#161215-00040#1 Add  ---(E)---   因效能优化,程序逻辑完全重写,旧代码保存在axct701_01_ins_xced_bak中
END FUNCTION

################################################################################
# Descriptions...: 组合sql
# Memo...........:
# Usage..........: CALL axct701_01_mark_sql(p_xcck022,p_xcck023,p_xcck024,p_xcck025,p_xcck026,p_xcck027,p_xcck028,p_xcck029,p_xcck030,p_xcck031)
#                  RETURNING r_str
# Input parameter: p_xcck021 原因碼
#                : p_xcck022,p_xcck023,p_xcck024,p_xcck025,p_xcck026,p_xcck027,p_xcck028,p_xcck029,p_xcck030,p_xcck031 核算项
# Return code....: r_str          sql语句
# Date & Author..: 2014/06/04 By wangrr
# Modify.........:
################################################################################
PRIVATE FUNCTION axct701_01_mark_sql(p_xcck021,p_xcck022,p_xcck023,p_xcck024,p_xcck025,p_xcck026,p_xcck027,p_xcck028,p_xcck029,p_xcck030,p_xcck031)
   DEFINE p_xcck021      LIKE xcck_t.xcck021
   DEFINE p_xcck022      LIKE xcck_t.xcck022
   DEFINE p_xcck023      LIKE xcck_t.xcck023
   DEFINE p_xcck024      LIKE xcck_t.xcck024
   DEFINE p_xcck025      LIKE xcck_t.xcck025
   DEFINE p_xcck026      LIKE xcck_t.xcck026
   DEFINE p_xcck027      LIKE xcck_t.xcck027
   DEFINE p_xcck028      LIKE xcck_t.xcck028
   DEFINE p_xcck029      LIKE xcck_t.xcck029
   DEFINE p_xcck030      LIKE xcck_t.xcck030
   DEFINE p_xcck031      LIKE xcck_t.xcck031
   DEFINE r_str          STRING
   
   LET r_str=""
   #原因碼
   IF p_xcck021 IS NULL THEN
      LET r_str=r_str," AND xcck021 IS NULL"
   ELSE
      LET r_str=r_str," AND xcck021 = '",p_xcck021,"'"
   END IF
   #交易對象
   IF p_xcck022 IS NULL THEN
      LET r_str=r_str," AND xcck022 IS NULL"
   ELSE
      LET r_str=r_str," AND xcck022 = '",p_xcck022,"'"
   END IF
   #客群
   IF p_xcck023 IS NULL THEN
      LET r_str=r_str," AND xcck023 IS NULL"
   ELSE
      LET r_str=r_str," AND xcck023 = '",p_xcck023,"'"
   END IF
   #區域
   IF p_xcck024 IS NULL THEN
      LET r_str=r_str," AND xcck024 IS NULL"
   ELSE
      LET r_str=r_str," AND xcck024 = '",p_xcck024,"'"
   END IF
   #成本中心
   IF p_xcck025 IS NULL THEN
      LET r_str=r_str," AND xcck025 IS NULL"
   ELSE
      LET r_str=r_str," AND xcck025 = '",p_xcck025,"'"
   END IF
   #經營類別
   IF p_xcck026 IS NULL THEN
      LET r_str=r_str," AND xcck026 IS NULL"
   ELSE
      LET r_str=r_str," AND xcck026 = '",p_xcck026,"'"
   END IF
   #渠道
   IF p_xcck027 IS NULL THEN
      LET r_str=r_str," AND xcck027 IS NULL"
   ELSE
      LET r_str=r_str," AND xcck027 = '",p_xcck027,"'"
   END IF
   #品類
   IF p_xcck028 IS NULL THEN
      LET r_str=r_str," AND xcck028 IS NULL"
   ELSE
      LET r_str=r_str," AND xcck028 = '",p_xcck028,"'"
   END IF
   #品牌
   IF p_xcck029 IS NULL THEN
      LET r_str=r_str," AND xcck029 IS NULL"
   ELSE
      LET r_str=r_str," AND xcck029 = '",p_xcck029,"'"
   END IF
   #項目編號
   IF p_xcck030 IS NULL THEN
      LET r_str=r_str," AND xcck030 IS NULL"
   ELSE
      LET r_str=r_str," AND xcck030 = '",p_xcck030,"'"
   END IF
   #WBS編號
   IF p_xcck031 IS NULL THEN
      LET r_str=r_str," AND xcck031 IS NULL"
   ELSE
      LET r_str=r_str," AND xcck031 = '",p_xcck031,"'"
   END IF
   RETURN r_str
END FUNCTION

################################################################################
# Descriptions...: 批次產生檢查
# Memo...........:
# Usage..........: CALL axct701_01_check(p_xcea002)
# Input parameter:  
# Date & Author..: 2014/08/28 By 01531
# Modify.........:
################################################################################
PRIVATE FUNCTION axct701_01_check(p_xcea002)
DEFINE l_cnt     LIKE type_t.num5
DEFINE l_cnt1    LIKE type_t.num5
DEFINE l_xceadocno  LIKE xcea_t.xceadocno
DEFINE r_success    LIKE type_t.num5
DEFINE p_xcea002    LIKE xcea_t.xcea002
DEFINE l_success    LIKE type_t.num5
DEFINE l_glaa121    LIKE glaa_t.glaa121
DEFINE l_xcea001    LIKE xcea_t.xcea001

   LET r_success = TRUE

   #檢查是否存在xcea_t中,根據帳套、成本類型、年度、期別、凭证类型
   #1.狀態已確認--提示，不做處理
   LET l_cnt = 0 
   SELECT COUNT(*) INTO l_cnt FROM xcea_t
    WHERE xceaent = g_enterprise
      AND xceald = g_xcea_m.xceald
      AND xcea003 = g_xcea_m.xcea003
      AND xcea004 = g_xcea_m.xcea004
      AND xcea005 = g_xcea_m.xcea005
      AND xcea002 = p_xcea002
      AND xceastus = 'Y'
    
   #若存在已审核的资料，则提示    
   IF l_cnt > 0 THEN 
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = ""
      LET g_errparam.code = "afa-00185"
      LET g_errparam.popup = FALSE
      CALL cl_err()
      LET r_success = FALSE
   END IF   
      
   #2.狀態未確認--刪除xcea\xceb\xcec資料，重新產生   
   LET l_cnt1 = 0 
   SELECT COUNT(*) INTO l_cnt1 FROM xcea_t
    WHERE xceaent = g_enterprise
      AND xceald = g_xcea_m.xceald
      AND xcea003 = g_xcea_m.xcea003
      AND xcea004 = g_xcea_m.xcea004
      AND xcea005 = g_xcea_m.xcea005
      AND xcea002 = p_xcea002
      AND xceastus = 'N'
    
   #若存在已审核的资料，则提示    
   IF l_cnt1 > 0 THEN 
      IF cl_ask_confirm('afa-00186') THEN   #是，删除资料新增
         LET r_success = TRUE
         
         
         #获取单据编号
         DECLARE axct701_01_sel_xcea_cs CURSOR FOR
         SELECT DISTINCT xceadocno,xcea001 FROM xcea_t
          WHERE xceaent = g_enterprise
            AND xceald  = g_xcea_m.xceald
            AND xcea003 = g_xcea_m.xcea003
            AND xcea004 = g_xcea_m.xcea004
            AND xcea005 = g_xcea_m.xcea005
            AND xcea002 = p_xcea002
            AND xceastus = 'N'
         FOREACH axct701_01_sel_xcea_cs INTO l_xceadocno,l_xcea001
            #单头
            DELETE FROM xcea_t    
             WHERE xceaent = g_enterprise
               AND xceald = g_xcea_m.xceald
               AND xceadocno = l_xceadocno
           IF SQLCA.sqlcode THEN
              INITIALIZE g_errparam TO NULL 
              LET g_errparam.extend = "del xcea" 
              LET g_errparam.code   = SQLCA.sqlcode 
              LET g_errparam.popup  = FALSE 
              CALL cl_err()
              LET r_success = FALSE
           END IF        
           
           IF NOT s_aooi200_fin_del_docno(g_xcea_m.xceald,l_xceadocno,l_xcea001) THEN LET r_success = FALSE RETURN r_success END IF   #wujie 150214          
           CALL s_ld_sel_glaa(g_xcea_m.xceald,'glaa121') RETURNING  l_success,l_glaa121
           IF l_glaa121 = 'Y' THEN
              CALL s_pre_voucher_del('XC','C10',g_xcea_m.xceald,l_xceadocno) RETURNING r_success
              IF NOT r_success THEN
                 RETURN r_success
              END IF
           END IF
           
           #单身一
           DELETE FROM xceb_t    
            WHERE xcebent = g_enterprise
              AND xcebld = g_xcea_m.xceald
              AND xcebdocno = l_xceadocno
           IF SQLCA.sqlcode THEN
              INITIALIZE g_errparam TO NULL 
              LET g_errparam.extend = "del xceb" 
              LET g_errparam.code   = SQLCA.sqlcode 
              LET g_errparam.popup  = FALSE 
              CALL cl_err()
              LET r_success = FALSE
           END IF   
           
           #单身二
           DELETE FROM xcec_t    
            WHERE xcecent = g_enterprise
              AND xcecld = g_xcea_m.xceald
              AND xcecdocno = l_xceadocno
           IF SQLCA.sqlcode THEN
              INITIALIZE g_errparam TO NULL 
              LET g_errparam.extend = "del xcec" 
              LET g_errparam.code   = SQLCA.sqlcode 
              LET g_errparam.popup  = FALSE 
              CALL cl_err()
              LET r_success = FALSE
           END IF 
           
           #单身三
           DELETE FROM xced_t    
            WHERE xcedent = g_enterprise
              AND xcedld = g_xcea_m.xceald
              AND xceddocno = l_xceadocno
           IF SQLCA.sqlcode THEN
              INITIALIZE g_errparam TO NULL 
              LET g_errparam.extend = "del xced" 
              LET g_errparam.code   = SQLCA.sqlcode 
              LET g_errparam.popup  = FALSE 
              CALL cl_err()
              LET r_success = FALSE
           END IF 
        END FOREACH
        
      ELSE
        LET r_success = FALSE
      END IF       
   END IF    

   RETURN r_success
END FUNCTION

################################################################################
# Descriptions...: 新增xcea,xceb,xcec  1.在製投入憑證 axct701
# Memo...........:
# Usage..........: CALL axct701_01_ins()
# Input parameter:  
# Return code....:  
# Date & Author..: 2014/4/16 By 01531
# Modify.........:
################################################################################
PRIVATE FUNCTION axct701_01_ins()
#161215-00040#1 Add  ---(S)---   因效能优化,程序逻辑完全重写,旧代码保存在axct701_01_ins_bak中
DEFINE l_xcea          RECORD  #工單發料成本憑證單頭檔
          xceaent        LIKE xcea_t.xceaent, #企業編號
          xceacomp       LIKE xcea_t.xceacomp, #法人組織
          xceald         LIKE xcea_t.xceald, #帳套
          xceadocno      LIKE xcea_t.xceadocno, #單據編號
          xcea001        LIKE xcea_t.xcea001, #單據日期
          xcea002        LIKE xcea_t.xcea002, #成本憑證類型
          xcea003        LIKE xcea_t.xcea003, #成本計算類型
          xcea004        LIKE xcea_t.xcea004, #年度
          xcea005        LIKE xcea_t.xcea005, #期別
          xcea006        LIKE xcea_t.xcea006, #帳務人員
          xcea007        LIKE xcea_t.xcea007, #帳務部門
          xcea101        LIKE xcea_t.xcea101, #憑證編號
          xcea102        LIKE xcea_t.xcea102, #憑證日期
          xceaownid      LIKE xcea_t.xceaownid, #資料所有者
          xceaowndp      LIKE xcea_t.xceaowndp, #資料所屬部門
          xceacrtid      LIKE xcea_t.xceacrtid, #資料建立者
          xceacrtdp      LIKE xcea_t.xceacrtdp, #資料建立部門
          xceacrtdt      LIKE xcea_t.xceacrtdt, #資料創建日
          xceamodid      LIKE xcea_t.xceamodid, #資料修改者
          xceamoddt      LIKE xcea_t.xceamoddt, #最近修改日
          xceacnfid      LIKE xcea_t.xceacnfid, #資料確認者
          xceacnfdt      LIKE xcea_t.xceacnfdt, #資料確認日
          xceapstid      LIKE xcea_t.xceapstid, #資料過帳者
          xceapstdt      LIKE xcea_t.xceapstdt, #資料過帳日
          xceastus       LIKE xcea_t.xceastus, #狀態碼
          xceaud001      LIKE xcea_t.xceaud001, #自定義欄位(文字)001
          xceaud002      LIKE xcea_t.xceaud002, #自定義欄位(文字)002
          xceaud003      LIKE xcea_t.xceaud003, #自定義欄位(文字)003
          xceaud004      LIKE xcea_t.xceaud004, #自定義欄位(文字)004
          xceaud005      LIKE xcea_t.xceaud005, #自定義欄位(文字)005
          xceaud006      LIKE xcea_t.xceaud006, #自定義欄位(文字)006
          xceaud007      LIKE xcea_t.xceaud007, #自定義欄位(文字)007
          xceaud008      LIKE xcea_t.xceaud008, #自定義欄位(文字)008
          xceaud009      LIKE xcea_t.xceaud009, #自定義欄位(文字)009
          xceaud010      LIKE xcea_t.xceaud010, #自定義欄位(文字)010
          xceaud011      LIKE xcea_t.xceaud011, #自定義欄位(數字)011
          xceaud012      LIKE xcea_t.xceaud012, #自定義欄位(數字)012
          xceaud013      LIKE xcea_t.xceaud013, #自定義欄位(數字)013
          xceaud014      LIKE xcea_t.xceaud014, #自定義欄位(數字)014
          xceaud015      LIKE xcea_t.xceaud015, #自定義欄位(數字)015
          xceaud016      LIKE xcea_t.xceaud016, #自定義欄位(數字)016
          xceaud017      LIKE xcea_t.xceaud017, #自定義欄位(數字)017
          xceaud018      LIKE xcea_t.xceaud018, #自定義欄位(數字)018
          xceaud019      LIKE xcea_t.xceaud019, #自定義欄位(數字)019
          xceaud020      LIKE xcea_t.xceaud020, #自定義欄位(數字)020
          xceaud021      LIKE xcea_t.xceaud021, #自定義欄位(日期時間)021
          xceaud022      LIKE xcea_t.xceaud022, #自定義欄位(日期時間)022
          xceaud023      LIKE xcea_t.xceaud023, #自定義欄位(日期時間)023
          xceaud024      LIKE xcea_t.xceaud024, #自定義欄位(日期時間)024
          xceaud025      LIKE xcea_t.xceaud025, #自定義欄位(日期時間)025
          xceaud026      LIKE xcea_t.xceaud026, #自定義欄位(日期時間)026
          xceaud027      LIKE xcea_t.xceaud027, #自定義欄位(日期時間)027
          xceaud028      LIKE xcea_t.xceaud028, #自定義欄位(日期時間)028
          xceaud029      LIKE xcea_t.xceaud029, #自定義欄位(日期時間)029
          xceaud030      LIKE xcea_t.xceaud030, #自定義欄位(日期時間)030
          xceasite       LIKE xcea_t.xceasite  #營運據點
             END RECORD
   DEFINE l_xcebseq       LIKE xceb_t.xcebseq
   DEFINE ld_date         DATETIME YEAR TO SECOND
   DEFINE l_success       LIKE type_t.num5
   DEFINE l_glab005       LIKE glab_t.glab005

  #CALL axct701_01_create_tmp()   #170324-00054#1 mark

   LET g_success = 'Y'
   LET l_xcea.xceaownid = g_user
   LET l_xcea.xceaowndp = g_dept
   LET l_xcea.xceacrtid = g_user
   LET l_xcea.xceacrtdp = g_dept 
   LET ld_date  = cl_get_current()
   LET l_xcea.xceacrtdt = ld_date
   LET l_xcea.xceamodid = ""
   LET l_xcea.xceamoddt = ""
   CALL s_aooi200_fin_gen_docno(g_xcea_m.xceald,'','',g_xcea_m.xceadocno,g_xcea_m.xcea001,g_prog_name1)      #wujie 150214  
      RETURNING l_success,g_xcea_m.xceadocno
   IF l_success  = 0  THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = 'apm-00003'
      LET g_errparam.extend = g_xcea_m.xceadocno
      LET g_errparam.popup = TRUE
      CALL cl_err()

      LET g_success = 'N'
      RETURN g_success
   END IF
   
   INSERT INTO xcea_t (xceaent,xceald,xceacomp,xcea006,xceadocno,xceastus,
                       xcea001,xcea002,xcea004,xcea005,xcea003,
                       xceaownid,xceaowndp,xceacrtid,xceacrtdp,xceacrtdt,xceamodid,xceamoddt)
        VALUES (g_enterprise,g_xcea_m.xceald,g_xcea_m.xceacomp,g_xcea_m.xcea006,g_xcea_m.xceadocno,'N',
                g_xcea_m.xcea001,g_xcea002,g_xcea_m.xcea004,g_xcea_m.xcea005,g_xcea_m.xcea003, 
                l_xcea.xceaownid,l_xcea.xceaowndp,l_xcea.xceacrtid,l_xcea.xceacrtdp,l_xcea.xceacrtdt,l_xcea.xceamodid,l_xcea.xceamoddt) 

   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "ins xcea"
      LET g_errparam.popup = TRUE
      CALL cl_err()

      LET g_success = 'N'
      RETURN g_success
   END IF

   #非拆件工單 xccd_t
   #帳套本位幣順序+工單+主件
   #170214-00020#1 modify imagsite = 'DSCTP' 調整成 imagsite = 'g_xcea_m.xceacomp'
   #170214-00014#1 xceb109 請參照 xceb111 給值方式
   LET g_sql = "INSERT INTO sourse_ins_tmp 
                 (xcebent,xcebcomp,xcebld,xcebdocno,xcebseq,xceb001,xceb002,xceb003,xceb004,xceb005,xceb101,xceb102,
                  xceb103,xceb110,xceb111,xceb112,xceb113,xceb114,xceb115,xceb116,xceb117,xceb118,xceb119,xceb120,
                  xceb201,xceb202,xceb202a,xceb202b,xceb202c,xceb202d,xceb202e,xceb202f,xceb202g,xceb202h,xceb212,
                  xceb212a,xceb212b,xceb212c,xceb212d,xceb212e,xceb212f,xceb212g,xceb212h,xceb222,xceb222a,xceb222b,
                  xceb222c,xceb222d,xceb222e,xceb222f,xceb222g,xceb222h,xceb301,xceb302,xceb107,xceb108,xceb109,
                  xceb121,xceb122,xceb123,xceb124,xceb125,xceb126,xceb127,xceb128,xceb129,xceb130,xceb131,xceb132,
                  sfaa009,sfaasite,sfaa028,sfaa029,sfaa052,sfaa057)
                SELECT xccdent xcebent,'",g_xcea_m.xceacomp,"' xcebcomp,'",g_xcea_m.xceald,"' xcebld,'",g_xcea_m.xceadocno,"' xcebdocno,
                       rownum xcebseq,xccd006 xceb001,0 xceb002,sfaa003 xceb003,xccd007 xceb004,xccd008 xceb005,'' xceb101,
                       (SELECT glab010 FROM glab_t WHERE glabld  = '",g_xcea_m.xceald,"' AND glab001 = '61' AND glab002 = '8925' AND glab003 = '1' AND glabent = xccdent) xceb102,xccd002 xceb103,'' xceb110,
                       CASE WHEN sfaa052 = 2 THEN sfaa009 ELSE ' ' END xceb111,'' xceb112,'' xceb113,(SELECT ooeg004 FROM ooeg_t WHERE ooegent = sfaaent AND ooeg001 = sfaa017) xceb114,
                       '' xceb115,'' xceb116,(SELECT imag011 FROM imag_t WHERE imagent = xccdent AND imagsite = '",g_xcea_m.xceacomp,"' AND imag001 = xccd007) xceb117,
                       '' xceb118,'' xceb119,'' xceb120,0 xceb201,
                       xceb202,xceb202a,xceb202b,xceb202c,xceb202d,xceb202e,xceb202f,xceb202g,xceb202h,
                       xceb212,xceb212a,xceb212b,xceb212c,xceb212d,xceb212e,xceb212f,xceb212g,xceb212h,
                       xceb222,xceb222a,xceb222b,xceb222c,xceb222d,xceb222e,xceb222f,xceb222g,xceb222h,
                       '' xceb301,'' xceb302,' ' xceb107,CASE WHEN sfaa068 IS NULL THEN ' ' ELSE sfaa068 END xceb108,
                       CASE WHEN sfaa052 = 2 THEN sfaa009 ELSE ' ' END xceb109,' ' xceb121,' ' xceb122,' ' xceb123,' ' xceb124,' ' xceb125,' ' xceb126,' ' xceb127,
                       ' ' xceb128,' ' xceb129,' ' xceb130,'' xceb131,'' xceb132,
                       sfaa009,sfaasite,sfaa028,sfaa029,sfaa052,sfaa057 
                  FROM (
                  SELECT xccdent,xccd006,xccd007,xccd008,xccd002,
                         SUM(xceb202) xceb202,SUM(xceb202a) xceb202a,SUM(xceb202b) xceb202b,SUM(xceb202c) xceb202c,SUM(xceb202d) xceb202d,SUM(xceb202e) xceb202e,SUM(xceb202f) xceb202f,SUM(xceb202g) xceb202g,SUM(xceb202h) xceb202h,
                         SUM(xceb212) xceb212,SUM(xceb212a) xceb212a,SUM(xceb212b) xceb212b,SUM(xceb212c) xceb212c,SUM(xceb212d) xceb212d,SUM(xceb212e) xceb212e,SUM(xceb212f) xceb212f,SUM(xceb212g) xceb212g,SUM(xceb212h) xceb212h,
                         SUM(xceb222) xceb222,SUM(xceb222a) xceb222a,SUM(xceb222b) xceb222b,SUM(xceb222c) xceb222c,SUM(xceb222d) xceb222d,SUM(xceb222e) xceb222e,SUM(xceb222f) xceb222f,SUM(xceb222g) xceb222g,SUM(xceb222h) xceb222h
                    FROM
                     (SELECT xccdent,xccd006,xccd007,xccd008,xccd002,xccd001,
                            SUM(xcce202)+SUM(xcce206)+SUM(xcce208)+SUM(xcce210) xceb202,SUM(xcce202a)+SUM(xcce206a)+SUM(xcce208a)+SUM(xcce210a) xceb202a,
                            SUM(xcce202b)+SUM(xcce206b)+SUM(xcce208b)+SUM(xcce210b) xceb202b,SUM(xcce202c)+SUM(xcce206c)+SUM(xcce208c)+SUM(xcce210c) xceb202c,
                            SUM(xcce202d)+SUM(xcce206d)+SUM(xcce208d)+SUM(xcce210d) xceb202d,SUM(xcce202e)+SUM(xcce206e)+SUM(xcce208e)+SUM(xcce210e) xceb202e,
                            SUM(xcce202f)+SUM(xcce206f)+SUM(xcce208f)+SUM(xcce210f) xceb202f,SUM(xcce202g)+SUM(xcce206g)+SUM(xcce208g)+SUM(xcce210g) xceb202g,
                            SUM(xcce202h)+SUM(xcce206h)+SUM(xcce208h)+SUM(xcce210h) xceb202h,
                            SUM(CASE WHEN xccd001 = '2' THEN xcce202 ELSE 0 END)+SUM(CASE WHEN xccd001 = '2' THEN xcce206 ELSE 0 END)+SUM(CASE WHEN xccd001 = '2' THEN xcce208 ELSE 0 END)+SUM(CASE WHEN xccd001 = '2' THEN xcce210 ELSE 0 END) xceb212,SUM(CASE WHEN xccd001 = '2' THEN xcce202a ELSE 0 END)+SUM(CASE WHEN xccd001 = '2' THEN xcce206a ELSE 0 END)+SUM(CASE WHEN xccd001 = '2' THEN xcce208a ELSE 0 END)+SUM(CASE WHEN xccd001 = '2' THEN xcce210a ELSE 0 END) xceb212a,
                            SUM(CASE WHEN xccd001 = '2' THEN xcce202b ELSE 0 END)+SUM(CASE WHEN xccd001 = '2' THEN xcce206b ELSE 0 END)+SUM(CASE WHEN xccd001 = '2' THEN xcce208b ELSE 0 END)+SUM(CASE WHEN xccd001 = '2' THEN xcce210b ELSE 0 END) xceb212b,SUM(CASE WHEN xccd001 = '2' THEN xcce202c ELSE 0 END)+SUM(CASE WHEN xccd001 = '2' THEN xcce206c ELSE 0 END)+SUM(CASE WHEN xccd001 = '2' THEN xcce208c ELSE 0 END)+SUM(CASE WHEN xccd001 = '2' THEN xcce210c ELSE 0 END) xceb212c,
                            SUM(CASE WHEN xccd001 = '2' THEN xcce202d ELSE 0 END)+SUM(CASE WHEN xccd001 = '2' THEN xcce206d ELSE 0 END)+SUM(CASE WHEN xccd001 = '2' THEN xcce208d ELSE 0 END)+SUM(CASE WHEN xccd001 = '2' THEN xcce210d ELSE 0 END) xceb212d,SUM(CASE WHEN xccd001 = '2' THEN xcce202e ELSE 0 END)+SUM(CASE WHEN xccd001 = '2' THEN xcce206e ELSE 0 END)+SUM(CASE WHEN xccd001 = '2' THEN xcce208e ELSE 0 END)+SUM(CASE WHEN xccd001 = '2' THEN xcce210e ELSE 0 END) xceb212e,
                            SUM(CASE WHEN xccd001 = '2' THEN xcce202f ELSE 0 END)+SUM(CASE WHEN xccd001 = '2' THEN xcce206f ELSE 0 END)+SUM(CASE WHEN xccd001 = '2' THEN xcce208f ELSE 0 END)+SUM(CASE WHEN xccd001 = '2' THEN xcce210f ELSE 0 END) xceb212f,SUM(CASE WHEN xccd001 = '2' THEN xcce202g ELSE 0 END)+SUM(CASE WHEN xccd001 = '2' THEN xcce206g ELSE 0 END)+SUM(CASE WHEN xccd001 = '2' THEN xcce208g ELSE 0 END)+SUM(CASE WHEN xccd001 = '2' THEN xcce210g ELSE 0 END) xceb212g,
                            SUM(CASE WHEN xccd001 = '2' THEN xcce202h ELSE 0 END)+SUM(CASE WHEN xccd001 = '2' THEN xcce206h ELSE 0 END)+SUM(CASE WHEN xccd001 = '2' THEN xcce208h ELSE 0 END)+SUM(CASE WHEN xccd001 = '2' THEN xcce210h ELSE 0 END) xceb212h,
                            SUM(CASE WHEN xccd001 = '3' THEN xcce202 ELSE 0 END)+SUM(CASE WHEN xccd001 = '3' THEN xcce206 ELSE 0 END)+SUM(CASE WHEN xccd001 = '3' THEN xcce208 ELSE 0 END)+SUM(CASE WHEN xccd001 = '3' THEN xcce210 ELSE 0 END) xceb222,SUM(CASE WHEN xccd001 = '3' THEN xcce202a ELSE 0 END)+SUM(CASE WHEN xccd001 = '3' THEN xcce206a ELSE 0 END)+SUM(CASE WHEN xccd001 = '3' THEN xcce208a ELSE 0 END)+SUM(CASE WHEN xccd001 = '3' THEN xcce210a ELSE 0 END) xceb222a,
                            SUM(CASE WHEN xccd001 = '3' THEN xcce202b ELSE 0 END)+SUM(CASE WHEN xccd001 = '3' THEN xcce206b ELSE 0 END)+SUM(CASE WHEN xccd001 = '3' THEN xcce208b ELSE 0 END)+SUM(CASE WHEN xccd001 = '3' THEN xcce210b ELSE 0 END) xceb222b,SUM(CASE WHEN xccd001 = '3' THEN xcce202c ELSE 0 END)+SUM(CASE WHEN xccd001 = '3' THEN xcce206c ELSE 0 END)+SUM(CASE WHEN xccd001 = '3' THEN xcce208c ELSE 0 END)+SUM(CASE WHEN xccd001 = '3' THEN xcce210c ELSE 0 END) xceb222c,
                            SUM(CASE WHEN xccd001 = '3' THEN xcce202d ELSE 0 END)+SUM(CASE WHEN xccd001 = '3' THEN xcce206d ELSE 0 END)+SUM(CASE WHEN xccd001 = '3' THEN xcce208d ELSE 0 END)+SUM(CASE WHEN xccd001 = '3' THEN xcce210d ELSE 0 END) xceb222d,SUM(CASE WHEN xccd001 = '3' THEN xcce202e ELSE 0 END)+SUM(CASE WHEN xccd001 = '3' THEN xcce206e ELSE 0 END)+SUM(CASE WHEN xccd001 = '3' THEN xcce208e ELSE 0 END)+SUM(CASE WHEN xccd001 = '3' THEN xcce210e ELSE 0 END) xceb222e,
                            SUM(CASE WHEN xccd001 = '3' THEN xcce202f ELSE 0 END)+SUM(CASE WHEN xccd001 = '3' THEN xcce206f ELSE 0 END)+SUM(CASE WHEN xccd001 = '3' THEN xcce208f ELSE 0 END)+SUM(CASE WHEN xccd001 = '3' THEN xcce210f ELSE 0 END) xceb222f,SUM(CASE WHEN xccd001 = '3' THEN xcce202g ELSE 0 END)+SUM(CASE WHEN xccd001 = '3' THEN xcce206g ELSE 0 END)+SUM(CASE WHEN xccd001 = '3' THEN xcce208g ELSE 0 END)+SUM(CASE WHEN xccd001 = '3' THEN xcce210g ELSE 0 END) xceb222g,
                            SUM(CASE WHEN xccd001 = '3' THEN xcce202h ELSE 0 END)+SUM(CASE WHEN xccd001 = '3' THEN xcce206h ELSE 0 END)+SUM(CASE WHEN xccd001 = '3' THEN xcce208h ELSE 0 END)+SUM(CASE WHEN xccd001 = '3' THEN xcce210h ELSE 0 END) xceb222h
                       FROM xccd_t,xcce_t
                      WHERE xccdent = ",g_enterprise," AND xccdld = '",g_xcea_m.xceald,"'
                        AND xccd003 = '",g_xcea_m.xcea003,"' AND xccd004 = ",g_xcea_m.xcea004,"
                        AND xccd005 = ",g_xcea_m.xcea005,"
                        AND xcceent = xccdent
                        AND xcceld  = xccdld
                        AND xcce001 = xccd001
                        AND xcce003 = xccd003
                        AND xcce004 = xccd004
                        AND xcce005 = xccd005
                        AND xcce006 = xccd006
                        AND xcce007 != 'DL+OH+SUB'
                      GROUP BY xccdent,xccd006,xccd007,xccd008,xccd002,xccd001
                      ORDER BY xccdent,xccd006,xccd007,xccd008,xccd002,xccd001)
                   GROUP BY xccdent,xccd006,xccd007,xccd008,xccd002),sfaa_t
                 WHERE sfaaent = xccdent AND sfaadocno = xccd006 AND xceb202 <> 0"
   PREPARE axct701_01_ins_tmp FROM g_sql
   EXECUTE axct701_01_ins_tmp

   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (         SELECT pmaa090,pmaa241,pmaa001 
                            FROM pmaa_t 
                               WHERE pmaaent = ",g_enterprise," )        ",
                   "    ON (xceb111=pmaa001)                        ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb112 = pmaa090,",
                   "               xceb113 = pmaa241    ",
                   "     WHERE sfaa052 = '2'"
   PREPARE axct701_01_meg_01 FROM g_sql
   EXECUTE axct701_01_meg_01

   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT ooef153,ooef001 FROM ooef_t
          WHERE ooefent = ",g_enterprise," )        ",
                   "    ON (sfaasite=ooef001)                        ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb112 = ' ',",
                   "               xceb113 = ooef153    ",
                   "     WHERE sfaa052 <> '2'"
   PREPARE axct701_01_meg_02 FROM g_sql
   EXECUTE axct701_01_meg_02

   #抓取科目
   #STEP1
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   #" USING (SELECT glcc002,glcc016,glcc011 FROM glcc_t       ", #170221-00041#1 mark
                   " USING (SELECT DISTINCT glcc002,glcc016,glcc011 FROM glcc_t       ",  #170221-00041#1 add                 
                   " WHERE glccent = ",g_enterprise,"  AND glcc001 = '4'  AND glccld  = '",g_xcea_m.xceald,"'
   AND ( glcc014='",g_xcea_m.xceacomp,"' OR glcc014='*' ) )        ",
                   "    ON ((glcc016=xceb004 OR glcc016 = '*') AND (glcc011=xceb117 OR glcc011='*') ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb101 = glcc002",
                   "     WHERE sfaa057 = '2'"
   PREPARE axct701_01_meg_03 FROM g_sql
   EXECUTE axct701_01_meg_03
   #STEP2
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   #" USING (SELECT glcc002,glcc016,glcc011 FROM glcc_t       ", #170221-00041#1 mark
                   " USING (SELECT DISTINCT glcc002,glcc016,glcc011 FROM glcc_t       ",  #170221-00041#1 add 
                   " WHERE glccent = ",g_enterprise,"  AND glcc001 = '3'  AND glccld  = '",g_xcea_m.xceald,"'
   AND ( glcc014='",g_xcea_m.xceacomp,"' OR glcc014='*' ) )        ",
                   "    ON ((glcc016=xceb004 OR glcc016 = '*') AND (glcc011=xceb117 OR glcc011='*') ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb101 = glcc002",
                   "     WHERE sfaa057 <> '2'"
   PREPARE axct701_01_meg_04 FROM g_sql
   EXECUTE axct701_01_meg_04
   #STEP3
   SELECT glab005 INTO l_glab005
     FROM glab_t
    WHERE glabld  = g_xcea_m.xceald
      AND glab001 = '60'
      AND glab002 = '8912'
      AND glab003 = '1'
      AND glabent = g_enterprise
   UPDATE sourse_ins_tmp SET xceb101 = l_glab005
    WHERE xceb101 IS NULL

  #启用交易对象
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad010 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad010 = 'N'  ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb111 = ' '"
   PREPARE axct701_01_meg_xceb111 FROM g_sql
   EXECUTE axct701_01_meg_xceb111

  #启用客群
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad011 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad011 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb112 = ' '"
   PREPARE axct701_01_meg_xceb112 FROM g_sql
   EXECUTE axct701_01_meg_xceb112

  #启用区域
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad009 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad009 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb113 = ' '"
   PREPARE axct701_01_meg_xceb113 FROM g_sql
   EXECUTE axct701_01_meg_xceb113

   
  #启用成本中心
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad008 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad008 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb114 = ' '"
   PREPARE axct701_01_meg_xceb114 FROM g_sql
   EXECUTE axct701_01_meg_xceb114
   
  #启用经营类别
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad031 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad031 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb115 = ' '"
   PREPARE axct701_01_meg_xceb115 FROM g_sql
   EXECUTE axct701_01_meg_xceb115
 
  #启用渠道
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad032 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad032 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb116 = ' '"
   PREPARE axct701_01_meg_xceb116 FROM g_sql
   EXECUTE axct701_01_meg_xceb116

  #启用品类
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad012 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad012 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb117 = ' '"
   PREPARE axct701_01_meg_xceb117 FROM g_sql
   EXECUTE axct701_01_meg_xceb117
   
  #启用品牌
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad033 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad033 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb118 = ' '"
   PREPARE axct701_01_meg_xceb118 FROM g_sql
   EXECUTE axct701_01_meg_xceb118
 
  #启用项目号
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad015 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad015 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb119 = ' '"
   PREPARE axct701_01_meg_xceb119 FROM g_sql
   EXECUTE axct701_01_meg_xceb119
 
  #启用WBS
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad016 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad016 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb120 = ' '"
   PREPARE axct701_01_meg_xceb120 FROM g_sql
   EXECUTE axct701_01_meg_xceb120
 
  #启用人员
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad013 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad013 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb107 = ' '"
   PREPARE axct701_01_meg_xceb107 FROM g_sql
   EXECUTE axct701_01_meg_xceb107
 
  #启用部门
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad007 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad007 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb108 = ' '"
   PREPARE axct701_01_meg_xceb108 FROM g_sql
   EXECUTE axct701_01_meg_xceb108
   
  #启用账款对象
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad027 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad027 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb109 = ' '"
   PREPARE axct701_01_meg_xceb109 FROM g_sql
   EXECUTE axct701_01_meg_xceb109
   
  #启用自由核算项1
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad017 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad017 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb121 = ' '"
   PREPARE axct701_01_meg_xceb121 FROM g_sql
   EXECUTE axct701_01_meg_xceb121
 
  #启用自由核算项2
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad018 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad018 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb122 = ' '"
   PREPARE axct701_01_meg_xceb122 FROM g_sql
   EXECUTE axct701_01_meg_xceb122
 
  #启用自由核算项3
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad019 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad019 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb123 = ' '"
   PREPARE axct701_01_meg_xceb123 FROM g_sql
   EXECUTE axct701_01_meg_xceb123

  #启用自由核算项4
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad019 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad019 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb124 = ' '"
   PREPARE axct701_01_meg_xceb124 FROM g_sql
   EXECUTE axct701_01_meg_xceb124

  #启用自由核算项5
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad021 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad021 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb125 = ' '"
   PREPARE axct701_01_meg_xceb125 FROM g_sql
   EXECUTE axct701_01_meg_xceb125

  #启用自由核算项6
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad022 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad022 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb126 = ' '"
   PREPARE axct701_01_meg_xceb126 FROM g_sql
   EXECUTE axct701_01_meg_xceb126

  #启用自由核算项7
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad023 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad023 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb127 = ' '"
   PREPARE axct701_01_meg_xceb127 FROM g_sql
   EXECUTE axct701_01_meg_xceb127

  #启用自由核算项8
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad024 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad024 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb128 = ' '"
   PREPARE axct701_01_meg_xceb128 FROM g_sql
   EXECUTE axct701_01_meg_xceb128

  #启用自由核算项9
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad025 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad025 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb129 = ' '"
   PREPARE axct701_01_meg_xceb129 FROM g_sql
   EXECUTE axct701_01_meg_xceb129

  #启用自由核算项10
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad026 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad026 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb130 = ' '"
   PREPARE axct701_01_meg_xceb130 FROM g_sql
   EXECUTE axct701_01_meg_xceb130

  #来源单项次
   UPDATE sourse_ins_tmp SET xceb002 = ''
  #特性
   UPDATE sourse_ins_tmp SET xceb005 = ' ' WHERE xceb005 IS NULL
 #科目编号
   UPDATE sourse_ins_tmp SET xceb101 = ' ' WHERE xceb101 IS NULL
  #摘要
   UPDATE sourse_ins_tmp SET xceb102 = ' ' WHERE xceb102 IS NULL
  #成本域
   UPDATE sourse_ins_tmp SET xceb103 = ' ' WHERE xceb103 IS NULL
  #原因码
   UPDATE sourse_ins_tmp SET xceb110 = ' ' WHERE xceb110 IS NULL
  #交易对象
   UPDATE sourse_ins_tmp SET xceb111 = ' ' WHERE xceb111 IS NULL
  #客群
   UPDATE sourse_ins_tmp SET xceb112 = ' ' WHERE xceb112 IS NULL
  #区域
   UPDATE sourse_ins_tmp SET xceb113 = ' ' WHERE xceb113 IS NULL
  #成本中心
   UPDATE sourse_ins_tmp SET xceb114 = ' ' WHERE xceb114 IS NULL
  #经营类别
   UPDATE sourse_ins_tmp SET xceb115 = ' ' WHERE xceb115 IS NULL
  #渠道
   UPDATE sourse_ins_tmp SET xceb116 = ' ' WHERE xceb116 IS NULL
  #品类
   UPDATE sourse_ins_tmp SET xceb117 = ' ' WHERE xceb117 IS NULL
  #品牌
   UPDATE sourse_ins_tmp SET xceb118 = ' ' WHERE xceb118 IS NULL
  #项目号
   UPDATE sourse_ins_tmp SET xceb119 = ' ' WHERE xceb119 IS NULL
  #WBS
   UPDATE sourse_ins_tmp SET xceb120 = ' ' WHERE xceb120 IS NULL
  #人员
   UPDATE sourse_ins_tmp SET xceb107 = ' ' WHERE xceb107 IS NULL
   #部门
   UPDATE sourse_ins_tmp SET xceb108 = ' ' WHERE xceb108 IS NULL
  #账款对象
   UPDATE sourse_ins_tmp SET xceb109 = ' ' WHERE xceb109 IS NULL
  #自由核算项1
   UPDATE sourse_ins_tmp SET xceb121 = ' ' WHERE xceb121 IS NULL
  #自由核算项2
   UPDATE sourse_ins_tmp SET xceb122 = ' ' WHERE xceb122 IS NULL
  #自由核算项3
   UPDATE sourse_ins_tmp SET xceb123 = ' ' WHERE xceb123 IS NULL
  #自由核算项4
   UPDATE sourse_ins_tmp SET xceb124 = ' ' WHERE xceb124 IS NULL
  #自由核算项5
   UPDATE sourse_ins_tmp SET xceb125 = ' ' WHERE xceb125 IS NULL
  #自由核算项6
   UPDATE sourse_ins_tmp SET xceb126 = ' ' WHERE xceb126 IS NULL
   #自由核算项7
   UPDATE sourse_ins_tmp SET xceb127 = ' ' WHERE xceb127 IS NULL
  #自由核算项8
   UPDATE sourse_ins_tmp SET xceb128 = ' ' WHERE xceb128 IS NULL
  #自由核算项9
   UPDATE sourse_ins_tmp SET xceb129 = ' ' WHERE xceb129 IS NULL
  #自由核算项10
   UPDATE sourse_ins_tmp SET xceb130 = ' ' WHERE xceb130 IS NULL

   INSERT INTO xceb_t (xcebent,xcebcomp,xcebld,xcebdocno,xcebseq,
                       xceb001,xceb002,xceb003,xceb004,xceb005,xceb101,xceb102,xceb103,xceb110,xceb111,
                       xceb112,xceb113,xceb114,xceb115,xceb116,xceb117,xceb118,xceb119,xceb120,xceb201,
                       xceb202,xceb202a,xceb202b,xceb202c,xceb202d,xceb202e,xceb202f,xceb202g,xceb202h,
                       xceb212,xceb212a,xceb212b,xceb212c,xceb212d,xceb212e,xceb212f,xceb212g,xceb212h,
                       xceb222,xceb222a,xceb222b,xceb222c,xceb222d,xceb222e,xceb222f,xceb222g,xceb222h,
                       xceb301,xceb302,xceb107,xceb108,xceb109,xceb121,xceb122,xceb123,xceb124,xceb125,
                       xceb126,xceb127,xceb128,xceb129,xceb130,xceb131,xceb132)
         SELECT xcebent,xcebcomp,xcebld,xcebdocno,xcebseq,
                       xceb001,xceb002,xceb003,xceb004,xceb005,xceb101,xceb102,xceb103,xceb110,xceb111,
                       xceb112,xceb113,xceb114,xceb115,xceb116,xceb117,xceb118,xceb119,xceb120,xceb201,
                       xceb202,xceb202a,xceb202b,xceb202c,xceb202d,xceb202e,xceb202f,xceb202g,xceb202h,
                       xceb212,xceb212a,xceb212b,xceb212c,xceb212d,xceb212e,xceb212f,xceb212g,xceb212h,
                       xceb222,xceb222a,xceb222b,xceb222c,xceb222d,xceb222e,xceb222f,xceb222g,xceb222h,
                       xceb301,xceb302,xceb107,xceb108,xceb109,xceb121,xceb122,xceb123,xceb124,xceb125,
                       xceb126,xceb127,xceb128,xceb129,xceb130,xceb131,xceb132
           FROM sourse_ins_tmp

   DELETE FROM sourse_ins_tmp

   #非拆件工單 xcce_t
   #帳套本位幣順序+工單+元件 
   #170214-00020#1 modify imagsite = 'DSCTP' 調整成 imagsite = 'g_xcea_m.xceacomp'
   #170214-00014#1 xcec109 請參照 xcec111 給值方式
   LET g_sql = "INSERT INTO sourse_ins_tmp1
                 (xcecent,xceccomp,xcecld,xcecdocno,xcecseq,xcec001,xcec002,xcec003,xcec004,xcec005,xcec101,xcec102,
                  xcec103,xcec110,xcec111,xcec112,xcec113,xcec114,xcec115,xcec116,xcec117,xcec118,xcec119,xcec120,
                  xcec201,xcec202,xcec202a,xcec202b,xcec202c,xcec202d,xcec202e,xcec202f,xcec202g,xcec202h,xcec212,
                  xcec212a,xcec212b,xcec212c,xcec212d,xcec212e,xcec212f,xcec212g,xcec212h,xcec222,xcec222a,xcec222b,
                  xcec222c,xcec222d,xcec222e,xcec222f,xcec222g,xcec222h,xcec301,xcec302,xcec107,xcec108,xcec109,
                  xcec121,xcec122,xcec123,xcec124,xcec125,xcec126,xcec127,xcec128,xcec129,xcec130,
                  sfaa009,sfaasite,sfaa028,sfaa029,sfaa052,sfaa057)
                SELECT ",g_enterprise," xcecent,'",g_xcea_m.xceacomp,"' xceccomp,'",g_xcea_m.xceald,"' xcecld,'",g_xcea_m.xceadocno,"' xcecdocno,
                       rownum xcecseq,xcce006 xcec001,0 xcec002,sfaa003 xcec003,xcce007 xcec004,xcce008 xcec005,'' xcec101,
                       (SELECT glab010 FROM glab_t WHERE glabld  = '",g_xcea_m.xceald,"' AND glab001 = '61' AND glab002 = '8925' AND glab003 = '1' AND glabent = xcceent) xcec102,
                       xcce002 xcec103,'' xcec110,CASE WHEN sfaa052 = 2 THEN sfaa009 ELSE ' ' END xcec111,'' xcec112,'' xcec113,(SELECT ooeg004 FROM ooeg_t WHERE ooegent = sfaaent AND ooeg001 = sfaa017) xcec114,
                       '' xcec115,'' xcec116,(SELECT imag011 FROM imag_t WHERE imagent = xcceent AND imagsite = '",g_xcea_m.xceacomp,"' AND imag001 = xcce007) xcec117,
                       '' xcec118,'' xcec119,'' xcec120, xcec201,
                       xcec202,xcec202a,xcec202b,xcec202c,xcec202d,xcec202e,xcec202f,xcec202g,xcec202h,
                       xcec212,xcec212a,xcec212b,xcec212c,xcec212d,xcec212e,xcec212f,xcec212g,xcec212h,
                       xcec222,xcec222a,xcec222b,xcec222c,xcec222d,xcec222e,xcec222f,xcec222g,xcec222h,
                       '' xcec301,'' xcec302,' ' xcec107,CASE WHEN sfaa068 IS NULL THEN ' ' ELSE sfaa068 END xcec108,
                       CASE WHEN sfaa052 = 2 THEN sfaa009 ELSE ' ' END xcec109,' ' xcec121,' ' xcec122,' ' xcec123,' ' xcec124,' ' xcec125,' ' xcec126,' ' xcec127,' ' xcec128,' ' xcec129,' ' xcec130,
                       sfaa009,sfaasite,sfaa028,sfaa029,sfaa052,sfaa057 
                  FROM (
                  SELECT xcceent,xcce006,xcce007,xcce008,xcce002,SUM(xcec201) xcec201,
                         SUM(xcec202) xcec202,SUM(xcec202a) xcec202a,SUM(xcec202b) xcec202b,SUM(xcec202c) xcec202c,SUM(xcec202d) xcec202d,SUM(xcec202e) xcec202e,SUM(xcec202f) xcec202f,SUM(xcec202g) xcec202g,SUM(xcec202h) xcec202h,
                         SUM(xcec212) xcec212,SUM(xcec212a) xcec212a,SUM(xcec212b) xcec212b,SUM(xcec212c) xcec212c,SUM(xcec212d) xcec212d,SUM(xcec212e) xcec212e,SUM(xcec212f) xcec212f,SUM(xcec212g) xcec212g,SUM(xcec212h) xcec212h,
                         SUM(xcec222) xcec222,SUM(xcec222a) xcec222a,SUM(xcec222b) xcec222b,SUM(xcec222c) xcec222c,SUM(xcec222d) xcec222d,SUM(xcec222e) xcec222e,SUM(xcec222f) xcec222f,SUM(xcec222g) xcec222g,SUM(xcec222h) xcec222h
                    FROM
                     (SELECT xcceent,xcce006,xcce007,xcce008,xcce002,xcce001,SUM(xcce201)+SUM(xcce205)+SUM(xcce207)+SUM(xcce209) xcec201,
                            SUM(xcce202)+SUM(xcce206)+SUM(xcce208)+SUM(xcce210) xcec202,SUM(xcce202a)+SUM(xcce206a)+SUM(xcce208a)+SUM(xcce210a) xcec202a,
                            SUM(xcce202b)+SUM(xcce206b)+SUM(xcce208b)+SUM(xcce210b) xcec202b,SUM(xcce202c)+SUM(xcce206c)+SUM(xcce208c)+SUM(xcce210c) xcec202c,
                            SUM(xcce202d)+SUM(xcce206d)+SUM(xcce208d)+SUM(xcce210d) xcec202d,SUM(xcce202e)+SUM(xcce206e)+SUM(xcce208e)+SUM(xcce210e) xcec202e,
                            SUM(xcce202f)+SUM(xcce206f)+SUM(xcce208f)+SUM(xcce210f) xcec202f,SUM(xcce202g)+SUM(xcce206g)+SUM(xcce208g)+SUM(xcce210g) xcec202g,
                            SUM(xcce202h)+SUM(xcce206h)+SUM(xcce208h)+SUM(xcce210h) xcec202h,
                            SUM(CASE WHEN xcce001 = '2' THEN xcce202 ELSE 0 END)+SUM(CASE WHEN xcce001 = '2' THEN xcce206 ELSE 0 END)+SUM(CASE WHEN xcce001 = '2' THEN xcce208 ELSE 0 END)+SUM(CASE WHEN xcce001 = '2' THEN xcce210 ELSE 0 END) xcec212,SUM(CASE WHEN xcce001 = '2' THEN xcce202a ELSE 0 END)+SUM(CASE WHEN xcce001 = '2' THEN xcce206a ELSE 0 END)+SUM(CASE WHEN xcce001 = '2' THEN xcce208a ELSE 0 END)+SUM(CASE WHEN xcce001 = '2' THEN xcce210a ELSE 0 END) xcec212a,
                            SUM(CASE WHEN xcce001 = '2' THEN xcce202b ELSE 0 END)+SUM(CASE WHEN xcce001 = '2' THEN xcce206b ELSE 0 END)+SUM(CASE WHEN xcce001 = '2' THEN xcce208b ELSE 0 END)+SUM(CASE WHEN xcce001 = '2' THEN xcce210b ELSE 0 END) xcec212b,SUM(CASE WHEN xcce001 = '2' THEN xcce202c ELSE 0 END)+SUM(CASE WHEN xcce001 = '2' THEN xcce206c ELSE 0 END)+SUM(CASE WHEN xcce001 = '2' THEN xcce208c ELSE 0 END)+SUM(CASE WHEN xcce001 = '2' THEN xcce210c ELSE 0 END) xcec212c,
                            SUM(CASE WHEN xcce001 = '2' THEN xcce202d ELSE 0 END)+SUM(CASE WHEN xcce001 = '2' THEN xcce206d ELSE 0 END)+SUM(CASE WHEN xcce001 = '2' THEN xcce208d ELSE 0 END)+SUM(CASE WHEN xcce001 = '2' THEN xcce210d ELSE 0 END) xcec212d,SUM(CASE WHEN xcce001 = '2' THEN xcce202e ELSE 0 END)+SUM(CASE WHEN xcce001 = '2' THEN xcce206e ELSE 0 END)+SUM(CASE WHEN xcce001 = '2' THEN xcce208e ELSE 0 END)+SUM(CASE WHEN xcce001 = '2' THEN xcce210e ELSE 0 END) xcec212e,
                            SUM(CASE WHEN xcce001 = '2' THEN xcce202f ELSE 0 END)+SUM(CASE WHEN xcce001 = '2' THEN xcce206f ELSE 0 END)+SUM(CASE WHEN xcce001 = '2' THEN xcce208f ELSE 0 END)+SUM(CASE WHEN xcce001 = '2' THEN xcce210f ELSE 0 END) xcec212f,SUM(CASE WHEN xcce001 = '2' THEN xcce202g ELSE 0 END)+SUM(CASE WHEN xcce001 = '2' THEN xcce206g ELSE 0 END)+SUM(CASE WHEN xcce001 = '2' THEN xcce208g ELSE 0 END)+SUM(CASE WHEN xcce001 = '2' THEN xcce210g ELSE 0 END) xcec212g,
                            SUM(CASE WHEN xcce001 = '2' THEN xcce202h ELSE 0 END)+SUM(CASE WHEN xcce001 = '2' THEN xcce206h ELSE 0 END)+SUM(CASE WHEN xcce001 = '2' THEN xcce208h ELSE 0 END)+SUM(CASE WHEN xcce001 = '2' THEN xcce210h ELSE 0 END) xcec212h,
                            SUM(CASE WHEN xcce001 = '3' THEN xcce202 ELSE 0 END)+SUM(CASE WHEN xcce001 = '3' THEN xcce206 ELSE 0 END)+SUM(CASE WHEN xcce001 = '3' THEN xcce208 ELSE 0 END)+SUM(CASE WHEN xcce001 = '3' THEN xcce210 ELSE 0 END) xcec222,SUM(CASE WHEN xcce001 = '3' THEN xcce202a ELSE 0 END)+SUM(CASE WHEN xcce001 = '3' THEN xcce206a ELSE 0 END)+SUM(CASE WHEN xcce001 = '3' THEN xcce208a ELSE 0 END)+SUM(CASE WHEN xcce001 = '3' THEN xcce210a ELSE 0 END) xcec222a,
                            SUM(CASE WHEN xcce001 = '3' THEN xcce202b ELSE 0 END)+SUM(CASE WHEN xcce001 = '3' THEN xcce206b ELSE 0 END)+SUM(CASE WHEN xcce001 = '3' THEN xcce208b ELSE 0 END)+SUM(CASE WHEN xcce001 = '3' THEN xcce210b ELSE 0 END) xcec222b,SUM(CASE WHEN xcce001 = '3' THEN xcce202c ELSE 0 END)+SUM(CASE WHEN xcce001 = '3' THEN xcce206c ELSE 0 END)+SUM(CASE WHEN xcce001 = '3' THEN xcce208c ELSE 0 END)+SUM(CASE WHEN xcce001 = '3' THEN xcce210c ELSE 0 END) xcec222c,
                            SUM(CASE WHEN xcce001 = '3' THEN xcce202d ELSE 0 END)+SUM(CASE WHEN xcce001 = '3' THEN xcce206d ELSE 0 END)+SUM(CASE WHEN xcce001 = '3' THEN xcce208d ELSE 0 END)+SUM(CASE WHEN xcce001 = '3' THEN xcce210d ELSE 0 END) xcec222d,SUM(CASE WHEN xcce001 = '3' THEN xcce202e ELSE 0 END)+SUM(CASE WHEN xcce001 = '3' THEN xcce206e ELSE 0 END)+SUM(CASE WHEN xcce001 = '3' THEN xcce208e ELSE 0 END)+SUM(CASE WHEN xcce001 = '3' THEN xcce210e ELSE 0 END) xcec222e,
                            SUM(CASE WHEN xcce001 = '3' THEN xcce202f ELSE 0 END)+SUM(CASE WHEN xcce001 = '3' THEN xcce206f ELSE 0 END)+SUM(CASE WHEN xcce001 = '3' THEN xcce208f ELSE 0 END)+SUM(CASE WHEN xcce001 = '3' THEN xcce210f ELSE 0 END) xcec222f,SUM(CASE WHEN xcce001 = '3' THEN xcce202g ELSE 0 END)+SUM(CASE WHEN xcce001 = '3' THEN xcce206g ELSE 0 END)+SUM(CASE WHEN xcce001 = '3' THEN xcce208g ELSE 0 END)+SUM(CASE WHEN xcce001 = '3' THEN xcce210g ELSE 0 END) xcec222g,
                            SUM(CASE WHEN xcce001 = '3' THEN xcce202h ELSE 0 END)+SUM(CASE WHEN xcce001 = '3' THEN xcce206h ELSE 0 END)+SUM(CASE WHEN xcce001 = '3' THEN xcce208h ELSE 0 END)+SUM(CASE WHEN xcce001 = '3' THEN xcce210h ELSE 0 END) xcec222h
                       FROM xcce_t
                      WHERE xcceent = ",g_enterprise," AND xcceld = '",g_xcea_m.xceald,"'
                        AND xcce003 = '",g_xcea_m.xcea003,"' AND xcce004 = ",g_xcea_m.xcea004,"
                        AND xcce005 = ",g_xcea_m.xcea005,"
                        AND xcce007 != 'DL+OH+SUB'
                      GROUP BY xcceent,xcce006,xcce007,xcce008,xcce002,xcce001
                      ORDER BY xcceent,xcce006,xcce007,xcce008,xcce002,xcce001)
                   GROUP BY xcceent,xcce006,xcce007,xcce008,xcce002),sfaa_t
                 WHERE sfaaent = xcceent AND sfaadocno = xcce006 AND xcec202 <> 0"
   PREPARE axct701_01_ins_tmp1 FROM g_sql
   EXECUTE axct701_01_ins_tmp1

   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (         SELECT pmaa090,pmaa241,pmaa001 
                            FROM pmaa_t 
                               WHERE pmaaent = ",g_enterprise," )        ",
                   "    ON (xcec111=pmaa001)                        ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec112 = pmaa090,",
                   "               xcec113 = pmaa241    ",
                   "     WHERE sfaa052 = '2'"
   PREPARE axct701_01_meg_05 FROM g_sql
   EXECUTE axct701_01_meg_05

   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT ooef153,ooef001 FROM ooef_t
          WHERE ooefent = ",g_enterprise," )        ",
                   "    ON (sfaasite=ooef001)                        ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec112 = ' ',",
                   "               xcec113 = ooef153    ",
                   "     WHERE sfaa052 <> '2'"
   PREPARE axct701_01_meg_06 FROM g_sql
   EXECUTE axct701_01_meg_06

   #抓取科目
   #STEP1
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   #" USING (SELECT glcc002,glcc016,glcc011 FROM glcc_t       ", #170221-00041#1 mark
                   " USING (SELECT DISTINCT glcc002,glcc016,glcc011 FROM glcc_t  ",  #170221-00041#1 add                    
                   " WHERE glccent = ",g_enterprise,"  AND glcc001 = '1'  AND glccld  = '",g_xcea_m.xceald,"'
   AND ( glcc014='",g_xcea_m.xceacomp,"' OR glcc014='*' ) )        ",
                   "    ON ((glcc016=xcec004 OR glcc016 = '*') AND (glcc011=xcec117 OR glcc011='*') ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec101 = glcc002",
                   "     WHERE xcec004 != 'ADJUST'"
   PREPARE axct701_01_meg_07 FROM g_sql
   EXECUTE axct701_01_meg_07
   #STEP2
   SELECT glab005 INTO l_glab005
     FROM glab_t
    WHERE glabld  = g_xcea_m.xceald
      AND glab001 = '60'
      AND glab002 = '8912'
      AND glab003 = '16'
      AND glabent = g_enterprise
   UPDATE sourse_ins_tmp1 SET xcec101 = l_glab005
    WHERE xcec004 = 'ADJUST'

  #启用交易对象
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad010 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad010 = 'N'  ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec111 = ' '"
   PREPARE axct701_01_meg_xcec111 FROM g_sql
   EXECUTE axct701_01_meg_xcec111

  #启用客群
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad011 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad011 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec112 = ' '"
   PREPARE axct701_01_meg_xcec112 FROM g_sql
   EXECUTE axct701_01_meg_xcec112

  #启用区域
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad009 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad009 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec113 = ' '"
   PREPARE axct701_01_meg_xcec113 FROM g_sql
   EXECUTE axct701_01_meg_xcec113

   
  #启用成本中心
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad008 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad008 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec114 = ' '"
   PREPARE axct701_01_meg_xcec114 FROM g_sql
   EXECUTE axct701_01_meg_xcec114
   
  #启用经营类别
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad031 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad031 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec115 = ' '"
   PREPARE axct701_01_meg_xcec115 FROM g_sql
   EXECUTE axct701_01_meg_xcec115
 
  #启用渠道
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad032 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad032 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec116 = ' '"
   PREPARE axct701_01_meg_xcec116 FROM g_sql
   EXECUTE axct701_01_meg_xcec116

  #启用品类
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad012 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad012 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec117 = ' '"
   PREPARE axct701_01_meg_xcec117 FROM g_sql
   EXECUTE axct701_01_meg_xcec117
   
  #启用品牌
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad033 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad033 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec118 = ' '"
   PREPARE axct701_01_meg_xcec118 FROM g_sql
   EXECUTE axct701_01_meg_xcec118
 
  #启用项目号
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad015 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad015 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec119 = ' '"
   PREPARE axct701_01_meg_xcec119 FROM g_sql
   EXECUTE axct701_01_meg_xcec119
 
  #启用WBS
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad016 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad016 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec120 = ' '"
   PREPARE axct701_01_meg_xcec120 FROM g_sql
   EXECUTE axct701_01_meg_xcec120
 
  #启用人员
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad013 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad013 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec107 = ' '"
   PREPARE axct701_01_meg_xcec107 FROM g_sql
   EXECUTE axct701_01_meg_xcec107
 
  #启用部门
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad007 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad007 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec108 = ' '"
   PREPARE axct701_01_meg_xcec108 FROM g_sql
   EXECUTE axct701_01_meg_xcec108
   
  #启用账款对象
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad027 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad027 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec109 = ' '"
   PREPARE axct701_01_meg_xcec109 FROM g_sql
   EXECUTE axct701_01_meg_xcec109
   
  #启用自由核算项1
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad017 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad017 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec121 = ' '"
   PREPARE axct701_01_meg_xcec121 FROM g_sql
   EXECUTE axct701_01_meg_xcec121
 
  #启用自由核算项2
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad018 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad018 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec122 = ' '"
   PREPARE axct701_01_meg_xcec122 FROM g_sql
   EXECUTE axct701_01_meg_xcec122
 
  #启用自由核算项3
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad019 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad019 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec123 = ' '"
   PREPARE axct701_01_meg_xcec123 FROM g_sql
   EXECUTE axct701_01_meg_xcec123

  #启用自由核算项4
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad019 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad019 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec124 = ' '"
   PREPARE axct701_01_meg_xcec124 FROM g_sql
   EXECUTE axct701_01_meg_xcec124

  #启用自由核算项5
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad021 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad021 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec125 = ' '"
   PREPARE axct701_01_meg_xcec125 FROM g_sql
   EXECUTE axct701_01_meg_xcec125

  #启用自由核算项6
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad022 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad022 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec126 = ' '"
   PREPARE axct701_01_meg_xcec126 FROM g_sql
   EXECUTE axct701_01_meg_xcec126

  #启用自由核算项7
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad023 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad023 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec127 = ' '"
   PREPARE axct701_01_meg_xcec127 FROM g_sql
   EXECUTE axct701_01_meg_xcec127

  #启用自由核算项8
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad024 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad024 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec128 = ' '"
   PREPARE axct701_01_meg_xcec128 FROM g_sql
   EXECUTE axct701_01_meg_xcec128

  #启用自由核算项9
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad025 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad025 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec129 = ' '"
   PREPARE axct701_01_meg_xcec129 FROM g_sql
   EXECUTE axct701_01_meg_xcec129

  #启用自由核算项10
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad026 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad026 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec130 = ' '"
   PREPARE axct701_01_meg_xcec130 FROM g_sql
   EXECUTE axct701_01_meg_xcec130

  #来源单项次
   UPDATE sourse_ins_tmp1 SET xcec002 = ''
  #特性
   UPDATE sourse_ins_tmp1 SET xcec005 = ' ' WHERE xcec005 IS NULL
 #科目编号
   UPDATE sourse_ins_tmp1 SET xcec101 = ' ' WHERE xcec101 IS NULL
  #摘要
   UPDATE sourse_ins_tmp1 SET xcec102 = ' ' WHERE xcec102 IS NULL
  #成本域
   UPDATE sourse_ins_tmp1 SET xcec103 = ' ' WHERE xcec103 IS NULL
  #原因码
   UPDATE sourse_ins_tmp1 SET xcec110 = ' ' WHERE xcec110 IS NULL
  #交易对象
   UPDATE sourse_ins_tmp1 SET xcec111 = ' ' WHERE xcec111 IS NULL
  #客群
   UPDATE sourse_ins_tmp1 SET xcec112 = ' ' WHERE xcec112 IS NULL
  #区域
   UPDATE sourse_ins_tmp1 SET xcec113 = ' ' WHERE xcec113 IS NULL
  #成本中心
   UPDATE sourse_ins_tmp1 SET xcec114 = ' ' WHERE xcec114 IS NULL
  #经营类别
   UPDATE sourse_ins_tmp1 SET xcec115 = ' ' WHERE xcec115 IS NULL
  #渠道
   UPDATE sourse_ins_tmp1 SET xcec116 = ' ' WHERE xcec116 IS NULL
  #品类
   UPDATE sourse_ins_tmp1 SET xcec117 = ' ' WHERE xcec117 IS NULL
  #品牌
   UPDATE sourse_ins_tmp1 SET xcec118 = ' ' WHERE xcec118 IS NULL
  #项目号
   UPDATE sourse_ins_tmp1 SET xcec119 = ' ' WHERE xcec119 IS NULL
  #WBS
   UPDATE sourse_ins_tmp1 SET xcec120 = ' ' WHERE xcec120 IS NULL
  #人员
   UPDATE sourse_ins_tmp1 SET xcec107 = ' ' WHERE xcec107 IS NULL
   #部门
   UPDATE sourse_ins_tmp1 SET xcec108 = ' ' WHERE xcec108 IS NULL
  #账款对象
   UPDATE sourse_ins_tmp1 SET xcec109 = ' ' WHERE xcec109 IS NULL
  #自由核算项1
   UPDATE sourse_ins_tmp1 SET xcec121 = ' ' WHERE xcec121 IS NULL
  #自由核算项2
   UPDATE sourse_ins_tmp1 SET xcec122 = ' ' WHERE xcec122 IS NULL
  #自由核算项3
   UPDATE sourse_ins_tmp1 SET xcec123 = ' ' WHERE xcec123 IS NULL
  #自由核算项4
   UPDATE sourse_ins_tmp1 SET xcec124 = ' ' WHERE xcec124 IS NULL
  #自由核算项5
   UPDATE sourse_ins_tmp1 SET xcec125 = ' ' WHERE xcec125 IS NULL
  #自由核算项6
   UPDATE sourse_ins_tmp1 SET xcec126 = ' ' WHERE xcec126 IS NULL
   #自由核算项7
   UPDATE sourse_ins_tmp1 SET xcec127 = ' ' WHERE xcec127 IS NULL
  #自由核算项8
   UPDATE sourse_ins_tmp1 SET xcec128 = ' ' WHERE xcec128 IS NULL
  #自由核算项9
   UPDATE sourse_ins_tmp1 SET xcec129 = ' ' WHERE xcec129 IS NULL
  #自由核算项10
   UPDATE sourse_ins_tmp1 SET xcec130 = ' ' WHERE xcec130 IS NULL

   INSERT INTO xcec_t (xcecent,xceccomp,xcecld,xcecdocno,xcecseq,
                       xcec001,xcec002,xcec003,xcec004,xcec005,xcec101,xcec102,xcec103,xcec110,xcec111,
                       xcec112,xcec113,xcec114,xcec115,xcec116,xcec117,xcec118,xcec119,xcec120,xcec201,
                       xcec202,xcec202a,xcec202b,xcec202c,xcec202d,xcec202e,xcec202f,xcec202g,xcec202h,
                       xcec212,xcec212a,xcec212b,xcec212c,xcec212d,xcec212e,xcec212f,xcec212g,xcec212h,
                       xcec222,xcec222a,xcec222b,xcec222c,xcec222d,xcec222e,xcec222f,xcec222g,xcec222h,
                       xcec301,xcec302,xcec107,xcec108,xcec109,xcec121,xcec122,xcec123,xcec124,xcec125,
                       xcec126,xcec127,xcec128,xcec129,xcec130)
         SELECT xcecent,xceccomp,xcecld,xcecdocno,xcecseq,
                       xcec001,xcec002,xcec003,xcec004,xcec005,xcec101,xcec102,xcec103,xcec110,xcec111,
                       xcec112,xcec113,xcec114,xcec115,xcec116,xcec117,xcec118,xcec119,xcec120,xcec201,
                       xcec202,xcec202a,xcec202b,xcec202c,xcec202d,xcec202e,xcec202f,xcec202g,xcec202h,
                       xcec212,xcec212a,xcec212b,xcec212c,xcec212d,xcec212e,xcec212f,xcec212g,xcec212h,
                       xcec222,xcec222a,xcec222b,xcec222c,xcec222d,xcec222e,xcec222f,xcec222g,xcec222h,
                       xcec301,xcec302,xcec107,xcec108,xcec109,xcec121,xcec122,xcec123,xcec124,xcec125,
                       xcec126,xcec127,xcec128,xcec129,xcec130
           FROM sourse_ins_tmp1

   #拆件工單 xcch_t
   #帳套本位幣順序+工單+主件  
   #170214-00020#1 modify imagsite = 'DSCTP' 調整成 imagsite = 'g_xcea_m.xceacomp'
   DELETE FROM sourse_ins_tmp
   LET g_sql = "INSERT INTO sourse_ins_tmp
                 (xcebent,xcebcomp,xcebld,xcebdocno,xcebseq,xceb001,xceb002,xceb003,xceb004,xceb005,xceb101,xceb102,
                  xceb103,xceb110,xceb111,xceb112,xceb113,xceb114,xceb115,xceb116,xceb117,xceb118,xceb119,xceb120,
                  xceb201,xceb202,xceb202a,xceb202b,xceb202c,xceb202d,xceb202e,xceb202f,xceb202g,xceb202h,xceb212,
                  xceb212a,xceb212b,xceb212c,xceb212d,xceb212e,xceb212f,xceb212g,xceb212h,xceb222,xceb222a,xceb222b,
                  xceb222c,xceb222d,xceb222e,xceb222f,xceb222g,xceb222h,xceb301,xceb302,xceb107,xceb108,xceb109,
                  xceb121,xceb122,xceb123,xceb124,xceb125,xceb126,xceb127,xceb128,xceb129,xceb130,xceb131,xceb132,
                  sfaa009,sfaasite,sfaa028,sfaa029,sfaa052,sfaa057)
                SELECT ",g_enterprise," xcebent,'",g_xcea_m.xceacomp,"' xcebcomp,'",g_xcea_m.xceald,"' xcebld,'",g_xcea_m.xceadocno,"' xcebdocno,
                       rownum xcebseq,xcch006 xceb001,0 xceb002,sfaa003 xceb003,xcch007 xceb004,xcch008 xceb005,'' xceb101,
                       (SELECT glab010 FROM glab_t WHERE glabld  = '",g_xcea_m.xceald,"' AND glab001 = '61' AND glab002 = '8925' AND glab003 = '1' AND glabent = xcchent) xceb102,
                       xcch002 xceb103,'' xceb110,CASE WHEN sfaa052 = 2 THEN sfaa009 ELSE ' ' END xceb111,'' xceb112,'' xceb113,(SELECT ooeg004 FROM ooeg_t WHERE ooegent = sfaaent AND ooeg001 = sfaa017) xceb114,
                       '' xceb115,'' xceb116,(SELECT imag011 FROM imag_t WHERE imagent = xcchent AND imagsite = '",g_xcea_m.xceacomp,"' AND imag001 = xcch007) xceb117,
                       '' xceb118,'' xceb119,'' xceb120,xceb201,
                       xceb202,xceb202a,xceb202b,xceb202c,xceb202d,xceb202e,xceb202f,xceb202g,xceb202h,
                       xceb212,xceb212a,xceb212b,xceb212c,xceb212d,xceb212e,xceb212f,xceb212g,xceb212h,
                       xceb222,xceb222a,xceb222b,xceb222c,xceb222d,xceb222e,xceb222f,xceb222g,xceb222h,
                       '' xceb301,'' xceb302,' ' xceb107,CASE WHEN sfaa068 IS NULL THEN ' ' ELSE sfaa068 END xceb108,
                       ' ' xceb109,' ' xceb121,' ' xceb122,' ' xceb123,' ' xceb124,' ' xceb125,' ' xceb126,' ' xceb127,' ' xceb128,' ' xceb129,' ' xceb130,'' xceb131,'' xceb132,
                       sfaa009,sfaasite,sfaa028,sfaa029,sfaa052,sfaa057 
                  FROM (
                  SELECT xcchent,xcch006,xcch007,xcch008,xcch002,SUM(xceb201) xceb201,
                         SUM(xceb202) xceb202,SUM(xceb202a) xceb202a,SUM(xceb202b) xceb202b,SUM(xceb202c) xceb202c,SUM(xceb202d) xceb202d,SUM(xceb202e) xceb202e,SUM(xceb202f) xceb202f,SUM(xceb202g) xceb202g,SUM(xceb202h) xceb202h,
                         SUM(xceb212) xceb212,SUM(xceb212a) xceb212a,SUM(xceb212b) xceb212b,SUM(xceb212c) xceb212c,SUM(xceb212d) xceb212d,SUM(xceb212e) xceb212e,SUM(xceb212f) xceb212f,SUM(xceb212g) xceb212g,SUM(xceb212h) xceb212h,
                         SUM(xceb222) xceb222,SUM(xceb222a) xceb222a,SUM(xceb222b) xceb222b,SUM(xceb222c) xceb222c,SUM(xceb222d) xceb222d,SUM(xceb222e) xceb222e,SUM(xceb222f) xceb222f,SUM(xceb222g) xceb222g,SUM(xceb222h) xceb222h
                    FROM
                     (SELECT xcchent,xcch006,xcch007,xcch008,xcch002,xcch001,
                            SUM(xcci201)+SUM(xcci301) xceb201,SUM(xcci202)+SUM(xcci302) xceb202,SUM(xcci202a)+SUM(xcci302a) xceb202a,
                            SUM(xcci202b)+SUM(xcci302b) xceb202b,SUM(xcci202c)+SUM(xcci302c) xceb202c,SUM(xcci202d)+SUM(xcci302d) xceb202d,SUM(xcci202e)+SUM(xcci302e) xceb202e,
                            SUM(xcci202f)+SUM(xcci302f) xceb202f,SUM(xcci202g)+SUM(xcci302g) xceb202g,SUM(xcci202h)+SUM(xcci302h) xceb202h,
                            SUM(CASE WHEN xcch001 = '2' THEN xcci202  ELSE 0 END)+SUM(CASE WHEN xcch001 = '2' THEN xcci302  ELSE 0 END) xceb212,
                            SUM(CASE WHEN xcch001 = '2' THEN xcci202a ELSE 0 END)+SUM(CASE WHEN xcch001 = '2' THEN xcci302a ELSE 0 END) xceb212a,
                            SUM(CASE WHEN xcch001 = '2' THEN xcci202b ELSE 0 END)+SUM(CASE WHEN xcch001 = '2' THEN xcci302b ELSE 0 END) xceb212b,
                            SUM(CASE WHEN xcch001 = '2' THEN xcci202c ELSE 0 END)+SUM(CASE WHEN xcch001 = '2' THEN xcci302c ELSE 0 END) xceb212c,
                            SUM(CASE WHEN xcch001 = '2' THEN xcci202d ELSE 0 END)+SUM(CASE WHEN xcch001 = '2' THEN xcci302d ELSE 0 END) xceb212d,
                            SUM(CASE WHEN xcch001 = '2' THEN xcci202e ELSE 0 END)+SUM(CASE WHEN xcch001 = '2' THEN xcci302e ELSE 0 END) xceb212e,
                            SUM(CASE WHEN xcch001 = '2' THEN xcci202f ELSE 0 END)+SUM(CASE WHEN xcch001 = '2' THEN xcci302f ELSE 0 END) xceb212f,
                            SUM(CASE WHEN xcch001 = '2' THEN xcci202g ELSE 0 END)+SUM(CASE WHEN xcch001 = '2' THEN xcci302g ELSE 0 END) xceb212g,
                            SUM(CASE WHEN xcch001 = '2' THEN xcci202h ELSE 0 END)+SUM(CASE WHEN xcch001 = '2' THEN xcci302h ELSE 0 END) xceb212h,
                            SUM(CASE WHEN xcch001 = '3' THEN xcci202  ELSE 0 END)+SUM(CASE WHEN xcch001 = '2' THEN xcci302  ELSE 0 END) xceb222,
                            SUM(CASE WHEN xcch001 = '3' THEN xcci202a ELSE 0 END)+SUM(CASE WHEN xcch001 = '2' THEN xcci302a ELSE 0 END) xceb222a,
                            SUM(CASE WHEN xcch001 = '3' THEN xcci202b ELSE 0 END)+SUM(CASE WHEN xcch001 = '2' THEN xcci302b ELSE 0 END) xceb222b,
                            SUM(CASE WHEN xcch001 = '3' THEN xcci202c ELSE 0 END)+SUM(CASE WHEN xcch001 = '2' THEN xcci302c ELSE 0 END) xceb222c,
                            SUM(CASE WHEN xcch001 = '3' THEN xcci202d ELSE 0 END)+SUM(CASE WHEN xcch001 = '2' THEN xcci302d ELSE 0 END) xceb222d,
                            SUM(CASE WHEN xcch001 = '3' THEN xcci202e ELSE 0 END)+SUM(CASE WHEN xcch001 = '2' THEN xcci302e ELSE 0 END) xceb222e,
                            SUM(CASE WHEN xcch001 = '3' THEN xcci202f ELSE 0 END)+SUM(CASE WHEN xcch001 = '2' THEN xcci302f ELSE 0 END) xceb222f,
                            SUM(CASE WHEN xcch001 = '3' THEN xcci202g ELSE 0 END)+SUM(CASE WHEN xcch001 = '2' THEN xcci302g ELSE 0 END) xceb222g,
                            SUM(CASE WHEN xcch001 = '3' THEN xcci202h ELSE 0 END)+SUM(CASE WHEN xcch001 = '2' THEN xcci302h ELSE 0 END) xceb222h
                       FROM xcch_t,xcci_t
                      WHERE xcchent = ",g_enterprise," AND xcchld = '",g_xcea_m.xceald,"'
                        AND xcch003 = '",g_xcea_m.xcea003,"' AND xcch004 = ",g_xcea_m.xcea004,"
                        AND xcch005 = ",g_xcea_m.xcea005,"
                        AND xccient = xcchent
                        AND xccild  = xcchld
                        AND xcci001 = xcch001
                        AND xcci003 = xcch003
                        AND xcci004 = xcch004
                        AND xcci005 = xcch005
                        AND xcci006 = xcch006
                        AND xcci007 != 'DL+OH+SUB'
                      GROUP BY xcchent,xcch006,xcch007,xcch008,xcch002,xcch001
                      ORDER BY xcchent,xcch006,xcch007,xcch008,xcch002,xcch001)
                   GROUP BY xcchent,xcch006,xcch007,xcch008,xcch002),sfaa_t
                 WHERE sfaaent = xcchent AND sfaadocno = xcch006 AND xceb202 <> 0"
   PREPARE axct701_01_ins_tmp2 FROM g_sql
   EXECUTE axct701_01_ins_tmp2

   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (         SELECT pmaa090,pmaa241,pmaa001 
                            FROM pmaa_t 
                               WHERE pmaaent = ",g_enterprise," )        ",
                   "    ON (xceb111=pmaa001)                        ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb112 = pmaa090,",
                   "               xceb113 = pmaa241    ",
                   "     WHERE sfaa052 = '2'"
   PREPARE axct701_01_meg_08 FROM g_sql
   EXECUTE axct701_01_meg_08

   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT ooef153,ooef001 FROM ooef_t
          WHERE ooefent = ",g_enterprise," )        ",
                   "    ON (sfaasite=ooef001)                        ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb112 = ' ',",
                   "               xceb113 = ooef153    ",
                   "     WHERE sfaa052 <> '2'"
   PREPARE axct701_01_meg_09 FROM g_sql
   EXECUTE axct701_01_meg_09

   #抓取科目
   #STEP1
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   #" USING (SELECT glcc002,glcc016,glcc011 FROM glcc_t       ",     #170221-00041#1 mark 
                   " USING (SELECT DISTINCT glcc002,glcc016,glcc011 FROM glcc_t  ",  #170221-00041#1 add                    
                   " WHERE glccent = ",g_enterprise,"  AND glcc001 = '4'  AND glccld  = '",g_xcea_m.xceald,"'
   AND ( glcc014='",g_xcea_m.xceacomp,"' OR glcc014='*' ) )        ",
                   "    ON ((glcc016=xceb004 OR glcc016 = '*') AND (glcc011=xceb117 OR glcc011='*') ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb101 = glcc002",
                   "     WHERE sfaa057 = '2'"
   PREPARE axct701_01_meg_10 FROM g_sql
   EXECUTE axct701_01_meg_10
   #STEP2
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   #" USING (SELECT glcc002,glcc016,glcc011 FROM glcc_t       ",     #170221-00041#1 mark 
                   " USING (SELECT DISTINCT glcc002,glcc016,glcc011 FROM glcc_t  ",  #170221-00041#1 add
                   " WHERE glccent = ",g_enterprise,"  AND glcc001 = '3'  AND glccld  = '",g_xcea_m.xceald,"'
   AND ( glcc014='",g_xcea_m.xceacomp,"' OR glcc014='*' ) )        ",
                   "    ON ((glcc016=xceb004 OR glcc016 = '*') AND (glcc011=xceb117 OR glcc011='*') ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb101 = glcc002",
                   "     WHERE sfaa057 <> '2'"
   PREPARE axct701_01_meg_11 FROM g_sql
   EXECUTE axct701_01_meg_11
   #STEP3
   SELECT glab005 INTO l_glab005
     FROM glab_t
    WHERE glabld  = g_xcea_m.xceald
      AND glab001 = '60'
      AND glab002 = '8912'
      AND glab003 = '1'
      AND glabent = g_enterprise
   UPDATE sourse_ins_tmp SET xceb101 = l_glab005
    WHERE xceb101 IS NULL

  #启用交易对象
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad010 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad010 = 'N'  ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb111 = ' '"
   PREPARE axct701_01_meg_xceb1111 FROM g_sql
   EXECUTE axct701_01_meg_xceb1111

  #启用客群
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad011 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad011 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb112 = ' '"
   PREPARE axct701_01_meg_xceb1121 FROM g_sql
   EXECUTE axct701_01_meg_xceb1121

  #启用区域
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad009 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad009 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb113 = ' '"
   PREPARE axct701_01_meg_xceb1131 FROM g_sql
   EXECUTE axct701_01_meg_xceb1131

  #启用成本中心
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad008 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad008 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb114 = ' '"
   PREPARE axct701_01_meg_xceb1141 FROM g_sql
   EXECUTE axct701_01_meg_xceb1141
   
  #启用经营类别
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad031 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad031 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb115 = ' '"
   PREPARE axct701_01_meg_xceb1151 FROM g_sql
   EXECUTE axct701_01_meg_xceb1151
 
  #启用渠道
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad032 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad032 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb116 = ' '"
   PREPARE axct701_01_meg_xceb1161 FROM g_sql
   EXECUTE axct701_01_meg_xceb1161

  #启用品类
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad012 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad012 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb117 = ' '"
   PREPARE axct701_01_meg_xceb1171 FROM g_sql
   EXECUTE axct701_01_meg_xceb1171
   
  #启用品牌
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad033 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad033 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb118 = ' '"
   PREPARE axct701_01_meg_xceb1181 FROM g_sql
   EXECUTE axct701_01_meg_xceb1181
 
  #启用项目号
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad015 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad015 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb119 = ' '"
   PREPARE axct701_01_meg_xceb1191 FROM g_sql
   EXECUTE axct701_01_meg_xceb1191
 
  #启用WBS
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad016 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad016 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb120 = ' '"
   PREPARE axct701_01_meg_xceb1201 FROM g_sql
   EXECUTE axct701_01_meg_xceb1201
 
  #启用人员
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad013 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad013 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb107 = ' '"
   PREPARE axct701_01_meg_xceb1071 FROM g_sql
   EXECUTE axct701_01_meg_xceb1071
 
  #启用部门
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad007 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad007 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb108 = ' '"
   PREPARE axct701_01_meg_xceb1081 FROM g_sql
   EXECUTE axct701_01_meg_xceb1081
   
  #启用账款对象
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad027 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad027 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb109 = ' '"
   PREPARE axct701_01_meg_xceb1091 FROM g_sql
   EXECUTE axct701_01_meg_xceb1091
   
  #启用自由核算项1
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad017 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad017 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb121 = ' '"
   PREPARE axct701_01_meg_xceb1211 FROM g_sql
   EXECUTE axct701_01_meg_xceb1211
 
  #启用自由核算项2
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad018 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad018 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb122 = ' '"
   PREPARE axct701_01_meg_xceb1221 FROM g_sql
   EXECUTE axct701_01_meg_xceb1221
 
  #启用自由核算项3
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad019 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad019 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb123 = ' '"
   PREPARE axct701_01_meg_xceb1231 FROM g_sql
   EXECUTE axct701_01_meg_xceb1231

  #启用自由核算项4
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad019 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad019 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb124 = ' '"
   PREPARE axct701_01_meg_xceb1241 FROM g_sql
   EXECUTE axct701_01_meg_xceb1241

  #启用自由核算项5
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad021 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad021 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb125 = ' '"
   PREPARE axct701_01_meg_xceb1251 FROM g_sql
   EXECUTE axct701_01_meg_xceb1251

  #启用自由核算项6
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad022 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad022 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb126 = ' '"
   PREPARE axct701_01_meg_xceb1261 FROM g_sql
   EXECUTE axct701_01_meg_xceb1261

  #启用自由核算项7
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad023 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad023 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb127 = ' '"
   PREPARE axct701_01_meg_xceb1271 FROM g_sql
   EXECUTE axct701_01_meg_xceb1271

  #启用自由核算项8
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad024 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad024 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb128 = ' '"
   PREPARE axct701_01_meg_xceb1281 FROM g_sql
   EXECUTE axct701_01_meg_xceb1281

  #启用自由核算项9
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad025 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad025 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb129 = ' '"
   PREPARE axct701_01_meg_xceb1291 FROM g_sql
   EXECUTE axct701_01_meg_xceb1291

  #启用自由核算项10
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad026 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad026 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb130 = ' '"
   PREPARE axct701_01_meg_xceb1301 FROM g_sql
   EXECUTE axct701_01_meg_xceb1301

  #来源单项次
   UPDATE sourse_ins_tmp SET xceb002 = ''
  #特性
   UPDATE sourse_ins_tmp SET xceb005 = ' ' WHERE xceb005 IS NULL
 #科目编号
   UPDATE sourse_ins_tmp SET xceb101 = ' ' WHERE xceb101 IS NULL
  #摘要
   UPDATE sourse_ins_tmp SET xceb102 = ' ' WHERE xceb102 IS NULL
  #成本域
   UPDATE sourse_ins_tmp SET xceb103 = ' ' WHERE xceb103 IS NULL
  #原因码
   UPDATE sourse_ins_tmp SET xceb110 = ' ' WHERE xceb110 IS NULL
  #交易对象
   UPDATE sourse_ins_tmp SET xceb111 = ' ' WHERE xceb111 IS NULL
  #客群
   UPDATE sourse_ins_tmp SET xceb112 = ' ' WHERE xceb112 IS NULL
  #区域
   UPDATE sourse_ins_tmp SET xceb113 = ' ' WHERE xceb113 IS NULL
  #成本中心
   UPDATE sourse_ins_tmp SET xceb114 = ' ' WHERE xceb114 IS NULL
  #经营类别
   UPDATE sourse_ins_tmp SET xceb115 = ' ' WHERE xceb115 IS NULL
  #渠道
   UPDATE sourse_ins_tmp SET xceb116 = ' ' WHERE xceb116 IS NULL
  #品类
   UPDATE sourse_ins_tmp SET xceb117 = ' ' WHERE xceb117 IS NULL
  #品牌
   UPDATE sourse_ins_tmp SET xceb118 = ' ' WHERE xceb118 IS NULL
  #项目号
   UPDATE sourse_ins_tmp SET xceb119 = ' ' WHERE xceb119 IS NULL
  #WBS
   UPDATE sourse_ins_tmp SET xceb120 = ' ' WHERE xceb120 IS NULL
  #人员
   UPDATE sourse_ins_tmp SET xceb107 = ' ' WHERE xceb107 IS NULL
   #部门
   UPDATE sourse_ins_tmp SET xceb108 = ' ' WHERE xceb108 IS NULL
  #账款对象
   UPDATE sourse_ins_tmp SET xceb109 = ' ' WHERE xceb109 IS NULL
  #自由核算项1
   UPDATE sourse_ins_tmp SET xceb121 = ' ' WHERE xceb121 IS NULL
  #自由核算项2
   UPDATE sourse_ins_tmp SET xceb122 = ' ' WHERE xceb122 IS NULL
  #自由核算项3
   UPDATE sourse_ins_tmp SET xceb123 = ' ' WHERE xceb123 IS NULL
  #自由核算项4
   UPDATE sourse_ins_tmp SET xceb124 = ' ' WHERE xceb124 IS NULL
  #自由核算项5
   UPDATE sourse_ins_tmp SET xceb125 = ' ' WHERE xceb125 IS NULL
  #自由核算项6
   UPDATE sourse_ins_tmp SET xceb126 = ' ' WHERE xceb126 IS NULL
   #自由核算项7
   UPDATE sourse_ins_tmp SET xceb127 = ' ' WHERE xceb127 IS NULL
  #自由核算项8
   UPDATE sourse_ins_tmp SET xceb128 = ' ' WHERE xceb128 IS NULL
  #自由核算项9
   UPDATE sourse_ins_tmp SET xceb129 = ' ' WHERE xceb129 IS NULL
  #自由核算项10
   UPDATE sourse_ins_tmp SET xceb130 = ' ' WHERE xceb130 IS NULL

   #項次
   LET l_xcebseq = 0
   SELECT MAX(xcebseq) INTO l_xcebseq FROM xceb_t
    WHERE xcebent = g_enterprise 
      AND xcebld = g_xcea_m.xceald
      AND xcebdocno = g_xcea_m.xceadocno
   IF cl_null(l_xcebseq) OR l_xcebseq = 0 THEN
      LET l_xcebseq = 0
   END IF   

   INSERT INTO xceb_t (xcebent,xcebcomp,xcebld,xcebdocno,xcebseq,
                       xceb001,xceb002,xceb003,xceb004,xceb005,xceb101,xceb102,xceb103,xceb110,xceb111,
                       xceb112,xceb113,xceb114,xceb115,xceb116,xceb117,xceb118,xceb119,xceb120,xceb201,
                       xceb202,xceb202a,xceb202b,xceb202c,xceb202d,xceb202e,xceb202f,xceb202g,xceb202h,
                       xceb212,xceb212a,xceb212b,xceb212c,xceb212d,xceb212e,xceb212f,xceb212g,xceb212h,
                       xceb222,xceb222a,xceb222b,xceb222c,xceb222d,xceb222e,xceb222f,xceb222g,xceb222h,
                       xceb301,xceb302,xceb107,xceb108,xceb109,xceb121,xceb122,xceb123,xceb124,xceb125,
                       xceb126,xceb127,xceb128,xceb129,xceb130,xceb131,xceb132)
         SELECT xcebent,xcebcomp,xcebld,xcebdocno,xcebseq + l_xcebseq,
                       xceb001,xceb002,xceb003,xceb004,xceb005,xceb101,xceb102,xceb103,xceb110,xceb111,
                       xceb112,xceb113,xceb114,xceb115,xceb116,xceb117,xceb118,xceb119,xceb120,xceb201,
                       xceb202,xceb202a,xceb202b,xceb202c,xceb202d,xceb202e,xceb202f,xceb202g,xceb202h,
                       xceb212,xceb212a,xceb212b,xceb212c,xceb212d,xceb212e,xceb212f,xceb212g,xceb212h,
                       xceb222,xceb222a,xceb222b,xceb222c,xceb222d,xceb222e,xceb222f,xceb222g,xceb222h,
                       xceb301,xceb302,xceb107,xceb108,xceb109,xceb121,xceb122,xceb123,xceb124,xceb125,
                       xceb126,xceb127,xceb128,xceb129,xceb130,xceb131,xceb132
           FROM sourse_ins_tmp

   #拆件工單 xcci_t
   #帳套本位幣順序+工單+元件
   #170214-00020#1 modify imagsite = 'DSCTP' 調整成 imagsite = 'g_xcea_m.xceacomp'
   DELETE FROM sourse_ins_tmp1
   LET g_sql = "INSERT INTO sourse_ins_tmp1
                 (xcecent,xceccomp,xcecld,xcecdocno,xcecseq,xcec001,xcec002,xcec003,xcec004,xcec005,xcec101,xcec102,
                  xcec103,xcec110,xcec111,xcec112,xcec113,xcec114,xcec115,xcec116,xcec117,xcec118,xcec119,xcec120,
                  xcec201,xcec202,xcec202a,xcec202b,xcec202c,xcec202d,xcec202e,xcec202f,xcec202g,xcec202h,xcec212,
                  xcec212a,xcec212b,xcec212c,xcec212d,xcec212e,xcec212f,xcec212g,xcec212h,xcec222,xcec222a,xcec222b,
                  xcec222c,xcec222d,xcec222e,xcec222f,xcec222g,xcec222h,xcec301,xcec302,xcec107,xcec108,xcec109,
                  xcec121,xcec122,xcec123,xcec124,xcec125,xcec126,xcec127,xcec128,xcec129,xcec130,
                  sfaa009,sfaasite,sfaa028,sfaa029,sfaa052,sfaa057)
                SELECT ",g_enterprise," xcecent,'",g_xcea_m.xceacomp,"' xceccomp,'",g_xcea_m.xceald,"' xcecld,'",g_xcea_m.xceadocno,"' xcecdocno,
                       rownum xcecseq,xcci006 xcec001,0 xcec002,sfaa003 xcec003,xcci007 xcec004,xcci008 xcec005,'' xcec101,
                       (SELECT glab010 FROM glab_t WHERE glabld  = '",g_xcea_m.xceald,"' AND glab001 = '61' AND glab002 = '8925' AND glab003 = '1' AND glabent = xccient) xcec102,
                       xcci002 xcec103,'' xcec110,CASE WHEN sfaa052 = 2 THEN sfaa009 ELSE ' ' END xcec111,'' xcec112,'' xcec113,(SELECT ooeg004 FROM ooeg_t WHERE ooegent = sfaaent AND ooeg001 = sfaa017) xcec114,
                       '' xcec115,'' xcec116,(SELECT imag011 FROM imag_t WHERE imagent = xccient AND imagsite = '",g_xcea_m.xceacomp,"' AND imag001 = xcci007) xcec117,
                       '' xcec118,'' xcec119,'' xcec120,xcec201,
                       xcec202,xcec202a,xcec202b,xcec202c,xcec202d,xcec202e,xcec202f,xcec202g,xcec202h,
                       xcec212,xcec212a,xcec212b,xcec212c,xcec212d,xcec212e,xcec212f,xcec212g,xcec212h,
                       xcec222,xcec222a,xcec222b,xcec222c,xcec222d,xcec222e,xcec222f,xcec222g,xcec222h,
                       '' xcec301,'' xcec302,' ' xcec107,CASE WHEN sfaa068 IS NULL THEN ' ' ELSE sfaa068 END xcec108,
                       ' ' xcec109,' ' xcec121,' ' xcec122,' ' xcec123,' ' xcec124,' ' xcec125,' ' xcec126,' ' xcec127,' ' xcec128,' ' xcec129,' ' xcec130,
                       sfaa009,sfaasite,sfaa028,sfaa029,sfaa052,sfaa057 
                  FROM (
                  SELECT xccient,xcci006,xcci007,xcci008,xcci002,SUM(xcec201) xcec201,
                         SUM(xcec202) xcec202,SUM(xcec202a) xcec202a,SUM(xcec202b) xcec202b,SUM(xcec202c) xcec202c,SUM(xcec202d) xcec202d,SUM(xcec202e) xcec202e,SUM(xcec202f) xcec202f,SUM(xcec202g) xcec202g,SUM(xcec202h) xcec202h,
                         SUM(xcec212) xcec212,SUM(xcec212a) xcec212a,SUM(xcec212b) xcec212b,SUM(xcec212c) xcec212c,SUM(xcec212d) xcec212d,SUM(xcec212e) xcec212e,SUM(xcec212f) xcec212f,SUM(xcec212g) xcec212g,SUM(xcec212h) xcec212h,
                         SUM(xcec222) xcec222,SUM(xcec222a) xcec222a,SUM(xcec222b) xcec222b,SUM(xcec222c) xcec222c,SUM(xcec222d) xcec222d,SUM(xcec222e) xcec222e,SUM(xcec222f) xcec222f,SUM(xcec222g) xcec222g,SUM(xcec222h) xcec222h
                    FROM
                     (SELECT xccient,xcci006,xcci007,xcci008,xcci002,xcci001,
                            SUM(xcci201)+SUM(xcci301) xcec201,SUM(xcci202)+SUM(xcci302) xcec202,SUM(xcci202a)+SUM(xcci302a) xcec202a,
                            SUM(xcci202b)+SUM(xcci302b) xcec202b,SUM(xcci202c)+SUM(xcci302c) xcec202c,SUM(xcci202d)+SUM(xcci302d) xcec202d,SUM(xcci202e)+SUM(xcci302e) xcec202e,
                            SUM(xcci202f)+SUM(xcci302f) xcec202f,SUM(xcci202g)+SUM(xcci302g) xcec202g,SUM(xcci202h)+SUM(xcci302h) xcec202h,
                            SUM(CASE WHEN xcci001 = '2' THEN xcci202  ELSE 0 END)+SUM(CASE WHEN xcci001 = '2' THEN xcci302  ELSE 0 END) xcec212,
                            SUM(CASE WHEN xcci001 = '2' THEN xcci202a ELSE 0 END)+SUM(CASE WHEN xcci001 = '2' THEN xcci302a ELSE 0 END) xcec212a,
                            SUM(CASE WHEN xcci001 = '2' THEN xcci202b ELSE 0 END)+SUM(CASE WHEN xcci001 = '2' THEN xcci302b ELSE 0 END) xcec212b,
                            SUM(CASE WHEN xcci001 = '2' THEN xcci202c ELSE 0 END)+SUM(CASE WHEN xcci001 = '2' THEN xcci302c ELSE 0 END) xcec212c,
                            SUM(CASE WHEN xcci001 = '2' THEN xcci202d ELSE 0 END)+SUM(CASE WHEN xcci001 = '2' THEN xcci302d ELSE 0 END) xcec212d,
                            SUM(CASE WHEN xcci001 = '2' THEN xcci202e ELSE 0 END)+SUM(CASE WHEN xcci001 = '2' THEN xcci302e ELSE 0 END) xcec212e,
                            SUM(CASE WHEN xcci001 = '2' THEN xcci202f ELSE 0 END)+SUM(CASE WHEN xcci001 = '2' THEN xcci302f ELSE 0 END) xcec212f,
                            SUM(CASE WHEN xcci001 = '2' THEN xcci202g ELSE 0 END)+SUM(CASE WHEN xcci001 = '2' THEN xcci302g ELSE 0 END) xcec212g,
                            SUM(CASE WHEN xcci001 = '2' THEN xcci202h ELSE 0 END)+SUM(CASE WHEN xcci001 = '2' THEN xcci302h ELSE 0 END) xcec212h,
                            SUM(CASE WHEN xcci001 = '3' THEN xcci202  ELSE 0 END)+SUM(CASE WHEN xcci001 = '2' THEN xcci302  ELSE 0 END) xcec222,
                            SUM(CASE WHEN xcci001 = '3' THEN xcci202a ELSE 0 END)+SUM(CASE WHEN xcci001 = '2' THEN xcci302a ELSE 0 END) xcec222a,
                            SUM(CASE WHEN xcci001 = '3' THEN xcci202b ELSE 0 END)+SUM(CASE WHEN xcci001 = '2' THEN xcci302b ELSE 0 END) xcec222b,
                            SUM(CASE WHEN xcci001 = '3' THEN xcci202c ELSE 0 END)+SUM(CASE WHEN xcci001 = '2' THEN xcci302c ELSE 0 END) xcec222c,
                            SUM(CASE WHEN xcci001 = '3' THEN xcci202d ELSE 0 END)+SUM(CASE WHEN xcci001 = '2' THEN xcci302d ELSE 0 END) xcec222d,
                            SUM(CASE WHEN xcci001 = '3' THEN xcci202e ELSE 0 END)+SUM(CASE WHEN xcci001 = '2' THEN xcci302e ELSE 0 END) xcec222e,
                            SUM(CASE WHEN xcci001 = '3' THEN xcci202f ELSE 0 END)+SUM(CASE WHEN xcci001 = '2' THEN xcci302f ELSE 0 END) xcec222f,
                            SUM(CASE WHEN xcci001 = '3' THEN xcci202g ELSE 0 END)+SUM(CASE WHEN xcci001 = '2' THEN xcci302g ELSE 0 END) xcec222g,
                            SUM(CASE WHEN xcci001 = '3' THEN xcci202h ELSE 0 END)+SUM(CASE WHEN xcci001 = '2' THEN xcci302h ELSE 0 END) xcec222h
                       FROM xcci_t
                      WHERE xccient = ",g_enterprise," AND xccild = '",g_xcea_m.xceald,"'
                        AND xcci003 = '",g_xcea_m.xcea003,"' AND xcci004 = ",g_xcea_m.xcea004,"
                        AND xcci005 = ",g_xcea_m.xcea005,"
                        AND xcci007 != 'DL+OH+SUB'
                      GROUP BY xccient,xcci006,xcci007,xcci008,xcci002,xcci001
                      ORDER BY xccient,xcci006,xcci007,xcci008,xcci002,xcci001)
                   GROUP BY xccient,xcci006,xcci007,xcci008,xcci002),sfaa_t
                 WHERE sfaaent = xccient AND sfaadocno = xcci006 AND xcec202 <> 0"
   PREPARE axct701_01_ins_tmp4 FROM g_sql
   EXECUTE axct701_01_ins_tmp4

   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (         SELECT pmaa090,pmaa241,pmaa001 
                            FROM pmaa_t 
                               WHERE pmaaent = ",g_enterprise," )        ",
                   "    ON (xcec111=pmaa001)                        ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec112 = pmaa090,",
                   "               xcec113 = pmaa241    ",
                   "     WHERE sfaa052 = '2'"
   PREPARE axct701_01_meg_12 FROM g_sql
   EXECUTE axct701_01_meg_12

   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT ooef153,ooef001 FROM ooef_t
          WHERE ooefent = ",g_enterprise," )        ",
                   "    ON (sfaasite=ooef001)                        ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec112 = ' ',",
                   "               xcec113 = ooef153    ",
                   "     WHERE sfaa052 <> '2'"
   PREPARE axct701_01_meg_13 FROM g_sql
   EXECUTE axct701_01_meg_13

   #抓取科目
   #STEP1
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   #" USING (SELECT glcc002,glcc016,glcc011 FROM glcc_t       ",     #170221-00041#1 mark 
                   " USING (SELECT DISTINCT glcc002,glcc016,glcc011 FROM glcc_t  ",  #170221-00041#1 add                   
                   " WHERE glccent = ",g_enterprise,"  AND glcc001 = '1'  AND glccld  = '",g_xcea_m.xceald,"'
   AND ( glcc014='",g_xcea_m.xceacomp,"' OR glcc014='*' ) )        ",
                   "    ON ((glcc016=xcec004 OR glcc016 = '*') AND (glcc011=xcec117 OR glcc011='*') ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec101 = glcc002"
   PREPARE axct701_01_meg_14 FROM g_sql
   EXECUTE axct701_01_meg_14

  #启用交易对象
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad010 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad010 = 'N'  ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec111 = ' '"
   PREPARE axct701_01_meg_xcec1111 FROM g_sql
   EXECUTE axct701_01_meg_xcec1111

  #启用客群
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad011 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad011 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec112 = ' '"
   PREPARE axct701_01_meg_xcec1121 FROM g_sql
   EXECUTE axct701_01_meg_xcec1121

  #启用区域
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad009 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad009 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec113 = ' '"
   PREPARE axct701_01_meg_xcec1131 FROM g_sql
   EXECUTE axct701_01_meg_xcec1131

   
  #启用成本中心
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad008 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad008 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec114 = ' '"
   PREPARE axct701_01_meg_xcec1141 FROM g_sql
   EXECUTE axct701_01_meg_xcec1141
   
  #启用经营类别
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad031 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad031 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec115 = ' '"
   PREPARE axct701_01_meg_xcec1151 FROM g_sql
   EXECUTE axct701_01_meg_xcec1151
 
  #启用渠道
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad032 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad032 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec116 = ' '"
   PREPARE axct701_01_meg_xcec1161 FROM g_sql
   EXECUTE axct701_01_meg_xcec1161

  #启用品类
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad012 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad012 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec117 = ' '"
   PREPARE axct701_01_meg_xcec1171 FROM g_sql
   EXECUTE axct701_01_meg_xcec1171
   
  #启用品牌
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad033 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad033 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec118 = ' '"
   PREPARE axct701_01_meg_xcec1181 FROM g_sql
   EXECUTE axct701_01_meg_xcec1181
 
  #启用项目号
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad015 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad015 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec119 = ' '"
   PREPARE axct701_01_meg_xcec1191 FROM g_sql
   EXECUTE axct701_01_meg_xcec1191
 
  #启用WBS
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad016 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad016 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec120 = ' '"
   PREPARE axct701_01_meg_xcec1201 FROM g_sql
   EXECUTE axct701_01_meg_xcec1201
 
  #启用人员
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad013 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad013 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec107 = ' '"
   PREPARE axct701_01_meg_xcec1071 FROM g_sql
   EXECUTE axct701_01_meg_xcec1071
 
  #启用部门
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad007 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad007 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec108 = ' '"
   PREPARE axct701_01_meg_xcec1081 FROM g_sql
   EXECUTE axct701_01_meg_xcec1081
   
  #启用账款对象
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad027 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad027 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec109 = ' '"
   PREPARE axct701_01_meg_xcec1091 FROM g_sql
   EXECUTE axct701_01_meg_xcec1091
   
  #启用自由核算项1
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad017 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad017 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec121 = ' '"
   PREPARE axct701_01_meg_xcec1211 FROM g_sql
   EXECUTE axct701_01_meg_xcec1211
 
  #启用自由核算项2
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad018 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad018 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec122 = ' '"
   PREPARE axct701_01_meg_xcec1221 FROM g_sql
   EXECUTE axct701_01_meg_xcec1221
 
  #启用自由核算项3
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad019 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad019 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec123 = ' '"
   PREPARE axct701_01_meg_xcec1231 FROM g_sql
   EXECUTE axct701_01_meg_xcec1231

  #启用自由核算项4
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad019 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad019 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec124 = ' '"
   PREPARE axct701_01_meg_xcec1241 FROM g_sql
   EXECUTE axct701_01_meg_xcec1241

  #启用自由核算项5
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad021 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad021 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec125 = ' '"
   PREPARE axct701_01_meg_xcec1251 FROM g_sql
   EXECUTE axct701_01_meg_xcec1251

  #启用自由核算项6
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad022 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad022 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec126 = ' '"
   PREPARE axct701_01_meg_xcec1261 FROM g_sql
   EXECUTE axct701_01_meg_xcec1261

  #启用自由核算项7
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad023 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad023 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec127 = ' '"
   PREPARE axct701_01_meg_xcec1271 FROM g_sql
   EXECUTE axct701_01_meg_xcec1271

  #启用自由核算项8
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad024 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad024 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec128 = ' '"
   PREPARE axct701_01_meg_xcec1281 FROM g_sql
   EXECUTE axct701_01_meg_xcec1281

  #启用自由核算项9
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad025 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad025 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec129 = ' '"
   PREPARE axct701_01_meg_xcec1291 FROM g_sql
   EXECUTE axct701_01_meg_xcec1291

  #启用自由核算项10
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad026 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad026 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec130 = ' '"
   PREPARE axct701_01_meg_xcec1301 FROM g_sql
   EXECUTE axct701_01_meg_xcec1301

  #来源单项次
   UPDATE sourse_ins_tmp1 SET xcec002 = ''
  #特性
   UPDATE sourse_ins_tmp1 SET xcec005 = ' ' WHERE xcec005 IS NULL
 #科目编号
   UPDATE sourse_ins_tmp1 SET xcec101 = ' ' WHERE xcec101 IS NULL
  #摘要
   UPDATE sourse_ins_tmp1 SET xcec102 = ' ' WHERE xcec102 IS NULL
  #成本域
   UPDATE sourse_ins_tmp1 SET xcec103 = ' ' WHERE xcec103 IS NULL
  #原因码
   UPDATE sourse_ins_tmp1 SET xcec110 = ' ' WHERE xcec110 IS NULL
  #交易对象
   UPDATE sourse_ins_tmp1 SET xcec111 = ' ' WHERE xcec111 IS NULL
  #客群
   UPDATE sourse_ins_tmp1 SET xcec112 = ' ' WHERE xcec112 IS NULL
  #区域
   UPDATE sourse_ins_tmp1 SET xcec113 = ' ' WHERE xcec113 IS NULL
  #成本中心
   UPDATE sourse_ins_tmp1 SET xcec114 = ' ' WHERE xcec114 IS NULL
  #经营类别
   UPDATE sourse_ins_tmp1 SET xcec115 = ' ' WHERE xcec115 IS NULL
  #渠道
   UPDATE sourse_ins_tmp1 SET xcec116 = ' ' WHERE xcec116 IS NULL
  #品类
   UPDATE sourse_ins_tmp1 SET xcec117 = ' ' WHERE xcec117 IS NULL
  #品牌
   UPDATE sourse_ins_tmp1 SET xcec118 = ' ' WHERE xcec118 IS NULL
  #项目号
   UPDATE sourse_ins_tmp1 SET xcec119 = ' ' WHERE xcec119 IS NULL
  #WBS
   UPDATE sourse_ins_tmp1 SET xcec120 = ' ' WHERE xcec120 IS NULL
  #人员
   UPDATE sourse_ins_tmp1 SET xcec107 = ' ' WHERE xcec107 IS NULL
   #部门
   UPDATE sourse_ins_tmp1 SET xcec108 = ' ' WHERE xcec108 IS NULL
  #账款对象
   UPDATE sourse_ins_tmp1 SET xcec109 = ' ' WHERE xcec109 IS NULL
  #自由核算项1
   UPDATE sourse_ins_tmp1 SET xcec121 = ' ' WHERE xcec121 IS NULL
  #自由核算项2
   UPDATE sourse_ins_tmp1 SET xcec122 = ' ' WHERE xcec122 IS NULL
  #自由核算项3
   UPDATE sourse_ins_tmp1 SET xcec123 = ' ' WHERE xcec123 IS NULL
  #自由核算项4
   UPDATE sourse_ins_tmp1 SET xcec124 = ' ' WHERE xcec124 IS NULL
  #自由核算项5
   UPDATE sourse_ins_tmp1 SET xcec125 = ' ' WHERE xcec125 IS NULL
  #自由核算项6
   UPDATE sourse_ins_tmp1 SET xcec126 = ' ' WHERE xcec126 IS NULL
   #自由核算项7
   UPDATE sourse_ins_tmp1 SET xcec127 = ' ' WHERE xcec127 IS NULL
  #自由核算项8
   UPDATE sourse_ins_tmp1 SET xcec128 = ' ' WHERE xcec128 IS NULL
  #自由核算项9
   UPDATE sourse_ins_tmp1 SET xcec129 = ' ' WHERE xcec129 IS NULL
  #自由核算项10
   UPDATE sourse_ins_tmp1 SET xcec130 = ' ' WHERE xcec130 IS NULL AND xcecent=g_enterprise

   #項次
   SELECT MAX(xcecseq) INTO l_xcebseq FROM xcec_t
    WHERE xcecent = g_enterprise 
      AND xcecld = g_xcea_m.xceald
      AND xcecdocno = g_xcea_m.xceadocno
   IF cl_null(l_xcebseq) OR l_xcebseq = 0 THEN
      LET l_xcebseq = 0
   END IF   

   INSERT INTO xcec_t (xcecent,xceccomp,xcecld,xcecdocno,xcecseq,
                       xcec001,xcec002,xcec003,xcec004,xcec005,xcec101,xcec102,xcec103,xcec110,xcec111,
                       xcec112,xcec113,xcec114,xcec115,xcec116,xcec117,xcec118,xcec119,xcec120,xcec201,
                       xcec202,xcec202a,xcec202b,xcec202c,xcec202d,xcec202e,xcec202f,xcec202g,xcec202h,
                       xcec212,xcec212a,xcec212b,xcec212c,xcec212d,xcec212e,xcec212f,xcec212g,xcec212h,
                       xcec222,xcec222a,xcec222b,xcec222c,xcec222d,xcec222e,xcec222f,xcec222g,xcec222h,
                       xcec301,xcec302,xcec107,xcec108,xcec109,xcec121,xcec122,xcec123,xcec124,xcec125,
                       xcec126,xcec127,xcec128,xcec129,xcec130)
         SELECT xcecent,xceccomp,xcecld,xcecdocno,xcecseq + l_xcebseq,
                       xcec001,xcec002,xcec003,xcec004,xcec005,xcec101,xcec102,xcec103,xcec110,xcec111,
                       xcec112,xcec113,xcec114,xcec115,xcec116,xcec117,xcec118,xcec119,xcec120,xcec201,
                       xcec202,xcec202a,xcec202b,xcec202c,xcec202d,xcec202e,xcec202f,xcec202g,xcec202h,
                       xcec212,xcec212a,xcec212b,xcec212c,xcec212d,xcec212e,xcec212f,xcec212g,xcec212h,
                       xcec222,xcec222a,xcec222b,xcec222c,xcec222d,xcec222e,xcec222f,xcec222g,xcec222h,
                       xcec301,xcec302,xcec107,xcec108,xcec109,xcec121,xcec122,xcec123,xcec124,xcec125,
                       xcec126,xcec127,xcec128,xcec129,xcec130
           FROM sourse_ins_tmp1

   #第三單身
   CALL axct701_01_ins_xced() RETURNING l_success
   IF NOT l_success THEN LET g_success = 'N' END IF 

   RETURN g_success
#161215-00040#1 Add  ---(E)---   因效能优化,程序逻辑完全重写,旧代码保存在axct701_01_ins_bak中
END FUNCTION

################################################################################
# Descriptions...: 在制入庫新增   2.在製入庫憑證  axct702
# Memo...........:
# Usage..........: CALL axct701_01_ins_2()
# Input parameter: 
# Return code....:  
# Date & Author..: 2014/4/20 By 01531
# Modify.........:
################################################################################
PRIVATE FUNCTION axct701_01_ins_2()
#161215-00040#1 Add  ---(S)---   因效能优化,程序逻辑完全重写,旧代码保存在axct701_01_ins_2_bak中
DEFINE l_success       LIKE type_t.num5
DEFINE l_errno         LIKE gzze_t.gzze001
DEFINE l_xcea          RECORD  #工單發料成本憑證單頭檔
       xceaent LIKE xcea_t.xceaent, #企業編號
       xceacomp LIKE xcea_t.xceacomp, #法人組織
       xceald LIKE xcea_t.xceald, #帳套
       xceadocno LIKE xcea_t.xceadocno, #單據編號
       xcea001 LIKE xcea_t.xcea001, #單據日期
       xcea002 LIKE xcea_t.xcea002, #成本憑證類型
       xcea003 LIKE xcea_t.xcea003, #成本計算類型
       xcea004 LIKE xcea_t.xcea004, #年度
       xcea005 LIKE xcea_t.xcea005, #期別
       xcea006 LIKE xcea_t.xcea006, #帳務人員
       xcea007 LIKE xcea_t.xcea007, #帳務部門
       xcea101 LIKE xcea_t.xcea101, #憑證編號
       xcea102 LIKE xcea_t.xcea102, #憑證日期
       xceaownid LIKE xcea_t.xceaownid, #資料所有者
       xceaowndp LIKE xcea_t.xceaowndp, #資料所屬部門
       xceacrtid LIKE xcea_t.xceacrtid, #資料建立者
       xceacrtdp LIKE xcea_t.xceacrtdp, #資料建立部門
       xceacrtdt LIKE xcea_t.xceacrtdt, #資料創建日
       xceamodid LIKE xcea_t.xceamodid, #資料修改者
       xceamoddt LIKE xcea_t.xceamoddt, #最近修改日
       xceacnfid LIKE xcea_t.xceacnfid, #資料確認者
       xceacnfdt LIKE xcea_t.xceacnfdt, #資料確認日
       xceapstid LIKE xcea_t.xceapstid, #資料過帳者
       xceapstdt LIKE xcea_t.xceapstdt, #資料過帳日
       xceastus LIKE xcea_t.xceastus, #狀態碼
       xceaud001 LIKE xcea_t.xceaud001, #自定義欄位(文字)001
       xceaud002 LIKE xcea_t.xceaud002, #自定義欄位(文字)002
       xceaud003 LIKE xcea_t.xceaud003, #自定義欄位(文字)003
       xceaud004 LIKE xcea_t.xceaud004, #自定義欄位(文字)004
       xceaud005 LIKE xcea_t.xceaud005, #自定義欄位(文字)005
       xceaud006 LIKE xcea_t.xceaud006, #自定義欄位(文字)006
       xceaud007 LIKE xcea_t.xceaud007, #自定義欄位(文字)007
       xceaud008 LIKE xcea_t.xceaud008, #自定義欄位(文字)008
       xceaud009 LIKE xcea_t.xceaud009, #自定義欄位(文字)009
       xceaud010 LIKE xcea_t.xceaud010, #自定義欄位(文字)010
       xceaud011 LIKE xcea_t.xceaud011, #自定義欄位(數字)011
       xceaud012 LIKE xcea_t.xceaud012, #自定義欄位(數字)012
       xceaud013 LIKE xcea_t.xceaud013, #自定義欄位(數字)013
       xceaud014 LIKE xcea_t.xceaud014, #自定義欄位(數字)014
       xceaud015 LIKE xcea_t.xceaud015, #自定義欄位(數字)015
       xceaud016 LIKE xcea_t.xceaud016, #自定義欄位(數字)016
       xceaud017 LIKE xcea_t.xceaud017, #自定義欄位(數字)017
       xceaud018 LIKE xcea_t.xceaud018, #自定義欄位(數字)018
       xceaud019 LIKE xcea_t.xceaud019, #自定義欄位(數字)019
       xceaud020 LIKE xcea_t.xceaud020, #自定義欄位(數字)020
       xceaud021 LIKE xcea_t.xceaud021, #自定義欄位(日期時間)021
       xceaud022 LIKE xcea_t.xceaud022, #自定義欄位(日期時間)022
       xceaud023 LIKE xcea_t.xceaud023, #自定義欄位(日期時間)023
       xceaud024 LIKE xcea_t.xceaud024, #自定義欄位(日期時間)024
       xceaud025 LIKE xcea_t.xceaud025, #自定義欄位(日期時間)025
       xceaud026 LIKE xcea_t.xceaud026, #自定義欄位(日期時間)026
       xceaud027 LIKE xcea_t.xceaud027, #自定義欄位(日期時間)027
       xceaud028 LIKE xcea_t.xceaud028, #自定義欄位(日期時間)028
       xceaud029 LIKE xcea_t.xceaud029, #自定義欄位(日期時間)029
       xceaud030 LIKE xcea_t.xceaud030, #自定義欄位(日期時間)030
       xceasite LIKE xcea_t.xceasite  #營運據點
          END RECORD
DEFINE ld_date         DATETIME YEAR TO SECOND
DEFINE l_xcat005       LIKE xcat_t.xcat005  
DEFINE l_xcaz011       LIKE xcaz_t.xcaz011
DEFINE l_rate          LIKE type_t.num26_10
DEFINE l_rate1         LIKE type_t.num26_10
DEFINE l_glab005       LIKE glab_t.glab005

  #CALL axct701_01_create_tmp()   #170324-00054#1 mark

   LET g_success = 'Y'
   LET l_xcea.xceaownid = g_user
   LET l_xcea.xceaowndp = g_dept
   LET l_xcea.xceacrtid = g_user
   LET l_xcea.xceacrtdp = g_dept 
   LET ld_date  = cl_get_current()
   LET l_xcea.xceacrtdt = ld_date
   LET l_xcea.xceamodid = ""
   LET l_xcea.xceamoddt = ""
   CALL s_aooi200_fin_gen_docno(g_xcea_m.xceald,'','',g_xcea_m.xceadocno,g_xcea_m.xcea001,g_prog_name1)
    RETURNING l_success,g_xcea_m.xceadocno
   IF l_success  = 0  THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = 'apm-00003'
      LET g_errparam.extend = g_xcea_m.xceadocno
      LET g_errparam.popup = TRUE
      CALL cl_err()

      LET g_success = 'N'
      RETURN g_success
   END IF
   
   INSERT INTO xcea_t (xceaent,xceald,xceacomp,xcea006,xceadocno,xcea001,xcea002,xcea004, 
       xcea005,xcea003,xceastus,xceaownid,xceaowndp,xceacrtid,xceacrtdp,xceacrtdt, 
       xceamodid,xceamoddt)
   VALUES (g_enterprise,g_xcea_m.xceald,g_xcea_m.xceacomp,g_xcea_m.xcea006,g_xcea_m.xceadocno, 
       g_xcea_m.xcea001,g_xcea002,g_xcea_m.xcea004,g_xcea_m.xcea005,g_xcea_m.xcea003, 
       'N',l_xcea.xceaownid,l_xcea.xceaowndp,l_xcea.xceacrtid, 
       l_xcea.xceacrtdp,l_xcea.xceacrtdt,l_xcea.xceamodid,l_xcea.xceamoddt) 
       
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "ins xcea"
      LET g_errparam.popup = TRUE
      CALL cl_err()
  
      LET g_success = 'N'
      RETURN g_success
   END IF

   SELECT xcat005 INTO l_xcat005 FROM xcat_t
    WHERE xcatent = g_enterprise
      AND xcat001 = g_xcea_m.xcea003  

   IF l_xcat005 = '1' THEN
      SELECT xcaz011 INTO l_xcaz011 FROM xcaz_t
       WHERE xcazent = g_enterprise
         AND xcazld = g_xcea_m.xceald
         AND xcaz001 = g_xcea_m.xcea003
      CALL s_aooi160_get_exrate('2',g_xcea_m.xceald,g_xcea_m.xcea001,g_glaa001,
                                   g_glaa016,0,g_glaa018)
         RETURNING l_rate
      CALL s_aooi160_get_exrate('2',g_xcea_m.xceald,g_xcea_m.xcea001,g_glaa001,
                                  #目的幣別;  交易金額; 匯類類型
                                   g_glaa020,0,g_glaa022)
         RETURNING l_rate1
      LET g_sql = "SELECT xccdent,xccd006,xccd007,xccd008,xccd002,xccd001,
                      SUM(xccd301) *(-1)           xceb201, SUM(xcag102  * xccd301)*(-1) xceb202,
                      SUM(xcag102a * xccd301)*(-1) xceb202a,SUM(xcag102b * xccd301)*(-1) xceb202b,
                      SUM(xcag102c * xccd301)*(-1) xceb202c,SUM(xcag102d * xccd301)*(-1) xceb202d,
                      SUM(xcag102e * xccd301)*(-1) xceb202e,SUM(xcag102f * xccd301)*(-1) xceb202f,
                      SUM(xcag102g * xccd301)*(-1) xceb202g,SUM(xcag102h * xccd301)*(-1) xceb202h,
                      SUM(CASE WHEN xccd001 = '2' THEN xcag102  * xccd301 ELSE 0 END)*(-1) * ",l_rate ," xceb212,
                      SUM(CASE WHEN xccd001 = '2' THEN xcag102a * xccd301 ELSE 0 END)*(-1) * ",l_rate ," xceb212a,
                      SUM(CASE WHEN xccd001 = '2' THEN xcag102b * xccd301 ELSE 0 END)*(-1) * ",l_rate ," xceb212b,
                      SUM(CASE WHEN xccd001 = '2' THEN xcag102c * xccd301 ELSE 0 END)*(-1) * ",l_rate ," xceb212c,
                      SUM(CASE WHEN xccd001 = '2' THEN xcag102d * xccd301 ELSE 0 END)*(-1) * ",l_rate ," xceb212d,
                      SUM(CASE WHEN xccd001 = '2' THEN xcag102e * xccd301 ELSE 0 END)*(-1) * ",l_rate ," xceb212e,
                      SUM(CASE WHEN xccd001 = '2' THEN xcag102f * xccd301 ELSE 0 END)*(-1) * ",l_rate ," xceb212f,
                      SUM(CASE WHEN xccd001 = '2' THEN xcag102g * xccd301 ELSE 0 END)*(-1) * ",l_rate ," xceb212g,
                      SUM(CASE WHEN xccd001 = '2' THEN xcag102h * xccd301 ELSE 0 END)*(-1) * ",l_rate ," xceb212h,
                      SUM(CASE WHEN xccd001 = '3' THEN xcag102  * xccd301 ELSE 0 END)*(-1) * ",l_rate1," xceb222,
                      SUM(CASE WHEN xccd001 = '3' THEN xcag102a * xccd301 ELSE 0 END)*(-1) * ",l_rate1," xceb222a,
                      SUM(CASE WHEN xccd001 = '3' THEN xcag102b * xccd301 ELSE 0 END)*(-1) * ",l_rate1," xceb222b,
                      SUM(CASE WHEN xccd001 = '3' THEN xcag102c * xccd301 ELSE 0 END)*(-1) * ",l_rate1," xceb222c,
                      SUM(CASE WHEN xccd001 = '3' THEN xcag102d * xccd301 ELSE 0 END)*(-1) * ",l_rate1," xceb222d,
                      SUM(CASE WHEN xccd001 = '3' THEN xcag102e * xccd301 ELSE 0 END)*(-1) * ",l_rate1," xceb222e,
                      SUM(CASE WHEN xccd001 = '3' THEN xcag102f * xccd301 ELSE 0 END)*(-1) * ",l_rate1," xceb222f,
                      SUM(CASE WHEN xccd001 = '3' THEN xcag102g * xccd301 ELSE 0 END)*(-1) * ",l_rate1," xceb222g,
                      SUM(CASE WHEN xccd001 = '3' THEN xcag102h * xccd301 ELSE 0 END)*(-1) * ",l_rate1," xceb222h
                 FROM xccd_t,xcce_t LEFT JOIN (SELECT xcag102,xcag102a,xcag102b,xcag102c,xcag102d,xcag102e,xcag102f,xcag102g,xcag102h FROM xcag_t 
                                                WHERE xcagent = ",g_enterprise,"
                                                  AND xcagsite = '",g_site,"'
                                                  AND xcag001 = '",l_xcaz011,"'
                                                  AND xcag002 < '",g_xcea_m.xcea001,"'
                                                  AND (xcag003 IS NULL OR xcag003 >='",g_xcea_m.xcea001,"')) ON xccd007 = xcag004
                WHERE xccdent = ",g_enterprise," AND xccdld = '",g_xcea_m.xceald,"'
                  AND xccd003 = '",g_xcea_m.xcea003,"' AND xccd004 = ",g_xcea_m.xcea004,"
                  AND xccd005 = ",g_xcea_m.xcea005,"
                  AND xcceent = xccdent
                  AND xcceld  = xccdld
                  AND xcce001 = xccd001
                  AND xcce003 = xccd003
                  AND xcce004 = xccd004
                  AND xcce005 = xccd005
                  AND xcce006 = xccd006
                GROUP BY xccdent,xccd006,xccd007,xccd008,xccd002,xccd001
                ORDER BY xccdent,xccd006,xccd007,xccd008,xccd002,xccd001"
   ELSE
      LET g_sql = "SELECT xccdent,xccd006,xccd007,xccd008,xccd002,xccd001,
                      SUM(xccd301) *(-1)  xceb201,SUM(xccd302) *(-1)  xceb202,SUM(xccd302a)*(-1) xceb202a,
                      SUM(xccd302b)*(-1) xceb202b,SUM(xccd302c)*(-1) xceb202c,SUM(xccd302d)*(-1) xceb202d,
                      SUM(xccd302e)*(-1) xceb202e,SUM(xccd302f)*(-1) xceb202f,SUM(xccd302g)*(-1) xceb202g,
                      SUM(xccd302h)*(-1) xceb202h,
                      SUM(CASE WHEN xccd001 = '2' THEN xccd302  ELSE 0 END)*(-1) xceb212,
                      SUM(CASE WHEN xccd001 = '2' THEN xccd302a ELSE 0 END)*(-1) xceb212a,SUM(CASE WHEN xccd001 = '2' THEN xccd302b ELSE 0 END)*(-1) xceb212b,
                      SUM(CASE WHEN xccd001 = '2' THEN xccd302c ELSE 0 END)*(-1) xceb212c,SUM(CASE WHEN xccd001 = '2' THEN xccd302d ELSE 0 END)*(-1) xceb212d,
                      SUM(CASE WHEN xccd001 = '2' THEN xccd302e ELSE 0 END)*(-1) xceb212e,SUM(CASE WHEN xccd001 = '2' THEN xccd302f ELSE 0 END)*(-1) xceb212f,
                      SUM(CASE WHEN xccd001 = '2' THEN xccd302g ELSE 0 END)*(-1) xceb212g,SUM(CASE WHEN xccd001 = '2' THEN xccd302h ELSE 0 END)*(-1) xceb212h,
                      SUM(CASE WHEN xccd001 = '3' THEN xccd302  ELSE 0 END)*(-1) xceb222,
                      SUM(CASE WHEN xccd001 = '3' THEN xccd302a ELSE 0 END)*(-1) xceb222a,SUM(CASE WHEN xccd001 = '3' THEN xccd302b ELSE 0 END)*(-1) xceb222b,
                      SUM(CASE WHEN xccd001 = '3' THEN xccd302c ELSE 0 END)*(-1) xceb222c,SUM(CASE WHEN xccd001 = '3' THEN xccd302d ELSE 0 END)*(-1) xceb222d,
                      SUM(CASE WHEN xccd001 = '3' THEN xccd302e ELSE 0 END)*(-1) xceb222e,SUM(CASE WHEN xccd001 = '3' THEN xccd302f ELSE 0 END)*(-1) xceb222f,
                      SUM(CASE WHEN xccd001 = '3' THEN xccd302g ELSE 0 END)*(-1) xceb222g,SUM(CASE WHEN xccd001 = '3' THEN xccd302h ELSE 0 END)*(-1) xceb222h
                 FROM xccd_t
                WHERE xccdent = ",g_enterprise," AND xccdld = '",g_xcea_m.xceald,"'
                  AND xccd003 = '",g_xcea_m.xcea003,"' AND xccd004 = ",g_xcea_m.xcea004,"
                  AND xccd005 = ",g_xcea_m.xcea005,"
                GROUP BY xccdent,xccd006,xccd007,xccd008,xccd002,xccd001
                ORDER BY xccdent,xccd006,xccd007,xccd008,xccd002,xccd001"
   END IF

   #170214-00020#1 modify imagsite = 'DSCTP' 調整成 imagsite = 'g_xcea_m.xceacomp'
   LET g_sql = "INSERT INTO sourse_ins_tmp
                 (xcebent,xcebcomp,xcebld,xcebdocno,xcebseq,xceb001,xceb002,xceb003,xceb004,xceb005,xceb101,xceb102,
                  xceb103,xceb110,xceb111,xceb112,xceb113,xceb114,xceb115,xceb116,xceb117,xceb118,xceb119,xceb120,
                  xceb201,xceb202,xceb202a,xceb202b,xceb202c,xceb202d,xceb202e,xceb202f,xceb202g,xceb202h,xceb212,
                  xceb212a,xceb212b,xceb212c,xceb212d,xceb212e,xceb212f,xceb212g,xceb212h,xceb222,xceb222a,xceb222b,
                  xceb222c,xceb222d,xceb222e,xceb222f,xceb222g,xceb222h,xceb301,xceb302,xceb107,xceb108,xceb109,
                  xceb121,xceb122,xceb123,xceb124,xceb125,xceb126,xceb127,xceb128,xceb129,xceb130,xceb131,xceb132,
                  sfaa009,sfaasite,sfaa028,sfaa029,sfaa052,sfaa057)
                SELECT ",g_enterprise," xcebent,'",g_xcea_m.xceacomp,"' xcebcomp,'",g_xcea_m.xceald,"' xcebld,'",g_xcea_m.xceadocno,"' xcebdocno,
                       rownum xcebseq,xccd006 xceb001,0 xceb002,sfaa003 xceb003,xccd007 xceb004,xccd008 xceb005,'' xceb101,
                       (SELECT glab010 FROM glab_t WHERE glabld  = '",g_xcea_m.xceald,"' AND glab001 = '61' AND glab002 = '8925' AND glab003 = '2' AND glabent = xccdent) xceb102,
                       xccd002 xceb103,'' xceb110,CASE WHEN sfaa052 = 2 THEN sfaa009 ELSE ' ' END xceb111,'' xceb112,'' xceb113,(SELECT ooeg004 FROM ooeg_t WHERE ooegent = sfaaent AND ooeg001 = sfaa017) xceb114,
                       '' xceb115,'' xceb116,(SELECT imag011 FROM imag_t WHERE imagent = xccdent AND imagsite = '",g_xcea_m.xceacomp,"' AND imag001 = xccd007) xceb117,
                       '' xceb118,'' xceb119,'' xceb120,xceb201,
                       xceb202,xceb202a,xceb202b,xceb202c,xceb202d,xceb202e,xceb202f,xceb202g,xceb202h,
                       xceb212,xceb212a,xceb212b,xceb212c,xceb212d,xceb212e,xceb212f,xceb212g,xceb212h,
                       xceb222,xceb222a,xceb222b,xceb222c,xceb222d,xceb222e,xceb222f,xceb222g,xceb222h,
                       '' xceb301,'' xceb302,' ' xceb107,CASE WHEN sfaa068 IS NULL THEN ' ' ELSE sfaa068 END xceb108,
                       ' ' xceb109,' ' xceb121,' ' xceb122,' ' xceb123,' ' xceb124,' ' xceb125,' ' xceb126,' ' xceb127,' ' xceb128,' ' xceb129,' ' xceb130,'' xceb131,'' xceb132,
                       sfaa009,sfaasite,sfaa028,sfaa029,sfaa052,sfaa057 
                  FROM (
                  SELECT xccdent,xccd006,xccd007,xccd008,xccd002,SUM(xceb201) xceb201,
                         SUM(xceb202) xceb202,SUM(xceb202a) xceb202a,SUM(xceb202b) xceb202b,SUM(xceb202c) xceb202c,SUM(xceb202d) xceb202d,SUM(xceb202e) xceb202e,SUM(xceb202f) xceb202f,SUM(xceb202g) xceb202g,SUM(xceb202h) xceb202h,
                         SUM(xceb212) xceb212,SUM(xceb212a) xceb212a,SUM(xceb212b) xceb212b,SUM(xceb212c) xceb212c,SUM(xceb212d) xceb212d,SUM(xceb212e) xceb212e,SUM(xceb212f) xceb212f,SUM(xceb212g) xceb212g,SUM(xceb212h) xceb212h,
                         SUM(xceb222) xceb222,SUM(xceb222a) xceb222a,SUM(xceb222b) xceb222b,SUM(xceb222c) xceb222c,SUM(xceb222d) xceb222d,SUM(xceb222e) xceb222e,SUM(xceb222f) xceb222f,SUM(xceb222g) xceb222g,SUM(xceb222h) xceb222h
                    FROM
                     (",g_sql,")
                   GROUP BY xccdent,xccd006,xccd007,xccd008,xccd002),sfaa_t
                 WHERE sfaaent = xccdent AND sfaadocno = xccd006 AND xceb202 <> 0"
   PREPARE axct701_01_ins_tmp5 FROM g_sql
   EXECUTE axct701_01_ins_tmp5

   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (         SELECT pmaa090,pmaa241,pmaa001 
                            FROM pmaa_t 
                               WHERE pmaaent = ",g_enterprise," )        ",
                   "    ON (xceb111=pmaa001)                        ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb112 = pmaa090,",
                   "               xceb113 = pmaa241    ",
                   "     WHERE sfaa052 = '2'"
   PREPARE axct701_01_meg_15 FROM g_sql
   EXECUTE axct701_01_meg_15

   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT ooef153,ooef001 FROM ooef_t
          WHERE ooefent = ",g_enterprise," )        ",
                   "    ON (sfaasite=ooef001)                        ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb112 = ' ',",
                   "               xceb113 = ooef153    ",
                   "     WHERE sfaa052 <> '2'"
   PREPARE axct701_01_meg_16 FROM g_sql
   EXECUTE axct701_01_meg_16

   #抓取科目
   LET g_sql =     " MERGE INTO sourse_ins_tmp                                ",
                   #" USING (SELECT glcc002,glcc016,glcc011 FROM glcc_t       ",          #170221-00041#1 mark
                   " USING (SELECT DISTINCT glcc002,glcc016,glcc011 FROM glcc_t       ",  #170221-00041#1 add
                   " WHERE glccent = ",g_enterprise,"  AND glcc001 = '1'  AND glccld  = '",g_xcea_m.xceald,"'
   AND ( glcc014='",g_xcea_m.xceacomp,"' OR glcc014='*' ) )        ",
                   "    ON ((glcc016=xceb004 OR glcc016 = '*') AND (glcc011=xceb117 OR glcc011='*') ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb101 = glcc002"
   PREPARE axct701_01_meg_17 FROM g_sql
   EXECUTE axct701_01_meg_17

  #启用交易对象
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad010 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad010 = 'N'  ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb111 = ' '"
   PREPARE axct701_01_meg_xceb1112 FROM g_sql
   EXECUTE axct701_01_meg_xceb1112

  #启用客群
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad011 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad011 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb112 = ' '"
   PREPARE axct701_01_meg_xceb1122 FROM g_sql
   EXECUTE axct701_01_meg_xceb1122

  #启用区域
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad009 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad009 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb113 = ' '"
   PREPARE axct701_01_meg_xceb1132 FROM g_sql
   EXECUTE axct701_01_meg_xceb1132

   
  #启用成本中心
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad008 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad008 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb114 = ' '"
   PREPARE axct701_01_meg_xceb1142 FROM g_sql
   EXECUTE axct701_01_meg_xceb1142
   
  #启用经营类别
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad031 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad031 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb115 = ' '"
   PREPARE axct701_01_meg_xceb1152 FROM g_sql
   EXECUTE axct701_01_meg_xceb1152
 
  #启用渠道
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad032 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad032 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb116 = ' '"
   PREPARE axct701_01_meg_xceb1162 FROM g_sql
   EXECUTE axct701_01_meg_xceb1162

  #启用品类
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad012 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad012 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb117 = ' '"
   PREPARE axct701_01_meg_xceb1172 FROM g_sql
   EXECUTE axct701_01_meg_xceb1172
   
  #启用品牌
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad033 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad033 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb118 = ' '"
   PREPARE axct701_01_meg_xceb1182 FROM g_sql
   EXECUTE axct701_01_meg_xceb1182
 
  #启用项目号
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad015 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad015 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb119 = ' '"
   PREPARE axct701_01_meg_xceb1192 FROM g_sql
   EXECUTE axct701_01_meg_xceb1192
 
  #启用WBS
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad016 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad016 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb120 = ' '"
   PREPARE axct701_01_meg_xceb1202 FROM g_sql
   EXECUTE axct701_01_meg_xceb1202
 
  #启用人员
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad013 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad013 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb107 = ' '"
   PREPARE axct701_01_meg_xceb1072 FROM g_sql
   EXECUTE axct701_01_meg_xceb1072
 
  #启用部门
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad007 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad007 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb108 = ' '"
   PREPARE axct701_01_meg_xceb1082 FROM g_sql
   EXECUTE axct701_01_meg_xceb1082
   
  #启用账款对象
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad027 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad027 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb109 = ' '"
   PREPARE axct701_01_meg_xceb1092 FROM g_sql
   EXECUTE axct701_01_meg_xceb1092
   
  #启用自由核算项1
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad017 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad017 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb121 = ' '"
   PREPARE axct701_01_meg_xceb1212 FROM g_sql
   EXECUTE axct701_01_meg_xceb1212
 
  #启用自由核算项2
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad018 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad018 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb122 = ' '"
   PREPARE axct701_01_meg_xceb1222 FROM g_sql
   EXECUTE axct701_01_meg_xceb1222
 
  #启用自由核算项3
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad019 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad019 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb123 = ' '"
   PREPARE axct701_01_meg_xceb1232 FROM g_sql
   EXECUTE axct701_01_meg_xceb1232

  #启用自由核算项4
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad019 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad019 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb124 = ' '"
   PREPARE axct701_01_meg_xceb1242 FROM g_sql
   EXECUTE axct701_01_meg_xceb1242

  #启用自由核算项5
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad021 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad021 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb125 = ' '"
   PREPARE axct701_01_meg_xceb1252 FROM g_sql
   EXECUTE axct701_01_meg_xceb1252

  #启用自由核算项6
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad022 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad022 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb126 = ' '"
   PREPARE axct701_01_meg_xceb1262 FROM g_sql
   EXECUTE axct701_01_meg_xceb1262

  #启用自由核算项7
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad023 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad023 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb127 = ' '"
   PREPARE axct701_01_meg_xceb1272 FROM g_sql
   EXECUTE axct701_01_meg_xceb1272

  #启用自由核算项8
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad024 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad024 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb128 = ' '"
   PREPARE axct701_01_meg_xceb1282 FROM g_sql
   EXECUTE axct701_01_meg_xceb1282

  #启用自由核算项9
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad025 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad025 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb129 = ' '"
   PREPARE axct701_01_meg_xceb1292 FROM g_sql
   EXECUTE axct701_01_meg_xceb1292

  #启用自由核算项10
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad026 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad026 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb130 = ' '"
   PREPARE axct701_01_meg_xceb1302 FROM g_sql
   EXECUTE axct701_01_meg_xceb1302

  #来源单项次
   UPDATE sourse_ins_tmp SET xceb002 = ''
  #特性
   UPDATE sourse_ins_tmp SET xceb005 = ' ' WHERE xceb005 IS NULL
 #科目编号
   UPDATE sourse_ins_tmp SET xceb101 = ' ' WHERE xceb101 IS NULL
  #摘要
   UPDATE sourse_ins_tmp SET xceb102 = ' ' WHERE xceb102 IS NULL
  #成本域
   UPDATE sourse_ins_tmp SET xceb103 = ' ' WHERE xceb103 IS NULL
  #原因码
   UPDATE sourse_ins_tmp SET xceb110 = ' ' WHERE xceb110 IS NULL
  #交易对象
   UPDATE sourse_ins_tmp SET xceb111 = ' ' WHERE xceb111 IS NULL
  #客群
   UPDATE sourse_ins_tmp SET xceb112 = ' ' WHERE xceb112 IS NULL
  #区域
   UPDATE sourse_ins_tmp SET xceb113 = ' ' WHERE xceb113 IS NULL
  #成本中心
   UPDATE sourse_ins_tmp SET xceb114 = ' ' WHERE xceb114 IS NULL
  #经营类别
   UPDATE sourse_ins_tmp SET xceb115 = ' ' WHERE xceb115 IS NULL
  #渠道
   UPDATE sourse_ins_tmp SET xceb116 = ' ' WHERE xceb116 IS NULL
  #品类
   UPDATE sourse_ins_tmp SET xceb117 = ' ' WHERE xceb117 IS NULL
  #品牌
   UPDATE sourse_ins_tmp SET xceb118 = ' ' WHERE xceb118 IS NULL
  #项目号
   UPDATE sourse_ins_tmp SET xceb119 = ' ' WHERE xceb119 IS NULL
  #WBS
   UPDATE sourse_ins_tmp SET xceb120 = ' ' WHERE xceb120 IS NULL
  #人员
   UPDATE sourse_ins_tmp SET xceb107 = ' ' WHERE xceb107 IS NULL
   #部门
   UPDATE sourse_ins_tmp SET xceb108 = ' ' WHERE xceb108 IS NULL
  #账款对象
   UPDATE sourse_ins_tmp SET xceb109 = ' ' WHERE xceb109 IS NULL
  #自由核算项1
   UPDATE sourse_ins_tmp SET xceb121 = ' ' WHERE xceb121 IS NULL
  #自由核算项2
   UPDATE sourse_ins_tmp SET xceb122 = ' ' WHERE xceb122 IS NULL
  #自由核算项3
   UPDATE sourse_ins_tmp SET xceb123 = ' ' WHERE xceb123 IS NULL
  #自由核算项4
   UPDATE sourse_ins_tmp SET xceb124 = ' ' WHERE xceb124 IS NULL
  #自由核算项5
   UPDATE sourse_ins_tmp SET xceb125 = ' ' WHERE xceb125 IS NULL
  #自由核算项6
   UPDATE sourse_ins_tmp SET xceb126 = ' ' WHERE xceb126 IS NULL
   #自由核算项7
   UPDATE sourse_ins_tmp SET xceb127 = ' ' WHERE xceb127 IS NULL
  #自由核算项8
   UPDATE sourse_ins_tmp SET xceb128 = ' ' WHERE xceb128 IS NULL
  #自由核算项9
   UPDATE sourse_ins_tmp SET xceb129 = ' ' WHERE xceb129 IS NULL
  #自由核算项10
   UPDATE sourse_ins_tmp SET xceb130 = ' ' WHERE xceb130 IS NULL

   INSERT INTO xceb_t (xcebent,xcebcomp,xcebld,xcebdocno,xcebseq,
                       xceb001,xceb002,xceb003,xceb004,xceb005,xceb101,xceb102,xceb103,xceb110,xceb111,
                       xceb112,xceb113,xceb114,xceb115,xceb116,xceb117,xceb118,xceb119,xceb120,xceb201,
                       xceb202,xceb202a,xceb202b,xceb202c,xceb202d,xceb202e,xceb202f,xceb202g,xceb202h,
                       xceb212,xceb212a,xceb212b,xceb212c,xceb212d,xceb212e,xceb212f,xceb212g,xceb212h,
                       xceb222,xceb222a,xceb222b,xceb222c,xceb222d,xceb222e,xceb222f,xceb222g,xceb222h,
                       xceb301,xceb302,xceb107,xceb108,xceb109,xceb121,xceb122,xceb123,xceb124,xceb125,
                       xceb126,xceb127,xceb128,xceb129,xceb130,xceb131,xceb132)
         SELECT xcebent,xcebcomp,xcebld,xcebdocno,xcebseq,
                       xceb001,xceb002,xceb003,xceb004,xceb005,xceb101,xceb102,xceb103,xceb110,xceb111,
                       xceb112,xceb113,xceb114,xceb115,xceb116,xceb117,xceb118,xceb119,xceb120,xceb201,
                       xceb202,xceb202a,xceb202b,xceb202c,xceb202d,xceb202e,xceb202f,xceb202g,xceb202h,
                       xceb212,xceb212a,xceb212b,xceb212c,xceb212d,xceb212e,xceb212f,xceb212g,xceb212h,
                       xceb222,xceb222a,xceb222b,xceb222c,xceb222d,xceb222e,xceb222f,xceb222g,xceb222h,
                       xceb301,xceb302,xceb107,xceb108,xceb109,xceb121,xceb122,xceb123,xceb124,xceb125,
                       xceb126,xceb127,xceb128,xceb129,xceb130,xceb131,xceb132
           FROM sourse_ins_tmp

   DELETE FROM sourse_ins_tmp

   #非拆件工單 xcce_t-元件
   #170214-00020#1 modify imagsite = 'DSCTP' 調整成 imagsite = 'g_xcea_m.xceacomp'
   #170214-00050#1 modify 移除多餘的左括號 " 第二個FROM多了一個( "
   LET g_sql = "INSERT INTO sourse_ins_tmp1
                 (xcecent,xceccomp,xcecld,xcecdocno,xcecseq,xcec001,xcec002,xcec003,xcec004,xcec005,xcec101,xcec102,
                  xcec103,xcec110,xcec111,xcec112,xcec113,xcec114,xcec115,xcec116,xcec117,xcec118,xcec119,xcec120,
                  xcec201,xcec202,xcec202a,xcec202b,xcec202c,xcec202d,xcec202e,xcec202f,xcec202g,xcec202h,xcec212,
                  xcec212a,xcec212b,xcec212c,xcec212d,xcec212e,xcec212f,xcec212g,xcec212h,xcec222,xcec222a,xcec222b,
                  xcec222c,xcec222d,xcec222e,xcec222f,xcec222g,xcec222h,xcec301,xcec302,xcec107,xcec108,xcec109,
                  xcec121,xcec122,xcec123,xcec124,xcec125,xcec126,xcec127,xcec128,xcec129,xcec130,
                  sfaa009,sfaasite,sfaa028,sfaa029,sfaa052,sfaa057)
                SELECT ",g_enterprise," xcecent,'",g_xcea_m.xceacomp,"' xceccomp,'",g_xcea_m.xceald,"' xcecld,'",g_xcea_m.xceadocno,"' xcecdocno,
                       rownum xcecseq,xcce006 xcec001,0 xcec002,sfaa003 xcec003,xcce007 xcec004,xcce008 xcec005,'' xcec101,
                       (SELECT glab010 FROM glab_t WHERE glabld  = '",g_xcea_m.xceald,"' AND glab001 = '61' AND glab002 = '8925' AND glab003 = '2' AND glabent = xcceent) xcec102,
                       xcce002 xcec103,'' xcec110,CASE WHEN sfaa052 = 2 THEN sfaa009 ELSE ' ' END xcec111,'' xcec112,'' xcec113,(SELECT ooeg004 FROM ooeg_t WHERE ooegent = sfaaent AND ooeg001 = sfaa017) xcec114,
                       '' xcec115,'' xcec116,(SELECT imag011 FROM imag_t WHERE imagent = xcceent AND imagsite = '",g_xcea_m.xceacomp,"' AND imag001 = xcce007) xcec117,
                       '' xcec118,'' xcec119,'' xcec120, xcec201,
                       xcec202,xcec202a,xcec202b,xcec202c,xcec202d,xcec202e,xcec202f,xcec202g,xcec202h,
                       xcec212,xcec212a,xcec212b,xcec212c,xcec212d,xcec212e,xcec212f,xcec212g,xcec212h,
                       xcec222,xcec222a,xcec222b,xcec222c,xcec222d,xcec222e,xcec222f,xcec222g,xcec222h,
                       '' xcec301,'' xcec302,' ' xcec107,CASE WHEN sfaa068 IS NULL THEN ' ' ELSE sfaa068 END xcec108,
                       ' ' xcec109,' ' xcec121,' ' xcec122,' ' xcec123,' ' xcec124,' ' xcec125,' ' xcec126,' ' xcec127,' ' xcec128,' ' xcec129,' ' xcec130,
                       sfaa009,sfaasite,sfaa028,sfaa029,sfaa052,sfaa057 
                  FROM (
                  SELECT xcceent,xcce006,xcce007,xcce008,xcce002,SUM(xcec201) xcec201,
                         SUM(xcec202) xcec202,SUM(xcec202a) xcec202a,SUM(xcec202b) xcec202b,SUM(xcec202c) xcec202c,SUM(xcec202d) xcec202d,SUM(xcec202e) xcec202e,SUM(xcec202f) xcec202f,SUM(xcec202g) xcec202g,SUM(xcec202h) xcec202h,
                         SUM(xcec212) xcec212,SUM(xcec212a) xcec212a,SUM(xcec212b) xcec212b,SUM(xcec212c) xcec212c,SUM(xcec212d) xcec212d,SUM(xcec212e) xcec212e,SUM(xcec212f) xcec212f,SUM(xcec212g) xcec212g,SUM(xcec212h) xcec212h,
                         SUM(xcec222) xcec222,SUM(xcec222a) xcec222a,SUM(xcec222b) xcec222b,SUM(xcec222c) xcec222c,SUM(xcec222d) xcec222d,SUM(xcec222e) xcec222e,SUM(xcec222f) xcec222f,SUM(xcec222g) xcec222g,SUM(xcec222h) xcec222h
                    FROM
                     (SELECT xcceent,xcce006,xcce007,xcce008,xcce002,xcce001,
                      SUM(xcce301) *(-1)  xcec201,SUM(xcce302) *(-1)  xcec202,SUM(xcce302a)*(-1) xcec202a,
                      SUM(xcce302b)*(-1) xcec202b,SUM(xcce302c)*(-1) xcec202c,SUM(xcce302d)*(-1) xcec202d,
                      SUM(xcce302e)*(-1) xcec202e,SUM(xcce302f)*(-1) xcec202f,SUM(xcce302g)*(-1) xcec202g,
                      SUM(xcce302h)*(-1) xcec202h,
                      SUM(CASE WHEN xcce001 = '2' THEN xcce302  ELSE 0 END)*(-1) xcec212,
                      SUM(CASE WHEN xcce001 = '2' THEN xcce302a ELSE 0 END)*(-1) xcec212a,SUM(CASE WHEN xcce001 = '2' THEN xcce302b ELSE 0 END)*(-1) xcec212b,
                      SUM(CASE WHEN xcce001 = '2' THEN xcce302c ELSE 0 END)*(-1) xcec212c,SUM(CASE WHEN xcce001 = '2' THEN xcce302d ELSE 0 END)*(-1) xcec212d,
                      SUM(CASE WHEN xcce001 = '2' THEN xcce302e ELSE 0 END)*(-1) xcec212e,SUM(CASE WHEN xcce001 = '2' THEN xcce302f ELSE 0 END)*(-1) xcec212f,
                      SUM(CASE WHEN xcce001 = '2' THEN xcce302g ELSE 0 END)*(-1) xcec212g,SUM(CASE WHEN xcce001 = '2' THEN xcce302h ELSE 0 END)*(-1) xcec212h,
                      SUM(CASE WHEN xcce001 = '3' THEN xcce302  ELSE 0 END)*(-1) xcec222,
                      SUM(CASE WHEN xcce001 = '3' THEN xcce302a ELSE 0 END)*(-1) xcec222a,SUM(CASE WHEN xcce001 = '3' THEN xcce302b ELSE 0 END)*(-1) xcec222b,
                      SUM(CASE WHEN xcce001 = '3' THEN xcce302c ELSE 0 END)*(-1) xcec222c,SUM(CASE WHEN xcce001 = '3' THEN xcce302d ELSE 0 END)*(-1) xcec222d,
                      SUM(CASE WHEN xcce001 = '3' THEN xcce302e ELSE 0 END)*(-1) xcec222e,SUM(CASE WHEN xcce001 = '3' THEN xcce302f ELSE 0 END)*(-1) xcec222f,
                      SUM(CASE WHEN xcce001 = '3' THEN xcce302g ELSE 0 END)*(-1) xcec222g,SUM(CASE WHEN xcce001 = '3' THEN xcce302h ELSE 0 END)*(-1) xcec222h
                 FROM xcce_t
                WHERE xcceent = ",g_enterprise," AND xcceld = '",g_xcea_m.xceald,"'
                  AND xcce003 = '",g_xcea_m.xcea003,"' AND xcce004 = ",g_xcea_m.xcea004,"
                  AND xcce005 = ",g_xcea_m.xcea005,"
                GROUP BY xcceent,xcce006,xcce007,xcce008,xcce002,xcce001
                ORDER BY xcceent,xcce006,xcce007,xcce008,xcce002,xcce001)
                   GROUP BY xcceent,xcce006,xcce007,xcce008,xcce002),sfaa_t
                 WHERE sfaaent = xcceent AND sfaadocno = xcce006"
   PREPARE axct701_01_ins_tmp6 FROM g_sql
   EXECUTE axct701_01_ins_tmp6


   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (         SELECT pmaa090,pmaa241,pmaa001 
                            FROM pmaa_t 
                               WHERE pmaaent = ",g_enterprise," )        ",
                   "    ON (xcec111=pmaa001)                        ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec112 = pmaa090,",
                   "               xcec113 = pmaa241    ",
                   "     WHERE sfaa052 = '2'"
   PREPARE axct701_01_meg_18 FROM g_sql
   EXECUTE axct701_01_meg_18

   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT ooef153,ooef001 FROM ooef_t
          WHERE ooefent = ",g_enterprise," )        ",
                   "    ON (sfaasite=ooef001)                        ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec112 = ' ',",
                   "               xcec113 = ooef153    ",
                   "     WHERE sfaa052 <> '2'"
   PREPARE axct701_01_meg_19 FROM g_sql
   EXECUTE axct701_01_meg_19

   #抓取科目
   #STEP1
   #170215-00035#1 modify glcc001 = 1  --> glcc001 = 3
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT DISTINCT glcc002,glcc016,glcc011 FROM glcc_t       ",  #170215-00035#1 add DISTINCT
                   " WHERE glccent = ",g_enterprise,"  AND glcc001 = '3'  AND glccld  = '",g_xcea_m.xceald,"' 
   AND ( glcc014='",g_xcea_m.xceacomp,"' OR glcc014='*' ) )        ",
                   "    ON ((glcc016=xcec004 OR glcc016 = '*') AND (glcc011=xcec117 OR glcc011='*') ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec101 = glcc002",
                   "     WHERE xcec004 != 'ADJUST'"
   PREPARE axct701_01_meg_20 FROM g_sql
   EXECUTE axct701_01_meg_20
   #STEP2
   SELECT glab005 INTO l_glab005
     FROM glab_t
    WHERE glabld  = g_xcea_m.xceald
      AND glab001 = '60'
      AND glab002 = '8912'
      AND glab003 = '1'
      AND glabent = g_enterprise
   UPDATE sourse_ins_tmp1 SET xcec101 = l_glab005
    WHERE xcec101 IS NULL #170215-00035#1 xcec004 -->xcec101

   UPDATE sourse_ins_tmp1 SET xcec101 = ''
    WHERE xcec004 = 'DL+OH+SUB'



  #启用交易对象
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad010 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad010 = 'N'  ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec111 = ' '"
   PREPARE axct701_01_meg_xcec1112 FROM g_sql
   EXECUTE axct701_01_meg_xcec1112

  #启用客群
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad011 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad011 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec112 = ' '"
   PREPARE axct701_01_meg_xcec1122 FROM g_sql
   EXECUTE axct701_01_meg_xcec1122

  #启用区域
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad009 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad009 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec113 = ' '"
   PREPARE axct701_01_meg_xcec1132 FROM g_sql
   EXECUTE axct701_01_meg_xcec1132

   
  #启用成本中心
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad008 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad008 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec114 = ' '"
   PREPARE axct701_01_meg_xcec1142 FROM g_sql
   EXECUTE axct701_01_meg_xcec1142
   
  #启用经营类别
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad031 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad031 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec115 = ' '"
   PREPARE axct701_01_meg_xcec1152 FROM g_sql
   EXECUTE axct701_01_meg_xcec1152
 
  #启用渠道
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad032 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad032 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec116 = ' '"
   PREPARE axct701_01_meg_xcec1162 FROM g_sql
   EXECUTE axct701_01_meg_xcec1162

  #启用品类
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad012 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad012 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec117 = ' '"
   PREPARE axct701_01_meg_xcec1172 FROM g_sql
   EXECUTE axct701_01_meg_xcec1172
   
  #启用品牌
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad033 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad033 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec118 = ' '"
   PREPARE axct701_01_meg_xcec1182 FROM g_sql
   EXECUTE axct701_01_meg_xcec1182
 
  #启用项目号
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad015 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad015 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec119 = ' '"
   PREPARE axct701_01_meg_xcec1192 FROM g_sql
   EXECUTE axct701_01_meg_xcec1192
 
  #启用WBS
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad016 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad016 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec120 = ' '"
   PREPARE axct701_01_meg_xcec1202 FROM g_sql
   EXECUTE axct701_01_meg_xcec1202
 
  #启用人员
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad013 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad013 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec107 = ' '"
   PREPARE axct701_01_meg_xcec1072 FROM g_sql
   EXECUTE axct701_01_meg_xcec1072
 
  #启用部门
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad007 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad007 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec108 = ' '"
   PREPARE axct701_01_meg_xcec1082 FROM g_sql
   EXECUTE axct701_01_meg_xcec1082
   
  #启用账款对象
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad027 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad027 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec109 = ' '"
   PREPARE axct701_01_meg_xcec1092 FROM g_sql
   EXECUTE axct701_01_meg_xcec1092
   
  #启用自由核算项1
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad017 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad017 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec121 = ' '"
   PREPARE axct701_01_meg_xcec1212 FROM g_sql
   EXECUTE axct701_01_meg_xcec1212
 
  #启用自由核算项2
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad018 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad018 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec122 = ' '"
   PREPARE axct701_01_meg_xcec1222 FROM g_sql
   EXECUTE axct701_01_meg_xcec1222
 
  #启用自由核算项3
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad019 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad019 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec123 = ' '"
   PREPARE axct701_01_meg_xcec1232 FROM g_sql
   EXECUTE axct701_01_meg_xcec1232

  #启用自由核算项4
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad019 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad019 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec124 = ' '"
   PREPARE axct701_01_meg_xcec1242 FROM g_sql
   EXECUTE axct701_01_meg_xcec1242

  #启用自由核算项5
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad021 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad021 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec125 = ' '"
   PREPARE axct701_01_meg_xcec1252 FROM g_sql
   EXECUTE axct701_01_meg_xcec1252

  #启用自由核算项6
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad022 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad022 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec126 = ' '"
   PREPARE axct701_01_meg_xcec1262 FROM g_sql
   EXECUTE axct701_01_meg_xcec1262

  #启用自由核算项7
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad023 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad023 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec127 = ' '"
   PREPARE axct701_01_meg_xcec1272 FROM g_sql
   EXECUTE axct701_01_meg_xcec1272

  #启用自由核算项8
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad024 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad024 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec128 = ' '"
   PREPARE axct701_01_meg_xcec1282 FROM g_sql
   EXECUTE axct701_01_meg_xcec1282

  #启用自由核算项9
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad025 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad025 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec129 = ' '"
   PREPARE axct701_01_meg_xcec1292 FROM g_sql
   EXECUTE axct701_01_meg_xcec1292

  #启用自由核算项10
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad026 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad026 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec130 = ' '"
   PREPARE axct701_01_meg_xcec1302 FROM g_sql
   EXECUTE axct701_01_meg_xcec1302

  #来源单项次
   UPDATE sourse_ins_tmp1 SET xcec002 = ''
  #特性
   UPDATE sourse_ins_tmp1 SET xcec005 = ' ' WHERE xcec005 IS NULL
 #科目编号
   UPDATE sourse_ins_tmp1 SET xcec101 = ' ' WHERE xcec101 IS NULL
  #摘要
   UPDATE sourse_ins_tmp1 SET xcec102 = ' ' WHERE xcec102 IS NULL
  #成本域
   UPDATE sourse_ins_tmp1 SET xcec103 = ' ' WHERE xcec103 IS NULL
  #原因码
   UPDATE sourse_ins_tmp1 SET xcec110 = ' ' WHERE xcec110 IS NULL
  #交易对象
   UPDATE sourse_ins_tmp1 SET xcec111 = ' ' WHERE xcec111 IS NULL
  #客群
   UPDATE sourse_ins_tmp1 SET xcec112 = ' ' WHERE xcec112 IS NULL
  #区域
   UPDATE sourse_ins_tmp1 SET xcec113 = ' ' WHERE xcec113 IS NULL
  #成本中心
   UPDATE sourse_ins_tmp1 SET xcec114 = ' ' WHERE xcec114 IS NULL
  #经营类别
   UPDATE sourse_ins_tmp1 SET xcec115 = ' ' WHERE xcec115 IS NULL
  #渠道
   UPDATE sourse_ins_tmp1 SET xcec116 = ' ' WHERE xcec116 IS NULL
  #品类
   UPDATE sourse_ins_tmp1 SET xcec117 = ' ' WHERE xcec117 IS NULL
  #品牌
   UPDATE sourse_ins_tmp1 SET xcec118 = ' ' WHERE xcec118 IS NULL
  #项目号
   UPDATE sourse_ins_tmp1 SET xcec119 = ' ' WHERE xcec119 IS NULL
  #WBS
   UPDATE sourse_ins_tmp1 SET xcec120 = ' ' WHERE xcec120 IS NULL
  #人员
   UPDATE sourse_ins_tmp1 SET xcec107 = ' ' WHERE xcec107 IS NULL
   #部门
   UPDATE sourse_ins_tmp1 SET xcec108 = ' ' WHERE xcec108 IS NULL
  #账款对象
   UPDATE sourse_ins_tmp1 SET xcec109 = ' ' WHERE xcec109 IS NULL
  #自由核算项1
   UPDATE sourse_ins_tmp1 SET xcec121 = ' ' WHERE xcec121 IS NULL
  #自由核算项2
   UPDATE sourse_ins_tmp1 SET xcec122 = ' ' WHERE xcec122 IS NULL
  #自由核算项3
   UPDATE sourse_ins_tmp1 SET xcec123 = ' ' WHERE xcec123 IS NULL
  #自由核算项4
   UPDATE sourse_ins_tmp1 SET xcec124 = ' ' WHERE xcec124 IS NULL
  #自由核算项5
   UPDATE sourse_ins_tmp1 SET xcec125 = ' ' WHERE xcec125 IS NULL
  #自由核算项6
   UPDATE sourse_ins_tmp1 SET xcec126 = ' ' WHERE xcec126 IS NULL
   #自由核算项7
   UPDATE sourse_ins_tmp1 SET xcec127 = ' ' WHERE xcec127 IS NULL
  #自由核算项8
   UPDATE sourse_ins_tmp1 SET xcec128 = ' ' WHERE xcec128 IS NULL
  #自由核算项9
   UPDATE sourse_ins_tmp1 SET xcec129 = ' ' WHERE xcec129 IS NULL
  #自由核算项10
   UPDATE sourse_ins_tmp1 SET xcec130 = ' ' WHERE xcec130 IS NULL

   INSERT INTO xcec_t (xcecent,xceccomp,xcecld,xcecdocno,xcecseq,
                       xcec001,xcec002,xcec003,xcec004,xcec005,xcec101,xcec102,xcec103,xcec110,xcec111,
                       xcec112,xcec113,xcec114,xcec115,xcec116,xcec117,xcec118,xcec119,xcec120,xcec201,
                       xcec202,xcec202a,xcec202b,xcec202c,xcec202d,xcec202e,xcec202f,xcec202g,xcec202h,
                       xcec212,xcec212a,xcec212b,xcec212c,xcec212d,xcec212e,xcec212f,xcec212g,xcec212h,
                       xcec222,xcec222a,xcec222b,xcec222c,xcec222d,xcec222e,xcec222f,xcec222g,xcec222h,
                       xcec301,xcec302,xcec107,xcec108,xcec109,xcec121,xcec122,xcec123,xcec124,xcec125,
                       xcec126,xcec127,xcec128,xcec129,xcec130)
         SELECT xcecent,xceccomp,xcecld,xcecdocno,xcecseq,
                       xcec001,xcec002,xcec003,xcec004,xcec005,xcec101,xcec102,xcec103,xcec110,xcec111,
                       xcec112,xcec113,xcec114,xcec115,xcec116,xcec117,xcec118,xcec119,xcec120,xcec201,
                       xcec202,xcec202a,xcec202b,xcec202c,xcec202d,xcec202e,xcec202f,xcec202g,xcec202h,
                       xcec212,xcec212a,xcec212b,xcec212c,xcec212d,xcec212e,xcec212f,xcec212g,xcec212h,
                       xcec222,xcec222a,xcec222b,xcec222c,xcec222d,xcec222e,xcec222f,xcec222g,xcec222h,
                       xcec301,xcec302,xcec107,xcec108,xcec109,xcec121,xcec122,xcec123,xcec124,xcec125,
                       xcec126,xcec127,xcec128,xcec129,xcec130
           FROM sourse_ins_tmp1


   #第三單身
   CALL axct701_01_ins_xced() RETURNING l_success
   IF NOT l_success THEN LET g_success = 'N' END IF 

   RETURN g_success
#161215-00040#1 Add  ---(E)---   因效能优化,程序逻辑完全重写,旧代码保存在axct701_01_ins_2_bak中
END FUNCTION

################################################################################
# Descriptions...: 描述说明    11.庫存調整憑證  axct703
# Date & Author..: 2017/01/23 By 02295
# Modify.........: #170105-00011#6
################################################################################
PRIVATE FUNCTION axct701_01_ins_3()
DEFINE l_xcea          RECORD  #工單發料成本憑證單頭檔
       xceaent LIKE xcea_t.xceaent, #企業編號
       xceacomp LIKE xcea_t.xceacomp, #法人組織
       xceald LIKE xcea_t.xceald, #帳套
       xceadocno LIKE xcea_t.xceadocno, #單據編號
       xcea001 LIKE xcea_t.xcea001, #單據日期
       xcea002 LIKE xcea_t.xcea002, #成本憑證類型
       xcea003 LIKE xcea_t.xcea003, #成本計算類型
       xcea004 LIKE xcea_t.xcea004, #年度
       xcea005 LIKE xcea_t.xcea005, #期別
       xcea006 LIKE xcea_t.xcea006, #帳務人員
       xcea007 LIKE xcea_t.xcea007, #帳務部門
       xcea101 LIKE xcea_t.xcea101, #憑證編號
       xcea102 LIKE xcea_t.xcea102, #憑證日期
       xceaownid LIKE xcea_t.xceaownid, #資料所有者
       xceaowndp LIKE xcea_t.xceaowndp, #資料所屬部門
       xceacrtid LIKE xcea_t.xceacrtid, #資料建立者
       xceacrtdp LIKE xcea_t.xceacrtdp, #資料建立部門
       xceacrtdt LIKE xcea_t.xceacrtdt, #資料創建日
       xceamodid LIKE xcea_t.xceamodid, #資料修改者
       xceamoddt LIKE xcea_t.xceamoddt, #最近修改日
       xceacnfid LIKE xcea_t.xceacnfid, #資料確認者
       xceacnfdt LIKE xcea_t.xceacnfdt, #資料確認日
       xceapstid LIKE xcea_t.xceapstid, #資料過帳者
       xceapstdt LIKE xcea_t.xceapstdt, #資料過帳日
       xceastus LIKE xcea_t.xceastus, #狀態碼
       xceaud001 LIKE xcea_t.xceaud001, #自定義欄位(文字)001
       xceaud002 LIKE xcea_t.xceaud002, #自定義欄位(文字)002
       xceaud003 LIKE xcea_t.xceaud003, #自定義欄位(文字)003
       xceaud004 LIKE xcea_t.xceaud004, #自定義欄位(文字)004
       xceaud005 LIKE xcea_t.xceaud005, #自定義欄位(文字)005
       xceaud006 LIKE xcea_t.xceaud006, #自定義欄位(文字)006
       xceaud007 LIKE xcea_t.xceaud007, #自定義欄位(文字)007
       xceaud008 LIKE xcea_t.xceaud008, #自定義欄位(文字)008
       xceaud009 LIKE xcea_t.xceaud009, #自定義欄位(文字)009
       xceaud010 LIKE xcea_t.xceaud010, #自定義欄位(文字)010
       xceaud011 LIKE xcea_t.xceaud011, #自定義欄位(數字)011
       xceaud012 LIKE xcea_t.xceaud012, #自定義欄位(數字)012
       xceaud013 LIKE xcea_t.xceaud013, #自定義欄位(數字)013
       xceaud014 LIKE xcea_t.xceaud014, #自定義欄位(數字)014
       xceaud015 LIKE xcea_t.xceaud015, #自定義欄位(數字)015
       xceaud016 LIKE xcea_t.xceaud016, #自定義欄位(數字)016
       xceaud017 LIKE xcea_t.xceaud017, #自定義欄位(數字)017
       xceaud018 LIKE xcea_t.xceaud018, #自定義欄位(數字)018
       xceaud019 LIKE xcea_t.xceaud019, #自定義欄位(數字)019
       xceaud020 LIKE xcea_t.xceaud020, #自定義欄位(數字)020
       xceaud021 LIKE xcea_t.xceaud021, #自定義欄位(日期時間)021
       xceaud022 LIKE xcea_t.xceaud022, #自定義欄位(日期時間)022
       xceaud023 LIKE xcea_t.xceaud023, #自定義欄位(日期時間)023
       xceaud024 LIKE xcea_t.xceaud024, #自定義欄位(日期時間)024
       xceaud025 LIKE xcea_t.xceaud025, #自定義欄位(日期時間)025
       xceaud026 LIKE xcea_t.xceaud026, #自定義欄位(日期時間)026
       xceaud027 LIKE xcea_t.xceaud027, #自定義欄位(日期時間)027
       xceaud028 LIKE xcea_t.xceaud028, #自定義欄位(日期時間)028
       xceaud029 LIKE xcea_t.xceaud029, #自定義欄位(日期時間)029
       xceaud030 LIKE xcea_t.xceaud030, #自定義欄位(日期時間)030
       xceasite LIKE xcea_t.xceasite  #營運據點
          END RECORD
DEFINE ld_date         DATETIME YEAR TO SECOND
DEFINE l_success       LIKE type_t.num5
         

  #CALL axct701_01_create_tmp()   #170324-00054#1 mark
   
   LET g_success = 'Y'
   LET l_xcea.xceaownid = g_user
   LET l_xcea.xceaowndp = g_dept
   LET l_xcea.xceacrtid = g_user
   LET l_xcea.xceacrtdp = g_dept 
   LET ld_date = cl_get_current()
   LET l_xcea.xceamodid = ""
   LET l_xcea.xceamoddt = ""
   CALL s_aooi200_fin_gen_docno(g_xcea_m.xceald,'','',g_xcea_m.xceadocno,g_xcea_m.xcea001,g_prog_name1)      #wujie 150214
    RETURNING l_success,g_xcea_m.xceadocno
   IF l_success  = 0  THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = 'apm-00003'
      LET g_errparam.extend = g_xcea_m.xceadocno
      LET g_errparam.popup = TRUE
      CALL cl_err()

      LET g_success = 'N'
      RETURN g_success
   END IF
   
   INSERT INTO xcea_t (xceaent,xceald,xceacomp,xcea006,xceadocno,xcea001,xcea002,xcea004, 
       xcea005,xcea003,xceastus,xceaownid,xceaowndp,xceacrtid,xceacrtdp,xceacrtdt, 
       xceamodid,xceamoddt)
   VALUES (g_enterprise,g_xcea_m.xceald,g_xcea_m.xceacomp,g_xcea_m.xcea006,g_xcea_m.xceadocno, 
       g_xcea_m.xcea001,g_xcea002,g_xcea_m.xcea004,g_xcea_m.xcea005,g_xcea_m.xcea003, 
       'N',l_xcea.xceaownid,l_xcea.xceaowndp,l_xcea.xceacrtid, 
       l_xcea.xceacrtdp,ld_date,l_xcea.xceamodid,l_xcea.xceamoddt) 
       
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "g_xcea_m"
      LET g_errparam.popup = TRUE
      CALL cl_err()
  
      LET g_success = 'N'
      RETURN g_success
   END IF

   ###INS xceb_t###
   DELETE FROM sourse_ins_tmp;
   LET g_sql = " INSERT INTO sourse_ins_tmp ",
               "  (xcebent,xcebcomp,xcebld,xcebdocno,xcebseq,",
               "   xceb001,xceb002,xceb003,xceb004,xceb005,",
               "   xceb101,xceb102,xceb103,xceb110,xceb111,",
               "   xceb112,xceb113,xceb114,xceb115,xceb116,",
               "   xceb117,xceb118,xceb119,xceb120,xceb201,",
               "   xceb202,xceb202a,xceb202b,xceb202c,xceb202d,xceb202e,xceb202f,xceb202g,xceb202h,",
               "   xceb212,xceb212a,xceb212b,xceb212c,xceb212d,xceb212e,xceb212f,xceb212g,xceb212h,",
               "   xceb222,xceb222a,xceb222b,xceb222c,xceb222d,xceb222e,xceb222f,xceb222g,xceb222h,",
               "   xceb301,xceb302,xceb107,xceb108,xceb109,",
               "   xceb121,xceb122,xceb123,xceb124,xceb125,",
               "   xceb126,xceb127,xceb128,xceb129,xceb130,",
               "   xceb131,xceb132,sfaa009,sfaasite,sfaa028,",
               "   sfaa029,sfaa052,sfaa057) ",  
               " SELECT ",g_enterprise,",'",g_xcea_m.xceacomp,"','",g_xcea_m.xceald,"','",g_xcea_m.xceadocno,"',rownum,",
               "        xcco009,'',xcco010,xcco006,xcco007,",
               "        '',(SELECT glab010 FROM glab_t WHERE glabld  = '",g_xcea_m.xceald,"' AND glab001 = '61' AND glab002 = '8925' AND glab003 = '3' AND glabent = ",g_enterprise,") xceb102,xcco002,'','', ",
               "        '','','','','',",
               "        '','','','',0,",
               "        xcco102,xcco102a,xcco102b,xcco102c,xcco102d,xcco102e,xcco102f,xcco102g,xcco102h,",
               "        0,0,0,0,0,0,0,0,0,",
               "        0,0,0,0,0,0,0,0,0,",
               "        '','',' ',' ',' ', ",             
               "        ' ',' ',' ',' ',' ', ",             
               "        ' ',' ',' ',' ',' ', ",             
               "        '','','','','', ",             
               "        xcco008,'','' ",    
               "   FROM (",
               "         SELECT xcco002,xcco009,xcco006,xcco007,xcco008,xcco010,",  
               "                SUM(xcco102) xcco102,SUM(xcco102a) xcco102a,SUM(xcco102b) xcco102b,SUM(xcco102c) xcco102c,SUM(xcco102d) xcco102d, ",
               "                SUM(xcco102e) xcco102e,SUM(xcco102f) xcco102f,SUM(xcco102g) xcco102g,SUM(xcco102h) xcco102h ",
               "                FROM xcco_t  ", 
               "          WHERE xccoent = '",g_enterprise,"' AND xccold = '",g_xcea_m.xceald,"'",
               "            AND xcco003 = '",g_xcea_m.xcea003,"' AND xcco004 = ",g_xcea_m.xcea004,
               "            AND xcco005 = ",g_xcea_m.xcea005,
               "            AND xcco001 = '1' ",
               "            AND ",g_wc2,    
               "         GROUP BY xcco002,xcco009,xcco006,xcco007,xcco008,xcco010",  
               "         ORDER BY xcco002,xcco009,xcco006,xcco007,xcco008,xcco010)" 
   PREPARE axct701_3_ins_xceb_01 FROM g_sql
   EXECUTE axct701_3_ins_xceb_01
   
   #更新本位币二金额
   LET g_sql = " MERGE INTO sourse_ins_tmp                               ",
               " USING (SELECT xcco002,xcco009,xcco006,xcco007,xcco008,xcco010,",
               "               SUM(xcco102) xcco102,SUM(xcco102a) xcco102a,SUM(xcco102b) xcco102b,SUM(xcco102c) xcco102c,SUM(xcco102d) xcco102d, ",
               "               SUM(xcco102e) xcco102e,SUM(xcco102f) xcco102f,SUM(xcco102g) xcco102g,SUM(xcco102h) xcco102h ",
               "          FROM xcco_t ",
               "         WHERE xccoent = '",g_enterprise,"' AND xccold = '",g_xcea_m.xceald,"'",
               "           AND xcco003 = '",g_xcea_m.xcea003,"' AND xcco004 = ",g_xcea_m.xcea004,
               "           AND xcco005 = ",g_xcea_m.xcea005,
               "           AND xcco010 = '1' ",
               "           AND xcco001 = '2' ",
               "         GROUP BY xcco002,xcco009,xcco006,xcco007,xcco008,xcco010)",               
               "    ON (xceb103 = xcco002 ", 
               "    AND xceb001 = xcco009 ",
               "    AND xceb004 = xcco006 ", 
               "    AND xceb005 = xcco007 ", 
               "    AND sfaa029 = xcco008 ", 
               "    AND xceb003 = xcco010 )",                 
               "  WHEN MATCHED THEN ",
               "UPDATE SET xceb212  = xcco102 ,",
               "           xceb212a = xcco102a,",
               "           xceb212b = xcco102b,",
               "           xceb212c = xcco102c,",
               "           xceb212d = xcco102d,",
               "           xceb212e = xcco102e,",
               "           xceb212f = xcco102f,",
               "           xceb212g = xcco102g,",
               "           xceb212h = xcco102h "
   PREPARE axct701_3_upd_xceb212 FROM g_sql
   EXECUTE axct701_3_upd_xceb212

   #更新本位币三金额
   LET g_sql = " MERGE INTO sourse_ins_tmp                               ",
               " USING (SELECT xcco002,xcco009,xcco006,xcco007,xcco008,xcco010,",
               "               SUM(xcco102) xcco102,SUM(xcco102a) xcco102a,SUM(xcco102b) xcco102b,SUM(xcco102c) xcco102c,SUM(xcco102d) xcco102d, ",
               "               SUM(xcco102e) xcco102e,SUM(xcco102f) xcco102f,SUM(xcco102g) xcco102g,SUM(xcco102h) xcco102h ",
               "          FROM xcco_t ",
               "         WHERE xccoent = '",g_enterprise,"' AND xccold = '",g_xcea_m.xceald,"'",
               "           AND xcco003 = '",g_xcea_m.xcea003,"' AND xcco004 = ",g_xcea_m.xcea004,
               "           AND xcco005 = ",g_xcea_m.xcea005,
               "           AND xcco010 = '1' ",
               "           AND xcco001 = '3' ",
               "         GROUP BY xcco002,xcco009,xcco006,xcco007,xcco008,xcco010)",               
               "    ON (xceb103 = xcco002 ", 
               "    AND xceb001 = xcco009 ",
               "    AND xceb004 = xcco006 ", 
               "    AND xceb005 = xcco007 ", 
               "    AND sfaa029 = xcco008 ", 
               "    AND xceb003 = xcco010 )",                 
               "  WHEN MATCHED THEN ",
               "UPDATE SET xceb222  = xcco102 ,",
               "           xceb222a = xcco102a,",
               "           xceb222b = xcco102b,",
               "           xceb222c = xcco102c,",
               "           xceb222d = xcco102d,",
               "           xceb222e = xcco102e,",
               "           xceb222f = xcco102f,",
               "           xceb222g = xcco102g,",
               "           xceb222h = xcco102h "
   PREPARE axct701_3_upd_xceb222 FROM g_sql
   EXECUTE axct701_3_upd_xceb222


   UPDATE sourse_ins_tmp 
      SET xceb117 = (SELECT imag011 
                       FROM imag_t
                      WHERE imagent = g_enterprise 
                        AND imagsite = g_xcea_m.xceacomp
                        AND imag001 = xceb004 ) 
                        
   #抓取科目
   UPDATE sourse_ins_tmp 
      SET xceb101 = (SELECT DISTINCT glcc002 FROM glcc_t 
                      WHERE glccent = g_enterprise
                        AND glcc001 = '1'  
                        AND glccld  = g_xcea_m.xceald
                        AND (glcc014= g_xcea_m.xceacomp OR glcc014='*' )
                        AND (glcc016= xceb004 OR glcc016 = '*')
                        AND (glcc011= xceb117 OR glcc011='*')
                        AND rownum = 1)
                        
  #启用交易对象
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad010 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad010 = 'N'  ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb111 = ' '"
   PREPARE axct701_3_upd_xceb111 FROM g_sql
   EXECUTE axct701_3_upd_xceb111

  #启用客群
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad011 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad011 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb112 = ' '"
   PREPARE axct701_3_upd_xceb112 FROM g_sql
   EXECUTE axct701_3_upd_xceb112

  #启用区域
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad009 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad009 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb113 = ' '"
   PREPARE axct701_3_upd_xceb113 FROM g_sql
   EXECUTE axct701_3_upd_xceb113

   
  #启用成本中心
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad008 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad008 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb114 = ' '"
   PREPARE axct701_3_upd_xceb114 FROM g_sql
   EXECUTE axct701_3_upd_xceb114
   
  #启用经营类别
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad031 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad031 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb115 = ' '"
   PREPARE axct701_3_upd_xceb115 FROM g_sql
   EXECUTE axct701_3_upd_xceb115
 
  #启用渠道
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad032 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad032 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb116 = ' '"
   PREPARE axct701_3_upd_xceb116 FROM g_sql
   EXECUTE axct701_3_upd_xceb116

  #启用品类
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad012 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad012 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb117 = ' '"
   PREPARE axct701_3_upd_xceb117 FROM g_sql
   EXECUTE axct701_3_upd_xceb117
   
  #启用品牌
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad033 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad033 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb118 = ' '"
   PREPARE axct701_3_upd_xceb118 FROM g_sql
   EXECUTE axct701_3_upd_xceb118
 
  #启用项目号
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad015 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad015 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb119 = ' '"
   PREPARE axct701_3_upd_xceb119 FROM g_sql
   EXECUTE axct701_3_upd_xceb119
 
  #启用WBS
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad016 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad016 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb120 = ' '"
   PREPARE axct701_3_upd_xceb120 FROM g_sql
   EXECUTE axct701_3_upd_xceb120
 
  #启用人员
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad013 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad013 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb107 = ' '"
   PREPARE axct701_3_upd_xceb107 FROM g_sql
   EXECUTE axct701_3_upd_xceb107
 
  #启用部门
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad007 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad007 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb108 = ' '"
   PREPARE axct701_3_upd_xceb108 FROM g_sql
   EXECUTE axct701_3_upd_xceb108
   
  #启用账款对象
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad027 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad027 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb109 = ' '"
   PREPARE axct701_3_upd_xceb109 FROM g_sql
   EXECUTE axct701_3_upd_xceb109
   
  #启用自由核算项1
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad017 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad017 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb121 = ' '"
   PREPARE axct701_3_upd_xceb121 FROM g_sql
   EXECUTE axct701_3_upd_xceb121
 
  #启用自由核算项2
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad018 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad018 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb122 = ' '"
   PREPARE axct701_3_upd_xceb122 FROM g_sql
   EXECUTE axct701_3_upd_xceb122
 
  #启用自由核算项3
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad019 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad019 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb123 = ' '"
   PREPARE axct701_3_upd_xceb123 FROM g_sql
   EXECUTE axct701_3_upd_xceb123

  #启用自由核算项4
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad019 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad019 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb124 = ' '"
   PREPARE axct701_3_upd_xceb124 FROM g_sql
   EXECUTE axct701_3_upd_xceb124

  #启用自由核算项5
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad021 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad021 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb125 = ' '"
   PREPARE axct701_3_upd_xceb125 FROM g_sql
   EXECUTE axct701_3_upd_xceb125

  #启用自由核算项6
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad022 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad022 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb126 = ' '"
   PREPARE axct701_3_upd_xceb126 FROM g_sql
   EXECUTE axct701_3_upd_xceb126

  #启用自由核算项7
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad023 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad023 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb127 = ' '"
   PREPARE axct701_3_upd_xceb127 FROM g_sql
   EXECUTE axct701_3_upd_xceb127

  #启用自由核算项8
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad024 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad024 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb128 = ' '"
   PREPARE axct701_3_upd_xceb128 FROM g_sql
   EXECUTE axct701_3_upd_xceb128

  #启用自由核算项9
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad025 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad025 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb129 = ' '"
   PREPARE axct701_3_upd_xceb129 FROM g_sql
   EXECUTE axct701_3_upd_xceb129

  #启用自由核算项10
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad026 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad026 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb130 = ' '"
   PREPARE axct701_3_upd_xceb130 FROM g_sql
   EXECUTE axct701_3_upd_xceb130
   
  #特性
   UPDATE sourse_ins_tmp SET xceb005 = ' ' WHERE xceb005 IS NULL
 #科目编号
   UPDATE sourse_ins_tmp SET xceb101 = ' ' WHERE xceb101 IS NULL
  #摘要
   UPDATE sourse_ins_tmp SET xceb102 = ' ' WHERE xceb102 IS NULL
  #成本域
   UPDATE sourse_ins_tmp SET xceb103 = ' ' WHERE xceb103 IS NULL
  #原因码
   UPDATE sourse_ins_tmp SET xceb110 = ' ' WHERE xceb110 IS NULL
  #交易对象
   UPDATE sourse_ins_tmp SET xceb111 = ' ' WHERE xceb111 IS NULL
  #客群
   UPDATE sourse_ins_tmp SET xceb112 = ' ' WHERE xceb112 IS NULL
  #区域
   UPDATE sourse_ins_tmp SET xceb113 = ' ' WHERE xceb113 IS NULL
  #成本中心
   UPDATE sourse_ins_tmp SET xceb114 = ' ' WHERE xceb114 IS NULL
  #经营类别
   UPDATE sourse_ins_tmp SET xceb115 = ' ' WHERE xceb115 IS NULL
  #渠道
   UPDATE sourse_ins_tmp SET xceb116 = ' ' WHERE xceb116 IS NULL
  #品类
   UPDATE sourse_ins_tmp SET xceb117 = ' ' WHERE xceb117 IS NULL
  #品牌
   UPDATE sourse_ins_tmp SET xceb118 = ' ' WHERE xceb118 IS NULL
  #项目号
   UPDATE sourse_ins_tmp SET xceb119 = ' ' WHERE xceb119 IS NULL
  #WBS
   UPDATE sourse_ins_tmp SET xceb120 = ' ' WHERE xceb120 IS NULL
  #人员
   UPDATE sourse_ins_tmp SET xceb107 = ' ' WHERE xceb107 IS NULL
   #部门
   UPDATE sourse_ins_tmp SET xceb108 = ' ' WHERE xceb108 IS NULL
  #账款对象
   UPDATE sourse_ins_tmp SET xceb109 = ' ' WHERE xceb109 IS NULL
  #自由核算项1
   UPDATE sourse_ins_tmp SET xceb121 = ' ' WHERE xceb121 IS NULL
  #自由核算项2
   UPDATE sourse_ins_tmp SET xceb122 = ' ' WHERE xceb122 IS NULL
  #自由核算项3
   UPDATE sourse_ins_tmp SET xceb123 = ' ' WHERE xceb123 IS NULL
  #自由核算项4
   UPDATE sourse_ins_tmp SET xceb124 = ' ' WHERE xceb124 IS NULL
  #自由核算项5
   UPDATE sourse_ins_tmp SET xceb125 = ' ' WHERE xceb125 IS NULL
  #自由核算项6
   UPDATE sourse_ins_tmp SET xceb126 = ' ' WHERE xceb126 IS NULL
   #自由核算项7
   UPDATE sourse_ins_tmp SET xceb127 = ' ' WHERE xceb127 IS NULL
  #自由核算项8
   UPDATE sourse_ins_tmp SET xceb128 = ' ' WHERE xceb128 IS NULL
  #自由核算项9
   UPDATE sourse_ins_tmp SET xceb129 = ' ' WHERE xceb129 IS NULL
  #自由核算项10
   UPDATE sourse_ins_tmp SET xceb130 = ' ' WHERE xceb130 IS NULL

   INSERT INTO xceb_t (xcebent,xcebcomp,xcebld,xcebdocno,xcebseq,
                       xceb001,xceb002,xceb003,xceb004,xceb005,xceb101,xceb102,xceb103,xceb110,xceb111,
                       xceb112,xceb113,xceb114,xceb115,xceb116,xceb117,xceb118,xceb119,xceb120,xceb201,
                       xceb202,xceb202a,xceb202b,xceb202c,xceb202d,xceb202e,xceb202f,xceb202g,xceb202h,
                       xceb212,xceb212a,xceb212b,xceb212c,xceb212d,xceb212e,xceb212f,xceb212g,xceb212h,
                       xceb222,xceb222a,xceb222b,xceb222c,xceb222d,xceb222e,xceb222f,xceb222g,xceb222h,
                       xceb301,xceb302,xceb107,xceb108,xceb109,xceb121,xceb122,xceb123,xceb124,xceb125,
                       xceb126,xceb127,xceb128,xceb129,xceb130,xceb131,xceb132)
         SELECT xcebent,xcebcomp,xcebld,xcebdocno,xcebseq,
                xceb001,xceb002,xceb003,xceb004,xceb005,xceb101,xceb102,xceb103,xceb110,xceb111,
                xceb112,xceb113,xceb114,xceb115,xceb116,xceb117,xceb118,xceb119,xceb120,xceb201,
                xceb202,xceb202a,xceb202b,xceb202c,xceb202d,xceb202e,xceb202f,xceb202g,xceb202h,
                xceb212,xceb212a,xceb212b,xceb212c,xceb212d,xceb212e,xceb212f,xceb212g,xceb212h,
                xceb222,xceb222a,xceb222b,xceb222c,xceb222d,xceb222e,xceb222f,xceb222g,xceb222h,
                xceb301,xceb302,xceb107,xceb108,xceb109,xceb121,xceb122,xceb123,xceb124,xceb125,
                xceb126,xceb127,xceb128,xceb129,xceb130,xceb131,xceb132
           FROM sourse_ins_tmp
 
 
    UPDATE sourse_ins_tmp 
      SET xceb101 = (SELECT glab005
                      FROM glab_t
                     WHERE glabld  = g_xcea_m.xceald
                       AND glab001 = '60'
                       AND glab002 = '8912'
                       AND glab003 = '5'
                       AND glabent = g_enterprise)
    WHERE xceb101 IS NULL OR xceb101 = ' '
    
  #启用交易对象
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad010 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad010 = 'N'  ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb111 = ' '"
   PREPARE axct701_3_upd_xcec111 FROM g_sql
   EXECUTE axct701_3_upd_xcec111

  #启用客群
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad011 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad011 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb112 = ' '"
   PREPARE axct701_3_upd_xcec112 FROM g_sql
   EXECUTE axct701_3_upd_xcec112

  #启用区域
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad009 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad009 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb113 = ' '"
   PREPARE axct701_3_upd_xcec113 FROM g_sql
   EXECUTE axct701_3_upd_xcec113

   
  #启用成本中心
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad008 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad008 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb114 = ' '"
   PREPARE axct701_3_upd_xcec114 FROM g_sql
   EXECUTE axct701_3_upd_xcec114
   
  #启用经营类别
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad031 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad031 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb115 = ' '"
   PREPARE axct701_3_upd_xcec115 FROM g_sql
   EXECUTE axct701_3_upd_xcec115
 
  #启用渠道
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad032 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad032 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb116 = ' '"
   PREPARE axct701_3_upd_xcec116 FROM g_sql
   EXECUTE axct701_3_upd_xcec116

  #启用品类
  #170221-00041#1 add start ----
   UPDATE sourse_ins_tmp
      SET xceb117 = (SELECT imag011 FROM imag_t
                      WHERE imagent = xcebent
                        AND imagsite = g_xcea_m.xceacomp
                        AND imag001 = xceb004)
  #170221-00041#1 add end   ----   
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad012 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad012 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb117 = ' '"
   PREPARE axct701_3_upd_xcec117 FROM g_sql
   EXECUTE axct701_3_upd_xcec117
   
  #启用品牌
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad033 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad033 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb118 = ' '"
   PREPARE axct701_3_upd_xcec118 FROM g_sql
   EXECUTE axct701_3_upd_xcec118
 
  #启用项目号
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad015 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad015 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb119 = ' '"
   PREPARE axct701_3_upd_xcec119 FROM g_sql
   EXECUTE axct701_3_upd_xcec119
 
  #启用WBS
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad016 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad016 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb120 = ' '"
   PREPARE axct701_3_upd_xcec120 FROM g_sql
   EXECUTE axct701_3_upd_xcec120
 
  #启用人员
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad013 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad013 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb107 = ' '"
   PREPARE axct701_3_upd_xcec107 FROM g_sql
   EXECUTE axct701_3_upd_xcec107
 
  #启用部门
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad007 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad007 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb108 = ' '"
   PREPARE axct701_3_upd_xcec108 FROM g_sql
   EXECUTE axct701_3_upd_xcec108
   
  #启用账款对象
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad027 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad027 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb109 = ' '"
   PREPARE axct701_3_upd_xcec109 FROM g_sql
   EXECUTE axct701_3_upd_xcec109
   
  #启用自由核算项1
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad017 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad017 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb121 = ' '"
   PREPARE axct701_3_upd_xcec121 FROM g_sql
   EXECUTE axct701_3_upd_xcec121
 
  #启用自由核算项2
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad018 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad018 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb122 = ' '"
   PREPARE axct701_3_upd_xcec122 FROM g_sql
   EXECUTE axct701_3_upd_xcec122
 
  #启用自由核算项3
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad019 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad019 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb123 = ' '"
   PREPARE axct701_3_upd_xcec123 FROM g_sql
   EXECUTE axct701_3_upd_xcec123

  #启用自由核算项4
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad019 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad019 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb124 = ' '"
   PREPARE axct701_3_upd_xcec124 FROM g_sql
   EXECUTE axct701_3_upd_xcec124

  #启用自由核算项5
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad021 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad021 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb125 = ' '"
   PREPARE axct701_3_upd_xcec125 FROM g_sql
   EXECUTE axct701_3_upd_xcec125

  #启用自由核算项6
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad022 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad022 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb126 = ' '"
   PREPARE axct701_3_upd_xcec126 FROM g_sql
   EXECUTE axct701_3_upd_xcec126

  #启用自由核算项7
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad023 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad023 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb127 = ' '"
   PREPARE axct701_3_upd_xcec127 FROM g_sql
   EXECUTE axct701_3_upd_xcec127

  #启用自由核算项8
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad024 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad024 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb128 = ' '"
   PREPARE axct701_3_upd_xcec128 FROM g_sql
   EXECUTE axct701_3_upd_xcec128

  #启用自由核算项9
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad025 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad025 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb129 = ' '"
   PREPARE axct701_3_upd_xcec129 FROM g_sql
   EXECUTE axct701_3_upd_xcec129

  #启用自由核算项10
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad026 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad026 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb130 = ' '"
   PREPARE axct701_3_upd_xcec130 FROM g_sql
   EXECUTE axct701_3_upd_xcec130
   
  #特性
   UPDATE sourse_ins_tmp SET xceb005 = ' ' WHERE xceb005 IS NULL
 #科目编号
   UPDATE sourse_ins_tmp SET xceb101 = ' ' WHERE xceb101 IS NULL
  #摘要
   UPDATE sourse_ins_tmp SET xceb102 = ' ' WHERE xceb102 IS NULL
  #成本域
   UPDATE sourse_ins_tmp SET xceb103 = ' ' WHERE xceb103 IS NULL
  #原因码
   UPDATE sourse_ins_tmp SET xceb110 = ' ' WHERE xceb110 IS NULL
  #交易对象
   UPDATE sourse_ins_tmp SET xceb111 = ' ' WHERE xceb111 IS NULL
  #客群
   UPDATE sourse_ins_tmp SET xceb112 = ' ' WHERE xceb112 IS NULL
  #区域
   UPDATE sourse_ins_tmp SET xceb113 = ' ' WHERE xceb113 IS NULL
  #成本中心
   UPDATE sourse_ins_tmp SET xceb114 = ' ' WHERE xceb114 IS NULL
  #经营类别
   UPDATE sourse_ins_tmp SET xceb115 = ' ' WHERE xceb115 IS NULL
  #渠道
   UPDATE sourse_ins_tmp SET xceb116 = ' ' WHERE xceb116 IS NULL
  #品类
   UPDATE sourse_ins_tmp SET xceb117 = ' ' WHERE xceb117 IS NULL
  #品牌
   UPDATE sourse_ins_tmp SET xceb118 = ' ' WHERE xceb118 IS NULL
  #项目号
   UPDATE sourse_ins_tmp SET xceb119 = ' ' WHERE xceb119 IS NULL
  #WBS
   UPDATE sourse_ins_tmp SET xceb120 = ' ' WHERE xceb120 IS NULL
  #人员
   UPDATE sourse_ins_tmp SET xceb107 = ' ' WHERE xceb107 IS NULL
   #部门
   UPDATE sourse_ins_tmp SET xceb108 = ' ' WHERE xceb108 IS NULL
  #账款对象
   UPDATE sourse_ins_tmp SET xceb109 = ' ' WHERE xceb109 IS NULL
  #自由核算项1
   UPDATE sourse_ins_tmp SET xceb121 = ' ' WHERE xceb121 IS NULL
  #自由核算项2
   UPDATE sourse_ins_tmp SET xceb122 = ' ' WHERE xceb122 IS NULL
  #自由核算项3
   UPDATE sourse_ins_tmp SET xceb123 = ' ' WHERE xceb123 IS NULL
  #自由核算项4
   UPDATE sourse_ins_tmp SET xceb124 = ' ' WHERE xceb124 IS NULL
  #自由核算项5
   UPDATE sourse_ins_tmp SET xceb125 = ' ' WHERE xceb125 IS NULL
  #自由核算项6
   UPDATE sourse_ins_tmp SET xceb126 = ' ' WHERE xceb126 IS NULL
   #自由核算项7
   UPDATE sourse_ins_tmp SET xceb127 = ' ' WHERE xceb127 IS NULL
  #自由核算项8
   UPDATE sourse_ins_tmp SET xceb128 = ' ' WHERE xceb128 IS NULL
  #自由核算项9
   UPDATE sourse_ins_tmp SET xceb129 = ' ' WHERE xceb129 IS NULL
  #自由核算项10
   UPDATE sourse_ins_tmp SET xceb130 = ' ' WHERE xceb130 IS NULL
   
   INSERT INTO xcec_t (xcecent,xceccomp,xcecld,xcecdocno,xcecseq,
                       xcec001,xcec002,xcec003,xcec004,xcec005,xcec101,xcec102,xcec103,xcec110,xcec111,
                       xcec112,xcec113,xcec114,xcec115,xcec116,xcec117,xcec118,xcec119,xcec120,xcec201,
                       xcec202,xcec202a,xcec202b,xcec202c,xcec202d,xcec202e,xcec202f,xcec202g,xcec202h,
                       xcec212,xcec212a,xcec212b,xcec212c,xcec212d,xcec212e,xcec212f,xcec212g,xcec212h,
                       xcec222,xcec222a,xcec222b,xcec222c,xcec222d,xcec222e,xcec222f,xcec222g,xcec222h,
                       xcec301,xcec302,xcec107,xcec108,xcec109,xcec121,xcec122,xcec123,xcec124,xcec125,
                       xcec126,xcec127,xcec128,xcec129,xcec130)
         SELECT xcebent,xcebcomp,xcebld,xcebdocno,xcebseq,
                xceb001,xceb002,xceb003,xceb004,xceb005,xceb101,xceb102,xceb103,xceb110,xceb111,
                xceb112,xceb113,xceb114,xceb115,xceb116,xceb117,xceb118,xceb119,xceb120,xceb201,
                xceb202,xceb202a,xceb202b,xceb202c,xceb202d,xceb202e,xceb202f,xceb202g,xceb202h,
                xceb212,xceb212a,xceb212b,xceb212c,xceb212d,xceb212e,xceb212f,xceb212g,xceb212h,
                xceb222,xceb222a,xceb222b,xceb222c,xceb222d,xceb222e,xceb222f,xceb222g,xceb222h,
                xceb301,xceb302,xceb107,xceb108,xceb109,xceb121,xceb122,xceb123,xceb124,xceb125,
                xceb126,xceb127,xceb128,xceb129,xceb130
           FROM sourse_ins_tmp 

   DELETE FROM sourse_ins_tmp; 
   DELETE FROM sourse_ins_tmp1; 
   RETURN g_success
END FUNCTION

################################################################################
# Descriptions...: 10.盤因虧憑證  axct704
# Date & Author..: 2017/02/03 By 02295
# Modify.........: #170105-00011#7
################################################################################
PRIVATE FUNCTION axct701_01_ins_4()
DEFINE l_xcea          RECORD  #工單發料成本憑證單頭檔
       xceaent LIKE xcea_t.xceaent, #企業編號
       xceacomp LIKE xcea_t.xceacomp, #法人組織
       xceald LIKE xcea_t.xceald, #帳套
       xceadocno LIKE xcea_t.xceadocno, #單據編號
       xcea001 LIKE xcea_t.xcea001, #單據日期
       xcea002 LIKE xcea_t.xcea002, #成本憑證類型
       xcea003 LIKE xcea_t.xcea003, #成本計算類型
       xcea004 LIKE xcea_t.xcea004, #年度
       xcea005 LIKE xcea_t.xcea005, #期別
       xcea006 LIKE xcea_t.xcea006, #帳務人員
       xcea007 LIKE xcea_t.xcea007, #帳務部門
       xcea101 LIKE xcea_t.xcea101, #憑證編號
       xcea102 LIKE xcea_t.xcea102, #憑證日期
       xceaownid LIKE xcea_t.xceaownid, #資料所有者
       xceaowndp LIKE xcea_t.xceaowndp, #資料所屬部門
       xceacrtid LIKE xcea_t.xceacrtid, #資料建立者
       xceacrtdp LIKE xcea_t.xceacrtdp, #資料建立部門
       xceacrtdt LIKE xcea_t.xceacrtdt, #資料創建日
       xceamodid LIKE xcea_t.xceamodid, #資料修改者
       xceamoddt LIKE xcea_t.xceamoddt, #最近修改日
       xceacnfid LIKE xcea_t.xceacnfid, #資料確認者
       xceacnfdt LIKE xcea_t.xceacnfdt, #資料確認日
       xceapstid LIKE xcea_t.xceapstid, #資料過帳者
       xceapstdt LIKE xcea_t.xceapstdt, #資料過帳日
       xceastus LIKE xcea_t.xceastus, #狀態碼
       xceaud001 LIKE xcea_t.xceaud001, #自定義欄位(文字)001
       xceaud002 LIKE xcea_t.xceaud002, #自定義欄位(文字)002
       xceaud003 LIKE xcea_t.xceaud003, #自定義欄位(文字)003
       xceaud004 LIKE xcea_t.xceaud004, #自定義欄位(文字)004
       xceaud005 LIKE xcea_t.xceaud005, #自定義欄位(文字)005
       xceaud006 LIKE xcea_t.xceaud006, #自定義欄位(文字)006
       xceaud007 LIKE xcea_t.xceaud007, #自定義欄位(文字)007
       xceaud008 LIKE xcea_t.xceaud008, #自定義欄位(文字)008
       xceaud009 LIKE xcea_t.xceaud009, #自定義欄位(文字)009
       xceaud010 LIKE xcea_t.xceaud010, #自定義欄位(文字)010
       xceaud011 LIKE xcea_t.xceaud011, #自定義欄位(數字)011
       xceaud012 LIKE xcea_t.xceaud012, #自定義欄位(數字)012
       xceaud013 LIKE xcea_t.xceaud013, #自定義欄位(數字)013
       xceaud014 LIKE xcea_t.xceaud014, #自定義欄位(數字)014
       xceaud015 LIKE xcea_t.xceaud015, #自定義欄位(數字)015
       xceaud016 LIKE xcea_t.xceaud016, #自定義欄位(數字)016
       xceaud017 LIKE xcea_t.xceaud017, #自定義欄位(數字)017
       xceaud018 LIKE xcea_t.xceaud018, #自定義欄位(數字)018
       xceaud019 LIKE xcea_t.xceaud019, #自定義欄位(數字)019
       xceaud020 LIKE xcea_t.xceaud020, #自定義欄位(數字)020
       xceaud021 LIKE xcea_t.xceaud021, #自定義欄位(日期時間)021
       xceaud022 LIKE xcea_t.xceaud022, #自定義欄位(日期時間)022
       xceaud023 LIKE xcea_t.xceaud023, #自定義欄位(日期時間)023
       xceaud024 LIKE xcea_t.xceaud024, #自定義欄位(日期時間)024
       xceaud025 LIKE xcea_t.xceaud025, #自定義欄位(日期時間)025
       xceaud026 LIKE xcea_t.xceaud026, #自定義欄位(日期時間)026
       xceaud027 LIKE xcea_t.xceaud027, #自定義欄位(日期時間)027
       xceaud028 LIKE xcea_t.xceaud028, #自定義欄位(日期時間)028
       xceaud029 LIKE xcea_t.xceaud029, #自定義欄位(日期時間)029
       xceaud030 LIKE xcea_t.xceaud030, #自定義欄位(日期時間)030
       xceasite LIKE xcea_t.xceasite  #營運據點
          END RECORD
DEFINE ld_date         DATETIME YEAR TO SECOND
DEFINE l_success       LIKE type_t.num5
         

  #CALL axct701_01_create_tmp()   #170324-00054#1 mark
   
   LET g_success = 'Y'
   LET l_xcea.xceaownid = g_user
   LET l_xcea.xceaowndp = g_dept
   LET l_xcea.xceacrtid = g_user
   LET l_xcea.xceacrtdp = g_dept 
   LET ld_date = cl_get_current()
   LET l_xcea.xceamodid = ""
   LET l_xcea.xceamoddt = ""
   CALL s_aooi200_fin_gen_docno(g_xcea_m.xceald,'','',g_xcea_m.xceadocno,g_xcea_m.xcea001,g_prog_name1)     
    RETURNING l_success,g_xcea_m.xceadocno
   IF l_success  = 0  THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = 'apm-00003'
      LET g_errparam.extend = g_xcea_m.xceadocno
      LET g_errparam.popup = TRUE
      CALL cl_err()

      LET g_success = 'N'
      RETURN g_success
   END IF
   
   INSERT INTO xcea_t (xceaent,xceald,xceacomp,xcea006,xceadocno,xcea001,xcea002,xcea004, 
       xcea005,xcea003,xceastus,xceaownid,xceaowndp,xceacrtid,xceacrtdp,xceacrtdt, 
       xceamodid,xceamoddt)
   VALUES (g_enterprise,g_xcea_m.xceald,g_xcea_m.xceacomp,g_xcea_m.xcea006,g_xcea_m.xceadocno, 
       g_xcea_m.xcea001,g_xcea002,g_xcea_m.xcea004,g_xcea_m.xcea005,g_xcea_m.xcea003, 
       'N',l_xcea.xceaownid,l_xcea.xceaowndp,l_xcea.xceacrtid, 
       l_xcea.xceacrtdp,ld_date,l_xcea.xceamodid,l_xcea.xceamoddt) 
       
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "g_xcea_m"
      LET g_errparam.popup = TRUE
      CALL cl_err()
  
      LET g_success = 'N'
      RETURN g_success
   END IF
   
   ###INS xceb_t###
   DELETE FROM sourse_ins_tmp;
   LET g_sql = " INSERT INTO sourse_ins_tmp ",
               "  (xcebent,xcebcomp,xcebld,xcebdocno,xcebseq,",
               "   xceb001,xceb002,xceb003,xceb004,xceb005,",
               "   xceb101,xceb102,xceb103,xceb110,xceb111,",
               "   xceb112,xceb113,xceb114,xceb115,xceb116,",
               "   xceb117,xceb118,xceb119,xceb120,xceb201,",
               "   xceb202,xceb202a,xceb202b,xceb202c,xceb202d,xceb202e,xceb202f,xceb202g,xceb202h,",
               "   xceb212,xceb212a,xceb212b,xceb212c,xceb212d,xceb212e,xceb212f,xceb212g,xceb212h,",
               "   xceb222,xceb222a,xceb222b,xceb222c,xceb222d,xceb222e,xceb222f,xceb222g,xceb222h,",
               "   xceb301,xceb302,xceb107,xceb108,xceb109,",
               "   xceb121,xceb122,xceb123,xceb124,xceb125,",
               "   xceb126,xceb127,xceb128,xceb129,xceb130,",
               "   xceb131,xceb132,sfaa009,sfaasite,sfaa028,",
               "   sfaa029,sfaa052,sfaa057) ",  
               " SELECT ",g_enterprise,",'",g_xcea_m.xceacomp,"','",g_xcea_m.xceald,"','",g_xcea_m.xceadocno,"',rownum,",
               "        xcck006,xcck007,xcck012,xcck010,xcck011,",
               "        '',(SELECT glab010 FROM glab_t WHERE glabld  = '",g_xcea_m.xceald,"' AND glab001 = '61' AND glab002 = '8925' AND glab003 = '4' AND glabent = ",g_enterprise,") xceb102,xcck002,'','', ",
               "        '','','','','',",
               "        '','','','',xcck201,",
               "        xcck202,xcck202a,xcck202b,xcck202c,xcck202d,xcck202e,xcck202f,xcck202g,xcck202h,",
               "        0,0,0,0,0,0,0,0,0,",
               "        0,0,0,0,0,0,0,0,0,",
               "        '','',' ',' ',' ', ",             
               "        ' ',' ',' ',' ',' ', ",             
               "        ' ',' ',' ',' ',' ', ",             
               "        '','','','','', ",             
               "        '',xcck008,'' ",     
               "   FROM (",
               "         SELECT xcck002,xcck008,xcck006,xcck010,xcck011,xcck012,xcck007,SUM(xcck009*xcck201) xcck201,SUM(xcck009*xcck202) xcck202, ",
               "                SUM(xcck009*xcck202a) xcck202a,SUM(xcck009*xcck202b) xcck202b,SUM(xcck009*xcck202c) xcck202c,SUM(xcck009*xcck202d) xcck202d,",
               "                SUM(xcck009*xcck202e) xcck202e,SUM(xcck009*xcck202f) xcck202f,SUM(xcck009*xcck202g) xcck202g,SUM(xcck009*xcck202h) xcck202h ",
               "                FROM xcck_t ", 
               "          WHERE xcckent = '",g_enterprise,"' AND xcckld = '",g_xcea_m.xceald,"'",
               "            AND xcck003 = '",g_xcea_m.xcea003,"' AND xcck004 = ",g_xcea_m.xcea004,
               "            AND xcck055 = '311' ",
               "            AND xcck005 = ",g_xcea_m.xcea005,
               "            AND xcck001 = '1' ",
               "          GROUP BY xcck002,xcck008,xcck006,xcck010,xcck011,xcck012,xcck007",
               "          ORDER BY xcck002,xcck008,xcck006,xcck010,xcck011,xcck012,xcck007)"   
   PREPARE axct701_4_ins_xceb_01 FROM g_sql
   EXECUTE axct701_4_ins_xceb_01
   
   #更新本位币二金额
   LET g_sql = " MERGE INTO sourse_ins_tmp                               ",
               " USING (SELECT xcck002,xcck008,xcck006,xcck007,xcck010,xcck011,xcck012,",
               "               SUM(xcck009*xcck202) xcck202, ",
               "               SUM(xcck009*xcck202a) xcck202a,SUM(xcck009*xcck202b) xcck202b,SUM(xcck009*xcck202c) xcck202c,SUM(xcck009*xcck202d) xcck202d,",
               "               SUM(xcck009*xcck202e) xcck202e,SUM(xcck009*xcck202f) xcck202f,SUM(xcck009*xcck202g) xcck202g,SUM(xcck009*xcck202h) xcck202h ",
               "          FROM xcck_t ", 
               "         WHERE xcckent = '",g_enterprise,"' AND xcckld = '",g_xcea_m.xceald,"'",
               "           AND xcck003 = '",g_xcea_m.xcea003,"' AND xcck004 = ",g_xcea_m.xcea004,
               "           AND xcck005 = ",g_xcea_m.xcea005,
               "           AND xcck055 = '311' ",
               "           AND xcck001 = '2' ", 
               "         GROUP BY xcck002,xcck008,xcck006,xcck007,xcck010,xcck011,xcck012)",               
               "    ON (xceb001 = xcck006 ",
               "        AND xceb002 = xcck007 ", 
               "        AND xceb103 = xcck002", 
               "        AND xceb004 = xcck010", 
               "        AND xceb005 = xcck011", 
               "        AND xceb003 = xcck012", 
               "        AND sfaa052 = xcck008", 
               "        AND xceb001 = xcck006)",                 
               "  WHEN MATCHED THEN ",
               "UPDATE SET xceb212  = xcck202 ,",
               "           xceb212a = xcck202a,",
               "           xceb212b = xcck202b,",
               "           xceb212c = xcck202c,",
               "           xceb212d = xcck202d,",
               "           xceb212e = xcck202e,",
               "           xceb212f = xcck202f,",
               "           xceb212g = xcck202g,",
               "           xceb212h = xcck202h "
   PREPARE axct701_4_upd_xceb212 FROM g_sql
   EXECUTE axct701_4_upd_xceb212

   #更新本位币三金额
   LET g_sql = " MERGE INTO sourse_ins_tmp                               ",
               " USING (SELECT xcck002,xcck008,xcck006,xcck007,xcck010,xcck011,xcck012,",
               "               SUM(xcck009*xcck202) xcck202, ",
               "               SUM(xcck009*xcck202a) xcck202a,SUM(xcck009*xcck202b) xcck202b,SUM(xcck009*xcck202c) xcck202c,SUM(xcck009*xcck202d) xcck202d,",
               "               SUM(xcck009*xcck202e) xcck202e,SUM(xcck009*xcck202f) xcck202f,SUM(xcck009*xcck202g) xcck202g,SUM(xcck009*xcck202h) xcck202h ",
               "          FROM xcck_t ", 
               "         WHERE xcckent = '",g_enterprise,"' AND xcckld = '",g_xcea_m.xceald,"'",
               "           AND xcck003 = '",g_xcea_m.xcea003,"' AND xcck004 = ",g_xcea_m.xcea004,
               "           AND xcck005 = ",g_xcea_m.xcea005,
               "           AND xcck055 = '311' ",
               "           AND xcck001 = '3' ", 
               "         GROUP BY xcck002,xcck008,xcck006,xcck007,xcck010,xcck011,xcck012)",               
               "    ON (xceb001 = xcck006 ",
               "        AND xceb002 = xcck007 ", 
               "        AND xceb103 = xcck002", 
               "        AND xceb004 = xcck010", 
               "        AND xceb005 = xcck011", 
               "        AND xceb003 = xcck012", 
               "        AND sfaa052 = xcck008", 
               "        AND xceb001 = xcck006)",                 
               "  WHEN MATCHED THEN ",
               "UPDATE SET xceb212  = xcck202 ,",
               "           xceb212a = xcck202a,",
               "           xceb212b = xcck202b,",
               "           xceb212c = xcck202c,",
               "           xceb212d = xcck202d,",
               "           xceb212e = xcck202e,",
               "           xceb212f = xcck202f,",
               "           xceb212g = xcck202g,",
               "           xceb212h = xcck202h "
   PREPARE axct701_4_upd_xceb222 FROM g_sql
   EXECUTE axct701_4_upd_xceb222
             
   UPDATE sourse_ins_tmp
      SET sfaasite = (SELECT imag011 FROM imag_t
                       WHERE imagent = g_enterprise AND imagsite = g_xcea_m.xceacomp
                         AND imag001 = xceb004)  
                         
   UPDATE sourse_ins_tmp 
      SET xceb101 = (SELECT DISTINCT glcc002 FROM glcc_t 
                      WHERE glccent = g_enterprise
                        AND glcc001 = '1'  
                        AND glccld  = g_xcea_m.xceald
                        AND (glcc014= g_xcea_m.xceacomp OR glcc014='*' )
                        AND (glcc016=xceb004 OR glcc016 = '*')
                        AND (glcc011=sfaasite OR glcc011='*')
                        AND rownum = 1)   
    WHERE xceb101 IS NULL OR xceb101 = ' '

  #启用交易对象
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad010 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad010 = 'N'  ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb111 = ' '"
   PREPARE axct701_4_upd_xceb111 FROM g_sql
   EXECUTE axct701_4_upd_xceb111

  #启用客群
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad011 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad011 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb112 = ' '"
   PREPARE axct701_4_upd_xceb112 FROM g_sql
   EXECUTE axct701_4_upd_xceb112

  #启用区域
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad009 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad009 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb113 = ' '"
   PREPARE axct701_4_upd_xceb113 FROM g_sql
   EXECUTE axct701_4_upd_xceb113

   
  #启用成本中心
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad008 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad008 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb114 = ' '"
   PREPARE axct701_4_upd_xceb114 FROM g_sql
   EXECUTE axct701_4_upd_xceb114
   
  #启用经营类别
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad031 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad031 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb115 = ' '"
   PREPARE axct701_4_upd_xceb115 FROM g_sql
   EXECUTE axct701_4_upd_xceb115
 
  #启用渠道
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad032 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad032 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb116 = ' '"
   PREPARE axct701_4_upd_xceb116 FROM g_sql
   EXECUTE axct701_4_upd_xceb116

  #启用品类
  #170221-00041#1 add start ----
   UPDATE sourse_ins_tmp
      SET xceb117 = (SELECT imag011 FROM imag_t
                      WHERE imagent = xcebent
                        AND imagsite = g_xcea_m.xceacomp
                        AND imag001 = xceb004)
  #170221-00041#1 add end   ----  
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad012 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad012 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb117 = ' '"
   PREPARE axct701_4_upd_xceb117 FROM g_sql
   EXECUTE axct701_4_upd_xceb117
   
  #启用品牌
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad033 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad033 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb118 = ' '"
   PREPARE axct701_4_upd_xceb118 FROM g_sql
   EXECUTE axct701_4_upd_xceb118
 
  #启用项目号
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad015 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad015 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb119 = ' '"
   PREPARE axct701_4_upd_xceb119 FROM g_sql
   EXECUTE axct701_4_upd_xceb119
 
  #启用WBS
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad016 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad016 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb120 = ' '"
   PREPARE axct701_4_upd_xceb120 FROM g_sql
   EXECUTE axct701_4_upd_xceb120
 
  #启用人员
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad013 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad013 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb107 = ' '"
   PREPARE axct701_4_upd_xceb107 FROM g_sql
   EXECUTE axct701_4_upd_xceb107
 
  #启用部门
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad007 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad007 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb108 = ' '"
   PREPARE axct701_4_upd_xceb108 FROM g_sql
   EXECUTE axct701_4_upd_xceb108
   
  #启用账款对象
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad027 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad027 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb109 = ' '"
   PREPARE axct701_4_upd_xceb109 FROM g_sql
   EXECUTE axct701_4_upd_xceb109
   
  #启用自由核算项1
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad017 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad017 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb121 = ' '"
   PREPARE axct701_4_upd_xceb121 FROM g_sql
   EXECUTE axct701_4_upd_xceb121
 
  #启用自由核算项2
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad018 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad018 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb122 = ' '"
   PREPARE axct701_4_upd_xceb122 FROM g_sql
   EXECUTE axct701_4_upd_xceb122
 
  #启用自由核算项3
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad019 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad019 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb123 = ' '"
   PREPARE axct701_4_upd_xceb123 FROM g_sql
   EXECUTE axct701_4_upd_xceb123

  #启用自由核算项4
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad019 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad019 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb124 = ' '"
   PREPARE axct701_4_upd_xceb124 FROM g_sql
   EXECUTE axct701_4_upd_xceb124

  #启用自由核算项5
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad021 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad021 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb125 = ' '"
   PREPARE axct701_4_upd_xceb125 FROM g_sql
   EXECUTE axct701_4_upd_xceb125

  #启用自由核算项6
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad022 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad022 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb126 = ' '"
   PREPARE axct701_4_upd_xceb126 FROM g_sql
   EXECUTE axct701_4_upd_xceb126

  #启用自由核算项7
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad023 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad023 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb127 = ' '"
   PREPARE axct701_4_upd_xceb127 FROM g_sql
   EXECUTE axct701_4_upd_xceb127

  #启用自由核算项8
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad024 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad024 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb128 = ' '"
   PREPARE axct701_4_upd_xceb128 FROM g_sql
   EXECUTE axct701_4_upd_xceb128

  #启用自由核算项9
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad025 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad025 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb129 = ' '"
   PREPARE axct701_4_upd_xceb129 FROM g_sql
   EXECUTE axct701_4_upd_xceb129

  #启用自由核算项10
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad026 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad026 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb130 = ' '"
   PREPARE axct701_4_upd_xceb130 FROM g_sql
   EXECUTE axct701_4_upd_xceb130
   
  #特性
   UPDATE sourse_ins_tmp SET xceb005 = ' ' WHERE xceb005 IS NULL
 #科目编号
   UPDATE sourse_ins_tmp SET xceb101 = ' ' WHERE xceb101 IS NULL
  #摘要
   UPDATE sourse_ins_tmp SET xceb102 = ' ' WHERE xceb102 IS NULL
  #成本域
   UPDATE sourse_ins_tmp SET xceb103 = ' ' WHERE xceb103 IS NULL
  #原因码
   UPDATE sourse_ins_tmp SET xceb110 = ' ' WHERE xceb110 IS NULL
  #交易对象
   UPDATE sourse_ins_tmp SET xceb111 = ' ' WHERE xceb111 IS NULL
  #客群
   UPDATE sourse_ins_tmp SET xceb112 = ' ' WHERE xceb112 IS NULL
  #区域
   UPDATE sourse_ins_tmp SET xceb113 = ' ' WHERE xceb113 IS NULL
  #成本中心
   UPDATE sourse_ins_tmp SET xceb114 = ' ' WHERE xceb114 IS NULL
  #经营类别
   UPDATE sourse_ins_tmp SET xceb115 = ' ' WHERE xceb115 IS NULL
  #渠道
   UPDATE sourse_ins_tmp SET xceb116 = ' ' WHERE xceb116 IS NULL
  #品类
   UPDATE sourse_ins_tmp SET xceb117 = ' ' WHERE xceb117 IS NULL
  #品牌
   UPDATE sourse_ins_tmp SET xceb118 = ' ' WHERE xceb118 IS NULL
  #项目号
   UPDATE sourse_ins_tmp SET xceb119 = ' ' WHERE xceb119 IS NULL
  #WBS
   UPDATE sourse_ins_tmp SET xceb120 = ' ' WHERE xceb120 IS NULL
  #人员
   UPDATE sourse_ins_tmp SET xceb107 = ' ' WHERE xceb107 IS NULL
   #部门
   UPDATE sourse_ins_tmp SET xceb108 = ' ' WHERE xceb108 IS NULL
  #账款对象
   UPDATE sourse_ins_tmp SET xceb109 = ' ' WHERE xceb109 IS NULL
  #自由核算项1
   UPDATE sourse_ins_tmp SET xceb121 = ' ' WHERE xceb121 IS NULL
  #自由核算项2
   UPDATE sourse_ins_tmp SET xceb122 = ' ' WHERE xceb122 IS NULL
  #自由核算项3
   UPDATE sourse_ins_tmp SET xceb123 = ' ' WHERE xceb123 IS NULL
  #自由核算项4
   UPDATE sourse_ins_tmp SET xceb124 = ' ' WHERE xceb124 IS NULL
  #自由核算项5
   UPDATE sourse_ins_tmp SET xceb125 = ' ' WHERE xceb125 IS NULL
  #自由核算项6
   UPDATE sourse_ins_tmp SET xceb126 = ' ' WHERE xceb126 IS NULL
   #自由核算项7
   UPDATE sourse_ins_tmp SET xceb127 = ' ' WHERE xceb127 IS NULL
  #自由核算项8
   UPDATE sourse_ins_tmp SET xceb128 = ' ' WHERE xceb128 IS NULL
  #自由核算项9
   UPDATE sourse_ins_tmp SET xceb129 = ' ' WHERE xceb129 IS NULL
  #自由核算项10
   UPDATE sourse_ins_tmp SET xceb130 = ' ' WHERE xceb130 IS NULL
   
   INSERT INTO xceb_t (xcebent,xcebcomp,xcebld,xcebdocno,xcebseq,
                       xceb001,xceb002,xceb003,xceb004,xceb005,xceb101,xceb102,xceb103,xceb110,xceb111,
                       xceb112,xceb113,xceb114,xceb115,xceb116,xceb117,xceb118,xceb119,xceb120,xceb201,
                       xceb202,xceb202a,xceb202b,xceb202c,xceb202d,xceb202e,xceb202f,xceb202g,xceb202h,
                       xceb212,xceb212a,xceb212b,xceb212c,xceb212d,xceb212e,xceb212f,xceb212g,xceb212h,
                       xceb222,xceb222a,xceb222b,xceb222c,xceb222d,xceb222e,xceb222f,xceb222g,xceb222h,
                       xceb301,xceb302,xceb107,xceb108,xceb109,xceb121,xceb122,xceb123,xceb124,xceb125,
                       xceb126,xceb127,xceb128,xceb129,xceb130,xceb131,xceb132)
         SELECT xcebent,xcebcomp,xcebld,xcebdocno,xcebseq,
                xceb001,xceb002,xceb003,xceb004,xceb005,xceb101,xceb102,xceb103,xceb110,xceb111,
                xceb112,xceb113,xceb114,xceb115,xceb116,xceb117,xceb118,xceb119,xceb120,xceb201,
                xceb202,xceb202a,xceb202b,xceb202c,xceb202d,xceb202e,xceb202f,xceb202g,xceb202h,
                xceb212,xceb212a,xceb212b,xceb212c,xceb212d,xceb212e,xceb212f,xceb212g,xceb212h,
                xceb222,xceb222a,xceb222b,xceb222c,xceb222d,xceb222e,xceb222f,xceb222g,xceb222h,
                xceb301,xceb302,xceb107,xceb108,xceb109,xceb121,xceb122,xceb123,xceb124,xceb125,
                xceb126,xceb127,xceb128,xceb129,xceb130,xceb131,xceb132
           FROM sourse_ins_tmp


   UPDATE sourse_ins_tmp 
     SET xceb101 = (SELECT glab005
                     FROM glab_t
                    WHERE glabld  = g_xcea_m.xceald
                      AND glab001 = '60'
                      AND glab002 = '8912'
                      AND glab003 = '6'
                      AND glabent = g_enterprise)
   WHERE xceb101 IS NULL OR xceb101 = ' '
    
   #启用交易对象
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad010 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad010 = 'N'  ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb111 = ' '"
   PREPARE axct701_4_upd_xcec111 FROM g_sql
   EXECUTE axct701_4_upd_xcec111

  #启用客群
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad011 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad011 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb112 = ' '"
   PREPARE axct701_4_upd_xcec112 FROM g_sql
   EXECUTE axct701_4_upd_xcec112

  #启用区域
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad009 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad009 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb113 = ' '"
   PREPARE axct701_4_upd_xcec113 FROM g_sql
   EXECUTE axct701_4_upd_xcec113

   
  #启用成本中心
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad008 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad008 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb114 = ' '"
   PREPARE axct701_4_upd_xcec114 FROM g_sql
   EXECUTE axct701_4_upd_xcec114
   
  #启用经营类别
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad031 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad031 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb115 = ' '"
   PREPARE axct701_4_upd_xcec115 FROM g_sql
   EXECUTE axct701_4_upd_xcec115
 
  #启用渠道
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad032 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad032 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb116 = ' '"
   PREPARE axct701_4_upd_xcec116 FROM g_sql
   EXECUTE axct701_4_upd_xcec116

  #启用品类
  #170221-00041#1 add start ----
   UPDATE sourse_ins_tmp
      SET xceb117 = (SELECT imag011 FROM imag_t
                      WHERE imagent = xcebent
                        AND imagsite = g_xcea_m.xceacomp
                        AND imag001 = xceb004)
  #170221-00041#1 add end   ---  
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad012 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad012 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb117 = ' '"
   PREPARE axct701_4_upd_xcec117 FROM g_sql
   EXECUTE axct701_4_upd_xcec117
   
  #启用品牌
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad033 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad033 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb118 = ' '"
   PREPARE axct701_4_upd_xcec118 FROM g_sql
   EXECUTE axct701_4_upd_xcec118
 
  #启用项目号
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad015 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad015 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb119 = ' '"
   PREPARE axct701_4_upd_xcec119 FROM g_sql
   EXECUTE axct701_4_upd_xcec119
 
  #启用WBS
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad016 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad016 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb120 = ' '"
   PREPARE axct701_4_upd_xcec120 FROM g_sql
   EXECUTE axct701_4_upd_xcec120
 
  #启用人员
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad013 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad013 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb107 = ' '"
   PREPARE axct701_4_upd_xcec107 FROM g_sql
   EXECUTE axct701_4_upd_xcec107
 
  #启用部门
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad007 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad007 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb108 = ' '"
   PREPARE axct701_4_upd_xcec108 FROM g_sql
   EXECUTE axct701_4_upd_xcec108
   
  #启用账款对象
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad027 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad027 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb109 = ' '"
   PREPARE axct701_4_upd_xcec109 FROM g_sql
   EXECUTE axct701_4_upd_xcec109
   
  #启用自由核算项1
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad017 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad017 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb121 = ' '"
   PREPARE axct701_4_upd_xcec121 FROM g_sql
   EXECUTE axct701_4_upd_xcec121
 
  #启用自由核算项2
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad018 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad018 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb122 = ' '"
   PREPARE axct701_4_upd_xcec122 FROM g_sql
   EXECUTE axct701_4_upd_xcec122
 
  #启用自由核算项3
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad019 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad019 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb123 = ' '"
   PREPARE axct701_4_upd_xcec123 FROM g_sql
   EXECUTE axct701_4_upd_xcec123

  #启用自由核算项4
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad019 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad019 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb124 = ' '"
   PREPARE axct701_4_upd_xcec124 FROM g_sql
   EXECUTE axct701_4_upd_xcec124

  #启用自由核算项5
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad021 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad021 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb125 = ' '"
   PREPARE axct701_4_upd_xcec125 FROM g_sql
   EXECUTE axct701_4_upd_xcec125

  #启用自由核算项6
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad022 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad022 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb126 = ' '"
   PREPARE axct701_4_upd_xcec126 FROM g_sql
   EXECUTE axct701_4_upd_xcec126

  #启用自由核算项7
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad023 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad023 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb127 = ' '"
   PREPARE axct701_4_upd_xcec127 FROM g_sql
   EXECUTE axct701_4_upd_xcec127

  #启用自由核算项8
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad024 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad024 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb128 = ' '"
   PREPARE axct701_4_upd_xcec128 FROM g_sql
   EXECUTE axct701_4_upd_xcec128

  #启用自由核算项9
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad025 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad025 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb129 = ' '"
   PREPARE axct701_4_upd_xcec129 FROM g_sql
   EXECUTE axct701_4_upd_xcec129

  #启用自由核算项10
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad026 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad026 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb130 = ' '"
   PREPARE axct701_4_upd_xcec130 FROM g_sql
   EXECUTE axct701_4_upd_xcec130
   
  #特性
   UPDATE sourse_ins_tmp SET xceb005 = ' ' WHERE xceb005 IS NULL
 #科目编号
   UPDATE sourse_ins_tmp SET xceb101 = ' ' WHERE xceb101 IS NULL
  #摘要
   UPDATE sourse_ins_tmp SET xceb102 = ' ' WHERE xceb102 IS NULL
  #成本域
   UPDATE sourse_ins_tmp SET xceb103 = ' ' WHERE xceb103 IS NULL
  #原因码
   UPDATE sourse_ins_tmp SET xceb110 = ' ' WHERE xceb110 IS NULL
  #交易对象
   UPDATE sourse_ins_tmp SET xceb111 = ' ' WHERE xceb111 IS NULL
  #客群
   UPDATE sourse_ins_tmp SET xceb112 = ' ' WHERE xceb112 IS NULL
  #区域
   UPDATE sourse_ins_tmp SET xceb113 = ' ' WHERE xceb113 IS NULL
  #成本中心
   UPDATE sourse_ins_tmp SET xceb114 = ' ' WHERE xceb114 IS NULL
  #经营类别
   UPDATE sourse_ins_tmp SET xceb115 = ' ' WHERE xceb115 IS NULL
  #渠道
   UPDATE sourse_ins_tmp SET xceb116 = ' ' WHERE xceb116 IS NULL
  #品类
   UPDATE sourse_ins_tmp SET xceb117 = ' ' WHERE xceb117 IS NULL
  #品牌
   UPDATE sourse_ins_tmp SET xceb118 = ' ' WHERE xceb118 IS NULL
  #项目号
   UPDATE sourse_ins_tmp SET xceb119 = ' ' WHERE xceb119 IS NULL
  #WBS
   UPDATE sourse_ins_tmp SET xceb120 = ' ' WHERE xceb120 IS NULL
  #人员
   UPDATE sourse_ins_tmp SET xceb107 = ' ' WHERE xceb107 IS NULL
   #部门
   UPDATE sourse_ins_tmp SET xceb108 = ' ' WHERE xceb108 IS NULL
  #账款对象
   UPDATE sourse_ins_tmp SET xceb109 = ' ' WHERE xceb109 IS NULL
  #自由核算项1
   UPDATE sourse_ins_tmp SET xceb121 = ' ' WHERE xceb121 IS NULL
  #自由核算项2
   UPDATE sourse_ins_tmp SET xceb122 = ' ' WHERE xceb122 IS NULL
  #自由核算项3
   UPDATE sourse_ins_tmp SET xceb123 = ' ' WHERE xceb123 IS NULL
  #自由核算项4
   UPDATE sourse_ins_tmp SET xceb124 = ' ' WHERE xceb124 IS NULL
  #自由核算项5
   UPDATE sourse_ins_tmp SET xceb125 = ' ' WHERE xceb125 IS NULL
  #自由核算项6
   UPDATE sourse_ins_tmp SET xceb126 = ' ' WHERE xceb126 IS NULL
   #自由核算项7
   UPDATE sourse_ins_tmp SET xceb127 = ' ' WHERE xceb127 IS NULL
  #自由核算项8
   UPDATE sourse_ins_tmp SET xceb128 = ' ' WHERE xceb128 IS NULL
  #自由核算项9
   UPDATE sourse_ins_tmp SET xceb129 = ' ' WHERE xceb129 IS NULL
  #自由核算项10
   UPDATE sourse_ins_tmp SET xceb130 = ' ' WHERE xceb130 IS NULL
   
   INSERT INTO xcec_t (xcecent,xceccomp,xcecld,xcecdocno,xcecseq,
                       xcec001,xcec002,xcec003,xcec004,xcec005,xcec101,xcec102,xcec103,xcec110,xcec111,
                       xcec112,xcec113,xcec114,xcec115,xcec116,xcec117,xcec118,xcec119,xcec120,xcec201,
                       xcec202,xcec202a,xcec202b,xcec202c,xcec202d,xcec202e,xcec202f,xcec202g,xcec202h,
                       xcec212,xcec212a,xcec212b,xcec212c,xcec212d,xcec212e,xcec212f,xcec212g,xcec212h,
                       xcec222,xcec222a,xcec222b,xcec222c,xcec222d,xcec222e,xcec222f,xcec222g,xcec222h,
                       xcec301,xcec302,xcec107,xcec108,xcec109,xcec121,xcec122,xcec123,xcec124,xcec125,
                       xcec126,xcec127,xcec128,xcec129,xcec130)
         SELECT xcebent,xcebcomp,xcebld,xcebdocno,xcebseq,
                xceb001,xceb002,xceb003,xceb004,xceb005,xceb101,xceb102,xceb103,xceb110,xceb111,
                xceb112,xceb113,xceb114,xceb115,xceb116,xceb117,xceb118,xceb119,xceb120,xceb201,
                xceb202,xceb202a,xceb202b,xceb202c,xceb202d,xceb202e,xceb202f,xceb202g,xceb202h,
                xceb212,xceb212a,xceb212b,xceb212c,xceb212d,xceb212e,xceb212f,xceb212g,xceb212h,
                xceb222,xceb222a,xceb222b,xceb222c,xceb222d,xceb222e,xceb222f,xceb222g,xceb222h,
                xceb301,xceb302,xceb107,xceb108,xceb109,xceb121,xceb122,xceb123,xceb124,xceb125,
                xceb126,xceb127,xceb128,xceb129,xceb130
           FROM sourse_ins_tmp 

   DELETE FROM sourse_ins_tmp; 
   DELETE FROM sourse_ins_tmp1; 
   RETURN g_success   
END FUNCTION

################################################################################
# Descriptions...: 在制差異憑證資料產生  axct705
# Date & Author..: 2017/02/03 By 02295
# Modify.........: #170105-00011#8
################################################################################
PRIVATE FUNCTION axct701_01_ins_5()
DEFINE l_xcea          RECORD  #工單發料成本憑證單頭檔
       xceaent LIKE xcea_t.xceaent, #企業編號
       xceacomp LIKE xcea_t.xceacomp, #法人組織
       xceald LIKE xcea_t.xceald, #帳套
       xceadocno LIKE xcea_t.xceadocno, #單據編號
       xcea001 LIKE xcea_t.xcea001, #單據日期
       xcea002 LIKE xcea_t.xcea002, #成本憑證類型
       xcea003 LIKE xcea_t.xcea003, #成本計算類型
       xcea004 LIKE xcea_t.xcea004, #年度
       xcea005 LIKE xcea_t.xcea005, #期別
       xcea006 LIKE xcea_t.xcea006, #帳務人員
       xcea007 LIKE xcea_t.xcea007, #帳務部門
       xcea101 LIKE xcea_t.xcea101, #憑證編號
       xcea102 LIKE xcea_t.xcea102, #憑證日期
       xceaownid LIKE xcea_t.xceaownid, #資料所有者
       xceaowndp LIKE xcea_t.xceaowndp, #資料所屬部門
       xceacrtid LIKE xcea_t.xceacrtid, #資料建立者
       xceacrtdp LIKE xcea_t.xceacrtdp, #資料建立部門
       xceacrtdt LIKE xcea_t.xceacrtdt, #資料創建日
       xceamodid LIKE xcea_t.xceamodid, #資料修改者
       xceamoddt LIKE xcea_t.xceamoddt, #最近修改日
       xceacnfid LIKE xcea_t.xceacnfid, #資料確認者
       xceacnfdt LIKE xcea_t.xceacnfdt, #資料確認日
       xceapstid LIKE xcea_t.xceapstid, #資料過帳者
       xceapstdt LIKE xcea_t.xceapstdt, #資料過帳日
       xceastus LIKE xcea_t.xceastus, #狀態碼
       xceaud001 LIKE xcea_t.xceaud001, #自定義欄位(文字)001
       xceaud002 LIKE xcea_t.xceaud002, #自定義欄位(文字)002
       xceaud003 LIKE xcea_t.xceaud003, #自定義欄位(文字)003
       xceaud004 LIKE xcea_t.xceaud004, #自定義欄位(文字)004
       xceaud005 LIKE xcea_t.xceaud005, #自定義欄位(文字)005
       xceaud006 LIKE xcea_t.xceaud006, #自定義欄位(文字)006
       xceaud007 LIKE xcea_t.xceaud007, #自定義欄位(文字)007
       xceaud008 LIKE xcea_t.xceaud008, #自定義欄位(文字)008
       xceaud009 LIKE xcea_t.xceaud009, #自定義欄位(文字)009
       xceaud010 LIKE xcea_t.xceaud010, #自定義欄位(文字)010
       xceaud011 LIKE xcea_t.xceaud011, #自定義欄位(數字)011
       xceaud012 LIKE xcea_t.xceaud012, #自定義欄位(數字)012
       xceaud013 LIKE xcea_t.xceaud013, #自定義欄位(數字)013
       xceaud014 LIKE xcea_t.xceaud014, #自定義欄位(數字)014
       xceaud015 LIKE xcea_t.xceaud015, #自定義欄位(數字)015
       xceaud016 LIKE xcea_t.xceaud016, #自定義欄位(數字)016
       xceaud017 LIKE xcea_t.xceaud017, #自定義欄位(數字)017
       xceaud018 LIKE xcea_t.xceaud018, #自定義欄位(數字)018
       xceaud019 LIKE xcea_t.xceaud019, #自定義欄位(數字)019
       xceaud020 LIKE xcea_t.xceaud020, #自定義欄位(數字)020
       xceaud021 LIKE xcea_t.xceaud021, #自定義欄位(日期時間)021
       xceaud022 LIKE xcea_t.xceaud022, #自定義欄位(日期時間)022
       xceaud023 LIKE xcea_t.xceaud023, #自定義欄位(日期時間)023
       xceaud024 LIKE xcea_t.xceaud024, #自定義欄位(日期時間)024
       xceaud025 LIKE xcea_t.xceaud025, #自定義欄位(日期時間)025
       xceaud026 LIKE xcea_t.xceaud026, #自定義欄位(日期時間)026
       xceaud027 LIKE xcea_t.xceaud027, #自定義欄位(日期時間)027
       xceaud028 LIKE xcea_t.xceaud028, #自定義欄位(日期時間)028
       xceaud029 LIKE xcea_t.xceaud029, #自定義欄位(日期時間)029
       xceaud030 LIKE xcea_t.xceaud030, #自定義欄位(日期時間)030
       xceasite LIKE xcea_t.xceasite  #營運據點
          END RECORD
DEFINE ld_date         DATETIME YEAR TO SECOND
DEFINE l_success       LIKE type_t.num5


  #CALL axct701_01_create_tmp()    #170324-00054#1 mark
   LET g_success ='Y'
   
   #單頭
   LET l_xcea.xceaownid = g_user
   LET l_xcea.xceaowndp = g_dept
   LET l_xcea.xceacrtid = g_user
   LET l_xcea.xceacrtdp = g_dept 
   LET ld_date = cl_get_current()
   LET l_xcea.xceamodid = ""
   LET l_xcea.xceamoddt = ""
   CALL s_aooi200_fin_gen_docno(g_xcea_m.xceald,'','',g_xcea_m.xceadocno,g_xcea_m.xcea001,g_prog_name1)      #wujie 150214
    RETURNING l_success,g_xcea_m.xceadocno
   IF l_success  = 0  THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = 'apm-00003'
      LET g_errparam.extend = g_xcea_m.xceadocno
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET g_success = 'N'
      RETURN g_success
   END IF
   
   INSERT INTO xcea_t (xceaent,xceald,xceacomp,xcea006,xceadocno,xcea001,xcea002,xcea004, 
       xcea005,xcea003,xceastus,xceaownid,xceaowndp,xceacrtid,xceacrtdp,xceacrtdt, 
       xceamodid,xceamoddt)
   VALUES (g_enterprise,g_xcea_m.xceald,g_xcea_m.xceacomp,g_xcea_m.xcea006,g_xcea_m.xceadocno, 
       g_xcea_m.xcea001,g_xcea002,g_xcea_m.xcea004,g_xcea_m.xcea005,g_xcea_m.xcea003, 
       'N',l_xcea.xceaownid,l_xcea.xceaowndp,l_xcea.xceacrtid, 
       l_xcea.xceacrtdp,ld_date,l_xcea.xceamodid,l_xcea.xceamoddt) 
       
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "g_xcea_m"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET g_success = 'N'
      RETURN g_success
   END IF
   
   #第一單身：在制主件成本档(xccd_t),拆件在制主件成本档(xcch_t)
   DELETE FROM sourse_ins_tmp;
   LET g_sql = " INSERT INTO sourse_ins_tmp ",
               "  (xcebent,xcebcomp,xcebld,xcebdocno,xcebseq,",
               "   xceb001,xceb002,xceb003,xceb004,xceb005,",
               "   xceb101,xceb102,xceb103,xceb110,xceb111,",
               "   xceb112,xceb113,xceb114,xceb115,xceb116,",
               "   xceb117,xceb118,xceb119,xceb120,xceb201,",
               "   xceb202,xceb202a,xceb202b,xceb202c,xceb202d,xceb202e,xceb202f,xceb202g,xceb202h,",
               "   xceb212,xceb212a,xceb212b,xceb212c,xceb212d,xceb212e,xceb212f,xceb212g,xceb212h,",
               "   xceb222,xceb222a,xceb222b,xceb222c,xceb222d,xceb222e,xceb222f,xceb222g,xceb222h,",
               "   xceb301,xceb302,xceb107,xceb108,xceb109,",
               "   xceb121,xceb122,xceb123,xceb124,xceb125,",
               "   xceb126,xceb127,xceb128,xceb129,xceb130,",
               "   xceb131,xceb132,sfaa009,sfaasite,sfaa028,",
               "   sfaa029,sfaa052,sfaa057) ",  
               " SELECT ",g_enterprise,",'",g_xcea_m.xceacomp,"','",g_xcea_m.xceald,"','",g_xcea_m.xceadocno,"',rownum,",
               "        xccd006,'','',xccd007,xccd008,",
               "        '',(SELECT glab010 FROM glab_t WHERE glabld  = '",g_xcea_m.xceald,"' AND glab001 = '61' AND glab002 = '8925' AND glab003 = '5' AND glabent = ",g_enterprise,") xceb102,xccd002,'','', ",
               "        '','','',' ',' ',",
               "        '',' ','','',xccd303,",
               "        xccd304,xccd304a,xccd304b,xccd304c,xccd304d,xccd304e,xccd304f,xccd304g,xccd304h,",
               "        0,0,0,0,0,0,0,0,0,",
               "        0,0,0,0,0,0,0,0,0,",
               "        '','','','','', ",             
               "        '','','','','', ",             
               "        '','','','','', ",             
               "        '','','','','', ",             
               "        '','','' ",     
               "   FROM (",
               "         SELECT xccd002 xccd002,xccd006 xccd006,xccd007 xccd007,xccd008 xccd008,",
               "                SUM(xccd303*-1) xccd303, SUM(xccd304*-1) xccd304, SUM(xccd304a*-1) xccd304a,SUM(xccd304b*-1) xccd304b,SUM(xccd304c*-1) xccd304c,",
               "                SUM(xccd304d*-1) xccd304d,SUM(xccd304e*-1) xccd304e,SUM(xccd304f*-1) xccd304f,SUM(xccd304g*-1) xccd304g,SUM(xccd304h*-1) xccd304h ",
               "           FROM xccd_t ",
               "          WHERE xccdent = '",g_enterprise,"' AND xccdld = '",g_xcea_m.xceald,"'",
               "            AND xccd003 = '",g_xcea_m.xcea003,"' AND xccd004 = ",g_xcea_m.xcea004,
               "            AND xccd005 = ",g_xcea_m.xcea005,
               "            AND xccd001 = '1'",
               #"            AND (xccd303 <> 0 OR xccd304 <> 0)", #170306-00063#1 mark
               "            AND xccd304 <> 0 ",  #170306-00063#1 add
               "          GROUP BY xccd002,xccd006,xccd007,xccd008 ",
               "          UNION ",
               "         SELECT xcch002 xccd002,xcch006 xccd006,xcch007 xccd007,xcch008 xccd008,",
               "                SUM(xcch303*-1) xccd303, SUM(xcch304*-1) xccd304, SUM(xcch304a*-1) xccd304a,SUM(xcch304b*-1) xccd304b,SUM(xcch304c*-1) xccd304c,",
               "                SUM(xcch304d*-1) xccd304d,SUM(xcch304e*-1) xccd304e,SUM(xcch304f*-1) xccd304f,SUM(xcch304g*-1) xccd304g,SUM(xcch304h*-1) xccd304h ",
               "           FROM xcch_t ",
               "          WHERE xcchent = '",g_enterprise,"' AND xcchld = '",g_xcea_m.xceald,"'",
               "            AND xcch003 = '",g_xcea_m.xcea003,"' AND xcch004 = ",g_xcea_m.xcea004,
               "            AND xcch005 = ",g_xcea_m.xcea005,
               "            AND xcch001 = '1'",
               #170306-00063#1 mark start ------
               #"            AND (xcch303 <> 0 OR xcch304 <> 0)",
               #"          GROUP BY xccd002,xccd006,xccd007,xccd008)"
               #170306-00063#1 mark end   ------
               #170306-00063#1 add start -----
               "            AND xcch304 <> 0 ",
               "          GROUP BY xcch002,xcch006,xcch007,xcch008)" 
               #170306-00063#1 add end   -----             
   PREPARE axct701_5_ins_xceb_01 FROM g_sql
   EXECUTE axct701_5_ins_xceb_01  
  
   #更新本位币二金额
   LET g_sql = " MERGE INTO sourse_ins_tmp  ",
               " USING (SELECT xccd002 xccd002,xccd006 xccd006,xccd007 xccd007,xccd008 xccd008,",
               "               SUM(xccd304*-1) xccd304, SUM(xccd304a*-1) xccd304a,SUM(xccd304b*-1) xccd304b,SUM(xccd304c*-1) xccd304c,",
               "               SUM(xccd304d*-1) xccd304d,SUM(xccd304e*-1) xccd304e,SUM(xccd304f*-1) xccd304f,SUM(xccd304g*-1) xccd304g,SUM(xccd304h*-1) xccd304h ",
               "               FROM xccd_t ", 
               "         WHERE xccdent = '",g_enterprise,"' AND xccdld = '",g_xcea_m.xceald,"'",
               "           AND xccd003 = '",g_xcea_m.xcea003,"' AND xccd004 = ",g_xcea_m.xcea004,
               "           AND xccd005 = ",g_xcea_m.xcea005,
               #"           AND (xccd303 <> 0 OR xccd304 <> 0)", #170306-00063#1 mark
               "           AND xccd304 <> 0",  #170306-00063#1 add
               "           AND xccd001 = '2' ",
               "         GROUP BY xccd002,xccd006,xccd007,xccd008 ",
               "         UNION ",
               "        SELECT xcch002 xccd002,xcch006 xccd006,xcch007 xccd007,xcch008 xccd008,",
               "               SUM(xcch304*-1) xccd304, SUM(xcch304a*-1) xccd304a,SUM(xcch304b*-1) xccd304b,SUM(xcch304c*-1) xccd304c,",
               "               SUM(xcch304d*-1) xccd304d,SUM(xcch304e*-1) xccd304e,SUM(xcch304f*-1) xccd304f,SUM(xcch304g*-1) xccd304g,SUM(xcch304h*-1) xccd304h ",
               "          FROM xcch_t ",
               "         WHERE xcchent = '",g_enterprise,"' AND xcchld = '",g_xcea_m.xceald,"'",
               "           AND xcch003 = '",g_xcea_m.xcea003,"' AND xcch004 = ",g_xcea_m.xcea004,
               "           AND xcch005 = ",g_xcea_m.xcea005,
               #"           AND (xcch303 <> 0 OR xcch304 <> 0)", #170306-00063#1 mark
               "           AND xcch304 <> 0",  #170306-00063#1 add
               "           AND xcch001 = '2'",               
               #"         GROUP BY xccd002,xccd006,xccd007,xccd008 )", #170306-00063#1 mark
               "         GROUP BY xcch002,xcch006,xcch007,xcch008 )",  #170306-00063#1 add
               "    ON (xceb001 = xccd006 ",
               "    AND xceb103 = xccd002", 
               "    AND xceb004 = xccd007", 
               "    AND xceb005 = xccd008)",                 
               "   WHEN MATCHED THEN ",
               " UPDATE SET xceb212  = xccd304 ,",
               "            xceb212a = xccd304a,",
               "            xceb212b = xccd304b,",
               "            xceb212c = xccd304c,",
               "            xceb212d = xccd304d,",
               "            xceb212e = xccd304e,",
               "            xceb212f = xccd304f,",
               "            xceb212g = xccd304g,",
               "            xceb212h = xccd304h "
   PREPARE axct701_5_upd_xceb212 FROM g_sql
   EXECUTE axct701_5_upd_xceb212  

   #更新本位币三金额
   LET g_sql = " MERGE INTO sourse_ins_tmp  ",
               " USING (SELECT xccd002 xccd002,xccd006 xccd006,xccd007 xccd007,xccd008 xccd008,",
               "               SUM(xccd304*-1) xccd304, SUM(xccd304a*-1) xccd304a,SUM(xccd304b*-1) xccd304b,SUM(xccd304c*-1) xccd304c,",
               "               SUM(xccd304d*-1) xccd304d,SUM(xccd304e*-1) xccd304e,SUM(xccd304f*-1) xccd304f,SUM(xccd304g*-1) xccd304g,SUM(xccd304h*-1) xccd304h ",
               "               FROM xccd_t ", 
               "         WHERE xccdent = '",g_enterprise,"' AND xccdld = '",g_xcea_m.xceald,"'",
               "           AND xccd003 = '",g_xcea_m.xcea003,"' AND xccd004 = ",g_xcea_m.xcea004,
               "           AND xccd005 = ",g_xcea_m.xcea005,
               #"           AND (xccd303 <> 0 OR xccd304 <> 0)", #170306-00063#1 mark
               "           AND xccd304 <> 0 ",                   #170306-00063#1 add
               "           AND xccd001 = '3' ",
               "         GROUP BY xccd002,xccd006,xccd007,xccd008 ",
               "         UNION ",
               "        SELECT xcch002 xccd002,xcch006 xccd006,xcch007 xccd007,xcch008 xccd008,",
               "               SUM(xcch304*-1) xccd304, SUM(xcch304a*-1) xccd304a,SUM(xcch304b*-1) xccd304b,SUM(xcch304c*-1) xccd304c,",
               "               SUM(xcch304d*-1) xccd304d,SUM(xcch304e*-1) xccd304e,SUM(xcch304f*-1) xccd304f,SUM(xcch304g*-1) xccd304g,SUM(xcch304h*-1) xccd304h ",
               "          FROM xcch_t ",
               "         WHERE xcchent = '",g_enterprise,"' AND xcchld = '",g_xcea_m.xceald,"'",
               "           AND xcch003 = '",g_xcea_m.xcea003,"' AND xcch004 = ",g_xcea_m.xcea004,
               "           AND xcch005 = ",g_xcea_m.xcea005,
               #"           AND (xcch303 <> 0 OR xcch304 <> 0)", #170306-00063#1 mark
               "           AND xcch304 <> 0 ",                   #170306-00063#1 add
               "           AND xcch001 = '3'",               
               "         GROUP BY xccd002,xccd006,xccd007,xccd008 )",
               "    ON (xceb001 = xccd006 ", 
               "    AND xceb103 = xccd002", 
               "    AND xceb004 = xccd007", 
               "    AND xceb005 = xccd008)",                 
               "   WHEN MATCHED THEN ",
               " UPDATE SET xceb212  = xccd304 ,",
               "            xceb212a = xccd304a,",
               "            xceb212b = xccd304b,",
               "            xceb212c = xccd304c,",
               "            xceb212d = xccd304d,",
               "            xceb212e = xccd304e,",
               "            xceb212f = xccd304f,",
               "            xceb212g = xccd304g,",
               "            xceb212h = xccd304h "
   PREPARE axct701_5_upd_xceb222 FROM g_sql
   EXECUTE axct701_5_upd_xceb222

   LET g_sql = " MERGE INTO sourse_ins_tmp a ",
               #170306-00063#1 mark start -----
               #" USING (SELECT sfaadocno,sfaa003,sfaa057,sfaa009,sfaasite,sfaa028,sfaa029,sfaa068 ",
               #"          FROM sfaa_t,sourse_ins_tmp ",
               #170306-00063#1 mark start -----
               #170306-00063#1 add start -----
               " USING (SELECT c.sfaadocno,c.sfaa003,c.sfaa057,c.sfaa009,c.sfaasite,c.sfaa028,c.sfaa029,c.sfaa068 ",
               "          FROM sfaa_t c,sourse_ins_tmp d",
               #170306-00063#1 add end   -----
               "         WHERE sfaaent = xcebent AND sfaadocno = xceb001) b",
               "    ON (a.xceb001 = b.sfaadocno)",                 
               "   WHEN MATCHED THEN ",
               " UPDATE SET a.xceb003  = b.sfaa003 ,",
               "            a.sfaa057  = b.sfaa057,",   
               "            a.xceb111  = b.sfaa009,",   
               "            a.sfaasite = b.sfaasite,",   
               "            a.xceb119  = b.sfaa028,",   
               "            a.xceb120  = b.sfaa029,",   
               "            a.xceb108  = b.sfaa068 "
   PREPARE axct701_5_upd_xceb FROM g_sql
   EXECUTE axct701_5_upd_xceb

   UPDATE sourse_ins_tmp 
      SET xceb101 = (SELECT glab005
                      FROM glab_t
                     WHERE glabld  = g_xcea_m.xceald
                       AND glab001 = '60'
                       AND glab002 = '8912'
                       AND glab003 = '4'
                       AND glabent = g_enterprise)
    WHERE xceb101 IS NULL OR xceb101 = ' '

   UPDATE sourse_ins_tmp
     SET xceb112 = (SELECT pmaa090 FROM pmaa_t WHERE pmaaent = g_enterprise AND pmaa001 = xcec111),
         xceb113 = (SELECT pmaa241 FROM pmaa_t WHERE pmaaent = g_enterprise AND pmaa001 = xcec111)
   WHERE sfaa057 = '2'  
   
   UPDATE sourse_ins_tmp 
     SET xceb113 =(SELECT ooef153 FROM ooef_t WHERE ooefent = g_enterprise AND ooef001 = sfaasite),
         xceb111 = ' ',
         xceb112 = ' '
   WHERE sfaa057 <> '2'  

   UPDATE sourse_ins_tmp
     SET xceb117 = (SELECT imag011
                      FROM imag_t 
                     WHERE imagent = g_enterprise 
                       AND imagsite = g_xcea_m.xceacomp
                       AND imag001 = xceb004)
 
   #启用交易对象
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad010 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad010 = 'N'  ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb111 = ' '"
   PREPARE axct701_5_upd_xceb111 FROM g_sql
   EXECUTE axct701_5_upd_xceb111

  #启用客群
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad011 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad011 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb112 = ' '"
   PREPARE axct701_5_upd_xceb112 FROM g_sql
   EXECUTE axct701_5_upd_xceb112

  #启用区域
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad009 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad009 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb113 = ' '"
   PREPARE axct701_5_upd_xceb113 FROM g_sql
   EXECUTE axct701_5_upd_xceb113

   
  #启用成本中心
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad008 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad008 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb114 = ' '"
   PREPARE axct701_5_upd_xceb114 FROM g_sql
   EXECUTE axct701_5_upd_xceb114
   
  #启用经营类别
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad031 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad031 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb115 = ' '"
   PREPARE axct701_5_upd_xceb115 FROM g_sql
   EXECUTE axct701_5_upd_xceb115
 
  #启用渠道
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad032 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad032 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb116 = ' '"
   PREPARE axct701_5_upd_xceb116 FROM g_sql
   EXECUTE axct701_5_upd_xceb116

  #启用品类
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad012 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad012 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb117 = ' '"
   PREPARE axct701_5_upd_xceb117 FROM g_sql
   EXECUTE axct701_5_upd_xceb117
   
  #启用品牌
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad033 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad033 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb118 = ' '"
   PREPARE axct701_5_upd_xceb118 FROM g_sql
   EXECUTE axct701_5_upd_xceb118
 
  #启用项目号
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad015 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad015 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb119 = ' '"
   PREPARE axct701_5_upd_xceb119 FROM g_sql
   EXECUTE axct701_5_upd_xceb119
 
  #启用WBS
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad016 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad016 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb120 = ' '"
   PREPARE axct701_5_upd_xceb120 FROM g_sql
   EXECUTE axct701_5_upd_xceb120
 
  #启用人员
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad013 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad013 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb107 = ' '"
   PREPARE axct701_5_upd_xceb107 FROM g_sql
   EXECUTE axct701_5_upd_xceb107
 
  #启用部门
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad007 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad007 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb108 = ' '"
   PREPARE axct701_5_upd_xceb108 FROM g_sql
   EXECUTE axct701_5_upd_xceb108
   
  #启用账款对象
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad027 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad027 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb109 = ' '"
   PREPARE axct701_5_upd_xceb109 FROM g_sql
   EXECUTE axct701_5_upd_xceb109
   
  #启用自由核算项1
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad017 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad017 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb121 = ' '"
   PREPARE axct701_5_upd_xceb121 FROM g_sql
   EXECUTE axct701_5_upd_xceb121
 
  #启用自由核算项2
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad018 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad018 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb122 = ' '"
   PREPARE axct701_5_upd_xceb122 FROM g_sql
   EXECUTE axct701_5_upd_xceb122
 
  #启用自由核算项3
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad019 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad019 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb123 = ' '"
   PREPARE axct701_5_upd_xceb123 FROM g_sql
   EXECUTE axct701_5_upd_xceb123

  #启用自由核算项4
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad019 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad019 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb124 = ' '"
   PREPARE axct701_5_upd_xceb124 FROM g_sql
   EXECUTE axct701_5_upd_xceb124

  #启用自由核算项5
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad021 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad021 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb125 = ' '"
   PREPARE axct701_5_upd_xceb125 FROM g_sql
   EXECUTE axct701_5_upd_xceb125

  #启用自由核算项6
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad022 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad022 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb126 = ' '"
   PREPARE axct701_5_upd_xceb126 FROM g_sql
   EXECUTE axct701_5_upd_xceb126

  #启用自由核算项7
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad023 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad023 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb127 = ' '"
   PREPARE axct701_5_upd_xceb127 FROM g_sql
   EXECUTE axct701_5_upd_xceb127

  #启用自由核算项8
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad024 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad024 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb128 = ' '"
   PREPARE axct701_5_upd_xceb128 FROM g_sql
   EXECUTE axct701_5_upd_xceb128

  #启用自由核算项9
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad025 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad025 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb129 = ' '"
   PREPARE axct701_5_upd_xceb129 FROM g_sql
   EXECUTE axct701_5_upd_xceb129

  #启用自由核算项10
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad026 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad026 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb130 = ' '"
   PREPARE axct701_5_upd_xceb130 FROM g_sql
   EXECUTE axct701_5_upd_xceb130
   
  #特性
   UPDATE sourse_ins_tmp SET xceb005 = ' ' WHERE xceb005 IS NULL
 #科目编号
   UPDATE sourse_ins_tmp SET xceb101 = ' ' WHERE xceb101 IS NULL
  #摘要
   UPDATE sourse_ins_tmp SET xceb102 = ' ' WHERE xceb102 IS NULL
  #成本域
   UPDATE sourse_ins_tmp SET xceb103 = ' ' WHERE xceb103 IS NULL
  #原因码
   UPDATE sourse_ins_tmp SET xceb110 = ' ' WHERE xceb110 IS NULL
  #交易对象
   UPDATE sourse_ins_tmp SET xceb111 = ' ' WHERE xceb111 IS NULL
  #客群
   UPDATE sourse_ins_tmp SET xceb112 = ' ' WHERE xceb112 IS NULL
  #区域
   UPDATE sourse_ins_tmp SET xceb113 = ' ' WHERE xceb113 IS NULL
  #成本中心
   UPDATE sourse_ins_tmp SET xceb114 = ' ' WHERE xceb114 IS NULL
  #经营类别
   UPDATE sourse_ins_tmp SET xceb115 = ' ' WHERE xceb115 IS NULL
  #渠道
   UPDATE sourse_ins_tmp SET xceb116 = ' ' WHERE xceb116 IS NULL
  #品类
   UPDATE sourse_ins_tmp SET xceb117 = ' ' WHERE xceb117 IS NULL
  #品牌
   UPDATE sourse_ins_tmp SET xceb118 = ' ' WHERE xceb118 IS NULL
  #项目号
   UPDATE sourse_ins_tmp SET xceb119 = ' ' WHERE xceb119 IS NULL
  #WBS
   UPDATE sourse_ins_tmp SET xceb120 = ' ' WHERE xceb120 IS NULL
  #人员
   UPDATE sourse_ins_tmp SET xceb107 = ' ' WHERE xceb107 IS NULL
   #部门
   UPDATE sourse_ins_tmp SET xceb108 = ' ' WHERE xceb108 IS NULL
  #账款对象
   UPDATE sourse_ins_tmp SET xceb109 = ' ' WHERE xceb109 IS NULL
  #自由核算项1
   UPDATE sourse_ins_tmp SET xceb121 = ' ' WHERE xceb121 IS NULL
  #自由核算项2
   UPDATE sourse_ins_tmp SET xceb122 = ' ' WHERE xceb122 IS NULL
  #自由核算项3
   UPDATE sourse_ins_tmp SET xceb123 = ' ' WHERE xceb123 IS NULL
  #自由核算项4
   UPDATE sourse_ins_tmp SET xceb124 = ' ' WHERE xceb124 IS NULL
  #自由核算项5
   UPDATE sourse_ins_tmp SET xceb125 = ' ' WHERE xceb125 IS NULL
  #自由核算项6
   UPDATE sourse_ins_tmp SET xceb126 = ' ' WHERE xceb126 IS NULL
   #自由核算项7
   UPDATE sourse_ins_tmp SET xceb127 = ' ' WHERE xceb127 IS NULL
  #自由核算项8
   UPDATE sourse_ins_tmp SET xceb128 = ' ' WHERE xceb128 IS NULL
  #自由核算项9
   UPDATE sourse_ins_tmp SET xceb129 = ' ' WHERE xceb129 IS NULL
  #自由核算项10
   UPDATE sourse_ins_tmp SET xceb130 = ' ' WHERE xceb130 IS NULL
   
   INSERT INTO xceb_t (xcebent,xcebcomp,xcebld,xcebdocno,xcebseq,
                       xceb001,xceb002,xceb003,xceb004,xceb005,xceb101,xceb102,xceb103,xceb110,xceb111,
                       xceb112,xceb113,xceb114,xceb115,xceb116,xceb117,xceb118,xceb119,xceb120,xceb201,
                       xceb202,xceb202a,xceb202b,xceb202c,xceb202d,xceb202e,xceb202f,xceb202g,xceb202h,
                       xceb212,xceb212a,xceb212b,xceb212c,xceb212d,xceb212e,xceb212f,xceb212g,xceb212h,
                       xceb222,xceb222a,xceb222b,xceb222c,xceb222d,xceb222e,xceb222f,xceb222g,xceb222h,
                       xceb301,xceb302,xceb107,xceb108,xceb109,xceb121,xceb122,xceb123,xceb124,xceb125,
                       xceb126,xceb127,xceb128,xceb129,xceb130,xceb131,xceb132)
         SELECT xcebent,xcebcomp,xcebld,xcebdocno,xcebseq,
                xceb001,xceb002,xceb003,xceb004,xceb005,xceb101,xceb102,xceb103,xceb110,xceb111,
                xceb112,xceb113,xceb114,xceb115,xceb116,xceb117,xceb118,xceb119,xceb120,xceb201,
                xceb202,xceb202a,xceb202b,xceb202c,xceb202d,xceb202e,xceb202f,xceb202g,xceb202h,
                xceb212,xceb212a,xceb212b,xceb212c,xceb212d,xceb212e,xceb212f,xceb212g,xceb212h,
                xceb222,xceb222a,xceb222b,xceb222c,xceb222d,xceb222e,xceb222f,xceb222g,xceb222h,
                xceb301,xceb302,xceb107,xceb108,xceb109,xceb121,xceb122,xceb123,xceb124,xceb125,
                xceb126,xceb127,xceb128,xceb129,xceb130,xceb131,xceb132
           FROM sourse_ins_tmp
   DELETE FROM sourse_ins_tmp;  
   
   
   ###INS xcec_t###
   DELETE FROM sourse_ins_tmp1;
   LET g_sql = " INSERT INTO sourse_ins_tmp1 ",
               "  (xcecent,xceccomp,xcecld,xcecdocno,xcecseq,",
               "   xcec001,xcec002,xcec003,xcec004,xcec005,",
               "   xcec101,xcec102,xcec103,xcec110,xcec111,",
               "   xcec112,xcec113,xcec114,xcec115,xcec116,",
               "   xcec117,xcec118,xcec119,xcec120,xcec201,",
               "   xcec202,xcec202a,xcec202b,xcec202c,xcec202d,xcec202e,xcec202f,xcec202g,xcec202h,",
               "   xcec212,xcec212a,xcec212b,xcec212c,xcec212d,xcec212e,xcec212f,xcec212g,xcec212h,",
               "   xcec222,xcec222a,xcec222b,xcec222c,xcec222d,xcec222e,xcec222f,xcec222g,xcec222h,",
               "   xcec301,xcec302,xcec107,xcec108,xcec109,",
               "   xcec121,xcec122,xcec123,xcec124,xcec125,",
               "   xcec126,xcec127,xcec128,xcec129,xcec130,",
               "   sfaa009,sfaasite,sfaa028,",
               "   sfaa029,sfaa052,sfaa057) ",  
               " SELECT ",g_enterprise,",'",g_xcea_m.xceacomp,"','",g_xcea_m.xceald,"','",g_xcea_m.xceadocno,"',rownum,",
               "        xcce006,'','',xcce007,xcce008,",
               "        '',(SELECT glab010 FROM glab_t WHERE glabld  = '",g_xcea_m.xceald,"' AND glab001 = '61' AND glab002 = '8925' AND glab003 = '6' AND glabent = ",g_enterprise,") xcec102,xcce002,'','', ",
               "        '','','',' ',' ',",
               "        '',' ','','',xcce303,",
               "        xcce304,xcce304a,xcce304b,xcce304c,xcce304d,xcce304e,xcce304f,xcce304g,xcce304h,",
               "        0,0,0,0,0,0,0,0,0,",
               "        0,0,0,0,0,0,0,0,0,",
               "        '','','','','', ",             
               "        '','','','','', ",             
               "        '','','','','', ",             
               "        '','','', ",             
               "        xcce009,'','' ",   
               "   FROM (",
               "        SELECT xcce002 xcce002,xcce006 xcce006,xcce007 xcce007,xcce008 xcce008,xcce009 xcce009,",
               "               SUM(xcce303*-1) xcce303, SUM(xcce304*-1) xcce304, SUM(xcce304a*-1) xcce304a,SUM(xcce304b*-1) xcce304b,SUM(xcce304c*-1) xcce304c,",
               "               SUM(xcce304d*-1) xcce304d,SUM(xcce304e*-1) xcce304e,SUM(xcce304f*-1) xcce304f,SUM(xcce304g*-1) xcce304g,SUM(xcce304h*-1) xcce304h ",
               "          FROM xcce_t ",
               "          WHERE xcceent = '",g_enterprise,"' AND xcceld = '",g_xcea_m.xceald,"'",
               "            AND xcce003 = '",g_xcea_m.xcea003,"' AND xcce004 = ",g_xcea_m.xcea004,
               "            AND xcce005 = ",g_xcea_m.xcea005,
               "            AND xcce001 = '1'",
               #"            AND (xcce303 <> 0 OR xcce304 <> 0)", #170306-00063#1 mark 
               "            AND xcce304 <> 0 ",                   #170306-00063#1 add
               "         GROUP BY xcce002,xcce006,xcce007,xcce008,xcce009 ",
               "         UNION ",
               "        SELECT xcci002 xcce002,xcci006 xcce006,xcci007 xcce007,xcci008 xcce008,xcci009 xcce009,",
               "               SUM(xcci303*-1) xcce303, SUM(xcci304*-1) xcce304, SUM(xcci304a*-1) xcce304a,SUM(xcci304b*-1) xcce304b,SUM(xcci304c*-1) xcce304c,",
               "               SUM(xcci304d*-1) xcce304d,SUM(xcci304e*-1) xcce304e,SUM(xcci304f*-1) xcce304f,SUM(xcci304g*-1) xcce304g,SUM(xcci304h*-1) xcce304h",
               "          FROM xcci_t ",
               "          WHERE xccient = '",g_enterprise,"' AND xccild = '",g_xcea_m.xceald,"'",
               "            AND xcci003 = '",g_xcea_m.xcea003,"' AND xcci004 = ",g_xcea_m.xcea004,
               "            AND xcci005 = ",g_xcea_m.xcea005,
               "            AND xcci001 = '1'",
               #170306-00063#1 mark start -----
               #"            AND (xcci303 <> 0 OR xcci304 <> 0)",
               #"         GROUP BY xcce002,xcce006,xcce007,xcce008,xcce009)",
               #170306-00063#1 mark start -----
               #170306-00063#1 add start -----
               "            AND xcci304 <> 0 ",
               "         GROUP BY xcci002,xcci006,xcci007,xcci008,xcci009)",
               #170306-00063#1 add start -----
               "  WHERE xcce304 <> 0 "                
   PREPARE axct701_5_ins_xcec_01 FROM g_sql
   EXECUTE axct701_5_ins_xcec_01
   
   #更新本位币二金额
   LET g_sql = " MERGE INTO sourse_ins_tmp1  ",
               " USING (SELECT xcce002 xcce002,xcce006 xcce006,xcce007 xcce007,xcce008 xcce008,xcce009 xcce009,",
               "               SUM(xcce303*-1) xcce303, SUM(xcce304*-1) xcce304, SUM(xcce304a*-1) xcce304a,SUM(xcce304b*-1) xcce304b,SUM(xcce304c*-1) xcce304c,",
               "               SUM(xcce304d*-1) xcce304d,SUM(xcce304e*-1) xcce304e,SUM(xcce304f*-1) xcce304f,SUM(xcce304g*-1) xcce304g,SUM(xcce304h*-1) xcce304h ",
               "          FROM xcce_t ",
               "          WHERE xcceent = '",g_enterprise,"' AND xcceld = '",g_xcea_m.xceald,"'",
               "            AND xcce003 = '",g_xcea_m.xcea003,"' AND xcce004 = ",g_xcea_m.xcea004,
               "            AND xcce005 = ",g_xcea_m.xcea005,
               "            AND xcce001 = '2'",
               #"            AND (xcce303 <> 0 OR xcce304 <> 0)",            #170306-00063#1 mark 
               "            AND xcce304 <> 0 ",             #170306-00063#1 add
               "         GROUP BY xcce002,xcce006,xcce007,xcce008,xcce009 ",
               "         UNION ",
               "        SELECT xcci002 xcce002,xcci006 xcce006,xcci007 xcce007,xcci008 xcce008,xcci009 xcce009,",
               "               SUM(xcci303*-1) xcce303, SUM(xcci304*-1) xcce304, SUM(xcci304a*-1) xcce304a,SUM(xcci304b*-1) xcce304b,SUM(xcci304c*-1) xcce304c,",
               "               SUM(xcci304d*-1) xcce304d,SUM(xcci304e*-1) xcce304e,SUM(xcci304f*-1) xcce304f,SUM(xcci304g*-1) xcce304g,SUM(xcci304h*-1) xcce304h",
               "          FROM xcci_t ",
               "          WHERE xccient = '",g_enterprise,"' AND xccild = '",g_xcea_m.xceald,"'",
               "            AND xcci003 = '",g_xcea_m.xcea003,"' AND xcci004 = ",g_xcea_m.xcea004,
               "            AND xcci005 = ",g_xcea_m.xcea005,
               "            AND xcci001 = '2'",
               #170306-00063#1 mark start -----
               #"            AND (xcci303 <> 0 OR xcci304 <> 0)",
               #"         GROUP BY xcce002,xcce006,xcce007,xcce008,xcce009)",
               #"    ON (xceb001 = xcce006 ",
               #"    AND xceb103 = xcce002", 
               #"    AND xceb004 = xcce007", 
               #"    AND sfaa029 = xcce009", 
               #"    AND xceb005 = xcce008)",                 
               #170306-00063#1 mark end   -----
               #170306-00063#1 add start -----
               "            AND xcci304 <> 0",
               "         GROUP BY xcci002,xcci006,xcci007,xcci008,xcci009)",
               "    ON (xcec001 = xcce006 ",
               "    AND xcec103 = xcce002", 
               "    AND xcec004 = xcce007", 
               "    AND sfaa029 = xcce009", 
               "    AND xcec005 = xcce008)",                 
               #170306-00063#1 add end -----                 
               "   WHEN MATCHED THEN ",
               " UPDATE SET xcec212  = xcce304 ,",
               "            xcec212a = xcce304a,",
               "            xcec212b = xcce304b,",
               "            xcec212c = xcce304c,",
               "            xcec212d = xcce304d,",
               "            xcec212e = xcce304e,",
               "            xcec212f = xcce304f,",
               "            xcec212g = xcce304g,",
               "            xcec212h = xcce304h "
   PREPARE axct701_5_upd_xcec212 FROM g_sql
   EXECUTE axct701_5_upd_xcec212

   #更新本位币三金额
   LET g_sql = " MERGE INTO sourse_ins_tmp1  ",
               " USING (SELECT xcce002 xcce002,xcce006 xcce006,xcce007 xcce007,xcce008 xcce008,xcce009 xcce009,",
               "               SUM(xcce303*-1) xcce303, SUM(xcce304*-1) xcce304, SUM(xcce304a*-1) xcce304a,SUM(xcce304b*-1) xcce304b,SUM(xcce304c*-1) xcce304c,",
               "               SUM(xcce304d*-1) xcce304d,SUM(xcce304e*-1) xcce304e,SUM(xcce304f*-1) xcce304f,SUM(xcce304g*-1) xcce304g,SUM(xcce304h*-1) xcce304h ",
               "          FROM xcce_t ",
               "          WHERE xcceent = '",g_enterprise,"' AND xcceld = '",g_xcea_m.xceald,"'",
               "            AND xcce003 = '",g_xcea_m.xcea003,"' AND xcce004 = ",g_xcea_m.xcea004,
               "            AND xcce005 = ",g_xcea_m.xcea005,
               "            AND xcce001 = '3'",
               #"            AND (xcce303 <> 0 OR xcce304 <> 0)",            #170306-00063#1 mark 
               "            AND xcce304 <> 0 ",            #170306-00063#1 add
               "         GROUP BY xcce002,xcce006,xcce007,xcce008,xcce009 ",
               "         UNION ",
               "        SELECT xcci002 xcce002,xcci006 xcce006,xcci007 xcce007,xcci008 xcce008,xcci009 xcce009,",
               "               SUM(xcci303*-1) xcce303, SUM(xcci304*-1) xcce304, SUM(xcci304a*-1) xcce304a,SUM(xcci304b*-1) xcce304b,SUM(xcci304c*-1) xcce304c,",
               "               SUM(xcci304d*-1) xcce304d,SUM(xcci304e*-1) xcce304e,SUM(xcci304f*-1) xcce304f,SUM(xcci304g*-1) xcce304g,SUM(xcci304h*-1) xcce304h",
               "          FROM xcci_t ",
               "          WHERE xccient = '",g_enterprise,"' AND xccild = '",g_xcea_m.xceald,"'",
               "            AND xcci003 = '",g_xcea_m.xcea003,"' AND xcci004 = ",g_xcea_m.xcea004,
               "            AND xcci005 = ",g_xcea_m.xcea005,
               "            AND xcci001 = '3'",
               #170306-00063#1 mark start -----
               #"            AND (xcci303 <> 0 OR xcci304 <> 0)",
               #"         GROUP BY xcce002,xcce006,xcce007,xcce008,xcce009)",
               #"    ON (xceb001 = xcce006 ",
               #"    AND xceb103 = xcce002", 
               #"    AND xceb004 = xcce007", 
               #"    AND sfaa029 = xcce009", 
               #"    AND xceb005 = xcce008)",                
               #170306-00063#1 mark end   -----
               #170306-00063#1 add start -----
               "            AND xcci304 <> 0 ",
               "         GROUP BY xcci002,xcci006,xcci007,xcci008,xcci009)",
               "    ON (xcec001 = xcce006 ",
               "    AND xcec103 = xcce002", 
               "    AND xcec004 = xcce007", 
               "    AND sfaa029 = xcce009", 
               "    AND xcec005 = xcce008)",                
               #170306-00063#1 add end   -----               
               "  WHEN MATCHED THEN ",
               "UPDATE SET xcec222  = xcce304 ,",
               "           xcec222a = xcce304a,",
               "           xcec222b = xcce304b,",
               "           xcec222c = xcce304c,",
               "           xcec222d = xcce304d,",
               "           xcec222e = xcce304e,",
               "           xcec222f = xcce304f,",
               "           xcec222g = xcce304g,",
               "           xcec222h = xcce304h "
   PREPARE axct701_5_upd_xcec222 FROM g_sql
   EXECUTE axct701_5_upd_xcec222

   LET g_sql = " MERGE INTO sourse_ins_tmp1 a ",
               #170306-00063#1 mark start -----
               #" USING (SELECT sfaadocno,sfaa003,sfaa057,sfaa009,sfaasite,sfaa028,sfaa029,sfaa068 ",
               #"          FROM sfaa_t,sourse_ins_tmp1 ",
               #170306-00063#1 mark end   -----
               #170306-00063#1 add start -----
               " USING (SELECT c.sfaadocno,c.sfaa003,c.sfaa057,c.sfaa009,c.sfaasite,c.sfaa028,c.sfaa029,c.sfaa068 ",
               "          FROM sfaa_t c,sourse_ins_tmp1 d",
               #170306-00063#1 add end   -----
               "         WHERE sfaaent = xcecent AND sfaadocno = xcec001) b",
               #"    ON (a.xceb001 = b.sfaadocno)",                #170306-00063#1 mark 
               "    ON (a.xcec001 = b.sfaadocno)",                 #170306-00063#1 add
               "   WHEN MATCHED THEN ",
               " UPDATE SET a.xcec003  = b.sfaa003 ,",
               "            a.sfaa057  = b.sfaa057,",   
               "            a.xcec111  = b.sfaa009,",   
               "            a.sfaasite = b.sfaasite,",   
               "            a.xcec119  = b.sfaa028,",   
               "            a.xcec120  = b.sfaa029,",   
               #"            a.xceb108  = b.sfaa068 " #170306-00063#1 mark
               "            a.xcec108  = b.sfaa068 "  #170306-00063#1 add
   PREPARE axct701_5_upd_xcec FROM g_sql
   EXECUTE axct701_5_upd_xcec
 
   UPDATE sourse_ins_tmp1
     SET xcec112 = (SELECT pmaa090 FROM pmaa_t WHERE pmaaent = g_enterprise AND pmaa001 = xcec111),
         xcec113 = (SELECT pmaa241 FROM pmaa_t WHERE pmaaent = g_enterprise AND pmaa001 = xcec111)
   WHERE sfaa057 = '2'  
   
   UPDATE sourse_ins_tmp1 
     SET xcec113 =(SELECT ooef153 FROM ooef_t WHERE ooefent = g_enterprise AND ooef001 = sfaasite),
         xcec111 = ' ',
         xcec112 = ' '
   WHERE sfaa057 <> '2'  
   
   UPDATE sourse_ins_tmp1
      SET sfaasite = (SELECT imag011 FROM imag_t
                       WHERE imagent = g_enterprise AND imagsite = g_xcea_m.xceacomp
                         AND imag001 = xcec004)  

   #170302-00035#1---add---s
   UPDATE sourse_ins_tmp1 
      SET xcec101 = (SELECT DISTINCT glcc004 FROM glcc_t 
                      WHERE glccent = g_enterprise
                        AND glcc001 = '4'
                        AND glccld  = g_xcea_m.xceald
                        AND (glcc014= g_xcea_m.xceacomp OR glcc014='*' )
                        AND (glcc016= xcec004 OR glcc016 = '*')
                        AND (glcc011= sfaasite OR glcc011='*')
                        AND rownum = 1)   
    WHERE (xcec101 IS NULL OR xcec101 = ' ')
      AND sfaa057 = '2'
   #170302-00035#1---add---e
      
   UPDATE sourse_ins_tmp1 
      SET xcec101 = (SELECT DISTINCT glcc002 FROM glcc_t 
                      WHERE glccent = g_enterprise
                        AND glcc001 = '3' #170215-00035#1 modify glcc001 = 1  --> glcc001 = 3
                        AND glccld  = g_xcea_m.xceald
                        AND (glcc014= g_xcea_m.xceacomp OR glcc014='*' )
                        AND (glcc016= xcec004 OR glcc016 = '*')
                        AND (glcc011= sfaasite OR glcc011='*')
                        AND rownum = 1)   
    WHERE (xcec101 IS NULL OR xcec101 = ' ')
      AND sfaa057 <> '2'
   #170302-00035#1---add---s
   UPDATE sourse_ins_tmp1 
      SET xcec101 = (SELECT glab005
                       FROM glab_t
                      WHERE glabld  = g_xcea_m.xceald
                        AND glab001 = '60'
                        AND glab002 = '8912'
                        AND glab003 = '1'
                        AND glabent = g_enterprise)
    WHERE xcec101 IS NULL OR xcec101 = ' '
   #170302-00035#1---add---e
    
   UPDATE sourse_ins_tmp1
     SET xcec117 = (SELECT imag011 #170215-00035#1 modify xceb117 --> xcec117
                      FROM imag_t 
                     WHERE imagent = g_enterprise 
                       AND imagsite = g_xcea_m.xceacomp
                       #AND imag001 = xceb004) #170306-00063#1 mark
                       AND imag001 = xcec004)  #170306-00063#1 add
  
  #启用交易对象
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad010 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad010 = 'N'  ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec111 = ' '"
   PREPARE axct701_5_upd_xcec111 FROM g_sql
   EXECUTE axct701_5_upd_xcec111

  #启用客群
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad011 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad011 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec112 = ' '"
   PREPARE axct701_5_upd_xcec112 FROM g_sql
   EXECUTE axct701_5_upd_xcec112

  #启用区域
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad009 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad009 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec113 = ' '"
   PREPARE axct701_5_upd_xcec113 FROM g_sql
   EXECUTE axct701_5_upd_xcec113

   
  #启用成本中心
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad008 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad008 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec114 = ' '"
   PREPARE axct701_5_upd_xcec114 FROM g_sql
   EXECUTE axct701_5_upd_xcec114
   
  #启用经营类别
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad031 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad031 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec115 = ' '"
   PREPARE axct701_5_upd_xcec115 FROM g_sql
   EXECUTE axct701_5_upd_xcec115
 
  #启用渠道
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad032 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad032 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec116 = ' '"
   PREPARE axct701_5_upd_xcec116 FROM g_sql
   EXECUTE axct701_5_upd_xcec116

  #启用品类
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad012 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad012 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec117 = ' '"
   PREPARE axct701_5_upd_xcec117 FROM g_sql
   EXECUTE axct701_5_upd_xcec117
   
  #启用品牌
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad033 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad033 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec118 = ' '"
   PREPARE axct701_5_upd_xcec118 FROM g_sql
   EXECUTE axct701_5_upd_xcec118
 
  #启用项目号
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad015 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad015 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec119 = ' '"
   PREPARE axct701_5_upd_xcec119 FROM g_sql
   EXECUTE axct701_5_upd_xcec119
 
  #启用WBS
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad016 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad016 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec120 = ' '"
   PREPARE axct701_5_upd_xcec120 FROM g_sql
   EXECUTE axct701_5_upd_xcec120
 
  #启用人员
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad013 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad013 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec107 = ' '"
   PREPARE axct701_5_upd_xcec107 FROM g_sql
   EXECUTE axct701_5_upd_xcec107
 
  #启用部门
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad007 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad007 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec108 = ' '"
   PREPARE axct701_5_upd_xcec108 FROM g_sql
   EXECUTE axct701_5_upd_xcec108
   
  #启用账款对象
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad027 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad027 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec109 = ' '"
   PREPARE axct701_5_upd_xcec109 FROM g_sql
   EXECUTE axct701_5_upd_xcec109
   
  #启用自由核算项1
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad017 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad017 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec121 = ' '"
   PREPARE axct701_5_upd_xcec121 FROM g_sql
   EXECUTE axct701_5_upd_xcec121
 
  #启用自由核算项2
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad018 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad018 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec122 = ' '"
   PREPARE axct701_5_upd_xcec122 FROM g_sql
   EXECUTE axct701_5_upd_xcec122
 
  #启用自由核算项3
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad019 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad019 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec123 = ' '"
   PREPARE axct701_5_upd_xcec123 FROM g_sql
   EXECUTE axct701_5_upd_xcec123

  #启用自由核算项4
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad019 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad019 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec124 = ' '"
   PREPARE axct701_5_upd_xcec124 FROM g_sql
   EXECUTE axct701_5_upd_xcec124

  #启用自由核算项5
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad021 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad021 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec125 = ' '"
   PREPARE axct701_5_upd_xcec125 FROM g_sql
   EXECUTE axct701_5_upd_xcec125

  #启用自由核算项6
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad022 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad022 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec126 = ' '"
   PREPARE axct701_5_upd_xcec126 FROM g_sql
   EXECUTE axct701_5_upd_xcec126

  #启用自由核算项7
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad023 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad023 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec127 = ' '"
   PREPARE axct701_5_upd_xcec127 FROM g_sql
   EXECUTE axct701_5_upd_xcec127

  #启用自由核算项8
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad024 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad024 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec128 = ' '"
   PREPARE axct701_5_upd_xcec128 FROM g_sql
   EXECUTE axct701_5_upd_xcec128

  #启用自由核算项9
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad025 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad025 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec129 = ' '"
   PREPARE axct701_5_upd_xcec129 FROM g_sql
   EXECUTE axct701_5_upd_xcec129

  #启用自由核算项10
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad026 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad026 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec130 = ' '"
   PREPARE axct701_5_upd_xcec130 FROM g_sql
   EXECUTE axct701_5_upd_xcec130
   
  #特性
   UPDATE sourse_ins_tmp1 SET xcec005 = ' ' WHERE xcec005 IS NULL
 #科目编号
   UPDATE sourse_ins_tmp1 SET xcec101 = ' ' WHERE xcec101 IS NULL
  #摘要
   UPDATE sourse_ins_tmp1 SET xcec102 = ' ' WHERE xcec102 IS NULL
  #成本域
   UPDATE sourse_ins_tmp1 SET xcec103 = ' ' WHERE xcec103 IS NULL
  #原因码
   UPDATE sourse_ins_tmp1 SET xcec110 = ' ' WHERE xcec110 IS NULL
  #交易对象
   UPDATE sourse_ins_tmp1 SET xcec111 = ' ' WHERE xcec111 IS NULL
  #客群
   UPDATE sourse_ins_tmp1 SET xcec112 = ' ' WHERE xcec112 IS NULL
  #区域
   UPDATE sourse_ins_tmp1 SET xcec113 = ' ' WHERE xcec113 IS NULL
  #成本中心
   UPDATE sourse_ins_tmp1 SET xcec114 = ' ' WHERE xcec114 IS NULL
  #经营类别
   UPDATE sourse_ins_tmp1 SET xcec115 = ' ' WHERE xcec115 IS NULL
  #渠道
   UPDATE sourse_ins_tmp1 SET xcec116 = ' ' WHERE xcec116 IS NULL
  #品类
   UPDATE sourse_ins_tmp1 SET xcec117 = ' ' WHERE xcec117 IS NULL
  #品牌
   UPDATE sourse_ins_tmp1 SET xcec118 = ' ' WHERE xcec118 IS NULL
  #项目号
   UPDATE sourse_ins_tmp1 SET xcec119 = ' ' WHERE xcec119 IS NULL
  #WBS
   UPDATE sourse_ins_tmp1 SET xcec120 = ' ' WHERE xcec120 IS NULL
  #人员
   UPDATE sourse_ins_tmp1 SET xcec107 = ' ' WHERE xcec107 IS NULL
   #部门
   UPDATE sourse_ins_tmp1 SET xcec108 = ' ' WHERE xcec108 IS NULL
  #账款对象
   UPDATE sourse_ins_tmp1 SET xcec109 = ' ' WHERE xcec109 IS NULL
  #自由核算项1
   UPDATE sourse_ins_tmp1 SET xcec121 = ' ' WHERE xcec121 IS NULL
  #自由核算项2
   UPDATE sourse_ins_tmp1 SET xcec122 = ' ' WHERE xcec122 IS NULL
  #自由核算项3
   UPDATE sourse_ins_tmp1 SET xcec123 = ' ' WHERE xcec123 IS NULL
  #自由核算项4
   UPDATE sourse_ins_tmp1 SET xcec124 = ' ' WHERE xcec124 IS NULL
  #自由核算项5
   UPDATE sourse_ins_tmp1 SET xcec125 = ' ' WHERE xcec125 IS NULL
  #自由核算项6
   UPDATE sourse_ins_tmp1 SET xcec126 = ' ' WHERE xcec126 IS NULL
   #自由核算项7
   UPDATE sourse_ins_tmp1 SET xcec127 = ' ' WHERE xcec127 IS NULL
  #自由核算项8
   UPDATE sourse_ins_tmp1 SET xcec128 = ' ' WHERE xcec128 IS NULL
  #自由核算项9
   UPDATE sourse_ins_tmp1 SET xcec129 = ' ' WHERE xcec129 IS NULL
  #自由核算项10
   UPDATE sourse_ins_tmp1 SET xcec130 = ' ' WHERE xcec130 IS NULL

   INSERT INTO xcec_t (xcecent,xceccomp,xcecld,xcecdocno,xcecseq,
                       xcec001,xcec002,xcec003,xcec004,xcec005,xcec101,xcec102,xcec103,xcec110,xcec111,
                       xcec112,xcec113,xcec114,xcec115,xcec116,xcec117,xcec118,xcec119,xcec120,xcec201,
                       xcec202,xcec202a,xcec202b,xcec202c,xcec202d,xcec202e,xcec202f,xcec202g,xcec202h,
                       xcec212,xcec212a,xcec212b,xcec212c,xcec212d,xcec212e,xcec212f,xcec212g,xcec212h,
                       xcec222,xcec222a,xcec222b,xcec222c,xcec222d,xcec222e,xcec222f,xcec222g,xcec222h,
                       xcec301,xcec302,xcec107,xcec108,xcec109,xcec121,xcec122,xcec123,xcec124,xcec125,
                       xcec126,xcec127,xcec128,xcec129,xcec130)
         SELECT xcecent,xceccomp,xcecld,xcecdocno,xcecseq,
                xcec001,xcec002,xcec003,xcec004,xcec005,xcec101,xcec102,xcec103,xcec110,xcec111,
                xcec112,xcec113,xcec114,xcec115,xcec116,xcec117,xcec118,xcec119,xcec120,xcec201,
                xcec202,xcec202a,xcec202b,xcec202c,xcec202d,xcec202e,xcec202f,xcec202g,xcec202h,
                xcec212,xcec212a,xcec212b,xcec212c,xcec212d,xcec212e,xcec212f,xcec212g,xcec212h,
                xcec222,xcec222a,xcec222b,xcec222c,xcec222d,xcec222e,xcec222f,xcec222g,xcec222h,
                xcec301,xcec302,xcec107,xcec108,xcec109,xcec121,xcec122,xcec123,xcec124,xcec125,
                xcec126,xcec127,xcec128,xcec129,xcec130
           FROM sourse_ins_tmp1
   DELETE FROM sourse_ins_tmp1; 
   
   #170302-00035#1---add---s
   #第三單身
   CALL axct701_01_ins_xced() RETURNING l_success
   IF NOT l_success THEN LET g_success = 'N' END IF 
   #170302-00035#1---add---e
   
   RETURN g_success   
END FUNCTION

################################################################################
# Descriptions...: 抓取xcck_t銷貨資料產生到銷貨成本憑證axct706中   銷貨成本傳票產生維護作業
# Memo...........: 
# Usage..........: CALL axct701_01_ins_6()
# Date & Author..: 2017/1/16 By xianghui
# Modify.........: #170105-00011#3 效能优化版
################################################################################
PRIVATE FUNCTION axct701_01_ins_6()
DEFINE l_xcea          RECORD  #工單發料成本憑證單頭檔
       xceaent LIKE xcea_t.xceaent, #企業編號
       xceacomp LIKE xcea_t.xceacomp, #法人組織
       xceald LIKE xcea_t.xceald, #帳套
       xceadocno LIKE xcea_t.xceadocno, #單據編號
       xcea001 LIKE xcea_t.xcea001, #單據日期
       xcea002 LIKE xcea_t.xcea002, #成本憑證類型
       xcea003 LIKE xcea_t.xcea003, #成本計算類型
       xcea004 LIKE xcea_t.xcea004, #年度
       xcea005 LIKE xcea_t.xcea005, #期別
       xcea006 LIKE xcea_t.xcea006, #帳務人員
       xcea007 LIKE xcea_t.xcea007, #帳務部門
       xcea101 LIKE xcea_t.xcea101, #憑證編號
       xcea102 LIKE xcea_t.xcea102, #憑證日期
       xceaownid LIKE xcea_t.xceaownid, #資料所有者
       xceaowndp LIKE xcea_t.xceaowndp, #資料所屬部門
       xceacrtid LIKE xcea_t.xceacrtid, #資料建立者
       xceacrtdp LIKE xcea_t.xceacrtdp, #資料建立部門
       xceacrtdt LIKE xcea_t.xceacrtdt, #資料創建日
       xceamodid LIKE xcea_t.xceamodid, #資料修改者
       xceamoddt LIKE xcea_t.xceamoddt, #最近修改日
       xceacnfid LIKE xcea_t.xceacnfid, #資料確認者
       xceacnfdt LIKE xcea_t.xceacnfdt, #資料確認日
       xceapstid LIKE xcea_t.xceapstid, #資料過帳者
       xceapstdt LIKE xcea_t.xceapstdt, #資料過帳日
       xceastus LIKE xcea_t.xceastus, #狀態碼
       xceaud001 LIKE xcea_t.xceaud001, #自定義欄位(文字)001
       xceaud002 LIKE xcea_t.xceaud002, #自定義欄位(文字)002
       xceaud003 LIKE xcea_t.xceaud003, #自定義欄位(文字)003
       xceaud004 LIKE xcea_t.xceaud004, #自定義欄位(文字)004
       xceaud005 LIKE xcea_t.xceaud005, #自定義欄位(文字)005
       xceaud006 LIKE xcea_t.xceaud006, #自定義欄位(文字)006
       xceaud007 LIKE xcea_t.xceaud007, #自定義欄位(文字)007
       xceaud008 LIKE xcea_t.xceaud008, #自定義欄位(文字)008
       xceaud009 LIKE xcea_t.xceaud009, #自定義欄位(文字)009
       xceaud010 LIKE xcea_t.xceaud010, #自定義欄位(文字)010
       xceaud011 LIKE xcea_t.xceaud011, #自定義欄位(數字)011
       xceaud012 LIKE xcea_t.xceaud012, #自定義欄位(數字)012
       xceaud013 LIKE xcea_t.xceaud013, #自定義欄位(數字)013
       xceaud014 LIKE xcea_t.xceaud014, #自定義欄位(數字)014
       xceaud015 LIKE xcea_t.xceaud015, #自定義欄位(數字)015
       xceaud016 LIKE xcea_t.xceaud016, #自定義欄位(數字)016
       xceaud017 LIKE xcea_t.xceaud017, #自定義欄位(數字)017
       xceaud018 LIKE xcea_t.xceaud018, #自定義欄位(數字)018
       xceaud019 LIKE xcea_t.xceaud019, #自定義欄位(數字)019
       xceaud020 LIKE xcea_t.xceaud020, #自定義欄位(數字)020
       xceaud021 LIKE xcea_t.xceaud021, #自定義欄位(日期時間)021
       xceaud022 LIKE xcea_t.xceaud022, #自定義欄位(日期時間)022
       xceaud023 LIKE xcea_t.xceaud023, #自定義欄位(日期時間)023
       xceaud024 LIKE xcea_t.xceaud024, #自定義欄位(日期時間)024
       xceaud025 LIKE xcea_t.xceaud025, #自定義欄位(日期時間)025
       xceaud026 LIKE xcea_t.xceaud026, #自定義欄位(日期時間)026
       xceaud027 LIKE xcea_t.xceaud027, #自定義欄位(日期時間)027
       xceaud028 LIKE xcea_t.xceaud028, #自定義欄位(日期時間)028
       xceaud029 LIKE xcea_t.xceaud029, #自定義欄位(日期時間)029
       xceaud030 LIKE xcea_t.xceaud030, #自定義欄位(日期時間)030
       xceasite LIKE xcea_t.xceasite  #營運據點
          END RECORD
DEFINE ld_date         DATETIME YEAR TO SECOND
DEFINE l_success       LIKE type_t.num5
DEFINE l_sfin1003      LIKE type_t.chr1          
          
  #CALL axct701_01_create_tmp()    #170324-00054#1 mark
   
   LET g_success = 'Y'
   LET l_xcea.xceaownid = g_user
   LET l_xcea.xceaowndp = g_dept
   LET l_xcea.xceacrtid = g_user
   LET l_xcea.xceacrtdp = g_dept 
   LET ld_date  = cl_get_current()
   LET l_xcea.xceacrtdt = ld_date
   LET l_xcea.xceamodid = ""
   LET l_xcea.xceamoddt = ""
   CALL s_aooi200_fin_gen_docno(g_xcea_m.xceald,'','',g_xcea_m.xceadocno,g_xcea_m.xcea001,g_prog_name1)      #wujie 150214
    RETURNING l_success,g_xcea_m.xceadocno
   IF l_success  = 0  THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = 'apm-00003'
      LET g_errparam.extend = g_xcea_m.xceadocno
      LET g_errparam.popup = TRUE
      CALL cl_err()

      LET g_success = 'N'
      RETURN g_success
   END IF
   
   INSERT INTO xcea_t (xceaent,xceald,xceacomp,xceadocno,xcea001,xcea002,xcea003,xcea004, 
                       xcea005,xcea006,xcea007,xceastus,xceaownid,xceaowndp,xceacrtid,xceacrtdp,
                       xceacrtdt, xceamodid,xceamoddt)
   VALUES (g_enterprise,g_xcea_m.xceald,g_xcea_m.xceacomp,g_xcea_m.xceadocno,g_xcea_m.xcea001,g_xcea002,
           g_xcea_m.xcea003,g_xcea_m.xcea004,g_xcea_m.xcea005,g_xcea_m.xcea006,g_xcea_m.xcea007, 
           'N',l_xcea.xceaownid,l_xcea.xceaowndp,l_xcea.xceacrtid, 
           l_xcea.xceacrtdp,ld_date,l_xcea.xceamodid,l_xcea.xceamoddt) 
       
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "ins xcea_t"
      LET g_errparam.popup = TRUE
      CALL cl_err()
  
      LET g_success = 'N'
      RETURN g_success
   END IF  
   
   CALL cl_get_para(g_enterprise,g_xcea_m.xceacomp,'S-FIN-1003') RETURNING l_sfin1003    
   IF cl_null(l_sfin1003) THEN LET l_sfin1003 = '' END IF   

   ###INS xceb_t###
   DELETE FROM sourse_ins_tmp;
   LET g_sql = " INSERT INTO sourse_ins_tmp ",
               "  (xcebent,xcebcomp,xcebld,xcebdocno,xcebseq,",
               "   xceb001,xceb002,xceb003,xceb004,xceb005,",
               "   xceb101,xceb102,xceb103,xceb110,xceb111,",
               "   xceb112,xceb113,xceb114,xceb115,xceb116,",
               "   xceb117,xceb118,xceb119,xceb120,xceb201,",
               "   xceb202,xceb202a,xceb202b,xceb202c,xceb202d,xceb202e,xceb202f,xceb202g,xceb202h,",
               "   xceb212,xceb212a,xceb212b,xceb212c,xceb212d,xceb212e,xceb212f,xceb212g,xceb212h,",
               "   xceb222,xceb222a,xceb222b,xceb222c,xceb222d,xceb222e,xceb222f,xceb222g,xceb222h,",
               "   xceb301,xceb302,xceb107,xceb108,xceb109,",
               "   xceb121,xceb122,xceb123,xceb124,xceb125,",
               "   xceb126,xceb127,xceb128,xceb129,xceb130,",
               "   xceb131,xceb132,sfaa009,sfaasite,sfaa028,",
               "   sfaa029,sfaa052,sfaa057) ",  
               " SELECT ",g_enterprise,",'",g_xcea_m.xceacomp,"','",g_xcea_m.xceald,"','",g_xcea_m.xceadocno,"',rownum,",
               "        xcck006,xcck007,(CASE WHEN xcck009 = -1 THEN '7' WHEN xcck009 = 1 THEN '8' END),xcck010 ,xcck011,",
               "        xcck033,(SELECT glab010 FROM glab_t WHERE glabld  = '",g_xcea_m.xceald,"' AND glab001 = '61' AND glab002 = '8925' AND glab003 = '6' AND glabent = ",g_enterprise,") xceb102,xcck002,xcck021,xcck022, ",
               "        xcck023,xcck024,xcck025,xcck026,xcck027,",
               #170306-00063#1 mark start -----
               #"        xcck028,xcck029,xcck030,xcck031,xcck201,",
               #"        xcck202,xcck202a,xcck202b,xcck202c,xcck202d,xcck202e,xcck202f,xcck202g,xcck202h,",
               #170306-00063#1 mark start -----
               #170306-00063#1 add start -----
               "        xcck028,xcck029,xcck030,xcck031,(xcck201*-1),",
               "        (xcck202*-1),(xcck202a*-1),(xcck202b*-1),(xcck202c*-1),(xcck202d*-1),(xcck202e*-1),(xcck202f*-1),(xcck202g*-1),(xcck202h*-1),",
               #170306-00063#1 add end   -----
               "        0,0,0,0,0,0,0,0,0,",
               "        0,0,0,0,0,0,0,0,0,",
               #"        '','','','','', ", #170214-00014#1 mark            
               "        '','','','',xcck022, ",  #170214-00014#1 add               
               "        '','','','','', ",             
               "        '','','','','', ",             
               "        '','','','','', ",             
               "        '','','' ",     
               "   FROM (",
               "         SELECT xcck002,xcck006,xcck007, ",
               "                xcck010,xcck011,xcck009,xcck021,xcck022,xcck023,xcck024,xcck025,xcck026,xcck027,xcck028,",  
               "                xcck029,xcck030,xcck031,xcck033,SUM(xcck009*xcck201) xcck201,SUM(xcck009*xcck202) xcck202, ",
               "                SUM(xcck009*xcck202a) xcck202a,SUM(xcck009*xcck202b) xcck202b,SUM(xcck009*xcck202c) xcck202c,SUM(xcck009*xcck202d) xcck202d,",
               "                SUM(xcck009*xcck202e) xcck202e,SUM(xcck009*xcck202f) xcck202f,SUM(xcck009*xcck202g) xcck202g,SUM(xcck009*xcck202h) xcck202h ",
               "                FROM xcck_t ", 
               "          WHERE xcckent = '",g_enterprise,"' AND xcckld = '",g_xcea_m.xceald,"'",
               "            AND xcck003 = '",g_xcea_m.xcea003,"' AND xcck004 = ",g_xcea_m.xcea004,
               "            AND xcck005 = ",g_xcea_m.xcea005,
               "            AND xcck001 = '1' ",
               "            AND xcck055 IN ('303','305','307','215') ",     
               "         GROUP BY xcck002,xcck006,xcck007,xcck010,xcck011,xcck009,xcck021,xcck022,xcck023,xcck024,xcck025,xcck026,xcck027,xcck028,xcck029,xcck030,xcck031,xcck033",  
               "         ORDER BY xcck002,xcck006,xcck007,xcck010,xcck011,xcck009,xcck021,xcck022,xcck023,xcck024,xcck025,xcck026,xcck027,xcck028,xcck029,xcck030,xcck031,xcck033)" 
   PREPARE axct701_6_ins_xceb_01 FROM g_sql
   EXECUTE axct701_6_ins_xceb_01
   
   #更新本位币二金额
   LET g_sql = " MERGE INTO sourse_ins_tmp                               ",
               " USING (SELECT xcck002,xcck006,xcck007,xcck010,xcck011,",
               "               xcck009,xcck021,xcck022,xcck023,xcck024,",
               "               xcck025,xcck026,xcck027,xcck028,xcck029,",
               "               xcck030,xcck031,xcck033,",
               "               SUM(xcck009*xcck202) xcck202, ",
               "               SUM(xcck009*xcck202a) xcck202a,SUM(xcck009*xcck202b) xcck202b,SUM(xcck009*xcck202c) xcck202c,SUM(xcck009*xcck202d) xcck202d,",
               "               SUM(xcck009*xcck202e) xcck202e,SUM(xcck009*xcck202f) xcck202f,SUM(xcck009*xcck202g) xcck202g,SUM(xcck009*xcck202h) xcck202h ",
               "          FROM xcck_t ", 
               "         WHERE xcckent = '",g_enterprise,"' AND xcckld = '",g_xcea_m.xceald,"'",
               "           AND xcck003 = '",g_xcea_m.xcea003,"' AND xcck004 = ",g_xcea_m.xcea004,
               "           AND xcck005 = ",g_xcea_m.xcea005,
               "           AND xcck055 IN ('303','305','307','215')",
               "           AND xcck001 = '2' ", 
               "         GROUP BY xcck002,xcck006,xcck007,xcck010,xcck011,xcck009,xcck021,xcck022,xcck023,xcck024,xcck025,xcck026,xcck027,xcck028,xcck029,xcck030,xcck031,xcck033 )",               
               "    ON (xceb001 = xcck006 ",
               "        AND xceb002 = xcck007 ", 
               "        AND xceb110 = xcck021 ",
               #"        AND (CASE xcck009 WHEN -1 THEN xceb003 = '7' WHEN  1 THEN xceb003 = '8' END) ", #170306-00063#1 mark
               "        AND xceb003 = (CASE xcck009 WHEN -1 THEN '7' WHEN  1 THEN '8' END) ",            #170306-00063#1 add
               "        AND xceb103 = xcck002", 
               "        AND xceb004 = xcck010", 
               "        AND xceb005 = xcck011", 
               "        AND xceb110 = xcck021", 
               "        AND xceb111 = xcck022",      
               "        AND xceb112 = xcck023", 
               "        AND xceb113 = xcck024", 
               "        AND xceb114 = xcck025",      
               "        AND xceb115 = xcck026", 
               "        AND xceb116 = xcck027", 
               "        AND xceb117 = xcck028", 
               "        AND xceb118 = xcck029", 
               "        AND xceb119 = xcck030", 
               "        AND xceb120 = xcck031", 
               "        AND xceb101 = xcck033)",                 
               "  WHEN MATCHED THEN ",
               #170306-00063#1 mark start -----
               #"UPDATE SET xceb212  = xcck202 ,",
               #"           xceb212a = xcck202a,",
               #"           xceb212b = xcck202b,",
               #"           xceb212c = xcck202c,",
               #"           xceb212d = xcck202d,",
               #"           xceb212e = xcck202e,",
               #"           xceb212f = xcck202f,",
               #"           xceb212g = xcck202g,",
               #"           xceb212h = xcck202h "
               #170306-00063#1 mark end   -----
               #170306-00063#1 add start -----
               "UPDATE SET xceb212  = (xcck202 *-1) ,",
               "           xceb212a = (xcck202a*-1),",
               "           xceb212b = (xcck202b*-1),",
               "           xceb212c = (xcck202c*-1),",
               "           xceb212d = (xcck202d*-1),",
               "           xceb212e = (xcck202e*-1),",
               "           xceb212f = (xcck202f*-1),",
               "           xceb212g = (xcck202g*-1),",
               "           xceb212h = (xcck202h*-1) "
               #170306-00063#1 add end   -----
   PREPARE axct701_6_upd_xceb212 FROM g_sql
   EXECUTE axct701_6_upd_xceb212

   #更新本位币三金额
   LET g_sql = " MERGE INTO sourse_ins_tmp                               ",
               " USING (SELECT xcck002,xcck006,xcck007,xcck010,xcck011,",
               "               xcck009,xcck021,xcck022,xcck023,xcck024,",
               "               xcck025,xcck026,xcck027,xcck028,xcck029,",
               "               xcck030,xcck031,xcck033,",
               "               SUM(xcck009*xcck202) xcck202, ",
               "               SUM(xcck009*xcck202a) xcck202a,SUM(xcck009*xcck202b) xcck202b,SUM(xcck009*xcck202c) xcck202c,SUM(xcck009*xcck202d) xcck202d,",
               "               SUM(xcck009*xcck202e) xcck202e,SUM(xcck009*xcck202f) xcck202f,SUM(xcck009*xcck202g) xcck202g,SUM(xcck009*xcck202h) xcck202h ",
               "          FROM xcck_t ", 
               "         WHERE xcckent = '",g_enterprise,"' AND xcckld = '",g_xcea_m.xceald,"'",
               "           AND xcck003 = '",g_xcea_m.xcea003,"' AND xcck004 = ",g_xcea_m.xcea004,
               "           AND xcck005 = ",g_xcea_m.xcea005,
               "           AND xcck055 IN ('303','305','307','215')",
               "           AND xcck001 = '3' " ,
               "         GROUP BY xcck002,xcck006,xcck007,xcck010,xcck011,xcck009,xcck021,xcck022,xcck023,xcck024,xcck025,xcck026,xcck027,xcck028,xcck029,xcck030,xcck031,xcck033 )" ,              
               "    ON (xceb001 = xcck006 ",
               "        AND xceb002 = xcck007 ", 
               "        AND xceb110 = xcck021 ",
               #"        AND (CASE xcck009 WHEN -1 THEN xceb003 = '7' WHEN  1 THEN xceb003 = '8' END) ", #170306-00063#1 mark
               "        AND xceb003 = (CASE xcck009 WHEN -1 THEN '7' WHEN  1 THEN '8' END) ",  #170306-00063#1 add
               "        AND xceb103 = xcck002", 
               "        AND xceb004 = xcck010", 
               "        AND xceb005 = xcck011", 
               "        AND xceb110 = xcck021", 
               "        AND xceb111 = xcck022",      
               "        AND xceb112 = xcck023", 
               "        AND xceb113 = xcck024", 
               "        AND xceb114 = xcck025",      
               "        AND xceb115 = xcck026", 
               "        AND xceb116 = xcck027", 
               "        AND xceb117 = xcck028", 
               "        AND xceb118 = xcck029", 
               "        AND xceb119 = xcck030", 
               "        AND xceb120 = xcck031", 
               "        AND xceb101 = xcck033)",                 
               "  WHEN MATCHED THEN ",
               #170306-00063#1 mark start ------
               #"UPDATE SET xceb222  = xcck202 ,",
               #"           xceb222a = xcck202a,",
               #"           xceb222b = xcck202b,",
               #"           xceb222c = xcck202c,",
               #"           xceb222d = xcck202d,",
               #"           xceb222e = xcck202e,",
               #"           xceb222f = xcck202f,",
               #"           xceb222g = xcck202g,",
               #"           xceb222h = xcck202h "
               #170306-00063#1 mark end   ------
               #170306-00063#1 add start -----
               "UPDATE SET xceb222  = (xcck202 *-1),",
               "           xceb222a = (xcck202a*-1),",
               "           xceb222b = (xcck202b*-1),",
               "           xceb222c = (xcck202c*-1),",
               "           xceb222d = (xcck202d*-1),",
               "           xceb222e = (xcck202e*-1),",
               "           xceb222f = (xcck202f*-1),",
               "           xceb222g = (xcck202g*-1),",
               "           xceb222h = (xcck202h*-1) "
               #170306-00063#1 add end   -----
   PREPARE axct701_6_upd_xceb222 FROM g_sql
   EXECUTE axct701_6_upd_xceb222

   IF l_sfin1003 = '4' THEN
      #xcck的出貨單號+項次 / 是存在於 xckb中的【當月轉入及轉出】者則往下依原標準產生分錄   
      DELETE FROM sourse_ins_tmp
       WHERE EXISTS(SELECT * FROM xckb_t a   #170322-00125#1 remove NOT count(*) --> *
                         WHERE a.xckbent = g_enterprise AND a.xckbld = g_xcea_m.xceald
                           AND a.xckb007 = g_xcea_m.xcea004 AND a.xckb008 = g_xcea_m.xcea005
                           AND a.xckb005 = xceb001 AND a.xckb006 = xceb002 AND a.xckb002 = 1    #170322-00125#1 remove -1 
                           AND NOT EXISTS (SELECT 1 FROM xckb_t b   #170322-00125#1 add NOT
                                        WHERE a.xckbent = b.xckbent AND a.xckbld = b.xckbld
                                          AND a.xckb007 = b.xckb007 AND a.xckb008 = b.xckb008
                                          AND a.xckb005 = b.xckb005 AND a.xckb006 = b.xckb006 AND b.xckb002 = -1))  #170322-00125#1 1  --> -1

      #取出同一會計期,已開發票的數量, 取其合計量、成本金額
      #SELECT SUM(xckb014),SUM(xckb102),SUM(xckb102a) ~ SUM(xckb102h)
      # WHERE xckb002=-1 AND 本期+出貨單號+項次)
      #取值後的NULL值判斷 ,避免加總計算錯誤
      LET g_sql = " MERGE INTO sourse_ins_tmp  ",
                  " USING (SELECT xckb005,xckb006,",
                  "               SUM(xckb014*xckb002) xcck201,SUM(xckb102*xckb002) xcck202,SUM(xckb102a*xckb002) xcck202a,SUM(xckb102b*xckb002) xcck202b,SUM(xckb102c*xckb002) xcck202c, ",
                  "               SUM(xckb102d*xckb002) xcck202d,SUM(xckb102e*xckb002) xcck202e,SUM(xckb102f*xckb002) xcck202f,SUM(xckb102g*xckb002) xcck202g,SUM(xckb102h*xckb002) xcck202h ",
                  "          FROM xckb_t ",
                  "         WHERE xckbent = ",g_enterprise,
                  "           AND xckbld  = '",g_xcea_m.xceald,"'  AND xckbcomp= '",g_xcea_m.xceacomp,"'",
                  "           AND xckb002 = -1 ",
                  "           AND xckb007 = '",g_xcea_m.xcea004,"' AND xckb008 = '",g_xcea_m.xcea005,"'",
                  "         GROUP BY xckb005,xckb006 )",               
                  "    ON (xckb005 = xceb001 ",
                  "        AND xckb006 = xceb002 )",                 
                  "  WHEN MATCHED THEN ",
                  #170306-00063#1 start ------
                  #"UPDATE SET xceb201  = xcck201 ,",
                  #"           xceb202  = xcck202 ,",
                  #"           xceb202a = xcck202a,",
                  #"           xceb202b = xcck202b,",
                  #"           xceb202c = xcck202c,",
                  #"           xceb202d = xcck202d,",
                  #"           xceb202e = xcck202e,",
                  #"           xceb202f = xcck202f,",
                  #"           xceb202g = xcck202g,",
                  #"           xceb202h = xcck202h "
                  #170306-00063#1 end   ------
                  #170306-00063#1 start -----
                  "UPDATE SET xceb201  = (xcck201 *-1),",
                  "           xceb202  = (xcck202 *-1),",
                  "           xceb202a = (xcck202a*-1),",
                  "           xceb202b = (xcck202b*-1),",
                  "           xceb202c = (xcck202c*-1),",
                  "           xceb202d = (xcck202d*-1),",
                  "           xceb202e = (xcck202e*-1),",
                  "           xceb202f = (xcck202f*-1),",
                  "           xceb202g = (xcck202g*-1),",
                  "           xceb202h = (xcck202h*-1) "
                  #170306-00063#1 end   -----
      PREPARE axct701_6_upd_xceb202 FROM g_sql
      EXECUTE axct701_6_upd_xceb202       
   END IF

   #部门
   UPDATE sourse_ins_tmp                
     SET xceb108 = (SELECT xmdk004 
                      FROM xmdk_t
                     WHERE xmdkent = g_enterprise
                       AND xmdkdocno = xceb001)
#170306-00063#1 mark start -----                       
#   UPDATE sourse_ins_tmp                
#     SET xceb201  = NVL(xcck201 ,0) * -1,
#         xceb202  = NVL(xcck202 ,0) * -1,
#         xceb202a = NVL(xcck202a,0) * -1,
#         xceb202b = NVL(xcck202b,0) * -1,
#         xceb202c = NVL(xcck202c,0) * -1,
#         xceb202d = NVL(xcck202d,0) * -1,
#         xceb202e = NVL(xcck202e,0) * -1,
#         xceb202f = NVL(xcck202f,0) * -1,
#         xceb202g = NVL(xcck202g,0) * -1,
#         xceb202h = NVL(xcck202h,0) * -1,
#         xceb212  = NVL(xcck212 ,0) * -1,
#         xceb212a = NVL(xcck212a,0) * -1,
#         xceb212b = NVL(xcck212b,0) * -1,
#         xceb212c = NVL(xcck212c,0) * -1,
#         xceb212d = NVL(xcck212d,0) * -1,
#         xceb212e = NVL(xcck212e,0) * -1,
#         xceb212f = NVL(xcck212f,0) * -1,
#         xceb212g = NVL(xcck212g,0) * -1,
#         xceb212h = NVL(xcck212h,0) * -1,
#         xceb222  = NVL(xcck222 ,0) * -1,
#         xceb222a = NVL(xcck222a,0) * -1,
#         xceb222b = NVL(xcck222b,0) * -1,
#         xceb222c = NVL(xcck222c,0) * -1,
#         xceb222d = NVL(xcck222d,0) * -1,
#         xceb222e = NVL(xcck222e,0) * -1,
#         xceb222f = NVL(xcck222f,0) * -1,
#         xceb222g = NVL(xcck222g,0) * -1,
#         xceb222h = NVL(xcck222h,0) * -1
#170306-00063#1 mark end   -----

   UPDATE sourse_ins_tmp
      SET sfaasite = (SELECT imag011 FROM imag_t
                       WHERE imagent = g_enterprise AND imagsite = g_xcea_m.xceacomp
                         AND imag001 = xceb004)  
  #170215-00035#1 ---mark (s)---                
  #UPDATE sourse_ins_tmp 
  #   #SET xceb101 = (SELECT DISTINCT glcc002 FROM glcc_t     #170208-00044#1 mark
  #   SET xceb101 = (SELECT DISTINCT glcc003 FROM glcc_t      #170208-00044#1 add
  #                   WHERE glccent = g_enterprise
  #                     #AND glcc001 = '1'                    #170208-00044#1 mark
  #                     AND glcc001 = '2'                     #170208-00044#1 add
  #                     AND glccld  = g_xcea_m.xceald
  #                     AND (glcc014= g_xcea_m.xceacomp OR glcc014='*' )
  #                     AND (glcc016=xceb004 OR glcc016 = '*')
  #                     AND (glcc011=sfaasite OR glcc011='*')
  #                     AND rownum = 1)   
  # WHERE xceb101 IS NULL OR xceb101 = ' '
  #170215-00035#1 ---mark (e)---
  
  #170215-00035#1 ---add (s)--- xcck027取不到渠道值，这里加
   UPDATE sourse_ins_tmp 
      SET xceb116 = (SELECT xmdk030 FROM xmdk_t  
                      WHERE xmdkent = g_enterprise
                        AND xmdkdocno = xceb001  )
    WHERE xceb116 IS NULL OR xceb116 = ' '
  #170215-00035#1 ---add (e)--- 

   UPDATE sourse_ins_tmp 
      SET xceb101 = (SELECT DISTINCT glcc004 FROM glcc_t  #170215-00035#1 glcc002 -->glcc004
                      WHERE glccent = g_enterprise 
                        AND glcc001 = '2'                     #170208-00044#1 mark #170215-00035#1 remark
                       #AND glcc001 = '1'                     #170208-00044#1 add  #170215-00035#1 mark
                        AND glccld  = g_xcea_m.xceald
                        AND (glcc014= g_xcea_m.xceacomp OR glcc014='*' )
                        AND (glcc016=xceb004 OR glcc016 = '*')
                        AND (glcc011=sfaasite OR glcc011='*')
                        AND (glcc013=xceb116 OR glcc013='*')  #170208-00044#1 add
                        AND rownum = 1)   
    WHERE xceb101 IS NULL OR xceb101 = ' '
    
  #启用交易对象
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad010 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad010 = 'N'  ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb111 = ' '"
   PREPARE axct701_6_upd_xceb111 FROM g_sql
   EXECUTE axct701_6_upd_xceb111

  #启用客群
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad011 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad011 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb112 = ' '"
   PREPARE axct701_6_upd_xceb112 FROM g_sql
   EXECUTE axct701_6_upd_xceb112

  #启用区域
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad009 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad009 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb113 = ' '"
   PREPARE axct701_6_upd_xceb113 FROM g_sql
   EXECUTE axct701_6_upd_xceb113

   
  #启用成本中心
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad008 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad008 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb114 = ' '"
   PREPARE axct701_6_upd_xceb114 FROM g_sql
   EXECUTE axct701_6_upd_xceb114
   
  #启用经营类别
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad031 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad031 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb115 = ' '"
   PREPARE axct701_6_upd_xceb115 FROM g_sql
   EXECUTE axct701_6_upd_xceb115
 
  #启用渠道
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad032 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad032 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb116 = ' '"
   PREPARE axct701_6_upd_xceb116 FROM g_sql
   EXECUTE axct701_6_upd_xceb116

  #启用品类
  #170221-00041#1 add start ----
   UPDATE sourse_ins_tmp 
      SET xceb117 = (SELECT imag011 FROM imag_t 
                      WHERE imagent = xcebent 
                        AND imagsite = g_xcea_m.xceacomp
                        AND imag001 = xceb004) 
  #170221-00041#1 add end   ----    
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad012 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad012 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb117 = ' '"
   PREPARE axct701_6_upd_xceb117 FROM g_sql
   EXECUTE axct701_6_upd_xceb117
   
  #启用品牌
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad033 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad033 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb118 = ' '"
   PREPARE axct701_6_upd_xceb118 FROM g_sql
   EXECUTE axct701_6_upd_xceb118
 
  #启用项目号
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad015 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad015 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb119 = ' '"
   PREPARE axct701_6_upd_xceb119 FROM g_sql
   EXECUTE axct701_6_upd_xceb119
 
  #启用WBS
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad016 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad016 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb120 = ' '"
   PREPARE axct701_6_upd_xceb120 FROM g_sql
   EXECUTE axct701_6_upd_xceb120
 
  #启用人员
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad013 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad013 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb107 = ' '"
   PREPARE axct701_6_upd_xceb107 FROM g_sql
   EXECUTE axct701_6_upd_xceb107
 
  #启用部门
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad007 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad007 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb108 = ' '"
   PREPARE axct701_6_upd_xceb108 FROM g_sql
   EXECUTE axct701_6_upd_xceb108
   
  #启用账款对象
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad027 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad027 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb109 = ' '"
   PREPARE axct701_6_upd_xceb109 FROM g_sql
   EXECUTE axct701_6_upd_xceb109
   
  #启用自由核算项1
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad017 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad017 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb121 = ' '"
   PREPARE axct701_6_upd_xceb121 FROM g_sql
   EXECUTE axct701_6_upd_xceb121
 
  #启用自由核算项2
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad018 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad018 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb122 = ' '"
   PREPARE axct701_6_upd_xceb122 FROM g_sql
   EXECUTE axct701_6_upd_xceb122
 
  #启用自由核算项3
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad019 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad019 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb123 = ' '"
   PREPARE axct701_6_upd_xceb123 FROM g_sql
   EXECUTE axct701_6_upd_xceb123

  #启用自由核算项4
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad019 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad019 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb124 = ' '"
   PREPARE axct701_6_upd_xceb124 FROM g_sql
   EXECUTE axct701_6_upd_xceb124

  #启用自由核算项5
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad021 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad021 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb125 = ' '"
   PREPARE axct701_6_upd_xceb125 FROM g_sql
   EXECUTE axct701_6_upd_xceb125

  #启用自由核算项6
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad022 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad022 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb126 = ' '"
   PREPARE axct701_6_upd_xceb126 FROM g_sql
   EXECUTE axct701_6_upd_xceb126

  #启用自由核算项7
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad023 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad023 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb127 = ' '"
   PREPARE axct701_6_upd_xceb127 FROM g_sql
   EXECUTE axct701_6_upd_xceb127

  #启用自由核算项8
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad024 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad024 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb128 = ' '"
   PREPARE axct701_6_upd_xceb128 FROM g_sql
   EXECUTE axct701_6_upd_xceb128

  #启用自由核算项9
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad025 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad025 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb129 = ' '"
   PREPARE axct701_6_upd_xceb129 FROM g_sql
   EXECUTE axct701_6_upd_xceb129

  #启用自由核算项10
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad026 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad026 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb130 = ' '"
   PREPARE axct701_6_upd_xceb130 FROM g_sql
   EXECUTE axct701_6_upd_xceb130
   
  #特性
   UPDATE sourse_ins_tmp SET xceb005 = ' ' WHERE xceb005 IS NULL
 #科目编号
   UPDATE sourse_ins_tmp SET xceb101 = ' ' WHERE xceb101 IS NULL
  #摘要
   UPDATE sourse_ins_tmp SET xceb102 = ' ' WHERE xceb102 IS NULL
  #成本域
   UPDATE sourse_ins_tmp SET xceb103 = ' ' WHERE xceb103 IS NULL
  #原因码
   UPDATE sourse_ins_tmp SET xceb110 = ' ' WHERE xceb110 IS NULL
  #交易对象
   UPDATE sourse_ins_tmp SET xceb111 = ' ' WHERE xceb111 IS NULL
  #客群
   UPDATE sourse_ins_tmp SET xceb112 = ' ' WHERE xceb112 IS NULL
  #区域
   UPDATE sourse_ins_tmp SET xceb113 = ' ' WHERE xceb113 IS NULL
  #成本中心
   UPDATE sourse_ins_tmp SET xceb114 = ' ' WHERE xceb114 IS NULL
  #经营类别
   UPDATE sourse_ins_tmp SET xceb115 = ' ' WHERE xceb115 IS NULL
  #渠道
   UPDATE sourse_ins_tmp SET xceb116 = ' ' WHERE xceb116 IS NULL
  #品类
   UPDATE sourse_ins_tmp SET xceb117 = ' ' WHERE xceb117 IS NULL
  #品牌
   UPDATE sourse_ins_tmp SET xceb118 = ' ' WHERE xceb118 IS NULL
  #项目号
   UPDATE sourse_ins_tmp SET xceb119 = ' ' WHERE xceb119 IS NULL
  #WBS
   UPDATE sourse_ins_tmp SET xceb120 = ' ' WHERE xceb120 IS NULL
  #人员
   UPDATE sourse_ins_tmp SET xceb107 = ' ' WHERE xceb107 IS NULL
   #部门
   UPDATE sourse_ins_tmp SET xceb108 = ' ' WHERE xceb108 IS NULL
  #账款对象
   UPDATE sourse_ins_tmp SET xceb109 = ' ' WHERE xceb109 IS NULL
  #自由核算项1
   UPDATE sourse_ins_tmp SET xceb121 = ' ' WHERE xceb121 IS NULL
  #自由核算项2
   UPDATE sourse_ins_tmp SET xceb122 = ' ' WHERE xceb122 IS NULL
  #自由核算项3
   UPDATE sourse_ins_tmp SET xceb123 = ' ' WHERE xceb123 IS NULL
  #自由核算项4
   UPDATE sourse_ins_tmp SET xceb124 = ' ' WHERE xceb124 IS NULL
  #自由核算项5
   UPDATE sourse_ins_tmp SET xceb125 = ' ' WHERE xceb125 IS NULL
  #自由核算项6
   UPDATE sourse_ins_tmp SET xceb126 = ' ' WHERE xceb126 IS NULL
   #自由核算项7
   UPDATE sourse_ins_tmp SET xceb127 = ' ' WHERE xceb127 IS NULL
  #自由核算项8
   UPDATE sourse_ins_tmp SET xceb128 = ' ' WHERE xceb128 IS NULL
  #自由核算项9
   UPDATE sourse_ins_tmp SET xceb129 = ' ' WHERE xceb129 IS NULL
  #自由核算项10
   UPDATE sourse_ins_tmp SET xceb130 = ' ' WHERE xceb130 IS NULL
   
   INSERT INTO xceb_t (xcebent,xcebcomp,xcebld,xcebdocno,xcebseq,
                       xceb001,xceb002,xceb003,xceb004,xceb005,xceb101,xceb102,xceb103,xceb110,xceb111,
                       xceb112,xceb113,xceb114,xceb115,xceb116,xceb117,xceb118,xceb119,xceb120,xceb201,
                       xceb202,xceb202a,xceb202b,xceb202c,xceb202d,xceb202e,xceb202f,xceb202g,xceb202h,
                       xceb212,xceb212a,xceb212b,xceb212c,xceb212d,xceb212e,xceb212f,xceb212g,xceb212h,
                       xceb222,xceb222a,xceb222b,xceb222c,xceb222d,xceb222e,xceb222f,xceb222g,xceb222h,
                       xceb301,xceb302,xceb107,xceb108,xceb109,xceb121,xceb122,xceb123,xceb124,xceb125,
                       xceb126,xceb127,xceb128,xceb129,xceb130,xceb131,xceb132)
         SELECT xcebent,xcebcomp,xcebld,xcebdocno,xcebseq,
                xceb001,xceb002,xceb003,xceb004,xceb005,xceb101,xceb102,xceb103,xceb110,xceb111,
                xceb112,xceb113,xceb114,xceb115,xceb116,xceb117,xceb118,xceb119,xceb120,xceb201,
                xceb202,xceb202a,xceb202b,xceb202c,xceb202d,xceb202e,xceb202f,xceb202g,xceb202h,
                xceb212,xceb212a,xceb212b,xceb212c,xceb212d,xceb212e,xceb212f,xceb212g,xceb212h,
                xceb222,xceb222a,xceb222b,xceb222c,xceb222d,xceb222e,xceb222f,xceb222g,xceb222h,
                xceb301,xceb302,xceb107,xceb108,xceb109,xceb121,xceb122,xceb123,xceb124,xceb125,
                xceb126,xceb127,xceb128,xceb129,xceb130,xceb131,xceb132
           FROM sourse_ins_tmp
   DELETE FROM sourse_ins_tmp;   

   ###INS xcec_t###
   DELETE FROM sourse_ins_tmp1;
   LET g_sql = " INSERT INTO sourse_ins_tmp1 ",
               "  (xcecent,xceccomp,xcecld,xcecdocno,xcecseq,",
               "   xcec001,xcec002,xcec003,xcec004,xcec005,",
               "   xcec101,xcec102,xcec103,xcec110,xcec111,",
               "   xcec112,xcec113,xcec114,xcec115,xcec116,",
               "   xcec117,xcec118,xcec119,xcec120,xcec201,",
               "   xcec202,xcec202a,xcec202b,xcec202c,xcec202d,xcec202e,xcec202f,xcec202g,xcec202h,",
               "   xcec212,xcec212a,xcec212b,xcec212c,xcec212d,xcec212e,xcec212f,xcec212g,xcec212h,",
               "   xcec222,xcec222a,xcec222b,xcec222c,xcec222d,xcec222e,xcec222f,xcec222g,xcec222h,",
               "   xcec301,xcec302,xcec107,xcec108,xcec109,",
               "   xcec121,xcec122,xcec123,xcec124,xcec125,",
               "   xcec126,xcec127,xcec128,xcec129,xcec130,",
               "   sfaa009,sfaasite,sfaa028,",
               "   sfaa029,sfaa052,sfaa057) ",  
               " SELECT ",g_enterprise,",'",g_xcea_m.xceacomp,"','",g_xcea_m.xceald,"','",g_xcea_m.xceadocno,"',rownum,",
               "        xcck006,xcck007,(CASE WHEN xcck009 = -1 THEN '7' WHEN xcck009 = 1 THEN '8' END),xcck010 ,xcck011,",
               "        xcck032,(SELECT glab010 FROM glab_t WHERE glabld  = '",g_xcea_m.xceald,"' AND glab001 = '61' AND glab002 = '8925' AND glab003 = '6' AND glabent = ",g_enterprise,") xcec102,xcck002,xcck021,xcck022, ",
               "        xcck023,xcck024,xcck025,xcck026,xcck027,",
               #170306-00063#1 mark start -----
               #"        xcck028,xcck029,xcck030,xcck031,xcck201,",
               #"        xcck202,xcck202a,xcck202b,xcck202c,xcck202d,xcck202e,xcck202f,xcck202g,xcck202h,",
               #170306-00063#1 mark end   -----
               #170306-00063#1 add start -----
               "        xcck028,xcck029,xcck030,xcck031,(xcck201*-1),",
               "        (xcck202*-1),(xcck202a*-1),(xcck202b*-1),(xcck202c*-1),(xcck202d*-1),(xcck202e*-1),(xcck202f*-1),(xcck202g*-1),(xcck202h*-1),",
               #170306-00063#1 add end   -----
               "        0,0,0,0,0,0,0,0,0,",
               "        0,0,0,0,0,0,0,0,0,",
               #"        '','','','','', ", #170214-00014#1 mark
               "        '','','','',xcck022, ", #170214-00014#1 add               
               "        '','','','','', ",             
               "        '','','','','', ",             
               "        '','','', ",             
               "        '','','' ",   
               "   FROM (",
               "         SELECT xcck002,xcck006,xcck007, ",
               "                xcck010,xcck011,xcck009,xcck021,xcck022,xcck023,xcck024,xcck025,xcck026,xcck027,xcck028,",  
               "                xcck029,xcck030,xcck031,xcck032,SUM(xcck009*xcck201) xcck201,SUM(xcck009*xcck202) xcck202, ",
               "                SUM(xcck009*xcck202a) xcck202a,SUM(xcck009*xcck202b) xcck202b,SUM(xcck009*xcck202c) xcck202c,SUM(xcck009*xcck202d) xcck202d,",
               "                SUM(xcck009*xcck202e) xcck202e,SUM(xcck009*xcck202f) xcck202f,SUM(xcck009*xcck202g) xcck202g,SUM(xcck009*xcck202h) xcck202h ",
               "                FROM xcck_t ", 
               "          WHERE xcckent = '",g_enterprise,"' AND xcckld = '",g_xcea_m.xceald,"'",
               "            AND xcck003 = '",g_xcea_m.xcea003,"' AND xcck004 = ",g_xcea_m.xcea004,
               "            AND xcck005 = ",g_xcea_m.xcea005,
               "            AND xcck001 = '1' ",
               "            AND xcck055 IN ('303','305','307','215') ",     
               "         GROUP BY xcck002,xcck006,xcck007,xcck010,xcck011,xcck009,xcck021,xcck022,xcck023,xcck024,xcck025,xcck026,xcck027,xcck028,xcck029,xcck030,xcck031,xcck032",  
               "         ORDER BY xcck002,xcck006,xcck007,xcck010,xcck011,xcck009,xcck021,xcck022,xcck023,xcck024,xcck025,xcck026,xcck027,xcck028,xcck029,xcck030,xcck031,xcck032)" 
   PREPARE axct701_6_ins_xcec_01 FROM g_sql
   EXECUTE axct701_6_ins_xcec_01
   
   #更新本位币二金额
   LET g_sql = " MERGE INTO sourse_ins_tmp1                               ",
               " USING (SELECT xcck002,xcck006,xcck007,xcck010,xcck011,",
               "               xcck009,xcck021,xcck022,xcck023,xcck024,",
               "               xcck025,xcck026,xcck027,xcck028,xcck029,",
               "               xcck030,xcck031,xcck032,",
               "               SUM(xcck009*xcck202) xcck202, ",
               "               SUM(xcck009*xcck202a) xcck202a,SUM(xcck009*xcck202b) xcck202b,SUM(xcck009*xcck202c) xcck202c,SUM(xcck009*xcck202d) xcck202d,",
               "               SUM(xcck009*xcck202e) xcck202e,SUM(xcck009*xcck202f) xcck202f,SUM(xcck009*xcck202g) xcck202g,SUM(xcck009*xcck202h) xcck202h ",
               "          FROM xcck_t ", 
               "         WHERE xcckent = '",g_enterprise,"' AND xcckld = '",g_xcea_m.xceald,"'",
               "           AND xcck003 = '",g_xcea_m.xcea003,"' AND xcck004 = ",g_xcea_m.xcea004,
               "           AND xcck005 = ",g_xcea_m.xcea005,
               "           AND xcck055 IN ('303','305','307','215') ",
               "           AND xcck001 = '2' " ,
               "         GROUP BY xcck002,xcck006,xcck007,xcck010,xcck011,xcck009,xcck021,xcck022,xcck023,xcck024,xcck025,xcck026,xcck027,xcck028,xcck029,xcck030,xcck031,xcck032 )",               
               "    ON (xcec001 = xcck006 ",
               "        AND xcec002 = xcck007 ", 
               "        AND xcec110 = xcck021 ",
               #"        AND (CASE xcck009 WHEN -1 THEN xcec003 = '7' WHEN  1 THEN xcec003 = '8' END) ", #170306-00063#1 mark
               "        AND xcec003 = (CASE xcck009 WHEN -1 THEN '7' WHEN  1 THEN '8' END) ",  #170306-00063#1 add
               "        AND xcec103 = xcck002", 
               "        AND xcec004 = xcck010", 
               "        AND xcec005 = xcck011", 
               "        AND xcec110 = xcck021", 
               "        AND xcec111 = xcck022",      
               "        AND xcec112 = xcck023", 
               "        AND xcec113 = xcck024", 
               "        AND xcec114 = xcck025",      
               "        AND xcec115 = xcck026", 
               "        AND xcec116 = xcck027", 
               "        AND xcec117 = xcck028", 
               "        AND xcec118 = xcck029", 
               "        AND xcec119 = xcck030", 
               "        AND xcec120 = xcck031", 
               "        AND xcec101 = xcck032)",                 
               "  WHEN MATCHED THEN ",
               #170306-00063#1 mark start -----
               #"UPDATE SET xcec212  = xcck202 ,",
               #"           xcec212a = xcck202a,",
               #"           xcec212b = xcck202b,",
               #"           xcec212c = xcck202c,",
               #"           xcec212d = xcck202d,",
               #"           xcec212e = xcck202e,",
               #"           xcec212f = xcck202f,",
               #"           xcec212g = xcck202g,",
               #"           xcec212h = xcck202h "
               #170306-00063#1 mark end    -----
               #170306-00063#1 add start -----
               "UPDATE SET xcec212  = (xcck202 *-1),",
               "           xcec212a = (xcck202a*-1),",
               "           xcec212b = (xcck202b*-1),",
               "           xcec212c = (xcck202c*-1),",
               "           xcec212d = (xcck202d*-1),",
               "           xcec212e = (xcck202e*-1),",
               "           xcec212f = (xcck202f*-1),",
               "           xcec212g = (xcck202g*-1),",
               "           xcec212h = (xcck202h*-1) "
               #170306-00063#1 add end   -----
   PREPARE axct701_6_upd_xcec212 FROM g_sql
   EXECUTE axct701_6_upd_xcec212

   #更新本位币三金额
   LET g_sql = " MERGE INTO sourse_ins_tmp1                               ",
               " USING (SELECT xcck002,xcck006,xcck007,xcck010,xcck011,",
               "               xcck009,xcck021,xcck022,xcck023,xcck024,",
               "               xcck025,xcck026,xcck027,xcck028,xcck029,",
               "               xcck030,xcck031,xcck032,",
               "               SUM(xcck009*xcck202) xcck202, ",
               "               SUM(xcck009*xcck202a) xcck202a,SUM(xcck009*xcck202b) xcck202b,SUM(xcck009*xcck202c) xcck202c,SUM(xcck009*xcck202d) xcck202d,",
               "               SUM(xcck009*xcck202e) xcck202e,SUM(xcck009*xcck202f) xcck202f,SUM(xcck009*xcck202g) xcck202g,SUM(xcck009*xcck202h) xcck202h ",
               "          FROM xcck_t ", 
               "         WHERE xcckent = '",g_enterprise,"' AND xcckld = '",g_xcea_m.xceald,"'",
               "           AND xcck003 = '",g_xcea_m.xcea003,"' AND xcck004 = ",g_xcea_m.xcea004,
               "           AND xcck005 = ",g_xcea_m.xcea005,
               "           AND xcck055 IN ('303','305','307','215')",
               "           AND xcck001 = '3' ", 
               "         GROUP BY xcck002,xcck006,xcck007,xcck010,xcck011,xcck009,xcck021,xcck022,xcck023,xcck024,xcck025,xcck026,xcck027,xcck028,xcck029,xcck030,xcck031,xcck032 )",               
               "    ON (xcec001 = xcck006 ",
               "        AND xcec002 = xcck007 ", 
               "        AND xcec110 = xcck021 ",
               #"        AND (CASE xcck009 WHEN -1 THEN xcec003 = '7' WHEN  1 THEN xcec003 = '8' END) ", #170306-00063#1 mark
               "        AND xcec003 = (CASE xcck009 WHEN -1 THEN '7' WHEN  1 THEN '8' END) ",  #170306-00063#1 add
               "        AND xcec103 = xcck002", 
               "        AND xcec004 = xcck010", 
               "        AND xcec005 = xcck011", 
               "        AND xcec110 = xcck021", 
               "        AND xcec111 = xcck022",      
               "        AND xcec112 = xcck023", 
               "        AND xcec113 = xcck024", 
               "        AND xcec114 = xcck025",      
               "        AND xcec115 = xcck026", 
               "        AND xcec116 = xcck027", 
               "        AND xcec117 = xcck028", 
               "        AND xcec118 = xcck029", 
               "        AND xcec119 = xcck030", 
               "        AND xcec120 = xcck031", 
               "        AND xcec101 = xcck032)",                 
               "  WHEN MATCHED THEN ",
               #170306-00063#1 mark start -----
               #"UPDATE SET xcec222  = xcck202 ,",
               #"           xcec222a = xcck202a,",
               #"           xcec222b = xcck202b,",
               #"           xcec222c = xcck202c,",
               #"           xcec222d = xcck202d,",
               #"           xcec222e = xcck202e,",
               #"           xcec222f = xcck202f,",
               #"           xcec222g = xcck202g,",
               #"           xcec222h = xcck202h "
               #170306-00063#1 mark end   -----
               #170306-00063#1 add start -----
               "UPDATE SET xcec222  = (xcck202 *-1),",
               "           xcec222a = (xcck202a*-1),",
               "           xcec222b = (xcck202b*-1),",
               "           xcec222c = (xcck202c*-1),",
               "           xcec222d = (xcck202d*-1),",
               "           xcec222e = (xcck202e*-1),",
               "           xcec222f = (xcck202f*-1),",
               "           xcec222g = (xcck202g*-1),",
               "           xcec222h = (xcck202h*-1) "
               #170306-00063#1 add end   -----
   PREPARE axct701_6_upd_xcec222 FROM g_sql
   EXECUTE axct701_6_upd_xcec222

   IF l_sfin1003 = '4' THEN
      #xcck的出貨單號+項次 / 是存在於 xckb中的【當月轉入及轉出】者則往下依原標準產生分錄   
      DELETE FROM sourse_ins_tmp1
       WHERE EXISTS(SELECT * FROM xckb_t a  #170322-00125#1 remove NOT  count(*) --> *
                         WHERE a.xckbent = g_enterprise AND a.xckbld = g_xcea_m.xceald
                           AND a.xckb007 = g_xcea_m.xcea004 AND a.xckb008 = g_xcea_m.xcea005
                           AND a.xckb005 = xcec001 AND a.xckb006 = xcec002 AND a.xckb002 = 1   #170322-00125#1 -1 --> 1
                           AND NOT EXISTS (SELECT 1 FROM xckb_t b  #170322-00125#1 add NOT
                                        WHERE a.xckbent = b.xckbent AND a.xckbld = b.xckbld
                                          AND a.xckb007 = b.xckb007 AND a.xckb008 = b.xckb008
                                          AND a.xckb005 = b.xckb005 AND a.xckb006 = b.xckb006 AND b.xckb002 = -1))   #170322-00125#1 1 --> -1

      #取出同一會計期,已開發票的數量, 取其合計量、成本金額
      #SELECT SUM(xckb014),SUM(xckb102),SUM(xckb102a) ~ SUM(xckb102h)
      # WHERE xckb002=-1 AND 本期+出貨單號+項次)
      #取值後的NULL值判斷 ,避免加總計算錯誤
      LET g_sql = " MERGE INTO sourse_ins_tmp1                               ",
                  " USING (SELECT xckb005,xckb006,",
                  "               SUM(xckb014*xckb002) xcck201,SUM(xckb102*xckb002) xcck202,SUM(xckb102a*xckb002) xcck202a,SUM(xckb102b*xckb002) xcck202b,SUM(xckb102c*xckb002) xcck202c, ",
                  "               SUM(xckb102d*xckb002) xcck202d,SUM(xckb102e*xckb002) xcck202e,SUM(xckb102f*xckb002) xcck202f,SUM(xckb102g*xckb002) xcck202g,SUM(xckb102h*xckb002) xcck202h ",
                  "          FROM xckb_t ",
                  "         WHERE xckbent = ",g_enterprise,
                  "           AND xckbld  = '",g_xcea_m.xceald,"'  AND xckbcomp= '",g_xcea_m.xceacomp,"'",
                  "           AND xckb002 = -1 ",
                  "           AND xckb007 = '",g_xcea_m.xcea004,"' AND xckb008 = '",g_xcea_m.xcea005,"'",
                  "         GROUP BY xckb005,xckb006 )",               
                  "    ON (xckb005 = xcec001 ",
                  "        AND xckb006 = xcec002 )",                 
                  "  WHEN MATCHED THEN ",
                  #170306-00063#1 mark start -----
                  #"UPDATE SET xcec201  = xcck201 ,",
                  #"           xcec202  = xcck202 ,",
                  #"           xcec202a = xcck202a,",
                  #"           xcec202b = xcck202b,",
                  #"           xcec202c = xcck202c,",
                  #"           xcec202d = xcck202d,",
                  #"           xcec202e = xcck202e,",
                  #"           xcec202f = xcck202f,",
                  #"           xcec202g = xcck202g,",
                  #"           xcec202h = xcck202h "
                  #170306-00063#1 mark end   -----
                  #170306-00063#1 add start -----
                  "UPDATE SET xcec201  = (xcck201 *-1),",
                  "           xcec202  = (xcck202 *-1),",
                  "           xcec202a = (xcck202a*-1),",
                  "           xcec202b = (xcck202b*-1),",
                  "           xcec202c = (xcck202c*-1),",
                  "           xcec202d = (xcck202d*-1),",
                  "           xcec202e = (xcck202e*-1),",
                  "           xcec202f = (xcck202f*-1),",
                  "           xcec202g = (xcck202g*-1),",
                  "           xcec202h = (xcck202h*-1) "
                  #170306-00063#1 add end   -----
      PREPARE axct701_6_upd_xcec202 FROM g_sql
      EXECUTE axct701_6_upd_xcec202       
   END IF

#170306-00063#1 mark start -----
#   UPDATE sourse_ins_tmp1                
#     SET xceb201  = NVL(xcck201 ,0) * -1,
#         xceb202  = NVL(xcck202 ,0) * -1,
#         xceb202a = NVL(xcck202a,0) * -1,
#         xceb202b = NVL(xcck202b,0) * -1,
#         xceb202c = NVL(xcck202c,0) * -1,
#         xceb202d = NVL(xcck202d,0) * -1,
#         xceb202e = NVL(xcck202e,0) * -1,
#         xceb202f = NVL(xcck202f,0) * -1,
#         xceb202g = NVL(xcck202g,0) * -1,
#         xceb202h = NVL(xcck202h,0) * -1,
#         xceb212  = NVL(xcck212 ,0) * -1,
#         xceb212a = NVL(xcck212a,0) * -1,
#         xceb212b = NVL(xcck212b,0) * -1,
#         xceb212c = NVL(xcck212c,0) * -1,
#         xceb212d = NVL(xcck212d,0) * -1,
#         xceb212e = NVL(xcck212e,0) * -1,
#         xceb212f = NVL(xcck212f,0) * -1,
#         xceb212g = NVL(xcck212g,0) * -1,
#         xceb212h = NVL(xcck212h,0) * -1,
#         xceb222  = NVL(xcck222 ,0) * -1,
#         xceb222a = NVL(xcck222a,0) * -1,
#         xceb222b = NVL(xcck222b,0) * -1,
#         xceb222c = NVL(xcck222c,0) * -1,
#         xceb222d = NVL(xcck222d,0) * -1,
#         xceb222e = NVL(xcck222e,0) * -1,
#         xceb222f = NVL(xcck222f,0) * -1,
#         xceb222g = NVL(xcck222g,0) * -1,
#         xceb222h = NVL(xcck222h,0) * -1
#170306-00063#1 mark end   -----
         
   #部门
   UPDATE sourse_ins_tmp1                
     SET xcec108 = (SELECT xmdk008 
                      FROM xmdk_t
                     WHERE xmdkent = g_enterprise
                       AND xmdkdocno = xcec001)
                       
   #抓取科目   
   UPDATE sourse_ins_tmp1
      SET sfaasite = (SELECT imag011 FROM imag_t
                       WHERE imagent = g_enterprise AND imagsite = g_xcea_m.xceacomp
                         AND imag001 = xcec004)    
   
   UPDATE sourse_ins_tmp1 
      SET xcec101 = (SELECT DISTINCT glcc002 FROM glcc_t 
                      WHERE glccent = g_enterprise
                        AND glcc001 = '1'  
                        AND glccld  = g_xcea_m.xceald
                        AND (glcc014= g_xcea_m.xceacomp OR glcc014='*' )
                        AND (glcc016=xcec004 OR glcc016 = '*')
                        AND (glcc011=sfaasite OR glcc011='*')
                        AND rownum = 1)   
    WHERE xcec101 IS NULL OR xcec101 = ' '

  #170221-00041#1 add start -----
  #有發出商品科目改抓發出商品科目
  UPDATE sourse_ins_tmp1
     SET xcec101 = (SELECT DISTINCT glcc006 FROM glcc_t
                     WHERE glccent = g_enterprise
                       AND glcc001 = '1'
                       AND glccld  = g_xcea_m.xceald
                       AND (glcc014= g_xcea_m.xceacomp OR glcc014='*' )
                       AND (glcc016=xcec004 OR glcc016 = '*')
                       AND (glcc011=sfaasite OR glcc011='*')
                       AND rownum = 1)
   WHERE EXISTS(SELECT 1 FROM xckb_t
                 WHERE xckbent = g_enterprise AND xckbld = g_xcea_m.xceald
                   AND xckb005 = xcec001 AND xckb006 = xcec002
                   AND xckbent = xcecent AND xckbcomp = xceccomp AND xckbld = xcecld)
  #170221-00041#1 add end   -----
  
  #启用交易对象
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad010 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad010 = 'N'  ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec111 = ' '"
   PREPARE axct701_6_upd_xcec111 FROM g_sql
   EXECUTE axct701_6_upd_xcec111

  #启用客群
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad011 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad011 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec112 = ' '"
   PREPARE axct701_6_upd_xcec112 FROM g_sql
   EXECUTE axct701_6_upd_xcec112

  #启用区域
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad009 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad009 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec113 = ' '"
   PREPARE axct701_6_upd_xcec113 FROM g_sql
   EXECUTE axct701_6_upd_xcec113

   
  #启用成本中心
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad008 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad008 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec114 = ' '"
   PREPARE axct701_6_upd_xcec114 FROM g_sql
   EXECUTE axct701_6_upd_xcec114
   
  #启用经营类别
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad031 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad031 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec115 = ' '"
   PREPARE axct701_6_upd_xcec115 FROM g_sql
   EXECUTE axct701_6_upd_xcec115
 
  #启用渠道
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad032 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad032 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec116 = ' '"
   PREPARE axct701_6_upd_xcec116 FROM g_sql
   EXECUTE axct701_6_upd_xcec116

  #启用品类
  #170221-00041#1 add start ----
   UPDATE sourse_ins_tmp1 
      SET xcec117 = (SELECT imag011 FROM imag_t 
                      WHERE imagent = xcecent 
                        AND imagsite = g_xcea_m.xceacomp
                        AND imag001 = xcec004) 
  #170221-00041#1 add end   ----  
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad012 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad012 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec117 = ' '"
   PREPARE axct701_6_upd_xcec117 FROM g_sql
   EXECUTE axct701_6_upd_xcec117
   
  #启用品牌
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad033 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad033 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec118 = ' '"
   PREPARE axct701_6_upd_xcec118 FROM g_sql
   EXECUTE axct701_6_upd_xcec118
 
  #启用项目号
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad015 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad015 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec119 = ' '"
   PREPARE axct701_6_upd_xcec119 FROM g_sql
   EXECUTE axct701_6_upd_xcec119
 
  #启用WBS
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad016 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad016 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec120 = ' '"
   PREPARE axct701_6_upd_xcec120 FROM g_sql
   EXECUTE axct701_6_upd_xcec120
 
  #启用人员
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad013 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad013 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec107 = ' '"
   PREPARE axct701_6_upd_xcec107 FROM g_sql
   EXECUTE axct701_6_upd_xcec107
 
  #启用部门
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad007 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad007 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec108 = ' '"
   PREPARE axct701_6_upd_xcec108 FROM g_sql
   EXECUTE axct701_6_upd_xcec108
   
  #启用账款对象
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad027 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad027 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec109 = ' '"
   PREPARE axct701_6_upd_xcec109 FROM g_sql
   EXECUTE axct701_6_upd_xcec109
   
  #启用自由核算项1
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad017 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad017 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec121 = ' '"
   PREPARE axct701_6_upd_xcec121 FROM g_sql
   EXECUTE axct701_6_upd_xcec121
 
  #启用自由核算项2
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad018 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad018 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec122 = ' '"
   PREPARE axct701_6_upd_xcec122 FROM g_sql
   EXECUTE axct701_6_upd_xcec122
 
  #启用自由核算项3
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad019 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad019 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec123 = ' '"
   PREPARE axct701_6_upd_xcec123 FROM g_sql
   EXECUTE axct701_6_upd_xcec123

  #启用自由核算项4
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad019 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad019 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec124 = ' '"
   PREPARE axct701_6_upd_xcec124 FROM g_sql
   EXECUTE axct701_6_upd_xcec124

  #启用自由核算项5
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad021 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad021 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec125 = ' '"
   PREPARE axct701_6_upd_xcec125 FROM g_sql
   EXECUTE axct701_6_upd_xcec125

  #启用自由核算项6
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad022 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad022 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec126 = ' '"
   PREPARE axct701_6_upd_xcec126 FROM g_sql
   EXECUTE axct701_6_upd_xcec126

  #启用自由核算项7
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad023 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad023 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec127 = ' '"
   PREPARE axct701_6_upd_xcec127 FROM g_sql
   EXECUTE axct701_6_upd_xcec127

  #启用自由核算项8
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad024 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad024 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec128 = ' '"
   PREPARE axct701_6_upd_xcec128 FROM g_sql
   EXECUTE axct701_6_upd_xcec128

  #启用自由核算项9
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad025 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad025 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec129 = ' '"
   PREPARE axct701_6_upd_xcec129 FROM g_sql
   EXECUTE axct701_6_upd_xcec129

  #启用自由核算项10
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad026 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad026 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec130 = ' '"
   PREPARE axct701_6_upd_xcec130 FROM g_sql
   EXECUTE axct701_6_upd_xcec130
   
  #特性
   UPDATE sourse_ins_tmp1 SET xcec005 = ' ' WHERE xcec005 IS NULL
 #科目编号
   UPDATE sourse_ins_tmp1 SET xcec101 = ' ' WHERE xcec101 IS NULL
  #摘要
   UPDATE sourse_ins_tmp1 SET xcec102 = ' ' WHERE xcec102 IS NULL
  #成本域
   UPDATE sourse_ins_tmp1 SET xcec103 = ' ' WHERE xcec103 IS NULL
  #原因码
   UPDATE sourse_ins_tmp1 SET xcec110 = ' ' WHERE xcec110 IS NULL
  #交易对象
   UPDATE sourse_ins_tmp1 SET xcec111 = ' ' WHERE xcec111 IS NULL
  #客群
   UPDATE sourse_ins_tmp1 SET xcec112 = ' ' WHERE xcec112 IS NULL
  #区域
   UPDATE sourse_ins_tmp1 SET xcec113 = ' ' WHERE xcec113 IS NULL
  #成本中心
   UPDATE sourse_ins_tmp1 SET xcec114 = ' ' WHERE xcec114 IS NULL
  #经营类别
   UPDATE sourse_ins_tmp1 SET xcec115 = ' ' WHERE xcec115 IS NULL
  #渠道
   UPDATE sourse_ins_tmp1 SET xcec116 = ' ' WHERE xcec116 IS NULL
  #品类
   UPDATE sourse_ins_tmp1 SET xcec117 = ' ' WHERE xcec117 IS NULL
  #品牌
   UPDATE sourse_ins_tmp1 SET xcec118 = ' ' WHERE xcec118 IS NULL
  #项目号
   UPDATE sourse_ins_tmp1 SET xcec119 = ' ' WHERE xcec119 IS NULL
  #WBS
   UPDATE sourse_ins_tmp1 SET xcec120 = ' ' WHERE xcec120 IS NULL
  #人员
   UPDATE sourse_ins_tmp1 SET xcec107 = ' ' WHERE xcec107 IS NULL
   #部门
   UPDATE sourse_ins_tmp1 SET xcec108 = ' ' WHERE xcec108 IS NULL
  #账款对象
   UPDATE sourse_ins_tmp1 SET xcec109 = ' ' WHERE xcec109 IS NULL
  #自由核算项1
   UPDATE sourse_ins_tmp1 SET xcec121 = ' ' WHERE xcec121 IS NULL
  #自由核算项2
   UPDATE sourse_ins_tmp1 SET xcec122 = ' ' WHERE xcec122 IS NULL
  #自由核算项3
   UPDATE sourse_ins_tmp1 SET xcec123 = ' ' WHERE xcec123 IS NULL
  #自由核算项4
   UPDATE sourse_ins_tmp1 SET xcec124 = ' ' WHERE xcec124 IS NULL
  #自由核算项5
   UPDATE sourse_ins_tmp1 SET xcec125 = ' ' WHERE xcec125 IS NULL
  #自由核算项6
   UPDATE sourse_ins_tmp1 SET xcec126 = ' ' WHERE xcec126 IS NULL
   #自由核算项7
   UPDATE sourse_ins_tmp1 SET xcec127 = ' ' WHERE xcec127 IS NULL
  #自由核算项8
   UPDATE sourse_ins_tmp1 SET xcec128 = ' ' WHERE xcec128 IS NULL
  #自由核算项9
   UPDATE sourse_ins_tmp1 SET xcec129 = ' ' WHERE xcec129 IS NULL
  #自由核算项10
   UPDATE sourse_ins_tmp1 SET xcec130 = ' ' WHERE xcec130 IS NULL

   INSERT INTO xcec_t (xcecent,xceccomp,xcecld,xcecdocno,xcecseq,
                       xcec001,xcec002,xcec003,xcec004,xcec005,xcec101,xcec102,xcec103,xcec110,xcec111,
                       xcec112,xcec113,xcec114,xcec115,xcec116,xcec117,xcec118,xcec119,xcec120,xcec201,
                       xcec202,xcec202a,xcec202b,xcec202c,xcec202d,xcec202e,xcec202f,xcec202g,xcec202h,
                       xcec212,xcec212a,xcec212b,xcec212c,xcec212d,xcec212e,xcec212f,xcec212g,xcec212h,
                       xcec222,xcec222a,xcec222b,xcec222c,xcec222d,xcec222e,xcec222f,xcec222g,xcec222h,
                       xcec301,xcec302,xcec107,xcec108,xcec109,xcec121,xcec122,xcec123,xcec124,xcec125,
                       xcec126,xcec127,xcec128,xcec129,xcec130)
         SELECT xcecent,xceccomp,xcecld,xcecdocno,xcecseq,
                xcec001,xcec002,xcec003,xcec004,xcec005,xcec101,xcec102,xcec103,xcec110,xcec111,
                xcec112,xcec113,xcec114,xcec115,xcec116,xcec117,xcec118,xcec119,xcec120,xcec201,
                xcec202,xcec202a,xcec202b,xcec202c,xcec202d,xcec202e,xcec202f,xcec202g,xcec202h,
                xcec212,xcec212a,xcec212b,xcec212c,xcec212d,xcec212e,xcec212f,xcec212g,xcec212h,
                xcec222,xcec222a,xcec222b,xcec222c,xcec222d,xcec222e,xcec222f,xcec222g,xcec222h,
                xcec301,xcec302,xcec107,xcec108,xcec109,xcec121,xcec122,xcec123,xcec124,xcec125,
                xcec126,xcec127,xcec128,xcec129,xcec130
           FROM sourse_ins_tmp1
   DELETE FROM sourse_ins_tmp1; 
   RETURN g_success
END FUNCTION

################################################################################
# Descriptions...: axct707    6.雜項進出憑證   axct707
# Memo...........:
# Usage..........: CALL axct701_01_ins_7()
# Input parameter:  
# Return code....:  
# Date & Author..: 2017/1/20 By 02295
# Modify.........: #170105-00011#5
################################################################################
PRIVATE FUNCTION axct701_01_ins_7()
DEFINE l_xcea          RECORD  #工單發料成本憑證單頭檔
       xceaent LIKE xcea_t.xceaent, #企業編號
       xceacomp LIKE xcea_t.xceacomp, #法人組織
       xceald LIKE xcea_t.xceald, #帳套
       xceadocno LIKE xcea_t.xceadocno, #單據編號
       xcea001 LIKE xcea_t.xcea001, #單據日期
       xcea002 LIKE xcea_t.xcea002, #成本憑證類型
       xcea003 LIKE xcea_t.xcea003, #成本計算類型
       xcea004 LIKE xcea_t.xcea004, #年度
       xcea005 LIKE xcea_t.xcea005, #期別
       xcea006 LIKE xcea_t.xcea006, #帳務人員
       xcea007 LIKE xcea_t.xcea007, #帳務部門
       xcea101 LIKE xcea_t.xcea101, #憑證編號
       xcea102 LIKE xcea_t.xcea102, #憑證日期
       xceaownid LIKE xcea_t.xceaownid, #資料所有者
       xceaowndp LIKE xcea_t.xceaowndp, #資料所屬部門
       xceacrtid LIKE xcea_t.xceacrtid, #資料建立者
       xceacrtdp LIKE xcea_t.xceacrtdp, #資料建立部門
       xceacrtdt LIKE xcea_t.xceacrtdt, #資料創建日
       xceamodid LIKE xcea_t.xceamodid, #資料修改者
       xceamoddt LIKE xcea_t.xceamoddt, #最近修改日
       xceacnfid LIKE xcea_t.xceacnfid, #資料確認者
       xceacnfdt LIKE xcea_t.xceacnfdt, #資料確認日
       xceapstid LIKE xcea_t.xceapstid, #資料過帳者
       xceapstdt LIKE xcea_t.xceapstdt, #資料過帳日
       xceastus LIKE xcea_t.xceastus, #狀態碼
       xceaud001 LIKE xcea_t.xceaud001, #自定義欄位(文字)001
       xceaud002 LIKE xcea_t.xceaud002, #自定義欄位(文字)002
       xceaud003 LIKE xcea_t.xceaud003, #自定義欄位(文字)003
       xceaud004 LIKE xcea_t.xceaud004, #自定義欄位(文字)004
       xceaud005 LIKE xcea_t.xceaud005, #自定義欄位(文字)005
       xceaud006 LIKE xcea_t.xceaud006, #自定義欄位(文字)006
       xceaud007 LIKE xcea_t.xceaud007, #自定義欄位(文字)007
       xceaud008 LIKE xcea_t.xceaud008, #自定義欄位(文字)008
       xceaud009 LIKE xcea_t.xceaud009, #自定義欄位(文字)009
       xceaud010 LIKE xcea_t.xceaud010, #自定義欄位(文字)010
       xceaud011 LIKE xcea_t.xceaud011, #自定義欄位(數字)011
       xceaud012 LIKE xcea_t.xceaud012, #自定義欄位(數字)012
       xceaud013 LIKE xcea_t.xceaud013, #自定義欄位(數字)013
       xceaud014 LIKE xcea_t.xceaud014, #自定義欄位(數字)014
       xceaud015 LIKE xcea_t.xceaud015, #自定義欄位(數字)015
       xceaud016 LIKE xcea_t.xceaud016, #自定義欄位(數字)016
       xceaud017 LIKE xcea_t.xceaud017, #自定義欄位(數字)017
       xceaud018 LIKE xcea_t.xceaud018, #自定義欄位(數字)018
       xceaud019 LIKE xcea_t.xceaud019, #自定義欄位(數字)019
       xceaud020 LIKE xcea_t.xceaud020, #自定義欄位(數字)020
       xceaud021 LIKE xcea_t.xceaud021, #自定義欄位(日期時間)021
       xceaud022 LIKE xcea_t.xceaud022, #自定義欄位(日期時間)022
       xceaud023 LIKE xcea_t.xceaud023, #自定義欄位(日期時間)023
       xceaud024 LIKE xcea_t.xceaud024, #自定義欄位(日期時間)024
       xceaud025 LIKE xcea_t.xceaud025, #自定義欄位(日期時間)025
       xceaud026 LIKE xcea_t.xceaud026, #自定義欄位(日期時間)026
       xceaud027 LIKE xcea_t.xceaud027, #自定義欄位(日期時間)027
       xceaud028 LIKE xcea_t.xceaud028, #自定義欄位(日期時間)028
       xceaud029 LIKE xcea_t.xceaud029, #自定義欄位(日期時間)029
       xceaud030 LIKE xcea_t.xceaud030, #自定義欄位(日期時間)030
       xceasite LIKE xcea_t.xceasite  #營運據點
          END RECORD
DEFINE ld_date         DATETIME YEAR TO SECOND
DEFINE l_success       LIKE type_t.num5
         

  #CALL axct701_01_create_tmp()    #170324-00054#1 mark
   
   LET g_success = 'Y'
   LET l_xcea.xceaownid = g_user
   LET l_xcea.xceaowndp = g_dept
   LET l_xcea.xceacrtid = g_user
   LET l_xcea.xceacrtdp = g_dept 
   LET ld_date  = cl_get_current()
   LET l_xcea.xceacrtdt = ld_date
   LET l_xcea.xceamodid = ""
   LET l_xcea.xceamoddt = ""
   CALL s_aooi200_fin_gen_docno(g_xcea_m.xceald,'','',g_xcea_m.xceadocno,g_xcea_m.xcea001,g_prog_name1)      #wujie 150214
    RETURNING l_success,g_xcea_m.xceadocno
   IF l_success  = 0  THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = 'apm-00003'
      LET g_errparam.extend = g_xcea_m.xceadocno
      LET g_errparam.popup = TRUE
      CALL cl_err()

      LET g_success = 'N'
      RETURN g_success
   END IF
   
   INSERT INTO xcea_t (xceaent,xceald,xceacomp,xcea006,xceadocno,xcea001,xcea002,xcea004, 
       xcea005,xcea003,xceastus,xceaownid,xceaowndp,xceacrtid,xceacrtdp,xceacrtdt, 
       xceamodid,xceamoddt)
   VALUES (g_enterprise,g_xcea_m.xceald,g_xcea_m.xceacomp,g_xcea_m.xcea006,g_xcea_m.xceadocno, 
       g_xcea_m.xcea001,g_xcea002,g_xcea_m.xcea004,g_xcea_m.xcea005,g_xcea_m.xcea003, 
       'N',l_xcea.xceaownid,l_xcea.xceaowndp,l_xcea.xceacrtid, 
       l_xcea.xceacrtdp,ld_date,l_xcea.xceamodid,l_xcea.xceamoddt) 
       
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "g_xcea_m"
      LET g_errparam.popup = TRUE
      CALL cl_err()
  
      LET g_success = 'N'
      RETURN g_success
   END IF

   ###INS xceb_t###
   DELETE FROM sourse_ins_tmp;
   LET g_sql = " INSERT INTO sourse_ins_tmp ",
               "  (xcebent,xcebcomp,xcebld,xcebdocno,xcebseq,",
               "   xceb001,xceb002,xceb003,xceb004,xceb005,",
               "   xceb101,xceb102,xceb103,xceb110,xceb111,",
               "   xceb112,xceb113,xceb114,xceb115,xceb116,",
               "   xceb117,xceb118,xceb119,xceb120,xceb201,",
               "   xceb202,xceb202a,xceb202b,xceb202c,xceb202d,xceb202e,xceb202f,xceb202g,xceb202h,",
               "   xceb212,xceb212a,xceb212b,xceb212c,xceb212d,xceb212e,xceb212f,xceb212g,xceb212h,",
               "   xceb222,xceb222a,xceb222b,xceb222c,xceb222d,xceb222e,xceb222f,xceb222g,xceb222h,",
               "   xceb301,xceb302,xceb107,xceb108,xceb109,",
               "   xceb121,xceb122,xceb123,xceb124,xceb125,",
               "   xceb126,xceb127,xceb128,xceb129,xceb130,",
               "   xceb131,xceb132,sfaa009,sfaasite,sfaa028,",
               "   sfaa029,sfaa052,sfaa057) ",  
               " SELECT ",g_enterprise,",'",g_xcea_m.xceacomp,"','",g_xcea_m.xceald,"','",g_xcea_m.xceadocno,"',rownum,",
               "        xcck006,xcck007,(CASE WHEN xcck009 = -1 THEN '5' WHEN xcck009 = 1 THEN '6' END),xcck010 ,xcck011,",
               "        xcck033,(SELECT glab010 FROM glab_t WHERE glabld  = '",g_xcea_m.xceald,"' AND glab001 = '61' AND glab002 = '8925' AND glab003 = '7' AND glabent = ",g_enterprise,") xceb102,xcck002,xcck021,xcck022, ",
               "        xcck023,xcck024,xcck025,xcck026,xcck027,",
               "        xcck028,xcck029,xcck030,xcck031,xcck201,",
               "        xcck202,xcck202a,xcck202b,xcck202c,xcck202d,xcck202e,xcck202f,xcck202g,xcck202h,",
               "        0,0,0,0,0,0,0,0,0,",
               "        0,0,0,0,0,0,0,0,0,",
               #"        '','','','','', ", #170214-00014#1 mark
               "        '','','','',xcck022, ", #170214-00014#1 add               
               "        '','','','','', ",             
               "        '','','','','', ",             
               "        '','','','','', ",             
               "        '','','' ",    
               "   FROM (",
               "         SELECT xcck002,xcck006,xcck007, ",
               "                xcck010,xcck011,xcck009,xcck021,xcck022,xcck023,xcck024,xcck025,xcck026,xcck027,xcck028,",  
               "                xcck029,xcck030,xcck031,xcck033,SUM(xcck009*xcck201) xcck201,SUM(xcck009*xcck202) xcck202, ",
               "                SUM(xcck009*xcck202a) xcck202a,SUM(xcck009*xcck202b) xcck202b,SUM(xcck009*xcck202c) xcck202c,SUM(xcck009*xcck202d) xcck202d,",
               "                SUM(xcck009*xcck202e) xcck202e,SUM(xcck009*xcck202f) xcck202f,SUM(xcck009*xcck202g) xcck202g,SUM(xcck009*xcck202h) xcck202h ",
               "                FROM xcck_t ", 
               "          WHERE xcckent = '",g_enterprise,"' AND xcckld = '",g_xcea_m.xceald,"'",
               "            AND xcck003 = '",g_xcea_m.xcea003,"' AND xcck004 = ",g_xcea_m.xcea004,
               "            AND xcck005 = ",g_xcea_m.xcea005,
               "            AND xcck001 = '1' ",
               "            AND xcck020 IN ('101','301','304') ",     
               "         GROUP BY xcck002,xcck006,xcck007,xcck010,xcck011,xcck009,xcck021,xcck022,xcck023,xcck024,xcck025,xcck026,xcck027,xcck028,xcck029,xcck030,xcck031,xcck033",  
               "         ORDER BY xcck002,xcck006,xcck007,xcck010,xcck011,xcck009,xcck021,xcck022,xcck023,xcck024,xcck025,xcck026,xcck027,xcck028,xcck029,xcck030,xcck031,xcck033)" 
   PREPARE axct701_7_ins_xceb_01 FROM g_sql
   EXECUTE axct701_7_ins_xceb_01
   
   #更新本位币二金额
   LET g_sql = " MERGE INTO sourse_ins_tmp                               ",
               " USING (SELECT xcck002,xcck006,xcck007,xcck010,xcck011,",
               "               xcck009,xcck021,xcck022,xcck023,xcck024,",
               "               xcck025,xcck026,xcck027,xcck028,xcck029,",
               "               xcck030,xcck031,xcck033,",
               "               SUM(xcck009*xcck202) xcck202, ",
               "               SUM(xcck009*xcck202a) xcck202a,SUM(xcck009*xcck202b) xcck202b,SUM(xcck009*xcck202c) xcck202c,SUM(xcck009*xcck202d) xcck202d,",
               "               SUM(xcck009*xcck202e) xcck202e,SUM(xcck009*xcck202f) xcck202f,SUM(xcck009*xcck202g) xcck202g,SUM(xcck009*xcck202h) xcck202h ",
               "          FROM xcck_t ", 
               "         WHERE xcckent = '",g_enterprise,"' AND xcckld = '",g_xcea_m.xceald,"'",
               "           AND xcck003 = '",g_xcea_m.xcea003,"' AND xcck004 = ",g_xcea_m.xcea004,
               "           AND xcck005 = ",g_xcea_m.xcea005,
               "           AND xcck020 IN ('101','301','304')",
               "           AND xcck001 = '2' ", 
               "         GROUP BY xcck002,xcck006,xcck007,xcck010,xcck011,xcck009,xcck021,xcck022,xcck023,xcck024,xcck025,xcck026,xcck027,xcck028,xcck029,xcck030,xcck031,xcck033 )",               
               "    ON (xceb001 = xcck006 ",
               "        AND xceb002 = xcck007 ", 
               "        AND xceb110 = xcck021 ",
               "        AND (CASE xcck009 WHEN -1 THEN xceb003 = '5' WHEN  1 THEN xceb003 = '6' END) ",
               "        AND xceb103 = xcck002", 
               "        AND xceb004 = xcck010", 
               "        AND xceb005 = xcck011", 
               "        AND xceb110 = xcck021", 
               "        AND xceb111 = xcck022",      
               "        AND xceb112 = xcck023", 
               "        AND xceb113 = xcck024", 
               "        AND xceb114 = xcck025",      
               "        AND xceb115 = xcck026", 
               "        AND xceb116 = xcck027", 
               "        AND xceb117 = xcck028", 
               "        AND xceb118 = xcck029", 
               "        AND xceb119 = xcck030", 
               "        AND xceb120 = xcck031", 
               "        AND xceb101 = xcck033)",                 
               "  WHEN MATCHED THEN ",
               "UPDATE SET xceb212  = xcck202 ,",
               "           xceb212a = xcck202a,",
               "           xceb212b = xcck202b,",
               "           xceb212c = xcck202c,",
               "           xceb212d = xcck202d,",
               "           xceb212e = xcck202e,",
               "           xceb212f = xcck202f,",
               "           xceb212g = xcck202g,",
               "           xceb212h = xcck202h "
   PREPARE axct701_7_upd_xceb212 FROM g_sql
   EXECUTE axct701_7_upd_xceb212

   #更新本位币三金额
   LET g_sql = " MERGE INTO sourse_ins_tmp                               ",
               " USING (SELECT xcck002,xcck006,xcck007,xcck010,xcck011,",
               "               xcck009,xcck021,xcck022,xcck023,xcck024,",
               "               xcck025,xcck026,xcck027,xcck028,xcck029,",
               "               xcck030,xcck031,xcck033,",
               "               SUM(xcck009*xcck202) xcck202, ",
               "               SUM(xcck009*xcck202a) xcck202a,SUM(xcck009*xcck202b) xcck202b,SUM(xcck009*xcck202c) xcck202c,SUM(xcck009*xcck202d) xcck202d,",
               "               SUM(xcck009*xcck202e) xcck202e,SUM(xcck009*xcck202f) xcck202f,SUM(xcck009*xcck202g) xcck202g,SUM(xcck009*xcck202h) xcck202h ",
               "          FROM xcck_t ", 
               "         WHERE xcckent = '",g_enterprise,"' AND xcckld = '",g_xcea_m.xceald,"'",
               "           AND xcck003 = '",g_xcea_m.xcea003,"' AND xcck004 = ",g_xcea_m.xcea004,
               "           AND xcck005 = ",g_xcea_m.xcea005,
               "           AND xcck020 IN ('101','301','304')",
               "           AND xcck001 = '3' " ,
               "         GROUP BY xcck002,xcck006,xcck007,xcck010,xcck011,xcck009,xcck021,xcck022,xcck023,xcck024,xcck025,xcck026,xcck027,xcck028,xcck029,xcck030,xcck031,xcck033 )" ,              
               "    ON (xceb001 = xcck006 ",
               "        AND xceb002 = xcck007 ", 
               "        AND xceb110 = xcck021 ",
               "        AND (CASE xcck009 WHEN -1 THEN xceb003 = '5' WHEN  1 THEN xceb003 = '6' END) ",
               "        AND xceb103 = xcck002", 
               "        AND xceb004 = xcck010", 
               "        AND xceb005 = xcck011", 
               "        AND xceb110 = xcck021", 
               "        AND xceb111 = xcck022",      
               "        AND xceb112 = xcck023", 
               "        AND xceb113 = xcck024", 
               "        AND xceb114 = xcck025",      
               "        AND xceb115 = xcck026", 
               "        AND xceb116 = xcck027", 
               "        AND xceb117 = xcck028", 
               "        AND xceb118 = xcck029", 
               "        AND xceb119 = xcck030", 
               "        AND xceb120 = xcck031", 
               "        AND xceb101 = xcck033)",                 
               "  WHEN MATCHED THEN ",
               "UPDATE SET xceb222  = xcck202 ,",
               "           xceb222a = xcck202a,",
               "           xceb222b = xcck202b,",
               "           xceb222c = xcck202c,",
               "           xceb222d = xcck202d,",
               "           xceb222e = xcck202e,",
               "           xceb222f = xcck202f,",
               "           xceb222g = xcck202g,",
               "           xceb222h = xcck202h "
   PREPARE axct701_7_upd_xceb222 FROM g_sql
   EXECUTE axct701_7_upd_xceb222

  #170213-00053#1 ---add (s)---    
   UPDATE sourse_ins_tmp 
      SET xceb108 = (SELECT inba004
                       FROM inba_t
                      WHERE inbaent = g_enterprise
                        AND inbadocno = xceb001)
  #170213-00053#1 ---add (e)---     

   UPDATE sourse_ins_tmp                
     SET sfaa028 = (SELECT ooeg008 
                      FROM ooeg_t
                     WHERE ooegent = g_enterprise
                      #AND ooeg001 = xceb114 #170213-00053#1 mark
                       AND ooeg001 = xceb108 #170213-00053#1 add
                       AND ooegstus = 'Y')
   UPDATE sourse_ins_tmp                
      SET xceb101 = (SELECT DISTINCT (CASE WHEN sfaa028='1' THEN glab005 WHEN sfaa028='2' THEN glab006 WHEN sfaa028='3' THEN glab007 WHEN sfaa028='4' THEN glab008 END)  
                       FROM glab_t
                      WHERE glabent = g_enterprise
                        AND glabld = g_xcea_m.xceald
                        AND glab001 = '11'
                        AND glab002 = '216'
                        AND glab003 = xceb110)
    WHERE xceb101 IS NULL OR xceb101 = ' '
    
   UPDATE sourse_ins_tmp                
     SET sfaa028 = ''

   UPDATE sourse_ins_tmp 
      SET xceb101 = (SELECT glab005
                      FROM glab_t
                     WHERE glabld  = g_xcea_m.xceald
                       AND glab001 = '60'
                       AND glab002 = '8912'
                       AND glab003 = '7'
                       AND glabent = g_enterprise)
    WHERE xceb101 IS NULL OR xceb101 = ' '
  
  #170213-00053#1 ---mark (s)---    
  #UPDATE sourse_ins_tmp 
  #   SET xceb108 = (SELECT inba004
  #                    FROM inba_t
  #                   WHERE inbaent = g_enterprise
  #                     AND inbadocno = xceb001)
  #170213-00053#1 ---mark (e)---                              
                        
   UPDATE sourse_ins_tmp 
      SET xceb109 = (SELECT ooef024
                       FROM ooef_t
                      WHERE ooefent = g_enterprise
                        AND ooef001 = g_xcea_m.xceacomp)                        
                        
   UPDATE sourse_ins_tmp 
      SET xceb110 = (SELECT inba007
                       FROM inba_t
                      WHERE inbaent = g_enterprise
                        AND inbadocno = xceb001)
    WHERE xceb110 IS NULL   

  #启用交易对象
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad010 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad010 = 'N'  ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb111 = ' '"
   PREPARE axct701_7_upd_xceb111 FROM g_sql
   EXECUTE axct701_7_upd_xceb111

  #启用客群
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad011 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad011 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb112 = ' '"
   PREPARE axct701_7_upd_xceb112 FROM g_sql
   EXECUTE axct701_7_upd_xceb112

  #启用区域
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad009 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad009 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb113 = ' '"
   PREPARE axct701_7_upd_xceb113 FROM g_sql
   EXECUTE axct701_7_upd_xceb113

   
  #启用成本中心
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad008 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad008 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb114 = ' '"
   PREPARE axct701_7_upd_xceb114 FROM g_sql
   EXECUTE axct701_7_upd_xceb114
   
  #启用经营类别
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad031 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad031 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb115 = ' '"
   PREPARE axct701_7_upd_xceb115 FROM g_sql
   EXECUTE axct701_7_upd_xceb115
 
  #启用渠道
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad032 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad032 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb116 = ' '"
   PREPARE axct701_7_upd_xceb116 FROM g_sql
   EXECUTE axct701_7_upd_xceb116

  #启用品类
  #170221-00041#1 add start ----
   UPDATE sourse_ins_tmp 
      SET xceb117 = (SELECT imag011 FROM imag_t 
                      WHERE imagent = xcebent 
                        AND imagsite = g_xcea_m.xceacomp
                        AND imag001 = xceb004) 
  #170221-00041#1 add end   ----    
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad012 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad012 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb117 = ' '"
   PREPARE axct701_7_upd_xceb117 FROM g_sql
   EXECUTE axct701_7_upd_xceb117
   
  #启用品牌
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad033 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad033 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb118 = ' '"
   PREPARE axct701_7_upd_xceb118 FROM g_sql
   EXECUTE axct701_7_upd_xceb118
 
  #启用项目号
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad015 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad015 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb119 = ' '"
   PREPARE axct701_7_upd_xceb119 FROM g_sql
   EXECUTE axct701_7_upd_xceb119
 
  #启用WBS
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad016 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad016 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb120 = ' '"
   PREPARE axct701_7_upd_xceb120 FROM g_sql
   EXECUTE axct701_7_upd_xceb120
 
  #启用人员
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad013 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad013 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb107 = ' '"
   PREPARE axct701_7_upd_xceb107 FROM g_sql
   EXECUTE axct701_7_upd_xceb107
 
  #启用部门
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad007 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad007 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb108 = ' '"
   PREPARE axct701_7_upd_xceb108 FROM g_sql
   EXECUTE axct701_7_upd_xceb108
   
  #启用账款对象
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad027 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad027 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb109 = ' '"
   PREPARE axct701_7_upd_xceb109 FROM g_sql
   EXECUTE axct701_7_upd_xceb109
   
  #启用自由核算项1
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad017 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad017 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb121 = ' '"
   PREPARE axct701_7_upd_xceb121 FROM g_sql
   EXECUTE axct701_7_upd_xceb121
 
  #启用自由核算项2
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad018 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad018 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb122 = ' '"
   PREPARE axct701_7_upd_xceb122 FROM g_sql
   EXECUTE axct701_7_upd_xceb122
 
  #启用自由核算项3
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad019 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad019 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb123 = ' '"
   PREPARE axct701_7_upd_xceb123 FROM g_sql
   EXECUTE axct701_7_upd_xceb123

  #启用自由核算项4
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad019 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad019 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb124 = ' '"
   PREPARE axct701_7_upd_xceb124 FROM g_sql
   EXECUTE axct701_7_upd_xceb124

  #启用自由核算项5
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad021 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad021 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb125 = ' '"
   PREPARE axct701_7_upd_xceb125 FROM g_sql
   EXECUTE axct701_7_upd_xceb125

  #启用自由核算项6
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad022 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad022 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb126 = ' '"
   PREPARE axct701_7_upd_xceb126 FROM g_sql
   EXECUTE axct701_7_upd_xceb126

  #启用自由核算项7
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad023 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad023 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb127 = ' '"
   PREPARE axct701_7_upd_xceb127 FROM g_sql
   EXECUTE axct701_7_upd_xceb127

  #启用自由核算项8
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad024 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad024 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb128 = ' '"
   PREPARE axct701_7_upd_xceb128 FROM g_sql
   EXECUTE axct701_7_upd_xceb128

  #启用自由核算项9
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad025 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad025 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb129 = ' '"
   PREPARE axct701_7_upd_xceb129 FROM g_sql
   EXECUTE axct701_7_upd_xceb129

  #启用自由核算项10
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad026 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad026 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb130 = ' '"
   PREPARE axct701_7_upd_xceb130 FROM g_sql
   EXECUTE axct701_7_upd_xceb130
   
  #来源单项次
   #UPDATE sourse_ins_tmp SET xceb002 = ''    #170207-00058#1 mark
  #特性
   UPDATE sourse_ins_tmp SET xceb005 = ' ' WHERE xceb005 IS NULL
 #科目编号
   UPDATE sourse_ins_tmp SET xceb101 = ' ' WHERE xceb101 IS NULL
  #摘要
   UPDATE sourse_ins_tmp SET xceb102 = ' ' WHERE xceb102 IS NULL
  #成本域
   UPDATE sourse_ins_tmp SET xceb103 = ' ' WHERE xceb103 IS NULL
  #原因码
   UPDATE sourse_ins_tmp SET xceb110 = ' ' WHERE xceb110 IS NULL
  #交易对象
   UPDATE sourse_ins_tmp SET xceb111 = ' ' WHERE xceb111 IS NULL
  #客群
   UPDATE sourse_ins_tmp SET xceb112 = ' ' WHERE xceb112 IS NULL
  #区域
   UPDATE sourse_ins_tmp SET xceb113 = ' ' WHERE xceb113 IS NULL
  #成本中心
   UPDATE sourse_ins_tmp SET xceb114 = ' ' WHERE xceb114 IS NULL
  #经营类别
   UPDATE sourse_ins_tmp SET xceb115 = ' ' WHERE xceb115 IS NULL
  #渠道
   UPDATE sourse_ins_tmp SET xceb116 = ' ' WHERE xceb116 IS NULL
  #品类
   UPDATE sourse_ins_tmp SET xceb117 = ' ' WHERE xceb117 IS NULL
  #品牌
   UPDATE sourse_ins_tmp SET xceb118 = ' ' WHERE xceb118 IS NULL
  #项目号
   UPDATE sourse_ins_tmp SET xceb119 = ' ' WHERE xceb119 IS NULL
  #WBS
   UPDATE sourse_ins_tmp SET xceb120 = ' ' WHERE xceb120 IS NULL
  #人员
   UPDATE sourse_ins_tmp SET xceb107 = ' ' WHERE xceb107 IS NULL
   #部门
   UPDATE sourse_ins_tmp SET xceb108 = ' ' WHERE xceb108 IS NULL
  #账款对象
   UPDATE sourse_ins_tmp SET xceb109 = ' ' WHERE xceb109 IS NULL
  #自由核算项1
   UPDATE sourse_ins_tmp SET xceb121 = ' ' WHERE xceb121 IS NULL
  #自由核算项2
   UPDATE sourse_ins_tmp SET xceb122 = ' ' WHERE xceb122 IS NULL
  #自由核算项3
   UPDATE sourse_ins_tmp SET xceb123 = ' ' WHERE xceb123 IS NULL
  #自由核算项4
   UPDATE sourse_ins_tmp SET xceb124 = ' ' WHERE xceb124 IS NULL
  #自由核算项5
   UPDATE sourse_ins_tmp SET xceb125 = ' ' WHERE xceb125 IS NULL
  #自由核算项6
   UPDATE sourse_ins_tmp SET xceb126 = ' ' WHERE xceb126 IS NULL
   #自由核算项7
   UPDATE sourse_ins_tmp SET xceb127 = ' ' WHERE xceb127 IS NULL
  #自由核算项8
   UPDATE sourse_ins_tmp SET xceb128 = ' ' WHERE xceb128 IS NULL
  #自由核算项9
   UPDATE sourse_ins_tmp SET xceb129 = ' ' WHERE xceb129 IS NULL
  #自由核算项10
   UPDATE sourse_ins_tmp SET xceb130 = ' ' WHERE xceb130 IS NULL

   INSERT INTO xceb_t (xcebent,xcebcomp,xcebld,xcebdocno,xcebseq,
                       xceb001,xceb002,xceb003,xceb004,xceb005,xceb101,xceb102,xceb103,xceb110,xceb111,
                       xceb112,xceb113,xceb114,xceb115,xceb116,xceb117,xceb118,xceb119,xceb120,xceb201,
                       xceb202,xceb202a,xceb202b,xceb202c,xceb202d,xceb202e,xceb202f,xceb202g,xceb202h,
                       xceb212,xceb212a,xceb212b,xceb212c,xceb212d,xceb212e,xceb212f,xceb212g,xceb212h,
                       xceb222,xceb222a,xceb222b,xceb222c,xceb222d,xceb222e,xceb222f,xceb222g,xceb222h,
                       xceb301,xceb302,xceb107,xceb108,xceb109,xceb121,xceb122,xceb123,xceb124,xceb125,
                       xceb126,xceb127,xceb128,xceb129,xceb130,xceb131,xceb132)
         SELECT xcebent,xcebcomp,xcebld,xcebdocno,xcebseq,
                xceb001,xceb002,xceb003,xceb004,xceb005,xceb101,xceb102,xceb103,xceb110,xceb111,
                xceb112,xceb113,xceb114,xceb115,xceb116,xceb117,xceb118,xceb119,xceb120,xceb201,
                xceb202,xceb202a,xceb202b,xceb202c,xceb202d,xceb202e,xceb202f,xceb202g,xceb202h,
                xceb212,xceb212a,xceb212b,xceb212c,xceb212d,xceb212e,xceb212f,xceb212g,xceb212h,
                xceb222,xceb222a,xceb222b,xceb222c,xceb222d,xceb222e,xceb222f,xceb222g,xceb222h,
                xceb301,xceb302,xceb107,xceb108,xceb109,xceb121,xceb122,xceb123,xceb124,xceb125,
                xceb126,xceb127,xceb128,xceb129,xceb130,xceb131,xceb132
           FROM sourse_ins_tmp
   DELETE FROM sourse_ins_tmp;   

   ###INS xcec_t###
   DELETE FROM sourse_ins_tmp1;
   LET g_sql = " INSERT INTO sourse_ins_tmp1 ",
               "  (xcecent,xceccomp,xcecld,xcecdocno,xcecseq,",
               "   xcec001,xcec002,xcec003,xcec004,xcec005,",
               "   xcec101,xcec102,xcec103,xcec110,xcec111,",
               "   xcec112,xcec113,xcec114,xcec115,xcec116,",
               "   xcec117,xcec118,xcec119,xcec120,xcec201,",
               "   xcec202,xcec202a,xcec202b,xcec202c,xcec202d,xcec202e,xcec202f,xcec202g,xcec202h,",
               "   xcec212,xcec212a,xcec212b,xcec212c,xcec212d,xcec212e,xcec212f,xcec212g,xcec212h,",
               "   xcec222,xcec222a,xcec222b,xcec222c,xcec222d,xcec222e,xcec222f,xcec222g,xcec222h,",
               "   xcec301,xcec302,xcec107,xcec108,xcec109,",
               "   xcec121,xcec122,xcec123,xcec124,xcec125,",
               "   xcec126,xcec127,xcec128,xcec129,xcec130,",
               "   sfaa009,sfaasite,sfaa028,",
               "   sfaa029,sfaa052,sfaa057) ",  
               " SELECT ",g_enterprise,",'",g_xcea_m.xceacomp,"','",g_xcea_m.xceald,"','",g_xcea_m.xceadocno,"',rownum,",
               "        xcck006,xcck007,(CASE WHEN xcck009 = -1 THEN '5' WHEN xcck009 = 1 THEN '6' END),xcck010 ,xcck011,",
               #"        xcck032,(SELECT glab010 FROM glab_t WHERE glabld  = '",g_xcea_m.xceald,"' AND glab001 = '61' AND glab002 = '8925' AND glab003 = '8' AND glabent = ",g_enterprise,") xcec102,xcck002,xcck021,xcck022, ",  #170313-00084#1 mark
               "        xcck032,(SELECT glab010 FROM glab_t WHERE glabld  = '",g_xcea_m.xceald,"' AND glab001 = '61' AND glab002 = '8925' AND glab003 = '7' AND glabent = ",g_enterprise,") xcec102,xcck002,xcck021,xcck022, ",  #170313-00084#1 add
               "        xcck023,xcck024,xcck025,xcck026,xcck027,",
               "        xcck028,xcck029,xcck030,xcck031,xcck201,",
               "        xcck202,xcck202a,xcck202b,xcck202c,xcck202d,xcck202e,xcck202f,xcck202g,xcck202h,",
               "        0,0,0,0,0,0,0,0,0,",
               "        0,0,0,0,0,0,0,0,0,",
               #"        '','','','','', ", #170214-00014#1 mark
               "        '','','','',xcck022, ", #170214-00014#1 add
               "        '','','','','', ",             
               "        '','','','','', ",             
               "        '','','', ",             
               "        '','','' ",   
               "   FROM (",
               "         SELECT xcck002,xcck006,xcck007, ",
               "                xcck010,xcck011,xcck009,xcck021,xcck022,xcck023,xcck024,xcck025,xcck026,xcck027,xcck028,",  
               "                xcck029,xcck030,xcck031,xcck032,SUM(xcck009*xcck201) xcck201,SUM(xcck009*xcck202) xcck202, ",
               "                SUM(xcck009*xcck202a) xcck202a,SUM(xcck009*xcck202b) xcck202b,SUM(xcck009*xcck202c) xcck202c,SUM(xcck009*xcck202d) xcck202d,",
               "                SUM(xcck009*xcck202e) xcck202e,SUM(xcck009*xcck202f) xcck202f,SUM(xcck009*xcck202g) xcck202g,SUM(xcck009*xcck202h) xcck202h ",
               "                FROM xcck_t ", 
               "          WHERE xcckent = '",g_enterprise,"' AND xcckld = '",g_xcea_m.xceald,"'",
               "            AND xcck003 = '",g_xcea_m.xcea003,"' AND xcck004 = ",g_xcea_m.xcea004,
               "            AND xcck005 = ",g_xcea_m.xcea005,
               "            AND xcck001 = '1' ",
               "            AND xcck020 IN ('101','301','304') ",     
               "         GROUP BY xcck002,xcck006,xcck007,xcck010,xcck011,xcck009,xcck021,xcck022,xcck023,xcck024,xcck025,xcck026,xcck027,xcck028,xcck029,xcck030,xcck031,xcck032",  
               "         ORDER BY xcck002,xcck006,xcck007,xcck010,xcck011,xcck009,xcck021,xcck022,xcck023,xcck024,xcck025,xcck026,xcck027,xcck028,xcck029,xcck030,xcck031,xcck032)" 
   PREPARE axct701_7_ins_xcec_01 FROM g_sql
   EXECUTE axct701_7_ins_xcec_01
   
   #更新本位币二金额
   LET g_sql = " MERGE INTO sourse_ins_tmp1                               ",
               " USING (SELECT xcck002,xcck006,xcck007,xcck010,xcck011,",
               "               xcck009,xcck021,xcck022,xcck023,xcck024,",
               "               xcck025,xcck026,xcck027,xcck028,xcck029,",
               "               xcck030,xcck031,xcck032,",
               "               SUM(xcck009*xcck202) xcck202, ",
               "               SUM(xcck009*xcck202a) xcck202a,SUM(xcck009*xcck202b) xcck202b,SUM(xcck009*xcck202c) xcck202c,SUM(xcck009*xcck202d) xcck202d,",
               "               SUM(xcck009*xcck202e) xcck202e,SUM(xcck009*xcck202f) xcck202f,SUM(xcck009*xcck202g) xcck202g,SUM(xcck009*xcck202h) xcck202h ",
               "          FROM xcck_t ", 
               "         WHERE xcckent = '",g_enterprise,"' AND xcckld = '",g_xcea_m.xceald,"'",
               "           AND xcck003 = '",g_xcea_m.xcea003,"' AND xcck004 = ",g_xcea_m.xcea004,
               "           AND xcck005 = ",g_xcea_m.xcea005,
               "           AND xcck020 IN ('101','301','304') ",
               "           AND xcck001 = '2' " ,
               "         GROUP BY xcck002,xcck006,xcck007,xcck010,xcck011,xcck009,xcck021,xcck022,xcck023,xcck024,xcck025,xcck026,xcck027,xcck028,xcck029,xcck030,xcck031,xcck032 )",               
               "    ON (xcec001 = xcck006 ",
               "        AND xcec002 = xcck007 ", 
               "        AND xcec110 = xcck021 ",
               "        AND (CASE xcck009 WHEN -1 THEN xcec003 = '5' WHEN  1 THEN xcec003 = '6' END) ",
               "        AND xcec103 = xcck002", 
               "        AND xcec004 = xcck010", 
               "        AND xcec005 = xcck011", 
               "        AND xcec110 = xcck021", 
               "        AND xcec111 = xcck022",      
               "        AND xcec112 = xcck023", 
               "        AND xcec113 = xcck024", 
               "        AND xcec114 = xcck025",      
               "        AND xcec115 = xcck026", 
               "        AND xcec116 = xcck027", 
               "        AND xcec117 = xcck028", 
               "        AND xcec118 = xcck029", 
               "        AND xcec119 = xcck030", 
               "        AND xcec120 = xcck031", 
               "        AND xcec101 = xcck032)",                 
               "  WHEN MATCHED THEN ",
               "UPDATE SET xcec212  = xcck202 ,",
               "           xcec212a = xcck202a,",
               "           xcec212b = xcck202b,",
               "           xcec212c = xcck202c,",
               "           xcec212d = xcck202d,",
               "           xcec212e = xcck202e,",
               "           xcec212f = xcck202f,",
               "           xcec212g = xcck202g,",
               "           xcec212h = xcck202h "
   PREPARE axct701_7_upd_xcec212 FROM g_sql
   EXECUTE axct701_7_upd_xcec212

   #更新本位币三金额
   LET g_sql = " MERGE INTO sourse_ins_tmp1                               ",
               " USING (SELECT xcck002,xcck006,xcck007,xcck010,xcck011,",
               "               xcck009,xcck021,xcck022,xcck023,xcck024,",
               "               xcck025,xcck026,xcck027,xcck028,xcck029,",
               "               xcck030,xcck031,xcck032,",
               "               SUM(xcck009*xcck202) xcck202, ",
               "               SUM(xcck009*xcck202a) xcck202a,SUM(xcck009*xcck202b) xcck202b,SUM(xcck009*xcck202c) xcck202c,SUM(xcck009*xcck202d) xcck202d,",
               "               SUM(xcck009*xcck202e) xcck202e,SUM(xcck009*xcck202f) xcck202f,SUM(xcck009*xcck202g) xcck202g,SUM(xcck009*xcck202h) xcck202h ",
               "          FROM xcck_t ", 
               "         WHERE xcckent = '",g_enterprise,"' AND xcckld = '",g_xcea_m.xceald,"'",
               "           AND xcck003 = '",g_xcea_m.xcea003,"' AND xcck004 = ",g_xcea_m.xcea004,
               "           AND xcck005 = ",g_xcea_m.xcea005,
               "           AND xcck020 IN ('101','301','304')",
               "           AND xcck001 = '3' ", 
               "         GROUP BY xcck002,xcck006,xcck007,xcck010,xcck011,xcck009,xcck021,xcck022,xcck023,xcck024,xcck025,xcck026,xcck027,xcck028,xcck029,xcck030,xcck031,xcck032 )",               
               "    ON (xcec001 = xcck006 ",
               "        AND xcec002 = xcck007 ", 
               "        AND xcec110 = xcck021 ",
               "        AND (CASE xcck009 WHEN -1 THEN xcec003 = '5' WHEN  1 THEN xcec003 = '6' END) ",
               "        AND xcec103 = xcck002", 
               "        AND xcec004 = xcck010", 
               "        AND xcec005 = xcck011", 
               "        AND xcec110 = xcck021", 
               "        AND xcec111 = xcck022",      
               "        AND xcec112 = xcck023", 
               "        AND xcec113 = xcck024", 
               "        AND xcec114 = xcck025",      
               "        AND xcec115 = xcck026", 
               "        AND xcec116 = xcck027", 
               "        AND xcec117 = xcck028", 
               "        AND xcec118 = xcck029", 
               "        AND xcec119 = xcck030", 
               "        AND xcec120 = xcck031", 
               "        AND xcec101 = xcck032)",                 
               "  WHEN MATCHED THEN ",
               "UPDATE SET xcec222  = xcck202 ,",
               "           xcec222a = xcck202a,",
               "           xcec222b = xcck202b,",
               "           xcec222c = xcck202c,",
               "           xcec222d = xcck202d,",
               "           xcec222e = xcck202e,",
               "           xcec222f = xcck202f,",
               "           xcec222g = xcck202g,",
               "           xcec222h = xcck202h "
   PREPARE axct701_7_upd_xcec222 FROM g_sql
   EXECUTE axct701_7_upd_xcec222

   #抓取科目
   UPDATE sourse_ins_tmp1
      SET sfaasite = (SELECT imag011 FROM imag_t
                       WHERE imagent = g_enterprise AND imagsite = g_xcea_m.xceacomp
                         AND imag001 = xcec004)    
   
   UPDATE sourse_ins_tmp1 
      SET xcec101 = (SELECT DISTINCT glcc002 FROM glcc_t 
                      WHERE glccent = g_enterprise
                        AND glcc001 = '1'  
                        AND glccld  = g_xcea_m.xceald
                        AND (glcc014= g_xcea_m.xceacomp OR glcc014='*' )
                        AND (glcc016=xcec004 OR glcc016 = '*')
                        AND (glcc011=sfaasite OR glcc011='*')
                        AND rownum = 1)   
    WHERE xcec101 IS NULL OR xcec101 = ' '
   
   UPDATE sourse_ins_tmp1 
      SET xcec108 = (SELECT inba004
                       FROM inba_t
                      WHERE inbaent = g_enterprise
                        AND inbadocno = xcec001)
                        
   UPDATE sourse_ins_tmp1 
      SET xcec110 = (SELECT inba007
                       FROM inba_t
                      WHERE inbaent = g_enterprise
                        AND inbadocno = xcec001)
    WHERE xcec110 IS NULL   

  #启用交易对象
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad010 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad010 = 'N'  ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec111 = ' '"
   PREPARE axct701_7_upd_xcec111 FROM g_sql
   EXECUTE axct701_7_upd_xcec111

  #启用客群
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad011 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad011 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec112 = ' '"
   PREPARE axct701_7_upd_xcec112 FROM g_sql
   EXECUTE axct701_7_upd_xcec112

  #启用区域
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad009 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad009 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec113 = ' '"
   PREPARE axct701_7_upd_xcec113 FROM g_sql
   EXECUTE axct701_7_upd_xcec113

   
  #启用成本中心
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad008 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad008 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec114 = ' '"
   PREPARE axct701_7_upd_xcec114 FROM g_sql
   EXECUTE axct701_7_upd_xcec114
   
  #启用经营类别
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad031 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad031 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec115 = ' '"
   PREPARE axct701_7_upd_xcec115 FROM g_sql
   EXECUTE axct701_7_upd_xcec115
 
  #启用渠道
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad032 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad032 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec116 = ' '"
   PREPARE axct701_7_upd_xcec116 FROM g_sql
   EXECUTE axct701_7_upd_xcec116

  #启用品类
  #170221-00041#1 add start ----
   UPDATE sourse_ins_tmp1 
      SET xcec117 = (SELECT imag011 FROM imag_t 
                      WHERE imagent = xcecent 
                        AND imagsite = g_xcea_m.xceacomp
                        AND imag001 = xcec004) 
  #170221-00041#1 add end   ----   
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad012 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad012 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec117 = ' '"
   PREPARE axct701_7_upd_xcec117 FROM g_sql
   EXECUTE axct701_7_upd_xcec117
   
  #启用品牌
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad033 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad033 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec118 = ' '"
   PREPARE axct701_7_upd_xcec118 FROM g_sql
   EXECUTE axct701_7_upd_xcec118
 
  #启用项目号
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad015 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad015 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec119 = ' '"
   PREPARE axct701_7_upd_xcec119 FROM g_sql
   EXECUTE axct701_7_upd_xcec119
 
  #启用WBS
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad016 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad016 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec120 = ' '"
   PREPARE axct701_7_upd_xcec120 FROM g_sql
   EXECUTE axct701_7_upd_xcec120
 
  #启用人员
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad013 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad013 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec107 = ' '"
   PREPARE axct701_7_upd_xcec107 FROM g_sql
   EXECUTE axct701_7_upd_xcec107
 
  #启用部门
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad007 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad007 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec108 = ' '"
   PREPARE axct701_7_upd_xcec108 FROM g_sql
   EXECUTE axct701_7_upd_xcec108
   
  #启用账款对象
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad027 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad027 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec109 = ' '"
   PREPARE axct701_7_upd_xcec109 FROM g_sql
   EXECUTE axct701_7_upd_xcec109
   
  #启用自由核算项1
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad017 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad017 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec121 = ' '"
   PREPARE axct701_7_upd_xcec121 FROM g_sql
   EXECUTE axct701_7_upd_xcec121
 
  #启用自由核算项2
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad018 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad018 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec122 = ' '"
   PREPARE axct701_7_upd_xcec122 FROM g_sql
   EXECUTE axct701_7_upd_xcec122
 
  #启用自由核算项3
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad019 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad019 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec123 = ' '"
   PREPARE axct701_7_upd_xcec123 FROM g_sql
   EXECUTE axct701_7_upd_xcec123

  #启用自由核算项4
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad019 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad019 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec124 = ' '"
   PREPARE axct701_7_upd_xcec124 FROM g_sql
   EXECUTE axct701_7_upd_xcec124

  #启用自由核算项5
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad021 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad021 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec125 = ' '"
   PREPARE axct701_7_upd_xcec125 FROM g_sql
   EXECUTE axct701_7_upd_xcec125

  #启用自由核算项6
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad022 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad022 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec126 = ' '"
   PREPARE axct701_7_upd_xcec126 FROM g_sql
   EXECUTE axct701_7_upd_xcec126

  #启用自由核算项7
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad023 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad023 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec127 = ' '"
   PREPARE axct701_7_upd_xcec127 FROM g_sql
   EXECUTE axct701_7_upd_xcec127

  #启用自由核算项8
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad024 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad024 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec128 = ' '"
   PREPARE axct701_7_upd_xcec128 FROM g_sql
   EXECUTE axct701_7_upd_xcec128

  #启用自由核算项9
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad025 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad025 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec129 = ' '"
   PREPARE axct701_7_upd_xcec129 FROM g_sql
   EXECUTE axct701_7_upd_xcec129

  #启用自由核算项10
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad026 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad026 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec130 = ' '"
   PREPARE axct701_7_upd_xcec130 FROM g_sql
   EXECUTE axct701_7_upd_xcec130
   
  #来源单项次
   #UPDATE sourse_ins_tmp1 SET xcec002 = ''   #170207-00058#1 mark 
  #特性
   UPDATE sourse_ins_tmp1 SET xcec005 = ' ' WHERE xcec005 IS NULL
 #科目编号
   UPDATE sourse_ins_tmp1 SET xcec101 = ' ' WHERE xcec101 IS NULL
  #摘要
   UPDATE sourse_ins_tmp1 SET xcec102 = ' ' WHERE xcec102 IS NULL
  #成本域
   UPDATE sourse_ins_tmp1 SET xcec103 = ' ' WHERE xcec103 IS NULL
  #原因码
   UPDATE sourse_ins_tmp1 SET xcec110 = ' ' WHERE xcec110 IS NULL
  #交易对象
   UPDATE sourse_ins_tmp1 SET xcec111 = ' ' WHERE xcec111 IS NULL
  #客群
   UPDATE sourse_ins_tmp1 SET xcec112 = ' ' WHERE xcec112 IS NULL
  #区域
   UPDATE sourse_ins_tmp1 SET xcec113 = ' ' WHERE xcec113 IS NULL
  #成本中心
   UPDATE sourse_ins_tmp1 SET xcec114 = ' ' WHERE xcec114 IS NULL
  #经营类别
   UPDATE sourse_ins_tmp1 SET xcec115 = ' ' WHERE xcec115 IS NULL
  #渠道
   UPDATE sourse_ins_tmp1 SET xcec116 = ' ' WHERE xcec116 IS NULL
  #品类
   UPDATE sourse_ins_tmp1 SET xcec117 = ' ' WHERE xcec117 IS NULL
  #品牌
   UPDATE sourse_ins_tmp1 SET xcec118 = ' ' WHERE xcec118 IS NULL
  #项目号
   UPDATE sourse_ins_tmp1 SET xcec119 = ' ' WHERE xcec119 IS NULL
  #WBS
   UPDATE sourse_ins_tmp1 SET xcec120 = ' ' WHERE xcec120 IS NULL
  #人员
   UPDATE sourse_ins_tmp1 SET xcec107 = ' ' WHERE xcec107 IS NULL
   #部门
   UPDATE sourse_ins_tmp1 SET xcec108 = ' ' WHERE xcec108 IS NULL
  #账款对象
   UPDATE sourse_ins_tmp1 SET xcec109 = ' ' WHERE xcec109 IS NULL
  #自由核算项1
   UPDATE sourse_ins_tmp1 SET xcec121 = ' ' WHERE xcec121 IS NULL
  #自由核算项2
   UPDATE sourse_ins_tmp1 SET xcec122 = ' ' WHERE xcec122 IS NULL
  #自由核算项3
   UPDATE sourse_ins_tmp1 SET xcec123 = ' ' WHERE xcec123 IS NULL
  #自由核算项4
   UPDATE sourse_ins_tmp1 SET xcec124 = ' ' WHERE xcec124 IS NULL
  #自由核算项5
   UPDATE sourse_ins_tmp1 SET xcec125 = ' ' WHERE xcec125 IS NULL
  #自由核算项6
   UPDATE sourse_ins_tmp1 SET xcec126 = ' ' WHERE xcec126 IS NULL
   #自由核算项7
   UPDATE sourse_ins_tmp1 SET xcec127 = ' ' WHERE xcec127 IS NULL
  #自由核算项8
   UPDATE sourse_ins_tmp1 SET xcec128 = ' ' WHERE xcec128 IS NULL
  #自由核算项9
   UPDATE sourse_ins_tmp1 SET xcec129 = ' ' WHERE xcec129 IS NULL
  #自由核算项10
   UPDATE sourse_ins_tmp1 SET xcec130 = ' ' WHERE xcec130 IS NULL

   INSERT INTO xcec_t (xcecent,xceccomp,xcecld,xcecdocno,xcecseq,
                       xcec001,xcec002,xcec003,xcec004,xcec005,xcec101,xcec102,xcec103,xcec110,xcec111,
                       xcec112,xcec113,xcec114,xcec115,xcec116,xcec117,xcec118,xcec119,xcec120,xcec201,
                       xcec202,xcec202a,xcec202b,xcec202c,xcec202d,xcec202e,xcec202f,xcec202g,xcec202h,
                       xcec212,xcec212a,xcec212b,xcec212c,xcec212d,xcec212e,xcec212f,xcec212g,xcec212h,
                       xcec222,xcec222a,xcec222b,xcec222c,xcec222d,xcec222e,xcec222f,xcec222g,xcec222h,
                       xcec301,xcec302,xcec107,xcec108,xcec109,xcec121,xcec122,xcec123,xcec124,xcec125,
                       xcec126,xcec127,xcec128,xcec129,xcec130)
         SELECT xcecent,xceccomp,xcecld,xcecdocno,xcecseq,
                xcec001,xcec002,xcec003,xcec004,xcec005,xcec101,xcec102,xcec103,xcec110,xcec111,
                xcec112,xcec113,xcec114,xcec115,xcec116,xcec117,xcec118,xcec119,xcec120,xcec201,
                xcec202,xcec202a,xcec202b,xcec202c,xcec202d,xcec202e,xcec202f,xcec202g,xcec202h,
                xcec212,xcec212a,xcec212b,xcec212c,xcec212d,xcec212e,xcec212f,xcec212g,xcec212h,
                xcec222,xcec222a,xcec222b,xcec222c,xcec222d,xcec222e,xcec222f,xcec222g,xcec222h,
                xcec301,xcec302,xcec107,xcec108,xcec109,xcec121,xcec122,xcec123,xcec124,xcec125,
                xcec126,xcec127,xcec128,xcec129,xcec130
           FROM sourse_ins_tmp1
   DELETE FROM sourse_ins_tmp1; 
   RETURN g_success
END FUNCTION

################################################################################
# Descriptions...: 优化版axct708   7.雜項進出差异憑證  axct708
# Memo...........:
# Usage..........: CALL axct701_01_ins_8()
# Input parameter:  
# Return code....:  
# Date & Author..: 2017/1/11 By 20095
# Modify.........: 170105-00011#2 
################################################################################
PRIVATE FUNCTION axct701_01_ins_8()
DEFINE l_xcea          RECORD  #工單發料成本憑證單頭檔
       xceaent LIKE xcea_t.xceaent, #企業編號
       xceacomp LIKE xcea_t.xceacomp, #法人組織
       xceald LIKE xcea_t.xceald, #帳套
       xceadocno LIKE xcea_t.xceadocno, #單據編號
       xcea001 LIKE xcea_t.xcea001, #單據日期
       xcea002 LIKE xcea_t.xcea002, #成本憑證類型
       xcea003 LIKE xcea_t.xcea003, #成本計算類型
       xcea004 LIKE xcea_t.xcea004, #年度
       xcea005 LIKE xcea_t.xcea005, #期別
       xcea006 LIKE xcea_t.xcea006, #帳務人員
       xcea007 LIKE xcea_t.xcea007, #帳務部門
       xcea101 LIKE xcea_t.xcea101, #憑證編號
       xcea102 LIKE xcea_t.xcea102, #憑證日期
       xceaownid LIKE xcea_t.xceaownid, #資料所有者
       xceaowndp LIKE xcea_t.xceaowndp, #資料所屬部門
       xceacrtid LIKE xcea_t.xceacrtid, #資料建立者
       xceacrtdp LIKE xcea_t.xceacrtdp, #資料建立部門
       xceacrtdt LIKE xcea_t.xceacrtdt, #資料創建日
       xceamodid LIKE xcea_t.xceamodid, #資料修改者
       xceamoddt LIKE xcea_t.xceamoddt, #最近修改日
       xceacnfid LIKE xcea_t.xceacnfid, #資料確認者
       xceacnfdt LIKE xcea_t.xceacnfdt, #資料確認日
       xceapstid LIKE xcea_t.xceapstid, #資料過帳者
       xceapstdt LIKE xcea_t.xceapstdt, #資料過帳日
       xceastus LIKE xcea_t.xceastus, #狀態碼
       xceaud001 LIKE xcea_t.xceaud001, #自定義欄位(文字)001
       xceaud002 LIKE xcea_t.xceaud002, #自定義欄位(文字)002
       xceaud003 LIKE xcea_t.xceaud003, #自定義欄位(文字)003
       xceaud004 LIKE xcea_t.xceaud004, #自定義欄位(文字)004
       xceaud005 LIKE xcea_t.xceaud005, #自定義欄位(文字)005
       xceaud006 LIKE xcea_t.xceaud006, #自定義欄位(文字)006
       xceaud007 LIKE xcea_t.xceaud007, #自定義欄位(文字)007
       xceaud008 LIKE xcea_t.xceaud008, #自定義欄位(文字)008
       xceaud009 LIKE xcea_t.xceaud009, #自定義欄位(文字)009
       xceaud010 LIKE xcea_t.xceaud010, #自定義欄位(文字)010
       xceaud011 LIKE xcea_t.xceaud011, #自定義欄位(數字)011
       xceaud012 LIKE xcea_t.xceaud012, #自定義欄位(數字)012
       xceaud013 LIKE xcea_t.xceaud013, #自定義欄位(數字)013
       xceaud014 LIKE xcea_t.xceaud014, #自定義欄位(數字)014
       xceaud015 LIKE xcea_t.xceaud015, #自定義欄位(數字)015
       xceaud016 LIKE xcea_t.xceaud016, #自定義欄位(數字)016
       xceaud017 LIKE xcea_t.xceaud017, #自定義欄位(數字)017
       xceaud018 LIKE xcea_t.xceaud018, #自定義欄位(數字)018
       xceaud019 LIKE xcea_t.xceaud019, #自定義欄位(數字)019
       xceaud020 LIKE xcea_t.xceaud020, #自定義欄位(數字)020
       xceaud021 LIKE xcea_t.xceaud021, #自定義欄位(日期時間)021
       xceaud022 LIKE xcea_t.xceaud022, #自定義欄位(日期時間)022
       xceaud023 LIKE xcea_t.xceaud023, #自定義欄位(日期時間)023
       xceaud024 LIKE xcea_t.xceaud024, #自定義欄位(日期時間)024
       xceaud025 LIKE xcea_t.xceaud025, #自定義欄位(日期時間)025
       xceaud026 LIKE xcea_t.xceaud026, #自定義欄位(日期時間)026
       xceaud027 LIKE xcea_t.xceaud027, #自定義欄位(日期時間)027
       xceaud028 LIKE xcea_t.xceaud028, #自定義欄位(日期時間)028
       xceaud029 LIKE xcea_t.xceaud029, #自定義欄位(日期時間)029
       xceaud030 LIKE xcea_t.xceaud030, #自定義欄位(日期時間)030
       xceasite LIKE xcea_t.xceasite  #營運據點
          END RECORD
DEFINE ld_date         DATETIME YEAR TO SECOND
DEFINE l_success       LIKE type_t.num5
         

  #CALL axct701_01_create_tmp()    #170324-00054#1 mark
   
   LET g_success = 'Y'
   LET l_xcea.xceaownid = g_user
   LET l_xcea.xceaowndp = g_dept
   LET l_xcea.xceacrtid = g_user
   LET l_xcea.xceacrtdp = g_dept 
   LET ld_date  = cl_get_current()
   LET l_xcea.xceacrtdt = ld_date
   LET l_xcea.xceamodid = ""
   LET l_xcea.xceamoddt = ""
   CALL s_aooi200_fin_gen_docno(g_xcea_m.xceald,'','',g_xcea_m.xceadocno,g_xcea_m.xcea001,g_prog_name1)      #wujie 150214
    RETURNING l_success,g_xcea_m.xceadocno
   IF l_success  = 0  THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = 'apm-00003'
      LET g_errparam.extend = g_xcea_m.xceadocno
      LET g_errparam.popup = TRUE
      CALL cl_err()

      LET g_success = 'N'
      RETURN g_success
   END IF
   
   INSERT INTO xcea_t (xceaent,xceald,xceacomp,xcea006,xceadocno,xcea001,xcea002,xcea004, 
       xcea005,xcea003,xceastus,xceaownid,xceaowndp,xceacrtid,xceacrtdp,xceacrtdt, 
       xceamodid,xceamoddt)
   VALUES (g_enterprise,g_xcea_m.xceald,g_xcea_m.xceacomp,g_xcea_m.xcea006,g_xcea_m.xceadocno, 
       g_xcea_m.xcea001,g_xcea002,g_xcea_m.xcea004,g_xcea_m.xcea005,g_xcea_m.xcea003, 
       'N',l_xcea.xceaownid,l_xcea.xceaowndp,l_xcea.xceacrtid, 
       l_xcea.xceacrtdp,ld_date,l_xcea.xceamodid,l_xcea.xceamoddt) 
       
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "g_xcea_m"
      LET g_errparam.popup = TRUE
      CALL cl_err()
  
      LET g_success = 'N'
      RETURN g_success
   END IF   

   ###INS xceb_t###
   DELETE FROM sourse_ins_tmp;
   LET g_sql = " INSERT INTO sourse_ins_tmp ",
               "  (xcebent,xcebcomp,xcebld,xcebdocno,xcebseq,",
               "   xceb001,xceb002,xceb003,xceb004,xceb005,",
               "   xceb101,xceb102,xceb103,xceb110,xceb111,",
               "   xceb112,xceb113,xceb114,xceb115,xceb116,",
               "   xceb117,xceb118,xceb119,xceb120,xceb201,",
               "   xceb202,xceb202a,xceb202b,xceb202c,xceb202d,xceb202e,xceb202f,xceb202g,xceb202h,",
               "   xceb212,xceb212a,xceb212b,xceb212c,xceb212d,xceb212e,xceb212f,xceb212g,xceb212h,",
               "   xceb222,xceb222a,xceb222b,xceb222c,xceb222d,xceb222e,xceb222f,xceb222g,xceb222h,",
               "   xceb301,xceb302,xceb107,xceb108,xceb109,",
               "   xceb121,xceb122,xceb123,xceb124,xceb125,",
               "   xceb126,xceb127,xceb128,xceb129,xceb130,",
               "   xceb131,xceb132,sfaa009,sfaasite,sfaa028,",
               "   sfaa029,sfaa052,sfaa057) ",  
               " SELECT ",g_enterprise,",'",g_xcea_m.xceacomp,"','",g_xcea_m.xceald,"','",g_xcea_m.xceadocno,"',rownum,",
               "        xcck006,xcck007,(CASE WHEN xcck009 = -1 THEN '5' WHEN xcck009 = 1 THEN '6' END),xcck010 ,xcck011,",
               "        xcck033,(SELECT glab010 FROM glab_t WHERE glabld  = '",g_xcea_m.xceald,"' AND glab001 = '61' AND glab002 = '8925' AND glab003 = '8' AND glabent = ",g_enterprise,") xceb102,xcck002,xcck021,xcck022, ",
               "        xcck023,xcck024,xcck025,xcck026,xcck027,",
               "        xcck028,xcck029,xcck030,xcck031,xcck201,",
               "        xcck202,xcck202a,xcck202b,xcck202c,xcck202d,xcck202e,xcck202f,xcck202g,xcck202h,",
               "        0,0,0,0,0,0,0,0,0,",
               "        0,0,0,0,0,0,0,0,0,",
               #"        '','','','','', ", #170214-00014#1 mark
               "        '','','','',xcck022, ", #170214-00014#1 add
               "        '','','','','', ",             
               "        '','','','','', ",             
               "        '','','','','', ",             
               "        '','','' ",     #因xceb_t没有批号，所以这边暂时用临时表中的sfaa029记录
               "   FROM (",
               "         SELECT xcck002,xcck006,xcck007, ",
               "                xcck010,xcck011,xcck009,xcck021,xcck022,xcck023,xcck024,xcck025,xcck026,xcck027,xcck028,",  
               "                xcck029,xcck030,xcck031,xcck033,SUM(xcck009*xcck201) xcck201,SUM(xcck009*xcck202) xcck202, ",
               "                SUM(xcck009*xcck202a) xcck202a,SUM(xcck009*xcck202b) xcck202b,SUM(xcck009*xcck202c) xcck202c,SUM(xcck009*xcck202d) xcck202d,",
               "                SUM(xcck009*xcck202e) xcck202e,SUM(xcck009*xcck202f) xcck202f,SUM(xcck009*xcck202g) xcck202g,SUM(xcck009*xcck202h) xcck202h ",
               "                FROM xcck_t ", 
               "          WHERE xcckent = '",g_enterprise,"' AND xcckld = '",g_xcea_m.xceald,"'",
               "            AND xcck003 = '",g_xcea_m.xcea003,"' AND xcck004 = ",g_xcea_m.xcea004,
               "            AND xcck005 = ",g_xcea_m.xcea005,
               "            AND xcck001 = '1' ",
               "            AND xcck020 IN ('101','301','304') ",     
               "         GROUP BY xcck002,xcck006,xcck007,xcck010,xcck011,xcck009,xcck021,xcck022,xcck023,xcck024,xcck025,xcck026,xcck027,xcck028,xcck029,xcck030,xcck031,xcck033",  
               "         ORDER BY xcck002,xcck006,xcck007,xcck010,xcck011,xcck009,xcck021,xcck022,xcck023,xcck024,xcck025,xcck026,xcck027,xcck028,xcck029,xcck030,xcck031,xcck033)" 
   PREPARE axct701_8_ins_xceb_01 FROM g_sql
   EXECUTE axct701_8_ins_xceb_01
   
   #更新本位币二金额
   LET g_sql = " MERGE INTO sourse_ins_tmp                               ",
               " USING (SELECT xcck002,xcck006,xcck007,xcck010,xcck011,",
               "               xcck009,xcck021,xcck022,xcck023,xcck024,",
               "               xcck025,xcck026,xcck027,xcck028,xcck029,",
               "               xcck030,xcck031,xcck033,",
               "               SUM(xcck009*xcck202) xcck202, ",
               "               SUM(xcck009*xcck202a) xcck202a,SUM(xcck009*xcck202b) xcck202b,SUM(xcck009*xcck202c) xcck202c,SUM(xcck009*xcck202d) xcck202d,",
               "               SUM(xcck009*xcck202e) xcck202e,SUM(xcck009*xcck202f) xcck202f,SUM(xcck009*xcck202g) xcck202g,SUM(xcck009*xcck202h) xcck202h ",
               "          FROM xcck_t ", 
               "         WHERE xcckent = '",g_enterprise,"' AND xcckld = '",g_xcea_m.xceald,"'",
               "           AND xcck003 = '",g_xcea_m.xcea003,"' AND xcck004 = ",g_xcea_m.xcea004,
               "           AND xcck005 = ",g_xcea_m.xcea005,
               "           AND xcck020 IN ('101','301','304')",
               "           AND xcck001 = '2' ", 
               "         GROUP BY xcck002,xcck006,xcck007,xcck010,xcck011,xcck009,xcck021,xcck022,xcck023,xcck024,xcck025,xcck026,xcck027,xcck028,xcck029,xcck030,xcck031,xcck033 )",               
               "    ON (xceb001 = xcck006 ",
               "        AND xceb002 = xcck007 ", 
               "        AND xceb110 = xcck021 ",
               "        AND (CASE xcck009 WHEN -1 THEN xceb003 = '5' WHEN  1 THEN xceb003 = '6' END) ",
               "        AND xceb103 = xcck002", 
               "        AND xceb004 = xcck010", 
               "        AND xceb005 = xcck011", 
               "        AND xceb110 = xcck021", 
               "        AND xceb111 = xcck022",      
               "        AND xceb112 = xcck023", 
               "        AND xceb113 = xcck024", 
               "        AND xceb114 = xcck025",      
               "        AND xceb115 = xcck026", 
               "        AND xceb116 = xcck027", 
               "        AND xceb117 = xcck028", 
               "        AND xceb118 = xcck029", 
               "        AND xceb119 = xcck030", 
               "        AND xceb120 = xcck031", 
               "        AND xceb101 = xcck033)",                 
               "  WHEN MATCHED THEN ",
               "UPDATE SET xceb212  = xcck202 ,",
               "           xceb212a = xcck202a,",
               "           xceb212b = xcck202b,",
               "           xceb212c = xcck202c,",
               "           xceb212d = xcck202d,",
               "           xceb212e = xcck202e,",
               "           xceb212f = xcck202f,",
               "           xceb212g = xcck202g,",
               "           xceb212h = xcck202h "
   PREPARE axct701_8_upd_xceb212 FROM g_sql
   EXECUTE axct701_8_upd_xceb212

   #更新本位币三金额
   LET g_sql = " MERGE INTO sourse_ins_tmp                               ",
               " USING (SELECT xcck002,xcck006,xcck007,xcck010,xcck011,",
               "               xcck009,xcck021,xcck022,xcck023,xcck024,",
               "               xcck025,xcck026,xcck027,xcck028,xcck029,",
               "               xcck030,xcck031,xcck033,",
               "               SUM(xcck009*xcck202) xcck202, ",
               "               SUM(xcck009*xcck202a) xcck202a,SUM(xcck009*xcck202b) xcck202b,SUM(xcck009*xcck202c) xcck202c,SUM(xcck009*xcck202d) xcck202d,",
               "               SUM(xcck009*xcck202e) xcck202e,SUM(xcck009*xcck202f) xcck202f,SUM(xcck009*xcck202g) xcck202g,SUM(xcck009*xcck202h) xcck202h ",
               "          FROM xcck_t ", 
               "         WHERE xcckent = '",g_enterprise,"' AND xcckld = '",g_xcea_m.xceald,"'",
               "           AND xcck003 = '",g_xcea_m.xcea003,"' AND xcck004 = ",g_xcea_m.xcea004,
               "           AND xcck005 = ",g_xcea_m.xcea005,
               "           AND xcck020 IN ('101','301','304')",
               "           AND xcck001 = '3' " ,
               "         GROUP BY xcck002,xcck006,xcck007,xcck010,xcck011,xcck009,xcck021,xcck022,xcck023,xcck024,xcck025,xcck026,xcck027,xcck028,xcck029,xcck030,xcck031,xcck033 )" ,              
               "    ON (xceb001 = xcck006 ",
               "        AND xceb002 = xcck007 ", 
               "        AND xceb110 = xcck021 ",
               "        AND (CASE xcck009 WHEN -1 THEN xceb003 = '5' WHEN  1 THEN xceb003 = '6' END) ",
               "        AND xceb103 = xcck002", 
               "        AND xceb004 = xcck010", 
               "        AND xceb005 = xcck011", 
               "        AND xceb110 = xcck021", 
               "        AND xceb111 = xcck022",      
               "        AND xceb112 = xcck023", 
               "        AND xceb113 = xcck024", 
               "        AND xceb114 = xcck025",      
               "        AND xceb115 = xcck026", 
               "        AND xceb116 = xcck027", 
               "        AND xceb117 = xcck028", 
               "        AND xceb118 = xcck029", 
               "        AND xceb119 = xcck030", 
               "        AND xceb120 = xcck031", 
               "        AND xceb101 = xcck033)",                 
               "  WHEN MATCHED THEN ",
               "UPDATE SET xceb222  = xcck202 ,",
               "           xceb222a = xcck202a,",
               "           xceb222b = xcck202b,",
               "           xceb222c = xcck202c,",
               "           xceb222d = xcck202d,",
               "           xceb222e = xcck202e,",
               "           xceb222f = xcck202f,",
               "           xceb222g = xcck202g,",
               "           xceb222h = xcck202h "
   PREPARE axct701_8_upd_xceb222 FROM g_sql
   EXECUTE axct701_8_upd_xceb222

  #170213-00053#1 ---add (s)---   
   UPDATE sourse_ins_tmp 
      SET xceb108 = (SELECT inba004
                       FROM inba_t
                      WHERE inbaent = g_enterprise
                        AND inbadocno = xceb001)
  #170213-00053#1 ---add (e)---

   #170310-00047#1---mark---s
   #UPDATE sourse_ins_tmp                
   #  SET sfaa028 = (SELECT ooeg008 
   #                   FROM ooeg_t
   #                  WHERE ooegent = g_enterprise
   #                   #AND ooeg001 = xceb114 #170213-00053#1 mark
   #                    AND ooeg001 = xceb108 #170213-00053#1 add
   #                    AND ooegstus = 'Y')
   #UPDATE sourse_ins_tmp                
   #   SET xceb101 = (SELECT DISTINCT (CASE WHEN sfaa028='1' THEN glab005 WHEN sfaa028='2' THEN glab006 WHEN sfaa028='3' THEN glab007 WHEN sfaa028='4' THEN glab008 END)  
   #                    FROM glab_t
   #                   WHERE glabent = g_enterprise
   #                     AND glabld = g_xcea_m.xceald
   #                     AND glab001 = '11'
   #                     AND glab002 = '216'
   #                     AND glab003 = xceb110)
   # WHERE xceb101 IS NULL OR xceb101 = ' '
   # 
   #UPDATE sourse_ins_tmp                
   #  SET sfaa028 = ''
   #170310-00047#1---mark---e
   UPDATE sourse_ins_tmp 
      SET xceb101 = (SELECT glab005
                      FROM glab_t
                     WHERE glabld  = g_xcea_m.xceald
                       AND glab001 = '60'
                       AND glab002 = '8912'
                       #AND glab003 = '7'      #170310-00047#1 mark
                       AND glab003 = '26'      #170310-00047#1 add
                       AND glabent = g_enterprise)
    WHERE xceb101 IS NULL OR xceb101 = ' '
   
  #170213-00053#1 ---mark (s)---   
  #UPDATE sourse_ins_tmp 
  #   SET xceb108 = (SELECT inba004
  #                    FROM inba_t
  #                   WHERE inbaent = g_enterprise
  #                     AND inbadocno = xceb001)
  #170213-00053#1 ---mark (e)---
                        
   UPDATE sourse_ins_tmp 
      SET xceb110 = (SELECT inba007
                       FROM inba_t
                      WHERE inbaent = g_enterprise
                        AND inbadocno = xceb001)
    WHERE xceb110 IS NULL   

  #启用交易对象
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad010 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad010 = 'N'  ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb111 = ' '"
   PREPARE axct701_8_upd_xceb111 FROM g_sql
   EXECUTE axct701_8_upd_xceb111

  #启用客群
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad011 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad011 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb112 = ' '"
   PREPARE axct701_8_upd_xceb112 FROM g_sql
   EXECUTE axct701_8_upd_xceb112

  #启用区域
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad009 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad009 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb113 = ' '"
   PREPARE axct701_8_upd_xceb113 FROM g_sql
   EXECUTE axct701_8_upd_xceb113

   
  #启用成本中心
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad008 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad008 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb114 = ' '"
   PREPARE axct701_8_upd_xceb114 FROM g_sql
   EXECUTE axct701_8_upd_xceb114
   
  #启用经营类别
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad031 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad031 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb115 = ' '"
   PREPARE axct701_8_upd_xceb115 FROM g_sql
   EXECUTE axct701_8_upd_xceb115
 
  #启用渠道
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad032 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad032 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb116 = ' '"
   PREPARE axct701_8_upd_xceb116 FROM g_sql
   EXECUTE axct701_8_upd_xceb116

  #启用品类
  #170221-00041#1 add start ----
   UPDATE sourse_ins_tmp
      SET xceb117 = (SELECT imag011 FROM imag_t
                      WHERE imagent = xcebent
                        AND imagsite = g_xcea_m.xceacomp
                        AND imag001 = xceb004)
  #170221-00041#1 add end   ----  
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad012 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad012 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb117 = ' '"
   PREPARE axct701_8_upd_xceb117 FROM g_sql
   EXECUTE axct701_8_upd_xceb117
   
  #启用品牌
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad033 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad033 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb118 = ' '"
   PREPARE axct701_8_upd_xceb118 FROM g_sql
   EXECUTE axct701_8_upd_xceb118
 
  #启用项目号
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad015 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad015 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb119 = ' '"
   PREPARE axct701_8_upd_xceb119 FROM g_sql
   EXECUTE axct701_8_upd_xceb119
 
  #启用WBS
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad016 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad016 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb120 = ' '"
   PREPARE axct701_8_upd_xceb120 FROM g_sql
   EXECUTE axct701_8_upd_xceb120
 
  #启用人员
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad013 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad013 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb107 = ' '"
   PREPARE axct701_8_upd_xceb107 FROM g_sql
   EXECUTE axct701_8_upd_xceb107
 
  #启用部门
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad007 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad007 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb108 = ' '"
   PREPARE axct701_8_upd_xceb108 FROM g_sql
   EXECUTE axct701_8_upd_xceb108
   
  #启用账款对象
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad027 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad027 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb109 = ' '"
   PREPARE axct701_8_upd_xceb109 FROM g_sql
   EXECUTE axct701_8_upd_xceb109
   
  #启用自由核算项1
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad017 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad017 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb121 = ' '"
   PREPARE axct701_8_upd_xceb121 FROM g_sql
   EXECUTE axct701_8_upd_xceb121
 
  #启用自由核算项2
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad018 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad018 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb122 = ' '"
   PREPARE axct701_8_upd_xceb122 FROM g_sql
   EXECUTE axct701_8_upd_xceb122
 
  #启用自由核算项3
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad019 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad019 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb123 = ' '"
   PREPARE axct701_8_upd_xceb123 FROM g_sql
   EXECUTE axct701_8_upd_xceb123

  #启用自由核算项4
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad019 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad019 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb124 = ' '"
   PREPARE axct701_8_upd_xceb124 FROM g_sql
   EXECUTE axct701_8_upd_xceb124

  #启用自由核算项5
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad021 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad021 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb125 = ' '"
   PREPARE axct701_8_upd_xceb125 FROM g_sql
   EXECUTE axct701_8_upd_xceb125

  #启用自由核算项6
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad022 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad022 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb126 = ' '"
   PREPARE axct701_8_upd_xceb126 FROM g_sql
   EXECUTE axct701_8_upd_xceb126

  #启用自由核算项7
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad023 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad023 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb127 = ' '"
   PREPARE axct701_8_upd_xceb127 FROM g_sql
   EXECUTE axct701_8_upd_xceb127

  #启用自由核算项8
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad024 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad024 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb128 = ' '"
   PREPARE axct701_8_upd_xceb128 FROM g_sql
   EXECUTE axct701_8_upd_xceb128

  #启用自由核算项9
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad025 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad025 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb129 = ' '"
   PREPARE axct701_8_upd_xceb129 FROM g_sql
   EXECUTE axct701_8_upd_xceb129

  #启用自由核算项10
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad026 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad026 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb130 = ' '"
   PREPARE axct701_8_upd_xceb130 FROM g_sql
   EXECUTE axct701_8_upd_xceb130
   
  #来源单项次
   #UPDATE sourse_ins_tmp SET xceb002 = ''   #170207-00058#1 mark
  #特性
   UPDATE sourse_ins_tmp SET xceb005 = ' ' WHERE xceb005 IS NULL
 #科目编号
   UPDATE sourse_ins_tmp SET xceb101 = ' ' WHERE xceb101 IS NULL
  #摘要
   UPDATE sourse_ins_tmp SET xceb102 = ' ' WHERE xceb102 IS NULL
  #成本域
   UPDATE sourse_ins_tmp SET xceb103 = ' ' WHERE xceb103 IS NULL
  #原因码
   UPDATE sourse_ins_tmp SET xceb110 = ' ' WHERE xceb110 IS NULL
  #交易对象
   UPDATE sourse_ins_tmp SET xceb111 = ' ' WHERE xceb111 IS NULL
  #客群
   UPDATE sourse_ins_tmp SET xceb112 = ' ' WHERE xceb112 IS NULL
  #区域
   UPDATE sourse_ins_tmp SET xceb113 = ' ' WHERE xceb113 IS NULL
  #成本中心
   UPDATE sourse_ins_tmp SET xceb114 = ' ' WHERE xceb114 IS NULL
  #经营类别
   UPDATE sourse_ins_tmp SET xceb115 = ' ' WHERE xceb115 IS NULL
  #渠道
   UPDATE sourse_ins_tmp SET xceb116 = ' ' WHERE xceb116 IS NULL
  #品类
   UPDATE sourse_ins_tmp SET xceb117 = ' ' WHERE xceb117 IS NULL
  #品牌
   UPDATE sourse_ins_tmp SET xceb118 = ' ' WHERE xceb118 IS NULL
  #项目号
   UPDATE sourse_ins_tmp SET xceb119 = ' ' WHERE xceb119 IS NULL
  #WBS
   UPDATE sourse_ins_tmp SET xceb120 = ' ' WHERE xceb120 IS NULL
  #人员
   UPDATE sourse_ins_tmp SET xceb107 = ' ' WHERE xceb107 IS NULL
   #部门
   UPDATE sourse_ins_tmp SET xceb108 = ' ' WHERE xceb108 IS NULL
  #账款对象
   UPDATE sourse_ins_tmp SET xceb109 = ' ' WHERE xceb109 IS NULL
  #自由核算项1
   UPDATE sourse_ins_tmp SET xceb121 = ' ' WHERE xceb121 IS NULL
  #自由核算项2
   UPDATE sourse_ins_tmp SET xceb122 = ' ' WHERE xceb122 IS NULL
  #自由核算项3
   UPDATE sourse_ins_tmp SET xceb123 = ' ' WHERE xceb123 IS NULL
  #自由核算项4
   UPDATE sourse_ins_tmp SET xceb124 = ' ' WHERE xceb124 IS NULL
  #自由核算项5
   UPDATE sourse_ins_tmp SET xceb125 = ' ' WHERE xceb125 IS NULL
  #自由核算项6
   UPDATE sourse_ins_tmp SET xceb126 = ' ' WHERE xceb126 IS NULL
   #自由核算项7
   UPDATE sourse_ins_tmp SET xceb127 = ' ' WHERE xceb127 IS NULL
  #自由核算项8
   UPDATE sourse_ins_tmp SET xceb128 = ' ' WHERE xceb128 IS NULL
  #自由核算项9
   UPDATE sourse_ins_tmp SET xceb129 = ' ' WHERE xceb129 IS NULL
  #自由核算项10
   UPDATE sourse_ins_tmp SET xceb130 = ' ' WHERE xceb130 IS NULL
   
   
   LET g_sql = " MERGE INTO sourse_ins_tmp a                   ",
               " USING ( SELECT xceb103,xceb001,xceb002,xceb003,xceb004,xceb005,",
               "                SUM(xceb201) xceb201,SUM(xceb202) xceb202, ",
               "                SUM(xceb202a) xceb202a,SUM(xceb202b) xceb202b,SUM(xceb202c) xceb202c,SUM(xceb202d) xceb202d,",
               "                SUM(xceb202e) xceb202e,SUM(xceb202f) xceb202f,SUM(xceb202g) xceb202g,SUM(xceb202h) xceb202h, ",
               "                SUM(xceb212) xceb212,SUM(xceb212a) xceb212a,SUM(xceb212b) xceb212b,SUM(xceb212c) xceb212c,SUM(xceb212d) xceb212d,",
               "                SUM(xceb212e) xceb212e,SUM(xceb212f) xceb212f,SUM(xceb212g) xceb212g,SUM(xceb212h) xceb212h, ",
               "                SUM(xceb222) xceb222,SUM(xceb222a) xceb222a,SUM(xceb222b) xceb222b,SUM(xceb222c) xceb222c,SUM(xceb222d) xceb222d,",
               "                SUM(xceb222e) xceb222e,SUM(xceb222f) xceb222f,SUM(xceb222g) xceb222g,SUM(xceb222h) xceb222h ",               
               "           FROM xcea_t LEFT OUTER JOIN xceb_t ON xceaent = xcebent AND xceald = xcebld AND xceadocno = xcebdocno ",          
               "          WHERE xceaent = ",g_enterprise," AND xceald = '",g_xcea_m.xceald,"'",
               "            AND xcea003 = '",g_xcea_m.xcea003,"' AND xcea004 = ",g_xcea_m.xcea004,
               "            AND xcea005 = ",g_xcea_m.xcea005," AND xcea002 = '7' ",
               "          GROUP BY xceb103,xceb001,xceb002,xceb003,xceb004,xceb005) b",
               "            ON( a.xceb103 = b.xceb103 ",               
               "            AND a.xceb001 = b.xceb001 ",
               "            AND a.xceb002 = b.xceb002 ",  
               "            AND a.xceb003 = b.xceb003 ",
               "            AND a.xceb004 = b.xceb004 ", 
               "            AND a.xceb005 = b.xceb005) ",
               "    WHEN MATCHED THEN     ",
               "    UPDATE SET a.xceb201  = a.xceb201  - b.xceb201 ,",            
               "               a.xceb202  = a.xceb202  - b.xceb202 ,",
               "               a.xceb202a = a.xceb202a - b.xceb202a,",
               "               a.xceb202b = a.xceb202b - b.xceb202b,",
               "               a.xceb202c = a.xceb202c - b.xceb202c,",
               "               a.xceb202d = a.xceb202d - b.xceb202d,",
               "               a.xceb202e = a.xceb202e - b.xceb202e,",
               "               a.xceb202f = a.xceb202f - b.xceb202f,",
               "               a.xceb202g = a.xceb202g - b.xceb202g,",
               "               a.xceb202h = a.xceb202h - b.xceb202h,",
               "               a.xceb212  = a.xceb212  - b.xceb212 ,",
               "               a.xceb212a = a.xceb212a - b.xceb212a,",
               "               a.xceb212b = a.xceb212b - b.xceb212b,",
               "               a.xceb212c = a.xceb212c - b.xceb212c,",
               "               a.xceb212d = a.xceb212d - b.xceb212d,",
               "               a.xceb212e = a.xceb212e - b.xceb212e,",
               "               a.xceb212f = a.xceb212f - b.xceb212f,",
               "               a.xceb212g = a.xceb212g - b.xceb212g,",
               "               a.xceb212h = a.xceb212h - b.xceb212h,",
               "               a.xceb222  = a.xceb222  - b.xceb222 ,",
               "               a.xceb222a = a.xceb222a - b.xceb222a,",
               "               a.xceb222b = a.xceb222b - b.xceb222b,",
               "               a.xceb222c = a.xceb222c - b.xceb222c,",
               "               a.xceb222d = a.xceb222d - b.xceb222d,",
               "               a.xceb222e = a.xceb222e - b.xceb222e,",
               "               a.xceb222f = a.xceb222f - b.xceb222f,",
               "               a.xceb222g = a.xceb222g - b.xceb222g,",
               "               a.xceb222h = a.xceb222h - b.xceb222h "
   PREPARE axct701_8_upd_xceb2 FROM g_sql
   EXECUTE axct701_8_upd_xceb2
   INSERT INTO xceb_t (xcebent,xcebcomp,xcebld,xcebdocno,xcebseq,
                       xceb001,xceb002,xceb003,xceb004,xceb005,xceb101,xceb102,xceb103,xceb110,xceb111,
                       xceb112,xceb113,xceb114,xceb115,xceb116,xceb117,xceb118,xceb119,xceb120,xceb201,
                       xceb202,xceb202a,xceb202b,xceb202c,xceb202d,xceb202e,xceb202f,xceb202g,xceb202h,
                       xceb212,xceb212a,xceb212b,xceb212c,xceb212d,xceb212e,xceb212f,xceb212g,xceb212h,
                       xceb222,xceb222a,xceb222b,xceb222c,xceb222d,xceb222e,xceb222f,xceb222g,xceb222h,
                       xceb301,xceb302,xceb107,xceb108,xceb109,xceb121,xceb122,xceb123,xceb124,xceb125,
                       xceb126,xceb127,xceb128,xceb129,xceb130,xceb131,xceb132)
         SELECT xcebent,xcebcomp,xcebld,xcebdocno,xcebseq,
                xceb001,xceb002,xceb003,xceb004,xceb005,xceb101,xceb102,xceb103,xceb110,xceb111,
                xceb112,xceb113,xceb114,xceb115,xceb116,xceb117,xceb118,xceb119,xceb120,xceb201,
                xceb202,xceb202a,xceb202b,xceb202c,xceb202d,xceb202e,xceb202f,xceb202g,xceb202h,
                xceb212,xceb212a,xceb212b,xceb212c,xceb212d,xceb212e,xceb212f,xceb212g,xceb212h,
                xceb222,xceb222a,xceb222b,xceb222c,xceb222d,xceb222e,xceb222f,xceb222g,xceb222h,
                xceb301,xceb302,xceb107,xceb108,xceb109,xceb121,xceb122,xceb123,xceb124,xceb125,
                xceb126,xceb127,xceb128,xceb129,xceb130,xceb131,xceb132
           FROM sourse_ins_tmp
          WHERE ((xceb201 <>  0 AND xceb202 <> 0) OR (xceb201 =  0 AND xceb202 <> 0) OR (xceb201 <>  0 AND xceb202 = 0)) #170323-00078#1 add
   DELETE FROM sourse_ins_tmp;   

   ###INS xcec_t###
   DELETE FROM sourse_ins_tmp1;
   LET g_sql = " INSERT INTO sourse_ins_tmp1 ",
               "  (xcecent,xceccomp,xcecld,xcecdocno,xcecseq,",
               "   xcec001,xcec002,xcec003,xcec004,xcec005,",
               "   xcec101,xcec102,xcec103,xcec110,xcec111,",
               "   xcec112,xcec113,xcec114,xcec115,xcec116,",
               "   xcec117,xcec118,xcec119,xcec120,xcec201,",
               "   xcec202,xcec202a,xcec202b,xcec202c,xcec202d,xcec202e,xcec202f,xcec202g,xcec202h,",
               "   xcec212,xcec212a,xcec212b,xcec212c,xcec212d,xcec212e,xcec212f,xcec212g,xcec212h,",
               "   xcec222,xcec222a,xcec222b,xcec222c,xcec222d,xcec222e,xcec222f,xcec222g,xcec222h,",
               "   xcec301,xcec302,xcec107,xcec108,xcec109,",
               "   xcec121,xcec122,xcec123,xcec124,xcec125,",
               "   xcec126,xcec127,xcec128,xcec129,xcec130,",
               "   sfaa009,sfaasite,sfaa028,",
               "   sfaa029,sfaa052,sfaa057) ",  
               " SELECT ",g_enterprise,",'",g_xcea_m.xceacomp,"','",g_xcea_m.xceald,"','",g_xcea_m.xceadocno,"',rownum,",
               "        xcck006,xcck007,(CASE WHEN xcck009 = -1 THEN '5' WHEN xcck009 = 1 THEN '6' END),xcck010 ,xcck011,",
               "        xcck032,(SELECT glab010 FROM glab_t WHERE glabld  = '",g_xcea_m.xceald,"' AND glab001 = '61' AND glab002 = '8925' AND glab003 = '8' AND glabent = ",g_enterprise,") xcec102,xcck002,xcck021,xcck022, ",
               "        xcck023,xcck024,xcck025,xcck026,xcck027,",
               "        xcck028,xcck029,xcck030,xcck031,xcck201,",
               "        xcck202,xcck202a,xcck202b,xcck202c,xcck202d,xcck202e,xcck202f,xcck202g,xcck202h,",
               "        0,0,0,0,0,0,0,0,0,",
               "        0,0,0,0,0,0,0,0,0,",
               #"        '','','','','', ", #170214-00014#1 mark
               "        '','','','',xcck022, ", #170214-00014#1 add            
               "        '','','','','', ",             
               "        '','','','','', ",             
               "        '','','', ",             
               "        '','','' ",   
               "   FROM (",
               "         SELECT xcck002,xcck006,xcck007, ",
               "                xcck010,xcck011,xcck009,xcck021,xcck022,xcck023,xcck024,xcck025,xcck026,xcck027,xcck028,",  
               "                xcck029,xcck030,xcck031,xcck032,SUM(xcck009*xcck201) xcck201,SUM(xcck009*xcck202) xcck202, ",
               "                SUM(xcck009*xcck202a) xcck202a,SUM(xcck009*xcck202b) xcck202b,SUM(xcck009*xcck202c) xcck202c,SUM(xcck009*xcck202d) xcck202d,",
               "                SUM(xcck009*xcck202e) xcck202e,SUM(xcck009*xcck202f) xcck202f,SUM(xcck009*xcck202g) xcck202g,SUM(xcck009*xcck202h) xcck202h ",
               "                FROM xcck_t ", 
               "          WHERE xcckent = '",g_enterprise,"' AND xcckld = '",g_xcea_m.xceald,"'",
               "            AND xcck003 = '",g_xcea_m.xcea003,"' AND xcck004 = ",g_xcea_m.xcea004,
               "            AND xcck005 = ",g_xcea_m.xcea005,
               "            AND xcck001 = '1' ",
               "            AND xcck020 IN ('101','301','304') ",     
               "         GROUP BY xcck002,xcck006,xcck007,xcck010,xcck011,xcck009,xcck021,xcck022,xcck023,xcck024,xcck025,xcck026,xcck027,xcck028,xcck029,xcck030,xcck031,xcck032",  
               "         ORDER BY xcck002,xcck006,xcck007,xcck010,xcck011,xcck009,xcck021,xcck022,xcck023,xcck024,xcck025,xcck026,xcck027,xcck028,xcck029,xcck030,xcck031,xcck032)" 
   PREPARE axct701_8_ins_xcec_01 FROM g_sql
   EXECUTE axct701_8_ins_xcec_01
   
   #更新本位币二金额
   LET g_sql = " MERGE INTO sourse_ins_tmp1                               ",
               " USING (SELECT xcck002,xcck006,xcck007,xcck010,xcck011,",
               "               xcck009,xcck021,xcck022,xcck023,xcck024,",
               "               xcck025,xcck026,xcck027,xcck028,xcck029,",
               "               xcck030,xcck031,xcck032,",
               "               SUM(xcck009*xcck202) xcck202, ",
               "               SUM(xcck009*xcck202a) xcck202a,SUM(xcck009*xcck202b) xcck202b,SUM(xcck009*xcck202c) xcck202c,SUM(xcck009*xcck202d) xcck202d,",
               "               SUM(xcck009*xcck202e) xcck202e,SUM(xcck009*xcck202f) xcck202f,SUM(xcck009*xcck202g) xcck202g,SUM(xcck009*xcck202h) xcck202h ",
               "          FROM xcck_t ", 
               "         WHERE xcckent = '",g_enterprise,"' AND xcckld = '",g_xcea_m.xceald,"'",
               "           AND xcck003 = '",g_xcea_m.xcea003,"' AND xcck004 = ",g_xcea_m.xcea004,
               "           AND xcck005 = ",g_xcea_m.xcea005,
               "           AND xcck020 IN ('101','301','304') ",
               "           AND xcck001 = '2' " ,
               "         GROUP BY xcck002,xcck006,xcck007,xcck010,xcck011,xcck009,xcck021,xcck022,xcck023,xcck024,xcck025,xcck026,xcck027,xcck028,xcck029,xcck030,xcck031,xcck032 )",               
               "    ON (xcec001 = xcck006 ",
               "        AND xcec002 = xcck007 ", 
               "        AND xcec110 = xcck021 ",
               "        AND (CASE xcck009 WHEN -1 THEN xcec003 = '5' WHEN  1 THEN xcec003 = '6' END) ",
               "        AND xcec103 = xcck002", 
               "        AND xcec004 = xcck010", 
               "        AND xcec005 = xcck011", 
               "        AND xcec110 = xcck021", 
               "        AND xcec111 = xcck022",      
               "        AND xcec112 = xcck023", 
               "        AND xcec113 = xcck024", 
               "        AND xcec114 = xcck025",      
               "        AND xcec115 = xcck026", 
               "        AND xcec116 = xcck027", 
               "        AND xcec117 = xcck028", 
               "        AND xcec118 = xcck029", 
               "        AND xcec119 = xcck030", 
               "        AND xcec120 = xcck031", 
               "        AND xcec101 = xcck032)",                 
               "  WHEN MATCHED THEN ",
               "UPDATE SET xcec212  = xcck202 ,",
               "           xcec212a = xcck202a,",
               "           xcec212b = xcck202b,",
               "           xcec212c = xcck202c,",
               "           xcec212d = xcck202d,",
               "           xcec212e = xcck202e,",
               "           xcec212f = xcck202f,",
               "           xcec212g = xcck202g,",
               "           xcec212h = xcck202h "
   PREPARE axct701_8_upd_xcec212 FROM g_sql
   EXECUTE axct701_8_upd_xcec212

   #更新本位币三金额
   LET g_sql = " MERGE INTO sourse_ins_tmp1                               ",
               " USING (SELECT xcck002,xcck006,xcck007,xcck010,xcck011,",
               "               xcck009,xcck021,xcck022,xcck023,xcck024,",
               "               xcck025,xcck026,xcck027,xcck028,xcck029,",
               "               xcck030,xcck031,xcck032,",
               "               SUM(xcck009*xcck202) xcck202, ",
               "               SUM(xcck009*xcck202a) xcck202a,SUM(xcck009*xcck202b) xcck202b,SUM(xcck009*xcck202c) xcck202c,SUM(xcck009*xcck202d) xcck202d,",
               "               SUM(xcck009*xcck202e) xcck202e,SUM(xcck009*xcck202f) xcck202f,SUM(xcck009*xcck202g) xcck202g,SUM(xcck009*xcck202h) xcck202h ",
               "          FROM xcck_t ", 
               "         WHERE xcckent = '",g_enterprise,"' AND xcckld = '",g_xcea_m.xceald,"'",
               "           AND xcck003 = '",g_xcea_m.xcea003,"' AND xcck004 = ",g_xcea_m.xcea004,
               "           AND xcck005 = ",g_xcea_m.xcea005,
               "           AND xcck020 IN ('101','301','304')",
               "           AND xcck001 = '3' ", 
               "         GROUP BY xcck002,xcck006,xcck007,xcck010,xcck011,xcck009,xcck021,xcck022,xcck023,xcck024,xcck025,xcck026,xcck027,xcck028,xcck029,xcck030,xcck031,xcck032 )",               
               "    ON (xcec001 = xcck006 ",
               "        AND xcec002 = xcck007 ", 
               "        AND xcec110 = xcck021 ",
               "        AND (CASE xcck009 WHEN -1 THEN xcec003 = '5' WHEN  1 THEN xcec003 = '6' END) ",
               "        AND xcec103 = xcck002", 
               "        AND xcec004 = xcck010", 
               "        AND xcec005 = xcck011", 
               "        AND xcec110 = xcck021", 
               "        AND xcec111 = xcck022",      
               "        AND xcec112 = xcck023", 
               "        AND xcec113 = xcck024", 
               "        AND xcec114 = xcck025",      
               "        AND xcec115 = xcck026", 
               "        AND xcec116 = xcck027", 
               "        AND xcec117 = xcck028", 
               "        AND xcec118 = xcck029", 
               "        AND xcec119 = xcck030", 
               "        AND xcec120 = xcck031", 
               "        AND xcec101 = xcck032)",                 
               "  WHEN MATCHED THEN ",
               "UPDATE SET xcec222  = xcck202 ,",
               "           xcec222a = xcck202a,",
               "           xcec222b = xcck202b,",
               "           xcec222c = xcck202c,",
               "           xcec222d = xcck202d,",
               "           xcec222e = xcck202e,",
               "           xcec222f = xcck202f,",
               "           xcec222g = xcck202g,",
               "           xcec222h = xcck202h "
   PREPARE axct701_8_upd_xcec222 FROM g_sql
   EXECUTE axct701_8_upd_xcec222

   #抓取科目
   UPDATE sourse_ins_tmp1
      SET sfaasite = (SELECT imag011 FROM imag_t
                       WHERE imagent = g_enterprise AND imagsite = g_xcea_m.xceacomp
                         AND imag001 = xcec004)    
   
   UPDATE sourse_ins_tmp1 
      SET xcec101 = (SELECT DISTINCT glcc002 FROM glcc_t 
                      WHERE glccent = g_enterprise
                        AND glcc001 = '1'  
                        AND glccld  = g_xcea_m.xceald
                        AND (glcc014= g_xcea_m.xceacomp OR glcc014='*' )
                        AND (glcc016=xcec004 OR glcc016 = '*')
                        AND (glcc011=sfaasite OR glcc011='*')
                        AND rownum = 1)   
    WHERE xcec101 IS NULL OR xcec101 = ' '
   
   UPDATE sourse_ins_tmp1 
      SET xcec108 = (SELECT inba004
                       FROM inba_t
                      WHERE inbaent = g_enterprise
                        AND inbadocno = xcec001)
                        
   UPDATE sourse_ins_tmp1 
      SET xcec110 = (SELECT inba007
                       FROM inba_t
                      WHERE inbaent = g_enterprise
                        AND inbadocno = xcec001)
    WHERE xcec110 IS NULL   

  #启用交易对象
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad010 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad010 = 'N'  ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec111 = ' '"
   PREPARE axct701_8_upd_xcec111 FROM g_sql
   EXECUTE axct701_8_upd_xcec111

  #启用客群
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad011 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad011 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec112 = ' '"
   PREPARE axct701_8_upd_xcec112 FROM g_sql
   EXECUTE axct701_8_upd_xcec112

  #启用区域
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad009 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad009 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec113 = ' '"
   PREPARE axct701_8_upd_xcec113 FROM g_sql
   EXECUTE axct701_8_upd_xcec113

   
  #启用成本中心
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad008 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad008 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec114 = ' '"
   PREPARE axct701_8_upd_xcec114 FROM g_sql
   EXECUTE axct701_8_upd_xcec114
   
  #启用经营类别
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad031 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad031 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec115 = ' '"
   PREPARE axct701_8_upd_xcec115 FROM g_sql
   EXECUTE axct701_8_upd_xcec115
 
  #启用渠道
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad032 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad032 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec116 = ' '"
   PREPARE axct701_8_upd_xcec116 FROM g_sql
   EXECUTE axct701_8_upd_xcec116

  #启用品类
  #170221-00041#1 add start ----
   UPDATE sourse_ins_tmp1
      SET xcec117 = (SELECT imag011 FROM imag_t
                      WHERE imagent = xcecent
                        AND imagsite = g_xcea_m.xceacomp
                        AND imag001 = xcec004)
  #170221-00041#1 add end   ----  
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad012 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad012 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec117 = ' '"
   PREPARE axct701_8_upd_xcec117 FROM g_sql
   EXECUTE axct701_8_upd_xcec117
   
  #启用品牌
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad033 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad033 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec118 = ' '"
   PREPARE axct701_8_upd_xcec118 FROM g_sql
   EXECUTE axct701_8_upd_xcec118
 
  #启用项目号
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad015 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad015 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec119 = ' '"
   PREPARE axct701_8_upd_xcec119 FROM g_sql
   EXECUTE axct701_8_upd_xcec119
 
  #启用WBS
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad016 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad016 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec120 = ' '"
   PREPARE axct701_8_upd_xcec120 FROM g_sql
   EXECUTE axct701_8_upd_xcec120
 
  #启用人员
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad013 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad013 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec107 = ' '"
   PREPARE axct701_8_upd_xcec107 FROM g_sql
   EXECUTE axct701_8_upd_xcec107
 
  #启用部门
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad007 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad007 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec108 = ' '"
   PREPARE axct701_8_upd_xcec108 FROM g_sql
   EXECUTE axct701_8_upd_xcec108
   
  #启用账款对象
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad027 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad027 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec109 = ' '"
   PREPARE axct701_8_upd_xcec109 FROM g_sql
   EXECUTE axct701_8_upd_xcec109
   
  #启用自由核算项1
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad017 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad017 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec121 = ' '"
   PREPARE axct701_8_upd_xcec121 FROM g_sql
   EXECUTE axct701_8_upd_xcec121
 
  #启用自由核算项2
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad018 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad018 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec122 = ' '"
   PREPARE axct701_8_upd_xcec122 FROM g_sql
   EXECUTE axct701_8_upd_xcec122
 
  #启用自由核算项3
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad019 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad019 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec123 = ' '"
   PREPARE axct701_8_upd_xcec123 FROM g_sql
   EXECUTE axct701_8_upd_xcec123

  #启用自由核算项4
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad019 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad019 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec124 = ' '"
   PREPARE axct701_8_upd_xcec124 FROM g_sql
   EXECUTE axct701_8_upd_xcec124

  #启用自由核算项5
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad021 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad021 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec125 = ' '"
   PREPARE axct701_8_upd_xcec125 FROM g_sql
   EXECUTE axct701_8_upd_xcec125

  #启用自由核算项6
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad022 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad022 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec126 = ' '"
   PREPARE axct701_8_upd_xcec126 FROM g_sql
   EXECUTE axct701_8_upd_xcec126

  #启用自由核算项7
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad023 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad023 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec127 = ' '"
   PREPARE axct701_8_upd_xcec127 FROM g_sql
   EXECUTE axct701_8_upd_xcec127

  #启用自由核算项8
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad024 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad024 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec128 = ' '"
   PREPARE axct701_8_upd_xcec128 FROM g_sql
   EXECUTE axct701_8_upd_xcec128

  #启用自由核算项9
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad025 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad025 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec129 = ' '"
   PREPARE axct701_8_upd_xcec129 FROM g_sql
   EXECUTE axct701_8_upd_xcec129

  #启用自由核算项10
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad026 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad026 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec130 = ' '"
   PREPARE axct701_8_upd_xcec130 FROM g_sql
   EXECUTE axct701_8_upd_xcec130
   
  #来源单项次
   #UPDATE sourse_ins_tmp1 SET xcec002 = ''  #170207-00058#1 mark 
  #特性
   UPDATE sourse_ins_tmp1 SET xcec005 = ' ' WHERE xcec005 IS NULL
 #科目编号
   UPDATE sourse_ins_tmp1 SET xcec101 = ' ' WHERE xcec101 IS NULL
  #摘要
   UPDATE sourse_ins_tmp1 SET xcec102 = ' ' WHERE xcec102 IS NULL
  #成本域
   UPDATE sourse_ins_tmp1 SET xcec103 = ' ' WHERE xcec103 IS NULL
  #原因码
   UPDATE sourse_ins_tmp1 SET xcec110 = ' ' WHERE xcec110 IS NULL
  #交易对象
   UPDATE sourse_ins_tmp1 SET xcec111 = ' ' WHERE xcec111 IS NULL
  #客群
   UPDATE sourse_ins_tmp1 SET xcec112 = ' ' WHERE xcec112 IS NULL
  #区域
   UPDATE sourse_ins_tmp1 SET xcec113 = ' ' WHERE xcec113 IS NULL
  #成本中心
   UPDATE sourse_ins_tmp1 SET xcec114 = ' ' WHERE xcec114 IS NULL
  #经营类别
   UPDATE sourse_ins_tmp1 SET xcec115 = ' ' WHERE xcec115 IS NULL
  #渠道
   UPDATE sourse_ins_tmp1 SET xcec116 = ' ' WHERE xcec116 IS NULL
  #品类
   UPDATE sourse_ins_tmp1 SET xcec117 = ' ' WHERE xcec117 IS NULL
  #品牌
   UPDATE sourse_ins_tmp1 SET xcec118 = ' ' WHERE xcec118 IS NULL
  #项目号
   UPDATE sourse_ins_tmp1 SET xcec119 = ' ' WHERE xcec119 IS NULL
  #WBS
   UPDATE sourse_ins_tmp1 SET xcec120 = ' ' WHERE xcec120 IS NULL
  #人员
   UPDATE sourse_ins_tmp1 SET xcec107 = ' ' WHERE xcec107 IS NULL
   #部门
   UPDATE sourse_ins_tmp1 SET xcec108 = ' ' WHERE xcec108 IS NULL
  #账款对象
   UPDATE sourse_ins_tmp1 SET xcec109 = ' ' WHERE xcec109 IS NULL
  #自由核算项1
   UPDATE sourse_ins_tmp1 SET xcec121 = ' ' WHERE xcec121 IS NULL
  #自由核算项2
   UPDATE sourse_ins_tmp1 SET xcec122 = ' ' WHERE xcec122 IS NULL
  #自由核算项3
   UPDATE sourse_ins_tmp1 SET xcec123 = ' ' WHERE xcec123 IS NULL
  #自由核算项4
   UPDATE sourse_ins_tmp1 SET xcec124 = ' ' WHERE xcec124 IS NULL
  #自由核算项5
   UPDATE sourse_ins_tmp1 SET xcec125 = ' ' WHERE xcec125 IS NULL
  #自由核算项6
   UPDATE sourse_ins_tmp1 SET xcec126 = ' ' WHERE xcec126 IS NULL
   #自由核算项7
   UPDATE sourse_ins_tmp1 SET xcec127 = ' ' WHERE xcec127 IS NULL
  #自由核算项8
   UPDATE sourse_ins_tmp1 SET xcec128 = ' ' WHERE xcec128 IS NULL
  #自由核算项9
   UPDATE sourse_ins_tmp1 SET xcec129 = ' ' WHERE xcec129 IS NULL
  #自由核算项10
   UPDATE sourse_ins_tmp1 SET xcec130 = ' ' WHERE xcec130 IS NULL
   
   
   LET g_sql = " MERGE INTO sourse_ins_tmp1 a                   ",
               " USING ( SELECT xcec103,xcec001,xcec002,xcec003,xcec004,xcec005,",
               "                SUM(xcec201) xcec201,SUM(xcec202) xcec202, ",
               "                SUM(xcec202a) xcec202a,SUM(xcec202b) xcec202b,SUM(xcec202c) xcec202c,SUM(xcec202d) xcec202d,",
               "                SUM(xcec202e) xcec202e,SUM(xcec202f) xcec202f,SUM(xcec202g) xcec202g,SUM(xcec202h) xcec202h, ",
               "                SUM(xcec212) xcec212,SUM(xcec212a) xcec212a,SUM(xcec212b) xcec212b,SUM(xcec212c) xcec212c,SUM(xcec212d) xcec212d,",
               "                SUM(xcec212e) xcec212e,SUM(xcec212f) xcec212f,SUM(xcec212g) xcec212g,SUM(xcec212h) xcec212h, ",
               "                SUM(xcec222) xcec222,SUM(xcec222a) xcec222a,SUM(xcec222b) xcec222b,SUM(xcec222c) xcec222c,SUM(xcec222d) xcec222d,",
               "                SUM(xcec222e) xcec222e,SUM(xcec222f) xcec222f,SUM(xcec222g) xcec222g,SUM(xcec222h) xcec222h ",               
               "           FROM xcea_t LEFT OUTER JOIN xcec_t ON xceaent = xcecent AND xceald = xcecld AND xceadocno = xcecdocno ",          
               "          WHERE xceaent = ",g_enterprise," AND xceald = '",g_xcea_m.xceald,"'",
               "            AND xcea003 = '",g_xcea_m.xcea003,"' AND xcea004 = ",g_xcea_m.xcea004,
               "            AND xcea005 = ",g_xcea_m.xcea005," AND xcea002 = '7' ",
               "          GROUP BY xcec103,xcec001,xcec002,xcec003,xcec004,xcec005) b",
               "            ON( a.xcec103 = b.xcec103 ",               
               "            AND a.xcec001 = b.xcec001 ",
               "            AND a.xcec002 = b.xcec002 ",  
               "            AND a.xcec003 = b.xcec003 ",
               "            AND a.xcec004 = b.xcec004 ", 
               "            AND a.xcec005 = b.xcec005) ",
               "    WHEN MATCHED THEN     ",
               "    UPDATE SET a.xcec201  = a.xcec201  - b.xcec201 ,",            
               "               a.xcec202  = a.xcec202  - b.xcec202 ,",
               "               a.xcec202a = a.xcec202a - b.xcec202a,",
               "               a.xcec202b = a.xcec202b - b.xcec202b,",
               "               a.xcec202c = a.xcec202c - b.xcec202c,",
               "               a.xcec202d = a.xcec202d - b.xcec202d,",
               "               a.xcec202e = a.xcec202e - b.xcec202e,",
               "               a.xcec202f = a.xcec202f - b.xcec202f,",
               "               a.xcec202g = a.xcec202g - b.xcec202g,",
               "               a.xcec202h = a.xcec202h - b.xcec202h,",
               "               a.xcec212  = a.xcec212  - b.xcec212 ,",
               "               a.xcec212a = a.xcec212a - b.xcec212a,",
               "               a.xcec212b = a.xcec212b - b.xcec212b,",
               "               a.xcec212c = a.xcec212c - b.xcec212c,",
               "               a.xcec212d = a.xcec212d - b.xcec212d,",
               "               a.xcec212e = a.xcec212e - b.xcec212e,",
               "               a.xcec212f = a.xcec212f - b.xcec212f,",
               "               a.xcec212g = a.xcec212g - b.xcec212g,",
               "               a.xcec212h = a.xcec212h - b.xcec212h,",
               "               a.xcec222  = a.xcec222  - b.xcec222 ,",
               "               a.xcec222a = a.xcec222a - b.xcec222a,",
               "               a.xcec222b = a.xcec222b - b.xcec222b,",
               "               a.xcec222c = a.xcec222c - b.xcec222c,",
               "               a.xcec222d = a.xcec222d - b.xcec222d,",
               "               a.xcec222e = a.xcec222e - b.xcec222e,",
               "               a.xcec222f = a.xcec222f - b.xcec222f,",
               "               a.xcec222g = a.xcec222g - b.xcec222g,",
               "               a.xcec222h = a.xcec222h - b.xcec222h "
   PREPARE axct701_8_upd_xcec2 FROM g_sql
   EXECUTE axct701_8_upd_xcec2
   
   INSERT INTO xcec_t (xcecent,xceccomp,xcecld,xcecdocno,xcecseq,
                       xcec001,xcec002,xcec003,xcec004,xcec005,xcec101,xcec102,xcec103,xcec110,xcec111,
                       xcec112,xcec113,xcec114,xcec115,xcec116,xcec117,xcec118,xcec119,xcec120,xcec201,
                       xcec202,xcec202a,xcec202b,xcec202c,xcec202d,xcec202e,xcec202f,xcec202g,xcec202h,
                       xcec212,xcec212a,xcec212b,xcec212c,xcec212d,xcec212e,xcec212f,xcec212g,xcec212h,
                       xcec222,xcec222a,xcec222b,xcec222c,xcec222d,xcec222e,xcec222f,xcec222g,xcec222h,
                       xcec301,xcec302,xcec107,xcec108,xcec109,xcec121,xcec122,xcec123,xcec124,xcec125,
                       xcec126,xcec127,xcec128,xcec129,xcec130)
         SELECT xcecent,xceccomp,xcecld,xcecdocno,xcecseq,
                xcec001,xcec002,xcec003,xcec004,xcec005,xcec101,xcec102,xcec103,xcec110,xcec111,
                xcec112,xcec113,xcec114,xcec115,xcec116,xcec117,xcec118,xcec119,xcec120,xcec201,
                xcec202,xcec202a,xcec202b,xcec202c,xcec202d,xcec202e,xcec202f,xcec202g,xcec202h,
                xcec212,xcec212a,xcec212b,xcec212c,xcec212d,xcec212e,xcec212f,xcec212g,xcec212h,
                xcec222,xcec222a,xcec222b,xcec222c,xcec222d,xcec222e,xcec222f,xcec222g,xcec222h,
                xcec301,xcec302,xcec107,xcec108,xcec109,xcec121,xcec122,xcec123,xcec124,xcec125,
                xcec126,xcec127,xcec128,xcec129,xcec130
           FROM sourse_ins_tmp1
          WHERE ((xcec201 <>  0 AND xcec202 = 0) OR (xcec201 = 0 AND xcec202 <> 0) OR (xcec201 <>  0 AND xcec202 <> 0)) #170323-00078#1 add
   DELETE FROM sourse_ins_tmp1; 
   RETURN g_success
END FUNCTION

################################################################################
# Descriptions...: axct709批次产生   13.制費結轉傳票
# Memo...........: 
# Date & Author..: 2017/01/20 By 02295
# Modify.........: #170105-00011#4 效能优化版，原function为axct701_01_ins_9_bak()
################################################################################
PRIVATE FUNCTION axct701_01_ins_9()
DEFINE l_xcea          RECORD  #工單發料成本憑證單頭檔
       xceaent LIKE xcea_t.xceaent, #企業編號
       xceacomp LIKE xcea_t.xceacomp, #法人組織
       xceald LIKE xcea_t.xceald, #帳套
       xceadocno LIKE xcea_t.xceadocno, #單據編號
       xcea001 LIKE xcea_t.xcea001, #單據日期
       xcea002 LIKE xcea_t.xcea002, #成本憑證類型
       xcea003 LIKE xcea_t.xcea003, #成本計算類型
       xcea004 LIKE xcea_t.xcea004, #年度
       xcea005 LIKE xcea_t.xcea005, #期別
       xcea006 LIKE xcea_t.xcea006, #帳務人員
       xcea007 LIKE xcea_t.xcea007, #帳務部門
       xcea101 LIKE xcea_t.xcea101, #憑證編號
       xcea102 LIKE xcea_t.xcea102, #憑證日期
       xceaownid LIKE xcea_t.xceaownid, #資料所有者
       xceaowndp LIKE xcea_t.xceaowndp, #資料所屬部門
       xceacrtid LIKE xcea_t.xceacrtid, #資料建立者
       xceacrtdp LIKE xcea_t.xceacrtdp, #資料建立部門
       xceacrtdt LIKE xcea_t.xceacrtdt, #資料創建日
       xceamodid LIKE xcea_t.xceamodid, #資料修改者
       xceamoddt LIKE xcea_t.xceamoddt, #最近修改日
       xceacnfid LIKE xcea_t.xceacnfid, #資料確認者
       xceacnfdt LIKE xcea_t.xceacnfdt, #資料確認日
       xceapstid LIKE xcea_t.xceapstid, #資料過帳者
       xceapstdt LIKE xcea_t.xceapstdt, #資料過帳日
       xceastus LIKE xcea_t.xceastus, #狀態碼
       xceaud001 LIKE xcea_t.xceaud001, #自定義欄位(文字)001
       xceaud002 LIKE xcea_t.xceaud002, #自定義欄位(文字)002
       xceaud003 LIKE xcea_t.xceaud003, #自定義欄位(文字)003
       xceaud004 LIKE xcea_t.xceaud004, #自定義欄位(文字)004
       xceaud005 LIKE xcea_t.xceaud005, #自定義欄位(文字)005
       xceaud006 LIKE xcea_t.xceaud006, #自定義欄位(文字)006
       xceaud007 LIKE xcea_t.xceaud007, #自定義欄位(文字)007
       xceaud008 LIKE xcea_t.xceaud008, #自定義欄位(文字)008
       xceaud009 LIKE xcea_t.xceaud009, #自定義欄位(文字)009
       xceaud010 LIKE xcea_t.xceaud010, #自定義欄位(文字)010
       xceaud011 LIKE xcea_t.xceaud011, #自定義欄位(數字)011
       xceaud012 LIKE xcea_t.xceaud012, #自定義欄位(數字)012
       xceaud013 LIKE xcea_t.xceaud013, #自定義欄位(數字)013
       xceaud014 LIKE xcea_t.xceaud014, #自定義欄位(數字)014
       xceaud015 LIKE xcea_t.xceaud015, #自定義欄位(數字)015
       xceaud016 LIKE xcea_t.xceaud016, #自定義欄位(數字)016
       xceaud017 LIKE xcea_t.xceaud017, #自定義欄位(數字)017
       xceaud018 LIKE xcea_t.xceaud018, #自定義欄位(數字)018
       xceaud019 LIKE xcea_t.xceaud019, #自定義欄位(數字)019
       xceaud020 LIKE xcea_t.xceaud020, #自定義欄位(數字)020
       xceaud021 LIKE xcea_t.xceaud021, #自定義欄位(日期時間)021
       xceaud022 LIKE xcea_t.xceaud022, #自定義欄位(日期時間)022
       xceaud023 LIKE xcea_t.xceaud023, #自定義欄位(日期時間)023
       xceaud024 LIKE xcea_t.xceaud024, #自定義欄位(日期時間)024
       xceaud025 LIKE xcea_t.xceaud025, #自定義欄位(日期時間)025
       xceaud026 LIKE xcea_t.xceaud026, #自定義欄位(日期時間)026
       xceaud027 LIKE xcea_t.xceaud027, #自定義欄位(日期時間)027
       xceaud028 LIKE xcea_t.xceaud028, #自定義欄位(日期時間)028
       xceaud029 LIKE xcea_t.xceaud029, #自定義欄位(日期時間)029
       xceaud030 LIKE xcea_t.xceaud030, #自定義欄位(日期時間)030
       xceasite LIKE xcea_t.xceasite  #營運據點
          END RECORD
DEFINE ld_date         DATETIME YEAR TO SECOND
DEFINE l_success       LIKE type_t.num5
         

  #CALL axct701_01_create_tmp()    #170324-00054#1 mark
   
   LET g_success = 'Y'
   LET l_xcea.xceaownid = g_user
   LET l_xcea.xceaowndp = g_dept
   LET l_xcea.xceacrtid = g_user
   LET l_xcea.xceacrtdp = g_dept 
   LET ld_date  = cl_get_current()
   LET l_xcea.xceacrtdt = ld_date
   LET l_xcea.xceamodid = ""
   LET l_xcea.xceamoddt = ""
   CALL s_aooi200_fin_gen_docno(g_xcea_m.xceald,'','',g_xcea_m.xceadocno,g_xcea_m.xcea001,g_prog_name1)      #wujie 150214
    RETURNING l_success,g_xcea_m.xceadocno
   IF l_success  = 0  THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = 'apm-00003'
      LET g_errparam.extend = g_xcea_m.xceadocno
      LET g_errparam.popup = TRUE
      CALL cl_err()

      LET g_success = 'N'
      RETURN g_success
   END IF
   
   INSERT INTO xcea_t (xceaent,xceald,xceacomp,xceadocno,xcea001,xcea002,xcea003,xcea004, 
                       xcea005,xcea006,xcea007,xceastus,xceaownid,xceaowndp,xceacrtid,xceacrtdp,
                       xceacrtdt, xceamodid,xceamoddt)
   VALUES (g_enterprise,g_xcea_m.xceald,g_xcea_m.xceacomp,g_xcea_m.xceadocno,g_xcea_m.xcea001,g_xcea002,
           g_xcea_m.xcea003,g_xcea_m.xcea004,g_xcea_m.xcea005,g_xcea_m.xcea006,g_xcea_m.xcea007, 
           'N',l_xcea.xceaownid,l_xcea.xceaowndp,l_xcea.xceacrtid, 
           l_xcea.xceacrtdp,ld_date,l_xcea.xceamodid,l_xcea.xceamoddt) 
       
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "ins xcea_t"
      LET g_errparam.popup = TRUE
      CALL cl_err()
  
      LET g_success = 'N'
      RETURN g_success
   END IF
   
   ###INS xceb_t###
   DELETE FROM sourse_ins_tmp;
   LET g_sql = " INSERT INTO sourse_ins_tmp ",
               "  (xcebent,xcebcomp,xcebld,xcebdocno,xcebseq,",
               "   xceb001,xceb002,xceb003,xceb004,xceb005,",
               "   xceb101,xceb102,xceb103,xceb110,xceb111,",
               "   xceb112,xceb113,xceb114,xceb115,xceb116,",
               "   xceb117,xceb118,xceb119,xceb120,xceb201,",
               "   xceb202,xceb202a,xceb202b,xceb202c,xceb202d,xceb202e,xceb202f,xceb202g,xceb202h,",
               "   xceb212,xceb212a,xceb212b,xceb212c,xceb212d,xceb212e,xceb212f,xceb212g,xceb212h,",
               "   xceb222,xceb222a,xceb222b,xceb222c,xceb222d,xceb222e,xceb222f,xceb222g,xceb222h,",
               "   xceb301,xceb302,xceb107,xceb108,xceb109,",
               "   xceb121,xceb122,xceb123,xceb124,xceb125,",
               "   xceb126,xceb127,xceb128,xceb129,xceb130,",
               "   xceb131,xceb132,sfaa009,sfaasite,sfaa028,",
               "   sfaa029,sfaa052,sfaa057) ",  
               " SELECT ",g_enterprise,",'",g_xcea_m.xceacomp,"','",g_xcea_m.xceald,"','",g_xcea_m.xceadocno,"',rownum,",
               "        '','',xcbl001,'' ,'',",
               "        xcbl010,(SELECT glab010 FROM glab_t WHERE glabld  = '",g_xcea_m.xceald,"' AND glab001 = '61' AND glab002 = '8925' AND glab003 = '9' AND glabent = ",g_enterprise,") xceb102,'','',xcbl013, ",
               "        xcbl014,xcbl015,xcbl016,xcbl017,xcbl018,",
               "        xcbl019,xcbl020,xcbl021,xcbl022,'',",
               "        xcbl100,0,0,0,0,0,0,0,0,",
               "        xcbl110,0,0,0,0,0,0,0,0,",
               "        xcbl120,0,0,0,0,0,0,0,0,",
               "        '','',xcbl025,xcbl012,xcbl024, ",             
               "        '','','','','', ",             
               "        '','','','','', ",             
               "        '','','','','', ",             
               "        '','','' ",     #因xceb_t没有批号，所以这边暂时用临时表中的sfaa029记录
               "   FROM (",
               "         SELECT xcbl001,xcbl010,xcbl019,xcbl020,xcbl016,",
               "                xcbl017,xcbl018,xcbl021,xcbl022,xcbl013,",
               "                xcbl014,xcbl015,xcbl012,xcbl024,xcbl025,",
               "                SUM(xcbl100) xcbl100,SUM(xcbl110) xcbl110,SUM(xcbl120) xcbl120 ",
               "           FROM xcbl_t ",  
               "          WHERE xcblent  = '",g_enterprise,"'",
               "            AND xcblcomp = '",g_xcea_m.xceacomp,"'",
               "            AND xcblld   = '",g_xcea_m.xceald,"'",
               #"            AND xcbl001 <> '1' ", #170317-00012#1 mark
               "            AND xcbl002  = '",g_xcea_m.xcea004,"'",
               "            AND xcbl003  = '",g_xcea_m.xcea005,"'",
               "          GROUP BY xcbl001,xcbl010,xcbl019,xcbl020,xcbl016,xcbl017,xcbl018,xcbl021,xcbl022,xcbl013,xcbl014,xcbl015,xcbl012,xcbl024,xcbl025)"
   PREPARE axct701_9_ins_xceb_01 FROM g_sql
   EXECUTE axct701_9_ins_xceb_01

  #启用交易对象
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad010 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad010 = 'N'  ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb111 = ' '"
   PREPARE axct701_9_upd_xceb111 FROM g_sql
   EXECUTE axct701_9_upd_xceb111

  #启用客群
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad011 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad011 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb112 = ' '"
   PREPARE axct701_9_upd_xceb112 FROM g_sql
   EXECUTE axct701_9_upd_xceb112

  #启用区域
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad009 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad009 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb113 = ' '"
   PREPARE axct701_9_upd_xceb113 FROM g_sql
   EXECUTE axct701_9_upd_xceb113

   
  #启用成本中心
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad008 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad008 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb114 = ' '"
   PREPARE axct701_9_upd_xceb114 FROM g_sql
   EXECUTE axct701_9_upd_xceb114
   
  #启用经营类别
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad031 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad031 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb115 = ' '"
   PREPARE axct701_9_upd_xceb115 FROM g_sql
   EXECUTE axct701_9_upd_xceb115
 
  #启用渠道
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad032 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad032 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb116 = ' '"
   PREPARE axct701_9_upd_xceb116 FROM g_sql
   EXECUTE axct701_9_upd_xceb116

  #启用品类
  #170221-00041#1 add start ----
   UPDATE sourse_ins_tmp
      SET xceb117 = (SELECT imag011 FROM imag_t
                      WHERE imagent = xcebent
                        AND imagsite = g_xcea_m.xceacomp
                        AND imag001 = xceb004)
  #170221-00041#1 add end   ----    
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad012 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad012 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb117 = ' '"
   PREPARE axct701_9_upd_xceb117 FROM g_sql
   EXECUTE axct701_9_upd_xceb117
   
  #启用品牌
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad033 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad033 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb118 = ' '"
   PREPARE axct701_9_upd_xceb118 FROM g_sql
   EXECUTE axct701_9_upd_xceb118
 
  #启用项目号
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad015 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad015 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb119 = ' '"
   PREPARE axct701_9_upd_xceb119 FROM g_sql
   EXECUTE axct701_9_upd_xceb119
 
  #启用WBS
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad016 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad016 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb120 = ' '"
   PREPARE axct701_9_upd_xceb120 FROM g_sql
   EXECUTE axct701_9_upd_xceb120
 
  #启用人员
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad013 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad013 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb107 = ' '"
   PREPARE axct701_9_upd_xceb107 FROM g_sql
   EXECUTE axct701_9_upd_xceb107
 
  #启用部门
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad007 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad007 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb108 = ' '"
   PREPARE axct701_9_upd_xceb108 FROM g_sql
   EXECUTE axct701_9_upd_xceb108
   
  #启用账款对象
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad027 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad027 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb109 = ' '"
   PREPARE axct701_9_upd_xceb109 FROM g_sql
   EXECUTE axct701_9_upd_xceb109
   
  #启用自由核算项1
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad017 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad017 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb121 = ' '"
   PREPARE axct701_9_upd_xceb121 FROM g_sql
   EXECUTE axct701_9_upd_xceb121
 
  #启用自由核算项2
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad018 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad018 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb122 = ' '"
   PREPARE axct701_9_upd_xceb122 FROM g_sql
   EXECUTE axct701_9_upd_xceb122
 
  #启用自由核算项3
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad019 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad019 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb123 = ' '"
   PREPARE axct701_9_upd_xceb123 FROM g_sql
   EXECUTE axct701_9_upd_xceb123

  #启用自由核算项4
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad019 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad019 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb124 = ' '"
   PREPARE axct701_9_upd_xceb124 FROM g_sql
   EXECUTE axct701_9_upd_xceb124

  #启用自由核算项5
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad021 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad021 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb125 = ' '"
   PREPARE axct701_9_upd_xceb125 FROM g_sql
   EXECUTE axct701_9_upd_xceb125

  #启用自由核算项6
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad022 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad022 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb126 = ' '"
   PREPARE axct701_9_upd_xceb126 FROM g_sql
   EXECUTE axct701_9_upd_xceb126

  #启用自由核算项7
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad023 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad023 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb127 = ' '"
   PREPARE axct701_9_upd_xceb127 FROM g_sql
   EXECUTE axct701_9_upd_xceb127

  #启用自由核算项8
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad024 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad024 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb128 = ' '"
   PREPARE axct701_9_upd_xceb128 FROM g_sql
   EXECUTE axct701_9_upd_xceb128

  #启用自由核算项9
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad025 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad025 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb129 = ' '"
   PREPARE axct701_9_upd_xceb129 FROM g_sql
   EXECUTE axct701_9_upd_xceb129

  #启用自由核算项10
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad026 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad026 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb130 = ' '"
   PREPARE axct701_9_upd_xceb130 FROM g_sql
   EXECUTE axct701_9_upd_xceb130
   
  #特性
   UPDATE sourse_ins_tmp SET xceb005 = ' ' WHERE xceb005 IS NULL
 #科目编号
   UPDATE sourse_ins_tmp SET xceb101 = ' ' WHERE xceb101 IS NULL
  #摘要
   UPDATE sourse_ins_tmp SET xceb102 = ' ' WHERE xceb102 IS NULL
  #成本域
   UPDATE sourse_ins_tmp SET xceb103 = ' ' WHERE xceb103 IS NULL
  #原因码
   UPDATE sourse_ins_tmp SET xceb110 = ' ' WHERE xceb110 IS NULL
  #交易对象
   UPDATE sourse_ins_tmp SET xceb111 = ' ' WHERE xceb111 IS NULL
  #客群
   UPDATE sourse_ins_tmp SET xceb112 = ' ' WHERE xceb112 IS NULL
  #区域
   UPDATE sourse_ins_tmp SET xceb113 = ' ' WHERE xceb113 IS NULL
  #成本中心
   UPDATE sourse_ins_tmp SET xceb114 = ' ' WHERE xceb114 IS NULL
  #经营类别
   UPDATE sourse_ins_tmp SET xceb115 = ' ' WHERE xceb115 IS NULL
  #渠道
   UPDATE sourse_ins_tmp SET xceb116 = ' ' WHERE xceb116 IS NULL
  #品类
   UPDATE sourse_ins_tmp SET xceb117 = ' ' WHERE xceb117 IS NULL
  #品牌
   UPDATE sourse_ins_tmp SET xceb118 = ' ' WHERE xceb118 IS NULL
  #项目号
   UPDATE sourse_ins_tmp SET xceb119 = ' ' WHERE xceb119 IS NULL
  #WBS
   UPDATE sourse_ins_tmp SET xceb120 = ' ' WHERE xceb120 IS NULL
  #人员
   UPDATE sourse_ins_tmp SET xceb107 = ' ' WHERE xceb107 IS NULL
   #部门
   UPDATE sourse_ins_tmp SET xceb108 = ' ' WHERE xceb108 IS NULL
  #账款对象
   UPDATE sourse_ins_tmp SET xceb109 = ' ' WHERE xceb109 IS NULL
  #自由核算项1
   UPDATE sourse_ins_tmp SET xceb121 = ' ' WHERE xceb121 IS NULL
  #自由核算项2
   UPDATE sourse_ins_tmp SET xceb122 = ' ' WHERE xceb122 IS NULL
  #自由核算项3
   UPDATE sourse_ins_tmp SET xceb123 = ' ' WHERE xceb123 IS NULL
  #自由核算项4
   UPDATE sourse_ins_tmp SET xceb124 = ' ' WHERE xceb124 IS NULL
  #自由核算项5
   UPDATE sourse_ins_tmp SET xceb125 = ' ' WHERE xceb125 IS NULL
  #自由核算项6
   UPDATE sourse_ins_tmp SET xceb126 = ' ' WHERE xceb126 IS NULL
   #自由核算项7
   UPDATE sourse_ins_tmp SET xceb127 = ' ' WHERE xceb127 IS NULL
  #自由核算项8
   UPDATE sourse_ins_tmp SET xceb128 = ' ' WHERE xceb128 IS NULL
  #自由核算项9
   UPDATE sourse_ins_tmp SET xceb129 = ' ' WHERE xceb129 IS NULL
  #自由核算项10
   UPDATE sourse_ins_tmp SET xceb130 = ' ' WHERE xceb130 IS NULL
   
   INSERT INTO xceb_t (xcebent,xcebcomp,xcebld,xcebdocno,xcebseq,
                       xceb001,xceb002,xceb003,xceb004,xceb005,xceb101,xceb102,xceb103,xceb110,xceb111,
                       xceb112,xceb113,xceb114,xceb115,xceb116,xceb117,xceb118,xceb119,xceb120,xceb201,
                       xceb202,xceb202a,xceb202b,xceb202c,xceb202d,xceb202e,xceb202f,xceb202g,xceb202h,
                       xceb212,xceb212a,xceb212b,xceb212c,xceb212d,xceb212e,xceb212f,xceb212g,xceb212h,
                       xceb222,xceb222a,xceb222b,xceb222c,xceb222d,xceb222e,xceb222f,xceb222g,xceb222h,
                       xceb301,xceb302,xceb107,xceb108,xceb109,xceb121,xceb122,xceb123,xceb124,xceb125,
                       xceb126,xceb127,xceb128,xceb129,xceb130,xceb131,xceb132)
         SELECT xcebent,xcebcomp,xcebld,xcebdocno,xcebseq,
                xceb001,xceb002,xceb003,xceb004,xceb005,xceb101,xceb102,xceb103,xceb110,xceb111,
                xceb112,xceb113,xceb114,xceb115,xceb116,xceb117,xceb118,xceb119,xceb120,xceb201,
                xceb202,xceb202a,xceb202b,xceb202c,xceb202d,xceb202e,xceb202f,xceb202g,xceb202h,
                xceb212,xceb212a,xceb212b,xceb212c,xceb212d,xceb212e,xceb212f,xceb212g,xceb212h,
                xceb222,xceb222a,xceb222b,xceb222c,xceb222d,xceb222e,xceb222f,xceb222g,xceb222h,
                xceb301,xceb302,xceb107,xceb108,xceb109,xceb121,xceb122,xceb123,xceb124,xceb125,
                xceb126,xceb127,xceb128,xceb129,xceb130,xceb131,xceb132
           FROM sourse_ins_tmp
   DELETE FROM sourse_ins_tmp;   

   ###INS xcec_t###
   DELETE FROM sourse_ins_tmp1;
   LET g_sql = " INSERT INTO sourse_ins_tmp1 ",
               "  (xcecent,xceccomp,xcecld,xcecdocno,xcecseq,",
               "   xcec001,xcec002,xcec003,xcec004,xcec005,",
               "   xcec101,xcec102,xcec103,xcec110,xcec111,",
               "   xcec112,xcec113,xcec114,xcec115,xcec116,",
               "   xcec117,xcec118,xcec119,xcec120,xcec201,",
               "   xcec202,xcec202a,xcec202b,xcec202c,xcec202d,xcec202e,xcec202f,xcec202g,xcec202h,",
               "   xcec212,xcec212a,xcec212b,xcec212c,xcec212d,xcec212e,xcec212f,xcec212g,xcec212h,",
               "   xcec222,xcec222a,xcec222b,xcec222c,xcec222d,xcec222e,xcec222f,xcec222g,xcec222h,",
               "   xcec301,xcec302,xcec107,xcec108,xcec109,",
               "   xcec121,xcec122,xcec123,xcec124,xcec125,",
               "   xcec126,xcec127,xcec128,xcec129,xcec130,",
               "   sfaa009,sfaasite,sfaa028,",
               "   sfaa029,sfaa052,sfaa057) ",  
               " SELECT ",g_enterprise,",'",g_xcea_m.xceacomp,"','",g_xcea_m.xceald,"','",g_xcea_m.xceadocno,"',rownum,",
               "        xcbk006,'',xcbk007,sfaa010,'',",
               #"        '',(SELECT glab010 FROM glab_t WHERE glabld  = '",g_xcea_m.xceald,"' AND glab001 = '61' AND glab002 = '8925' AND glab003 = '8' AND glabent = ",g_enterprise,") xcec102,'','',sfaa009, ",   #170313-00084#1 mark
               "        '',(SELECT glab010 FROM glab_t WHERE glabld  = '",g_xcea_m.xceald,"' AND glab001 = '61' AND glab002 = '8925' AND glab003 = '9' AND glabent = ",g_enterprise,") xcec102,'','',sfaa009, ",   #170313-00084#1
               "        '','',sfaa068,' ',' ',",
               "        '',' ',sfaa028,sfaa029,'',",
               "        xcbk202,0,0,0,0,0,0,0,0,",
               "        xcbk212,0,0,0,0,0,0,0,0,",
               "        xcbk222,0,0,0,0,0,0,0,0,",
               "        '','','','','', ",             
               "        '','','','','', ",             
               "        '','','','','', ",             
               "        '',sfaasite,'', ",             
               "        '',xcbk005,sfaa057 ",   
               "   FROM (",
               "          SELECT xcbk005,xcbk006,xcbk007,SUM(xcbk202) xcbk202,SUM(xcbk212) xcbk212,SUM(xcbk222) xcbk222",  
               "            FROM xcbk_t ",
               "           WHERE xcbkent  = '",g_enterprise,"'",
               "             AND xcbkcomp = '",g_xcea_m.xceacomp,"'",
               "             AND xcbkld   = '",g_xcea_m.xceald,"'",
               "             AND xcbk001  = '",g_xcea_m.xcea003,"'",
               "             AND xcbk002  = '",g_xcea_m.xcea004,"'",
               "             AND xcbk003  = '",g_xcea_m.xcea005,"'",
               #"             AND xcbk005 <> '1' ",          #170327-00045#1 mark
               "           GROUP BY xcbk005,xcbk006,xcbk007 ", 
               "           ORDER BY xcbk005,xcbk006,xcbk007) ",
               "   LEFT OUTER JOIN sfaa_t ON sfaaent = ",g_enterprise," AND xcbk006 = sfaadocno "              
   PREPARE axct701_9_ins_xcec_01 FROM g_sql
   EXECUTE axct701_9_ins_xcec_01

   #170216-00050#1 ---add (s)---
   UPDATE sourse_ins_tmp1
      SET sfaasite = (SELECT imag011 FROM imag_t
                       WHERE imagent = g_enterprise AND imagsite = g_xcea_m.xceacomp
                         AND imag001 = xcec004)
   #170216-00050#1 ---add (e)---

   #抓取科目
   UPDATE sourse_ins_tmp1 
      SET xcec101 = (SELECT DISTINCT glcc004 FROM glcc_t #170214-00017#1 glcc002 -->glcc004
                      WHERE glccent = g_enterprise 
                        AND glcc001 = '4'  
                        AND glccld  = g_xcea_m.xceald
                        AND (glcc014= g_xcea_m.xceacomp OR glcc014='*' )
                        AND (glcc016= xcec004 OR glcc016 = '*')
                        AND (glcc011= sfaasite OR glcc011='*')
                        AND rownum = 1)   
    WHERE (xcec101 IS NULL OR xcec101 = ' ')
      AND sfaa057 = '2'

   UPDATE sourse_ins_tmp1 
      SET xcec101 = (SELECT DISTINCT glcc002 FROM glcc_t 
                      WHERE glccent = g_enterprise
                        AND glcc001 = '3'  
                        AND glccld  = g_xcea_m.xceald
                        AND (glcc014= g_xcea_m.xceacomp OR glcc014='*' )
                        AND (glcc016= xcec004 OR glcc016 = '*')
                        AND (glcc011= sfaasite OR glcc011='*')
                        AND rownum = 1)   
    WHERE xcec101 IS NULL OR xcec101 = ' '
   
  #170215-00035#1 ---mark (s)--- sfaa052写错了，暂时mark   
  #UPDATE sourse_ins_tmp1 
  #   SET xcec101 = (SELECT glab005
  #                    FROM glab_t
  #                   WHERE glabld  = g_xcea_m.xceald
  #                     AND glab001 = '60'
  #                     AND glab002 = '8912'
  #                     AND glab003 = '2'
  #                     AND glabent = g_enterprise)
  # WHERE (xcec101 IS NULL OR xcec101 = ' ')      
  #   AND sfaa052 = '1'
  #
  #UPDATE sourse_ins_tmp1 
  #   SET xcec101 = (SELECT glab005
  #                    FROM glab_t
  #                   WHERE glabld  = g_xcea_m.xceald
  #                     AND glab001 = '60'
  #                     AND glab002 = '8912'
  #                     AND glab003 = '3'
  #                     AND glabent = g_enterprise)
  # WHERE (xcec101 IS NULL OR xcec101 = ' ')      
  #   AND sfaa052 <> '1'  
  #170215-00035#1 ---mark (e)---
      
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT DISTINCT xcbk005,xcbk006,xcbk007,xcbk004 ",
                   "          FROM xcbk_t ",
                   "         WHERE xcbkent  = ",g_enterprise,
                   "           AND xcbkcomp = '",g_xcea_m.xceacomp,"'",
                   "           AND xcbkld   = '",g_xcea_m.xceald,"'",
                   "           AND xcbk001  = '",g_xcea_m.xcea003,"'", #170216-00046#1 '",g_xcea_m.xcea003, ---> '",g_xcea_m.xcea003,"'",
                   "           AND xcbk002  = ",g_xcea_m.xcea004,
                   "           AND xcbk003  = ",g_xcea_m.xcea005," ) ", 
                   "    ON (xcbk005 = sfaa052 AND xcbk006 = xcec001 AND xcbk007 = xcec003 ) ",
                   "    WHEN MATCHED THEN  ",
                   "    UPDATE SET xcec108 = xcbk004",
                   "  WHERE EXISTS(SELECT 1 FROM glad_t ",
                   "                WHERE gladent = ",g_enterprise,
                   "                  AND gladld = '",g_xcea_m.xceald,"'",
                   "                  AND glad001 = xcec101 AND glad007 = 'Y' ) ",
                   "    AND xcec101 IS NOT NULL "
   PREPARE axct701_9_upd_xcec108_1 FROM g_sql
   EXECUTE axct701_9_upd_xcec108_1      

   LET g_sql = " MERGE INTO sourse_ins_tmp1                               ",
               " USING (SELECT DISTINCT xcbk005,xcbk006,xcbk007,xcbk004 ",
               "          FROM xcbk_t ",
               "         WHERE xcbkent  = ",g_enterprise,
               "           AND xcbkcomp = '",g_xcea_m.xceacomp,"'",
               "           AND xcbkld   = '",g_xcea_m.xceald,"'",
               "           AND xcbk001  = '",g_xcea_m.xcea003,"'", #170216-00046#1 '",g_xcea_m.xcea003, ---> '",g_xcea_m.xcea003,"'",
               "           AND xcbk002  = ",g_xcea_m.xcea004,
               "           AND xcbk003  = ",g_xcea_m.xcea005," ) ",
               "    ON (xcbk005 = sfaa052 AND xcbk006 = xcec001 AND xcbk007 = xcec003 ) ",
               "    WHEN MATCHED THEN  ",
               "    UPDATE SET xcec114 = xcbk004",
               "  WHERE EXISTS(SELECT 1 FROM glad_t ",
               "                WHERE gladent = ",g_enterprise,
               "                  AND gladld = '",g_xcea_m.xceald,"'",
               "                  AND glad001 = xcec101 AND glad008 = 'Y' ) ",
               "    AND xcec101 IS NOT NULL "
   PREPARE axct701_9_upd_xcec114_1 FROM g_sql
   EXECUTE axct701_9_upd_xcec114_1  
   
   UPDATE sourse_ins_tmp1 
     SET xcec111 = (SELECT pmaa002 FROM pmaa_t WHERE pmaaent = g_enterprise AND pmaa001 = xcec111),
         xcec112 = (SELECT pmaa005 FROM pmaa_t WHERE pmaaent = g_enterprise AND pmaa001 = xcec111)
   WHERE sfaa057 = '2'  
   
   UPDATE sourse_ins_tmp1 
     SET xcec113 =(SELECT ooef153 FROM ooef_t WHERE ooefent = g_enterprise AND ooef001 = sfaasite), #170215-00035#1 xcec101 -->xcec113
         xcec111 = ' ',
         xcec112 = ' '
   WHERE sfaa057 <> '2'       
            
   #启用交易对象
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad010 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad010 = 'N'  ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec111 = ' '"
   PREPARE axct701_9_upd_xcec111 FROM g_sql
   EXECUTE axct701_9_upd_xcec111

  #启用客群
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad011 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad011 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec112 = ' '"
   PREPARE axct701_9_upd_xcec112 FROM g_sql
   EXECUTE axct701_9_upd_xcec112

  #启用区域
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad009 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad009 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec113 = ' '"
   PREPARE axct701_9_upd_xcec113 FROM g_sql
   EXECUTE axct701_9_upd_xcec113

   
   #启用成本中心
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad008 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad008 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec114 = ' '"
   PREPARE axct701_9_upd_xcec114 FROM g_sql
   EXECUTE axct701_9_upd_xcec114
   
  #启用经营类别
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad031 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad031 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec115 = ' '"
   PREPARE axct701_9_upd_xcec115 FROM g_sql
   EXECUTE axct701_9_upd_xcec115
 
  #启用渠道
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad032 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad032 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec116 = ' '"
   PREPARE axct701_9_upd_xcec116 FROM g_sql
   EXECUTE axct701_9_upd_xcec116

  #启用品类
  #170221-00041#1 add start ----
   UPDATE sourse_ins_tmp1
      SET xcec117 = (SELECT imag011 FROM imag_t
                      WHERE imagent = xcecent
                        AND imagsite = g_xcea_m.xceacomp
                        AND imag001 = xcec004)
  #170221-00041#1 add end   ----    
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad012 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad012 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec117 = ' '"
   PREPARE axct701_9_upd_xcec117 FROM g_sql
   EXECUTE axct701_9_upd_xcec117
   
  #启用品牌
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad033 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad033 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec118 = ' '"
   PREPARE axct701_9_upd_xcec118 FROM g_sql
   EXECUTE axct701_9_upd_xcec118
 
  #启用项目号
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad015 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad015 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec119 = ' '"
   PREPARE axct701_9_upd_xcec119 FROM g_sql
   EXECUTE axct701_9_upd_xcec119
 
  #启用WBS
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad016 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad016 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec120 = ' '"
   PREPARE axct701_9_upd_xcec120 FROM g_sql
   EXECUTE axct701_9_upd_xcec120
 
  #启用人员
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad013 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad013 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec107 = ' '"
   PREPARE axct701_9_upd_xcec107 FROM g_sql
   EXECUTE axct701_9_upd_xcec107
 
  #启用部门
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad007 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad007 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec108 = ' '"
   PREPARE axct701_9_upd_xcec108 FROM g_sql
   EXECUTE axct701_9_upd_xcec108
   
  #启用账款对象
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad027 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad027 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec109 = ' '"
   PREPARE axct701_9_upd_xcec109 FROM g_sql
   EXECUTE axct701_9_upd_xcec109
   
  #启用自由核算项1
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad017 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad017 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec121 = ' '"
   PREPARE axct701_9_upd_xcec121 FROM g_sql
   EXECUTE axct701_9_upd_xcec121
 
  #启用自由核算项2
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad018 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad018 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec122 = ' '"
   PREPARE axct701_9_upd_xcec122 FROM g_sql
   EXECUTE axct701_9_upd_xcec122
 
  #启用自由核算项3
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad019 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad019 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec123 = ' '"
   PREPARE axct701_9_upd_xcec123 FROM g_sql
   EXECUTE axct701_9_upd_xcec123

  #启用自由核算项4
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad019 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad019 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec124 = ' '"
   PREPARE axct701_9_upd_xcec124 FROM g_sql
   EXECUTE axct701_9_upd_xcec124

  #启用自由核算项5
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad021 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad021 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec125 = ' '"
   PREPARE axct701_9_upd_xcec125 FROM g_sql
   EXECUTE axct701_9_upd_xcec125

  #启用自由核算项6
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad022 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad022 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec126 = ' '"
   PREPARE axct701_9_upd_xcec126 FROM g_sql
   EXECUTE axct701_9_upd_xcec126

  #启用自由核算项7
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad023 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad023 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec127 = ' '"
   PREPARE axct701_9_upd_xcec127 FROM g_sql
   EXECUTE axct701_9_upd_xcec127

  #启用自由核算项8
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad024 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad024 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec128 = ' '"
   PREPARE axct701_9_upd_xcec128 FROM g_sql
   EXECUTE axct701_9_upd_xcec128

  #启用自由核算项9
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad025 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad025 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec129 = ' '"
   PREPARE axct701_9_upd_xcec129 FROM g_sql
   EXECUTE axct701_9_upd_xcec129

  #启用自由核算项10
   LET g_sql =     " MERGE INTO sourse_ins_tmp1                               ",
                   " USING (SELECT glad001,glad026 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xcec101 AND xcec101 IS NOT NULL AND glad026 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xcec130 = ' '"
   PREPARE axct701_9_upd_xcec130 FROM g_sql
   EXECUTE axct701_9_upd_xcec130
   
  #特性
   UPDATE sourse_ins_tmp1 SET xcec005 = ' ' WHERE xcec005 IS NULL
 #科目编号
   UPDATE sourse_ins_tmp1 SET xcec101 = ' ' WHERE xcec101 IS NULL
  #摘要
   UPDATE sourse_ins_tmp1 SET xcec102 = ' ' WHERE xcec102 IS NULL
  #成本域
   UPDATE sourse_ins_tmp1 SET xcec103 = ' ' WHERE xcec103 IS NULL
  #原因码
   UPDATE sourse_ins_tmp1 SET xcec110 = ' ' WHERE xcec110 IS NULL
  #交易对象
   UPDATE sourse_ins_tmp1 SET xcec111 = ' ' WHERE xcec111 IS NULL
  #客群
   UPDATE sourse_ins_tmp1 SET xcec112 = ' ' WHERE xcec112 IS NULL
  #区域
   UPDATE sourse_ins_tmp1 SET xcec113 = ' ' WHERE xcec113 IS NULL
  #成本中心
   UPDATE sourse_ins_tmp1 SET xcec114 = ' ' WHERE xcec114 IS NULL
  #经营类别
   UPDATE sourse_ins_tmp1 SET xcec115 = ' ' WHERE xcec115 IS NULL
  #渠道
   UPDATE sourse_ins_tmp1 SET xcec116 = ' ' WHERE xcec116 IS NULL
  #品类
   UPDATE sourse_ins_tmp1 SET xcec117 = ' ' WHERE xcec117 IS NULL
  #品牌
   UPDATE sourse_ins_tmp1 SET xcec118 = ' ' WHERE xcec118 IS NULL
  #项目号
   UPDATE sourse_ins_tmp1 SET xcec119 = ' ' WHERE xcec119 IS NULL
  #WBS
   UPDATE sourse_ins_tmp1 SET xcec120 = ' ' WHERE xcec120 IS NULL
  #人员
   UPDATE sourse_ins_tmp1 SET xcec107 = ' ' WHERE xcec107 IS NULL
   #部门
   UPDATE sourse_ins_tmp1 SET xcec108 = ' ' WHERE xcec108 IS NULL
  #账款对象
   UPDATE sourse_ins_tmp1 SET xcec109 = ' ' WHERE xcec109 IS NULL
  #自由核算项1
   UPDATE sourse_ins_tmp1 SET xcec121 = ' ' WHERE xcec121 IS NULL
  #自由核算项2
   UPDATE sourse_ins_tmp1 SET xcec122 = ' ' WHERE xcec122 IS NULL
  #自由核算项3
   UPDATE sourse_ins_tmp1 SET xcec123 = ' ' WHERE xcec123 IS NULL
  #自由核算项4
   UPDATE sourse_ins_tmp1 SET xcec124 = ' ' WHERE xcec124 IS NULL
  #自由核算项5
   UPDATE sourse_ins_tmp1 SET xcec125 = ' ' WHERE xcec125 IS NULL
  #自由核算项6
   UPDATE sourse_ins_tmp1 SET xcec126 = ' ' WHERE xcec126 IS NULL
   #自由核算项7
   UPDATE sourse_ins_tmp1 SET xcec127 = ' ' WHERE xcec127 IS NULL
  #自由核算项8
   UPDATE sourse_ins_tmp1 SET xcec128 = ' ' WHERE xcec128 IS NULL
  #自由核算项9
   UPDATE sourse_ins_tmp1 SET xcec129 = ' ' WHERE xcec129 IS NULL
  #自由核算项10
   UPDATE sourse_ins_tmp1 SET xcec130 = ' ' WHERE xcec130 IS NULL
 
   INSERT INTO xcec_t (xcecent,xceccomp,xcecld,xcecdocno,xcecseq,
                       xcec001,xcec002,xcec003,xcec004,xcec005,xcec101,xcec102,xcec103,xcec110,xcec111,
                       xcec112,xcec113,xcec114,xcec115,xcec116,xcec117,xcec118,xcec119,xcec120,xcec201,
                       xcec202,xcec202a,xcec202b,xcec202c,xcec202d,xcec202e,xcec202f,xcec202g,xcec202h,
                       xcec212,xcec212a,xcec212b,xcec212c,xcec212d,xcec212e,xcec212f,xcec212g,xcec212h,
                       xcec222,xcec222a,xcec222b,xcec222c,xcec222d,xcec222e,xcec222f,xcec222g,xcec222h,
                       xcec301,xcec302,xcec107,xcec108,xcec109,xcec121,xcec122,xcec123,xcec124,xcec125,
                       xcec126,xcec127,xcec128,xcec129,xcec130)
         SELECT xcecent,xceccomp,xcecld,xcecdocno,xcecseq,
                xcec001,xcec002,xcec003,xcec004,xcec005,xcec101,xcec102,xcec103,xcec110,xcec111,
                xcec112,xcec113,xcec114,xcec115,xcec116,xcec117,xcec118,xcec119,xcec120,xcec201,
                xcec202,xcec202a,xcec202b,xcec202c,xcec202d,xcec202e,xcec202f,xcec202g,xcec202h,
                xcec212,xcec212a,xcec212b,xcec212c,xcec212d,xcec212e,xcec212f,xcec212g,xcec212h,
                xcec222,xcec222a,xcec222b,xcec222c,xcec222d,xcec222e,xcec222f,xcec222g,xcec222h,
                xcec301,xcec302,xcec107,xcec108,xcec109,xcec121,xcec122,xcec123,xcec124,xcec125,
                xcec126,xcec127,xcec128,xcec129,xcec130
           FROM sourse_ins_tmp1
   DELETE FROM sourse_ins_tmp1; 
   RETURN g_success   
END FUNCTION

################################################################################
# Descriptions...: 描述说明   12.結存調整憑證  axct710
# Date & Author..: 2017/01/05 By 02295
# Modify.........: #170105-00011#1  因效能优化,程序逻辑完全重写,旧代码保存在axct701_01_ins_10_bak中
################################################################################
PRIVATE FUNCTION axct701_01_ins_10()
DEFINE l_success       LIKE type_t.num5
DEFINE l_errno         LIKE gzze_t.gzze001
DEFINE l_xcea          RECORD  #工單發料成本憑證單頭檔
       xceaent LIKE xcea_t.xceaent, #企業編號
       xceacomp LIKE xcea_t.xceacomp, #法人組織
       xceald LIKE xcea_t.xceald, #帳套
       xceadocno LIKE xcea_t.xceadocno, #單據編號
       xcea001 LIKE xcea_t.xcea001, #單據日期
       xcea002 LIKE xcea_t.xcea002, #成本憑證類型
       xcea003 LIKE xcea_t.xcea003, #成本計算類型
       xcea004 LIKE xcea_t.xcea004, #年度
       xcea005 LIKE xcea_t.xcea005, #期別
       xcea006 LIKE xcea_t.xcea006, #帳務人員
       xcea007 LIKE xcea_t.xcea007, #帳務部門
       xcea101 LIKE xcea_t.xcea101, #憑證編號
       xcea102 LIKE xcea_t.xcea102, #憑證日期
       xceaownid LIKE xcea_t.xceaownid, #資料所有者
       xceaowndp LIKE xcea_t.xceaowndp, #資料所屬部門
       xceacrtid LIKE xcea_t.xceacrtid, #資料建立者
       xceacrtdp LIKE xcea_t.xceacrtdp, #資料建立部門
       xceacrtdt LIKE xcea_t.xceacrtdt, #資料創建日
       xceamodid LIKE xcea_t.xceamodid, #資料修改者
       xceamoddt LIKE xcea_t.xceamoddt, #最近修改日
       xceacnfid LIKE xcea_t.xceacnfid, #資料確認者
       xceacnfdt LIKE xcea_t.xceacnfdt, #資料確認日
       xceapstid LIKE xcea_t.xceapstid, #資料過帳者
       xceapstdt LIKE xcea_t.xceapstdt, #資料過帳日
       xceastus LIKE xcea_t.xceastus, #狀態碼
       xceaud001 LIKE xcea_t.xceaud001, #自定義欄位(文字)001
       xceaud002 LIKE xcea_t.xceaud002, #自定義欄位(文字)002
       xceaud003 LIKE xcea_t.xceaud003, #自定義欄位(文字)003
       xceaud004 LIKE xcea_t.xceaud004, #自定義欄位(文字)004
       xceaud005 LIKE xcea_t.xceaud005, #自定義欄位(文字)005
       xceaud006 LIKE xcea_t.xceaud006, #自定義欄位(文字)006
       xceaud007 LIKE xcea_t.xceaud007, #自定義欄位(文字)007
       xceaud008 LIKE xcea_t.xceaud008, #自定義欄位(文字)008
       xceaud009 LIKE xcea_t.xceaud009, #自定義欄位(文字)009
       xceaud010 LIKE xcea_t.xceaud010, #自定義欄位(文字)010
       xceaud011 LIKE xcea_t.xceaud011, #自定義欄位(數字)011
       xceaud012 LIKE xcea_t.xceaud012, #自定義欄位(數字)012
       xceaud013 LIKE xcea_t.xceaud013, #自定義欄位(數字)013
       xceaud014 LIKE xcea_t.xceaud014, #自定義欄位(數字)014
       xceaud015 LIKE xcea_t.xceaud015, #自定義欄位(數字)015
       xceaud016 LIKE xcea_t.xceaud016, #自定義欄位(數字)016
       xceaud017 LIKE xcea_t.xceaud017, #自定義欄位(數字)017
       xceaud018 LIKE xcea_t.xceaud018, #自定義欄位(數字)018
       xceaud019 LIKE xcea_t.xceaud019, #自定義欄位(數字)019
       xceaud020 LIKE xcea_t.xceaud020, #自定義欄位(數字)020
       xceaud021 LIKE xcea_t.xceaud021, #自定義欄位(日期時間)021
       xceaud022 LIKE xcea_t.xceaud022, #自定義欄位(日期時間)022
       xceaud023 LIKE xcea_t.xceaud023, #自定義欄位(日期時間)023
       xceaud024 LIKE xcea_t.xceaud024, #自定義欄位(日期時間)024
       xceaud025 LIKE xcea_t.xceaud025, #自定義欄位(日期時間)025
       xceaud026 LIKE xcea_t.xceaud026, #自定義欄位(日期時間)026
       xceaud027 LIKE xcea_t.xceaud027, #自定義欄位(日期時間)027
       xceaud028 LIKE xcea_t.xceaud028, #自定義欄位(日期時間)028
       xceaud029 LIKE xcea_t.xceaud029, #自定義欄位(日期時間)029
       xceaud030 LIKE xcea_t.xceaud030, #自定義欄位(日期時間)030
       xceasite LIKE xcea_t.xceasite  #營運據點
          END RECORD
DEFINE ld_date         DATETIME YEAR TO SECOND
DEFINE l_xcat005       LIKE xcat_t.xcat005  
DEFINE l_xcaz011       LIKE xcaz_t.xcaz011
DEFINE l_rate          LIKE type_t.num26_10
DEFINE l_rate1         LIKE type_t.num26_10
DEFINE l_glab005       LIKE glab_t.glab005


  #CALL axct701_01_create_tmp()   #170324-00054#1 mark
   
   ###INS xcea_t###
   LET g_success = 'Y'
   LET l_xcea.xceaownid = g_user
   LET l_xcea.xceaowndp = g_dept
   LET l_xcea.xceacrtid = g_user
   LET l_xcea.xceacrtdp = g_dept 
   LET ld_date = cl_get_current()
   LET l_xcea.xceamodid = ""
   LET l_xcea.xceamoddt = ""
   CALL s_aooi200_fin_gen_docno(g_xcea_m.xceald,'','',g_xcea_m.xceadocno,g_xcea_m.xcea001,g_prog_name1)  
    RETURNING l_success,g_xcea_m.xceadocno
   IF l_success  = 0  THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = 'apm-00003'
      LET g_errparam.extend = g_xcea_m.xceadocno
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET g_success = 'N'
      RETURN g_success
   END IF
   
   INSERT INTO xcea_t (xceaent,xceald,xceacomp,xcea006,xceadocno,xcea001,xcea002,xcea004, 
                       xcea005,xcea003,xceastus,xceaownid,xceaowndp,xceacrtid,xceacrtdp,xceacrtdt, 
                       xceamodid,xceamoddt)
   VALUES (g_enterprise,g_xcea_m.xceald,g_xcea_m.xceacomp,g_xcea_m.xcea006,g_xcea_m.xceadocno, 
           g_xcea_m.xcea001,g_xcea002,g_xcea_m.xcea004,g_xcea_m.xcea005,g_xcea_m.xcea003, 
           'N',l_xcea.xceaownid,l_xcea.xceaowndp,l_xcea.xceacrtid, 
           l_xcea.xceacrtdp,ld_date,l_xcea.xceamodid,l_xcea.xceamoddt) 
       
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "g_xcea_m"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET g_success = 'N'
      RETURN g_success
   END IF
   
   
   ###INS xceb_t###
   DELETE FROM sourse_ins_tmp;
   LET g_sql = " INSERT INTO sourse_ins_tmp ",
               "  (xcebent,xcebcomp,xcebld,xcebdocno,xcebseq,",
               "   xceb001,xceb002,xceb003,xceb004,xceb005,",
               "   xceb101,xceb102,xceb103,xceb110,xceb111,",
               "   xceb112,xceb113,xceb114,xceb115,xceb116,",
               "   xceb117,xceb118,xceb119,xceb120,xceb201,",
               "   xceb202,xceb202a,xceb202b,xceb202c,xceb202d,xceb202e,xceb202f,xceb202g,xceb202h,",
               "   xceb212,xceb212a,xceb212b,xceb212c,xceb212d,xceb212e,xceb212f,xceb212g,xceb212h,",
               "   xceb222,xceb222a,xceb222b,xceb222c,xceb222d,xceb222e,xceb222f,xceb222g,xceb222h,",
               "   xceb301,xceb302,xceb107,xceb108,xceb109,",
               "   xceb121,xceb122,xceb123,xceb124,xceb125,",
               "   xceb126,xceb127,xceb128,xceb129,xceb130,",
               "   xceb131,xceb132,sfaa009,sfaasite,sfaa028,",
               "   sfaa029,sfaa052,sfaa057) ",  
               " SELECT ",g_enterprise,",'",g_xcea_m.xceacomp,"','",g_xcea_m.xceald,"','",g_xcea_m.xceadocno,"',rownum,",
               "        '','','',xccc006,xccc007,",
               #"        '',(SELECT glab010 FROM glab_t WHERE glabld  = '",g_xcea_m.xceald,"' AND glab001 = '61' AND glab002 = '8925' AND glab003 = '1' AND glabent = ",g_enterprise,") xceb102,xccc002,'','', ",  #170313-00084#1 mark
               "        '',(SELECT glab010 FROM glab_t WHERE glabld  = '",g_xcea_m.xceald,"' AND glab001 = '61' AND glab002 = '8925' AND glab003 = '10' AND glabent = ",g_enterprise,") xceb102,xccc002,'','', ",  #170313-00084#1 add
               "        '','','','','',",
               "        '','','','',0,",
              #"        SUM(xccc903),SUM(xccc903a),SUM(xccc903b),SUM(xccc903c),SUM(xccc903d),SUM(xccc903e),SUM(xccc903f),SUM(xccc903g),SUM(xccc903h),", #170215-00035#1 mark
               "        xccc903,xccc903a,xccc903b,xccc903c,xccc903d,xccc903e,xccc903f,xccc903g,xccc903h,",   #170215-00035#1 add
               "        0,0,0,0,0,0,0,0,0,",
               "        0,0,0,0,0,0,0,0,0,",
               "        '','','','','', ",             
               "        '','','','','', ",             
               "        '','','','','', ",             
               "        '','','','','', ",             
               "        xccc008,'','' ",     #因xceb_t没有批号，所以这边暂时用临时表中的sfaa029记录
               "   FROM (",
               "         SELECT xccc002,xccc008,xccc006,xccc007,",
               "                SUM(xccc903) xccc903,SUM(xccc903a) xccc903a,SUM(xccc903b) xccc903b,SUM(xccc903c) xccc903c,SUM(xccc903d) xccc903d,",
               "                SUM(xccc903e) xccc903e,SUM(xccc903f) xccc903f,SUM(xccc903g) xccc903g,SUM(xccc903h) xccc903h ",
               "           FROM xccc_t ",
               "          WHERE xcccent = '",g_enterprise,"' AND xcccld = '",g_xcea_m.xceald,"'",
               "            AND xccc003 = '",g_xcea_m.xcea003,"' AND xccc004 = ",g_xcea_m.xcea004,
               "            AND xccc903 <> 0 ",
               "            AND xccc005 = ",g_xcea_m.xcea005,
               "            AND xccc001 = '1' ",
               "         GROUP BY xccc002,xccc008,xccc006,xccc007",
               "         ORDER BY xccc002,xccc008,xccc006,xccc007)"
   PREPARE axct701_10_ins_01 FROM g_sql
   EXECUTE axct701_10_ins_01

   LET g_sql = " MERGE INTO sourse_ins_tmp                               ",
               " USING (SELECT xccc002,xccc008,xccc006,xccc007, ",
               "               SUM(xccc202) xccc202,SUM(xccc202a) xccc202a,SUM(xccc202b) xccc202b,SUM(xccc202c) xccc202c,",
               "               SUM(xccc202d) xccc202d,SUM(xccc202e) xccc202e,SUM(xccc202f) xccc202f,SUM(xccc202g) xccc202g,SUM(xccc202h) xccc202h ",
               "          FROM xccc_t ",
               "         WHERE xcccent = '",g_enterprise,"' AND xcccld = '",g_xcea_m.xceald,"'",
               "           AND xccc003 = '",g_xcea_m.xcea003,"' AND xccc004 = ",g_xcea_m.xcea004,
               "           AND xccc005 = ",g_xcea_m.xcea005,
               "           AND xccc001 = '2' ",
               "           AND xccc903 <> 0 ",
               "         GROUP BY xccc002,xccc008,xccc006,xccc007)",
               "    ON (xceb103=xccc002 AND sfaa029 = xccc008 AND xceb004 = xccc006 AND xceb005 = xccc007)                        ",
               "  WHEN MATCHED THEN ",
               "UPDATE SET xceb212  = xccc202 ,",
               "           xceb212a = xccc202a,",
               "           xceb212b = xccc202b,",
               "           xceb212c = xccc202c,",
               "           xceb212d = xccc202d,",
               "           xceb212e = xccc202e,",
               "           xceb212f = xccc202f,",
               "           xceb212g = xccc202g,",
               "           xceb212h = xccc202h "
   PREPARE axct701_10_upd_xceb212 FROM g_sql
   EXECUTE axct701_10_upd_xceb212
   
   LET g_sql = " MERGE INTO sourse_ins_tmp                               ",
               " USING (SELECT xccc002,xccc008,xccc006,xccc007, ",
               "               SUM(xccc202) xccc202,SUM(xccc202a) xccc202a,SUM(xccc202b) xccc202b,SUM(xccc202c) xccc202c,",
               "               SUM(xccc202d) xccc202d,SUM(xccc202e) xccc202e,SUM(xccc202f) xccc202f,SUM(xccc202g) xccc202g,SUM(xccc202h) xccc202h ",
               "          FROM xccc_t ",
               "         WHERE xcccent = '",g_enterprise,"' AND xcccld = '",g_xcea_m.xceald,"'",
               "           AND xccc003 = '",g_xcea_m.xcea003,"' AND xccc004 = ",g_xcea_m.xcea004,
               "           AND xccc005 = ",g_xcea_m.xcea005,
               "           AND xccc001 = '3' ",
               "           AND xccc903 <> 0 ",
               "         GROUP BY xccc002,xccc008,xccc006,xccc007)",
               "    ON (xceb103=xccc002 AND sfaa029 = xccc008 AND xceb004 = xccc006 AND xceb005 = xccc007)                        ",
               "  WHEN MATCHED THEN ",
               "UPDATE SET xceb222  = xccc202 ,",
               "           xceb222a = xccc202a,",
               "           xceb222b = xccc202b,",
               "           xceb222c = xccc202c,",
               "           xceb222d = xccc202d,",
               "           xceb222e = xccc202e,",
               "           xceb222f = xccc202f,",
               "           xceb222g = xccc202g,",
               "           xceb222h = xccc202h "
   PREPARE axct701_10_upd_xceb222 FROM g_sql
   EXECUTE axct701_10_upd_xceb222 

   UPDATE sourse_ins_tmp
      SET xceb117 = (SELECT imag011 FROM imag_t
                      WHERE imagent = g_enterprise AND imagsite = g_xcea_m.xceacomp
                        AND imag001 = xceb004)   
   

   #抓取科目
   UPDATE sourse_ins_tmp 
      SET xceb101 = (SELECT DISTINCT glcc002 FROM glcc_t 
                      WHERE glccent = g_enterprise
                        AND glcc001 = '1'  
                        AND glccld  = g_xcea_m.xceald
                        AND (glcc014= g_xcea_m.xceacomp OR glcc014='*' )
                        AND (glcc016=xceb004 OR glcc016 = '*')
                        AND (glcc011=xceb117 OR glcc011='*')
                        AND rownum = 1)
   
  #启用交易对象
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad010 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad010 = 'N'  ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb111 = ' '"
   PREPARE axct701_10_upd_xceb111 FROM g_sql
   EXECUTE axct701_10_upd_xceb111

  #启用客群
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad011 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad011 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb112 = ' '"
   PREPARE axct701_10_upd_xceb112 FROM g_sql
   EXECUTE axct701_10_upd_xceb112

  #启用区域
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad009 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad009 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb113 = ' '"
   PREPARE axct701_10_upd_xceb113 FROM g_sql
   EXECUTE axct701_10_upd_xceb113

   
  #启用成本中心
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad008 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad008 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb114 = ' '"
   PREPARE axct701_10_upd_xceb114 FROM g_sql
   EXECUTE axct701_10_upd_xceb114
   
  #启用经营类别
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad031 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad031 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb115 = ' '"
   PREPARE axct701_10_upd_xceb115 FROM g_sql
   EXECUTE axct701_10_upd_xceb115
 
  #启用渠道
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad032 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad032 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb116 = ' '"
   PREPARE axct701_10_upd_xceb116 FROM g_sql
   EXECUTE axct701_10_upd_xceb116

  #启用品类
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad012 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad012 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb117 = ' '"
   PREPARE axct701_10_upd_xceb117 FROM g_sql
   EXECUTE axct701_10_upd_xceb117
   
  #启用品牌
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad033 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad033 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb118 = ' '"
   PREPARE axct701_10_upd_xceb118 FROM g_sql
   EXECUTE axct701_10_upd_xceb118
 
  #启用项目号
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad015 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad015 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb119 = ' '"
   PREPARE axct701_10_upd_xceb119 FROM g_sql
   EXECUTE axct701_10_upd_xceb119
 
  #启用WBS
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad016 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad016 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb120 = ' '"
   PREPARE axct701_10_upd_xceb120 FROM g_sql
   EXECUTE axct701_10_upd_xceb120
 
  #启用人员
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad013 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad013 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb107 = ' '"
   PREPARE axct701_10_upd_xceb107 FROM g_sql
   EXECUTE axct701_10_upd_xceb107
 
  #启用部门
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad007 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad007 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb108 = ' '"
   PREPARE axct701_10_upd_xceb108 FROM g_sql
   EXECUTE axct701_10_upd_xceb108
   
  #启用账款对象
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad027 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad027 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb109 = ' '"
   PREPARE axct701_10_upd_xceb109 FROM g_sql
   EXECUTE axct701_10_upd_xceb109
   
  #启用自由核算项1
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad017 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad017 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb121 = ' '"
   PREPARE axct701_10_upd_xceb121 FROM g_sql
   EXECUTE axct701_10_upd_xceb121
 
  #启用自由核算项2
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad018 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad018 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb122 = ' '"
   PREPARE axct701_10_upd_xceb122 FROM g_sql
   EXECUTE axct701_10_upd_xceb122
 
  #启用自由核算项3
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad019 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad019 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb123 = ' '"
   PREPARE axct701_10_upd_xceb123 FROM g_sql
   EXECUTE axct701_10_upd_xceb123

  #启用自由核算项4
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad019 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad019 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb124 = ' '"
   PREPARE axct701_10_upd_xceb124 FROM g_sql
   EXECUTE axct701_10_upd_xceb124

  #启用自由核算项5
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad021 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad021 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb125 = ' '"
   PREPARE axct701_10_upd_xceb125 FROM g_sql
   EXECUTE axct701_10_upd_xceb125

  #启用自由核算项6
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad022 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad022 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb126 = ' '"
   PREPARE axct701_10_upd_xceb126 FROM g_sql
   EXECUTE axct701_10_upd_xceb126

  #启用自由核算项7
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad023 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad023 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb127 = ' '"
   PREPARE axct701_10_upd_xceb127 FROM g_sql
   EXECUTE axct701_10_upd_xceb127

  #启用自由核算项8
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad024 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad024 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb128 = ' '"
   PREPARE axct701_10_upd_xceb128 FROM g_sql
   EXECUTE axct701_10_upd_xceb128

  #启用自由核算项9
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad025 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad025 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb129 = ' '"
   PREPARE axct701_10_upd_xceb129 FROM g_sql
   EXECUTE axct701_10_upd_xceb129

  #启用自由核算项10
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad026 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad026 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb130 = ' '"
   PREPARE axct701_10_upd_xceb130 FROM g_sql
   EXECUTE axct701_10_upd_xceb130
   
  #特性
   UPDATE sourse_ins_tmp SET xceb005 = ' ' WHERE xceb005 IS NULL
 #科目编号
   UPDATE sourse_ins_tmp SET xceb101 = ' ' WHERE xceb101 IS NULL
  #摘要
   UPDATE sourse_ins_tmp SET xceb102 = ' ' WHERE xceb102 IS NULL
  #成本域
   UPDATE sourse_ins_tmp SET xceb103 = ' ' WHERE xceb103 IS NULL
  #原因码
   UPDATE sourse_ins_tmp SET xceb110 = ' ' WHERE xceb110 IS NULL
  #交易对象
   UPDATE sourse_ins_tmp SET xceb111 = ' ' WHERE xceb111 IS NULL
  #客群
   UPDATE sourse_ins_tmp SET xceb112 = ' ' WHERE xceb112 IS NULL
  #区域
   UPDATE sourse_ins_tmp SET xceb113 = ' ' WHERE xceb113 IS NULL
  #成本中心
   UPDATE sourse_ins_tmp SET xceb114 = ' ' WHERE xceb114 IS NULL
  #经营类别
   UPDATE sourse_ins_tmp SET xceb115 = ' ' WHERE xceb115 IS NULL
  #渠道
   UPDATE sourse_ins_tmp SET xceb116 = ' ' WHERE xceb116 IS NULL
  #品类
   UPDATE sourse_ins_tmp SET xceb117 = ' ' WHERE xceb117 IS NULL
  #品牌
   UPDATE sourse_ins_tmp SET xceb118 = ' ' WHERE xceb118 IS NULL
  #项目号
   UPDATE sourse_ins_tmp SET xceb119 = ' ' WHERE xceb119 IS NULL
  #WBS
   UPDATE sourse_ins_tmp SET xceb120 = ' ' WHERE xceb120 IS NULL
  #人员
   UPDATE sourse_ins_tmp SET xceb107 = ' ' WHERE xceb107 IS NULL
   #部门
   UPDATE sourse_ins_tmp SET xceb108 = ' ' WHERE xceb108 IS NULL
  #账款对象
   UPDATE sourse_ins_tmp SET xceb109 = ' ' WHERE xceb109 IS NULL
  #自由核算项1
   UPDATE sourse_ins_tmp SET xceb121 = ' ' WHERE xceb121 IS NULL
  #自由核算项2
   UPDATE sourse_ins_tmp SET xceb122 = ' ' WHERE xceb122 IS NULL
  #自由核算项3
   UPDATE sourse_ins_tmp SET xceb123 = ' ' WHERE xceb123 IS NULL
  #自由核算项4
   UPDATE sourse_ins_tmp SET xceb124 = ' ' WHERE xceb124 IS NULL
  #自由核算项5
   UPDATE sourse_ins_tmp SET xceb125 = ' ' WHERE xceb125 IS NULL
  #自由核算项6
   UPDATE sourse_ins_tmp SET xceb126 = ' ' WHERE xceb126 IS NULL
   #自由核算项7
   UPDATE sourse_ins_tmp SET xceb127 = ' ' WHERE xceb127 IS NULL
  #自由核算项8
   UPDATE sourse_ins_tmp SET xceb128 = ' ' WHERE xceb128 IS NULL
  #自由核算项9
   UPDATE sourse_ins_tmp SET xceb129 = ' ' WHERE xceb129 IS NULL
  #自由核算项10
   UPDATE sourse_ins_tmp SET xceb130 = ' ' WHERE xceb130 IS NULL

   INSERT INTO xceb_t (xcebent,xcebcomp,xcebld,xcebdocno,xcebseq,
                       xceb001,xceb002,xceb003,xceb004,xceb005,xceb101,xceb102,xceb103,xceb110,xceb111,
                       xceb112,xceb113,xceb114,xceb115,xceb116,xceb117,xceb118,xceb119,xceb120,xceb201,
                       xceb202,xceb202a,xceb202b,xceb202c,xceb202d,xceb202e,xceb202f,xceb202g,xceb202h,
                       xceb212,xceb212a,xceb212b,xceb212c,xceb212d,xceb212e,xceb212f,xceb212g,xceb212h,
                       xceb222,xceb222a,xceb222b,xceb222c,xceb222d,xceb222e,xceb222f,xceb222g,xceb222h,
                       xceb301,xceb302,xceb107,xceb108,xceb109,xceb121,xceb122,xceb123,xceb124,xceb125,
                       xceb126,xceb127,xceb128,xceb129,xceb130,xceb131,xceb132)
         SELECT xcebent,xcebcomp,xcebld,xcebdocno,xcebseq,
                xceb001,xceb002,xceb003,xceb004,xceb005,xceb101,xceb102,xceb103,xceb110,xceb111,
                xceb112,xceb113,xceb114,xceb115,xceb116,xceb117,xceb118,xceb119,xceb120,xceb201,
                xceb202,xceb202a,xceb202b,xceb202c,xceb202d,xceb202e,xceb202f,xceb202g,xceb202h,
                xceb212,xceb212a,xceb212b,xceb212c,xceb212d,xceb212e,xceb212f,xceb212g,xceb212h,
                xceb222,xceb222a,xceb222b,xceb222c,xceb222d,xceb222e,xceb222f,xceb222g,xceb222h,
                xceb301,xceb302,xceb107,xceb108,xceb109,xceb121,xceb122,xceb123,xceb124,xceb125,
                xceb126,xceb127,xceb128,xceb129,xceb130,xceb131,xceb132
           FROM sourse_ins_tmp


   #INS xcec_t
   #xcec的资料与xceb的资料就科目不一样故直接更新sourse_ins_tmp的科目即可
   SELECT glab005 INTO l_glab005
     FROM glab_t
    WHERE glabld  = g_xcea_m.xceald
      AND glab001 = '60'
      AND glab002 = '8912'
      AND glab003 = '8'
      AND glabent = g_enterprise
   UPDATE sourse_ins_tmp SET xceb101 = l_glab005
   
   INSERT INTO xcec_t (xcecent,xceccomp,xcecld,xcecdocno,xcecseq,
                       xcec001,xcec002,xcec003,xcec004,xcec005,xcec101,xcec102,xcec103,xcec110,xcec111,
                       xcec112,xcec113,xcec114,xcec115,xcec116,xcec117,xcec118,xcec119,xcec120,xcec201,
                       xcec202,xcec202a,xcec202b,xcec202c,xcec202d,xcec202e,xcec202f,xcec202g,xcec202h,
                       xcec212,xcec212a,xcec212b,xcec212c,xcec212d,xcec212e,xcec212f,xcec212g,xcec212h,
                       xcec222,xcec222a,xcec222b,xcec222c,xcec222d,xcec222e,xcec222f,xcec222g,xcec222h,
                       xcec301,xcec302,xcec107,xcec108,xcec109,xcec121,xcec122,xcec123,xcec124,xcec125,
                       xcec126,xcec127,xcec128,xcec129,xcec130)
         SELECT xcebent,xcebcomp,xcebld,xcebdocno,xcebseq,
                xceb001,xceb002,xceb003,xceb004,xceb005,xceb101,xceb102,xceb103,xceb110,xceb111,
                xceb112,xceb113,xceb114,xceb115,xceb116,xceb117,xceb118,xceb119,xceb120,xceb201,
                xceb202,xceb202a,xceb202b,xceb202c,xceb202d,xceb202e,xceb202f,xceb202g,xceb202h,
                xceb212,xceb212a,xceb212b,xceb212c,xceb212d,xceb212e,xceb212f,xceb212g,xceb212h,
                xceb222,xceb222a,xceb222b,xceb222c,xceb222d,xceb222e,xceb222f,xceb222g,xceb222h,
                xceb301,xceb302,xceb107,xceb108,xceb109,xceb121,xceb122,xceb123,xceb124,xceb125,
                xceb126,xceb127,xceb128,xceb129,xceb130
           FROM sourse_ins_tmp  
   
   DELETE FROM sourse_ins_tmp;
   RETURN g_success
END FUNCTION

#发出商品
#add zhangllc 151009
PRIVATE FUNCTION axct701_01_ins_11()
#161215-00040#2 Add  ---(S)---   因效能优化,程序逻辑完全重写,旧代码保存在axct701_01_ins_11_bak中
DEFINE l_success       LIKE type_t.num5
DEFINE l_errno         LIKE gzze_t.gzze001
DEFINE l_xcea          RECORD  #工單發料成本憑證單頭檔
       xceaent LIKE xcea_t.xceaent, #企業編號
       xceacomp LIKE xcea_t.xceacomp, #法人組織
       xceald LIKE xcea_t.xceald, #帳套
       xceadocno LIKE xcea_t.xceadocno, #單據編號
       xcea001 LIKE xcea_t.xcea001, #單據日期
       xcea002 LIKE xcea_t.xcea002, #成本憑證類型
       xcea003 LIKE xcea_t.xcea003, #成本計算類型
       xcea004 LIKE xcea_t.xcea004, #年度
       xcea005 LIKE xcea_t.xcea005, #期別
       xcea006 LIKE xcea_t.xcea006, #帳務人員
       xcea007 LIKE xcea_t.xcea007, #帳務部門
       xcea101 LIKE xcea_t.xcea101, #憑證編號
       xcea102 LIKE xcea_t.xcea102, #憑證日期
       xceaownid LIKE xcea_t.xceaownid, #資料所有者
       xceaowndp LIKE xcea_t.xceaowndp, #資料所屬部門
       xceacrtid LIKE xcea_t.xceacrtid, #資料建立者
       xceacrtdp LIKE xcea_t.xceacrtdp, #資料建立部門
       xceacrtdt LIKE xcea_t.xceacrtdt, #資料創建日
       xceamodid LIKE xcea_t.xceamodid, #資料修改者
       xceamoddt LIKE xcea_t.xceamoddt, #最近修改日
       xceacnfid LIKE xcea_t.xceacnfid, #資料確認者
       xceacnfdt LIKE xcea_t.xceacnfdt, #資料確認日
       xceapstid LIKE xcea_t.xceapstid, #資料過帳者
       xceapstdt LIKE xcea_t.xceapstdt, #資料過帳日
       xceastus LIKE xcea_t.xceastus, #狀態碼
       #161109-00085#63 --s add
       xceaud001 LIKE xcea_t.xceaud001, #自定義欄位(文字)001
       xceaud002 LIKE xcea_t.xceaud002, #自定義欄位(文字)002
       xceaud003 LIKE xcea_t.xceaud003, #自定義欄位(文字)003
       xceaud004 LIKE xcea_t.xceaud004, #自定義欄位(文字)004
       xceaud005 LIKE xcea_t.xceaud005, #自定義欄位(文字)005
       xceaud006 LIKE xcea_t.xceaud006, #自定義欄位(文字)006
       xceaud007 LIKE xcea_t.xceaud007, #自定義欄位(文字)007
       xceaud008 LIKE xcea_t.xceaud008, #自定義欄位(文字)008
       xceaud009 LIKE xcea_t.xceaud009, #自定義欄位(文字)009
       xceaud010 LIKE xcea_t.xceaud010, #自定義欄位(文字)010
       xceaud011 LIKE xcea_t.xceaud011, #自定義欄位(數字)011
       xceaud012 LIKE xcea_t.xceaud012, #自定義欄位(數字)012
       xceaud013 LIKE xcea_t.xceaud013, #自定義欄位(數字)013
       xceaud014 LIKE xcea_t.xceaud014, #自定義欄位(數字)014
       xceaud015 LIKE xcea_t.xceaud015, #自定義欄位(數字)015
       xceaud016 LIKE xcea_t.xceaud016, #自定義欄位(數字)016
       xceaud017 LIKE xcea_t.xceaud017, #自定義欄位(數字)017
       xceaud018 LIKE xcea_t.xceaud018, #自定義欄位(數字)018
       xceaud019 LIKE xcea_t.xceaud019, #自定義欄位(數字)019
       xceaud020 LIKE xcea_t.xceaud020, #自定義欄位(數字)020
       xceaud021 LIKE xcea_t.xceaud021, #自定義欄位(日期時間)021
       xceaud022 LIKE xcea_t.xceaud022, #自定義欄位(日期時間)022
       xceaud023 LIKE xcea_t.xceaud023, #自定義欄位(日期時間)023
       xceaud024 LIKE xcea_t.xceaud024, #自定義欄位(日期時間)024
       xceaud025 LIKE xcea_t.xceaud025, #自定義欄位(日期時間)025
       xceaud026 LIKE xcea_t.xceaud026, #自定義欄位(日期時間)026
       xceaud027 LIKE xcea_t.xceaud027, #自定義欄位(日期時間)027
       xceaud028 LIKE xcea_t.xceaud028, #自定義欄位(日期時間)028
       xceaud029 LIKE xcea_t.xceaud029, #自定義欄位(日期時間)029
       xceaud030 LIKE xcea_t.xceaud030, #自定義欄位(日期時間)030
       xceasite LIKE xcea_t.xceasite  #營運據點
          END RECORD
DEFINE l_sql           STRING
DEFINE l_sql1          STRING
DEFINE l_rate          LIKE type_t.num26_10
DEFINE l_rate1         LIKE type_t.num26_10
DEFINE ld_date         DATETIME YEAR TO SECOND
DEFINE l_cnt1          LIKE type_t.num5         #160706-00021#3
DEFINE l_xckb005_t     LIKE xckb_t.xckb005      #160706-00021#3
DEFINE l_xckb006_t     LIKE xckb_t.xckb006      #160706-00021#3
DEFINE l_xmdk004       LIKE xmdk_t.xmdk004      #160816-00015#1 add
DEFINE l_sql_xckb012   STRING
DEFINE l_sql_xckb037   STRING
DEFINE l_sql_xckb038   STRING
DEFINE l_sql_xceb101   STRING
DEFINE l_sql_xcec101   STRING

  #CALL axct701_01_create_tmp()    #170324-00054#1 mark

   LET g_success = 'Y'
   LET l_xcea.xceaent   = g_enterprise
   LET l_xcea.xceacomp  = g_xcea_m.xceacomp
   LET l_xcea.xceald    = g_xcea_m.xceald
   LET l_xcea.xcea001   = g_xcea_m.xcea001
   LET l_xcea.xcea002   = g_xcea002   #11转入 12转出
   LET l_xcea.xcea003   = g_xcea_m.xcea003
   LET l_xcea.xcea004   = g_xcea_m.xcea004
   LET l_xcea.xcea005   = g_xcea_m.xcea005
   LET l_xcea.xcea006   = g_xcea_m.xcea006
   LET l_xcea.xcea007   = g_xcea_m.xcea007
   LET l_xcea.xcea101   = ''
   LET l_xcea.xcea102   = ''
   LET l_xcea.xceaownid = g_user
   LET l_xcea.xceaowndp = g_dept
   LET l_xcea.xceacrtid = g_user
   LET l_xcea.xceacrtdp = g_dept 
   LET ld_date = cl_get_current()
   LET l_xcea.xceacrtdt = ld_date
   LET l_xcea.xceamodid = ""
   LET l_xcea.xceamoddt = ""
   LET l_xcea.xceacnfid = ""
   LET l_xcea.xceacnfdt = ""
   LET l_xcea.xceapstid = ""
   LET l_xcea.xceapstdt = ""
   LET l_xcea.xceastus  = 'N'
   CALL s_aooi200_fin_gen_docno(g_xcea_m.xceald,'','',g_xcea_m.xceadocno,g_xcea_m.xcea001,g_prog_name1)
   RETURNING l_success,l_xcea.xceadocno
   IF l_success  = 0  THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = 'apm-00003'
      LET g_errparam.extend = g_xcea_m.xceadocno
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET g_success = 'N'
      RETURN g_success
   END IF
   INSERT INTO xcea_t(xceaent,xceacomp,xceald,xceadocno,xcea001,
                      xcea002,xcea003,xcea004,xcea005,xcea006,
                      xcea007,xcea101,xcea102,xceaownid,xceaowndp,
                      xceacrtid,xceacrtdp,xceacrtdt,xceamodid,xceamoddt,
                      xceacnfid,xceacnfdt,xceapstid,xceapstdt,xceastus,
                      xceaud001,xceaud002,xceaud003,xceaud004,xceaud005,
                      xceaud006,xceaud007,xceaud008,xceaud009,xceaud010,
                      xceaud011,xceaud012,xceaud013,xceaud014,xceaud015,
                      xceaud016,xceaud017,xceaud018,xceaud019,xceaud020,
                      xceaud021,xceaud022,xceaud023,xceaud024,xceaud025,
                      xceaud026,xceaud027,xceaud028,xceaud029,xceaud030,
                      xceasite)
   VALUES(l_xcea.xceaent,l_xcea.xceacomp,l_xcea.xceald,l_xcea.xceadocno,l_xcea.xcea001,
          l_xcea.xcea002,l_xcea.xcea003,l_xcea.xcea004,l_xcea.xcea005,l_xcea.xcea006,
          l_xcea.xcea007,l_xcea.xcea101,l_xcea.xcea102,l_xcea.xceaownid,l_xcea.xceaowndp,
          l_xcea.xceacrtid,l_xcea.xceacrtdp,l_xcea.xceacrtdt,l_xcea.xceamodid,l_xcea.xceamoddt,
          l_xcea.xceacnfid,l_xcea.xceacnfdt,l_xcea.xceapstid,l_xcea.xceapstdt,l_xcea.xceastus,
          l_xcea.xceaud001,l_xcea.xceaud002,l_xcea.xceaud003,l_xcea.xceaud004,l_xcea.xceaud005,
          l_xcea.xceaud006,l_xcea.xceaud007,l_xcea.xceaud008,l_xcea.xceaud009,l_xcea.xceaud010,
          l_xcea.xceaud011,l_xcea.xceaud012,l_xcea.xceaud013,l_xcea.xceaud014,l_xcea.xceaud015,
          l_xcea.xceaud016,l_xcea.xceaud017,l_xcea.xceaud018,l_xcea.xceaud019,l_xcea.xceaud020,
          l_xcea.xceaud021,l_xcea.xceaud022,l_xcea.xceaud023,l_xcea.xceaud024,l_xcea.xceaud025,
          l_xcea.xceaud026,l_xcea.xceaud027,l_xcea.xceaud028,l_xcea.xceaud029,l_xcea.xceaud030,
          l_xcea.xceasite)
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "xcea_t"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET g_success = 'N'
      RETURN g_success
   END IF
   LET g_xcea_m.xceadocno = l_xcea.xceadocno

   LET l_sql_xckb037 = " SELECT xckb037 FROM xckb_t t3 ",
                       "  WHERE xckbent = '",g_enterprise,"' AND xckbld = '",g_xcea_m.xceald,"'",
                       "    AND xckbcomp= '",g_xcea_m.xceacomp,"' ",
                       "    AND xckb007 = ",g_xcea_m.xcea004," AND xckb008 = ",g_xcea_m.xcea005, #年度，期別
                       "    AND ROWNUM = 1",
					   "    AND t1.xckb005 = t3.xckb005 ",
                       "    AND t1.xckb006 = t3.xckb006 "
   IF  l_xcea.xcea002 = '11' THEN  #11转入 12转出
       LET l_sql = l_sql CLIPPED," AND xckb002 = 1 "  #转入
      #axct711:取的不是所有的轉入 要扣除本直接轉出的
     #170116-00010#1-s-mark
      #LET l_sql = l_sql CLIPPED," AND (xckb005,xckb006) IN ",
      #                           " (SELECT xckb005,xckb006 FROM xckb_t ",
      #                           "   WHERE xckbent = '",g_enterprise,"' AND xckbld = '",g_xcea_m.xceald,"'",
      #                           "    AND xckbcomp= '",g_xcea_m.xceacomp,"' ",
      #                           "    AND xckb007 = ",g_xcea_m.xcea004," AND xckb008 = ",g_xcea_m.xcea005,
      #                           "    GROUP BY xckb005,xckb006
      #                                HAVING SUM(xckb002*xckb014) > 0)"
     #170116-00010#1-e-mark                                  
     #170116-00010#1-s-add
      LET l_sql = l_sql CLIPPED,"AND NOT EXISTS (SELECT 1 FROM isaf_t,isag_t,xmdk_t ",
                                "                 WHERE isafent = isagent AND isafcomp = isagcomp ",
                                "                   AND isafdocno = isagdocno ",
                                "                   AND isag002 = xmdkdocno ",
                                "                   AND xmdkent = xckbent AND xmdkdocno = xckb005 ",
                                "                   AND to_char(xmdk001,'yyyyMM') < xckb007*100+xckb008 ",
                                "                   AND isafstus = 'Y'",
                                "                   AND isag002 = isag002 AND isag003 = xckb006 ",
                                "                )"   
     #170116-00010#1-e-add
   ELSE
      LET l_sql = l_sql CLIPPED," AND xckb002 = -1 "  #转出
      #axct712:只取前期轉入  本月轉出開發票的
      #170105-00067#1 add start -----
      LET l_sql = l_sql CLIPPED," AND (xckb005,xckb006) IN ",
                                " (SELECT isag002,isag003 FROM isaf_t,isag_t,xmdk_t ",
                                "   WHERE isafent = isagent AND isafcomp = isagcomp ",
                                "     AND isafdocno = isagdocno ",
                                "     AND isag002 = xmdkdocno ",
                                "     AND xmdkent =xckbent AND xmdkdocno=xckb005 ",
                                "     AND to_char(xmdk001,'yyyyMM') < xckb007*100+xckb008 ",
                                "     AND isafstus = 'Y'",
                                "  )"
      #170105-00067#1 add end   -----
      #170105-00067#1 mark start -----
      #LET l_sql = l_sql CLIPPED," AND (xckb005,xckb006) IN ",
      #                          " (SELECT isag002,isag003 FROM isaf_t,isag_t,xmdk_t,xmdl_t",
      #                          "   WHERE isafent = isagent AND isafcomp = isagcomp ",
      #                          "     AND isafdocno = isagdocno ",
      #                          "     AND isagent = xckbent AND isagcomp = xckbcomp AND isagdocno = xckb005 AND isagseq = xckb006 ",
      #                          "     AND isafstus = 'Y'",
      #                          "     AND xckb007*100+xckb008 < to_char(isafdocdt,'yyyyMM') ",
      #                          "  )"
      #170105-00067#1 mark end   -----

   END IF

   LET l_sql_xckb038 = " SELECT xckb038 FROM xckb_t t4 ",
                       "  WHERE xckbent = '",g_enterprise,"' AND xckbld = '",g_xcea_m.xceald,"'",
                       "    AND xckbcomp= '",g_xcea_m.xceacomp,"' ",
                       "    AND xckb007 = ",g_xcea_m.xcea004," AND xckb008 = ",g_xcea_m.xcea005, #年度，期別
                       "    AND ROWNUM = 1",
					   "    AND t1.xckb005 = t4.xckb005 ",
                       "    AND t1.xckb006 = t4.xckb006"
   IF  l_xcea.xcea002 = '11' THEN  #11转入 12转出
       LET l_sql = l_sql CLIPPED," AND xckb002 = 1 "  #转入
      #axct711:取的不是所有的轉入 要扣除本直接轉出的
     #170116-00010#1-s-mark 
      #LET l_sql = l_sql CLIPPED," AND (xckb005,xckb006) IN ",
      #                           " (SELECT xckb005,xckb006 FROM xckb_t ",
      #                           "   WHERE xckbent = '",g_enterprise,"' AND xckbld = '",g_xcea_m.xceald,"'",
      #                           "    AND xckbcomp= '",g_xcea_m.xceacomp,"' ",
      #                           "    AND xckb007 = ",g_xcea_m.xcea004," AND xckb008 = ",g_xcea_m.xcea005,
      #                           "    GROUP BY xckb005,xckb006
      #                                HAVING SUM(xckb002*xckb014) > 0)"
     #170116-00010#1-e-mark
     #170116-00010#1-s-add
      LET l_sql = l_sql CLIPPED,"AND NOT EXISTS (SELECT 1 FROM isaf_t,isag_t,xmdk_t ",
                                "                 WHERE isafent = isagent AND isafcomp = isagcomp ",
                                "                   AND isafdocno = isagdocno ",
                                "                   AND isag002 = xmdkdocno ",
                                "                   AND xmdkent = xckbent AND xmdkdocno = xckb005 ",
                                "                   AND to_char(xmdk001,'yyyyMM') < xckb007*100+xckb008 ",
                                "                   AND isafstus = 'Y'",
                                "                   AND isag002 = isag002 AND isag003 = xckb006 ",
                                "                )"   
     #170116-00010#1-e-add   
   ELSE
      LET l_sql = l_sql CLIPPED," AND xckb002 = -1 "  #转出
      #axct712:只取前期轉入  本月轉出開發票的
      #170105-00067#1 add start -----
      LET l_sql = l_sql CLIPPED," AND (xckb005,xckb006) IN ",
                                " (SELECT isag002,isag003 FROM isaf_t,isag_t,xmdk_t ",
                                "   WHERE isafent = isagent AND isafcomp = isagcomp ",
                                "     AND isafdocno = isagdocno ",
                                "     AND isag002 = xmdkdocno ",
                                "     AND xmdkent =xckbent AND xmdkdocno=xckb005 ",
                                "     AND to_char(xmdk001,'yyyyMM') < xckb007*100+xckb008 ",
                                "     AND isafstus = 'Y'",
                                "  )"
      #170105-00067#1 add end   -----
      #170105-00067#1 mark start ----- 
      #LET l_sql = l_sql CLIPPED," AND (xckb005,xckb006) IN ",
      #                          " (SELECT isag002,isag003 FROM isaf_t,isag_t,xmdk_t,xmdl_t",
      #                          "   WHERE isafent = isagent AND isafcomp = isagcomp ",
      #                          "     AND isafdocno = isagdocno ",
      #                          "     AND isagent = xckbent AND isagcomp = xckbcomp AND isagdocno = xckb005 AND isagseq = xckb006 ",
      #                          "     AND isafstus = 'Y'",
      #                          "     AND xckb007*100+xckb008 < to_char(isafdocdt,'yyyyMM') ",
      #                          "  )"
      #170105-00067#1 mark start ----- 
   END IF

   #抓取科目
   #xceb101
   IF g_xcea002='11' THEN   #11转入 12转出
      LET l_sql_xceb101 = "(SELECT imag011 FROM imag_t WHERE imagent = ",g_enterprise," AND imagsite = '",g_xcea_m.xceacomp,"' AND imag001 = xckb012 )"
      #LET l_sql_xceb101 = " (SELECT glcc006 FROM glcc_t ", #170221-00041#1 mark 
      LET l_sql_xceb101 = " (SELECT DISTINCT glcc006 FROM glcc_t ", #170221-00041#1 add  
                          " WHERE glccent = ",g_enterprise,"  AND glcc001 = '1'  AND glccld  = '",g_xcea_m.xceald,"'
                              AND ROWNUM = 1
                              AND ( glcc014='",g_xcea_m.xceacomp,"' OR glcc014='*' )         ",
                          "   AND ((glcc016=xckb012 OR glcc016 = '*') AND ((glcc011 IN ",l_sql_xceb101," OR glcc011='*') OR ",l_sql_xceb101," IS NULL))) "
   ELSE
      LET l_sql_xceb101 = "(SELECT imag011 FROM imag_t WHERE imagent = ",g_enterprise," AND imagsite = '",g_xcea_m.xceacomp,"' AND imag001 = xckb012 )"
      #LET l_sql_xceb101 = " (SELECT glcc004 FROM glcc_t ", #170221-00041#1 mark
      LET l_sql_xceb101 = " (SELECT DISTINCT glcc004 FROM glcc_t ", #170221-00041#1 add     
                          " WHERE glccent = ",g_enterprise,"  AND glcc001 = '2'  AND glccld  = '",g_xcea_m.xceald,"'
                              AND ROWNUM = 1
                              AND ( glcc014='",g_xcea_m.xceacomp,"' OR glcc014='*' )         ",
                          "   AND ((glcc016=xckb012 OR glcc016 = '*') AND ((glcc011 IN ",l_sql_xceb101," OR glcc011='*') OR ",l_sql_xceb101," IS NULL))) "
   END IF
   #xcec101
   IF g_xcea002='11' THEN   #11转入 12转出
      LET l_sql_xcec101 = "(SELECT imag011 FROM imag_t WHERE imagent = ",g_enterprise," AND imagsite = '",g_xcea_m.xceacomp,"' AND imag001 = xckb012 )"
      #LET l_sql_xcec101 = " (SELECT glcc002 FROM glcc_t ", #170221-00041#1 mark
      LET l_sql_xcec101 = " (SELECT DISTINCT glcc002 FROM glcc_t ", #170221-00041#1 add      
                          " WHERE glccent = ",g_enterprise,"  AND glcc001 = '1'  AND glccld  = '",g_xcea_m.xceald,"'
                              AND ROWNUM = 1
                              AND ( glcc014='",g_xcea_m.xceacomp,"' OR glcc014='*' )         ",
                          "   AND ((glcc016=xckb012 OR glcc016 = '*') AND ((glcc011 IN ",l_sql_xcec101," OR glcc011='*') OR ",l_sql_xcec101," IS NULL))) "
   ELSE
      LET l_sql_xcec101 = "(SELECT imag011 FROM imag_t WHERE imagent = ",g_enterprise," AND imagsite = '",g_xcea_m.xceacomp,"' AND imag001 = xckb012 )"
      #LET l_sql_xcec101 = " (SELECT glcc006 FROM glcc_t ", #170221-00041#1 mark
      LET l_sql_xcec101 = " (SELECT DISTINCT glcc006 FROM glcc_t ", #170221-00041#1 add
                          " WHERE glccent = ",g_enterprise,"  AND glcc001 = '1'  AND glccld  = '",g_xcea_m.xceald,"'
                              AND ROWNUM = 1
                              AND ( glcc014='",g_xcea_m.xceacomp,"' OR glcc014='*' )         ",
                          "   AND ((glcc016=xckb012 OR glcc016 = '*') AND ((glcc011 IN ",l_sql_xcec101," OR glcc011='*') OR ",l_sql_xcec101," IS NULL))) "
   END IF

   #xceb单身
   #170322-00125#1 modify (S) remove xckb002 整段改为每行用双引号
   LET l_sql = "INSERT INTO sourse_ins_tmp ",
               "  (xcebent,xcebcomp,xcebld,xcebdocno,xcebseq,xceb001,xceb002,xceb003,xceb004,xceb005,xceb101,xceb102,",
               "   xceb103,xceb110,xceb111,xceb112,xceb113,xceb114,xceb115,xceb116,xceb117,xceb118,xceb119,xceb120,",
               "   xceb201,xceb202,xceb202a,xceb202b,xceb202c,xceb202d,xceb202e,xceb202f,xceb202g,xceb202h,xceb212,",
               "   xceb212a,xceb212b,xceb212c,xceb212d,xceb212e,xceb212f,xceb212g,xceb212h,xceb222,xceb222a,xceb222b,",
               "   xceb222c,xceb222d,xceb222e,xceb222f,xceb222g,xceb222h,xceb301,xceb302,xceb107,xceb108,xceb109,",
               "   xceb121,xceb122,xceb123,xceb124,xceb125,xceb126,xceb127,xceb128,xceb129,xceb130,xceb131,xceb132,",
               "   sfaa009,sfaasite,sfaa028,sfaa029,sfaa052,sfaa057) ",
               "SELECT xckbent,xckbcomp,xckbld,'",l_xcea.xceadocno,"' xcebdocno,rownum,xckb005,xckb006,'9', ",
               "xckb012,(",l_sql_xckb037,") xckb037,",l_sql_xceb101,",",
               "(SELECT glab010 FROM glab_t WHERE glabld  = '",g_xcea_m.xceald,"' AND glab001 = '61' AND glab002 = '8925' AND glab003 = '",g_xcea002,"' AND glabent = xckbent), ",
               "(",l_sql_xckb038,") xckb038,' ',xmdk008,pmaa090,xmdl222,CASE WHEN ooeg004 IS NULL THEN CASE WHEN xmdk004 IS NOT NULL THEN xmdk004 ELSE xmdl214 END ELSE ooeg004 END,xmdl216,xmdl200,' ',' ',xmdl030,xmdl031, ",
               " xckb021,xckb102,xckb102a,xckb102b,xckb102c,xckb102d,xckb102e,xckb102f,xckb102g,xckb102h, ",
               "         xckb112,xckb112a,xckb112b,xckb112c,xckb112d,xckb112e,xckb112f,xckb112g,xckb112h, ",
               "         xckb122,xckb122a,xckb122b,xckb122c,xckb122d,xckb122e,xckb122f,xckb122g,xckb122h, ",
               "         '','',xmdl213,CASE WHEN xmdk004 IS NOT NULL THEN xmdk004 ELSE xmdl214 END ,xmdk008, ",
               "         ' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','','', ",
               "         '','','',",l_sql_xcec101,",'','' ",
               " FROM ",
               " (SELECT xckbent,xckbcomp,xckbld,xckb002,xckb005,xckb006,xckb007,xckb012, ",
               "          SUM(xckb014)  xckb021 ,SUM(xckb102 ) xckb102 ,SUM(xckb102a) xckb102a, ",
               "          SUM(xckb102b) xckb102b,SUM(xckb102c) xckb102c,SUM(xckb102d) xckb102d, ",
               "          SUM(xckb102e) xckb102e,SUM(xckb102f) xckb102f,SUM(xckb102g) xckb102g, ",
               "          SUM(xckb102h) xckb102h, ",
               "          SUM(xckb112 ) xckb112 ,SUM(xckb112a) xckb112a,SUM(xckb112b) xckb112b, ",
               "          SUM(xckb112c) xckb112c,SUM(xckb112d) xckb112d,SUM(xckb112e) xckb112e, ",
               "          SUM(xckb112f) xckb112f,SUM(xckb112g) xckb112g,SUM(xckb112h) xckb112h, ",
               "          SUM(xckb122 ) xckb122 ,SUM(xckb122a) xckb122a,SUM(xckb122b) xckb122b, ",
               "          SUM(xckb122c) xckb122c,SUM(xckb122d) xckb122d,SUM(xckb122e) xckb122e, ",
               "          SUM(xckb122f) xckb122f,SUM(xckb122g) xckb122g,SUM(xckb122h) xckb122h  ",
               "      FROM xckb_t ",
               "  WHERE xckbent = '",g_enterprise,"' AND xckbld = '",g_xcea_m.xceald,"'",
               "    AND xckbcomp= '",g_xcea_m.xceacomp,"' ",
               "    AND xckb007 = ",g_xcea_m.xcea004," AND xckb008 = ",g_xcea_m.xcea005#, #年度，期別
   #170322-00125#1 modify (E)
   IF  l_xcea.xcea002 = '11' THEN  #11转入 12转出
       LET l_sql = l_sql CLIPPED," AND xckb002 = 1 "  #转入
       #axct711:取的不是所有的轉入 要扣除本直接轉出的
      #170116-00010#1-s-mark 
      #LET l_sql = l_sql CLIPPED," AND (xckb005,xckb006) IN ",
      #                           " (SELECT xckb005,xckb006 FROM xckb_t ",
      #                           "   WHERE xckbent = '",g_enterprise,"' AND xckbld = '",g_xcea_m.xceald,"'",
      #                           "    AND xckbcomp= '",g_xcea_m.xceacomp,"' ",
      #                           "    AND xckb007 = ",g_xcea_m.xcea004," AND xckb008 = ",g_xcea_m.xcea005,
      #                           "    GROUP BY xckb005,xckb006
      #                                HAVING SUM(xckb002*xckb014) > 0)"
      #170116-00010#1-e-mark                                       
      #170116-00010#1-s-add
      LET l_sql = l_sql CLIPPED,"AND NOT EXISTS (SELECT 1 FROM isaf_t,isag_t,xmdk_t ",
                                "                 WHERE isafent = isagent AND isafcomp = isagcomp ",
                                "                   AND isafdocno = isagdocno ",
                                "                   AND isag002 = xmdkdocno ",
                                "                   AND xmdkent = xckbent AND xmdkdocno = xckb005 ",
                                "                   AND to_char(xmdk001,'yyyyMM') < xckb007*100+xckb008 ",
                                "                   AND isafstus = 'Y'",
                                "                   AND isag002 = isag002 AND isag003 = xckb006 ",
                                "                )"   
      #170116-00010#1-e-add      
   ELSE
      LET l_sql = l_sql CLIPPED," AND xckb002 = -1 "  #转出
      #axct712:只取前期轉入  本月轉出開發票的
      #170105-00067#1 add start -----
      LET l_sql = l_sql CLIPPED," AND (xckb005,xckb006) IN ",
                                " (SELECT isag002,isag003 FROM isaf_t,isag_t,xmdk_t ", 
                                "   WHERE isafent = isagent AND isafcomp = isagcomp ",
                                "     AND isafdocno = isagdocno ",
                                "     AND isag002 = xmdkdocno ",
                                "     AND xmdkent =xckbent AND xmdkdocno=xckb005 ",
                                "     AND to_char(xmdk001,'yyyyMM') < xckb007*100+xckb008 ",
                                "     AND isafstus = 'Y'",
                                "  )"
      #170105-00067#1 add end   -----
      #170105-00067#1 mark start -----
      #LET l_sql = l_sql CLIPPED," AND (xckb005,xckb006) IN ",
      #                          " (SELECT isag002,isag003 FROM isaf_t,isag_t,xmdk_t,xmdl_t",
      #                          "   WHERE isafent = isagent AND isafcomp = isagcomp ",
      #                          "     AND isafdocno = isagdocno ",
      #                          "     AND isagent = xckbent AND isagcomp = xckbcomp AND isagdocno = xckb005 AND isagseq = xckb006 ",
      #                          "     AND isafstus = 'Y'",
      #                          "     AND xckb007*100+xckb008 < to_char(isafdocdt,'yyyyMM') ",
      #                          "  )"
      #170105-00067#1 mark end   -----
   END IF
   LET l_sql = l_sql CLIPPED, " GROUP BY xckbent,xckbcomp,xckbld,xckb002,xckb005,xckb006,xckb012,xckb007 HAVING (SUM(xckb002*xckb014) <> 0 OR SUM(xckb002*xckb102 ) <> 0) ORDER BY  xckb005,xckb006) t1 "
   LET l_sql = l_sql,",(SELECT xmdldocno,xmdlseq,xmdk008,pmaa090,xmdl222,ooeg004,xmdl216,xmdl200,xmdl030,xmdl031,xmdl213,xmdl214,xmdk004
        FROM xmdk_t LEFT JOIN pmaa_t ON pmaaent = xmdkent AND pmaa001=xmdk008 ,
             xmdl_t LEFT JOIN ooeg_t ON ooegent = xmdlent AND ooeg001=xmdl214 AND ooeg003='3'
       WHERE xmdkent  = xmdlent
         AND xmdkdocno= xmdldocno
         AND xmdlent  = ",g_enterprise,")
         WHERE xmdldocno= xckb005
         AND xmdlseq  = xckb006"

   PREPARE axct701_01_ins_11 FROM l_sql
   EXECUTE axct701_01_ins_11

   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (         SELECT imaa009,imaa126,imaa001 
                            FROM imaa_t 
                               WHERE imaaent = ",g_enterprise," )        ",
                   "    ON (xceb004=imaa001)                        ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb117 = imaa009,",
                   "               xceb118 = imaa126 "
   PREPARE axct701_01_11_meg_01 FROM g_sql
   EXECUTE axct701_01_11_meg_01

   #抓取科目
   IF g_xcea002='11' THEN   #11转入 12转出
      LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                      #" USING (SELECT glcc006,glcc016,glcc011 FROM glcc_t       ", #170221-00041#1 mark
                      " USING (SELECT DISTINCT glcc006,glcc016,glcc011 FROM glcc_t ", #170221-00041#1 add
                      " WHERE glccent = ",g_enterprise,"  AND glcc001 = '1'  AND glccld  = '",g_xcea_m.xceald,"'
                          AND ( glcc014='",g_xcea_m.xceacomp,"' OR glcc014='*' ) )        ",
                      "    ON ((glcc016=xceb004 OR glcc016 = '*') AND (glcc011=sfaasite OR glcc011='*') ) ",
                      "    WHEN MATCHED THEN                            ",
                      "    UPDATE SET xceb101 = glcc006"
   ELSE
      LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                      #" USING (SELECT glcc004,glcc016,glcc011 FROM glcc_t       ", #170221-00041#1 mark
                      " USING (SELECT DISTINCT glcc004,glcc016,glcc011 FROM glcc_t ", #170221-00041#1 add
                      " WHERE glccent = ",g_enterprise,"  AND glcc001 = '2'  AND glccld  = '",g_xcea_m.xceald,"'
                          AND ( glcc014='",g_xcea_m.xceacomp,"' OR glcc014='*' ) )        ",
                      "    ON ((glcc016=xceb004 OR glcc016 = '*') AND (glcc011=sfaasite OR glcc011='*') ) ",
                      "    WHEN MATCHED THEN                            ",
                      "    UPDATE SET xceb101 = glcc004"
   END IF
   PREPARE axct701_01_11_meg_03 FROM g_sql
   EXECUTE axct701_01_11_meg_03

  #启用交易对象
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad010 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad010 = 'N'  ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb111 = ' '"
   PREPARE axct701_01_11_meg_xceb111 FROM g_sql
   EXECUTE axct701_01_11_meg_xceb111

  #启用客群
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad011 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad011 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb112 = ' '"
   PREPARE axct701_01_11_meg_xceb112 FROM g_sql
   EXECUTE axct701_01_11_meg_xceb112

  #启用区域
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad009 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad009 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb113 = ' '"
   PREPARE axct701_01_11_meg_xceb113 FROM g_sql
   EXECUTE axct701_01_11_meg_xceb113

   
  #启用成本中心
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad008 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad008 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb114 = ' '"
   PREPARE axct701_01_11_meg_xceb114 FROM g_sql
   EXECUTE axct701_01_11_meg_xceb114
   
  #启用经营类别
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad031 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad031 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb115 = ' '"
   PREPARE axct701_01_11_meg_xceb115 FROM g_sql
   EXECUTE axct701_01_11_meg_xceb115
 
  #启用渠道
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad032 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad032 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb116 = ' '"
   PREPARE axct701_01_11_meg_xceb116 FROM g_sql
   EXECUTE axct701_01_11_meg_xceb116

  #启用品类
  #170221-00041#1add start -----
   UPDATE sourse_ins_tmp
      SET xceb117 = (SELECT imag011 FROM imag_t
                      WHERE imagent = xcebent
                        AND imagsite = g_xcea_m.xceacomp
                        AND imag001 = xceb004)
  #170221-00041#1 add end   ----   
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad012 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad012 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb117 = ' '"
   PREPARE axct701_01_11_meg_xceb117 FROM g_sql
   EXECUTE axct701_01_11_meg_xceb117
   
  #启用品牌
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad033 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad033 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb118 = ' '"
   PREPARE axct701_01_11_meg_xceb118 FROM g_sql
   EXECUTE axct701_01_11_meg_xceb118
 
  #启用项目号
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad015 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad015 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb119 = ' '"
   PREPARE axct701_01_11_meg_xceb119 FROM g_sql
   EXECUTE axct701_01_11_meg_xceb119
 
  #启用WBS
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad016 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad016 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb120 = ' '"
   PREPARE axct701_01_11_meg_xceb120 FROM g_sql
   EXECUTE axct701_01_11_meg_xceb120
 
  #启用人员
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad013 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad013 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb107 = ' '"
   PREPARE axct701_01_11_meg_xceb107 FROM g_sql
   EXECUTE axct701_01_11_meg_xceb107
 
  #启用部门
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad007 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad007 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb108 = ' '"
   PREPARE axct701_01_11_meg_xceb108 FROM g_sql
   EXECUTE axct701_01_11_meg_xceb108
   
  #启用账款对象
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad027 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad027 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb109 = ' '"
   PREPARE axct701_01_11_meg_xceb109 FROM g_sql
   EXECUTE axct701_01_11_meg_xceb109
   
  #启用自由核算项1
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad017 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad017 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb121 = ' '"
   PREPARE axct701_01_11_meg_xceb121 FROM g_sql
   EXECUTE axct701_01_11_meg_xceb121
 
  #启用自由核算项2
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad018 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad018 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb122 = ' '"
   PREPARE axct701_01_11_meg_xceb122 FROM g_sql
   EXECUTE axct701_01_11_meg_xceb122
 
  #启用自由核算项3
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad019 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad019 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb123 = ' '"
   PREPARE axct701_01_11_meg_xceb123 FROM g_sql
   EXECUTE axct701_01_11_meg_xceb123

  #启用自由核算项4
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad019 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad019 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb124 = ' '"
   PREPARE axct701_01_11_meg_xceb124 FROM g_sql
   EXECUTE axct701_01_11_meg_xceb124

  #启用自由核算项5
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad021 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad021 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb125 = ' '"
   PREPARE axct701_01_11_meg_xceb125 FROM g_sql
   EXECUTE axct701_01_11_meg_xceb125

  #启用自由核算项6
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad022 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad022 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb126 = ' '"
   PREPARE axct701_01_11_meg_xceb126 FROM g_sql
   EXECUTE axct701_01_11_meg_xceb126

  #启用自由核算项7
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad023 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad023 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb127 = ' '"
   PREPARE axct701_01_11_meg_xceb127 FROM g_sql
   EXECUTE axct701_01_11_meg_xceb127

  #启用自由核算项8
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad024 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad024 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb128 = ' '"
   PREPARE axct701_01_11_meg_xceb128 FROM g_sql
   EXECUTE axct701_01_11_meg_xceb128

  #启用自由核算项9
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad025 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad025 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb129 = ' '"
   PREPARE axct701_01_11_meg_xceb129 FROM g_sql
   EXECUTE axct701_01_11_meg_xceb129

  #启用自由核算项10
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad026 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad026 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb130 = ' '"
   PREPARE axct701_01_11_meg_xceb130 FROM g_sql
   EXECUTE axct701_01_11_meg_xceb130

  #特性
   UPDATE sourse_ins_tmp SET xceb005 = ' ' WHERE xceb005 IS NULL
 #科目编号
   UPDATE sourse_ins_tmp SET xceb101 = ' ' WHERE xceb101 IS NULL
  #摘要
   UPDATE sourse_ins_tmp SET xceb102 = ' ' WHERE xceb102 IS NULL
  #成本域
   UPDATE sourse_ins_tmp SET xceb103 = ' ' WHERE xceb103 IS NULL
  #原因码
   UPDATE sourse_ins_tmp SET xceb110 = ' ' WHERE xceb110 IS NULL
  #交易对象
   UPDATE sourse_ins_tmp SET xceb111 = ' ' WHERE (xceb111 IS NULL OR xceb101 = ' ')
  #客群
   UPDATE sourse_ins_tmp SET xceb112 = ' ' WHERE (xceb112 IS NULL OR xceb101 = ' ')
  #区域
   UPDATE sourse_ins_tmp SET xceb113 = ' ' WHERE (xceb113 IS NULL OR xceb101 = ' ')
  #成本中心
   UPDATE sourse_ins_tmp SET xceb114 = ' ' WHERE (xceb114 IS NULL OR xceb101 = ' ')
  #经营类别
   UPDATE sourse_ins_tmp SET xceb115 = ' ' WHERE (xceb115 IS NULL OR xceb101 = ' ')
  #渠道
   UPDATE sourse_ins_tmp SET xceb116 = ' ' WHERE (xceb116 IS NULL OR xceb101 = ' ')
  #品类
   UPDATE sourse_ins_tmp SET xceb117 = ' ' WHERE (xceb117 IS NULL OR xceb101 = ' ')
  #品牌
   UPDATE sourse_ins_tmp SET xceb118 = ' ' WHERE (xceb118 IS NULL OR xceb101 = ' ')
  #项目号
   UPDATE sourse_ins_tmp SET xceb119 = ' ' WHERE (xceb119 IS NULL OR xceb101 = ' ')
  #WBS
   UPDATE sourse_ins_tmp SET xceb120 = ' ' WHERE (xceb120 IS NULL OR xceb101 = ' ')
  #人员
   UPDATE sourse_ins_tmp SET xceb107 = ' ' WHERE (xceb107 IS NULL OR xceb101 = ' ')
   #部门
   UPDATE sourse_ins_tmp SET xceb108 = ' ' WHERE (xceb108 IS NULL OR xceb101 = ' ')
  #账款对象
   UPDATE sourse_ins_tmp SET xceb109 = ' ' WHERE (xceb109 IS NULL OR xceb101 = ' ')
  #程序原本逻辑没有给自由核算项赋值,这里就不再判断是否启用核算项了,默认都是' ' ---STR---
#  #自由核算项1
#   UPDATE sourse_ins_tmp SET xceb121 = ' ' WHERE (xceb121 IS NULL OR xceb101 = ' ')
#  #自由核算项2
#   UPDATE sourse_ins_tmp SET xceb122 = ' ' WHERE (xceb122 IS NULL OR xceb101 = ' ')
#  #自由核算项3
#   UPDATE sourse_ins_tmp SET xceb123 = ' ' WHERE (xceb123 IS NULL OR xceb101 = ' ')
#  #自由核算项4
#   UPDATE sourse_ins_tmp SET xceb124 = ' ' WHERE (xceb124 IS NULL OR xceb101 = ' ')
#  #自由核算项5
#   UPDATE sourse_ins_tmp SET xceb125 = ' ' WHERE (xceb125 IS NULL OR xceb101 = ' ')
#  #自由核算项6
#   UPDATE sourse_ins_tmp SET xceb126 = ' ' WHERE (xceb126 IS NULL OR xceb101 = ' ')
#   #自由核算项7
#   UPDATE sourse_ins_tmp SET xceb127 = ' ' WHERE (xceb127 IS NULL OR xceb101 = ' ')
#  #自由核算项8
#   UPDATE sourse_ins_tmp SET xceb128 = ' ' WHERE (xceb128 IS NULL OR xceb101 = ' ')
#  #自由核算项9
#   UPDATE sourse_ins_tmp SET xceb129 = ' ' WHERE (xceb129 IS NULL OR xceb101 = ' ')
#  #自由核算项10
#   UPDATE sourse_ins_tmp SET xceb130 = ' ' WHERE (xceb130 IS NULL OR xceb101 = ' ')
  #程序原本逻辑没有给自由核算项赋值,这里就不再判断是否启用核算项了,默认都是' ' ---END---

   INSERT INTO xceb_t (xcebent,xcebcomp,xcebld,xcebdocno,xcebseq,
                       xceb001,xceb002,xceb003,xceb004,xceb005,xceb101,xceb102,xceb103,xceb110,xceb111,
                       xceb112,xceb113,xceb114,xceb115,xceb116,xceb117,xceb118,xceb119,xceb120,xceb201,
                       xceb202,xceb202a,xceb202b,xceb202c,xceb202d,xceb202e,xceb202f,xceb202g,xceb202h,
                       xceb212,xceb212a,xceb212b,xceb212c,xceb212d,xceb212e,xceb212f,xceb212g,xceb212h,
                       xceb222,xceb222a,xceb222b,xceb222c,xceb222d,xceb222e,xceb222f,xceb222g,xceb222h,
                       xceb301,xceb302,xceb107,xceb108,xceb109,xceb121,xceb122,xceb123,xceb124,xceb125,
                       xceb126,xceb127,xceb128,xceb129,xceb130,xceb131,xceb132)
         SELECT xcebent,xcebcomp,xcebld,xcebdocno,xcebseq,
                       xceb001,xceb002,xceb003,xceb004,xceb005,xceb101,xceb102,xceb103,xceb110,xceb111,
                       xceb112,xceb113,xceb114,xceb115,xceb116,xceb117,xceb118,xceb119,xceb120,xceb201,
                       xceb202,xceb202a,xceb202b,xceb202c,xceb202d,xceb202e,xceb202f,xceb202g,xceb202h,
                       xceb212,xceb212a,xceb212b,xceb212c,xceb212d,xceb212e,xceb212f,xceb212g,xceb212h,
                       xceb222,xceb222a,xceb222b,xceb222c,xceb222d,xceb222e,xceb222f,xceb222g,xceb222h,
                       xceb301,xceb302,xceb107,xceb108,xceb109,xceb121,xceb122,xceb123,xceb124,xceb125,
                       xceb126,xceb127,xceb128,xceb129,xceb130,xceb131,xceb132
           FROM sourse_ins_tmp

   UPDATE sourse_ins_tmp SET xceb101 =  ''
   
   #170208-00046#1---add---(s)-----
   UPDATE sourse_ins_tmp
      SET sfaasite = (SELECT imag011 FROM imag_t
                       WHERE imagent = g_enterprise AND imagsite = g_xcea_m.xceacomp
                         AND imag001 = xceb004)
   #170208-00046#1---add---(e)-----

   #抓取科目
   IF g_xcea002='11' THEN   #11转入 12转出
      LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                      #" USING (SELECT glcc002,glcc016,glcc011 FROM glcc_t       ", #170221-00041#1 mark
                      " USING (SELECT DISTINCT glcc002,glcc016,glcc011 FROM glcc_t       ", #170221-00041#1 add
                      " WHERE glccent = ",g_enterprise,"  AND glcc001 = '1'  AND glccld  = '",g_xcea_m.xceald,"'
                          AND ( glcc014='",g_xcea_m.xceacomp,"' OR glcc014='*' ) )        ",
                      "    ON ((glcc016=xceb004 OR glcc016 = '*') AND (glcc011=sfaasite OR glcc011='*') ) ",
                      "    WHEN MATCHED THEN                            ",
                      "    UPDATE SET xceb101 = glcc002"
   ELSE
      LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                      #" USING (SELECT glcc006,glcc016,glcc011 FROM glcc_t       ", #170221-00041#1 mark
                      " USING (SELECT DISTINCT glcc006,glcc016,glcc011 FROM glcc_t ", #170221-00041#1 add
                      " WHERE glccent = ",g_enterprise,"  AND glcc001 = '1'  AND glccld  = '",g_xcea_m.xceald,"'
                          AND ( glcc014='",g_xcea_m.xceacomp,"' OR glcc014='*' ) )        ",
                      "    ON ((glcc016=xceb004 OR glcc016 = '*') AND (glcc011=sfaasite OR glcc011='*') ) ",
                      "    WHEN MATCHED THEN                            ",
                      "    UPDATE SET xceb101 = glcc006"
   END IF
   PREPARE axct701_01_111_meg_03 FROM g_sql
   EXECUTE axct701_01_111_meg_03

  #启用交易对象
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad010 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad010 = 'N'  ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb111 = ' '"
   PREPARE axct701_01_11_1_meg_xceb111 FROM g_sql
   EXECUTE axct701_01_11_1_meg_xceb111

  #启用客群
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad011 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad011 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb112 = ' '"
   PREPARE axct701_01_11_1_meg_xceb112 FROM g_sql
   EXECUTE axct701_01_11_1_meg_xceb112

  #启用区域
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad009 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad009 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb113 = ' '"
   PREPARE axct701_01_11_1_meg_xceb113 FROM g_sql
   EXECUTE axct701_01_11_1_meg_xceb113

   
  #启用成本中心
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad008 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad008 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb114 = ' '"
   PREPARE axct701_01_11_1_meg_xceb114 FROM g_sql
   EXECUTE axct701_01_11_1_meg_xceb114
   
  #启用经营类别
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad031 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad031 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb115 = ' '"
   PREPARE axct701_01_11_1_meg_xceb115 FROM g_sql
   EXECUTE axct701_01_11_1_meg_xceb115
 
  #启用渠道
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad032 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad032 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb116 = ' '"
   PREPARE axct701_01_11_1_meg_xceb116 FROM g_sql
   EXECUTE axct701_01_11_1_meg_xceb116

  #启用品类
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad012 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad012 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb117 = ' '"
   PREPARE axct701_01_11_1_meg_xceb117 FROM g_sql
   EXECUTE axct701_01_11_1_meg_xceb117
   
  #启用品牌
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad033 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad033 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb118 = ' '"
   PREPARE axct701_01_11_1_meg_xceb118 FROM g_sql
   EXECUTE axct701_01_11_1_meg_xceb118
 
  #启用项目号
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad015 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad015 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb119 = ' '"
   PREPARE axct701_01_11_1_meg_xceb119 FROM g_sql
   EXECUTE axct701_01_11_1_meg_xceb119
 
  #启用WBS
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad016 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad016 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb120 = ' '"
   PREPARE axct701_01_11_1_meg_xceb120 FROM g_sql
   EXECUTE axct701_01_11_1_meg_xceb120
 
  #启用人员
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad013 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad013 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb107 = ' '"
   PREPARE axct701_01_11_1_meg_xceb107 FROM g_sql
   EXECUTE axct701_01_11_1_meg_xceb107
 
  #启用部门
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad007 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad007 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb108 = ' '"
   PREPARE axct701_01_11_1_meg_xceb108 FROM g_sql
   EXECUTE axct701_01_11_1_meg_xceb108
   
  #启用账款对象
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad027 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad027 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb109 = ' '"
   PREPARE axct701_01_11_1_meg_xceb109 FROM g_sql
   EXECUTE axct701_01_11_1_meg_xceb109
   
  #启用自由核算项1
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad017 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad017 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb121 = ' '"
   PREPARE axct701_01_11_1_meg_xceb121 FROM g_sql
   EXECUTE axct701_01_11_1_meg_xceb121
 
  #启用自由核算项2
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad018 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad018 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb122 = ' '"
   PREPARE axct701_01_11_1_meg_xceb122 FROM g_sql
   EXECUTE axct701_01_11_1_meg_xceb122
 
  #启用自由核算项3
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad019 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad019 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb123 = ' '"
   PREPARE axct701_01_11_1_meg_xceb123 FROM g_sql
   EXECUTE axct701_01_11_1_meg_xceb123

  #启用自由核算项4
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad019 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad019 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb124 = ' '"
   PREPARE axct701_01_11_1_meg_xceb124 FROM g_sql
   EXECUTE axct701_01_11_1_meg_xceb124

  #启用自由核算项5
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad021 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad021 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb125 = ' '"
   PREPARE axct701_01_11_1_meg_xceb125 FROM g_sql
   EXECUTE axct701_01_11_1_meg_xceb125

  #启用自由核算项6
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad022 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad022 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb126 = ' '"
   PREPARE axct701_01_11_1_meg_xceb126 FROM g_sql
   EXECUTE axct701_01_11_1_meg_xceb126

  #启用自由核算项7
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad023 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad023 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb127 = ' '"
   PREPARE axct701_01_11_1_meg_xceb127 FROM g_sql
   EXECUTE axct701_01_11_1_meg_xceb127

  #启用自由核算项8
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad024 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad024 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb128 = ' '"
   PREPARE axct701_01_11_1_meg_xceb128 FROM g_sql
   EXECUTE axct701_01_11_1_meg_xceb128

  #启用自由核算项9
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad025 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad025 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb129 = ' '"
   PREPARE axct701_01_11_1_meg_xceb129 FROM g_sql
   EXECUTE axct701_01_11_1_meg_xceb129

  #启用自由核算项10
   LET g_sql =     " MERGE INTO sourse_ins_tmp                               ",
                   " USING (SELECT glad001,glad026 FROM glad_t       ",
                   " WHERE gladent = ",g_enterprise,
                   "   AND gladld  = '",g_xcea_m.xceald,"' )      ",
                   "    ON ( glad001 = xceb101 AND xceb101 IS NOT NULL AND glad026 = 'N'   ) ",
                   "    WHEN MATCHED THEN                            ",
                   "    UPDATE SET xceb130 = ' '"
   PREPARE axct701_01_11_1_meg_xceb130 FROM g_sql
   EXECUTE axct701_01_11_1_meg_xceb130

  #特性
   UPDATE sourse_ins_tmp SET xceb005 = ' ' WHERE xceb005 IS NULL
 #科目编号
   UPDATE sourse_ins_tmp SET xceb101 = ' ' WHERE xceb101 IS NULL
  #摘要
   UPDATE sourse_ins_tmp SET xceb102 = ' ' WHERE xceb102 IS NULL
  #成本域
   UPDATE sourse_ins_tmp SET xceb103 = ' ' WHERE xceb103 IS NULL
  #原因码
   UPDATE sourse_ins_tmp SET xceb110 = ' ' WHERE xceb110 IS NULL
  #交易对象
   UPDATE sourse_ins_tmp SET xceb111 = ' ' WHERE (xceb111 IS NULL OR xcec101 = ' ')
  #客群
   UPDATE sourse_ins_tmp SET xceb112 = ' ' WHERE (xceb112 IS NULL OR xcec101 = ' ')
  #区域
   UPDATE sourse_ins_tmp SET xceb113 = ' ' WHERE (xceb113 IS NULL OR xcec101 = ' ')
  #成本中心
   UPDATE sourse_ins_tmp SET xceb114 = ' ' WHERE (xceb114 IS NULL OR xcec101 = ' ')
  #经营类别
   UPDATE sourse_ins_tmp SET xceb115 = ' ' WHERE (xceb115 IS NULL OR xcec101 = ' ')
  #渠道
   UPDATE sourse_ins_tmp SET xceb116 = ' ' WHERE (xceb116 IS NULL OR xcec101 = ' ')
  #品类
   UPDATE sourse_ins_tmp SET xceb117 = ' ' WHERE (xceb117 IS NULL OR xcec101 = ' ')
  #品牌
   UPDATE sourse_ins_tmp SET xceb118 = ' ' WHERE (xceb118 IS NULL OR xcec101 = ' ')
  #项目号
   UPDATE sourse_ins_tmp SET xceb119 = ' ' WHERE (xceb119 IS NULL OR xcec101 = ' ')
  #WBS
   UPDATE sourse_ins_tmp SET xceb120 = ' ' WHERE (xceb120 IS NULL OR xcec101 = ' ')
  #人员
   UPDATE sourse_ins_tmp SET xceb107 = ' ' WHERE (xceb107 IS NULL OR xcec101 = ' ')
   #部门
   UPDATE sourse_ins_tmp SET xceb108 = ' ' WHERE (xceb108 IS NULL OR xcec101 = ' ')
  #账款对象
   UPDATE sourse_ins_tmp SET xceb109 = ' ' WHERE (xceb109 IS NULL OR xcec101 = ' ')
  #程序原本逻辑没有给自由核算项赋值,这里就不再判断是否启用核算项了,默认都是' ' ---STR---
#  #自由核算项1
#   UPDATE sourse_ins_tmp SET xceb121 = ' ' WHERE (xceb121 IS NULL OR xcec101 = ' ')
#  #自由核算项2
#   UPDATE sourse_ins_tmp SET xceb122 = ' ' WHERE (xceb122 IS NULL OR xcec101 = ' ')
#  #自由核算项3
#   UPDATE sourse_ins_tmp SET xceb123 = ' ' WHERE (xceb123 IS NULL OR xcec101 = ' ')
#  #自由核算项4
#   UPDATE sourse_ins_tmp SET xceb124 = ' ' WHERE (xceb124 IS NULL OR xcec101 = ' ')
#  #自由核算项5
#   UPDATE sourse_ins_tmp SET xceb125 = ' ' WHERE (xceb125 IS NULL OR xcec101 = ' ')
#  #自由核算项6
#   UPDATE sourse_ins_tmp SET xceb126 = ' ' WHERE (xceb126 IS NULL OR xcec101 = ' ')
#   #自由核算项7
#   UPDATE sourse_ins_tmp SET xceb127 = ' ' WHERE (xceb127 IS NULL OR xcec101 = ' ')
#  #自由核算项8
#   UPDATE sourse_ins_tmp SET xceb128 = ' ' WHERE (xceb128 IS NULL OR xcec101 = ' ')
#  #自由核算项9
#   UPDATE sourse_ins_tmp SET xceb129 = ' ' WHERE (xceb129 IS NULL OR xcec101 = ' ')
#  #自由核算项10
#   UPDATE sourse_ins_tmp SET xceb130 = ' ' WHERE (xceb130 IS NULL OR xcec101 = ' ')
  #程序原本逻辑没有给自由核算项赋值,这里就不再判断是否启用核算项了,默认都是' ' ---END---

   INSERT INTO xcec_t (xcecent,xceccomp,xcecld,xcecdocno,xcecseq,
                       xcec001,xcec002,xcec003,xcec004,xcec005,xcec101,xcec102,xcec103,xcec110,xcec111,
                       xcec112,xcec113,xcec114,xcec115,xcec116,xcec117,xcec118,xcec119,xcec120,xcec201,
                       xcec202,xcec202a,xcec202b,xcec202c,xcec202d,xcec202e,xcec202f,xcec202g,xcec202h,
                       xcec212,xcec212a,xcec212b,xcec212c,xcec212d,xcec212e,xcec212f,xcec212g,xcec212h,
                       xcec222,xcec222a,xcec222b,xcec222c,xcec222d,xcec222e,xcec222f,xcec222g,xcec222h,
                       xcec301,xcec302,xcec107,xcec108,xcec109,xcec121,xcec122,xcec123,xcec124,xcec125,
                       xcec126,xcec127,xcec128,xcec129,xcec130)
         SELECT xcebent,xcebcomp,xcebld,xcebdocno,xcebseq,
                       xceb001,xceb002,xceb003,xceb004,xceb005,xceb101,xceb102,xceb103,xceb110,xceb111,
                       xceb112,xceb113,xceb114,xceb115,xceb116,xceb117,xceb118,xceb119,xceb120,xceb201,
                       xceb202,xceb202a,xceb202b,xceb202c,xceb202d,xceb202e,xceb202f,xceb202g,xceb202h,
                       xceb212,xceb212a,xceb212b,xceb212c,xceb212d,xceb212e,xceb212f,xceb212g,xceb212h,
                       xceb222,xceb222a,xceb222b,xceb222c,xceb222d,xceb222e,xceb222f,xceb222g,xceb222h,
                       xceb301,xceb302,xceb107,xceb108,xceb109,xceb121,xceb122,xceb123,xceb124,xceb125,
                       xceb126,xceb127,xceb128,xceb129,xceb130
           FROM sourse_ins_tmp
 
   RETURN g_success 
#161215-00040#2 Add  ---(E)---   因效能优化,程序逻辑完全重写,旧代码保存在axct701_01_ins_11_bak中
END FUNCTION

################################################################################
# Descriptions...: 不能留空的值给空格
# Memo...........:
# Usage..........: CALL s_aooi150_ins (传入参数)
#                  RETURNING 回传参数
# Input parameter: 传入参数变量1   传入参数变量说明1
#                : 传入参数变量2   传入参数变量说明2
# Return code....: 回传参数变量1   回传参数变量说明1
#                : 回传参数变量2   回传参数变量说明2
# Date & Author..: 日期 By 作者
# Modify.........:
################################################################################
PRIVATE FUNCTION axct701_01_default_space_xceb(p_xceb)
   #161109-00085#19-s mod
   #DEFINE p_xceb          RECORD LIKE xceb_t.*   #161109-00085#19-s mark
   DEFINE p_xceb          RECORD  #成本憑證第一單身檔
          xcebent LIKE xceb_t.xcebent, #企業編號
          xcebcomp LIKE xceb_t.xcebcomp, #法人組織
          xcebld LIKE xceb_t.xcebld, #帳套
          xcebdocno LIKE xceb_t.xcebdocno, #單據編號
          xcebseq LIKE xceb_t.xcebseq, #項次
          xceb001 LIKE xceb_t.xceb001, #參考單據編號
          xceb002 LIKE xceb_t.xceb002, #參考單據項次
          xceb003 LIKE xceb_t.xceb003, #單據類型
          xceb004 LIKE xceb_t.xceb004, #料件編號
          xceb005 LIKE xceb_t.xceb005, #特性
          xceb101 LIKE xceb_t.xceb101, #科目編號
          xceb102 LIKE xceb_t.xceb102, #摘要
          xceb103 LIKE xceb_t.xceb103, #成本域
          xceb110 LIKE xceb_t.xceb110, #原因碼
          xceb111 LIKE xceb_t.xceb111, #收付款客商
          xceb112 LIKE xceb_t.xceb112, #客群
          xceb113 LIKE xceb_t.xceb113, #區域
          xceb114 LIKE xceb_t.xceb114, #成本中心
          xceb115 LIKE xceb_t.xceb115, #經營類別
          xceb116 LIKE xceb_t.xceb116, #通路
          xceb117 LIKE xceb_t.xceb117, #品類
          xceb118 LIKE xceb_t.xceb118, #品牌
          xceb119 LIKE xceb_t.xceb119, #專案號
          xceb120 LIKE xceb_t.xceb120, #WBS
          xceb201 LIKE xceb_t.xceb201, #數量
          xceb202 LIKE xceb_t.xceb202, #成本金額(本位幣一)
          xceb202a LIKE xceb_t.xceb202a, #成本-材料(本位幣一)
          xceb202b LIKE xceb_t.xceb202b, #成本-人工(本位幣一)
          xceb202c LIKE xceb_t.xceb202c, #成本-加工(本位幣一)
          xceb202d LIKE xceb_t.xceb202d, #成本-制費一(本位幣一)
          xceb202e LIKE xceb_t.xceb202e, #成本-制費二(本位幣一)
          xceb202f LIKE xceb_t.xceb202f, #成本-制費三(本位幣一)
          xceb202g LIKE xceb_t.xceb202g, #成本-制費四(本位幣一)
          xceb202h LIKE xceb_t.xceb202h, #成本-制費五(本位幣一)
          xceb212 LIKE xceb_t.xceb212, #成本金額(本位幣二)
          xceb212a LIKE xceb_t.xceb212a, #成本-材料(本位幣二)
          xceb212b LIKE xceb_t.xceb212b, #成本-人工(本位幣二)
          xceb212c LIKE xceb_t.xceb212c, #成本-加工(本位幣二)
          xceb212d LIKE xceb_t.xceb212d, #成本-制費一(本位幣二)
          xceb212e LIKE xceb_t.xceb212e, #成本-制費二(本位幣二)
          xceb212f LIKE xceb_t.xceb212f, #成本-制費三(本位幣二)
          xceb212g LIKE xceb_t.xceb212g, #成本-制費四(本位幣二)
          xceb212h LIKE xceb_t.xceb212h, #成本-制費五(本位幣二)
          xceb222 LIKE xceb_t.xceb222, #成本金額(本位幣三)
          xceb222a LIKE xceb_t.xceb222a, #成本-材料(本位幣三)
          xceb222b LIKE xceb_t.xceb222b, #成本-人工(本位幣三)
          xceb222c LIKE xceb_t.xceb222c, #成本-加工(本位幣三)
          xceb222d LIKE xceb_t.xceb222d, #成本-制費一(本位幣三)
          xceb222e LIKE xceb_t.xceb222e, #成本-制費二(本位幣三)
          xceb222f LIKE xceb_t.xceb222f, #成本-制費三(本位幣三)
          xceb222g LIKE xceb_t.xceb222g, #成本-制費四(本位幣三)
          xceb222h LIKE xceb_t.xceb222h, #成本-制費五(本位幣三)
          xceb301 LIKE xceb_t.xceb301, #憑證編號
          xceb302 LIKE xceb_t.xceb302, #憑證項次
          #161109-00085#63 --s add  
          xcebud001 LIKE xceb_t.xcebud001, #自定義欄位(文字)001
          xcebud002 LIKE xceb_t.xcebud002, #自定義欄位(文字)002
          xcebud003 LIKE xceb_t.xcebud003, #自定義欄位(文字)003
          xcebud004 LIKE xceb_t.xcebud004, #自定義欄位(文字)004
          xcebud005 LIKE xceb_t.xcebud005, #自定義欄位(文字)005
          xcebud006 LIKE xceb_t.xcebud006, #自定義欄位(文字)006
          xcebud007 LIKE xceb_t.xcebud007, #自定義欄位(文字)007
          xcebud008 LIKE xceb_t.xcebud008, #自定義欄位(文字)008
          xcebud009 LIKE xceb_t.xcebud009, #自定義欄位(文字)009
          xcebud010 LIKE xceb_t.xcebud010, #自定義欄位(文字)010
          xcebud011 LIKE xceb_t.xcebud011, #自定義欄位(數字)011
          xcebud012 LIKE xceb_t.xcebud012, #自定義欄位(數字)012
          xcebud013 LIKE xceb_t.xcebud013, #自定義欄位(數字)013
          xcebud014 LIKE xceb_t.xcebud014, #自定義欄位(數字)014
          xcebud015 LIKE xceb_t.xcebud015, #自定義欄位(數字)015
          xcebud016 LIKE xceb_t.xcebud016, #自定義欄位(數字)016
          xcebud017 LIKE xceb_t.xcebud017, #自定義欄位(數字)017
          xcebud018 LIKE xceb_t.xcebud018, #自定義欄位(數字)018
          xcebud019 LIKE xceb_t.xcebud019, #自定義欄位(數字)019
          xcebud020 LIKE xceb_t.xcebud020, #自定義欄位(數字)020
          xcebud021 LIKE xceb_t.xcebud021, #自定義欄位(日期時間)021
          xcebud022 LIKE xceb_t.xcebud022, #自定義欄位(日期時間)022
          xcebud023 LIKE xceb_t.xcebud023, #自定義欄位(日期時間)023
          xcebud024 LIKE xceb_t.xcebud024, #自定義欄位(日期時間)024
          xcebud025 LIKE xceb_t.xcebud025, #自定義欄位(日期時間)025
          xcebud026 LIKE xceb_t.xcebud026, #自定義欄位(日期時間)026
          xcebud027 LIKE xceb_t.xcebud027, #自定義欄位(日期時間)027
          xcebud028 LIKE xceb_t.xcebud028, #自定義欄位(日期時間)028
          xcebud029 LIKE xceb_t.xcebud029, #自定義欄位(日期時間)029
          xcebud030 LIKE xceb_t.xcebud030, #自定義欄位(日期時間)030
          #161109-00085#63 --e add
          xceb107 LIKE xceb_t.xceb107, #人員
          xceb108 LIKE xceb_t.xceb108, #部門
          xceb109 LIKE xceb_t.xceb109, #帳款對象
          xceb121 LIKE xceb_t.xceb121, #自由核算項1
          xceb122 LIKE xceb_t.xceb122, #自由核算項2
          xceb123 LIKE xceb_t.xceb123, #自由核算項3
          xceb124 LIKE xceb_t.xceb124, #自由核算項4
          xceb125 LIKE xceb_t.xceb125, #自由核算項5
          xceb126 LIKE xceb_t.xceb126, #自由核算項6
          xceb127 LIKE xceb_t.xceb127, #自由核算項7
          xceb128 LIKE xceb_t.xceb128, #自由核算項8
          xceb129 LIKE xceb_t.xceb129, #自由核算項9
          xceb130 LIKE xceb_t.xceb130, #自由核算項10
          xceb131 LIKE xceb_t.xceb131, #單據類型(for 流通)
          xceb132 LIKE xceb_t.xceb132  #單據日期(for 流通)
             END RECORD
   #161109-00085#19-e mod
   #161109-00085#19-s mod
#   DEFINE l_glad     RECORD LIKE glad_t.*    #wujie 150214   #161109-00085#19-s mark
   DEFINE l_glad     RECORD  #帳套科目管理設定檔
       gladent LIKE glad_t.gladent, #企業編號               
       gladownid LIKE glad_t.gladownid, #資料所有者
       gladowndp LIKE glad_t.gladowndp, #資料所屬部門
       gladcrtid LIKE glad_t.gladcrtid, #資料建立者
       gladcrtdp LIKE glad_t.gladcrtdp, #資料建立部門
       gladcrtdt LIKE glad_t.gladcrtdt, #資料創建日
       gladmodid LIKE glad_t.gladmodid, #資料修改者
       gladmoddt LIKE glad_t.gladmoddt, #最近修改日
       gladstus LIKE glad_t.gladstus, #狀態碼
       gladld LIKE glad_t.gladld, #帳套
       glad001 LIKE glad_t.glad001, #會計科目編號
       glad002 LIKE glad_t.glad002, #是否按餘額類型產生分錄
       glad003 LIKE glad_t.glad003, #啟用傳票項次細項立沖
       glad004 LIKE glad_t.glad004, #傳票項次異動別
       glad005 LIKE glad_t.glad005, #是否啟用數量金額式
       glad006 LIKE glad_t.glad006, #借方現金變動碼
       glad007 LIKE glad_t.glad007, #啟用部門管理
       glad008 LIKE glad_t.glad008, #啟用利潤成本管理
       glad009 LIKE glad_t.glad009, #啟用區域管理
       glad010 LIKE glad_t.glad010, #啟用收付款客商管理
       glad011 LIKE glad_t.glad011, #啟用客群管理
       glad012 LIKE glad_t.glad012, #啟用產品類別管理
       glad013 LIKE glad_t.glad013, #啟用人員管理
       glad014 LIKE glad_t.glad014, #no use
       glad015 LIKE glad_t.glad015, #啟用專案管理
       glad016 LIKE glad_t.glad016, #啟用WBS管理
       glad017 LIKE glad_t.glad017, #啟用自由核算項一
       glad0171 LIKE glad_t.glad0171, #自由核算項一類型編號
       glad0172 LIKE glad_t.glad0172, #自由核算項一控制方式
       glad018 LIKE glad_t.glad018, #啟用自由核算項二
       glad0181 LIKE glad_t.glad0181, #自由核算項二類型編號
       glad0182 LIKE glad_t.glad0182, #自由核算項二控制方式
       glad019 LIKE glad_t.glad019, #啟用自由核算項三
       glad0191 LIKE glad_t.glad0191, #自由核算項三類型編號
       glad0192 LIKE glad_t.glad0192, #自由核算項三控制方式
       glad020 LIKE glad_t.glad020, #啟用自由核算項四
       glad0201 LIKE glad_t.glad0201, #自由核算項四類型編號
       glad0202 LIKE glad_t.glad0202, #自由核算項四控制方式
       glad021 LIKE glad_t.glad021, #啟用自由核算項五
       glad0211 LIKE glad_t.glad0211, #自由核算項五類型編號
       glad0212 LIKE glad_t.glad0212, #自由核算項五控制方式
       glad022 LIKE glad_t.glad022, #啟用自由核算項六
       glad0221 LIKE glad_t.glad0221, #自由核算項六類型編號
       glad0222 LIKE glad_t.glad0222, #自由核算項六控制方式
       glad023 LIKE glad_t.glad023, #啟用自由核算項七
       glad0231 LIKE glad_t.glad0231, #自由核算項七類型編號
       glad0232 LIKE glad_t.glad0232, #自由核算項七控制方式
       glad024 LIKE glad_t.glad024, #啟用自由核算項八
       glad0241 LIKE glad_t.glad0241, #自由核算項八類型編號
       glad0242 LIKE glad_t.glad0242, #自由核算項八控制方式
       glad025 LIKE glad_t.glad025, #啟用自由核算項九
       glad0251 LIKE glad_t.glad0251, #自由核算項九類型編號
       glad0252 LIKE glad_t.glad0252, #自由核算項九控制方式
       glad026 LIKE glad_t.glad026, #啟用自由核算項十
       glad0261 LIKE glad_t.glad0261, #自由核算項十類型編號
       glad0262 LIKE glad_t.glad0262, #自由核算項十控制方式
       glad027 LIKE glad_t.glad027, #啟用帳款客商管理
       glad030 LIKE glad_t.glad030, #是否進行預算管控
       glad031 LIKE glad_t.glad031, #啟用經營方式管理
       glad032 LIKE glad_t.glad032, #啟用通路管理
       glad033 LIKE glad_t.glad033, #啟用品牌管理
       glad034 LIKE glad_t.glad034, #科目做多幣別管理
       #161109-00085#63 --s add     
       gladud001 LIKE glad_t.gladud001, #自定義欄位(文字)001
       gladud002 LIKE glad_t.gladud002, #自定義欄位(文字)002
       gladud003 LIKE glad_t.gladud003, #自定義欄位(文字)003
       gladud004 LIKE glad_t.gladud004, #自定義欄位(文字)004
       gladud005 LIKE glad_t.gladud005, #自定義欄位(文字)005
       gladud006 LIKE glad_t.gladud006, #自定義欄位(文字)006
       gladud007 LIKE glad_t.gladud007, #自定義欄位(文字)007
       gladud008 LIKE glad_t.gladud008, #自定義欄位(文字)008
       gladud009 LIKE glad_t.gladud009, #自定義欄位(文字)009
       gladud010 LIKE glad_t.gladud010, #自定義欄位(文字)010
       gladud011 LIKE glad_t.gladud011, #自定義欄位(數字)011
       gladud012 LIKE glad_t.gladud012, #自定義欄位(數字)012
       gladud013 LIKE glad_t.gladud013, #自定義欄位(數字)013
       gladud014 LIKE glad_t.gladud014, #自定義欄位(數字)014
       gladud015 LIKE glad_t.gladud015, #自定義欄位(數字)015
       gladud016 LIKE glad_t.gladud016, #自定義欄位(數字)016
       gladud017 LIKE glad_t.gladud017, #自定義欄位(數字)017
       gladud018 LIKE glad_t.gladud018, #自定義欄位(數字)018
       gladud019 LIKE glad_t.gladud019, #自定義欄位(數字)019
       gladud020 LIKE glad_t.gladud020, #自定義欄位(數字)020
       gladud021 LIKE glad_t.gladud021, #自定義欄位(日期時間)021
       gladud022 LIKE glad_t.gladud022, #自定義欄位(日期時間)022
       gladud023 LIKE glad_t.gladud023, #自定義欄位(日期時間)023
       gladud024 LIKE glad_t.gladud024, #自定義欄位(日期時間)024
       gladud025 LIKE glad_t.gladud025, #自定義欄位(日期時間)025
       gladud026 LIKE glad_t.gladud026, #自定義欄位(日期時間)026
       gladud027 LIKE glad_t.gladud027, #自定義欄位(日期時間)027
       gladud028 LIKE glad_t.gladud028, #自定義欄位(日期時間)028
       gladud029 LIKE glad_t.gladud029, #自定義欄位(日期時間)029
       gladud030 LIKE glad_t.gladud030, #自定義欄位(日期時間)030
       #161109-00085#63 --e add
       glad035 LIKE glad_t.glad035, #是否是子系統科目
       glad036 LIKE glad_t.glad036  #貸方現金變動碼
          END RECORD
   #161109-00085#19-e mod
   
   IF p_xceb.xceb005 IS NULL THEN LET p_xceb.xceb005 = ' ' END IF 	#特性
   IF p_xceb.xceb101 IS NULL THEN LET p_xceb.xceb101 = ' ' END IF 	#科目编号
   IF p_xceb.xceb102 IS NULL THEN LET p_xceb.xceb102 = ' ' END IF 	#摘要
   IF p_xceb.xceb103 IS NULL THEN LET p_xceb.xceb103 = ' ' END IF 	#成本域
   IF p_xceb.xceb110 IS NULL THEN LET p_xceb.xceb110 = ' ' END IF 	#原因码
   IF p_xceb.xceb111 IS NULL THEN LET p_xceb.xceb111 = ' ' END IF 	#交易对象
   IF p_xceb.xceb112 IS NULL THEN LET p_xceb.xceb112 = ' ' END IF 	#客群
   IF p_xceb.xceb113 IS NULL THEN LET p_xceb.xceb113 = ' ' END IF 	#区域
   IF p_xceb.xceb114 IS NULL THEN LET p_xceb.xceb114 = ' ' END IF 	#成本中心
   IF p_xceb.xceb115 IS NULL THEN LET p_xceb.xceb115 = ' ' END IF 	#经营类别
   IF p_xceb.xceb116 IS NULL THEN LET p_xceb.xceb116 = ' ' END IF 	#渠道
   IF p_xceb.xceb117 IS NULL THEN LET p_xceb.xceb117 = ' ' END IF 	#品类
   IF p_xceb.xceb118 IS NULL THEN LET p_xceb.xceb118 = ' ' END IF 	#品牌
   IF p_xceb.xceb119 IS NULL THEN LET p_xceb.xceb119 = ' ' END IF 	#项目号
   IF p_xceb.xceb120 IS NULL THEN LET p_xceb.xceb120 = ' ' END IF 	#WBS
   IF p_xceb.xceb107	IS NULL THEN LET p_xceb.xceb107 = ' ' END IF  #人员
   IF p_xceb.xceb108	IS NULL THEN LET p_xceb.xceb108 = ' ' END IF  #部门
   IF p_xceb.xceb109	IS NULL THEN LET p_xceb.xceb109 = ' ' END IF  #账款对象
   IF p_xceb.xceb121	IS NULL THEN LET p_xceb.xceb121 = ' ' END IF  #自由核算项1
   IF p_xceb.xceb122	IS NULL THEN LET p_xceb.xceb122 = ' ' END IF  #自由核算项2
   IF p_xceb.xceb123	IS NULL THEN LET p_xceb.xceb123 = ' ' END IF  #自由核算项3
   IF p_xceb.xceb124	IS NULL THEN LET p_xceb.xceb124 = ' ' END IF  #自由核算项4
   IF p_xceb.xceb125	IS NULL THEN LET p_xceb.xceb125 = ' ' END IF  #自由核算项5
   IF p_xceb.xceb126	IS NULL THEN LET p_xceb.xceb126 = ' ' END IF  #自由核算项6
   IF p_xceb.xceb127	IS NULL THEN LET p_xceb.xceb127 = ' ' END IF  #自由核算项7
   IF p_xceb.xceb128	IS NULL THEN LET p_xceb.xceb128 = ' ' END IF  #自由核算项8
   IF p_xceb.xceb129	IS NULL THEN LET p_xceb.xceb129 = ' ' END IF  #自由核算项9
   IF p_xceb.xceb130	IS NULL THEN LET p_xceb.xceb130 = ' ' END IF  #自由核算项10
 
   INITIALIZE l_glad.* TO NULL
   #160607-00026#1-s-mark 
   #SELECT * INTO l_glad.* FROM glad_t
   # WHERE gladent = p_xceb.xcebent
   #   AND gladld  = p_xceb.xcebld
   #   AND glad001 = p_xceb.xceb101
   #160607-00026#1-e-mark
   
   #160607-00026#1-s-add
   #EXECUTE axct701_01_glad_prep USING p_xceb.xcebld,p_xceb.xceb101 INTO l_glad.*   #161109-00085#63 mark
   #161109-00085#63 --s add   
   EXECUTE axct701_01_glad_prep USING p_xceb.xcebld,p_xceb.xceb101
   INTO l_glad.gladent,l_glad.gladownid,l_glad.gladowndp,l_glad.gladcrtid,l_glad.gladcrtdp,
        l_glad.gladcrtdt,l_glad.gladmodid,l_glad.gladmoddt,l_glad.gladstus,l_glad.gladld,
        l_glad.glad001,l_glad.glad002,l_glad.glad003,l_glad.glad004,l_glad.glad005,
        l_glad.glad006,l_glad.glad007,l_glad.glad008,l_glad.glad009,l_glad.glad010,
        l_glad.glad011,l_glad.glad012,l_glad.glad013,l_glad.glad014,l_glad.glad015,
        l_glad.glad016,l_glad.glad017,l_glad.glad0171,l_glad.glad0172,l_glad.glad018,
        l_glad.glad0181,l_glad.glad0182,l_glad.glad019,l_glad.glad0191,l_glad.glad0192,
        l_glad.glad020,l_glad.glad0201,l_glad.glad0202,l_glad.glad021,l_glad.glad0211,
        l_glad.glad0212,l_glad.glad022,l_glad.glad0221,l_glad.glad0222,l_glad.glad023,
        l_glad.glad0231,l_glad.glad0232,l_glad.glad024,l_glad.glad0241,l_glad.glad0242,
        l_glad.glad025,l_glad.glad0251,l_glad.glad0252,l_glad.glad026,l_glad.glad0261,
        l_glad.glad0262,l_glad.glad027,l_glad.glad030,l_glad.glad031,l_glad.glad032,
        l_glad.glad033,l_glad.glad034,l_glad.gladud001,l_glad.gladud002,l_glad.gladud003,
        l_glad.gladud004,l_glad.gladud005,l_glad.gladud006,l_glad.gladud007,l_glad.gladud008,
        l_glad.gladud009,l_glad.gladud010,l_glad.gladud011,l_glad.gladud012,l_glad.gladud013,
        l_glad.gladud014,l_glad.gladud015,l_glad.gladud016,l_glad.gladud017,l_glad.gladud018,
        l_glad.gladud019,l_glad.gladud020,l_glad.gladud021,l_glad.gladud022,l_glad.gladud023,
        l_glad.gladud024,l_glad.gladud025,l_glad.gladud026,l_glad.gladud027,l_glad.gladud028,
        l_glad.gladud029,l_glad.gladud030,l_glad.glad035,l_glad.glad036    
   #161109-00085#63 --e add        
   #160607-00026#1-e-add
   IF l_glad.glad010 = 'N' THEN   #启用交易对象
      LET p_xceb.xceb111 = ' '
   END IF
   
   IF l_glad.glad011 = 'N' THEN   #启用客群
      LET p_xceb.xceb112 = ' '
   END IF

   IF l_glad.glad009 = 'N' THEN   #启用区域
      LET p_xceb.xceb113 = ' '
   END IF
   
   IF l_glad.glad008 = 'N' THEN   #启用成本中心
      LET p_xceb.xceb114 = ' '
   END IF
   
   IF l_glad.glad031 = 'N' THEN   #启用经营类别
      LET p_xceb.xceb115 = ' '
   END IF
 
   IF l_glad.glad032 = 'N' THEN   #启用渠道
      LET p_xceb.xceb116 = ' '
   END IF

   IF l_glad.glad012 = 'N' THEN   #启用品类
      LET p_xceb.xceb117 = ' '
   END IF
   
   IF l_glad.glad033 = 'N' THEN   #启用品牌
      LET p_xceb.xceb118 = ' '
   END IF
 
   IF l_glad.glad015 = 'N' THEN   #启用项目号
      LET p_xceb.xceb119 = ' '
   END IF
 
   IF l_glad.glad016 = 'N' THEN   #启用WBS
      LET p_xceb.xceb120 = ' '
   END IF
 
   IF l_glad.glad013 = 'N' THEN   #启用人员
      LET p_xceb.xceb107 = ' '
   END IF
 
   IF l_glad.glad007 = 'N' THEN   #启用部门
      LET p_xceb.xceb108 = ' '
   END IF
   
   IF l_glad.glad027 = 'N' THEN   #启用账款对象
      LET p_xceb.xceb109 = ' '
   END IF
   
   IF l_glad.glad017 = 'N' THEN   #启用自由核算项1
      LET p_xceb.xceb121 = ' '
   END IF
 
   IF l_glad.glad018 = 'N' THEN   #启用自由核算项2
      LET p_xceb.xceb122 = ' '
   END IF
 
   IF l_glad.glad019 = 'N' THEN   #启用自由核算项3
      LET p_xceb.xceb123 = ' '
   END IF

   IF l_glad.glad020 = 'N' THEN   #启用自由核算项4
      LET p_xceb.xceb124 = ' '
   END IF

   IF l_glad.glad021 = 'N' THEN   #启用自由核算项5
      LET p_xceb.xceb125 = ' '
   END IF

   IF l_glad.glad022 = 'N' THEN   #启用自由核算项6
      LET p_xceb.xceb126 = ' '
   END IF

   IF l_glad.glad023 = 'N' THEN   #启用自由核算项7
      LET p_xceb.xceb127 = ' '
   END IF

   IF l_glad.glad024 = 'N' THEN   #启用自由核算项8
      LET p_xceb.xceb128 = ' '
   END IF

   IF l_glad.glad025 = 'N' THEN   #启用自由核算项9
      LET p_xceb.xceb129 = ' '
   END IF

   IF l_glad.glad026 = 'N' THEN   #启用自由核算项10
      LET p_xceb.xceb130 = ' '
   END IF
  
  #160701-00012#2-s-mark #整批產生直接從xcck資料帶出，不需多加此判斷，故此段mark
  #IF cl_null(p_xceb.xceb101) THEN
  #   LET p_xceb.xceb111 = ' '  	#交易对象
  #   LET p_xceb.xceb112 = ' '  	#客群
  #   LET p_xceb.xceb113 = ' '  	#区域
  #   LET p_xceb.xceb114 = ' '  	#成本中心
  #   LET p_xceb.xceb115 = ' '  	#经营类别
  #   LET p_xceb.xceb116 = ' '  	#渠道
  #   LET p_xceb.xceb117 = ' '  	#品类
  #   LET p_xceb.xceb118 = ' '  	#品牌
  #   LET p_xceb.xceb119 = ' '  	#项目号
  #   LET p_xceb.xceb120 = ' '  	#WBS
  #   LET p_xceb.xceb107 = ' '   #人员
  #   LET p_xceb.xceb108 = ' '   #部门
  #   LET p_xceb.xceb109 = ' '   #账款对象
  #   LET p_xceb.xceb121 = ' '   #自由核算项1
  #   LET p_xceb.xceb122 = ' '   #自由核算项2
  #   LET p_xceb.xceb123 = ' '   #自由核算项3
  #   LET p_xceb.xceb124 = ' '   #自由核算项4
  #   LET p_xceb.xceb125 = ' '   #自由核算项5
  #   LET p_xceb.xceb126 = ' '   #自由核算项6
  #   LET p_xceb.xceb127 = ' '   #自由核算项7
  #   LET p_xceb.xceb128 = ' '   #自由核算项8
  #   LET p_xceb.xceb129 = ' '   #自由核算项9
  #   LET p_xceb.xceb130 = ' '   #自由核算项10
  #END IF
  #160701-00012#2-e-mark 
   RETURN p_xceb.xceb005,
          p_xceb.xceb101,
          p_xceb.xceb102,
          p_xceb.xceb103,
          p_xceb.xceb110,
          p_xceb.xceb111,
          p_xceb.xceb112,
          p_xceb.xceb113,
          p_xceb.xceb114,
          p_xceb.xceb115,
          p_xceb.xceb116,
          p_xceb.xceb117,
          p_xceb.xceb118,
          p_xceb.xceb119,
          p_xceb.xceb120,
          p_xceb.xceb107,
          p_xceb.xceb108,
          p_xceb.xceb109,
          p_xceb.xceb121,
          p_xceb.xceb122,
          p_xceb.xceb123,
          p_xceb.xceb124,
          p_xceb.xceb125,
          p_xceb.xceb126,
          p_xceb.xceb127,
          p_xceb.xceb128,
          p_xceb.xceb129,
          p_xceb.xceb130
END FUNCTION

################################################################################
# Descriptions...: 描述说明
# Memo...........:
# Usage..........: CALL s_aooi150_ins (传入参数)
#                  RETURNING 回传参数
# Input parameter: 传入参数变量1   传入参数变量说明1
#                : 传入参数变量2   传入参数变量说明2
# Return code....: 回传参数变量1   回传参数变量说明1
#                : 回传参数变量2   回传参数变量说明2
# Date & Author..: 日期 By 作者
# Modify.........:
################################################################################
PRIVATE FUNCTION axct701_01_default_space_xcec(p_xcec)
   #161109-00085#19-s mod
#   DEFINE p_xcec     RECORD LIKE xcec_t.*   #161109-00085#19-s mark
   DEFINE p_xcec     RECORD  #成本憑證第二單身檔
       xcecent LIKE xcec_t.xcecent, #企業編號
       xceccomp LIKE xcec_t.xceccomp, #法人組織
       xcecld LIKE xcec_t.xcecld, #帳套
       xcecdocno LIKE xcec_t.xcecdocno, #單據編號
       xcecseq LIKE xcec_t.xcecseq, #項次
       xcec001 LIKE xcec_t.xcec001, #參考單據
       xcec002 LIKE xcec_t.xcec002, #參考單據項次
       xcec003 LIKE xcec_t.xcec003, #單據類型
       xcec004 LIKE xcec_t.xcec004, #料件編號
       xcec005 LIKE xcec_t.xcec005, #特性
       xcec101 LIKE xcec_t.xcec101, #科目編號
       xcec102 LIKE xcec_t.xcec102, #摘要
       xcec103 LIKE xcec_t.xcec103, #成本域
       xcec110 LIKE xcec_t.xcec110, #原因碼
       xcec111 LIKE xcec_t.xcec111, #收付款客商
       xcec112 LIKE xcec_t.xcec112, #客群
       xcec113 LIKE xcec_t.xcec113, #區域
       xcec114 LIKE xcec_t.xcec114, #成本中心
       xcec115 LIKE xcec_t.xcec115, #經營類別
       xcec116 LIKE xcec_t.xcec116, #通路
       xcec117 LIKE xcec_t.xcec117, #品類
       xcec118 LIKE xcec_t.xcec118, #品牌
       xcec119 LIKE xcec_t.xcec119, #專案號
       xcec120 LIKE xcec_t.xcec120, #WBS
       xcec201 LIKE xcec_t.xcec201, #數量
       xcec202 LIKE xcec_t.xcec202, #成本金額(本位幣一)
       xcec202a LIKE xcec_t.xcec202a, #成本-材料(本位幣一)
       xcec202b LIKE xcec_t.xcec202b, #成本-人工(本位幣一)
       xcec202c LIKE xcec_t.xcec202c, #成本-加工(本位幣一)
       xcec202d LIKE xcec_t.xcec202d, #成本-制費一(本位幣一)
       xcec202e LIKE xcec_t.xcec202e, #成本-制費二(本位幣一)
       xcec202f LIKE xcec_t.xcec202f, #成本-制費三(本位幣一)
       xcec202g LIKE xcec_t.xcec202g, #成本-制費四(本位幣一)
       xcec202h LIKE xcec_t.xcec202h, #成本-制費五(本位幣一)
       xcec212 LIKE xcec_t.xcec212, #成本-金額(本位幣二)
       xcec212a LIKE xcec_t.xcec212a, #成本-材料(本位幣二)
       xcec212b LIKE xcec_t.xcec212b, #成本-人工(本位幣二)
       xcec212c LIKE xcec_t.xcec212c, #成本-加工(本位幣二)
       xcec212d LIKE xcec_t.xcec212d, #成本-制費一(本位幣二)
       xcec212e LIKE xcec_t.xcec212e, #成本-制費二(本位幣二)
       xcec212f LIKE xcec_t.xcec212f, #成本-制費三(本位幣二)
       xcec212g LIKE xcec_t.xcec212g, #成本-制費四(本位幣二)
       xcec212h LIKE xcec_t.xcec212h, #成本-制費五(本位幣二)
       xcec222 LIKE xcec_t.xcec222, #成本-金額(本位幣三)
       xcec222a LIKE xcec_t.xcec222a, #成本-材料(本位幣三)
       xcec222b LIKE xcec_t.xcec222b, #成本-人工(本位幣三)
       xcec222c LIKE xcec_t.xcec222c, #成本-加工(本位幣三)
       xcec222d LIKE xcec_t.xcec222d, #成本-制費一(本位幣三)
       xcec222e LIKE xcec_t.xcec222e, #成本-制費二(本位幣三)
       xcec222f LIKE xcec_t.xcec222f, #成本-制費三(本位幣三)
       xcec222g LIKE xcec_t.xcec222g, #成本-制費四(本位幣三)
       xcec222h LIKE xcec_t.xcec222h, #成本-制費五(本位幣三)
       xcec301 LIKE xcec_t.xcec301, #憑證編號
       xcec302 LIKE xcec_t.xcec302, #憑證項次
       #161109-00085#63 --s add 
       xcecud001 LIKE xcec_t.xcecud001, #自定義欄位(文字)001
       xcecud002 LIKE xcec_t.xcecud002, #自定義欄位(文字)002
       xcecud003 LIKE xcec_t.xcecud003, #自定義欄位(文字)003
       xcecud004 LIKE xcec_t.xcecud004, #自定義欄位(文字)004
       xcecud005 LIKE xcec_t.xcecud005, #自定義欄位(文字)005
       xcecud006 LIKE xcec_t.xcecud006, #自定義欄位(文字)006
       xcecud007 LIKE xcec_t.xcecud007, #自定義欄位(文字)007
       xcecud008 LIKE xcec_t.xcecud008, #自定義欄位(文字)008
       xcecud009 LIKE xcec_t.xcecud009, #自定義欄位(文字)009
       xcecud010 LIKE xcec_t.xcecud010, #自定義欄位(文字)010
       xcecud011 LIKE xcec_t.xcecud011, #自定義欄位(數字)011
       xcecud012 LIKE xcec_t.xcecud012, #自定義欄位(數字)012
       xcecud013 LIKE xcec_t.xcecud013, #自定義欄位(數字)013
       xcecud014 LIKE xcec_t.xcecud014, #自定義欄位(數字)014
       xcecud015 LIKE xcec_t.xcecud015, #自定義欄位(數字)015
       xcecud016 LIKE xcec_t.xcecud016, #自定義欄位(數字)016
       xcecud017 LIKE xcec_t.xcecud017, #自定義欄位(數字)017
       xcecud018 LIKE xcec_t.xcecud018, #自定義欄位(數字)018
       xcecud019 LIKE xcec_t.xcecud019, #自定義欄位(數字)019
       xcecud020 LIKE xcec_t.xcecud020, #自定義欄位(數字)020
       xcecud021 LIKE xcec_t.xcecud021, #自定義欄位(日期時間)021
       xcecud022 LIKE xcec_t.xcecud022, #自定義欄位(日期時間)022
       xcecud023 LIKE xcec_t.xcecud023, #自定義欄位(日期時間)023
       xcecud024 LIKE xcec_t.xcecud024, #自定義欄位(日期時間)024
       xcecud025 LIKE xcec_t.xcecud025, #自定義欄位(日期時間)025
       xcecud026 LIKE xcec_t.xcecud026, #自定義欄位(日期時間)026
       xcecud027 LIKE xcec_t.xcecud027, #自定義欄位(日期時間)027
       xcecud028 LIKE xcec_t.xcecud028, #自定義欄位(日期時間)028
       xcecud029 LIKE xcec_t.xcecud029, #自定義欄位(日期時間)029
       xcecud030 LIKE xcec_t.xcecud030, #自定義欄位(日期時間)030
       #161109-00085#63 --e add
       xcec107 LIKE xcec_t.xcec107, #人員
       xcec108 LIKE xcec_t.xcec108, #部門
       xcec109 LIKE xcec_t.xcec109, #帳款對象
       xcec121 LIKE xcec_t.xcec121, #自由核算項1
       xcec122 LIKE xcec_t.xcec122, #自由核算項2
       xcec123 LIKE xcec_t.xcec123, #自由核算項3
       xcec124 LIKE xcec_t.xcec124, #自由核算項4
       xcec125 LIKE xcec_t.xcec125, #自由核算項5
       xcec126 LIKE xcec_t.xcec126, #自由核算項6
       xcec127 LIKE xcec_t.xcec127, #自由核算項7
       xcec128 LIKE xcec_t.xcec128, #自由核算項8
       xcec129 LIKE xcec_t.xcec129, #自由核算項9
       xcec130 LIKE xcec_t.xcec130  #自由核算項10
               END RECORD
   #161109-00085#19-e mod
   #161109-00085#19-s mod
#   DEFINE l_glad     RECORD LIKE glad_t.*    #wujie 150214   #161109-00085#19-s mark
   DEFINE l_glad     RECORD  #帳套科目管理設定檔
       gladent LIKE glad_t.gladent, #企業編號
       gladownid LIKE glad_t.gladownid, #資料所有者
       gladowndp LIKE glad_t.gladowndp, #資料所屬部門
       gladcrtid LIKE glad_t.gladcrtid, #資料建立者
       gladcrtdp LIKE glad_t.gladcrtdp, #資料建立部門
       gladcrtdt LIKE glad_t.gladcrtdt, #資料創建日
       gladmodid LIKE glad_t.gladmodid, #資料修改者
       gladmoddt LIKE glad_t.gladmoddt, #最近修改日
       gladstus LIKE glad_t.gladstus, #狀態碼
       gladld LIKE glad_t.gladld, #帳套
       glad001 LIKE glad_t.glad001, #會計科目編號
       glad002 LIKE glad_t.glad002, #是否按餘額類型產生分錄
       glad003 LIKE glad_t.glad003, #啟用傳票項次細項立沖
       glad004 LIKE glad_t.glad004, #傳票項次異動別
       glad005 LIKE glad_t.glad005, #是否啟用數量金額式
       glad006 LIKE glad_t.glad006, #借方現金變動碼
       glad007 LIKE glad_t.glad007, #啟用部門管理
       glad008 LIKE glad_t.glad008, #啟用利潤成本管理
       glad009 LIKE glad_t.glad009, #啟用區域管理
       glad010 LIKE glad_t.glad010, #啟用收付款客商管理
       glad011 LIKE glad_t.glad011, #啟用客群管理
       glad012 LIKE glad_t.glad012, #啟用產品類別管理
       glad013 LIKE glad_t.glad013, #啟用人員管理
       glad014 LIKE glad_t.glad014, #no use
       glad015 LIKE glad_t.glad015, #啟用專案管理
       glad016 LIKE glad_t.glad016, #啟用WBS管理
       glad017 LIKE glad_t.glad017, #啟用自由核算項一
       glad0171 LIKE glad_t.glad0171, #自由核算項一類型編號
       glad0172 LIKE glad_t.glad0172, #自由核算項一控制方式
       glad018 LIKE glad_t.glad018, #啟用自由核算項二
       glad0181 LIKE glad_t.glad0181, #自由核算項二類型編號
       glad0182 LIKE glad_t.glad0182, #自由核算項二控制方式
       glad019 LIKE glad_t.glad019, #啟用自由核算項三
       glad0191 LIKE glad_t.glad0191, #自由核算項三類型編號
       glad0192 LIKE glad_t.glad0192, #自由核算項三控制方式
       glad020 LIKE glad_t.glad020, #啟用自由核算項四
       glad0201 LIKE glad_t.glad0201, #自由核算項四類型編號
       glad0202 LIKE glad_t.glad0202, #自由核算項四控制方式
       glad021 LIKE glad_t.glad021, #啟用自由核算項五
       glad0211 LIKE glad_t.glad0211, #自由核算項五類型編號
       glad0212 LIKE glad_t.glad0212, #自由核算項五控制方式
       glad022 LIKE glad_t.glad022, #啟用自由核算項六
       glad0221 LIKE glad_t.glad0221, #自由核算項六類型編號
       glad0222 LIKE glad_t.glad0222, #自由核算項六控制方式
       glad023 LIKE glad_t.glad023, #啟用自由核算項七
       glad0231 LIKE glad_t.glad0231, #自由核算項七類型編號
       glad0232 LIKE glad_t.glad0232, #自由核算項七控制方式
       glad024 LIKE glad_t.glad024, #啟用自由核算項八
       glad0241 LIKE glad_t.glad0241, #自由核算項八類型編號
       glad0242 LIKE glad_t.glad0242, #自由核算項八控制方式
       glad025 LIKE glad_t.glad025, #啟用自由核算項九
       glad0251 LIKE glad_t.glad0251, #自由核算項九類型編號
       glad0252 LIKE glad_t.glad0252, #自由核算項九控制方式
       glad026 LIKE glad_t.glad026, #啟用自由核算項十
       glad0261 LIKE glad_t.glad0261, #自由核算項十類型編號
       glad0262 LIKE glad_t.glad0262, #自由核算項十控制方式
       glad027 LIKE glad_t.glad027, #啟用帳款客商管理
       glad030 LIKE glad_t.glad030, #是否進行預算管控
       glad031 LIKE glad_t.glad031, #啟用經營方式管理
       glad032 LIKE glad_t.glad032, #啟用通路管理
       glad033 LIKE glad_t.glad033, #啟用品牌管理
       glad034 LIKE glad_t.glad034, #科目做多幣別管理
       #161109-00085#63 --s add     
       gladud001 LIKE glad_t.gladud001, #自定義欄位(文字)001
       gladud002 LIKE glad_t.gladud002, #自定義欄位(文字)002
       gladud003 LIKE glad_t.gladud003, #自定義欄位(文字)003
       gladud004 LIKE glad_t.gladud004, #自定義欄位(文字)004
       gladud005 LIKE glad_t.gladud005, #自定義欄位(文字)005
       gladud006 LIKE glad_t.gladud006, #自定義欄位(文字)006
       gladud007 LIKE glad_t.gladud007, #自定義欄位(文字)007
       gladud008 LIKE glad_t.gladud008, #自定義欄位(文字)008
       gladud009 LIKE glad_t.gladud009, #自定義欄位(文字)009
       gladud010 LIKE glad_t.gladud010, #自定義欄位(文字)010
       gladud011 LIKE glad_t.gladud011, #自定義欄位(數字)011
       gladud012 LIKE glad_t.gladud012, #自定義欄位(數字)012
       gladud013 LIKE glad_t.gladud013, #自定義欄位(數字)013
       gladud014 LIKE glad_t.gladud014, #自定義欄位(數字)014
       gladud015 LIKE glad_t.gladud015, #自定義欄位(數字)015
       gladud016 LIKE glad_t.gladud016, #自定義欄位(數字)016
       gladud017 LIKE glad_t.gladud017, #自定義欄位(數字)017
       gladud018 LIKE glad_t.gladud018, #自定義欄位(數字)018
       gladud019 LIKE glad_t.gladud019, #自定義欄位(數字)019
       gladud020 LIKE glad_t.gladud020, #自定義欄位(數字)020
       gladud021 LIKE glad_t.gladud021, #自定義欄位(日期時間)021
       gladud022 LIKE glad_t.gladud022, #自定義欄位(日期時間)022
       gladud023 LIKE glad_t.gladud023, #自定義欄位(日期時間)023
       gladud024 LIKE glad_t.gladud024, #自定義欄位(日期時間)024
       gladud025 LIKE glad_t.gladud025, #自定義欄位(日期時間)025
       gladud026 LIKE glad_t.gladud026, #自定義欄位(日期時間)026
       gladud027 LIKE glad_t.gladud027, #自定義欄位(日期時間)027
       gladud028 LIKE glad_t.gladud028, #自定義欄位(日期時間)028
       gladud029 LIKE glad_t.gladud029, #自定義欄位(日期時間)029
       gladud030 LIKE glad_t.gladud030, #自定義欄位(日期時間)030
       #161109-00085#63 --e add
       glad035 LIKE glad_t.glad035, #是否是子系統科目
       glad036 LIKE glad_t.glad036  #貸方現金變動碼
          END RECORD
   #161109-00085#19-e mod
   
   IF p_xcec.xcec005 IS NULL THEN LET p_xcec.xcec005 = ' ' END IF 	#特性
   IF p_xcec.xcec101 IS NULL THEN LET p_xcec.xcec101 = ' ' END IF 	#科目编号
   IF p_xcec.xcec102 IS NULL THEN LET p_xcec.xcec102 = ' ' END IF 	#摘要
   IF p_xcec.xcec103 IS NULL THEN LET p_xcec.xcec103 = ' ' END IF 	#成本域
   IF p_xcec.xcec110 IS NULL THEN LET p_xcec.xcec110 = ' ' END IF 	#原因码
   IF p_xcec.xcec111 IS NULL THEN LET p_xcec.xcec111 = ' ' END IF 	#交易对象
   IF p_xcec.xcec112 IS NULL THEN LET p_xcec.xcec112 = ' ' END IF 	#客群
   IF p_xcec.xcec113 IS NULL THEN LET p_xcec.xcec113 = ' ' END IF 	#区域
   IF p_xcec.xcec114 IS NULL THEN LET p_xcec.xcec114 = ' ' END IF 	#成本中心
   IF p_xcec.xcec115 IS NULL THEN LET p_xcec.xcec115 = ' ' END IF 	#经营类别
   IF p_xcec.xcec116 IS NULL THEN LET p_xcec.xcec116 = ' ' END IF 	#渠道
   IF p_xcec.xcec117 IS NULL THEN LET p_xcec.xcec117 = ' ' END IF 	#品类
   IF p_xcec.xcec118 IS NULL THEN LET p_xcec.xcec118 = ' ' END IF 	#品牌
   IF p_xcec.xcec119 IS NULL THEN LET p_xcec.xcec119 = ' ' END IF 	#项目号
   IF p_xcec.xcec120 IS NULL THEN LET p_xcec.xcec120 = ' ' END IF 	#WBS
   IF p_xcec.xcec107	IS NULL THEN LET p_xcec.xcec107 = ' ' END IF  #人员
   IF p_xcec.xcec108	IS NULL THEN LET p_xcec.xcec108 = ' ' END IF  #部门
   IF p_xcec.xcec109	IS NULL THEN LET p_xcec.xcec109 = ' ' END IF  #账款对象
   IF p_xcec.xcec121	IS NULL THEN LET p_xcec.xcec121 = ' ' END IF  #自由核算项1
   IF p_xcec.xcec122	IS NULL THEN LET p_xcec.xcec122 = ' ' END IF  #自由核算项2
   IF p_xcec.xcec123	IS NULL THEN LET p_xcec.xcec123 = ' ' END IF  #自由核算项3
   IF p_xcec.xcec124	IS NULL THEN LET p_xcec.xcec124 = ' ' END IF  #自由核算项4
   IF p_xcec.xcec125	IS NULL THEN LET p_xcec.xcec125 = ' ' END IF  #自由核算项5
   IF p_xcec.xcec126	IS NULL THEN LET p_xcec.xcec126 = ' ' END IF  #自由核算项6
   IF p_xcec.xcec127	IS NULL THEN LET p_xcec.xcec127 = ' ' END IF  #自由核算项7
   IF p_xcec.xcec128	IS NULL THEN LET p_xcec.xcec128 = ' ' END IF  #自由核算项8
   IF p_xcec.xcec129	IS NULL THEN LET p_xcec.xcec129 = ' ' END IF  #自由核算项9
   IF p_xcec.xcec130	IS NULL THEN LET p_xcec.xcec130 = ' ' END IF  #自由核算项10

  
   INITIALIZE l_glad.* TO NULL
   #160607-00026#1-s-mark
   #SELECT * INTO l_glad.* FROM glad_t
   # WHERE gladent = p_xcec.xcecent
   #   AND gladld  = p_xcec.xcecld
   #   AND glad001 = p_xcec.xcec101
   #160607-00026#1-e-mark
   #160607-00026#1-s-add
   #EXECUTE axct701_01_glad_prep USING p_xcec.xcecld,p_xcec.xcec101 INTO l_glad.*  #161109-00085#63  mark    
   #161109-00085#63 --s add   
   EXECUTE axct701_01_glad_prep USING p_xcec.xcecld,p_xcec.xcec101
   INTO l_glad.gladent,l_glad.gladownid,l_glad.gladowndp,l_glad.gladcrtid,l_glad.gladcrtdp,
        l_glad.gladcrtdt,l_glad.gladmodid,l_glad.gladmoddt,l_glad.gladstus,l_glad.gladld,
        l_glad.glad001,l_glad.glad002,l_glad.glad003,l_glad.glad004,l_glad.glad005,
        l_glad.glad006,l_glad.glad007,l_glad.glad008,l_glad.glad009,l_glad.glad010,
        l_glad.glad011,l_glad.glad012,l_glad.glad013,l_glad.glad014,l_glad.glad015,
        l_glad.glad016,l_glad.glad017,l_glad.glad0171,l_glad.glad0172,l_glad.glad018,
        l_glad.glad0181,l_glad.glad0182,l_glad.glad019,l_glad.glad0191,l_glad.glad0192,
        l_glad.glad020,l_glad.glad0201,l_glad.glad0202,l_glad.glad021,l_glad.glad0211,
        l_glad.glad0212,l_glad.glad022,l_glad.glad0221,l_glad.glad0222,l_glad.glad023,
        l_glad.glad0231,l_glad.glad0232,l_glad.glad024,l_glad.glad0241,l_glad.glad0242,
        l_glad.glad025,l_glad.glad0251,l_glad.glad0252,l_glad.glad026,l_glad.glad0261,
        l_glad.glad0262,l_glad.glad027,l_glad.glad030,l_glad.glad031,l_glad.glad032,
        l_glad.glad033,l_glad.glad034,l_glad.gladud001,l_glad.gladud002,l_glad.gladud003,
        l_glad.gladud004,l_glad.gladud005,l_glad.gladud006,l_glad.gladud007,l_glad.gladud008,
        l_glad.gladud009,l_glad.gladud010,l_glad.gladud011,l_glad.gladud012,l_glad.gladud013,
        l_glad.gladud014,l_glad.gladud015,l_glad.gladud016,l_glad.gladud017,l_glad.gladud018,
        l_glad.gladud019,l_glad.gladud020,l_glad.gladud021,l_glad.gladud022,l_glad.gladud023,
        l_glad.gladud024,l_glad.gladud025,l_glad.gladud026,l_glad.gladud027,l_glad.gladud028,
        l_glad.gladud029,l_glad.gladud030,l_glad.glad035,l_glad.glad036    
   #161109-00085#63 --e add        
   #160607-00026#1-e-add
   
   IF l_glad.glad010 = 'N' THEN   #启用交易对象
      LET p_xcec.xcec111 = ' '
   END IF
   
   IF l_glad.glad011 = 'N' THEN   #启用客群
      LET p_xcec.xcec112 = ' '
   END IF
   
   IF l_glad.glad009 = 'N' THEN   #启用区域
      LET p_xcec.xcec113 = ' '
   END IF
   
   IF l_glad.glad008 = 'N' THEN   #启用成本中心
      LET p_xcec.xcec114 = ' '
   END IF
   
   IF l_glad.glad031 = 'N' THEN   #启用经营类别
      LET p_xcec.xcec115 = ' '
   END IF
   
   IF l_glad.glad032 = 'N' THEN   #启用渠道
      LET p_xcec.xcec116 = ' '
   END IF
   
   IF l_glad.glad012 = 'N' THEN   #启用品类
      LET p_xcec.xcec117 = ' '
   END IF
   
   IF l_glad.glad033 = 'N' THEN   #启用品牌
      LET p_xcec.xcec118 = ' '
   END IF
   
   IF l_glad.glad015 = 'N' THEN   #启用项目号
      LET p_xcec.xcec119 = ' '
   END IF
   
   IF l_glad.glad016 = 'N' THEN   #启用WBS
      LET p_xcec.xcec120 = ' '
   END IF
   
   IF l_glad.glad013 = 'N' THEN   #启用人员
      LET p_xcec.xcec107 = ' '
   END IF
   
   IF l_glad.glad007 = 'N' THEN   #启用部门
      LET p_xcec.xcec108 = ' '
   END IF
   
   IF l_glad.glad027 = 'N' THEN   #启用账款对象
      LET p_xcec.xcec109 = ' '
   END IF
   
   IF l_glad.glad017 = 'N' THEN   #启用自由核算项1
      LET p_xcec.xcec121 = ' '
   END IF
   
   IF l_glad.glad018 = 'N' THEN   #启用自由核算项2
      LET p_xcec.xcec122 = ' '
   END IF
   
   IF l_glad.glad019 = 'N' THEN   #启用自由核算项3
      LET p_xcec.xcec123 = ' '
   END IF
   
   IF l_glad.glad020 = 'N' THEN   #启用自由核算项4
      LET p_xcec.xcec124 = ' '
   END IF
   
   IF l_glad.glad021 = 'N' THEN   #启用自由核算项5
      LET p_xcec.xcec125 = ' '
   END IF
   
   IF l_glad.glad022 = 'N' THEN   #启用自由核算项6
      LET p_xcec.xcec126 = ' '
   END IF
   
   IF l_glad.glad023 = 'N' THEN   #启用自由核算项7
      LET p_xcec.xcec127 = ' '
   END IF
   
   IF l_glad.glad024 = 'N' THEN   #启用自由核算项8
      LET p_xcec.xcec128 = ' '
   END IF
   
   IF l_glad.glad025 = 'N' THEN   #启用自由核算项9
      LET p_xcec.xcec129 = ' '
   END IF
   
   IF l_glad.glad026 = 'N' THEN   #启用自由核算项10
      LET p_xcec.xcec130 = ' '
   END IF

   IF cl_null(p_xcec.xcec101) THEN
      LET p_xcec.xcec111 = ' '  	#交易对象
      LET p_xcec.xcec112 = ' '  	#客群
      LET p_xcec.xcec113 = ' '  	#区域
      LET p_xcec.xcec114 = ' '  	#成本中心
      LET p_xcec.xcec115 = ' '  	#经营类别
      LET p_xcec.xcec116 = ' '  	#渠道
      LET p_xcec.xcec117 = ' '  	#品类
      LET p_xcec.xcec118 = ' '  	#品牌
      LET p_xcec.xcec119 = ' '  	#项目号
      LET p_xcec.xcec120 = ' '  	#WBS
      LET p_xcec.xcec107 = ' '   #人员
      LET p_xcec.xcec108 = ' '   #部门
      LET p_xcec.xcec109 = ' '   #账款对象
      LET p_xcec.xcec121 = ' '   #自由核算项1
      LET p_xcec.xcec122 = ' '   #自由核算项2
      LET p_xcec.xcec123 = ' '   #自由核算项3
      LET p_xcec.xcec124 = ' '   #自由核算项4
      LET p_xcec.xcec125 = ' '   #自由核算项5
      LET p_xcec.xcec126 = ' '   #自由核算项6
      LET p_xcec.xcec127 = ' '   #自由核算项7
      LET p_xcec.xcec128 = ' '   #自由核算项8
      LET p_xcec.xcec129 = ' '   #自由核算项9
      LET p_xcec.xcec130 = ' '   #自由核算项10
   END IF

   RETURN p_xcec.xcec005,
          p_xcec.xcec101,
          p_xcec.xcec102,
          p_xcec.xcec103,
          p_xcec.xcec110,
          p_xcec.xcec111,
          p_xcec.xcec112,
          p_xcec.xcec113,
          p_xcec.xcec114,
          p_xcec.xcec115,
          p_xcec.xcec116,
          p_xcec.xcec117,
          p_xcec.xcec118,
          p_xcec.xcec119,
          p_xcec.xcec120,
          p_xcec.xcec107,
          p_xcec.xcec108,
          p_xcec.xcec109,
          p_xcec.xcec121,
          p_xcec.xcec122,
          p_xcec.xcec123,
          p_xcec.xcec124,
          p_xcec.xcec125,
          p_xcec.xcec126,
          p_xcec.xcec127,
          p_xcec.xcec128,
          p_xcec.xcec129,
          p_xcec.xcec130
END FUNCTION

################################################################################
# Descriptions...: 若无单身产生，单头也要取消
# Memo...........:
# Usage..........: CALL s_aooi150_ins (传入参数)
#                  RETURNING 回传参数
# Input parameter: 传入参数变量1   传入参数变量说明1
#                : 传入参数变量2   传入参数变量说明2
# Return code....: 回传参数变量1   回传参数变量说明1
#                : 回传参数变量2   回传参数变量说明2
# Date & Author..: 日期 By 作者
# Modify.........:
################################################################################
PRIVATE FUNCTION axct701_01_del_all()
   DEFINE l_cnt1     LIKE type_t.num5
   DEFINE l_cnt2     LIKE type_t.num5
   DEFINE r_success  LIKE type_t.chr1
   
   LET r_success = 'Y'
   LET l_cnt1 = 0
   LET l_cnt2 = 0
   
   SELECT COUNT(*) INTO l_cnt1 
     FROM xceb_t 
    WHERE xcebent = g_enterprise
      AND xcebld  = g_xcea_m.xceald
      AND xcebdocno=g_xcea_m.xceadocno
      
   SELECT COUNT(*) INTO l_cnt2 
     FROM xcec_t 
    WHERE xcecent = g_enterprise
      AND xcecld  = g_xcea_m.xceald
      AND xcecdocno=g_xcea_m.xceadocno      

   IF l_cnt1 = 0 AND l_cnt2 = 0 THEN
      DELETE FROM xcea_t 
       WHERE xceaent = g_enterprise
         AND xceald  = g_xcea_m.xceald
         AND xceadocno=g_xcea_m.xceadocno
     
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = 'agl-00167'
      LET g_errparam.extend = ''
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = 'N'
      LET g_xcea_m.xceald = ''
      LET g_xcea_m.xceadocno = ''
   END IF
   RETURN r_success
END FUNCTION

################################################################################
# Descriptions...: 取得axci202维护的摘要
# Memo...........:
# Usage..........: CALL axct701_01_get_summ(p_glabld,p_glab001,p_glab002,p_glab003)
#                  RETURNING r_success,r_summ
# Input parameter: p_glabld       帳別
#                : p_glab001      科目對應的帳務類型
#                : p_glab002      帳款類別
#                : p_glab003      預設科目代號(SCC設定)
# Return code....: r_success      TRUE成功/FALSE失敗
#                : r_summ         摘要
# Date & Author..: 15/03/26 By wujie
# Modify.........:
################################################################################
PRIVATE FUNCTION axct701_01_get_summ(p_glabld,p_glab001,p_glab002,p_glab003)
   DEFINE p_glabld      LIKE glab_t.glabld
   DEFINE p_glab001     LIKE glab_t.glab001
   DEFINE p_glab002     LIKE glab_t.glab002
   DEFINE p_glab003     LIKE glab_t.glab003
   DEFINE r_summ        LIKE glab_t.glab010
   DEFINE r_success     LIKE type_t.num10
   DEFINE l_success     LIKE type_t.num10
   
   WHENEVER ERROR CONTINUE
   
   LET r_summ = NULL
   LET r_success = TRUE
   SELECT glab010 INTO r_summ
     FROM glab_t
    WHERE glabld  = p_glabld
      AND glab001 = p_glab001
      AND glab002 = p_glab002
      AND glab003 = p_glab003
      AND glabent = g_enterprise
      
   RETURN r_success,r_summ
END FUNCTION

################################################################################
################################################################################
# Descriptions...: 项目投入凭证
# Memo...........: 151202-00017#1  2016/03/14 xianghui
################################################################################
PRIVATE FUNCTION axct701_01_ins_13()
DEFINE l_success       LIKE type_t.num5
DEFINE l_errno         LIKE gzze_t.gzze001
#161109-00085#19-s mod
#DEFINE l_xcea          RECORD LIKE xcea_t.*   #161109-00085#19-s mark
DEFINE l_xcea          RECORD  #工單發料成本憑證單頭檔
       xceaent LIKE xcea_t.xceaent, #企業編號
       xceacomp LIKE xcea_t.xceacomp, #法人組織
       xceald LIKE xcea_t.xceald, #帳套
       xceadocno LIKE xcea_t.xceadocno, #單據編號
       xcea001 LIKE xcea_t.xcea001, #單據日期
       xcea002 LIKE xcea_t.xcea002, #成本憑證類型
       xcea003 LIKE xcea_t.xcea003, #成本計算類型
       xcea004 LIKE xcea_t.xcea004, #年度
       xcea005 LIKE xcea_t.xcea005, #期別
       xcea006 LIKE xcea_t.xcea006, #帳務人員
       xcea007 LIKE xcea_t.xcea007, #帳務部門
       xcea101 LIKE xcea_t.xcea101, #憑證編號
       xcea102 LIKE xcea_t.xcea102, #憑證日期
       xceaownid LIKE xcea_t.xceaownid, #資料所有者
       xceaowndp LIKE xcea_t.xceaowndp, #資料所屬部門
       xceacrtid LIKE xcea_t.xceacrtid, #資料建立者
       xceacrtdp LIKE xcea_t.xceacrtdp, #資料建立部門
       xceacrtdt LIKE xcea_t.xceacrtdt, #資料創建日
       xceamodid LIKE xcea_t.xceamodid, #資料修改者
       xceamoddt LIKE xcea_t.xceamoddt, #最近修改日
       xceacnfid LIKE xcea_t.xceacnfid, #資料確認者
       xceacnfdt LIKE xcea_t.xceacnfdt, #資料確認日
       xceapstid LIKE xcea_t.xceapstid, #資料過帳者
       xceapstdt LIKE xcea_t.xceapstdt, #資料過帳日
       xceastus LIKE xcea_t.xceastus, #狀態碼
       #161109-00085#63 --s add
       xceaud001 LIKE xcea_t.xceaud001, #自定義欄位(文字)001
       xceaud002 LIKE xcea_t.xceaud002, #自定義欄位(文字)002
       xceaud003 LIKE xcea_t.xceaud003, #自定義欄位(文字)003
       xceaud004 LIKE xcea_t.xceaud004, #自定義欄位(文字)004
       xceaud005 LIKE xcea_t.xceaud005, #自定義欄位(文字)005
       xceaud006 LIKE xcea_t.xceaud006, #自定義欄位(文字)006
       xceaud007 LIKE xcea_t.xceaud007, #自定義欄位(文字)007
       xceaud008 LIKE xcea_t.xceaud008, #自定義欄位(文字)008
       xceaud009 LIKE xcea_t.xceaud009, #自定義欄位(文字)009
       xceaud010 LIKE xcea_t.xceaud010, #自定義欄位(文字)010
       xceaud011 LIKE xcea_t.xceaud011, #自定義欄位(數字)011
       xceaud012 LIKE xcea_t.xceaud012, #自定義欄位(數字)012
       xceaud013 LIKE xcea_t.xceaud013, #自定義欄位(數字)013
       xceaud014 LIKE xcea_t.xceaud014, #自定義欄位(數字)014
       xceaud015 LIKE xcea_t.xceaud015, #自定義欄位(數字)015
       xceaud016 LIKE xcea_t.xceaud016, #自定義欄位(數字)016
       xceaud017 LIKE xcea_t.xceaud017, #自定義欄位(數字)017
       xceaud018 LIKE xcea_t.xceaud018, #自定義欄位(數字)018
       xceaud019 LIKE xcea_t.xceaud019, #自定義欄位(數字)019
       xceaud020 LIKE xcea_t.xceaud020, #自定義欄位(數字)020
       xceaud021 LIKE xcea_t.xceaud021, #自定義欄位(日期時間)021
       xceaud022 LIKE xcea_t.xceaud022, #自定義欄位(日期時間)022
       xceaud023 LIKE xcea_t.xceaud023, #自定義欄位(日期時間)023
       xceaud024 LIKE xcea_t.xceaud024, #自定義欄位(日期時間)024
       xceaud025 LIKE xcea_t.xceaud025, #自定義欄位(日期時間)025
       xceaud026 LIKE xcea_t.xceaud026, #自定義欄位(日期時間)026
       xceaud027 LIKE xcea_t.xceaud027, #自定義欄位(日期時間)027
       xceaud028 LIKE xcea_t.xceaud028, #自定義欄位(日期時間)028
       xceaud029 LIKE xcea_t.xceaud029, #自定義欄位(日期時間)029
       xceaud030 LIKE xcea_t.xceaud030, #自定義欄位(日期時間)030
       #161109-00085#63 --e add
       xceasite LIKE xcea_t.xceasite  #營運據點
          END RECORD
#161109-00085#19-e mod
#161109-00085#19-s mod
#DEFINE l_xceb          RECORD LIKE xceb_t.*   #161109-00085#19-s mark
DEFINE l_xceb         RECORD  #成本憑證第一單身檔
       xcebent LIKE xceb_t.xcebent, #企業編號
       xcebcomp LIKE xceb_t.xcebcomp, #法人組織
       xcebld LIKE xceb_t.xcebld, #帳套
       xcebdocno LIKE xceb_t.xcebdocno, #單據編號
       xcebseq LIKE xceb_t.xcebseq, #項次
       xceb001 LIKE xceb_t.xceb001, #參考單據編號
       xceb002 LIKE xceb_t.xceb002, #參考單據項次
       xceb003 LIKE xceb_t.xceb003, #單據類型
       xceb004 LIKE xceb_t.xceb004, #料件編號
       xceb005 LIKE xceb_t.xceb005, #特性
       xceb101 LIKE xceb_t.xceb101, #科目編號
       xceb102 LIKE xceb_t.xceb102, #摘要
       xceb103 LIKE xceb_t.xceb103, #成本域
       xceb110 LIKE xceb_t.xceb110, #原因碼
       xceb111 LIKE xceb_t.xceb111, #收付款客商
       xceb112 LIKE xceb_t.xceb112, #客群
       xceb113 LIKE xceb_t.xceb113, #區域
       xceb114 LIKE xceb_t.xceb114, #成本中心
       xceb115 LIKE xceb_t.xceb115, #經營類別
       xceb116 LIKE xceb_t.xceb116, #通路
       xceb117 LIKE xceb_t.xceb117, #品類
       xceb118 LIKE xceb_t.xceb118, #品牌
       xceb119 LIKE xceb_t.xceb119, #專案號
       xceb120 LIKE xceb_t.xceb120, #WBS
       xceb201 LIKE xceb_t.xceb201, #數量
       xceb202 LIKE xceb_t.xceb202, #成本金額(本位幣一)
       xceb202a LIKE xceb_t.xceb202a, #成本-材料(本位幣一)
       xceb202b LIKE xceb_t.xceb202b, #成本-人工(本位幣一)
       xceb202c LIKE xceb_t.xceb202c, #成本-加工(本位幣一)
       xceb202d LIKE xceb_t.xceb202d, #成本-制費一(本位幣一)
       xceb202e LIKE xceb_t.xceb202e, #成本-制費二(本位幣一)
       xceb202f LIKE xceb_t.xceb202f, #成本-制費三(本位幣一)
       xceb202g LIKE xceb_t.xceb202g, #成本-制費四(本位幣一)
       xceb202h LIKE xceb_t.xceb202h, #成本-制費五(本位幣一)
       xceb212 LIKE xceb_t.xceb212, #成本金額(本位幣二)
       xceb212a LIKE xceb_t.xceb212a, #成本-材料(本位幣二)
       xceb212b LIKE xceb_t.xceb212b, #成本-人工(本位幣二)
       xceb212c LIKE xceb_t.xceb212c, #成本-加工(本位幣二)
       xceb212d LIKE xceb_t.xceb212d, #成本-制費一(本位幣二)
       xceb212e LIKE xceb_t.xceb212e, #成本-制費二(本位幣二)
       xceb212f LIKE xceb_t.xceb212f, #成本-制費三(本位幣二)
       xceb212g LIKE xceb_t.xceb212g, #成本-制費四(本位幣二)
       xceb212h LIKE xceb_t.xceb212h, #成本-制費五(本位幣二)
       xceb222 LIKE xceb_t.xceb222, #成本金額(本位幣三)
       xceb222a LIKE xceb_t.xceb222a, #成本-材料(本位幣三)
       xceb222b LIKE xceb_t.xceb222b, #成本-人工(本位幣三)
       xceb222c LIKE xceb_t.xceb222c, #成本-加工(本位幣三)
       xceb222d LIKE xceb_t.xceb222d, #成本-制費一(本位幣三)
       xceb222e LIKE xceb_t.xceb222e, #成本-制費二(本位幣三)
       xceb222f LIKE xceb_t.xceb222f, #成本-制費三(本位幣三)
       xceb222g LIKE xceb_t.xceb222g, #成本-制費四(本位幣三)
       xceb222h LIKE xceb_t.xceb222h, #成本-制費五(本位幣三)
       xceb301 LIKE xceb_t.xceb301, #憑證編號
       xceb302 LIKE xceb_t.xceb302, #憑證項次
       #161109-00085#63 --s add  
       xcebud001 LIKE xceb_t.xcebud001, #自定義欄位(文字)001
       xcebud002 LIKE xceb_t.xcebud002, #自定義欄位(文字)002
       xcebud003 LIKE xceb_t.xcebud003, #自定義欄位(文字)003
       xcebud004 LIKE xceb_t.xcebud004, #自定義欄位(文字)004
       xcebud005 LIKE xceb_t.xcebud005, #自定義欄位(文字)005
       xcebud006 LIKE xceb_t.xcebud006, #自定義欄位(文字)006
       xcebud007 LIKE xceb_t.xcebud007, #自定義欄位(文字)007
       xcebud008 LIKE xceb_t.xcebud008, #自定義欄位(文字)008
       xcebud009 LIKE xceb_t.xcebud009, #自定義欄位(文字)009
       xcebud010 LIKE xceb_t.xcebud010, #自定義欄位(文字)010
       xcebud011 LIKE xceb_t.xcebud011, #自定義欄位(數字)011
       xcebud012 LIKE xceb_t.xcebud012, #自定義欄位(數字)012
       xcebud013 LIKE xceb_t.xcebud013, #自定義欄位(數字)013
       xcebud014 LIKE xceb_t.xcebud014, #自定義欄位(數字)014
       xcebud015 LIKE xceb_t.xcebud015, #自定義欄位(數字)015
       xcebud016 LIKE xceb_t.xcebud016, #自定義欄位(數字)016
       xcebud017 LIKE xceb_t.xcebud017, #自定義欄位(數字)017
       xcebud018 LIKE xceb_t.xcebud018, #自定義欄位(數字)018
       xcebud019 LIKE xceb_t.xcebud019, #自定義欄位(數字)019
       xcebud020 LIKE xceb_t.xcebud020, #自定義欄位(數字)020
       xcebud021 LIKE xceb_t.xcebud021, #自定義欄位(日期時間)021
       xcebud022 LIKE xceb_t.xcebud022, #自定義欄位(日期時間)022
       xcebud023 LIKE xceb_t.xcebud023, #自定義欄位(日期時間)023
       xcebud024 LIKE xceb_t.xcebud024, #自定義欄位(日期時間)024
       xcebud025 LIKE xceb_t.xcebud025, #自定義欄位(日期時間)025
       xcebud026 LIKE xceb_t.xcebud026, #自定義欄位(日期時間)026
       xcebud027 LIKE xceb_t.xcebud027, #自定義欄位(日期時間)027
       xcebud028 LIKE xceb_t.xcebud028, #自定義欄位(日期時間)028
       xcebud029 LIKE xceb_t.xcebud029, #自定義欄位(日期時間)029
       xcebud030 LIKE xceb_t.xcebud030, #自定義欄位(日期時間)030
       #161109-00085#63 --e add
       xceb107 LIKE xceb_t.xceb107, #人員
       xceb108 LIKE xceb_t.xceb108, #部門
       xceb109 LIKE xceb_t.xceb109, #帳款對象
       xceb121 LIKE xceb_t.xceb121, #自由核算項1
       xceb122 LIKE xceb_t.xceb122, #自由核算項2
       xceb123 LIKE xceb_t.xceb123, #自由核算項3
       xceb124 LIKE xceb_t.xceb124, #自由核算項4
       xceb125 LIKE xceb_t.xceb125, #自由核算項5
       xceb126 LIKE xceb_t.xceb126, #自由核算項6
       xceb127 LIKE xceb_t.xceb127, #自由核算項7
       xceb128 LIKE xceb_t.xceb128, #自由核算項8
       xceb129 LIKE xceb_t.xceb129, #自由核算項9
       xceb130 LIKE xceb_t.xceb130, #自由核算項10
       xceb131 LIKE xceb_t.xceb131, #單據類型(for 流通)
       xceb132 LIKE xceb_t.xceb132  #單據日期(for 流通)
          END RECORD
#161109-00085#19-e mod
#161109-00085#19-s mod
#DEFINE l_xcec          RECORD LIKE xcec_t.*   #161109-00085#18-s mark
DEFINE l_xcec          RECORD  #成本憑證第二單身檔
       xcecent LIKE xcec_t.xcecent, #企業編號
       xceccomp LIKE xcec_t.xceccomp, #法人組織
       xcecld LIKE xcec_t.xcecld, #帳套
       xcecdocno LIKE xcec_t.xcecdocno, #單據編號
       xcecseq LIKE xcec_t.xcecseq, #項次
       xcec001 LIKE xcec_t.xcec001, #參考單據
       xcec002 LIKE xcec_t.xcec002, #參考單據項次
       xcec003 LIKE xcec_t.xcec003, #單據類型
       xcec004 LIKE xcec_t.xcec004, #料件編號
       xcec005 LIKE xcec_t.xcec005, #特性
       xcec101 LIKE xcec_t.xcec101, #科目編號
       xcec102 LIKE xcec_t.xcec102, #摘要
       xcec103 LIKE xcec_t.xcec103, #成本域
       xcec110 LIKE xcec_t.xcec110, #原因碼
       xcec111 LIKE xcec_t.xcec111, #收付款客商
       xcec112 LIKE xcec_t.xcec112, #客群
       xcec113 LIKE xcec_t.xcec113, #區域
       xcec114 LIKE xcec_t.xcec114, #成本中心
       xcec115 LIKE xcec_t.xcec115, #經營類別
       xcec116 LIKE xcec_t.xcec116, #通路
       xcec117 LIKE xcec_t.xcec117, #品類
       xcec118 LIKE xcec_t.xcec118, #品牌
       xcec119 LIKE xcec_t.xcec119, #專案號
       xcec120 LIKE xcec_t.xcec120, #WBS
       xcec201 LIKE xcec_t.xcec201, #數量
       xcec202 LIKE xcec_t.xcec202, #成本金額(本位幣一)
       xcec202a LIKE xcec_t.xcec202a, #成本-材料(本位幣一)
       xcec202b LIKE xcec_t.xcec202b, #成本-人工(本位幣一)
       xcec202c LIKE xcec_t.xcec202c, #成本-加工(本位幣一)
       xcec202d LIKE xcec_t.xcec202d, #成本-制費一(本位幣一)
       xcec202e LIKE xcec_t.xcec202e, #成本-制費二(本位幣一)
       xcec202f LIKE xcec_t.xcec202f, #成本-制費三(本位幣一)
       xcec202g LIKE xcec_t.xcec202g, #成本-制費四(本位幣一)
       xcec202h LIKE xcec_t.xcec202h, #成本-制費五(本位幣一)
       xcec212 LIKE xcec_t.xcec212, #成本-金額(本位幣二)
       xcec212a LIKE xcec_t.xcec212a, #成本-材料(本位幣二)
       xcec212b LIKE xcec_t.xcec212b, #成本-人工(本位幣二)
       xcec212c LIKE xcec_t.xcec212c, #成本-加工(本位幣二)
       xcec212d LIKE xcec_t.xcec212d, #成本-制費一(本位幣二)
       xcec212e LIKE xcec_t.xcec212e, #成本-制費二(本位幣二)
       xcec212f LIKE xcec_t.xcec212f, #成本-制費三(本位幣二)
       xcec212g LIKE xcec_t.xcec212g, #成本-制費四(本位幣二)
       xcec212h LIKE xcec_t.xcec212h, #成本-制費五(本位幣二)
       xcec222 LIKE xcec_t.xcec222, #成本-金額(本位幣三)
       xcec222a LIKE xcec_t.xcec222a, #成本-材料(本位幣三)
       xcec222b LIKE xcec_t.xcec222b, #成本-人工(本位幣三)
       xcec222c LIKE xcec_t.xcec222c, #成本-加工(本位幣三)
       xcec222d LIKE xcec_t.xcec222d, #成本-制費一(本位幣三)
       xcec222e LIKE xcec_t.xcec222e, #成本-制費二(本位幣三)
       xcec222f LIKE xcec_t.xcec222f, #成本-制費三(本位幣三)
       xcec222g LIKE xcec_t.xcec222g, #成本-制費四(本位幣三)
       xcec222h LIKE xcec_t.xcec222h, #成本-制費五(本位幣三)
       xcec301 LIKE xcec_t.xcec301, #憑證編號
       xcec302 LIKE xcec_t.xcec302, #憑證項次
       #161109-00085#63 --s add 
       xcecud001 LIKE xcec_t.xcecud001, #自定義欄位(文字)001
       xcecud002 LIKE xcec_t.xcecud002, #自定義欄位(文字)002
       xcecud003 LIKE xcec_t.xcecud003, #自定義欄位(文字)003
       xcecud004 LIKE xcec_t.xcecud004, #自定義欄位(文字)004
       xcecud005 LIKE xcec_t.xcecud005, #自定義欄位(文字)005
       xcecud006 LIKE xcec_t.xcecud006, #自定義欄位(文字)006
       xcecud007 LIKE xcec_t.xcecud007, #自定義欄位(文字)007
       xcecud008 LIKE xcec_t.xcecud008, #自定義欄位(文字)008
       xcecud009 LIKE xcec_t.xcecud009, #自定義欄位(文字)009
       xcecud010 LIKE xcec_t.xcecud010, #自定義欄位(文字)010
       xcecud011 LIKE xcec_t.xcecud011, #自定義欄位(數字)011
       xcecud012 LIKE xcec_t.xcecud012, #自定義欄位(數字)012
       xcecud013 LIKE xcec_t.xcecud013, #自定義欄位(數字)013
       xcecud014 LIKE xcec_t.xcecud014, #自定義欄位(數字)014
       xcecud015 LIKE xcec_t.xcecud015, #自定義欄位(數字)015
       xcecud016 LIKE xcec_t.xcecud016, #自定義欄位(數字)016
       xcecud017 LIKE xcec_t.xcecud017, #自定義欄位(數字)017
       xcecud018 LIKE xcec_t.xcecud018, #自定義欄位(數字)018
       xcecud019 LIKE xcec_t.xcecud019, #自定義欄位(數字)019
       xcecud020 LIKE xcec_t.xcecud020, #自定義欄位(數字)020
       xcecud021 LIKE xcec_t.xcecud021, #自定義欄位(日期時間)021
       xcecud022 LIKE xcec_t.xcecud022, #自定義欄位(日期時間)022
       xcecud023 LIKE xcec_t.xcecud023, #自定義欄位(日期時間)023
       xcecud024 LIKE xcec_t.xcecud024, #自定義欄位(日期時間)024
       xcecud025 LIKE xcec_t.xcecud025, #自定義欄位(日期時間)025
       xcecud026 LIKE xcec_t.xcecud026, #自定義欄位(日期時間)026
       xcecud027 LIKE xcec_t.xcecud027, #自定義欄位(日期時間)027
       xcecud028 LIKE xcec_t.xcecud028, #自定義欄位(日期時間)028
       xcecud029 LIKE xcec_t.xcecud029, #自定義欄位(日期時間)029
       xcecud030 LIKE xcec_t.xcecud030, #自定義欄位(日期時間)030
       #161109-00085#63 --e add
       xcec107 LIKE xcec_t.xcec107, #人員
       xcec108 LIKE xcec_t.xcec108, #部門
       xcec109 LIKE xcec_t.xcec109, #帳款對象
       xcec121 LIKE xcec_t.xcec121, #自由核算項1
       xcec122 LIKE xcec_t.xcec122, #自由核算項2
       xcec123 LIKE xcec_t.xcec123, #自由核算項3
       xcec124 LIKE xcec_t.xcec124, #自由核算項4
       xcec125 LIKE xcec_t.xcec125, #自由核算項5
       xcec126 LIKE xcec_t.xcec126, #自由核算項6
       xcec127 LIKE xcec_t.xcec127, #自由核算項7
       xcec128 LIKE xcec_t.xcec128, #自由核算項8
       xcec129 LIKE xcec_t.xcec129, #自由核算項9
       xcec130 LIKE xcec_t.xcec130  #自由核算項10
               END RECORD
#161109-00085#19-e mod
#161109-00085#19-s mod
#DEFINE l_xmdl          RECORD LIKE xmdl_t.*   #161109-00085#19-s mark
DEFINE l_xmdl          RECORD  #出貨/簽收/銷退單單身明細檔
       xmdlent LIKE xmdl_t.xmdlent, #企業編號                   
       xmdlsite LIKE xmdl_t.xmdlsite, #營運據點
       xmdldocno LIKE xmdl_t.xmdldocno, #單據編號
       xmdlseq LIKE xmdl_t.xmdlseq, #項次
       xmdl001 LIKE xmdl_t.xmdl001, #出通單號
       xmdl002 LIKE xmdl_t.xmdl002, #出通項次
       xmdl003 LIKE xmdl_t.xmdl003, #訂單單號
       xmdl004 LIKE xmdl_t.xmdl004, #訂單項次
       xmdl005 LIKE xmdl_t.xmdl005, #訂單項序
       xmdl006 LIKE xmdl_t.xmdl006, #訂單分批序
       xmdl007 LIKE xmdl_t.xmdl007, #子件特性
       xmdl008 LIKE xmdl_t.xmdl008, #料件編號
       xmdl009 LIKE xmdl_t.xmdl009, #產品特徵
       xmdl010 LIKE xmdl_t.xmdl010, #包裝容器
       xmdl011 LIKE xmdl_t.xmdl011, #作業編號
       xmdl012 LIKE xmdl_t.xmdl012, #作業序
       xmdl013 LIKE xmdl_t.xmdl013, #多庫儲批出貨
       xmdl014 LIKE xmdl_t.xmdl014, #庫位
       xmdl015 LIKE xmdl_t.xmdl015, #儲位
       xmdl016 LIKE xmdl_t.xmdl016, #批號
       xmdl017 LIKE xmdl_t.xmdl017, #出貨單位
       xmdl018 LIKE xmdl_t.xmdl018, #數量
       xmdl019 LIKE xmdl_t.xmdl019, #參考單位
       xmdl020 LIKE xmdl_t.xmdl020, #參考數量
       xmdl021 LIKE xmdl_t.xmdl021, #計價單位
       xmdl022 LIKE xmdl_t.xmdl022, #計價數量
       xmdl023 LIKE xmdl_t.xmdl023, #檢驗否
       xmdl024 LIKE xmdl_t.xmdl024, #單價
       xmdl025 LIKE xmdl_t.xmdl025, #稅別
       xmdl026 LIKE xmdl_t.xmdl026, #稅率
       xmdl027 LIKE xmdl_t.xmdl027, #未稅金額
       xmdl028 LIKE xmdl_t.xmdl028, #含稅金額
       xmdl029 LIKE xmdl_t.xmdl029, #稅額
       xmdl030 LIKE xmdl_t.xmdl030, #專案編號
       xmdl031 LIKE xmdl_t.xmdl031, #WBS編號
       xmdl032 LIKE xmdl_t.xmdl032, #活動編號
       xmdl033 LIKE xmdl_t.xmdl033, #客戶料號
       xmdl034 LIKE xmdl_t.xmdl034, #QPA
       xmdl035 LIKE xmdl_t.xmdl035, #已簽收量
       xmdl036 LIKE xmdl_t.xmdl036, #已簽退量
       xmdl037 LIKE xmdl_t.xmdl037, #已銷退量
       xmdl038 LIKE xmdl_t.xmdl038, #主帳套已立帳數量
       xmdl039 LIKE xmdl_t.xmdl039, #帳套二已立帳數量
       xmdl040 LIKE xmdl_t.xmdl040, #帳套三已立帳數量
       xmdl041 LIKE xmdl_t.xmdl041, #保稅否
       xmdl042 LIKE xmdl_t.xmdl042, #取價來源
       xmdl043 LIKE xmdl_t.xmdl043, #價格來源參考單號
       xmdl044 LIKE xmdl_t.xmdl044, #價格來源參考項次
       xmdl045 LIKE xmdl_t.xmdl045, #取出價格
       xmdl046 LIKE xmdl_t.xmdl046, #價差比
       xmdl047 LIKE xmdl_t.xmdl047, #已開發票數量
       xmdl048 LIKE xmdl_t.xmdl048, #發票編號
       xmdl049 LIKE xmdl_t.xmdl049, #發票號碼
       xmdl050 LIKE xmdl_t.xmdl050, #理由碼
       xmdl051 LIKE xmdl_t.xmdl051, #備註
       xmdl052 LIKE xmdl_t.xmdl052, #庫存管理特徵
       xmdl053 LIKE xmdl_t.xmdl053, #主帳套暫估數量
       xmdl054 LIKE xmdl_t.xmdl054, #帳套二暫估數量
       xmdl055 LIKE xmdl_t.xmdl055, #帳套三暫估數量
       xmdl081 LIKE xmdl_t.xmdl081, #簽退數量(簽收、簽退單使用)
       xmdl082 LIKE xmdl_t.xmdl082, #簽退參考數量(簽收、簽退單使用) 
       xmdl083 LIKE xmdl_t.xmdl083, #簽退計價數量(簽收、簽退單使用)
       xmdl084 LIKE xmdl_t.xmdl084, #簽退理由碼(簽收、簽退單使用)
       xmdl085 LIKE xmdl_t.xmdl085, #訂單開立據點
       xmdl086 LIKE xmdl_t.xmdl086, #訂單多角性質
       xmdl087 LIKE xmdl_t.xmdl087, #需自立應收否
       xmdl088 LIKE xmdl_t.xmdl088, #多角流程編號
       xmdl089 LIKE xmdl_t.xmdl089, #QC單號
       xmdl090 LIKE xmdl_t.xmdl090, #判定項次
       xmdl091 LIKE xmdl_t.xmdl091, #判定結果
       xmdl092 LIKE xmdl_t.xmdl092, #借貨還量數量
       xmdl093 LIKE xmdl_t.xmdl093, #借貨還量參考數量
       xmdl200 LIKE xmdl_t.xmdl200, #銷售通路
       xmdl201 LIKE xmdl_t.xmdl201, #產品組編碼
       xmdl202 LIKE xmdl_t.xmdl202, #銷售範圍編碼
       xmdl203 LIKE xmdl_t.xmdl203, #銷售辦公室
       xmdl204 LIKE xmdl_t.xmdl204, #出貨包裝單位
       xmdl205 LIKE xmdl_t.xmdl205, #出貨包裝數量
       xmdl206 LIKE xmdl_t.xmdl206, #簽退包裝數量
       xmdl207 LIKE xmdl_t.xmdl207, #庫存鎖定等級
       xmdl208 LIKE xmdl_t.xmdl208, #標準價
       xmdl209 LIKE xmdl_t.xmdl209, #促銷價
       xmdl210 LIKE xmdl_t.xmdl210, #交易價
       xmdl211 LIKE xmdl_t.xmdl211, #折價金額
       xmdl212 LIKE xmdl_t.xmdl212, #銷售組織
       xmdl213 LIKE xmdl_t.xmdl213, #銷售人員
       xmdl214 LIKE xmdl_t.xmdl214, #銷售部門
       xmdl215 LIKE xmdl_t.xmdl215, #合約編號
       xmdl216 LIKE xmdl_t.xmdl216, #經營方式
       xmdl217 LIKE xmdl_t.xmdl217, #結算類型
       xmdl218 LIKE xmdl_t.xmdl218, #結算方式
       xmdl219 LIKE xmdl_t.xmdl219, #交易類型
       xmdl220 LIKE xmdl_t.xmdl220, #寄銷已核銷數量
       xmdl222 LIKE xmdl_t.xmdl222, #地區編號
       xmdl223 LIKE xmdl_t.xmdl223, #縣市編號
       xmdl224 LIKE xmdl_t.xmdl224, #省區編號
       xmdl225 LIKE xmdl_t.xmdl225, #區域編號
       xmdl226 LIKE xmdl_t.xmdl226, #商品條碼
       xmdlunit LIKE xmdl_t.xmdlunit, #應用組織
       xmdlorga LIKE xmdl_t.xmdlorga, #帳務組織
       #161109-00085#63 --s add     
       xmdlud001 LIKE xmdl_t.xmdlud001, #自定義欄位(文字)001
       xmdlud002 LIKE xmdl_t.xmdlud002, #自定義欄位(文字)002
       xmdlud003 LIKE xmdl_t.xmdlud003, #自定義欄位(文字)003
       xmdlud004 LIKE xmdl_t.xmdlud004, #自定義欄位(文字)004
       xmdlud005 LIKE xmdl_t.xmdlud005, #自定義欄位(文字)005
       xmdlud006 LIKE xmdl_t.xmdlud006, #自定義欄位(文字)006
       xmdlud007 LIKE xmdl_t.xmdlud007, #自定義欄位(文字)007
       xmdlud008 LIKE xmdl_t.xmdlud008, #自定義欄位(文字)008
       xmdlud009 LIKE xmdl_t.xmdlud009, #自定義欄位(文字)009
       xmdlud010 LIKE xmdl_t.xmdlud010, #自定義欄位(文字)010
       xmdlud011 LIKE xmdl_t.xmdlud011, #自定義欄位(數字)011
       xmdlud012 LIKE xmdl_t.xmdlud012, #自定義欄位(數字)012
       xmdlud013 LIKE xmdl_t.xmdlud013, #自定義欄位(數字)013
       xmdlud014 LIKE xmdl_t.xmdlud014, #自定義欄位(數字)014
       xmdlud015 LIKE xmdl_t.xmdlud015, #自定義欄位(數字)015
       xmdlud016 LIKE xmdl_t.xmdlud016, #自定義欄位(數字)016
       xmdlud017 LIKE xmdl_t.xmdlud017, #自定義欄位(數字)017
       xmdlud018 LIKE xmdl_t.xmdlud018, #自定義欄位(數字)018
       xmdlud019 LIKE xmdl_t.xmdlud019, #自定義欄位(數字)019
       xmdlud020 LIKE xmdl_t.xmdlud020, #自定義欄位(數字)020
       xmdlud021 LIKE xmdl_t.xmdlud021, #自定義欄位(日期時間)021
       xmdlud022 LIKE xmdl_t.xmdlud022, #自定義欄位(日期時間)022
       xmdlud023 LIKE xmdl_t.xmdlud023, #自定義欄位(日期時間)023
       xmdlud024 LIKE xmdl_t.xmdlud024, #自定義欄位(日期時間)024
       xmdlud025 LIKE xmdl_t.xmdlud025, #自定義欄位(日期時間)025
       xmdlud026 LIKE xmdl_t.xmdlud026, #自定義欄位(日期時間)026
       xmdlud027 LIKE xmdl_t.xmdlud027, #自定義欄位(日期時間)027
       xmdlud028 LIKE xmdl_t.xmdlud028, #自定義欄位(日期時間)028
       xmdlud029 LIKE xmdl_t.xmdlud029, #自定義欄位(日期時間)029
       xmdlud030 LIKE xmdl_t.xmdlud030, #自定義欄位(日期時間)030
       #161109-00085#63 --e add
       xmdl056 LIKE xmdl_t.xmdl056, #檢驗合格量     
       xmdl094 LIKE xmdl_t.xmdl094, #來源單號(銷退)
       xmdl095 LIKE xmdl_t.xmdl095, #項次(銷退)
       xmdl227 LIKE xmdl_t.xmdl227, #現金折扣單號
       xmdl228 LIKE xmdl_t.xmdl228, #現金折扣單項次
       xmdl057 LIKE xmdl_t.xmdl057, #有效日期
       xmdl058 LIKE xmdl_t.xmdl058, #製造日期
       xmdl096 LIKE xmdl_t.xmdl096, #來源項次 
       #xmdl059 LIKE xmdl_t.xmdl059  #161109-00085#63 mark
       xmdl059 LIKE xmdl_t.xmdl059, #客戶退貨量 #161109-00085#63 add
       xmdl060 LIKE xmdl_t.xmdl060  #放行狀態   #161109-00085#63 add
          END RECORD
#161109-00085#19-e mod

DEFINE l_sql           STRING
DEFINE l_sql1          STRING
DEFINE l_rate          LIKE type_t.num26_10
DEFINE l_rate1         LIKE type_t.num26_10
DEFINE ld_date         DATETIME YEAR TO SECOND
DEFINE l_glaa001       LIKE glaa_t.glaa001
DEFINE l_glaacomp      LIKE glaa_t.glaacomp
DEFINE l_glaa003       LIKE glaa_t.glaa003
DEFINE l_bdate         LIKE pjda_t.pjdadocdt
DEFINE l_edate         LIKE pjda_t.pjdadocdt
DEFINE l_glaa017       LIKE glaa_t.glaa017
DEFINE l_glaa021       LIKE glaa_t.glaa021
DEFINE l_xmdl008       LIKE xmdl_t.xmdl008,
       l_xmdl009       LIKE xmdl_t.xmdl009,
       l_xmdl017       LIKE xmdl_t.xmdl017,
       l_xmdl030       LIKE xmdl_t.xmdl030,
       l_xmdl031       LIKE xmdl_t.xmdl031,
       l_xmdk007       LIKE xmdk_t.xmdk007,
       l_xmdk016       LIKE xmdk_t.xmdk016,
       l_xmdl018       LIKE xmdl_t.xmdl018,
       l_xmdl037       LIKE xmdl_t.xmdl037,
       l_unit          LIKE xmdl_t.xmdl017,    #基础单位
       l_value         LIKE xmdl_t.xmdl018,    #暂存数量
       l_xccc280       LIKE xccc_t.xccc280, 
       l_xccc280a      LIKE xccc_t.xccc280a,
       l_xccc280b      LIKE xccc_t.xccc280b,
       l_xccc280c      LIKE xccc_t.xccc280c,
       l_xccc280d      LIKE xccc_t.xccc280d,
       l_xccc280e      LIKE xccc_t.xccc280e,
       l_xccc280f      LIKE xccc_t.xccc280f,
       l_xccc280g      LIKE xccc_t.xccc280g,
       l_xccc280h      LIKE xccc_t.xccc280h,
       l_xmdlorga      LIKE xmdl_t.xmdlorga    #161026-00056#1
       
   LET g_success = 'Y'
   LET l_xcea.xceaent   = g_enterprise
   LET l_xcea.xceacomp  = g_xcea_m.xceacomp
   LET l_xcea.xceald    = g_xcea_m.xceald
   LET l_xcea.xcea001   = g_xcea_m.xcea001
   LET l_xcea.xcea002   = g_xcea002   #13投入 14结转
   LET l_xcea.xcea003   = g_xcea_m.xcea003
   LET l_xcea.xcea004   = g_xcea_m.xcea004
   LET l_xcea.xcea005   = g_xcea_m.xcea005
   LET l_xcea.xcea006   = g_xcea_m.xcea006
   LET l_xcea.xcea007   = g_xcea_m.xcea007
   LET l_xcea.xcea101   = ''
   LET l_xcea.xcea102   = ''
   LET l_xcea.xceaownid = g_user
   LET l_xcea.xceaowndp = g_dept
   LET l_xcea.xceacrtid = g_user
   LET l_xcea.xceacrtdp = g_dept 
   LET ld_date = cl_get_current()
   LET l_xcea.xceacrtdt = ld_date
   LET l_xcea.xceamodid = ""
   LET l_xcea.xceamoddt = ""
   LET l_xcea.xceacnfid = ""
   LET l_xcea.xceacnfdt = ""
   LET l_xcea.xceapstid = ""
   LET l_xcea.xceapstdt = ""
   LET l_xcea.xceastus  = 'N'
   CALL s_aooi200_fin_gen_docno(g_xcea_m.xceald,'','',g_xcea_m.xceadocno,g_xcea_m.xcea001,g_prog_name1)
    RETURNING l_success,l_xcea.xceadocno
   IF l_success  = 0  THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = 'apm-00003'
      LET g_errparam.extend = g_xcea_m.xceadocno
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET g_success = 'N'
      RETURN g_success
   END IF
   #161109-00085#20-s mod
#   INSERT INTO xcea_t VALUES(l_xcea.*)   #161109-00085#20-s mark
   #161109-00085#63 --s mark
   #INSERT INTO xcea_t(xceaent,xceacomp,xceald,xceadocno,xcea001,xcea002,xcea003,xcea004,xcea005,
   #                   xcea006,xcea007,xcea101,xcea102,xceaownid,xceaowndp,xceacrtid,xceacrtdp,xceacrtdt,
   #                   xceamodid,xceamoddt,xceacnfid,xceacnfdt,xceapstid,xceapstdt,xceastus,xceasite) 
   #            VALUES(l_xcea.xceaent,l_xcea.xceacomp,l_xcea.xceald,l_xcea.xceadocno,l_xcea.xcea001,
   #                   l_xcea.xcea002,l_xcea.xcea003,l_xcea.xcea004,l_xcea.xcea005,l_xcea.xcea006,
   #                   l_xcea.xcea007,l_xcea.xcea101,l_xcea.xcea102,l_xcea.xceaownid,l_xcea.xceaowndp,
   #                   l_xcea.xceacrtid,l_xcea.xceacrtdp,l_xcea.xceacrtdt,l_xcea.xceamodid,l_xcea.xceamoddt,
   #                   l_xcea.xceacnfid,l_xcea.xceacnfdt,l_xcea.xceapstid,l_xcea.xceapstdt,l_xcea.xceastus,l_xcea.xceasite)
   #161109-00085#63 --e mark
   #161109-00085#20-e mod
   #161109-00085#63 --s add
   INSERT INTO xcea_t(xceaent,xceacomp,xceald,xceadocno,xcea001,
                      xcea002,xcea003,xcea004,xcea005,xcea006,
                      xcea007,xcea101,xcea102,xceaownid,xceaowndp,
                      xceacrtid,xceacrtdp,xceacrtdt,xceamodid,xceamoddt,
                      xceacnfid,xceacnfdt,xceapstid,xceapstdt,xceastus,
                      xceaud001,xceaud002,xceaud003,xceaud004,xceaud005,
                      xceaud006,xceaud007,xceaud008,xceaud009,xceaud010,
                      xceaud011,xceaud012,xceaud013,xceaud014,xceaud015,
                      xceaud016,xceaud017,xceaud018,xceaud019,xceaud020,
                      xceaud021,xceaud022,xceaud023,xceaud024,xceaud025,
                      xceaud026,xceaud027,xceaud028,xceaud029,xceaud030,
                      xceasite)
   VALUES(l_xcea.xceaent,l_xcea.xceacomp,l_xcea.xceald,l_xcea.xceadocno,l_xcea.xcea001,
          l_xcea.xcea002,l_xcea.xcea003,l_xcea.xcea004,l_xcea.xcea005,l_xcea.xcea006,
          l_xcea.xcea007,l_xcea.xcea101,l_xcea.xcea102,l_xcea.xceaownid,l_xcea.xceaowndp,
          l_xcea.xceacrtid,l_xcea.xceacrtdp,l_xcea.xceacrtdt,l_xcea.xceamodid,l_xcea.xceamoddt,
          l_xcea.xceacnfid,l_xcea.xceacnfdt,l_xcea.xceapstid,l_xcea.xceapstdt,l_xcea.xceastus,
          l_xcea.xceaud001,l_xcea.xceaud002,l_xcea.xceaud003,l_xcea.xceaud004,l_xcea.xceaud005,
          l_xcea.xceaud006,l_xcea.xceaud007,l_xcea.xceaud008,l_xcea.xceaud009,l_xcea.xceaud010,
          l_xcea.xceaud011,l_xcea.xceaud012,l_xcea.xceaud013,l_xcea.xceaud014,l_xcea.xceaud015,
          l_xcea.xceaud016,l_xcea.xceaud017,l_xcea.xceaud018,l_xcea.xceaud019,l_xcea.xceaud020,
          l_xcea.xceaud021,l_xcea.xceaud022,l_xcea.xceaud023,l_xcea.xceaud024,l_xcea.xceaud025,
          l_xcea.xceaud026,l_xcea.xceaud027,l_xcea.xceaud028,l_xcea.xceaud029,l_xcea.xceaud030,
          l_xcea.xceasite)
   #161109-00085#63 --e add
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "xcea_t"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET g_success = 'N'
      RETURN g_success
   END IF
   LET g_xcea_m.xceadocno = l_xcea.xceadocno
   
   #根据账套获取币别、所属法人、会计周期参照表
   SELECT glaa017,glaa021 INTO l_glaa017,l_glaa021
     FROM glaa_t
    WHERE glaaent = g_enterprise
      AND glaald = g_xcea_m.xceald
   
   #根据年度期别算出起止单据日期
   CALL s_fin_date_get_period_range(g_glaa003,g_xcea_m.xcea004,g_xcea_m.xcea005)
      RETURNING l_bdate,l_edate
      
   #xceb单身
   #161026-00056#1---mod---s  
   #LET l_sql = " SELECT xmdl008,xmdl009,xmdl017,xmdl030,xmdl031,xmdk007,xmdk016,SUM(COALESCE(xmdl018,0)),SUM(COALESCE(xmdl037,0))",
   #            " FROM xmdk_t,xmdl_t ", 
   #            "  WHERE xmdkent = xmdlent AND xmdkdocno = xmdldocno ",
   #            "    AND xmdkent  = '",g_enterprise,"' ",
   #            "    AND xmdk002 = 'X' ",
   #            "    AND xmdkstus = 'S' ",
   #            "    AND xmdk000 IN('1','2','3','4','5') ",
   #            "    AND xmdl030 IS NOT NULL ",
   #            "    AND xmdk001 BETWEEN '",l_bdate,"' AND '",l_edate,"'",
   #            "    AND xmdksite IN (SELECT ooef001 FROM ooef_t WHERE ooefent = ",g_enterprise," AND ooef201 = 'Y' AND ooef017 = '",g_xcea_m.xceacomp,"') ",     #160902-00048#3 add ent
   #            "  GROUP BY xmdl008,xmdl009,xmdl017,xmdl030,xmdl031,xmdk007,xmdk016 ",
   #            "  ORDER BY xmdl008,xmdl009,xmdl017,xmdl030,xmdl031,xmdk007,xmdk016 "
   LET l_sql = " SELECT SUM(-1*xcck009*xcck202),SUM(-1*xcck009*xcck202a),",
               "        SUM(-1*xcck009*xcck202b),SUM(-1*xcck009*xcck202c),SUM(-1*xcck009*xcck202d),",
               "        SUM(-1*xcck009*xcck202e),SUM(-1*xcck009*xcck202f),SUM(-1*xcck009*xcck202g), ",
               "        SUM(-1*xcck009*xcck202h)",
               "        FROM xcck_t ", 
               "  WHERE xcckent = '",g_enterprise,"' AND xcckld = '",g_xcea_m.xceald,"'",
               "    AND xcck003 = '",g_xcea_m.xcea003,"' AND xcck004 = ",g_xcea_m.xcea004,
               "    AND xcck005 = ",g_xcea_m.xcea005,
               "    AND xcck001 = ? ",
               #"    AND xcck055 IN('303X','305X') ",   #161109-00032#6
               "    AND xcck055 IN('309X','305X') ",    #161109-00032#6
               "    AND xcck010=? AND xcck011=? AND xcck044=? AND xcck030=? ",
               "    AND xcck031=? AND xcck022=? AND xcck041=? AND xcck002=?"
   PREPARE axct701_01_ins_13_p2 FROM l_sql
   
   LET l_sql = " SELECT xcck010,xcck011,xcck044,xcck030,xcck031,xcck022,xcck041,xcck002,",
               "        SUM(-1*xcck009*xcck201),SUM(-1*xcck009*xcck202),SUM(-1*xcck009*xcck202a),",
               "        SUM(-1*xcck009*xcck202b),SUM(-1*xcck009*xcck202c),SUM(-1*xcck009*xcck202d),",
               "        SUM(-1*xcck009*xcck202e),SUM(-1*xcck009*xcck202f),SUM(-1*xcck009*xcck202g),",
               "        SUM(-1*xcck009*xcck202h)",
               "        FROM xcck_t ", 
               "  WHERE xcckent = '",g_enterprise,"' AND xcckld = '",g_xcea_m.xceald,"'",
               "    AND xcck003 = '",g_xcea_m.xcea003,"' AND xcck004 = ",g_xcea_m.xcea004,
               "    AND xcck005 = ",g_xcea_m.xcea005,
               "    AND xcck001 = '1' ",
               #"    AND xcck055 IN('303X','305X') ",   #161109-00032#6
               "    AND xcck055 IN('309X','305X') ",    #161109-00032#6                                    
               " GROUP BY xcck010,xcck011,xcck044,xcck030,xcck031,xcck022,xcck041,xcck002 ",   
               " ORDER BY xcck010,xcck011,xcck044,xcck030,xcck031,xcck022,xcck041,xcck002 "    
   #161026-00056#1---mod---e  
               
   PREPARE axct701_01_ins_13_p1 FROM l_sql
   DECLARE axct701_01_ins_13_c1 CURSOR FOR axct701_01_ins_13_p1
   #161026-00056#1---mod---s  
   #FOREACH axct701_01_ins_13_c1 INTO l_xmdl008,l_xmdl009,l_xmdl017,l_xmdl030,l_xmdl031,
   #                                  l_xmdk007,l_xmdk016,l_xmdl018,l_xmdl037
   
   INITIALIZE l_xceb.* TO NULL #161229-00044#1
   FOREACH axct701_01_ins_13_c1 INTO l_xmdl008,l_xmdl009,l_xmdl017,l_xmdl030,l_xmdl031,
                                     l_xmdk007,l_xmdk016,l_xmdlorga,l_xceb.xceb201,   
                                     l_xceb.xceb202,l_xceb.xceb202a,l_xceb.xceb202b,
                                     l_xceb.xceb202c,l_xceb.xceb202d,l_xceb.xceb202e,
                                     l_xceb.xceb202f,l_xceb.xceb202g,l_xceb.xceb202h         
   #161026-00056#1---mod---e  
      #INITIALIZE l_xceb.* TO NULL   #161229-00044#1
      
      #161026-00056#1---mark---s  
      #1.数量换算成成本单位
      #SELECT imag014 INTO l_unit
      #  FROM imag_t 
      # WHERE imagent = g_enterprise
      #   AND imagsite = g_xcea_m.xceacomp
      #   AND imag001 = l_xmdl008         
      #IF cl_null(l_xmdl018) THEN LET l_xmdl018 = 0 END IF
      #IF cl_null(l_xmdl037) THEN LET l_xmdl037 = 0 END IF
      #LET l_value = l_xmdl018-l_xmdl037
      #IF cl_null(l_unit) THEN 
      #   SELECT imaa006 INTO l_unit FROM imaa_t WHERE imaaent = g_enterprise AND imaa001 = l_xmdl008
      #END IF
      #CALL s_aooi250_convert_qty(l_xmdl008,l_xmdl017,l_unit,l_value)
      #               RETURNING l_success,l_value 
      #LET l_xceb.xceb201 = l_value                 
      ##获取汇率
      #IF g_glaa015 = 'Y' THEN
      #   IF l_glaa017='1' THEN #依交易原币
      #      CALL s_aooi160_get_exrate('2',g_xcea_m.xceald,g_xcea_m.xcea001,l_xmdk016,
      #                                  #目的幣別;  交易金額;匯類類型
      #                                   g_glaa016,0,g_glaa018)
      #         RETURNING l_rate
      #   ELSE #依账簿币别
      #      CALL s_aooi160_get_exrate('2',g_xcea_m.xceald,g_xcea_m.xcea001,g_glaa001,
      #                                   g_glaa016,0,g_glaa018)
      #         RETURNING l_rate
      #   END IF
      #END IF
      #   
      #IF g_glaa019 = 'Y' THEN
      #   IF l_glaa021='1' THEN #依交易原币
      #      CALL s_aooi160_get_exrate('2',g_xcea_m.xceald,g_xcea_m.xcea001,l_xmdk016,
      #                                  #目的幣別;  交易金額; 匯類類型
      #                                   g_glaa020,0,g_glaa022)
      #         RETURNING l_rate1
      #   ELSE #依账簿币别
      #      CALL s_aooi160_get_exrate('2',g_xcea_m.xceald,g_xcea_m.xcea001,g_glaa001,
      #                                   g_glaa020,0,g_glaa022)
      #         RETURNING l_rate1
      #   END IF
      #END IF 
      #161026-00056#1---mark---s  

      SELECT MAX(xcebseq) INTO l_xceb.xcebseq FROM xceb_t
       WHERE xcebent = g_enterprise AND xcebld = g_xcea_m.xceald
         AND xcebdocno = g_xcea_m.xceadocno
      IF cl_null(l_xceb.xcebseq) OR l_xceb.xcebseq = 0 THEN
         LET l_xceb.xcebseq = 1
      ELSE
         LET l_xceb.xcebseq = l_xceb.xcebseq + 1
      END IF 
      
      LET l_xceb.xcebent  = g_enterprise
      LET l_xceb.xcebcomp = g_xcea_m.xceacomp
      LET l_xceb.xcebld   = g_xcea_m.xceald
      LET l_xceb.xcebdocno= g_xcea_m.xceadocno
#      LET l_xceb.xceb001  = l_pjdb.pjdbdocno  #參考單據編號
#      LET l_xceb.xceb002  = l_pjdb.pjdbseq    #參考單據項次
      LET l_xceb.xceb003  = '1'             #單據類型--结转出
      
#      #根据专案编号，抓取料件编号及特性
#      SELECT DISTINCT xmdc001,xmdc019 INTO l_xceb.xceb004,l_xceb.xceb005
#        FROM xmdc_t,xmda_t
#       WHERE xmdcent = g_enterprise
#         AND xmdadocno = xmdcdocno
#         AND xmdcsite = g_site
#         AND xmdaent = xmdcent 
#         AND xmdc036 = l_pjdb.pjdb001
#         AND xmdastus = 'Y'
#
      LET l_xceb.xceb004  = l_xmdl008  #料件編號
      LET l_xceb.xceb005  = l_xmdl009  #特性
      LET l_xceb.xceb119 = l_xmdl030    #項目號
      LET l_xceb.xceb120 = l_xmdl031    #WBS
      LET l_xceb.xceb101 = ' '          #科目编号

      CALL s_fin_get_account(g_xcea_m.xceald,'60','8912','10') RETURNING l_success,l_xceb.xceb101,l_errno

      IF cl_null(l_xceb.xceb101) THEN LET l_xceb.xceb101 = ' ' END IF
      LET l_xceb.xceb102  = ' '              #摘要
      #摘要#13投入
      CALL axct701_01_get_summ(g_xcea_m.xceald,'61','8925','13') RETURNING l_success,l_xceb.xceb102

      #LET l_xceb.xceb103 = ' '  #成本域
      LET l_xceb.xceb103 = l_xmdlorga     #161026-00056#1
      LET l_xceb.xceb110 = ' '  #原因碼 
      
      LET l_xceb.xceb111 = ' '  #交易對象
      LET l_xceb.xceb112 = ' '  #客群
      LET l_xceb.xceb113 = ' '  #區域
      LET l_xceb.xceb114 = ' '  #成本中心
      LET l_xceb.xceb115 = ' '  #經營類別
      LET l_xceb.xceb116 = ' '  #渠道
      
      LET l_xceb.xceb120 = ' '  #WBS
      LET l_xceb.xceb107 = ' '  #人员
      LET l_xceb.xceb108 = ' '  #部门
#      SELECT DISTINCT xmdk008,pmaa090,xmdl222,ooeg004,xmdl216,xmdl200,xmdl031,xmdl213,xmdl214,xmdl018
#        INTO l_xceb.xceb111,l_xceb.xceb112,l_xceb.xceb113,l_xceb.xceb114,l_xceb.xceb115,l_xceb.xceb116,l_xceb.xceb120,l_xceb.xceb107,l_xceb.xceb108,l_xceb.xceb201
#        FROM xmdk_t LEFT JOIN pmaa_t ON pmaaent = xmdkent AND pmaa001=xmdk008 ,
#             xmdl_t LEFT JOIN ooeg_t ON ooegent = xmdlent AND ooeg001=xmdl214 AND ooeg003='3'   #成本中心
#       WHERE xmdkent  = xmdlent
#         AND xmdkdocno= xmdldocno
#         AND xmdlent  = g_enterprise
#         AND xmdl030 = l_xmdl030     #专案编号
#         AND xmdkstus = 'Y'
#         AND xmdldocno= l_xceb.xceb001
#         AND xmdlseq  = l_xceb.xceb002

      IF cl_null(l_xceb.xceb114) THEN LET l_xceb.xceb114 = l_xceb.xceb108 END IF  #成本中心为空就为部门
      LET l_xceb.xceb109 = l_xceb.xceb111  #账款对象

      LET l_xceb.xceb117 = ' '  #品類
      LET l_xceb.xceb118 = ' '  #品牌
      SELECT imaa009,imaa126 INTO l_xceb.xceb117,l_xceb.xceb118 FROM imaa_t
       WHERE imaaent = g_enterprise
         AND imaa001 = l_xceb.xceb004

      #161026-00056#1---mark---s
      ##3.抓单价
      #LET l_xccc280 = NULL
      #SELECT xccc280,xccc280a,xccc280b,xccc280c,xccc280d,xccc280e,xccc280f,xccc280g,xccc280h 
      #  INTO l_xccc280,l_xccc280a,l_xccc280b,l_xccc280c,l_xccc280d,l_xccc280e,l_xccc280f,l_xccc280g,l_xccc280h 
      #  FROM xccc_t 
      # WHERE xcccent = g_enterprise AND xccc002 = l_xmdl030
      #   AND xccc006 = l_xmdl008 AND xccc007 = l_xmdl009
      #   AND xccccomp = g_xcea_m.xceacomp AND xcccld = g_xcea_m.xceald AND xccc003 = g_xcea_m.xcea003
      #   AND xccc004 = g_xcea_m.xcea004 AND xccc005 = g_xcea_m.xcea005
      #IF SQLCA.sqlcode = 100 THEN 
      #   CONTINUE FOREACH
      #END IF 
      #LET l_xceb.xceb202  = l_xceb.xceb201 * l_xccc280  #成本金額(本位幣一)
      #LET l_xceb.xceb202a = l_xceb.xceb201 * l_xccc280a  #成本-材料(本位幣一)
      #LET l_xceb.xceb202b = l_xceb.xceb201 * l_xccc280b  #成本-人工(本位幣一)
      #LET l_xceb.xceb202c = l_xceb.xceb201 * l_xccc280c  #成本-加工(本位幣一)
      #LET l_xceb.xceb202d = l_xceb.xceb201 * l_xccc280d  #成本-制費一(本位幣一)
      #LET l_xceb.xceb202e = l_xceb.xceb201 * l_xccc280e  #成本-制費二(本位幣一)
      #LET l_xceb.xceb202f = l_xceb.xceb201 * l_xccc280f  #成本-制費三(本位幣一)
      #LET l_xceb.xceb202g = l_xceb.xceb201 * l_xccc280g  #成本-制費四(本位幣一)
      #LET l_xceb.xceb202h = l_xceb.xceb201 * l_xccc280h  #成本-制費五(本位幣一)
      #161026-00056#1---mark---e
      
      #本位幣二
      IF g_glaa015 = 'Y' THEN
         #161026-00056#1---mod---s
         EXECUTE axct701_01_ins_13_p2 USING '2',l_xmdl008,l_xmdl009,l_xmdl017,l_xmdl030,l_xmdl031,
                                    l_xmdk007,l_xmdk016,l_xmdlorga
                              INTO l_xceb.xceb212,l_xceb.xceb212a,l_xceb.xceb212b,l_xceb.xceb212c,
                                   l_xceb.xceb212d,l_xceb.xceb212e,l_xceb.xceb212f,l_xceb.xceb212g,l_xceb.xceb212h
          
         #LET l_xceb.xceb212 = l_xceb.xceb202*l_rate #成本金额(本位幣二)
         #LET l_xceb.xceb212a = l_xceb.xceb202a*l_rate #成本-材料(本位幣二)
         #LET l_xceb.xceb212b = l_xceb.xceb202b*l_rate #成本-人工(本位幣二)
         #LET l_xceb.xceb212c = l_xceb.xceb202c*l_rate #成本-加工(本位幣二)
         #LET l_xceb.xceb212d = l_xceb.xceb202d*l_rate #成本-制費一(本位幣二)
         #LET l_xceb.xceb212e = l_xceb.xceb202e*l_rate  #成本-制費二(本位幣二)
         #LET l_xceb.xceb212f = l_xceb.xceb202f*l_rate  #成本-制費三(本位幣二)
         #LET l_xceb.xceb212g = l_xceb.xceb202g*l_rate  #成本-制費四(本位幣二)
         #LET l_xceb.xceb212h = l_xceb.xceb202h*l_rate  #成本-制費五(本位幣二)
         #161026-00056#1---mod---e
                   
         IF cl_null(l_xceb.xceb212) THEN LET l_xceb.xceb212 = 0 END IF
         IF cl_null(l_xceb.xceb212a) THEN LET l_xceb.xceb212a = 0 END IF
         IF cl_null(l_xceb.xceb212b) THEN LET l_xceb.xceb212b = 0 END IF
         IF cl_null(l_xceb.xceb212c) THEN LET l_xceb.xceb212c = 0 END IF
         IF cl_null(l_xceb.xceb212d) THEN LET l_xceb.xceb212d = 0 END IF
         IF cl_null(l_xceb.xceb212e) THEN LET l_xceb.xceb212e = 0 END IF
         IF cl_null(l_xceb.xceb212f) THEN LET l_xceb.xceb212f = 0 END IF
         IF cl_null(l_xceb.xceb212g) THEN LET l_xceb.xceb212g = 0 END IF
         IF cl_null(l_xceb.xceb212h) THEN LET l_xceb.xceb212h = 0 END IF                            
      ELSE
         LET l_xceb.xceb212a = 0
         LET l_xceb.xceb212b = 0
         LET l_xceb.xceb212c = 0
         LET l_xceb.xceb212d = 0
         LET l_xceb.xceb212e = 0
         LET l_xceb.xceb212f = 0
         LET l_xceb.xceb212g = 0
         LET l_xceb.xceb212h = 0                            
         LET l_xceb.xceb212  = 0      
      END IF

      #本位幣三
      IF g_glaa019 = 'Y' THEN
         #161026-00056#1---mod---s
         EXECUTE axct701_01_ins_13_p2 USING '3',l_xmdl008,l_xmdl009,l_xmdl017,l_xmdl030,l_xmdl031,
                                             l_xmdk007,l_xmdk016,l_xmdlorga
                                       INTO l_xceb.xceb222,l_xceb.xceb222a,l_xceb.xceb222b,l_xceb.xceb222c,
                                            l_xceb.xceb222d,l_xceb.xceb222e,l_xceb.xceb222f,l_xceb.xceb222g,l_xceb.xceb222h       
         #LET l_xceb.xceb222a = l_xceb.xceb202a*l_rate1
         #LET l_xceb.xceb222b = l_xceb.xceb202b*l_rate1
         #LET l_xceb.xceb222c = l_xceb.xceb202c*l_rate1
         #LET l_xceb.xceb222d = l_xceb.xceb202d*l_rate1
         #LET l_xceb.xceb222e = l_xceb.xceb202e*l_rate1
         #LET l_xceb.xceb222f = l_xceb.xceb202f*l_rate1
         #LET l_xceb.xceb222g = l_xceb.xceb202g*l_rate1
         #LET l_xceb.xceb222h = l_xceb.xceb202h*l_rate1
         #161026-00056#1---mod---e
         
         IF cl_null(l_xceb.xceb222a) THEN LET l_xceb.xceb222a = 0 END IF
         IF cl_null(l_xceb.xceb222b) THEN LET l_xceb.xceb222b = 0 END IF
         IF cl_null(l_xceb.xceb222c) THEN LET l_xceb.xceb222c = 0 END IF
         IF cl_null(l_xceb.xceb222d) THEN LET l_xceb.xceb222d = 0 END IF
         IF cl_null(l_xceb.xceb222e) THEN LET l_xceb.xceb222e = 0 END IF
         IF cl_null(l_xceb.xceb222f) THEN LET l_xceb.xceb222f = 0 END IF
         IF cl_null(l_xceb.xceb222g) THEN LET l_xceb.xceb222g = 0 END IF
         IF cl_null(l_xceb.xceb222h) THEN LET l_xceb.xceb222h = 0 END IF                            
         IF cl_null(l_xceb.xceb222)  THEN LET l_xceb.xceb222  = 0 END IF
      ELSE
         LET l_xceb.xceb222a = 0
         LET l_xceb.xceb222b = 0
         LET l_xceb.xceb222c = 0
         LET l_xceb.xceb222d = 0
         LET l_xceb.xceb222e = 0
         LET l_xceb.xceb222f = 0
         LET l_xceb.xceb222g = 0
         LET l_xceb.xceb222h = 0                            
         LET l_xceb.xceb222  = 0      
      END IF

      LET l_xceb.xceb301  = ''    #憑證編號
      LET l_xceb.xceb302  = ''    #憑證項次
      #161109-00085#18-s mark
#      LET l_xceb.xcebud021= ''    #自定義欄位(日期時間)
#      LET l_xceb.xcebud022= ''    #自定義欄位(日期時間)
#      LET l_xceb.xcebud023= ''    #自定義欄位(日期時間)
#      LET l_xceb.xcebud024= ''    #自定義欄位(日期時間)
#      LET l_xceb.xcebud025= ''    #自定義欄位(日期時間)
#      LET l_xceb.xcebud026= ''    #自定義欄位(日期時間)
#      LET l_xceb.xcebud027= ''    #自定義欄位(日期時間)
#      LET l_xceb.xcebud028= ''    #自定義欄位(日期時間)
#      LET l_xceb.xcebud029= ''    #自定義欄位(日期時間)
#      LET l_xceb.xcebud030= ''    #自定義欄位(日期時間)
      
      #自由核算项1～10  
      LET l_xceb.xceb121 = ' '   #自由核算項1
      LET l_xceb.xceb122 = ' '   #自由核算項2
      LET l_xceb.xceb123 = ' '   #自由核算項3
      LET l_xceb.xceb124 = ' '   #自由核算項4
      LET l_xceb.xceb125 = ' '   #自由核算項5
      LET l_xceb.xceb126 = ' '   #自由核算項6
      LET l_xceb.xceb127 = ' '   #自由核算項7
      LET l_xceb.xceb128 = ' '   #自由核算項8
      LET l_xceb.xceb129 = ' '   #自由核算項9
      LET l_xceb.xceb130 = ' '   #自由核算項10
      
      CALL axct701_01_default_space_xceb(l_xceb.*) RETURNING l_xceb.xceb005,
                                                             l_xceb.xceb101,
                                                             l_xceb.xceb102,
                                                             l_xceb.xceb103,
                                                             l_xceb.xceb110,
                                                             l_xceb.xceb111,
                                                             l_xceb.xceb112,
                                                             l_xceb.xceb113,
                                                             l_xceb.xceb114,
                                                             l_xceb.xceb115,
                                                             l_xceb.xceb116,
                                                             l_xceb.xceb117,
                                                             l_xceb.xceb118,
                                                             l_xceb.xceb119,
                                                             l_xceb.xceb120,
                                                             l_xceb.xceb107,
                                                             l_xceb.xceb108,
                                                             l_xceb.xceb109,
                                                             l_xceb.xceb121,
                                                             l_xceb.xceb122,
                                                             l_xceb.xceb123,
                                                             l_xceb.xceb124,
                                                             l_xceb.xceb125,
                                                             l_xceb.xceb126,
                                                             l_xceb.xceb127,
                                                             l_xceb.xceb128,
                                                             l_xceb.xceb129,
                                                             l_xceb.xceb130

      #如果金额和数量都为0的话，则不产生此笔单身数据                                                             
      IF l_xceb.xceb201= 0 AND l_xceb.xceb202 = 0 THEN
         CONTINUE FOREACH
      END IF
      #161109-00085#20-s mod
#      INSERT INTO xceb_t VALUES(l_xceb.*)   #161109-00085#20-s mark
      #161109-00085#63 --s mark
      #INSERT INTO xceb_t(xcebent,xcebcomp,xcebld,xcebdocno,xcebseq,xceb001,xceb002,xceb003,xceb004,
      #                   xceb005,xceb101,xceb102,xceb103,xceb110,xceb111,xceb112,xceb113,xceb114,xceb115,
      #                   xceb116,xceb117,xceb118,xceb119,xceb120,xceb201,xceb202,xceb202a,xceb202b,xceb202c,
      #                   xceb202d,xceb202e,xceb202f,xceb202g,xceb202h,xceb212,xceb212a,xceb212b,xceb212c,
      #                   xceb212d,xceb212e,xceb212f,xceb212g,xceb212h,xceb222,xceb222a,xceb222b,xceb222c,
      #                   xceb222d,xceb222e,xceb222f,xceb222g,xceb222h,xceb301,xceb302,xceb107,xceb108,xceb109,
      #                   xceb121,xceb122,xceb123,xceb124,xceb125,xceb126,xceb127,xceb128,xceb129,xceb130,xceb131,xceb132) 
      #            VALUES(l_xceb.xcebent,l_xceb.xcebcomp,l_xceb.xcebld,l_xceb.xcebdocno,l_xceb.xcebseq,
      #                   l_xceb.xceb001,l_xceb.xceb002,l_xceb.xceb003,l_xceb.xceb004,l_xceb.xceb005,
      #                   l_xceb.xceb101,l_xceb.xceb102,l_xceb.xceb103,l_xceb.xceb110,l_xceb.xceb111,
      #                   l_xceb.xceb112,l_xceb.xceb113,l_xceb.xceb114,l_xceb.xceb115,l_xceb.xceb116,
      #                   l_xceb.xceb117,l_xceb.xceb118,l_xceb.xceb119,l_xceb.xceb120,l_xceb.xceb201,
      #                   l_xceb.xceb202,l_xceb.xceb202a,l_xceb.xceb202b,l_xceb.xceb202c,l_xceb.xceb202d,
      #                   l_xceb.xceb202e,l_xceb.xceb202f,l_xceb.xceb202g,l_xceb.xceb202h,l_xceb.xceb212,
      #                   l_xceb.xceb212a,l_xceb.xceb212b,l_xceb.xceb212c,l_xceb.xceb212d,l_xceb.xceb212e,
      #                   l_xceb.xceb212f,l_xceb.xceb212g,l_xceb.xceb212h,l_xceb.xceb222,l_xceb.xceb222a,
      #                   l_xceb.xceb222b,l_xceb.xceb222c,l_xceb.xceb222d,l_xceb.xceb222e,l_xceb.xceb222f,
      #                   l_xceb.xceb222g,l_xceb.xceb222h,l_xceb.xceb301,l_xceb.xceb302,l_xceb.xceb107,
      #                   l_xceb.xceb108,l_xceb.xceb109,l_xceb.xceb121,l_xceb.xceb122,l_xceb.xceb123,
      #                   l_xceb.xceb124,l_xceb.xceb125,l_xceb.xceb126,l_xceb.xceb127,l_xceb.xceb128,
      #                   l_xceb.xceb129,l_xceb.xceb130,l_xceb.xceb131,l_xceb.xceb132)
      #161109-00085#20-e mod
      #161109-00085#63 --e mark
      #161109-00085#63 --s add
      INSERT INTO xceb_t(xcebent,xcebcomp,xcebld,xcebdocno,xcebseq,
                         xceb001,xceb002,xceb003,xceb004,xceb005,
                         xceb101,xceb102,xceb103,xceb110,xceb111,
                         xceb112,xceb113,xceb114,xceb115,xceb116,
                         xceb117,xceb118,xceb119,xceb120,xceb201,
                         xceb202,xceb202a,xceb202b,xceb202c,xceb202d,
                         xceb202e,xceb202f,xceb202g,xceb202h,xceb212,
                         xceb212a,xceb212b,xceb212c,xceb212d,xceb212e,
                         xceb212f,xceb212g,xceb212h,xceb222,xceb222a,
                         xceb222b,xceb222c,xceb222d,xceb222e,xceb222f,
                         xceb222g,xceb222h,xceb301,xceb302,xcebud001,
                         xcebud002,xcebud003,xcebud004,xcebud005,xcebud006,
                         xcebud007,xcebud008,xcebud009,xcebud010,xcebud011,
                         xcebud012,xcebud013,xcebud014,xcebud015,xcebud016,
                         xcebud017,xcebud018,xcebud019,xcebud020,xcebud021,
                         xcebud022,xcebud023,xcebud024,xcebud025,xcebud026,
                         xcebud027,xcebud028,xcebud029,xcebud030,xceb107,
                         xceb108,xceb109,xceb121,xceb122,xceb123,
                         xceb124,xceb125,xceb126,xceb127,xceb128,
                         xceb129,xceb130,xceb131,xceb132)
      VALUES(l_xceb.xcebent,l_xceb.xcebcomp,l_xceb.xcebld,l_xceb.xcebdocno,l_xceb.xcebseq,
             l_xceb.xceb001,l_xceb.xceb002,l_xceb.xceb003,l_xceb.xceb004,l_xceb.xceb005,
             l_xceb.xceb101,l_xceb.xceb102,l_xceb.xceb103,l_xceb.xceb110,l_xceb.xceb111,
             l_xceb.xceb112,l_xceb.xceb113,l_xceb.xceb114,l_xceb.xceb115,l_xceb.xceb116,
             l_xceb.xceb117,l_xceb.xceb118,l_xceb.xceb119,l_xceb.xceb120,l_xceb.xceb201,
             l_xceb.xceb202,l_xceb.xceb202a,l_xceb.xceb202b,l_xceb.xceb202c,l_xceb.xceb202d,
             l_xceb.xceb202e,l_xceb.xceb202f,l_xceb.xceb202g,l_xceb.xceb202h,l_xceb.xceb212,
             l_xceb.xceb212a,l_xceb.xceb212b,l_xceb.xceb212c,l_xceb.xceb212d,l_xceb.xceb212e,
             l_xceb.xceb212f,l_xceb.xceb212g,l_xceb.xceb212h,l_xceb.xceb222,l_xceb.xceb222a,
             l_xceb.xceb222b,l_xceb.xceb222c,l_xceb.xceb222d,l_xceb.xceb222e,l_xceb.xceb222f,
             l_xceb.xceb222g,l_xceb.xceb222h,l_xceb.xceb301,l_xceb.xceb302,l_xceb.xcebud001,
             l_xceb.xcebud002,l_xceb.xcebud003,l_xceb.xcebud004,l_xceb.xcebud005,l_xceb.xcebud006,
             l_xceb.xcebud007,l_xceb.xcebud008,l_xceb.xcebud009,l_xceb.xcebud010,l_xceb.xcebud011,
             l_xceb.xcebud012,l_xceb.xcebud013,l_xceb.xcebud014,l_xceb.xcebud015,l_xceb.xcebud016,
             l_xceb.xcebud017,l_xceb.xcebud018,l_xceb.xcebud019,l_xceb.xcebud020,l_xceb.xcebud021,
             l_xceb.xcebud022,l_xceb.xcebud023,l_xceb.xcebud024,l_xceb.xcebud025,l_xceb.xcebud026,
             l_xceb.xcebud027,l_xceb.xcebud028,l_xceb.xcebud029,l_xceb.xcebud030,l_xceb.xceb107,
             l_xceb.xceb108,l_xceb.xceb109,l_xceb.xceb121,l_xceb.xceb122,l_xceb.xceb123,
             l_xceb.xceb124,l_xceb.xceb125,l_xceb.xceb126,l_xceb.xceb127,l_xceb.xceb128,
             l_xceb.xceb129,l_xceb.xceb130,l_xceb.xceb131,l_xceb.xceb132)
      #161109-00085#63 --e add
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "ins xceb_t"
         LET g_errparam.popup = TRUE
         CALL cl_err()
         LET g_success = 'N'
         EXIT FOREACH
      END IF
       
      INITIALIZE l_xcec.* TO NULL
     
      SELECT MAX(xcecseq) INTO l_xcec.xcecseq FROM xcec_t
       WHERE xcecent = g_enterprise AND xcecld = g_xcea_m.xceald
         AND xcecdocno = g_xcea_m.xceadocno
      IF cl_null(l_xcec.xcecseq) OR l_xcec.xcecseq = 0 THEN
         LET l_xcec.xcecseq = 1
      ELSE
         LET l_xcec.xcecseq = l_xcec.xcecseq + 1
      END IF 
      
      LET l_xcec.xcecent  = g_enterprise       #企業編號
      LET l_xcec.xcecld   = g_xcea_m.xceald    #帳套
      LET l_xcec.xceccomp = g_xcea_m.xceacomp  #法人組織
      LET l_xcec.xcecdocno= g_xcea_m.xceadocno #單據編號
      LET l_xcec.xcec001  = l_xceb.xceb001     #參考單據
      LET l_xcec.xcec002  = l_xceb.xceb002     #參考單據項次
      LET l_xcec.xcec003  = l_xceb.xceb003     #單據類型
      LET l_xcec.xcec004  = l_xceb.xceb004     #料件編號
      LET l_xcec.xcec005  = l_xceb.xceb005     #特性
      
      LET l_xcec.xcec101  = ''                 #科目編號
      CALL s_fin_get_account(g_xcea_m.xceald,'60','8912','10') RETURNING l_success,l_xcec.xcec101,l_errno
          
      LET l_xcec.xcec102 = l_xceb.xceb102  #摘要
      LET l_xcec.xcec103 = l_xceb.xceb103  #成本域
      LET l_xcec.xcec110 = l_xceb.xceb110  #原因碼
      LET l_xcec.xcec111 = l_xceb.xceb111  #交易對象
      LET l_xcec.xcec112 = l_xceb.xceb112  #客群
      LET l_xcec.xcec113 = l_xceb.xceb113  #區域
      LET l_xcec.xcec114 = l_xceb.xceb114  #成本中心
      LET l_xcec.xcec115 = l_xceb.xceb115  #經營類別
      LET l_xcec.xcec116 = l_xceb.xceb116  #渠道
      LET l_xcec.xcec117 = l_xceb.xceb117  #品類
      LET l_xcec.xcec118 = l_xceb.xceb118  #品牌
      LET l_xcec.xcec119 = l_xceb.xceb119  #項目號
      LET l_xcec.xcec120 = l_xceb.xceb120  #WBS
      LET l_xcec.xcec201 = l_xceb.xceb201  #數量
      LET l_xcec.xcec202 = l_xceb.xceb202  #成本金額(本位幣一)
      LET l_xcec.xcec202a= l_xceb.xceb202a #成本-材料(本位幣一)
      LET l_xcec.xcec202b= l_xceb.xceb202b #成本-人工(本位幣一)
      LET l_xcec.xcec202c= l_xceb.xceb202c #成本-加工(本位幣一)
      LET l_xcec.xcec202d= l_xceb.xceb202d #成本-制費一(本位幣一)
      LET l_xcec.xcec202e= l_xceb.xceb202e #成本-制費二(本位幣一)
      LET l_xcec.xcec202f= l_xceb.xceb202f #成本-制費三(本位幣一)
      LET l_xcec.xcec202g= l_xceb.xceb202g #成本-制費四(本位幣一)
      LET l_xcec.xcec202h= l_xceb.xceb202h #成本-制費五(本位幣一)
      LET l_xcec.xcec212 = l_xceb.xceb212  #成本-金額(本位幣二)
      LET l_xcec.xcec212a= l_xceb.xceb212a
      LET l_xcec.xcec212b= l_xceb.xceb212b
      LET l_xcec.xcec212c= l_xceb.xceb212c
      LET l_xcec.xcec212d= l_xceb.xceb212d
      LET l_xcec.xcec212e= l_xceb.xceb212e
      LET l_xcec.xcec212f= l_xceb.xceb212f
      LET l_xcec.xcec212g= l_xceb.xceb212g
      LET l_xcec.xcec212h= l_xceb.xceb212h
      LET l_xcec.xcec222 = l_xceb.xceb222  #成本-金額(本位幣三)
      LET l_xcec.xcec222a= l_xceb.xceb222a
      LET l_xcec.xcec222b= l_xceb.xceb222b
      LET l_xcec.xcec222c= l_xceb.xceb222c
      LET l_xcec.xcec222d= l_xceb.xceb222d
      LET l_xcec.xcec222e= l_xceb.xceb222e
      LET l_xcec.xcec222f= l_xceb.xceb222f
      LET l_xcec.xcec222g= l_xceb.xceb222g
      LET l_xcec.xcec222h= l_xceb.xceb222h
      LET l_xcec.xcec301 = l_xceb.xceb301  #憑證編號
      LET l_xcec.xcec302 = l_xceb.xceb302  #憑證項次
      #161109-00085#19-s mark
#      LET l_xcec.xcecud021 = '' #自定義欄位(日期時間)
#      LET l_xcec.xcecud022 = '' #自定義欄位(日期時間)
#      LET l_xcec.xcecud023 = '' #自定義欄位(日期時間)
#      LET l_xcec.xcecud024 = '' #自定義欄位(日期時間)
#      LET l_xcec.xcecud025 = '' #自定義欄位(日期時間)
#      LET l_xcec.xcecud026 = '' #自定義欄位(日期時間)
#      LET l_xcec.xcecud027 = '' #自定義欄位(日期時間)
#      LET l_xcec.xcecud028 = '' #自定義欄位(日期時間)
#      LET l_xcec.xcecud029 = '' #自定義欄位(日期時間)
#      LET l_xcec.xcecud030 = '' #自定義欄位(日期時間)
      LET l_xcec.xcec107 = l_xceb.xceb107 #人員
      LET l_xcec.xcec108 = l_xceb.xceb108 #部門
      LET l_xcec.xcec109 = l_xceb.xceb109 #帳款對象
      LET l_xcec.xcec121 = l_xceb.xceb121 #自由核算項1
      LET l_xcec.xcec122 = l_xceb.xceb122 #自由核算項2
      LET l_xcec.xcec123 = l_xceb.xceb123 #自由核算項3
      LET l_xcec.xcec124 = l_xceb.xceb124 #自由核算項4
      LET l_xcec.xcec125 = l_xceb.xceb125 #自由核算項5
      LET l_xcec.xcec126 = l_xceb.xceb126 #自由核算項6
      LET l_xcec.xcec127 = l_xceb.xceb127 #自由核算項7
      LET l_xcec.xcec128 = l_xceb.xceb128 #自由核算項8
      LET l_xcec.xcec129 = l_xceb.xceb129 #自由核算項9
      LET l_xcec.xcec130 = l_xceb.xceb130 #自由核算項10
      
      
      CALL axct701_01_default_space_xcec(l_xcec.*) RETURNING l_xcec.xcec005,   
                                                             l_xcec.xcec101,
                                                             l_xcec.xcec102,
                                                             l_xcec.xcec103,
                                                             l_xcec.xcec110,
                                                             l_xcec.xcec111,
                                                             l_xcec.xcec112,
                                                             l_xcec.xcec113,
                                                             l_xcec.xcec114,
                                                             l_xcec.xcec115,
                                                             l_xcec.xcec116,
                                                             l_xcec.xcec117,
                                                             l_xcec.xcec118,
                                                             l_xcec.xcec119,
                                                             l_xcec.xcec120,
                                                             l_xcec.xcec107,
                                                             l_xcec.xcec108,
                                                             l_xcec.xcec109,
                                                             l_xcec.xcec121,
                                                             l_xcec.xcec122,
                                                             l_xcec.xcec123,
                                                             l_xcec.xcec124,
                                                             l_xcec.xcec125,
                                                             l_xcec.xcec126,
                                                             l_xcec.xcec127,
                                                             l_xcec.xcec128,
                                                             l_xcec.xcec129,
                                                             l_xcec.xcec130           
#如果金额和数量都为0的话，则不产生此笔单身数据                                                             
      IF l_xcec.xcec201= 0 AND l_xcec.xcec202 = 0 THEN
         CONTINUE FOREACH
      END IF       
      #161109-00085#20-s mod      
#      INSERT INTO xcec_t VALUES(l_xcec.*)   #161109-00085#20-s mark
      #161109-00085#63 --s mark
      #INSERT INTO xcec_t(xcecent,xceccomp,xcecld,xcecdocno,xcecseq,xcec001,xcec002,xcec003,xcec004,
      #                   xcec005,xcec101,xcec102,xcec103,xcec110,xcec111,xcec112,xcec113,xcec114,
      #                   xcec115,xcec116,xcec117,xcec118,xcec119,xcec120,xcec201,xcec202,xcec202a,
      #                   xcec202b,xcec202c,xcec202d,xcec202e,xcec202f,xcec202g,xcec202h,xcec212,
      #                   xcec212a,xcec212b,xcec212c,xcec212d,xcec212e,xcec212f,xcec212g,xcec212h,
      #                   xcec222,xcec222a,xcec222b,xcec222c,xcec222d,xcec222e,xcec222f,xcec222g,
      #                   xcec222h,xcec301,xcec302,xcec107,xcec108,xcec109,xcec121,xcec122,xcec123,
      #                   xcec124,xcec125,xcec126,xcec127,xcec128,xcec129,xcec130) 
      #            VALUES(l_xcec.xcecent,l_xcec.xceccomp,l_xcec.xcecld,l_xcec.xcecdocno,l_xcec.xcecseq,
      #                   l_xcec.xcec001,l_xcec.xcec002,l_xcec.xcec003,l_xcec.xcec004,l_xcec.xcec005,
      #                   l_xcec.xcec101,l_xcec.xcec102,l_xcec.xcec103,l_xcec.xcec110,l_xcec.xcec111,
      #                   l_xcec.xcec112,l_xcec.xcec113,l_xcec.xcec114,l_xcec.xcec115,l_xcec.xcec116,
      #                   l_xcec.xcec117,l_xcec.xcec118,l_xcec.xcec119,l_xcec.xcec120,l_xcec.xcec201,
      #                   l_xcec.xcec202,l_xcec.xcec202a,l_xcec.xcec202b,l_xcec.xcec202c,l_xcec.xcec202d,
      #                   l_xcec.xcec202e,l_xcec.xcec202f,l_xcec.xcec202g,l_xcec.xcec202h,l_xcec.xcec212,
      #                   l_xcec.xcec212a,l_xcec.xcec212b,l_xcec.xcec212c,l_xcec.xcec212d,l_xcec.xcec212e,
      #                   l_xcec.xcec212f,l_xcec.xcec212g,l_xcec.xcec212h,l_xcec.xcec222,l_xcec.xcec222a,
      #                   l_xcec.xcec222b,l_xcec.xcec222c,l_xcec.xcec222d,l_xcec.xcec222e,l_xcec.xcec222f,
      #                   l_xcec.xcec222g,l_xcec.xcec222h,l_xcec.xcec301,l_xcec.xcec302,l_xcec.xcec107,
      #                   l_xcec.xcec108,l_xcec.xcec109,l_xcec.xcec121,l_xcec.xcec122,l_xcec.xcec123,
      #                   l_xcec.xcec124,l_xcec.xcec125,l_xcec.xcec126,l_xcec.xcec127,l_xcec.xcec128,
      #                   l_xcec.xcec129,l_xcec.xcec130)
      #161109-00085#63 --e mark
      #161109-00085#20-e mod
      #161109-00085#63 --s add
      INSERT INTO xcec_t(xcecent,xceccomp,xcecld,xcecdocno,xcecseq,
                         xcec001,xcec002,xcec003,xcec004,xcec005,
                         xcec101,xcec102,xcec103,xcec110,xcec111,
                         xcec112,xcec113,xcec114,xcec115,xcec116,
                         xcec117,xcec118,xcec119,xcec120,xcec201,
                         xcec202,xcec202a,xcec202b,xcec202c,xcec202d,
                         xcec202e,xcec202f,xcec202g,xcec202h,xcec212,
                         xcec212a,xcec212b,xcec212c,xcec212d,xcec212e,
                         xcec212f,xcec212g,xcec212h,xcec222,xcec222a,
                         xcec222b,xcec222c,xcec222d,xcec222e,xcec222f,
                         xcec222g,xcec222h,xcec301,xcec302,xcecud001,
                         xcecud002,xcecud003,xcecud004,xcecud005,xcecud006,
                         xcecud007,xcecud008,xcecud009,xcecud010,xcecud011,
                         xcecud012,xcecud013,xcecud014,xcecud015,xcecud016,
                         xcecud017,xcecud018,xcecud019,xcecud020,xcecud021,
                         xcecud022,xcecud023,xcecud024,xcecud025,xcecud026,
                         xcecud027,xcecud028,xcecud029,xcecud030,xcec107,
                         xcec108,xcec109,xcec121,xcec122,xcec123,
                         xcec124,xcec125,xcec126,xcec127,xcec128,
                         xcec129,xcec130)
      VALUES(l_xcec.xcecent,l_xcec.xceccomp,l_xcec.xcecld,l_xcec.xcecdocno,l_xcec.xcecseq,
             l_xcec.xcec001,l_xcec.xcec002,l_xcec.xcec003,l_xcec.xcec004,l_xcec.xcec005,
             l_xcec.xcec101,l_xcec.xcec102,l_xcec.xcec103,l_xcec.xcec110,l_xcec.xcec111,
             l_xcec.xcec112,l_xcec.xcec113,l_xcec.xcec114,l_xcec.xcec115,l_xcec.xcec116,
             l_xcec.xcec117,l_xcec.xcec118,l_xcec.xcec119,l_xcec.xcec120,l_xcec.xcec201,
             l_xcec.xcec202,l_xcec.xcec202a,l_xcec.xcec202b,l_xcec.xcec202c,l_xcec.xcec202d,
             l_xcec.xcec202e,l_xcec.xcec202f,l_xcec.xcec202g,l_xcec.xcec202h,l_xcec.xcec212,
             l_xcec.xcec212a,l_xcec.xcec212b,l_xcec.xcec212c,l_xcec.xcec212d,l_xcec.xcec212e,
             l_xcec.xcec212f,l_xcec.xcec212g,l_xcec.xcec212h,l_xcec.xcec222,l_xcec.xcec222a,
             l_xcec.xcec222b,l_xcec.xcec222c,l_xcec.xcec222d,l_xcec.xcec222e,l_xcec.xcec222f,
             l_xcec.xcec222g,l_xcec.xcec222h,l_xcec.xcec301,l_xcec.xcec302,l_xcec.xcecud001,
             l_xcec.xcecud002,l_xcec.xcecud003,l_xcec.xcecud004,l_xcec.xcecud005,l_xcec.xcecud006,
             l_xcec.xcecud007,l_xcec.xcecud008,l_xcec.xcecud009,l_xcec.xcecud010,l_xcec.xcecud011,
             l_xcec.xcecud012,l_xcec.xcecud013,l_xcec.xcecud014,l_xcec.xcecud015,l_xcec.xcecud016,
             l_xcec.xcecud017,l_xcec.xcecud018,l_xcec.xcecud019,l_xcec.xcecud020,l_xcec.xcecud021,
             l_xcec.xcecud022,l_xcec.xcecud023,l_xcec.xcecud024,l_xcec.xcecud025,l_xcec.xcecud026,
             l_xcec.xcecud027,l_xcec.xcecud028,l_xcec.xcecud029,l_xcec.xcecud030,l_xcec.xcec107,
             l_xcec.xcec108,l_xcec.xcec109,l_xcec.xcec121,l_xcec.xcec122,l_xcec.xcec123,
             l_xcec.xcec124,l_xcec.xcec125,l_xcec.xcec126,l_xcec.xcec127,l_xcec.xcec128,
             l_xcec.xcec129,l_xcec.xcec130)
      #161109-00085#63 --e add
      
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "ins xcec"
         LET g_errparam.popup = TRUE
         CALL cl_err()
         LET g_success = 'N'
         EXIT FOREACH
      END IF
      
      INITIALIZE l_xceb.* TO NULL #161229-00044#1
      
   END FOREACH   
   RETURN g_success
END FUNCTION

################################################################################
# Descriptions...: 项目结转凭证
# Memo...........: 2016-2-15 zhujing
################################################################################
PRIVATE FUNCTION axct701_01_ins_14()
DEFINE l_success       LIKE type_t.num5
DEFINE l_errno         LIKE gzze_t.gzze001
#161109-00085#19-s mod
#DEFINE l_xcea          RECORD LIKE xcea_t.*   #161109-00085#19-s mark
DEFINE l_xcea          RECORD  #工單發料成本憑證單頭檔
       xceaent LIKE xcea_t.xceaent, #企業編號
       xceacomp LIKE xcea_t.xceacomp, #法人組織
       xceald LIKE xcea_t.xceald, #帳套
       xceadocno LIKE xcea_t.xceadocno, #單據編號
       xcea001 LIKE xcea_t.xcea001, #單據日期
       xcea002 LIKE xcea_t.xcea002, #成本憑證類型
       xcea003 LIKE xcea_t.xcea003, #成本計算類型
       xcea004 LIKE xcea_t.xcea004, #年度
       xcea005 LIKE xcea_t.xcea005, #期別
       xcea006 LIKE xcea_t.xcea006, #帳務人員
       xcea007 LIKE xcea_t.xcea007, #帳務部門
       xcea101 LIKE xcea_t.xcea101, #憑證編號
       xcea102 LIKE xcea_t.xcea102, #憑證日期
       xceaownid LIKE xcea_t.xceaownid, #資料所有者
       xceaowndp LIKE xcea_t.xceaowndp, #資料所屬部門
       xceacrtid LIKE xcea_t.xceacrtid, #資料建立者
       xceacrtdp LIKE xcea_t.xceacrtdp, #資料建立部門
       xceacrtdt LIKE xcea_t.xceacrtdt, #資料創建日
       xceamodid LIKE xcea_t.xceamodid, #資料修改者
       xceamoddt LIKE xcea_t.xceamoddt, #最近修改日
       xceacnfid LIKE xcea_t.xceacnfid, #資料確認者
       xceacnfdt LIKE xcea_t.xceacnfdt, #資料確認日
       xceapstid LIKE xcea_t.xceapstid, #資料過帳者
       xceapstdt LIKE xcea_t.xceapstdt, #資料過帳日
       xceastus LIKE xcea_t.xceastus, #狀態碼
       #161109-00085#63 --s add
       xceaud001 LIKE xcea_t.xceaud001, #自定義欄位(文字)001
       xceaud002 LIKE xcea_t.xceaud002, #自定義欄位(文字)002
       xceaud003 LIKE xcea_t.xceaud003, #自定義欄位(文字)003
       xceaud004 LIKE xcea_t.xceaud004, #自定義欄位(文字)004
       xceaud005 LIKE xcea_t.xceaud005, #自定義欄位(文字)005
       xceaud006 LIKE xcea_t.xceaud006, #自定義欄位(文字)006
       xceaud007 LIKE xcea_t.xceaud007, #自定義欄位(文字)007
       xceaud008 LIKE xcea_t.xceaud008, #自定義欄位(文字)008
       xceaud009 LIKE xcea_t.xceaud009, #自定義欄位(文字)009
       xceaud010 LIKE xcea_t.xceaud010, #自定義欄位(文字)010
       xceaud011 LIKE xcea_t.xceaud011, #自定義欄位(數字)011
       xceaud012 LIKE xcea_t.xceaud012, #自定義欄位(數字)012
       xceaud013 LIKE xcea_t.xceaud013, #自定義欄位(數字)013
       xceaud014 LIKE xcea_t.xceaud014, #自定義欄位(數字)014
       xceaud015 LIKE xcea_t.xceaud015, #自定義欄位(數字)015
       xceaud016 LIKE xcea_t.xceaud016, #自定義欄位(數字)016
       xceaud017 LIKE xcea_t.xceaud017, #自定義欄位(數字)017
       xceaud018 LIKE xcea_t.xceaud018, #自定義欄位(數字)018
       xceaud019 LIKE xcea_t.xceaud019, #自定義欄位(數字)019
       xceaud020 LIKE xcea_t.xceaud020, #自定義欄位(數字)020
       xceaud021 LIKE xcea_t.xceaud021, #自定義欄位(日期時間)021
       xceaud022 LIKE xcea_t.xceaud022, #自定義欄位(日期時間)022
       xceaud023 LIKE xcea_t.xceaud023, #自定義欄位(日期時間)023
       xceaud024 LIKE xcea_t.xceaud024, #自定義欄位(日期時間)024
       xceaud025 LIKE xcea_t.xceaud025, #自定義欄位(日期時間)025
       xceaud026 LIKE xcea_t.xceaud026, #自定義欄位(日期時間)026
       xceaud027 LIKE xcea_t.xceaud027, #自定義欄位(日期時間)027
       xceaud028 LIKE xcea_t.xceaud028, #自定義欄位(日期時間)028
       xceaud029 LIKE xcea_t.xceaud029, #自定義欄位(日期時間)029
       xceaud030 LIKE xcea_t.xceaud030, #自定義欄位(日期時間)030
       #161109-00085#63 --e add
       xceasite LIKE xcea_t.xceasite  #營運據點
          END RECORD
#161109-00085#19-e mod
#161109-00085#19-s mod
#DEFINE l_xceb          RECORD LIKE xceb_t.*   #161109-00085#19-s mark
DEFINE l_xceb          RECORD  #成本憑證第一單身檔
       xcebent LIKE xceb_t.xcebent, #企業編號
       xcebcomp LIKE xceb_t.xcebcomp, #法人組織
       xcebld LIKE xceb_t.xcebld, #帳套
       xcebdocno LIKE xceb_t.xcebdocno, #單據編號
       xcebseq LIKE xceb_t.xcebseq, #項次
       xceb001 LIKE xceb_t.xceb001, #參考單據編號
       xceb002 LIKE xceb_t.xceb002, #參考單據項次
       xceb003 LIKE xceb_t.xceb003, #單據類型
       xceb004 LIKE xceb_t.xceb004, #料件編號
       xceb005 LIKE xceb_t.xceb005, #特性
       xceb101 LIKE xceb_t.xceb101, #科目編號
       xceb102 LIKE xceb_t.xceb102, #摘要
       xceb103 LIKE xceb_t.xceb103, #成本域
       xceb110 LIKE xceb_t.xceb110, #原因碼
       xceb111 LIKE xceb_t.xceb111, #收付款客商
       xceb112 LIKE xceb_t.xceb112, #客群
       xceb113 LIKE xceb_t.xceb113, #區域
       xceb114 LIKE xceb_t.xceb114, #成本中心
       xceb115 LIKE xceb_t.xceb115, #經營類別
       xceb116 LIKE xceb_t.xceb116, #通路
       xceb117 LIKE xceb_t.xceb117, #品類
       xceb118 LIKE xceb_t.xceb118, #品牌
       xceb119 LIKE xceb_t.xceb119, #專案號
       xceb120 LIKE xceb_t.xceb120, #WBS
       xceb201 LIKE xceb_t.xceb201, #數量
       xceb202 LIKE xceb_t.xceb202, #成本金額(本位幣一)
       xceb202a LIKE xceb_t.xceb202a, #成本-材料(本位幣一)
       xceb202b LIKE xceb_t.xceb202b, #成本-人工(本位幣一)
       xceb202c LIKE xceb_t.xceb202c, #成本-加工(本位幣一)
       xceb202d LIKE xceb_t.xceb202d, #成本-制費一(本位幣一)
       xceb202e LIKE xceb_t.xceb202e, #成本-制費二(本位幣一)
       xceb202f LIKE xceb_t.xceb202f, #成本-制費三(本位幣一)
       xceb202g LIKE xceb_t.xceb202g, #成本-制費四(本位幣一)
       xceb202h LIKE xceb_t.xceb202h, #成本-制費五(本位幣一)
       xceb212 LIKE xceb_t.xceb212, #成本金額(本位幣二)
       xceb212a LIKE xceb_t.xceb212a, #成本-材料(本位幣二)
       xceb212b LIKE xceb_t.xceb212b, #成本-人工(本位幣二)
       xceb212c LIKE xceb_t.xceb212c, #成本-加工(本位幣二)
       xceb212d LIKE xceb_t.xceb212d, #成本-制費一(本位幣二)
       xceb212e LIKE xceb_t.xceb212e, #成本-制費二(本位幣二)
       xceb212f LIKE xceb_t.xceb212f, #成本-制費三(本位幣二)
       xceb212g LIKE xceb_t.xceb212g, #成本-制費四(本位幣二)
       xceb212h LIKE xceb_t.xceb212h, #成本-制費五(本位幣二)
       xceb222 LIKE xceb_t.xceb222, #成本金額(本位幣三)
       xceb222a LIKE xceb_t.xceb222a, #成本-材料(本位幣三)
       xceb222b LIKE xceb_t.xceb222b, #成本-人工(本位幣三)
       xceb222c LIKE xceb_t.xceb222c, #成本-加工(本位幣三)
       xceb222d LIKE xceb_t.xceb222d, #成本-制費一(本位幣三)
       xceb222e LIKE xceb_t.xceb222e, #成本-制費二(本位幣三)
       xceb222f LIKE xceb_t.xceb222f, #成本-制費三(本位幣三)
       xceb222g LIKE xceb_t.xceb222g, #成本-制費四(本位幣三)
       xceb222h LIKE xceb_t.xceb222h, #成本-制費五(本位幣三)
       xceb301 LIKE xceb_t.xceb301, #憑證編號
       xceb302 LIKE xceb_t.xceb302, #憑證項次
       #161109-00085#63 --s add  
       xcebud001 LIKE xceb_t.xcebud001, #自定義欄位(文字)001
       xcebud002 LIKE xceb_t.xcebud002, #自定義欄位(文字)002
       xcebud003 LIKE xceb_t.xcebud003, #自定義欄位(文字)003
       xcebud004 LIKE xceb_t.xcebud004, #自定義欄位(文字)004
       xcebud005 LIKE xceb_t.xcebud005, #自定義欄位(文字)005
       xcebud006 LIKE xceb_t.xcebud006, #自定義欄位(文字)006
       xcebud007 LIKE xceb_t.xcebud007, #自定義欄位(文字)007
       xcebud008 LIKE xceb_t.xcebud008, #自定義欄位(文字)008
       xcebud009 LIKE xceb_t.xcebud009, #自定義欄位(文字)009
       xcebud010 LIKE xceb_t.xcebud010, #自定義欄位(文字)010
       xcebud011 LIKE xceb_t.xcebud011, #自定義欄位(數字)011
       xcebud012 LIKE xceb_t.xcebud012, #自定義欄位(數字)012
       xcebud013 LIKE xceb_t.xcebud013, #自定義欄位(數字)013
       xcebud014 LIKE xceb_t.xcebud014, #自定義欄位(數字)014
       xcebud015 LIKE xceb_t.xcebud015, #自定義欄位(數字)015
       xcebud016 LIKE xceb_t.xcebud016, #自定義欄位(數字)016
       xcebud017 LIKE xceb_t.xcebud017, #自定義欄位(數字)017
       xcebud018 LIKE xceb_t.xcebud018, #自定義欄位(數字)018
       xcebud019 LIKE xceb_t.xcebud019, #自定義欄位(數字)019
       xcebud020 LIKE xceb_t.xcebud020, #自定義欄位(數字)020
       xcebud021 LIKE xceb_t.xcebud021, #自定義欄位(日期時間)021
       xcebud022 LIKE xceb_t.xcebud022, #自定義欄位(日期時間)022
       xcebud023 LIKE xceb_t.xcebud023, #自定義欄位(日期時間)023
       xcebud024 LIKE xceb_t.xcebud024, #自定義欄位(日期時間)024
       xcebud025 LIKE xceb_t.xcebud025, #自定義欄位(日期時間)025
       xcebud026 LIKE xceb_t.xcebud026, #自定義欄位(日期時間)026
       xcebud027 LIKE xceb_t.xcebud027, #自定義欄位(日期時間)027
       xcebud028 LIKE xceb_t.xcebud028, #自定義欄位(日期時間)028
       xcebud029 LIKE xceb_t.xcebud029, #自定義欄位(日期時間)029
       xcebud030 LIKE xceb_t.xcebud030, #自定義欄位(日期時間)030
       #161109-00085#63 --e add
       xceb107 LIKE xceb_t.xceb107, #人員
       xceb108 LIKE xceb_t.xceb108, #部門
       xceb109 LIKE xceb_t.xceb109, #帳款對象
       xceb121 LIKE xceb_t.xceb121, #自由核算項1
       xceb122 LIKE xceb_t.xceb122, #自由核算項2
       xceb123 LIKE xceb_t.xceb123, #自由核算項3
       xceb124 LIKE xceb_t.xceb124, #自由核算項4
       xceb125 LIKE xceb_t.xceb125, #自由核算項5
       xceb126 LIKE xceb_t.xceb126, #自由核算項6
       xceb127 LIKE xceb_t.xceb127, #自由核算項7
       xceb128 LIKE xceb_t.xceb128, #自由核算項8
       xceb129 LIKE xceb_t.xceb129, #自由核算項9
       xceb130 LIKE xceb_t.xceb130, #自由核算項10
       xceb131 LIKE xceb_t.xceb131, #單據類型(for 流通)
       xceb132 LIKE xceb_t.xceb132  #單據日期(for 流通)
          END RECORD
#161109-00085#19-e mod
#161109-00085#19-s mod
#DEFINE l_xcec          RECORD LIKE xcec_t.*   #161109-00085#18-s mark
DEFINE l_xcec          RECORD  #成本憑證第二單身檔
       xcecent LIKE xcec_t.xcecent, #企業編號
       xceccomp LIKE xcec_t.xceccomp, #法人組織
       xcecld LIKE xcec_t.xcecld, #帳套
       xcecdocno LIKE xcec_t.xcecdocno, #單據編號
       xcecseq LIKE xcec_t.xcecseq, #項次
       xcec001 LIKE xcec_t.xcec001, #參考單據
       xcec002 LIKE xcec_t.xcec002, #參考單據項次
       xcec003 LIKE xcec_t.xcec003, #單據類型
       xcec004 LIKE xcec_t.xcec004, #料件編號
       xcec005 LIKE xcec_t.xcec005, #特性
       xcec101 LIKE xcec_t.xcec101, #科目編號
       xcec102 LIKE xcec_t.xcec102, #摘要
       xcec103 LIKE xcec_t.xcec103, #成本域
       xcec110 LIKE xcec_t.xcec110, #原因碼
       xcec111 LIKE xcec_t.xcec111, #收付款客商
       xcec112 LIKE xcec_t.xcec112, #客群
       xcec113 LIKE xcec_t.xcec113, #區域
       xcec114 LIKE xcec_t.xcec114, #成本中心
       xcec115 LIKE xcec_t.xcec115, #經營類別
       xcec116 LIKE xcec_t.xcec116, #通路
       xcec117 LIKE xcec_t.xcec117, #品類
       xcec118 LIKE xcec_t.xcec118, #品牌
       xcec119 LIKE xcec_t.xcec119, #專案號
       xcec120 LIKE xcec_t.xcec120, #WBS
       xcec201 LIKE xcec_t.xcec201, #數量
       xcec202 LIKE xcec_t.xcec202, #成本金額(本位幣一)
       xcec202a LIKE xcec_t.xcec202a, #成本-材料(本位幣一)
       xcec202b LIKE xcec_t.xcec202b, #成本-人工(本位幣一)
       xcec202c LIKE xcec_t.xcec202c, #成本-加工(本位幣一)
       xcec202d LIKE xcec_t.xcec202d, #成本-制費一(本位幣一)
       xcec202e LIKE xcec_t.xcec202e, #成本-制費二(本位幣一)
       xcec202f LIKE xcec_t.xcec202f, #成本-制費三(本位幣一)
       xcec202g LIKE xcec_t.xcec202g, #成本-制費四(本位幣一)
       xcec202h LIKE xcec_t.xcec202h, #成本-制費五(本位幣一)
       xcec212 LIKE xcec_t.xcec212, #成本-金額(本位幣二)
       xcec212a LIKE xcec_t.xcec212a, #成本-材料(本位幣二)
       xcec212b LIKE xcec_t.xcec212b, #成本-人工(本位幣二)
       xcec212c LIKE xcec_t.xcec212c, #成本-加工(本位幣二)
       xcec212d LIKE xcec_t.xcec212d, #成本-制費一(本位幣二)
       xcec212e LIKE xcec_t.xcec212e, #成本-制費二(本位幣二)
       xcec212f LIKE xcec_t.xcec212f, #成本-制費三(本位幣二)
       xcec212g LIKE xcec_t.xcec212g, #成本-制費四(本位幣二)
       xcec212h LIKE xcec_t.xcec212h, #成本-制費五(本位幣二)
       xcec222 LIKE xcec_t.xcec222, #成本-金額(本位幣三)
       xcec222a LIKE xcec_t.xcec222a, #成本-材料(本位幣三)
       xcec222b LIKE xcec_t.xcec222b, #成本-人工(本位幣三)
       xcec222c LIKE xcec_t.xcec222c, #成本-加工(本位幣三)
       xcec222d LIKE xcec_t.xcec222d, #成本-制費一(本位幣三)
       xcec222e LIKE xcec_t.xcec222e, #成本-制費二(本位幣三)
       xcec222f LIKE xcec_t.xcec222f, #成本-制費三(本位幣三)
       xcec222g LIKE xcec_t.xcec222g, #成本-制費四(本位幣三)
       xcec222h LIKE xcec_t.xcec222h, #成本-制費五(本位幣三)
       xcec301 LIKE xcec_t.xcec301, #憑證編號
       xcec302 LIKE xcec_t.xcec302, #憑證項次
       #161109-00085#63 --s add 
       xcecud001 LIKE xcec_t.xcecud001, #自定義欄位(文字)001
       xcecud002 LIKE xcec_t.xcecud002, #自定義欄位(文字)002
       xcecud003 LIKE xcec_t.xcecud003, #自定義欄位(文字)003
       xcecud004 LIKE xcec_t.xcecud004, #自定義欄位(文字)004
       xcecud005 LIKE xcec_t.xcecud005, #自定義欄位(文字)005
       xcecud006 LIKE xcec_t.xcecud006, #自定義欄位(文字)006
       xcecud007 LIKE xcec_t.xcecud007, #自定義欄位(文字)007
       xcecud008 LIKE xcec_t.xcecud008, #自定義欄位(文字)008
       xcecud009 LIKE xcec_t.xcecud009, #自定義欄位(文字)009
       xcecud010 LIKE xcec_t.xcecud010, #自定義欄位(文字)010
       xcecud011 LIKE xcec_t.xcecud011, #自定義欄位(數字)011
       xcecud012 LIKE xcec_t.xcecud012, #自定義欄位(數字)012
       xcecud013 LIKE xcec_t.xcecud013, #自定義欄位(數字)013
       xcecud014 LIKE xcec_t.xcecud014, #自定義欄位(數字)014
       xcecud015 LIKE xcec_t.xcecud015, #自定義欄位(數字)015
       xcecud016 LIKE xcec_t.xcecud016, #自定義欄位(數字)016
       xcecud017 LIKE xcec_t.xcecud017, #自定義欄位(數字)017
       xcecud018 LIKE xcec_t.xcecud018, #自定義欄位(數字)018
       xcecud019 LIKE xcec_t.xcecud019, #自定義欄位(數字)019
       xcecud020 LIKE xcec_t.xcecud020, #自定義欄位(數字)020
       xcecud021 LIKE xcec_t.xcecud021, #自定義欄位(日期時間)021
       xcecud022 LIKE xcec_t.xcecud022, #自定義欄位(日期時間)022
       xcecud023 LIKE xcec_t.xcecud023, #自定義欄位(日期時間)023
       xcecud024 LIKE xcec_t.xcecud024, #自定義欄位(日期時間)024
       xcecud025 LIKE xcec_t.xcecud025, #自定義欄位(日期時間)025
       xcecud026 LIKE xcec_t.xcecud026, #自定義欄位(日期時間)026
       xcecud027 LIKE xcec_t.xcecud027, #自定義欄位(日期時間)027
       xcecud028 LIKE xcec_t.xcecud028, #自定義欄位(日期時間)028
       xcecud029 LIKE xcec_t.xcecud029, #自定義欄位(日期時間)029
       xcecud030 LIKE xcec_t.xcecud030, #自定義欄位(日期時間)030
       #161109-00085#63 --e add
       xcec107 LIKE xcec_t.xcec107, #人員
       xcec108 LIKE xcec_t.xcec108, #部門
       xcec109 LIKE xcec_t.xcec109, #帳款對象
       xcec121 LIKE xcec_t.xcec121, #自由核算項1
       xcec122 LIKE xcec_t.xcec122, #自由核算項2
       xcec123 LIKE xcec_t.xcec123, #自由核算項3
       xcec124 LIKE xcec_t.xcec124, #自由核算項4
       xcec125 LIKE xcec_t.xcec125, #自由核算項5
       xcec126 LIKE xcec_t.xcec126, #自由核算項6
       xcec127 LIKE xcec_t.xcec127, #自由核算項7
       xcec128 LIKE xcec_t.xcec128, #自由核算項8
       xcec129 LIKE xcec_t.xcec129, #自由核算項9
       xcec130 LIKE xcec_t.xcec130  #自由核算項10
               END RECORD
#161109-00085#19-e mod
#161109-00085#19-s mod
#DEFINE l_pjdb          RECORD LIKE pjdb_t.*   #161109-00085#19-s mark
DEFINE l_pjdb          RECORD  #專案進度報告單身檔
       pjdbent LIKE pjdb_t.pjdbent, #企業編號         
       pjdbsite LIKE pjdb_t.pjdbsite, #營運據點
       pjdbdocno LIKE pjdb_t.pjdbdocno, #單據單號
       pjdbseq LIKE pjdb_t.pjdbseq, #項次
       pjdb001 LIKE pjdb_t.pjdb001, #專案編號
       pjdb002 LIKE pjdb_t.pjdb002, #客戶編號
       pjdb003 LIKE pjdb_t.pjdb003, #收款條件
       pjdb004 LIKE pjdb_t.pjdb004, #交易條件
       pjdb005 LIKE pjdb_t.pjdb005, #幣別
       pjdb006 LIKE pjdb_t.pjdb006, #匯率
       pjdb007 LIKE pjdb_t.pjdb007, #稅別
       pjdb008 LIKE pjdb_t.pjdb008, #含稅否
       pjdb009 LIKE pjdb_t.pjdb009, #稅率
       pjdb010 LIKE pjdb_t.pjdb010, #合約未稅金額
       pjdb011 LIKE pjdb_t.pjdb011, #合約含稅金額
       pjdb012 LIKE pjdb_t.pjdb012, #歷史進度%
       pjdb013 LIKE pjdb_t.pjdb013, #目前進度%
       pjdb014 LIKE pjdb_t.pjdb014, #本期進度%
       pjdb015 LIKE pjdb_t.pjdb015, #本期未稅金額
       pjdb016 LIKE pjdb_t.pjdb016, #本期含稅金額
       pjdb017 LIKE pjdb_t.pjdb017, #no use
       pjdb018 LIKE pjdb_t.pjdb018, #no use
       pjdb019 LIKE pjdb_t.pjdb019, #no use
       pjdb020 LIKE pjdb_t.pjdb020, #no use
       pjdb021 LIKE pjdb_t.pjdb021, #no use
       pjdb022 LIKE pjdb_t.pjdb022, #no use
       pjdb023 LIKE pjdb_t.pjdb023, #no use
       pjdb024 LIKE pjdb_t.pjdb024, #no use
       pjdb025 LIKE pjdb_t.pjdb025, #no use
       #161109-00085#63 --s add       
       pjdbud001 LIKE pjdb_t.pjdbud001, #自定義欄位(文字)001
       pjdbud002 LIKE pjdb_t.pjdbud002, #自定義欄位(文字)002
       pjdbud003 LIKE pjdb_t.pjdbud003, #自定義欄位(文字)003
       pjdbud004 LIKE pjdb_t.pjdbud004, #自定義欄位(文字)004
       pjdbud005 LIKE pjdb_t.pjdbud005, #自定義欄位(文字)005
       pjdbud006 LIKE pjdb_t.pjdbud006, #自定義欄位(文字)006
       pjdbud007 LIKE pjdb_t.pjdbud007, #自定義欄位(文字)007
       pjdbud008 LIKE pjdb_t.pjdbud008, #自定義欄位(文字)008
       pjdbud009 LIKE pjdb_t.pjdbud009, #自定義欄位(文字)009
       pjdbud010 LIKE pjdb_t.pjdbud010, #自定義欄位(文字)010
       pjdbud011 LIKE pjdb_t.pjdbud011, #自定義欄位(數字)011
       pjdbud012 LIKE pjdb_t.pjdbud012, #自定義欄位(數字)012
       pjdbud013 LIKE pjdb_t.pjdbud013, #自定義欄位(數字)013
       pjdbud014 LIKE pjdb_t.pjdbud014, #自定義欄位(數字)014
       pjdbud015 LIKE pjdb_t.pjdbud015, #自定義欄位(數字)015
       pjdbud016 LIKE pjdb_t.pjdbud016, #自定義欄位(數字)016
       pjdbud017 LIKE pjdb_t.pjdbud017, #自定義欄位(數字)017
       pjdbud018 LIKE pjdb_t.pjdbud018, #自定義欄位(數字)018
       pjdbud019 LIKE pjdb_t.pjdbud019, #自定義欄位(數字)019
       pjdbud020 LIKE pjdb_t.pjdbud020, #自定義欄位(數字)020
       pjdbud021 LIKE pjdb_t.pjdbud021, #自定義欄位(日期時間)021
       pjdbud022 LIKE pjdb_t.pjdbud022, #自定義欄位(日期時間)022
       pjdbud023 LIKE pjdb_t.pjdbud023, #自定義欄位(日期時間)023
       pjdbud024 LIKE pjdb_t.pjdbud024, #自定義欄位(日期時間)024
       pjdbud025 LIKE pjdb_t.pjdbud025, #自定義欄位(日期時間)025
       pjdbud026 LIKE pjdb_t.pjdbud026, #自定義欄位(日期時間)026
       pjdbud027 LIKE pjdb_t.pjdbud027, #自定義欄位(日期時間)027
       pjdbud028 LIKE pjdb_t.pjdbud028, #自定義欄位(日期時間)028
       pjdbud029 LIKE pjdb_t.pjdbud029, #自定義欄位(日期時間)029
       pjdbud030 LIKE pjdb_t.pjdbud030, #自定義欄位(日期時間)030
       #161109-00085#63 --e add
       pjdb026 LIKE pjdb_t.pjdb026, #專案預估成本-材料   
       pjdb027 LIKE pjdb_t.pjdb027, #專案預估成本-人工
       pjdb028 LIKE pjdb_t.pjdb028, #專案預估成本-加工费
       pjdb029 LIKE pjdb_t.pjdb029, #專案預估成本-制费一
       pjdb030 LIKE pjdb_t.pjdb030, #專案預估成本-制费二
       pjdb031 LIKE pjdb_t.pjdb031, #專案預估成本-制费三
       pjdb032 LIKE pjdb_t.pjdb032, #專案預估成本-制费四
       pjdb033 LIKE pjdb_t.pjdb033, #專案預估成本-制费五
       pjdb034 LIKE pjdb_t.pjdb034, #前期累計成本-材料
       pjdb035 LIKE pjdb_t.pjdb035, #前期累計成本-人工
       pjdb036 LIKE pjdb_t.pjdb036, #前期累計成本-加工费
       pjdb037 LIKE pjdb_t.pjdb037, #前期累計成本-制费一
       pjdb038 LIKE pjdb_t.pjdb038, #前期累計成本-制费二
       pjdb039 LIKE pjdb_t.pjdb039, #前期累計成本-制费三
       pjdb040 LIKE pjdb_t.pjdb040, #前期累計成本-制费四
       pjdb041 LIKE pjdb_t.pjdb041, #前期累計成本-制费五
       pjdb042 LIKE pjdb_t.pjdb042, #本期結轉成本-材料
       pjdb043 LIKE pjdb_t.pjdb043, #本期結轉成本-人工
       pjdb044 LIKE pjdb_t.pjdb044, #本期結轉成本-加工费
       pjdb045 LIKE pjdb_t.pjdb045, #本期結轉成本-制费一
       pjdb046 LIKE pjdb_t.pjdb046, #本期結轉成本-制费二
       pjdb047 LIKE pjdb_t.pjdb047, #本期結轉成本-制费三
       pjdb048 LIKE pjdb_t.pjdb048, #本期結轉成本-制费四
       pjdb049 LIKE pjdb_t.pjdb049, #本期結轉成本-制费五
       pjdb050 LIKE pjdb_t.pjdb050  #出貨單號
          END RECORD
#161109-00085#19-e mod

DEFINE l_sql           STRING
DEFINE l_sql1          STRING
DEFINE l_rate          LIKE type_t.num26_10
DEFINE l_rate1         LIKE type_t.num26_10
DEFINE ld_date         DATETIME YEAR TO SECOND
DEFINE l_glaa001       LIKE glaa_t.glaa001
DEFINE l_glaacomp      LIKE glaa_t.glaacomp
DEFINE l_glaa003       LIKE glaa_t.glaa003
DEFINE l_bdate         LIKE pjda_t.pjdadocdt
DEFINE l_edate         LIKE pjda_t.pjdadocdt
DEFINE l_glaa017       LIKE glaa_t.glaa017
DEFINE l_glaa021       LIKE glaa_t.glaa021

   LET g_success = 'Y'
   LET l_xcea.xceaent   = g_enterprise
   LET l_xcea.xceacomp  = g_xcea_m.xceacomp
   LET l_xcea.xceald    = g_xcea_m.xceald
   LET l_xcea.xcea001   = g_xcea_m.xcea001
   LET l_xcea.xcea002   = g_xcea002   #13投入 14结转
   LET l_xcea.xcea003   = g_xcea_m.xcea003
   LET l_xcea.xcea004   = g_xcea_m.xcea004
   LET l_xcea.xcea005   = g_xcea_m.xcea005
   LET l_xcea.xcea006   = g_xcea_m.xcea006
   LET l_xcea.xcea007   = g_xcea_m.xcea007
   LET l_xcea.xcea101   = ''
   LET l_xcea.xcea102   = ''
   LET l_xcea.xceaownid = g_user
   LET l_xcea.xceaowndp = g_dept
   LET l_xcea.xceacrtid = g_user
   LET l_xcea.xceacrtdp = g_dept 
   LET ld_date = cl_get_current()
   LET l_xcea.xceacrtdt = ld_date
   LET l_xcea.xceamodid = ""
   LET l_xcea.xceamoddt = ""
   LET l_xcea.xceacnfid = ""
   LET l_xcea.xceacnfdt = ""
   LET l_xcea.xceapstid = ""
   LET l_xcea.xceapstdt = ""
   LET l_xcea.xceastus  = 'N'
   CALL s_aooi200_fin_gen_docno(g_xcea_m.xceald,'','',g_xcea_m.xceadocno,g_xcea_m.xcea001,g_prog_name1)      #wujie 150214
    RETURNING l_success,l_xcea.xceadocno
   IF l_success  = 0  THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = 'apm-00003'
      LET g_errparam.extend = g_xcea_m.xceadocno
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET g_success = 'N'
      RETURN g_success
   END IF
   #161109-00085#20-s mod
#   INSERT INTO xcea_t VALUES(l_xcea.*)   #161109-00085#20-s mark
   #161109-00085#63 --s mark
   #INSERT INTO xcea_t(xceaent,xceacomp,xceald,xceadocno,xcea001,xcea002,xcea003,xcea004,xcea005,
   #                   xcea006,xcea007,xcea101,xcea102,xceaownid,xceaowndp,xceacrtid,xceacrtdp,xceacrtdt,
   #                   xceamodid,xceamoddt,xceacnfid,xceacnfdt,xceapstid,xceapstdt,xceastus,xceasite) 
   #            VALUES(l_xcea.xceaent,l_xcea.xceacomp,l_xcea.xceald,l_xcea.xceadocno,l_xcea.xcea001,
   #                   l_xcea.xcea002,l_xcea.xcea003,l_xcea.xcea004,l_xcea.xcea005,l_xcea.xcea006,
   #                   l_xcea.xcea007,l_xcea.xcea101,l_xcea.xcea102,l_xcea.xceaownid,l_xcea.xceaowndp,
   #                   l_xcea.xceacrtid,l_xcea.xceacrtdp,l_xcea.xceacrtdt,l_xcea.xceamodid,l_xcea.xceamoddt,
   #                   l_xcea.xceacnfid,l_xcea.xceacnfdt,l_xcea.xceapstid,l_xcea.xceapstdt,l_xcea.xceastus,l_xcea.xceasite)
   #161109-00085#63 --e mark
   #161109-00085#20-e mod
   #161109-00085#63 --s add
   INSERT INTO xcea_t(xceaent,xceacomp,xceald,xceadocno,xcea001,
                      xcea002,xcea003,xcea004,xcea005,xcea006,
                      xcea007,xcea101,xcea102,xceaownid,xceaowndp,
                      xceacrtid,xceacrtdp,xceacrtdt,xceamodid,xceamoddt,
                      xceacnfid,xceacnfdt,xceapstid,xceapstdt,xceastus,
                      xceaud001,xceaud002,xceaud003,xceaud004,xceaud005,
                      xceaud006,xceaud007,xceaud008,xceaud009,xceaud010,
                      xceaud011,xceaud012,xceaud013,xceaud014,xceaud015,
                      xceaud016,xceaud017,xceaud018,xceaud019,xceaud020,
                      xceaud021,xceaud022,xceaud023,xceaud024,xceaud025,
                      xceaud026,xceaud027,xceaud028,xceaud029,xceaud030,
                      xceasite)
   VALUES(l_xcea.xceaent,l_xcea.xceacomp,l_xcea.xceald,l_xcea.xceadocno,l_xcea.xcea001,
          l_xcea.xcea002,l_xcea.xcea003,l_xcea.xcea004,l_xcea.xcea005,l_xcea.xcea006,
          l_xcea.xcea007,l_xcea.xcea101,l_xcea.xcea102,l_xcea.xceaownid,l_xcea.xceaowndp,
          l_xcea.xceacrtid,l_xcea.xceacrtdp,l_xcea.xceacrtdt,l_xcea.xceamodid,l_xcea.xceamoddt,
          l_xcea.xceacnfid,l_xcea.xceacnfdt,l_xcea.xceapstid,l_xcea.xceapstdt,l_xcea.xceastus,
          l_xcea.xceaud001,l_xcea.xceaud002,l_xcea.xceaud003,l_xcea.xceaud004,l_xcea.xceaud005,
          l_xcea.xceaud006,l_xcea.xceaud007,l_xcea.xceaud008,l_xcea.xceaud009,l_xcea.xceaud010,
          l_xcea.xceaud011,l_xcea.xceaud012,l_xcea.xceaud013,l_xcea.xceaud014,l_xcea.xceaud015,
          l_xcea.xceaud016,l_xcea.xceaud017,l_xcea.xceaud018,l_xcea.xceaud019,l_xcea.xceaud020,
          l_xcea.xceaud021,l_xcea.xceaud022,l_xcea.xceaud023,l_xcea.xceaud024,l_xcea.xceaud025,
          l_xcea.xceaud026,l_xcea.xceaud027,l_xcea.xceaud028,l_xcea.xceaud029,l_xcea.xceaud030,
          l_xcea.xceasite)
   #161109-00085#63 --e add
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "xcea_t"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET g_success = 'N'
      RETURN g_success
   END IF
   LET g_xcea_m.xceadocno = l_xcea.xceadocno
   
   #根据账套获取币别、所属法人、会计周期参照表
   SELECT glaa017,glaa021 INTO l_glaa017,l_glaa021
     FROM glaa_t
    WHERE glaaent = g_enterprise
      AND glaald = g_xcea_m.xceald
   
   #根据年度期别算出起止单据日期
   CALL s_fin_date_get_period_range(g_glaa003,g_xcea_m.xcea004,g_xcea_m.xcea005)
      RETURNING l_bdate,l_edate
      
   #xceb单身
     
   LET l_sql = " SELECT pjdb001,pjdb002,pjdb005,
                 SUM(COALESCE(pjdb014,0)),SUM(COALESCE(pjdb016,0)),",
               " SUM(COALESCE(pjdb042,0)),SUM(COALESCE(pjdb043,0)),SUM(COALESCE(pjdb044,0)),SUM(COALESCE(pjdb045,0)),",
               " SUM(COALESCE(pjdb046,0)),SUM(COALESCE(pjdb047,0)),SUM(COALESCE(pjdb048,0)),SUM(COALESCE(pjdb049,0))  ",
               " FROM pjdb_t ", 
               "  WHERE pjdbent  = '",g_enterprise,"' ",
#               "    AND pjdb005 = '",l_glaa001,"' ",
               "    AND pjdbdocno IN (SELECT pjdadocno FROM pjda_t WHERE pjdaent = ",g_enterprise,
               "    AND (pjdadocdt BETWEEN '",l_bdate,"' AND '",l_edate,"' )",
               "    AND pjdasite IN (SELECT ooef001 FROM ooef_t WHERE ooefent = ",g_enterprise," AND ooef201 = 'Y' AND ooef017 = '",g_xcea_m.xceacomp,"' )) ",    #160902-00048#3 add ent
               "  GROUP BY pjdb001,pjdb002,pjdb005 ",
               "  ORDER BY pjdb001,pjdb002,pjdb005 "
               
   PREPARE axct701_01_ins_14_p1 FROM l_sql
   DECLARE axct701_01_ins_14_c1 CURSOR FOR axct701_01_ins_14_p1
   FOREACH axct701_01_ins_14_c1 INTO l_pjdb.pjdb001,l_pjdb.pjdb002,l_pjdb.pjdb005,l_pjdb.pjdb014,l_pjdb.pjdb016,
                                     l_pjdb.pjdb042,l_pjdb.pjdb043,l_pjdb.pjdb044,l_pjdb.pjdb045,
                                     l_pjdb.pjdb046,l_pjdb.pjdb047,l_pjdb.pjdb048,l_pjdb.pjdb049      
      
      INITIALIZE l_xceb.* TO NULL
      
      #获取汇率
      IF g_glaa015 = 'Y' THEN
         IF l_glaa017='1' THEN #依交易原币
            CALL s_aooi160_get_exrate('2',g_xcea_m.xceald,g_xcea_m.xcea001,l_pjdb.pjdb005,
                                        #目的幣別;  交易金額;              匯類類型
                                         g_glaa016,0,g_glaa018)
               RETURNING l_rate
         ELSE #依账簿币别
            CALL s_aooi160_get_exrate('2',g_xcea_m.xceald,g_xcea_m.xcea001,g_glaa001,
                                         g_glaa016,0,g_glaa018)
               RETURNING l_rate
         END IF
      END IF
         
      IF g_glaa019 = 'Y' THEN
         IF l_glaa021='1' THEN #依交易原币
            CALL s_aooi160_get_exrate('2',g_xcea_m.xceald,g_xcea_m.xcea001,l_pjdb.pjdb005,
                                        #目的幣別;  交易金額;              匯類類型
                                         g_glaa016,0,g_glaa022)
               RETURNING l_rate1
         ELSE #依账簿币别
            CALL s_aooi160_get_exrate('2',g_xcea_m.xceald,g_xcea_m.xcea001,g_glaa001,
                                         g_glaa016,0,g_glaa022)
               RETURNING l_rate1
         END IF
      END IF         
      SELECT MAX(xcebseq) INTO l_xceb.xcebseq FROM xceb_t
       WHERE xcebent = g_enterprise AND xcebld = g_xcea_m.xceald
         AND xcebdocno = g_xcea_m.xceadocno
      IF cl_null(l_xceb.xcebseq) OR l_xceb.xcebseq = 0 THEN
         LET l_xceb.xcebseq = 1
      ELSE
         LET l_xceb.xcebseq = l_xceb.xcebseq + 1
      END IF 
      
      LET l_xceb.xcebent  = g_enterprise
      LET l_xceb.xcebcomp = g_xcea_m.xceacomp
      LET l_xceb.xcebld   = g_xcea_m.xceald
      LET l_xceb.xcebdocno= g_xcea_m.xceadocno
#      LET l_xceb.xceb001  = l_pjdb.pjdbdocno  #參考單據編號
#      LET l_xceb.xceb002  = l_pjdb.pjdbseq    #參考單據項次
      LET l_xceb.xceb003  = '2'             #單據類型--结转出
      
      #根据专案编号，抓取料件编号及特性
      SELECT DISTINCT xmdc001,xmdc002 INTO l_xceb.xceb004,l_xceb.xceb005
        FROM xmdc_t,xmda_t
       WHERE xmdcent = g_enterprise
         AND xmdadocno = xmdcdocno
         AND xmdcsite = g_site
         AND xmdaent = xmdcent 
         AND xmdc036 = l_pjdb.pjdb001
         AND xmdastus = 'Y'
#
#      LET l_xceb.xceb004  = l_xckb.xckb012  #料件編號
#      LET l_xceb.xceb005  = l_xckb.xckb037  #特性
      LET l_xceb.xceb119 = l_pjdb.pjdb001  #項目號
      LET l_xceb.xceb101 = ' '               #科目编号
#      IF g_xcea002='13' THEN   #13投入 14结转
         CALL s_fin_get_account(g_xcea_m.xceald,'60','8912','9') RETURNING l_success,l_xceb.xceb101,l_errno
#      ELSE
#         CALL s_fin_get_account(g_xcea_m.xceald,'60','8912','10') RETURNING l_success,l_xceb.xceb101,l_errno
#      END IF
      IF cl_null(l_xceb.xceb101) THEN LET l_xceb.xceb101 = ' ' END IF
      LET l_xceb.xceb102  = ' '              #摘要
      #摘要   
      IF g_xcea002='13' THEN   #13投入 14结转
         CALL axct701_01_get_summ(g_xcea_m.xceald,'61','8925','13') RETURNING l_success,l_xceb.xceb102
      ELSE
         CALL axct701_01_get_summ(g_xcea_m.xceald,'61','8925','14') RETURNING l_success,l_xceb.xceb102
      END IF
     
#      LET l_xceb.xceb103  = l_xckb.xckb038  #成本域
      LET l_xceb.xceb103 = ' '  #成本域
      LET l_xceb.xceb110 = ' '  #原因碼
      
      LET l_xceb.xceb111 = ' '  #交易對象
      LET l_xceb.xceb112 = ' '  #客群
      LET l_xceb.xceb113 = ' '  #區域
      LET l_xceb.xceb114 = ' '  #成本中心
      LET l_xceb.xceb115 = ' '  #經營類別
      LET l_xceb.xceb116 = ' '  #渠道
      
      LET l_xceb.xceb120 = ' '  #WBS
      LET l_xceb.xceb107 = ' '  #人员
      LET l_xceb.xceb108 = ' '  #部门
      SELECT DISTINCT xmdk008,pmaa090,xmdl222,ooeg004,xmdl216,xmdl200,xmdl031,xmdl213,xmdl214,xmdl018
        INTO l_xceb.xceb111,l_xceb.xceb112,l_xceb.xceb113,l_xceb.xceb114,l_xceb.xceb115,l_xceb.xceb116,l_xceb.xceb120,l_xceb.xceb107,l_xceb.xceb108,l_xceb.xceb201
        FROM xmdk_t LEFT JOIN pmaa_t ON pmaaent = xmdkent AND pmaa001=xmdk008 ,
             xmdl_t LEFT JOIN ooeg_t ON ooegent = xmdlent AND ooeg001=xmdl214 AND ooeg003='3' #成本中心
       WHERE xmdkent  = xmdlent
         AND xmdkdocno= xmdldocno
         AND xmdlent  = g_enterprise
         AND xmdl030 = l_pjdb.pjdb001     #专案编号
         AND xmdkstus = 'Y'
#         AND xmdldocno= l_xceb.xceb001
#         AND xmdlseq  = l_xceb.xceb002
      IF cl_null(l_xceb.xceb114) THEN LET l_xceb.xceb114 = l_xceb.xceb108 END IF  #成本中心为空就为部门
      LET l_xceb.xceb109 = l_xceb.xceb111  #账款对象

      LET l_xceb.xceb117 = ' '  #品類
      LET l_xceb.xceb118 = ' '  #品牌
      SELECT imaa009,imaa126 INTO l_xceb.xceb117,l_xceb.xceb118 FROM imaa_t
       WHERE imaaent = g_enterprise
         AND imaa001 = l_xceb.xceb004
      
      #161108-00040#1 add-S
      IF cl_null(l_pjdb.pjdb014) THEN LET l_pjdb.pjdb014 = 0 END IF
      IF cl_null(l_pjdb.pjdb042) THEN LET l_pjdb.pjdb042 = 0 END IF
      IF cl_null(l_pjdb.pjdb042) THEN LET l_pjdb.pjdb042 = 0 END IF
      IF cl_null(l_pjdb.pjdb043) THEN LET l_pjdb.pjdb043 = 0 END IF
      IF cl_null(l_pjdb.pjdb044) THEN LET l_pjdb.pjdb044 = 0 END IF
      IF cl_null(l_pjdb.pjdb045) THEN LET l_pjdb.pjdb045 = 0 END IF
      IF cl_null(l_pjdb.pjdb046) THEN LET l_pjdb.pjdb046 = 0 END IF
      IF cl_null(l_pjdb.pjdb047) THEN LET l_pjdb.pjdb047 = 0 END IF
      IF cl_null(l_pjdb.pjdb048) THEN LET l_pjdb.pjdb048 = 0 END IF                            
      IF cl_null(l_pjdb.pjdb049) THEN LET l_pjdb.pjdb049 = 0 END IF
      #161108-00040#1 add-E
#      LET l_xceb.xceb201  = l_pjdb.pjdb014     #结转数量:本期完工进度    #161108-00040#1 marked
      LET l_xceb.xceb201  = l_pjdb.pjdb014/100  #结转数量:本期完工进度    #161108-00040#1 add 作为进度
#      LET l_xceb.xceb202  = l_pjdb.pjdb016  #成本金額(本位幣一)           #161108-00040#1 marked
      LET l_xceb.xceb202  = l_pjdb.pjdb042+l_pjdb.pjdb043+l_pjdb.pjdb044+l_pjdb.pjdb045+l_pjdb.pjdb046+l_pjdb.pjdb047+l_pjdb.pjdb048+l_pjdb.pjdb049 #成本金額(本位幣一)           #161108-00040#1 add
      LET l_xceb.xceb202a = l_pjdb.pjdb042  #成本-材料(本位幣一)
      LET l_xceb.xceb202b = l_pjdb.pjdb043  #成本-人工(本位幣一)
      LET l_xceb.xceb202c = l_pjdb.pjdb044  #成本-加工(本位幣一)
      LET l_xceb.xceb202d = l_pjdb.pjdb045  #成本-制費一(本位幣一)
      LET l_xceb.xceb202e = l_pjdb.pjdb046  #成本-制費二(本位幣一)
      LET l_xceb.xceb202f = l_pjdb.pjdb047  #成本-制費三(本位幣一)
      LET l_xceb.xceb202g = l_pjdb.pjdb048  #成本-制費四(本位幣一)
      LET l_xceb.xceb202h = l_pjdb.pjdb049  #成本-制費五(本位幣一)
      
      #本位幣二
      IF g_glaa015 = 'Y' THEN
         LET l_xceb.xceb212 = l_xceb.xceb202*l_rate #成本金额(本位幣二)
         LET l_xceb.xceb212a = l_xceb.xceb202a*l_rate #成本-材料(本位幣二)
         LET l_xceb.xceb212b = l_xceb.xceb202b*l_rate #成本-人工(本位幣二)
         LET l_xceb.xceb212c = l_xceb.xceb202c*l_rate #成本-加工(本位幣二)
         LET l_xceb.xceb212d = l_xceb.xceb202d*l_rate #成本-制費一(本位幣二)
         LET l_xceb.xceb212e = l_xceb.xceb202e*l_rate  #成本-制費二(本位幣二)
         LET l_xceb.xceb212f = l_xceb.xceb202f*l_rate  #成本-制費三(本位幣二)
         LET l_xceb.xceb212g = l_xceb.xceb202g*l_rate  #成本-制費四(本位幣二)
         LET l_xceb.xceb212h = l_xceb.xceb202h*l_rate  #成本-制費五(本位幣二)
                   
         IF cl_null(l_xceb.xceb212) THEN LET l_xceb.xceb212 = 0 END IF
         IF cl_null(l_xceb.xceb212a) THEN LET l_xceb.xceb212a = 0 END IF
         IF cl_null(l_xceb.xceb212b) THEN LET l_xceb.xceb212b = 0 END IF
         IF cl_null(l_xceb.xceb212c) THEN LET l_xceb.xceb212c = 0 END IF
         IF cl_null(l_xceb.xceb212d) THEN LET l_xceb.xceb212d = 0 END IF
         IF cl_null(l_xceb.xceb212e) THEN LET l_xceb.xceb212e = 0 END IF
         IF cl_null(l_xceb.xceb212f) THEN LET l_xceb.xceb212f = 0 END IF
         IF cl_null(l_xceb.xceb212g) THEN LET l_xceb.xceb212g = 0 END IF
         IF cl_null(l_xceb.xceb212h) THEN LET l_xceb.xceb212h = 0 END IF                            
         IF cl_null(l_xceb.xceb212)  THEN LET l_xceb.xceb212  = 0 END IF
      ELSE
         LET l_xceb.xceb212a = 0
         LET l_xceb.xceb212b = 0
         LET l_xceb.xceb212c = 0
         LET l_xceb.xceb212d = 0
         LET l_xceb.xceb212e = 0
         LET l_xceb.xceb212f = 0
         LET l_xceb.xceb212g = 0
         LET l_xceb.xceb212h = 0                            
         LET l_xceb.xceb212  = 0      
      END IF

      #本位幣三
      IF g_glaa019 = 'Y' THEN  
         LET l_xceb.xceb222a = l_xceb.xceb202a*l_rate1
         LET l_xceb.xceb222b = l_xceb.xceb202b*l_rate1
         LET l_xceb.xceb222c = l_xceb.xceb202c*l_rate1
         LET l_xceb.xceb222d = l_xceb.xceb202d*l_rate1
         LET l_xceb.xceb222e = l_xceb.xceb202e*l_rate1
         LET l_xceb.xceb222f = l_xceb.xceb202f*l_rate1
         LET l_xceb.xceb222g = l_xceb.xceb202g*l_rate1
         LET l_xceb.xceb222h = l_xceb.xceb202h*l_rate1
          
         IF cl_null(l_xceb.xceb222a) THEN LET l_xceb.xceb222a = 0 END IF
         IF cl_null(l_xceb.xceb222b) THEN LET l_xceb.xceb222b = 0 END IF
         IF cl_null(l_xceb.xceb222c) THEN LET l_xceb.xceb222c = 0 END IF
         IF cl_null(l_xceb.xceb222d) THEN LET l_xceb.xceb222d = 0 END IF
         IF cl_null(l_xceb.xceb222e) THEN LET l_xceb.xceb222e = 0 END IF
         IF cl_null(l_xceb.xceb222f) THEN LET l_xceb.xceb222f = 0 END IF
         IF cl_null(l_xceb.xceb222g) THEN LET l_xceb.xceb222g = 0 END IF
         IF cl_null(l_xceb.xceb222h) THEN LET l_xceb.xceb222h = 0 END IF                            
         IF cl_null(l_xceb.xceb222)  THEN LET l_xceb.xceb222  = 0 END IF
      ELSE
         LET l_xceb.xceb222a = 0
         LET l_xceb.xceb222b = 0
         LET l_xceb.xceb222c = 0
         LET l_xceb.xceb222d = 0
         LET l_xceb.xceb222e = 0
         LET l_xceb.xceb222f = 0
         LET l_xceb.xceb222g = 0
         LET l_xceb.xceb222h = 0                            
         LET l_xceb.xceb222  = 0      
      END IF

      LET l_xceb.xceb301  = ''    #憑證編號
      LET l_xceb.xceb302  = ''    #憑證項次
      #161109-00085#18-s mark
#      LET l_xceb.xcebud021= ''    #自定義欄位(日期時間)
#      LET l_xceb.xcebud022= ''    #自定義欄位(日期時間)
#      LET l_xceb.xcebud023= ''    #自定義欄位(日期時間)
#      LET l_xceb.xcebud024= ''    #自定義欄位(日期時間)
#      LET l_xceb.xcebud025= ''    #自定義欄位(日期時間)
#      LET l_xceb.xcebud026= ''    #自定義欄位(日期時間)
#      LET l_xceb.xcebud027= ''    #自定義欄位(日期時間)
#      LET l_xceb.xcebud028= ''    #自定義欄位(日期時間)
#      LET l_xceb.xcebud029= ''    #自定義欄位(日期時間)
#      LET l_xceb.xcebud030= ''    #自定義欄位(日期時間)
      
      #自由核算项1～10  
      LET l_xceb.xceb121 = ' '   #自由核算項1
      LET l_xceb.xceb122 = ' '   #自由核算項2
      LET l_xceb.xceb123 = ' '   #自由核算項3
      LET l_xceb.xceb124 = ' '   #自由核算項4
      LET l_xceb.xceb125 = ' '   #自由核算項5
      LET l_xceb.xceb126 = ' '   #自由核算項6
      LET l_xceb.xceb127 = ' '   #自由核算項7
      LET l_xceb.xceb128 = ' '   #自由核算項8
      LET l_xceb.xceb129 = ' '   #自由核算項9
      LET l_xceb.xceb130 = ' '   #自由核算項10
      
      CALL axct701_01_default_space_xceb(l_xceb.*) RETURNING l_xceb.xceb005,
                                                             l_xceb.xceb101,
                                                             l_xceb.xceb102,
                                                             l_xceb.xceb103,
                                                             l_xceb.xceb110,
                                                             l_xceb.xceb111,
                                                             l_xceb.xceb112,
                                                             l_xceb.xceb113,
                                                             l_xceb.xceb114,
                                                             l_xceb.xceb115,
                                                             l_xceb.xceb116,
                                                             l_xceb.xceb117,
                                                             l_xceb.xceb118,
                                                             l_xceb.xceb119,
                                                             l_xceb.xceb120,
                                                             l_xceb.xceb107,
                                                             l_xceb.xceb108,
                                                             l_xceb.xceb109,
                                                             l_xceb.xceb121,
                                                             l_xceb.xceb122,
                                                             l_xceb.xceb123,
                                                             l_xceb.xceb124,
                                                             l_xceb.xceb125,
                                                             l_xceb.xceb126,
                                                             l_xceb.xceb127,
                                                             l_xceb.xceb128,
                                                             l_xceb.xceb129,
                                                             l_xceb.xceb130

      #如果金额和数量都为0的话，则不产生此笔单身数据                                                             
      IF l_xceb.xceb201= 0 AND l_xceb.xceb202 = 0 THEN
         CONTINUE FOREACH
      END IF
      #161109-00085#20-s mod
#      INSERT INTO xceb_t VALUES(l_xceb.*)   #161109-00085#20-s mark
      #161109-00085#63 --s mark
      #INSERT INTO xceb_t(xcebent,xcebcomp,xcebld,xcebdocno,xcebseq,xceb001,xceb002,xceb003,xceb004,
      #                   xceb005,xceb101,xceb102,xceb103,xceb110,xceb111,xceb112,xceb113,xceb114,xceb115,
      #                   xceb116,xceb117,xceb118,xceb119,xceb120,xceb201,xceb202,xceb202a,xceb202b,xceb202c,
      #                   xceb202d,xceb202e,xceb202f,xceb202g,xceb202h,xceb212,xceb212a,xceb212b,xceb212c,
      #                   xceb212d,xceb212e,xceb212f,xceb212g,xceb212h,xceb222,xceb222a,xceb222b,xceb222c,
      #                   xceb222d,xceb222e,xceb222f,xceb222g,xceb222h,xceb301,xceb302,xceb107,xceb108,xceb109,
      #                   xceb121,xceb122,xceb123,xceb124,xceb125,xceb126,xceb127,xceb128,xceb129,xceb130,xceb131,xceb132) 
      #            VALUES(l_xceb.xcebent,l_xceb.xcebcomp,l_xceb.xcebld,l_xceb.xcebdocno,l_xceb.xcebseq,
      #                   l_xceb.xceb001,l_xceb.xceb002,l_xceb.xceb003,l_xceb.xceb004,l_xceb.xceb005,
      #                   l_xceb.xceb101,l_xceb.xceb102,l_xceb.xceb103,l_xceb.xceb110,l_xceb.xceb111,
      #                   l_xceb.xceb112,l_xceb.xceb113,l_xceb.xceb114,l_xceb.xceb115,l_xceb.xceb116,
      #                   l_xceb.xceb117,l_xceb.xceb118,l_xceb.xceb119,l_xceb.xceb120,l_xceb.xceb201,
      #                   l_xceb.xceb202,l_xceb.xceb202a,l_xceb.xceb202b,l_xceb.xceb202c,l_xceb.xceb202d,
      #                   l_xceb.xceb202e,l_xceb.xceb202f,l_xceb.xceb202g,l_xceb.xceb202h,l_xceb.xceb212,
      #                   l_xceb.xceb212a,l_xceb.xceb212b,l_xceb.xceb212c,l_xceb.xceb212d,l_xceb.xceb212e,
      #                   l_xceb.xceb212f,l_xceb.xceb212g,l_xceb.xceb212h,l_xceb.xceb222,l_xceb.xceb222a,
      #                   l_xceb.xceb222b,l_xceb.xceb222c,l_xceb.xceb222d,l_xceb.xceb222e,l_xceb.xceb222f,
      #                   l_xceb.xceb222g,l_xceb.xceb222h,l_xceb.xceb301,l_xceb.xceb302,l_xceb.xceb107,
      #                   l_xceb.xceb108,l_xceb.xceb109,l_xceb.xceb121,l_xceb.xceb122,l_xceb.xceb123,
      #                   l_xceb.xceb124,l_xceb.xceb125,l_xceb.xceb126,l_xceb.xceb127,l_xceb.xceb128,
      #                   l_xceb.xceb129,l_xceb.xceb130,l_xceb.xceb131,l_xceb.xceb132)
      #161109-00085#20-e mod
      #161109-00085#63 --e mark
      #161109-00085#63 --s add
      INSERT INTO xceb_t(xcebent,xcebcomp,xcebld,xcebdocno,xcebseq,
                         xceb001,xceb002,xceb003,xceb004,xceb005,
                         xceb101,xceb102,xceb103,xceb110,xceb111,
                         xceb112,xceb113,xceb114,xceb115,xceb116,
                         xceb117,xceb118,xceb119,xceb120,xceb201,
                         xceb202,xceb202a,xceb202b,xceb202c,xceb202d,
                         xceb202e,xceb202f,xceb202g,xceb202h,xceb212,
                         xceb212a,xceb212b,xceb212c,xceb212d,xceb212e,
                         xceb212f,xceb212g,xceb212h,xceb222,xceb222a,
                         xceb222b,xceb222c,xceb222d,xceb222e,xceb222f,
                         xceb222g,xceb222h,xceb301,xceb302,xcebud001,
                         xcebud002,xcebud003,xcebud004,xcebud005,xcebud006,
                         xcebud007,xcebud008,xcebud009,xcebud010,xcebud011,
                         xcebud012,xcebud013,xcebud014,xcebud015,xcebud016,
                         xcebud017,xcebud018,xcebud019,xcebud020,xcebud021,
                         xcebud022,xcebud023,xcebud024,xcebud025,xcebud026,
                         xcebud027,xcebud028,xcebud029,xcebud030,xceb107,
                         xceb108,xceb109,xceb121,xceb122,xceb123,
                         xceb124,xceb125,xceb126,xceb127,xceb128,
                         xceb129,xceb130,xceb131,xceb132)
      VALUES(l_xceb.xcebent,l_xceb.xcebcomp,l_xceb.xcebld,l_xceb.xcebdocno,l_xceb.xcebseq,
             l_xceb.xceb001,l_xceb.xceb002,l_xceb.xceb003,l_xceb.xceb004,l_xceb.xceb005,
             l_xceb.xceb101,l_xceb.xceb102,l_xceb.xceb103,l_xceb.xceb110,l_xceb.xceb111,
             l_xceb.xceb112,l_xceb.xceb113,l_xceb.xceb114,l_xceb.xceb115,l_xceb.xceb116,
             l_xceb.xceb117,l_xceb.xceb118,l_xceb.xceb119,l_xceb.xceb120,l_xceb.xceb201,
             l_xceb.xceb202,l_xceb.xceb202a,l_xceb.xceb202b,l_xceb.xceb202c,l_xceb.xceb202d,
             l_xceb.xceb202e,l_xceb.xceb202f,l_xceb.xceb202g,l_xceb.xceb202h,l_xceb.xceb212,
             l_xceb.xceb212a,l_xceb.xceb212b,l_xceb.xceb212c,l_xceb.xceb212d,l_xceb.xceb212e,
             l_xceb.xceb212f,l_xceb.xceb212g,l_xceb.xceb212h,l_xceb.xceb222,l_xceb.xceb222a,
             l_xceb.xceb222b,l_xceb.xceb222c,l_xceb.xceb222d,l_xceb.xceb222e,l_xceb.xceb222f,
             l_xceb.xceb222g,l_xceb.xceb222h,l_xceb.xceb301,l_xceb.xceb302,l_xceb.xcebud001,
             l_xceb.xcebud002,l_xceb.xcebud003,l_xceb.xcebud004,l_xceb.xcebud005,l_xceb.xcebud006,
             l_xceb.xcebud007,l_xceb.xcebud008,l_xceb.xcebud009,l_xceb.xcebud010,l_xceb.xcebud011,
             l_xceb.xcebud012,l_xceb.xcebud013,l_xceb.xcebud014,l_xceb.xcebud015,l_xceb.xcebud016,
             l_xceb.xcebud017,l_xceb.xcebud018,l_xceb.xcebud019,l_xceb.xcebud020,l_xceb.xcebud021,
             l_xceb.xcebud022,l_xceb.xcebud023,l_xceb.xcebud024,l_xceb.xcebud025,l_xceb.xcebud026,
             l_xceb.xcebud027,l_xceb.xcebud028,l_xceb.xcebud029,l_xceb.xcebud030,l_xceb.xceb107,
             l_xceb.xceb108,l_xceb.xceb109,l_xceb.xceb121,l_xceb.xceb122,l_xceb.xceb123,
             l_xceb.xceb124,l_xceb.xceb125,l_xceb.xceb126,l_xceb.xceb127,l_xceb.xceb128,
             l_xceb.xceb129,l_xceb.xceb130,l_xceb.xceb131,l_xceb.xceb132)
      #161109-00085#63 --e add
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "ins xceb_t"
         LET g_errparam.popup = TRUE
         CALL cl_err()
         LET g_success = 'N'
         EXIT FOREACH
      END IF
       
      INITIALIZE l_xcec.* TO NULL
     
      SELECT MAX(xcecseq) INTO l_xcec.xcecseq FROM xcec_t
       WHERE xcecent = g_enterprise AND xcecld = g_xcea_m.xceald
         AND xcecdocno = g_xcea_m.xceadocno
      IF cl_null(l_xcec.xcecseq) OR l_xcec.xcecseq = 0 THEN
         LET l_xcec.xcecseq = 1
      ELSE
         LET l_xcec.xcecseq = l_xcec.xcecseq + 1
      END IF 
      
      LET l_xcec.xcecent  = g_enterprise       #企業編號
      LET l_xcec.xcecld   = g_xcea_m.xceald    #帳套
      LET l_xcec.xceccomp = g_xcea_m.xceacomp  #法人組織
      LET l_xcec.xcecdocno= g_xcea_m.xceadocno #單據編號
      LET l_xcec.xcec001  = l_xceb.xceb001     #參考單據
      LET l_xcec.xcec002  = l_xceb.xceb002     #參考單據項次
      LET l_xcec.xcec003  = l_xceb.xceb003     #單據類型
      LET l_xcec.xcec004  = l_xceb.xceb004     #料件編號
      LET l_xcec.xcec005  = l_xceb.xceb005     #特性
      
      LET l_xcec.xcec101  = ''                 #科目編號
#      IF g_xcea002='13' THEN   #13投入 14结转
#         CALL s_fin_get_account(g_xcea_m.xceald,'60','8912','9') RETURNING l_success,l_xcec.xcec101,l_errno
#      ELSE
#         CALL s_fin_get_account(g_xcea_m.xceald,'60','8912','10') RETURNING l_success,l_xcec.xcec101,l_errno
#      END IF
      CALL s_fin_get_account(g_xcea_m.xceald,'60','8912','10') RETURNING l_success,l_xcec.xcec101,l_errno
          
      LET l_xcec.xcec102 = l_xceb.xceb102  #摘要
      LET l_xcec.xcec103 = l_xceb.xceb103  #成本域
      LET l_xcec.xcec110 = l_xceb.xceb110  #原因碼
      LET l_xcec.xcec111 = l_xceb.xceb111  #交易對象
      LET l_xcec.xcec112 = l_xceb.xceb112  #客群
      LET l_xcec.xcec113 = l_xceb.xceb113  #區域
      LET l_xcec.xcec114 = l_xceb.xceb114  #成本中心
      LET l_xcec.xcec115 = l_xceb.xceb115  #經營類別
      LET l_xcec.xcec116 = l_xceb.xceb116  #渠道
      LET l_xcec.xcec117 = l_xceb.xceb117  #品類
      LET l_xcec.xcec118 = l_xceb.xceb118  #品牌
      LET l_xcec.xcec119 = l_xceb.xceb119  #項目號
      LET l_xcec.xcec120 = l_xceb.xceb120  #WBS
      LET l_xcec.xcec201 = l_xceb.xceb201  #數量
      LET l_xcec.xcec202 = l_xceb.xceb202  #成本金額(本位幣一)
      LET l_xcec.xcec202a= l_xceb.xceb202a #成本-材料(本位幣一)
      LET l_xcec.xcec202b= l_xceb.xceb202b #成本-人工(本位幣一)
      LET l_xcec.xcec202c= l_xceb.xceb202c #成本-加工(本位幣一)
      LET l_xcec.xcec202d= l_xceb.xceb202d #成本-制費一(本位幣一)
      LET l_xcec.xcec202e= l_xceb.xceb202e #成本-制費二(本位幣一)
      LET l_xcec.xcec202f= l_xceb.xceb202f #成本-制費三(本位幣一)
      LET l_xcec.xcec202g= l_xceb.xceb202g #成本-制費四(本位幣一)
      LET l_xcec.xcec202h= l_xceb.xceb202h #成本-制費五(本位幣一)
      LET l_xcec.xcec212 = l_xceb.xceb212  #成本-金額(本位幣二)
      LET l_xcec.xcec212a= l_xceb.xceb212a
      LET l_xcec.xcec212b= l_xceb.xceb212b
      LET l_xcec.xcec212c= l_xceb.xceb212c
      LET l_xcec.xcec212d= l_xceb.xceb212d
      LET l_xcec.xcec212e= l_xceb.xceb212e
      LET l_xcec.xcec212f= l_xceb.xceb212f
      LET l_xcec.xcec212g= l_xceb.xceb212g
      LET l_xcec.xcec212h= l_xceb.xceb212h
      LET l_xcec.xcec222 = l_xceb.xceb222  #成本-金額(本位幣三)
      LET l_xcec.xcec222a= l_xceb.xceb222a
      LET l_xcec.xcec222b= l_xceb.xceb222b
      LET l_xcec.xcec222c= l_xceb.xceb222c
      LET l_xcec.xcec222d= l_xceb.xceb222d
      LET l_xcec.xcec222e= l_xceb.xceb222e
      LET l_xcec.xcec222f= l_xceb.xceb222f
      LET l_xcec.xcec222g= l_xceb.xceb222g
      LET l_xcec.xcec222h= l_xceb.xceb222h
      LET l_xcec.xcec301 = l_xceb.xceb301  #憑證編號
      LET l_xcec.xcec302 = l_xceb.xceb302  #憑證項次
      #161109-00085#19-s mark
#      LET l_xcec.xcecud021 = '' #自定義欄位(日期時間)
#      LET l_xcec.xcecud022 = '' #自定義欄位(日期時間)
#      LET l_xcec.xcecud023 = '' #自定義欄位(日期時間)
#      LET l_xcec.xcecud024 = '' #自定義欄位(日期時間)
#      LET l_xcec.xcecud025 = '' #自定義欄位(日期時間)
#      LET l_xcec.xcecud026 = '' #自定義欄位(日期時間)
#      LET l_xcec.xcecud027 = '' #自定義欄位(日期時間)
#      LET l_xcec.xcecud028 = '' #自定義欄位(日期時間)
#      LET l_xcec.xcecud029 = '' #自定義欄位(日期時間)
#      LET l_xcec.xcecud030 = '' #自定義欄位(日期時間)
      LET l_xcec.xcec107 = l_xceb.xceb107 #人員
      LET l_xcec.xcec108 = l_xceb.xceb108 #部門
      LET l_xcec.xcec109 = l_xceb.xceb109 #帳款對象
      LET l_xcec.xcec121 = l_xceb.xceb121 #自由核算項1
      LET l_xcec.xcec122 = l_xceb.xceb122 #自由核算項2
      LET l_xcec.xcec123 = l_xceb.xceb123 #自由核算項3
      LET l_xcec.xcec124 = l_xceb.xceb124 #自由核算項4
      LET l_xcec.xcec125 = l_xceb.xceb125 #自由核算項5
      LET l_xcec.xcec126 = l_xceb.xceb126 #自由核算項6
      LET l_xcec.xcec127 = l_xceb.xceb127 #自由核算項7
      LET l_xcec.xcec128 = l_xceb.xceb128 #自由核算項8
      LET l_xcec.xcec129 = l_xceb.xceb129 #自由核算項9
      LET l_xcec.xcec130 = l_xceb.xceb130 #自由核算項10

      CALL axct701_01_default_space_xcec(l_xcec.*) RETURNING l_xcec.xcec005,   
                                                             l_xcec.xcec101,
                                                             l_xcec.xcec102,
                                                             l_xcec.xcec103,
                                                             l_xcec.xcec110,
                                                             l_xcec.xcec111,
                                                             l_xcec.xcec112,
                                                             l_xcec.xcec113,
                                                             l_xcec.xcec114,
                                                             l_xcec.xcec115,
                                                             l_xcec.xcec116,
                                                             l_xcec.xcec117,
                                                             l_xcec.xcec118,
                                                             l_xcec.xcec119,
                                                             l_xcec.xcec120,
                                                             l_xcec.xcec107,
                                                             l_xcec.xcec108,
                                                             l_xcec.xcec109,
                                                             l_xcec.xcec121,
                                                             l_xcec.xcec122,
                                                             l_xcec.xcec123,
                                                             l_xcec.xcec124,
                                                             l_xcec.xcec125,
                                                             l_xcec.xcec126,
                                                             l_xcec.xcec127,
                                                             l_xcec.xcec128,
                                                             l_xcec.xcec129,
                                                             l_xcec.xcec130                                          
#如果金额和数量都为0的话，则不产生此笔单身数据                                                             
      IF l_xcec.xcec201= 0 AND l_xcec.xcec202 = 0 THEN
         CONTINUE FOREACH
      END IF       
      #161109-00085#20-s mod      
#      INSERT INTO xcec_t VALUES(l_xcec.*)   #161109-00085#20-s mark
      #161109-00085#63 --s mark
      #INSERT INTO xcec_t(xcecent,xceccomp,xcecld,xcecdocno,xcecseq,xcec001,xcec002,xcec003,xcec004,
      #                   xcec005,xcec101,xcec102,xcec103,xcec110,xcec111,xcec112,xcec113,xcec114,
      #                   xcec115,xcec116,xcec117,xcec118,xcec119,xcec120,xcec201,xcec202,xcec202a,
      #                   xcec202b,xcec202c,xcec202d,xcec202e,xcec202f,xcec202g,xcec202h,xcec212,
      #                   xcec212a,xcec212b,xcec212c,xcec212d,xcec212e,xcec212f,xcec212g,xcec212h,
      #                   xcec222,xcec222a,xcec222b,xcec222c,xcec222d,xcec222e,xcec222f,xcec222g,
      #                   xcec222h,xcec301,xcec302,xcec107,xcec108,xcec109,xcec121,xcec122,xcec123,
      #                   xcec124,xcec125,xcec126,xcec127,xcec128,xcec129,xcec130) 
      #            VALUES(l_xcec.xcecent,l_xcec.xceccomp,l_xcec.xcecld,l_xcec.xcecdocno,l_xcec.xcecseq,
      #                   l_xcec.xcec001,l_xcec.xcec002,l_xcec.xcec003,l_xcec.xcec004,l_xcec.xcec005,
      #                   l_xcec.xcec101,l_xcec.xcec102,l_xcec.xcec103,l_xcec.xcec110,l_xcec.xcec111,
      #                   l_xcec.xcec112,l_xcec.xcec113,l_xcec.xcec114,l_xcec.xcec115,l_xcec.xcec116,
      #                   l_xcec.xcec117,l_xcec.xcec118,l_xcec.xcec119,l_xcec.xcec120,l_xcec.xcec201,
      #                   l_xcec.xcec202,l_xcec.xcec202a,l_xcec.xcec202b,l_xcec.xcec202c,l_xcec.xcec202d,
      #                   l_xcec.xcec202e,l_xcec.xcec202f,l_xcec.xcec202g,l_xcec.xcec202h,l_xcec.xcec212,
      #                   l_xcec.xcec212a,l_xcec.xcec212b,l_xcec.xcec212c,l_xcec.xcec212d,l_xcec.xcec212e,
      #                   l_xcec.xcec212f,l_xcec.xcec212g,l_xcec.xcec212h,l_xcec.xcec222,l_xcec.xcec222a,
      #                   l_xcec.xcec222b,l_xcec.xcec222c,l_xcec.xcec222d,l_xcec.xcec222e,l_xcec.xcec222f,
      #                   l_xcec.xcec222g,l_xcec.xcec222h,l_xcec.xcec301,l_xcec.xcec302,l_xcec.xcec107,
      #                   l_xcec.xcec108,l_xcec.xcec109,l_xcec.xcec121,l_xcec.xcec122,l_xcec.xcec123,
      #                   l_xcec.xcec124,l_xcec.xcec125,l_xcec.xcec126,l_xcec.xcec127,l_xcec.xcec128,
      #                   l_xcec.xcec129,l_xcec.xcec130)
      #161109-00085#63 --e mark
      #161109-00085#20-e mod
      #161109-00085#63 --s add
      INSERT INTO xcec_t(xcecent,xceccomp,xcecld,xcecdocno,xcecseq,
                         xcec001,xcec002,xcec003,xcec004,xcec005,
                         xcec101,xcec102,xcec103,xcec110,xcec111,
                         xcec112,xcec113,xcec114,xcec115,xcec116,
                         xcec117,xcec118,xcec119,xcec120,xcec201,
                         xcec202,xcec202a,xcec202b,xcec202c,xcec202d,
                         xcec202e,xcec202f,xcec202g,xcec202h,xcec212,
                         xcec212a,xcec212b,xcec212c,xcec212d,xcec212e,
                         xcec212f,xcec212g,xcec212h,xcec222,xcec222a,
                         xcec222b,xcec222c,xcec222d,xcec222e,xcec222f,
                         xcec222g,xcec222h,xcec301,xcec302,xcecud001,
                         xcecud002,xcecud003,xcecud004,xcecud005,xcecud006,
                         xcecud007,xcecud008,xcecud009,xcecud010,xcecud011,
                         xcecud012,xcecud013,xcecud014,xcecud015,xcecud016,
                         xcecud017,xcecud018,xcecud019,xcecud020,xcecud021,
                         xcecud022,xcecud023,xcecud024,xcecud025,xcecud026,
                         xcecud027,xcecud028,xcecud029,xcecud030,xcec107,
                         xcec108,xcec109,xcec121,xcec122,xcec123,
                         xcec124,xcec125,xcec126,xcec127,xcec128,
                         xcec129,xcec130)
      VALUES(l_xcec.xcecent,l_xcec.xceccomp,l_xcec.xcecld,l_xcec.xcecdocno,l_xcec.xcecseq,
             l_xcec.xcec001,l_xcec.xcec002,l_xcec.xcec003,l_xcec.xcec004,l_xcec.xcec005,
             l_xcec.xcec101,l_xcec.xcec102,l_xcec.xcec103,l_xcec.xcec110,l_xcec.xcec111,
             l_xcec.xcec112,l_xcec.xcec113,l_xcec.xcec114,l_xcec.xcec115,l_xcec.xcec116,
             l_xcec.xcec117,l_xcec.xcec118,l_xcec.xcec119,l_xcec.xcec120,l_xcec.xcec201,
             l_xcec.xcec202,l_xcec.xcec202a,l_xcec.xcec202b,l_xcec.xcec202c,l_xcec.xcec202d,
             l_xcec.xcec202e,l_xcec.xcec202f,l_xcec.xcec202g,l_xcec.xcec202h,l_xcec.xcec212,
             l_xcec.xcec212a,l_xcec.xcec212b,l_xcec.xcec212c,l_xcec.xcec212d,l_xcec.xcec212e,
             l_xcec.xcec212f,l_xcec.xcec212g,l_xcec.xcec212h,l_xcec.xcec222,l_xcec.xcec222a,
             l_xcec.xcec222b,l_xcec.xcec222c,l_xcec.xcec222d,l_xcec.xcec222e,l_xcec.xcec222f,
             l_xcec.xcec222g,l_xcec.xcec222h,l_xcec.xcec301,l_xcec.xcec302,l_xcec.xcecud001,
             l_xcec.xcecud002,l_xcec.xcecud003,l_xcec.xcecud004,l_xcec.xcecud005,l_xcec.xcecud006,
             l_xcec.xcecud007,l_xcec.xcecud008,l_xcec.xcecud009,l_xcec.xcecud010,l_xcec.xcecud011,
             l_xcec.xcecud012,l_xcec.xcecud013,l_xcec.xcecud014,l_xcec.xcecud015,l_xcec.xcecud016,
             l_xcec.xcecud017,l_xcec.xcecud018,l_xcec.xcecud019,l_xcec.xcecud020,l_xcec.xcecud021,
             l_xcec.xcecud022,l_xcec.xcecud023,l_xcec.xcecud024,l_xcec.xcecud025,l_xcec.xcecud026,
             l_xcec.xcecud027,l_xcec.xcecud028,l_xcec.xcecud029,l_xcec.xcecud030,l_xcec.xcec107,
             l_xcec.xcec108,l_xcec.xcec109,l_xcec.xcec121,l_xcec.xcec122,l_xcec.xcec123,
             l_xcec.xcec124,l_xcec.xcec125,l_xcec.xcec126,l_xcec.xcec127,l_xcec.xcec128,
             l_xcec.xcec129,l_xcec.xcec130)
      #161109-00085#63 --e add
      
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "ins xcec"
         LET g_errparam.popup = TRUE
         CALL cl_err()
         LET g_success = 'N'
         EXIT FOREACH
      END IF
      
   END FOREACH   
   RETURN g_success 
END FUNCTION

################################################################################
# Descriptions...: 在製轉出成本與工單入庫標準成本差異憑證
# Memo...........:
# Usage..........: CALL axct701_01_ins_15()
#                  RETURNING r_success
# Input parameter: 传入参数变量1   传入参数变量说明1
#                : 传入参数变量2   传入参数变量说明2
# Return code....: r_success      TRUR/FALSE
#                : 回传参数变量2   回传参数变量说明2
# Date & Author..: 2016/09/14 By  02295
# Modify.........: #160907-00003#6
################################################################################
PRIVATE FUNCTION axct701_01_ins_15()
DEFINE l_success       LIKE type_t.num5
DEFINE l_errno         LIKE gzze_t.gzze001
#161109-00085#19-s mod
#DEFINE l_xcea          RECORD LIKE xcea_t.*   #161109-00085#19-s mark
DEFINE l_xcea          RECORD  #工單發料成本憑證單頭檔
       xceaent LIKE xcea_t.xceaent, #企業編號
       xceacomp LIKE xcea_t.xceacomp, #法人組織
       xceald LIKE xcea_t.xceald, #帳套
       xceadocno LIKE xcea_t.xceadocno, #單據編號
       xcea001 LIKE xcea_t.xcea001, #單據日期
       xcea002 LIKE xcea_t.xcea002, #成本憑證類型
       xcea003 LIKE xcea_t.xcea003, #成本計算類型
       xcea004 LIKE xcea_t.xcea004, #年度
       xcea005 LIKE xcea_t.xcea005, #期別
       xcea006 LIKE xcea_t.xcea006, #帳務人員
       xcea007 LIKE xcea_t.xcea007, #帳務部門
       xcea101 LIKE xcea_t.xcea101, #憑證編號
       xcea102 LIKE xcea_t.xcea102, #憑證日期
       xceaownid LIKE xcea_t.xceaownid, #資料所有者
       xceaowndp LIKE xcea_t.xceaowndp, #資料所屬部門
       xceacrtid LIKE xcea_t.xceacrtid, #資料建立者
       xceacrtdp LIKE xcea_t.xceacrtdp, #資料建立部門
       xceacrtdt LIKE xcea_t.xceacrtdt, #資料創建日
       xceamodid LIKE xcea_t.xceamodid, #資料修改者
       xceamoddt LIKE xcea_t.xceamoddt, #最近修改日
       xceacnfid LIKE xcea_t.xceacnfid, #資料確認者
       xceacnfdt LIKE xcea_t.xceacnfdt, #資料確認日
       xceapstid LIKE xcea_t.xceapstid, #資料過帳者
       xceapstdt LIKE xcea_t.xceapstdt, #資料過帳日
       xceastus LIKE xcea_t.xceastus, #狀態碼
       #161109-00085#63 --s add
       xceaud001 LIKE xcea_t.xceaud001, #自定義欄位(文字)001
       xceaud002 LIKE xcea_t.xceaud002, #自定義欄位(文字)002
       xceaud003 LIKE xcea_t.xceaud003, #自定義欄位(文字)003
       xceaud004 LIKE xcea_t.xceaud004, #自定義欄位(文字)004
       xceaud005 LIKE xcea_t.xceaud005, #自定義欄位(文字)005
       xceaud006 LIKE xcea_t.xceaud006, #自定義欄位(文字)006
       xceaud007 LIKE xcea_t.xceaud007, #自定義欄位(文字)007
       xceaud008 LIKE xcea_t.xceaud008, #自定義欄位(文字)008
       xceaud009 LIKE xcea_t.xceaud009, #自定義欄位(文字)009
       xceaud010 LIKE xcea_t.xceaud010, #自定義欄位(文字)010
       xceaud011 LIKE xcea_t.xceaud011, #自定義欄位(數字)011
       xceaud012 LIKE xcea_t.xceaud012, #自定義欄位(數字)012
       xceaud013 LIKE xcea_t.xceaud013, #自定義欄位(數字)013
       xceaud014 LIKE xcea_t.xceaud014, #自定義欄位(數字)014
       xceaud015 LIKE xcea_t.xceaud015, #自定義欄位(數字)015
       xceaud016 LIKE xcea_t.xceaud016, #自定義欄位(數字)016
       xceaud017 LIKE xcea_t.xceaud017, #自定義欄位(數字)017
       xceaud018 LIKE xcea_t.xceaud018, #自定義欄位(數字)018
       xceaud019 LIKE xcea_t.xceaud019, #自定義欄位(數字)019
       xceaud020 LIKE xcea_t.xceaud020, #自定義欄位(數字)020
       xceaud021 LIKE xcea_t.xceaud021, #自定義欄位(日期時間)021
       xceaud022 LIKE xcea_t.xceaud022, #自定義欄位(日期時間)022
       xceaud023 LIKE xcea_t.xceaud023, #自定義欄位(日期時間)023
       xceaud024 LIKE xcea_t.xceaud024, #自定義欄位(日期時間)024
       xceaud025 LIKE xcea_t.xceaud025, #自定義欄位(日期時間)025
       xceaud026 LIKE xcea_t.xceaud026, #自定義欄位(日期時間)026
       xceaud027 LIKE xcea_t.xceaud027, #自定義欄位(日期時間)027
       xceaud028 LIKE xcea_t.xceaud028, #自定義欄位(日期時間)028
       xceaud029 LIKE xcea_t.xceaud029, #自定義欄位(日期時間)029
       xceaud030 LIKE xcea_t.xceaud030, #自定義欄位(日期時間)030
       #161109-00085#63 --e add
       xceasite LIKE xcea_t.xceasite  #營運據點
          END RECORD
#161109-00085#19-e mod
#161109-00085#18-s mod
#DEFINE l_xceb          RECORD LIKE xceb_t.*   #161109-00085#18-s mark
DEFINE l_xceb          RECORD  #成本憑證第一單身檔
       xcebent LIKE xceb_t.xcebent, #企業編號
       xcebcomp LIKE xceb_t.xcebcomp, #法人組織
       xcebld LIKE xceb_t.xcebld, #帳套
       xcebdocno LIKE xceb_t.xcebdocno, #單據編號
       xcebseq LIKE xceb_t.xcebseq, #項次
       xceb001 LIKE xceb_t.xceb001, #參考單據編號
       xceb002 LIKE xceb_t.xceb002, #參考單據項次
       xceb003 LIKE xceb_t.xceb003, #單據類型
       xceb004 LIKE xceb_t.xceb004, #料件編號
       xceb005 LIKE xceb_t.xceb005, #特性
       xceb101 LIKE xceb_t.xceb101, #科目編號
       xceb102 LIKE xceb_t.xceb102, #摘要
       xceb103 LIKE xceb_t.xceb103, #成本域
       xceb110 LIKE xceb_t.xceb110, #原因碼
       xceb111 LIKE xceb_t.xceb111, #收付款客商
       xceb112 LIKE xceb_t.xceb112, #客群
       xceb113 LIKE xceb_t.xceb113, #區域
       xceb114 LIKE xceb_t.xceb114, #成本中心
       xceb115 LIKE xceb_t.xceb115, #經營類別
       xceb116 LIKE xceb_t.xceb116, #通路
       xceb117 LIKE xceb_t.xceb117, #品類
       xceb118 LIKE xceb_t.xceb118, #品牌
       xceb119 LIKE xceb_t.xceb119, #專案號
       xceb120 LIKE xceb_t.xceb120, #WBS
       xceb201 LIKE xceb_t.xceb201, #數量
       xceb202 LIKE xceb_t.xceb202, #成本金額(本位幣一)
       xceb202a LIKE xceb_t.xceb202a, #成本-材料(本位幣一)
       xceb202b LIKE xceb_t.xceb202b, #成本-人工(本位幣一)
       xceb202c LIKE xceb_t.xceb202c, #成本-加工(本位幣一)
       xceb202d LIKE xceb_t.xceb202d, #成本-制費一(本位幣一)
       xceb202e LIKE xceb_t.xceb202e, #成本-制費二(本位幣一)
       xceb202f LIKE xceb_t.xceb202f, #成本-制費三(本位幣一)
       xceb202g LIKE xceb_t.xceb202g, #成本-制費四(本位幣一)
       xceb202h LIKE xceb_t.xceb202h, #成本-制費五(本位幣一)
       xceb212 LIKE xceb_t.xceb212, #成本金額(本位幣二)
       xceb212a LIKE xceb_t.xceb212a, #成本-材料(本位幣二)
       xceb212b LIKE xceb_t.xceb212b, #成本-人工(本位幣二)
       xceb212c LIKE xceb_t.xceb212c, #成本-加工(本位幣二)
       xceb212d LIKE xceb_t.xceb212d, #成本-制費一(本位幣二)
       xceb212e LIKE xceb_t.xceb212e, #成本-制費二(本位幣二)
       xceb212f LIKE xceb_t.xceb212f, #成本-制費三(本位幣二)
       xceb212g LIKE xceb_t.xceb212g, #成本-制費四(本位幣二)
       xceb212h LIKE xceb_t.xceb212h, #成本-制費五(本位幣二)
       xceb222 LIKE xceb_t.xceb222, #成本金額(本位幣三)
       xceb222a LIKE xceb_t.xceb222a, #成本-材料(本位幣三)
       xceb222b LIKE xceb_t.xceb222b, #成本-人工(本位幣三)
       xceb222c LIKE xceb_t.xceb222c, #成本-加工(本位幣三)
       xceb222d LIKE xceb_t.xceb222d, #成本-制費一(本位幣三)
       xceb222e LIKE xceb_t.xceb222e, #成本-制費二(本位幣三)
       xceb222f LIKE xceb_t.xceb222f, #成本-制費三(本位幣三)
       xceb222g LIKE xceb_t.xceb222g, #成本-制費四(本位幣三)
       xceb222h LIKE xceb_t.xceb222h, #成本-制費五(本位幣三)
       xceb301 LIKE xceb_t.xceb301, #憑證編號
       xceb302 LIKE xceb_t.xceb302, #憑證項次
       #161109-00085#63 --s add  
       xcebud001 LIKE xceb_t.xcebud001, #自定義欄位(文字)001
       xcebud002 LIKE xceb_t.xcebud002, #自定義欄位(文字)002
       xcebud003 LIKE xceb_t.xcebud003, #自定義欄位(文字)003
       xcebud004 LIKE xceb_t.xcebud004, #自定義欄位(文字)004
       xcebud005 LIKE xceb_t.xcebud005, #自定義欄位(文字)005
       xcebud006 LIKE xceb_t.xcebud006, #自定義欄位(文字)006
       xcebud007 LIKE xceb_t.xcebud007, #自定義欄位(文字)007
       xcebud008 LIKE xceb_t.xcebud008, #自定義欄位(文字)008
       xcebud009 LIKE xceb_t.xcebud009, #自定義欄位(文字)009
       xcebud010 LIKE xceb_t.xcebud010, #自定義欄位(文字)010
       xcebud011 LIKE xceb_t.xcebud011, #自定義欄位(數字)011
       xcebud012 LIKE xceb_t.xcebud012, #自定義欄位(數字)012
       xcebud013 LIKE xceb_t.xcebud013, #自定義欄位(數字)013
       xcebud014 LIKE xceb_t.xcebud014, #自定義欄位(數字)014
       xcebud015 LIKE xceb_t.xcebud015, #自定義欄位(數字)015
       xcebud016 LIKE xceb_t.xcebud016, #自定義欄位(數字)016
       xcebud017 LIKE xceb_t.xcebud017, #自定義欄位(數字)017
       xcebud018 LIKE xceb_t.xcebud018, #自定義欄位(數字)018
       xcebud019 LIKE xceb_t.xcebud019, #自定義欄位(數字)019
       xcebud020 LIKE xceb_t.xcebud020, #自定義欄位(數字)020
       xcebud021 LIKE xceb_t.xcebud021, #自定義欄位(日期時間)021
       xcebud022 LIKE xceb_t.xcebud022, #自定義欄位(日期時間)022
       xcebud023 LIKE xceb_t.xcebud023, #自定義欄位(日期時間)023
       xcebud024 LIKE xceb_t.xcebud024, #自定義欄位(日期時間)024
       xcebud025 LIKE xceb_t.xcebud025, #自定義欄位(日期時間)025
       xcebud026 LIKE xceb_t.xcebud026, #自定義欄位(日期時間)026
       xcebud027 LIKE xceb_t.xcebud027, #自定義欄位(日期時間)027
       xcebud028 LIKE xceb_t.xcebud028, #自定義欄位(日期時間)028
       xcebud029 LIKE xceb_t.xcebud029, #自定義欄位(日期時間)029
       xcebud030 LIKE xceb_t.xcebud030, #自定義欄位(日期時間)030
       #161109-00085#63 --e add
       xceb107 LIKE xceb_t.xceb107, #人員
       xceb108 LIKE xceb_t.xceb108, #部門
       xceb109 LIKE xceb_t.xceb109, #帳款對象
       xceb121 LIKE xceb_t.xceb121, #自由核算項1
       xceb122 LIKE xceb_t.xceb122, #自由核算項2
       xceb123 LIKE xceb_t.xceb123, #自由核算項3
       xceb124 LIKE xceb_t.xceb124, #自由核算項4
       xceb125 LIKE xceb_t.xceb125, #自由核算項5
       xceb126 LIKE xceb_t.xceb126, #自由核算項6
       xceb127 LIKE xceb_t.xceb127, #自由核算項7
       xceb128 LIKE xceb_t.xceb128, #自由核算項8
       xceb129 LIKE xceb_t.xceb129, #自由核算項9
       xceb130 LIKE xceb_t.xceb130, #自由核算項10
       xceb131 LIKE xceb_t.xceb131, #單據類型(for 流通)
       xceb132 LIKE xceb_t.xceb132  #單據日期(for 流通)
          END RECORD
#161109-00085#18-e mod
#161109-00085#19-s mod
#DEFINE l_xcec          RECORD LIKE xcec_t.*   #161109-00085#18-s mark
DEFINE l_xcec          RECORD  #成本憑證第二單身檔
       xcecent LIKE xcec_t.xcecent, #企業編號
       xceccomp LIKE xcec_t.xceccomp, #法人組織
       xcecld LIKE xcec_t.xcecld, #帳套
       xcecdocno LIKE xcec_t.xcecdocno, #單據編號
       xcecseq LIKE xcec_t.xcecseq, #項次
       xcec001 LIKE xcec_t.xcec001, #參考單據
       xcec002 LIKE xcec_t.xcec002, #參考單據項次
       xcec003 LIKE xcec_t.xcec003, #單據類型
       xcec004 LIKE xcec_t.xcec004, #料件編號
       xcec005 LIKE xcec_t.xcec005, #特性
       xcec101 LIKE xcec_t.xcec101, #科目編號
       xcec102 LIKE xcec_t.xcec102, #摘要
       xcec103 LIKE xcec_t.xcec103, #成本域
       xcec110 LIKE xcec_t.xcec110, #原因碼
       xcec111 LIKE xcec_t.xcec111, #收付款客商
       xcec112 LIKE xcec_t.xcec112, #客群
       xcec113 LIKE xcec_t.xcec113, #區域
       xcec114 LIKE xcec_t.xcec114, #成本中心
       xcec115 LIKE xcec_t.xcec115, #經營類別
       xcec116 LIKE xcec_t.xcec116, #通路
       xcec117 LIKE xcec_t.xcec117, #品類
       xcec118 LIKE xcec_t.xcec118, #品牌
       xcec119 LIKE xcec_t.xcec119, #專案號
       xcec120 LIKE xcec_t.xcec120, #WBS
       xcec201 LIKE xcec_t.xcec201, #數量
       xcec202 LIKE xcec_t.xcec202, #成本金額(本位幣一)
       xcec202a LIKE xcec_t.xcec202a, #成本-材料(本位幣一)
       xcec202b LIKE xcec_t.xcec202b, #成本-人工(本位幣一)
       xcec202c LIKE xcec_t.xcec202c, #成本-加工(本位幣一)
       xcec202d LIKE xcec_t.xcec202d, #成本-制費一(本位幣一)
       xcec202e LIKE xcec_t.xcec202e, #成本-制費二(本位幣一)
       xcec202f LIKE xcec_t.xcec202f, #成本-制費三(本位幣一)
       xcec202g LIKE xcec_t.xcec202g, #成本-制費四(本位幣一)
       xcec202h LIKE xcec_t.xcec202h, #成本-制費五(本位幣一)
       xcec212 LIKE xcec_t.xcec212, #成本-金額(本位幣二)
       xcec212a LIKE xcec_t.xcec212a, #成本-材料(本位幣二)
       xcec212b LIKE xcec_t.xcec212b, #成本-人工(本位幣二)
       xcec212c LIKE xcec_t.xcec212c, #成本-加工(本位幣二)
       xcec212d LIKE xcec_t.xcec212d, #成本-制費一(本位幣二)
       xcec212e LIKE xcec_t.xcec212e, #成本-制費二(本位幣二)
       xcec212f LIKE xcec_t.xcec212f, #成本-制費三(本位幣二)
       xcec212g LIKE xcec_t.xcec212g, #成本-制費四(本位幣二)
       xcec212h LIKE xcec_t.xcec212h, #成本-制費五(本位幣二)
       xcec222 LIKE xcec_t.xcec222, #成本-金額(本位幣三)
       xcec222a LIKE xcec_t.xcec222a, #成本-材料(本位幣三)
       xcec222b LIKE xcec_t.xcec222b, #成本-人工(本位幣三)
       xcec222c LIKE xcec_t.xcec222c, #成本-加工(本位幣三)
       xcec222d LIKE xcec_t.xcec222d, #成本-制費一(本位幣三)
       xcec222e LIKE xcec_t.xcec222e, #成本-制費二(本位幣三)
       xcec222f LIKE xcec_t.xcec222f, #成本-制費三(本位幣三)
       xcec222g LIKE xcec_t.xcec222g, #成本-制費四(本位幣三)
       xcec222h LIKE xcec_t.xcec222h, #成本-制費五(本位幣三)
       xcec301 LIKE xcec_t.xcec301, #憑證編號
       xcec302 LIKE xcec_t.xcec302, #憑證項次
       #161109-00085#63 --s add 
       xcecud001 LIKE xcec_t.xcecud001, #自定義欄位(文字)001
       xcecud002 LIKE xcec_t.xcecud002, #自定義欄位(文字)002
       xcecud003 LIKE xcec_t.xcecud003, #自定義欄位(文字)003
       xcecud004 LIKE xcec_t.xcecud004, #自定義欄位(文字)004
       xcecud005 LIKE xcec_t.xcecud005, #自定義欄位(文字)005
       xcecud006 LIKE xcec_t.xcecud006, #自定義欄位(文字)006
       xcecud007 LIKE xcec_t.xcecud007, #自定義欄位(文字)007
       xcecud008 LIKE xcec_t.xcecud008, #自定義欄位(文字)008
       xcecud009 LIKE xcec_t.xcecud009, #自定義欄位(文字)009
       xcecud010 LIKE xcec_t.xcecud010, #自定義欄位(文字)010
       xcecud011 LIKE xcec_t.xcecud011, #自定義欄位(數字)011
       xcecud012 LIKE xcec_t.xcecud012, #自定義欄位(數字)012
       xcecud013 LIKE xcec_t.xcecud013, #自定義欄位(數字)013
       xcecud014 LIKE xcec_t.xcecud014, #自定義欄位(數字)014
       xcecud015 LIKE xcec_t.xcecud015, #自定義欄位(數字)015
       xcecud016 LIKE xcec_t.xcecud016, #自定義欄位(數字)016
       xcecud017 LIKE xcec_t.xcecud017, #自定義欄位(數字)017
       xcecud018 LIKE xcec_t.xcecud018, #自定義欄位(數字)018
       xcecud019 LIKE xcec_t.xcecud019, #自定義欄位(數字)019
       xcecud020 LIKE xcec_t.xcecud020, #自定義欄位(數字)020
       xcecud021 LIKE xcec_t.xcecud021, #自定義欄位(日期時間)021
       xcecud022 LIKE xcec_t.xcecud022, #自定義欄位(日期時間)022
       xcecud023 LIKE xcec_t.xcecud023, #自定義欄位(日期時間)023
       xcecud024 LIKE xcec_t.xcecud024, #自定義欄位(日期時間)024
       xcecud025 LIKE xcec_t.xcecud025, #自定義欄位(日期時間)025
       xcecud026 LIKE xcec_t.xcecud026, #自定義欄位(日期時間)026
       xcecud027 LIKE xcec_t.xcecud027, #自定義欄位(日期時間)027
       xcecud028 LIKE xcec_t.xcecud028, #自定義欄位(日期時間)028
       xcecud029 LIKE xcec_t.xcecud029, #自定義欄位(日期時間)029
       xcecud030 LIKE xcec_t.xcecud030, #自定義欄位(日期時間)030
       #161109-00085#63 --e add
       xcec107 LIKE xcec_t.xcec107, #人員
       xcec108 LIKE xcec_t.xcec108, #部門
       xcec109 LIKE xcec_t.xcec109, #帳款對象
       xcec121 LIKE xcec_t.xcec121, #自由核算項1
       xcec122 LIKE xcec_t.xcec122, #自由核算項2
       xcec123 LIKE xcec_t.xcec123, #自由核算項3
       xcec124 LIKE xcec_t.xcec124, #自由核算項4
       xcec125 LIKE xcec_t.xcec125, #自由核算項5
       xcec126 LIKE xcec_t.xcec126, #自由核算項6
       xcec127 LIKE xcec_t.xcec127, #自由核算項7
       xcec128 LIKE xcec_t.xcec128, #自由核算項8
       xcec129 LIKE xcec_t.xcec129, #自由核算項9
       xcec130 LIKE xcec_t.xcec130  #自由核算項10
               END RECORD
#161109-00085#19-e mod
#161109-00085#19-s mod
#DEFINE l_xccn          RECORD LIKE xmdl_t.*   #161109-00085#19-s mark
DEFINE l_xccn          RECORD  #出貨/簽收/銷退單單身明細檔
       xmdlent LIKE xmdl_t.xmdlent, #企業編號
       xmdlsite LIKE xmdl_t.xmdlsite, #營運據點
       xmdldocno LIKE xmdl_t.xmdldocno, #單據編號
       xmdlseq LIKE xmdl_t.xmdlseq, #項次
       xmdl001 LIKE xmdl_t.xmdl001, #出通單號
       xmdl002 LIKE xmdl_t.xmdl002, #出通項次
       xmdl003 LIKE xmdl_t.xmdl003, #訂單單號
       xmdl004 LIKE xmdl_t.xmdl004, #訂單項次
       xmdl005 LIKE xmdl_t.xmdl005, #訂單項序
       xmdl006 LIKE xmdl_t.xmdl006, #訂單分批序
       xmdl007 LIKE xmdl_t.xmdl007, #子件特性
       xmdl008 LIKE xmdl_t.xmdl008, #料件編號
       xmdl009 LIKE xmdl_t.xmdl009, #產品特徵
       xmdl010 LIKE xmdl_t.xmdl010, #包裝容器
       xmdl011 LIKE xmdl_t.xmdl011, #作業編號
       xmdl012 LIKE xmdl_t.xmdl012, #作業序
       xmdl013 LIKE xmdl_t.xmdl013, #多庫儲批出貨
       xmdl014 LIKE xmdl_t.xmdl014, #庫位
       xmdl015 LIKE xmdl_t.xmdl015, #儲位
       xmdl016 LIKE xmdl_t.xmdl016, #批號
       xmdl017 LIKE xmdl_t.xmdl017, #出貨單位
       xmdl018 LIKE xmdl_t.xmdl018, #數量
       xmdl019 LIKE xmdl_t.xmdl019, #參考單位
       xmdl020 LIKE xmdl_t.xmdl020, #參考數量
       xmdl021 LIKE xmdl_t.xmdl021, #計價單位
       xmdl022 LIKE xmdl_t.xmdl022, #計價數量
       xmdl023 LIKE xmdl_t.xmdl023, #檢驗否
       xmdl024 LIKE xmdl_t.xmdl024, #單價
       xmdl025 LIKE xmdl_t.xmdl025, #稅別
       xmdl026 LIKE xmdl_t.xmdl026, #稅率
       xmdl027 LIKE xmdl_t.xmdl027, #未稅金額
       xmdl028 LIKE xmdl_t.xmdl028, #含稅金額
       xmdl029 LIKE xmdl_t.xmdl029, #稅額
       xmdl030 LIKE xmdl_t.xmdl030, #專案編號
       xmdl031 LIKE xmdl_t.xmdl031, #WBS編號
       xmdl032 LIKE xmdl_t.xmdl032, #活動編號
       xmdl033 LIKE xmdl_t.xmdl033, #客戶料號
       xmdl034 LIKE xmdl_t.xmdl034, #QPA
       xmdl035 LIKE xmdl_t.xmdl035, #已簽收量
       xmdl036 LIKE xmdl_t.xmdl036, #已簽退量
       xmdl037 LIKE xmdl_t.xmdl037, #已銷退量
       xmdl038 LIKE xmdl_t.xmdl038, #主帳套已立帳數量
       xmdl039 LIKE xmdl_t.xmdl039, #帳套二已立帳數量
       xmdl040 LIKE xmdl_t.xmdl040, #帳套三已立帳數量
       xmdl041 LIKE xmdl_t.xmdl041, #保稅否
       xmdl042 LIKE xmdl_t.xmdl042, #取價來源
       xmdl043 LIKE xmdl_t.xmdl043, #價格來源參考單號
       xmdl044 LIKE xmdl_t.xmdl044, #價格來源參考項次
       xmdl045 LIKE xmdl_t.xmdl045, #取出價格
       xmdl046 LIKE xmdl_t.xmdl046, #價差比
       xmdl047 LIKE xmdl_t.xmdl047, #已開發票數量
       xmdl048 LIKE xmdl_t.xmdl048, #發票編號
       xmdl049 LIKE xmdl_t.xmdl049, #發票號碼
       xmdl050 LIKE xmdl_t.xmdl050, #理由碼
       xmdl051 LIKE xmdl_t.xmdl051, #備註
       xmdl052 LIKE xmdl_t.xmdl052, #庫存管理特徵
       xmdl053 LIKE xmdl_t.xmdl053, #主帳套暫估數量
       xmdl054 LIKE xmdl_t.xmdl054, #帳套二暫估數量
       xmdl055 LIKE xmdl_t.xmdl055, #帳套三暫估數量
       xmdl081 LIKE xmdl_t.xmdl081, #簽退數量(簽收、簽退單使用)
       xmdl082 LIKE xmdl_t.xmdl082, #簽退參考數量(簽收、簽退單使用)
       xmdl083 LIKE xmdl_t.xmdl083, #簽退計價數量(簽收、簽退單使用)
       xmdl084 LIKE xmdl_t.xmdl084, #簽退理由碼(簽收、簽退單使用)
       xmdl085 LIKE xmdl_t.xmdl085, #訂單開立據點
       xmdl086 LIKE xmdl_t.xmdl086, #訂單多角性質
       xmdl087 LIKE xmdl_t.xmdl087, #需自立應收否
       xmdl088 LIKE xmdl_t.xmdl088, #多角流程編號
       xmdl089 LIKE xmdl_t.xmdl089, #QC單號
       xmdl090 LIKE xmdl_t.xmdl090, #判定項次
       xmdl091 LIKE xmdl_t.xmdl091, #判定結果
       xmdl092 LIKE xmdl_t.xmdl092, #借貨還量數量
       xmdl093 LIKE xmdl_t.xmdl093, #借貨還量參考數量
       xmdl200 LIKE xmdl_t.xmdl200, #銷售通路
       xmdl201 LIKE xmdl_t.xmdl201, #產品組編碼
       xmdl202 LIKE xmdl_t.xmdl202, #銷售範圍編碼
       xmdl203 LIKE xmdl_t.xmdl203, #銷售辦公室
       xmdl204 LIKE xmdl_t.xmdl204, #出貨包裝單位
       xmdl205 LIKE xmdl_t.xmdl205, #出貨包裝數量
       xmdl206 LIKE xmdl_t.xmdl206, #簽退包裝數量
       xmdl207 LIKE xmdl_t.xmdl207, #庫存鎖定等級
       xmdl208 LIKE xmdl_t.xmdl208, #標準價
       xmdl209 LIKE xmdl_t.xmdl209, #促銷價
       xmdl210 LIKE xmdl_t.xmdl210, #交易價
       xmdl211 LIKE xmdl_t.xmdl211, #折價金額
       xmdl212 LIKE xmdl_t.xmdl212, #銷售組織
       xmdl213 LIKE xmdl_t.xmdl213, #銷售人員
       xmdl214 LIKE xmdl_t.xmdl214, #銷售部門
       xmdl215 LIKE xmdl_t.xmdl215, #合約編號
       xmdl216 LIKE xmdl_t.xmdl216, #經營方式
       xmdl217 LIKE xmdl_t.xmdl217, #結算類型
       xmdl218 LIKE xmdl_t.xmdl218, #結算方式
       xmdl219 LIKE xmdl_t.xmdl219, #交易類型
       xmdl220 LIKE xmdl_t.xmdl220, #寄銷已核銷數量
       xmdl222 LIKE xmdl_t.xmdl222, #地區編號
       xmdl223 LIKE xmdl_t.xmdl223, #縣市編號
       xmdl224 LIKE xmdl_t.xmdl224, #省區編號
       xmdl225 LIKE xmdl_t.xmdl225, #區域編號
       xmdl226 LIKE xmdl_t.xmdl226, #商品條碼
       xmdlunit LIKE xmdl_t.xmdlunit, #應用組織
       xmdlorga LIKE xmdl_t.xmdlorga, #帳務組織
       #161109-00085#63 --s add     
       xmdlud001 LIKE xmdl_t.xmdlud001, #自定義欄位(文字)001
       xmdlud002 LIKE xmdl_t.xmdlud002, #自定義欄位(文字)002
       xmdlud003 LIKE xmdl_t.xmdlud003, #自定義欄位(文字)003
       xmdlud004 LIKE xmdl_t.xmdlud004, #自定義欄位(文字)004
       xmdlud005 LIKE xmdl_t.xmdlud005, #自定義欄位(文字)005
       xmdlud006 LIKE xmdl_t.xmdlud006, #自定義欄位(文字)006
       xmdlud007 LIKE xmdl_t.xmdlud007, #自定義欄位(文字)007
       xmdlud008 LIKE xmdl_t.xmdlud008, #自定義欄位(文字)008
       xmdlud009 LIKE xmdl_t.xmdlud009, #自定義欄位(文字)009
       xmdlud010 LIKE xmdl_t.xmdlud010, #自定義欄位(文字)010
       xmdlud011 LIKE xmdl_t.xmdlud011, #自定義欄位(數字)011
       xmdlud012 LIKE xmdl_t.xmdlud012, #自定義欄位(數字)012
       xmdlud013 LIKE xmdl_t.xmdlud013, #自定義欄位(數字)013
       xmdlud014 LIKE xmdl_t.xmdlud014, #自定義欄位(數字)014
       xmdlud015 LIKE xmdl_t.xmdlud015, #自定義欄位(數字)015
       xmdlud016 LIKE xmdl_t.xmdlud016, #自定義欄位(數字)016
       xmdlud017 LIKE xmdl_t.xmdlud017, #自定義欄位(數字)017
       xmdlud018 LIKE xmdl_t.xmdlud018, #自定義欄位(數字)018
       xmdlud019 LIKE xmdl_t.xmdlud019, #自定義欄位(數字)019
       xmdlud020 LIKE xmdl_t.xmdlud020, #自定義欄位(數字)020
       xmdlud021 LIKE xmdl_t.xmdlud021, #自定義欄位(日期時間)021
       xmdlud022 LIKE xmdl_t.xmdlud022, #自定義欄位(日期時間)022
       xmdlud023 LIKE xmdl_t.xmdlud023, #自定義欄位(日期時間)023
       xmdlud024 LIKE xmdl_t.xmdlud024, #自定義欄位(日期時間)024
       xmdlud025 LIKE xmdl_t.xmdlud025, #自定義欄位(日期時間)025
       xmdlud026 LIKE xmdl_t.xmdlud026, #自定義欄位(日期時間)026
       xmdlud027 LIKE xmdl_t.xmdlud027, #自定義欄位(日期時間)027
       xmdlud028 LIKE xmdl_t.xmdlud028, #自定義欄位(日期時間)028
       xmdlud029 LIKE xmdl_t.xmdlud029, #自定義欄位(日期時間)029
       xmdlud030 LIKE xmdl_t.xmdlud030, #自定義欄位(日期時間)030
       #161109-00085#63 --e add
       xmdl056 LIKE xmdl_t.xmdl056, #檢驗合格量     
       xmdl094 LIKE xmdl_t.xmdl094, #來源單號(銷退)
       xmdl095 LIKE xmdl_t.xmdl095, #項次(銷退)
       xmdl227 LIKE xmdl_t.xmdl227, #現金折扣單號
       xmdl228 LIKE xmdl_t.xmdl228, #現金折扣單項次
       xmdl057 LIKE xmdl_t.xmdl057, #有效日期
       xmdl058 LIKE xmdl_t.xmdl058, #製造日期
       xmdl096 LIKE xmdl_t.xmdl096, #來源項次 
       #xmdl059 LIKE xmdl_t.xmdl059  #161109-00085#63 mark
       xmdl059 LIKE xmdl_t.xmdl059, #客戶退貨量 #161109-00085#63 add
       xmdl060 LIKE xmdl_t.xmdl060  #放行狀態   #161109-00085#63 add
          END RECORD
#161109-00085#19-e mod
DEFINE l_sql           STRING
DEFINE l_sql1          STRING
DEFINE l_rate          LIKE type_t.num26_10
DEFINE l_rate1         LIKE type_t.num26_10
DEFINE ld_date         DATETIME YEAR TO SECOND
DEFINE l_glaa001       LIKE glaa_t.glaa001
DEFINE l_glaacomp      LIKE glaa_t.glaacomp
DEFINE l_glaa003       LIKE glaa_t.glaa003
DEFINE l_bdate         LIKE pjda_t.pjdadocdt
DEFINE l_edate         LIKE pjda_t.pjdadocdt
DEFINE l_glaa017       LIKE glaa_t.glaa017
DEFINE l_glaa021       LIKE glaa_t.glaa021
DEFINE l_xccn006       LIKE xccn_t.xccn006, 
       l_xccd007       LIKE xccd_t.xccd007, 
       l_xccd008       LIKE xccd_t.xccd008, 
       l_xccd301       LIKE xccd_t.xccd301, 
       l_xccn302       LIKE xccn_t.xccn302, 
       l_xccn302a      LIKE xccn_t.xccn302a,
       l_xccn302b      LIKE xccn_t.xccn302b,
       l_xccn302c      LIKE xccn_t.xccn302c,
       l_xccn302d      LIKE xccn_t.xccn302d,
       l_xccn302e      LIKE xccn_t.xccn302e,
       l_xccn302f      LIKE xccn_t.xccn302f,
       l_xccn302g      LIKE xccn_t.xccn302g,
       l_xccn302h      LIKE xccn_t.xccn302h
DEFINE l_sfaa057       LIKE sfaa_t.sfaa057
DEFINE l_sfaa009       LIKE sfaa_t.sfaa009
DEFINE l_sfaa028       LIKE sfaa_t.sfaa028
DEFINE l_sfaa029       LIKE sfaa_t.sfaa029
DEFINE l_sfaa017       LIKE sfaa_t.sfaa017
DEFINE l_sfaasite      LIKE sfaa_t.sfaasite

   LET g_success = 'Y'
   LET l_xcea.xceaent   = g_enterprise
   LET l_xcea.xceacomp  = g_xcea_m.xceacomp
   LET l_xcea.xceald    = g_xcea_m.xceald
   LET l_xcea.xcea001   = g_xcea_m.xcea001
   LET l_xcea.xcea002   = g_xcea002   #13投入 14结转
   LET l_xcea.xcea003   = g_xcea_m.xcea003
   LET l_xcea.xcea004   = g_xcea_m.xcea004
   LET l_xcea.xcea005   = g_xcea_m.xcea005
   LET l_xcea.xcea006   = g_xcea_m.xcea006
   LET l_xcea.xcea007   = g_xcea_m.xcea007
   LET l_xcea.xcea101   = ''
   LET l_xcea.xcea102   = ''
   LET l_xcea.xceaownid = g_user
   LET l_xcea.xceaowndp = g_dept
   LET l_xcea.xceacrtid = g_user
   LET l_xcea.xceacrtdp = g_dept 
   LET ld_date = cl_get_current()
   LET l_xcea.xceacrtdt = ld_date
   LET l_xcea.xceamodid = ""
   LET l_xcea.xceamoddt = ""
   LET l_xcea.xceacnfid = ""
   LET l_xcea.xceacnfdt = ""
   LET l_xcea.xceapstid = ""
   LET l_xcea.xceapstdt = ""
   LET l_xcea.xceastus  = 'N'
   CALL s_aooi200_fin_gen_docno(g_xcea_m.xceald,'','',g_xcea_m.xceadocno,g_xcea_m.xcea001,g_prog_name1)
    RETURNING l_success,l_xcea.xceadocno
   IF l_success  = 0  THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = 'apm-00003'
      LET g_errparam.extend = g_xcea_m.xceadocno
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET g_success = 'N'
      RETURN g_success
   END IF
   #161109-00085#20-s mod
#   INSERT INTO xcea_t VALUES(l_xcea.*)   #161109-00085#20-s mark
   #161109-00085#63 --s mark
   #INSERT INTO xcea_t(xceaent,xceacomp,xceald,xceadocno,xcea001,xcea002,xcea003,xcea004,xcea005,
   #                   xcea006,xcea007,xcea101,xcea102,xceaownid,xceaowndp,xceacrtid,xceacrtdp,xceacrtdt,
   #                   xceamodid,xceamoddt,xceacnfid,xceacnfdt,xceapstid,xceapstdt,xceastus,xceasite) 
   #            VALUES(l_xcea.xceaent,l_xcea.xceacomp,l_xcea.xceald,l_xcea.xceadocno,l_xcea.xcea001,
   #                   l_xcea.xcea002,l_xcea.xcea003,l_xcea.xcea004,l_xcea.xcea005,l_xcea.xcea006,
   #                   l_xcea.xcea007,l_xcea.xcea101,l_xcea.xcea102,l_xcea.xceaownid,l_xcea.xceaowndp,
   #                   l_xcea.xceacrtid,l_xcea.xceacrtdp,l_xcea.xceacrtdt,l_xcea.xceamodid,l_xcea.xceamoddt,
   #                   l_xcea.xceacnfid,l_xcea.xceacnfdt,l_xcea.xceapstid,l_xcea.xceapstdt,l_xcea.xceastus,l_xcea.xceasite)
   #161109-00085#63 --e mark
   #161109-00085#20-e mod
   #161109-00085#63 --s add
   INSERT INTO xcea_t(xceaent,xceacomp,xceald,xceadocno,xcea001,
                      xcea002,xcea003,xcea004,xcea005,xcea006,
                      xcea007,xcea101,xcea102,xceaownid,xceaowndp,
                      xceacrtid,xceacrtdp,xceacrtdt,xceamodid,xceamoddt,
                      xceacnfid,xceacnfdt,xceapstid,xceapstdt,xceastus,
                      xceaud001,xceaud002,xceaud003,xceaud004,xceaud005,
                      xceaud006,xceaud007,xceaud008,xceaud009,xceaud010,
                      xceaud011,xceaud012,xceaud013,xceaud014,xceaud015,
                      xceaud016,xceaud017,xceaud018,xceaud019,xceaud020,
                      xceaud021,xceaud022,xceaud023,xceaud024,xceaud025,
                      xceaud026,xceaud027,xceaud028,xceaud029,xceaud030,
                      xceasite)
   VALUES(l_xcea.xceaent,l_xcea.xceacomp,l_xcea.xceald,l_xcea.xceadocno,l_xcea.xcea001,
          l_xcea.xcea002,l_xcea.xcea003,l_xcea.xcea004,l_xcea.xcea005,l_xcea.xcea006,
          l_xcea.xcea007,l_xcea.xcea101,l_xcea.xcea102,l_xcea.xceaownid,l_xcea.xceaowndp,
          l_xcea.xceacrtid,l_xcea.xceacrtdp,l_xcea.xceacrtdt,l_xcea.xceamodid,l_xcea.xceamoddt,
          l_xcea.xceacnfid,l_xcea.xceacnfdt,l_xcea.xceapstid,l_xcea.xceapstdt,l_xcea.xceastus,
          l_xcea.xceaud001,l_xcea.xceaud002,l_xcea.xceaud003,l_xcea.xceaud004,l_xcea.xceaud005,
          l_xcea.xceaud006,l_xcea.xceaud007,l_xcea.xceaud008,l_xcea.xceaud009,l_xcea.xceaud010,
          l_xcea.xceaud011,l_xcea.xceaud012,l_xcea.xceaud013,l_xcea.xceaud014,l_xcea.xceaud015,
          l_xcea.xceaud016,l_xcea.xceaud017,l_xcea.xceaud018,l_xcea.xceaud019,l_xcea.xceaud020,
          l_xcea.xceaud021,l_xcea.xceaud022,l_xcea.xceaud023,l_xcea.xceaud024,l_xcea.xceaud025,
          l_xcea.xceaud026,l_xcea.xceaud027,l_xcea.xceaud028,l_xcea.xceaud029,l_xcea.xceaud030,
          l_xcea.xceasite)
   #161109-00085#63 --e add
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "xcea_t"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET g_success = 'N'
      RETURN g_success
   END IF
   LET g_xcea_m.xceadocno = l_xcea.xceadocno
   
   #根据账套获取币别、所属法人、会计周期参照表
   SELECT glaa017,glaa021 INTO l_glaa017,l_glaa021
     FROM glaa_t
    WHERE glaaent = g_enterprise
      AND glaald = g_xcea_m.xceald
   
   #根据年度期别算出起止单据日期
   CALL s_fin_date_get_period_range(g_glaa003,g_xcea_m.xcea004,g_xcea_m.xcea005)
      RETURNING l_bdate,l_edate
  
   LET g_sql = "SELECT sfaa003,sfaa009,sfaasite,sfaa017, ",
               "       sfaa028,sfaa029,sfaa057 ",   
               "  FROM sfaa_t ",
               " WHERE sfaaent = ",g_enterprise, 
               "   AND sfaadocno = ? "
   DECLARE axct701_01_sfaa_15 CURSOR FROM g_sql  

   LET g_sql = "SELECT pmaa090,pmaa241 FROM pmaa_t ",
               " WHERE pmaaent = ",g_enterprise, 
               "   AND pmaa001 = ? "
   DECLARE axct701_01_15_prep1 CURSOR FROM g_sql  

   LET g_sql = "SELECT ooef153 FROM ooef_t ",
               " WHERE ooefent = ",g_enterprise,
               "   AND ooef001 = ? "
   DECLARE axct701_01_15_prep2 CURSOR FROM g_sql
   
   LET g_sql = "SELECT ooeg004 FROM ooeg_t ",
               " WHERE ooegent = ",g_enterprise,
               "   AND ooeg001 = ? "
   DECLARE axct701_01_15_prep3 CURSOR FROM g_sql 
   
   LET g_sql = " SELECT imag011 FROM imag_t ",
               " WHERE imagent = ",g_enterprise,
               "   AND imagsite = ?",
               "   AND imag001 = ?"   
   DECLARE axct701_01_15_prep4 CURSOR FROM g_sql   
   
   #xceb单身            
   LET l_sql = " SELECT xccn302,xccn302a,xccn302b,xccn302c,xccn302d,xccn302e,xccn302f,xccn302g,xccn302h",
               " FROM xccn_t",
               "  WHERE xccnent  = '",g_enterprise,"' ",
               "    AND xccnld ='",g_xcea_m.xceald,"'",
               "    AND xccn001 = ? ",
               "    AND xccn003 = '",g_xcea_m.xcea003,"'",
               "    AND xccn004 = ",g_xcea_m.xcea004,
               "    AND xccn005 = ",g_xcea_m.xcea005,
               "    AND xccn302 <> 0 ",
               "    AND xccn006 = ?"
   DECLARE axct701_01_15_prep5 CURSOR FROM g_sql 
   
                       #工单单号,主件料号,特征，入库数量, 差异金额
   LET l_sql = " SELECT xccn006,xccd007,xccd008,xccd301,xccn302,xccn302a,xccn302b,xccn302c,xccn302d,xccn302e,xccn302f,xccn302g,xccn302h",
               " FROM xccn_t",
               " INNER JOIN xccd_t ON xccdent = xccnent AND xccnld = xccdld AND xccn001 = xccd001 AND xccn002 = xccd002 AND xccn003 = xccd003 AND xccn004 = xccd004 AND xccn005 = xccd005 AND xccn006 = xccd006", 
               "  WHERE xccnent  = '",g_enterprise,"' ",
               "    AND xccnld ='",g_xcea_m.xceald,"'",
               "    AND xccn001 = '1'",
               "    AND xccn003 = '",g_xcea_m.xcea003,"'",
               "    AND xccn004 = ",g_xcea_m.xcea004,
               "    AND xccn005 = ",g_xcea_m.xcea005,
               "    AND xccn302 <> 0 "
               
   PREPARE axct701_01_ins_15_p1 FROM l_sql
   DECLARE axct701_01_ins_15_c1 CURSOR FOR axct701_01_ins_15_p1
   FOREACH axct701_01_ins_15_c1 INTO l_xccn006,l_xccd007,l_xccd008,l_xccd301,l_xccn302,l_xccn302a,
                                     l_xccn302b,l_xccn302c,l_xccn302d,l_xccn302e,l_xccn302f,
                                     l_xccn302g,l_xccn302h

      INITIALIZE l_xceb.* TO NULL
      
      SELECT MAX(xcebseq) INTO l_xceb.xcebseq FROM xceb_t
       WHERE xcebent = g_enterprise AND xcebld = g_xcea_m.xceald
         AND xcebdocno = g_xcea_m.xceadocno
      IF cl_null(l_xceb.xcebseq) OR l_xceb.xcebseq = 0 THEN
         LET l_xceb.xcebseq = 1
      ELSE
         LET l_xceb.xcebseq = l_xceb.xcebseq + 1
      END IF 
      
      LET l_xceb.xcebent   = g_enterprise
      LET l_xceb.xcebcomp  = g_xcea_m.xceacomp
      LET l_xceb.xcebld    = g_xcea_m.xceald
      LET l_xceb.xcebdocno = g_xcea_m.xceadocno
      LET l_xceb.xceb001  = l_xccn006          #工单单号
 
      LET l_xceb.xceb004  = l_xccd007   #料件編號
      LET l_xceb.xceb005  = l_xccd008   #特性
      
      LET l_xceb.xceb101 = ' '          #科目编号
      CALL s_fin_get_account(g_xcea_m.xceald,'60','8912','25') RETURNING l_success,l_xceb.xceb101,l_errno

      IF cl_null(l_xceb.xceb101) THEN LET l_xceb.xceb101 = ' ' END IF
      LET l_xceb.xceb102  = ' '              #摘要
      #摘要#15在制转出成本与工单入库标准成本差异凭证摘要(axct715)
      CALL axct701_01_get_summ(g_xcea_m.xceald,'61','8925','15') RETURNING l_success,l_xceb.xceb102

      #抓取sfaa資料
      LET l_sfaa009 = ''
      LET l_sfaasite = ''
      LET l_sfaa017 = ''    
      LET l_sfaa028 = ''
      LET l_sfaa029 = ''  
      LET l_sfaa057 = ''  
      EXECUTE axct701_01_sfaa_15 USING l_xceb.xceb001 INTO l_xceb.xceb003,l_sfaa009,l_sfaasite,l_sfaa017,    
                                                           l_sfaa028,l_sfaa029,l_sfaa057
      
      IF l_sfaa057 = '2' THEN #委外
         #交易对象
         LET l_xceb.xceb111 = l_sfaa009
         #客群/區域  
         EXECUTE axct701_01_15_prep1 USING l_xceb.xceb111 INTO l_xceb.xceb112,l_xceb.xceb113  
      ELSE
         #交易对象
         LET l_xceb.xceb111 = ' '
         #客群
         LET l_xceb.xceb112 = ' '
         #區域 
        EXECUTE axct701_01_15_prep2 USING l_sfaasite INTO l_xceb.xceb113          
      END IF      
      
      #成本中心--暫用部門sfaa017抓取其歸屬成本中心
      EXECUTE axct701_01_15_prep3 USING l_sfaa017 INTO l_xceb.xceb114        
      
      #经营类别,渠道
      LET l_xceb.xceb115 = ' '
      LET l_xceb.xceb116 = ' '

      ##品類
      EXECUTE axct701_01_15_prep4 USING g_xcea_m.xceacomp,l_xceb.xceb004 INTO l_xceb.xceb117

      #品牌
      LET l_xceb.xceb118 = ' '
      #項目編號+WBS
      LET l_xceb.xceb119 = l_sfaa028
      LET l_xceb.xceb120 = l_sfaa029
      
      LET l_xceb.xceb103 = ' '  #成本域
      LET l_xceb.xceb110 = ' '  #原因碼         
      LET l_xceb.xceb107 = ' '  #人员
      LET l_xceb.xceb108 = ' '  #部门

      IF cl_null(l_xceb.xceb114) THEN LET l_xceb.xceb114 = l_xceb.xceb108 END IF  #成本中心为空就为部门
      LET l_xceb.xceb109 = l_xceb.xceb111  #账款对象
 
      LET l_xceb.xceb201 = l_xccd301   #入库数量
      LET l_xceb.xceb202  = l_xccn302  #成本金額(本位幣一)
      LET l_xceb.xceb202a = l_xccn302a  #成本-材料(本位幣一)
      LET l_xceb.xceb202b = l_xccn302b  #成本-人工(本位幣一)
      LET l_xceb.xceb202c = l_xccn302c  #成本-加工(本位幣一)
      LET l_xceb.xceb202d = l_xccn302d  #成本-制費一(本位幣一)
      LET l_xceb.xceb202e = l_xccn302e  #成本-制費二(本位幣一)
      LET l_xceb.xceb202f = l_xccn302f  #成本-制費三(本位幣一)
      LET l_xceb.xceb202g = l_xccn302g  #成本-制費四(本位幣一)
      LET l_xceb.xceb202h = l_xccn302h  #成本-制費五(本位幣一)
      
      #本位幣二
      IF g_glaa015 = 'Y' THEN
         EXECUTE axct701_01_15_prep5 USING '2',l_xccn006 INTO l_xceb.xceb212,l_xceb.xceb212a,l_xceb.xceb212b,
                                                              l_xceb.xceb212c,l_xceb.xceb212d,l_xceb.xceb212e,
                                                              l_xceb.xceb212f,l_xceb.xceb212g,l_xceb.xceb212h
                   
         IF cl_null(l_xceb.xceb212) THEN LET l_xceb.xceb212 = 0 END IF
         IF cl_null(l_xceb.xceb212a) THEN LET l_xceb.xceb212a = 0 END IF
         IF cl_null(l_xceb.xceb212b) THEN LET l_xceb.xceb212b = 0 END IF
         IF cl_null(l_xceb.xceb212c) THEN LET l_xceb.xceb212c = 0 END IF
         IF cl_null(l_xceb.xceb212d) THEN LET l_xceb.xceb212d = 0 END IF
         IF cl_null(l_xceb.xceb212e) THEN LET l_xceb.xceb212e = 0 END IF
         IF cl_null(l_xceb.xceb212f) THEN LET l_xceb.xceb212f = 0 END IF
         IF cl_null(l_xceb.xceb212g) THEN LET l_xceb.xceb212g = 0 END IF
         IF cl_null(l_xceb.xceb212h) THEN LET l_xceb.xceb212h = 0 END IF                            
         IF cl_null(l_xceb.xceb212)  THEN LET l_xceb.xceb212  = 0 END IF
      ELSE
         LET l_xceb.xceb212a = 0
         LET l_xceb.xceb212b = 0
         LET l_xceb.xceb212c = 0
         LET l_xceb.xceb212d = 0
         LET l_xceb.xceb212e = 0
         LET l_xceb.xceb212f = 0
         LET l_xceb.xceb212g = 0
         LET l_xceb.xceb212h = 0                            
         LET l_xceb.xceb212  = 0      
      END IF

      #本位幣三
      IF g_glaa019 = 'Y' THEN
         EXECUTE axct701_01_15_prep5 USING '3',l_xccn006 INTO l_xceb.xceb222,l_xceb.xceb222a,l_xceb.xceb222b,
                                                              l_xceb.xceb222c,l_xceb.xceb222d,l_xceb.xceb222e,
                                                              l_xceb.xceb222f,l_xceb.xceb222g,l_xceb.xceb222h
          
         IF cl_null(l_xceb.xceb222a) THEN LET l_xceb.xceb222a = 0 END IF
         IF cl_null(l_xceb.xceb222b) THEN LET l_xceb.xceb222b = 0 END IF
         IF cl_null(l_xceb.xceb222c) THEN LET l_xceb.xceb222c = 0 END IF
         IF cl_null(l_xceb.xceb222d) THEN LET l_xceb.xceb222d = 0 END IF
         IF cl_null(l_xceb.xceb222e) THEN LET l_xceb.xceb222e = 0 END IF
         IF cl_null(l_xceb.xceb222f) THEN LET l_xceb.xceb222f = 0 END IF
         IF cl_null(l_xceb.xceb222g) THEN LET l_xceb.xceb222g = 0 END IF
         IF cl_null(l_xceb.xceb222h) THEN LET l_xceb.xceb222h = 0 END IF                            
         IF cl_null(l_xceb.xceb222)  THEN LET l_xceb.xceb222  = 0 END IF
      ELSE
         LET l_xceb.xceb222a = 0
         LET l_xceb.xceb222b = 0
         LET l_xceb.xceb222c = 0
         LET l_xceb.xceb222d = 0
         LET l_xceb.xceb222e = 0
         LET l_xceb.xceb222f = 0
         LET l_xceb.xceb222g = 0
         LET l_xceb.xceb222h = 0                            
         LET l_xceb.xceb222  = 0      
      END IF

      LET l_xceb.xceb301  = ''    #憑證編號
      LET l_xceb.xceb302  = ''    #憑證項次
      #161109-00085#18-s mark
#      LET l_xceb.xcebud021= ''    #自定義欄位(日期時間)
#      LET l_xceb.xcebud022= ''    #自定義欄位(日期時間)
#      LET l_xceb.xcebud023= ''    #自定義欄位(日期時間)
#      LET l_xceb.xcebud024= ''    #自定義欄位(日期時間)
#      LET l_xceb.xcebud025= ''    #自定義欄位(日期時間)
#      LET l_xceb.xcebud026= ''    #自定義欄位(日期時間)
#      LET l_xceb.xcebud027= ''    #自定義欄位(日期時間)
#      LET l_xceb.xcebud028= ''    #自定義欄位(日期時間)
#      LET l_xceb.xcebud029= ''    #自定義欄位(日期時間)
#      LET l_xceb.xcebud030= ''    #自定義欄位(日期時間)
      
      #自由核算项1～10  
      LET l_xceb.xceb121 = ' '   #自由核算項1
      LET l_xceb.xceb122 = ' '   #自由核算項2
      LET l_xceb.xceb123 = ' '   #自由核算項3
      LET l_xceb.xceb124 = ' '   #自由核算項4
      LET l_xceb.xceb125 = ' '   #自由核算項5
      LET l_xceb.xceb126 = ' '   #自由核算項6
      LET l_xceb.xceb127 = ' '   #自由核算項7
      LET l_xceb.xceb128 = ' '   #自由核算項8
      LET l_xceb.xceb129 = ' '   #自由核算項9
      LET l_xceb.xceb130 = ' '   #自由核算項10
    
      CALL axct701_01_default_space_xceb(l_xceb.*) RETURNING l_xceb.xceb005,
                                                             l_xceb.xceb101,
                                                             l_xceb.xceb102,
                                                             l_xceb.xceb103,
                                                             l_xceb.xceb110,
                                                             l_xceb.xceb111,
                                                             l_xceb.xceb112,
                                                             l_xceb.xceb113,
                                                             l_xceb.xceb114,
                                                             l_xceb.xceb115,
                                                             l_xceb.xceb116,
                                                             l_xceb.xceb117,
                                                             l_xceb.xceb118,
                                                             l_xceb.xceb119,
                                                             l_xceb.xceb120,
                                                             l_xceb.xceb107,
                                                             l_xceb.xceb108,
                                                             l_xceb.xceb109,
                                                             l_xceb.xceb121,
                                                             l_xceb.xceb122,
                                                             l_xceb.xceb123,
                                                             l_xceb.xceb124,
                                                             l_xceb.xceb125,
                                                             l_xceb.xceb126,
                                                             l_xceb.xceb127,
                                                             l_xceb.xceb128,
                                                             l_xceb.xceb129,
                                                             l_xceb.xceb130

      #如果金额和数量都为0的话，则不产生此笔单身数据                                                             
      IF l_xceb.xceb201= 0 AND l_xceb.xceb202 = 0 THEN
         CONTINUE FOREACH
      END IF
      #161109-00085#20-s mod
#      INSERT INTO xceb_t VALUES(l_xceb.*)   #161109-00085#20-s mark
      #161109-00085#63 --s mark
      #INSERT INTO xceb_t(xcebent,xcebcomp,xcebld,xcebdocno,xcebseq,xceb001,xceb002,xceb003,xceb004,
      #                   xceb005,xceb101,xceb102,xceb103,xceb110,xceb111,xceb112,xceb113,xceb114,xceb115,
      #                   xceb116,xceb117,xceb118,xceb119,xceb120,xceb201,xceb202,xceb202a,xceb202b,xceb202c,
      #                   xceb202d,xceb202e,xceb202f,xceb202g,xceb202h,xceb212,xceb212a,xceb212b,xceb212c,
      #                   xceb212d,xceb212e,xceb212f,xceb212g,xceb212h,xceb222,xceb222a,xceb222b,xceb222c,
      #                   xceb222d,xceb222e,xceb222f,xceb222g,xceb222h,xceb301,xceb302,xceb107,xceb108,xceb109,
      #                   xceb121,xceb122,xceb123,xceb124,xceb125,xceb126,xceb127,xceb128,xceb129,xceb130,xceb131,xceb132) 
      #            VALUES(l_xceb.xcebent,l_xceb.xcebcomp,l_xceb.xcebld,l_xceb.xcebdocno,l_xceb.xcebseq,
      #                   l_xceb.xceb001,l_xceb.xceb002,l_xceb.xceb003,l_xceb.xceb004,l_xceb.xceb005,
      #                   l_xceb.xceb101,l_xceb.xceb102,l_xceb.xceb103,l_xceb.xceb110,l_xceb.xceb111,
      #                   l_xceb.xceb112,l_xceb.xceb113,l_xceb.xceb114,l_xceb.xceb115,l_xceb.xceb116,
      #                   l_xceb.xceb117,l_xceb.xceb118,l_xceb.xceb119,l_xceb.xceb120,l_xceb.xceb201,
      #                   l_xceb.xceb202,l_xceb.xceb202a,l_xceb.xceb202b,l_xceb.xceb202c,l_xceb.xceb202d,
      #                   l_xceb.xceb202e,l_xceb.xceb202f,l_xceb.xceb202g,l_xceb.xceb202h,l_xceb.xceb212,
      #                   l_xceb.xceb212a,l_xceb.xceb212b,l_xceb.xceb212c,l_xceb.xceb212d,l_xceb.xceb212e,
      #                   l_xceb.xceb212f,l_xceb.xceb212g,l_xceb.xceb212h,l_xceb.xceb222,l_xceb.xceb222a,
      #                   l_xceb.xceb222b,l_xceb.xceb222c,l_xceb.xceb222d,l_xceb.xceb222e,l_xceb.xceb222f,
      #                   l_xceb.xceb222g,l_xceb.xceb222h,l_xceb.xceb301,l_xceb.xceb302,l_xceb.xceb107,
      #                   l_xceb.xceb108,l_xceb.xceb109,l_xceb.xceb121,l_xceb.xceb122,l_xceb.xceb123,
      #                   l_xceb.xceb124,l_xceb.xceb125,l_xceb.xceb126,l_xceb.xceb127,l_xceb.xceb128,
      #                   l_xceb.xceb129,l_xceb.xceb130,l_xceb.xceb131,l_xceb.xceb132)
      #161109-00085#20-e mod
      #161109-00085#63 --e mark
      #161109-00085#63 --s add
      INSERT INTO xceb_t(xcebent,xcebcomp,xcebld,xcebdocno,xcebseq,
                         xceb001,xceb002,xceb003,xceb004,xceb005,
                         xceb101,xceb102,xceb103,xceb110,xceb111,
                         xceb112,xceb113,xceb114,xceb115,xceb116,
                         xceb117,xceb118,xceb119,xceb120,xceb201,
                         xceb202,xceb202a,xceb202b,xceb202c,xceb202d,
                         xceb202e,xceb202f,xceb202g,xceb202h,xceb212,
                         xceb212a,xceb212b,xceb212c,xceb212d,xceb212e,
                         xceb212f,xceb212g,xceb212h,xceb222,xceb222a,
                         xceb222b,xceb222c,xceb222d,xceb222e,xceb222f,
                         xceb222g,xceb222h,xceb301,xceb302,xcebud001,
                         xcebud002,xcebud003,xcebud004,xcebud005,xcebud006,
                         xcebud007,xcebud008,xcebud009,xcebud010,xcebud011,
                         xcebud012,xcebud013,xcebud014,xcebud015,xcebud016,
                         xcebud017,xcebud018,xcebud019,xcebud020,xcebud021,
                         xcebud022,xcebud023,xcebud024,xcebud025,xcebud026,
                         xcebud027,xcebud028,xcebud029,xcebud030,xceb107,
                         xceb108,xceb109,xceb121,xceb122,xceb123,
                         xceb124,xceb125,xceb126,xceb127,xceb128,
                         xceb129,xceb130,xceb131,xceb132)
      VALUES(l_xceb.xcebent,l_xceb.xcebcomp,l_xceb.xcebld,l_xceb.xcebdocno,l_xceb.xcebseq,
             l_xceb.xceb001,l_xceb.xceb002,l_xceb.xceb003,l_xceb.xceb004,l_xceb.xceb005,
             l_xceb.xceb101,l_xceb.xceb102,l_xceb.xceb103,l_xceb.xceb110,l_xceb.xceb111,
             l_xceb.xceb112,l_xceb.xceb113,l_xceb.xceb114,l_xceb.xceb115,l_xceb.xceb116,
             l_xceb.xceb117,l_xceb.xceb118,l_xceb.xceb119,l_xceb.xceb120,l_xceb.xceb201,
             l_xceb.xceb202,l_xceb.xceb202a,l_xceb.xceb202b,l_xceb.xceb202c,l_xceb.xceb202d,
             l_xceb.xceb202e,l_xceb.xceb202f,l_xceb.xceb202g,l_xceb.xceb202h,l_xceb.xceb212,
             l_xceb.xceb212a,l_xceb.xceb212b,l_xceb.xceb212c,l_xceb.xceb212d,l_xceb.xceb212e,
             l_xceb.xceb212f,l_xceb.xceb212g,l_xceb.xceb212h,l_xceb.xceb222,l_xceb.xceb222a,
             l_xceb.xceb222b,l_xceb.xceb222c,l_xceb.xceb222d,l_xceb.xceb222e,l_xceb.xceb222f,
             l_xceb.xceb222g,l_xceb.xceb222h,l_xceb.xceb301,l_xceb.xceb302,l_xceb.xcebud001,
             l_xceb.xcebud002,l_xceb.xcebud003,l_xceb.xcebud004,l_xceb.xcebud005,l_xceb.xcebud006,
             l_xceb.xcebud007,l_xceb.xcebud008,l_xceb.xcebud009,l_xceb.xcebud010,l_xceb.xcebud011,
             l_xceb.xcebud012,l_xceb.xcebud013,l_xceb.xcebud014,l_xceb.xcebud015,l_xceb.xcebud016,
             l_xceb.xcebud017,l_xceb.xcebud018,l_xceb.xcebud019,l_xceb.xcebud020,l_xceb.xcebud021,
             l_xceb.xcebud022,l_xceb.xcebud023,l_xceb.xcebud024,l_xceb.xcebud025,l_xceb.xcebud026,
             l_xceb.xcebud027,l_xceb.xcebud028,l_xceb.xcebud029,l_xceb.xcebud030,l_xceb.xceb107,
             l_xceb.xceb108,l_xceb.xceb109,l_xceb.xceb121,l_xceb.xceb122,l_xceb.xceb123,
             l_xceb.xceb124,l_xceb.xceb125,l_xceb.xceb126,l_xceb.xceb127,l_xceb.xceb128,
             l_xceb.xceb129,l_xceb.xceb130,l_xceb.xceb131,l_xceb.xceb132)
      #161109-00085#63 --e add
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "ins xceb_t"
         LET g_errparam.popup = TRUE
         CALL cl_err()
         LET g_success = 'N'
         EXIT FOREACH
      END IF
       
      #xcec 
      INITIALIZE l_xcec.* TO NULL
     
      SELECT MAX(xcecseq) INTO l_xcec.xcecseq FROM xcec_t
       WHERE xcecent = g_enterprise AND xcecld = g_xcea_m.xceald
         AND xcecdocno = g_xcea_m.xceadocno
      IF cl_null(l_xcec.xcecseq) OR l_xcec.xcecseq = 0 THEN
         LET l_xcec.xcecseq = 1
      ELSE
         LET l_xcec.xcecseq = l_xcec.xcecseq + 1
      END IF 
      
      LET l_xcec.xcecent  = g_enterprise       #企業編號
      LET l_xcec.xcecld   = g_xcea_m.xceald    #帳套
      LET l_xcec.xceccomp = g_xcea_m.xceacomp  #法人組織
      LET l_xcec.xcecdocno= g_xcea_m.xceadocno #單據編號
      LET l_xcec.xcec001  = l_xceb.xceb001     #參考單據
      LET l_xcec.xcec002  = l_xceb.xceb002     #參考單據項次
      LET l_xcec.xcec003  = l_xceb.xceb003     #單據類型
      LET l_xcec.xcec004  = l_xceb.xceb004     #料件編號
      LET l_xcec.xcec005  = l_xceb.xceb005     #特性

      SELECT xceb001,xceb002,xceb003,xceb004,xceb005,
             xceb101,xceb102,xceb103,xceb110,xceb111,
             xceb112,xceb113,xceb114,xceb115,xceb116,
             xceb117,xceb118,xceb119,xceb120,
             xceb107,xceb108,xceb109,xceb121,xceb122,
             xceb123,xceb124,xceb125,xceb126,xceb127,
             xceb128,xceb129,xceb130  
        INTO l_xcec.xcec001,l_xcec.xcec002,l_xcec.xcec003,l_xcec.xcec004,l_xcec.xcec005,
             l_xcec.xcec101,l_xcec.xcec102,l_xcec.xcec103,l_xcec.xcec110,l_xcec.xcec111,
             l_xcec.xcec112,l_xcec.xcec113,l_xcec.xcec114,l_xcec.xcec115,l_xcec.xcec116,
             l_xcec.xcec117,l_xcec.xcec118,l_xcec.xcec119,l_xcec.xcec120,
             l_xcec.xcec107,l_xcec.xcec108,l_xcec.xcec109,l_xcec.xcec121,l_xcec.xcec122,
             l_xcec.xcec123,l_xcec.xcec124,l_xcec.xcec125,l_xcec.xcec126,l_xcec.xcec127,
             l_xcec.xcec128,l_xcec.xcec129,l_xcec.xcec130
        FROM xcea_t,xceb_t
       WHERE xceaent = xcebent AND xceald = xcebld AND xceadocno = xcebdocno
         AND xceaent = g_enterprise
         AND xceald = g_xcea_m.xceald
         AND xcea003 = g_xcea_m.xcea003
         AND xcea004 = g_xcea_m.xcea004
         AND xcea005 = g_xcea_m.xcea005
         AND xcea002 = '2'
         AND xceb001 = l_xceb.xceb001

      LET l_xcec.xcec201 = l_xceb.xceb201  #數量
      LET l_xcec.xcec202 = l_xceb.xceb202  #成本金額(本位幣一)
      LET l_xcec.xcec202a= l_xceb.xceb202a #成本-材料(本位幣一)
      LET l_xcec.xcec202b= l_xceb.xceb202b #成本-人工(本位幣一)
      LET l_xcec.xcec202c= l_xceb.xceb202c #成本-加工(本位幣一)
      LET l_xcec.xcec202d= l_xceb.xceb202d #成本-制費一(本位幣一)
      LET l_xcec.xcec202e= l_xceb.xceb202e #成本-制費二(本位幣一)
      LET l_xcec.xcec202f= l_xceb.xceb202f #成本-制費三(本位幣一)
      LET l_xcec.xcec202g= l_xceb.xceb202g #成本-制費四(本位幣一)
      LET l_xcec.xcec202h= l_xceb.xceb202h #成本-制費五(本位幣一)
      LET l_xcec.xcec212 = l_xceb.xceb212  #成本-金額(本位幣二)
      LET l_xcec.xcec212a= l_xceb.xceb212a
      LET l_xcec.xcec212b= l_xceb.xceb212b
      LET l_xcec.xcec212c= l_xceb.xceb212c
      LET l_xcec.xcec212d= l_xceb.xceb212d
      LET l_xcec.xcec212e= l_xceb.xceb212e
      LET l_xcec.xcec212f= l_xceb.xceb212f
      LET l_xcec.xcec212g= l_xceb.xceb212g
      LET l_xcec.xcec212h= l_xceb.xceb212h
      LET l_xcec.xcec222 = l_xceb.xceb222  #成本-金額(本位幣三)
      LET l_xcec.xcec222a= l_xceb.xceb222a
      LET l_xcec.xcec222b= l_xceb.xceb222b
      LET l_xcec.xcec222c= l_xceb.xceb222c
      LET l_xcec.xcec222d= l_xceb.xceb222d
      LET l_xcec.xcec222e= l_xceb.xceb222e
      LET l_xcec.xcec222f= l_xceb.xceb222f
      LET l_xcec.xcec222g= l_xceb.xceb222g
      LET l_xcec.xcec222h= l_xceb.xceb222h
      LET l_xcec.xcec301 = l_xceb.xceb301  #憑證編號
      LET l_xcec.xcec302 = l_xceb.xceb302  #憑證項次
      #161109-00085#19-s mark
#      LET l_xcec.xcecud021 = '' #自定義欄位(日期時間)
#      LET l_xcec.xcecud022 = '' #自定義欄位(日期時間)
#      LET l_xcec.xcecud023 = '' #自定義欄位(日期時間)
#      LET l_xcec.xcecud024 = '' #自定義欄位(日期時間)
#      LET l_xcec.xcecud025 = '' #自定義欄位(日期時間)
#      LET l_xcec.xcecud026 = '' #自定義欄位(日期時間)
#      LET l_xcec.xcecud027 = '' #自定義欄位(日期時間)
#      LET l_xcec.xcecud028 = '' #自定義欄位(日期時間)
#      LET l_xcec.xcecud029 = '' #自定義欄位(日期時間)
#      LET l_xcec.xcecud030 = '' #自定義欄位(日期時間)


      CALL axct701_01_default_space_xcec(l_xcec.*) RETURNING l_xcec.xcec005,   
                                                             l_xcec.xcec101,
                                                             l_xcec.xcec102,
                                                             l_xcec.xcec103,
                                                             l_xcec.xcec110,
                                                             l_xcec.xcec111,
                                                             l_xcec.xcec112,
                                                             l_xcec.xcec113,
                                                             l_xcec.xcec114,
                                                             l_xcec.xcec115,
                                                             l_xcec.xcec116,
                                                             l_xcec.xcec117,
                                                             l_xcec.xcec118,
                                                             l_xcec.xcec119,
                                                             l_xcec.xcec120,
                                                             l_xcec.xcec107,
                                                             l_xcec.xcec108,
                                                             l_xcec.xcec109,
                                                             l_xcec.xcec121,
                                                             l_xcec.xcec122,
                                                             l_xcec.xcec123,
                                                             l_xcec.xcec124,
                                                             l_xcec.xcec125,
                                                             l_xcec.xcec126,
                                                             l_xcec.xcec127,
                                                             l_xcec.xcec128,
                                                             l_xcec.xcec129,
                                                             l_xcec.xcec130                                        
      #如果金额和数量都为0的话，则不产生此笔单身数据                                                             
      IF l_xcec.xcec201= 0 AND l_xcec.xcec202 = 0 THEN
         CONTINUE FOREACH
      END IF       
      #161109-00085#20-s mod      
#      INSERT INTO xcec_t VALUES(l_xcec.*)   #161109-00085#20-s mark
      #161109-00085#63 --s mark
      #INSERT INTO xcec_t(xcecent,xceccomp,xcecld,xcecdocno,xcecseq,xcec001,xcec002,xcec003,xcec004,
      #                   xcec005,xcec101,xcec102,xcec103,xcec110,xcec111,xcec112,xcec113,xcec114,
      #                   xcec115,xcec116,xcec117,xcec118,xcec119,xcec120,xcec201,xcec202,xcec202a,
      #                   xcec202b,xcec202c,xcec202d,xcec202e,xcec202f,xcec202g,xcec202h,xcec212,
      #                   xcec212a,xcec212b,xcec212c,xcec212d,xcec212e,xcec212f,xcec212g,xcec212h,
      #                   xcec222,xcec222a,xcec222b,xcec222c,xcec222d,xcec222e,xcec222f,xcec222g,
      #                   xcec222h,xcec301,xcec302,xcec107,xcec108,xcec109,xcec121,xcec122,xcec123,
      #                   xcec124,xcec125,xcec126,xcec127,xcec128,xcec129,xcec130) 
      #            VALUES(l_xcec.xcecent,l_xcec.xceccomp,l_xcec.xcecld,l_xcec.xcecdocno,l_xcec.xcecseq,
      #                   l_xcec.xcec001,l_xcec.xcec002,l_xcec.xcec003,l_xcec.xcec004,l_xcec.xcec005,
      #                   l_xcec.xcec101,l_xcec.xcec102,l_xcec.xcec103,l_xcec.xcec110,l_xcec.xcec111,
      #                   l_xcec.xcec112,l_xcec.xcec113,l_xcec.xcec114,l_xcec.xcec115,l_xcec.xcec116,
      #                   l_xcec.xcec117,l_xcec.xcec118,l_xcec.xcec119,l_xcec.xcec120,l_xcec.xcec201,
      #                   l_xcec.xcec202,l_xcec.xcec202a,l_xcec.xcec202b,l_xcec.xcec202c,l_xcec.xcec202d,
      #                   l_xcec.xcec202e,l_xcec.xcec202f,l_xcec.xcec202g,l_xcec.xcec202h,l_xcec.xcec212,
      #                   l_xcec.xcec212a,l_xcec.xcec212b,l_xcec.xcec212c,l_xcec.xcec212d,l_xcec.xcec212e,
      #                   l_xcec.xcec212f,l_xcec.xcec212g,l_xcec.xcec212h,l_xcec.xcec222,l_xcec.xcec222a,
      #                   l_xcec.xcec222b,l_xcec.xcec222c,l_xcec.xcec222d,l_xcec.xcec222e,l_xcec.xcec222f,
      #                   l_xcec.xcec222g,l_xcec.xcec222h,l_xcec.xcec301,l_xcec.xcec302,l_xcec.xcec107,
      #                   l_xcec.xcec108,l_xcec.xcec109,l_xcec.xcec121,l_xcec.xcec122,l_xcec.xcec123,
      #                   l_xcec.xcec124,l_xcec.xcec125,l_xcec.xcec126,l_xcec.xcec127,l_xcec.xcec128,
      #                   l_xcec.xcec129,l_xcec.xcec130)
      #161109-00085#63 --e mark
      #161109-00085#20-e mod
      #161109-00085#63 --s add
      INSERT INTO xcec_t(xcecent,xceccomp,xcecld,xcecdocno,xcecseq,
                         xcec001,xcec002,xcec003,xcec004,xcec005,
                         xcec101,xcec102,xcec103,xcec110,xcec111,
                         xcec112,xcec113,xcec114,xcec115,xcec116,
                         xcec117,xcec118,xcec119,xcec120,xcec201,
                         xcec202,xcec202a,xcec202b,xcec202c,xcec202d,
                         xcec202e,xcec202f,xcec202g,xcec202h,xcec212,
                         xcec212a,xcec212b,xcec212c,xcec212d,xcec212e,
                         xcec212f,xcec212g,xcec212h,xcec222,xcec222a,
                         xcec222b,xcec222c,xcec222d,xcec222e,xcec222f,
                         xcec222g,xcec222h,xcec301,xcec302,xcecud001,
                         xcecud002,xcecud003,xcecud004,xcecud005,xcecud006,
                         xcecud007,xcecud008,xcecud009,xcecud010,xcecud011,
                         xcecud012,xcecud013,xcecud014,xcecud015,xcecud016,
                         xcecud017,xcecud018,xcecud019,xcecud020,xcecud021,
                         xcecud022,xcecud023,xcecud024,xcecud025,xcecud026,
                         xcecud027,xcecud028,xcecud029,xcecud030,xcec107,
                         xcec108,xcec109,xcec121,xcec122,xcec123,
                         xcec124,xcec125,xcec126,xcec127,xcec128,
                         xcec129,xcec130)
      VALUES(l_xcec.xcecent,l_xcec.xceccomp,l_xcec.xcecld,l_xcec.xcecdocno,l_xcec.xcecseq,
             l_xcec.xcec001,l_xcec.xcec002,l_xcec.xcec003,l_xcec.xcec004,l_xcec.xcec005,
             l_xcec.xcec101,l_xcec.xcec102,l_xcec.xcec103,l_xcec.xcec110,l_xcec.xcec111,
             l_xcec.xcec112,l_xcec.xcec113,l_xcec.xcec114,l_xcec.xcec115,l_xcec.xcec116,
             l_xcec.xcec117,l_xcec.xcec118,l_xcec.xcec119,l_xcec.xcec120,l_xcec.xcec201,
             l_xcec.xcec202,l_xcec.xcec202a,l_xcec.xcec202b,l_xcec.xcec202c,l_xcec.xcec202d,
             l_xcec.xcec202e,l_xcec.xcec202f,l_xcec.xcec202g,l_xcec.xcec202h,l_xcec.xcec212,
             l_xcec.xcec212a,l_xcec.xcec212b,l_xcec.xcec212c,l_xcec.xcec212d,l_xcec.xcec212e,
             l_xcec.xcec212f,l_xcec.xcec212g,l_xcec.xcec212h,l_xcec.xcec222,l_xcec.xcec222a,
             l_xcec.xcec222b,l_xcec.xcec222c,l_xcec.xcec222d,l_xcec.xcec222e,l_xcec.xcec222f,
             l_xcec.xcec222g,l_xcec.xcec222h,l_xcec.xcec301,l_xcec.xcec302,l_xcec.xcecud001,
             l_xcec.xcecud002,l_xcec.xcecud003,l_xcec.xcecud004,l_xcec.xcecud005,l_xcec.xcecud006,
             l_xcec.xcecud007,l_xcec.xcecud008,l_xcec.xcecud009,l_xcec.xcecud010,l_xcec.xcecud011,
             l_xcec.xcecud012,l_xcec.xcecud013,l_xcec.xcecud014,l_xcec.xcecud015,l_xcec.xcecud016,
             l_xcec.xcecud017,l_xcec.xcecud018,l_xcec.xcecud019,l_xcec.xcecud020,l_xcec.xcecud021,
             l_xcec.xcecud022,l_xcec.xcecud023,l_xcec.xcecud024,l_xcec.xcecud025,l_xcec.xcecud026,
             l_xcec.xcecud027,l_xcec.xcecud028,l_xcec.xcecud029,l_xcec.xcecud030,l_xcec.xcec107,
             l_xcec.xcec108,l_xcec.xcec109,l_xcec.xcec121,l_xcec.xcec122,l_xcec.xcec123,
             l_xcec.xcec124,l_xcec.xcec125,l_xcec.xcec126,l_xcec.xcec127,l_xcec.xcec128,
             l_xcec.xcec129,l_xcec.xcec130)
      #161109-00085#63 --e add
      
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "ins xcec"
         LET g_errparam.popup = TRUE
         CALL cl_err()
         LET g_success = 'N'
         EXIT FOREACH
      END IF
      
   END FOREACH   
   RETURN g_success
END FUNCTION
#160106-00014#1 add
################################################################################
# Descriptions...: 價差量差成本差異分攤新增   15.價差量差分攤憑證  axct716
# Memo...........:
# Usage..........: CALL axct701_01_ins_16()
# Input parameter: 原先为：CALL axct701_01_ins_15()
# Return code....:  
# Date & Author..: 2016/2/27 By lixiang
# Modify.........: 2016/06/24 By zhujing
################################################################################
PRIVATE FUNCTION axct701_01_ins_16()
#161109-00085#19-s mod
#DEFINE l_xcea          RECORD LIKE xcea_t.*   #161109-00085#19-s mark
DEFINE l_xcea          RECORD  #工單發料成本憑證單頭檔
       xceaent LIKE xcea_t.xceaent, #企業編號
       xceacomp LIKE xcea_t.xceacomp, #法人組織
       xceald LIKE xcea_t.xceald, #帳套
       xceadocno LIKE xcea_t.xceadocno, #單據編號
       xcea001 LIKE xcea_t.xcea001, #單據日期
       xcea002 LIKE xcea_t.xcea002, #成本憑證類型
       xcea003 LIKE xcea_t.xcea003, #成本計算類型
       xcea004 LIKE xcea_t.xcea004, #年度
       xcea005 LIKE xcea_t.xcea005, #期別
       xcea006 LIKE xcea_t.xcea006, #帳務人員
       xcea007 LIKE xcea_t.xcea007, #帳務部門
       xcea101 LIKE xcea_t.xcea101, #憑證編號
       xcea102 LIKE xcea_t.xcea102, #憑證日期
       xceaownid LIKE xcea_t.xceaownid, #資料所有者
       xceaowndp LIKE xcea_t.xceaowndp, #資料所屬部門
       xceacrtid LIKE xcea_t.xceacrtid, #資料建立者
       xceacrtdp LIKE xcea_t.xceacrtdp, #資料建立部門
       xceacrtdt LIKE xcea_t.xceacrtdt, #資料創建日
       xceamodid LIKE xcea_t.xceamodid, #資料修改者
       xceamoddt LIKE xcea_t.xceamoddt, #最近修改日
       xceacnfid LIKE xcea_t.xceacnfid, #資料確認者
       xceacnfdt LIKE xcea_t.xceacnfdt, #資料確認日
       xceapstid LIKE xcea_t.xceapstid, #資料過帳者
       xceapstdt LIKE xcea_t.xceapstdt, #資料過帳日
       xceastus LIKE xcea_t.xceastus, #狀態碼
       #161109-00085#63 --s add
       xceaud001 LIKE xcea_t.xceaud001, #自定義欄位(文字)001
       xceaud002 LIKE xcea_t.xceaud002, #自定義欄位(文字)002
       xceaud003 LIKE xcea_t.xceaud003, #自定義欄位(文字)003
       xceaud004 LIKE xcea_t.xceaud004, #自定義欄位(文字)004
       xceaud005 LIKE xcea_t.xceaud005, #自定義欄位(文字)005
       xceaud006 LIKE xcea_t.xceaud006, #自定義欄位(文字)006
       xceaud007 LIKE xcea_t.xceaud007, #自定義欄位(文字)007
       xceaud008 LIKE xcea_t.xceaud008, #自定義欄位(文字)008
       xceaud009 LIKE xcea_t.xceaud009, #自定義欄位(文字)009
       xceaud010 LIKE xcea_t.xceaud010, #自定義欄位(文字)010
       xceaud011 LIKE xcea_t.xceaud011, #自定義欄位(數字)011
       xceaud012 LIKE xcea_t.xceaud012, #自定義欄位(數字)012
       xceaud013 LIKE xcea_t.xceaud013, #自定義欄位(數字)013
       xceaud014 LIKE xcea_t.xceaud014, #自定義欄位(數字)014
       xceaud015 LIKE xcea_t.xceaud015, #自定義欄位(數字)015
       xceaud016 LIKE xcea_t.xceaud016, #自定義欄位(數字)016
       xceaud017 LIKE xcea_t.xceaud017, #自定義欄位(數字)017
       xceaud018 LIKE xcea_t.xceaud018, #自定義欄位(數字)018
       xceaud019 LIKE xcea_t.xceaud019, #自定義欄位(數字)019
       xceaud020 LIKE xcea_t.xceaud020, #自定義欄位(數字)020
       xceaud021 LIKE xcea_t.xceaud021, #自定義欄位(日期時間)021
       xceaud022 LIKE xcea_t.xceaud022, #自定義欄位(日期時間)022
       xceaud023 LIKE xcea_t.xceaud023, #自定義欄位(日期時間)023
       xceaud024 LIKE xcea_t.xceaud024, #自定義欄位(日期時間)024
       xceaud025 LIKE xcea_t.xceaud025, #自定義欄位(日期時間)025
       xceaud026 LIKE xcea_t.xceaud026, #自定義欄位(日期時間)026
       xceaud027 LIKE xcea_t.xceaud027, #自定義欄位(日期時間)027
       xceaud028 LIKE xcea_t.xceaud028, #自定義欄位(日期時間)028
       xceaud029 LIKE xcea_t.xceaud029, #自定義欄位(日期時間)029
       xceaud030 LIKE xcea_t.xceaud030, #自定義欄位(日期時間)030
       #161109-00085#63 --e add
       xceasite LIKE xcea_t.xceasite  #營運據點
          END RECORD
#161109-00085#19-e mod
#161109-00085#19-s mod
#DEFINE l_xceb          RECORD LIKE xceb_t.*   #161109-00085#19-s mark
DEFINE l_xceb         RECORD  #成本憑證第一單身檔
       xcebent LIKE xceb_t.xcebent, #企業編號
       xcebcomp LIKE xceb_t.xcebcomp, #法人組織
       xcebld LIKE xceb_t.xcebld, #帳套
       xcebdocno LIKE xceb_t.xcebdocno, #單據編號
       xcebseq LIKE xceb_t.xcebseq, #項次
       xceb001 LIKE xceb_t.xceb001, #參考單據編號
       xceb002 LIKE xceb_t.xceb002, #參考單據項次
       xceb003 LIKE xceb_t.xceb003, #單據類型
       xceb004 LIKE xceb_t.xceb004, #料件編號
       xceb005 LIKE xceb_t.xceb005, #特性
       xceb101 LIKE xceb_t.xceb101, #科目編號
       xceb102 LIKE xceb_t.xceb102, #摘要
       xceb103 LIKE xceb_t.xceb103, #成本域
       xceb110 LIKE xceb_t.xceb110, #原因碼
       xceb111 LIKE xceb_t.xceb111, #收付款客商
       xceb112 LIKE xceb_t.xceb112, #客群
       xceb113 LIKE xceb_t.xceb113, #區域
       xceb114 LIKE xceb_t.xceb114, #成本中心
       xceb115 LIKE xceb_t.xceb115, #經營類別
       xceb116 LIKE xceb_t.xceb116, #通路
       xceb117 LIKE xceb_t.xceb117, #品類
       xceb118 LIKE xceb_t.xceb118, #品牌
       xceb119 LIKE xceb_t.xceb119, #專案號
       xceb120 LIKE xceb_t.xceb120, #WBS
       xceb201 LIKE xceb_t.xceb201, #數量
       xceb202 LIKE xceb_t.xceb202, #成本金額(本位幣一)
       xceb202a LIKE xceb_t.xceb202a, #成本-材料(本位幣一)
       xceb202b LIKE xceb_t.xceb202b, #成本-人工(本位幣一)
       xceb202c LIKE xceb_t.xceb202c, #成本-加工(本位幣一)
       xceb202d LIKE xceb_t.xceb202d, #成本-制費一(本位幣一)
       xceb202e LIKE xceb_t.xceb202e, #成本-制費二(本位幣一)
       xceb202f LIKE xceb_t.xceb202f, #成本-制費三(本位幣一)
       xceb202g LIKE xceb_t.xceb202g, #成本-制費四(本位幣一)
       xceb202h LIKE xceb_t.xceb202h, #成本-制費五(本位幣一)
       xceb212 LIKE xceb_t.xceb212, #成本金額(本位幣二)
       xceb212a LIKE xceb_t.xceb212a, #成本-材料(本位幣二)
       xceb212b LIKE xceb_t.xceb212b, #成本-人工(本位幣二)
       xceb212c LIKE xceb_t.xceb212c, #成本-加工(本位幣二)
       xceb212d LIKE xceb_t.xceb212d, #成本-制費一(本位幣二)
       xceb212e LIKE xceb_t.xceb212e, #成本-制費二(本位幣二)
       xceb212f LIKE xceb_t.xceb212f, #成本-制費三(本位幣二)
       xceb212g LIKE xceb_t.xceb212g, #成本-制費四(本位幣二)
       xceb212h LIKE xceb_t.xceb212h, #成本-制費五(本位幣二)
       xceb222 LIKE xceb_t.xceb222, #成本金額(本位幣三)
       xceb222a LIKE xceb_t.xceb222a, #成本-材料(本位幣三)
       xceb222b LIKE xceb_t.xceb222b, #成本-人工(本位幣三)
       xceb222c LIKE xceb_t.xceb222c, #成本-加工(本位幣三)
       xceb222d LIKE xceb_t.xceb222d, #成本-制費一(本位幣三)
       xceb222e LIKE xceb_t.xceb222e, #成本-制費二(本位幣三)
       xceb222f LIKE xceb_t.xceb222f, #成本-制費三(本位幣三)
       xceb222g LIKE xceb_t.xceb222g, #成本-制費四(本位幣三)
       xceb222h LIKE xceb_t.xceb222h, #成本-制費五(本位幣三)
       xceb301 LIKE xceb_t.xceb301, #憑證編號
       xceb302 LIKE xceb_t.xceb302, #憑證項次
       #161109-00085#63 --s add  
       xcebud001 LIKE xceb_t.xcebud001, #自定義欄位(文字)001
       xcebud002 LIKE xceb_t.xcebud002, #自定義欄位(文字)002
       xcebud003 LIKE xceb_t.xcebud003, #自定義欄位(文字)003
       xcebud004 LIKE xceb_t.xcebud004, #自定義欄位(文字)004
       xcebud005 LIKE xceb_t.xcebud005, #自定義欄位(文字)005
       xcebud006 LIKE xceb_t.xcebud006, #自定義欄位(文字)006
       xcebud007 LIKE xceb_t.xcebud007, #自定義欄位(文字)007
       xcebud008 LIKE xceb_t.xcebud008, #自定義欄位(文字)008
       xcebud009 LIKE xceb_t.xcebud009, #自定義欄位(文字)009
       xcebud010 LIKE xceb_t.xcebud010, #自定義欄位(文字)010
       xcebud011 LIKE xceb_t.xcebud011, #自定義欄位(數字)011
       xcebud012 LIKE xceb_t.xcebud012, #自定義欄位(數字)012
       xcebud013 LIKE xceb_t.xcebud013, #自定義欄位(數字)013
       xcebud014 LIKE xceb_t.xcebud014, #自定義欄位(數字)014
       xcebud015 LIKE xceb_t.xcebud015, #自定義欄位(數字)015
       xcebud016 LIKE xceb_t.xcebud016, #自定義欄位(數字)016
       xcebud017 LIKE xceb_t.xcebud017, #自定義欄位(數字)017
       xcebud018 LIKE xceb_t.xcebud018, #自定義欄位(數字)018
       xcebud019 LIKE xceb_t.xcebud019, #自定義欄位(數字)019
       xcebud020 LIKE xceb_t.xcebud020, #自定義欄位(數字)020
       xcebud021 LIKE xceb_t.xcebud021, #自定義欄位(日期時間)021
       xcebud022 LIKE xceb_t.xcebud022, #自定義欄位(日期時間)022
       xcebud023 LIKE xceb_t.xcebud023, #自定義欄位(日期時間)023
       xcebud024 LIKE xceb_t.xcebud024, #自定義欄位(日期時間)024
       xcebud025 LIKE xceb_t.xcebud025, #自定義欄位(日期時間)025
       xcebud026 LIKE xceb_t.xcebud026, #自定義欄位(日期時間)026
       xcebud027 LIKE xceb_t.xcebud027, #自定義欄位(日期時間)027
       xcebud028 LIKE xceb_t.xcebud028, #自定義欄位(日期時間)028
       xcebud029 LIKE xceb_t.xcebud029, #自定義欄位(日期時間)029
       xcebud030 LIKE xceb_t.xcebud030, #自定義欄位(日期時間)030
       #161109-00085#63 --e add
       xceb107 LIKE xceb_t.xceb107, #人員
       xceb108 LIKE xceb_t.xceb108, #部門
       xceb109 LIKE xceb_t.xceb109, #帳款對象
       xceb121 LIKE xceb_t.xceb121, #自由核算項1
       xceb122 LIKE xceb_t.xceb122, #自由核算項2
       xceb123 LIKE xceb_t.xceb123, #自由核算項3
       xceb124 LIKE xceb_t.xceb124, #自由核算項4
       xceb125 LIKE xceb_t.xceb125, #自由核算項5
       xceb126 LIKE xceb_t.xceb126, #自由核算項6
       xceb127 LIKE xceb_t.xceb127, #自由核算項7
       xceb128 LIKE xceb_t.xceb128, #自由核算項8
       xceb129 LIKE xceb_t.xceb129, #自由核算項9
       xceb130 LIKE xceb_t.xceb130, #自由核算項10
       xceb131 LIKE xceb_t.xceb131, #單據類型(for 流通)
       xceb132 LIKE xceb_t.xceb132  #單據日期(for 流通)
          END RECORD
#161109-00085#19-e mod
DEFINE l_sfaa052       LIKE sfaa_t.sfaa052
DEFINE l_sfaa009       LIKE sfaa_t.sfaa009
DEFINE l_sfaa028       LIKE sfaa_t.sfaa028
DEFINE l_sfaa029       LIKE sfaa_t.sfaa029
DEFINE l_sfaasite      LIKE sfaa_t.sfaasite
DEFINE l_sfaa017       LIKE sfaa_t.sfaa017
DEFINE ld_date         DATETIME YEAR TO SECOND
DEFINE l_success       LIKE type_t.num5
DEFINE l_errno         LIKE gzze_t.gzze001
DEFINE l_xcan002       LIKE xcan_t.xcan002
DEFINE l_xcan003       LIKE xcan_t.xcan003
DEFINE l_xcan004       LIKE xcan_t.xcan004
#161109-00085#19-s mod
#DEFINE l_glar          RECORD LIKE glar_t.*   #161109-00085#19-s mark
DEFINE l_glar          RECORD  #會計科目各期餘額檔
       glarent LIKE glar_t.glarent, #企業編號
       glarcomp LIKE glar_t.glarcomp, #法人
       glarld LIKE glar_t.glarld, #帳套
       glar001 LIKE glar_t.glar001, #會計科目
       glar002 LIKE glar_t.glar002, #年度
       glar003 LIKE glar_t.glar003, #期別
       glar004 LIKE glar_t.glar004, #組合要素(key)
       glar005 LIKE glar_t.glar005, #借方金額
       glar006 LIKE glar_t.glar006, #貸方金額
       glar007 LIKE glar_t.glar007, #借方筆數
       glar008 LIKE glar_t.glar008, #貸方筆數
       glar009 LIKE glar_t.glar009, #交易幣別
       glar010 LIKE glar_t.glar010, #原幣借方金額
       glar011 LIKE glar_t.glar011, #原幣貸方金額
       glar012 LIKE glar_t.glar012, #營運據點
       glar013 LIKE glar_t.glar013, #部門
       glar014 LIKE glar_t.glar014, #利潤/成本中心
       glar015 LIKE glar_t.glar015, #區域
       glar016 LIKE glar_t.glar016, #收付款客商
       glar017 LIKE glar_t.glar017, #帳款客商
       glar018 LIKE glar_t.glar018, #客群
       glar019 LIKE glar_t.glar019, #產品類別
       glar020 LIKE glar_t.glar020, #人員
       glar021 LIKE glar_t.glar021, #no use
       glar022 LIKE glar_t.glar022, #專案編號
       glar023 LIKE glar_t.glar023, #WBS
       glar024 LIKE glar_t.glar024, #自由核算項一
       glar025 LIKE glar_t.glar025, #自由核算項二
       glar026 LIKE glar_t.glar026, #自由核算項三
       glar027 LIKE glar_t.glar027, #自由核算項四
       glar028 LIKE glar_t.glar028, #自由核算項五
       glar029 LIKE glar_t.glar029, #自由核算項六
       glar030 LIKE glar_t.glar030, #自由核算項七
       glar031 LIKE glar_t.glar031, #自由核算項八
       glar032 LIKE glar_t.glar032, #自由核算項九
       glar033 LIKE glar_t.glar033, #自由核算項十
       glar034 LIKE glar_t.glar034, #借方金額(本位幣二)
       glar035 LIKE glar_t.glar035, #貸方金額(本位幣二)
       glar036 LIKE glar_t.glar036, #借方金額(本位幣三)
       glar037 LIKE glar_t.glar037, #貸方金額(本位幣三)
       glar051 LIKE glar_t.glar051, #經營方式
       glar052 LIKE glar_t.glar052, #通路
       glar053 LIKE glar_t.glar053  #品牌
          END RECORD
#161109-00085#19-e mod
DEFINE r_success       LIKE type_t.num5
DEFINE l_xcec003       LIKE xcec_t.xcec003
DEFINE l_xcec202       LIKE xcec_t.xcec202
DEFINE l_xcec212       LIKE xcec_t.xcec212
DEFINE l_xcec222       LIKE xcec_t.xcec222
DEFINE l_count         LIKE type_t.num5
DEFINE l_xcap001       LIKE xcap_t.xcap001
DEFINE l_xcapseq       LIKE xcap_t.xcapseq
DEFINE l_rate          LIKE inaj_t.inaj014
DEFINE l_amount1       LIKE xceb_t.xceb202
DEFINE l_amount2       LIKE xceb_t.xceb212
DEFINE l_amount3       LIKE xceb_t.xceb222
#161109-00085#19-s mod
#DEFINE l_xcaq          RECORD LIKE xcaq_t.*   #161109-00085#19-s mark
DEFINE l_xcaq          RECORD  #成本差異分攤對象科目設定檔
       xcaqent LIKE xcaq_t.xcaqent, #企業編號
       xcaqld LIKE xcaq_t.xcaqld, #帳套編號
       xcaqseq LIKE xcaq_t.xcaqseq, #項次
       xcaq001 LIKE xcaq_t.xcaq001, #差異科目分類
       xcaq002 LIKE xcaq_t.xcaq002, #分攤公式類型
       xcaq003 LIKE xcaq_t.xcaq003, #分攤對象科目編碼
       xcaq004 LIKE xcaq_t.xcaq004, #摘要
       xcaq005 LIKE xcaq_t.xcaq005, #借/貸
       xcaq006 LIKE xcaq_t.xcaq006, #分攤率%
       xcaq007 LIKE xcaq_t.xcaq007, #營運據點
       xcaq008 LIKE xcaq_t.xcaq008, #人員
       xcaq009 LIKE xcaq_t.xcaq009, #部門
       xcaq010 LIKE xcaq_t.xcaq010, #交易客商
       xcaq011 LIKE xcaq_t.xcaq011, #帳款客戶
       xcaq012 LIKE xcaq_t.xcaq012, #客群
       xcaq013 LIKE xcaq_t.xcaq013, #區域
       xcaq014 LIKE xcaq_t.xcaq014, #利潤/成本中心
       xcaq015 LIKE xcaq_t.xcaq015, #經營方式
       xcaq016 LIKE xcaq_t.xcaq016, #通路
       xcaq017 LIKE xcaq_t.xcaq017, #產品類別
       xcaq018 LIKE xcaq_t.xcaq018, #品牌
       xcaq019 LIKE xcaq_t.xcaq019, #專案編號
       xcaq020 LIKE xcaq_t.xcaq020, #WBS
       xcaq021 LIKE xcaq_t.xcaq021, #自由核算項一
       xcaq022 LIKE xcaq_t.xcaq022, #自由核算項二
       xcaq023 LIKE xcaq_t.xcaq023, #自由核算項三
       xcaq024 LIKE xcaq_t.xcaq024, #自由核算項四
       xcaq025 LIKE xcaq_t.xcaq025, #自由核算項五
       xcaq026 LIKE xcaq_t.xcaq026, #自由核算項六
       xcaq027 LIKE xcaq_t.xcaq027, #自由核算項七
       xcaq028 LIKE xcaq_t.xcaq028, #自由核算項八
       xcaq029 LIKE xcaq_t.xcaq029, #自由核算項九
       xcaq030 LIKE xcaq_t.xcaq030  #自由核算項十
          END RECORD
#161109-00085#19-e mod
DEFINE l_glaa004       LIKE glaa_t.glaa004
DEFINE l_glac008       LIKE glac_t.glac008


   LET r_success = TRUE
   
   LET l_xcea.xceaownid = g_user
   LET l_xcea.xceaowndp = g_dept
   LET l_xcea.xceacrtid = g_user
   LET l_xcea.xceacrtdp = g_dept 
   LET ld_date  = cl_get_current()
   LET l_xcea.xceacrtdt = ld_date
   LET l_xcea.xceamodid = g_user
   LET l_xcea.xceamoddt = ld_date
   CALL s_aooi200_fin_gen_docno(g_xcea_m.xceald,'','',g_xcea_m.xceadocno,g_xcea_m.xcea001,g_prog_name1)      #wujie 150214
    RETURNING l_success,g_xcea_m.xceadocno
   IF l_success  = 0  THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = 'apm-00003'
      LET g_errparam.extend = g_xcea_m.xceadocno
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   INSERT INTO xcea_t (xceaent,xceald,xceacomp,xcea006,xceadocno,xcea001,xcea002,xcea004, 
       xcea005,xcea003,xceastus,xceaownid,xceaowndp,xceacrtid,xceacrtdp,xceacrtdt, 
       xceamodid,xceamoddt)
   VALUES (g_enterprise,g_xcea_m.xceald,g_xcea_m.xceacomp,g_xcea_m.xcea006,g_xcea_m.xceadocno, 
       g_xcea_m.xcea001,g_xcea002,g_xcea_m.xcea004,g_xcea_m.xcea005,g_xcea_m.xcea003, 
       'N',l_xcea.xceaownid,l_xcea.xceaowndp,l_xcea.xceacrtid, 
       l_xcea.xceacrtdp,l_xcea.xceacrtdt,l_xcea.xceamodid,l_xcea.xceamoddt) 
       
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "ins xcea"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   #根据INPUT的帐套和QBE条件中的差异成本分类从axci011（档案xcan_t）中的科目范围和取值设定从glar_t中抓取金额，按科目+固定核算项+自定义核算项产生到第二个单身（成本差异来源明细）
   LET g_sql = " SELECT DISTINCT xcan002,xcan003,xcan004 FROM xcan_t ",
               " WHERE xcanent = '",g_enterprise,"' AND xcanld = '",g_xcea_m.xceald,"'",
               "   AND xcanstus = 'Y' "
   IF NOT cl_null(g_wc) THEN
      LET g_sql = g_sql , " AND " , g_wc
   END IF
   PREPARE xcan_prep FROM g_sql
   DECLARE xcan_curs CURSOR FOR xcan_prep
   
   #根据axci011中的科目对应的数据来源,抓取对应的资料
   LET g_sql1 = " SELECT glar001,glar013,glar014,glar015,glar016,glar017,glar018,glar019,glar020,glar022,glar023,glar051,glar052,glar053, ",
                "        glar024,glar025,glar026,glar027,glar028,glar029,glar030,glar031,glar032,glar033 "
                
   LET g_sql2 = " FROM glar_t ",
                " WHERE glarent = ",g_enterprise," AND glarld = '",g_xcea_m.xceald,"'",
                "   AND glar002 = ",g_xcea_m.xcea004,
                "   AND glar001 = ?  "
                
   LET g_sql3 = " GROUP BY glar001,glar013,glar014,glar015,glar016,glar017,glar018,glar019,glar020,glar022,glar023,glar051,glar052,glar053, ",
                "          glar024,glar025,glar026,glar027,glar028,glar029,glar030,glar031,glar032,glar033 "
   
   #1 本期发生额 借方 - 贷方，根据科目的正常余额型态glac008 栏位，若1 借 - 贷 ，若2 贷 - 借 [ （借-贷）* （-1）]   
   LET g_sql = g_sql1 , " , SUM(glar005 - glar006) , SUM(glar034 - glar035) ,SUM(glar036 - glar037)  " , g_sql2 , " AND glar003 = ",g_xcea_m.xcea005, g_sql3
   PREPARE glar_prep1 FROM g_sql
   DECLARE glar_curs1 CURSOR FOR glar_prep1
   
   #2 期末余额
   LET g_sql = g_sql1 , " , SUM(glar005 - glar006) , SUM(glar034 - glar035) ,SUM(glar036 - glar037)   " , g_sql2 , " AND glar003 <= ",g_xcea_m.xcea005, g_sql3
   PREPARE glar_prep2 FROM g_sql
   DECLARE glar_curs2 CURSOR FOR glar_prep2
   
   #3 期初借方余额
   LET g_sql = g_sql1 , " , SUM(glar005) , SUM(glar034) ,SUM(glar036)   " , g_sql2 , " AND glar003 < ",g_xcea_m.xcea005, g_sql3
   PREPARE glar_prep3 FROM g_sql
   DECLARE glar_curs3 CURSOR FOR glar_prep3
   
   #4 期初贷方余额
   LET g_sql = g_sql1 , " , SUM(glar006) , SUM(glar035) ,SUM(glar037)   " , g_sql2 , " AND glar003 < ",g_xcea_m.xcea005, g_sql3
   PREPARE glar_prep4 FROM g_sql
   DECLARE glar_curs4 CURSOR FOR glar_prep4
   
   #5 本期借方发生额
   LET g_sql = g_sql1 , " , SUM(glar005) , SUM(glar034) ,SUM(glar036)   " , g_sql2 , " AND glar003 = ",g_xcea_m.xcea005, g_sql3
   PREPARE glar_prep5 FROM g_sql
   DECLARE glar_curs5 CURSOR FOR glar_prep5
   
   #6 本期贷方发生额
   LET g_sql = g_sql1 , " , SUM(glar006) , SUM(glar035) ,SUM(glar037)   " , g_sql2 , " AND glar003 = ",g_xcea_m.xcea005, g_sql3
   PREPARE glar_prep6 FROM g_sql
   DECLARE glar_curs6 CURSOR FOR glar_prep6
   
   #7 借方累计发生额
   LET g_sql = g_sql1 , " , SUM(glar005) , SUM(glar034) ,SUM(glar036)   " , g_sql2 , " AND glar003 >= 1 AND glar003 <= ",g_xcea_m.xcea005, g_sql3
   PREPARE glar_prep7 FROM g_sql
   DECLARE glar_curs7 CURSOR FOR glar_prep7
   
   #8 贷方累计发生额
   LET g_sql = g_sql1 , " , SUM(glar006) , SUM(glar035) ,SUM(glar037)   " , g_sql2 , " AND glar003 >= 1 AND glar003 <= ",g_xcea_m.xcea005, g_sql3
   PREPARE glar_prep8 FROM g_sql
   DECLARE glar_curs8 CURSOR FOR glar_prep8
   
   FOREACH xcan_curs INTO l_xcan002,l_xcan003,l_xcan004                     
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "foreach xcan"
         LET g_errparam.popup = TRUE
         CALL cl_err()
         LET r_success = FALSE
         RETURN r_success
      END IF  
      
      IF l_xcan004 = '1' THEN
         FOREACH glar_curs1 USING l_xcan002 INTO l_glar.glar001,l_glar.glar013,l_glar.glar014,l_glar.glar015,l_glar.glar016,l_glar.glar017,
                                                 l_glar.glar018,l_glar.glar019,l_glar.glar020,l_glar.glar022,l_glar.glar023,l_glar.glar051,
                                                 l_glar.glar052,l_glar.glar053,l_glar.glar024,l_glar.glar025,l_glar.glar026,l_glar.glar027,
                                                 l_glar.glar028,l_glar.glar029,l_glar.glar030,l_glar.glar031,l_glar.glar032,l_glar.glar033,
                                                 l_glar.glar005,l_glar.glar034,l_glar.glar036
                                                 
            #科目餘額型態是貸方，（借 - 貸）* (-1)
            SELECT glaa004 INTO l_glaa004 FROM glaa_t WHERE glaaent = g_enterprise AND glaald = g_xcea_m.xceald
            SELECT glac008 INTO l_glac008 FROM glac_t WHERE glacent = g_enterprise AND glac001 = l_glaa004 AND glac002 = l_glar.glar001
            IF l_glac008 = '2' THEN
               LET l_glar.glar005  = l_glar.glar005 * (-1)
            END IF
      
            #160617-00002#4 mod-S
#            IF NOT axct701_01_ins_15_xcec(l_glar.*,l_xcan003) THEN
            IF NOT axct701_01_ins_16_xcec(l_glar.*,l_xcan003) THEN
            #160617-00002#4 mod-E
               LET r_success = FALSE
               RETURN r_success
            END IF
         END FOREACH                                       
      END IF

      IF l_xcan004 = '2' THEN
         FOREACH glar_curs2 USING l_xcan002 INTO l_glar.glar001,l_glar.glar013,l_glar.glar014,l_glar.glar015,l_glar.glar016,l_glar.glar017,
                                                 l_glar.glar018,l_glar.glar019,l_glar.glar020,l_glar.glar022,l_glar.glar023,l_glar.glar051,
                                                 l_glar.glar052,l_glar.glar053,l_glar.glar024,l_glar.glar025,l_glar.glar026,l_glar.glar027,
                                                 l_glar.glar028,l_glar.glar029,l_glar.glar030,l_glar.glar031,l_glar.glar032,l_glar.glar033,
                                                 l_glar.glar005,l_glar.glar034,l_glar.glar036
            #科目餘額型態是貸方，（借 - 貸）* (-1)
            SELECT glaa004 INTO l_glaa004 FROM glaa_t WHERE glaaent = g_enterprise AND glaald = g_xcea_m.xceald
            SELECT glac008 INTO l_glac008 FROM glac_t WHERE glacent = g_enterprise AND glac001 = l_glaa004 AND glac002 = l_glar.glar001
            IF l_glac008 = '2' THEN
               LET l_glar.glar005  = l_glar.glar005 * (-1)
            END IF
            #160617-00002#4 mod-S
#            IF NOT axct701_01_ins_15_xcec(l_glar.*,l_xcan003) THEN
            IF NOT axct701_01_ins_16_xcec(l_glar.*,l_xcan003) THEN
            #160617-00002#4 mod-S
               LET r_success = FALSE
               RETURN r_success
            END IF
         END FOREACH                                       
      END IF
      
      IF l_xcan004 = '3' THEN
         FOREACH glar_curs3 USING l_xcan002 INTO l_glar.glar001,l_glar.glar013,l_glar.glar014,l_glar.glar015,l_glar.glar016,l_glar.glar017,
                                                 l_glar.glar018,l_glar.glar019,l_glar.glar020,l_glar.glar022,l_glar.glar023,l_glar.glar051,
                                                 l_glar.glar052,l_glar.glar053,l_glar.glar024,l_glar.glar025,l_glar.glar026,l_glar.glar027,
                                                 l_glar.glar028,l_glar.glar029,l_glar.glar030,l_glar.glar031,l_glar.glar032,l_glar.glar033,
                                                 l_glar.glar005,l_glar.glar034,l_glar.glar036
            #160617-00002#4 mod-S
#            IF NOT axct701_01_ins_15_xcec(l_glar.*,l_xcan003) THEN
            IF NOT axct701_01_ins_16_xcec(l_glar.*,l_xcan003) THEN
            #160617-00002#4 mod-E
               LET r_success = FALSE
               RETURN r_success
            END IF
         END FOREACH                                       
      END IF
      
      IF l_xcan004 = '4' THEN
         FOREACH glar_curs4 USING l_xcan002 INTO l_glar.glar001,l_glar.glar013,l_glar.glar014,l_glar.glar015,l_glar.glar016,l_glar.glar017,
                                                 l_glar.glar018,l_glar.glar019,l_glar.glar020,l_glar.glar022,l_glar.glar023,l_glar.glar051,
                                                 l_glar.glar052,l_glar.glar053,l_glar.glar024,l_glar.glar025,l_glar.glar026,l_glar.glar027,
                                                 l_glar.glar028,l_glar.glar029,l_glar.glar030,l_glar.glar031,l_glar.glar032,l_glar.glar033,
                                                 l_glar.glar005,l_glar.glar034,l_glar.glar036
            #160617-00002#4 mod-S
#            IF NOT axct701_01_ins_15_xcec(l_glar.*,l_xcan003) THEN
            IF NOT axct701_01_ins_16_xcec(l_glar.*,l_xcan003) THEN
            #160617-00002#4 mod-E
               LET r_success = FALSE
               RETURN r_success
            END IF
         END FOREACH                                       
      END IF
      
      IF l_xcan004 = '5' THEN
         FOREACH glar_curs5 USING l_xcan002 INTO l_glar.glar001,l_glar.glar013,l_glar.glar014,l_glar.glar015,l_glar.glar016,l_glar.glar017,
                                                 l_glar.glar018,l_glar.glar019,l_glar.glar020,l_glar.glar022,l_glar.glar023,l_glar.glar051,
                                                 l_glar.glar052,l_glar.glar053,l_glar.glar024,l_glar.glar025,l_glar.glar026,l_glar.glar027,
                                                 l_glar.glar028,l_glar.glar029,l_glar.glar030,l_glar.glar031,l_glar.glar032,l_glar.glar033,
                                                 l_glar.glar005,l_glar.glar034,l_glar.glar036
            #160617-00002#4 mod-S
#            IF NOT axct701_01_ins_15_xcec(l_glar.*,l_xcan003) THEN
            IF NOT axct701_01_ins_16_xcec(l_glar.*,l_xcan003) THEN
            #160617-00002#4 mod-E
               LET r_success = FALSE
               RETURN r_success
            END IF
         END FOREACH                                       
      END IF
      
      IF l_xcan004 = '6' THEN
         FOREACH glar_curs6 USING l_xcan002 INTO l_glar.glar001,l_glar.glar013,l_glar.glar014,l_glar.glar015,l_glar.glar016,l_glar.glar017,
                                                 l_glar.glar018,l_glar.glar019,l_glar.glar020,l_glar.glar022,l_glar.glar023,l_glar.glar051,
                                                 l_glar.glar052,l_glar.glar053,l_glar.glar024,l_glar.glar025,l_glar.glar026,l_glar.glar027,
                                                 l_glar.glar028,l_glar.glar029,l_glar.glar030,l_glar.glar031,l_glar.glar032,l_glar.glar033,
                                                 l_glar.glar005,l_glar.glar034,l_glar.glar036
            #160617-00002#4 mod-S
#            IF NOT axct701_01_ins_15_xcec(l_glar.*,l_xcan003) THEN
            IF NOT axct701_01_ins_16_xcec(l_glar.*,l_xcan003) THEN
            #160617-00002#4 mod-E
               LET r_success = FALSE
               RETURN r_success
            END IF
         END FOREACH                                       
      END IF
      
      IF l_xcan004 = '7' THEN
         FOREACH glar_curs7 USING l_xcan002 INTO l_glar.glar001,l_glar.glar013,l_glar.glar014,l_glar.glar015,l_glar.glar016,l_glar.glar017,
                                                 l_glar.glar018,l_glar.glar019,l_glar.glar020,l_glar.glar022,l_glar.glar023,l_glar.glar051,
                                                 l_glar.glar052,l_glar.glar053,l_glar.glar024,l_glar.glar025,l_glar.glar026,l_glar.glar027,
                                                 l_glar.glar028,l_glar.glar029,l_glar.glar030,l_glar.glar031,l_glar.glar032,l_glar.glar033,
                                                 l_glar.glar005,l_glar.glar034,l_glar.glar036
            #160617-00002#4 mod-S
#            IF NOT axct701_01_ins_15_xcec(l_glar.*,l_xcan003) THEN
            IF NOT axct701_01_ins_16_xcec(l_glar.*,l_xcan003) THEN
            #160617-00002#4 mod-E
               LET r_success = FALSE
               RETURN r_success
            END IF
         END FOREACH                                       
      END IF
      
      IF l_xcan004 = '8' THEN
         FOREACH glar_curs8 USING l_xcan002 INTO l_glar.glar001,l_glar.glar013,l_glar.glar014,l_glar.glar015,l_glar.glar016,l_glar.glar017,
                                                 l_glar.glar018,l_glar.glar019,l_glar.glar020,l_glar.glar022,l_glar.glar023,l_glar.glar051,
                                                 l_glar.glar052,l_glar.glar053,l_glar.glar024,l_glar.glar025,l_glar.glar026,l_glar.glar027,
                                                 l_glar.glar028,l_glar.glar029,l_glar.glar030,l_glar.glar031,l_glar.glar032,l_glar.glar033,
                                                 l_glar.glar005,l_glar.glar034,l_glar.glar036
            #160617-00002#4 mod-S
#            IF NOT axct701_01_ins_15_xcec(l_glar.*,l_xcan003) THEN
            IF NOT axct701_01_ins_16_xcec(l_glar.*,l_xcan003) THEN
            #160617-00002#4 mod-E
               LET r_success = FALSE
               RETURN r_success
            END IF
         END FOREACH                                       
      END IF
     
   END FOREACH 
   
   #根據來源明細單身中的差異類型(分攤公式類型)到axci010中抓取對應的分攤科目
   #根据INPUT的帐套和QBE条件中的差异成本分类对应的分摊公式从axci010（档案xcao_t）得到分摊率(xcao_t)和分摊对象（xcaq_t），用第二个单身的金额（按帐套+差异成本分类汇总的金额）*分摊率把金额分摊到分摊对象的科目中。并产生第一个单身的数据。
   #案例说明：
   #例如有价差金额1000元和量差金额5000元，需要按存货科目的期末金额和销售收入科目的本期发生额进行分摊。
   #1.设定分摊来源金额：
   #  1.1在axci011中设定价差金额（1000元）的来源科目范围和取值方式
   #  1.2在axci011中设定量差金额（5000元）的来源科目范围和取值方式
   #2.设定分摊规则和分摊对象：
   #  2.1在axci010中设定按科目的分摊规则，按单身每个项次设定分子，所有单身的合计作为分母。
   #  2.2每个单身项次的分摊率=分子/分母，
   #  2.3每个单身项次的分摊金额=分摊来源金额*分摊率
   #  2.4每个单身项次的分摊金额再根据xcaq_t中设定的分摊率把金额再分摊到各科目上
   #3.把第1中的分摊来源金额按科目+核算项存入第二个单身；把第2.4中分摊的目的金额按科目+核算项存入第一个单身。  
   
   DECLARE xcec003_pre CURSOR FOR
       SELECT xcec003,xcec202,xcec212,xcec222 FROM xcec_t 
          WHERE xcecent = g_enterprise AND xcecld = g_xcea_m.xceald AND xcecdocno = g_xcea_m.xceadocno
            AND xcec202 <> 0 
   
   LET g_sql = " SELECT COUNT(xcapseq) FROM xcao_t,xcap_t ",
               " WHERE xcaoent = xcapent AND xcaold = xcapld AND xcao001 = xcap001 ",
               "   AND xcaoent = '",g_enterprise,"' AND xcaold = '",g_xcea_m.xceald,"'",
               "   AND xcao001 = ? ",
               "   AND xcaostus = 'Y' "
               
   PREPARE xcao_cnt_prep FROM g_sql
   
   LET g_sql = " SELECT xcap001,xcapseq FROM xcao_t,xcap_t ",
               " WHERE xcaoent = xcapent AND xcaold = xcapld AND xcao001 = xcap001 ",
               "   AND xcaoent = '",g_enterprise,"' AND xcaold = '",g_xcea_m.xceald,"'",
               "   AND xcao001 = ? ",
               "   AND xcaostus = 'Y' "
   PREPARE xcao_prep FROM g_sql
   DECLARE xcao_curs CURSOR FOR xcao_prep
   
   LET g_sql = " SELECT xcaq002,xcaq003,xcaq004,xcaq006,xcaq008,xcaq009,xcaq010,xcaq011,xcaq012,xcaq013, ",
               "        xcaq014,xcaq015,xcaq016,xcaq017,xcaq018,xcaq019,xcaq020,xcaq021,xcaq022,xcaq023,",
               "        xcaq024,xcaq025,xcaq026,xcaq027,xcaq028,xcaq029,xcaq030 FROM xcaq_t  ",
               " WHERE xcaqent = '",g_enterprise,"' AND xcaqld = '",g_xcea_m.xceald,"'",
               "   AND xcaqseq = ? AND xcaq002 = ? "  
   PREPARE xcaq_prep FROM g_sql
   DECLARE xcaq_curs CURSOR FOR xcaq_prep
   
   FOREACH xcec003_pre INTO l_xcec003,l_xcec202,l_xcec212,l_xcec212
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "foreach xcan"
         LET g_errparam.popup = TRUE
         CALL cl_err()
         LET r_success = FALSE
         RETURN r_success
      END IF  
      
      IF cl_null(l_xcec202) OR l_xcec202 = 0 THEN
         CONTINUE FOREACH
      END IF
         
      LET l_count = 0
      EXECUTE xcao_cnt_prep USING l_xcec003 INTO l_count
      
      IF l_count <= 0 THEN
         CONTINUE FOREACH
      END IF
      
      FOREACH xcao_curs USING l_xcec003 INTO l_xcap001,l_xcapseq
         
         LET l_rate = 1 / l_count #分攤率
         LET l_amount1 = l_rate * l_xcec202  #分攤金額
         
         #本位幣二
         IF g_glaa015 = 'Y' THEN
            IF cl_null(l_xcec212) THEN
               LET l_xcec212 = 0
            END IF
            LET l_amount2 = l_rate * l_xcec212  #分攤金額
         END IF
         
         #本位幣三
         IF g_glaa019 = 'Y' THEN  
            IF cl_null(l_xcec222) THEN
               LET l_xcec222 = 0
            END IF
            LET l_amount3 = l_rate * l_xcec222  #分攤金額
         END IF
         
         FOREACH xcaq_curs USING l_xcapseq,l_xcap001 
              INTO l_xcaq.xcaq002,l_xcaq.xcaq003,l_xcaq.xcaq004,l_xcaq.xcaq006,l_xcaq.xcaq008,l_xcaq.xcaq009,
                   l_xcaq.xcaq010,l_xcaq.xcaq011,l_xcaq.xcaq012,l_xcaq.xcaq013,l_xcaq.xcaq014,l_xcaq.xcaq015,
                   l_xcaq.xcaq016,l_xcaq.xcaq017,l_xcaq.xcaq018,l_xcaq.xcaq019,l_xcaq.xcaq020,l_xcaq.xcaq021,
                   l_xcaq.xcaq022,l_xcaq.xcaq023,l_xcaq.xcaq024,l_xcaq.xcaq025,l_xcaq.xcaq026,l_xcaq.xcaq027,
                   l_xcaq.xcaq028,l_xcaq.xcaq029,l_xcaq.xcaq030
            
            INITIALIZE l_xceb.* TO NULL
      
            LET l_xceb.xcebent = g_enterprise 
            LET l_xceb.xcebcomp = g_xcea_m.xceacomp
            LET l_xceb.xcebld = g_xcea_m.xceald
            LET l_xceb.xcebdocno = g_xcea_m.xceadocno
            
            LET l_xceb.xceb003 = l_xcec003
            LET l_xceb.xceb101 = l_xcaq.xcaq003   #会计科目
            LET l_xceb.xceb102 = l_xcaq.xcaq004   #摘要
            LET l_xceb.xceb103 = ''  #成本域
            
            LET l_xceb.xceb107 = l_xcaq.xcaq008  #人员
            LET l_xceb.xceb108 = l_xcaq.xcaq009  #部门
            LET l_xceb.xceb109 = l_xcaq.xcaq011  #账款对象
            
            LET l_xceb.xceb111 = l_xcaq.xcaq010 #交易对象
            LET l_xceb.xceb112 = l_xcaq.xcaq012 #客群
            LET l_xceb.xceb113 = l_xcaq.xcaq013 #區域
             
            LET l_xceb.xceb114 = l_xcaq.xcaq014 #成本中心
            LET l_xceb.xceb115 = l_xcaq.xcaq015  #經營類別
            LET l_xceb.xceb116 = l_xcaq.xcaq016  #渠道
            LET l_xceb.xceb117 = l_xcaq.xcaq017  #品类
            LET l_xceb.xceb118 = l_xcaq.xcaq018  #品牌
            
            LET l_xceb.xceb119 = l_xcaq.xcaq019  #项目号
            LET l_xceb.xceb120 = l_xcaq.xcaq020  #WBS
            
            LET l_xceb.xceb202 = l_amount1 * l_xcaq.xcaq006 / 100  #金额

            IF cl_null(l_xceb.xceb202) THEN
               LET l_xceb.xceb202 = 0
            END IF
            
            #本位幣二
            IF g_glaa015 = 'Y' THEN
               LET l_xceb.xceb212 = l_amount2 * l_xcaq.xcaq006 / 100  #金额
            END IF
            IF cl_null(l_xceb.xceb212) THEN
               LET l_xceb.xceb212 = 0
            END IF
            
            #本位幣三
            IF g_glaa019 = 'Y' THEN  
               LET l_xceb.xceb222 = l_amount3 * l_xcaq.xcaq006 / 100  #金额
            END IF
            IF cl_null(l_xceb.xceb222) THEN
               LET l_xceb.xceb222 = 0
            END IF
            
            #自由核算项1～10  
            LET l_xceb.xceb121 = l_xcaq.xcaq021
            LET l_xceb.xceb122 = l_xcaq.xcaq022
            LET l_xceb.xceb123 = l_xcaq.xcaq023
            LET l_xceb.xceb124 = l_xcaq.xcaq024
            LET l_xceb.xceb125 = l_xcaq.xcaq025
            LET l_xceb.xceb126 = l_xcaq.xcaq026
            LET l_xceb.xceb127 = l_xcaq.xcaq027
            LET l_xceb.xceb128 = l_xcaq.xcaq028
            LET l_xceb.xceb129 = l_xcaq.xcaq029
            LET l_xceb.xceb130 = l_xcaq.xcaq030
            
            
            #摘要
            IF cl_null(l_xceb.xceb102) THEN
               CALL axct701_01_get_summ(g_xcea_m.xceald,'61','8925','1') RETURNING l_success,l_xceb.xceb102
            END IF
            CALL axct701_01_default_space_xceb(l_xceb.*) RETURNING l_xceb.xceb005,
                                                                   l_xceb.xceb101,
                                                                   l_xceb.xceb102,
                                                                   l_xceb.xceb103,
                                                                   l_xceb.xceb110,
                                                                   l_xceb.xceb111,
                                                                   l_xceb.xceb112,
                                                                   l_xceb.xceb113,
                                                                   l_xceb.xceb114,
                                                                   l_xceb.xceb115,
                                                                   l_xceb.xceb116,
                                                                   l_xceb.xceb117,
                                                                   l_xceb.xceb118,
                                                                   l_xceb.xceb119,
                                                                   l_xceb.xceb120,
                                                                   l_xceb.xceb107,
                                                                   l_xceb.xceb108,
                                                                   l_xceb.xceb109,
                                                                   l_xceb.xceb121,
                                                                   l_xceb.xceb122,
                                                                   l_xceb.xceb123,
                                                                   l_xceb.xceb124,
                                                                   l_xceb.xceb125,
                                                                   l_xceb.xceb126,
                                                                   l_xceb.xceb127,
                                                                   l_xceb.xceb128,
                                                                   l_xceb.xceb129,
                                                                   l_xceb.xceb130  
            #如果金额和数量都为0的话，则不产生此笔单身数据                                                             
            IF l_xceb.xceb202 = 0 THEN
               CONTINUE FOREACH
            END IF  
            LET l_xceb.xceb201  = 0 
            LET l_xceb.xceb202a = 0 
            LET l_xceb.xceb202b = 0 
            LET l_xceb.xceb202c = 0 
            LET l_xceb.xceb202d = 0 
            LET l_xceb.xceb202e = 0 
            LET l_xceb.xceb202f = 0 
            LET l_xceb.xceb202g = 0 
            LET l_xceb.xceb202h = 0 
            
            LET l_xceb.xceb212a = 0
            LET l_xceb.xceb212b = 0
            LET l_xceb.xceb212c = 0
            LET l_xceb.xceb212d = 0
            LET l_xceb.xceb212e = 0
            LET l_xceb.xceb212f = 0
            LET l_xceb.xceb212g = 0
            LET l_xceb.xceb212h = 0
            
            LET l_xceb.xceb222a = 0
            LET l_xceb.xceb222b = 0
            LET l_xceb.xceb222c = 0
            LET l_xceb.xceb222d = 0
            LET l_xceb.xceb222e = 0
            LET l_xceb.xceb222f = 0
            LET l_xceb.xceb222g = 0
            LET l_xceb.xceb222h = 0
            
            #項次
            SELECT MAX(xcebseq)+1 INTO l_xceb.xcebseq FROM xceb_t
             WHERE xcebent = g_enterprise 
               AND xcebld = g_xcea_m.xceald
               AND xcebdocno = g_xcea_m.xceadocno
            IF cl_null(l_xceb.xcebseq) OR l_xceb.xcebseq = 0 THEN
               LET l_xceb.xcebseq = 1
            END IF   
            
            #161109-00085#20-s mod
      #      INSERT INTO xceb_t VALUES(l_xceb.*)   #161109-00085#20-s mark
            #161109-00085#63 --s mark
            #INSERT INTO xceb_t(xcebent,xcebcomp,xcebld,xcebdocno,xcebseq,xceb001,xceb002,xceb003,xceb004,
            #                   xceb005,xceb101,xceb102,xceb103,xceb110,xceb111,xceb112,xceb113,xceb114,xceb115,
            #                   xceb116,xceb117,xceb118,xceb119,xceb120,xceb201,xceb202,xceb202a,xceb202b,xceb202c,
            #                   xceb202d,xceb202e,xceb202f,xceb202g,xceb202h,xceb212,xceb212a,xceb212b,xceb212c,
            #                   xceb212d,xceb212e,xceb212f,xceb212g,xceb212h,xceb222,xceb222a,xceb222b,xceb222c,
            #                   xceb222d,xceb222e,xceb222f,xceb222g,xceb222h,xceb301,xceb302,xceb107,xceb108,xceb109,
            #                   xceb121,xceb122,xceb123,xceb124,xceb125,xceb126,xceb127,xceb128,xceb129,xceb130,xceb131,xceb132) 
            #            VALUES(l_xceb.xcebent,l_xceb.xcebcomp,l_xceb.xcebld,l_xceb.xcebdocno,l_xceb.xcebseq,
            #                   l_xceb.xceb001,l_xceb.xceb002,l_xceb.xceb003,l_xceb.xceb004,l_xceb.xceb005,
            #                   l_xceb.xceb101,l_xceb.xceb102,l_xceb.xceb103,l_xceb.xceb110,l_xceb.xceb111,
            #                   l_xceb.xceb112,l_xceb.xceb113,l_xceb.xceb114,l_xceb.xceb115,l_xceb.xceb116,
            #                   l_xceb.xceb117,l_xceb.xceb118,l_xceb.xceb119,l_xceb.xceb120,l_xceb.xceb201,
            #                   l_xceb.xceb202,l_xceb.xceb202a,l_xceb.xceb202b,l_xceb.xceb202c,l_xceb.xceb202d,
            #                   l_xceb.xceb202e,l_xceb.xceb202f,l_xceb.xceb202g,l_xceb.xceb202h,l_xceb.xceb212,
            #                   l_xceb.xceb212a,l_xceb.xceb212b,l_xceb.xceb212c,l_xceb.xceb212d,l_xceb.xceb212e,
            #                   l_xceb.xceb212f,l_xceb.xceb212g,l_xceb.xceb212h,l_xceb.xceb222,l_xceb.xceb222a,
            #                   l_xceb.xceb222b,l_xceb.xceb222c,l_xceb.xceb222d,l_xceb.xceb222e,l_xceb.xceb222f,
            #                   l_xceb.xceb222g,l_xceb.xceb222h,l_xceb.xceb301,l_xceb.xceb302,l_xceb.xceb107,
            #                   l_xceb.xceb108,l_xceb.xceb109,l_xceb.xceb121,l_xceb.xceb122,l_xceb.xceb123,
            #                   l_xceb.xceb124,l_xceb.xceb125,l_xceb.xceb126,l_xceb.xceb127,l_xceb.xceb128,
            #                   l_xceb.xceb129,l_xceb.xceb130,l_xceb.xceb131,l_xceb.xceb132)
            #161109-00085#20-e mod
            #161109-00085#63 --e mark
            #161109-00085#63 --s add
            INSERT INTO xceb_t(xcebent,xcebcomp,xcebld,xcebdocno,xcebseq,
                               xceb001,xceb002,xceb003,xceb004,xceb005,
                               xceb101,xceb102,xceb103,xceb110,xceb111,
                               xceb112,xceb113,xceb114,xceb115,xceb116,
                               xceb117,xceb118,xceb119,xceb120,xceb201,
                               xceb202,xceb202a,xceb202b,xceb202c,xceb202d,
                               xceb202e,xceb202f,xceb202g,xceb202h,xceb212,
                               xceb212a,xceb212b,xceb212c,xceb212d,xceb212e,
                               xceb212f,xceb212g,xceb212h,xceb222,xceb222a,
                               xceb222b,xceb222c,xceb222d,xceb222e,xceb222f,
                               xceb222g,xceb222h,xceb301,xceb302,xcebud001,
                               xcebud002,xcebud003,xcebud004,xcebud005,xcebud006,
                               xcebud007,xcebud008,xcebud009,xcebud010,xcebud011,
                               xcebud012,xcebud013,xcebud014,xcebud015,xcebud016,
                               xcebud017,xcebud018,xcebud019,xcebud020,xcebud021,
                               xcebud022,xcebud023,xcebud024,xcebud025,xcebud026,
                               xcebud027,xcebud028,xcebud029,xcebud030,xceb107,
                               xceb108,xceb109,xceb121,xceb122,xceb123,
                               xceb124,xceb125,xceb126,xceb127,xceb128,
                               xceb129,xceb130,xceb131,xceb132)
            VALUES(l_xceb.xcebent,l_xceb.xcebcomp,l_xceb.xcebld,l_xceb.xcebdocno,l_xceb.xcebseq,
                   l_xceb.xceb001,l_xceb.xceb002,l_xceb.xceb003,l_xceb.xceb004,l_xceb.xceb005,
                   l_xceb.xceb101,l_xceb.xceb102,l_xceb.xceb103,l_xceb.xceb110,l_xceb.xceb111,
                   l_xceb.xceb112,l_xceb.xceb113,l_xceb.xceb114,l_xceb.xceb115,l_xceb.xceb116,
                   l_xceb.xceb117,l_xceb.xceb118,l_xceb.xceb119,l_xceb.xceb120,l_xceb.xceb201,
                   l_xceb.xceb202,l_xceb.xceb202a,l_xceb.xceb202b,l_xceb.xceb202c,l_xceb.xceb202d,
                   l_xceb.xceb202e,l_xceb.xceb202f,l_xceb.xceb202g,l_xceb.xceb202h,l_xceb.xceb212,
                   l_xceb.xceb212a,l_xceb.xceb212b,l_xceb.xceb212c,l_xceb.xceb212d,l_xceb.xceb212e,
                   l_xceb.xceb212f,l_xceb.xceb212g,l_xceb.xceb212h,l_xceb.xceb222,l_xceb.xceb222a,
                   l_xceb.xceb222b,l_xceb.xceb222c,l_xceb.xceb222d,l_xceb.xceb222e,l_xceb.xceb222f,
                   l_xceb.xceb222g,l_xceb.xceb222h,l_xceb.xceb301,l_xceb.xceb302,l_xceb.xcebud001,
                   l_xceb.xcebud002,l_xceb.xcebud003,l_xceb.xcebud004,l_xceb.xcebud005,l_xceb.xcebud006,
                   l_xceb.xcebud007,l_xceb.xcebud008,l_xceb.xcebud009,l_xceb.xcebud010,l_xceb.xcebud011,
                   l_xceb.xcebud012,l_xceb.xcebud013,l_xceb.xcebud014,l_xceb.xcebud015,l_xceb.xcebud016,
                   l_xceb.xcebud017,l_xceb.xcebud018,l_xceb.xcebud019,l_xceb.xcebud020,l_xceb.xcebud021,
                   l_xceb.xcebud022,l_xceb.xcebud023,l_xceb.xcebud024,l_xceb.xcebud025,l_xceb.xcebud026,
                   l_xceb.xcebud027,l_xceb.xcebud028,l_xceb.xcebud029,l_xceb.xcebud030,l_xceb.xceb107,
                   l_xceb.xceb108,l_xceb.xceb109,l_xceb.xceb121,l_xceb.xceb122,l_xceb.xceb123,
                   l_xceb.xceb124,l_xceb.xceb125,l_xceb.xceb126,l_xceb.xceb127,l_xceb.xceb128,
                   l_xceb.xceb129,l_xceb.xceb130,l_xceb.xceb131,l_xceb.xceb132)
            #161109-00085#63 --e add
            
            IF SQLCA.sqlcode THEN
               INITIALIZE g_errparam TO NULL
               LET g_errparam.code = SQLCA.sqlcode
               LET g_errparam.extend = "ins xceb"
               LET g_errparam.popup = TRUE
               CALL cl_err()
               LET r_success = FALSE
               RETURN r_success
               EXIT FOREACH
            END IF                 
                   
         END FOREACH
         
      END FOREACH
      
   END FOREACH

   RETURN r_success
   
END FUNCTION

#160106-00014#1 add
################################################################################
# Descriptions...: 寫入分攤來源明細單身xcec   15.價差量差分攤憑證  axct716
# Memo...........:
# Usage..........: CALL axct701_01_ins_16_xcec(p_glar,p_xcan003)
# Usage..........: 原先为：CALL axct701_01_ins_15_xcec(p_glar,p_xcan003)
#                  RETURNING r_success
# Input parameter: p_glar     相关栏位资料
#                : p_xcan003  差異類型
# Return code....: r_success  TRUE/FALSE
# Date & Author..: 2016/2/27 By lixiang
# Modify.........: 2016/06/24 By zhujing
##################################################################################################################################################
PRIVATE FUNCTION axct701_01_ins_16_xcec(p_glar,p_xcan003)
#161109-00085#19-s mod
#DEFINE p_glar          RECORD LIKE glar_t.*   #161109-00085#19-s mark
DEFINE p_glar          RECORD  #會計科目各期餘額檔
       glarent LIKE glar_t.glarent, #企業編號
       glarcomp LIKE glar_t.glarcomp, #法人
       glarld LIKE glar_t.glarld, #帳套
       glar001 LIKE glar_t.glar001, #會計科目
       glar002 LIKE glar_t.glar002, #年度
       glar003 LIKE glar_t.glar003, #期別
       glar004 LIKE glar_t.glar004, #組合要素(key)
       glar005 LIKE glar_t.glar005, #借方金額
       glar006 LIKE glar_t.glar006, #貸方金額
       glar007 LIKE glar_t.glar007, #借方筆數
       glar008 LIKE glar_t.glar008, #貸方筆數
       glar009 LIKE glar_t.glar009, #交易幣別
       glar010 LIKE glar_t.glar010, #原幣借方金額
       glar011 LIKE glar_t.glar011, #原幣貸方金額
       glar012 LIKE glar_t.glar012, #營運據點
       glar013 LIKE glar_t.glar013, #部門
       glar014 LIKE glar_t.glar014, #利潤/成本中心
       glar015 LIKE glar_t.glar015, #區域
       glar016 LIKE glar_t.glar016, #收付款客商
       glar017 LIKE glar_t.glar017, #帳款客商
       glar018 LIKE glar_t.glar018, #客群
       glar019 LIKE glar_t.glar019, #產品類別
       glar020 LIKE glar_t.glar020, #人員
       glar021 LIKE glar_t.glar021, #no use
       glar022 LIKE glar_t.glar022, #專案編號
       glar023 LIKE glar_t.glar023, #WBS
       glar024 LIKE glar_t.glar024, #自由核算項一
       glar025 LIKE glar_t.glar025, #自由核算項二
       glar026 LIKE glar_t.glar026, #自由核算項三
       glar027 LIKE glar_t.glar027, #自由核算項四
       glar028 LIKE glar_t.glar028, #自由核算項五
       glar029 LIKE glar_t.glar029, #自由核算項六
       glar030 LIKE glar_t.glar030, #自由核算項七
       glar031 LIKE glar_t.glar031, #自由核算項八
       glar032 LIKE glar_t.glar032, #自由核算項九
       glar033 LIKE glar_t.glar033, #自由核算項十
       glar034 LIKE glar_t.glar034, #借方金額(本位幣二)
       glar035 LIKE glar_t.glar035, #貸方金額(本位幣二)
       glar036 LIKE glar_t.glar036, #借方金額(本位幣三)
       glar037 LIKE glar_t.glar037, #貸方金額(本位幣三)
       glar051 LIKE glar_t.glar051, #經營方式
       glar052 LIKE glar_t.glar052, #通路
       glar053 LIKE glar_t.glar053  #品牌
          END RECORD
#161109-00085#19-e mod
DEFINE p_xcan003    LIKE xcan_t.xcan003
DEFINE r_success    LIKE type_t.num5
#161109-00085#19-s mod
#DEFINE l_xcec       RECORD LIKE xcec_t.*   #161109-00085#19-s mark
DEFINE l_xcec       RECORD  #成本憑證第二單身檔
       xcecent LIKE xcec_t.xcecent, #企業編號
       xceccomp LIKE xcec_t.xceccomp, #法人組織
       xcecld LIKE xcec_t.xcecld, #帳套
       xcecdocno LIKE xcec_t.xcecdocno, #單據編號
       xcecseq LIKE xcec_t.xcecseq, #項次
       xcec001 LIKE xcec_t.xcec001, #參考單據
       xcec002 LIKE xcec_t.xcec002, #參考單據項次
       xcec003 LIKE xcec_t.xcec003, #單據類型
       xcec004 LIKE xcec_t.xcec004, #料件編號
       xcec005 LIKE xcec_t.xcec005, #特性
       xcec101 LIKE xcec_t.xcec101, #科目編號
       xcec102 LIKE xcec_t.xcec102, #摘要
       xcec103 LIKE xcec_t.xcec103, #成本域
       xcec110 LIKE xcec_t.xcec110, #原因碼
       xcec111 LIKE xcec_t.xcec111, #收付款客商
       xcec112 LIKE xcec_t.xcec112, #客群
       xcec113 LIKE xcec_t.xcec113, #區域
       xcec114 LIKE xcec_t.xcec114, #成本中心
       xcec115 LIKE xcec_t.xcec115, #經營類別
       xcec116 LIKE xcec_t.xcec116, #通路
       xcec117 LIKE xcec_t.xcec117, #品類
       xcec118 LIKE xcec_t.xcec118, #品牌
       xcec119 LIKE xcec_t.xcec119, #專案號
       xcec120 LIKE xcec_t.xcec120, #WBS
       xcec201 LIKE xcec_t.xcec201, #數量
       xcec202 LIKE xcec_t.xcec202, #成本金額(本位幣一)
       xcec202a LIKE xcec_t.xcec202a, #成本-材料(本位幣一)
       xcec202b LIKE xcec_t.xcec202b, #成本-人工(本位幣一)
       xcec202c LIKE xcec_t.xcec202c, #成本-加工(本位幣一)
       xcec202d LIKE xcec_t.xcec202d, #成本-制費一(本位幣一)
       xcec202e LIKE xcec_t.xcec202e, #成本-制費二(本位幣一)
       xcec202f LIKE xcec_t.xcec202f, #成本-制費三(本位幣一)
       xcec202g LIKE xcec_t.xcec202g, #成本-制費四(本位幣一)
       xcec202h LIKE xcec_t.xcec202h, #成本-制費五(本位幣一)
       xcec212 LIKE xcec_t.xcec212, #成本-金額(本位幣二)
       xcec212a LIKE xcec_t.xcec212a, #成本-材料(本位幣二)
       xcec212b LIKE xcec_t.xcec212b, #成本-人工(本位幣二)
       xcec212c LIKE xcec_t.xcec212c, #成本-加工(本位幣二)
       xcec212d LIKE xcec_t.xcec212d, #成本-制費一(本位幣二)
       xcec212e LIKE xcec_t.xcec212e, #成本-制費二(本位幣二)
       xcec212f LIKE xcec_t.xcec212f, #成本-制費三(本位幣二)
       xcec212g LIKE xcec_t.xcec212g, #成本-制費四(本位幣二)
       xcec212h LIKE xcec_t.xcec212h, #成本-制費五(本位幣二)
       xcec222 LIKE xcec_t.xcec222, #成本-金額(本位幣三)
       xcec222a LIKE xcec_t.xcec222a, #成本-材料(本位幣三)
       xcec222b LIKE xcec_t.xcec222b, #成本-人工(本位幣三)
       xcec222c LIKE xcec_t.xcec222c, #成本-加工(本位幣三)
       xcec222d LIKE xcec_t.xcec222d, #成本-制費一(本位幣三)
       xcec222e LIKE xcec_t.xcec222e, #成本-制費二(本位幣三)
       xcec222f LIKE xcec_t.xcec222f, #成本-制費三(本位幣三)
       xcec222g LIKE xcec_t.xcec222g, #成本-制費四(本位幣三)
       xcec222h LIKE xcec_t.xcec222h, #成本-制費五(本位幣三)
       xcec301 LIKE xcec_t.xcec301, #憑證編號
       xcec302 LIKE xcec_t.xcec302, #憑證項次
       #161109-00085#63 --s add 
       xcecud001 LIKE xcec_t.xcecud001, #自定義欄位(文字)001
       xcecud002 LIKE xcec_t.xcecud002, #自定義欄位(文字)002
       xcecud003 LIKE xcec_t.xcecud003, #自定義欄位(文字)003
       xcecud004 LIKE xcec_t.xcecud004, #自定義欄位(文字)004
       xcecud005 LIKE xcec_t.xcecud005, #自定義欄位(文字)005
       xcecud006 LIKE xcec_t.xcecud006, #自定義欄位(文字)006
       xcecud007 LIKE xcec_t.xcecud007, #自定義欄位(文字)007
       xcecud008 LIKE xcec_t.xcecud008, #自定義欄位(文字)008
       xcecud009 LIKE xcec_t.xcecud009, #自定義欄位(文字)009
       xcecud010 LIKE xcec_t.xcecud010, #自定義欄位(文字)010
       xcecud011 LIKE xcec_t.xcecud011, #自定義欄位(數字)011
       xcecud012 LIKE xcec_t.xcecud012, #自定義欄位(數字)012
       xcecud013 LIKE xcec_t.xcecud013, #自定義欄位(數字)013
       xcecud014 LIKE xcec_t.xcecud014, #自定義欄位(數字)014
       xcecud015 LIKE xcec_t.xcecud015, #自定義欄位(數字)015
       xcecud016 LIKE xcec_t.xcecud016, #自定義欄位(數字)016
       xcecud017 LIKE xcec_t.xcecud017, #自定義欄位(數字)017
       xcecud018 LIKE xcec_t.xcecud018, #自定義欄位(數字)018
       xcecud019 LIKE xcec_t.xcecud019, #自定義欄位(數字)019
       xcecud020 LIKE xcec_t.xcecud020, #自定義欄位(數字)020
       xcecud021 LIKE xcec_t.xcecud021, #自定義欄位(日期時間)021
       xcecud022 LIKE xcec_t.xcecud022, #自定義欄位(日期時間)022
       xcecud023 LIKE xcec_t.xcecud023, #自定義欄位(日期時間)023
       xcecud024 LIKE xcec_t.xcecud024, #自定義欄位(日期時間)024
       xcecud025 LIKE xcec_t.xcecud025, #自定義欄位(日期時間)025
       xcecud026 LIKE xcec_t.xcecud026, #自定義欄位(日期時間)026
       xcecud027 LIKE xcec_t.xcecud027, #自定義欄位(日期時間)027
       xcecud028 LIKE xcec_t.xcecud028, #自定義欄位(日期時間)028
       xcecud029 LIKE xcec_t.xcecud029, #自定義欄位(日期時間)029
       xcecud030 LIKE xcec_t.xcecud030, #自定義欄位(日期時間)030
       #161109-00085#63 --e add
       xcec107 LIKE xcec_t.xcec107, #人員
       xcec108 LIKE xcec_t.xcec108, #部門
       xcec109 LIKE xcec_t.xcec109, #帳款對象
       xcec121 LIKE xcec_t.xcec121, #自由核算項1
       xcec122 LIKE xcec_t.xcec122, #自由核算項2
       xcec123 LIKE xcec_t.xcec123, #自由核算項3
       xcec124 LIKE xcec_t.xcec124, #自由核算項4
       xcec125 LIKE xcec_t.xcec125, #自由核算項5
       xcec126 LIKE xcec_t.xcec126, #自由核算項6
       xcec127 LIKE xcec_t.xcec127, #自由核算項7
       xcec128 LIKE xcec_t.xcec128, #自由核算項8
       xcec129 LIKE xcec_t.xcec129, #自由核算項9
       xcec130 LIKE xcec_t.xcec130  #自由核算項10
               END RECORD
#161109-00085#19-e mod
DEFINE l_success    LIKE type_t.num5 

      LET r_success = TRUE
      
      INITIALIZE l_xcec.* TO NULL
      
      LET l_xcec.xcecent = g_enterprise 
      LET l_xcec.xceccomp = g_xcea_m.xceacomp
      LET l_xcec.xcecld = g_xcea_m.xceald
      LET l_xcec.xcecdocno = g_xcea_m.xceadocno
      
      LET l_xcec.xcec003 = p_xcan003
      LET l_xcec.xcec101 = p_glar.glar001   #会计科目
      LET l_xcec.xcec102 = ''  #摘要
      LET l_xcec.xcec103 = ''  #成本域
      
      LET l_xcec.xcec107 = p_glar.glar020  #人员
      LET l_xcec.xcec108 = p_glar.glar013  #部门
      LET l_xcec.xcec109 = p_glar.glar017  #账款对象
      
      LET l_xcec.xcec111 = p_glar.glar016 #交易对象
      LET l_xcec.xcec112 = p_glar.glar018 #客群
      LET l_xcec.xcec113 = p_glar.glar015 #區域
       
      LET l_xcec.xcec114 = p_glar.glar014 #成本中心
      LET l_xcec.xcec115 = p_glar.glar051  #經營類別
      LET l_xcec.xcec116 = p_glar.glar052  #渠道
      LET l_xcec.xcec117 = p_glar.glar019  #品类
      LET l_xcec.xcec118 = p_glar.glar053  #品牌
      
      LET l_xcec.xcec119 = p_glar.glar022  #项目号
      LET l_xcec.xcec120 = p_glar.glar023  #WBS
      
      LET l_xcec.xcec202 = p_glar.glar005  #金额
      
      #IF l_xcec.xcec202 < 0 THEN
      #   LET l_xcec.xcec202  = l_xcec.xcec202 * (-1)
      #END IF
      IF cl_null(l_xcec.xcec202) THEN
         LET l_xcec.xcec202 = 0
      END IF
      
      #本位幣二
      IF g_glaa015 = 'Y' THEN
         LET l_xcec.xcec212 = p_glar.glar034  #金额
         IF l_xcec.xcec212 < 0 THEN
            LET l_xcec.xcec212  = l_xcec.xcec212 * (-1)
         END IF
      END IF
      IF cl_null(l_xcec.xcec212) THEN
         LET l_xcec.xcec212 = 0
      END IF
      
      #本位幣三
      IF g_glaa019 = 'Y' THEN  
         LET l_xcec.xcec222 = p_glar.glar036  #金额
         IF l_xcec.xcec222 < 0 THEN
            LET l_xcec.xcec222  = l_xcec.xcec222 * (-1)
         END IF
      END IF
      IF cl_null(l_xcec.xcec222) THEN
         LET l_xcec.xcec222 = 0
      END IF
      
      #自由核算项1～10  
      LET l_xcec.xcec121 = p_glar.glar024
      LET l_xcec.xcec122 = p_glar.glar025
      LET l_xcec.xcec123 = p_glar.glar026
      LET l_xcec.xcec124 = p_glar.glar027
      LET l_xcec.xcec125 = p_glar.glar028
      LET l_xcec.xcec126 = p_glar.glar029
      LET l_xcec.xcec127 = p_glar.glar030
      LET l_xcec.xcec128 = p_glar.glar031
      LET l_xcec.xcec129 = p_glar.glar032
      LET l_xcec.xcec130 = p_glar.glar033
      
      
      #摘要
      IF cl_null(l_xcec.xcec102) THEN
         CALL axct701_01_get_summ(g_xcea_m.xceald,'61','8925','1') RETURNING l_success,l_xcec.xcec102
      END IF
      CALL axct701_01_default_space_xcec(l_xcec.*) RETURNING l_xcec.xcec005,   
                                                             l_xcec.xcec101,
                                                             l_xcec.xcec102,
                                                             l_xcec.xcec103,
                                                             l_xcec.xcec110,
                                                             l_xcec.xcec111,
                                                             l_xcec.xcec112,
                                                             l_xcec.xcec113,
                                                             l_xcec.xcec114,
                                                             l_xcec.xcec115,
                                                             l_xcec.xcec116,
                                                             l_xcec.xcec117,
                                                             l_xcec.xcec118,
                                                             l_xcec.xcec119,
                                                             l_xcec.xcec120,
                                                             l_xcec.xcec107,
                                                             l_xcec.xcec108,
                                                             l_xcec.xcec109,
                                                             l_xcec.xcec121,
                                                             l_xcec.xcec122,
                                                             l_xcec.xcec123,
                                                             l_xcec.xcec124,
                                                             l_xcec.xcec125,
                                                             l_xcec.xcec126,
                                                             l_xcec.xcec127,
                                                             l_xcec.xcec128,
                                                             l_xcec.xcec129,
                                                             l_xcec.xcec130                                        
      #如果金额和数量都为0的话，则不产生此笔单身数据                                                             
      IF l_xcec.xcec202 = 0 THEN
         RETURN r_success
      END IF  
      LET l_xcec.xcec201  = 0 
      LET l_xcec.xcec202a = 0 
      LET l_xcec.xcec202b = 0 
      LET l_xcec.xcec202c = 0 
      LET l_xcec.xcec202d = 0 
      LET l_xcec.xcec202e = 0 
      LET l_xcec.xcec202f = 0 
      LET l_xcec.xcec202g = 0 
      LET l_xcec.xcec202h = 0 
      
      LET l_xcec.xcec212a = 0
      LET l_xcec.xcec212b = 0
      LET l_xcec.xcec212c = 0
      LET l_xcec.xcec212d = 0
      LET l_xcec.xcec212e = 0
      LET l_xcec.xcec212f = 0
      LET l_xcec.xcec212g = 0
      LET l_xcec.xcec212h = 0
      
      LET l_xcec.xcec222a = 0
      LET l_xcec.xcec222b = 0
      LET l_xcec.xcec222c = 0
      LET l_xcec.xcec222d = 0
      LET l_xcec.xcec222e = 0
      LET l_xcec.xcec222f = 0
      LET l_xcec.xcec222g = 0
      LET l_xcec.xcec222h = 0
      
      #項次
      SELECT MAX(xcecseq)+1 INTO l_xcec.xcecseq FROM xcec_t
       WHERE xcecent = g_enterprise 
         AND xcecld = g_xcea_m.xceald
         AND xcecdocno = g_xcea_m.xceadocno
      IF cl_null(l_xcec.xcecseq) OR l_xcec.xcecseq = 0 THEN
         LET l_xcec.xcecseq = 1
      END IF   
      
      #161109-00085#20-s mod      
#      INSERT INTO xcec_t VALUES(l_xcec.*)   #161109-00085#20-s mark
      #161109-00085#63 --s mark
      #INSERT INTO xcec_t(xcecent,xceccomp,xcecld,xcecdocno,xcecseq,xcec001,xcec002,xcec003,xcec004,
      #                   xcec005,xcec101,xcec102,xcec103,xcec110,xcec111,xcec112,xcec113,xcec114,
      #                   xcec115,xcec116,xcec117,xcec118,xcec119,xcec120,xcec201,xcec202,xcec202a,
      #                   xcec202b,xcec202c,xcec202d,xcec202e,xcec202f,xcec202g,xcec202h,xcec212,
      #                   xcec212a,xcec212b,xcec212c,xcec212d,xcec212e,xcec212f,xcec212g,xcec212h,
      #                   xcec222,xcec222a,xcec222b,xcec222c,xcec222d,xcec222e,xcec222f,xcec222g,
      #                   xcec222h,xcec301,xcec302,xcec107,xcec108,xcec109,xcec121,xcec122,xcec123,
      #                   xcec124,xcec125,xcec126,xcec127,xcec128,xcec129,xcec130) 
      #            VALUES(l_xcec.xcecent,l_xcec.xceccomp,l_xcec.xcecld,l_xcec.xcecdocno,l_xcec.xcecseq,
      #                   l_xcec.xcec001,l_xcec.xcec002,l_xcec.xcec003,l_xcec.xcec004,l_xcec.xcec005,
      #                   l_xcec.xcec101,l_xcec.xcec102,l_xcec.xcec103,l_xcec.xcec110,l_xcec.xcec111,
      #                   l_xcec.xcec112,l_xcec.xcec113,l_xcec.xcec114,l_xcec.xcec115,l_xcec.xcec116,
      #                   l_xcec.xcec117,l_xcec.xcec118,l_xcec.xcec119,l_xcec.xcec120,l_xcec.xcec201,
      #                   l_xcec.xcec202,l_xcec.xcec202a,l_xcec.xcec202b,l_xcec.xcec202c,l_xcec.xcec202d,
      #                   l_xcec.xcec202e,l_xcec.xcec202f,l_xcec.xcec202g,l_xcec.xcec202h,l_xcec.xcec212,
      #                   l_xcec.xcec212a,l_xcec.xcec212b,l_xcec.xcec212c,l_xcec.xcec212d,l_xcec.xcec212e,
      #                   l_xcec.xcec212f,l_xcec.xcec212g,l_xcec.xcec212h,l_xcec.xcec222,l_xcec.xcec222a,
      #                   l_xcec.xcec222b,l_xcec.xcec222c,l_xcec.xcec222d,l_xcec.xcec222e,l_xcec.xcec222f,
      #                   l_xcec.xcec222g,l_xcec.xcec222h,l_xcec.xcec301,l_xcec.xcec302,l_xcec.xcec107,
      #                   l_xcec.xcec108,l_xcec.xcec109,l_xcec.xcec121,l_xcec.xcec122,l_xcec.xcec123,
      #                   l_xcec.xcec124,l_xcec.xcec125,l_xcec.xcec126,l_xcec.xcec127,l_xcec.xcec128,
      #                   l_xcec.xcec129,l_xcec.xcec130)
      #161109-00085#63 --e mark
      #161109-00085#20-e mod
      #161109-00085#63 --s add
      INSERT INTO xcec_t(xcecent,xceccomp,xcecld,xcecdocno,xcecseq,
                         xcec001,xcec002,xcec003,xcec004,xcec005,
                         xcec101,xcec102,xcec103,xcec110,xcec111,
                         xcec112,xcec113,xcec114,xcec115,xcec116,
                         xcec117,xcec118,xcec119,xcec120,xcec201,
                         xcec202,xcec202a,xcec202b,xcec202c,xcec202d,
                         xcec202e,xcec202f,xcec202g,xcec202h,xcec212,
                         xcec212a,xcec212b,xcec212c,xcec212d,xcec212e,
                         xcec212f,xcec212g,xcec212h,xcec222,xcec222a,
                         xcec222b,xcec222c,xcec222d,xcec222e,xcec222f,
                         xcec222g,xcec222h,xcec301,xcec302,xcecud001,
                         xcecud002,xcecud003,xcecud004,xcecud005,xcecud006,
                         xcecud007,xcecud008,xcecud009,xcecud010,xcecud011,
                         xcecud012,xcecud013,xcecud014,xcecud015,xcecud016,
                         xcecud017,xcecud018,xcecud019,xcecud020,xcecud021,
                         xcecud022,xcecud023,xcecud024,xcecud025,xcecud026,
                         xcecud027,xcecud028,xcecud029,xcecud030,xcec107,
                         xcec108,xcec109,xcec121,xcec122,xcec123,
                         xcec124,xcec125,xcec126,xcec127,xcec128,
                         xcec129,xcec130)
      VALUES(l_xcec.xcecent,l_xcec.xceccomp,l_xcec.xcecld,l_xcec.xcecdocno,l_xcec.xcecseq,
             l_xcec.xcec001,l_xcec.xcec002,l_xcec.xcec003,l_xcec.xcec004,l_xcec.xcec005,
             l_xcec.xcec101,l_xcec.xcec102,l_xcec.xcec103,l_xcec.xcec110,l_xcec.xcec111,
             l_xcec.xcec112,l_xcec.xcec113,l_xcec.xcec114,l_xcec.xcec115,l_xcec.xcec116,
             l_xcec.xcec117,l_xcec.xcec118,l_xcec.xcec119,l_xcec.xcec120,l_xcec.xcec201,
             l_xcec.xcec202,l_xcec.xcec202a,l_xcec.xcec202b,l_xcec.xcec202c,l_xcec.xcec202d,
             l_xcec.xcec202e,l_xcec.xcec202f,l_xcec.xcec202g,l_xcec.xcec202h,l_xcec.xcec212,
             l_xcec.xcec212a,l_xcec.xcec212b,l_xcec.xcec212c,l_xcec.xcec212d,l_xcec.xcec212e,
             l_xcec.xcec212f,l_xcec.xcec212g,l_xcec.xcec212h,l_xcec.xcec222,l_xcec.xcec222a,
             l_xcec.xcec222b,l_xcec.xcec222c,l_xcec.xcec222d,l_xcec.xcec222e,l_xcec.xcec222f,
             l_xcec.xcec222g,l_xcec.xcec222h,l_xcec.xcec301,l_xcec.xcec302,l_xcec.xcecud001,
             l_xcec.xcecud002,l_xcec.xcecud003,l_xcec.xcecud004,l_xcec.xcecud005,l_xcec.xcecud006,
             l_xcec.xcecud007,l_xcec.xcecud008,l_xcec.xcecud009,l_xcec.xcecud010,l_xcec.xcecud011,
             l_xcec.xcecud012,l_xcec.xcecud013,l_xcec.xcecud014,l_xcec.xcecud015,l_xcec.xcecud016,
             l_xcec.xcecud017,l_xcec.xcecud018,l_xcec.xcecud019,l_xcec.xcecud020,l_xcec.xcecud021,
             l_xcec.xcecud022,l_xcec.xcecud023,l_xcec.xcecud024,l_xcec.xcecud025,l_xcec.xcecud026,
             l_xcec.xcecud027,l_xcec.xcecud028,l_xcec.xcecud029,l_xcec.xcecud030,l_xcec.xcec107,
             l_xcec.xcec108,l_xcec.xcec109,l_xcec.xcec121,l_xcec.xcec122,l_xcec.xcec123,
             l_xcec.xcec124,l_xcec.xcec125,l_xcec.xcec126,l_xcec.xcec127,l_xcec.xcec128,
             l_xcec.xcec129,l_xcec.xcec130)
      #161109-00085#63 --e add
      
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "ins xcec"
         LET g_errparam.popup = TRUE
         CALL cl_err()
         LET r_success = FALSE
         RETURN r_success
      END IF     
      RETURN r_success
      
END FUNCTION

################################################################################
# Descriptions...: 新增axct717    17.內部調撥成本憑證   axct717
# Memo...........:
# Usage..........: CALL axct701_01_ins_17()
#                  RETURNING r_success 
# Input parameter: 
# Return code....: r_success TRUE/FALSE
# Date & Author..: #160816-00041#2 160824 By 02040
# Modify.........: 
################################################################################
PRIVATE FUNCTION axct701_01_ins_17()
DEFINE l_success       LIKE type_t.num5
DEFINE l_errno         LIKE gzze_t.gzze001
#161109-00085#19-s mod
#DEFINE l_xcea          RECORD LIKE xcea_t.*   #161109-00085#19-s mark
DEFINE l_xcea          RECORD  #工單發料成本憑證單頭檔
       xceaent LIKE xcea_t.xceaent, #企業編號
       xceacomp LIKE xcea_t.xceacomp, #法人組織
       xceald LIKE xcea_t.xceald, #帳套
       xceadocno LIKE xcea_t.xceadocno, #單據編號
       xcea001 LIKE xcea_t.xcea001, #單據日期
       xcea002 LIKE xcea_t.xcea002, #成本憑證類型
       xcea003 LIKE xcea_t.xcea003, #成本計算類型
       xcea004 LIKE xcea_t.xcea004, #年度
       xcea005 LIKE xcea_t.xcea005, #期別
       xcea006 LIKE xcea_t.xcea006, #帳務人員
       xcea007 LIKE xcea_t.xcea007, #帳務部門
       xcea101 LIKE xcea_t.xcea101, #憑證編號
       xcea102 LIKE xcea_t.xcea102, #憑證日期
       xceaownid LIKE xcea_t.xceaownid, #資料所有者
       xceaowndp LIKE xcea_t.xceaowndp, #資料所屬部門
       xceacrtid LIKE xcea_t.xceacrtid, #資料建立者
       xceacrtdp LIKE xcea_t.xceacrtdp, #資料建立部門
       xceacrtdt LIKE xcea_t.xceacrtdt, #資料創建日
       xceamodid LIKE xcea_t.xceamodid, #資料修改者
       xceamoddt LIKE xcea_t.xceamoddt, #最近修改日
       xceacnfid LIKE xcea_t.xceacnfid, #資料確認者
       xceacnfdt LIKE xcea_t.xceacnfdt, #資料確認日
       xceapstid LIKE xcea_t.xceapstid, #資料過帳者
       xceapstdt LIKE xcea_t.xceapstdt, #資料過帳日
       xceastus LIKE xcea_t.xceastus, #狀態碼
       #161109-00085#63 --s add
       xceaud001 LIKE xcea_t.xceaud001, #自定義欄位(文字)001
       xceaud002 LIKE xcea_t.xceaud002, #自定義欄位(文字)002
       xceaud003 LIKE xcea_t.xceaud003, #自定義欄位(文字)003
       xceaud004 LIKE xcea_t.xceaud004, #自定義欄位(文字)004
       xceaud005 LIKE xcea_t.xceaud005, #自定義欄位(文字)005
       xceaud006 LIKE xcea_t.xceaud006, #自定義欄位(文字)006
       xceaud007 LIKE xcea_t.xceaud007, #自定義欄位(文字)007
       xceaud008 LIKE xcea_t.xceaud008, #自定義欄位(文字)008
       xceaud009 LIKE xcea_t.xceaud009, #自定義欄位(文字)009
       xceaud010 LIKE xcea_t.xceaud010, #自定義欄位(文字)010
       xceaud011 LIKE xcea_t.xceaud011, #自定義欄位(數字)011
       xceaud012 LIKE xcea_t.xceaud012, #自定義欄位(數字)012
       xceaud013 LIKE xcea_t.xceaud013, #自定義欄位(數字)013
       xceaud014 LIKE xcea_t.xceaud014, #自定義欄位(數字)014
       xceaud015 LIKE xcea_t.xceaud015, #自定義欄位(數字)015
       xceaud016 LIKE xcea_t.xceaud016, #自定義欄位(數字)016
       xceaud017 LIKE xcea_t.xceaud017, #自定義欄位(數字)017
       xceaud018 LIKE xcea_t.xceaud018, #自定義欄位(數字)018
       xceaud019 LIKE xcea_t.xceaud019, #自定義欄位(數字)019
       xceaud020 LIKE xcea_t.xceaud020, #自定義欄位(數字)020
       xceaud021 LIKE xcea_t.xceaud021, #自定義欄位(日期時間)021
       xceaud022 LIKE xcea_t.xceaud022, #自定義欄位(日期時間)022
       xceaud023 LIKE xcea_t.xceaud023, #自定義欄位(日期時間)023
       xceaud024 LIKE xcea_t.xceaud024, #自定義欄位(日期時間)024
       xceaud025 LIKE xcea_t.xceaud025, #自定義欄位(日期時間)025
       xceaud026 LIKE xcea_t.xceaud026, #自定義欄位(日期時間)026
       xceaud027 LIKE xcea_t.xceaud027, #自定義欄位(日期時間)027
       xceaud028 LIKE xcea_t.xceaud028, #自定義欄位(日期時間)028
       xceaud029 LIKE xcea_t.xceaud029, #自定義欄位(日期時間)029
       xceaud030 LIKE xcea_t.xceaud030, #自定義欄位(日期時間)030
       #161109-00085#63 --e add
       xceasite LIKE xcea_t.xceasite  #營運據點
          END RECORD
#161109-00085#19-e mod
#161109-00085#19-s mod
#DEFINE l_xceb          RECORD LIKE xceb_t.*   #161109-00085#19-s mark
DEFINE l_xceb          RECORD  #成本憑證第一單身檔
       xcebent LIKE xceb_t.xcebent, #企業編號
       xcebcomp LIKE xceb_t.xcebcomp, #法人組織
       xcebld LIKE xceb_t.xcebld, #帳套
       xcebdocno LIKE xceb_t.xcebdocno, #單據編號
       xcebseq LIKE xceb_t.xcebseq, #項次
       xceb001 LIKE xceb_t.xceb001, #參考單據編號
       xceb002 LIKE xceb_t.xceb002, #參考單據項次
       xceb003 LIKE xceb_t.xceb003, #單據類型
       xceb004 LIKE xceb_t.xceb004, #料件編號
       xceb005 LIKE xceb_t.xceb005, #特性
       xceb101 LIKE xceb_t.xceb101, #科目編號
       xceb102 LIKE xceb_t.xceb102, #摘要
       xceb103 LIKE xceb_t.xceb103, #成本域
       xceb110 LIKE xceb_t.xceb110, #原因碼
       xceb111 LIKE xceb_t.xceb111, #收付款客商
       xceb112 LIKE xceb_t.xceb112, #客群
       xceb113 LIKE xceb_t.xceb113, #區域
       xceb114 LIKE xceb_t.xceb114, #成本中心
       xceb115 LIKE xceb_t.xceb115, #經營類別
       xceb116 LIKE xceb_t.xceb116, #通路
       xceb117 LIKE xceb_t.xceb117, #品類
       xceb118 LIKE xceb_t.xceb118, #品牌
       xceb119 LIKE xceb_t.xceb119, #專案號
       xceb120 LIKE xceb_t.xceb120, #WBS
       xceb201 LIKE xceb_t.xceb201, #數量
       xceb202 LIKE xceb_t.xceb202, #成本金額(本位幣一)
       xceb202a LIKE xceb_t.xceb202a, #成本-材料(本位幣一)
       xceb202b LIKE xceb_t.xceb202b, #成本-人工(本位幣一)
       xceb202c LIKE xceb_t.xceb202c, #成本-加工(本位幣一)
       xceb202d LIKE xceb_t.xceb202d, #成本-制費一(本位幣一)
       xceb202e LIKE xceb_t.xceb202e, #成本-制費二(本位幣一)
       xceb202f LIKE xceb_t.xceb202f, #成本-制費三(本位幣一)
       xceb202g LIKE xceb_t.xceb202g, #成本-制費四(本位幣一)
       xceb202h LIKE xceb_t.xceb202h, #成本-制費五(本位幣一)
       xceb212 LIKE xceb_t.xceb212, #成本金額(本位幣二)
       xceb212a LIKE xceb_t.xceb212a, #成本-材料(本位幣二)
       xceb212b LIKE xceb_t.xceb212b, #成本-人工(本位幣二)
       xceb212c LIKE xceb_t.xceb212c, #成本-加工(本位幣二)
       xceb212d LIKE xceb_t.xceb212d, #成本-制費一(本位幣二)
       xceb212e LIKE xceb_t.xceb212e, #成本-制費二(本位幣二)
       xceb212f LIKE xceb_t.xceb212f, #成本-制費三(本位幣二)
       xceb212g LIKE xceb_t.xceb212g, #成本-制費四(本位幣二)
       xceb212h LIKE xceb_t.xceb212h, #成本-制費五(本位幣二)
       xceb222 LIKE xceb_t.xceb222, #成本金額(本位幣三)
       xceb222a LIKE xceb_t.xceb222a, #成本-材料(本位幣三)
       xceb222b LIKE xceb_t.xceb222b, #成本-人工(本位幣三)
       xceb222c LIKE xceb_t.xceb222c, #成本-加工(本位幣三)
       xceb222d LIKE xceb_t.xceb222d, #成本-制費一(本位幣三)
       xceb222e LIKE xceb_t.xceb222e, #成本-制費二(本位幣三)
       xceb222f LIKE xceb_t.xceb222f, #成本-制費三(本位幣三)
       xceb222g LIKE xceb_t.xceb222g, #成本-制費四(本位幣三)
       xceb222h LIKE xceb_t.xceb222h, #成本-制費五(本位幣三)
       xceb301 LIKE xceb_t.xceb301, #憑證編號
       xceb302 LIKE xceb_t.xceb302, #憑證項次
       #161109-00085#63 --s add  
       xcebud001 LIKE xceb_t.xcebud001, #自定義欄位(文字)001
       xcebud002 LIKE xceb_t.xcebud002, #自定義欄位(文字)002
       xcebud003 LIKE xceb_t.xcebud003, #自定義欄位(文字)003
       xcebud004 LIKE xceb_t.xcebud004, #自定義欄位(文字)004
       xcebud005 LIKE xceb_t.xcebud005, #自定義欄位(文字)005
       xcebud006 LIKE xceb_t.xcebud006, #自定義欄位(文字)006
       xcebud007 LIKE xceb_t.xcebud007, #自定義欄位(文字)007
       xcebud008 LIKE xceb_t.xcebud008, #自定義欄位(文字)008
       xcebud009 LIKE xceb_t.xcebud009, #自定義欄位(文字)009
       xcebud010 LIKE xceb_t.xcebud010, #自定義欄位(文字)010
       xcebud011 LIKE xceb_t.xcebud011, #自定義欄位(數字)011
       xcebud012 LIKE xceb_t.xcebud012, #自定義欄位(數字)012
       xcebud013 LIKE xceb_t.xcebud013, #自定義欄位(數字)013
       xcebud014 LIKE xceb_t.xcebud014, #自定義欄位(數字)014
       xcebud015 LIKE xceb_t.xcebud015, #自定義欄位(數字)015
       xcebud016 LIKE xceb_t.xcebud016, #自定義欄位(數字)016
       xcebud017 LIKE xceb_t.xcebud017, #自定義欄位(數字)017
       xcebud018 LIKE xceb_t.xcebud018, #自定義欄位(數字)018
       xcebud019 LIKE xceb_t.xcebud019, #自定義欄位(數字)019
       xcebud020 LIKE xceb_t.xcebud020, #自定義欄位(數字)020
       xcebud021 LIKE xceb_t.xcebud021, #自定義欄位(日期時間)021
       xcebud022 LIKE xceb_t.xcebud022, #自定義欄位(日期時間)022
       xcebud023 LIKE xceb_t.xcebud023, #自定義欄位(日期時間)023
       xcebud024 LIKE xceb_t.xcebud024, #自定義欄位(日期時間)024
       xcebud025 LIKE xceb_t.xcebud025, #自定義欄位(日期時間)025
       xcebud026 LIKE xceb_t.xcebud026, #自定義欄位(日期時間)026
       xcebud027 LIKE xceb_t.xcebud027, #自定義欄位(日期時間)027
       xcebud028 LIKE xceb_t.xcebud028, #自定義欄位(日期時間)028
       xcebud029 LIKE xceb_t.xcebud029, #自定義欄位(日期時間)029
       xcebud030 LIKE xceb_t.xcebud030, #自定義欄位(日期時間)030
       #161109-00085#63 --e add
       xceb107 LIKE xceb_t.xceb107, #人員
       xceb108 LIKE xceb_t.xceb108, #部門
       xceb109 LIKE xceb_t.xceb109, #帳款對象
       xceb121 LIKE xceb_t.xceb121, #自由核算項1
       xceb122 LIKE xceb_t.xceb122, #自由核算項2
       xceb123 LIKE xceb_t.xceb123, #自由核算項3
       xceb124 LIKE xceb_t.xceb124, #自由核算項4
       xceb125 LIKE xceb_t.xceb125, #自由核算項5
       xceb126 LIKE xceb_t.xceb126, #自由核算項6
       xceb127 LIKE xceb_t.xceb127, #自由核算項7
       xceb128 LIKE xceb_t.xceb128, #自由核算項8
       xceb129 LIKE xceb_t.xceb129, #自由核算項9
       xceb130 LIKE xceb_t.xceb130, #自由核算項10
       xceb131 LIKE xceb_t.xceb131, #單據類型(for 流通)
       xceb132 LIKE xceb_t.xceb132  #單據日期(for 流通)
          END RECORD
#161109-00085#19-e mod
#161109-00085#19-s mod
#DEFINE l_xcec          RECORD LIKE xcec_t.*   #161109-00085#18-s mark
DEFINE l_xcec          RECORD  #成本憑證第二單身檔
       xcecent LIKE xcec_t.xcecent, #企業編號
       xceccomp LIKE xcec_t.xceccomp, #法人組織
       xcecld LIKE xcec_t.xcecld, #帳套
       xcecdocno LIKE xcec_t.xcecdocno, #單據編號
       xcecseq LIKE xcec_t.xcecseq, #項次
       xcec001 LIKE xcec_t.xcec001, #參考單據
       xcec002 LIKE xcec_t.xcec002, #參考單據項次
       xcec003 LIKE xcec_t.xcec003, #單據類型
       xcec004 LIKE xcec_t.xcec004, #料件編號
       xcec005 LIKE xcec_t.xcec005, #特性
       xcec101 LIKE xcec_t.xcec101, #科目編號
       xcec102 LIKE xcec_t.xcec102, #摘要
       xcec103 LIKE xcec_t.xcec103, #成本域
       xcec110 LIKE xcec_t.xcec110, #原因碼
       xcec111 LIKE xcec_t.xcec111, #收付款客商
       xcec112 LIKE xcec_t.xcec112, #客群
       xcec113 LIKE xcec_t.xcec113, #區域
       xcec114 LIKE xcec_t.xcec114, #成本中心
       xcec115 LIKE xcec_t.xcec115, #經營類別
       xcec116 LIKE xcec_t.xcec116, #通路
       xcec117 LIKE xcec_t.xcec117, #品類
       xcec118 LIKE xcec_t.xcec118, #品牌
       xcec119 LIKE xcec_t.xcec119, #專案號
       xcec120 LIKE xcec_t.xcec120, #WBS
       xcec201 LIKE xcec_t.xcec201, #數量
       xcec202 LIKE xcec_t.xcec202, #成本金額(本位幣一)
       xcec202a LIKE xcec_t.xcec202a, #成本-材料(本位幣一)
       xcec202b LIKE xcec_t.xcec202b, #成本-人工(本位幣一)
       xcec202c LIKE xcec_t.xcec202c, #成本-加工(本位幣一)
       xcec202d LIKE xcec_t.xcec202d, #成本-制費一(本位幣一)
       xcec202e LIKE xcec_t.xcec202e, #成本-制費二(本位幣一)
       xcec202f LIKE xcec_t.xcec202f, #成本-制費三(本位幣一)
       xcec202g LIKE xcec_t.xcec202g, #成本-制費四(本位幣一)
       xcec202h LIKE xcec_t.xcec202h, #成本-制費五(本位幣一)
       xcec212 LIKE xcec_t.xcec212, #成本-金額(本位幣二)
       xcec212a LIKE xcec_t.xcec212a, #成本-材料(本位幣二)
       xcec212b LIKE xcec_t.xcec212b, #成本-人工(本位幣二)
       xcec212c LIKE xcec_t.xcec212c, #成本-加工(本位幣二)
       xcec212d LIKE xcec_t.xcec212d, #成本-制費一(本位幣二)
       xcec212e LIKE xcec_t.xcec212e, #成本-制費二(本位幣二)
       xcec212f LIKE xcec_t.xcec212f, #成本-制費三(本位幣二)
       xcec212g LIKE xcec_t.xcec212g, #成本-制費四(本位幣二)
       xcec212h LIKE xcec_t.xcec212h, #成本-制費五(本位幣二)
       xcec222 LIKE xcec_t.xcec222, #成本-金額(本位幣三)
       xcec222a LIKE xcec_t.xcec222a, #成本-材料(本位幣三)
       xcec222b LIKE xcec_t.xcec222b, #成本-人工(本位幣三)
       xcec222c LIKE xcec_t.xcec222c, #成本-加工(本位幣三)
       xcec222d LIKE xcec_t.xcec222d, #成本-制費一(本位幣三)
       xcec222e LIKE xcec_t.xcec222e, #成本-制費二(本位幣三)
       xcec222f LIKE xcec_t.xcec222f, #成本-制費三(本位幣三)
       xcec222g LIKE xcec_t.xcec222g, #成本-制費四(本位幣三)
       xcec222h LIKE xcec_t.xcec222h, #成本-制費五(本位幣三)
       xcec301 LIKE xcec_t.xcec301, #憑證編號
       xcec302 LIKE xcec_t.xcec302, #憑證項次
       #161109-00085#63 --s add 
       xcecud001 LIKE xcec_t.xcecud001, #自定義欄位(文字)001
       xcecud002 LIKE xcec_t.xcecud002, #自定義欄位(文字)002
       xcecud003 LIKE xcec_t.xcecud003, #自定義欄位(文字)003
       xcecud004 LIKE xcec_t.xcecud004, #自定義欄位(文字)004
       xcecud005 LIKE xcec_t.xcecud005, #自定義欄位(文字)005
       xcecud006 LIKE xcec_t.xcecud006, #自定義欄位(文字)006
       xcecud007 LIKE xcec_t.xcecud007, #自定義欄位(文字)007
       xcecud008 LIKE xcec_t.xcecud008, #自定義欄位(文字)008
       xcecud009 LIKE xcec_t.xcecud009, #自定義欄位(文字)009
       xcecud010 LIKE xcec_t.xcecud010, #自定義欄位(文字)010
       xcecud011 LIKE xcec_t.xcecud011, #自定義欄位(數字)011
       xcecud012 LIKE xcec_t.xcecud012, #自定義欄位(數字)012
       xcecud013 LIKE xcec_t.xcecud013, #自定義欄位(數字)013
       xcecud014 LIKE xcec_t.xcecud014, #自定義欄位(數字)014
       xcecud015 LIKE xcec_t.xcecud015, #自定義欄位(數字)015
       xcecud016 LIKE xcec_t.xcecud016, #自定義欄位(數字)016
       xcecud017 LIKE xcec_t.xcecud017, #自定義欄位(數字)017
       xcecud018 LIKE xcec_t.xcecud018, #自定義欄位(數字)018
       xcecud019 LIKE xcec_t.xcecud019, #自定義欄位(數字)019
       xcecud020 LIKE xcec_t.xcecud020, #自定義欄位(數字)020
       xcecud021 LIKE xcec_t.xcecud021, #自定義欄位(日期時間)021
       xcecud022 LIKE xcec_t.xcecud022, #自定義欄位(日期時間)022
       xcecud023 LIKE xcec_t.xcecud023, #自定義欄位(日期時間)023
       xcecud024 LIKE xcec_t.xcecud024, #自定義欄位(日期時間)024
       xcecud025 LIKE xcec_t.xcecud025, #自定義欄位(日期時間)025
       xcecud026 LIKE xcec_t.xcecud026, #自定義欄位(日期時間)026
       xcecud027 LIKE xcec_t.xcecud027, #自定義欄位(日期時間)027
       xcecud028 LIKE xcec_t.xcecud028, #自定義欄位(日期時間)028
       xcecud029 LIKE xcec_t.xcecud029, #自定義欄位(日期時間)029
       xcecud030 LIKE xcec_t.xcecud030, #自定義欄位(日期時間)030
       #161109-00085#63 --e add
       xcec107 LIKE xcec_t.xcec107, #人員
       xcec108 LIKE xcec_t.xcec108, #部門
       xcec109 LIKE xcec_t.xcec109, #帳款對象
       xcec121 LIKE xcec_t.xcec121, #自由核算項1
       xcec122 LIKE xcec_t.xcec122, #自由核算項2
       xcec123 LIKE xcec_t.xcec123, #自由核算項3
       xcec124 LIKE xcec_t.xcec124, #自由核算項4
       xcec125 LIKE xcec_t.xcec125, #自由核算項5
       xcec126 LIKE xcec_t.xcec126, #自由核算項6
       xcec127 LIKE xcec_t.xcec127, #自由核算項7
       xcec128 LIKE xcec_t.xcec128, #自由核算項8
       xcec129 LIKE xcec_t.xcec129, #自由核算項9
       xcec130 LIKE xcec_t.xcec130  #自由核算項10
               END RECORD
#161109-00085#19-e mod
#161109-00085#19-s mod
#DEFINE l_xcck          RECORD LIKE xcck_t.*   #161109-00085#19-s mark
DEFINE l_xcck          RECORD  #本期料件明細進出成本檔
       xcckent LIKE xcck_t.xcckent, #企業編號
       xccksite LIKE xcck_t.xccksite, #site組織
       xcckcomp LIKE xcck_t.xcckcomp, #法人組織
       xcckld LIKE xcck_t.xcckld, #帳套
       xcck001 LIKE xcck_t.xcck001, #帳套本位幣順序
       xcck002 LIKE xcck_t.xcck002, #成本域
       xcck003 LIKE xcck_t.xcck003, #成本計算類型
       xcck004 LIKE xcck_t.xcck004, #年度
       xcck005 LIKE xcck_t.xcck005, #期別
       xcck006 LIKE xcck_t.xcck006, #參考單號
       xcck007 LIKE xcck_t.xcck007, #項次
       xcck008 LIKE xcck_t.xcck008, #項序
       xcck009 LIKE xcck_t.xcck009, #出入庫碼
       xcck010 LIKE xcck_t.xcck010, #料號
       xcck011 LIKE xcck_t.xcck011, #產品特徵
       xcck012 LIKE xcck_t.xcck012, #單據類型
       xcck013 LIKE xcck_t.xcck013, #單據日期
       xcck014 LIKE xcck_t.xcck014, #時間
       xcck015 LIKE xcck_t.xcck015, #倉庫編號
       xcck016 LIKE xcck_t.xcck016, #儲位編號
       xcck017 LIKE xcck_t.xcck017, #批號
       xcck020 LIKE xcck_t.xcck020, #異動類型
       xcck021 LIKE xcck_t.xcck021, #原因碼
       xcck022 LIKE xcck_t.xcck022, #交易對象
       xcck023 LIKE xcck_t.xcck023, #客群
       xcck024 LIKE xcck_t.xcck024, #區域
       xcck025 LIKE xcck_t.xcck025, #成本中心
       xcck026 LIKE xcck_t.xcck026, #經營類別
       xcck027 LIKE xcck_t.xcck027, #通路
       xcck028 LIKE xcck_t.xcck028, #品類
       xcck029 LIKE xcck_t.xcck029, #品牌
       xcck030 LIKE xcck_t.xcck030, #專案號
       xcck031 LIKE xcck_t.xcck031, #WBS
       xcck032 LIKE xcck_t.xcck032, #存貨科目
       xcck033 LIKE xcck_t.xcck033, #費用成本科目
       xcck034 LIKE xcck_t.xcck034, #收入科目
       xcck040 LIKE xcck_t.xcck040, #交易幣別
       xcck041 LIKE xcck_t.xcck041, #本位幣別
       xcck042 LIKE xcck_t.xcck042, #匯率
       xcck043 LIKE xcck_t.xcck043, #交易單位
       xcck044 LIKE xcck_t.xcck044, #成本單位
       xcck045 LIKE xcck_t.xcck045, #換算率
       xcck046 LIKE xcck_t.xcck046, #交易數量
       xcck047 LIKE xcck_t.xcck047, #工單號碼
       xcck048 LIKE xcck_t.xcck048, #重複性生產-計畫編號
       xcck049 LIKE xcck_t.xcck049, #重複性生產-生產料號
       xcck050 LIKE xcck_t.xcck050, #重複性生產-生產料號BOM特性
       xcck051 LIKE xcck_t.xcck051, #重複性生產-生產料號產品特徵
       xcck055 LIKE xcck_t.xcck055, #xccc類型
       xcck201 LIKE xcck_t.xcck201, #本期異動數量
       xcck202 LIKE xcck_t.xcck202, #本期異動金額
       xcck202a LIKE xcck_t.xcck202a, #本期異動金額-材料
       xcck202b LIKE xcck_t.xcck202b, #本期異動金額-人工
       xcck202c LIKE xcck_t.xcck202c, #本期異動金額-加工費
       xcck202d LIKE xcck_t.xcck202d, #本期異動金額-製費一
       xcck202e LIKE xcck_t.xcck202e, #本期異動金額-製費二
       xcck202f LIKE xcck_t.xcck202f, #本期異動金額-製費三
       xcck202g LIKE xcck_t.xcck202g, #本期異動金額-製費四
       xcck202h LIKE xcck_t.xcck202h, #本期異動金額-製費五
       xcck282 LIKE xcck_t.xcck282, #本期異動單價
       xcck282a LIKE xcck_t.xcck282a, #本期異動單價-材料
       xcck282b LIKE xcck_t.xcck282b, #本期異動單價-人工
       xcck282c LIKE xcck_t.xcck282c, #本期異動單價-加工
       xcck282d LIKE xcck_t.xcck282d, #本期異動單價-製費一
       xcck282e LIKE xcck_t.xcck282e, #本期異動單價-製費二
       xcck282f LIKE xcck_t.xcck282f, #本期異動單價-製費三
       xcck282g LIKE xcck_t.xcck282g, #本期異動單價-製費四
       xcck282h LIKE xcck_t.xcck282h, #本期異動單價-製費五
       xcck301 LIKE xcck_t.xcck301, #已耗數量
       xcck302 LIKE xcck_t.xcck302, #已耗金額
       xcck302a LIKE xcck_t.xcck302a, #已耗金額-材料
       xcck302b LIKE xcck_t.xcck302b, #已耗金額-人工
       xcck302c LIKE xcck_t.xcck302c, #已耗金額-加工費
       xcck302d LIKE xcck_t.xcck302d, #已耗金額-製費一
       xcck302e LIKE xcck_t.xcck302e, #已耗金額-製費二
       xcck302f LIKE xcck_t.xcck302f, #已耗金額-製費三
       xcck302g LIKE xcck_t.xcck302g, #已耗金額-製費四
       xcck302h LIKE xcck_t.xcck302h, #已耗金額-製費五
       xcck901 LIKE xcck_t.xcck901, #結存數量
       xcck902 LIKE xcck_t.xcck902, #結存金額
       xcck902a LIKE xcck_t.xcck902a, #結存金額-材料
       xcck902b LIKE xcck_t.xcck902b, #結存金額-人工
       xcck902c LIKE xcck_t.xcck902c, #結存金額-加工費
       xcck902d LIKE xcck_t.xcck902d, #結存金額-製費一
       xcck902e LIKE xcck_t.xcck902e, #結存金額-製費二
       xcck902f LIKE xcck_t.xcck902f, #結存金額-製費三
       xcck902g LIKE xcck_t.xcck902g, #結存金額-製費四
       xcck902h LIKE xcck_t.xcck902h, #結存金額-製費五
       xcck980 LIKE xcck_t.xcck980, #結存單位成本
       xcck980a LIKE xcck_t.xcck980a, #結存單位成本-材料
       xcck980b LIKE xcck_t.xcck980b, #結存單位成本-人工
       xcck980c LIKE xcck_t.xcck980c, #結存單位成本-加工費
       xcck980d LIKE xcck_t.xcck980d, #結存單位成本-製費一
       xcck980e LIKE xcck_t.xcck980e, #結存單位成本-製費二
       xcck980f LIKE xcck_t.xcck980f, #結存單位成本-製費三
       xcck980g LIKE xcck_t.xcck980g, #結存單位成本-製費四
       xcck980h LIKE xcck_t.xcck980h, #結存單位成本-製費五
       xcck903 LIKE xcck_t.xcck903, #結存調整金額
       xcck903a LIKE xcck_t.xcck903a, #結存調整金額-材料
       xcck903b LIKE xcck_t.xcck903b, #結存調整金額-人工
       xcck903c LIKE xcck_t.xcck903c, #結存調整金額-加工費
       xcck903d LIKE xcck_t.xcck903d, #結存調整金額-製費一
       xcck903e LIKE xcck_t.xcck903e, #結存調整金額-製費二
       xcck903f LIKE xcck_t.xcck903f, #結存調整金額-製費三
       xcck903g LIKE xcck_t.xcck903g, #結存調整金額-製費四
       xcck903h LIKE xcck_t.xcck903h, #結存調整金額-製費五
       xcckownid LIKE xcck_t.xcckownid, #資料所有者
       xcckowndp LIKE xcck_t.xcckowndp, #資料所屬部門
       xcckcrtid LIKE xcck_t.xcckcrtid, #資料建立者
       xcckcrtdp LIKE xcck_t.xcckcrtdp, #資料建立部門
       xcckcrtdt LIKE xcck_t.xcckcrtdt, #資料創建日
       xcckmodid LIKE xcck_t.xcckmodid, #資料修改者
       xcckmoddt LIKE xcck_t.xcckmoddt, #最近修改日
       xcckstus LIKE xcck_t.xcckstus, #狀態碼
       #161109-00085#63 --s add      
       xcckud001 LIKE xcck_t.xcckud001, #自定義欄位(文字)001
       xcckud002 LIKE xcck_t.xcckud002, #自定義欄位(文字)002
       xcckud003 LIKE xcck_t.xcckud003, #自定義欄位(文字)003
       xcckud004 LIKE xcck_t.xcckud004, #自定義欄位(文字)004
       xcckud005 LIKE xcck_t.xcckud005, #自定義欄位(文字)005
       xcckud006 LIKE xcck_t.xcckud006, #自定義欄位(文字)006
       xcckud007 LIKE xcck_t.xcckud007, #自定義欄位(文字)007
       xcckud008 LIKE xcck_t.xcckud008, #自定義欄位(文字)008
       xcckud009 LIKE xcck_t.xcckud009, #自定義欄位(文字)009
       xcckud010 LIKE xcck_t.xcckud010, #自定義欄位(文字)010
       xcckud011 LIKE xcck_t.xcckud011, #自定義欄位(數字)011
       xcckud012 LIKE xcck_t.xcckud012, #自定義欄位(數字)012
       xcckud013 LIKE xcck_t.xcckud013, #自定義欄位(數字)013
       xcckud014 LIKE xcck_t.xcckud014, #自定義欄位(數字)014
       xcckud015 LIKE xcck_t.xcckud015, #自定義欄位(數字)015
       xcckud016 LIKE xcck_t.xcckud016, #自定義欄位(數字)016
       xcckud017 LIKE xcck_t.xcckud017, #自定義欄位(數字)017
       xcckud018 LIKE xcck_t.xcckud018, #自定義欄位(數字)018
       xcckud019 LIKE xcck_t.xcckud019, #自定義欄位(數字)019
       xcckud020 LIKE xcck_t.xcckud020, #自定義欄位(數字)020
       xcckud021 LIKE xcck_t.xcckud021, #自定義欄位(日期時間)021
       xcckud022 LIKE xcck_t.xcckud022, #自定義欄位(日期時間)022
       xcckud023 LIKE xcck_t.xcckud023, #自定義欄位(日期時間)023
       xcckud024 LIKE xcck_t.xcckud024, #自定義欄位(日期時間)024
       xcckud025 LIKE xcck_t.xcckud025, #自定義欄位(日期時間)025
       xcckud026 LIKE xcck_t.xcckud026, #自定義欄位(日期時間)026
       xcckud027 LIKE xcck_t.xcckud027, #自定義欄位(日期時間)027
       xcckud028 LIKE xcck_t.xcckud028, #自定義欄位(日期時間)028
       xcckud029 LIKE xcck_t.xcckud029, #自定義欄位(日期時間)029
       xcckud030 LIKE xcck_t.xcckud030, #自定義欄位(日期時間)030
       #161109-00085#63 --e add
       xcck056 LIKE xcck_t.xcck056  #成本代銷單號
          END RECORD
#161109-00085#19-e mod
DEFINE ld_date         DATETIME YEAR TO SECOND

   LET g_success = 'Y'
   LET l_xcea.xceaownid = g_user
   LET l_xcea.xceaowndp = g_dept
   LET l_xcea.xceacrtid = g_user
   LET l_xcea.xceacrtdp = g_dept 
   LET ld_date  = cl_get_current()
   LET l_xcea.xceacrtdt = ld_date
   LET l_xcea.xceamodid = ""
   LET l_xcea.xceamoddt = ""
   CALL s_aooi200_fin_gen_docno(g_xcea_m.xceald,'','',g_xcea_m.xceadocno,g_xcea_m.xcea001,g_prog_name1)  
   RETURNING l_success,g_xcea_m.xceadocno
   IF l_success  = 0  THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = 'apm-00003'
      LET g_errparam.extend = g_xcea_m.xceadocno
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET g_success = 'N'
      RETURN g_success
   END IF
   
   INSERT INTO xcea_t (xceaent, xceald,xceacomp,xcea006,xceadocno,
                       xcea001,xcea002, xcea004,xcea005,  xcea003,
                       xceastus,xceaownid,xceaowndp,xceacrtid,xceacrtdp,
                       xceacrtdt,xceamodid,xceamoddt)
   VALUES (g_enterprise,g_xcea_m.xceald,g_xcea_m.xceacomp,g_xcea_m.xcea006,g_xcea_m.xceadocno, 
           g_xcea_m.xcea001,g_xcea002,g_xcea_m.xcea004,g_xcea_m.xcea005,g_xcea_m.xcea003, 
           'N',l_xcea.xceaownid,l_xcea.xceaowndp,l_xcea.xceacrtid,l_xcea.xceacrtdp,
           ld_date,l_xcea.xceamodid,l_xcea.xceamoddt) 
       
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "g_xcea_m"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET g_success = 'N'
      RETURN g_success
   END IF
   
   LET g_sql = " SELECT SUM(xcck009*xcck202), ",
               "        SUM(xcck009*xcck202a),SUM(xcck009*xcck202b),SUM(xcck009*xcck202c),SUM(xcck009*xcck202d),",
               "        SUM(xcck009*xcck202e),SUM(xcck009*xcck202f),SUM(xcck009*xcck202g),SUM(xcck009*xcck202h) ",
               "        FROM xcck_t ", 
               "  WHERE xcckent = '",g_enterprise,"' AND xcckld = '",g_xcea_m.xceald,"'",
               "    AND xcck003 = '",g_xcea_m.xcea003,"' AND xcck004 = ",g_xcea_m.xcea004,
               "    AND xcck005 = ",g_xcea_m.xcea005,              
               "    AND xcck020 IN ('401') ",      
               "    AND xcck002 = ? AND xcck006 = ? AND xcck010 = ? AND xcck011 = ? AND xcck009 = ? AND xcck021 = ? ",
               "    AND xcck022 = ? AND xcck023 = ? AND xcck024 = ? ",
               "    AND xcck025 = ? AND xcck026 = ? AND xcck027 = ? ",
               "    AND xcck028 = ? AND xcck029 = ? AND xcck030 = ? ",
               "    AND xcck031 = ? " 
#161026-00056#1
   LET g_sql1 = g_sql CLIPPED," AND xcck001 = '2' " 
   LET g_sql1 = g_sql1," AND xcck033 = ? "    
   LET g_sql2 = g_sql CLIPPED," AND xcck001 = '3' "    
   LET g_sql2 = g_sql2," AND xcck033 = ? "
   
   LET g_sql = " SELECT xcck002,xcck006,xcck010,xcck011,xcck009,xcck021,xcck022,xcck023,xcck024,xcck025,xcck026,xcck027,xcck028,",
               "        xcck029,xcck030,xcck031,xcck033,SUM(xcck009*xcck201),SUM(xcck009*xcck202), ",
               "        SUM(xcck009*xcck202a),SUM(xcck009*xcck202b),SUM(xcck009*xcck202c),SUM(xcck009*xcck202d),",
               "        SUM(xcck009*xcck202e),SUM(xcck009*xcck202f),SUM(xcck009*xcck202g),SUM(xcck009*xcck202h) ",
               "        FROM xcck_t ", 
               "  WHERE xcckent = '",g_enterprise,"' AND xcckld = '",g_xcea_m.xceald,"'",
               "    AND xcck003 = '",g_xcea_m.xcea003,"' AND xcck004 = ",g_xcea_m.xcea004,
               "    AND xcck005 = ",g_xcea_m.xcea005,
               "    AND xcck001 = '1' ",
               "    AND xcck020 IN ('401') ",  
               " GROUP BY xcck002,xcck006,xcck010,xcck011,xcck009,xcck021,xcck022,xcck023,xcck024,xcck025,xcck026,xcck027,xcck028,xcck029,xcck030,xcck031,xcck033",
               " ORDER BY xcck002,xcck006,xcck010,xcck011,xcck009,xcck021,xcck022,xcck023,xcck024,xcck025,xcck026,xcck027,xcck028,xcck029,xcck030,xcck031,xcck033"
   PREPARE xcck_prep17_1 FROM g_sql
   DECLARE xcck_curs17_1 CURSOR FOR xcck_prep17_1
   

   FOREACH xcck_curs17_1 INTO l_xcck.xcck002,l_xcck.xcck006,l_xcck.xcck010,l_xcck.xcck011,l_xcck.xcck009,l_xcck.xcck021,l_xcck.xcck022,l_xcck.xcck023,
                              l_xcck.xcck024,l_xcck.xcck025,l_xcck.xcck026,l_xcck.xcck027,l_xcck.xcck028,
                              l_xcck.xcck029,l_xcck.xcck030,l_xcck.xcck031,l_xcck.xcck033,
                              l_xcck.xcck201,l_xcck.xcck202,l_xcck.xcck202a,l_xcck.xcck202b,l_xcck.xcck202c,
                              l_xcck.xcck202d,l_xcck.xcck202e,l_xcck.xcck202f,l_xcck.xcck202g,l_xcck.xcck202h

      INITIALIZE l_xceb.* TO NULL

      CASE l_xcck.xcck009
         WHEN -1          #調撥出庫
            LET l_xceb.xceb003 = '11'
         WHEN  1          #調撥入庫
            LET l_xceb.xceb003 = '10'        
      END CASE

      LET l_xceb.xceb001 = l_xcck.xcck006  

      #部門
      SELECT indc101,indc151 
        INTO l_xceb.xceb108,l_xceb.xceb110   
        FROM indc_t
       WHERE indcent = g_enterprise
         AND indcdocno = l_xcck.xcck006
         
      LET l_xceb.xceb103 = l_xcck.xcck002 #成本域
      LET l_xceb.xceb004 = l_xcck.xcck010 #料號
      LET l_xceb.xceb005 = l_xcck.xcck011 #特性
      IF NOT cl_null(l_xcck.xcck021) THEN
         LET l_xceb.xceb110 = l_xcck.xcck021 #原因碼
      END IF

      LET l_xceb.xceb111 = l_xcck.xcck022 #交易對象      
      LET l_xceb.xceb112 = l_xcck.xcck023 #客群 
      LET l_xceb.xceb113 = l_xcck.xcck024 #區域  
      LET l_xceb.xceb114 = l_xcck.xcck025 #成本中心      
      LET l_xceb.xceb115 = l_xcck.xcck026 #經營類別
      LET l_xceb.xceb116 = l_xcck.xcck027 #渠道
      LET l_xceb.xceb117 = l_xcck.xcck028 #品類
      LET l_xceb.xceb118 = l_xcck.xcck029 #品牌
      LET l_xceb.xceb119 = l_xcck.xcck030 #項目號
      LET l_xceb.xceb120 = l_xcck.xcck031 #WBS
      LET l_xceb.xceb101 = l_xcck.xcck033 #費用科目  
      
      LET l_xceb.xceb201 = l_xcck.xcck201
      LET l_xceb.xceb202 = l_xcck.xcck202
      LET l_xceb.xceb202a = l_xcck.xcck202a
      LET l_xceb.xceb202b = l_xcck.xcck202b
      LET l_xceb.xceb202c = l_xcck.xcck202c
      LET l_xceb.xceb202d = l_xcck.xcck202d
      LET l_xceb.xceb202e = l_xcck.xcck202e
      LET l_xceb.xceb202f = l_xcck.xcck202f
      LET l_xceb.xceb202g = l_xcck.xcck202g
      LET l_xceb.xceb202h = l_xcck.xcck202h
      
      IF cl_null(l_xceb.xceb201)  THEN LET l_xceb.xceb201  = 0 END IF
      IF cl_null(l_xceb.xceb202a) THEN LET l_xceb.xceb202a = 0 END IF
      IF cl_null(l_xceb.xceb202b) THEN LET l_xceb.xceb202b = 0 END IF
      IF cl_null(l_xceb.xceb202c) THEN LET l_xceb.xceb202c = 0 END IF
      IF cl_null(l_xceb.xceb202d) THEN LET l_xceb.xceb202d = 0 END IF
      IF cl_null(l_xceb.xceb202e) THEN LET l_xceb.xceb202e = 0 END IF
      IF cl_null(l_xceb.xceb202f) THEN LET l_xceb.xceb202f = 0 END IF
      IF cl_null(l_xceb.xceb202g) THEN LET l_xceb.xceb202g = 0 END IF
      IF cl_null(l_xceb.xceb202h) THEN LET l_xceb.xceb202h = 0 END IF
      IF cl_null(l_xceb.xceb202)  THEN LET l_xceb.xceb202  = 0 END IF      
      
      SELECT MAX(xcebseq) INTO l_xceb.xcebseq FROM xceb_t
       WHERE xcebent = g_enterprise AND xcebld = g_xcea_m.xceald
         AND xcebdocno = g_xcea_m.xceadocno
      IF cl_null(l_xceb.xcebseq) OR l_xceb.xcebseq = 0 THEN
         LET l_xceb.xcebseq = 1
      ELSE
         LET l_xceb.xcebseq = l_xceb.xcebseq + 1
      END IF  
 
       
     #费用科目費用科目如果是空的，則再根據賬套成本科目設定檔（glab_t）的調撥對方科目抓取(axci201) 
      IF cl_null(l_xceb.xceb101) THEN
         CALL s_fin_get_account(g_xcea_m.xceald,'60','8912','24') 
           RETURNING l_success,l_xceb.xceb101,l_errno
      END IF
     #費用科目抓不到，依部門的費用類別(aooi125)抓取agli180科目
      IF cl_null(l_xceb.xceb101) THEN
         CALL axct701_01_get_glab005(l_xcck.xcck025,g_xcea_m.xceald,'303',l_xcck.xcck021) 
           RETURNING l_xceb.xceb101      
      END IF
      
      IF g_glaa015 = 'Y' THEN
         DECLARE xcck_prep17_2 CURSOR FROM g_sql1
         OPEN xcck_prep17_2 USING l_xcck.xcck002,l_xcck.xcck006,l_xcck.xcck010,l_xcck.xcck011,l_xcck.xcck009,l_xcck.xcck021,l_xcck.xcck022,l_xcck.xcck023,
                                  l_xcck.xcck024,l_xcck.xcck025,l_xcck.xcck026,l_xcck.xcck027,l_xcck.xcck028,
                                  l_xcck.xcck029,l_xcck.xcck030,l_xcck.xcck031,l_xcck.xcck033
         FETCH xcck_prep17_2 INTO l_xceb.xceb212,l_xceb.xceb212a,l_xceb.xceb212b,l_xceb.xceb212c,l_xceb.xceb212d,
                                  l_xceb.xceb212e,l_xceb.xceb212f,l_xceb.xceb212g,l_xceb.xceb212h
         
         IF SQLCA.sqlcode THEN
            INITIALIZE g_errparam TO NULL
            LET g_errparam.code = SQLCA.sqlcode
            LET g_errparam.extend = "xcck_prep17_2"
            LET g_errparam.popup = FALSE
            CALL cl_err()         
            LET g_success = 'N'
            RETURN g_success
            EXIT FOREACH
         END IF
      
         IF cl_null(l_xceb.xceb212a) THEN LET l_xceb.xceb212a = 0 END IF
         IF cl_null(l_xceb.xceb212b) THEN LET l_xceb.xceb212b = 0 END IF
         IF cl_null(l_xceb.xceb212c) THEN LET l_xceb.xceb212c = 0 END IF
         IF cl_null(l_xceb.xceb212d) THEN LET l_xceb.xceb212d = 0 END IF
         IF cl_null(l_xceb.xceb212e) THEN LET l_xceb.xceb212e = 0 END IF
         IF cl_null(l_xceb.xceb212f) THEN LET l_xceb.xceb212f = 0 END IF
         IF cl_null(l_xceb.xceb212g) THEN LET l_xceb.xceb212g = 0 END IF
         IF cl_null(l_xceb.xceb212h) THEN LET l_xceb.xceb212h = 0 END IF
         IF cl_null(l_xceb.xceb212)  THEN LET l_xceb.xceb212  = 0 END IF
      ELSE
         LET l_xceb.xceb212a = 0
         LET l_xceb.xceb212b = 0
         LET l_xceb.xceb212c = 0
         LET l_xceb.xceb212d = 0
         LET l_xceb.xceb212e = 0
         LET l_xceb.xceb212f = 0
         LET l_xceb.xceb212g = 0
         LET l_xceb.xceb212h = 0
         LET l_xceb.xceb212  = 0     
      END IF
           
      
      IF g_glaa019 = 'Y' THEN 
         DECLARE xcck_prep17_3 CURSOR FROM g_sql2
         OPEN xcck_prep17_3 USING l_xcck.xcck002,l_xcck.xcck006,l_xcck.xcck010,l_xcck.xcck011,l_xcck.xcck009,l_xcck.xcck021,l_xcck.xcck022,l_xcck.xcck023,
                                  l_xcck.xcck024,l_xcck.xcck025,l_xcck.xcck026,l_xcck.xcck027,l_xcck.xcck028,
                                  l_xcck.xcck029,l_xcck.xcck030,l_xcck.xcck031,l_xcck.xcck033
         FETCH xcck_prep17_3 INTO l_xceb.xceb222,l_xceb.xceb222a,l_xceb.xceb222b,l_xceb.xceb222c,l_xceb.xceb222d,
                                  l_xceb.xceb222e,l_xceb.xceb222f,l_xceb.xceb222g,l_xceb.xceb222h
         
         IF SQLCA.sqlcode THEN
            INITIALIZE g_errparam TO NULL
            LET g_errparam.code = SQLCA.sqlcode
            LET g_errparam.extend = "xcck_prep17_3"
            LET g_errparam.popup = FALSE
            CALL cl_err()         
            LET g_success = 'N'
            RETURN g_success
            EXIT FOREACH
         END IF

         IF cl_null(l_xceb.xceb222a) THEN LET l_xceb.xceb222a = 0 END IF
         IF cl_null(l_xceb.xceb222b) THEN LET l_xceb.xceb222b = 0 END IF
         IF cl_null(l_xceb.xceb222c) THEN LET l_xceb.xceb222c = 0 END IF
         IF cl_null(l_xceb.xceb222d) THEN LET l_xceb.xceb222d = 0 END IF
         IF cl_null(l_xceb.xceb222e) THEN LET l_xceb.xceb222e = 0 END IF
         IF cl_null(l_xceb.xceb222f) THEN LET l_xceb.xceb222f = 0 END IF
         IF cl_null(l_xceb.xceb222g) THEN LET l_xceb.xceb222g = 0 END IF
         IF cl_null(l_xceb.xceb222h) THEN LET l_xceb.xceb222h = 0 END IF
         IF cl_null(l_xceb.xceb222)  THEN LET l_xceb.xceb222  = 0 END IF
      ELSE
         LET l_xceb.xceb222a = 0
         LET l_xceb.xceb222b = 0
         LET l_xceb.xceb222c = 0
         LET l_xceb.xceb222d = 0
         LET l_xceb.xceb222e = 0
         LET l_xceb.xceb222f = 0
         LET l_xceb.xceb222g = 0
         LET l_xceb.xceb222h = 0
         LET l_xceb.xceb222  = 0     
      END IF

      LET l_xceb.xcebent = g_enterprise 
      LET l_xceb.xcebcomp = g_xcea_m.xceacomp
      LET l_xceb.xcebld = g_xcea_m.xceald
      LET l_xceb.xcebdocno = g_xcea_m.xceadocno
      #摘要
      IF cl_null(l_xceb.xceb102) THEN
         CALL axct701_01_get_summ(g_xcea_m.xceald,'61','8925','17') RETURNING l_success,l_xceb.xceb102
      END IF

      #帳款對象放aooi100的"據點對應客戶/廠商編號"
      SELECT ooef024 INTO l_xceb.xceb109
        FROM ooef_t
       WHERE ooefent = g_enterprise
         AND ooef001 = g_xcea_m.xceacomp

      CALL axct701_01_default_space_xceb(l_xceb.*) RETURNING l_xceb.xceb005,
                                                             l_xceb.xceb101,
                                                             l_xceb.xceb102,
                                                             l_xceb.xceb103,
                                                             l_xceb.xceb110,
                                                             l_xceb.xceb111,
                                                             l_xceb.xceb112,
                                                             l_xceb.xceb113,
                                                             l_xceb.xceb114,
                                                             l_xceb.xceb115,
                                                             l_xceb.xceb116,
                                                             l_xceb.xceb117,
                                                             l_xceb.xceb118,
                                                             l_xceb.xceb119,
                                                             l_xceb.xceb120,
                                                             l_xceb.xceb107,
                                                             l_xceb.xceb108,
                                                             l_xceb.xceb109,
                                                             l_xceb.xceb121,
                                                             l_xceb.xceb122,
                                                             l_xceb.xceb123,
                                                             l_xceb.xceb124,
                                                             l_xceb.xceb125,
                                                             l_xceb.xceb126,
                                                             l_xceb.xceb127,
                                                             l_xceb.xceb128,
                                                             l_xceb.xceb129,
                                                             l_xceb.xceb130      
     #如果金額和數量都為0的話，則不產生此筆單身數據
      IF l_xceb.xceb201= 0 AND l_xceb.xceb202 = 0 THEN
         CONTINUE FOREACH
      END IF       
      #161109-00085#20-s mod
#      INSERT INTO xceb_t VALUES(l_xceb.*)   #161109-00085#20-s mark
      #161109-00085#63 --s mark
      #INSERT INTO xceb_t(xcebent,xcebcomp,xcebld,xcebdocno,xcebseq,xceb001,xceb002,xceb003,xceb004,
      #                   xceb005,xceb101,xceb102,xceb103,xceb110,xceb111,xceb112,xceb113,xceb114,xceb115,
      #                   xceb116,xceb117,xceb118,xceb119,xceb120,xceb201,xceb202,xceb202a,xceb202b,xceb202c,
      #                   xceb202d,xceb202e,xceb202f,xceb202g,xceb202h,xceb212,xceb212a,xceb212b,xceb212c,
      #                   xceb212d,xceb212e,xceb212f,xceb212g,xceb212h,xceb222,xceb222a,xceb222b,xceb222c,
      #                   xceb222d,xceb222e,xceb222f,xceb222g,xceb222h,xceb301,xceb302,xceb107,xceb108,xceb109,
      #                   xceb121,xceb122,xceb123,xceb124,xceb125,xceb126,xceb127,xceb128,xceb129,xceb130,xceb131,xceb132) 
      #            VALUES(l_xceb.xcebent,l_xceb.xcebcomp,l_xceb.xcebld,l_xceb.xcebdocno,l_xceb.xcebseq,
      #                   l_xceb.xceb001,l_xceb.xceb002,l_xceb.xceb003,l_xceb.xceb004,l_xceb.xceb005,
      #                   l_xceb.xceb101,l_xceb.xceb102,l_xceb.xceb103,l_xceb.xceb110,l_xceb.xceb111,
      #                   l_xceb.xceb112,l_xceb.xceb113,l_xceb.xceb114,l_xceb.xceb115,l_xceb.xceb116,
      #                   l_xceb.xceb117,l_xceb.xceb118,l_xceb.xceb119,l_xceb.xceb120,l_xceb.xceb201,
      #                   l_xceb.xceb202,l_xceb.xceb202a,l_xceb.xceb202b,l_xceb.xceb202c,l_xceb.xceb202d,
      #                   l_xceb.xceb202e,l_xceb.xceb202f,l_xceb.xceb202g,l_xceb.xceb202h,l_xceb.xceb212,
      #                   l_xceb.xceb212a,l_xceb.xceb212b,l_xceb.xceb212c,l_xceb.xceb212d,l_xceb.xceb212e,
      #                   l_xceb.xceb212f,l_xceb.xceb212g,l_xceb.xceb212h,l_xceb.xceb222,l_xceb.xceb222a,
      #                   l_xceb.xceb222b,l_xceb.xceb222c,l_xceb.xceb222d,l_xceb.xceb222e,l_xceb.xceb222f,
      #                   l_xceb.xceb222g,l_xceb.xceb222h,l_xceb.xceb301,l_xceb.xceb302,l_xceb.xceb107,
      #                   l_xceb.xceb108,l_xceb.xceb109,l_xceb.xceb121,l_xceb.xceb122,l_xceb.xceb123,
      #                   l_xceb.xceb124,l_xceb.xceb125,l_xceb.xceb126,l_xceb.xceb127,l_xceb.xceb128,
      #                   l_xceb.xceb129,l_xceb.xceb130,l_xceb.xceb131,l_xceb.xceb132)
      #161109-00085#20-e mod
      #161109-00085#63 --e mark
      #161109-00085#63 --s add
      INSERT INTO xceb_t(xcebent,xcebcomp,xcebld,xcebdocno,xcebseq,
                         xceb001,xceb002,xceb003,xceb004,xceb005,
                         xceb101,xceb102,xceb103,xceb110,xceb111,
                         xceb112,xceb113,xceb114,xceb115,xceb116,
                         xceb117,xceb118,xceb119,xceb120,xceb201,
                         xceb202,xceb202a,xceb202b,xceb202c,xceb202d,
                         xceb202e,xceb202f,xceb202g,xceb202h,xceb212,
                         xceb212a,xceb212b,xceb212c,xceb212d,xceb212e,
                         xceb212f,xceb212g,xceb212h,xceb222,xceb222a,
                         xceb222b,xceb222c,xceb222d,xceb222e,xceb222f,
                         xceb222g,xceb222h,xceb301,xceb302,xcebud001,
                         xcebud002,xcebud003,xcebud004,xcebud005,xcebud006,
                         xcebud007,xcebud008,xcebud009,xcebud010,xcebud011,
                         xcebud012,xcebud013,xcebud014,xcebud015,xcebud016,
                         xcebud017,xcebud018,xcebud019,xcebud020,xcebud021,
                         xcebud022,xcebud023,xcebud024,xcebud025,xcebud026,
                         xcebud027,xcebud028,xcebud029,xcebud030,xceb107,
                         xceb108,xceb109,xceb121,xceb122,xceb123,
                         xceb124,xceb125,xceb126,xceb127,xceb128,
                         xceb129,xceb130,xceb131,xceb132)
      VALUES(l_xceb.xcebent,l_xceb.xcebcomp,l_xceb.xcebld,l_xceb.xcebdocno,l_xceb.xcebseq,
             l_xceb.xceb001,l_xceb.xceb002,l_xceb.xceb003,l_xceb.xceb004,l_xceb.xceb005,
             l_xceb.xceb101,l_xceb.xceb102,l_xceb.xceb103,l_xceb.xceb110,l_xceb.xceb111,
             l_xceb.xceb112,l_xceb.xceb113,l_xceb.xceb114,l_xceb.xceb115,l_xceb.xceb116,
             l_xceb.xceb117,l_xceb.xceb118,l_xceb.xceb119,l_xceb.xceb120,l_xceb.xceb201,
             l_xceb.xceb202,l_xceb.xceb202a,l_xceb.xceb202b,l_xceb.xceb202c,l_xceb.xceb202d,
             l_xceb.xceb202e,l_xceb.xceb202f,l_xceb.xceb202g,l_xceb.xceb202h,l_xceb.xceb212,
             l_xceb.xceb212a,l_xceb.xceb212b,l_xceb.xceb212c,l_xceb.xceb212d,l_xceb.xceb212e,
             l_xceb.xceb212f,l_xceb.xceb212g,l_xceb.xceb212h,l_xceb.xceb222,l_xceb.xceb222a,
             l_xceb.xceb222b,l_xceb.xceb222c,l_xceb.xceb222d,l_xceb.xceb222e,l_xceb.xceb222f,
             l_xceb.xceb222g,l_xceb.xceb222h,l_xceb.xceb301,l_xceb.xceb302,l_xceb.xcebud001,
             l_xceb.xcebud002,l_xceb.xcebud003,l_xceb.xcebud004,l_xceb.xcebud005,l_xceb.xcebud006,
             l_xceb.xcebud007,l_xceb.xcebud008,l_xceb.xcebud009,l_xceb.xcebud010,l_xceb.xcebud011,
             l_xceb.xcebud012,l_xceb.xcebud013,l_xceb.xcebud014,l_xceb.xcebud015,l_xceb.xcebud016,
             l_xceb.xcebud017,l_xceb.xcebud018,l_xceb.xcebud019,l_xceb.xcebud020,l_xceb.xcebud021,
             l_xceb.xcebud022,l_xceb.xcebud023,l_xceb.xcebud024,l_xceb.xcebud025,l_xceb.xcebud026,
             l_xceb.xcebud027,l_xceb.xcebud028,l_xceb.xcebud029,l_xceb.xcebud030,l_xceb.xceb107,
             l_xceb.xceb108,l_xceb.xceb109,l_xceb.xceb121,l_xceb.xceb122,l_xceb.xceb123,
             l_xceb.xceb124,l_xceb.xceb125,l_xceb.xceb126,l_xceb.xceb127,l_xceb.xceb128,
             l_xceb.xceb129,l_xceb.xceb130,l_xceb.xceb131,l_xceb.xceb132)
      #161109-00085#63 --e add
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "ins xceb"
         LET g_errparam.popup = TRUE
         CALL cl_err()  
         LET g_success = 'N'
         RETURN g_success
         EXIT FOREACH
      END IF   
      CLOSE xcck_prep17_2
      CLOSE xcck_prep17_3  
  END FOREACH  
  
  LET g_sql = " SELECT  SUM(xcck009*xcck202), ",
               "        SUM(xcck009*xcck202a),SUM(xcck009*xcck202b),SUM(xcck009*xcck202c),SUM(xcck009*xcck202d),",
               "        SUM(xcck009*xcck202e),SUM(xcck009*xcck202f),SUM(xcck009*xcck202g),SUM(xcck009*xcck202h) ",
               "        FROM xcck_t ", 
               "  WHERE xcckent = '",g_enterprise,"' AND xcckld = '",g_xcea_m.xceald,"'",
               "    AND xcck003 = '",g_xcea_m.xcea003,"' AND xcck004 = ",g_xcea_m.xcea004,
               "    AND xcck005 = ",g_xcea_m.xcea005,
               "    AND xcck020 IN ('401') ",    
               "    AND xcck002 = ? AND xcck006 = ? AND xcck010 = ? AND xcck011 = ? AND xcck009 = ? AND xcck021 = ? ",
               "    AND xcck022 = ? AND xcck023 = ? AND xcck024 = ? ",
               "    AND xcck025 = ? AND xcck026 = ? AND xcck027 = ? ",
               "    AND xcck028 = ? AND xcck029 = ? AND xcck030 = ? ",
               "    AND xcck031 = ? " 
  
   LET g_sql1 = g_sql CLIPPED," AND xcck001 = '2' " 
   LET g_sql1 = g_sql1," AND xcck032 = ? "
   LET g_sql2 = g_sql CLIPPED," AND xcck001 = '3' " 
   LET g_sql2 = g_sql2," AND xcck032 = ? "
   
   LET g_sql = " SELECT xcck002,xcck006,xcck010,xcck011,xcck009,xcck021,xcck022,xcck023,xcck024,xcck025,xcck026,xcck027,xcck028,",
               "        xcck029,xcck030,xcck031,xcck032,SUM(xcck009*xcck201),SUM(xcck009*xcck202), ",
               "        SUM(xcck009*xcck202a),SUM(xcck009*xcck202b),SUM(xcck009*xcck202c),SUM(xcck009*xcck202d),",
               "        SUM(xcck009*xcck202e),SUM(xcck009*xcck202f),SUM(xcck009*xcck202g),SUM(xcck009*xcck202h) ",
               "        FROM xcck_t ", 
               "  WHERE xcckent = '",g_enterprise,"' AND xcckld = '",g_xcea_m.xceald,"'",
               "    AND xcck003 = '",g_xcea_m.xcea003,"' AND xcck004 = ",g_xcea_m.xcea004,
               "    AND xcck005 = ",g_xcea_m.xcea005,
               "    AND xcck001 = '1' ",
               "    AND xcck020 IN ('401') ",   
               " GROUP BY xcck002,xcck006,xcck010,xcck011,xcck009,xcck021,xcck022,xcck023,xcck024,xcck025,xcck026,xcck027,xcck028,xcck029,xcck030,xcck031,xcck032",
               " ORDER BY xcck002,xcck006,xcck010,xcck011,xcck009,xcck021,xcck022,xcck023,xcck024,xcck025,xcck026,xcck027,xcck028,xcck029,xcck030,xcck031,xcck032"
   PREPARE xcck_prep17_4 FROM g_sql
   DECLARE xcck_curs17_4 CURSOR FOR xcck_prep17_4
   

   FOREACH xcck_curs17_4 INTO l_xcck.xcck002,l_xcck.xcck006,l_xcck.xcck010,l_xcck.xcck011,l_xcck.xcck009,l_xcck.xcck021,l_xcck.xcck022,l_xcck.xcck023,
                              l_xcck.xcck024,l_xcck.xcck025,l_xcck.xcck026,l_xcck.xcck027,l_xcck.xcck028,
                              l_xcck.xcck029,l_xcck.xcck030,l_xcck.xcck031,l_xcck.xcck032,
                              l_xcck.xcck201,l_xcck.xcck202,l_xcck.xcck202a,l_xcck.xcck202b,l_xcck.xcck202c,
                              l_xcck.xcck202d,l_xcck.xcck202e,l_xcck.xcck202f,l_xcck.xcck202g,l_xcck.xcck202h

      INITIALIZE l_xcec.* TO NULL
      
      CASE l_xcck.xcck009
         WHEN -1          #調撥出庫
            LET l_xcec.xcec003 = '11'
         WHEN  1          #調撥入庫
            LET l_xcec.xcec003 = '10'        
      END CASE
     
      LET l_xcec.xcec001 = l_xcck.xcck006

      #部門
      SELECT indc101,indc151 
        INTO l_xcec.xcec108,l_xcec.xcec110   
        FROM indc_t
       WHERE indcent = g_enterprise
         AND indcdocno = l_xcck.xcck006         
         
      LET l_xcec.xcec103 = l_xcck.xcck002 #成本域
      LET l_xcec.xcec004 = l_xcck.xcck010 #料號
      LET l_xcec.xcec005 = l_xcck.xcck011 #特性
      IF NOT cl_null(l_xcck.xcck021) THEN
         LET l_xcec.xcec110 = l_xcck.xcck021 #原因碼
      END IF

      LET l_xcec.xcec111 = l_xcck.xcck022 #交易對象      
      LET l_xcec.xcec112 = l_xcck.xcck023 #客群 
      LET l_xcec.xcec113 = l_xcck.xcck024 #區域  
      LET l_xcec.xcec114 = l_xcck.xcck025 #成本中心      
      LET l_xcec.xcec115 = l_xcck.xcck026 #經營類別
      LET l_xcec.xcec116 = l_xcck.xcck027 #渠道
      LET l_xcec.xcec117 = l_xcck.xcck028 #品類
      LET l_xcec.xcec118 = l_xcck.xcck029 #品牌
      LET l_xcec.xcec119 = l_xcck.xcck030 #項目號
      LET l_xcec.xcec120 = l_xcck.xcck031 #WBS
      LET l_xcec.xcec101 = l_xcck.xcck032 #存貨科目 

      LET l_xcec.xcec201 = l_xcck.xcck201 
      LET l_xcec.xcec202 = l_xcck.xcck202
      LET l_xcec.xcec202a = l_xcck.xcck202a
      LET l_xcec.xcec202b = l_xcck.xcck202b
      LET l_xcec.xcec202c = l_xcck.xcck202c
      LET l_xcec.xcec202d = l_xcck.xcck202d
      LET l_xcec.xcec202e = l_xcck.xcck202e
      LET l_xcec.xcec202f = l_xcck.xcck202f
      LET l_xcec.xcec202g = l_xcck.xcck202g
      LET l_xcec.xcec202h = l_xcck.xcck202h
      
      IF cl_null(l_xcec.xcec202a) THEN LET l_xcec.xcec202a = 0 END IF
      IF cl_null(l_xcec.xcec202b) THEN LET l_xcec.xcec202b = 0 END IF
      IF cl_null(l_xcec.xcec202c) THEN LET l_xcec.xcec202c = 0 END IF
      IF cl_null(l_xcec.xcec202d) THEN LET l_xcec.xcec202d = 0 END IF
      IF cl_null(l_xcec.xcec202e) THEN LET l_xcec.xcec202e = 0 END IF
      IF cl_null(l_xcec.xcec202f) THEN LET l_xcec.xcec202f = 0 END IF
      IF cl_null(l_xcec.xcec202g) THEN LET l_xcec.xcec202g = 0 END IF
      IF cl_null(l_xcec.xcec202h) THEN LET l_xcec.xcec202h = 0 END IF
      IF cl_null(l_xcec.xcec202)  THEN LET l_xcec.xcec202  = 0 END IF         
      IF cl_null(l_xcec.xcec201)  THEN LET l_xcec.xcec201  = 0 END IF        
      
      SELECT MAX(xcecseq) INTO l_xcec.xcecseq FROM xcec_t
       WHERE xcecent = g_enterprise AND xcecld = g_xcea_m.xceald
         AND xcecdocno = g_xcea_m.xceadocno
      IF cl_null(l_xcec.xcecseq) OR l_xcec.xcecseq = 0 THEN
         LET l_xcec.xcecseq = 1
      ELSE
         LET l_xcec.xcecseq = l_xcec.xcecseq + 1
      END IF  
      #存貨科目 
      IF cl_null(l_xcec.xcec101) THEN  
         CALL s_get_item_acc(g_xcea_m.xceald,'1',l_xcec.xcec004,'','',g_xcea_m.xceacomp,'')   
          RETURNING l_success,l_xcec.xcec101    
      END IF      
    
      IF g_glaa015 ='Y' THEN
         DECLARE xcck_prep17_5 CURSOR FROM g_sql1
         OPEN xcck_prep17_5 USING l_xcck.xcck002,l_xcck.xcck006,l_xcck.xcck010,l_xcck.xcck011,l_xcck.xcck009,l_xcck.xcck021,l_xcck.xcck022,l_xcck.xcck023,
                                  l_xcck.xcck024,l_xcck.xcck025,l_xcck.xcck026,l_xcck.xcck027,l_xcck.xcck028,
                                  l_xcck.xcck029,l_xcck.xcck030,l_xcck.xcck031,l_xcck.xcck032
         FETCH xcck_prep17_5 INTO l_xcec.xcec212,l_xcec.xcec212a,l_xcec.xcec212b,l_xcec.xcec212c,l_xcec.xcec212d,
                                  l_xcec.xcec212e,l_xcec.xcec212f,l_xcec.xcec212g,l_xcec.xcec212h
         
         IF SQLCA.sqlcode THEN
            INITIALIZE g_errparam TO NULL
            LET g_errparam.code = SQLCA.sqlcode
            LET g_errparam.extend = "xcck_prep17_5"
            LET g_errparam.popup = FALSE
            CALL cl_err()         
            LET g_success = 'N'
            RETURN g_success
            EXIT FOREACH
         END IF
         
         IF cl_null(l_xcec.xcec212a) THEN LET l_xcec.xcec212a = 0 END IF
         IF cl_null(l_xcec.xcec212b) THEN LET l_xcec.xcec212b = 0 END IF
         IF cl_null(l_xcec.xcec212c) THEN LET l_xcec.xcec212c = 0 END IF
         IF cl_null(l_xcec.xcec212d) THEN LET l_xcec.xcec212d = 0 END IF
         IF cl_null(l_xcec.xcec212e) THEN LET l_xcec.xcec212e = 0 END IF
         IF cl_null(l_xcec.xcec212f) THEN LET l_xcec.xcec212f = 0 END IF
         IF cl_null(l_xcec.xcec212g) THEN LET l_xcec.xcec212g = 0 END IF
         IF cl_null(l_xcec.xcec212h) THEN LET l_xcec.xcec212h = 0 END IF
         IF cl_null(l_xcec.xcec212)  THEN LET l_xcec.xcec212  = 0 END IF 
      ELSE
         LET l_xceb.xceb212a = 0
         LET l_xceb.xceb212b = 0
         LET l_xceb.xceb212c = 0
         LET l_xceb.xceb212d = 0
         LET l_xceb.xceb212e = 0
         LET l_xceb.xceb212f = 0
         LET l_xceb.xceb212g = 0
         LET l_xceb.xceb212h = 0
         LET l_xceb.xceb212  = 0     
      END IF         
      
      IF g_glaa019 ='Y' THEN
         DECLARE xcck_prep17_6 CURSOR FROM g_sql2
         OPEN xcck_prep17_6 USING l_xcck.xcck002,l_xcck.xcck006,l_xcck.xcck010,l_xcck.xcck011,l_xcck.xcck009,l_xcck.xcck021,l_xcck.xcck022,l_xcck.xcck023,
                                  l_xcck.xcck024,l_xcck.xcck025,l_xcck.xcck026,l_xcck.xcck027,l_xcck.xcck028,
                                  l_xcck.xcck029,l_xcck.xcck030,l_xcck.xcck031,l_xcck.xcck032
         FETCH xcck_prep17_6 INTO l_xcec.xcec222,l_xcec.xcec222a,l_xcec.xcec222b,l_xcec.xcec222c,l_xcec.xcec222d,
                                  l_xcec.xcec222e,l_xcec.xcec222f,l_xcec.xcec222g,l_xcec.xcec222h
         
         IF SQLCA.sqlcode THEN
            INITIALIZE g_errparam TO NULL
            LET g_errparam.code = SQLCA.sqlcode
            LET g_errparam.extend = "xcck_prep17_6"
            LET g_errparam.popup = FALSE
            CALL cl_err()         
            LET g_success = 'N'
            RETURN g_success
            EXIT FOREACH
         END IF
         
         IF cl_null(l_xcec.xcec222a) THEN LET l_xcec.xcec222a = 0 END IF
         IF cl_null(l_xcec.xcec222b) THEN LET l_xcec.xcec222b = 0 END IF
         IF cl_null(l_xcec.xcec222c) THEN LET l_xcec.xcec222c = 0 END IF
         IF cl_null(l_xcec.xcec222d) THEN LET l_xcec.xcec222d = 0 END IF
         IF cl_null(l_xcec.xcec222e) THEN LET l_xcec.xcec222e = 0 END IF
         IF cl_null(l_xcec.xcec222f) THEN LET l_xcec.xcec222f = 0 END IF
         IF cl_null(l_xcec.xcec222g) THEN LET l_xcec.xcec222g = 0 END IF
         IF cl_null(l_xcec.xcec222h) THEN LET l_xcec.xcec222h = 0 END IF
         IF cl_null(l_xcec.xcec222)  THEN LET l_xcec.xcec222  = 0 END IF  
      ELSE
         LET l_xceb.xceb222a = 0
         LET l_xceb.xceb222b = 0
         LET l_xceb.xceb222c = 0
         LET l_xceb.xceb222d = 0
         LET l_xceb.xceb222e = 0
         LET l_xceb.xceb222f = 0
         LET l_xceb.xceb222g = 0
         LET l_xceb.xceb222h = 0
         LET l_xceb.xceb222  = 0     
      END IF         
      
      
      LET l_xcec.xcecent = g_enterprise 
      LET l_xcec.xceccomp = g_xcea_m.xceacomp
      LET l_xcec.xcecld = g_xcea_m.xceald
      LET l_xcec.xcecdocno = g_xcea_m.xceadocno
      #摘要
      IF cl_null(l_xcec.xcec102) THEN
         CALL axct701_01_get_summ(g_xcea_m.xceald,'61','8925','17') RETURNING l_success,l_xcec.xcec102
      END IF
      
      CALL axct701_01_default_space_xcec(l_xcec.*) RETURNING l_xcec.xcec005,   
                                                             l_xcec.xcec101,
                                                             l_xcec.xcec102,
                                                             l_xcec.xcec103,
                                                             l_xcec.xcec110,
                                                             l_xcec.xcec111,
                                                             l_xcec.xcec112,
                                                             l_xcec.xcec113,
                                                             l_xcec.xcec114,
                                                             l_xcec.xcec115,
                                                             l_xcec.xcec116,
                                                             l_xcec.xcec117,
                                                             l_xcec.xcec118,
                                                             l_xcec.xcec119,
                                                             l_xcec.xcec120,
                                                             l_xcec.xcec107,
                                                             l_xcec.xcec108,
                                                             l_xcec.xcec109,
                                                             l_xcec.xcec121,
                                                             l_xcec.xcec122,
                                                             l_xcec.xcec123,
                                                             l_xcec.xcec124,
                                                             l_xcec.xcec125,
                                                             l_xcec.xcec126,
                                                             l_xcec.xcec127,
                                                             l_xcec.xcec128,
                                                             l_xcec.xcec129,
                                                             l_xcec.xcec130 
      #金額和數量都為0，則不產生此筆單身數據
      IF l_xcec.xcec201= 0 AND l_xcec.xcec202 = 0 THEN
         CONTINUE FOREACH
      END IF      
      #161109-00085#20-s mod      
#      INSERT INTO xcec_t VALUES(l_xcec.*)   #161109-00085#20-s mark
      #161109-00085#63 --s mark
      #INSERT INTO xcec_t(xcecent,xceccomp,xcecld,xcecdocno,xcecseq,xcec001,xcec002,xcec003,xcec004,
      #                   xcec005,xcec101,xcec102,xcec103,xcec110,xcec111,xcec112,xcec113,xcec114,
      #                   xcec115,xcec116,xcec117,xcec118,xcec119,xcec120,xcec201,xcec202,xcec202a,
      #                   xcec202b,xcec202c,xcec202d,xcec202e,xcec202f,xcec202g,xcec202h,xcec212,
      #                   xcec212a,xcec212b,xcec212c,xcec212d,xcec212e,xcec212f,xcec212g,xcec212h,
      #                   xcec222,xcec222a,xcec222b,xcec222c,xcec222d,xcec222e,xcec222f,xcec222g,
      #                   xcec222h,xcec301,xcec302,xcec107,xcec108,xcec109,xcec121,xcec122,xcec123,
      #                   xcec124,xcec125,xcec126,xcec127,xcec128,xcec129,xcec130) 
      #            VALUES(l_xcec.xcecent,l_xcec.xceccomp,l_xcec.xcecld,l_xcec.xcecdocno,l_xcec.xcecseq,
      #                   l_xcec.xcec001,l_xcec.xcec002,l_xcec.xcec003,l_xcec.xcec004,l_xcec.xcec005,
      #                   l_xcec.xcec101,l_xcec.xcec102,l_xcec.xcec103,l_xcec.xcec110,l_xcec.xcec111,
      #                   l_xcec.xcec112,l_xcec.xcec113,l_xcec.xcec114,l_xcec.xcec115,l_xcec.xcec116,
      #                   l_xcec.xcec117,l_xcec.xcec118,l_xcec.xcec119,l_xcec.xcec120,l_xcec.xcec201,
      #                   l_xcec.xcec202,l_xcec.xcec202a,l_xcec.xcec202b,l_xcec.xcec202c,l_xcec.xcec202d,
      #                   l_xcec.xcec202e,l_xcec.xcec202f,l_xcec.xcec202g,l_xcec.xcec202h,l_xcec.xcec212,
      #                   l_xcec.xcec212a,l_xcec.xcec212b,l_xcec.xcec212c,l_xcec.xcec212d,l_xcec.xcec212e,
      #                   l_xcec.xcec212f,l_xcec.xcec212g,l_xcec.xcec212h,l_xcec.xcec222,l_xcec.xcec222a,
      #                   l_xcec.xcec222b,l_xcec.xcec222c,l_xcec.xcec222d,l_xcec.xcec222e,l_xcec.xcec222f,
      #                   l_xcec.xcec222g,l_xcec.xcec222h,l_xcec.xcec301,l_xcec.xcec302,l_xcec.xcec107,
      #                   l_xcec.xcec108,l_xcec.xcec109,l_xcec.xcec121,l_xcec.xcec122,l_xcec.xcec123,
      #                   l_xcec.xcec124,l_xcec.xcec125,l_xcec.xcec126,l_xcec.xcec127,l_xcec.xcec128,
      #                   l_xcec.xcec129,l_xcec.xcec130)
      #161109-00085#63 --e mark
      #161109-00085#20-e mod
      #161109-00085#63 --s add
      INSERT INTO xcec_t(xcecent,xceccomp,xcecld,xcecdocno,xcecseq,
                         xcec001,xcec002,xcec003,xcec004,xcec005,
                         xcec101,xcec102,xcec103,xcec110,xcec111,
                         xcec112,xcec113,xcec114,xcec115,xcec116,
                         xcec117,xcec118,xcec119,xcec120,xcec201,
                         xcec202,xcec202a,xcec202b,xcec202c,xcec202d,
                         xcec202e,xcec202f,xcec202g,xcec202h,xcec212,
                         xcec212a,xcec212b,xcec212c,xcec212d,xcec212e,
                         xcec212f,xcec212g,xcec212h,xcec222,xcec222a,
                         xcec222b,xcec222c,xcec222d,xcec222e,xcec222f,
                         xcec222g,xcec222h,xcec301,xcec302,xcecud001,
                         xcecud002,xcecud003,xcecud004,xcecud005,xcecud006,
                         xcecud007,xcecud008,xcecud009,xcecud010,xcecud011,
                         xcecud012,xcecud013,xcecud014,xcecud015,xcecud016,
                         xcecud017,xcecud018,xcecud019,xcecud020,xcecud021,
                         xcecud022,xcecud023,xcecud024,xcecud025,xcecud026,
                         xcecud027,xcecud028,xcecud029,xcecud030,xcec107,
                         xcec108,xcec109,xcec121,xcec122,xcec123,
                         xcec124,xcec125,xcec126,xcec127,xcec128,
                         xcec129,xcec130)
      VALUES(l_xcec.xcecent,l_xcec.xceccomp,l_xcec.xcecld,l_xcec.xcecdocno,l_xcec.xcecseq,
             l_xcec.xcec001,l_xcec.xcec002,l_xcec.xcec003,l_xcec.xcec004,l_xcec.xcec005,
             l_xcec.xcec101,l_xcec.xcec102,l_xcec.xcec103,l_xcec.xcec110,l_xcec.xcec111,
             l_xcec.xcec112,l_xcec.xcec113,l_xcec.xcec114,l_xcec.xcec115,l_xcec.xcec116,
             l_xcec.xcec117,l_xcec.xcec118,l_xcec.xcec119,l_xcec.xcec120,l_xcec.xcec201,
             l_xcec.xcec202,l_xcec.xcec202a,l_xcec.xcec202b,l_xcec.xcec202c,l_xcec.xcec202d,
             l_xcec.xcec202e,l_xcec.xcec202f,l_xcec.xcec202g,l_xcec.xcec202h,l_xcec.xcec212,
             l_xcec.xcec212a,l_xcec.xcec212b,l_xcec.xcec212c,l_xcec.xcec212d,l_xcec.xcec212e,
             l_xcec.xcec212f,l_xcec.xcec212g,l_xcec.xcec212h,l_xcec.xcec222,l_xcec.xcec222a,
             l_xcec.xcec222b,l_xcec.xcec222c,l_xcec.xcec222d,l_xcec.xcec222e,l_xcec.xcec222f,
             l_xcec.xcec222g,l_xcec.xcec222h,l_xcec.xcec301,l_xcec.xcec302,l_xcec.xcecud001,
             l_xcec.xcecud002,l_xcec.xcecud003,l_xcec.xcecud004,l_xcec.xcecud005,l_xcec.xcecud006,
             l_xcec.xcecud007,l_xcec.xcecud008,l_xcec.xcecud009,l_xcec.xcecud010,l_xcec.xcecud011,
             l_xcec.xcecud012,l_xcec.xcecud013,l_xcec.xcecud014,l_xcec.xcecud015,l_xcec.xcecud016,
             l_xcec.xcecud017,l_xcec.xcecud018,l_xcec.xcecud019,l_xcec.xcecud020,l_xcec.xcecud021,
             l_xcec.xcecud022,l_xcec.xcecud023,l_xcec.xcecud024,l_xcec.xcecud025,l_xcec.xcecud026,
             l_xcec.xcecud027,l_xcec.xcecud028,l_xcec.xcecud029,l_xcec.xcecud030,l_xcec.xcec107,
             l_xcec.xcec108,l_xcec.xcec109,l_xcec.xcec121,l_xcec.xcec122,l_xcec.xcec123,
             l_xcec.xcec124,l_xcec.xcec125,l_xcec.xcec126,l_xcec.xcec127,l_xcec.xcec128,
             l_xcec.xcec129,l_xcec.xcec130)
      #161109-00085#63 --e add
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "ins xcec"
         LET g_errparam.popup = TRUE
         CALL cl_err() 
         LET g_success = 'N'
         RETURN g_success
         EXIT FOREACH
      END IF   
      CLOSE xcck_prep17_5
      CLOSE xcck_prep17_6 
  END FOREACH 
  
  RETURN g_success

END FUNCTION

################################################################################
# Descriptions...: 新增axct719    18.專案費用分攤
# Memo...........:
# Usage..........: CALL axct701_01_ins_19()
#                  RETURNING r_success 
# Input parameter: 
# Return code....: r_success TRUE/FALSE
# Date & Author..: #170217-00057#1 170330 By Reanna
# Modify.........: 
################################################################################
PRIVATE FUNCTION axct701_01_ins_19()
DEFINE l_xcea    RECORD  #工單發料成本憑證單頭檔
          xceaent   LIKE xcea_t.xceaent,   #企業編號
          xceacomp  LIKE xcea_t.xceacomp,  #法人組織
          xceald    LIKE xcea_t.xceald,    #帳套
          xceadocno LIKE xcea_t.xceadocno, #單據編號
          xcea001   LIKE xcea_t.xcea001,   #單據日期
          xcea002   LIKE xcea_t.xcea002,   #成本憑證類型
          xcea003   LIKE xcea_t.xcea003,   #成本計算類型
          xcea004   LIKE xcea_t.xcea004,   #年度
          xcea005   LIKE xcea_t.xcea005,   #期別
          xcea006   LIKE xcea_t.xcea006,   #帳務人員
          xcea007   LIKE xcea_t.xcea007,   #帳務部門
          xcea101   LIKE xcea_t.xcea101,   #憑證編號
          xcea102   LIKE xcea_t.xcea102,   #憑證日期
          xceaownid LIKE xcea_t.xceaownid, #資料所有者
          xceaowndp LIKE xcea_t.xceaowndp, #資料所屬部門
          xceacrtid LIKE xcea_t.xceacrtid, #資料建立者
          xceacrtdp LIKE xcea_t.xceacrtdp, #資料建立部門
          xceacrtdt LIKE xcea_t.xceacrtdt, #資料創建日
          xceamodid LIKE xcea_t.xceamodid, #資料修改者
          xceamoddt LIKE xcea_t.xceamoddt, #最近修改日
          xceacnfid LIKE xcea_t.xceacnfid, #資料確認者
          xceacnfdt LIKE xcea_t.xceacnfdt, #資料確認日
          xceapstid LIKE xcea_t.xceapstid, #資料過帳者
          xceapstdt LIKE xcea_t.xceapstdt, #資料過帳日
          xceastus  LIKE xcea_t.xceastus,  #狀態碼
          xceaud001 LIKE xcea_t.xceaud001, #自定義欄位(文字)001
          xceaud002 LIKE xcea_t.xceaud002, #自定義欄位(文字)002
          xceaud003 LIKE xcea_t.xceaud003, #自定義欄位(文字)003
          xceaud004 LIKE xcea_t.xceaud004, #自定義欄位(文字)004
          xceaud005 LIKE xcea_t.xceaud005, #自定義欄位(文字)005
          xceaud006 LIKE xcea_t.xceaud006, #自定義欄位(文字)006
          xceaud007 LIKE xcea_t.xceaud007, #自定義欄位(文字)007
          xceaud008 LIKE xcea_t.xceaud008, #自定義欄位(文字)008
          xceaud009 LIKE xcea_t.xceaud009, #自定義欄位(文字)009
          xceaud010 LIKE xcea_t.xceaud010, #自定義欄位(文字)010
          xceaud011 LIKE xcea_t.xceaud011, #自定義欄位(數字)011
          xceaud012 LIKE xcea_t.xceaud012, #自定義欄位(數字)012
          xceaud013 LIKE xcea_t.xceaud013, #自定義欄位(數字)013
          xceaud014 LIKE xcea_t.xceaud014, #自定義欄位(數字)014
          xceaud015 LIKE xcea_t.xceaud015, #自定義欄位(數字)015
          xceaud016 LIKE xcea_t.xceaud016, #自定義欄位(數字)016
          xceaud017 LIKE xcea_t.xceaud017, #自定義欄位(數字)017
          xceaud018 LIKE xcea_t.xceaud018, #自定義欄位(數字)018
          xceaud019 LIKE xcea_t.xceaud019, #自定義欄位(數字)019
          xceaud020 LIKE xcea_t.xceaud020, #自定義欄位(數字)020
          xceaud021 LIKE xcea_t.xceaud021, #自定義欄位(日期時間)021
          xceaud022 LIKE xcea_t.xceaud022, #自定義欄位(日期時間)022
          xceaud023 LIKE xcea_t.xceaud023, #自定義欄位(日期時間)023
          xceaud024 LIKE xcea_t.xceaud024, #自定義欄位(日期時間)024
          xceaud025 LIKE xcea_t.xceaud025, #自定義欄位(日期時間)025
          xceaud026 LIKE xcea_t.xceaud026, #自定義欄位(日期時間)026
          xceaud027 LIKE xcea_t.xceaud027, #自定義欄位(日期時間)027
          xceaud028 LIKE xcea_t.xceaud028, #自定義欄位(日期時間)028
          xceaud029 LIKE xcea_t.xceaud029, #自定義欄位(日期時間)029
          xceaud030 LIKE xcea_t.xceaud030, #自定義欄位(日期時間)030
          xceasite  LIKE xcea_t.xceasite   #營運據點
                 END RECORD
DEFINE l_xceb    RECORD  #成本憑證第一單身檔
          xcebent   LIKE xceb_t.xcebent,   #企業編號
          xcebcomp  LIKE xceb_t.xcebcomp,  #法人組織
          xcebld    LIKE xceb_t.xcebld,    #帳套
          xcebdocno LIKE xceb_t.xcebdocno, #單據編號
          xcebseq   LIKE xceb_t.xcebseq,   #項次
          xceb001   LIKE xceb_t.xceb001,   #參考單據編號
          xceb002   LIKE xceb_t.xceb002,   #參考單據項次
          xceb003   LIKE xceb_t.xceb003,   #單據類型
          xceb004   LIKE xceb_t.xceb004,   #料件編號
          xceb005   LIKE xceb_t.xceb005,   #特性
          xceb101   LIKE xceb_t.xceb101,   #科目編號
          xceb102   LIKE xceb_t.xceb102,   #摘要
          xceb103   LIKE xceb_t.xceb103,   #成本域
          xceb110   LIKE xceb_t.xceb110,   #原因碼
          xceb111   LIKE xceb_t.xceb111,   #收付款客商
          xceb112   LIKE xceb_t.xceb112,   #客群
          xceb113   LIKE xceb_t.xceb113,   #區域
          xceb114   LIKE xceb_t.xceb114,   #成本中心
          xceb115   LIKE xceb_t.xceb115,   #經營類別
          xceb116   LIKE xceb_t.xceb116,   #通路
          xceb117   LIKE xceb_t.xceb117,   #品類
          xceb118   LIKE xceb_t.xceb118,   #品牌
          xceb119   LIKE xceb_t.xceb119,   #專案號
          xceb120   LIKE xceb_t.xceb120,   #WBS
          xceb201   LIKE xceb_t.xceb201,   #數量
          xceb202   LIKE xceb_t.xceb202,   #成本金額(本位幣一)
          xceb202a  LIKE xceb_t.xceb202a,  #成本-材料(本位幣一)
          xceb202b  LIKE xceb_t.xceb202b,  #成本-人工(本位幣一)
          xceb202c  LIKE xceb_t.xceb202c,  #成本-加工(本位幣一)
          xceb202d  LIKE xceb_t.xceb202d,  #成本-制費一(本位幣一)
          xceb202e  LIKE xceb_t.xceb202e,  #成本-制費二(本位幣一)
          xceb202f  LIKE xceb_t.xceb202f,  #成本-制費三(本位幣一)
          xceb202g  LIKE xceb_t.xceb202g,  #成本-制費四(本位幣一)
          xceb202h  LIKE xceb_t.xceb202h,  #成本-制費五(本位幣一)
          xceb212   LIKE xceb_t.xceb212,   #成本金額(本位幣二)
          xceb212a  LIKE xceb_t.xceb212a,  #成本-材料(本位幣二)
          xceb212b  LIKE xceb_t.xceb212b,  #成本-人工(本位幣二)
          xceb212c  LIKE xceb_t.xceb212c,  #成本-加工(本位幣二)
          xceb212d  LIKE xceb_t.xceb212d,  #成本-制費一(本位幣二)
          xceb212e  LIKE xceb_t.xceb212e,  #成本-制費二(本位幣二)
          xceb212f  LIKE xceb_t.xceb212f,  #成本-制費三(本位幣二)
          xceb212g  LIKE xceb_t.xceb212g,  #成本-制費四(本位幣二)
          xceb212h  LIKE xceb_t.xceb212h,  #成本-制費五(本位幣二)
          xceb222   LIKE xceb_t.xceb222,   #成本金額(本位幣三)
          xceb222a  LIKE xceb_t.xceb222a,  #成本-材料(本位幣三)
          xceb222b  LIKE xceb_t.xceb222b,  #成本-人工(本位幣三)
          xceb222c  LIKE xceb_t.xceb222c,  #成本-加工(本位幣三)
          xceb222d  LIKE xceb_t.xceb222d,  #成本-制費一(本位幣三)
          xceb222e  LIKE xceb_t.xceb222e,  #成本-制費二(本位幣三)
          xceb222f  LIKE xceb_t.xceb222f,  #成本-制費三(本位幣三)
          xceb222g  LIKE xceb_t.xceb222g,  #成本-制費四(本位幣三)
          xceb222h  LIKE xceb_t.xceb222h,  #成本-制費五(本位幣三)
          xceb301   LIKE xceb_t.xceb301,   #憑證編號
          xceb302   LIKE xceb_t.xceb302,   #憑證項次
          xcebud001 LIKE xceb_t.xcebud001, #自定義欄位(文字)001
          xcebud002 LIKE xceb_t.xcebud002, #自定義欄位(文字)002
          xcebud003 LIKE xceb_t.xcebud003, #自定義欄位(文字)003
          xcebud004 LIKE xceb_t.xcebud004, #自定義欄位(文字)004
          xcebud005 LIKE xceb_t.xcebud005, #自定義欄位(文字)005
          xcebud006 LIKE xceb_t.xcebud006, #自定義欄位(文字)006
          xcebud007 LIKE xceb_t.xcebud007, #自定義欄位(文字)007
          xcebud008 LIKE xceb_t.xcebud008, #自定義欄位(文字)008
          xcebud009 LIKE xceb_t.xcebud009, #自定義欄位(文字)009
          xcebud010 LIKE xceb_t.xcebud010, #自定義欄位(文字)010
          xcebud011 LIKE xceb_t.xcebud011, #自定義欄位(數字)011
          xcebud012 LIKE xceb_t.xcebud012, #自定義欄位(數字)012
          xcebud013 LIKE xceb_t.xcebud013, #自定義欄位(數字)013
          xcebud014 LIKE xceb_t.xcebud014, #自定義欄位(數字)014
          xcebud015 LIKE xceb_t.xcebud015, #自定義欄位(數字)015
          xcebud016 LIKE xceb_t.xcebud016, #自定義欄位(數字)016
          xcebud017 LIKE xceb_t.xcebud017, #自定義欄位(數字)017
          xcebud018 LIKE xceb_t.xcebud018, #自定義欄位(數字)018
          xcebud019 LIKE xceb_t.xcebud019, #自定義欄位(數字)019
          xcebud020 LIKE xceb_t.xcebud020, #自定義欄位(數字)020
          xcebud021 LIKE xceb_t.xcebud021, #自定義欄位(日期時間)021
          xcebud022 LIKE xceb_t.xcebud022, #自定義欄位(日期時間)022
          xcebud023 LIKE xceb_t.xcebud023, #自定義欄位(日期時間)023
          xcebud024 LIKE xceb_t.xcebud024, #自定義欄位(日期時間)024
          xcebud025 LIKE xceb_t.xcebud025, #自定義欄位(日期時間)025
          xcebud026 LIKE xceb_t.xcebud026, #自定義欄位(日期時間)026
          xcebud027 LIKE xceb_t.xcebud027, #自定義欄位(日期時間)027
          xcebud028 LIKE xceb_t.xcebud028, #自定義欄位(日期時間)028
          xcebud029 LIKE xceb_t.xcebud029, #自定義欄位(日期時間)029
          xcebud030 LIKE xceb_t.xcebud030, #自定義欄位(日期時間)030
          xceb107   LIKE xceb_t.xceb107,   #人員
          xceb108   LIKE xceb_t.xceb108,   #部門
          xceb109   LIKE xceb_t.xceb109,   #帳款對象
          xceb121   LIKE xceb_t.xceb121,   #自由核算項1
          xceb122   LIKE xceb_t.xceb122,   #自由核算項2
          xceb123   LIKE xceb_t.xceb123,   #自由核算項3
          xceb124   LIKE xceb_t.xceb124,   #自由核算項4
          xceb125   LIKE xceb_t.xceb125,   #自由核算項5
          xceb126   LIKE xceb_t.xceb126,   #自由核算項6
          xceb127   LIKE xceb_t.xceb127,   #自由核算項7
          xceb128   LIKE xceb_t.xceb128,   #自由核算項8
          xceb129   LIKE xceb_t.xceb129,   #自由核算項9
          xceb130   LIKE xceb_t.xceb130,   #自由核算項10
          xceb131   LIKE xceb_t.xceb131,   #單據類型(for 流通)
          xceb132   LIKE xceb_t.xceb132    #單據日期(for 流通)
                 END RECORD
DEFINE l_xcec    RECORD  #成本憑證第二單身檔
          xcecent   LIKE xcec_t.xcecent,   #企業編號
          xceccomp  LIKE xcec_t.xceccomp,  #法人組織
          xcecld    LIKE xcec_t.xcecld,    #帳套
          xcecdocno LIKE xcec_t.xcecdocno, #單據編號
          xcecseq   LIKE xcec_t.xcecseq,   #項次
          xcec001   LIKE xcec_t.xcec001,   #參考單據
          xcec002   LIKE xcec_t.xcec002,   #參考單據項次
          xcec003   LIKE xcec_t.xcec003,   #單據類型
          xcec004   LIKE xcec_t.xcec004,   #料件編號
          xcec005   LIKE xcec_t.xcec005,   #特性
          xcec101   LIKE xcec_t.xcec101,   #科目編號
          xcec102   LIKE xcec_t.xcec102,   #摘要
          xcec103   LIKE xcec_t.xcec103,   #成本域
          xcec110   LIKE xcec_t.xcec110,   #原因碼
          xcec111   LIKE xcec_t.xcec111,   #收付款客商
          xcec112   LIKE xcec_t.xcec112,   #客群
          xcec113   LIKE xcec_t.xcec113,   #區域
          xcec114   LIKE xcec_t.xcec114,   #成本中心
          xcec115   LIKE xcec_t.xcec115,   #經營類別
          xcec116   LIKE xcec_t.xcec116,   #通路
          xcec117   LIKE xcec_t.xcec117,   #品類
          xcec118   LIKE xcec_t.xcec118,   #品牌
          xcec119   LIKE xcec_t.xcec119,   #專案號
          xcec120   LIKE xcec_t.xcec120,   #WBS
          xcec201   LIKE xcec_t.xcec201,   #數量
          xcec202   LIKE xcec_t.xcec202,   #成本金額(本位幣一)
          xcec202a  LIKE xcec_t.xcec202a,  #成本-材料(本位幣一)
          xcec202b  LIKE xcec_t.xcec202b,  #成本-人工(本位幣一)
          xcec202c  LIKE xcec_t.xcec202c,  #成本-加工(本位幣一)
          xcec202d  LIKE xcec_t.xcec202d,  #成本-制費一(本位幣一)
          xcec202e  LIKE xcec_t.xcec202e,  #成本-制費二(本位幣一)
          xcec202f  LIKE xcec_t.xcec202f,  #成本-制費三(本位幣一)
          xcec202g  LIKE xcec_t.xcec202g,  #成本-制費四(本位幣一)
          xcec202h  LIKE xcec_t.xcec202h,  #成本-制費五(本位幣一)
          xcec212   LIKE xcec_t.xcec212,   #成本-金額(本位幣二)
          xcec212a  LIKE xcec_t.xcec212a,  #成本-材料(本位幣二)
          xcec212b  LIKE xcec_t.xcec212b,  #成本-人工(本位幣二)
          xcec212c  LIKE xcec_t.xcec212c,  #成本-加工(本位幣二)
          xcec212d  LIKE xcec_t.xcec212d,  #成本-制費一(本位幣二)
          xcec212e  LIKE xcec_t.xcec212e,  #成本-制費二(本位幣二)
          xcec212f  LIKE xcec_t.xcec212f,  #成本-制費三(本位幣二)
          xcec212g  LIKE xcec_t.xcec212g,  #成本-制費四(本位幣二)
          xcec212h  LIKE xcec_t.xcec212h,  #成本-制費五(本位幣二)
          xcec222   LIKE xcec_t.xcec222,   #成本-金額(本位幣三)
          xcec222a  LIKE xcec_t.xcec222a,  #成本-材料(本位幣三)
          xcec222b  LIKE xcec_t.xcec222b,  #成本-人工(本位幣三)
          xcec222c  LIKE xcec_t.xcec222c,  #成本-加工(本位幣三)
          xcec222d  LIKE xcec_t.xcec222d,  #成本-制費一(本位幣三)
          xcec222e  LIKE xcec_t.xcec222e,  #成本-制費二(本位幣三)
          xcec222f  LIKE xcec_t.xcec222f,  #成本-制費三(本位幣三)
          xcec222g  LIKE xcec_t.xcec222g,  #成本-制費四(本位幣三)
          xcec222h  LIKE xcec_t.xcec222h,  #成本-制費五(本位幣三)
          xcec301   LIKE xcec_t.xcec301,   #憑證編號
          xcec302   LIKE xcec_t.xcec302,   #憑證項次
          xcecud001 LIKE xcec_t.xcecud001, #自定義欄位(文字)001
          xcecud002 LIKE xcec_t.xcecud002, #自定義欄位(文字)002
          xcecud003 LIKE xcec_t.xcecud003, #自定義欄位(文字)003
          xcecud004 LIKE xcec_t.xcecud004, #自定義欄位(文字)004
          xcecud005 LIKE xcec_t.xcecud005, #自定義欄位(文字)005
          xcecud006 LIKE xcec_t.xcecud006, #自定義欄位(文字)006
          xcecud007 LIKE xcec_t.xcecud007, #自定義欄位(文字)007
          xcecud008 LIKE xcec_t.xcecud008, #自定義欄位(文字)008
          xcecud009 LIKE xcec_t.xcecud009, #自定義欄位(文字)009
          xcecud010 LIKE xcec_t.xcecud010, #自定義欄位(文字)010
          xcecud011 LIKE xcec_t.xcecud011, #自定義欄位(數字)011
          xcecud012 LIKE xcec_t.xcecud012, #自定義欄位(數字)012
          xcecud013 LIKE xcec_t.xcecud013, #自定義欄位(數字)013
          xcecud014 LIKE xcec_t.xcecud014, #自定義欄位(數字)014
          xcecud015 LIKE xcec_t.xcecud015, #自定義欄位(數字)015
          xcecud016 LIKE xcec_t.xcecud016, #自定義欄位(數字)016
          xcecud017 LIKE xcec_t.xcecud017, #自定義欄位(數字)017
          xcecud018 LIKE xcec_t.xcecud018, #自定義欄位(數字)018
          xcecud019 LIKE xcec_t.xcecud019, #自定義欄位(數字)019
          xcecud020 LIKE xcec_t.xcecud020, #自定義欄位(數字)020
          xcecud021 LIKE xcec_t.xcecud021, #自定義欄位(日期時間)021
          xcecud022 LIKE xcec_t.xcecud022, #自定義欄位(日期時間)022
          xcecud023 LIKE xcec_t.xcecud023, #自定義欄位(日期時間)023
          xcecud024 LIKE xcec_t.xcecud024, #自定義欄位(日期時間)024
          xcecud025 LIKE xcec_t.xcecud025, #自定義欄位(日期時間)025
          xcecud026 LIKE xcec_t.xcecud026, #自定義欄位(日期時間)026
          xcecud027 LIKE xcec_t.xcecud027, #自定義欄位(日期時間)027
          xcecud028 LIKE xcec_t.xcecud028, #自定義欄位(日期時間)028
          xcecud029 LIKE xcec_t.xcecud029, #自定義欄位(日期時間)029
          xcecud030 LIKE xcec_t.xcecud030, #自定義欄位(日期時間)030
          xcec107   LIKE xcec_t.xcec107,   #人員
          xcec108   LIKE xcec_t.xcec108,   #部門
          xcec109   LIKE xcec_t.xcec109,   #帳款對象
          xcec121   LIKE xcec_t.xcec121,   #自由核算項1
          xcec122   LIKE xcec_t.xcec122,   #自由核算項2
          xcec123   LIKE xcec_t.xcec123,   #自由核算項3
          xcec124   LIKE xcec_t.xcec124,   #自由核算項4
          xcec125   LIKE xcec_t.xcec125,   #自由核算項5
          xcec126   LIKE xcec_t.xcec126,   #自由核算項6
          xcec127   LIKE xcec_t.xcec127,   #自由核算項7
          xcec128   LIKE xcec_t.xcec128,   #自由核算項8
          xcec129   LIKE xcec_t.xcec129,   #自由核算項9
          xcec130   LIKE xcec_t.xcec130    #自由核算項10
               END RECORD
DEFINE l_pjec  RECORD  #項目費用分攤明細檔
          pjecent   LIKE pjec_t.pjecent,   #企业代码
          pjeccomp  LIKE pjec_t.pjeccomp,  #法人組織
          pjecld    LIKE pjec_t.pjecld,    #帳套
          pjec002   LIKE pjec_t.pjec002,   #年度
          pjec003   LIKE pjec_t.pjec003,   #期別
          pjecseq   LIKE pjec_t.pjecseq,   #項次
          pjec004   LIKE pjec_t.pjec004,   #專案編號
          pjec005   LIKE pjec_t.pjec005,   #WBS編號
          pjec010   LIKE pjec_t.pjec010,   #科目编号
          pjec011   LIKE pjec_t.pjec011,   #营运组织
          pjec012   LIKE pjec_t.pjec012,   #部門
          pjec013   LIKE pjec_t.pjec013,   #交易對象
          pjec014   LIKE pjec_t.pjec014,   #客群
          pjec015   LIKE pjec_t.pjec015,   #區域
          pjec016   LIKE pjec_t.pjec016,   #成本中心
          pjec017   LIKE pjec_t.pjec017,   #經營類別
          pjec018   LIKE pjec_t.pjec018,   #通路
          pjec019   LIKE pjec_t.pjec019,   #品類
          pjec020   LIKE pjec_t.pjec020,   #品牌
          pjec021   LIKE pjec_t.pjec021,   #項目編號（核算項）
          pjec022   LIKE pjec_t.pjec022,   #WBS（核算項）
          pjec023   LIKE pjec_t.pjec023,   #自由核算項一
          pjec024   LIKE pjec_t.pjec024,   #自由核算項二
          pjec025   LIKE pjec_t.pjec025,   #自由核算項三
          pjec026   LIKE pjec_t.pjec026,   #自由核算項四
          pjec027   LIKE pjec_t.pjec027,   #自由核算項五
          pjec028   LIKE pjec_t.pjec028,   #自由核算項六
          pjec029   LIKE pjec_t.pjec029,   #自由核算項七
          pjec030   LIKE pjec_t.pjec030,   #自由核算項八
          pjec031   LIKE pjec_t.pjec031,   #自由核算項九
          pjec032   LIKE pjec_t.pjec032,   #自由核算項十
          pjec099   LIKE pjec_t.pjec099,   #專案工時
          pjec100   LIKE pjec_t.pjec100,   #分攤金額
          pjec110   LIKE pjec_t.pjec110,   #分攤金額(本位幣二)
          pjec120   LIKE pjec_t.pjec120,   #分攤金額(本位幣三)
          pjec200   LIKE pjec_t.pjec200,   #分攤基數
          pjec300   LIKE pjec_t.pjec300,   #分攤單價
          pjec310   LIKE pjec_t.pjec310,   #分攤單價(本位幣二)
          pjec320   LIKE pjec_t.pjec320,   #分攤單價(本位幣三)
          pjecownid LIKE pjec_t.pjecownid, #資料所屬者
          pjecowndp LIKE pjec_t.pjecowndp, #資料所屬部門
          pjeccrtid LIKE pjec_t.pjeccrtid, #資料建立者
          pjeccrtdp LIKE pjec_t.pjeccrtdp, #資料建立部門
          pjeccrtdt LIKE pjec_t.pjeccrtdt, #資料創建日
          pjecmodid LIKE pjec_t.pjecmodid, #資料修改者
          pjecmoddt LIKE pjec_t.pjecmoddt, #最近修改日
          pjecstus  LIKE pjec_t.pjecstus   #狀態碼
               END RECORD
DEFINE ld_date      DATETIME YEAR TO SECOND
DEFINE l_rate       LIKE type_t.num26_10
DEFINE l_rate1      LIKE type_t.num26_10
DEFINE l_sql        STRING

   LET g_success = 'Y'
   
   #新增單頭xcea_t
   LET l_xcea.xceaent   = g_enterprise
   LET l_xcea.xceacomp  = g_xcea_m.xceacomp
   LET l_xcea.xceald    = g_xcea_m.xceald
   LET l_xcea.xcea001   = g_xcea_m.xcea001
   LET l_xcea.xcea002   = '18'   #18:專案費用分攤
   LET l_xcea.xcea003   = g_xcea_m.xcea003
   LET l_xcea.xcea004   = g_xcea_m.xcea004
   LET l_xcea.xcea005   = g_xcea_m.xcea005
   LET l_xcea.xcea006   = g_xcea_m.xcea006
   LET l_xcea.xcea007   = g_xcea_m.xcea007
   LET l_xcea.xcea101   = ''
   LET l_xcea.xcea102   = ''
   LET l_xcea.xceaownid = g_user
   LET l_xcea.xceaowndp = g_dept
   LET l_xcea.xceacrtid = g_user
   LET l_xcea.xceacrtdp = g_dept
   LET ld_date = cl_get_current()
   LET l_xcea.xceacrtdt = ld_date
   LET l_xcea.xceamodid = ''
   LET l_xcea.xceamoddt = ''
   LET l_xcea.xceacnfid = ''
   LET l_xcea.xceacnfdt = ''
   LET l_xcea.xceapstid = ''
   LET l_xcea.xceapstdt = ''
   LET l_xcea.xceastus  = 'N'
   CALL s_aooi200_fin_gen_docno(g_xcea_m.xceald,'','',g_xcea_m.xceadocno,g_xcea_m.xcea001,g_prog_name1)
        RETURNING g_sub_success,l_xcea.xceadocno
   IF g_sub_success  = 0  THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = 'apm-00003'
      LET g_errparam.extend = g_xcea_m.xceadocno
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET g_success = 'N'
      RETURN g_success
   END IF
   INSERT INTO xcea_t(xceaent,xceacomp,xceald,xceadocno,xcea001,
                      xcea002,xcea003,xcea004,xcea005,xcea006,
                      xcea007,xcea101,xcea102,
                      xceaownid,xceaowndp,xceacrtid,xceacrtdp,xceacrtdt,
                      xceamodid,xceamoddt,xceacnfid,xceacnfdt,xceapstid,
                      xceapstdt,xceastus,
                      xceaud001,xceaud002,xceaud003,xceaud004,xceaud005,
                      xceaud006,xceaud007,xceaud008,xceaud009,xceaud010,
                      xceaud011,xceaud012,xceaud013,xceaud014,xceaud015,
                      xceaud016,xceaud017,xceaud018,xceaud019,xceaud020,
                      xceaud021,xceaud022,xceaud023,xceaud024,xceaud025,
                      xceaud026,xceaud027,xceaud028,xceaud029,xceaud030,
                      xceasite)
   VALUES(l_xcea.xceaent,l_xcea.xceacomp,l_xcea.xceald,l_xcea.xceadocno,l_xcea.xcea001,
          l_xcea.xcea002,l_xcea.xcea003,l_xcea.xcea004,l_xcea.xcea005,l_xcea.xcea006,
          l_xcea.xcea007,l_xcea.xcea101,l_xcea.xcea102,
          l_xcea.xceaownid,l_xcea.xceaowndp,l_xcea.xceacrtid,l_xcea.xceacrtdp,l_xcea.xceacrtdt,
          l_xcea.xceamodid,l_xcea.xceamoddt,l_xcea.xceacnfid,l_xcea.xceacnfdt,l_xcea.xceapstid,
          l_xcea.xceapstdt,l_xcea.xceastus,
          l_xcea.xceaud001,l_xcea.xceaud002,l_xcea.xceaud003,l_xcea.xceaud004,l_xcea.xceaud005,
          l_xcea.xceaud006,l_xcea.xceaud007,l_xcea.xceaud008,l_xcea.xceaud009,l_xcea.xceaud010,
          l_xcea.xceaud011,l_xcea.xceaud012,l_xcea.xceaud013,l_xcea.xceaud014,l_xcea.xceaud015,
          l_xcea.xceaud016,l_xcea.xceaud017,l_xcea.xceaud018,l_xcea.xceaud019,l_xcea.xceaud020,
          l_xcea.xceaud021,l_xcea.xceaud022,l_xcea.xceaud023,l_xcea.xceaud024,l_xcea.xceaud025,
          l_xcea.xceaud026,l_xcea.xceaud027,l_xcea.xceaud028,l_xcea.xceaud029,l_xcea.xceaud030,
          l_xcea.xceasite)
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "xcea_t"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET g_success = 'N'
      RETURN g_success
   END IF
   
   LET g_xcea_m.xceadocno = l_xcea.xceadocno
   
   #xceb单身
   LET l_sql = " SELECT pjec004,pjec005,pjec010,pjec011,pjec012,",
               "        pjec013,pjec014,pjec015,pjec016,pjec017,",
               "        pjec018,pjec019,pjec020,pjec023,pjec024,",
               "        pjec025,pjec026,pjec027,pjec028,pjec029,",
               "        pjec030,pjec031,pjec032,pjec100,pjec200",
               "   FROM pjec_t ",
               "  WHERE pjecent = ",g_enterprise,
               "    AND pjecld = '",g_xcea_m.xceald,"' ",
               "    AND pjec002 = ",g_xcea_m.xcea004,
               "    AND pjec003 = ",g_xcea_m.xcea005,
               "    AND pjecstus= 'Y'",
               "  ORDER BY pjecseq "
   PREPARE axct701_01_ins_19_p1 FROM l_sql
   DECLARE axct701_01_ins_19_c1 CURSOR FOR axct701_01_ins_19_p1
   FOREACH axct701_01_ins_19_c1 INTO l_pjec.pjec004,l_pjec.pjec005,l_pjec.pjec010,l_pjec.pjec011,l_pjec.pjec012,
                                     l_pjec.pjec013,l_pjec.pjec014,l_pjec.pjec015,l_pjec.pjec016,l_pjec.pjec017,
                                     l_pjec.pjec018,l_pjec.pjec019,l_pjec.pjec020,l_pjec.pjec023,l_pjec.pjec024,
                                     l_pjec.pjec025,l_pjec.pjec026,l_pjec.pjec027,l_pjec.pjec028,l_pjec.pjec029,
                                     l_pjec.pjec030,l_pjec.pjec031,l_pjec.pjec032,l_pjec.pjec100,l_pjec.pjec200
      
      INITIALIZE l_xceb.* TO NULL
      
      SELECT MAX(xcebseq)+1 INTO l_xceb.xcebseq FROM xceb_t
       WHERE xcebent = g_enterprise
         AND xcebld = g_xcea_m.xceald
         AND xcebdocno = g_xcea_m.xceadocno
      IF cl_null(l_xceb.xcebseq) THEN LET l_xceb.xcebseq = 1 END IF 
      
      LET l_xceb.xcebent   = g_enterprise
      LET l_xceb.xcebcomp  = g_xcea_m.xceacomp
      LET l_xceb.xcebld    = g_xcea_m.xceald
      LET l_xceb.xcebdocno = g_xcea_m.xceadocno
      LET l_xceb.xceb001   = ''   #參考單據編號
      LET l_xceb.xceb002   = ''   #參考單據項次
      LET l_xceb.xceb003   = ''   #單據類型
      LET l_xceb.xceb004   = ''   #料件編號
      LET l_xceb.xceb005   = ''   #特性
      
      #科目編號(取axci201的"專案成本投入科目")
      CALL s_fin_get_account(g_xcea_m.xceald,'60','8912','10') RETURNING g_sub_success,l_xceb.xceb101,g_errno
      IF cl_null(l_xceb.xceb101) THEN LET l_xceb.xceb101 = ' ' END IF
      
      LET l_xceb.xceb102 = ''     #摘要
      LET l_xceb.xceb103 = ' '    #成本域
      LET l_xceb.xceb110 = ' '    #原因碼
      
      LET l_xceb.xceb111 = l_pjec.pjec013  #收付款客商
      LET l_xceb.xceb112 = l_pjec.pjec014  #客群
      LET l_xceb.xceb113 = l_pjec.pjec015  #區域
      LET l_xceb.xceb114 = l_pjec.pjec016  #成本中心
      LET l_xceb.xceb115 = l_pjec.pjec017  #經營類別
      LET l_xceb.xceb116 = l_pjec.pjec018  #渠道
      LET l_xceb.xceb117 = l_pjec.pjec019  #品類
      LET l_xceb.xceb118 = l_pjec.pjec020  #品牌
      LET l_xceb.xceb119 = l_pjec.pjec004  #專案編號
      LET l_xceb.xceb120 = l_pjec.pjec005  #WBS
      
      
      LET l_xceb.xceb107 = ' '  #人员
      LET l_xceb.xceb108 = l_pjec.pjec012  #部门
      LET l_xceb.xceb109 = l_xceb.xceb111  #账款对象
      
      IF cl_null(l_pjec.pjec200) THEN LET l_pjec.pjec200  = 0 END IF
      IF cl_null(l_pjec.pjec100) THEN LET l_pjec.pjec100  = 0 END IF
      LET l_xceb.xceb201  = l_pjec.pjec200  #數量
      LET l_xceb.xceb202  = l_pjec.pjec100  #成本金額(本位幣一)
      
      LET l_xceb.xceb202a = 0   #成本-材料(本位幣一)
      LET l_xceb.xceb202b = 0   #成本-人工(本位幣一)
      LET l_xceb.xceb202c = 0   #成本-加工(本位幣一)
      LET l_xceb.xceb202d = 0   #成本-制費一(本位幣一)
      LET l_xceb.xceb202e = 0   #成本-制費二(本位幣一)
      LET l_xceb.xceb202f = 0   #成本-制費三(本位幣一)
      LET l_xceb.xceb202g = 0   #成本-制費四(本位幣一)
      LET l_xceb.xceb202h = 0   #成本-制費五(本位幣一)
      
      #获取汇率>>#依账簿币别
      IF g_glaa015 = 'Y' THEN
         CALL s_aooi160_get_exrate('2',g_xcea_m.xceald,g_xcea_m.xcea001,g_glaa001,g_glaa016,0,g_glaa018)
              RETURNING l_rate
      END IF
      IF g_glaa019 = 'Y' THEN
         CALL s_aooi160_get_exrate('2',g_xcea_m.xceald,g_xcea_m.xcea001,g_glaa001,g_glaa016,0,g_glaa022)
            RETURNING l_rate1
      END IF
      
      #本位幣二
      IF g_glaa015 = 'Y' THEN
         LET l_xceb.xceb212  = l_xceb.xceb202  * l_rate  #成本金额(本位幣二)
         LET l_xceb.xceb212a = l_xceb.xceb202a * l_rate  #成本-材料(本位幣二)
         LET l_xceb.xceb212b = l_xceb.xceb202b * l_rate  #成本-人工(本位幣二)
         LET l_xceb.xceb212c = l_xceb.xceb202c * l_rate  #成本-加工(本位幣二)
         LET l_xceb.xceb212d = l_xceb.xceb202d * l_rate  #成本-制費一(本位幣二)
         LET l_xceb.xceb212e = l_xceb.xceb202e * l_rate  #成本-制費二(本位幣二)
         LET l_xceb.xceb212f = l_xceb.xceb202f * l_rate  #成本-制費三(本位幣二)
         LET l_xceb.xceb212g = l_xceb.xceb202g * l_rate  #成本-制費四(本位幣二)
         LET l_xceb.xceb212h = l_xceb.xceb202h * l_rate  #成本-制費五(本位幣二)
         IF cl_null(l_xceb.xceb212)  THEN LET l_xceb.xceb212  = 0 END IF
         IF cl_null(l_xceb.xceb212a) THEN LET l_xceb.xceb212a = 0 END IF
         IF cl_null(l_xceb.xceb212b) THEN LET l_xceb.xceb212b = 0 END IF
         IF cl_null(l_xceb.xceb212c) THEN LET l_xceb.xceb212c = 0 END IF
         IF cl_null(l_xceb.xceb212d) THEN LET l_xceb.xceb212d = 0 END IF
         IF cl_null(l_xceb.xceb212e) THEN LET l_xceb.xceb212e = 0 END IF
         IF cl_null(l_xceb.xceb212f) THEN LET l_xceb.xceb212f = 0 END IF
         IF cl_null(l_xceb.xceb212g) THEN LET l_xceb.xceb212g = 0 END IF
         IF cl_null(l_xceb.xceb212h) THEN LET l_xceb.xceb212h = 0 END IF
      ELSE
         LET l_xceb.xceb212  = 0
         LET l_xceb.xceb212a = 0
         LET l_xceb.xceb212b = 0
         LET l_xceb.xceb212c = 0
         LET l_xceb.xceb212d = 0
         LET l_xceb.xceb212e = 0
         LET l_xceb.xceb212f = 0
         LET l_xceb.xceb212g = 0
         LET l_xceb.xceb212h = 0
      END IF
      
      #本位幣三
      IF g_glaa019 = 'Y' THEN
         LET l_xceb.xceb222  = l_xceb.xceb202  * l_rate1
         LET l_xceb.xceb222a = l_xceb.xceb202a * l_rate1
         LET l_xceb.xceb222b = l_xceb.xceb202b * l_rate1
         LET l_xceb.xceb222c = l_xceb.xceb202c * l_rate1
         LET l_xceb.xceb222d = l_xceb.xceb202d * l_rate1
         LET l_xceb.xceb222e = l_xceb.xceb202e * l_rate1
         LET l_xceb.xceb222f = l_xceb.xceb202f * l_rate1
         LET l_xceb.xceb222g = l_xceb.xceb202g * l_rate1
         LET l_xceb.xceb222h = l_xceb.xceb202h * l_rate1
         IF cl_null(l_xceb.xceb222)  THEN LET l_xceb.xceb222  = 0 END IF
         IF cl_null(l_xceb.xceb222a) THEN LET l_xceb.xceb222a = 0 END IF
         IF cl_null(l_xceb.xceb222b) THEN LET l_xceb.xceb222b = 0 END IF
         IF cl_null(l_xceb.xceb222c) THEN LET l_xceb.xceb222c = 0 END IF
         IF cl_null(l_xceb.xceb222d) THEN LET l_xceb.xceb222d = 0 END IF
         IF cl_null(l_xceb.xceb222e) THEN LET l_xceb.xceb222e = 0 END IF
         IF cl_null(l_xceb.xceb222f) THEN LET l_xceb.xceb222f = 0 END IF
         IF cl_null(l_xceb.xceb222g) THEN LET l_xceb.xceb222g = 0 END IF
         IF cl_null(l_xceb.xceb222h) THEN LET l_xceb.xceb222h = 0 END IF
      ELSE
         LET l_xceb.xceb222  = 0
         LET l_xceb.xceb222a = 0
         LET l_xceb.xceb222b = 0
         LET l_xceb.xceb222c = 0
         LET l_xceb.xceb222d = 0
         LET l_xceb.xceb222e = 0
         LET l_xceb.xceb222f = 0
         LET l_xceb.xceb222g = 0
         LET l_xceb.xceb222h = 0
      END IF
      
      LET l_xceb.xceb301  = ''    #憑證編號
      LET l_xceb.xceb302  = ''    #憑證項次
      #自由核算项1～10
      LET l_xceb.xceb121 = l_pjec.pjec023   #自由核算項1
      LET l_xceb.xceb122 = l_pjec.pjec024   #自由核算項2
      LET l_xceb.xceb123 = l_pjec.pjec025   #自由核算項3
      LET l_xceb.xceb124 = l_pjec.pjec026   #自由核算項4
      LET l_xceb.xceb125 = l_pjec.pjec027   #自由核算項5
      LET l_xceb.xceb126 = l_pjec.pjec028   #自由核算項6
      LET l_xceb.xceb127 = l_pjec.pjec029   #自由核算項7
      LET l_xceb.xceb128 = l_pjec.pjec030   #自由核算項8
      LET l_xceb.xceb129 = l_pjec.pjec031   #自由核算項9
      LET l_xceb.xceb130 = l_pjec.pjec032   #自由核算項10
      
      CALL axct701_01_default_space_xceb(l_xceb.*) 
           RETURNING l_xceb.xceb005,l_xceb.xceb101,l_xceb.xceb102,l_xceb.xceb103,l_xceb.xceb110,
                     l_xceb.xceb111,l_xceb.xceb112,l_xceb.xceb113,l_xceb.xceb114,l_xceb.xceb115,
                     l_xceb.xceb116,l_xceb.xceb117,l_xceb.xceb118,l_xceb.xceb119,l_xceb.xceb120,
                     l_xceb.xceb107,l_xceb.xceb108,l_xceb.xceb109,l_xceb.xceb121,l_xceb.xceb122,
                     l_xceb.xceb123,l_xceb.xceb124,l_xceb.xceb125,l_xceb.xceb126,l_xceb.xceb127,
                     l_xceb.xceb128,l_xceb.xceb129,l_xceb.xceb130
      
      #如果金额和数量都为0的话，则不产生此笔单身数据
      IF l_xceb.xceb201= 0 AND l_xceb.xceb202 = 0 THEN
         CONTINUE FOREACH
      END IF
      INSERT INTO xceb_t(xcebent,xcebcomp,xcebld,xcebdocno,xcebseq,
                         xceb001,xceb002,xceb003,xceb004,xceb005,
                         xceb101,xceb102,xceb103,xceb110,xceb111,
                         xceb112,xceb113,xceb114,xceb115,xceb116,
                         xceb117,xceb118,xceb119,xceb120,xceb201,
                         xceb202,xceb202a,xceb202b,xceb202c,xceb202d,
                         xceb202e,xceb202f,xceb202g,xceb202h,
                         xceb212,xceb212a,xceb212b,xceb212c,xceb212d,
                         xceb212e,xceb212f,xceb212g,xceb212h,
                         xceb222,xceb222a,xceb222b,xceb222c,xceb222d,
                         xceb222e,xceb222f,xceb222g,xceb222h,
                         xceb301,xceb302,
                         xcebud001,xcebud002,xcebud003,xcebud004,xcebud005,
                         xcebud006,xcebud007,xcebud008,xcebud009,xcebud010,
                         xcebud011,xcebud012,xcebud013,xcebud014,xcebud015,
                         xcebud016,xcebud017,xcebud018,xcebud019,xcebud020,
                         xcebud021,xcebud022,xcebud023,xcebud024,xcebud025,
                         xcebud026,xcebud027,xcebud028,xcebud029,xcebud030,
                         xceb107,xceb108,xceb109,xceb121,xceb122,
                         xceb123,xceb124,xceb125,xceb126,xceb127,
                         xceb128,xceb129,xceb130,xceb131,xceb132)
      VALUES(l_xceb.xcebent,l_xceb.xcebcomp,l_xceb.xcebld,l_xceb.xcebdocno,l_xceb.xcebseq,
             l_xceb.xceb001,l_xceb.xceb002,l_xceb.xceb003,l_xceb.xceb004,l_xceb.xceb005,
             l_xceb.xceb101,l_xceb.xceb102,l_xceb.xceb103,l_xceb.xceb110,l_xceb.xceb111,
             l_xceb.xceb112,l_xceb.xceb113,l_xceb.xceb114,l_xceb.xceb115,l_xceb.xceb116,
             l_xceb.xceb117,l_xceb.xceb118,l_xceb.xceb119,l_xceb.xceb120,l_xceb.xceb201,
             l_xceb.xceb202,l_xceb.xceb202a,l_xceb.xceb202b,l_xceb.xceb202c,l_xceb.xceb202d,
             l_xceb.xceb202e,l_xceb.xceb202f,l_xceb.xceb202g,l_xceb.xceb202h,
             l_xceb.xceb212,l_xceb.xceb212a,l_xceb.xceb212b,l_xceb.xceb212c,l_xceb.xceb212d,
             l_xceb.xceb212e,l_xceb.xceb212f,l_xceb.xceb212g,l_xceb.xceb212h,
             l_xceb.xceb222,l_xceb.xceb222a,l_xceb.xceb222b,l_xceb.xceb222c,l_xceb.xceb222d,
             l_xceb.xceb222e,l_xceb.xceb222f,l_xceb.xceb222g,l_xceb.xceb222h,
             l_xceb.xceb301,l_xceb.xceb302,
             l_xceb.xcebud001,l_xceb.xcebud002,l_xceb.xcebud003,l_xceb.xcebud004,l_xceb.xcebud005,
             l_xceb.xcebud006,l_xceb.xcebud007,l_xceb.xcebud008,l_xceb.xcebud009,l_xceb.xcebud010,
             l_xceb.xcebud011,l_xceb.xcebud012,l_xceb.xcebud013,l_xceb.xcebud014,l_xceb.xcebud015,
             l_xceb.xcebud016,l_xceb.xcebud017,l_xceb.xcebud018,l_xceb.xcebud019,l_xceb.xcebud020,
             l_xceb.xcebud021,l_xceb.xcebud022,l_xceb.xcebud023,l_xceb.xcebud024,l_xceb.xcebud025,
             l_xceb.xcebud026,l_xceb.xcebud027,l_xceb.xcebud028,l_xceb.xcebud029,l_xceb.xcebud030,
             l_xceb.xceb107,l_xceb.xceb108,l_xceb.xceb109,l_xceb.xceb121,l_xceb.xceb122,
             l_xceb.xceb123,l_xceb.xceb124,l_xceb.xceb125,l_xceb.xceb126,l_xceb.xceb127,
             l_xceb.xceb128,l_xceb.xceb129,l_xceb.xceb130,l_xceb.xceb131,l_xceb.xceb132)
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "ins xceb_t"
         LET g_errparam.popup = TRUE
         CALL cl_err()
         LET g_success = 'N'
         EXIT FOREACH
      END IF
       
      
      
      #寫入xcex_t(專案分攤訊息)
      INITIALIZE l_xcec.* TO NULL
      SELECT MAX(xcecseq)+1 INTO l_xcec.xcecseq FROM xcec_t
       WHERE xcecent = g_enterprise
         AND xcecld = g_xcea_m.xceald
         AND xcecdocno = g_xcea_m.xceadocno
      IF cl_null(l_xcec.xcecseq) THEN LET l_xcec.xcecseq = 1 END IF 
      
      LET l_xcec.xcecent  = g_enterprise       #企業編號
      LET l_xcec.xcecld   = g_xcea_m.xceald    #帳套
      LET l_xcec.xceccomp = g_xcea_m.xceacomp  #法人組織
      LET l_xcec.xcecdocno= g_xcea_m.xceadocno #單據編號
      LET l_xcec.xcec001  = l_xceb.xceb001     #參考單據
      LET l_xcec.xcec002  = l_xceb.xceb002     #參考單據項次
      LET l_xcec.xcec003  = l_xceb.xceb003     #單據類型
      LET l_xcec.xcec004  = l_xceb.xceb004     #料件編號
      LET l_xcec.xcec005  = l_xceb.xceb005     #特性
      LET l_xcec.xcec101  = l_pjec.pjec010     #科目編號(取apjq400的分攤科目)  
      IF cl_null(l_xcec.xcec101) THEN LET l_xcec.xcec101 = ' ' END IF      
      LET l_xcec.xcec102  = l_xceb.xceb102     #摘要
      LET l_xcec.xcec103  = l_xceb.xceb103     #成本域
      LET l_xcec.xcec110  = l_xceb.xceb110     #原因碼
      LET l_xcec.xcec111  = l_xceb.xceb111     #交易對象
      LET l_xcec.xcec112  = l_xceb.xceb112     #客群
      LET l_xcec.xcec113  = l_xceb.xceb113     #區域
      LET l_xcec.xcec114  = l_xceb.xceb114     #成本中心
      LET l_xcec.xcec115  = l_xceb.xceb115     #經營類別
      LET l_xcec.xcec116  = l_xceb.xceb116     #渠道
      LET l_xcec.xcec117  = l_xceb.xceb117     #品類
      LET l_xcec.xcec118  = l_xceb.xceb118     #品牌
      LET l_xcec.xcec119  = l_xceb.xceb119     #項目號
      LET l_xcec.xcec120  = l_xceb.xceb120     #WBS
      LET l_xcec.xcec201  = l_xceb.xceb201     #數量
      LET l_xcec.xcec202  = l_xceb.xceb202     #成本金額(本位幣一)
      LET l_xcec.xcec202a = l_xceb.xceb202a    #成本-材料(本位幣一)
      LET l_xcec.xcec202b = l_xceb.xceb202b    #成本-人工(本位幣一)
      LET l_xcec.xcec202c = l_xceb.xceb202c    #成本-加工(本位幣一)
      LET l_xcec.xcec202d = l_xceb.xceb202d    #成本-制費一(本位幣一)
      LET l_xcec.xcec202e = l_xceb.xceb202e    #成本-制費二(本位幣一)
      LET l_xcec.xcec202f = l_xceb.xceb202f    #成本-制費三(本位幣一)
      LET l_xcec.xcec202g = l_xceb.xceb202g    #成本-制費四(本位幣一)
      LET l_xcec.xcec202h = l_xceb.xceb202h    #成本-制費五(本位幣一)
      LET l_xcec.xcec212  = l_xceb.xceb212     #成本-金額(本位幣二)
      LET l_xcec.xcec212a = l_xceb.xceb212a
      LET l_xcec.xcec212b = l_xceb.xceb212b
      LET l_xcec.xcec212c = l_xceb.xceb212c
      LET l_xcec.xcec212d = l_xceb.xceb212d
      LET l_xcec.xcec212e = l_xceb.xceb212e
      LET l_xcec.xcec212f = l_xceb.xceb212f
      LET l_xcec.xcec212g = l_xceb.xceb212g
      LET l_xcec.xcec212h = l_xceb.xceb212h
      LET l_xcec.xcec222  = l_xceb.xceb222     #成本-金額(本位幣三)
      LET l_xcec.xcec222a = l_xceb.xceb222a
      LET l_xcec.xcec222b = l_xceb.xceb222b
      LET l_xcec.xcec222c = l_xceb.xceb222c
      LET l_xcec.xcec222d = l_xceb.xceb222d
      LET l_xcec.xcec222e = l_xceb.xceb222e
      LET l_xcec.xcec222f = l_xceb.xceb222f
      LET l_xcec.xcec222g = l_xceb.xceb222g
      LET l_xcec.xcec222h = l_xceb.xceb222h
      LET l_xcec.xcec301  = l_xceb.xceb301     #憑證編號
      LET l_xcec.xcec302  = l_xceb.xceb302     #憑證項次
      LET l_xcec.xcec107  = l_xceb.xceb107     #人員
      LET l_xcec.xcec108  = l_xceb.xceb108     #部門
      LET l_xcec.xcec109  = l_xceb.xceb109     #帳款對象
      LET l_xcec.xcec121  = l_xceb.xceb121     #自由核算項1
      LET l_xcec.xcec122  = l_xceb.xceb122     #自由核算項2
      LET l_xcec.xcec123  = l_xceb.xceb123     #自由核算項3
      LET l_xcec.xcec124  = l_xceb.xceb124     #自由核算項4
      LET l_xcec.xcec125  = l_xceb.xceb125     #自由核算項5
      LET l_xcec.xcec126  = l_xceb.xceb126     #自由核算項6
      LET l_xcec.xcec127  = l_xceb.xceb127     #自由核算項7
      LET l_xcec.xcec128  = l_xceb.xceb128     #自由核算項8
      LET l_xcec.xcec129  = l_xceb.xceb129     #自由核算項9
      LET l_xcec.xcec130  = l_xceb.xceb130     #自由核算項10

      CALL axct701_01_default_space_xcec(l_xcec.*)
           RETURNING l_xcec.xcec005,l_xcec.xcec101,l_xcec.xcec102,l_xcec.xcec103,l_xcec.xcec110,
                     l_xcec.xcec111,l_xcec.xcec112,l_xcec.xcec113,l_xcec.xcec114,l_xcec.xcec115,
                     l_xcec.xcec116,l_xcec.xcec117,l_xcec.xcec118,l_xcec.xcec119,l_xcec.xcec120,
                     l_xcec.xcec107,l_xcec.xcec108,l_xcec.xcec109,l_xcec.xcec121,l_xcec.xcec122,
                     l_xcec.xcec123,l_xcec.xcec124,l_xcec.xcec125,l_xcec.xcec126,l_xcec.xcec127,
                     l_xcec.xcec128,l_xcec.xcec129,l_xcec.xcec130
      
      #如果金额和数量都为0的话，则不产生此笔单身数据
      IF l_xcec.xcec201= 0 AND l_xcec.xcec202 = 0 THEN
         CONTINUE FOREACH
      END IF
      INSERT INTO xcec_t(xcecent,xceccomp,xcecld,xcecdocno,xcecseq,
                         xcec001,xcec002,xcec003,xcec004,xcec005,
                         xcec101,xcec102,xcec103,xcec110,xcec111,
                         xcec112,xcec113,xcec114,xcec115,xcec116,
                         xcec117,xcec118,xcec119,xcec120,xcec201,
                         xcec202,xcec202a,xcec202b,xcec202c,xcec202d,
                         xcec202e,xcec202f,xcec202g,xcec202h,
                         xcec212,xcec212a,xcec212b,xcec212c,xcec212d,
                         xcec212e,xcec212f,xcec212g,xcec212h,
                         xcec222,xcec222a,xcec222b,xcec222c,xcec222d,
                         xcec222e,xcec222f,xcec222g,xcec222h,
                         xcec301,xcec302,
                         xcecud001,xcecud002,xcecud003,xcecud004,xcecud005,
                         xcecud006,xcecud007,xcecud008,xcecud009,xcecud010,
                         xcecud011,xcecud012,xcecud013,xcecud014,xcecud015,
                         xcecud016,xcecud017,xcecud018,xcecud019,xcecud020,
                         xcecud021,xcecud022,xcecud023,xcecud024,xcecud025,
                         xcecud026,xcecud027,xcecud028,xcecud029,xcecud030,
                         xcec107,xcec108,xcec109,xcec121,xcec122,
                         xcec123,xcec124,xcec125,xcec126,xcec127,
                         xcec128,xcec129,xcec130)
      VALUES(l_xcec.xcecent,l_xcec.xceccomp,l_xcec.xcecld,l_xcec.xcecdocno,l_xcec.xcecseq,
             l_xcec.xcec001,l_xcec.xcec002,l_xcec.xcec003,l_xcec.xcec004,l_xcec.xcec005,
             l_xcec.xcec101,l_xcec.xcec102,l_xcec.xcec103,l_xcec.xcec110,l_xcec.xcec111,
             l_xcec.xcec112,l_xcec.xcec113,l_xcec.xcec114,l_xcec.xcec115,l_xcec.xcec116,
             l_xcec.xcec117,l_xcec.xcec118,l_xcec.xcec119,l_xcec.xcec120,l_xcec.xcec201,
             l_xcec.xcec202,l_xcec.xcec202a,l_xcec.xcec202b,l_xcec.xcec202c,l_xcec.xcec202d,
             l_xcec.xcec202e,l_xcec.xcec202f,l_xcec.xcec202g,l_xcec.xcec202h,
             l_xcec.xcec212,l_xcec.xcec212a,l_xcec.xcec212b,l_xcec.xcec212c,l_xcec.xcec212d,
             l_xcec.xcec212e,l_xcec.xcec212f,l_xcec.xcec212g,l_xcec.xcec212h,
             l_xcec.xcec222,l_xcec.xcec222a,l_xcec.xcec222b,l_xcec.xcec222c,l_xcec.xcec222d,
             l_xcec.xcec222e,l_xcec.xcec222f,l_xcec.xcec222g,l_xcec.xcec222h,
             l_xcec.xcec301,l_xcec.xcec302,
             l_xcec.xcecud001,l_xcec.xcecud002,l_xcec.xcecud003,l_xcec.xcecud004,l_xcec.xcecud005,
             l_xcec.xcecud006,l_xcec.xcecud007,l_xcec.xcecud008,l_xcec.xcecud009,l_xcec.xcecud010,
             l_xcec.xcecud011,l_xcec.xcecud012,l_xcec.xcecud013,l_xcec.xcecud014,l_xcec.xcecud015,
             l_xcec.xcecud016,l_xcec.xcecud017,l_xcec.xcecud018,l_xcec.xcecud019,l_xcec.xcecud020,
             l_xcec.xcecud021,l_xcec.xcecud022,l_xcec.xcecud023,l_xcec.xcecud024,l_xcec.xcecud025,
             l_xcec.xcecud026,l_xcec.xcecud027,l_xcec.xcecud028,l_xcec.xcecud029,l_xcec.xcecud030,
             l_xcec.xcec107,l_xcec.xcec108,l_xcec.xcec109,l_xcec.xcec121,l_xcec.xcec122,
             l_xcec.xcec123,l_xcec.xcec124,l_xcec.xcec125,l_xcec.xcec126,l_xcec.xcec127,
             l_xcec.xcec128,l_xcec.xcec129,l_xcec.xcec130)
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "ins xcec"
         LET g_errparam.popup = TRUE
         CALL cl_err()
         LET g_success = 'N'
         EXIT FOREACH
      END IF
   
   END FOREACH
   
   RETURN g_success
   
END FUNCTION

################################################################################
# Descriptions...: 依部門費用類別抓取費用科目
# Memo...........:
# Usage..........: CALL axct701_01_get_glab005(p_ooeg001,p_glabld,p_glab002,p_glab003)
#                  RETURNING r_glab005
# Input parameter: p_ooeg001      部門
#                : p_glabld       帳套
#                : p_glab002      分類瑪
#                : p_glab003      理由碼
# Return code....: r_glab005      費用科目
# Date & Author..: #160816-00041#2 160824 By 02040
# Modify.........:
################################################################################
PRIVATE FUNCTION axct701_01_get_glab005(p_ooeg001,p_glabld,p_glab002,p_glab003)
DEFINE p_ooeg001 LIKE ooeg_t.ooeg001
DEFINE p_glabld  LIKE glab_t.glabld
DEFINE p_glab002 LIKE glab_t.glab002
DEFINE p_glab003 LIKE glab_t.glab003
DEFINE l_glab005 LIKE glab_t.glab005
DEFINE l_glab006 LIKE glab_t.glab006
DEFINE l_glab007 LIKE glab_t.glab007
DEFINE l_glab008 LIKE glab_t.glab008
DEFINE l_ooeg008 LIKE ooeg_t.ooeg008
DEFINE r_glab005 LIKE glab_t.glab005

  LET r_glab005 = ''
  IF cl_null(p_ooeg001) OR cl_null(p_glabld) OR cl_null(p_glab002) OR cl_null(p_glab003) THEN
     RETURN r_glab005
  END IF

  LET l_glab005 = ''
  LET l_glab006 = ''
  LET l_glab007 = ''
  LET l_glab008 = ''
  
  SELECT glab005,glab006,glab007,glab008
    INTO l_glab005,l_glab006,l_glab007,l_glab008
    FROM glab_t
   WHERE glabent = g_enterprise
     AND glabld = p_glabld
     AND glab001 = '11'
     AND glab002 = p_glab002
     AND glab003 = p_glab003
     
  SELECT ooeg008 INTO l_ooeg008
    FROM ooeg_t
   WHERE ooegent = g_enterprise
     AND ooeg001 = p_ooeg001
     AND ooegstus = 'Y'
     
  CASE l_ooeg008
    WHEN '1'  
      LET r_glab005 = l_glab005
    WHEN '2'
      LET r_glab005 = l_glab006
    WHEN '3'
      LET r_glab005 = l_glab007
    WHEN '4'
      LET r_glab005 = l_glab008
  END CASE
  
  RETURN r_glab005

END FUNCTION

################################################################################
# Descriptions...: 描述说明
# Memo...........:
# Usage..........: CALL s_aooi150_ins (传入参数)
#                  RETURNING 回传参数
# Input parameter: 传入参数变量1   传入参数变量说明1
#                : 传入参数变量2   传入参数变量说明2
# Return code....: 回传参数变量1   回传参数变量说明1
#                : 回传参数变量2   回传参数变量说明2
# Date & Author..: 日期 By 作者
# Modify.........:
################################################################################
PRIVATE FUNCTION axct701_01_ins_bak()
#161215-00040#1 Mark ---(S)---
##161109-00085#18-s mod
##DEFINE l_xcea          RECORD LIKE xcea_t.*   #161109-00085#18-s mark
#DEFINE l_xcea          RECORD  #工單發料成本憑證單頭檔
#       xceaent LIKE xcea_t.xceaent, #企業編號
#       xceacomp LIKE xcea_t.xceacomp, #法人組織
#       xceald LIKE xcea_t.xceald, #帳套
#       xceadocno LIKE xcea_t.xceadocno, #單據編號
#       xcea001 LIKE xcea_t.xcea001, #單據日期
#       xcea002 LIKE xcea_t.xcea002, #成本憑證類型
#       xcea003 LIKE xcea_t.xcea003, #成本計算類型
#       xcea004 LIKE xcea_t.xcea004, #年度
#       xcea005 LIKE xcea_t.xcea005, #期別
#       xcea006 LIKE xcea_t.xcea006, #帳務人員
#       xcea007 LIKE xcea_t.xcea007, #帳務部門
#       xcea101 LIKE xcea_t.xcea101, #憑證編號
#       xcea102 LIKE xcea_t.xcea102, #憑證日期
#       xceaownid LIKE xcea_t.xceaownid, #資料所有者
#       xceaowndp LIKE xcea_t.xceaowndp, #資料所屬部門
#       xceacrtid LIKE xcea_t.xceacrtid, #資料建立者
#       xceacrtdp LIKE xcea_t.xceacrtdp, #資料建立部門
#       xceacrtdt LIKE xcea_t.xceacrtdt, #資料創建日
#       xceamodid LIKE xcea_t.xceamodid, #資料修改者
#       xceamoddt LIKE xcea_t.xceamoddt, #最近修改日
#       xceacnfid LIKE xcea_t.xceacnfid, #資料確認者
#       xceacnfdt LIKE xcea_t.xceacnfdt, #資料確認日
#       xceapstid LIKE xcea_t.xceapstid, #資料過帳者
#       xceapstdt LIKE xcea_t.xceapstdt, #資料過帳日
#       xceastus LIKE xcea_t.xceastus, #狀態碼
#       #161109-00085#63 --s add
#       xceaud001 LIKE xcea_t.xceaud001, #自定義欄位(文字)001
#       xceaud002 LIKE xcea_t.xceaud002, #自定義欄位(文字)002
#       xceaud003 LIKE xcea_t.xceaud003, #自定義欄位(文字)003
#       xceaud004 LIKE xcea_t.xceaud004, #自定義欄位(文字)004
#       xceaud005 LIKE xcea_t.xceaud005, #自定義欄位(文字)005
#       xceaud006 LIKE xcea_t.xceaud006, #自定義欄位(文字)006
#       xceaud007 LIKE xcea_t.xceaud007, #自定義欄位(文字)007
#       xceaud008 LIKE xcea_t.xceaud008, #自定義欄位(文字)008
#       xceaud009 LIKE xcea_t.xceaud009, #自定義欄位(文字)009
#       xceaud010 LIKE xcea_t.xceaud010, #自定義欄位(文字)010
#       xceaud011 LIKE xcea_t.xceaud011, #自定義欄位(數字)011
#       xceaud012 LIKE xcea_t.xceaud012, #自定義欄位(數字)012
#       xceaud013 LIKE xcea_t.xceaud013, #自定義欄位(數字)013
#       xceaud014 LIKE xcea_t.xceaud014, #自定義欄位(數字)014
#       xceaud015 LIKE xcea_t.xceaud015, #自定義欄位(數字)015
#       xceaud016 LIKE xcea_t.xceaud016, #自定義欄位(數字)016
#       xceaud017 LIKE xcea_t.xceaud017, #自定義欄位(數字)017
#       xceaud018 LIKE xcea_t.xceaud018, #自定義欄位(數字)018
#       xceaud019 LIKE xcea_t.xceaud019, #自定義欄位(數字)019
#       xceaud020 LIKE xcea_t.xceaud020, #自定義欄位(數字)020
#       xceaud021 LIKE xcea_t.xceaud021, #自定義欄位(日期時間)021
#       xceaud022 LIKE xcea_t.xceaud022, #自定義欄位(日期時間)022
#       xceaud023 LIKE xcea_t.xceaud023, #自定義欄位(日期時間)023
#       xceaud024 LIKE xcea_t.xceaud024, #自定義欄位(日期時間)024
#       xceaud025 LIKE xcea_t.xceaud025, #自定義欄位(日期時間)025
#       xceaud026 LIKE xcea_t.xceaud026, #自定義欄位(日期時間)026
#       xceaud027 LIKE xcea_t.xceaud027, #自定義欄位(日期時間)027
#       xceaud028 LIKE xcea_t.xceaud028, #自定義欄位(日期時間)028
#       xceaud029 LIKE xcea_t.xceaud029, #自定義欄位(日期時間)029
#       xceaud030 LIKE xcea_t.xceaud030, #自定義欄位(日期時間)030
#       #161109-00085#63 --e add
#       xceasite LIKE xcea_t.xceasite  #營運據點
#          END RECORD
##161109-00085#18-e mod
#
##161109-00085#18-s mod
##DEFINE l_xceb          RECORD LIKE xceb_t.*   #161109-00085#18-s mark
#DEFINE l_xceb          RECORD  #成本憑證第一單身檔
#       xcebent LIKE xceb_t.xcebent, #企業編號               
#       xcebcomp LIKE xceb_t.xcebcomp, #法人組織
#       xcebld LIKE xceb_t.xcebld, #帳套
#       xcebdocno LIKE xceb_t.xcebdocno, #單據編號
#       xcebseq LIKE xceb_t.xcebseq, #項次
#       xceb001 LIKE xceb_t.xceb001, #參考單據編號
#       xceb002 LIKE xceb_t.xceb002, #參考單據項次
#       xceb003 LIKE xceb_t.xceb003, #單據類型
#       xceb004 LIKE xceb_t.xceb004, #料件編號
#       xceb005 LIKE xceb_t.xceb005, #特性
#       xceb101 LIKE xceb_t.xceb101, #科目編號
#       xceb102 LIKE xceb_t.xceb102, #摘要
#       xceb103 LIKE xceb_t.xceb103, #成本域
#       xceb110 LIKE xceb_t.xceb110, #原因碼
#       xceb111 LIKE xceb_t.xceb111, #收付款客商
#       xceb112 LIKE xceb_t.xceb112, #客群
#       xceb113 LIKE xceb_t.xceb113, #區域
#       xceb114 LIKE xceb_t.xceb114, #成本中心
#       xceb115 LIKE xceb_t.xceb115, #經營類別
#       xceb116 LIKE xceb_t.xceb116, #通路
#       xceb117 LIKE xceb_t.xceb117, #品類
#       xceb118 LIKE xceb_t.xceb118, #品牌
#       xceb119 LIKE xceb_t.xceb119, #專案號
#       xceb120 LIKE xceb_t.xceb120, #WBS
#       xceb201 LIKE xceb_t.xceb201, #數量
#       xceb202 LIKE xceb_t.xceb202, #成本金額(本位幣一)
#       xceb202a LIKE xceb_t.xceb202a, #成本-材料(本位幣一)
#       xceb202b LIKE xceb_t.xceb202b, #成本-人工(本位幣一)
#       xceb202c LIKE xceb_t.xceb202c, #成本-加工(本位幣一)
#       xceb202d LIKE xceb_t.xceb202d, #成本-制費一(本位幣一)
#       xceb202e LIKE xceb_t.xceb202e, #成本-制費二(本位幣一)
#       xceb202f LIKE xceb_t.xceb202f, #成本-制費三(本位幣一)
#       xceb202g LIKE xceb_t.xceb202g, #成本-制費四(本位幣一)
#       xceb202h LIKE xceb_t.xceb202h, #成本-制費五(本位幣一)
#       xceb212 LIKE xceb_t.xceb212, #成本金額(本位幣二)
#       xceb212a LIKE xceb_t.xceb212a, #成本-材料(本位幣二)
#       xceb212b LIKE xceb_t.xceb212b, #成本-人工(本位幣二)
#       xceb212c LIKE xceb_t.xceb212c, #成本-加工(本位幣二)
#       xceb212d LIKE xceb_t.xceb212d, #成本-制費一(本位幣二)
#       xceb212e LIKE xceb_t.xceb212e, #成本-制費二(本位幣二)
#       xceb212f LIKE xceb_t.xceb212f, #成本-制費三(本位幣二)
#       xceb212g LIKE xceb_t.xceb212g, #成本-制費四(本位幣二)
#       xceb212h LIKE xceb_t.xceb212h, #成本-制費五(本位幣二)
#       xceb222 LIKE xceb_t.xceb222, #成本金額(本位幣三)
#       xceb222a LIKE xceb_t.xceb222a, #成本-材料(本位幣三)
#       xceb222b LIKE xceb_t.xceb222b, #成本-人工(本位幣三)
#       xceb222c LIKE xceb_t.xceb222c, #成本-加工(本位幣三)
#       xceb222d LIKE xceb_t.xceb222d, #成本-制費一(本位幣三)
#       xceb222e LIKE xceb_t.xceb222e, #成本-制費二(本位幣三)
#       xceb222f LIKE xceb_t.xceb222f, #成本-制費三(本位幣三)
#       xceb222g LIKE xceb_t.xceb222g, #成本-制費四(本位幣三)
#       xceb222h LIKE xceb_t.xceb222h, #成本-制費五(本位幣三)
#       xceb301 LIKE xceb_t.xceb301, #憑證編號
#       xceb302 LIKE xceb_t.xceb302, #憑證項次
#       #161109-00085#63 --s add  
#       xcebud001 LIKE xceb_t.xcebud001, #自定義欄位(文字)001
#       xcebud002 LIKE xceb_t.xcebud002, #自定義欄位(文字)002
#       xcebud003 LIKE xceb_t.xcebud003, #自定義欄位(文字)003
#       xcebud004 LIKE xceb_t.xcebud004, #自定義欄位(文字)004
#       xcebud005 LIKE xceb_t.xcebud005, #自定義欄位(文字)005
#       xcebud006 LIKE xceb_t.xcebud006, #自定義欄位(文字)006
#       xcebud007 LIKE xceb_t.xcebud007, #自定義欄位(文字)007
#       xcebud008 LIKE xceb_t.xcebud008, #自定義欄位(文字)008
#       xcebud009 LIKE xceb_t.xcebud009, #自定義欄位(文字)009
#       xcebud010 LIKE xceb_t.xcebud010, #自定義欄位(文字)010
#       xcebud011 LIKE xceb_t.xcebud011, #自定義欄位(數字)011
#       xcebud012 LIKE xceb_t.xcebud012, #自定義欄位(數字)012
#       xcebud013 LIKE xceb_t.xcebud013, #自定義欄位(數字)013
#       xcebud014 LIKE xceb_t.xcebud014, #自定義欄位(數字)014
#       xcebud015 LIKE xceb_t.xcebud015, #自定義欄位(數字)015
#       xcebud016 LIKE xceb_t.xcebud016, #自定義欄位(數字)016
#       xcebud017 LIKE xceb_t.xcebud017, #自定義欄位(數字)017
#       xcebud018 LIKE xceb_t.xcebud018, #自定義欄位(數字)018
#       xcebud019 LIKE xceb_t.xcebud019, #自定義欄位(數字)019
#       xcebud020 LIKE xceb_t.xcebud020, #自定義欄位(數字)020
#       xcebud021 LIKE xceb_t.xcebud021, #自定義欄位(日期時間)021
#       xcebud022 LIKE xceb_t.xcebud022, #自定義欄位(日期時間)022
#       xcebud023 LIKE xceb_t.xcebud023, #自定義欄位(日期時間)023
#       xcebud024 LIKE xceb_t.xcebud024, #自定義欄位(日期時間)024
#       xcebud025 LIKE xceb_t.xcebud025, #自定義欄位(日期時間)025
#       xcebud026 LIKE xceb_t.xcebud026, #自定義欄位(日期時間)026
#       xcebud027 LIKE xceb_t.xcebud027, #自定義欄位(日期時間)027
#       xcebud028 LIKE xceb_t.xcebud028, #自定義欄位(日期時間)028
#       xcebud029 LIKE xceb_t.xcebud029, #自定義欄位(日期時間)029
#       xcebud030 LIKE xceb_t.xcebud030, #自定義欄位(日期時間)030
#       #161109-00085#63 --e add
#       xceb107 LIKE xceb_t.xceb107, #人員              
#       xceb108 LIKE xceb_t.xceb108, #部門
#       xceb109 LIKE xceb_t.xceb109, #帳款對象
#       xceb121 LIKE xceb_t.xceb121, #自由核算項1
#       xceb122 LIKE xceb_t.xceb122, #自由核算項2
#       xceb123 LIKE xceb_t.xceb123, #自由核算項3
#       xceb124 LIKE xceb_t.xceb124, #自由核算項4
#       xceb125 LIKE xceb_t.xceb125, #自由核算項5
#       xceb126 LIKE xceb_t.xceb126, #自由核算項6
#       xceb127 LIKE xceb_t.xceb127, #自由核算項7
#       xceb128 LIKE xceb_t.xceb128, #自由核算項8
#       xceb129 LIKE xceb_t.xceb129, #自由核算項9
#       xceb130 LIKE xceb_t.xceb130, #自由核算項10
#       xceb131 LIKE xceb_t.xceb131, #單據類型(for 流通)
#       xceb132 LIKE xceb_t.xceb132  #單據日期(for 流通)
#          END RECORD
##161109-00085#18-e mod
##161109-00085#18-s mod
##DEFINE l_xcec          RECORD LIKE xcec_t.*   #161109-00085#18-s mark
#DEFINE l_xcec          RECORD  #成本憑證第二單身檔
#       xcecent LIKE xcec_t.xcecent, #企業編號                   
#       xceccomp LIKE xcec_t.xceccomp, #法人組織
#       xcecld LIKE xcec_t.xcecld, #帳套
#       xcecdocno LIKE xcec_t.xcecdocno, #單據編號
#       xcecseq LIKE xcec_t.xcecseq, #項次
#       xcec001 LIKE xcec_t.xcec001, #參考單據
#       xcec002 LIKE xcec_t.xcec002, #參考單據項次
#       xcec003 LIKE xcec_t.xcec003, #單據類型
#       xcec004 LIKE xcec_t.xcec004, #料件編號
#       xcec005 LIKE xcec_t.xcec005, #特性
#       xcec101 LIKE xcec_t.xcec101, #科目編號
#       xcec102 LIKE xcec_t.xcec102, #摘要
#       xcec103 LIKE xcec_t.xcec103, #成本域
#       xcec110 LIKE xcec_t.xcec110, #原因碼
#       xcec111 LIKE xcec_t.xcec111, #收付款客商
#       xcec112 LIKE xcec_t.xcec112, #客群
#       xcec113 LIKE xcec_t.xcec113, #區域
#       xcec114 LIKE xcec_t.xcec114, #成本中心
#       xcec115 LIKE xcec_t.xcec115, #經營類別
#       xcec116 LIKE xcec_t.xcec116, #通路
#       xcec117 LIKE xcec_t.xcec117, #品類
#       xcec118 LIKE xcec_t.xcec118, #品牌
#       xcec119 LIKE xcec_t.xcec119, #專案號
#       xcec120 LIKE xcec_t.xcec120, #WBS
#       xcec201 LIKE xcec_t.xcec201, #數量
#       xcec202 LIKE xcec_t.xcec202, #成本金額(本位幣一)
#       xcec202a LIKE xcec_t.xcec202a, #成本-材料(本位幣一)
#       xcec202b LIKE xcec_t.xcec202b, #成本-人工(本位幣一)
#       xcec202c LIKE xcec_t.xcec202c, #成本-加工(本位幣一)
#       xcec202d LIKE xcec_t.xcec202d, #成本-制費一(本位幣一)
#       xcec202e LIKE xcec_t.xcec202e, #成本-制費二(本位幣一)
#       xcec202f LIKE xcec_t.xcec202f, #成本-制費三(本位幣一)
#       xcec202g LIKE xcec_t.xcec202g, #成本-制費四(本位幣一)
#       xcec202h LIKE xcec_t.xcec202h, #成本-制費五(本位幣一)
#       xcec212 LIKE xcec_t.xcec212, #成本-金額(本位幣二)
#       xcec212a LIKE xcec_t.xcec212a, #成本-材料(本位幣二)
#       xcec212b LIKE xcec_t.xcec212b, #成本-人工(本位幣二)
#       xcec212c LIKE xcec_t.xcec212c, #成本-加工(本位幣二)
#       xcec212d LIKE xcec_t.xcec212d, #成本-制費一(本位幣二)
#       xcec212e LIKE xcec_t.xcec212e, #成本-制費二(本位幣二)
#       xcec212f LIKE xcec_t.xcec212f, #成本-制費三(本位幣二)
#       xcec212g LIKE xcec_t.xcec212g, #成本-制費四(本位幣二)
#       xcec212h LIKE xcec_t.xcec212h, #成本-制費五(本位幣二)
#       xcec222 LIKE xcec_t.xcec222, #成本-金額(本位幣三)
#       xcec222a LIKE xcec_t.xcec222a, #成本-材料(本位幣三)
#       xcec222b LIKE xcec_t.xcec222b, #成本-人工(本位幣三)
#       xcec222c LIKE xcec_t.xcec222c, #成本-加工(本位幣三)
#       xcec222d LIKE xcec_t.xcec222d, #成本-制費一(本位幣三)
#       xcec222e LIKE xcec_t.xcec222e, #成本-制費二(本位幣三)
#       xcec222f LIKE xcec_t.xcec222f, #成本-制費三(本位幣三)
#       xcec222g LIKE xcec_t.xcec222g, #成本-制費四(本位幣三)
#       xcec222h LIKE xcec_t.xcec222h, #成本-制費五(本位幣三)
#       xcec301 LIKE xcec_t.xcec301, #憑證編號
#       xcec302 LIKE xcec_t.xcec302, #憑證項次
#       #161109-00085#63 --s add 
#       xcecud001 LIKE xcec_t.xcecud001, #自定義欄位(文字)001
#       xcecud002 LIKE xcec_t.xcecud002, #自定義欄位(文字)002
#       xcecud003 LIKE xcec_t.xcecud003, #自定義欄位(文字)003
#       xcecud004 LIKE xcec_t.xcecud004, #自定義欄位(文字)004
#       xcecud005 LIKE xcec_t.xcecud005, #自定義欄位(文字)005
#       xcecud006 LIKE xcec_t.xcecud006, #自定義欄位(文字)006
#       xcecud007 LIKE xcec_t.xcecud007, #自定義欄位(文字)007
#       xcecud008 LIKE xcec_t.xcecud008, #自定義欄位(文字)008
#       xcecud009 LIKE xcec_t.xcecud009, #自定義欄位(文字)009
#       xcecud010 LIKE xcec_t.xcecud010, #自定義欄位(文字)010
#       xcecud011 LIKE xcec_t.xcecud011, #自定義欄位(數字)011
#       xcecud012 LIKE xcec_t.xcecud012, #自定義欄位(數字)012
#       xcecud013 LIKE xcec_t.xcecud013, #自定義欄位(數字)013
#       xcecud014 LIKE xcec_t.xcecud014, #自定義欄位(數字)014
#       xcecud015 LIKE xcec_t.xcecud015, #自定義欄位(數字)015
#       xcecud016 LIKE xcec_t.xcecud016, #自定義欄位(數字)016
#       xcecud017 LIKE xcec_t.xcecud017, #自定義欄位(數字)017
#       xcecud018 LIKE xcec_t.xcecud018, #自定義欄位(數字)018
#       xcecud019 LIKE xcec_t.xcecud019, #自定義欄位(數字)019
#       xcecud020 LIKE xcec_t.xcecud020, #自定義欄位(數字)020
#       xcecud021 LIKE xcec_t.xcecud021, #自定義欄位(日期時間)021
#       xcecud022 LIKE xcec_t.xcecud022, #自定義欄位(日期時間)022
#       xcecud023 LIKE xcec_t.xcecud023, #自定義欄位(日期時間)023
#       xcecud024 LIKE xcec_t.xcecud024, #自定義欄位(日期時間)024
#       xcecud025 LIKE xcec_t.xcecud025, #自定義欄位(日期時間)025
#       xcecud026 LIKE xcec_t.xcecud026, #自定義欄位(日期時間)026
#       xcecud027 LIKE xcec_t.xcecud027, #自定義欄位(日期時間)027
#       xcecud028 LIKE xcec_t.xcecud028, #自定義欄位(日期時間)028
#       xcecud029 LIKE xcec_t.xcecud029, #自定義欄位(日期時間)029
#       xcecud030 LIKE xcec_t.xcecud030, #自定義欄位(日期時間)030
#       #161109-00085#63 --e add
#       xcec107 LIKE xcec_t.xcec107, #人員
#       xcec108 LIKE xcec_t.xcec108, #部門
#       xcec109 LIKE xcec_t.xcec109, #帳款對象
#       xcec121 LIKE xcec_t.xcec121, #自由核算項1
#       xcec122 LIKE xcec_t.xcec122, #自由核算項2
#       xcec123 LIKE xcec_t.xcec123, #自由核算項3
#       xcec124 LIKE xcec_t.xcec124, #自由核算項4
#       xcec125 LIKE xcec_t.xcec125, #自由核算項5
#       xcec126 LIKE xcec_t.xcec126, #自由核算項6
#       xcec127 LIKE xcec_t.xcec127, #自由核算項7
#       xcec128 LIKE xcec_t.xcec128, #自由核算項8
#       xcec129 LIKE xcec_t.xcec129, #自由核算項9
#       xcec130 LIKE xcec_t.xcec130  #自由核算項10
#               END RECORD
##161109-00085#18-e mod  
##161109-00085#18-s mod
##DEFINE l_xccd          RECORD LIKE xccd_t.*   #161109-00085#18-s mark
#DEFINE l_xccd          RECORD  #在製主件成本期異動統計檔
#       xccdent LIKE xccd_t.xccdent, #企業編號
#       xccdcomp LIKE xccd_t.xccdcomp, #法人組織
#       xccdld LIKE xccd_t.xccdld, #帳套
#       xccd001 LIKE xccd_t.xccd001, #帳套本位幣順序
#       xccd002 LIKE xccd_t.xccd002, #成本域
#       xccd003 LIKE xccd_t.xccd003, #成本計算類型
#       xccd004 LIKE xccd_t.xccd004, #年度
#       xccd005 LIKE xccd_t.xccd005, #期別
#       xccd006 LIKE xccd_t.xccd006, #工單編號
#       xccd007 LIKE xccd_t.xccd007, #主件料號
#       xccd008 LIKE xccd_t.xccd008, #產品特徵
#       xccd009 LIKE xccd_t.xccd009, #批號
#       xccd010 LIKE xccd_t.xccd010, #專案號
#       xccd011 LIKE xccd_t.xccd011, #核算幣別
#       xccd012 LIKE xccd_t.xccd012, #重複性成產否
#       xccd013 LIKE xccd_t.xccd013, #成產計劃號
#       xccd014 LIKE xccd_t.xccd014, #BOM特性
#       xccd101 LIKE xccd_t.xccd101, #上期結存數量
#       xccd102 LIKE xccd_t.xccd102, #上期結存金額
#       xccd102a LIKE xccd_t.xccd102a, #上期結存金額-材料
#       xccd102b LIKE xccd_t.xccd102b, #上期結存金額-人工
#       xccd102c LIKE xccd_t.xccd102c, #上期結存金額-加工
#       xccd102d LIKE xccd_t.xccd102d, #上期結存金額-制費一
#       xccd102e LIKE xccd_t.xccd102e, #上期結存金額-制費二
#       xccd102f LIKE xccd_t.xccd102f, #上期結存金額-制費三
#       xccd102g LIKE xccd_t.xccd102g, #上期結存金額-制費四
#       xccd102h LIKE xccd_t.xccd102h, #上期結存金額-制費五
#       xccd200 LIKE xccd_t.xccd200, #本期投入工時
#       xccd201 LIKE xccd_t.xccd201, #本期投入數量
#       xccd202 LIKE xccd_t.xccd202, #本期本階投入金額
#       xccd202a LIKE xccd_t.xccd202a, #本期本階投入金額-材料
#       xccd202b LIKE xccd_t.xccd202b, #本期本階投入金額-人工
#       xccd202c LIKE xccd_t.xccd202c, #本期本階投入金額-加工
#       xccd202d LIKE xccd_t.xccd202d, #本期本階投入金額-制費一
#       xccd202e LIKE xccd_t.xccd202e, #本期本階投入金額-制費二
#       xccd202f LIKE xccd_t.xccd202f, #本期本階投入金額-制費三
#       xccd202g LIKE xccd_t.xccd202g, #本期本階投入金額-制費四
#       xccd202h LIKE xccd_t.xccd202h, #本期本階投入金額-制費五
#       xccd204 LIKE xccd_t.xccd204, #本期下階投入金額
#       xccd204a LIKE xccd_t.xccd204a, #本期下階投入金額-材料
#       xccd204b LIKE xccd_t.xccd204b, #本期下階投入金額-人工
#       xccd204c LIKE xccd_t.xccd204c, #本期下階投入金額-加工
#       xccd204d LIKE xccd_t.xccd204d, #本期下階投入金額-制費一
#       xccd204e LIKE xccd_t.xccd204e, #本期下階投入金額-制費二
#       xccd204f LIKE xccd_t.xccd204f, #本期下階投入金額-制費三
#       xccd204g LIKE xccd_t.xccd204g, #本期下階投入金額-制費四
#       xccd204h LIKE xccd_t.xccd204h, #本期下階投入金額-制費五
#       xccd301 LIKE xccd_t.xccd301, #本期轉出數量
#       xccd302 LIKE xccd_t.xccd302, #本期轉出金額
#       xccd302a LIKE xccd_t.xccd302a, #本期轉出金額-材料
#       xccd302b LIKE xccd_t.xccd302b, #本期轉出金額-人工
#       xccd302c LIKE xccd_t.xccd302c, #本期轉出金額-加工
#       xccd302d LIKE xccd_t.xccd302d, #本期轉出金額-制費一
#       xccd302e LIKE xccd_t.xccd302e, #本期轉出金額-制費二
#       xccd302f LIKE xccd_t.xccd302f, #本期轉出金額-制費三
#       xccd302g LIKE xccd_t.xccd302g, #本期轉出金額-制費四
#       xccd302h LIKE xccd_t.xccd302h, #本期轉出金額-制費五
#       xccd303 LIKE xccd_t.xccd303, #差異轉出數量
#       xccd304 LIKE xccd_t.xccd304, #差異轉出金額
#       xccd304a LIKE xccd_t.xccd304a, #差異轉出金額-材料
#       xccd304b LIKE xccd_t.xccd304b, #差異轉出金額-人工
#       xccd304c LIKE xccd_t.xccd304c, #差異轉出金額-加工
#       xccd304d LIKE xccd_t.xccd304d, #差異轉出金額-制費一
#       xccd304e LIKE xccd_t.xccd304e, #差異轉出金額-制費二
#       xccd304f LIKE xccd_t.xccd304f, #差異轉出金額-制費三
#       xccd304g LIKE xccd_t.xccd304g, #差異轉出金額-制費四
#       xccd304h LIKE xccd_t.xccd304h, #差異轉出金額-制費五
#       xccd901 LIKE xccd_t.xccd901, #期末結存數量
#       xccd902 LIKE xccd_t.xccd902, #期末結存金額
#       xccd902a LIKE xccd_t.xccd902a, #期末結存金額-材料
#       xccd902b LIKE xccd_t.xccd902b, #期末結存金額-人工
#       xccd902c LIKE xccd_t.xccd902c, #期末結存金額-加工
#       xccd902d LIKE xccd_t.xccd902d, #期末結存金額-制費一
#       xccd902e LIKE xccd_t.xccd902e, #期末結存金額-制費二
#       xccd902f LIKE xccd_t.xccd902f, #期末結存金額-制費三
#       xccd902g LIKE xccd_t.xccd902g, #期末結存金額-制費四
#       xccd902h LIKE xccd_t.xccd902h, #期末結存金額-制費五
#       xccdtime LIKE xccd_t.xccdtime  #最近成本計算時間
#          END RECORD
##161109-00085#18-e mod
##161109-00085#18-s mod
##DEFINE l_xcce          RECORD LIKE xcce_t.*   #161109-00085#18-s mark
#DEFINE l_xcce          RECORD  #在製元件成本期異動統計檔
#       xcceent LIKE xcce_t.xcceent, #企業編號
#       xccecomp LIKE xcce_t.xccecomp, #法人組織
#       xcceld LIKE xcce_t.xcceld, #帳套
#       xcce001 LIKE xcce_t.xcce001, #帳套本位幣順序
#       xcce002 LIKE xcce_t.xcce002, #成本域
#       xcce003 LIKE xcce_t.xcce003, #成本計算類型
#       xcce004 LIKE xcce_t.xcce004, #年度
#       xcce005 LIKE xcce_t.xcce005, #期別
#       xcce006 LIKE xcce_t.xcce006, #工單編號
#       xcce007 LIKE xcce_t.xcce007, #元件編號
#       xcce008 LIKE xcce_t.xcce008, #產品特徵
#       xcce009 LIKE xcce_t.xcce009, #批號
#       xcce010 LIKE xcce_t.xcce010, #核算幣別
#       xcce101 LIKE xcce_t.xcce101, #上期結存數量
#       xcce102 LIKE xcce_t.xcce102, #上期結存金額
#       xcce102a LIKE xcce_t.xcce102a, #上期結存金額-材料
#       xcce102b LIKE xcce_t.xcce102b, #上期結存金額-人工
#       xcce102c LIKE xcce_t.xcce102c, #上期結存金額-加工
#       xcce102d LIKE xcce_t.xcce102d, #上期結存金額-制費一
#       xcce102e LIKE xcce_t.xcce102e, #上期結存金額-制費二
#       xcce102f LIKE xcce_t.xcce102f, #上期結存金額-制費三
#       xcce102g LIKE xcce_t.xcce102g, #上期結存金額-制費四
#       xcce102h LIKE xcce_t.xcce102h, #上期結存金額-制費五
#       xcce201 LIKE xcce_t.xcce201, #本期投入數量
#       xcce202 LIKE xcce_t.xcce202, #本期本階投入金額
#       xcce202a LIKE xcce_t.xcce202a, #本期本階投入金額-材料
#       xcce202b LIKE xcce_t.xcce202b, #本期本階投入金額-人工
#       xcce202c LIKE xcce_t.xcce202c, #本期本階投入金額-加工
#       xcce202d LIKE xcce_t.xcce202d, #本期本階投入金額-制費一
#       xcce202e LIKE xcce_t.xcce202e, #本期本階投入金額-制費二
#       xcce202f LIKE xcce_t.xcce202f, #本期本階投入金額-制費三
#       xcce202g LIKE xcce_t.xcce202g, #本期本階投入金額-制費四
#       xcce202h LIKE xcce_t.xcce202h, #本期本階投入金額-制費五
#       xcce205 LIKE xcce_t.xcce205, #本期當站下線數量
#       xcce206 LIKE xcce_t.xcce206, #本期當站下線成本
#       xcce206a LIKE xcce_t.xcce206a, #本期當站下線成本-材料
#       xcce206b LIKE xcce_t.xcce206b, #本期當站下線成本-人工
#       xcce206c LIKE xcce_t.xcce206c, #本期當站下線成本-加工
#       xcce206d LIKE xcce_t.xcce206d, #本期當站下線成本-制費一
#       xcce206e LIKE xcce_t.xcce206e, #本期當站下線成本-制費二
#       xcce206f LIKE xcce_t.xcce206f, #本期當站下線成本-制費三
#       xcce206g LIKE xcce_t.xcce206g, #本期當站下線成本-制費四
#       xcce206h LIKE xcce_t.xcce206h, #本期當站下線成本-制費五
#       xcce207 LIKE xcce_t.xcce207, #本期一般退料數量
#       xcce208 LIKE xcce_t.xcce208, #本期一般退料成本
#       xcce208a LIKE xcce_t.xcce208a, #本期一般退料成本-材料
#       xcce208b LIKE xcce_t.xcce208b, #本期一般退料成本-人工
#       xcce208c LIKE xcce_t.xcce208c, #本期一般退料成本-加工
#       xcce208d LIKE xcce_t.xcce208d, #本期一般退料成本-制費一
#       xcce208e LIKE xcce_t.xcce208e, #本期一般退料成本-制費二
#       xcce208f LIKE xcce_t.xcce208f, #本期一般退料成本-制費三
#       xcce208g LIKE xcce_t.xcce208g, #本期一般退料成本-制費四
#       xcce208h LIKE xcce_t.xcce208h, #本期一般退料成本-制費五
#       xcce209 LIKE xcce_t.xcce209, #本期超領退數量
#       xcce210 LIKE xcce_t.xcce210, #本期超領退金額
#       xcce210a LIKE xcce_t.xcce210a, #本期超領退金額-材料
#       xcce210b LIKE xcce_t.xcce210b, #本期超領退金額-人工
#       xcce210c LIKE xcce_t.xcce210c, #本期超領退金額-加工
#       xcce210d LIKE xcce_t.xcce210d, #本期超領退金額-制費一
#       xcce210e LIKE xcce_t.xcce210e, #本期超領退金額-制費二
#       xcce210f LIKE xcce_t.xcce210f, #本期超領退金額-制費三
#       xcce210g LIKE xcce_t.xcce210g, #本期超領退金額-制費四
#       xcce210h LIKE xcce_t.xcce210h, #本期超領退金額-制費五
#       xcce301 LIKE xcce_t.xcce301, #本期轉出數量
#       xcce302 LIKE xcce_t.xcce302, #本期轉出金額
#       xcce302a LIKE xcce_t.xcce302a, #本期轉出金額-材料
#       xcce302b LIKE xcce_t.xcce302b, #本期轉出金額-人工
#       xcce302c LIKE xcce_t.xcce302c, #本期轉出金額-加工
#       xcce302d LIKE xcce_t.xcce302d, #本期轉出金額-制費一
#       xcce302e LIKE xcce_t.xcce302e, #本期轉出金額-制費二
#       xcce302f LIKE xcce_t.xcce302f, #本期轉出金額-制費三
#       xcce302g LIKE xcce_t.xcce302g, #本期轉出金額-制費四
#       xcce302h LIKE xcce_t.xcce302h, #本期轉出金額-制費五
#       xcce303 LIKE xcce_t.xcce303, #差異轉出數量
#       xcce304 LIKE xcce_t.xcce304, #差異轉出金額
#       xcce304a LIKE xcce_t.xcce304a, #差異轉出金額-材料
#       xcce304b LIKE xcce_t.xcce304b, #差異轉出金額-人工
#       xcce304c LIKE xcce_t.xcce304c, #差異轉出金額-加工
#       xcce304d LIKE xcce_t.xcce304d, #差異轉出金額-制費一
#       xcce304e LIKE xcce_t.xcce304e, #差異轉出金額-制費二
#       xcce304f LIKE xcce_t.xcce304f, #差異轉出金額-制費三
#       xcce304g LIKE xcce_t.xcce304g, #差異轉出金額-制費四
#       xcce304h LIKE xcce_t.xcce304h, #差異轉出金額-制費五
#       xcce307 LIKE xcce_t.xcce307, #盤差數量
#       xcce308 LIKE xcce_t.xcce308, #盤差金額
#       xcce308a LIKE xcce_t.xcce308a, #盤差金額-材料
#       xcce308b LIKE xcce_t.xcce308b, #盤差金額-人工
#       xcce308c LIKE xcce_t.xcce308c, #盤差金額-加工
#       xcce308d LIKE xcce_t.xcce308d, #盤差金額-制費一
#       xcce308e LIKE xcce_t.xcce308e, #盤差金額-制費二
#       xcce308f LIKE xcce_t.xcce308f, #盤差金額-制費三
#       xcce308g LIKE xcce_t.xcce308g, #盤差金額-制費四
#       xcce308h LIKE xcce_t.xcce308h, #盤差金額-制費五
#       xcce901 LIKE xcce_t.xcce901, #期末結存數量
#       xcce902 LIKE xcce_t.xcce902, #期末結存金額
#       xcce902a LIKE xcce_t.xcce902a, #期末結存金額-材料
#       xcce902b LIKE xcce_t.xcce902b, #期末結存金額-人工
#       xcce902c LIKE xcce_t.xcce902c, #期末結存金額-加工
#       xcce902d LIKE xcce_t.xcce902d, #期末結存金額-制費一
#       xcce902e LIKE xcce_t.xcce902e, #期末結存金額-制費二
#       xcce902f LIKE xcce_t.xcce902f, #期末結存金額-制費三
#       xcce902g LIKE xcce_t.xcce902g, #期末結存金額-制費四
#       xcce902h LIKE xcce_t.xcce902h, #期末結存金額-制費五
#       xccetime LIKE xcce_t.xccetime  #最近成本計算時間
#          END RECORD
##161109-00085#18-e mod
##161109-00085#18-s mod
##DEFINE l_xcch          RECORD LIKE xcch_t.*   #161109-00085#18-s mark
#DEFINE l_xcch          RECORD  #拆件在製主件成本期異動統計檔
#       xcchent LIKE xcch_t.xcchent, #企業編號
#       xcchcomp LIKE xcch_t.xcchcomp, #法人組織
#       xcchld LIKE xcch_t.xcchld, #帳套
#       xcch001 LIKE xcch_t.xcch001, #帳套本位幣順序
#       xcch002 LIKE xcch_t.xcch002, #成本域
#       xcch003 LIKE xcch_t.xcch003, #成本計算類型
#       xcch004 LIKE xcch_t.xcch004, #年度
#       xcch005 LIKE xcch_t.xcch005, #期別
#       xcch006 LIKE xcch_t.xcch006, #拆件工單編號
#       xcch007 LIKE xcch_t.xcch007, #主件料號
#       xcch008 LIKE xcch_t.xcch008, #特性
#       xcch009 LIKE xcch_t.xcch009, #批號
#       xcch010 LIKE xcch_t.xcch010, #專案號
#       xcch011 LIKE xcch_t.xcch011, #核算幣別
#       xcch101 LIKE xcch_t.xcch101, #上期結存數量
#       xcch102 LIKE xcch_t.xcch102, #上期結存金額
#       xcch102a LIKE xcch_t.xcch102a, #上期結存金額-材料
#       xcch102b LIKE xcch_t.xcch102b, #上期結存金額-人工
#       xcch102c LIKE xcch_t.xcch102c, #上期結存金額-加工
#       xcch102d LIKE xcch_t.xcch102d, #上期結存金額-制費一
#       xcch102e LIKE xcch_t.xcch102e, #上期結存金額-制費二
#       xcch102f LIKE xcch_t.xcch102f, #上期結存金額-制費三
#       xcch102g LIKE xcch_t.xcch102g, #上期結存金額-制費四
#       xcch102h LIKE xcch_t.xcch102h, #上期結存金額-制費五
#       xcch200 LIKE xcch_t.xcch200, #本期投入工時
#       xcch201 LIKE xcch_t.xcch201, #本期投入數量
#       xcch202 LIKE xcch_t.xcch202, #本期本階投入金額
#       xcch202a LIKE xcch_t.xcch202a, #本期本階投入金額-材料
#       xcch202b LIKE xcch_t.xcch202b, #本期本階投入金額-人工
#       xcch202c LIKE xcch_t.xcch202c, #本期本階投入金額-加工
#       xcch202d LIKE xcch_t.xcch202d, #本期本階投入金額-制費一
#       xcch202e LIKE xcch_t.xcch202e, #本期本階投入金額-制費二
#       xcch202f LIKE xcch_t.xcch202f, #本期本階投入金額-制費三
#       xcch202g LIKE xcch_t.xcch202g, #本期本階投入金額-制費四
#       xcch202h LIKE xcch_t.xcch202h, #本期本階投入金額-制費五
#       xcch204 LIKE xcch_t.xcch204, #本期下階投入金額
#       xcch204a LIKE xcch_t.xcch204a, #本期下階投入金額-材料
#       xcch204b LIKE xcch_t.xcch204b, #本期下階投入金額-人工
#       xcch204c LIKE xcch_t.xcch204c, #本期下階投入金額-加工
#       xcch204d LIKE xcch_t.xcch204d, #本期下階投入金額-制費一
#       xcch204e LIKE xcch_t.xcch204e, #本期下階投入金額-制費二
#       xcch204f LIKE xcch_t.xcch204f, #本期下階投入金額-制費三
#       xcch204g LIKE xcch_t.xcch204g, #本期下階投入金額-制費四
#       xcch204h LIKE xcch_t.xcch204h, #本期下階投入金額-制費五
#       xcch301 LIKE xcch_t.xcch301, #本期轉出數量
#       xcch302 LIKE xcch_t.xcch302, #本期轉出金額
#       xcch302a LIKE xcch_t.xcch302a, #本期轉出金額-材料
#       xcch302b LIKE xcch_t.xcch302b, #本期轉出金額-人工
#       xcch302c LIKE xcch_t.xcch302c, #本期轉出金額-加工
#       xcch302d LIKE xcch_t.xcch302d, #本期轉出金額-制費一
#       xcch302e LIKE xcch_t.xcch302e, #本期轉出金額-制費二
#       xcch302f LIKE xcch_t.xcch302f, #本期轉出金額-制費三
#       xcch302g LIKE xcch_t.xcch302g, #本期轉出金額-制費四
#       xcch302h LIKE xcch_t.xcch302h, #本期轉出金額-制費五
#       xcch303 LIKE xcch_t.xcch303, #差異轉出數量
#       xcch304 LIKE xcch_t.xcch304, #差異轉出金額
#       xcch304a LIKE xcch_t.xcch304a, #差異轉出金額-材料
#       xcch304b LIKE xcch_t.xcch304b, #差異轉出金額-人工
#       xcch304c LIKE xcch_t.xcch304c, #差異轉出金額-加工
#       xcch304d LIKE xcch_t.xcch304d, #差異轉出金額-制費一
#       xcch304e LIKE xcch_t.xcch304e, #差異轉出金額-制費二
#       xcch304f LIKE xcch_t.xcch304f, #差異轉出金額-制費三
#       xcch304g LIKE xcch_t.xcch304g, #差異轉出金額-制費四
#       xcch304h LIKE xcch_t.xcch304h, #差異轉出金額-制費五
#       xcch901 LIKE xcch_t.xcch901, #期末結存數量
#       xcch902 LIKE xcch_t.xcch902, #期末結存金額
#       xcch902a LIKE xcch_t.xcch902a, #期末結存金額-材料
#       xcch902b LIKE xcch_t.xcch902b, #期末結存金額-人工
#       xcch902c LIKE xcch_t.xcch902c, #期末結存金額-加工
#       xcch902d LIKE xcch_t.xcch902d, #期末結存金額-制費一
#       xcch902e LIKE xcch_t.xcch902e, #期末結存金額-制費二
#       xcch902f LIKE xcch_t.xcch902f, #期末結存金額-制費三
#       xcch902g LIKE xcch_t.xcch902g, #期末結存金額-制費四
#       xcch902h LIKE xcch_t.xcch902h, #期末結存金額-制費五
#       xcchtime LIKE xcch_t.xcchtime  #最近成本計算時間
#          END RECORD
##161109-00085#18-e mod
##161109-00085#18-s mod
##DEFINE l_xcci          RECORD LIKE xcci_t.*   #161109-00085#18-s mark
#DEFINE l_xcci          RECORD  #拆件在製元件成本期異動統計檔
#       xccient LIKE xcci_t.xccient, #企業編號
#       xccicomp LIKE xcci_t.xccicomp, #法人組織
#       xccild LIKE xcci_t.xccild, #帳套
#       xcci001 LIKE xcci_t.xcci001, #帳套本位幣順序
#       xcci002 LIKE xcci_t.xcci002, #成本域
#       xcci003 LIKE xcci_t.xcci003, #成本計算類型
#       xcci004 LIKE xcci_t.xcci004, #年度
#       xcci005 LIKE xcci_t.xcci005, #期別
#       xcci006 LIKE xcci_t.xcci006, #拆件工單編號
#       xcci007 LIKE xcci_t.xcci007, #元件料號
#       xcci008 LIKE xcci_t.xcci008, #特性
#       xcci009 LIKE xcci_t.xcci009, #批號
#       xcci010 LIKE xcci_t.xcci010, #核算幣別
#       xcci101 LIKE xcci_t.xcci101, #上期結存數量
#       xcci102 LIKE xcci_t.xcci102, #上期結存金額
#       xcci102a LIKE xcci_t.xcci102a, #上期結存金額-材料
#       xcci102b LIKE xcci_t.xcci102b, #上期結存金額-人工
#       xcci102c LIKE xcci_t.xcci102c, #上期結存金額-加工
#       xcci102d LIKE xcci_t.xcci102d, #上期結存金額-制費一
#       xcci102e LIKE xcci_t.xcci102e, #上期結存金額-制費二
#       xcci102f LIKE xcci_t.xcci102f, #上期結存金額-制費三
#       xcci102g LIKE xcci_t.xcci102g, #上期結存金額-制費四
#       xcci102h LIKE xcci_t.xcci102h, #上期結存金額-制費五
#       xcci201 LIKE xcci_t.xcci201, #本期投入數量
#       xcci202 LIKE xcci_t.xcci202, #本期本階投入金額
#       xcci202a LIKE xcci_t.xcci202a, #本期本階投入金額-材料
#       xcci202b LIKE xcci_t.xcci202b, #本期本階投入金額-人工
#       xcci202c LIKE xcci_t.xcci202c, #本期本階投入金額-加工
#       xcci202d LIKE xcci_t.xcci202d, #本期本階投入金額-制費一
#       xcci202e LIKE xcci_t.xcci202e, #本期本階投入金額-制費二
#       xcci202f LIKE xcci_t.xcci202f, #本期本階投入金額-制費三
#       xcci202g LIKE xcci_t.xcci202g, #本期本階投入金額-制費四
#       xcci202h LIKE xcci_t.xcci202h, #本期本階投入金額-制費五
#       xcci301 LIKE xcci_t.xcci301, #本期轉出數量
#       xcci302 LIKE xcci_t.xcci302, #本期轉出金額
#       xcci302a LIKE xcci_t.xcci302a, #本期轉出金額-材料
#       xcci302b LIKE xcci_t.xcci302b, #本期轉出金額-人工
#       xcci302c LIKE xcci_t.xcci302c, #本期轉出金額-加工
#       xcci302d LIKE xcci_t.xcci302d, #本期轉出金額-制費一
#       xcci302e LIKE xcci_t.xcci302e, #本期轉出金額-制費二
#       xcci302f LIKE xcci_t.xcci302f, #本期轉出金額-制費三
#       xcci302g LIKE xcci_t.xcci302g, #本期轉出金額-制費四
#       xcci302h LIKE xcci_t.xcci302h, #本期轉出金額-制費五
#       xcci303 LIKE xcci_t.xcci303, #差異轉出數量
#       xcci304 LIKE xcci_t.xcci304, #差異轉出金額
#       xcci304a LIKE xcci_t.xcci304a, #差異轉出金額-材料
#       xcci304b LIKE xcci_t.xcci304b, #差異轉出金額-人工
#       xcci304c LIKE xcci_t.xcci304c, #差異轉出金額-加工
#       xcci304d LIKE xcci_t.xcci304d, #差異轉出金額-制費一
#       xcci304e LIKE xcci_t.xcci304e, #差異轉出金額-制費二
#       xcci304f LIKE xcci_t.xcci304f, #差異轉出金額-制費三
#       xcci304g LIKE xcci_t.xcci304g, #差異轉出金額-制費四
#       xcci304h LIKE xcci_t.xcci304h, #差異轉出金額-制費五
#       xcci901 LIKE xcci_t.xcci901, #期末結存數量
#       xcci902 LIKE xcci_t.xcci902, #期末結存金額
#       xcci902a LIKE xcci_t.xcci902a, #期末結存金額-材料
#       xcci902b LIKE xcci_t.xcci902b, #期末結存金額-人工
#       xcci902c LIKE xcci_t.xcci902c, #期末結存金額-加工
#       xcci902d LIKE xcci_t.xcci902d, #期末結存金額-制費一
#       xcci902e LIKE xcci_t.xcci902e, #期末結存金額-制費二
#       xcci902f LIKE xcci_t.xcci902f, #期末結存金額-制費三
#       xcci902g LIKE xcci_t.xcci902g, #期末結存金額-制費四
#       xcci902h LIKE xcci_t.xcci902h, #期末結存金額-制費五
#       xccitime LIKE xcci_t.xccitime  #最近成本計算時間
#          END RECORD
##161109-00085#18-e mod
#DEFINE l_sfaa052       LIKE sfaa_t.sfaa052
#DEFINE l_sfaa009       LIKE sfaa_t.sfaa009
#DEFINE l_sfaa028       LIKE sfaa_t.sfaa028
#DEFINE l_sfaa029       LIKE sfaa_t.sfaa029
#DEFINE l_sfaasite      LIKE sfaa_t.sfaasite
#DEFINE l_sfaa017       LIKE sfaa_t.sfaa017
#DEFINE ld_date         DATETIME YEAR TO SECOND
#DEFINE l_success       LIKE type_t.num5
#DEFINE l_errno         LIKE gzze_t.gzze001
#DEFINE l_sfaa057       LIKE sfaa_t.sfaa057   #150906-00001#2
#DEFINE l_sfaa068       LIKE sfaa_t.sfaa068   #160816-00015#1 add
#
#   LET g_success = 'Y'
#   LET l_xcea.xceaownid = g_user
#   LET l_xcea.xceaowndp = g_dept
#   LET l_xcea.xceacrtid = g_user
#   LET l_xcea.xceacrtdp = g_dept 
#   LET ld_date  = cl_get_current()
#   LET l_xcea.xceacrtdt = ld_date
#   LET l_xcea.xceamodid = ""
#   LET l_xcea.xceamoddt = ""
#   CALL s_aooi200_fin_gen_docno(g_xcea_m.xceald,'','',g_xcea_m.xceadocno,g_xcea_m.xcea001,g_prog_name1)      #wujie 150214  
#    RETURNING l_success,g_xcea_m.xceadocno
#   IF l_success  = 0  THEN
#      INITIALIZE g_errparam TO NULL
#      LET g_errparam.code = 'apm-00003'
#      LET g_errparam.extend = g_xcea_m.xceadocno
#      LET g_errparam.popup = TRUE
#      CALL cl_err()
#
#      LET g_success = 'N'
#      RETURN g_success
#   END IF
#   
#   INSERT INTO xcea_t (xceaent,xceald,xceacomp,xcea006,xceadocno,xcea001,xcea002,xcea004, 
#       xcea005,xcea003,xceastus,xceaownid,xceaowndp,xceacrtid,xceacrtdp,xceacrtdt, 
#       xceamodid,xceamoddt)
#   VALUES (g_enterprise,g_xcea_m.xceald,g_xcea_m.xceacomp,g_xcea_m.xcea006,g_xcea_m.xceadocno, 
#       g_xcea_m.xcea001,g_xcea002,g_xcea_m.xcea004,g_xcea_m.xcea005,g_xcea_m.xcea003, 
#       'N',l_xcea.xceaownid,l_xcea.xceaowndp,l_xcea.xceacrtid, 
#       l_xcea.xceacrtdp,l_xcea.xceacrtdt,l_xcea.xceamodid,l_xcea.xceamoddt) 
#       
#   IF SQLCA.sqlcode THEN
#      INITIALIZE g_errparam TO NULL
#      LET g_errparam.code = SQLCA.sqlcode
#      LET g_errparam.extend = "ins xcea"
#      LET g_errparam.popup = TRUE
#      CALL cl_err()
#  
#      LET g_success = 'N'
#      RETURN g_success
#   END IF
#  #160816-00015#1-s-add 
#   LET g_sql = "SELECT sfaa003,sfaa052,sfaa009,sfaasite,sfaa017, ",
#               "       sfaa028,sfaa029,sfaa057,sfaa068 ",  
#               "  FROM sfaa_t ",
#               " WHERE sfaaent = ",g_enterprise, 
#               "   AND sfaadocno = ? "
#   DECLARE axct701_01_sfaa_prep_01 CURSOR FROM g_sql     
#  #160816-00015#1-e-add 
#   
#   #非拆件工單 xccd_t
#   #帳套本位幣順序+工單+主件  
#
#   LET g_sql = " SELECT SUM(xcce202)+SUM(xcce206)+SUM(xcce208)+SUM(xcce210),SUM(xcce202a)+SUM(xcce206a)+SUM(xcce208a)+SUM(xcce210a),",
#               "        SUM(xcce202b)+SUM(xcce206b)+SUM(xcce208b)+SUM(xcce210b),SUM(xcce202c)+SUM(xcce206c)+SUM(xcce208c)+SUM(xcce210c),",
#               "        SUM(xcce202d)+SUM(xcce206d)+SUM(xcce208d)+SUM(xcce210d),SUM(xcce202e)+SUM(xcce206e)+SUM(xcce208e)+SUM(xcce210e),",
#               "        SUM(xcce202f)+SUM(xcce206f)+SUM(xcce208f)+SUM(xcce210f),SUM(xcce202g)+SUM(xcce206g)+SUM(xcce208g)+SUM(xcce210g),",
#               "        SUM(xcce202h)+SUM(xcce206h)+SUM(xcce208h)+SUM(xcce210h) ",
#               "   FROM xccd_t,xcce_t",
#               "  WHERE xccdent = '",g_enterprise,"' AND xccdld = '",g_xcea_m.xceald,"'",
#               "    AND xccd003 = '",g_xcea_m.xcea003,"' AND xccd004 = ",g_xcea_m.xcea004,
#               "    AND xccd005 = ",g_xcea_m.xcea005,
#               "    AND xcceent = xccdent",
#               "    AND xcceld  = xccdld",
#               "    AND xcce001 = xccd001",
#               "    AND xcce003 = xccd003",
#               "    AND xcce004 = xccd004",
#               "    AND xcce005 = xccd005",
#               "    AND xcce006 = xccd006",
#               "    AND xcce007 != 'DL+OH+SUB'",
#               "    AND xccd006 = ? AND xccd007 = ? AND xccd008 = ? AND xccd002 = ? "                
# 
#
#   LET g_sql1 = g_sql CLIPPED," AND xccd001 = '2' " 
#   
#   DECLARE xccd_prep2 CURSOR FROM g_sql1
#
#   
#
#   LET g_sql1 = g_sql CLIPPED," AND xccd001 = '3' " 
#   
#   DECLARE xccd_prep3 CURSOR FROM g_sql1
#
#               
#   LET g_sql = " SELECT xccd006,xccd007,xccd008,xccd002,",
#               "        SUM(xcce202)+SUM(xcce206)+SUM(xcce208)+SUM(xcce210),SUM(xcce202a)+SUM(xcce206a)+SUM(xcce208a)+SUM(xcce210a),",
#               "        SUM(xcce202b)+SUM(xcce206b)+SUM(xcce208b)+SUM(xcce210b),SUM(xcce202c)+SUM(xcce206c)+SUM(xcce208c)+SUM(xcce210c),",
#               "        SUM(xcce202d)+SUM(xcce206d)+SUM(xcce208d)+SUM(xcce210d),SUM(xcce202e)+SUM(xcce206e)+SUM(xcce208e)+SUM(xcce210e),",
#               "        SUM(xcce202f)+SUM(xcce206f)+SUM(xcce208f)+SUM(xcce210f),SUM(xcce202g)+SUM(xcce206g)+SUM(xcce208g)+SUM(xcce210g),",
#               "        SUM(xcce202h)+SUM(xcce206h)+SUM(xcce208h)+SUM(xcce210h) ",
#               "   FROM xccd_t,xcce_t",
#               "  WHERE xccdent = '",g_enterprise,"' AND xccdld = '",g_xcea_m.xceald,"'",
#               "    AND xccd003 = '",g_xcea_m.xcea003,"' AND xccd004 = ",g_xcea_m.xcea004,
#               "    AND xccd005 = ",g_xcea_m.xcea005,
#               "    AND xccd001 = '1' ",
#               "    AND xcceent = xccdent",
#               "    AND xcceld  = xccdld",
#               "    AND xcce001 = xccd001",
#               "    AND xcce003 = xccd003",
#               "    AND xcce004 = xccd004",
#               "    AND xcce005 = xccd005",
#               "    AND xcce006 = xccd006",
#               "    AND xcce007 != 'DL+OH+SUB'",
#               "  GROUP BY xccd006,xccd007,xccd008,xccd002 ",
#               "  ORDER BY xccd006,xccd007,xccd008,xccd002 "
#   PREPARE xccd_prep FROM g_sql
#   DECLARE xccd_curs CURSOR FOR xccd_prep
#   FOREACH xccd_curs INTO l_xccd.xccd006,l_xccd.xccd007,l_xccd.xccd008,l_xccd.xccd002,l_xcce.xcce202,l_xcce.xcce202a,
#                          l_xcce.xcce202b,l_xcce.xcce202c,l_xcce.xcce202d,l_xcce.xcce202e,l_xcce.xcce202f,
#                          l_xcce.xcce202g,l_xcce.xcce202h 
#      IF SQLCA.sqlcode THEN
#         INITIALIZE g_errparam TO NULL
#         LET g_errparam.code = SQLCA.sqlcode
#         LET g_errparam.extend = "foreach xccd"
#         LET g_errparam.popup = TRUE
#         CALL cl_err()
#
#         RETURN g_success
#         EXIT FOREACH
#      END IF  
#     #160816-00015#1-s-mark 
#     #LET l_sfaa052 = ''
#     #LET l_sfaa009 = ''
#     #LET l_sfaa028 = ''
#     #LET l_sfaa029 = ''
#     #LET l_sfaa017 = ''
#     #LET l_sfaasite =''
#     #160816-00015#1-e-mark      
#      
#      INITIALIZE l_xceb.* TO NULL
#      
#      LET l_xceb.xceb001 = l_xccd.xccd006 #工單
#      LET l_xceb.xceb004 = l_xccd.xccd007 #主件
#      LET l_xceb.xceb005 = l_xccd.xccd008 #特性
#      LET l_xceb.xceb103 = l_xccd.xccd002 #成本域
# 
#
#      #本位幣一
#      LET l_xceb.xceb202 = l_xcce.xcce202
#      LET l_xceb.xceb202a = l_xcce.xcce202a
#      LET l_xceb.xceb202b = l_xcce.xcce202b
#      LET l_xceb.xceb202c = l_xcce.xcce202c
#      LET l_xceb.xceb202d = l_xcce.xcce202d
#      LET l_xceb.xceb202e = l_xcce.xcce202e
#      LET l_xceb.xceb202f = l_xcce.xcce202f
#      LET l_xceb.xceb202g = l_xcce.xcce202g
#      LET l_xceb.xceb202h = l_xcce.xcce202h
#       
#
#      IF cl_null(l_xceb.xceb201)  THEN LET l_xceb.xceb201  = 0 END IF
#      IF cl_null(l_xceb.xceb202a) THEN LET l_xceb.xceb202a = 0 END IF
#      IF cl_null(l_xceb.xceb202b) THEN LET l_xceb.xceb202b = 0 END IF
#      IF cl_null(l_xceb.xceb202c) THEN LET l_xceb.xceb202c = 0 END IF
#      IF cl_null(l_xceb.xceb202d) THEN LET l_xceb.xceb202d = 0 END IF
#      IF cl_null(l_xceb.xceb202e) THEN LET l_xceb.xceb202e = 0 END IF
#      IF cl_null(l_xceb.xceb202f) THEN LET l_xceb.xceb202f = 0 END IF
#      IF cl_null(l_xceb.xceb202g) THEN LET l_xceb.xceb202g = 0 END IF
#      IF cl_null(l_xceb.xceb202h) THEN LET l_xceb.xceb202h = 0 END IF                            
#      IF cl_null(l_xceb.xceb202)  THEN LET l_xceb.xceb202  = 0 END IF
#      
#      #本位幣二
#      IF g_glaa015 = 'Y' THEN
#         OPEN xccd_prep2 USING l_xccd.xccd006,l_xccd.xccd007,l_xccd.xccd008,l_xccd.xccd002
#         FETCH xccd_prep2 INTO l_xcce.xcce202,l_xcce.xcce202a,l_xcce.xcce202b,l_xcce.xcce202c,
#                               l_xcce.xcce202d,l_xcce.xcce202e,l_xcce.xcce202f,l_xcce.xcce202g,l_xcce.xcce202h 
#         IF SQLCA.sqlcode THEN
#            INITIALIZE g_errparam TO NULL
#            LET g_errparam.code = SQLCA.sqlcode
#            LET g_errparam.extend = "xccd_prep2"
#            LET g_errparam.popup = TRUE
#            CALL cl_err()
#         
#            LET g_success = 'N'
#            RETURN g_success
#            EXIT FOREACH
#         END IF                        
#          
#         LET l_xceb.xceb212a = l_xcce.xcce202a
#         LET l_xceb.xceb212b = l_xcce.xcce202b
#         LET l_xceb.xceb212c = l_xcce.xcce202c
#         LET l_xceb.xceb212d = l_xcce.xcce202d
#         LET l_xceb.xceb212e = l_xcce.xcce202e
#         LET l_xceb.xceb212f = l_xcce.xcce202f
#         LET l_xceb.xceb212g = l_xcce.xcce202g
#         LET l_xceb.xceb212h = l_xcce.xcce202h
#          
#         IF cl_null(l_xceb.xceb212a) THEN LET l_xceb.xceb212a = 0 END IF
#         IF cl_null(l_xceb.xceb212b) THEN LET l_xceb.xceb212b = 0 END IF
#         IF cl_null(l_xceb.xceb212c) THEN LET l_xceb.xceb212c = 0 END IF
#         IF cl_null(l_xceb.xceb212d) THEN LET l_xceb.xceb212d = 0 END IF
#         IF cl_null(l_xceb.xceb212e) THEN LET l_xceb.xceb212e = 0 END IF
#         IF cl_null(l_xceb.xceb212f) THEN LET l_xceb.xceb212f = 0 END IF
#         IF cl_null(l_xceb.xceb212g) THEN LET l_xceb.xceb212g = 0 END IF
#         IF cl_null(l_xceb.xceb212h) THEN LET l_xceb.xceb212h = 0 END IF                            
#         IF cl_null(l_xceb.xceb212)  THEN LET l_xceb.xceb212  = 0 END IF
#      ELSE
#         LET l_xceb.xceb212a = 0
#         LET l_xceb.xceb212b = 0
#         LET l_xceb.xceb212c = 0
#         LET l_xceb.xceb212d = 0
#         LET l_xceb.xceb212e = 0
#         LET l_xceb.xceb212f = 0
#         LET l_xceb.xceb212g = 0
#         LET l_xceb.xceb212h = 0                            
#         LET l_xceb.xceb212  = 0      
#      END IF
#
#      #本位幣三
#      IF g_glaa019 = 'Y' THEN  
#         OPEN xccd_prep3 USING l_xccd.xccd006,l_xccd.xccd007,l_xccd.xccd008,l_xccd.xccd002
#         FETCH xccd_prep3 INTO l_xcce.xcce202,l_xcce.xcce202a,l_xcce.xcce202b,l_xcce.xcce202c,
#                               l_xcce.xcce202d,l_xcce.xcce202e,l_xcce.xcce202f,l_xcce.xcce202g,l_xcce.xcce202h 
#         IF SQLCA.sqlcode THEN
#            INITIALIZE g_errparam TO NULL
#            LET g_errparam.code = SQLCA.sqlcode
#            LET g_errparam.extend = "xccd_prep3"
#            LET g_errparam.popup = TRUE
#            CALL cl_err()
#         
#            LET g_success = 'N'
#            RETURN g_success
#            EXIT FOREACH
#         END IF 
#          
#         LET l_xceb.xceb222a = l_xcce.xcce202a
#         LET l_xceb.xceb222b = l_xcce.xcce202b
#         LET l_xceb.xceb222c = l_xcce.xcce202c
#         LET l_xceb.xceb222d = l_xcce.xcce202d
#         LET l_xceb.xceb222e = l_xcce.xcce202e
#         LET l_xceb.xceb222f = l_xcce.xcce202f
#         LET l_xceb.xceb222g = l_xcce.xcce202g
#         LET l_xceb.xceb222h = l_xcce.xcce202h
#          
#         IF cl_null(l_xceb.xceb222a) THEN LET l_xceb.xceb222a = 0 END IF
#         IF cl_null(l_xceb.xceb222b) THEN LET l_xceb.xceb222b = 0 END IF
#         IF cl_null(l_xceb.xceb222c) THEN LET l_xceb.xceb222c = 0 END IF
#         IF cl_null(l_xceb.xceb222d) THEN LET l_xceb.xceb222d = 0 END IF
#         IF cl_null(l_xceb.xceb222e) THEN LET l_xceb.xceb222e = 0 END IF
#         IF cl_null(l_xceb.xceb222f) THEN LET l_xceb.xceb222f = 0 END IF
#         IF cl_null(l_xceb.xceb222g) THEN LET l_xceb.xceb222g = 0 END IF
#         IF cl_null(l_xceb.xceb222h) THEN LET l_xceb.xceb222h = 0 END IF                            
#         IF cl_null(l_xceb.xceb222)  THEN LET l_xceb.xceb222  = 0 END IF
#      ELSE
#         LET l_xceb.xceb222a = 0
#         LET l_xceb.xceb222b = 0
#         LET l_xceb.xceb222c = 0
#         LET l_xceb.xceb222d = 0
#         LET l_xceb.xceb222e = 0
#         LET l_xceb.xceb222f = 0
#         LET l_xceb.xceb222g = 0
#         LET l_xceb.xceb222h = 0                            
#         LET l_xceb.xceb222  = 0      
#      END IF
#      
#      #項次
#      SELECT MAX(xcebseq) INTO l_xceb.xcebseq FROM xceb_t
#       WHERE xcebent = g_enterprise 
#         AND xcebld = g_xcea_m.xceald
#         AND xcebdocno = g_xcea_m.xceadocno
#      IF cl_null(l_xceb.xcebseq) OR l_xceb.xcebseq = 0 THEN
#         LET l_xceb.xcebseq = 1
#      ELSE
#         LET l_xceb.xcebseq = l_xceb.xcebseq + 1
#      END IF  
#
#     #160816-00015#1-s-add
#      LET l_sfaa057 = ''
#      LET l_sfaa052 = ''
#      LET l_sfaa009 = ''
#      LET l_sfaa017 = ''
#      LET l_sfaa028 = ''
#      LET l_sfaa029 = ''
#      LET l_sfaasite = ''
#      LET l_sfaa068 = ''
#      
#      EXECUTE axct701_01_sfaa_prep_01 USING l_xceb.xceb001 INTO l_xceb.xceb003,l_sfaa052,l_sfaa009,l_sfaasite,l_sfaa017,    
#                                                                l_sfaa028,l_sfaa029,l_sfaa057,l_sfaa068  
#     #160816-00015#1-e-add
#
#     #160816-00015#1-s-mark(移至上方統一抓取sfaa的資料)  
#     ##工單類型
#     #SELECT sfaa003,sfaa057 INTO l_xceb.xceb003,l_sfaa057 FROM sfaa_t   #150906-00001#2 add sfaa057
#     # WHERE sfaaent = g_enterprise 
#     #   AND sfaadocno = l_xceb.xceb001
#     #160816-00015#1-e-mark 
#      
#      #150906-00001#2-s
#      IF l_sfaa057 = '2' THEN #委外   
#         #在制科目
#         #CALL s_get_item_acc(g_xcea_m.xceald,'26',l_xceb.xceb004,'','',g_xcea_m.xceacomp,'')  
#         CALL s_get_item_acc(g_xcea_m.xceald,'24',l_xceb.xceb004,'','',g_xcea_m.xceacomp,'')  
#           RETURNING l_success,l_xceb.xceb101 
#      ELSE   
#      #150906-00001#2-e      
#         #在制科目
#         CALL s_get_item_acc(g_xcea_m.xceald,'3',l_xceb.xceb004,'','',g_xcea_m.xceacomp,'') 
#           RETURNING l_success,l_xceb.xceb101
#      END IF   #150906-00001#2
#      #agli161抓不到，改抓axci201的科目
#      IF cl_null(l_xceb.xceb101) THEN
#         CALL s_fin_get_account(g_xcea_m.xceald,'60','8912','1') RETURNING l_success,l_xceb.xceb101,l_errno
#      END IF
#      
#
#      LET l_xceb.xceb115 = ''  #經營類別
#      LET l_xceb.xceb116 = ''  #渠道
#      LET l_xceb.xceb118 = ''  #品牌
#      
#     #160816-00015#1-s-mark(移至上方統一抓取sfaa的資料)  
#     ##交易對象
#     #SELECT sfaa052,sfaa009,sfaasite INTO l_sfaa052,l_sfaa009,l_sfaasite FROM sfaa_t
#     # WHERE sfaaent = g_enterprise 
#     #   AND sfaadocno = l_xceb.xceb001
#     #160816-00015#1-e-mark
#     
#      IF l_sfaa052 = '2' THEN #委外
#         LET l_xceb.xceb111 = l_sfaa009
#         #客群/區域
#         SELECT pmaa090,pmaa241 INTO l_xceb.xceb112,l_xceb.xceb113 
#           FROM pmaa_t 
#          WHERE pmaaent = g_enterprise 
#            AND pmaa001 = l_xceb.xceb111
#      ELSE
#         LET l_xceb.xceb111 = ' '
#         #客群
#         LET l_xceb.xceb112 = ' '
#         #區域
#         SELECT ooef153 INTO l_xceb.xceb113 FROM ooef_t
#          WHERE ooefent = g_enterprise
#            AND ooef001 = l_sfaasite
#      END IF      
#
#
#     #160816-00015#1-s-mark(移至上方統一抓取sfaa的資料)  
#     ##成本中心--暫用部門sfaa017抓取其歸屬成本中心
#     #SELECT sfaa017 INTO l_sfaa017 FROM sfaa_t
#     # WHERE sfaaent = g_enterprise 
#     #   AND sfaadocno = l_xceb.xceb001
#     #160816-00015#1-e-mark 
#     
#      SELECT ooeg004 INTO l_xceb.xceb114 FROM ooeg_t
#       WHERE ooegent = g_enterprise AND ooeg001 = l_sfaa017  
#      
#      #品類
#      SELECT imag011 INTO l_xceb.xceb117 FROM imag_t
#       WHERE imagent = g_enterprise AND imagsite = g_xcea_m.xceacomp 
#         AND imag001 = l_xceb.xceb004   
#
#     #160816-00015#1-s-mark(移至上方統一抓取sfaa的資料)  
#     #項目編號+WBS
#     #ELECT sfaa028,sfaa029 INTO l_sfaa028,l_sfaa029 FROM sfaa_t
#     #WHERE sfaaent = g_enterprise 
#     #  AND sfaadocno = l_xceb.xceb001
#     #160816-00015#1-e-mark 
#    
#      #人员
#      LET l_xceb.xceb107 = ' '
#      
#      #部门
#      #LET l_xceb.xceb108 = ' '         #160816-00015#1 mark
#      #160816-00015#1-s-add
#      IF NOT cl_null(l_sfaa068) THEN
#         LET l_xceb.xceb108 = l_sfaa068   
#      ELSE
#         LET l_xceb.xceb108 = ' '
#      END IF      
#      #160816-00015#1-e-add
#      
#      #账款对象
#      LET l_xceb.xceb109 = ' '
#      #自由核算项1～10  
#      LET l_xceb.xceb121 = ' '
#      LET l_xceb.xceb122 = ' '
#      LET l_xceb.xceb123 = ' '
#      LET l_xceb.xceb124 = ' '
#      LET l_xceb.xceb125 = ' '
#      LET l_xceb.xceb126 = ' '
#      LET l_xceb.xceb127 = ' '
#      LET l_xceb.xceb128 = ' '
#      LET l_xceb.xceb129 = ' '
#      LET l_xceb.xceb130 = ' '
#      LET l_xceb.xcebent = g_enterprise 
#      LET l_xceb.xcebcomp = g_xcea_m.xceacomp
#      LET l_xceb.xcebld = g_xcea_m.xceald
#      LET l_xceb.xcebdocno = g_xcea_m.xceadocno
#      #摘要
#      IF cl_null(l_xceb.xceb102) THEN
#         CALL axct701_01_get_summ(g_xcea_m.xceald,'61','8925','1') RETURNING l_success,l_xceb.xceb102
#      END IF
#      CALL axct701_01_default_space_xceb(l_xceb.*) RETURNING l_xceb.xceb005,
#                                                             l_xceb.xceb101,
#                                                             l_xceb.xceb102,
#                                                             l_xceb.xceb103,
#                                                             l_xceb.xceb110,
#                                                             l_xceb.xceb111,
#                                                             l_xceb.xceb112,
#                                                             l_xceb.xceb113,
#                                                             l_xceb.xceb114,
#                                                             l_xceb.xceb115,
#                                                             l_xceb.xceb116,
#                                                             l_xceb.xceb117,
#                                                             l_xceb.xceb118,
#                                                             l_xceb.xceb119,
#                                                             l_xceb.xceb120,
#                                                             l_xceb.xceb107,
#                                                             l_xceb.xceb108,
#                                                             l_xceb.xceb109,
#                                                             l_xceb.xceb121,
#                                                             l_xceb.xceb122,
#                                                             l_xceb.xceb123,
#                                                             l_xceb.xceb124,
#                                                             l_xceb.xceb125,
#                                                             l_xceb.xceb126,
#                                                             l_xceb.xceb127,
#                                                             l_xceb.xceb128,
#                                                             l_xceb.xceb129,
#                                                             l_xceb.xceb130
##如果金额和数量都为0的话，则不产生此笔单身数据                                                             
#      IF l_xceb.xceb201= 0 AND l_xceb.xceb202 = 0 THEN
#         CONTINUE FOREACH
#      END IF 
#      #161109-00085#20-s mod
##      INSERT INTO xceb_t VALUES(l_xceb.*)   #161109-00085#20-s mark
#      #161109-00085#63 --s mark
#      #INSERT INTO xceb_t(xcebent,xcebcomp,xcebld,xcebdocno,xcebseq,xceb001,xceb002,xceb003,xceb004,
#      #                   xceb005,xceb101,xceb102,xceb103,xceb110,xceb111,xceb112,xceb113,xceb114,xceb115,
#      #                   xceb116,xceb117,xceb118,xceb119,xceb120,xceb201,xceb202,xceb202a,xceb202b,xceb202c,
#      #                   xceb202d,xceb202e,xceb202f,xceb202g,xceb202h,xceb212,xceb212a,xceb212b,xceb212c,
#      #                   xceb212d,xceb212e,xceb212f,xceb212g,xceb212h,xceb222,xceb222a,xceb222b,xceb222c,
#      #                   xceb222d,xceb222e,xceb222f,xceb222g,xceb222h,xceb301,xceb302,xceb107,xceb108,xceb109,
#      #                   xceb121,xceb122,xceb123,xceb124,xceb125,xceb126,xceb127,xceb128,xceb129,xceb130,xceb131,xceb132) 
#      #            VALUES(l_xceb.xcebent,l_xceb.xcebcomp,l_xceb.xcebld,l_xceb.xcebdocno,l_xceb.xcebseq,
#      #                   l_xceb.xceb001,l_xceb.xceb002,l_xceb.xceb003,l_xceb.xceb004,l_xceb.xceb005,
#      #                   l_xceb.xceb101,l_xceb.xceb102,l_xceb.xceb103,l_xceb.xceb110,l_xceb.xceb111,
#      #                   l_xceb.xceb112,l_xceb.xceb113,l_xceb.xceb114,l_xceb.xceb115,l_xceb.xceb116,
#      #                   l_xceb.xceb117,l_xceb.xceb118,l_xceb.xceb119,l_xceb.xceb120,l_xceb.xceb201,
#      #                   l_xceb.xceb202,l_xceb.xceb202a,l_xceb.xceb202b,l_xceb.xceb202c,l_xceb.xceb202d,
#      #                   l_xceb.xceb202e,l_xceb.xceb202f,l_xceb.xceb202g,l_xceb.xceb202h,l_xceb.xceb212,
#      #                   l_xceb.xceb212a,l_xceb.xceb212b,l_xceb.xceb212c,l_xceb.xceb212d,l_xceb.xceb212e,
#      #                   l_xceb.xceb212f,l_xceb.xceb212g,l_xceb.xceb212h,l_xceb.xceb222,l_xceb.xceb222a,
#      #                   l_xceb.xceb222b,l_xceb.xceb222c,l_xceb.xceb222d,l_xceb.xceb222e,l_xceb.xceb222f,
#      #                   l_xceb.xceb222g,l_xceb.xceb222h,l_xceb.xceb301,l_xceb.xceb302,l_xceb.xceb107,
#      #                   l_xceb.xceb108,l_xceb.xceb109,l_xceb.xceb121,l_xceb.xceb122,l_xceb.xceb123,
#      #                   l_xceb.xceb124,l_xceb.xceb125,l_xceb.xceb126,l_xceb.xceb127,l_xceb.xceb128,
#      #                   l_xceb.xceb129,l_xceb.xceb130,l_xceb.xceb131,l_xceb.xceb132)
#      #161109-00085#20-e mod
#      #161109-00085#63 --e mark
#      #161109-00085#63 --s add
#      INSERT INTO xceb_t(xcebent,xcebcomp,xcebld,xcebdocno,xcebseq,
#                         xceb001,xceb002,xceb003,xceb004,xceb005,
#                         xceb101,xceb102,xceb103,xceb110,xceb111,
#                         xceb112,xceb113,xceb114,xceb115,xceb116,
#                         xceb117,xceb118,xceb119,xceb120,xceb201,
#                         xceb202,xceb202a,xceb202b,xceb202c,xceb202d,
#                         xceb202e,xceb202f,xceb202g,xceb202h,xceb212,
#                         xceb212a,xceb212b,xceb212c,xceb212d,xceb212e,
#                         xceb212f,xceb212g,xceb212h,xceb222,xceb222a,
#                         xceb222b,xceb222c,xceb222d,xceb222e,xceb222f,
#                         xceb222g,xceb222h,xceb301,xceb302,xcebud001,
#                         xcebud002,xcebud003,xcebud004,xcebud005,xcebud006,
#                         xcebud007,xcebud008,xcebud009,xcebud010,xcebud011,
#                         xcebud012,xcebud013,xcebud014,xcebud015,xcebud016,
#                         xcebud017,xcebud018,xcebud019,xcebud020,xcebud021,
#                         xcebud022,xcebud023,xcebud024,xcebud025,xcebud026,
#                         xcebud027,xcebud028,xcebud029,xcebud030,xceb107,
#                         xceb108,xceb109,xceb121,xceb122,xceb123,
#                         xceb124,xceb125,xceb126,xceb127,xceb128,
#                         xceb129,xceb130,xceb131,xceb132)
#      VALUES(l_xceb.xcebent,l_xceb.xcebcomp,l_xceb.xcebld,l_xceb.xcebdocno,l_xceb.xcebseq,
#             l_xceb.xceb001,l_xceb.xceb002,l_xceb.xceb003,l_xceb.xceb004,l_xceb.xceb005,
#             l_xceb.xceb101,l_xceb.xceb102,l_xceb.xceb103,l_xceb.xceb110,l_xceb.xceb111,
#             l_xceb.xceb112,l_xceb.xceb113,l_xceb.xceb114,l_xceb.xceb115,l_xceb.xceb116,
#             l_xceb.xceb117,l_xceb.xceb118,l_xceb.xceb119,l_xceb.xceb120,l_xceb.xceb201,
#             l_xceb.xceb202,l_xceb.xceb202a,l_xceb.xceb202b,l_xceb.xceb202c,l_xceb.xceb202d,
#             l_xceb.xceb202e,l_xceb.xceb202f,l_xceb.xceb202g,l_xceb.xceb202h,l_xceb.xceb212,
#             l_xceb.xceb212a,l_xceb.xceb212b,l_xceb.xceb212c,l_xceb.xceb212d,l_xceb.xceb212e,
#             l_xceb.xceb212f,l_xceb.xceb212g,l_xceb.xceb212h,l_xceb.xceb222,l_xceb.xceb222a,
#             l_xceb.xceb222b,l_xceb.xceb222c,l_xceb.xceb222d,l_xceb.xceb222e,l_xceb.xceb222f,
#             l_xceb.xceb222g,l_xceb.xceb222h,l_xceb.xceb301,l_xceb.xceb302,l_xceb.xcebud001,
#             l_xceb.xcebud002,l_xceb.xcebud003,l_xceb.xcebud004,l_xceb.xcebud005,l_xceb.xcebud006,
#             l_xceb.xcebud007,l_xceb.xcebud008,l_xceb.xcebud009,l_xceb.xcebud010,l_xceb.xcebud011,
#             l_xceb.xcebud012,l_xceb.xcebud013,l_xceb.xcebud014,l_xceb.xcebud015,l_xceb.xcebud016,
#             l_xceb.xcebud017,l_xceb.xcebud018,l_xceb.xcebud019,l_xceb.xcebud020,l_xceb.xcebud021,
#             l_xceb.xcebud022,l_xceb.xcebud023,l_xceb.xcebud024,l_xceb.xcebud025,l_xceb.xcebud026,
#             l_xceb.xcebud027,l_xceb.xcebud028,l_xceb.xcebud029,l_xceb.xcebud030,l_xceb.xceb107,
#             l_xceb.xceb108,l_xceb.xceb109,l_xceb.xceb121,l_xceb.xceb122,l_xceb.xceb123,
#             l_xceb.xceb124,l_xceb.xceb125,l_xceb.xceb126,l_xceb.xceb127,l_xceb.xceb128,
#             l_xceb.xceb129,l_xceb.xceb130,l_xceb.xceb131,l_xceb.xceb132)
#      #161109-00085#63 --e add
#      IF SQLCA.sqlcode THEN
#         INITIALIZE g_errparam TO NULL
#         LET g_errparam.code = SQLCA.sqlcode
#         LET g_errparam.extend = "ins xceb"
#         LET g_errparam.popup = TRUE
#         CALL cl_err()
#  
#         LET g_success = 'N'
#         RETURN g_success
#         EXIT FOREACH
#      END IF   
#   CLOSE xccd_prep2
#   CLOSE xccd_prep3   
#   END FOREACH     
#
#
#   #非拆件工單 xcce_t
#   #帳套本位幣順序+工單+元件  
#   LET g_sql = " SELECT SUM(xcce202)+SUM(xcce206)+SUM(xcce208)+SUM(xcce210),SUM(xcce202a)+SUM(xcce206a)+SUM(xcce208a)+SUM(xcce210a),",
#               "        SUM(xcce202b)+SUM(xcce206b)+SUM(xcce208b)+SUM(xcce210b),SUM(xcce202c)+SUM(xcce206c)+SUM(xcce208c)+SUM(xcce210c),",
#               "        SUM(xcce202d)+SUM(xcce206d)+SUM(xcce208d)+SUM(xcce210d),SUM(xcce202e)+SUM(xcce206e)+SUM(xcce208e)+SUM(xcce210e),",
#               "        SUM(xcce202f)+SUM(xcce206f)+SUM(xcce208f)+SUM(xcce210f),SUM(xcce202g)+SUM(xcce206g)+SUM(xcce208g)+SUM(xcce210g),SUM(xcce202h)+SUM(xcce206h)+SUM(xcce208h)+SUM(xcce210h) ",
#               "   FROM xcce_t", 
#               "  WHERE xcceent = '",g_enterprise,"' AND xcceld = '",g_xcea_m.xceald,"'",
#               "    AND xcce003 = '",g_xcea_m.xcea003,"' AND xcce004 = ",g_xcea_m.xcea004,
#               "    AND xcce005 = ",g_xcea_m.xcea005,  
#               "    AND xcce007 != 'DL+OH+SUB'",
#               "    AND xcce006 = ? AND xcce007 = ? AND xcce002 = ? AND xcce008 = ? AND xcce009 = ?  " 
# 
#   LET g_sql1 = g_sql CLIPPED," AND xcce001 = '2' " 
#   
#   DECLARE xcce_prep2 CURSOR FROM g_sql1
#   
#
#   LET g_sql1 = g_sql CLIPPED," AND xcce001 = '3' " 
#   
#   DECLARE xcce_prep3 CURSOR FROM g_sql1
#
#   
#   LET g_sql = " SELECT xcce006,xcce007,xcce002,xcce008,xcce009,SUM(xcce201)+SUM(xcce205)+SUM(xcce207)+SUM(xcce209),",
#               "        SUM(xcce202)+SUM(xcce206)+SUM(xcce208)+SUM(xcce210),SUM(xcce202a)+SUM(xcce206a)+SUM(xcce208a)+SUM(xcce210a),",
#               "        SUM(xcce202b)+SUM(xcce206b)+SUM(xcce208b)+SUM(xcce210b),SUM(xcce202c)+SUM(xcce206c)+SUM(xcce208c)+SUM(xcce210c),",
#               "        SUM(xcce202d)+SUM(xcce206d)+SUM(xcce208d)+SUM(xcce210d),SUM(xcce202e)+SUM(xcce206e)+SUM(xcce208e)+SUM(xcce210e),",
#               "        SUM(xcce202f)+SUM(xcce206f)+SUM(xcce208f)+SUM(xcce210f),SUM(xcce202g)+SUM(xcce206g)+SUM(xcce208g)+SUM(xcce210g),SUM(xcce202h)+SUM(xcce206h)+SUM(xcce208h)+SUM(xcce210h) ",
#               "   FROM xcce_t",
#               "  WHERE xcceent = '",g_enterprise,"' AND xcceld = '",g_xcea_m.xceald,"'",
#               "    AND xcce003 = '",g_xcea_m.xcea003,"' AND xcce004 = ",g_xcea_m.xcea004,
#               "    AND xcce005 = ",g_xcea_m.xcea005,
#               "    AND xcce007 != 'DL+OH+SUB'",
#               "    AND xcce001 = '1' ",
#               "  GROUP BY xcce006,xcce007,xcce002,xcce008,xcce009",
#               "  ORDER BY xcce006,xcce007,xcce002,xcce008,xcce009 "
#   PREPARE xcce_prep FROM g_sql
#   DECLARE xcce_curs CURSOR FOR xcce_prep
#   FOREACH xcce_curs INTO l_xcce.xcce006,l_xcce.xcce007,l_xcce.xcce002,l_xcce.xcce008,l_xcce.xcce009,
#                          l_xcce.xcce201,l_xcce.xcce202,l_xcce.xcce202a,
#                          l_xcce.xcce202b,l_xcce.xcce202c,l_xcce.xcce202d,l_xcce.xcce202e,l_xcce.xcce202f,
#                          l_xcce.xcce202g,l_xcce.xcce202h                         
#      IF SQLCA.sqlcode THEN
#         INITIALIZE g_errparam TO NULL
#         LET g_errparam.code = SQLCA.sqlcode
#         LET g_errparam.extend = "foreach xcce"
#         LET g_errparam.popup = TRUE
#         CALL cl_err()
#
#         EXIT FOREACH
#      END IF  
#     #160816-00015#1-s-mark 
#     #LET l_sfaa052 = ''
#     #LET l_sfaa009 = ''
#     #LET l_sfaa028 = ''
#     #LET l_sfaa029 = ''
#     #LET l_sfaa017 = ''
#     #LET l_sfaasite =''
#     #160816-00015#1-e-mark 
#      INITIALIZE l_xcec.* TO NULL
#      
#      LET l_xcec.xcec001 = l_xcce.xcce006 #工單
#      LET l_xcec.xcec004 = l_xcce.xcce007 #主件
#      LET l_xcec.xcec005 = l_xcce.xcce008 #特性
#      LET l_xcec.xcec103 = l_xcce.xcce002 #成本域
#      
#      #本位幣一
#      LET l_xcec.xcec201 =  l_xcce.xcce201#投入數量
#      LET l_xcec.xcec202a = l_xcce.xcce202a 
#      LET l_xcec.xcec202b = l_xcce.xcce202b   
#      LET l_xcec.xcec202c = l_xcce.xcce202c 
#      LET l_xcec.xcec202d = l_xcce.xcce202d 
#      LET l_xcec.xcec202e = l_xcce.xcce202e 
#      LET l_xcec.xcec202f = l_xcce.xcce202f 
#      LET l_xcec.xcec202g = l_xcce.xcce202g 
#      LET l_xcec.xcec202h = l_xcce.xcce202h 
#      LET l_xcec.xcec202  = l_xcce.xcce202       
#
#      IF cl_null(l_xcec.xcec201)  THEN LET l_xcec.xcec201  = 0 END IF
#      IF cl_null(l_xcec.xcec202a) THEN LET l_xcec.xcec202a = 0 END IF
#      IF cl_null(l_xcec.xcec202b) THEN LET l_xcec.xcec202b = 0 END IF
#      IF cl_null(l_xcec.xcec202c) THEN LET l_xcec.xcec202c = 0 END IF
#      IF cl_null(l_xcec.xcec202d) THEN LET l_xcec.xcec202d = 0 END IF
#      IF cl_null(l_xcec.xcec202e) THEN LET l_xcec.xcec202e = 0 END IF
#      IF cl_null(l_xcec.xcec202f) THEN LET l_xcec.xcec202f = 0 END IF
#      IF cl_null(l_xcec.xcec202g) THEN LET l_xcec.xcec202g = 0 END IF
#      IF cl_null(l_xcec.xcec202h) THEN LET l_xcec.xcec202h = 0 END IF
#      IF cl_null(l_xcec.xcec202)  THEN LET l_xcec.xcec202  = 0 END IF
#     
#      IF g_glaa015 ='Y' THEN
#      #本位幣二
#         OPEN xcce_prep2 USING l_xcce.xcce006,l_xcce.xcce007,l_xcce.xcce002,l_xcce.xcce008,l_xcce.xcce009
#         FETCH xcce_prep2 INTO l_xcec.xcec212,l_xcec.xcec212a,l_xcec.xcec212b,l_xcec.xcec212c,l_xcec.xcec212d,
#                               l_xcec.xcec212e,l_xcec.xcec212f,l_xcec.xcec212g,l_xcec.xcec212h
#         IF SQLCA.sqlcode THEN
#            INITIALIZE g_errparam TO NULL
#            LET g_errparam.code = SQLCA.sqlcode
#            LET g_errparam.extend = "xcce_prep2"
#            LET g_errparam.popup = TRUE
#            CALL cl_err()
#         
#            LET g_success = 'N'
#            RETURN g_success
#            EXIT FOREACH
#         END IF 
#         
#         
#         IF cl_null(l_xcec.xcec212a) THEN LET l_xcec.xcec212a = 0 END IF
#         IF cl_null(l_xcec.xcec212b) THEN LET l_xcec.xcec212b = 0 END IF
#         IF cl_null(l_xcec.xcec212c) THEN LET l_xcec.xcec212c = 0 END IF
#         IF cl_null(l_xcec.xcec212d) THEN LET l_xcec.xcec212d = 0 END IF
#         IF cl_null(l_xcec.xcec212e) THEN LET l_xcec.xcec212e = 0 END IF
#         IF cl_null(l_xcec.xcec212f) THEN LET l_xcec.xcec212f = 0 END IF
#         IF cl_null(l_xcec.xcec212g) THEN LET l_xcec.xcec212g = 0 END IF
#         IF cl_null(l_xcec.xcec212h) THEN LET l_xcec.xcec212h = 0 END IF
#         IF cl_null(l_xcec.xcec212)  THEN LET l_xcec.xcec212  = 0 END IF 
#      ELSE
#         LET l_xcec.xcec212a = 0
#         LET l_xcec.xcec212b = 0
#         LET l_xcec.xcec212c = 0
#         LET l_xcec.xcec212d = 0
#         LET l_xcec.xcec212e = 0
#         LET l_xcec.xcec212f = 0
#         LET l_xcec.xcec212g = 0
#         LET l_xcec.xcec212h = 0
#         LET l_xcec.xcec212  = 0
#      END IF      
#      IF g_glaa019 ='Y' THEN
#      #本位幣三
#         OPEN xcce_prep3 USING l_xcce.xcce006,l_xcce.xcce007,l_xcce.xcce002,l_xcce.xcce008,l_xcce.xcce009
#         FETCH xcce_prep3 INTO l_xcec.xcec222,l_xcec.xcec222a,l_xcec.xcec222b,l_xcec.xcec222c,l_xcec.xcec222d,
#                               l_xcec.xcec222e,l_xcec.xcec222f,l_xcec.xcec222g,l_xcec.xcec222h
#         IF SQLCA.sqlcode THEN
#            INITIALIZE g_errparam TO NULL
#            LET g_errparam.code = SQLCA.sqlcode
#            LET g_errparam.extend = "xcce_prep3"
#            LET g_errparam.popup = TRUE
#            CALL cl_err()
#         
#            LET g_success = 'N'
#            RETURN g_success
#            EXIT FOREACH
#         END IF 
#         
#         IF cl_null(l_xcec.xcec222a) THEN LET l_xcec.xcec222a = 0 END IF
#         IF cl_null(l_xcec.xcec222b) THEN LET l_xcec.xcec222b = 0 END IF
#         IF cl_null(l_xcec.xcec222c) THEN LET l_xcec.xcec222c = 0 END IF
#         IF cl_null(l_xcec.xcec222d) THEN LET l_xcec.xcec222d = 0 END IF
#         IF cl_null(l_xcec.xcec222e) THEN LET l_xcec.xcec222e = 0 END IF
#         IF cl_null(l_xcec.xcec222f) THEN LET l_xcec.xcec222f = 0 END IF
#         IF cl_null(l_xcec.xcec222g) THEN LET l_xcec.xcec222g = 0 END IF
#         IF cl_null(l_xcec.xcec222h) THEN LET l_xcec.xcec222h = 0 END IF
#         IF cl_null(l_xcec.xcec222)  THEN LET l_xcec.xcec222  = 0 END IF      
#      ELSE
#         LET l_xcec.xcec222a = 0
#         LET l_xcec.xcec222b = 0
#         LET l_xcec.xcec222c = 0
#         LET l_xcec.xcec222d = 0
#         LET l_xcec.xcec222e = 0
#         LET l_xcec.xcec222f = 0
#         LET l_xcec.xcec222g = 0
#         LET l_xcec.xcec222h = 0
#         LET l_xcec.xcec222  = 0
#      END IF 
#      #項次
#      SELECT MAX(xcecseq) INTO l_xcec.xcecseq FROM xcec_t
#       WHERE xcecent = g_enterprise 
#         AND xcecld = g_xcea_m.xceald
#         AND xcecdocno = g_xcea_m.xceadocno
#      IF cl_null(l_xcec.xcecseq) OR l_xcec.xcecseq = 0 THEN
#         LET l_xcec.xcecseq = 1
#      ELSE
#         LET l_xcec.xcecseq = l_xcec.xcecseq + 1
#      END IF   
#
#     #160816-00015#1-s-add
#      LET l_sfaa057 = ''
#      LET l_sfaa052 = ''
#      LET l_sfaa009 = ''
#      LET l_sfaa017 = ''
#      LET l_sfaa028 = ''
#      LET l_sfaa029 = ''
#      LET l_sfaasite = ''
#      LET l_sfaa068 = ''
#      
#      EXECUTE axct701_01_sfaa_prep_01 USING l_xcec.xcec001 INTO l_xcec.xcec003,l_sfaa052,l_sfaa009,l_sfaasite,l_sfaa017,    
#                                                                l_sfaa028,l_sfaa029,l_sfaa057,l_sfaa068  
#     #160816-00015#1-e-add
#
#
#     #160816-00015#1-s-mark     
#     ##工單類型
#     #SELECT sfaa003 INTO l_xcec.xcec003 FROM sfaa_t
#     # WHERE sfaaent = g_enterprise 
#     #   AND sfaadocno = l_xcec.xcec001
#     #160816-00015#1-e-mark    
#      #150812-00010#3--s
#      IF l_xcec.xcec004 = 'ADJUST' THEN
#         #調整科目
#         #CALL s_fin_get_account(g_xcea_m.xceald,'60','8912','9') RETURNING g_sub_success,l_xcec.xcec101,g_errno
#         CALL s_fin_get_account(g_xcea_m.xceald,'60','8912','16') RETURNING g_sub_success,l_xcec.xcec101,g_errno #mod 160519 160520-00014#4
#      ELSE
#      #150812-00010#3--e        
#         #存貨科目
#         CALL s_get_item_acc(g_xcea_m.xceald,'1',l_xcec.xcec004,'','',g_xcea_m.xceacomp,'') 
#           RETURNING l_success,l_xcec.xcec101    
#      END IF   #150812-00010#3
#      
#
#      LET l_xcec.xcec102 = ''  #摘要
#      LET l_xcec.xcec115 = ''  #經營類別
#      LET l_xcec.xcec116 = ''  #渠道
#      LET l_xcec.xcec118 = ''  #品牌
#     #160816-00015#1-s-mark       
#     ##交易對象
#     #SELECT sfaa052,sfaa009,sfaasite INTO l_sfaa052,l_sfaa009,l_sfaasite FROM sfaa_t
#     # WHERE sfaaent = g_enterprise 
#     #   AND sfaadocno = l_xcec.xcec001
#     #160816-00015#1-e-mark          
#      IF l_sfaa052 = '2' THEN #委外
#         LET l_xcec.xcec111 = l_sfaa009
#         #客群/區域
#         SELECT pmaa090,pmaa241 INTO l_xcec.xcec112,l_xcec.xcec113 
#           FROM pmaa_t 
#          WHERE pmaaent = g_enterprise 
#            AND pmaa001 = l_xcec.xcec111
#      ELSE
#         LET l_xcec.xcec111 = ' '
#         #客群
#         LET l_xcec.xcec112 = ' '
#         #區域
#         SELECT ooef153 INTO l_xcec.xcec113 FROM ooef_t
#          WHERE ooefent = g_enterprise
#            AND ooef001 = l_sfaasite
#      END IF      
#
#
#     #160816-00015#1-s-mark       
#     ##成本中心--暫用部門sfaa017抓取其歸屬成本中心
#     #SELECT sfaa017 INTO l_sfaa017 FROM sfaa_t
#     # WHERE sfaaent = g_enterprise 
#     #   AND sfaadocno = l_xcec.xcec001
#     #160816-00015#1-e-mark       
#     
#      SELECT ooeg004 INTO l_xcec.xcec114 FROM ooeg_t
#       WHERE ooegent = g_enterprise AND ooeg001 = l_sfaa017 
#       
#
#      #品類
#      SELECT imag011 INTO l_xcec.xcec117 FROM imag_t
#       WHERE imagent = g_enterprise AND imagsite = g_xcea_m.xceacomp 
#         AND imag001 = l_xcec.xcec004   
#     #160816-00015#1-s-mark 
#     ##項目編號+WBS
#     #SELECT sfaa028,sfaa029 INTO l_sfaa028,l_sfaa029 FROM sfaa_t
#     # WHERE sfaaent = g_enterprise 
#     #   AND sfaadocno = l_xcec.xcec001
#     #160816-00015#1-s-mark 
#     
#      #人员
#      LET l_xcec.xcec107 = ' '
#     #部门
#      #LET l_xcec.xcec108 = ' '  #160816-00015#1 mark
#     #160816-00015#1-s-add
#      IF NOT cl_null(l_sfaa068) THEN
#         LET l_xcec.xcec108 = l_sfaa068   
#      ELSE
#         LET l_xcec.xcec108 = ' '
#      END IF      
#     #160816-00015#1-e-add        
#      #账款对象
#      LET l_xcec.xcec109 = ' '
#      #自由核算项1～10  
#      LET l_xcec.xcec121 = ' '
#      LET l_xcec.xcec122 = ' '
#      LET l_xcec.xcec123 = ' '
#      LET l_xcec.xcec124 = ' '
#      LET l_xcec.xcec125 = ' '
#      LET l_xcec.xcec126 = ' '
#      LET l_xcec.xcec127 = ' '
#      LET l_xcec.xcec128 = ' '
#      LET l_xcec.xcec129 = ' '
#      LET l_xcec.xcec130 = ' '
#      
#      LET l_xcec.xcecent = g_enterprise 
#      LET l_xcec.xceccomp = g_xcea_m.xceacomp
#      LET l_xcec.xcecld = g_xcea_m.xceald
#      LET l_xcec.xcecdocno = g_xcea_m.xceadocno
#      #摘要
#      IF cl_null(l_xcec.xcec102) THEN
#         CALL axct701_01_get_summ(g_xcea_m.xceald,'61','8925','1') RETURNING l_success,l_xcec.xcec102
#      END IF
#      
#      CALL axct701_01_default_space_xcec(l_xcec.*) RETURNING l_xcec.xcec005,   
#                                                             l_xcec.xcec101,
#                                                             l_xcec.xcec102,
#                                                             l_xcec.xcec103,
#                                                             l_xcec.xcec110,
#                                                             l_xcec.xcec111,
#                                                             l_xcec.xcec112,
#                                                             l_xcec.xcec113,
#                                                             l_xcec.xcec114,
#                                                             l_xcec.xcec115,
#                                                             l_xcec.xcec116,
#                                                             l_xcec.xcec117,
#                                                             l_xcec.xcec118,
#                                                             l_xcec.xcec119,
#                                                             l_xcec.xcec120,
#                                                             l_xcec.xcec107,
#                                                             l_xcec.xcec108,
#                                                             l_xcec.xcec109,
#                                                             l_xcec.xcec121,
#                                                             l_xcec.xcec122,
#                                                             l_xcec.xcec123,
#                                                             l_xcec.xcec124,
#                                                             l_xcec.xcec125,
#                                                             l_xcec.xcec126,
#                                                             l_xcec.xcec127,
#                                                             l_xcec.xcec128,
#                                                             l_xcec.xcec129,
#                                                             l_xcec.xcec130 
#                                  
##如果金额和数量都为0的话，则不产生此笔单身数据                                                             
#      IF l_xcec.xcec201= 0 AND l_xcec.xcec202 = 0 THEN
#         CONTINUE FOREACH
#      END IF 
#      #161109-00085#20-s mod      
##      INSERT INTO xcec_t VALUES(l_xcec.*)   #161109-00085#20-s mark
#      #161109-00085#63 --s mark
#      #INSERT INTO xcec_t(xcecent,xceccomp,xcecld,xcecdocno,xcecseq,xcec001,xcec002,xcec003,xcec004,
#      #                   xcec005,xcec101,xcec102,xcec103,xcec110,xcec111,xcec112,xcec113,xcec114,
#      #                   xcec115,xcec116,xcec117,xcec118,xcec119,xcec120,xcec201,xcec202,xcec202a,
#      #                   xcec202b,xcec202c,xcec202d,xcec202e,xcec202f,xcec202g,xcec202h,xcec212,
#      #                   xcec212a,xcec212b,xcec212c,xcec212d,xcec212e,xcec212f,xcec212g,xcec212h,
#      #                   xcec222,xcec222a,xcec222b,xcec222c,xcec222d,xcec222e,xcec222f,xcec222g,
#      #                   xcec222h,xcec301,xcec302,xcec107,xcec108,xcec109,xcec121,xcec122,xcec123,
#      #                   xcec124,xcec125,xcec126,xcec127,xcec128,xcec129,xcec130) 
#      #            VALUES(l_xcec.xcecent,l_xcec.xceccomp,l_xcec.xcecld,l_xcec.xcecdocno,l_xcec.xcecseq,
#      #                   l_xcec.xcec001,l_xcec.xcec002,l_xcec.xcec003,l_xcec.xcec004,l_xcec.xcec005,
#      #                   l_xcec.xcec101,l_xcec.xcec102,l_xcec.xcec103,l_xcec.xcec110,l_xcec.xcec111,
#      #                   l_xcec.xcec112,l_xcec.xcec113,l_xcec.xcec114,l_xcec.xcec115,l_xcec.xcec116,
#      #                   l_xcec.xcec117,l_xcec.xcec118,l_xcec.xcec119,l_xcec.xcec120,l_xcec.xcec201,
#      #                   l_xcec.xcec202,l_xcec.xcec202a,l_xcec.xcec202b,l_xcec.xcec202c,l_xcec.xcec202d,
#      #                   l_xcec.xcec202e,l_xcec.xcec202f,l_xcec.xcec202g,l_xcec.xcec202h,l_xcec.xcec212,
#      #                   l_xcec.xcec212a,l_xcec.xcec212b,l_xcec.xcec212c,l_xcec.xcec212d,l_xcec.xcec212e,
#      #                   l_xcec.xcec212f,l_xcec.xcec212g,l_xcec.xcec212h,l_xcec.xcec222,l_xcec.xcec222a,
#      #                   l_xcec.xcec222b,l_xcec.xcec222c,l_xcec.xcec222d,l_xcec.xcec222e,l_xcec.xcec222f,
#      #                   l_xcec.xcec222g,l_xcec.xcec222h,l_xcec.xcec301,l_xcec.xcec302,l_xcec.xcec107,
#      #                   l_xcec.xcec108,l_xcec.xcec109,l_xcec.xcec121,l_xcec.xcec122,l_xcec.xcec123,
#      #                   l_xcec.xcec124,l_xcec.xcec125,l_xcec.xcec126,l_xcec.xcec127,l_xcec.xcec128,
#      #                   l_xcec.xcec129,l_xcec.xcec130)
#      #161109-00085#63 --e mark
#      #161109-00085#20-e mod
#      #161109-00085#63 --s add
#      INSERT INTO xcec_t(xcecent,xceccomp,xcecld,xcecdocno,xcecseq,
#                         xcec001,xcec002,xcec003,xcec004,xcec005,
#                         xcec101,xcec102,xcec103,xcec110,xcec111,
#                         xcec112,xcec113,xcec114,xcec115,xcec116,
#                         xcec117,xcec118,xcec119,xcec120,xcec201,
#                         xcec202,xcec202a,xcec202b,xcec202c,xcec202d,
#                         xcec202e,xcec202f,xcec202g,xcec202h,xcec212,
#                         xcec212a,xcec212b,xcec212c,xcec212d,xcec212e,
#                         xcec212f,xcec212g,xcec212h,xcec222,xcec222a,
#                         xcec222b,xcec222c,xcec222d,xcec222e,xcec222f,
#                         xcec222g,xcec222h,xcec301,xcec302,xcecud001,
#                         xcecud002,xcecud003,xcecud004,xcecud005,xcecud006,
#                         xcecud007,xcecud008,xcecud009,xcecud010,xcecud011,
#                         xcecud012,xcecud013,xcecud014,xcecud015,xcecud016,
#                         xcecud017,xcecud018,xcecud019,xcecud020,xcecud021,
#                         xcecud022,xcecud023,xcecud024,xcecud025,xcecud026,
#                         xcecud027,xcecud028,xcecud029,xcecud030,xcec107,
#                         xcec108,xcec109,xcec121,xcec122,xcec123,
#                         xcec124,xcec125,xcec126,xcec127,xcec128,
#                         xcec129,xcec130)
#      VALUES(l_xcec.xcecent,l_xcec.xceccomp,l_xcec.xcecld,l_xcec.xcecdocno,l_xcec.xcecseq,
#             l_xcec.xcec001,l_xcec.xcec002,l_xcec.xcec003,l_xcec.xcec004,l_xcec.xcec005,
#             l_xcec.xcec101,l_xcec.xcec102,l_xcec.xcec103,l_xcec.xcec110,l_xcec.xcec111,
#             l_xcec.xcec112,l_xcec.xcec113,l_xcec.xcec114,l_xcec.xcec115,l_xcec.xcec116,
#             l_xcec.xcec117,l_xcec.xcec118,l_xcec.xcec119,l_xcec.xcec120,l_xcec.xcec201,
#             l_xcec.xcec202,l_xcec.xcec202a,l_xcec.xcec202b,l_xcec.xcec202c,l_xcec.xcec202d,
#             l_xcec.xcec202e,l_xcec.xcec202f,l_xcec.xcec202g,l_xcec.xcec202h,l_xcec.xcec212,
#             l_xcec.xcec212a,l_xcec.xcec212b,l_xcec.xcec212c,l_xcec.xcec212d,l_xcec.xcec212e,
#             l_xcec.xcec212f,l_xcec.xcec212g,l_xcec.xcec212h,l_xcec.xcec222,l_xcec.xcec222a,
#             l_xcec.xcec222b,l_xcec.xcec222c,l_xcec.xcec222d,l_xcec.xcec222e,l_xcec.xcec222f,
#             l_xcec.xcec222g,l_xcec.xcec222h,l_xcec.xcec301,l_xcec.xcec302,l_xcec.xcecud001,
#             l_xcec.xcecud002,l_xcec.xcecud003,l_xcec.xcecud004,l_xcec.xcecud005,l_xcec.xcecud006,
#             l_xcec.xcecud007,l_xcec.xcecud008,l_xcec.xcecud009,l_xcec.xcecud010,l_xcec.xcecud011,
#             l_xcec.xcecud012,l_xcec.xcecud013,l_xcec.xcecud014,l_xcec.xcecud015,l_xcec.xcecud016,
#             l_xcec.xcecud017,l_xcec.xcecud018,l_xcec.xcecud019,l_xcec.xcecud020,l_xcec.xcecud021,
#             l_xcec.xcecud022,l_xcec.xcecud023,l_xcec.xcecud024,l_xcec.xcecud025,l_xcec.xcecud026,
#             l_xcec.xcecud027,l_xcec.xcecud028,l_xcec.xcecud029,l_xcec.xcecud030,l_xcec.xcec107,
#             l_xcec.xcec108,l_xcec.xcec109,l_xcec.xcec121,l_xcec.xcec122,l_xcec.xcec123,
#             l_xcec.xcec124,l_xcec.xcec125,l_xcec.xcec126,l_xcec.xcec127,l_xcec.xcec128,
#             l_xcec.xcec129,l_xcec.xcec130)
#      #161109-00085#63 --e add
#      IF SQLCA.sqlcode THEN
#         INITIALIZE g_errparam TO NULL
#         LET g_errparam.code = SQLCA.sqlcode
#         LET g_errparam.extend = "ins xcec"
#         LET g_errparam.popup = TRUE
#         CALL cl_err()
#  
#         LET g_success = 'N'
#         RETURN g_success
#         EXIT FOREACH
#      END IF   
#   CLOSE xcce_prep2
#   CLOSE xcce_prep3      
#   END FOREACH 
#   
#   #拆件工單 xcch_t
#   #帳套本位幣順序+工單+主件   
#
#   LET g_sql = " SELECT SUM(xcch202a),SUM(xcch202a),",
#               "        SUM(xcch202b),SUM(xcch202c),SUM(xcch202d),SUM(xcch202e),",
#               "        SUM(xcch202f),SUM(xcch202g),SUM(xcch202h) ",
#               "   FROM xcch_t", 
#               "  WHERE xcchent = '",g_enterprise,"' AND xcchld = '",g_xcea_m.xceald,"'",
#               "    AND xcch003 = '",g_xcea_m.xcea003,"' AND xcch004 = ",g_xcea_m.xcea004,
#               "    AND xcch005 = ",g_xcea_m.xcea005,  
#               "    AND xcch006 = ? AND xcch007 = ? AND xcch008 = ? AND xcch002 = ? " 
#
#   LET g_sql1 = g_sql CLIPPED," AND xcch001 = '2' " 
#   
#   DECLARE xcch_prep2 CURSOR FROM g_sql1
#   
#   LET g_sql1 = g_sql CLIPPED," AND xcch001 = '3' " 
#   
#   DECLARE xcch_prep3 CURSOR FROM g_sql1
#
#   LET g_sql = " SELECT xcch006,xcch007,xcch008,xcch002,SUM(xcci201)+SUM(xcci301),SUM(xcci202)+SUM(xcci302),SUM(xcci202a)+SUM(xcci302a),",
#               "        SUM(xcci202b)+SUM(xcci302b),SUM(xcci202c)+SUM(xcci302c),SUM(xcci202d)+SUM(xcci302d),SUM(xcci202e)+SUM(xcci302e),",
#               "        SUM(xcci202f)+SUM(xcci302f),SUM(xcci202g)+SUM(xcci302g),SUM(xcci202h)+SUM(xcci302h) ",
#               "   FROM xcch_t,xcci_t",
#               "  WHERE xcchent = '",g_enterprise,"' AND xcchld = '",g_xcea_m.xceald,"'",
#               "    AND xcch003 = '",g_xcea_m.xcea003,"' AND xcch004 = ",g_xcea_m.xcea004,
#               "    AND xcch005 = ",g_xcea_m.xcea005,
#               "    AND xcch001 = '1' ",
#               "    AND xcchent = xccient",
#               "    AND xcchld  = xccild",
#               "    AND xcch001 = xcci001",
#              #"    AND xcch002 = xcci002",            #160813-00002#1 mark
#               "    AND xcch003 = xcci003",
#               "    AND xcch004 = xcci004",
#               "    AND xcch005 = xcci005",
#               "    AND xcch006 = xcci006",
#               "    AND xcci007 != 'DL+OH+SUB'",
#               "  GROUP BY xcch006,xcch007,xcch008,xcch002",
#               "  ORDER BY xcch006,xcch007,xcch008,xcch002 "
#   PREPARE xcch_prep FROM g_sql
#   DECLARE xcch_curs CURSOR FOR xcch_prep
#   FOREACH xcch_curs INTO l_xcch.xcch006,l_xcch.xcch007,l_xcch.xcch008,l_xcch.xcch002,l_xcch.xcch202a,l_xcch.xcch202a,
#                          l_xcch.xcch202b,l_xcch.xcch202c,l_xcch.xcch202d,l_xcch.xcch202e,l_xcch.xcch202f,
#                          l_xcch.xcch202g,l_xcch.xcch202h                         
#      IF SQLCA.sqlcode THEN
#         INITIALIZE g_errparam TO NULL
#         LET g_errparam.code = SQLCA.sqlcode
#         LET g_errparam.extend = "foreach xcch"
#         LET g_errparam.popup = TRUE
#         CALL cl_err()
#
#         EXIT FOREACH
#      END IF  
#     #160816-00015#1-s-mark 
#     #LET l_sfaa052 = ''
#     #LET l_sfaa009 = ''
#     #LET l_sfaa028 = ''
#     #LET l_sfaa029 = ''
#     #LET l_sfaa017 = '' 
#     #LET l_sfaasite =''
#     #160816-00015#1-e-mark 
#      INITIALIZE l_xceb.* TO NULL
#      
#      LET l_xceb.xceb001 = l_xcch.xcch006 #工單
#      LET l_xceb.xceb004 = l_xcch.xcch007 #主件
#      LET l_xceb.xceb005 = l_xcch.xcch008 #特性
#      LET l_xceb.xceb103 = l_xcch.xcch002 #成本域
# 
#      #本位幣一
#      IF cl_null(l_xcch.xcch202a) THEN LET l_xcch.xcch202a = 0 END IF
#      IF cl_null(l_xcch.xcch204a) THEN LET l_xcch.xcch204a = 0 END IF
#      
#      LET l_xceb.xceb202a = l_xcch.xcch202a + l_xcch.xcch204a
#      LET l_xceb.xceb202b = l_xcch.xcch204b   
#      LET l_xceb.xceb202c = l_xcch.xcch204c 
#      LET l_xceb.xceb202d = l_xcch.xcch204d 
#      LET l_xceb.xceb202e = l_xcch.xcch204e 
#      LET l_xceb.xceb202f = l_xcch.xcch204f 
#      LET l_xceb.xceb202g = l_xcch.xcch204g 
#      LET l_xceb.xceb202h = l_xcch.xcch204h 
#      
#      IF cl_null(l_xceb.xceb201)  THEN LET l_xceb.xceb201  = 0 END IF
#      IF cl_null(l_xceb.xceb202a) THEN LET l_xceb.xceb202a = 0 END IF
#      IF cl_null(l_xceb.xceb202b) THEN LET l_xceb.xceb202b = 0 END IF
#      IF cl_null(l_xceb.xceb202c) THEN LET l_xceb.xceb202c = 0 END IF
#      IF cl_null(l_xceb.xceb202d) THEN LET l_xceb.xceb202d = 0 END IF
#      IF cl_null(l_xceb.xceb202e) THEN LET l_xceb.xceb202e = 0 END IF
#      IF cl_null(l_xceb.xceb202f) THEN LET l_xceb.xceb202f = 0 END IF
#      IF cl_null(l_xceb.xceb202g) THEN LET l_xceb.xceb202g = 0 END IF
#      IF cl_null(l_xceb.xceb202h) THEN LET l_xceb.xceb202h = 0 END IF
#      
#      
#      LET l_xceb.xceb202  = l_xceb.xceb202a + l_xceb.xceb202b + l_xceb.xceb202c + l_xceb.xceb202d +
#                            l_xceb.xceb202e + l_xceb.xceb202f + l_xceb.xceb202g + l_xceb.xceb202h           
#      
#      IF cl_null(l_xceb.xceb202)  THEN LET l_xceb.xceb202  = 0 END IF  
#
#     IF g_glaa015 ='Y' THEN
#     #本位幣二
#         OPEN xcch_prep2 USING l_xcch.xcch006,l_xcch.xcch007,l_xcch.xcch008,l_xcch.xcch002
#         FETCH xcch_prep2 INTO l_xcch.xcch202a,l_xcch.xcch204a,l_xcch.xcch204b,l_xcch.xcch204c,l_xcch.xcch204d,
#                               l_xcch.xcch204e,l_xcch.xcch204f,l_xcch.xcch204g,l_xcch.xcch204h
#         IF SQLCA.sqlcode THEN
#            INITIALIZE g_errparam TO NULL
#            LET g_errparam.code = SQLCA.sqlcode
#            LET g_errparam.extend = "xcch_prep2"
#            LET g_errparam.popup = TRUE
#            CALL cl_err()
#         
#            LET g_success = 'N'
#            RETURN g_success
#            EXIT FOREACH
#         END IF 
#         
#         IF cl_null(l_xcch.xcch202a) THEN LET l_xcch.xcch202a = 0 END IF
#         IF cl_null(l_xcch.xcch204a) THEN LET l_xcch.xcch204a = 0 END IF
#                          
#         LET l_xceb.xceb212a = l_xcch.xcch202a + l_xcch.xcch204a
#         LET l_xceb.xceb212b = l_xcch.xcch204b   
#         LET l_xceb.xceb212c = l_xcch.xcch204c 
#         LET l_xceb.xceb212d = l_xcch.xcch204d 
#         LET l_xceb.xceb212e = l_xcch.xcch204e 
#         LET l_xceb.xceb212f = l_xcch.xcch204f 
#         LET l_xceb.xceb212g = l_xcch.xcch204g 
#         LET l_xceb.xceb212h = l_xcch.xcch204h 
#         
#         IF cl_null(l_xceb.xceb212a) THEN LET l_xceb.xceb212a = 0 END IF
#         IF cl_null(l_xceb.xceb212b) THEN LET l_xceb.xceb212b = 0 END IF
#         IF cl_null(l_xceb.xceb212c) THEN LET l_xceb.xceb212c = 0 END IF
#         IF cl_null(l_xceb.xceb212d) THEN LET l_xceb.xceb212d = 0 END IF
#         IF cl_null(l_xceb.xceb212e) THEN LET l_xceb.xceb212e = 0 END IF
#         IF cl_null(l_xceb.xceb212f) THEN LET l_xceb.xceb212f = 0 END IF
#         IF cl_null(l_xceb.xceb212g) THEN LET l_xceb.xceb212g = 0 END IF
#         IF cl_null(l_xceb.xceb212h) THEN LET l_xceb.xceb212h = 0 END IF
#         
#         
#         LET l_xceb.xceb212  = l_xceb.xceb212a + l_xceb.xceb212b + l_xceb.xceb212c + l_xceb.xceb212d +
#                               l_xceb.xceb212e + l_xceb.xceb212f + l_xceb.xceb212g + l_xceb.xceb212h
#         IF cl_null(l_xceb.xceb212)  THEN LET l_xceb.xceb212  = 0 END IF                               
#      ELSE
#         LET l_xceb.xceb212a = 0
#         LET l_xceb.xceb212b = 0
#         LET l_xceb.xceb212c = 0
#         LET l_xceb.xceb212d = 0
#         LET l_xceb.xceb212e = 0
#         LET l_xceb.xceb212f = 0
#         LET l_xceb.xceb212g = 0
#         LET l_xceb.xceb212h = 0
#         LET l_xceb.xceb212  = 0     
#      END IF      
# 
#      #本位幣三
#      IF g_glaa019 ='Y' THEN
#         OPEN xcch_prep3 USING l_xcch.xcch006,l_xcch.xcch007,l_xcch.xcch008,l_xcch.xcch002
#         FETCH xcch_prep3 INTO l_xcch.xcch202a,l_xcch.xcch204a,l_xcch.xcch204b,l_xcch.xcch204c,l_xcch.xcch204d,
#                               l_xcch.xcch204e,l_xcch.xcch204f,l_xcch.xcch204g,l_xcch.xcch204h
#         IF SQLCA.sqlcode THEN
#            INITIALIZE g_errparam TO NULL
#            LET g_errparam.code = SQLCA.sqlcode
#            LET g_errparam.extend = "xcch_prep3"
#            LET g_errparam.popup = TRUE
#            CALL cl_err()
#         
#            LET g_success = 'N'
#            RETURN g_success
#            EXIT FOREACH
#         END IF   
#         
#         IF cl_null(l_xcch.xcch202a) THEN LET l_xcch.xcch202a = 0 END IF
#         IF cl_null(l_xcch.xcch204a) THEN LET l_xcch.xcch204a = 0 END IF
#         
#         
#         LET l_xceb.xceb222a = l_xcch.xcch202a + l_xcch.xcch204a
#         LET l_xceb.xceb222b = l_xcch.xcch204b   
#         LET l_xceb.xceb222c = l_xcch.xcch204c 
#         LET l_xceb.xceb222d = l_xcch.xcch204d 
#         LET l_xceb.xceb222e = l_xcch.xcch204e 
#         LET l_xceb.xceb222f = l_xcch.xcch204f 
#         LET l_xceb.xceb222g = l_xcch.xcch204g 
#         LET l_xceb.xceb222h = l_xcch.xcch204h
#         
#         IF cl_null(l_xceb.xceb222a) THEN LET l_xceb.xceb222a = 0 END IF
#         IF cl_null(l_xceb.xceb222b) THEN LET l_xceb.xceb222b = 0 END IF
#         IF cl_null(l_xceb.xceb222c) THEN LET l_xceb.xceb222c = 0 END IF
#         IF cl_null(l_xceb.xceb222d) THEN LET l_xceb.xceb222d = 0 END IF
#         IF cl_null(l_xceb.xceb222e) THEN LET l_xceb.xceb222e = 0 END IF
#         IF cl_null(l_xceb.xceb222f) THEN LET l_xceb.xceb222f = 0 END IF
#         IF cl_null(l_xceb.xceb222g) THEN LET l_xceb.xceb222g = 0 END IF
#         IF cl_null(l_xceb.xceb222h) THEN LET l_xceb.xceb222h = 0 END IF
#         
#         
#         LET l_xceb.xceb222  = l_xceb.xceb222a + l_xceb.xceb222b + l_xceb.xceb222c + l_xceb.xceb222d +
#                               l_xceb.xceb222e + l_xceb.xceb222f + l_xceb.xceb222g + l_xceb.xceb222h       
#            
#         IF cl_null(l_xceb.xceb222)  THEN LET l_xceb.xceb222  = 0 END IF 
#      ELSE
#         LET l_xceb.xceb222a = 0
#         LET l_xceb.xceb222b = 0
#         LET l_xceb.xceb222c = 0
#         LET l_xceb.xceb222d = 0
#         LET l_xceb.xceb222e = 0
#         LET l_xceb.xceb222f = 0
#         LET l_xceb.xceb222g = 0
#         LET l_xceb.xceb222h = 0
#         LET l_xceb.xceb222  = 0     
#      END IF
#
#      #項次
#      SELECT MAX(xcebseq) INTO l_xceb.xcebseq FROM xceb_t
#       WHERE xcebent = g_enterprise 
#         AND xcebld = g_xcea_m.xceald
#         AND xcebdocno = g_xcea_m.xceadocno
#      IF cl_null(l_xceb.xcebseq) OR l_xceb.xcebseq = 0 THEN
#         LET l_xceb.xcebseq = 1
#      ELSE
#         LET l_xceb.xcebseq = l_xceb.xcebseq + 1
#      END IF   
#
#     #160816-00015#1-s-add
#      LET l_sfaa057 = ''
#      LET l_sfaa052 = ''
#      LET l_sfaa009 = ''
#      LET l_sfaa017 = ''
#      LET l_sfaa028 = ''
#      LET l_sfaa029 = ''
#      LET l_sfaasite = ''
#      LET l_sfaa068 = ''
#      
#      EXECUTE axct701_01_sfaa_prep_01 USING l_xceb.xceb001 INTO l_xceb.xceb003,l_sfaa052,l_sfaa009,l_sfaasite,l_sfaa017,    
#                                                                l_sfaa028,l_sfaa029,l_sfaa057,l_sfaa068  
#     #160816-00015#1-e-add
#     
#     #160816-00015#1-s-mark 
#     ##工單類型
#     #SELECT sfaa003,sfaa057 INTO l_xceb.xceb003,l_sfaa057 FROM sfaa_t   #150906-00001#2 add sfaa057
#     # WHERE sfaaent = g_enterprise 
#     #   AND sfaadocno = l_xceb.xceb001
#     #160816-00015#1-e-mark    
#      #150906-00001#2-s
#      IF l_sfaa057 = '2' THEN
#         CALL s_get_item_acc(g_xcea_m.xceald,'24',l_xceb.xceb004,'','',g_xcea_m.xceacomp,'') 
#           RETURNING l_success,l_xceb.xceb101
#      ELSE   
#      #150906-00001#2-e      
#         #在制科目
#         CALL s_get_item_acc(g_xcea_m.xceald,'3',l_xceb.xceb004,'','',g_xcea_m.xceacomp,'') 
#           RETURNING l_success,l_xceb.xceb101  
#      END IF  #150906-00001#2
##agli161抓不到，改抓axci201的科目
#      IF cl_null(l_xceb.xceb101) THEN
#         CALL s_fin_get_account(g_xcea_m.xceald,'60','8912','1') RETURNING l_success,l_xceb.xceb101,l_errno
#      END IF
#      
#      LET l_xceb.xceb102 = ''  #摘要
#      LET l_xceb.xceb115 = ''  #經營類別
#      LET l_xceb.xceb116 = ''  #渠道
#      LET l_xceb.xceb118 = ''  #品牌
#     #160816-00015#1-s-mark 
#     ##交易對象
#     #SELECT sfaa052,sfaa009,sfaasite INTO l_sfaa052,l_sfaa009,l_sfaasite FROM sfaa_t
#     # WHERE sfaaent = g_enterprise 
#     #   AND sfaadocno = l_xceb.xceb001
#     #160816-00015#1-e-mark    
#      IF l_sfaa052 = '2' THEN #委外
#         LET l_xceb.xceb111 = l_sfaa009
#         #客群/區域
#         SELECT pmaa090,pmaa241 INTO l_xceb.xceb112,l_xceb.xceb113 
#           FROM pmaa_t 
#          WHERE pmaaent = g_enterprise 
#            AND pmaa001 = l_xceb.xceb111
#      ELSE
#         LET l_xceb.xceb111 = ' '
#         #客群
#         LET l_xceb.xceb112 = ' '
#         #區域
#         SELECT ooef153 INTO l_xceb.xceb113 FROM ooef_t
#          WHERE ooefent = g_enterprise
#            AND ooef001 = l_sfaasite
#      END IF        
#     #160816-00015#1-s-mark
#     ##成本中心--暫用部門sfaa017抓取其歸屬成本中心
#     #SELECT sfaa017 INTO l_sfaa017 FROM sfaa_t
#     # WHERE sfaaent = g_enterprise 
#     #   AND sfaadocno = l_xceb.xceb001
#     #160816-00015#1-e-mark 
#      SELECT ooeg004 INTO l_xceb.xceb114 FROM ooeg_t
#       WHERE ooegent = g_enterprise AND ooeg001 = l_sfaa017  
#       
#      #品類
#      SELECT imag011 INTO l_xceb.xceb117 FROM imag_t
#       WHERE imagent = g_enterprise AND imagsite = g_xcea_m.xceacomp 
#         AND imag001 = l_xceb.xceb004   
#     #160816-00015#1-s-mark
#     ##項目編號+WBS
#     #SELECT sfaa028,sfaa029 INTO l_sfaa028,l_sfaa029 FROM sfaa_t
#     # WHERE sfaaent = g_enterprise 
#     #   AND sfaadocno = l_xceb.xceb001
#     #160816-00015#1-e-mark 
#      LET l_xceb.xcebent = g_enterprise 
#      LET l_xceb.xcebcomp = g_xcea_m.xceacomp
#      LET l_xceb.xcebld = g_xcea_m.xceald
#      LET l_xceb.xcebdocno = g_xcea_m.xceadocno
#      #摘要
#      IF cl_null(l_xceb.xceb102) THEN
#         CALL axct701_01_get_summ(g_xcea_m.xceald,'61','8925','1') RETURNING l_success,l_xceb.xceb102
#      END IF
#      
#     #160816-00015#1-s-add
#      IF NOT cl_null(l_sfaa068) THEN
#         LET l_xceb.xceb108 = l_sfaa068   
#      ELSE
#         LET l_xceb.xceb108 = ' '
#      END IF      
#     #160816-00015#1-e-add  
#     
#      CALL axct701_01_default_space_xceb(l_xceb.*) RETURNING l_xceb.xceb005,
#                                                             l_xceb.xceb101,
#                                                             l_xceb.xceb102,
#                                                             l_xceb.xceb103,
#                                                             l_xceb.xceb110,
#                                                             l_xceb.xceb111,
#                                                             l_xceb.xceb112,
#                                                             l_xceb.xceb113,
#                                                             l_xceb.xceb114,
#                                                             l_xceb.xceb115,
#                                                             l_xceb.xceb116,
#                                                             l_xceb.xceb117,
#                                                             l_xceb.xceb118,
#                                                             l_xceb.xceb119,
#                                                             l_xceb.xceb120,
#                                                             l_xceb.xceb107,
#                                                             l_xceb.xceb108,
#                                                             l_xceb.xceb109,
#                                                             l_xceb.xceb121,
#                                                             l_xceb.xceb122,
#                                                             l_xceb.xceb123,
#                                                             l_xceb.xceb124,
#                                                             l_xceb.xceb125,
#                                                             l_xceb.xceb126,
#                                                             l_xceb.xceb127,
#                                                             l_xceb.xceb128,
#                                                             l_xceb.xceb129,
#                                                             l_xceb.xceb130
##如果金额和数量都为0的话，则不产生此笔单身数据                                                             
#      IF l_xceb.xceb201= 0 AND l_xceb.xceb202 = 0 THEN
#         CONTINUE FOREACH
#      END IF 
#      
#      #161109-00085#20-s mod
##      INSERT INTO xceb_t VALUES(l_xceb.*)   #161109-00085#20-s mark
#      #161109-00085#63 --s mark
#      #INSERT INTO xceb_t(xcebent,xcebcomp,xcebld,xcebdocno,xcebseq,xceb001,xceb002,xceb003,xceb004,
#      #                   xceb005,xceb101,xceb102,xceb103,xceb110,xceb111,xceb112,xceb113,xceb114,xceb115,
#      #                   xceb116,xceb117,xceb118,xceb119,xceb120,xceb201,xceb202,xceb202a,xceb202b,xceb202c,
#      #                   xceb202d,xceb202e,xceb202f,xceb202g,xceb202h,xceb212,xceb212a,xceb212b,xceb212c,
#      #                   xceb212d,xceb212e,xceb212f,xceb212g,xceb212h,xceb222,xceb222a,xceb222b,xceb222c,
#      #                   xceb222d,xceb222e,xceb222f,xceb222g,xceb222h,xceb301,xceb302,xceb107,xceb108,xceb109,
#      #                   xceb121,xceb122,xceb123,xceb124,xceb125,xceb126,xceb127,xceb128,xceb129,xceb130,xceb131,xceb132) 
#      #            VALUES(l_xceb.xcebent,l_xceb.xcebcomp,l_xceb.xcebld,l_xceb.xcebdocno,l_xceb.xcebseq,
#      #                   l_xceb.xceb001,l_xceb.xceb002,l_xceb.xceb003,l_xceb.xceb004,l_xceb.xceb005,
#      #                   l_xceb.xceb101,l_xceb.xceb102,l_xceb.xceb103,l_xceb.xceb110,l_xceb.xceb111,
#      #                   l_xceb.xceb112,l_xceb.xceb113,l_xceb.xceb114,l_xceb.xceb115,l_xceb.xceb116,
#      #                   l_xceb.xceb117,l_xceb.xceb118,l_xceb.xceb119,l_xceb.xceb120,l_xceb.xceb201,
#      #                   l_xceb.xceb202,l_xceb.xceb202a,l_xceb.xceb202b,l_xceb.xceb202c,l_xceb.xceb202d,
#      #                   l_xceb.xceb202e,l_xceb.xceb202f,l_xceb.xceb202g,l_xceb.xceb202h,l_xceb.xceb212,
#      #                   l_xceb.xceb212a,l_xceb.xceb212b,l_xceb.xceb212c,l_xceb.xceb212d,l_xceb.xceb212e,
#      #                   l_xceb.xceb212f,l_xceb.xceb212g,l_xceb.xceb212h,l_xceb.xceb222,l_xceb.xceb222a,
#      #                   l_xceb.xceb222b,l_xceb.xceb222c,l_xceb.xceb222d,l_xceb.xceb222e,l_xceb.xceb222f,
#      #                   l_xceb.xceb222g,l_xceb.xceb222h,l_xceb.xceb301,l_xceb.xceb302,l_xceb.xceb107,
#      #                   l_xceb.xceb108,l_xceb.xceb109,l_xceb.xceb121,l_xceb.xceb122,l_xceb.xceb123,
#      #                   l_xceb.xceb124,l_xceb.xceb125,l_xceb.xceb126,l_xceb.xceb127,l_xceb.xceb128,
#      #                   l_xceb.xceb129,l_xceb.xceb130,l_xceb.xceb131,l_xceb.xceb132)
#      #161109-00085#20-e mod
#      #161109-00085#63 --e mark
#      #161109-00085#63 --s add
#      INSERT INTO xceb_t(xcebent,xcebcomp,xcebld,xcebdocno,xcebseq,
#                         xceb001,xceb002,xceb003,xceb004,xceb005,
#                         xceb101,xceb102,xceb103,xceb110,xceb111,
#                         xceb112,xceb113,xceb114,xceb115,xceb116,
#                         xceb117,xceb118,xceb119,xceb120,xceb201,
#                         xceb202,xceb202a,xceb202b,xceb202c,xceb202d,
#                         xceb202e,xceb202f,xceb202g,xceb202h,xceb212,
#                         xceb212a,xceb212b,xceb212c,xceb212d,xceb212e,
#                         xceb212f,xceb212g,xceb212h,xceb222,xceb222a,
#                         xceb222b,xceb222c,xceb222d,xceb222e,xceb222f,
#                         xceb222g,xceb222h,xceb301,xceb302,xcebud001,
#                         xcebud002,xcebud003,xcebud004,xcebud005,xcebud006,
#                         xcebud007,xcebud008,xcebud009,xcebud010,xcebud011,
#                         xcebud012,xcebud013,xcebud014,xcebud015,xcebud016,
#                         xcebud017,xcebud018,xcebud019,xcebud020,xcebud021,
#                         xcebud022,xcebud023,xcebud024,xcebud025,xcebud026,
#                         xcebud027,xcebud028,xcebud029,xcebud030,xceb107,
#                         xceb108,xceb109,xceb121,xceb122,xceb123,
#                         xceb124,xceb125,xceb126,xceb127,xceb128,
#                         xceb129,xceb130,xceb131,xceb132)
#      VALUES(l_xceb.xcebent,l_xceb.xcebcomp,l_xceb.xcebld,l_xceb.xcebdocno,l_xceb.xcebseq,
#             l_xceb.xceb001,l_xceb.xceb002,l_xceb.xceb003,l_xceb.xceb004,l_xceb.xceb005,
#             l_xceb.xceb101,l_xceb.xceb102,l_xceb.xceb103,l_xceb.xceb110,l_xceb.xceb111,
#             l_xceb.xceb112,l_xceb.xceb113,l_xceb.xceb114,l_xceb.xceb115,l_xceb.xceb116,
#             l_xceb.xceb117,l_xceb.xceb118,l_xceb.xceb119,l_xceb.xceb120,l_xceb.xceb201,
#             l_xceb.xceb202,l_xceb.xceb202a,l_xceb.xceb202b,l_xceb.xceb202c,l_xceb.xceb202d,
#             l_xceb.xceb202e,l_xceb.xceb202f,l_xceb.xceb202g,l_xceb.xceb202h,l_xceb.xceb212,
#             l_xceb.xceb212a,l_xceb.xceb212b,l_xceb.xceb212c,l_xceb.xceb212d,l_xceb.xceb212e,
#             l_xceb.xceb212f,l_xceb.xceb212g,l_xceb.xceb212h,l_xceb.xceb222,l_xceb.xceb222a,
#             l_xceb.xceb222b,l_xceb.xceb222c,l_xceb.xceb222d,l_xceb.xceb222e,l_xceb.xceb222f,
#             l_xceb.xceb222g,l_xceb.xceb222h,l_xceb.xceb301,l_xceb.xceb302,l_xceb.xcebud001,
#             l_xceb.xcebud002,l_xceb.xcebud003,l_xceb.xcebud004,l_xceb.xcebud005,l_xceb.xcebud006,
#             l_xceb.xcebud007,l_xceb.xcebud008,l_xceb.xcebud009,l_xceb.xcebud010,l_xceb.xcebud011,
#             l_xceb.xcebud012,l_xceb.xcebud013,l_xceb.xcebud014,l_xceb.xcebud015,l_xceb.xcebud016,
#             l_xceb.xcebud017,l_xceb.xcebud018,l_xceb.xcebud019,l_xceb.xcebud020,l_xceb.xcebud021,
#             l_xceb.xcebud022,l_xceb.xcebud023,l_xceb.xcebud024,l_xceb.xcebud025,l_xceb.xcebud026,
#             l_xceb.xcebud027,l_xceb.xcebud028,l_xceb.xcebud029,l_xceb.xcebud030,l_xceb.xceb107,
#             l_xceb.xceb108,l_xceb.xceb109,l_xceb.xceb121,l_xceb.xceb122,l_xceb.xceb123,
#             l_xceb.xceb124,l_xceb.xceb125,l_xceb.xceb126,l_xceb.xceb127,l_xceb.xceb128,
#             l_xceb.xceb129,l_xceb.xceb130,l_xceb.xceb131,l_xceb.xceb132)
#      #161109-00085#63 --e add
#      IF SQLCA.sqlcode THEN
#         INITIALIZE g_errparam TO NULL
#         LET g_errparam.code = SQLCA.sqlcode
#         LET g_errparam.extend = "ins xceb"
#         LET g_errparam.popup = TRUE
#         CALL cl_err()
#  
#         LET g_success = 'N'
#         RETURN g_success
#         EXIT FOREACH
#      END IF      
#   CLOSE xcch_prep2
#   CLOSE xcch_prep3      
#   END FOREACH     
#
#
#   #拆件工單 xcci_t
#   #帳套本位幣順序+工單+元件
#   LET g_sql = " SELECT SUM(xcci202),SUM(xcci202a), ",
#               "        SUM(xcci202b),SUM(xcci202c),SUM(xcci202d),SUM(xcci202e),",
#               "        SUM(xcci202f),SUM(xcci202g),SUM(xcci202h) ",
#               "   FROM xcci_t", 
#               "  WHERE xccient = '",g_enterprise,"' AND xccild = '",g_xcea_m.xceald,"'",
#               "    AND xcci003 = '",g_xcea_m.xcea003,"' AND xcci004 = ",g_xcea_m.xcea004,
#               "    AND xcci005 = ",g_xcea_m.xcea005,  
#               "    AND xcci007 != 'DL+OH+SUB'",
#               "    AND xcci006 = ? AND xcci007 = ? AND xcci008 = ? AND xcci002 = ? AND xcci009 = ?  " 
#
#   LET g_sql1 = g_sql CLIPPED," AND xcci001 = '2' " 
#   
#   DECLARE xcci_prep2 CURSOR FROM g_sql1
#   
#   LET g_sql1 = g_sql CLIPPED," AND xcci001 = '3' " 
#   
#   DECLARE xcci_prep3 CURSOR FROM g_sql1
#
#   LET g_sql = " SELECT xcci006,xcci007,xcci008,xcci002,xcci009,SUM(xcci201)+SUM(xcci301),SUM(xcci202)+SUM(xcci302),SUM(xcci202a)+SUM(xcci302a),",
#               "        SUM(xcci202b)+SUM(xcci302b),SUM(xcci202c)+SUM(xcci302c),SUM(xcci202d)+SUM(xcci302d),SUM(xcci202e)+SUM(xcci302e),",
#               "        SUM(xcci202f)+SUM(xcci302f),SUM(xcci202g)+SUM(xcci302g),SUM(xcci202h)+SUM(xcci302h) ",
#               "   FROM xcci_t",
#               "  WHERE xccient = '",g_enterprise,"' AND xccild = '",g_xcea_m.xceald,"'",
#               "    AND xcci003 = '",g_xcea_m.xcea003,"' AND xcci004 = ",g_xcea_m.xcea004,
#               "    AND xcci005 = ",g_xcea_m.xcea005,
#               "    AND xcci007 != 'DL+OH+SUB'",
#               "    AND xcci001 = '1' ",
#               "  GROUP BY xcci006,xcci007,xcci008,xcci002,xcci009 ",
#               "  ORDER BY xcci006,xcci007,xcci008,xcci002,xcci009 "
#   PREPARE xcci_prep FROM g_sql
#   DECLARE xcci_curs CURSOR FOR xcci_prep
#   FOREACH xcci_curs INTO l_xcci.xcci006,l_xcci.xcci007,l_xcci.xcci008,l_xcci.xcci002,l_xcci.xcci009,
#                          l_xcci.xcci201,l_xcci.xcci202,l_xcci.xcci202a,
#                          l_xcci.xcci202b,l_xcci.xcci202c,l_xcci.xcci202d,l_xcci.xcci202e,l_xcci.xcci202f,
#                          l_xcci.xcci202g,l_xcci.xcci202h                          
#      IF SQLCA.sqlcode THEN
#         INITIALIZE g_errparam TO NULL
#         LET g_errparam.code = SQLCA.sqlcode
#         LET g_errparam.extend = "foreach xcci"
#         LET g_errparam.popup = TRUE
#         CALL cl_err()
#
#         EXIT FOREACH
#      END IF  
#     #160816-00015#1-s-mark 
#     #LET l_sfaa052 = ''
#     #LET l_sfaa009 = ''
#     #LET l_sfaa028 = ''
#     #LET l_sfaa029 = ''
#     #LET l_sfaa017 = ''      
#     #LET l_sfaasite =''
#     #160816-00015#1-s-mark  
#      
#      INITIALIZE l_xcec.* TO NULL      
#        
#      LET l_xcec.xcec001 = l_xcci.xcci006 #工單
#      LET l_xcec.xcec004 = l_xcci.xcci007 #主件
#      LET l_xcec.xcec005 = l_xcci.xcci008 #特性
#      LET l_xcec.xcec103 = l_xcci.xcci002 #成本域
#      
#      #本位幣一
#      LET l_xcec.xcec201 =  l_xcci.xcci201 #投入數量
#      LET l_xcec.xcec202a = l_xcci.xcci202a 
#      LET l_xcec.xcec202b = l_xcci.xcci202b   
#      LET l_xcec.xcec202c = l_xcci.xcci202c 
#      LET l_xcec.xcec202d = l_xcci.xcci202d 
#      LET l_xcec.xcec202e = l_xcci.xcci202e 
#      LET l_xcec.xcec202f = l_xcci.xcci202f 
#      LET l_xcec.xcec202g = l_xcci.xcci202g 
#      LET l_xcec.xcec202h = l_xcci.xcci202h 
#      LET l_xcec.xcec202  = l_xcci.xcci202   
#   
#      IF cl_null(l_xcec.xcec201)  THEN LET l_xcec.xcec201  = 0 END IF
#      IF cl_null(l_xcec.xcec202a) THEN LET l_xcec.xcec202a = 0 END IF
#      IF cl_null(l_xcec.xcec202b) THEN LET l_xcec.xcec202b = 0 END IF
#      IF cl_null(l_xcec.xcec202c) THEN LET l_xcec.xcec202c = 0 END IF
#      IF cl_null(l_xcec.xcec202d) THEN LET l_xcec.xcec202d = 0 END IF
#      IF cl_null(l_xcec.xcec202e) THEN LET l_xcec.xcec202e = 0 END IF
#      IF cl_null(l_xcec.xcec202f) THEN LET l_xcec.xcec202f = 0 END IF
#      IF cl_null(l_xcec.xcec202g) THEN LET l_xcec.xcec202g = 0 END IF
#      IF cl_null(l_xcec.xcec202h) THEN LET l_xcec.xcec202h = 0 END IF
#      IF cl_null(l_xcec.xcec202)  THEN LET l_xcec.xcec202  = 0 END IF
#
#
#      #本位幣二
#      IF g_glaa015 ='Y' THEN
#         OPEN xcci_prep2 USING l_xcci.xcci006,l_xcci.xcci007,l_xcci.xcci008,l_xcci.xcci002,l_xcci.xcci009
#         FETCH xcci_prep2 INTO l_xcec.xcec212,l_xcec.xcec212a,l_xcec.xcec212b,l_xcec.xcec212c,l_xcec.xcec212d,
#                               l_xcec.xcec212e,l_xcec.xcec212f,l_xcec.xcec212g,l_xcec.xcec212h 
#         IF SQLCA.sqlcode THEN
#            INITIALIZE g_errparam TO NULL
#            LET g_errparam.code = SQLCA.sqlcode
#            LET g_errparam.extend = "xcci_prep2"
#            LET g_errparam.popup = TRUE
#            CALL cl_err()
#         
#            LET g_success = 'N'
#            RETURN g_success
#            EXIT FOREACH
#         END IF   
#         
#         IF cl_null(l_xcec.xcec212a) THEN LET l_xcec.xcec212a = 0 END IF
#         IF cl_null(l_xcec.xcec212b) THEN LET l_xcec.xcec212b = 0 END IF
#         IF cl_null(l_xcec.xcec212c) THEN LET l_xcec.xcec212c = 0 END IF
#         IF cl_null(l_xcec.xcec212d) THEN LET l_xcec.xcec212d = 0 END IF
#         IF cl_null(l_xcec.xcec212e) THEN LET l_xcec.xcec212e = 0 END IF
#         IF cl_null(l_xcec.xcec212f) THEN LET l_xcec.xcec212f = 0 END IF
#         IF cl_null(l_xcec.xcec212g) THEN LET l_xcec.xcec212g = 0 END IF
#         IF cl_null(l_xcec.xcec212h) THEN LET l_xcec.xcec212h = 0 END IF
#         IF cl_null(l_xcec.xcec212)  THEN LET l_xcec.xcec212  = 0 END IF
#      ELSE
#         LET l_xceb.xceb212a = 0
#         LET l_xceb.xceb212b = 0
#         LET l_xceb.xceb212c = 0
#         LET l_xceb.xceb212d = 0
#         LET l_xceb.xceb212e = 0
#         LET l_xceb.xceb212f = 0
#         LET l_xceb.xceb212g = 0
#         LET l_xceb.xceb212h = 0
#         LET l_xceb.xceb212  = 0     
#      END IF
#
#      #本位幣三
#      IF g_glaa019 ='Y' THEN
#         OPEN xcci_prep3 USING l_xcci.xcci006,l_xcci.xcci007,l_xcci.xcci008,l_xcci.xcci002,l_xcci.xcci009
#         FETCH xcci_prep3 INTO l_xcec.xcec222,l_xcec.xcec222a,l_xcec.xcec222b,l_xcec.xcec222c,l_xcec.xcec222d,
#                               l_xcec.xcec222e,l_xcec.xcec222f,l_xcec.xcec222g,l_xcec.xcec222h
#         
#         IF SQLCA.sqlcode THEN
#            INITIALIZE g_errparam TO NULL
#            LET g_errparam.code = SQLCA.sqlcode
#            LET g_errparam.extend = "xcci_prep3"
#            LET g_errparam.popup = TRUE
#            CALL cl_err()
#         
#            LET g_success = 'N'
#            RETURN g_success
#            EXIT FOREACH
#         END IF                               
#         
#         
#         IF cl_null(l_xcec.xcec222a) THEN LET l_xcec.xcec222a = 0 END IF
#         IF cl_null(l_xcec.xcec222b) THEN LET l_xcec.xcec222b = 0 END IF
#         IF cl_null(l_xcec.xcec222c) THEN LET l_xcec.xcec222c = 0 END IF
#         IF cl_null(l_xcec.xcec222d) THEN LET l_xcec.xcec222d = 0 END IF
#         IF cl_null(l_xcec.xcec222e) THEN LET l_xcec.xcec222e = 0 END IF
#         IF cl_null(l_xcec.xcec222f) THEN LET l_xcec.xcec222f = 0 END IF
#         IF cl_null(l_xcec.xcec222g) THEN LET l_xcec.xcec222g = 0 END IF
#         IF cl_null(l_xcec.xcec222h) THEN LET l_xcec.xcec222h = 0 END IF
#         IF cl_null(l_xcec.xcec222)  THEN LET l_xcec.xcec222  = 0 END IF
#      ELSE
#         LET l_xceb.xceb222a = 0
#         LET l_xceb.xceb222b = 0
#         LET l_xceb.xceb222c = 0
#         LET l_xceb.xceb222d = 0
#         LET l_xceb.xceb222e = 0
#         LET l_xceb.xceb222f = 0
#         LET l_xceb.xceb222g = 0
#         LET l_xceb.xceb222h = 0
#         LET l_xceb.xceb222  = 0     
#      END IF
#
#      #項次
#      SELECT MAX(xcecseq) INTO l_xcec.xcecseq FROM xcec_t
#       WHERE xcecent = g_enterprise 
#         AND xcecld = g_xcea_m.xceald
#         AND xcecdocno = g_xcea_m.xceadocno
#      IF cl_null(l_xcec.xcecseq) OR l_xcec.xcecseq = 0 THEN
#         LET l_xcec.xcecseq = 1
#      ELSE
#         LET l_xcec.xcecseq = l_xcec.xcecseq + 1
#      END IF 
#
#     #160816-00015#1-s-add
#      LET l_sfaa057 = ''
#      LET l_sfaa052 = ''
#      LET l_sfaa009 = ''
#      LET l_sfaa017 = ''
#      LET l_sfaa028 = ''
#      LET l_sfaa029 = ''
#      LET l_sfaasite = ''
#      LET l_sfaa068 = ''
#      
#      EXECUTE axct701_01_sfaa_prep_01 USING l_xcec.xcec001 INTO l_xcec.xcec003,l_sfaa052,l_sfaa009,l_sfaasite,l_sfaa017,    
#                                                                l_sfaa028,l_sfaa029,l_sfaa057,l_sfaa068  
#     #160816-00015#1-e-add
#     
#     #160816-00015#1-s-mark  
#     ##工單類型
#     #SELECT sfaa003 INTO l_xcec.xcec003 FROM sfaa_t
#     # WHERE sfaaent = g_enterprise 
#     #   AND sfaadocno = l_xcec.xcec001
#     #160816-00015#1-e-mark 
#      #存貨科目
#      CALL s_get_item_acc(g_xcea_m.xceald,'1',l_xcec.xcec004,'','',g_xcea_m.xceacomp,'') 
#        RETURNING l_success,l_xcec.xcec101 
#
#      LET l_xcec.xcec102 = ''  #摘要
#      LET l_xcec.xcec115 = ''  #經營類別
#      LET l_xcec.xcec116 = ''  #渠道
#      LET l_xcec.xcec118 = ''  #品牌
#     
#     #160816-00015#1-s-mark      
#     ##交易對象
#     #SELECT sfaa052,sfaa009,sfaasite INTO l_sfaa052,l_sfaa009,l_sfaasite FROM sfaa_t
#     # WHERE sfaaent = g_enterprise 
#     #   AND sfaadocno = l_xcec.xcec001
#     #160816-00015#1-s-mark    
#      IF l_sfaa052 = '2' THEN #委外
#         LET l_xcec.xcec111 = l_sfaa009
#         #客群/區域
#         SELECT pmaa090,pmaa241 INTO l_xcec.xcec112,l_xcec.xcec113 
#           FROM pmaa_t 
#          WHERE pmaaent = g_enterprise 
#            AND pmaa001 = l_xcec.xcec111
#      ELSE
#         LET l_xcec.xcec111 = ' '
#         #客群
#         LET l_xcec.xcec112 = ' '
#         #區域
#         SELECT ooef153 INTO l_xcec.xcec113 FROM ooef_t
#          WHERE ooefent = g_enterprise
#            AND ooef001 = l_sfaasite
#      END IF        
#
#
#     #160816-00015#1-s-mark      
#     ##成本中心--暫用部門sfaa017抓取其歸屬成本中心
#     #SELECT sfaa017 INTO l_sfaa017 FROM sfaa_t
#     # WHERE sfaaent = g_enterprise 
#     #   AND sfaadocno = l_xcec.xcec001
#     #160816-00015#1-s-mark      
#      SELECT ooeg004 INTO l_xcec.xcec114 FROM ooeg_t
#       WHERE ooegent = g_enterprise AND ooeg001 = l_sfaa017 
#       
#      #品類
#      SELECT imag011 INTO l_xcec.xcec117 FROM imag_t
#       WHERE imagent = g_enterprise AND imagsite = g_xcea_m.xceacomp 
#         AND imag001 = l_xcec.xcec004   
#     #160816-00015#1-s-mark
#     ##項目編號+WBS
#     #SELECT sfaa028,sfaa029 INTO l_sfaa028,l_sfaa029 FROM sfaa_t
#     # WHERE sfaaent = g_enterprise 
#     #   AND sfaadocno = l_xcec.xcec001
#     #160816-00015#1-s-mark      
#      LET l_xcec.xcecent = g_enterprise 
#      LET l_xcec.xceccomp = g_xcea_m.xceacomp
#      LET l_xcec.xcecld = g_xcea_m.xceald
#      LET l_xcec.xcecdocno = g_xcea_m.xceadocno
#      #摘要
#      IF cl_null(l_xcec.xcec102) THEN
#         CALL axct701_01_get_summ(g_xcea_m.xceald,'61','8925','1') RETURNING l_success,l_xcec.xcec102
#      END IF
#
#     #160816-00015#1-s-add
#      IF NOT cl_null(l_sfaa068) THEN
#         LET l_xcec.xcec108 = l_sfaa068   
#      ELSE
#         LET l_xcec.xcec108 = ' '
#      END IF      
#     #160816-00015#1-e-add        
#      CALL axct701_01_default_space_xcec(l_xcec.*) RETURNING l_xcec.xcec005,   
#                                                             l_xcec.xcec101,
#                                                             l_xcec.xcec102,
#                                                             l_xcec.xcec103,
#                                                             l_xcec.xcec110,
#                                                             l_xcec.xcec111,
#                                                             l_xcec.xcec112,
#                                                             l_xcec.xcec113,
#                                                             l_xcec.xcec114,
#                                                             l_xcec.xcec115,
#                                                             l_xcec.xcec116,
#                                                             l_xcec.xcec117,
#                                                             l_xcec.xcec118,
#                                                             l_xcec.xcec119,
#                                                             l_xcec.xcec120,
#                                                             l_xcec.xcec107,
#                                                             l_xcec.xcec108,
#                                                             l_xcec.xcec109,
#                                                             l_xcec.xcec121,
#                                                             l_xcec.xcec122,
#                                                             l_xcec.xcec123,
#                                                             l_xcec.xcec124,
#                                                             l_xcec.xcec125,
#                                                             l_xcec.xcec126,
#                                                             l_xcec.xcec127,
#                                                             l_xcec.xcec128,
#                                                             l_xcec.xcec129,
#                                                             l_xcec.xcec130 
#      #161109-00085#19-e mod                                     
##如果金额和数量都为0的话，则不产生此笔单身数据                                                             
#      IF l_xcec.xcec201= 0 AND l_xcec.xcec202 = 0 THEN
#         CONTINUE FOREACH
#      END IF
#      #161109-00085#20-s mod      
##      INSERT INTO xcec_t VALUES(l_xcec.*)   #161109-00085#20-s mark
#      #161109-00085#63 --s mark
#      #INSERT INTO xcec_t(xcecent,xceccomp,xcecld,xcecdocno,xcecseq,xcec001,xcec002,xcec003,xcec004,
#      #                   xcec005,xcec101,xcec102,xcec103,xcec110,xcec111,xcec112,xcec113,xcec114,
#      #                   xcec115,xcec116,xcec117,xcec118,xcec119,xcec120,xcec201,xcec202,xcec202a,
#      #                   xcec202b,xcec202c,xcec202d,xcec202e,xcec202f,xcec202g,xcec202h,xcec212,
#      #                   xcec212a,xcec212b,xcec212c,xcec212d,xcec212e,xcec212f,xcec212g,xcec212h,
#      #                   xcec222,xcec222a,xcec222b,xcec222c,xcec222d,xcec222e,xcec222f,xcec222g,
#      #                   xcec222h,xcec301,xcec302,xcec107,xcec108,xcec109,xcec121,xcec122,xcec123,
#      #                   xcec124,xcec125,xcec126,xcec127,xcec128,xcec129,xcec130) 
#      #            VALUES(l_xcec.xcecent,l_xcec.xceccomp,l_xcec.xcecld,l_xcec.xcecdocno,l_xcec.xcecseq,
#      #                   l_xcec.xcec001,l_xcec.xcec002,l_xcec.xcec003,l_xcec.xcec004,l_xcec.xcec005,
#      #                   l_xcec.xcec101,l_xcec.xcec102,l_xcec.xcec103,l_xcec.xcec110,l_xcec.xcec111,
#      #                   l_xcec.xcec112,l_xcec.xcec113,l_xcec.xcec114,l_xcec.xcec115,l_xcec.xcec116,
#      #                   l_xcec.xcec117,l_xcec.xcec118,l_xcec.xcec119,l_xcec.xcec120,l_xcec.xcec201,
#      #                   l_xcec.xcec202,l_xcec.xcec202a,l_xcec.xcec202b,l_xcec.xcec202c,l_xcec.xcec202d,
#      #                   l_xcec.xcec202e,l_xcec.xcec202f,l_xcec.xcec202g,l_xcec.xcec202h,l_xcec.xcec212,
#      #                   l_xcec.xcec212a,l_xcec.xcec212b,l_xcec.xcec212c,l_xcec.xcec212d,l_xcec.xcec212e,
#      #                   l_xcec.xcec212f,l_xcec.xcec212g,l_xcec.xcec212h,l_xcec.xcec222,l_xcec.xcec222a,
#      #                   l_xcec.xcec222b,l_xcec.xcec222c,l_xcec.xcec222d,l_xcec.xcec222e,l_xcec.xcec222f,
#      #                   l_xcec.xcec222g,l_xcec.xcec222h,l_xcec.xcec301,l_xcec.xcec302,l_xcec.xcec107,
#      #                   l_xcec.xcec108,l_xcec.xcec109,l_xcec.xcec121,l_xcec.xcec122,l_xcec.xcec123,
#      #                   l_xcec.xcec124,l_xcec.xcec125,l_xcec.xcec126,l_xcec.xcec127,l_xcec.xcec128,
#      #                   l_xcec.xcec129,l_xcec.xcec130)
#      #161109-00085#63 --e mark
#      #161109-00085#20-e mod
#      #161109-00085#63 --s add
#      INSERT INTO xcec_t(xcecent,xceccomp,xcecld,xcecdocno,xcecseq,
#                         xcec001,xcec002,xcec003,xcec004,xcec005,
#                         xcec101,xcec102,xcec103,xcec110,xcec111,
#                         xcec112,xcec113,xcec114,xcec115,xcec116,
#                         xcec117,xcec118,xcec119,xcec120,xcec201,
#                         xcec202,xcec202a,xcec202b,xcec202c,xcec202d,
#                         xcec202e,xcec202f,xcec202g,xcec202h,xcec212,
#                         xcec212a,xcec212b,xcec212c,xcec212d,xcec212e,
#                         xcec212f,xcec212g,xcec212h,xcec222,xcec222a,
#                         xcec222b,xcec222c,xcec222d,xcec222e,xcec222f,
#                         xcec222g,xcec222h,xcec301,xcec302,xcecud001,
#                         xcecud002,xcecud003,xcecud004,xcecud005,xcecud006,
#                         xcecud007,xcecud008,xcecud009,xcecud010,xcecud011,
#                         xcecud012,xcecud013,xcecud014,xcecud015,xcecud016,
#                         xcecud017,xcecud018,xcecud019,xcecud020,xcecud021,
#                         xcecud022,xcecud023,xcecud024,xcecud025,xcecud026,
#                         xcecud027,xcecud028,xcecud029,xcecud030,xcec107,
#                         xcec108,xcec109,xcec121,xcec122,xcec123,
#                         xcec124,xcec125,xcec126,xcec127,xcec128,
#                         xcec129,xcec130)
#      VALUES(l_xcec.xcecent,l_xcec.xceccomp,l_xcec.xcecld,l_xcec.xcecdocno,l_xcec.xcecseq,
#             l_xcec.xcec001,l_xcec.xcec002,l_xcec.xcec003,l_xcec.xcec004,l_xcec.xcec005,
#             l_xcec.xcec101,l_xcec.xcec102,l_xcec.xcec103,l_xcec.xcec110,l_xcec.xcec111,
#             l_xcec.xcec112,l_xcec.xcec113,l_xcec.xcec114,l_xcec.xcec115,l_xcec.xcec116,
#             l_xcec.xcec117,l_xcec.xcec118,l_xcec.xcec119,l_xcec.xcec120,l_xcec.xcec201,
#             l_xcec.xcec202,l_xcec.xcec202a,l_xcec.xcec202b,l_xcec.xcec202c,l_xcec.xcec202d,
#             l_xcec.xcec202e,l_xcec.xcec202f,l_xcec.xcec202g,l_xcec.xcec202h,l_xcec.xcec212,
#             l_xcec.xcec212a,l_xcec.xcec212b,l_xcec.xcec212c,l_xcec.xcec212d,l_xcec.xcec212e,
#             l_xcec.xcec212f,l_xcec.xcec212g,l_xcec.xcec212h,l_xcec.xcec222,l_xcec.xcec222a,
#             l_xcec.xcec222b,l_xcec.xcec222c,l_xcec.xcec222d,l_xcec.xcec222e,l_xcec.xcec222f,
#             l_xcec.xcec222g,l_xcec.xcec222h,l_xcec.xcec301,l_xcec.xcec302,l_xcec.xcecud001,
#             l_xcec.xcecud002,l_xcec.xcecud003,l_xcec.xcecud004,l_xcec.xcecud005,l_xcec.xcecud006,
#             l_xcec.xcecud007,l_xcec.xcecud008,l_xcec.xcecud009,l_xcec.xcecud010,l_xcec.xcecud011,
#             l_xcec.xcecud012,l_xcec.xcecud013,l_xcec.xcecud014,l_xcec.xcecud015,l_xcec.xcecud016,
#             l_xcec.xcecud017,l_xcec.xcecud018,l_xcec.xcecud019,l_xcec.xcecud020,l_xcec.xcecud021,
#             l_xcec.xcecud022,l_xcec.xcecud023,l_xcec.xcecud024,l_xcec.xcecud025,l_xcec.xcecud026,
#             l_xcec.xcecud027,l_xcec.xcecud028,l_xcec.xcecud029,l_xcec.xcecud030,l_xcec.xcec107,
#             l_xcec.xcec108,l_xcec.xcec109,l_xcec.xcec121,l_xcec.xcec122,l_xcec.xcec123,
#             l_xcec.xcec124,l_xcec.xcec125,l_xcec.xcec126,l_xcec.xcec127,l_xcec.xcec128,
#             l_xcec.xcec129,l_xcec.xcec130)
#      #161109-00085#63 --e add
#      IF SQLCA.sqlcode THEN
#         INITIALIZE g_errparam TO NULL
#         LET g_errparam.code = SQLCA.sqlcode
#         LET g_errparam.extend = "ins xcec"
#         LET g_errparam.popup = TRUE
#         CALL cl_err()
#  
#         LET g_success = 'N'
#         RETURN g_success
#         EXIT FOREACH
#      END IF
#
#   CLOSE xcci_prep2
#   CLOSE xcci_prep3   
#       
#   END FOREACH
#   
#   FREE axct701_01_sfaa_prep_01   #160816-00015#1 add
#   
#   #add 160519--s 160520-00014#4
#   #第三單身
#   CALL axct701_01_ins_xced() RETURNING l_success
#   IF NOT l_success THEN LET g_success = 'N' END IF 
#   #add 160519--e
#   
#
#   RETURN g_success  
#161215-00040#1 Mark ---(E)---
END FUNCTION

################################################################################
# Descriptions...: 描述说明
# Memo...........:
# Usage..........: CALL s_aooi150_ins (传入参数)
#                  RETURNING 回传参数
# Input parameter: 传入参数变量1   传入参数变量说明1
#                : 传入参数变量2   传入参数变量说明2
# Return code....: 回传参数变量1   回传参数变量说明1
#                : 回传参数变量2   回传参数变量说明2
# Date & Author..: 日期 By 作者
# Modify.........:
################################################################################
PRIVATE FUNCTION axct701_01_ins_xced_bak()
#161215-00040#1 Mark ---(S)---
##161109-00085#18-s mod
##DEFINE l_xcec          RECORD LIKE xcec_t.*   #161109-00085#18-s mark
#DEFINE l_xcec          RECORD  #成本憑證第二單身檔
#       xcecent LIKE xcec_t.xcecent, #企業編號
#       xceccomp LIKE xcec_t.xceccomp, #法人組織
#       xcecld LIKE xcec_t.xcecld, #帳套
#       xcecdocno LIKE xcec_t.xcecdocno, #單據編號
#       xcecseq LIKE xcec_t.xcecseq, #項次
#       xcec001 LIKE xcec_t.xcec001, #參考單據
#       xcec002 LIKE xcec_t.xcec002, #參考單據項次
#       xcec003 LIKE xcec_t.xcec003, #單據類型
#       xcec004 LIKE xcec_t.xcec004, #料件編號
#       xcec005 LIKE xcec_t.xcec005, #特性
#       xcec101 LIKE xcec_t.xcec101, #科目編號
#       xcec102 LIKE xcec_t.xcec102, #摘要
#       xcec103 LIKE xcec_t.xcec103, #成本域
#       xcec110 LIKE xcec_t.xcec110, #原因碼
#       xcec111 LIKE xcec_t.xcec111, #收付款客商
#       xcec112 LIKE xcec_t.xcec112, #客群
#       xcec113 LIKE xcec_t.xcec113, #區域
#       xcec114 LIKE xcec_t.xcec114, #成本中心
#       xcec115 LIKE xcec_t.xcec115, #經營類別
#       xcec116 LIKE xcec_t.xcec116, #通路
#       xcec117 LIKE xcec_t.xcec117, #品類
#       xcec118 LIKE xcec_t.xcec118, #品牌
#       xcec119 LIKE xcec_t.xcec119, #專案號
#       xcec120 LIKE xcec_t.xcec120, #WBS
#       xcec201 LIKE xcec_t.xcec201, #數量
#       xcec202 LIKE xcec_t.xcec202, #成本金額(本位幣一)
#       xcec202a LIKE xcec_t.xcec202a, #成本-材料(本位幣一)
#       xcec202b LIKE xcec_t.xcec202b, #成本-人工(本位幣一)
#       xcec202c LIKE xcec_t.xcec202c, #成本-加工(本位幣一)
#       xcec202d LIKE xcec_t.xcec202d, #成本-制費一(本位幣一)
#       xcec202e LIKE xcec_t.xcec202e, #成本-制費二(本位幣一)
#       xcec202f LIKE xcec_t.xcec202f, #成本-制費三(本位幣一)
#       xcec202g LIKE xcec_t.xcec202g, #成本-制費四(本位幣一)
#       xcec202h LIKE xcec_t.xcec202h, #成本-制費五(本位幣一)
#       xcec212 LIKE xcec_t.xcec212, #成本-金額(本位幣二)
#       xcec212a LIKE xcec_t.xcec212a, #成本-材料(本位幣二)
#       xcec212b LIKE xcec_t.xcec212b, #成本-人工(本位幣二)
#       xcec212c LIKE xcec_t.xcec212c, #成本-加工(本位幣二)
#       xcec212d LIKE xcec_t.xcec212d, #成本-制費一(本位幣二)
#       xcec212e LIKE xcec_t.xcec212e, #成本-制費二(本位幣二)
#       xcec212f LIKE xcec_t.xcec212f, #成本-制費三(本位幣二)
#       xcec212g LIKE xcec_t.xcec212g, #成本-制費四(本位幣二)
#       xcec212h LIKE xcec_t.xcec212h, #成本-制費五(本位幣二)
#       xcec222 LIKE xcec_t.xcec222, #成本-金額(本位幣三)
#       xcec222a LIKE xcec_t.xcec222a, #成本-材料(本位幣三)
#       xcec222b LIKE xcec_t.xcec222b, #成本-人工(本位幣三)
#       xcec222c LIKE xcec_t.xcec222c, #成本-加工(本位幣三)
#       xcec222d LIKE xcec_t.xcec222d, #成本-制費一(本位幣三)
#       xcec222e LIKE xcec_t.xcec222e, #成本-制費二(本位幣三)
#       xcec222f LIKE xcec_t.xcec222f, #成本-制費三(本位幣三)
#       xcec222g LIKE xcec_t.xcec222g, #成本-制費四(本位幣三)
#       xcec222h LIKE xcec_t.xcec222h, #成本-制費五(本位幣三)
#       xcec301 LIKE xcec_t.xcec301, #憑證編號
#       xcec302 LIKE xcec_t.xcec302, #憑證項次
#       #161109-00085#63 --s add 
#       xcecud001 LIKE xcec_t.xcecud001, #自定義欄位(文字)001
#       xcecud002 LIKE xcec_t.xcecud002, #自定義欄位(文字)002
#       xcecud003 LIKE xcec_t.xcecud003, #自定義欄位(文字)003
#       xcecud004 LIKE xcec_t.xcecud004, #自定義欄位(文字)004
#       xcecud005 LIKE xcec_t.xcecud005, #自定義欄位(文字)005
#       xcecud006 LIKE xcec_t.xcecud006, #自定義欄位(文字)006
#       xcecud007 LIKE xcec_t.xcecud007, #自定義欄位(文字)007
#       xcecud008 LIKE xcec_t.xcecud008, #自定義欄位(文字)008
#       xcecud009 LIKE xcec_t.xcecud009, #自定義欄位(文字)009
#       xcecud010 LIKE xcec_t.xcecud010, #自定義欄位(文字)010
#       xcecud011 LIKE xcec_t.xcecud011, #自定義欄位(數字)011
#       xcecud012 LIKE xcec_t.xcecud012, #自定義欄位(數字)012
#       xcecud013 LIKE xcec_t.xcecud013, #自定義欄位(數字)013
#       xcecud014 LIKE xcec_t.xcecud014, #自定義欄位(數字)014
#       xcecud015 LIKE xcec_t.xcecud015, #自定義欄位(數字)015
#       xcecud016 LIKE xcec_t.xcecud016, #自定義欄位(數字)016
#       xcecud017 LIKE xcec_t.xcecud017, #自定義欄位(數字)017
#       xcecud018 LIKE xcec_t.xcecud018, #自定義欄位(數字)018
#       xcecud019 LIKE xcec_t.xcecud019, #自定義欄位(數字)019
#       xcecud020 LIKE xcec_t.xcecud020, #自定義欄位(數字)020
#       xcecud021 LIKE xcec_t.xcecud021, #自定義欄位(日期時間)021
#       xcecud022 LIKE xcec_t.xcecud022, #自定義欄位(日期時間)022
#       xcecud023 LIKE xcec_t.xcecud023, #自定義欄位(日期時間)023
#       xcecud024 LIKE xcec_t.xcecud024, #自定義欄位(日期時間)024
#       xcecud025 LIKE xcec_t.xcecud025, #自定義欄位(日期時間)025
#       xcecud026 LIKE xcec_t.xcecud026, #自定義欄位(日期時間)026
#       xcecud027 LIKE xcec_t.xcecud027, #自定義欄位(日期時間)027
#       xcecud028 LIKE xcec_t.xcecud028, #自定義欄位(日期時間)028
#       xcecud029 LIKE xcec_t.xcecud029, #自定義欄位(日期時間)029
#       xcecud030 LIKE xcec_t.xcecud030, #自定義欄位(日期時間)030
#       #161109-00085#63 --e add
#       xcec107 LIKE xcec_t.xcec107, #人員
#       xcec108 LIKE xcec_t.xcec108, #部門
#       xcec109 LIKE xcec_t.xcec109, #帳款對象
#       xcec121 LIKE xcec_t.xcec121, #自由核算項1
#       xcec122 LIKE xcec_t.xcec122, #自由核算項2
#       xcec123 LIKE xcec_t.xcec123, #自由核算項3
#       xcec124 LIKE xcec_t.xcec124, #自由核算項4
#       xcec125 LIKE xcec_t.xcec125, #自由核算項5
#       xcec126 LIKE xcec_t.xcec126, #自由核算項6
#       xcec127 LIKE xcec_t.xcec127, #自由核算項7
#       xcec128 LIKE xcec_t.xcec128, #自由核算項8
#       xcec129 LIKE xcec_t.xcec129, #自由核算項9
#       xcec130 LIKE xcec_t.xcec130  #自由核算項10
#               END RECORD
##161109-00085#18-e mod
##161109-00085#18-s mod
##DEFINE l_xced          RECORD LIKE xced_t.*   #161109-00085#18-s mark
#DEFINE l_xced          RECORD  #成本憑證第三單身檔(在製人工費用科目設定)
#       xcedent LIKE xced_t.xcedent, #企業編號
#       xcedcomp LIKE xced_t.xcedcomp, #法人組織
#       xcedld LIKE xced_t.xcedld, #帳套
#       xceddocno LIKE xced_t.xceddocno, #單據編號
#       xcedseq LIKE xced_t.xcedseq, #項次
#       xced001 LIKE xced_t.xced001, #在製科目分類
#       xced101 LIKE xced_t.xced101, #科目編號
#       xced102 LIKE xced_t.xced102, #摘要
#       xced110 LIKE xced_t.xced110, #原因碼
#       xced111 LIKE xced_t.xced111, #收付款客商
#       xced112 LIKE xced_t.xced112, #客群
#       xced113 LIKE xced_t.xced113, #區域
#       xced114 LIKE xced_t.xced114, #成本中心
#       xced115 LIKE xced_t.xced115, #經營類別
#       xced116 LIKE xced_t.xced116, #通路
#       xced117 LIKE xced_t.xced117, #品類
#       xced118 LIKE xced_t.xced118, #品牌
#       xced119 LIKE xced_t.xced119, #專案編號
#       xced120 LIKE xced_t.xced120, #WBS
#       xced202 LIKE xced_t.xced202, #成本金額(本位幣一)
#       xced212 LIKE xced_t.xced212, #成本金額(本位幣二)
#       xced222 LIKE xced_t.xced222, #成本金額(本位幣三)
#       xced301 LIKE xced_t.xced301, #憑證編號
#       xced302 LIKE xced_t.xced302, #憑證項次
#       xced107 LIKE xced_t.xced107, #人員
#       xced108 LIKE xced_t.xced108, #部門
#       xced109 LIKE xced_t.xced109, #帳款對象
#       xced121 LIKE xced_t.xced121, #自由核算項1
#       xced122 LIKE xced_t.xced122, #自由核算項2
#       xced123 LIKE xced_t.xced123, #自由核算項3
#       xced124 LIKE xced_t.xced124, #自由核算項4
#       xced125 LIKE xced_t.xced125, #自由核算項5
#       xced126 LIKE xced_t.xced126, #自由核算項6
#       xced127 LIKE xced_t.xced127, #自由核算項7
#       xced128 LIKE xced_t.xced128, #自由核算項8
#       xced129 LIKE xced_t.xced129, #自由核算項9
#       xced130 LIKE xced_t.xced130  #自由核算項10
#          END RECORD
##161109-00085#18-e mod
#DEFINE l_xced101_1     LIKE xced_t.xced101
#DEFINE l_xced101_2     LIKE xced_t.xced101
#DEFINE l_xced101_3     LIKE xced_t.xced101
#DEFINE l_xced101_4     LIKE xced_t.xced101
#DEFINE l_xced101_5     LIKE xced_t.xced101
#DEFINE l_xced101_6     LIKE xced_t.xced101
#DEFINE l_xced101_7     LIKE xced_t.xced101
#DEFINE l_success       LIKE type_t.num5
#DEFINE l_errno         LIKE gzze_t.gzze001
#
#INITIALIZE l_xcec.* TO NULL
#INITIALIZE l_xced.* TO NULL
#
#
# #160829-00005#2-s-add
#   LET g_sql = "INSERT INTO xced_t( xcedent,xcedcomp, xcedld,xceddocno,xcedseq, ",
#               "                    xced001, xced101,xced102,  xced110,xced111, ",
#               "                    xced112, xced113,xced114,  xced115,xced116, ",
#               "                    xced117, xced118,xced119,  xced120,xced202, ",
#               "                    xced212, xced222,xced301,  xced107,xced108, ",
#               "                    xced109, xced121,xced122,  xced123,xced124, ",
#               "                    xced125, xced126,xced127,  xced128,xced129, ",
#               "                    xced130, xced302)",               
#               "VALUES(?,?,?,?,?, ?,?,?,?,?, ?,?,?,?,?, ?,?,?,?,?, ?,?,?,?,?, ",
#               "       ?,?,?,?,?, ?,?,?,?,?, ?,? ) "
#   PREPARE axcq701_01_ins_xced_p FROM g_sql  
#   
#   LET g_sql =" SELECT MAX(xcedseq) FROM xced_t ",
#              "  WHERE xcedent = ",g_enterprise,
#              "    AND xcedld = '",g_xcea_m.xceald,"'",
#              "    AND xceddocno = '",g_xcea_m.xceadocno,"'"   
#   DECLARE axct701_01_xced_prep CURSOR FROM g_sql
# #160829-00005#2-e-add
#
##add 160519--s 160520-00014#4
#CASE  
#WHEN g_xcea002='1'   #axct701
#   #xcec_t中ADJUST元件彙總-xced
#   #160607-00026#1-s-mark
#   #LET g_sql = " SELECT xcec102,xcec114,xcec113,xcec111,xcec117,xcec119,xcec120,",
#   #            "        SUM(xcec202b),SUM(xcec202c),SUM(xcec202d),SUM(xcec202e),",
#   #            "        SUM(xcec202f),SUM(xcec202g),SUM(xcec202h), ",
#   #            "        SUM(xcec212b),SUM(xcec212c),SUM(xcec212d),SUM(xcec212e),",
#   #            "        SUM(xcec212f),SUM(xcec212g),SUM(xcec212h), ",
#   #            "        SUM(xcec222b),SUM(xcec222c),SUM(xcec222d),SUM(xcec222e),",
#   #            "        SUM(xcec222f),SUM(xcec222g),SUM(xcec222h) ",
#   #            "   FROM xcec_t",
#   #            "  WHERE xcecent = '",g_enterprise,"' AND xcecld = '",g_xcea_m.xceald,"'",
#   #            "    AND xcecdocno = '",g_xcea_m.xceadocno,"'", 
#   #            "    AND xcec004 = 'ADJUST' ",
#   #            "  GROUP BY xcec102,xcec114,xcec113,xcec111,xcec117,xcec119,xcec120 ",
#   #            "  ORDER BY xcec102,xcec114,xcec113,xcec111,xcec117,xcec119,xcec120 "
#   #160607-00026#1-e-mark 
#   #160607-00026#1-s-add   
#   LET g_sql = " SELECT xcec102,xcec114,xcec113,xcec111,xcec117,xcec119,xcec120,",
#               "        xcec202b,xcec202c,xcec202d,xcec202e, ",
#               "        xcec202f,xcec202g,xcec202h, ",
#               "        xcec212b,xcec212c,xcec212d,xcec212e,",
#               "        xcec212f,xcec212g,xcec212h, ",
#               "        xcec222b,xcec222c,xcec222d,xcec222e,",
#               "        xcec222f,xcec222g,xcec222h, ",
#               #160706-00021#3--(S)
#               #"        (SELECT glab005 FROM glab_t WHERE glabent = xcecent AND glabld = xcecld AND glab001 = '60' AND glab002 = '8912' AND glab003 = '17') xced101_1, ",
#               #"        (SELECT glab005 FROM glab_t WHERE glabent = xcecent AND glabld = xcecld AND glab001 = '60' AND glab002 = '8912' AND glab003 = '18') xced101_2, ",
#               #"        (SELECT glab005 FROM glab_t WHERE glabent = xcecent AND glabld = xcecld AND glab001 = '60' AND glab002 = '8912' AND glab003 = '19') xced101_3, ",
#               #"        (SELECT glab005 FROM glab_t WHERE glabent = xcecent AND glabld = xcecld AND glab001 = '60' AND glab002 = '8912' AND glab003 = '20') xced101_4, ",
#               #"        (SELECT glab005 FROM glab_t WHERE glabent = xcecent AND glabld = xcecld AND glab001 = '60' AND glab002 = '8912' AND glab003 = '21') xced101_5, ",
#               #"        (SELECT glab005 FROM glab_t WHERE glabent = xcecent AND glabld = xcecld AND glab001 = '60' AND glab002 = '8912' AND glab003 = '22') xced101_6, ",
#               #"        (SELECT glab005 FROM glab_t WHERE glabent = xcecent AND glabld = xcecld AND glab001 = '60' AND glab002 = '8912' AND glab003 = '23') xced101_7 ",
#               "        (SELECT glab005 FROM glab_t WHERE glabent = xcecent AND glabld = xcecld AND glab001 = '60' AND glab002 = '8912' AND glab003 = '2') xced101_1, ",
#               "        (SELECT glab005 FROM glab_t WHERE glabent = xcecent AND glabld = xcecld AND glab001 = '60' AND glab002 = '8912' AND glab003 = '15') xced101_2, ",
#               "        (SELECT glab005 FROM glab_t WHERE glabent = xcecent AND glabld = xcecld AND glab001 = '60' AND glab002 = '8912' AND glab003 = '3') xced101_3, ",
#               "        (SELECT glab005 FROM glab_t WHERE glabent = xcecent AND glabld = xcecld AND glab001 = '60' AND glab002 = '8912' AND glab003 = '11') xced101_4, ",
#               "        (SELECT glab005 FROM glab_t WHERE glabent = xcecent AND glabld = xcecld AND glab001 = '60' AND glab002 = '8912' AND glab003 = '12') xced101_5, ",
#               "        (SELECT glab005 FROM glab_t WHERE glabent = xcecent AND glabld = xcecld AND glab001 = '60' AND glab002 = '8912' AND glab003 = '13') xced101_6, ",
#               "        (SELECT glab005 FROM glab_t WHERE glabent = xcecent AND glabld = xcecld AND glab001 = '60' AND glab002 = '8912' AND glab003 = '14') xced101_7 ",
#               #160706-00021#3--(E)
#               " FROM ( ",
#               " SELECT xcecent,xcecld,xcec102,xcec114,xcec113,xcec111,xcec117,xcec119,xcec120,",
#               "        SUM(xcec202b) xcec202b,SUM(xcec202c) xcec202c,SUM(xcec202d) xcec202d,SUM(xcec202e) xcec202e,",
#               "        SUM(xcec202f) xcec202f,SUM(xcec202g) xcec202g,SUM(xcec202h) xcec202h, ",
#               "        SUM(xcec212b) xcec212b,SUM(xcec212c) xcec212c,SUM(xcec212d) xcec212d,SUM(xcec212e) xcec212e,",
#               "        SUM(xcec212f) xcec212f,SUM(xcec212g) xcec212g,SUM(xcec212h) xcec212h, ",
#               "        SUM(xcec222b) xcec222b,SUM(xcec222c) xcec222c,SUM(xcec222d) xcec222d,SUM(xcec222e) xcec222e,",
#               "        SUM(xcec222f) xcec222f,SUM(xcec222g) xcec222g,SUM(xcec222h) xcec222h ",
#               "   FROM xcec_t",
#               "  WHERE xcecent = '",g_enterprise,"' AND xcecld = '",g_xcea_m.xceald,"'",
#               "    AND xcecdocno = '",g_xcea_m.xceadocno,"'", 
#               "    AND xcec004 = 'ADJUST' ",
#               "  GROUP BY xcecent,xcecld,xcec102,xcec114,xcec113,xcec111,xcec117,xcec119,xcec120 ",
#               "  ORDER BY xcec102,xcec114,xcec113,xcec111,xcec117,xcec119,xcec120 ",
#               "      )"               
#   #160607-00026#1-e-add            
#   PREPARE xcec_prep_1 FROM g_sql
#   DECLARE xcec_curs_1 CURSOR FOR xcec_prep_1
#   FOREACH xcec_curs_1 INTO l_xcec.xcec102,l_xcec.xcec114,l_xcec.xcec113,
#                            l_xcec.xcec111,l_xcec.xcec117,l_xcec.xcec119,l_xcec.xcec120,
#                            l_xcec.xcec202b,l_xcec.xcec202c,l_xcec.xcec202d,l_xcec.xcec202e,l_xcec.xcec202f,
#                            l_xcec.xcec202g,l_xcec.xcec202h, 
#                            l_xcec.xcec212b,l_xcec.xcec212c,l_xcec.xcec212d,l_xcec.xcec212e,l_xcec.xcec212f,
#                            l_xcec.xcec212g,l_xcec.xcec212h,
#                            l_xcec.xcec222b,l_xcec.xcec222c,l_xcec.xcec222d,l_xcec.xcec222e,l_xcec.xcec222f,
#                            l_xcec.xcec222g,l_xcec.xcec222h,
#                            l_xced101_1,l_xced101_2,l_xced101_3,l_xced101_4,l_xced101_5,l_xced101_6,l_xced101_7  #160607-00026#1 add                          
#      IF SQLCA.sqlcode THEN
#         INITIALIZE g_errparam TO NULL
#         LET g_errparam.code = SQLCA.sqlcode
#         LET g_errparam.extend = "foreach xcec"
#         LET g_errparam.popup = TRUE
#         CALL cl_err()
#         LET g_success = 'N'
#         EXIT FOREACH
#      END IF  
#   
#      LET l_xced.xced102 = l_xcec.xcec102
#      LET l_xced.xced114 = l_xcec.xcec114
#      LET l_xced.xced113 = l_xcec.xcec113
#      LET l_xced.xced111 = l_xcec.xcec111
#      LET l_xced.xced117 = l_xcec.xcec117
#      LET l_xced.xced119 = l_xcec.xcec119
#      LET l_xced.xced120 = l_xcec.xcec120
#      
#     #160607-00026#1-s-mark
#     ##在制人工科目
#     #CALL s_get_item_acc(g_xcea_m.xceald,'6',l_xcec.xcec004,'','',g_xcea_m.xceacomp,'') 
#     #  RETURNING l_success,l_xced101_1         
#     ##agli161抓不到，改抓axci201的科目
#     #IF cl_null(l_xced101_1) THEN
#     #   CALL s_fin_get_account(g_xcea_m.xceald,'60','8912','17') RETURNING l_success,l_xced101_1,l_errno
#     #END IF     
#     ##在制加工费科目
#     #CALL s_get_item_acc(g_xcea_m.xceald,'7',l_xcec.xcec004,'','',g_xcea_m.xceacomp,'') 
#     #  RETURNING l_success,l_xced101_2      
#     ##agli161抓不到，改抓axci201的科目
#     #IF cl_null(l_xced101_2) THEN
#     #   CALL s_fin_get_account(g_xcea_m.xceald,'60','8912','18') RETURNING l_success,l_xced101_2,l_errno
#     #END IF         
#     ##在制制费一科目
#     #CALL s_get_item_acc(g_xcea_m.xceald,'11',l_xcec.xcec004,'','',g_xcea_m.xceacomp,'') 
#     #  RETURNING l_success,l_xced101_3  
#     #IF cl_null(l_xced101_3) THEN
#     #   CALL s_fin_get_account(g_xcea_m.xceald,'60','8912','19') RETURNING l_success,l_xced101_3,l_errno
#     #END IF    
#     ##在制制费二科目
#     #CALL s_get_item_acc(g_xcea_m.xceald,'12',l_xcec.xcec004,'','',g_xcea_m.xceacomp,'') 
#     #  RETURNING l_success,l_xced101_4      
#     #IF cl_null(l_xced101_4) THEN
#     #   CALL s_fin_get_account(g_xcea_m.xceald,'60','8912','20') RETURNING l_success,l_xced101_4,l_errno
#     #END IF
#     ##在制制费三科目
#     #CALL s_get_item_acc(g_xcea_m.xceald,'13',l_xcec.xcec004,'','',g_xcea_m.xceacomp,'') 
#     #  RETURNING l_success,l_xced101_5  
#     #IF cl_null(l_xced101_5) THEN
#     #   CALL s_fin_get_account(g_xcea_m.xceald,'60','8912','21') RETURNING l_success,l_xced101_5,l_errno
#     #END IF
#     ##在制费四科目
#     #CALL s_get_item_acc(g_xcea_m.xceald,'14',l_xcec.xcec004,'','',g_xcea_m.xceacomp,'') 
#     #  RETURNING l_success,l_xced101_6  
#     #IF cl_null(l_xced101_6) THEN
#     #   CALL s_fin_get_account(g_xcea_m.xceald,'60','8912','22') RETURNING l_success,l_xced101_6,l_errno
#     #END IF
#     ##在制制费五科目
#     #CALL s_get_item_acc(g_xcea_m.xceald,'15',l_xcec.xcec004,'','',g_xcea_m.xceacomp,'') 
#     #  RETURNING l_success,l_xced101_7  
#     #IF cl_null(l_xced101_7) THEN
#     #   CALL s_fin_get_account(g_xcea_m.xceald,'60','8912','23') RETURNING l_success,l_xced101_7,l_errno
#     #END IF         
#     #160607-00026#1-e-mark               
#     
#      #項次
#     #160829-00005#2-s-mark 
#     #SELECT MAX(xcedseq) INTO l_xced.xcedseq FROM xced_t
#     # WHERE xcedent = g_enterprise 
#     #   AND xcedld = g_xcea_m.xceald
#     #   AND xceddocno = g_xcea_m.xceadocno
#     #160829-00005#2-e-mark   
#      EXECUTE axct701_01_xced_prep INTO l_xced.xcedseq   #160829-00005#2 add       
#      IF cl_null(l_xced.xcedseq) OR l_xced.xcedseq = 0 THEN
#         LET l_xced.xcedseq = 1
#      ELSE
#         LET l_xced.xcedseq = l_xced.xcedseq + 1
#      END IF       
#      LET l_xced.xcedent   = g_enterprise
#      LET l_xced.xcedcomp  = g_xcea_m.xceacomp
#      LET l_xced.xcedld    = g_xcea_m.xceald
#      LET l_xced.xceddocno = g_xcea_m.xceadocno
#      LET l_xced.xced001   = 1
#      LET l_xced.xced101   = l_xced101_1
#      LET l_xced.xced110   = ''
#      LET l_xced.xced112   = ''
#      LET l_xced.xced115   = ''
#      LET l_xced.xced116   = ''
#      LET l_xced.xced118   = ''
#      LET l_xced.xced202   = l_xcec.xcec202b
#      LET l_xced.xced212   = l_xcec.xcec212b
#      LET l_xced.xced222   = l_xcec.xcec222b
#      LET l_xced.xced301   = ''
#      LET l_xced.xced302   = '' 
#      
#     #INSERT INTO xced_t VALUES (l_xced.*)  #160829-00005#2 mark
#     #160829-00005#2-s-add
#      EXECUTE axcq701_01_ins_xced_p USING l_xced.xcedent,l_xced.xcedcomp, l_xced.xcedld,l_xced.xceddocno,l_xced.xcedseq,
#                                          l_xced.xced001, l_xced.xced101,l_xced.xced102,  l_xced.xced110,l_xced.xced111,
#                                          l_xced.xced112, l_xced.xced113,l_xced.xced114,  l_xced.xced115,l_xced.xced116,
#                                          l_xced.xced117, l_xced.xced118,l_xced.xced119,  l_xced.xced120,l_xced.xced202,
#                                          l_xced.xced212, l_xced.xced222,l_xced.xced301,  l_xced.xced107,l_xced.xced108,
#                                          l_xced.xced109, l_xced.xced121,l_xced.xced122,  l_xced.xced123,l_xced.xced124,
#                                          l_xced.xced125, l_xced.xced126,l_xced.xced127,  l_xced.xced128,l_xced.xced129,
#                                          l_xced.xced130, l_xced.xced302 
#     #160829-00005#2-e-add
#      
#      IF SQLCA.sqlcode THEN
#         INITIALIZE g_errparam TO NULL
#         LET g_errparam.code = SQLCA.sqlcode
#         LET g_errparam.extend = "xced 1"
#         LET g_errparam.popup = TRUE
#         CALL cl_err()
#         LET g_success = 'N'
#         EXIT FOREACH
#      END IF  
#
#      LET l_xced.xcedent   = g_enterprise
#      LET l_xced.xcedcomp  = g_xcea_m.xceacomp
#      LET l_xced.xcedld    = g_xcea_m.xceald
#      LET l_xced.xceddocno = g_xcea_m.xceadocno
#      LET l_xced.xced001   = 2
#      LET l_xced.xced101   = l_xced101_2
#      LET l_xced.xced110   = ''
#      LET l_xced.xced112   = ''
#      LET l_xced.xced115   = ''
#      LET l_xced.xced116   = ''
#      LET l_xced.xced118   = ''
#      LET l_xced.xced202   = l_xcec.xcec202c
#      LET l_xced.xced212   = l_xcec.xcec212c
#      LET l_xced.xced222   = l_xcec.xcec222c
#      LET l_xced.xced301   = ''
#      LET l_xced.xced302   = '' 
#      LET l_xced.xcedseq = l_xced.xcedseq + 1    
#      
#     #INSERT INTO xced_t VALUES (l_xced.*)  #160829-00005#2 mark
#     #160829-00005#2-s-add
#      EXECUTE axcq701_01_ins_xced_p USING l_xced.xcedent,l_xced.xcedcomp, l_xced.xcedld,l_xced.xceddocno,l_xced.xcedseq,
#                                          l_xced.xced001, l_xced.xced101,l_xced.xced102,  l_xced.xced110,l_xced.xced111,
#                                          l_xced.xced112, l_xced.xced113,l_xced.xced114,  l_xced.xced115,l_xced.xced116,
#                                          l_xced.xced117, l_xced.xced118,l_xced.xced119,  l_xced.xced120,l_xced.xced202,
#                                          l_xced.xced212, l_xced.xced222,l_xced.xced301,  l_xced.xced107,l_xced.xced108,
#                                          l_xced.xced109, l_xced.xced121,l_xced.xced122,  l_xced.xced123,l_xced.xced124,
#                                          l_xced.xced125, l_xced.xced126,l_xced.xced127,  l_xced.xced128,l_xced.xced129,
#                                          l_xced.xced130, l_xced.xced302 
#     #160829-00005#2-e-add
#
#      IF SQLCA.sqlcode THEN
#         INITIALIZE g_errparam TO NULL
#         LET g_errparam.code = SQLCA.sqlcode
#         LET g_errparam.extend = "xced 2"
#         LET g_errparam.popup = TRUE
#         CALL cl_err()
#
#         LET g_success = 'N'
#         EXIT FOREACH
#      END IF
#
#
#      LET l_xced.xcedent   = g_enterprise
#      LET l_xced.xcedcomp  = g_xcea_m.xceacomp
#      LET l_xced.xcedld    = g_xcea_m.xceald
#      LET l_xced.xceddocno = g_xcea_m.xceadocno
#      LET l_xced.xced001   = 3
#      LET l_xced.xced101   = l_xced101_3
#      LET l_xced.xced110   = ''
#      LET l_xced.xced112   = ''
#      LET l_xced.xced115   = ''
#      LET l_xced.xced116   = ''
#      LET l_xced.xced118   = ''
#      LET l_xced.xced202   = l_xcec.xcec202d
#      LET l_xced.xced212   = l_xcec.xcec212d
#      LET l_xced.xced222   = l_xcec.xcec222d
#      LET l_xced.xced301   = ''
#      LET l_xced.xced302   = '' 
#      LET l_xced.xcedseq = l_xced.xcedseq + 1 
#      
#     #INSERT INTO xced_t VALUES (l_xced.*)  #160829-00005#2 mark
#     #160829-00005#2-s-add
#      EXECUTE axcq701_01_ins_xced_p USING l_xced.xcedent,l_xced.xcedcomp, l_xced.xcedld,l_xced.xceddocno,l_xced.xcedseq,
#                                          l_xced.xced001, l_xced.xced101,l_xced.xced102,  l_xced.xced110,l_xced.xced111,
#                                          l_xced.xced112, l_xced.xced113,l_xced.xced114,  l_xced.xced115,l_xced.xced116,
#                                          l_xced.xced117, l_xced.xced118,l_xced.xced119,  l_xced.xced120,l_xced.xced202,
#                                          l_xced.xced212, l_xced.xced222,l_xced.xced301,  l_xced.xced107,l_xced.xced108,
#                                          l_xced.xced109, l_xced.xced121,l_xced.xced122,  l_xced.xced123,l_xced.xced124,
#                                          l_xced.xced125, l_xced.xced126,l_xced.xced127,  l_xced.xced128,l_xced.xced129,
#                                          l_xced.xced130, l_xced.xced302 
#     #160829-00005#2-e-add      
#      
#      IF SQLCA.sqlcode THEN
#         INITIALIZE g_errparam TO NULL
#         LET g_errparam.code = SQLCA.sqlcode
#         LET g_errparam.extend = "xced 3"
#         LET g_errparam.popup = TRUE
#         CALL cl_err()
#
#         LET g_success = 'N'
#         EXIT FOREACH
#      END IF   
#      
#      LET l_xced.xcedent   = g_enterprise
#      LET l_xced.xcedcomp  = g_xcea_m.xceacomp
#      LET l_xced.xcedld    = g_xcea_m.xceald
#      LET l_xced.xceddocno = g_xcea_m.xceadocno
#      LET l_xced.xced001   = 4
#      LET l_xced.xced101   = l_xced101_4
#      LET l_xced.xced110   = ''
#      LET l_xced.xced112   = ''
#      LET l_xced.xced115   = ''
#      LET l_xced.xced116   = ''
#      LET l_xced.xced118   = ''
#      LET l_xced.xced202   = l_xcec.xcec202e
#      LET l_xced.xced212   = l_xcec.xcec212e
#      LET l_xced.xced222   = l_xcec.xcec222e
#      LET l_xced.xced301   = ''
#      LET l_xced.xced302   = '' 
#      LET l_xced.xcedseq = l_xced.xcedseq + 1 
#      
#
#     #INSERT INTO xced_t VALUES (l_xced.*)  #160829-00005#2 mark
#     #160829-00005#2-s-add
#      EXECUTE axcq701_01_ins_xced_p USING l_xced.xcedent,l_xced.xcedcomp, l_xced.xcedld,l_xced.xceddocno,l_xced.xcedseq,
#                                          l_xced.xced001, l_xced.xced101,l_xced.xced102,  l_xced.xced110,l_xced.xced111,
#                                          l_xced.xced112, l_xced.xced113,l_xced.xced114,  l_xced.xced115,l_xced.xced116,
#                                          l_xced.xced117, l_xced.xced118,l_xced.xced119,  l_xced.xced120,l_xced.xced202,
#                                          l_xced.xced212, l_xced.xced222,l_xced.xced301,  l_xced.xced107,l_xced.xced108,
#                                          l_xced.xced109, l_xced.xced121,l_xced.xced122,  l_xced.xced123,l_xced.xced124,
#                                          l_xced.xced125, l_xced.xced126,l_xced.xced127,  l_xced.xced128,l_xced.xced129,
#                                          l_xced.xced130, l_xced.xced302 
#     #160829-00005#2-e-add      
#      IF SQLCA.sqlcode THEN
#         INITIALIZE g_errparam TO NULL
#         LET g_errparam.code = SQLCA.sqlcode
#         LET g_errparam.extend = "xced 4"
#         LET g_errparam.popup = TRUE
#         CALL cl_err()
#
#         LET g_success = 'N'
#         EXIT FOREACH
#      END IF  
#      
#      LET l_xced.xcedent   = g_enterprise
#      LET l_xced.xcedcomp  = g_xcea_m.xceacomp
#      LET l_xced.xcedld    = g_xcea_m.xceald
#      LET l_xced.xceddocno = g_xcea_m.xceadocno
#      LET l_xced.xced001   = 5
#      LET l_xced.xced101   = l_xced101_5
#      LET l_xced.xced110   = ''
#      LET l_xced.xced112   = ''
#      LET l_xced.xced115   = ''
#      LET l_xced.xced116   = ''
#      LET l_xced.xced118   = ''
#      LET l_xced.xced202   = l_xcec.xcec202f
#      LET l_xced.xced212   = l_xcec.xcec212f
#      LET l_xced.xced222   = l_xcec.xcec222f
#      LET l_xced.xced301   = ''
#      LET l_xced.xced302   = '' 
#      LET l_xced.xcedseq = l_xced.xcedseq + 1 
#      
#     #INSERT INTO xced_t VALUES (l_xced.*)  #160829-00005#2 mark
#     #160829-00005#2-s-add
#      EXECUTE axcq701_01_ins_xced_p USING l_xced.xcedent,l_xced.xcedcomp, l_xced.xcedld,l_xced.xceddocno,l_xced.xcedseq,
#                                          l_xced.xced001, l_xced.xced101,l_xced.xced102,  l_xced.xced110,l_xced.xced111,
#                                          l_xced.xced112, l_xced.xced113,l_xced.xced114,  l_xced.xced115,l_xced.xced116,
#                                          l_xced.xced117, l_xced.xced118,l_xced.xced119,  l_xced.xced120,l_xced.xced202,
#                                          l_xced.xced212, l_xced.xced222,l_xced.xced301,  l_xced.xced107,l_xced.xced108,
#                                          l_xced.xced109, l_xced.xced121,l_xced.xced122,  l_xced.xced123,l_xced.xced124,
#                                          l_xced.xced125, l_xced.xced126,l_xced.xced127,  l_xced.xced128,l_xced.xced129,
#                                          l_xced.xced130, l_xced.xced302 
#     #160829-00005#2-e-add      
#      IF SQLCA.sqlcode THEN
#         INITIALIZE g_errparam TO NULL
#         LET g_errparam.code = SQLCA.sqlcode
#         LET g_errparam.extend = "xced 5"
#         LET g_errparam.popup = TRUE
#         CALL cl_err()
#
#         LET g_success = 'N'
#         EXIT FOREACH
#      END IF  
#      
#      LET l_xced.xcedent   = g_enterprise
#      LET l_xced.xcedcomp  = g_xcea_m.xceacomp
#      LET l_xced.xcedld    = g_xcea_m.xceald
#      LET l_xced.xceddocno = g_xcea_m.xceadocno
#      LET l_xced.xced001   = 6
#      LET l_xced.xced101   = l_xced101_6
#      LET l_xced.xced110   = ''
#      LET l_xced.xced112   = ''
#      LET l_xced.xced115   = ''
#      LET l_xced.xced116   = ''
#      LET l_xced.xced118   = ''
#      LET l_xced.xced202   = l_xcec.xcec202g
#      LET l_xced.xced212   = l_xcec.xcec212g
#      LET l_xced.xced222   = l_xcec.xcec222g
#      LET l_xced.xced301   = ''
#      LET l_xced.xced302   = '' 
#      LET l_xced.xcedseq = l_xced.xcedseq + 1 
#      
#     #INSERT INTO xced_t VALUES (l_xced.*)  #160829-00005#2 mark
#     #160829-00005#2-s-add
#      EXECUTE axcq701_01_ins_xced_p USING l_xced.xcedent,l_xced.xcedcomp, l_xced.xcedld,l_xced.xceddocno,l_xced.xcedseq,
#                                          l_xced.xced001, l_xced.xced101,l_xced.xced102,  l_xced.xced110,l_xced.xced111,
#                                          l_xced.xced112, l_xced.xced113,l_xced.xced114,  l_xced.xced115,l_xced.xced116,
#                                          l_xced.xced117, l_xced.xced118,l_xced.xced119,  l_xced.xced120,l_xced.xced202,
#                                          l_xced.xced212, l_xced.xced222,l_xced.xced301,  l_xced.xced107,l_xced.xced108,
#                                          l_xced.xced109, l_xced.xced121,l_xced.xced122,  l_xced.xced123,l_xced.xced124,
#                                          l_xced.xced125, l_xced.xced126,l_xced.xced127,  l_xced.xced128,l_xced.xced129,
#                                          l_xced.xced130, l_xced.xced302 
#     #160829-00005#2-e-add      
#      IF SQLCA.sqlcode THEN
#         INITIALIZE g_errparam TO NULL
#         LET g_errparam.code = SQLCA.sqlcode
#         LET g_errparam.extend = "xced 6"
#         LET g_errparam.popup = TRUE
#         CALL cl_err()
#
#         LET g_success = 'N'
#         EXIT FOREACH
#      END IF 
#      
#      LET l_xced.xcedent   = g_enterprise
#      LET l_xced.xcedcomp  = g_xcea_m.xceacomp
#      LET l_xced.xcedld    = g_xcea_m.xceald
#      LET l_xced.xceddocno = g_xcea_m.xceadocno
#      LET l_xced.xced001   = 7
#      LET l_xced.xced101   = l_xced101_7
#      LET l_xced.xced110   = ''
#      LET l_xced.xced112   = ''
#      LET l_xced.xced115   = ''
#      LET l_xced.xced116   = ''
#      LET l_xced.xced118   = ''
#      LET l_xced.xced202   = l_xcec.xcec202h
#      LET l_xced.xced212   = l_xcec.xcec212h
#      LET l_xced.xced222   = l_xcec.xcec222h
#      LET l_xced.xced301   = ''
#      LET l_xced.xced302   = '' 
#      LET l_xced.xcedseq = l_xced.xcedseq + 1 
#      
#     #INSERT INTO xced_t VALUES (l_xced.*)  #160829-00005#2 mark
#     #160829-00005#2-s-add
#      EXECUTE axcq701_01_ins_xced_p USING l_xced.xcedent,l_xced.xcedcomp, l_xced.xcedld,l_xced.xceddocno,l_xced.xcedseq,
#                                          l_xced.xced001, l_xced.xced101,l_xced.xced102,  l_xced.xced110,l_xced.xced111,
#                                          l_xced.xced112, l_xced.xced113,l_xced.xced114,  l_xced.xced115,l_xced.xced116,
#                                          l_xced.xced117, l_xced.xced118,l_xced.xced119,  l_xced.xced120,l_xced.xced202,
#                                          l_xced.xced212, l_xced.xced222,l_xced.xced301,  l_xced.xced107,l_xced.xced108,
#                                          l_xced.xced109, l_xced.xced121,l_xced.xced122,  l_xced.xced123,l_xced.xced124,
#                                          l_xced.xced125, l_xced.xced126,l_xced.xced127,  l_xced.xced128,l_xced.xced129,
#                                          l_xced.xced130, l_xced.xced302 
#     #160829-00005#2-e-add      
#      
#      IF SQLCA.sqlcode THEN
#         INITIALIZE g_errparam TO NULL
#         LET g_errparam.code = SQLCA.sqlcode
#         LET g_errparam.extend = "xced 7"
#         LET g_errparam.popup = TRUE
#         CALL cl_err()
#
#         LET g_success = 'N'
#         EXIT FOREACH
#      END IF                                 
# 
#   END FOREACH
#
#WHEN g_xcea002='2' OR g_xcea002='5'  #axct702,axct705
##add 160519--e 160520-00014#4
#
#      
#   #xcec_t中DL+OH_SUB元件彙總-xced  
#   #160607-00026#1-s-mark
#   #LET g_sql = " SELECT xcec102,xcec114,xcec113,xcec111,xcec117,xcec119,xcec120,",
#   #            "        SUM(xcec202b),SUM(xcec202c),SUM(xcec202d),SUM(xcec202e),",
#   #            "        SUM(xcec202f),SUM(xcec202g),SUM(xcec202h), ",
#   #            "        SUM(xcec212b),SUM(xcec212c),SUM(xcec212d),SUM(xcec212e),",
#   #            "        SUM(xcec212f),SUM(xcec212g),SUM(xcec212h), ",
#   #            "        SUM(xcec222b),SUM(xcec222c),SUM(xcec222d),SUM(xcec222e),",
#   #            "        SUM(xcec222f),SUM(xcec222g),SUM(xcec222h) ",
#   #            "   FROM xcec_t",
#   #            "  WHERE xcecent = '",g_enterprise,"' AND xcecld = '",g_xcea_m.xceald,"'",
#   #            "    AND xcecdocno = '",g_xcea_m.xceadocno,"'", 
#   #            "    AND xcec004 = 'DL+OH+SUB' ",
#   #            "  GROUP BY xcec102,xcec114,xcec113,xcec111,xcec117,xcec119,xcec120 ",
#   #            "  ORDER BY xcec102,xcec114,xcec113,xcec111,xcec117,xcec119,xcec120 "
#   #160607-00026#1-e-mark  
#   #160607-00026#1-s-add
#   LET g_sql = " SELECT xcec102,xcec114,xcec113,xcec111,xcec117,xcec119,xcec120,",
#               "        xcec202b,xcec202c,xcec202d,xcec202e,",
#               "        xcec202f,xcec202g,xcec202h, ",
#               "        xcec212b,xcec212c,xcec212d,xcec212e,",
#               "        xcec212f,xcec212g,xcec212h, ",
#               "        xcec222b,xcec222c,xcec222d,xcec222e,",
#               "        xcec222f,xcec222g,xcec222h, ",
#               #160706-00021--(S)
#               #"        (SELECT glab005 FROM glab_t WHERE glabent = xcecent AND glabld = xcecld AND glab001 = '60' AND glab002 = '8912' AND glab003 = '17') xced101_1, ",
#               #"        (SELECT glab005 FROM glab_t WHERE glabent = xcecent AND glabld = xcecld AND glab001 = '60' AND glab002 = '8912' AND glab003 = '18') xced101_2, ",
#               #"        (SELECT glab005 FROM glab_t WHERE glabent = xcecent AND glabld = xcecld AND glab001 = '60' AND glab002 = '8912' AND glab003 = '19') xced101_3, ",
#               #"        (SELECT glab005 FROM glab_t WHERE glabent = xcecent AND glabld = xcecld AND glab001 = '60' AND glab002 = '8912' AND glab003 = '20') xced101_4, ",
#               #"        (SELECT glab005 FROM glab_t WHERE glabent = xcecent AND glabld = xcecld AND glab001 = '60' AND glab002 = '8912' AND glab003 = '21') xced101_5, ",
#               #"        (SELECT glab005 FROM glab_t WHERE glabent = xcecent AND glabld = xcecld AND glab001 = '60' AND glab002 = '8912' AND glab003 = '22') xced101_6, ",
#               #"        (SELECT glab005 FROM glab_t WHERE glabent = xcecent AND glabld = xcecld AND glab001 = '60' AND glab002 = '8912' AND glab003 = '23') xced101_7 ",      
#               "        (SELECT glab005 FROM glab_t WHERE glabent = xcecent AND glabld = xcecld AND glab001 = '60' AND glab002 = '8912' AND glab003 = '2') xced101_1, ",
#               "        (SELECT glab005 FROM glab_t WHERE glabent = xcecent AND glabld = xcecld AND glab001 = '60' AND glab002 = '8912' AND glab003 = '15') xced101_2, ",
#               "        (SELECT glab005 FROM glab_t WHERE glabent = xcecent AND glabld = xcecld AND glab001 = '60' AND glab002 = '8912' AND glab003 = '3') xced101_3, ",
#               "        (SELECT glab005 FROM glab_t WHERE glabent = xcecent AND glabld = xcecld AND glab001 = '60' AND glab002 = '8912' AND glab003 = '11') xced101_4, ",
#               "        (SELECT glab005 FROM glab_t WHERE glabent = xcecent AND glabld = xcecld AND glab001 = '60' AND glab002 = '8912' AND glab003 = '12') xced101_5, ",
#               "        (SELECT glab005 FROM glab_t WHERE glabent = xcecent AND glabld = xcecld AND glab001 = '60' AND glab002 = '8912' AND glab003 = '13') xced101_6, ",
#               "        (SELECT glab005 FROM glab_t WHERE glabent = xcecent AND glabld = xcecld AND glab001 = '60' AND glab002 = '8912' AND glab003 = '14') xced101_7 ",
#               #160706-00021--(E)
#               "  FROM ( ",
#               " SELECT xcecent,xcecld,xcec102,xcec114,xcec113,xcec111,xcec117,xcec119,xcec120,",
#               "        SUM(xcec202b) xcec202b,SUM(xcec202c) xcec202c,SUM(xcec202d) xcec202d,SUM(xcec202e) xcec202e,",
#               "        SUM(xcec202f) xcec202f,SUM(xcec202g) xcec202g,SUM(xcec202h) xcec202h, ",
#               "        SUM(xcec212b) xcec212b,SUM(xcec212c) xcec212c,SUM(xcec212d) xcec212d,SUM(xcec212e) xcec212e,",
#               "        SUM(xcec212f) xcec212f,SUM(xcec212g) xcec212g,SUM(xcec212h) xcec212h, ",
#               "        SUM(xcec222b) xcec222b,SUM(xcec222c) xcec222c,SUM(xcec222d) xcec222d,SUM(xcec222e) xcec222e,",
#               "        SUM(xcec222f) xcec222f,SUM(xcec222g) xcec222g,SUM(xcec222h) xcec222h ",
#               "   FROM xcec_t",
#               "  WHERE xcecent = '",g_enterprise,"' AND xcecld = '",g_xcea_m.xceald,"'",
#               "    AND xcecdocno = '",g_xcea_m.xceadocno,"'", 
#               "    AND xcec004 = 'DL+OH+SUB' ",
#               "  GROUP BY xcecent,xcecld,xcec102,xcec114,xcec113,xcec111,xcec117,xcec119,xcec120 ",
#               "  ORDER BY xcec102,xcec114,xcec113,xcec111,xcec117,xcec119,xcec120 ",
#               "       )"
#   #160607-00026#1-e-add     
#   PREPARE xcec_prep_2 FROM g_sql
#   DECLARE xcec_curs_2 CURSOR FOR xcec_prep_2
#   FOREACH xcec_curs_2 INTO l_xcec.xcec102,l_xcec.xcec114,l_xcec.xcec113,
#                            l_xcec.xcec111,l_xcec.xcec117,l_xcec.xcec119,l_xcec.xcec120,
#                            l_xcec.xcec202b,l_xcec.xcec202c,l_xcec.xcec202d,l_xcec.xcec202e,l_xcec.xcec202f,
#                            l_xcec.xcec202g,l_xcec.xcec202h, 
#                            l_xcec.xcec212b,l_xcec.xcec212c,l_xcec.xcec212d,l_xcec.xcec212e,l_xcec.xcec212f,
#                            l_xcec.xcec212g,l_xcec.xcec212h,
#                            l_xcec.xcec222b,l_xcec.xcec222c,l_xcec.xcec222d,l_xcec.xcec222e,l_xcec.xcec222f,
#                            l_xcec.xcec222g,l_xcec.xcec222h,
#                            l_xced101_1,l_xced101_2,l_xced101_3,l_xced101_4,l_xced101_5,l_xced101_6,l_xced101_7  #160607-00026#1 add                                                      
#      IF SQLCA.sqlcode THEN
#         INITIALIZE g_errparam TO NULL
#         LET g_errparam.code = SQLCA.sqlcode
#         LET g_errparam.extend = "foreach xcec"
#         LET g_errparam.popup = TRUE
#         CALL cl_err()
#
#         LET g_success = 'N'
#         EXIT FOREACH
#      END IF  
#   
#      LET l_xced.xced102 = l_xcec.xcec102
#      LET l_xced.xced114 = l_xcec.xcec114
#      LET l_xced.xced113 = l_xcec.xcec113
#      LET l_xced.xced111 = l_xcec.xcec111
#      LET l_xced.xced117 = l_xcec.xcec117
#      LET l_xced.xced119 = l_xcec.xcec119
#      LET l_xced.xced120 = l_xcec.xcec120
#      
#      #160607-00026#1-s-mark
#      ##在制人工科目
#      #CALL s_get_item_acc(g_xcea_m.xceald,'6',l_xcec.xcec004,'','',g_xcea_m.xceacomp,'') 
#      #  RETURNING l_success,l_xced101_1  
#      #
#      ##agli161抓不到，改抓axci201的科目
#      #IF cl_null(l_xced101_1) THEN
#      #   CALL s_fin_get_account(g_xcea_m.xceald,'60','8912','2') RETURNING l_success,l_xced101_1,l_errno
#      #END IF
#      #
#      ##在制加工费科目
#      #CALL s_get_item_acc(g_xcea_m.xceald,'7',l_xcec.xcec004,'','',g_xcea_m.xceacomp,'') 
#      #  RETURNING l_success,l_xced101_2  
#      #
#      ##agli161抓不到，改抓axci201的科目
#      #IF cl_null(l_xced101_2) THEN
#      #   #CALL s_fin_get_account(g_xcea_m.xceald,'60','8912','3') RETURNING l_success,l_xced101_2,l_errno
#      #   CALL s_fin_get_account(g_xcea_m.xceald,'60','8912','15') RETURNING l_success,l_xced101_2,l_errno  #mod 160519 160520-00014#3
#      #END IF
#      #
#      ##在制制费一科目
#      #CALL s_get_item_acc(g_xcea_m.xceald,'11',l_xcec.xcec004,'','',g_xcea_m.xceacomp,'') 
#      #  RETURNING l_success,l_xced101_3  
#      #
#      #IF cl_null(l_xced101_3) THEN
#      #   #LET l_xced101_3 = l_xced101_2
#      #   CALL s_fin_get_account(g_xcea_m.xceald,'60','8912','3') RETURNING l_success,l_xced101_3,l_errno  #mod 160519 160520-00014#3
#      #END IF
#      #
#      ##在制制费二科目
#      #CALL s_get_item_acc(g_xcea_m.xceald,'12',l_xcec.xcec004,'','',g_xcea_m.xceacomp,'') 
#      #  RETURNING l_success,l_xced101_4  
#      #
#      #IF cl_null(l_xced101_4) THEN
#      #   #LET l_xced101_4 = l_xced101_2
#      #   CALL s_fin_get_account(g_xcea_m.xceald,'60','8912','11') RETURNING l_success,l_xced101_4,l_errno  #mod 160519 160520-00014#3
#      #END IF
#      #
#      ##在制制费三科目
#      #CALL s_get_item_acc(g_xcea_m.xceald,'13',l_xcec.xcec004,'','',g_xcea_m.xceacomp,'') 
#      #  RETURNING l_success,l_xced101_5  
#      #
#      #IF cl_null(l_xced101_5) THEN
#      #   #LET l_xced101_5 = l_xced101_2
#      #   CALL s_fin_get_account(g_xcea_m.xceald,'60','8912','12') RETURNING l_success,l_xced101_5,l_errno  #mod 160519 160520-00014#3
#      #END IF
#      #
#      ##在制费四科目
#      #CALL s_get_item_acc(g_xcea_m.xceald,'14',l_xcec.xcec004,'','',g_xcea_m.xceacomp,'') 
#      #  RETURNING l_success,l_xced101_6  
#      #
#      #IF cl_null(l_xced101_6) THEN
#      #   #LET l_xced101_6 = l_xced101_2
#      #   CALL s_fin_get_account(g_xcea_m.xceald,'60','8912','13') RETURNING l_success,l_xced101_6,l_errno  #mod 160519 160520-00014#3
#      #END IF
#      #
#      ##在制制费五科目
#      #CALL s_get_item_acc(g_xcea_m.xceald,'15',l_xcec.xcec004,'','',g_xcea_m.xceacomp,'') 
#      #  RETURNING l_success,l_xced101_7  
#      #
#      #IF cl_null(l_xced101_7) THEN
#      #   #LET l_xced101_7 = l_xced101_2
#      #   CALL s_fin_get_account(g_xcea_m.xceald,'60','8912','14') RETURNING l_success,l_xced101_7,l_errno  #mod 160519 160520-00014#3
#      #END IF         
#      #160607-00026#1-e-mark         
#     
#     #項次
#     #160829-00005#2-s-mark 
#     #SELECT MAX(xcedseq) INTO l_xced.xcedseq FROM xced_t
#     # WHERE xcedent = g_enterprise 
#     #   AND xcedld = g_xcea_m.xceald
#     #   AND xceddocno = g_xcea_m.xceadocno
#     #160829-00005#2-e-mark   
#      EXECUTE axct701_01_xced_prep INTO l_xced.xcedseq   #160829-00005#2 add          
#         
#      IF cl_null(l_xced.xcedseq) OR l_xced.xcedseq = 0 THEN
#         LET l_xced.xcedseq = 1
#      ELSE
#         LET l_xced.xcedseq = l_xced.xcedseq + 1
#      END IF       
#      LET l_xced.xcedent   = g_enterprise
#      LET l_xced.xcedcomp  = g_xcea_m.xceacomp
#      LET l_xced.xcedld    = g_xcea_m.xceald
#      LET l_xced.xceddocno = g_xcea_m.xceadocno
#      LET l_xced.xced001   = 1
#      LET l_xced.xced101   = l_xced101_1
#      LET l_xced.xced110   = ''
#      LET l_xced.xced112   = ''
#      LET l_xced.xced115   = ''
#      LET l_xced.xced116   = ''
#      LET l_xced.xced118   = ''
#      LET l_xced.xced202   = l_xcec.xcec202b
#      LET l_xced.xced212   = l_xcec.xcec212b
#      LET l_xced.xced222   = l_xcec.xcec222b
#      LET l_xced.xced301   = ''
#      LET l_xced.xced302   = '' 
#      
#     #INSERT INTO xced_t VALUES (l_xced.*)  #160829-00005#2 mark
#     #160829-00005#2-s-add
#      EXECUTE axcq701_01_ins_xced_p USING l_xced.xcedent,l_xced.xcedcomp, l_xced.xcedld,l_xced.xceddocno,l_xced.xcedseq,
#                                          l_xced.xced001, l_xced.xced101,l_xced.xced102,  l_xced.xced110,l_xced.xced111,
#                                          l_xced.xced112, l_xced.xced113,l_xced.xced114,  l_xced.xced115,l_xced.xced116,
#                                          l_xced.xced117, l_xced.xced118,l_xced.xced119,  l_xced.xced120,l_xced.xced202,
#                                          l_xced.xced212, l_xced.xced222,l_xced.xced301,  l_xced.xced107,l_xced.xced108,
#                                          l_xced.xced109, l_xced.xced121,l_xced.xced122,  l_xced.xced123,l_xced.xced124,
#                                          l_xced.xced125, l_xced.xced126,l_xced.xced127,  l_xced.xced128,l_xced.xced129,
#                                          l_xced.xced130, l_xced.xced302 
#     #160829-00005#2-e-add      
#      IF SQLCA.sqlcode THEN
#         INITIALIZE g_errparam TO NULL
#         LET g_errparam.code = SQLCA.sqlcode
#         LET g_errparam.extend = "xced 1"
#         LET g_errparam.popup = TRUE
#         CALL cl_err()
#
#         LET g_success = 'N'
#         EXIT FOREACH
#      END IF  
#
#      LET l_xced.xcedent   = g_enterprise
#      LET l_xced.xcedcomp  = g_xcea_m.xceacomp
#      LET l_xced.xcedld    = g_xcea_m.xceald
#      LET l_xced.xceddocno = g_xcea_m.xceadocno
#      LET l_xced.xced001   = 2
#      LET l_xced.xced101   = l_xced101_2
#      LET l_xced.xced110   = ''
#      LET l_xced.xced112   = ''
#      LET l_xced.xced115   = ''
#      LET l_xced.xced116   = ''
#      LET l_xced.xced118   = ''
#      LET l_xced.xced202   = l_xcec.xcec202c
#      LET l_xced.xced212   = l_xcec.xcec212c
#      LET l_xced.xced222   = l_xcec.xcec222c
#      LET l_xced.xced301   = ''
#      LET l_xced.xced302   = '' 
#      LET l_xced.xcedseq = l_xced.xcedseq + 1    
#      
#     #INSERT INTO xced_t VALUES (l_xced.*)  #160829-00005#2 mark
#     #160829-00005#2-s-add
#      EXECUTE axcq701_01_ins_xced_p USING l_xced.xcedent,l_xced.xcedcomp, l_xced.xcedld,l_xced.xceddocno,l_xced.xcedseq,
#                                          l_xced.xced001, l_xced.xced101,l_xced.xced102,  l_xced.xced110,l_xced.xced111,
#                                          l_xced.xced112, l_xced.xced113,l_xced.xced114,  l_xced.xced115,l_xced.xced116,
#                                          l_xced.xced117, l_xced.xced118,l_xced.xced119,  l_xced.xced120,l_xced.xced202,
#                                          l_xced.xced212, l_xced.xced222,l_xced.xced301,  l_xced.xced107,l_xced.xced108,
#                                          l_xced.xced109, l_xced.xced121,l_xced.xced122,  l_xced.xced123,l_xced.xced124,
#                                          l_xced.xced125, l_xced.xced126,l_xced.xced127,  l_xced.xced128,l_xced.xced129,
#                                          l_xced.xced130, l_xced.xced302 
#     #160829-00005#2-e-add      
#      IF SQLCA.sqlcode THEN
#         INITIALIZE g_errparam TO NULL
#         LET g_errparam.code = SQLCA.sqlcode
#         LET g_errparam.extend = "xced 2"
#         LET g_errparam.popup = TRUE
#         CALL cl_err()
#
#         LET g_success = 'N'
#         EXIT FOREACH
#      END IF
#
#
#      LET l_xced.xcedent   = g_enterprise
#      LET l_xced.xcedcomp  = g_xcea_m.xceacomp
#      LET l_xced.xcedld    = g_xcea_m.xceald
#      LET l_xced.xceddocno = g_xcea_m.xceadocno
#      LET l_xced.xced001   = 3
#      LET l_xced.xced101   = l_xced101_3
#      LET l_xced.xced110   = ''
#      LET l_xced.xced112   = ''
#      LET l_xced.xced115   = ''
#      LET l_xced.xced116   = ''
#      LET l_xced.xced118   = ''
#      LET l_xced.xced202   = l_xcec.xcec202d
#      LET l_xced.xced212   = l_xcec.xcec212d
#      LET l_xced.xced222   = l_xcec.xcec222d
#      LET l_xced.xced301   = ''
#      LET l_xced.xced302   = '' 
#      LET l_xced.xcedseq = l_xced.xcedseq + 1 
#      
#     #INSERT INTO xced_t VALUES (l_xced.*)  #160829-00005#2 mark
#     #160829-00005#2-s-add
#      EXECUTE axcq701_01_ins_xced_p USING l_xced.xcedent,l_xced.xcedcomp, l_xced.xcedld,l_xced.xceddocno,l_xced.xcedseq,
#                                          l_xced.xced001, l_xced.xced101,l_xced.xced102,  l_xced.xced110,l_xced.xced111,
#                                          l_xced.xced112, l_xced.xced113,l_xced.xced114,  l_xced.xced115,l_xced.xced116,
#                                          l_xced.xced117, l_xced.xced118,l_xced.xced119,  l_xced.xced120,l_xced.xced202,
#                                          l_xced.xced212, l_xced.xced222,l_xced.xced301,  l_xced.xced107,l_xced.xced108,
#                                          l_xced.xced109, l_xced.xced121,l_xced.xced122,  l_xced.xced123,l_xced.xced124,
#                                          l_xced.xced125, l_xced.xced126,l_xced.xced127,  l_xced.xced128,l_xced.xced129,
#                                          l_xced.xced130, l_xced.xced302 
#     #160829-00005#2-e-add      
#      IF SQLCA.sqlcode THEN
#         INITIALIZE g_errparam TO NULL
#         LET g_errparam.code = SQLCA.sqlcode
#         LET g_errparam.extend = "xced 3"
#         LET g_errparam.popup = TRUE
#         CALL cl_err()
#
#         LET g_success = 'N'
#         EXIT FOREACH
#      END IF   
#      
#      LET l_xced.xcedent   = g_enterprise
#      LET l_xced.xcedcomp  = g_xcea_m.xceacomp
#      LET l_xced.xcedld    = g_xcea_m.xceald
#      LET l_xced.xceddocno = g_xcea_m.xceadocno
#      LET l_xced.xced001   = 4
#      LET l_xced.xced101   = l_xced101_4
#      LET l_xced.xced110   = ''
#      LET l_xced.xced112   = ''
#      LET l_xced.xced115   = ''
#      LET l_xced.xced116   = ''
#      LET l_xced.xced118   = ''
#      LET l_xced.xced202   = l_xcec.xcec202e
#      LET l_xced.xced212   = l_xcec.xcec212e
#      LET l_xced.xced222   = l_xcec.xcec222e
#      LET l_xced.xced301   = ''
#      LET l_xced.xced302   = '' 
#      LET l_xced.xcedseq = l_xced.xcedseq + 1 
#      
#     #INSERT INTO xced_t VALUES (l_xced.*)  #160829-00005#2 mark
#     #160829-00005#2-s-add
#      EXECUTE axcq701_01_ins_xced_p USING l_xced.xcedent,l_xced.xcedcomp, l_xced.xcedld,l_xced.xceddocno,l_xced.xcedseq,
#                                          l_xced.xced001, l_xced.xced101,l_xced.xced102,  l_xced.xced110,l_xced.xced111,
#                                          l_xced.xced112, l_xced.xced113,l_xced.xced114,  l_xced.xced115,l_xced.xced116,
#                                          l_xced.xced117, l_xced.xced118,l_xced.xced119,  l_xced.xced120,l_xced.xced202,
#                                          l_xced.xced212, l_xced.xced222,l_xced.xced301,  l_xced.xced107,l_xced.xced108,
#                                          l_xced.xced109, l_xced.xced121,l_xced.xced122,  l_xced.xced123,l_xced.xced124,
#                                          l_xced.xced125, l_xced.xced126,l_xced.xced127,  l_xced.xced128,l_xced.xced129,
#                                          l_xced.xced130, l_xced.xced302 
#     #160829-00005#2-e-add      
#      IF SQLCA.sqlcode THEN
#         INITIALIZE g_errparam TO NULL
#         LET g_errparam.code = SQLCA.sqlcode
#         LET g_errparam.extend = "xced 4"
#         LET g_errparam.popup = TRUE
#         CALL cl_err()
#
#         LET g_success = 'N'
#         EXIT FOREACH
#      END IF  
#      
#      LET l_xced.xcedent   = g_enterprise
#      LET l_xced.xcedcomp  = g_xcea_m.xceacomp
#      LET l_xced.xcedld    = g_xcea_m.xceald
#      LET l_xced.xceddocno = g_xcea_m.xceadocno
#      LET l_xced.xced001   = 5
#      LET l_xced.xced101   = l_xced101_5
#      LET l_xced.xced110   = ''
#      LET l_xced.xced112   = ''
#      LET l_xced.xced115   = ''
#      LET l_xced.xced116   = ''
#      LET l_xced.xced118   = ''
#      LET l_xced.xced202   = l_xcec.xcec202f
#      LET l_xced.xced212   = l_xcec.xcec212f
#      LET l_xced.xced222   = l_xcec.xcec222f
#      LET l_xced.xced301   = ''
#      LET l_xced.xced302   = '' 
#      LET l_xced.xcedseq = l_xced.xcedseq + 1 
#      
#     #INSERT INTO xced_t VALUES (l_xced.*)  #160829-00005#2 mark
#     #160829-00005#2-s-add
#      EXECUTE axcq701_01_ins_xced_p USING l_xced.xcedent,l_xced.xcedcomp, l_xced.xcedld,l_xced.xceddocno,l_xced.xcedseq,
#                                          l_xced.xced001, l_xced.xced101,l_xced.xced102,  l_xced.xced110,l_xced.xced111,
#                                          l_xced.xced112, l_xced.xced113,l_xced.xced114,  l_xced.xced115,l_xced.xced116,
#                                          l_xced.xced117, l_xced.xced118,l_xced.xced119,  l_xced.xced120,l_xced.xced202,
#                                          l_xced.xced212, l_xced.xced222,l_xced.xced301,  l_xced.xced107,l_xced.xced108,
#                                          l_xced.xced109, l_xced.xced121,l_xced.xced122,  l_xced.xced123,l_xced.xced124,
#                                          l_xced.xced125, l_xced.xced126,l_xced.xced127,  l_xced.xced128,l_xced.xced129,
#                                          l_xced.xced130, l_xced.xced302 
#     #160829-00005#2-e-add      
#      IF SQLCA.sqlcode THEN
#         INITIALIZE g_errparam TO NULL
#         LET g_errparam.code = SQLCA.sqlcode
#         LET g_errparam.extend = "xced 5"
#         LET g_errparam.popup = TRUE
#         CALL cl_err()
#
#         LET g_success = 'N'
#         EXIT FOREACH
#      END IF  
#      
#      LET l_xced.xcedent   = g_enterprise
#      LET l_xced.xcedcomp  = g_xcea_m.xceacomp
#      LET l_xced.xcedld    = g_xcea_m.xceald
#      LET l_xced.xceddocno = g_xcea_m.xceadocno
#      LET l_xced.xced001   = 6
#      LET l_xced.xced101   = l_xced101_6
#      LET l_xced.xced110   = ''
#      LET l_xced.xced112   = ''
#      LET l_xced.xced115   = ''
#      LET l_xced.xced116   = ''
#      LET l_xced.xced118   = ''
#      LET l_xced.xced202   = l_xcec.xcec202g
#      LET l_xced.xced212   = l_xcec.xcec212g
#      LET l_xced.xced222   = l_xcec.xcec222g
#      LET l_xced.xced301   = ''
#      LET l_xced.xced302   = '' 
#      LET l_xced.xcedseq = l_xced.xcedseq + 1 
#       
#     #INSERT INTO xced_t VALUES (l_xced.*)  #160829-00005#2 mark
#     #160829-00005#2-s-add
#      EXECUTE axcq701_01_ins_xced_p USING l_xced.xcedent,l_xced.xcedcomp, l_xced.xcedld,l_xced.xceddocno,l_xced.xcedseq,
#                                          l_xced.xced001, l_xced.xced101,l_xced.xced102,  l_xced.xced110,l_xced.xced111,
#                                          l_xced.xced112, l_xced.xced113,l_xced.xced114,  l_xced.xced115,l_xced.xced116,
#                                          l_xced.xced117, l_xced.xced118,l_xced.xced119,  l_xced.xced120,l_xced.xced202,
#                                          l_xced.xced212, l_xced.xced222,l_xced.xced301,  l_xced.xced107,l_xced.xced108,
#                                          l_xced.xced109, l_xced.xced121,l_xced.xced122,  l_xced.xced123,l_xced.xced124,
#                                          l_xced.xced125, l_xced.xced126,l_xced.xced127,  l_xced.xced128,l_xced.xced129,
#                                          l_xced.xced130, l_xced.xced302 
#     #160829-00005#2-e-add      
#      IF SQLCA.sqlcode THEN
#         INITIALIZE g_errparam TO NULL
#         LET g_errparam.code = SQLCA.sqlcode
#         LET g_errparam.extend = "xced 6"
#         LET g_errparam.popup = TRUE
#         CALL cl_err()
#
#         LET g_success = 'N'
#         EXIT FOREACH
#      END IF 
#      
#      LET l_xced.xcedent   = g_enterprise
#      LET l_xced.xcedcomp  = g_xcea_m.xceacomp
#      LET l_xced.xcedld    = g_xcea_m.xceald
#      LET l_xced.xceddocno = g_xcea_m.xceadocno
#      LET l_xced.xced001   = 7
#      LET l_xced.xced101   = l_xced101_7
#      LET l_xced.xced110   = ''
#      LET l_xced.xced112   = ''
#      LET l_xced.xced115   = ''
#      LET l_xced.xced116   = ''
#      LET l_xced.xced118   = ''
#      LET l_xced.xced202   = l_xcec.xcec202h
#      LET l_xced.xced212   = l_xcec.xcec212h
#      LET l_xced.xced222   = l_xcec.xcec222h
#      LET l_xced.xced301   = ''
#      LET l_xced.xced302   = '' 
#      LET l_xced.xcedseq = l_xced.xcedseq + 1 
#      
#     #INSERT INTO xced_t VALUES (l_xced.*)  #160829-00005#2 mark
#     #160829-00005#2-s-add
#      EXECUTE axcq701_01_ins_xced_p USING l_xced.xcedent,l_xced.xcedcomp, l_xced.xcedld,l_xced.xceddocno,l_xced.xcedseq,
#                                          l_xced.xced001, l_xced.xced101,l_xced.xced102,  l_xced.xced110,l_xced.xced111,
#                                          l_xced.xced112, l_xced.xced113,l_xced.xced114,  l_xced.xced115,l_xced.xced116,
#                                          l_xced.xced117, l_xced.xced118,l_xced.xced119,  l_xced.xced120,l_xced.xced202,
#                                          l_xced.xced212, l_xced.xced222,l_xced.xced301,  l_xced.xced107,l_xced.xced108,
#                                          l_xced.xced109, l_xced.xced121,l_xced.xced122,  l_xced.xced123,l_xced.xced124,
#                                          l_xced.xced125, l_xced.xced126,l_xced.xced127,  l_xced.xced128,l_xced.xced129,
#                                          l_xced.xced130, l_xced.xced302 
#     #160829-00005#2-e-add      
#      IF SQLCA.sqlcode THEN
#         INITIALIZE g_errparam TO NULL
#         LET g_errparam.code = SQLCA.sqlcode
#         LET g_errparam.extend = "xced 7"
#         LET g_errparam.popup = TRUE
#         CALL cl_err()
#
#         LET g_success = 'N'
#         EXIT FOREACH
#      END IF                                 
# 
#   END FOREACH
#END CASE   #add 160519  160520-00014#4
#
#   RETURN g_success 
#161215-00040#1 Mark ---(E)---

END FUNCTION

################################################################################
# Descriptions...: 描述说明
# Memo...........:
# Usage..........: CALL s_aooi150_ins (传入参数)
#                  RETURNING 回传参数
# Input parameter: 传入参数变量1   传入参数变量说明1
#                : 传入参数变量2   传入参数变量说明2
# Return code....: 回传参数变量1   回传参数变量说明1
#                : 回传参数变量2   回传参数变量说明2
# Date & Author..: 日期 By 作者
# Modify.........:
################################################################################
PRIVATE FUNCTION axct701_01_ins_2_bak()
#161215-00040#1 Mark ---(S)---
#DEFINE l_success       LIKE type_t.num5
#DEFINE l_errno         LIKE gzze_t.gzze001
##161109-00085#18-s mod
##DEFINE l_xcea          RECORD LIKE xcea_t.*   #161109-00085#18-s mark
#DEFINE l_xcea          RECORD  #工單發料成本憑證單頭檔
#       xceaent LIKE xcea_t.xceaent, #企業編號
#       xceacomp LIKE xcea_t.xceacomp, #法人組織
#       xceald LIKE xcea_t.xceald, #帳套
#       xceadocno LIKE xcea_t.xceadocno, #單據編號
#       xcea001 LIKE xcea_t.xcea001, #單據日期
#       xcea002 LIKE xcea_t.xcea002, #成本憑證類型
#       xcea003 LIKE xcea_t.xcea003, #成本計算類型
#       xcea004 LIKE xcea_t.xcea004, #年度
#       xcea005 LIKE xcea_t.xcea005, #期別
#       xcea006 LIKE xcea_t.xcea006, #帳務人員
#       xcea007 LIKE xcea_t.xcea007, #帳務部門
#       xcea101 LIKE xcea_t.xcea101, #憑證編號
#       xcea102 LIKE xcea_t.xcea102, #憑證日期
#       xceaownid LIKE xcea_t.xceaownid, #資料所有者
#       xceaowndp LIKE xcea_t.xceaowndp, #資料所屬部門
#       xceacrtid LIKE xcea_t.xceacrtid, #資料建立者
#       xceacrtdp LIKE xcea_t.xceacrtdp, #資料建立部門
#       xceacrtdt LIKE xcea_t.xceacrtdt, #資料創建日
#       xceamodid LIKE xcea_t.xceamodid, #資料修改者
#       xceamoddt LIKE xcea_t.xceamoddt, #最近修改日
#       xceacnfid LIKE xcea_t.xceacnfid, #資料確認者
#       xceacnfdt LIKE xcea_t.xceacnfdt, #資料確認日
#       xceapstid LIKE xcea_t.xceapstid, #資料過帳者
#       xceapstdt LIKE xcea_t.xceapstdt, #資料過帳日
#       xceastus LIKE xcea_t.xceastus, #狀態碼
#       #161109-00085#63 --s add
#       xceaud001 LIKE xcea_t.xceaud001, #自定義欄位(文字)001
#       xceaud002 LIKE xcea_t.xceaud002, #自定義欄位(文字)002
#       xceaud003 LIKE xcea_t.xceaud003, #自定義欄位(文字)003
#       xceaud004 LIKE xcea_t.xceaud004, #自定義欄位(文字)004
#       xceaud005 LIKE xcea_t.xceaud005, #自定義欄位(文字)005
#       xceaud006 LIKE xcea_t.xceaud006, #自定義欄位(文字)006
#       xceaud007 LIKE xcea_t.xceaud007, #自定義欄位(文字)007
#       xceaud008 LIKE xcea_t.xceaud008, #自定義欄位(文字)008
#       xceaud009 LIKE xcea_t.xceaud009, #自定義欄位(文字)009
#       xceaud010 LIKE xcea_t.xceaud010, #自定義欄位(文字)010
#       xceaud011 LIKE xcea_t.xceaud011, #自定義欄位(數字)011
#       xceaud012 LIKE xcea_t.xceaud012, #自定義欄位(數字)012
#       xceaud013 LIKE xcea_t.xceaud013, #自定義欄位(數字)013
#       xceaud014 LIKE xcea_t.xceaud014, #自定義欄位(數字)014
#       xceaud015 LIKE xcea_t.xceaud015, #自定義欄位(數字)015
#       xceaud016 LIKE xcea_t.xceaud016, #自定義欄位(數字)016
#       xceaud017 LIKE xcea_t.xceaud017, #自定義欄位(數字)017
#       xceaud018 LIKE xcea_t.xceaud018, #自定義欄位(數字)018
#       xceaud019 LIKE xcea_t.xceaud019, #自定義欄位(數字)019
#       xceaud020 LIKE xcea_t.xceaud020, #自定義欄位(數字)020
#       xceaud021 LIKE xcea_t.xceaud021, #自定義欄位(日期時間)021
#       xceaud022 LIKE xcea_t.xceaud022, #自定義欄位(日期時間)022
#       xceaud023 LIKE xcea_t.xceaud023, #自定義欄位(日期時間)023
#       xceaud024 LIKE xcea_t.xceaud024, #自定義欄位(日期時間)024
#       xceaud025 LIKE xcea_t.xceaud025, #自定義欄位(日期時間)025
#       xceaud026 LIKE xcea_t.xceaud026, #自定義欄位(日期時間)026
#       xceaud027 LIKE xcea_t.xceaud027, #自定義欄位(日期時間)027
#       xceaud028 LIKE xcea_t.xceaud028, #自定義欄位(日期時間)028
#       xceaud029 LIKE xcea_t.xceaud029, #自定義欄位(日期時間)029
#       xceaud030 LIKE xcea_t.xceaud030, #自定義欄位(日期時間)030
#       #161109-00085#63 --e add
#       xceasite LIKE xcea_t.xceasite  #營運據點
#          END RECORD
##161109-00085#18-e mod
##161109-00085#18-s mod
##DEFINE l_xceb          RECORD LIKE xceb_t.*   #161109-00085#18-s mark
#DEFINE l_xceb          RECORD  #成本憑證第一單身檔
#       xcebent LIKE xceb_t.xcebent, #企業編號
#       xcebcomp LIKE xceb_t.xcebcomp, #法人組織
#       xcebld LIKE xceb_t.xcebld, #帳套
#       xcebdocno LIKE xceb_t.xcebdocno, #單據編號
#       xcebseq LIKE xceb_t.xcebseq, #項次
#       xceb001 LIKE xceb_t.xceb001, #參考單據編號
#       xceb002 LIKE xceb_t.xceb002, #參考單據項次
#       xceb003 LIKE xceb_t.xceb003, #單據類型
#       xceb004 LIKE xceb_t.xceb004, #料件編號
#       xceb005 LIKE xceb_t.xceb005, #特性
#       xceb101 LIKE xceb_t.xceb101, #科目編號
#       xceb102 LIKE xceb_t.xceb102, #摘要
#       xceb103 LIKE xceb_t.xceb103, #成本域
#       xceb110 LIKE xceb_t.xceb110, #原因碼
#       xceb111 LIKE xceb_t.xceb111, #收付款客商
#       xceb112 LIKE xceb_t.xceb112, #客群
#       xceb113 LIKE xceb_t.xceb113, #區域
#       xceb114 LIKE xceb_t.xceb114, #成本中心
#       xceb115 LIKE xceb_t.xceb115, #經營類別
#       xceb116 LIKE xceb_t.xceb116, #通路
#       xceb117 LIKE xceb_t.xceb117, #品類
#       xceb118 LIKE xceb_t.xceb118, #品牌
#       xceb119 LIKE xceb_t.xceb119, #專案號
#       xceb120 LIKE xceb_t.xceb120, #WBS
#       xceb201 LIKE xceb_t.xceb201, #數量
#       xceb202 LIKE xceb_t.xceb202, #成本金額(本位幣一)
#       xceb202a LIKE xceb_t.xceb202a, #成本-材料(本位幣一)
#       xceb202b LIKE xceb_t.xceb202b, #成本-人工(本位幣一)
#       xceb202c LIKE xceb_t.xceb202c, #成本-加工(本位幣一)
#       xceb202d LIKE xceb_t.xceb202d, #成本-制費一(本位幣一)
#       xceb202e LIKE xceb_t.xceb202e, #成本-制費二(本位幣一)
#       xceb202f LIKE xceb_t.xceb202f, #成本-制費三(本位幣一)
#       xceb202g LIKE xceb_t.xceb202g, #成本-制費四(本位幣一)
#       xceb202h LIKE xceb_t.xceb202h, #成本-制費五(本位幣一)
#       xceb212 LIKE xceb_t.xceb212, #成本金額(本位幣二)
#       xceb212a LIKE xceb_t.xceb212a, #成本-材料(本位幣二)
#       xceb212b LIKE xceb_t.xceb212b, #成本-人工(本位幣二)
#       xceb212c LIKE xceb_t.xceb212c, #成本-加工(本位幣二)
#       xceb212d LIKE xceb_t.xceb212d, #成本-制費一(本位幣二)
#       xceb212e LIKE xceb_t.xceb212e, #成本-制費二(本位幣二)
#       xceb212f LIKE xceb_t.xceb212f, #成本-制費三(本位幣二)
#       xceb212g LIKE xceb_t.xceb212g, #成本-制費四(本位幣二)
#       xceb212h LIKE xceb_t.xceb212h, #成本-制費五(本位幣二)
#       xceb222 LIKE xceb_t.xceb222, #成本金額(本位幣三)
#       xceb222a LIKE xceb_t.xceb222a, #成本-材料(本位幣三)
#       xceb222b LIKE xceb_t.xceb222b, #成本-人工(本位幣三)
#       xceb222c LIKE xceb_t.xceb222c, #成本-加工(本位幣三)
#       xceb222d LIKE xceb_t.xceb222d, #成本-制費一(本位幣三)
#       xceb222e LIKE xceb_t.xceb222e, #成本-制費二(本位幣三)
#       xceb222f LIKE xceb_t.xceb222f, #成本-制費三(本位幣三)
#       xceb222g LIKE xceb_t.xceb222g, #成本-制費四(本位幣三)
#       xceb222h LIKE xceb_t.xceb222h, #成本-制費五(本位幣三)
#       xceb301 LIKE xceb_t.xceb301, #憑證編號
#       xceb302 LIKE xceb_t.xceb302, #憑證項次
#       #161109-00085#63 --s add  
#       xcebud001 LIKE xceb_t.xcebud001, #自定義欄位(文字)001
#       xcebud002 LIKE xceb_t.xcebud002, #自定義欄位(文字)002
#       xcebud003 LIKE xceb_t.xcebud003, #自定義欄位(文字)003
#       xcebud004 LIKE xceb_t.xcebud004, #自定義欄位(文字)004
#       xcebud005 LIKE xceb_t.xcebud005, #自定義欄位(文字)005
#       xcebud006 LIKE xceb_t.xcebud006, #自定義欄位(文字)006
#       xcebud007 LIKE xceb_t.xcebud007, #自定義欄位(文字)007
#       xcebud008 LIKE xceb_t.xcebud008, #自定義欄位(文字)008
#       xcebud009 LIKE xceb_t.xcebud009, #自定義欄位(文字)009
#       xcebud010 LIKE xceb_t.xcebud010, #自定義欄位(文字)010
#       xcebud011 LIKE xceb_t.xcebud011, #自定義欄位(數字)011
#       xcebud012 LIKE xceb_t.xcebud012, #自定義欄位(數字)012
#       xcebud013 LIKE xceb_t.xcebud013, #自定義欄位(數字)013
#       xcebud014 LIKE xceb_t.xcebud014, #自定義欄位(數字)014
#       xcebud015 LIKE xceb_t.xcebud015, #自定義欄位(數字)015
#       xcebud016 LIKE xceb_t.xcebud016, #自定義欄位(數字)016
#       xcebud017 LIKE xceb_t.xcebud017, #自定義欄位(數字)017
#       xcebud018 LIKE xceb_t.xcebud018, #自定義欄位(數字)018
#       xcebud019 LIKE xceb_t.xcebud019, #自定義欄位(數字)019
#       xcebud020 LIKE xceb_t.xcebud020, #自定義欄位(數字)020
#       xcebud021 LIKE xceb_t.xcebud021, #自定義欄位(日期時間)021
#       xcebud022 LIKE xceb_t.xcebud022, #自定義欄位(日期時間)022
#       xcebud023 LIKE xceb_t.xcebud023, #自定義欄位(日期時間)023
#       xcebud024 LIKE xceb_t.xcebud024, #自定義欄位(日期時間)024
#       xcebud025 LIKE xceb_t.xcebud025, #自定義欄位(日期時間)025
#       xcebud026 LIKE xceb_t.xcebud026, #自定義欄位(日期時間)026
#       xcebud027 LIKE xceb_t.xcebud027, #自定義欄位(日期時間)027
#       xcebud028 LIKE xceb_t.xcebud028, #自定義欄位(日期時間)028
#       xcebud029 LIKE xceb_t.xcebud029, #自定義欄位(日期時間)029
#       xcebud030 LIKE xceb_t.xcebud030, #自定義欄位(日期時間)030
#       #161109-00085#63 --e add
#       xceb107 LIKE xceb_t.xceb107, #人員
#       xceb108 LIKE xceb_t.xceb108, #部門
#       xceb109 LIKE xceb_t.xceb109, #帳款對象
#       xceb121 LIKE xceb_t.xceb121, #自由核算項1
#       xceb122 LIKE xceb_t.xceb122, #自由核算項2
#       xceb123 LIKE xceb_t.xceb123, #自由核算項3
#       xceb124 LIKE xceb_t.xceb124, #自由核算項4
#       xceb125 LIKE xceb_t.xceb125, #自由核算項5
#       xceb126 LIKE xceb_t.xceb126, #自由核算項6
#       xceb127 LIKE xceb_t.xceb127, #自由核算項7
#       xceb128 LIKE xceb_t.xceb128, #自由核算項8
#       xceb129 LIKE xceb_t.xceb129, #自由核算項9
#       xceb130 LIKE xceb_t.xceb130, #自由核算項10
#       xceb131 LIKE xceb_t.xceb131, #單據類型(for 流通)
#       xceb132 LIKE xceb_t.xceb132  #單據日期(for 流通)
#          END RECORD
##161109-00085#18-e mod
##161109-00085#18-s mod
##DEFINE l_xcec          RECORD LIKE xcec_t.*   #161109-00085#18-s mark
#DEFINE l_xcec          RECORD  #成本憑證第二單身檔
#       xcecent LIKE xcec_t.xcecent, #企業編號
#       xceccomp LIKE xcec_t.xceccomp, #法人組織
#       xcecld LIKE xcec_t.xcecld, #帳套
#       xcecdocno LIKE xcec_t.xcecdocno, #單據編號
#       xcecseq LIKE xcec_t.xcecseq, #項次
#       xcec001 LIKE xcec_t.xcec001, #參考單據
#       xcec002 LIKE xcec_t.xcec002, #參考單據項次
#       xcec003 LIKE xcec_t.xcec003, #單據類型
#       xcec004 LIKE xcec_t.xcec004, #料件編號
#       xcec005 LIKE xcec_t.xcec005, #特性
#       xcec101 LIKE xcec_t.xcec101, #科目編號
#       xcec102 LIKE xcec_t.xcec102, #摘要
#       xcec103 LIKE xcec_t.xcec103, #成本域
#       xcec110 LIKE xcec_t.xcec110, #原因碼
#       xcec111 LIKE xcec_t.xcec111, #收付款客商
#       xcec112 LIKE xcec_t.xcec112, #客群
#       xcec113 LIKE xcec_t.xcec113, #區域
#       xcec114 LIKE xcec_t.xcec114, #成本中心
#       xcec115 LIKE xcec_t.xcec115, #經營類別
#       xcec116 LIKE xcec_t.xcec116, #通路
#       xcec117 LIKE xcec_t.xcec117, #品類
#       xcec118 LIKE xcec_t.xcec118, #品牌
#       xcec119 LIKE xcec_t.xcec119, #專案號
#       xcec120 LIKE xcec_t.xcec120, #WBS
#       xcec201 LIKE xcec_t.xcec201, #數量
#       xcec202 LIKE xcec_t.xcec202, #成本金額(本位幣一)
#       xcec202a LIKE xcec_t.xcec202a, #成本-材料(本位幣一)
#       xcec202b LIKE xcec_t.xcec202b, #成本-人工(本位幣一)
#       xcec202c LIKE xcec_t.xcec202c, #成本-加工(本位幣一)
#       xcec202d LIKE xcec_t.xcec202d, #成本-制費一(本位幣一)
#       xcec202e LIKE xcec_t.xcec202e, #成本-制費二(本位幣一)
#       xcec202f LIKE xcec_t.xcec202f, #成本-制費三(本位幣一)
#       xcec202g LIKE xcec_t.xcec202g, #成本-制費四(本位幣一)
#       xcec202h LIKE xcec_t.xcec202h, #成本-制費五(本位幣一)
#       xcec212 LIKE xcec_t.xcec212, #成本-金額(本位幣二)
#       xcec212a LIKE xcec_t.xcec212a, #成本-材料(本位幣二)
#       xcec212b LIKE xcec_t.xcec212b, #成本-人工(本位幣二)
#       xcec212c LIKE xcec_t.xcec212c, #成本-加工(本位幣二)
#       xcec212d LIKE xcec_t.xcec212d, #成本-制費一(本位幣二)
#       xcec212e LIKE xcec_t.xcec212e, #成本-制費二(本位幣二)
#       xcec212f LIKE xcec_t.xcec212f, #成本-制費三(本位幣二)
#       xcec212g LIKE xcec_t.xcec212g, #成本-制費四(本位幣二)
#       xcec212h LIKE xcec_t.xcec212h, #成本-制費五(本位幣二)
#       xcec222 LIKE xcec_t.xcec222, #成本-金額(本位幣三)
#       xcec222a LIKE xcec_t.xcec222a, #成本-材料(本位幣三)
#       xcec222b LIKE xcec_t.xcec222b, #成本-人工(本位幣三)
#       xcec222c LIKE xcec_t.xcec222c, #成本-加工(本位幣三)
#       xcec222d LIKE xcec_t.xcec222d, #成本-制費一(本位幣三)
#       xcec222e LIKE xcec_t.xcec222e, #成本-制費二(本位幣三)
#       xcec222f LIKE xcec_t.xcec222f, #成本-制費三(本位幣三)
#       xcec222g LIKE xcec_t.xcec222g, #成本-制費四(本位幣三)
#       xcec222h LIKE xcec_t.xcec222h, #成本-制費五(本位幣三)
#       xcec301 LIKE xcec_t.xcec301, #憑證編號
#       xcec302 LIKE xcec_t.xcec302, #憑證項次
#       #161109-00085#63 --s add 
#       xcecud001 LIKE xcec_t.xcecud001, #自定義欄位(文字)001
#       xcecud002 LIKE xcec_t.xcecud002, #自定義欄位(文字)002
#       xcecud003 LIKE xcec_t.xcecud003, #自定義欄位(文字)003
#       xcecud004 LIKE xcec_t.xcecud004, #自定義欄位(文字)004
#       xcecud005 LIKE xcec_t.xcecud005, #自定義欄位(文字)005
#       xcecud006 LIKE xcec_t.xcecud006, #自定義欄位(文字)006
#       xcecud007 LIKE xcec_t.xcecud007, #自定義欄位(文字)007
#       xcecud008 LIKE xcec_t.xcecud008, #自定義欄位(文字)008
#       xcecud009 LIKE xcec_t.xcecud009, #自定義欄位(文字)009
#       xcecud010 LIKE xcec_t.xcecud010, #自定義欄位(文字)010
#       xcecud011 LIKE xcec_t.xcecud011, #自定義欄位(數字)011
#       xcecud012 LIKE xcec_t.xcecud012, #自定義欄位(數字)012
#       xcecud013 LIKE xcec_t.xcecud013, #自定義欄位(數字)013
#       xcecud014 LIKE xcec_t.xcecud014, #自定義欄位(數字)014
#       xcecud015 LIKE xcec_t.xcecud015, #自定義欄位(數字)015
#       xcecud016 LIKE xcec_t.xcecud016, #自定義欄位(數字)016
#       xcecud017 LIKE xcec_t.xcecud017, #自定義欄位(數字)017
#       xcecud018 LIKE xcec_t.xcecud018, #自定義欄位(數字)018
#       xcecud019 LIKE xcec_t.xcecud019, #自定義欄位(數字)019
#       xcecud020 LIKE xcec_t.xcecud020, #自定義欄位(數字)020
#       xcecud021 LIKE xcec_t.xcecud021, #自定義欄位(日期時間)021
#       xcecud022 LIKE xcec_t.xcecud022, #自定義欄位(日期時間)022
#       xcecud023 LIKE xcec_t.xcecud023, #自定義欄位(日期時間)023
#       xcecud024 LIKE xcec_t.xcecud024, #自定義欄位(日期時間)024
#       xcecud025 LIKE xcec_t.xcecud025, #自定義欄位(日期時間)025
#       xcecud026 LIKE xcec_t.xcecud026, #自定義欄位(日期時間)026
#       xcecud027 LIKE xcec_t.xcecud027, #自定義欄位(日期時間)027
#       xcecud028 LIKE xcec_t.xcecud028, #自定義欄位(日期時間)028
#       xcecud029 LIKE xcec_t.xcecud029, #自定義欄位(日期時間)029
#       xcecud030 LIKE xcec_t.xcecud030, #自定義欄位(日期時間)030
#       #161109-00085#63 --e add
#       xcec107 LIKE xcec_t.xcec107, #人員
#       xcec108 LIKE xcec_t.xcec108, #部門
#       xcec109 LIKE xcec_t.xcec109, #帳款對象
#       xcec121 LIKE xcec_t.xcec121, #自由核算項1
#       xcec122 LIKE xcec_t.xcec122, #自由核算項2
#       xcec123 LIKE xcec_t.xcec123, #自由核算項3
#       xcec124 LIKE xcec_t.xcec124, #自由核算項4
#       xcec125 LIKE xcec_t.xcec125, #自由核算項5
#       xcec126 LIKE xcec_t.xcec126, #自由核算項6
#       xcec127 LIKE xcec_t.xcec127, #自由核算項7
#       xcec128 LIKE xcec_t.xcec128, #自由核算項8
#       xcec129 LIKE xcec_t.xcec129, #自由核算項9
#       xcec130 LIKE xcec_t.xcec130  #自由核算項10
#               END RECORD
##161109-00085#18-e mod
##161109-00085#18-s mod
##DEFINE l_xced          RECORD LIKE xced_t.*   #161109-00085#18-s mark
#DEFINE l_xced          RECORD  #成本憑證第三單身檔(在製人工費用科目設定)
#       xcedent LIKE xced_t.xcedent, #企業編號
#       xcedcomp LIKE xced_t.xcedcomp, #法人組織
#       xcedld LIKE xced_t.xcedld, #帳套
#       xceddocno LIKE xced_t.xceddocno, #單據編號
#       xcedseq LIKE xced_t.xcedseq, #項次
#       xced001 LIKE xced_t.xced001, #在製科目分類
#       xced101 LIKE xced_t.xced101, #科目編號
#       xced102 LIKE xced_t.xced102, #摘要
#       xced110 LIKE xced_t.xced110, #原因碼
#       xced111 LIKE xced_t.xced111, #收付款客商
#       xced112 LIKE xced_t.xced112, #客群
#       xced113 LIKE xced_t.xced113, #區域
#       xced114 LIKE xced_t.xced114, #成本中心
#       xced115 LIKE xced_t.xced115, #經營類別
#       xced116 LIKE xced_t.xced116, #通路
#       xced117 LIKE xced_t.xced117, #品類
#       xced118 LIKE xced_t.xced118, #品牌
#       xced119 LIKE xced_t.xced119, #專案編號
#       xced120 LIKE xced_t.xced120, #WBS
#       xced202 LIKE xced_t.xced202, #成本金額(本位幣一)
#       xced212 LIKE xced_t.xced212, #成本金額(本位幣二)
#       xced222 LIKE xced_t.xced222, #成本金額(本位幣三)
#       xced301 LIKE xced_t.xced301, #憑證編號
#       xced302 LIKE xced_t.xced302, #憑證項次
#       xced107 LIKE xced_t.xced107, #人員
#       xced108 LIKE xced_t.xced108, #部門
#       xced109 LIKE xced_t.xced109, #帳款對象
#       xced121 LIKE xced_t.xced121, #自由核算項1
#       xced122 LIKE xced_t.xced122, #自由核算項2
#       xced123 LIKE xced_t.xced123, #自由核算項3
#       xced124 LIKE xced_t.xced124, #自由核算項4
#       xced125 LIKE xced_t.xced125, #自由核算項5
#       xced126 LIKE xced_t.xced126, #自由核算項6
#       xced127 LIKE xced_t.xced127, #自由核算項7
#       xced128 LIKE xced_t.xced128, #自由核算項8
#       xced129 LIKE xced_t.xced129, #自由核算項9
#       xced130 LIKE xced_t.xced130  #自由核算項10
#          END RECORD
##161109-00085#18-e mod
##161109-00085#18-s mod
##DEFINE l_xccd          RECORD LIKE xccd_t.*   #161109-00085#18-s mark
#DEFINE l_xccd          RECORD  #在製主件成本期異動統計檔
#       xccdent LIKE xccd_t.xccdent, #企業編號
#       xccdcomp LIKE xccd_t.xccdcomp, #法人組織
#       xccdld LIKE xccd_t.xccdld, #帳套
#       xccd001 LIKE xccd_t.xccd001, #帳套本位幣順序
#       xccd002 LIKE xccd_t.xccd002, #成本域
#       xccd003 LIKE xccd_t.xccd003, #成本計算類型
#       xccd004 LIKE xccd_t.xccd004, #年度
#       xccd005 LIKE xccd_t.xccd005, #期別
#       xccd006 LIKE xccd_t.xccd006, #工單編號
#       xccd007 LIKE xccd_t.xccd007, #主件料號
#       xccd008 LIKE xccd_t.xccd008, #產品特徵
#       xccd009 LIKE xccd_t.xccd009, #批號
#       xccd010 LIKE xccd_t.xccd010, #專案號
#       xccd011 LIKE xccd_t.xccd011, #核算幣別
#       xccd012 LIKE xccd_t.xccd012, #重複性成產否
#       xccd013 LIKE xccd_t.xccd013, #成產計劃號
#       xccd014 LIKE xccd_t.xccd014, #BOM特性
#       xccd101 LIKE xccd_t.xccd101, #上期結存數量
#       xccd102 LIKE xccd_t.xccd102, #上期結存金額
#       xccd102a LIKE xccd_t.xccd102a, #上期結存金額-材料
#       xccd102b LIKE xccd_t.xccd102b, #上期結存金額-人工
#       xccd102c LIKE xccd_t.xccd102c, #上期結存金額-加工
#       xccd102d LIKE xccd_t.xccd102d, #上期結存金額-制費一
#       xccd102e LIKE xccd_t.xccd102e, #上期結存金額-制費二
#       xccd102f LIKE xccd_t.xccd102f, #上期結存金額-制費三
#       xccd102g LIKE xccd_t.xccd102g, #上期結存金額-制費四
#       xccd102h LIKE xccd_t.xccd102h, #上期結存金額-制費五
#       xccd200 LIKE xccd_t.xccd200, #本期投入工時
#       xccd201 LIKE xccd_t.xccd201, #本期投入數量
#       xccd202 LIKE xccd_t.xccd202, #本期本階投入金額
#       xccd202a LIKE xccd_t.xccd202a, #本期本階投入金額-材料
#       xccd202b LIKE xccd_t.xccd202b, #本期本階投入金額-人工
#       xccd202c LIKE xccd_t.xccd202c, #本期本階投入金額-加工
#       xccd202d LIKE xccd_t.xccd202d, #本期本階投入金額-制費一
#       xccd202e LIKE xccd_t.xccd202e, #本期本階投入金額-制費二
#       xccd202f LIKE xccd_t.xccd202f, #本期本階投入金額-制費三
#       xccd202g LIKE xccd_t.xccd202g, #本期本階投入金額-制費四
#       xccd202h LIKE xccd_t.xccd202h, #本期本階投入金額-制費五
#       xccd204 LIKE xccd_t.xccd204, #本期下階投入金額
#       xccd204a LIKE xccd_t.xccd204a, #本期下階投入金額-材料
#       xccd204b LIKE xccd_t.xccd204b, #本期下階投入金額-人工
#       xccd204c LIKE xccd_t.xccd204c, #本期下階投入金額-加工
#       xccd204d LIKE xccd_t.xccd204d, #本期下階投入金額-制費一
#       xccd204e LIKE xccd_t.xccd204e, #本期下階投入金額-制費二
#       xccd204f LIKE xccd_t.xccd204f, #本期下階投入金額-制費三
#       xccd204g LIKE xccd_t.xccd204g, #本期下階投入金額-制費四
#       xccd204h LIKE xccd_t.xccd204h, #本期下階投入金額-制費五
#       xccd301 LIKE xccd_t.xccd301, #本期轉出數量
#       xccd302 LIKE xccd_t.xccd302, #本期轉出金額
#       xccd302a LIKE xccd_t.xccd302a, #本期轉出金額-材料
#       xccd302b LIKE xccd_t.xccd302b, #本期轉出金額-人工
#       xccd302c LIKE xccd_t.xccd302c, #本期轉出金額-加工
#       xccd302d LIKE xccd_t.xccd302d, #本期轉出金額-制費一
#       xccd302e LIKE xccd_t.xccd302e, #本期轉出金額-制費二
#       xccd302f LIKE xccd_t.xccd302f, #本期轉出金額-制費三
#       xccd302g LIKE xccd_t.xccd302g, #本期轉出金額-制費四
#       xccd302h LIKE xccd_t.xccd302h, #本期轉出金額-制費五
#       xccd303 LIKE xccd_t.xccd303, #差異轉出數量
#       xccd304 LIKE xccd_t.xccd304, #差異轉出金額
#       xccd304a LIKE xccd_t.xccd304a, #差異轉出金額-材料
#       xccd304b LIKE xccd_t.xccd304b, #差異轉出金額-人工
#       xccd304c LIKE xccd_t.xccd304c, #差異轉出金額-加工
#       xccd304d LIKE xccd_t.xccd304d, #差異轉出金額-制費一
#       xccd304e LIKE xccd_t.xccd304e, #差異轉出金額-制費二
#       xccd304f LIKE xccd_t.xccd304f, #差異轉出金額-制費三
#       xccd304g LIKE xccd_t.xccd304g, #差異轉出金額-制費四
#       xccd304h LIKE xccd_t.xccd304h, #差異轉出金額-制費五
#       xccd901 LIKE xccd_t.xccd901, #期末結存數量
#       xccd902 LIKE xccd_t.xccd902, #期末結存金額
#       xccd902a LIKE xccd_t.xccd902a, #期末結存金額-材料
#       xccd902b LIKE xccd_t.xccd902b, #期末結存金額-人工
#       xccd902c LIKE xccd_t.xccd902c, #期末結存金額-加工
#       xccd902d LIKE xccd_t.xccd902d, #期末結存金額-制費一
#       xccd902e LIKE xccd_t.xccd902e, #期末結存金額-制費二
#       xccd902f LIKE xccd_t.xccd902f, #期末結存金額-制費三
#       xccd902g LIKE xccd_t.xccd902g, #期末結存金額-制費四
#       xccd902h LIKE xccd_t.xccd902h, #期末結存金額-制費五
#       xccdtime LIKE xccd_t.xccdtime  #最近成本計算時間
#          END RECORD
##161109-00085#18-e mod
##161109-00085#18-s mod
##DEFINE l_xcce          RECORD LIKE xcce_t.*   #161109-00085#18-s mark
#DEFINE l_xcce          RECORD  #在製元件成本期異動統計檔
#       xcceent LIKE xcce_t.xcceent, #企業編號
#       xccecomp LIKE xcce_t.xccecomp, #法人組織
#       xcceld LIKE xcce_t.xcceld, #帳套
#       xcce001 LIKE xcce_t.xcce001, #帳套本位幣順序
#       xcce002 LIKE xcce_t.xcce002, #成本域
#       xcce003 LIKE xcce_t.xcce003, #成本計算類型
#       xcce004 LIKE xcce_t.xcce004, #年度
#       xcce005 LIKE xcce_t.xcce005, #期別
#       xcce006 LIKE xcce_t.xcce006, #工單編號
#       xcce007 LIKE xcce_t.xcce007, #元件編號
#       xcce008 LIKE xcce_t.xcce008, #產品特徵
#       xcce009 LIKE xcce_t.xcce009, #批號
#       xcce010 LIKE xcce_t.xcce010, #核算幣別
#       xcce101 LIKE xcce_t.xcce101, #上期結存數量
#       xcce102 LIKE xcce_t.xcce102, #上期結存金額
#       xcce102a LIKE xcce_t.xcce102a, #上期結存金額-材料
#       xcce102b LIKE xcce_t.xcce102b, #上期結存金額-人工
#       xcce102c LIKE xcce_t.xcce102c, #上期結存金額-加工
#       xcce102d LIKE xcce_t.xcce102d, #上期結存金額-制費一
#       xcce102e LIKE xcce_t.xcce102e, #上期結存金額-制費二
#       xcce102f LIKE xcce_t.xcce102f, #上期結存金額-制費三
#       xcce102g LIKE xcce_t.xcce102g, #上期結存金額-制費四
#       xcce102h LIKE xcce_t.xcce102h, #上期結存金額-制費五
#       xcce201 LIKE xcce_t.xcce201, #本期投入數量
#       xcce202 LIKE xcce_t.xcce202, #本期本階投入金額
#       xcce202a LIKE xcce_t.xcce202a, #本期本階投入金額-材料
#       xcce202b LIKE xcce_t.xcce202b, #本期本階投入金額-人工
#       xcce202c LIKE xcce_t.xcce202c, #本期本階投入金額-加工
#       xcce202d LIKE xcce_t.xcce202d, #本期本階投入金額-制費一
#       xcce202e LIKE xcce_t.xcce202e, #本期本階投入金額-制費二
#       xcce202f LIKE xcce_t.xcce202f, #本期本階投入金額-制費三
#       xcce202g LIKE xcce_t.xcce202g, #本期本階投入金額-制費四
#       xcce202h LIKE xcce_t.xcce202h, #本期本階投入金額-制費五
#       xcce205 LIKE xcce_t.xcce205, #本期當站下線數量
#       xcce206 LIKE xcce_t.xcce206, #本期當站下線成本
#       xcce206a LIKE xcce_t.xcce206a, #本期當站下線成本-材料
#       xcce206b LIKE xcce_t.xcce206b, #本期當站下線成本-人工
#       xcce206c LIKE xcce_t.xcce206c, #本期當站下線成本-加工
#       xcce206d LIKE xcce_t.xcce206d, #本期當站下線成本-制費一
#       xcce206e LIKE xcce_t.xcce206e, #本期當站下線成本-制費二
#       xcce206f LIKE xcce_t.xcce206f, #本期當站下線成本-制費三
#       xcce206g LIKE xcce_t.xcce206g, #本期當站下線成本-制費四
#       xcce206h LIKE xcce_t.xcce206h, #本期當站下線成本-制費五
#       xcce207 LIKE xcce_t.xcce207, #本期一般退料數量
#       xcce208 LIKE xcce_t.xcce208, #本期一般退料成本
#       xcce208a LIKE xcce_t.xcce208a, #本期一般退料成本-材料
#       xcce208b LIKE xcce_t.xcce208b, #本期一般退料成本-人工
#       xcce208c LIKE xcce_t.xcce208c, #本期一般退料成本-加工
#       xcce208d LIKE xcce_t.xcce208d, #本期一般退料成本-制費一
#       xcce208e LIKE xcce_t.xcce208e, #本期一般退料成本-制費二
#       xcce208f LIKE xcce_t.xcce208f, #本期一般退料成本-制費三
#       xcce208g LIKE xcce_t.xcce208g, #本期一般退料成本-制費四
#       xcce208h LIKE xcce_t.xcce208h, #本期一般退料成本-制費五
#       xcce209 LIKE xcce_t.xcce209, #本期超領退數量
#       xcce210 LIKE xcce_t.xcce210, #本期超領退金額
#       xcce210a LIKE xcce_t.xcce210a, #本期超領退金額-材料
#       xcce210b LIKE xcce_t.xcce210b, #本期超領退金額-人工
#       xcce210c LIKE xcce_t.xcce210c, #本期超領退金額-加工
#       xcce210d LIKE xcce_t.xcce210d, #本期超領退金額-制費一
#       xcce210e LIKE xcce_t.xcce210e, #本期超領退金額-制費二
#       xcce210f LIKE xcce_t.xcce210f, #本期超領退金額-制費三
#       xcce210g LIKE xcce_t.xcce210g, #本期超領退金額-制費四
#       xcce210h LIKE xcce_t.xcce210h, #本期超領退金額-制費五
#       xcce301 LIKE xcce_t.xcce301, #本期轉出數量
#       xcce302 LIKE xcce_t.xcce302, #本期轉出金額
#       xcce302a LIKE xcce_t.xcce302a, #本期轉出金額-材料
#       xcce302b LIKE xcce_t.xcce302b, #本期轉出金額-人工
#       xcce302c LIKE xcce_t.xcce302c, #本期轉出金額-加工
#       xcce302d LIKE xcce_t.xcce302d, #本期轉出金額-制費一
#       xcce302e LIKE xcce_t.xcce302e, #本期轉出金額-制費二
#       xcce302f LIKE xcce_t.xcce302f, #本期轉出金額-制費三
#       xcce302g LIKE xcce_t.xcce302g, #本期轉出金額-制費四
#       xcce302h LIKE xcce_t.xcce302h, #本期轉出金額-制費五
#       xcce303 LIKE xcce_t.xcce303, #差異轉出數量
#       xcce304 LIKE xcce_t.xcce304, #差異轉出金額
#       xcce304a LIKE xcce_t.xcce304a, #差異轉出金額-材料
#       xcce304b LIKE xcce_t.xcce304b, #差異轉出金額-人工
#       xcce304c LIKE xcce_t.xcce304c, #差異轉出金額-加工
#       xcce304d LIKE xcce_t.xcce304d, #差異轉出金額-制費一
#       xcce304e LIKE xcce_t.xcce304e, #差異轉出金額-制費二
#       xcce304f LIKE xcce_t.xcce304f, #差異轉出金額-制費三
#       xcce304g LIKE xcce_t.xcce304g, #差異轉出金額-制費四
#       xcce304h LIKE xcce_t.xcce304h, #差異轉出金額-制費五
#       xcce307 LIKE xcce_t.xcce307, #盤差數量
#       xcce308 LIKE xcce_t.xcce308, #盤差金額
#       xcce308a LIKE xcce_t.xcce308a, #盤差金額-材料
#       xcce308b LIKE xcce_t.xcce308b, #盤差金額-人工
#       xcce308c LIKE xcce_t.xcce308c, #盤差金額-加工
#       xcce308d LIKE xcce_t.xcce308d, #盤差金額-制費一
#       xcce308e LIKE xcce_t.xcce308e, #盤差金額-制費二
#       xcce308f LIKE xcce_t.xcce308f, #盤差金額-制費三
#       xcce308g LIKE xcce_t.xcce308g, #盤差金額-制費四
#       xcce308h LIKE xcce_t.xcce308h, #盤差金額-制費五
#       xcce901 LIKE xcce_t.xcce901, #期末結存數量
#       xcce902 LIKE xcce_t.xcce902, #期末結存金額
#       xcce902a LIKE xcce_t.xcce902a, #期末結存金額-材料
#       xcce902b LIKE xcce_t.xcce902b, #期末結存金額-人工
#       xcce902c LIKE xcce_t.xcce902c, #期末結存金額-加工
#       xcce902d LIKE xcce_t.xcce902d, #期末結存金額-制費一
#       xcce902e LIKE xcce_t.xcce902e, #期末結存金額-制費二
#       xcce902f LIKE xcce_t.xcce902f, #期末結存金額-制費三
#       xcce902g LIKE xcce_t.xcce902g, #期末結存金額-制費四
#       xcce902h LIKE xcce_t.xcce902h, #期末結存金額-制費五
#       xccetime LIKE xcce_t.xccetime  #最近成本計算時間
#          END RECORD
##161109-00085#18-e mod
##161109-00085#18-s mod
##DEFINE l_xcch          RECORD LIKE xcch_t.*   #161109-00085#18-s mark
#DEFINE l_xcch          RECORD  #拆件在製主件成本期異動統計檔
#       xcchent LIKE xcch_t.xcchent, #企業編號
#       xcchcomp LIKE xcch_t.xcchcomp, #法人組織
#       xcchld LIKE xcch_t.xcchld, #帳套
#       xcch001 LIKE xcch_t.xcch001, #帳套本位幣順序
#       xcch002 LIKE xcch_t.xcch002, #成本域
#       xcch003 LIKE xcch_t.xcch003, #成本計算類型
#       xcch004 LIKE xcch_t.xcch004, #年度
#       xcch005 LIKE xcch_t.xcch005, #期別
#       xcch006 LIKE xcch_t.xcch006, #拆件工單編號
#       xcch007 LIKE xcch_t.xcch007, #主件料號
#       xcch008 LIKE xcch_t.xcch008, #特性
#       xcch009 LIKE xcch_t.xcch009, #批號
#       xcch010 LIKE xcch_t.xcch010, #專案號
#       xcch011 LIKE xcch_t.xcch011, #核算幣別
#       xcch101 LIKE xcch_t.xcch101, #上期結存數量
#       xcch102 LIKE xcch_t.xcch102, #上期結存金額
#       xcch102a LIKE xcch_t.xcch102a, #上期結存金額-材料
#       xcch102b LIKE xcch_t.xcch102b, #上期結存金額-人工
#       xcch102c LIKE xcch_t.xcch102c, #上期結存金額-加工
#       xcch102d LIKE xcch_t.xcch102d, #上期結存金額-制費一
#       xcch102e LIKE xcch_t.xcch102e, #上期結存金額-制費二
#       xcch102f LIKE xcch_t.xcch102f, #上期結存金額-制費三
#       xcch102g LIKE xcch_t.xcch102g, #上期結存金額-制費四
#       xcch102h LIKE xcch_t.xcch102h, #上期結存金額-制費五
#       xcch200 LIKE xcch_t.xcch200, #本期投入工時
#       xcch201 LIKE xcch_t.xcch201, #本期投入數量
#       xcch202 LIKE xcch_t.xcch202, #本期本階投入金額
#       xcch202a LIKE xcch_t.xcch202a, #本期本階投入金額-材料
#       xcch202b LIKE xcch_t.xcch202b, #本期本階投入金額-人工
#       xcch202c LIKE xcch_t.xcch202c, #本期本階投入金額-加工
#       xcch202d LIKE xcch_t.xcch202d, #本期本階投入金額-制費一
#       xcch202e LIKE xcch_t.xcch202e, #本期本階投入金額-制費二
#       xcch202f LIKE xcch_t.xcch202f, #本期本階投入金額-制費三
#       xcch202g LIKE xcch_t.xcch202g, #本期本階投入金額-制費四
#       xcch202h LIKE xcch_t.xcch202h, #本期本階投入金額-制費五
#       xcch204 LIKE xcch_t.xcch204, #本期下階投入金額
#       xcch204a LIKE xcch_t.xcch204a, #本期下階投入金額-材料
#       xcch204b LIKE xcch_t.xcch204b, #本期下階投入金額-人工
#       xcch204c LIKE xcch_t.xcch204c, #本期下階投入金額-加工
#       xcch204d LIKE xcch_t.xcch204d, #本期下階投入金額-制費一
#       xcch204e LIKE xcch_t.xcch204e, #本期下階投入金額-制費二
#       xcch204f LIKE xcch_t.xcch204f, #本期下階投入金額-制費三
#       xcch204g LIKE xcch_t.xcch204g, #本期下階投入金額-制費四
#       xcch204h LIKE xcch_t.xcch204h, #本期下階投入金額-制費五
#       xcch301 LIKE xcch_t.xcch301, #本期轉出數量
#       xcch302 LIKE xcch_t.xcch302, #本期轉出金額
#       xcch302a LIKE xcch_t.xcch302a, #本期轉出金額-材料
#       xcch302b LIKE xcch_t.xcch302b, #本期轉出金額-人工
#       xcch302c LIKE xcch_t.xcch302c, #本期轉出金額-加工
#       xcch302d LIKE xcch_t.xcch302d, #本期轉出金額-制費一
#       xcch302e LIKE xcch_t.xcch302e, #本期轉出金額-制費二
#       xcch302f LIKE xcch_t.xcch302f, #本期轉出金額-制費三
#       xcch302g LIKE xcch_t.xcch302g, #本期轉出金額-制費四
#       xcch302h LIKE xcch_t.xcch302h, #本期轉出金額-制費五
#       xcch303 LIKE xcch_t.xcch303, #差異轉出數量
#       xcch304 LIKE xcch_t.xcch304, #差異轉出金額
#       xcch304a LIKE xcch_t.xcch304a, #差異轉出金額-材料
#       xcch304b LIKE xcch_t.xcch304b, #差異轉出金額-人工
#       xcch304c LIKE xcch_t.xcch304c, #差異轉出金額-加工
#       xcch304d LIKE xcch_t.xcch304d, #差異轉出金額-制費一
#       xcch304e LIKE xcch_t.xcch304e, #差異轉出金額-制費二
#       xcch304f LIKE xcch_t.xcch304f, #差異轉出金額-制費三
#       xcch304g LIKE xcch_t.xcch304g, #差異轉出金額-制費四
#       xcch304h LIKE xcch_t.xcch304h, #差異轉出金額-制費五
#       xcch901 LIKE xcch_t.xcch901, #期末結存數量
#       xcch902 LIKE xcch_t.xcch902, #期末結存金額
#       xcch902a LIKE xcch_t.xcch902a, #期末結存金額-材料
#       xcch902b LIKE xcch_t.xcch902b, #期末結存金額-人工
#       xcch902c LIKE xcch_t.xcch902c, #期末結存金額-加工
#       xcch902d LIKE xcch_t.xcch902d, #期末結存金額-制費一
#       xcch902e LIKE xcch_t.xcch902e, #期末結存金額-制費二
#       xcch902f LIKE xcch_t.xcch902f, #期末結存金額-制費三
#       xcch902g LIKE xcch_t.xcch902g, #期末結存金額-制費四
#       xcch902h LIKE xcch_t.xcch902h, #期末結存金額-制費五
#       xcchtime LIKE xcch_t.xcchtime  #最近成本計算時間
#          END RECORD
##161109-00085#18-e mod
##161109-00085#18-s mod
##DEFINE l_xcci          RECORD LIKE xcci_t.*   #161109-00085#18-s mark
#DEFINE l_xcci          RECORD  #拆件在製元件成本期異動統計檔
#       xccient LIKE xcci_t.xccient, #企業編號
#       xccicomp LIKE xcci_t.xccicomp, #法人組織
#       xccild LIKE xcci_t.xccild, #帳套
#       xcci001 LIKE xcci_t.xcci001, #帳套本位幣順序
#       xcci002 LIKE xcci_t.xcci002, #成本域
#       xcci003 LIKE xcci_t.xcci003, #成本計算類型
#       xcci004 LIKE xcci_t.xcci004, #年度
#       xcci005 LIKE xcci_t.xcci005, #期別
#       xcci006 LIKE xcci_t.xcci006, #拆件工單編號
#       xcci007 LIKE xcci_t.xcci007, #元件料號
#       xcci008 LIKE xcci_t.xcci008, #特性
#       xcci009 LIKE xcci_t.xcci009, #批號
#       xcci010 LIKE xcci_t.xcci010, #核算幣別
#       xcci101 LIKE xcci_t.xcci101, #上期結存數量
#       xcci102 LIKE xcci_t.xcci102, #上期結存金額
#       xcci102a LIKE xcci_t.xcci102a, #上期結存金額-材料
#       xcci102b LIKE xcci_t.xcci102b, #上期結存金額-人工
#       xcci102c LIKE xcci_t.xcci102c, #上期結存金額-加工
#       xcci102d LIKE xcci_t.xcci102d, #上期結存金額-制費一
#       xcci102e LIKE xcci_t.xcci102e, #上期結存金額-制費二
#       xcci102f LIKE xcci_t.xcci102f, #上期結存金額-制費三
#       xcci102g LIKE xcci_t.xcci102g, #上期結存金額-制費四
#       xcci102h LIKE xcci_t.xcci102h, #上期結存金額-制費五
#       xcci201 LIKE xcci_t.xcci201, #本期投入數量
#       xcci202 LIKE xcci_t.xcci202, #本期本階投入金額
#       xcci202a LIKE xcci_t.xcci202a, #本期本階投入金額-材料
#       xcci202b LIKE xcci_t.xcci202b, #本期本階投入金額-人工
#       xcci202c LIKE xcci_t.xcci202c, #本期本階投入金額-加工
#       xcci202d LIKE xcci_t.xcci202d, #本期本階投入金額-制費一
#       xcci202e LIKE xcci_t.xcci202e, #本期本階投入金額-制費二
#       xcci202f LIKE xcci_t.xcci202f, #本期本階投入金額-制費三
#       xcci202g LIKE xcci_t.xcci202g, #本期本階投入金額-制費四
#       xcci202h LIKE xcci_t.xcci202h, #本期本階投入金額-制費五
#       xcci301 LIKE xcci_t.xcci301, #本期轉出數量
#       xcci302 LIKE xcci_t.xcci302, #本期轉出金額
#       xcci302a LIKE xcci_t.xcci302a, #本期轉出金額-材料
#       xcci302b LIKE xcci_t.xcci302b, #本期轉出金額-人工
#       xcci302c LIKE xcci_t.xcci302c, #本期轉出金額-加工
#       xcci302d LIKE xcci_t.xcci302d, #本期轉出金額-制費一
#       xcci302e LIKE xcci_t.xcci302e, #本期轉出金額-制費二
#       xcci302f LIKE xcci_t.xcci302f, #本期轉出金額-制費三
#       xcci302g LIKE xcci_t.xcci302g, #本期轉出金額-制費四
#       xcci302h LIKE xcci_t.xcci302h, #本期轉出金額-制費五
#       xcci303 LIKE xcci_t.xcci303, #差異轉出數量
#       xcci304 LIKE xcci_t.xcci304, #差異轉出金額
#       xcci304a LIKE xcci_t.xcci304a, #差異轉出金額-材料
#       xcci304b LIKE xcci_t.xcci304b, #差異轉出金額-人工
#       xcci304c LIKE xcci_t.xcci304c, #差異轉出金額-加工
#       xcci304d LIKE xcci_t.xcci304d, #差異轉出金額-制費一
#       xcci304e LIKE xcci_t.xcci304e, #差異轉出金額-制費二
#       xcci304f LIKE xcci_t.xcci304f, #差異轉出金額-制費三
#       xcci304g LIKE xcci_t.xcci304g, #差異轉出金額-制費四
#       xcci304h LIKE xcci_t.xcci304h, #差異轉出金額-制費五
#       xcci901 LIKE xcci_t.xcci901, #期末結存數量
#       xcci902 LIKE xcci_t.xcci902, #期末結存金額
#       xcci902a LIKE xcci_t.xcci902a, #期末結存金額-材料
#       xcci902b LIKE xcci_t.xcci902b, #期末結存金額-人工
#       xcci902c LIKE xcci_t.xcci902c, #期末結存金額-加工
#       xcci902d LIKE xcci_t.xcci902d, #期末結存金額-制費一
#       xcci902e LIKE xcci_t.xcci902e, #期末結存金額-制費二
#       xcci902f LIKE xcci_t.xcci902f, #期末結存金額-制費三
#       xcci902g LIKE xcci_t.xcci902g, #期末結存金額-制費四
#       xcci902h LIKE xcci_t.xcci902h, #期末結存金額-制費五
#       xccitime LIKE xcci_t.xccitime  #最近成本計算時間
#          END RECORD
##161109-00085#18-e mod
##161109-00085#18-s mod
##DEFINE l_xccg          RECORD LIKE xccg_t.*   #161109-00085#18-s mark
#DEFINE l_xccg          RECORD  #聯產品成本期異動統計檔
#       xccgent LIKE xccg_t.xccgent, #企業編號               
#       xccgcomp LIKE xccg_t.xccgcomp, #法人組織
#       xccgld LIKE xccg_t.xccgld, #帳套
#       xccg001 LIKE xccg_t.xccg001, #帳套本位幣順序
#       xccg002 LIKE xccg_t.xccg002, #成本域
#       xccg003 LIKE xccg_t.xccg003, #成本計算類型
#       xccg004 LIKE xccg_t.xccg004, #年度
#       xccg005 LIKE xccg_t.xccg005, #期別
#       xccg006 LIKE xccg_t.xccg006, #工單編號
#       xccg007 LIKE xccg_t.xccg007, #聯產品料號
#       xccg008 LIKE xccg_t.xccg008, #特性
#       xccg009 LIKE xccg_t.xccg009, #批號
#       xccg010 LIKE xccg_t.xccg010, #核算幣別
#       xccg101 LIKE xccg_t.xccg101, #上期結存數量
#       xccg102 LIKE xccg_t.xccg102, #上期結存金額
#       xccg102a LIKE xccg_t.xccg102a, #上期結存金額-材料
#       xccg102b LIKE xccg_t.xccg102b, #上期結存金額-人工
#       xccg102c LIKE xccg_t.xccg102c, #上期結存金額-加工
#       xccg102d LIKE xccg_t.xccg102d, #上期結存金額-制費一
#       xccg102e LIKE xccg_t.xccg102e, #上期結存金額-制費二
#       xccg102f LIKE xccg_t.xccg102f, #上期結存金額-制費三
#       xccg102g LIKE xccg_t.xccg102g, #上期結存金額-制費四
#       xccg102h LIKE xccg_t.xccg102h, #上期結存金額-制費五
#       xccg301 LIKE xccg_t.xccg301, #本期轉出數量
#       xccg302 LIKE xccg_t.xccg302, #本期轉出金額
#       xccg302a LIKE xccg_t.xccg302a, #本期轉出金額-材料
#       xccg302b LIKE xccg_t.xccg302b, #本期轉出金額-人工
#       xccg302c LIKE xccg_t.xccg302c, #本期轉出金額-加工
#       xccg302d LIKE xccg_t.xccg302d, #本期轉出金額-制費一
#       xccg302e LIKE xccg_t.xccg302e, #本期轉出金額-制費二
#       xccg302f LIKE xccg_t.xccg302f, #本期轉出金額-制費三
#       xccg302g LIKE xccg_t.xccg302g, #本期轉出金額-制費四
#       xccg302h LIKE xccg_t.xccg302h, #本期轉出金額-制費五
#       xccg901 LIKE xccg_t.xccg901, #期末結存數量
#       xccg902 LIKE xccg_t.xccg902, #期末結存金額
#       xccg902a LIKE xccg_t.xccg902a, #期末結存金額-材料
#       xccg902b LIKE xccg_t.xccg902b, #期末結存金額-人工
#       xccg902c LIKE xccg_t.xccg902c, #期末結存金額-加工
#       xccg902d LIKE xccg_t.xccg902d, #期末結存金額-制費一
#       xccg902e LIKE xccg_t.xccg902e, #期末結存金額-制費二
#       xccg902f LIKE xccg_t.xccg902f, #期末結存金額-制費三
#       xccg902g LIKE xccg_t.xccg902g, #期末結存金額-制費四
#       xccg902h LIKE xccg_t.xccg902h, #期末結存金額-制費五
#      #xccgtime LIKE xccg_t.xccgtime  #最近成本計算時間 #161109-00085#63 mark
#       #161109-00085#63 --s add
#       xccgtime LIKE xccg_t.xccgtime, #最近成本計算時間
#       xccgud001 LIKE xccg_t.xccgud001, #自定義欄位(文字)001
#       xccgud002 LIKE xccg_t.xccgud002, #自定義欄位(文字)002
#       xccgud003 LIKE xccg_t.xccgud003, #自定義欄位(文字)003
#       xccgud004 LIKE xccg_t.xccgud004, #自定義欄位(文字)004
#       xccgud005 LIKE xccg_t.xccgud005, #自定義欄位(文字)005
#       xccgud006 LIKE xccg_t.xccgud006, #自定義欄位(文字)006
#       xccgud007 LIKE xccg_t.xccgud007, #自定義欄位(文字)007
#       xccgud008 LIKE xccg_t.xccgud008, #自定義欄位(文字)008
#       xccgud009 LIKE xccg_t.xccgud009, #自定義欄位(文字)009
#       xccgud010 LIKE xccg_t.xccgud010, #自定義欄位(文字)010
#       xccgud011 LIKE xccg_t.xccgud011, #自定義欄位(數字)011
#       xccgud012 LIKE xccg_t.xccgud012, #自定義欄位(數字)012
#       xccgud013 LIKE xccg_t.xccgud013, #自定義欄位(數字)013
#       xccgud014 LIKE xccg_t.xccgud014, #自定義欄位(數字)014
#       xccgud015 LIKE xccg_t.xccgud015, #自定義欄位(數字)015
#       xccgud016 LIKE xccg_t.xccgud016, #自定義欄位(數字)016
#       xccgud017 LIKE xccg_t.xccgud017, #自定義欄位(數字)017
#       xccgud018 LIKE xccg_t.xccgud018, #自定義欄位(數字)018
#       xccgud019 LIKE xccg_t.xccgud019, #自定義欄位(數字)019
#       xccgud020 LIKE xccg_t.xccgud020, #自定義欄位(數字)020
#       xccgud021 LIKE xccg_t.xccgud021, #自定義欄位(日期時間)021
#       xccgud022 LIKE xccg_t.xccgud022, #自定義欄位(日期時間)022
#       xccgud023 LIKE xccg_t.xccgud023, #自定義欄位(日期時間)023
#       xccgud024 LIKE xccg_t.xccgud024, #自定義欄位(日期時間)024
#       xccgud025 LIKE xccg_t.xccgud025, #自定義欄位(日期時間)025
#       xccgud026 LIKE xccg_t.xccgud026, #自定義欄位(日期時間)026
#       xccgud027 LIKE xccg_t.xccgud027, #自定義欄位(日期時間)027
#       xccgud028 LIKE xccg_t.xccgud028, #自定義欄位(日期時間)028
#       xccgud029 LIKE xccg_t.xccgud029, #自定義欄位(日期時間)029
#       xccgud030 LIKE xccg_t.xccgud030  #自定義欄位(日期時間)030
#       #161109-00085#63 --e add
#          END RECORD
##161109-00085#18-e mod
#
#DEFINE l_sfaa052       LIKE sfaa_t.sfaa052
#DEFINE l_sfaa009       LIKE sfaa_t.sfaa009
#DEFINE l_sfaa028       LIKE sfaa_t.sfaa028
#DEFINE l_sfaa029       LIKE sfaa_t.sfaa029
#DEFINE l_sfaa017       LIKE sfaa_t.sfaa017
#DEFINE l_sfaasite      LIKE sfaa_t.sfaasite
#DEFINE l_xced101_1     LIKE xced_t.xced101
#DEFINE l_xced101_2     LIKE xced_t.xced101
#DEFINE l_xced101_3     LIKE xced_t.xced101
#DEFINE ld_date         DATETIME YEAR TO SECOND
#DEFINE l_imag011       LIKE imag_t.imag011    #160607-00026#1 add
#DEFINE l_glab010       LIKE glab_t.glab010    #160607-00026#1 add
#DEFINE l_sfaa057       LIKE sfaa_t.sfaa057    #150906-00001#2 add
#DEFINE l_sfaa068       LIKE sfaa_t.sfaa068    #160816-00015#1 add
##160920-00002#1---add---s
#DEFINE l_xcat005       LIKE xcat_t.xcat005  
#DEFINE l_xcaz011       LIKE xcaz_t.xcaz011
#DEFINE l_rate          LIKE type_t.num26_10
#DEFINE l_rate1         LIKE type_t.num26_10
#DEFINE l_xcag102       LIKE xcag_t.xcag102 ,
#       l_xcag102a      LIKE xcag_t.xcag102a,
#       l_xcag102b      LIKE xcag_t.xcag102b,
#       l_xcag102c      LIKE xcag_t.xcag102c,
#       l_xcag102d      LIKE xcag_t.xcag102d,
#       l_xcag102e      LIKE xcag_t.xcag102e,
#       l_xcag102f      LIKE xcag_t.xcag102f,
#       l_xcag102g      LIKE xcag_t.xcag102g,
#       l_xcag102h      LIKE xcag_t.xcag102h
##160920-00002#1---add---s
#
#   LET g_success = 'Y'
#   LET l_xcea.xceaownid = g_user
#   LET l_xcea.xceaowndp = g_dept
#   LET l_xcea.xceacrtid = g_user
#   LET l_xcea.xceacrtdp = g_dept 
#   LET ld_date  = cl_get_current()
#   LET l_xcea.xceacrtdt = ld_date
#   LET l_xcea.xceamodid = ""
#   LET l_xcea.xceamoddt = ""
#   CALL s_aooi200_fin_gen_docno(g_xcea_m.xceald,'','',g_xcea_m.xceadocno,g_xcea_m.xcea001,g_prog_name1)      #wujie 150214
#    RETURNING l_success,g_xcea_m.xceadocno
#   IF l_success  = 0  THEN
#      INITIALIZE g_errparam TO NULL
#      LET g_errparam.code = 'apm-00003'
#      LET g_errparam.extend = g_xcea_m.xceadocno
#      LET g_errparam.popup = TRUE
#      CALL cl_err()
#
#      LET g_success = 'N'
#      RETURN g_success
#   END IF
#   
#   INSERT INTO xcea_t (xceaent,xceald,xceacomp,xcea006,xceadocno,xcea001,xcea002,xcea004, 
#       xcea005,xcea003,xceastus,xceaownid,xceaowndp,xceacrtid,xceacrtdp,xceacrtdt, 
#       xceamodid,xceamoddt)
#   VALUES (g_enterprise,g_xcea_m.xceald,g_xcea_m.xceacomp,g_xcea_m.xcea006,g_xcea_m.xceadocno, 
#       g_xcea_m.xcea001,g_xcea002,g_xcea_m.xcea004,g_xcea_m.xcea005,g_xcea_m.xcea003, 
#       'N',l_xcea.xceaownid,l_xcea.xceaowndp,l_xcea.xceacrtid, 
#       l_xcea.xceacrtdp,l_xcea.xceacrtdt,l_xcea.xceamodid,l_xcea.xceamoddt) 
#       
#   IF SQLCA.sqlcode THEN
#      INITIALIZE g_errparam TO NULL
#      LET g_errparam.code = SQLCA.sqlcode
#      LET g_errparam.extend = "ins xcea"
#      LET g_errparam.popup = TRUE
#      CALL cl_err()
#  
#      LET g_success = 'N'
#      RETURN g_success
#   END IF
#   
#   #160920-00002#1---add---s
#   SELECT xcat005 INTO l_xcat005
#     FROM xcat_t
#    WHERE xcatent = g_enterprise
#      AND xcat001 = g_xcea_m.xcea003  
#   IF l_xcat005 = '1' THEN 
#      SELECT xcaz011 INTO l_xcaz011
#        FROM xcaz_t
#       WHERE xcazent = g_enterprise
#         AND xcazld = g_xcea_m.xceald
#         AND xcaz001 = g_xcea_m.xcea003
#      LET g_sql = "SELECT xcag102,xcag102a,xcag102b,xcag102c,xcag102d,xcag102e,xcag102f,xcag102g,xcag102h ",
#                  "  FROM xcag_t ",
#                  " WHERE xcagent = '",g_enterprise,"'",
#                  "   AND xcagsite = '",g_site,"'",
#                  "   AND xcag001 = '",l_xcaz011,"'",
#                  "   AND xcag002 < '",g_xcea_m.xcea001,"'",
#                  "   AND (xcag003 IS NULL OR xcag003 >='",g_xcea_m.xcea001,"')",
#                  "   AND xcag004 = ? " 
#      DECLARE xcag_prep CURSOR FROM g_sql                  
#   END IF                  
#   #160920-00002#1---add---e
#   #工單是否有聯產品入庫-若無
#   #非拆件工單 xccd_t-主件
#   #在xccd中排除工單中即有聯產品入庫，又有無聯產品入庫
#   LET g_sql = " SELECT SUM(xccd302) *(-1),SUM(xccd302a)*(-1),",
#               "        SUM(xccd302b)*(-1),SUM(xccd302c)*(-1),SUM(xccd302d)*(-1),SUM(xccd302e)*(-1),",
#               "        SUM(xccd302f)*(-1),SUM(xccd302g)*(-1),SUM(xccd302h)*(-1) ",
#               "   FROM xccd_t", 
#               "  WHERE xccdent = '",g_enterprise,"' AND xccdld = '",g_xcea_m.xceald,"'",
#               "    AND xccd003 = '",g_xcea_m.xcea003,"' AND xccd004 = ",g_xcea_m.xcea004,
#               "    AND xccd005 = ",g_xcea_m.xcea005,  
##               "    AND xccd006 NOT IN (SELECT xccg006 FROM xccg_t  WHERE xccgent = '",g_enterprise,"' ",
##               "                              AND xccgld = '",g_xcea_m.xceald,"' ",
##               "                              AND xccg003 = '",g_xcea_m.xcea003,"' ",
##               "                              AND xccg004 = ",g_xcea_m.xcea004,
##               "                              AND xccg005 = ",g_xcea_m.xcea005,")",               
#               "    AND xccd006 = ? AND xccd007 = ? AND xccd008 = ? AND xccd002 = ? " 
# 
#   LET g_sql1 = g_sql CLIPPED," AND xccd001 = '2' " 
#   
#   DECLARE xccd_prep2_2 CURSOR FROM g_sql1
#   
#   LET g_sql1 = g_sql CLIPPED," AND xccd001 = '3' " 
#   
#   DECLARE xccd_prep3_2 CURSOR FROM g_sql1
#  
#
#  #160607-00026#1-s-mark   
#  #LET g_sql = " SELECT xccd006,xccd007,xccd008,xccd002,",
#  #            "        SUM(xccd301) *(-1),SUM(xccd302) *(-1),SUM(xccd302a)*(-1),",
#  #            "        SUM(xccd302b)*(-1),SUM(xccd302c)*(-1),SUM(xccd302d)*(-1),SUM(xccd302e)*(-1),",
#  #            "        SUM(xccd302f)*(-1),SUM(xccd302g)*(-1),SUM(xccd302h)*(-1) ",
#  #            "   FROM xccd_t",
#  #            "  WHERE xccdent = '",g_enterprise,"' AND xccdld = '",g_xcea_m.xceald,"'",
#  #            "    AND xccd003 = '",g_xcea_m.xcea003,"' AND xccd004 = ",g_xcea_m.xcea004,
#  #            "    AND xccd005 = ",g_xcea_m.xcea005,
#  #            "    AND xccd001 = '1' ",                
#  #            "  GROUP BY xccd006,xccd007,xccd008,xccd002",
#  #            "  ORDER BY xccd006,xccd007,xccd008,xccd002"
#  #160607-00026#1-e-mark 
#  
#  #160829-00005#2-s-add
#   LET g_sql = "SELECT MAX(xcebseq) FROM xceb_t ",
#               " WHERE xcebent = ",g_enterprise,
#               "   AND xcebld = '",g_xcea_m.xceald,"'",
#               "   AND xcebdocno = ? "  
#   DECLARE axct701_01_2_prep CURSOR FROM g_sql
#   
#   LET g_sql = "SELECT pmaa090,pmaa241 FROM pmaa_t ",
#               " WHERE pmaaent = ",g_enterprise, 
#               "   AND pmaa001 = ? "
#   DECLARE axct701_01_2_prep1 CURSOR FROM g_sql  
#
#   LET g_sql = "SELECT ooef153 FROM ooef_t ",
#               " WHERE ooefent = ",g_enterprise,
#               "   AND ooef001 = ? "
#   DECLARE axct701_01_2_prep2 CURSOR FROM g_sql
#   
#   LET g_sql = "SELECT ooeg004 FROM ooeg_t ",
#               " WHERE ooegent = ",g_enterprise,
#               "   AND ooeg001 = ? "
#   DECLARE axct701_01_2_prep3 CURSOR FROM g_sql            
#  #160829-00005#2-e-add
#  
#  #160607-00026#1-s-add   
#   LET g_sql = "SELECT sfaa003,sfaa052,sfaa009,sfaasite,sfaa017, ",
#               "       sfaa028,sfaa029,sfaa057,sfaa068 ",   #150906-00001#2 add sfaa057 #160816-00015#1 add sfaa068
#               "  FROM sfaa_t ",
#               " WHERE sfaaent = ",g_enterprise, 
#               "   AND sfaadocno = ? "
#   DECLARE axct701_01_sfaa_prep CURSOR FROM g_sql 
#
#   
#   LET g_sql = "INSERT INTO xceb_t( xcebent,xcebcomp,  xcebld,xcebdocno, xcebseq, ",
#               "                    xceb001, xceb002, xceb003,  xceb004, xceb005, ",
#               "                    xceb101, xceb102, xceb103,  xceb110, xceb111, ",
#               "                    xceb112, xceb113, xceb114,  xceb115, xceb116, ",
#               "                    xceb117, xceb118, xceb119,  xceb120, xceb201, ",
#               "                    xceb202,xceb202a,xceb202b, xceb202c,xceb202d, ",
#               "                   xceb202e,xceb202f,xceb202g, xceb202h, xceb212, ",
#               "                   xceb212a,xceb212b,xceb212c, xceb212d,xceb212e, ",
#               "                   xceb212f,xceb212g,xceb212h,  xceb222,xceb222a, ",
#               "                   xceb222b,xceb222c,xceb222d, xceb222e,xceb222f, ",
#               "                   xceb222g,xceb222h, xceb107,  xceb108, xceb109, ",
#               "                    xceb121, xceb122, xceb123,  xceb124, xceb125, ",
#               "                    xceb126, xceb127, xceb128,  xceb129, xceb130, ",
#               "                    xceb131, xceb132) ",
#               "VALUES(?,?,?,?,?, ?,?,?,?,?, ?,?,?,?,?, ?,?,?,?,?, ?,?,?,?,?, ",
#               "       ?,?,?,?,?, ?,?,?,?,?, ?,?,?,?,?, ?,?,?,?,?, ?,?,?,?,?, ",
#               "       ?,?,?,?,?, ?,?,?,?,?, ?,?,?,?,?, ?,? ) "
#   PREPARE xcce_ins_xceb_p FROM g_sql      
#    
#   
#   LET g_sql = "SELECT  xccd006, xccd007, xccd008, xccd002, xccd301,",
#               "        xccd302,xccd302a,xccd302b,xccd302c,xccd302d,",
#               "       xccd302e,xccd302f,xccd302g,xccd302h, ",
#               "       (SELECT imag011 FROM imag_t WHERE imagent = xccdent AND imagsite = xccdcomp AND imag001 =xccd007 ) imag011, ",
#               "       (SELECT glab010 FROM glab_t WHERE glabent = xccdent AND glabld = xccdld AND glab001 = '61' AND glab002 = '8925' AND glab003 = '2') glab010, ",
#               "       xccd011 ",
#               "  FROM (",
#               " SELECT xccdent,xccdcomp,xccdld,xccd006,xccd007,xccd008,xccd002,",
#               "        SUM(xccd301) *(-1)  xccd301,SUM(xccd302) *(-1)  xccd302,SUM(xccd302a)*(-1) xccd302a, ",
#               "        SUM(xccd302b)*(-1) xccd302b,SUM(xccd302c)*(-1) xccd302c,SUM(xccd302d)*(-1) xccd302d, ",
#               "        SUM(xccd302e)*(-1) xccd302e,SUM(xccd302f)*(-1) xccd302f,SUM(xccd302g)*(-1) xccd302g, ",
#               "        SUM(xccd302h)*(-1) xccd302h ",
#               "   FROM xccd_t",
#               "  WHERE xccdent = '",g_enterprise,"' AND xccdld = '",g_xcea_m.xceald,"'",
#               "    AND xccd003 = '",g_xcea_m.xcea003,"' AND xccd004 = ",g_xcea_m.xcea004,
#               "    AND xccd005 = ",g_xcea_m.xcea005,
#               "    AND xccd001 = '1' ",                
#               "  GROUP BY xccdent,xccdcomp,xccdld,xccd006,xccd007,xccd008,xccd002",
#               "  ORDER BY xccd006,xccd007,xccd008,xccd002",
#               "       ) "               
#   #160607-00026#1-e-add                 
#   PREPARE xccd_prep_2 FROM g_sql
#   DECLARE xccd_curs_2 CURSOR FOR xccd_prep_2
#   FOREACH xccd_curs_2 INTO l_xccd.xccd006,l_xccd.xccd007,l_xccd.xccd008,l_xccd.xccd002, 
#                          l_xccd.xccd301,l_xccd.xccd302,l_xccd.xccd302a,
#                          l_xccd.xccd302b,l_xccd.xccd302c,l_xccd.xccd302d,l_xccd.xccd302e,l_xccd.xccd302f,
#                          l_xccd.xccd302g,l_xccd.xccd302h,l_imag011,l_glab010,        #160607-00026#1 add imag011,glab010
#                          l_xccd.xccd011      #160920-00002#1 add
#      IF SQLCA.sqlcode THEN
#         INITIALIZE g_errparam TO NULL
#         LET g_errparam.code = SQLCA.sqlcode
#         LET g_errparam.extend = "foreach xccd"
#         LET g_errparam.popup = TRUE
#         CALL cl_err()
#
#         EXIT FOREACH
#      END IF  
#     #160607-00026#1-s-mark 
#     #LET l_sfaa052 = ''
#     #LET l_sfaa009 = ''
#     #LET l_sfaa028 = ''
#     #LET l_sfaa029 = ''
#     #LET l_sfaa017 = ''      
#     #LET l_sfaasite =''
#     #160607-00026#1-e-mark 
#      INITIALIZE l_xceb.* TO NULL
#      
#      LET l_xceb.xceb001 = l_xccd.xccd006 #工單
#      LET l_xceb.xceb004 = l_xccd.xccd007 #主件
#      LET l_xceb.xceb005 = l_xccd.xccd008 #特性
#      LET l_xceb.xceb103 = l_xccd.xccd002 #成本域
#      
#     
#      #本位幣一
#      LET l_xceb.xceb201 =  l_xccd.xccd301#入庫數量
#      #160920-00002#1---add---s
#      IF l_xcat005 = '1' THEN 
#         OPEN xcag_prep USING l_xceb.xceb004
#         FETCH xcag_prep INTO l_xcag102,l_xcag102a,l_xcag102b,l_xcag102c,l_xcag102d,
#                              l_xcag102e,l_xcag102f,l_xcag102g,l_xcag102h
#         IF SQLCA.sqlcode AND SQLCA.sqlcode <> 100 THEN
#            INITIALIZE g_errparam TO NULL
#            LET g_errparam.code = SQLCA.sqlcode
#            LET g_errparam.extend = "xcag_prep"
#            LET g_errparam.popup = TRUE
#            CALL cl_err()
#         
#            LET g_success = 'N'
#            RETURN g_success
#            EXIT FOREACH
#         END IF    
#         IF SQLCA.sqlcode = 100 THEN
#            LET l_xcag102a = 0
#            LET l_xcag102b = 0
#            LET l_xcag102c = 0
#            LET l_xcag102d = 0
#            LET l_xcag102e = 0
#            LET l_xcag102f = 0
#            LET l_xcag102g = 0
#            LET l_xcag102h = 0
#            LET l_xcag102  = 0
#         END IF          
#         LET l_xceb.xceb202a = l_xcag102a * l_xceb.xceb201 
#         LET l_xceb.xceb202b = l_xcag102b * l_xceb.xceb201   
#         LET l_xceb.xceb202c = l_xcag102c * l_xceb.xceb201 
#         LET l_xceb.xceb202d = l_xcag102d * l_xceb.xceb201 
#         LET l_xceb.xceb202e = l_xcag102e * l_xceb.xceb201 
#         LET l_xceb.xceb202f = l_xcag102f * l_xceb.xceb201 
#         LET l_xceb.xceb202g = l_xcag102g * l_xceb.xceb201 
#         LET l_xceb.xceb202h = l_xcag102h * l_xceb.xceb201 
#         LET l_xceb.xceb202  = l_xcag102  * l_xceb.xceb201 
#      ELSE         
#      #160920-00002#1---add---e
#         LET l_xceb.xceb202a = l_xccd.xccd302a 
#         LET l_xceb.xceb202b = l_xccd.xccd302b   
#         LET l_xceb.xceb202c = l_xccd.xccd302c 
#         LET l_xceb.xceb202d = l_xccd.xccd302d 
#         LET l_xceb.xceb202e = l_xccd.xccd302e 
#         LET l_xceb.xceb202f = l_xccd.xccd302f 
#         LET l_xceb.xceb202g = l_xccd.xccd302g 
#         LET l_xceb.xceb202h = l_xccd.xccd302h 
#         LET l_xceb.xceb202  = l_xccd.xccd302       
#      END IF   #160920-00002#1---add
#      
#      IF cl_null(l_xceb.xceb201)  THEN LET l_xceb.xceb201  = 0 END IF
#      IF cl_null(l_xceb.xceb202a) THEN LET l_xceb.xceb202a = 0 END IF
#      IF cl_null(l_xceb.xceb202b) THEN LET l_xceb.xceb202b = 0 END IF
#      IF cl_null(l_xceb.xceb202c) THEN LET l_xceb.xceb202c = 0 END IF
#      IF cl_null(l_xceb.xceb202d) THEN LET l_xceb.xceb202d = 0 END IF
#      IF cl_null(l_xceb.xceb202e) THEN LET l_xceb.xceb202e = 0 END IF
#      IF cl_null(l_xceb.xceb202f) THEN LET l_xceb.xceb202f = 0 END IF
#      IF cl_null(l_xceb.xceb202g) THEN LET l_xceb.xceb202g = 0 END IF
#      IF cl_null(l_xceb.xceb202h) THEN LET l_xceb.xceb202h = 0 END IF
#      IF cl_null(l_xceb.xceb202)  THEN LET l_xceb.xceb202  = 0 END IF
#
#     #160607-00026#1-s-add
#     #如果金额和数量都为0的话，则不产生此笔单身数据                                                             
#      IF l_xceb.xceb201= 0 AND l_xceb.xceb202 = 0 THEN
#         CONTINUE FOREACH
#      END IF 
#            
#      IF l_xceb.xceb201 = 0 AND l_xceb.xceb202 = 0 AND l_xceb.xceb202a = 0 AND
#         l_xceb.xceb202b = 0 AND l_xceb.xceb202c = 0 AND l_xceb.xceb202d = 0 AND 
#         l_xceb.xceb202d = 0 AND l_xceb.xceb202f = 0 AND l_xceb.xceb202g = 0 AND 
#         l_xceb.xceb202h = 0 THEN 
#         CONTINUE FOREACH
#      END IF
#      LET l_xceb.xceb117 = l_imag011 
#      LET l_xceb.xceb102 = l_glab010      
#     #160607-00026#1-e-add
#
#      IF g_glaa015 ='Y' THEN
#      #本位幣二
#         #160920-00002#1---add---s
#         IF l_xcat005 = '1' THEN 
#            #获取汇率
#            IF g_glaa017='1' THEN #依交易原币
#               CALL s_aooi160_get_exrate('2',g_xcea_m.xceald,g_xcea_m.xcea001,l_xccd.xccd011,
#                                           #目的幣別;  交易金額;匯類類型
#                                            g_glaa016,0,g_glaa018)
#                  RETURNING l_rate
#            ELSE #依账簿币别
#               CALL s_aooi160_get_exrate('2',g_xcea_m.xceald,g_xcea_m.xcea001,g_glaa001,
#                                            g_glaa016,0,g_glaa018)
#                  RETURNING l_rate
#            END IF 
#            LET l_xceb.xceb212a = l_rate * l_xceb.xceb202a 
#            LET l_xceb.xceb212b = l_rate * l_xceb.xceb202b   
#            LET l_xceb.xceb212c = l_rate * l_xceb.xceb202c 
#            LET l_xceb.xceb212d = l_rate * l_xceb.xceb202d 
#            LET l_xceb.xceb212e = l_rate * l_xceb.xceb202e 
#            LET l_xceb.xceb212f = l_rate * l_xceb.xceb202f 
#            LET l_xceb.xceb212g = l_rate * l_xceb.xceb202g 
#            LET l_xceb.xceb212h = l_rate * l_xceb.xceb202h 
#            LET l_xceb.xceb212  = l_rate * l_xceb.xceb202             
#         ELSE
#         #160920-00002#1---add---e     
#            OPEN xccd_prep2_2 USING l_xccd.xccd006,l_xccd.xccd007,l_xccd.xccd008,l_xccd.xccd002
#            FETCH xccd_prep2_2 INTO l_xceb.xceb212,l_xceb.xceb212a,l_xceb.xceb212b,l_xceb.xceb212c,l_xceb.xceb212d,
#                                    l_xceb.xceb212e,l_xceb.xceb212f,l_xceb.xceb212g,l_xceb.xceb212h
#            IF SQLCA.sqlcode THEN
#               INITIALIZE g_errparam TO NULL
#               LET g_errparam.code = SQLCA.sqlcode
#               LET g_errparam.extend = "xccd_prep2"
#               LET g_errparam.popup = TRUE
#               CALL cl_err()
#            
#               LET g_success = 'N'
#               RETURN g_success
#               EXIT FOREACH
#            END IF 
#         END IF   #160920-00002#1 add
#         IF cl_null(l_xceb.xceb212a) THEN LET l_xceb.xceb212a = 0 END IF
#         IF cl_null(l_xceb.xceb212b) THEN LET l_xceb.xceb212b = 0 END IF
#         IF cl_null(l_xceb.xceb212c) THEN LET l_xceb.xceb212c = 0 END IF
#         IF cl_null(l_xceb.xceb212d) THEN LET l_xceb.xceb212d = 0 END IF
#         IF cl_null(l_xceb.xceb212e) THEN LET l_xceb.xceb212e = 0 END IF
#         IF cl_null(l_xceb.xceb212f) THEN LET l_xceb.xceb212f = 0 END IF
#         IF cl_null(l_xceb.xceb212g) THEN LET l_xceb.xceb212g = 0 END IF
#         IF cl_null(l_xceb.xceb212h) THEN LET l_xceb.xceb212h = 0 END IF
#         IF cl_null(l_xceb.xceb212)  THEN LET l_xceb.xceb212  = 0 END IF
#      ELSE
#         LET l_xceb.xceb212a = 0
#         LET l_xceb.xceb212b = 0
#         LET l_xceb.xceb212c = 0
#         LET l_xceb.xceb212d = 0
#         LET l_xceb.xceb212e = 0
#         LET l_xceb.xceb212f = 0
#         LET l_xceb.xceb212g = 0
#         LET l_xceb.xceb212h = 0
#         LET l_xceb.xceb212  = 0     
#      END IF
#
#      IF g_glaa019 ='Y' THEN
#      #本位幣三
#         #160920-00002#1---add---s
#         IF l_xcat005 = '1' THEN 
#            IF g_glaa021='1' THEN #依交易原币
#               CALL s_aooi160_get_exrate('2',g_xcea_m.xceald,g_xcea_m.xcea001,l_xccd.xccd011,
#                                           #目的幣別;  交易金額; 匯類類型
#                                            g_glaa020,0,g_glaa022)
#                  RETURNING l_rate1
#            ELSE #依账簿币别
#               CALL s_aooi160_get_exrate('2',g_xcea_m.xceald,g_xcea_m.xcea001,g_glaa001,
#                                            g_glaa020,0,g_glaa022)
#                  RETURNING l_rate1
#            END IF   
#            LET l_xceb.xceb222a = l_rate1 * l_xceb.xceb202a 
#            LET l_xceb.xceb222b = l_rate1 * l_xceb.xceb202b   
#            LET l_xceb.xceb222c = l_rate1 * l_xceb.xceb202c 
#            LET l_xceb.xceb222d = l_rate1 * l_xceb.xceb202d 
#            LET l_xceb.xceb222e = l_rate1 * l_xceb.xceb202e 
#            LET l_xceb.xceb222f = l_rate1 * l_xceb.xceb202f 
#            LET l_xceb.xceb222g = l_rate1 * l_xceb.xceb202g 
#            LET l_xceb.xceb222h = l_rate1 * l_xceb.xceb202h 
#            LET l_xceb.xceb222  = l_rate1 * l_xceb.xceb202             
#         ELSE
#         #160920-00002#1---add---e      
#            OPEN xccd_prep3_2 USING l_xccd.xccd006,l_xccd.xccd007,l_xccd.xccd008,l_xccd.xccd002
#            FETCH xccd_prep3_2 INTO l_xceb.xceb222,l_xceb.xceb222a,l_xceb.xceb222b,l_xceb.xceb222c,l_xceb.xceb222d,
#                                    l_xceb.xceb222e,l_xceb.xceb222f,l_xceb.xceb222g,l_xceb.xceb222h
#            IF SQLCA.sqlcode THEN
#               INITIALIZE g_errparam TO NULL
#               LET g_errparam.code = SQLCA.sqlcode
#               LET g_errparam.extend = "xccd_prep3"
#               LET g_errparam.popup = TRUE
#               CALL cl_err()
#            
#               LET g_success = 'N'
#               RETURN g_success
#               EXIT FOREACH
#            END IF 
#         END IF   #160920-00002#1 add
#         IF cl_null(l_xceb.xceb222a) THEN LET l_xceb.xceb222a = 0 END IF
#         IF cl_null(l_xceb.xceb222b) THEN LET l_xceb.xceb222b = 0 END IF
#         IF cl_null(l_xceb.xceb222c) THEN LET l_xceb.xceb222c = 0 END IF
#         IF cl_null(l_xceb.xceb222d) THEN LET l_xceb.xceb222d = 0 END IF
#         IF cl_null(l_xceb.xceb222e) THEN LET l_xceb.xceb222e = 0 END IF
#         IF cl_null(l_xceb.xceb222f) THEN LET l_xceb.xceb222f = 0 END IF
#         IF cl_null(l_xceb.xceb222g) THEN LET l_xceb.xceb222g = 0 END IF
#         IF cl_null(l_xceb.xceb222h) THEN LET l_xceb.xceb222h = 0 END IF
#         IF cl_null(l_xceb.xceb222)  THEN LET l_xceb.xceb222  = 0 END IF
#      ELSE
#         LET l_xceb.xceb222a = 0
#         LET l_xceb.xceb222b = 0
#         LET l_xceb.xceb222c = 0
#         LET l_xceb.xceb222d = 0
#         LET l_xceb.xceb222e = 0
#         LET l_xceb.xceb222f = 0
#         LET l_xceb.xceb222g = 0
#         LET l_xceb.xceb222h = 0
#         LET l_xceb.xceb222  = 0     
#      END IF
#
#     #項次
#     #160829-00005#2-s-mark 
#     #SELECT MAX(xcebseq) INTO l_xceb.xcebseq FROM xceb_t
#     # WHERE xcebent = g_enterprise 
#     #   AND xcebld = g_xcea_m.xceald
#     #   AND xcebdocno = g_xcea_m.xceadocno
#     #160829-00005#2-e-mark    
#      EXECUTE axct701_01_2_prep USING g_xcea_m.xceadocno INTO l_xceb.xcebseq   #160829-00005#2 add  
#      IF cl_null(l_xceb.xcebseq) OR l_xceb.xcebseq = 0 THEN
#         LET l_xceb.xcebseq = 1
#      ELSE
#         LET l_xceb.xcebseq = l_xceb.xcebseq + 1
#      END IF      
#      
#     #160607-00026#1-s-add 
#      #抓取sfaa資料
#      LET l_sfaa052 = ''
#      LET l_sfaa009 = ''
#      LET l_sfaasite = ''
#      LET l_sfaa017 = ''    
#      LET l_sfaa028 = ''
#      LET l_sfaa029 = ''  
#      LET l_sfaa068 = '' #160816-00015#1 add
#      EXECUTE axct701_01_sfaa_prep USING l_xceb.xceb001 INTO l_xceb.xceb003,l_sfaa052,l_sfaa009,l_sfaasite,l_sfaa017,    
#                                                             l_sfaa028,l_sfaa029,l_sfaa057,l_sfaa068  #150906-00001#2  #160816-00015#1 add sfaa068
#     #160607-00026#1-e-add    
#      
#     #160607-00026#1-s-mark 
#     ##工單類型
#     #SELECT sfaa003 INTO l_xceb.xceb003 FROM sfaa_t
#     # WHERE sfaaent = g_enterprise 
#     #   AND sfaadocno = l_xceb.xceb001
#     #160607-00026#1-e-mark
#     
#      #存貨科目
#      CALL s_get_item_acc(g_xcea_m.xceald,'1',l_xceb.xceb004,'','',g_xcea_m.xceacomp,'') 
#        RETURNING l_success,l_xceb.xceb101  
#
#     #LET l_xceb.xceb102 = ''  #摘要     #160607-00026#1 mark
#      LET l_xceb.xceb115 = ''  #經營類別
#      LET l_xceb.xceb116 = ''  #渠道
#      LET l_xceb.xceb118 = ''  #品牌
#     
#     #160607-00026#1-s-mark      
#     ##交易對象
#     #SELECT sfaa052,sfaa009,sfaasite INTO l_sfaa052,l_sfaa009,l_sfaasite FROM sfaa_t
#     # WHERE sfaaent = g_enterprise 
#     #   AND sfaadocno = l_xceb.xceb001
#     #160607-00026#1-e-mark    
#     
#      IF l_sfaa052 = '2' THEN #委外
#         LET l_xceb.xceb111 = l_sfaa009
#         #客群/區域
#        #160829-00005#2-s-mark  
#        #SELECT pmaa090,pmaa241 INTO l_xceb.xceb112,l_xceb.xceb113 
#        #  FROM pmaa_t 
#        # WHERE pmaaent = g_enterprise 
#        #   AND pmaa001 = l_xceb.xceb111
#        #160829-00005#2-e-mark   
#        EXECUTE axct701_01_2_prep1 USING l_xceb.xceb111 INTO l_xceb.xceb112,l_xceb.xceb113   #160829-00005#2 add          
#      ELSE
#         LET l_xceb.xceb111 = ' '
#         #客群
#         LET l_xceb.xceb112 = ' '
#         #區域
#        #160829-00005#2-s-mark
#        #SELECT ooef153 INTO l_xceb.xceb113 FROM ooef_t
#        # WHERE ooefent = g_enterprise
#        #   AND ooef001 = l_sfaasite
#        #160829-00005#2-e-mark  
#        EXECUTE axct701_01_2_prep2 USING l_sfaasite INTO l_xceb.xceb113   #160829-00005#2 add          
#      END IF      
#      
#     #160607-00026#1-s-mark 
#     ##成本中心--暫用部門sfaa017抓取其歸屬成本中心
#     #SELECT sfaa017 INTO l_sfaa017 FROM sfaa_t
#     # WHERE sfaaent = g_enterprise 
#     #   AND sfaadocno = l_xceb.xceb001
#     #160607-00026#1-e-mark
#     
#     #160829-00005#2-s-mark
#     #SELECT ooeg004 INTO l_xceb.xceb114 FROM ooeg_t
#     # WHERE ooegent = g_enterprise AND ooeg001 = l_sfaa017   
#     #160829-00005#2-e-mark
#     EXECUTE axct701_01_2_prep3 USING l_sfaa017 INTO l_xceb.xceb114   #160829-00005#2 add          
#     
#     #160607-00026#1-s-mark  
#     ##品類
#     #SELECT imag011 INTO l_xceb.xceb117 FROM imag_t
#     # WHERE imagent = g_enterprise AND imagsite = g_xcea_m.xceacomp 
#     #   AND imag001 = l_xceb.xceb004   
#      
#     ##項目編號+WBS
#     #SELECT sfaa028,sfaa029 INTO l_sfaa028,l_sfaa029 FROM sfaa_t
#     # WHERE sfaaent = g_enterprise 
#     #   AND sfaadocno = l_xceb.xceb001
#     #160607-00026#1-e-mark 
#     
#      LET l_xceb.xcebent = g_enterprise 
#      LET l_xceb.xcebcomp = g_xcea_m.xceacomp
#      LET l_xceb.xcebld = g_xcea_m.xceald
#      LET l_xceb.xcebdocno = g_xcea_m.xceadocno
#     #160607-00026#1-s-mark-移至前面就先判斷，增加效率
#     #IF l_xceb.xceb201 = 0 AND l_xceb.xceb202 = 0 AND l_xceb.xceb202a = 0 AND
#     #   l_xceb.xceb202b = 0 AND l_xceb.xceb202c = 0 AND l_xceb.xceb202d = 0 AND 
#     #   l_xceb.xceb202d = 0 AND l_xceb.xceb202f = 0 AND l_xceb.xceb202g = 0 AND 
#     #   l_xceb.xceb202h = 0 THEN 
#     #   CONTINUE FOREACH
#     #END IF      
#     #摘要
#     #IF cl_null(l_xceb.xceb102) THEN
#     #   CALL axct701_01_get_summ(g_xcea_m.xceald,'61','8925','2') RETURNING l_success,l_xceb.xceb102
#     #END IF
#     #160607-00026#1-e-mark
#     
#     #160816-00015#1-s-add
#      IF NOT cl_null(l_sfaa068) THEN
#         LET l_xceb.xceb108 = l_sfaa068   
#      ELSE
#         LET l_xceb.xceb108 = ' '
#      END IF      
#     #160816-00015#1-e-add     
#     
#      CALL axct701_01_default_space_xceb(l_xceb.*) RETURNING l_xceb.xceb005,
#                                                             l_xceb.xceb101,
#                                                             l_xceb.xceb102,
#                                                             l_xceb.xceb103,
#                                                             l_xceb.xceb110,
#                                                             l_xceb.xceb111,
#                                                             l_xceb.xceb112,
#                                                             l_xceb.xceb113,
#                                                             l_xceb.xceb114,
#                                                             l_xceb.xceb115,
#                                                             l_xceb.xceb116,
#                                                             l_xceb.xceb117,
#                                                             l_xceb.xceb118,
#                                                             l_xceb.xceb119,
#                                                             l_xceb.xceb120,
#                                                             l_xceb.xceb107,
#                                                             l_xceb.xceb108,
#                                                             l_xceb.xceb109,
#                                                             l_xceb.xceb121,
#                                                             l_xceb.xceb122,
#                                                             l_xceb.xceb123,
#                                                             l_xceb.xceb124,
#                                                             l_xceb.xceb125,
#                                                             l_xceb.xceb126,
#                                                             l_xceb.xceb127,
#                                                             l_xceb.xceb128,
#                                                             l_xceb.xceb129,
#                                                             l_xceb.xceb130
#     #160607-00026#1-s-mark-移至前方就先判斷，提升效率
#     #如果金额和数量都为0的话，则不产生此笔单身数据                                                             
#     #IF l_xceb.xceb201= 0 AND l_xceb.xceb202 = 0 THEN
#     #   CONTINUE FOREACH
#     #END IF 
#     #160607-00026#1-e-mark
#     
#     #160607-00026#1-s-add 
#     #INSERT INTO xceb_t VALUES(l_xceb.*)
#      EXECUTE xcce_ins_xceb_p USING  l_xceb.xcebent,l_xceb.xcebcomp,  l_xceb.xcebld,l_xceb.xcebdocno, l_xceb.xcebseq, 
#                                     l_xceb.xceb001, l_xceb.xceb002, l_xceb.xceb003,  l_xceb.xceb004, l_xceb.xceb005,
#                                     l_xceb.xceb101, l_xceb.xceb102, l_xceb.xceb103,  l_xceb.xceb110, l_xceb.xceb111,
#                                     l_xceb.xceb112, l_xceb.xceb113, l_xceb.xceb114,  l_xceb.xceb115, l_xceb.xceb116,
#                                     l_xceb.xceb117, l_xceb.xceb118, l_xceb.xceb119,  l_xceb.xceb120, l_xceb.xceb201,
#                                     l_xceb.xceb202,l_xceb.xceb202a,l_xceb.xceb202b, l_xceb.xceb202c,l_xceb.xceb202d,
#                                    l_xceb.xceb202e,l_xceb.xceb202f,l_xceb.xceb202g, l_xceb.xceb202h, l_xceb.xceb212,
#                                    l_xceb.xceb212a,l_xceb.xceb212b,l_xceb.xceb212c, l_xceb.xceb212d,l_xceb.xceb212e,
#                                    l_xceb.xceb212f,l_xceb.xceb212g,l_xceb.xceb212h,  l_xceb.xceb222,l_xceb.xceb222a,
#                                    l_xceb.xceb222b,l_xceb.xceb222c,l_xceb.xceb222d, l_xceb.xceb222e,l_xceb.xceb222f,
#                                    l_xceb.xceb222g,l_xceb.xceb222h, l_xceb.xceb107,  l_xceb.xceb108, l_xceb.xceb109,
#                                     l_xceb.xceb121, l_xceb.xceb122, l_xceb.xceb123,  l_xceb.xceb124, l_xceb.xceb125,
#                                     l_xceb.xceb126, l_xceb.xceb127, l_xceb.xceb128,  l_xceb.xceb129, l_xceb.xceb130,
#                                     l_xceb.xceb131,l_xceb.xceb132
#           
#     #160607-00026#1-e-add   
#      IF SQLCA.sqlcode THEN
#         INITIALIZE g_errparam TO NULL
#         LET g_errparam.code = SQLCA.sqlcode
#         LET g_errparam.extend = "ins xceb"
#         LET g_errparam.popup = TRUE
#         CALL cl_err()  
#         LET g_success = 'N'
#         RETURN g_success
#         EXIT FOREACH
#      END IF   
#   CLOSE xccd_prep2_2
#   CLOSE xccd_prep3_2      
#   END FOREACH 
#
#     
#   #非拆件工單 xcce_t-元件
#   LET g_sql = " SELECT SUM(xcce302) *(-1),SUM(xcce302a)*(-1), ",
#               "        SUM(xcce302b)*(-1),SUM(xcce302c)*(-1),SUM(xcce302d)*(-1),SUM(xcce302e)*(-1),",
#               "        SUM(xcce302f)*(-1),SUM(xcce302g)*(-1),SUM(xcce302h)*(-1) ",
#               "   FROM xcce_t", 
#               "  WHERE xcceent = '",g_enterprise,"' AND xcceld = '",g_xcea_m.xceald,"'",
#               "    AND xcce003 = '",g_xcea_m.xcea003,"' AND xcce004 = ",g_xcea_m.xcea004,
#               "    AND xcce005 = ",g_xcea_m.xcea005,  
#               "    AND xcce006 = ? AND xcce007 = ? AND xcce008 = ? AND xcce002 = ?  " 
# 
#   LET g_sql1 = g_sql CLIPPED," AND xcce001 = '2' " 
#   
#   DECLARE xcce_prep2_2 CURSOR FROM g_sql1
#   
#   LET g_sql1 = g_sql CLIPPED," AND xcce001 = '3' " 
#   
#   DECLARE xcce_prep3_2 CURSOR FROM g_sql1
#   
#  #160829-00005#2-s-add
#   LET g_sql = "SELECT MAX(xcecseq) FROM xcec_t ",
#               " WHERE xcecent = ",g_enterprise,
#               "   AND xcecld = '",g_xcea_m.xceald,"'",
#               "   AND xcecdocno = ? "  
#   DECLARE axct701_01_2_prep4 CURSOR FROM g_sql
#           
#  #160829-00005#2-e-add   
#   
#  #160607-00026#1-s-mark 
#  #LET g_sql = " SELECT xcce006,xcce007,xcce008,xcce002,",
#  #            "        SUM(xcce301) *(-1),SUM(xcce302) *(-1),SUM(xcce302a)*(-1),",
#  #            "        SUM(xcce302b)*(-1),SUM(xcce302c)*(-1),SUM(xcce302d)*(-1),SUM(xcce302e)*(-1),",
#  #            "        SUM(xcce302f)*(-1),SUM(xcce302g)*(-1),SUM(xcce302h)*(-1) ",
#  #            "   FROM xcce_t",
#  #            "  WHERE xcceent = '",g_enterprise,"' AND xcceld = '",g_xcea_m.xceald,"'",
#  #            "    AND xcce003 = '",g_xcea_m.xcea003,"' AND xcce004 = ",g_xcea_m.xcea004,
#  #            "    AND xcce005 = ",g_xcea_m.xcea005,
#  #            "    AND xcce001 = '1' ",
#  #            "  GROUP BY xcce006,xcce007,xcce008,xcce002",
#  #            "  ORDER BY xcce006,xcce007,xcce008,xcce002 "   
#  #160607-00026#1-e-mark 
#  #160607-00026#1-s-add
#   LET g_sql = "INSERT INTO xcec_t( xcecent,xceccomp,  xcecld,xcecdocno, xcecseq, ",
#               "                    xcec001, xcec002, xcec003,  xcec004, xcec005, ",
#               "                    xcec101, xcec102, xcec103,  xcec110, xcec111, ",
#               "                    xcec112, xcec113, xcec114,  xcec115, xcec116, ",
#               "                    xcec117, xcec118, xcec119,  xcec120, xcec201, ",
#               "                    xcec202,xcec202a,xcec202b, xcec202c,xcec202d, ",
#               "                   xcec202e,xcec202f,xcec202g, xcec202h, xcec212, ",
#               "                   xcec212a,xcec212b,xcec212c, xcec212d,xcec212e, ",
#               "                   xcec212f,xcec212g,xcec212h,  xcec222,xcec222a, ",
#               "                   xcec222b,xcec222c,xcec222d, xcec222e,xcec222f, ",
#               "                   xcec222g,xcec222h, xcec107,  xcec108, xcec109, ",
#               "                    xcec121, xcec122, xcec123,  xcec124, xcec125, ",
#               "                    xcec126, xcec127, xcec128,  xcec129, xcec130) ",
#               "VALUES(?,?,?,?,?, ?,?,?,?,?, ?,?,?,?,?, ?,?,?,?,?, ?,?,?,?,?, ",
#               "       ?,?,?,?,?, ?,?,?,?,?, ?,?,?,?,?, ?,?,?,?,?, ?,?,?,?,?, ",
#               "       ?,?,?,?,?, ?,?,?,?,?, ?,?,?,?,? ) "
#   PREPARE xcce_ins_xcec_p FROM g_sql 
#
#   LET g_sql = "SELECT  xcce006, xcce007, xcce008, xcce002, xcce301,",
#               "        xcce302,xcce302a,xcce302b,xcce302c,xcce302d,",
#               "       xcce302e,xcce302f,xcce302g,xcce302h, ",
#               "       (SELECT imag011 FROM imag_t WHERE imagent = xcceent AND imagsite = xccecomp AND imag001 =xcce007 ) imag011, ",
#               "       (SELECT glab010 FROM glab_t WHERE glabent = xcceent AND glabld = xcceld AND glab001 = '61' AND glab002 = '8925' AND glab003 = '2') glab010 ",               
#               "  FROM (",
#               " SELECT xcceent,xccecomp,xcceld,xcce006,xcce007,xcce008,xcce002,",
#               "        SUM(xcce301) *(-1)  xcce301,SUM(xcce302) *(-1)  xcce302,SUM(xcce302a)*(-1) xcce302a, ",
#               "        SUM(xcce302b)*(-1) xcce302b,SUM(xcce302c)*(-1) xcce302c,SUM(xcce302d)*(-1) xcce302d, ",
#               "        SUM(xcce302e)*(-1) xcce302e,SUM(xcce302f)*(-1) xcce302f,SUM(xcce302g)*(-1) xcce302g, ",
#               "        SUM(xcce302h)*(-1) xcce302h ",
#               "   FROM xcce_t",
#               "  WHERE xcceent = '",g_enterprise,"' AND xcceld = '",g_xcea_m.xceald,"'",
#               "    AND xcce003 = '",g_xcea_m.xcea003,"' AND xcce004 = ",g_xcea_m.xcea004,
#               "    AND xcce005 = ",g_xcea_m.xcea005,
#               "    AND xcce001 = '1' ",                
#               "  GROUP BY xcceent,xccecomp,xcceld,xcce006,xcce007,xcce008,xcce002",
#               "  ORDER BY xcce006,xcce007,xcce008,xcce002",
#               "       ) "    
#  #160607-00026#1-e-add 
#   PREPARE xcce_prep_2 FROM g_sql
#   DECLARE xcce_curs_2 CURSOR FOR xcce_prep_2
#   FOREACH xcce_curs_2 INTO l_xcce.xcce006,l_xcce.xcce007,l_xcce.xcce008,l_xcce.xcce002,
#                          l_xcce.xcce301,l_xcce.xcce302,l_xcce.xcce302a,
#                          l_xcce.xcce302b,l_xcce.xcce302c,l_xcce.xcce302d,l_xcce.xcce302e,l_xcce.xcce302f,
#                          l_xcce.xcce302g,l_xcce.xcce302h,l_imag011,l_glab010     #160607-00026#1 add imag011,glab010 
#      IF SQLCA.sqlcode THEN
#         INITIALIZE g_errparam TO NULL
#         LET g_errparam.code = SQLCA.sqlcode
#         LET g_errparam.extend = "foreach xcce"
#         LET g_errparam.popup = TRUE
#         CALL cl_err()
#
#         EXIT FOREACH
#      END IF  
#     #160607-00026#1-s-mark 
#     #LET l_sfaa052 = ''
#     #LET l_sfaa009 = ''
#     #LET l_sfaa028 = ''
#     #LET l_sfaa029 = ''
#     #LET l_sfaa017 = ''
#     #LET l_sfaasite =''
#     #160607-00026#1-e-mark 
#      INITIALIZE l_xcec.* TO NULL
#      
#      LET l_xcec.xcec001 = l_xcce.xcce006 #工單
#      LET l_xcec.xcec004 = l_xcce.xcce007 #主件
#      LET l_xcec.xcec005 = l_xcce.xcce008 #特性
#      LET l_xcec.xcec103 = l_xcce.xcce002 #成本域
#      
#      #本位幣一
#      LET l_xcec.xcec201 =  l_xcce.xcce301#投入數量
#      LET l_xcec.xcec202a = l_xcce.xcce302a 
#      LET l_xcec.xcec202b = l_xcce.xcce302b   
#      LET l_xcec.xcec202c = l_xcce.xcce302c 
#      LET l_xcec.xcec202d = l_xcce.xcce302d 
#      LET l_xcec.xcec202e = l_xcce.xcce302e 
#      LET l_xcec.xcec202f = l_xcce.xcce302f 
#      LET l_xcec.xcec202g = l_xcce.xcce302g 
#      LET l_xcec.xcec202h = l_xcce.xcce302h 
#      LET l_xcec.xcec202  = l_xcce.xcce302       
#
#      IF cl_null(l_xcec.xcec201)  THEN LET l_xcec.xcec201  = 0 END IF
#      IF cl_null(l_xcec.xcec202a) THEN LET l_xcec.xcec202a = 0 END IF
#      IF cl_null(l_xcec.xcec202b) THEN LET l_xcec.xcec202b = 0 END IF
#      IF cl_null(l_xcec.xcec202c) THEN LET l_xcec.xcec202c = 0 END IF
#      IF cl_null(l_xcec.xcec202d) THEN LET l_xcec.xcec202d = 0 END IF
#      IF cl_null(l_xcec.xcec202e) THEN LET l_xcec.xcec202e = 0 END IF
#      IF cl_null(l_xcec.xcec202f) THEN LET l_xcec.xcec202f = 0 END IF
#      IF cl_null(l_xcec.xcec202g) THEN LET l_xcec.xcec202g = 0 END IF
#      IF cl_null(l_xcec.xcec202h) THEN LET l_xcec.xcec202h = 0 END IF
#      IF cl_null(l_xcec.xcec202)  THEN LET l_xcec.xcec202  = 0 END IF
#      
#      #160607-00026#1-s-add
#      IF l_xcec.xcec201= 0 AND l_xcec.xcec202 = 0 THEN
#         CONTINUE FOREACH
#      END IF
#      IF l_xcec.xcec201  = 0 AND l_xcec.xcec202  = 0 AND l_xcec.xcec202a = 0 AND l_xcec.xcec202b = 0 AND
#         l_xcec.xcec202c = 0 AND l_xcec.xcec202d = 0 AND l_xcec.xcec202e = 0 AND l_xcec.xcec202f = 0 AND 
#         l_xcec.xcec202g = 0 AND l_xcec.xcec202h = 0 THEN 
#         CONTINUE FOREACH 
#      END IF
#      LET l_xcec.xcec117 = l_imag011 
#      LET l_xcec.xcec102 = l_glab010         
#      #160607-00026#1-e-add
#
#      #本位幣二
#      IF g_glaa015 ='Y' THEN
#         OPEN  xcce_prep2_2 USING l_xcce.xcce006,l_xcce.xcce007,l_xcce.xcce008,l_xcce.xcce002
#         FETCH xcce_prep2_2 INTO  l_xcec.xcec212,l_xcec.xcec212a,l_xcec.xcec212b,l_xcec.xcec212c,l_xcec.xcec212d,
#                                  l_xcec.xcec212e,l_xcec.xcec212f,l_xcec.xcec212g,l_xcec.xcec212h
#         IF SQLCA.sqlcode THEN
#            INITIALIZE g_errparam TO NULL
#            LET g_errparam.code = SQLCA.sqlcode
#            LET g_errparam.extend = "xcce_prep2"
#            LET g_errparam.popup = TRUE
#            CALL cl_err()
#         
#            LET g_success = 'N'
#            RETURN g_success
#            EXIT FOREACH
#         END IF 
#         
#         IF cl_null(l_xcec.xcec212a) THEN LET l_xcec.xcec212a = 0 END IF
#         IF cl_null(l_xcec.xcec212b) THEN LET l_xcec.xcec212b = 0 END IF
#         IF cl_null(l_xcec.xcec212c) THEN LET l_xcec.xcec212c = 0 END IF
#         IF cl_null(l_xcec.xcec212d) THEN LET l_xcec.xcec212d = 0 END IF
#         IF cl_null(l_xcec.xcec212e) THEN LET l_xcec.xcec212e = 0 END IF
#         IF cl_null(l_xcec.xcec212f) THEN LET l_xcec.xcec212f = 0 END IF
#         IF cl_null(l_xcec.xcec212g) THEN LET l_xcec.xcec212g = 0 END IF
#         IF cl_null(l_xcec.xcec212h) THEN LET l_xcec.xcec212h = 0 END IF
#         IF cl_null(l_xcec.xcec212)  THEN LET l_xcec.xcec212  = 0 END IF  
#      ELSE
#        #160607-00026#1-s-mark
#        #LET l_xceb.xceb212a = 0
#        #LET l_xceb.xceb212b = 0
#        #LET l_xceb.xceb212c = 0
#        #LET l_xceb.xceb212d = 0
#        #LET l_xceb.xceb212e = 0
#        #LET l_xceb.xceb212f = 0
#        #LET l_xceb.xceb212g = 0
#        #LET l_xceb.xceb212h = 0
#        #LET l_xceb.xceb212  = 0     
#        #160607-00026#1-e-mark
#        #160607-00026#1-s-add
#         LET l_xcec.xcec212a = 0
#         LET l_xcec.xcec212b = 0
#         LET l_xcec.xcec212c = 0
#         LET l_xcec.xcec212d = 0
#         LET l_xcec.xcec212e = 0
#         LET l_xcec.xcec212f = 0
#         LET l_xcec.xcec212g = 0
#         LET l_xcec.xcec212h = 0
#         LET l_xcec.xcec212  = 0     
#        #160607-00026#1-e-add        
#      END IF         
#      
#      #本位幣三
#      IF g_glaa019 ='Y' THEN
#         OPEN  xcce_prep3_2 USING l_xcce.xcce006,l_xcce.xcce007,l_xcce.xcce008,l_xcce.xcce002
#         FETCH xcce_prep3_2 INTO  l_xcec.xcec222,l_xcec.xcec222a,l_xcec.xcec222b,l_xcec.xcec222c,l_xcec.xcec222d,
#                                  l_xcec.xcec222e,l_xcec.xcec222f,l_xcec.xcec222g,l_xcec.xcec222h
#         IF SQLCA.sqlcode THEN
#            INITIALIZE g_errparam TO NULL
#            LET g_errparam.code = SQLCA.sqlcode
#            LET g_errparam.extend = "xcce_prep3"
#            LET g_errparam.popup = TRUE
#            CALL cl_err()
#         
#            LET g_success = 'N'
#            RETURN g_success
#            EXIT FOREACH
#         END IF 
#         
#         
#         IF cl_null(l_xcec.xcec222a) THEN LET l_xcec.xcec222a = 0 END IF
#         IF cl_null(l_xcec.xcec222b) THEN LET l_xcec.xcec222b = 0 END IF
#         IF cl_null(l_xcec.xcec222c) THEN LET l_xcec.xcec222c = 0 END IF
#         IF cl_null(l_xcec.xcec222d) THEN LET l_xcec.xcec222d = 0 END IF
#         IF cl_null(l_xcec.xcec222e) THEN LET l_xcec.xcec222e = 0 END IF
#         IF cl_null(l_xcec.xcec222f) THEN LET l_xcec.xcec222f = 0 END IF
#         IF cl_null(l_xcec.xcec222g) THEN LET l_xcec.xcec222g = 0 END IF
#         IF cl_null(l_xcec.xcec222h) THEN LET l_xcec.xcec222h = 0 END IF
#         IF cl_null(l_xcec.xcec222)  THEN LET l_xcec.xcec222  = 0 END IF
#      ELSE
#        #160607-00026#1-s-mark
#        #LET l_xceb.xceb222a = 0
#        #LET l_xceb.xceb222b = 0
#        #LET l_xceb.xceb222c = 0
#        #LET l_xceb.xceb222d = 0
#        #LET l_xceb.xceb222e = 0
#        #LET l_xceb.xceb222f = 0
#        #LET l_xceb.xceb222g = 0
#        #LET l_xceb.xceb222h = 0
#        #LET l_xceb.xceb222  = 0     
#        #160607-00026#1-e-mark
#        #160607-00026#1-s-add
#         LET l_xcec.xcec222a = 0
#         LET l_xcec.xcec222b = 0
#         LET l_xcec.xcec222c = 0
#         LET l_xcec.xcec222d = 0
#         LET l_xcec.xcec222e = 0
#         LET l_xcec.xcec222f = 0
#         LET l_xcec.xcec222g = 0
#         LET l_xcec.xcec222h = 0
#         LET l_xcec.xcec222  = 0     
#        #160607-00026#1-e-add         
#      END IF         
#      
#      #項次
#     #160829-00005#2-s-mark 
#     #SELECT MAX(xcecseq) INTO l_xcec.xcecseq FROM xcec_t
#     # WHERE xcecent = g_enterprise 
#     #   AND xcecld = g_xcea_m.xceald
#     #   AND xcecdocno = g_xcea_m.xceadocno
#     #160829-00005#2-e-mark    
#      EXECUTE axct701_01_2_prep4 USING g_xcea_m.xceadocno INTO l_xcec.xcecseq   #160829-00005#2 add     
#      IF cl_null(l_xcec.xcecseq) OR l_xcec.xcecseq = 0 THEN
#         LET l_xcec.xcecseq = 1
#      ELSE
#         LET l_xcec.xcecseq = l_xcec.xcecseq + 1
#      END IF 
#
#     #160607-00026#1-s-add 
#      #抓取sfaa資料
#      LET l_sfaa052 = ''
#      LET l_sfaa009 = ''
#      LET l_sfaasite = ''
#      LET l_sfaa017 = ''    
#      LET l_sfaa028 = ''
#      LET l_sfaa029 = ''   
#      LET l_sfaa057 = ''
#      LET l_sfaa068 = ''      
#     #EXECUTE axct701_01_sfaa_prep USING l_xcec.xcec001 INTO l_xceb.xceb003,l_sfaa052,l_sfaa009,l_sfaasite,l_sfaa017, #160901-00002#1 mark   
#      EXECUTE axct701_01_sfaa_prep USING l_xcec.xcec001 INTO l_xcec.xcec003,l_sfaa052,l_sfaa009,l_sfaasite,l_sfaa017, #160901-00002#1 add  
#                                                             l_sfaa028,l_sfaa029,l_sfaa057,l_sfaa068  #150906-00001#2 #160816-00015#1 add sfaa068
#     #160607-00026#1-e-add 
#     
#     #160607-00026#1-s-mark 
#     ##工單類型
#     #SELECT sfaa003 INTO l_xcec.xcec003 FROM sfaa_t
#     # WHERE sfaaent = g_enterprise 
#     #   AND sfaadocno = l_xcec.xcec001
#     #160607-00026#1-e-mark 
#     
#     IF l_xcec.xcec004 = 'DL+OH+SUB' THEN    #160901-00002#1 add
#        LET l_xcec.xcec101 = ''              #160901-00002#1 add 
#     ELSE                                    #160901-00002#1 add
#       #150906-00001#2-s
#        IF l_sfaa057 = '2' THEN  #委外
#           CALL s_get_item_acc(g_xcea_m.xceald,'24',l_xcec.xcec004,'','',g_xcea_m.xceacomp,'') 
#             RETURNING l_success,l_xcec.xcec101      
#        ELSE
#       #150906-00001#2-e
#        #在制科目
#           CALL s_get_item_acc(g_xcea_m.xceald,'3',l_xcec.xcec004,'','',g_xcea_m.xceacomp,'') 
#             RETURNING l_success,l_xcec.xcec101 
#        END IF   #150906-00001#2
#        #agli161抓不到，改抓axci201的科目
#        IF cl_null(l_xcec.xcec101) THEN
#           CALL s_fin_get_account(g_xcea_m.xceald,'60','8912','1') RETURNING l_success,l_xcec.xcec101,l_errno
#        END IF
#     END IF                                   #160901-00002#1 add
#     #LET l_xcec.xcec102 = ''  #摘要          #160607-00026#1 mark
#      LET l_xcec.xcec115 = ''  #經營類別
#      LET l_xcec.xcec116 = ''  #渠道
#      LET l_xcec.xcec118 = ''  #品牌
#     #160607-00026#1-s-mark
#     ##交易對象
#     #SELECT sfaa052,sfaa009,sfaasite INTO l_sfaa052,l_sfaa009,l_sfaasite FROM sfaa_t
#     # WHERE sfaaent = g_enterprise 
#     #   AND sfaadocno = l_xcec.xcec001
#     #160607-00026#1-e-mark    
#      IF l_sfaa052 = '2' THEN #委外
#         LET l_xcec.xcec111 = l_sfaa009
#        #客群/區域
#        #160829-00005#2-s-mark 
#        #SELECT pmaa090,pmaa241 INTO l_xcec.xcec112,l_xcec.xcec113 
#        #  FROM pmaa_t 
#        # WHERE pmaaent = g_enterprise 
#        #   AND pmaa001 = l_xcec.xcec111
#        #160829-00005#2-e-mark                     
#        EXECUTE axct701_01_2_prep1 USING l_xcec.xcec111 INTO l_xcec.xcec112,l_xcec.xcec113    #160829-00005#2 add          
#            
#      ELSE
#        LET l_xcec.xcec111 = ' '
#        #客群
#        LET l_xcec.xcec112 = ' '
#        #區域
#        #160829-00005#2-s-mark 
#        #SELECT ooef153 INTO l_xcec.xcec113 FROM ooef_t
#        # WHERE ooefent = g_enterprise
#        #   AND ooef001 = l_sfaasite
#        #160829-00005#2-e-mark 
#        EXECUTE axct701_01_2_prep2 USING l_sfaasite INTO l_xcec.xcec113    #160829-00005#2 add                 
#      END IF 
#
#     #160607-00026#1-s-mark 
#     ##成本中心--暫用部門sfaa017抓取其歸屬成本中心
#     #SELECT sfaa017 INTO l_sfaa017 FROM sfaa_t
#     # WHERE sfaaent = g_enterprise 
#     #   AND sfaadocno = l_xcec.xcec001
#     #160607-00026#1-e-mark
#     
#     #160829-00005#2-s-mark
#     #SELECT ooeg004 INTO l_xcec.xcec114 FROM ooeg_t
#     # WHERE ooegent = g_enterprise AND ooeg001 = l_sfaa017 
#     #160829-00005#2-e-mark
#     EXECUTE axct701_01_2_prep3 USING l_sfaa017 INTO l_xcec.xcec114    #160829-00005#2 add                 
#
#     #160607-00026#1-s-mark
#     ##品類
#     #SELECT imag011 INTO l_xcec.xcec117 FROM imag_t
#     # WHERE imagent = g_enterprise AND imagsite = g_xcea_m.xceacomp 
#     #   AND imag001 = l_xcec.xcec004   
#     #
#     ##項目編號+WBS
#     #SELECT sfaa028,sfaa029 INTO l_sfaa028,l_sfaa029 FROM sfaa_t
#     # WHERE sfaaent = g_enterprise 
#     #   AND sfaadocno = l_xcec.xcec001
#     #160607-00026#1-e-mark 
#      LET l_xcec.xcecent = g_enterprise 
#      LET l_xcec.xceccomp = g_xcea_m.xceacomp
#      LET l_xcec.xcecld = g_xcea_m.xceald
#      LET l_xcec.xcecdocno = g_xcea_m.xceadocno
#     #160607-00026#1-s-mark-移至前方就先判斷，增加效率
#     #IF l_xcec.xcec201 = 0 AND l_xcec.xcec202 = 0 AND l_xcec.xcec202a = 0 AND l_xcec.xcec202b= 0 AND
#     #   l_xcec.xcec202c= 0  AND l_xcec.xcec202d= 0  AND l_xcec.xcec202e= 0   AND l_xcec.xcec202f= 0  AND 
#     #   l_xcec.xcec202g= 0  AND l_xcec.xcec202h= 0 THEN 
#     #   CONTINUE FOREACH 
#     #END IF
#     #摘要
#     #IF cl_null(l_xcec.xcec102) THEN
#     #   CALL axct701_01_get_summ(g_xcea_m.xceald,'61','8925','2') RETURNING l_success,l_xcec.xcec102
#     #END IF
#     #160607-00026#1-e-mark
#     
#     #160816-00015#1-s-add
#      IF NOT cl_null(l_sfaa068) THEN
#         LET l_xcec.xcec108 = l_sfaa068   
#      ELSE
#         LET l_xcec.xcec108 = ' '
#      END IF      
#     #160816-00015#1-e-add       
#     
#     
#      CALL axct701_01_default_space_xcec(l_xcec.*) RETURNING l_xcec.xcec005,   
#                                                             l_xcec.xcec101,
#                                                             l_xcec.xcec102,
#                                                             l_xcec.xcec103,
#                                                             l_xcec.xcec110,
#                                                             l_xcec.xcec111,
#                                                             l_xcec.xcec112,
#                                                             l_xcec.xcec113,
#                                                             l_xcec.xcec114,
#                                                             l_xcec.xcec115,
#                                                             l_xcec.xcec116,
#                                                             l_xcec.xcec117,
#                                                             l_xcec.xcec118,
#                                                             l_xcec.xcec119,
#                                                             l_xcec.xcec120,
#                                                             l_xcec.xcec107,
#                                                             l_xcec.xcec108,
#                                                             l_xcec.xcec109,
#                                                             l_xcec.xcec121,
#                                                             l_xcec.xcec122,
#                                                             l_xcec.xcec123,
#                                                             l_xcec.xcec124,
#                                                             l_xcec.xcec125,
#                                                             l_xcec.xcec126,
#                                                             l_xcec.xcec127,
#                                                             l_xcec.xcec128,
#                                                             l_xcec.xcec129,
#                                                             l_xcec.xcec130 
#      #161109-00085#19-e mod                                      
#     #160607-00026#1-s-mark-移至前方就先判斷，增加效率                                                        
#     #如果金额和数量都为0的话，则不产生此笔单身数据                                                             
#     #IF l_xcec.xcec201= 0 AND l_xcec.xcec202 = 0 THEN
#     #   CONTINUE FOREACH
#     #END IF
#     #160607-00026#1-e-mark
#     
#     #160607-00026#1-s-add
#     #INSERT INTO xcec_t VALUES(l_xcec.*)
#      EXECUTE xcce_ins_xcec_p USING  l_xcec.xcecent,l_xcec.xceccomp,  l_xcec.xcecld,l_xcec.xcecdocno, l_xcec.xcecseq, 
#                                     l_xcec.xcec001, l_xcec.xcec002, l_xcec.xcec003,  l_xcec.xcec004, l_xcec.xcec005,
#                                     l_xcec.xcec101, l_xcec.xcec102, l_xcec.xcec103,  l_xcec.xcec110, l_xcec.xcec111,
#                                     l_xcec.xcec112, l_xcec.xcec113, l_xcec.xcec114,  l_xcec.xcec115, l_xcec.xcec116,
#                                     l_xcec.xcec117, l_xcec.xcec118, l_xcec.xcec119,  l_xcec.xcec120, l_xcec.xcec201,
#                                     l_xcec.xcec202,l_xcec.xcec202a,l_xcec.xcec202b, l_xcec.xcec202c,l_xcec.xcec202d,
#                                    l_xcec.xcec202e,l_xcec.xcec202f,l_xcec.xcec202g, l_xcec.xcec202h, l_xcec.xcec212,
#                                    l_xcec.xcec212a,l_xcec.xcec212b,l_xcec.xcec212c, l_xcec.xcec212d,l_xcec.xcec212e,
#                                    l_xcec.xcec212f,l_xcec.xcec212g,l_xcec.xcec212h,  l_xcec.xcec222,l_xcec.xcec222a,
#                                    l_xcec.xcec222b,l_xcec.xcec222c,l_xcec.xcec222d, l_xcec.xcec222e,l_xcec.xcec222f,
#                                    l_xcec.xcec222g,l_xcec.xcec222h, l_xcec.xcec107,  l_xcec.xcec108, l_xcec.xcec109,
#                                     l_xcec.xcec121, l_xcec.xcec122, l_xcec.xcec123,  l_xcec.xcec124, l_xcec.xcec125,
#                                     l_xcec.xcec126, l_xcec.xcec127, l_xcec.xcec128,  l_xcec.xcec129, l_xcec.xcec130
#           
#     #160607-00026#1-e-add
#
#      IF SQLCA.sqlcode THEN
#         INITIALIZE g_errparam TO NULL
#         LET g_errparam.code = SQLCA.sqlcode
#         LET g_errparam.extend = "ins xcec"
#         LET g_errparam.popup = TRUE
#         CALL cl_err()
#  
#         LET g_success = 'N'
#         RETURN g_success
#         EXIT FOREACH
#      END IF   
#   CLOSE xcce_prep2_2
#   CLOSE xcce_prep3_2      
#   END FOREACH 
#
#   #第三單身
#   CALL axct701_01_ins_xced() RETURNING l_success
#   IF NOT l_success THEN LET g_success = 'N' END IF 
#  #160607-00026#1-s-add 
#   FREE axct701_01_sfaa_prep
#   FREE xcce_ins_xceb_p
#   FREE xcce_ins_xcec_p
#  #160607-00026#1-e-add
#  #160829-00005#2-s-add
#   FREE axct701_01_2_prep
#   FREE axct701_01_2_prep1
#   FREE axct701_01_2_prep2
#   FREE axct701_01_2_prep3
#   FREE axct701_01_2_prep4
#  #160829-00005#2-e-add   
#   RETURN g_success
#161215-00040#1 Mark ---(E)---
END FUNCTION

################################################################################
# Descriptions...: 描述说明    11.庫存調整憑證  axct703
# Memo...........:
# Usage..........: CALL s_aooi150_ins (传入参数)
#                  RETURNING 回传参数
# Input parameter: 传入参数变量1   传入参数变量说明1
#                : 传入参数变量2   传入参数变量说明2
# Return code....: 回传参数变量1   回传参数变量说明1
#                : 回传参数变量2   回传参数变量说明2
# Date & Author..: 日期 By 作者
# Modify.........:
################################################################################
PRIVATE FUNCTION axct701_01_ins_3_bak()
#170105-00011#6---mark---s
#DEFINE l_success       LIKE type_t.num5
#DEFINE l_errno         LIKE gzze_t.gzze001
##161109-00085#19-s mod
##DEFINE l_xcea          RECORD LIKE xcea_t.*   #161109-00085#19-s mark
#DEFINE l_xcea          RECORD  #工單發料成本憑證單頭檔
#       xceaent LIKE xcea_t.xceaent, #企業編號
#       xceacomp LIKE xcea_t.xceacomp, #法人組織
#       xceald LIKE xcea_t.xceald, #帳套
#       xceadocno LIKE xcea_t.xceadocno, #單據編號
#       xcea001 LIKE xcea_t.xcea001, #單據日期
#       xcea002 LIKE xcea_t.xcea002, #成本憑證類型
#       xcea003 LIKE xcea_t.xcea003, #成本計算類型
#       xcea004 LIKE xcea_t.xcea004, #年度
#       xcea005 LIKE xcea_t.xcea005, #期別
#       xcea006 LIKE xcea_t.xcea006, #帳務人員
#       xcea007 LIKE xcea_t.xcea007, #帳務部門
#       xcea101 LIKE xcea_t.xcea101, #憑證編號
#       xcea102 LIKE xcea_t.xcea102, #憑證日期
#       xceaownid LIKE xcea_t.xceaownid, #資料所有者
#       xceaowndp LIKE xcea_t.xceaowndp, #資料所屬部門
#       xceacrtid LIKE xcea_t.xceacrtid, #資料建立者
#       xceacrtdp LIKE xcea_t.xceacrtdp, #資料建立部門
#       xceacrtdt LIKE xcea_t.xceacrtdt, #資料創建日
#       xceamodid LIKE xcea_t.xceamodid, #資料修改者
#       xceamoddt LIKE xcea_t.xceamoddt, #最近修改日
#       xceacnfid LIKE xcea_t.xceacnfid, #資料確認者
#       xceacnfdt LIKE xcea_t.xceacnfdt, #資料確認日
#       xceapstid LIKE xcea_t.xceapstid, #資料過帳者
#       xceapstdt LIKE xcea_t.xceapstdt, #資料過帳日
#       xceastus LIKE xcea_t.xceastus, #狀態碼
#       #161109-00085#63 --s add
#       xceaud001 LIKE xcea_t.xceaud001, #自定義欄位(文字)001
#       xceaud002 LIKE xcea_t.xceaud002, #自定義欄位(文字)002
#       xceaud003 LIKE xcea_t.xceaud003, #自定義欄位(文字)003
#       xceaud004 LIKE xcea_t.xceaud004, #自定義欄位(文字)004
#       xceaud005 LIKE xcea_t.xceaud005, #自定義欄位(文字)005
#       xceaud006 LIKE xcea_t.xceaud006, #自定義欄位(文字)006
#       xceaud007 LIKE xcea_t.xceaud007, #自定義欄位(文字)007
#       xceaud008 LIKE xcea_t.xceaud008, #自定義欄位(文字)008
#       xceaud009 LIKE xcea_t.xceaud009, #自定義欄位(文字)009
#       xceaud010 LIKE xcea_t.xceaud010, #自定義欄位(文字)010
#       xceaud011 LIKE xcea_t.xceaud011, #自定義欄位(數字)011
#       xceaud012 LIKE xcea_t.xceaud012, #自定義欄位(數字)012
#       xceaud013 LIKE xcea_t.xceaud013, #自定義欄位(數字)013
#       xceaud014 LIKE xcea_t.xceaud014, #自定義欄位(數字)014
#       xceaud015 LIKE xcea_t.xceaud015, #自定義欄位(數字)015
#       xceaud016 LIKE xcea_t.xceaud016, #自定義欄位(數字)016
#       xceaud017 LIKE xcea_t.xceaud017, #自定義欄位(數字)017
#       xceaud018 LIKE xcea_t.xceaud018, #自定義欄位(數字)018
#       xceaud019 LIKE xcea_t.xceaud019, #自定義欄位(數字)019
#       xceaud020 LIKE xcea_t.xceaud020, #自定義欄位(數字)020
#       xceaud021 LIKE xcea_t.xceaud021, #自定義欄位(日期時間)021
#       xceaud022 LIKE xcea_t.xceaud022, #自定義欄位(日期時間)022
#       xceaud023 LIKE xcea_t.xceaud023, #自定義欄位(日期時間)023
#       xceaud024 LIKE xcea_t.xceaud024, #自定義欄位(日期時間)024
#       xceaud025 LIKE xcea_t.xceaud025, #自定義欄位(日期時間)025
#       xceaud026 LIKE xcea_t.xceaud026, #自定義欄位(日期時間)026
#       xceaud027 LIKE xcea_t.xceaud027, #自定義欄位(日期時間)027
#       xceaud028 LIKE xcea_t.xceaud028, #自定義欄位(日期時間)028
#       xceaud029 LIKE xcea_t.xceaud029, #自定義欄位(日期時間)029
#       xceaud030 LIKE xcea_t.xceaud030, #自定義欄位(日期時間)030
#       #161109-00085#63 --e add
#       xceasite LIKE xcea_t.xceasite  #營運據點
#          END RECORD
##161109-00085#19-e mod
##161109-00085#19-s mod
##DEFINE l_xceb          RECORD LIKE xceb_t.*   #161109-00085#19-s mark
#DEFINE l_xceb          RECORD  #成本憑證第一單身檔
#       xcebent LIKE xceb_t.xcebent, #企業編號
#       xcebcomp LIKE xceb_t.xcebcomp, #法人組織
#       xcebld LIKE xceb_t.xcebld, #帳套
#       xcebdocno LIKE xceb_t.xcebdocno, #單據編號
#       xcebseq LIKE xceb_t.xcebseq, #項次
#       xceb001 LIKE xceb_t.xceb001, #參考單據編號
#       xceb002 LIKE xceb_t.xceb002, #參考單據項次
#       xceb003 LIKE xceb_t.xceb003, #單據類型
#       xceb004 LIKE xceb_t.xceb004, #料件編號
#       xceb005 LIKE xceb_t.xceb005, #特性
#       xceb101 LIKE xceb_t.xceb101, #科目編號
#       xceb102 LIKE xceb_t.xceb102, #摘要
#       xceb103 LIKE xceb_t.xceb103, #成本域
#       xceb110 LIKE xceb_t.xceb110, #原因碼
#       xceb111 LIKE xceb_t.xceb111, #收付款客商
#       xceb112 LIKE xceb_t.xceb112, #客群
#       xceb113 LIKE xceb_t.xceb113, #區域
#       xceb114 LIKE xceb_t.xceb114, #成本中心
#       xceb115 LIKE xceb_t.xceb115, #經營類別
#       xceb116 LIKE xceb_t.xceb116, #通路
#       xceb117 LIKE xceb_t.xceb117, #品類
#       xceb118 LIKE xceb_t.xceb118, #品牌
#       xceb119 LIKE xceb_t.xceb119, #專案號
#       xceb120 LIKE xceb_t.xceb120, #WBS
#       xceb201 LIKE xceb_t.xceb201, #數量
#       xceb202 LIKE xceb_t.xceb202, #成本金額(本位幣一)
#       xceb202a LIKE xceb_t.xceb202a, #成本-材料(本位幣一)
#       xceb202b LIKE xceb_t.xceb202b, #成本-人工(本位幣一)
#       xceb202c LIKE xceb_t.xceb202c, #成本-加工(本位幣一)
#       xceb202d LIKE xceb_t.xceb202d, #成本-制費一(本位幣一)
#       xceb202e LIKE xceb_t.xceb202e, #成本-制費二(本位幣一)
#       xceb202f LIKE xceb_t.xceb202f, #成本-制費三(本位幣一)
#       xceb202g LIKE xceb_t.xceb202g, #成本-制費四(本位幣一)
#       xceb202h LIKE xceb_t.xceb202h, #成本-制費五(本位幣一)
#       xceb212 LIKE xceb_t.xceb212, #成本金額(本位幣二)
#       xceb212a LIKE xceb_t.xceb212a, #成本-材料(本位幣二)
#       xceb212b LIKE xceb_t.xceb212b, #成本-人工(本位幣二)
#       xceb212c LIKE xceb_t.xceb212c, #成本-加工(本位幣二)
#       xceb212d LIKE xceb_t.xceb212d, #成本-制費一(本位幣二)
#       xceb212e LIKE xceb_t.xceb212e, #成本-制費二(本位幣二)
#       xceb212f LIKE xceb_t.xceb212f, #成本-制費三(本位幣二)
#       xceb212g LIKE xceb_t.xceb212g, #成本-制費四(本位幣二)
#       xceb212h LIKE xceb_t.xceb212h, #成本-制費五(本位幣二)
#       xceb222 LIKE xceb_t.xceb222, #成本金額(本位幣三)
#       xceb222a LIKE xceb_t.xceb222a, #成本-材料(本位幣三)
#       xceb222b LIKE xceb_t.xceb222b, #成本-人工(本位幣三)
#       xceb222c LIKE xceb_t.xceb222c, #成本-加工(本位幣三)
#       xceb222d LIKE xceb_t.xceb222d, #成本-制費一(本位幣三)
#       xceb222e LIKE xceb_t.xceb222e, #成本-制費二(本位幣三)
#       xceb222f LIKE xceb_t.xceb222f, #成本-制費三(本位幣三)
#       xceb222g LIKE xceb_t.xceb222g, #成本-制費四(本位幣三)
#       xceb222h LIKE xceb_t.xceb222h, #成本-制費五(本位幣三)
#       xceb301 LIKE xceb_t.xceb301, #憑證編號
#       xceb302 LIKE xceb_t.xceb302, #憑證項次
#       #161109-00085#63 --s add  
#       xcebud001 LIKE xceb_t.xcebud001, #自定義欄位(文字)001
#       xcebud002 LIKE xceb_t.xcebud002, #自定義欄位(文字)002
#       xcebud003 LIKE xceb_t.xcebud003, #自定義欄位(文字)003
#       xcebud004 LIKE xceb_t.xcebud004, #自定義欄位(文字)004
#       xcebud005 LIKE xceb_t.xcebud005, #自定義欄位(文字)005
#       xcebud006 LIKE xceb_t.xcebud006, #自定義欄位(文字)006
#       xcebud007 LIKE xceb_t.xcebud007, #自定義欄位(文字)007
#       xcebud008 LIKE xceb_t.xcebud008, #自定義欄位(文字)008
#       xcebud009 LIKE xceb_t.xcebud009, #自定義欄位(文字)009
#       xcebud010 LIKE xceb_t.xcebud010, #自定義欄位(文字)010
#       xcebud011 LIKE xceb_t.xcebud011, #自定義欄位(數字)011
#       xcebud012 LIKE xceb_t.xcebud012, #自定義欄位(數字)012
#       xcebud013 LIKE xceb_t.xcebud013, #自定義欄位(數字)013
#       xcebud014 LIKE xceb_t.xcebud014, #自定義欄位(數字)014
#       xcebud015 LIKE xceb_t.xcebud015, #自定義欄位(數字)015
#       xcebud016 LIKE xceb_t.xcebud016, #自定義欄位(數字)016
#       xcebud017 LIKE xceb_t.xcebud017, #自定義欄位(數字)017
#       xcebud018 LIKE xceb_t.xcebud018, #自定義欄位(數字)018
#       xcebud019 LIKE xceb_t.xcebud019, #自定義欄位(數字)019
#       xcebud020 LIKE xceb_t.xcebud020, #自定義欄位(數字)020
#       xcebud021 LIKE xceb_t.xcebud021, #自定義欄位(日期時間)021
#       xcebud022 LIKE xceb_t.xcebud022, #自定義欄位(日期時間)022
#       xcebud023 LIKE xceb_t.xcebud023, #自定義欄位(日期時間)023
#       xcebud024 LIKE xceb_t.xcebud024, #自定義欄位(日期時間)024
#       xcebud025 LIKE xceb_t.xcebud025, #自定義欄位(日期時間)025
#       xcebud026 LIKE xceb_t.xcebud026, #自定義欄位(日期時間)026
#       xcebud027 LIKE xceb_t.xcebud027, #自定義欄位(日期時間)027
#       xcebud028 LIKE xceb_t.xcebud028, #自定義欄位(日期時間)028
#       xcebud029 LIKE xceb_t.xcebud029, #自定義欄位(日期時間)029
#       xcebud030 LIKE xceb_t.xcebud030, #自定義欄位(日期時間)030
#       #161109-00085#63 --e add
#       xceb107 LIKE xceb_t.xceb107, #人員
#       xceb108 LIKE xceb_t.xceb108, #部門
#       xceb109 LIKE xceb_t.xceb109, #帳款對象
#       xceb121 LIKE xceb_t.xceb121, #自由核算項1
#       xceb122 LIKE xceb_t.xceb122, #自由核算項2
#       xceb123 LIKE xceb_t.xceb123, #自由核算項3
#       xceb124 LIKE xceb_t.xceb124, #自由核算項4
#       xceb125 LIKE xceb_t.xceb125, #自由核算項5
#       xceb126 LIKE xceb_t.xceb126, #自由核算項6
#       xceb127 LIKE xceb_t.xceb127, #自由核算項7
#       xceb128 LIKE xceb_t.xceb128, #自由核算項8
#       xceb129 LIKE xceb_t.xceb129, #自由核算項9
#       xceb130 LIKE xceb_t.xceb130, #自由核算項10
#       xceb131 LIKE xceb_t.xceb131, #單據類型(for 流通)
#       xceb132 LIKE xceb_t.xceb132  #單據日期(for 流通)
#          END RECORD
##161109-00085#19-e mod
##161109-00085#19-s mod
##DEFINE l_xcec          RECORD LIKE xcec_t.*   #161109-00085#18-s mark
#DEFINE l_xcec          RECORD  #成本憑證第二單身檔
#       xcecent LIKE xcec_t.xcecent, #企業編號
#       xceccomp LIKE xcec_t.xceccomp, #法人組織
#       xcecld LIKE xcec_t.xcecld, #帳套
#       xcecdocno LIKE xcec_t.xcecdocno, #單據編號
#       xcecseq LIKE xcec_t.xcecseq, #項次
#       xcec001 LIKE xcec_t.xcec001, #參考單據
#       xcec002 LIKE xcec_t.xcec002, #參考單據項次
#       xcec003 LIKE xcec_t.xcec003, #單據類型
#       xcec004 LIKE xcec_t.xcec004, #料件編號
#       xcec005 LIKE xcec_t.xcec005, #特性
#       xcec101 LIKE xcec_t.xcec101, #科目編號
#       xcec102 LIKE xcec_t.xcec102, #摘要
#       xcec103 LIKE xcec_t.xcec103, #成本域
#       xcec110 LIKE xcec_t.xcec110, #原因碼
#       xcec111 LIKE xcec_t.xcec111, #收付款客商
#       xcec112 LIKE xcec_t.xcec112, #客群
#       xcec113 LIKE xcec_t.xcec113, #區域
#       xcec114 LIKE xcec_t.xcec114, #成本中心
#       xcec115 LIKE xcec_t.xcec115, #經營類別
#       xcec116 LIKE xcec_t.xcec116, #通路
#       xcec117 LIKE xcec_t.xcec117, #品類
#       xcec118 LIKE xcec_t.xcec118, #品牌
#       xcec119 LIKE xcec_t.xcec119, #專案號
#       xcec120 LIKE xcec_t.xcec120, #WBS
#       xcec201 LIKE xcec_t.xcec201, #數量
#       xcec202 LIKE xcec_t.xcec202, #成本金額(本位幣一)
#       xcec202a LIKE xcec_t.xcec202a, #成本-材料(本位幣一)
#       xcec202b LIKE xcec_t.xcec202b, #成本-人工(本位幣一)
#       xcec202c LIKE xcec_t.xcec202c, #成本-加工(本位幣一)
#       xcec202d LIKE xcec_t.xcec202d, #成本-制費一(本位幣一)
#       xcec202e LIKE xcec_t.xcec202e, #成本-制費二(本位幣一)
#       xcec202f LIKE xcec_t.xcec202f, #成本-制費三(本位幣一)
#       xcec202g LIKE xcec_t.xcec202g, #成本-制費四(本位幣一)
#       xcec202h LIKE xcec_t.xcec202h, #成本-制費五(本位幣一)
#       xcec212 LIKE xcec_t.xcec212, #成本-金額(本位幣二)
#       xcec212a LIKE xcec_t.xcec212a, #成本-材料(本位幣二)
#       xcec212b LIKE xcec_t.xcec212b, #成本-人工(本位幣二)
#       xcec212c LIKE xcec_t.xcec212c, #成本-加工(本位幣二)
#       xcec212d LIKE xcec_t.xcec212d, #成本-制費一(本位幣二)
#       xcec212e LIKE xcec_t.xcec212e, #成本-制費二(本位幣二)
#       xcec212f LIKE xcec_t.xcec212f, #成本-制費三(本位幣二)
#       xcec212g LIKE xcec_t.xcec212g, #成本-制費四(本位幣二)
#       xcec212h LIKE xcec_t.xcec212h, #成本-制費五(本位幣二)
#       xcec222 LIKE xcec_t.xcec222, #成本-金額(本位幣三)
#       xcec222a LIKE xcec_t.xcec222a, #成本-材料(本位幣三)
#       xcec222b LIKE xcec_t.xcec222b, #成本-人工(本位幣三)
#       xcec222c LIKE xcec_t.xcec222c, #成本-加工(本位幣三)
#       xcec222d LIKE xcec_t.xcec222d, #成本-制費一(本位幣三)
#       xcec222e LIKE xcec_t.xcec222e, #成本-制費二(本位幣三)
#       xcec222f LIKE xcec_t.xcec222f, #成本-制費三(本位幣三)
#       xcec222g LIKE xcec_t.xcec222g, #成本-制費四(本位幣三)
#       xcec222h LIKE xcec_t.xcec222h, #成本-制費五(本位幣三)
#       xcec301 LIKE xcec_t.xcec301, #憑證編號
#       xcec302 LIKE xcec_t.xcec302, #憑證項次
#       #161109-00085#63 --s add 
#       xcecud001 LIKE xcec_t.xcecud001, #自定義欄位(文字)001
#       xcecud002 LIKE xcec_t.xcecud002, #自定義欄位(文字)002
#       xcecud003 LIKE xcec_t.xcecud003, #自定義欄位(文字)003
#       xcecud004 LIKE xcec_t.xcecud004, #自定義欄位(文字)004
#       xcecud005 LIKE xcec_t.xcecud005, #自定義欄位(文字)005
#       xcecud006 LIKE xcec_t.xcecud006, #自定義欄位(文字)006
#       xcecud007 LIKE xcec_t.xcecud007, #自定義欄位(文字)007
#       xcecud008 LIKE xcec_t.xcecud008, #自定義欄位(文字)008
#       xcecud009 LIKE xcec_t.xcecud009, #自定義欄位(文字)009
#       xcecud010 LIKE xcec_t.xcecud010, #自定義欄位(文字)010
#       xcecud011 LIKE xcec_t.xcecud011, #自定義欄位(數字)011
#       xcecud012 LIKE xcec_t.xcecud012, #自定義欄位(數字)012
#       xcecud013 LIKE xcec_t.xcecud013, #自定義欄位(數字)013
#       xcecud014 LIKE xcec_t.xcecud014, #自定義欄位(數字)014
#       xcecud015 LIKE xcec_t.xcecud015, #自定義欄位(數字)015
#       xcecud016 LIKE xcec_t.xcecud016, #自定義欄位(數字)016
#       xcecud017 LIKE xcec_t.xcecud017, #自定義欄位(數字)017
#       xcecud018 LIKE xcec_t.xcecud018, #自定義欄位(數字)018
#       xcecud019 LIKE xcec_t.xcecud019, #自定義欄位(數字)019
#       xcecud020 LIKE xcec_t.xcecud020, #自定義欄位(數字)020
#       xcecud021 LIKE xcec_t.xcecud021, #自定義欄位(日期時間)021
#       xcecud022 LIKE xcec_t.xcecud022, #自定義欄位(日期時間)022
#       xcecud023 LIKE xcec_t.xcecud023, #自定義欄位(日期時間)023
#       xcecud024 LIKE xcec_t.xcecud024, #自定義欄位(日期時間)024
#       xcecud025 LIKE xcec_t.xcecud025, #自定義欄位(日期時間)025
#       xcecud026 LIKE xcec_t.xcecud026, #自定義欄位(日期時間)026
#       xcecud027 LIKE xcec_t.xcecud027, #自定義欄位(日期時間)027
#       xcecud028 LIKE xcec_t.xcecud028, #自定義欄位(日期時間)028
#       xcecud029 LIKE xcec_t.xcecud029, #自定義欄位(日期時間)029
#       xcecud030 LIKE xcec_t.xcecud030, #自定義欄位(日期時間)030
#       #161109-00085#63 --e add
#       xcec107 LIKE xcec_t.xcec107, #人員
#       xcec108 LIKE xcec_t.xcec108, #部門
#       xcec109 LIKE xcec_t.xcec109, #帳款對象
#       xcec121 LIKE xcec_t.xcec121, #自由核算項1
#       xcec122 LIKE xcec_t.xcec122, #自由核算項2
#       xcec123 LIKE xcec_t.xcec123, #自由核算項3
#       xcec124 LIKE xcec_t.xcec124, #自由核算項4
#       xcec125 LIKE xcec_t.xcec125, #自由核算項5
#       xcec126 LIKE xcec_t.xcec126, #自由核算項6
#       xcec127 LIKE xcec_t.xcec127, #自由核算項7
#       xcec128 LIKE xcec_t.xcec128, #自由核算項8
#       xcec129 LIKE xcec_t.xcec129, #自由核算項9
#       xcec130 LIKE xcec_t.xcec130  #自由核算項10
#               END RECORD
##161109-00085#19-e mod
##161109-00085#19-s mod
##DEFINE l_xcco          RECORD LIKE xcco_t.*   #161109-00085#19-s mark
#DEFINE l_xcco          RECORD  #本期庫存成本調整檔
#       xccoent LIKE xcco_t.xccoent, #企業編號             
#       xccold LIKE xcco_t.xccold, #帳套
#       xccocomp LIKE xcco_t.xccocomp, #法人組織
#       xcco001 LIKE xcco_t.xcco001, #帳套本位幣順序
#       xcco002 LIKE xcco_t.xcco002, #成本域
#       xcco003 LIKE xcco_t.xcco003, #成本計算類型
#       xcco004 LIKE xcco_t.xcco004, #年度
#       xcco005 LIKE xcco_t.xcco005, #期別
#       xcco006 LIKE xcco_t.xcco006, #料件編號
#       xcco007 LIKE xcco_t.xcco007, #特性
#       xcco008 LIKE xcco_t.xcco008, #批號
#       xcco009 LIKE xcco_t.xcco009, #參考單號
#       xcco010 LIKE xcco_t.xcco010, #資料來源
#       xcco011 LIKE xcco_t.xcco011, #調整說明
#       xcco102 LIKE xcco_t.xcco102, #當月調整金額-金額合計
#       xcco102a LIKE xcco_t.xcco102a, #當月調整金額-材料
#       xcco102b LIKE xcco_t.xcco102b, #當月調整金額-人工
#       xcco102c LIKE xcco_t.xcco102c, #當月調整金額-委外加工
#       xcco102d LIKE xcco_t.xcco102d, #當月調整金額-制費一
#       xcco102e LIKE xcco_t.xcco102e, #當月調整金額-制費二
#       xcco102f LIKE xcco_t.xcco102f, #當月調整金額-制費三
#       xcco102g LIKE xcco_t.xcco102g, #當月調整金額-制費四
#       xcco102h LIKE xcco_t.xcco102h, #當月調整金額-制費五
#       xccoownid LIKE xcco_t.xccoownid, #資料所有者
#       xccoowndp LIKE xcco_t.xccoowndp, #資料所屬部門
#       xccocrtid LIKE xcco_t.xccocrtid, #資料建立者
#       xccocrtdp LIKE xcco_t.xccocrtdp, #資料建立部門
#       xccocrtdt LIKE xcco_t.xccocrtdt, #資料創建日
#       xccomodid LIKE xcco_t.xccomodid, #資料修改者
#       xccomoddt LIKE xcco_t.xccomoddt, #最近修改日
#       xccocnfid LIKE xcco_t.xccocnfid, #資料確認者
#       xccocnfdt LIKE xcco_t.xccocnfdt, #資料確認日
#       xccopstid LIKE xcco_t.xccopstid, #資料過帳者
#       xccopstdt LIKE xcco_t.xccopstdt, #資料過帳日
#       #xccostus LIKE xcco_t.xccostus  #狀態碼 #161109-00085#63 mark
#       #161109-00085#63 --s add      
#       xccostus LIKE xcco_t.xccostus, #狀態碼       
#       xccoud001 LIKE xcco_t.xccoud001, #自定義欄位(文字)001
#       xccoud002 LIKE xcco_t.xccoud002, #自定義欄位(文字)002
#       xccoud003 LIKE xcco_t.xccoud003, #自定義欄位(文字)003
#       xccoud004 LIKE xcco_t.xccoud004, #自定義欄位(文字)004
#       xccoud005 LIKE xcco_t.xccoud005, #自定義欄位(文字)005
#       xccoud006 LIKE xcco_t.xccoud006, #自定義欄位(文字)006
#       xccoud007 LIKE xcco_t.xccoud007, #自定義欄位(文字)007
#       xccoud008 LIKE xcco_t.xccoud008, #自定義欄位(文字)008
#       xccoud009 LIKE xcco_t.xccoud009, #自定義欄位(文字)009
#       xccoud010 LIKE xcco_t.xccoud010, #自定義欄位(文字)010
#       xccoud011 LIKE xcco_t.xccoud011, #自定義欄位(數字)011
#       xccoud012 LIKE xcco_t.xccoud012, #自定義欄位(數字)012
#       xccoud013 LIKE xcco_t.xccoud013, #自定義欄位(數字)013
#       xccoud014 LIKE xcco_t.xccoud014, #自定義欄位(數字)014
#       xccoud015 LIKE xcco_t.xccoud015, #自定義欄位(數字)015
#       xccoud016 LIKE xcco_t.xccoud016, #自定義欄位(數字)016
#       xccoud017 LIKE xcco_t.xccoud017, #自定義欄位(數字)017
#       xccoud018 LIKE xcco_t.xccoud018, #自定義欄位(數字)018
#       xccoud019 LIKE xcco_t.xccoud019, #自定義欄位(數字)019
#       xccoud020 LIKE xcco_t.xccoud020, #自定義欄位(數字)020
#       xccoud021 LIKE xcco_t.xccoud021, #自定義欄位(日期時間)021
#       xccoud022 LIKE xcco_t.xccoud022, #自定義欄位(日期時間)022
#       xccoud023 LIKE xcco_t.xccoud023, #自定義欄位(日期時間)023
#       xccoud024 LIKE xcco_t.xccoud024, #自定義欄位(日期時間)024
#       xccoud025 LIKE xcco_t.xccoud025, #自定義欄位(日期時間)025
#       xccoud026 LIKE xcco_t.xccoud026, #自定義欄位(日期時間)026
#       xccoud027 LIKE xcco_t.xccoud027, #自定義欄位(日期時間)027
#       xccoud028 LIKE xcco_t.xccoud028, #自定義欄位(日期時間)028
#       xccoud029 LIKE xcco_t.xccoud029, #自定義欄位(日期時間)029
#       xccoud030 LIKE xcco_t.xccoud030  #自定義欄位(日期時間)030
#       #161109-00085#63 --e add
#          END RECORD
##161109-00085#19-e mod
#
#DEFINE l_sql           STRING
#DEFINE l_sql1          STRING
#DEFINE l_rate          LIKE type_t.num26_10
#DEFINE l_rate1         LIKE type_t.num26_10
#DEFINE ld_date         DATETIME YEAR TO SECOND
#
#   LET g_success = 'Y'
#   LET l_xcea.xceaownid = g_user
#   LET l_xcea.xceaowndp = g_dept
#   LET l_xcea.xceacrtid = g_user
#   LET l_xcea.xceacrtdp = g_dept 
#   LET ld_date = cl_get_current()
#   LET l_xcea.xceamodid = ""
#   LET l_xcea.xceamoddt = ""
#   CALL s_aooi200_fin_gen_docno(g_xcea_m.xceald,'','',g_xcea_m.xceadocno,g_xcea_m.xcea001,g_prog_name1)      #wujie 150214
#    RETURNING l_success,g_xcea_m.xceadocno
#   IF l_success  = 0  THEN
#      INITIALIZE g_errparam TO NULL
#      LET g_errparam.code = 'apm-00003'
#      LET g_errparam.extend = g_xcea_m.xceadocno
#      LET g_errparam.popup = TRUE
#      CALL cl_err()
#
#      LET g_success = 'N'
#      RETURN g_success
#   END IF
#   
#   INSERT INTO xcea_t (xceaent,xceald,xceacomp,xcea006,xceadocno,xcea001,xcea002,xcea004, 
#       xcea005,xcea003,xceastus,xceaownid,xceaowndp,xceacrtid,xceacrtdp,xceacrtdt, 
#       xceamodid,xceamoddt)
#   VALUES (g_enterprise,g_xcea_m.xceald,g_xcea_m.xceacomp,g_xcea_m.xcea006,g_xcea_m.xceadocno, 
#       g_xcea_m.xcea001,g_xcea002,g_xcea_m.xcea004,g_xcea_m.xcea005,g_xcea_m.xcea003, 
#       'N',l_xcea.xceaownid,l_xcea.xceaowndp,l_xcea.xceacrtid, 
#       l_xcea.xceacrtdp,ld_date,l_xcea.xceamodid,l_xcea.xceamoddt) 
#       
#   IF SQLCA.sqlcode THEN
#      INITIALIZE g_errparam TO NULL
#      LET g_errparam.code = SQLCA.sqlcode
#      LET g_errparam.extend = "g_xcea_m"
#      LET g_errparam.popup = TRUE
#      CALL cl_err()
#  
#      LET g_success = 'N'
#      RETURN g_success
#   END IF
#   LET l_sql = " SELECT SUM(xcco102), ",
#               "        SUM(xcco102a),SUM(xcco102b),SUM(xcco102c),SUM(xcco102d),",
#               "        SUM(xcco102e),SUM(xcco102f),SUM(xcco102g),SUM(xcco102h) ",
#               "        FROM xcco_t ", 
#               "  WHERE xccoent = '",g_enterprise,"' AND xccold = '",g_xcea_m.xceald,"'",
#               "    AND xcco003 = '",g_xcea_m.xcea003,"' AND xcco004 = ",g_xcea_m.xcea004,
#               "    AND xcco005 = ",g_xcea_m.xcea005,
#               "    AND xcco002 = ? AND xcco009 = ? AND xcco006 = ? ",
#               "    AND xcco007 = ? AND xcco008 = ? AND xcco010 = ?  ",
#               "    AND xcco010 = '1'"
#    
#   LET g_sql = l_sql CLIPPED," AND xcco001 = '2' " 
#
#   DECLARE xcae_prep2 CURSOR FROM g_sql
#   
#   LET g_sql = l_sql CLIPPED," AND xcco001 = '3' " 
#
#   DECLARE xcae_prep3 CURSOR FROM g_sql
#   
#   #161124-00011#2-add-s
#   IF cl_null(g_wc2) THEN
#      LET g_wc2 = " 1=1 "
#   END IF
#   #161124-00011#2-add-e
#   
#   LET l_sql = " SELECT xcco002,xcco009,xcco006,xcco007,xcco008,xcco010,SUM(xcco102), ",
#               "        SUM(xcco102a),SUM(xcco102b),SUM(xcco102c),SUM(xcco102d),",
#               "        SUM(xcco102e),SUM(xcco102f),SUM(xcco102g),SUM(xcco102h) ",
#               "        FROM xcco_t ", 
#               "  WHERE xccoent = '",g_enterprise,"' AND xccold = '",g_xcea_m.xceald,"'",
#               "    AND xcco003 = '",g_xcea_m.xcea003,"' AND xcco004 = ",g_xcea_m.xcea004,
#               "    AND xcco005 = ",g_xcea_m.xcea005,
#               #161124-00011#2-mod-s
##               "    AND xcco010 = '1'"
#               "    AND ",g_wc2
#               #161124-00011#2-mod-e
#   LET l_sql1 = l_sql CLIPPED," AND xcco001 = '1' ",
#                " GROUP BY xcco002,xcco009,xcco006,xcco007,xcco008,xcco010",
#                " ORDER BY xcco002,xcco009,xcco006,xcco007,xcco008,xcco010"
#   PREPARE xcae_prep FROM l_sql1
#   DECLARE xcae_curs CURSOR FOR xcae_prep
#   
#
#   FOREACH xcae_curs INTO  l_xcco.xcco002,l_xcco.xcco009,l_xcco.xcco006,l_xcco.xcco007,l_xcco.xcco008,l_xcco.xcco010,
#                           l_xcco.xcco102,l_xcco.xcco102a,l_xcco.xcco102b,l_xcco.xcco102c,l_xcco.xcco102d,
#                           l_xcco.xcco102e,l_xcco.xcco102f,l_xcco.xcco102g,l_xcco.xcco102h
#      
#      IF g_glaa015 ='Y' THEN      
#         OPEN xcae_prep2 USING  l_xcco.xcco002,l_xcco.xcco009,l_xcco.xcco006,l_xcco.xcco007,l_xcco.xcco008,l_xcco.xcco010
#         FETCH xcae_prep2 INTO l_xceb.xceb212,l_xceb.xceb212a,l_xceb.xceb212b,l_xceb.xceb212c,l_xceb.xceb212d,
#                               l_xceb.xceb212e,l_xceb.xceb212f,l_xceb.xceb212g,l_xceb.xceb212h
#         #資料被他人LOCK, 或是sql執行時出現錯誤
#         IF SQLCA.sqlcode THEN
#            INITIALIZE g_errparam TO NULL
#            LET g_errparam.code = SQLCA.sqlcode
#            LET g_errparam.extend = g_xcea_m.xceald
#            LET g_errparam.popup = FALSE
#            CALL cl_err()
#         
#            CLOSE xcae_prep2
#            CALL s_transaction_end('N','0')
#            RETURN
#         END IF
#      ELSE
#         LET l_xceb.xceb212a = 0
#         LET l_xceb.xceb212b = 0
#         LET l_xceb.xceb212c = 0
#         LET l_xceb.xceb212d = 0
#         LET l_xceb.xceb212e = 0
#         LET l_xceb.xceb212f = 0
#         LET l_xceb.xceb212g = 0
#         LET l_xceb.xceb212h = 0
#         LET l_xceb.xceb212  = 0     
#      END IF
#
#         
##      IF g_glaa015 = 'Y' THEN
##         CALL s_aooi160_get_exrate('2',g_xcea_m.xceald,g_xcea_m.xcea001,g_glaa001,
##                                        #目的幣別;  交易金額;              匯類類型
##                                         g_glaa016,0,g_glaa018)
##                  RETURNING l_rate
##      END IF
##      
##      IF g_glaa019 = 'Y' THEN
##         CALL s_aooi160_get_exrate('2',g_xcea_m.xceald,g_xcea_m.xcea001,g_glaa001,
##                                        #目的幣別;  交易金額;              匯類類型
##                                         g_glaa016,0,g_glaa022)
##          RETURNING l_rate1
##      END IF
#      
#      IF g_glaa019 ='Y' THEN
#         OPEN xcae_prep3 USING  l_xcco.xcco002,l_xcco.xcco009,l_xcco.xcco006,l_xcco.xcco007,l_xcco.xcco008,l_xcco.xcco010
#         FETCH xcae_prep3 INTO l_xceb.xceb222,l_xceb.xceb222a,l_xceb.xceb222b,l_xceb.xceb222c,l_xceb.xceb222d,
#                               l_xceb.xceb222e,l_xceb.xceb222f,l_xceb.xceb222g,l_xceb.xceb222h
#         #資料被他人LOCK, 或是sql執行時出現錯誤
#         IF SQLCA.sqlcode THEN
#            INITIALIZE g_errparam TO NULL
#            LET g_errparam.code = SQLCA.sqlcode
#            LET g_errparam.extend = g_xcea_m.xceald
#            LET g_errparam.popup = FALSE
#            CALL cl_err()
#         
#            CLOSE xcae_prep3
#            CALL s_transaction_end('N','0')
#            RETURN
#         END IF 
#      ELSE
#         LET l_xceb.xceb222a = 0
#         LET l_xceb.xceb222b = 0
#         LET l_xceb.xceb222c = 0
#         LET l_xceb.xceb222d = 0
#         LET l_xceb.xceb222e = 0
#         LET l_xceb.xceb222f = 0
#         LET l_xceb.xceb222g = 0
#         LET l_xceb.xceb222h = 0
#         LET l_xceb.xceb222  = 0     
#      END IF
#
#      SELECT MAX(xcebseq) INTO l_xceb.xcebseq FROM xceb_t
#       WHERE xcebent = g_enterprise AND xcebld = g_xcea_m.xceald
#         AND xcebdocno = g_xcea_m.xceadocno
#      IF cl_null(l_xceb.xcebseq) OR l_xceb.xcebseq = 0 THEN
#         LET l_xceb.xcebseq = 1
#      ELSE
#         LET l_xceb.xcebseq = l_xceb.xcebseq + 1
#      END IF 
#  
#      LET l_xceb.xcebent = g_enterprise
#      LET l_xceb.xcebld  = g_xcea_m.xceald
#      LET l_xceb.xcebdocno=g_xcea_m.xceadocno
#      LET l_xceb.xcebcomp=g_xcea_m.xceacomp
#      LET l_xceb.xceb001 = l_xcco.xcco009
#      LET l_xceb.xceb003 = l_xcco.xcco010
#      LET l_xceb.xceb004 = l_xcco.xcco006
#      LET l_xceb.xceb005 = l_xcco.xcco007
#      LET l_xceb.xceb102 = ''
#      LET l_xceb.xceb103 = l_xcco.xcco002
#      LET l_xceb.xceb119 = ''
#      LET l_xceb.xceb201 = 0
#      LET l_xceb.xceb202 = l_xcco.xcco102
#      LET l_xceb.xceb202a = l_xcco.xcco102a
#      LET l_xceb.xceb202b = l_xcco.xcco102b
#      LET l_xceb.xceb202c = l_xcco.xcco102c
#      LET l_xceb.xceb202d = l_xcco.xcco102d
#      LET l_xceb.xceb202e = l_xcco.xcco102e
#      LET l_xceb.xceb202f = l_xcco.xcco102f
#      LET l_xceb.xceb202g = l_xcco.xcco102g
#      LET l_xceb.xceb202h = l_xcco.xcco102h
#     
#      SELECT imag011 INTO l_xceb.xceb117 FROM imag_t
#       WHERE imagent = g_enterprise AND imagsite = g_xcea_m.xceacomp
#         AND imag001 = l_xceb.xceb004       
# 
#
#      CALL s_get_item_acc(g_xcea_m.xceald,'1',l_xceb.xceb004,'','',g_xcea_m.xceacomp,'') 
#       RETURNING l_success,l_xceb.xceb101 
#        
#      #人员
#      LET l_xceb.xceb107 = ' '
#      #部门
#      LET l_xceb.xceb108 = ' '
#      #账款对象
#      LET l_xceb.xceb109 = ' '
#      #自由核算项1～10  
#      LET l_xceb.xceb121 = ' '
#      LET l_xceb.xceb122 = ' '
#      LET l_xceb.xceb123 = ' '
#      LET l_xceb.xceb124 = ' '
#      LET l_xceb.xceb125 = ' '
#      LET l_xceb.xceb126 = ' '
#      LET l_xceb.xceb127 = ' '
#      LET l_xceb.xceb128 = ' '
#      LET l_xceb.xceb129 = ' '
#      LET l_xceb.xceb130 = ' ' 
#      #摘要
#      IF cl_null(l_xceb.xceb102) THEN
#         CALL axct701_01_get_summ(g_xcea_m.xceald,'61','8925','3') RETURNING l_success,l_xceb.xceb102
#      END IF
#      CALL axct701_01_default_space_xceb(l_xceb.*) RETURNING l_xceb.xceb005,
#                                                             l_xceb.xceb101,
#                                                             l_xceb.xceb102,
#                                                             l_xceb.xceb103,
#                                                             l_xceb.xceb110,
#                                                             l_xceb.xceb111,
#                                                             l_xceb.xceb112,
#                                                             l_xceb.xceb113,
#                                                             l_xceb.xceb114,
#                                                             l_xceb.xceb115,
#                                                             l_xceb.xceb116,
#                                                             l_xceb.xceb117,
#                                                             l_xceb.xceb118,
#                                                             l_xceb.xceb119,
#                                                             l_xceb.xceb120,
#                                                             l_xceb.xceb107,
#                                                             l_xceb.xceb108,
#                                                             l_xceb.xceb109,
#                                                             l_xceb.xceb121,
#                                                             l_xceb.xceb122,
#                                                             l_xceb.xceb123,
#                                                             l_xceb.xceb124,
#                                                             l_xceb.xceb125,
#                                                             l_xceb.xceb126,
#                                                             l_xceb.xceb127,
#                                                             l_xceb.xceb128,
#                                                             l_xceb.xceb129,
#                                                             l_xceb.xceb130
##如果金额和数量都为0的话，则不产生此笔单身数据                                                             
#      IF l_xceb.xceb201= 0 AND l_xceb.xceb202 = 0 THEN
#         CONTINUE FOREACH
#      END IF
#     #161109-00085#20-s mod
##      INSERT INTO xceb_t VALUES(l_xceb.*)   #161109-00085#20-s mark
#      #161109-00085#63 --s mark
#      #INSERT INTO xceb_t(xcebent,xcebcomp,xcebld,xcebdocno,xcebseq,xceb001,xceb002,xceb003,xceb004,
#      #                   xceb005,xceb101,xceb102,xceb103,xceb110,xceb111,xceb112,xceb113,xceb114,xceb115,
#      #                   xceb116,xceb117,xceb118,xceb119,xceb120,xceb201,xceb202,xceb202a,xceb202b,xceb202c,
#      #                   xceb202d,xceb202e,xceb202f,xceb202g,xceb202h,xceb212,xceb212a,xceb212b,xceb212c,
#      #                   xceb212d,xceb212e,xceb212f,xceb212g,xceb212h,xceb222,xceb222a,xceb222b,xceb222c,
#      #                   xceb222d,xceb222e,xceb222f,xceb222g,xceb222h,xceb301,xceb302,xceb107,xceb108,xceb109,
#      #                   xceb121,xceb122,xceb123,xceb124,xceb125,xceb126,xceb127,xceb128,xceb129,xceb130,xceb131,xceb132) 
#      #            VALUES(l_xceb.xcebent,l_xceb.xcebcomp,l_xceb.xcebld,l_xceb.xcebdocno,l_xceb.xcebseq,
#      #                   l_xceb.xceb001,l_xceb.xceb002,l_xceb.xceb003,l_xceb.xceb004,l_xceb.xceb005,
#      #                   l_xceb.xceb101,l_xceb.xceb102,l_xceb.xceb103,l_xceb.xceb110,l_xceb.xceb111,
#      #                   l_xceb.xceb112,l_xceb.xceb113,l_xceb.xceb114,l_xceb.xceb115,l_xceb.xceb116,
#      #                   l_xceb.xceb117,l_xceb.xceb118,l_xceb.xceb119,l_xceb.xceb120,l_xceb.xceb201,
#      #                   l_xceb.xceb202,l_xceb.xceb202a,l_xceb.xceb202b,l_xceb.xceb202c,l_xceb.xceb202d,
#      #                   l_xceb.xceb202e,l_xceb.xceb202f,l_xceb.xceb202g,l_xceb.xceb202h,l_xceb.xceb212,
#      #                   l_xceb.xceb212a,l_xceb.xceb212b,l_xceb.xceb212c,l_xceb.xceb212d,l_xceb.xceb212e,
#      #                   l_xceb.xceb212f,l_xceb.xceb212g,l_xceb.xceb212h,l_xceb.xceb222,l_xceb.xceb222a,
#      #                   l_xceb.xceb222b,l_xceb.xceb222c,l_xceb.xceb222d,l_xceb.xceb222e,l_xceb.xceb222f,
#      #                   l_xceb.xceb222g,l_xceb.xceb222h,l_xceb.xceb301,l_xceb.xceb302,l_xceb.xceb107,
#      #                   l_xceb.xceb108,l_xceb.xceb109,l_xceb.xceb121,l_xceb.xceb122,l_xceb.xceb123,
#      #                   l_xceb.xceb124,l_xceb.xceb125,l_xceb.xceb126,l_xceb.xceb127,l_xceb.xceb128,
#      #                   l_xceb.xceb129,l_xceb.xceb130,l_xceb.xceb131,l_xceb.xceb132)
#      #161109-00085#20-e mod
#      #161109-00085#63 --e mark
#      #161109-00085#63 --s add
#      INSERT INTO xceb_t(xcebent,xcebcomp,xcebld,xcebdocno,xcebseq,
#                         xceb001,xceb002,xceb003,xceb004,xceb005,
#                         xceb101,xceb102,xceb103,xceb110,xceb111,
#                         xceb112,xceb113,xceb114,xceb115,xceb116,
#                         xceb117,xceb118,xceb119,xceb120,xceb201,
#                         xceb202,xceb202a,xceb202b,xceb202c,xceb202d,
#                         xceb202e,xceb202f,xceb202g,xceb202h,xceb212,
#                         xceb212a,xceb212b,xceb212c,xceb212d,xceb212e,
#                         xceb212f,xceb212g,xceb212h,xceb222,xceb222a,
#                         xceb222b,xceb222c,xceb222d,xceb222e,xceb222f,
#                         xceb222g,xceb222h,xceb301,xceb302,xcebud001,
#                         xcebud002,xcebud003,xcebud004,xcebud005,xcebud006,
#                         xcebud007,xcebud008,xcebud009,xcebud010,xcebud011,
#                         xcebud012,xcebud013,xcebud014,xcebud015,xcebud016,
#                         xcebud017,xcebud018,xcebud019,xcebud020,xcebud021,
#                         xcebud022,xcebud023,xcebud024,xcebud025,xcebud026,
#                         xcebud027,xcebud028,xcebud029,xcebud030,xceb107,
#                         xceb108,xceb109,xceb121,xceb122,xceb123,
#                         xceb124,xceb125,xceb126,xceb127,xceb128,
#                         xceb129,xceb130,xceb131,xceb132)
#      VALUES(l_xceb.xcebent,l_xceb.xcebcomp,l_xceb.xcebld,l_xceb.xcebdocno,l_xceb.xcebseq,
#             l_xceb.xceb001,l_xceb.xceb002,l_xceb.xceb003,l_xceb.xceb004,l_xceb.xceb005,
#             l_xceb.xceb101,l_xceb.xceb102,l_xceb.xceb103,l_xceb.xceb110,l_xceb.xceb111,
#             l_xceb.xceb112,l_xceb.xceb113,l_xceb.xceb114,l_xceb.xceb115,l_xceb.xceb116,
#             l_xceb.xceb117,l_xceb.xceb118,l_xceb.xceb119,l_xceb.xceb120,l_xceb.xceb201,
#             l_xceb.xceb202,l_xceb.xceb202a,l_xceb.xceb202b,l_xceb.xceb202c,l_xceb.xceb202d,
#             l_xceb.xceb202e,l_xceb.xceb202f,l_xceb.xceb202g,l_xceb.xceb202h,l_xceb.xceb212,
#             l_xceb.xceb212a,l_xceb.xceb212b,l_xceb.xceb212c,l_xceb.xceb212d,l_xceb.xceb212e,
#             l_xceb.xceb212f,l_xceb.xceb212g,l_xceb.xceb212h,l_xceb.xceb222,l_xceb.xceb222a,
#             l_xceb.xceb222b,l_xceb.xceb222c,l_xceb.xceb222d,l_xceb.xceb222e,l_xceb.xceb222f,
#             l_xceb.xceb222g,l_xceb.xceb222h,l_xceb.xceb301,l_xceb.xceb302,l_xceb.xcebud001,
#             l_xceb.xcebud002,l_xceb.xcebud003,l_xceb.xcebud004,l_xceb.xcebud005,l_xceb.xcebud006,
#             l_xceb.xcebud007,l_xceb.xcebud008,l_xceb.xcebud009,l_xceb.xcebud010,l_xceb.xcebud011,
#             l_xceb.xcebud012,l_xceb.xcebud013,l_xceb.xcebud014,l_xceb.xcebud015,l_xceb.xcebud016,
#             l_xceb.xcebud017,l_xceb.xcebud018,l_xceb.xcebud019,l_xceb.xcebud020,l_xceb.xcebud021,
#             l_xceb.xcebud022,l_xceb.xcebud023,l_xceb.xcebud024,l_xceb.xcebud025,l_xceb.xcebud026,
#             l_xceb.xcebud027,l_xceb.xcebud028,l_xceb.xcebud029,l_xceb.xcebud030,l_xceb.xceb107,
#             l_xceb.xceb108,l_xceb.xceb109,l_xceb.xceb121,l_xceb.xceb122,l_xceb.xceb123,
#             l_xceb.xceb124,l_xceb.xceb125,l_xceb.xceb126,l_xceb.xceb127,l_xceb.xceb128,
#             l_xceb.xceb129,l_xceb.xceb130,l_xceb.xceb131,l_xceb.xceb132)
#      #161109-00085#63 --e add
#     
#     IF SQLCA.sqlcode THEN
#        INITIALIZE g_errparam TO NULL
#      LET g_errparam.code = SQLCA.sqlcode
#      LET g_errparam.extend = "g_xcea_m"
#      LET g_errparam.popup = TRUE
#      CALL cl_err()
#  
#        LET g_success = 'N'
#        EXIT FOREACH
#     END IF
#      
#      INITIALIZE l_xcec.* TO NULL
#           
#      SELECT MAX(xcecseq) INTO l_xcec.xcecseq FROM xcec_t
#       WHERE xcecent = g_enterprise AND xcecld = g_xcea_m.xceald
#         AND xcecdocno = g_xcea_m.xceadocno
#      IF cl_null(l_xcec.xcecseq) OR l_xcec.xcecseq = 0 THEN
#         LET l_xcec.xcecseq = 1
#      ELSE
#         LET l_xcec.xcecseq = l_xcec.xcecseq + 1
#      END IF 
#      
#      LET l_xcec.xcecent = g_enterprise
#      LET l_xcec.xcecld  = g_xcea_m.xceald
#      LET l_xcec.xcecdocno=g_xcea_m.xceadocno
#      LET l_xcec.xceccomp=g_xcea_m.xceacomp
#      LET l_xcec.xcec001 = l_xcco.xcco009
#      LET l_xcec.xcec003 = l_xcco.xcco010
#      LET l_xcec.xcec004 = l_xcco.xcco006
#      LET l_xcec.xcec005 = l_xcco.xcco007
#      LET l_xcec.xcec101 = ''
#      #抓axci201的科目
#      IF cl_null(l_xcec.xcec101) THEN
#         CALL s_fin_get_account(g_xcea_m.xceald,'60','8912','5') RETURNING l_success,l_xcec.xcec101,l_errno
#      END IF
#      LET l_xcec.xcec102 = ''
#      LET l_xcec.xcec103 = l_xcco.xcco002
#      LET l_xcec.xcec117 = l_xceb.xceb117
#      LET l_xcec.xcec119 = ''
#      LET l_xcec.xcec201 = 0
#      LET l_xcec.xcec202 = l_xcco.xcco102
#      LET l_xcec.xcec202a = l_xcco.xcco102a
#      LET l_xcec.xcec202b = l_xcco.xcco102b
#      LET l_xcec.xcec202c = l_xcco.xcco102c
#      LET l_xcec.xcec202d = l_xcco.xcco102d
#      LET l_xcec.xcec202e = l_xcco.xcco102e
#      LET l_xcec.xcec202f = l_xcco.xcco102f
#      LET l_xcec.xcec202g = l_xcco.xcco102g
#      LET l_xcec.xcec202h = l_xcco.xcco102h
#      LET l_xcec.xcec212  = l_xceb.xceb212
#      LET l_xcec.xcec212a  = l_xceb.xceb212a
#      LET l_xcec.xcec212b  = l_xceb.xceb212b
#      LET l_xcec.xcec212c  = l_xceb.xceb212c
#      LET l_xcec.xcec212d  = l_xceb.xceb212d
#      LET l_xcec.xcec212e  = l_xceb.xceb212e
#      LET l_xcec.xcec212f  = l_xceb.xceb212f
#      LET l_xcec.xcec212g  = l_xceb.xceb212g
#      LET l_xcec.xcec212h  = l_xceb.xceb212h
#      LET l_xcec.xcec222   = l_xceb.xceb222
#      LET l_xcec.xcec222a  = l_xceb.xceb222a
#      LET l_xcec.xcec222b  = l_xceb.xceb222b
#      LET l_xcec.xcec222c  = l_xceb.xceb222c
#      LET l_xcec.xcec222d  = l_xceb.xceb222d
#      LET l_xcec.xcec222e  = l_xceb.xceb222e
#      LET l_xcec.xcec222f  = l_xceb.xceb222f
#      LET l_xcec.xcec222g  = l_xceb.xceb222g
#      LET l_xcec.xcec222h  = l_xceb.xceb222h
#      LET l_xcec.xcec107  = l_xceb.xceb107
#      LET l_xcec.xcec108  = l_xceb.xceb108
#      LET l_xcec.xcec109  = l_xceb.xceb109
#      LET l_xcec.xcec121  = l_xceb.xceb121
#      LET l_xcec.xcec122  = l_xceb.xceb122
#      LET l_xcec.xcec123  = l_xceb.xceb123
#      LET l_xcec.xcec124  = l_xceb.xceb124
#      LET l_xcec.xcec125  = l_xceb.xceb125
#      LET l_xcec.xcec126  = l_xceb.xceb126
#      LET l_xcec.xcec127  = l_xceb.xceb127
#      LET l_xcec.xcec128  = l_xceb.xceb128
#      LET l_xcec.xcec129  = l_xceb.xceb129
#      LET l_xcec.xcec130  = l_xceb.xceb130   
# 
#      #摘要
#      IF cl_null(l_xcec.xcec102) THEN
#         CALL axct701_01_get_summ(g_xcea_m.xceald,'61','8925','3') RETURNING l_success,l_xcec.xcec102
#      END IF
#      CALL axct701_01_default_space_xceb(l_xceb.*) RETURNING l_xceb.xceb005,
#                                                             l_xceb.xceb101,
#                                                             l_xceb.xceb102,
#                                                             l_xceb.xceb103,
#                                                             l_xceb.xceb110,
#                                                             l_xceb.xceb111,
#                                                             l_xceb.xceb112,
#                                                             l_xceb.xceb113,
#                                                             l_xceb.xceb114,
#                                                             l_xceb.xceb115,
#                                                             l_xceb.xceb116,
#                                                             l_xceb.xceb117,
#                                                             l_xceb.xceb118,
#                                                             l_xceb.xceb119,
#                                                             l_xceb.xceb120,
#                                                             l_xceb.xceb107,
#                                                             l_xceb.xceb108,
#                                                             l_xceb.xceb109,
#                                                             l_xceb.xceb121,
#                                                             l_xceb.xceb122,
#                                                             l_xceb.xceb123,
#                                                             l_xceb.xceb124,
#                                                             l_xceb.xceb125,
#                                                             l_xceb.xceb126,
#                                                             l_xceb.xceb127,
#                                                             l_xceb.xceb128,
#                                                             l_xceb.xceb129,
#                                                             l_xceb.xceb130      
##如果金额和数量都为0的话，则不产生此笔单身数据                                                             
#      IF l_xcec.xcec201= 0 AND l_xcec.xcec202 = 0 THEN
#         CONTINUE FOREACH
#      END IF       
#      #161109-00085#20-s mod      
##      INSERT INTO xcec_t VALUES(l_xcec.*)   #161109-00085#20-s mark
#      #161109-00085#63 --s mark
#      #INSERT INTO xcec_t(xcecent,xceccomp,xcecld,xcecdocno,xcecseq,xcec001,xcec002,xcec003,xcec004,
#      #                   xcec005,xcec101,xcec102,xcec103,xcec110,xcec111,xcec112,xcec113,xcec114,
#      #                   xcec115,xcec116,xcec117,xcec118,xcec119,xcec120,xcec201,xcec202,xcec202a,
#      #                   xcec202b,xcec202c,xcec202d,xcec202e,xcec202f,xcec202g,xcec202h,xcec212,
#      #                   xcec212a,xcec212b,xcec212c,xcec212d,xcec212e,xcec212f,xcec212g,xcec212h,
#      #                   xcec222,xcec222a,xcec222b,xcec222c,xcec222d,xcec222e,xcec222f,xcec222g,
#      #                   xcec222h,xcec301,xcec302,xcec107,xcec108,xcec109,xcec121,xcec122,xcec123,
#      #                   xcec124,xcec125,xcec126,xcec127,xcec128,xcec129,xcec130) 
#      #            VALUES(l_xcec.xcecent,l_xcec.xceccomp,l_xcec.xcecld,l_xcec.xcecdocno,l_xcec.xcecseq,
#      #                   l_xcec.xcec001,l_xcec.xcec002,l_xcec.xcec003,l_xcec.xcec004,l_xcec.xcec005,
#      #                   l_xcec.xcec101,l_xcec.xcec102,l_xcec.xcec103,l_xcec.xcec110,l_xcec.xcec111,
#      #                   l_xcec.xcec112,l_xcec.xcec113,l_xcec.xcec114,l_xcec.xcec115,l_xcec.xcec116,
#      #                   l_xcec.xcec117,l_xcec.xcec118,l_xcec.xcec119,l_xcec.xcec120,l_xcec.xcec201,
#      #                   l_xcec.xcec202,l_xcec.xcec202a,l_xcec.xcec202b,l_xcec.xcec202c,l_xcec.xcec202d,
#      #                   l_xcec.xcec202e,l_xcec.xcec202f,l_xcec.xcec202g,l_xcec.xcec202h,l_xcec.xcec212,
#      #                   l_xcec.xcec212a,l_xcec.xcec212b,l_xcec.xcec212c,l_xcec.xcec212d,l_xcec.xcec212e,
#      #                   l_xcec.xcec212f,l_xcec.xcec212g,l_xcec.xcec212h,l_xcec.xcec222,l_xcec.xcec222a,
#      #                   l_xcec.xcec222b,l_xcec.xcec222c,l_xcec.xcec222d,l_xcec.xcec222e,l_xcec.xcec222f,
#      #                   l_xcec.xcec222g,l_xcec.xcec222h,l_xcec.xcec301,l_xcec.xcec302,l_xcec.xcec107,
#      #                   l_xcec.xcec108,l_xcec.xcec109,l_xcec.xcec121,l_xcec.xcec122,l_xcec.xcec123,
#      #                   l_xcec.xcec124,l_xcec.xcec125,l_xcec.xcec126,l_xcec.xcec127,l_xcec.xcec128,
#      #                   l_xcec.xcec129,l_xcec.xcec130)
#      #161109-00085#63 --e mark
#      #161109-00085#20-e mod
#      #161109-00085#63 --s add
#      INSERT INTO xcec_t(xcecent,xceccomp,xcecld,xcecdocno,xcecseq,
#                         xcec001,xcec002,xcec003,xcec004,xcec005,
#                         xcec101,xcec102,xcec103,xcec110,xcec111,
#                         xcec112,xcec113,xcec114,xcec115,xcec116,
#                         xcec117,xcec118,xcec119,xcec120,xcec201,
#                         xcec202,xcec202a,xcec202b,xcec202c,xcec202d,
#                         xcec202e,xcec202f,xcec202g,xcec202h,xcec212,
#                         xcec212a,xcec212b,xcec212c,xcec212d,xcec212e,
#                         xcec212f,xcec212g,xcec212h,xcec222,xcec222a,
#                         xcec222b,xcec222c,xcec222d,xcec222e,xcec222f,
#                         xcec222g,xcec222h,xcec301,xcec302,xcecud001,
#                         xcecud002,xcecud003,xcecud004,xcecud005,xcecud006,
#                         xcecud007,xcecud008,xcecud009,xcecud010,xcecud011,
#                         xcecud012,xcecud013,xcecud014,xcecud015,xcecud016,
#                         xcecud017,xcecud018,xcecud019,xcecud020,xcecud021,
#                         xcecud022,xcecud023,xcecud024,xcecud025,xcecud026,
#                         xcecud027,xcecud028,xcecud029,xcecud030,xcec107,
#                         xcec108,xcec109,xcec121,xcec122,xcec123,
#                         xcec124,xcec125,xcec126,xcec127,xcec128,
#                         xcec129,xcec130)
#      VALUES(l_xcec.xcecent,l_xcec.xceccomp,l_xcec.xcecld,l_xcec.xcecdocno,l_xcec.xcecseq,
#             l_xcec.xcec001,l_xcec.xcec002,l_xcec.xcec003,l_xcec.xcec004,l_xcec.xcec005,
#             l_xcec.xcec101,l_xcec.xcec102,l_xcec.xcec103,l_xcec.xcec110,l_xcec.xcec111,
#             l_xcec.xcec112,l_xcec.xcec113,l_xcec.xcec114,l_xcec.xcec115,l_xcec.xcec116,
#             l_xcec.xcec117,l_xcec.xcec118,l_xcec.xcec119,l_xcec.xcec120,l_xcec.xcec201,
#             l_xcec.xcec202,l_xcec.xcec202a,l_xcec.xcec202b,l_xcec.xcec202c,l_xcec.xcec202d,
#             l_xcec.xcec202e,l_xcec.xcec202f,l_xcec.xcec202g,l_xcec.xcec202h,l_xcec.xcec212,
#             l_xcec.xcec212a,l_xcec.xcec212b,l_xcec.xcec212c,l_xcec.xcec212d,l_xcec.xcec212e,
#             l_xcec.xcec212f,l_xcec.xcec212g,l_xcec.xcec212h,l_xcec.xcec222,l_xcec.xcec222a,
#             l_xcec.xcec222b,l_xcec.xcec222c,l_xcec.xcec222d,l_xcec.xcec222e,l_xcec.xcec222f,
#             l_xcec.xcec222g,l_xcec.xcec222h,l_xcec.xcec301,l_xcec.xcec302,l_xcec.xcecud001,
#             l_xcec.xcecud002,l_xcec.xcecud003,l_xcec.xcecud004,l_xcec.xcecud005,l_xcec.xcecud006,
#             l_xcec.xcecud007,l_xcec.xcecud008,l_xcec.xcecud009,l_xcec.xcecud010,l_xcec.xcecud011,
#             l_xcec.xcecud012,l_xcec.xcecud013,l_xcec.xcecud014,l_xcec.xcecud015,l_xcec.xcecud016,
#             l_xcec.xcecud017,l_xcec.xcecud018,l_xcec.xcecud019,l_xcec.xcecud020,l_xcec.xcecud021,
#             l_xcec.xcecud022,l_xcec.xcecud023,l_xcec.xcecud024,l_xcec.xcecud025,l_xcec.xcecud026,
#             l_xcec.xcecud027,l_xcec.xcecud028,l_xcec.xcecud029,l_xcec.xcecud030,l_xcec.xcec107,
#             l_xcec.xcec108,l_xcec.xcec109,l_xcec.xcec121,l_xcec.xcec122,l_xcec.xcec123,
#             l_xcec.xcec124,l_xcec.xcec125,l_xcec.xcec126,l_xcec.xcec127,l_xcec.xcec128,
#             l_xcec.xcec129,l_xcec.xcec130)
#      #161109-00085#63 --e add
#      
#      IF SQLCA.sqlcode THEN
#         INITIALIZE g_errparam TO NULL
#      LET g_errparam.code = SQLCA.sqlcode
#      LET g_errparam.extend = "g_xcea_m"
#      LET g_errparam.popup = TRUE
#      CALL cl_err()
#  
#         LET g_success = 'N'
#         EXIT FOREACH
#      END IF
#      
#      
#      CLOSE xcae_prep2
#      CLOSE xcae_prep3
#   END FOREACH   
#   RETURN g_success  
#170105-00011#6---mark---e
END FUNCTION

################################################################################
# Descriptions...: 描述说明  10.盤因虧憑證  axct704
# Memo...........:
# Usage..........: CALL s_aooi150_ins (传入参数)
#                  RETURNING 回传参数
# Input parameter: 传入参数变量1   传入参数变量说明1
#                : 传入参数变量2   传入参数变量说明2
# Return code....: 回传参数变量1   回传参数变量说明1
#                : 回传参数变量2   回传参数变量说明2
# Date & Author..: 日期 By 作者
# Modify.........: #170105-00011#7 将该function改成_bak
################################################################################
PRIVATE FUNCTION axct701_01_ins_4_bak()
#170105-00011#7---mark---s
#DEFINE l_success       LIKE type_t.num5
#DEFINE l_errno         LIKE gzze_t.gzze001
##161109-00085#19-s mod
##DEFINE l_xcea          RECORD LIKE xcea_t.*   #161109-00085#19-s mark
#DEFINE l_xcea          RECORD  #工單發料成本憑證單頭檔
#          xceaent LIKE xcea_t.xceaent, #企業編號
#          xceacomp LIKE xcea_t.xceacomp, #法人組織
#          xceald LIKE xcea_t.xceald, #帳套
#          xceadocno LIKE xcea_t.xceadocno, #單據編號
#          xcea001 LIKE xcea_t.xcea001, #單據日期
#          xcea002 LIKE xcea_t.xcea002, #成本憑證類型
#          xcea003 LIKE xcea_t.xcea003, #成本計算類型
#          xcea004 LIKE xcea_t.xcea004, #年度
#          xcea005 LIKE xcea_t.xcea005, #期別
#          xcea006 LIKE xcea_t.xcea006, #帳務人員
#          xcea007 LIKE xcea_t.xcea007, #帳務部門
#          xcea101 LIKE xcea_t.xcea101, #憑證編號
#          xcea102 LIKE xcea_t.xcea102, #憑證日期
#          xceaownid LIKE xcea_t.xceaownid, #資料所有者
#          xceaowndp LIKE xcea_t.xceaowndp, #資料所屬部門
#          xceacrtid LIKE xcea_t.xceacrtid, #資料建立者
#          xceacrtdp LIKE xcea_t.xceacrtdp, #資料建立部門
#          xceacrtdt LIKE xcea_t.xceacrtdt, #資料創建日
#          xceamodid LIKE xcea_t.xceamodid, #資料修改者
#          xceamoddt LIKE xcea_t.xceamoddt, #最近修改日
#          xceacnfid LIKE xcea_t.xceacnfid, #資料確認者
#          xceacnfdt LIKE xcea_t.xceacnfdt, #資料確認日
#          xceapstid LIKE xcea_t.xceapstid, #資料過帳者
#          xceapstdt LIKE xcea_t.xceapstdt, #資料過帳日
#          xceastus LIKE xcea_t.xceastus, #狀態碼
#          #161109-00085#63 --s add
#          xceaud001 LIKE xcea_t.xceaud001, #自定義欄位(文字)001
#          xceaud002 LIKE xcea_t.xceaud002, #自定義欄位(文字)002
#          xceaud003 LIKE xcea_t.xceaud003, #自定義欄位(文字)003
#          xceaud004 LIKE xcea_t.xceaud004, #自定義欄位(文字)004
#          xceaud005 LIKE xcea_t.xceaud005, #自定義欄位(文字)005
#          xceaud006 LIKE xcea_t.xceaud006, #自定義欄位(文字)006
#          xceaud007 LIKE xcea_t.xceaud007, #自定義欄位(文字)007
#          xceaud008 LIKE xcea_t.xceaud008, #自定義欄位(文字)008
#          xceaud009 LIKE xcea_t.xceaud009, #自定義欄位(文字)009
#          xceaud010 LIKE xcea_t.xceaud010, #自定義欄位(文字)010
#          xceaud011 LIKE xcea_t.xceaud011, #自定義欄位(數字)011
#          xceaud012 LIKE xcea_t.xceaud012, #自定義欄位(數字)012
#          xceaud013 LIKE xcea_t.xceaud013, #自定義欄位(數字)013
#          xceaud014 LIKE xcea_t.xceaud014, #自定義欄位(數字)014
#          xceaud015 LIKE xcea_t.xceaud015, #自定義欄位(數字)015
#          xceaud016 LIKE xcea_t.xceaud016, #自定義欄位(數字)016
#          xceaud017 LIKE xcea_t.xceaud017, #自定義欄位(數字)017
#          xceaud018 LIKE xcea_t.xceaud018, #自定義欄位(數字)018
#          xceaud019 LIKE xcea_t.xceaud019, #自定義欄位(數字)019
#          xceaud020 LIKE xcea_t.xceaud020, #自定義欄位(數字)020
#          xceaud021 LIKE xcea_t.xceaud021, #自定義欄位(日期時間)021
#          xceaud022 LIKE xcea_t.xceaud022, #自定義欄位(日期時間)022
#          xceaud023 LIKE xcea_t.xceaud023, #自定義欄位(日期時間)023
#          xceaud024 LIKE xcea_t.xceaud024, #自定義欄位(日期時間)024
#          xceaud025 LIKE xcea_t.xceaud025, #自定義欄位(日期時間)025
#          xceaud026 LIKE xcea_t.xceaud026, #自定義欄位(日期時間)026
#          xceaud027 LIKE xcea_t.xceaud027, #自定義欄位(日期時間)027
#          xceaud028 LIKE xcea_t.xceaud028, #自定義欄位(日期時間)028
#          xceaud029 LIKE xcea_t.xceaud029, #自定義欄位(日期時間)029
#          xceaud030 LIKE xcea_t.xceaud030, #自定義欄位(日期時間)030
#          #161109-00085#63 --e add
#          xceasite LIKE xcea_t.xceasite  #營運據點
#             END RECORD
##161109-00085#19-e mod
##161109-00085#19-s mod
##DEFINE l_xceb          RECORD LIKE xceb_t.*   #161109-00085#19-s mark
#DEFINE l_xceb          RECORD  #成本憑證第一單身檔
#       xcebent LIKE xceb_t.xcebent, #企業編號
#       xcebcomp LIKE xceb_t.xcebcomp, #法人組織
#       xcebld LIKE xceb_t.xcebld, #帳套
#       xcebdocno LIKE xceb_t.xcebdocno, #單據編號
#       xcebseq LIKE xceb_t.xcebseq, #項次
#       xceb001 LIKE xceb_t.xceb001, #參考單據編號
#       xceb002 LIKE xceb_t.xceb002, #參考單據項次
#       xceb003 LIKE xceb_t.xceb003, #單據類型
#       xceb004 LIKE xceb_t.xceb004, #料件編號
#       xceb005 LIKE xceb_t.xceb005, #特性
#       xceb101 LIKE xceb_t.xceb101, #科目編號
#       xceb102 LIKE xceb_t.xceb102, #摘要
#       xceb103 LIKE xceb_t.xceb103, #成本域
#       xceb110 LIKE xceb_t.xceb110, #原因碼
#       xceb111 LIKE xceb_t.xceb111, #收付款客商
#       xceb112 LIKE xceb_t.xceb112, #客群
#       xceb113 LIKE xceb_t.xceb113, #區域
#       xceb114 LIKE xceb_t.xceb114, #成本中心
#       xceb115 LIKE xceb_t.xceb115, #經營類別
#       xceb116 LIKE xceb_t.xceb116, #通路
#       xceb117 LIKE xceb_t.xceb117, #品類
#       xceb118 LIKE xceb_t.xceb118, #品牌
#       xceb119 LIKE xceb_t.xceb119, #專案號
#       xceb120 LIKE xceb_t.xceb120, #WBS
#       xceb201 LIKE xceb_t.xceb201, #數量
#       xceb202 LIKE xceb_t.xceb202, #成本金額(本位幣一)
#       xceb202a LIKE xceb_t.xceb202a, #成本-材料(本位幣一)
#       xceb202b LIKE xceb_t.xceb202b, #成本-人工(本位幣一)
#       xceb202c LIKE xceb_t.xceb202c, #成本-加工(本位幣一)
#       xceb202d LIKE xceb_t.xceb202d, #成本-制費一(本位幣一)
#       xceb202e LIKE xceb_t.xceb202e, #成本-制費二(本位幣一)
#       xceb202f LIKE xceb_t.xceb202f, #成本-制費三(本位幣一)
#       xceb202g LIKE xceb_t.xceb202g, #成本-制費四(本位幣一)
#       xceb202h LIKE xceb_t.xceb202h, #成本-制費五(本位幣一)
#       xceb212 LIKE xceb_t.xceb212, #成本金額(本位幣二)
#       xceb212a LIKE xceb_t.xceb212a, #成本-材料(本位幣二)
#       xceb212b LIKE xceb_t.xceb212b, #成本-人工(本位幣二)
#       xceb212c LIKE xceb_t.xceb212c, #成本-加工(本位幣二)
#       xceb212d LIKE xceb_t.xceb212d, #成本-制費一(本位幣二)
#       xceb212e LIKE xceb_t.xceb212e, #成本-制費二(本位幣二)
#       xceb212f LIKE xceb_t.xceb212f, #成本-制費三(本位幣二)
#       xceb212g LIKE xceb_t.xceb212g, #成本-制費四(本位幣二)
#       xceb212h LIKE xceb_t.xceb212h, #成本-制費五(本位幣二)
#       xceb222 LIKE xceb_t.xceb222, #成本金額(本位幣三)
#       xceb222a LIKE xceb_t.xceb222a, #成本-材料(本位幣三)
#       xceb222b LIKE xceb_t.xceb222b, #成本-人工(本位幣三)
#       xceb222c LIKE xceb_t.xceb222c, #成本-加工(本位幣三)
#       xceb222d LIKE xceb_t.xceb222d, #成本-制費一(本位幣三)
#       xceb222e LIKE xceb_t.xceb222e, #成本-制費二(本位幣三)
#       xceb222f LIKE xceb_t.xceb222f, #成本-制費三(本位幣三)
#       xceb222g LIKE xceb_t.xceb222g, #成本-制費四(本位幣三)
#       xceb222h LIKE xceb_t.xceb222h, #成本-制費五(本位幣三)
#       xceb301 LIKE xceb_t.xceb301, #憑證編號
#       xceb302 LIKE xceb_t.xceb302, #憑證項次
#       #161109-00085#63 --s add  
#       xcebud001 LIKE xceb_t.xcebud001, #自定義欄位(文字)001
#       xcebud002 LIKE xceb_t.xcebud002, #自定義欄位(文字)002
#       xcebud003 LIKE xceb_t.xcebud003, #自定義欄位(文字)003
#       xcebud004 LIKE xceb_t.xcebud004, #自定義欄位(文字)004
#       xcebud005 LIKE xceb_t.xcebud005, #自定義欄位(文字)005
#       xcebud006 LIKE xceb_t.xcebud006, #自定義欄位(文字)006
#       xcebud007 LIKE xceb_t.xcebud007, #自定義欄位(文字)007
#       xcebud008 LIKE xceb_t.xcebud008, #自定義欄位(文字)008
#       xcebud009 LIKE xceb_t.xcebud009, #自定義欄位(文字)009
#       xcebud010 LIKE xceb_t.xcebud010, #自定義欄位(文字)010
#       xcebud011 LIKE xceb_t.xcebud011, #自定義欄位(數字)011
#       xcebud012 LIKE xceb_t.xcebud012, #自定義欄位(數字)012
#       xcebud013 LIKE xceb_t.xcebud013, #自定義欄位(數字)013
#       xcebud014 LIKE xceb_t.xcebud014, #自定義欄位(數字)014
#       xcebud015 LIKE xceb_t.xcebud015, #自定義欄位(數字)015
#       xcebud016 LIKE xceb_t.xcebud016, #自定義欄位(數字)016
#       xcebud017 LIKE xceb_t.xcebud017, #自定義欄位(數字)017
#       xcebud018 LIKE xceb_t.xcebud018, #自定義欄位(數字)018
#       xcebud019 LIKE xceb_t.xcebud019, #自定義欄位(數字)019
#       xcebud020 LIKE xceb_t.xcebud020, #自定義欄位(數字)020
#       xcebud021 LIKE xceb_t.xcebud021, #自定義欄位(日期時間)021
#       xcebud022 LIKE xceb_t.xcebud022, #自定義欄位(日期時間)022
#       xcebud023 LIKE xceb_t.xcebud023, #自定義欄位(日期時間)023
#       xcebud024 LIKE xceb_t.xcebud024, #自定義欄位(日期時間)024
#       xcebud025 LIKE xceb_t.xcebud025, #自定義欄位(日期時間)025
#       xcebud026 LIKE xceb_t.xcebud026, #自定義欄位(日期時間)026
#       xcebud027 LIKE xceb_t.xcebud027, #自定義欄位(日期時間)027
#       xcebud028 LIKE xceb_t.xcebud028, #自定義欄位(日期時間)028
#       xcebud029 LIKE xceb_t.xcebud029, #自定義欄位(日期時間)029
#       xcebud030 LIKE xceb_t.xcebud030, #自定義欄位(日期時間)030
#       #161109-00085#63 --e add
#       xceb107 LIKE xceb_t.xceb107, #人員
#       xceb108 LIKE xceb_t.xceb108, #部門
#       xceb109 LIKE xceb_t.xceb109, #帳款對象
#       xceb121 LIKE xceb_t.xceb121, #自由核算項1
#       xceb122 LIKE xceb_t.xceb122, #自由核算項2
#       xceb123 LIKE xceb_t.xceb123, #自由核算項3
#       xceb124 LIKE xceb_t.xceb124, #自由核算項4
#       xceb125 LIKE xceb_t.xceb125, #自由核算項5
#       xceb126 LIKE xceb_t.xceb126, #自由核算項6
#       xceb127 LIKE xceb_t.xceb127, #自由核算項7
#       xceb128 LIKE xceb_t.xceb128, #自由核算項8
#       xceb129 LIKE xceb_t.xceb129, #自由核算項9
#       xceb130 LIKE xceb_t.xceb130, #自由核算項10
#       xceb131 LIKE xceb_t.xceb131, #單據類型(for 流通)
#       xceb132 LIKE xceb_t.xceb132  #單據日期(for 流通)
#          END RECORD
##161109-00085#19-e mod
##161109-00085#19-s mod
##DEFINE l_xcec          RECORD LIKE xcec_t.*   #161109-00085#18-s mark
#DEFINE l_xcec          RECORD  #成本憑證第二單身檔
#       xcecent LIKE xcec_t.xcecent, #企業編號
#       xceccomp LIKE xcec_t.xceccomp, #法人組織
#       xcecld LIKE xcec_t.xcecld, #帳套
#       xcecdocno LIKE xcec_t.xcecdocno, #單據編號
#       xcecseq LIKE xcec_t.xcecseq, #項次
#       xcec001 LIKE xcec_t.xcec001, #參考單據
#       xcec002 LIKE xcec_t.xcec002, #參考單據項次
#       xcec003 LIKE xcec_t.xcec003, #單據類型
#       xcec004 LIKE xcec_t.xcec004, #料件編號
#       xcec005 LIKE xcec_t.xcec005, #特性
#       xcec101 LIKE xcec_t.xcec101, #科目編號
#       xcec102 LIKE xcec_t.xcec102, #摘要
#       xcec103 LIKE xcec_t.xcec103, #成本域
#       xcec110 LIKE xcec_t.xcec110, #原因碼
#       xcec111 LIKE xcec_t.xcec111, #收付款客商
#       xcec112 LIKE xcec_t.xcec112, #客群
#       xcec113 LIKE xcec_t.xcec113, #區域
#       xcec114 LIKE xcec_t.xcec114, #成本中心
#       xcec115 LIKE xcec_t.xcec115, #經營類別
#       xcec116 LIKE xcec_t.xcec116, #通路
#       xcec117 LIKE xcec_t.xcec117, #品類
#       xcec118 LIKE xcec_t.xcec118, #品牌
#       xcec119 LIKE xcec_t.xcec119, #專案號
#       xcec120 LIKE xcec_t.xcec120, #WBS
#       xcec201 LIKE xcec_t.xcec201, #數量
#       xcec202 LIKE xcec_t.xcec202, #成本金額(本位幣一)
#       xcec202a LIKE xcec_t.xcec202a, #成本-材料(本位幣一)
#       xcec202b LIKE xcec_t.xcec202b, #成本-人工(本位幣一)
#       xcec202c LIKE xcec_t.xcec202c, #成本-加工(本位幣一)
#       xcec202d LIKE xcec_t.xcec202d, #成本-制費一(本位幣一)
#       xcec202e LIKE xcec_t.xcec202e, #成本-制費二(本位幣一)
#       xcec202f LIKE xcec_t.xcec202f, #成本-制費三(本位幣一)
#       xcec202g LIKE xcec_t.xcec202g, #成本-制費四(本位幣一)
#       xcec202h LIKE xcec_t.xcec202h, #成本-制費五(本位幣一)
#       xcec212 LIKE xcec_t.xcec212, #成本-金額(本位幣二)
#       xcec212a LIKE xcec_t.xcec212a, #成本-材料(本位幣二)
#       xcec212b LIKE xcec_t.xcec212b, #成本-人工(本位幣二)
#       xcec212c LIKE xcec_t.xcec212c, #成本-加工(本位幣二)
#       xcec212d LIKE xcec_t.xcec212d, #成本-制費一(本位幣二)
#       xcec212e LIKE xcec_t.xcec212e, #成本-制費二(本位幣二)
#       xcec212f LIKE xcec_t.xcec212f, #成本-制費三(本位幣二)
#       xcec212g LIKE xcec_t.xcec212g, #成本-制費四(本位幣二)
#       xcec212h LIKE xcec_t.xcec212h, #成本-制費五(本位幣二)
#       xcec222 LIKE xcec_t.xcec222, #成本-金額(本位幣三)
#       xcec222a LIKE xcec_t.xcec222a, #成本-材料(本位幣三)
#       xcec222b LIKE xcec_t.xcec222b, #成本-人工(本位幣三)
#       xcec222c LIKE xcec_t.xcec222c, #成本-加工(本位幣三)
#       xcec222d LIKE xcec_t.xcec222d, #成本-制費一(本位幣三)
#       xcec222e LIKE xcec_t.xcec222e, #成本-制費二(本位幣三)
#       xcec222f LIKE xcec_t.xcec222f, #成本-制費三(本位幣三)
#       xcec222g LIKE xcec_t.xcec222g, #成本-制費四(本位幣三)
#       xcec222h LIKE xcec_t.xcec222h, #成本-制費五(本位幣三)
#       xcec301 LIKE xcec_t.xcec301, #憑證編號
#       xcec302 LIKE xcec_t.xcec302, #憑證項次
#       #161109-00085#63 --s add 
#       xcecud001 LIKE xcec_t.xcecud001, #自定義欄位(文字)001
#       xcecud002 LIKE xcec_t.xcecud002, #自定義欄位(文字)002
#       xcecud003 LIKE xcec_t.xcecud003, #自定義欄位(文字)003
#       xcecud004 LIKE xcec_t.xcecud004, #自定義欄位(文字)004
#       xcecud005 LIKE xcec_t.xcecud005, #自定義欄位(文字)005
#       xcecud006 LIKE xcec_t.xcecud006, #自定義欄位(文字)006
#       xcecud007 LIKE xcec_t.xcecud007, #自定義欄位(文字)007
#       xcecud008 LIKE xcec_t.xcecud008, #自定義欄位(文字)008
#       xcecud009 LIKE xcec_t.xcecud009, #自定義欄位(文字)009
#       xcecud010 LIKE xcec_t.xcecud010, #自定義欄位(文字)010
#       xcecud011 LIKE xcec_t.xcecud011, #自定義欄位(數字)011
#       xcecud012 LIKE xcec_t.xcecud012, #自定義欄位(數字)012
#       xcecud013 LIKE xcec_t.xcecud013, #自定義欄位(數字)013
#       xcecud014 LIKE xcec_t.xcecud014, #自定義欄位(數字)014
#       xcecud015 LIKE xcec_t.xcecud015, #自定義欄位(數字)015
#       xcecud016 LIKE xcec_t.xcecud016, #自定義欄位(數字)016
#       xcecud017 LIKE xcec_t.xcecud017, #自定義欄位(數字)017
#       xcecud018 LIKE xcec_t.xcecud018, #自定義欄位(數字)018
#       xcecud019 LIKE xcec_t.xcecud019, #自定義欄位(數字)019
#       xcecud020 LIKE xcec_t.xcecud020, #自定義欄位(數字)020
#       xcecud021 LIKE xcec_t.xcecud021, #自定義欄位(日期時間)021
#       xcecud022 LIKE xcec_t.xcecud022, #自定義欄位(日期時間)022
#       xcecud023 LIKE xcec_t.xcecud023, #自定義欄位(日期時間)023
#       xcecud024 LIKE xcec_t.xcecud024, #自定義欄位(日期時間)024
#       xcecud025 LIKE xcec_t.xcecud025, #自定義欄位(日期時間)025
#       xcecud026 LIKE xcec_t.xcecud026, #自定義欄位(日期時間)026
#       xcecud027 LIKE xcec_t.xcecud027, #自定義欄位(日期時間)027
#       xcecud028 LIKE xcec_t.xcecud028, #自定義欄位(日期時間)028
#       xcecud029 LIKE xcec_t.xcecud029, #自定義欄位(日期時間)029
#       xcecud030 LIKE xcec_t.xcecud030, #自定義欄位(日期時間)030
#       #161109-00085#63 --e add
#       xcec107 LIKE xcec_t.xcec107, #人員
#       xcec108 LIKE xcec_t.xcec108, #部門
#       xcec109 LIKE xcec_t.xcec109, #帳款對象
#       xcec121 LIKE xcec_t.xcec121, #自由核算項1
#       xcec122 LIKE xcec_t.xcec122, #自由核算項2
#       xcec123 LIKE xcec_t.xcec123, #自由核算項3
#       xcec124 LIKE xcec_t.xcec124, #自由核算項4
#       xcec125 LIKE xcec_t.xcec125, #自由核算項5
#       xcec126 LIKE xcec_t.xcec126, #自由核算項6
#       xcec127 LIKE xcec_t.xcec127, #自由核算項7
#       xcec128 LIKE xcec_t.xcec128, #自由核算項8
#       xcec129 LIKE xcec_t.xcec129, #自由核算項9
#       xcec130 LIKE xcec_t.xcec130  #自由核算項10
#               END RECORD
##161109-00085#19-e mod
##161109-00085#19-s mod
##DEFINE l_xcck          RECORD LIKE xcck_t.*   #161109-00085#19-s mark
#DEFINE l_xcck          RECORD  #本期料件明細進出成本檔
#       xcckent LIKE xcck_t.xcckent, #企業編號
#       xccksite LIKE xcck_t.xccksite, #site組織
#       xcckcomp LIKE xcck_t.xcckcomp, #法人組織
#       xcckld LIKE xcck_t.xcckld, #帳套
#       xcck001 LIKE xcck_t.xcck001, #帳套本位幣順序
#       xcck002 LIKE xcck_t.xcck002, #成本域
#       xcck003 LIKE xcck_t.xcck003, #成本計算類型
#       xcck004 LIKE xcck_t.xcck004, #年度
#       xcck005 LIKE xcck_t.xcck005, #期別
#       xcck006 LIKE xcck_t.xcck006, #參考單號
#       xcck007 LIKE xcck_t.xcck007, #項次
#       xcck008 LIKE xcck_t.xcck008, #項序
#       xcck009 LIKE xcck_t.xcck009, #出入庫碼
#       xcck010 LIKE xcck_t.xcck010, #料號
#       xcck011 LIKE xcck_t.xcck011, #產品特徵
#       xcck012 LIKE xcck_t.xcck012, #單據類型
#       xcck013 LIKE xcck_t.xcck013, #單據日期
#       xcck014 LIKE xcck_t.xcck014, #時間
#       xcck015 LIKE xcck_t.xcck015, #倉庫編號
#       xcck016 LIKE xcck_t.xcck016, #儲位編號
#       xcck017 LIKE xcck_t.xcck017, #批號
#       xcck020 LIKE xcck_t.xcck020, #異動類型
#       xcck021 LIKE xcck_t.xcck021, #原因碼
#       xcck022 LIKE xcck_t.xcck022, #交易對象
#       xcck023 LIKE xcck_t.xcck023, #客群
#       xcck024 LIKE xcck_t.xcck024, #區域
#       xcck025 LIKE xcck_t.xcck025, #成本中心
#       xcck026 LIKE xcck_t.xcck026, #經營類別
#       xcck027 LIKE xcck_t.xcck027, #通路
#       xcck028 LIKE xcck_t.xcck028, #品類
#       xcck029 LIKE xcck_t.xcck029, #品牌
#       xcck030 LIKE xcck_t.xcck030, #專案號
#       xcck031 LIKE xcck_t.xcck031, #WBS
#       xcck032 LIKE xcck_t.xcck032, #存貨科目
#       xcck033 LIKE xcck_t.xcck033, #費用成本科目
#       xcck034 LIKE xcck_t.xcck034, #收入科目
#       xcck040 LIKE xcck_t.xcck040, #交易幣別
#       xcck041 LIKE xcck_t.xcck041, #本位幣別
#       xcck042 LIKE xcck_t.xcck042, #匯率
#       xcck043 LIKE xcck_t.xcck043, #交易單位
#       xcck044 LIKE xcck_t.xcck044, #成本單位
#       xcck045 LIKE xcck_t.xcck045, #換算率
#       xcck046 LIKE xcck_t.xcck046, #交易數量
#       xcck047 LIKE xcck_t.xcck047, #工單號碼
#       xcck048 LIKE xcck_t.xcck048, #重複性生產-計畫編號
#       xcck049 LIKE xcck_t.xcck049, #重複性生產-生產料號
#       xcck050 LIKE xcck_t.xcck050, #重複性生產-生產料號BOM特性
#       xcck051 LIKE xcck_t.xcck051, #重複性生產-生產料號產品特徵
#       xcck055 LIKE xcck_t.xcck055, #xccc類型
#       xcck201 LIKE xcck_t.xcck201, #本期異動數量
#       xcck202 LIKE xcck_t.xcck202, #本期異動金額
#       xcck202a LIKE xcck_t.xcck202a, #本期異動金額-材料
#       xcck202b LIKE xcck_t.xcck202b, #本期異動金額-人工
#       xcck202c LIKE xcck_t.xcck202c, #本期異動金額-加工費
#       xcck202d LIKE xcck_t.xcck202d, #本期異動金額-製費一
#       xcck202e LIKE xcck_t.xcck202e, #本期異動金額-製費二
#       xcck202f LIKE xcck_t.xcck202f, #本期異動金額-製費三
#       xcck202g LIKE xcck_t.xcck202g, #本期異動金額-製費四
#       xcck202h LIKE xcck_t.xcck202h, #本期異動金額-製費五
#       xcck282 LIKE xcck_t.xcck282, #本期異動單價
#       xcck282a LIKE xcck_t.xcck282a, #本期異動單價-材料
#       xcck282b LIKE xcck_t.xcck282b, #本期異動單價-人工
#       xcck282c LIKE xcck_t.xcck282c, #本期異動單價-加工
#       xcck282d LIKE xcck_t.xcck282d, #本期異動單價-製費一
#       xcck282e LIKE xcck_t.xcck282e, #本期異動單價-製費二
#       xcck282f LIKE xcck_t.xcck282f, #本期異動單價-製費三
#       xcck282g LIKE xcck_t.xcck282g, #本期異動單價-製費四
#       xcck282h LIKE xcck_t.xcck282h, #本期異動單價-製費五
#       xcck301 LIKE xcck_t.xcck301, #已耗數量
#       xcck302 LIKE xcck_t.xcck302, #已耗金額
#       xcck302a LIKE xcck_t.xcck302a, #已耗金額-材料
#       xcck302b LIKE xcck_t.xcck302b, #已耗金額-人工
#       xcck302c LIKE xcck_t.xcck302c, #已耗金額-加工費
#       xcck302d LIKE xcck_t.xcck302d, #已耗金額-製費一
#       xcck302e LIKE xcck_t.xcck302e, #已耗金額-製費二
#       xcck302f LIKE xcck_t.xcck302f, #已耗金額-製費三
#       xcck302g LIKE xcck_t.xcck302g, #已耗金額-製費四
#       xcck302h LIKE xcck_t.xcck302h, #已耗金額-製費五
#       xcck901 LIKE xcck_t.xcck901, #結存數量
#       xcck902 LIKE xcck_t.xcck902, #結存金額
#       xcck902a LIKE xcck_t.xcck902a, #結存金額-材料
#       xcck902b LIKE xcck_t.xcck902b, #結存金額-人工
#       xcck902c LIKE xcck_t.xcck902c, #結存金額-加工費
#       xcck902d LIKE xcck_t.xcck902d, #結存金額-製費一
#       xcck902e LIKE xcck_t.xcck902e, #結存金額-製費二
#       xcck902f LIKE xcck_t.xcck902f, #結存金額-製費三
#       xcck902g LIKE xcck_t.xcck902g, #結存金額-製費四
#       xcck902h LIKE xcck_t.xcck902h, #結存金額-製費五
#       xcck980 LIKE xcck_t.xcck980, #結存單位成本
#       xcck980a LIKE xcck_t.xcck980a, #結存單位成本-材料
#       xcck980b LIKE xcck_t.xcck980b, #結存單位成本-人工
#       xcck980c LIKE xcck_t.xcck980c, #結存單位成本-加工費
#       xcck980d LIKE xcck_t.xcck980d, #結存單位成本-製費一
#       xcck980e LIKE xcck_t.xcck980e, #結存單位成本-製費二
#       xcck980f LIKE xcck_t.xcck980f, #結存單位成本-製費三
#       xcck980g LIKE xcck_t.xcck980g, #結存單位成本-製費四
#       xcck980h LIKE xcck_t.xcck980h, #結存單位成本-製費五
#       xcck903 LIKE xcck_t.xcck903, #結存調整金額
#       xcck903a LIKE xcck_t.xcck903a, #結存調整金額-材料
#       xcck903b LIKE xcck_t.xcck903b, #結存調整金額-人工
#       xcck903c LIKE xcck_t.xcck903c, #結存調整金額-加工費
#       xcck903d LIKE xcck_t.xcck903d, #結存調整金額-製費一
#       xcck903e LIKE xcck_t.xcck903e, #結存調整金額-製費二
#       xcck903f LIKE xcck_t.xcck903f, #結存調整金額-製費三
#       xcck903g LIKE xcck_t.xcck903g, #結存調整金額-製費四
#       xcck903h LIKE xcck_t.xcck903h, #結存調整金額-製費五
#       xcckownid LIKE xcck_t.xcckownid, #資料所有者
#       xcckowndp LIKE xcck_t.xcckowndp, #資料所屬部門
#       xcckcrtid LIKE xcck_t.xcckcrtid, #資料建立者
#       xcckcrtdp LIKE xcck_t.xcckcrtdp, #資料建立部門
#       xcckcrtdt LIKE xcck_t.xcckcrtdt, #資料創建日
#       xcckmodid LIKE xcck_t.xcckmodid, #資料修改者
#       xcckmoddt LIKE xcck_t.xcckmoddt, #最近修改日
#       xcckstus LIKE xcck_t.xcckstus, #狀態碼
#       #161109-00085#63 --s add      
#       xcckud001 LIKE xcck_t.xcckud001, #自定義欄位(文字)001
#       xcckud002 LIKE xcck_t.xcckud002, #自定義欄位(文字)002
#       xcckud003 LIKE xcck_t.xcckud003, #自定義欄位(文字)003
#       xcckud004 LIKE xcck_t.xcckud004, #自定義欄位(文字)004
#       xcckud005 LIKE xcck_t.xcckud005, #自定義欄位(文字)005
#       xcckud006 LIKE xcck_t.xcckud006, #自定義欄位(文字)006
#       xcckud007 LIKE xcck_t.xcckud007, #自定義欄位(文字)007
#       xcckud008 LIKE xcck_t.xcckud008, #自定義欄位(文字)008
#       xcckud009 LIKE xcck_t.xcckud009, #自定義欄位(文字)009
#       xcckud010 LIKE xcck_t.xcckud010, #自定義欄位(文字)010
#       xcckud011 LIKE xcck_t.xcckud011, #自定義欄位(數字)011
#       xcckud012 LIKE xcck_t.xcckud012, #自定義欄位(數字)012
#       xcckud013 LIKE xcck_t.xcckud013, #自定義欄位(數字)013
#       xcckud014 LIKE xcck_t.xcckud014, #自定義欄位(數字)014
#       xcckud015 LIKE xcck_t.xcckud015, #自定義欄位(數字)015
#       xcckud016 LIKE xcck_t.xcckud016, #自定義欄位(數字)016
#       xcckud017 LIKE xcck_t.xcckud017, #自定義欄位(數字)017
#       xcckud018 LIKE xcck_t.xcckud018, #自定義欄位(數字)018
#       xcckud019 LIKE xcck_t.xcckud019, #自定義欄位(數字)019
#       xcckud020 LIKE xcck_t.xcckud020, #自定義欄位(數字)020
#       xcckud021 LIKE xcck_t.xcckud021, #自定義欄位(日期時間)021
#       xcckud022 LIKE xcck_t.xcckud022, #自定義欄位(日期時間)022
#       xcckud023 LIKE xcck_t.xcckud023, #自定義欄位(日期時間)023
#       xcckud024 LIKE xcck_t.xcckud024, #自定義欄位(日期時間)024
#       xcckud025 LIKE xcck_t.xcckud025, #自定義欄位(日期時間)025
#       xcckud026 LIKE xcck_t.xcckud026, #自定義欄位(日期時間)026
#       xcckud027 LIKE xcck_t.xcckud027, #自定義欄位(日期時間)027
#       xcckud028 LIKE xcck_t.xcckud028, #自定義欄位(日期時間)028
#       xcckud029 LIKE xcck_t.xcckud029, #自定義欄位(日期時間)029
#       xcckud030 LIKE xcck_t.xcckud030, #自定義欄位(日期時間)030
#       #161109-00085#63 --e add
#       xcck056 LIKE xcck_t.xcck056  #成本代銷單號
#          END RECORD
##161109-00085#19-e mod
#DEFINE l_sql           STRING
#DEFINE l_sql1          STRING
#DEFINE l_rate          LIKE type_t.num26_10
#DEFINE l_rate1         LIKE type_t.num26_10
#DEFINE ld_date         DATETIME YEAR TO SECOND
#
#   LET g_success = 'Y'
#   LET l_xcea.xceaownid = g_user
#   LET l_xcea.xceaowndp = g_dept
#   LET l_xcea.xceacrtid = g_user
#   LET l_xcea.xceacrtdp = g_dept 
#   LET ld_date = cl_get_current()
#   LET l_xcea.xceamodid = ""
#   LET l_xcea.xceamoddt = ""
#   CALL s_aooi200_fin_gen_docno(g_xcea_m.xceald,'','',g_xcea_m.xceadocno,g_xcea_m.xcea001,g_prog_name1)      #wujie 150214
#    RETURNING l_success,g_xcea_m.xceadocno
#   IF l_success  = 0  THEN
#      INITIALIZE g_errparam TO NULL
#      LET g_errparam.code = 'apm-00003'
#      LET g_errparam.extend = g_xcea_m.xceadocno
#      LET g_errparam.popup = TRUE
#      CALL cl_err()
#
#      LET g_success = 'N'
#      RETURN g_success
#   END IF
#   
#   INSERT INTO xcea_t (xceaent,xceald,xceacomp,xcea006,xceadocno,xcea001,xcea002,xcea004, 
#       xcea005,xcea003,xceastus,xceaownid,xceaowndp,xceacrtid,xceacrtdp,xceacrtdt, 
#       xceamodid,xceamoddt)
#   VALUES (g_enterprise,g_xcea_m.xceald,g_xcea_m.xceacomp,g_xcea_m.xcea006,g_xcea_m.xceadocno, 
#       g_xcea_m.xcea001,g_xcea002,g_xcea_m.xcea004,g_xcea_m.xcea005,g_xcea_m.xcea003, 
#       'N',l_xcea.xceaownid,l_xcea.xceaowndp,l_xcea.xceacrtid, 
#       l_xcea.xceacrtdp,ld_date,l_xcea.xceamodid,l_xcea.xceamoddt) 
#       
#   IF SQLCA.sqlcode THEN
#      INITIALIZE g_errparam TO NULL
#      LET g_errparam.code = SQLCA.sqlcode
#      LET g_errparam.extend = "g_xcea_m"
#      LET g_errparam.popup = TRUE
#      CALL cl_err()
#  
#      LET g_success = 'N'
#      RETURN g_success
#   END IF
#   
#   LET l_sql = " SELECT SUM(xcck009*xcck202), ",
#               "        SUM(xcck009*xcck202a),SUM(xcck009*xcck202b),SUM(xcck009*xcck202c),SUM(xcck009*xcck202d),",
#               "        SUM(xcck009*xcck202e),SUM(xcck009*xcck202f),SUM(xcck009*xcck202g),SUM(xcck009*xcck202h) ",
#               "        FROM xcck_t ", 
#               "  WHERE xcckent = '",g_enterprise,"' AND xcckld = '",g_xcea_m.xceald,"'",
#               "    AND xcck003 = '",g_xcea_m.xcea003,"' AND xcck004 = ",g_xcea_m.xcea004,
#               "    AND xcck005 = ",g_xcea_m.xcea005,
#               "    AND xcck055 = '311' ",
#               "    AND xcck002 = ? AND xcck008 = ? AND xcck006 = ? ",
#               "    AND xcck010 = ? AND xcck011 = ? AND xcck012 = ? AND xcck007 = ?"
#  
#   LET g_sql1 = l_sql CLIPPED," AND xcck001 = '2' " 
#
#   DECLARE xcae_prep5 CURSOR FROM g_sql1
#   
#   LET g_sql2 = l_sql CLIPPED," AND xcck001 = '3' " 
#
#   DECLARE xcae_prep6 CURSOR FROM g_sql2
#   
#   LET l_sql = " SELECT xcck002,xcck008,xcck006,xcck010,xcck011,xcck012,xcck007,SUM(xcck009*xcck201),SUM(xcck009*xcck202), ",
#               "        SUM(xcck009*xcck202a),SUM(xcck009*xcck202b),SUM(xcck009*xcck202c),SUM(xcck009*xcck202d),",
#               "        SUM(xcck009*xcck202e),SUM(xcck009*xcck202f),SUM(xcck009*xcck202g),SUM(xcck009*xcck202h) ",
#               "        FROM xcck_t ", 
#               "  WHERE xcckent = '",g_enterprise,"' AND xcckld = '",g_xcea_m.xceald,"'",
#               "    AND xcck003 = '",g_xcea_m.xcea003,"' AND xcck004 = ",g_xcea_m.xcea004,
#               "    AND xcck055 = '311' ",
#               "    AND xcck005 = ",g_xcea_m.xcea005
#   LET l_sql1 = l_sql CLIPPED," AND xcck001 = '1' ",
#                " GROUP BY xcck002,xcck008,xcck006,xcck010,xcck011,xcck012,xcck007",
#                " ORDER BY xcck002,xcck008,xcck006,xcck010,xcck011,xcck012,xcck007"
#   PREPARE xcae_prep4 FROM l_sql1
#   DECLARE xcae_curs4 CURSOR FOR xcae_prep4
#   
#
#   FOREACH xcae_curs4 INTO  l_xcck.xcck002,l_xcck.xcck008,l_xcck.xcck006,l_xcck.xcck010,l_xcck.xcck011,
#                            l_xcck.xcck012,l_xcck.xcck007,
#                            l_xcck.xcck201,l_xcck.xcck202,l_xcck.xcck202a,l_xcck.xcck202b,l_xcck.xcck202c,
#                            l_xcck.xcck202d,l_xcck.xcck202e,l_xcck.xcck202f,l_xcck.xcck202g,l_xcck.xcck202h    
#      
#     #SELECT glcc002 INTO l_xceb.xceb101 FROM glcc_t 
#     # WHERE glccent = g_enterprise AND glccld = g_xcea_m.xceald AND glcc001 = '1'
#      IF g_glaa015 ='Y' THEN
#         OPEN xcae_prep5 USING  l_xcck.xcck002,l_xcck.xcck008,l_xcck.xcck006,l_xcck.xcck010,l_xcck.xcck011,
#                                l_xcck.xcck012,l_xcck.xcck007
#         FETCH xcae_prep5 INTO l_xceb.xceb212,l_xceb.xceb212a,l_xceb.xceb212b,l_xceb.xceb212c,l_xceb.xceb212d,
#                               l_xceb.xceb212e,l_xceb.xceb212f,l_xceb.xceb212g,l_xceb.xceb212h
#         #資料被他人LOCK, 或是sql執行時出現錯誤
#         IF SQLCA.sqlcode THEN
#            INITIALIZE g_errparam TO NULL
#            LET g_errparam.code = SQLCA.sqlcode
#            LET g_errparam.extend = g_xcea_m.xceald
#            LET g_errparam.popup = FALSE
#            CALL cl_err()
#         
#            CLOSE xcae_prep5
#            CALL s_transaction_end('N','0')
#            RETURN
#         END IF
#      ELSE
#         LET l_xceb.xceb212a = 0
#         LET l_xceb.xceb212b = 0
#         LET l_xceb.xceb212c = 0
#         LET l_xceb.xceb212d = 0
#         LET l_xceb.xceb212e = 0
#         LET l_xceb.xceb212f = 0
#         LET l_xceb.xceb212g = 0
#         LET l_xceb.xceb212h = 0
#         LET l_xceb.xceb212  = 0     
#      END IF
#      
#      IF g_glaa019 ='Y' THEN
#         OPEN xcae_prep6 USING  l_xcck.xcck002,l_xcck.xcck008,l_xcck.xcck006,l_xcck.xcck010,l_xcck.xcck011,
#                                l_xcck.xcck012,l_xcck.xcck007
#         FETCH xcae_prep6 INTO l_xceb.xceb222,l_xceb.xceb222a,l_xceb.xceb222b,l_xceb.xceb222c,l_xceb.xceb222d,
#                               l_xceb.xceb222e,l_xceb.xceb222f,l_xceb.xceb222g,l_xceb.xceb222h
#         #資料被他人LOCK, 或是sql執行時出現錯誤
#         IF SQLCA.sqlcode THEN
#            INITIALIZE g_errparam TO NULL
#            LET g_errparam.code = SQLCA.sqlcode
#            LET g_errparam.extend = g_xcea_m.xceald
#            LET g_errparam.popup = FALSE
#            CALL cl_err()
#         
#            CLOSE xcae_prep6
#            CALL s_transaction_end('N','0')
#            RETURN
#         END IF
#      ELSE
#         LET l_xceb.xceb222a = 0
#         LET l_xceb.xceb222b = 0
#         LET l_xceb.xceb222c = 0
#         LET l_xceb.xceb222d = 0
#         LET l_xceb.xceb222e = 0
#         LET l_xceb.xceb222f = 0
#         LET l_xceb.xceb222g = 0
#         LET l_xceb.xceb222h = 0
#         LET l_xceb.xceb222  = 0     
#      END IF
#
#      LET l_xceb.xcebent = g_enterprise
#      LET l_xceb.xcebld  = g_xcea_m.xceald
#      LET l_xceb.xcebdocno=g_xcea_m.xceadocno
#      LET l_xceb.xcebcomp=g_xcea_m.xceacomp
#      LET l_xceb.xceb001 = l_xcck.xcck006
#      LET l_xceb.xceb002 = l_xcck.xcck007
#      LET l_xceb.xceb003 = l_xcck.xcck012
#      LET l_xceb.xceb004 = l_xcck.xcck010
#      LET l_xceb.xceb005 = l_xcck.xcck011
#      LET l_xceb.xceb102 = ''
#      LET l_xceb.xceb103 = l_xcck.xcck002
#      LET l_xceb.xceb119 = l_xcck.xcck030
#      LET l_xceb.xceb201 = l_xcck.xcck201
#      LET l_xceb.xceb202 = l_xcck.xcck202
#      LET l_xceb.xceb202a = l_xcck.xcck202a
#      LET l_xceb.xceb202b = l_xcck.xcck202b
#      LET l_xceb.xceb202c = l_xcck.xcck202c
#      LET l_xceb.xceb202d = l_xcck.xcck202d
#      LET l_xceb.xceb202e = l_xcck.xcck202e
#      LET l_xceb.xceb202f = l_xcck.xcck202f
#      LET l_xceb.xceb202g = l_xcck.xcck202g
#      LET l_xceb.xceb202h = l_xcck.xcck202h
#       
#      SELECT imag011 INTO l_xceb.xceb117 FROM imag_t
#       WHERE imagent = g_enterprise AND imagsite = g_xcea_m.xceacomp
#         AND imag001 = l_xceb.xceb004 
#
#      SELECT MAX(xcebseq) INTO l_xceb.xcebseq FROM xceb_t
#       WHERE xcebent = g_enterprise AND xcebld = g_xcea_m.xceald
#         AND xcebdocno = g_xcea_m.xceadocno
#      IF cl_null(l_xceb.xcebseq) OR l_xceb.xcebseq = 0 THEN
#         LET l_xceb.xcebseq = 1
#      ELSE
#         LET l_xceb.xcebseq = l_xceb.xcebseq + 1
#      END IF      
#      
#      CALL s_get_item_acc(g_xcea_m.xceald,'1',l_xceb.xceb004,'','',g_xcea_m.xceacomp,'') 
#       RETURNING l_success,l_xceb.xceb101
# 
#
#      #人员
#      LET l_xceb.xceb107 = ' '
#      #部门
#      LET l_xceb.xceb108 = ' '
#      #账款对象
#      LET l_xceb.xceb109 = ' '
#      #自由核算项1～10  
#      LET l_xceb.xceb121 = ' '
#      LET l_xceb.xceb122 = ' '
#      LET l_xceb.xceb123 = ' '
#      LET l_xceb.xceb124 = ' '
#      LET l_xceb.xceb125 = ' '
#      LET l_xceb.xceb126 = ' '
#      LET l_xceb.xceb127 = ' '
#      LET l_xceb.xceb128 = ' '
#      LET l_xceb.xceb129 = ' '
#      LET l_xceb.xceb130 = ' '
#      #摘要
#      IF cl_null(l_xceb.xceb102) THEN
#         CALL axct701_01_get_summ(g_xcea_m.xceald,'61','8925','4') RETURNING l_success,l_xceb.xceb102
#      END IF
#      CALL axct701_01_default_space_xceb(l_xceb.*) RETURNING l_xceb.xceb005,
#                                                             l_xceb.xceb101,
#                                                             l_xceb.xceb102,
#                                                             l_xceb.xceb103,
#                                                             l_xceb.xceb110,
#                                                             l_xceb.xceb111,
#                                                             l_xceb.xceb112,
#                                                             l_xceb.xceb113,
#                                                             l_xceb.xceb114,
#                                                             l_xceb.xceb115,
#                                                             l_xceb.xceb116,
#                                                             l_xceb.xceb117,
#                                                             l_xceb.xceb118,
#                                                             l_xceb.xceb119,
#                                                             l_xceb.xceb120,
#                                                             l_xceb.xceb107,
#                                                             l_xceb.xceb108,
#                                                             l_xceb.xceb109,
#                                                             l_xceb.xceb121,
#                                                             l_xceb.xceb122,
#                                                             l_xceb.xceb123,
#                                                             l_xceb.xceb124,
#                                                             l_xceb.xceb125,
#                                                             l_xceb.xceb126,
#                                                             l_xceb.xceb127,
#                                                             l_xceb.xceb128,
#                                                             l_xceb.xceb129,
#                                                             l_xceb.xceb130
#
#
#     #161109-00085#20-s mod
##      INSERT INTO xceb_t VALUES(l_xceb.*)   #161109-00085#20-s mark
#      #161109-00085#63 --s mark
#      #INSERT INTO xceb_t(xcebent,xcebcomp,xcebld,xcebdocno,xcebseq,xceb001,xceb002,xceb003,xceb004,
#      #                   xceb005,xceb101,xceb102,xceb103,xceb110,xceb111,xceb112,xceb113,xceb114,xceb115,
#      #                   xceb116,xceb117,xceb118,xceb119,xceb120,xceb201,xceb202,xceb202a,xceb202b,xceb202c,
#      #                   xceb202d,xceb202e,xceb202f,xceb202g,xceb202h,xceb212,xceb212a,xceb212b,xceb212c,
#      #                   xceb212d,xceb212e,xceb212f,xceb212g,xceb212h,xceb222,xceb222a,xceb222b,xceb222c,
#      #                   xceb222d,xceb222e,xceb222f,xceb222g,xceb222h,xceb301,xceb302,xceb107,xceb108,xceb109,
#      #                   xceb121,xceb122,xceb123,xceb124,xceb125,xceb126,xceb127,xceb128,xceb129,xceb130,xceb131,xceb132) 
#      #            VALUES(l_xceb.xcebent,l_xceb.xcebcomp,l_xceb.xcebld,l_xceb.xcebdocno,l_xceb.xcebseq,
#      #                   l_xceb.xceb001,l_xceb.xceb002,l_xceb.xceb003,l_xceb.xceb004,l_xceb.xceb005,
#      #                   l_xceb.xceb101,l_xceb.xceb102,l_xceb.xceb103,l_xceb.xceb110,l_xceb.xceb111,
#      #                   l_xceb.xceb112,l_xceb.xceb113,l_xceb.xceb114,l_xceb.xceb115,l_xceb.xceb116,
#      #                   l_xceb.xceb117,l_xceb.xceb118,l_xceb.xceb119,l_xceb.xceb120,l_xceb.xceb201,
#      #                   l_xceb.xceb202,l_xceb.xceb202a,l_xceb.xceb202b,l_xceb.xceb202c,l_xceb.xceb202d,
#      #                   l_xceb.xceb202e,l_xceb.xceb202f,l_xceb.xceb202g,l_xceb.xceb202h,l_xceb.xceb212,
#      #                   l_xceb.xceb212a,l_xceb.xceb212b,l_xceb.xceb212c,l_xceb.xceb212d,l_xceb.xceb212e,
#      #                   l_xceb.xceb212f,l_xceb.xceb212g,l_xceb.xceb212h,l_xceb.xceb222,l_xceb.xceb222a,
#      #                   l_xceb.xceb222b,l_xceb.xceb222c,l_xceb.xceb222d,l_xceb.xceb222e,l_xceb.xceb222f,
#      #                   l_xceb.xceb222g,l_xceb.xceb222h,l_xceb.xceb301,l_xceb.xceb302,l_xceb.xceb107,
#      #                   l_xceb.xceb108,l_xceb.xceb109,l_xceb.xceb121,l_xceb.xceb122,l_xceb.xceb123,
#      #                   l_xceb.xceb124,l_xceb.xceb125,l_xceb.xceb126,l_xceb.xceb127,l_xceb.xceb128,
#      #                   l_xceb.xceb129,l_xceb.xceb130,l_xceb.xceb131,l_xceb.xceb132)
#      #161109-00085#20-e mod
#      #161109-00085#63 --e mark
#      #161109-00085#63 --s add
#      INSERT INTO xceb_t(xcebent,xcebcomp,xcebld,xcebdocno,xcebseq,
#                         xceb001,xceb002,xceb003,xceb004,xceb005,
#                         xceb101,xceb102,xceb103,xceb110,xceb111,
#                         xceb112,xceb113,xceb114,xceb115,xceb116,
#                         xceb117,xceb118,xceb119,xceb120,xceb201,
#                         xceb202,xceb202a,xceb202b,xceb202c,xceb202d,
#                         xceb202e,xceb202f,xceb202g,xceb202h,xceb212,
#                         xceb212a,xceb212b,xceb212c,xceb212d,xceb212e,
#                         xceb212f,xceb212g,xceb212h,xceb222,xceb222a,
#                         xceb222b,xceb222c,xceb222d,xceb222e,xceb222f,
#                         xceb222g,xceb222h,xceb301,xceb302,xcebud001,
#                         xcebud002,xcebud003,xcebud004,xcebud005,xcebud006,
#                         xcebud007,xcebud008,xcebud009,xcebud010,xcebud011,
#                         xcebud012,xcebud013,xcebud014,xcebud015,xcebud016,
#                         xcebud017,xcebud018,xcebud019,xcebud020,xcebud021,
#                         xcebud022,xcebud023,xcebud024,xcebud025,xcebud026,
#                         xcebud027,xcebud028,xcebud029,xcebud030,xceb107,
#                         xceb108,xceb109,xceb121,xceb122,xceb123,
#                         xceb124,xceb125,xceb126,xceb127,xceb128,
#                         xceb129,xceb130,xceb131,xceb132)
#      VALUES(l_xceb.xcebent,l_xceb.xcebcomp,l_xceb.xcebld,l_xceb.xcebdocno,l_xceb.xcebseq,
#             l_xceb.xceb001,l_xceb.xceb002,l_xceb.xceb003,l_xceb.xceb004,l_xceb.xceb005,
#             l_xceb.xceb101,l_xceb.xceb102,l_xceb.xceb103,l_xceb.xceb110,l_xceb.xceb111,
#             l_xceb.xceb112,l_xceb.xceb113,l_xceb.xceb114,l_xceb.xceb115,l_xceb.xceb116,
#             l_xceb.xceb117,l_xceb.xceb118,l_xceb.xceb119,l_xceb.xceb120,l_xceb.xceb201,
#             l_xceb.xceb202,l_xceb.xceb202a,l_xceb.xceb202b,l_xceb.xceb202c,l_xceb.xceb202d,
#             l_xceb.xceb202e,l_xceb.xceb202f,l_xceb.xceb202g,l_xceb.xceb202h,l_xceb.xceb212,
#             l_xceb.xceb212a,l_xceb.xceb212b,l_xceb.xceb212c,l_xceb.xceb212d,l_xceb.xceb212e,
#             l_xceb.xceb212f,l_xceb.xceb212g,l_xceb.xceb212h,l_xceb.xceb222,l_xceb.xceb222a,
#             l_xceb.xceb222b,l_xceb.xceb222c,l_xceb.xceb222d,l_xceb.xceb222e,l_xceb.xceb222f,
#             l_xceb.xceb222g,l_xceb.xceb222h,l_xceb.xceb301,l_xceb.xceb302,l_xceb.xcebud001,
#             l_xceb.xcebud002,l_xceb.xcebud003,l_xceb.xcebud004,l_xceb.xcebud005,l_xceb.xcebud006,
#             l_xceb.xcebud007,l_xceb.xcebud008,l_xceb.xcebud009,l_xceb.xcebud010,l_xceb.xcebud011,
#             l_xceb.xcebud012,l_xceb.xcebud013,l_xceb.xcebud014,l_xceb.xcebud015,l_xceb.xcebud016,
#             l_xceb.xcebud017,l_xceb.xcebud018,l_xceb.xcebud019,l_xceb.xcebud020,l_xceb.xcebud021,
#             l_xceb.xcebud022,l_xceb.xcebud023,l_xceb.xcebud024,l_xceb.xcebud025,l_xceb.xcebud026,
#             l_xceb.xcebud027,l_xceb.xcebud028,l_xceb.xcebud029,l_xceb.xcebud030,l_xceb.xceb107,
#             l_xceb.xceb108,l_xceb.xceb109,l_xceb.xceb121,l_xceb.xceb122,l_xceb.xceb123,
#             l_xceb.xceb124,l_xceb.xceb125,l_xceb.xceb126,l_xceb.xceb127,l_xceb.xceb128,
#             l_xceb.xceb129,l_xceb.xceb130,l_xceb.xceb131,l_xceb.xceb132)
#      #161109-00085#63 --e add
#     
#     IF SQLCA.sqlcode THEN
#        INITIALIZE g_errparam TO NULL
#      LET g_errparam.code = SQLCA.sqlcode
#      LET g_errparam.extend = "g_xcea_m"
#      LET g_errparam.popup = TRUE
#      CALL cl_err()
#  
#        LET g_success = 'N'
#        EXIT FOREACH
#     END IF
#      
#   
#      INITIALIZE l_xcec.* TO NULL 
#
#      LET l_xcec.xcecent = g_enterprise
#      LET l_xcec.xcecld  = g_xcea_m.xceald
#      LET l_xcec.xceccomp  = g_xcea_m.xceacomp
#      LET l_xcec.xcecdocno = g_xcea_m.xceadocno
#      LET l_xcec.xcec001 = l_xcck.xcck006
#      LET l_xcec.xcec002 = l_xcck.xcck007
#      LET l_xcec.xcec003 = l_xcck.xcck012
#      LET l_xcec.xcec004 = l_xcck.xcck010
#      LET l_xcec.xcec005 = l_xcck.xcck011
#      LET l_xcec.xcec101 = ''
##抓axci201的科目
#      IF cl_null(l_xcec.xcec101) THEN
#         CALL s_fin_get_account(g_xcea_m.xceald,'60','8912','6') RETURNING l_success,l_xcec.xcec101,l_errno
#      END IF
#      LET l_xcec.xcec102 = ''
#      LET l_xcec.xcec103 = l_xcck.xcck002
#      LET l_xcec.xcec117 = l_xceb.xceb117
#      LET l_xcec.xcec119 = l_xcck.xcck030
#      LET l_xcec.xcec201 = l_xcck.xcck201
#      LET l_xcec.xcec202 = l_xcck.xcck202
#      LET l_xcec.xcec202a = l_xcck.xcck202a
#      LET l_xcec.xcec202b = l_xcck.xcck202b
#      LET l_xcec.xcec202c = l_xcck.xcck202c
#      LET l_xcec.xcec202d = l_xcck.xcck202d
#      LET l_xcec.xcec202e = l_xcck.xcck202e
#      LET l_xcec.xcec202f = l_xcck.xcck202f
#      LET l_xcec.xcec202g = l_xcck.xcck202g
#      LET l_xcec.xcec202h = l_xcck.xcck202h
#      LET l_xcec.xcec212  = l_xceb.xceb212
#      LET l_xcec.xcec212a  = l_xceb.xceb212a
#      LET l_xcec.xcec212b  = l_xceb.xceb212b
#      LET l_xcec.xcec212c  = l_xceb.xceb212c
#      LET l_xcec.xcec212d  = l_xceb.xceb212d
#      LET l_xcec.xcec212e  = l_xceb.xceb212e
#      LET l_xcec.xcec212f  = l_xceb.xceb212f
#      LET l_xcec.xcec212g  = l_xceb.xceb212g
#      LET l_xcec.xcec212h  = l_xceb.xceb212h
#      LET l_xcec.xcec222   = l_xceb.xceb222
#      LET l_xcec.xcec222a  = l_xceb.xceb222a
#      LET l_xcec.xcec222b  = l_xceb.xceb222b
#      LET l_xcec.xcec222c  = l_xceb.xceb222c
#      LET l_xcec.xcec222d  = l_xceb.xceb222d
#      LET l_xcec.xcec222e  = l_xceb.xceb222e
#      LET l_xcec.xcec222f  = l_xceb.xceb222f
#      LET l_xcec.xcec222g  = l_xceb.xceb222g
#      LET l_xcec.xcec222h  = l_xceb.xceb222h
#      LET l_xcec.xcec107  = l_xceb.xceb107
#      LET l_xcec.xcec108  = l_xceb.xceb108
#      LET l_xcec.xcec109  = l_xceb.xceb109
#      LET l_xcec.xcec121  = l_xceb.xceb121
#      LET l_xcec.xcec122  = l_xceb.xceb122
#      LET l_xcec.xcec123  = l_xceb.xceb123
#      LET l_xcec.xcec124  = l_xceb.xceb124
#      LET l_xcec.xcec125  = l_xceb.xceb125
#      LET l_xcec.xcec126  = l_xceb.xceb126
#      LET l_xcec.xcec127  = l_xceb.xceb127
#      LET l_xcec.xcec128  = l_xceb.xceb128
#      LET l_xcec.xcec129  = l_xceb.xceb129
#      LET l_xcec.xcec130  = l_xceb.xceb130
#      
#      SELECT MAX(xcecseq) INTO l_xcec.xcecseq FROM xcec_t
#       WHERE xcecent = g_enterprise AND xcecld = g_xcea_m.xceald
#         AND xcecdocno = g_xcea_m.xceadocno
#      IF cl_null(l_xcec.xcecseq) OR l_xcec.xcecseq = 0 THEN
#         LET l_xcec.xcecseq = 1
#      ELSE
#         LET l_xcec.xcecseq = l_xcec.xcecseq + 1
#      END IF 
#
#      #摘要
#      IF cl_null(l_xcec.xcec102) THEN
#         CALL axct701_01_get_summ(g_xcea_m.xceald,'61','8925','4') RETURNING l_success,l_xcec.xcec102
#      END IF
#      CALL axct701_01_default_space_xceb(l_xceb.*) RETURNING l_xceb.xceb005,
#                                                             l_xceb.xceb101,
#                                                             l_xceb.xceb102,
#                                                             l_xceb.xceb103,
#                                                             l_xceb.xceb110,
#                                                             l_xceb.xceb111,
#                                                             l_xceb.xceb112,
#                                                             l_xceb.xceb113,
#                                                             l_xceb.xceb114,
#                                                             l_xceb.xceb115,
#                                                             l_xceb.xceb116,
#                                                             l_xceb.xceb117,
#                                                             l_xceb.xceb118,
#                                                             l_xceb.xceb119,
#                                                             l_xceb.xceb120,
#                                                             l_xceb.xceb107,
#                                                             l_xceb.xceb108,
#                                                             l_xceb.xceb109,
#                                                             l_xceb.xceb121,
#                                                             l_xceb.xceb122,
#                                                             l_xceb.xceb123,
#                                                             l_xceb.xceb124,
#                                                             l_xceb.xceb125,
#                                                             l_xceb.xceb126,
#                                                             l_xceb.xceb127,
#                                                             l_xceb.xceb128,
#                                                             l_xceb.xceb129,
#                                                             l_xceb.xceb130      
##如果金额和数量都为0的话，则不产生此笔单身数据                                                             
#      IF l_xcec.xcec201= 0 AND l_xcec.xcec202 = 0 THEN
#         CONTINUE FOREACH
#      END IF            
#      #161109-00085#20-s mod      
##      INSERT INTO xcec_t VALUES(l_xcec.*)   #161109-00085#20-s mark
#      #161109-00085#63 --s mark
#      #INSERT INTO xcec_t(xcecent,xceccomp,xcecld,xcecdocno,xcecseq,xcec001,xcec002,xcec003,xcec004,
#      #                   xcec005,xcec101,xcec102,xcec103,xcec110,xcec111,xcec112,xcec113,xcec114,
#      #                   xcec115,xcec116,xcec117,xcec118,xcec119,xcec120,xcec201,xcec202,xcec202a,
#      #                   xcec202b,xcec202c,xcec202d,xcec202e,xcec202f,xcec202g,xcec202h,xcec212,
#      #                   xcec212a,xcec212b,xcec212c,xcec212d,xcec212e,xcec212f,xcec212g,xcec212h,
#      #                   xcec222,xcec222a,xcec222b,xcec222c,xcec222d,xcec222e,xcec222f,xcec222g,
#      #                   xcec222h,xcec301,xcec302,xcec107,xcec108,xcec109,xcec121,xcec122,xcec123,
#      #                   xcec124,xcec125,xcec126,xcec127,xcec128,xcec129,xcec130) 
#      #            VALUES(l_xcec.xcecent,l_xcec.xceccomp,l_xcec.xcecld,l_xcec.xcecdocno,l_xcec.xcecseq,
#      #                   l_xcec.xcec001,l_xcec.xcec002,l_xcec.xcec003,l_xcec.xcec004,l_xcec.xcec005,
#      #                   l_xcec.xcec101,l_xcec.xcec102,l_xcec.xcec103,l_xcec.xcec110,l_xcec.xcec111,
#      #                   l_xcec.xcec112,l_xcec.xcec113,l_xcec.xcec114,l_xcec.xcec115,l_xcec.xcec116,
#      #                   l_xcec.xcec117,l_xcec.xcec118,l_xcec.xcec119,l_xcec.xcec120,l_xcec.xcec201,
#      #                   l_xcec.xcec202,l_xcec.xcec202a,l_xcec.xcec202b,l_xcec.xcec202c,l_xcec.xcec202d,
#      #                   l_xcec.xcec202e,l_xcec.xcec202f,l_xcec.xcec202g,l_xcec.xcec202h,l_xcec.xcec212,
#      #                   l_xcec.xcec212a,l_xcec.xcec212b,l_xcec.xcec212c,l_xcec.xcec212d,l_xcec.xcec212e,
#      #                   l_xcec.xcec212f,l_xcec.xcec212g,l_xcec.xcec212h,l_xcec.xcec222,l_xcec.xcec222a,
#      #                   l_xcec.xcec222b,l_xcec.xcec222c,l_xcec.xcec222d,l_xcec.xcec222e,l_xcec.xcec222f,
#      #                   l_xcec.xcec222g,l_xcec.xcec222h,l_xcec.xcec301,l_xcec.xcec302,l_xcec.xcec107,
#      #                   l_xcec.xcec108,l_xcec.xcec109,l_xcec.xcec121,l_xcec.xcec122,l_xcec.xcec123,
#      #                   l_xcec.xcec124,l_xcec.xcec125,l_xcec.xcec126,l_xcec.xcec127,l_xcec.xcec128,
#      #                   l_xcec.xcec129,l_xcec.xcec130)
#      #161109-00085#63 --e mark
#      #161109-00085#20-e mod
#      #161109-00085#63 --s add
#      INSERT INTO xcec_t(xcecent,xceccomp,xcecld,xcecdocno,xcecseq,
#                         xcec001,xcec002,xcec003,xcec004,xcec005,
#                         xcec101,xcec102,xcec103,xcec110,xcec111,
#                         xcec112,xcec113,xcec114,xcec115,xcec116,
#                         xcec117,xcec118,xcec119,xcec120,xcec201,
#                         xcec202,xcec202a,xcec202b,xcec202c,xcec202d,
#                         xcec202e,xcec202f,xcec202g,xcec202h,xcec212,
#                         xcec212a,xcec212b,xcec212c,xcec212d,xcec212e,
#                         xcec212f,xcec212g,xcec212h,xcec222,xcec222a,
#                         xcec222b,xcec222c,xcec222d,xcec222e,xcec222f,
#                         xcec222g,xcec222h,xcec301,xcec302,xcecud001,
#                         xcecud002,xcecud003,xcecud004,xcecud005,xcecud006,
#                         xcecud007,xcecud008,xcecud009,xcecud010,xcecud011,
#                         xcecud012,xcecud013,xcecud014,xcecud015,xcecud016,
#                         xcecud017,xcecud018,xcecud019,xcecud020,xcecud021,
#                         xcecud022,xcecud023,xcecud024,xcecud025,xcecud026,
#                         xcecud027,xcecud028,xcecud029,xcecud030,xcec107,
#                         xcec108,xcec109,xcec121,xcec122,xcec123,
#                         xcec124,xcec125,xcec126,xcec127,xcec128,
#                         xcec129,xcec130)
#      VALUES(l_xcec.xcecent,l_xcec.xceccomp,l_xcec.xcecld,l_xcec.xcecdocno,l_xcec.xcecseq,
#             l_xcec.xcec001,l_xcec.xcec002,l_xcec.xcec003,l_xcec.xcec004,l_xcec.xcec005,
#             l_xcec.xcec101,l_xcec.xcec102,l_xcec.xcec103,l_xcec.xcec110,l_xcec.xcec111,
#             l_xcec.xcec112,l_xcec.xcec113,l_xcec.xcec114,l_xcec.xcec115,l_xcec.xcec116,
#             l_xcec.xcec117,l_xcec.xcec118,l_xcec.xcec119,l_xcec.xcec120,l_xcec.xcec201,
#             l_xcec.xcec202,l_xcec.xcec202a,l_xcec.xcec202b,l_xcec.xcec202c,l_xcec.xcec202d,
#             l_xcec.xcec202e,l_xcec.xcec202f,l_xcec.xcec202g,l_xcec.xcec202h,l_xcec.xcec212,
#             l_xcec.xcec212a,l_xcec.xcec212b,l_xcec.xcec212c,l_xcec.xcec212d,l_xcec.xcec212e,
#             l_xcec.xcec212f,l_xcec.xcec212g,l_xcec.xcec212h,l_xcec.xcec222,l_xcec.xcec222a,
#             l_xcec.xcec222b,l_xcec.xcec222c,l_xcec.xcec222d,l_xcec.xcec222e,l_xcec.xcec222f,
#             l_xcec.xcec222g,l_xcec.xcec222h,l_xcec.xcec301,l_xcec.xcec302,l_xcec.xcecud001,
#             l_xcec.xcecud002,l_xcec.xcecud003,l_xcec.xcecud004,l_xcec.xcecud005,l_xcec.xcecud006,
#             l_xcec.xcecud007,l_xcec.xcecud008,l_xcec.xcecud009,l_xcec.xcecud010,l_xcec.xcecud011,
#             l_xcec.xcecud012,l_xcec.xcecud013,l_xcec.xcecud014,l_xcec.xcecud015,l_xcec.xcecud016,
#             l_xcec.xcecud017,l_xcec.xcecud018,l_xcec.xcecud019,l_xcec.xcecud020,l_xcec.xcecud021,
#             l_xcec.xcecud022,l_xcec.xcecud023,l_xcec.xcecud024,l_xcec.xcecud025,l_xcec.xcecud026,
#             l_xcec.xcecud027,l_xcec.xcecud028,l_xcec.xcecud029,l_xcec.xcecud030,l_xcec.xcec107,
#             l_xcec.xcec108,l_xcec.xcec109,l_xcec.xcec121,l_xcec.xcec122,l_xcec.xcec123,
#             l_xcec.xcec124,l_xcec.xcec125,l_xcec.xcec126,l_xcec.xcec127,l_xcec.xcec128,
#             l_xcec.xcec129,l_xcec.xcec130)
#      #161109-00085#63 --e add
#      
#      IF SQLCA.sqlcode THEN
#         INITIALIZE g_errparam TO NULL
#      LET g_errparam.code = SQLCA.sqlcode
#      LET g_errparam.extend = "g_xcea_m"
#      LET g_errparam.popup = TRUE
#      CALL cl_err()
#  
#         LET g_success = 'N'
#         EXIT FOREACH
#      END IF
#      
#      
#      CLOSE xcae_prep5
#      CLOSE xcae_prep6
#   END FOREACH   
#   RETURN g_success 
#170105-00011#7---mark---e
END FUNCTION
# 在制差異憑證資料產生  axct705
PRIVATE FUNCTION axct701_01_ins_5_bak()
#170105-00011#8---mark---e   
#   DEFINE l_success       LIKE type_t.num5
#   DEFINE l_errno         LIKE gzze_t.gzze001
#   #161109-00085#18-s mod
#   #DEFINE l_xcea          RECORD LIKE xcea_t.*   #161109-00085#18-s mark
#   DEFINE l_xcea          RECORD  #工單發料成本憑證單頭檔
#          xceaent LIKE xcea_t.xceaent, #企業編號
#          xceacomp LIKE xcea_t.xceacomp, #法人組織
#          xceald LIKE xcea_t.xceald, #帳套
#          xceadocno LIKE xcea_t.xceadocno, #單據編號
#          xcea001 LIKE xcea_t.xcea001, #單據日期
#          xcea002 LIKE xcea_t.xcea002, #成本憑證類型
#          xcea003 LIKE xcea_t.xcea003, #成本計算類型
#          xcea004 LIKE xcea_t.xcea004, #年度
#          xcea005 LIKE xcea_t.xcea005, #期別
#          xcea006 LIKE xcea_t.xcea006, #帳務人員
#          xcea007 LIKE xcea_t.xcea007, #帳務部門
#          xcea101 LIKE xcea_t.xcea101, #憑證編號
#          xcea102 LIKE xcea_t.xcea102, #憑證日期
#          xceaownid LIKE xcea_t.xceaownid, #資料所有者
#          xceaowndp LIKE xcea_t.xceaowndp, #資料所屬部門
#          xceacrtid LIKE xcea_t.xceacrtid, #資料建立者
#          xceacrtdp LIKE xcea_t.xceacrtdp, #資料建立部門
#          xceacrtdt LIKE xcea_t.xceacrtdt, #資料創建日
#          xceamodid LIKE xcea_t.xceamodid, #資料修改者
#          xceamoddt LIKE xcea_t.xceamoddt, #最近修改日
#          xceacnfid LIKE xcea_t.xceacnfid, #資料確認者
#          xceacnfdt LIKE xcea_t.xceacnfdt, #資料確認日
#          xceapstid LIKE xcea_t.xceapstid, #資料過帳者
#          xceapstdt LIKE xcea_t.xceapstdt, #資料過帳日
#          xceastus LIKE xcea_t.xceastus, #狀態碼
#          #161109-00085#63 --s add
#          xceaud001 LIKE xcea_t.xceaud001, #自定義欄位(文字)001
#          xceaud002 LIKE xcea_t.xceaud002, #自定義欄位(文字)002
#          xceaud003 LIKE xcea_t.xceaud003, #自定義欄位(文字)003
#          xceaud004 LIKE xcea_t.xceaud004, #自定義欄位(文字)004
#          xceaud005 LIKE xcea_t.xceaud005, #自定義欄位(文字)005
#          xceaud006 LIKE xcea_t.xceaud006, #自定義欄位(文字)006
#          xceaud007 LIKE xcea_t.xceaud007, #自定義欄位(文字)007
#          xceaud008 LIKE xcea_t.xceaud008, #自定義欄位(文字)008
#          xceaud009 LIKE xcea_t.xceaud009, #自定義欄位(文字)009
#          xceaud010 LIKE xcea_t.xceaud010, #自定義欄位(文字)010
#          xceaud011 LIKE xcea_t.xceaud011, #自定義欄位(數字)011
#          xceaud012 LIKE xcea_t.xceaud012, #自定義欄位(數字)012
#          xceaud013 LIKE xcea_t.xceaud013, #自定義欄位(數字)013
#          xceaud014 LIKE xcea_t.xceaud014, #自定義欄位(數字)014
#          xceaud015 LIKE xcea_t.xceaud015, #自定義欄位(數字)015
#          xceaud016 LIKE xcea_t.xceaud016, #自定義欄位(數字)016
#          xceaud017 LIKE xcea_t.xceaud017, #自定義欄位(數字)017
#          xceaud018 LIKE xcea_t.xceaud018, #自定義欄位(數字)018
#          xceaud019 LIKE xcea_t.xceaud019, #自定義欄位(數字)019
#          xceaud020 LIKE xcea_t.xceaud020, #自定義欄位(數字)020
#          xceaud021 LIKE xcea_t.xceaud021, #自定義欄位(日期時間)021
#          xceaud022 LIKE xcea_t.xceaud022, #自定義欄位(日期時間)022
#          xceaud023 LIKE xcea_t.xceaud023, #自定義欄位(日期時間)023
#          xceaud024 LIKE xcea_t.xceaud024, #自定義欄位(日期時間)024
#          xceaud025 LIKE xcea_t.xceaud025, #自定義欄位(日期時間)025
#          xceaud026 LIKE xcea_t.xceaud026, #自定義欄位(日期時間)026
#          xceaud027 LIKE xcea_t.xceaud027, #自定義欄位(日期時間)027
#          xceaud028 LIKE xcea_t.xceaud028, #自定義欄位(日期時間)028
#          xceaud029 LIKE xcea_t.xceaud029, #自定義欄位(日期時間)029
#          xceaud030 LIKE xcea_t.xceaud030, #自定義欄位(日期時間)030
#          #161109-00085#63 --e add
#          xceasite LIKE xcea_t.xceasite  #營運據點
#             END RECORD
#   #161109-00085#18-e mod
#   #161109-00085#18-s mod
#   #DEFINE l_xceb          RECORD LIKE xceb_t.*   #161109-00085#18-s mark
#   DEFINE l_xceb          RECORD  #成本憑證第一單身檔
#          xcebent LIKE xceb_t.xcebent, #企業編號
#          xcebcomp LIKE xceb_t.xcebcomp, #法人組織
#          xcebld LIKE xceb_t.xcebld, #帳套
#          xcebdocno LIKE xceb_t.xcebdocno, #單據編號
#          xcebseq LIKE xceb_t.xcebseq, #項次
#          xceb001 LIKE xceb_t.xceb001, #參考單據編號
#          xceb002 LIKE xceb_t.xceb002, #參考單據項次
#          xceb003 LIKE xceb_t.xceb003, #單據類型
#          xceb004 LIKE xceb_t.xceb004, #料件編號
#          xceb005 LIKE xceb_t.xceb005, #特性
#          xceb101 LIKE xceb_t.xceb101, #科目編號
#          xceb102 LIKE xceb_t.xceb102, #摘要
#          xceb103 LIKE xceb_t.xceb103, #成本域
#          xceb110 LIKE xceb_t.xceb110, #原因碼
#          xceb111 LIKE xceb_t.xceb111, #收付款客商
#          xceb112 LIKE xceb_t.xceb112, #客群
#          xceb113 LIKE xceb_t.xceb113, #區域
#          xceb114 LIKE xceb_t.xceb114, #成本中心
#          xceb115 LIKE xceb_t.xceb115, #經營類別
#          xceb116 LIKE xceb_t.xceb116, #通路
#          xceb117 LIKE xceb_t.xceb117, #品類
#          xceb118 LIKE xceb_t.xceb118, #品牌
#          xceb119 LIKE xceb_t.xceb119, #專案號
#          xceb120 LIKE xceb_t.xceb120, #WBS
#          xceb201 LIKE xceb_t.xceb201, #數量
#          xceb202 LIKE xceb_t.xceb202, #成本金額(本位幣一)
#          xceb202a LIKE xceb_t.xceb202a, #成本-材料(本位幣一)
#          xceb202b LIKE xceb_t.xceb202b, #成本-人工(本位幣一)
#          xceb202c LIKE xceb_t.xceb202c, #成本-加工(本位幣一)
#          xceb202d LIKE xceb_t.xceb202d, #成本-制費一(本位幣一)
#          xceb202e LIKE xceb_t.xceb202e, #成本-制費二(本位幣一)
#          xceb202f LIKE xceb_t.xceb202f, #成本-制費三(本位幣一)
#          xceb202g LIKE xceb_t.xceb202g, #成本-制費四(本位幣一)
#          xceb202h LIKE xceb_t.xceb202h, #成本-制費五(本位幣一)
#          xceb212 LIKE xceb_t.xceb212, #成本金額(本位幣二)
#          xceb212a LIKE xceb_t.xceb212a, #成本-材料(本位幣二)
#          xceb212b LIKE xceb_t.xceb212b, #成本-人工(本位幣二)
#          xceb212c LIKE xceb_t.xceb212c, #成本-加工(本位幣二)
#          xceb212d LIKE xceb_t.xceb212d, #成本-制費一(本位幣二)
#          xceb212e LIKE xceb_t.xceb212e, #成本-制費二(本位幣二)
#          xceb212f LIKE xceb_t.xceb212f, #成本-制費三(本位幣二)
#          xceb212g LIKE xceb_t.xceb212g, #成本-制費四(本位幣二)
#          xceb212h LIKE xceb_t.xceb212h, #成本-制費五(本位幣二)
#          xceb222 LIKE xceb_t.xceb222, #成本金額(本位幣三)
#          xceb222a LIKE xceb_t.xceb222a, #成本-材料(本位幣三)
#          xceb222b LIKE xceb_t.xceb222b, #成本-人工(本位幣三)
#          xceb222c LIKE xceb_t.xceb222c, #成本-加工(本位幣三)
#          xceb222d LIKE xceb_t.xceb222d, #成本-制費一(本位幣三)
#          xceb222e LIKE xceb_t.xceb222e, #成本-制費二(本位幣三)
#          xceb222f LIKE xceb_t.xceb222f, #成本-制費三(本位幣三)
#          xceb222g LIKE xceb_t.xceb222g, #成本-制費四(本位幣三)
#          xceb222h LIKE xceb_t.xceb222h, #成本-制費五(本位幣三)
#          xceb301 LIKE xceb_t.xceb301, #憑證編號
#          xceb302 LIKE xceb_t.xceb302, #憑證項次
#          #161109-00085#63 --s add  
#          xcebud001 LIKE xceb_t.xcebud001, #自定義欄位(文字)001
#          xcebud002 LIKE xceb_t.xcebud002, #自定義欄位(文字)002
#          xcebud003 LIKE xceb_t.xcebud003, #自定義欄位(文字)003
#          xcebud004 LIKE xceb_t.xcebud004, #自定義欄位(文字)004
#          xcebud005 LIKE xceb_t.xcebud005, #自定義欄位(文字)005
#          xcebud006 LIKE xceb_t.xcebud006, #自定義欄位(文字)006
#          xcebud007 LIKE xceb_t.xcebud007, #自定義欄位(文字)007
#          xcebud008 LIKE xceb_t.xcebud008, #自定義欄位(文字)008
#          xcebud009 LIKE xceb_t.xcebud009, #自定義欄位(文字)009
#          xcebud010 LIKE xceb_t.xcebud010, #自定義欄位(文字)010
#          xcebud011 LIKE xceb_t.xcebud011, #自定義欄位(數字)011
#          xcebud012 LIKE xceb_t.xcebud012, #自定義欄位(數字)012
#          xcebud013 LIKE xceb_t.xcebud013, #自定義欄位(數字)013
#          xcebud014 LIKE xceb_t.xcebud014, #自定義欄位(數字)014
#          xcebud015 LIKE xceb_t.xcebud015, #自定義欄位(數字)015
#          xcebud016 LIKE xceb_t.xcebud016, #自定義欄位(數字)016
#          xcebud017 LIKE xceb_t.xcebud017, #自定義欄位(數字)017
#          xcebud018 LIKE xceb_t.xcebud018, #自定義欄位(數字)018
#          xcebud019 LIKE xceb_t.xcebud019, #自定義欄位(數字)019
#          xcebud020 LIKE xceb_t.xcebud020, #自定義欄位(數字)020
#          xcebud021 LIKE xceb_t.xcebud021, #自定義欄位(日期時間)021
#          xcebud022 LIKE xceb_t.xcebud022, #自定義欄位(日期時間)022
#          xcebud023 LIKE xceb_t.xcebud023, #自定義欄位(日期時間)023
#          xcebud024 LIKE xceb_t.xcebud024, #自定義欄位(日期時間)024
#          xcebud025 LIKE xceb_t.xcebud025, #自定義欄位(日期時間)025
#          xcebud026 LIKE xceb_t.xcebud026, #自定義欄位(日期時間)026
#          xcebud027 LIKE xceb_t.xcebud027, #自定義欄位(日期時間)027
#          xcebud028 LIKE xceb_t.xcebud028, #自定義欄位(日期時間)028
#          xcebud029 LIKE xceb_t.xcebud029, #自定義欄位(日期時間)029
#          xcebud030 LIKE xceb_t.xcebud030, #自定義欄位(日期時間)030
#          #161109-00085#63 --e add
#          xceb107 LIKE xceb_t.xceb107, #人員
#          xceb108 LIKE xceb_t.xceb108, #部門
#          xceb109 LIKE xceb_t.xceb109, #帳款對象
#          xceb121 LIKE xceb_t.xceb121, #自由核算項1
#          xceb122 LIKE xceb_t.xceb122, #自由核算項2
#          xceb123 LIKE xceb_t.xceb123, #自由核算項3
#          xceb124 LIKE xceb_t.xceb124, #自由核算項4
#          xceb125 LIKE xceb_t.xceb125, #自由核算項5
#          xceb126 LIKE xceb_t.xceb126, #自由核算項6
#          xceb127 LIKE xceb_t.xceb127, #自由核算項7
#          xceb128 LIKE xceb_t.xceb128, #自由核算項8
#          xceb129 LIKE xceb_t.xceb129, #自由核算項9
#          xceb130 LIKE xceb_t.xceb130, #自由核算項10
#          xceb131 LIKE xceb_t.xceb131, #單據類型(for 流通)
#          xceb132 LIKE xceb_t.xceb132  #單據日期(for 流通)
#             END RECORD
#   #161109-00085#18-e mod
#   #161109-00085#18-s mod
#   #DEFINE l_xcec          RECORD LIKE xcec_t.*   #161109-00085#18-s mark
#   DEFINE l_xcec          RECORD  #成本憑證第二單身檔
#          xcecent LIKE xcec_t.xcecent, #企業編號
#          xceccomp LIKE xcec_t.xceccomp, #法人組織
#          xcecld LIKE xcec_t.xcecld, #帳套
#          xcecdocno LIKE xcec_t.xcecdocno, #單據編號
#          xcecseq LIKE xcec_t.xcecseq, #項次
#          xcec001 LIKE xcec_t.xcec001, #參考單據
#          xcec002 LIKE xcec_t.xcec002, #參考單據項次
#          xcec003 LIKE xcec_t.xcec003, #單據類型
#          xcec004 LIKE xcec_t.xcec004, #料件編號
#          xcec005 LIKE xcec_t.xcec005, #特性
#          xcec101 LIKE xcec_t.xcec101, #科目編號
#          xcec102 LIKE xcec_t.xcec102, #摘要
#          xcec103 LIKE xcec_t.xcec103, #成本域
#          xcec110 LIKE xcec_t.xcec110, #原因碼
#          xcec111 LIKE xcec_t.xcec111, #收付款客商
#          xcec112 LIKE xcec_t.xcec112, #客群
#          xcec113 LIKE xcec_t.xcec113, #區域
#          xcec114 LIKE xcec_t.xcec114, #成本中心
#          xcec115 LIKE xcec_t.xcec115, #經營類別
#          xcec116 LIKE xcec_t.xcec116, #通路
#          xcec117 LIKE xcec_t.xcec117, #品類
#          xcec118 LIKE xcec_t.xcec118, #品牌
#          xcec119 LIKE xcec_t.xcec119, #專案號
#          xcec120 LIKE xcec_t.xcec120, #WBS
#          xcec201 LIKE xcec_t.xcec201, #數量
#          xcec202 LIKE xcec_t.xcec202, #成本金額(本位幣一)
#          xcec202a LIKE xcec_t.xcec202a, #成本-材料(本位幣一)
#          xcec202b LIKE xcec_t.xcec202b, #成本-人工(本位幣一)
#          xcec202c LIKE xcec_t.xcec202c, #成本-加工(本位幣一)
#          xcec202d LIKE xcec_t.xcec202d, #成本-制費一(本位幣一)
#          xcec202e LIKE xcec_t.xcec202e, #成本-制費二(本位幣一)
#          xcec202f LIKE xcec_t.xcec202f, #成本-制費三(本位幣一)
#          xcec202g LIKE xcec_t.xcec202g, #成本-制費四(本位幣一)
#          xcec202h LIKE xcec_t.xcec202h, #成本-制費五(本位幣一)
#          xcec212 LIKE xcec_t.xcec212, #成本-金額(本位幣二)
#          xcec212a LIKE xcec_t.xcec212a, #成本-材料(本位幣二)
#          xcec212b LIKE xcec_t.xcec212b, #成本-人工(本位幣二)
#          xcec212c LIKE xcec_t.xcec212c, #成本-加工(本位幣二)
#          xcec212d LIKE xcec_t.xcec212d, #成本-制費一(本位幣二)
#          xcec212e LIKE xcec_t.xcec212e, #成本-制費二(本位幣二)
#          xcec212f LIKE xcec_t.xcec212f, #成本-制費三(本位幣二)
#          xcec212g LIKE xcec_t.xcec212g, #成本-制費四(本位幣二)
#          xcec212h LIKE xcec_t.xcec212h, #成本-制費五(本位幣二)
#          xcec222 LIKE xcec_t.xcec222, #成本-金額(本位幣三)
#          xcec222a LIKE xcec_t.xcec222a, #成本-材料(本位幣三)
#          xcec222b LIKE xcec_t.xcec222b, #成本-人工(本位幣三)
#          xcec222c LIKE xcec_t.xcec222c, #成本-加工(本位幣三)
#          xcec222d LIKE xcec_t.xcec222d, #成本-制費一(本位幣三)
#          xcec222e LIKE xcec_t.xcec222e, #成本-制費二(本位幣三)
#          xcec222f LIKE xcec_t.xcec222f, #成本-制費三(本位幣三)
#          xcec222g LIKE xcec_t.xcec222g, #成本-制費四(本位幣三)
#          xcec222h LIKE xcec_t.xcec222h, #成本-制費五(本位幣三)
#          xcec301 LIKE xcec_t.xcec301, #憑證編號
#          xcec302 LIKE xcec_t.xcec302, #憑證項次
#          #161109-00085#63 --s add 
#          xcecud001 LIKE xcec_t.xcecud001, #自定義欄位(文字)001
#          xcecud002 LIKE xcec_t.xcecud002, #自定義欄位(文字)002
#          xcecud003 LIKE xcec_t.xcecud003, #自定義欄位(文字)003
#          xcecud004 LIKE xcec_t.xcecud004, #自定義欄位(文字)004
#          xcecud005 LIKE xcec_t.xcecud005, #自定義欄位(文字)005
#          xcecud006 LIKE xcec_t.xcecud006, #自定義欄位(文字)006
#          xcecud007 LIKE xcec_t.xcecud007, #自定義欄位(文字)007
#          xcecud008 LIKE xcec_t.xcecud008, #自定義欄位(文字)008
#          xcecud009 LIKE xcec_t.xcecud009, #自定義欄位(文字)009
#          xcecud010 LIKE xcec_t.xcecud010, #自定義欄位(文字)010
#          xcecud011 LIKE xcec_t.xcecud011, #自定義欄位(數字)011
#          xcecud012 LIKE xcec_t.xcecud012, #自定義欄位(數字)012
#          xcecud013 LIKE xcec_t.xcecud013, #自定義欄位(數字)013
#          xcecud014 LIKE xcec_t.xcecud014, #自定義欄位(數字)014
#          xcecud015 LIKE xcec_t.xcecud015, #自定義欄位(數字)015
#          xcecud016 LIKE xcec_t.xcecud016, #自定義欄位(數字)016
#          xcecud017 LIKE xcec_t.xcecud017, #自定義欄位(數字)017
#          xcecud018 LIKE xcec_t.xcecud018, #自定義欄位(數字)018
#          xcecud019 LIKE xcec_t.xcecud019, #自定義欄位(數字)019
#          xcecud020 LIKE xcec_t.xcecud020, #自定義欄位(數字)020
#          xcecud021 LIKE xcec_t.xcecud021, #自定義欄位(日期時間)021
#          xcecud022 LIKE xcec_t.xcecud022, #自定義欄位(日期時間)022
#          xcecud023 LIKE xcec_t.xcecud023, #自定義欄位(日期時間)023
#          xcecud024 LIKE xcec_t.xcecud024, #自定義欄位(日期時間)024
#          xcecud025 LIKE xcec_t.xcecud025, #自定義欄位(日期時間)025
#          xcecud026 LIKE xcec_t.xcecud026, #自定義欄位(日期時間)026
#          xcecud027 LIKE xcec_t.xcecud027, #自定義欄位(日期時間)027
#          xcecud028 LIKE xcec_t.xcecud028, #自定義欄位(日期時間)028
#          xcecud029 LIKE xcec_t.xcecud029, #自定義欄位(日期時間)029
#          xcecud030 LIKE xcec_t.xcecud030, #自定義欄位(日期時間)030
#          #161109-00085#63 --e add
#          xcec107 LIKE xcec_t.xcec107, #人員
#          xcec108 LIKE xcec_t.xcec108, #部門
#          xcec109 LIKE xcec_t.xcec109, #帳款對象
#          xcec121 LIKE xcec_t.xcec121, #自由核算項1
#          xcec122 LIKE xcec_t.xcec122, #自由核算項2
#          xcec123 LIKE xcec_t.xcec123, #自由核算項3
#          xcec124 LIKE xcec_t.xcec124, #自由核算項4
#          xcec125 LIKE xcec_t.xcec125, #自由核算項5
#          xcec126 LIKE xcec_t.xcec126, #自由核算項6
#          xcec127 LIKE xcec_t.xcec127, #自由核算項7
#          xcec128 LIKE xcec_t.xcec128, #自由核算項8
#          xcec129 LIKE xcec_t.xcec129, #自由核算項9
#          xcec130 LIKE xcec_t.xcec130  #自由核算項10
#                  END RECORD
#   #161109-00085#18-e mod
#   #161109-00085#18-s mod
#   #DEFINE l_xccd          RECORD LIKE xccd_t.*   #161109-00085#18-s mark
#   DEFINE l_xccd          RECORD  #在製主件成本期異動統計檔
#          xccdent LIKE xccd_t.xccdent, #企業編號
#          xccdcomp LIKE xccd_t.xccdcomp, #法人組織
#          xccdld LIKE xccd_t.xccdld, #帳套
#          xccd001 LIKE xccd_t.xccd001, #帳套本位幣順序
#          xccd002 LIKE xccd_t.xccd002, #成本域
#          xccd003 LIKE xccd_t.xccd003, #成本計算類型
#          xccd004 LIKE xccd_t.xccd004, #年度
#          xccd005 LIKE xccd_t.xccd005, #期別
#          xccd006 LIKE xccd_t.xccd006, #工單編號
#          xccd007 LIKE xccd_t.xccd007, #主件料號
#          xccd008 LIKE xccd_t.xccd008, #產品特徵
#          xccd009 LIKE xccd_t.xccd009, #批號
#          xccd010 LIKE xccd_t.xccd010, #專案號
#          xccd011 LIKE xccd_t.xccd011, #核算幣別
#          xccd012 LIKE xccd_t.xccd012, #重複性成產否
#          xccd013 LIKE xccd_t.xccd013, #成產計劃號
#          xccd014 LIKE xccd_t.xccd014, #BOM特性
#          xccd101 LIKE xccd_t.xccd101, #上期結存數量
#          xccd102 LIKE xccd_t.xccd102, #上期結存金額
#          xccd102a LIKE xccd_t.xccd102a, #上期結存金額-材料
#          xccd102b LIKE xccd_t.xccd102b, #上期結存金額-人工
#          xccd102c LIKE xccd_t.xccd102c, #上期結存金額-加工
#          xccd102d LIKE xccd_t.xccd102d, #上期結存金額-制費一
#          xccd102e LIKE xccd_t.xccd102e, #上期結存金額-制費二
#          xccd102f LIKE xccd_t.xccd102f, #上期結存金額-制費三
#          xccd102g LIKE xccd_t.xccd102g, #上期結存金額-制費四
#          xccd102h LIKE xccd_t.xccd102h, #上期結存金額-制費五
#          xccd200 LIKE xccd_t.xccd200, #本期投入工時
#          xccd201 LIKE xccd_t.xccd201, #本期投入數量
#          xccd202 LIKE xccd_t.xccd202, #本期本階投入金額
#          xccd202a LIKE xccd_t.xccd202a, #本期本階投入金額-材料
#          xccd202b LIKE xccd_t.xccd202b, #本期本階投入金額-人工
#          xccd202c LIKE xccd_t.xccd202c, #本期本階投入金額-加工
#          xccd202d LIKE xccd_t.xccd202d, #本期本階投入金額-制費一
#          xccd202e LIKE xccd_t.xccd202e, #本期本階投入金額-制費二
#          xccd202f LIKE xccd_t.xccd202f, #本期本階投入金額-制費三
#          xccd202g LIKE xccd_t.xccd202g, #本期本階投入金額-制費四
#          xccd202h LIKE xccd_t.xccd202h, #本期本階投入金額-制費五
#          xccd204 LIKE xccd_t.xccd204, #本期下階投入金額
#          xccd204a LIKE xccd_t.xccd204a, #本期下階投入金額-材料
#          xccd204b LIKE xccd_t.xccd204b, #本期下階投入金額-人工
#          xccd204c LIKE xccd_t.xccd204c, #本期下階投入金額-加工
#          xccd204d LIKE xccd_t.xccd204d, #本期下階投入金額-制費一
#          xccd204e LIKE xccd_t.xccd204e, #本期下階投入金額-制費二
#          xccd204f LIKE xccd_t.xccd204f, #本期下階投入金額-制費三
#          xccd204g LIKE xccd_t.xccd204g, #本期下階投入金額-制費四
#          xccd204h LIKE xccd_t.xccd204h, #本期下階投入金額-制費五
#          xccd301 LIKE xccd_t.xccd301, #本期轉出數量
#          xccd302 LIKE xccd_t.xccd302, #本期轉出金額
#          xccd302a LIKE xccd_t.xccd302a, #本期轉出金額-材料
#          xccd302b LIKE xccd_t.xccd302b, #本期轉出金額-人工
#          xccd302c LIKE xccd_t.xccd302c, #本期轉出金額-加工
#          xccd302d LIKE xccd_t.xccd302d, #本期轉出金額-制費一
#          xccd302e LIKE xccd_t.xccd302e, #本期轉出金額-制費二
#          xccd302f LIKE xccd_t.xccd302f, #本期轉出金額-制費三
#          xccd302g LIKE xccd_t.xccd302g, #本期轉出金額-制費四
#          xccd302h LIKE xccd_t.xccd302h, #本期轉出金額-制費五
#          xccd303 LIKE xccd_t.xccd303, #差異轉出數量
#          xccd304 LIKE xccd_t.xccd304, #差異轉出金額
#          xccd304a LIKE xccd_t.xccd304a, #差異轉出金額-材料
#          xccd304b LIKE xccd_t.xccd304b, #差異轉出金額-人工
#          xccd304c LIKE xccd_t.xccd304c, #差異轉出金額-加工
#          xccd304d LIKE xccd_t.xccd304d, #差異轉出金額-制費一
#          xccd304e LIKE xccd_t.xccd304e, #差異轉出金額-制費二
#          xccd304f LIKE xccd_t.xccd304f, #差異轉出金額-制費三
#          xccd304g LIKE xccd_t.xccd304g, #差異轉出金額-制費四
#          xccd304h LIKE xccd_t.xccd304h, #差異轉出金額-制費五
#          xccd901 LIKE xccd_t.xccd901, #期末結存數量
#          xccd902 LIKE xccd_t.xccd902, #期末結存金額
#          xccd902a LIKE xccd_t.xccd902a, #期末結存金額-材料
#          xccd902b LIKE xccd_t.xccd902b, #期末結存金額-人工
#          xccd902c LIKE xccd_t.xccd902c, #期末結存金額-加工
#          xccd902d LIKE xccd_t.xccd902d, #期末結存金額-制費一
#          xccd902e LIKE xccd_t.xccd902e, #期末結存金額-制費二
#          xccd902f LIKE xccd_t.xccd902f, #期末結存金額-制費三
#          xccd902g LIKE xccd_t.xccd902g, #期末結存金額-制費四
#          xccd902h LIKE xccd_t.xccd902h, #期末結存金額-制費五
#          xccdtime LIKE xccd_t.xccdtime  #最近成本計算時間
#             END RECORD
#   #161109-00085#18-e mod
#   #161109-00085#18-s mod
#   #DEFINE l_xcce          RECORD LIKE xcce_t.*   #161109-00085#18-s mark
#   DEFINE l_xcce          RECORD  #在製元件成本期異動統計檔
#          xcceent LIKE xcce_t.xcceent, #企業編號
#          xccecomp LIKE xcce_t.xccecomp, #法人組織
#          xcceld LIKE xcce_t.xcceld, #帳套
#          xcce001 LIKE xcce_t.xcce001, #帳套本位幣順序
#          xcce002 LIKE xcce_t.xcce002, #成本域
#          xcce003 LIKE xcce_t.xcce003, #成本計算類型
#          xcce004 LIKE xcce_t.xcce004, #年度
#          xcce005 LIKE xcce_t.xcce005, #期別
#          xcce006 LIKE xcce_t.xcce006, #工單編號
#          xcce007 LIKE xcce_t.xcce007, #元件編號
#          xcce008 LIKE xcce_t.xcce008, #產品特徵
#          xcce009 LIKE xcce_t.xcce009, #批號
#          xcce010 LIKE xcce_t.xcce010, #核算幣別
#          xcce101 LIKE xcce_t.xcce101, #上期結存數量
#          xcce102 LIKE xcce_t.xcce102, #上期結存金額
#          xcce102a LIKE xcce_t.xcce102a, #上期結存金額-材料
#          xcce102b LIKE xcce_t.xcce102b, #上期結存金額-人工
#          xcce102c LIKE xcce_t.xcce102c, #上期結存金額-加工
#          xcce102d LIKE xcce_t.xcce102d, #上期結存金額-制費一
#          xcce102e LIKE xcce_t.xcce102e, #上期結存金額-制費二
#          xcce102f LIKE xcce_t.xcce102f, #上期結存金額-制費三
#          xcce102g LIKE xcce_t.xcce102g, #上期結存金額-制費四
#          xcce102h LIKE xcce_t.xcce102h, #上期結存金額-制費五
#          xcce201 LIKE xcce_t.xcce201, #本期投入數量
#          xcce202 LIKE xcce_t.xcce202, #本期本階投入金額
#          xcce202a LIKE xcce_t.xcce202a, #本期本階投入金額-材料
#          xcce202b LIKE xcce_t.xcce202b, #本期本階投入金額-人工
#          xcce202c LIKE xcce_t.xcce202c, #本期本階投入金額-加工
#          xcce202d LIKE xcce_t.xcce202d, #本期本階投入金額-制費一
#          xcce202e LIKE xcce_t.xcce202e, #本期本階投入金額-制費二
#          xcce202f LIKE xcce_t.xcce202f, #本期本階投入金額-制費三
#          xcce202g LIKE xcce_t.xcce202g, #本期本階投入金額-制費四
#          xcce202h LIKE xcce_t.xcce202h, #本期本階投入金額-制費五
#          xcce205 LIKE xcce_t.xcce205, #本期當站下線數量
#          xcce206 LIKE xcce_t.xcce206, #本期當站下線成本
#          xcce206a LIKE xcce_t.xcce206a, #本期當站下線成本-材料
#          xcce206b LIKE xcce_t.xcce206b, #本期當站下線成本-人工
#          xcce206c LIKE xcce_t.xcce206c, #本期當站下線成本-加工
#          xcce206d LIKE xcce_t.xcce206d, #本期當站下線成本-制費一
#          xcce206e LIKE xcce_t.xcce206e, #本期當站下線成本-制費二
#          xcce206f LIKE xcce_t.xcce206f, #本期當站下線成本-制費三
#          xcce206g LIKE xcce_t.xcce206g, #本期當站下線成本-制費四
#          xcce206h LIKE xcce_t.xcce206h, #本期當站下線成本-制費五
#          xcce207 LIKE xcce_t.xcce207, #本期一般退料數量
#          xcce208 LIKE xcce_t.xcce208, #本期一般退料成本
#          xcce208a LIKE xcce_t.xcce208a, #本期一般退料成本-材料
#          xcce208b LIKE xcce_t.xcce208b, #本期一般退料成本-人工
#          xcce208c LIKE xcce_t.xcce208c, #本期一般退料成本-加工
#          xcce208d LIKE xcce_t.xcce208d, #本期一般退料成本-制費一
#          xcce208e LIKE xcce_t.xcce208e, #本期一般退料成本-制費二
#          xcce208f LIKE xcce_t.xcce208f, #本期一般退料成本-制費三
#          xcce208g LIKE xcce_t.xcce208g, #本期一般退料成本-制費四
#          xcce208h LIKE xcce_t.xcce208h, #本期一般退料成本-制費五
#          xcce209 LIKE xcce_t.xcce209, #本期超領退數量
#          xcce210 LIKE xcce_t.xcce210, #本期超領退金額
#          xcce210a LIKE xcce_t.xcce210a, #本期超領退金額-材料
#          xcce210b LIKE xcce_t.xcce210b, #本期超領退金額-人工
#          xcce210c LIKE xcce_t.xcce210c, #本期超領退金額-加工
#          xcce210d LIKE xcce_t.xcce210d, #本期超領退金額-制費一
#          xcce210e LIKE xcce_t.xcce210e, #本期超領退金額-制費二
#          xcce210f LIKE xcce_t.xcce210f, #本期超領退金額-制費三
#          xcce210g LIKE xcce_t.xcce210g, #本期超領退金額-制費四
#          xcce210h LIKE xcce_t.xcce210h, #本期超領退金額-制費五
#          xcce301 LIKE xcce_t.xcce301, #本期轉出數量
#          xcce302 LIKE xcce_t.xcce302, #本期轉出金額
#          xcce302a LIKE xcce_t.xcce302a, #本期轉出金額-材料
#          xcce302b LIKE xcce_t.xcce302b, #本期轉出金額-人工
#          xcce302c LIKE xcce_t.xcce302c, #本期轉出金額-加工
#          xcce302d LIKE xcce_t.xcce302d, #本期轉出金額-制費一
#          xcce302e LIKE xcce_t.xcce302e, #本期轉出金額-制費二
#          xcce302f LIKE xcce_t.xcce302f, #本期轉出金額-制費三
#          xcce302g LIKE xcce_t.xcce302g, #本期轉出金額-制費四
#          xcce302h LIKE xcce_t.xcce302h, #本期轉出金額-制費五
#          xcce303 LIKE xcce_t.xcce303, #差異轉出數量
#          xcce304 LIKE xcce_t.xcce304, #差異轉出金額
#          xcce304a LIKE xcce_t.xcce304a, #差異轉出金額-材料
#          xcce304b LIKE xcce_t.xcce304b, #差異轉出金額-人工
#          xcce304c LIKE xcce_t.xcce304c, #差異轉出金額-加工
#          xcce304d LIKE xcce_t.xcce304d, #差異轉出金額-制費一
#          xcce304e LIKE xcce_t.xcce304e, #差異轉出金額-制費二
#          xcce304f LIKE xcce_t.xcce304f, #差異轉出金額-制費三
#          xcce304g LIKE xcce_t.xcce304g, #差異轉出金額-制費四
#          xcce304h LIKE xcce_t.xcce304h, #差異轉出金額-制費五
#          xcce307 LIKE xcce_t.xcce307, #盤差數量
#          xcce308 LIKE xcce_t.xcce308, #盤差金額
#          xcce308a LIKE xcce_t.xcce308a, #盤差金額-材料
#          xcce308b LIKE xcce_t.xcce308b, #盤差金額-人工
#          xcce308c LIKE xcce_t.xcce308c, #盤差金額-加工
#          xcce308d LIKE xcce_t.xcce308d, #盤差金額-制費一
#          xcce308e LIKE xcce_t.xcce308e, #盤差金額-制費二
#          xcce308f LIKE xcce_t.xcce308f, #盤差金額-制費三
#          xcce308g LIKE xcce_t.xcce308g, #盤差金額-制費四
#          xcce308h LIKE xcce_t.xcce308h, #盤差金額-制費五
#          xcce901 LIKE xcce_t.xcce901, #期末結存數量
#          xcce902 LIKE xcce_t.xcce902, #期末結存金額
#          xcce902a LIKE xcce_t.xcce902a, #期末結存金額-材料
#          xcce902b LIKE xcce_t.xcce902b, #期末結存金額-人工
#          xcce902c LIKE xcce_t.xcce902c, #期末結存金額-加工
#          xcce902d LIKE xcce_t.xcce902d, #期末結存金額-制費一
#          xcce902e LIKE xcce_t.xcce902e, #期末結存金額-制費二
#          xcce902f LIKE xcce_t.xcce902f, #期末結存金額-制費三
#          xcce902g LIKE xcce_t.xcce902g, #期末結存金額-制費四
#          xcce902h LIKE xcce_t.xcce902h, #期末結存金額-制費五
#          xccetime LIKE xcce_t.xccetime  #最近成本計算時間
#             END RECORD
#   #161109-00085#18-e mod
#   DEFINE l_sql           STRING
#   DEFINE l_rate          LIKE type_t.num26_10
#   DEFINE l_rate1         LIKE type_t.num26_10
#   DEFINE ld_date         DATETIME YEAR TO SECOND
#   #161109-00085#18-s mod
#   #DEFINE l_xced          RECORD LIKE xced_t.*   #161109-00085#18-s mark
#   DEFINE l_xced          RECORD  #成本憑證第三單身檔(在製人工費用科目設定)
#          xcedent LIKE xced_t.xcedent, #企業編號
#          xcedcomp LIKE xced_t.xcedcomp, #法人組織
#          xcedld LIKE xced_t.xcedld, #帳套
#          xceddocno LIKE xced_t.xceddocno, #單據編號
#          xcedseq LIKE xced_t.xcedseq, #項次
#          xced001 LIKE xced_t.xced001, #在製科目分類
#          xced101 LIKE xced_t.xced101, #科目編號
#          xced102 LIKE xced_t.xced102, #摘要
#          xced110 LIKE xced_t.xced110, #原因碼
#          xced111 LIKE xced_t.xced111, #收付款客商
#          xced112 LIKE xced_t.xced112, #客群
#          xced113 LIKE xced_t.xced113, #區域
#          xced114 LIKE xced_t.xced114, #成本中心
#          xced115 LIKE xced_t.xced115, #經營類別
#          xced116 LIKE xced_t.xced116, #通路
#          xced117 LIKE xced_t.xced117, #品類
#          xced118 LIKE xced_t.xced118, #品牌
#          xced119 LIKE xced_t.xced119, #專案編號
#          xced120 LIKE xced_t.xced120, #WBS
#          xced202 LIKE xced_t.xced202, #成本金額(本位幣一)
#          xced212 LIKE xced_t.xced212, #成本金額(本位幣二)
#          xced222 LIKE xced_t.xced222, #成本金額(本位幣三)
#          xced301 LIKE xced_t.xced301, #憑證編號
#          xced302 LIKE xced_t.xced302, #憑證項次
#          xced107 LIKE xced_t.xced107, #人員
#          xced108 LIKE xced_t.xced108, #部門
#          xced109 LIKE xced_t.xced109, #帳款對象
#          xced121 LIKE xced_t.xced121, #自由核算項1
#          xced122 LIKE xced_t.xced122, #自由核算項2
#          xced123 LIKE xced_t.xced123, #自由核算項3
#          xced124 LIKE xced_t.xced124, #自由核算項4
#          xced125 LIKE xced_t.xced125, #自由核算項5
#          xced126 LIKE xced_t.xced126, #自由核算項6
#          xced127 LIKE xced_t.xced127, #自由核算項7
#          xced128 LIKE xced_t.xced128, #自由核算項8
#          xced129 LIKE xced_t.xced129, #自由核算項9
#          xced130 LIKE xced_t.xced130  #自由核算項10
#             END RECORD
#   #161109-00085#18-e mod
#   DEFINE l_sfaa057       LIKE sfaa_t.sfaa057
#   DEFINE l_sfaasite      LIKE sfaa_t.sfaasite
#   DEFINE l_sfaa068       LIKE sfaa_t.sfaa068  #160816-00015#1 add
#
#   LET g_success = 'Y'
#   
#   INITIALIZE l_xcea.* TO NULL
#   INITIALIZE l_xceb.* TO NULL
#   INITIALIZE l_xcec.* TO NULL
#   INITIALIZE l_xccd.* TO NULL
#   INITIALIZE l_xcce.* TO NULL
#   INITIALIZE l_xced.* TO NULL
#   
#   
#   
#   #單頭
#   LET l_xcea.xceaownid = g_user
#   LET l_xcea.xceaowndp = g_dept
#   LET l_xcea.xceacrtid = g_user
#   LET l_xcea.xceacrtdp = g_dept 
#   LET ld_date = cl_get_current()
#   LET l_xcea.xceamodid = ""
#   LET l_xcea.xceamoddt = ""
#   CALL s_aooi200_fin_gen_docno(g_xcea_m.xceald,'','',g_xcea_m.xceadocno,g_xcea_m.xcea001,g_prog_name1)      #wujie 150214
#    RETURNING l_success,g_xcea_m.xceadocno
#   IF l_success  = 0  THEN
#      INITIALIZE g_errparam TO NULL
#      LET g_errparam.code = 'apm-00003'
#      LET g_errparam.extend = g_xcea_m.xceadocno
#      LET g_errparam.popup = TRUE
#      CALL cl_err()
#      LET g_success = 'N'
#      RETURN g_success
#   END IF
#   
#   INSERT INTO xcea_t (xceaent,xceald,xceacomp,xcea006,xceadocno,xcea001,xcea002,xcea004, 
#       xcea005,xcea003,xceastus,xceaownid,xceaowndp,xceacrtid,xceacrtdp,xceacrtdt, 
#       xceamodid,xceamoddt)
#   VALUES (g_enterprise,g_xcea_m.xceald,g_xcea_m.xceacomp,g_xcea_m.xcea006,g_xcea_m.xceadocno, 
#       g_xcea_m.xcea001,g_xcea002,g_xcea_m.xcea004,g_xcea_m.xcea005,g_xcea_m.xcea003, 
#       'N',l_xcea.xceaownid,l_xcea.xceaowndp,l_xcea.xceacrtid, 
#       l_xcea.xceacrtdp,ld_date,l_xcea.xceamodid,l_xcea.xceamoddt) 
#       
#   IF SQLCA.sqlcode THEN
#      INITIALIZE g_errparam TO NULL
#      LET g_errparam.code = SQLCA.sqlcode
#      LET g_errparam.extend = "g_xcea_m"
#      LET g_errparam.popup = TRUE
#      CALL cl_err()
#      LET g_success = 'N'
#      RETURN g_success
#   END IF
#   
#   #第一單身：在制主件成本档(xccd_t),拆件在制主件成本档(xcch_t)
#   #本位幣一
#   
#   #170113-00045#1 ---mark---(s)
##   LET l_sql = "SELECT xccd002,xccd006,xccd007,xccd008,",
##              #"       SUM(xccd303), SUM(xccd304), SUM(xccd304a),SUM(xccd304b),SUM(xccd304c),",   #160818-00013#1 mark
##              #"       SUM(xccd304d),SUM(xccd304e),SUM(xccd304f),SUM(xccd304g),SUM(xccd304h) ",   #160818-00013#1 mark
##               "       SUM(xccd303) *(-1), SUM(xccd304)*(-1), SUM(xccd304a)*(-1),SUM(xccd304b)*(-1),SUM(xccd304c)*(-1),",   #160818-00013#1 add
##               "       SUM(xccd304d)*(-1),SUM(xccd304e)*(-1),SUM(xccd304f) *(-1),SUM(xccd304g)*(-1),SUM(xccd304h)*(-1) ",   #160818-00013#1 add            
##               "  FROM xccd_t ",
##               "  WHERE xccdent = '",g_enterprise,"' AND xccdld = '",g_xcea_m.xceald,"'",
##               "    AND xccd003 = '",g_xcea_m.xcea003,"' AND xccd004 = ",g_xcea_m.xcea004,
##               "    AND xccd005 = ",g_xcea_m.xcea005,
##               "    AND xccd001 = '1'",
##               "    AND (xccd303 <> 0 OR xccd304 <> 0)",
##               " GROUP BY xccd002,xccd006,xccd007,xccd008 ",
##               " UNION ",
##               "SELECT xcch002,xcch006,xcch007,xcch008,",
##              #"       SUM(xcch303) , SUM(xcch304), SUM(xcch304a),SUM(xcch304b),SUM(xcch304c),",     #160818-00013#1 mark
##              #"       SUM(xcch304d),SUM(xcch304e),SUM(xcch304f),SUM(xcch304g),SUM(xcch304h) ",      #160818-00013#1 mark
##               "       SUM(xcch303) *(-1),SUM(xcch304) *(-1),SUM(xcch304a)*(-1),SUM(xcch304b)*(-1),SUM(xcch304c)*(-1),",  #160818-00013#1 add
##               "       SUM(xcch304d)*(-1),SUM(xcch304e)*(-1),SUM(xcch304f)*(-1),SUM(xcch304g)*(-1),SUM(xcch304h)*(-1) ",  #160818-00013#1 add               
##               "  FROM xcch_t ",
##               "  WHERE xcchent = '",g_enterprise,"' AND xcchld = '",g_xcea_m.xceald,"'",
##               "    AND xcch003 = '",g_xcea_m.xcea003,"' AND xcch004 = ",g_xcea_m.xcea004,
##               "    AND xcch005 = ",g_xcea_m.xcea005,
##               "    AND xcch001 = '1'",
##               "    AND (xcch303 <> 0 OR xcch304 <> 0)",
##               " GROUP BY xcch002,xcch006,xcch007,xcch008"
#   #170113-00045#1 ---mark---(e)
#   #170113-00045#1 ---add---(s)
#   LET l_sql = "SELECT xccd002,xccd006,xccd007,xccd008,",
#               "       SUM(xccd303*-1), SUM(xccd304*-1), SUM(xccd304a*-1),SUM(xccd304b*-1),SUM(xccd304c*-1),",
#               "       SUM(xccd304d*-1),SUM(xccd304e*-1),SUM(xccd304f*-1),SUM(xccd304g*-1),SUM(xccd304h*-1) ",
#               "  FROM xccd_t ",
#               "  WHERE xccdent = '",g_enterprise,"' AND xccdld = '",g_xcea_m.xceald,"'",
#               "    AND xccd003 = '",g_xcea_m.xcea003,"' AND xccd004 = ",g_xcea_m.xcea004,
#               "    AND xccd005 = ",g_xcea_m.xcea005,
#               "    AND xccd001 = '1'",
#               "    AND (xccd303 <> 0 OR xccd304 <> 0)",
#               " GROUP BY xccd002,xccd006,xccd007,xccd008 ",
#               " UNION ",
#               "SELECT xcch002,xcch006,xcch007,xcch008,",
#               "       SUM(xcch303*-1), SUM(xcch304*-1), SUM(xcch304a*-1),SUM(xcch304b*-1),SUM(xcch304c*-1),",
#               "       SUM(xcch304d*-1),SUM(xcch304e*-1),SUM(xcch304f*-1),SUM(xcch304g*-1),SUM(xcch304h*-1) ",
#               "  FROM xcch_t ",
#               "  WHERE xcchent = '",g_enterprise,"' AND xcchld = '",g_xcea_m.xceald,"'",
#               "    AND xcch003 = '",g_xcea_m.xcea003,"' AND xcch004 = ",g_xcea_m.xcea004,
#               "    AND xcch005 = ",g_xcea_m.xcea005,
#               "    AND xcch001 = '1'",
#               "    AND (xcch303 <> 0 OR xcch304 <> 0)",
#               " GROUP BY xcch002,xcch006,xcch007,xcch008"   
#   #170113-00045#1 ---add---(e)   
#   PREPARE xccd_prep1 FROM l_sql
#   DECLARE xccd_curs1 CURSOR FOR xccd_prep1
#                            
#   
#   #本位幣二  
#  #170113-00045#1 ---mark---(s)    
##  #LET l_sql = " SELECT SUM(xccd304), SUM(xccd304a),SUM(xccd304b),SUM(xccd304c),",                       #160818-00013#1 mark
##  #            "        SUM(xccd304d),SUM(xccd304e),SUM(xccd304f),SUM(xccd304g),SUM(xccd304h) ",         #160818-00013#1 mark
##   LET l_sql = " SELECT SUM(xccd304) *(-1),SUM(xccd304a)*(-1),SUM(xccd304b)*(-1),SUM(xccd304c)*(-1),",                     #160818-00013#1 add
##               "        SUM(xccd304d)*(-1),SUM(xccd304e)*(-1),SUM(xccd304f)*(-1),SUM(xccd304g)*(-1),SUM(xccd304h)*(-1) ",  #160818-00013#1 add             
##               "        FROM xccd_t ", 
##               "  WHERE xccdent = '",g_enterprise,"' AND xccdld = '",g_xcea_m.xceald,"'",
##               "    AND xccd003 = '",g_xcea_m.xcea003,"' AND xccd004 = ",g_xcea_m.xcea004,
##               "    AND xccd005 = ",g_xcea_m.xcea005,
##               "    AND xccd002 = ? AND xccd006 = ? ",
##               "    AND xccd007 = ? AND xccd008 = ? ",
##               "    AND (xccd303 <> 0 OR xccd304 <> 0)",
##               "    AND xccd001 = '2' ",
##               " UNION ",
##              #" SELECT SUM(xcch304), SUM(xcch304a),SUM(xcch304b),SUM(xcch304c),",                  #160818-00013#1 mark
##              #"        SUM(xcch304d),SUM(xcch304e),SUM(xcch304f),SUM(xcch304g),SUM(xcch304h) ",    #160818-00013#1 mark
##               " SELECT SUM(xcch304) *(-1),SUM(xcch304a)*(-1),SUM(xcch304b)*(-1),SUM(xcch304c)*(-1),",                     #160818-00013#1 add
##               "        SUM(xcch304d)*(-1),SUM(xcch304e)*(-1),SUM(xcch304f)*(-1),SUM(xcch304g)*(-1),SUM(xcch304h)*(-1) ",  #160818-00013#1 add               
##               "  FROM xcch_t ",
##               "  WHERE xcchent = '",g_enterprise,"' AND xcchld = '",g_xcea_m.xceald,"'",
##               "    AND xcch003 = '",g_xcea_m.xcea003,"' AND xcch004 = ",g_xcea_m.xcea004,
##               "    AND xcch005 = ",g_xcea_m.xcea005,
##               "    AND xcch002 = ? AND xcch006 = ? ",
##               "    AND xccd007 = ? AND xccd008 = ? ",
##               "    AND (xcch303 <> 0 OR xcch304 <> 0)",
##               "    AND xcch001 = '2'"
#   #170113-00045#1 ---mark---(e)                
#   #170113-00045#1 ---add---(s)
#   LET l_sql = " SELECT SUM(xccd304*-1), SUM(xccd304a*-1),SUM(xccd304b*-1),SUM(xccd304c*-1),",
#               "        SUM(xccd304d*-1),SUM(xccd304e*-1),SUM(xccd304f*-1),SUM(xccd304g*-1),SUM(xccd304h*-1) ",
#               "        FROM xccd_t ", 
#               "  WHERE xccdent = '",g_enterprise,"' AND xccdld = '",g_xcea_m.xceald,"'",
#               "    AND xccd003 = '",g_xcea_m.xcea003,"' AND xccd004 = ",g_xcea_m.xcea004,
#               "    AND xccd005 = ",g_xcea_m.xcea005,
#               "    AND xccd002 = ? AND xccd006 = ? ",
#               "    AND xccd007 = ? AND xccd008 = ? ",
#               "    AND (xccd303 <> 0 OR xccd304 <> 0)",
#               "    AND xccd001 = '2' ",
#               " UNION ",
#               " SELECT SUM(xcch304*-1), SUM(xcch304a*-1),SUM(xcch304b*-1),SUM(xcch304c*-1),",
#               "        SUM(xcch304d*-1),SUM(xcch304e*-1),SUM(xcch304f*-1),SUM(xcch304g*-1),SUM(xcch304h*-1) ",
#               "  FROM xcch_t ",
#               "  WHERE xcchent = '",g_enterprise,"' AND xcchld = '",g_xcea_m.xceald,"'",
#               "    AND xcch003 = '",g_xcea_m.xcea003,"' AND xcch004 = ",g_xcea_m.xcea004,
#               "    AND xcch005 = ",g_xcea_m.xcea005,
#               "    AND xcch002 = ? AND xcch006 = ? ",
#               "    AND xccd007 = ? AND xccd008 = ? ",
#               "    AND (xcch303 <> 0 OR xcch304 <> 0)",
#               "    AND xcch001 = '2'"   
#   #170113-00045#1 ---add---(e)    
#   PREPARE xccd_prep2_3 FROM l_sql
#   DECLARE xccd_curs2_3 CURSOR FOR xccd_prep2_3
#   
#   #本位幣三
#   #170113-00045#1 ---mark---(s)    
##  #LET l_sql = " SELECT SUM(xccd304), SUM(xccd304a),SUM(xccd304b),SUM(xccd304c),",                       #160818-00013#1 mark
##  #            "        SUM(xccd304d),SUM(xccd304e),SUM(xccd304f),SUM(xccd304g),SUM(xccd304h) ",         #160818-00013#1 mark  
##   LET l_sql = " SELECT SUM(xccd304) *(-1),SUM(xccd304a)*(-1),SUM(xccd304b)*(-1),SUM(xccd304c)*(-1),",                       #160818-00013#1 add
##               "        SUM(xccd304d)*(-1),SUM(xccd304e)*(-1),SUM(xccd304f)*(-1),SUM(xccd304g)*(-1),SUM(xccd304h)*(-1) ",    #160818-00013#1 add
##               
##               "        FROM xccd_t ", 
##               "  WHERE xccdent = '",g_enterprise,"' AND xccdld = '",g_xcea_m.xceald,"'",
##               "    AND xccd003 = '",g_xcea_m.xcea003,"' AND xccd004 = ",g_xcea_m.xcea004,
##               "    AND xccd005 = ",g_xcea_m.xcea005,
##               "    AND xccd002 = ? AND xccd006 = ? ",
##               "    AND xccd007 = ? AND xccd008 = ? ",
##               "    AND xccd001 = '3' ",
##               " UNION ",
##              #" SELECT SUM(xcch304), SUM(xcch304a),SUM(xcch304b),SUM(xcch304c),",                    #160818-00013#1 mark
##              #"        SUM(xcch304d),SUM(xcch304e),SUM(xcch304f),SUM(xcch304g),SUM(xcch304h) ",      #160818-00013#1 mark
##               " SELECT SUM(xcch304) *(-1),SUM(xcch304a)*(-1),SUM(xcch304b)*(-1),SUM(xcch304c)*(-1),",                     #160818-00013#1 add
##               "        SUM(xcch304d)*(-1),SUM(xcch304e)*(-1),SUM(xcch304f)*(-1),SUM(xcch304g)*(-1),SUM(xcch304h)*(-1)",   #160818-00013#1 add            
##               "  FROM xcch_t ",
##               "  WHERE xcchent = '",g_enterprise,"' AND xcchld = '",g_xcea_m.xceald,"'",
##               "    AND xcch003 = '",g_xcea_m.xcea003,"' AND xcch004 = ",g_xcea_m.xcea004,
##               "    AND xcch005 = ",g_xcea_m.xcea005,
##               "    AND xcch002 = ? AND xcch006 = ? ",
##               "    AND xccd007 = ? AND xccd008 = ? ",
##               "    AND (xcch303 <> 0 OR xcch304 <> 0)",
##               "    AND xcch001 = '3'"
#   #170113-00045#1 ---mark---(e)                
#   #170113-00045#1 ---add---(s) 
#   LET l_sql = " SELECT SUM(xccd304*-1), SUM(xccd304a*-1),SUM(xccd304b*-1),SUM(xccd304c*-1),",
#               "        SUM(xccd304d*-1),SUM(xccd304e*-1),SUM(xccd304f*-1),SUM(xccd304g*-1),SUM(xccd304h*-1) ",
#               "        FROM xccd_t ", 
#               "  WHERE xccdent = '",g_enterprise,"' AND xccdld = '",g_xcea_m.xceald,"'",
#               "    AND xccd003 = '",g_xcea_m.xcea003,"' AND xccd004 = ",g_xcea_m.xcea004,
#               "    AND xccd005 = ",g_xcea_m.xcea005,
#               "    AND xccd002 = ? AND xccd006 = ? ",
#               "    AND xccd007 = ? AND xccd008 = ? ",
#               "    AND xccd001 = '3' ",
#               " UNION ",
#               " SELECT SUM(xcch304*-1), SUM(xcch304a*-1),SUM(xcch304b*-1),SUM(xcch304c*-1),",
#               "        SUM(xcch304d*-1),SUM(xcch304e*-1),SUM(xcch304f*-1),SUM(xcch304g*-1),SUM(xcch304h*-1) ",
#               "  FROM xcch_t ",
#               "  WHERE xcchent = '",g_enterprise,"' AND xcchld = '",g_xcea_m.xceald,"'",
#               "    AND xcch003 = '",g_xcea_m.xcea003,"' AND xcch004 = ",g_xcea_m.xcea004,
#               "    AND xcch005 = ",g_xcea_m.xcea005,
#               "    AND xcch002 = ? AND xcch006 = ? ",
#               "    AND xccd007 = ? AND xccd008 = ? ",
#               "    AND (xcch303 <> 0 OR xcch304 <> 0)",
#               "    AND xcch001 = '3'"   
#   #170113-00045#1 ---add---(e)    
#   PREPARE xccd_prep3_3 FROM l_sql
#   DECLARE xccd_curs3_3 CURSOR FOR xccd_prep3_3
#   
#   #第二單身：在制元件成本档(xcce_t),拆件在制元件成本档(xcci_t)
#   #本位幣一
#   #170113-00045#1 ---mark---(s)   
##   LET l_sql = "SELECT xcce002,xcce006,xcce007,xcce008,xcce009,",
##               "       SUM(xcce303), SUM(xcce304), SUM(xcce304a),SUM(xcce304b),SUM(xcce304c),",
##               "       SUM(xcce304d),SUM(xcce304e),SUM(xcce304f),SUM(xcce304g),SUM(xcce304h) ",
##               "  FROM xcce_t ",
##               "  WHERE xcceent = '",g_enterprise,"' AND xcceld = '",g_xcea_m.xceald,"'",
##               "    AND xcce003 = '",g_xcea_m.xcea003,"' AND xcce004 = ",g_xcea_m.xcea004,
##               "    AND xcce005 = ",g_xcea_m.xcea005,
##               "    AND xcce001 = '1'",
##               "    AND (xcce303 <> 0 OR xcce304 <> 0)",
##               " GROUP BY xcce002,xcce006,xcce007,xcce008,xcce009 ",
##               " UNION ",
##               "SELECT xcci002,xcci006,xcci007,xcci008,xcci009,",
##               "       SUM(xcci303), SUM(xcci304), SUM(xcci304a),SUM(xcci304b),SUM(xcci304c),",
##               "       SUM(xcci304d),SUM(xcci304e),SUM(xcci304f),SUM(xcci304g),SUM(xcci304h) ",
##               "  FROM xcci_t ",
##               "  WHERE xccient = '",g_enterprise,"' AND xccild = '",g_xcea_m.xceald,"'",
##               "    AND xcci003 = '",g_xcea_m.xcea003,"' AND xcci004 = ",g_xcea_m.xcea004,
##               "    AND xcci005 = ",g_xcea_m.xcea005,
##               "    AND xcci001 = '1'",
##               "    AND (xcci303 <> 0 OR xcci304 <> 0)",
##               " GROUP BY xcci002,xcci006,xcci007,xcci008,xcci009"  
#   #170113-00045#1 ---mark---(e)
#   #170113-00045#1 ---add---(s)
#   LET l_sql = "SELECT xcce002,xcce006,xcce007,xcce008,xcce009,",
#               "       SUM(xcce303*-1), SUM(xcce304*-1), SUM(xcce304a*-1),SUM(xcce304b*-1),SUM(xcce304c*-1),",
#               "       SUM(xcce304d*-1),SUM(xcce304e*-1),SUM(xcce304f*-1),SUM(xcce304g*-1),SUM(xcce304h*-1) ",
#               "  FROM xcce_t ",
#               "  WHERE xcceent = '",g_enterprise,"' AND xcceld = '",g_xcea_m.xceald,"'",
#               "    AND xcce003 = '",g_xcea_m.xcea003,"' AND xcce004 = ",g_xcea_m.xcea004,
#               "    AND xcce005 = ",g_xcea_m.xcea005,
#               "    AND xcce001 = '1'",
#               "    AND (xcce303 <> 0 OR xcce304 <> 0)",             
#               " GROUP BY xcce002,xcce006,xcce007,xcce008,xcce009 ",
#               " UNION ",
#               "SELECT xcci002,xcci006,xcci007,xcci008,xcci009,",
#               "       SUM(xcci303*-1), SUM(xcci304*-1), SUM(xcci304a*-1),SUM(xcci304b*-1),SUM(xcci304c*-1),",
#               "       SUM(xcci304d*-1),SUM(xcci304e*-1),SUM(xcci304f*-1),SUM(xcci304g*-1),SUM(xcci304h*-1) ",
#               "  FROM xcci_t ",
#               "  WHERE xccient = '",g_enterprise,"' AND xccild = '",g_xcea_m.xceald,"'",
#               "    AND xcci003 = '",g_xcea_m.xcea003,"' AND xcci004 = ",g_xcea_m.xcea004,
#               "    AND xcci005 = ",g_xcea_m.xcea005,
#               "    AND xcci001 = '1'",
#               "    AND (xcci303 <> 0 OR xcci304 <> 0)",
#               " GROUP BY xcci002,xcci006,xcci007,xcci008,xcci009"    
#   #170113-00045#1 ---add---(e)   
#   PREPARE xccd_prep4 FROM l_sql
#   DECLARE xccd_curs4 CURSOR FOR xccd_prep4
#   
#   #本位幣二
#   #170113-00045#1 ---mark---(s)    
##   LET l_sql = "SELECT SUM(xcce304), SUM(xcce304a),SUM(xcce304b),SUM(xcce304c),",
##               "       SUM(xcce304d),SUM(xcce304e),SUM(xcce304f),SUM(xcce304g),SUM(xcce304h) ",
##               "  FROM xcce_t ",
##               "  WHERE xcceent = '",g_enterprise,"' AND xcceld = '",g_xcea_m.xceald,"'",
##               "    AND xcce003 = '",g_xcea_m.xcea003,"' AND xcce004 = ",g_xcea_m.xcea004,
##               "    AND xcce005 = ",g_xcea_m.xcea005,
##               "    AND xcce002 = ? AND xcce006 = ? AND xcce007 = ? AND xcce008 = ? ",
##               "    AND xcce009 = ?  ",
##               "    AND (xcce303 <> 0 OR xcce304 <> 0)",
##               "    AND xcce001 = '2'",
##               " UNION ",
##               "SELECT SUM(xcci304), SUM(xcci304a),SUM(xcci304b),SUM(xcci304c),",
##               "       SUM(xcci304d),SUM(xcci304e),SUM(xcci304f),SUM(xcci304g),SUM(xcci304h) ",
##               "  FROM xcci_t ",
##               "  WHERE xccient = '",g_enterprise,"' AND xccild = '",g_xcea_m.xceald,"'",
##               "    AND xcci003 = '",g_xcea_m.xcea003,"' AND xcci004 = ",g_xcea_m.xcea004,
##               "    AND xcci005 = ",g_xcea_m.xcea005,
##               "    AND xcci002 = ? AND xcci006 = ? AND xcci007 = ? ",
##               "    AND xcci008 = ?  AND xcci009 = ? ",
##               "    AND (xcci303 <> 0 OR xcci304 <> 0)",
##               "    AND xcci001 = '2'"
#   #170113-00045#1 ---mark---(e) 
#   #170113-00045#1 ---add---(s)
#   LET l_sql = "SELECT SUM(xcce304*-1), SUM(xcce304a*-1),SUM(xcce304b*-1),SUM(xcce304c*-1),",
#               "       SUM(xcce304d*-1),SUM(xcce304e*-1),SUM(xcce304f*-1),SUM(xcce304g*-1),SUM(xcce304h*-1) ",
#               "  FROM xcce_t ",
#               "  WHERE xcceent = '",g_enterprise,"' AND xcceld = '",g_xcea_m.xceald,"'",
#               "    AND xcce003 = '",g_xcea_m.xcea003,"' AND xcce004 = ",g_xcea_m.xcea004,
#               "    AND xcce005 = ",g_xcea_m.xcea005,
#               "    AND xcce002 = ? AND xcce006 = ? AND xcce007 = ? AND xcce008 = ? ",
#               "    AND xcce009 = ?  ",
#               "    AND (xcce303 <> 0 OR xcce304 <> 0)",
#               "    AND xcce001 = '2'",
#               " UNION ",
#               "SELECT SUM(xcci304*-1), SUM(xcci304a*-1),SUM(xcci304b*-1),SUM(xcci304c*-1),",
#               "       SUM(xcci304d*-1),SUM(xcci304e*-1),SUM(xcci304f*-1),SUM(xcci304g*-1),SUM(xcci304h*-1) ",
#               "  FROM xcci_t ",
#               "  WHERE xccient = '",g_enterprise,"' AND xccild = '",g_xcea_m.xceald,"'",
#               "    AND xcci003 = '",g_xcea_m.xcea003,"' AND xcci004 = ",g_xcea_m.xcea004,
#               "    AND xcci005 = ",g_xcea_m.xcea005,
#               "    AND xcci002 = ? AND xcci006 = ? AND xcci007 = ? ",
#               "    AND xcci008 = ?  AND xcci009 = ? ",
#               "    AND (xcci303 <> 0 OR xcci304 <> 0)",
#               "    AND xcci001 = '2'"    
#   #170113-00045#1 ---add---(e) 
#   PREPARE xccd_prep5 FROM l_sql
#   DECLARE xccd_curs5 CURSOR FOR xccd_prep5
#   
#   #本位幣三
#   #170113-00045#1 ---mark---(s)    
##   LET l_sql = "SELECT SUM(xcce304), SUM(xcce304a),SUM(xcce304b),SUM(xcce304c),",
##               "       SUM(xcce304d),SUM(xcce304e),SUM(xcce304f),SUM(xcce304g),SUM(xcce304h) ",
##               "  FROM xcce_t ",
##               " WHERE xcceent = '",g_enterprise,"' AND xcceld = '",g_xcea_m.xceald,"'",
##               "   AND xcce003 = '",g_xcea_m.xcea003,"' AND xcce004 = ",g_xcea_m.xcea004,
##               "   AND xcce005 = ",g_xcea_m.xcea005,
##               "   AND xcce002 = ? AND xcce006 = ? AND xcce007 = ? ",
##               "   AND xcce008 = ? AND xcce009 = ?  ",
##               "    AND (xcce303 <> 0 OR xcce304 <> 0)",
##               "   AND xcce001 = '3'",
##               " UNION ",
##               "SELECT SUM(xcci304), SUM(xcci304a),SUM(xcci304b),SUM(xcci304c),",
##               "       SUM(xcci304d),SUM(xcci304e),SUM(xcci304f),SUM(xcci304g),SUM(xcci304h) ",
##               "  FROM xcci_t ",
##               " WHERE xccient = '",g_enterprise,"' AND xccild = '",g_xcea_m.xceald,"'",
##               "   AND xcci003 = '",g_xcea_m.xcea003,"' AND xcci004 = ",g_xcea_m.xcea004,
##               "   AND xcci005 = ",g_xcea_m.xcea005,
##               "   AND xcci002 = ? AND xcci006 = ? AND xcci007 = ? ",
##               "   AND xcci008 = ? AND xcci009 = ?  ",
##               "    AND (xcci303 <> 0 OR xcci304 <> 0)",
##               "   AND xcci001 = '3'"
#   #170113-00045#1 ---mark---(e)
#   #170113-00045#1 ---add---(s)
#   LET l_sql = "SELECT SUM(xcce304*-1), SUM(xcce304a*-1),SUM(xcce304b*-1),SUM(xcce304c*-1),",
#               "       SUM(xcce304d*-1),SUM(xcce304e*-1),SUM(xcce304f*-1),SUM(xcce304g*-1),SUM(xcce304h*-1) ",
#               "  FROM xcce_t ",
#               " WHERE xcceent = '",g_enterprise,"' AND xcceld = '",g_xcea_m.xceald,"'",
#               "   AND xcce003 = '",g_xcea_m.xcea003,"' AND xcce004 = ",g_xcea_m.xcea004,
#               "   AND xcce005 = ",g_xcea_m.xcea005,
#               "   AND xcce002 = ? AND xcce006 = ? AND xcce007 = ? ",
#               "   AND xcce008 = ? AND xcce009 = ?  ",
#               "    AND (xcce303 <> 0 OR xcce304 <> 0)",
#               "   AND xcce001 = '3'",
#               " UNION ",
#               "SELECT SUM(xcci304*-1), SUM(xcci304a*-1),SUM(xcci304b*-1),SUM(xcci304c*-1),",
#               "       SUM(xcci304d*-1),SUM(xcci304e*-1),SUM(xcci304f*-1),SUM(xcci304g*-1),SUM(xcci304h*-1) ",
#               "  FROM xcci_t ",
#               " WHERE xccient = '",g_enterprise,"' AND xccild = '",g_xcea_m.xceald,"'",
#               "   AND xcci003 = '",g_xcea_m.xcea003,"' AND xcci004 = ",g_xcea_m.xcea004,
#               "   AND xcci005 = ",g_xcea_m.xcea005,
#               "   AND xcci002 = ? AND xcci006 = ? AND xcci007 = ? ",
#               "   AND xcci008 = ? AND xcci009 = ?  ",
#               "    AND (xcci303 <> 0 OR xcci304 <> 0)",
#               "   AND xcci001 = '3'"   
#   #170113-00045#1 ---add---(e)    
#   PREPARE xccd_prep6 FROM l_sql
#   DECLARE xccd_curs6 CURSOR FOR xccd_prep6
#   
##   #第三單身
##   #xcec_t中DL+OH_SUB元件彙總-xced   
##   LET l_sql = " SELECT xcec102,xcec114,xcec113,xcec111,xcec117,xcec119,xcec120,",
##               "        SUM(xcec202b),SUM(xcec202c),SUM(xcec202d),SUM(xcec202e),",
##               "        SUM(xcec202f),SUM(xcec202g),SUM(xcec202h), ",
##               "        SUM(xcec212b),SUM(xcec212c),SUM(xcec212d),SUM(xcec212e),",
##               "        SUM(xcec212f),SUM(xcec212g),SUM(xcec212h), ",
##               "        SUM(xcec222b),SUM(xcec222c),SUM(xcec222d),SUM(xcec222e),",
##               "        SUM(xcec222f),SUM(xcec222g),SUM(xcec222h) ",
##               "   FROM xcec_t",
##               "  WHERE xcecent = '",g_enterprise,"' AND xcecld = '",g_xcea_m.xceald,"'",
##               "    AND xcecdocno = '",g_xcea_m.xceadocno,"'", 
##               "    AND xcec004 = 'DL+OH+SUB' ",
##               "  GROUP BY xcec102,xcec114,xcec113,xcec111,xcec117,xcec119,xcec120 ",
##               "  ORDER BY xcec102,xcec114,xcec113,xcec111,xcec117,xcec119,xcec120 "
##   PREPARE xcec_prep_3 FROM l_sql
##   DECLARE xcec_curs_3 CURSOR FOR xcec_prep_3
#   
#   
#   #第一單身
#   FOREACH xccd_curs1 INTO l_xccd.xccd002, l_xccd.xccd006, l_xccd.xccd007,l_xccd.xccd008,
#                           l_xccd.xccd303, l_xccd.xccd304, l_xccd.xccd304a,l_xccd.xccd304b,l_xccd.xccd304c,
#                           l_xccd.xccd304d,l_xccd.xccd304e,l_xccd.xccd304f,l_xccd.xccd304g,l_xccd.xccd304h
#
#      INITIALIZE l_xceb.* TO NULL
#      
#      SELECT MAX(xcebseq) INTO l_xceb.xcebseq FROM xceb_t
#       WHERE xcebent = g_enterprise AND xcebld = g_xcea_m.xceald
#         AND xcebdocno = g_xcea_m.xceadocno
#      IF cl_null(l_xceb.xcebseq) OR l_xceb.xcebseq = 0 THEN
#         LET l_xceb.xcebseq = 1
#      ELSE
#         LET l_xceb.xcebseq = l_xceb.xcebseq + 1
#      END IF 
#      
#      #工單類型   廠內/委外
#      LET l_sfaa057 = ''
#      LET l_sfaasite = ''
#      LET l_sfaa068 = '' #160816-00015#1 add
#      SELECT sfaa003,sfaa057,sfaa009,sfaasite,sfaa028,sfaa029,
#             sfaa068                                             #160816-00015#1 add
#        INTO l_xceb.xceb003,l_sfaa057,l_xceb.xceb111,l_sfaasite,l_xceb.xceb119,l_xceb.xceb120,
#             l_sfaa068                                           #160816-00015#1 add 
#        FROM sfaa_t WHERE sfaaent = g_enterprise AND sfaadocno = l_xccd.xccd006
#      
#      #生产成本-差异科目
#      #目前没有，先空着   #wujie 150214
#      LET l_xceb.xceb101 = ''
#
#      IF cl_null(l_xceb.xceb101) THEN
#         CALL s_fin_get_account(g_xcea_m.xceald,'60','8912','4') RETURNING l_success,l_xceb.xceb101,l_errno
#      END IF
#      
#      IF l_sfaa057 = '2' THEN   #委外
#         #客群/區域
#         SELECT pmaa090,pmaa241 INTO l_xceb.xceb112,l_xceb.xceb113 
#           FROM pmaa_t 
#          WHERE pmaaent = g_enterprise 
#            AND pmaa001 = l_xceb.xceb111
#         
#         
#      ELSE   #廠內
#         LET l_xceb.xceb111 = ' '
#         #客群
#         LET l_xceb.xceb112 = ' '
#         #區域
#         SELECT ooef153 INTO l_xceb.xceb113 FROM ooef_t
#          WHERE ooefent = g_enterprise
#            AND ooef001 = l_sfaasite
#      END IF 
#      
#      #品類
#      SELECT imag011 INTO l_xceb.xceb117 
#        FROM imag_t 
#       WHERE imagent = g_enterprise 
#         AND imagsite = g_xcea_m.xceacomp
#         AND imag001 = l_xccd.xccd007
#      
#      LET l_xceb.xcebent   = g_enterprise
#      LET l_xceb.xcebcomp  = g_xcea_m.xceacomp
#      LET l_xceb.xcebld    = g_xcea_m.xceald     
#      LET l_xceb.xcebdocno = g_xcea_m.xceadocno
#      LET l_xceb.xceb001   = l_xccd.xccd006 
#      LET l_xceb.xceb002   = ''
#      LET l_xceb.xceb004   = l_xccd.xccd007 
#      LET l_xceb.xceb005   = l_xccd.xccd008      
#      LET l_xceb.xceb102   = '' 
#      LET l_xceb.xceb102   = ''
#      LET l_xceb.xceb103   = l_xccd.xccd002
#      LET l_xceb.xceb110   = ''
#      LET l_xceb.xceb114   = ''
#      LET l_xceb.xceb115   = ' '
#      LET l_xceb.xceb116   = ' '  
#      LET l_xceb.xceb118   = ' '
#      LET l_xceb.xceb201   = l_xccd.xccd303
#      LET l_xceb.xceb202   = l_xccd.xccd304
#      LET l_xceb.xceb202a  = l_xccd.xccd304a
#      LET l_xceb.xceb202b  = l_xccd.xccd304b
#      LET l_xceb.xceb202c  = l_xccd.xccd304c
#      LET l_xceb.xceb202d  = l_xccd.xccd304d
#      LET l_xceb.xceb202e  = l_xccd.xccd304e
#      LET l_xceb.xceb202f  = l_xccd.xccd304f
#      LET l_xceb.xceb202g  = l_xccd.xccd304g
#      LET l_xceb.xceb202h  = l_xccd.xccd304h
#      LET l_xceb.xceb301   = ''
#      LET l_xceb.xceb302   = ''
#      
#      
#      IF cl_null(l_xceb.xceb202a) THEN LET l_xceb.xceb202a = 0 END IF
#      IF cl_null(l_xceb.xceb202b) THEN LET l_xceb.xceb202b = 0 END IF
#      IF cl_null(l_xceb.xceb202c) THEN LET l_xceb.xceb202c = 0 END IF
#      IF cl_null(l_xceb.xceb202d) THEN LET l_xceb.xceb202d = 0 END IF
#      IF cl_null(l_xceb.xceb202e) THEN LET l_xceb.xceb202e = 0 END IF
#      IF cl_null(l_xceb.xceb202f) THEN LET l_xceb.xceb202f = 0 END IF
#      IF cl_null(l_xceb.xceb202g) THEN LET l_xceb.xceb202g = 0 END IF
#      IF cl_null(l_xceb.xceb202h) THEN LET l_xceb.xceb202h = 0 END IF
#      IF cl_null(l_xceb.xceb202)  THEN LET l_xceb.xceb202  = 0 END IF      
#      IF cl_null(l_xceb.xceb201)  THEN LET l_xceb.xceb201  = 0 END IF        
#
##小于0的要变成正数
#      #mark--2015/11/10 By shiun--(S)
##      IF l_xceb.xceb202a < 0 THEN LET l_xceb.xceb202a = l_xceb.xceb202a * -1 END IF
##      IF l_xceb.xceb202b < 0 THEN LET l_xceb.xceb202b = l_xceb.xceb202b * -1 END IF
##      IF l_xceb.xceb202c < 0 THEN LET l_xceb.xceb202c = l_xceb.xceb202c * -1 END IF
##      IF l_xceb.xceb202d < 0 THEN LET l_xceb.xceb202d = l_xceb.xceb202d * -1 END IF
##      IF l_xceb.xceb202e < 0 THEN LET l_xceb.xceb202e = l_xceb.xceb202e * -1 END IF
##      IF l_xceb.xceb202f < 0 THEN LET l_xceb.xceb202f = l_xceb.xceb202f * -1 END IF
##      IF l_xceb.xceb202g < 0 THEN LET l_xceb.xceb202g = l_xceb.xceb202g * -1 END IF
##      IF l_xceb.xceb202h < 0 THEN LET l_xceb.xceb202h = l_xceb.xceb202h * -1 END IF
##      IF l_xceb.xceb202  < 0 THEN LET l_xceb.xceb202  = l_xceb.xceb202  * -1 END IF      
##      IF l_xceb.xceb201  < 0 THEN LET l_xceb.xceb201  = l_xceb.xceb201  * -1 END IF 
#      #mark--2015/11/10 By shiun--(E)
#      IF g_glaa015 = 'Y' THEN 
#         OPEN xccd_curs2_3 USING  l_xccd.xccd002, l_xccd.xccd006, l_xccd.xccd007,l_xccd.xccd008,
#                                  l_xccd.xccd002, l_xccd.xccd006, l_xccd.xccd007,l_xccd.xccd008         
#         FETCH xccd_curs2_3 INTO l_xceb.xceb212, l_xceb.xceb212a,l_xceb.xceb212b,l_xceb.xceb212c,
#                               l_xceb.xceb212d,l_xceb.xceb212e,l_xceb.xceb212f,l_xceb.xceb212g,l_xceb.xceb212h
#        #EXECUTE xccd_curs2 USING l_xceb.xceb103,l_xceb.xceb001,l_xceb.xceb103,l_xceb.xceb001 
#        #                    INTO l_xceb.xceb212, l_xceb.xceb212a,l_xceb.xceb212b,l_xceb.xceb212c,
#        #                         l_xceb.xceb212d,l_xceb.xceb212e,l_xceb.xceb212f,l_xceb.xceb212g,l_xceb.xceb212h
#         IF cl_null(l_xceb.xceb212a) THEN LET l_xceb.xceb212a = 0 END IF
#         IF cl_null(l_xceb.xceb212b) THEN LET l_xceb.xceb212b = 0 END IF
#         IF cl_null(l_xceb.xceb212c) THEN LET l_xceb.xceb212c = 0 END IF
#         IF cl_null(l_xceb.xceb212d) THEN LET l_xceb.xceb212d = 0 END IF
#         IF cl_null(l_xceb.xceb212e) THEN LET l_xceb.xceb212e = 0 END IF
#         IF cl_null(l_xceb.xceb212f) THEN LET l_xceb.xceb212f = 0 END IF
#         IF cl_null(l_xceb.xceb212g) THEN LET l_xceb.xceb212g = 0 END IF
#         IF cl_null(l_xceb.xceb212h) THEN LET l_xceb.xceb212h = 0 END IF
#         IF cl_null(l_xceb.xceb212)  THEN LET l_xceb.xceb212  = 0 END IF
#      ELSE
#         LET l_xceb.xceb212a = 0
#         LET l_xceb.xceb212b = 0
#         LET l_xceb.xceb212c = 0
#         LET l_xceb.xceb212d = 0
#         LET l_xceb.xceb212e = 0
#         LET l_xceb.xceb212f = 0
#         LET l_xceb.xceb212g = 0
#         LET l_xceb.xceb212h = 0
#         LET l_xceb.xceb212  = 0     
#      END IF
#     #160818-00013#1-s-mark
#     ##小于0的要变成正数
#     #IF l_xceb.xceb212a < 0 THEN LET l_xceb.xceb212a = l_xceb.xceb212a * -1 END IF
#     #IF l_xceb.xceb212b < 0 THEN LET l_xceb.xceb212b = l_xceb.xceb212b * -1 END IF
#     #IF l_xceb.xceb212c < 0 THEN LET l_xceb.xceb212c = l_xceb.xceb212c * -1 END IF
#     #IF l_xceb.xceb212d < 0 THEN LET l_xceb.xceb212d = l_xceb.xceb212d * -1 END IF
#     #IF l_xceb.xceb212e < 0 THEN LET l_xceb.xceb212e = l_xceb.xceb212e * -1 END IF
#     #IF l_xceb.xceb212f < 0 THEN LET l_xceb.xceb212f = l_xceb.xceb212f * -1 END IF
#     #IF l_xceb.xceb212g < 0 THEN LET l_xceb.xceb212g = l_xceb.xceb212g * -1 END IF
#     #IF l_xceb.xceb212h < 0 THEN LET l_xceb.xceb212h = l_xceb.xceb212h * -1 END IF
#     #IF l_xceb.xceb212  < 0 THEN LET l_xceb.xceb212  = l_xceb.xceb212  * -1 END IF      
#     #160818-00013#1-e-mark
#      IF g_glaa019 = 'Y' THEN 
#         OPEN xccd_curs3_3 USING l_xccd.xccd002, l_xccd.xccd006, l_xccd.xccd007,l_xccd.xccd008,
#                                 l_xccd.xccd002, l_xccd.xccd006, l_xccd.xccd007,l_xccd.xccd008
#         FETCH xccd_curs3_3 INTO l_xceb.xceb222, l_xceb.xceb222a,l_xceb.xceb222b,l_xceb.xceb222c,
#                               l_xceb.xceb222d,l_xceb.xceb222e,l_xceb.xceb222f,l_xceb.xceb222g,l_xceb.xceb222h
#         #EXECUTE xccd_curs3 USING l_xceb.xceb103,l_xceb.xceb001,l_xceb.xceb103,l_xceb.xceb001 
#         #                    INTO l_xceb.xceb222, l_xceb.xceb222a,l_xceb.xceb222b,l_xceb.xceb222c,
#         #                         l_xceb.xceb222d,l_xceb.xceb222e,l_xceb.xceb222f,l_xceb.xceb222g,l_xceb.xceb222h
#         
#         IF cl_null(l_xceb.xceb222a) THEN LET l_xceb.xceb222a = 0 END IF
#         IF cl_null(l_xceb.xceb222b) THEN LET l_xceb.xceb222b = 0 END IF
#         IF cl_null(l_xceb.xceb222c) THEN LET l_xceb.xceb222c = 0 END IF
#         IF cl_null(l_xceb.xceb222d) THEN LET l_xceb.xceb222d = 0 END IF
#         IF cl_null(l_xceb.xceb222e) THEN LET l_xceb.xceb222e = 0 END IF
#         IF cl_null(l_xceb.xceb222f) THEN LET l_xceb.xceb222f = 0 END IF
#         IF cl_null(l_xceb.xceb222g) THEN LET l_xceb.xceb222g = 0 END IF
#         IF cl_null(l_xceb.xceb222h) THEN LET l_xceb.xceb222h = 0 END IF
#         IF cl_null(l_xceb.xceb222)  THEN LET l_xceb.xceb222  = 0 END IF
#      ELSE
#         LET l_xceb.xceb222a = 0
#         LET l_xceb.xceb222b = 0
#         LET l_xceb.xceb222c = 0
#         LET l_xceb.xceb222d = 0
#         LET l_xceb.xceb222e = 0
#         LET l_xceb.xceb222f = 0
#         LET l_xceb.xceb222g = 0
#         LET l_xceb.xceb222h = 0
#         LET l_xceb.xceb222  = 0     
#      END IF 
#     #160818-00013#1-s-mark
#     ##小于0的要变成正数
#     #IF l_xceb.xceb222a < 0 THEN LET l_xceb.xceb222a = l_xceb.xceb222a * -1 END IF
#     #IF l_xceb.xceb222b < 0 THEN LET l_xceb.xceb222b = l_xceb.xceb222b * -1 END IF
#     #IF l_xceb.xceb222c < 0 THEN LET l_xceb.xceb222c = l_xceb.xceb222c * -1 END IF
#     #IF l_xceb.xceb222d < 0 THEN LET l_xceb.xceb222d = l_xceb.xceb222d * -1 END IF
#     #IF l_xceb.xceb222e < 0 THEN LET l_xceb.xceb222e = l_xceb.xceb222e * -1 END IF
#     #IF l_xceb.xceb222f < 0 THEN LET l_xceb.xceb222f = l_xceb.xceb222f * -1 END IF
#     #IF l_xceb.xceb222g < 0 THEN LET l_xceb.xceb222g = l_xceb.xceb222g * -1 END IF
#     #IF l_xceb.xceb222h < 0 THEN LET l_xceb.xceb222h = l_xceb.xceb222h * -1 END IF
#     #IF l_xceb.xceb222  < 0 THEN LET l_xceb.xceb222  = l_xceb.xceb222  * -1 END IF
#     #160818-00013#1-e-mark 
#      #摘要
#      IF cl_null(l_xceb.xceb102) THEN
#         CALL axct701_01_get_summ(g_xcea_m.xceald,'61','8925','5') RETURNING l_success,l_xceb.xceb102
#      END IF
#      
#     #160816-00015#1-s-add
#      IF NOT cl_null(l_sfaa068) THEN
#         LET l_xceb.xceb108 = l_sfaa068   
#      ELSE
#         LET l_xceb.xceb108 = ' '
#      END IF      
#     #160816-00015#1-e-add 
#     
#      CALL axct701_01_default_space_xceb(l_xceb.*) RETURNING l_xceb.xceb005,
#                                                             l_xceb.xceb101,
#                                                             l_xceb.xceb102,
#                                                             l_xceb.xceb103,
#                                                             l_xceb.xceb110,
#                                                             l_xceb.xceb111,
#                                                             l_xceb.xceb112,
#                                                             l_xceb.xceb113,
#                                                             l_xceb.xceb114,
#                                                             l_xceb.xceb115,
#                                                             l_xceb.xceb116,
#                                                             l_xceb.xceb117,
#                                                             l_xceb.xceb118,
#                                                             l_xceb.xceb119,
#                                                             l_xceb.xceb120,
#                                                             l_xceb.xceb107,
#                                                             l_xceb.xceb108,
#                                                             l_xceb.xceb109,
#                                                             l_xceb.xceb121,
#                                                             l_xceb.xceb122,
#                                                             l_xceb.xceb123,
#                                                             l_xceb.xceb124,
#                                                             l_xceb.xceb125,
#                                                             l_xceb.xceb126,
#                                                             l_xceb.xceb127,
#                                                             l_xceb.xceb128,
#                                                             l_xceb.xceb129,
#                                                             l_xceb.xceb130
##如果金额和数量都为0的话，则不产生此笔单身数据                                                             
#      IF l_xceb.xceb201= 0 AND l_xceb.xceb202 = 0 THEN
#         CONTINUE FOREACH
#      END IF
#      #161109-00085#20-s mod
##      INSERT INTO xceb_t VALUES(l_xceb.*)   #161109-00085#20-s mark
#      #161109-00085#63 --s mark
#      #INSERT INTO xceb_t(xcebent,xcebcomp,xcebld,xcebdocno,xcebseq,xceb001,xceb002,xceb003,xceb004,
#      #                   xceb005,xceb101,xceb102,xceb103,xceb110,xceb111,xceb112,xceb113,xceb114,xceb115,
#      #                   xceb116,xceb117,xceb118,xceb119,xceb120,xceb201,xceb202,xceb202a,xceb202b,xceb202c,
#      #                   xceb202d,xceb202e,xceb202f,xceb202g,xceb202h,xceb212,xceb212a,xceb212b,xceb212c,
#      #                   xceb212d,xceb212e,xceb212f,xceb212g,xceb212h,xceb222,xceb222a,xceb222b,xceb222c,
#      #                   xceb222d,xceb222e,xceb222f,xceb222g,xceb222h,xceb301,xceb302,xceb107,xceb108,xceb109,
#      #                   xceb121,xceb122,xceb123,xceb124,xceb125,xceb126,xceb127,xceb128,xceb129,xceb130,xceb131,xceb132) 
#      #            VALUES(l_xceb.xcebent,l_xceb.xcebcomp,l_xceb.xcebld,l_xceb.xcebdocno,l_xceb.xcebseq,
#      #                   l_xceb.xceb001,l_xceb.xceb002,l_xceb.xceb003,l_xceb.xceb004,l_xceb.xceb005,
#      #                   l_xceb.xceb101,l_xceb.xceb102,l_xceb.xceb103,l_xceb.xceb110,l_xceb.xceb111,
#      #                   l_xceb.xceb112,l_xceb.xceb113,l_xceb.xceb114,l_xceb.xceb115,l_xceb.xceb116,
#      #                   l_xceb.xceb117,l_xceb.xceb118,l_xceb.xceb119,l_xceb.xceb120,l_xceb.xceb201,
#      #                   l_xceb.xceb202,l_xceb.xceb202a,l_xceb.xceb202b,l_xceb.xceb202c,l_xceb.xceb202d,
#      #                   l_xceb.xceb202e,l_xceb.xceb202f,l_xceb.xceb202g,l_xceb.xceb202h,l_xceb.xceb212,
#      #                   l_xceb.xceb212a,l_xceb.xceb212b,l_xceb.xceb212c,l_xceb.xceb212d,l_xceb.xceb212e,
#      #                   l_xceb.xceb212f,l_xceb.xceb212g,l_xceb.xceb212h,l_xceb.xceb222,l_xceb.xceb222a,
#      #                   l_xceb.xceb222b,l_xceb.xceb222c,l_xceb.xceb222d,l_xceb.xceb222e,l_xceb.xceb222f,
#      #                   l_xceb.xceb222g,l_xceb.xceb222h,l_xceb.xceb301,l_xceb.xceb302,l_xceb.xceb107,
#      #                   l_xceb.xceb108,l_xceb.xceb109,l_xceb.xceb121,l_xceb.xceb122,l_xceb.xceb123,
#      #                   l_xceb.xceb124,l_xceb.xceb125,l_xceb.xceb126,l_xceb.xceb127,l_xceb.xceb128,
#      #                   l_xceb.xceb129,l_xceb.xceb130,l_xceb.xceb131,l_xceb.xceb132)
#      #161109-00085#20-e mod
#      #161109-00085#63 --e mark
#      #161109-00085#63 --s add
#      INSERT INTO xceb_t(xcebent,xcebcomp,xcebld,xcebdocno,xcebseq,
#                         xceb001,xceb002,xceb003,xceb004,xceb005,
#                         xceb101,xceb102,xceb103,xceb110,xceb111,
#                         xceb112,xceb113,xceb114,xceb115,xceb116,
#                         xceb117,xceb118,xceb119,xceb120,xceb201,
#                         xceb202,xceb202a,xceb202b,xceb202c,xceb202d,
#                         xceb202e,xceb202f,xceb202g,xceb202h,xceb212,
#                         xceb212a,xceb212b,xceb212c,xceb212d,xceb212e,
#                         xceb212f,xceb212g,xceb212h,xceb222,xceb222a,
#                         xceb222b,xceb222c,xceb222d,xceb222e,xceb222f,
#                         xceb222g,xceb222h,xceb301,xceb302,xcebud001,
#                         xcebud002,xcebud003,xcebud004,xcebud005,xcebud006,
#                         xcebud007,xcebud008,xcebud009,xcebud010,xcebud011,
#                         xcebud012,xcebud013,xcebud014,xcebud015,xcebud016,
#                         xcebud017,xcebud018,xcebud019,xcebud020,xcebud021,
#                         xcebud022,xcebud023,xcebud024,xcebud025,xcebud026,
#                         xcebud027,xcebud028,xcebud029,xcebud030,xceb107,
#                         xceb108,xceb109,xceb121,xceb122,xceb123,
#                         xceb124,xceb125,xceb126,xceb127,xceb128,
#                         xceb129,xceb130,xceb131,xceb132)
#      VALUES(l_xceb.xcebent,l_xceb.xcebcomp,l_xceb.xcebld,l_xceb.xcebdocno,l_xceb.xcebseq,
#             l_xceb.xceb001,l_xceb.xceb002,l_xceb.xceb003,l_xceb.xceb004,l_xceb.xceb005,
#             l_xceb.xceb101,l_xceb.xceb102,l_xceb.xceb103,l_xceb.xceb110,l_xceb.xceb111,
#             l_xceb.xceb112,l_xceb.xceb113,l_xceb.xceb114,l_xceb.xceb115,l_xceb.xceb116,
#             l_xceb.xceb117,l_xceb.xceb118,l_xceb.xceb119,l_xceb.xceb120,l_xceb.xceb201,
#             l_xceb.xceb202,l_xceb.xceb202a,l_xceb.xceb202b,l_xceb.xceb202c,l_xceb.xceb202d,
#             l_xceb.xceb202e,l_xceb.xceb202f,l_xceb.xceb202g,l_xceb.xceb202h,l_xceb.xceb212,
#             l_xceb.xceb212a,l_xceb.xceb212b,l_xceb.xceb212c,l_xceb.xceb212d,l_xceb.xceb212e,
#             l_xceb.xceb212f,l_xceb.xceb212g,l_xceb.xceb212h,l_xceb.xceb222,l_xceb.xceb222a,
#             l_xceb.xceb222b,l_xceb.xceb222c,l_xceb.xceb222d,l_xceb.xceb222e,l_xceb.xceb222f,
#             l_xceb.xceb222g,l_xceb.xceb222h,l_xceb.xceb301,l_xceb.xceb302,l_xceb.xcebud001,
#             l_xceb.xcebud002,l_xceb.xcebud003,l_xceb.xcebud004,l_xceb.xcebud005,l_xceb.xcebud006,
#             l_xceb.xcebud007,l_xceb.xcebud008,l_xceb.xcebud009,l_xceb.xcebud010,l_xceb.xcebud011,
#             l_xceb.xcebud012,l_xceb.xcebud013,l_xceb.xcebud014,l_xceb.xcebud015,l_xceb.xcebud016,
#             l_xceb.xcebud017,l_xceb.xcebud018,l_xceb.xcebud019,l_xceb.xcebud020,l_xceb.xcebud021,
#             l_xceb.xcebud022,l_xceb.xcebud023,l_xceb.xcebud024,l_xceb.xcebud025,l_xceb.xcebud026,
#             l_xceb.xcebud027,l_xceb.xcebud028,l_xceb.xcebud029,l_xceb.xcebud030,l_xceb.xceb107,
#             l_xceb.xceb108,l_xceb.xceb109,l_xceb.xceb121,l_xceb.xceb122,l_xceb.xceb123,
#             l_xceb.xceb124,l_xceb.xceb125,l_xceb.xceb126,l_xceb.xceb127,l_xceb.xceb128,
#             l_xceb.xceb129,l_xceb.xceb130,l_xceb.xceb131,l_xceb.xceb132)
#      #161109-00085#63 --e add
#      
#      IF SQLCA.sqlcode THEN
#        INITIALIZE g_errparam TO NULL
#        LET g_errparam.code = SQLCA.sqlcode
#        LET g_errparam.extend = "l_xceb"
#        LET g_errparam.popup = TRUE
#        CALL cl_err()
#  
#        LET g_success = 'N'
#        EXIT FOREACH
#     END IF
#                           
#   END FOREACH
#   
#   
#   #第二單身
#   FOREACH xccd_curs4 INTO l_xcce.xcce002, l_xcce.xcce006, l_xcce.xcce007, l_xcce.xcce008,l_xcce.xcce009, 
#                           l_xcce.xcce303, l_xcce.xcce304, l_xcce.xcce304a,l_xcce.xcce304b,l_xcce.xcce304c,
#                           l_xcce.xcce304d,l_xcce.xcce304e,l_xcce.xcce304f,l_xcce.xcce304g,l_xcce.xcce304h
#
#      INITIALIZE l_xcec.* TO NULL
#
#      LET l_xcec.xcecent   = g_enterprise
#      LET l_xcec.xceccomp  = g_xcea_m.xceacomp
#      LET l_xcec.xcecld    = g_xcea_m.xceald     
#      LET l_xcec.xcecdocno = g_xcea_m.xceadocno
#      LET l_xcec.xcec001   = l_xcce.xcce006
#      LET l_xcec.xcec002   = ''
#      LET l_xcec.xcec004   = l_xcce.xcce007 
#      LET l_xcec.xcec005   = l_xcce.xcce008       
#      LET l_xcec.xcec102   = '' 
#      LET l_xcec.xcec102   = ''
#      LET l_xcec.xcec103   = l_xcce.xcce002
#      LET l_xcec.xcec110   = ''
#      LET l_xcec.xcec114   = ''
#      LET l_xcec.xcec115   = ' '
#      LET l_xcec.xcec116   = ' '  
#      LET l_xcec.xcec118   = ' '
#      LET l_xcec.xcec201   = l_xcce.xcce303
#      LET l_xcec.xcec202   = l_xcce.xcce304
#      LET l_xcec.xcec202a  = l_xcce.xcce304a
#      LET l_xcec.xcec202b  = l_xcce.xcce304b
#      LET l_xcec.xcec202c  = l_xcce.xcce304c
#      LET l_xcec.xcec202d  = l_xcce.xcce304d
#      LET l_xcec.xcec202e  = l_xcce.xcce304e
#      LET l_xcec.xcec202f  = l_xcce.xcce304f
#      LET l_xcec.xcec202g  = l_xcce.xcce304g
#      LET l_xcec.xcec202h  = l_xcce.xcce304h
#      LET l_xcec.xcec301   = ''
#      LET l_xcec.xcec302   = ''
#
#      SELECT MAX(xcecseq) INTO l_xcec.xcecseq FROM xcec_t
#       WHERE xcecent = g_enterprise AND xcecld = g_xcea_m.xceald
#         AND xcecdocno = g_xcea_m.xceadocno
#      IF cl_null(l_xcec.xcecseq) OR l_xcec.xcecseq = 0 THEN
#         LET l_xcec.xcecseq = 1
#      ELSE
#         LET l_xcec.xcecseq = l_xcec.xcecseq + 1
#      END IF   
#      
#      #工單類型   廠內/委外
#      LET l_sfaa057 = ''
#      LET l_sfaasite = ''
#      LET l_sfaa068 = ''   #160816-00015#1 add
#      SELECT sfaa003,sfaa057,sfaa009,sfaasite,sfaa028,sfaa029,
#             sfaa068                                                #160816-00015#1 add
#        INTO l_xcec.xcec003,l_sfaa057,l_xcec.xcec111,l_sfaasite,l_xcec.xcec119,l_xcec.xcec120,
#             l_sfaa068                                              #160816-00015#1 add
#        FROM sfaa_t WHERE sfaaent = g_enterprise AND sfaadocno = l_xcce.xcce006
#      #150906-00001#2-s
#      IF l_sfaa057 = '2' THEN   #委外
#         CALL s_get_item_acc(g_xcea_m.xceald,'26',l_xcec.xcec004,'','',g_xcea_m.xceacomp,'') 
#           RETURNING l_success,l_xcec.xcec101     
#      ELSE           
#      #150906-00001#2-e
#      #在制科目
#      CALL s_get_item_acc(g_xcea_m.xceald,'3',l_xcec.xcec004,'','',g_xcea_m.xceacomp,'') 
#        RETURNING l_success,l_xcec.xcec101
#      END IF   #150906-00001#2
##agli161抓不到，改抓axci201的科目
#      IF cl_null(l_xcec.xcec101) THEN
#         CALL s_fin_get_account(g_xcea_m.xceald,'60','8912','1') RETURNING l_success,l_xcec.xcec101,l_errno
#      END IF
#      
#      IF l_sfaa057 = '2' THEN   #委外
#         #客群/區域
#         SELECT pmaa090,pmaa241 INTO l_xcec.xcec112,l_xcec.xcec113 
#           FROM pmaa_t 
#          WHERE pmaaent = g_enterprise 
#            AND pmaa001 = l_xcec.xcec111
#         
#         
#      ELSE   #廠內
#         LET l_xcec.xcec111 = ' '
#         #客群
#         LET l_xcec.xcec112 = ' '
#         #區域
#         SELECT ooef153 INTO l_xcec.xcec113 FROM ooef_t
#          WHERE ooefent = g_enterprise
#            AND ooef001 = l_sfaasite
#      END IF 
#      
#      #品類
#      SELECT imag011 INTO l_xcec.xcec117 
#        FROM imag_t 
#       WHERE imagent = g_enterprise 
#         AND imagsite = g_xcea_m.xceacomp
#         AND imag001 = l_xcce.xcce007
#            
#      
#      IF cl_null(l_xcec.xcec202a) THEN LET l_xcec.xcec202a = 0 END IF
#      IF cl_null(l_xcec.xcec202b) THEN LET l_xcec.xcec202b = 0 END IF
#      IF cl_null(l_xcec.xcec202c) THEN LET l_xcec.xcec202c = 0 END IF
#      IF cl_null(l_xcec.xcec202d) THEN LET l_xcec.xcec202d = 0 END IF
#      IF cl_null(l_xcec.xcec202e) THEN LET l_xcec.xcec202e = 0 END IF
#      IF cl_null(l_xcec.xcec202f) THEN LET l_xcec.xcec202f = 0 END IF
#      IF cl_null(l_xcec.xcec202g) THEN LET l_xcec.xcec202g = 0 END IF
#      IF cl_null(l_xcec.xcec202h) THEN LET l_xcec.xcec202h = 0 END IF
#      IF cl_null(l_xcec.xcec202)  THEN LET l_xcec.xcec202  = 0 END IF   
#      IF cl_null(l_xcec.xcec201)  THEN LET l_xcec.xcec201  = 0 END IF
#
##小于0的要变成正数
#      #mark--2015/11/10 By shiun--(S)
##      IF l_xcec.xcec202a < 0 THEN LET l_xcec.xcec202a = l_xcec.xcec202a * -1 END IF
##      IF l_xcec.xcec202b < 0 THEN LET l_xcec.xcec202b = l_xcec.xcec202b * -1 END IF
##      IF l_xcec.xcec202c < 0 THEN LET l_xcec.xcec202c = l_xcec.xcec202c * -1 END IF
##      IF l_xcec.xcec202d < 0 THEN LET l_xcec.xcec202d = l_xcec.xcec202d * -1 END IF
##      IF l_xcec.xcec202e < 0 THEN LET l_xcec.xcec202e = l_xcec.xcec202e * -1 END IF
##      IF l_xcec.xcec202f < 0 THEN LET l_xcec.xcec202f = l_xcec.xcec202f * -1 END IF
##      IF l_xcec.xcec202g < 0 THEN LET l_xcec.xcec202g = l_xcec.xcec202g * -1 END IF
##      IF l_xcec.xcec202h < 0 THEN LET l_xcec.xcec202h = l_xcec.xcec202h * -1 END IF
##      IF l_xcec.xcec202  < 0 THEN LET l_xcec.xcec202  = l_xcec.xcec202  * -1 END IF      
##      IF l_xcec.xcec201  < 0 THEN LET l_xcec.xcec201  = l_xcec.xcec201  * -1 END IF 
#      #mark--2015/11/10 By shiun--(E)
#      IF g_glaa015 = 'Y' THEN 
#         OPEN xccd_curs5 USING  l_xcec.xcec103,l_xcec.xcec001,l_xcec.xcec004,l_xcec.xcec005,l_xcce.xcce009,
#                                l_xcec.xcec103,l_xcec.xcec001,l_xcec.xcec004,l_xcec.xcec005,l_xcce.xcce009
#         FETCH xccd_curs5 INTO l_xcec.xcec212, l_xcec.xcec212a,l_xcec.xcec212b,l_xcec.xcec212c,
#                               l_xcec.xcec212d,l_xcec.xcec212e,l_xcec.xcec212f,l_xcec.xcec212g,l_xcec.xcec212h
#         #EXECUTE xccd_curs5 USING l_xcec.xcec103,l_xcec.xcec001,l_xcec.xcec004,l_xcce.xcce008,
#         #                         l_xcec.xcec103,l_xcec.xcec001,l_xcec.xcec004,l_xcce.xcce008
#         #                    INTO l_xcec.xcec212, l_xcec.xcec212a,l_xcec.xcec212b,l_xcec.xcec212c,
#         #                         l_xcec.xcec212d,l_xcec.xcec212e,l_xcec.xcec212f,l_xcec.xcec212g,l_xcec.xcec212h
#         IF cl_null(l_xcec.xcec212a) THEN LET l_xcec.xcec212a = 0 END IF
#         IF cl_null(l_xcec.xcec212b) THEN LET l_xcec.xcec212b = 0 END IF
#         IF cl_null(l_xcec.xcec212c) THEN LET l_xcec.xcec212c = 0 END IF
#         IF cl_null(l_xcec.xcec212d) THEN LET l_xcec.xcec212d = 0 END IF
#         IF cl_null(l_xcec.xcec212e) THEN LET l_xcec.xcec212e = 0 END IF
#         IF cl_null(l_xcec.xcec212f) THEN LET l_xcec.xcec212f = 0 END IF
#         IF cl_null(l_xcec.xcec212g) THEN LET l_xcec.xcec212g = 0 END IF
#         IF cl_null(l_xcec.xcec212h) THEN LET l_xcec.xcec212h = 0 END IF
#         IF cl_null(l_xcec.xcec212)  THEN LET l_xcec.xcec212  = 0 END IF  
#      ELSE
#         LET l_xceb.xceb212a = 0
#         LET l_xceb.xceb212b = 0
#         LET l_xceb.xceb212c = 0
#         LET l_xceb.xceb212d = 0
#         LET l_xceb.xceb212e = 0
#         LET l_xceb.xceb212f = 0
#         LET l_xceb.xceb212g = 0
#         LET l_xceb.xceb212h = 0
#         LET l_xceb.xceb212  = 0     
#      END IF
#     #160818-00013#1-s-mark
#     ##小于0的要变成正数
#     #IF l_xcec.xcec212a < 0 THEN LET l_xcec.xcec212a = l_xcec.xcec212a * -1 END IF
#     #IF l_xcec.xcec212b < 0 THEN LET l_xcec.xcec212b = l_xcec.xcec212b * -1 END IF
#     #IF l_xcec.xcec212c < 0 THEN LET l_xcec.xcec212c = l_xcec.xcec212c * -1 END IF
#     #IF l_xcec.xcec212d < 0 THEN LET l_xcec.xcec212d = l_xcec.xcec212d * -1 END IF
#     #IF l_xcec.xcec212e < 0 THEN LET l_xcec.xcec212e = l_xcec.xcec212e * -1 END IF
#     #IF l_xcec.xcec212f < 0 THEN LET l_xcec.xcec212f = l_xcec.xcec212f * -1 END IF
#     #IF l_xcec.xcec212g < 0 THEN LET l_xcec.xcec212g = l_xcec.xcec212g * -1 END IF
#     #IF l_xcec.xcec212h < 0 THEN LET l_xcec.xcec212h = l_xcec.xcec212h * -1 END IF
#     #IF l_xcec.xcec212  < 0 THEN LET l_xcec.xcec212  = l_xcec.xcec212  * -1 END IF       
#     #160818-00013#1-e-mark 
#      IF g_glaa019 = 'Y' THEN 
#         OPEN xccd_curs6 USING  l_xcec.xcec103,l_xcec.xcec001,l_xcec.xcec004,l_xcec.xcec005,l_xcce.xcce009,
#                                l_xcec.xcec103,l_xcec.xcec001,l_xcec.xcec004,l_xcec.xcec005,l_xcce.xcce009
#         FETCH xccd_curs6 INTO l_xcec.xcec222, l_xcec.xcec222a,l_xcec.xcec222b,l_xcec.xcec222c,
#                               l_xcec.xcec222d,l_xcec.xcec222e,l_xcec.xcec222f,l_xcec.xcec222g,l_xcec.xcec222h
#         #EXECUTE xccd_curs6 USING l_xcec.xcec103,l_xcec.xcec001,l_xcec.xcec004,l_xcce.xcce008,
#         #                         l_xcec.xcec103,l_xcec.xcec001,l_xcec.xcec004,l_xcce.xcce008       
#         #                    INTO l_xcec.xcec222, l_xcec.xcec222a,l_xcec.xcec222b,l_xcec.xcec222c,
#         #                         l_xcec.xcec222d,l_xcec.xcec222e,l_xcec.xcec222f,l_xcec.xcec222g,l_xcec.xcec222h
#         
#         IF cl_null(l_xcec.xcec222a) THEN LET l_xcec.xcec222a = 0 END IF
#         IF cl_null(l_xcec.xcec222b) THEN LET l_xcec.xcec222b = 0 END IF
#         IF cl_null(l_xcec.xcec222c) THEN LET l_xcec.xcec222c = 0 END IF
#         IF cl_null(l_xcec.xcec222d) THEN LET l_xcec.xcec222d = 0 END IF
#         IF cl_null(l_xcec.xcec222e) THEN LET l_xcec.xcec222e = 0 END IF
#         IF cl_null(l_xcec.xcec222f) THEN LET l_xcec.xcec222f = 0 END IF
#         IF cl_null(l_xcec.xcec222g) THEN LET l_xcec.xcec222g = 0 END IF
#         IF cl_null(l_xcec.xcec222h) THEN LET l_xcec.xcec222h = 0 END IF
#         IF cl_null(l_xcec.xcec222)  THEN LET l_xcec.xcec222  = 0 END IF  
#      ELSE
#         LET l_xceb.xceb222a = 0
#         LET l_xceb.xceb222b = 0
#         LET l_xceb.xceb222c = 0
#         LET l_xceb.xceb222d = 0
#         LET l_xceb.xceb222e = 0
#         LET l_xceb.xceb222f = 0
#         LET l_xceb.xceb222g = 0
#         LET l_xceb.xceb222h = 0
#         LET l_xceb.xceb222  = 0     
#      END IF 
#     #160818-00013#1-s-mark 
#     ##小于0的要变成正数
#     #IF l_xcec.xcec222a < 0 THEN LET l_xcec.xcec222a = l_xcec.xcec222a * -1 END IF
#     #IF l_xcec.xcec222b < 0 THEN LET l_xcec.xcec222b = l_xcec.xcec222b * -1 END IF
#     #IF l_xcec.xcec222c < 0 THEN LET l_xcec.xcec222c = l_xcec.xcec222c * -1 END IF
#     #IF l_xcec.xcec222d < 0 THEN LET l_xcec.xcec222d = l_xcec.xcec222d * -1 END IF
#     #IF l_xcec.xcec222e < 0 THEN LET l_xcec.xcec222e = l_xcec.xcec222e * -1 END IF
#     #IF l_xcec.xcec222f < 0 THEN LET l_xcec.xcec222f = l_xcec.xcec222f * -1 END IF
#     #IF l_xcec.xcec222g < 0 THEN LET l_xcec.xcec222g = l_xcec.xcec222g * -1 END IF
#     #IF l_xcec.xcec222h < 0 THEN LET l_xcec.xcec222h = l_xcec.xcec222h * -1 END IF
#     #IF l_xcec.xcec222  < 0 THEN LET l_xcec.xcec222  = l_xcec.xcec222  * -1 END IF      
#     #160818-00013#1-e-mark 
#      #摘要
#      IF cl_null(l_xcec.xcec102) THEN
#         CALL axct701_01_get_summ(g_xcea_m.xceald,'61','8925','5') RETURNING l_success,l_xcec.xcec102
#      END IF
#      
#     #160816-00015#1-s-add
#      IF NOT cl_null(l_sfaa068) THEN
#         LET l_xcec.xcec108 = l_sfaa068   
#      ELSE
#         LET l_xcec.xcec108 = ' '
#      END IF      
#     #160816-00015#1-e-add  
#     
#      CALL axct701_01_default_space_xcec(l_xcec.*) RETURNING l_xcec.xcec005,   
#                                                             l_xcec.xcec101,
#                                                             l_xcec.xcec102,
#                                                             l_xcec.xcec103,
#                                                             l_xcec.xcec110,
#                                                             l_xcec.xcec111,
#                                                             l_xcec.xcec112,
#                                                             l_xcec.xcec113,
#                                                             l_xcec.xcec114,
#                                                             l_xcec.xcec115,
#                                                             l_xcec.xcec116,
#                                                             l_xcec.xcec117,
#                                                             l_xcec.xcec118,
#                                                             l_xcec.xcec119,
#                                                             l_xcec.xcec120,
#                                                             l_xcec.xcec107,
#                                                             l_xcec.xcec108,
#                                                             l_xcec.xcec109,
#                                                             l_xcec.xcec121,
#                                                             l_xcec.xcec122,
#                                                             l_xcec.xcec123,
#                                                             l_xcec.xcec124,
#                                                             l_xcec.xcec125,
#                                                             l_xcec.xcec126,
#                                                             l_xcec.xcec127,
#                                                             l_xcec.xcec128,
#                                                             l_xcec.xcec129,
#                                                             l_xcec.xcec130            
#      #如果金额和数量都为0的话，则不产生此笔单身数据                                                             
#      IF l_xcec.xcec201= 0 AND l_xcec.xcec202 = 0 THEN
#         CONTINUE FOREACH
#      END IF
#      #161109-00085#20-s mod      
##      INSERT INTO xcec_t VALUES(l_xcec.*)   #161109-00085#20-s mark
#      #161109-00085#63 --s mark
#      #INSERT INTO xcec_t(xcecent,xceccomp,xcecld,xcecdocno,xcecseq,xcec001,xcec002,xcec003,xcec004,
#      #                   xcec005,xcec101,xcec102,xcec103,xcec110,xcec111,xcec112,xcec113,xcec114,
#      #                   xcec115,xcec116,xcec117,xcec118,xcec119,xcec120,xcec201,xcec202,xcec202a,
#      #                   xcec202b,xcec202c,xcec202d,xcec202e,xcec202f,xcec202g,xcec202h,xcec212,
#      #                   xcec212a,xcec212b,xcec212c,xcec212d,xcec212e,xcec212f,xcec212g,xcec212h,
#      #                   xcec222,xcec222a,xcec222b,xcec222c,xcec222d,xcec222e,xcec222f,xcec222g,
#      #                   xcec222h,xcec301,xcec302,xcec107,xcec108,xcec109,xcec121,xcec122,xcec123,
#      #                   xcec124,xcec125,xcec126,xcec127,xcec128,xcec129,xcec130) 
#      #            VALUES(l_xcec.xcecent,l_xcec.xceccomp,l_xcec.xcecld,l_xcec.xcecdocno,l_xcec.xcecseq,
#      #                   l_xcec.xcec001,l_xcec.xcec002,l_xcec.xcec003,l_xcec.xcec004,l_xcec.xcec005,
#      #                   l_xcec.xcec101,l_xcec.xcec102,l_xcec.xcec103,l_xcec.xcec110,l_xcec.xcec111,
#      #                   l_xcec.xcec112,l_xcec.xcec113,l_xcec.xcec114,l_xcec.xcec115,l_xcec.xcec116,
#      #                   l_xcec.xcec117,l_xcec.xcec118,l_xcec.xcec119,l_xcec.xcec120,l_xcec.xcec201,
#      #                   l_xcec.xcec202,l_xcec.xcec202a,l_xcec.xcec202b,l_xcec.xcec202c,l_xcec.xcec202d,
#      #                   l_xcec.xcec202e,l_xcec.xcec202f,l_xcec.xcec202g,l_xcec.xcec202h,l_xcec.xcec212,
#      #                   l_xcec.xcec212a,l_xcec.xcec212b,l_xcec.xcec212c,l_xcec.xcec212d,l_xcec.xcec212e,
#      #                   l_xcec.xcec212f,l_xcec.xcec212g,l_xcec.xcec212h,l_xcec.xcec222,l_xcec.xcec222a,
#      #                   l_xcec.xcec222b,l_xcec.xcec222c,l_xcec.xcec222d,l_xcec.xcec222e,l_xcec.xcec222f,
#      #                   l_xcec.xcec222g,l_xcec.xcec222h,l_xcec.xcec301,l_xcec.xcec302,l_xcec.xcec107,
#      #                   l_xcec.xcec108,l_xcec.xcec109,l_xcec.xcec121,l_xcec.xcec122,l_xcec.xcec123,
#      #                   l_xcec.xcec124,l_xcec.xcec125,l_xcec.xcec126,l_xcec.xcec127,l_xcec.xcec128,
#      #                   l_xcec.xcec129,l_xcec.xcec130)
#      #161109-00085#63 --e mark
#      #161109-00085#20-e mod
#      #161109-00085#63 --s add
#      INSERT INTO xcec_t(xcecent,xceccomp,xcecld,xcecdocno,xcecseq,
#                         xcec001,xcec002,xcec003,xcec004,xcec005,
#                         xcec101,xcec102,xcec103,xcec110,xcec111,
#                         xcec112,xcec113,xcec114,xcec115,xcec116,
#                         xcec117,xcec118,xcec119,xcec120,xcec201,
#                         xcec202,xcec202a,xcec202b,xcec202c,xcec202d,
#                         xcec202e,xcec202f,xcec202g,xcec202h,xcec212,
#                         xcec212a,xcec212b,xcec212c,xcec212d,xcec212e,
#                         xcec212f,xcec212g,xcec212h,xcec222,xcec222a,
#                         xcec222b,xcec222c,xcec222d,xcec222e,xcec222f,
#                         xcec222g,xcec222h,xcec301,xcec302,xcecud001,
#                         xcecud002,xcecud003,xcecud004,xcecud005,xcecud006,
#                         xcecud007,xcecud008,xcecud009,xcecud010,xcecud011,
#                         xcecud012,xcecud013,xcecud014,xcecud015,xcecud016,
#                         xcecud017,xcecud018,xcecud019,xcecud020,xcecud021,
#                         xcecud022,xcecud023,xcecud024,xcecud025,xcecud026,
#                         xcecud027,xcecud028,xcecud029,xcecud030,xcec107,
#                         xcec108,xcec109,xcec121,xcec122,xcec123,
#                         xcec124,xcec125,xcec126,xcec127,xcec128,
#                         xcec129,xcec130)
#      VALUES(l_xcec.xcecent,l_xcec.xceccomp,l_xcec.xcecld,l_xcec.xcecdocno,l_xcec.xcecseq,
#             l_xcec.xcec001,l_xcec.xcec002,l_xcec.xcec003,l_xcec.xcec004,l_xcec.xcec005,
#             l_xcec.xcec101,l_xcec.xcec102,l_xcec.xcec103,l_xcec.xcec110,l_xcec.xcec111,
#             l_xcec.xcec112,l_xcec.xcec113,l_xcec.xcec114,l_xcec.xcec115,l_xcec.xcec116,
#             l_xcec.xcec117,l_xcec.xcec118,l_xcec.xcec119,l_xcec.xcec120,l_xcec.xcec201,
#             l_xcec.xcec202,l_xcec.xcec202a,l_xcec.xcec202b,l_xcec.xcec202c,l_xcec.xcec202d,
#             l_xcec.xcec202e,l_xcec.xcec202f,l_xcec.xcec202g,l_xcec.xcec202h,l_xcec.xcec212,
#             l_xcec.xcec212a,l_xcec.xcec212b,l_xcec.xcec212c,l_xcec.xcec212d,l_xcec.xcec212e,
#             l_xcec.xcec212f,l_xcec.xcec212g,l_xcec.xcec212h,l_xcec.xcec222,l_xcec.xcec222a,
#             l_xcec.xcec222b,l_xcec.xcec222c,l_xcec.xcec222d,l_xcec.xcec222e,l_xcec.xcec222f,
#             l_xcec.xcec222g,l_xcec.xcec222h,l_xcec.xcec301,l_xcec.xcec302,l_xcec.xcecud001,
#             l_xcec.xcecud002,l_xcec.xcecud003,l_xcec.xcecud004,l_xcec.xcecud005,l_xcec.xcecud006,
#             l_xcec.xcecud007,l_xcec.xcecud008,l_xcec.xcecud009,l_xcec.xcecud010,l_xcec.xcecud011,
#             l_xcec.xcecud012,l_xcec.xcecud013,l_xcec.xcecud014,l_xcec.xcecud015,l_xcec.xcecud016,
#             l_xcec.xcecud017,l_xcec.xcecud018,l_xcec.xcecud019,l_xcec.xcecud020,l_xcec.xcecud021,
#             l_xcec.xcecud022,l_xcec.xcecud023,l_xcec.xcecud024,l_xcec.xcecud025,l_xcec.xcecud026,
#             l_xcec.xcecud027,l_xcec.xcecud028,l_xcec.xcecud029,l_xcec.xcecud030,l_xcec.xcec107,
#             l_xcec.xcec108,l_xcec.xcec109,l_xcec.xcec121,l_xcec.xcec122,l_xcec.xcec123,
#             l_xcec.xcec124,l_xcec.xcec125,l_xcec.xcec126,l_xcec.xcec127,l_xcec.xcec128,
#             l_xcec.xcec129,l_xcec.xcec130)
#      #161109-00085#63 --e add
#      
#      IF SQLCA.sqlcode THEN
#        INITIALIZE g_errparam TO NULL
#        LET g_errparam.code = SQLCA.sqlcode
#        LET g_errparam.extend = "l_xcec"
#        LET g_errparam.popup = TRUE
#        CALL cl_err()
#  
#        LET g_success = 'N'
#        EXIT FOREACH
#     END IF
#                           
#   END FOREACH
#   
#   #第三單身
#   CALL axct701_01_ins_xced() RETURNING l_success
#   IF NOT l_success THEN LET g_success = 'N' END IF 
#   
#   RETURN g_success
#170105-00011#8---mark---e   
END FUNCTION

################################################################################
# Descriptions...: 抓取xcck_t銷貨資料產生到銷貨成本憑證axct706中   銷貨成本傳票產生維護作業
# Memo...........:
# Usage..........: CALL axct701_01_ins_6()
# Date & Author..: 2014/5/9 By wangrr
# Modify.........:
################################################################################
PRIVATE FUNCTION axct701_01_ins_6_bak()
#170105-00011#3---mark---s   
#   DEFINE l_success       LIKE type_t.num5
#   #161109-00085#18-s mod
#   #DEFINE l_xcea          RECORD LIKE xcea_t.*   #161109-00085#18-s mark
#   DEFINE l_xcea          RECORD  #工單發料成本憑證單頭檔
#          xceaent LIKE xcea_t.xceaent, #企業編號
#          xceacomp LIKE xcea_t.xceacomp, #法人組織
#          xceald LIKE xcea_t.xceald, #帳套
#          xceadocno LIKE xcea_t.xceadocno, #單據編號
#          xcea001 LIKE xcea_t.xcea001, #單據日期
#          xcea002 LIKE xcea_t.xcea002, #成本憑證類型
#          xcea003 LIKE xcea_t.xcea003, #成本計算類型
#          xcea004 LIKE xcea_t.xcea004, #年度
#          xcea005 LIKE xcea_t.xcea005, #期別
#          xcea006 LIKE xcea_t.xcea006, #帳務人員
#          xcea007 LIKE xcea_t.xcea007, #帳務部門
#          xcea101 LIKE xcea_t.xcea101, #憑證編號
#          xcea102 LIKE xcea_t.xcea102, #憑證日期
#          xceaownid LIKE xcea_t.xceaownid, #資料所有者
#          xceaowndp LIKE xcea_t.xceaowndp, #資料所屬部門
#          xceacrtid LIKE xcea_t.xceacrtid, #資料建立者
#          xceacrtdp LIKE xcea_t.xceacrtdp, #資料建立部門
#          xceacrtdt LIKE xcea_t.xceacrtdt, #資料創建日
#          xceamodid LIKE xcea_t.xceamodid, #資料修改者
#          xceamoddt LIKE xcea_t.xceamoddt, #最近修改日
#          xceacnfid LIKE xcea_t.xceacnfid, #資料確認者
#          xceacnfdt LIKE xcea_t.xceacnfdt, #資料確認日
#          xceapstid LIKE xcea_t.xceapstid, #資料過帳者
#          xceapstdt LIKE xcea_t.xceapstdt, #資料過帳日
#          xceastus LIKE xcea_t.xceastus, #狀態碼
#          #161109-00085#63 --s add
#          xceaud001 LIKE xcea_t.xceaud001, #自定義欄位(文字)001
#          xceaud002 LIKE xcea_t.xceaud002, #自定義欄位(文字)002
#          xceaud003 LIKE xcea_t.xceaud003, #自定義欄位(文字)003
#          xceaud004 LIKE xcea_t.xceaud004, #自定義欄位(文字)004
#          xceaud005 LIKE xcea_t.xceaud005, #自定義欄位(文字)005
#          xceaud006 LIKE xcea_t.xceaud006, #自定義欄位(文字)006
#          xceaud007 LIKE xcea_t.xceaud007, #自定義欄位(文字)007
#          xceaud008 LIKE xcea_t.xceaud008, #自定義欄位(文字)008
#          xceaud009 LIKE xcea_t.xceaud009, #自定義欄位(文字)009
#          xceaud010 LIKE xcea_t.xceaud010, #自定義欄位(文字)010
#          xceaud011 LIKE xcea_t.xceaud011, #自定義欄位(數字)011
#          xceaud012 LIKE xcea_t.xceaud012, #自定義欄位(數字)012
#          xceaud013 LIKE xcea_t.xceaud013, #自定義欄位(數字)013
#          xceaud014 LIKE xcea_t.xceaud014, #自定義欄位(數字)014
#          xceaud015 LIKE xcea_t.xceaud015, #自定義欄位(數字)015
#          xceaud016 LIKE xcea_t.xceaud016, #自定義欄位(數字)016
#          xceaud017 LIKE xcea_t.xceaud017, #自定義欄位(數字)017
#          xceaud018 LIKE xcea_t.xceaud018, #自定義欄位(數字)018
#          xceaud019 LIKE xcea_t.xceaud019, #自定義欄位(數字)019
#          xceaud020 LIKE xcea_t.xceaud020, #自定義欄位(數字)020
#          xceaud021 LIKE xcea_t.xceaud021, #自定義欄位(日期時間)021
#          xceaud022 LIKE xcea_t.xceaud022, #自定義欄位(日期時間)022
#          xceaud023 LIKE xcea_t.xceaud023, #自定義欄位(日期時間)023
#          xceaud024 LIKE xcea_t.xceaud024, #自定義欄位(日期時間)024
#          xceaud025 LIKE xcea_t.xceaud025, #自定義欄位(日期時間)025
#          xceaud026 LIKE xcea_t.xceaud026, #自定義欄位(日期時間)026
#          xceaud027 LIKE xcea_t.xceaud027, #自定義欄位(日期時間)027
#          xceaud028 LIKE xcea_t.xceaud028, #自定義欄位(日期時間)028
#          xceaud029 LIKE xcea_t.xceaud029, #自定義欄位(日期時間)029
#          xceaud030 LIKE xcea_t.xceaud030, #自定義欄位(日期時間)030
#          #161109-00085#63 --e add
#          xceasite LIKE xcea_t.xceasite  #營運據點
#             END RECORD
#   #161109-00085#18-e mod
#   #161109-00085#18-s mod
#   #DEFINE l_xceb          RECORD LIKE xceb_t.*   #161109-00085#18-s mark
#   DEFINE l_xceb          RECORD  #成本憑證第一單身檔
#          xcebent LIKE xceb_t.xcebent, #企業編號
#          xcebcomp LIKE xceb_t.xcebcomp, #法人組織
#          xcebld LIKE xceb_t.xcebld, #帳套
#          xcebdocno LIKE xceb_t.xcebdocno, #單據編號
#          xcebseq LIKE xceb_t.xcebseq, #項次
#          xceb001 LIKE xceb_t.xceb001, #參考單據編號
#          xceb002 LIKE xceb_t.xceb002, #參考單據項次
#          xceb003 LIKE xceb_t.xceb003, #單據類型
#          xceb004 LIKE xceb_t.xceb004, #料件編號
#          xceb005 LIKE xceb_t.xceb005, #特性
#          xceb101 LIKE xceb_t.xceb101, #科目編號
#          xceb102 LIKE xceb_t.xceb102, #摘要
#          xceb103 LIKE xceb_t.xceb103, #成本域
#          xceb110 LIKE xceb_t.xceb110, #原因碼
#          xceb111 LIKE xceb_t.xceb111, #收付款客商
#          xceb112 LIKE xceb_t.xceb112, #客群
#          xceb113 LIKE xceb_t.xceb113, #區域
#          xceb114 LIKE xceb_t.xceb114, #成本中心
#          xceb115 LIKE xceb_t.xceb115, #經營類別
#          xceb116 LIKE xceb_t.xceb116, #通路
#          xceb117 LIKE xceb_t.xceb117, #品類
#          xceb118 LIKE xceb_t.xceb118, #品牌
#          xceb119 LIKE xceb_t.xceb119, #專案號
#          xceb120 LIKE xceb_t.xceb120, #WBS
#          xceb201 LIKE xceb_t.xceb201, #數量
#          xceb202 LIKE xceb_t.xceb202, #成本金額(本位幣一)
#          xceb202a LIKE xceb_t.xceb202a, #成本-材料(本位幣一)
#          xceb202b LIKE xceb_t.xceb202b, #成本-人工(本位幣一)
#          xceb202c LIKE xceb_t.xceb202c, #成本-加工(本位幣一)
#          xceb202d LIKE xceb_t.xceb202d, #成本-制費一(本位幣一)
#          xceb202e LIKE xceb_t.xceb202e, #成本-制費二(本位幣一)
#          xceb202f LIKE xceb_t.xceb202f, #成本-制費三(本位幣一)
#          xceb202g LIKE xceb_t.xceb202g, #成本-制費四(本位幣一)
#          xceb202h LIKE xceb_t.xceb202h, #成本-制費五(本位幣一)
#          xceb212 LIKE xceb_t.xceb212, #成本金額(本位幣二)
#          xceb212a LIKE xceb_t.xceb212a, #成本-材料(本位幣二)
#          xceb212b LIKE xceb_t.xceb212b, #成本-人工(本位幣二)
#          xceb212c LIKE xceb_t.xceb212c, #成本-加工(本位幣二)
#          xceb212d LIKE xceb_t.xceb212d, #成本-制費一(本位幣二)
#          xceb212e LIKE xceb_t.xceb212e, #成本-制費二(本位幣二)
#          xceb212f LIKE xceb_t.xceb212f, #成本-制費三(本位幣二)
#          xceb212g LIKE xceb_t.xceb212g, #成本-制費四(本位幣二)
#          xceb212h LIKE xceb_t.xceb212h, #成本-制費五(本位幣二)
#          xceb222 LIKE xceb_t.xceb222, #成本金額(本位幣三)
#          xceb222a LIKE xceb_t.xceb222a, #成本-材料(本位幣三)
#          xceb222b LIKE xceb_t.xceb222b, #成本-人工(本位幣三)
#          xceb222c LIKE xceb_t.xceb222c, #成本-加工(本位幣三)
#          xceb222d LIKE xceb_t.xceb222d, #成本-制費一(本位幣三)
#          xceb222e LIKE xceb_t.xceb222e, #成本-制費二(本位幣三)
#          xceb222f LIKE xceb_t.xceb222f, #成本-制費三(本位幣三)
#          xceb222g LIKE xceb_t.xceb222g, #成本-制費四(本位幣三)
#          xceb222h LIKE xceb_t.xceb222h, #成本-制費五(本位幣三)
#          xceb301 LIKE xceb_t.xceb301, #憑證編號
#          xceb302 LIKE xceb_t.xceb302, #憑證項次
#          #161109-00085#63 --s add  
#          xcebud001 LIKE xceb_t.xcebud001, #自定義欄位(文字)001
#          xcebud002 LIKE xceb_t.xcebud002, #自定義欄位(文字)002
#          xcebud003 LIKE xceb_t.xcebud003, #自定義欄位(文字)003
#          xcebud004 LIKE xceb_t.xcebud004, #自定義欄位(文字)004
#          xcebud005 LIKE xceb_t.xcebud005, #自定義欄位(文字)005
#          xcebud006 LIKE xceb_t.xcebud006, #自定義欄位(文字)006
#          xcebud007 LIKE xceb_t.xcebud007, #自定義欄位(文字)007
#          xcebud008 LIKE xceb_t.xcebud008, #自定義欄位(文字)008
#          xcebud009 LIKE xceb_t.xcebud009, #自定義欄位(文字)009
#          xcebud010 LIKE xceb_t.xcebud010, #自定義欄位(文字)010
#          xcebud011 LIKE xceb_t.xcebud011, #自定義欄位(數字)011
#          xcebud012 LIKE xceb_t.xcebud012, #自定義欄位(數字)012
#          xcebud013 LIKE xceb_t.xcebud013, #自定義欄位(數字)013
#          xcebud014 LIKE xceb_t.xcebud014, #自定義欄位(數字)014
#          xcebud015 LIKE xceb_t.xcebud015, #自定義欄位(數字)015
#          xcebud016 LIKE xceb_t.xcebud016, #自定義欄位(數字)016
#          xcebud017 LIKE xceb_t.xcebud017, #自定義欄位(數字)017
#          xcebud018 LIKE xceb_t.xcebud018, #自定義欄位(數字)018
#          xcebud019 LIKE xceb_t.xcebud019, #自定義欄位(數字)019
#          xcebud020 LIKE xceb_t.xcebud020, #自定義欄位(數字)020
#          xcebud021 LIKE xceb_t.xcebud021, #自定義欄位(日期時間)021
#          xcebud022 LIKE xceb_t.xcebud022, #自定義欄位(日期時間)022
#          xcebud023 LIKE xceb_t.xcebud023, #自定義欄位(日期時間)023
#          xcebud024 LIKE xceb_t.xcebud024, #自定義欄位(日期時間)024
#          xcebud025 LIKE xceb_t.xcebud025, #自定義欄位(日期時間)025
#          xcebud026 LIKE xceb_t.xcebud026, #自定義欄位(日期時間)026
#          xcebud027 LIKE xceb_t.xcebud027, #自定義欄位(日期時間)027
#          xcebud028 LIKE xceb_t.xcebud028, #自定義欄位(日期時間)028
#          xcebud029 LIKE xceb_t.xcebud029, #自定義欄位(日期時間)029
#          xcebud030 LIKE xceb_t.xcebud030, #自定義欄位(日期時間)030
#          #161109-00085#63 --e add
#          xceb107 LIKE xceb_t.xceb107, #人員
#          xceb108 LIKE xceb_t.xceb108, #部門
#          xceb109 LIKE xceb_t.xceb109, #帳款對象
#          xceb121 LIKE xceb_t.xceb121, #自由核算項1
#          xceb122 LIKE xceb_t.xceb122, #自由核算項2
#          xceb123 LIKE xceb_t.xceb123, #自由核算項3
#          xceb124 LIKE xceb_t.xceb124, #自由核算項4
#          xceb125 LIKE xceb_t.xceb125, #自由核算項5
#          xceb126 LIKE xceb_t.xceb126, #自由核算項6
#          xceb127 LIKE xceb_t.xceb127, #自由核算項7
#          xceb128 LIKE xceb_t.xceb128, #自由核算項8
#          xceb129 LIKE xceb_t.xceb129, #自由核算項9
#          xceb130 LIKE xceb_t.xceb130, #自由核算項10
#          xceb131 LIKE xceb_t.xceb131, #單據類型(for 流通)
#          xceb132 LIKE xceb_t.xceb132  #單據日期(for 流通)
#             END RECORD
#   #161109-00085#18-e mod
#   #161109-00085#18-s mod
#   #DEFINE l_xcec          RECORD LIKE xcec_t.*   #161109-00085#18-s mark
#   DEFINE l_xcec          RECORD  #成本憑證第二單身檔
#          xcecent LIKE xcec_t.xcecent, #企業編號
#          xceccomp LIKE xcec_t.xceccomp, #法人組織
#          xcecld LIKE xcec_t.xcecld, #帳套
#          xcecdocno LIKE xcec_t.xcecdocno, #單據編號
#          xcecseq LIKE xcec_t.xcecseq, #項次
#          xcec001 LIKE xcec_t.xcec001, #參考單據
#          xcec002 LIKE xcec_t.xcec002, #參考單據項次
#          xcec003 LIKE xcec_t.xcec003, #單據類型
#          xcec004 LIKE xcec_t.xcec004, #料件編號
#          xcec005 LIKE xcec_t.xcec005, #特性
#          xcec101 LIKE xcec_t.xcec101, #科目編號
#          xcec102 LIKE xcec_t.xcec102, #摘要
#          xcec103 LIKE xcec_t.xcec103, #成本域
#          xcec110 LIKE xcec_t.xcec110, #原因碼
#          xcec111 LIKE xcec_t.xcec111, #收付款客商
#          xcec112 LIKE xcec_t.xcec112, #客群
#          xcec113 LIKE xcec_t.xcec113, #區域
#          xcec114 LIKE xcec_t.xcec114, #成本中心
#          xcec115 LIKE xcec_t.xcec115, #經營類別
#          xcec116 LIKE xcec_t.xcec116, #通路
#          xcec117 LIKE xcec_t.xcec117, #品類
#          xcec118 LIKE xcec_t.xcec118, #品牌
#          xcec119 LIKE xcec_t.xcec119, #專案號
#          xcec120 LIKE xcec_t.xcec120, #WBS
#          xcec201 LIKE xcec_t.xcec201, #數量
#          xcec202 LIKE xcec_t.xcec202, #成本金額(本位幣一)
#          xcec202a LIKE xcec_t.xcec202a, #成本-材料(本位幣一)
#          xcec202b LIKE xcec_t.xcec202b, #成本-人工(本位幣一)
#          xcec202c LIKE xcec_t.xcec202c, #成本-加工(本位幣一)
#          xcec202d LIKE xcec_t.xcec202d, #成本-制費一(本位幣一)
#          xcec202e LIKE xcec_t.xcec202e, #成本-制費二(本位幣一)
#          xcec202f LIKE xcec_t.xcec202f, #成本-制費三(本位幣一)
#          xcec202g LIKE xcec_t.xcec202g, #成本-制費四(本位幣一)
#          xcec202h LIKE xcec_t.xcec202h, #成本-制費五(本位幣一)
#          xcec212 LIKE xcec_t.xcec212, #成本-金額(本位幣二)
#          xcec212a LIKE xcec_t.xcec212a, #成本-材料(本位幣二)
#          xcec212b LIKE xcec_t.xcec212b, #成本-人工(本位幣二)
#          xcec212c LIKE xcec_t.xcec212c, #成本-加工(本位幣二)
#          xcec212d LIKE xcec_t.xcec212d, #成本-制費一(本位幣二)
#          xcec212e LIKE xcec_t.xcec212e, #成本-制費二(本位幣二)
#          xcec212f LIKE xcec_t.xcec212f, #成本-制費三(本位幣二)
#          xcec212g LIKE xcec_t.xcec212g, #成本-制費四(本位幣二)
#          xcec212h LIKE xcec_t.xcec212h, #成本-制費五(本位幣二)
#          xcec222 LIKE xcec_t.xcec222, #成本-金額(本位幣三)
#          xcec222a LIKE xcec_t.xcec222a, #成本-材料(本位幣三)
#          xcec222b LIKE xcec_t.xcec222b, #成本-人工(本位幣三)
#          xcec222c LIKE xcec_t.xcec222c, #成本-加工(本位幣三)
#          xcec222d LIKE xcec_t.xcec222d, #成本-制費一(本位幣三)
#          xcec222e LIKE xcec_t.xcec222e, #成本-制費二(本位幣三)
#          xcec222f LIKE xcec_t.xcec222f, #成本-制費三(本位幣三)
#          xcec222g LIKE xcec_t.xcec222g, #成本-制費四(本位幣三)
#          xcec222h LIKE xcec_t.xcec222h, #成本-制費五(本位幣三)
#          xcec301 LIKE xcec_t.xcec301, #憑證編號
#          xcec302 LIKE xcec_t.xcec302, #憑證項次
#          #161109-00085#63 --s add 
#          xcecud001 LIKE xcec_t.xcecud001, #自定義欄位(文字)001
#          xcecud002 LIKE xcec_t.xcecud002, #自定義欄位(文字)002
#          xcecud003 LIKE xcec_t.xcecud003, #自定義欄位(文字)003
#          xcecud004 LIKE xcec_t.xcecud004, #自定義欄位(文字)004
#          xcecud005 LIKE xcec_t.xcecud005, #自定義欄位(文字)005
#          xcecud006 LIKE xcec_t.xcecud006, #自定義欄位(文字)006
#          xcecud007 LIKE xcec_t.xcecud007, #自定義欄位(文字)007
#          xcecud008 LIKE xcec_t.xcecud008, #自定義欄位(文字)008
#          xcecud009 LIKE xcec_t.xcecud009, #自定義欄位(文字)009
#          xcecud010 LIKE xcec_t.xcecud010, #自定義欄位(文字)010
#          xcecud011 LIKE xcec_t.xcecud011, #自定義欄位(數字)011
#          xcecud012 LIKE xcec_t.xcecud012, #自定義欄位(數字)012
#          xcecud013 LIKE xcec_t.xcecud013, #自定義欄位(數字)013
#          xcecud014 LIKE xcec_t.xcecud014, #自定義欄位(數字)014
#          xcecud015 LIKE xcec_t.xcecud015, #自定義欄位(數字)015
#          xcecud016 LIKE xcec_t.xcecud016, #自定義欄位(數字)016
#          xcecud017 LIKE xcec_t.xcecud017, #自定義欄位(數字)017
#          xcecud018 LIKE xcec_t.xcecud018, #自定義欄位(數字)018
#          xcecud019 LIKE xcec_t.xcecud019, #自定義欄位(數字)019
#          xcecud020 LIKE xcec_t.xcecud020, #自定義欄位(數字)020
#          xcecud021 LIKE xcec_t.xcecud021, #自定義欄位(日期時間)021
#          xcecud022 LIKE xcec_t.xcecud022, #自定義欄位(日期時間)022
#          xcecud023 LIKE xcec_t.xcecud023, #自定義欄位(日期時間)023
#          xcecud024 LIKE xcec_t.xcecud024, #自定義欄位(日期時間)024
#          xcecud025 LIKE xcec_t.xcecud025, #自定義欄位(日期時間)025
#          xcecud026 LIKE xcec_t.xcecud026, #自定義欄位(日期時間)026
#          xcecud027 LIKE xcec_t.xcecud027, #自定義欄位(日期時間)027
#          xcecud028 LIKE xcec_t.xcecud028, #自定義欄位(日期時間)028
#          xcecud029 LIKE xcec_t.xcecud029, #自定義欄位(日期時間)029
#          xcecud030 LIKE xcec_t.xcecud030, #自定義欄位(日期時間)030
#          #161109-00085#63 --e add
#          xcec107 LIKE xcec_t.xcec107, #人員
#          xcec108 LIKE xcec_t.xcec108, #部門
#          xcec109 LIKE xcec_t.xcec109, #帳款對象
#          xcec121 LIKE xcec_t.xcec121, #自由核算項1
#          xcec122 LIKE xcec_t.xcec122, #自由核算項2
#          xcec123 LIKE xcec_t.xcec123, #自由核算項3
#          xcec124 LIKE xcec_t.xcec124, #自由核算項4
#          xcec125 LIKE xcec_t.xcec125, #自由核算項5
#          xcec126 LIKE xcec_t.xcec126, #自由核算項6
#          xcec127 LIKE xcec_t.xcec127, #自由核算項7
#          xcec128 LIKE xcec_t.xcec128, #自由核算項8
#          xcec129 LIKE xcec_t.xcec129, #自由核算項9
#          xcec130 LIKE xcec_t.xcec130  #自由核算項10
#                  END RECORD
#   #161109-00085#18-e mod
#   #161109-00085#18-s mod
#   #DEFINE l_xcck          RECORD LIKE xcck_t.*   #161109-00085#18-s mark
#   DEFINE l_xcck          RECORD  #本期料件明細進出成本檔
#          xcckent LIKE xcck_t.xcckent, #企業編號
#          xccksite LIKE xcck_t.xccksite, #site組織
#          xcckcomp LIKE xcck_t.xcckcomp, #法人組織
#          xcckld LIKE xcck_t.xcckld, #帳套
#          xcck001 LIKE xcck_t.xcck001, #帳套本位幣順序
#          xcck002 LIKE xcck_t.xcck002, #成本域
#          xcck003 LIKE xcck_t.xcck003, #成本計算類型
#          xcck004 LIKE xcck_t.xcck004, #年度
#          xcck005 LIKE xcck_t.xcck005, #期別
#          xcck006 LIKE xcck_t.xcck006, #參考單號
#          xcck007 LIKE xcck_t.xcck007, #項次
#          xcck008 LIKE xcck_t.xcck008, #項序
#          xcck009 LIKE xcck_t.xcck009, #出入庫碼
#          xcck010 LIKE xcck_t.xcck010, #料號
#          xcck011 LIKE xcck_t.xcck011, #產品特徵
#          xcck012 LIKE xcck_t.xcck012, #單據類型
#          xcck013 LIKE xcck_t.xcck013, #單據日期
#          xcck014 LIKE xcck_t.xcck014, #時間
#          xcck015 LIKE xcck_t.xcck015, #倉庫編號
#          xcck016 LIKE xcck_t.xcck016, #儲位編號
#          xcck017 LIKE xcck_t.xcck017, #批號
#          xcck020 LIKE xcck_t.xcck020, #異動類型
#          xcck021 LIKE xcck_t.xcck021, #原因碼
#          xcck022 LIKE xcck_t.xcck022, #交易對象
#          xcck023 LIKE xcck_t.xcck023, #客群
#          xcck024 LIKE xcck_t.xcck024, #區域
#          xcck025 LIKE xcck_t.xcck025, #成本中心
#          xcck026 LIKE xcck_t.xcck026, #經營類別
#          xcck027 LIKE xcck_t.xcck027, #通路
#          xcck028 LIKE xcck_t.xcck028, #品類
#          xcck029 LIKE xcck_t.xcck029, #品牌
#          xcck030 LIKE xcck_t.xcck030, #專案號
#          xcck031 LIKE xcck_t.xcck031, #WBS
#          xcck032 LIKE xcck_t.xcck032, #存貨科目
#          xcck033 LIKE xcck_t.xcck033, #費用成本科目
#          xcck034 LIKE xcck_t.xcck034, #收入科目
#          xcck040 LIKE xcck_t.xcck040, #交易幣別
#          xcck041 LIKE xcck_t.xcck041, #本位幣別
#          xcck042 LIKE xcck_t.xcck042, #匯率
#          xcck043 LIKE xcck_t.xcck043, #交易單位
#          xcck044 LIKE xcck_t.xcck044, #成本單位
#          xcck045 LIKE xcck_t.xcck045, #換算率
#          xcck046 LIKE xcck_t.xcck046, #交易數量
#          xcck047 LIKE xcck_t.xcck047, #工單號碼
#          xcck048 LIKE xcck_t.xcck048, #重複性生產-計畫編號
#          xcck049 LIKE xcck_t.xcck049, #重複性生產-生產料號
#          xcck050 LIKE xcck_t.xcck050, #重複性生產-生產料號BOM特性
#          xcck051 LIKE xcck_t.xcck051, #重複性生產-生產料號產品特徵
#          xcck055 LIKE xcck_t.xcck055, #xccc類型
#          xcck201 LIKE xcck_t.xcck201, #本期異動數量
#          xcck202 LIKE xcck_t.xcck202, #本期異動金額
#          xcck202a LIKE xcck_t.xcck202a, #本期異動金額-材料
#          xcck202b LIKE xcck_t.xcck202b, #本期異動金額-人工
#          xcck202c LIKE xcck_t.xcck202c, #本期異動金額-加工費
#          xcck202d LIKE xcck_t.xcck202d, #本期異動金額-製費一
#          xcck202e LIKE xcck_t.xcck202e, #本期異動金額-製費二
#          xcck202f LIKE xcck_t.xcck202f, #本期異動金額-製費三
#          xcck202g LIKE xcck_t.xcck202g, #本期異動金額-製費四
#          xcck202h LIKE xcck_t.xcck202h, #本期異動金額-製費五
#          xcck282 LIKE xcck_t.xcck282, #本期異動單價
#          xcck282a LIKE xcck_t.xcck282a, #本期異動單價-材料
#          xcck282b LIKE xcck_t.xcck282b, #本期異動單價-人工
#          xcck282c LIKE xcck_t.xcck282c, #本期異動單價-加工
#          xcck282d LIKE xcck_t.xcck282d, #本期異動單價-製費一
#          xcck282e LIKE xcck_t.xcck282e, #本期異動單價-製費二
#          xcck282f LIKE xcck_t.xcck282f, #本期異動單價-製費三
#          xcck282g LIKE xcck_t.xcck282g, #本期異動單價-製費四
#          xcck282h LIKE xcck_t.xcck282h, #本期異動單價-製費五
#          xcck301 LIKE xcck_t.xcck301, #已耗數量
#          xcck302 LIKE xcck_t.xcck302, #已耗金額
#          xcck302a LIKE xcck_t.xcck302a, #已耗金額-材料
#          xcck302b LIKE xcck_t.xcck302b, #已耗金額-人工
#          xcck302c LIKE xcck_t.xcck302c, #已耗金額-加工費
#          xcck302d LIKE xcck_t.xcck302d, #已耗金額-製費一
#          xcck302e LIKE xcck_t.xcck302e, #已耗金額-製費二
#          xcck302f LIKE xcck_t.xcck302f, #已耗金額-製費三
#          xcck302g LIKE xcck_t.xcck302g, #已耗金額-製費四
#          xcck302h LIKE xcck_t.xcck302h, #已耗金額-製費五
#          xcck901 LIKE xcck_t.xcck901, #結存數量
#          xcck902 LIKE xcck_t.xcck902, #結存金額
#          xcck902a LIKE xcck_t.xcck902a, #結存金額-材料
#          xcck902b LIKE xcck_t.xcck902b, #結存金額-人工
#          xcck902c LIKE xcck_t.xcck902c, #結存金額-加工費
#          xcck902d LIKE xcck_t.xcck902d, #結存金額-製費一
#          xcck902e LIKE xcck_t.xcck902e, #結存金額-製費二
#          xcck902f LIKE xcck_t.xcck902f, #結存金額-製費三
#          xcck902g LIKE xcck_t.xcck902g, #結存金額-製費四
#          xcck902h LIKE xcck_t.xcck902h, #結存金額-製費五
#          xcck980 LIKE xcck_t.xcck980, #結存單位成本
#          xcck980a LIKE xcck_t.xcck980a, #結存單位成本-材料
#          xcck980b LIKE xcck_t.xcck980b, #結存單位成本-人工
#          xcck980c LIKE xcck_t.xcck980c, #結存單位成本-加工費
#          xcck980d LIKE xcck_t.xcck980d, #結存單位成本-製費一
#          xcck980e LIKE xcck_t.xcck980e, #結存單位成本-製費二
#          xcck980f LIKE xcck_t.xcck980f, #結存單位成本-製費三
#          xcck980g LIKE xcck_t.xcck980g, #結存單位成本-製費四
#          xcck980h LIKE xcck_t.xcck980h, #結存單位成本-製費五
#          xcck903 LIKE xcck_t.xcck903, #結存調整金額
#          xcck903a LIKE xcck_t.xcck903a, #結存調整金額-材料
#          xcck903b LIKE xcck_t.xcck903b, #結存調整金額-人工
#          xcck903c LIKE xcck_t.xcck903c, #結存調整金額-加工費
#          xcck903d LIKE xcck_t.xcck903d, #結存調整金額-製費一
#          xcck903e LIKE xcck_t.xcck903e, #結存調整金額-製費二
#          xcck903f LIKE xcck_t.xcck903f, #結存調整金額-製費三
#          xcck903g LIKE xcck_t.xcck903g, #結存調整金額-製費四
#          xcck903h LIKE xcck_t.xcck903h, #結存調整金額-製費五
#          xcckownid LIKE xcck_t.xcckownid, #資料所有者
#          xcckowndp LIKE xcck_t.xcckowndp, #資料所屬部門
#          xcckcrtid LIKE xcck_t.xcckcrtid, #資料建立者
#          xcckcrtdp LIKE xcck_t.xcckcrtdp, #資料建立部門
#          xcckcrtdt LIKE xcck_t.xcckcrtdt, #資料創建日
#          xcckmodid LIKE xcck_t.xcckmodid, #資料修改者
#          xcckmoddt LIKE xcck_t.xcckmoddt, #最近修改日
#          xcckstus LIKE xcck_t.xcckstus, #狀態碼
#          #161109-00085#63 --s add      
#          xcckud001 LIKE xcck_t.xcckud001, #自定義欄位(文字)001
#          xcckud002 LIKE xcck_t.xcckud002, #自定義欄位(文字)002
#          xcckud003 LIKE xcck_t.xcckud003, #自定義欄位(文字)003
#          xcckud004 LIKE xcck_t.xcckud004, #自定義欄位(文字)004
#          xcckud005 LIKE xcck_t.xcckud005, #自定義欄位(文字)005
#          xcckud006 LIKE xcck_t.xcckud006, #自定義欄位(文字)006
#          xcckud007 LIKE xcck_t.xcckud007, #自定義欄位(文字)007
#          xcckud008 LIKE xcck_t.xcckud008, #自定義欄位(文字)008
#          xcckud009 LIKE xcck_t.xcckud009, #自定義欄位(文字)009
#          xcckud010 LIKE xcck_t.xcckud010, #自定義欄位(文字)010
#          xcckud011 LIKE xcck_t.xcckud011, #自定義欄位(數字)011
#          xcckud012 LIKE xcck_t.xcckud012, #自定義欄位(數字)012
#          xcckud013 LIKE xcck_t.xcckud013, #自定義欄位(數字)013
#          xcckud014 LIKE xcck_t.xcckud014, #自定義欄位(數字)014
#          xcckud015 LIKE xcck_t.xcckud015, #自定義欄位(數字)015
#          xcckud016 LIKE xcck_t.xcckud016, #自定義欄位(數字)016
#          xcckud017 LIKE xcck_t.xcckud017, #自定義欄位(數字)017
#          xcckud018 LIKE xcck_t.xcckud018, #自定義欄位(數字)018
#          xcckud019 LIKE xcck_t.xcckud019, #自定義欄位(數字)019
#          xcckud020 LIKE xcck_t.xcckud020, #自定義欄位(數字)020
#          xcckud021 LIKE xcck_t.xcckud021, #自定義欄位(日期時間)021
#          xcckud022 LIKE xcck_t.xcckud022, #自定義欄位(日期時間)022
#          xcckud023 LIKE xcck_t.xcckud023, #自定義欄位(日期時間)023
#          xcckud024 LIKE xcck_t.xcckud024, #自定義欄位(日期時間)024
#          xcckud025 LIKE xcck_t.xcckud025, #自定義欄位(日期時間)025
#          xcckud026 LIKE xcck_t.xcckud026, #自定義欄位(日期時間)026
#          xcckud027 LIKE xcck_t.xcckud027, #自定義欄位(日期時間)027
#          xcckud028 LIKE xcck_t.xcckud028, #自定義欄位(日期時間)028
#          xcckud029 LIKE xcck_t.xcckud029, #自定義欄位(日期時間)029
#          xcckud030 LIKE xcck_t.xcckud030, #自定義欄位(日期時間)030
#          #161109-00085#63 --e add
#          xcck056 LIKE xcck_t.xcck056  #成本代銷單號
#             END RECORD
#   #161109-00085#18-e mod
#   DEFINE ld_date         DATETIME YEAR TO SECOND
#   DEFINE l_xcck020       LIKE xcck_t.xcck020
#   DEFINE l_sql,l_sql1,l_sql2,l_sql3    STRING
#   DEFINE l_str           STRING
#   DEFINE l_sfin1003      LIKE type_t.chr1   #160706-00021#5
#   DEFINE l_cnt           LIKE type_t.num5   #160706-00021#5
#   DEFINE l_cnt1          LIKE type_t.num5   #160706-00021#5
#   
#   LET g_success = 'Y'
#   LET l_xcea.xceaownid = g_user
#   LET l_xcea.xceaowndp = g_dept
#   LET l_xcea.xceacrtid = g_user
#   LET l_xcea.xceacrtdp = g_dept 
#   LET ld_date  = cl_get_current()
#   LET l_xcea.xceacrtdt = ld_date
#   LET l_xcea.xceamodid = ""
#   LET l_xcea.xceamoddt = ""
#   CALL s_aooi200_fin_gen_docno(g_xcea_m.xceald,'','',g_xcea_m.xceadocno,g_xcea_m.xcea001,g_prog_name1)      #wujie 150214
#    RETURNING l_success,g_xcea_m.xceadocno
#   IF l_success  = 0  THEN
#      INITIALIZE g_errparam TO NULL
#      LET g_errparam.code = 'apm-00003'
#      LET g_errparam.extend = g_xcea_m.xceadocno
#      LET g_errparam.popup = TRUE
#      CALL cl_err()
#
#      LET g_success = 'N'
#      RETURN g_success
#   END IF
#   
#   INSERT INTO xcea_t (xceaent,xceald,xceacomp,xceadocno,xcea001,xcea002,xcea003,xcea004, 
#                       xcea005,xcea006,xcea007,xceastus,xceaownid,xceaowndp,xceacrtid,xceacrtdp,
#                       xceacrtdt, xceamodid,xceamoddt)
#   VALUES (g_enterprise,g_xcea_m.xceald,g_xcea_m.xceacomp,g_xcea_m.xceadocno,g_xcea_m.xcea001,g_xcea002,
#           g_xcea_m.xcea003,g_xcea_m.xcea004,g_xcea_m.xcea005,g_xcea_m.xcea006,g_xcea_m.xcea007, 
#           'N',l_xcea.xceaownid,l_xcea.xceaowndp,l_xcea.xceacrtid, 
#           l_xcea.xceacrtdp,ld_date,l_xcea.xceamodid,l_xcea.xceamoddt) 
#       
#   IF SQLCA.sqlcode THEN
#      INITIALIZE g_errparam TO NULL
#      LET g_errparam.code = SQLCA.sqlcode
#      LET g_errparam.extend = "ins xcea_t"
#      LET g_errparam.popup = TRUE
#      CALL cl_err()
#  
#      LET g_success = 'N'
#      RETURN g_success
#   END IF
#   
#   LET l_sql = " SELECT SUM(xcck009*xcck202), ",
#               "        SUM(xcck009*xcck202a),SUM(xcck009*xcck202b),SUM(xcck009*xcck202c),SUM(xcck009*xcck202d),",
#               "        SUM(xcck009*xcck202e),SUM(xcck009*xcck202f),SUM(xcck009*xcck202g),SUM(xcck009*xcck202h) ",
#               "        FROM xcck_t ", 
#               "  WHERE xcckent = '",g_enterprise,"' AND xcckld = '",g_xcea_m.xceald,"'",
#               "    AND xcck003 = '",g_xcea_m.xcea003,"' AND xcck004 = ",g_xcea_m.xcea004,
#               "    AND xcck005 = ",g_xcea_m.xcea005,
#              #"    AND xcck020 IN ('201','202') ",                                      #160422-00008#1 mark
#               "    AND xcck055 IN ('303','305','307','215') ",                          #160422-00008#1 add
#               "    AND xcck002 = ? AND xcck006 = ? AND xcck010 = ? AND xcck011 = ? ",
#               "    AND xcck009 = ? AND xcck021 = ? ",
#               "    AND xcck022 = ? AND xcck023 = ? AND xcck024 = ? ",
#               "    AND xcck025 = ? AND xcck026 = ? AND xcck027 = ? ",
#               "    AND xcck028 = ? AND xcck029 = ? AND xcck030 = ? ",
#               "    AND xcck031 = ? " 
#               
#   
#   LET g_sql1 = l_sql CLIPPED," AND xcck001 = '2' " 
#   
#   LET g_sql2 = l_sql CLIPPED," AND xcck001 = '3' " 
#   
#   LET g_sql = " SELECT xcck002,xcck006,xcck010,xcck011,xcck009,xcck021,xcck022,xcck023,xcck024,xcck025,xcck026,xcck027,xcck028,",
#               "        xcck029,xcck030,xcck031,xcck033,SUM(xcck009*xcck201),SUM(xcck009*xcck202), ",
#               "        SUM(xcck009*xcck202a),SUM(xcck009*xcck202b),SUM(xcck009*xcck202c),SUM(xcck009*xcck202d),",
#               "        SUM(xcck009*xcck202e),SUM(xcck009*xcck202f),SUM(xcck009*xcck202g),SUM(xcck009*xcck202h),xcck007 ",    #160706-00021#5
#               "        FROM xcck_t ", 
#               "  WHERE xcckent = '",g_enterprise,"' AND xcckld = '",g_xcea_m.xceald,"'",
#               "    AND xcck003 = '",g_xcea_m.xcea003,"' AND xcck004 = ",g_xcea_m.xcea004,
#               "    AND xcck005 = ",g_xcea_m.xcea005,
#               "    AND xcck001 = '1' ",
#              #"    AND xcck020 IN ('201','202') ",                                      #160422-00008#1 mark
#               "    AND xcck055 IN ('303','305','307','215') ",                          #160422-00008#1 add               
#               " GROUP BY xcck002,xcck006,xcck010,xcck011,xcck009,xcck021,xcck022,xcck023,xcck024,xcck025,xcck026,xcck027,xcck028,xcck029,xcck030,xcck031,xcck033,xcck007 ",    #160706-00021#5
#               " ORDER BY xcck002,xcck006,xcck010,xcck011,xcck009,xcck021,xcck022,xcck023,xcck024,xcck025,xcck026,xcck027,xcck028,xcck029,xcck030,xcck031,xcck033,xcck007 "     #160706-00021#5
#   PREPARE axct701_01_xcck_pr FROM g_sql
#   DECLARE axct701_01_xcck_cs CURSOR FOR axct701_01_xcck_pr
#
#   LET l_sql = " SELECT SUM(xcck009*xcck202), ",
#               "        SUM(xcck009*xcck202a),SUM(xcck009*xcck202b),SUM(xcck009*xcck202c),SUM(xcck009*xcck202d),",
#               "        SUM(xcck009*xcck202e),SUM(xcck009*xcck202f),SUM(xcck009*xcck202g),SUM(xcck009*xcck202h) ",
#               "        FROM xcck_t ", 
#               "  WHERE xcckent = '",g_enterprise,"' AND xcckld = '",g_xcea_m.xceald,"'",
#               "    AND xcck003 = '",g_xcea_m.xcea003,"' AND xcck004 = ",g_xcea_m.xcea004,
#               "    AND xcck005 = ",g_xcea_m.xcea005,
#              #"    AND xcck020 IN ('201','202') ",                                      #160422-00008#1 mark
#               "    AND xcck055 IN ('303','305','307','215') ",                          #160422-00008#1 add               
#               "    AND xcck002 = ? AND xcck006 = ? AND xcck010 = ? AND xcck011 = ? ",
#               "    AND xcck009 = ? AND xcck021 = ? ",
#               "    AND xcck022 = ? AND xcck023 = ? AND xcck024 = ? ",
#               "    AND xcck025 = ? AND xcck026 = ? AND xcck027 = ? ",
#               "    AND xcck028 = ? AND xcck029 = ? AND xcck030 = ? ",
#               "    AND xcck031 = ? " 
#               
#   
#   LET g_sql1 = l_sql CLIPPED," AND xcck001 = '2' " 
#   
#   LET g_sql2 = l_sql CLIPPED," AND xcck001 = '3' " 
#   CALL cl_get_para(g_enterprise,g_xcea_m.xceacomp,'S-FIN-1003') RETURNING l_sfin1003        #160706-00021#5
#   IF cl_null(l_sfin1003) THEN LET l_sfin1003 = '' END IF                                    #160706-00021#5
#   LET g_sql = " SELECT xcck002,xcck006,xcck010,xcck011,xcck009,xcck021,xcck022,xcck023,xcck024,xcck025,xcck026,xcck027,xcck028,",
#               "        xcck029,xcck030,xcck031,xcck032,SUM(xcck009*xcck201),SUM(xcck009*xcck202), ",
#               "        SUM(xcck009*xcck202a),SUM(xcck009*xcck202b),SUM(xcck009*xcck202c),SUM(xcck009*xcck202d),",
#               "        SUM(xcck009*xcck202e),SUM(xcck009*xcck202f),SUM(xcck009*xcck202g),SUM(xcck009*xcck202h),xcck007 ",    #160706-00021#5
#               "        FROM xcck_t ", 
#               "  WHERE xcckent = '",g_enterprise,"' AND xcckld = '",g_xcea_m.xceald,"'",
#               "    AND xcck003 = '",g_xcea_m.xcea003,"' AND xcck004 = ",g_xcea_m.xcea004,
#               "    AND xcck005 = ",g_xcea_m.xcea005,
#               "    AND xcck001 = '1' ",
#              #"    AND xcck020 IN ('201','202') ",                                      #160422-00008#1 mark
#               "    AND xcck055 IN ('303','305','307','215') ",                          #160422-00008#1 add               
#               " GROUP BY xcck002,xcck006,xcck010,xcck011,xcck009,xcck021,xcck022,xcck023,xcck024,xcck025,xcck026,xcck027,xcck028,xcck029,xcck030,xcck031,xcck032,xcck007 ",    #160706-00021#5
#               " ORDER BY xcck002,xcck006,xcck010,xcck011,xcck009,xcck021,xcck022,xcck023,xcck024,xcck025,xcck026,xcck027,xcck028,xcck029,xcck030,xcck031,xcck032,xcck007 "     #160706-00021#5
#   PREPARE axct701_01_xcck_pr_1 FROM g_sql
#   DECLARE axct701_01_xcck_cs_1 CURSOR FOR axct701_01_xcck_pr_1
#   
#   FOREACH axct701_01_xcck_cs INTO l_xcck.xcck002,l_xcck.xcck006,l_xcck.xcck010,l_xcck.xcck011,l_xcck.xcck009,l_xcck.xcck021,l_xcck.xcck022,l_xcck.xcck023,
#                                   l_xcck.xcck024,l_xcck.xcck025,l_xcck.xcck026,l_xcck.xcck027,l_xcck.xcck028,
#                                   l_xcck.xcck029,l_xcck.xcck030,l_xcck.xcck031,l_xcck.xcck033,
#                                   l_xcck.xcck201,l_xcck.xcck202,l_xcck.xcck202a,l_xcck.xcck202b,l_xcck.xcck202c,
#                                   l_xcck.xcck202d,l_xcck.xcck202e,l_xcck.xcck202f,l_xcck.xcck202g,l_xcck.xcck202h,
#                                   l_xcck.xcck007     #160706-00021#5
#
#      IF SQLCA.sqlcode THEN
#         INITIALIZE g_errparam TO NULL
#         LET g_errparam.code = SQLCA.sqlcode
#         LET g_errparam.extend = ''
#         LET g_errparam.popup = TRUE
#         CALL cl_err()
#  
#         LET g_success = 'N'
#         RETURN g_success
#      END IF
#      
#      #160706-00021#5--(S)
#      IF l_sfin1003 = '4' THEN
#         #xcck的出貨單號+項次 / 是存在於 xckb中的【當月轉入及轉出】者則往下依原標準產生分錄
#         LET l_cnt = 0
#         #SELECT count(*)　出貨單＋會計期+xckb002=-1 
#         #  AND IN (SELECT 出貨單 where 出貨單＋會計期+xckb002=1)
#         SELECT count(*) INTO l_cnt FROM xckb_t a
#          WHERE a.xckbent = g_enterprise AND a.xckbld = g_xcea_m.xceald
#            AND a.xckb007 = g_xcea_m.xcea004 AND a.xckb008 = g_xcea_m.xcea005
#            AND a.xckb005 = l_xcck.xcck006  AND a.xckb006 = l_xcck.xcck007 AND a.xckb002 = -1 
#            AND EXISTS (SELECT 1 FROM xckb_t b
#                         WHERE a.xckbent = b.xckbent AND a.xckbld = b.xckbld
#                          AND a.xckb007 = b.xckb007 AND a.xckb008 = b.xckb008
#                          AND a.xckb005 = b.xckb005 AND a.xckb006 = b.xckb006 AND xckb002 = 1 
#                       )               
#         IF l_cnt = 0 THEN  CONTINUE FOREACH END IF
#
#         #取出同一會計期,已開發票的數量, 取其合計量、成本金額
#         #SELECT SUM(xckb014),SUM(xckb102),SUM(xckb102a) ~ SUM(xckb102h)
#         # WHERE xckb002=-1 AND 本期+出貨單號+項次)
#         #取值後的NULL值判斷 ,避免加總計算錯誤
#         SELECT SUM(xckb014*xckb002),SUM(xckb102*xckb002),SUM(xckb102a*xckb002),SUM(xckb102b*xckb002),SUM(xckb102c*xckb002),
#                SUM(xckb102d*xckb002),SUM(xckb102e*xckb002),SUM(xckb102f*xckb002),SUM(xckb102g*xckb002),SUM(xckb102h*xckb002) 
#           INTO l_xcck.xcck201,l_xcck.xcck202,l_xcck.xcck202a,l_xcck.xcck202b,l_xcck.xcck202c,
#                l_xcck.xcck202d,l_xcck.xcck202e,l_xcck.xcck202f,l_xcck.xcck202g,l_xcck.xcck202h
#           FROM xckb_t
#          WHERE xckbent = g_enterprise
#            AND xckbld  = g_xcea_m.xceald  AND xckbcomp= g_xcea_m.xceacomp
#            AND xckb002 = -1
#            AND xckb005 = l_xcck.xcck006   AND xckb006 = l_xcck.xcck007
#            AND xckb007 = g_xcea_m.xcea004 AND xckb008 = g_xcea_m.xcea005
#          GROUP BY xckb005,xckb006
#      END IF
#      #160706-00021#5--(E)
#      
#      IF cl_null(l_xcck.xcck201)  THEN LET l_xcck.xcck201=0  END IF
#      IF cl_null(l_xcck.xcck202)  THEN LET l_xcck.xcck202=0  END IF
#      IF cl_null(l_xcck.xcck202a) THEN LET l_xcck.xcck202a=0 END IF
#      IF cl_null(l_xcck.xcck202b) THEN LET l_xcck.xcck202b=0 END IF
#      IF cl_null(l_xcck.xcck202c) THEN LET l_xcck.xcck202c=0 END IF
#      IF cl_null(l_xcck.xcck202d) THEN LET l_xcck.xcck202d=0 END IF
#      IF cl_null(l_xcck.xcck202e) THEN LET l_xcck.xcck202e=0 END IF
#      IF cl_null(l_xcck.xcck202f) THEN LET l_xcck.xcck202f=0 END IF
#      IF cl_null(l_xcck.xcck202g) THEN LET l_xcck.xcck202g=0 END IF
#      IF cl_null(l_xcck.xcck202h) THEN LET l_xcck.xcck202h=0 END IF
#
#      INITIALIZE l_xceb.* TO NULL
#      
#      CASE l_xcck.xcck009
#         WHEN -1          #销货
#            LET l_xceb.xceb003 = '7'
#         WHEN  1          #销退
#            LET l_xceb.xceb003 = '8'        
#      END CASE
#
#      SELECT xmdk004 INTO l_xceb.xceb108   #部门
#        FROM xmdk_t
#       WHERE xmdkent = g_enterprise
#         AND xmdkdocno = l_xcck.xcck006
#         
#      LET l_xceb.xceb001 = l_xcck.xcck006 #160706-00021#5
#      LET l_xceb.xceb103 = l_xcck.xcck002 #成本域
#      LET l_xceb.xceb004 = l_xcck.xcck010 #料號
#      LET l_xceb.xceb005 = l_xcck.xcck011 #特性
#      LET l_xceb.xceb110 = l_xcck.xcck021 #原因碼
#      LET l_xceb.xceb111 = l_xcck.xcck022 #交易對象      
#      LET l_xceb.xceb112 = l_xcck.xcck023 #客群 
#      LET l_xceb.xceb113 = l_xcck.xcck024 #區域  
#      LET l_xceb.xceb114 = l_xcck.xcck025 #成本中心      
#      LET l_xceb.xceb115 = l_xcck.xcck026 #經營類別
#      LET l_xceb.xceb116 = l_xcck.xcck027 #渠道
#      LET l_xceb.xceb117 = l_xcck.xcck028 #品類
#      LET l_xceb.xceb118 = l_xcck.xcck029 #品牌
#      LET l_xceb.xceb119 = l_xcck.xcck030 #項目號
#      LET l_xceb.xceb120 = l_xcck.xcck031 #WBS
#      LET l_xceb.xceb101 = l_xcck.xcck033 #費用科目 
#     #160812-00020#1-s-mark 
#     #LET l_xceb.xceb201 = l_xcck.xcck201 
#     #LET l_xceb.xceb202 = l_xcck.xcck202
#     #LET l_xceb.xceb202a = l_xcck.xcck202a
#     #LET l_xceb.xceb202b = l_xcck.xcck202b
#     #LET l_xceb.xceb202c = l_xcck.xcck202c
#     #LET l_xceb.xceb202d = l_xcck.xcck202d
#     #LET l_xceb.xceb202e = l_xcck.xcck202e
#     #LET l_xceb.xceb202f = l_xcck.xcck202f
#     #LET l_xceb.xceb202g = l_xcck.xcck202g
#     #LET l_xceb.xceb202h = l_xcck.xcck202h
#     #160812-00020#1-e-mark
#     #160812-00020#1-s-add
#      LET l_xceb.xceb201 = l_xcck.xcck201   * -1
#      LET l_xceb.xceb202 = l_xcck.xcck202   * -1
#      LET l_xceb.xceb202a = l_xcck.xcck202a * -1
#      LET l_xceb.xceb202b = l_xcck.xcck202b * -1
#      LET l_xceb.xceb202c = l_xcck.xcck202c * -1
#      LET l_xceb.xceb202d = l_xcck.xcck202d * -1
#      LET l_xceb.xceb202e = l_xcck.xcck202e * -1
#      LET l_xceb.xceb202f = l_xcck.xcck202f * -1
#      LET l_xceb.xceb202g = l_xcck.xcck202g * -1
#      LET l_xceb.xceb202h = l_xcck.xcck202h * -1
#     #160812-00020#1-e-add  
#      IF cl_null(l_xceb.xceb201)  THEN LET l_xceb.xceb201 = 0  END IF
#      IF cl_null(l_xceb.xceb202a) THEN LET l_xceb.xceb202a = 0 END IF
#      IF cl_null(l_xceb.xceb202b) THEN LET l_xceb.xceb202b = 0 END IF
#      IF cl_null(l_xceb.xceb202c) THEN LET l_xceb.xceb202c = 0 END IF
#      IF cl_null(l_xceb.xceb202d) THEN LET l_xceb.xceb202d = 0 END IF
#      IF cl_null(l_xceb.xceb202e) THEN LET l_xceb.xceb202e = 0 END IF
#      IF cl_null(l_xceb.xceb202f) THEN LET l_xceb.xceb202f = 0 END IF
#      IF cl_null(l_xceb.xceb202g) THEN LET l_xceb.xceb202g = 0 END IF
#      IF cl_null(l_xceb.xceb202h) THEN LET l_xceb.xceb202h = 0 END IF
#      IF cl_null(l_xceb.xceb202)  THEN LET l_xceb.xceb202  = 0 END IF     
#      
#      
#      SELECT MAX(xcebseq) INTO l_xceb.xcebseq FROM xceb_t
#       WHERE xcebent = g_enterprise AND xcebld = g_xcea_m.xceald
#         AND xcebdocno = g_xcea_m.xceadocno
#      IF cl_null(l_xceb.xcebseq) OR l_xceb.xcebseq = 0 THEN
#         LET l_xceb.xcebseq = 1
#      ELSE
#         LET l_xceb.xcebseq = l_xceb.xcebseq + 1
#      END IF  
#      
#      IF cl_null(l_xcck.xcck033) THEN  
#         CALL s_get_item_acc(g_xcea_m.xceald,'2',l_xcck.xcck010,'','',g_xcea_m.xceacomp,'')  #銷貨成本科目
#          RETURNING l_success,l_xcec.xcec101    
#      ELSE
#         LET l_xcec.xcec101 = l_xcck.xcck032 
#      END IF
#      
#      #核算項組合sql
#      CALL axct701_01_mark_sql(l_xcck.xcck021,l_xcck.xcck022,l_xcck.xcck023,l_xcck.xcck024,l_xcck.xcck025,l_xcck.xcck026,
#                               l_xcck.xcck027,l_xcck.xcck028,l_xcck.xcck029,l_xcck.xcck030,l_xcck.xcck031)
#      RETURNING l_str
#      #銷貨成本科目
#      IF cl_null(l_xceb.xceb101) THEN
#         CALL s_get_item_acc(g_xcea_m.xceald,'5',l_xceb.xceb004,'','',g_xcea_m.xceacomp,'')    #wujie 150214
#           RETURNING l_success,l_xceb.xceb101 
#      END IF
##      IF l_xcck.xcck033 IS NULL THEN
##         LET l_str=l_str," AND xcck033 IS NULL"
##      ELSE
##         LET l_str=l_str," AND xcck033 = '",l_xcck.xcck033,"'"
##      END IF
#      IF g_glaa015 = 'Y' THEN  
##        IF NOT cl_null(l_xcck.xcck033) THEN
#         LET g_sql1 = g_sql1," AND xcck033 = ? "
##        END IF
#         PREPARE axct701_01_xcck_pr2 FROM g_sql1
#         EXECUTE axct701_01_xcck_pr2 USING l_xcck.xcck002,l_xcck.xcck006,l_xcck.xcck010,l_xcck.xcck011,l_xcck.xcck009,l_xcck.xcck021,l_xcck.xcck022,l_xcck.xcck023,
#                                   l_xcck.xcck024,l_xcck.xcck025,l_xcck.xcck026,l_xcck.xcck027,l_xcck.xcck028,
#                                   l_xcck.xcck029,l_xcck.xcck030,l_xcck.xcck031,l_xcck.xcck033
#                                      INTO l_xceb.xceb212,l_xceb.xceb212a,l_xceb.xceb212b,l_xceb.xceb212c,
#                                           l_xceb.xceb212d,l_xceb.xceb212e,l_xceb.xceb212f,l_xceb.xceb212g,
#                                           l_xceb.xceb212h
#         IF SQLCA.sqlcode THEN
#            INITIALIZE g_errparam TO NULL
#            LET g_errparam.code = SQLCA.sqlcode
#            LET g_errparam.extend = "axct701_01_xcck_pr2"
#            LET g_errparam.popup = FALSE
#            CALL cl_err()
#
#            LET g_success = 'N'
#            RETURN g_success
#            EXIT FOREACH
#         END IF
#         #160812-00020#1-s-mark
#         #IF cl_null(l_xceb.xceb212)  THEN LET l_xceb.xceb212=0  END IF
#         #IF cl_null(l_xceb.xceb212a) THEN LET l_xceb.xceb212a=0 END IF
#         #IF cl_null(l_xceb.xceb212b) THEN LET l_xceb.xceb212b=0 END IF
#         #IF cl_null(l_xceb.xceb212c) THEN LET l_xceb.xceb212c=0 END IF
#         #IF cl_null(l_xceb.xceb212d) THEN LET l_xceb.xceb212d=0 END IF
#         #IF cl_null(l_xceb.xceb212e) THEN LET l_xceb.xceb212e=0 END IF
#         #IF cl_null(l_xceb.xceb212f) THEN LET l_xceb.xceb212f=0 END IF
#         #IF cl_null(l_xceb.xceb212g) THEN LET l_xceb.xceb212g=0 END IF
#         #IF cl_null(l_xceb.xceb212h) THEN LET l_xceb.xceb212h=0 END IF
#         #160812-00020#1-e-mark
#         #160812-00020#1-s-mark
#         IF cl_null(l_xceb.xceb212)  THEN LET l_xceb.xceb212  = 0 ELSE LET l_xceb.xceb212  = l_xceb.xceb212 * - 1 END IF
#         IF cl_null(l_xceb.xceb212a) THEN LET l_xceb.xceb212a = 0 ELSE LET l_xceb.xceb212a = l_xceb.xceb212a* - 1 END IF
#         IF cl_null(l_xceb.xceb212b) THEN LET l_xceb.xceb212b = 0 ELSE LET l_xceb.xceb212b = l_xceb.xceb212b* - 1 END IF
#         IF cl_null(l_xceb.xceb212c) THEN LET l_xceb.xceb212c = 0 ELSE LET l_xceb.xceb212c = l_xceb.xceb212c* - 1 END IF
#         IF cl_null(l_xceb.xceb212d) THEN LET l_xceb.xceb212d = 0 ELSE LET l_xceb.xceb212d = l_xceb.xceb212d* - 1 END IF
#         IF cl_null(l_xceb.xceb212e) THEN LET l_xceb.xceb212e = 0 ELSE LET l_xceb.xceb212e = l_xceb.xceb212e* - 1 END IF
#         IF cl_null(l_xceb.xceb212f) THEN LET l_xceb.xceb212f = 0 ELSE LET l_xceb.xceb212f = l_xceb.xceb212f* - 1 END IF
#         IF cl_null(l_xceb.xceb212g) THEN LET l_xceb.xceb212g = 0 ELSE LET l_xceb.xceb212g = l_xceb.xceb212g* - 1 END IF
#         IF cl_null(l_xceb.xceb212h) THEN LET l_xceb.xceb212h = 0 ELSE LET l_xceb.xceb212h = l_xceb.xceb212h* - 1 END IF
#         #160812-00020#1-e-mark         
#      ELSE
#         LET l_xceb.xceb212a = 0
#         LET l_xceb.xceb212b = 0
#         LET l_xceb.xceb212c = 0
#         LET l_xceb.xceb212d = 0
#         LET l_xceb.xceb212e = 0
#         LET l_xceb.xceb212f = 0
#         LET l_xceb.xceb212g = 0
#         LET l_xceb.xceb212h = 0
#         LET l_xceb.xceb212  = 0     
#      END IF
#      
#      IF g_glaa019 = 'Y' THEN
##         IF NOT cl_null(l_xcck.xcck033) THEN
#            LET g_sql2 = g_sql2," AND xcck033 = ? "
##         END IF     
#         PREPARE axct701_01_xcck_pr3 FROM g_sql2         
#         EXECUTE axct701_01_xcck_pr3 USING l_xcck.xcck002,l_xcck.xcck006,l_xcck.xcck010,l_xcck.xcck011,l_xcck.xcck009,l_xcck.xcck021,l_xcck.xcck022,l_xcck.xcck023,
#                                   l_xcck.xcck024,l_xcck.xcck025,l_xcck.xcck026,l_xcck.xcck027,l_xcck.xcck028,
#                                   l_xcck.xcck029,l_xcck.xcck030,l_xcck.xcck031,l_xcck.xcck033
#                                      INTO l_xceb.xceb222,l_xceb.xceb222a,l_xceb.xceb222b,l_xceb.xceb222c,
#                                           l_xceb.xceb222d,l_xceb.xceb222e,l_xceb.xceb222f,l_xceb.xceb222g,
#                                           l_xceb.xceb222h
#         IF SQLCA.sqlcode THEN
#            INITIALIZE g_errparam TO NULL
#            LET g_errparam.code = SQLCA.sqlcode
#            LET g_errparam.extend = "axct701_01_xcck_pr3"
#            LET g_errparam.popup = FALSE
#            CALL cl_err()
#
#            LET g_success = 'N'
#            RETURN g_success
#            EXIT FOREACH
#         END IF
#         #160812-00020#1-s-mark
#         #IF cl_null(l_xceb.xceb222)  THEN LET l_xceb.xceb222=0  END IF
#         #IF cl_null(l_xceb.xceb222a) THEN LET l_xceb.xceb222a=0 END IF
#         #IF cl_null(l_xceb.xceb222b) THEN LET l_xceb.xceb222b=0 END IF
#         #IF cl_null(l_xceb.xceb222c) THEN LET l_xceb.xceb222c=0 END IF
#         #IF cl_null(l_xceb.xceb222d) THEN LET l_xceb.xceb222d=0 END IF
#         #IF cl_null(l_xceb.xceb222e) THEN LET l_xceb.xceb222e=0 END IF
#         #IF cl_null(l_xceb.xceb222f) THEN LET l_xceb.xceb222f=0 END IF
#         #IF cl_null(l_xceb.xceb222g) THEN LET l_xceb.xceb222g=0 END IF
#         #IF cl_null(l_xceb.xceb222h) THEN LET l_xceb.xceb222h=0 END IF
#         #160812-00020#1-e-mark
#         #160812-00020#1-s-add
#         IF cl_null(l_xceb.xceb222)  THEN LET l_xceb.xceb222  =0 ELSE LET l_xceb.xceb222  = l_xceb.xceb222  * -1 END IF
#         IF cl_null(l_xceb.xceb222a) THEN LET l_xceb.xceb222a =0 ELSE LET l_xceb.xceb222a = l_xceb.xceb222a * -1 END IF
#         IF cl_null(l_xceb.xceb222b) THEN LET l_xceb.xceb222b =0 ELSE LET l_xceb.xceb222b = l_xceb.xceb222b * -1 END IF
#         IF cl_null(l_xceb.xceb222c) THEN LET l_xceb.xceb222c =0 ELSE LET l_xceb.xceb222c = l_xceb.xceb222c * -1 END IF
#         IF cl_null(l_xceb.xceb222d) THEN LET l_xceb.xceb222d =0 ELSE LET l_xceb.xceb222d = l_xceb.xceb222d * -1 END IF
#         IF cl_null(l_xceb.xceb222e) THEN LET l_xceb.xceb222e =0 ELSE LET l_xceb.xceb222e = l_xceb.xceb222e * -1 END IF
#         IF cl_null(l_xceb.xceb222f) THEN LET l_xceb.xceb222f =0 ELSE LET l_xceb.xceb222f = l_xceb.xceb222f * -1 END IF
#         IF cl_null(l_xceb.xceb222g) THEN LET l_xceb.xceb222g =0 ELSE LET l_xceb.xceb222g = l_xceb.xceb222g * -1 END IF
#         IF cl_null(l_xceb.xceb222h) THEN LET l_xceb.xceb222h =0 ELSE LET l_xceb.xceb222h = l_xceb.xceb222h * -1 END IF
#         #160812-00020#1-e-add 	          
#      ELSE
#         LET l_xceb.xceb222a = 0
#         LET l_xceb.xceb222b = 0
#         LET l_xceb.xceb222c = 0
#         LET l_xceb.xceb222d = 0
#         LET l_xceb.xceb222e = 0
#         LET l_xceb.xceb222f = 0
#         LET l_xceb.xceb222g = 0
#         LET l_xceb.xceb222h = 0
#         LET l_xceb.xceb222  = 0     
#      END IF
#      
#      LET l_xceb.xcebent = g_enterprise 
#      LET l_xceb.xcebcomp = g_xcea_m.xceacomp
#      LET l_xceb.xcebld = g_xcea_m.xceald
#      LET l_xceb.xcebdocno = g_xcea_m.xceadocno
#      #摘要
#      IF cl_null(l_xceb.xceb102) THEN
#         CALL axct701_01_get_summ(g_xcea_m.xceald,'61','8925','6') RETURNING l_success,l_xceb.xceb102
#      END IF
#      CALL axct701_01_default_space_xceb(l_xceb.*) RETURNING l_xceb.xceb005,
#                                                             l_xceb.xceb101,
#                                                             l_xceb.xceb102,
#                                                             l_xceb.xceb103,
#                                                             l_xceb.xceb110,
#                                                             l_xceb.xceb111,
#                                                             l_xceb.xceb112,
#                                                             l_xceb.xceb113,
#                                                             l_xceb.xceb114,
#                                                             l_xceb.xceb115,
#                                                             l_xceb.xceb116,
#                                                             l_xceb.xceb117,
#                                                             l_xceb.xceb118,
#                                                             l_xceb.xceb119,
#                                                             l_xceb.xceb120,
#                                                             l_xceb.xceb107,
#                                                             l_xceb.xceb108,
#                                                             l_xceb.xceb109,
#                                                             l_xceb.xceb121,
#                                                             l_xceb.xceb122,
#                                                             l_xceb.xceb123,
#                                                             l_xceb.xceb124,
#                                                             l_xceb.xceb125,
#                                                             l_xceb.xceb126,
#                                                             l_xceb.xceb127,
#                                                             l_xceb.xceb128,
#                                                             l_xceb.xceb129,
#                                                             l_xceb.xceb130      
##如果金额和数量都为0的话，则不产生此笔单身数据                                                             
#      IF l_xceb.xceb201= 0 AND l_xceb.xceb202 = 0 THEN
#         CONTINUE FOREACH
#      END IF      
#      #161109-00085#20-s mod
##      INSERT INTO xceb_t VALUES(l_xceb.*)   #161109-00085#20-s mark
#      #161109-00085#63 --s mark
#      #INSERT INTO xceb_t(xcebent,xcebcomp,xcebld,xcebdocno,xcebseq,xceb001,xceb002,xceb003,xceb004,
#      #                   xceb005,xceb101,xceb102,xceb103,xceb110,xceb111,xceb112,xceb113,xceb114,xceb115,
#      #                   xceb116,xceb117,xceb118,xceb119,xceb120,xceb201,xceb202,xceb202a,xceb202b,xceb202c,
#      #                   xceb202d,xceb202e,xceb202f,xceb202g,xceb202h,xceb212,xceb212a,xceb212b,xceb212c,
#      #                   xceb212d,xceb212e,xceb212f,xceb212g,xceb212h,xceb222,xceb222a,xceb222b,xceb222c,
#      #                   xceb222d,xceb222e,xceb222f,xceb222g,xceb222h,xceb301,xceb302,xceb107,xceb108,xceb109,
#      #                   xceb121,xceb122,xceb123,xceb124,xceb125,xceb126,xceb127,xceb128,xceb129,xceb130,xceb131,xceb132) 
#      #            VALUES(l_xceb.xcebent,l_xceb.xcebcomp,l_xceb.xcebld,l_xceb.xcebdocno,l_xceb.xcebseq,
#      #                   l_xceb.xceb001,l_xceb.xceb002,l_xceb.xceb003,l_xceb.xceb004,l_xceb.xceb005,
#      #                   l_xceb.xceb101,l_xceb.xceb102,l_xceb.xceb103,l_xceb.xceb110,l_xceb.xceb111,
#      #                   l_xceb.xceb112,l_xceb.xceb113,l_xceb.xceb114,l_xceb.xceb115,l_xceb.xceb116,
#      #                   l_xceb.xceb117,l_xceb.xceb118,l_xceb.xceb119,l_xceb.xceb120,l_xceb.xceb201,
#      #                   l_xceb.xceb202,l_xceb.xceb202a,l_xceb.xceb202b,l_xceb.xceb202c,l_xceb.xceb202d,
#      #                   l_xceb.xceb202e,l_xceb.xceb202f,l_xceb.xceb202g,l_xceb.xceb202h,l_xceb.xceb212,
#      #                   l_xceb.xceb212a,l_xceb.xceb212b,l_xceb.xceb212c,l_xceb.xceb212d,l_xceb.xceb212e,
#      #                   l_xceb.xceb212f,l_xceb.xceb212g,l_xceb.xceb212h,l_xceb.xceb222,l_xceb.xceb222a,
#      #                   l_xceb.xceb222b,l_xceb.xceb222c,l_xceb.xceb222d,l_xceb.xceb222e,l_xceb.xceb222f,
#      #                   l_xceb.xceb222g,l_xceb.xceb222h,l_xceb.xceb301,l_xceb.xceb302,l_xceb.xceb107,
#      #                   l_xceb.xceb108,l_xceb.xceb109,l_xceb.xceb121,l_xceb.xceb122,l_xceb.xceb123,
#      #                   l_xceb.xceb124,l_xceb.xceb125,l_xceb.xceb126,l_xceb.xceb127,l_xceb.xceb128,
#      #                   l_xceb.xceb129,l_xceb.xceb130,l_xceb.xceb131,l_xceb.xceb132)
#      #161109-00085#20-e mod
#      #161109-00085#63 --e mark
#      #161109-00085#63 --s add
#      INSERT INTO xceb_t(xcebent,xcebcomp,xcebld,xcebdocno,xcebseq,
#                         xceb001,xceb002,xceb003,xceb004,xceb005,
#                         xceb101,xceb102,xceb103,xceb110,xceb111,
#                         xceb112,xceb113,xceb114,xceb115,xceb116,
#                         xceb117,xceb118,xceb119,xceb120,xceb201,
#                         xceb202,xceb202a,xceb202b,xceb202c,xceb202d,
#                         xceb202e,xceb202f,xceb202g,xceb202h,xceb212,
#                         xceb212a,xceb212b,xceb212c,xceb212d,xceb212e,
#                         xceb212f,xceb212g,xceb212h,xceb222,xceb222a,
#                         xceb222b,xceb222c,xceb222d,xceb222e,xceb222f,
#                         xceb222g,xceb222h,xceb301,xceb302,xcebud001,
#                         xcebud002,xcebud003,xcebud004,xcebud005,xcebud006,
#                         xcebud007,xcebud008,xcebud009,xcebud010,xcebud011,
#                         xcebud012,xcebud013,xcebud014,xcebud015,xcebud016,
#                         xcebud017,xcebud018,xcebud019,xcebud020,xcebud021,
#                         xcebud022,xcebud023,xcebud024,xcebud025,xcebud026,
#                         xcebud027,xcebud028,xcebud029,xcebud030,xceb107,
#                         xceb108,xceb109,xceb121,xceb122,xceb123,
#                         xceb124,xceb125,xceb126,xceb127,xceb128,
#                         xceb129,xceb130,xceb131,xceb132)
#      VALUES(l_xceb.xcebent,l_xceb.xcebcomp,l_xceb.xcebld,l_xceb.xcebdocno,l_xceb.xcebseq,
#             l_xceb.xceb001,l_xceb.xceb002,l_xceb.xceb003,l_xceb.xceb004,l_xceb.xceb005,
#             l_xceb.xceb101,l_xceb.xceb102,l_xceb.xceb103,l_xceb.xceb110,l_xceb.xceb111,
#             l_xceb.xceb112,l_xceb.xceb113,l_xceb.xceb114,l_xceb.xceb115,l_xceb.xceb116,
#             l_xceb.xceb117,l_xceb.xceb118,l_xceb.xceb119,l_xceb.xceb120,l_xceb.xceb201,
#             l_xceb.xceb202,l_xceb.xceb202a,l_xceb.xceb202b,l_xceb.xceb202c,l_xceb.xceb202d,
#             l_xceb.xceb202e,l_xceb.xceb202f,l_xceb.xceb202g,l_xceb.xceb202h,l_xceb.xceb212,
#             l_xceb.xceb212a,l_xceb.xceb212b,l_xceb.xceb212c,l_xceb.xceb212d,l_xceb.xceb212e,
#             l_xceb.xceb212f,l_xceb.xceb212g,l_xceb.xceb212h,l_xceb.xceb222,l_xceb.xceb222a,
#             l_xceb.xceb222b,l_xceb.xceb222c,l_xceb.xceb222d,l_xceb.xceb222e,l_xceb.xceb222f,
#             l_xceb.xceb222g,l_xceb.xceb222h,l_xceb.xceb301,l_xceb.xceb302,l_xceb.xcebud001,
#             l_xceb.xcebud002,l_xceb.xcebud003,l_xceb.xcebud004,l_xceb.xcebud005,l_xceb.xcebud006,
#             l_xceb.xcebud007,l_xceb.xcebud008,l_xceb.xcebud009,l_xceb.xcebud010,l_xceb.xcebud011,
#             l_xceb.xcebud012,l_xceb.xcebud013,l_xceb.xcebud014,l_xceb.xcebud015,l_xceb.xcebud016,
#             l_xceb.xcebud017,l_xceb.xcebud018,l_xceb.xcebud019,l_xceb.xcebud020,l_xceb.xcebud021,
#             l_xceb.xcebud022,l_xceb.xcebud023,l_xceb.xcebud024,l_xceb.xcebud025,l_xceb.xcebud026,
#             l_xceb.xcebud027,l_xceb.xcebud028,l_xceb.xcebud029,l_xceb.xcebud030,l_xceb.xceb107,
#             l_xceb.xceb108,l_xceb.xceb109,l_xceb.xceb121,l_xceb.xceb122,l_xceb.xceb123,
#             l_xceb.xceb124,l_xceb.xceb125,l_xceb.xceb126,l_xceb.xceb127,l_xceb.xceb128,
#             l_xceb.xceb129,l_xceb.xceb130,l_xceb.xceb131,l_xceb.xceb132)
#      #161109-00085#63 --e add
#      IF SQLCA.sqlcode THEN
#         INITIALIZE g_errparam TO NULL
#         LET g_errparam.code = SQLCA.sqlcode
#         LET g_errparam.extend = "ins xceb_t"
#         LET g_errparam.popup = TRUE
#         CALL cl_err()
#  
#         LET g_success = 'N'
#         RETURN g_success
#         EXIT FOREACH
#      END IF   
#        
#   END FOREACH  
#  
#   FOREACH axct701_01_xcck_cs_1 INTO l_xcck.xcck002,l_xcck.xcck006,l_xcck.xcck010,l_xcck.xcck011,l_xcck.xcck009,l_xcck.xcck021,l_xcck.xcck022,l_xcck.xcck023,
#                                     l_xcck.xcck024,l_xcck.xcck025,l_xcck.xcck026,l_xcck.xcck027,l_xcck.xcck028,
#                                     l_xcck.xcck029,l_xcck.xcck030,l_xcck.xcck031,l_xcck.xcck032,
#                                     l_xcck.xcck201,l_xcck.xcck202,l_xcck.xcck202a,l_xcck.xcck202b,l_xcck.xcck202c,
#                                     l_xcck.xcck202d,l_xcck.xcck202e,l_xcck.xcck202f,l_xcck.xcck202g,l_xcck.xcck202h
#                                    ,l_xcck.xcck007   #160706-00021#5
#      IF SQLCA.sqlcode THEN
#         INITIALIZE g_errparam TO NULL
#         LET g_errparam.code = SQLCA.sqlcode
#         LET g_errparam.extend = ''
#         LET g_errparam.popup = TRUE
#         CALL cl_err()
#  
#         LET g_success = 'N'
#         RETURN g_success
#      END IF
#      #160706-00021#5--(S)
#      IF l_sfin1003 = '4' THEN
#         #xcck的出貨單號+項次 / 是存在於 xckb中的【當月轉入及轉出】者則往下依原標準產生分錄
#         LET l_cnt = 0
#         #SELECT count(*)　出貨單＋會計期+xckb002=-1 
#         #   AND IN (SELECT 出貨單 where 出貨單＋會計期+xckb002=1)
#         SELECT count(*) INTO l_cnt FROM xckb_t a
#          WHERE a.xckbent = g_enterprise AND a.xckbld = g_xcea_m.xceald
#            AND a.xckb007 = g_xcea_m.xcea004 AND a.xckb008 = g_xcea_m.xcea005
#            AND a.xckb005 = l_xcck.xcck006  AND a.xckb006 = l_xcck.xcck007 AND a.xckb002 = -1 
#            AND EXISTS (SELECT 1 FROM xckb_t b
#                         WHERE a.xckbent = b.xckbent AND a.xckbld = b.xckbld
#                          AND a.xckb007 = b.xckb007 AND a.xckb008 = b.xckb008
#                          AND a.xckb005 = b.xckb005 AND a.xckb006 = b.xckb006 AND xckb002 = 1 
#                       )  
#         IF l_cnt =0 THEN  CONTINUE FOREACH END IF             
#         #取出同一會計期,已開發票的數量, 取其合計量、成本金額
#         #SELECT SUM(xckb014),SUM(xckb102),SUM(xckb102a) ~ SUM(xckb102h)
#         # WHERE xckb002=-1 and 本期+出貨單號+項次   
#         #取值後的NULL值判斷 ,避免加總計算錯誤
#         SELECT SUM(xckb014 *xckb002),SUM(xckb102 *xckb002),SUM(xckb102a*xckb002),SUM(xckb102b*xckb002),SUM(xckb102c*xckb002),
#                SUM(xckb102d*xckb002),SUM(xckb102e*xckb002),SUM(xckb102f*xckb002),SUM(xckb102g*xckb002),SUM(xckb102h*xckb002) 
#           INTO l_xcck.xcck201,l_xcck.xcck202,l_xcck.xcck202a,l_xcck.xcck202b,l_xcck.xcck202c,
#                l_xcck.xcck202d,l_xcck.xcck202e,l_xcck.xcck202f,l_xcck.xcck202g,l_xcck.xcck202h
#           FROM xckb_t
#          WHERE xckbent = g_enterprise
#            AND xckbld  = g_xcea_m.xceald AND xckbcomp = g_xcea_m.xceacomp
#            AND xckb002 = -1
#            AND xckb005 = l_xcck.xcck006   AND xckb006 = l_xcck.xcck007
#            AND xckb007 = g_xcea_m.xcea004 AND xckb008 = g_xcea_m.xcea005
#          GROUP BY xckb005,xckb006 
#      END IF
#      #160706-00021#5--(E)
#      IF cl_null(l_xcck.xcck201)  THEN LET l_xcck.xcck201=0  END IF
#      IF cl_null(l_xcck.xcck202)  THEN LET l_xcck.xcck202=0  END IF
#      IF cl_null(l_xcck.xcck202a) THEN LET l_xcck.xcck202a=0 END IF
#      IF cl_null(l_xcck.xcck202b) THEN LET l_xcck.xcck202b=0 END IF
#      IF cl_null(l_xcck.xcck202c) THEN LET l_xcck.xcck202c=0 END IF
#      IF cl_null(l_xcck.xcck202d) THEN LET l_xcck.xcck202d=0 END IF
#      IF cl_null(l_xcck.xcck202e) THEN LET l_xcck.xcck202e=0 END IF
#      IF cl_null(l_xcck.xcck202f) THEN LET l_xcck.xcck202f=0 END IF
#      IF cl_null(l_xcck.xcck202g) THEN LET l_xcck.xcck202g=0 END IF
#      IF cl_null(l_xcck.xcck202h) THEN LET l_xcck.xcck202h=0 END IF
#
#      INITIALIZE l_xcec.* TO NULL
#      
#      CASE l_xcck.xcck009
#         WHEN -1          #销货
#            LET l_xcec.xcec003 = '7'
#         WHEN  1          #销退
#            LET l_xcec.xcec003 = '8'        
#      END CASE
#
#      SELECT xmdk004 INTO l_xcec.xcec108   #部门
#        FROM xmdk_t
#       WHERE xmdkent = g_enterprise
#         AND xmdkdocno = l_xcck.xcck006
#         
#      LET l_xcec.xcec001 = l_xcck.xcck006 #160706-00021#5
#      LET l_xcec.xcec103 = l_xcck.xcck002 #成本域
#      LET l_xcec.xcec004 = l_xcck.xcck010 #料號
#      LET l_xcec.xcec005 = l_xcck.xcck011 #特性
#      LET l_xcec.xcec110 = l_xcck.xcck021 #原因碼
#      LET l_xcec.xcec111 = l_xcck.xcck022 #交易對象      
#      LET l_xcec.xcec112 = l_xcck.xcck023 #客群 
#      LET l_xcec.xcec113 = l_xcck.xcck024 #區域  
#      LET l_xcec.xcec114 = l_xcck.xcck025 #成本中心      
#      LET l_xcec.xcec115 = l_xcck.xcck026 #經營類別
#      LET l_xcec.xcec116 = l_xcck.xcck027 #渠道
#      LET l_xcec.xcec117 = l_xcck.xcck028 #品類
#      LET l_xcec.xcec118 = l_xcck.xcck029 #品牌
#      LET l_xcec.xcec119 = l_xcck.xcck030 #項目號
#      LET l_xcec.xcec120 = l_xcck.xcck031 #WBS
#      LET l_xcec.xcec101 = l_xcck.xcck032 #存貨科目 
#     #160812-00020#1-s-mark
#     #LET l_xcec.xcec201 = l_xcck.xcck201
#     #LET l_xcec.xcec202 = l_xcck.xcck202
#     #LET l_xcec.xcec202a = l_xcck.xcck202a
#     #LET l_xcec.xcec202b = l_xcck.xcck202b
#     #LET l_xcec.xcec202c = l_xcck.xcck202c
#     #LET l_xcec.xcec202d = l_xcck.xcck202d
#     #LET l_xcec.xcec202e = l_xcck.xcck202e
#     #LET l_xcec.xcec202f = l_xcck.xcck202f
#     #LET l_xcec.xcec202g = l_xcck.xcck202g
#     #LET l_xcec.xcec202h = l_xcck.xcck202h
#     #160812-00020#1-e-mark
#     #160812-00020#1-s-add
#      LET l_xcec.xcec201 = l_xcck.xcck201   * -1
#      LET l_xcec.xcec202 = l_xcck.xcck202   * -1
#      LET l_xcec.xcec202a = l_xcck.xcck202a * -1
#      LET l_xcec.xcec202b = l_xcck.xcck202b * -1
#      LET l_xcec.xcec202c = l_xcck.xcck202c * -1
#      LET l_xcec.xcec202d = l_xcck.xcck202d * -1
#      LET l_xcec.xcec202e = l_xcck.xcck202e * -1
#      LET l_xcec.xcec202f = l_xcck.xcck202f * -1
#      LET l_xcec.xcec202g = l_xcck.xcck202g * -1
#      LET l_xcec.xcec202h = l_xcck.xcck202h * -1
#     #160812-00020#1-e-add 
#      SELECT MAX(xcecseq) INTO l_xcec.xcecseq FROM xcec_t
#       WHERE xcecent = g_enterprise AND xcecld = g_xcea_m.xceald
#         AND xcecdocno = g_xcea_m.xceadocno
#      IF cl_null(l_xcec.xcecseq) OR l_xcec.xcecseq = 0 THEN
#         LET l_xcec.xcecseq = 1
#      ELSE
#         LET l_xcec.xcecseq = l_xcec.xcecseq + 1
#      END IF  
#
#      IF cl_null(l_xcck.xcck032) THEN  
#         CALL s_get_item_acc(g_xcea_m.xceald,'1',l_xcck.xcck010,'','',g_xcea_m.xceacomp,'')  #存貨科目
#          RETURNING l_success,l_xcec.xcec101   
#      ELSE
#         LET l_xcec.xcec101 = l_xcck.xcck032 
#      END IF
#      
#      #核算項組合sql
#      CALL axct701_01_mark_sql(l_xcck.xcck021,l_xcck.xcck022,l_xcck.xcck023,l_xcck.xcck024,l_xcck.xcck025,l_xcck.xcck026,
#                               l_xcck.xcck027,l_xcck.xcck028,l_xcck.xcck029,l_xcck.xcck030,l_xcck.xcck031)
#      RETURNING l_str
#
#      IF g_glaa015 = 'Y' THEN
##         IF NOT cl_null(l_xcck.xcck033) THEN
#            LET g_sql1 = g_sql1," AND xcck032 = ? "
##         END IF
#         PREPARE axct701_01_xcck_pr2_1 FROM g_sql1
#         EXECUTE axct701_01_xcck_pr2_1 USING l_xcck.xcck002,l_xcck.xcck006,l_xcck.xcck010,l_xcck.xcck011,l_xcck.xcck009,l_xcck.xcck021,l_xcck.xcck022,l_xcck.xcck023,
#                                   l_xcck.xcck024,l_xcck.xcck025,l_xcck.xcck026,l_xcck.xcck027,l_xcck.xcck028,
#                                   l_xcck.xcck029,l_xcck.xcck030,l_xcck.xcck031,l_xcck.xcck032
#                                        INTO l_xcec.xcec212,l_xcec.xcec212a,l_xcec.xcec212b,l_xcec.xcec212c,
#                                             l_xcec.xcec212d,l_xcec.xcec212e,l_xcec.xcec212f,l_xcec.xcec212g,
#                                             l_xcec.xcec212h
#         IF SQLCA.sqlcode THEN
#            INITIALIZE g_errparam TO NULL
#            LET g_errparam.code = SQLCA.sqlcode
#            LET g_errparam.extend = "axct701_01_xcck_pr2_1"
#            LET g_errparam.popup = FALSE
#            CALL cl_err()
#
#            LET g_success = 'N'
#            RETURN g_success
#            EXIT FOREACH
#         END IF
#         #160812-00020#1-s-mark
#         #IF cl_null(l_xcec.xcec212)  THEN LET l_xcec.xcec212=0 END IF
#         #IF cl_null(l_xcec.xcec212a) THEN LET l_xcec.xcec212a=0 END IF
#         #IF cl_null(l_xcec.xcec212b) THEN LET l_xcec.xcec212=0 END IF
#         #IF cl_null(l_xcec.xcec212c) THEN LET l_xcec.xcec212c=0 END IF
#         #IF cl_null(l_xcec.xcec212d) THEN LET l_xcec.xcec212d=0 END IF
#         #IF cl_null(l_xcec.xcec212e) THEN LET l_xcec.xcec212e=0 END IF
#         #IF cl_null(l_xcec.xcec212f) THEN LET l_xcec.xcec212f=0 END IF
#         #IF cl_null(l_xcec.xcec212g) THEN LET l_xcec.xcec212g=0 END IF
#         #IF cl_null(l_xcec.xcec212h) THEN LET l_xcec.xcec212h=0 END IF
#         #160812-00020#1-e-mark
#         #160812-00020#1-s-add
#         IF cl_null(l_xcec.xcec212)  THEN LET l_xcec.xcec212  = 0 ELSE LET l_xcec.xcec212  = l_xcec.xcec212  * -1 END IF
#         IF cl_null(l_xcec.xcec212a) THEN LET l_xcec.xcec212a = 0 ELSE LET l_xcec.xcec212a = l_xcec.xcec212a * -1 END IF
#         IF cl_null(l_xcec.xcec212b) THEN LET l_xcec.xcec212b = 0 ELSE LET l_xcec.xcec212b = l_xcec.xcec212b * -1 END IF
#         IF cl_null(l_xcec.xcec212c) THEN LET l_xcec.xcec212c = 0 ELSE LET l_xcec.xcec212c = l_xcec.xcec212c * -1 END IF
#         IF cl_null(l_xcec.xcec212d) THEN LET l_xcec.xcec212d = 0 ELSE LET l_xcec.xcec212d = l_xcec.xcec212d * -1 END IF
#         IF cl_null(l_xcec.xcec212e) THEN LET l_xcec.xcec212e = 0 ELSE LET l_xcec.xcec212e = l_xcec.xcec212e * -1 END IF
#         IF cl_null(l_xcec.xcec212f) THEN LET l_xcec.xcec212f = 0 ELSE LET l_xcec.xcec212f = l_xcec.xcec212f * -1 END IF
#         IF cl_null(l_xcec.xcec212g) THEN LET l_xcec.xcec212g = 0 ELSE LET l_xcec.xcec212g = l_xcec.xcec212g * -1 END IF
#         IF cl_null(l_xcec.xcec212h) THEN LET l_xcec.xcec212h = 0 ELSE LET l_xcec.xcec212h = l_xcec.xcec212h * -1 END IF
#         #160812-00020#1-e-add 	 	         
#      ELSE
#         LET l_xceb.xceb212a = 0
#         LET l_xceb.xceb212b = 0
#         LET l_xceb.xceb212c = 0
#         LET l_xceb.xceb212d = 0
#         LET l_xceb.xceb212e = 0
#         LET l_xceb.xceb212f = 0
#         LET l_xceb.xceb212g = 0
#         LET l_xceb.xceb212h = 0
#         LET l_xceb.xceb212  = 0     
#      END IF
#      
#      IF g_glaa019 = 'Y' THEN
##         IF NOT cl_null(l_xcck.xcck033) THEN
#            LET g_sql2 = g_sql2," AND xcck032 = ? "
##         END IF
#         PREPARE axct701_01_xcck_pr3_1 FROM g_sql2
#         EXECUTE axct701_01_xcck_pr3_1 USING l_xcck.xcck002,l_xcck.xcck006,l_xcck.xcck010,l_xcck.xcck011,l_xcck.xcck009,l_xcck.xcck021,l_xcck.xcck022,l_xcck.xcck023,
#                                   l_xcck.xcck024,l_xcck.xcck025,l_xcck.xcck026,l_xcck.xcck027,l_xcck.xcck028,
#                                   l_xcck.xcck029,l_xcck.xcck030,l_xcck.xcck031,l_xcck.xcck032
#                                        INTO l_xcec.xcec222,l_xcec.xcec222a,l_xcec.xcec222b,l_xcec.xcec222c,
#                                             l_xcec.xcec222d,l_xcec.xcec222e,l_xcec.xcec222f,l_xcec.xcec222g,
#                                             l_xcec.xcec222h
#         IF SQLCA.sqlcode THEN
#            INITIALIZE g_errparam TO NULL
#            LET g_errparam.code = SQLCA.sqlcode
#            LET g_errparam.extend = "axct701_01_xcck_pr3_1"
#            LET g_errparam.popup = FALSE
#            CALL cl_err()
#
#            LET g_success = 'N'
#            RETURN g_success
#            EXIT FOREACH
#         END IF
#         #160812-00020#1-s-mark
#         #IF cl_null(l_xcec.xcec222)  THEN LET l_xcec.xcec222=0 END IF
#         #IF cl_null(l_xcec.xcec222a) THEN LET l_xcec.xcec222a=0 END IF
#         #IF cl_null(l_xcec.xcec222b) THEN LET l_xcec.xcec222=0 END IF
#         #IF cl_null(l_xcec.xcec222c) THEN LET l_xcec.xcec222c=0 END IF
#         #IF cl_null(l_xcec.xcec222d) THEN LET l_xcec.xcec222d=0 END IF
#         #IF cl_null(l_xcec.xcec222e) THEN LET l_xcec.xcec222e=0 END IF
#         #IF cl_null(l_xcec.xcec222f) THEN LET l_xcec.xcec222f=0 END IF
#         #IF cl_null(l_xcec.xcec222g) THEN LET l_xcec.xcec222g=0 END IF
#         #IF cl_null(l_xcec.xcec222h) THEN LET l_xcec.xcec222h=0 END IF
#         #160812-00020#1-e-mark
#         #160812-00020#1-s-add
#         IF cl_null(l_xcec.xcec222)  THEN LET l_xcec.xcec222  = 0 ELSE LET l_xcec.xcec222  = l_xcec.xcec222  * -1 END IF
#         IF cl_null(l_xcec.xcec222a) THEN LET l_xcec.xcec222a = 0 ELSE LET l_xcec.xcec222a = l_xcec.xcec222a * -1 END IF
#         IF cl_null(l_xcec.xcec222b) THEN LET l_xcec.xcec222b = 0 ELSE LET l_xcec.xcec222b = l_xcec.xcec222b * -1 END IF
#         IF cl_null(l_xcec.xcec222c) THEN LET l_xcec.xcec222c = 0 ELSE LET l_xcec.xcec222c = l_xcec.xcec222c * -1 END IF
#         IF cl_null(l_xcec.xcec222d) THEN LET l_xcec.xcec222d = 0 ELSE LET l_xcec.xcec222d = l_xcec.xcec222d * -1 END IF
#         IF cl_null(l_xcec.xcec222e) THEN LET l_xcec.xcec222e = 0 ELSE LET l_xcec.xcec222e = l_xcec.xcec222e * -1 END IF
#         IF cl_null(l_xcec.xcec222f) THEN LET l_xcec.xcec222f = 0 ELSE LET l_xcec.xcec222f = l_xcec.xcec222f * -1 END IF
#         IF cl_null(l_xcec.xcec222g) THEN LET l_xcec.xcec222g = 0 ELSE LET l_xcec.xcec222g = l_xcec.xcec222g * -1 END IF
#         IF cl_null(l_xcec.xcec222h) THEN LET l_xcec.xcec222h = 0 ELSE LET l_xcec.xcec222h = l_xcec.xcec222h * -1 END IF
#         #160812-00020#1-e-add 	 	         
#      ELSE
#         LET l_xceb.xceb222a = 0
#         LET l_xceb.xceb222b = 0
#         LET l_xceb.xceb222c = 0
#         LET l_xceb.xceb222d = 0
#         LET l_xceb.xceb222e = 0
#         LET l_xceb.xceb222f = 0
#         LET l_xceb.xceb222g = 0
#         LET l_xceb.xceb222h = 0
#         LET l_xceb.xceb222  = 0     
#      END IF      
#      
#      LET l_xcec.xcecent = g_enterprise 
#      LET l_xcec.xceccomp = g_xcea_m.xceacomp
#      LET l_xcec.xcecld = g_xcea_m.xceald
#      LET l_xcec.xcecdocno = g_xcea_m.xceadocno
#      #摘要
#      IF cl_null(l_xcec.xcec102) THEN
#         CALL axct701_01_get_summ(g_xcea_m.xceald,'61','8925','6') RETURNING l_success,l_xcec.xcec102
#      END IF
#      
#      CALL axct701_01_default_space_xcec(l_xcec.*) RETURNING l_xcec.xcec005,   
#                                                             l_xcec.xcec101,
#                                                             l_xcec.xcec102,
#                                                             l_xcec.xcec103,
#                                                             l_xcec.xcec110,
#                                                             l_xcec.xcec111,
#                                                             l_xcec.xcec112,
#                                                             l_xcec.xcec113,
#                                                             l_xcec.xcec114,
#                                                             l_xcec.xcec115,
#                                                             l_xcec.xcec116,
#                                                             l_xcec.xcec117,
#                                                             l_xcec.xcec118,
#                                                             l_xcec.xcec119,
#                                                             l_xcec.xcec120,
#                                                             l_xcec.xcec107,
#                                                             l_xcec.xcec108,
#                                                             l_xcec.xcec109,
#                                                             l_xcec.xcec121,
#                                                             l_xcec.xcec122,
#                                                             l_xcec.xcec123,
#                                                             l_xcec.xcec124,
#                                                             l_xcec.xcec125,
#                                                             l_xcec.xcec126,
#                                                             l_xcec.xcec127,
#                                                             l_xcec.xcec128,
#                                                             l_xcec.xcec129,
#                                                             l_xcec.xcec130                                        
##如果金额和数量都为0的话，则不产生此笔单身数据                                                             
#      IF l_xcec.xcec201= 0 AND l_xcec.xcec202 = 0 THEN
#         CONTINUE FOREACH
#      END IF      
#      #161109-00085#20-s mod      
##      INSERT INTO xcec_t VALUES(l_xcec.*)   #161109-00085#20-s mark
#      #161109-00085#63 --s mark
#      #INSERT INTO xcec_t(xcecent,xceccomp,xcecld,xcecdocno,xcecseq,xcec001,xcec002,xcec003,xcec004,
#      #                   xcec005,xcec101,xcec102,xcec103,xcec110,xcec111,xcec112,xcec113,xcec114,
#      #                   xcec115,xcec116,xcec117,xcec118,xcec119,xcec120,xcec201,xcec202,xcec202a,
#      #                   xcec202b,xcec202c,xcec202d,xcec202e,xcec202f,xcec202g,xcec202h,xcec212,
#      #                   xcec212a,xcec212b,xcec212c,xcec212d,xcec212e,xcec212f,xcec212g,xcec212h,
#      #                   xcec222,xcec222a,xcec222b,xcec222c,xcec222d,xcec222e,xcec222f,xcec222g,
#      #                   xcec222h,xcec301,xcec302,xcec107,xcec108,xcec109,xcec121,xcec122,xcec123,
#      #                   xcec124,xcec125,xcec126,xcec127,xcec128,xcec129,xcec130) 
#      #            VALUES(l_xcec.xcecent,l_xcec.xceccomp,l_xcec.xcecld,l_xcec.xcecdocno,l_xcec.xcecseq,
#      #                   l_xcec.xcec001,l_xcec.xcec002,l_xcec.xcec003,l_xcec.xcec004,l_xcec.xcec005,
#      #                   l_xcec.xcec101,l_xcec.xcec102,l_xcec.xcec103,l_xcec.xcec110,l_xcec.xcec111,
#      #                   l_xcec.xcec112,l_xcec.xcec113,l_xcec.xcec114,l_xcec.xcec115,l_xcec.xcec116,
#      #                   l_xcec.xcec117,l_xcec.xcec118,l_xcec.xcec119,l_xcec.xcec120,l_xcec.xcec201,
#      #                   l_xcec.xcec202,l_xcec.xcec202a,l_xcec.xcec202b,l_xcec.xcec202c,l_xcec.xcec202d,
#      #                   l_xcec.xcec202e,l_xcec.xcec202f,l_xcec.xcec202g,l_xcec.xcec202h,l_xcec.xcec212,
#      #                   l_xcec.xcec212a,l_xcec.xcec212b,l_xcec.xcec212c,l_xcec.xcec212d,l_xcec.xcec212e,
#      #                   l_xcec.xcec212f,l_xcec.xcec212g,l_xcec.xcec212h,l_xcec.xcec222,l_xcec.xcec222a,
#      #                   l_xcec.xcec222b,l_xcec.xcec222c,l_xcec.xcec222d,l_xcec.xcec222e,l_xcec.xcec222f,
#      #                   l_xcec.xcec222g,l_xcec.xcec222h,l_xcec.xcec301,l_xcec.xcec302,l_xcec.xcec107,
#      #                   l_xcec.xcec108,l_xcec.xcec109,l_xcec.xcec121,l_xcec.xcec122,l_xcec.xcec123,
#      #                   l_xcec.xcec124,l_xcec.xcec125,l_xcec.xcec126,l_xcec.xcec127,l_xcec.xcec128,
#      #                   l_xcec.xcec129,l_xcec.xcec130)
#      #161109-00085#63 --e mark
#      #161109-00085#20-e mod
#      #161109-00085#63 --s add
#      INSERT INTO xcec_t(xcecent,xceccomp,xcecld,xcecdocno,xcecseq,
#                         xcec001,xcec002,xcec003,xcec004,xcec005,
#                         xcec101,xcec102,xcec103,xcec110,xcec111,
#                         xcec112,xcec113,xcec114,xcec115,xcec116,
#                         xcec117,xcec118,xcec119,xcec120,xcec201,
#                         xcec202,xcec202a,xcec202b,xcec202c,xcec202d,
#                         xcec202e,xcec202f,xcec202g,xcec202h,xcec212,
#                         xcec212a,xcec212b,xcec212c,xcec212d,xcec212e,
#                         xcec212f,xcec212g,xcec212h,xcec222,xcec222a,
#                         xcec222b,xcec222c,xcec222d,xcec222e,xcec222f,
#                         xcec222g,xcec222h,xcec301,xcec302,xcecud001,
#                         xcecud002,xcecud003,xcecud004,xcecud005,xcecud006,
#                         xcecud007,xcecud008,xcecud009,xcecud010,xcecud011,
#                         xcecud012,xcecud013,xcecud014,xcecud015,xcecud016,
#                         xcecud017,xcecud018,xcecud019,xcecud020,xcecud021,
#                         xcecud022,xcecud023,xcecud024,xcecud025,xcecud026,
#                         xcecud027,xcecud028,xcecud029,xcecud030,xcec107,
#                         xcec108,xcec109,xcec121,xcec122,xcec123,
#                         xcec124,xcec125,xcec126,xcec127,xcec128,
#                         xcec129,xcec130)
#      VALUES(l_xcec.xcecent,l_xcec.xceccomp,l_xcec.xcecld,l_xcec.xcecdocno,l_xcec.xcecseq,
#             l_xcec.xcec001,l_xcec.xcec002,l_xcec.xcec003,l_xcec.xcec004,l_xcec.xcec005,
#             l_xcec.xcec101,l_xcec.xcec102,l_xcec.xcec103,l_xcec.xcec110,l_xcec.xcec111,
#             l_xcec.xcec112,l_xcec.xcec113,l_xcec.xcec114,l_xcec.xcec115,l_xcec.xcec116,
#             l_xcec.xcec117,l_xcec.xcec118,l_xcec.xcec119,l_xcec.xcec120,l_xcec.xcec201,
#             l_xcec.xcec202,l_xcec.xcec202a,l_xcec.xcec202b,l_xcec.xcec202c,l_xcec.xcec202d,
#             l_xcec.xcec202e,l_xcec.xcec202f,l_xcec.xcec202g,l_xcec.xcec202h,l_xcec.xcec212,
#             l_xcec.xcec212a,l_xcec.xcec212b,l_xcec.xcec212c,l_xcec.xcec212d,l_xcec.xcec212e,
#             l_xcec.xcec212f,l_xcec.xcec212g,l_xcec.xcec212h,l_xcec.xcec222,l_xcec.xcec222a,
#             l_xcec.xcec222b,l_xcec.xcec222c,l_xcec.xcec222d,l_xcec.xcec222e,l_xcec.xcec222f,
#             l_xcec.xcec222g,l_xcec.xcec222h,l_xcec.xcec301,l_xcec.xcec302,l_xcec.xcecud001,
#             l_xcec.xcecud002,l_xcec.xcecud003,l_xcec.xcecud004,l_xcec.xcecud005,l_xcec.xcecud006,
#             l_xcec.xcecud007,l_xcec.xcecud008,l_xcec.xcecud009,l_xcec.xcecud010,l_xcec.xcecud011,
#             l_xcec.xcecud012,l_xcec.xcecud013,l_xcec.xcecud014,l_xcec.xcecud015,l_xcec.xcecud016,
#             l_xcec.xcecud017,l_xcec.xcecud018,l_xcec.xcecud019,l_xcec.xcecud020,l_xcec.xcecud021,
#             l_xcec.xcecud022,l_xcec.xcecud023,l_xcec.xcecud024,l_xcec.xcecud025,l_xcec.xcecud026,
#             l_xcec.xcecud027,l_xcec.xcecud028,l_xcec.xcecud029,l_xcec.xcecud030,l_xcec.xcec107,
#             l_xcec.xcec108,l_xcec.xcec109,l_xcec.xcec121,l_xcec.xcec122,l_xcec.xcec123,
#             l_xcec.xcec124,l_xcec.xcec125,l_xcec.xcec126,l_xcec.xcec127,l_xcec.xcec128,
#             l_xcec.xcec129,l_xcec.xcec130)
#      #161109-00085#63 --e add
#      IF SQLCA.sqlcode THEN
#         INITIALIZE g_errparam TO NULL
#         LET g_errparam.code = SQLCA.sqlcode
#         LET g_errparam.extend = "ins xcec_t"
#         LET g_errparam.popup = TRUE
#         CALL cl_err()
#  
#         LET g_success = 'N'
#         RETURN g_success
#         EXIT FOREACH
#      END IF   
#  END FOREACH 
#  RETURN g_success
#170105-00011#3---mark---e
END FUNCTION

################################################################################
# Descriptions...: 新增axct707    6.雜項進出憑證   axct707
# Memo...........:
# Usage..........: CALL axct701_01_ins_7()
# Input parameter:  
# Return code....:  
# Date & Author..: 2014/4/22 By 01531
# Modify.........:
################################################################################
PRIVATE FUNCTION axct701_01_ins_7_bak()
#170105-00011#5---mark---s
#DEFINE l_success       LIKE type_t.num5
#DEFINE l_errno         LIKE gzze_t.gzze001
##161109-00085#18-s mod
##DEFINE l_xcea          RECORD LIKE xcea_t.*   #161109-00085#18-s mark
#DEFINE l_xcea          RECORD  #工單發料成本憑證單頭檔
#       xceaent LIKE xcea_t.xceaent, #企業編號
#       xceacomp LIKE xcea_t.xceacomp, #法人組織
#       xceald LIKE xcea_t.xceald, #帳套
#       xceadocno LIKE xcea_t.xceadocno, #單據編號
#       xcea001 LIKE xcea_t.xcea001, #單據日期
#       xcea002 LIKE xcea_t.xcea002, #成本憑證類型
#       xcea003 LIKE xcea_t.xcea003, #成本計算類型
#       xcea004 LIKE xcea_t.xcea004, #年度
#       xcea005 LIKE xcea_t.xcea005, #期別
#       xcea006 LIKE xcea_t.xcea006, #帳務人員
#       xcea007 LIKE xcea_t.xcea007, #帳務部門
#       xcea101 LIKE xcea_t.xcea101, #憑證編號
#       xcea102 LIKE xcea_t.xcea102, #憑證日期
#       xceaownid LIKE xcea_t.xceaownid, #資料所有者
#       xceaowndp LIKE xcea_t.xceaowndp, #資料所屬部門
#       xceacrtid LIKE xcea_t.xceacrtid, #資料建立者
#       xceacrtdp LIKE xcea_t.xceacrtdp, #資料建立部門
#       xceacrtdt LIKE xcea_t.xceacrtdt, #資料創建日
#       xceamodid LIKE xcea_t.xceamodid, #資料修改者
#       xceamoddt LIKE xcea_t.xceamoddt, #最近修改日
#       xceacnfid LIKE xcea_t.xceacnfid, #資料確認者
#       xceacnfdt LIKE xcea_t.xceacnfdt, #資料確認日
#       xceapstid LIKE xcea_t.xceapstid, #資料過帳者
#       xceapstdt LIKE xcea_t.xceapstdt, #資料過帳日
#       xceastus LIKE xcea_t.xceastus, #狀態碼
#       #161109-00085#63 --s add
#       xceaud001 LIKE xcea_t.xceaud001, #自定義欄位(文字)001
#       xceaud002 LIKE xcea_t.xceaud002, #自定義欄位(文字)002
#       xceaud003 LIKE xcea_t.xceaud003, #自定義欄位(文字)003
#       xceaud004 LIKE xcea_t.xceaud004, #自定義欄位(文字)004
#       xceaud005 LIKE xcea_t.xceaud005, #自定義欄位(文字)005
#       xceaud006 LIKE xcea_t.xceaud006, #自定義欄位(文字)006
#       xceaud007 LIKE xcea_t.xceaud007, #自定義欄位(文字)007
#       xceaud008 LIKE xcea_t.xceaud008, #自定義欄位(文字)008
#       xceaud009 LIKE xcea_t.xceaud009, #自定義欄位(文字)009
#       xceaud010 LIKE xcea_t.xceaud010, #自定義欄位(文字)010
#       xceaud011 LIKE xcea_t.xceaud011, #自定義欄位(數字)011
#       xceaud012 LIKE xcea_t.xceaud012, #自定義欄位(數字)012
#       xceaud013 LIKE xcea_t.xceaud013, #自定義欄位(數字)013
#       xceaud014 LIKE xcea_t.xceaud014, #自定義欄位(數字)014
#       xceaud015 LIKE xcea_t.xceaud015, #自定義欄位(數字)015
#       xceaud016 LIKE xcea_t.xceaud016, #自定義欄位(數字)016
#       xceaud017 LIKE xcea_t.xceaud017, #自定義欄位(數字)017
#       xceaud018 LIKE xcea_t.xceaud018, #自定義欄位(數字)018
#       xceaud019 LIKE xcea_t.xceaud019, #自定義欄位(數字)019
#       xceaud020 LIKE xcea_t.xceaud020, #自定義欄位(數字)020
#       xceaud021 LIKE xcea_t.xceaud021, #自定義欄位(日期時間)021
#       xceaud022 LIKE xcea_t.xceaud022, #自定義欄位(日期時間)022
#       xceaud023 LIKE xcea_t.xceaud023, #自定義欄位(日期時間)023
#       xceaud024 LIKE xcea_t.xceaud024, #自定義欄位(日期時間)024
#       xceaud025 LIKE xcea_t.xceaud025, #自定義欄位(日期時間)025
#       xceaud026 LIKE xcea_t.xceaud026, #自定義欄位(日期時間)026
#       xceaud027 LIKE xcea_t.xceaud027, #自定義欄位(日期時間)027
#       xceaud028 LIKE xcea_t.xceaud028, #自定義欄位(日期時間)028
#       xceaud029 LIKE xcea_t.xceaud029, #自定義欄位(日期時間)029
#       xceaud030 LIKE xcea_t.xceaud030, #自定義欄位(日期時間)030
#       #161109-00085#63 --e add
#       xceasite LIKE xcea_t.xceasite  #營運據點
#          END RECORD
##161109-00085#18-e mod
##161109-00085#18-s mod
##DEFINE l_xceb          RECORD LIKE xceb_t.*   #161109-00085#18-s mark
#DEFINE l_xceb          RECORD  #成本憑證第一單身檔
#       xcebent LIKE xceb_t.xcebent, #企業編號
#       xcebcomp LIKE xceb_t.xcebcomp, #法人組織
#       xcebld LIKE xceb_t.xcebld, #帳套
#       xcebdocno LIKE xceb_t.xcebdocno, #單據編號
#       xcebseq LIKE xceb_t.xcebseq, #項次
#       xceb001 LIKE xceb_t.xceb001, #參考單據編號
#       xceb002 LIKE xceb_t.xceb002, #參考單據項次
#       xceb003 LIKE xceb_t.xceb003, #單據類型
#       xceb004 LIKE xceb_t.xceb004, #料件編號
#       xceb005 LIKE xceb_t.xceb005, #特性
#       xceb101 LIKE xceb_t.xceb101, #科目編號
#       xceb102 LIKE xceb_t.xceb102, #摘要
#       xceb103 LIKE xceb_t.xceb103, #成本域
#       xceb110 LIKE xceb_t.xceb110, #原因碼
#       xceb111 LIKE xceb_t.xceb111, #收付款客商
#       xceb112 LIKE xceb_t.xceb112, #客群
#       xceb113 LIKE xceb_t.xceb113, #區域
#       xceb114 LIKE xceb_t.xceb114, #成本中心
#       xceb115 LIKE xceb_t.xceb115, #經營類別
#       xceb116 LIKE xceb_t.xceb116, #通路
#       xceb117 LIKE xceb_t.xceb117, #品類
#       xceb118 LIKE xceb_t.xceb118, #品牌
#       xceb119 LIKE xceb_t.xceb119, #專案號
#       xceb120 LIKE xceb_t.xceb120, #WBS
#       xceb201 LIKE xceb_t.xceb201, #數量
#       xceb202 LIKE xceb_t.xceb202, #成本金額(本位幣一)
#       xceb202a LIKE xceb_t.xceb202a, #成本-材料(本位幣一)
#       xceb202b LIKE xceb_t.xceb202b, #成本-人工(本位幣一)
#       xceb202c LIKE xceb_t.xceb202c, #成本-加工(本位幣一)
#       xceb202d LIKE xceb_t.xceb202d, #成本-制費一(本位幣一)
#       xceb202e LIKE xceb_t.xceb202e, #成本-制費二(本位幣一)
#       xceb202f LIKE xceb_t.xceb202f, #成本-制費三(本位幣一)
#       xceb202g LIKE xceb_t.xceb202g, #成本-制費四(本位幣一)
#       xceb202h LIKE xceb_t.xceb202h, #成本-制費五(本位幣一)
#       xceb212 LIKE xceb_t.xceb212, #成本金額(本位幣二)
#       xceb212a LIKE xceb_t.xceb212a, #成本-材料(本位幣二)
#       xceb212b LIKE xceb_t.xceb212b, #成本-人工(本位幣二)
#       xceb212c LIKE xceb_t.xceb212c, #成本-加工(本位幣二)
#       xceb212d LIKE xceb_t.xceb212d, #成本-制費一(本位幣二)
#       xceb212e LIKE xceb_t.xceb212e, #成本-制費二(本位幣二)
#       xceb212f LIKE xceb_t.xceb212f, #成本-制費三(本位幣二)
#       xceb212g LIKE xceb_t.xceb212g, #成本-制費四(本位幣二)
#       xceb212h LIKE xceb_t.xceb212h, #成本-制費五(本位幣二)
#       xceb222 LIKE xceb_t.xceb222, #成本金額(本位幣三)
#       xceb222a LIKE xceb_t.xceb222a, #成本-材料(本位幣三)
#       xceb222b LIKE xceb_t.xceb222b, #成本-人工(本位幣三)
#       xceb222c LIKE xceb_t.xceb222c, #成本-加工(本位幣三)
#       xceb222d LIKE xceb_t.xceb222d, #成本-制費一(本位幣三)
#       xceb222e LIKE xceb_t.xceb222e, #成本-制費二(本位幣三)
#       xceb222f LIKE xceb_t.xceb222f, #成本-制費三(本位幣三)
#       xceb222g LIKE xceb_t.xceb222g, #成本-制費四(本位幣三)
#       xceb222h LIKE xceb_t.xceb222h, #成本-制費五(本位幣三)
#       xceb301 LIKE xceb_t.xceb301, #憑證編號
#       xceb302 LIKE xceb_t.xceb302, #憑證項次
#       #161109-00085#63 --s add  
#       xcebud001 LIKE xceb_t.xcebud001, #自定義欄位(文字)001
#       xcebud002 LIKE xceb_t.xcebud002, #自定義欄位(文字)002
#       xcebud003 LIKE xceb_t.xcebud003, #自定義欄位(文字)003
#       xcebud004 LIKE xceb_t.xcebud004, #自定義欄位(文字)004
#       xcebud005 LIKE xceb_t.xcebud005, #自定義欄位(文字)005
#       xcebud006 LIKE xceb_t.xcebud006, #自定義欄位(文字)006
#       xcebud007 LIKE xceb_t.xcebud007, #自定義欄位(文字)007
#       xcebud008 LIKE xceb_t.xcebud008, #自定義欄位(文字)008
#       xcebud009 LIKE xceb_t.xcebud009, #自定義欄位(文字)009
#       xcebud010 LIKE xceb_t.xcebud010, #自定義欄位(文字)010
#       xcebud011 LIKE xceb_t.xcebud011, #自定義欄位(數字)011
#       xcebud012 LIKE xceb_t.xcebud012, #自定義欄位(數字)012
#       xcebud013 LIKE xceb_t.xcebud013, #自定義欄位(數字)013
#       xcebud014 LIKE xceb_t.xcebud014, #自定義欄位(數字)014
#       xcebud015 LIKE xceb_t.xcebud015, #自定義欄位(數字)015
#       xcebud016 LIKE xceb_t.xcebud016, #自定義欄位(數字)016
#       xcebud017 LIKE xceb_t.xcebud017, #自定義欄位(數字)017
#       xcebud018 LIKE xceb_t.xcebud018, #自定義欄位(數字)018
#       xcebud019 LIKE xceb_t.xcebud019, #自定義欄位(數字)019
#       xcebud020 LIKE xceb_t.xcebud020, #自定義欄位(數字)020
#       xcebud021 LIKE xceb_t.xcebud021, #自定義欄位(日期時間)021
#       xcebud022 LIKE xceb_t.xcebud022, #自定義欄位(日期時間)022
#       xcebud023 LIKE xceb_t.xcebud023, #自定義欄位(日期時間)023
#       xcebud024 LIKE xceb_t.xcebud024, #自定義欄位(日期時間)024
#       xcebud025 LIKE xceb_t.xcebud025, #自定義欄位(日期時間)025
#       xcebud026 LIKE xceb_t.xcebud026, #自定義欄位(日期時間)026
#       xcebud027 LIKE xceb_t.xcebud027, #自定義欄位(日期時間)027
#       xcebud028 LIKE xceb_t.xcebud028, #自定義欄位(日期時間)028
#       xcebud029 LIKE xceb_t.xcebud029, #自定義欄位(日期時間)029
#       xcebud030 LIKE xceb_t.xcebud030, #自定義欄位(日期時間)030
#       #161109-00085#63 --e add
#       xceb107 LIKE xceb_t.xceb107, #人員
#       xceb108 LIKE xceb_t.xceb108, #部門
#       xceb109 LIKE xceb_t.xceb109, #帳款對象
#       xceb121 LIKE xceb_t.xceb121, #自由核算項1
#       xceb122 LIKE xceb_t.xceb122, #自由核算項2
#       xceb123 LIKE xceb_t.xceb123, #自由核算項3
#       xceb124 LIKE xceb_t.xceb124, #自由核算項4
#       xceb125 LIKE xceb_t.xceb125, #自由核算項5
#       xceb126 LIKE xceb_t.xceb126, #自由核算項6
#       xceb127 LIKE xceb_t.xceb127, #自由核算項7
#       xceb128 LIKE xceb_t.xceb128, #自由核算項8
#       xceb129 LIKE xceb_t.xceb129, #自由核算項9
#       xceb130 LIKE xceb_t.xceb130, #自由核算項10
#       xceb131 LIKE xceb_t.xceb131, #單據類型(for 流通)
#       xceb132 LIKE xceb_t.xceb132  #單據日期(for 流通)
#          END RECORD
##161109-00085#18-e mod
##161109-00085#18-s mod
##DEFINE l_xcec          RECORD LIKE xcec_t.*   #161109-00085#18-s mark
#DEFINE l_xcec          RECORD  #成本憑證第二單身檔
#       xcecent LIKE xcec_t.xcecent, #企業編號
#       xceccomp LIKE xcec_t.xceccomp, #法人組織
#       xcecld LIKE xcec_t.xcecld, #帳套
#       xcecdocno LIKE xcec_t.xcecdocno, #單據編號
#       xcecseq LIKE xcec_t.xcecseq, #項次
#       xcec001 LIKE xcec_t.xcec001, #參考單據
#       xcec002 LIKE xcec_t.xcec002, #參考單據項次
#       xcec003 LIKE xcec_t.xcec003, #單據類型
#       xcec004 LIKE xcec_t.xcec004, #料件編號
#       xcec005 LIKE xcec_t.xcec005, #特性
#       xcec101 LIKE xcec_t.xcec101, #科目編號
#       xcec102 LIKE xcec_t.xcec102, #摘要
#       xcec103 LIKE xcec_t.xcec103, #成本域
#       xcec110 LIKE xcec_t.xcec110, #原因碼
#       xcec111 LIKE xcec_t.xcec111, #收付款客商
#       xcec112 LIKE xcec_t.xcec112, #客群
#       xcec113 LIKE xcec_t.xcec113, #區域
#       xcec114 LIKE xcec_t.xcec114, #成本中心
#       xcec115 LIKE xcec_t.xcec115, #經營類別
#       xcec116 LIKE xcec_t.xcec116, #通路
#       xcec117 LIKE xcec_t.xcec117, #品類
#       xcec118 LIKE xcec_t.xcec118, #品牌
#       xcec119 LIKE xcec_t.xcec119, #專案號
#       xcec120 LIKE xcec_t.xcec120, #WBS
#       xcec201 LIKE xcec_t.xcec201, #數量
#       xcec202 LIKE xcec_t.xcec202, #成本金額(本位幣一)
#       xcec202a LIKE xcec_t.xcec202a, #成本-材料(本位幣一)
#       xcec202b LIKE xcec_t.xcec202b, #成本-人工(本位幣一)
#       xcec202c LIKE xcec_t.xcec202c, #成本-加工(本位幣一)
#       xcec202d LIKE xcec_t.xcec202d, #成本-制費一(本位幣一)
#       xcec202e LIKE xcec_t.xcec202e, #成本-制費二(本位幣一)
#       xcec202f LIKE xcec_t.xcec202f, #成本-制費三(本位幣一)
#       xcec202g LIKE xcec_t.xcec202g, #成本-制費四(本位幣一)
#       xcec202h LIKE xcec_t.xcec202h, #成本-制費五(本位幣一)
#       xcec212 LIKE xcec_t.xcec212, #成本-金額(本位幣二)
#       xcec212a LIKE xcec_t.xcec212a, #成本-材料(本位幣二)
#       xcec212b LIKE xcec_t.xcec212b, #成本-人工(本位幣二)
#       xcec212c LIKE xcec_t.xcec212c, #成本-加工(本位幣二)
#       xcec212d LIKE xcec_t.xcec212d, #成本-制費一(本位幣二)
#       xcec212e LIKE xcec_t.xcec212e, #成本-制費二(本位幣二)
#       xcec212f LIKE xcec_t.xcec212f, #成本-制費三(本位幣二)
#       xcec212g LIKE xcec_t.xcec212g, #成本-制費四(本位幣二)
#       xcec212h LIKE xcec_t.xcec212h, #成本-制費五(本位幣二)
#       xcec222 LIKE xcec_t.xcec222, #成本-金額(本位幣三)
#       xcec222a LIKE xcec_t.xcec222a, #成本-材料(本位幣三)
#       xcec222b LIKE xcec_t.xcec222b, #成本-人工(本位幣三)
#       xcec222c LIKE xcec_t.xcec222c, #成本-加工(本位幣三)
#       xcec222d LIKE xcec_t.xcec222d, #成本-制費一(本位幣三)
#       xcec222e LIKE xcec_t.xcec222e, #成本-制費二(本位幣三)
#       xcec222f LIKE xcec_t.xcec222f, #成本-制費三(本位幣三)
#       xcec222g LIKE xcec_t.xcec222g, #成本-制費四(本位幣三)
#       xcec222h LIKE xcec_t.xcec222h, #成本-制費五(本位幣三)
#       xcec301 LIKE xcec_t.xcec301, #憑證編號
#       xcec302 LIKE xcec_t.xcec302, #憑證項次
#       #161109-00085#63 --s add 
#       xcecud001 LIKE xcec_t.xcecud001, #自定義欄位(文字)001
#       xcecud002 LIKE xcec_t.xcecud002, #自定義欄位(文字)002
#       xcecud003 LIKE xcec_t.xcecud003, #自定義欄位(文字)003
#       xcecud004 LIKE xcec_t.xcecud004, #自定義欄位(文字)004
#       xcecud005 LIKE xcec_t.xcecud005, #自定義欄位(文字)005
#       xcecud006 LIKE xcec_t.xcecud006, #自定義欄位(文字)006
#       xcecud007 LIKE xcec_t.xcecud007, #自定義欄位(文字)007
#       xcecud008 LIKE xcec_t.xcecud008, #自定義欄位(文字)008
#       xcecud009 LIKE xcec_t.xcecud009, #自定義欄位(文字)009
#       xcecud010 LIKE xcec_t.xcecud010, #自定義欄位(文字)010
#       xcecud011 LIKE xcec_t.xcecud011, #自定義欄位(數字)011
#       xcecud012 LIKE xcec_t.xcecud012, #自定義欄位(數字)012
#       xcecud013 LIKE xcec_t.xcecud013, #自定義欄位(數字)013
#       xcecud014 LIKE xcec_t.xcecud014, #自定義欄位(數字)014
#       xcecud015 LIKE xcec_t.xcecud015, #自定義欄位(數字)015
#       xcecud016 LIKE xcec_t.xcecud016, #自定義欄位(數字)016
#       xcecud017 LIKE xcec_t.xcecud017, #自定義欄位(數字)017
#       xcecud018 LIKE xcec_t.xcecud018, #自定義欄位(數字)018
#       xcecud019 LIKE xcec_t.xcecud019, #自定義欄位(數字)019
#       xcecud020 LIKE xcec_t.xcecud020, #自定義欄位(數字)020
#       xcecud021 LIKE xcec_t.xcecud021, #自定義欄位(日期時間)021
#       xcecud022 LIKE xcec_t.xcecud022, #自定義欄位(日期時間)022
#       xcecud023 LIKE xcec_t.xcecud023, #自定義欄位(日期時間)023
#       xcecud024 LIKE xcec_t.xcecud024, #自定義欄位(日期時間)024
#       xcecud025 LIKE xcec_t.xcecud025, #自定義欄位(日期時間)025
#       xcecud026 LIKE xcec_t.xcecud026, #自定義欄位(日期時間)026
#       xcecud027 LIKE xcec_t.xcecud027, #自定義欄位(日期時間)027
#       xcecud028 LIKE xcec_t.xcecud028, #自定義欄位(日期時間)028
#       xcecud029 LIKE xcec_t.xcecud029, #自定義欄位(日期時間)029
#       xcecud030 LIKE xcec_t.xcecud030, #自定義欄位(日期時間)030
#       #161109-00085#63 --e add
#       xcec107 LIKE xcec_t.xcec107, #人員
#       xcec108 LIKE xcec_t.xcec108, #部門
#       xcec109 LIKE xcec_t.xcec109, #帳款對象
#       xcec121 LIKE xcec_t.xcec121, #自由核算項1
#       xcec122 LIKE xcec_t.xcec122, #自由核算項2
#       xcec123 LIKE xcec_t.xcec123, #自由核算項3
#       xcec124 LIKE xcec_t.xcec124, #自由核算項4
#       xcec125 LIKE xcec_t.xcec125, #自由核算項5
#       xcec126 LIKE xcec_t.xcec126, #自由核算項6
#       xcec127 LIKE xcec_t.xcec127, #自由核算項7
#       xcec128 LIKE xcec_t.xcec128, #自由核算項8
#       xcec129 LIKE xcec_t.xcec129, #自由核算項9
#       xcec130 LIKE xcec_t.xcec130  #自由核算項10
#               END RECORD
##161109-00085#18-e mod
##161109-00085#18-s mod
##DEFINE l_xcck          RECORD LIKE xcck_t.*   #161109-00085#18-s mark
#DEFINE l_xcck          RECORD  #本期料件明細進出成本檔
#       xcckent LIKE xcck_t.xcckent, #企業編號                       
#       xccksite LIKE xcck_t.xccksite, #site組織
#       xcckcomp LIKE xcck_t.xcckcomp, #法人組織
#       xcckld LIKE xcck_t.xcckld, #帳套
#       xcck001 LIKE xcck_t.xcck001, #帳套本位幣順序
#       xcck002 LIKE xcck_t.xcck002, #成本域
#       xcck003 LIKE xcck_t.xcck003, #成本計算類型
#       xcck004 LIKE xcck_t.xcck004, #年度
#       xcck005 LIKE xcck_t.xcck005, #期別
#       xcck006 LIKE xcck_t.xcck006, #參考單號
#       xcck007 LIKE xcck_t.xcck007, #項次
#       xcck008 LIKE xcck_t.xcck008, #項序
#       xcck009 LIKE xcck_t.xcck009, #出入庫碼
#       xcck010 LIKE xcck_t.xcck010, #料號
#       xcck011 LIKE xcck_t.xcck011, #產品特徵
#       xcck012 LIKE xcck_t.xcck012, #單據類型
#       xcck013 LIKE xcck_t.xcck013, #單據日期
#       xcck014 LIKE xcck_t.xcck014, #時間
#       xcck015 LIKE xcck_t.xcck015, #倉庫編號
#       xcck016 LIKE xcck_t.xcck016, #儲位編號
#       xcck017 LIKE xcck_t.xcck017, #批號
#       xcck020 LIKE xcck_t.xcck020, #異動類型
#       xcck021 LIKE xcck_t.xcck021, #原因碼
#       xcck022 LIKE xcck_t.xcck022, #交易對象
#       xcck023 LIKE xcck_t.xcck023, #客群
#       xcck024 LIKE xcck_t.xcck024, #區域
#       xcck025 LIKE xcck_t.xcck025, #成本中心
#       xcck026 LIKE xcck_t.xcck026, #經營類別
#       xcck027 LIKE xcck_t.xcck027, #通路
#       xcck028 LIKE xcck_t.xcck028, #品類
#       xcck029 LIKE xcck_t.xcck029, #品牌
#       xcck030 LIKE xcck_t.xcck030, #專案號
#       xcck031 LIKE xcck_t.xcck031, #WBS
#       xcck032 LIKE xcck_t.xcck032, #存貨科目
#       xcck033 LIKE xcck_t.xcck033, #費用成本科目
#       xcck034 LIKE xcck_t.xcck034, #收入科目
#       xcck040 LIKE xcck_t.xcck040, #交易幣別
#       xcck041 LIKE xcck_t.xcck041, #本位幣別
#       xcck042 LIKE xcck_t.xcck042, #匯率
#       xcck043 LIKE xcck_t.xcck043, #交易單位
#       xcck044 LIKE xcck_t.xcck044, #成本單位
#       xcck045 LIKE xcck_t.xcck045, #換算率
#       xcck046 LIKE xcck_t.xcck046, #交易數量
#       xcck047 LIKE xcck_t.xcck047, #工單號碼
#       xcck048 LIKE xcck_t.xcck048, #重複性生產-計畫編號
#       xcck049 LIKE xcck_t.xcck049, #重複性生產-生產料號
#       xcck050 LIKE xcck_t.xcck050, #重複性生產-生產料號BOM特性
#       xcck051 LIKE xcck_t.xcck051, #重複性生產-生產料號產品特徵
#       xcck055 LIKE xcck_t.xcck055, #xccc類型
#       xcck201 LIKE xcck_t.xcck201, #本期異動數量
#       xcck202 LIKE xcck_t.xcck202, #本期異動金額
#       xcck202a LIKE xcck_t.xcck202a, #本期異動金額-材料
#       xcck202b LIKE xcck_t.xcck202b, #本期異動金額-人工
#       xcck202c LIKE xcck_t.xcck202c, #本期異動金額-加工費
#       xcck202d LIKE xcck_t.xcck202d, #本期異動金額-製費一
#       xcck202e LIKE xcck_t.xcck202e, #本期異動金額-製費二
#       xcck202f LIKE xcck_t.xcck202f, #本期異動金額-製費三
#       xcck202g LIKE xcck_t.xcck202g, #本期異動金額-製費四
#       xcck202h LIKE xcck_t.xcck202h, #本期異動金額-製費五
#       xcck282 LIKE xcck_t.xcck282, #本期異動單價
#       xcck282a LIKE xcck_t.xcck282a, #本期異動單價-材料
#       xcck282b LIKE xcck_t.xcck282b, #本期異動單價-人工
#       xcck282c LIKE xcck_t.xcck282c, #本期異動單價-加工
#       xcck282d LIKE xcck_t.xcck282d, #本期異動單價-製費一
#       xcck282e LIKE xcck_t.xcck282e, #本期異動單價-製費二
#       xcck282f LIKE xcck_t.xcck282f, #本期異動單價-製費三
#       xcck282g LIKE xcck_t.xcck282g, #本期異動單價-製費四
#       xcck282h LIKE xcck_t.xcck282h, #本期異動單價-製費五
#       xcck301 LIKE xcck_t.xcck301, #已耗數量
#       xcck302 LIKE xcck_t.xcck302, #已耗金額
#       xcck302a LIKE xcck_t.xcck302a, #已耗金額-材料
#       xcck302b LIKE xcck_t.xcck302b, #已耗金額-人工
#       xcck302c LIKE xcck_t.xcck302c, #已耗金額-加工費
#       xcck302d LIKE xcck_t.xcck302d, #已耗金額-製費一
#       xcck302e LIKE xcck_t.xcck302e, #已耗金額-製費二
#       xcck302f LIKE xcck_t.xcck302f, #已耗金額-製費三
#       xcck302g LIKE xcck_t.xcck302g, #已耗金額-製費四
#       xcck302h LIKE xcck_t.xcck302h, #已耗金額-製費五
#       xcck901 LIKE xcck_t.xcck901, #結存數量
#       xcck902 LIKE xcck_t.xcck902, #結存金額
#       xcck902a LIKE xcck_t.xcck902a, #結存金額-材料
#       xcck902b LIKE xcck_t.xcck902b, #結存金額-人工
#       xcck902c LIKE xcck_t.xcck902c, #結存金額-加工費
#       xcck902d LIKE xcck_t.xcck902d, #結存金額-製費一
#       xcck902e LIKE xcck_t.xcck902e, #結存金額-製費二
#       xcck902f LIKE xcck_t.xcck902f, #結存金額-製費三
#       xcck902g LIKE xcck_t.xcck902g, #結存金額-製費四
#       xcck902h LIKE xcck_t.xcck902h, #結存金額-製費五
#       xcck980 LIKE xcck_t.xcck980, #結存單位成本
#       xcck980a LIKE xcck_t.xcck980a, #結存單位成本-材料
#       xcck980b LIKE xcck_t.xcck980b, #結存單位成本-人工
#       xcck980c LIKE xcck_t.xcck980c, #結存單位成本-加工費
#       xcck980d LIKE xcck_t.xcck980d, #結存單位成本-製費一
#       xcck980e LIKE xcck_t.xcck980e, #結存單位成本-製費二
#       xcck980f LIKE xcck_t.xcck980f, #結存單位成本-製費三
#       xcck980g LIKE xcck_t.xcck980g, #結存單位成本-製費四
#       xcck980h LIKE xcck_t.xcck980h, #結存單位成本-製費五
#       xcck903 LIKE xcck_t.xcck903, #結存調整金額
#       xcck903a LIKE xcck_t.xcck903a, #結存調整金額-材料
#       xcck903b LIKE xcck_t.xcck903b, #結存調整金額-人工
#       xcck903c LIKE xcck_t.xcck903c, #結存調整金額-加工費
#       xcck903d LIKE xcck_t.xcck903d, #結存調整金額-製費一
#       xcck903e LIKE xcck_t.xcck903e, #結存調整金額-製費二
#       xcck903f LIKE xcck_t.xcck903f, #結存調整金額-製費三
#       xcck903g LIKE xcck_t.xcck903g, #結存調整金額-製費四
#       xcck903h LIKE xcck_t.xcck903h, #結存調整金額-製費五
#       xcckownid LIKE xcck_t.xcckownid, #資料所有者
#       xcckowndp LIKE xcck_t.xcckowndp, #資料所屬部門
#       xcckcrtid LIKE xcck_t.xcckcrtid, #資料建立者
#       xcckcrtdp LIKE xcck_t.xcckcrtdp, #資料建立部門
#       xcckcrtdt LIKE xcck_t.xcckcrtdt, #資料創建日
#       xcckmodid LIKE xcck_t.xcckmodid, #資料修改者
#       xcckmoddt LIKE xcck_t.xcckmoddt, #最近修改日
#       xcckstus LIKE xcck_t.xcckstus, #狀態碼
#       #161109-00085#63 --s add      
#       xcckud001 LIKE xcck_t.xcckud001, #自定義欄位(文字)001
#       xcckud002 LIKE xcck_t.xcckud002, #自定義欄位(文字)002
#       xcckud003 LIKE xcck_t.xcckud003, #自定義欄位(文字)003
#       xcckud004 LIKE xcck_t.xcckud004, #自定義欄位(文字)004
#       xcckud005 LIKE xcck_t.xcckud005, #自定義欄位(文字)005
#       xcckud006 LIKE xcck_t.xcckud006, #自定義欄位(文字)006
#       xcckud007 LIKE xcck_t.xcckud007, #自定義欄位(文字)007
#       xcckud008 LIKE xcck_t.xcckud008, #自定義欄位(文字)008
#       xcckud009 LIKE xcck_t.xcckud009, #自定義欄位(文字)009
#       xcckud010 LIKE xcck_t.xcckud010, #自定義欄位(文字)010
#       xcckud011 LIKE xcck_t.xcckud011, #自定義欄位(數字)011
#       xcckud012 LIKE xcck_t.xcckud012, #自定義欄位(數字)012
#       xcckud013 LIKE xcck_t.xcckud013, #自定義欄位(數字)013
#       xcckud014 LIKE xcck_t.xcckud014, #自定義欄位(數字)014
#       xcckud015 LIKE xcck_t.xcckud015, #自定義欄位(數字)015
#       xcckud016 LIKE xcck_t.xcckud016, #自定義欄位(數字)016
#       xcckud017 LIKE xcck_t.xcckud017, #自定義欄位(數字)017
#       xcckud018 LIKE xcck_t.xcckud018, #自定義欄位(數字)018
#       xcckud019 LIKE xcck_t.xcckud019, #自定義欄位(數字)019
#       xcckud020 LIKE xcck_t.xcckud020, #自定義欄位(數字)020
#       xcckud021 LIKE xcck_t.xcckud021, #自定義欄位(日期時間)021
#       xcckud022 LIKE xcck_t.xcckud022, #自定義欄位(日期時間)022
#       xcckud023 LIKE xcck_t.xcckud023, #自定義欄位(日期時間)023
#       xcckud024 LIKE xcck_t.xcckud024, #自定義欄位(日期時間)024
#       xcckud025 LIKE xcck_t.xcckud025, #自定義欄位(日期時間)025
#       xcckud026 LIKE xcck_t.xcckud026, #自定義欄位(日期時間)026
#       xcckud027 LIKE xcck_t.xcckud027, #自定義欄位(日期時間)027
#       xcckud028 LIKE xcck_t.xcckud028, #自定義欄位(日期時間)028
#       xcckud029 LIKE xcck_t.xcckud029, #自定義欄位(日期時間)029
#       xcckud030 LIKE xcck_t.xcckud030, #自定義欄位(日期時間)030
#       #161109-00085#63 --e add
#       xcck056 LIKE xcck_t.xcck056  #成本代銷單號
#          END RECORD
##161109-00085#18-e mod
#
#DEFINE ld_date         DATETIME YEAR TO SECOND
#
#   LET g_success = 'Y'
#   LET l_xcea.xceaownid = g_user
#   LET l_xcea.xceaowndp = g_dept
#   LET l_xcea.xceacrtid = g_user
#   LET l_xcea.xceacrtdp = g_dept 
#   LET ld_date  = cl_get_current()
#   LET l_xcea.xceacrtdt = ld_date
#   LET l_xcea.xceamodid = ""
#   LET l_xcea.xceamoddt = ""
#   CALL s_aooi200_fin_gen_docno(g_xcea_m.xceald,'','',g_xcea_m.xceadocno,g_xcea_m.xcea001,g_prog_name1)      #wujie 150214
#    RETURNING l_success,g_xcea_m.xceadocno
#   IF l_success  = 0  THEN
#      INITIALIZE g_errparam TO NULL
#      LET g_errparam.code = 'apm-00003'
#      LET g_errparam.extend = g_xcea_m.xceadocno
#      LET g_errparam.popup = TRUE
#      CALL cl_err()
#
#      LET g_success = 'N'
#      RETURN g_success
#   END IF
#   
#   INSERT INTO xcea_t (xceaent,xceald,xceacomp,xcea006,xceadocno,xcea001,xcea002,xcea004, 
#       xcea005,xcea003,xceastus,xceaownid,xceaowndp,xceacrtid,xceacrtdp,xceacrtdt, 
#       xceamodid,xceamoddt)
#   VALUES (g_enterprise,g_xcea_m.xceald,g_xcea_m.xceacomp,g_xcea_m.xcea006,g_xcea_m.xceadocno, 
#       g_xcea_m.xcea001,g_xcea002,g_xcea_m.xcea004,g_xcea_m.xcea005,g_xcea_m.xcea003, 
#       'N',l_xcea.xceaownid,l_xcea.xceaowndp,l_xcea.xceacrtid, 
#       l_xcea.xceacrtdp,ld_date,l_xcea.xceamodid,l_xcea.xceamoddt) 
#       
#   IF SQLCA.sqlcode THEN
#      INITIALIZE g_errparam TO NULL
#      LET g_errparam.code = SQLCA.sqlcode
#      LET g_errparam.extend = "g_xcea_m"
#      LET g_errparam.popup = TRUE
#      CALL cl_err()
#  
#      LET g_success = 'N'
#      RETURN g_success
#   END IF
#   
#   LET g_sql = " SELECT SUM(xcck009*xcck202), ",
#               "        SUM(xcck009*xcck202a),SUM(xcck009*xcck202b),SUM(xcck009*xcck202c),SUM(xcck009*xcck202d),",
#               "        SUM(xcck009*xcck202e),SUM(xcck009*xcck202f),SUM(xcck009*xcck202g),SUM(xcck009*xcck202h) ",
#               "        FROM xcck_t ", 
#               "  WHERE xcckent = '",g_enterprise,"' AND xcckld = '",g_xcea_m.xceald,"'",
#               "    AND xcck003 = '",g_xcea_m.xcea003,"' AND xcck004 = ",g_xcea_m.xcea004,
#               "    AND xcck005 = ",g_xcea_m.xcea005,
#              #"    AND xcck020 IN ('101','301') ",            #160420-00016 mark
#               "    AND xcck020 IN ('101','301','304') ",      #160420-00016               
#               "    AND xcck002 = ? AND xcck006 = ? ",
#               "    AND xcck007 = ? ",  #161116-00023 add
#               "    AND xcck010 = ? AND xcck011 = ? AND xcck009 = ? AND xcck021 = ? ",
#               "    AND xcck022 = ? AND xcck023 = ? AND xcck024 = ? ",
#               "    AND xcck025 = ? AND xcck026 = ? AND xcck027 = ? ",
#               "    AND xcck028 = ? AND xcck029 = ? AND xcck030 = ? ",
#               "    AND xcck031 = ? " 
#
#   LET g_sql1 = g_sql CLIPPED," AND xcck001 = '2' " 
#   LET g_sql1 = g_sql1," AND xcck033 = ? "    
#   LET g_sql2 = g_sql CLIPPED," AND xcck001 = '3' "    
#   LET g_sql2 = g_sql2," AND xcck033 = ? "
#   
#   #161116-00023 mod add xcck007
#   LET g_sql = " SELECT xcck002,xcck006,xcck007, ", 
#               "        xcck010,xcck011,xcck009,xcck021,xcck022,xcck023,xcck024,xcck025,xcck026,xcck027,xcck028,",
#               "        xcck029,xcck030,xcck031,xcck033,SUM(xcck009*xcck201),SUM(xcck009*xcck202), ",
#               "        SUM(xcck009*xcck202a),SUM(xcck009*xcck202b),SUM(xcck009*xcck202c),SUM(xcck009*xcck202d),",
#               "        SUM(xcck009*xcck202e),SUM(xcck009*xcck202f),SUM(xcck009*xcck202g),SUM(xcck009*xcck202h) ",
#               "        FROM xcck_t ", 
#               "  WHERE xcckent = '",g_enterprise,"' AND xcckld = '",g_xcea_m.xceald,"'",
#               "    AND xcck003 = '",g_xcea_m.xcea003,"' AND xcck004 = ",g_xcea_m.xcea004,
#               "    AND xcck005 = ",g_xcea_m.xcea005,
#               "    AND xcck001 = '1' ",
#              #"    AND xcck020 IN ('101','301') ",            #160420-00016 mark
#               "    AND xcck020 IN ('101','301','304') ",      #160420-00016
#               " GROUP BY xcck002,xcck006,xcck007,xcck010,xcck011,xcck009,xcck021,xcck022,xcck023,xcck024,xcck025,xcck026,xcck027,xcck028,xcck029,xcck030,xcck031,xcck033",
#               " ORDER BY xcck002,xcck006,xcck007,xcck010,xcck011,xcck009,xcck021,xcck022,xcck023,xcck024,xcck025,xcck026,xcck027,xcck028,xcck029,xcck030,xcck031,xcck033"
#   PREPARE xcck_prep FROM g_sql
#   DECLARE xcck_curs CURSOR FOR xcck_prep
#   
#
#   FOREACH xcck_curs INTO   l_xcck.xcck002,l_xcck.xcck006,
#                            l_xcck.xcck007,  #161116-00023 add
#                            l_xcck.xcck010,l_xcck.xcck011,l_xcck.xcck009,l_xcck.xcck021,l_xcck.xcck022,l_xcck.xcck023,
#                            l_xcck.xcck024,l_xcck.xcck025,l_xcck.xcck026,l_xcck.xcck027,l_xcck.xcck028,
#                            l_xcck.xcck029,l_xcck.xcck030,l_xcck.xcck031,l_xcck.xcck033,
#                            l_xcck.xcck201,l_xcck.xcck202,l_xcck.xcck202a,l_xcck.xcck202b,l_xcck.xcck202c,
#                            l_xcck.xcck202d,l_xcck.xcck202e,l_xcck.xcck202f,l_xcck.xcck202g,l_xcck.xcck202h
#
#      INITIALIZE l_xceb.* TO NULL
#
#      CASE l_xcck.xcck009
#         WHEN -1          #杂发
#            LET l_xceb.xceb003 = '5'
#         WHEN  1          #杂收
#            LET l_xceb.xceb003 = '6'        
#      END CASE
#
#      LET l_xceb.xceb001 = l_xcck.xcck006  #add zhangllc 160421 若不存值，axct708来取707资料比对时会对应不上单笔，会取到多笔的sum起来
#      LET l_xceb.xceb002 = l_xcck.xcck007  #161116-00023 add
##wujie 150409 --begin
#      SELECT inba004,inba007 INTO l_xceb.xceb108,l_xceb.xceb110   #部门
#        FROM inba_t
#       WHERE inbaent = g_enterprise
#         AND inbadocno = l_xcck.xcck006
#         
#      LET l_xceb.xceb103 = l_xcck.xcck002 #成本域
#      LET l_xceb.xceb004 = l_xcck.xcck010 #料號
#      LET l_xceb.xceb005 = l_xcck.xcck011 #特性
#      IF NOT cl_null(l_xcck.xcck021) THEN
#         LET l_xceb.xceb110 = l_xcck.xcck021 #原因碼
#      END IF
##wujie 150409 --end
#      LET l_xceb.xceb111 = l_xcck.xcck022 #交易對象      
#      LET l_xceb.xceb112 = l_xcck.xcck023 #客群 
#      LET l_xceb.xceb113 = l_xcck.xcck024 #區域  
#      LET l_xceb.xceb114 = l_xcck.xcck025 #成本中心      
#      LET l_xceb.xceb115 = l_xcck.xcck026 #經營類別
#      LET l_xceb.xceb116 = l_xcck.xcck027 #渠道
#      LET l_xceb.xceb117 = l_xcck.xcck028 #品類
#      LET l_xceb.xceb118 = l_xcck.xcck029 #品牌
#      LET l_xceb.xceb119 = l_xcck.xcck030 #項目號
#      LET l_xceb.xceb120 = l_xcck.xcck031 #WBS
#      LET l_xceb.xceb101 = l_xcck.xcck033 #費用科目  
#      
#      LET l_xceb.xceb201 = l_xcck.xcck201
#      LET l_xceb.xceb202 = l_xcck.xcck202
#      LET l_xceb.xceb202a = l_xcck.xcck202a
#      LET l_xceb.xceb202b = l_xcck.xcck202b
#      LET l_xceb.xceb202c = l_xcck.xcck202c
#      LET l_xceb.xceb202d = l_xcck.xcck202d
#      LET l_xceb.xceb202e = l_xcck.xcck202e
#      LET l_xceb.xceb202f = l_xcck.xcck202f
#      LET l_xceb.xceb202g = l_xcck.xcck202g
#      LET l_xceb.xceb202h = l_xcck.xcck202h
#      
#      IF cl_null(l_xceb.xceb201)  THEN LET l_xceb.xceb201  = 0 END IF
#      IF cl_null(l_xceb.xceb202a) THEN LET l_xceb.xceb202a = 0 END IF
#      IF cl_null(l_xceb.xceb202b) THEN LET l_xceb.xceb202b = 0 END IF
#      IF cl_null(l_xceb.xceb202c) THEN LET l_xceb.xceb202c = 0 END IF
#      IF cl_null(l_xceb.xceb202d) THEN LET l_xceb.xceb202d = 0 END IF
#      IF cl_null(l_xceb.xceb202e) THEN LET l_xceb.xceb202e = 0 END IF
#      IF cl_null(l_xceb.xceb202f) THEN LET l_xceb.xceb202f = 0 END IF
#      IF cl_null(l_xceb.xceb202g) THEN LET l_xceb.xceb202g = 0 END IF
#      IF cl_null(l_xceb.xceb202h) THEN LET l_xceb.xceb202h = 0 END IF
#      IF cl_null(l_xceb.xceb202)  THEN LET l_xceb.xceb202  = 0 END IF      
#      
#      SELECT MAX(xcebseq) INTO l_xceb.xcebseq FROM xceb_t
#       WHERE xcebent = g_enterprise AND xcebld = g_xcea_m.xceald
#         AND xcebdocno = g_xcea_m.xceadocno
#      IF cl_null(l_xceb.xcebseq) OR l_xceb.xcebseq = 0 THEN
#         LET l_xceb.xcebseq = 1
#      ELSE
#         LET l_xceb.xcebseq = l_xceb.xcebseq + 1
#      END IF  
#
#      IF cl_null(l_xcck.xcck033) THEN  
#        #杂项费用科目        
#        #160816-00015#2-s-mark
#        #抓agli180的科目
#        #IF cl_null(l_xceb.xceb101) THEN
#        #   SELECT glab005 INTO l_xceb.xceb101
#        #     FROM glab_t
#        #    WHERE glabld  = g_xcea_m.xceald
#        #      AND glab001 = '11'
#        #      AND glab002 = '216'
#        #      AND glab003 = l_xcck.xcck021
#        #      AND glabent = g_enterprise         
#        #END IF
#        #160816-00015#2-e-mark 
#        #160816-00015#2-s-add  
#         #費用科目抓不到，依部門的費用類別(aooi125)抓取agli180科目
#          IF cl_null(l_xceb.xceb101) THEN
#             CALL axct701_01_get_glab005(l_xcck.xcck025,g_xcea_m.xceald,'216',l_xcck.xcck021) 
#               RETURNING l_xceb.xceb101      
#          END IF         
#        #160816-00015#2-e-add  
#        #agli180抓不到，改抓agli201的科目
#         IF cl_null(l_xceb.xceb101) THEN
#            CALL s_fin_get_account(g_xcea_m.xceald,'60','8912','7') RETURNING l_success,l_xceb.xceb101,l_errno
#         END IF
#      ELSE
#         LET l_xceb.xceb101 = l_xcck.xcck033 
#      END IF      
#      IF g_glaa015 = 'Y' THEN
#
#         DECLARE xcck_prep2 CURSOR FROM g_sql1
#         OPEN xcck_prep2 USING l_xcck.xcck002,l_xcck.xcck006,
#                               l_xcck.xcck007, #161116-00023 add
#                               l_xcck.xcck010,l_xcck.xcck011,l_xcck.xcck009,l_xcck.xcck021,l_xcck.xcck022,l_xcck.xcck023,
#                               l_xcck.xcck024,l_xcck.xcck025,l_xcck.xcck026,l_xcck.xcck027,l_xcck.xcck028,
#                               l_xcck.xcck029,l_xcck.xcck030,l_xcck.xcck031,l_xcck.xcck033
#         FETCH xcck_prep2 INTO l_xceb.xceb212,l_xceb.xceb212a,l_xceb.xceb212b,l_xceb.xceb212c,l_xceb.xceb212d,
#                               l_xceb.xceb212e,l_xceb.xceb212f,l_xceb.xceb212g,l_xceb.xceb212h
#         
#         IF SQLCA.sqlcode THEN
#            INITIALIZE g_errparam TO NULL
#            LET g_errparam.code = SQLCA.sqlcode
#            LET g_errparam.extend = "xcck_prep2"
#            LET g_errparam.popup = FALSE
#            CALL cl_err()
#         
#            LET g_success = 'N'
#            RETURN g_success
#            EXIT FOREACH
#         END IF
#      
#         IF cl_null(l_xceb.xceb212a) THEN LET l_xceb.xceb212a = 0 END IF
#         IF cl_null(l_xceb.xceb212b) THEN LET l_xceb.xceb212b = 0 END IF
#         IF cl_null(l_xceb.xceb212c) THEN LET l_xceb.xceb212c = 0 END IF
#         IF cl_null(l_xceb.xceb212d) THEN LET l_xceb.xceb212d = 0 END IF
#         IF cl_null(l_xceb.xceb212e) THEN LET l_xceb.xceb212e = 0 END IF
#         IF cl_null(l_xceb.xceb212f) THEN LET l_xceb.xceb212f = 0 END IF
#         IF cl_null(l_xceb.xceb212g) THEN LET l_xceb.xceb212g = 0 END IF
#         IF cl_null(l_xceb.xceb212h) THEN LET l_xceb.xceb212h = 0 END IF
#         IF cl_null(l_xceb.xceb212)  THEN LET l_xceb.xceb212  = 0 END IF
#      ELSE
#         LET l_xceb.xceb212a = 0
#         LET l_xceb.xceb212b = 0
#         LET l_xceb.xceb212c = 0
#         LET l_xceb.xceb212d = 0
#         LET l_xceb.xceb212e = 0
#         LET l_xceb.xceb212f = 0
#         LET l_xceb.xceb212g = 0
#         LET l_xceb.xceb212h = 0
#         LET l_xceb.xceb212  = 0     
#      END IF
#           
#      
#      IF g_glaa019 = 'Y' THEN 
#
#         DECLARE xcck_prep3 CURSOR FROM g_sql2
#         OPEN xcck_prep3 USING l_xcck.xcck002,l_xcck.xcck006,
#                               l_xcck.xcck007,  #161116-00023 add
#                               l_xcck.xcck010,l_xcck.xcck011,l_xcck.xcck009,l_xcck.xcck021,l_xcck.xcck022,l_xcck.xcck023,
#                               l_xcck.xcck024,l_xcck.xcck025,l_xcck.xcck026,l_xcck.xcck027,l_xcck.xcck028,
#                               l_xcck.xcck029,l_xcck.xcck030,l_xcck.xcck031,l_xcck.xcck033
#         FETCH xcck_prep3 INTO l_xceb.xceb222,l_xceb.xceb222a,l_xceb.xceb222b,l_xceb.xceb222c,l_xceb.xceb222d,
#                               l_xceb.xceb222e,l_xceb.xceb222f,l_xceb.xceb222g,l_xceb.xceb222h
#         
#         IF SQLCA.sqlcode THEN
#            INITIALIZE g_errparam TO NULL
#            LET g_errparam.code = SQLCA.sqlcode
#            LET g_errparam.extend = "xcck_prep3"
#            LET g_errparam.popup = FALSE
#            CALL cl_err()
#         
#            LET g_success = 'N'
#            RETURN g_success
#            EXIT FOREACH
#         END IF
#
#         IF cl_null(l_xceb.xceb222a) THEN LET l_xceb.xceb222a = 0 END IF
#         IF cl_null(l_xceb.xceb222b) THEN LET l_xceb.xceb222b = 0 END IF
#         IF cl_null(l_xceb.xceb222c) THEN LET l_xceb.xceb222c = 0 END IF
#         IF cl_null(l_xceb.xceb222d) THEN LET l_xceb.xceb222d = 0 END IF
#         IF cl_null(l_xceb.xceb222e) THEN LET l_xceb.xceb222e = 0 END IF
#         IF cl_null(l_xceb.xceb222f) THEN LET l_xceb.xceb222f = 0 END IF
#         IF cl_null(l_xceb.xceb222g) THEN LET l_xceb.xceb222g = 0 END IF
#         IF cl_null(l_xceb.xceb222h) THEN LET l_xceb.xceb222h = 0 END IF
#         IF cl_null(l_xceb.xceb222)  THEN LET l_xceb.xceb222  = 0 END IF
#      ELSE
#         LET l_xceb.xceb222a = 0
#         LET l_xceb.xceb222b = 0
#         LET l_xceb.xceb222c = 0
#         LET l_xceb.xceb222d = 0
#         LET l_xceb.xceb222e = 0
#         LET l_xceb.xceb222f = 0
#         LET l_xceb.xceb222g = 0
#         LET l_xceb.xceb222h = 0
#         LET l_xceb.xceb222  = 0     
#      END IF
#
#      LET l_xceb.xcebent = g_enterprise 
#      LET l_xceb.xcebcomp = g_xcea_m.xceacomp
#      LET l_xceb.xcebld = g_xcea_m.xceald
#      LET l_xceb.xcebdocno = g_xcea_m.xceadocno
#      #摘要
#      IF cl_null(l_xceb.xceb102) THEN
#         CALL axct701_01_get_summ(g_xcea_m.xceald,'61','8925','7') RETURNING l_success,l_xceb.xceb102
#      END IF
#      #151013-00019#7 add ------
#      #帳款對象放aooi100的"據點對應客戶/廠商編號"
#      SELECT ooef024 INTO l_xceb.xceb109
#        FROM ooef_t
#       WHERE ooefent = g_enterprise
#         AND ooef001 = g_xcea_m.xceacomp
#      #151013-00019#7 end---
#      CALL axct701_01_default_space_xceb(l_xceb.*) RETURNING l_xceb.xceb005,
#                                                             l_xceb.xceb101,
#                                                             l_xceb.xceb102,
#                                                             l_xceb.xceb103,
#                                                             l_xceb.xceb110,
#                                                             l_xceb.xceb111,
#                                                             l_xceb.xceb112,
#                                                             l_xceb.xceb113,
#                                                             l_xceb.xceb114,
#                                                             l_xceb.xceb115,
#                                                             l_xceb.xceb116,
#                                                             l_xceb.xceb117,
#                                                             l_xceb.xceb118,
#                                                             l_xceb.xceb119,
#                                                             l_xceb.xceb120,
#                                                             l_xceb.xceb107,
#                                                             l_xceb.xceb108,
#                                                             l_xceb.xceb109,
#                                                             l_xceb.xceb121,
#                                                             l_xceb.xceb122,
#                                                             l_xceb.xceb123,
#                                                             l_xceb.xceb124,
#                                                             l_xceb.xceb125,
#                                                             l_xceb.xceb126,
#                                                             l_xceb.xceb127,
#                                                             l_xceb.xceb128,
#                                                             l_xceb.xceb129,
#                                                             l_xceb.xceb130      
#      #如果金额和数量都为0的话，则不产生此笔单身数据                                                             
#      IF l_xceb.xceb201= 0 AND l_xceb.xceb202 = 0 THEN
#         CONTINUE FOREACH
#      END IF       
#      #161109-00085#20-s mod
##      INSERT INTO xceb_t VALUES(l_xceb.*)   #161109-00085#20-s mark
#      #161109-00085#63 --s mark
#      #INSERT INTO xceb_t(xcebent,xcebcomp,xcebld,xcebdocno,xcebseq,xceb001,xceb002,xceb003,xceb004,
#      #                   xceb005,xceb101,xceb102,xceb103,xceb110,xceb111,xceb112,xceb113,xceb114,xceb115,
#      #                   xceb116,xceb117,xceb118,xceb119,xceb120,xceb201,xceb202,xceb202a,xceb202b,xceb202c,
#      #                   xceb202d,xceb202e,xceb202f,xceb202g,xceb202h,xceb212,xceb212a,xceb212b,xceb212c,
#      #                   xceb212d,xceb212e,xceb212f,xceb212g,xceb212h,xceb222,xceb222a,xceb222b,xceb222c,
#      #                   xceb222d,xceb222e,xceb222f,xceb222g,xceb222h,xceb301,xceb302,xceb107,xceb108,xceb109,
#      #                   xceb121,xceb122,xceb123,xceb124,xceb125,xceb126,xceb127,xceb128,xceb129,xceb130,xceb131,xceb132) 
#      #            VALUES(l_xceb.xcebent,l_xceb.xcebcomp,l_xceb.xcebld,l_xceb.xcebdocno,l_xceb.xcebseq,
#      #                   l_xceb.xceb001,l_xceb.xceb002,l_xceb.xceb003,l_xceb.xceb004,l_xceb.xceb005,
#      #                   l_xceb.xceb101,l_xceb.xceb102,l_xceb.xceb103,l_xceb.xceb110,l_xceb.xceb111,
#      #                   l_xceb.xceb112,l_xceb.xceb113,l_xceb.xceb114,l_xceb.xceb115,l_xceb.xceb116,
#      #                   l_xceb.xceb117,l_xceb.xceb118,l_xceb.xceb119,l_xceb.xceb120,l_xceb.xceb201,
#      #                   l_xceb.xceb202,l_xceb.xceb202a,l_xceb.xceb202b,l_xceb.xceb202c,l_xceb.xceb202d,
#      #                   l_xceb.xceb202e,l_xceb.xceb202f,l_xceb.xceb202g,l_xceb.xceb202h,l_xceb.xceb212,
#      #                   l_xceb.xceb212a,l_xceb.xceb212b,l_xceb.xceb212c,l_xceb.xceb212d,l_xceb.xceb212e,
#      #                   l_xceb.xceb212f,l_xceb.xceb212g,l_xceb.xceb212h,l_xceb.xceb222,l_xceb.xceb222a,
#      #                   l_xceb.xceb222b,l_xceb.xceb222c,l_xceb.xceb222d,l_xceb.xceb222e,l_xceb.xceb222f,
#      #                   l_xceb.xceb222g,l_xceb.xceb222h,l_xceb.xceb301,l_xceb.xceb302,l_xceb.xceb107,
#      #                   l_xceb.xceb108,l_xceb.xceb109,l_xceb.xceb121,l_xceb.xceb122,l_xceb.xceb123,
#      #                   l_xceb.xceb124,l_xceb.xceb125,l_xceb.xceb126,l_xceb.xceb127,l_xceb.xceb128,
#      #                   l_xceb.xceb129,l_xceb.xceb130,l_xceb.xceb131,l_xceb.xceb132)
#      #161109-00085#20-e mod
#      #161109-00085#63 --e mark
#      #161109-00085#63 --s add
#      INSERT INTO xceb_t(xcebent,xcebcomp,xcebld,xcebdocno,xcebseq,
#                         xceb001,xceb002,xceb003,xceb004,xceb005,
#                         xceb101,xceb102,xceb103,xceb110,xceb111,
#                         xceb112,xceb113,xceb114,xceb115,xceb116,
#                         xceb117,xceb118,xceb119,xceb120,xceb201,
#                         xceb202,xceb202a,xceb202b,xceb202c,xceb202d,
#                         xceb202e,xceb202f,xceb202g,xceb202h,xceb212,
#                         xceb212a,xceb212b,xceb212c,xceb212d,xceb212e,
#                         xceb212f,xceb212g,xceb212h,xceb222,xceb222a,
#                         xceb222b,xceb222c,xceb222d,xceb222e,xceb222f,
#                         xceb222g,xceb222h,xceb301,xceb302,xcebud001,
#                         xcebud002,xcebud003,xcebud004,xcebud005,xcebud006,
#                         xcebud007,xcebud008,xcebud009,xcebud010,xcebud011,
#                         xcebud012,xcebud013,xcebud014,xcebud015,xcebud016,
#                         xcebud017,xcebud018,xcebud019,xcebud020,xcebud021,
#                         xcebud022,xcebud023,xcebud024,xcebud025,xcebud026,
#                         xcebud027,xcebud028,xcebud029,xcebud030,xceb107,
#                         xceb108,xceb109,xceb121,xceb122,xceb123,
#                         xceb124,xceb125,xceb126,xceb127,xceb128,
#                         xceb129,xceb130,xceb131,xceb132)
#      VALUES(l_xceb.xcebent,l_xceb.xcebcomp,l_xceb.xcebld,l_xceb.xcebdocno,l_xceb.xcebseq,
#             l_xceb.xceb001,l_xceb.xceb002,l_xceb.xceb003,l_xceb.xceb004,l_xceb.xceb005,
#             l_xceb.xceb101,l_xceb.xceb102,l_xceb.xceb103,l_xceb.xceb110,l_xceb.xceb111,
#             l_xceb.xceb112,l_xceb.xceb113,l_xceb.xceb114,l_xceb.xceb115,l_xceb.xceb116,
#             l_xceb.xceb117,l_xceb.xceb118,l_xceb.xceb119,l_xceb.xceb120,l_xceb.xceb201,
#             l_xceb.xceb202,l_xceb.xceb202a,l_xceb.xceb202b,l_xceb.xceb202c,l_xceb.xceb202d,
#             l_xceb.xceb202e,l_xceb.xceb202f,l_xceb.xceb202g,l_xceb.xceb202h,l_xceb.xceb212,
#             l_xceb.xceb212a,l_xceb.xceb212b,l_xceb.xceb212c,l_xceb.xceb212d,l_xceb.xceb212e,
#             l_xceb.xceb212f,l_xceb.xceb212g,l_xceb.xceb212h,l_xceb.xceb222,l_xceb.xceb222a,
#             l_xceb.xceb222b,l_xceb.xceb222c,l_xceb.xceb222d,l_xceb.xceb222e,l_xceb.xceb222f,
#             l_xceb.xceb222g,l_xceb.xceb222h,l_xceb.xceb301,l_xceb.xceb302,l_xceb.xcebud001,
#             l_xceb.xcebud002,l_xceb.xcebud003,l_xceb.xcebud004,l_xceb.xcebud005,l_xceb.xcebud006,
#             l_xceb.xcebud007,l_xceb.xcebud008,l_xceb.xcebud009,l_xceb.xcebud010,l_xceb.xcebud011,
#             l_xceb.xcebud012,l_xceb.xcebud013,l_xceb.xcebud014,l_xceb.xcebud015,l_xceb.xcebud016,
#             l_xceb.xcebud017,l_xceb.xcebud018,l_xceb.xcebud019,l_xceb.xcebud020,l_xceb.xcebud021,
#             l_xceb.xcebud022,l_xceb.xcebud023,l_xceb.xcebud024,l_xceb.xcebud025,l_xceb.xcebud026,
#             l_xceb.xcebud027,l_xceb.xcebud028,l_xceb.xcebud029,l_xceb.xcebud030,l_xceb.xceb107,
#             l_xceb.xceb108,l_xceb.xceb109,l_xceb.xceb121,l_xceb.xceb122,l_xceb.xceb123,
#             l_xceb.xceb124,l_xceb.xceb125,l_xceb.xceb126,l_xceb.xceb127,l_xceb.xceb128,
#             l_xceb.xceb129,l_xceb.xceb130,l_xceb.xceb131,l_xceb.xceb132)
#      #161109-00085#63 --e add
#      IF SQLCA.sqlcode THEN
#         INITIALIZE g_errparam TO NULL
#         LET g_errparam.code = SQLCA.sqlcode
#         LET g_errparam.extend = "ins xceb"
#         LET g_errparam.popup = TRUE
#         CALL cl_err()
#  
#         LET g_success = 'N'
#         RETURN g_success
#         EXIT FOREACH
#      END IF   
#      CLOSE xcck_prep2
#      CLOSE xcck_prep3  
#  END FOREACH  
#  
#  LET g_sql = " SELECT  SUM(xcck009*xcck202), ",
#               "        SUM(xcck009*xcck202a),SUM(xcck009*xcck202b),SUM(xcck009*xcck202c),SUM(xcck009*xcck202d),",
#               "        SUM(xcck009*xcck202e),SUM(xcck009*xcck202f),SUM(xcck009*xcck202g),SUM(xcck009*xcck202h) ",
#               "        FROM xcck_t ", 
#               "  WHERE xcckent = '",g_enterprise,"' AND xcckld = '",g_xcea_m.xceald,"'",
#               "    AND xcck003 = '",g_xcea_m.xcea003,"' AND xcck004 = ",g_xcea_m.xcea004,
#               "    AND xcck005 = ",g_xcea_m.xcea005,
#              #"    AND xcck020 IN ('101','301') ",            #160420-00016 mark
#               "    AND xcck020 IN ('101','301','304') ",      #160420-00016          
#               "    AND xcck002 = ? AND xcck006 = ? ",
#               "    AND xcck007 = ? ",  #161116-00023 add
#               "    AND xcck010 = ? AND xcck011 = ? AND xcck009 = ? AND xcck021 = ? ",
#               "    AND xcck022 = ? AND xcck023 = ? AND xcck024 = ? ",
#               "    AND xcck025 = ? AND xcck026 = ? AND xcck027 = ? ",
#               "    AND xcck028 = ? AND xcck029 = ? AND xcck030 = ? ",
#               "    AND xcck031 = ? " 
#  
#   LET g_sql1 = g_sql CLIPPED," AND xcck001 = '2' " 
#   LET g_sql1 = g_sql1," AND xcck032 = ? "
#   LET g_sql2 = g_sql CLIPPED," AND xcck001 = '3' " 
#   LET g_sql2 = g_sql2," AND xcck032 = ? "
#   
#   #161116-00023 mod add xcck007
#   LET g_sql = " SELECT xcck002,xcck006,xcck007, ",
#               "        xcck010,xcck011,xcck009,xcck021,xcck022,xcck023,xcck024,xcck025,xcck026,xcck027,xcck028,",
#               "        xcck029,xcck030,xcck031,xcck032,SUM(xcck009*xcck201),SUM(xcck009*xcck202), ",
#               "        SUM(xcck009*xcck202a),SUM(xcck009*xcck202b),SUM(xcck009*xcck202c),SUM(xcck009*xcck202d),",
#               "        SUM(xcck009*xcck202e),SUM(xcck009*xcck202f),SUM(xcck009*xcck202g),SUM(xcck009*xcck202h) ",
#               "        FROM xcck_t ", 
#               "  WHERE xcckent = '",g_enterprise,"' AND xcckld = '",g_xcea_m.xceald,"'",
#               "    AND xcck003 = '",g_xcea_m.xcea003,"' AND xcck004 = ",g_xcea_m.xcea004,
#               "    AND xcck005 = ",g_xcea_m.xcea005,
#               "    AND xcck001 = '1' ",
#              #"    AND xcck020 IN ('101','301') ",            #160420-00016 mark
#               "    AND xcck020 IN ('101','301','304') ",      #160420-00016              
#               " GROUP BY xcck002,xcck006,xcck007,xcck010,xcck011,xcck009,xcck021,xcck022,xcck023,xcck024,xcck025,xcck026,xcck027,xcck028,xcck029,xcck030,xcck031,xcck032",
#               " ORDER BY xcck002,xcck006,xcck007,xcck010,xcck011,xcck009,xcck021,xcck022,xcck023,xcck024,xcck025,xcck026,xcck027,xcck028,xcck029,xcck030,xcck031,xcck032"
#   PREPARE xcck_prep_1 FROM g_sql
#   DECLARE xcck_curs_1 CURSOR FOR xcck_prep_1
#   
#
#   FOREACH xcck_curs_1 INTO l_xcck.xcck002,l_xcck.xcck006,
#                            l_xcck.xcck007,  #161116-00023  add
#                            l_xcck.xcck010,l_xcck.xcck011,l_xcck.xcck009,l_xcck.xcck021,l_xcck.xcck022,l_xcck.xcck023,
#                            l_xcck.xcck024,l_xcck.xcck025,l_xcck.xcck026,l_xcck.xcck027,l_xcck.xcck028,
#                            l_xcck.xcck029,l_xcck.xcck030,l_xcck.xcck031,l_xcck.xcck032,
#                            l_xcck.xcck201,l_xcck.xcck202,l_xcck.xcck202a,l_xcck.xcck202b,l_xcck.xcck202c,
#                            l_xcck.xcck202d,l_xcck.xcck202e,l_xcck.xcck202f,l_xcck.xcck202g,l_xcck.xcck202h
#
#      INITIALIZE l_xcec.* TO NULL
#      
#      CASE l_xcck.xcck009
#         WHEN -1          #杂发
#            LET l_xcec.xcec003 = '5'
#         WHEN  1          #杂收
#            LET l_xcec.xcec003 = '6'        
#      END CASE
#     
#      LET l_xcec.xcec001 = l_xcck.xcck006  #add zhangllc 160421 若不存值，axct708来取707资料比对时会对应不上单笔，会取到多笔的sum起来
#      LET l_xcec.xcec002 = l_xcck.xcck007  #161116-00023 add
#     #wujie 150409 --begin
#      SELECT inba004,inba007 INTO l_xcec.xcec108,l_xcec.xcec110   #部门
#        FROM inba_t
#       WHERE inbaent = g_enterprise
#         AND inbadocno = l_xcck.xcck006  
#         
#      LET l_xcec.xcec103 = l_xcck.xcck002 #成本域
#      LET l_xcec.xcec004 = l_xcck.xcck010 #料號
#      LET l_xcec.xcec005 = l_xcck.xcck011 #特性
#      IF NOT cl_null(l_xcck.xcck021) THEN
#         LET l_xcec.xcec110 = l_xcck.xcck021 #原因碼
#      END IF
#     #wujie 150409 --end
#      LET l_xcec.xcec111 = l_xcck.xcck022 #交易對象      
#      LET l_xcec.xcec112 = l_xcck.xcck023 #客群 
#      LET l_xcec.xcec113 = l_xcck.xcck024 #區域  
#      LET l_xcec.xcec114 = l_xcck.xcck025 #成本中心      
#      LET l_xcec.xcec115 = l_xcck.xcck026 #經營類別
#      LET l_xcec.xcec116 = l_xcck.xcck027 #渠道
#      LET l_xcec.xcec117 = l_xcck.xcck028 #品類
#      LET l_xcec.xcec118 = l_xcck.xcck029 #品牌
#      LET l_xcec.xcec119 = l_xcck.xcck030 #項目號
#      LET l_xcec.xcec120 = l_xcck.xcck031 #WBS
#      LET l_xcec.xcec101 = l_xcck.xcck032 #存貨科目 
#
#  
#
#      LET l_xcec.xcec201 = l_xcck.xcck201  #add zhangllc 160419 结局有金额，数量为0的问题
#      LET l_xcec.xcec202 = l_xcck.xcck202
#      LET l_xcec.xcec202a = l_xcck.xcck202a
#      LET l_xcec.xcec202b = l_xcck.xcck202b
#      LET l_xcec.xcec202c = l_xcck.xcck202c
#      LET l_xcec.xcec202d = l_xcck.xcck202d
#      LET l_xcec.xcec202e = l_xcck.xcck202e
#      LET l_xcec.xcec202f = l_xcck.xcck202f
#      LET l_xcec.xcec202g = l_xcck.xcck202g
#      LET l_xcec.xcec202h = l_xcck.xcck202h
#      
#      IF cl_null(l_xcec.xcec202a) THEN LET l_xcec.xcec202a = 0 END IF
#      IF cl_null(l_xcec.xcec202b) THEN LET l_xcec.xcec202b = 0 END IF
#      IF cl_null(l_xcec.xcec202c) THEN LET l_xcec.xcec202c = 0 END IF
#      IF cl_null(l_xcec.xcec202d) THEN LET l_xcec.xcec202d = 0 END IF
#      IF cl_null(l_xcec.xcec202e) THEN LET l_xcec.xcec202e = 0 END IF
#      IF cl_null(l_xcec.xcec202f) THEN LET l_xcec.xcec202f = 0 END IF
#      IF cl_null(l_xcec.xcec202g) THEN LET l_xcec.xcec202g = 0 END IF
#      IF cl_null(l_xcec.xcec202h) THEN LET l_xcec.xcec202h = 0 END IF
#      IF cl_null(l_xcec.xcec202)  THEN LET l_xcec.xcec202  = 0 END IF         
#      IF cl_null(l_xcec.xcec201)  THEN LET l_xcec.xcec201  = 0 END IF        
#      
#      SELECT MAX(xcecseq) INTO l_xcec.xcecseq FROM xcec_t
#       WHERE xcecent = g_enterprise AND xcecld = g_xcea_m.xceald
#         AND xcecdocno = g_xcea_m.xceadocno
#      IF cl_null(l_xcec.xcecseq) OR l_xcec.xcecseq = 0 THEN
#         LET l_xcec.xcecseq = 1
#      ELSE
#         LET l_xcec.xcecseq = l_xcec.xcecseq + 1
#      END IF  
#
#      IF cl_null(l_xcck.xcck032) THEN  
#         CALL s_get_item_acc(g_xcea_m.xceald,'1',l_xcec.xcec004,'','',g_xcea_m.xceacomp,'')  #存貨科目   #wujie 150214
#          RETURNING l_success,l_xcec.xcec101    
#      ELSE
#         LET l_xcec.xcec101 = l_xcck.xcck032 
#      END IF      
#    
#      IF g_glaa015 ='Y' THEN
#
#         DECLARE xcck_prep2_1 CURSOR FROM g_sql1
#         OPEN xcck_prep2_1 USING l_xcck.xcck002,l_xcck.xcck006,
#                                 l_xcck.xcck007,  #161116-00023 add
#                                 l_xcck.xcck010,l_xcck.xcck011,l_xcck.xcck009,l_xcck.xcck021,l_xcck.xcck022,l_xcck.xcck023,
#                                 l_xcck.xcck024,l_xcck.xcck025,l_xcck.xcck026,l_xcck.xcck027,l_xcck.xcck028,
#                                 l_xcck.xcck029,l_xcck.xcck030,l_xcck.xcck031,l_xcck.xcck032
#         FETCH xcck_prep2_1 INTO l_xcec.xcec212,l_xcec.xcec212a,l_xcec.xcec212b,l_xcec.xcec212c,l_xcec.xcec212d,
#                               l_xcec.xcec212e,l_xcec.xcec212f,l_xcec.xcec212g,l_xcec.xcec212h
#         
#         IF SQLCA.sqlcode THEN
#            INITIALIZE g_errparam TO NULL
#            LET g_errparam.code = SQLCA.sqlcode
#            LET g_errparam.extend = "xcck_prep2_1"
#            LET g_errparam.popup = FALSE
#            CALL cl_err()         
#            LET g_success = 'N'
#            RETURN g_success
#            EXIT FOREACH
#         END IF
#         
#         IF cl_null(l_xcec.xcec212a) THEN LET l_xcec.xcec212a = 0 END IF
#         IF cl_null(l_xcec.xcec212b) THEN LET l_xcec.xcec212b = 0 END IF
#         IF cl_null(l_xcec.xcec212c) THEN LET l_xcec.xcec212c = 0 END IF
#         IF cl_null(l_xcec.xcec212d) THEN LET l_xcec.xcec212d = 0 END IF
#         IF cl_null(l_xcec.xcec212e) THEN LET l_xcec.xcec212e = 0 END IF
#         IF cl_null(l_xcec.xcec212f) THEN LET l_xcec.xcec212f = 0 END IF
#         IF cl_null(l_xcec.xcec212g) THEN LET l_xcec.xcec212g = 0 END IF
#         IF cl_null(l_xcec.xcec212h) THEN LET l_xcec.xcec212h = 0 END IF
#         IF cl_null(l_xcec.xcec212)  THEN LET l_xcec.xcec212  = 0 END IF 
#      ELSE
#         LET l_xceb.xceb212a = 0
#         LET l_xceb.xceb212b = 0
#         LET l_xceb.xceb212c = 0
#         LET l_xceb.xceb212d = 0
#         LET l_xceb.xceb212e = 0
#         LET l_xceb.xceb212f = 0
#         LET l_xceb.xceb212g = 0
#         LET l_xceb.xceb212h = 0
#         LET l_xceb.xceb212  = 0     
#      END IF         
#      
#      IF g_glaa019 ='Y' THEN
#
#         DECLARE xcck_prep3_1 CURSOR FROM g_sql2
#         OPEN xcck_prep3_1 USING l_xcck.xcck002,l_xcck.xcck006,
#                                 l_xcck.xcck007,  #161116-00023 add
#                                 l_xcck.xcck010,l_xcck.xcck011,l_xcck.xcck009,l_xcck.xcck021,l_xcck.xcck022,l_xcck.xcck023,
#                                 l_xcck.xcck024,l_xcck.xcck025,l_xcck.xcck026,l_xcck.xcck027,l_xcck.xcck028,
#                                 l_xcck.xcck029,l_xcck.xcck030,l_xcck.xcck031,l_xcck.xcck032
#         FETCH xcck_prep3_1 INTO l_xcec.xcec222,l_xcec.xcec222a,l_xcec.xcec222b,l_xcec.xcec222c,l_xcec.xcec222d,
#                                 l_xcec.xcec222e,l_xcec.xcec222f,l_xcec.xcec222g,l_xcec.xcec222h
#         
#         IF SQLCA.sqlcode THEN
#            INITIALIZE g_errparam TO NULL
#            LET g_errparam.code = SQLCA.sqlcode
#            LET g_errparam.extend = "xcck_prep3_1"
#            LET g_errparam.popup = FALSE
#            CALL cl_err()
#         
#            LET g_success = 'N'
#            RETURN g_success
#            EXIT FOREACH
#         END IF
#         
#         IF cl_null(l_xcec.xcec222a) THEN LET l_xcec.xcec222a = 0 END IF
#         IF cl_null(l_xcec.xcec222b) THEN LET l_xcec.xcec222b = 0 END IF
#         IF cl_null(l_xcec.xcec222c) THEN LET l_xcec.xcec222c = 0 END IF
#         IF cl_null(l_xcec.xcec222d) THEN LET l_xcec.xcec222d = 0 END IF
#         IF cl_null(l_xcec.xcec222e) THEN LET l_xcec.xcec222e = 0 END IF
#         IF cl_null(l_xcec.xcec222f) THEN LET l_xcec.xcec222f = 0 END IF
#         IF cl_null(l_xcec.xcec222g) THEN LET l_xcec.xcec222g = 0 END IF
#         IF cl_null(l_xcec.xcec222h) THEN LET l_xcec.xcec222h = 0 END IF
#         IF cl_null(l_xcec.xcec222)  THEN LET l_xcec.xcec222  = 0 END IF  
#      ELSE
#         LET l_xceb.xceb222a = 0
#         LET l_xceb.xceb222b = 0
#         LET l_xceb.xceb222c = 0
#         LET l_xceb.xceb222d = 0
#         LET l_xceb.xceb222e = 0
#         LET l_xceb.xceb222f = 0
#         LET l_xceb.xceb222g = 0
#         LET l_xceb.xceb222h = 0
#         LET l_xceb.xceb222  = 0     
#      END IF         
#      
#      
#      LET l_xcec.xcecent = g_enterprise 
#      LET l_xcec.xceccomp = g_xcea_m.xceacomp
#      LET l_xcec.xcecld = g_xcea_m.xceald
#      LET l_xcec.xcecdocno = g_xcea_m.xceadocno
#      #摘要
#      IF cl_null(l_xcec.xcec102) THEN
#         CALL axct701_01_get_summ(g_xcea_m.xceald,'61','8925','7') RETURNING l_success,l_xcec.xcec102
#      END IF
#      
#     CALL axct701_01_default_space_xcec(l_xcec.*) RETURNING l_xcec.xcec005,   
#                                                             l_xcec.xcec101,
#                                                             l_xcec.xcec102,
#                                                             l_xcec.xcec103,
#                                                             l_xcec.xcec110,
#                                                             l_xcec.xcec111,
#                                                             l_xcec.xcec112,
#                                                             l_xcec.xcec113,
#                                                             l_xcec.xcec114,
#                                                             l_xcec.xcec115,
#                                                             l_xcec.xcec116,
#                                                             l_xcec.xcec117,
#                                                             l_xcec.xcec118,
#                                                             l_xcec.xcec119,
#                                                             l_xcec.xcec120,
#                                                             l_xcec.xcec107,
#                                                             l_xcec.xcec108,
#                                                             l_xcec.xcec109,
#                                                             l_xcec.xcec121,
#                                                             l_xcec.xcec122,
#                                                             l_xcec.xcec123,
#                                                             l_xcec.xcec124,
#                                                             l_xcec.xcec125,
#                                                             l_xcec.xcec126,
#                                                             l_xcec.xcec127,
#                                                             l_xcec.xcec128,
#                                                             l_xcec.xcec129,
#                                                             l_xcec.xcec130                                          
#      #如果金额和数量都为0的话，则不产生此笔单身数据                                                             
#      IF l_xcec.xcec201= 0 AND l_xcec.xcec202 = 0 THEN
#         CONTINUE FOREACH
#      END IF      
#      #161109-00085#20-s mod      
##      INSERT INTO xcec_t VALUES(l_xcec.*)   #161109-00085#20-s mark
#      #161109-00085#63 --s mark
#      #INSERT INTO xcec_t(xcecent,xceccomp,xcecld,xcecdocno,xcecseq,xcec001,xcec002,xcec003,xcec004,
#      #                   xcec005,xcec101,xcec102,xcec103,xcec110,xcec111,xcec112,xcec113,xcec114,
#      #                   xcec115,xcec116,xcec117,xcec118,xcec119,xcec120,xcec201,xcec202,xcec202a,
#      #                   xcec202b,xcec202c,xcec202d,xcec202e,xcec202f,xcec202g,xcec202h,xcec212,
#      #                   xcec212a,xcec212b,xcec212c,xcec212d,xcec212e,xcec212f,xcec212g,xcec212h,
#      #                   xcec222,xcec222a,xcec222b,xcec222c,xcec222d,xcec222e,xcec222f,xcec222g,
#      #                   xcec222h,xcec301,xcec302,xcec107,xcec108,xcec109,xcec121,xcec122,xcec123,
#      #                   xcec124,xcec125,xcec126,xcec127,xcec128,xcec129,xcec130) 
#      #            VALUES(l_xcec.xcecent,l_xcec.xceccomp,l_xcec.xcecld,l_xcec.xcecdocno,l_xcec.xcecseq,
#      #                   l_xcec.xcec001,l_xcec.xcec002,l_xcec.xcec003,l_xcec.xcec004,l_xcec.xcec005,
#      #                   l_xcec.xcec101,l_xcec.xcec102,l_xcec.xcec103,l_xcec.xcec110,l_xcec.xcec111,
#      #                   l_xcec.xcec112,l_xcec.xcec113,l_xcec.xcec114,l_xcec.xcec115,l_xcec.xcec116,
#      #                   l_xcec.xcec117,l_xcec.xcec118,l_xcec.xcec119,l_xcec.xcec120,l_xcec.xcec201,
#      #                   l_xcec.xcec202,l_xcec.xcec202a,l_xcec.xcec202b,l_xcec.xcec202c,l_xcec.xcec202d,
#      #                   l_xcec.xcec202e,l_xcec.xcec202f,l_xcec.xcec202g,l_xcec.xcec202h,l_xcec.xcec212,
#      #                   l_xcec.xcec212a,l_xcec.xcec212b,l_xcec.xcec212c,l_xcec.xcec212d,l_xcec.xcec212e,
#      #                   l_xcec.xcec212f,l_xcec.xcec212g,l_xcec.xcec212h,l_xcec.xcec222,l_xcec.xcec222a,
#      #                   l_xcec.xcec222b,l_xcec.xcec222c,l_xcec.xcec222d,l_xcec.xcec222e,l_xcec.xcec222f,
#      #                   l_xcec.xcec222g,l_xcec.xcec222h,l_xcec.xcec301,l_xcec.xcec302,l_xcec.xcec107,
#      #                   l_xcec.xcec108,l_xcec.xcec109,l_xcec.xcec121,l_xcec.xcec122,l_xcec.xcec123,
#      #                   l_xcec.xcec124,l_xcec.xcec125,l_xcec.xcec126,l_xcec.xcec127,l_xcec.xcec128,
#      #                   l_xcec.xcec129,l_xcec.xcec130)
#      #161109-00085#63 --e mark
#      #161109-00085#20-e mod
#      #161109-00085#63 --s add
#      INSERT INTO xcec_t(xcecent,xceccomp,xcecld,xcecdocno,xcecseq,
#                         xcec001,xcec002,xcec003,xcec004,xcec005,
#                         xcec101,xcec102,xcec103,xcec110,xcec111,
#                         xcec112,xcec113,xcec114,xcec115,xcec116,
#                         xcec117,xcec118,xcec119,xcec120,xcec201,
#                         xcec202,xcec202a,xcec202b,xcec202c,xcec202d,
#                         xcec202e,xcec202f,xcec202g,xcec202h,xcec212,
#                         xcec212a,xcec212b,xcec212c,xcec212d,xcec212e,
#                         xcec212f,xcec212g,xcec212h,xcec222,xcec222a,
#                         xcec222b,xcec222c,xcec222d,xcec222e,xcec222f,
#                         xcec222g,xcec222h,xcec301,xcec302,xcecud001,
#                         xcecud002,xcecud003,xcecud004,xcecud005,xcecud006,
#                         xcecud007,xcecud008,xcecud009,xcecud010,xcecud011,
#                         xcecud012,xcecud013,xcecud014,xcecud015,xcecud016,
#                         xcecud017,xcecud018,xcecud019,xcecud020,xcecud021,
#                         xcecud022,xcecud023,xcecud024,xcecud025,xcecud026,
#                         xcecud027,xcecud028,xcecud029,xcecud030,xcec107,
#                         xcec108,xcec109,xcec121,xcec122,xcec123,
#                         xcec124,xcec125,xcec126,xcec127,xcec128,
#                         xcec129,xcec130)
#      VALUES(l_xcec.xcecent,l_xcec.xceccomp,l_xcec.xcecld,l_xcec.xcecdocno,l_xcec.xcecseq,
#             l_xcec.xcec001,l_xcec.xcec002,l_xcec.xcec003,l_xcec.xcec004,l_xcec.xcec005,
#             l_xcec.xcec101,l_xcec.xcec102,l_xcec.xcec103,l_xcec.xcec110,l_xcec.xcec111,
#             l_xcec.xcec112,l_xcec.xcec113,l_xcec.xcec114,l_xcec.xcec115,l_xcec.xcec116,
#             l_xcec.xcec117,l_xcec.xcec118,l_xcec.xcec119,l_xcec.xcec120,l_xcec.xcec201,
#             l_xcec.xcec202,l_xcec.xcec202a,l_xcec.xcec202b,l_xcec.xcec202c,l_xcec.xcec202d,
#             l_xcec.xcec202e,l_xcec.xcec202f,l_xcec.xcec202g,l_xcec.xcec202h,l_xcec.xcec212,
#             l_xcec.xcec212a,l_xcec.xcec212b,l_xcec.xcec212c,l_xcec.xcec212d,l_xcec.xcec212e,
#             l_xcec.xcec212f,l_xcec.xcec212g,l_xcec.xcec212h,l_xcec.xcec222,l_xcec.xcec222a,
#             l_xcec.xcec222b,l_xcec.xcec222c,l_xcec.xcec222d,l_xcec.xcec222e,l_xcec.xcec222f,
#             l_xcec.xcec222g,l_xcec.xcec222h,l_xcec.xcec301,l_xcec.xcec302,l_xcec.xcecud001,
#             l_xcec.xcecud002,l_xcec.xcecud003,l_xcec.xcecud004,l_xcec.xcecud005,l_xcec.xcecud006,
#             l_xcec.xcecud007,l_xcec.xcecud008,l_xcec.xcecud009,l_xcec.xcecud010,l_xcec.xcecud011,
#             l_xcec.xcecud012,l_xcec.xcecud013,l_xcec.xcecud014,l_xcec.xcecud015,l_xcec.xcecud016,
#             l_xcec.xcecud017,l_xcec.xcecud018,l_xcec.xcecud019,l_xcec.xcecud020,l_xcec.xcecud021,
#             l_xcec.xcecud022,l_xcec.xcecud023,l_xcec.xcecud024,l_xcec.xcecud025,l_xcec.xcecud026,
#             l_xcec.xcecud027,l_xcec.xcecud028,l_xcec.xcecud029,l_xcec.xcecud030,l_xcec.xcec107,
#             l_xcec.xcec108,l_xcec.xcec109,l_xcec.xcec121,l_xcec.xcec122,l_xcec.xcec123,
#             l_xcec.xcec124,l_xcec.xcec125,l_xcec.xcec126,l_xcec.xcec127,l_xcec.xcec128,
#             l_xcec.xcec129,l_xcec.xcec130)
#      #161109-00085#63 --e add
#      IF SQLCA.sqlcode THEN
#         INITIALIZE g_errparam TO NULL
#         LET g_errparam.code = SQLCA.sqlcode
#         LET g_errparam.extend = "ins xcec"
#         LET g_errparam.popup = TRUE
#         CALL cl_err()
#  
#         LET g_success = 'N'
#         RETURN g_success
#         EXIT FOREACH
#      END IF   
#      CLOSE xcck_prep2_1
#      CLOSE xcck_prep3_1  
#  END FOREACH 
#  RETURN g_success
#170105-00011#5---mark---e
END FUNCTION

################################################################################
# Descriptions...: 新增axct708   7.雜項進出差异憑證  axct708
# Memo...........:
# Usage..........: CALL axct701_01_ins_8()
# Input parameter:  
# Return code....:  
# Date & Author..: 2014/4/22 By 01531
# Modify.........: 160421 add xcck006 与axct707同步处理方式
################################################################################
PRIVATE FUNCTION axct701_01_ins_8_bak()
#170105-00011#2---mark---s
#DEFINE l_success       LIKE type_t.num5
#DEFINE l_errno         LIKE gzze_t.gzze001
##161109-00085#18-s mod
##DEFINE l_xcea          RECORD LIKE xcea_t.*   #161109-00085#18-s mark
#DEFINE l_xcea          RECORD  #工單發料成本憑證單頭檔
#       xceaent LIKE xcea_t.xceaent, #企業編號
#       xceacomp LIKE xcea_t.xceacomp, #法人組織
#       xceald LIKE xcea_t.xceald, #帳套
#       xceadocno LIKE xcea_t.xceadocno, #單據編號
#       xcea001 LIKE xcea_t.xcea001, #單據日期
#       xcea002 LIKE xcea_t.xcea002, #成本憑證類型
#       xcea003 LIKE xcea_t.xcea003, #成本計算類型
#       xcea004 LIKE xcea_t.xcea004, #年度
#       xcea005 LIKE xcea_t.xcea005, #期別
#       xcea006 LIKE xcea_t.xcea006, #帳務人員
#       xcea007 LIKE xcea_t.xcea007, #帳務部門
#       xcea101 LIKE xcea_t.xcea101, #憑證編號
#       xcea102 LIKE xcea_t.xcea102, #憑證日期
#       xceaownid LIKE xcea_t.xceaownid, #資料所有者
#       xceaowndp LIKE xcea_t.xceaowndp, #資料所屬部門
#       xceacrtid LIKE xcea_t.xceacrtid, #資料建立者
#       xceacrtdp LIKE xcea_t.xceacrtdp, #資料建立部門
#       xceacrtdt LIKE xcea_t.xceacrtdt, #資料創建日
#       xceamodid LIKE xcea_t.xceamodid, #資料修改者
#       xceamoddt LIKE xcea_t.xceamoddt, #最近修改日
#       xceacnfid LIKE xcea_t.xceacnfid, #資料確認者
#       xceacnfdt LIKE xcea_t.xceacnfdt, #資料確認日
#       xceapstid LIKE xcea_t.xceapstid, #資料過帳者
#       xceapstdt LIKE xcea_t.xceapstdt, #資料過帳日
#       xceastus LIKE xcea_t.xceastus, #狀態碼
#       #161109-00085#63 --s add
#       xceaud001 LIKE xcea_t.xceaud001, #自定義欄位(文字)001
#       xceaud002 LIKE xcea_t.xceaud002, #自定義欄位(文字)002
#       xceaud003 LIKE xcea_t.xceaud003, #自定義欄位(文字)003
#       xceaud004 LIKE xcea_t.xceaud004, #自定義欄位(文字)004
#       xceaud005 LIKE xcea_t.xceaud005, #自定義欄位(文字)005
#       xceaud006 LIKE xcea_t.xceaud006, #自定義欄位(文字)006
#       xceaud007 LIKE xcea_t.xceaud007, #自定義欄位(文字)007
#       xceaud008 LIKE xcea_t.xceaud008, #自定義欄位(文字)008
#       xceaud009 LIKE xcea_t.xceaud009, #自定義欄位(文字)009
#       xceaud010 LIKE xcea_t.xceaud010, #自定義欄位(文字)010
#       xceaud011 LIKE xcea_t.xceaud011, #自定義欄位(數字)011
#       xceaud012 LIKE xcea_t.xceaud012, #自定義欄位(數字)012
#       xceaud013 LIKE xcea_t.xceaud013, #自定義欄位(數字)013
#       xceaud014 LIKE xcea_t.xceaud014, #自定義欄位(數字)014
#       xceaud015 LIKE xcea_t.xceaud015, #自定義欄位(數字)015
#       xceaud016 LIKE xcea_t.xceaud016, #自定義欄位(數字)016
#       xceaud017 LIKE xcea_t.xceaud017, #自定義欄位(數字)017
#       xceaud018 LIKE xcea_t.xceaud018, #自定義欄位(數字)018
#       xceaud019 LIKE xcea_t.xceaud019, #自定義欄位(數字)019
#       xceaud020 LIKE xcea_t.xceaud020, #自定義欄位(數字)020
#       xceaud021 LIKE xcea_t.xceaud021, #自定義欄位(日期時間)021
#       xceaud022 LIKE xcea_t.xceaud022, #自定義欄位(日期時間)022
#       xceaud023 LIKE xcea_t.xceaud023, #自定義欄位(日期時間)023
#       xceaud024 LIKE xcea_t.xceaud024, #自定義欄位(日期時間)024
#       xceaud025 LIKE xcea_t.xceaud025, #自定義欄位(日期時間)025
#       xceaud026 LIKE xcea_t.xceaud026, #自定義欄位(日期時間)026
#       xceaud027 LIKE xcea_t.xceaud027, #自定義欄位(日期時間)027
#       xceaud028 LIKE xcea_t.xceaud028, #自定義欄位(日期時間)028
#       xceaud029 LIKE xcea_t.xceaud029, #自定義欄位(日期時間)029
#       xceaud030 LIKE xcea_t.xceaud030, #自定義欄位(日期時間)030
#       #161109-00085#63 --e add
#       xceasite LIKE xcea_t.xceasite  #營運據點
#          END RECORD
##161109-00085#18-e mod
##161109-00085#18-s mod
##DEFINE l_xceb          RECORD LIKE xceb_t.*   #161109-00085#18-s mark
#DEFINE l_xceb          RECORD  #成本憑證第一單身檔
#       xcebent LIKE xceb_t.xcebent, #企業編號
#       xcebcomp LIKE xceb_t.xcebcomp, #法人組織
#       xcebld LIKE xceb_t.xcebld, #帳套
#       xcebdocno LIKE xceb_t.xcebdocno, #單據編號
#       xcebseq LIKE xceb_t.xcebseq, #項次
#       xceb001 LIKE xceb_t.xceb001, #參考單據編號
#       xceb002 LIKE xceb_t.xceb002, #參考單據項次
#       xceb003 LIKE xceb_t.xceb003, #單據類型
#       xceb004 LIKE xceb_t.xceb004, #料件編號
#       xceb005 LIKE xceb_t.xceb005, #特性
#       xceb101 LIKE xceb_t.xceb101, #科目編號
#       xceb102 LIKE xceb_t.xceb102, #摘要
#       xceb103 LIKE xceb_t.xceb103, #成本域
#       xceb110 LIKE xceb_t.xceb110, #原因碼
#       xceb111 LIKE xceb_t.xceb111, #收付款客商
#       xceb112 LIKE xceb_t.xceb112, #客群
#       xceb113 LIKE xceb_t.xceb113, #區域
#       xceb114 LIKE xceb_t.xceb114, #成本中心
#       xceb115 LIKE xceb_t.xceb115, #經營類別
#       xceb116 LIKE xceb_t.xceb116, #通路
#       xceb117 LIKE xceb_t.xceb117, #品類
#       xceb118 LIKE xceb_t.xceb118, #品牌
#       xceb119 LIKE xceb_t.xceb119, #專案號
#       xceb120 LIKE xceb_t.xceb120, #WBS
#       xceb201 LIKE xceb_t.xceb201, #數量
#       xceb202 LIKE xceb_t.xceb202, #成本金額(本位幣一)
#       xceb202a LIKE xceb_t.xceb202a, #成本-材料(本位幣一)
#       xceb202b LIKE xceb_t.xceb202b, #成本-人工(本位幣一)
#       xceb202c LIKE xceb_t.xceb202c, #成本-加工(本位幣一)
#       xceb202d LIKE xceb_t.xceb202d, #成本-制費一(本位幣一)
#       xceb202e LIKE xceb_t.xceb202e, #成本-制費二(本位幣一)
#       xceb202f LIKE xceb_t.xceb202f, #成本-制費三(本位幣一)
#       xceb202g LIKE xceb_t.xceb202g, #成本-制費四(本位幣一)
#       xceb202h LIKE xceb_t.xceb202h, #成本-制費五(本位幣一)
#       xceb212 LIKE xceb_t.xceb212, #成本金額(本位幣二)
#       xceb212a LIKE xceb_t.xceb212a, #成本-材料(本位幣二)
#       xceb212b LIKE xceb_t.xceb212b, #成本-人工(本位幣二)
#       xceb212c LIKE xceb_t.xceb212c, #成本-加工(本位幣二)
#       xceb212d LIKE xceb_t.xceb212d, #成本-制費一(本位幣二)
#       xceb212e LIKE xceb_t.xceb212e, #成本-制費二(本位幣二)
#       xceb212f LIKE xceb_t.xceb212f, #成本-制費三(本位幣二)
#       xceb212g LIKE xceb_t.xceb212g, #成本-制費四(本位幣二)
#       xceb212h LIKE xceb_t.xceb212h, #成本-制費五(本位幣二)
#       xceb222 LIKE xceb_t.xceb222, #成本金額(本位幣三)
#       xceb222a LIKE xceb_t.xceb222a, #成本-材料(本位幣三)
#       xceb222b LIKE xceb_t.xceb222b, #成本-人工(本位幣三)
#       xceb222c LIKE xceb_t.xceb222c, #成本-加工(本位幣三)
#       xceb222d LIKE xceb_t.xceb222d, #成本-制費一(本位幣三)
#       xceb222e LIKE xceb_t.xceb222e, #成本-制費二(本位幣三)
#       xceb222f LIKE xceb_t.xceb222f, #成本-制費三(本位幣三)
#       xceb222g LIKE xceb_t.xceb222g, #成本-制費四(本位幣三)
#       xceb222h LIKE xceb_t.xceb222h, #成本-制費五(本位幣三)
#       xceb301 LIKE xceb_t.xceb301, #憑證編號
#       xceb302 LIKE xceb_t.xceb302, #憑證項次
#       #161109-00085#63 --s add  
#       xcebud001 LIKE xceb_t.xcebud001, #自定義欄位(文字)001
#       xcebud002 LIKE xceb_t.xcebud002, #自定義欄位(文字)002
#       xcebud003 LIKE xceb_t.xcebud003, #自定義欄位(文字)003
#       xcebud004 LIKE xceb_t.xcebud004, #自定義欄位(文字)004
#       xcebud005 LIKE xceb_t.xcebud005, #自定義欄位(文字)005
#       xcebud006 LIKE xceb_t.xcebud006, #自定義欄位(文字)006
#       xcebud007 LIKE xceb_t.xcebud007, #自定義欄位(文字)007
#       xcebud008 LIKE xceb_t.xcebud008, #自定義欄位(文字)008
#       xcebud009 LIKE xceb_t.xcebud009, #自定義欄位(文字)009
#       xcebud010 LIKE xceb_t.xcebud010, #自定義欄位(文字)010
#       xcebud011 LIKE xceb_t.xcebud011, #自定義欄位(數字)011
#       xcebud012 LIKE xceb_t.xcebud012, #自定義欄位(數字)012
#       xcebud013 LIKE xceb_t.xcebud013, #自定義欄位(數字)013
#       xcebud014 LIKE xceb_t.xcebud014, #自定義欄位(數字)014
#       xcebud015 LIKE xceb_t.xcebud015, #自定義欄位(數字)015
#       xcebud016 LIKE xceb_t.xcebud016, #自定義欄位(數字)016
#       xcebud017 LIKE xceb_t.xcebud017, #自定義欄位(數字)017
#       xcebud018 LIKE xceb_t.xcebud018, #自定義欄位(數字)018
#       xcebud019 LIKE xceb_t.xcebud019, #自定義欄位(數字)019
#       xcebud020 LIKE xceb_t.xcebud020, #自定義欄位(數字)020
#       xcebud021 LIKE xceb_t.xcebud021, #自定義欄位(日期時間)021
#       xcebud022 LIKE xceb_t.xcebud022, #自定義欄位(日期時間)022
#       xcebud023 LIKE xceb_t.xcebud023, #自定義欄位(日期時間)023
#       xcebud024 LIKE xceb_t.xcebud024, #自定義欄位(日期時間)024
#       xcebud025 LIKE xceb_t.xcebud025, #自定義欄位(日期時間)025
#       xcebud026 LIKE xceb_t.xcebud026, #自定義欄位(日期時間)026
#       xcebud027 LIKE xceb_t.xcebud027, #自定義欄位(日期時間)027
#       xcebud028 LIKE xceb_t.xcebud028, #自定義欄位(日期時間)028
#       xcebud029 LIKE xceb_t.xcebud029, #自定義欄位(日期時間)029
#       xcebud030 LIKE xceb_t.xcebud030, #自定義欄位(日期時間)030
#       #161109-00085#63 --e add
#       xceb107 LIKE xceb_t.xceb107, #人員
#       xceb108 LIKE xceb_t.xceb108, #部門
#       xceb109 LIKE xceb_t.xceb109, #帳款對象
#       xceb121 LIKE xceb_t.xceb121, #自由核算項1
#       xceb122 LIKE xceb_t.xceb122, #自由核算項2
#       xceb123 LIKE xceb_t.xceb123, #自由核算項3
#       xceb124 LIKE xceb_t.xceb124, #自由核算項4
#       xceb125 LIKE xceb_t.xceb125, #自由核算項5
#       xceb126 LIKE xceb_t.xceb126, #自由核算項6
#       xceb127 LIKE xceb_t.xceb127, #自由核算項7
#       xceb128 LIKE xceb_t.xceb128, #自由核算項8
#       xceb129 LIKE xceb_t.xceb129, #自由核算項9
#       xceb130 LIKE xceb_t.xceb130, #自由核算項10
#       xceb131 LIKE xceb_t.xceb131, #單據類型(for 流通)
#       xceb132 LIKE xceb_t.xceb132  #單據日期(for 流通)
#          END RECORD
##161109-00085#18-e mod
##161109-00085#18-s mod
##DEFINE l_xcec          RECORD LIKE xcec_t.*   #161109-00085#18-s mark
#DEFINE l_xcec          RECORD  #成本憑證第二單身檔
#       xcecent LIKE xcec_t.xcecent, #企業編號
#       xceccomp LIKE xcec_t.xceccomp, #法人組織
#       xcecld LIKE xcec_t.xcecld, #帳套
#       xcecdocno LIKE xcec_t.xcecdocno, #單據編號
#       xcecseq LIKE xcec_t.xcecseq, #項次
#       xcec001 LIKE xcec_t.xcec001, #參考單據
#       xcec002 LIKE xcec_t.xcec002, #參考單據項次
#       xcec003 LIKE xcec_t.xcec003, #單據類型
#       xcec004 LIKE xcec_t.xcec004, #料件編號
#       xcec005 LIKE xcec_t.xcec005, #特性
#       xcec101 LIKE xcec_t.xcec101, #科目編號
#       xcec102 LIKE xcec_t.xcec102, #摘要
#       xcec103 LIKE xcec_t.xcec103, #成本域
#       xcec110 LIKE xcec_t.xcec110, #原因碼
#       xcec111 LIKE xcec_t.xcec111, #收付款客商
#       xcec112 LIKE xcec_t.xcec112, #客群
#       xcec113 LIKE xcec_t.xcec113, #區域
#       xcec114 LIKE xcec_t.xcec114, #成本中心
#       xcec115 LIKE xcec_t.xcec115, #經營類別
#       xcec116 LIKE xcec_t.xcec116, #通路
#       xcec117 LIKE xcec_t.xcec117, #品類
#       xcec118 LIKE xcec_t.xcec118, #品牌
#       xcec119 LIKE xcec_t.xcec119, #專案號
#       xcec120 LIKE xcec_t.xcec120, #WBS
#       xcec201 LIKE xcec_t.xcec201, #數量
#       xcec202 LIKE xcec_t.xcec202, #成本金額(本位幣一)
#       xcec202a LIKE xcec_t.xcec202a, #成本-材料(本位幣一)
#       xcec202b LIKE xcec_t.xcec202b, #成本-人工(本位幣一)
#       xcec202c LIKE xcec_t.xcec202c, #成本-加工(本位幣一)
#       xcec202d LIKE xcec_t.xcec202d, #成本-制費一(本位幣一)
#       xcec202e LIKE xcec_t.xcec202e, #成本-制費二(本位幣一)
#       xcec202f LIKE xcec_t.xcec202f, #成本-制費三(本位幣一)
#       xcec202g LIKE xcec_t.xcec202g, #成本-制費四(本位幣一)
#       xcec202h LIKE xcec_t.xcec202h, #成本-制費五(本位幣一)
#       xcec212 LIKE xcec_t.xcec212, #成本-金額(本位幣二)
#       xcec212a LIKE xcec_t.xcec212a, #成本-材料(本位幣二)
#       xcec212b LIKE xcec_t.xcec212b, #成本-人工(本位幣二)
#       xcec212c LIKE xcec_t.xcec212c, #成本-加工(本位幣二)
#       xcec212d LIKE xcec_t.xcec212d, #成本-制費一(本位幣二)
#       xcec212e LIKE xcec_t.xcec212e, #成本-制費二(本位幣二)
#       xcec212f LIKE xcec_t.xcec212f, #成本-制費三(本位幣二)
#       xcec212g LIKE xcec_t.xcec212g, #成本-制費四(本位幣二)
#       xcec212h LIKE xcec_t.xcec212h, #成本-制費五(本位幣二)
#       xcec222 LIKE xcec_t.xcec222, #成本-金額(本位幣三)
#       xcec222a LIKE xcec_t.xcec222a, #成本-材料(本位幣三)
#       xcec222b LIKE xcec_t.xcec222b, #成本-人工(本位幣三)
#       xcec222c LIKE xcec_t.xcec222c, #成本-加工(本位幣三)
#       xcec222d LIKE xcec_t.xcec222d, #成本-制費一(本位幣三)
#       xcec222e LIKE xcec_t.xcec222e, #成本-制費二(本位幣三)
#       xcec222f LIKE xcec_t.xcec222f, #成本-制費三(本位幣三)
#       xcec222g LIKE xcec_t.xcec222g, #成本-制費四(本位幣三)
#       xcec222h LIKE xcec_t.xcec222h, #成本-制費五(本位幣三)
#       xcec301 LIKE xcec_t.xcec301, #憑證編號
#       xcec302 LIKE xcec_t.xcec302, #憑證項次
#       #161109-00085#63 --s add 
#       xcecud001 LIKE xcec_t.xcecud001, #自定義欄位(文字)001
#       xcecud002 LIKE xcec_t.xcecud002, #自定義欄位(文字)002
#       xcecud003 LIKE xcec_t.xcecud003, #自定義欄位(文字)003
#       xcecud004 LIKE xcec_t.xcecud004, #自定義欄位(文字)004
#       xcecud005 LIKE xcec_t.xcecud005, #自定義欄位(文字)005
#       xcecud006 LIKE xcec_t.xcecud006, #自定義欄位(文字)006
#       xcecud007 LIKE xcec_t.xcecud007, #自定義欄位(文字)007
#       xcecud008 LIKE xcec_t.xcecud008, #自定義欄位(文字)008
#       xcecud009 LIKE xcec_t.xcecud009, #自定義欄位(文字)009
#       xcecud010 LIKE xcec_t.xcecud010, #自定義欄位(文字)010
#       xcecud011 LIKE xcec_t.xcecud011, #自定義欄位(數字)011
#       xcecud012 LIKE xcec_t.xcecud012, #自定義欄位(數字)012
#       xcecud013 LIKE xcec_t.xcecud013, #自定義欄位(數字)013
#       xcecud014 LIKE xcec_t.xcecud014, #自定義欄位(數字)014
#       xcecud015 LIKE xcec_t.xcecud015, #自定義欄位(數字)015
#       xcecud016 LIKE xcec_t.xcecud016, #自定義欄位(數字)016
#       xcecud017 LIKE xcec_t.xcecud017, #自定義欄位(數字)017
#       xcecud018 LIKE xcec_t.xcecud018, #自定義欄位(數字)018
#       xcecud019 LIKE xcec_t.xcecud019, #自定義欄位(數字)019
#       xcecud020 LIKE xcec_t.xcecud020, #自定義欄位(數字)020
#       xcecud021 LIKE xcec_t.xcecud021, #自定義欄位(日期時間)021
#       xcecud022 LIKE xcec_t.xcecud022, #自定義欄位(日期時間)022
#       xcecud023 LIKE xcec_t.xcecud023, #自定義欄位(日期時間)023
#       xcecud024 LIKE xcec_t.xcecud024, #自定義欄位(日期時間)024
#       xcecud025 LIKE xcec_t.xcecud025, #自定義欄位(日期時間)025
#       xcecud026 LIKE xcec_t.xcecud026, #自定義欄位(日期時間)026
#       xcecud027 LIKE xcec_t.xcecud027, #自定義欄位(日期時間)027
#       xcecud028 LIKE xcec_t.xcecud028, #自定義欄位(日期時間)028
#       xcecud029 LIKE xcec_t.xcecud029, #自定義欄位(日期時間)029
#       xcecud030 LIKE xcec_t.xcecud030, #自定義欄位(日期時間)030
#       #161109-00085#63 --e add
#       xcec107 LIKE xcec_t.xcec107, #人員
#       xcec108 LIKE xcec_t.xcec108, #部門
#       xcec109 LIKE xcec_t.xcec109, #帳款對象
#       xcec121 LIKE xcec_t.xcec121, #自由核算項1
#       xcec122 LIKE xcec_t.xcec122, #自由核算項2
#       xcec123 LIKE xcec_t.xcec123, #自由核算項3
#       xcec124 LIKE xcec_t.xcec124, #自由核算項4
#       xcec125 LIKE xcec_t.xcec125, #自由核算項5
#       xcec126 LIKE xcec_t.xcec126, #自由核算項6
#       xcec127 LIKE xcec_t.xcec127, #自由核算項7
#       xcec128 LIKE xcec_t.xcec128, #自由核算項8
#       xcec129 LIKE xcec_t.xcec129, #自由核算項9
#       xcec130 LIKE xcec_t.xcec130  #自由核算項10
#               END RECORD
##161109-00085#18-e mod
##161109-00085#18-s mod
##DEFINE l_xceb1          RECORD LIKE xceb_t.*   #161109-00085#18-s mark
#DEFINE l_xceb1          RECORD  #成本憑證第一單身檔
#       xcebent LIKE xceb_t.xcebent, #企業編號
#       xcebcomp LIKE xceb_t.xcebcomp, #法人組織
#       xcebld LIKE xceb_t.xcebld, #帳套
#       xcebdocno LIKE xceb_t.xcebdocno, #單據編號
#       xcebseq LIKE xceb_t.xcebseq, #項次
#       xceb001 LIKE xceb_t.xceb001, #參考單據編號
#       xceb002 LIKE xceb_t.xceb002, #參考單據項次
#       xceb003 LIKE xceb_t.xceb003, #單據類型
#       xceb004 LIKE xceb_t.xceb004, #料件編號
#       xceb005 LIKE xceb_t.xceb005, #特性
#       xceb101 LIKE xceb_t.xceb101, #科目編號
#       xceb102 LIKE xceb_t.xceb102, #摘要
#       xceb103 LIKE xceb_t.xceb103, #成本域
#       xceb110 LIKE xceb_t.xceb110, #原因碼
#       xceb111 LIKE xceb_t.xceb111, #收付款客商
#       xceb112 LIKE xceb_t.xceb112, #客群
#       xceb113 LIKE xceb_t.xceb113, #區域
#       xceb114 LIKE xceb_t.xceb114, #成本中心
#       xceb115 LIKE xceb_t.xceb115, #經營類別
#       xceb116 LIKE xceb_t.xceb116, #通路
#       xceb117 LIKE xceb_t.xceb117, #品類
#       xceb118 LIKE xceb_t.xceb118, #品牌
#       xceb119 LIKE xceb_t.xceb119, #專案號
#       xceb120 LIKE xceb_t.xceb120, #WBS
#       xceb201 LIKE xceb_t.xceb201, #數量
#       xceb202 LIKE xceb_t.xceb202, #成本金額(本位幣一)
#       xceb202a LIKE xceb_t.xceb202a, #成本-材料(本位幣一)
#       xceb202b LIKE xceb_t.xceb202b, #成本-人工(本位幣一)
#       xceb202c LIKE xceb_t.xceb202c, #成本-加工(本位幣一)
#       xceb202d LIKE xceb_t.xceb202d, #成本-制費一(本位幣一)
#       xceb202e LIKE xceb_t.xceb202e, #成本-制費二(本位幣一)
#       xceb202f LIKE xceb_t.xceb202f, #成本-制費三(本位幣一)
#       xceb202g LIKE xceb_t.xceb202g, #成本-制費四(本位幣一)
#       xceb202h LIKE xceb_t.xceb202h, #成本-制費五(本位幣一)
#       xceb212 LIKE xceb_t.xceb212, #成本金額(本位幣二)
#       xceb212a LIKE xceb_t.xceb212a, #成本-材料(本位幣二)
#       xceb212b LIKE xceb_t.xceb212b, #成本-人工(本位幣二)
#       xceb212c LIKE xceb_t.xceb212c, #成本-加工(本位幣二)
#       xceb212d LIKE xceb_t.xceb212d, #成本-制費一(本位幣二)
#       xceb212e LIKE xceb_t.xceb212e, #成本-制費二(本位幣二)
#       xceb212f LIKE xceb_t.xceb212f, #成本-制費三(本位幣二)
#       xceb212g LIKE xceb_t.xceb212g, #成本-制費四(本位幣二)
#       xceb212h LIKE xceb_t.xceb212h, #成本-制費五(本位幣二)
#       xceb222 LIKE xceb_t.xceb222, #成本金額(本位幣三)
#       xceb222a LIKE xceb_t.xceb222a, #成本-材料(本位幣三)
#       xceb222b LIKE xceb_t.xceb222b, #成本-人工(本位幣三)
#       xceb222c LIKE xceb_t.xceb222c, #成本-加工(本位幣三)
#       xceb222d LIKE xceb_t.xceb222d, #成本-制費一(本位幣三)
#       xceb222e LIKE xceb_t.xceb222e, #成本-制費二(本位幣三)
#       xceb222f LIKE xceb_t.xceb222f, #成本-制費三(本位幣三)
#       xceb222g LIKE xceb_t.xceb222g, #成本-制費四(本位幣三)
#       xceb222h LIKE xceb_t.xceb222h, #成本-制費五(本位幣三)
#       xceb301 LIKE xceb_t.xceb301, #憑證編號
#       xceb302 LIKE xceb_t.xceb302, #憑證項次
#       #161109-00085#63 --s add  
#       xcebud001 LIKE xceb_t.xcebud001, #自定義欄位(文字)001
#       xcebud002 LIKE xceb_t.xcebud002, #自定義欄位(文字)002
#       xcebud003 LIKE xceb_t.xcebud003, #自定義欄位(文字)003
#       xcebud004 LIKE xceb_t.xcebud004, #自定義欄位(文字)004
#       xcebud005 LIKE xceb_t.xcebud005, #自定義欄位(文字)005
#       xcebud006 LIKE xceb_t.xcebud006, #自定義欄位(文字)006
#       xcebud007 LIKE xceb_t.xcebud007, #自定義欄位(文字)007
#       xcebud008 LIKE xceb_t.xcebud008, #自定義欄位(文字)008
#       xcebud009 LIKE xceb_t.xcebud009, #自定義欄位(文字)009
#       xcebud010 LIKE xceb_t.xcebud010, #自定義欄位(文字)010
#       xcebud011 LIKE xceb_t.xcebud011, #自定義欄位(數字)011
#       xcebud012 LIKE xceb_t.xcebud012, #自定義欄位(數字)012
#       xcebud013 LIKE xceb_t.xcebud013, #自定義欄位(數字)013
#       xcebud014 LIKE xceb_t.xcebud014, #自定義欄位(數字)014
#       xcebud015 LIKE xceb_t.xcebud015, #自定義欄位(數字)015
#       xcebud016 LIKE xceb_t.xcebud016, #自定義欄位(數字)016
#       xcebud017 LIKE xceb_t.xcebud017, #自定義欄位(數字)017
#       xcebud018 LIKE xceb_t.xcebud018, #自定義欄位(數字)018
#       xcebud019 LIKE xceb_t.xcebud019, #自定義欄位(數字)019
#       xcebud020 LIKE xceb_t.xcebud020, #自定義欄位(數字)020
#       xcebud021 LIKE xceb_t.xcebud021, #自定義欄位(日期時間)021
#       xcebud022 LIKE xceb_t.xcebud022, #自定義欄位(日期時間)022
#       xcebud023 LIKE xceb_t.xcebud023, #自定義欄位(日期時間)023
#       xcebud024 LIKE xceb_t.xcebud024, #自定義欄位(日期時間)024
#       xcebud025 LIKE xceb_t.xcebud025, #自定義欄位(日期時間)025
#       xcebud026 LIKE xceb_t.xcebud026, #自定義欄位(日期時間)026
#       xcebud027 LIKE xceb_t.xcebud027, #自定義欄位(日期時間)027
#       xcebud028 LIKE xceb_t.xcebud028, #自定義欄位(日期時間)028
#       xcebud029 LIKE xceb_t.xcebud029, #自定義欄位(日期時間)029
#       xcebud030 LIKE xceb_t.xcebud030, #自定義欄位(日期時間)030
#       #161109-00085#63 --e add
#       xceb107 LIKE xceb_t.xceb107, #人員
#       xceb108 LIKE xceb_t.xceb108, #部門
#       xceb109 LIKE xceb_t.xceb109, #帳款對象
#       xceb121 LIKE xceb_t.xceb121, #自由核算項1
#       xceb122 LIKE xceb_t.xceb122, #自由核算項2
#       xceb123 LIKE xceb_t.xceb123, #自由核算項3
#       xceb124 LIKE xceb_t.xceb124, #自由核算項4
#       xceb125 LIKE xceb_t.xceb125, #自由核算項5
#       xceb126 LIKE xceb_t.xceb126, #自由核算項6
#       xceb127 LIKE xceb_t.xceb127, #自由核算項7
#       xceb128 LIKE xceb_t.xceb128, #自由核算項8
#       xceb129 LIKE xceb_t.xceb129, #自由核算項9
#       xceb130 LIKE xceb_t.xceb130, #自由核算項10
#       xceb131 LIKE xceb_t.xceb131, #單據類型(for 流通)
#       xceb132 LIKE xceb_t.xceb132  #單據日期(for 流通)
#          END RECORD
##161109-00085#18-e mod
##161109-00085#18-s mod
##DEFINE l_xcec1          RECORD LIKE xcec_t.*   #161109-00085#18-s mark
#DEFINE l_xcec1          RECORD  #成本憑證第二單身檔
#       xcecent LIKE xcec_t.xcecent, #企業編號
#       xceccomp LIKE xcec_t.xceccomp, #法人組織
#       xcecld LIKE xcec_t.xcecld, #帳套
#       xcecdocno LIKE xcec_t.xcecdocno, #單據編號
#       xcecseq LIKE xcec_t.xcecseq, #項次
#       xcec001 LIKE xcec_t.xcec001, #參考單據
#       xcec002 LIKE xcec_t.xcec002, #參考單據項次
#       xcec003 LIKE xcec_t.xcec003, #單據類型
#       xcec004 LIKE xcec_t.xcec004, #料件編號
#       xcec005 LIKE xcec_t.xcec005, #特性
#       xcec101 LIKE xcec_t.xcec101, #科目編號
#       xcec102 LIKE xcec_t.xcec102, #摘要
#       xcec103 LIKE xcec_t.xcec103, #成本域
#       xcec110 LIKE xcec_t.xcec110, #原因碼
#       xcec111 LIKE xcec_t.xcec111, #收付款客商
#       xcec112 LIKE xcec_t.xcec112, #客群
#       xcec113 LIKE xcec_t.xcec113, #區域
#       xcec114 LIKE xcec_t.xcec114, #成本中心
#       xcec115 LIKE xcec_t.xcec115, #經營類別
#       xcec116 LIKE xcec_t.xcec116, #通路
#       xcec117 LIKE xcec_t.xcec117, #品類
#       xcec118 LIKE xcec_t.xcec118, #品牌
#       xcec119 LIKE xcec_t.xcec119, #專案號
#       xcec120 LIKE xcec_t.xcec120, #WBS
#       xcec201 LIKE xcec_t.xcec201, #數量
#       xcec202 LIKE xcec_t.xcec202, #成本金額(本位幣一)
#       xcec202a LIKE xcec_t.xcec202a, #成本-材料(本位幣一)
#       xcec202b LIKE xcec_t.xcec202b, #成本-人工(本位幣一)
#       xcec202c LIKE xcec_t.xcec202c, #成本-加工(本位幣一)
#       xcec202d LIKE xcec_t.xcec202d, #成本-制費一(本位幣一)
#       xcec202e LIKE xcec_t.xcec202e, #成本-制費二(本位幣一)
#       xcec202f LIKE xcec_t.xcec202f, #成本-制費三(本位幣一)
#       xcec202g LIKE xcec_t.xcec202g, #成本-制費四(本位幣一)
#       xcec202h LIKE xcec_t.xcec202h, #成本-制費五(本位幣一)
#       xcec212 LIKE xcec_t.xcec212, #成本-金額(本位幣二)
#       xcec212a LIKE xcec_t.xcec212a, #成本-材料(本位幣二)
#       xcec212b LIKE xcec_t.xcec212b, #成本-人工(本位幣二)
#       xcec212c LIKE xcec_t.xcec212c, #成本-加工(本位幣二)
#       xcec212d LIKE xcec_t.xcec212d, #成本-制費一(本位幣二)
#       xcec212e LIKE xcec_t.xcec212e, #成本-制費二(本位幣二)
#       xcec212f LIKE xcec_t.xcec212f, #成本-制費三(本位幣二)
#       xcec212g LIKE xcec_t.xcec212g, #成本-制費四(本位幣二)
#       xcec212h LIKE xcec_t.xcec212h, #成本-制費五(本位幣二)
#       xcec222 LIKE xcec_t.xcec222, #成本-金額(本位幣三)
#       xcec222a LIKE xcec_t.xcec222a, #成本-材料(本位幣三)
#       xcec222b LIKE xcec_t.xcec222b, #成本-人工(本位幣三)
#       xcec222c LIKE xcec_t.xcec222c, #成本-加工(本位幣三)
#       xcec222d LIKE xcec_t.xcec222d, #成本-制費一(本位幣三)
#       xcec222e LIKE xcec_t.xcec222e, #成本-制費二(本位幣三)
#       xcec222f LIKE xcec_t.xcec222f, #成本-制費三(本位幣三)
#       xcec222g LIKE xcec_t.xcec222g, #成本-制費四(本位幣三)
#       xcec222h LIKE xcec_t.xcec222h, #成本-制費五(本位幣三)
#       xcec301 LIKE xcec_t.xcec301, #憑證編號
#       xcec302 LIKE xcec_t.xcec302, #憑證項次
#       #161109-00085#63 --s add 
#       xcecud001 LIKE xcec_t.xcecud001, #自定義欄位(文字)001
#       xcecud002 LIKE xcec_t.xcecud002, #自定義欄位(文字)002
#       xcecud003 LIKE xcec_t.xcecud003, #自定義欄位(文字)003
#       xcecud004 LIKE xcec_t.xcecud004, #自定義欄位(文字)004
#       xcecud005 LIKE xcec_t.xcecud005, #自定義欄位(文字)005
#       xcecud006 LIKE xcec_t.xcecud006, #自定義欄位(文字)006
#       xcecud007 LIKE xcec_t.xcecud007, #自定義欄位(文字)007
#       xcecud008 LIKE xcec_t.xcecud008, #自定義欄位(文字)008
#       xcecud009 LIKE xcec_t.xcecud009, #自定義欄位(文字)009
#       xcecud010 LIKE xcec_t.xcecud010, #自定義欄位(文字)010
#       xcecud011 LIKE xcec_t.xcecud011, #自定義欄位(數字)011
#       xcecud012 LIKE xcec_t.xcecud012, #自定義欄位(數字)012
#       xcecud013 LIKE xcec_t.xcecud013, #自定義欄位(數字)013
#       xcecud014 LIKE xcec_t.xcecud014, #自定義欄位(數字)014
#       xcecud015 LIKE xcec_t.xcecud015, #自定義欄位(數字)015
#       xcecud016 LIKE xcec_t.xcecud016, #自定義欄位(數字)016
#       xcecud017 LIKE xcec_t.xcecud017, #自定義欄位(數字)017
#       xcecud018 LIKE xcec_t.xcecud018, #自定義欄位(數字)018
#       xcecud019 LIKE xcec_t.xcecud019, #自定義欄位(數字)019
#       xcecud020 LIKE xcec_t.xcecud020, #自定義欄位(數字)020
#       xcecud021 LIKE xcec_t.xcecud021, #自定義欄位(日期時間)021
#       xcecud022 LIKE xcec_t.xcecud022, #自定義欄位(日期時間)022
#       xcecud023 LIKE xcec_t.xcecud023, #自定義欄位(日期時間)023
#       xcecud024 LIKE xcec_t.xcecud024, #自定義欄位(日期時間)024
#       xcecud025 LIKE xcec_t.xcecud025, #自定義欄位(日期時間)025
#       xcecud026 LIKE xcec_t.xcecud026, #自定義欄位(日期時間)026
#       xcecud027 LIKE xcec_t.xcecud027, #自定義欄位(日期時間)027
#       xcecud028 LIKE xcec_t.xcecud028, #自定義欄位(日期時間)028
#       xcecud029 LIKE xcec_t.xcecud029, #自定義欄位(日期時間)029
#       xcecud030 LIKE xcec_t.xcecud030, #自定義欄位(日期時間)030
#       #161109-00085#63 --e add
#       xcec107 LIKE xcec_t.xcec107, #人員
#       xcec108 LIKE xcec_t.xcec108, #部門
#       xcec109 LIKE xcec_t.xcec109, #帳款對象
#       xcec121 LIKE xcec_t.xcec121, #自由核算項1
#       xcec122 LIKE xcec_t.xcec122, #自由核算項2
#       xcec123 LIKE xcec_t.xcec123, #自由核算項3
#       xcec124 LIKE xcec_t.xcec124, #自由核算項4
#       xcec125 LIKE xcec_t.xcec125, #自由核算項5
#       xcec126 LIKE xcec_t.xcec126, #自由核算項6
#       xcec127 LIKE xcec_t.xcec127, #自由核算項7
#       xcec128 LIKE xcec_t.xcec128, #自由核算項8
#       xcec129 LIKE xcec_t.xcec129, #自由核算項9
#       xcec130 LIKE xcec_t.xcec130  #自由核算項10
#               END RECORD
##161109-00085#18-e mod
##161109-00085#18-s mod
##DEFINE l_xcck          RECORD LIKE xcck_t.*   #161109-00085#18-s mark
#DEFINE l_xcck          RECORD  #本期料件明細進出成本檔
#       xcckent LIKE xcck_t.xcckent, #企業編號
#       xccksite LIKE xcck_t.xccksite, #site組織
#       xcckcomp LIKE xcck_t.xcckcomp, #法人組織
#       xcckld LIKE xcck_t.xcckld, #帳套
#       xcck001 LIKE xcck_t.xcck001, #帳套本位幣順序
#       xcck002 LIKE xcck_t.xcck002, #成本域
#       xcck003 LIKE xcck_t.xcck003, #成本計算類型
#       xcck004 LIKE xcck_t.xcck004, #年度
#       xcck005 LIKE xcck_t.xcck005, #期別
#       xcck006 LIKE xcck_t.xcck006, #參考單號
#       xcck007 LIKE xcck_t.xcck007, #項次
#       xcck008 LIKE xcck_t.xcck008, #項序
#       xcck009 LIKE xcck_t.xcck009, #出入庫碼
#       xcck010 LIKE xcck_t.xcck010, #料號
#       xcck011 LIKE xcck_t.xcck011, #產品特徵
#       xcck012 LIKE xcck_t.xcck012, #單據類型
#       xcck013 LIKE xcck_t.xcck013, #單據日期
#       xcck014 LIKE xcck_t.xcck014, #時間
#       xcck015 LIKE xcck_t.xcck015, #倉庫編號
#       xcck016 LIKE xcck_t.xcck016, #儲位編號
#       xcck017 LIKE xcck_t.xcck017, #批號
#       xcck020 LIKE xcck_t.xcck020, #異動類型
#       xcck021 LIKE xcck_t.xcck021, #原因碼
#       xcck022 LIKE xcck_t.xcck022, #交易對象
#       xcck023 LIKE xcck_t.xcck023, #客群
#       xcck024 LIKE xcck_t.xcck024, #區域
#       xcck025 LIKE xcck_t.xcck025, #成本中心
#       xcck026 LIKE xcck_t.xcck026, #經營類別
#       xcck027 LIKE xcck_t.xcck027, #通路
#       xcck028 LIKE xcck_t.xcck028, #品類
#       xcck029 LIKE xcck_t.xcck029, #品牌
#       xcck030 LIKE xcck_t.xcck030, #專案號
#       xcck031 LIKE xcck_t.xcck031, #WBS
#       xcck032 LIKE xcck_t.xcck032, #存貨科目
#       xcck033 LIKE xcck_t.xcck033, #費用成本科目
#       xcck034 LIKE xcck_t.xcck034, #收入科目
#       xcck040 LIKE xcck_t.xcck040, #交易幣別
#       xcck041 LIKE xcck_t.xcck041, #本位幣別
#       xcck042 LIKE xcck_t.xcck042, #匯率
#       xcck043 LIKE xcck_t.xcck043, #交易單位
#       xcck044 LIKE xcck_t.xcck044, #成本單位
#       xcck045 LIKE xcck_t.xcck045, #換算率
#       xcck046 LIKE xcck_t.xcck046, #交易數量
#       xcck047 LIKE xcck_t.xcck047, #工單號碼
#       xcck048 LIKE xcck_t.xcck048, #重複性生產-計畫編號
#       xcck049 LIKE xcck_t.xcck049, #重複性生產-生產料號
#       xcck050 LIKE xcck_t.xcck050, #重複性生產-生產料號BOM特性
#       xcck051 LIKE xcck_t.xcck051, #重複性生產-生產料號產品特徵
#       xcck055 LIKE xcck_t.xcck055, #xccc類型
#       xcck201 LIKE xcck_t.xcck201, #本期異動數量
#       xcck202 LIKE xcck_t.xcck202, #本期異動金額
#       xcck202a LIKE xcck_t.xcck202a, #本期異動金額-材料
#       xcck202b LIKE xcck_t.xcck202b, #本期異動金額-人工
#       xcck202c LIKE xcck_t.xcck202c, #本期異動金額-加工費
#       xcck202d LIKE xcck_t.xcck202d, #本期異動金額-製費一
#       xcck202e LIKE xcck_t.xcck202e, #本期異動金額-製費二
#       xcck202f LIKE xcck_t.xcck202f, #本期異動金額-製費三
#       xcck202g LIKE xcck_t.xcck202g, #本期異動金額-製費四
#       xcck202h LIKE xcck_t.xcck202h, #本期異動金額-製費五
#       xcck282 LIKE xcck_t.xcck282, #本期異動單價
#       xcck282a LIKE xcck_t.xcck282a, #本期異動單價-材料
#       xcck282b LIKE xcck_t.xcck282b, #本期異動單價-人工
#       xcck282c LIKE xcck_t.xcck282c, #本期異動單價-加工
#       xcck282d LIKE xcck_t.xcck282d, #本期異動單價-製費一
#       xcck282e LIKE xcck_t.xcck282e, #本期異動單價-製費二
#       xcck282f LIKE xcck_t.xcck282f, #本期異動單價-製費三
#       xcck282g LIKE xcck_t.xcck282g, #本期異動單價-製費四
#       xcck282h LIKE xcck_t.xcck282h, #本期異動單價-製費五
#       xcck301 LIKE xcck_t.xcck301, #已耗數量
#       xcck302 LIKE xcck_t.xcck302, #已耗金額
#       xcck302a LIKE xcck_t.xcck302a, #已耗金額-材料
#       xcck302b LIKE xcck_t.xcck302b, #已耗金額-人工
#       xcck302c LIKE xcck_t.xcck302c, #已耗金額-加工費
#       xcck302d LIKE xcck_t.xcck302d, #已耗金額-製費一
#       xcck302e LIKE xcck_t.xcck302e, #已耗金額-製費二
#       xcck302f LIKE xcck_t.xcck302f, #已耗金額-製費三
#       xcck302g LIKE xcck_t.xcck302g, #已耗金額-製費四
#       xcck302h LIKE xcck_t.xcck302h, #已耗金額-製費五
#       xcck901 LIKE xcck_t.xcck901, #結存數量
#       xcck902 LIKE xcck_t.xcck902, #結存金額
#       xcck902a LIKE xcck_t.xcck902a, #結存金額-材料
#       xcck902b LIKE xcck_t.xcck902b, #結存金額-人工
#       xcck902c LIKE xcck_t.xcck902c, #結存金額-加工費
#       xcck902d LIKE xcck_t.xcck902d, #結存金額-製費一
#       xcck902e LIKE xcck_t.xcck902e, #結存金額-製費二
#       xcck902f LIKE xcck_t.xcck902f, #結存金額-製費三
#       xcck902g LIKE xcck_t.xcck902g, #結存金額-製費四
#       xcck902h LIKE xcck_t.xcck902h, #結存金額-製費五
#       xcck980 LIKE xcck_t.xcck980, #結存單位成本
#       xcck980a LIKE xcck_t.xcck980a, #結存單位成本-材料
#       xcck980b LIKE xcck_t.xcck980b, #結存單位成本-人工
#       xcck980c LIKE xcck_t.xcck980c, #結存單位成本-加工費
#       xcck980d LIKE xcck_t.xcck980d, #結存單位成本-製費一
#       xcck980e LIKE xcck_t.xcck980e, #結存單位成本-製費二
#       xcck980f LIKE xcck_t.xcck980f, #結存單位成本-製費三
#       xcck980g LIKE xcck_t.xcck980g, #結存單位成本-製費四
#       xcck980h LIKE xcck_t.xcck980h, #結存單位成本-製費五
#       xcck903 LIKE xcck_t.xcck903, #結存調整金額
#       xcck903a LIKE xcck_t.xcck903a, #結存調整金額-材料
#       xcck903b LIKE xcck_t.xcck903b, #結存調整金額-人工
#       xcck903c LIKE xcck_t.xcck903c, #結存調整金額-加工費
#       xcck903d LIKE xcck_t.xcck903d, #結存調整金額-製費一
#       xcck903e LIKE xcck_t.xcck903e, #結存調整金額-製費二
#       xcck903f LIKE xcck_t.xcck903f, #結存調整金額-製費三
#       xcck903g LIKE xcck_t.xcck903g, #結存調整金額-製費四
#       xcck903h LIKE xcck_t.xcck903h, #結存調整金額-製費五
#       xcckownid LIKE xcck_t.xcckownid, #資料所有者
#       xcckowndp LIKE xcck_t.xcckowndp, #資料所屬部門
#       xcckcrtid LIKE xcck_t.xcckcrtid, #資料建立者
#       xcckcrtdp LIKE xcck_t.xcckcrtdp, #資料建立部門
#       xcckcrtdt LIKE xcck_t.xcckcrtdt, #資料創建日
#       xcckmodid LIKE xcck_t.xcckmodid, #資料修改者
#       xcckmoddt LIKE xcck_t.xcckmoddt, #最近修改日
#       xcckstus LIKE xcck_t.xcckstus, #狀態碼
#       #161109-00085#63 --s add      
#       xcckud001 LIKE xcck_t.xcckud001, #自定義欄位(文字)001
#       xcckud002 LIKE xcck_t.xcckud002, #自定義欄位(文字)002
#       xcckud003 LIKE xcck_t.xcckud003, #自定義欄位(文字)003
#       xcckud004 LIKE xcck_t.xcckud004, #自定義欄位(文字)004
#       xcckud005 LIKE xcck_t.xcckud005, #自定義欄位(文字)005
#       xcckud006 LIKE xcck_t.xcckud006, #自定義欄位(文字)006
#       xcckud007 LIKE xcck_t.xcckud007, #自定義欄位(文字)007
#       xcckud008 LIKE xcck_t.xcckud008, #自定義欄位(文字)008
#       xcckud009 LIKE xcck_t.xcckud009, #自定義欄位(文字)009
#       xcckud010 LIKE xcck_t.xcckud010, #自定義欄位(文字)010
#       xcckud011 LIKE xcck_t.xcckud011, #自定義欄位(數字)011
#       xcckud012 LIKE xcck_t.xcckud012, #自定義欄位(數字)012
#       xcckud013 LIKE xcck_t.xcckud013, #自定義欄位(數字)013
#       xcckud014 LIKE xcck_t.xcckud014, #自定義欄位(數字)014
#       xcckud015 LIKE xcck_t.xcckud015, #自定義欄位(數字)015
#       xcckud016 LIKE xcck_t.xcckud016, #自定義欄位(數字)016
#       xcckud017 LIKE xcck_t.xcckud017, #自定義欄位(數字)017
#       xcckud018 LIKE xcck_t.xcckud018, #自定義欄位(數字)018
#       xcckud019 LIKE xcck_t.xcckud019, #自定義欄位(數字)019
#       xcckud020 LIKE xcck_t.xcckud020, #自定義欄位(數字)020
#       xcckud021 LIKE xcck_t.xcckud021, #自定義欄位(日期時間)021
#       xcckud022 LIKE xcck_t.xcckud022, #自定義欄位(日期時間)022
#       xcckud023 LIKE xcck_t.xcckud023, #自定義欄位(日期時間)023
#       xcckud024 LIKE xcck_t.xcckud024, #自定義欄位(日期時間)024
#       xcckud025 LIKE xcck_t.xcckud025, #自定義欄位(日期時間)025
#       xcckud026 LIKE xcck_t.xcckud026, #自定義欄位(日期時間)026
#       xcckud027 LIKE xcck_t.xcckud027, #自定義欄位(日期時間)027
#       xcckud028 LIKE xcck_t.xcckud028, #自定義欄位(日期時間)028
#       xcckud029 LIKE xcck_t.xcckud029, #自定義欄位(日期時間)029
#       xcckud030 LIKE xcck_t.xcckud030, #自定義欄位(日期時間)030
#       #161109-00085#63 --e add
#       xcck056 LIKE xcck_t.xcck056  #成本代銷單號
#          END RECORD
##161109-00085#18-e mod
#DEFINE ld_date         DATETIME YEAR TO SECOND
#
#   LET g_success = 'Y'
#   LET l_xcea.xceaownid = g_user
#   LET l_xcea.xceaowndp = g_dept
#   LET l_xcea.xceacrtid = g_user
#   LET l_xcea.xceacrtdp = g_dept 
#   LET ld_date  = cl_get_current()
#   LET l_xcea.xceacrtdt = ld_date
#   LET l_xcea.xceamodid = ""
#   LET l_xcea.xceamoddt = ""
#   CALL s_aooi200_fin_gen_docno(g_xcea_m.xceald,'','',g_xcea_m.xceadocno,g_xcea_m.xcea001,g_prog_name1)      #wujie 150214
#    RETURNING l_success,g_xcea_m.xceadocno
#   IF l_success  = 0  THEN
#      INITIALIZE g_errparam TO NULL
#      LET g_errparam.code = 'apm-00003'
#      LET g_errparam.extend = g_xcea_m.xceadocno
#      LET g_errparam.popup = TRUE
#      CALL cl_err()
#
#      LET g_success = 'N'
#      RETURN g_success
#   END IF
#   
#   INSERT INTO xcea_t (xceaent,xceald,xceacomp,xcea006,xceadocno,xcea001,xcea002,xcea004, 
#       xcea005,xcea003,xceastus,xceaownid,xceaowndp,xceacrtid,xceacrtdp,xceacrtdt, 
#       xceamodid,xceamoddt)
#   VALUES (g_enterprise,g_xcea_m.xceald,g_xcea_m.xceacomp,g_xcea_m.xcea006,g_xcea_m.xceadocno, 
#       g_xcea_m.xcea001,g_xcea002,g_xcea_m.xcea004,g_xcea_m.xcea005,g_xcea_m.xcea003, 
#       'N',l_xcea.xceaownid,l_xcea.xceaowndp,l_xcea.xceacrtid, 
#       l_xcea.xceacrtdp,ld_date,l_xcea.xceamodid,l_xcea.xceamoddt) 
#       
#   IF SQLCA.sqlcode THEN
#      INITIALIZE g_errparam TO NULL
#      LET g_errparam.code = SQLCA.sqlcode
#      LET g_errparam.extend = "g_xcea_m"
#      LET g_errparam.popup = TRUE
#      CALL cl_err()
#  
#      LET g_success = 'N'
#      RETURN g_success
#   END IF
#
#  #160906-00041#1-s-add 
#   #雜項進出憑證xcea002 = '7'
#   LET g_sql = " SELECT SUM(xceb201),SUM(xceb202), ",
#               "        SUM(xceb202a),SUM(xceb202b),SUM(xceb202c),SUM(xceb202d),",
#               "        SUM(xceb202e),SUM(xceb202f),SUM(xceb202g),SUM(xceb202h), ",
#               "        SUM(xceb212),SUM(xceb212a),SUM(xceb212b),SUM(xceb212c),SUM(xceb212d),",
#               "        SUM(xceb212e),SUM(xceb212f),SUM(xceb212g),SUM(xceb212h), ",
#               "        SUM(xceb222),SUM(xceb222a),SUM(xceb222b),SUM(xceb222c),SUM(xceb222d),",
#               "        SUM(xceb222e),SUM(xceb222f),SUM(xceb222g),SUM(xceb222h) ",               
#               "   FROM xcea_t LEFT OUTER JOIN xceb_t ON xceaent = xcebent AND xceald = xcebld AND xceadocno = xcebdocno ",          
#               "  WHERE xceaent = ",g_enterprise," AND xceald = '",g_xcea_m.xceald,"'",
#               "    AND xcea003 = '",g_xcea_m.xcea003,"' AND xcea004 = ",g_xcea_m.xcea004,
#               "    AND xcea005 = ",g_xcea_m.xcea005," AND xcea002 = '7' ",
#               "    AND xceb103 = ? ",               
#               "    AND xceb001 = ? ",
#               "    AND xceb002 = ? ",  #161116-00023#1 add
#               "    AND xceb003 = ? ",
#               "    AND xceb004 = ? ", 
#               "    AND xceb005 = ? "               
#   DECLARE xceb_prep CURSOR FROM g_sql
#  #160906-00041#1-e-add 
#
#   #mod zhangllc 160421 add xcck006
#   LET g_sql = " SELECT SUM(xcck009*xcck202), ",
#               "        SUM(xcck009*xcck202a),SUM(xcck009*xcck202b),SUM(xcck009*xcck202c),SUM(xcck009*xcck202d),",
#               "        SUM(xcck009*xcck202e),SUM(xcck009*xcck202f),SUM(xcck009*xcck202g),SUM(xcck009*xcck202h) ",
#               "        FROM xcck_t ", 
#               "  WHERE xcckent = '",g_enterprise,"' AND xcckld = '",g_xcea_m.xceald,"'",
#               "    AND xcck003 = '",g_xcea_m.xcea003,"' AND xcck004 = ",g_xcea_m.xcea004,
#               "    AND xcck005 = ",g_xcea_m.xcea005,
#              #"    AND xcck020 IN ('101','301') ",  
#               "    AND xcck020 IN ('101','301','304') ",      #160420-00016                      
#               "    AND xcck002 = ? AND xcck006 = ? ",
#               "    AND xcck007 = ? ",  #161116-00023#1 add
#               "    AND xcck010 = ? AND xcck011 = ? AND xcck009 = ? AND xcck021 = ? ",   #160906-00041#1 add xcck009
#               "    AND xcck022 = ? AND xcck023 = ? AND xcck024 = ? ",
#               "    AND xcck025 = ? AND xcck026 = ? AND xcck027 = ? ",
#               "    AND xcck028 = ? AND xcck029 = ? AND xcck030 = ? ",
#               "    AND xcck031 = ? " 
#   
#   LET g_sql1 = g_sql CLIPPED," AND xcck001 = '2' AND xcck033 = ? " 
#     
#   LET g_sql2 = g_sql CLIPPED," AND xcck001 = '3' AND xcck033 = ? " 
#
#  #mod zhangllc 160421 add xcck006  #160906-00041#1 add xcck009  #161116-00023#1 add xcck007
#   LET g_sql = " SELECT xcck002,xcck006,xcck007, ",
#               "        xcck010,xcck011,xcck009,xcck021,xcck022,xcck023,xcck024,xcck025,xcck026,xcck027,xcck028,",  
#               "        xcck029,xcck030,xcck031,xcck033,SUM(xcck009*xcck201),SUM(xcck009*xcck202), ",
#               "        SUM(xcck009*xcck202a),SUM(xcck009*xcck202b),SUM(xcck009*xcck202c),SUM(xcck009*xcck202d),",
#               "        SUM(xcck009*xcck202e),SUM(xcck009*xcck202f),SUM(xcck009*xcck202g),SUM(xcck009*xcck202h) ",
#               "        FROM xcck_t ", 
#               "  WHERE xcckent = '",g_enterprise,"' AND xcckld = '",g_xcea_m.xceald,"'",
#               "    AND xcck003 = '",g_xcea_m.xcea003,"' AND xcck004 = ",g_xcea_m.xcea004,
#               "    AND xcck005 = ",g_xcea_m.xcea005,
#               "    AND xcck001 = '1' ",
#              #"    AND xcck020 IN ('101','301') ",
#               "    AND xcck020 IN ('101','301','304') ",      #160420-00016   
#               " GROUP BY xcck002,xcck006,xcck007,xcck010,xcck011,xcck009,xcck021,xcck022,xcck023,xcck024,xcck025,xcck026,xcck027,xcck028,xcck029,xcck030,xcck031,xcck033",  #160906-00041#1 add xcck009
#               " ORDER BY xcck002,xcck006,xcck007,xcck010,xcck011,xcck009,xcck021,xcck022,xcck023,xcck024,xcck025,xcck026,xcck027,xcck028,xcck029,xcck030,xcck031,xcck033"   #160906-00041#1 add xcck009
#   PREPARE xcck_prep_2 FROM g_sql
#   DECLARE xcck_curs_2 CURSOR FOR xcck_prep_2
#   
#
#   FOREACH xcck_curs_2 INTO l_xcck.xcck002,l_xcck.xcck006,
#                            l_xcck.xcck007,  #161116-00023#1 add
#                            l_xcck.xcck010,l_xcck.xcck011,l_xcck.xcck009,l_xcck.xcck021,l_xcck.xcck022,l_xcck.xcck023,   #160906-00041#1 add xcck009
#                            l_xcck.xcck024,l_xcck.xcck025,l_xcck.xcck026,l_xcck.xcck027,l_xcck.xcck028,
#                            l_xcck.xcck029,l_xcck.xcck030,l_xcck.xcck031,l_xcck.xcck033,
#                            l_xcck.xcck201,l_xcck.xcck202,l_xcck.xcck202a,l_xcck.xcck202b,l_xcck.xcck202c,
#                            l_xcck.xcck202d,l_xcck.xcck202e,l_xcck.xcck202f,l_xcck.xcck202g,l_xcck.xcck202h
#
#      INITIALIZE l_xceb.* TO NULL
#      
#      LET l_xceb.xceb001 = l_xcck.xcck006  #add zhangllc 160421 若不存值，axct708来取707资料比对时会对应不上单笔，会取到多笔的sum起来
#      LET l_xceb.xceb002 = l_xcck.xcck007  #161116-00023#1 add
#     #add zhangllc 160421 -s同步与axct707
#      SELECT inba004,inba007 INTO l_xceb.xceb108,l_xceb.xceb110   #部门
#        FROM inba_t
#       WHERE inbaent = g_enterprise
#         AND inbadocno = l_xcck.xcck006
#      IF NOT cl_null(l_xcck.xcck021) THEN
#         LET l_xceb.xceb110 = l_xcck.xcck021 #原因碼
#      END IF
#     #add zhangllc 160421 -end
#     #160906-00041#1-s-add
#      CASE l_xcck.xcck009
#         WHEN -1          #杂发
#            LET l_xceb.xceb003 = '5'
#         WHEN  1          #杂收
#            LET l_xceb.xceb003 = '6'        
#      END CASE
#     #160906-00041#1-e-add 
#      LET l_xceb.xceb103 = l_xcck.xcck002 #成本域
#      LET l_xceb.xceb004 = l_xcck.xcck010 #料號
#      LET l_xceb.xceb005 = l_xcck.xcck011 #料號特性
#      LET l_xceb.xceb110 = l_xcck.xcck021 #原因碼
#      LET l_xceb.xceb111 = l_xcck.xcck022 #交易對象      
#      LET l_xceb.xceb112 = l_xcck.xcck023 #客群 
#      LET l_xceb.xceb113 = l_xcck.xcck024 #區域  
#      LET l_xceb.xceb114 = l_xcck.xcck025 #成本中心      
#      LET l_xceb.xceb115 = l_xcck.xcck026 #經營類別
#      LET l_xceb.xceb116 = l_xcck.xcck027 #渠道
#      LET l_xceb.xceb117 = l_xcck.xcck028 #品類
#      LET l_xceb.xceb118 = l_xcck.xcck029 #品牌
#      LET l_xceb.xceb119 = l_xcck.xcck030 #項目號
#      LET l_xceb.xceb120 = l_xcck.xcck031 #WBS
#      LET l_xceb.xceb101 = l_xcck.xcck033 #費用科目  
#      LET l_xceb.xceb201 = l_xcck.xcck201
#      LET l_xceb.xceb202 = l_xcck.xcck202
#      LET l_xceb.xceb202a = l_xcck.xcck202a
#      LET l_xceb.xceb202b = l_xcck.xcck202b
#      LET l_xceb.xceb202c = l_xcck.xcck202c
#      LET l_xceb.xceb202d = l_xcck.xcck202d
#      LET l_xceb.xceb202e = l_xcck.xcck202e
#      LET l_xceb.xceb202f = l_xcck.xcck202f
#      LET l_xceb.xceb202g = l_xcck.xcck202g
#      LET l_xceb.xceb202h = l_xcck.xcck202h
#
#      
#      SELECT MAX(xcebseq) INTO l_xceb.xcebseq FROM xceb_t
#       WHERE xcebent = g_enterprise AND xcebld = g_xcea_m.xceald
#         AND xcebdocno = g_xcea_m.xceadocno
#      IF cl_null(l_xceb.xcebseq) OR l_xceb.xcebseq = 0 THEN
#         LET l_xceb.xcebseq = 1
#      ELSE
#         LET l_xceb.xcebseq = l_xceb.xcebseq + 1
#      END IF  
#
#      IF cl_null(l_xcck.xcck033) THEN  
#        #杂项费用科目
#        #160816-00015#2-s-mark
#        ##抓agli180的科目
#        #IF cl_null(l_xceb.xceb101) THEN
#        #   SELECT glab005 INTO l_xceb.xceb101
#        #     FROM glab_t
#        #    WHERE glabld  = g_xcea_m.xceald
#        #      AND glab001 = '11'
#        #      AND glab002 = '216'
#        #      AND glab003 = l_xcck.xcck021
#        #      AND glabent = g_enterprise         
#        #END IF
#        ##160816-00015#2-e-mark 
#        #160816-00015#2-s-add  
#         #費用科目抓不到，依部門的費用類別(aooi125)抓取agli180科目
#          IF cl_null(l_xceb.xceb101) THEN
#             CALL axct701_01_get_glab005(l_xcck.xcck025,g_xcea_m.xceald,'216',l_xcck.xcck021) 
#               RETURNING l_xceb.xceb101      
#          END IF         
#        #160816-00015#2-e-add         
#         #agli180抓不到，改抓agli201的科目
#         IF cl_null(l_xceb.xceb101) THEN
#            CALL s_fin_get_account(g_xcea_m.xceald,'60','8912','7') RETURNING l_success,l_xceb.xceb101,l_errno
#         END IF        
#      ELSE
#         LET l_xceb.xceb101 = l_xcck.xcck033 
#      END IF      
#    
#      IF g_glaa015 ='Y' THEN
#         DECLARE xcck_prep2_2 CURSOR FROM g_sql1
#         #mod zhangllc 160421 add xcck006
#         OPEN xcck_prep2_2 USING l_xcck.xcck002,l_xcck.xcck006,
#                                 l_xcck.xcck007,  #161116-00023#1 add
#                                 l_xcck.xcck010,l_xcck.xcck011,l_xcck.xcck009,l_xcck.xcck021,l_xcck.xcck022,l_xcck.xcck023,   #160906-00041#1 add xcck009
#                                 l_xcck.xcck024,l_xcck.xcck025,l_xcck.xcck026,l_xcck.xcck027,l_xcck.xcck028,
#                                 l_xcck.xcck029,l_xcck.xcck030,l_xcck.xcck031,l_xcck.xcck033
#         FETCH xcck_prep2_2 INTO l_xceb.xceb212,l_xceb.xceb212a,l_xceb.xceb212b,l_xceb.xceb212c,l_xceb.xceb212d,
#                                 l_xceb.xceb212e,l_xceb.xceb212f,l_xceb.xceb212g,l_xceb.xceb212h
#         IF SQLCA.sqlcode THEN
#            INITIALIZE g_errparam TO NULL
#            LET g_errparam.code = SQLCA.sqlcode
#            LET g_errparam.extend = "xcck_prep2_2"
#            LET g_errparam.popup = FALSE
#            CALL cl_err()         
#            LET g_success = 'N'
#            RETURN g_success
#            EXIT FOREACH
#         END IF
#      ELSE
#         LET l_xceb.xceb212a = 0
#         LET l_xceb.xceb212b = 0
#         LET l_xceb.xceb212c = 0
#         LET l_xceb.xceb212d = 0
#         LET l_xceb.xceb212e = 0
#         LET l_xceb.xceb212f = 0
#         LET l_xceb.xceb212g = 0
#         LET l_xceb.xceb212h = 0
#         LET l_xceb.xceb212  = 0     
#      END IF
#      
#      IF g_glaa019 ='Y' THEN
#         DECLARE xcck_prep3_2 CURSOR FROM g_sql2
#         #mod 160421 add xcck006
#         OPEN xcck_prep3_2 USING l_xcck.xcck002,l_xcck.xcck006,
#                                 l_xcck.xcck007,  #161116-00023#1 add
#                                 l_xcck.xcck010,l_xcck.xcck011,l_xcck.xcck009,l_xcck.xcck021,l_xcck.xcck022,l_xcck.xcck023,   #160906-00041#1 add xcck009
#                                 l_xcck.xcck024,l_xcck.xcck025,l_xcck.xcck026,l_xcck.xcck027,l_xcck.xcck028,
#                                 l_xcck.xcck029,l_xcck.xcck030,l_xcck.xcck031,l_xcck.xcck033
#         FETCH xcck_prep3_2 INTO l_xceb.xceb222,l_xceb.xceb222a,l_xceb.xceb222b,l_xceb.xceb222c,l_xceb.xceb222d,
#                                 l_xceb.xceb222e,l_xceb.xceb222f,l_xceb.xceb222g,l_xceb.xceb222h
#         IF SQLCA.sqlcode THEN
#            INITIALIZE g_errparam TO NULL
#            LET g_errparam.code = SQLCA.sqlcode
#            LET g_errparam.extend = "xcck_prep3_2"
#            LET g_errparam.popup = FALSE
#            CALL cl_err()         
#            LET g_success = 'N'
#            RETURN g_success
#            EXIT FOREACH
#         END IF
#      ELSE
#         LET l_xceb.xceb222a = 0
#         LET l_xceb.xceb222b = 0
#         LET l_xceb.xceb222c = 0
#         LET l_xceb.xceb222d = 0
#         LET l_xceb.xceb222e = 0
#         LET l_xceb.xceb222f = 0
#         LET l_xceb.xceb222g = 0
#         LET l_xceb.xceb222h = 0
#         LET l_xceb.xceb222  = 0     
#      END IF
#      
#
#      #161116-00023#1 mark--e 下面移上来的
#      LET l_xceb.xcebent = g_enterprise 
#      LET l_xceb.xcebcomp = g_xcea_m.xceacomp
#      LET l_xceb.xcebld = g_xcea_m.xceald
#      LET l_xceb.xcebdocno = g_xcea_m.xceadocno
#      #摘要
#      IF cl_null(l_xceb.xceb102) THEN
#         CALL axct701_01_get_summ(g_xcea_m.xceald,'61','8925','8') RETURNING l_success,l_xceb.xceb102
#      END IF       
#      CALL axct701_01_default_space_xceb(l_xceb.*) RETURNING l_xceb.xceb005,
#                                                             l_xceb.xceb101,
#                                                             l_xceb.xceb102,
#                                                             l_xceb.xceb103,
#                                                             l_xceb.xceb110,
#                                                             l_xceb.xceb111,
#                                                             l_xceb.xceb112,
#                                                             l_xceb.xceb113,
#                                                             l_xceb.xceb114,
#                                                             l_xceb.xceb115,
#                                                             l_xceb.xceb116,
#                                                             l_xceb.xceb117,
#                                                             l_xceb.xceb118,
#                                                             l_xceb.xceb119,
#                                                             l_xceb.xceb120,
#                                                             l_xceb.xceb107,
#                                                             l_xceb.xceb108,
#                                                             l_xceb.xceb109,
#                                                             l_xceb.xceb121,
#                                                             l_xceb.xceb122,
#                                                             l_xceb.xceb123,
#                                                             l_xceb.xceb124,
#                                                             l_xceb.xceb125,
#                                                             l_xceb.xceb126,
#                                                             l_xceb.xceb127,
#                                                             l_xceb.xceb128,
#                                                             l_xceb.xceb129,
#                                                             l_xceb.xceb130 
#      #161116-00023#1 add--e 下面移上来的 
#      
#     #160906-00041#1-s-mark 
#     ##雜項進出憑證xcea002 = '7'
#     #LET g_sql = " SELECT SUM(xceb201),SUM(xceb202), ",
#     #         "        SUM(xceb202a),SUM(xceb202b),SUM(xceb202c),SUM(xceb202d),",
#     #         "        SUM(xceb202e),SUM(xceb202f),SUM(xceb202g),SUM(xceb202h), ",
#     #         "        SUM(xceb212),SUM(xceb212a),SUM(xceb212b),SUM(xceb212c),SUM(xceb212d),",
#     #         "        SUM(xceb212e),SUM(xceb212f),SUM(xceb212g),SUM(xceb212h), ",
#     #         "        SUM(xceb222),SUM(xceb222a),SUM(xceb222b),SUM(xceb222c),SUM(xceb222d),",
#     #         "        SUM(xceb222e),SUM(xceb222f),SUM(xceb222g),SUM(xceb222h) ",               
#     #         "        FROM xcea_t LEFT OUTER JOIN xceb_t ON xceaent = xcebent AND xceald = xcebld ",
#     #         "         AND xceadocno = xcebdocno " ,              
#     #         "  WHERE xceaent = '",g_enterprise,"' AND xceald = '",g_xcea_m.xceald,"'",
#     #         "    AND xcea003 = '",g_xcea_m.xcea003,"' AND xcea004 = ",g_xcea_m.xcea004,
#     #         "    AND xcea005 = ",g_xcea_m.xcea005," AND xcea002 = '7' ",
#     #         "    AND xceb001 = ? ",  #add zhangllc 160421 跟axct707能一一对应上
#     #         "    AND xceb103 = ? ",
#     #         "    AND xceb004 = ? ", 
#     #         "    AND xceb005 = ? ",
#     #         "    AND xceb110 = ? ", 
#     #         "    AND xceb111 = ? ",      
#     #         "    AND xceb112 = ? ", 
#     #         "    AND xceb113 = ? ",  
#     #         "    AND xceb114 = ? ",      
#     #         "    AND xceb115 = ? ",
#     #         "    AND xceb116 = ? ",
#     #         "    AND xceb117 = ? ", 
#     #         "    AND xceb118 = ? ",
#     #         "    AND xceb119 = ? ",
#     #         "    AND xceb120 = ? ",
#     #         "    AND xceb101 = ? "
#     #         
#     #PREPARE xceb_prep FROM g_sql
#     #DECLARE xceb_curs CURSOR FOR xceb_prep
#     #160906-00041#1-e-mark 
#     
#     #mod zhangllc 160419 begin 会跟axct707资料匹配不上，如xcck033为空的时候，axct707会自动重新抓取资料写入xceb101，此处若仍用xcck033空值的话，会抓取不到
#     #OPEN xceb_curs USING l_xcck.xcck002,l_xcck.xcck010,l_xcck.xcck011,l_xcck.xcck021,l_xcck.xcck022,l_xcck.xcck023,
#     #                      l_xcck.xcck024,l_xcck.xcck025,l_xcck.xcck026,l_xcck.xcck027,l_xcck.xcck028,
#     #                      l_xcck.xcck029,l_xcck.xcck030,l_xcck.xcck031,l_xcck.xcck033
#     #mod zhangllc 160421 add xceb001
#     
#     #160906-00041#1-s-mark  
#     #OPEN xceb_curs USING l_xceb.xceb001,l_xceb.xceb103,l_xceb.xceb004,l_xceb.xceb005,l_xceb.xceb110,l_xceb.xceb111,l_xceb.xceb112,
#     #                     l_xceb.xceb113,l_xceb.xceb114,l_xceb.xceb115,l_xceb.xceb116,l_xceb.xceb117,
#     #                     l_xceb.xceb118,l_xceb.xceb119,l_xceb.xceb120,l_xceb.xceb101
#     ##mod zhangllc 160419 end
#     #160906-00041#1-e-mark
#     
#      OPEN xceb_prep USING l_xceb.xceb103,l_xceb.xceb001,
#                           l_xceb.xceb002,  #161116-00023#1 add
#                           l_xceb.xceb003,l_xceb.xceb004,l_xceb.xceb005  ##160906-00041#1 add
#      
#      #FOREACH xceb_curs INTO l_xceb1.xceb201,           #160906-00041#1 mark
#      FETCH xceb_prep INTO l_xceb1.xceb201,             #160906-00041#1 add
#                           l_xceb1.xceb202,l_xceb1.xceb202a,l_xceb1.xceb202b,l_xceb1.xceb202c,l_xceb1.xceb202d,
#                           l_xceb1.xceb202e,l_xceb1.xceb202f,l_xceb1.xceb202g,l_xceb1.xceb202h,
#                           l_xceb1.xceb212,l_xceb1.xceb212a,l_xceb1.xceb212b,l_xceb1.xceb212c,l_xceb1.xceb212d,
#                           l_xceb1.xceb212e,l_xceb1.xceb212f,l_xceb1.xceb212g,l_xceb1.xceb212h,
#                           l_xceb1.xceb222,l_xceb1.xceb222a,l_xceb1.xceb222b,l_xceb1.xceb222c,l_xceb1.xceb222d,
#                           l_xceb1.xceb222e,l_xceb1.xceb222f,l_xceb1.xceb222g,l_xceb1.xceb222h
#
#
#      IF cl_null(l_xceb.xceb202a) THEN LET l_xceb.xceb202a = 0 END IF
#      IF cl_null(l_xceb.xceb202b) THEN LET l_xceb.xceb202b = 0 END IF
#      IF cl_null(l_xceb.xceb202c) THEN LET l_xceb.xceb202c = 0 END IF
#      IF cl_null(l_xceb.xceb202d) THEN LET l_xceb.xceb202d = 0 END IF
#      IF cl_null(l_xceb.xceb202e) THEN LET l_xceb.xceb202e = 0 END IF
#      IF cl_null(l_xceb.xceb202f) THEN LET l_xceb.xceb202f = 0 END IF
#      IF cl_null(l_xceb.xceb202g) THEN LET l_xceb.xceb202g = 0 END IF
#      IF cl_null(l_xceb.xceb202h) THEN LET l_xceb.xceb202h = 0 END IF
#      IF cl_null(l_xceb.xceb202)  THEN LET l_xceb.xceb202  = 0 END IF
#      IF cl_null(l_xceb.xceb201)  THEN LET l_xceb.xceb201  = 0 END IF    
#      IF cl_null(l_xceb1.xceb202a) THEN LET l_xceb1.xceb202a = 0 END IF
#      IF cl_null(l_xceb1.xceb202b) THEN LET l_xceb1.xceb202b = 0 END IF
#      IF cl_null(l_xceb1.xceb202c) THEN LET l_xceb1.xceb202c = 0 END IF
#      IF cl_null(l_xceb1.xceb202d) THEN LET l_xceb1.xceb202d = 0 END IF
#      IF cl_null(l_xceb1.xceb202e) THEN LET l_xceb1.xceb202e = 0 END IF
#      IF cl_null(l_xceb1.xceb202f) THEN LET l_xceb1.xceb202f = 0 END IF
#      IF cl_null(l_xceb1.xceb202g) THEN LET l_xceb1.xceb202g = 0 END IF
#      IF cl_null(l_xceb1.xceb202h) THEN LET l_xceb1.xceb202h = 0 END IF
#      IF cl_null(l_xceb1.xceb202)  THEN LET l_xceb1.xceb202  = 0 END IF
#      IF cl_null(l_xceb1.xceb201)  THEN LET l_xceb1.xceb201  = 0 END IF    
#      
#      IF cl_null(l_xceb.xceb212a) THEN LET l_xceb.xceb212a = 0 END IF
#      IF cl_null(l_xceb.xceb212b) THEN LET l_xceb.xceb212b = 0 END IF
#      IF cl_null(l_xceb.xceb212c) THEN LET l_xceb.xceb212c = 0 END IF
#      IF cl_null(l_xceb.xceb212d) THEN LET l_xceb.xceb212d = 0 END IF
#      IF cl_null(l_xceb.xceb212e) THEN LET l_xceb.xceb212e = 0 END IF
#      IF cl_null(l_xceb.xceb212f) THEN LET l_xceb.xceb212f = 0 END IF
#      IF cl_null(l_xceb.xceb212g) THEN LET l_xceb.xceb212g = 0 END IF
#      IF cl_null(l_xceb.xceb212h) THEN LET l_xceb.xceb212h = 0 END IF
#      IF cl_null(l_xceb.xceb212)  THEN LET l_xceb.xceb212  = 0 END IF 
#      IF cl_null(l_xceb1.xceb212a) THEN LET l_xceb1.xceb212a = 0 END IF
#      IF cl_null(l_xceb1.xceb212b) THEN LET l_xceb1.xceb212b = 0 END IF
#      IF cl_null(l_xceb1.xceb212c) THEN LET l_xceb1.xceb212c = 0 END IF
#      IF cl_null(l_xceb1.xceb212d) THEN LET l_xceb1.xceb212d = 0 END IF
#      IF cl_null(l_xceb1.xceb212e) THEN LET l_xceb1.xceb212e = 0 END IF
#      IF cl_null(l_xceb1.xceb212f) THEN LET l_xceb1.xceb212f = 0 END IF
#      IF cl_null(l_xceb1.xceb212g) THEN LET l_xceb1.xceb212g = 0 END IF
#      IF cl_null(l_xceb1.xceb212h) THEN LET l_xceb1.xceb212h = 0 END IF
#      IF cl_null(l_xceb1.xceb212)  THEN LET l_xceb1.xceb212  = 0 END IF
#      
#      IF cl_null(l_xceb.xceb222a) THEN LET l_xceb.xceb222a = 0 END IF
#      IF cl_null(l_xceb.xceb222b) THEN LET l_xceb.xceb222b = 0 END IF
#      IF cl_null(l_xceb.xceb222c) THEN LET l_xceb.xceb222c = 0 END IF
#      IF cl_null(l_xceb.xceb222d) THEN LET l_xceb.xceb222d = 0 END IF
#      IF cl_null(l_xceb.xceb222e) THEN LET l_xceb.xceb222e = 0 END IF
#      IF cl_null(l_xceb.xceb222f) THEN LET l_xceb.xceb222f = 0 END IF
#      IF cl_null(l_xceb.xceb222g) THEN LET l_xceb.xceb222g = 0 END IF
#      IF cl_null(l_xceb.xceb222h) THEN LET l_xceb.xceb222h = 0 END IF
#      IF cl_null(l_xceb.xceb222)  THEN LET l_xceb.xceb222  = 0 END IF 
#      IF cl_null(l_xceb1.xceb222a) THEN LET l_xceb1.xceb222a = 0 END IF
#      IF cl_null(l_xceb1.xceb222b) THEN LET l_xceb1.xceb222b = 0 END IF
#      IF cl_null(l_xceb1.xceb222c) THEN LET l_xceb1.xceb222c = 0 END IF
#      IF cl_null(l_xceb1.xceb222d) THEN LET l_xceb1.xceb222d = 0 END IF
#      IF cl_null(l_xceb1.xceb222e) THEN LET l_xceb1.xceb222e = 0 END IF
#      IF cl_null(l_xceb1.xceb222f) THEN LET l_xceb1.xceb222f = 0 END IF
#      IF cl_null(l_xceb1.xceb222g) THEN LET l_xceb1.xceb222g = 0 END IF
#      IF cl_null(l_xceb1.xceb222h) THEN LET l_xceb1.xceb222h = 0 END IF
#      IF cl_null(l_xceb1.xceb222)  THEN LET l_xceb1.xceb222  = 0 END IF
#      
#      LET l_xceb.xceb201 =  l_xceb.xceb201  - l_xceb1.xceb201
#      LET l_xceb.xceb202 =  l_xceb.xceb202  - l_xceb1.xceb202
#      LET l_xceb.xceb202a = l_xceb.xceb202a - l_xceb1.xceb202a
#      LET l_xceb.xceb202b = l_xceb.xceb202b - l_xceb1.xceb202b
#      LET l_xceb.xceb202c = l_xceb.xceb202c - l_xceb1.xceb202c
#      LET l_xceb.xceb202d = l_xceb.xceb202d - l_xceb1.xceb202d
#      LET l_xceb.xceb202e = l_xceb.xceb202e - l_xceb1.xceb202e
#      LET l_xceb.xceb202f = l_xceb.xceb202f - l_xceb1.xceb202f
#      LET l_xceb.xceb202g = l_xceb.xceb202g - l_xceb1.xceb202g
#      LET l_xceb.xceb202h = l_xceb.xceb202h - l_xceb1.xceb202h
#      LET l_xceb.xceb212 =  l_xceb.xceb212  - l_xceb1.xceb212
#      LET l_xceb.xceb212a = l_xceb.xceb212a - l_xceb1.xceb212a
#      LET l_xceb.xceb212b = l_xceb.xceb212b - l_xceb1.xceb212b
#      LET l_xceb.xceb212c = l_xceb.xceb212c - l_xceb1.xceb212c
#      LET l_xceb.xceb212d = l_xceb.xceb212d - l_xceb1.xceb212d
#      LET l_xceb.xceb212e = l_xceb.xceb212e - l_xceb1.xceb212e
#      LET l_xceb.xceb212f = l_xceb.xceb212f - l_xceb1.xceb212f
#      LET l_xceb.xceb212g = l_xceb.xceb212g - l_xceb1.xceb212g
#      LET l_xceb.xceb212h = l_xceb.xceb212h - l_xceb1.xceb212h
#      LET l_xceb.xceb222 =  l_xceb.xceb222  - l_xceb1.xceb222
#      LET l_xceb.xceb222a = l_xceb.xceb222a - l_xceb1.xceb222a
#      LET l_xceb.xceb222b = l_xceb.xceb222b - l_xceb1.xceb222b
#      LET l_xceb.xceb222c = l_xceb.xceb222c - l_xceb1.xceb222c
#      LET l_xceb.xceb222d = l_xceb.xceb222d - l_xceb1.xceb222d
#      LET l_xceb.xceb222e = l_xceb.xceb222e - l_xceb1.xceb222e
#      LET l_xceb.xceb222f = l_xceb.xceb222f - l_xceb1.xceb222f
#      LET l_xceb.xceb222g = l_xceb.xceb222g - l_xceb1.xceb222g
#      LET l_xceb.xceb222h = l_xceb.xceb222h - l_xceb1.xceb222h 
#      #160906-00041#1-s-add
#       #如果金额和数量都为0的话，则不产生此笔单身数据                                                             
#       IF l_xceb.xceb201= 0 AND l_xceb.xceb202 = 0 THEN
#          CONTINUE FOREACH
#       END IF       
#      #160906-00041#1-e-add
#      
#      #161116-00023#1 mark--s 移到上面
#      #LET l_xceb.xcebent = g_enterprise 
#      #LET l_xceb.xcebcomp = g_xcea_m.xceacomp
#      #LET l_xceb.xcebld = g_xcea_m.xceald
#      #LET l_xceb.xcebdocno = g_xcea_m.xceadocno
#      ##摘要
#      #IF cl_null(l_xceb.xceb102) THEN
#      #   CALL axct701_01_get_summ(g_xcea_m.xceald,'61','8925','8') RETURNING l_success,l_xceb.xceb102
#      #END IF       
#      #CALL axct701_01_default_space_xceb(l_xceb.*) RETURNING l_xceb.xceb005,
#      #                                                       l_xceb.xceb101,
#      #                                                       l_xceb.xceb102,
#      #                                                       l_xceb.xceb103,
#      #                                                       l_xceb.xceb110,
#      #                                                       l_xceb.xceb111,
#      #                                                       l_xceb.xceb112,
#      #                                                       l_xceb.xceb113,
#      #                                                       l_xceb.xceb114,
#      #                                                       l_xceb.xceb115,
#      #                                                       l_xceb.xceb116,
#      #                                                       l_xceb.xceb117,
#      #                                                       l_xceb.xceb118,
#      #                                                       l_xceb.xceb119,
#      #                                                       l_xceb.xceb120,
#      #                                                       l_xceb.xceb107,
#      #                                                       l_xceb.xceb108,
#      #                                                       l_xceb.xceb109,
#      #                                                       l_xceb.xceb121,
#      #                                                       l_xceb.xceb122,
#      #                                                       l_xceb.xceb123,
#      #                                                       l_xceb.xceb124,
#      #                                                       l_xceb.xceb125,
#      #                                                       l_xceb.xceb126,
#      #                                                       l_xceb.xceb127,
#      #                                                       l_xceb.xceb128,
#      #                                                       l_xceb.xceb129,
#      #                                                       l_xceb.xceb130 
#      #161116-00023#1 mark--e 移到上面   
#      
#      #160906-00041#1-s-mark 
#      ##如果金额和数量都为0的话，则不产生此笔单身数据                                                             
#      # IF l_xceb.xceb201= 0 AND l_xceb.xceb202 = 0 THEN
#      #    CONTINUE FOREACH
#      # END IF              
#      #160906-00041#1-e-mark  
#      #161109-00085#20-s mod
##      INSERT INTO xceb_t VALUES(l_xceb.*)   #161109-00085#20-s mark
#      #161109-00085#63 --s mark
#      #INSERT INTO xceb_t(xcebent,xcebcomp,xcebld,xcebdocno,xcebseq,xceb001,xceb002,xceb003,xceb004,
#      #                   xceb005,xceb101,xceb102,xceb103,xceb110,xceb111,xceb112,xceb113,xceb114,xceb115,
#      #                   xceb116,xceb117,xceb118,xceb119,xceb120,xceb201,xceb202,xceb202a,xceb202b,xceb202c,
#      #                   xceb202d,xceb202e,xceb202f,xceb202g,xceb202h,xceb212,xceb212a,xceb212b,xceb212c,
#      #                   xceb212d,xceb212e,xceb212f,xceb212g,xceb212h,xceb222,xceb222a,xceb222b,xceb222c,
#      #                   xceb222d,xceb222e,xceb222f,xceb222g,xceb222h,xceb301,xceb302,xceb107,xceb108,xceb109,
#      #                   xceb121,xceb122,xceb123,xceb124,xceb125,xceb126,xceb127,xceb128,xceb129,xceb130,xceb131,xceb132) 
#      #            VALUES(l_xceb.xcebent,l_xceb.xcebcomp,l_xceb.xcebld,l_xceb.xcebdocno,l_xceb.xcebseq,
#      #                   l_xceb.xceb001,l_xceb.xceb002,l_xceb.xceb003,l_xceb.xceb004,l_xceb.xceb005,
#      #                   l_xceb.xceb101,l_xceb.xceb102,l_xceb.xceb103,l_xceb.xceb110,l_xceb.xceb111,
#      #                   l_xceb.xceb112,l_xceb.xceb113,l_xceb.xceb114,l_xceb.xceb115,l_xceb.xceb116,
#      #                   l_xceb.xceb117,l_xceb.xceb118,l_xceb.xceb119,l_xceb.xceb120,l_xceb.xceb201,
#      #                   l_xceb.xceb202,l_xceb.xceb202a,l_xceb.xceb202b,l_xceb.xceb202c,l_xceb.xceb202d,
#      #                   l_xceb.xceb202e,l_xceb.xceb202f,l_xceb.xceb202g,l_xceb.xceb202h,l_xceb.xceb212,
#      #                   l_xceb.xceb212a,l_xceb.xceb212b,l_xceb.xceb212c,l_xceb.xceb212d,l_xceb.xceb212e,
#      #                   l_xceb.xceb212f,l_xceb.xceb212g,l_xceb.xceb212h,l_xceb.xceb222,l_xceb.xceb222a,
#      #                   l_xceb.xceb222b,l_xceb.xceb222c,l_xceb.xceb222d,l_xceb.xceb222e,l_xceb.xceb222f,
#      #                   l_xceb.xceb222g,l_xceb.xceb222h,l_xceb.xceb301,l_xceb.xceb302,l_xceb.xceb107,
#      #                   l_xceb.xceb108,l_xceb.xceb109,l_xceb.xceb121,l_xceb.xceb122,l_xceb.xceb123,
#      #                   l_xceb.xceb124,l_xceb.xceb125,l_xceb.xceb126,l_xceb.xceb127,l_xceb.xceb128,
#      #                   l_xceb.xceb129,l_xceb.xceb130,l_xceb.xceb131,l_xceb.xceb132)
#      #161109-00085#20-e mod
#      #161109-00085#63 --e mark
#      #161109-00085#63 --s add
#      INSERT INTO xceb_t(xcebent,xcebcomp,xcebld,xcebdocno,xcebseq,
#                         xceb001,xceb002,xceb003,xceb004,xceb005,
#                         xceb101,xceb102,xceb103,xceb110,xceb111,
#                         xceb112,xceb113,xceb114,xceb115,xceb116,
#                         xceb117,xceb118,xceb119,xceb120,xceb201,
#                         xceb202,xceb202a,xceb202b,xceb202c,xceb202d,
#                         xceb202e,xceb202f,xceb202g,xceb202h,xceb212,
#                         xceb212a,xceb212b,xceb212c,xceb212d,xceb212e,
#                         xceb212f,xceb212g,xceb212h,xceb222,xceb222a,
#                         xceb222b,xceb222c,xceb222d,xceb222e,xceb222f,
#                         xceb222g,xceb222h,xceb301,xceb302,xcebud001,
#                         xcebud002,xcebud003,xcebud004,xcebud005,xcebud006,
#                         xcebud007,xcebud008,xcebud009,xcebud010,xcebud011,
#                         xcebud012,xcebud013,xcebud014,xcebud015,xcebud016,
#                         xcebud017,xcebud018,xcebud019,xcebud020,xcebud021,
#                         xcebud022,xcebud023,xcebud024,xcebud025,xcebud026,
#                         xcebud027,xcebud028,xcebud029,xcebud030,xceb107,
#                         xceb108,xceb109,xceb121,xceb122,xceb123,
#                         xceb124,xceb125,xceb126,xceb127,xceb128,
#                         xceb129,xceb130,xceb131,xceb132)
#      VALUES(l_xceb.xcebent,l_xceb.xcebcomp,l_xceb.xcebld,l_xceb.xcebdocno,l_xceb.xcebseq,
#             l_xceb.xceb001,l_xceb.xceb002,l_xceb.xceb003,l_xceb.xceb004,l_xceb.xceb005,
#             l_xceb.xceb101,l_xceb.xceb102,l_xceb.xceb103,l_xceb.xceb110,l_xceb.xceb111,
#             l_xceb.xceb112,l_xceb.xceb113,l_xceb.xceb114,l_xceb.xceb115,l_xceb.xceb116,
#             l_xceb.xceb117,l_xceb.xceb118,l_xceb.xceb119,l_xceb.xceb120,l_xceb.xceb201,
#             l_xceb.xceb202,l_xceb.xceb202a,l_xceb.xceb202b,l_xceb.xceb202c,l_xceb.xceb202d,
#             l_xceb.xceb202e,l_xceb.xceb202f,l_xceb.xceb202g,l_xceb.xceb202h,l_xceb.xceb212,
#             l_xceb.xceb212a,l_xceb.xceb212b,l_xceb.xceb212c,l_xceb.xceb212d,l_xceb.xceb212e,
#             l_xceb.xceb212f,l_xceb.xceb212g,l_xceb.xceb212h,l_xceb.xceb222,l_xceb.xceb222a,
#             l_xceb.xceb222b,l_xceb.xceb222c,l_xceb.xceb222d,l_xceb.xceb222e,l_xceb.xceb222f,
#             l_xceb.xceb222g,l_xceb.xceb222h,l_xceb.xceb301,l_xceb.xceb302,l_xceb.xcebud001,
#             l_xceb.xcebud002,l_xceb.xcebud003,l_xceb.xcebud004,l_xceb.xcebud005,l_xceb.xcebud006,
#             l_xceb.xcebud007,l_xceb.xcebud008,l_xceb.xcebud009,l_xceb.xcebud010,l_xceb.xcebud011,
#             l_xceb.xcebud012,l_xceb.xcebud013,l_xceb.xcebud014,l_xceb.xcebud015,l_xceb.xcebud016,
#             l_xceb.xcebud017,l_xceb.xcebud018,l_xceb.xcebud019,l_xceb.xcebud020,l_xceb.xcebud021,
#             l_xceb.xcebud022,l_xceb.xcebud023,l_xceb.xcebud024,l_xceb.xcebud025,l_xceb.xcebud026,
#             l_xceb.xcebud027,l_xceb.xcebud028,l_xceb.xcebud029,l_xceb.xcebud030,l_xceb.xceb107,
#             l_xceb.xceb108,l_xceb.xceb109,l_xceb.xceb121,l_xceb.xceb122,l_xceb.xceb123,
#             l_xceb.xceb124,l_xceb.xceb125,l_xceb.xceb126,l_xceb.xceb127,l_xceb.xceb128,
#             l_xceb.xceb129,l_xceb.xceb130,l_xceb.xceb131,l_xceb.xceb132)
#      #161109-00085#63 --e add
#      IF SQLCA.sqlcode THEN
#         INITIALIZE g_errparam TO NULL
#         LET g_errparam.code = SQLCA.sqlcode
#         LET g_errparam.extend = "ins xceb"
#         LET g_errparam.popup = TRUE
#         CALL cl_err()  
#         LET g_success = 'N'
#         RETURN g_success
#         EXIT FOREACH
#      END IF    
#     #160906-00041#1-s-mark      
#     #END FOREACH         
#     #CLOSE xcck_prep2_2  
#     #CLOSE xcck_prep3_2  
#     #160906-00041#1-e-mark
#   END FOREACH  
#  #160906-00041#1-s-add 
#   CLOSE xcck_prep2_2    
#   CLOSE xcck_prep3_2 
#   CLOSE xceb_prep
#  #160906-00041#1-e-add 
#  
#  #160906-00041#1-s-add
#   #雜項進出憑證xcea002 = '7'
#   LET g_sql = " SELECT SUM(xcec201),SUM(xcec202), ",
#               "        SUM(xcec202a),SUM(xcec202b),SUM(xcec202c),SUM(xcec202d),",
#               "        SUM(xcec202e),SUM(xcec202f),SUM(xcec202g),SUM(xcec202h), ",
#               "        SUM(xcec212),SUM(xcec212a),SUM(xcec212b),SUM(xcec212c),SUM(xcec212d),",
#               "        SUM(xcec212e),SUM(xcec212f),SUM(xcec212g),SUM(xcec212h), ",
#               "        SUM(xcec222),SUM(xcec222a),SUM(xcec222b),SUM(xcec222c),SUM(xcec222d),",
#               "        SUM(xcec222e),SUM(xcec222f),SUM(xcec222g),SUM(xcec222h) ",               
#               "   FROM xcea_t LEFT OUTER JOIN xcec_t ON xceaent = xcecent AND xceald = xcecld AND xceadocno = xcecdocno ",           
#               "  WHERE xceaent = ",g_enterprise," AND xceald = '",g_xcea_m.xceald,"'",
#               "    AND xcea003 = '",g_xcea_m.xcea003,"' AND xcea004 = ",g_xcea_m.xcea004,
#               "    AND xcea005 = ",g_xcea_m.xcea005," AND xcea002 = '7' ",
#               "    AND xcec103 = ? ",               
#               "    AND xcec001 = ? ",
#               "    AND xcec002 = ? ",  #161116-00023#1 add
#               "    AND xcec003 = ? ",               
#               "    AND xcec004 = ? ", 
#               "    AND xcec005 = ? "              
#
#   DECLARE xcec_prep CURSOR FROM g_sql
#  #160906-00041#1-e-add
#
#   #mod zhangllc 160421 add xcck006
#   LET g_sql = " SELECT SUM(xcck009*xcck202), ",
#               "        SUM(xcck009*xcck202a),SUM(xcck009*xcck202b),SUM(xcck009*xcck202c),SUM(xcck009*xcck202d),",
#               "        SUM(xcck009*xcck202e),SUM(xcck009*xcck202f),SUM(xcck009*xcck202g),SUM(xcck009*xcck202h) ",
#               "        FROM xcck_t ", 
#               "  WHERE xcckent = '",g_enterprise,"' AND xcckld = '",g_xcea_m.xceald,"'",
#               "    AND xcck003 = '",g_xcea_m.xcea003,"' AND xcck004 = ",g_xcea_m.xcea004,
#               "    AND xcck005 = ",g_xcea_m.xcea005,
#              #"    AND xcck020 IN ('101','301') ",  
#               "    AND xcck020 IN ('101','301','304') ",      #160420-00016                    
#               "    AND xcck002 = ? AND xcck006 = ? ",
#               "    AND xcck007 = ? ",  #161116-00023#1 add
#               "    AND xcck010 = ? AND xcck011 = ? AND xcck009 = ? AND xcck021 = ? ",  #160906-00041#1 add xcck009
#               "    AND xcck022 = ? AND xcck023 = ? AND xcck024 = ? ",
#               "    AND xcck025 = ? AND xcck026 = ? AND xcck027 = ? ",
#               "    AND xcck028 = ? AND xcck029 = ? AND xcck030 = ? ",
#               "    AND xcck031 = ? " 
#  
#   LET g_sql1 = g_sql CLIPPED," AND xcck001 = '2' AND xcck032 = ? " 
# 
#   LET g_sql2 = g_sql CLIPPED," AND xcck001 = '3' AND xcck032 = ? " 
#
#   
#   #mod zhangllc 160421 add xcck006 #160906-00041#1 add xcck009 #161116-00023#1 add xcck007
#   LET g_sql = " SELECT xcck002,xcck006,xcck007, ",
#               "        xcck010,xcck011,xcck009,xcck021,xcck022,xcck023,xcck024,xcck025,xcck026,xcck027,xcck028,",
#               "        xcck029,xcck030,xcck031,xcck032,SUM(xcck009*xcck201),SUM(xcck009*xcck202), ",
#               "        SUM(xcck009*xcck202a),SUM(xcck009*xcck202b),SUM(xcck009*xcck202c),SUM(xcck009*xcck202d),",
#               "        SUM(xcck009*xcck202e),SUM(xcck009*xcck202f),SUM(xcck009*xcck202g),SUM(xcck009*xcck202h) ",
#               "        FROM xcck_t ", 
#               "  WHERE xcckent = '",g_enterprise,"' AND xcckld = '",g_xcea_m.xceald,"'",
#               "    AND xcck003 = '",g_xcea_m.xcea003,"' AND xcck004 = ",g_xcea_m.xcea004,
#               "    AND xcck005 = ",g_xcea_m.xcea005,
#               "    AND xcck001 = '1' ",
#              #"    AND xcck020 IN ('101','301') ", 
#               "    AND xcck020 IN ('101','301','304') ",      #160420-00016     
#               " GROUP BY xcck002,xcck006,xcck007,xcck010,xcck011,xcck009,xcck021,xcck022,xcck023,xcck024,xcck025,xcck026,xcck027,xcck028,xcck029,xcck030,xcck031,xcck032",  #160906-00041#1 add xcck009
#               " ORDER BY xcck002,xcck006,xcck007,xcck010,xcck011,xcck009,xcck021,xcck022,xcck023,xcck024,xcck025,xcck026,xcck027,xcck028,xcck029,xcck030,xcck031,xcck032"   #160906-00041#1 add xcck009
#   PREPARE xcck_prep_3 FROM g_sql
#   DECLARE xcck_curs_3 CURSOR FOR xcck_prep_3
#   
#
#   FOREACH xcck_curs_3 INTO l_xcck.xcck002,l_xcck.xcck006,
#                            l_xcck.xcck007,  #161116-00023#1 add
#                            l_xcck.xcck010,l_xcck.xcck011,l_xcck.xcck009,l_xcck.xcck021,l_xcck.xcck022,l_xcck.xcck023,  #160906-00041#1 add xcck009
#                            l_xcck.xcck024,l_xcck.xcck025,l_xcck.xcck026,l_xcck.xcck027,l_xcck.xcck028,
#                            l_xcck.xcck029,l_xcck.xcck030,l_xcck.xcck031,l_xcck.xcck032,
#                            l_xcck.xcck201,l_xcck.xcck202,l_xcck.xcck202a,l_xcck.xcck202b,l_xcck.xcck202c,
#                            l_xcck.xcck202d,l_xcck.xcck202e,l_xcck.xcck202f,l_xcck.xcck202g,l_xcck.xcck202h
#
#      INITIALIZE l_xcec.* TO NULL
#      
#      LET l_xcec.xcec001 = l_xcck.xcck006  #add zhangllc 160421 若不存值，axct708来取707资料比对时会对应不上单笔，会取到多笔的sum起来
#      LET l_xcec.xcec002 = l_xcck.xcck007  #161116-00023#1 add
#      #add zhangllc 160421 -s同步与axct707
#      SELECT inba004,inba007 INTO l_xcec.xcec108,l_xcec.xcec110   #部门
#        FROM inba_t
#       WHERE inbaent = g_enterprise
#         AND inbadocno = l_xcck.xcck006
#      IF NOT cl_null(l_xcck.xcck021) THEN
#         LET l_xcec.xcec110 = l_xcck.xcck021 #原因碼
#      END IF
#      #add zhangllc 160421 -end
#     #160906-00041#1-s-add 
#      CASE l_xcck.xcck009
#         WHEN -1          #杂发
#            LET l_xcec.xcec003 = '5'
#         WHEN  1          #杂收
#            LET l_xcec.xcec003 = '6'        
#      END CASE
#     #160906-00041#1-e-add 
#
#      LET l_xcec.xcec103 = l_xcck.xcck002 #成本域
#      LET l_xcec.xcec004 = l_xcck.xcck010 #料號
#      LET l_xcec.xcec005 = l_xcck.xcck011 #料號特性
#      LET l_xcec.xcec110 = l_xcck.xcck021 #原因碼
#      LET l_xcec.xcec111 = l_xcck.xcck022 #交易對象      
#      LET l_xcec.xcec112 = l_xcck.xcck023 #客群 
#      LET l_xcec.xcec113 = l_xcck.xcck024 #區域  
#      LET l_xcec.xcec114 = l_xcck.xcck025 #成本中心      
#      LET l_xcec.xcec115 = l_xcck.xcck026 #經營類別
#      LET l_xcec.xcec116 = l_xcck.xcck027 #渠道
#      LET l_xcec.xcec117 = l_xcck.xcck028 #品類
#      LET l_xcec.xcec118 = l_xcck.xcck029 #品牌
#      LET l_xcec.xcec119 = l_xcck.xcck030 #項目號
#      LET l_xcec.xcec120 = l_xcck.xcck031 #WBS
#      LET l_xcec.xcec101 = l_xcck.xcck032 #存貨科目  
#      LET l_xcec.xcec201 = l_xcck.xcck201
#      LET l_xcec.xcec202 = l_xcck.xcck202
#      LET l_xcec.xcec202a = l_xcck.xcck202a
#      LET l_xcec.xcec202b = l_xcck.xcck202b
#      LET l_xcec.xcec202c = l_xcck.xcck202c
#      LET l_xcec.xcec202d = l_xcck.xcck202d
#      LET l_xcec.xcec202e = l_xcck.xcck202e
#      LET l_xcec.xcec202f = l_xcck.xcck202f
#      LET l_xcec.xcec202g = l_xcck.xcck202g
#      LET l_xcec.xcec202h = l_xcck.xcck202h
#      
#      SELECT MAX(xcecseq) INTO l_xcec.xcecseq FROM xcec_t
#       WHERE xcecent = g_enterprise AND xcecld = g_xcea_m.xceald
#         AND xcecdocno = g_xcea_m.xceadocno
#      IF cl_null(l_xcec.xcecseq) OR l_xcec.xcecseq = 0 THEN
#         LET l_xcec.xcecseq = 1
#      ELSE
#         LET l_xcec.xcecseq = l_xcec.xcecseq + 1
#      END IF  
#
#      IF cl_null(l_xcck.xcck032) THEN  
#         CALL s_get_item_acc(g_xcea_m.xceald,'1',l_xcec.xcec004,'','',g_xcea_m.xceacomp,'')  #存貨科目   #wujie 150214
#          RETURNING l_success,l_xcec.xcec101      
#      ELSE
#         LET l_xcec.xcec101 = l_xcck.xcck032 
#      END IF      
#    
#      IF g_glaa015 ='Y' THEN
#         DECLARE xcck_prep2_3 CURSOR FROM g_sql1
#         #mod zhangllc 160421 add xcck006
#         OPEN xcck_prep2_3 USING l_xcck.xcck002,l_xcck.xcck006,
#                                 l_xcck.xcck007,  #161116-00023#1 add
#                                 l_xcck.xcck010,l_xcck.xcck011,l_xcck.xcck009,l_xcck.xcck021,l_xcck.xcck022,l_xcck.xcck023,  #160906-00041#1 add xcck009
#                                 l_xcck.xcck024,l_xcck.xcck025,l_xcck.xcck026,l_xcck.xcck027,l_xcck.xcck028,
#                                 l_xcck.xcck029,l_xcck.xcck030,l_xcck.xcck031,l_xcck.xcck032
#         FETCH xcck_prep2_3 INTO l_xcec.xcec212,l_xcec.xcec212a,l_xcec.xcec212b,l_xcec.xcec212c,l_xcec.xcec212d,
#                                 l_xcec.xcec212e,l_xcec.xcec212f,l_xcec.xcec212g,l_xcec.xcec212h
#         IF SQLCA.sqlcode THEN
#            INITIALIZE g_errparam TO NULL
#            LET g_errparam.code = SQLCA.sqlcode
#            LET g_errparam.extend = "xcck_prep2_3"
#            LET g_errparam.popup = FALSE
#            CALL cl_err()         
#            LET g_success = 'N'
#            RETURN g_success
#            EXIT FOREACH
#         END IF
#      ELSE
#         LET l_xceb.xceb212a = 0
#         LET l_xceb.xceb212b = 0
#         LET l_xceb.xceb212c = 0
#         LET l_xceb.xceb212d = 0
#         LET l_xceb.xceb212e = 0
#         LET l_xceb.xceb212f = 0
#         LET l_xceb.xceb212g = 0
#         LET l_xceb.xceb212h = 0
#         LET l_xceb.xceb212  = 0     
#      END IF
#      
#      IF g_glaa019 ='Y' THEN
#         DECLARE xcck_prep3_3 CURSOR FROM g_sql2
#         #mod zhangllc 160421 add xcck006
#         OPEN xcck_prep3_3 USING l_xcck.xcck002,l_xcck.xcck006,
#                                 l_xcck.xcck007,  #161116-00023#1 add
#                                 l_xcck.xcck010,l_xcck.xcck011,l_xcck.xcck009,l_xcck.xcck021,l_xcck.xcck022,l_xcck.xcck023,  #160906-00041#1 add xcck009
#                                 l_xcck.xcck024,l_xcck.xcck025,l_xcck.xcck026,l_xcck.xcck027,l_xcck.xcck028,
#                                 l_xcck.xcck029,l_xcck.xcck030,l_xcck.xcck031,l_xcck.xcck032
#         FETCH xcck_prep3_3 INTO l_xcec.xcec222,l_xcec.xcec222a,l_xcec.xcec222b,l_xcec.xcec222c,l_xcec.xcec222d,
#                                 l_xcec.xcec222e,l_xcec.xcec222f,l_xcec.xcec222g,l_xcec.xcec222h
#         IF SQLCA.sqlcode THEN
#            INITIALIZE g_errparam TO NULL
#            LET g_errparam.code = SQLCA.sqlcode
#            LET g_errparam.extend = "xcck_prep3_3"
#            LET g_errparam.popup = FALSE
#            CALL cl_err()         
#            LET g_success = 'N'
#            RETURN g_success
#            EXIT FOREACH
#         END IF
#      ELSE
#         LET l_xceb.xceb222a = 0
#         LET l_xceb.xceb222b = 0
#         LET l_xceb.xceb222c = 0
#         LET l_xceb.xceb222d = 0
#         LET l_xceb.xceb222e = 0
#         LET l_xceb.xceb222f = 0
#         LET l_xceb.xceb222g = 0
#         LET l_xceb.xceb222h = 0
#         LET l_xceb.xceb222  = 0     
#      END IF
#      
#
#      #161116-00023#1 add --s 从下面移上来的
#      LET l_xcec.xcecent = g_enterprise 
#      LET l_xcec.xceccomp = g_xcea_m.xceacomp
#      LET l_xcec.xcecld = g_xcea_m.xceald
#      LET l_xcec.xcecdocno = g_xcea_m.xceadocno
#      #摘要
#      IF cl_null(l_xcec.xcec102) THEN
#         CALL axct701_01_get_summ(g_xcea_m.xceald,'61','8925','8') RETURNING l_success,l_xcec.xcec102
#      END IF
#            
#      CALL axct701_01_default_space_xcec(l_xcec.*) RETURNING l_xcec.xcec005,   
#                                                             l_xcec.xcec101,
#                                                             l_xcec.xcec102,
#                                                             l_xcec.xcec103,
#                                                             l_xcec.xcec110,
#                                                             l_xcec.xcec111,
#                                                             l_xcec.xcec112,
#                                                             l_xcec.xcec113,
#                                                             l_xcec.xcec114,
#                                                             l_xcec.xcec115,
#                                                             l_xcec.xcec116,
#                                                             l_xcec.xcec117,
#                                                             l_xcec.xcec118,
#                                                             l_xcec.xcec119,
#                                                             l_xcec.xcec120,
#                                                             l_xcec.xcec107,
#                                                             l_xcec.xcec108,
#                                                             l_xcec.xcec109,
#                                                             l_xcec.xcec121,
#                                                             l_xcec.xcec122,
#                                                             l_xcec.xcec123,
#                                                             l_xcec.xcec124,
#                                                             l_xcec.xcec125,
#                                                             l_xcec.xcec126,
#                                                             l_xcec.xcec127,
#                                                             l_xcec.xcec128,
#                                                             l_xcec.xcec129,
#                                                             l_xcec.xcec130 
#      #161116-00023#1 add --e 从下面移上来的
#      
#     #160906-00041#1-s-mark 
#     ##雜項進出憑證xcea002 = '7'
#     #LET g_sql = " SELECT SUM(xcec201),SUM(xcec202), ",
#     #         "        SUM(xcec202a),SUM(xcec202b),SUM(xcec202c),SUM(xcec202d),",
#     #         "        SUM(xcec202e),SUM(xcec202f),SUM(xcec202g),SUM(xcec202h), ",
#     #         "        SUM(xcec212),SUM(xcec212a),SUM(xcec212b),SUM(xcec212c),SUM(xcec212d),",
#     #         "        SUM(xcec212e),SUM(xcec212f),SUM(xcec212g),SUM(xcec212h), ",
#     #         "        SUM(xcec222),SUM(xcec222a),SUM(xcec222b),SUM(xcec222c),SUM(xcec222d),",
#     #         "        SUM(xcec222e),SUM(xcec222f),SUM(xcec222g),SUM(xcec222h) ",               
#     #         "        FROM xcea_t LEFT OUTER JOIN xcec_t ON xceaent = xcecent AND xceald = xcecld ",
#     #         "         AND xceadocno = xcecdocno ",               
#     #         "  WHERE xceaent = '",g_enterprise,"' AND xceald = '",g_xcea_m.xceald,"'",
#     #         "    AND xcea003 = '",g_xcea_m.xcea003,"' AND xcea004 = ",g_xcea_m.xcea004,
#     #         "    AND xcea005 = ",g_xcea_m.xcea005," AND xcea002 = '7' ",
#     #         "    AND xcec001 = ? ",  #add zhangllc 160421 跟axct707能一一对应上
#     #         "    AND xcec103 = ? ",
#     #         "    AND xcec004 = ? ", 
#     #         "    AND xcec005 = ? ",
#     #         "    AND xcec110 = ? ", 
#     #         "    AND xcec111 = ? ",      
#     #         "    AND xcec112 = ? ", 
#     #         "    AND xcec113 = ? ",  
#     #         "    AND xcec114 = ? ",      
#     #         "    AND xcec115 = ? ",
#     #         "    AND xcec116 = ? ",
#     #         "    AND xcec117 = ? ", 
#     #         "    AND xcec118 = ? ",
#     #         "    AND xcec119 = ? ",
#     #         "    AND xcec120 = ? ",
#     #         "    AND xcec101 = ? "
#     #         
#     #PREPARE xcec_prep FROM g_sql
#     #DECLARE xcec_curs CURSOR FOR xcec_prep
#     #160906-00041#1-e-mark 
#     #mod zhangllc 160419 begin 会跟axct707资料匹配不上，如xcck033为空的时候，axct707会自动重新抓取资料写入xceb101，此处若仍用xcck033空值的话，会抓取不到
#     #OPEN xcec_curs USING l_xcck.xcck002,l_xcck.xcck010,l_xcck.xcck011,l_xcck.xcck021,l_xcck.xcck022,l_xcck.xcck023,
#     #                      l_xcck.xcck024,l_xcck.xcck025,l_xcck.xcck026,l_xcck.xcck027,l_xcck.xcck028,
#     #                      l_xcck.xcck029,l_xcck.xcck030,l_xcck.xcck031,l_xcck.xcck032
#     #mod zhangllc 160421 add xcec001
#     #160906-00041#1-s-mark  
#     #OPEN xcec_curs USING l_xcec.xcec001,l_xcec.xcec103,l_xcec.xcec004,l_xcec.xcec005,l_xcec.xcec110,l_xcec.xcec111,l_xcec.xcec112,
#     #                      l_xcec.xcec113,l_xcec.xcec114,l_xcec.xcec115,l_xcec.xcec116,l_xcec.xcec117,
#     #                      l_xcec.xcec118,l_xcec.xcec119,l_xcec.xcec120,l_xcec.xcec101
#     ##mod zhangllc 160419 end
#     #160906-00041#1-e-mark 
#      OPEN xcec_prep USING l_xcec.xcec103,l_xcec.xcec001,
#                           l_xcec.xcec002,  #161116-00023#1 add
#                           l_xcec.xcec003,l_xcec.xcec004,l_xcec.xcec005     #160906-00041#1 add
#     #FOREACH xcec_curs INTO l_xcec1.xcec201,    #160906-00041#1 mark
#      FETCH xcec_prep INTO l_xcec1.xcec201,      #160906-00041#1 add
#                           l_xcec1.xcec202,l_xcec1.xcec202a,l_xcec1.xcec202b,l_xcec1.xcec202c,l_xcec1.xcec202d,
#                           l_xcec1.xcec202e,l_xcec1.xcec202f,l_xcec1.xcec202g,l_xcec1.xcec202h,
#                           l_xcec1.xcec212,l_xcec1.xcec212a,l_xcec1.xcec212b,l_xcec1.xcec212c,l_xcec1.xcec212d,
#                           l_xcec1.xcec212e,l_xcec1.xcec212f,l_xcec1.xcec212g,l_xcec1.xcec212h,
#                           l_xcec1.xcec222,l_xcec1.xcec222a,l_xcec1.xcec222b,l_xcec1.xcec222c,l_xcec1.xcec222d,
#                           l_xcec1.xcec222e,l_xcec1.xcec222f,l_xcec1.xcec222g,l_xcec1.xcec222h
#
#     #INITIALIZE l_xcec.* TO NULL   #mark zhangllc 160419 此句增加了，前面的赋值都没了
#      
#      IF cl_null(l_xcec.xcec201)  THEN LET l_xcec.xcec201  = 0 END IF                             
#      IF cl_null(l_xcec.xcec202a) THEN LET l_xcec.xcec202a = 0 END IF
#      IF cl_null(l_xcec.xcec202b) THEN LET l_xcec.xcec202b = 0 END IF
#      IF cl_null(l_xcec.xcec202c) THEN LET l_xcec.xcec202c = 0 END IF
#      IF cl_null(l_xcec.xcec202d) THEN LET l_xcec.xcec202d = 0 END IF
#      IF cl_null(l_xcec.xcec202e) THEN LET l_xcec.xcec202e = 0 END IF
#      IF cl_null(l_xcec.xcec202f) THEN LET l_xcec.xcec202f = 0 END IF
#      IF cl_null(l_xcec.xcec202g) THEN LET l_xcec.xcec202g = 0 END IF
#      IF cl_null(l_xcec.xcec202h) THEN LET l_xcec.xcec202h = 0 END IF
#      IF cl_null(l_xcec.xcec202)  THEN LET l_xcec.xcec202  = 0 END IF
#      IF cl_null(l_xcec1.xcec201)  THEN LET l_xcec1.xcec201  = 0 END IF
#      IF cl_null(l_xcec1.xcec202a) THEN LET l_xcec1.xcec202a = 0 END IF
#      IF cl_null(l_xcec1.xcec202b) THEN LET l_xcec1.xcec202b = 0 END IF
#      IF cl_null(l_xcec1.xcec202c) THEN LET l_xcec1.xcec202c = 0 END IF
#      IF cl_null(l_xcec1.xcec202d) THEN LET l_xcec1.xcec202d = 0 END IF
#      IF cl_null(l_xcec1.xcec202e) THEN LET l_xcec1.xcec202e = 0 END IF
#      IF cl_null(l_xcec1.xcec202f) THEN LET l_xcec1.xcec202f = 0 END IF
#      IF cl_null(l_xcec1.xcec202g) THEN LET l_xcec1.xcec202g = 0 END IF
#      IF cl_null(l_xcec1.xcec202h) THEN LET l_xcec1.xcec202h = 0 END IF
#      IF cl_null(l_xcec1.xcec202)  THEN LET l_xcec1.xcec202  = 0 END IF 
#      
#      IF cl_null(l_xcec.xcec212a) THEN LET l_xcec.xcec212a = 0 END IF
#      IF cl_null(l_xcec.xcec212b) THEN LET l_xcec.xcec212b = 0 END IF
#      IF cl_null(l_xcec.xcec212c) THEN LET l_xcec.xcec212c = 0 END IF
#      IF cl_null(l_xcec.xcec212d) THEN LET l_xcec.xcec212d = 0 END IF
#      IF cl_null(l_xcec.xcec212e) THEN LET l_xcec.xcec212e = 0 END IF
#      IF cl_null(l_xcec.xcec212f) THEN LET l_xcec.xcec212f = 0 END IF
#      IF cl_null(l_xcec.xcec212g) THEN LET l_xcec.xcec212g = 0 END IF
#      IF cl_null(l_xcec.xcec212h) THEN LET l_xcec.xcec212h = 0 END IF
#      IF cl_null(l_xcec.xcec212)  THEN LET l_xcec.xcec212  = 0 END IF
#      IF cl_null(l_xcec1.xcec212a) THEN LET l_xcec1.xcec212a = 0 END IF
#      IF cl_null(l_xcec1.xcec212b) THEN LET l_xcec1.xcec212b = 0 END IF
#      IF cl_null(l_xcec1.xcec212c) THEN LET l_xcec1.xcec212c = 0 END IF
#      IF cl_null(l_xcec1.xcec212d) THEN LET l_xcec1.xcec212d = 0 END IF
#      IF cl_null(l_xcec1.xcec212e) THEN LET l_xcec1.xcec212e = 0 END IF
#      IF cl_null(l_xcec1.xcec212f) THEN LET l_xcec1.xcec212f = 0 END IF
#      IF cl_null(l_xcec1.xcec212g) THEN LET l_xcec1.xcec212g = 0 END IF
#      IF cl_null(l_xcec1.xcec212h) THEN LET l_xcec1.xcec212h = 0 END IF
#      IF cl_null(l_xcec1.xcec212)  THEN LET l_xcec1.xcec212  = 0 END IF 
#      
#                                 
#      IF cl_null(l_xcec.xcec222a) THEN LET l_xcec.xcec222a = 0 END IF
#      IF cl_null(l_xcec.xcec222b) THEN LET l_xcec.xcec222b = 0 END IF
#      IF cl_null(l_xcec.xcec222c) THEN LET l_xcec.xcec222c = 0 END IF
#      IF cl_null(l_xcec.xcec222d) THEN LET l_xcec.xcec222d = 0 END IF
#      IF cl_null(l_xcec.xcec222e) THEN LET l_xcec.xcec222e = 0 END IF
#      IF cl_null(l_xcec.xcec222f) THEN LET l_xcec.xcec222f = 0 END IF
#      IF cl_null(l_xcec.xcec222g) THEN LET l_xcec.xcec222g = 0 END IF
#      IF cl_null(l_xcec.xcec222h) THEN LET l_xcec.xcec222h = 0 END IF
#      IF cl_null(l_xcec.xcec222)  THEN LET l_xcec.xcec222  = 0 END IF
#      IF cl_null(l_xcec1.xcec222a) THEN LET l_xcec1.xcec222a = 0 END IF
#      IF cl_null(l_xcec1.xcec222b) THEN LET l_xcec1.xcec222b = 0 END IF
#      IF cl_null(l_xcec1.xcec222c) THEN LET l_xcec1.xcec222c = 0 END IF
#      IF cl_null(l_xcec1.xcec222d) THEN LET l_xcec1.xcec222d = 0 END IF
#      IF cl_null(l_xcec1.xcec222e) THEN LET l_xcec1.xcec222e = 0 END IF
#      IF cl_null(l_xcec1.xcec222f) THEN LET l_xcec1.xcec222f = 0 END IF
#      IF cl_null(l_xcec1.xcec222g) THEN LET l_xcec1.xcec222g = 0 END IF
#      IF cl_null(l_xcec1.xcec222h) THEN LET l_xcec1.xcec222h = 0 END IF
#      IF cl_null(l_xcec1.xcec222)  THEN LET l_xcec1.xcec222  = 0 END IF      
#       
#      LET l_xcec.xcec201 =  l_xcec.xcec201  - l_xcec1.xcec201
#      LET l_xcec.xcec202 =  l_xcec.xcec202  - l_xcec1.xcec202
#      LET l_xcec.xcec202a = l_xcec.xcec202a - l_xcec1.xcec202a
#      LET l_xcec.xcec202b = l_xcec.xcec202b - l_xcec1.xcec202b
#      LET l_xcec.xcec202c = l_xcec.xcec202c - l_xcec1.xcec202c
#      LET l_xcec.xcec202d = l_xcec.xcec202d - l_xcec1.xcec202d
#      LET l_xcec.xcec202e = l_xcec.xcec202e - l_xcec1.xcec202e
#      LET l_xcec.xcec202f = l_xcec.xcec202f - l_xcec1.xcec202f
#      LET l_xcec.xcec202g = l_xcec.xcec202g - l_xcec1.xcec202g
#      LET l_xcec.xcec202h = l_xcec.xcec202h - l_xcec1.xcec202h
#      LET l_xcec.xcec212 =  l_xcec.xcec212  - l_xcec1.xcec212
#      LET l_xcec.xcec212a = l_xcec.xcec212a - l_xcec1.xcec212a
#      LET l_xcec.xcec212b = l_xcec.xcec212b - l_xcec1.xcec212b
#      LET l_xcec.xcec212c = l_xcec.xcec212c - l_xcec1.xcec212c
#      LET l_xcec.xcec212d = l_xcec.xcec212d - l_xcec1.xcec212d
#      LET l_xcec.xcec212e = l_xcec.xcec212e - l_xcec1.xcec212e
#      LET l_xcec.xcec212f = l_xcec.xcec212f - l_xcec1.xcec212f
#      LET l_xcec.xcec212g = l_xcec.xcec212g - l_xcec1.xcec212g
#      LET l_xcec.xcec212h = l_xcec.xcec212h - l_xcec1.xcec212h
#      LET l_xcec.xcec222 =  l_xcec.xcec222  - l_xcec1.xcec222
#      LET l_xcec.xcec222a = l_xcec.xcec222a - l_xcec1.xcec222a
#      LET l_xcec.xcec222b = l_xcec.xcec222b - l_xcec1.xcec222b
#      LET l_xcec.xcec222c = l_xcec.xcec222c - l_xcec1.xcec222c
#      LET l_xcec.xcec222d = l_xcec.xcec222d - l_xcec1.xcec222d
#      LET l_xcec.xcec222e = l_xcec.xcec222e - l_xcec1.xcec222e
#      LET l_xcec.xcec222f = l_xcec.xcec222f - l_xcec1.xcec222f
#      LET l_xcec.xcec222g = l_xcec.xcec222g - l_xcec1.xcec222g
#      LET l_xcec.xcec222h = l_xcec.xcec222h - l_xcec1.xcec222h 
#      #160906-00041#1-s-add
#      #如果金额和数量都为0的话，则不产生此笔单身数据                                                             
#      IF l_xcec.xcec201= 0 AND l_xcec.xcec202 = 0 THEN
#         CONTINUE FOREACH
#      END IF            
#      #160906-00041#1-s-add
#      
#      #161116-00023#1 mark --s 移到上面
#      #LET l_xcec.xcecent = g_enterprise 
#      #LET l_xcec.xceccomp = g_xcea_m.xceacomp
#      #LET l_xcec.xcecld = g_xcea_m.xceald
#      #LET l_xcec.xcecdocno = g_xcea_m.xceadocno
#      ##摘要
#      #IF cl_null(l_xcec.xcec102) THEN
#      #   CALL axct701_01_get_summ(g_xcea_m.xceald,'61','8925','8') RETURNING l_success,l_xcec.xcec102
#      #END IF
#      #      
#      #CALL axct701_01_default_space_xcec(l_xcec.*) RETURNING l_xcec.xcec005,   
#      #                                                       l_xcec.xcec101,
#      #                                                       l_xcec.xcec102,
#      #                                                       l_xcec.xcec103,
#      #                                                       l_xcec.xcec110,
#      #                                                       l_xcec.xcec111,
#      #                                                       l_xcec.xcec112,
#      #                                                       l_xcec.xcec113,
#      #                                                       l_xcec.xcec114,
#      #                                                       l_xcec.xcec115,
#      #                                                       l_xcec.xcec116,
#      #                                                       l_xcec.xcec117,
#      #                                                       l_xcec.xcec118,
#      #                                                       l_xcec.xcec119,
#      #                                                       l_xcec.xcec120,
#      #                                                       l_xcec.xcec107,
#      #                                                       l_xcec.xcec108,
#      #                                                       l_xcec.xcec109,
#      #                                                       l_xcec.xcec121,
#      #                                                       l_xcec.xcec122,
#      #                                                       l_xcec.xcec123,
#      #                                                       l_xcec.xcec124,
#      #                                                       l_xcec.xcec125,
#      #                                                       l_xcec.xcec126,
#      #                                                       l_xcec.xcec127,
#      #                                                       l_xcec.xcec128,
#      #                                                       l_xcec.xcec129,
#      #                                                       l_xcec.xcec130 
#      #161116-00023#1 mark --e 移到上面
#      
#     #160906-00041#1-s-mark
#     ##如果金额和数量都为0的话，则不产生此笔单身数据                                                             
#     #IF l_xcec.xcec201= 0 AND l_xcec.xcec202 = 0 THEN
#     #   CONTINUE FOREACH
#     #END IF            
#     #160906-00041#1-e-mark
#      #161109-00085#20-s mod      
##      INSERT INTO xcec_t VALUES(l_xcec.*)   #161109-00085#20-s mark
#      #161109-00085#63 --s mark
#      #INSERT INTO xcec_t(xcecent,xceccomp,xcecld,xcecdocno,xcecseq,xcec001,xcec002,xcec003,xcec004,
#      #                   xcec005,xcec101,xcec102,xcec103,xcec110,xcec111,xcec112,xcec113,xcec114,
#      #                   xcec115,xcec116,xcec117,xcec118,xcec119,xcec120,xcec201,xcec202,xcec202a,
#      #                   xcec202b,xcec202c,xcec202d,xcec202e,xcec202f,xcec202g,xcec202h,xcec212,
#      #                   xcec212a,xcec212b,xcec212c,xcec212d,xcec212e,xcec212f,xcec212g,xcec212h,
#      #                   xcec222,xcec222a,xcec222b,xcec222c,xcec222d,xcec222e,xcec222f,xcec222g,
#      #                   xcec222h,xcec301,xcec302,xcec107,xcec108,xcec109,xcec121,xcec122,xcec123,
#      #                   xcec124,xcec125,xcec126,xcec127,xcec128,xcec129,xcec130) 
#      #            VALUES(l_xcec.xcecent,l_xcec.xceccomp,l_xcec.xcecld,l_xcec.xcecdocno,l_xcec.xcecseq,
#      #                   l_xcec.xcec001,l_xcec.xcec002,l_xcec.xcec003,l_xcec.xcec004,l_xcec.xcec005,
#      #                   l_xcec.xcec101,l_xcec.xcec102,l_xcec.xcec103,l_xcec.xcec110,l_xcec.xcec111,
#      #                   l_xcec.xcec112,l_xcec.xcec113,l_xcec.xcec114,l_xcec.xcec115,l_xcec.xcec116,
#      #                   l_xcec.xcec117,l_xcec.xcec118,l_xcec.xcec119,l_xcec.xcec120,l_xcec.xcec201,
#      #                   l_xcec.xcec202,l_xcec.xcec202a,l_xcec.xcec202b,l_xcec.xcec202c,l_xcec.xcec202d,
#      #                   l_xcec.xcec202e,l_xcec.xcec202f,l_xcec.xcec202g,l_xcec.xcec202h,l_xcec.xcec212,
#      #                   l_xcec.xcec212a,l_xcec.xcec212b,l_xcec.xcec212c,l_xcec.xcec212d,l_xcec.xcec212e,
#      #                   l_xcec.xcec212f,l_xcec.xcec212g,l_xcec.xcec212h,l_xcec.xcec222,l_xcec.xcec222a,
#      #                   l_xcec.xcec222b,l_xcec.xcec222c,l_xcec.xcec222d,l_xcec.xcec222e,l_xcec.xcec222f,
#      #                   l_xcec.xcec222g,l_xcec.xcec222h,l_xcec.xcec301,l_xcec.xcec302,l_xcec.xcec107,
#      #                   l_xcec.xcec108,l_xcec.xcec109,l_xcec.xcec121,l_xcec.xcec122,l_xcec.xcec123,
#      #                   l_xcec.xcec124,l_xcec.xcec125,l_xcec.xcec126,l_xcec.xcec127,l_xcec.xcec128,
#      #                   l_xcec.xcec129,l_xcec.xcec130)
#      #161109-00085#63 --e mark
#      #161109-00085#20-e mod
#      #161109-00085#63 --s add
#      INSERT INTO xcec_t(xcecent,xceccomp,xcecld,xcecdocno,xcecseq,
#                         xcec001,xcec002,xcec003,xcec004,xcec005,
#                         xcec101,xcec102,xcec103,xcec110,xcec111,
#                         xcec112,xcec113,xcec114,xcec115,xcec116,
#                         xcec117,xcec118,xcec119,xcec120,xcec201,
#                         xcec202,xcec202a,xcec202b,xcec202c,xcec202d,
#                         xcec202e,xcec202f,xcec202g,xcec202h,xcec212,
#                         xcec212a,xcec212b,xcec212c,xcec212d,xcec212e,
#                         xcec212f,xcec212g,xcec212h,xcec222,xcec222a,
#                         xcec222b,xcec222c,xcec222d,xcec222e,xcec222f,
#                         xcec222g,xcec222h,xcec301,xcec302,xcecud001,
#                         xcecud002,xcecud003,xcecud004,xcecud005,xcecud006,
#                         xcecud007,xcecud008,xcecud009,xcecud010,xcecud011,
#                         xcecud012,xcecud013,xcecud014,xcecud015,xcecud016,
#                         xcecud017,xcecud018,xcecud019,xcecud020,xcecud021,
#                         xcecud022,xcecud023,xcecud024,xcecud025,xcecud026,
#                         xcecud027,xcecud028,xcecud029,xcecud030,xcec107,
#                         xcec108,xcec109,xcec121,xcec122,xcec123,
#                         xcec124,xcec125,xcec126,xcec127,xcec128,
#                         xcec129,xcec130)
#      VALUES(l_xcec.xcecent,l_xcec.xceccomp,l_xcec.xcecld,l_xcec.xcecdocno,l_xcec.xcecseq,
#             l_xcec.xcec001,l_xcec.xcec002,l_xcec.xcec003,l_xcec.xcec004,l_xcec.xcec005,
#             l_xcec.xcec101,l_xcec.xcec102,l_xcec.xcec103,l_xcec.xcec110,l_xcec.xcec111,
#             l_xcec.xcec112,l_xcec.xcec113,l_xcec.xcec114,l_xcec.xcec115,l_xcec.xcec116,
#             l_xcec.xcec117,l_xcec.xcec118,l_xcec.xcec119,l_xcec.xcec120,l_xcec.xcec201,
#             l_xcec.xcec202,l_xcec.xcec202a,l_xcec.xcec202b,l_xcec.xcec202c,l_xcec.xcec202d,
#             l_xcec.xcec202e,l_xcec.xcec202f,l_xcec.xcec202g,l_xcec.xcec202h,l_xcec.xcec212,
#             l_xcec.xcec212a,l_xcec.xcec212b,l_xcec.xcec212c,l_xcec.xcec212d,l_xcec.xcec212e,
#             l_xcec.xcec212f,l_xcec.xcec212g,l_xcec.xcec212h,l_xcec.xcec222,l_xcec.xcec222a,
#             l_xcec.xcec222b,l_xcec.xcec222c,l_xcec.xcec222d,l_xcec.xcec222e,l_xcec.xcec222f,
#             l_xcec.xcec222g,l_xcec.xcec222h,l_xcec.xcec301,l_xcec.xcec302,l_xcec.xcecud001,
#             l_xcec.xcecud002,l_xcec.xcecud003,l_xcec.xcecud004,l_xcec.xcecud005,l_xcec.xcecud006,
#             l_xcec.xcecud007,l_xcec.xcecud008,l_xcec.xcecud009,l_xcec.xcecud010,l_xcec.xcecud011,
#             l_xcec.xcecud012,l_xcec.xcecud013,l_xcec.xcecud014,l_xcec.xcecud015,l_xcec.xcecud016,
#             l_xcec.xcecud017,l_xcec.xcecud018,l_xcec.xcecud019,l_xcec.xcecud020,l_xcec.xcecud021,
#             l_xcec.xcecud022,l_xcec.xcecud023,l_xcec.xcecud024,l_xcec.xcecud025,l_xcec.xcecud026,
#             l_xcec.xcecud027,l_xcec.xcecud028,l_xcec.xcecud029,l_xcec.xcecud030,l_xcec.xcec107,
#             l_xcec.xcec108,l_xcec.xcec109,l_xcec.xcec121,l_xcec.xcec122,l_xcec.xcec123,
#             l_xcec.xcec124,l_xcec.xcec125,l_xcec.xcec126,l_xcec.xcec127,l_xcec.xcec128,
#             l_xcec.xcec129,l_xcec.xcec130)
#      #161109-00085#63 --e add
#      IF SQLCA.sqlcode THEN
#         INITIALIZE g_errparam TO NULL
#         LET g_errparam.code = SQLCA.sqlcode
#         LET g_errparam.extend = "ins xcec"
#         LET g_errparam.popup = TRUE
#         CALL cl_err()   
#         LET g_success = 'N'
#         RETURN g_success
#         EXIT FOREACH
#      END IF  
#     #160906-00041#1-s-mark 
#     #END FOREACH   
#     #CLOSE xcck_prep2_3
#     #CLOSE xcck_prep3_3  
#     #160906-00041#1-e-mark 
#  END FOREACH
# #160906-00041#1-s-mark 
#   CLOSE xcck_prep2_3
#   CLOSE xcck_prep3_3  
#   CLOSE xcec_prep 
# #160906-00041#1-e-mark   
#  RETURN g_success
#170105-00011#2---mark---e 
END FUNCTION

################################################################################
# Descriptions...: axct709批次产生   13.制費結轉傳票
# Memo...........:
# Usage..........: CALL s_aooi150_ins (传入参数)
#                  RETURNING 回传参数
# Input parameter: 传入参数变量1   传入参数变量说明1
#                : 传入参数变量2   传入参数变量说明2
# Return code....: 回传参数变量1   回传参数变量说明1
#                : 回传参数变量2   回传参数变量说明2
# Date & Author..: 日期 By 作者
# Modify.........:
################################################################################
PRIVATE FUNCTION axct701_01_ins_9_bak()
#170105-00011#4---mark---s   
#   DEFINE l_success       LIKE type_t.num5
#   DEFINE l_errno         LIKE gzze_t.gzze001
#   #161109-00085#18-s mod
#   #DEFINE l_xcea          RECORD LIKE xcea_t.*   #161109-00085#18-s mark
#   DEFINE l_xcea          RECORD  #工單發料成本憑證單頭檔
#          xceaent LIKE xcea_t.xceaent, #企業編號
#          xceacomp LIKE xcea_t.xceacomp, #法人組織
#          xceald LIKE xcea_t.xceald, #帳套
#          xceadocno LIKE xcea_t.xceadocno, #單據編號
#          xcea001 LIKE xcea_t.xcea001, #單據日期
#          xcea002 LIKE xcea_t.xcea002, #成本憑證類型
#          xcea003 LIKE xcea_t.xcea003, #成本計算類型
#          xcea004 LIKE xcea_t.xcea004, #年度
#          xcea005 LIKE xcea_t.xcea005, #期別
#          xcea006 LIKE xcea_t.xcea006, #帳務人員
#          xcea007 LIKE xcea_t.xcea007, #帳務部門
#          xcea101 LIKE xcea_t.xcea101, #憑證編號
#          xcea102 LIKE xcea_t.xcea102, #憑證日期
#          xceaownid LIKE xcea_t.xceaownid, #資料所有者
#          xceaowndp LIKE xcea_t.xceaowndp, #資料所屬部門
#          xceacrtid LIKE xcea_t.xceacrtid, #資料建立者
#          xceacrtdp LIKE xcea_t.xceacrtdp, #資料建立部門
#          xceacrtdt LIKE xcea_t.xceacrtdt, #資料創建日
#          xceamodid LIKE xcea_t.xceamodid, #資料修改者
#          xceamoddt LIKE xcea_t.xceamoddt, #最近修改日
#          xceacnfid LIKE xcea_t.xceacnfid, #資料確認者
#          xceacnfdt LIKE xcea_t.xceacnfdt, #資料確認日
#          xceapstid LIKE xcea_t.xceapstid, #資料過帳者
#          xceapstdt LIKE xcea_t.xceapstdt, #資料過帳日
#          xceastus LIKE xcea_t.xceastus, #狀態碼
#          #161109-00085#63 --s add
#          xceaud001 LIKE xcea_t.xceaud001, #自定義欄位(文字)001
#          xceaud002 LIKE xcea_t.xceaud002, #自定義欄位(文字)002
#          xceaud003 LIKE xcea_t.xceaud003, #自定義欄位(文字)003
#          xceaud004 LIKE xcea_t.xceaud004, #自定義欄位(文字)004
#          xceaud005 LIKE xcea_t.xceaud005, #自定義欄位(文字)005
#          xceaud006 LIKE xcea_t.xceaud006, #自定義欄位(文字)006
#          xceaud007 LIKE xcea_t.xceaud007, #自定義欄位(文字)007
#          xceaud008 LIKE xcea_t.xceaud008, #自定義欄位(文字)008
#          xceaud009 LIKE xcea_t.xceaud009, #自定義欄位(文字)009
#          xceaud010 LIKE xcea_t.xceaud010, #自定義欄位(文字)010
#          xceaud011 LIKE xcea_t.xceaud011, #自定義欄位(數字)011
#          xceaud012 LIKE xcea_t.xceaud012, #自定義欄位(數字)012
#          xceaud013 LIKE xcea_t.xceaud013, #自定義欄位(數字)013
#          xceaud014 LIKE xcea_t.xceaud014, #自定義欄位(數字)014
#          xceaud015 LIKE xcea_t.xceaud015, #自定義欄位(數字)015
#          xceaud016 LIKE xcea_t.xceaud016, #自定義欄位(數字)016
#          xceaud017 LIKE xcea_t.xceaud017, #自定義欄位(數字)017
#          xceaud018 LIKE xcea_t.xceaud018, #自定義欄位(數字)018
#          xceaud019 LIKE xcea_t.xceaud019, #自定義欄位(數字)019
#          xceaud020 LIKE xcea_t.xceaud020, #自定義欄位(數字)020
#          xceaud021 LIKE xcea_t.xceaud021, #自定義欄位(日期時間)021
#          xceaud022 LIKE xcea_t.xceaud022, #自定義欄位(日期時間)022
#          xceaud023 LIKE xcea_t.xceaud023, #自定義欄位(日期時間)023
#          xceaud024 LIKE xcea_t.xceaud024, #自定義欄位(日期時間)024
#          xceaud025 LIKE xcea_t.xceaud025, #自定義欄位(日期時間)025
#          xceaud026 LIKE xcea_t.xceaud026, #自定義欄位(日期時間)026
#          xceaud027 LIKE xcea_t.xceaud027, #自定義欄位(日期時間)027
#          xceaud028 LIKE xcea_t.xceaud028, #自定義欄位(日期時間)028
#          xceaud029 LIKE xcea_t.xceaud029, #自定義欄位(日期時間)029
#          xceaud030 LIKE xcea_t.xceaud030, #自定義欄位(日期時間)030
#          #161109-00085#63 --e add
#          xceasite LIKE xcea_t.xceasite  #營運據點
#             END RECORD
#   #161109-00085#18-e mod
#   #161109-00085#18-s mod
#   #DEFINE l_xceb          RECORD LIKE xceb_t.*   #161109-00085#18-s mark
#   DEFINE l_xceb          RECORD  #成本憑證第一單身檔
#          xcebent LIKE xceb_t.xcebent, #企業編號
#          xcebcomp LIKE xceb_t.xcebcomp, #法人組織
#          xcebld LIKE xceb_t.xcebld, #帳套
#          xcebdocno LIKE xceb_t.xcebdocno, #單據編號
#          xcebseq LIKE xceb_t.xcebseq, #項次
#          xceb001 LIKE xceb_t.xceb001, #參考單據編號
#          xceb002 LIKE xceb_t.xceb002, #參考單據項次
#          xceb003 LIKE xceb_t.xceb003, #單據類型
#          xceb004 LIKE xceb_t.xceb004, #料件編號
#          xceb005 LIKE xceb_t.xceb005, #特性
#          xceb101 LIKE xceb_t.xceb101, #科目編號
#          xceb102 LIKE xceb_t.xceb102, #摘要
#          xceb103 LIKE xceb_t.xceb103, #成本域
#          xceb110 LIKE xceb_t.xceb110, #原因碼
#          xceb111 LIKE xceb_t.xceb111, #收付款客商
#          xceb112 LIKE xceb_t.xceb112, #客群
#          xceb113 LIKE xceb_t.xceb113, #區域
#          xceb114 LIKE xceb_t.xceb114, #成本中心
#          xceb115 LIKE xceb_t.xceb115, #經營類別
#          xceb116 LIKE xceb_t.xceb116, #通路
#          xceb117 LIKE xceb_t.xceb117, #品類
#          xceb118 LIKE xceb_t.xceb118, #品牌
#          xceb119 LIKE xceb_t.xceb119, #專案號
#          xceb120 LIKE xceb_t.xceb120, #WBS
#          xceb201 LIKE xceb_t.xceb201, #數量
#          xceb202 LIKE xceb_t.xceb202, #成本金額(本位幣一)
#          xceb202a LIKE xceb_t.xceb202a, #成本-材料(本位幣一)
#          xceb202b LIKE xceb_t.xceb202b, #成本-人工(本位幣一)
#          xceb202c LIKE xceb_t.xceb202c, #成本-加工(本位幣一)
#          xceb202d LIKE xceb_t.xceb202d, #成本-制費一(本位幣一)
#          xceb202e LIKE xceb_t.xceb202e, #成本-制費二(本位幣一)
#          xceb202f LIKE xceb_t.xceb202f, #成本-制費三(本位幣一)
#          xceb202g LIKE xceb_t.xceb202g, #成本-制費四(本位幣一)
#          xceb202h LIKE xceb_t.xceb202h, #成本-制費五(本位幣一)
#          xceb212 LIKE xceb_t.xceb212, #成本金額(本位幣二)
#          xceb212a LIKE xceb_t.xceb212a, #成本-材料(本位幣二)
#          xceb212b LIKE xceb_t.xceb212b, #成本-人工(本位幣二)
#          xceb212c LIKE xceb_t.xceb212c, #成本-加工(本位幣二)
#          xceb212d LIKE xceb_t.xceb212d, #成本-制費一(本位幣二)
#          xceb212e LIKE xceb_t.xceb212e, #成本-制費二(本位幣二)
#          xceb212f LIKE xceb_t.xceb212f, #成本-制費三(本位幣二)
#          xceb212g LIKE xceb_t.xceb212g, #成本-制費四(本位幣二)
#          xceb212h LIKE xceb_t.xceb212h, #成本-制費五(本位幣二)
#          xceb222 LIKE xceb_t.xceb222, #成本金額(本位幣三)
#          xceb222a LIKE xceb_t.xceb222a, #成本-材料(本位幣三)
#          xceb222b LIKE xceb_t.xceb222b, #成本-人工(本位幣三)
#          xceb222c LIKE xceb_t.xceb222c, #成本-加工(本位幣三)
#          xceb222d LIKE xceb_t.xceb222d, #成本-制費一(本位幣三)
#          xceb222e LIKE xceb_t.xceb222e, #成本-制費二(本位幣三)
#          xceb222f LIKE xceb_t.xceb222f, #成本-制費三(本位幣三)
#          xceb222g LIKE xceb_t.xceb222g, #成本-制費四(本位幣三)
#          xceb222h LIKE xceb_t.xceb222h, #成本-制費五(本位幣三)
#          xceb301 LIKE xceb_t.xceb301, #憑證編號
#          xceb302 LIKE xceb_t.xceb302, #憑證項次
#          #161109-00085#63 --s add  
#          xcebud001 LIKE xceb_t.xcebud001, #自定義欄位(文字)001
#          xcebud002 LIKE xceb_t.xcebud002, #自定義欄位(文字)002
#          xcebud003 LIKE xceb_t.xcebud003, #自定義欄位(文字)003
#          xcebud004 LIKE xceb_t.xcebud004, #自定義欄位(文字)004
#          xcebud005 LIKE xceb_t.xcebud005, #自定義欄位(文字)005
#          xcebud006 LIKE xceb_t.xcebud006, #自定義欄位(文字)006
#          xcebud007 LIKE xceb_t.xcebud007, #自定義欄位(文字)007
#          xcebud008 LIKE xceb_t.xcebud008, #自定義欄位(文字)008
#          xcebud009 LIKE xceb_t.xcebud009, #自定義欄位(文字)009
#          xcebud010 LIKE xceb_t.xcebud010, #自定義欄位(文字)010
#          xcebud011 LIKE xceb_t.xcebud011, #自定義欄位(數字)011
#          xcebud012 LIKE xceb_t.xcebud012, #自定義欄位(數字)012
#          xcebud013 LIKE xceb_t.xcebud013, #自定義欄位(數字)013
#          xcebud014 LIKE xceb_t.xcebud014, #自定義欄位(數字)014
#          xcebud015 LIKE xceb_t.xcebud015, #自定義欄位(數字)015
#          xcebud016 LIKE xceb_t.xcebud016, #自定義欄位(數字)016
#          xcebud017 LIKE xceb_t.xcebud017, #自定義欄位(數字)017
#          xcebud018 LIKE xceb_t.xcebud018, #自定義欄位(數字)018
#          xcebud019 LIKE xceb_t.xcebud019, #自定義欄位(數字)019
#          xcebud020 LIKE xceb_t.xcebud020, #自定義欄位(數字)020
#          xcebud021 LIKE xceb_t.xcebud021, #自定義欄位(日期時間)021
#          xcebud022 LIKE xceb_t.xcebud022, #自定義欄位(日期時間)022
#          xcebud023 LIKE xceb_t.xcebud023, #自定義欄位(日期時間)023
#          xcebud024 LIKE xceb_t.xcebud024, #自定義欄位(日期時間)024
#          xcebud025 LIKE xceb_t.xcebud025, #自定義欄位(日期時間)025
#          xcebud026 LIKE xceb_t.xcebud026, #自定義欄位(日期時間)026
#          xcebud027 LIKE xceb_t.xcebud027, #自定義欄位(日期時間)027
#          xcebud028 LIKE xceb_t.xcebud028, #自定義欄位(日期時間)028
#          xcebud029 LIKE xceb_t.xcebud029, #自定義欄位(日期時間)029
#          xcebud030 LIKE xceb_t.xcebud030, #自定義欄位(日期時間)030
#          #161109-00085#63 --e add
#          xceb107 LIKE xceb_t.xceb107, #人員
#          xceb108 LIKE xceb_t.xceb108, #部門
#          xceb109 LIKE xceb_t.xceb109, #帳款對象
#          xceb121 LIKE xceb_t.xceb121, #自由核算項1
#          xceb122 LIKE xceb_t.xceb122, #自由核算項2
#          xceb123 LIKE xceb_t.xceb123, #自由核算項3
#          xceb124 LIKE xceb_t.xceb124, #自由核算項4
#          xceb125 LIKE xceb_t.xceb125, #自由核算項5
#          xceb126 LIKE xceb_t.xceb126, #自由核算項6
#          xceb127 LIKE xceb_t.xceb127, #自由核算項7
#          xceb128 LIKE xceb_t.xceb128, #自由核算項8
#          xceb129 LIKE xceb_t.xceb129, #自由核算項9
#          xceb130 LIKE xceb_t.xceb130, #自由核算項10
#          xceb131 LIKE xceb_t.xceb131, #單據類型(for 流通)
#          xceb132 LIKE xceb_t.xceb132  #單據日期(for 流通)
#             END RECORD
#   #161109-00085#18-e mod
#   #161109-00085#18-s mod
#   #DEFINE l_xcec          RECORD LIKE xcec_t.*   #161109-00085#18-s mark
#   DEFINE l_xcec          RECORD  #成本憑證第二單身檔
#          xcecent LIKE xcec_t.xcecent, #企業編號
#          xceccomp LIKE xcec_t.xceccomp, #法人組織
#          xcecld LIKE xcec_t.xcecld, #帳套
#          xcecdocno LIKE xcec_t.xcecdocno, #單據編號
#          xcecseq LIKE xcec_t.xcecseq, #項次
#          xcec001 LIKE xcec_t.xcec001, #參考單據
#          xcec002 LIKE xcec_t.xcec002, #參考單據項次
#          xcec003 LIKE xcec_t.xcec003, #單據類型
#          xcec004 LIKE xcec_t.xcec004, #料件編號
#          xcec005 LIKE xcec_t.xcec005, #特性
#          xcec101 LIKE xcec_t.xcec101, #科目編號
#          xcec102 LIKE xcec_t.xcec102, #摘要
#          xcec103 LIKE xcec_t.xcec103, #成本域
#          xcec110 LIKE xcec_t.xcec110, #原因碼
#          xcec111 LIKE xcec_t.xcec111, #收付款客商
#          xcec112 LIKE xcec_t.xcec112, #客群
#          xcec113 LIKE xcec_t.xcec113, #區域
#          xcec114 LIKE xcec_t.xcec114, #成本中心
#          xcec115 LIKE xcec_t.xcec115, #經營類別
#          xcec116 LIKE xcec_t.xcec116, #通路
#          xcec117 LIKE xcec_t.xcec117, #品類
#          xcec118 LIKE xcec_t.xcec118, #品牌
#          xcec119 LIKE xcec_t.xcec119, #專案號
#          xcec120 LIKE xcec_t.xcec120, #WBS
#          xcec201 LIKE xcec_t.xcec201, #數量
#          xcec202 LIKE xcec_t.xcec202, #成本金額(本位幣一)
#          xcec202a LIKE xcec_t.xcec202a, #成本-材料(本位幣一)
#          xcec202b LIKE xcec_t.xcec202b, #成本-人工(本位幣一)
#          xcec202c LIKE xcec_t.xcec202c, #成本-加工(本位幣一)
#          xcec202d LIKE xcec_t.xcec202d, #成本-制費一(本位幣一)
#          xcec202e LIKE xcec_t.xcec202e, #成本-制費二(本位幣一)
#          xcec202f LIKE xcec_t.xcec202f, #成本-制費三(本位幣一)
#          xcec202g LIKE xcec_t.xcec202g, #成本-制費四(本位幣一)
#          xcec202h LIKE xcec_t.xcec202h, #成本-制費五(本位幣一)
#          xcec212 LIKE xcec_t.xcec212, #成本-金額(本位幣二)
#          xcec212a LIKE xcec_t.xcec212a, #成本-材料(本位幣二)
#          xcec212b LIKE xcec_t.xcec212b, #成本-人工(本位幣二)
#          xcec212c LIKE xcec_t.xcec212c, #成本-加工(本位幣二)
#          xcec212d LIKE xcec_t.xcec212d, #成本-制費一(本位幣二)
#          xcec212e LIKE xcec_t.xcec212e, #成本-制費二(本位幣二)
#          xcec212f LIKE xcec_t.xcec212f, #成本-制費三(本位幣二)
#          xcec212g LIKE xcec_t.xcec212g, #成本-制費四(本位幣二)
#          xcec212h LIKE xcec_t.xcec212h, #成本-制費五(本位幣二)
#          xcec222 LIKE xcec_t.xcec222, #成本-金額(本位幣三)
#          xcec222a LIKE xcec_t.xcec222a, #成本-材料(本位幣三)
#          xcec222b LIKE xcec_t.xcec222b, #成本-人工(本位幣三)
#          xcec222c LIKE xcec_t.xcec222c, #成本-加工(本位幣三)
#          xcec222d LIKE xcec_t.xcec222d, #成本-制費一(本位幣三)
#          xcec222e LIKE xcec_t.xcec222e, #成本-制費二(本位幣三)
#          xcec222f LIKE xcec_t.xcec222f, #成本-制費三(本位幣三)
#          xcec222g LIKE xcec_t.xcec222g, #成本-制費四(本位幣三)
#          xcec222h LIKE xcec_t.xcec222h, #成本-制費五(本位幣三)
#          xcec301 LIKE xcec_t.xcec301, #憑證編號
#          xcec302 LIKE xcec_t.xcec302, #憑證項次
#          #161109-00085#63 --s add 
#          xcecud001 LIKE xcec_t.xcecud001, #自定義欄位(文字)001
#          xcecud002 LIKE xcec_t.xcecud002, #自定義欄位(文字)002
#          xcecud003 LIKE xcec_t.xcecud003, #自定義欄位(文字)003
#          xcecud004 LIKE xcec_t.xcecud004, #自定義欄位(文字)004
#          xcecud005 LIKE xcec_t.xcecud005, #自定義欄位(文字)005
#          xcecud006 LIKE xcec_t.xcecud006, #自定義欄位(文字)006
#          xcecud007 LIKE xcec_t.xcecud007, #自定義欄位(文字)007
#          xcecud008 LIKE xcec_t.xcecud008, #自定義欄位(文字)008
#          xcecud009 LIKE xcec_t.xcecud009, #自定義欄位(文字)009
#          xcecud010 LIKE xcec_t.xcecud010, #自定義欄位(文字)010
#          xcecud011 LIKE xcec_t.xcecud011, #自定義欄位(數字)011
#          xcecud012 LIKE xcec_t.xcecud012, #自定義欄位(數字)012
#          xcecud013 LIKE xcec_t.xcecud013, #自定義欄位(數字)013
#          xcecud014 LIKE xcec_t.xcecud014, #自定義欄位(數字)014
#          xcecud015 LIKE xcec_t.xcecud015, #自定義欄位(數字)015
#          xcecud016 LIKE xcec_t.xcecud016, #自定義欄位(數字)016
#          xcecud017 LIKE xcec_t.xcecud017, #自定義欄位(數字)017
#          xcecud018 LIKE xcec_t.xcecud018, #自定義欄位(數字)018
#          xcecud019 LIKE xcec_t.xcecud019, #自定義欄位(數字)019
#          xcecud020 LIKE xcec_t.xcecud020, #自定義欄位(數字)020
#          xcecud021 LIKE xcec_t.xcecud021, #自定義欄位(日期時間)021
#          xcecud022 LIKE xcec_t.xcecud022, #自定義欄位(日期時間)022
#          xcecud023 LIKE xcec_t.xcecud023, #自定義欄位(日期時間)023
#          xcecud024 LIKE xcec_t.xcecud024, #自定義欄位(日期時間)024
#          xcecud025 LIKE xcec_t.xcecud025, #自定義欄位(日期時間)025
#          xcecud026 LIKE xcec_t.xcecud026, #自定義欄位(日期時間)026
#          xcecud027 LIKE xcec_t.xcecud027, #自定義欄位(日期時間)027
#          xcecud028 LIKE xcec_t.xcecud028, #自定義欄位(日期時間)028
#          xcecud029 LIKE xcec_t.xcecud029, #自定義欄位(日期時間)029
#          xcecud030 LIKE xcec_t.xcecud030, #自定義欄位(日期時間)030
#          #161109-00085#63 --e add
#          xcec107 LIKE xcec_t.xcec107, #人員
#          xcec108 LIKE xcec_t.xcec108, #部門
#          xcec109 LIKE xcec_t.xcec109, #帳款對象
#          xcec121 LIKE xcec_t.xcec121, #自由核算項1
#          xcec122 LIKE xcec_t.xcec122, #自由核算項2
#          xcec123 LIKE xcec_t.xcec123, #自由核算項3
#          xcec124 LIKE xcec_t.xcec124, #自由核算項4
#          xcec125 LIKE xcec_t.xcec125, #自由核算項5
#          xcec126 LIKE xcec_t.xcec126, #自由核算項6
#          xcec127 LIKE xcec_t.xcec127, #自由核算項7
#          xcec128 LIKE xcec_t.xcec128, #自由核算項8
#          xcec129 LIKE xcec_t.xcec129, #自由核算項9
#          xcec130 LIKE xcec_t.xcec130  #自由核算項10
#                  END RECORD
#   #161109-00085#18-e mod
#   DEFINE ld_date         DATETIME YEAR TO SECOND
#   DEFINE l_sfaa057       LIKE sfaa_t.sfaa057
#   DEFINE l_flag          LIKE type_t.num5
#   DEFINE l_sfaasite      LIKE sfaa_t.sfaasite
#   DEFINE l_sfaa010       LIKE sfaa_t.sfaa010
#   DEFINE l_xcbk005       LIKE xcbk_t.xcbk005  #160420-00016
#   DEFINE l_glad007       LIKE glad_t.glad007  #160511-00045#2 add
#   DEFINE l_glad008       LIKE glad_t.glad008  #160511-00045#2 add
#   DEFINE l_xcbk004       LIKE xcbk_t.xcbk004  #160511-00045#2 add   
#
#   LET g_success = 'Y'
#   LET l_xcea.xceaownid = g_user
#   LET l_xcea.xceaowndp = g_dept
#   LET l_xcea.xceacrtid = g_user
#   LET l_xcea.xceacrtdp = g_dept 
#   LET ld_date  = cl_get_current()
#   LET l_xcea.xceacrtdt = ld_date
#   LET l_xcea.xceamodid = ""
#   LET l_xcea.xceamoddt = ""
#   CALL s_aooi200_fin_gen_docno(g_xcea_m.xceald,'','',g_xcea_m.xceadocno,g_xcea_m.xcea001,g_prog_name1)      #wujie 150214
#    RETURNING l_success,g_xcea_m.xceadocno
#   IF l_success  = 0  THEN
#      INITIALIZE g_errparam TO NULL
#      LET g_errparam.code = 'apm-00003'
#      LET g_errparam.extend = g_xcea_m.xceadocno
#      LET g_errparam.popup = TRUE
#      CALL cl_err()
#
#      LET g_success = 'N'
#      RETURN g_success
#   END IF
#   
#   INSERT INTO xcea_t (xceaent,xceald,xceacomp,xceadocno,xcea001,xcea002,xcea003,xcea004, 
#                       xcea005,xcea006,xcea007,xceastus,xceaownid,xceaowndp,xceacrtid,xceacrtdp,
#                       xceacrtdt, xceamodid,xceamoddt)
#   VALUES (g_enterprise,g_xcea_m.xceald,g_xcea_m.xceacomp,g_xcea_m.xceadocno,g_xcea_m.xcea001,g_xcea002,
#           g_xcea_m.xcea003,g_xcea_m.xcea004,g_xcea_m.xcea005,g_xcea_m.xcea006,g_xcea_m.xcea007, 
#           'N',l_xcea.xceaownid,l_xcea.xceaowndp,l_xcea.xceacrtid, 
#           l_xcea.xceacrtdp,ld_date,l_xcea.xceamodid,l_xcea.xceamoddt) 
#       
#   IF SQLCA.sqlcode THEN
#      INITIALIZE g_errparam TO NULL
#      LET g_errparam.code = SQLCA.sqlcode
#      LET g_errparam.extend = "ins xcea_t"
#      LET g_errparam.popup = TRUE
#      CALL cl_err()
#  
#      LET g_success = 'N'
#      RETURN g_success
#   END IF
#   
#
#   LET g_sql = " SELECT xcbl001,xcbl010,xcbl019,xcbl020,xcbl016,xcbl017,xcbl018,",
#               "        xcbl021,xcbl022,xcbl013,xcbl014,xcbl015,xcbl012,xcbl024,xcbl025,",  #151208-00020#2 add xcbl024,xcbl025
#               "        SUM(xcbl100),SUM(xcbl110),SUM(xcbl120) ",
#               "   FROM xcbl_t ",  
#               "  WHERE xcblent  = '",g_enterprise,"'",
#               "    AND xcblcomp = '",g_xcea_m.xceacomp,"'",
#               "    AND xcblld   = '",g_xcea_m.xceald,"'",
#               "    AND xcbl001 <> '1' ",                       #160616-00047#1 remark 
#               "    AND xcbl002  = '",g_xcea_m.xcea004,"'",
#               "    AND xcbl003  = '",g_xcea_m.xcea005,"'",
#               "  GROUP BY xcbl001,xcbl010,xcbl019,xcbl020,xcbl016,xcbl017,xcbl018,xcbl021,xcbl022,xcbl013,xcbl014,xcbl015,xcbl012,xcbl024,xcbl025"  #151208-00020#2 add xcbl024,xcbl025
#
#   PREPARE axct701_01_xcbl_pr FROM g_sql
#   DECLARE axct701_01_xcbl_cs CURSOR FOR axct701_01_xcbl_pr
#
#  #LET g_sql = " SELECT xcbk006,xcbk007,SUM(xcbk202),SUM(xcbk212),SUM(xcbk222) ",          #160420-00016 mark
#   LET g_sql = " SELECT xcbk005,xcbk006,xcbk007,SUM(xcbk202),SUM(xcbk212),SUM(xcbk222) ",  #160420-00016 
#               "   FROM xcbk_t ",
#               "  WHERE xcbkent  = '",g_enterprise,"'",
#               "    AND xcbkcomp = '",g_xcea_m.xceacomp,"'",
#               "    AND xcbkld   = '",g_xcea_m.xceald,"'",
#               "    AND xcbk001  = '",g_xcea_m.xcea003,"'",
#               "    AND xcbk002  = '",g_xcea_m.xcea004,"'",
#               "    AND xcbk003  = '",g_xcea_m.xcea005,"'",
#               "    AND xcbk005 <> '1' ",              #160706-00021#4 remark
#              #"  GROUP BY xcbk006,xcbk007 ",          #160420-00016 mark
#               "  GROUP BY xcbk005,xcbk006,xcbk007 ",  #160420-00016 
#              #"  ORDER BY xcbk006,xcbk007 "           #160420-00016 mark
#               "  ORDER BY xcbk005,xcbk006,xcbk007 "   #160420-00016                
# 
#   PREPARE axct701_01_xcbk_pr FROM g_sql
#   DECLARE axct701_01_xcbk_cs CURSOR FOR axct701_01_xcbk_pr 
#   LET l_flag = FALSE                                              
#   FOREACH axct701_01_xcbl_cs INTO l_xceb.xceb003,l_xceb.xceb101,l_xceb.xceb117,l_xceb.xceb118,l_xceb.xceb114,l_xceb.xceb115,l_xceb.xceb116,
#                                   l_xceb.xceb119,l_xceb.xceb120,l_xceb.xceb111,l_xceb.xceb112,l_xceb.xceb113,l_xceb.xceb108,
#                                   l_xceb.xceb109,l_xceb.xceb107,   #151208-00020#2 add
#                                   l_xceb.xceb202,l_xceb.xceb212,l_xceb.xceb222
#
#      IF SQLCA.sqlcode THEN
#         INITIALIZE g_errparam TO NULL
#         LET g_errparam.code = SQLCA.sqlcode
#         LET g_errparam.extend = ''
#         LET g_errparam.popup = TRUE
#         CALL cl_err()
#  
#         LET g_success = 'N'
#         RETURN g_success
#      END IF
#            
#      SELECT MAX(xcebseq) INTO l_xceb.xcebseq FROM xceb_t
#       WHERE xcebent = g_enterprise AND xcebld = g_xcea_m.xceald
#         AND xcebdocno = g_xcea_m.xceadocno
#      IF cl_null(l_xceb.xcebseq) OR l_xceb.xcebseq = 0 THEN
#         LET l_xceb.xcebseq = 1
#      ELSE
#         LET l_xceb.xcebseq = l_xceb.xcebseq + 1
#      END IF 
#
#      IF cl_null(l_xceb.xceb201)  THEN LET l_xceb.xceb201 = 0  END IF
#      IF cl_null(l_xceb.xceb202a) THEN LET l_xceb.xceb202a = 0 END IF
#      IF cl_null(l_xceb.xceb202b) THEN LET l_xceb.xceb202b = 0 END IF
#      IF cl_null(l_xceb.xceb202c) THEN LET l_xceb.xceb202c = 0 END IF
#      IF cl_null(l_xceb.xceb202d) THEN LET l_xceb.xceb202d = 0 END IF
#      IF cl_null(l_xceb.xceb202e) THEN LET l_xceb.xceb202e = 0 END IF
#      IF cl_null(l_xceb.xceb202f) THEN LET l_xceb.xceb202f = 0 END IF
#      IF cl_null(l_xceb.xceb202g) THEN LET l_xceb.xceb202g = 0 END IF
#      IF cl_null(l_xceb.xceb202h) THEN LET l_xceb.xceb202h = 0 END IF
#      IF cl_null(l_xceb.xceb202)  THEN LET l_xceb.xceb202  = 0 END IF     
#       
#      
#      IF cl_null(l_xceb.xceb212)  THEN LET l_xceb.xceb212=0  END IF
#      IF cl_null(l_xceb.xceb212a) THEN LET l_xceb.xceb212a=0 END IF
#      IF cl_null(l_xceb.xceb212b) THEN LET l_xceb.xceb212b=0 END IF
#      IF cl_null(l_xceb.xceb212c) THEN LET l_xceb.xceb212c=0 END IF
#      IF cl_null(l_xceb.xceb212d) THEN LET l_xceb.xceb212d=0 END IF
#      IF cl_null(l_xceb.xceb212e) THEN LET l_xceb.xceb212e=0 END IF
#      IF cl_null(l_xceb.xceb212f) THEN LET l_xceb.xceb212f=0 END IF
#      IF cl_null(l_xceb.xceb212g) THEN LET l_xceb.xceb212g=0 END IF
#      IF cl_null(l_xceb.xceb212h) THEN LET l_xceb.xceb212h=0 END IF
#      
#
#      IF cl_null(l_xceb.xceb222)  THEN LET l_xceb.xceb222=0  END IF
#      IF cl_null(l_xceb.xceb222a) THEN LET l_xceb.xceb222a=0 END IF
#      IF cl_null(l_xceb.xceb222b) THEN LET l_xceb.xceb222b=0 END IF
#      IF cl_null(l_xceb.xceb222c) THEN LET l_xceb.xceb222c=0 END IF
#      IF cl_null(l_xceb.xceb222d) THEN LET l_xceb.xceb222d=0 END IF
#      IF cl_null(l_xceb.xceb222e) THEN LET l_xceb.xceb222e=0 END IF
#      IF cl_null(l_xceb.xceb222f) THEN LET l_xceb.xceb222f=0 END IF
#      IF cl_null(l_xceb.xceb222g) THEN LET l_xceb.xceb222g=0 END IF
#      IF cl_null(l_xceb.xceb222h) THEN LET l_xceb.xceb222h=0 END IF
#      
#      LET l_xceb.xcebent = g_enterprise 
#      LET l_xceb.xcebcomp = g_xcea_m.xceacomp
#      LET l_xceb.xcebld = g_xcea_m.xceald
#      LET l_xceb.xcebdocno = g_xcea_m.xceadocno
#      #摘要
#      IF cl_null(l_xceb.xceb102) THEN
#         CALL axct701_01_get_summ(g_xcea_m.xceald,'61','8925','9') RETURNING l_success,l_xceb.xceb102
#      END IF
#      CALL axct701_01_default_space_xceb(l_xceb.*) RETURNING l_xceb.xceb005,
#                                                             l_xceb.xceb101,
#                                                             l_xceb.xceb102,
#                                                             l_xceb.xceb103,
#                                                             l_xceb.xceb110,
#                                                             l_xceb.xceb111,
#                                                             l_xceb.xceb112,
#                                                             l_xceb.xceb113,
#                                                             l_xceb.xceb114,
#                                                             l_xceb.xceb115,
#                                                             l_xceb.xceb116,
#                                                             l_xceb.xceb117,
#                                                             l_xceb.xceb118,
#                                                             l_xceb.xceb119,
#                                                             l_xceb.xceb120,
#                                                             l_xceb.xceb107,
#                                                             l_xceb.xceb108,
#                                                             l_xceb.xceb109,
#                                                             l_xceb.xceb121,
#                                                             l_xceb.xceb122,
#                                                             l_xceb.xceb123,
#                                                             l_xceb.xceb124,
#                                                             l_xceb.xceb125,
#                                                             l_xceb.xceb126,
#                                                             l_xceb.xceb127,
#                                                             l_xceb.xceb128,
#                                                             l_xceb.xceb129,
#                                                             l_xceb.xceb130      
##如果金额和数量都为0的话，则不产生此笔单身数据                                                             
#      IF l_xceb.xceb201= 0 AND l_xceb.xceb202 = 0 THEN
#         CONTINUE FOREACH
#      END IF      
#      #161109-00085#20-s mod
##      INSERT INTO xceb_t VALUES(l_xceb.*)   #161109-00085#20-s mark
#      #161109-00085#63 --s mark
#      #INSERT INTO xceb_t(xcebent,xcebcomp,xcebld,xcebdocno,xcebseq,xceb001,xceb002,xceb003,xceb004,
#      #                   xceb005,xceb101,xceb102,xceb103,xceb110,xceb111,xceb112,xceb113,xceb114,xceb115,
#      #                   xceb116,xceb117,xceb118,xceb119,xceb120,xceb201,xceb202,xceb202a,xceb202b,xceb202c,
#      #                   xceb202d,xceb202e,xceb202f,xceb202g,xceb202h,xceb212,xceb212a,xceb212b,xceb212c,
#      #                   xceb212d,xceb212e,xceb212f,xceb212g,xceb212h,xceb222,xceb222a,xceb222b,xceb222c,
#      #                   xceb222d,xceb222e,xceb222f,xceb222g,xceb222h,xceb301,xceb302,xceb107,xceb108,xceb109,
#      #                   xceb121,xceb122,xceb123,xceb124,xceb125,xceb126,xceb127,xceb128,xceb129,xceb130,xceb131,xceb132) 
#      #            VALUES(l_xceb.xcebent,l_xceb.xcebcomp,l_xceb.xcebld,l_xceb.xcebdocno,l_xceb.xcebseq,
#      #                   l_xceb.xceb001,l_xceb.xceb002,l_xceb.xceb003,l_xceb.xceb004,l_xceb.xceb005,
#      #                   l_xceb.xceb101,l_xceb.xceb102,l_xceb.xceb103,l_xceb.xceb110,l_xceb.xceb111,
#      #                   l_xceb.xceb112,l_xceb.xceb113,l_xceb.xceb114,l_xceb.xceb115,l_xceb.xceb116,
#      #                   l_xceb.xceb117,l_xceb.xceb118,l_xceb.xceb119,l_xceb.xceb120,l_xceb.xceb201,
#      #                   l_xceb.xceb202,l_xceb.xceb202a,l_xceb.xceb202b,l_xceb.xceb202c,l_xceb.xceb202d,
#      #                   l_xceb.xceb202e,l_xceb.xceb202f,l_xceb.xceb202g,l_xceb.xceb202h,l_xceb.xceb212,
#      #                   l_xceb.xceb212a,l_xceb.xceb212b,l_xceb.xceb212c,l_xceb.xceb212d,l_xceb.xceb212e,
#      #                   l_xceb.xceb212f,l_xceb.xceb212g,l_xceb.xceb212h,l_xceb.xceb222,l_xceb.xceb222a,
#      #                   l_xceb.xceb222b,l_xceb.xceb222c,l_xceb.xceb222d,l_xceb.xceb222e,l_xceb.xceb222f,
#      #                   l_xceb.xceb222g,l_xceb.xceb222h,l_xceb.xceb301,l_xceb.xceb302,l_xceb.xceb107,
#      #                   l_xceb.xceb108,l_xceb.xceb109,l_xceb.xceb121,l_xceb.xceb122,l_xceb.xceb123,
#      #                   l_xceb.xceb124,l_xceb.xceb125,l_xceb.xceb126,l_xceb.xceb127,l_xceb.xceb128,
#      #                   l_xceb.xceb129,l_xceb.xceb130,l_xceb.xceb131,l_xceb.xceb132)
#      #161109-00085#20-e mod
#      #161109-00085#63 --e mark
#      #161109-00085#63 --s add
#      INSERT INTO xceb_t(xcebent,xcebcomp,xcebld,xcebdocno,xcebseq,
#                         xceb001,xceb002,xceb003,xceb004,xceb005,
#                         xceb101,xceb102,xceb103,xceb110,xceb111,
#                         xceb112,xceb113,xceb114,xceb115,xceb116,
#                         xceb117,xceb118,xceb119,xceb120,xceb201,
#                         xceb202,xceb202a,xceb202b,xceb202c,xceb202d,
#                         xceb202e,xceb202f,xceb202g,xceb202h,xceb212,
#                         xceb212a,xceb212b,xceb212c,xceb212d,xceb212e,
#                         xceb212f,xceb212g,xceb212h,xceb222,xceb222a,
#                         xceb222b,xceb222c,xceb222d,xceb222e,xceb222f,
#                         xceb222g,xceb222h,xceb301,xceb302,xcebud001,
#                         xcebud002,xcebud003,xcebud004,xcebud005,xcebud006,
#                         xcebud007,xcebud008,xcebud009,xcebud010,xcebud011,
#                         xcebud012,xcebud013,xcebud014,xcebud015,xcebud016,
#                         xcebud017,xcebud018,xcebud019,xcebud020,xcebud021,
#                         xcebud022,xcebud023,xcebud024,xcebud025,xcebud026,
#                         xcebud027,xcebud028,xcebud029,xcebud030,xceb107,
#                         xceb108,xceb109,xceb121,xceb122,xceb123,
#                         xceb124,xceb125,xceb126,xceb127,xceb128,
#                         xceb129,xceb130,xceb131,xceb132)
#      VALUES(l_xceb.xcebent,l_xceb.xcebcomp,l_xceb.xcebld,l_xceb.xcebdocno,l_xceb.xcebseq,
#             l_xceb.xceb001,l_xceb.xceb002,l_xceb.xceb003,l_xceb.xceb004,l_xceb.xceb005,
#             l_xceb.xceb101,l_xceb.xceb102,l_xceb.xceb103,l_xceb.xceb110,l_xceb.xceb111,
#             l_xceb.xceb112,l_xceb.xceb113,l_xceb.xceb114,l_xceb.xceb115,l_xceb.xceb116,
#             l_xceb.xceb117,l_xceb.xceb118,l_xceb.xceb119,l_xceb.xceb120,l_xceb.xceb201,
#             l_xceb.xceb202,l_xceb.xceb202a,l_xceb.xceb202b,l_xceb.xceb202c,l_xceb.xceb202d,
#             l_xceb.xceb202e,l_xceb.xceb202f,l_xceb.xceb202g,l_xceb.xceb202h,l_xceb.xceb212,
#             l_xceb.xceb212a,l_xceb.xceb212b,l_xceb.xceb212c,l_xceb.xceb212d,l_xceb.xceb212e,
#             l_xceb.xceb212f,l_xceb.xceb212g,l_xceb.xceb212h,l_xceb.xceb222,l_xceb.xceb222a,
#             l_xceb.xceb222b,l_xceb.xceb222c,l_xceb.xceb222d,l_xceb.xceb222e,l_xceb.xceb222f,
#             l_xceb.xceb222g,l_xceb.xceb222h,l_xceb.xceb301,l_xceb.xceb302,l_xceb.xcebud001,
#             l_xceb.xcebud002,l_xceb.xcebud003,l_xceb.xcebud004,l_xceb.xcebud005,l_xceb.xcebud006,
#             l_xceb.xcebud007,l_xceb.xcebud008,l_xceb.xcebud009,l_xceb.xcebud010,l_xceb.xcebud011,
#             l_xceb.xcebud012,l_xceb.xcebud013,l_xceb.xcebud014,l_xceb.xcebud015,l_xceb.xcebud016,
#             l_xceb.xcebud017,l_xceb.xcebud018,l_xceb.xcebud019,l_xceb.xcebud020,l_xceb.xcebud021,
#             l_xceb.xcebud022,l_xceb.xcebud023,l_xceb.xcebud024,l_xceb.xcebud025,l_xceb.xcebud026,
#             l_xceb.xcebud027,l_xceb.xcebud028,l_xceb.xcebud029,l_xceb.xcebud030,l_xceb.xceb107,
#             l_xceb.xceb108,l_xceb.xceb109,l_xceb.xceb121,l_xceb.xceb122,l_xceb.xceb123,
#             l_xceb.xceb124,l_xceb.xceb125,l_xceb.xceb126,l_xceb.xceb127,l_xceb.xceb128,
#             l_xceb.xceb129,l_xceb.xceb130,l_xceb.xceb131,l_xceb.xceb132)
#      #161109-00085#63 --e add
#      IF SQLCA.sqlcode THEN
#         INITIALIZE g_errparam TO NULL
#         LET g_errparam.code = SQLCA.sqlcode
#         LET g_errparam.extend = "ins xceb_t"
#         LET g_errparam.popup = TRUE
#         CALL cl_err()
#  
#         LET g_success = 'N'
#         RETURN g_success
#      END IF   
#      LET l_flag = TRUE
#   END FOREACH  
#
#   IF NOT l_flag THEN
#      INITIALIZE g_errparam TO NULL
#      LET g_errparam.code = 'axc-00400'
#      LET g_errparam.extend = ""
#      LET g_errparam.popup = TRUE
#      CALL cl_err()
#  
#      LET g_success = 'N'
#      RETURN g_success   
#   END IF
#   LET l_flag = FALSE
#  #FOREACH axct701_01_xcbk_cs INTO l_xcec.xcec001,l_xcec.xcec003,l_xcec.xcec202,l_xcec.xcec212,l_xcec.xcec222            #160420-00016 mark
#   FOREACH axct701_01_xcbk_cs INTO l_xcbk005,l_xcec.xcec001,l_xcec.xcec003,l_xcec.xcec202,l_xcec.xcec212,l_xcec.xcec222  #160420-00016   
#      IF SQLCA.sqlcode THEN
#         INITIALIZE g_errparam TO NULL
#         LET g_errparam.code = SQLCA.sqlcode
#         LET g_errparam.extend = ''
#         LET g_errparam.popup = TRUE
#         CALL cl_err()
#  
#         LET g_success = 'N'
#         RETURN g_success
#      END IF
#      
#      SELECT MAX(xcecseq) INTO l_xcec.xcecseq FROM xcec_t
#       WHERE xcecent = g_enterprise AND xcecld = g_xcea_m.xceald
#         AND xcecdocno = g_xcea_m.xceadocno
#      IF cl_null(l_xcec.xcecseq) OR l_xcec.xcecseq = 0 THEN
#         LET l_xcec.xcecseq = 1
#      ELSE
#         LET l_xcec.xcecseq = l_xcec.xcecseq + 1
#      END IF 
#      
#      LET l_xcec.xcec101 = NULL
#      LET l_xcec.xcec102 = NULL
#      LET l_xcec.xcec110 = NULL
#      LET l_xcec.xcec111 = NULL
#      LET l_xcec.xcec112 = NULL
#      LET l_xcec.xcec113 = NULL
#      LET l_xcec.xcec114 = NULL
#      LET l_xcec.xcec115 = ' '
#      LET l_xcec.xcec116 = ' '
#      LET l_xcec.xcec117 = NULL
#      LET l_xcec.xcec118 = ' '
#      LET l_xcec.xcec119 = NULL
#      LET l_xcec.xcec120 = NULL
#      
#      IF cl_null(l_xcec.xcec201)  THEN LET l_xcec.xcec201=0 END IF
#      
#      IF cl_null(l_xcec.xcec202)  THEN LET l_xcec.xcec202=0 END IF
#      IF cl_null(l_xcec.xcec202a) THEN LET l_xcec.xcec202a=0 END IF
#      IF cl_null(l_xcec.xcec202b) THEN LET l_xcec.xcec202b=0 END IF
#      IF cl_null(l_xcec.xcec202c) THEN LET l_xcec.xcec202c=0 END IF
#      IF cl_null(l_xcec.xcec202d) THEN LET l_xcec.xcec202d=0 END IF
#      IF cl_null(l_xcec.xcec202e) THEN LET l_xcec.xcec202e=0 END IF
#      IF cl_null(l_xcec.xcec202f) THEN LET l_xcec.xcec202f=0 END IF
#      IF cl_null(l_xcec.xcec202g) THEN LET l_xcec.xcec202g=0 END IF
#      IF cl_null(l_xcec.xcec202h) THEN LET l_xcec.xcec202h=0 END IF
#
#
#      IF cl_null(l_xcec.xcec212)  THEN LET l_xcec.xcec212=0 END IF
#      IF cl_null(l_xcec.xcec212a) THEN LET l_xcec.xcec212a=0 END IF
#      IF cl_null(l_xcec.xcec212b) THEN LET l_xcec.xcec212b=0 END IF
#      IF cl_null(l_xcec.xcec212c) THEN LET l_xcec.xcec212c=0 END IF
#      IF cl_null(l_xcec.xcec212d) THEN LET l_xcec.xcec212d=0 END IF
#      IF cl_null(l_xcec.xcec212e) THEN LET l_xcec.xcec212e=0 END IF
#      IF cl_null(l_xcec.xcec212f) THEN LET l_xcec.xcec212f=0 END IF
#      IF cl_null(l_xcec.xcec212g) THEN LET l_xcec.xcec212g=0 END IF
#      IF cl_null(l_xcec.xcec212h) THEN LET l_xcec.xcec212h=0 END IF
#
#
#      IF cl_null(l_xcec.xcec222)  THEN LET l_xcec.xcec222=0 END IF
#      IF cl_null(l_xcec.xcec222a) THEN LET l_xcec.xcec222a=0 END IF
#      IF cl_null(l_xcec.xcec222b) THEN LET l_xcec.xcec222b=0 END IF
#      IF cl_null(l_xcec.xcec222c) THEN LET l_xcec.xcec222c=0 END IF
#      IF cl_null(l_xcec.xcec222d) THEN LET l_xcec.xcec222d=0 END IF
#      IF cl_null(l_xcec.xcec222e) THEN LET l_xcec.xcec222e=0 END IF
#      IF cl_null(l_xcec.xcec222f) THEN LET l_xcec.xcec222f=0 END IF
#      IF cl_null(l_xcec.xcec222g) THEN LET l_xcec.xcec222g=0 END IF
#      IF cl_null(l_xcec.xcec222h) THEN LET l_xcec.xcec222h=0 END IF
#            
##廠內/委外      #項目編號/WBS
#      LET l_sfaa057 = ''
#      LET l_sfaasite =''
#      LET l_sfaa010  = ''
#      SELECT sfaa010,sfaa068,sfaa028,sfaa029,sfaa057,sfaasite,sfaa009,sfaa029 INTO l_sfaa010,l_xcec.xcec114,l_xcec.xcec119,l_xcec.xcec120,l_sfaa057,l_sfaasite,l_xcec.xcec111,l_xcec.xcec120
#        FROM sfaa_t WHERE sfaaent = g_enterprise AND sfaadocno = l_xcec.xcec001
# 
#      #150906-00001#2-s
#      IF l_sfaa057 = '2' THEN
#         CALL s_get_item_acc(g_xcea_m.xceald,'26',l_sfaa010,'','',g_xcea_m.xceacomp,'') 
#              RETURNING l_success,l_xcec.xcec101      
#      ELSE
#      #150906-00001#2-e
#      #成本科目
#      CALL s_get_item_acc(g_xcea_m.xceald,'11',l_sfaa010,'','',g_xcea_m.xceacomp,'') 
#           RETURNING l_success,l_xcec.xcec101
#      END IF  #150906-00001#2
##agli161抓不到，改抓axci201的科目
#      IF cl_null(l_xcec.xcec101) THEN
#         IF l_xcbk005 = '1' THEN                                                                                #160420-00016
#            CALL s_fin_get_account(g_xcea_m.xceald,'60','8912','2') RETURNING l_success,l_xcec.xcec101,l_errno  #160420-00016
#         ELSE                                                                                                   #160420-00016
#            CALL s_fin_get_account(g_xcea_m.xceald,'60','8912','3') RETURNING l_success,l_xcec.xcec101,l_errno
#         END IF                                                                                                 #160420-00016        
#      END IF
#      
#     #--160511-00045#2--add--(S)
#      IF NOT cl_null(l_xcec.xcec101) THEN
#         LET l_xcbk004 = ''
#         SELECT xcbk004 INTO l_xcbk004
#           FROM xcbk_t 
#          WHERE xcbkent  = g_enterprise
#            AND xcbkcomp = g_xcea_m.xceacomp
#            AND xcbkld   = g_xcea_m.xceald
#            AND xcbk001  = g_xcea_m.xcea003
#            AND xcbk002  = g_xcea_m.xcea004
#            AND xcbk003  = g_xcea_m.xcea005
#            AND xcbk005  = l_xcbk005
#            AND xcbk006  = l_xcec.xcec001
#            AND xcbk007  = l_xcec.xcec003       
#         LET l_glad007 = ''
#         LET l_glad008 = ''
#         SELECT glad007,glad008 INTO l_glad007,l_glad008
#           FROM glad_t
#          WHERE gladent = g_enterprise
#            AND gladld = g_xcea_m.xceald
#            AND glad001 = l_xcec.xcec101
#         IF l_glad007 = 'Y' THEN
#            LET l_xcec.xcec108 = l_xcbk004
#         END IF         
#         IF l_glad008 = 'Y' THEN
#            LET l_xcec.xcec114 = l_xcbk004
#         END IF
#      END IF
#     #--160511-00045#2--add--(E)      
#      
#      IF l_sfaa057 = '2' THEN   #委外
#         #客群/區域
#         SELECT pmaa002,pmaa005 INTO l_xcec.xcec112,l_xcec.xcec113 
#           FROM pmaa_t 
#          WHERE pmaaent = g_enterprise 
#            AND pmaa001 = l_xcec.xcec111
#         
#         
#      ELSE   #廠內
#         LET l_xcec.xcec111 = ' '
#         #客群
#         LET l_xcec.xcec112 = ' '
#         #區域
#         SELECT ooef153 INTO l_xcec.xcec113 FROM ooef_t
#          WHERE ooefent = g_enterprise
#            AND ooef001 = l_sfaasite
#      END IF 
#      
#      #品類
#      SELECT imag011 INTO l_xcec.xcec117 
#        FROM imag_t 
#       WHERE imagent = g_enterprise 
#         AND imagsite = g_xcea_m.xceacomp
#         AND imag001 = l_xcec.xcec004
#            
#
#      
#      LET l_xcec.xcecent = g_enterprise 
#      LET l_xcec.xceccomp = g_xcea_m.xceacomp
#      LET l_xcec.xcecld = g_xcea_m.xceald
#      LET l_xcec.xcecdocno = g_xcea_m.xceadocno
#      #摘要
#      IF cl_null(l_xcec.xcec102) THEN
#         CALL axct701_01_get_summ(g_xcea_m.xceald,'61','8925','9') RETURNING l_success,l_xcec.xcec102
#      END IF
#      CALL axct701_01_default_space_xcec(l_xcec.*) RETURNING l_xcec.xcec005,   
#                                                             l_xcec.xcec101,
#                                                             l_xcec.xcec102,
#                                                             l_xcec.xcec103,
#                                                             l_xcec.xcec110,
#                                                             l_xcec.xcec111,
#                                                             l_xcec.xcec112,
#                                                             l_xcec.xcec113,
#                                                             l_xcec.xcec114,
#                                                             l_xcec.xcec115,
#                                                             l_xcec.xcec116,
#                                                             l_xcec.xcec117,
#                                                             l_xcec.xcec118,
#                                                             l_xcec.xcec119,
#                                                             l_xcec.xcec120,
#                                                             l_xcec.xcec107,
#                                                             l_xcec.xcec108,
#                                                             l_xcec.xcec109,
#                                                             l_xcec.xcec121,
#                                                             l_xcec.xcec122,
#                                                             l_xcec.xcec123,
#                                                             l_xcec.xcec124,
#                                                             l_xcec.xcec125,
#                                                             l_xcec.xcec126,
#                                                             l_xcec.xcec127,
#                                                             l_xcec.xcec128,
#                                                             l_xcec.xcec129,
#                                                             l_xcec.xcec130 
#      #161109-00085#20-s mod      
##      INSERT INTO xcec_t VALUES(l_xcec.*)   #161109-00085#20-s mark
#      #161109-00085#63 --s mark
#      #INSERT INTO xcec_t(xcecent,xceccomp,xcecld,xcecdocno,xcecseq,xcec001,xcec002,xcec003,xcec004,
#      #                   xcec005,xcec101,xcec102,xcec103,xcec110,xcec111,xcec112,xcec113,xcec114,
#      #                   xcec115,xcec116,xcec117,xcec118,xcec119,xcec120,xcec201,xcec202,xcec202a,
#      #                   xcec202b,xcec202c,xcec202d,xcec202e,xcec202f,xcec202g,xcec202h,xcec212,
#      #                   xcec212a,xcec212b,xcec212c,xcec212d,xcec212e,xcec212f,xcec212g,xcec212h,
#      #                   xcec222,xcec222a,xcec222b,xcec222c,xcec222d,xcec222e,xcec222f,xcec222g,
#      #                   xcec222h,xcec301,xcec302,xcec107,xcec108,xcec109,xcec121,xcec122,xcec123,
#      #                   xcec124,xcec125,xcec126,xcec127,xcec128,xcec129,xcec130) 
#      #            VALUES(l_xcec.xcecent,l_xcec.xceccomp,l_xcec.xcecld,l_xcec.xcecdocno,l_xcec.xcecseq,
#      #                   l_xcec.xcec001,l_xcec.xcec002,l_xcec.xcec003,l_xcec.xcec004,l_xcec.xcec005,
#      #                   l_xcec.xcec101,l_xcec.xcec102,l_xcec.xcec103,l_xcec.xcec110,l_xcec.xcec111,
#      #                   l_xcec.xcec112,l_xcec.xcec113,l_xcec.xcec114,l_xcec.xcec115,l_xcec.xcec116,
#      #                   l_xcec.xcec117,l_xcec.xcec118,l_xcec.xcec119,l_xcec.xcec120,l_xcec.xcec201,
#      #                   l_xcec.xcec202,l_xcec.xcec202a,l_xcec.xcec202b,l_xcec.xcec202c,l_xcec.xcec202d,
#      #                   l_xcec.xcec202e,l_xcec.xcec202f,l_xcec.xcec202g,l_xcec.xcec202h,l_xcec.xcec212,
#      #                   l_xcec.xcec212a,l_xcec.xcec212b,l_xcec.xcec212c,l_xcec.xcec212d,l_xcec.xcec212e,
#      #                   l_xcec.xcec212f,l_xcec.xcec212g,l_xcec.xcec212h,l_xcec.xcec222,l_xcec.xcec222a,
#      #                   l_xcec.xcec222b,l_xcec.xcec222c,l_xcec.xcec222d,l_xcec.xcec222e,l_xcec.xcec222f,
#      #                   l_xcec.xcec222g,l_xcec.xcec222h,l_xcec.xcec301,l_xcec.xcec302,l_xcec.xcec107,
#      #                   l_xcec.xcec108,l_xcec.xcec109,l_xcec.xcec121,l_xcec.xcec122,l_xcec.xcec123,
#      #                   l_xcec.xcec124,l_xcec.xcec125,l_xcec.xcec126,l_xcec.xcec127,l_xcec.xcec128,
#      #                   l_xcec.xcec129,l_xcec.xcec130)
#      #161109-00085#63 --e mark
#      #161109-00085#20-e mod
#      #161109-00085#63 --s add
#      INSERT INTO xcec_t(xcecent,xceccomp,xcecld,xcecdocno,xcecseq,
#                         xcec001,xcec002,xcec003,xcec004,xcec005,
#                         xcec101,xcec102,xcec103,xcec110,xcec111,
#                         xcec112,xcec113,xcec114,xcec115,xcec116,
#                         xcec117,xcec118,xcec119,xcec120,xcec201,
#                         xcec202,xcec202a,xcec202b,xcec202c,xcec202d,
#                         xcec202e,xcec202f,xcec202g,xcec202h,xcec212,
#                         xcec212a,xcec212b,xcec212c,xcec212d,xcec212e,
#                         xcec212f,xcec212g,xcec212h,xcec222,xcec222a,
#                         xcec222b,xcec222c,xcec222d,xcec222e,xcec222f,
#                         xcec222g,xcec222h,xcec301,xcec302,xcecud001,
#                         xcecud002,xcecud003,xcecud004,xcecud005,xcecud006,
#                         xcecud007,xcecud008,xcecud009,xcecud010,xcecud011,
#                         xcecud012,xcecud013,xcecud014,xcecud015,xcecud016,
#                         xcecud017,xcecud018,xcecud019,xcecud020,xcecud021,
#                         xcecud022,xcecud023,xcecud024,xcecud025,xcecud026,
#                         xcecud027,xcecud028,xcecud029,xcecud030,xcec107,
#                         xcec108,xcec109,xcec121,xcec122,xcec123,
#                         xcec124,xcec125,xcec126,xcec127,xcec128,
#                         xcec129,xcec130)
#      VALUES(l_xcec.xcecent,l_xcec.xceccomp,l_xcec.xcecld,l_xcec.xcecdocno,l_xcec.xcecseq,
#             l_xcec.xcec001,l_xcec.xcec002,l_xcec.xcec003,l_xcec.xcec004,l_xcec.xcec005,
#             l_xcec.xcec101,l_xcec.xcec102,l_xcec.xcec103,l_xcec.xcec110,l_xcec.xcec111,
#             l_xcec.xcec112,l_xcec.xcec113,l_xcec.xcec114,l_xcec.xcec115,l_xcec.xcec116,
#             l_xcec.xcec117,l_xcec.xcec118,l_xcec.xcec119,l_xcec.xcec120,l_xcec.xcec201,
#             l_xcec.xcec202,l_xcec.xcec202a,l_xcec.xcec202b,l_xcec.xcec202c,l_xcec.xcec202d,
#             l_xcec.xcec202e,l_xcec.xcec202f,l_xcec.xcec202g,l_xcec.xcec202h,l_xcec.xcec212,
#             l_xcec.xcec212a,l_xcec.xcec212b,l_xcec.xcec212c,l_xcec.xcec212d,l_xcec.xcec212e,
#             l_xcec.xcec212f,l_xcec.xcec212g,l_xcec.xcec212h,l_xcec.xcec222,l_xcec.xcec222a,
#             l_xcec.xcec222b,l_xcec.xcec222c,l_xcec.xcec222d,l_xcec.xcec222e,l_xcec.xcec222f,
#             l_xcec.xcec222g,l_xcec.xcec222h,l_xcec.xcec301,l_xcec.xcec302,l_xcec.xcecud001,
#             l_xcec.xcecud002,l_xcec.xcecud003,l_xcec.xcecud004,l_xcec.xcecud005,l_xcec.xcecud006,
#             l_xcec.xcecud007,l_xcec.xcecud008,l_xcec.xcecud009,l_xcec.xcecud010,l_xcec.xcecud011,
#             l_xcec.xcecud012,l_xcec.xcecud013,l_xcec.xcecud014,l_xcec.xcecud015,l_xcec.xcecud016,
#             l_xcec.xcecud017,l_xcec.xcecud018,l_xcec.xcecud019,l_xcec.xcecud020,l_xcec.xcecud021,
#             l_xcec.xcecud022,l_xcec.xcecud023,l_xcec.xcecud024,l_xcec.xcecud025,l_xcec.xcecud026,
#             l_xcec.xcecud027,l_xcec.xcecud028,l_xcec.xcecud029,l_xcec.xcecud030,l_xcec.xcec107,
#             l_xcec.xcec108,l_xcec.xcec109,l_xcec.xcec121,l_xcec.xcec122,l_xcec.xcec123,
#             l_xcec.xcec124,l_xcec.xcec125,l_xcec.xcec126,l_xcec.xcec127,l_xcec.xcec128,
#             l_xcec.xcec129,l_xcec.xcec130)
#      #161109-00085#63 --e add
#      IF SQLCA.sqlcode THEN
#         INITIALIZE g_errparam TO NULL
#         LET g_errparam.code = SQLCA.sqlcode
#         LET g_errparam.extend = "ins xcec_t"
#         LET g_errparam.popup = TRUE
#         CALL cl_err()
#  
#         LET g_success = 'N'
#         RETURN g_success
#         EXIT FOREACH
#      END IF   
#      LET l_flag = TRUE
#   END FOREACH 
#   IF NOT l_flag THEN
#      INITIALIZE g_errparam TO NULL
#      LET g_errparam.code = 'axc-00573'
#      LET g_errparam.extend = ""
#      LET g_errparam.popup = TRUE
#      CALL cl_err()
#  
#      LET g_success = 'N'
#      RETURN g_success   
#   END IF
#   RETURN g_success
#170105-00011#4---mark---e
END FUNCTION

################################################################################
# Descriptions...: 描述说明
# Memo...........:
# Usage..........: CALL s_aooi150_ins (传入参数)
#                  RETURNING 回传参数
# Input parameter: 传入参数变量1   传入参数变量说明1
#                : 传入参数变量2   传入参数变量说明2
# Return code....: 回传参数变量1   回传参数变量说明1
#                : 回传参数变量2   回传参数变量说明2
# Date & Author..: 日期 By 作者
# Modify.........:
################################################################################
PRIVATE FUNCTION axct701_01_ins_10_bak()
#170105-00011#1---mark---e
#DEFINE l_success       LIKE type_t.num5
#DEFINE l_errno         LIKE gzze_t.gzze001
##161109-00085#19-s mod
##DEFINE l_xcea          RECORD LIKE xcea_t.*   #161109-00085#19-s mark
#DEFINE l_xcea          RECORD  #工單發料成本憑證單頭檔
#       xceaent LIKE xcea_t.xceaent, #企業編號
#       xceacomp LIKE xcea_t.xceacomp, #法人組織
#       xceald LIKE xcea_t.xceald, #帳套
#       xceadocno LIKE xcea_t.xceadocno, #單據編號
#       xcea001 LIKE xcea_t.xcea001, #單據日期
#       xcea002 LIKE xcea_t.xcea002, #成本憑證類型
#       xcea003 LIKE xcea_t.xcea003, #成本計算類型
#       xcea004 LIKE xcea_t.xcea004, #年度
#       xcea005 LIKE xcea_t.xcea005, #期別
#       xcea006 LIKE xcea_t.xcea006, #帳務人員
#       xcea007 LIKE xcea_t.xcea007, #帳務部門
#       xcea101 LIKE xcea_t.xcea101, #憑證編號
#       xcea102 LIKE xcea_t.xcea102, #憑證日期
#       xceaownid LIKE xcea_t.xceaownid, #資料所有者
#       xceaowndp LIKE xcea_t.xceaowndp, #資料所屬部門
#       xceacrtid LIKE xcea_t.xceacrtid, #資料建立者
#       xceacrtdp LIKE xcea_t.xceacrtdp, #資料建立部門
#       xceacrtdt LIKE xcea_t.xceacrtdt, #資料創建日
#       xceamodid LIKE xcea_t.xceamodid, #資料修改者
#       xceamoddt LIKE xcea_t.xceamoddt, #最近修改日
#       xceacnfid LIKE xcea_t.xceacnfid, #資料確認者
#       xceacnfdt LIKE xcea_t.xceacnfdt, #資料確認日
#       xceapstid LIKE xcea_t.xceapstid, #資料過帳者
#       xceapstdt LIKE xcea_t.xceapstdt, #資料過帳日
#       xceastus LIKE xcea_t.xceastus, #狀態碼
#       #161109-00085#63 --s add
#       xceaud001 LIKE xcea_t.xceaud001, #自定義欄位(文字)001
#       xceaud002 LIKE xcea_t.xceaud002, #自定義欄位(文字)002
#       xceaud003 LIKE xcea_t.xceaud003, #自定義欄位(文字)003
#       xceaud004 LIKE xcea_t.xceaud004, #自定義欄位(文字)004
#       xceaud005 LIKE xcea_t.xceaud005, #自定義欄位(文字)005
#       xceaud006 LIKE xcea_t.xceaud006, #自定義欄位(文字)006
#       xceaud007 LIKE xcea_t.xceaud007, #自定義欄位(文字)007
#       xceaud008 LIKE xcea_t.xceaud008, #自定義欄位(文字)008
#       xceaud009 LIKE xcea_t.xceaud009, #自定義欄位(文字)009
#       xceaud010 LIKE xcea_t.xceaud010, #自定義欄位(文字)010
#       xceaud011 LIKE xcea_t.xceaud011, #自定義欄位(數字)011
#       xceaud012 LIKE xcea_t.xceaud012, #自定義欄位(數字)012
#       xceaud013 LIKE xcea_t.xceaud013, #自定義欄位(數字)013
#       xceaud014 LIKE xcea_t.xceaud014, #自定義欄位(數字)014
#       xceaud015 LIKE xcea_t.xceaud015, #自定義欄位(數字)015
#       xceaud016 LIKE xcea_t.xceaud016, #自定義欄位(數字)016
#       xceaud017 LIKE xcea_t.xceaud017, #自定義欄位(數字)017
#       xceaud018 LIKE xcea_t.xceaud018, #自定義欄位(數字)018
#       xceaud019 LIKE xcea_t.xceaud019, #自定義欄位(數字)019
#       xceaud020 LIKE xcea_t.xceaud020, #自定義欄位(數字)020
#       xceaud021 LIKE xcea_t.xceaud021, #自定義欄位(日期時間)021
#       xceaud022 LIKE xcea_t.xceaud022, #自定義欄位(日期時間)022
#       xceaud023 LIKE xcea_t.xceaud023, #自定義欄位(日期時間)023
#       xceaud024 LIKE xcea_t.xceaud024, #自定義欄位(日期時間)024
#       xceaud025 LIKE xcea_t.xceaud025, #自定義欄位(日期時間)025
#       xceaud026 LIKE xcea_t.xceaud026, #自定義欄位(日期時間)026
#       xceaud027 LIKE xcea_t.xceaud027, #自定義欄位(日期時間)027
#       xceaud028 LIKE xcea_t.xceaud028, #自定義欄位(日期時間)028
#       xceaud029 LIKE xcea_t.xceaud029, #自定義欄位(日期時間)029
#       xceaud030 LIKE xcea_t.xceaud030, #自定義欄位(日期時間)030
#       #161109-00085#63 --e add
#       xceasite LIKE xcea_t.xceasite  #營運據點
#          END RECORD
##161109-00085#19-e mod
##161109-00085#19-s mod
##DEFINE l_xceb          RECORD LIKE xceb_t.*   #161109-00085#19-s mark
#DEFINE l_xceb          RECORD  #成本憑證第一單身檔
#       xcebent LIKE xceb_t.xcebent, #企業編號
#       xcebcomp LIKE xceb_t.xcebcomp, #法人組織
#       xcebld LIKE xceb_t.xcebld, #帳套
#       xcebdocno LIKE xceb_t.xcebdocno, #單據編號
#       xcebseq LIKE xceb_t.xcebseq, #項次
#       xceb001 LIKE xceb_t.xceb001, #參考單據編號
#       xceb002 LIKE xceb_t.xceb002, #參考單據項次
#       xceb003 LIKE xceb_t.xceb003, #單據類型
#       xceb004 LIKE xceb_t.xceb004, #料件編號
#       xceb005 LIKE xceb_t.xceb005, #特性
#       xceb101 LIKE xceb_t.xceb101, #科目編號
#       xceb102 LIKE xceb_t.xceb102, #摘要
#       xceb103 LIKE xceb_t.xceb103, #成本域
#       xceb110 LIKE xceb_t.xceb110, #原因碼
#       xceb111 LIKE xceb_t.xceb111, #收付款客商
#       xceb112 LIKE xceb_t.xceb112, #客群
#       xceb113 LIKE xceb_t.xceb113, #區域
#       xceb114 LIKE xceb_t.xceb114, #成本中心
#       xceb115 LIKE xceb_t.xceb115, #經營類別
#       xceb116 LIKE xceb_t.xceb116, #通路
#       xceb117 LIKE xceb_t.xceb117, #品類
#       xceb118 LIKE xceb_t.xceb118, #品牌
#       xceb119 LIKE xceb_t.xceb119, #專案號
#       xceb120 LIKE xceb_t.xceb120, #WBS
#       xceb201 LIKE xceb_t.xceb201, #數量
#       xceb202 LIKE xceb_t.xceb202, #成本金額(本位幣一)
#       xceb202a LIKE xceb_t.xceb202a, #成本-材料(本位幣一)
#       xceb202b LIKE xceb_t.xceb202b, #成本-人工(本位幣一)
#       xceb202c LIKE xceb_t.xceb202c, #成本-加工(本位幣一)
#       xceb202d LIKE xceb_t.xceb202d, #成本-制費一(本位幣一)
#       xceb202e LIKE xceb_t.xceb202e, #成本-制費二(本位幣一)
#       xceb202f LIKE xceb_t.xceb202f, #成本-制費三(本位幣一)
#       xceb202g LIKE xceb_t.xceb202g, #成本-制費四(本位幣一)
#       xceb202h LIKE xceb_t.xceb202h, #成本-制費五(本位幣一)
#       xceb212 LIKE xceb_t.xceb212, #成本金額(本位幣二)
#       xceb212a LIKE xceb_t.xceb212a, #成本-材料(本位幣二)
#       xceb212b LIKE xceb_t.xceb212b, #成本-人工(本位幣二)
#       xceb212c LIKE xceb_t.xceb212c, #成本-加工(本位幣二)
#       xceb212d LIKE xceb_t.xceb212d, #成本-制費一(本位幣二)
#       xceb212e LIKE xceb_t.xceb212e, #成本-制費二(本位幣二)
#       xceb212f LIKE xceb_t.xceb212f, #成本-制費三(本位幣二)
#       xceb212g LIKE xceb_t.xceb212g, #成本-制費四(本位幣二)
#       xceb212h LIKE xceb_t.xceb212h, #成本-制費五(本位幣二)
#       xceb222 LIKE xceb_t.xceb222, #成本金額(本位幣三)
#       xceb222a LIKE xceb_t.xceb222a, #成本-材料(本位幣三)
#       xceb222b LIKE xceb_t.xceb222b, #成本-人工(本位幣三)
#       xceb222c LIKE xceb_t.xceb222c, #成本-加工(本位幣三)
#       xceb222d LIKE xceb_t.xceb222d, #成本-制費一(本位幣三)
#       xceb222e LIKE xceb_t.xceb222e, #成本-制費二(本位幣三)
#       xceb222f LIKE xceb_t.xceb222f, #成本-制費三(本位幣三)
#       xceb222g LIKE xceb_t.xceb222g, #成本-制費四(本位幣三)
#       xceb222h LIKE xceb_t.xceb222h, #成本-制費五(本位幣三)
#       xceb301 LIKE xceb_t.xceb301, #憑證編號
#       xceb302 LIKE xceb_t.xceb302, #憑證項次
#       #161109-00085#63 --s add  
#       xcebud001 LIKE xceb_t.xcebud001, #自定義欄位(文字)001
#       xcebud002 LIKE xceb_t.xcebud002, #自定義欄位(文字)002
#       xcebud003 LIKE xceb_t.xcebud003, #自定義欄位(文字)003
#       xcebud004 LIKE xceb_t.xcebud004, #自定義欄位(文字)004
#       xcebud005 LIKE xceb_t.xcebud005, #自定義欄位(文字)005
#       xcebud006 LIKE xceb_t.xcebud006, #自定義欄位(文字)006
#       xcebud007 LIKE xceb_t.xcebud007, #自定義欄位(文字)007
#       xcebud008 LIKE xceb_t.xcebud008, #自定義欄位(文字)008
#       xcebud009 LIKE xceb_t.xcebud009, #自定義欄位(文字)009
#       xcebud010 LIKE xceb_t.xcebud010, #自定義欄位(文字)010
#       xcebud011 LIKE xceb_t.xcebud011, #自定義欄位(數字)011
#       xcebud012 LIKE xceb_t.xcebud012, #自定義欄位(數字)012
#       xcebud013 LIKE xceb_t.xcebud013, #自定義欄位(數字)013
#       xcebud014 LIKE xceb_t.xcebud014, #自定義欄位(數字)014
#       xcebud015 LIKE xceb_t.xcebud015, #自定義欄位(數字)015
#       xcebud016 LIKE xceb_t.xcebud016, #自定義欄位(數字)016
#       xcebud017 LIKE xceb_t.xcebud017, #自定義欄位(數字)017
#       xcebud018 LIKE xceb_t.xcebud018, #自定義欄位(數字)018
#       xcebud019 LIKE xceb_t.xcebud019, #自定義欄位(數字)019
#       xcebud020 LIKE xceb_t.xcebud020, #自定義欄位(數字)020
#       xcebud021 LIKE xceb_t.xcebud021, #自定義欄位(日期時間)021
#       xcebud022 LIKE xceb_t.xcebud022, #自定義欄位(日期時間)022
#       xcebud023 LIKE xceb_t.xcebud023, #自定義欄位(日期時間)023
#       xcebud024 LIKE xceb_t.xcebud024, #自定義欄位(日期時間)024
#       xcebud025 LIKE xceb_t.xcebud025, #自定義欄位(日期時間)025
#       xcebud026 LIKE xceb_t.xcebud026, #自定義欄位(日期時間)026
#       xcebud027 LIKE xceb_t.xcebud027, #自定義欄位(日期時間)027
#       xcebud028 LIKE xceb_t.xcebud028, #自定義欄位(日期時間)028
#       xcebud029 LIKE xceb_t.xcebud029, #自定義欄位(日期時間)029
#       xcebud030 LIKE xceb_t.xcebud030, #自定義欄位(日期時間)030
#       #161109-00085#63 --e add
#       xceb107 LIKE xceb_t.xceb107, #人員
#       xceb108 LIKE xceb_t.xceb108, #部門
#       xceb109 LIKE xceb_t.xceb109, #帳款對象
#       xceb121 LIKE xceb_t.xceb121, #自由核算項1
#       xceb122 LIKE xceb_t.xceb122, #自由核算項2
#       xceb123 LIKE xceb_t.xceb123, #自由核算項3
#       xceb124 LIKE xceb_t.xceb124, #自由核算項4
#       xceb125 LIKE xceb_t.xceb125, #自由核算項5
#       xceb126 LIKE xceb_t.xceb126, #自由核算項6
#       xceb127 LIKE xceb_t.xceb127, #自由核算項7
#       xceb128 LIKE xceb_t.xceb128, #自由核算項8
#       xceb129 LIKE xceb_t.xceb129, #自由核算項9
#       xceb130 LIKE xceb_t.xceb130, #自由核算項10
#       xceb131 LIKE xceb_t.xceb131, #單據類型(for 流通)
#       xceb132 LIKE xceb_t.xceb132  #單據日期(for 流通)
#          END RECORD
##161109-00085#19-e mod
##161109-00085#19-s mod
##DEFINE l_xcec          RECORD LIKE xcec_t.*   #161109-00085#18-s mark
#DEFINE l_xcec          RECORD  #成本憑證第二單身檔
#       xcecent LIKE xcec_t.xcecent, #企業編號
#       xceccomp LIKE xcec_t.xceccomp, #法人組織
#       xcecld LIKE xcec_t.xcecld, #帳套
#       xcecdocno LIKE xcec_t.xcecdocno, #單據編號
#       xcecseq LIKE xcec_t.xcecseq, #項次
#       xcec001 LIKE xcec_t.xcec001, #參考單據
#       xcec002 LIKE xcec_t.xcec002, #參考單據項次
#       xcec003 LIKE xcec_t.xcec003, #單據類型
#       xcec004 LIKE xcec_t.xcec004, #料件編號
#       xcec005 LIKE xcec_t.xcec005, #特性
#       xcec101 LIKE xcec_t.xcec101, #科目編號
#       xcec102 LIKE xcec_t.xcec102, #摘要
#       xcec103 LIKE xcec_t.xcec103, #成本域
#       xcec110 LIKE xcec_t.xcec110, #原因碼
#       xcec111 LIKE xcec_t.xcec111, #收付款客商
#       xcec112 LIKE xcec_t.xcec112, #客群
#       xcec113 LIKE xcec_t.xcec113, #區域
#       xcec114 LIKE xcec_t.xcec114, #成本中心
#       xcec115 LIKE xcec_t.xcec115, #經營類別
#       xcec116 LIKE xcec_t.xcec116, #通路
#       xcec117 LIKE xcec_t.xcec117, #品類
#       xcec118 LIKE xcec_t.xcec118, #品牌
#       xcec119 LIKE xcec_t.xcec119, #專案號
#       xcec120 LIKE xcec_t.xcec120, #WBS
#       xcec201 LIKE xcec_t.xcec201, #數量
#       xcec202 LIKE xcec_t.xcec202, #成本金額(本位幣一)
#       xcec202a LIKE xcec_t.xcec202a, #成本-材料(本位幣一)
#       xcec202b LIKE xcec_t.xcec202b, #成本-人工(本位幣一)
#       xcec202c LIKE xcec_t.xcec202c, #成本-加工(本位幣一)
#       xcec202d LIKE xcec_t.xcec202d, #成本-制費一(本位幣一)
#       xcec202e LIKE xcec_t.xcec202e, #成本-制費二(本位幣一)
#       xcec202f LIKE xcec_t.xcec202f, #成本-制費三(本位幣一)
#       xcec202g LIKE xcec_t.xcec202g, #成本-制費四(本位幣一)
#       xcec202h LIKE xcec_t.xcec202h, #成本-制費五(本位幣一)
#       xcec212 LIKE xcec_t.xcec212, #成本-金額(本位幣二)
#       xcec212a LIKE xcec_t.xcec212a, #成本-材料(本位幣二)
#       xcec212b LIKE xcec_t.xcec212b, #成本-人工(本位幣二)
#       xcec212c LIKE xcec_t.xcec212c, #成本-加工(本位幣二)
#       xcec212d LIKE xcec_t.xcec212d, #成本-制費一(本位幣二)
#       xcec212e LIKE xcec_t.xcec212e, #成本-制費二(本位幣二)
#       xcec212f LIKE xcec_t.xcec212f, #成本-制費三(本位幣二)
#       xcec212g LIKE xcec_t.xcec212g, #成本-制費四(本位幣二)
#       xcec212h LIKE xcec_t.xcec212h, #成本-制費五(本位幣二)
#       xcec222 LIKE xcec_t.xcec222, #成本-金額(本位幣三)
#       xcec222a LIKE xcec_t.xcec222a, #成本-材料(本位幣三)
#       xcec222b LIKE xcec_t.xcec222b, #成本-人工(本位幣三)
#       xcec222c LIKE xcec_t.xcec222c, #成本-加工(本位幣三)
#       xcec222d LIKE xcec_t.xcec222d, #成本-制費一(本位幣三)
#       xcec222e LIKE xcec_t.xcec222e, #成本-制費二(本位幣三)
#       xcec222f LIKE xcec_t.xcec222f, #成本-制費三(本位幣三)
#       xcec222g LIKE xcec_t.xcec222g, #成本-制費四(本位幣三)
#       xcec222h LIKE xcec_t.xcec222h, #成本-制費五(本位幣三)
#       xcec301 LIKE xcec_t.xcec301, #憑證編號
#       xcec302 LIKE xcec_t.xcec302, #憑證項次
#       #161109-00085#63 --s add 
#       xcecud001 LIKE xcec_t.xcecud001, #自定義欄位(文字)001
#       xcecud002 LIKE xcec_t.xcecud002, #自定義欄位(文字)002
#       xcecud003 LIKE xcec_t.xcecud003, #自定義欄位(文字)003
#       xcecud004 LIKE xcec_t.xcecud004, #自定義欄位(文字)004
#       xcecud005 LIKE xcec_t.xcecud005, #自定義欄位(文字)005
#       xcecud006 LIKE xcec_t.xcecud006, #自定義欄位(文字)006
#       xcecud007 LIKE xcec_t.xcecud007, #自定義欄位(文字)007
#       xcecud008 LIKE xcec_t.xcecud008, #自定義欄位(文字)008
#       xcecud009 LIKE xcec_t.xcecud009, #自定義欄位(文字)009
#       xcecud010 LIKE xcec_t.xcecud010, #自定義欄位(文字)010
#       xcecud011 LIKE xcec_t.xcecud011, #自定義欄位(數字)011
#       xcecud012 LIKE xcec_t.xcecud012, #自定義欄位(數字)012
#       xcecud013 LIKE xcec_t.xcecud013, #自定義欄位(數字)013
#       xcecud014 LIKE xcec_t.xcecud014, #自定義欄位(數字)014
#       xcecud015 LIKE xcec_t.xcecud015, #自定義欄位(數字)015
#       xcecud016 LIKE xcec_t.xcecud016, #自定義欄位(數字)016
#       xcecud017 LIKE xcec_t.xcecud017, #自定義欄位(數字)017
#       xcecud018 LIKE xcec_t.xcecud018, #自定義欄位(數字)018
#       xcecud019 LIKE xcec_t.xcecud019, #自定義欄位(數字)019
#       xcecud020 LIKE xcec_t.xcecud020, #自定義欄位(數字)020
#       xcecud021 LIKE xcec_t.xcecud021, #自定義欄位(日期時間)021
#       xcecud022 LIKE xcec_t.xcecud022, #自定義欄位(日期時間)022
#       xcecud023 LIKE xcec_t.xcecud023, #自定義欄位(日期時間)023
#       xcecud024 LIKE xcec_t.xcecud024, #自定義欄位(日期時間)024
#       xcecud025 LIKE xcec_t.xcecud025, #自定義欄位(日期時間)025
#       xcecud026 LIKE xcec_t.xcecud026, #自定義欄位(日期時間)026
#       xcecud027 LIKE xcec_t.xcecud027, #自定義欄位(日期時間)027
#       xcecud028 LIKE xcec_t.xcecud028, #自定義欄位(日期時間)028
#       xcecud029 LIKE xcec_t.xcecud029, #自定義欄位(日期時間)029
#       xcecud030 LIKE xcec_t.xcecud030, #自定義欄位(日期時間)030
#       #161109-00085#63 --e add
#       xcec107 LIKE xcec_t.xcec107, #人員
#       xcec108 LIKE xcec_t.xcec108, #部門
#       xcec109 LIKE xcec_t.xcec109, #帳款對象
#       xcec121 LIKE xcec_t.xcec121, #自由核算項1
#       xcec122 LIKE xcec_t.xcec122, #自由核算項2
#       xcec123 LIKE xcec_t.xcec123, #自由核算項3
#       xcec124 LIKE xcec_t.xcec124, #自由核算項4
#       xcec125 LIKE xcec_t.xcec125, #自由核算項5
#       xcec126 LIKE xcec_t.xcec126, #自由核算項6
#       xcec127 LIKE xcec_t.xcec127, #自由核算項7
#       xcec128 LIKE xcec_t.xcec128, #自由核算項8
#       xcec129 LIKE xcec_t.xcec129, #自由核算項9
#       xcec130 LIKE xcec_t.xcec130  #自由核算項10
#               END RECORD
##161109-00085#19-e mod
##161109-00085#19-s mod
##DEFINE l_xccc          RECORD LIKE xccc_t.*   #161109-00085#19-s mark
#DEFINE l_xccc          RECORD  #料件庫存成本期異動統計檔
#       xcccent LIKE xccc_t.xcccent, #企業編號
#       xccccomp LIKE xccc_t.xccccomp, #法人組織
#       xcccld LIKE xccc_t.xcccld, #帳套
#       xccc001 LIKE xccc_t.xccc001, #帳套本位幣順序
#       xccc002 LIKE xccc_t.xccc002, #成本域
#       xccc003 LIKE xccc_t.xccc003, #成本計算類型
#       xccc004 LIKE xccc_t.xccc004, #年度
#       xccc005 LIKE xccc_t.xccc005, #期別
#       xccc006 LIKE xccc_t.xccc006, #料號
#       xccc007 LIKE xccc_t.xccc007, #產品特徵
#       xccc008 LIKE xccc_t.xccc008, #批號
#       xccc010 LIKE xccc_t.xccc010, #核算幣別
#       xccc101 LIKE xccc_t.xccc101, #上期結存數量
#       xccc102 LIKE xccc_t.xccc102, #上期結存金額
#       xccc102a LIKE xccc_t.xccc102a, #上期結存金額-材料
#       xccc102b LIKE xccc_t.xccc102b, #上期結存金額-人工
#       xccc102c LIKE xccc_t.xccc102c, #上期結存金額-加工
#       xccc102d LIKE xccc_t.xccc102d, #上期結存金額-製費一
#       xccc102e LIKE xccc_t.xccc102e, #上期結存金額-製費二
#       xccc102f LIKE xccc_t.xccc102f, #上期結存金額-製費三
#       xccc102g LIKE xccc_t.xccc102g, #上期結存金額-製費四
#       xccc102h LIKE xccc_t.xccc102h, #上期結存金額-製費五
#       xccc201 LIKE xccc_t.xccc201, #本期採購入庫數量
#       xccc202 LIKE xccc_t.xccc202, #本期採購入庫金額
#       xccc202a LIKE xccc_t.xccc202a, #本期採購入庫金額-材料
#       xccc202b LIKE xccc_t.xccc202b, #本期採購入庫金額-人工
#       xccc202c LIKE xccc_t.xccc202c, #本期採購入庫金額-加工
#       xccc202d LIKE xccc_t.xccc202d, #本期採購入庫金額-製費一
#       xccc202e LIKE xccc_t.xccc202e, #本期採購入庫金額-製費二
#       xccc202f LIKE xccc_t.xccc202f, #本期採購入庫金額-製費三
#       xccc202g LIKE xccc_t.xccc202g, #本期採購入庫金額-製費四
#       xccc202h LIKE xccc_t.xccc202h, #本期採購入庫金額-製費五
#       xccc203 LIKE xccc_t.xccc203, #本期委外入庫數量
#       xccc204 LIKE xccc_t.xccc204, #本期委外入庫金額
#       xccc204a LIKE xccc_t.xccc204a, #本期委外入庫金額-材料
#       xccc204b LIKE xccc_t.xccc204b, #本期委外入庫金額-人工
#       xccc204c LIKE xccc_t.xccc204c, #本期委外入庫金額-加工
#       xccc204d LIKE xccc_t.xccc204d, #本期委外入庫金額-製費一
#       xccc204e LIKE xccc_t.xccc204e, #本期委外入庫金額-製費二
#       xccc204f LIKE xccc_t.xccc204f, #本期委外入庫金額-製費三
#       xccc204g LIKE xccc_t.xccc204g, #本期委外入庫金額-製費四
#       xccc204h LIKE xccc_t.xccc204h, #本期委外入庫金額-製費五
#       xccc205 LIKE xccc_t.xccc205, #本期工單入庫數量
#       xccc206 LIKE xccc_t.xccc206, #本期工單入庫金額
#       xccc206a LIKE xccc_t.xccc206a, #本期工單入庫金額-材料
#       xccc206b LIKE xccc_t.xccc206b, #本期工單入庫金額-人工
#       xccc206c LIKE xccc_t.xccc206c, #本期工單入庫金額-加工
#       xccc206d LIKE xccc_t.xccc206d, #本期工單入庫金額-製費一
#       xccc206e LIKE xccc_t.xccc206e, #本期工單入庫金額-製費二
#       xccc206f LIKE xccc_t.xccc206f, #本期工單入庫金額-製費三
#       xccc206g LIKE xccc_t.xccc206g, #本期工單入庫金額-製費四
#       xccc206h LIKE xccc_t.xccc206h, #本期工單入庫金額-製費五
#       xccc207 LIKE xccc_t.xccc207, #本期重工領出數量
#       xccc208 LIKE xccc_t.xccc208, #本期重工領出金額
#       xccc208a LIKE xccc_t.xccc208a, #本期重工領出金額-材料
#       xccc208b LIKE xccc_t.xccc208b, #本期重工領出金額-人工
#       xccc208c LIKE xccc_t.xccc208c, #本期重工領出金額-加工
#       xccc208d LIKE xccc_t.xccc208d, #本期重工領出金額-製費一
#       xccc208e LIKE xccc_t.xccc208e, #本期重工領出金額-製費二
#       xccc208f LIKE xccc_t.xccc208f, #本期重工領出金額-製費三
#       xccc208g LIKE xccc_t.xccc208g, #本期重工領出金額-製費四
#       xccc208h LIKE xccc_t.xccc208h, #本期重工領出金額-製費五
#       xccc209 LIKE xccc_t.xccc209, #本期重工入庫數量
#       xccc210 LIKE xccc_t.xccc210, #本期重工入庫金額
#       xccc210a LIKE xccc_t.xccc210a, #本期重工入庫金額-材料
#       xccc210b LIKE xccc_t.xccc210b, #本期重工入庫金額-人工
#       xccc210c LIKE xccc_t.xccc210c, #本期重工入庫金額-加工
#       xccc210d LIKE xccc_t.xccc210d, #本期重工入庫金額-製費一
#       xccc210e LIKE xccc_t.xccc210e, #本期重工入庫金額-製費二
#       xccc210f LIKE xccc_t.xccc210f, #本期重工入庫金額-製費三
#       xccc210g LIKE xccc_t.xccc210g, #本期重工入庫金額-製費四
#       xccc210h LIKE xccc_t.xccc210h, #本期重工入庫金額-製費五
#       xccc211 LIKE xccc_t.xccc211, #本期雜項入庫數量
#       xccc212 LIKE xccc_t.xccc212, #本期雜項入庫金額
#       xccc212a LIKE xccc_t.xccc212a, #本期雜項入庫金額-材料
#       xccc212b LIKE xccc_t.xccc212b, #本期雜項入庫金額-人工
#       xccc212c LIKE xccc_t.xccc212c, #本期雜項入庫金額-加工
#       xccc212d LIKE xccc_t.xccc212d, #本期雜項入庫金額-製費一
#       xccc212e LIKE xccc_t.xccc212e, #本期雜項入庫金額-製費二
#       xccc212f LIKE xccc_t.xccc212f, #本期雜項入庫金額-製費三
#       xccc212g LIKE xccc_t.xccc212g, #本期雜項入庫金額-製費四
#       xccc212h LIKE xccc_t.xccc212h, #本期雜項入庫金額-製費五
#       xccc213 LIKE xccc_t.xccc213, #本期調整入庫數量
#       xccc214 LIKE xccc_t.xccc214, #本期調整入庫金額
#       xccc214a LIKE xccc_t.xccc214a, #本期調整入庫金額-材料
#       xccc214b LIKE xccc_t.xccc214b, #本期調整入庫金額-人工
#       xccc214c LIKE xccc_t.xccc214c, #本期調整入庫金額-加工
#       xccc214d LIKE xccc_t.xccc214d, #本期調整入庫金額-製費一
#       xccc214e LIKE xccc_t.xccc214e, #本期調整入庫金額-製費二
#       xccc214f LIKE xccc_t.xccc214f, #本期調整入庫金額-製費三
#       xccc214g LIKE xccc_t.xccc214g, #本期調整入庫金額-製費四
#       xccc214h LIKE xccc_t.xccc214h, #本期調整入庫金額-製費五
#       xccc215 LIKE xccc_t.xccc215, #本期銷退入庫數量
#       xccc216 LIKE xccc_t.xccc216, #本期銷退入庫金額
#       xccc216a LIKE xccc_t.xccc216a, #本期銷退入庫金額-材料
#       xccc216b LIKE xccc_t.xccc216b, #本期銷退入庫金額-人工
#       xccc216c LIKE xccc_t.xccc216c, #本期銷退入庫金額-加工
#       xccc216d LIKE xccc_t.xccc216d, #本期銷退入庫金額-製費一
#       xccc216e LIKE xccc_t.xccc216e, #本期銷退入庫金額-製費二
#       xccc216f LIKE xccc_t.xccc216f, #本期銷退入庫金額-製費三
#       xccc216g LIKE xccc_t.xccc216g, #本期銷退入庫金額-製費四
#       xccc216h LIKE xccc_t.xccc216h, #本期銷退入庫金額-製費五
#       xccc217 LIKE xccc_t.xccc217, #本期調撥入庫數量
#       xccc218 LIKE xccc_t.xccc218, #本期調撥入庫金額
#       xccc218a LIKE xccc_t.xccc218a, #本期調撥入庫金額-材料
#       xccc218b LIKE xccc_t.xccc218b, #本期調撥入庫金額-人工
#       xccc218c LIKE xccc_t.xccc218c, #本期調撥入庫金額-加工
#       xccc218d LIKE xccc_t.xccc218d, #本期調撥入庫金額-製費一
#       xccc218e LIKE xccc_t.xccc218e, #本期調撥入庫金額-製費二
#       xccc218f LIKE xccc_t.xccc218f, #本期調撥入庫金額-製費三
#       xccc218g LIKE xccc_t.xccc218g, #本期調撥入庫金額-製費四
#       xccc218h LIKE xccc_t.xccc218h, #本期調撥入庫金額-製費五
#       xccc280 LIKE xccc_t.xccc280, #本期平均單價
#       xccc280a LIKE xccc_t.xccc280a, #本期平均單價-材料
#       xccc280b LIKE xccc_t.xccc280b, #本期平均單價-人工
#       xccc280c LIKE xccc_t.xccc280c, #本期平均單價-加工
#       xccc280d LIKE xccc_t.xccc280d, #本期平均單價-製費一
#       xccc280e LIKE xccc_t.xccc280e, #本期平均單價-製費二
#       xccc280f LIKE xccc_t.xccc280f, #本期平均單價-製費三
#       xccc280g LIKE xccc_t.xccc280g, #本期平均單價-製費四
#       xccc280h LIKE xccc_t.xccc280h, #本期平均單價-製費五
#       xccc301 LIKE xccc_t.xccc301, #本期工單領用數量
#       xccc302 LIKE xccc_t.xccc302, #本期工單領用金額
#       xccc302a LIKE xccc_t.xccc302a, #本期工單領用金額-材料
#       xccc302b LIKE xccc_t.xccc302b, #本期工單領用金額-人工
#       xccc302c LIKE xccc_t.xccc302c, #本期工單領用金額-加工
#       xccc302d LIKE xccc_t.xccc302d, #本期工單領用金額-製費一
#       xccc302e LIKE xccc_t.xccc302e, #本期工單領用金額-製費二
#       xccc302f LIKE xccc_t.xccc302f, #本期工單領用金額-製費三
#       xccc302g LIKE xccc_t.xccc302g, #本期工單領用金額-製費四
#       xccc302h LIKE xccc_t.xccc302h, #本期工單領用金額-製費五
#       xccc303 LIKE xccc_t.xccc303, #本期銷貨數量
#       xccc304 LIKE xccc_t.xccc304, #本期銷貨成本
#       xccc304a LIKE xccc_t.xccc304a, #本期銷貨成本-材料
#       xccc304b LIKE xccc_t.xccc304b, #本期銷貨成本-人工
#       xccc304c LIKE xccc_t.xccc304c, #本期銷貨成本-加工
#       xccc304d LIKE xccc_t.xccc304d, #本期銷貨成本-製費一
#       xccc304e LIKE xccc_t.xccc304e, #本期銷貨成本-製費二
#       xccc304f LIKE xccc_t.xccc304f, #本期銷貨成本-製費三
#       xccc304g LIKE xccc_t.xccc304g, #本期銷貨成本-製費四
#       xccc304h LIKE xccc_t.xccc304h, #本期銷貨成本-製費五
#       xccc305 LIKE xccc_t.xccc305, #本期銷退數量
#       xccc306 LIKE xccc_t.xccc306, #本期銷退成本
#       xccc306a LIKE xccc_t.xccc306a, #本期銷退成本-材料
#       xccc306b LIKE xccc_t.xccc306b, #本期銷退成本-人工
#       xccc306c LIKE xccc_t.xccc306c, #本期銷退成本-加工
#       xccc306d LIKE xccc_t.xccc306d, #本期銷退成本-製費一
#       xccc306e LIKE xccc_t.xccc306e, #本期銷退成本-製費二
#       xccc306f LIKE xccc_t.xccc306f, #本期銷退成本-製費三
#       xccc306g LIKE xccc_t.xccc306g, #本期銷退成本-製費四
#       xccc306h LIKE xccc_t.xccc306h, #本期銷退成本-製費五
#       xccc307 LIKE xccc_t.xccc307, #本期銷售費用數量
#       xccc308 LIKE xccc_t.xccc308, #本期銷售費用成本
#       xccc308a LIKE xccc_t.xccc308a, #本期銷售費用成本-材料
#       xccc308b LIKE xccc_t.xccc308b, #本期銷售費用成本-人工
#       xccc308c LIKE xccc_t.xccc308c, #本期銷售費用成本-加工
#       xccc308d LIKE xccc_t.xccc308d, #本期銷售費用成本-製費一
#       xccc308e LIKE xccc_t.xccc308e, #本期銷售費用成本-製費二
#       xccc308f LIKE xccc_t.xccc308f, #本期銷售費用成本-製費三
#       xccc308g LIKE xccc_t.xccc308g, #本期銷售費用成本-製費四
#       xccc308h LIKE xccc_t.xccc308h, #本期銷售費用成本-製費五
#       xccc309 LIKE xccc_t.xccc309, #本期雜發數量
#       xccc310 LIKE xccc_t.xccc310, #本期雜發金額
#       xccc310a LIKE xccc_t.xccc310a, #本期雜發金額-材料
#       xccc310b LIKE xccc_t.xccc310b, #本期雜發金額-人工
#       xccc310c LIKE xccc_t.xccc310c, #本期雜發金額-加工
#       xccc310d LIKE xccc_t.xccc310d, #本期雜發金額-製費一
#       xccc310e LIKE xccc_t.xccc310e, #本期雜發金額-製費二
#       xccc310f LIKE xccc_t.xccc310f, #本期雜發金額-製費三
#       xccc310g LIKE xccc_t.xccc310g, #本期雜發金額-製費四
#       xccc310h LIKE xccc_t.xccc310h, #本期雜發金額-製費五
#       xccc311 LIKE xccc_t.xccc311, #本期盤盈虧數量
#       xccc312 LIKE xccc_t.xccc312, #本期盤盈虧金額
#       xccc312a LIKE xccc_t.xccc312a, #本期盤盈虧金額-材料
#       xccc312b LIKE xccc_t.xccc312b, #本期盤盈虧金額-人工
#       xccc312c LIKE xccc_t.xccc312c, #本期盤盈虧金額-加工
#       xccc312d LIKE xccc_t.xccc312d, #本期盤盈虧金額-製費一
#       xccc312e LIKE xccc_t.xccc312e, #本期盤盈虧金額-製費二
#       xccc312f LIKE xccc_t.xccc312f, #本期盤盈虧金額-製費三
#       xccc312g LIKE xccc_t.xccc312g, #本期盤盈虧金額-製費四
#       xccc312h LIKE xccc_t.xccc312h, #本期盤盈虧金額-製費五
#       xccc313 LIKE xccc_t.xccc313, #本期調撥出庫數量
#       xccc314 LIKE xccc_t.xccc314, #本期調撥出庫金額
#       xccc314a LIKE xccc_t.xccc314a, #本期調撥出庫金額-材料
#       xccc314b LIKE xccc_t.xccc314b, #本期調撥出庫金額-人工
#       xccc314c LIKE xccc_t.xccc314c, #本期調撥出庫金額-加工
#       xccc314d LIKE xccc_t.xccc314d, #本期調撥出庫金額-製費一
#       xccc314e LIKE xccc_t.xccc314e, #本期調撥出庫金額-製費二
#       xccc314f LIKE xccc_t.xccc314f, #本期調撥出庫金額-製費三
#       xccc314g LIKE xccc_t.xccc314g, #本期調撥出庫金額-製費四
#       xccc314h LIKE xccc_t.xccc314h, #本期調撥出庫金額-製費五
#       xccc401 LIKE xccc_t.xccc401, #本期銷貨收入金額
#       xccc402 LIKE xccc_t.xccc402, #本期銷退金額
#       xccc901 LIKE xccc_t.xccc901, #期末結存數量
#       xccc902 LIKE xccc_t.xccc902, #期末結存金額
#       xccc902a LIKE xccc_t.xccc902a, #期末結存金額-材料
#       xccc902b LIKE xccc_t.xccc902b, #期末結存金額-人工
#       xccc902c LIKE xccc_t.xccc902c, #期末結存金額-加工
#       xccc902d LIKE xccc_t.xccc902d, #期末結存金額-製費一
#       xccc902e LIKE xccc_t.xccc902e, #期末結存金額-製費二
#       xccc902f LIKE xccc_t.xccc902f, #期末結存金額-製費三
#       xccc902g LIKE xccc_t.xccc902g, #期末結存金額-製費四
#       xccc902h LIKE xccc_t.xccc902h, #期末結存金額-製費五
#       xccc903 LIKE xccc_t.xccc903, #期末結存調整金額
#       xccc903a LIKE xccc_t.xccc903a, #期末結存調整金額-材料
#       xccc903b LIKE xccc_t.xccc903b, #期末結存調整金額-人工
#       xccc903c LIKE xccc_t.xccc903c, #期末結存調整金額-加工
#       xccc903d LIKE xccc_t.xccc903d, #期末結存調整金額-製費一
#       xccc903e LIKE xccc_t.xccc903e, #期末結存調整金額-製費二
#       xccc903f LIKE xccc_t.xccc903f, #期末結存調整金額-製費三
#       xccc903g LIKE xccc_t.xccc903g, #期末結存調整金額-製費四
#       xccc903h LIKE xccc_t.xccc903h, #期末結存調整金額-製費五
#       xccctime LIKE xccc_t.xccctime  #最近成本計算時間
#          END RECORD
##161109-00085#19-e mod
#DEFINE l_sql           STRING
#DEFINE l_sql1          STRING
#DEFINE l_rate          LIKE type_t.num26_10
#DEFINE l_rate1         LIKE type_t.num26_10
#DEFINE ld_date         DATETIME YEAR TO SECOND
#
#   LET g_success = 'Y'
#   LET l_xcea.xceaownid = g_user
#   LET l_xcea.xceaowndp = g_dept
#   LET l_xcea.xceacrtid = g_user
#   LET l_xcea.xceacrtdp = g_dept 
#   LET ld_date = cl_get_current()
#   LET l_xcea.xceamodid = ""
#   LET l_xcea.xceamoddt = ""
#   CALL s_aooi200_fin_gen_docno(g_xcea_m.xceald,'','',g_xcea_m.xceadocno,g_xcea_m.xcea001,g_prog_name1)      #wujie 150214
#    RETURNING l_success,g_xcea_m.xceadocno
#   IF l_success  = 0  THEN
#      INITIALIZE g_errparam TO NULL
#      LET g_errparam.code = 'apm-00003'
#      LET g_errparam.extend = g_xcea_m.xceadocno
#      LET g_errparam.popup = TRUE
#      CALL cl_err()
#      LET g_success = 'N'
#      RETURN g_success
#   END IF
#   
#   INSERT INTO xcea_t (xceaent,xceald,xceacomp,xcea006,xceadocno,xcea001,xcea002,xcea004, 
#       xcea005,xcea003,xceastus,xceaownid,xceaowndp,xceacrtid,xceacrtdp,xceacrtdt, 
#       xceamodid,xceamoddt)
#   VALUES (g_enterprise,g_xcea_m.xceald,g_xcea_m.xceacomp,g_xcea_m.xcea006,g_xcea_m.xceadocno, 
#       g_xcea_m.xcea001,g_xcea002,g_xcea_m.xcea004,g_xcea_m.xcea005,g_xcea_m.xcea003, 
#       'N',l_xcea.xceaownid,l_xcea.xceaowndp,l_xcea.xceacrtid, 
#       l_xcea.xceacrtdp,ld_date,l_xcea.xceamodid,l_xcea.xceamoddt) 
#       
#   IF SQLCA.sqlcode THEN
#      INITIALIZE g_errparam TO NULL
#      LET g_errparam.code = SQLCA.sqlcode
#      LET g_errparam.extend = "g_xcea_m"
#      LET g_errparam.popup = TRUE
#      CALL cl_err()
#      LET g_success = 'N'
#      RETURN g_success
#   END IF
#   
#   LET l_sql = " SELECT SUM(xccc202), ",
#               "        SUM(xccc202a),SUM(xccc202b),SUM(xccc202c),SUM(xccc202d),",
#               "        SUM(xccc202e),SUM(xccc202f),SUM(xccc202g),SUM(xccc202h) ",
#               "        FROM xccc_t ", 
#               "  WHERE xcccent = '",g_enterprise,"' AND xcccld = '",g_xcea_m.xceald,"'",
#               "    AND xccc003 = '",g_xcea_m.xcea003,"' AND xccc004 = ",g_xcea_m.xcea004,
#               "    AND xccc005 = ",g_xcea_m.xcea005,
#               "    AND xccc002 = ? AND xccc008 = ? AND xccc006 = ?",
#               "    AND xccc903 <> 0 ",
#               "    AND xccc007 = ? " 
#   
#   LET g_sql = l_sql CLIPPED," AND xccc001 = '2' " 
#   DECLARE xcae_prep8 CURSOR FROM g_sql
#   
#   LET g_sql = l_sql CLIPPED," AND xccc001 = '3' " 
#   DECLARE xcae_prep9 CURSOR FROM g_sql
#   
#   LET l_sql = " SELECT xccc002,xccc008,xccc006,xccc007,SUM(xccc903), ",
#               "        SUM(xccc903a),SUM(xccc903b),SUM(xccc903c),SUM(xccc903d),",
#               "        SUM(xccc903e),SUM(xccc903f),SUM(xccc903g),SUM(xccc903h) ",
#               "        FROM xccc_t ", 
#               "  WHERE xcccent = '",g_enterprise,"' AND xcccld = '",g_xcea_m.xceald,"'",
#               "    AND xccc003 = '",g_xcea_m.xcea003,"' AND xccc004 = ",g_xcea_m.xcea004,
#               "    AND xccc903 <> 0 ",
#               "    AND xccc005 = ",g_xcea_m.xcea005
#   LET l_sql1 = l_sql CLIPPED," AND xccc001 = '1' ",
#                " GROUP BY xccc002,xccc008,xccc006,xccc007",
#                " ORDER BY xccc002,xccc008,xccc006,xccc007"
#   PREPARE xcae_prep7 FROM l_sql1
#   DECLARE xcae_curs7 CURSOR FOR xcae_prep7
#   
#   FOREACH xcae_curs7 INTO  l_xccc.xccc002,l_xccc.xccc008,l_xccc.xccc006,l_xccc.xccc007,
#                            l_xccc.xccc903,l_xccc.xccc903a,l_xccc.xccc903b,l_xccc.xccc903c,
#                            l_xccc.xccc903d,l_xccc.xccc903e,l_xccc.xccc903f,l_xccc.xccc903g,l_xccc.xccc903h      
#      
#      IF g_glaa015 ='Y' THEN      
#         OPEN xcae_prep8 USING  l_xccc.xccc002,l_xccc.xccc008,l_xccc.xccc006,l_xccc.xccc007
#         FETCH xcae_prep8 INTO l_xceb.xceb212,l_xceb.xceb212a,l_xceb.xceb212b,l_xceb.xceb212c,l_xceb.xceb212d,
#                               l_xceb.xceb212e,l_xceb.xceb212f,l_xceb.xceb212g,l_xceb.xceb212h
#         #資料被他人LOCK, 或是sql執行時出現錯誤
#         IF SQLCA.sqlcode THEN
#            INITIALIZE g_errparam TO NULL
#            LET g_errparam.code = SQLCA.sqlcode
#            LET g_errparam.extend = g_xcea_m.xceald
#            LET g_errparam.popup = FALSE
#            CALL cl_err()
#         
#            CLOSE xcae_prep8
#            CALL s_transaction_end('N','0')
#            RETURN
#         END IF
#      ELSE
#         LET l_xceb.xceb212a = 0
#         LET l_xceb.xceb212b = 0
#         LET l_xceb.xceb212c = 0
#         LET l_xceb.xceb212d = 0
#         LET l_xceb.xceb212e = 0
#         LET l_xceb.xceb212f = 0
#         LET l_xceb.xceb212g = 0
#         LET l_xceb.xceb212h = 0
#         LET l_xceb.xceb212  = 0     
#      END IF
#      
#      IF g_glaa019 ='Y' THEN
#         OPEN xcae_prep9 USING  l_xccc.xccc002,l_xccc.xccc008,l_xccc.xccc006,l_xccc.xccc007
#         FETCH xcae_prep9 INTO l_xceb.xceb222,l_xceb.xceb222a,l_xceb.xceb222b,l_xceb.xceb222c,l_xceb.xceb222d,
#                               l_xceb.xceb222e,l_xceb.xceb222f,l_xceb.xceb222g,l_xceb.xceb222h
#         #資料被他人LOCK, 或是sql執行時出現錯誤
#         IF SQLCA.sqlcode THEN
#            INITIALIZE g_errparam TO NULL
#            LET g_errparam.code = SQLCA.sqlcode
#            LET g_errparam.extend = g_xcea_m.xceald
#            LET g_errparam.popup = FALSE
#            CALL cl_err()
#         
#            CLOSE xcae_prep9
#            CALL s_transaction_end('N','0')
#            RETURN
#         END IF
#      ELSE
#         LET l_xceb.xceb222a = 0
#         LET l_xceb.xceb222b = 0
#         LET l_xceb.xceb222c = 0
#         LET l_xceb.xceb222d = 0
#         LET l_xceb.xceb222e = 0
#         LET l_xceb.xceb222f = 0
#         LET l_xceb.xceb222g = 0
#         LET l_xceb.xceb222h = 0
#         LET l_xceb.xceb222  = 0     
#      END IF
#       
#      SELECT MAX(xcebseq) INTO l_xceb.xcebseq FROM xceb_t
#       WHERE xcebent = g_enterprise AND xcebld = g_xcea_m.xceald
#         AND xcebdocno = g_xcea_m.xceadocno
#      IF cl_null(l_xceb.xcebseq) OR l_xceb.xcebseq = 0 THEN
#         LET l_xceb.xcebseq = 1
#      ELSE
#         LET l_xceb.xcebseq = l_xceb.xcebseq + 1
#      END IF 
#      
#      LET l_xceb.xcebent  = g_enterprise
#      LET l_xceb.xcebld   = g_xcea_m.xceald
#      LET l_xceb.xcebdocno= g_xcea_m.xceadocno
#      LET l_xceb.xcebcomp = g_xcea_m.xceacomp
#      LET l_xceb.xceb001  = ''
#      LET l_xceb.xceb002  = ''
#      LET l_xceb.xceb003  = ''
#      LET l_xceb.xceb004  = l_xccc.xccc006
#      LET l_xceb.xceb005  = l_xccc.xccc007
#      LET l_xceb.xceb102  = ''
#      LET l_xceb.xceb103  = l_xccc.xccc002
#      LET l_xceb.xceb201  = 0
#      LET l_xceb.xceb202  = l_xccc.xccc903
#      LET l_xceb.xceb202a = l_xccc.xccc903a
#      LET l_xceb.xceb202b = l_xccc.xccc903b
#      LET l_xceb.xceb202c = l_xccc.xccc903c
#      LET l_xceb.xceb202d = l_xccc.xccc903d
#      LET l_xceb.xceb202e = l_xccc.xccc903e
#      LET l_xceb.xceb202f = l_xccc.xccc903f
#      LET l_xceb.xceb202g = l_xccc.xccc903g
#      LET l_xceb.xceb202h = l_xccc.xccc903h
#       
#      SELECT imag011 INTO l_xceb.xceb117 FROM imag_t
#       WHERE imagent = g_enterprise AND imagsite = g_xcea_m.xceacomp
#         AND imag001 = l_xceb.xceb004
#
#     LET l_xceb.xceb101 = ''
#      #存貨科目
#      CALL s_get_item_acc(g_xcea_m.xceald,'1',l_xceb.xceb004,'','',g_xcea_m.xceacomp,'') 
#        RETURNING l_success,l_xceb.xceb101 
#
#      #人员
#      LET l_xceb.xceb107 = ' '
#      #部门
#      LET l_xceb.xceb108 = ' '
#      #账款对象
#      LET l_xceb.xceb109 = ' '
#      #自由核算项1～10  
#      LET l_xceb.xceb121 = ' '
#      LET l_xceb.xceb122 = ' '
#      LET l_xceb.xceb123 = ' '
#      LET l_xceb.xceb124 = ' '
#      LET l_xceb.xceb125 = ' '
#      LET l_xceb.xceb126 = ' '
#      LET l_xceb.xceb127 = ' '
#      LET l_xceb.xceb128 = ' '
#      LET l_xceb.xceb129 = ' '
#      LET l_xceb.xceb130 = ' '
#      #摘要
#      IF cl_null(l_xceb.xceb102) THEN
#         CALL axct701_01_get_summ(g_xcea_m.xceald,'61','8925','10') RETURNING l_success,l_xceb.xceb102
#      END IF
#      CALL axct701_01_default_space_xceb(l_xceb.*) RETURNING l_xceb.xceb005,
#                                                             l_xceb.xceb101,
#                                                             l_xceb.xceb102,
#                                                             l_xceb.xceb103,
#                                                             l_xceb.xceb110,
#                                                             l_xceb.xceb111,
#                                                             l_xceb.xceb112,
#                                                             l_xceb.xceb113,
#                                                             l_xceb.xceb114,
#                                                             l_xceb.xceb115,
#                                                             l_xceb.xceb116,
#                                                             l_xceb.xceb117,
#                                                             l_xceb.xceb118,
#                                                             l_xceb.xceb119,
#                                                             l_xceb.xceb120,
#                                                             l_xceb.xceb107,
#                                                             l_xceb.xceb108,
#                                                             l_xceb.xceb109,
#                                                             l_xceb.xceb121,
#                                                             l_xceb.xceb122,
#                                                             l_xceb.xceb123,
#                                                             l_xceb.xceb124,
#                                                             l_xceb.xceb125,
#                                                             l_xceb.xceb126,
#                                                             l_xceb.xceb127,
#                                                             l_xceb.xceb128,
#                                                             l_xceb.xceb129,
#                                                             l_xceb.xceb130
#
##如果金额和数量都为0的话，则不产生此笔单身数据                                                             
#      IF l_xceb.xceb201= 0 AND l_xceb.xceb202 = 0 THEN
#         CONTINUE FOREACH
#      END IF
#     #161109-00085#20-s mod
##      INSERT INTO xceb_t VALUES(l_xceb.*)   #161109-00085#20-s mark
#      #161109-00085#63 --s mark
#      #INSERT INTO xceb_t(xcebent,xcebcomp,xcebld,xcebdocno,xcebseq,xceb001,xceb002,xceb003,xceb004,
#      #                   xceb005,xceb101,xceb102,xceb103,xceb110,xceb111,xceb112,xceb113,xceb114,xceb115,
#      #                   xceb116,xceb117,xceb118,xceb119,xceb120,xceb201,xceb202,xceb202a,xceb202b,xceb202c,
#      #                   xceb202d,xceb202e,xceb202f,xceb202g,xceb202h,xceb212,xceb212a,xceb212b,xceb212c,
#      #                   xceb212d,xceb212e,xceb212f,xceb212g,xceb212h,xceb222,xceb222a,xceb222b,xceb222c,
#      #                   xceb222d,xceb222e,xceb222f,xceb222g,xceb222h,xceb301,xceb302,xceb107,xceb108,xceb109,
#      #                   xceb121,xceb122,xceb123,xceb124,xceb125,xceb126,xceb127,xceb128,xceb129,xceb130,xceb131,xceb132) 
#      #            VALUES(l_xceb.xcebent,l_xceb.xcebcomp,l_xceb.xcebld,l_xceb.xcebdocno,l_xceb.xcebseq,
#      #                   l_xceb.xceb001,l_xceb.xceb002,l_xceb.xceb003,l_xceb.xceb004,l_xceb.xceb005,
#      #                   l_xceb.xceb101,l_xceb.xceb102,l_xceb.xceb103,l_xceb.xceb110,l_xceb.xceb111,
#      #                   l_xceb.xceb112,l_xceb.xceb113,l_xceb.xceb114,l_xceb.xceb115,l_xceb.xceb116,
#      #                   l_xceb.xceb117,l_xceb.xceb118,l_xceb.xceb119,l_xceb.xceb120,l_xceb.xceb201,
#      #                   l_xceb.xceb202,l_xceb.xceb202a,l_xceb.xceb202b,l_xceb.xceb202c,l_xceb.xceb202d,
#      #                   l_xceb.xceb202e,l_xceb.xceb202f,l_xceb.xceb202g,l_xceb.xceb202h,l_xceb.xceb212,
#      #                   l_xceb.xceb212a,l_xceb.xceb212b,l_xceb.xceb212c,l_xceb.xceb212d,l_xceb.xceb212e,
#      #                   l_xceb.xceb212f,l_xceb.xceb212g,l_xceb.xceb212h,l_xceb.xceb222,l_xceb.xceb222a,
#      #                   l_xceb.xceb222b,l_xceb.xceb222c,l_xceb.xceb222d,l_xceb.xceb222e,l_xceb.xceb222f,
#      #                   l_xceb.xceb222g,l_xceb.xceb222h,l_xceb.xceb301,l_xceb.xceb302,l_xceb.xceb107,
#      #                   l_xceb.xceb108,l_xceb.xceb109,l_xceb.xceb121,l_xceb.xceb122,l_xceb.xceb123,
#      #                   l_xceb.xceb124,l_xceb.xceb125,l_xceb.xceb126,l_xceb.xceb127,l_xceb.xceb128,
#      #                   l_xceb.xceb129,l_xceb.xceb130,l_xceb.xceb131,l_xceb.xceb132)
#      #161109-00085#20-e mod
#      #161109-00085#63 --e mark
#      #161109-00085#63 --s add
#      INSERT INTO xceb_t(xcebent,xcebcomp,xcebld,xcebdocno,xcebseq,
#                         xceb001,xceb002,xceb003,xceb004,xceb005,
#                         xceb101,xceb102,xceb103,xceb110,xceb111,
#                         xceb112,xceb113,xceb114,xceb115,xceb116,
#                         xceb117,xceb118,xceb119,xceb120,xceb201,
#                         xceb202,xceb202a,xceb202b,xceb202c,xceb202d,
#                         xceb202e,xceb202f,xceb202g,xceb202h,xceb212,
#                         xceb212a,xceb212b,xceb212c,xceb212d,xceb212e,
#                         xceb212f,xceb212g,xceb212h,xceb222,xceb222a,
#                         xceb222b,xceb222c,xceb222d,xceb222e,xceb222f,
#                         xceb222g,xceb222h,xceb301,xceb302,xcebud001,
#                         xcebud002,xcebud003,xcebud004,xcebud005,xcebud006,
#                         xcebud007,xcebud008,xcebud009,xcebud010,xcebud011,
#                         xcebud012,xcebud013,xcebud014,xcebud015,xcebud016,
#                         xcebud017,xcebud018,xcebud019,xcebud020,xcebud021,
#                         xcebud022,xcebud023,xcebud024,xcebud025,xcebud026,
#                         xcebud027,xcebud028,xcebud029,xcebud030,xceb107,
#                         xceb108,xceb109,xceb121,xceb122,xceb123,
#                         xceb124,xceb125,xceb126,xceb127,xceb128,
#                         xceb129,xceb130,xceb131,xceb132)
#      VALUES(l_xceb.xcebent,l_xceb.xcebcomp,l_xceb.xcebld,l_xceb.xcebdocno,l_xceb.xcebseq,
#             l_xceb.xceb001,l_xceb.xceb002,l_xceb.xceb003,l_xceb.xceb004,l_xceb.xceb005,
#             l_xceb.xceb101,l_xceb.xceb102,l_xceb.xceb103,l_xceb.xceb110,l_xceb.xceb111,
#             l_xceb.xceb112,l_xceb.xceb113,l_xceb.xceb114,l_xceb.xceb115,l_xceb.xceb116,
#             l_xceb.xceb117,l_xceb.xceb118,l_xceb.xceb119,l_xceb.xceb120,l_xceb.xceb201,
#             l_xceb.xceb202,l_xceb.xceb202a,l_xceb.xceb202b,l_xceb.xceb202c,l_xceb.xceb202d,
#             l_xceb.xceb202e,l_xceb.xceb202f,l_xceb.xceb202g,l_xceb.xceb202h,l_xceb.xceb212,
#             l_xceb.xceb212a,l_xceb.xceb212b,l_xceb.xceb212c,l_xceb.xceb212d,l_xceb.xceb212e,
#             l_xceb.xceb212f,l_xceb.xceb212g,l_xceb.xceb212h,l_xceb.xceb222,l_xceb.xceb222a,
#             l_xceb.xceb222b,l_xceb.xceb222c,l_xceb.xceb222d,l_xceb.xceb222e,l_xceb.xceb222f,
#             l_xceb.xceb222g,l_xceb.xceb222h,l_xceb.xceb301,l_xceb.xceb302,l_xceb.xcebud001,
#             l_xceb.xcebud002,l_xceb.xcebud003,l_xceb.xcebud004,l_xceb.xcebud005,l_xceb.xcebud006,
#             l_xceb.xcebud007,l_xceb.xcebud008,l_xceb.xcebud009,l_xceb.xcebud010,l_xceb.xcebud011,
#             l_xceb.xcebud012,l_xceb.xcebud013,l_xceb.xcebud014,l_xceb.xcebud015,l_xceb.xcebud016,
#             l_xceb.xcebud017,l_xceb.xcebud018,l_xceb.xcebud019,l_xceb.xcebud020,l_xceb.xcebud021,
#             l_xceb.xcebud022,l_xceb.xcebud023,l_xceb.xcebud024,l_xceb.xcebud025,l_xceb.xcebud026,
#             l_xceb.xcebud027,l_xceb.xcebud028,l_xceb.xcebud029,l_xceb.xcebud030,l_xceb.xceb107,
#             l_xceb.xceb108,l_xceb.xceb109,l_xceb.xceb121,l_xceb.xceb122,l_xceb.xceb123,
#             l_xceb.xceb124,l_xceb.xceb125,l_xceb.xceb126,l_xceb.xceb127,l_xceb.xceb128,
#             l_xceb.xceb129,l_xceb.xceb130,l_xceb.xceb131,l_xceb.xceb132)
#      #161109-00085#63 --e add
#     
#     IF SQLCA.sqlcode THEN
#        INITIALIZE g_errparam TO NULL
#      LET g_errparam.code = SQLCA.sqlcode
#      LET g_errparam.extend = "g_xcea_m"
#      LET g_errparam.popup = TRUE
#      CALL cl_err()
#  
#        LET g_success = 'N'
#        EXIT FOREACH
#     END IF
#      
#     INITIALIZE l_xcec.* TO NULL
#     
#      SELECT MAX(xcecseq) INTO l_xcec.xcecseq FROM xcec_t
#       WHERE xcecent = g_enterprise AND xcecld = g_xcea_m.xceald
#         AND xcecdocno = g_xcea_m.xceadocno
#      IF cl_null(l_xcec.xcecseq) OR l_xcec.xcecseq = 0 THEN
#         LET l_xcec.xcecseq = 1
#      ELSE
#         LET l_xcec.xcecseq = l_xcec.xcecseq + 1
#      END IF 
#
# 
#      LET l_xcec.xcecent = g_enterprise
#      LET l_xcec.xcecld  = g_xcea_m.xceald
#      LET l_xcec.xceccomp  = g_xcea_m.xceacomp
#      LET l_xcec.xcecdocno = g_xcea_m.xceadocno
#      LET l_xcec.xcec001 = ''
#      LET l_xcec.xcec002 = ''
#      LET l_xcec.xcec003 = ''
#      LET l_xcec.xcec004 = l_xccc.xccc006
#      LET l_xcec.xcec005 = l_xccc.xccc007
#      LET l_xcec.xcec101 = ''
##抓axci201的科目
#      IF cl_null(l_xcec.xcec101) THEN
#         CALL s_fin_get_account(g_xcea_m.xceald,'60','8912','8') RETURNING l_success,l_xcec.xcec101,l_errno
#      END IF
#      LET l_xcec.xcec102 = ''
#      LET l_xcec.xcec103 = l_xccc.xccc002
#      LET l_xcec.xcec117 = l_xceb.xceb117
#      LET l_xcec.xcec119 = l_xceb.xceb119
#      LET l_xcec.xcec201 = 0
#      LET l_xcec.xcec202 = l_xccc.xccc903
#      LET l_xcec.xcec202a = l_xccc.xccc903a
#      LET l_xcec.xcec202b = l_xccc.xccc903b
#      LET l_xcec.xcec202c = l_xccc.xccc903c
#      LET l_xcec.xcec202d = l_xccc.xccc903d
#      LET l_xcec.xcec202e = l_xccc.xccc903e
#      LET l_xcec.xcec202f = l_xccc.xccc903f
#      LET l_xcec.xcec202g = l_xccc.xccc903g
#      LET l_xcec.xcec202h = l_xccc.xccc903h
#      LET l_xcec.xcec212 = l_xceb.xceb212
#      LET l_xcec.xcec212a = l_xceb.xceb212a
#      LET l_xcec.xcec212b = l_xceb.xceb212b
#      LET l_xcec.xcec212c = l_xceb.xceb212c
#      LET l_xcec.xcec212d = l_xceb.xceb212d
#      LET l_xcec.xcec212e = l_xceb.xceb212e
#      LET l_xcec.xcec212f = l_xceb.xceb212f
#      LET l_xcec.xcec212g = l_xceb.xceb212g
#      LET l_xcec.xcec212h = l_xceb.xceb212h
#      LET l_xcec.xcec222 = l_xceb.xceb222
#      LET l_xcec.xcec222a = l_xceb.xceb222a
#      LET l_xcec.xcec222b = l_xceb.xceb222b
#      LET l_xcec.xcec222c = l_xceb.xceb222c
#      LET l_xcec.xcec222d = l_xceb.xceb222d
#      LET l_xcec.xcec222e = l_xceb.xceb222e
#      LET l_xcec.xcec222f = l_xceb.xceb222f
#      LET l_xcec.xcec222g = l_xceb.xceb222g
#      LET l_xcec.xcec222h = l_xceb.xceb222h
#      LET l_xcec.xcec107 = l_xceb.xceb107
#      LET l_xcec.xcec108 = l_xceb.xceb108
#      LET l_xcec.xcec109 = l_xceb.xceb109
#      LET l_xcec.xcec121 = l_xceb.xceb121
#      LET l_xcec.xcec122 = l_xceb.xceb122
#      LET l_xcec.xcec123 = l_xceb.xceb123
#      LET l_xcec.xcec124 = l_xceb.xceb124
#      LET l_xcec.xcec125 = l_xceb.xceb125
#      LET l_xcec.xcec126 = l_xceb.xceb126
#      LET l_xcec.xcec127 = l_xceb.xceb127
#      LET l_xcec.xcec128 = l_xceb.xceb128
#      LET l_xcec.xcec129 = l_xceb.xceb129
#      LET l_xcec.xcec130 = l_xceb.xceb130
# 
#      #摘要
#      IF cl_null(l_xcec.xcec102) THEN
#         CALL axct701_01_get_summ(g_xcea_m.xceald,'61','8925','10') RETURNING l_success,l_xcec.xcec102
#      END IF
#      CALL axct701_01_default_space_xceb(l_xceb.*) RETURNING l_xceb.xceb005,
#                                                             l_xceb.xceb101,
#                                                             l_xceb.xceb102,
#                                                             l_xceb.xceb103,
#                                                             l_xceb.xceb110,
#                                                             l_xceb.xceb111,
#                                                             l_xceb.xceb112,
#                                                             l_xceb.xceb113,
#                                                             l_xceb.xceb114,
#                                                             l_xceb.xceb115,
#                                                             l_xceb.xceb116,
#                                                             l_xceb.xceb117,
#                                                             l_xceb.xceb118,
#                                                             l_xceb.xceb119,
#                                                             l_xceb.xceb120,
#                                                             l_xceb.xceb107,
#                                                             l_xceb.xceb108,
#                                                             l_xceb.xceb109,
#                                                             l_xceb.xceb121,
#                                                             l_xceb.xceb122,
#                                                             l_xceb.xceb123,
#                                                             l_xceb.xceb124,
#                                                             l_xceb.xceb125,
#                                                             l_xceb.xceb126,
#                                                             l_xceb.xceb127,
#                                                             l_xceb.xceb128,
#                                                             l_xceb.xceb129,
#                                                             l_xceb.xceb130      
##如果金额和数量都为0的话，则不产生此笔单身数据                                                             
#      IF l_xcec.xcec201= 0 AND l_xcec.xcec202 = 0 THEN
#         CONTINUE FOREACH
#      END IF       
#      #161109-00085#20-s mod      
##      INSERT INTO xcec_t VALUES(l_xcec.*)   #161109-00085#20-s mark
#      #161109-00085#63 --s mark
#      #INSERT INTO xcec_t(xcecent,xceccomp,xcecld,xcecdocno,xcecseq,xcec001,xcec002,xcec003,xcec004,
#      #                   xcec005,xcec101,xcec102,xcec103,xcec110,xcec111,xcec112,xcec113,xcec114,
#      #                   xcec115,xcec116,xcec117,xcec118,xcec119,xcec120,xcec201,xcec202,xcec202a,
#      #                   xcec202b,xcec202c,xcec202d,xcec202e,xcec202f,xcec202g,xcec202h,xcec212,
#      #                   xcec212a,xcec212b,xcec212c,xcec212d,xcec212e,xcec212f,xcec212g,xcec212h,
#      #                   xcec222,xcec222a,xcec222b,xcec222c,xcec222d,xcec222e,xcec222f,xcec222g,
#      #                   xcec222h,xcec301,xcec302,xcec107,xcec108,xcec109,xcec121,xcec122,xcec123,
#      #                   xcec124,xcec125,xcec126,xcec127,xcec128,xcec129,xcec130) 
#      #            VALUES(l_xcec.xcecent,l_xcec.xceccomp,l_xcec.xcecld,l_xcec.xcecdocno,l_xcec.xcecseq,
#      #                   l_xcec.xcec001,l_xcec.xcec002,l_xcec.xcec003,l_xcec.xcec004,l_xcec.xcec005,
#      #                   l_xcec.xcec101,l_xcec.xcec102,l_xcec.xcec103,l_xcec.xcec110,l_xcec.xcec111,
#      #                   l_xcec.xcec112,l_xcec.xcec113,l_xcec.xcec114,l_xcec.xcec115,l_xcec.xcec116,
#      #                   l_xcec.xcec117,l_xcec.xcec118,l_xcec.xcec119,l_xcec.xcec120,l_xcec.xcec201,
#      #                   l_xcec.xcec202,l_xcec.xcec202a,l_xcec.xcec202b,l_xcec.xcec202c,l_xcec.xcec202d,
#      #                   l_xcec.xcec202e,l_xcec.xcec202f,l_xcec.xcec202g,l_xcec.xcec202h,l_xcec.xcec212,
#      #                   l_xcec.xcec212a,l_xcec.xcec212b,l_xcec.xcec212c,l_xcec.xcec212d,l_xcec.xcec212e,
#      #                   l_xcec.xcec212f,l_xcec.xcec212g,l_xcec.xcec212h,l_xcec.xcec222,l_xcec.xcec222a,
#      #                   l_xcec.xcec222b,l_xcec.xcec222c,l_xcec.xcec222d,l_xcec.xcec222e,l_xcec.xcec222f,
#      #                   l_xcec.xcec222g,l_xcec.xcec222h,l_xcec.xcec301,l_xcec.xcec302,l_xcec.xcec107,
#      #                   l_xcec.xcec108,l_xcec.xcec109,l_xcec.xcec121,l_xcec.xcec122,l_xcec.xcec123,
#      #                   l_xcec.xcec124,l_xcec.xcec125,l_xcec.xcec126,l_xcec.xcec127,l_xcec.xcec128,
#      #                   l_xcec.xcec129,l_xcec.xcec130)
#      #161109-00085#63 --e mark
#      #161109-00085#20-e mod
#      #161109-00085#63 --s add
#      INSERT INTO xcec_t(xcecent,xceccomp,xcecld,xcecdocno,xcecseq,
#                         xcec001,xcec002,xcec003,xcec004,xcec005,
#                         xcec101,xcec102,xcec103,xcec110,xcec111,
#                         xcec112,xcec113,xcec114,xcec115,xcec116,
#                         xcec117,xcec118,xcec119,xcec120,xcec201,
#                         xcec202,xcec202a,xcec202b,xcec202c,xcec202d,
#                         xcec202e,xcec202f,xcec202g,xcec202h,xcec212,
#                         xcec212a,xcec212b,xcec212c,xcec212d,xcec212e,
#                         xcec212f,xcec212g,xcec212h,xcec222,xcec222a,
#                         xcec222b,xcec222c,xcec222d,xcec222e,xcec222f,
#                         xcec222g,xcec222h,xcec301,xcec302,xcecud001,
#                         xcecud002,xcecud003,xcecud004,xcecud005,xcecud006,
#                         xcecud007,xcecud008,xcecud009,xcecud010,xcecud011,
#                         xcecud012,xcecud013,xcecud014,xcecud015,xcecud016,
#                         xcecud017,xcecud018,xcecud019,xcecud020,xcecud021,
#                         xcecud022,xcecud023,xcecud024,xcecud025,xcecud026,
#                         xcecud027,xcecud028,xcecud029,xcecud030,xcec107,
#                         xcec108,xcec109,xcec121,xcec122,xcec123,
#                         xcec124,xcec125,xcec126,xcec127,xcec128,
#                         xcec129,xcec130)
#      VALUES(l_xcec.xcecent,l_xcec.xceccomp,l_xcec.xcecld,l_xcec.xcecdocno,l_xcec.xcecseq,
#             l_xcec.xcec001,l_xcec.xcec002,l_xcec.xcec003,l_xcec.xcec004,l_xcec.xcec005,
#             l_xcec.xcec101,l_xcec.xcec102,l_xcec.xcec103,l_xcec.xcec110,l_xcec.xcec111,
#             l_xcec.xcec112,l_xcec.xcec113,l_xcec.xcec114,l_xcec.xcec115,l_xcec.xcec116,
#             l_xcec.xcec117,l_xcec.xcec118,l_xcec.xcec119,l_xcec.xcec120,l_xcec.xcec201,
#             l_xcec.xcec202,l_xcec.xcec202a,l_xcec.xcec202b,l_xcec.xcec202c,l_xcec.xcec202d,
#             l_xcec.xcec202e,l_xcec.xcec202f,l_xcec.xcec202g,l_xcec.xcec202h,l_xcec.xcec212,
#             l_xcec.xcec212a,l_xcec.xcec212b,l_xcec.xcec212c,l_xcec.xcec212d,l_xcec.xcec212e,
#             l_xcec.xcec212f,l_xcec.xcec212g,l_xcec.xcec212h,l_xcec.xcec222,l_xcec.xcec222a,
#             l_xcec.xcec222b,l_xcec.xcec222c,l_xcec.xcec222d,l_xcec.xcec222e,l_xcec.xcec222f,
#             l_xcec.xcec222g,l_xcec.xcec222h,l_xcec.xcec301,l_xcec.xcec302,l_xcec.xcecud001,
#             l_xcec.xcecud002,l_xcec.xcecud003,l_xcec.xcecud004,l_xcec.xcecud005,l_xcec.xcecud006,
#             l_xcec.xcecud007,l_xcec.xcecud008,l_xcec.xcecud009,l_xcec.xcecud010,l_xcec.xcecud011,
#             l_xcec.xcecud012,l_xcec.xcecud013,l_xcec.xcecud014,l_xcec.xcecud015,l_xcec.xcecud016,
#             l_xcec.xcecud017,l_xcec.xcecud018,l_xcec.xcecud019,l_xcec.xcecud020,l_xcec.xcecud021,
#             l_xcec.xcecud022,l_xcec.xcecud023,l_xcec.xcecud024,l_xcec.xcecud025,l_xcec.xcecud026,
#             l_xcec.xcecud027,l_xcec.xcecud028,l_xcec.xcecud029,l_xcec.xcecud030,l_xcec.xcec107,
#             l_xcec.xcec108,l_xcec.xcec109,l_xcec.xcec121,l_xcec.xcec122,l_xcec.xcec123,
#             l_xcec.xcec124,l_xcec.xcec125,l_xcec.xcec126,l_xcec.xcec127,l_xcec.xcec128,
#             l_xcec.xcec129,l_xcec.xcec130)
#      #161109-00085#63 --e add
#      
#      IF SQLCA.sqlcode THEN
#         INITIALIZE g_errparam TO NULL
#      LET g_errparam.code = SQLCA.sqlcode
#      LET g_errparam.extend = "g_xcea_m"
#      LET g_errparam.popup = TRUE
#      CALL cl_err()
#  
#         LET g_success = 'N'
#         EXIT FOREACH
#      END IF
#      
#      
#      CLOSE xcae_prep8
#      CLOSE xcae_prep9
#   END FOREACH   
#   RETURN g_success
#170105-00011#1---mark---e
END FUNCTION

################################################################################
# Descriptions...: 描述说明
# Memo...........:
# Usage..........: CALL s_aooi150_ins (传入参数)
#                  RETURNING 回传参数
# Input parameter: 传入参数变量1   传入参数变量说明1
#                : 传入参数变量2   传入参数变量说明2
# Return code....: 回传参数变量1   回传参数变量说明1
#                : 回传参数变量2   回传参数变量说明2
# Date & Author..: 日期 By 作者
# Modify.........:
################################################################################
PRIVATE FUNCTION axct701_01_ins_11_bak()
#161215-00040#2 Mark ---(S)---
#DEFINE l_success       LIKE type_t.num5
#DEFINE l_errno         LIKE gzze_t.gzze001
##161109-00085#19-s mod
##DEFINE l_xcea          RECORD LIKE xcea_t.*   #161109-00085#19-s mark
#DEFINE l_xcea          RECORD  #工單發料成本憑證單頭檔
#       xceaent LIKE xcea_t.xceaent, #企業編號
#       xceacomp LIKE xcea_t.xceacomp, #法人組織
#       xceald LIKE xcea_t.xceald, #帳套
#       xceadocno LIKE xcea_t.xceadocno, #單據編號
#       xcea001 LIKE xcea_t.xcea001, #單據日期
#       xcea002 LIKE xcea_t.xcea002, #成本憑證類型
#       xcea003 LIKE xcea_t.xcea003, #成本計算類型
#       xcea004 LIKE xcea_t.xcea004, #年度
#       xcea005 LIKE xcea_t.xcea005, #期別
#       xcea006 LIKE xcea_t.xcea006, #帳務人員
#       xcea007 LIKE xcea_t.xcea007, #帳務部門
#       xcea101 LIKE xcea_t.xcea101, #憑證編號
#       xcea102 LIKE xcea_t.xcea102, #憑證日期
#       xceaownid LIKE xcea_t.xceaownid, #資料所有者
#       xceaowndp LIKE xcea_t.xceaowndp, #資料所屬部門
#       xceacrtid LIKE xcea_t.xceacrtid, #資料建立者
#       xceacrtdp LIKE xcea_t.xceacrtdp, #資料建立部門
#       xceacrtdt LIKE xcea_t.xceacrtdt, #資料創建日
#       xceamodid LIKE xcea_t.xceamodid, #資料修改者
#       xceamoddt LIKE xcea_t.xceamoddt, #最近修改日
#       xceacnfid LIKE xcea_t.xceacnfid, #資料確認者
#       xceacnfdt LIKE xcea_t.xceacnfdt, #資料確認日
#       xceapstid LIKE xcea_t.xceapstid, #資料過帳者
#       xceapstdt LIKE xcea_t.xceapstdt, #資料過帳日
#       xceastus LIKE xcea_t.xceastus, #狀態碼
#       #161109-00085#63 --s add
#       xceaud001 LIKE xcea_t.xceaud001, #自定義欄位(文字)001
#       xceaud002 LIKE xcea_t.xceaud002, #自定義欄位(文字)002
#       xceaud003 LIKE xcea_t.xceaud003, #自定義欄位(文字)003
#       xceaud004 LIKE xcea_t.xceaud004, #自定義欄位(文字)004
#       xceaud005 LIKE xcea_t.xceaud005, #自定義欄位(文字)005
#       xceaud006 LIKE xcea_t.xceaud006, #自定義欄位(文字)006
#       xceaud007 LIKE xcea_t.xceaud007, #自定義欄位(文字)007
#       xceaud008 LIKE xcea_t.xceaud008, #自定義欄位(文字)008
#       xceaud009 LIKE xcea_t.xceaud009, #自定義欄位(文字)009
#       xceaud010 LIKE xcea_t.xceaud010, #自定義欄位(文字)010
#       xceaud011 LIKE xcea_t.xceaud011, #自定義欄位(數字)011
#       xceaud012 LIKE xcea_t.xceaud012, #自定義欄位(數字)012
#       xceaud013 LIKE xcea_t.xceaud013, #自定義欄位(數字)013
#       xceaud014 LIKE xcea_t.xceaud014, #自定義欄位(數字)014
#       xceaud015 LIKE xcea_t.xceaud015, #自定義欄位(數字)015
#       xceaud016 LIKE xcea_t.xceaud016, #自定義欄位(數字)016
#       xceaud017 LIKE xcea_t.xceaud017, #自定義欄位(數字)017
#       xceaud018 LIKE xcea_t.xceaud018, #自定義欄位(數字)018
#       xceaud019 LIKE xcea_t.xceaud019, #自定義欄位(數字)019
#       xceaud020 LIKE xcea_t.xceaud020, #自定義欄位(數字)020
#       xceaud021 LIKE xcea_t.xceaud021, #自定義欄位(日期時間)021
#       xceaud022 LIKE xcea_t.xceaud022, #自定義欄位(日期時間)022
#       xceaud023 LIKE xcea_t.xceaud023, #自定義欄位(日期時間)023
#       xceaud024 LIKE xcea_t.xceaud024, #自定義欄位(日期時間)024
#       xceaud025 LIKE xcea_t.xceaud025, #自定義欄位(日期時間)025
#       xceaud026 LIKE xcea_t.xceaud026, #自定義欄位(日期時間)026
#       xceaud027 LIKE xcea_t.xceaud027, #自定義欄位(日期時間)027
#       xceaud028 LIKE xcea_t.xceaud028, #自定義欄位(日期時間)028
#       xceaud029 LIKE xcea_t.xceaud029, #自定義欄位(日期時間)029
#       xceaud030 LIKE xcea_t.xceaud030, #自定義欄位(日期時間)030
#       #161109-00085#63 --e add
#       xceasite LIKE xcea_t.xceasite  #營運據點
#          END RECORD
##161109-00085#19-e mod
##161109-00085#19-s mod
##DEFINE l_xceb          RECORD LIKE xceb_t.*   #161109-00085#19-s mark
#DEFINE l_xceb          RECORD  #成本憑證第一單身檔
#       xcebent LIKE xceb_t.xcebent, #企業編號
#       xcebcomp LIKE xceb_t.xcebcomp, #法人組織
#       xcebld LIKE xceb_t.xcebld, #帳套
#       xcebdocno LIKE xceb_t.xcebdocno, #單據編號
#       xcebseq LIKE xceb_t.xcebseq, #項次
#       xceb001 LIKE xceb_t.xceb001, #參考單據編號
#       xceb002 LIKE xceb_t.xceb002, #參考單據項次
#       xceb003 LIKE xceb_t.xceb003, #單據類型
#       xceb004 LIKE xceb_t.xceb004, #料件編號
#       xceb005 LIKE xceb_t.xceb005, #特性
#       xceb101 LIKE xceb_t.xceb101, #科目編號
#       xceb102 LIKE xceb_t.xceb102, #摘要
#       xceb103 LIKE xceb_t.xceb103, #成本域
#       xceb110 LIKE xceb_t.xceb110, #原因碼
#       xceb111 LIKE xceb_t.xceb111, #收付款客商
#       xceb112 LIKE xceb_t.xceb112, #客群
#       xceb113 LIKE xceb_t.xceb113, #區域
#       xceb114 LIKE xceb_t.xceb114, #成本中心
#       xceb115 LIKE xceb_t.xceb115, #經營類別
#       xceb116 LIKE xceb_t.xceb116, #通路
#       xceb117 LIKE xceb_t.xceb117, #品類
#       xceb118 LIKE xceb_t.xceb118, #品牌
#       xceb119 LIKE xceb_t.xceb119, #專案號
#       xceb120 LIKE xceb_t.xceb120, #WBS
#       xceb201 LIKE xceb_t.xceb201, #數量
#       xceb202 LIKE xceb_t.xceb202, #成本金額(本位幣一)
#       xceb202a LIKE xceb_t.xceb202a, #成本-材料(本位幣一)
#       xceb202b LIKE xceb_t.xceb202b, #成本-人工(本位幣一)
#       xceb202c LIKE xceb_t.xceb202c, #成本-加工(本位幣一)
#       xceb202d LIKE xceb_t.xceb202d, #成本-制費一(本位幣一)
#       xceb202e LIKE xceb_t.xceb202e, #成本-制費二(本位幣一)
#       xceb202f LIKE xceb_t.xceb202f, #成本-制費三(本位幣一)
#       xceb202g LIKE xceb_t.xceb202g, #成本-制費四(本位幣一)
#       xceb202h LIKE xceb_t.xceb202h, #成本-制費五(本位幣一)
#       xceb212 LIKE xceb_t.xceb212, #成本金額(本位幣二)
#       xceb212a LIKE xceb_t.xceb212a, #成本-材料(本位幣二)
#       xceb212b LIKE xceb_t.xceb212b, #成本-人工(本位幣二)
#       xceb212c LIKE xceb_t.xceb212c, #成本-加工(本位幣二)
#       xceb212d LIKE xceb_t.xceb212d, #成本-制費一(本位幣二)
#       xceb212e LIKE xceb_t.xceb212e, #成本-制費二(本位幣二)
#       xceb212f LIKE xceb_t.xceb212f, #成本-制費三(本位幣二)
#       xceb212g LIKE xceb_t.xceb212g, #成本-制費四(本位幣二)
#       xceb212h LIKE xceb_t.xceb212h, #成本-制費五(本位幣二)
#       xceb222 LIKE xceb_t.xceb222, #成本金額(本位幣三)
#       xceb222a LIKE xceb_t.xceb222a, #成本-材料(本位幣三)
#       xceb222b LIKE xceb_t.xceb222b, #成本-人工(本位幣三)
#       xceb222c LIKE xceb_t.xceb222c, #成本-加工(本位幣三)
#       xceb222d LIKE xceb_t.xceb222d, #成本-制費一(本位幣三)
#       xceb222e LIKE xceb_t.xceb222e, #成本-制費二(本位幣三)
#       xceb222f LIKE xceb_t.xceb222f, #成本-制費三(本位幣三)
#       xceb222g LIKE xceb_t.xceb222g, #成本-制費四(本位幣三)
#       xceb222h LIKE xceb_t.xceb222h, #成本-制費五(本位幣三)
#       xceb301 LIKE xceb_t.xceb301, #憑證編號
#       xceb302 LIKE xceb_t.xceb302, #憑證項次
#       #161109-00085#63 --s add  
#       xcebud001 LIKE xceb_t.xcebud001, #自定義欄位(文字)001
#       xcebud002 LIKE xceb_t.xcebud002, #自定義欄位(文字)002
#       xcebud003 LIKE xceb_t.xcebud003, #自定義欄位(文字)003
#       xcebud004 LIKE xceb_t.xcebud004, #自定義欄位(文字)004
#       xcebud005 LIKE xceb_t.xcebud005, #自定義欄位(文字)005
#       xcebud006 LIKE xceb_t.xcebud006, #自定義欄位(文字)006
#       xcebud007 LIKE xceb_t.xcebud007, #自定義欄位(文字)007
#       xcebud008 LIKE xceb_t.xcebud008, #自定義欄位(文字)008
#       xcebud009 LIKE xceb_t.xcebud009, #自定義欄位(文字)009
#       xcebud010 LIKE xceb_t.xcebud010, #自定義欄位(文字)010
#       xcebud011 LIKE xceb_t.xcebud011, #自定義欄位(數字)011
#       xcebud012 LIKE xceb_t.xcebud012, #自定義欄位(數字)012
#       xcebud013 LIKE xceb_t.xcebud013, #自定義欄位(數字)013
#       xcebud014 LIKE xceb_t.xcebud014, #自定義欄位(數字)014
#       xcebud015 LIKE xceb_t.xcebud015, #自定義欄位(數字)015
#       xcebud016 LIKE xceb_t.xcebud016, #自定義欄位(數字)016
#       xcebud017 LIKE xceb_t.xcebud017, #自定義欄位(數字)017
#       xcebud018 LIKE xceb_t.xcebud018, #自定義欄位(數字)018
#       xcebud019 LIKE xceb_t.xcebud019, #自定義欄位(數字)019
#       xcebud020 LIKE xceb_t.xcebud020, #自定義欄位(數字)020
#       xcebud021 LIKE xceb_t.xcebud021, #自定義欄位(日期時間)021
#       xcebud022 LIKE xceb_t.xcebud022, #自定義欄位(日期時間)022
#       xcebud023 LIKE xceb_t.xcebud023, #自定義欄位(日期時間)023
#       xcebud024 LIKE xceb_t.xcebud024, #自定義欄位(日期時間)024
#       xcebud025 LIKE xceb_t.xcebud025, #自定義欄位(日期時間)025
#       xcebud026 LIKE xceb_t.xcebud026, #自定義欄位(日期時間)026
#       xcebud027 LIKE xceb_t.xcebud027, #自定義欄位(日期時間)027
#       xcebud028 LIKE xceb_t.xcebud028, #自定義欄位(日期時間)028
#       xcebud029 LIKE xceb_t.xcebud029, #自定義欄位(日期時間)029
#       xcebud030 LIKE xceb_t.xcebud030, #自定義欄位(日期時間)030
#       #161109-00085#63 --e add
#       xceb107 LIKE xceb_t.xceb107, #人員
#       xceb108 LIKE xceb_t.xceb108, #部門
#       xceb109 LIKE xceb_t.xceb109, #帳款對象
#       xceb121 LIKE xceb_t.xceb121, #自由核算項1
#       xceb122 LIKE xceb_t.xceb122, #自由核算項2
#       xceb123 LIKE xceb_t.xceb123, #自由核算項3
#       xceb124 LIKE xceb_t.xceb124, #自由核算項4
#       xceb125 LIKE xceb_t.xceb125, #自由核算項5
#       xceb126 LIKE xceb_t.xceb126, #自由核算項6
#       xceb127 LIKE xceb_t.xceb127, #自由核算項7
#       xceb128 LIKE xceb_t.xceb128, #自由核算項8
#       xceb129 LIKE xceb_t.xceb129, #自由核算項9
#       xceb130 LIKE xceb_t.xceb130, #自由核算項10
#       xceb131 LIKE xceb_t.xceb131, #單據類型(for 流通)
#       xceb132 LIKE xceb_t.xceb132  #單據日期(for 流通)
#          END RECORD
##161109-00085#19-e mod
##161109-00085#19-s mod
##DEFINE l_xcec          RECORD LIKE xcec_t.*   #161109-00085#18-s mark
#DEFINE l_xcec          RECORD  #成本憑證第二單身檔
#       xcecent LIKE xcec_t.xcecent, #企業編號
#       xceccomp LIKE xcec_t.xceccomp, #法人組織
#       xcecld LIKE xcec_t.xcecld, #帳套
#       xcecdocno LIKE xcec_t.xcecdocno, #單據編號
#       xcecseq LIKE xcec_t.xcecseq, #項次
#       xcec001 LIKE xcec_t.xcec001, #參考單據
#       xcec002 LIKE xcec_t.xcec002, #參考單據項次
#       xcec003 LIKE xcec_t.xcec003, #單據類型
#       xcec004 LIKE xcec_t.xcec004, #料件編號
#       xcec005 LIKE xcec_t.xcec005, #特性
#       xcec101 LIKE xcec_t.xcec101, #科目編號
#       xcec102 LIKE xcec_t.xcec102, #摘要
#       xcec103 LIKE xcec_t.xcec103, #成本域
#       xcec110 LIKE xcec_t.xcec110, #原因碼
#       xcec111 LIKE xcec_t.xcec111, #收付款客商
#       xcec112 LIKE xcec_t.xcec112, #客群
#       xcec113 LIKE xcec_t.xcec113, #區域
#       xcec114 LIKE xcec_t.xcec114, #成本中心
#       xcec115 LIKE xcec_t.xcec115, #經營類別
#       xcec116 LIKE xcec_t.xcec116, #通路
#       xcec117 LIKE xcec_t.xcec117, #品類
#       xcec118 LIKE xcec_t.xcec118, #品牌
#       xcec119 LIKE xcec_t.xcec119, #專案號
#       xcec120 LIKE xcec_t.xcec120, #WBS
#       xcec201 LIKE xcec_t.xcec201, #數量
#       xcec202 LIKE xcec_t.xcec202, #成本金額(本位幣一)
#       xcec202a LIKE xcec_t.xcec202a, #成本-材料(本位幣一)
#       xcec202b LIKE xcec_t.xcec202b, #成本-人工(本位幣一)
#       xcec202c LIKE xcec_t.xcec202c, #成本-加工(本位幣一)
#       xcec202d LIKE xcec_t.xcec202d, #成本-制費一(本位幣一)
#       xcec202e LIKE xcec_t.xcec202e, #成本-制費二(本位幣一)
#       xcec202f LIKE xcec_t.xcec202f, #成本-制費三(本位幣一)
#       xcec202g LIKE xcec_t.xcec202g, #成本-制費四(本位幣一)
#       xcec202h LIKE xcec_t.xcec202h, #成本-制費五(本位幣一)
#       xcec212 LIKE xcec_t.xcec212, #成本-金額(本位幣二)
#       xcec212a LIKE xcec_t.xcec212a, #成本-材料(本位幣二)
#       xcec212b LIKE xcec_t.xcec212b, #成本-人工(本位幣二)
#       xcec212c LIKE xcec_t.xcec212c, #成本-加工(本位幣二)
#       xcec212d LIKE xcec_t.xcec212d, #成本-制費一(本位幣二)
#       xcec212e LIKE xcec_t.xcec212e, #成本-制費二(本位幣二)
#       xcec212f LIKE xcec_t.xcec212f, #成本-制費三(本位幣二)
#       xcec212g LIKE xcec_t.xcec212g, #成本-制費四(本位幣二)
#       xcec212h LIKE xcec_t.xcec212h, #成本-制費五(本位幣二)
#       xcec222 LIKE xcec_t.xcec222, #成本-金額(本位幣三)
#       xcec222a LIKE xcec_t.xcec222a, #成本-材料(本位幣三)
#       xcec222b LIKE xcec_t.xcec222b, #成本-人工(本位幣三)
#       xcec222c LIKE xcec_t.xcec222c, #成本-加工(本位幣三)
#       xcec222d LIKE xcec_t.xcec222d, #成本-制費一(本位幣三)
#       xcec222e LIKE xcec_t.xcec222e, #成本-制費二(本位幣三)
#       xcec222f LIKE xcec_t.xcec222f, #成本-制費三(本位幣三)
#       xcec222g LIKE xcec_t.xcec222g, #成本-制費四(本位幣三)
#       xcec222h LIKE xcec_t.xcec222h, #成本-制費五(本位幣三)
#       xcec301 LIKE xcec_t.xcec301, #憑證編號
#       xcec302 LIKE xcec_t.xcec302, #憑證項次
#       #161109-00085#63 --s add 
#       xcecud001 LIKE xcec_t.xcecud001, #自定義欄位(文字)001
#       xcecud002 LIKE xcec_t.xcecud002, #自定義欄位(文字)002
#       xcecud003 LIKE xcec_t.xcecud003, #自定義欄位(文字)003
#       xcecud004 LIKE xcec_t.xcecud004, #自定義欄位(文字)004
#       xcecud005 LIKE xcec_t.xcecud005, #自定義欄位(文字)005
#       xcecud006 LIKE xcec_t.xcecud006, #自定義欄位(文字)006
#       xcecud007 LIKE xcec_t.xcecud007, #自定義欄位(文字)007
#       xcecud008 LIKE xcec_t.xcecud008, #自定義欄位(文字)008
#       xcecud009 LIKE xcec_t.xcecud009, #自定義欄位(文字)009
#       xcecud010 LIKE xcec_t.xcecud010, #自定義欄位(文字)010
#       xcecud011 LIKE xcec_t.xcecud011, #自定義欄位(數字)011
#       xcecud012 LIKE xcec_t.xcecud012, #自定義欄位(數字)012
#       xcecud013 LIKE xcec_t.xcecud013, #自定義欄位(數字)013
#       xcecud014 LIKE xcec_t.xcecud014, #自定義欄位(數字)014
#       xcecud015 LIKE xcec_t.xcecud015, #自定義欄位(數字)015
#       xcecud016 LIKE xcec_t.xcecud016, #自定義欄位(數字)016
#       xcecud017 LIKE xcec_t.xcecud017, #自定義欄位(數字)017
#       xcecud018 LIKE xcec_t.xcecud018, #自定義欄位(數字)018
#       xcecud019 LIKE xcec_t.xcecud019, #自定義欄位(數字)019
#       xcecud020 LIKE xcec_t.xcecud020, #自定義欄位(數字)020
#       xcecud021 LIKE xcec_t.xcecud021, #自定義欄位(日期時間)021
#       xcecud022 LIKE xcec_t.xcecud022, #自定義欄位(日期時間)022
#       xcecud023 LIKE xcec_t.xcecud023, #自定義欄位(日期時間)023
#       xcecud024 LIKE xcec_t.xcecud024, #自定義欄位(日期時間)024
#       xcecud025 LIKE xcec_t.xcecud025, #自定義欄位(日期時間)025
#       xcecud026 LIKE xcec_t.xcecud026, #自定義欄位(日期時間)026
#       xcecud027 LIKE xcec_t.xcecud027, #自定義欄位(日期時間)027
#       xcecud028 LIKE xcec_t.xcecud028, #自定義欄位(日期時間)028
#       xcecud029 LIKE xcec_t.xcecud029, #自定義欄位(日期時間)029
#       xcecud030 LIKE xcec_t.xcecud030, #自定義欄位(日期時間)030
#       #161109-00085#63 --e add
#       xcec107 LIKE xcec_t.xcec107, #人員
#       xcec108 LIKE xcec_t.xcec108, #部門
#       xcec109 LIKE xcec_t.xcec109, #帳款對象
#       xcec121 LIKE xcec_t.xcec121, #自由核算項1
#       xcec122 LIKE xcec_t.xcec122, #自由核算項2
#       xcec123 LIKE xcec_t.xcec123, #自由核算項3
#       xcec124 LIKE xcec_t.xcec124, #自由核算項4
#       xcec125 LIKE xcec_t.xcec125, #自由核算項5
#       xcec126 LIKE xcec_t.xcec126, #自由核算項6
#       xcec127 LIKE xcec_t.xcec127, #自由核算項7
#       xcec128 LIKE xcec_t.xcec128, #自由核算項8
#       xcec129 LIKE xcec_t.xcec129, #自由核算項9
#       xcec130 LIKE xcec_t.xcec130  #自由核算項10
#               END RECORD
##161109-00085#19-e mod
##161109-00085#19-s mod
##DEFINE l_xckb          RECORD LIKE xckb_t.*   #161109-00085#19-s mark   
#DEFINE l_xckb          RECORD  #發出商品統計檔
#       xckbent LIKE xckb_t.xckbent, #企業編號
#       xckbcomp LIKE xckb_t.xckbcomp, #法人
#       xckbld LIKE xckb_t.xckbld, #帳套
#       xckb001 LIKE xckb_t.xckb001, #來源
#       xckb002 LIKE xckb_t.xckb002, #方向
#       xckb003 LIKE xckb_t.xckb003, #發票號碼
#       xckb004 LIKE xckb_t.xckb004, #據點site
#       xckb005 LIKE xckb_t.xckb005, #出貨單號
#       xckb006 LIKE xckb_t.xckb006, #出貨項次
#       xckb007 LIKE xckb_t.xckb007, #年度
#       xckb008 LIKE xckb_t.xckb008, #期別
#       xckb009 LIKE xckb_t.xckb009, #客戶編號
#       xckb010 LIKE xckb_t.xckb010, #人員編號
#       xckb011 LIKE xckb_t.xckb011, #部門編號
#       xckb012 LIKE xckb_t.xckb012, #產品編號
#       xckb013 LIKE xckb_t.xckb013, #銷售單位
#       xckb014 LIKE xckb_t.xckb014, #數量
#       xckb015 LIKE xckb_t.xckb015, #倉庫編號
#       xckb016 LIKE xckb_t.xckb016, #庫位編號
#       xckb017 LIKE xckb_t.xckb017, #批號
#       xckb018 LIKE xckb_t.xckb018, #no use
#       xckb019 LIKE xckb_t.xckb019, #發票編號
#       xckb020 LIKE xckb_t.xckb020, #庫存單位
#       xckb021 LIKE xckb_t.xckb021, #庫存數量
#       xckb022 LIKE xckb_t.xckb022, #科目編號
#       xckb023 LIKE xckb_t.xckb023, #多角貿易否
#       xckb024 LIKE xckb_t.xckb024, #開票年度
#       xckb025 LIKE xckb_t.xckb025, #開票期別
#       xckb026 LIKE xckb_t.xckb026, #幣別一
#       xckb027 LIKE xckb_t.xckb027, #金額
#       xckb028 LIKE xckb_t.xckb028, #幣別二
#       xckb029 LIKE xckb_t.xckb029, #金額
#       xckb030 LIKE xckb_t.xckb030, #幣別三
#       xckb031 LIKE xckb_t.xckb031, #金額
#       xckb032 LIKE xckb_t.xckb032, #no use
#       xckb033 LIKE xckb_t.xckb033, #no use
#       xckb034 LIKE xckb_t.xckb034, #no use
#       xckb035 LIKE xckb_t.xckb035, #no use
#       xckb036 LIKE xckb_t.xckb036, #項序
#       xckb037 LIKE xckb_t.xckb037, #特性
#       xckb101 LIKE xckb_t.xckb101, #幣別一成本單價
#       xckb101a LIKE xckb_t.xckb101a, #幣別一成本單價-材料
#       xckb101b LIKE xckb_t.xckb101b, #幣別一成本單價-人工
#       xckb101c LIKE xckb_t.xckb101c, #幣別一成本單價-加工
#       xckb101d LIKE xckb_t.xckb101d, #幣別一成本單價-制費一
#       xckb101e LIKE xckb_t.xckb101e, #幣別一成本單價-制費二
#       xckb101f LIKE xckb_t.xckb101f, #幣別一成本單價-制費三
#       xckb101g LIKE xckb_t.xckb101g, #幣別一成本單價-制費四
#       xckb101h LIKE xckb_t.xckb101h, #幣別一成本單價-制費五
#       xckb102 LIKE xckb_t.xckb102, #幣別一成本金額
#       xckb102a LIKE xckb_t.xckb102a, #幣別一成本金額-材料
#       xckb102b LIKE xckb_t.xckb102b, #幣別一成本金額-人工
#       xckb102c LIKE xckb_t.xckb102c, #幣別一成本金額-加工
#       xckb102d LIKE xckb_t.xckb102d, #幣別一成本金額-制費一
#       xckb102e LIKE xckb_t.xckb102e, #幣別一成本金額-制費二
#       xckb102f LIKE xckb_t.xckb102f, #幣別一成本金額-制費三
#       xckb102g LIKE xckb_t.xckb102g, #幣別一成本金額-制費四
#       xckb102h LIKE xckb_t.xckb102h, #幣別一成本金額-制費五
#       xckb111 LIKE xckb_t.xckb111, #幣別二成本單價
#       xckb111a LIKE xckb_t.xckb111a, #幣別二成本單價-材料
#       xckb111b LIKE xckb_t.xckb111b, #幣別二成本單價-人工
#       xckb111c LIKE xckb_t.xckb111c, #幣別二成本單價-加工
#       xckb111d LIKE xckb_t.xckb111d, #幣別二成本單價-制費一
#       xckb111e LIKE xckb_t.xckb111e, #幣別二成本單價-制費二
#       xckb111f LIKE xckb_t.xckb111f, #幣別二成本單價-制費三
#       xckb111g LIKE xckb_t.xckb111g, #幣別二成本單價-制費四
#       xckb111h LIKE xckb_t.xckb111h, #幣別二成本單價-制費五
#       xckb112 LIKE xckb_t.xckb112, #幣別二成本金額
#       xckb112a LIKE xckb_t.xckb112a, #幣別二成本金額-材料
#       xckb112b LIKE xckb_t.xckb112b, #幣別二成本金額-人工
#       xckb112c LIKE xckb_t.xckb112c, #幣別二成本金額-加工
#       xckb112d LIKE xckb_t.xckb112d, #幣別二成本金額-制費一
#       xckb112e LIKE xckb_t.xckb112e, #幣別二成本金額-制費二
#       xckb112f LIKE xckb_t.xckb112f, #幣別二成本金額-制費三
#       xckb112g LIKE xckb_t.xckb112g, #幣別二成本金額-制費四
#       xckb112h LIKE xckb_t.xckb112h, #幣別二成本金額-制費五
#       xckb121 LIKE xckb_t.xckb121, #幣別三成本單價
#       xckb121a LIKE xckb_t.xckb121a, #幣別三成本單價-材料
#       xckb121b LIKE xckb_t.xckb121b, #幣別三成本單價-人工
#       xckb121c LIKE xckb_t.xckb121c, #幣別三成本單價-加工
#       xckb121d LIKE xckb_t.xckb121d, #幣別三成本單價-制費一
#       xckb121e LIKE xckb_t.xckb121e, #幣別三成本單價-制費二
#       xckb121f LIKE xckb_t.xckb121f, #幣別三成本單價-制費三
#       xckb121g LIKE xckb_t.xckb121g, #幣別三成本單價-制費四
#       xckb121h LIKE xckb_t.xckb121h, #幣別三成本單價-制費五
#       xckb122 LIKE xckb_t.xckb122, #幣別三成本金額
#       xckb122a LIKE xckb_t.xckb122a, #幣別三成本金額-材料
#       xckb122b LIKE xckb_t.xckb122b, #幣別三成本金額-人工
#       xckb122c LIKE xckb_t.xckb122c, #幣別三成本金額-加工
#       xckb122d LIKE xckb_t.xckb122d, #幣別三成本金額-制費一
#       xckb122e LIKE xckb_t.xckb122e, #種三成本金額-制費二
#       xckb122f LIKE xckb_t.xckb122f, #幣別三成本金額-制費三
#       xckb122g LIKE xckb_t.xckb122g, #幣別三成本金額-制費四
#       xckb122h LIKE xckb_t.xckb122h, #幣別三成本金額-制費五
#       xckb038 LIKE xckb_t.xckb038  #成本域
#          END RECORD
##161109-00085#19-e mod
#DEFINE l_sql           STRING
#DEFINE l_sql1          STRING
#DEFINE l_rate          LIKE type_t.num26_10
#DEFINE l_rate1         LIKE type_t.num26_10
#DEFINE ld_date         DATETIME YEAR TO SECOND
#DEFINE l_cnt1          LIKE type_t.num5         #160706-00021#3
#DEFINE l_xckb005_t     LIKE xckb_t.xckb005      #160706-00021#3
#DEFINE l_xckb006_t     LIKE xckb_t.xckb006      #160706-00021#3
#DEFINE l_xmdk004       LIKE xmdk_t.xmdk004      #160816-00015#1 add
#
#   LET g_success = 'Y'
#   LET l_xcea.xceaent   = g_enterprise
#   LET l_xcea.xceacomp  = g_xcea_m.xceacomp
#   LET l_xcea.xceald    = g_xcea_m.xceald
#   LET l_xcea.xcea001   = g_xcea_m.xcea001
#   LET l_xcea.xcea002   = g_xcea002   #11转入 12转出
#   LET l_xcea.xcea003   = g_xcea_m.xcea003
#   LET l_xcea.xcea004   = g_xcea_m.xcea004
#   LET l_xcea.xcea005   = g_xcea_m.xcea005
#   LET l_xcea.xcea006   = g_xcea_m.xcea006
#   LET l_xcea.xcea007   = g_xcea_m.xcea007
#   LET l_xcea.xcea101   = ''
#   LET l_xcea.xcea102   = ''
#   LET l_xcea.xceaownid = g_user
#   LET l_xcea.xceaowndp = g_dept
#   LET l_xcea.xceacrtid = g_user
#   LET l_xcea.xceacrtdp = g_dept 
#   LET ld_date = cl_get_current()
#   LET l_xcea.xceacrtdt = ld_date
#   LET l_xcea.xceamodid = ""
#   LET l_xcea.xceamoddt = ""
#   LET l_xcea.xceacnfid = ""
#   LET l_xcea.xceacnfdt = ""
#   LET l_xcea.xceapstid = ""
#   LET l_xcea.xceapstdt = ""
#   LET l_xcea.xceastus  = 'N'
#   CALL s_aooi200_fin_gen_docno(g_xcea_m.xceald,'','',g_xcea_m.xceadocno,g_xcea_m.xcea001,g_prog_name1)      #wujie 150214
#   RETURNING l_success,l_xcea.xceadocno
#   IF l_success  = 0  THEN
#      INITIALIZE g_errparam TO NULL
#      LET g_errparam.code = 'apm-00003'
#      LET g_errparam.extend = g_xcea_m.xceadocno
#      LET g_errparam.popup = TRUE
#      CALL cl_err()
#      LET g_success = 'N'
#      RETURN g_success
#   END IF
#   #161109-00085#20-s mod
##   INSERT INTO xcea_t VALUES(l_xcea.*)   #161109-00085#20-s mark
#   #161109-00085#63 --s mark
#   #INSERT INTO xcea_t(xceaent,xceacomp,xceald,xceadocno,xcea001,xcea002,xcea003,xcea004,xcea005,
#   #                   xcea006,xcea007,xcea101,xcea102,xceaownid,xceaowndp,xceacrtid,xceacrtdp,xceacrtdt,
#   #                   xceamodid,xceamoddt,xceacnfid,xceacnfdt,xceapstid,xceapstdt,xceastus,xceasite) 
#   #            VALUES(l_xcea.xceaent,l_xcea.xceacomp,l_xcea.xceald,l_xcea.xceadocno,l_xcea.xcea001,
#   #                   l_xcea.xcea002,l_xcea.xcea003,l_xcea.xcea004,l_xcea.xcea005,l_xcea.xcea006,
#   #                   l_xcea.xcea007,l_xcea.xcea101,l_xcea.xcea102,l_xcea.xceaownid,l_xcea.xceaowndp,
#   #                   l_xcea.xceacrtid,l_xcea.xceacrtdp,l_xcea.xceacrtdt,l_xcea.xceamodid,l_xcea.xceamoddt,
#   #                   l_xcea.xceacnfid,l_xcea.xceacnfdt,l_xcea.xceapstid,l_xcea.xceapstdt,l_xcea.xceastus,l_xcea.xceasite)
#   #161109-00085#63 --e mark
#   #161109-00085#20-e mod
#   #161109-00085#63 --s add
#   INSERT INTO xcea_t(xceaent,xceacomp,xceald,xceadocno,xcea001,
#                      xcea002,xcea003,xcea004,xcea005,xcea006,
#                      xcea007,xcea101,xcea102,xceaownid,xceaowndp,
#                      xceacrtid,xceacrtdp,xceacrtdt,xceamodid,xceamoddt,
#                      xceacnfid,xceacnfdt,xceapstid,xceapstdt,xceastus,
#                      xceaud001,xceaud002,xceaud003,xceaud004,xceaud005,
#                      xceaud006,xceaud007,xceaud008,xceaud009,xceaud010,
#                      xceaud011,xceaud012,xceaud013,xceaud014,xceaud015,
#                      xceaud016,xceaud017,xceaud018,xceaud019,xceaud020,
#                      xceaud021,xceaud022,xceaud023,xceaud024,xceaud025,
#                      xceaud026,xceaud027,xceaud028,xceaud029,xceaud030,
#                      xceasite)
#   VALUES(l_xcea.xceaent,l_xcea.xceacomp,l_xcea.xceald,l_xcea.xceadocno,l_xcea.xcea001,
#          l_xcea.xcea002,l_xcea.xcea003,l_xcea.xcea004,l_xcea.xcea005,l_xcea.xcea006,
#          l_xcea.xcea007,l_xcea.xcea101,l_xcea.xcea102,l_xcea.xceaownid,l_xcea.xceaowndp,
#          l_xcea.xceacrtid,l_xcea.xceacrtdp,l_xcea.xceacrtdt,l_xcea.xceamodid,l_xcea.xceamoddt,
#          l_xcea.xceacnfid,l_xcea.xceacnfdt,l_xcea.xceapstid,l_xcea.xceapstdt,l_xcea.xceastus,
#          l_xcea.xceaud001,l_xcea.xceaud002,l_xcea.xceaud003,l_xcea.xceaud004,l_xcea.xceaud005,
#          l_xcea.xceaud006,l_xcea.xceaud007,l_xcea.xceaud008,l_xcea.xceaud009,l_xcea.xceaud010,
#          l_xcea.xceaud011,l_xcea.xceaud012,l_xcea.xceaud013,l_xcea.xceaud014,l_xcea.xceaud015,
#          l_xcea.xceaud016,l_xcea.xceaud017,l_xcea.xceaud018,l_xcea.xceaud019,l_xcea.xceaud020,
#          l_xcea.xceaud021,l_xcea.xceaud022,l_xcea.xceaud023,l_xcea.xceaud024,l_xcea.xceaud025,
#          l_xcea.xceaud026,l_xcea.xceaud027,l_xcea.xceaud028,l_xcea.xceaud029,l_xcea.xceaud030,
#          l_xcea.xceasite)
#   #161109-00085#63 --e add
#   IF SQLCA.sqlcode THEN
#      INITIALIZE g_errparam TO NULL
#      LET g_errparam.code = SQLCA.sqlcode
#      LET g_errparam.extend = "xcea_t"
#      LET g_errparam.popup = TRUE
#      CALL cl_err()
#      LET g_success = 'N'
#      RETURN g_success
#   END IF
#   LET g_xcea_m.xceadocno = l_xcea.xceadocno
#   
#   #xceb单身
#   #161109-00085#20-s mod
##   LET l_sql = " SELECT * FROM xckb_t ",   #161109-00085#20-s mark
#   LET l_sql = " SELECT xckbent,xckbcomp,xckbld,xckb001,xckb002,xckb003,xckb004,xckb005,
#                        xckb006,xckb007,xckb008,xckb009,xckb010,xckb011,xckb012,xckb013,
#                        xckb014,xckb015,xckb016,xckb017,xckb018,xckb019,xckb020,xckb021,
#                        xckb022,xckb023,xckb024,xckb025,xckb026,xckb027,xckb028,xckb029,
#                        xckb030,xckb031,xckb032,xckb033,xckb034,xckb035,xckb036,xckb037,
#                        xckb101,xckb101a,xckb101b,xckb101c,xckb101d,xckb101e,xckb101f,xckb101g,
#                        xckb101h,xckb102,xckb102a,xckb102b,xckb102c,xckb102d,xckb102e,xckb102f,
#                        xckb102g,xckb102h,xckb111,xckb111a,xckb111b,xckb111c,xckb111d,xckb111e,
#                        xckb111f,xckb111g,xckb111h,xckb112,xckb112a,xckb112b,xckb112c,xckb112d,
#                        xckb112e,xckb112f,xckb112g,xckb112h,xckb121,xckb121a,xckb121b,xckb121c,
#                        xckb121d,xckb121e,xckb121f,xckb121g,xckb121h,xckb122,xckb122a,xckb122b,
#                        xckb122c,xckb122d,xckb122e,xckb122f,xckb122g,xckb122h,xckb038 
#                    FROM xckb_t ",
#   #161109-00085#20-e mod
#               "  WHERE xckbent = '",g_enterprise,"' AND xckbld = '",g_xcea_m.xceald,"'",
#               "    AND xckbcomp= '",g_xcea_m.xceacomp,"' ",
#               "    AND xckb007 = ",g_xcea_m.xcea004," AND xckb008 = ",g_xcea_m.xcea005#, #年度，期別      #160706-00021#3 mark,
#              #"    AND xckb102 <> 0 "  #成本金额            #160706-00021#3
#   IF  l_xcea.xcea002 = '11' THEN  #11转入 12转出
#       LET l_sql = l_sql CLIPPED," AND xckb002 = 1 "  #转入
#       #160706-00021#3--(S)
#       #axct711:取的不是所有的轉入 要扣除本直接轉出的
#       LET l_sql = l_sql CLIPPED," AND (xckb005,xckb006) IN ",
#                                  " (SELECT xckb005,xckb006 FROM xckb_t ",
#                                  "   WHERE xckbent = '",g_enterprise,"' AND xckbld = '",g_xcea_m.xceald,"'",
#                                  "    AND xckbcomp= '",g_xcea_m.xceacomp,"' ",
#                                  "    AND xckb007 = ",g_xcea_m.xcea004," AND xckb008 = ",g_xcea_m.xcea005,
#                                  "    GROUP BY xckb005,xckb006
#                                       HAVING SUM(xckb002*xckb014) > 0)"
#       #160706-00021#3--(E)
#   ELSE
#      LET l_sql = l_sql CLIPPED," AND xckb002 = -1 "  #转出
#      #160706-00021#3--(S)
#      #axct712:只取前期轉入  本月轉出開發票的
#      LET l_sql = l_sql CLIPPED," AND (xckb005,xckb006) IN ",
#                                " (SELECT isag002,isag003 FROM isaf_t,isag_t,xmdk_t,xmdl_t",
#                                "   WHERE isafent = isagent AND isafcomp = isagcomp ",
#                                "     AND isafdocno = isagdocno ",
#                                "     AND isagent = xckbent AND isagcomp = xckbcomp AND isagdocno = xckb005 AND isagseq = xckb006 ",
#                                "     AND isafstus = 'Y'",
#                                "     AND xckb007*100+xckb008 < to_char(isafdocdt,'yyyyMM') ",
#                                "  )"
#       #160706-00021#3--(E)
#   END IF
#   LET l_sql = l_sql CLIPPED, "ORDER BY  xckb005,xckb006 "     #160706-00021#3
#   PREPARE axct701_01_ins_11_p1 FROM l_sql
#   DECLARE axct701_01_ins_11_c1 CURSOR FOR axct701_01_ins_11_p1
#   LET l_xckb005_t = ' '   #160706-00021#3
#   LET l_xckb006_t = 0     #160706-00021#3
#   #161109-00085#20-s mod
##   FOREACH axct701_01_ins_11_c1 INTO  l_xckb.*   #161109-00085#20-s mark
#   FOREACH axct701_01_ins_11_c1 INTO  l_xckb.xckbent,l_xckb.xckbcomp,l_xckb.xckbld,l_xckb.xckb001,
#                                      l_xckb.xckb002,l_xckb.xckb003,l_xckb.xckb004,l_xckb.xckb005,
#                                      l_xckb.xckb006,l_xckb.xckb007,l_xckb.xckb008,l_xckb.xckb009,
#                                      l_xckb.xckb010,l_xckb.xckb011,l_xckb.xckb012,l_xckb.xckb013,
#                                      l_xckb.xckb014,l_xckb.xckb015,l_xckb.xckb016,l_xckb.xckb017,
#                                      l_xckb.xckb018,l_xckb.xckb019,l_xckb.xckb020,l_xckb.xckb021,
#                                      l_xckb.xckb022,l_xckb.xckb023,l_xckb.xckb024,l_xckb.xckb025,
#                                      l_xckb.xckb026,l_xckb.xckb027,l_xckb.xckb028,l_xckb.xckb029,
#                                      l_xckb.xckb030,l_xckb.xckb031,l_xckb.xckb032,l_xckb.xckb033,
#                                      l_xckb.xckb034,l_xckb.xckb035,l_xckb.xckb036,l_xckb.xckb037,
#                                      l_xckb.xckb101,l_xckb.xckb101a,l_xckb.xckb101b,l_xckb.xckb101c,
#                                      l_xckb.xckb101d,l_xckb.xckb101e,l_xckb.xckb101f,l_xckb.xckb101g,
#                                      l_xckb.xckb101h,l_xckb.xckb102,l_xckb.xckb102a,l_xckb.xckb102b,
#                                      l_xckb.xckb102c,l_xckb.xckb102d,l_xckb.xckb102e,l_xckb.xckb102f,
#                                      l_xckb.xckb102g,l_xckb.xckb102h,l_xckb.xckb111,l_xckb.xckb111a,
#                                      l_xckb.xckb111b,l_xckb.xckb111c,l_xckb.xckb111d,l_xckb.xckb111e,
#                                      l_xckb.xckb111f,l_xckb.xckb111g,l_xckb.xckb111h,l_xckb.xckb112,
#                                      l_xckb.xckb112a,l_xckb.xckb112b,l_xckb.xckb112c,l_xckb.xckb112d,
#                                      l_xckb.xckb112e,l_xckb.xckb112f,l_xckb.xckb112g,l_xckb.xckb112h,
#                                      l_xckb.xckb121,l_xckb.xckb121a,l_xckb.xckb121b,l_xckb.xckb121c,
#                                      l_xckb.xckb121d,l_xckb.xckb121e,l_xckb.xckb121f,l_xckb.xckb121g,
#                                      l_xckb.xckb121h,l_xckb.xckb122,l_xckb.xckb122a,l_xckb.xckb122b,
#                                      l_xckb.xckb122c,l_xckb.xckb122d,l_xckb.xckb122e,l_xckb.xckb122f,
#                                      l_xckb.xckb122g,l_xckb.xckb122h,l_xckb.xckb038
#   #161109-00085#20-e mod
#      INITIALIZE l_xceb.* TO NULL
#      #160706-00021#3--(S)
#      IF l_xckb005_t = l_xckb.xckb005 AND  l_xckb006_t = l_xckb.xckb006 THEN
#         CONTINUE FOREACH
#      ELSE   
#         LET l_xckb005_t = l_xckb.xckb005
#         LET l_xckb006_t = l_xckb.xckb006
#      END IF
#      #160706-00021#3--(E)
#      SELECT MAX(xcebseq) INTO l_xceb.xcebseq FROM xceb_t
#       WHERE xcebent = g_enterprise AND xcebld = g_xcea_m.xceald
#         AND xcebdocno = g_xcea_m.xceadocno
#      IF cl_null(l_xceb.xcebseq) OR l_xceb.xcebseq = 0 THEN
#         LET l_xceb.xcebseq = 1
#      ELSE
#         LET l_xceb.xcebseq = l_xceb.xcebseq + 1
#      END IF 
#      
#      LET l_xceb.xcebent  = g_enterprise
#      LET l_xceb.xcebcomp = g_xcea_m.xceacomp
#      LET l_xceb.xcebld   = g_xcea_m.xceald
#      LET l_xceb.xcebdocno= g_xcea_m.xceadocno
#      LET l_xceb.xceb001  = l_xckb.xckb005  #參考單據編號
#      LET l_xceb.xceb002  = l_xckb.xckb006  #參考單據項次
#      LET l_xceb.xceb003  = '9'             #單據類型--发出商品
#      LET l_xceb.xceb004  = l_xckb.xckb012  #料件編號
#      LET l_xceb.xceb005  = l_xckb.xckb037  #特性
#      
#      LET l_xceb.xceb101 = ''               #科目编号
#      IF g_xcea002='11' THEN   #11转入 12转出
#         #发出商品
#         CALL s_get_item_acc(g_xcea_m.xceald,'17',l_xceb.xceb004,'','',g_xcea_m.xceacomp,'') 
#           RETURNING l_success,l_xceb.xceb101 
#      ELSE
#         #销售收入
#         CALL s_get_item_acc(g_xcea_m.xceald,'5',l_xceb.xceb004,'','',g_xcea_m.xceacomp,'') 
#           RETURNING l_success,l_xceb.xceb101 
#      END IF
#      
#      LET l_xceb.xceb102  = ''              #摘要
#      #摘要
#      IF g_xcea002='11' THEN   #11转入 12转出
#         CALL axct701_01_get_summ(g_xcea_m.xceald,'61','8925','11') RETURNING l_success,l_xceb.xceb102
#      ELSE
#         CALL axct701_01_get_summ(g_xcea_m.xceald,'61','8925','12') RETURNING l_success,l_xceb.xceb102
#      END IF
#      
#      LET l_xceb.xceb103  = l_xckb.xckb038  #成本域
#      LET l_xceb.xceb110 = ' '  #原因碼
#      
#      LET l_xceb.xceb111 = ' '  #交易對象
#      LET l_xceb.xceb112 = ' '  #客群
#      LET l_xceb.xceb113 = ' '  #區域
#      LET l_xceb.xceb114 = ' '  #成本中心
#      LET l_xceb.xceb115 = ' '  #經營類別
#      LET l_xceb.xceb116 = ' '  #渠道
#      LET l_xceb.xceb119 = ' '  #項目號
#      LET l_xceb.xceb120 = ' '  #WBS
#      LET l_xceb.xceb107 = ' '  #人员
#     #LET l_xceb.xceb108 = ' '  #部门   #160816-00015#1 mark
#      LET l_xmdk004 = ''                #160816-00015#1 add
#      SELECT xmdk008,pmaa090,xmdl222,ooeg004,xmdl216,xmdl200,xmdl030,xmdl031,xmdl213,xmdl214,
#             xmdk004                            #160816-00015#1 add
#        INTO l_xceb.xceb111,l_xceb.xceb112,l_xceb.xceb113,l_xceb.xceb114,l_xceb.xceb115,l_xceb.xceb116,l_xceb.xceb119,l_xceb.xceb120,l_xceb.xceb107,l_xceb.xceb108,
#             l_xmdk004                          #160816-00015#1 add
#        FROM xmdk_t LEFT JOIN pmaa_t ON pmaaent = xmdkent AND pmaa001=xmdk008 ,
#             xmdl_t LEFT JOIN ooeg_t ON ooegent = xmdlent AND ooeg001=xmdl214 AND ooeg003='3' #成本中心
#       WHERE xmdkent  = xmdlent
#         AND xmdkdocno= xmdldocno
#         AND xmdlent  = g_enterprise
#         AND xmdldocno= l_xceb.xceb001
#         AND xmdlseq  = l_xceb.xceb002
#
#     #160816-00015#1-s-add
#      IF NOT cl_null(l_xmdk004) THEN
#         LET l_xceb.xceb108 = l_xmdk004   
#      ELSE
#         LET l_xceb.xceb108 = ' '
#      END IF      
#     #160816-00015#1-e-add 
#     
#      IF cl_null(l_xceb.xceb114) THEN LET l_xceb.xceb114 = l_xceb.xceb108 END IF  #成本中心为空就为部门
#      
#      LET l_xceb.xceb109 = l_xceb.xceb111  #账款对象
# 
#
#      LET l_xceb.xceb117 = ' '  #品類
#      LET l_xceb.xceb118 = ' '  #品牌
#      SELECT imaa009,imaa126 INTO l_xceb.xceb117,l_xceb.xceb118 FROM imaa_t
#       WHERE imaaent = g_enterprise
#         AND imaa001 = l_xceb.xceb004
#      #160706-00021#3--(S)
#      SELECT SUM(xckb002*xckb014) ,SUM(xckb002*xckb102) ,SUM(xckb002*xckb102a),SUM(xckb002*xckb102b),SUM(xckb002*xckb102c),
#             SUM(xckb002*xckb102d),SUM(xckb002*xckb102e),SUM(xckb002*xckb102f),SUM(xckb002*xckb102g),SUM(xckb002*xckb102h)
#        INTO l_xckb.xckb021 ,l_xckb.xckb102 ,l_xckb.xckb102a,l_xckb.xckb102b,l_xckb.xckb102c,
#             l_xckb.xckb102d,l_xckb.xckb102e,l_xckb.xckb102f,l_xckb.xckb102g,l_xckb.xckb102h
#        FROM xckb_t
#       WHERE xckbent = g_enterprise
#         AND xckbld  = g_xcea_m.xceald  AND xckbcomp = g_xcea_m.xceacomp
#         AND xckb005 = l_xckb.xckb005   AND xckb006 = l_xckb.xckb006
#         AND xckb007 = g_xcea_m.xcea004 AND xckb008 = g_xcea_m.xcea005         
#       GROUP BY xckb005,xckb006       
#      #160706-00021#3--(E)
#      LET l_xceb.xceb201  = l_xckb.xckb021  #數量
#      LET l_xceb.xceb202  = l_xckb.xckb102  #成本金額(本位幣一)
#      LET l_xceb.xceb202a = l_xckb.xckb102a #成本-材料(本位幣一)
#      LET l_xceb.xceb202b = l_xckb.xckb102b #成本-人工(本位幣一)
#      LET l_xceb.xceb202c = l_xckb.xckb102c #成本-加工(本位幣一)
#      LET l_xceb.xceb202d = l_xckb.xckb102d #成本-制費一(本位幣一)
#      LET l_xceb.xceb202e = l_xckb.xckb102e #成本-制費二(本位幣一)
#      LET l_xceb.xceb202f = l_xckb.xckb102f #成本-制費三(本位幣一)
#      LET l_xceb.xceb202g = l_xckb.xckb102g #成本-制費四(本位幣一)
#      LET l_xceb.xceb202h = l_xckb.xckb102h #成本-制費五(本位幣一)
#      LET l_xceb.xceb212  = l_xckb.xckb112  #成本金額(本位幣二)
#      LET l_xceb.xceb212a = l_xckb.xckb112a #成本-材料(本位幣二)
#      LET l_xceb.xceb212b = l_xckb.xckb112b #成本-人工(本位幣二)
#      LET l_xceb.xceb212c = l_xckb.xckb112c #成本-加工(本位幣二)
#      LET l_xceb.xceb212d = l_xckb.xckb112d #成本-制費一(本位幣二)
#      LET l_xceb.xceb212e = l_xckb.xckb112e #成本-制費二(本位幣二)
#      LET l_xceb.xceb212f = l_xckb.xckb112f #成本-制費三(本位幣二)
#      LET l_xceb.xceb212g = l_xckb.xckb112g #成本-制費四(本位幣二)
#      LET l_xceb.xceb212h = l_xckb.xckb112h #成本-制費五(本位幣二)
#      LET l_xceb.xceb222  = l_xckb.xckb122  #成本金額(本位幣三)
#      LET l_xceb.xceb222a = l_xckb.xckb122a #成本-材料(本位幣三)
#      LET l_xceb.xceb222b = l_xckb.xckb122b #成本-人工(本位幣三)
#      LET l_xceb.xceb222c = l_xckb.xckb122c #成本-加工(本位幣三)
#      LET l_xceb.xceb222d = l_xckb.xckb122d #成本-制費一(本位幣三)
#      LET l_xceb.xceb222e = l_xckb.xckb122e #成本-制費二(本位幣三)
#      LET l_xceb.xceb222f = l_xckb.xckb122f #成本-制費三(本位幣三)
#      LET l_xceb.xceb222g = l_xckb.xckb122g #成本-制費四(本位幣三)
#      LET l_xceb.xceb222h = l_xckb.xckb122h #成本-制費五(本位幣三)
#
#      LET l_xceb.xceb301  = ''    #憑證編號
#      LET l_xceb.xceb302  = ''    #憑證項次
#      #161109-00085#18-s mark
##      LET l_xceb.xcebud021= ''    #自定義欄位(日期時間)
##      LET l_xceb.xcebud022= ''    #自定義欄位(日期時間)
##      LET l_xceb.xcebud023= ''    #自定義欄位(日期時間)
##      LET l_xceb.xcebud024= ''    #自定義欄位(日期時間)
##      LET l_xceb.xcebud025= ''    #自定義欄位(日期時間)
##      LET l_xceb.xcebud026= ''    #自定義欄位(日期時間)
##      LET l_xceb.xcebud027= ''    #自定義欄位(日期時間)
##      LET l_xceb.xcebud028= ''    #自定義欄位(日期時間)
##      LET l_xceb.xcebud029= ''    #自定義欄位(日期時間)
##      LET l_xceb.xcebud030= ''    #自定義欄位(日期時間)
#      
#      #自由核算项1～10  
#      LET l_xceb.xceb121 = ' '   #自由核算項1
#      LET l_xceb.xceb122 = ' '   #自由核算項2
#      LET l_xceb.xceb123 = ' '   #自由核算項3
#      LET l_xceb.xceb124 = ' '   #自由核算項4
#      LET l_xceb.xceb125 = ' '   #自由核算項5
#      LET l_xceb.xceb126 = ' '   #自由核算項6
#      LET l_xceb.xceb127 = ' '   #自由核算項7
#      LET l_xceb.xceb128 = ' '   #自由核算項8
#      LET l_xceb.xceb129 = ' '   #自由核算項9
#      LET l_xceb.xceb130 = ' '   #自由核算項10
#      
#      CALL axct701_01_default_space_xceb(l_xceb.*) RETURNING l_xceb.xceb005,
#                                                             l_xceb.xceb101,
#                                                             l_xceb.xceb102,
#                                                             l_xceb.xceb103,
#                                                             l_xceb.xceb110,
#                                                             l_xceb.xceb111,
#                                                             l_xceb.xceb112,
#                                                             l_xceb.xceb113,
#                                                             l_xceb.xceb114,
#                                                             l_xceb.xceb115,
#                                                             l_xceb.xceb116,
#                                                             l_xceb.xceb117,
#                                                             l_xceb.xceb118,
#                                                             l_xceb.xceb119,
#                                                             l_xceb.xceb120,
#                                                             l_xceb.xceb107,
#                                                             l_xceb.xceb108,
#                                                             l_xceb.xceb109,
#                                                             l_xceb.xceb121,
#                                                             l_xceb.xceb122,
#                                                             l_xceb.xceb123,
#                                                             l_xceb.xceb124,
#                                                             l_xceb.xceb125,
#                                                             l_xceb.xceb126,
#                                                             l_xceb.xceb127,
#                                                             l_xceb.xceb128,
#                                                             l_xceb.xceb129,
#                                                             l_xceb.xceb130
#
#      #如果金额和数量都为0的话，则不产生此笔单身数据                                                             
#      IF l_xceb.xceb201= 0 AND l_xceb.xceb202 = 0 THEN
#         CONTINUE FOREACH
#      END IF
#      #161109-00085#20-s mod
##      INSERT INTO xceb_t VALUES(l_xceb.*)   #161109-00085#20-s mark
#      #161109-00085#63 --s mark
#      #INSERT INTO xceb_t(xcebent,xcebcomp,xcebld,xcebdocno,xcebseq,xceb001,xceb002,xceb003,xceb004,
#      #                   xceb005,xceb101,xceb102,xceb103,xceb110,xceb111,xceb112,xceb113,xceb114,xceb115,
#      #                   xceb116,xceb117,xceb118,xceb119,xceb120,xceb201,xceb202,xceb202a,xceb202b,xceb202c,
#      #                   xceb202d,xceb202e,xceb202f,xceb202g,xceb202h,xceb212,xceb212a,xceb212b,xceb212c,
#      #                   xceb212d,xceb212e,xceb212f,xceb212g,xceb212h,xceb222,xceb222a,xceb222b,xceb222c,
#      #                   xceb222d,xceb222e,xceb222f,xceb222g,xceb222h,xceb301,xceb302,xceb107,xceb108,xceb109,
#      #                   xceb121,xceb122,xceb123,xceb124,xceb125,xceb126,xceb127,xceb128,xceb129,xceb130,xceb131,xceb132) 
#      #            VALUES(l_xceb.xcebent,l_xceb.xcebcomp,l_xceb.xcebld,l_xceb.xcebdocno,l_xceb.xcebseq,
#      #                   l_xceb.xceb001,l_xceb.xceb002,l_xceb.xceb003,l_xceb.xceb004,l_xceb.xceb005,
#      #                   l_xceb.xceb101,l_xceb.xceb102,l_xceb.xceb103,l_xceb.xceb110,l_xceb.xceb111,
#      #                   l_xceb.xceb112,l_xceb.xceb113,l_xceb.xceb114,l_xceb.xceb115,l_xceb.xceb116,
#      #                   l_xceb.xceb117,l_xceb.xceb118,l_xceb.xceb119,l_xceb.xceb120,l_xceb.xceb201,
#      #                   l_xceb.xceb202,l_xceb.xceb202a,l_xceb.xceb202b,l_xceb.xceb202c,l_xceb.xceb202d,
#      #                   l_xceb.xceb202e,l_xceb.xceb202f,l_xceb.xceb202g,l_xceb.xceb202h,l_xceb.xceb212,
#      #                   l_xceb.xceb212a,l_xceb.xceb212b,l_xceb.xceb212c,l_xceb.xceb212d,l_xceb.xceb212e,
#      #                   l_xceb.xceb212f,l_xceb.xceb212g,l_xceb.xceb212h,l_xceb.xceb222,l_xceb.xceb222a,
#      #                   l_xceb.xceb222b,l_xceb.xceb222c,l_xceb.xceb222d,l_xceb.xceb222e,l_xceb.xceb222f,
#      #                   l_xceb.xceb222g,l_xceb.xceb222h,l_xceb.xceb301,l_xceb.xceb302,l_xceb.xceb107,
#      #                   l_xceb.xceb108,l_xceb.xceb109,l_xceb.xceb121,l_xceb.xceb122,l_xceb.xceb123,
#      #                   l_xceb.xceb124,l_xceb.xceb125,l_xceb.xceb126,l_xceb.xceb127,l_xceb.xceb128,
#      #                   l_xceb.xceb129,l_xceb.xceb130,l_xceb.xceb131,l_xceb.xceb132)
#      #161109-00085#20-e mod
#      #161109-00085#63 --e mark
#      #161109-00085#63 --s add
#      INSERT INTO xceb_t(xcebent,xcebcomp,xcebld,xcebdocno,xcebseq,
#                         xceb001,xceb002,xceb003,xceb004,xceb005,
#                         xceb101,xceb102,xceb103,xceb110,xceb111,
#                         xceb112,xceb113,xceb114,xceb115,xceb116,
#                         xceb117,xceb118,xceb119,xceb120,xceb201,
#                         xceb202,xceb202a,xceb202b,xceb202c,xceb202d,
#                         xceb202e,xceb202f,xceb202g,xceb202h,xceb212,
#                         xceb212a,xceb212b,xceb212c,xceb212d,xceb212e,
#                         xceb212f,xceb212g,xceb212h,xceb222,xceb222a,
#                         xceb222b,xceb222c,xceb222d,xceb222e,xceb222f,
#                         xceb222g,xceb222h,xceb301,xceb302,xcebud001,
#                         xcebud002,xcebud003,xcebud004,xcebud005,xcebud006,
#                         xcebud007,xcebud008,xcebud009,xcebud010,xcebud011,
#                         xcebud012,xcebud013,xcebud014,xcebud015,xcebud016,
#                         xcebud017,xcebud018,xcebud019,xcebud020,xcebud021,
#                         xcebud022,xcebud023,xcebud024,xcebud025,xcebud026,
#                         xcebud027,xcebud028,xcebud029,xcebud030,xceb107,
#                         xceb108,xceb109,xceb121,xceb122,xceb123,
#                         xceb124,xceb125,xceb126,xceb127,xceb128,
#                         xceb129,xceb130,xceb131,xceb132)
#      VALUES(l_xceb.xcebent,l_xceb.xcebcomp,l_xceb.xcebld,l_xceb.xcebdocno,l_xceb.xcebseq,
#             l_xceb.xceb001,l_xceb.xceb002,l_xceb.xceb003,l_xceb.xceb004,l_xceb.xceb005,
#             l_xceb.xceb101,l_xceb.xceb102,l_xceb.xceb103,l_xceb.xceb110,l_xceb.xceb111,
#             l_xceb.xceb112,l_xceb.xceb113,l_xceb.xceb114,l_xceb.xceb115,l_xceb.xceb116,
#             l_xceb.xceb117,l_xceb.xceb118,l_xceb.xceb119,l_xceb.xceb120,l_xceb.xceb201,
#             l_xceb.xceb202,l_xceb.xceb202a,l_xceb.xceb202b,l_xceb.xceb202c,l_xceb.xceb202d,
#             l_xceb.xceb202e,l_xceb.xceb202f,l_xceb.xceb202g,l_xceb.xceb202h,l_xceb.xceb212,
#             l_xceb.xceb212a,l_xceb.xceb212b,l_xceb.xceb212c,l_xceb.xceb212d,l_xceb.xceb212e,
#             l_xceb.xceb212f,l_xceb.xceb212g,l_xceb.xceb212h,l_xceb.xceb222,l_xceb.xceb222a,
#             l_xceb.xceb222b,l_xceb.xceb222c,l_xceb.xceb222d,l_xceb.xceb222e,l_xceb.xceb222f,
#             l_xceb.xceb222g,l_xceb.xceb222h,l_xceb.xceb301,l_xceb.xceb302,l_xceb.xcebud001,
#             l_xceb.xcebud002,l_xceb.xcebud003,l_xceb.xcebud004,l_xceb.xcebud005,l_xceb.xcebud006,
#             l_xceb.xcebud007,l_xceb.xcebud008,l_xceb.xcebud009,l_xceb.xcebud010,l_xceb.xcebud011,
#             l_xceb.xcebud012,l_xceb.xcebud013,l_xceb.xcebud014,l_xceb.xcebud015,l_xceb.xcebud016,
#             l_xceb.xcebud017,l_xceb.xcebud018,l_xceb.xcebud019,l_xceb.xcebud020,l_xceb.xcebud021,
#             l_xceb.xcebud022,l_xceb.xcebud023,l_xceb.xcebud024,l_xceb.xcebud025,l_xceb.xcebud026,
#             l_xceb.xcebud027,l_xceb.xcebud028,l_xceb.xcebud029,l_xceb.xcebud030,l_xceb.xceb107,
#             l_xceb.xceb108,l_xceb.xceb109,l_xceb.xceb121,l_xceb.xceb122,l_xceb.xceb123,
#             l_xceb.xceb124,l_xceb.xceb125,l_xceb.xceb126,l_xceb.xceb127,l_xceb.xceb128,
#             l_xceb.xceb129,l_xceb.xceb130,l_xceb.xceb131,l_xceb.xceb132)
#      #161109-00085#63 --e add
#      IF SQLCA.sqlcode THEN
#         INITIALIZE g_errparam TO NULL
#         LET g_errparam.code = SQLCA.sqlcode
#         LET g_errparam.extend = "ins xceb_t"
#         LET g_errparam.popup = TRUE
#         CALL cl_err()
#         LET g_success = 'N'
#         EXIT FOREACH
#      END IF
#       
#      INITIALIZE l_xcec.* TO NULL
#     
#      SELECT MAX(xcecseq) INTO l_xcec.xcecseq FROM xcec_t
#       WHERE xcecent = g_enterprise AND xcecld = g_xcea_m.xceald
#         AND xcecdocno = g_xcea_m.xceadocno
#      IF cl_null(l_xcec.xcecseq) OR l_xcec.xcecseq = 0 THEN
#         LET l_xcec.xcecseq = 1
#      ELSE
#         LET l_xcec.xcecseq = l_xcec.xcecseq + 1
#      END IF 
#      
#      LET l_xcec.xcecent  = g_enterprise       #企業編號
#      LET l_xcec.xcecld   = g_xcea_m.xceald    #帳套
#      LET l_xcec.xceccomp = g_xcea_m.xceacomp  #法人組織
#      LET l_xcec.xcecdocno= g_xcea_m.xceadocno #單據編號
#      LET l_xcec.xcec001  = l_xceb.xceb001     #參考單據
#      LET l_xcec.xcec002  = l_xceb.xceb002     #參考單據項次
#      LET l_xcec.xcec003  = l_xceb.xceb003     #單據類型
#      LET l_xcec.xcec004  = l_xceb.xceb004     #料件編號
#      LET l_xcec.xcec005  = l_xceb.xceb005     #特性
#      
#      LET l_xcec.xcec101  = ''                 #科目編號
#      IF g_xcea002='11' THEN   #11转入 12转出
#         #存貨科目
#         CALL s_get_item_acc(g_xcea_m.xceald,'1',l_xcec.xcec004,'','',g_xcea_m.xceacomp,'') 
#           RETURNING l_success,l_xcec.xcec101
#      ELSE
#         #发出商品
#         CALL s_get_item_acc(g_xcea_m.xceald,'17',l_xcec.xcec004,'','',g_xcea_m.xceacomp,'') 
#           RETURNING l_success,l_xcec.xcec101 
#      END IF
#      
#      LET l_xcec.xcec102 = l_xceb.xceb102  #摘要
#      LET l_xcec.xcec103 = l_xceb.xceb103  #成本域
#      LET l_xcec.xcec110 = l_xceb.xceb110  #原因碼
#      LET l_xcec.xcec111 = l_xceb.xceb111  #交易對象
#      LET l_xcec.xcec112 = l_xceb.xceb112  #客群
#      LET l_xcec.xcec113 = l_xceb.xceb113  #區域
#      LET l_xcec.xcec114 = l_xceb.xceb114  #成本中心
#      LET l_xcec.xcec115 = l_xceb.xceb115  #經營類別
#      LET l_xcec.xcec116 = l_xceb.xceb116  #渠道
#      LET l_xcec.xcec117 = l_xceb.xceb117  #品類
#      LET l_xcec.xcec118 = l_xceb.xceb118  #品牌
#      LET l_xcec.xcec119 = l_xceb.xceb119  #項目號
#      LET l_xcec.xcec120 = l_xceb.xceb120  #WBS
#      LET l_xcec.xcec201 = l_xceb.xceb201  #數量
#      LET l_xcec.xcec202 = l_xceb.xceb202  #成本金額(本位幣一)
#      LET l_xcec.xcec202a= l_xceb.xceb202a #成本-材料(本位幣一)
#      LET l_xcec.xcec202b= l_xceb.xceb202b #成本-人工(本位幣一)
#      LET l_xcec.xcec202c= l_xceb.xceb202c #成本-加工(本位幣一)
#      LET l_xcec.xcec202d= l_xceb.xceb202d #成本-制費一(本位幣一)
#      LET l_xcec.xcec202e= l_xceb.xceb202e #成本-制費二(本位幣一)
#      LET l_xcec.xcec202f= l_xceb.xceb202f #成本-制費三(本位幣一)
#      LET l_xcec.xcec202g= l_xceb.xceb202g #成本-制費四(本位幣一)
#      LET l_xcec.xcec202h= l_xceb.xceb202h #成本-制費五(本位幣一)
#      LET l_xcec.xcec212 = l_xceb.xceb212  #成本-金額(本位幣二)
#      LET l_xcec.xcec212a= l_xceb.xceb212a
#      LET l_xcec.xcec212b= l_xceb.xceb212b
#      LET l_xcec.xcec212c= l_xceb.xceb212c
#      LET l_xcec.xcec212d= l_xceb.xceb212d
#      LET l_xcec.xcec212e= l_xceb.xceb212e
#      LET l_xcec.xcec212f= l_xceb.xceb212f
#      LET l_xcec.xcec212g= l_xceb.xceb212g
#      LET l_xcec.xcec212h= l_xceb.xceb212h
#      LET l_xcec.xcec222 = l_xceb.xceb222  #成本-金額(本位幣三)
#      LET l_xcec.xcec222a= l_xceb.xceb222a
#      LET l_xcec.xcec222b= l_xceb.xceb222b
#      LET l_xcec.xcec222c= l_xceb.xceb222c
#      LET l_xcec.xcec222d= l_xceb.xceb222d
#      LET l_xcec.xcec222e= l_xceb.xceb222e
#      LET l_xcec.xcec222f= l_xceb.xceb222f
#      LET l_xcec.xcec222g= l_xceb.xceb222g
#      LET l_xcec.xcec222h= l_xceb.xceb222h
#      LET l_xcec.xcec301 = l_xceb.xceb301  #憑證編號
#      LET l_xcec.xcec302 = l_xceb.xceb302  #憑證項次
#      #161109-00085#19-s mark
##      LET l_xcec.xcecud021 = '' #自定義欄位(日期時間)
##      LET l_xcec.xcecud022 = '' #自定義欄位(日期時間)
##      LET l_xcec.xcecud023 = '' #自定義欄位(日期時間)
##      LET l_xcec.xcecud024 = '' #自定義欄位(日期時間)
##      LET l_xcec.xcecud025 = '' #自定義欄位(日期時間)
##      LET l_xcec.xcecud026 = '' #自定義欄位(日期時間)
##      LET l_xcec.xcecud027 = '' #自定義欄位(日期時間)
##      LET l_xcec.xcecud028 = '' #自定義欄位(日期時間)
##      LET l_xcec.xcecud029 = '' #自定義欄位(日期時間)
##      LET l_xcec.xcecud030 = '' #自定義欄位(日期時間)
#      LET l_xcec.xcec107 = l_xceb.xceb107 #人員
#      LET l_xcec.xcec108 = l_xceb.xceb108 #部門
#      LET l_xcec.xcec109 = l_xceb.xceb109 #帳款對象
#      LET l_xcec.xcec121 = l_xceb.xceb121 #自由核算項1
#      LET l_xcec.xcec122 = l_xceb.xceb122 #自由核算項2
#      LET l_xcec.xcec123 = l_xceb.xceb123 #自由核算項3
#      LET l_xcec.xcec124 = l_xceb.xceb124 #自由核算項4
#      LET l_xcec.xcec125 = l_xceb.xceb125 #自由核算項5
#      LET l_xcec.xcec126 = l_xceb.xceb126 #自由核算項6
#      LET l_xcec.xcec127 = l_xceb.xceb127 #自由核算項7
#      LET l_xcec.xcec128 = l_xceb.xceb128 #自由核算項8
#      LET l_xcec.xcec129 = l_xceb.xceb129 #自由核算項9
#      LET l_xcec.xcec130 = l_xceb.xceb130 #自由核算項10
#     #160901-00005#1-s-mark
#     #CALL axct701_01_default_space_xceb(l_xceb.*) RETURNING l_xceb.xceb005,
#     #                                                       l_xceb.xceb101,
#     #                                                       l_xceb.xceb102,
#     #                                                       l_xceb.xceb103,
#     #                                                       l_xceb.xceb110,
#     #                                                       l_xceb.xceb111,
#     #                                                       l_xceb.xceb112,
#     #                                                       l_xceb.xceb113,
#     #                                                       l_xceb.xceb114,
#     #                                                       l_xceb.xceb115,
#     #                                                       l_xceb.xceb116,
#     #                                                       l_xceb.xceb117,
#     #                                                       l_xceb.xceb118,
#     #                                                       l_xceb.xceb119,
#     #                                                       l_xceb.xceb120,
#     #                                                       l_xceb.xceb107,
#     #                                                       l_xceb.xceb108,
#     #                                                       l_xceb.xceb109,
#     #                                                       l_xceb.xceb121,
#     #                                                       l_xceb.xceb122,
#     #                                                       l_xceb.xceb123,
#     #                                                       l_xceb.xceb124,
#     #                                                       l_xceb.xceb125,
#     #                                                       l_xceb.xceb126,
#     #                                                       l_xceb.xceb127,
#     #                                                       l_xceb.xceb128,
#     #                                                       l_xceb.xceb129,
#     #                                                       l_xceb.xceb130 
#     #160901-00005#1-e-mark                          
#     #160901-00005#1-s-add 
#      CALL axct701_01_default_space_xcec(l_xcec.*) RETURNING l_xcec.xcec005,   
#                                                             l_xcec.xcec101,
#                                                             l_xcec.xcec102,
#                                                             l_xcec.xcec103,
#                                                             l_xcec.xcec110,
#                                                             l_xcec.xcec111,
#                                                             l_xcec.xcec112,
#                                                             l_xcec.xcec113,
#                                                             l_xcec.xcec114,
#                                                             l_xcec.xcec115,
#                                                             l_xcec.xcec116,
#                                                             l_xcec.xcec117,
#                                                             l_xcec.xcec118,
#                                                             l_xcec.xcec119,
#                                                             l_xcec.xcec120,
#                                                             l_xcec.xcec107,
#                                                             l_xcec.xcec108,
#                                                             l_xcec.xcec109,
#                                                             l_xcec.xcec121,
#                                                             l_xcec.xcec122,
#                                                             l_xcec.xcec123,
#                                                             l_xcec.xcec124,
#                                                             l_xcec.xcec125,
#                                                             l_xcec.xcec126,
#                                                             l_xcec.xcec127,
#                                                             l_xcec.xcec128,
#                                                             l_xcec.xcec129,
#                                                             l_xcec.xcec130                                       
#     #160901-00005#1-e-add 
#     #如果金额和数量都为0的话，则不产生此笔单身数据                                                             
#      IF l_xcec.xcec201= 0 AND l_xcec.xcec202 = 0 THEN
#         CONTINUE FOREACH
#      END IF       
#      #161109-00085#20-s mod      
##      INSERT INTO xcec_t VALUES(l_xcec.*)   #161109-00085#20-s mark
#      #161109-00085#63 --s mark
#      #INSERT INTO xcec_t(xcecent,xceccomp,xcecld,xcecdocno,xcecseq,xcec001,xcec002,xcec003,xcec004,
#      #                   xcec005,xcec101,xcec102,xcec103,xcec110,xcec111,xcec112,xcec113,xcec114,
#      #                   xcec115,xcec116,xcec117,xcec118,xcec119,xcec120,xcec201,xcec202,xcec202a,
#      #                   xcec202b,xcec202c,xcec202d,xcec202e,xcec202f,xcec202g,xcec202h,xcec212,
#      #                   xcec212a,xcec212b,xcec212c,xcec212d,xcec212e,xcec212f,xcec212g,xcec212h,
#      #                   xcec222,xcec222a,xcec222b,xcec222c,xcec222d,xcec222e,xcec222f,xcec222g,
#      #                   xcec222h,xcec301,xcec302,xcec107,xcec108,xcec109,xcec121,xcec122,xcec123,
#      #                   xcec124,xcec125,xcec126,xcec127,xcec128,xcec129,xcec130) 
#      #            VALUES(l_xcec.xcecent,l_xcec.xceccomp,l_xcec.xcecld,l_xcec.xcecdocno,l_xcec.xcecseq,
#      #                   l_xcec.xcec001,l_xcec.xcec002,l_xcec.xcec003,l_xcec.xcec004,l_xcec.xcec005,
#      #                   l_xcec.xcec101,l_xcec.xcec102,l_xcec.xcec103,l_xcec.xcec110,l_xcec.xcec111,
#      #                   l_xcec.xcec112,l_xcec.xcec113,l_xcec.xcec114,l_xcec.xcec115,l_xcec.xcec116,
#      #                   l_xcec.xcec117,l_xcec.xcec118,l_xcec.xcec119,l_xcec.xcec120,l_xcec.xcec201,
#      #                   l_xcec.xcec202,l_xcec.xcec202a,l_xcec.xcec202b,l_xcec.xcec202c,l_xcec.xcec202d,
#      #                   l_xcec.xcec202e,l_xcec.xcec202f,l_xcec.xcec202g,l_xcec.xcec202h,l_xcec.xcec212,
#      #                   l_xcec.xcec212a,l_xcec.xcec212b,l_xcec.xcec212c,l_xcec.xcec212d,l_xcec.xcec212e,
#      #                   l_xcec.xcec212f,l_xcec.xcec212g,l_xcec.xcec212h,l_xcec.xcec222,l_xcec.xcec222a,
#      #                   l_xcec.xcec222b,l_xcec.xcec222c,l_xcec.xcec222d,l_xcec.xcec222e,l_xcec.xcec222f,
#      #                   l_xcec.xcec222g,l_xcec.xcec222h,l_xcec.xcec301,l_xcec.xcec302,l_xcec.xcec107,
#      #                   l_xcec.xcec108,l_xcec.xcec109,l_xcec.xcec121,l_xcec.xcec122,l_xcec.xcec123,
#      #                   l_xcec.xcec124,l_xcec.xcec125,l_xcec.xcec126,l_xcec.xcec127,l_xcec.xcec128,
#      #                   l_xcec.xcec129,l_xcec.xcec130)
#      #161109-00085#63 --e mark
#      #161109-00085#20-e mod
#      #161109-00085#63 --s add
#      INSERT INTO xcec_t(xcecent,xceccomp,xcecld,xcecdocno,xcecseq,
#                         xcec001,xcec002,xcec003,xcec004,xcec005,
#                         xcec101,xcec102,xcec103,xcec110,xcec111,
#                         xcec112,xcec113,xcec114,xcec115,xcec116,
#                         xcec117,xcec118,xcec119,xcec120,xcec201,
#                         xcec202,xcec202a,xcec202b,xcec202c,xcec202d,
#                         xcec202e,xcec202f,xcec202g,xcec202h,xcec212,
#                         xcec212a,xcec212b,xcec212c,xcec212d,xcec212e,
#                         xcec212f,xcec212g,xcec212h,xcec222,xcec222a,
#                         xcec222b,xcec222c,xcec222d,xcec222e,xcec222f,
#                         xcec222g,xcec222h,xcec301,xcec302,xcecud001,
#                         xcecud002,xcecud003,xcecud004,xcecud005,xcecud006,
#                         xcecud007,xcecud008,xcecud009,xcecud010,xcecud011,
#                         xcecud012,xcecud013,xcecud014,xcecud015,xcecud016,
#                         xcecud017,xcecud018,xcecud019,xcecud020,xcecud021,
#                         xcecud022,xcecud023,xcecud024,xcecud025,xcecud026,
#                         xcecud027,xcecud028,xcecud029,xcecud030,xcec107,
#                         xcec108,xcec109,xcec121,xcec122,xcec123,
#                         xcec124,xcec125,xcec126,xcec127,xcec128,
#                         xcec129,xcec130)
#      VALUES(l_xcec.xcecent,l_xcec.xceccomp,l_xcec.xcecld,l_xcec.xcecdocno,l_xcec.xcecseq,
#             l_xcec.xcec001,l_xcec.xcec002,l_xcec.xcec003,l_xcec.xcec004,l_xcec.xcec005,
#             l_xcec.xcec101,l_xcec.xcec102,l_xcec.xcec103,l_xcec.xcec110,l_xcec.xcec111,
#             l_xcec.xcec112,l_xcec.xcec113,l_xcec.xcec114,l_xcec.xcec115,l_xcec.xcec116,
#             l_xcec.xcec117,l_xcec.xcec118,l_xcec.xcec119,l_xcec.xcec120,l_xcec.xcec201,
#             l_xcec.xcec202,l_xcec.xcec202a,l_xcec.xcec202b,l_xcec.xcec202c,l_xcec.xcec202d,
#             l_xcec.xcec202e,l_xcec.xcec202f,l_xcec.xcec202g,l_xcec.xcec202h,l_xcec.xcec212,
#             l_xcec.xcec212a,l_xcec.xcec212b,l_xcec.xcec212c,l_xcec.xcec212d,l_xcec.xcec212e,
#             l_xcec.xcec212f,l_xcec.xcec212g,l_xcec.xcec212h,l_xcec.xcec222,l_xcec.xcec222a,
#             l_xcec.xcec222b,l_xcec.xcec222c,l_xcec.xcec222d,l_xcec.xcec222e,l_xcec.xcec222f,
#             l_xcec.xcec222g,l_xcec.xcec222h,l_xcec.xcec301,l_xcec.xcec302,l_xcec.xcecud001,
#             l_xcec.xcecud002,l_xcec.xcecud003,l_xcec.xcecud004,l_xcec.xcecud005,l_xcec.xcecud006,
#             l_xcec.xcecud007,l_xcec.xcecud008,l_xcec.xcecud009,l_xcec.xcecud010,l_xcec.xcecud011,
#             l_xcec.xcecud012,l_xcec.xcecud013,l_xcec.xcecud014,l_xcec.xcecud015,l_xcec.xcecud016,
#             l_xcec.xcecud017,l_xcec.xcecud018,l_xcec.xcecud019,l_xcec.xcecud020,l_xcec.xcecud021,
#             l_xcec.xcecud022,l_xcec.xcecud023,l_xcec.xcecud024,l_xcec.xcecud025,l_xcec.xcecud026,
#             l_xcec.xcecud027,l_xcec.xcecud028,l_xcec.xcecud029,l_xcec.xcecud030,l_xcec.xcec107,
#             l_xcec.xcec108,l_xcec.xcec109,l_xcec.xcec121,l_xcec.xcec122,l_xcec.xcec123,
#             l_xcec.xcec124,l_xcec.xcec125,l_xcec.xcec126,l_xcec.xcec127,l_xcec.xcec128,
#             l_xcec.xcec129,l_xcec.xcec130)
#      #161109-00085#63 --e add
#      
#      IF SQLCA.sqlcode THEN
#         INITIALIZE g_errparam TO NULL
#         LET g_errparam.code = SQLCA.sqlcode
#         LET g_errparam.extend = "ins xcec"
#         LET g_errparam.popup = TRUE
#         CALL cl_err()
#         LET g_success = 'N'
#         EXIT FOREACH
#      END IF
#      
#   END FOREACH   
#   RETURN g_success 
#161215-00040#2 Mark ---(E)---
END FUNCTION

 
{</section>}
 
