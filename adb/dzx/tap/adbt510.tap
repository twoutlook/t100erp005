<add_points prog="adbt510" std_prog="adbt510" erpver="1.0" module="ADB" ver="3" env="s" zone="t10dev" booking="Y" type="M" identity="s">
  <other>
    <code_template value="F" status="" />
    <free_style value="N" status="" />
  </other>
  <point name="function.adbt510_xrcd002_ref" cite_std="N" status="d" ver="2" src="s" new="Y" order="69" mark_hard="N">
<![CDATA[
PRIVATE FUNCTION adbt510_xrcd002_ref()
DEFINE l_ooef019      LIKE ooef_t.ooef019

#      SELECT ooef019 INTO l_ooef019 FROM ooef_t WHERE ooefent = g_enterprise AND ooef001 = g_xmee_m.xmeesite
#      INITIALIZE g_ref_fields TO NULL
#      LET g_ref_fields[1] = g_xmeg6_d[l_ac].xrcd002
#      CALL ap_ref_array2(g_ref_fields,"SELECT oodbl004 FROM oodbl_t WHERE oodblent='"||g_enterprise||"' AND oodbl001='"||l_ooef019||"' AND oodbl002=? AND oodbl003='"||g_dlang||"'","") RETURNING g_rtn_fields
#      LET g_xmeg6_d[l_ac].xrcd002_desc = '', g_rtn_fields[1] , ''
#      DISPLAY BY NAME g_xmeg6_d[l_ac].xrcd002_desc
END FUNCTION]]>
</point>
  <point name="function.adbt510_imaa0011_ref" cite_std="N" status="d" ver="2" src="s" new="Y" order="70" mark_hard="N">
<![CDATA[
PRIVATE FUNCTION adbt510_imaa0011_ref()
#      INITIALIZE g_ref_fields TO NULL
#      LET g_ref_fields[1] = g_xmeg6_d[l_ac].imaa0011
#      CALL ap_ref_array2(g_ref_fields,"SELECT imaal003,imaal004 FROM imaal_t WHERE imaalent='"||g_enterprise||"' AND imaal001=? AND imaal002='"||g_dlang||"'","") RETURNING g_rtn_fields
#      LET g_xmeg6_d[l_ac].imaa0011_desc = '', g_rtn_fields[1] , ''
#      LET g_xmeg6_d[l_ac].imaa0011_desc_desc = '', g_rtn_fields[2] , ''
#      DISPLAY BY NAME g_xmeg6_d[l_ac].imaa0011_desc
#      DISPLAY BY NAME g_xmeg6_d[l_ac].imaa0011_desc_desc
END FUNCTION]]>
</point>
  <point name="function.adbt510_xmee002_ref" cite_std="N" status="" ver="1" src="s" new="Y" order="1" mark_hard="N">
<![CDATA[#獲取員工編號說明
PRIVATE FUNCTION adbt510_xmee002_ref(p_xmee002)
DEFINE p_xmee002      LIKE xmee_t.xmee002
DEFINE r_xmee002_desc LIKE oofa_t.oofa011

       INITIALIZE g_ref_fields TO NULL
       LET g_ref_fields[1] = p_xmee002
       CALL ap_ref_array2(g_ref_fields,"SELECT oofa011 FROM oofa_t WHERE oofaent='"||g_enterprise||"' AND oofa002='2' AND oofa003=? ","") RETURNING g_rtn_fields
       LET r_xmee002_desc = '', g_rtn_fields[1] , ''
       RETURN r_xmee002_desc
END FUNCTION]]>
</point>
  <point name="function.adbt510_xmee003_chk" cite_std="N" status="" ver="1" src="s" new="Y" order="2" mark_hard="N">
<![CDATA[#部門檢查
PRIVATE FUNCTION adbt510_xmee003_chk(p_xmee003)
DEFINE p_xmee003      LIKE xmee_t.xmee003
DEFINE r_success   LIKE type_t.num5

       LET r_success = TRUE
       IF NOT cl_null(p_xmee003) THEN 
         #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
          INITIALIZE g_chkparam.* TO NULL
          
         #設定g_chkparam.*的參數
          LET g_chkparam.arg1 = p_xmee003
          LET g_chkparam.arg2 = g_xmee_m.xmeedocdt
  
         #呼叫檢查存在並帶值的library
          IF NOT cl_chk_exist("v_ooeg001") THEN
             LET r_success = FALSE
             RETURN r_success
          END IF
       END IF 
       RETURN r_success
END FUNCTION]]>
</point>
  <point name="function.adbt510_xmee003_ref" cite_std="N" status="" ver="1" src="s" new="Y" order="3" mark_hard="N">
<![CDATA[#獲取部門編號說明
PRIVATE FUNCTION adbt510_xmee003_ref(p_xmee003)
DEFINE p_xmee003      LIKE xmee_t.xmee003
DEFINE r_xmee003_desc LIKE ooefl_t.ooefl003

       INITIALIZE g_ref_fields TO NULL
       LET g_ref_fields[1] = p_xmee003
       CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
       LET r_xmee003_desc = '', g_rtn_fields[1] , ''
       RETURN r_xmee003_desc
END FUNCTION]]>
</point>
  <point name="function.adbt510_xmee004_ref" cite_std="N" status="" ver="1" src="s" new="Y" order="4" mark_hard="N">
<![CDATA[#帶出供應商說明
PRIVATE FUNCTION adbt510_xmee004_ref(p_xmee004)
DEFINE p_xmee004    LIKE xmee_t.xmee004
DEFINE r_pmaal004   LIKE pmaal_t.pmaal004

        INITIALIZE g_ref_fields TO NULL
        LET g_ref_fields[1] = p_xmee004
        CALL ap_ref_array2(g_ref_fields,"SELECT pmaal004 FROM pmaal_t WHERE pmaalent='"||g_enterprise||"' AND pmaal001=? AND pmaal002='"||g_dlang||"'","") RETURNING g_rtn_fields
        LET r_pmaal004 = '', g_rtn_fields[1] , ''
        RETURN r_pmaal004
END FUNCTION]]>
</point>
  <point name="function.adbt510_xmee009_ref" cite_std="N" status="" ver="1" src="s" new="Y" order="5" mark_hard="N">
<![CDATA[#收款條件顯示
PRIVATE FUNCTION adbt510_xmee009_ref(p_xmee009)
DEFINE p_xmee009      LIKE xmee_t.xmee009
DEFINE r_ooibl004     LIKE ooibl_t.ooibl004

       INITIALIZE g_ref_fields TO NULL
       LET g_ref_fields[1] = p_xmee009
       CALL ap_ref_array2(g_ref_fields,"SELECT ooibl004 FROM ooibl_t WHERE ooiblent='"||g_enterprise||"' AND ooibl002=? AND ooibl003='"||g_dlang||"'","") RETURNING g_rtn_fields
       LET r_ooibl004 = g_rtn_fields[1]
       RETURN r_ooibl004
END FUNCTION]]>
</point>
  <point name="function.adbt510_xmee010_ref" cite_std="N" status="" ver="1" src="s" new="Y" order="6" mark_hard="N">
<![CDATA[#交昜條件顯示
PRIVATE FUNCTION adbt510_xmee010_ref(p_xmee010)
DEFINE p_xmee010      LIKE xmee_t.xmee010
DEFINE r_oocql004     LIKE oocql_t.oocql004

       INITIALIZE g_ref_fields TO NULL
       LET g_ref_fields[1] = p_xmee010
       CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='238' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
       LET r_oocql004 = g_rtn_fields[1]
       RETURN r_oocql004
END FUNCTION]]>
</point>
  <point name="function.adbt510_xmee011_ref" cite_std="N" status="" ver="1" src="s" new="Y" order="7" mark_hard="N">
<![CDATA[#稅別顯示
PRIVATE FUNCTION adbt510_xmee011_ref(p_xmee011)
DEFINE p_xmee011      LIKE xmee_t.xmee011
DEFINE r_oodbl004     LIKE oodbl_t.oodbl004
DEFINE l_ooef019      LIKE ooef_t.ooef019

       SELECT ooef019 INTO l_ooef019 FROM ooef_t WHERE ooefent = g_enterprise AND ooef001 = g_xmee_m.xmeesite
       INITIALIZE g_ref_fields TO NULL
       LET g_ref_fields[1] = p_xmee011
       CALL ap_ref_array2(g_ref_fields,"SELECT oodbl004 FROM oodbl_t WHERE oodblent='"||g_enterprise||"' AND oodbl001='"||l_ooef019||"' AND oodbl002=? AND oodbl003='"||g_dlang||"'","") RETURNING g_rtn_fields
       LET r_oodbl004 = '', g_rtn_fields[1] , ''
       RETURN r_oodbl004
END FUNCTION]]>
</point>
  <point name="function.adbt510_xmee015_ref" cite_std="N" status="" ver="1" src="s" new="Y" order="8" mark_hard="N">
<![CDATA[#幣別顯示
PRIVATE FUNCTION adbt510_xmee015_ref(p_xmee015)
DEFINE p_xmee015      LIKE xmee_t.xmee015
DEFINE r_ooail003     LIKE ooail_t.ooail003

       INITIALIZE g_ref_fields TO NULL
       LET g_ref_fields[1] = p_xmee015
       CALL ap_ref_array2(g_ref_fields,"SELECT ooail003 FROM ooail_t WHERE ooailent='"||g_enterprise||"' AND ooail001=? AND ooail002='"||g_dlang||"'","") RETURNING g_rtn_fields
       LET r_ooail003 = '', g_rtn_fields[1] , ''
       RETURN r_ooail003
END FUNCTION]]>
</point>
  <point name="function.adbt510_xmee017_ref" cite_std="N" status="" ver="1" src="s" new="Y" order="9" mark_hard="N">
<![CDATA[#取價方式顯示
PRIVATE FUNCTION adbt510_xmee017_ref(p_xmee017)
DEFINE p_xmee017    LIKE xmee_t.xmee017
DEFINE r_pmaml003   LIKE pmaml_t.pmaml003

       INITIALIZE g_ref_fields TO NULL
       LET g_ref_fields[1] = p_xmee017
       CALL ap_ref_array2(g_ref_fields,"SELECT xmahl003 FROM xmahl_t WHERE xmahlent='"||g_enterprise||"' AND xmahl001=? AND xmahl002='"||g_dlang||"'","") RETURNING g_rtn_fields
       LET r_pmaml003 = '', g_rtn_fields[1] , ''
       RETURN r_pmaml003
       
END FUNCTION]]>
</point>
  <point name="function.adbt510_xmee018_ref" cite_std="N" status="" ver="1" src="s" new="Y" order="10" mark_hard="N">
<![CDATA[#付款條件顯示
PRIVATE FUNCTION adbt510_xmee018_ref(p_xmee018)
DEFINE p_xmee018    LIKE xmee_t.xmee018
DEFINE r_ooidl003   LIKE ooidl_t.ooidl003

       INITIALIZE g_ref_fields TO NULL
       LET g_ref_fields[1] = p_xmee018
       CALL ap_ref_array2(g_ref_fields,"SELECT ooidl003 FROM ooidl_t WHERE ooidlent='"||g_enterprise||"' AND ooidl001=? AND ooidl002='"||g_dlang||"'","") RETURNING g_rtn_fields
       LET r_ooidl003 = '', g_rtn_fields[1] , ''
       RETURN r_ooidl003
END FUNCTION]]>
</point>
  <point name="function.adbt510_xmee020_ref" cite_std="N" status="" ver="1" src="s" new="Y" order="11" mark_hard="N">
<![CDATA[#運送方式顯示
PRIVATE FUNCTION adbt510_xmee020_ref(p_xmee020)
DEFINE p_xmee020   LIKE xmee_t.xmee020
DEFINE r_oocql004  LIKE oocql_t.oocql004

       INITIALIZE g_ref_fields TO NULL
       LET g_ref_fields[1] = p_xmee020
       CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='263' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
       LET r_oocql004 = '', g_rtn_fields[1] , ''
       RETURN r_oocql004
END FUNCTION]]>
</point>
  <point name="function.adbt510_xmee023_ref" cite_std="N" status="" ver="1" src="s" new="Y" order="12" mark_hard="N">
<![CDATA[#銷售通路顯示
PRIVATE FUNCTION adbt510_xmee023_ref(p_xmee023)
DEFINE p_xmee023   LIKE xmee_t.xmee023
DEFINE r_oocql004  LIKE oocql_t.oocql004

       INITIALIZE g_ref_fields TO NULL
       LET g_ref_fields[1] = p_xmee023
       CALL ap_ref_array2(g_ref_fields,"SELECT oojdl003 FROM oojdl_t WHERE oojdlent='"||g_enterprise||"' AND oojdl001=? AND oojdl002='"||g_dlang||"'","") RETURNING g_rtn_fields
       LET r_oocql004 = '', g_rtn_fields[1] , ''
       RETURN r_oocql004   
       
END FUNCTION]]>
</point>
  <point name="function.adbt510_xmee024_ref" cite_std="N" status="" ver="1" src="s" new="Y" order="13" mark_hard="N">
<![CDATA[#銷售分類顯示
PRIVATE FUNCTION adbt510_xmee024_ref(p_xmee024)
DEFINE p_xmee024   LIKE xmee_t.xmee024
DEFINE r_oocql004  LIKE oocql_t.oocql004

       INITIALIZE g_ref_fields TO NULL
       LET g_ref_fields[1] = p_xmee024
       CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='295' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
       LET r_oocql004 = '', g_rtn_fields[1] , ''
       RETURN r_oocql004
END FUNCTION]]>
</point>
  <point name="function.adbt510_xmee024_chk" cite_std="N" status="" ver="1" src="s" new="Y" order="14" mark_hard="N">
<![CDATA[#銷售分類檢查
PRIVATE FUNCTION adbt510_xmee024_chk(p_xmee024)
DEFINE p_xmee024    LIKE xmee_t.xmee024
DEFINE r_success    LIKE type_t.num5

       LET r_success = TRUE

       IF NOT cl_null(p_xmee024) THEN
          IF NOT s_azzi650_chk_exist('295',p_xmee024) THEN
             LET r_success = FALSE
             RETURN r_success
          END IF
       END IF
       RETURN r_success
END FUNCTION]]>
</point>
  <point name="function.adbt510_xmee025_ref" cite_std="N" status="" ver="1" src="s" new="Y" order="15" mark_hard="N">
<![CDATA[#地址簡要說明
PRIVATE FUNCTION adbt510_xmee025_ref(p_pmaa027,p_oofb019)
DEFINE p_pmaa027   LIKE pmaa_t.pmaa025
DEFINE p_oofb019   LIKE oofb_t.oofb019
DEFINE r_oofb011   LIKE oofb_t.oofb011
       
       LET r_oofb011 =  ''
       SELECT oofb011 INTO r_oofb011 FROM oofb_t 
        WHERE oofbent = g_enterprise 
          AND oofb002 = p_pmaa027 
          AND oofb008 = '3' 
          AND oofb019 = p_oofb019
       RETURN r_oofb011
END FUNCTION]]>
</point>
  <point name="function.adbt510_xmee025_desc" cite_std="N" status="" ver="1" src="s" new="Y" order="16" mark_hard="N">
<![CDATA[
PRIVATE FUNCTION adbt510_xmee025_desc()
  DEFINE l_pmaa027   LIKE pmaa_t.pmaa027
  DEFINE r_address   STRING
  DEFINE r_success   LIKE type_t.num5     

      #收貨地址
      LET l_pmaa027 = ''
      LET r_address = '' 
      LET g_xmee_m.xmee025 = ''
      LET g_xmee_m.xmee025_desc = ''
      LET g_xmee_m.xmee206 = ''
      LET g_xmee_m.xmee207 = ''
      LET g_xmee_m.oofb017 = ''
      IF NOT cl_null(g_xmee_m.xmee022) THEN    
         CALL adbt510_get_pmaa027(g_xmee_m.xmee022) RETURNING l_pmaa027
         SELECT oofb019,oofb022 INTO g_xmee_m.xmee025,g_xmee_m.xmee206 FROM oofb_t
          WHERE oofbent = g_enterprise
            AND oofb002 = l_pmaa027 AND oofb008 = '3' 
            AND oofbstus = 'Y' AND oofb010 = 'Y' AND rownum = 1 
         IF cl_null(g_xmee_m.xmee025) THEN
            SELECT oofb019,oofb022 INTO g_xmee_m.xmee025,g_xmee_m.xmee206 FROM oofb_t
             WHERE oofbent = g_enterprise
               AND oofb002 = l_pmaa027 AND oofb008 = '3' 
               AND oofbstus = 'Y' AND rownum = 1      
         END IF 
         CALL adbt510_xmee025_ref(l_pmaa027,g_xmee_m.xmee025) RETURNING g_xmee_m.xmee025_desc
         
         IF NOT cl_null(g_xmee_m.xmee025) THEN
            CALL s_aooi350_get_address(l_pmaa027,g_xmee_m.xmee025,g_lang)RETURNING r_success,r_address
            LET g_xmee_m.oofb017 = r_address
         ELSE
            LET g_xmee_m.oofb017 = ''
         END IF
         
         IF NOT cl_null(g_xmee_m.xmee206) THEN
            SELECT dbaf001 INTO g_xmee_m.xmee207
              FROM dbaf_t
             WHERE dbafent = g_enterprise
               AND dbaf002 = '1'
               AND dbaf003 = g_xmee_m.xmee206 
               AND dbafstus = 'Y'
            IF cl_null(g_xmee_m.xmee207) THEN 
               SELECT dbaf001 INTO g_xmee_m.xmee207
                 FROM dbaf_t
                WHERE dbafent = g_enterprise
                  AND dbaf002 = '1'
                  AND dbaf003 = g_xmee_m.xmee206 
                  AND dbafstus = 'Y'
                  AND rownum = 1 
            END IF
         ELSE
            LET g_xmee_m.xmee207 = ''    
         END IF
      END IF
      DISPLAY BY NAME g_xmee_m.xmee025,g_xmee_m.xmee025_desc,
                      g_xmee_m.xmee206,g_xmee_m.xmee207,
                      g_xmee_m.oofb017
      CALL adbt510_xmee206_ref()
      CALL adbt510_xmee207_ref()
END FUNCTION]]>
</point>
  <point name="function.adbt510_xmee026_ref" cite_std="N" status="" ver="1" src="s" new="Y" order="17" mark_hard="N">
<![CDATA[
PRIVATE FUNCTION adbt510_xmee026_ref(p_pmaa027,p_oofb019)
DEFINE p_pmaa027   LIKE pmaa_t.pmaa025
DEFINE p_oofb019   LIKE oofb_t.oofb019
DEFINE r_oofb011   LIKE oofb_t.oofb011
       
       LET r_oofb011 =  ''
       SELECT oofb011 INTO r_oofb011 FROM oofb_t 
        WHERE oofbent = g_enterprise 
          AND oofb002 = p_pmaa027 
          AND oofb008 = '5' 
          AND oofb019 = p_oofb019
       RETURN r_oofb011
END FUNCTION]]>
</point>
  <point name="function.adbt510_xmee026_desc" cite_std="N" status="" ver="1" src="s" new="Y" order="18" mark_hard="N">
<![CDATA[
PRIVATE FUNCTION adbt510_xmee026_desc()
  DEFINE l_pmaa027   LIKE pmaa_t.pmaa027
  DEFINE r_address   STRING
  DEFINE r_success   LIKE type_t.num5  

      #收款地址
      LET l_pmaa027 = ''
      LET r_address = ''
      LET g_xmee_m.xmee026 = ''
      LET g_xmee_m.xmee026_desc = ''
      LET g_xmee_m.oofb017_1 = ''
      
      IF NOT cl_null(g_xmee_m.xmee021) THEN      
         CALL adbt510_get_pmaa027(g_xmee_m.xmee021) RETURNING l_pmaa027
         
         SELECT oofb019 INTO g_xmee_m.xmee026 FROM oofb_t
          WHERE oofbent = g_enterprise
            AND oofb002 = l_pmaa027  AND oofb008 = '5' 
            AND oofbstus = 'Y' AND oofb010 = 'Y' AND rownum = 1 
         IF cl_null(g_xmee_m.xmee026) THEN
            SELECT oofb019 INTO g_xmee_m.xmee026 FROM oofb_t
             WHERE oofbent = g_enterprise
               AND oofb002 = l_pmaa027 AND oofb008 = '5' 
               AND oofbstus = 'Y' AND rownum = 1      
         END IF
         CALL adbt510_xmee025_ref(l_pmaa027,g_xmee_m.xmee026) RETURNING g_xmee_m.xmee026_desc
         
         IF NOT cl_null(g_xmee_m.xmee026) THEN
            CALL s_aooi350_get_address(l_pmaa027,g_xmee_m.xmee026,g_lang)RETURNING r_success,r_address
            LET g_xmee_m.oofb017_1 = r_address
         ELSE
            LET g_xmee_m.oofb017_1 = ''
         END IF 
      END IF
      DISPLAY BY NAME g_xmee_m.xmee026,g_xmee_m.xmee026_desc 
      DISPLAY BY NAME g_xmee_m.oofb017_1
END FUNCTION]]>
</point>
  <point name="function.adbt510_xmee027_ref" cite_std="N" status="" ver="1" src="s" new="Y" order="19" mark_hard="N">
<![CDATA[
PRIVATE FUNCTION adbt510_xmee027_ref(p_xmee027)
DEFINE p_xmee027   LIKE xmee_t.xmee027
DEFINE r_oofa011   LIKE oofa_t.oofa011

       LET r_oofa011 = ''
       SELECT oofa011 INTO r_oofa011 FROM oofa_t WHERE oofaent=g_enterprise AND oofa001=p_xmee027
       RETURN r_oofa011
END FUNCTION]]>
</point>
  <point name="function.adbt510_xmee032_ref" cite_std="N" status="" ver="1" src="s" new="Y" order="20" mark_hard="N">
<![CDATA[#留置原因顯示
PRIVATE FUNCTION adbt510_xmee032_ref(p_xmee032)
DEFINE p_xmee032   LIKE xmee_t.xmee032
DEFINE r_oocql004  LIKE oocql_t.oocql004

       INITIALIZE g_ref_fields TO NULL
       LET g_ref_fields[1] = p_xmee032
       CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='297' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
       LET r_oocql004 = '', g_rtn_fields[1] , ''
       RETURN r_oocql004   
             
END FUNCTION]]>
</point>
  <point name="function.adbt510_xmee035_ref" cite_std="N" status="" ver="1" src="s" new="Y" order="21" mark_hard="N">
<![CDATA[#發票類型顯示
PRIVATE FUNCTION adbt510_xmee035_ref(p_xmee035)
DEFINE p_xmee035    LIKE xmee_t.xmee035
DEFINE r_isacl004   LIKE isacl_t.isacl004
DEFINE l_ooef019    LIKE ooef_t.ooef019
        
        IF NOT cl_null(g_xmee_m.xmeesite) THEN
           SELECT ooef019 INTO l_ooef019 FROM ooef_t WHERE ooefent = g_enterprise AND ooef001 = g_xmee_m.xmeesite
        ELSE
           SELECT ooef019 INTO l_ooef019 FROM ooef_t WHERE ooefent = g_enterprise AND ooef001 = g_site
        END IF
        
        INITIALIZE g_ref_fields TO NULL
        LET g_ref_fields[1] = p_xmee035
                    CALL ap_ref_array2(g_ref_fields,"SELECT isacl004 FROM isacl_t WHERE isaclent='"||g_enterprise||"' AND isacl001= '"||l_ooef019||"' AND isacl002=? AND isacl003='"||g_dlang||"'","") RETURNING g_rtn_fields
        LET r_isacl004 = '', g_rtn_fields[1] , ''
        RETURN r_isacl004
         
END FUNCTION]]>
</point>
  <point name="function.adbt510_xmeesite_ref" cite_std="N" status="" ver="2" src="s" new="Y" order="22" mark_hard="N">
<![CDATA[
PRIVATE FUNCTION adbt510_xmeesite_ref()
      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_xmee_m.xmeesite
      CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
      LET g_xmee_m.xmeesite_desc = '', g_rtn_fields[1] , ''
      DISPLAY BY NAME g_xmee_m.xmeesite_desc
END FUNCTION]]>
</point>
  <point name="function.adbt510_xmeeunit_ref" cite_std="N" status="" ver="2" src="s" new="Y" order="23" mark_hard="N">
<![CDATA[
PRIVATE FUNCTION adbt510_xmeeunit_ref()
      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_xmee_m.xmeeunit
      CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
      LET g_xmee_m.xmeeunit_desc = '', g_rtn_fields[1] , ''
      DISPLAY BY NAME g_xmee_m.xmeeunit_desc
END FUNCTION]]>
</point>
  <point name="function.adbt510_xmee200_ref" cite_std="N" status="" ver="2" src="s" new="Y" order="24" mark_hard="N">
<![CDATA[
PRIVATE FUNCTION adbt510_xmee200_ref()
      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_xmee_m.xmee200
      CALL ap_ref_array2(g_ref_fields,"SELECT pmaal004 FROM pmaal_t WHERE pmaalent='"||g_enterprise||"' AND pmaal001=? AND pmaal002='"||g_dlang||"'","") RETURNING g_rtn_fields
      LET g_xmee_m.xmee200_desc = '', g_rtn_fields[1] , ''
      DISPLAY BY NAME g_xmee_m.xmee200_desc
END FUNCTION]]>
</point>
  <point name="function.adbt510_xmee201_ref" cite_std="N" status="" ver="2" src="s" new="Y" order="25" mark_hard="N">
<![CDATA[
PRIVATE FUNCTION adbt510_xmee201_ref()
      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_xmee_m.xmee201
      CALL ap_ref_array2(g_ref_fields,"SELECT pmaal004 FROM pmaal_t WHERE pmaalent='"||g_enterprise||"' AND pmaal001=? AND pmaal002='"||g_dlang||"'","") RETURNING g_rtn_fields
      LET g_xmee_m.xmee201_desc = '', g_rtn_fields[1] , ''
      DISPLAY BY NAME g_xmee_m.xmee201_desc
END FUNCTION]]>
</point>
  <point name="function.adbt510_xmee202_ref" cite_std="N" status="" ver="2" src="s" new="Y" order="26" mark_hard="N">
<![CDATA[
PRIVATE FUNCTION adbt510_xmee202_ref()
      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_xmee_m.xmee202
      CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
      LET g_xmee_m.xmee202_desc = '', g_rtn_fields[1] , ''
      DISPLAY BY NAME g_xmee_m.xmee202_desc
END FUNCTION]]>
</point>
  <point name="function.adbt510_xmee202_chk" cite_std="N" status="" ver="2" src="s" new="Y" order="27" mark_hard="N">
<![CDATA[
PRIVATE FUNCTION adbt510_xmee202_chk()
DEFINE l_cnt     LIKE type_t.num5
DEFINE r_return  LIKE type_t.num5

      LET r_return = TRUE
      IF NOT cl_null(g_xmee_m.xmee202) 
         AND cl_null(g_xmee_m.xmee023) THEN
         SELECT COUNT(*)
           INTO l_cnt
           FROM dbbc_t
          WHERE dbbc002 = g_xmee_m.xmeesite
            AND dbbc005 = g_xmee_m.xmee202
          IF l_cnt = 0 THEN
             CALL cl_err("",'adb-00042',1)
             LET r_return = FALSE
             RETURN r_return
          END IF
      END IF
      IF NOT cl_null(g_xmee_m.xmee023) 
         AND cl_null(g_xmee_m.xmee202) THEN
         SELECT COUNT(*)
           INTO l_cnt
           FROM dbbc_t
          WHERE dbbc002 = g_xmee_m.xmeesite
            AND dbbc003 = g_xmee_m.xmee023
          IF l_cnt = 0 THEN
             CALL cl_err("",'adb-00042',1)
             LET r_return = FALSE
             RETURN r_return
          END IF
      END IF
      IF NOT cl_null(g_xmee_m.xmee202) 
         AND NOT cl_null(g_xmee_m.xmee023) THEN
         SELECT COUNT(*)
           INTO l_cnt
           FROM dbbc_t
          WHERE dbbc002 = g_xmee_m.xmeesite
            AND dbbc005 = g_xmee_m.xmee202
            AND dbbc003 = g_xmee_m.xmee023
          IF l_cnt = 0 THEN
             CALL cl_err("",'adb-00042',1)
             LET r_return = FALSE
             RETURN r_return
          END IF
      END IF
      RETURN r_return
END FUNCTION]]>
</point>
  <point name="function.adbt510_xmee203_ref" cite_std="N" status="" ver="2" src="s" new="Y" order="28" mark_hard="N">
<![CDATA[
PRIVATE FUNCTION adbt510_xmee203_ref()
      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_xmee_m.xmee203
      CALL ap_ref_array2(g_ref_fields,"SELECT pmaal004 FROM pmaal_t WHERE pmaalent='"||g_enterprise||"' AND pmaal001=? AND pmaal002='"||g_dlang||"'","") RETURNING g_rtn_fields
      LET g_xmee_m.xmee203_desc = '', g_rtn_fields[1] , ''
      DISPLAY BY NAME g_xmee_m.xmee203_desc
END FUNCTION]]>
</point>
  <point name="function.adbt510_xmee204_ref" cite_std="N" status="" ver="2" src="s" new="Y" order="29" mark_hard="N">
<![CDATA[
PRIVATE FUNCTION adbt510_xmee204_ref()
      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_xmee_m.xmee204
      CALL ap_ref_array2(g_ref_fields,"SELECT prcfl003 FROM prcfl_t WHERE prcflent='"||g_enterprise||"' AND prcfl001=? AND prcfl002='"||g_dlang||"'","") RETURNING g_rtn_fields
      LET g_xmee_m.xmee204_desc = '', g_rtn_fields[1] , ''
      DISPLAY BY NAME g_xmee_m.xmee204_desc
END FUNCTION]]>
</point>
  <point name="function.adbt510_xmee206_ref" cite_std="N" status="" ver="2" src="s" new="Y" order="30" mark_hard="N">
<![CDATA[
PRIVATE FUNCTION adbt510_xmee206_ref()
      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_xmee_m.xmee206
      CALL ap_ref_array2(g_ref_fields,"SELECT dbadl003 FROM dbadl_t WHERE dbadlent='"||g_enterprise||"' AND dbadl001=? AND dbadl002='"||g_dlang||"'","") RETURNING g_rtn_fields
      LET g_xmee_m.xmee206_desc = '', g_rtn_fields[1] , ''
      DISPLAY BY NAME g_xmee_m.xmee206_desc
END FUNCTION]]>
</point>
  <point name="function.adbt510_xmee207_ref" cite_std="N" status="" ver="2" src="s" new="Y" order="31" mark_hard="N">
<![CDATA[
PRIVATE FUNCTION adbt510_xmee207_ref()
      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_xmee_m.xmee207
      CALL ap_ref_array2(g_ref_fields,"SELECT dbabl003 FROM dbabl_t WHERE dbablent='"||g_enterprise||"' AND dbabl001=? AND dbabl002='"||g_dlang||"'","") RETURNING g_rtn_fields
      LET g_xmee_m.xmee207_desc = '', g_rtn_fields[1] , ''
      DISPLAY BY NAME g_xmee_m.xmee207_desc
END FUNCTION]]>
</point>
  <point name="function.adbt510_xmeg001_ref" cite_std="N" status="" ver="2" src="s" new="Y" order="32" mark_hard="N">
<![CDATA[#料件編號帶品名、規格
PRIVATE FUNCTION adbt510_xmeg001_ref(p_xmeg001)
DEFINE p_xmeg001     LIKE xmeg_t.xmeg001
DEFINE r_imaal003    LIKE imaal_t.imaal003
DEFINE r_imaal004    LIKE imaal_t.imaal004

       INITIALIZE g_ref_fields TO NULL
       LET g_ref_fields[1] = p_xmeg001
       CALL ap_ref_array2(g_ref_fields,"SELECT imaal003,imaal004 FROM imaal_t WHERE imaalent='"||g_enterprise||"' AND imaal001=? AND imaal002='"||g_dlang||"'","") RETURNING g_rtn_fields
       LET r_imaal003 = '', g_rtn_fields[1] , ''
       LET r_imaal004 = '', g_rtn_fields[2] , ''
       RETURN r_imaal003,r_imaal004
END FUNCTION]]>
</point>
  <point name="function.adbt510_xmeg003_ref" cite_std="N" status="" ver="2" src="s" new="Y" order="33" mark_hard="N">
<![CDATA[#包裝容器顯示
PRIVATE FUNCTION adbt510_xmeg003_ref(p_xmeg003)
DEFINE p_xmeg003     LIKE xmeg_t.xmeg003
DEFINE r_imaal003    LIKE imaal_t.imaal003

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = p_xmeg003
            CALL ap_ref_array2(g_ref_fields,"SELECT imaal003 FROM imaal_t WHERE imaalent='"||g_enterprise||"' AND imaal001=? AND imaal002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET  r_imaal003 = '', g_rtn_fields[1] , ''
            RETURN r_imaal003

END FUNCTION]]>
</point>
  <point name="function.adbt510_xmeg004_ref" cite_std="N" status="" ver="2" src="s" new="Y" order="34" mark_hard="N">
<![CDATA[#作業編號說明
PRIVATE FUNCTION adbt510_xmeg004_ref(p_xmeg004)
DEFINE p_xmeg004   LIKE xmeg_t.xmeg004
DEFINE r_oocql004  LIKE oocql_t.oocql004

       INITIALIZE g_ref_fields TO NULL
       LET g_ref_fields[1] = p_xmeg004
       CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='221' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
       LET r_oocql004 = '', g_rtn_fields[1] , ''
       RETURN r_oocql004
END FUNCTION]]>
</point>
  <point name="function.adbt510_xmeg012_to_xmeg020" cite_std="N" status="" ver="2" src="s" new="Y" order="35" mark_hard="N">
<![CDATA[#根據交貨日期計算緊急度
PRIVATE FUNCTION adbt510_xmeg012_to_xmeg020()
DEFINE l_imae071    LIKE imae_t.imae071  #固定
DEFINE l_imae072    LIKE imae_t.imae072  #變動
DEFINE l_imae074    LIKE imae_t.imae074  #QC
DEFINE l_imae076    LIKE imae_t.imae076  #嚴守交期前置時間
DEFINE l_time1      LIKE imaf_t.imaf171
DEFINE l_time2      LIKE imaf_t.imaf171

        IF NOT cl_null(g_xmeg_d[l_ac].xmeg012) THEN
           LET l_imae071 = 0   
           LET l_imae072 = 0   
           LET l_imae074 = 0  
           LET l_imae076 = 0             
           LET l_time1 = 0
           LET l_time2 = 0

          SELECT imae071,imae072,imae074,imae076 
            INTO l_imae071,l_imae072,l_imae074,l_imae076
            FROM imae_t
           WHERE imaeent = g_enterprise AND imaesite = g_xmee_m.xmeesite 
             AND imae001 = g_xmeg_d[l_ac].xmeg001

          LET l_time1 = g_xmeg_d[l_ac].xmeg012 - g_today      #交貨日期  - g_today
          LET l_time2 = l_imae071 + l_imae072 + l_imae074     #[T:料件據點生管資料檔]設置的(固定+變動+QC)前置天數

          #若輸入的交貨日期 - g_today > [T:料件據點生管資料檔]設置的(固定+變動+QC)前置天數，則[C:緊急度] = '1'(一般)
          IF l_time1 >= l_time2 THEN
             LET g_xmeg_d[l_ac].xmeg020 = '1'
          END IF

          #若輸入的交貨日期 - g_today < [T:料件據點生管資料檔]設置的(固定+變動+QC)前置天數，
          #且約定交貨日期 - g_today >[T:料件據點生管資料檔].[C:嚴守交期前置時間]時，則[C:緊急度] = '2'(緊急)
          IF l_time1 < l_time2 AND l_time1 >= l_imae076 THEN
             LET g_xmeg_d[l_ac].xmeg020 = '2'
          END IF

          #若約定交貨日期 - g_today <[T:料件據點生管資料檔].[C:嚴守交期前置時間]時，則[C:緊急度] = '3'(特急)
          IF l_time1 < l_imae076 THEN
             LET g_xmeg_d[l_ac].xmeg020 = '3'
          END IF
       END IF
END FUNCTION]]>
</point>
  <point name="function.adbt510_xmeg049_ref" cite_std="N" status="" ver="2" src="s" new="Y" order="36" mark_hard="N">
<![CDATA[#理由碼帶值
PRIVATE FUNCTION adbt510_xmeg049_ref(p_xmeg049)
DEFINE p_xmeg049  LIKE xmeg_t.xmeg049
DEFINE r_oocql004 LIKE oocql_t.oocql004

        INITIALIZE g_ref_fields TO NULL
        LET g_ref_fields[1] = p_xmeg049
        CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='"||g_acc||"' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
        LET r_oocql004 = '', g_rtn_fields[1] , ''
        RETURN r_oocql004
END FUNCTION]]>
</point>
  <point name="function.adbt510_xmeg049_chk" cite_std="N" status="" ver="2" src="s" new="Y" order="37" mark_hard="N">
<![CDATA[#檢查理由碼
PRIVATE FUNCTION adbt510_xmeg049_chk(p_xmeg049)
DEFINE p_xmeg049  LIKE xmeg_t.xmeg049
DEFINE l_success  LIKE type_t.num5
DEFINE r_success  LIKE type_t.num5
DEFINE l_flag     LIKE type_t.num5

        LET r_success = TRUE
        
        IF NOT cl_null(p_xmeg049) THEN
           CALL s_azzi650_chk_exist(g_acc,p_xmeg049) RETURNING l_success
           IF NOT l_success THEN
               LET r_success = FALSE
               RETURN r_success
           END IF
           
           #檢核輸入的理由碼是否在單據別限制範圍內，若不在限制內則不允許使用此理由碼
           CALL s_control_chk_doc('8',g_xmee_m.xmeedocno,p_xmeg049,'','','','') RETURNING l_success,l_flag
           IF NOT r_success THEN
              LET r_success = FALSE
              RETURN r_success
           ELSE
              IF NOT l_flag THEN
                 LET r_success = FALSE
                 RETURN r_success
              END IF
           END IF
        END IF           
        RETURN r_success
END FUNCTION]]>
</point>
  <point name="function.adbt510_xmegunit_chk" cite_std="N" status="" ver="2" src="s" new="Y" order="38" mark_hard="N">
<![CDATA[#檢查營運據點
PRIVATE FUNCTION adbt510_xmegunit_chk(p_xmegunit)
DEFINE p_xmegunit   LIKE xmeg_t.xmegunit
DEFINE l_success    LIKE type_t.num5
DEFINE l_flag       LIKE type_t.num5
DEFINE r_success    LIKE type_t.num5

       LET r_success = TRUE
       
       IF NOT cl_null(p_xmegunit) THEN 
          #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
          INITIALIZE g_chkparam.* TO NULL
          
          #設定g_chkparam.*的參數
          LET g_chkparam.arg1 = p_xmegunit
      
          #呼叫檢查存在並帶值的library
          IF NOT cl_chk_exist("v_ooef001") THEN
             LET r_success = FALSE
             RETURN r_success
          END IF
          #檢核輸入的營運據點是否在採購控制組的限制範圍內
          CALL s_control_chk_group('5','2',g_user,g_dept,p_xmegunit ,'','','','') RETURNING l_success,l_flag
          IF NOT l_success THEN      #處理狀況
             LET r_success = FALSE
             RETURN r_success
          ELSE
             IF NOT l_flag THEN      #是否存在
                CALL cl_err(p_xmegunit,'apm-00274',1)
                LET r_success = FALSE
                RETURN r_success
             END IF 
          END IF
       END IF 
       RETURN r_success
END FUNCTION]]>
</point>
  <point name="function.adbt510_xmjb003_ref" cite_std="N" status="" ver="2" src="s" new="Y" order="39" mark_hard="N">
<![CDATA[
PRIVATE FUNCTION adbt510_xmjb003_ref()
      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_xmeg4_d[l_ac].xmjb003
      CALL ap_ref_array2(g_ref_fields,"SELECT imaal003,imaal004 FROM imaal_t WHERE imaalent='"||g_enterprise||"' AND imaal001=? AND imaal002='"||g_dlang||"'","") RETURNING g_rtn_fields
      LET g_xmeg4_d[l_ac].xmjb003_desc = '', g_rtn_fields[1] , ''
      LET g_xmeg4_d[l_ac].xmjb003_desc_desc = '', g_rtn_fields[2] , ''
      #DISPLAY BY NAME g_xmeg4_d[l_ac].xmjb003_desc
      #DISPLAY BY NAME g_xmeg4_d[l_ac].xmjb003_desc_desc
END FUNCTION]]>
</point>
  <point name="function.adbt510_xmjb005_ref" cite_std="N" status="" ver="2" src="s" new="Y" order="40" mark_hard="N">
<![CDATA[
PRIVATE FUNCTION adbt510_xmjb005_ref()
      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_xmeg4_d[l_ac].xmjb005
      CALL ap_ref_array2(g_ref_fields,"SELECT prcfl003 FROM prcfl_t WHERE prcflent='"||g_enterprise||"' AND prcfl001=? AND prcfl002='"||g_dlang||"'","") RETURNING g_rtn_fields
      LET g_xmeg4_d[l_ac].xmjb005_desc = '', g_rtn_fields[1] , ''
      #DISPLAY BY NAME g_xmeg4_d[l_ac].xmjb005_desc
END FUNCTION]]>
</point>
  <point name="function.adbt510_xmjb006_ref" cite_std="N" status="" ver="2" src="s" new="Y" order="41" mark_hard="N">
<![CDATA[
PRIVATE FUNCTION adbt510_xmjb006_ref()
DEFINE l_ooef019      LIKE ooef_t.ooef019

      SELECT ooef019 INTO l_ooef019 FROM ooef_t WHERE ooefent = g_enterprise AND ooef001 = g_xmee_m.xmeesite
      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_xmeg4_d[l_ac].xmjb006
      CALL ap_ref_array2(g_ref_fields,"SELECT oodbl004 FROM oodbl_t WHERE oodblent='"||g_enterprise||"' AND oodbl001='"||l_ooef019||"' AND oodbl002=? AND oodbl003='"||g_dlang||"'","") RETURNING g_rtn_fields
      LET g_xmeg4_d[l_ac].xmjb006_desc = '', g_rtn_fields[1] , ''
      #DISPLAY BY NAME g_xmeg4_d[l_ac].xmjb006_desc
END FUNCTION]]>
</point>
  <point name="function.adbt510_xmjb011_ref" cite_std="N" status="" ver="2" src="s" new="Y" order="42" mark_hard="N">
<![CDATA[
PRIVATE FUNCTION adbt510_xmjb011_ref()
      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_xmeg4_d[l_ac].xmjb011
      CALL ap_ref_array2(g_ref_fields,"SELECT oocal003 FROM oocal_t WHERE oocalent='"||g_enterprise||"' AND oocal001=? AND oocal002='"||g_dlang||"'","") RETURNING g_rtn_fields
      LET g_xmeg4_d[l_ac].xmjb011_desc = '', g_rtn_fields[1] , ''
      #DISPLAY BY NAME g_xmeg4_d[l_ac].xmjb011_desc
END FUNCTION]]>
</point>
  <point name="function.adbt510_xmjb013_ref" cite_std="N" status="" ver="2" src="s" new="Y" order="43" mark_hard="N">
<![CDATA[
PRIVATE FUNCTION adbt510_xmjb013_ref()
      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_xmeg4_d[l_ac].xmjb013
      CALL ap_ref_array2(g_ref_fields,"SELECT oocal003 FROM oocal_t WHERE oocalent='"||g_enterprise||"' AND oocal001=? AND oocal002='"||g_dlang||"'","") RETURNING g_rtn_fields
      LET g_xmeg4_d[l_ac].xmjb013_desc = '', g_rtn_fields[1] , ''
      #DISPLAY BY NAME g_xmeg4_d[l_ac].xmjb013_desc
END FUNCTION]]>
</point>
  <point name="function.adbt510_xmjb015_ref" cite_std="N" status="" ver="2" src="s" new="Y" order="44" mark_hard="N">
<![CDATA[
PRIVATE FUNCTION adbt510_xmjb015_ref()
      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_xmeg4_d[l_ac].xmjb015
      CALL ap_ref_array2(g_ref_fields,"SELECT oocal003 FROM oocal_t WHERE oocalent='"||g_enterprise||"' AND oocal001=? AND oocal002='"||g_dlang||"'","") RETURNING g_rtn_fields
      LET g_xmeg4_d[l_ac].xmjb015_desc = '', g_rtn_fields[1] , ''
      #DISPLAY BY NAME g_xmeg4_d[l_ac].xmjb015_desc
END FUNCTION]]>
</point>
  <point name="function.adbt510_xmjb017_ref" cite_std="N" status="" ver="2" src="s" new="Y" order="45" mark_hard="N">
<![CDATA[
PRIVATE FUNCTION adbt510_xmjb017_ref()
      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_xmeg4_d[l_ac].xmjb017
      CALL ap_ref_array2(g_ref_fields,"SELECT oocal003 FROM oocal_t WHERE oocalent='"||g_enterprise||"' AND oocal001=? AND oocal002='"||g_dlang||"'","") RETURNING g_rtn_fields
      LET g_xmeg4_d[l_ac].xmjb017_desc = '', g_rtn_fields[1] , ''
      #DISPLAY BY NAME g_xmeg4_d[l_ac].xmjb017_desc
END FUNCTION]]>
</point>
  <point name="function.adbt510_xmjb024_ref" cite_std="N" status="" ver="2" src="s" new="Y" order="46" mark_hard="N">
<![CDATA[
PRIVATE FUNCTION adbt510_xmjb024_ref()
      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_xmeg4_d[l_ac].xmjb024
      CALL ap_ref_array2(g_ref_fields,"SELECT pmaal004 FROM pmaal_t WHERE pmaalent='"||g_enterprise||"' AND pmaal001=? AND pmaal002='"||g_dlang||"'","") RETURNING g_rtn_fields
      LET g_xmeg4_d[l_ac].xmjb024_desc = '', g_rtn_fields[1] , ''
      #DISPLAY BY NAME g_xmeg4_d[l_ac].xmjb024_desc
END FUNCTION]]>
</point>
  <point name="function.adbt510_xmjb024_desc" cite_std="N" status="" ver="2" src="s" new="Y" order="47" mark_hard="N">
<![CDATA[
PRIVATE FUNCTION adbt510_xmjb024_desc()
  DEFINE l_pmaa027   LIKE pmaa_t.pmaa027  
      
      #送貨地址
      LET l_pmaa027 = ''                                      
      CALL adbt510_get_pmaa027(g_xmeg4_d[l_ac].xmjb025) RETURNING l_pmaa027
      SELECT oofb019,oofb022 INTO g_xmeg4_d[l_ac].xmjb026,g_xmeg4_d[l_ac].xmjb027 FROM oofb_t
       WHERE oofbent = g_enterprise
         AND oofb002 = l_pmaa027 AND oofb008 = '3' 
         AND oofbstus = 'Y' AND oofb010 = 'Y' AND rownum = 1 

      CALL adbt510_xmjb026_ref()
      #CALL adbt510_xmjb027_ref()
END FUNCTION]]>
</point>
  <point name="function.adbt510_xmjb026_ref" cite_std="N" status="" ver="2" src="s" new="Y" order="48" mark_hard="N">
<![CDATA[
PRIVATE FUNCTION adbt510_xmjb026_ref()
  DEFINE l_pmaa027   LIKE pmaa_t.pmaa027
  DEFINE r_address   STRING
  DEFINE r_success   LIKE type_t.num5  
  
      LET l_pmaa027 = ''
      LET r_address = ''                                       
      CALL adbt510_get_pmaa027(g_xmeg4_d[l_ac].xmjb025) RETURNING l_pmaa027
      IF NOT cl_null(g_xmeg4_d[l_ac].xmjb026) THEN
         CALL s_aooi350_get_address(l_pmaa027,g_xmeg4_d[l_ac].xmjb026,g_lang)RETURNING r_success,r_address
         LET g_xmeg4_d[l_ac].xmjb026_desc = r_address
         #DISPLAY BY NAME g_xmeg4_d[l_ac].xmjb026_desc
      ELSE
         LET g_xmeg4_d[l_ac].xmjb026_desc = ''
        # DISPLAY BY NAME g_xmeg4_d[l_ac].xmjb026_desc
      END IF
END FUNCTION]]>
</point>
  <point name="function.adbt510_xmjb027_ref" cite_std="N" status="" ver="2" src="s" new="Y" order="49" mark_hard="N">
<![CDATA[
PRIVATE FUNCTION adbt510_xmjb027_ref()
      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_xmeg4_d[l_ac].xmjb027
      CALL ap_ref_array2(g_ref_fields,"SELECT dbadl003 FROM dbadl_t WHERE dbadlent='"||g_enterprise||"' AND dbadl001=? AND dbadl002='"||g_dlang||"'","") RETURNING g_rtn_fields
      LET g_xmeg4_d[l_ac].xmjb027_desc = '', g_rtn_fields[1] , ''
      #DISPLAY BY NAME g_xmeg4_d[l_ac].xmjb027_desc
END FUNCTION]]>
</point>
  <point name="function.adbt510_xmjbsite_ref" cite_std="N" status="" ver="2" src="s" new="Y" order="50" mark_hard="N">
<![CDATA[
PRIVATE FUNCTION adbt510_xmjbsite_ref()
      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_xmeg4_d[l_ac].xmjbsite
      CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
      LET g_xmeg4_d[l_ac].xmjbsite_desc = '', g_rtn_fields[1] , ''
      #DISPLAY BY NAME g_xmeg4_d[l_ac].xmjbsite_desc
END FUNCTION]]>
</point>
  <point name="function.adbt510_xmeh001_ref" cite_std="N" status="" ver="2" src="s" new="Y" order="51" mark_hard="N">
<![CDATA[
PRIVATE FUNCTION adbt510_xmeh001_ref()
      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_xmeg3_d[l_ac].xmeh001
      CALL ap_ref_array2(g_ref_fields,"SELECT imaal003,imaal004 FROM imaal_t WHERE imaalent='"||g_enterprise||"' AND imaal001=? AND imaal002='"||g_dlang||"'","") RETURNING g_rtn_fields
      LET g_xmeg3_d[l_ac].xmeh001_desc = '', g_rtn_fields[1] , ''
      LET g_xmeg3_d[l_ac].xmeh001_desc_desc = '', g_rtn_fields[2] , ''
      DISPLAY BY NAME g_xmeg3_d[l_ac].xmeh001_desc
      DISPLAY BY NAME g_xmeg3_d[l_ac].xmeh001_desc_desc
END FUNCTION]]>
</point>
  <point name="function.adbt510_xmehunit_ref" cite_std="N" status="" ver="2" src="s" new="Y" order="52" mark_hard="N">
<![CDATA[
PRIVATE FUNCTION adbt510_xmehunit_ref()
      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_xmeg3_d[l_ac].xmehunit
      CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
      LET g_xmeg3_d[l_ac].xmehunit_desc = '', g_rtn_fields[1] , ''
      DISPLAY BY NAME g_xmeg3_d[l_ac].xmehunit_desc
END FUNCTION]]>
</point>
  <point name="function.adbt510_xmeh200_ref" cite_std="N" status="" ver="2" src="s" new="Y" order="53" mark_hard="N">
<![CDATA[
PRIVATE FUNCTION adbt510_xmeh200_ref()
      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_xmeg3_d[l_ac].xmeh200
      CALL ap_ref_array2(g_ref_fields,"SELECT prcfl003 FROM prcfl_t WHERE prcflent='"||g_enterprise||"' AND prcfl001=? AND prcfl002='"||g_dlang||"'","") RETURNING g_rtn_fields
      LET g_xmeg3_d[l_ac].xmeh200_desc = '', g_rtn_fields[1] , ''
      DISPLAY BY NAME g_xmeg3_d[l_ac].xmeh200_desc
END FUNCTION]]>
</point>
  <point name="function.adbt510_xmeh201_ref" cite_std="N" status="" ver="2" src="s" new="Y" order="54" mark_hard="N">
<![CDATA[
PRIVATE FUNCTION adbt510_xmeh201_ref()
      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_xmeg3_d[l_ac].xmeh201
      CALL ap_ref_array2(g_ref_fields,"SELECT oocal003 FROM oocal_t WHERE oocalent='"||g_enterprise||"' AND oocal001=? AND oocal002='"||g_dlang||"'","") RETURNING g_rtn_fields
      LET g_xmeg3_d[l_ac].xmeh201_desc = '', g_rtn_fields[1] , ''
      DISPLAY BY NAME g_xmeg3_d[l_ac].xmeh201_desc
END FUNCTION]]>
</point>
  <point name="function.adbt510_xmeh207_ref" cite_std="N" status="" ver="2" src="s" new="Y" order="55" mark_hard="N">
<![CDATA[
PRIVATE FUNCTION adbt510_xmeh207_ref()
      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_xmeg3_d[l_ac].xmeh207
      CALL ap_ref_array2(g_ref_fields,"SELECT pmaal004 FROM pmaal_t WHERE pmaalent='"||g_enterprise||"' AND pmaal001=? AND pmaal002='"||g_dlang||"'","") RETURNING g_rtn_fields
      LET g_xmeg3_d[l_ac].xmeh207_desc = '', g_rtn_fields[1] , ''
      DISPLAY BY NAME g_xmeg3_d[l_ac].xmeh207_desc
END FUNCTION]]>
</point>
  <point name="function.adbt510_xmeh210_ref" cite_std="N" status="" ver="2" src="s" new="Y" order="56" mark_hard="N">
<![CDATA[
PRIVATE FUNCTION adbt510_xmeh210_ref()
      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_xmeg3_d[l_ac].xmeh210
      CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='274' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
      LET g_xmeg3_d[l_ac].xmeh210_desc = '', g_rtn_fields[1] , ''
      DISPLAY BY NAME g_xmeg3_d[l_ac].xmeh210_desc
END FUNCTION]]>
</point>
  <point name="function.adbt510_xmeh213_ref" cite_std="N" status="" ver="2" src="s" new="Y" order="57" mark_hard="N">
<![CDATA[
PRIVATE FUNCTION adbt510_xmeh213_ref()
      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_xmeg3_d[l_ac].xmeh213
      LET g_ref_fields[2] = g_xmeg3_d[l_ac].xmehunit
      CALL ap_ref_array2(g_ref_fields,"SELECT inaa002 FROM inaa_t WHERE inaaent='"||g_enterprise||"' AND inaa001=?  AND inaasite=? ","") RETURNING g_rtn_fields
      LET g_xmeg3_d[l_ac].xmeh213_desc = '', g_rtn_fields[1] , ''
      DISPLAY BY NAME g_xmeg3_d[l_ac].xmeh213_desc
END FUNCTION]]>
</point>
  <point name="function.adbt510_xmeh214_ref" cite_std="N" status="" ver="2" src="s" new="Y" order="58" mark_hard="N">
<![CDATA[
PRIVATE FUNCTION adbt510_xmeh214_ref()
      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_xmeg3_d[l_ac].xmeh213
      LET g_ref_fields[2] = g_xmeg3_d[l_ac].xmeh214
      LET g_ref_fields[3] = g_xmeg3_d[l_ac].xmehunit
      CALL ap_ref_array2(g_ref_fields,"SELECT inab003 FROM inab_t WHERE inabent='"||g_enterprise||"' AND inab001=? AND inab002=? AND inabsite=? ","") RETURNING g_rtn_fields
      LET g_xmeg3_d[l_ac].xmeh214_desc = '', g_rtn_fields[1] , ''
      DISPLAY BY NAME g_xmeg3_d[l_ac].xmeh214_desc
END FUNCTION]]>
</point>
  <point name="function.adbt510_xmeh218_ref" cite_std="N" status="" ver="2" src="s" new="Y" order="59" mark_hard="N">
<![CDATA[
PRIVATE FUNCTION adbt510_xmeh218_ref()
      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] =  g_xmeg3_d[l_ac].xmeh218
      CALL ap_ref_array2(g_ref_fields,"SELECT oojdl003 FROM oojdl_t WHERE oojdlent='"||g_enterprise||"' AND oojdl001=? AND oojdl002='"||g_dlang||"'","") RETURNING g_rtn_fields
      LET g_xmeg3_d[l_ac].xmeh218_desc = '', g_rtn_fields[1] , ''
      DISPLAY BY NAME g_xmeg3_d[l_ac].xmeh218_desc
END FUNCTION]]>
</point>
  <point name="function.adbt510_xmeh219_ref" cite_std="N" status="" ver="2" src="s" new="Y" order="60" mark_hard="N">
<![CDATA[
PRIVATE FUNCTION adbt510_xmeh219_ref()
      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] =  g_xmeg3_d[l_ac].xmeh219
      CALL ap_ref_array2(g_ref_fields,"SELECT dbbal003 FROM dbbal_t WHERE dbbalent='"||g_enterprise||"' AND dbbal001=? AND dbbal002='"||g_dlang||"'","") RETURNING g_rtn_fields
      LET g_xmeg3_d[l_ac].xmeh219_desc = '', g_rtn_fields[1] , ''
      DISPLAY BY NAME g_xmeg3_d[l_ac].xmeh219_desc
END FUNCTION]]>
</point>
  <point name="function.adbt510_xmeh220_ref" cite_std="N" status="" ver="2" src="s" new="Y" order="61" mark_hard="N">
<![CDATA[
PRIVATE FUNCTION adbt510_xmeh220_ref()
      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] =  g_xmeg3_d[l_ac].xmeh220
      CALL ap_ref_array2(g_ref_fields,"SELECT dbbcl003 FROM dbbcl_t WHERE dbbclent='"||g_enterprise||"' AND dbbcl001=? AND dbbcl002='"||g_dlang||"'","") RETURNING g_rtn_fields
      LET g_xmeg3_d[l_ac].xmeh220_desc = '', g_rtn_fields[1] , ''
      DISPLAY BY NAME g_xmeg3_d[l_ac].xmeh220_desc
END FUNCTION]]>
</point>
  <point name="function.adbt510_xmeh222_ref" cite_std="N" status="" ver="2" src="s" new="Y" order="62" mark_hard="N">
<![CDATA[
PRIVATE FUNCTION adbt510_xmeh222_ref()
      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_xmeg3_d[l_ac].xmeh222
      CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
      LET g_xmeg3_d[l_ac].xmeh222_desc = '', g_rtn_fields[1] , ''
      DISPLAY BY NAME g_xmeg3_d[l_ac].xmeh222_desc
END FUNCTION]]>
</point>
  <point name="function.adbt510_xmeh223_ref" cite_std="N" status="" ver="2" src="s" new="Y" order="63" mark_hard="N">
<![CDATA[
PRIVATE FUNCTION adbt510_xmeh223_ref()
      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_xmeg3_d[l_ac].xmeh223
      CALL ap_ref_array2(g_ref_fields,"SELECT oofa011 FROM oofa_t WHERE oofaent='"||g_enterprise||"' AND oofa002='2' AND oofa003=? ","") RETURNING g_rtn_fields
      LET g_xmeg3_d[l_ac].xmeh223_desc = '', g_rtn_fields[1] , ''
      DISPLAY BY NAME g_xmeg3_d[l_ac].xmeh223_desc
END FUNCTION]]>
</point>
  <point name="function.adbt510_xmeh224_ref" cite_std="N" status="" ver="2" src="s" new="Y" order="64" mark_hard="N">
<![CDATA[
PRIVATE FUNCTION adbt510_xmeh224_ref()
      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_xmeg3_d[l_ac].xmeh224
      CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
      LET g_xmeg3_d[l_ac].xmeh224_desc = '', g_rtn_fields[1] , ''
      DISPLAY BY NAME g_xmeg3_d[l_ac].xmeh224_desc
END FUNCTION]]>
</point>
  <point name="function.adbt510_xmeh227_ref" cite_std="N" status="" ver="2" src="s" new="Y" order="65" mark_hard="N">
<![CDATA[
PRIVATE FUNCTION adbt510_xmeh227_ref()
      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_xmeg3_d[l_ac].xmeh227
      CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='2060' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
      LET g_xmeg3_d[l_ac].xmeh227_desc = '', g_rtn_fields[1] , ''
      DISPLAY BY NAME g_xmeg3_d[l_ac].xmeh227_desc
END FUNCTION]]>
</point>
  <point name="function.adbt510_xmeh228_ref" cite_std="N" status="" ver="2" src="s" new="Y" order="66" mark_hard="N">
<![CDATA[
PRIVATE FUNCTION adbt510_xmeh228_ref()
      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_xmeg3_d[l_ac].xmeh228
      CALL ap_ref_array2(g_ref_fields,"SELECT staal003 FROM staal_t WHERE staalent='"||g_enterprise||"' AND staal001=? AND staal002='"||g_dlang||"'","") RETURNING g_rtn_fields
      LET g_xmeg3_d[l_ac].xmeh228_desc = '', g_rtn_fields[1] , ''
      DISPLAY BY NAME g_xmeg3_d[l_ac].xmeh228_desc
END FUNCTION]]>
</point>
  <point name="function.adbt510_xmehorga_ref" cite_std="N" status="" ver="2" src="s" new="Y" order="67" mark_hard="N">
<![CDATA[
PRIVATE FUNCTION adbt510_xmehorga_ref()
      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_xmeg3_d[l_ac].xmehorga
      CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
      LET g_xmeg3_d[l_ac].xmehorga_desc = '', g_rtn_fields[1] , ''
      DISPLAY BY NAME g_xmeg3_d[l_ac].xmehorga_desc
END FUNCTION]]>
</point>
  <point name="function.adbt510_xmehsite_ref" cite_std="N" status="" ver="2" src="s" new="Y" order="68" mark_hard="N">
<![CDATA[
PRIVATE FUNCTION adbt510_xmehsite_ref()
      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_xmeg3_d[l_ac].xmehsite
      CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
      LET g_xmeg3_d[l_ac].xmehsite_desc = '', g_rtn_fields[1] , ''
      DISPLAY BY NAME g_xmeg3_d[l_ac].xmehsite_desc
END FUNCTION]]>
</point>
  <point name="function.adbt510_imaa0012_ref" cite_std="N" status="u" ver="3" src="s" new="Y" order="69" mark_hard="N">
<![CDATA[
PRIVATE FUNCTION adbt510_imaa0012_ref()
      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_xmeg7_d[l_ac].imaa0012
      CALL ap_ref_array2(g_ref_fields,"SELECT imaal003,imaal004 FROM imaal_t WHERE imaalent='"||g_enterprise||"' AND imaal001=? AND imaal002='"||g_dlang||"'","") RETURNING g_rtn_fields
      LET g_xmeg7_d[l_ac].imaa0012_desc = '', g_rtn_fields[1] , ''
      LET g_xmeg7_d[l_ac].imaa0012_desc_desc = '', g_rtn_fields[2] , ''
      DISPLAY BY NAME g_xmeg7_d[l_ac].imaa0012_desc
      DISPLAY BY NAME g_xmeg7_d[l_ac].imaa0012_desc_desc
END FUNCTION]]>
</point>
  <point name="function.adbt510_rtie002_ref" cite_std="N" status="u" ver="3" src="s" new="Y" order="70" mark_hard="N">
<![CDATA[
PRIVATE FUNCTION adbt510_rtie002_ref()
      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_xmeg7_d[l_ac].rtie002
      CALL ap_ref_array2(g_ref_fields,"SELECT ooial003 FROM ooial_t WHERE ooialent='"||g_enterprise||"' AND ooial001=? AND ooial002='"||g_dlang||"'","") RETURNING g_rtn_fields
      LET g_xmeg7_d[l_ac].rtie002_desc = '', g_rtn_fields[1] , ''
      DISPLAY BY NAME g_xmeg7_d[l_ac].rtie002_desc
END FUNCTION]]>
</point>
  <point name="function.adbt510_change_xmee022" cite_std="N" status="u" ver="2" src="s" new="Y" order="71" mark_hard="N">
<![CDATA[#單頭變更送貨客戶
PRIVATE FUNCTION adbt510_change_xmee022()
DEFINE l_pmaa002      LIKE pmaa_t.pmaa002

      SELECT pmaa002
        INTO l_pmaa002
        FROM pmaa_t
       WHERE pmaaent = g_enterprise
         AND pmaa001 = g_xmee_m.xmee004
      IF l_pmaa002 <> '2' THEN
         UPDATE xmjb_t
            SET xmjb024 = NULL,
                xmjb025 = g_xmee_m.xmee022,
                xmjb026 = g_xmee_m.xmee025,
                xmjb027 = g_xmee_m.xmee206
          WHERE xmjbent = g_enterprise
            AND xmjbdocno = g_xmee_m.xmeedocno
            AND xmjb900 = g_xmee_m.xmee900
         CALL adbt510_b_fill()
      END IF
END FUNCTION]]>
</point>
  <point name="function.adbt510_get_pmaa027" cite_std="N" status="u" ver="2" src="s" new="Y" order="72" mark_hard="N">
<![CDATA[#抓取聯絡對象識別碼
PRIVATE FUNCTION adbt510_get_pmaa027(p_pmaa001)
DEFINE p_pmaa001 LIKE pmaa_t.pmaa001
DEFINE r_pmaa027 LIKE pmaa_t.pmaa003

      LET r_pmaa027 = ''
      
      SELECT pmaa027 INTO r_pmaa027
        FROM pmaa_t
       WHERE pmaaent = g_enterprise
         AND pmaa001 = p_pmaa001
         
      RETURN r_pmaa027
END FUNCTION]]>
</point>
  <point name="function.adbt510_get_col_default" cite_std="N" status="u" ver="2" src="s" new="Y" order="73" mark_hard="N">
<![CDATA[################################################################################
# Descriptions...: 取得單據別設定的欄位預設值
# Memo...........: 需搭配單據別aooi200的設定
################################################################################
PRIVATE FUNCTION adbt510_get_col_default()
   LET g_xmee_m.xmeedocdt = s_aooi200_get_doc_default(g_xmee_m.xmeesite,'1',g_xmee_m.xmeedocno,'xmeedocdt',g_xmee_m.xmeedocdt)
   LET g_xmee_m.xmee004 = s_aooi200_get_doc_default(g_xmee_m.xmeesite,'1',g_xmee_m.xmeedocno,'xmee004',g_xmee_m.xmee004)
   LET g_xmee_m.xmee002 = s_aooi200_get_doc_default(g_xmee_m.xmeesite,'1',g_xmee_m.xmeedocno,'xmee002',g_xmee_m.xmee002)
   LET g_xmee_m.xmee003 = s_aooi200_get_doc_default(g_xmee_m.xmeesite,'1',g_xmee_m.xmeedocno,'xmee003',g_xmee_m.xmee003)
   LET g_xmee_m.xmee005 = s_aooi200_get_doc_default(g_xmee_m.xmeesite,'1',g_xmee_m.xmeedocno,'xmee005',g_xmee_m.xmee005)
   LET g_xmee_m.xmee006 = s_aooi200_get_doc_default(g_xmee_m.xmeesite,'1',g_xmee_m.xmeedocno,'xmee006',g_xmee_m.xmee006)
   LET g_xmee_m.xmee007 = s_aooi200_get_doc_default(g_xmee_m.xmeesite,'1',g_xmee_m.xmeedocno,'xmee007',g_xmee_m.xmee007)
   LET g_xmee_m.xmee008 = s_aooi200_get_doc_default(g_xmee_m.xmeesite,'1',g_xmee_m.xmeedocno,'xmee008',g_xmee_m.xmee008)
   LET g_xmee_m.xmee027 = s_aooi200_get_doc_default(g_xmee_m.xmeesite,'1',g_xmee_m.xmeedocno,'xmee027',g_xmee_m.xmee027)
   LET g_xmee_m.xmee009 = s_aooi200_get_doc_default(g_xmee_m.xmeesite,'1',g_xmee_m.xmeedocno,'xmee009',g_xmee_m.xmee009)
   LET g_xmee_m.xmee010 = s_aooi200_get_doc_default(g_xmee_m.xmeesite,'1',g_xmee_m.xmeedocno,'xmee010',g_xmee_m.xmee010)
   LET g_xmee_m.xmee011 = s_aooi200_get_doc_default(g_xmee_m.xmeesite,'1',g_xmee_m.xmeedocno,'xmee011',g_xmee_m.xmee011)
   LET g_xmee_m.xmee012 = s_aooi200_get_doc_default(g_xmee_m.xmeesite,'1',g_xmee_m.xmeedocno,'xmee012',g_xmee_m.xmee012)
   LET g_xmee_m.xmee013 = s_aooi200_get_doc_default(g_xmee_m.xmeesite,'1',g_xmee_m.xmeedocno,'xmee013',g_xmee_m.xmee013)
   LET g_xmee_m.xmee035 = s_aooi200_get_doc_default(g_xmee_m.xmeesite,'1',g_xmee_m.xmeedocno,'xmee035',g_xmee_m.xmee035)
   LET g_xmee_m.xmee015 = s_aooi200_get_doc_default(g_xmee_m.xmeesite,'1',g_xmee_m.xmeedocno,'xmee015',g_xmee_m.xmee015)
   LET g_xmee_m.xmee016 = s_aooi200_get_doc_default(g_xmee_m.xmeesite,'1',g_xmee_m.xmeedocno,'xmee016',g_xmee_m.xmee016)
   LET g_xmee_m.xmee017 = s_aooi200_get_doc_default(g_xmee_m.xmeesite,'1',g_xmee_m.xmeedocno,'xmee017',g_xmee_m.xmee017)
   LET g_xmee_m.xmee018 = s_aooi200_get_doc_default(g_xmee_m.xmeesite,'1',g_xmee_m.xmeedocno,'xmee018',g_xmee_m.xmee018)
   LET g_xmee_m.xmee019 = s_aooi200_get_doc_default(g_xmee_m.xmeesite,'1',g_xmee_m.xmeedocno,'xmee019',g_xmee_m.xmee019)
   LET g_xmee_m.xmee023 = s_aooi200_get_doc_default(g_xmee_m.xmeesite,'1',g_xmee_m.xmeedocno,'xmee023',g_xmee_m.xmee023)
   LET g_xmee_m.xmee032 = s_aooi200_get_doc_default(g_xmee_m.xmeesite,'1',g_xmee_m.xmeedocno,'xmee032',g_xmee_m.xmee032)
   LET g_xmee_m.xmee043 = s_aooi200_get_doc_default(g_xmee_m.xmeesite,'1',g_xmee_m.xmeedocno,'xmee043',g_xmee_m.xmee043)
   LET g_xmee_m.xmee021 = s_aooi200_get_doc_default(g_xmee_m.xmeesite,'1',g_xmee_m.xmeedocno,'xmee021',g_xmee_m.xmee021)
   LET g_xmee_m.xmee022 = s_aooi200_get_doc_default(g_xmee_m.xmeesite,'1',g_xmee_m.xmeedocno,'xmee022',g_xmee_m.xmee022)
   LET g_xmee_m.xmee034 = s_aooi200_get_doc_default(g_xmee_m.xmeesite,'1',g_xmee_m.xmeedocno,'xmee034',g_xmee_m.xmee034)
   LET g_xmee_m.xmee024 = s_aooi200_get_doc_default(g_xmee_m.xmeesite,'1',g_xmee_m.xmeedocno,'xmee024',g_xmee_m.xmee024)
   LET g_xmee_m.xmee025 = s_aooi200_get_doc_default(g_xmee_m.xmeesite,'1',g_xmee_m.xmeedocno,'xmee025',g_xmee_m.xmee025)
   LET g_xmee_m.xmee026 = s_aooi200_get_doc_default(g_xmee_m.xmeesite,'1',g_xmee_m.xmeedocno,'xmee026',g_xmee_m.xmee026)
   LET g_xmee_m.xmee020 = s_aooi200_get_doc_default(g_xmee_m.xmeesite,'1',g_xmee_m.xmeedocno,'xmee020',g_xmee_m.xmee020)
   LET g_xmee_m.xmee036 = s_aooi200_get_doc_default(g_xmee_m.xmeesite,'1',g_xmee_m.xmeedocno,'xmee036',g_xmee_m.xmee036)
   
   DISPLAY g_xmee_m.xmeedocdt TO xmeedocdt
   DISPLAY g_xmee_m.xmee004 TO xmee004
   DISPLAY g_xmee_m.xmee002 TO xmee002
   DISPLAY g_xmee_m.xmee003 TO xmee003 
   DISPLAY g_xmee_m.xmee005 TO xmee005
   DISPLAY g_xmee_m.xmee006 TO xmee006
   DISPLAY g_xmee_m.xmee007 TO xmee007
   DISPLAY g_xmee_m.xmee008 TO xmee008
   DISPLAY g_xmee_m.xmee027 TO xmee027
   DISPLAY g_xmee_m.xmee009 TO xmee009
   DISPLAY g_xmee_m.xmee010 TO xmee010
   DISPLAY g_xmee_m.xmee011 TO xmee011
   DISPLAY g_xmee_m.xmee012 TO xmee012
   DISPLAY g_xmee_m.xmee013 TO xmee013
   DISPLAY g_xmee_m.xmee035 TO xmee035
   DISPLAY g_xmee_m.xmee015 TO xmee015
   DISPLAY g_xmee_m.xmee016 TO xmee016
   DISPLAY g_xmee_m.xmee017 TO xmee017
   DISPLAY g_xmee_m.xmee018 TO xmee018
   DISPLAY g_xmee_m.xmee019 TO xmee019
   DISPLAY g_xmee_m.xmee023 TO xmee023
   DISPLAY g_xmee_m.xmee032 TO xmee032
   DISPLAY g_xmee_m.xmee043 TO xmee043
   DISPLAY g_xmee_m.xmee021 TO xmee021
   DISPLAY g_xmee_m.xmee022 TO xmee022
   DISPLAY g_xmee_m.xmee034 TO xmee034
   DISPLAY g_xmee_m.xmee024 TO xmee024
   DISPLAY g_xmee_m.xmee025 TO xmee025
   DISPLAY g_xmee_m.xmee026 TO xmee026
   DISPLAY g_xmee_m.xmee020 TO xmee020
   DISPLAY g_xmee_m.xmee036 TO xmee036

   CALL adbt510_xmee004_ref(g_xmee_m.xmee004) RETURNING g_xmee_m.xmee004_desc
   CALL adbt510_xmee002_ref(g_xmee_m.xmee002) RETURNING g_xmee_m.xmee002_desc
   CALL adbt510_xmee003_ref(g_xmee_m.xmee003) RETURNING g_xmee_m.xmee003_desc
   CALL adbt510_xmee027_ref(g_xmee_m.xmee027) RETURNING g_xmee_m.xmee027_desc
   CALL adbt510_xmee009_ref(g_xmee_m.xmee009) RETURNING g_xmee_m.xmee009_desc
   CALL adbt510_xmee010_ref(g_xmee_m.xmee010) RETURNING g_xmee_m.xmee010_desc
   CALL adbt510_xmee011_ref(g_xmee_m.xmee011) RETURNING g_xmee_m.xmee011_desc
   CALL adbt510_xmee035_ref(g_xmee_m.xmee035) RETURNING g_xmee_m.xmee035_desc
   CALL adbt510_xmee015_ref(g_xmee_m.xmee015) RETURNING g_xmee_m.xmee015_desc
   CALL adbt510_xmee017_ref(g_xmee_m.xmee017) RETURNING g_xmee_m.xmee017_desc
   CALL adbt510_xmee018_ref(g_xmee_m.xmee018) RETURNING g_xmee_m.xmee018_desc
   CALL adbt510_xmee023_ref(g_xmee_m.xmee023) RETURNING g_xmee_m.xmee023_desc
   CALL adbt510_xmee032_ref(g_xmee_m.xmee032) RETURNING g_xmee_m.xmee032_desc
   CALL adbt510_xmee004_ref(g_xmee_m.xmee021) RETURNING g_xmee_m.xmee021_desc
   CALL adbt510_xmee004_ref(g_xmee_m.xmee022) RETURNING g_xmee_m.xmee022_desc
   CALL adbt510_xmee004_ref(g_xmee_m.xmee034) RETURNING g_xmee_m.xmee034_desc
   CALL adbt510_xmee024_ref(g_xmee_m.xmee024) RETURNING g_xmee_m.xmee024_desc
   CALL adbt510_xmee020_ref(g_xmee_m.xmee020) RETURNING g_xmee_m.xmee020_desc

   DISPLAY BY NAME g_xmee_m.xmee004_desc
   DISPLAY BY NAME g_xmee_m.xmee002_desc
   DISPLAY BY NAME g_xmee_m.xmee003_desc
   DISPLAY BY NAME g_xmee_m.xmee027_desc
   DISPLAY BY NAME g_xmee_m.xmee009_desc
   DISPLAY BY NAME g_xmee_m.xmee010_desc
   DISPLAY BY NAME g_xmee_m.xmee011_desc
   DISPLAY BY NAME g_xmee_m.xmee035_desc
   DISPLAY BY NAME g_xmee_m.xmee015_desc
   DISPLAY BY NAME g_xmee_m.xmee017_desc
   DISPLAY BY NAME g_xmee_m.xmee018_desc
   DISPLAY BY NAME g_xmee_m.xmee023_desc
   DISPLAY BY NAME g_xmee_m.xmee032_desc
   DISPLAY BY NAME g_xmee_m.xmee021_desc
   DISPLAY BY NAME g_xmee_m.xmee022_desc
   DISPLAY BY NAME g_xmee_m.xmee034_desc
   DISPLAY BY NAME g_xmee_m.xmee024_desc
   DISPLAY BY NAME g_xmee_m.xmee020_desc
   DISPLAY BY NAME g_xmee_m.xmee036_desc
   
END FUNCTION]]>
</point>
  <point name="function.adbt510_get_imaa005" cite_std="N" status="u" ver="2" src="s" new="Y" order="74" mark_hard="N">
<![CDATA[#取得產品特徵類別
PRIVATE FUNCTION adbt510_get_imaa005(p_enterprise,p_xmeg001)
DEFINE p_enterprise   LIKE type_t.num5,
       p_xmeg001      LIKE xmeg_t.xmeg001
DEFINE r_imaa005      LIKE imaa_t.imaa005

   LET r_imaa005 = ''
   SELECT imaa005 INTO r_imaa005
     FROM imaa_t
    WHERE imaaent = p_enterprise
      AND imaa001 = p_xmeg001

   RETURN r_imaa005
END FUNCTION]]>
</point>
  <point name="function.adbt510_get_xmjb022" cite_std="N" status="u" ver="2" src="s" new="Y" order="75" mark_hard="N">
<![CDATA[
PRIVATE FUNCTION adbt510_get_xmjb022()
      IF g_xmeg4_d[l_ac].xmjb008 <> 0 AND g_xmeg4_d[l_ac].xmjb010 <> 0 AND g_xmeg4_d[l_ac].xmjb018 <> 0 THEN
         LET g_xmeg4_d[l_ac].xmjb022 = (g_xmeg4_d[l_ac].xmjb008 - g_xmeg4_d[l_ac].xmjb010) * g_xmeg4_d[l_ac].xmjb018
      END IF
END FUNCTION]]>
</point>
  <point name="function.adbt510_gen_xmej" cite_std="N" status="u" ver="2" src="s" new="Y" order="76" mark_hard="N">
<![CDATA[
PRIVATE FUNCTION adbt510_gen_xmej(p_type)
DEFINE p_type                LIKE type_t.num5
DEFINE r_success             LIKE type_t.num5
DEFINE l_cnt                 LIKE type_t.num5
DEFINE l_xmjb031             LIKE xmjb_t.xmjb031
DEFINE l_xmjb032             LIKE xmjb_t.xmjb032
DEFINE l_xmej200             LIKE xmej_t.xmej200
DEFINE l_xmej201             LIKE xmej_t.xmej201
DEFINE l_xmejunit            LIKE xmej_t.xmejunit

   LET r_success = TRUE
   IF cl_null(g_xmeg4_d[l_ac].xmjbseq) THEN
      RETURN r_success
   END IF
   IF g_xmeg4_d[l_ac].xmjb030 = 'N' THEN
      IF p_type = 1 THEN
         LET l_cnt = 0
         SELECT COUNT(*)
           INTO l_cnt
           FROM xmej_t
          WHERE xmejent = g_enterprise
            AND xmejdocno = g_xmee_m.xmeedocno
            AND xmejseq = g_xmeg4_d[l_ac].xmjbseq
            AND xmej900 = g_xmee_m.xmee900
         IF l_cnt = 0 THEN
            IF NOT cl_null(g_xmee_m.xmeeunit) THEN
               LET l_xmejunit = g_xmee_m.xmeeunit
            ELSE
               LET l_xmejunit = g_xmeg4_d[l_ac].xmjbsite
            END IF
            
            SELECT dbag004,dbag005
              INTO l_xmej200,l_xmej201
              FROM dbag_t
             WHERE dbagent = g_enterprise
               AND dbagsite = l_xmdfunit
               AND dbag001 = '1'
               AND dbag002 = g_xmee_m.xmee004
               AND dbag003 = g_xmeg4_d[l_ac].xmjb025
               
            INSERT INTO xmej_t(xmejent,xmejsite,xmejunit,xmejdocno,xmejseq,xmejseq2,xmej002,xmej003,xmej004,xmej006,xmej200,xmej201,xmej900,xmej901)
                        VALUES(g_enterprise,g_xmeg4_d[l_ac].xmjbsite,l_xmdfunit,g_xmee_m.xmeedocno,g_xmeg4_d[l_ac].xmjbseq,1,
                               g_xmeg4_d[l_ac].xmjb014,g_xmeg4_d[l_ac].xmjb031,g_xmeg4_d[l_ac].xmjb032,'N',l_xmdf200,l_xmdf201,g_xmee_m.xmee900,'3')
            IF SQLCA.sqlcode THEN
               CALL cl_err("xmej_t",SQLCA.sqlcode,0)
               LET r_success = FALSE
               RETURN r_success
            END IF 
            CALL adbt510_03(g_xmee_m.xmeedocno,g_xmeg4_d[l_ac].xmjbseq,g_xmee_m.xmee900,g_xmeg4_d[l_ac].xmjb014,g_xmeg4_d[l_ac].xmjb030,g_xmeg4_d[l_ac].xmjbsite)
            RETURNING l_xmjb031,l_xmjb032
            CALL s_adbt510_gen_xmeh(g_xmee_m.xmeedocno,g_xmeg4_d[l_ac].xmjbseq,g_xmee_m.xmee900) RETURNING r_success  
         END IF
      ELSE
         LET l_cnt = 0
         SELECT COUNT(*)
           INTO l_cnt
           FROM xmej_t
          WHERE xmejent = g_enterprise
            AND xmejdocno = g_xmee_m.xmeedocno
            AND xmejseq = g_xmeg4_d_t.xmjbseq
            AND xmej900 = g_xmee_m.xmee900
         IF l_cnt > 0 THEN
            UPDATE xmej_t
               SET xmej003 = g_xmeg4_d[l_ac].xmjb031,
                   xmej004 = g_xmeg4_d[l_ac].xmjb032,
                   xmej901 = CASE WHEN xmej901 = '1' THEN '2' ELSE xmej901 END
             WHERE xmejent = g_enterprise
               AND xmejdocno = g_xmee_m.xmeedocno
               AND xmejseq = g_xmeg4_d_t.xmjbseq
               AND xmej900 = g_xmee_m.xmee900
            IF SQLCA.sqlcode THEN
               CALL cl_err("xmej_t",SQLCA.sqlcode,0)
               LET r_success = FALSE
               RETURN r_success
            END IF 
         END IF
      END IF
   END IF
   RETURN r_success
END FUNCTION]]>
</point>
  <point name="function.adbt510_get_isaf011" cite_std="N" status="u" ver="2" src="s" new="Y" order="77" mark_hard="N">
<![CDATA[
PRIVATE FUNCTION adbt510_get_isaf011()
DEFINE l_isaf011       LIKE isaf_t.isaf011
   
   LET g_xmee_m.isaf011 = ''
   DECLARE adbt510_isaf_cl1 CURSOR FOR
    SELECT DISTINCT isaf011
      FROM isaf_t,isag_t
     WHERE isafent = isagent
       AND isafcomp = isagcomp
       AND isafdocno = isagdocno
       AND isafent = g_enterprise
       AND isaf001 = '1'
       AND isag001 = 'axmt500'
       AND isag002 = g_xmee_m.xmeedocno
       AND isaf011 IS NOT NULL
       ORDER BY isaf011
       
   FOREACH adbt510_isaf_cl1 INTO l_isaf011
      IF cl_null(g_xmee_m.isaf011) THEN
         LET g_xmee_m.isaf011 = l_isaf011
      ELSE
         LET g_xmee_m.isaf011 = g_xmee_m.isaf011,",",l_isaf011
      END IF
   END FOREACH
END FUNCTION]]>
</point>
  <point name="function.adbt510_location_chk" cite_std="N" status="u" ver="2" src="s" new="Y" order="78" mark_hard="N">
<![CDATA[#依據運輸方式所設置的運輸類型(ACC='263'對應的參考欄位16)檢核起目的地的合理性
PRIVATE FUNCTION adbt510_location_chk(p_location,p_oocq019)
   DEFINE p_location            LIKE type_t.chr10     #地點
   DEFINE l_n                   LIKE type_t.num5
   DEFINE l_stus                LIKE type_t.chr10
   DEFINE p_oocq019             LIKE oocq_t.oocq019

   LET g_errno = ''
   LET l_n = 0
   LET l_stus = ''

   CASE
      WHEN p_oocq019 ='1' OR   #1:陸運
           p_oocq019 ='4'      #4:其它    
         LET l_n=0
         SELECT COUNT(oock003) INTO l_n
           FROM oock_t
          WHERE oockent = g_enterprise
            AND oock003 = p_location
            AND oockstus = 'Y'

             #輸入資料不存在 縣市資料檔 中！
          IF l_n = 0 THEN LET g_errno = 'aoo-00015' RETURN END IF

      WHEN p_oocq019 ='2'      #2:海運
         SELECT oocqstus INTO l_stus
           FROM oocq_t
          WHERE oocqent = g_enterprise
            AND oocq001 = '262'
            AND oocq002 = p_location

         CASE
            WHEN SQLCA.sqlcode = 100
               LET g_errno = 'axm-00032'
            WHEN l_stus <> 'Y'
               LET g_errno = 'axm-00033'
            OTHERWISE
               LET g_errno = SQLCA.sqlcode USING '------'
         END CASE

      WHEN p_oocq019 ='3'      #3:空運                     
         SELECT oocqstus INTO l_stus
           FROM oocq_t
          WHERE oocqent = g_enterprise
            AND oocq001 = '276'
            AND oocq002 = p_location

         CASE
            WHEN SQLCA.sqlcode = 100
               LET g_errno = 'axm-00086'
            WHEN l_stus <> 'Y'
               LET g_errno = 'axm-00087'
            OTHERWISE
               LET g_errno = SQLCA.sqlcode USING '------'
         END CASE

   END CASE
   RETURN

END FUNCTION]]>
</point>
  <point name="function.adbt510_open_xmef" cite_std="N" status="u" ver="2" src="s" new="Y" order="79" mark_hard="N">
<![CDATA[#維護多期預付款單身
PRIVATE FUNCTION adbt510_open_xmef()
DEFINE  l_cmd           LIKE type_t.chr1
DEFINE  l_ac_t          LIKE type_t.num5                #未取消的ARRAY CNT 
DEFINE  l_n             LIKE type_t.num5                #檢查重複用  
DEFINE  l_cnt           LIKE type_t.num5                #檢查重複用  
DEFINE  l_lock_sw       LIKE type_t.chr1                #單身鎖住否  
DEFINE  l_allow_insert  LIKE type_t.num5                #可新增否 
DEFINE  l_allow_delete  LIKE type_t.num5                #可刪除否  
DEFINE  l_count         LIKE type_t.num5
DEFINE  l_i             LIKE type_t.num5
DEFINE  l_insert        BOOLEAN
DEFINE  ls_return       STRING
DEFINE  l_var_keys      DYNAMIC ARRAY OF STRING
DEFINE  l_field_keys    DYNAMIC ARRAY OF STRING
DEFINE  l_vars          DYNAMIC ARRAY OF STRING
DEFINE  l_fields        DYNAMIC ARRAY OF STRING
DEFINE  l_var_keys_bak  DYNAMIC ARRAY OF STRING
DEFINE  l_xmef005       LIKE xmef_t.xmef005
DEFINE  l_xmef006       LIKE xmef_t.xmef006
DEFINE  l_forupd_sql    STRING
DEFINE  l_success       LIKE type_t.num5
DEFINE  l_sum           LIKE xmef_t.xmef005

   IF g_xmee_m.xmeedocno IS NULL THEN
      CALL cl_err("","std-00003",0)
      RETURN
   END IF
   
   SELECT UNIQUE xmeesite,xmeedocno,xmee001,xmeedocdt,xmee002,
                 xmee004,xmee003,xmeestus,xmee005,xmee006,
                 xmee007,xmee008,xmee027,xmee009,
                 xmee010,xmee011,xmee012,xmee013,xmee035,
                 xmee015,xmee016,xmee017,xmee018,xmee019,
                 xmee023,xmee032,xmee071,xmee021,xmee022,
                 xmee034,xmee024,xmee028,xmee041,
                 xmee042,xmee043,xmee025,xmee026,xmee020,
                 xmee036,xmeeownid,xmeeowndp,
                 xmeecrtid,xmeecrtdp,xmeecrtdt,xmeemodid,xmeemoddt,
                 xmeecnfid,xmeecnfdt,xmee900,xmee901,xmee902,xmee903,xmee904
                 
     INTO g_xmee_m.xmeesite,g_xmee_m.xmeedocno,g_xmee_m.xmee001,g_xmee_m.xmeedocdt,g_xmee_m.xmee002,
          g_xmee_m.xmee004,g_xmee_m.xmee003,g_xmee_m.xmeestus,g_xmee_m.xmee005,g_xmee_m.xmee006,
          g_xmee_m.xmee007,g_xmee_m.xmee008,g_xmee_m.xmee027,g_xmee_m.xmee009,
          g_xmee_m.xmee010,g_xmee_m.xmee011,g_xmee_m.xmee012,g_xmee_m.xmee013,g_xmee_m.xmee035,
          g_xmee_m.xmee015,g_xmee_m.xmee016,g_xmee_m.xmee017,g_xmee_m.xmee018,g_xmee_m.xmee019,
          g_xmee_m.xmee023,g_xmee_m.xmee032,g_xmee_m.xmee071,g_xmee_m.xmee021,g_xmee_m.xmee022,
          g_xmee_m.xmee034,g_xmee_m.xmee024,g_xmee_m.xmee028,g_xmee_m.xmee041,
          g_xmee_m.xmee042,g_xmee_m.xmee043,g_xmee_m.xmee025,g_xmee_m.xmee026,g_xmee_m.xmee020,
          g_xmee_m.xmee036,g_xmee_m.xmeeownid,g_xmee_m.xmeeowndp,
          g_xmee_m.xmeecrtid,g_xmee_m.xmeecrtdp,g_xmee_m.xmeecrtdt,g_xmee_m.xmeemodid,g_xmee_m.xmeemoddt,
          g_xmee_m.xmeecnfid,g_xmee_m.xmeecnfdt,g_xmee_m.xmee900,g_xmee_m.xmee901,g_xmee_m.xmee902,g_xmee_m.xmee903,g_xmee_m.xmee904
          
     FROM xmee_t
    WHERE xmeeent = g_enterprise AND xmeedocno = g_xmee_m.xmeedocno AND xmee900 = g_xmee_m.xmee900
 
   ERROR ""
  
   CALL s_transaction_begin()
           
   LET l_forupd_sql = "SELECT xmeesite,xmeedocno,xmee001,xmeedocdt,xmee004,'',xmee002,'',xmee003, 
       '',xmeestus,xmee005,xmee006,xmee007,xmee008,xmee027,'',xmee009,'',xmee010,'',xmee011, 
       '',xmee012,xmee013,xmee035,'',xmee015,'',xmee016,xmee017,'',xmee018,'',xmee019,xmee023,'',xmee032, 
       '',xmee071,xmee021,'',xmee022,'',xmee034,'',xmee024,'', 
       xmee028,xmee041,xmee042,xmee043,xmee025,'','',xmee026,'','',xmee020,'',
       xmee036,'',xmeeownid,'',xmeeowndp,'',xmeecrtid,'',xmeecrtdp,'',xmeecrtdt,xmeemodid, 
       '',xmeemoddt,xmeecnfid,'',xmeecnfdt FROM xmee_t WHERE xmeeent= ? AND xmeedocno=? AND xmee900=? FOR UPDATE"

   LET l_forupd_sql = cl_sql_forupd(l_forupd_sql)                #轉換不同資料庫語法
   DECLARE adbt510_cl2 CURSOR FROM l_forupd_sql
   OPEN adbt510_cl2 USING g_enterprise,g_xmee_m.xmeedocno,g_xmee_m.xmee900

   IF STATUS THEN
      CALL cl_err("OPEN adbt510_cl2:", STATUS, 1)
      CLOSE adbt510_cl2
      CALL s_transaction_end('N','0')
      RETURN
   END IF

   #鎖住將被更改或取消的資料
    FETCH adbt510_cl2 INTO g_xmee_m.xmeesite,g_xmee_m.xmeedocno,g_xmee_m.xmee001, 
       g_xmee_m.xmeedocdt,g_xmee_m.xmee004,g_xmee_m.xmee004_desc,g_xmee_m.xmee002,g_xmee_m.xmee002_desc, 
       g_xmee_m.xmee003,g_xmee_m.xmee003_desc,g_xmee_m.xmeestus,g_xmee_m.xmee005,g_xmee_m.xmee006,g_xmee_m.xmee007, 
       g_xmee_m.xmee008,g_xmee_m.xmee027,g_xmee_m.xmee027_desc,g_xmee_m.xmee009,g_xmee_m.xmee009_desc, 
       g_xmee_m.xmee010,g_xmee_m.xmee010_desc,g_xmee_m.xmee011,g_xmee_m.xmee011_desc,g_xmee_m.xmee012, 
       g_xmee_m.xmee013,g_xmee_m.xmee035,g_xmee_m.xmee035_desc,g_xmee_m.xmee015,g_xmee_m.xmee015_desc, 
       g_xmee_m.xmee016,g_xmee_m.xmee017,g_xmee_m.xmee017_desc,g_xmee_m.xmee018,g_xmee_m.xmee018_desc, 
       g_xmee_m.xmee019,g_xmee_m.xmee023,g_xmee_m.xmee023_desc,g_xmee_m.xmee032,g_xmee_m.xmee032_desc, 
       g_xmee_m.xmee071,g_xmee_m.xmee021,g_xmee_m.xmee021_desc,g_xmee_m.xmee022,g_xmee_m.xmee022_desc, 
       g_xmee_m.xmee034,g_xmee_m.xmee034_desc,g_xmee_m.xmee024,g_xmee_m.xmee024_desc,
       g_xmee_m.xmee028,g_xmee_m.xmee041,g_xmee_m.xmee042,g_xmee_m.xmee043,g_xmee_m.xmee025,g_xmee_m.xmee025_desc,g_xmee_m.oofb017, 
       g_xmee_m.xmee026,g_xmee_m.xmee026_desc,g_xmee_m.oofb017_1,g_xmee_m.xmee020,g_xmee_m.xmee020_desc, 
       g_xmee_m.xmee036, 
       g_xmee_m.xmee036_desc,g_xmee_m.xmeeownid,g_xmee_m.xmeeownid_desc,g_xmee_m.xmeeowndp, 
       g_xmee_m.xmeeowndp_desc,g_xmee_m.xmeecrtid,g_xmee_m.xmeecrtid_desc,g_xmee_m.xmeecrtdp,g_xmee_m.xmeecrtdp_desc, 
       g_xmee_m.xmeecrtdt,g_xmee_m.xmeemodid,g_xmee_m.xmeemodid_desc,g_xmee_m.xmeemoddt,g_xmee_m.xmeecnfid, 
       g_xmee_m.xmeecnfid_desc,g_xmee_m.xmeecnfdt
 
   #資料被他人LOCK, 或是sql執行時出現錯誤
   IF SQLCA.sqlcode THEN
      CALL cl_err(g_xmee_m.xmeedocno,SQLCA.sqlcode,0)
      CLOSE adbt510_cl2
      CALL s_transaction_end('N','0')
      RETURN
   END IF
 
   CALL adbt510_show()  
   LET g_forupd_sql = "SELECT xmefsite,xmef001,xmef002,'',xmef003,xmef004,xmef005,xmef006,xmef007,xmef008,xmef009,xmef901,xmef902,'',xmef903 FROM xmef_t WHERE xmefent=? AND xmefdocno=? AND xmef900=? AND xmef001=? FOR UPDATE"

   LET g_forupd_sql = cl_sql_forupd(g_forupd_sql)
   DECLARE adbt510_bcl15 CURSOR FROM g_forupd_sql

   LET l_allow_insert = cl_auth_detail_input("insert")
   LET l_allow_delete = cl_auth_detail_input("delete")
   LET g_qryparam.state = 'i'

   DISPLAY BY NAME g_xmee_m.xmeesite,g_xmee_m.xmeedocno,g_xmee_m.xmee001,g_xmee_m.xmeedocdt,g_xmee_m.xmee002,
                   g_xmee_m.xmee004,g_xmee_m.xmee003,g_xmee_m.xmeestus,g_xmee_m.xmee005,g_xmee_m.xmee006,
                   g_xmee_m.xmee007,g_xmee_m.xmee008,g_xmee_m.xmee027,g_xmee_m.xmee009,
                   g_xmee_m.xmee010,g_xmee_m.xmee011,g_xmee_m.xmee012,g_xmee_m.xmee013,g_xmee_m.xmee035,
                   g_xmee_m.xmee015,g_xmee_m.xmee016,g_xmee_m.xmee017,g_xmee_m.xmee018,g_xmee_m.xmee019,
                   g_xmee_m.xmee023,g_xmee_m.xmee032,g_xmee_m.xmee043,g_xmee_m.xmee021,g_xmee_m.xmee022,
                   g_xmee_m.xmee034,g_xmee_m.xmee024,g_xmee_m.xmee028,g_xmee_m.xmee025,
                   g_xmee_m.xmee026,g_xmee_m.xmee020,g_xmee_m.xmee036,
                   g_xmee_m.xmee900,g_xmee_m.xmee903,g_xmee_m.xmee904
                  
   
   LET g_errshow = 1
   
   LET g_flag1 = TRUE
   CALL adbt510_set_entry('u')
   CALL adbt510_set_no_entry('u')
   
   DIALOG ATTRIBUTES(UNBUFFERED,FIELD ORDER FORM)
      INPUT BY NAME g_xmee_m.xmee039 ATTRIBUTE(WITHOUT DEFAULTS)         
                        
         AFTER INPUT
            IF INT_FLAG THEN
               EXIT DIALOG
            END IF
            UPDATE xmee_t SET xmee039 = g_xmee_m.xmee039 
              WHERE xmeeent = g_enterprise AND xmeedocno = g_xmee_m.xmeedocno
                AND xmee900 =  g_xmee_m.xmee900
            CASE
               WHEN SQLCA.sqlerrd[3] = 0                   #更新不到的處理
                  CALL cl_err("xmee_t","std-00009",1)
                  CALL s_transaction_end('N','0')
               WHEN SQLCA.sqlcode                          #其他錯誤
                  CALL cl_err("xmee_t",SQLCA.sqlcode,1)
                  CALL s_transaction_end('N','0')
               OTHERWISE
                  CALL s_transaction_end('Y','0')
            END CASE              
            IF NOT adbt510_upd_xmee901() THEN
               CONTINUE DIALOG
            END IF  
      END INPUT
      
      INPUT ARRAY g_xmeg5_d FROM s_detail5.*
         ATTRIBUTE(COUNT = g_rec_b,MAXCOUNT = g_max_rec,WITHOUT DEFAULTS, 
                 INSERT ROW = l_allow_insert,
                 DELETE ROW = l_allow_delete,
                 APPEND ROW = l_allow_insert)
                 

         BEFORE INPUT
            IF g_insert = 'Y' AND NOT cl_null(g_insert) THEN 
              CALL FGL_SET_ARR_CURR(g_xmeg5_d.getLength()+1) 
              LET g_insert = 'N' 
            END IF

            CALL s_tax_chk(g_xmee_m.xmeesite,g_xmee_m.xmee011)
               RETURNING l_success,g_oodbl004,g_oodb005,g_oodb006,g_tax_app

            CALL adbt510_b_fill()
            LET g_rec_b = g_xmeg5_d.getLength()
            
         BEFORE INSERT
            
            LET l_insert = TRUE
            LET l_n = ARR_COUNT()
            LET l_cmd = 'a'
            INITIALIZE g_xmeg5_d[l_ac].* TO NULL 
            LET g_xmeg5_d[l_ac].xmefsite = g_xmee_m.xmeesite
            LET g_xmeg5_d[l_ac].xmef004 = g_today
            #DISPLAY BY NAME g_xmeg5_d[l_ac].xmef004
            LET g_xmeg5_d[l_ac].xmef901 = '3'       #單身新增
            
            SELECT MAX(xmef001)+1 INTO g_xmeg5_d[l_ac].xmef001 FROM xmef_t
              WHERE xmefent = g_enterprise AND xmefdocno = g_xmee_m.xmeedocno
                AND xmef900 = g_xmee_m.xmee900
            IF cl_null(g_xmeg5_d[l_ac].xmef001) OR g_xmeg5_d[l_ac].xmef001 = 0 THEN
               LET g_xmeg5_d[l_ac].xmef001 = 1
            END IF
            
            LET g_xmeg5_d_t.* = g_xmeg5_d[l_ac].*     #新輸入資料
            CALL cl_show_fld_cont()
            CALL adbt510_set_entry_b(l_cmd)

            CALL adbt510_set_no_entry_b(l_cmd)
            
         BEFORE ROW     
            LET l_insert = FALSE
            LET l_cmd = ''
            LET l_ac = ARR_CURR()
            LET g_detail_idx = l_ac
              
            LET l_lock_sw = 'N'            #DEFAULT
            LET l_n = ARR_COUNT()
            DISPLAY l_ac TO FORMONLY.idx
         
            CALL s_transaction_begin()

           
            LET g_rec_b = g_xmeg5_d.getLength()
            
            IF g_rec_b >= l_ac 
               AND g_xmeg5_d[l_ac].xmef001 IS NOT NULL
            THEN 
               LET l_cmd = 'u'
               LET g_xmeg5_d_t.* = g_xmeg5_d[l_ac].*  #BACKUP
               CALL adbt510_set_entry_b(l_cmd)
               CALL adbt510_set_no_entry_b(l_cmd)
               CALL cl_set_act_visible("delete", TRUE)
               IF NOT cl_null(g_xmeg5_d[l_ac].xmef007) AND
                 (g_xmeg5_d[l_ac].xmef008 > 0 OR g_xmeg5_d[l_ac].xmef009 > 0)
               THEN
                  CALL cl_set_act_visible("delete", FALSE)
                  CALL FGL_SET_ARR_CURR(l_ac+1) 
                  CONTINUE DIALOG
               END IF
               
               OPEN adbt510_bcl15 USING g_enterprise,g_xmee_m.xmeedocno,g_xmee_m.xmee900,g_xmeg5_d[l_ac].xmef001
               IF SQLCA.sqlcode THEN
                  CALL cl_err("adbt510_bcl15",SQLCA.sqlcode,1)
                  LET l_lock_sw = 'Y'
               ELSE
                  FETCH adbt510_bcl15 INTO g_xmeg5_d[l_ac].xmefsite,g_xmeg5_d[l_ac].xmef001,g_xmeg5_d[l_ac].xmef002,g_xmeg5_d[l_ac].xmef002_desc,g_xmeg5_d[l_ac].xmef003,
                                           g_xmeg5_d[l_ac].xmef004,g_xmeg5_d[l_ac].xmef005,g_xmeg5_d[l_ac].xmef006,g_xmeg5_d[l_ac].xmef007,g_xmeg5_d[l_ac].xmef008,
                                           g_xmeg5_d[l_ac].xmef009,g_xmeg5_d[l_ac].xmef901,g_xmeg5_d[l_ac].xmef902,g_xmeg5_d[l_ac].xmef902_desc,g_xmeg5_d[l_ac].xmef903
                   IF SQLCA.sqlcode THEN
                     CALL cl_err('',SQLCA.sqlcode,1)
                     LET l_lock_sw = 'Y'
                  END IF
                  
                  LET g_bfill = 'N'
                  CALL adbt510_show()
                  LET g_bfill = 'Y'
                  
                  CALL cl_show_fld_cont()
               END IF
            ELSE
               LET l_cmd='a'
            END IF            
            
         BEFORE DELETE                            #是否取消單身
            IF l_cmd = 'a' THEN
               CALL FGL_SET_ARR_CURR(l_ac-1)
               CALL g_xmeg5_d.deleteElement(l_ac)
               NEXT FIELD xmef001
            END IF
         
            IF g_xmeg5_d[l_ac].xmef001 IS NOT NULL
            THEN
               IF NOT cl_ask_del_detail() THEN
                  CANCEL DELETE
               END IF
               IF l_lock_sw = 'Y' THEN
                  CALL cl_err("", -263, 1)
                  CANCEL DELETE
               END IF
               
               DELETE FROM xmef_t
                WHERE xmefent = g_enterprise AND xmefdocno = g_xmee_m.xmeedocno AND
                      xmef001 = g_xmeg5_d_t.xmef001 AND xmef900 = g_xmee_m.xmee900

               IF SQLCA.sqlcode THEN
                  CALL cl_err("pmdn_t",SQLCA.sqlcode,1)
                  CALL s_transaction_end('N','0')
                  CANCEL DELETE   
               ELSE
                  LET g_rec_b = g_rec_b-1

                  CALL s_transaction_end('Y','0')
               END IF 
               LET l_count = g_xmeg_d.getLength()
            END IF 

         AFTER INSERT    
            LET l_insert = FALSE
            IF INT_FLAG THEN
               CALL cl_err('',9001,0)
               LET INT_FLAG = 0
               CLOSE adbt510_bcl15
               CANCEL INSERT
            END IF
               
            LET l_count = 1  
            SELECT COUNT(*) INTO l_count FROM xmef_t 
             WHERE xmefent = g_enterprise AND xmefdocno = g_xmee_m.xmeedocno
               AND xmef001 = g_xmeg5_d[l_ac].xmef001 AND xmef900 = g_xmee_m.xmee900
                
            #資料未重複, 插入新增資料
            IF l_count = 0 THEN 
               INSERT INTO xmef_t
                  (xmefent,xmefdocno,xmef001,xmefsite,xmef002,xmef003,xmef004,xmef005,xmef006,xmef007,xmef008,xmef009,xmef900,xmef901,xmef902,xmef903) 
                 VALUES(g_enterprise,g_xmee_m.xmeedocno,g_xmeg5_d[l_ac].xmef001,
                   g_xmeg5_d[l_ac].xmefsite,g_xmeg5_d[l_ac].xmef002,g_xmeg5_d[l_ac].xmef003, 
                   g_xmeg5_d[l_ac].xmef004,g_xmeg5_d[l_ac].xmef005,g_xmeg5_d[l_ac].xmef006, 
                   g_xmeg5_d[l_ac].xmef007,g_xmeg5_d[l_ac].xmef008,g_xmeg5_d[l_ac].xmef009,
                   g_xmee_m.xmee900,
                   g_xmeg5_d[l_ac].xmef901,g_xmeg5_d[l_ac].xmef902,g_xmeg5_d[l_ac].xmef903) 

               IF SQLCA.sqlcode THEN
                  CALL cl_err("xmef_t",SQLCA.sqlcode,1)  
                  CALL s_transaction_end('N','0')                    
                  CANCEL INSERT
               ELSE
                  #將單身資料寫入歷程檔中               
                  IF NOT adbt510_xmef_ins_xmek(g_xmeg5_d[l_ac].*) THEN
                     LET g_xmeg5_d[l_ac].* = g_xmeg5_d_t.*
                     CALL s_transaction_end('N','0')
                  END IF 
               END IF
            ELSE    
               CALL cl_err('INSERT',"std-00006",1)
               INITIALIZE g_xmeg_d[l_ac].* TO NULL
               CALL s_transaction_end('N','0')
               CANCEL INSERT
            END IF
            
            CALL s_transaction_end('Y','0')
            ERROR 'INSERT O.K'
            LET g_rec_b = g_rec_b + 1
            
         ON ROW CHANGE 
            IF INT_FLAG THEN
               CALL cl_err('',9001,0)
               LET INT_FLAG = 0
               LET g_xmeg5_d[l_ac].* = g_xmeg5_d_t.*
               CALL s_transaction_end('N','0')
               EXIT DIALOG 
            END IF
            
            IF l_lock_sw = 'Y' THEN
               CALL cl_err('',-263,1)
               LET g_xmeg5_d[l_ac].* = g_xmeg5_d_t.*
            ELSE
               IF g_xmeg5_d[l_ac].xmef901 = '1' THEN
                  LET g_xmeg5_d[l_ac].xmef901 = '2'
               END IF
            
               UPDATE xmef_t SET (xmefdocno,xmefsite,xmef001,xmef002,xmef003,xmef004,
                                  xmef005,xmef006,xmef007,xmef008,xmef009,
                                  xmef901,xmef902,xmef903)
                               = (g_xmee_m.xmeedocno,g_xmeg5_d[l_ac].xmefsite,g_xmeg5_d[l_ac].xmef001,g_xmeg5_d[l_ac].xmef002,g_xmeg5_d[l_ac].xmef003,g_xmeg5_d[l_ac].xmef004,
                                  g_xmeg5_d[l_ac].xmef005,g_xmeg5_d[l_ac].xmef006,g_xmeg5_d[l_ac].xmef007,g_xmeg5_d[l_ac].xmef008,g_xmeg5_d[l_ac].xmef009,
                                  g_xmeg5_d[l_ac].xmef901,g_xmeg5_d[l_ac].xmef902,g_xmeg5_d[l_ac].xmef903) #自訂欄位頁簽
                WHERE xmefent = g_enterprise AND xmefdocno = g_xmee_m.xmeedocno
                  AND xmef001 = g_xmeg5_d_t.xmef001 
                  AND xmef900 = g_xmee_m.xmee900                   
               CASE
                  WHEN SQLCA.sqlerrd[3] = 0  #更新不到的處理
                     CALL cl_err("xmef_t","std-00009",1)
                     CALL s_transaction_end('N','0')
                     LET g_xmeg5_d[l_ac].* = g_xmeg5_d_t.*
                  WHEN SQLCA.sqlcode #其他錯誤
                     CALL cl_err("xmef_t",SQLCA.sqlcode,1)  
                     CALL s_transaction_end('N','0')
                     LET g_xmeg5_d[l_ac].* = g_xmeg5_d_t.*
                  OTHERWISE
#                      INITIALIZE gs_keys TO NULL 
#                      LET gs_keys[1] = g_xmee_m.xmeedocno
#                      LET gs_keys_bak[1] = g_xmeedocno_t
#                      LET gs_keys[2] = g_xmeg5_d[g_detail_idx].xmef001
#                      LET gs_keys_bak[2] = g_xmeg5_d_t.xmef001
#                      CALL adbt510_update_b('xmef_t',gs_keys,gs_keys_bak,"'5'")
                     #資料多語言用-增/改
               END CASE
               IF NOT SQLCA.sqlcode THEN
                  #將單身資料寫入歷程檔中               
                  IF NOT adbt510_xmef_ins_xmek(g_xmeg5_d[l_ac].*) THEN
                     LET g_xmeg5_d[l_ac].* = g_xmeg5_d_t.*
                     CALL s_transaction_end('N','0')
                  END IF 
               END IF
            END IF
         
         #---------------------<  Detail: page5  >---------------------
         #----<<xmef001>>----
         #此段落由子樣板a02產生
         AFTER FIELD xmef001
            #此段落由子樣板a15產生
            IF NOT cl_ap_chk_Range(g_xmeg5_d[l_ac].xmef001,"0.000","0","","","azz-00079",1) THEN
               LET g_xmeg5_d[l_ac].xmef001 = g_xmeg5_d_t.xmef001
               NEXT FIELD xmef001
            END IF

            #此段落由子樣板a05產生
            IF  g_xmee_m.xmeedocno IS NOT NULL AND g_xmeg5_d[l_ac].xmef001 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmee_m.xmeedocno != g_xmeedocno_t OR g_xmeg5_d[l_ac].xmef001 != g_xmeg5_d_t.xmef001)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xmef_t WHERE "||"xmefent = '" ||g_enterprise|| "' AND "||"xmefdocno = '"||g_xmee_m.xmeedocno ||"' AND "|| "xmef001 = '"||g_xmeg5_d[l_ac].xmef001 ||"' AND "|| "xmef900 = '"||g_xmee_m.xmee900 ||"'",'std-00004',0) THEN 
                     LET g_xmeg5_d[l_ac].xmef001 = g_xmeg5_d_t.xmef001
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

         #----<<xmef002>>----
         #此段落由子樣板a02產生
         AFTER FIELD xmef002
            CALL adbt510_xmee009_ref(g_xmeg5_d[l_ac].xmef002) RETURNING g_xmeg5_d[l_ac].xmef002_desc
            DISPLAY BY NAME g_xmeg5_d[l_ac].xmef002_desc
            
            IF NOT cl_null(g_xmeg5_d[l_ac].xmef002) THEN 
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmee_m.xmee021
               LET g_chkparam.arg2 = g_xmeg5_d[l_ac].xmef002
                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_pmad002_2") THEN
                  #檢查成功時後續處理

               ELSE
                  #檢查失敗時後續處理
                  LET g_xmeg5_d[l_ac].xmef002 = g_xmeg5_d_t.xmef002
                  CALL adbt510_xmee009_ref(g_xmeg5_d[l_ac].xmef002) RETURNING g_xmeg5_d[l_ac].xmef002_desc
                  DISPLAY BY NAME g_xmeg5_d[l_ac].xmef002_desc
                  NEXT FIELD CURRENT
               END IF
            END IF 

         AFTER FIELD xmef003
            IF g_xmeg5_d[l_ac].xmef003 > g_xmeg5_d[l_ac].xmef004 THEN
               LET g_xmeg5_d[l_ac].xmef003 = g_xmeg5_d_t.xmef003
               CALL cl_err('','adb-00080',0)
               NEXT FIELD xmef003
            END IF  
            
         AFTER FIELD xmef004
            IF g_xmeg5_d[l_ac].xmef004 < g_xmeg5_d[l_ac].xmef003 THEN
               LET g_xmeg5_d[l_ac].xmef004 = g_xmeg5_d_t.xmef004
               CALL cl_err('','adb-00080',0)
               NEXT FIELD xmef004
            END IF  

         #----<<xmef005>>----
         #此段落由子樣板a02產生
         AFTER FIELD xmef005
            #此段落由子樣板a15產生
            IF NOT cl_ap_chk_Range(g_xmeg5_d[l_ac].xmef005,"0.000","0","","","azz-00079",1) THEN
               LET g_xmeg5_d[l_ac].xmef005 = g_xmeg5_d_t.xmef005
               NEXT FIELD xmef005
            END IF

            LET l_sum = 0
            FOR l_i = 1 TO g_xmeg5_d.getLength()
               LET l_sum = l_sum + g_xmeg5_d[l_i].xmef005
            END FOR
            IF l_sum > g_xmee_m.xmee041 THEN
               LET g_xmeg5_d[l_ac].xmef005 = g_xmeg5_d_t.xmef005
               CALL cl_err('','adb-00086',0)
               NEXT FIELD xmef005
            END IF

            #稅率依單頭需自動推算未稅金額
            IF g_tax_app = '1' THEN

            END IF
         #----<<xmef006>>----
         #此段落由子樣板a02產生
         AFTER FIELD xmef006
            #此段落由子樣板a15產生
            IF NOT cl_ap_chk_Range(g_xmeg5_d[l_ac].xmef006,"0.000","0","","","azz-00079",1) THEN
               LET g_xmeg5_d[l_ac].xmef006 = g_xmeg5_d_t.xmef006
               NEXT FIELD xmef006
            END IF
            LET l_sum = 0
            FOR l_i = 1 TO g_xmeg5_d.getLength()
               LET l_sum = l_sum + g_xmeg5_d[l_i].xmef006
            END FOR
            IF l_sum > g_xmee_m.xmee042 THEN
               LET g_xmeg5_d[l_ac].xmef006 = g_xmeg5_d_t.xmef006
               CALL cl_err('','adb-00087',0)
               NEXT FIELD xmef006
            END IF
            
         AFTER FIELD xmef902
            IF NOT cl_null(g_xmeg5_d[l_ac].xmef902) THEN
               IF NOT s_azzi650_chk_exist('267',g_xmeg5_d[l_ac].xmef902) THEN
                  LET g_xmeg5_d[l_ac].xmef902 = g_xmeg5_d_t.xmef902
                  NEXT FIELD xmef902
               END IF
            END IF
            CALL adbt510_xmef902_ref()
            
         #---------------------<  Detail: page5  >---------------------
         #----<<xmef002>>----
         #Ctrlp:input.c.page5.xmef002
         ON ACTION controlp INFIELD xmef002
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmeg5_d[l_ac].xmef002             #給予default值

            #給予arg
            LET g_qryparam.arg1 = g_xmee_m.xmee021 #

            CALL q_pmad002_3()                                #呼叫開窗

            LET g_xmeg5_d[l_ac].xmef002 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmeg5_d[l_ac].xmef002 TO xmef002              #顯示到畫面上
            CALL adbt510_xmee009_ref(g_xmeg5_d[l_ac].xmef002) RETURNING g_xmeg5_d[l_ac].xmef002_desc
            DISPLAY BY NAME g_xmeg5_d[l_ac].xmef002_desc

            NEXT FIELD xmef002                          #返回原欄位

         ON ACTION controlp INFIELD xmef902
             #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmeg5_d[l_ac].xmef902             #給予default值
            LET g_qryparam.default2 = "" 
            #給予arg
            LET g_qryparam.arg1 = '267' #

            CALL q_oocq002()                                #呼叫開窗

            LET g_xmeg5_d[l_ac].xmef902 = g_qryparam.return1              
            DISPLAY g_xmeg5_d[l_ac].xmef902 TO xmef902  
            CALL adbt510_xmef902_ref()            
            NEXT FIELD xmef902                          #返回原欄位


 
         AFTER ROW
            LET l_ac = ARR_CURR()
            LET l_ac_t = l_ac

            IF INT_FLAG THEN
               CALL cl_err('',9001,0)
               LET INT_FLAG = 0
               IF l_cmd = 'u' THEN
                  LET g_xmeg5_d[l_ac].* = g_xmeg5_d_t.*
               END IF
               CLOSE adbt510_bcl15
               CALL s_transaction_end('N','0')
               EXIT DIALOG 
            END IF
            
            #多帳期預付款金額加總不可超過整張訂購單總訂購金額(含未稅金額均不能超過)
            LET l_xmef005 = 0
            LET l_xmef006 = 0
            SELECT SUM(xmef005),SUM(xmef006) 
              INTO l_xmef005,l_xmef006 FROM xmef_t 
               WHERE xmefent = g_enterprise AND xmefdocno = g_xmee_m.xmeedocno
                 AND xmef900 = g_xmee_m.xmee900

            IF l_xmef005 > g_xmee_m.xmee041 THEN
               CALL cl_err(g_xmee_m.xmeedocno,'apm-00263',1)
               NEXT FIELD xmef005
            END IF
            IF l_xmef006 > g_xmee_m.xmee042 THEN
               CALL cl_err(g_xmee_m.xmeedocno,'apm-00264',1)
               LET g_xmeg5_d[l_ac].xmef006 = g_xmeg5_d_t.xmef006
               NEXT FIELD xmef006
            END IF
            
            #其他table進行unlock
            CLOSE adbt510_bcl15
            CALL s_transaction_end('Y','0')  
            
         AFTER INPUT
            #多帳期預付款金額加總不可超過整張訂購單總訂金額(含未稅金額均不能超過)
            LET l_xmef005 = 0
            LET l_xmef006 = 0
            SELECT SUM(xmef005),SUM(xmef006) 
              INTO l_xmef005,l_xmef006 FROM xmef_t 
             WHERE xmefent = g_enterprise AND xmefdocno = g_xmee_m.xmeedocno
               AND xmef900 = g_xmee_m.xmee900
            IF l_xmef005 > g_xmee_m.xmee041 THEN
               CALL cl_err(g_xmee_m.xmeedocno,'apm-00263',1)
               NEXT FIELD xmef005
            END IF
            IF l_xmef006 > g_xmee_m.xmee042 THEN
               CALL cl_err(g_xmee_m.xmeedocno,'apm-00264',1)
               LET g_xmeg5_d[l_ac].xmef006 = g_xmeg5_d_t.xmef006
               NEXT FIELD xmef006
            END IF
 
      END INPUT
   
      ON ACTION controlf
         CALL cl_set_focus_form(ui.Interface.getRootNode()) RETURNING g_fld_name,g_frm_name
         CALL cl_fldhelp(g_frm_name,g_fld_name,g_lang)
 
      ON ACTION controlr
         CALL cl_show_req_fields()
 
      ON ACTION controls
         CALL cl_set_head_visible("","AUTO")
 
      ON ACTION accept
         ACCEPT DIALOG
        
      ON ACTION cancel      #在dialog button (放棄)
         LET INT_FLAG = TRUE 
         EXIT DIALOG
 
      ON ACTION close       #在dialog 右上角 (X)
         LET INT_FLAG = TRUE 
         EXIT DIALOG
 
      ON ACTION exit        #toolbar 離開
         LET INT_FLAG = TRUE 
         EXIT DIALOG
 
      #交談指令共用ACTION
      &include "common_action.4gl" 
         CONTINUE DIALOG 
         
   END DIALOG
   CALL cl_set_act_visible("delete", TRUE)
   CLOSE adbt510_cl2
   LET g_flag1 = FALSE
   IF INT_FLAG THEN
      LET INT_FLAG = FALSE
   END IF
   
END FUNCTION]]>
</point>
  <point name="function.adbt510_set_required_b" cite_std="N" status="u" ver="2" src="s" new="Y" order="80" mark_hard="N">
<![CDATA[
PRIVATE FUNCTION adbt510_set_required_b()
   DEFINE l_imaf015     LIKE imaf_t.imaf015
   DEFINE l_imaf113     LIKE imaf_t.imaf113
   DEFINE l_pmaa002     LIKE pmaa_t.pmaa002
   
      IF l_ac > 0 THEN
         SELECT imaf015,imaf113
           INTO l_imaf015,l_imaf113
           FROM imaf_t
          WHERE imafent = g_enterprise
            AND imafsite = g_xmee_m.xmeesite
            AND imaf001 = g_xmeg4_d[l_ac].xmjb003
         IF NOT cl_null(l_imaf015) THEN
            CALL cl_set_comp_required("xmjb015",TRUE)
         END IF
         IF NOT cl_null(l_imaf113) THEN
            CALL cl_set_comp_required("xmjb017",TRUE)
         END IF
         IF g_xmeg4_d[l_ac].xmjb030 = "N" THEN
            CALL cl_set_comp_required("xmjb031,xmjb032",TRUE) 
         END IF
      END IF
      SELECT pmaa002
        INTO l_pmaa002
        FROM pmaa_t
       WHERE pmaaent = g_enterprise
         AND pmaa001 = g_xmee_m.xmee004
      IF l_pmaa002 = '2' THEN
         CALL cl_set_comp_required("xmjb024",TRUE)
      END IF 
END FUNCTION]]>
</point>
  <point name="function.adbt510_set_no_required_b" cite_std="N" status="u" ver="2" src="s" new="Y" order="81" mark_hard="N">
<![CDATA[
PRIVATE FUNCTION adbt510_set_no_required_b()
      CALL cl_set_comp_required("xmjb015,xmjb017",FALSE)  
      CALL cl_set_comp_required("xmjb024,xmjb031,xmjb032",FALSE)       
END FUNCTION]]>
</point>
  <point name="function.adbt510_unit_chk" cite_std="N" status="u" ver="2" src="s" new="Y" order="82" mark_hard="N">
<![CDATA[#單位資料檢查
PRIVATE FUNCTION adbt510_unit_chk(p_xmeg006)
DEFINE p_xmeg006    LIKE xmeg_t.xmeg006
DEFINE r_success    LIKE type_t.num5
       
       LET r_success = TRUE
       
       IF NOT cl_null(p_xmeg006) THEN 
          #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
          INITIALIZE g_chkparam.* TO NULL
          
          #設定g_chkparam.*的參數
          LET g_chkparam.arg1 = p_xmeg006
   
          #呼叫檢查存在並帶值的library
          IF NOT cl_chk_exist("v_ooca001") THEN
             LET r_success = FALSE
             RETURN r_success             
          END IF
       END IF 
       RETURN r_success 
END FUNCTION]]>
</point>
  <point name="function.adbt510_unit_ref" cite_std="N" status="u" ver="2" src="s" new="Y" order="83" mark_hard="N">
<![CDATA[#單位帶出說明
PRIVATE FUNCTION adbt510_unit_ref(p_xmeg006)
DEFINE p_xmeg006    LIKE xmeg_t.xmeg006
DEFINE r_oocal003   LIKE oocal_t.oocal003

       INITIALIZE g_ref_fields TO NULL
       LET g_ref_fields[1] = p_xmeg006
       CALL ap_ref_array2(g_ref_fields,"SELECT oocal003 FROM oocal_t WHERE oocalent='"||g_enterprise||"' AND oocal001=? AND oocal002='"||g_dlang||"'","") RETURNING g_rtn_fields
       LET r_oocal003 = '', g_rtn_fields[1] , ''
       RETURN r_oocal003
END FUNCTION]]>
</point>
  <point name="function.adbt510_xmjb012_convert" cite_std="N" status="u" ver="2" src="s" new="Y" order="84" mark_hard="N">
<![CDATA[
PRIVATE FUNCTION adbt510_xmjb012_convert()
DEFINE l_rate       LIKE inaj_t.inaj014
DEFINE l_success    LIKE type_t.num5  
     
   IF cl_null(g_xmeg4_d[l_ac].xmjb012) OR cl_null(g_xmeg4_d[l_ac].xmjb011) THEN
      RETURN
   END IF 
   #銷售數量
   IF NOT cl_null(g_xmeg4_d[l_ac].xmjb013) THEN  
      CALL s_aimi190_get_convert(g_xmeg4_d[l_ac].xmjb003,g_xmeg4_d[l_ac].xmjb011,g_xmeg4_d[l_ac].xmjb013) RETURNING l_success,l_rate
      LET g_xmeg4_d[l_ac].xmjb014 = g_xmeg4_d[l_ac].xmjb012 * l_rate
      CALL s_aooi250_take_decimals(g_xmeg4_d[l_ac].xmjb013,g_xmeg4_d[l_ac].xmjb014) RETURNING l_success,g_xmeg4_d[l_ac].xmjb014
   END IF
   #參考單位
   IF NOT cl_null(g_xmeg4_d[l_ac].xmjb015) THEN  
      CALL s_aimi190_get_convert(g_xmeg4_d[l_ac].xmjb003,g_xmeg4_d[l_ac].xmjb011,g_xmeg4_d[l_ac].xmjb015) RETURNING l_success,l_rate
      LET g_xmeg4_d[l_ac].xmjb016 = g_xmeg4_d[l_ac].xmjb012 * l_rate
      CALL s_aooi250_take_decimals(g_xmeg4_d[l_ac].xmjb015,g_xmeg4_d[l_ac].xmjb016) RETURNING l_success,g_xmeg4_d[l_ac].xmjb016
   END IF
   #計價數量
   IF NOT cl_null(g_xmeg4_d[l_ac].xmjb017) THEN  
      CALL s_aimi190_get_convert(g_xmeg4_d[l_ac].xmjb003,g_xmeg4_d[l_ac].xmjb011,g_xmeg4_d[l_ac].xmjb017) RETURNING l_success,l_rate
      LET g_xmeg4_d[l_ac].xmjb018 = g_xmeg4_d[l_ac].xmjb012 * l_rate
      CALL s_aooi250_take_decimals(g_xmeg4_d[l_ac].xmjb017,g_xmeg4_d[l_ac].xmjb018) RETURNING l_success,g_xmeg4_d[l_ac].xmjb018
   END IF
END FUNCTION]]>
</point>
  <point name="function.adbt510_xmeedocno_chk" cite_std="N" status="u" ver="3" src="s" new="Y" order="85" mark_hard="N">
<![CDATA[
PRIVATE FUNCTION adbt510_xmeedocno_chk()
DEFINE l_n               LIKE type_t.num5
DEFINE r_success         LIKE type_t.num5

   LET r_success = TRUE

   IF cl_null(g_xmee_m.xmeedocno) THEN
      RETURN r_success
   END IF

   #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
   INITIALIZE g_chkparam.* TO NULL

   #設定g_chkparam.*的參數
   LET g_chkparam.arg1 = g_xmee_m.xmeedocno
   LET g_chkparam.arg2 = g_xmee_m.xmeesite
   #呼叫檢查存在並帶值的library
   IF NOT cl_chk_exist("v_xmdadocno_6") THEN
      #檢查失敗時後續處理
      LET r_success = FALSE
      RETURN r_success
   END IF

   #同一張訂單不能同時有兩張以上未確認的變更單存在
   LET l_n = 0
   SELECT COUNT(*) INTO l_n
     FROM xmee_t
    WHERE xmeeent = g_enterprise
      AND xmeedocno = g_xmee_m.xmeedocno
      AND xmeestus = 'N'
      
   IF l_n > 0 THEN
      CALL cl_err(g_xmee_m.xmeedocno,'axm-00221',1)
      LET r_success = FALSE
      RETURN r_success
   END IF

   RETURN r_success
END FUNCTION]]>
</point>
  <point name="function.adbt510_xmeedocno_xmee" cite_std="N" status="u" ver="2" src="s" new="Y" order="86" mark_hard="N">
<![CDATA[#依據輸入的訂單單號，帶出單頭欄位的值
PRIVATE FUNCTION adbt510_xmeedocno_xmee()
   DEFINE  l_pmaa027    LIKE pmaa_t.pmaa027
   DEFINE  r_success    LIKE type_t.num5
   DEFINE  r_address    STRING

   LET r_success = TRUE

   #變更序=訂單變更單的變更序最大值+1
   SELECT MAX(xmee900)+1 INTO g_xmee_m.xmee900
     FROM xmee_t
    WHERE xmeeent = g_enterprise
      AND xmeedocno = g_xmee_m.xmeedocno
   IF cl_null(g_xmee_m.xmee900) THEN
      LET g_xmee_m.xmee900 = 1
   END IF
   DISPLAY BY NAME g_xmee_m.xmee900
   
   
   LET g_xmee_m.xmee901 = 'N'         #未變更
   DISPLAY BY NAME g_xmee_m.xmee901
   
   #抓取訂單單單頭資料，顯示在畫面上
   #版本=訂單的版本+1
   SELECT xmda001+1,xmdasite,xmdadocno,xmda002,
          xmda003,xmda004,xmda005,xmda006,xmda007,
          xmda008,xmda027,xmda009,xmda010,
          xmda011,xmda012,xmda013,xmda035,xmda015,
          xmda016,xmda017,xmda018,xmda019,xmda023,
          xmda032,xmda071,xmda021,xmda022,xmda034,
          xmda024,xmda028,xmdadocdt,
          xmda041,xmda042,xmda043,xmda025,xmda026,
          xmda020,xmda036,xmda039,
          xmda200,xmda201,xmda202,xmda203,xmda204,
          xmda205,xmda206,xmda207,xmdaunit          
     INTO g_xmee_m.xmee001,g_xmee_m.xmeesite,g_xmee_m.xmeedocno,g_xmee_m.xmee002,
          g_xmee_m.xmee003,g_xmee_m.xmee004,g_xmee_m.xmee005,g_xmee_m.xmee006,g_xmee_m.xmee007,
          g_xmee_m.xmee008,g_xmee_m.xmee027,g_xmee_m.xmee009,g_xmee_m.xmee010,
          g_xmee_m.xmee011,g_xmee_m.xmee012,g_xmee_m.xmee013,g_xmee_m.xmee035,g_xmee_m.xmee015,
          g_xmee_m.xmee016,g_xmee_m.xmee017,g_xmee_m.xmee018,g_xmee_m.xmee019,g_xmee_m.xmee023,
          g_xmee_m.xmee032,g_xmee_m.xmee071,g_xmee_m.xmee021,g_xmee_m.xmee022,g_xmee_m.xmee034,
          g_xmee_m.xmee024,g_xmee_m.xmee028,g_xmee_m.xmeedocdt,
          g_xmee_m.xmee041,g_xmee_m.xmee042,g_xmee_m.xmee043,g_xmee_m.xmee025,g_xmee_m.xmee026,
          g_xmee_m.xmee020,g_xmee_m.xmee036,g_xmee_m.xmee039,
          g_xmee_m.xmee200,g_xmee_m.xmee201,g_xmee_m.xmee202,g_xmee_m.xmee203,g_xmee_m.xmee204,
          g_xmee_m.xmee205,g_xmee_m.xmee206,g_xmee_m.xmee207,g_xmee_m.xmeeunit            
     FROM xmda_t
    WHERE xmdaent = g_enterprise
      AND xmdadocno = g_xmee_m.xmeedocno
   IF SQLCA.sqlcode THEN
      CALL cl_err('sel xmda_t',SQLCA.sqlcode,1)
      LET r_success = FALSE
      RETURN r_success
   END IF   
   DISPLAY BY NAME g_xmee_m.xmee001,g_xmee_m.xmeesite,g_xmee_m.xmeedocno,g_xmee_m.xmeedocdt,g_xmee_m.xmee002,
                   g_xmee_m.xmee003,g_xmee_m.xmee004,g_xmee_m.xmee005,g_xmee_m.xmee006,g_xmee_m.xmee007,
                   g_xmee_m.xmee008,g_xmee_m.xmee027,g_xmee_m.xmee009,g_xmee_m.xmee010,
                   g_xmee_m.xmee011,g_xmee_m.xmee012,g_xmee_m.xmee013,g_xmee_m.xmee035,g_xmee_m.xmee015,
                   g_xmee_m.xmee016,g_xmee_m.xmee017,g_xmee_m.xmee018,g_xmee_m.xmee019,g_xmee_m.xmee023,
                   g_xmee_m.xmee032,g_xmee_m.xmee071,g_xmee_m.xmee021,g_xmee_m.xmee022,g_xmee_m.xmee034,
                   g_xmee_m.xmee024,g_xmee_m.xmee028,g_xmee_m.xmeedocdt,
                   g_xmee_m.xmee041,g_xmee_m.xmee042,g_xmee_m.xmee043,g_xmee_m.xmee025,g_xmee_m.xmee026,
                   g_xmee_m.xmee020,g_xmee_m.xmee036,g_xmee_m.xmee039,
                   g_xmee_m.xmee200,g_xmee_m.xmee201,g_xmee_m.xmee202,g_xmee_m.xmee203,g_xmee_m.xmee204,
                   g_xmee_m.xmee205,g_xmee_m.xmee206,g_xmee_m.xmee207,g_xmee_m.xmeeunit                      

   CALL adbt510_xmee004_ref(g_xmee_m.xmee004) RETURNING g_xmee_m.xmee004_desc
   DISPLAY BY NAME g_xmee_m.xmee004_desc

   CALL adbt510_xmee002_ref(g_xmee_m.xmee002) RETURNING g_xmee_m.xmee002_desc
   DISPLAY BY NAME g_xmee_m.xmee002_desc

   CALL adbt510_xmee003_ref(g_xmee_m.xmee003) RETURNING g_xmee_m.xmee003_desc
   DISPLAY BY NAME g_xmee_m.xmee003_desc 
    
   CALL adbt510_xmee027_ref(g_xmee_m.xmee027) RETURNING g_xmee_m.xmee027_desc
   DISPLAY BY NAME g_xmee_m.xmee027_desc
    
   CALL adbt510_xmee009_ref(g_xmee_m.xmee009) RETURNING g_xmee_m.xmee009_desc
   DISPLAY BY NAME g_xmee_m.xmee009_desc
    
   CALL adbt510_xmee010_ref(g_xmee_m.xmee010) RETURNING g_xmee_m.xmee010_desc
   DISPLAY BY NAME g_xmee_m.xmee010_desc
    
   CALL adbt510_xmee011_ref(g_xmee_m.xmee011) RETURNING g_xmee_m.xmee011_desc
   DISPLAY BY NAME g_xmee_m.xmee011_desc
    
   CALL adbt510_xmee015_ref(g_xmee_m.xmee015) RETURNING g_xmee_m.xmee015_desc
   DISPLAY BY NAME g_xmee_m.xmee015_desc
    
   CALL adbt510_xmee017_ref(g_xmee_m.xmee017) RETURNING g_xmee_m.xmee017_desc
   DISPLAY BY NAME g_xmee_m.xmee017_desc
    
   CALL adbt510_xmee018_ref(g_xmee_m.xmee018) RETURNING g_xmee_m.xmee018_desc
   DISPLAY BY NAME g_xmee_m.xmee018_desc         
    
   CALL adbt510_xmee020_ref(g_xmee_m.xmee020) RETURNING g_xmee_m.xmee020_desc
   DISPLAY BY NAME g_xmee_m.xmee020_desc
                
   CALL adbt510_xmee004_ref(g_xmee_m.xmee021) RETURNING g_xmee_m.xmee021_desc
   DISPLAY BY NAME g_xmee_m.xmee021_desc 
    
   CALL adbt510_xmee004_ref(g_xmee_m.xmee022) RETURNING g_xmee_m.xmee022_desc
   DISPLAY BY NAME g_xmee_m.xmee022_desc 
             
   CALL adbt510_xmee023_ref(g_xmee_m.xmee023) RETURNING g_xmee_m.xmee023_desc
   DISPLAY BY NAME g_xmee_m.xmee023_desc
    
   CALL adbt510_xmee024_ref(g_xmee_m.xmee024) RETURNING g_xmee_m.xmee024_desc
   DISPLAY BY NAME g_xmee_m.xmee024_desc

   CALL adbt510_xmee004_ref(g_xmee_m.xmee034) RETURNING g_xmee_m.xmee034_desc
   DISPLAY BY NAME g_xmee_m.xmee034_desc
    
   CALL adbt510_xmee032_ref(g_xmee_m.xmee032) RETURNING g_xmee_m.xmee032_desc
   DISPLAY BY NAME g_xmee_m.xmee032_desc
    
   CALL adbt510_xmee035_ref(g_xmee_m.xmee035) RETURNING g_xmee_m.xmee035_desc
   DISPLAY BY NAME g_xmee_m.xmee035_desc
    
   CALL adbt510_xmee004_ref(g_xmee_m.xmee036) RETURNING g_xmee_m.xmee036_desc
   DISPLAY BY NAME g_xmee_m.xmee036_desc
    
   CALL adbt510_xmee200_ref()
   CALL adbt510_xmee201_ref()
   CALL adbt510_xmee202_ref()
   CALL adbt510_xmee203_ref()
   CALL adbt510_xmee204_ref()
   CALL adbt510_xmee206_ref()
   CALL adbt510_xmee207_ref()
   CALL adbt510_xmeeunit_ref()
    
   LET l_pmaa027 = ''
   LET g_xmee_m.xmee026_desc = ''
   LET g_xmee_m.oofb017_1 = ''
   IF NOT cl_null(g_xmee_m.xmee021) AND NOT cl_null(g_xmee_m.xmee026) THEN 
      CALL adbt510_get_pmaa027(g_xmee_m.xmee021) RETURNING l_pmaa027  
      CALL adbt510_xmee025_ref(l_pmaa027,g_xmee_m.xmee026) RETURNING g_xmee_m.xmee026_desc
      DISPLAY BY NAME g_xmee_m.xmee026_desc               
      CALL s_aooi350_get_address(l_pmaa027,g_xmee_m.xmee026,g_lang)RETURNING r_success,r_address
      LET g_xmee_m.oofb017_1 = r_address
      DISPLAY BY NAME g_xmee_m.oofb017_1
   END IF


   LET l_pmaa027 = ''
   LET g_xmee_m.xmee025_desc = ''
   LET g_xmee_m.oofb017 = ''
   IF NOT cl_null(g_xmee_m.xmee022) AND NOT cl_null(g_xmee_m.xmee025) THEN   
      CALL adbt510_get_pmaa027(g_xmee_m.xmee022) RETURNING l_pmaa027  
      CALL adbt510_xmee025_ref(l_pmaa027,g_xmee_m.xmee025) RETURNING g_xmee_m.xmee025_desc
      DISPLAY BY NAME g_xmee_m.xmee025_desc                    
      CALL s_aooi350_get_address(l_pmaa027,g_xmee_m.xmee025,g_lang)RETURNING r_success,r_address
      LET g_xmee_m.oofb017 = r_address
      DISPLAY BY NAME g_xmee_m.oofb017
   END IF


   LET g_xmee_m_t.* = g_xmee_m.*
   LET g_xmee_m_o.* = g_xmee_m.*
   
   RETURN r_success
END FUNCTION]]>
</point>
  <point name="function.adbt510_xmeedocno_xmjb" cite_std="N" status="u" ver="2" src="s" new="Y" order="87" mark_hard="N">
<![CDATA[#依據輸入的訂單單號，帶出單身欄位的值
PRIVATE FUNCTION adbt510_xmeedocno_xmjb()
DEFINE l_sql             STRING
DEFINE r_success         LIKE type_t.num5

   LET r_success = TRUE

   IF cl_null(g_xmee_m.xmeedocno) THEN
      LET r_success = FALSE
      RETURN r_success
   END IF

   LET l_sql = "SELECT xmjaunit,xmjaseq,xmjasite,xmja001,xmja002, ",
               "       xmja003,xmja033,xmja004,xmja005,xmja006, ",
               "       xmja007,xmja011,xmja012,xmja013,xmja014, ",
               "       xmja015,xmja016,xmja017,xmja018,xmja008, ",
               "       xmja009,xmja010,xmja022,xmja019,xmja020, ",
               "       xmja021,xmja024,xmja025,xmja026,xmja027, ",
               "       xmja028,xmja029,xmja030,xmja031,xmja032, ",
               "       xmja034 ",
               "  FROM xmja_t ",
               " WHERE xmjaent = '",g_enterprise,"'", 
               "   AND xmjadocno = '",g_xmee_m.xmeedocno,"'",  
               " ORDER BY xmjaseq "

   PREPARE sel_xmja_pre FROM l_sql
   DECLARE sel_xmja_cur CURSOR FOR sel_xmja_pre

   LET l_ac = 1               
   FOREACH sel_xmja_cur INTO g_xmeg4_d[l_ac].xmjbunit,g_xmeg4_d[l_ac].xmjbseq,g_xmeg4_d[l_ac].xmjbsite,g_xmeg4_d[l_ac].xmjb001,g_xmeg4_d[l_ac].xmjb002, 
                             g_xmeg4_d[l_ac].xmjb003,g_xmeg4_d[l_ac].xmjb033,g_xmeg4_d[l_ac].xmjb004,g_xmeg4_d[l_ac].xmjb005,g_xmeg4_d[l_ac].xmjb006, 
                             g_xmeg4_d[l_ac].xmjb007,g_xmeg4_d[l_ac].xmjb011,g_xmeg4_d[l_ac].xmjb012,g_xmeg4_d[l_ac].xmjb013,g_xmeg4_d[l_ac].xmjb014, 
                             g_xmeg4_d[l_ac].xmjb015,g_xmeg4_d[l_ac].xmjb016,g_xmeg4_d[l_ac].xmjb017,g_xmeg4_d[l_ac].xmjb018,g_xmeg4_d[l_ac].xmjb008, 
                             g_xmeg4_d[l_ac].xmjb009,g_xmeg4_d[l_ac].xmjb010,g_xmeg4_d[l_ac].xmjb022,g_xmeg4_d[l_ac].xmjb019,g_xmeg4_d[l_ac].xmjb020, 
                             g_xmeg4_d[l_ac].xmjb021,g_xmeg4_d[l_ac].xmjb024,g_xmeg4_d[l_ac].xmjb025,g_xmeg4_d[l_ac].xmjb026,g_xmeg4_d[l_ac].xmjb027, 
                             g_xmeg4_d[l_ac].xmjb028,g_xmeg4_d[l_ac].xmjb029,g_xmeg4_d[l_ac].xmjb030,g_xmeg4_d[l_ac].xmjb031,g_xmeg4_d[l_ac].xmjb032, 
                             g_xmeg4_d[l_ac].xmjb034 
 
      LET g_xmeg4_d[l_ac].xmjb901 = '1'   #未變更
      
      CALL adbt510_xmjbsite_ref()      
      CALL adbt510_xmjb003_ref()
      CALL adbt510_xmjb005_ref()
      CALL adbt510_xmjb006_ref()
      CALL adbt510_xmjb011_ref()
      CALL adbt510_xmjb013_ref()
      CALL adbt510_xmjb015_ref()
      CALL adbt510_xmjb017_ref()
      CALL adbt510_xmjb024_ref()
      CALL adbt510_xmjb026_ref()
      CALL adbt510_xmjb027_ref()


      LET l_ac = l_ac + 1
      IF l_ac > g_max_rec THEN
         CALL cl_err('',9035,0)
         EXIT FOREACH
      END IF
        
    END FOREACH

   CALL g_xmeg4_d.deleteElement(g_xmeg4_d.getLength())

   LET g_rec_b = l_ac - 1
   LET l_ac = 0
   FREE sel_xmja_pre

   DISPLAY ARRAY g_xmeg4_d TO s_detail4.* ATTRIBUTES(COUNT = g_rec_b)
      BEFORE DISPLAY
         EXIT DISPLAY
   END DISPLAY

   RETURN r_success
END FUNCTION]]>
</point>
  <point name="function.adbt510_xmeedocno_xmeg" cite_std="N" status="u" ver="2" src="s" new="Y" order="88" mark_hard="N">
<![CDATA[#依據輸入的訂單單號，帶出單身欄位的值
PRIVATE FUNCTION adbt510_xmeedocno_xmeg()
DEFINE l_sql             STRING
DEFINE r_success         LIKE type_t.num5

   LET r_success = TRUE

   IF cl_null(g_xmee_m.xmeedocno) THEN
      LET r_success = FALSE
      RETURN r_success
   END IF

   LET l_sql = "SELECT xmdcsite,xmdcseq,xmdc027,xmdc001,xmdc002, ",
               "       xmdc004,xmdc005,xmdc006,xmdc007,xmdc008, ",
               "       xmdc009,xmdc024,xmdc012,xmdc013,xmdc045, ",
               "       xmdc010,xmdc011,xmdc015,xmdc016,xmdc017, ",
               "       xmdc046,xmdc047,xmdc048,xmdc023,xmdc019, ",
               "       xmdc020,xmdc021,xmdc022,xmdcunit,xmdcorga, ",
               "       xmdc052,xmdc049,xmdc053,xmdc050 ",
               "  FROM xmdc_t ",
               " WHERE xmdcent = '",g_enterprise,"'", 
               "   AND xmdcdocno = '",g_xmee_m.xmeedocno,"'",  
               " ORDER BY xmdcseq "

   PREPARE sel_xmdc_pre FROM l_sql
   DECLARE sel_xmdc_cur CURSOR FOR sel_xmdc_pre

   LET l_ac = 1               
   FOREACH sel_xmdc_cur INTO g_xmeg_d[l_ac].xmegsite,g_xmeg_d[l_ac].xmegseq,g_xmeg_d[l_ac].xmeg027,g_xmeg_d[l_ac].xmeg001,g_xmeg_d[l_ac].xmeg002,
                             g_xmeg_d[l_ac].xmeg004,g_xmeg_d[l_ac].xmeg005,g_xmeg_d[l_ac].xmeg006,g_xmeg_d[l_ac].xmeg007,g_xmeg_d[l_ac].xmeg008,
                             g_xmeg_d[l_ac].xmeg009,g_xmeg_d[l_ac].xmeg024,g_xmeg_d[l_ac].xmeg012,g_xmeg_d[l_ac].xmeg013,g_xmeg_d[l_ac].xmeg045,
                             g_xmeg_d[l_ac].xmeg010,g_xmeg_d[l_ac].xmeg011,g_xmeg_d[l_ac].xmeg015,g_xmeg_d[l_ac].xmeg016,g_xmeg_d[l_ac].xmeg017,
                             g_xmeg_d[l_ac].xmeg046,g_xmeg_d[l_ac].xmeg047,g_xmeg_d[l_ac].xmeg048,g_xmeg_d[l_ac].xmeg023,g_xmeg_d[l_ac].xmeg019, 
                             g_xmeg_d[l_ac].xmeg020,g_xmeg_d[l_ac].xmeg021,g_xmeg_d[l_ac].xmeg022,g_xmeg_d[l_ac].xmegunit,g_xmeg_d[l_ac].xmegorga, 
                             g_xmeg_d[l_ac].xmeg052,g_xmeg_d[l_ac].xmeg049,g_xmeg_d[l_ac].xmeg053,g_xmeg_d[l_ac].xmeg050

      LET g_xmeg_d[l_ac].xmeg901 = '1'   #未變更

      CALL adbt510_xmeg001_ref(g_xmeg_d[l_ac].xmeg001) RETURNING g_xmeg_d[l_ac].xmeg001_desc,g_xmeg_d[l_ac].xmeg001_desc_desc
      CALL adbt510_xmeg004_ref(g_xmeg_d[l_ac].xmeg004) RETURNING g_xmeg_d[l_ac].xmeg004_desc
      CALL adbt510_unit_ref(g_xmeg_d[l_ac].xmeg006) RETURNING g_xmeg_d[l_ac].xmeg006_desc   
      CALL adbt510_unit_ref(g_xmeg_d[l_ac].xmeg008) RETURNING g_xmeg_d[l_ac].xmeg008_desc
      CALL adbt510_unit_ref(g_xmeg_d[l_ac].xmeg010) RETURNING g_xmeg_d[l_ac].xmeg010_desc
      CALL adbt510_xmee011_ref(g_xmeg_d[l_ac].xmeg016) RETURNING g_xmeg_d[l_ac].xmeg016_desc
      CALL adbt510_xmee003_ref(g_xmeg_d[l_ac].xmegunit) RETURNING g_xmeg_d[l_ac].xmegunit_desc
      CALL adbt510_xmee003_ref(g_xmeg_d[l_ac].xmegorga) RETURNING g_xmeg_d[l_ac].xmegorga_desc
      CALL adbt510_xmeg049_ref(g_xmeg_d[l_ac].xmeg049) RETURNING g_xmeg_d[l_ac].xmeg049_desc 
                     

      LET l_ac = l_ac + 1
      IF l_ac > g_max_rec THEN
         CALL cl_err('',9035,0)
         EXIT FOREACH
      END IF
        
    END FOREACH

   CALL g_xmeg_d.deleteElement(g_xmeg_d.getLength())

   LET g_rec_b = l_ac - 1
   LET l_ac = 0
   FREE sel_xmdc_pre

   DISPLAY ARRAY g_xmeg_d TO s_detail1.* ATTRIBUTES(COUNT = g_rec_b)
      BEFORE DISPLAY
         EXIT DISPLAY
   END DISPLAY

   RETURN r_success
   
END FUNCTION]]>
</point>
  <point name="function.adbt510_xmeedocno_xmeh" cite_std="N" status="u" ver="2" src="s" new="Y" order="89" mark_hard="N">
<![CDATA[#依據輸入的訂單單號，帶出單身欄位的值
PRIVATE FUNCTION adbt510_xmeedocno_xmeh()
DEFINE l_sql             STRING
DEFINE r_success         LIKE type_t.num5

   LET r_success = TRUE

   IF cl_null(g_xmee_m.xmeedocno) THEN
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   LET l_sql = "SELECT xmddsite,xmdddocno,xmddseq,xmddseq1,xmdd003, ",
               "       xmdd001,xmdd002,xmdd004,xmdd005,xmddseq2, ",
               "       xmdd006,xmdd024,xmdd025,xmdd011,xmdd012, ",
               "       xmdd031,xmdd014,xmdd015,xmdd016,xmdd017, ",
               "       xmdd026,xmdd027,xmdd019,xmdd028,xmdd029, ",
               "       xmdd030,xmdd200,xmdd201,xmdd202,xmdd203, ",
               "       xmdd204,xmdd205,xmdd206,xmdd207,xmddunit, ",
               "       xmdd210,xmdd212,xmdd213,xmdd214,xmdd215, ",
               "       xmdd218,xmdd219,xmdd220,xmdd221,xmdd222, ",
               "       xmdd223,xmdd224,xmddorga,xmdd226,xmdd227, ",
               "       xmdd228,xmdd229 ",
               "  FROM xmdd_t ",
               " WHERE xmddent = '",g_enterprise,"'", 
               "   AND xmdddocno = '",g_xmee_m.xmeedocno,"'",         
               " ORDER BY xmddseq,xmddseq1 "

   PREPARE sel_xmdd_pre FROM l_sql
   DECLARE sel_xmdd_cur CURSOR FOR sel_xmdd_pre

   LET l_ac = 1               
   FOREACH sel_xmdd_cur INTO g_xmeg3_d[l_ac].xmehsite,g_xmeg3_d[l_ac].xmehdocno,g_xmeg3_d[l_ac].xmehseq,g_xmeg3_d[l_ac].xmehseq1,g_xmeg3_d[l_ac].xmeh003, 
                             g_xmeg3_d[l_ac].xmeh001,g_xmeg3_d[l_ac].xmeh002,g_xmeg3_d[l_ac].xmeh004,g_xmeg3_d[l_ac].xmeh005,g_xmeg3_d[l_ac].xmehseq2, 
                             g_xmeg3_d[l_ac].xmeh006,g_xmeg3_d[l_ac].xmeh024,g_xmeg3_d[l_ac].xmeh025,g_xmeg3_d[l_ac].xmeh011,g_xmeg3_d[l_ac].xmeh012, 
                             g_xmeg3_d[l_ac].xmeh031,g_xmeg3_d[l_ac].xmeh014,g_xmeg3_d[l_ac].xmeh015,g_xmeg3_d[l_ac].xmeh016,g_xmeg3_d[l_ac].xmeh017, 
                             g_xmeg3_d[l_ac].xmeh026,g_xmeg3_d[l_ac].xmeh027,g_xmeg3_d[l_ac].xmeh019,g_xmeg3_d[l_ac].xmeh028,g_xmeg3_d[l_ac].xmeh029,  
                             g_xmeg3_d[l_ac].xmeh030, g_xmeg3_d[l_ac].xmeh200,g_xmeg3_d[l_ac].xmeh201,g_xmeg3_d[l_ac].xmeh202,g_xmeg3_d[l_ac].xmeh203,
                             g_xmeg3_d[l_ac].xmeh204,g_xmeg3_d[l_ac].xmeh205,g_xmeg3_d[l_ac].xmeh206,g_xmeg3_d[l_ac].xmeh207,g_xmeg3_d[l_ac].xmehunit,
                             g_xmeg3_d[l_ac].xmeh210,g_xmeg3_d[l_ac].xmeh212,g_xmeg3_d[l_ac].xmeh213,g_xmeg3_d[l_ac].xmeh214,g_xmeg3_d[l_ac].xmeh215,
                             g_xmeg3_d[l_ac].xmeh218,g_xmeg3_d[l_ac].xmeh219,g_xmeg3_d[l_ac].xmeh220,g_xmeg3_d[l_ac].xmeh221,g_xmeg3_d[l_ac].xmeh222,
                             g_xmeg3_d[l_ac].xmeh223,g_xmeg3_d[l_ac].xmeh224,g_xmeg3_d[l_ac].xmehorga,g_xmeg3_d[l_ac].xmeh226,g_xmeg3_d[l_ac].xmeh227,
                             g_xmeg3_d[l_ac].xmeh228,g_xmeg3_d[l_ac].xmeh229


      #抓取約定交貨日、預計簽收日期
      SELECT xmdc012,xmdc013
        INTO g_xmeg3_d[l_ac].xmeg012,g_xmeg3_d[l_ac].xmeg013
        FROM xmdc_t
       WHERE xmdcent = g_enterprise
         AND xmdcdocno = g_xmeg3_d[l_ac].xmehdocno
         AND xmdcseq = g_xmeg3_d[l_ac].xmehseq

      LET g_xmeg3_d[l_ac].xmeh901 = '1'   #未變更 
      
      CALL adbt510_xmeg001_ref(g_xmeg3_d[l_ac].xmeh001) RETURNING g_xmeg3_d[l_ac].xmeh001_desc,g_xmeg3_d[l_ac].xmeh001_desc_desc
      CALL adbt510_unit_ref(g_xmeg3_d[l_ac].xmeh004) RETURNING g_xmeg3_d[l_ac].xmeh004_desc
      CALL adbt510_xmee011_ref(g_xmeg3_d[l_ac].xmeh019) RETURNING g_xmeg3_d[l_ac].xmeh019_desc
      CALL adbt510_unit_ref(g_xmeg3_d[l_ac].xmeh024) RETURNING g_xmeg3_d[l_ac].xmeh024_desc
      CALL adbt510_unit_ref(g_xmeg3_d[l_ac].xmeh026) RETURNING g_xmeg3_d[l_ac].xmeh026_desc


      LET l_ac = l_ac + 1
      IF l_ac > g_max_rec THEN
         CALL cl_err('',9035,0)
         EXIT FOREACH
      END IF
        
    END FOREACH

    CALL g_xmeg3_d.deleteElement(g_xmeg3_d.getLength())
    
    LET g_rec_b = l_ac - 1
    LET l_ac = 0
    FREE sel_xmdd_pre

    DISPLAY ARRAY g_xmeg3_d TO s_detail3.* ATTRIBUTES(COUNT=g_rec_b)
       BEFORE DISPLAY
          EXIT DISPLAY
    END DISPLAY
    RETURN r_success
END FUNCTION]]>
</point>
  <point name="function.adbt510_xmeedocno_xmef" cite_std="N" status="u" ver="2" src="s" new="Y" order="90" mark_hard="N">
<![CDATA[#依據輸入的訂單單號，帶出單身欄位的值
PRIVATE FUNCTION adbt510_xmeedocno_xmef()
DEFINE l_sql             STRING
DEFINE r_success         LIKE type_t.num5

   LET r_success = TRUE

   IF cl_null(g_xmee_m.xmeedocno) THEN
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   LET l_sql = "SELECT xmdbsite,xmdb001,xmdb002,xmdb003,xmdb004, ",
               "       xmdb005,xmdb006,xmdb007,xmdb008,xmdb009 ",
               "  FROM xmdb_t ",
               " WHERE xmdbent = '",g_enterprise,"'",
               "   AND xmdbdocno= '",g_xmee_m.xmeedocno,"'",  
               "  ORDER BY xmdb001 "                  

   PREPARE sel_xmdb_pre FROM l_sql
   DECLARE sel_xmdb_cur CURSOR FOR sel_xmdb_pre

   LET l_ac = 1               
   FOREACH sel_xmdb_cur INTO g_xmeg5_d[l_ac].xmefsite,g_xmeg5_d[l_ac].xmef001,g_xmeg5_d[l_ac].xmef002,g_xmeg5_d[l_ac].xmef003,g_xmeg5_d[l_ac].xmef004, 
                             g_xmeg5_d[l_ac].xmef005,g_xmeg5_d[l_ac].xmef006,g_xmeg5_d[l_ac].xmef007,g_xmeg5_d[l_ac].xmef008,g_xmeg5_d[l_ac].xmef009 

      LET g_xmeg5_d[l_ac].xmef901 = '1'   #未變更
      CALL adbt510_xmee009_ref(g_xmeg5_d[l_ac].xmef002) RETURNING g_xmeg5_d[l_ac].xmef002_desc

      LET l_ac = l_ac + 1
      IF l_ac > g_max_rec THEN
         CALL cl_err('',9035,0)
         EXIT FOREACH
      END IF
        
    END FOREACH
    
    CALL g_xmeg5_d.deleteElement(g_xmeg5_d.getLength())
    LET g_rec_b = l_ac - 1
    LET l_ac = 0
    FREE sel_xmdb_pre 
    
    DISPLAY ARRAY g_xmeg5_d TO s_detail5.* ATTRIBUTES(COUNT=g_rec_b) 
       BEFORE DISPLAY
          EXIT DISPLAY
    END DISPLAY
    
    RETURN r_success  
END FUNCTION]]>
</point>
  <point name="function.adbt510_ins_xmjb" cite_std="N" status="u" ver="2" src="s" new="Y" order="91" mark_hard="N">
<![CDATA[#將單身資料新增到資料庫內
PRIVATE FUNCTION adbt510_ins_xmjb()
DEFINE l_i               LIKE type_t.num5
DEFINE r_success         LIKE type_t.num5

   LET r_success = TRUE
 
   FOR l_i = 1 TO g_xmeg4_d.getLength()  
      INSERT INTO xmjb_t
                  (xmjbent,xmjbsite,xmjbunit,xmjbdocno,xmjbseq,
                   xmjb001,xmjb002,xmjb003,xmjb004,xmjb005,xmjb006,
                   xmjb007,xmjb008,xmjb009,xmjb010,xmjb011,xmjb012,
                   xmjb013,xmjb014,xmjb015,xmjb016,xmjb017,xmjb018,
                   xmjb900,xmjb901,xmjb902,xmjb903,xmjb019,xmjb020,
                   xmjb021,xmjb022,xmjb024,xmjb025,xmjb026,xmjb027,
                   xmjb028,xmjb029,xmjb030,xmjb031,xmjb032,xmjb033,
                   xmjb034) 
            VALUES(g_enterprise,g_xmeg4_d[l_i].xmjbsite,g_xmeg4_d[l_i].xmjbunit,g_xmee_m.xmeedocno,g_xmeg4_d[l_i].xmjbseq,
                   g_xmeg4_d[l_i].xmjb001,g_xmeg4_d[l_i].xmjb002,g_xmeg4_d[l_i].xmjb003,g_xmeg4_d[l_i].xmjb004,g_xmeg4_d[l_i].xmjb005,g_xmeg4_d[l_i].xmjb006,
                   g_xmeg4_d[l_i].xmjb007,g_xmeg4_d[l_i].xmjb008,g_xmeg4_d[l_i].xmjb009,g_xmeg4_d[l_i].xmjb010,g_xmeg4_d[l_i].xmjb011,g_xmeg4_d[l_i].xmjb012,
                   g_xmeg4_d[l_i].xmjb013,g_xmeg4_d[l_i].xmjb014,g_xmeg4_d[l_i].xmjb015,g_xmeg4_d[l_i].xmjb016,g_xmeg4_d[l_i].xmjb017,g_xmeg4_d[l_i].xmjb018,
                   g_xmee_m.xmee900,g_xmeg4_d[l_i].xmjb901,g_xmeg4_d[l_i].xmjb902,g_xmeg4_d[l_i].xmjb903,g_xmeg4_d[l_i].xmjb019,g_xmeg4_d[l_i].xmjb020,
                   g_xmeg4_d[l_i].xmjb021,g_xmeg4_d[l_i].xmjb022,g_xmeg4_d[l_i].xmjb024,g_xmeg4_d[l_i].xmjb025,g_xmeg4_d[l_i].xmjb026,g_xmeg4_d[l_i].xmjb027,
                   g_xmeg4_d[l_i].xmjb028,g_xmeg4_d[l_i].xmjb029,g_xmeg4_d[l_i].xmjb030,g_xmeg4_d[l_i].xmjb031,g_xmeg4_d[l_i].xmjb032,g_xmeg4_d[l_i].xmjb033,
                   g_xmeg4_d[l_i].xmjb034)       

      IF SQLCA.sqlcode THEN
         CALL cl_err('ins xmjb_t',SQLCA.sqlcode,1)
         LET r_success = FALSE
         EXIT FOR
      END IF

   END FOR

   RETURN r_success 
END FUNCTION]]>
</point>
  <point name="function.adbt510_ins_xmeg" cite_std="N" status="u" ver="3" src="s" new="Y" order="92" mark_hard="N">
<![CDATA[#將單身資料新增到資料庫內
PRIVATE FUNCTION adbt510_ins_xmeg()
DEFINE l_i               LIKE type_t.num5
DEFINE r_success         LIKE type_t.num5
DEFINE l_xmeg            RECORD
          xmeg003        LIKE xmeg_t.xmeg003,
          xmeg031        LIKE xmeg_t.xmeg031,
          xmeg032        LIKE xmeg_t.xmeg032,
          xmeg033        LIKE xmeg_t.xmeg033,
          xmeg034        LIKE xmeg_t.xmeg034,
          xmeg036        LIKE xmeg_t.xmeg036,
          xmeg037        LIKE xmeg_t.xmeg037,
          xmeg038        LIKE xmeg_t.xmeg038,
          xmeg039        LIKE xmeg_t.xmeg039
       END RECORD
   LET r_success = TRUE

   FOR l_i = 1 TO g_xmeg_d.getLength()
       INITIALIZE l_xmeg.* TO NULL
       #其他資料
       SELECT xmdc003,xmdc031,xmdc032,xmdc033,
              xmdc034,xmdc036,xmdc037,xmdc038,xmdc039
         INTO l_xmeg.xmeg003,l_xmeg.xmeg031,l_xmeg.xmeg032,l_xmeg.xmeg033,
              l_xmeg.xmeg034,l_xmeg.xmeg036,l_xmeg.xmeg037,l_xmeg.xmeg038,l_xmeg.xmeg039
         FROM xmdc_t
        WHERE xmdcent = g_enterprise
          AND xmdcdocno = g_xmee_m.xmeedocno
          AND xmdcseq = g_xmeg_d[l_i].xmegseq
       
       INSERT INTO xmeg_t
                   (xmegent,xmegdocno,xmeg900,xmegseq,xmegsite,
                    xmeg027,xmeg001,xmeg002,xmeg004,xmeg005,
                    xmeg006,xmeg007,xmeg008,xmeg009,xmeg024,
                    xmeg012,xmeg013,xmeg045,xmeg016,xmeg017,
                    xmeg010,xmeg011,xmeg015,xmeg046,xmeg047,
                    xmeg048,xmeg023,xmeg019,xmeg020,xmeg021,
                    xmeg022,xmegunit,xmegorga,xmeg052,xmeg049,
                    xmeg053,xmeg050,xmeg901,xmeg902,xmeg903,
                    xmeg003,xmeg031,xmeg032,xmeg033,
                    xmeg034,xmeg036,xmeg037,xmeg038,xmeg039) 
             VALUES(g_enterprise,g_xmee_m.xmeedocno,g_xmee_m.xmee900,g_xmeg_d[l_i].xmegseq,g_xmeg_d[l_i].xmegsite,
                    g_xmeg_d[l_i].xmeg027,g_xmeg_d[l_i].xmeg001,g_xmeg_d[l_i].xmeg002,g_xmeg_d[l_i].xmeg004,g_xmeg_d[l_i].xmeg005,
                    g_xmeg_d[l_i].xmeg006,g_xmeg_d[l_i].xmeg007,g_xmeg_d[l_i].xmeg008,g_xmeg_d[l_i].xmeg009,g_xmeg_d[l_i].xmeg024,
                    g_xmeg_d[l_i].xmeg012,g_xmeg_d[l_i].xmeg013,g_xmeg_d[l_i].xmeg045,g_xmeg_d[l_i].xmeg016,g_xmeg_d[l_i].xmeg017,
                    g_xmeg_d[l_i].xmeg010,g_xmeg_d[l_i].xmeg011,g_xmeg_d[l_i].xmeg015,g_xmeg_d[l_i].xmeg046,g_xmeg_d[l_i].xmeg047,
                    g_xmeg_d[l_i].xmeg048,g_xmeg_d[l_i].xmeg023,g_xmeg_d[l_i].xmeg019,g_xmeg_d[l_i].xmeg020,g_xmeg_d[l_i].xmeg021,
                    g_xmeg_d[l_i].xmeg022,g_xmeg_d[l_i].xmegunit,g_xmeg_d[l_i].xmegorga,g_xmeg_d[l_i].xmeg052,g_xmeg_d[l_i].xmeg049,
                    g_xmeg_d[l_i].xmeg053,g_xmeg_d[l_i].xmeg050,g_xmeg_d[l_i].xmeg901,g_xmeg_d[l_i].xmeg902,g_xmeg_d[l_i].xmeg903,
                    l_xmeg.xmeg003,l_xmeg.xmeg031,l_xmeg.xmeg032,l_xmeg.xmeg033,
                    l_xmeg.xmeg034,l_xmeg.xmeg036,l_xmeg.xmeg037,l_xmeg.xmeg038,l_xmeg.xmeg039) 
                   
      IF SQLCA.sqlcode THEN
         CALL cl_err('ins xmeg_t',SQLCA.sqlcode,1)
         LET r_success = FALSE
         EXIT FOR
      END IF

   END FOR

   RETURN r_success  
END FUNCTION]]>
</point>
  <point name="function.adbt510_ins_xmef" cite_std="N" status="u" ver="2" src="s" new="Y" order="93" mark_hard="N">
<![CDATA[#將多期預收款資料新增到資料庫內
PRIVATE FUNCTION adbt510_ins_xmef()
DEFINE l_i               LIKE type_t.num5
DEFINE l_cnt             LIKE type_t.num5
DEFINE r_success         LIKE type_t.num5

   LET r_success = TRUE

      FOR l_i = 1 TO g_xmeg5_d.getLength()  
         INSERT INTO xmef_t
                     (xmefent,xmefdocno,xmef900,xmef001,xmefsite,
                      xmef002,xmef003,xmef004,xmef005,xmef006,
                      xmef007,xmef008,xmef009,xmef901) 
               VALUES(g_enterprise,g_xmee_m.xmeedocno,g_xmee_m.xmee900,g_xmeg5_d[l_i].xmef001,g_xmee_m.xmeesite,
                      g_xmeg5_d[l_i].xmef002,g_xmeg5_d[l_i].xmef003,g_xmeg5_d[l_i].xmef004,g_xmeg5_d[l_i].xmef005,g_xmeg5_d[l_i].xmef006, 
                      g_xmeg5_d[l_i].xmef007,g_xmeg5_d[l_i].xmef008,g_xmeg5_d[l_i].xmef009,g_xmeg5_d[l_i].xmef901) 
                      
         IF SQLCA.sqlcode THEN
            CALL cl_err('ins xmef_t',SQLCA.sqlcode,1)
            LET r_success = FALSE
            EXIT FOR
         END IF  
      END FOR

   RETURN r_success 

END FUNCTION]]>
</point>
  <point name="function.adbt510_ins_xmeh" cite_std="N" status="u" ver="3" src="s" new="Y" order="94" mark_hard="N">
<![CDATA[#將交期明細資料新增到資料庫內
PRIVATE FUNCTION adbt510_ins_xmeh()
DEFINE l_i               LIKE type_t.num5
DEFINE r_success         LIKE type_t.num5

   LET r_success = TRUE
 
   FOR l_i = 1 TO g_xmeg3_d.getLength()  
      INSERT INTO xmeh_t
                  (xmehent,xmehdocno,xmeh900,xmehseq,xmehseq1,
                   xmehseq2,xmehsite,xmeh003,xmeh001,xmeh002,
                   xmeh004,xmeh005,xmeh006,xmeh024,xmeh025,
                   xmeh011,xmeh012,xmeh031,xmeh014,xmeh015,
                   xmeh016,xmeh017,xmeh026,xmeh027,xmeh019,
                   xmeh028,xmeh029,xmeh030,
                   xmeh901,xmeh200,xmeh201,xmeh202,xmeh203, 
                   xmeh204,xmeh205,xmeh206,xmeh207,xmehunit, 
                   xmeh210,xmeh212,xmeh213,xmeh214,xmeh215, 
                   xmeh218,xmeh219,xmeh220,xmeh221,xmeh222, 
                   xmeh223,xmeh224,xmehorga,xmeh226,xmeh227, 
                   xmeh228,xmeh229) 
            VALUES(g_enterprise,g_xmee_m.xmeedocno,g_xmee_m.xmee900,g_xmeg3_d[l_i].xmehseq,g_xmeg3_d[l_i].xmehseq1,
                   g_xmeg3_d[l_i].xmehseq2,g_xmee_m.xmeesite,g_xmeg3_d[l_i].xmeh003,g_xmeg3_d[l_i].xmeh001,g_xmeg3_d[l_i].xmeh002,
                   g_xmeg3_d[l_i].xmeh004,g_xmeg3_d[l_i].xmeh005,g_xmeg3_d[l_i].xmeh006,g_xmeg3_d[l_i].xmeh024,g_xmeg3_d[l_i].xmeh025, 
                   g_xmeg3_d[l_i].xmeh011,g_xmeg3_d[l_i].xmeh012,g_xmeg3_d[l_i].xmeh031,g_xmeg3_d[l_i].xmeh014,g_xmeg3_d[l_i].xmeh015,
                   g_xmeg3_d[l_i].xmeh016,g_xmeg3_d[l_i].xmeh017,g_xmeg3_d[l_i].xmeh026,g_xmeg3_d[l_i].xmeh027,g_xmeg3_d[l_i].xmeh019,
                   g_xmeg3_d[l_i].xmeh028,g_xmeg3_d[l_i].xmeh029,g_xmeg3_d[l_i].xmeh030,
                   g_xmeg3_d[l_i].xmeh901,g_xmeg3_d[l_i].xmeh200,g_xmeg3_d[l_i].xmeh201,g_xmeg3_d[l_i].xmeh202,g_xmeg3_d[l_i].xmeh203, 
                   g_xmeg3_d[l_i].xmeh204,g_xmeg3_d[l_i].xmeh205,g_xmeg3_d[l_i].xmeh206,g_xmeg3_d[l_i].xmeh207,g_xmeg3_d[l_i].xmehunit, 
                   g_xmeg3_d[l_i].xmeh210,g_xmeg3_d[l_i].xmeh212,g_xmeg3_d[l_i].xmeh213,g_xmeg3_d[l_i].xmeh214,g_xmeg3_d[l_i].xmeh215, 
                   g_xmeg3_d[l_i].xmeh218,g_xmeg3_d[l_i].xmeh219,g_xmeg3_d[l_i].xmeh220,g_xmeg3_d[l_i].xmeh221,g_xmeg3_d[l_i].xmeh222, 
                   g_xmeg3_d[l_i].xmeh223,g_xmeg3_d[l_i].xmeh224,g_xmeg3_d[l_i].xmehorga,g_xmeg3_d[l_i].xmeh226,g_xmeg3_d[l_i].xmeh227, 
                   g_xmeg3_d[l_i].xmeh228,g_xmeg3_d[l_i].xmeh229) 

      IF SQLCA.sqlcode THEN
         CALL cl_err('ins xmeh_t',SQLCA.sqlcode,1)
         LET r_success = FALSE
         EXIT FOR
      END IF

   END FOR

   RETURN r_success 
END FUNCTION]]>
</point>
  <point name="function.adbt510_ins_xmej" cite_std="N" status="u" ver="2" src="s" new="Y" order="95" mark_hard="N">
<![CDATA[#將交期明細資料新增到資料庫內
PRIVATE FUNCTION adbt510_ins_xmej()
DEFINE l_sql             STRING
DEFINE r_success         LIKE type_t.num5
DEFINE l_xmej     RECORD LIKE xmej_t.*

   LET r_success = TRUE
   IF cl_null(g_xmee_m.xmeedocno) THEN
      LET r_success = FALSE
      RETURN r_success
   END IF 

   LET l_sql = "SELECT xmdfseq,xmdfseq2,xmdf002,xmdf003,xmdf004, ",
               "       xmdf005,xmdf006,xmdf200,xmdf201,xmdf202,xmdfunit ", 
               "  FROM xmdf_t WHERE xmdfent = '",g_enterprise,"'",
               "   AND xmdfdocno = '",g_xmee_m.xmeedocno,"'", 
               " ORDER BY xmdfseq,xmdfseq2 "         

   PREPARE sel_xmdf_pre FROM l_sql
   DECLARE sel_xmdf_cur CURSOR FOR sel_xmdf_pre
   
   FOREACH sel_xmdf_cur INTO l_xmej.xmejseq,l_xmej.xmejseq2,l_xmej.xmej002,l_xmej.xmej003,l_xmej.xmej004,
                             l_xmej.xmej005,l_xmej.xmej006,l_xmej.xmej200,l_xmej.xmej201,l_xmej.xmej202,l_xmej.xmejunit
      IF SQLCA.sqlcode THEN
         LET r_success = FALSE
         EXIT FOREACH
      END IF
                             
      INSERT INTO xmej_t 
                 (xmejent,xmejsite,xmejdocno,xmej900,xmejseq,
                  xmejseq2,xmej002,xmej003,xmej004,xmej005,
                  xmej006,xmej901,xmej200,xmej201,xmej202,xmejunit)  
           VALUES(g_enterprise,g_xmee_m.xmeesite,g_xmee_m.xmeedocno,g_xmee_m.xmee900,l_xmej.xmejseq,
                  l_xmej.xmejseq2,l_xmej.xmej002,l_xmej.xmej003,l_xmej.xmej004,l_xmej.xmej005,
                  l_xmej.xmej006,'1',l_xmej.xmej200,l_xmej.xmej201,l_xmej.xmej202,l_xmej.xmejunit)
                  
      IF SQLCA.sqlcode THEN
         CALL cl_err('ins xmej_t',SQLCA.sqlcode,1)
         LET r_success = FALSE
         EXIT FOREACH
      END IF                             
   END FOREACH   
   RETURN r_success 
END FUNCTION]]>
</point>
  <point name="function.adbt510_head_init_color" cite_std="N" status="u" ver="3" src="s" new="Y" order="96" mark_hard="N">
<![CDATA[#單頭文字顯示的初始化
PRIVATE FUNCTION adbt510_head_init_color()
    CALL cl_set_comp_font_color("xmeestus,xmeeacti,xmee200,xmee201","black")
    CALL cl_set_comp_font_color("xmee021,xmee022,xmee203,xmee027,xmee002,xmee003","black")
    CALL cl_set_comp_font_color("xmeeunit,xmee904,xmee025,xmee026,xmee009,xmee010","black")
    CALL cl_set_comp_font_color("xmee035,xmee039,xmee071","black")
END FUNCTION]]>
</point>
  <point name="function.adbt510_detail_init_color" cite_std="N" status="u" ver="2" src="s" new="Y" order="97" mark_hard="N">
<![CDATA[
PRIVATE FUNCTION adbt510_detail_init_color()
    LET g_xmeg_d_color[l_ac].xmegsite          = 'black'
    LET g_xmeg_d_color[l_ac].xmegseq           = 'black'
    LET g_xmeg_d_color[l_ac].xmeg027           = 'black'
    LET g_xmeg_d_color[l_ac].xmeg001           = 'black'
    LET g_xmeg_d_color[l_ac].xmeg001_desc      = 'black'
    LET g_xmeg_d_color[l_ac].imaal004          = 'black'
    LET g_xmeg_d_color[l_ac].xmeg002           = 'black'
    LET g_xmeg_d_color[l_ac].xmeg004           = 'black'
    LET g_xmeg_d_color[l_ac].xmeg004_desc      = 'black'
    LET g_xmeg_d_color[l_ac].xmeg005           = 'black'
    LET g_xmeg_d_color[l_ac].xmeg006           = 'black'
    LET g_xmeg_d_color[l_ac].xmeg006_desc      = 'black'
    LET g_xmeg_d_color[l_ac].xmeg007           = 'black'
    LET g_xmeg_d_color[l_ac].xmeg008           = 'black'
    LET g_xmeg_d_color[l_ac].xmeg008_desc      = 'black'
    LET g_xmeg_d_color[l_ac].xmeg009           = 'black'
    LET g_xmeg_d_color[l_ac].xmeg024           = 'black'
    LET g_xmeg_d_color[l_ac].xmeg012           = 'black'
    LET g_xmeg_d_color[l_ac].xmeg013           = 'black'
    LET g_xmeg_d_color[l_ac].xmeg045           = 'black'
    LET g_xmeg_d_color[l_ac].xmeg010           = 'black'
    LET g_xmeg_d_color[l_ac].xmeg010_desc      = 'black'
    LET g_xmeg_d_color[l_ac].xmeg011           = 'black'
    LET g_xmeg_d_color[l_ac].xmeg015           = 'black'
    LET g_xmeg_d_color[l_ac].xmeg016           = 'black'
    LET g_xmeg_d_color[l_ac].xmeg016_desc      = 'black'
    LET g_xmeg_d_color[l_ac].xmeg017           = 'black'
    LET g_xmeg_d_color[l_ac].xmeg046           = 'black'
    LET g_xmeg_d_color[l_ac].xmeg047           = 'black'
    LET g_xmeg_d_color[l_ac].xmeg048           = 'black'
    LET g_xmeg_d_color[l_ac].xmeg023           = 'black'
    LET g_xmeg_d_color[l_ac].xmeg019           = 'black'
    LET g_xmeg_d_color[l_ac].xmeg020           = 'black'
    LET g_xmeg_d_color[l_ac].xmeg021           = 'black'
    LET g_xmeg_d_color[l_ac].xmeg022           = 'black'
    LET g_xmeg_d_color[l_ac].xmeg051           = 'black'
    LET g_xmeg_d_color[l_ac].xmegunit          = 'black'
    LET g_xmeg_d_color[l_ac].xmegunit_desc     = 'black'
    LET g_xmeg_d_color[l_ac].xmegorga          = 'black'
    LET g_xmeg_d_color[l_ac].xmegorga_desc     = 'black'
    LET g_xmeg_d_color[l_ac].xmeg052           = 'black'
    LET g_xmeg_d_color[l_ac].xmeg049           = 'black'
    LET g_xmeg_d_color[l_ac].xmeg049_desc      = 'black'
    LET g_xmeg_d_color[l_ac].xmeg053           = 'black'
    LET g_xmeg_d_color[l_ac].xmeg053_desc      = 'black'
    LET g_xmeg_d_color[l_ac].xmeg050           = 'black'
    LET g_xmeg_d_color[l_ac].xmeg901           = 'black'
    LET g_xmeg_d_color[l_ac].xmeg902           = 'black'
    LET g_xmeg_d_color[l_ac].xmeg902_desc      = 'black'
    LET g_xmeg_d_color[l_ac].xmeg903           = 'black'
END FUNCTION]]>
</point>
  <point name="function.adbt510_detail3_init_color" cite_std="N" status="u" ver="2" src="s" new="Y" order="98" mark_hard="N">
<![CDATA[
PRIVATE FUNCTION adbt510_detail3_init_color()
    LET g_xmeg3_d_color[l_ac].xmehdocno         = 'black'
    LET g_xmeg3_d_color[l_ac].xmehseq           = 'black'
    LET g_xmeg3_d_color[l_ac].xmehseq1          = 'black'
    LET g_xmeg3_d_color[l_ac].xmeh229           = 'black'
    LET g_xmeg3_d_color[l_ac].xmeh003           = 'black'
    LET g_xmeg3_d_color[l_ac].xmeh001           = 'black'
    LET g_xmeg3_d_color[l_ac].xmeh001_desc      = 'black'
    LET g_xmeg3_d_color[l_ac].xmeh001_desc_desc = 'black'
    LET g_xmeg3_d_color[l_ac].xmeh002           = 'black'
    LET g_xmeg3_d_color[l_ac].xmeh200           = 'black'
    LET g_xmeg3_d_color[l_ac].xmeh200_desc      = 'black'
    LET g_xmeg3_d_color[l_ac].xmeh004           = 'black'
    LET g_xmeg3_d_color[l_ac].xmeh004_desc      = 'black'
    LET g_xmeg3_d_color[l_ac].xmeh005           = 'black'
    LET g_xmeg3_d_color[l_ac].xmeh011           = 'black'
    LET g_xmeg3_d_color[l_ac].xmeh012           = 'black'
    LET g_xmeg3_d_color[l_ac].xmeg012           = 'black'
    LET g_xmeg3_d_color[l_ac].xmeg013           = 'black'
    LET g_xmeg3_d_color[l_ac].xmehseq2          = 'black'
    LET g_xmeg3_d_color[l_ac].xmeh006           = 'black'
    LET g_xmeg3_d_color[l_ac].xmeh201           = 'black'
    LET g_xmeg3_d_color[l_ac].xmeh201_desc      = 'black'
    LET g_xmeg3_d_color[l_ac].xmeh202           = 'black'
    LET g_xmeg3_d_color[l_ac].xmeh024           = 'black'
    LET g_xmeg3_d_color[l_ac].xmeh024_desc      = 'black'
    LET g_xmeg3_d_color[l_ac].xmeh025           = 'black'
    LET g_xmeg3_d_color[l_ac].xmeh026           = 'black'
    LET g_xmeg3_d_color[l_ac].xmeh026_desc      = 'black'
    LET g_xmeg3_d_color[l_ac].xmeh027           = 'black'
    LET g_xmeg3_d_color[l_ac].xmeh203           = 'black'
    LET g_xmeg3_d_color[l_ac].xmeh204           = 'black'
    LET g_xmeg3_d_color[l_ac].xmeh205           = 'black'
    LET g_xmeg3_d_color[l_ac].xmeh206           = 'black'
    LET g_xmeg3_d_color[l_ac].xmeh029           = 'black'
    LET g_xmeg3_d_color[l_ac].xmeh028           = 'black'
    LET g_xmeg3_d_color[l_ac].xmeh019           = 'black'
    LET g_xmeg3_d_color[l_ac].xmeh019_desc      = 'black'
    LET g_xmeg3_d_color[l_ac].xmeh030           = 'black'
    LET g_xmeg3_d_color[l_ac].xmeh207           = 'black'
    LET g_xmeg3_d_color[l_ac].xmeh207_desc      = 'black'
    LET g_xmeg3_d_color[l_ac].xmehunit          = 'black'
    LET g_xmeg3_d_color[l_ac].xmehunit_desc     = 'black'
    LET g_xmeg3_d_color[l_ac].xmeh210           = 'black'
    LET g_xmeg3_d_color[l_ac].xmeh210_desc      = 'black'
    LET g_xmeg3_d_color[l_ac].xmeh212           = 'black'
    LET g_xmeg3_d_color[l_ac].xmeh213           = 'black'
    LET g_xmeg3_d_color[l_ac].xmeh213_desc      = 'black'
    LET g_xmeg3_d_color[l_ac].xmeh214           = 'black'
    LET g_xmeg3_d_color[l_ac].xmeh214_desc      = 'black'
    LET g_xmeg3_d_color[l_ac].xmeh215           = 'black'
    LET g_xmeg3_d_color[l_ac].xmeh031           = 'black'
    LET g_xmeg3_d_color[l_ac].xmeh014           = 'black'
    LET g_xmeg3_d_color[l_ac].xmeh015           = 'black'
    LET g_xmeg3_d_color[l_ac].xmeh016           = 'black'
    LET g_xmeg3_d_color[l_ac].xmeh017           = 'black'
    LET g_xmeg3_d_color[l_ac].xmeh221           = 'black'
    LET g_xmeg3_d_color[l_ac].xmehsite          = 'black'
    LET g_xmeg3_d_color[l_ac].xmehsite_desc     = 'black'
    LET g_xmeg3_d_color[l_ac].xmeh218           = 'black'
    LET g_xmeg3_d_color[l_ac].xmeh218_desc      = 'black'
    LET g_xmeg3_d_color[l_ac].xmeh219           = 'black'
    LET g_xmeg3_d_color[l_ac].xmeh219_desc      = 'black'
    LET g_xmeg3_d_color[l_ac].xmeh220           = 'black'
    LET g_xmeg3_d_color[l_ac].xmeh220_desc      = 'black'
    LET g_xmeg3_d_color[l_ac].xmeh222           = 'black'
    LET g_xmeg3_d_color[l_ac].xmeh222_desc      = 'black'
    LET g_xmeg3_d_color[l_ac].xmeh223           = 'black'
    LET g_xmeg3_d_color[l_ac].xmeh223_desc      = 'black'
    LET g_xmeg3_d_color[l_ac].xmeh224           = 'black'
    LET g_xmeg3_d_color[l_ac].xmeh224_desc      = 'black'
    LET g_xmeg3_d_color[l_ac].xmehorga          = 'black'
    LET g_xmeg3_d_color[l_ac].xmehorga_desc     = 'black'
    LET g_xmeg3_d_color[l_ac].xmeh226           = 'black'
    LET g_xmeg3_d_color[l_ac].xmeh227           = 'black'
    LET g_xmeg3_d_color[l_ac].xmeh227_desc      = 'black'
    LET g_xmeg3_d_color[l_ac].xmeh228           = 'black'
    LET g_xmeg3_d_color[l_ac].xmeh228_desc      = 'black'
    LET g_xmeg3_d_color[l_ac].xmeh901           = 'black'
END FUNCTION]]>
</point>
  <point name="function.adbt510_detail4_init_color" cite_std="N" status="u" ver="2" src="s" new="Y" order="99" mark_hard="N">
<![CDATA[
PRIVATE FUNCTION adbt510_detail4_init_color()
    LET g_xmeg4_d_color[l_ac].xmjbunit          = 'black'
    LET g_xmeg4_d_color[l_ac].xmjbseq           = 'black'
    LET g_xmeg4_d_color[l_ac].xmjbsite          = 'black'
    LET g_xmeg4_d_color[l_ac].xmjbsite_desc     = 'black'
    LET g_xmeg4_d_color[l_ac].xmjb001           = 'black'
    LET g_xmeg4_d_color[l_ac].xmjb002           = 'black'
    LET g_xmeg4_d_color[l_ac].xmjb003           = 'black'
    LET g_xmeg4_d_color[l_ac].xmjb003_desc      = 'black'
    LET g_xmeg4_d_color[l_ac].xmjb003_desc_desc = 'black'
    LET g_xmeg4_d_color[l_ac].xmjb033           = 'black'
    LET g_xmeg4_d_color[l_ac].xmjb004           = 'black'
    LET g_xmeg4_d_color[l_ac].xmjb005           = 'black'
    LET g_xmeg4_d_color[l_ac].xmjb005_desc      = 'black'
    LET g_xmeg4_d_color[l_ac].xmjb006           = 'black'
    LET g_xmeg4_d_color[l_ac].xmjb006_desc      = 'black'
    LET g_xmeg4_d_color[l_ac].xmjb007           = 'black'
    LET g_xmeg4_d_color[l_ac].xmjb011           = 'black'
    LET g_xmeg4_d_color[l_ac].xmjb011_desc      = 'black'
    LET g_xmeg4_d_color[l_ac].xmjb012           = 'black'
    LET g_xmeg4_d_color[l_ac].xmjb013           = 'black'
    LET g_xmeg4_d_color[l_ac].xmjb013_desc      = 'black'
    LET g_xmeg4_d_color[l_ac].xmjb014           = 'black'
    LET g_xmeg4_d_color[l_ac].xmjb015           = 'black'
    LET g_xmeg4_d_color[l_ac].xmjb015_desc      = 'black'
    LET g_xmeg4_d_color[l_ac].xmjb016           = 'black'
    LET g_xmeg4_d_color[l_ac].xmjb017           = 'black'
    LET g_xmeg4_d_color[l_ac].xmjb017_desc      = 'black'
    LET g_xmeg4_d_color[l_ac].xmjb018           = 'black'
    LET g_xmeg4_d_color[l_ac].xmjb008           = 'black'
    LET g_xmeg4_d_color[l_ac].xmjb009           = 'black'
    LET g_xmeg4_d_color[l_ac].xmjb010           = 'black'
    LET g_xmeg4_d_color[l_ac].xmjb022           = 'black'
    LET g_xmeg4_d_color[l_ac].xmjb019           = 'black'
    LET g_xmeg4_d_color[l_ac].xmjb020           = 'black'
    LET g_xmeg4_d_color[l_ac].xmjb021           = 'black'
    LET g_xmeg4_d_color[l_ac].xmjb024           = 'black'
    LET g_xmeg4_d_color[l_ac].xmjb024_desc      = 'black'
    LET g_xmeg4_d_color[l_ac].xmjb025           = 'black'
    LET g_xmeg4_d_color[l_ac].xmjb026           = 'black'
    LET g_xmeg4_d_color[l_ac].xmjb026_desc      = 'black'
    LET g_xmeg4_d_color[l_ac].xmjb027           = 'black'
    LET g_xmeg4_d_color[l_ac].xmjb027_desc      = 'black'
    LET g_xmeg4_d_color[l_ac].xmjb028           = 'black'
    LET g_xmeg4_d_color[l_ac].xmjb029           = 'black'
    LET g_xmeg4_d_color[l_ac].xmjb030           = 'black'
    LET g_xmeg4_d_color[l_ac].xmjb031           = 'black'
    LET g_xmeg4_d_color[l_ac].xmjb032           = 'black'
    LET g_xmeg4_d_color[l_ac].xmjb034           = 'black'
    LET g_xmeg4_d_color[l_ac].xmjb901           = 'black'
    LET g_xmeg4_d_color[l_ac].xmjb902           = 'black'
    LET g_xmeg4_d_color[l_ac].xmjb902_desc      = 'black'
    LET g_xmeg4_d_color[l_ac].xmjb903           = 'black'
END FUNCTION]]>
</point>
  <point name="function.adbt510_detail5_init_color" cite_std="N" status="u" ver="2" src="s" new="Y" order="100" mark_hard="N">
<![CDATA[
PRIVATE FUNCTION adbt510_detail5_init_color()
    LET g_xmeg5_d_color[l_ac].xmefsite          = 'black'                   
    LET g_xmeg5_d_color[l_ac].xmef001           = 'black'                  
    LET g_xmeg5_d_color[l_ac].xmef002           = 'black'                  
    LET g_xmeg5_d_color[l_ac].xmef002_desc      = 'black'                  
    LET g_xmeg5_d_color[l_ac].xmef003           = 'black'                  
    LET g_xmeg5_d_color[l_ac].xmef004           = 'black'                  
    LET g_xmeg5_d_color[l_ac].xmef005           = 'black'                  
    LET g_xmeg5_d_color[l_ac].xmef006           = 'black'                  
    LET g_xmeg5_d_color[l_ac].xmef007           = 'black'                  
    LET g_xmeg5_d_color[l_ac].xmef008           = 'black'                  
    LET g_xmeg5_d_color[l_ac].xmef009           = 'black'                  
    LET g_xmeg5_d_color[l_ac].xmef901           = 'black'                  
    LET g_xmeg5_d_color[l_ac].xmef902           = 'black'                  
    LET g_xmeg5_d_color[l_ac].xmef902_desc      = 'black'                  
    LET g_xmeg5_d_color[l_ac].xmef903           = 'black' 
END FUNCTION]]>
</point>
  <point name="function.adbt510_head_color" cite_std="N" status="u" ver="2" src="s" new="Y" order="101" mark_hard="N">
<![CDATA[
PRIVATE FUNCTION adbt510_head_color()
DEFINE l_xmek002      LIKE xmek_t.xmek002

   CALL adbt510_head_init_color()

   DECLARE sel_xmek_cs1 CURSOR FOR
    SELECT xmek002 FROM xmek_t
     WHERE xmekent = g_enterprise
       AND xmekdocno = g_xmee_m.xmeedocno
       AND xmek001 = g_xmee_m.xmee900
       AND xmekseq = 0
       AND xmekseq1= 0
       AND xmekseq2= 0

   FOREACH sel_xmek_cs1 INTO l_xmek002
      IF SQLCA.sqlcode THEN
         CALL cl_err("FOREACH:",SQLCA.sqlcode,1)
         EXIT FOREACH
      END IF

      LET l_xmek002 = cl_replace_str(l_xmek002,'xmda','xmee')

      CALL cl_set_comp_font_color(l_xmek002,"red")

   END FOREACH

END FUNCTION]]>
</point>
  <point name="function.adbt510_detail_color" cite_std="N" status="u" ver="2" src="s" new="Y" order="102" mark_hard="N">
<![CDATA[
PRIVATE FUNCTION adbt510_detail_color()
DEFINE l_xmek002         LIKE xmek_t.xmek002

   CALL adbt510_detail_init_color()

   DECLARE sel_xmek_cs CURSOR FOR
    SELECT xmek002 FROM xmek_t
     WHERE xmekent   = g_enterprise
       AND xmekdocno = g_xmee_m.xmeedocno
       AND xmek001   = g_xmee_m.xmee900
       AND xmekseq   = g_xmeg_d[l_ac].xmegseq
       AND xmekseq1  = 0
       AND xmekseq2  = 0
       AND xmek002 LIKE 'xmdc%'
   FOREACH sel_xmek_cs INTO l_xmek002
      IF SQLCA.sqlcode THEN
         CALL cl_err("FOREACH:",SQLCA.sqlcode,1)
         EXIT FOREACH
      END IF

      LET l_xmek002 = cl_replace_str(l_xmek002,'xmdc','xmeg')

      CASE l_xmek002
          WHEN 'xmeg012'                         
             LET g_xmeg_d_color[l_ac].xmeg012            = 'red'  
          WHEN 'xmeg013'                         
             LET g_xmeg_d_color[l_ac].xmeg013            = 'red'  
          WHEN 'xmeg024'                         
             LET g_xmeg_d_color[l_ac].xmeg024            = 'red'  
          WHEN 'xmeg050'                         
             LET g_xmeg_d_color[l_ac].xmeg050            = 'red'  
          WHEN 'xmeg008'                         
             LET g_xmeg_d_color[l_ac].xmeg008            = 'red'
             LET g_xmeg_d_color[l_ac].xmeg008_desc       = 'red'             
          WHEN 'xmeg009'                         
             LET g_xmeg_d_color[l_ac].xmeg009            = 'red' 
          WHEN 'xmegunit'            
             LET g_xmeg_d_color[l_ac].xmegunit           = 'red' 
             LET g_xmeg_d_color[l_ac].xmegunit_desc      = 'red'             
      END CASE
   END FOREACH 
END FUNCTION]]>
</point>
  <point name="function.adbt510_detail3_color" cite_std="N" status="u" ver="3" src="s" new="Y" order="103" mark_hard="N">
<![CDATA[
PRIVATE FUNCTION adbt510_detail3_color()
DEFINE l_xmek002         LIKE xmek_t.xmek002

   CALL adbt510_detail3_init_color()

   DECLARE sel_xmek_cs3 CURSOR FOR
    SELECT xmek002 FROM xmek_t
     WHERE xmekent   = g_enterprise
       AND xmekdocno = g_xmee_m.xmeedocno
       AND xmek001   = g_xmee_m.xmee900
       AND xmekseq   = g_xmeg3_d[l_ac].xmehseq
       AND xmekseq1  = g_xmeg3_d[l_ac].xmehseq1
       AND xmekseq2  = g_xmeg3_d[l_ac].xmehseq2
   FOREACH sel_xmek_cs3 INTO l_xmek002
      IF SQLCA.sqlcode THEN
         CALL cl_err("FOREACH:",SQLCA.sqlcode,1)
         EXIT FOREACH
      END IF

      LET l_xmek002 = cl_replace_str(l_xmek002,'xmdd','xmeh')

      CASE l_xmek002
         WHEN 'xmehseq'
            LET g_xmeg3_d_color[l_ac].xmehseq           = 'red'
         WHEN 'xmehseq1'            
            LET g_xmeg3_d_color[l_ac].xmehseq1          = 'red'
         WHEN 'xmeh003'            
            LET g_xmeg3_d_color[l_ac].xmeh003           = 'red'
         WHEN 'xmeh001'            
            LET g_xmeg3_d_color[l_ac].xmeh001           = 'red'
            LET g_xmeg3_d_color[l_ac].xmeh001_desc      = 'red'
            LET g_xmeg3_d_color[l_ac].xmeh001_desc_desc = 'red'
         WHEN 'xmeh002'            
            LET g_xmeg3_d_color[l_ac].xmeh002           = 'red'
         WHEN 'xmeh004'            
            LET g_xmeg3_d_color[l_ac].xmeh004           = 'red'
            LET g_xmeg3_d_color[l_ac].xmeh004_desc      = 'red'
         WHEN 'xmeh005'            
            LET g_xmeg3_d_color[l_ac].xmeh005           = 'red'
         WHEN 'xmehseq2'            
            LET g_xmeg3_d_color[l_ac].xmehseq2          = 'red'
         WHEN 'xmeh006'            
            LET g_xmeg3_d_color[l_ac].xmeh006           = 'red'
         WHEN 'xmeh024'            
            LET g_xmeg3_d_color[l_ac].xmeh024           = 'red'
            LET g_xmeg3_d_color[l_ac].xmeh024_desc      = 'red'
         WHEN 'xmeh025'            
            LET g_xmeg3_d_color[l_ac].xmeh025           = 'red'
         WHEN 'xmeh011'            
            LET g_xmeg3_d_color[l_ac].xmeh011           = 'red'
         WHEN 'xmeh012'            
            LET g_xmeg3_d_color[l_ac].xmeh012           = 'red'
         WHEN 'xmeh031'            
            LET g_xmeg3_d_color[l_ac].xmeh031           = 'red'
         WHEN 'xmeh014'            
            LET g_xmeg3_d_color[l_ac].xmeh014           = 'red'
         WHEN 'xmeh015'            
            LET g_xmeg3_d_color[l_ac].xmeh015           = 'red'
         WHEN 'xmeh016'            
            LET g_xmeg3_d_color[l_ac].xmeh016           = 'red'
         WHEN 'xmeh017'            
            LET g_xmeg3_d_color[l_ac].xmeh017           = 'red'
         WHEN 'xmeh026'            
            LET g_xmeg3_d_color[l_ac].xmeh026           = 'red'
            LET g_xmeg3_d_color[l_ac].xmeh026_desc      = 'red'
         WHEN 'xmeh027'            
            LET g_xmeg3_d_color[l_ac].xmeh027           = 'red'
         WHEN 'xmeh019'            
            LET g_xmeg3_d_color[l_ac].xmeh019           = 'red'
            LET g_xmeg3_d_color[l_ac].xmeh019_desc      = 'red'
         WHEN 'xmeh028'            
            LET g_xmeg3_d_color[l_ac].xmeh028           = 'red'
         WHEN 'xmeh029'            
            LET g_xmeg3_d_color[l_ac].xmeh029           = 'red'
         WHEN 'xmeh030'            
            LET g_xmeg3_d_color[l_ac].xmeh030           = 'red'
         WHEN 'xmeh229'            
            LET g_xmeg3_d_color[l_ac].xmeh229           = 'red' 
         WHEN 'xmeh200'            
            LET g_xmeg3_d_color[l_ac].xmeh200           = 'red' 
            LET g_xmeg3_d_color[l_ac].xmeh200_desc      = 'red' 
         WHEN 'xmeh201'            
            LET g_xmeg3_d_color[l_ac].xmeh201           = 'red' 
            LET g_xmeg3_d_color[l_ac].xmeh201_desc      = 'red'  
         WHEN 'xmeh202'            
            LET g_xmeg3_d_color[l_ac].xmeh202           = 'red' 
         WHEN 'xmeh203'            
            LET g_xmeg3_d_color[l_ac].xmeh203           = 'red' 
         WHEN 'xmeh204'            
            LET g_xmeg3_d_color[l_ac].xmeh204           = 'red' 
         WHEN 'xmeh205'            
            LET g_xmeg3_d_color[l_ac].xmeh205           = 'red' 
         WHEN 'xmeh206'            
            LET g_xmeg3_d_color[l_ac].xmeh206           = 'red' 
         WHEN 'xmeh207'            
            LET g_xmeg3_d_color[l_ac].xmeh207           = 'red'
            LET g_xmeg3_d_color[l_ac].xmeh207_desc      = 'red'   
         WHEN 'xmehunit'            
            LET g_xmeg3_d_color[l_ac].xmehunit          = 'red'
            LET g_xmeg3_d_color[l_ac].xmehunit_desc     = 'red'
         WHEN 'xmeh210'            
            LET g_xmeg3_d_color[l_ac].xmeh210           = 'red'
            LET g_xmeg3_d_color[l_ac].xmeh210_desc      = 'red' 
         WHEN 'xmeh212'            
            LET g_xmeg3_d_color[l_ac].xmeh212           = 'red'
         WHEN 'xmeh213'            
            LET g_xmeg3_d_color[l_ac].xmeh213           = 'red'
            LET g_xmeg3_d_color[l_ac].xmeh213_desc      = 'red' 
         WHEN 'xmeh214'            
            LET g_xmeg3_d_color[l_ac].xmeh214           = 'red'
            LET g_xmeg3_d_color[l_ac].xmeh214_desc      = 'red'  
         WHEN 'xmeh215'            
            LET g_xmeg3_d_color[l_ac].xmeh215           = 'red'
         WHEN 'xmeh221'            
            LET g_xmeg3_d_color[l_ac].xmeh221           = 'red'
         WHEN 'xmehsite'            
            LET g_xmeg3_d_color[l_ac].xmehsite          = 'red'
            LET g_xmeg3_d_color[l_ac].xmehsite_desc     = 'red'  
         WHEN 'xmeh218'            
            LET g_xmeg3_d_color[l_ac].xmeh218           = 'red'
            LET g_xmeg3_d_color[l_ac].xmeh218_desc      = 'red'  
         WHEN 'xmeh219'            
            LET g_xmeg3_d_color[l_ac].xmeh219           = 'red'
            LET g_xmeg3_d_color[l_ac].xmeh219_desc      = 'red'  
         WHEN 'xmeh220'            
            LET g_xmeg3_d_color[l_ac].xmeh220           = 'red'
            LET g_xmeg3_d_color[l_ac].xmeh220_desc      = 'red'  
         WHEN 'xmeh222'            
            LET g_xmeg3_d_color[l_ac].xmeh222           = 'red'
            LET g_xmeg3_d_color[l_ac].xmeh222_desc      = 'red'
         WHEN 'xmeh223'            
            LET g_xmeg3_d_color[l_ac].xmeh223           = 'red'
            LET g_xmeg3_d_color[l_ac].xmeh223_desc      = 'red'
         WHEN 'xmeh224'            
            LET g_xmeg3_d_color[l_ac].xmeh224           = 'red'
            LET g_xmeg3_d_color[l_ac].xmeh224_desc      = 'red'
         WHEN 'xmehorga'            
            LET g_xmeg3_d_color[l_ac].xmehorga          = 'red'
            LET g_xmeg3_d_color[l_ac].xmehorga_desc     = 'red'
         WHEN 'xmeh226'            
            LET g_xmeg3_d_color[l_ac].xmeh226           = 'red'
         WHEN 'xmeh227'            
            LET g_xmeg3_d_color[l_ac].xmeh227           = 'red'
            LET g_xmeg3_d_color[l_ac].xmeh227_desc      = 'red'
         WHEN 'xmeh228'            
            LET g_xmeg3_d_color[l_ac].xmeh228           = 'red'
            LET g_xmeg3_d_color[l_ac].xmeh228_desc      = 'red'       
      END CASE
   END FOREACH
END FUNCTION]]>
</point>
  <point name="function.adbt510_detail4_color" cite_std="N" status="u" ver="2" src="s" new="Y" order="104" mark_hard="N">
<![CDATA[
PRIVATE FUNCTION adbt510_detail4_color()
DEFINE l_xmek002         LIKE xmek_t.xmek002

   CALL adbt510_detail4_init_color()

   DECLARE sel_xmek_cs4 CURSOR FOR
    SELECT xmek002 FROM xmek_t
     WHERE xmekent   = g_enterprise
       AND xmekdocno = g_xmee_m.xmeedocno
       AND xmek001   = g_xmee_m.xmee900
       AND xmekseq   = g_xmeg4_d[l_ac].xmjbseq
       AND xmekseq1  = 0
       AND xmekseq2  = 0
       AND xmek002 LIKE 'xmja%'
   FOREACH sel_xmek_cs4 INTO l_xmek002
      IF SQLCA.sqlcode THEN
         CALL cl_err("FOREACH:",SQLCA.sqlcode,1)
         EXIT FOREACH
      END IF

      LET l_xmek002 = cl_replace_str(l_xmek002,'xmja','xmjb')

      CASE l_xmek002
          WHEN 'xmjb001'                         
             LET g_xmeg4_d_color[l_ac].xmjb001           = 'red'  
          WHEN 'xmjb024'                         
             LET g_xmeg4_d_color[l_ac].xmjb024           = 'red'      
             LET g_xmeg4_d_color[l_ac].xmjb024_desc      = 'red' 
          WHEN 'xmjb026'                         
             LET g_xmeg4_d_color[l_ac].xmjb026           = 'red'      
             LET g_xmeg4_d_color[l_ac].xmjb026_desc      = 'red' 
          WHEN 'xmjb030'                         
             LET g_xmeg4_d_color[l_ac].xmjb030           = 'red' 
          WHEN 'xmjb031'                         
             LET g_xmeg4_d_color[l_ac].xmjb031           = 'red' 
          WHEN 'xmjb032'                         
             LET g_xmeg4_d_color[l_ac].xmjb032           = 'red' 
          WHEN 'xmjb034'                         
             LET g_xmeg4_d_color[l_ac].xmjb034           = 'red'  
          WHEN 'xmjbunit'                         
             LET g_xmeg4_d_color[l_ac].xmjbunit          = 'red'               
      END CASE
   END FOREACH  
END FUNCTION]]>
</point>
  <point name="function.adbt510_detail5_color" cite_std="N" status="u" ver="2" src="s" new="Y" order="105" mark_hard="N">
<![CDATA[
PRIVATE FUNCTION adbt510_detail5_color()
DEFINE l_xmek002         LIKE xmek_t.xmek002

   CALL adbt510_detail5_init_color()

   DECLARE sel_xmek_cs5 CURSOR FOR
    SELECT xmek002 FROM xmek_t
     WHERE xmekent   = g_enterprise
       AND xmekdocno = g_xmee_m.xmeedocno
       AND xmek001   = g_xmee_m.xmee900
       AND xmekseq   = 0
       AND xmekseq1  = 0
       AND xmekseq2  = g_xmeg5_d[l_ac].xmef001
   FOREACH sel_xmek_cs5 INTO l_xmek002
      IF SQLCA.sqlcode THEN
         CALL cl_err("FOREACH:",SQLCA.sqlcode,1)
         EXIT FOREACH
      END IF

      LET l_xmek002 = cl_replace_str(l_xmek002,'xmdb','xmef')

      CASE l_xmek002
          WHEN 'xmef001'                         
             LET g_xmeg5_d_color[l_ac].xmef001           = 'red'  
          WHEN 'xmef002'                             
             LET g_xmeg5_d_color[l_ac].xmef002           = 'red'                  
             LET g_xmeg5_d_color[l_ac].xmef002_desc      = 'red'                  
          WHEN 'xmef003'                       
             LET g_xmeg5_d_color[l_ac].xmef003           = 'red'                  
          WHEN 'xmef004'             
             LET g_xmeg5_d_color[l_ac].xmef004           = 'red'                  
          WHEN 'xmef005'             
             LET g_xmeg5_d_color[l_ac].xmef005           = 'red'                  
          WHEN 'xmef006'             
             LET g_xmeg5_d_color[l_ac].xmef006           = 'red'                  
          WHEN 'xmef007'             
             LET g_xmeg5_d_color[l_ac].xmef007           = 'red'                  
          WHEN 'xmef008'             
             LET g_xmeg5_d_color[l_ac].xmef008           = 'red'                  
          WHEN 'xmef009'             
             LET g_xmeg5_d_color[l_ac].xmef009           = 'red'                  
      END CASE
   END FOREACH   
END FUNCTION]]>
</point>
  <point name="function.adbt510_upd_xmee901" cite_std="N" status="u" ver="2" src="s" new="Y" order="106" mark_hard="N">
<![CDATA[#新增訂單變更歷程檔並修改單頭變更否欄位
PRIVATE FUNCTION adbt510_upd_xmee901()
DEFINE l_xmda_m     RECORD LIKE xmda_t.*  #訂單單頭檔
DEFINE l_flag       LIKE type_t.num5      #記錄是否有欄位變更
DEFINE r_success    LIKE type_t.num5
DEFINE l_ooef019    LIKE ooef_t.ooef019
DEFINE l_pmaa027    LIKE pmaa_t.pmaa027   #聯絡對象識別碼
DEFINE l_oocq019    LIKE oocq_t.oocq019

   LET r_success = TRUE
   LET l_flag = FALSE

   #抓取訂單單頭的值
   INITIALIZE l_xmda_m.* TO NULL
   SELECT xmdasite,xmdadocno,xmda001,xmdadocdt,xmda004,
          xmda002,xmda003,xmda005,xmda006,
          xmda007,xmda008,xmda033,xmda027,xmda009,
          xmda010,xmda011,xmda012,xmda013,xmda035,
          xmda015,xmda016,xmda017,xmda018,xmda019,
          xmda023,xmda032,xmda071,xmda021,xmda022,
          xmda034,xmda024,xmda044,xmda030,xmda031,
          xmda045,xmda046,xmda047,xmda028,xmda041,
          xmda042,xmda043,xmda025,xmda026,xmda020,
          xmda036,xmda039,xmda200,
          xmda201,xmda203,xmdaunit,xmda206,xmda207
     INTO l_xmda_m.xmdasite,l_xmda_m.xmdadocno,l_xmda_m.xmda001,l_xmda_m.xmdadocdt,l_xmda_m.xmda004,
          l_xmda_m.xmda002,l_xmda_m.xmda003,l_xmda_m.xmda005,l_xmda_m.xmda006,
          l_xmda_m.xmda007,l_xmda_m.xmda008,l_xmda_m.xmda033,l_xmda_m.xmda027,l_xmda_m.xmda009,
          l_xmda_m.xmda010,l_xmda_m.xmda011,l_xmda_m.xmda012,l_xmda_m.xmda013,l_xmda_m.xmda035,
          l_xmda_m.xmda015,l_xmda_m.xmda016,l_xmda_m.xmda017,l_xmda_m.xmda018,l_xmda_m.xmda019,
          l_xmda_m.xmda023,l_xmda_m.xmda032,l_xmda_m.xmda071,l_xmda_m.xmda021,l_xmda_m.xmda022,
          l_xmda_m.xmda034,l_xmda_m.xmda024,l_xmda_m.xmda044,l_xmda_m.xmda030,l_xmda_m.xmda031,
          l_xmda_m.xmda045,l_xmda_m.xmda046,l_xmda_m.xmda047,l_xmda_m.xmda028,l_xmda_m.xmda041,
          l_xmda_m.xmda042,l_xmda_m.xmda043,l_xmda_m.xmda025,l_xmda_m.xmda026,l_xmda_m.xmda020,
          l_xmda_m.xmda036,l_xmda_m.xmda039,l_xmda_m.xmda200,
          l_xmda_m.xmda201,l_xmda_m.xmda203,l_xmda_m.xmdaunit,l_xmda_m.xmda206,l_xmda_m.xmda207   
     FROM xmda_t
    WHERE xmdaent = g_enterprise
      AND xmdadocno = g_xmee_m.xmeedocno


   #業務人員
   IF (NOT cl_null(g_xmee_m.xmee002) AND (g_xmee_m.xmee002 != l_xmda_m.xmda002 OR cl_null(l_xmda_m.xmda002))) OR
      (cl_null(g_xmee_m.xmee002) AND NOT cl_null(l_xmda_m.xmda002)) THEN
      #其說明的SQL
      LET g_xmek007 = "SELECT oofa011 FROM oofa_t WHERE oofaent ='"||g_enterprise||"' AND oofa002 = '2' AND oofa003 ='"||l_xmda_m.xmda002||"' "
      #新增資料到變更歷程檔
      IF NOT s_adbt510_ins_xmek(0,0,0,"xmda002",'1',l_xmda_m.xmda002,g_xmee_m.xmee002,g_xmee_m.xmeedocno,g_xmee_m.xmee900) THEN
         LET r_success = FALSE
         RETURN r_success
      ELSE
         LET l_flag = TRUE     #有欄位變更，則更新為'Y'
      END IF
   ELSE
      #資料一樣，表示無變更，將變更歷程檔刪除
      IF NOT s_adbt510_del_xmek(0,0,0,"xmda002",g_xmee_m.xmeedocno,g_xmee_m.xmee900) THEN
         LET r_success = FALSE
         RETURN r_success
      END IF
   END IF   

   #業務部門
   IF (NOT cl_null(g_xmee_m.xmee003) AND (g_xmee_m.xmee003 != l_xmda_m.xmda003 OR cl_null(l_xmda_m.xmda003))) OR
      (cl_null(g_xmee_m.xmee003) AND NOT cl_null(l_xmda_m.xmda003)) THEN
      #其說明的SQL
      LET g_xmek007 = "SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_lang||"'"
      #新增資料到變更歷程檔
      IF NOT s_adbt510_ins_xmek(0,0,0,"xmda003",'1',l_xmda_m.xmda003,g_xmee_m.xmee003,g_xmee_m.xmeedocno,g_xmee_m.xmee900) THEN
         LET r_success = FALSE
         RETURN r_success
      ELSE
         LET l_flag = TRUE     #有欄位變更，則更新為'Y'
      END IF
   ELSE
      #資料一樣，表示無變更，將變更歷程檔刪除
      IF NOT s_adbt510_del_xmek(0,0,0,"xmda003",g_xmee_m.xmeedocno,g_xmee_m.xmee900) THEN
         LET r_success = FALSE
         RETURN r_success
      END IF
   END IF
   
   #客戶連絡人
   IF (NOT cl_null(g_xmee_m.xmee027) AND (g_xmee_m.xmee027 != l_xmda_m.xmda027 OR cl_null(l_xmda_m.xmda027))) OR
      (cl_null(g_xmee_m.xmee027) AND NOT cl_null(l_xmda_m.xmda027)) THEN
      #其說明的SQL
      LET g_xmek007 = "SELECT oofa011 FROM oofa_t WHERE oofaent ='"||g_enterprise||"' AND oofa002 = '2' AND oofa003 ='"||l_xmda_m.xmda027||"' "
      #新增資料到變更歷程檔
      IF NOT s_adbt510_ins_xmek(0,0,0,"xmda027",'1',l_xmda_m.xmda027,g_xmee_m.xmee027,g_xmee_m.xmeedocno,g_xmee_m.xmee900) THEN
         LET r_success = FALSE
         RETURN r_success
      ELSE
         LET l_flag = TRUE     #有欄位變更，則更新為'Y'
      END IF
   ELSE
      #資料一樣，表示無變更，將變更歷程檔刪除
      IF NOT s_adbt510_del_xmek(0,0,0,"xmda027",g_xmee_m.xmeedocno,g_xmee_m.xmee900) THEN
         LET r_success = FALSE
         RETURN r_success
      END IF
   END IF   

   #收款條件
   IF (NOT cl_null(g_xmee_m.xmee009) AND (g_xmee_m.xmee009 != l_xmda_m.xmda009 OR cl_null(l_xmda_m.xmda009))) OR
      (cl_null(g_xmee_m.xmee009) AND NOT cl_null(l_xmda_m.xmda009)) THEN
      #其說明的SQL
      LET g_xmek007 = "SELECT ooibl004 FROM ooibl_t WHERE ooiblent='"||g_enterprise||"' AND ooibl002=? AND ooibl003='"||g_dlang||"' "
      
      #新增資料到變更歷程檔
      IF NOT s_adbt510_ins_xmek(0,0,0,"xmda009",'1',l_xmda_m.xmda009,g_xmee_m.xmee009,g_xmee_m.xmeedocno,g_xmee_m.xmee900) THEN
         LET r_success = FALSE
         RETURN r_success
      ELSE
         LET l_flag = TRUE     #有欄位變更，則更新為'Y'
      END IF
   ELSE
      #資料一樣，表示無變更，將變更歷程檔刪除
      IF NOT s_adbt510_del_xmek(0,0,0,"xmda009",g_xmee_m.xmeedocno,g_xmee_m.xmee900) THEN
         LET r_success = FALSE
         RETURN r_success
      END IF
   END IF 

   #交易條件
   IF (NOT cl_null(g_xmee_m.xmee010) AND (g_xmee_m.xmee010 != l_xmda_m.xmda010 OR cl_null(l_xmda_m.xmda010))) OR
      (cl_null(g_xmee_m.xmee010) AND NOT cl_null(l_xmda_m.xmda010)) THEN
      #其說明的SQL
      LET g_xmek007 = "SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='238' AND oocql002=? AND oocql003='"||g_dlang||"' "
      
      #新增資料到變更歷程檔
      IF NOT s_adbt510_ins_xmek(0,0,0,"xmda010",'1',l_xmda_m.xmda010,g_xmee_m.xmee010,g_xmee_m.xmeedocno,g_xmee_m.xmee900) THEN
         LET r_success = FALSE
         RETURN r_success
      ELSE
         LET l_flag = TRUE     #有欄位變更，則更新為'Y'
      END IF
   ELSE
      #資料一樣，表示無變更，將變更歷程檔刪除
      IF NOT s_adbt510_del_xmek(0,0,0,"xmda010",g_xmee_m.xmeedocno,g_xmee_m.xmee900) THEN
         LET r_success = FALSE
         RETURN r_success
      END IF
   END IF 

   #發票類型
   IF (NOT cl_null(g_xmee_m.xmee035) AND (g_xmee_m.xmee035 != l_xmda_m.xmda035 OR cl_null(l_xmda_m.xmda035))) OR
      (cl_null(g_xmee_m.xmee035) AND NOT cl_null(l_xmda_m.xmda035)) THEN
      #其說明的SQL
      LET g_xmek007 = "SELECT isacl004 FROM isacl_t WHERE isaclent='"||g_enterprise||"' AND isacl002=? AND isacl003='"||g_dlang||"' "
      
      #新增資料到變更歷程檔
      IF NOT s_adbt510_ins_xmek(0,0,0,"xmda035",'1',l_xmda_m.xmda035,g_xmee_m.xmee035,g_xmee_m.xmeedocno,g_xmee_m.xmee900) THEN
         LET r_success = FALSE
         RETURN r_success
      ELSE
         LET l_flag = TRUE     #有欄位變更，則更新為'Y'
      END IF
   ELSE
      #資料一樣，表示無變更，將變更歷程檔刪除
      IF NOT s_adbt510_del_xmek(0,0,0,"xmda035",g_xmee_m.xmeedocno,g_xmee_m.xmee900) THEN
         LET r_success = FALSE
         RETURN r_success
      END IF
   END IF  
   
   #備註
   IF (NOT cl_null(g_xmee_m.xmee071) AND (g_xmee_m.xmee071 != l_xmda_m.xmda071 OR cl_null(l_xmda_m.xmda071))) OR
      (cl_null(g_xmee_m.xmee071) AND NOT cl_null(l_xmda_m.xmda071)) THEN
      #其說明的SQL
      LET g_xmek007 = NULL
      #新增資料到變更歷程檔
      IF NOT s_adbt510_ins_xmek(0,0,0,"xmda071",'1',l_xmda_m.xmda071,g_xmee_m.xmee071,g_xmee_m.xmeedocno,g_xmee_m.xmee900) THEN
         LET r_success = FALSE
         RETURN r_success
      ELSE
         LET l_flag = TRUE     #有欄位變更，則更新為'Y'
      END IF
   ELSE
      #資料一樣，表示無變更，將變更歷程檔刪除
      IF NOT s_adbt510_del_xmek(0,0,0,"xmda071",g_xmee_m.xmeedocno,g_xmee_m.xmee900) THEN
         LET r_success = FALSE
         RETURN r_success
      END IF
   END IF 

   #帳款客戶
   IF (NOT cl_null(g_xmee_m.xmee021) AND (g_xmee_m.xmee021 != l_xmda_m.xmda021 OR cl_null(l_xmda_m.xmda021))) OR
      (cl_null(g_xmee_m.xmee021) AND NOT cl_null(l_xmda_m.xmda021)) THEN
      #其說明的SQL
      LET g_xmek007 = "SELECT pmaal004 FROM pmaal_t WHERE pmaalent='"||g_enterprise||"' AND pmaal001=? AND pmaal002='"||g_dlang||"' "
      
      #新增資料到變更歷程檔
      IF NOT s_adbt510_ins_xmek(0,0,0,"xmda021",'1',l_xmda_m.xmda021,g_xmee_m.xmee021,g_xmee_m.xmeedocno,g_xmee_m.xmee900) THEN
         LET r_success = FALSE
         RETURN r_success
      ELSE
         LET l_flag = TRUE     #有欄位變更，則更新為'Y'
      END IF
   ELSE
      #資料一樣，表示無變更，將變更歷程檔刪除
      IF NOT s_adbt510_del_xmek(0,0,0,"xmda021",g_xmee_m.xmeedocno,g_xmee_m.xmee900) THEN
         LET r_success = FALSE
         RETURN r_success
      END IF
   END IF

   #收貨客戶
   IF (NOT cl_null(g_xmee_m.xmee022) AND (g_xmee_m.xmee022 != l_xmda_m.xmda022 OR cl_null(l_xmda_m.xmda022))) OR
      (cl_null(g_xmee_m.xmee022) AND NOT cl_null(l_xmda_m.xmda022)) THEN
      #其說明的SQL
      LET g_xmek007 = "SELECT pmaal004 FROM pmaal_t WHERE pmaalent='"||g_enterprise||"' AND pmaal001=? AND pmaal002='"||g_dlang||"' "
      
      #新增資料到變更歷程檔
      IF NOT s_adbt510_ins_xmek(0,0,0,"xmda022",'1',l_xmda_m.xmda022,g_xmee_m.xmee022,g_xmee_m.xmeedocno,g_xmee_m.xmee900) THEN
         LET r_success = FALSE
         RETURN r_success
      ELSE
         LET l_flag = TRUE     #有欄位變更，則更新為'Y'
      END IF
   ELSE
      #資料一樣，表示無變更，將變更歷程檔刪除
      IF NOT s_adbt510_del_xmek(0,0,0,"xmda022",g_xmee_m.xmeedocno,g_xmee_m.xmee900) THEN
         LET r_success = FALSE
         RETURN r_success
      END IF
   END IF 
   
   #發票客戶
   IF (NOT cl_null(g_xmee_m.xmee203) AND (g_xmee_m.xmee203 != l_xmda_m.xmda203 OR cl_null(l_xmda_m.xmda203))) OR
      (cl_null(g_xmee_m.xmee203) AND NOT cl_null(l_xmda_m.xmda203)) THEN
      #其說明的SQL
      LET g_xmek007 = "SELECT pmaal004 FROM pmaal_t WHERE pmaalent='"||g_enterprise||"' AND pmaal001=? AND pmaal002='"||g_dlang||"' "
      
      #新增資料到變更歷程檔
      IF NOT s_adbt510_ins_xmek(0,0,0,"xmda203",'1',l_xmda_m.xmda203,g_xmee_m.xmee203,g_xmee_m.xmeedocno,g_xmee_m.xmee900) THEN
         LET r_success = FALSE
         RETURN r_success
      ELSE
         LET l_flag = TRUE     #有欄位變更，則更新為'Y'
      END IF
   ELSE
      #資料一樣，表示無變更，將變更歷程檔刪除
      IF NOT s_adbt510_del_xmek(0,0,0,"xmda203",g_xmee_m.xmeedocno,g_xmee_m.xmee900) THEN
         LET r_success = FALSE
         RETURN r_success
      END IF
   END IF 
   
   #調貨經銷商
   IF (NOT cl_null(g_xmee_m.xmee200) AND (g_xmee_m.xmee200 != l_xmda_m.xmda200 OR cl_null(l_xmda_m.xmda200))) OR
      (cl_null(g_xmee_m.xmee200) AND NOT cl_null(l_xmda_m.xmda200)) THEN
      #其說明的SQL
      LET g_xmek007 = "SELECT pmaal004 FROM pmaal_t WHERE pmaalent='"||g_enterprise||"' AND pmaal001=? AND pmaal002='"||g_dlang||"' "
      
      #新增資料到變更歷程檔
      IF NOT s_adbt510_ins_xmek(0,0,0,"xmda200",'1',l_xmda_m.xmda200,g_xmee_m.xmee200,g_xmee_m.xmeedocno,g_xmee_m.xmee900) THEN
         LET r_success = FALSE
         RETURN r_success
      ELSE
         LET l_flag = TRUE     #有欄位變更，則更新為'Y'
      END IF
   ELSE
      #資料一樣，表示無變更，將變更歷程檔刪除
      IF NOT s_adbt510_del_xmek(0,0,0,"xmda200",g_xmee_m.xmeedocno,g_xmee_m.xmee900) THEN
         LET r_success = FALSE
         RETURN r_success
      END IF
   END IF 
   
   #代送商
   IF (NOT cl_null(g_xmee_m.xmee201) AND (g_xmee_m.xmee201 != l_xmda_m.xmda201 OR cl_null(l_xmda_m.xmda201))) OR
      (cl_null(g_xmee_m.xmee201) AND NOT cl_null(l_xmda_m.xmda201)) THEN
      #其說明的SQL
      LET g_xmek007 = "SELECT pmaal004 FROM pmaal_t WHERE pmaalent='"||g_enterprise||"' AND pmaal001=? AND pmaal002='"||g_dlang||"' "
      
      #新增資料到變更歷程檔
      IF NOT s_adbt510_ins_xmek(0,0,0,"xmda201",'1',l_xmda_m.xmda201,g_xmee_m.xmee201,g_xmee_m.xmeedocno,g_xmee_m.xmee900) THEN
         LET r_success = FALSE
         RETURN r_success
      ELSE
         LET l_flag = TRUE     #有欄位變更，則更新為'Y'
      END IF
   ELSE
      #資料一樣，表示無變更，將變更歷程檔刪除
      IF NOT s_adbt510_del_xmek(0,0,0,"xmda201",g_xmee_m.xmeedocno,g_xmee_m.xmee900) THEN
         LET r_success = FALSE
         RETURN r_success
      END IF
   END IF 
   
   #發貨組織
   IF (NOT cl_null(g_xmee_m.xmeeunit) AND (g_xmee_m.xmeeunit != l_xmda_m.xmdaunit OR cl_null(l_xmda_m.xmdaunit))) OR
      (cl_null(g_xmee_m.xmeeunit) AND NOT cl_null(l_xmda_m.xmdaunit)) THEN
      #其說明的SQL
      LET g_xmek007 = "SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"' "

      #新增資料到變更歷程檔
      IF NOT s_adbt510_ins_xmek(0,0,0,"xmdaunit",'1',l_xmda_m.xmdaunit,g_xmee_m.xmeeunit,g_xmee_m.xmeedocno,g_xmee_m.xmee900) THEN
         LET r_success = FALSE
         RETURN r_success
      ELSE
         LET l_flag = TRUE     #有欄位變更，則更新為'Y'
      END IF
   ELSE
      #資料一樣，表示無變更，將變更歷程檔刪除
      IF NOT s_adbt510_del_xmek(0,0,0,"xmdaunit",g_xmee_m.xmeedocno,g_xmee_m.xmee900) THEN
         LET r_success = FALSE
         RETURN r_success
      END IF
   END IF 
   
   #銷售分類
   IF (NOT cl_null(g_xmee_m.xmee024) AND (g_xmee_m.xmee024 != l_xmda_m.xmda024 OR cl_null(l_xmda_m.xmda024))) OR
      (cl_null(g_xmee_m.xmee024) AND NOT cl_null(l_xmda_m.xmda024)) THEN
      #其說明的SQL
      LET g_xmek007 = "SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='295' AND oocql002=? AND oocql003='"||g_dlang||"' "
      
      #新增資料到變更歷程檔
      IF NOT s_adbt510_ins_xmek(0,0,0,"xmda024",'1',l_xmda_m.xmda024,g_xmee_m.xmee024,g_xmee_m.xmeedocno,g_xmee_m.xmee900) THEN
         LET r_success = FALSE
         RETURN r_success
      ELSE
         LET l_flag = TRUE     #有欄位變更，則更新為'Y'
      END IF
   ELSE
      #資料一樣，表示無變更，將變更歷程檔刪除
      IF NOT s_adbt510_del_xmek(0,0,0,"xmda024",g_xmee_m.xmeedocno,g_xmee_m.xmee900) THEN
         LET r_success = FALSE
         RETURN r_success
      END IF
   END IF 

   #出貨地址
   IF (NOT cl_null(g_xmee_m.xmee025) AND (g_xmee_m.xmee025 != l_xmda_m.xmda025 OR cl_null(l_xmda_m.xmda025))) OR
      (cl_null(g_xmee_m.xmee025) AND NOT cl_null(l_xmda_m.xmda025)) THEN
      #其說明的SQL
      CALL adbt510_get_pmaa027(g_xmee_m.xmee021) RETURNING l_pmaa027    
      LET g_xmek007 = "SELECT oofb011 FROM oofb_t WHERE oofbent='"||g_enterprise||"' AND oofb002='"||l_pmaa027||"' AND oofb008 = '2' AND oofb019='"||l_xmda_m.xmda025||"' "
      
      #新增資料到變更歷程檔
      IF NOT s_adbt510_ins_xmek(0,0,0,"xmda025",'1',l_xmda_m.xmda025,g_xmee_m.xmee025,g_xmee_m.xmeedocno,g_xmee_m.xmee900) THEN
         LET r_success = FALSE
         RETURN r_success
      ELSE
         LET l_flag = TRUE     #有欄位變更，則更新為'Y'
      END IF
   ELSE
      #資料一樣，表示無變更，將變更歷程檔刪除
      IF NOT s_adbt510_del_xmek(0,0,0,"xmda025",g_xmee_m.xmeedocno,g_xmee_m.xmee900) THEN
         LET r_success = FALSE
         RETURN r_success
      END IF
   END IF
   #組合地址oofb017    
   
   #帳款地址
   IF (NOT cl_null(g_xmee_m.xmee026) AND (g_xmee_m.xmee026 != l_xmda_m.xmda026 OR cl_null(l_xmda_m.xmda026))) OR
      (cl_null(g_xmee_m.xmee026) AND NOT cl_null(l_xmda_m.xmda026)) THEN
      #其說明的SQL
      CALL adbt510_get_pmaa027(g_xmee_m.xmee021) RETURNING l_pmaa027    
      LET g_xmek007 = "SELECT oofb011 FROM oofb_t WHERE oofbent='"||g_enterprise||"' AND oofb002='"||l_pmaa027||"' AND oofb008 = '2' AND oofb019='"||l_xmda_m.xmda026||"' "
      
      #新增資料到變更歷程檔
      IF NOT s_adbt510_ins_xmek(0,0,0,"xmda026",'1',l_xmda_m.xmda026,g_xmee_m.xmee026,g_xmee_m.xmeedocno,g_xmee_m.xmee900) THEN
         LET r_success = FALSE
         RETURN r_success
      ELSE
         LET l_flag = TRUE     #有欄位變更，則更新為'Y'
      END IF
   ELSE
      #資料一樣，表示無變更，將變更歷程檔刪除
      IF NOT s_adbt510_del_xmek(0,0,0,"xmda026",g_xmee_m.xmeedocno,g_xmee_m.xmee900) THEN
         LET r_success = FALSE
         RETURN r_success
      END IF
   END IF  
   #組合地址oofb017_1   
 
   #送貨站點
   IF (NOT cl_null(g_xmee_m.xmee206) AND (g_xmee_m.xmee206 != l_xmda_m.xmda206 OR cl_null(l_xmda_m.xmda206))) OR
      (cl_null(g_xmee_m.xmee206) AND NOT cl_null(l_xmda_m.xmda206)) THEN
      #其說明的SQL
      LET g_xmek007 = "SELECT dbadl003 FROM dbadl_t WHERE dbadlent='"||g_enterprise||"' AND dbadl001=? AND dbadl002='"||g_dlang||"'"

      #新增資料到變更歷程檔
      IF NOT s_adbt510_ins_xmek(0,0,0,"xmda206",'1',l_xmda_m.xmda206,g_xmee_m.xmee206,g_xmee_m.xmeedocno,g_xmee_m.xmee900) THEN
         LET r_success = FALSE
         RETURN r_success
      ELSE
         LET l_flag = TRUE     #有欄位變更，則更新為'Y'
      END IF
   ELSE
      #資料一樣，表示無變更，將變更歷程檔刪除
      IF NOT s_adbt510_del_xmek(0,0,0,"xmda206",g_xmee_m.xmeedocno,g_xmee_m.xmee900) THEN
         LET r_success = FALSE
         RETURN r_success
      END IF
   END IF  
  
   #運輸路線
   IF (NOT cl_null(g_xmee_m.xmee207) AND (g_xmee_m.xmee207 != l_xmda_m.xmda207 OR cl_null(l_xmda_m.xmda207))) OR
      (cl_null(g_xmee_m.xmee207) AND NOT cl_null(l_xmda_m.xmda207)) THEN
      #其說明的SQL
      LET g_xmek007 = "SELECT dbabl003 FROM dbabl_t WHERE dbablent='"||g_enterprise||"' AND dbabl001=? AND dbabl002='"||g_dlang||"'"

      #新增資料到變更歷程檔
      IF NOT s_adbt510_ins_xmek(0,0,0,"xmda207",'1',l_xmda_m.xmda207,g_xmee_m.xmee207,g_xmee_m.xmeedocno,g_xmee_m.xmee900) THEN
         LET r_success = FALSE
         RETURN r_success
      ELSE
         LET l_flag = TRUE     #有欄位變更，則更新為'Y'
      END IF
   ELSE
      #資料一樣，表示無變更，將變更歷程檔刪除
      IF NOT s_adbt510_del_xmek(0,0,0,"xmda207",g_xmee_m.xmeedocno,g_xmee_m.xmee900) THEN
         LET r_success = FALSE
         RETURN r_success
      END IF
   END IF  
 
   #預收款發票開立方式
   IF (NOT cl_null(g_xmee_m.xmee039) AND (g_xmee_m.xmee039 != l_xmda_m.xmda039 OR cl_null(l_xmda_m.xmda039))) OR
      (cl_null(g_xmee_m.xmee039) AND NOT cl_null(l_xmda_m.xmda039)) THEN
      #其說明的SQL
      LET g_xmek007 = NULL
      #新增資料到變更歷程檔
      IF NOT s_adbt510_ins_xmek(0,0,0,"xmda039",'1',l_xmda_m.xmda039,g_xmee_m.xmee039,g_xmee_m.xmeedocno,g_xmee_m.xmee900) THEN
         LET r_success = FALSE
         RETURN r_success
      ELSE
         LET l_flag = TRUE     #有欄位變更，則更新為'Y'
      END IF
   ELSE
      #資料一樣，表示無變更，將變更歷程檔刪除
      IF NOT s_adbt510_del_xmek(0,0,0,"xmda039",g_xmee_m.xmeedocno,g_xmee_m.xmee900) THEN
         LET r_success = FALSE
         RETURN r_success
      END IF
   END IF 


   IF l_flag THEN
      UPDATE xmee_t SET xmee901 = 'Y'
       WHERE xmeeent = g_enterprise
         AND xmeedocno = g_xmee_m.xmeedocno
         AND xmee900 = g_xmee_m.xmee900
      IF SQLCA.sqlcode THEN
         CALL cl_err("upd xmee901",SQLCA.sqlcode,1)
         LET r_success = FALSE
         RETURN r_success
      END IF
   END IF

   RETURN r_success
   
END FUNCTION]]>
</point>
  <point name="function.adbt510_xmjb_ins_xmek" cite_std="N" status="u" ver="2" src="s" new="Y" order="107" mark_hard="N">
<![CDATA[
PRIVATE FUNCTION adbt510_xmjb_ins_xmek(p_xmjb_d)
DEFINE p_xmjb_d          type_g_xmeg4_d
DEFINE r_success         LIKE type_t.num5
DEFINE l_xmja            RECORD LIKE xmja_t.*
DEFINE l_flag            LIKE type_t.num5      #單身是否有修改
DEFINE l_xmjbseq         LIKE xmjb_t.xmjbseq

   LET r_success = TRUE

   IF p_xmjb_d.xmjb901 = '1' THEN       #未變更不需寫入歷程檔內  
      RETURN r_success
   END IF

   INITIALIZE l_xmja.* TO NULL
   LET l_flag = FALSE

   IF p_xmjb_d.xmjb901 = '2' THEN     
      SELECT xmja001,xmja024,xmja026,xmja027,
             xmja030,xmja031,xmja032,xmja034,
             xmja015,xmja016
        INTO l_xmja.xmja001,l_xmja.xmja024,l_xmja.xmja026,l_xmja.xmja027,
             l_xmja.xmja030,l_xmja.xmja031,l_xmja.xmja032,l_xmja.xmja034,
             l_xmja.xmja015,l_xmja.xmja016
        FROM xmja_t 
       WHERE xmjaent = g_enterprise
         AND xmjadocno = g_xmee_m.xmeedocno
         AND xmjaseq = p_xmjb_d.xmjbseq
      IF SQLCA.sqlcode THEN
         CALL cl_err('sel xmja_t',SQLCA.sqlcode,1)
         LET r_success = FALSE
         RETURN r_success
      END IF 
   END IF
   LET l_xmjbseq = p_xmjb_d.xmjbseq   

   #交易類型
   IF p_xmjb_d.xmjb901 = '3' OR (p_xmjb_d.xmjb901 = '2' AND
      ((p_xmjb_d.xmjb001 <> l_xmja.xmja001) OR
      (p_xmjb_d.xmjb001 IS NULL AND l_xmja.xmja001 IS NOT NULL) OR
      (p_xmjb_d.xmjb001 IS NOT NULL AND l_xmja.xmja001 IS NULL))) THEN
      #其說明的SQL
      LET g_xmek007 = ''
      #新增資料到變更歷程檔
      IF NOT s_adbt510_ins_xmek(l_xmjbseq,0,0,"xmja001",p_xmjb_d.xmjb901,l_xmja.xmja001,p_xmjb_d.xmjb001,g_xmee_m.xmeedocno,g_xmee_m.xmee900) THEN
         LET r_success = FALSE
         RETURN r_success
      END IF
      LET l_flag = TRUE
   ELSE
      #資料一樣，表示無變更，將變更歷程檔刪除
      IF NOT s_adbt510_del_xmek(l_xmjbseq,0,0,"xmja001",g_xmee_m.xmeedocno,g_xmee_m.xmee900) THEN
         LET r_success = FALSE
         RETURN r_success
      END IF
   END IF
   
   #收貨網點
   IF p_xmjb_d.xmjb901 = '3' OR (p_xmjb_d.xmjb901 = '2' AND
      ((p_xmjb_d.xmjb024 <> l_xmja.xmja024) OR
      (p_xmjb_d.xmjb024 IS NULL AND l_xmja.xmja024 IS NOT NULL) OR
      (p_xmjb_d.xmjb024 IS NOT NULL AND l_xmja.xmja024 IS NULL))) THEN
      #其說明的SQL
      LET g_xmek007 = "SELECT pmaal004 FROM pmaal_t WHERE pmaalent='"||g_enterprise||"' AND pmaal001=? AND pmaal002='"||g_dlang||"'"
      #新增資料到變更歷程檔
      IF NOT s_adbt510_ins_xmek(l_xmjbseq,0,0,"xmja024",p_xmjb_d.xmjb901,l_xmja.xmja024,p_xmjb_d.xmjb024,g_xmee_m.xmeedocno,g_xmee_m.xmee900) THEN
         LET r_success = FALSE
         RETURN r_success
      END IF
      LET l_flag = TRUE
   ELSE
      #資料一樣，表示無變更，將變更歷程檔刪除
      IF NOT s_adbt510_del_xmek(l_xmjbseq,0,0,"xmja024",g_xmee_m.xmeedocno,g_xmee_m.xmee900) THEN
         LET r_success = FALSE
         RETURN r_success
      END IF
   END IF  

   #送貨地址
   IF p_xmjb_d.xmjb901 = '3' OR (p_xmjb_d.xmjb901 = '2' AND
      ((p_xmjb_d.xmjb026 <> l_xmja.xmja026) OR
      (p_xmjb_d.xmjb026 IS NULL AND l_xmja.xmja026 IS NOT NULL) OR
      (p_xmjb_d.xmjb026 IS NOT NULL AND l_xmja.xmja026 IS NULL))) THEN
      #其說明的SQL
      LET g_xmek007 = ''
      #新增資料到變更歷程檔
      IF NOT s_adbt510_ins_xmek(l_xmjbseq,0,0,"xmja026",p_xmjb_d.xmjb901,l_xmja.xmja026,p_xmjb_d.xmjb026,g_xmee_m.xmeedocno,g_xmee_m.xmee900) THEN
         LET r_success = FALSE
         RETURN r_success
      END IF
      LET l_flag = TRUE
   ELSE
      #資料一樣，表示無變更，將變更歷程檔刪除
      IF NOT s_adbt510_del_xmek(l_xmjbseq,0,0,"xmja026",g_xmee_m.xmeedocno,g_xmee_m.xmee900) THEN
         LET r_success = FALSE
         RETURN r_success
      END IF
   END IF
   
   #送貨站點
   IF p_xmjb_d.xmjb901 = '3' OR (p_xmjb_d.xmjb901 = '2' AND
      ((p_xmjb_d.xmjb027 <> l_xmja.xmja027) OR
      (p_xmjb_d.xmjb027 IS NULL AND l_xmja.xmja027 IS NOT NULL) OR
      (p_xmjb_d.xmjb027 IS NOT NULL AND l_xmja.xmja027 IS NULL))) THEN
      #其說明的SQL
      LET g_xmek007 = "SELECT dbadl003 FROM dbadl_t WHERE dbadlent='"||g_enterprise||"' AND dbadl001=? AND dbadl002='"||g_dlang||"'"
      #新增資料到變更歷程檔
      IF NOT s_adbt510_ins_xmek(l_xmjbseq,0,0,"xmja027",p_xmjb_d.xmjb901,l_xmja.xmja027,p_xmjb_d.xmjb027,g_xmee_m.xmeedocno,g_xmee_m.xmee900) THEN
         LET r_success = FALSE
         RETURN r_success
      END IF
      LET l_flag = TRUE
   ELSE
      #資料一樣，表示無變更，將變更歷程檔刪除
      IF NOT s_adbt510_del_xmek(l_xmjbseq,0,0,"xmja027",g_xmee_m.xmeedocno,g_xmee_m.xmee900) THEN
         LET r_success = FALSE
         RETURN r_success
      END IF
   END IF 

   #多交期
   IF p_xmjb_d.xmjb901 = '3' OR (p_xmjb_d.xmjb901 = '2' AND
      ((p_xmjb_d.xmjb030 <> l_xmja.xmja030) OR
      (p_xmjb_d.xmjb030 IS NULL AND l_xmja.xmja030 IS NOT NULL) OR
      (p_xmjb_d.xmjb030 IS NOT NULL AND l_xmja.xmja030 IS NULL))) THEN
      #其說明的SQL
      LET g_xmek007 = ''
      #新增資料到變更歷程檔
      IF NOT s_adbt510_ins_xmek(l_xmjbseq,0,0,"xmja030",p_xmjb_d.xmjb901,l_xmja.xmja030,p_xmjb_d.xmjb030,g_xmee_m.xmeedocno,g_xmee_m.xmee900) THEN
         LET r_success = FALSE
         RETURN r_success
      END IF
      LET l_flag = TRUE
   ELSE
      #資料一樣，表示無變更，將變更歷程檔刪除
      IF NOT s_adbt510_del_xmek(l_xmjbseq,0,0,"xmja030",g_xmee_m.xmeedocno,g_xmee_m.xmee900) THEN
         LET r_success = FALSE
         RETURN r_success
      END IF
   END IF

   #約定交貨日
   IF p_xmjb_d.xmjb901 = '3' OR (p_xmjb_d.xmjb901 = '2' AND
      ((p_xmjb_d.xmjb031 <> l_xmja.xmja031) OR
      (p_xmjb_d.xmjb031 IS NULL AND l_xmja.xmja031 IS NOT NULL) OR
      (p_xmjb_d.xmjb031 IS NOT NULL AND l_xmja.xmja031 IS NULL))) THEN
      #其說明的SQL
      LET g_xmek007 = ''
      #新增資料到變更歷程檔
      IF NOT s_adbt510_ins_xmek(l_xmjbseq,0,0,"xmja031",p_xmjb_d.xmjb901,l_xmja.xmja031,p_xmjb_d.xmjb031,g_xmee_m.xmeedocno,g_xmee_m.xmee900) THEN
         LET r_success = FALSE
         RETURN r_success
      END IF
      LET l_flag = TRUE
   ELSE
      #資料一樣，表示無變更，將變更歷程檔刪除
      IF NOT s_adbt510_del_xmek(l_xmjbseq,0,0,"xmja031",g_xmee_m.xmeedocno,g_xmee_m.xmee900) THEN
         LET r_success = FALSE
         RETURN r_success
      END IF
   END IF

   #約定簽收日
   IF p_xmjb_d.xmjb901 = '3' OR (p_xmjb_d.xmjb901 = '2' AND
      ((p_xmjb_d.xmjb032 <> l_xmja.xmja032) OR
      (p_xmjb_d.xmjb032 IS NULL AND l_xmja.xmja032 IS NOT NULL) OR
      (p_xmjb_d.xmjb032 IS NOT NULL AND l_xmja.xmja032 IS NULL))) THEN
      #其說明的SQL
      LET g_xmek007 = ''
      #新增資料到變更歷程檔
      IF NOT s_adbt510_ins_xmek(l_xmjbseq,0,0,"xmja032",p_xmjb_d.xmjb901,l_xmja.xmja032,p_xmjb_d.xmjb032,g_xmee_m.xmeedocno,g_xmee_m.xmee900) THEN
         LET r_success = FALSE
         RETURN r_success
      END IF
      LET l_flag = TRUE
   ELSE
      #資料一樣，表示無變更，將變更歷程檔刪除
      IF NOT s_adbt510_del_xmek(l_xmjbseq,0,0,"xmja032",g_xmee_m.xmeedocno,g_xmee_m.xmee900) THEN
         LET r_success = FALSE
         RETURN r_success
      END IF
   END IF

   #參考單位
   IF p_xmjb_d.xmjb901 = '3' OR (p_xmjb_d.xmjb901 = '2' AND
      ((p_xmjb_d.xmjb015 <> l_xmja.xmja015) OR
      (p_xmjb_d.xmjb015 IS NULL AND l_xmja.xmja015 IS NOT NULL) OR
      (p_xmjb_d.xmjb015 IS NOT NULL AND l_xmja.xmja015 IS NULL))) THEN
      #其說明的SQL
      LET g_xmek007 = "SELECT oocal003 FROM oocal_t WHERE oocalent='"||g_enterprise||"' AND oocal001=? AND oocal002='"||g_dlang||"'"
      #新增資料到變更歷程檔
      IF NOT s_adbt510_ins_xmek(l_xmjbseq,0,0,"xmja015",p_xmjb_d.xmjb901,l_xmja.xmja015,p_xmjb_d.xmjb015,g_xmee_m.xmeedocno,g_xmee_m.xmee900) THEN
         LET r_success = FALSE
         RETURN r_success
      END IF
      LET l_flag = TRUE
   ELSE
      #資料一樣，表示無變更，將變更歷程檔刪除
      IF NOT s_adbt510_del_xmek(l_xmjbseq,0,0,"xmja015",g_xmee_m.xmeedocno,g_xmee_m.xmee900) THEN
         LET r_success = FALSE
         RETURN r_success
      END IF
   END IF

   #參考數量
   IF p_xmjb_d.xmjb901 = '3' OR (p_xmjb_d.xmjb901 = '2' AND
      ((p_xmjb_d.xmjb016 <> l_xmja.xmja016) OR
      (p_xmjb_d.xmjb016 IS NULL AND l_xmja.xmja016 IS NOT NULL) OR
      (p_xmjb_d.xmjb016 IS NOT NULL AND l_xmja.xmja016 IS NULL))) THEN
      #其說明的SQL
      LET g_xmek007 = ''
      #新增資料到變更歷程檔
      IF NOT s_adbt510_ins_xmek(l_xmjbseq,0,0,"xmja016",p_xmjb_d.xmjb901,l_xmja.xmja016,p_xmjb_d.xmjb016,g_xmee_m.xmeedocno,g_xmee_m.xmee900) THEN
         LET r_success = FALSE
         RETURN r_success
      END IF
      LET l_flag = TRUE
   ELSE
      #資料一樣，表示無變更，將變更歷程檔刪除
      IF NOT s_adbt510_del_xmek(l_xmjbseq,0,0,"xmja016",g_xmee_m.xmeedocno,g_xmee_m.xmee900) THEN
         LET r_success = FALSE
         RETURN r_success
      END IF
   END IF

   #表示此筆單身與訂單該筆單身一致
   IF l_flag = FALSE THEN
      UPDATE xmjb_t SET xmjb901 = '1'
       WHERE xmjbent = g_enterprise
         AND xmjbdocno = g_xmee_m.xmeedocno
         AND xmjb900 = g_xmee_m.xmee900
         AND xmjbseq = p_xmjb_d.xmjbseq
      IF SQLCA.sqlcode THEN
         CALL cl_err('xmjb_t',SQLCA.sqlcode,1)
         LET r_success = FALSE
         RETURN r_success
      END IF
   END IF

   RETURN r_success
END FUNCTION]]>
</point>
  <point name="function.adbt510_xmeg_ins_xmek" cite_std="N" status="u" ver="2" src="s" new="Y" order="108" mark_hard="N">
<![CDATA[
################################################################################
# Descriptions...: 將單身交期明細有修改的欄位新增到變更歷程檔內
# Memo...........:
# Usage..........: adbt510_xmeg_ins_xmek(p_xmegdocno,p_xmegseq,p_xmeg900)
#                  RETURNING r_success
# Input parameter: p_xmegdocno    單號
#                : p_xmegseq      項次
#                : p_xmeg900      變更序
# Return code....: r_success      TRUE/FALSE
#                : 
# Date & Author..: 日期 By 作者
# Modify.........:
################################################################################
PRIVATE FUNCTION adbt510_xmeg_ins_xmek(p_xmegdocno,p_xmegseq,p_xmeg900)
DEFINE p_xmegdocno       LIKE xmeg_t.xmegdocno
DEFINE p_xmegseq         LIKE xmeg_t.xmegseq
DEFINE p_xmeg900         LIKE xmeg_t.xmeg900
DEFINE l_xmeg_d          type_g_xmeg_d
DEFINE r_success         LIKE type_t.num5
DEFINE l_xmdc            RECORD LIKE xmdc_t.*
DEFINE l_ooef019         LIKE ooef_t.ooef019
DEFINE l_xmekseq         LIKE xmek_t.xmekseq
DEFINE l_flag            LIKE type_t.num5      #單身是否有修改

   LET r_success = TRUE

   IF l_xmeg_d.xmeg901 = '1' THEN       #未變更不需寫入歷程檔內  
      RETURN r_success
   END IF
   INITIALIZE l_xmeg_d.* TO NULL
   INITIALIZE l_xmdc.* TO NULL
   LET l_flag = FALSE
   
   SELECT xmeg901,xmeg008,xmeg009,xmeg024,xmeg012,
          xmeg013,xmegunit,xmeg050
     INTO l_xmeg_d.xmeg901,l_xmeg_d.xmeg008,l_xmeg_d.xmeg009,l_xmeg_d.xmeg024,l_xmeg_d.xmeg012,
          l_xmeg_d.xmeg013,l_xmeg_d.xmegunit,l_xmeg_d.xmeg050
     FROM xmeg_t
    WHERE xmegent = g_enterprise
      AND xmegdocno = p_xmegdocno
      AND xmegseq = p_xmegseq
      AND xmeg900 = p_xmeg900

   IF l_xmeg_d.xmeg901 = '2' THEN     
      SELECT xmdc008,xmdc009,xmdc024,xmdc012,
             xmdc013,xmdcunit,xmdc050
        INTO l_xmdc.xmdc008,l_xmdc.xmdc009,l_xmdc.xmdc024,l_xmdc.xmdc012,
             l_xmdc.xmdc013,l_xmdc.xmdcunit,l_xmdc.xmdc050
        FROM xmdc_t
       WHERE xmdcent = g_enterprise
         AND xmdcdocno = p_xmegdocno
         AND xmdcseq = p_xmegseq  
      IF SQLCA.sqlcode THEN
         CALL cl_err('sel xmdc_t',SQLCA.sqlcode,1)
         LET r_success = FALSE
         RETURN r_success
      END IF 
   END IF                    
   LET l_xmekseq = p_xmegseq

   #參考單位
   IF l_xmeg_d.xmeg901 = '3' OR (l_xmeg_d.xmeg901 = '2' AND
      ((l_xmeg_d.xmeg008 <> l_xmdc.xmdc008) OR
      (l_xmeg_d.xmeg008 IS NULL AND l_xmdc.xmdc008 IS NOT NULL) OR
      (l_xmeg_d.xmeg008 IS NOT NULL AND l_xmdc.xmdc008 IS NULL))) THEN
      #其說明的SQL
      LET g_xmek007 = "SELECT oocal003 FROM oocal_t WHERE oocalent='"||g_enterprise||"' AND oocal001=? AND oocal002='"||g_dlang||"' "
      #新增資料到變更歷程檔
      IF NOT s_axmt510_ins_xmek(l_xmekseq,0,0,"xmdc008",l_xmeg_d.xmeg901,l_xmdc.xmdc008,l_xmeg_d.xmeg008,p_xmegdocno,p_xmeg900) THEN
         LET r_success = FALSE
         RETURN r_success
      END IF
      LET l_flag = TRUE
   ELSE
      #資料一樣，表示無變更，將變更歷程檔刪除
      IF NOT s_axmt510_del_xmek(l_xmekseq,0,0,"xmdc008",p_xmegdocno,p_xmeg900) THEN
         LET r_success = FALSE
         RETURN r_success
      END IF
   END IF  
   
   #參考數量
   IF l_xmeg_d.xmeg901 = '3' OR (l_xmeg_d.xmeg901 = '2' AND
      ((l_xmeg_d.xmeg009 <> l_xmdc.xmdc009) OR
      (l_xmeg_d.xmeg009 IS NULL AND l_xmdc.xmdc009 IS NOT NULL) OR
      (l_xmeg_d.xmeg009 IS NOT NULL AND l_xmdc.xmdc009 IS NULL))) THEN
      #其說明的SQL
      LET g_xmek007 = ''
      #新增資料到變更歷程檔
      IF NOT s_axmt510_ins_xmek(l_xmekseq,0,0,"xmdc009",l_xmeg_d.xmeg901,l_xmdc.xmdc009,l_xmeg_d.xmeg009,p_xmegdocno,p_xmeg900) THEN
         LET r_success = FALSE
         RETURN r_success
      END IF
      LET l_flag = TRUE
   ELSE
      #資料一樣，表示無變更，將變更歷程檔刪除
      IF NOT s_axmt510_del_xmek(l_xmekseq,0,0,"xmdc009",p_xmegdocno,p_xmeg900) THEN
         LET r_success = FALSE
         RETURN r_success
      END IF
   END IF

   #多交期
   IF l_xmeg_d.xmeg901 = '3' OR (l_xmeg_d.xmeg901 = '2' AND
      ((l_xmeg_d.xmeg024 <> l_xmdc.xmdc024) OR
      (l_xmeg_d.xmeg024 IS NULL AND l_xmdc.xmdc024 IS NOT NULL) OR
      (l_xmeg_d.xmeg024 IS NOT NULL AND l_xmdc.xmdc024 IS NULL))) THEN
      #其說明的SQL
      LET g_xmek007 = ''
      #新增資料到變更歷程檔
      IF NOT s_axmt510_ins_xmek(l_xmekseq,0,0,"xmdc024",l_xmeg_d.xmeg901,l_xmdc.xmdc024,l_xmeg_d.xmeg024,p_xmegdocno,p_xmeg900) THEN
         LET r_success = FALSE
         RETURN r_success
      END IF
      LET l_flag = TRUE
   ELSE
      #資料一樣，表示無變更，將變更歷程檔刪除
      IF NOT s_axmt510_del_xmek(l_xmekseq,0,0,"xmdc024",p_xmegdocno,p_xmeg900) THEN
         LET r_success = FALSE
         RETURN r_success
      END IF
   END IF

   #約定交貨日
   IF l_xmeg_d.xmeg901 = '3' OR (l_xmeg_d.xmeg901 = '2' AND
      ((l_xmeg_d.xmeg012 <> l_xmdc.xmdc012) OR
      (l_xmeg_d.xmeg012 IS NULL AND l_xmdc.xmdc012 IS NOT NULL) OR
      (l_xmeg_d.xmeg012 IS NOT NULL AND l_xmdc.xmdc012 IS NULL))) THEN
      #其說明的SQL
      LET g_xmek007 = ''
      #新增資料到變更歷程檔
      IF NOT s_axmt510_ins_xmek(l_xmekseq,0,0,"xmdc012",l_xmeg_d.xmeg901,l_xmdc.xmdc012,l_xmeg_d.xmeg012,p_xmegdocno,p_xmeg900) THEN
         LET r_success = FALSE
         RETURN r_success
      END IF
      LET l_flag = TRUE
   ELSE
      #資料一樣，表示無變更，將變更歷程檔刪除
      IF NOT s_axmt510_del_xmek(l_xmekseq,0,0,"xmdc012",p_xmegdocno,p_xmeg900) THEN
         LET r_success = FALSE
         RETURN r_success
      END IF
   END IF

   #預定簽收日
   IF l_xmeg_d.xmeg901 = '3' OR (l_xmeg_d.xmeg901 = '2' AND
      ((l_xmeg_d.xmeg013 <> l_xmdc.xmdc013) OR
      (l_xmeg_d.xmeg013 IS NULL AND l_xmdc.xmdc013 IS NOT NULL) OR
      (l_xmeg_d.xmeg013 IS NOT NULL AND l_xmdc.xmdc013 IS NULL))) THEN
      #其說明的SQL
      LET g_xmek007 = ''
      #新增資料到變更歷程檔
      IF NOT s_axmt510_ins_xmek(l_xmekseq,0,0,"xmdc013",l_xmeg_d.xmeg901,l_xmdc.xmdc013,l_xmeg_d.xmeg013,p_xmegdocno,p_xmeg900) THEN
         LET r_success = FALSE
         RETURN r_success
      END IF
      LET l_flag = TRUE
   ELSE
      #資料一樣，表示無變更，將變更歷程檔刪除
      IF NOT s_axmt510_del_xmek(l_xmekseq,0,0,"xmdc013",p_xmegdocno,p_xmeg900) THEN
         LET r_success = FALSE
         RETURN r_success
      END IF
   END IF

   #出貨據點
   IF l_xmeg_d.xmeg901 = '3' OR (l_xmeg_d.xmeg901 = '2' AND
      ((l_xmeg_d.xmegunit <> l_xmdc.xmdcunit) OR
      (l_xmeg_d.xmegunit IS NULL AND l_xmdc.xmdcunit IS NOT NULL) OR
      (l_xmeg_d.xmegunit IS NOT NULL AND l_xmdc.xmdcunit IS NULL))) THEN
      #其說明的SQL
      LET g_xmek007 = "SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"' "
      #新增資料到變更歷程檔
      IF NOT s_axmt510_ins_xmek(l_xmekseq,0,0,"xmdcunit",l_xmeg_d.xmeg901,l_xmdc.xmdcunit,l_xmeg_d.xmegunit,p_xmegdocno,p_xmeg900) THEN
         LET r_success = FALSE
         RETURN r_success
      END IF
      LET l_flag = TRUE
   ELSE
      #資料一樣，表示無變更，將變更歷程檔刪除
      IF NOT s_axmt510_del_xmek(l_xmekseq,0,0,"xmdcunit",p_xmegdocno,p_xmeg900) THEN
         LET r_success = FALSE
         RETURN r_success
      END IF
   END IF
   
   
   #備註
   IF l_xmeg_d.xmeg901 = '3' OR (l_xmeg_d.xmeg901 = '2' AND
      ((l_xmeg_d.xmeg050 <> l_xmdc.xmdc050) OR
      (l_xmeg_d.xmeg050 IS NULL AND l_xmdc.xmdc050 IS NOT NULL) OR
      (l_xmeg_d.xmeg050 IS NOT NULL AND l_xmdc.xmdc050 IS NULL))) THEN
      #其說明的SQL
      LET g_xmek007 = ''
      #新增資料到變更歷程檔
      IF NOT s_axmt510_ins_xmek(l_xmekseq,0,0,"xmdc050",l_xmeg_d.xmeg901,l_xmdc.xmdc050,l_xmeg_d.xmeg050,p_xmegdocno,p_xmeg900) THEN
         LET r_success = FALSE
         RETURN r_success
      END IF
      LET l_flag = TRUE
   ELSE
      #資料一樣，表示無變更，將變更歷程檔刪除
      IF NOT s_axmt510_del_xmek(l_xmekseq,0,0,"xmdc050",p_xmegdocno,p_xmeg900) THEN
         LET r_success = FALSE
         RETURN r_success
      END IF
   END IF
   
   #表示此筆單身與訂單該筆單身一致
   IF l_flag = FALSE THEN
      UPDATE xmeg_t SET xmeg901 = '1'
       WHERE xmegent = g_enterprise
         AND xmegdocno = p_xmegdocno
         AND xmeg900 = p_xmeg900
         AND xmegseq = p_xmegseq
      IF SQLCA.sqlcode THEN
         CALL cl_err('xmeg_t',SQLCA.sqlcode,1)
         LET r_success = FALSE
         RETURN r_success
      END IF
   END IF

   RETURN r_success
END FUNCTION]]>
</point>
  <point name="function.adbt510_xmef_ins_xmek" cite_std="N" status="u" ver="2" src="s" new="Y" order="109" mark_hard="N">
<![CDATA[
PRIVATE FUNCTION adbt510_xmef_ins_xmek(p_xmef_d)
DEFINE p_xmef_d          type_g_xmeg5_d
DEFINE r_success         LIKE type_t.num5
DEFINE l_xmdb            RECORD LIKE xmdb_t.*
DEFINE l_flag            LIKE type_t.num5      #單身是否有修改

   LET r_success = TRUE

   IF p_xmef_d.xmef901 = '1' THEN       #未變更不需寫入歷程檔內  
      RETURN r_success
   END IF

   INITIALIZE l_xmdb.* TO NULL
   LET l_flag = FALSE

   IF p_xmef_d.xmef901 = '2' THEN     
      SELECT xmdbsite,xmdb001,xmdb002,xmdb003,xmdb004,
             xmdb005,xmdb006,xmdb007,xmdb008,xmdb009 
        INTO l_xmdb.xmdbsite,l_xmdb.xmdb001,l_xmdb.xmdb002,l_xmdb.xmdb003,l_xmdb.xmdb004,
             l_xmdb.xmdb005,l_xmdb.xmdb006,l_xmdb.xmdb007,l_xmdb.xmdb008,l_xmdb.xmdb009        
        FROM xmdb_t 
       WHERE xmdbent = g_enterprise
         AND xmdbdocno = g_xmee_m.xmeedocno
         AND xmdb001 = p_xmef_d.xmef001
      IF SQLCA.sqlcode THEN
         CALL cl_err('sel xmdb_t',SQLCA.sqlcode,1)
         LET r_success = FALSE
         RETURN r_success
      END IF 
   END IF                    

   #期別
   IF p_xmef_d.xmef901 = '3' OR (p_xmef_d.xmef901 = '2' AND
      ((p_xmef_d.xmef001 <> l_xmdb.xmdb001) OR
      (p_xmef_d.xmef001 IS NULL AND l_xmdb.xmdb001 IS NOT NULL) OR
      (p_xmef_d.xmef001 IS NOT NULL AND l_xmdb.xmdb001 IS NULL))) THEN
      #其說明的SQL
      LET g_xmek007 = ''
      #新增資料到變更歷程檔
      IF NOT s_adbt510_ins_xmek(0,0,p_xmef_d.xmef001,"xmdb001",p_xmef_d.xmef901,l_xmdb.xmdb001,p_xmef_d.xmef001,g_xmee_m.xmeedocno,g_xmee_m.xmee900) THEN
         LET r_success = FALSE
         RETURN r_success
      END IF
      LET l_flag = TRUE
   ELSE
      #資料一樣，表示無變更，將變更歷程檔刪除
      IF NOT s_adbt510_del_xmek(0,0,p_xmef_d.xmef001,"xmdb001",g_xmee_m.xmeedocno,g_xmee_m.xmee900) THEN
         LET r_success = FALSE
         RETURN r_success
      END IF
   END IF
   
   #收款條件
   IF p_xmef_d.xmef901 = '3' OR (p_xmef_d.xmef901 = '2' AND
      ((p_xmef_d.xmef002 <> l_xmdb.xmdb002) OR
      (p_xmef_d.xmef002 IS NULL AND l_xmdb.xmdb002 IS NOT NULL) OR
      (p_xmef_d.xmef002 IS NOT NULL AND l_xmdb.xmdb002 IS NULL))) THEN
      #其說明的SQL
      LET g_xmek007 = "SELECT ooibl004 FROM ooibl_t WHERE ooiblent='"||g_enterprise||"' AND ooibl002=? AND ooibl003='"||g_dlang||"' "
      #新增資料到變更歷程檔
      IF NOT s_adbt510_ins_xmek(0,0,p_xmef_d.xmef001,"xmdb002",p_xmef_d.xmef901,l_xmdb.xmdb002,p_xmef_d.xmef002,g_xmee_m.xmeedocno,g_xmee_m.xmee900) THEN
         LET r_success = FALSE
         RETURN r_success
      END IF
      LET l_flag = TRUE
   ELSE
      #資料一樣，表示無變更，將變更歷程檔刪除
      IF NOT s_adbt510_del_xmek(0,0,p_xmef_d.xmef001,"xmdb002",g_xmee_m.xmeedocno,g_xmee_m.xmee900) THEN
         LET r_success = FALSE
         RETURN r_success
      END IF
   END IF  

   #預計應收款日
   IF p_xmef_d.xmef901 = '3' OR (p_xmef_d.xmef901 = '2' AND
      ((p_xmef_d.xmef003 <> l_xmdb.xmdb003) OR
      (p_xmef_d.xmef003 IS NULL AND l_xmdb.xmdb003 IS NOT NULL) OR
      (p_xmef_d.xmef003 IS NOT NULL AND l_xmdb.xmdb003 IS NULL))) THEN
      #其說明的SQL
      LET g_xmek007 = ''
      #新增資料到變更歷程檔
      IF NOT s_adbt510_ins_xmek(0,0,p_xmef_d.xmef001,"xmdb003",p_xmef_d.xmef901,l_xmdb.xmdb003,p_xmef_d.xmef003,g_xmee_m.xmeedocno,g_xmee_m.xmee900) THEN
         LET r_success = FALSE
         RETURN r_success
      END IF
      LET l_flag = TRUE
   ELSE
      #資料一樣，表示無變更，將變更歷程檔刪除
      IF NOT s_adbt510_del_xmek(0,0,p_xmef_d.xmef001,"xmdb003",g_xmee_m.xmeedocno,g_xmee_m.xmee900) THEN
         LET r_success = FALSE
         RETURN r_success
      END IF
   END IF
   
   #預計票據到期日
   IF p_xmef_d.xmef901 = '3' OR (p_xmef_d.xmef901 = '2' AND
      ((p_xmef_d.xmef004 <> l_xmdb.xmdb004) OR
      (p_xmef_d.xmef004 IS NULL AND l_xmdb.xmdb004 IS NOT NULL) OR
      (p_xmef_d.xmef004 IS NOT NULL AND l_xmdb.xmdb004 IS NULL))) THEN
      #其說明的SQL
      LET g_xmek007 = ''
      #新增資料到變更歷程檔
      IF NOT s_adbt510_ins_xmek(0,0,p_xmef_d.xmef001,"xmdb004",p_xmef_d.xmef901,l_xmdb.xmdb004,p_xmef_d.xmef004,g_xmee_m.xmeedocno,g_xmee_m.xmee900) THEN
         LET r_success = FALSE
         RETURN r_success
      END IF
      LET l_flag = TRUE
   ELSE
      #資料一樣，表示無變更，將變更歷程檔刪除
      IF NOT s_adbt510_del_xmek(0,0,p_xmef_d.xmef001,"xmdb004",g_xmee_m.xmeedocno,g_xmee_m.xmee900) THEN
         LET r_success = FALSE
         RETURN r_success
      END IF
   END IF

   #預計票據到期日
   IF p_xmef_d.xmef901 = '3' OR (p_xmef_d.xmef901 = '2' AND
      ((p_xmef_d.xmef005 <> l_xmdb.xmdb005) OR
      (p_xmef_d.xmef005 IS NULL AND l_xmdb.xmdb005 IS NOT NULL) OR
      (p_xmef_d.xmef005 IS NOT NULL AND l_xmdb.xmdb005 IS NULL))) THEN
      #其說明的SQL
      LET g_xmek007 = ''
      #新增資料到變更歷程檔
      IF NOT s_adbt510_ins_xmek(0,0,p_xmef_d.xmef001,"xmdb005",p_xmef_d.xmef901,l_xmdb.xmdb005,p_xmef_d.xmef005,g_xmee_m.xmeedocno,g_xmee_m.xmee900) THEN
         LET r_success = FALSE
         RETURN r_success
      END IF
      LET l_flag = TRUE
   ELSE
      #資料一樣，表示無變更，將變更歷程檔刪除
      IF NOT s_adbt510_del_xmek(0,0,p_xmef_d.xmef001,"xmdb005",g_xmee_m.xmeedocno,g_xmee_m.xmee900) THEN
         LET r_success = FALSE
         RETURN r_success
      END IF
   END IF  
   
   #含稅金額
   IF p_xmef_d.xmef901 = '3' OR (p_xmef_d.xmef901 = '2' AND
      ((p_xmef_d.xmef006 <> l_xmdb.xmdb006) OR
      (p_xmef_d.xmef006 IS NULL AND l_xmdb.xmdb006 IS NOT NULL) OR
      (p_xmef_d.xmef006 IS NOT NULL AND l_xmdb.xmdb006 IS NULL))) THEN
      #其說明的SQL
      LET g_xmek007 = ''
      #新增資料到變更歷程檔
      IF NOT s_adbt510_ins_xmek(0,0,p_xmef_d.xmef001,"xmdb006",p_xmef_d.xmef901,l_xmdb.xmdb006,p_xmef_d.xmef006,g_xmee_m.xmeedocno,g_xmee_m.xmee900) THEN
         LET r_success = FALSE
         RETURN r_success
      END IF
      LET l_flag = TRUE
   ELSE
      #資料一樣，表示無變更，將變更歷程檔刪除
      IF NOT s_adbt510_del_xmek(0,0,p_xmef_d.xmef001,"xmdb006",g_xmee_m.xmeedocno,g_xmee_m.xmee900) THEN
         LET r_success = FALSE
         RETURN r_success
      END IF
   END IF  

   #應收帳款單號
   IF p_xmef_d.xmef901 = '3' OR (p_xmef_d.xmef901 = '2' AND
      ((p_xmef_d.xmef007 <> l_xmdb.xmdb007) OR
      (p_xmef_d.xmef007 IS NULL AND l_xmdb.xmdb007 IS NOT NULL) OR
      (p_xmef_d.xmef007 IS NOT NULL AND l_xmdb.xmdb007 IS NULL))) THEN
      #其說明的SQL
      LET g_xmek007 = ''
      #新增資料到變更歷程檔
      IF NOT s_adbt510_ins_xmek(0,0,p_xmef_d.xmef001,"xmdb007",p_xmef_d.xmef901,l_xmdb.xmdb007,p_xmef_d.xmef007,g_xmee_m.xmeedocno,g_xmee_m.xmee900) THEN
         LET r_success = FALSE
         RETURN r_success
      END IF
      LET l_flag = TRUE
   ELSE
      #資料一樣，表示無變更，將變更歷程檔刪除
      IF NOT s_adbt510_del_xmek(0,0,p_xmef_d.xmef001,"xmdb007",g_xmee_m.xmeedocno,g_xmee_m.xmee900) THEN
         LET r_success = FALSE
         RETURN r_success
      END IF
   END IF  
   
   #主帳套已收未稅金額
   IF p_xmef_d.xmef901 = '3' OR (p_xmef_d.xmef901 = '2' AND
      ((p_xmef_d.xmef008 <> l_xmdb.xmdb008) OR
      (p_xmef_d.xmef008 IS NULL AND l_xmdb.xmdb008 IS NOT NULL) OR
      (p_xmef_d.xmef008 IS NOT NULL AND l_xmdb.xmdb008 IS NULL))) THEN
      #其說明的SQL
      LET g_xmek007 = ''
      #新增資料到變更歷程檔
      IF NOT s_adbt510_ins_xmek(0,0,p_xmef_d.xmef001,"xmdb008",p_xmef_d.xmef901,l_xmdb.xmdb008,p_xmef_d.xmef008,g_xmee_m.xmeedocno,g_xmee_m.xmee900) THEN
         LET r_success = FALSE
         RETURN r_success
      END IF
      LET l_flag = TRUE
   ELSE
      #資料一樣，表示無變更，將變更歷程檔刪除
      IF NOT s_adbt510_del_xmek(0,0,p_xmef_d.xmef001,"xmdb008",g_xmee_m.xmeedocno,g_xmee_m.xmee900) THEN
         LET r_success = FALSE
         RETURN r_success
      END IF
   END IF  

   #主帳套已收未稅金額
   IF p_xmef_d.xmef901 = '3' OR (p_xmef_d.xmef901 = '2' AND
      ((p_xmef_d.xmef009 <> l_xmdb.xmdb009) OR
      (p_xmef_d.xmef009 IS NULL AND l_xmdb.xmdb009 IS NOT NULL) OR
      (p_xmef_d.xmef009 IS NOT NULL AND l_xmdb.xmdb009 IS NULL))) THEN
      #其說明的SQL
      LET g_xmek007 = ''
      #新增資料到變更歷程檔
      IF NOT s_adbt510_ins_xmek(0,0,p_xmef_d.xmef001,"xmdb009",p_xmef_d.xmef901,l_xmdb.xmdb009,p_xmef_d.xmef009,g_xmee_m.xmeedocno,g_xmee_m.xmee900) THEN
         LET r_success = FALSE
         RETURN r_success
      END IF
      LET l_flag = TRUE
   ELSE
      #資料一樣，表示無變更，將變更歷程檔刪除
      IF NOT s_adbt510_del_xmek(0,0,p_xmef_d.xmef001,"xmdb009",g_xmee_m.xmeedocno,g_xmee_m.xmee900) THEN
         LET r_success = FALSE
         RETURN r_success
      END IF
   END IF  

   #表示此筆單身與訂單該筆單身一致
   IF l_flag = FALSE THEN
      UPDATE xmef_t SET xmef901 = '1'
       WHERE xmefent = g_enterprise
         AND xmefdocno = g_xmee_m.xmeedocno
         AND xmef900 = g_xmee_m.xmee900
         AND xmef001 = p_xmef_d.xmef001
      IF SQLCA.sqlcode THEN
         CALL cl_err('xmef_t',SQLCA.sqlcode,1)
         LET r_success = FALSE
         RETURN r_success
      END IF
   END IF

   RETURN r_success
END FUNCTION]]>
</point>
  <point name="function.adbt510_xmdb008_exist" cite_std="N" status="u" ver="2" src="s" new="Y" order="110" mark_hard="N">
<![CDATA[
PRIVATE FUNCTION adbt510_xmdb008_exist()
   DEFINE r_exist    LIKE type_t.num5
   DEFINE l_sum        LIKE xmdb_t.xmdb008
   
   LET r_exist = FALSE
   
   SELECT SUM(xmdb008)
     INTO l_sum
     FROM xmdb_t
    WHERE xmdbent = g_enterprise
      AND xmdbdocno = g_xmee_m.xmeedocno   
   
   IF l_sum <> 0 THEN
      LET r_exist = TRUE
   END IF
   
   RETURN r_exist
END FUNCTION]]>
</point>
  <point name="function.adbt510_upd_unit" cite_std="N" status="u" ver="3" src="s" new="Y" order="111" mark_hard="N">
<![CDATA[
PRIVATE FUNCTION adbt510_upd_unit()
   DEFINE r_success    LIKE type_t.num5
   DEFINE l_i          LIKE type_t.num5
   DEFINE l_xmej200    LIKE xmej_t.xmej200
   DEFINE l_xmej201    LIKE xmej_t.xmej201
   
   LET r_success = TRUE

   #xmej
   #若代送商則重新取倉庫,儲位.其它則清空倉庫,儲位
   IF NOT cl_null(g_xmee_m.xmee201) THEN
     FOR l_i = 1 TO g_xmeg4_d.getLength()
        SELECT dbag004,dbag005
          INTO l_xmej200,l_xmej201
          FROM dbag_t
         WHERE dbagent = g_enterprise
           AND dbagsite = g_xmee_m.xmeeunit
           AND dbag001 = '1'
           AND dbag002 = g_xmee_m.xmee004
           AND dbag003 = g_xmeg4_d[l_i].xmjb025
           
        UPDATE xmej_t
           SET xmejunit = g_xmee_m.xmeeunit,
               xmej200 = l_xmej200,
               xmej201 = l_xmej201,
               xmej901 = CASE WHEN xmej901 = '1' THEN '2' ELSE xmej901 END
         WHERE xmejent = g_enterprise
           AND xmejdocno = g_xmee_m.xmeedocno
           AND xmej900 = g_xmee_m.xmee900
           AND xmejseq = g_xmeg4_d[l_i].xmjbseq
           
        IF SQLCA.sqlcode THEN
           CALL cl_err('xmej_t',SQLCA.sqlcode,1)
           LET r_success = FALSE
           RETURN r_success
        END IF 
     END FOR
   ELSE
      LET l_xmej200 = ''
      LET l_xmej201 = ''
      UPDATE xmej_t
         SET xmejunit = g_xmee_m.xmeeunit,
             xmej200 = l_xmej200,
             xmej201 = l_xmej201,
             xmej901 = CASE WHEN xmej901 = '1' THEN '2' ELSE xmej901 END
       WHERE xmejent = g_enterprise
         AND xmejdocno = g_xmee_m.xmeedocno
         AND xmej900 = g_xmee_m.xmee900
         
      IF SQLCA.sqlcode THEN
         CALL cl_err('xmej_t',SQLCA.sqlcode,1)
         LET r_success = FALSE
         RETURN r_success
      END IF
   END IF
   IF NOT adbt510_xmej_ins_xmek() THEN
      LET r_success = FALSE
      RETURN r_success
   END IF
   #xmeg
   UPDATE xmeg_t
      SET xmegunit = g_xmee_m.xmeeunit,
          xmeg901 = CASE WHEN xmeg901 = '1' THEN '2' ELSE xmeg901 END
    WHERE xmegent = g_enterprise
      AND xmegdocno = g_xmee_m.xmeedocno
      AND xmeg900 = g_xmee_m.xmee900
      
   IF SQLCA.sqlcode THEN
      CALL cl_err('xmeg_t',SQLCA.sqlcode,1)
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   FOR l_i = 1 TO g_xmeg_d.getLength()
      LET g_xmeg_d[l_i].xmegunit = g_xmee_m.xmeeunit 
      IF g_xmeg_d[l_i].xmeg901 = '1' THEN
         LET g_xmeg_d[l_i].xmeg901 = '2'
      END IF
      IF NOT adbt510_xmeg_ins_xmek(g_xmee_m.xmeedocno,g_xmeg_d[l_i].xmegseq,g_xmee_m.xmee900) THEN
         LET r_success = FALSE
         RETURN r_success
      END IF
      #xmeh 重新產生
      IF NOT s_adbt510_gen_xmeh(g_xmee_m.xmeedocno,g_xmeg_d[l_i].xmegseq,g_xmee_m.xmee900) THEN
         LET r_success = FALSE
         RETURN r_success
      END IF 
   END FOR
   
   FOR l_i = 1 TO g_xmeg3_d.getLength()
      LET g_xmeg3_d[l_i].xmehunit = g_xmee_m.xmeeunit 
   END FOR
   
   RETURN r_success
END FUNCTION]]>
</point>
  <point name="function.adbt510_xmej_ins_xmek" cite_std="N" status="u" ver="3" src="s" new="Y" order="112" mark_hard="N">
<![CDATA[
PRIVATE FUNCTION adbt510_xmej_ins_xmek()
   DEFINE r_success         LIKE type_t.num5
   DEFINE l_xmej            RECORD LIKE xmej_t.*
   DEFINE l_xmdf            RECORD LIKE xmdf_t.*
   DEFINE l_flag            LIKE type_t.num5 

   LET r_success = TRUE

   DECLARE adbt510_xmej_cl1 CURSOR FOR
   SELECT xmejseq,xmejseq2,xmej901,xmej200,xmej201,xmejunit
     FROM xmej_t
    WHERE xmejent = g_enterprise
      AND xmejdocno = g_xmee_m.xmeedocno
      AND xmej900 = g_xmee_m.xmee900
      
   FOREACH adbt510_xmej_cl1 INTO l_xmej.xmejseq,l_xmej.xmejseq2,l_xmej.xmej901,l_xmej.xmej200,l_xmej.xmej201,l_xmej.xmejunit
      IF l_xmej.xmej901 = '1' THEN     
         CONTINUE FOREACH
      END IF
      
      INITIALIZE l_xmdf.* TO NULL
      LET l_flag = FALSE
         
      IF l_xmej.xmej901 = '2' THEN
         SELECT xmdf200,xmdf201,xmdfunit
           INTO l_xmdf.xmdf200,l_xmdf.xmdf201,l_xmdf.xmdfunit
           FROM xmdf_t
          WHERE xmdfent = g_enterprise
            AND xmdfdocno = g_xmee_m.xmeedocno
            AND xmdfseq = l_xmej.xmejseq
            AND xmdfseq2 = l_xmej.xmejseq2
            
         IF SQLCA.sqlcode THEN
            CALL cl_err('sel xmdf_t',SQLCA.sqlcode,1)
            LET r_success = FALSE
            RETURN r_success
         END IF 
      END IF
      
      #倉庫
      IF l_xmej.xmej901 = '3' OR (l_xmej.xmej901 = '2' AND
         ((l_xmej.xmej200 <> l_xmdf.xmdf200) OR
         (l_xmej.xmej200 IS NULL AND l_xmdf.xmdf200 IS NOT NULL) OR
         (l_xmej.xmej200 IS NOT NULL AND l_xmdf.xmdf200 IS NULL))) THEN
         #其說明的SQL
         LET g_xmek007 = "SELECT inaa002 FROM inaa_t WHERE inaaent='"||g_enterprise||"' AND inaa001=? AND inaasite=? "
         #新增資料到變更歷程檔
         IF NOT s_axmt510_ins_xmek(l_xmej.xmejseq,0,l_xmej.xmejseq2,"xmdf200",l_xmej.xmej901,l_xmdf.xmdf200,l_xmej.xmej200,g_xmee_m.xmeedocno,g_xmee_m.xmee900) THEN
            LET r_success = FALSE
            RETURN r_success
         END IF
         LET l_flag = TRUE
      ELSE
         #資料一樣，表示無變更，將變更歷程檔刪除
         IF NOT s_axmt510_del_xmek(l_xmej.xmejseq,0,l_xmej.xmejseq2,"xmdf200",g_xmee_m.xmeedocno,g_xmee_m.xmee900) THEN
            LET r_success = FALSE
            RETURN r_success
         END IF
      END IF
      
      #儲位
      IF l_xmej.xmej901 = '3' OR (l_xmej.xmej901 = '2' AND
         ((l_xmej.xmej201 <> l_xmdf.xmdf201) OR
         (l_xmej.xmej201 IS NULL AND l_xmdf.xmdf201 IS NOT NULL) OR
         (l_xmej.xmej201 IS NOT NULL AND l_xmdf.xmdf201 IS NULL))) THEN
         #其說明的SQL
         LET g_xmek007 = "SELECT inab003 FROM inab_t WHERE inabent='"||g_enterprise||"' AND inab001=? AND inab002=? AND inabsite=? "
         #新增資料到變更歷程檔
         IF NOT s_axmt510_ins_xmek(l_xmej.xmejseq,0,l_xmej.xmejseq2,"xmdf201",l_xmej.xmej901,l_xmdf.xmdf201,l_xmej.xmej201,g_xmee_m.xmeedocno,g_xmee_m.xmee900) THEN
            LET r_success = FALSE
            RETURN r_success
         END IF
         LET l_flag = TRUE
      ELSE
         #資料一樣，表示無變更，將變更歷程檔刪除
         IF NOT s_axmt510_del_xmek(l_xmej.xmejseq,0,l_xmej.xmejseq2,"xmdf201",g_xmee_m.xmeedocno,g_xmee_m.xmee900) THEN
            LET r_success = FALSE
            RETURN r_success
         END IF
      END IF

      #發貨組織
      IF l_xmej.xmej901 = '3' OR (l_xmej.xmej901 = '2' AND
         ((l_xmej.xmejunit <> l_xmdf.xmdfunit) OR
         (l_xmej.xmejunit IS NULL AND l_xmdf.xmdfunit IS NOT NULL) OR
         (l_xmej.xmejunit IS NOT NULL AND l_xmdf.xmdfunit IS NULL))) THEN
         #其說明的SQL
         LET g_xmek007 = "SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"' "
         #新增資料到變更歷程檔
         IF NOT s_axmt510_ins_xmek(l_xmej.xmejseq,0,l_xmej.xmejseq2,"xmdfunit",l_xmej.xmej901,l_xmdf.xmdfunit,l_xmej.xmejunit,g_xmee_m.xmeedocno,g_xmee_m.xmee900) THEN
            LET r_success = FALSE
            RETURN r_success
         END IF
         LET l_flag = TRUE
      ELSE
         #資料一樣，表示無變更，將變更歷程檔刪除
         IF NOT s_axmt510_del_xmek(l_xmej.xmejseq,0,l_xmej.xmejseq2,"xmdfunit",g_xmee_m.xmeedocno,g_xmee_m.xmee900) THEN
            LET r_success = FALSE
            RETURN r_success
         END IF
      END IF
   END FOREACH   

   RETURN r_success
END FUNCTION]]>
</point>
  <point name="b_fill.body.fill_sql" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                    ]]>
</point>
  <point name="b_fill.body2.fill_sql" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                    ]]>
</point>
  <point name="b_fill.body3.fill_sql" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                    ]]>
</point>
  <point name="b_fill.define" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                  ]]>
</point>
  <point name="b_fill.fill" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[         #單身文字的顏色顯示
         CALL adbt510_detail_color() ]]>
</point>
  <point name="b_fill.sql" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                           ]]>
</point>
  <point name="b_fill.sql2" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                    ]]>
</point>
  <point name="b_fill.sql3" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                    ]]>
</point>
  <point name="b_fill.sql_before" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                  ]]>
</point>
  <point name="b_fill2.after_fill" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                  ]]>
</point>
  <point name="b_fill2.define" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                  ]]>
</point>
  <point name="b_fill2.fill" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[         #單身文字的顏色顯示
         CALL adbt510_detail3_color()                    ]]>
</point>
  <point name="b_fill3.fill" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[         #單身文字的顏色顯示
         CALL adbt510_detail4_color()                                         ]]>
</point>
  <point name="b_fill4.fill" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[         #單身文字的顏色顯示
         CALL adbt510_detail5_color() ]]>
</point>
  <point name="b_fill5.fill" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[         LET g_xmeg6_d[l_ac].imay0031 = NULL
         LET g_xmeg6_d[l_ac].imaa0011 = NULL
         SELECT xmjb002,xmjb003
           INTO g_xmeg6_d[l_ac].imay0031,g_xmeg6_d[l_ac].imaa0011
           FROM xmjb_t
          WHERE xmjbent = g_enterprise
            AND xmjbdocno = g_xmee_m.xmeedocno
            AND xmjbseq = g_xmeg6_d[l_ac].xrcdseq]]>
</point>
  <point name="b_fill6.fill" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[         LET g_xmeg7_d[l_ac].imay0032 = NULL
         LET g_xmeg7_d[l_ac].imaa0012 = NULL
         SELECT xmjb002,xmjb003
           INTO g_xmeg7_d[l_ac].imay0032,g_xmeg7_d[l_ac].imaa0012
           FROM xmjb_t
          WHERE xmjbent = g_enterprise
            AND xmjbdocno = g_xmee_m.xmeedocno
            AND xmjbseq = g_xmeg7_d[l_ac].rtieseq]]>
</point>
  <point name="browser_fill.after" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                  ]]>
</point>
  <point name="browser_fill.before_count" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                  ]]>
</point>
  <point name="browser_fill.before_foreach" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[     
   IF cl_null(g_wc) THEN
      #LET g_wc = " xmeesite = '",g_site,"' AND xmee005 IN ('1','2','3','6') AND xmee007 IN ('1','5') "
      LET g_wc = " AND xmee005 IN ('1','2','3','6') AND xmee007 IN ('1','5') "
   ELSE
      #LET g_wc = g_wc," AND xmeesite = '",g_site,"'  AND xmee005 IN ('1','2','3','6') AND xmee007 IN ('1','5') "
      LET g_wc = g_wc," AND xmee005 IN ('1','2','3','6') AND xmee007 IN ('1','5') "
   END IF
   LET l_wc  = g_wc.trim()   ]]>
</point>
  <point name="browser_fill.before_prepare" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                  ]]>
</point>
  <point name="browser_fill.define" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                  ]]>
</point>
  <point name="browser_fill.open" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                  ]]>
</point>
  <point name="browser_fill.other_fill" cite_std="N" status="" ver="3" src="s" new="N" mark_hard="N">
<![CDATA[
      LET g_sql = "SELECT  UNIQUE rtieseq,rtib003,rtib004,'','',rtieseq1,rtie001,rtie002,'',rtie006 FROM rtie_t", 
                  " INNER JOIN rtia_t ON rtiaent = rtieent AND rtiadocno = rtiedocno ",
                  " INNER JOIN rtib_t ON rtibent = rtiaent AND rtibdocno = rtiadocno AND rtibseq = rtieseq ",
                  " INNER JOIN xmee_t ON xmeedocno = rtia007 ",
                  " WHERE rtieent=? AND xmeedocno=?"   
      LET g_sql = g_sql, " ORDER BY rtie_t.rtieseq,rtie_t.rtieseq1"
            
      PREPARE adbt510_pb6 FROM g_sql
      DECLARE b_fill_cs6 CURSOR FOR adbt510_pb6
      
      LET l_ac = 1
      
      OPEN b_fill_cs6 USING g_enterprise,g_xmee_m.xmeedocno
 
                                               
      FOREACH b_fill_cs6 INTO g_xmeg7_d[l_ac].rtieseq,g_xmeg7_d[l_ac].imay0032,g_xmeg7_d[l_ac].imaa0012, 
          g_xmeg7_d[l_ac].imaa0012_desc,g_xmeg7_d[l_ac].imaa0012_desc_desc,g_xmeg7_d[l_ac].rtieseq1, 
          g_xmeg7_d[l_ac].rtie001,g_xmeg7_d[l_ac].rtie002,g_xmeg7_d[l_ac].rtie002_desc,g_xmeg7_d[l_ac].rtie006 

         IF SQLCA.sqlcode THEN
            CALL cl_err("FOREACH:",SQLCA.sqlcode,1)
            EXIT FOREACH
         END IF
      
         LET l_ac = l_ac + 1
         IF l_ac > g_max_rec THEN
            CALL cl_err( '', 9035, 0 )
            EXIT FOREACH
         END IF
         
      END FOREACH
   CALL g_xmeg7_d.deleteElement(g_xmeg7_d.getLength())]]>
</point>
  <point name="browser_fill.reference" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                    ]]>
</point>
  <point name="browser_search.define" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                  ]]>
</point>
  <point name="construct.a.page1.imaal004" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.page1.xmeg001" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.page1.xmeg002" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.page1.xmeg004" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.page1.xmeg005" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.page1.xmeg006" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.page1.xmeg007" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.page1.xmeg008" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.page1.xmeg009" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.page1.xmeg010" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.page1.xmeg011" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.page1.xmeg012" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.page1.xmeg013" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.page1.xmeg015" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.page1.xmeg016" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.page1.xmeg019" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.page1.xmeg020" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.page1.xmeg021" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.page1.xmeg022" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.page1.xmeg023" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.page1.xmeg024" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.page1.xmeg027" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.page1.xmeg045" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.page1.xmeg049" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.page1.xmeg050" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.page1.xmeg052" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.page1.xmegorga" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.page1.xmegseq" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.page1.xmegunit" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.page2.xmeg003" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.page2.xmeg025" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.page2.xmeg026" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.page2.xmeg0272" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.page2.xmeg028" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.page2.xmeg029" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.page2.xmeg030" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.page2.xmeg031" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.page2.xmeg032" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.page2.xmeg033" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.page2.xmeg034" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.page2.xmeg036" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.page2.xmeg037" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.page2.xmeg038" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.page2.xmeg039" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.page3.xmeg012" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.page3.xmeg013" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.xmee001" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.xmee002" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.xmee003" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.xmee004" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.xmee005" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.xmee006" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.xmee007" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.xmee008" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.xmee009" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.xmee010" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.xmee011" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.xmee012" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.xmee013" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.xmee015" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.xmee016" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.xmee017" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.xmee018" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.xmee019" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.xmee020" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.xmee021" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.xmee022" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.xmee023" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.xmee024" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.xmee025" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.xmee026" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.xmee027" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.xmee028" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.xmee030" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.xmee031" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.xmee032" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.xmee033" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.xmee034" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.xmee035" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.xmee036" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.xmee037" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.xmee038" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.xmee039" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.xmee043" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.xmee044" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.xmeecnfid" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.xmeecrtdp" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.xmeecrtid" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.xmeedocdt" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.xmeedocno" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.xmeemodid" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.xmeeowndp" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.xmeeownid" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.xmeesite" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.a.xmeestus" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.page1.imaal004" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.page1.xmeg001" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.page1.xmeg002" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.page1.xmeg004" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.page1.xmeg005" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.page1.xmeg006" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.page1.xmeg007" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.page1.xmeg008" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.page1.xmeg009" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.page1.xmeg010" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.page1.xmeg011" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.page1.xmeg012" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.page1.xmeg013" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.page1.xmeg015" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.page1.xmeg016" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.page1.xmeg019" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.page1.xmeg020" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.page1.xmeg021" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.page1.xmeg022" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.page1.xmeg023" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.page1.xmeg024" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.page1.xmeg027" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.page1.xmeg045" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.page1.xmeg049" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.page1.xmeg050" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.page1.xmeg052" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.page1.xmegorga" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.page1.xmegseq" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.page1.xmegunit" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.page2.xmeg003" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.page2.xmeg025" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.page2.xmeg026" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.page2.xmeg0272" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.page2.xmeg028" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.page2.xmeg029" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.page2.xmeg030" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.page2.xmeg031" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.page2.xmeg032" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.page2.xmeg033" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.page2.xmeg034" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.page2.xmeg036" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.page2.xmeg037" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.page2.xmeg038" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.page2.xmeg039" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.page3.xmeg012" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.page3.xmeg013" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.xmee001" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.xmee002" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.xmee003" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.xmee004" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.xmee005" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.xmee006" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.xmee007" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.xmee008" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.xmee009" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.xmee010" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.xmee011" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.xmee012" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.xmee013" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.xmee015" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.xmee016" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.xmee017" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.xmee018" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.xmee019" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.xmee020" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.xmee021" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.xmee022" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.xmee023" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.xmee024" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.xmee025" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.xmee026" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.xmee027" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.xmee028" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.xmee030" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.xmee031" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.xmee032" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.xmee033" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.xmee034" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.xmee035" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.xmee036" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.xmee037" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.xmee038" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.xmee039" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.xmee043" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.xmee044" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.xmeecnfdt" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.xmeecnfid" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.xmeecrtdp" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.xmeecrtdt" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.xmeecrtid" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.xmeedocdt" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.xmeedocno" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.xmeemoddt" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.xmeemodid" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.xmeeowndp" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.xmeeownid" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.xmeesite" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.b.xmeestus" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.c.page1.imaal004" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.c.page1.xmeg001" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_imaa001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmeg001  #顯示到畫面上

            NEXT FIELD xmeg001                     #返回原欄位

]]>
</point>
  <point name="construct.c.page1.xmeg002" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.c.page1.xmeg004" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			LET g_qryparam.arg1 = '221'
            CALL q_oocq002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmeg004  #顯示到畫面上

            NEXT FIELD xmeg004                     #返回原欄位

]]>
</point>
  <point name="construct.c.page1.xmeg005" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.c.page1.xmeg006" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooca001_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmeg006  #顯示到畫面上

            NEXT FIELD xmeg006                     #返回原欄位

]]>
</point>
  <point name="construct.c.page1.xmeg007" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.c.page1.xmeg008" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooca001_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmeg008  #顯示到畫面上

            NEXT FIELD xmeg008                     #返回原欄位

]]>
</point>
  <point name="construct.c.page1.xmeg009" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.c.page1.xmeg010" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooca001_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmeg010  #顯示到畫面上

            NEXT FIELD xmeg010                     #返回原欄位

]]>
</point>
  <point name="construct.c.page1.xmeg011" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.c.page1.xmeg012" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.c.page1.xmeg013" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.c.page1.xmeg015" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.c.page1.xmeg016" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_oodb002_2()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmeg016  #顯示到畫面上

            NEXT FIELD xmeg016                     #返回原欄位

]]>
</point>
  <point name="construct.c.page1.xmeg019" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.c.page1.xmeg020" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.c.page1.xmeg021" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.c.page1.xmeg022" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.c.page1.xmeg023" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_pmac002_6()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmeg023  #顯示到畫面上
               #DISPLAY g_qryparam.return2 TO pmaal004 #交易對象簡稱 

            NEXT FIELD xmeg023                     #返回原欄位

]]>
</point>
  <point name="construct.c.page1.xmeg024" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.c.page1.xmeg027" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_pmao004_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmeg027  #顯示到畫面上

            NEXT FIELD xmeg027                     #返回原欄位

]]>
</point>
  <point name="construct.c.page1.xmeg045" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.c.page1.xmeg049" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			LET g_qryparam.arg1 = g_acc
            CALL q_oocq002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmeg049  #顯示到畫面上

            NEXT FIELD xmeg049                     #返回原欄位

]]>
</point>
  <point name="construct.c.page1.xmeg050" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.c.page1.xmeg052" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.c.page1.xmeg053" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			LET g_qryparam.arg1 = g_acc
            CALL q_oocq002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmeg053  #顯示到畫面上

            NEXT FIELD xmeg053                     #返回原欄位

]]>
</point>
  <point name="construct.c.page1.xmeg902" cite_std="N" status="" ver="2" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.arg1 = "267"
            CALL q_oocq002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmeg902  #顯示到畫面上
            NEXT FIELD xmeg902                     #返回原欄位
    

]]>
</point>
  <point name="construct.c.page1.xmegorga" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooef001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmegorga  #顯示到畫面上

            NEXT FIELD xmegorga                     #返回原欄位

]]>
</point>
  <point name="construct.c.page1.xmegseq" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.c.page1.xmegunit" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooef001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmegunit  #顯示到畫面上

            NEXT FIELD xmegunit                     #返回原欄位

]]>
</point>
  <point name="construct.c.page1.xmjb002" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_imay003_6()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmjb002  #顯示到畫面上
            NEXT FIELD xmjb002                     #返回原欄位
    

]]>
</point>
  <point name="construct.c.page1.xmjb003" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_imaa001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmjb003  #顯示到畫面上
            NEXT FIELD xmjb003                     #返回原欄位
    

]]>
</point>
  <point name="construct.c.page1.xmjb005" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_prcf001_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmjb005  #顯示到畫面上
            NEXT FIELD xmjb005                     #返回原欄位
    

]]>
</point>
  <point name="construct.c.page1.xmjb006" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_oodb002_2()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmjb006  #顯示到畫面上
            NEXT FIELD xmjb006                     #返回原欄位
    

]]>
</point>
  <point name="construct.c.page1.xmjb011" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_ooca001_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmjb011  #顯示到畫面上
            NEXT FIELD xmjb011                     #返回原欄位
    

]]>
</point>
  <point name="construct.c.page1.xmjb013" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_ooca001_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmjb013  #顯示到畫面上
            NEXT FIELD xmjb013                     #返回原欄位
    

]]>
</point>
  <point name="construct.c.page1.xmjb015" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_ooca001_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmjb015  #顯示到畫面上
            NEXT FIELD xmjb015                     #返回原欄位
    

]]>
</point>
  <point name="construct.c.page1.xmjb017" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_ooca001_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmjb017  #顯示到畫面上
            NEXT FIELD xmjb017                     #返回原欄位
    

]]>
</point>
  <point name="construct.c.page1.xmjb024" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_pmaa001_18()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmjb024  #顯示到畫面上
            NEXT FIELD xmjb024                     #返回原欄位
    

]]>
</point>
  <point name="construct.c.page1.xmjb026" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_oofb019()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmjb026  #顯示到畫面上
            NEXT FIELD xmjb026                     #返回原欄位
    

]]>
</point>
  <point name="construct.c.page1.xmjb027" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_dbad001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmjb027  #顯示到畫面上
            NEXT FIELD xmjb027                     #返回原欄位
    

]]>
</point>
  <point name="construct.c.page1.xmjb033" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_pmao004_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmjb033  #顯示到畫面上
            NEXT FIELD xmjb033                     #返回原欄位
    

]]>
</point>
  <point name="construct.c.page2.xmee0272" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_pmao004_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmee0272  #顯示到畫面上

            NEXT FIELD xmee0272                     #返回原欄位

]]>
</point>
  <point name="construct.c.page2.xmeg003" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.c.page2.xmeg025" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			LET g_qryparam.arg1 = g_oofa001
            CALL q_oofb019_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmeg025  #顯示到畫面上

            NEXT FIELD xmeg025                     #返回原欄位

]]>
</point>
  <point name="construct.c.page2.xmeg026" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			LET g_qryparam.arg1 = g_oofa001
            CALL q_oofb019_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmeg026  #顯示到畫面上

            NEXT FIELD xmeg026                     #返回原欄位

]]>
</point>
  <point name="construct.c.page2.xmeg027" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_pmao004_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmeg027  #顯示到畫面上

            NEXT FIELD xmeg027                     #返回原欄位

]]>
</point>
  <point name="construct.c.page2.xmeg0272" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_pmao004_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmeg0272  #顯示到畫面上

            NEXT FIELD xmeg0272                     #返回原欄位

]]>
</point>
  <point name="construct.c.page2.xmeg027_1" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_pmao004_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmeg027_1  #顯示到畫面上

            NEXT FIELD xmeg027_1                     #返回原欄位

]]>
</point>
  <point name="construct.c.page2.xmeg028" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_inaa001_6()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmeg028  #顯示到畫面上

            NEXT FIELD xmeg028                     #返回原欄位

]]>
</point>
  <point name="construct.c.page2.xmeg029" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_inab002_6()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmeg029  #顯示到畫面上

            NEXT FIELD xmeg029                     #返回原欄位

]]>
</point>
  <point name="construct.c.page2.xmeg030" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.c.page2.xmeg031" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			LET g_qryparam.arg1 = "263"
            CALL q_oocq002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmeg031  #顯示到畫面上
          
            NEXT FIELD xmee031                     #返回原欄位                                                                        ]]>
</point>
  <point name="construct.c.page2.xmeg032" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.c.page2.xmeg033" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.c.page2.xmeg034" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.c.page2.xmeg036" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.c.page2.xmeg037" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.c.page2.xmeg038" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.c.page2.xmeg039" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.c.page3.xmeg012" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.c.page3.xmeg013" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.c.page3.xmeh001" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_imaa001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmeh001  #顯示到畫面上

            NEXT FIELD xmeh001                     #返回原欄位

]]>
</point>
  <point name="construct.c.page3.xmeh004" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooca001_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmeh004  #顯示到畫面上

            NEXT FIELD xmeh004                     #返回原欄位

]]>
</point>
  <point name="construct.c.page3.xmeh017" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_oodb002_2()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmeh017  #顯示到畫面上

            NEXT FIELD xmeh017                     #返回原欄位

]]>
</point>
  <point name="construct.c.page3.xmeh019" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_oodb002_2()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmeh019  #顯示到畫面上
            NEXT FIELD xmeh019                     #返回原欄位
    

]]>
</point>
  <point name="construct.c.page3.xmeh022" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooag001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmeh022  #顯示到畫面上

            NEXT FIELD xmeh022                     #返回原欄位

]]>
</point>
  <point name="construct.c.page3.xmeh024" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooca001_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmeh024  #顯示到畫面上

            NEXT FIELD xmeh024                     #返回原欄位

]]>
</point>
  <point name="construct.c.page3.xmeh026" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooca001_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmeh026  #顯示到畫面上

            NEXT FIELD xmeh026                     #返回原欄位

]]>
</point>
  <point name="construct.c.page3.xmeh200" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_prcf001_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmeh200  #顯示到畫面上
            NEXT FIELD xmeh200                     #返回原欄位
    

]]>
</point>
  <point name="construct.c.page3.xmeh201" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_ooca001_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmeh201  #顯示到畫面上
            NEXT FIELD xmeh201                     #返回原欄位
    

]]>
</point>
  <point name="construct.c.page3.xmeh207" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_pmaa001_18()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmeh207  #顯示到畫面上
            NEXT FIELD xmeh207                     #返回原欄位
    

]]>
</point>
  <point name="construct.c.page3.xmeh210" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.arg1 = "274"
            CALL q_oocq002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmeh210  #顯示到畫面上
            NEXT FIELD xmeh210                     #返回原欄位
    

]]>
</point>
  <point name="construct.c.page3.xmeh213" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.arg1 = g_site
            CALL q_inaa001_4()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmeh213  #顯示到畫面上
            NEXT FIELD xmeh213                     #返回原欄位
    

]]>
</point>
  <point name="construct.c.page3.xmeh214" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.arg1 = g_site
            CALL q_inab002_8()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmeh214  #顯示到畫面上
            NEXT FIELD xmeh214                     #返回原欄位
    

]]>
</point>
  <point name="construct.c.page3.xmeh218" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.arg1 = "1"
            CALL q_oojd001_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmeh218  #顯示到畫面上
            NEXT FIELD xmeh218                     #返回原欄位
    

]]>
</point>
  <point name="construct.c.page3.xmeh219" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_dbba001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmeh219  #顯示到畫面上
            NEXT FIELD xmeh219                     #返回原欄位
    

]]>
</point>
  <point name="construct.c.page3.xmeh220" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_dbbc001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmeh220  #顯示到畫面上
            NEXT FIELD xmeh220                     #返回原欄位
    

]]>
</point>
  <point name="construct.c.page3.xmeh222" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.arg1 = "G"
            CALL q_ooef001_3()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmeh222  #顯示到畫面上
            NEXT FIELD xmeh222                     #返回原欄位
    

]]>
</point>
  <point name="construct.c.page3.xmeh223" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_ooag001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmeh223  #顯示到畫面上
            NEXT FIELD xmeh223                     #返回原欄位
    

]]>
</point>
  <point name="construct.c.page3.xmeh224" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.arg1 = g_xmee_m.xmeedocdt
            CALL q_ooeg001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmeh224  #顯示到畫面上
            NEXT FIELD xmeh224                     #返回原欄位
    

]]>
</point>
  <point name="construct.c.page3.xmeh227" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.arg1 = "2060"
            CALL q_oocq002_5()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmeh227  #顯示到畫面上
            NEXT FIELD xmeh227                     #返回原欄位
    

]]>
</point>
  <point name="construct.c.page3.xmeh228" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_staa001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmeh228  #顯示到畫面上
            NEXT FIELD xmeh228                     #返回原欄位
    

]]>
</point>
  <point name="construct.c.page3.xmehorga" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.arg1 = "A"
            CALL q_ooef001_3()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmehorga  #顯示到畫面上
            NEXT FIELD xmehorga                     #返回原欄位
    

]]>
</point>
  <point name="construct.c.page3.xmehsite" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.arg1 = g_site
			   LET g_qryparam.arg2 = '2'
            CALL q_ooed004_3()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmehsite  #顯示到畫面上
            NEXT FIELD xmehsite                     #返回原欄位
    

]]>
</point>
  <point name="construct.c.page3.xmehunit" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
			   LET g_qryparam.arg1 = g_site
			   LET g_qryparam.arg2 = '2'
            CALL q_ooed004_3()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmehunit  #顯示到畫面上
            NEXT FIELD xmehunit                     #返回原欄位
    

]]>
</point>
  <point name="construct.c.page4.xmde001" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_imaa001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmde001  #顯示到畫面上

            NEXT FIELD xmde001                     #返回原欄位

]]>
</point>
  <point name="construct.c.page4.xmde003" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_xmdadocno()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmde003  #顯示到畫面上

            NEXT FIELD xmde003                     #返回原欄位

]]>
</point>
  <point name="construct.c.page4.xmde008" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_oocq002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmde008  #顯示到畫面上

            NEXT FIELD xmde008                     #返回原欄位

]]>
</point>
  <point name="construct.c.page4.xmde022" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooca001_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmde022  #顯示到畫面上

            NEXT FIELD xmde022                     #返回原欄位

]]>
</point>
  <point name="construct.c.page4.xmeg001" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_imaa001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmeg001  #顯示到畫面上
            NEXT FIELD xmeg001                     #返回原欄位
    

]]>
</point>
  <point name="construct.c.page4.xmeg004" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_oocq002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmeg004  #顯示到畫面上
            NEXT FIELD xmeg004                     #返回原欄位
    

]]>
</point>
  <point name="construct.c.page4.xmeg006" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_ooca001_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmeg006  #顯示到畫面上
            NEXT FIELD xmeg006                     #返回原欄位
    

]]>
</point>
  <point name="construct.c.page4.xmeg008" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_ooca001_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmeg008  #顯示到畫面上
            NEXT FIELD xmeg008                     #返回原欄位
    

]]>
</point>
  <point name="construct.c.page4.xmeg010" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_ooca001_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmeg010  #顯示到畫面上
            NEXT FIELD xmeg010                     #返回原欄位
    

]]>
</point>
  <point name="construct.c.page4.xmeg016" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_oodb002_2()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmeg016  #顯示到畫面上
            NEXT FIELD xmeg016                     #返回原欄位
    

]]>
</point>
  <point name="construct.c.page4.xmeg023" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_pmac002_4()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmeg023  #顯示到畫面上
            NEXT FIELD xmeg023                     #返回原欄位
    

]]>
</point>
  <point name="construct.c.page4.xmeg027" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_pmao004_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmeg027  #顯示到畫面上
            NEXT FIELD xmeg027                     #返回原欄位
    

]]>
</point>
  <point name="construct.c.page4.xmeg049" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_oocq002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmeg049  #顯示到畫面上
            NEXT FIELD xmeg049                     #返回原欄位
    

]]>
</point>
  <point name="construct.c.page4.xmeg053" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_oocq002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmeg053  #顯示到畫面上
            NEXT FIELD xmeg053                     #返回原欄位
    

]]>
</point>
  <point name="construct.c.page4.xmegorga" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_ooef001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmegorga  #顯示到畫面上
            NEXT FIELD xmegorga                     #返回原欄位
    

]]>
</point>
  <point name="construct.c.page4.xmegunit" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_ooef001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmegunit  #顯示到畫面上
            NEXT FIELD xmegunit                     #返回原欄位
    

]]>
</point>
  <point name="construct.c.page4.xmjb002" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_imay003_6()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmjb002  #顯示到畫面上
            NEXT FIELD xmjb002                     #返回原欄位
    

]]>
</point>
  <point name="construct.c.page4.xmjb003" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_imaa001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmjb003  #顯示到畫面上
            NEXT FIELD xmjb003                     #返回原欄位
    

]]>
</point>
  <point name="construct.c.page4.xmjb004" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_xmja004()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmjb004  #顯示到畫面上
            NEXT FIELD xmjb004                     #返回原欄位
    

]]>
</point>
  <point name="construct.c.page4.xmjb005" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_prcf001_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmjb005  #顯示到畫面上
            NEXT FIELD xmjb005                     #返回原欄位
    

]]>
</point>
  <point name="construct.c.page4.xmjb006" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_oodb002_2()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmjb006  #顯示到畫面上
            NEXT FIELD xmjb006                     #返回原欄位
    

]]>
</point>
  <point name="construct.c.page4.xmjb011" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_ooca001_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmjb011  #顯示到畫面上
            NEXT FIELD xmjb011                     #返回原欄位
    

]]>
</point>
  <point name="construct.c.page4.xmjb013" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_ooca001_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmjb013  #顯示到畫面上
            NEXT FIELD xmjb013                     #返回原欄位
    

]]>
</point>
  <point name="construct.c.page4.xmjb015" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_ooca001_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmjb015  #顯示到畫面上
            NEXT FIELD xmjb015                     #返回原欄位
    

]]>
</point>
  <point name="construct.c.page4.xmjb017" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_ooca001_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmjb017  #顯示到畫面上
            NEXT FIELD xmjb017                     #返回原欄位
    

]]>
</point>
  <point name="construct.c.page4.xmjb024" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_pmaa001_18()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmjb024  #顯示到畫面上
            NEXT FIELD xmjb024                     #返回原欄位
    

]]>
</point>
  <point name="construct.c.page4.xmjb026" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_oofb019()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmjb026  #顯示到畫面上
            NEXT FIELD xmjb026                     #返回原欄位
    

]]>
</point>
  <point name="construct.c.page4.xmjb027" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_dbad001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmjb027  #顯示到畫面上
            NEXT FIELD xmjb027                     #返回原欄位
    

]]>
</point>
  <point name="construct.c.page4.xmjb028" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_stce001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmjb028  #顯示到畫面上
            NEXT FIELD xmjb028                     #返回原欄位
    

]]>
</point>
  <point name="construct.c.page4.xmjb033" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_pmao004_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmjb033  #顯示到畫面上
            NEXT FIELD xmjb033                     #返回原欄位
    

]]>
</point>
  <point name="construct.c.page4.xmjb902" cite_std="N" status="" ver="2" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.arg1 = '267'
            CALL q_oocq002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmjb902  #顯示到畫面上
            NEXT FIELD xmjb902                     #返回原欄位
    

]]>
</point>
  <point name="construct.c.page4.xmjbsite" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.arg1 = g_site
			   LET g_qryparam.arg2 = '2'
            CALL q_ooed004_3()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmjbsite  #顯示到畫面上
            NEXT FIELD xmjbsite                     #返回原欄位
    

]]>
</point>
  <point name="construct.c.page5.xmef002" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooib002_2()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmef002  #顯示到畫面上

            NEXT FIELD xmef002                     #返回原欄位

]]>
</point>
  <point name="construct.c.page5.xmef902" cite_std="N" status="" ver="2" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.arg1 = '267'
            CALL q_oocq002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmef902  #顯示到畫面上
            NEXT FIELD xmef902                     #返回原欄位
    

]]>
</point>
  <point name="construct.c.page6.xrcd002" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_oodb002_2()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xrcd002  #顯示到畫面上
            NEXT FIELD xrcd002                     #返回原欄位
    

]]>
</point>
  <point name="construct.c.page7.rtie002" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_ooia001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO rtie002  #顯示到畫面上
            NEXT FIELD rtie002                     #返回原欄位
    

]]>
</point>
  <point name="construct.c.page8.xmeg001" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_imaa001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmeg001  #顯示到畫面上
            NEXT FIELD xmeg001                     #返回原欄位
    

]]>
</point>
  <point name="construct.c.page8.xmeg004" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_oocq002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmeg004  #顯示到畫面上
            NEXT FIELD xmeg004                     #返回原欄位
    

]]>
</point>
  <point name="construct.c.page8.xmeg006" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_ooca001_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmeg006  #顯示到畫面上
            NEXT FIELD xmeg006                     #返回原欄位
    

]]>
</point>
  <point name="construct.c.page8.xmeg008" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_ooca001_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmeg008  #顯示到畫面上
            NEXT FIELD xmeg008                     #返回原欄位
    

]]>
</point>
  <point name="construct.c.page8.xmeg010" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_ooca001_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmeg010  #顯示到畫面上
            NEXT FIELD xmeg010                     #返回原欄位
    

]]>
</point>
  <point name="construct.c.page8.xmeg016" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_oodb002_2()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmeg016  #顯示到畫面上
            NEXT FIELD xmeg016                     #返回原欄位
    

]]>
</point>
  <point name="construct.c.page8.xmeg023" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_pmac002_4()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmeg023  #顯示到畫面上
            NEXT FIELD xmeg023                     #返回原欄位
    

]]>
</point>
  <point name="construct.c.page8.xmeg027" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_pmao004_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmeg027  #顯示到畫面上
            NEXT FIELD xmeg027                     #返回原欄位
    

]]>
</point>
  <point name="construct.c.page8.xmeg049" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_oocq002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmeg049  #顯示到畫面上
            NEXT FIELD xmeg049                     #返回原欄位
    

]]>
</point>
  <point name="construct.c.page8.xmeg053" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_oocq002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmeg053  #顯示到畫面上
            NEXT FIELD xmeg053                     #返回原欄位
    

]]>
</point>
  <point name="construct.c.page8.xmegorga" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_ooef001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmegorga  #顯示到畫面上
            NEXT FIELD xmegorga                     #返回原欄位
    

]]>
</point>
  <point name="construct.c.page8.xmegunit" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_ooef001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmegunit  #顯示到畫面上
            NEXT FIELD xmegunit                     #返回原欄位
    

]]>
</point>
  <point name="construct.c.xmee001" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.c.xmee002" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooag001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmee002  #顯示到畫面上

            NEXT FIELD xmee002                     #返回原欄位

]]>
</point>
  <point name="construct.c.xmee003" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			LET g_qryparam.arg1 = g_xmee_m.xmeedocdt
            CALL q_ooeg001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmee003  #顯示到畫面上

            NEXT FIELD xmee003                     #返回原欄位

]]>
</point>
  <point name="construct.c.xmee004" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE	
		
            CALL q_pmaa001_6()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmee004        #顯示到畫面上

            NEXT FIELD xmee004                           #返回原欄位

]]>
</point>
  <point name="construct.c.xmee005" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.c.xmee006" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.c.xmee007" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.c.xmee008" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_xmda008()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmee008  #顯示到畫面上

            NEXT FIELD xmee008                     #返回原欄位

]]>
</point>
  <point name="construct.c.xmee009" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			LET g_qryparam.arg1 = g_xmee_m.xmee004
            CALL q_ooib002_2()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmee009        #顯示到畫面上
            
            CALL adbt510_xmee009_ref(g_xmee_m.xmee009) RETURNING g_xmee_m.xmee009_desc
            DISPLAY BY NAME g_xmee_m.xmee009_desc
            NEXT FIELD xmee009                            #返回原欄位

]]>
</point>
  <point name="construct.c.xmee010" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
		    LET g_qryparam.arg1 = '238'
            CALL q_oocq002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmee010  #顯示到畫面上

            NEXT FIELD xmee010                     #返回原欄位

]]>
</point>
  <point name="construct.c.xmee011" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_oodb002_2()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmee011  #顯示到畫面上

            NEXT FIELD xmee011                     #返回原欄位

]]>
</point>
  <point name="construct.c.xmee012" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.c.xmee013" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.c.xmee015" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			LET g_qryparam.arg1 = g_site
            CALL q_ooaj002_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmee015  #顯示到畫面上

            NEXT FIELD xmee015                     #返回原欄位

]]>
</point>
  <point name="construct.c.xmee016" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.c.xmee017" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_xmah001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmee017  #顯示到畫面上

            NEXT FIELD xmee017                     #返回原欄位

]]>
</point>
  <point name="construct.c.xmee018" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooid001_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmee018  #顯示到畫面上

            NEXT FIELD xmee018                     #返回原欄位

]]>
</point>
  <point name="construct.c.xmee019" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.c.xmee020" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			LET g_qryparam.arg1 = "263"
            CALL q_oocq002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmee020  #顯示到畫面上

            NEXT FIELD xmee020                     #返回原欄位

]]>
</point>
  <point name="construct.c.xmee021" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			   LET g_qryparam.reqry = FALSE
            CALL q_pmac002_5()                       #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmee021    #顯示到畫面上
            

            NEXT FIELD xmee021                     #返回原欄位

]]>
</point>
  <point name="construct.c.xmee022" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_pmac002_6()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmee022  #顯示到畫面上
               

            NEXT FIELD xmee022                     #返回原欄位

]]>
</point>
  <point name="construct.c.xmee023" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			   INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			   LET g_qryparam.reqry = FALSE
		      LET g_qryparam.arg1 = "1"
            CALL q_oojd001_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmee023  #顯示到畫面上

            NEXT FIELD xmee023                     #返回原欄位

]]>
</point>
  <point name="construct.c.xmee024" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			LET g_qryparam.arg1 = "295"
            CALL q_oocq002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmee024  #顯示到畫面上

            NEXT FIELD xmee024                     #返回原欄位

]]>
</point>
  <point name="construct.c.xmee025" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			LET g_qryparam.where = " oofb008 = '3' " 
			LET g_qryparam.arg1 = g_oofa001
            CALL q_oofb019_1()                           #呼叫開窗
            
            DISPLAY g_qryparam.return1 TO xmee025  #顯示到畫面上

            NEXT FIELD xmee025                     #返回原欄位

]]>
</point>
  <point name="construct.c.xmee026" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			LET g_qryparam.where = " oofb008 = '5' "
			LET g_qryparam.arg1 = g_oofa001
            CALL q_oofb019_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmee026  #顯示到畫面上

            NEXT FIELD xmee026                     #返回原欄位

]]>
</point>
  <point name="construct.c.xmee027" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			   #INITIALIZE g_qryparam.* TO NULL
            #LET g_qryparam.state = 'c'
			   #LET g_qryparam.reqry = FALSE
			   #LET g_qryparam.arg1 = g_xmee_m.xmee004
            #CALL q_pmaj002()                           #呼叫開窗
            #DISPLAY g_qryparam.return1 TO xmee027  #顯示到畫面上
            #CALL adbt510_xmee027_ref(g_xmee_m.xmee027) RETURNING g_xmee_m.xmee027_desc
            #DISPLAY BY NAME g_xmee_m.xmee027_desc
            #NEXT FIELD xmee027                     #返回原欄位

]]>
</point>
  <point name="construct.c.xmee028" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.c.xmee030" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.c.xmee031" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_xmda031()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmee031  #顯示到畫面上

            NEXT FIELD xmee031	                     #返回原欄位                                                                        ]]>
</point>
  <point name="construct.c.xmee032" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
		    LET g_qryparam.arg1 = "297"
            CALL q_oocq002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmee032  #顯示到畫面上

            NEXT FIELD xmee032                     #返回原欄位

]]>
</point>
  <point name="construct.c.xmee033" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.c.xmee034" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_pmaa001_6()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmee034  #顯示到畫面上
               #DISPLAY g_qryparam.return2 TO pmaal004 #交易對象簡稱 

            NEXT FIELD xmee034                     #返回原欄位

]]>
</point>
  <point name="construct.c.xmee035" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			   LET g_qryparam.reqry = FALSE
		      #LET g_qryparam.arg1 = g_ooef019 
            #LET g_qryparam.arg2 = "2"                
            CALL q_isac002_3()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmee035       #顯示到畫面上
            NEXT FIELD xmee035                     #返回原欄位
]]>
</point>
  <point name="construct.c.xmee036" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_pmaa001_3()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmee036  #顯示到畫面上

            NEXT FIELD xmee036                     #返回原欄位

]]>
</point>
  <point name="construct.c.xmee037" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_xmda037()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmee037  #顯示到畫面上

            NEXT FIELD xmee037                     #返回原欄位

]]>
</point>
  <point name="construct.c.xmee038" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_xmda038()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmee038  #顯示到畫面上

            NEXT FIELD xmee038                     #返回原欄位

]]>
</point>
  <point name="construct.c.xmee039" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.c.xmee043" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.c.xmee044" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			LET g_qryparam.arg1 = g_xmee_m.xmee004
            CALL q_itcf002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmee044  #顯示到畫面上

            NEXT FIELD xmee044                     #返回原欄位

]]>
</point>
  <point name="construct.c.xmee200" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_pmaa001_20()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmee200  #顯示到畫面上
            NEXT FIELD xmee200                     #返回原欄位
    

]]>
</point>
  <point name="construct.c.xmee201" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_pmaa001_10()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmee201  #顯示到畫面上
            NEXT FIELD xmee201                     #返回原欄位
    

]]>
</point>
  <point name="construct.c.xmee202" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.arg1 = "G"
            CALL q_ooef001_3()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmee202  #顯示到畫面上
            NEXT FIELD xmee202                     #返回原欄位
    

]]>
</point>
  <point name="construct.c.xmee203" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.arg1 = g_xmee_m.xmee004
            LET g_qryparam.arg2 = '3'
            CALL q_pmac002_9()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmee203  #顯示到畫面上
            NEXT FIELD xmee203                     #返回原欄位
    

]]>
</point>
  <point name="construct.c.xmee204" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_prcf001_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmee204  #顯示到畫面上
            NEXT FIELD xmee204                     #返回原欄位
    

]]>
</point>
  <point name="construct.c.xmee206" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_dbad001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmee206  #顯示到畫面上
            NEXT FIELD xmee206                     #返回原欄位
    

]]>
</point>
  <point name="construct.c.xmee207" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_dbab001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmee207  #顯示到畫面上
            NEXT FIELD xmee207                     #返回原欄位
    

]]>
</point>
  <point name="construct.c.xmee903" cite_std="N" status="" ver="2" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.arg1 = "267"
            CALL q_oocq002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmee903  #顯示到畫面上
            NEXT FIELD xmee903                     #返回原欄位
    

]]>
</point>
  <point name="construct.c.xmeecnfid" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooag001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmeecnfid  #顯示到畫面上

            NEXT FIELD xmeecnfid                     #返回原欄位

]]>
</point>
  <point name="construct.c.xmeecrtdp" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooea001_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmeecrtdp  #顯示到畫面上

            NEXT FIELD xmeecrtdp                     #返回原欄位

]]>
</point>
  <point name="construct.c.xmeecrtid" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooag001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmeecrtid  #顯示到畫面上

            NEXT FIELD xmeecrtid                     #返回原欄位

]]>
</point>
  <point name="construct.c.xmeedocdt" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.c.xmeedocno" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_xmdadocno_5()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmeedocno  #顯示到畫面上

            NEXT FIELD xmeedocno                     #返回原欄位

]]>
</point>
  <point name="construct.c.xmeemodid" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooag001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmeemodid  #顯示到畫面上

            NEXT FIELD xmeemodid                     #返回原欄位

]]>
</point>
  <point name="construct.c.xmeeowndp" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooea001_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmeeowndp  #顯示到畫面上

            NEXT FIELD xmeeowndp                     #返回原欄位

]]>
</point>
  <point name="construct.c.xmeeownid" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooag001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmeeownid  #顯示到畫面上

            NEXT FIELD xmeeownid                     #返回原欄位

]]>
</point>
  <point name="construct.c.xmeesite" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #開窗c段
			   INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			   LET g_qryparam.reqry = FALSE
			   LET g_qryparam.arg1 = g_site
			   LET g_qryparam.arg2 = '2'
            CALL q_ooed004_3()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmeesite  #顯示到畫面上
            
            NEXT FIELD xmeesite                     #返回原欄位                                                     ]]>
</point>
  <point name="construct.c.xmeestus" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="construct.c.xmeeunit" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.arg1 = '2'
            CALL q_ooed004_2()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmeeunit  #顯示到畫面上
            NEXT FIELD xmeeunit                     #返回原欄位
    

]]>
</point>
  <point name="cs.add_cs" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                    ]]>
</point>
  <point name="cs.after_construct" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                  ]]>
</point>
  <point name="cs.b_dialog" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[         LET g_xmeg_d[1].xmegseq = ""
         DISPLAY ARRAY g_xmeg_d TO s_detail1.*
            BEFORE DISPLAY
               EXIT DISPLAY
         END DISPLAY  
         LET g_xmeg3_d[1].xmehseq = ""
         DISPLAY ARRAY g_xmeg3_d TO s_detail3.*
            BEFORE DISPLAY
               EXIT DISPLAY
         END DISPLAY  
         LET g_xmeg4_d[1].xmjbseq = ""
         DISPLAY ARRAY g_xmeg4_d TO s_detail4.*
            BEFORE DISPLAY
               EXIT DISPLAY
         END DISPLAY          ]]>
</point>
  <point name="cs.before_construct" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                  ]]>
</point>
  <point name="cs.body.before_construct" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="cs.body2.before_construct" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="cs.body3.before_construct" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="cs.define" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[   DEFINE l_sql       STRING
   DEFINE l_success   LIKE type_t.num5  
   DEFINE l_pmaa027   LIKE pmaa_t.pmaa027   ]]>
</point>
  <point name="cs.head.before_construct" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="default_search.after" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                  ]]>
</point>
  <point name="default_search.before" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                  ]]>
</point>
  <point name="default_search.define" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                  ]]>
</point>
  <point name="delete.body.a_delete" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                    ]]>
</point>
  <point name="delete.body.a_delete2" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                    ]]>
</point>
  <point name="delete.body.a_delete3" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[]]>
</point>
  <point name="delete.body.a_delete4" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[      #刪除訂單多交期匯總檔
       DELETE FROM xmej_t 
        WHERE xmejent = g_enterprise 
          AND xmejdocno = g_xmee_m.xmeedocno
          AND xmej900 = g_xmee_m.xmee900          
       IF SQLCA.sqlcode THEN
          CALL cl_err("xmej_t",SQLCA.sqlcode,0)
          CALL s_transaction_end('N','0')
         RETURN
       END IF
       #刪除變更歷程檔
       DELETE FROM xmek_t
        WHERE xmekent = g_enterprise
          AND xmekdocno = g_xmee_m.xmeedocno
          AND xmek001 = g_xmee_m.xmee900 
       IF SQLCA.sqlcode THEN
          CALL cl_err("xmek_t",SQLCA.sqlcode,1)
          CALL s_transaction_end('N','0')
       END IF ]]>
</point>
  <point name="delete.body.b_delete" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                    ]]>
</point>
  <point name="delete.body.b_delete2" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                    ]]>
</point>
  <point name="delete.body.b_delete3" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                    ]]>
</point>
  <point name="delete.body.m_delete" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                    ]]>
</point>
  <point name="delete.body.m_delete2" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                    ]]>
</point>
  <point name="delete.body.m_delete3" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                    ]]>
</point>
  <point name="delete.define" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[   DEFINE  l_cnt   LIKE type_t.num5]]>
</point>
  <point name="delete.head.a_delete" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[]]>
</point>
  <point name="delete.head.b_delete" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                    ]]>
</point>
  <point name="delete.head.m_delete" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                          ]]>
</point>
  <point name="delete_b.a_delete" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                    ]]>
</point>
  <point name="delete_b.a_delete2" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                    ]]>
</point>
  <point name="delete_b.a_delete3" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                    ]]>
</point>
  <point name="delete_b.b_delete" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                    ]]>
</point>
  <point name="delete_b.b_delete2" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                    ]]>
</point>
  <point name="delete_b.b_delete3" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                    ]]>
</point>
  <point name="delete_b.define" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                  ]]>
</point>
  <point name="delete_b.m_delete" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                    ]]>
</point>
  <point name="delete_b.m_delete2" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                    ]]>
</point>
  <point name="delete_b.m_delete3" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                    ]]>
</point>
  <point name="delete_b.other" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                  ]]>
</point>
  <point name="detail_reproduce.body.table1.a_insert" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                  ]]>
</point>
  <point name="detail_reproduce.body.table1.b_insert" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                  ]]>
</point>
  <point name="detail_reproduce.body.table1.m_insert" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                  ]]>
</point>
  <point name="detail_reproduce.body.table2.a_insert" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                  ]]>
</point>
  <point name="detail_reproduce.body.table2.b_insert" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                  ]]>
</point>
  <point name="detail_reproduce.body.table2.m_insert" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                  ]]>
</point>
  <point name="detail_reproduce.body.table3.a_insert" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                  ]]>
</point>
  <point name="detail_reproduce.body.table3.b_insert" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                  ]]>
</point>
  <point name="detail_reproduce.body.table3.m_insert" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                  ]]>
</point>
  <point name="detail_reproduce.define" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                  ]]>
</point>
  <point name="detail_show.after" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                  ]]>
</point>
  <point name="detail_show.before" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                  ]]>
</point>
  <point name="detail_show.define" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                  ]]>
</point>
  <point name="fetch.action_control" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[   CALL cl_set_act_visible("modify,delete,modify_detail,open_xmef_w,open_adbt510_03,open_adbt510_04", TRUE)
   #IF g_xmee_m.xmeestus <> 'N' THEN
   IF g_xmee_m.xmeestus NOT MATCHES "[NDR]" THEN   # N未確認/D抽單/R已拒絕允許修改
      CALL cl_set_act_visible("modify,delete,modify_detail,open_adbt510_03,open_adbt510_04,open_xmef_w", FALSE)
   END IF
  ]]>
</point>
  <point name="fetch.after" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[   #判斷當下的營運據點是否在控制組限制的營運據點範圍內，若不在限制內則不允許新增
   CALL cl_set_act_visible("modify,delete,insert,open_xmef_w", TRUE)

   CALL s_control_chk_group('5','3',g_user,g_dept,g_site,'','','','') RETURNING l_success,l_flag
   IF l_success THEN                            #處理狀態為FALSE，則隱藏新增按鈕
      IF NOT l_flag THEN                        #不在控制組範圍內
         CALL cl_set_act_visible("insert", FALSE)
      END IF
   ELSE
      CALL cl_set_act_visible("insert", FALSE)
   END IF

   #IF g_xmee_m.xmeestus != 'N' THEN
   IF g_xmee_m.xmeestus NOT MATCHES "[NDR]" THEN   # N未確認/D抽單/R已拒絕允許修改
      CALL cl_set_act_visible("modify,delete,open_xmef_w", FALSE)
   END IF                         ]]>
</point>
  <point name="fetch.define" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[   DEFINE l_pmaa004  LIKE pmaa_t.pmaa004 
   DEFINE l_success  LIKE type_t.num5
   DEFINE l_flag     LIKE type_t.num5  ]]>
</point>
  <point name="fill_chk.define" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                  ]]>
</point>
  <point name="fill_chk.other_chk" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                    ]]>
</point>
  <point name="filter.add_cs" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                    ]]>
</point>
  <point name="filter.b_dialog" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                      ]]>
</point>
  <point name="filter.define" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                  ]]>
</point>
  <point name="filter_parser.define" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                  ]]>
</point>
  <point name="global.inc" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[GLOBALS
DEFINE g_xmek007       LIKE xmek_t.xmek007
END GLOBALS]]>
</point>
  <point name="global.variable" cite_std="N" status="" ver="3" src="s" new="N" mark_hard="N">
<![CDATA[DEFINE g_flag         LIKE type_t.num5
DEFINE g_flag1        LIKE type_t.num5
DEFINE g_flag2        LIKE type_t.num5
DEFINE g_oofa001      LIKE oofa_t.oofa001
DEFINE g_ooef019      LIKE ooef_t.ooef019
DEFINE g_acc          LIKE gzcb_t.gzcb007
DEFINE g_tax_app      LIKE oodb_t.oodb011      #取得稅別類型1:正常稅率2:依料件設定
DEFINE g_oodbl004     LIKE oodbl_t.oodbl004    #課稅原则
DEFINE g_oodb005      LIKE oodb_t.oodb005      #單價是否含稅
DEFINE g_oodb006      LIKE oodb_t.oodb006      #稅率

 TYPE type_g_xmeg7_d RECORD
       rtieseq LIKE rtie_t.rtieseq, 
   imay0032 LIKE type_t.chr80, 
   imaa0012 LIKE type_t.chr80, 
   imaa0012_desc LIKE type_t.chr500, 
   imaa0012_desc_desc LIKE type_t.chr500, 
   rtieseq1 LIKE rtie_t.rtieseq1, 
   rtie001 LIKE rtie_t.rtie001, 
   rtie002 LIKE rtie_t.rtie002, 
   rtie002_desc LIKE type_t.chr500, 
   rtie006 LIKE rtie_t.rtie006
      END RECORD 
DEFINE g_xmeg7_d   DYNAMIC ARRAY OF type_g_xmeg7_d
DEFINE g_xmeg7_d_t type_g_xmeg7_d
DEFINE g_xmeg_d_color   DYNAMIC ARRAY OF RECORD 
       xmegsite          STRING,
       xmegseq           STRING,
       xmeg027           STRING,
       xmeg001           STRING,
       xmeg001_desc      STRING,
       imaal004          STRING,
       xmeg002           STRING,
       xmeg004           STRING,
       xmeg004_desc      STRING,
       xmeg005           STRING,
       xmeg006           STRING,
       xmeg006_desc      STRING,
       xmeg007           STRING,
       xmeg008           STRING,
       xmeg008_desc      STRING,
       xmeg009           STRING,
       xmeg024           STRING,
       xmeg012           STRING,
       xmeg013           STRING,
       xmeg045           STRING,
       xmeg010           STRING,
       xmeg010_desc      STRING,
       xmeg011           STRING,
       xmeg015           STRING,
       xmeg016           STRING,
       xmeg016_desc      STRING,
       xmeg017           STRING,
       xmeg046           STRING,
       xmeg047           STRING,
       xmeg048           STRING,
       xmeg023           STRING,
       xmeg019           STRING,
       xmeg020           STRING,
       xmeg021           STRING,
       xmeg022           STRING,
       xmeg051           STRING,
       xmegunit          STRING,
       xmegunit_desc     STRING,
       xmegorga          STRING,
       xmegorga_desc     STRING,
       xmeg052           STRING,
       xmeg049           STRING,
       xmeg049_desc      STRING,
       xmeg053           STRING,
       xmeg053_desc      STRING,
       xmeg050           STRING,
       xmeg901           STRING,
       xmeg902           STRING,
       xmeg902_desc      STRING,
       xmeg903           STRING
       END RECORD

DEFINE g_xmeg3_d_color   DYNAMIC ARRAY OF RECORD 
       xmehdocno         STRING,
       xmehseq           STRING,
       xmehseq1          STRING,
       xmeh229           STRING,
       xmeh003           STRING,
       xmeh001           STRING,
       xmeh001_desc      STRING,
       xmeh001_desc_desc STRING,
       xmeh002           STRING,
       xmeh200           STRING,
       xmeh200_desc      STRING,
       xmeh004           STRING,
       xmeh004_desc      STRING,
       xmeh005           STRING,
       xmeh011           STRING,
       xmeh012           STRING,
       xmeg012           STRING,
       xmeg013           STRING,
       xmehseq2          STRING,
       xmeh006           STRING,
       xmeh201           STRING,
       xmeh201_desc      STRING,
       xmeh202           STRING,
       xmeh024           STRING,
       xmeh024_desc      STRING,
       xmeh025           STRING,
       xmeh026           STRING,
       xmeh026_desc      STRING,
       xmeh027           STRING,
       xmeh203           STRING,
       xmeh204           STRING,
       xmeh205           STRING,
       xmeh206           STRING,
       xmeh029           STRING,
       xmeh028           STRING,
       xmeh019           STRING,
       xmeh019_desc      STRING,
       xmeh030           STRING,
       xmeh207           STRING,
       xmeh207_desc      STRING,
       xmehunit          STRING,
       xmehunit_desc     STRING,
       xmeh210           STRING,
       xmeh210_desc      STRING,
       xmeh212           STRING,
       xmeh213           STRING,
       xmeh213_desc      STRING,
       xmeh214           STRING,
       xmeh214_desc      STRING,
       xmeh215           STRING,
       xmeh031           STRING,
       xmeh014           STRING,
       xmeh015           STRING,
       xmeh016           STRING,
       xmeh017           STRING,
       xmeh221           STRING,
       xmehsite          STRING,
       xmehsite_desc     STRING,
       xmeh218           STRING,
       xmeh218_desc      STRING,
       xmeh219           STRING,
       xmeh219_desc      STRING,
       xmeh220           STRING,
       xmeh220_desc      STRING,
       xmeh222           STRING,
       xmeh222_desc      STRING,
       xmeh223           STRING,
       xmeh223_desc      STRING,
       xmeh224           STRING,
       xmeh224_desc      STRING,
       xmehorga          STRING,
       xmehorga_desc     STRING,
       xmeh226           STRING,
       xmeh227           STRING,
       xmeh227_desc      STRING,
       xmeh228           STRING,
       xmeh228_desc      STRING,
       xmeh901           STRING
       END RECORD

DEFINE g_xmeg4_d_color   DYNAMIC ARRAY OF RECORD         
       xmjbunit          STRING, 
       xmjbseq           STRING, 
       xmjbsite          STRING, 
       xmjbsite_desc     STRING,
       xmjb001           STRING, 
       xmjb002           STRING, 
       xmjb003           STRING, 
       xmjb003_desc      STRING,
       xmjb003_desc_desc STRING,
       xmjb033           STRING, 
       xmjb004           STRING, 
       xmjb005           STRING, 
       xmjb005_desc      STRING,
       xmjb006           STRING, 
       xmjb006_desc      STRING,
       xmjb007           STRING, 
       xmjb011           STRING, 
       xmjb011_desc      STRING,
       xmjb012           STRING, 
       xmjb013           STRING, 
       xmjb013_desc      STRING,
       xmjb014           STRING, 
       xmjb015           STRING, 
       xmjb015_desc      STRING,
       xmjb016           STRING, 
       xmjb017           STRING, 
       xmjb017_desc      STRING,
       xmjb018           STRING, 
       xmjb008           STRING, 
       xmjb009           STRING, 
       xmjb010           STRING, 
       xmjb022           STRING, 
       xmjb019           STRING, 
       xmjb020           STRING, 
       xmjb021           STRING, 
       xmjb024           STRING, 
       xmjb024_desc      STRING,
       xmjb025           STRING, 
       xmjb026           STRING, 
       xmjb026_desc      STRING,
       xmjb027           STRING, 
       xmjb027_desc      STRING,
       xmjb028           STRING, 
       xmjb029           STRING, 
       xmjb030           STRING, 
       xmjb031           STRING, 
       xmjb032           STRING, 
       xmjb034           STRING, 
       xmjb901           STRING,
       xmjb902           STRING, 
       xmjb902_desc      STRING,
       xmjb903           STRING
       END RECORD

DEFINE g_xmeg5_d_color   DYNAMIC ARRAY OF RECORD
       xmefsite          STRING,                   
       xmef001           STRING,                  
       xmef002           STRING,                  
       xmef002_desc      STRING,                  
       xmef003           STRING,                  
       xmef004           STRING,                  
       xmef005           STRING,                  
       xmef006           STRING,                  
       xmef007           STRING,                  
       xmef008           STRING,                  
       xmef009           STRING,                  
       xmef901           STRING,                  
       xmef902           STRING,                  
       xmef902_desc      STRING,                  
       xmef903           STRING                  
       END RECORD  
DEFINE g_upd_unit        LIKE type_t.chr1]]>
</point>
  <point name="idx_chk.define" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                  ]]>
</point>
  <point name="idx_chk.other" cite_std="N" status="" ver="3" src="s" new="N" mark_hard="N">
<![CDATA[   IF g_current_page = 6 THEN
      LET g_detail_idx = g_curr_diag.getCurrentRow("s_detail7")
      IF g_detail_idx > g_xmeg7_d.getLength() THEN
         LET g_detail_idx = g_xmeg7_d.getLength()
      END IF
      IF g_detail_idx = 0 AND g_xmeg7_d.getLength() <> 0 THEN
         LET g_detail_idx = 1
      END IF
      DISPLAY g_detail_idx TO FORMONLY.idx
      DISPLAY g_xmeg7_d.getLength() TO FORMONLY.cnt
   END IF            ]]>
</point>
  <point name="init.define" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                  ]]>
</point>
  <point name="init.init" cite_std="N" status="" ver="3" src="s" new="N" mark_hard="N">
<![CDATA[   CALL cl_set_combo_scc('xmeg035','2039') 
   CALL cl_set_combo_scc('xmeg040','2067') 
   CALL cl_set_combo_scc_part('xmeg019','2055','1,2,3')
   CALL cl_set_combo_scc('xmeh003','2055')  
   CALL cl_set_combo_scc('xmeh017','2058')
   CALL cl_set_combo_scc_part('xmee005','2063','1,2,3,6')  
   CALL cl_set_combo_scc_part('xmee007','2065','1,5')  
   CALL cl_set_combo_scc('xmjb001','6064')   
   CALL cl_set_combo_scc('xmeh226','6013') 
   CALL cl_set_combo_scc('xmeh229','6064')
   CALL cl_set_combo_scc('rtie001','8310')
   
   LET g_errshow = '1']]>
</point>
  <point name="input.a.page1.imaal004" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.a.page1.xmeg001" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            CALL adbt510_xmeg001_ref(g_xmeg_d[l_ac].xmeg001) 
              RETURNING g_xmeg_d[l_ac].xmeg001_desc,g_xmeg_d[l_ac].imaal004
            DISPLAY BY NAME g_xmeg_d[l_ac].xmeg001_desc,g_xmeg_d[l_ac].imaal004
            IF NOT cl_null(g_xmeg_d[l_ac].xmeg001) THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmeg_d[l_ac].xmeg001 != g_xmeg_d_o.xmeg001)) THEN 
                  IF NOT adbt510_xmeg001_chk(g_xmeg_d[l_ac].xmeg001) THEN
                     LET g_xmeg_d[l_ac].xmeg001 = g_xmeg_d_o.xmeg001
                     CALL adbt510_xmeg001_ref(g_xmeg_d[l_ac].xmeg001) RETURNING g_xmeg_d[l_ac].xmeg001_desc,g_xmeg_d[l_ac].imaal004
                     DISPLAY BY NAME g_xmeg_d[l_ac].xmeg001_desc,g_xmeg_d[l_ac].imaal004
                     NEXT FIELD CURRENT
                  END IF
                  CALL adbt510_xmeg001_desc()
                  
                  #修改料號時需要開窗詢問是否重新取價，若選擇要時則需呼叫取價應用元件重新取價，
                  #並重新呼叫'計算金額'應用元件計算[C:含稅金額]、[C:未稅金額]、[C:稅額]
               END IF
               LET g_xmeg_d_o.xmeg001 = g_xmeg_d[l_ac].xmeg001
            END IF 
           
            CALL adbt510_set_entry_b(l_cmd)
            CALL adbt510_set_no_entry_b(l_cmd)
            
            LET g_xmeg2_d[l_ac].imaa001 = g_xmeg_d[l_ac].xmeg001
            LET g_xmeg2_d[l_ac].imaal003 = g_xmeg_d[l_ac].xmeg001_desc
            LET g_xmeg2_d[l_ac].imaal004 = g_xmeg_d[l_ac].imaal004]]>
</point>
  <point name="input.a.page1.xmeg002" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #依交易對象、料號、產品特徵回傳客戶料號
            IF NOT cl_null(g_xmeg_d[l_ac].xmeg001) AND cl_null(g_xmeg_d[l_ac].xmeg002) THEN
               CALL s_apmi070_get_pmao004(g_xmee_m.xmee004,g_xmeg_d[l_ac].xmeg001,g_xmeg_d[l_ac].xmeg002)
                 RETURNING r_success,l_pmao004
               IF r_success THEN
                  LET g_xmeg_d[l_ac].xmeg027 = l_pmao004
                  DISPLAY BY NAME g_xmeg_d[l_ac].xmeg027
               END IF
            END IF                                                                       ]]>
</point>
  <point name="input.a.page1.xmeg004" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                               CALL adbt510_xmeg004_ref(g_xmeg_d[l_ac].xmeg004) RETURNING g_xmeg_d[l_ac].xmeg004_desc
               DISPLAY BY NAME g_xmeg_d[l_ac].xmeg004_desc 
               IF NOT cl_null(g_xmeg_d[l_ac].xmeg004) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmeg_d[l_ac].xmeg004

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_oocq002_221") THEN
                  #檢查成功時後續處理
               ELSE
                  #檢查失敗時後續處理
                  LET g_xmeg_d[l_ac].xmeg004 = g_xmeg_d_t.xmeg004
                  CALL adbt510_xmeg004_ref(g_xmeg_d[l_ac].xmeg004) RETURNING g_xmeg_d[l_ac].xmeg004_desc
                  DISPLAY BY NAME g_xmeg_d[l_ac].xmeg004_desc
                  NEXT FIELD CURRENT
               END IF
            END IF 
]]>
</point>
  <point name="input.a.page1.xmeg005" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.a.page1.xmeg006" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                            CALL adbt510_unit_ref(g_xmeg_d[l_ac].xmeg006) RETURNING g_xmeg_d[l_ac].xmeg006_desc
            DISPLAY BY NAME g_xmeg_d[l_ac].xmeg006_desc
            IF NOT cl_null(g_xmeg_d[l_ac].xmeg006) THEN 
               IF NOT adbt510_unit_chk(g_xmeg_d[l_ac].xmeg006) THEN
                  LET g_xmeg_d[l_ac].xmeg006 = g_xmeg_d_t.xmeg006
                  CALL adbt510_unit_ref(g_xmeg_d[l_ac].xmeg006) RETURNING g_xmeg_d[l_ac].xmeg006_desc
                  DISPLAY BY NAME g_xmeg_d[l_ac].xmeg006_desc
                  NEXT FIELD CURRENT
               END IF
               
               IF NOT cl_null(g_xmeg_d[l_ac].xmeg007)  THEN
                  CALL adbt510_unit_round(g_xmeg_d[l_ac].xmeg006,g_xmeg_d[l_ac].xmeg007) RETURNING g_xmeg_d[l_ac].xmeg007
                  DISPLAY BY NAME g_xmeg_d[l_ac].xmeg007   
                 #若料號有使用銷售計價單位時，則輸入[C:訂單數量]時則應自動推算計價數量
                 #[C:計價數量]=[C:訂購數量量]*[C:訂單單位]與[C:計價單位]換算率
                 IF cl_get_para(g_enterprise,g_site,'S-BAS-0019') = "Y" THEN  #體參數使用採購計價單位aoos020
                    CALL s_aimi190_get_convert(g_xmeg_d[l_ac].xmeg001,g_xmeg_d[l_ac].xmeg006,g_xmeg_d[l_ac].xmeg010) 
                      RETURNING l_success,l_rate
                    LET g_xmeg_d[l_ac].xmeg011 = g_xmeg_d[l_ac].xmeg007 * l_rate
                    IF NOT cl_null(g_xmeg_d[l_ac].xmeg011) THEN
                       CALL adbt510_unit_round(g_xmeg_d[l_ac].xmeg010,g_xmeg_d[l_ac].xmeg011) RETURNING g_xmeg_d[l_ac].xmeg011
                       DISPLAY BY NAME g_xmeg_d[l_ac].xmeg011
                    END IF 
                 END IF

               END IF 
            END IF ]]>
</point>
  <point name="input.a.page1.xmeg007" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                            IF NOT cl_null(g_xmeg_d[l_ac].xmeg007) THEN
               IF NOT cl_null(g_xmeg_d[l_ac].xmeg006) THEN
                  CALL adbt510_unit_round(g_xmeg_d[l_ac].xmeg006,g_xmeg_d[l_ac].xmeg007) RETURNING g_xmeg_d[l_ac].xmeg007
                  DISPLAY BY NAME g_xmeg_d[l_ac].xmeg007

                  #若料號有使用銷售計價單位時，則輸入[C:訂單數量]時則應自動推算計價數量
                  #[C:計價數量]=[C:訂購數量量]*[C:訂單單位]與[C:計價單位]換算率
                  IF cl_get_para(g_enterprise,g_site,'S-BAS-0019') = "Y" THEN  #體參數使用採購計價單位
                     CALL s_aimi190_get_convert(g_xmeg_d[l_ac].xmeg001,g_xmeg_d[l_ac].xmeg006,g_xmeg_d[l_ac].xmeg010) 
                       RETURNING l_success,l_rate
                     LET g_xmeg_d[l_ac].xmeg011 = g_xmeg_d[l_ac].xmeg007 * l_rate
                     IF NOT cl_null(g_xmeg_d[l_ac].xmeg011) THEN
                        CALL adbt510_unit_round(g_xmeg_d[l_ac].xmeg010,g_xmeg_d[l_ac].xmeg011) RETURNING g_xmeg_d[l_ac].xmeg011
                        DISPLAY BY NAME g_xmeg_d[l_ac].xmeg011
                     END IF
                  END IF
                 #若料號有設置使用參考單位時且訂單單位與參考單位有設置換算率時，則應自動推算參考數量
                 #[C:參考數量]=[C:訂單量]*[C:訂單單位]與[C:參考單位]換算率
                 #當修改訂單數量時需呼叫計算金額應用元件重新計算[C:未稅金額]、[C:含稅金額]、[稅額]                  
               END IF
            END IF
]]>
</point>
  <point name="input.a.page1.xmeg008" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                    CALL adbt510_unit_ref(g_xmeg_d[l_ac].xmeg008) RETURNING g_xmeg_d[l_ac].xmeg008_desc
            DISPLAY BY NAME g_xmeg_d[l_ac].xmeg008_desc
            IF NOT cl_null(g_xmeg_d[l_ac].xmeg008) THEN 
               IF NOT adbt510_unit_chk(g_xmeg_d[l_ac].xmeg008) THEN
                  LET g_xmeg_d[l_ac].xmeg008 = g_xmeg_d_t.xmeg008
                  CALL adbt510_unit_ref(g_xmeg_d[l_ac].xmeg008) RETURNING g_xmeg_d[l_ac].xmeg008_desc
                  DISPLAY BY NAME g_xmeg_d[l_ac].xmeg008_desc
                  NEXT FIELD CURRENT
               END IF
               
               IF NOT cl_null(g_xmeg_d[l_ac].xmeg009) THEN
                  CALL adbt510_unit_round(g_xmeg_d[l_ac].xmeg008,g_xmeg_d[l_ac].xmeg009) RETURNING g_xmeg_d[l_ac].xmeg009
                  DISPLAY BY NAME g_xmeg_d[l_ac].xmeg009   
               END IF 
            END IF 
]]>
</point>
  <point name="input.a.page1.xmeg009" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                            IF NOT cl_null(g_xmeg_d[l_ac].xmeg009) THEN
               IF NOT cl_null(g_xmeg_d[l_ac].xmeg008) THEN
                  CALL adbt510_unit_round(g_xmeg_d[l_ac].xmeg008,g_xmeg_d[l_ac].xmeg009) RETURNING g_xmeg_d[l_ac].xmeg009
                  DISPLAY BY NAME g_xmeg_d[l_ac].xmeg009
               END IF
            END IF
             
]]>
</point>
  <point name="input.a.page1.xmeg010" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                CALL adbt510_unit_ref(g_xmeg_d[l_ac].xmeg010) RETURNING g_xmeg_d[l_ac].xmeg010_desc
            DISPLAY BY NAME g_xmeg_d[l_ac].xmeg010_desc
            IF NOT cl_null(g_xmeg_d[l_ac].xmeg010) THEN 
               IF NOT adbt510_unit_chk(g_xmeg_d[l_ac].xmeg010) THEN
                  LET g_xmeg_d[l_ac].xmeg010 = g_xmeg_d_t.xmeg010
                  CALL adbt510_unit_ref(g_xmeg_d[l_ac].xmeg010) RETURNING g_xmeg_d[l_ac].xmeg010_desc
                  DISPLAY BY NAME g_xmeg_d[l_ac].xmeg010_desc
                  NEXT FIELD CURRENT
               END IF
               
               IF NOT cl_null(g_xmeg_d[l_ac].xmeg011) THEN
                  CALL adbt510_unit_round(g_xmeg_d[l_ac].xmeg010,g_xmeg_d[l_ac].xmeg011) RETURNING g_xmeg_d[l_ac].xmeg011
                  DISPLAY BY NAME g_xmeg_d[l_ac].xmeg011   
               END IF 
            END IF ]]>
</point>
  <point name="input.a.page1.xmeg011" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            IF NOT cl_null(g_xmeg_d[l_ac].xmeg011) THEN
               #根據單位對數量進行取位
               IF NOT cl_null(g_xmeg_d[l_ac].xmeg010) THEN
                  CALL adbt510_unit_round(g_xmeg_d[l_ac].xmeg010,g_xmeg_d[l_ac].xmeg011) RETURNING g_xmeg_d[l_ac].xmeg011
                  DISPLAY BY NAME g_xmeg_d[l_ac].xmeg011
               END IF
 
               #若有修改計價數量，則重新計算未稅金額、含稅金額、稅額
               IF g_xmeg_d[l_ac].xmeg011 <> g_xmeg_d_o.xmeg011 THEN
                  IF g_xmeg_d[l_ac].xmeg011 > 0 AND g_xmeg_d[l_ac].xmeg015 > 0 THEN
                     CALL s_axmt500_get_amount(g_xmeg_d[l_ac].xmeg011,g_xmeg_d[l_ac].xmeg015,g_xmeg_d[l_ac].xmeg016,g_xmee_m.xmee015,g_xmee_m.xmee016)
                       RETURNING g_xmeg_d[l_ac].xmeg046,g_xmeg_d[l_ac].xmeg047,g_xmeg_d[l_ac].xmeg048   
                     DISPLAY BY NAME g_xmeg_d[l_ac].xmeg046,g_xmeg_d[l_ac].xmeg047,g_xmeg_d[l_ac].xmeg048
                  END IF
               END IF
            END IF
            LET g_xmeg_d_o.xmeg011 = g_xmeg_d[l_ac].xmeg011]]>
</point>
  <point name="input.a.page1.xmeg012" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                            #根據交貨日期計算緊急度
              CALL adbt510_xmeg012_to_xmeg020()                       ]]>
</point>
  <point name="input.a.page1.xmeg013" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.a.page1.xmeg015" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            LET l_xmah004 = ''
            LET l_xmah005 = ''
            LET l_xmah006 = ''
            IF NOT cl_null(g_xmeg_d[l_ac].xmeg015) THEN
               SELECT xmah004,xmah005,xmah006 INTO l_xmah004,l_xmah005,l_xmah006 FROM xmah_t
                  WHERE xmahent = g_enterprise AND xmah001 = g_pmdl_m.pmdl027
               IF l_xmah006 <> 'Y' AND g_xmeg_d[l_ac].xmeg015 = 0 THEN  #價格不允許為0
                  CALL cl_err(g_xmeg_d[l_ac].xmeg015,'apm-00273',1)
                  LET g_xmeg_d[l_ac].xmeg015 = g_xmeg_d_t.xmeg015
                  NEXT FIELD CURRENT
               END IF
               #若輸入的單價超過單頭取價方式的基本資料設置的容差率時，需判斷單價與取出單價的差異是否在容差率範圍內，若在範圍外則依據取價方式的基本資料設置的處理方式進行管控
               
               #若有修改單價，則重新計算未稅金額、含稅金額、稅額
               IF g_xmeg_d[l_ac].xmeg015 <> g_xmeg_d_o.xmeg015 THEN
                  #按幣種對金額做取位
                  CALL s_curr_round(g_xmee_m.xmeesite,g_xmee_m.xmee015,g_xmeg_d[l_ac].xmeg015,'1')
                       RETURNING g_xmeg_d[l_ac].xmeg015
                  IF g_xmeg_d[l_ac].xmeg011 > 0 AND g_xmeg_d[l_ac].xmeg015 > 0 THEN
                     CALL s_axmt500_get_amount(g_xmeg_d[l_ac].xmeg011,g_xmeg_d[l_ac].xmeg015,g_xmeg_d[l_ac].xmeg016,g_xmee_m.xmee015,g_xmee_m.xmee016)
                       RETURNING g_xmeg_d[l_ac].xmeg046,g_xmeg_d[l_ac].xmeg047,g_xmeg_d[l_ac].xmeg048
                     DISPLAY BY NAME g_xmeg_d[l_ac].xmeg046,g_xmeg_d[l_ac].xmeg047,g_xmeg_d[l_ac].xmeg048
                  END IF   
               END IF
               LET g_xmeg_d_o.xmeg015 = g_xmeg_d[l_ac].xmeg015  
            END IF
           ]]>
</point>
  <point name="input.a.page1.xmeg016" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            CALL adbt510_xmee011_ref(g_xmeg_d[l_ac].xmeg016) RETURNING g_xmeg_d[l_ac].xmeg016_desc
            DISPLAY BY NAME g_xmeg_d[l_ac].xmeg016_desc
            
            IF NOT cl_null(g_xmeg_d[l_ac].xmeg016) THEN 
               IF adbt510_xmee011_chk('2',g_xmeg_d[l_ac].xmeg016) THEN
                  #檢查成功時後續處理
                    #帶出單身稅率
                    LET l_oodb006 = ''
                    CALL s_tax_chk(g_site,g_xmeg_d[l_ac].xmeg016)
                      RETURNING l_success,g_oodbl004,l_oodb005,l_oodb006,l_oodb011     
                    IF l_success THEN
                       LET g_xmeg_d[l_ac].xmeg017 = l_oodb006
                       DISPLAY BY NAME g_xmeg_d[l_ac].xmeg017
                    END IF
               ELSE
                  #檢查失敗時後續處理
                  LET g_xmeg_d[l_ac].xmeg016 = g_xmeg_d_t.xmeg016
                  CALL adbt510_xmee011_ref(g_xmeg_d[l_ac].xmeg016) RETURNING g_xmeg_d[l_ac].xmeg016_desc
                  DISPLAY BY NAME g_xmeg_d[l_ac].xmeg016_desc
                  NEXT FIELD CURRENT
               END IF
               #若有修改稅別，則重新計算未稅金額、含稅金額、稅額
               IF g_xmeg_d[l_ac].xmeg016 <> g_xmeg_d_o.xmeg016 THEN
                  #計算未稅金額、含稅金額、稅額
                  IF g_xmeg_d[l_ac].xmeg011 > 0 AND g_xmeg_d[l_ac].xmeg015 > 0 THEN
                     CALL s_axmt500_get_amount(g_xmeg_d[l_ac].xmeg011,g_xmeg_d[l_ac].xmeg015,g_xmeg_d[l_ac].xmeg016,g_xmee_m.xmee015,g_xmee_m.xmee016)
                       RETURNING g_xmeg_d[l_ac].xmeg046,g_xmeg_d[l_ac].xmeg047,g_xmeg_d[l_ac].xmeg048
                     DISPLAY BY NAME g_xmeg_d[l_ac].xmeg046,g_xmeg_d[l_ac].xmeg047,
                                     g_xmeg_d[l_ac].xmeg048
                  END IF
               END IF                  
               LET g_xmeg_d_o.xmeg016 = g_xmeg_d[l_ac].xmeg016               
            END IF 
             
]]>
</point>
  <point name="input.a.page1.xmeg019" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.a.page1.xmeg020" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.a.page1.xmeg021" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.a.page1.xmeg022" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.a.page1.xmeg023" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[
            
            IF NOT cl_null(g_xmeg_d[l_ac].xmeg023) THEN 

            END IF]]>
</point>
  <point name="input.a.page1.xmeg024" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            IF g_xmeg_d[l_ac].xmeg024 = 'Y' THEN
               CALL axmt500_03(g_xmee_m.xmeedocno,g_xmeg_d[l_ac].xmegseq,g_xmeg_d[l_ac].xmeg007)
               RETURNING g_xmeg_d[l_ac].xmeg012,g_xmeg_d[l_ac].xmeg013
               DISPLAY BY NAME g_xmeg_d[l_ac].xmeg012,g_xmeg_d[l_ac].xmeg013
               CALL adbt510_set_entry_b(l_cmd)
               CALL adbt510_set_no_entry_b(l_cmd)

            END IF
]]>
</point>
  <point name="input.a.page1.xmeg027" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            IF NOT cl_null(g_xmeg_d[l_ac].xmeg027) THEN
               IF cl_null(g_xmeg_d[l_ac].xmeg001) THEN
                  #若料件為空時，呼叫元件帶出料件+產品特徵
                  CALL s_apmi070_get_pmao002_pmao003(g_xmee_m.xmee004,g_xmeg_d[l_ac].xmeg027)
                    RETURNING r_success,l_pmao002,l_pmao003
                             
                  IF NOT r_success THEN              
                     LET g_xmeg_d[l_ac].xmeg027 = g_xmeg_d_o.xmeg027
                     DISPLAY BY NAME g_xmeg_d[l_ac].xmeg027
                     NEXT FIELD CURRENT
                  END IF
                  LET g_xmeg_d[l_ac].xmeg001 = l_pmao002
                  LET g_xmeg_d[l_ac].xmeg002 = l_pmao003
                  DISPLAY BY NAME g_xmeg_d[l_ac].xmeg001,g_xmeg_d[l_ac].xmeg002
                END IF  
                #此段落由子樣板a19產生
                #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
                INITIALIZE g_chkparam.* TO NULL
		       
                #設定g_chkparam.*的參數
                LET g_chkparam.arg1 = g_xmee_m.xmee004
                LET g_chkparam.arg2 = g_xmeg_d[l_ac].xmeg001
                LET g_chkparam.arg3 = g_xmeg_d[l_ac].xmeg002
                LET g_chkparam.arg4 = g_xmeg_d[l_ac].xmeg027
		       
		       
                #呼叫檢查存在並帶值的library
                IF NOT cl_null(g_xmeg_d[l_ac].xmeg001) AND NOT cl_null(g_xmeg_d[l_ac].xmeg002) THEN
                   IF cl_chk_exist("v_pmao004") THEN
                      #檢查成功時後續處理
                      CALL adbt510_xmeg001_ref(g_xmeg_d[l_ac].xmeg001) 
                        RETURNING g_xmeg_d[l_ac].xmeg001_desc,g_xmeg_d[l_ac].imaal004
                      DISPLAY BY NAME g_xmeg_d[l_ac].xmeg001_desc,g_xmeg_d[l_ac].imaal004
                   ELSE
                      #檢查失敗時後續處理
                      LET g_xmeg_d[l_ac].xmeg027 = g_xmeg_d_o.xmeg027
                      DISPLAY BY NAME g_xmeg_d[l_ac].xmeg027
                      NEXT FIELD CURRENT
                   END IF
                ELSE 
                   IF cl_chk_exist("v_pmao004_1") THEN
                      #檢查成功時後續處理
                      CALL adbt510_xmeg001_ref(g_xmeg_d[l_ac].xmeg001) 
                        RETURNING g_xmeg_d[l_ac].xmeg001_desc,g_xmeg_d[l_ac].imaal004
                      DISPLAY BY NAME g_xmeg_d[l_ac].xmeg001_desc,g_xmeg_d[l_ac].imaal004                     
                   ELSE
                      #檢查失敗時後續處理
                      LET g_xmeg_d[l_ac].xmeg027 = g_xmeg_d_o.xmeg027
                      DISPLAY BY NAME g_xmeg_d[l_ac].xmeg027
                      NEXT FIELD CURRENT
                   END IF           
                END IF
                LET g_xmeg_d_o.xmeg027 = g_xmeg_d[l_ac].xmeg027
                LET g_xmeg_d_o.xmeg001 = g_xmeg_d[l_ac].xmeg001
                LET g_xmeg_d_o.xmeg002 = g_xmeg_d[l_ac].xmeg002                
            END IF              ]]>
</point>
  <point name="input.a.page1.xmeg045" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.a.page1.xmeg049" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                    CALL adbt510_xmeg049_ref(g_xmeg_d[l_ac].xmeg049) RETURNING g_xmeg_d[l_ac].xmeg049_desc
            DISPLAY BY NAME g_xmeg_d[l_ac].xmeg049_desc
            
            IF NOT cl_null(g_xmeg_d[l_ac].xmeg049) THEN
               IF NOT adbt510_xmeg049_chk(g_xmeg_d[l_ac].xmeg049) THEN
                  LET g_xmeg_d[l_ac].xmeg049 = g_xmeg_d_t.xmeg049
                  CALL adbt510_xmeg049_ref(g_xmeg_d[l_ac].xmeg049) RETURNING g_xmeg_d[l_ac].xmeg049_desc
                  DISPLAY BY NAME g_xmeg_d[l_ac].xmeg049_desc
                  NEXT FIELD CURRENT
               END IF
            END IF

]]>
</point>
  <point name="input.a.page1.xmeg050" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.a.page1.xmeg052" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.a.page1.xmeg053" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmeg_d[l_ac].xmeg053
            CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='265' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmeg_d[l_ac].xmeg053_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmeg_d[l_ac].xmeg053_desc
]]>
</point>
  <point name="input.a.page1.xmeg900" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a05產生
            IF  g_xmee_m.xmeedocno IS NOT NULL AND g_xmeg_d[g_detail_idx].xmegdocno IS NOT NULL AND g_xmeg_d[g_detail_idx].xmegseq IS NOT NULL AND g_xmeg_d[g_detail_idx].xmeg900 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmee_m.xmeedocno != g_xmeedocno_t OR g_xmeg_d[g_detail_idx].xmegdocno != g_xmeg_d_t.xmegdocno OR g_xmeg_d[g_detail_idx].xmegseq != g_xmeg_d_t.xmegseq OR g_xmeg_d[g_detail_idx].xmeg900 != g_xmeg_d_t.xmeg900)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xmeg_t WHERE "||"xmegent = '" ||g_enterprise|| "' AND "||"xmegdocno = '"||g_xmee_m.xmeedocno ||"' AND "|| "xmegseq = '"||g_xmeg_d[g_detail_idx].xmegdocno ||"' AND "|| "xmeg900 = '"||g_xmeg_d[g_detail_idx].xmegseq ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
</point>
  <point name="input.a.page1.xmeg902" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmeg_d[l_ac].xmeg902
            CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='267' AND oocql002=? AND oocal003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmeg_d[l_ac].xmeg902_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmeg_d[l_ac].xmeg902_desc

]]>
</point>
  <point name="input.a.page1.xmegdocno" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a05產生
            IF  g_xmee_m.xmeedocno IS NOT NULL AND g_xmeg_d[g_detail_idx].xmegdocno IS NOT NULL AND g_xmeg_d[g_detail_idx].xmegseq IS NOT NULL AND g_xmeg_d[g_detail_idx].xmeg900 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmee_m.xmeedocno != g_xmeedocno_t OR g_xmeg_d[g_detail_idx].xmegdocno != g_xmeg_d_t.xmegdocno OR g_xmeg_d[g_detail_idx].xmegseq != g_xmeg_d_t.xmegseq OR g_xmeg_d[g_detail_idx].xmeg900 != g_xmeg_d_t.xmeg900)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xmeg_t WHERE "||"xmegent = '" ||g_enterprise|| "' AND "||"xmegdocno = '"||g_xmee_m.xmeedocno ||"' AND "|| "xmegseq = '"||g_xmeg_d[g_detail_idx].xmegdocno ||"' AND "|| "xmeg900 = '"||g_xmeg_d[g_detail_idx].xmegseq ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
</point>
  <point name="input.a.page1.xmegorga" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                    CALL adbt510_xmee003_ref(g_xmeg_d[l_ac].xmegorga) RETURNING g_xmeg_d[l_ac].xmegorga_desc
            DISPLAY BY NAME g_xmeg_d[l_ac].xmegorga_desc
            IF NOT cl_null(g_xmeg_d[l_ac].xmegorga) THEN 
               IF NOT adbt510_xmegunit_chk(g_xmeg_d[l_ac].xmegorga) THEN
                  LET g_xmeg_d[l_ac].xmegorga = g_xmeg_d_t.xmegorga
                  CALL adbt510_xmee003_ref(g_xmeg_d[l_ac].xmegorga) RETURNING g_xmeg_d[l_ac].xmegorga_desc
                  DISPLAY BY NAME g_xmeg_d[l_ac].xmegorga_desc
                  NEXT FIELD CURRENT
               END IF
            ELSE
               LET g_xmeg_d[l_ac].xmegorga = g_site
               CALL adbt510_xmee003_ref(g_xmeg_d[l_ac].xmegorga) RETURNING g_xmeg_d[l_ac].xmegorga_desc
               DISPLAY BY NAME g_xmeg_d[l_ac].xmegorga_desc
            END IF]]>
</point>
  <point name="input.a.page1.xmegseq" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                    #此段落由子樣板a05產生
            IF  g_xmee_m.xmeedocno IS NOT NULL AND g_xmeg_d[g_detail_idx].xmegseq IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmee_m.xmeedocno != g_xmeedocno_t OR g_xmeg_d[g_detail_idx].xmegseq != g_xmeg_d_t.xmegseq)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xmeg_t WHERE "||"xmegent = '" ||g_enterprise|| "' AND "||"xmegdocno = '"||g_xmee_m.xmeedocno ||"' AND "|| "xmegseq = '"||g_xmeg_d[g_detail_idx].xmegseq ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
</point>
  <point name="input.a.page1.xmegunit" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                    CALL adbt510_xmee003_ref(g_xmeg_d[l_ac].xmegunit) RETURNING g_xmeg_d[l_ac].xmegunit_desc
            DISPLAY BY NAME g_xmeg_d[l_ac].xmegunit_desc
            IF NOT cl_null(g_xmeg_d[l_ac].xmegunit) THEN 
               IF NOT adbt510_xmegunit_chk(g_xmeg_d[l_ac].xmegunit) THEN
                  LET g_xmeg_d[l_ac].xmegunit = g_xmeg_d_t.xmegunit
                  CALL adbt510_xmee003_ref(g_xmeg_d[l_ac].xmegunit) RETURNING g_xmeg_d[l_ac].xmegunit_desc
                  DISPLAY BY NAME g_xmeg_d[l_ac].xmegunit_desc
                  NEXT FIELD CURRENT
               END IF
               
               LET g_xmeg_d[l_ac].xmegorga = g_xmeg_d[l_ac].xmegunit
               CALL adbt510_xmee003_ref(g_xmeg_d[l_ac].xmegorga) RETURNING g_xmeg_d[l_ac].xmegorga_desc
               DISPLAY BY NAME g_xmeg_d[l_ac].xmegorga_desc
           
            ELSE
               LET g_xmeg_d[l_ac].xmegunit = g_site
               CALL adbt510_xmee003_ref(g_xmeg_d[l_ac].xmegunit) RETURNING g_xmeg_d[l_ac].xmegunit_desc
               DISPLAY BY NAME g_xmeg_d[l_ac].xmegunit_desc     
            END IF 
]]>
</point>
  <point name="input.a.page1.xmjb002" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            IF NOT cl_null(g_xmjb_d[l_ac].xmjb002) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist_and_ref_val("v_imay003_1") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 
               ELSE
                  #檢查失敗時後續處理
                  NEXT FIELD CURRENT
               END IF
            

            END IF 

]]>
</point>
  <point name="input.a.page1.xmjb003" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            IF NOT cl_null(g_xmjb_d[l_ac].xmjb003) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg2 = '參數2'
                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist_and_ref_val("v_imaf001_3") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 
               ELSE
                  #檢查失敗時後續處理
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmjb_d[l_ac].xmjb003
            CALL ap_ref_array2(g_ref_fields,"SELECT imaal003 FROM imaal_t WHERE imaalent='"||g_enterprise||"' AND imaal001=? AND imaal002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmjb_d[l_ac].xmjb003_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmjb_d[l_ac].xmjb003_desc

]]>
</point>
  <point name="input.a.page1.xmjb005" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            IF NOT cl_null(g_xmjb_d[l_ac].xmjb005) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist_and_ref_val("v_prcf001") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 
               ELSE
                  #檢查失敗時後續處理
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmjb_d[l_ac].xmjb005
            CALL ap_ref_array2(g_ref_fields,"SELECT prcfl003 FROM prcfl_t WHERE prcflent='"||g_enterprise||"' AND prcfl001=? AND prcfl002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmjb_d[l_ac].xmjb005_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmjb_d[l_ac].xmjb005_desc

]]>
</point>
  <point name="input.a.page1.xmjb006" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            IF NOT cl_null(g_xmjb_d[l_ac].xmjb006) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg2 = '參數2'
                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist_and_ref_val("v_oodb002") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 
               ELSE
                  #檢查失敗時後續處理
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmjb_d[l_ac].xmjb006
            CALL ap_ref_array2(g_ref_fields,"SELECT oodbl004 FROM oodbl_t WHERE oodblent='"||g_enterprise||"' AND oodbl002=? AND oodbl003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmjb_d[l_ac].xmjb006_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmjb_d[l_ac].xmjb006_desc

]]>
</point>
  <point name="input.a.page1.xmjb008" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            IF NOT cl_null(g_xmjb_d[l_ac].xmjb008) THEN 
            END IF 

]]>
</point>
  <point name="input.a.page1.xmjb009" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            IF NOT cl_null(g_xmjb_d[l_ac].xmjb009) THEN 
            END IF 

]]>
</point>
  <point name="input.a.page1.xmjb010" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            IF NOT cl_null(g_xmjb_d[l_ac].xmjb010) THEN 
            END IF 

]]>
</point>
  <point name="input.a.page1.xmjb011" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            IF NOT cl_null(g_xmjb_d[l_ac].xmjb011) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg2 = '參數2'
                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist_and_ref_val("v_imao002") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 
               ELSE
                  #檢查失敗時後續處理
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmjb_d[l_ac].xmjb011
            CALL ap_ref_array2(g_ref_fields,"SELECT oocal003 FROM oocal_t WHERE oocalent='"||g_enterprise||"' AND oocal001=? AND oocal002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmjb_d[l_ac].xmjb011_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmjb_d[l_ac].xmjb011_desc

]]>
</point>
  <point name="input.a.page1.xmjb013" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            IF NOT cl_null(g_xmjb_d[l_ac].xmjb013) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg2 = '參數2'
                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist_and_ref_val("v_imao002") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 
               ELSE
                  #檢查失敗時後續處理
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmjb_d[l_ac].xmjb013
            CALL ap_ref_array2(g_ref_fields,"SELECT oocal003 FROM oocal_t WHERE oocalent='"||g_enterprise||"' AND oocal001=? AND oocal002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmjb_d[l_ac].xmjb013_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmjb_d[l_ac].xmjb013_desc

]]>
</point>
  <point name="input.a.page1.xmjb014" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            IF NOT cl_null(g_xmjb_d[l_ac].xmjb014) THEN 
            END IF 

]]>
</point>
  <point name="input.a.page1.xmjb015" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            IF NOT cl_null(g_xmjb_d[l_ac].xmjb015) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg2 = '參數2'
                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist_and_ref_val("v_imao002") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 
               ELSE
                  #檢查失敗時後續處理
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmjb_d[l_ac].xmjb015
            CALL ap_ref_array2(g_ref_fields,"SELECT oocal003 FROM oocal_t WHERE oocalent='"||g_enterprise||"' AND oocal001=? AND oocal002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmjb_d[l_ac].xmjb015_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmjb_d[l_ac].xmjb015_desc

]]>
</point>
  <point name="input.a.page1.xmjb016" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            IF NOT cl_null(g_xmjb_d[l_ac].xmjb016) THEN 
            END IF 

]]>
</point>
  <point name="input.a.page1.xmjb017" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            IF NOT cl_null(g_xmjb_d[l_ac].xmjb017) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist_and_ref_val("v_ooca001") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 
               ELSE
                  #檢查失敗時後續處理
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmjb_d[l_ac].xmjb017
            CALL ap_ref_array2(g_ref_fields,"SELECT oocal003 FROM oocal_t WHERE oocalent='"||g_enterprise||"' AND oocal001=? AND oocal002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmjb_d[l_ac].xmjb017_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmjb_d[l_ac].xmjb017_desc

]]>
</point>
  <point name="input.a.page1.xmjb018" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            IF NOT cl_null(g_xmjb_d[l_ac].xmjb018) THEN 
            END IF 

]]>
</point>
  <point name="input.a.page1.xmjb024" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            IF NOT cl_null(g_xmjb_d[l_ac].xmjb024) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist_and_ref_val("v_pmaa001_14") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 
               ELSE
                  #檢查失敗時後續處理
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmjb_d[l_ac].xmjb024
            CALL ap_ref_array2(g_ref_fields,"SELECT pmaal004 FROM pmaal_t WHERE pmaalent='"||g_enterprise||"' AND pmaal001=? AND pmaal002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmjb_d[l_ac].xmjb024_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmjb_d[l_ac].xmjb024_desc

]]>
</point>
  <point name="input.a.page1.xmjb026" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            IF NOT cl_null(g_xmjb_d[l_ac].xmjb026) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg2 = '參數2'
                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist_and_ref_val("v_oofb019_1") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 
               ELSE
                  #檢查失敗時後續處理
                  NEXT FIELD CURRENT
               END IF
            

            END IF 

]]>
</point>
  <point name="input.a.page1.xmjb033" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            IF NOT cl_null(g_xmjb_d[l_ac].xmjb033) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg2 = '參數2'
                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist_and_ref_val("v_pmao004_3") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 
               ELSE
                  #檢查失敗時後續處理
                  NEXT FIELD CURRENT
               END IF
            

            END IF 

]]>
</point>
  <point name="input.a.page1.xmjbseq" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a05產生
            IF  g_xmee_m.xmeedocno IS NOT NULL AND g_xmjb_d[g_detail_idx].xmjbseq IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmee_m.xmeedocno != g_xmeedocno_t OR g_xmjb_d[g_detail_idx].xmjbseq != g_xmjb_d_t.xmjbseq)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xmjb_t WHERE "||"xmjbent = '" ||g_enterprise|| "' AND "||"xmjbdocno = '"||g_xmee_m.xmeedocno ||"' AND "|| "xmjbseq = '"||g_xmjb_d[g_detail_idx].xmjbseq ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
</point>
  <point name="input.a.page2.xmeg003" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            CALL adbt510_xmeg003_ref(g_xmeg2_d[l_ac].xmeg003) RETURNING  g_xmeg2_d[l_ac].xmeg003_desc         
            DISPLAY BY NAME g_xmeg2_d[l_ac].xmeg003_desc
]]>
</point>
  <point name="input.a.page2.xmeg025" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[
            IF NOT cl_null(g_xmeg2_d[l_ac].xmeg025) THEN 

            END IF               ]]>
</point>
  <point name="input.a.page2.xmeg026" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            IF NOT cl_null(g_xmeg2_d[l_ac].xmeg026) THEN 
 
             END IF]]>
</point>
  <point name="input.a.page2.xmeg0272" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.a.page2.xmeg028" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                    CALL adbt510_xmeg028_ref(g_xmeg2_d[l_ac].xmeg028) RETURNING g_xmeg2_d[l_ac].xmeg028_desc
            DISPLAY BY NAME g_xmeg2_d[l_ac].xmeg028_desc
            IF NOT cl_null(g_xmeg2_d[l_ac].xmeg028) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_site
               LET g_chkparam.arg2 = g_xmeg2_d[l_ac].xmeg028
                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_inaa001_1") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 

               ELSE
                  #檢查失敗時後續處理
                  LET g_xmeg2_d[l_ac].xmeg028 = g_xmeg2_d_t.xmeg028
                  CALL adbt510_xmeg028_ref(g_xmeg2_d[l_ac].xmeg028) RETURNING g_xmeg2_d[l_ac].xmeg028_desc
                  DISPLAY BY NAME g_xmeg2_d[l_ac].xmeg028_desc                  
                  NEXT FIELD CURRENT
               END IF
               IF NOT adbt510_xmeg029_chk() THEN
                  LET g_xmeg2_d[l_ac].xmeg028 = g_xmeg2_d_t.xmeg028
                  CALL adbt510_xmeg028_ref(g_xmeg2_d[l_ac].xmeg028) RETURNING g_xmeg2_d[l_ac].xmeg028_desc
                  DISPLAY BY NAME g_xmeg2_d[l_ac].xmeg028_desc
                  NEXT FIELD CURRENT
               END IF            

            END IF 
]]>
</point>
  <point name="input.a.page2.xmeg029" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                    CALL adbt510_xmeg029_ref(g_xmeg2_d[l_ac].xmeg028,g_xmeg2_d[l_ac].xmeg029) RETURNING g_xmeg2_d[l_ac].xmeg029_desc
            DISPLAY BY NAME g_xmeg2_d[l_ac].xmeg029_desc
            IF NOT cl_null(g_xmeg2_d[l_ac].xmeg029) THEN
               IF NOT adbt510_xmeg029_chk() THEN
                  LET g_xmeg2_d[l_ac].xmeg029 = g_xmeg2_d_t.xmeg029
                  CALL adbt510_xmeg029_ref(g_xmeg2_d[l_ac].xmeg028,g_xmeg2_d[l_ac].xmeg029) RETURNING g_xmeg2_d[l_ac].xmeg029_desc
                  DISPLAY BY NAME g_xmeg2_d[l_ac].xmeg029_desc
                  NEXT FIELD CURRENT
               END IF

            END IF
]]>
</point>
  <point name="input.a.page2.xmeg030" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            LET l_imaf062 = ''
            SELECT imaf062 INTO l_imaf062 FROM imaf_t 
             WHERE imafent = g_enterprise 
               AND imafsite = g_site 
               AND imaf001 = l_xmeg001
            
            #判斷[T:料件據點進銷存檔].[C:批號自動編碼]是否有勾選，若勾選自動編碼時需,呼叫命名規則產生的應用元件產生批號
            IF l_imaf062 = 'Y' THEN
            END IF
            #若輸入的料件+批號不存在[T:料件批號資料檔]時，則呼叫應用元件新增料件批號基本資料                                                                        ]]>
</point>
  <point name="input.a.page2.xmeg031" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            CALL adbt510_xmee020_ref(g_xmeg2_d[l_ac].xmeg031) RETURNING g_xmeg2_d[l_ac].xmeg031_desc
            DISPLAY BY NAME g_xmeg2_d[l_ac].xmeg031_desc
            IF NOT cl_null(g_xmeg2_d[l_ac].xmeg031) THEN 
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmeg2_d[l_ac].xmeg031

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_oocq002_263") THEN
                  #檢查成功時後續處理
                  #呼叫地址組合應用元件，將組合好的聯絡地址顯示在下方

               ELSE
                  #檢查失敗時後續處理
                  LET g_xmeg2_d[l_ac].xmeg031 = g_xmeg2_d_t.xmeg031
                  CALL adbt510_xmee020_ref(g_xmeg2_d[l_ac].xmeg031) RETURNING g_xmeg2_d[l_ac].xmeg031_desc
                  DISPLAY BY NAME g_xmeg2_d[l_ac].xmeg031_desc
                  NEXT FIELD CURRENT
               END IF
            END IF                                                                       ]]>
</point>
  <point name="input.a.page2.xmeg032" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.a.page2.xmeg033" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                    IF NOT cl_null(g_xmeg2_d[l_ac].xmeg033) THEN 
            END IF 
]]>
</point>
  <point name="input.a.page2.xmeg034" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                    IF NOT cl_null(g_xmeg2_d[l_ac].xmeg034) THEN 
            END IF 
]]>
</point>
  <point name="input.a.page2.xmeg036" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.a.page2.xmeg037" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.a.page2.xmeg038" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.a.page2.xmeg039" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.a.page2.xmegseq" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a05產生
            IF  g_xmee_m.xmeedocno IS NOT NULL AND g_xmjb2_d[g_detail_idx].xmegseq IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmee_m.xmeedocno != g_xmeedocno_t OR g_xmjb2_d[g_detail_idx].xmegseq != g_xmjb2_d_t.xmegseq)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xmeg_t WHERE "||"xmegent = '" ||g_enterprise|| "' AND "||"xmegdocno = '"||g_xmee_m.xmeedocno ||"' AND "|| "xmegseq = '"||g_xmjb2_d[g_detail_idx].xmegseq ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
</point>
  <point name="input.a.page2.xmegseq_2" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a05產生
            IF  g_xmee_m.xmeedocno IS NOT NULL AND g_xmeg2_d[g_detail_idx].xmegseq IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmee_m.xmeedocno != g_xmeedocno_t OR g_xmeg2_d[g_detail_idx].xmegseq != g_xmeg2_d_t.xmegseq)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xmeg_t WHERE "||"xmegent = '" ||g_enterprise|| "' AND "||"xmegdocno = '"||g_xmee_m.xmeedocno ||"' AND "|| "xmegseq = '"||g_xmeg2_d[g_detail_idx].xmegseq ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
</point>
  <point name="input.a.page3.xmeg012" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.a.page3.xmeg013" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.a.page3.xmeh001" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            IF NOT cl_null(g_xmeg3_d[l_ac].xmeh001) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmeg3_d[l_ac].xmeh001

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_imaa001_5") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 

               ELSE
                  #檢查失敗時後續處理
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
]]>
</point>
  <point name="input.a.page3.xmeh004" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            IF NOT cl_null(g_xmeg3_d[l_ac].xmeh004) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmeg3_d[l_ac].xmeh004

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_ooca001") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 

               ELSE
                  #檢查失敗時後續處理
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
]]>
</point>
  <point name="input.a.page3.xmeh017" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            IF NOT cl_null(g_xmeg3_d[l_ac].xmeh017) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_site
               LET g_chkparam.arg2 = g_xmeg3_d[l_ac].xmeh017 
                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_oodb002") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 

               ELSE
                  #檢查失敗時後續處理
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
]]>
</point>
  <point name="input.a.page3.xmeh022" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            IF NOT cl_null(g_xmeg3_d[l_ac].xmeh022) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmeg3_d[l_ac].xmeh022

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_ooag001") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 

               ELSE
                  #檢查失敗時後續處理
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
]]>
</point>
  <point name="input.a.page3.xmeh024" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            IF NOT cl_null(g_xmeg3_d[l_ac].xmeh024) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmeg3_d[l_ac].xmeh024

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_ooca001") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 

               ELSE
                  #檢查失敗時後續處理
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
]]>
</point>
  <point name="input.a.page3.xmeh025" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            IF NOT cl_null(g_xmeg3_d[l_ac].xmeh025) THEN 
            END IF 
]]>
</point>
  <point name="input.a.page3.xmeh026" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            IF NOT cl_null(g_xmeg3_d[l_ac].xmeh026) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmeg3_d[l_ac].xmeh026

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_ooca001") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 

               ELSE
                  #檢查失敗時後續處理
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
]]>
</point>
  <point name="input.a.page3.xmeh027" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            IF NOT cl_null(g_xmeg3_d[l_ac].xmeh027) THEN 
            END IF 
]]>
</point>
  <point name="input.a.page3.xmeh900" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a05產生
            IF  g_xmee_m.xmeedocno IS NOT NULL AND g_xmeg3_d[g_detail_idx].xmehdocno IS NOT NULL AND g_xmeg3_d[g_detail_idx].xmehseq IS NOT NULL AND g_xmeg3_d[g_detail_idx].xmehseq1 IS NOT NULL AND g_xmeg3_d[g_detail_idx].xmehseq2 IS NOT NULL AND g_xmeg3_d[g_detail_idx].xmeh900 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmee_m.xmeedocno != g_xmeedocno_t OR g_xmeg3_d[g_detail_idx].xmehdocno != g_xmeg3_d_t.xmehdocno OR g_xmeg3_d[g_detail_idx].xmehseq != g_xmeg3_d_t.xmehseq OR g_xmeg3_d[g_detail_idx].xmehseq1 != g_xmeg3_d_t.xmehseq1 OR g_xmeg3_d[g_detail_idx].xmehseq2 != g_xmeg3_d_t.xmehseq2 OR g_xmeg3_d[g_detail_idx].xmeh900 != g_xmeg3_d_t.xmeh900)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xmeh_t WHERE "||"xmehent = '" ||g_enterprise|| "' AND "||"xmehdocno = '"||g_xmee_m.xmeedocno ||"' AND "|| "xmehseq = '"||g_xmeg3_d[g_detail_idx].xmehdocno ||"' AND "|| "xmehseq1 = '"||g_xmeg3_d[g_detail_idx].xmehseq ||"' AND "|| "xmehseq2 = '"||g_xmeg3_d[g_detail_idx].xmehseq1 ||"' AND "|| "xmeh900 = '"||g_xmeg3_d[g_detail_idx].xmehseq2 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
</point>
  <point name="input.a.page3.xmehdocno" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a05產生
            IF  g_xmee_m.xmeedocno IS NOT NULL AND g_xmeg3_d[g_detail_idx].xmehdocno IS NOT NULL AND g_xmeg3_d[g_detail_idx].xmehseq IS NOT NULL AND g_xmeg3_d[g_detail_idx].xmehseq1 IS NOT NULL AND g_xmeg3_d[g_detail_idx].xmehseq2 IS NOT NULL AND g_xmeg3_d[g_detail_idx].xmeh900 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmee_m.xmeedocno != g_xmeedocno_t OR g_xmeg3_d[g_detail_idx].xmehdocno != g_xmeg3_d_t.xmehdocno OR g_xmeg3_d[g_detail_idx].xmehseq != g_xmeg3_d_t.xmehseq OR g_xmeg3_d[g_detail_idx].xmehseq1 != g_xmeg3_d_t.xmehseq1 OR g_xmeg3_d[g_detail_idx].xmehseq2 != g_xmeg3_d_t.xmehseq2 OR g_xmeg3_d[g_detail_idx].xmeh900 != g_xmeg3_d_t.xmeh900)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xmeh_t WHERE "||"xmehent = '" ||g_enterprise|| "' AND "||"xmehdocno = '"||g_xmee_m.xmeedocno ||"' AND "|| "xmehseq = '"||g_xmeg3_d[g_detail_idx].xmehdocno ||"' AND "|| "xmehseq1 = '"||g_xmeg3_d[g_detail_idx].xmehseq ||"' AND "|| "xmehseq2 = '"||g_xmeg3_d[g_detail_idx].xmehseq1 ||"' AND "|| "xmeh900 = '"||g_xmeg3_d[g_detail_idx].xmehseq2 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
</point>
  <point name="input.a.page3.xmehseq" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a05產生
            IF  g_xmee_m.xmeedocno IS NOT NULL AND g_xmeg3_d[g_detail_idx].xmehseq IS NOT NULL AND g_xmeg3_d[g_detail_idx].xmehseq1 IS NOT NULL AND g_xmeg3_d[g_detail_idx].xmehseq2 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmee_m.xmeedocno != g_xmeedocno_t OR g_xmeg3_d[g_detail_idx].xmehseq != g_xmeg3_d_t.xmehseq OR g_xmeg3_d[g_detail_idx].xmehseq1 != g_xmeg3_d_t.xmehseq1 OR g_xmeg3_d[g_detail_idx].xmehseq2 != g_xmeg3_d_t.xmehseq2)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xmeh_t WHERE "||"xmehent = '" ||g_enterprise|| "' AND "||"xmehdocno = '"||g_xmee_m.xmeedocno ||"' AND "|| "xmehseq = '"||g_xmeg3_d[g_detail_idx].xmehseq ||"' AND "|| "xmehseq1 = '"||g_xmeg3_d[g_detail_idx].xmehseq1 ||"' AND "|| "xmehseq2 = '"||g_xmeg3_d[g_detail_idx].xmehseq2 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
</point>
  <point name="input.a.page3.xmehseq1" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a05產生
            IF  g_xmee_m.xmeedocno IS NOT NULL AND g_xmeg3_d[g_detail_idx].xmehseq IS NOT NULL AND g_xmeg3_d[g_detail_idx].xmehseq1 IS NOT NULL AND g_xmeg3_d[g_detail_idx].xmehseq2 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmee_m.xmeedocno != g_xmeedocno_t OR g_xmeg3_d[g_detail_idx].xmehseq != g_xmeg3_d_t.xmehseq OR g_xmeg3_d[g_detail_idx].xmehseq1 != g_xmeg3_d_t.xmehseq1 OR g_xmeg3_d[g_detail_idx].xmehseq2 != g_xmeg3_d_t.xmehseq2)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xmeh_t WHERE "||"xmehent = '" ||g_enterprise|| "' AND "||"xmehdocno = '"||g_xmee_m.xmeedocno ||"' AND "|| "xmehseq = '"||g_xmeg3_d[g_detail_idx].xmehseq ||"' AND "|| "xmehseq1 = '"||g_xmeg3_d[g_detail_idx].xmehseq1 ||"' AND "|| "xmehseq2 = '"||g_xmeg3_d[g_detail_idx].xmehseq2 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
</point>
  <point name="input.a.page3.xmehseq2" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a05產生
            IF  g_xmee_m.xmeedocno IS NOT NULL AND g_xmeg3_d[g_detail_idx].xmehseq IS NOT NULL AND g_xmeg3_d[g_detail_idx].xmehseq1 IS NOT NULL AND g_xmeg3_d[g_detail_idx].xmehseq2 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmee_m.xmeedocno != g_xmeedocno_t OR g_xmeg3_d[g_detail_idx].xmehseq != g_xmeg3_d_t.xmehseq OR g_xmeg3_d[g_detail_idx].xmehseq1 != g_xmeg3_d_t.xmehseq1 OR g_xmeg3_d[g_detail_idx].xmehseq2 != g_xmeg3_d_t.xmehseq2)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xmeh_t WHERE "||"xmehent = '" ||g_enterprise|| "' AND "||"xmehdocno = '"||g_xmee_m.xmeedocno ||"' AND "|| "xmehseq = '"||g_xmeg3_d[g_detail_idx].xmehseq ||"' AND "|| "xmehseq1 = '"||g_xmeg3_d[g_detail_idx].xmehseq1 ||"' AND "|| "xmehseq2 = '"||g_xmeg3_d[g_detail_idx].xmehseq2 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
</point>
  <point name="input.a.page4.xmde001" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            IF NOT cl_null(g_xmeg4_d[l_ac].xmde001) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmeg4_d[l_ac].xmde001

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist_and_ref_val("v_imaa001_5") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 

               ELSE
                  #檢查失敗時後續處理
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
]]>
</point>
  <point name="input.a.page4.xmde008" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            IF NOT cl_null(g_xmeg4_d[l_ac].xmde008) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmeg4_d[l_ac].xmde008

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist_and_ref_val("v_oocq002_221") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 

               ELSE
                  #檢查失敗時後續處理
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
]]>
</point>
  <point name="input.a.page4.xmde022" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            IF NOT cl_null(g_xmeg4_d[l_ac].xmde022) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmeg4_d[l_ac].xmde022

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist_and_ref_val("v_ooca001") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 

               ELSE
                  #檢查失敗時後續處理
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
]]>
</point>
  <point name="input.a.page4.xmdeseq" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a05產生
            IF  g_xmee_m.xmeedocno IS NOT NULL AND g_xmeg4_d[g_detail_idx].xmdeseq IS NOT NULL AND g_xmeg4_d[g_detail_idx].xmdeseq1 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmee_m.xmeedocno != g_xmeedocno_t OR g_xmeg4_d[g_detail_idx].xmdeseq != g_xmeg4_d_t.xmdeseq OR g_xmeg4_d[g_detail_idx].xmdeseq1 != g_xmeg4_d_t.xmdeseq1)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xmde_t WHERE "||"xmdeent = '" ||g_enterprise|| "' AND "||"xmdedocno = '"||g_xmee_m.xmeedocno ||"' AND "|| "xmdeseq = '"||g_xmeg4_d[g_detail_idx].xmdeseq ||"' AND "|| "xmdeseq1 = '"||g_xmeg4_d[g_detail_idx].xmdeseq1 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
</point>
  <point name="input.a.page4.xmdeseq1" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a05產生
            IF  g_xmee_m.xmeedocno IS NOT NULL AND g_xmeg4_d[g_detail_idx].xmdeseq IS NOT NULL AND g_xmeg4_d[g_detail_idx].xmdeseq1 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmee_m.xmeedocno != g_xmeedocno_t OR g_xmeg4_d[g_detail_idx].xmdeseq != g_xmeg4_d_t.xmdeseq OR g_xmeg4_d[g_detail_idx].xmdeseq1 != g_xmeg4_d_t.xmdeseq1)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xmde_t WHERE "||"xmdeent = '" ||g_enterprise|| "' AND "||"xmdedocno = '"||g_xmee_m.xmeedocno ||"' AND "|| "xmdeseq = '"||g_xmeg4_d[g_detail_idx].xmdeseq ||"' AND "|| "xmdeseq1 = '"||g_xmeg4_d[g_detail_idx].xmdeseq1 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
</point>
  <point name="input.a.page4.xmeg027" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            IF NOT cl_null(g_xmjb4_d[l_ac].xmeg027) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist_and_ref_val("v_pmao004_1") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 
               ELSE
                  #檢查失敗時後續處理
                  NEXT FIELD CURRENT
               END IF
            

            END IF 

]]>
</point>
  <point name="input.a.page4.xmegseq_4" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a05產生
            IF  g_xmee_m.xmeedocno IS NOT NULL AND g_xmjb4_d[g_detail_idx].xmegseq IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmee_m.xmeedocno != g_xmeedocno_t OR g_xmjb4_d[g_detail_idx].xmegseq != g_xmjb4_d_t.xmegseq)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xmeg_t WHERE "||"xmegent = '" ||g_enterprise|| "' AND "||"xmegdocno = '"||g_xmee_m.xmeedocno ||"' AND "|| "xmegseq = '"||g_xmjb4_d[g_detail_idx].xmegseq ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
</point>
  <point name="input.a.page4.xmjb002" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[]]>
</point>
  <point name="input.a.page4.xmjb003" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[]]>
</point>
  <point name="input.a.page4.xmjb005" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            IF NOT cl_null(g_xmeg4_d[l_ac].xmjb005) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmeg4_d[l_ac].xmjb005
                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_prcf001") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 
               ELSE
                  #檢查失敗時後續處理
                  LET g_xmeg4_d[l_ac].xmjb005 = g_xmeg4_d_t.xmjb005
                  CALL adbt510_xmjb005_ref()
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
            CALL adbt510_xmjb005_ref()

]]>
</point>
  <point name="input.a.page4.xmjb006" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[]]>
</point>
  <point name="input.a.page4.xmjb008" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            IF NOT cl_null(g_xmeg4_d[l_ac].xmjb008) THEN 
            END IF 

]]>
</point>
  <point name="input.a.page4.xmjb009" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            IF NOT cl_null(g_xmeg4_d[l_ac].xmjb009) THEN 
            END IF 

]]>
</point>
  <point name="input.a.page4.xmjb010" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[]]>
</point>
  <point name="input.a.page4.xmjb011" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            IF NOT cl_null(g_xmeg4_d[l_ac].xmjb011) THEN 
               #此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmeg4_d[l_ac].xmjb003
               LET g_chkparam.arg2 = g_xmeg4_d[l_ac].xmjb011
                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_imao002") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 
               ELSE
                  #檢查失敗時後續處理
                  LET g_xmeg4_d[l_ac].xmjb011 = g_xmeg4_d_t.xmjb011
                  CALL adbt510_xmjb011_ref()
                  NEXT FIELD CURRENT
               END IF
           
            END IF  
            
            CALL adbt510_xmjb011_ref()
            CALL adbt510_xmjb012_convert()
]]>
</point>
  <point name="input.a.page4.xmjb012" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            IF NOT cl_null(g_xmeg4_d[l_ac].xmjb012) THEN
               CALL s_aooi250_take_decimals(g_xmeg4_d[l_ac].xmjb011,g_xmeg4_d[l_ac].xmjb012) RETURNING l_success,g_xmeg4_d[l_ac].xmjb012
               CALL adbt510_xmjb012_convert()
            END IF]]>
</point>
  <point name="input.a.page4.xmjb013" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            IF NOT cl_null(g_xmeg4_d[l_ac].xmjb013) THEN 
               #此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmeg4_d[l_ac].xmjb003
               LET g_chkparam.arg2 = g_xmeg4_d[l_ac].xmjb013
                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_imao002") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 
               ELSE
                  #檢查失敗時後續處理
                  LET g_xmeg4_d[l_ac].xmjb013 = g_xmeg4_d_t.xmjb013
                  CALL adbt510_xmjb013_ref()
                  NEXT FIELD CURRENT
               END IF
           
            END IF  
            
            CALL adbt510_xmjb013_ref()
            CALL adbt510_xmjb012_convert()
]]>
</point>
  <point name="input.a.page4.xmjb014" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            IF NOT cl_null(g_xmeg4_d[l_ac].xmjb014) THEN 
            END IF 

]]>
</point>
  <point name="input.a.page4.xmjb015" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            IF NOT cl_null(g_xmeg4_d[l_ac].xmjb015) THEN 
               #此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmeg4_d[l_ac].xmjb003
               LET g_chkparam.arg2 = g_xmeg4_d[l_ac].xmjb015
                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_imao002") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 
               ELSE
                  #檢查失敗時後續處理
                  LET g_xmeg4_d[l_ac].xmjb015 = g_xmeg4_d_t.xmjb015
                  CALL adbt510_xmjb015_ref()
                  NEXT FIELD CURRENT
               END IF
           
            END IF  
            
            CALL adbt510_xmjb015_ref()
            CALL adbt510_xmjb012_convert()

]]>
</point>
  <point name="input.a.page4.xmjb016" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            IF NOT cl_null(g_xmeg4_d[l_ac].xmjb016) THEN 
               CALL s_aooi250_take_decimals(g_xmeg4_d[l_ac].xmjb015,g_xmeg4_d[l_ac].xmjb016) RETURNING l_success,g_xmeg4_d[l_ac].xmjb016
            END IF 
]]>
</point>
  <point name="input.a.page4.xmjb017" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            IF NOT cl_null(g_xmeg4_d[l_ac].xmjb017) THEN 
               #此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmeg4_d[l_ac].xmjb017
                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_ooca001") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 
               ELSE
                  #檢查失敗時後續處理
                  LET g_xmeg4_d[l_ac].xmjb017 = g_xmeg4_d_t.xmjb017
                  CALL adbt510_xmjb017_ref()
                  NEXT FIELD CURRENT
               END IF

               CALL s_aooi250_take_decimals(g_xmeg4_d[l_ac].xmjb017,g_xmeg4_d[l_ac].xmjb018) RETURNING l_success,g_xmeg4_d[l_ac].xmjb018
            END IF  
            
            CALL adbt510_xmjb017_ref()
            CALL adbt510_xmjb012_convert()

]]>
</point>
  <point name="input.a.page4.xmjb018" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[]]>
</point>
  <point name="input.a.page4.xmjb024" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            IF NOT cl_null(g_xmeg4_d[l_ac].xmjb024) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmeg4_d[l_ac].xmjb024
                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_pmaa001_14") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 
               ELSE
                  #檢查失敗時後續處理
                  LET g_xmeg4_d[l_ac].xmjb024 = g_xmeg4_d_t.xmjb024
                  CALL adbt510_xmjb024_ref()
                  NEXT FIELD CURRENT
               END IF

               IF NOT s_adbt510_xmdl003_exist(g_xmee_m.xmeedocno) THEN
                 CALL adbt510_xmjb024_desc()
               END IF
            END IF 
            LET g_xmeg4_d[l_ac].xmjb025 = g_xmeg4_d[l_ac].xmjb024
            CALL adbt510_xmjb024_ref()

]]>
</point>
  <point name="input.a.page4.xmjb026" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            IF NOT cl_null(g_xmeg4_d[l_ac].xmjb026) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               CALL adbt510_get_pmaa027(g_xmeg4_d[l_ac].xmjb025) RETURNING l_pmaa027_1
               LET g_chkparam.arg1 = l_pmaa027_1
               LET g_chkparam.arg2 = g_xmeg4_d[l_ac].xmjb026
                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_oofb019_1") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 
               ELSE
                  #檢查失敗時後續處理
                  LET g_xmeg4_d[l_ac].xmjb026 = g_xmeg4_d_t.xmjb026
                  CALL adbt510_xmjb026_ref()
                  NEXT FIELD CURRENT
               END IF
               CALL adbt510_get_pmaa027(g_xmeg4_d[l_ac].xmjb025) RETURNING l_pmaa027   
               SELECT oofb022 INTO g_xmeg4_d[l_ac].xmjb027 FROM oofb_t
                WHERE oofb002 = l_pmaa027 AND oofb008 = '3' 
                  AND oofbstus = 'Y' 
                  AND oofb019 = g_xmeg4_d[l_ac].xmjb026
                  AND rownum = 1 
            ELSE
               LET g_xmeg4_d[l_ac].xmjb027 = NULL
            END IF 
            CALL adbt510_xmjb026_ref()
            CALL adbt510_xmjb027_ref()
]]>
</point>
  <point name="input.a.page4.xmjb027" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            IF NOT cl_null(g_xmeg4_d[l_ac].xmjb027) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmeg4_d[l_ac].xmjb027
                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist_and_ref_val("v_dbad001") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 
               ELSE
                  #檢查失敗時後續處理
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
            
            CALL adbt510_xmjb027_ref()

]]>
</point>
  <point name="input.a.page4.xmjb030" cite_std="N" status="u" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            IF g_xmeg4_d[l_ac].xmjb030= 'Y' THEN
               CALL adbt510_03(g_xmee_m.xmeedocno,g_xmeg4_d[l_ac].xmjbseq,g_xmee_m.xmee900,g_xmeg4_d[l_ac].xmjb018,g_xmeg4_d[l_ac].xmjb030,g_xmeg4_d[l_ac].xmjbsite)
               RETURNING g_xmeg4_d[l_ac].xmjb031,g_xmeg4_d[l_ac].xmjb032
               DISPLAY BY NAME g_xmeg4_d[l_ac].xmjb031,g_xmeg4_d[l_ac].xmjb032
               CALL s_adbt510_gen_xmeh(g_xmee_m.xmeedocno,g_xmeg4_d[l_ac].xmjbseq,g_xmee_m.xmee900) RETURNING l_success 
            ELSE
               #從多交期改成非多交期需清空多交期資料
               IF g_xmeg4_d_t.xmjb030 = 'Y' THEN
                  DELETE FROM xmdf_t
                   WHERE xmdfent = g_enterprise
                     AND xmdfdocno = g_xmee_m.xmeedocno
                     AND xmdfseq = g_xmeg4_d[l_ac].xmjbseq
               END IF
            END IF

            CALL adbt510_set_entry_b(l_cmd)
            CALL adbt510_set_no_entry_b(l_cmd)
]]>
</point>
  <point name="input.a.page4.xmjb031" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            IF g_xmeg4_d[l_ac].xmjb031 > g_xmeg4_d[l_ac].xmjb032 THEN
               CALL cl_err('','adb-00079',0)
               NEXT FIELD  xmjb031
            END IF ]]>
</point>
  <point name="input.a.page4.xmjb032" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            IF g_xmeg4_d[l_ac].xmjb032 < g_xmeg4_d[l_ac].xmjb031 THEN
               CALL cl_err('','adb-00079',0)
               NEXT FIELD  xmjb032
            END IF  ]]>
</point>
  <point name="input.a.page4.xmjb033" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            IF NOT cl_null(g_xmeg4_d[l_ac].xmjb033) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmee_m.xmee004
               LET g_chkparam.arg2 = g_xmeg4_d[l_ac].xmjb033
                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_pmao004_3") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 
               ELSE
                  #檢查失敗時後續處理
                  LET g_xmeg4_d[l_ac].xmjb033 = g_xmeg4_d_t.xmjb033
                  CALL adbt510_xmjb003_ref()
                  NEXT FIELD CURRENT
               END IF
            

            END IF 

]]>
</point>
  <point name="input.a.page4.xmjb900" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a05產生
            IF  g_xmee_m.xmeedocno IS NOT NULL AND g_xmeg4_d[g_detail_idx].xmjbdocno IS NOT NULL AND g_xmeg4_d[g_detail_idx].xmjbseq IS NOT NULL AND g_xmeg4_d[g_detail_idx].xmjb900 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmee_m.xmeedocno != g_xmeedocno_t OR g_xmeg4_d[g_detail_idx].xmjbdocno != g_xmeg4_d_t.xmjbdocno OR g_xmeg4_d[g_detail_idx].xmjbseq != g_xmeg4_d_t.xmjbseq OR g_xmeg4_d[g_detail_idx].xmjb900 != g_xmeg4_d_t.xmjb900)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xmjb_t WHERE "||"xmjbent = '" ||g_enterprise|| "' AND "||"xmjbdocno = '"||g_xmee_m.xmeedocno ||"' AND "|| "xmjbseq = '"||g_xmeg4_d[g_detail_idx].xmjbdocno ||"' AND "|| "xmjb900 = '"||g_xmeg4_d[g_detail_idx].xmjbseq ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
</point>
  <point name="input.a.page4.xmjb902" cite_std="N" status="u" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            IF NOT cl_null(g_xmeg4_d[l_ac].xmjb902) THEN
               IF NOT s_azzi650_chk_exist('267',g_xmeg4_d[l_ac].xmjb902) THEN
                  LET g_xmeg4_d[l_ac].xmjb902 = g_xmeg4_d_t.xmjb902
                  NEXT FIELD xmjb902
               END IF
            END IF
            CALL adbt510_xmjb902_ref()]]>
</point>
  <point name="input.a.page4.xmjbdocno" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a05產生
            IF  g_xmee_m.xmeedocno IS NOT NULL AND g_xmeg4_d[g_detail_idx].xmjbdocno IS NOT NULL AND g_xmeg4_d[g_detail_idx].xmjbseq IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmee_m.xmeedocno != g_xmeedocno_t OR g_xmeg4_d[g_detail_idx].xmjbdocno != g_xmeg4_d_t.xmjbdocno OR g_xmeg4_d[g_detail_idx].xmjbseq != g_xmeg4_d_t.xmjbseq)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xmjb_t WHERE "||"xmjbent = '" ||g_enterprise|| "' AND "||"xmjbdocno = '"||g_xmee_m.xmeedocno ||"' AND "|| "xmjbseq = '"||g_xmeg4_d[g_detail_idx].xmjbdocno ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
</point>
  <point name="input.a.page4.xmjbseq" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a05產生
            IF  g_xmee_m.xmeedocno IS NOT NULL AND g_xmeg4_d[g_detail_idx].xmjbseq IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmee_m.xmeedocno != g_xmeedocno_t OR g_xmeg4_d[g_detail_idx].xmjbseq != g_xmeg4_d_t.xmjbseq)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xmjb_t WHERE "||"xmjbent = '" ||g_enterprise|| "' AND "||"xmjbdocno = '"||g_xmee_m.xmeedocno ||"' AND "|| "xmjbseq = '"||g_xmeg4_d[g_detail_idx].xmjbseq ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
</point>
  <point name="input.a.page4.xmjbseq_4" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a05產生
            IF  g_xmee_m.xmeedocno IS NOT NULL AND g_xmjb4_d[g_detail_idx].xmjbseq IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmee_m.xmeedocno != g_xmeedocno_t OR g_xmjb4_d[g_detail_idx].xmjbseq != g_xmjb4_d_t.xmjbseq)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xmjb_t WHERE "||"xmjbent = '" ||g_enterprise|| "' AND "||"xmjbdocno = '"||g_xmee_m.xmeedocno ||"' AND "|| "xmjbseq = '"||g_xmjb4_d[g_detail_idx].xmjbseq ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
</point>
  <point name="input.a.page4.xmjbsite" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            IF NOT cl_null(g_xmeg4_d[l_ac].xmjbsite) AND g_xmeg4_d[l_ac].xmjbsite <> g_xmeg4_d_t.xmjbsite THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmeg4_d[l_ac].xmjbsite
               LET g_chkparam.arg2 = '2'
               LET g_chkparam.arg3 = g_xmee_m.xmeesite
                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_ooed004") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 
               ELSE
                  #檢查失敗時後續處理
                  LET g_xmeg4_d[l_ac].xmjbsite = g_xmeg4_d_t.xmjbsite
                  CALL adbt510_xmjbsite_ref()
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
            CALL adbt510_xmjbsite_ref()
            LET g_flag3 = FALSE
            CALL adbt510_set_entry_b(l_cmd)
            CALL adbt510_set_no_entry_b(l_cmd)]]>
</point>
  <point name="input.a.page5.xmef001" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a05產生
            IF  g_xmee_m.xmeedocno IS NOT NULL AND g_xmeg5_d[g_detail_idx].xmef001 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmee_m.xmeedocno != g_xmeedocno_t OR g_xmeg5_d[g_detail_idx].xmef001 != g_xmeg5_d_t.xmef001)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xmef_t WHERE "||"xmefent = '" ||g_enterprise|| "' AND xmefsite = '" ||g_site|| "' AND "||"xmefdocno = '"||g_xmee_m.xmeedocno ||"' AND "|| "xmef001 = '"||g_xmeg5_d[g_detail_idx].xmef001 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
</point>
  <point name="input.a.page5.xmef002" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            IF NOT cl_null(g_xmeg5_d[l_ac].xmef002) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_pmad002_2") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 

               ELSE
                  #檢查失敗時後續處理
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
]]>
</point>
  <point name="input.a.page5.xmef005" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            IF NOT cl_null(g_xmeg5_d[l_ac].xmef005) THEN 
            END IF 
]]>
</point>
  <point name="input.a.page5.xmef006" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            IF NOT cl_null(g_xmeg5_d[l_ac].xmef006) THEN 
            END IF 
]]>
</point>
  <point name="input.a.page5.xmef900" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a05產生
            IF  g_xmee_m.xmeedocno IS NOT NULL AND g_xmeg5_d[g_detail_idx].xmefdocno IS NOT NULL AND g_xmeg5_d[g_detail_idx].xmef001 IS NOT NULL AND g_xmeg5_d[g_detail_idx].xmef900 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmee_m.xmeedocno != g_xmeedocno_t OR g_xmeg5_d[g_detail_idx].xmefdocno != g_xmeg5_d_t.xmefdocno OR g_xmeg5_d[g_detail_idx].xmef001 != g_xmeg5_d_t.xmef001 OR g_xmeg5_d[g_detail_idx].xmef900 != g_xmeg5_d_t.xmef900)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xmef_t WHERE "||"xmefent = '" ||g_enterprise|| "' AND "||"xmefdocno = '"||g_xmee_m.xmeedocno ||"' AND "|| "xmef001 = '"||g_xmeg5_d[g_detail_idx].xmefdocno ||"' AND "|| "xmef900 = '"||g_xmeg5_d[g_detail_idx].xmef001 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
</point>
  <point name="input.a.page5.xmef902" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmeg5_d[l_ac].xmef902
            CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='267' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmeg5_d[l_ac].xmef902_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmeg5_d[l_ac].xmef902_desc

]]>
</point>
  <point name="input.a.page5.xmefdocno" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a05產生
            IF  g_xmee_m.xmeedocno IS NOT NULL AND g_xmeg5_d[g_detail_idx].xmefdocno IS NOT NULL AND g_xmeg5_d[g_detail_idx].xmef001 IS NOT NULL AND g_xmeg5_d[g_detail_idx].xmef900 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmee_m.xmeedocno != g_xmeedocno_t OR g_xmeg5_d[g_detail_idx].xmefdocno != g_xmeg5_d_t.xmefdocno OR g_xmeg5_d[g_detail_idx].xmef001 != g_xmeg5_d_t.xmef001 OR g_xmeg5_d[g_detail_idx].xmef900 != g_xmeg5_d_t.xmef900)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xmef_t WHERE "||"xmefent = '" ||g_enterprise|| "' AND "||"xmefdocno = '"||g_xmee_m.xmeedocno ||"' AND "|| "xmef001 = '"||g_xmeg5_d[g_detail_idx].xmefdocno ||"' AND "|| "xmef900 = '"||g_xmeg5_d[g_detail_idx].xmef001 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
</point>
  <point name="input.a.page6.xrcd002" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            CALL adbt510_xrcd002_ref()]]>
</point>
  <point name="input.a.page6.xrcd007" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a05產生
            IF  g_xmee_m.xmeedocno IS NOT NULL AND g_xmeg6_d[g_detail_idx].xrcdld IS NOT NULL AND g_xmeg6_d[g_detail_idx].xrcdseq IS NOT NULL AND g_xmeg6_d[g_detail_idx].xrcdseq2 IS NOT NULL AND g_xmeg6_d[g_detail_idx].xrcd007 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmee_m.xmeedocno != g_xmeedocno_t OR g_xmeg6_d[g_detail_idx].xrcdld != g_xmeg6_d_t.xrcdld OR g_xmeg6_d[g_detail_idx].xrcdseq != g_xmeg6_d_t.xrcdseq OR g_xmeg6_d[g_detail_idx].xrcdseq2 != g_xmeg6_d_t.xrcdseq2 OR g_xmeg6_d[g_detail_idx].xrcd007 != g_xmeg6_d_t.xrcd007)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xrcd_t WHERE "||"xrcdent = '" ||g_enterprise|| "' AND "||"xrcddocno = '"||g_xmee_m.xmeedocno ||"' AND "|| "xrcdld = '"||g_xmeg6_d[g_detail_idx].xrcdld ||"' AND "|| "xrcdseq = '"||g_xmeg6_d[g_detail_idx].xrcdseq ||"' AND "|| "xrcdseq2 = '"||g_xmeg6_d[g_detail_idx].xrcdseq2 ||"' AND "|| "xrcd007 = '"||g_xmeg6_d[g_detail_idx].xrcd007 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
</point>
  <point name="input.a.page6.xrcdld" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a05產生
            IF  g_xmee_m.xmeedocno IS NOT NULL AND g_xmeg6_d[g_detail_idx].xrcdld IS NOT NULL AND g_xmeg6_d[g_detail_idx].xrcdseq IS NOT NULL AND g_xmeg6_d[g_detail_idx].xrcdseq2 IS NOT NULL AND g_xmeg6_d[g_detail_idx].xrcd007 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmee_m.xmeedocno != g_xmeedocno_t OR g_xmeg6_d[g_detail_idx].xrcdld != g_xmeg6_d_t.xrcdld OR g_xmeg6_d[g_detail_idx].xrcdseq != g_xmeg6_d_t.xrcdseq OR g_xmeg6_d[g_detail_idx].xrcdseq2 != g_xmeg6_d_t.xrcdseq2 OR g_xmeg6_d[g_detail_idx].xrcd007 != g_xmeg6_d_t.xrcd007)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xrcd_t WHERE "||"xrcdent = '" ||g_enterprise|| "' AND "||"xrcddocno = '"||g_xmee_m.xmeedocno ||"' AND "|| "xrcdld = '"||g_xmeg6_d[g_detail_idx].xrcdld ||"' AND "|| "xrcdseq = '"||g_xmeg6_d[g_detail_idx].xrcdseq ||"' AND "|| "xrcdseq2 = '"||g_xmeg6_d[g_detail_idx].xrcdseq2 ||"' AND "|| "xrcd007 = '"||g_xmeg6_d[g_detail_idx].xrcd007 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
</point>
  <point name="input.a.page6.xrcdseq" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a05產生
            IF  g_xmee_m.xmeedocno IS NOT NULL AND g_xmeg6_d[g_detail_idx].xrcdld IS NOT NULL AND g_xmeg6_d[g_detail_idx].xrcdseq IS NOT NULL AND g_xmeg6_d[g_detail_idx].xrcdseq2 IS NOT NULL AND g_xmeg6_d[g_detail_idx].xrcd007 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmee_m.xmeedocno != g_xmeedocno_t OR g_xmeg6_d[g_detail_idx].xrcdld != g_xmeg6_d_t.xrcdld OR g_xmeg6_d[g_detail_idx].xrcdseq != g_xmeg6_d_t.xrcdseq OR g_xmeg6_d[g_detail_idx].xrcdseq2 != g_xmeg6_d_t.xrcdseq2 OR g_xmeg6_d[g_detail_idx].xrcd007 != g_xmeg6_d_t.xrcd007)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xrcd_t WHERE "||"xrcdent = '" ||g_enterprise|| "' AND "||"xrcddocno = '"||g_xmee_m.xmeedocno ||"' AND "|| "xrcdld = '"||g_xmeg6_d[g_detail_idx].xrcdld ||"' AND "|| "xrcdseq = '"||g_xmeg6_d[g_detail_idx].xrcdseq ||"' AND "|| "xrcdseq2 = '"||g_xmeg6_d[g_detail_idx].xrcdseq2 ||"' AND "|| "xrcd007 = '"||g_xmeg6_d[g_detail_idx].xrcd007 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
</point>
  <point name="input.a.page6.xrcdseq2" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a05產生
            IF  g_xmee_m.xmeedocno IS NOT NULL AND g_xmeg6_d[g_detail_idx].xrcdld IS NOT NULL AND g_xmeg6_d[g_detail_idx].xrcdseq IS NOT NULL AND g_xmeg6_d[g_detail_idx].xrcdseq2 IS NOT NULL AND g_xmeg6_d[g_detail_idx].xrcd007 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmee_m.xmeedocno != g_xmeedocno_t OR g_xmeg6_d[g_detail_idx].xrcdld != g_xmeg6_d_t.xrcdld OR g_xmeg6_d[g_detail_idx].xrcdseq != g_xmeg6_d_t.xrcdseq OR g_xmeg6_d[g_detail_idx].xrcdseq2 != g_xmeg6_d_t.xrcdseq2 OR g_xmeg6_d[g_detail_idx].xrcd007 != g_xmeg6_d_t.xrcd007)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xrcd_t WHERE "||"xrcdent = '" ||g_enterprise|| "' AND "||"xrcddocno = '"||g_xmee_m.xmeedocno ||"' AND "|| "xrcdld = '"||g_xmeg6_d[g_detail_idx].xrcdld ||"' AND "|| "xrcdseq = '"||g_xmeg6_d[g_detail_idx].xrcdseq ||"' AND "|| "xrcdseq2 = '"||g_xmeg6_d[g_detail_idx].xrcdseq2 ||"' AND "|| "xrcd007 = '"||g_xmeg6_d[g_detail_idx].xrcd007 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
</point>
  <point name="input.a.page7.rtieseq" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a05產生
            IF  g_xmee_m.xmeedocno IS NOT NULL AND g_xmeg7_d[g_detail_idx].rtieseq IS NOT NULL AND g_xmeg7_d[g_detail_idx].rtieseq1 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmee_m.xmeedocno != g_xmeedocno_t OR g_xmeg7_d[g_detail_idx].rtieseq != g_xmeg7_d_t.rtieseq OR g_xmeg7_d[g_detail_idx].rtieseq1 != g_xmeg7_d_t.rtieseq1)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM rtie_t WHERE "||"rtieent = '" ||g_enterprise|| "' AND "||"rtiedocno = '"||g_xmee_m.xmeedocno ||"' AND "|| "rtieseq = '"||g_xmeg7_d[g_detail_idx].rtieseq ||"' AND "|| "rtieseq1 = '"||g_xmeg7_d[g_detail_idx].rtieseq1 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
</point>
  <point name="input.a.page7.rtieseq1" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a05產生
            IF  g_xmee_m.xmeedocno IS NOT NULL AND g_xmeg7_d[g_detail_idx].rtieseq IS NOT NULL AND g_xmeg7_d[g_detail_idx].rtieseq1 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmee_m.xmeedocno != g_xmeedocno_t OR g_xmeg7_d[g_detail_idx].rtieseq != g_xmeg7_d_t.rtieseq OR g_xmeg7_d[g_detail_idx].rtieseq1 != g_xmeg7_d_t.rtieseq1)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM rtie_t WHERE "||"rtieent = '" ||g_enterprise|| "' AND "||"rtiedocno = '"||g_xmee_m.xmeedocno ||"' AND "|| "rtieseq = '"||g_xmeg7_d[g_detail_idx].rtieseq ||"' AND "|| "rtieseq1 = '"||g_xmeg7_d[g_detail_idx].rtieseq1 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
</point>
  <point name="input.a.page8.xmeg027" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            IF NOT cl_null(g_xmeg8_d[l_ac].xmeg027) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist_and_ref_val("v_pmao004_1") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 
               ELSE
                  #檢查失敗時後續處理
                  NEXT FIELD CURRENT
               END IF
            

            END IF 

]]>
</point>
  <point name="input.a.page8.xmegseq_7" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a05產生
            IF  g_xmee_m.xmeedocno IS NOT NULL AND g_xmeg8_d[g_detail_idx].xmegseq IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmee_m.xmeedocno != g_xmeedocno_t OR g_xmeg8_d[g_detail_idx].xmegseq != g_xmeg8_d_t.xmegseq)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xmeg_t WHERE "||"xmegent = '" ||g_enterprise|| "' AND "||"xmegdocno = '"||g_xmee_m.xmeedocno ||"' AND "|| "xmegseq = '"||g_xmeg8_d[g_detail_idx].xmegseq ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
</point>
  <point name="input.a.xmee001" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.a.xmee002" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            CALL adbt510_xmee002_ref(g_xmee_m.xmee002) RETURNING g_xmee_m.xmee002_desc
            DISPLAY BY NAME g_xmee_m.xmee002_desc
            IF NOT cl_null(g_xmee_m.xmee002) THEN 
              #此段落由子樣板a19產生   
               IF p_cmd = 'a' OR ( p_cmd = 'u' AND (g_xmee_m.xmee002 != g_xmee_m_t.xmee002 OR cl_null(g_xmee_m_t.xmee002))) THEN
                 #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
                  INITIALIZE g_chkparam.* TO NULL               
                  #設定g_chkparam.*的參數
                  LET g_chkparam.arg1 = g_xmee_m.xmee002
                     
                 #呼叫檢查存在並帶值的library
                  IF cl_chk_exist("v_ooag001") THEN
                     #檢查成功時後續處理
                      SELECT ooag003 INTO g_xmee_m.xmee003 FROM ooag_t WHERE ooagent = g_enterprise AND ooag001 = g_xmee_m.xmee002
                      CALL adbt510_xmee003_ref(g_xmee_m.xmee003) RETURNING g_xmee_m.xmee003_desc
                      DISPLAY BY NAME g_xmee_m.xmee003_desc 
                  ELSE
                     #檢查失敗時後續處理
                      LET g_xmee_m.xmee002 = g_xmee_m_t.xmee002
                      CALL adbt510_xmee002_ref(g_xmee_m.xmee002) RETURNING g_xmee_m.xmee002_desc
                      DISPLAY BY NAME g_xmee_m.xmee002_desc
                      NEXT FIELD CURRENT
                  END IF
               END IF

            END IF 
]]>
</point>
  <point name="input.a.xmee003" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            CALL adbt510_xmee003_ref(g_xmee_m.xmee003) RETURNING g_xmee_m.xmee003_desc
            DISPLAY BY NAME g_xmee_m.xmee003_desc 
            
            IF NOT cl_null(g_xmee_m.xmee003) THEN 
               IF NOT adbt510_xmee003_chk(g_xmee_m.xmee003) THEN
                  LET g_xmee_m.xmee003 = g_xmee_m_t.xmee003
                  CALL adbt510_xmee003_ref(g_xmee_m.xmee003) RETURNING g_xmee_m.xmee003_desc
                  DISPLAY BY NAME g_xmee_m.xmee003_desc 
                  NEXT FIELD CURRENT
               END IF   
                              
            END IF ]]>
</point>
  <point name="input.a.xmee004" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[]]>
</point>
  <point name="input.a.xmee005" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            IF g_xmee_m.xmee005 <> '6' THEN
               LET g_xmee_m.xmee200 = NULL
               CALL adbt510_xmee200_ref()
            ELSE
               LET g_xmee_m.xmee201 = NULL
               CALL adbt510_xmee201_ref()
            END IF            ]]>
</point>
  <point name="input.a.xmee006" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.a.xmee007" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.a.xmee008" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[]]>
</point>
  <point name="input.a.xmee009" cite_std="N" status="u" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            CALL adbt510_xmee009_ref(g_xmee_m.xmee009) RETURNING g_xmee_m.xmee009_desc
            DISPLAY BY NAME g_xmee_m.xmee009_desc
            IF NOT cl_null(g_xmee_m.xmee009) THEN 
               #此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmee_m.xmee021
               LET g_chkparam.arg2 = g_xmee_m.xmee009
                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_pmad002_2") THEN
                  #檢查成功時後續處理
               ELSE
                  #檢查失敗時後續處理
                  LET g_xmee_m.xmee009 = g_xmee_m_t.xmee009
                  CALL adbt510_xmee009_ref(g_xmee_m.xmee009) RETURNING g_xmee_m.xmee009_desc
                  DISPLAY BY NAME g_xmee_m.xmee009_desc                  
                  NEXT FIELD CURRENT
               END IF 
               IF g_xmee_m.xmee007 = '5' THEN
                  SELECT COUNT(*)
                    INTO l_cnt
                    FROM xmdk_t
                   WHERE xmdkent = g_enterprise 
                     AND xmdkdocno = g_xmee_m.xmee008
                     AND xmdk000 <> '2'
                     AND xmdk010 = g_xmee_m.xmee009
                  IF l_cnt = 0 THEN
                     CALL cl_err(g_xmee_m.xmee009,'adb-00050',1)
                     LET g_xmee_m.xmee009 = g_xmee_m_t.xmee009
                     CALL adbt510_xmee009_ref(g_xmee_m.xmee009) RETURNING g_xmee_m.xmee009_desc
                     DISPLAY BY NAME g_xmee_m.xmee009_desc
                     NEXT FIELD CURRENT
                  END IF
               END IF
               
            END IF 
]]>
</point>
  <point name="input.a.xmee010" cite_std="N" status="u" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            IF NOT cl_null(g_xmee_m.xmee010) THEN 
               #此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmee_m.xmee010

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_oocq002_238") THEN
                  #檢查成功時後續處理
               ELSE
                  #檢查失敗時後續處理
                  LET g_xmee_m.xmee010 = g_xmee_m_t.xmee010
                  CALL adbt510_xmee010_ref(g_xmee_m.xmee010) RETURNING g_xmee_m.xmee010_desc
                  DISPLAY BY NAME g_xmee_m.xmee010_desc                  
                  NEXT FIELD CURRENT
               END IF
               IF g_xmee_m.xmee007 = '5' THEN
                  SELECT COUNT(*)
                    INTO l_cnt
                    FROM xmdk_t
                   WHERE xmdkent = g_enterprise 
                     AND xmdkdocno = g_xmee_m.xmee008
                     AND xmdk000 <> '2'
                     AND xmdk011 = g_xmee_m.xmee010
                  IF l_cnt = 0 THEN
                     CALL cl_err(g_xmee_m.xmee010,'adb-00050',1)
                     LET g_xmee_m.xmee010 = g_xmee_m_t.xmee010
                     CALL adbt510_xmee010_ref(g_xmee_m.xmee010) RETURNING g_xmee_m.xmee010_desc
                     DISPLAY BY NAME g_xmee_m.xmee010_desc   
                     NEXT FIELD CURRENT
                  END IF
               END IF            
            END IF 
]]>
</point>
  <point name="input.a.xmee011" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[]]>
</point>
  <point name="input.a.xmee012" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.a.xmee013" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.a.xmee015" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            CALL adbt510_xmee015_ref(g_xmee_m.xmee015) RETURNING g_xmee_m.xmee015_desc
            DISPLAY BY NAME g_xmee_m.xmee015_desc
            IF NOT cl_null(g_xmee_m.xmee015) THEN 
               #此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmee_m.xmeesite
               LET g_chkparam.arg2 = g_xmee_m.xmee015

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_ooaj002") THEN
                  #檢查成功時後續處理
                  CALL s_aooi200_get_slip(g_xmee_m.xmeedocno) RETURNING l_success,l_slip               #截取單別
                  IF l_success THEN
                     CALL cl_get_doc_para(g_enterprise,g_xmee_m.xmeesite,l_slip,'D-BAS-0075') RETURNING l_para_data  #外幣使用匯率來源
                     IF cl_null(l_para_data) THEN
                        CALL cl_err('','axm-00144',1)      
                     ELSE
                        LET l_ooef016 = ''
                        SELECT ooef016 INTO l_ooef016 FROM ooef_t WHERE ooefent = g_enterprise AND ooef001 = g_xmee_m.xmeesite
                        CALL s_aooi160_get_exrate('1',g_xmee_m.xmeesite,g_today,g_xmee_m.xmee015,l_ooef016,0,l_para_data) RETURNING g_xmee_m.xmee016
                        DISPLAY BY NAME g_xmee_m.xmee016
                     END IF   
                  END IF
               ELSE
                  #檢查失敗時後續處理
                  LET g_xmee_m.xmee015 = g_xmee_m_t.xmee015
                  CALL adbt510_xmee015_ref(g_xmee_m.xmee015) RETURNING g_xmee_m.xmee015_desc
                  DISPLAY BY NAME g_xmee_m.xmee015_desc
                  NEXT FIELD CURRENT
               END IF
               
               IF g_xmee_m.xmee007 = '5' THEN
                  SELECT COUNT(*)
                    INTO l_cnt
                    FROM xmdk_t
                   WHERE xmdkent = g_enterprise 
                     AND xmdkdocno = g_xmee_m.xmee008
                     AND xmdk000 <> '2'
                     AND xmdk016 = g_xmee_m.xmee015
                  IF l_cnt = 0 THEN
                     CALL cl_err(g_xmee_m.xmee015,'adb-00050',1)
                     NEXT FIELD CURRENT
                  END IF
               END IF               
            END IF 
]]>
</point>
  <point name="input.a.xmee016" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.a.xmee017" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            CALL adbt510_xmee017_ref(g_xmee_m.xmee017) RETURNING g_xmee_m.xmee017_desc
            DISPLAY BY NAME g_xmee_m.xmee017_desc    
            IF NOT cl_null(g_xmee_m.xmee017) THEN 
               #此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmee_m.xmee017                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_xmah001") THEN
                  
               ELSE
                  #檢查失敗時後續處理
                  LET g_xmee_m.xmee017 = g_xmee_m_t.xmee017
                  CALL adbt510_xmee017_ref(g_xmee_m.xmee017) RETURNING g_xmee_m.xmee017_desc
                  DISPLAY BY NAME g_xmee_m.xmee017_desc
                  NEXT FIELD CURRENT                                 
               END IF          
            END IF 
]]>
</point>
  <point name="input.a.xmee018" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                    CALL adbt510_xmee018_ref(g_xmee_m.xmee018) RETURNING g_xmee_m.xmee018_desc
            DISPLAY BY NAME g_xmee_m.xmee018_desc
            IF NOT cl_null(g_xmee_m.xmee018) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmee_m.xmee018

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_ooid001_2") THEN
                  #檢查成功時後續處理
                ELSE
                  #檢查失敗時後續處理
                  LET g_xmee_m.xmee018 = g_xmee_m_t.xmee018
                  CALL adbt510_xmee018_ref(g_xmee_m.xmee018) RETURNING g_xmee_m.xmee018_desc
                  DISPLAY BY NAME g_xmee_m.xmee018_desc                  
                  NEXT FIELD CURRENT
               END IF
 
            END IF 
]]>
</point>
  <point name="input.a.xmee019" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.a.xmee020" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            CALL adbt510_xmee020_ref(g_xmee_m.xmee020) RETURNING g_xmee_m.xmee020_desc
            DISPLAY BY NAME g_xmee_m.xmee020_desc  
            IF NOT cl_null(g_xmee_m.xmee020) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmee_m.xmee020

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_oocq002_263") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 

               ELSE
                  LET g_xmee_m.xmee020 = g_xmee_m_t.xmee020
                  CALL adbt510_xmee020_ref(g_xmee_m.xmee020) RETURNING g_xmee_m.xmee020_desc
                  DISPLAY BY NAME g_xmee_m.xmee020_desc  
                  NEXT FIELD CURRENT
               END IF          

            END IF 
]]>
</point>
  <point name="input.a.xmee021" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            IF NOT cl_null(g_xmee_m.xmee021) THEN 
            #此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmee_m.xmee004
               LET g_chkparam.arg2 = g_xmee_m.xmee021
                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_pmac002") THEN
                  #檢查成功時後續處理
               ELSE
                  #檢查失敗時後續處理
                  LET g_xmee_m.xmee021 = g_xmee_m_t.xmee021
                  CALL adbt510_xmee004_ref(g_xmee_m.xmee021) RETURNING g_xmee_m.xmee021_desc
                  DISPLAY BY NAME g_xmee_m.xmee021_desc                  
                  NEXT FIELD CURRENT
               END IF             
            END IF 
            CALL adbt510_xmee026_desc()
            CALL adbt510_xmee004_ref(g_xmee_m.xmee021) RETURNING g_xmee_m.xmee021_desc
            DISPLAY BY NAME g_xmee_m.xmee021_desc]]>
</point>
  <point name="input.a.xmee022" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            IF NOT cl_null(g_xmee_m.xmee022) THEN 
               #此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmee_m.xmee004
               LET g_chkparam.arg2 = g_xmee_m.xmee022                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_pmac002_2") THEN
                  #檢查成功時後續處理
               ELSE
                  #檢查失敗時後續處理
                  LET g_xmee_m.xmee022 = g_xmee_m_t.xmee022                  
                  CALL adbt510_xmee004_ref(g_xmee_m.xmee022) RETURNING g_xmee_m.xmee022_desc
                  DISPLAY BY NAME g_xmee_m.xmee022_desc                 
                  NEXT FIELD CURRENT
               END IF           
            END IF 
            CALL adbt510_xmee025_desc()
            CALL adbt510_xmee004_ref(g_xmee_m.xmee022) RETURNING g_xmee_m.xmee022_desc
            DISPLAY BY NAME g_xmee_m.xmee022_desc]]>
</point>
  <point name="input.a.xmee023" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            
            IF NOT cl_null(g_xmee_m.xmee023) THEN 
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmee_m.xmee023
               LET g_chkparam.arg2 = '1'

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_oojd001") THEN
                  #檢查成功時後續處理
               ELSE
                  #檢查失敗時後續處理
                  LET g_xmee_m.xmee023 = g_xmee_m_t.xmee023
                  CALL adbt510_xmee023_ref(g_xmee_m.xmee023) RETURNING g_xmee_m.xmee023_desc
                  DISPLAY BY NAME g_xmee_m.xmee023_desc
                  NEXT FIELD CURRENT
               END IF
               IF NOT adbt510_xmee202_chk() THEN
                  NEXT FIELD CURRENT
               END IF
            END IF 
            
            
            CALL adbt510_xmee023_ref(g_xmee_m.xmee023) RETURNING g_xmee_m.xmee023_desc
            DISPLAY BY NAME g_xmee_m.xmee023_desc
]]>
</point>
  <point name="input.a.xmee024" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            CALL adbt510_xmee024_ref(g_xmee_m.xmee024) RETURNING g_xmee_m.xmee024_desc
            DISPLAY BY NAME g_xmee_m.xmee024_desc
            IF NOT cl_null(g_xmee_m.xmee024) THEN
               IF NOT adbt510_xmee024_chk(g_xmee_m.xmee024) THEN
                  LET g_xmee_m.xmee024 = g_xmee_m_t.xmee024
                  CALL adbt510_xmee024_ref(g_xmee_m.xmee024) RETURNING g_xmee_m.xmee024_desc
                  DISPLAY BY NAME g_xmee_m.xmee024_desc
                  NEXT FIELD CURRENT
               END IF
            END IF            ]]>
</point>
  <point name="input.a.xmee025" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            IF NOT cl_null(g_xmee_m.xmee025) THEN 
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               
			      LET g_chkparam.arg1 = l_pmaa027
               LET g_chkparam.arg2 = g_xmee_m.xmee025
                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_oofb019_1") THEN
                  #呼叫地址組合應用元件，將組合好的聯絡地址顯示在下方
                  CALL s_aooi350_get_address(l_pmaa027,g_xmee_m.xmee025,g_lang)RETURNING r_success,r_address
                  IF r_success THEN
                     LET g_xmee_m.oofb017 = r_address
                     DISPLAY BY NAME g_xmee_m.oofb017   
                  END IF
               ELSE
                  #檢查失敗時後續處理
                  LET g_xmee_m.xmee025 = g_xmee_m_t.xmee025
                  CALL adbt510_xmee025_ref(l_pmaa027,g_xmee_m.xmee025) RETURNING g_xmee_m.xmee025_desc
                  DISPLAY BY NAME g_xmee_m.xmee025_desc
                  NEXT FIELD CURRENT
               END IF
               
               SELECT oofb022 INTO g_xmee_m.xmee206 FROM oofb_t
                WHERE oofb002 = l_pmaa027 AND oofb008 = '3' 
                  AND oofbstus = 'Y' 
                  AND oofb019 = g_xmee_m.xmee025 
                  AND rownum = 1 
               
               IF NOT cl_null(g_xmee_m.xmee206) THEN
                  SELECT dbaf001 INTO g_xmee_m.xmee207
                    FROM dbaf_t
                   WHERE dbafent = g_enterprise
                     AND dbaf002 = '1'
                     AND dbaf003 = g_xmee_m.xmee206 
                     AND dbafstus = 'Y'
                  IF cl_null(g_xmee_m.xmee207) THEN 
                     SELECT dbaf001 INTO g_xmee_m.xmee207
                       FROM dbaf_t
                      WHERE dbafent = g_enterprise
                        AND dbaf002 = '1'
                        AND dbaf003 = g_xmee_m.xmee206 
                        AND dbafstus = 'Y'
                        AND rownum = 1 
                  END IF         
               END IF
            ELSE               
               LET g_xmee_m.xmee206 = ''
               LET g_xmee_m.xmee207 = ''
               LET g_xmee_m.oofb017 = ''
            END IF
            CALL adbt510_xmee025_ref(l_pmaa027,g_xmee_m.xmee025) RETURNING g_xmee_m.xmee025_desc
            DISPLAY BY NAME g_xmee_m.xmee025_desc
            DISPLAY BY NAME g_xmee_m.xmee206,g_xmee_m.xmee207,g_xmee_m.oofb017
            CALL adbt510_xmee206_ref()
            CALL adbt510_xmee207_ref()
            ]]>
</point>
  <point name="input.a.xmee026" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            IF NOT cl_null(g_xmee_m.xmee026) THEN 
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
			   CALL adbt510_get_pmaa027(g_xmee_m.xmee021) RETURNING l_pmaa027
			   LET g_chkparam.arg1 = l_pmaa027
               LET g_chkparam.arg2 = g_xmee_m.xmee026
                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_oofb019_2") THEN
                  #呼叫地址組合應用元件，將組合好的聯絡地址顯示在下方
                  CALL s_aooi350_get_address(l_pmaa027,g_xmee_m.xmee026,g_lang)RETURNING r_success,r_address
                  IF r_success THEN
                     LET g_xmee_m.oofb017_1 = r_address
                     DISPLAY BY NAME g_xmee_m.oofb017_1
                  END IF
               ELSE
                  #檢查失敗時後續處理
                  LET g_xmee_m.xmee026 = g_xmee_m_t.xmee026
                  CALL adbt510_xmee026_ref(l_pmaa027,g_xmee_m.xmee026) RETURNING g_xmee_m.xmee026_desc
                  DISPLAY BY NAME g_xmee_m.xmee026_desc
                  NEXT FIELD CURRENT
               END IF
            END IF
            CALL adbt510_xmee026_ref(l_pmaa027,g_xmee_m.xmee026) RETURNING g_xmee_m.xmee026_desc
            DISPLAY BY NAME g_xmee_m.xmee026_desc]]>
</point>
  <point name="input.a.xmee027" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                    CALL adbt510_xmee027_ref(g_xmee_m.xmee027) RETURNING g_xmee_m.xmee027_desc
            DISPLAY BY NAME g_xmee_m.xmee027_desc
            
            IF NOT cl_null(g_xmee_m.xmee027) THEN 
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmee_m.xmee004
               LET g_chkparam.arg2 = g_xmee_m.xmee027

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_pmaj002") THEN
                  #檢查成功時後續處理
               ELSE
                  #檢查失敗時後續處理
                  LET g_xmee_m.xmee027 = g_xmee_m_t.xmee027
                  CALL adbt510_xmee027_ref(g_xmee_m.xmee027) RETURNING g_xmee_m.xmee027_desc
                  DISPLAY BY NAME g_xmee_m.xmee027_desc
                  NEXT FIELD CURRENT
               END IF
            END IF 
]]>
</point>
  <point name="input.a.xmee028" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.a.xmee030" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.a.xmee031" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.a.xmee032" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[           
            CALL adbt510_xmee032_ref(g_xmee_m.xmee032) RETURNING g_xmee_m.xmee032_desc
            DISPLAY BY NAME g_xmee_m.xmee032_desc

            IF NOT cl_null(g_xmee_m.xmee032) THEN
               IF NOT s_azzi650_chk_exist('298',g_xmee_m.xmee032) THEN
                  LET g_xmee_m.xmee032 = g_xmee_m_t.xmee032
                  CALL adbt510_xmee032_ref(g_xmee_m.xmee032) RETURNING g_xmee_m.xmee032_desc
                  DISPLAY BY NAME g_xmee_m.xmee032_desc
                  NEXT FIELD CURRENT               
               END IF
            END IF
]]>
</point>
  <point name="input.a.xmee033" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.a.xmee034" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            CALL adbt510_xmee004_ref(g_xmee_m.xmee034) RETURNING g_xmee_m.xmee034_desc
            DISPLAY BY NAME g_xmee_m.xmee034_desc
            IF NOT cl_null(g_xmee_m.xmee034)  AND g_xmee_m.xmee034 <> g_xmee_m_t.xmee034 THEN 
               #此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmee_m.xmee034                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_pmaa001_3") THEN
                  #檢查成功時後續處理
               ELSE
                  #檢查失敗時後續處理
                  LET g_xmee_m.xmee034 = g_xmee_m_t.xmee034
                  CALL adbt510_xmee004_ref(g_xmee_m.xmee034) RETURNING g_xmee_m.xmee034_desc
                  DISPLAY BY NAME g_xmee_m.xmee034_desc
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
]]>
</point>
  <point name="input.a.xmee035" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            CALL adbt510_xmee035_ref(g_xmee_m.xmee035) RETURNING g_xmee_m.xmee035_desc
            DISPLAY BY NAME g_xmee_m.xmee035_desc  
            IF NOT cl_null(g_xmee_m.xmee035) THEN
               INITIALIZE g_chkparam.* TO NULL

               #設定g_chkparam.*的參數
               SELECT ooef019 INTO l_ooef019 FROM ooef_t WHERE ooefent = g_enterprise AND ooef001 = g_xmee_m.xmeesite
               LET g_chkparam.arg1 = l_ooef019 
               LET g_chkparam.arg2 = g_xmee_m.xmee035
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_isac002") THEN
                  #檢查成功時後續處理
               ELSE
                  #檢查失敗時後續處理
                  LET g_xmee_m.xmee035 = g_xmee_m_t.xmee035
                  CALL adbt510_xmee035_ref(g_xmee_m.xmee035) RETURNING g_xmee_m.xmee035_desc
                  DISPLAY BY NAME g_xmee_m.xmee035_desc 
                  NEXT FIELD CURRENT
               END IF               
            END IF]]>
</point>
  <point name="input.a.xmee036" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                    CALL adbt510_xmee004_ref(g_xmee_m.xmee036) RETURNING g_xmee_m.xmee036_desc
            DISPLAY BY NAME g_xmee_m.xmee036_desc
            IF NOT cl_null(g_xmee_m.xmee036) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmee_m.xmee036

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_pmaa001_1") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 

               ELSE
                  #檢查失敗時後續處理
                  LET g_xmee_m.xmee036=g_xmee_m_t.xmee036
                  CALL adbt510_xmee004_ref(g_xmee_m.xmee036) RETURNING g_xmee_m.xmee036_desc
                  DISPLAY BY NAME g_xmee_m.xmee036_desc
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmee_m.xmee036
            CALL ap_ref_array2(g_ref_fields,"SELECT pmaal004 FROM pmaal_t WHERE pmaalent='"||g_enterprise||"' AND pmaal001=? AND pmaal002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmee_m.xmee036_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmee_m.xmee036_desc
]]>
</point>
  <point name="input.a.xmee037" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                    CALL adbt510_xmee037_ref(g_xmee_m.xmee037) RETURNING g_xmee_m.xmee037_desc
            DISPLAY BY NAME g_xmee_m.xmee037_desc

            IF NOT cl_null(g_xmee_m.xmee020) THEN  #運輸類型
               CALL adbt510_location_chk(g_xmee_m.xmee037,l_oocq019)

               IF NOT cl_null(g_errno) THEN
                  CALL cl_err(g_xmee_m.xmee037,g_errno,1)
                  LET g_xmee_m.xmee037 = g_xmee_m_t.xmee037
                  NEXT FIELD CURRENT
               END IF
            ELSE
               CALL cl_err('','axm-00085','1')   #請先輸入運輸方式
               NEXT FIELD xmee020
            END IF

]]>
</point>
  <point name="input.a.xmee038" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                    CALL adbt510_xmee038_ref(g_xmee_m.xmee038) RETURNING g_xmee_m.xmee038_desc
            DISPLAY BY NAME g_xmee_m.xmee038_desc

            IF NOT cl_null(g_xmee_m.xmee037) THEN
               IF NOT cl_null(g_xmee_m.xmee020) THEN               #運輸類型
                  CALL adbt510_location_chk(g_xmee_m.xmee037,l_oocq019)

                  IF NOT cl_null(g_errno) THEN
                     CALL cl_err(g_xmee_m.xmee037,g_errno,1)
                     LET g_xmee_m.xmee037 = g_xmee_m_t.xmee037
                     NEXT FIELD CURRENT
                  END IF
               ELSE
                  CALL cl_err('','axm-00085','1')   #請先輸入運輸方式
                  NEXT FIELD CURRENT
               END IF
            END IF    ]]>
</point>
  <point name="input.a.xmee039" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.a.xmee043" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.a.xmee044" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            IF NOT cl_null(g_xmee_m.xmee044) THEN
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL

               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmee_m.xmee004

               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_itcf002") THEN
                  #檢查成功時後續處理
               ELSE
                  #檢查失敗時後續處理
                  LET g_xmee_m.xmee044 = g_xmee_m_t.xmee044
                  NEXT FIELD CURRENT
               END IF
            END IF                                                                        ]]>
</point>
  <point name="input.a.xmee200" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            IF NOT cl_null(g_xmee_m.xmee200) THEN 
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmee_m.xmee200
                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_pmaa001_16") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 
               ELSE
                  #檢查失敗時後續處理
                  LET g_xmee_m.xmee200 = g_xmee_m_t.xmee200
                  CALL adbt510_xmee200_ref()
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
            CALL adbt510_xmee200_ref()]]>
</point>
  <point name="input.a.xmee201" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            IF NOT cl_null(g_xmee_m.xmee201) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmee_m.xmee201
                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_pmaa001_1") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 
               ELSE
                  #檢查失敗時後續處理
                  LET g_xmee_m.xmee201 = g_xmee_m_t.xmee201
                  CALL adbt510_xmee201_ref()
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
            CALL adbt510_xmee201_ref()
]]>
</point>
  <point name="input.a.xmee202" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            IF NOT cl_null(g_xmee_m.xmee202) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmee_m.xmee202
               LET g_chkparam.arg2 = "G"
                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_ooef001_2") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 
               ELSE
                  #檢查失敗時後續處理
                  LET g_xmee_m.xmee202 = g_xmee_m_t.xmee202
                  CALL adbt510_xmee202_ref()
                  NEXT FIELD CURRENT
               END IF
               IF NOT adbt510_xmee202_chk() THEN
                  NEXT FIELD CURRENT
               END IF
            END IF 
            CALL adbt510_xmee202_ref()

]]>
</point>
  <point name="input.a.xmee203" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            IF NOT cl_null(g_xmee_m.xmee203) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmee_m.xmee004
               LET g_chkparam.arg2 = g_xmee_m.xmee203
                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_pmac002_5") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 
               ELSE
                  #檢查失敗時後續處理
                  LET g_xmee_m.xmee203 = g_xmee_m_t.xmee203
                  CALL adbt510_xmee203_ref()
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
            CALL adbt510_xmee203_ref()

]]>
</point>
  <point name="input.a.xmee204" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            IF NOT cl_null(g_xmee_m.xmee204) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmee_m.xmee204
                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_prcf001") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 
               ELSE
                  #檢查失敗時後續處理
                  LET g_xmee_m.xmee204 = g_xmee_m_t.xmee204
                  CALL adbt510_xmee204_ref()
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
            CALL adbt510_xmee204_ref()

]]>
</point>
  <point name="input.a.xmee205" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            IF NOT cl_null(g_xmee_m.xmee205) THEN 
            END IF 

]]>
</point>
  <point name="input.a.xmee900" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a05產生
            IF  NOT cl_null(g_xmee_m.xmeedocno) AND NOT cl_null(g_xmee_m.xmee900) THEN 
               IF p_cmd = 'a' OR ( p_cmd = 'u' AND (g_xmee_m.xmeedocno != g_xmeedocno_t  OR g_xmee_m.xmee900 != g_xmee900_t )) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xmee_t WHERE "||"xmeeent = '" ||g_enterprise|| "' AND "||"xmeedocno = '"||g_xmee_m.xmeedocno ||"' AND "|| "xmee900 = '"||g_xmee_m.xmee900 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF


]]>
</point>
  <point name="input.a.xmee903" cite_std="N" status="u" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            IF NOT cl_null(g_xmee_m.xmee903) THEN
               IF NOT s_azzi650_chk_exist('267',g_xmee_m.xmee903) THEN
                  LET g_xmee_m.xmee903 = g_xmee_m_t.xmee903
                  NEXT FIELD xmee903
               END IF
            END IF
            CALL adbt510_xmee903_ref()]]>
</point>
  <point name="input.a.xmeedocdt" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[]]>
</point>
  <point name="input.a.xmeedocno" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            IF NOT cl_null(g_xmee_m.xmeedocno) AND NOT cl_null(g_xmee_m.xmee900) THEN
               IF p_cmd = 'a' OR ( p_cmd = 'u' AND (g_xmee_m.xmeedocno != g_xmeedocno_t  OR g_xmee_m.xmee900 != g_xmee900_t )) THEN
                   IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xmee_t WHERE "||"xmeeent = '" ||g_enterprise|| "' AND "||"xmeedocno = '"||g_xmee_m.xmeedocno ||"' AND "|| "xmee900 = '"||g_xmee_m.xmee900 ||"'",'std-00004',0) THEN 
                      LET g_xmee_m.xmeedocno = g_xmeedocno_t
                      NEXT FIELD CURRENT
                   END IF                  
               END IF   
            END IF
            IF NOT cl_null(g_xmee_m.xmeedocno) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_xmee_m.xmeedocno != g_xmeedocno_t)) THEN
                  #校驗
                  IF NOT adbt510_xmeedocno_chk() THEN
                     LET g_xmee_m.xmeedocno = g_xmee_m_t.xmeedocno
                     DISPLAY BY NAME g_xmee_m.xmeedocno
                     NEXT FIELD CURRENT                 
                  END IF
                  #依據輸入的訂單單號，帶出單頭欄位的值
                  IF NOT adbt510_xmeedocno_xmee() THEN
                     LET g_xmee_m.xmeedocno = g_xmee_m_t.xmeedocno
                     DISPLAY BY NAME g_xmee_m.xmeedocno
                     NEXT FIELD CURRENT
                  END IF
                  #依據輸入的訂單單號，帶出單身欄位的值
                  IF NOT adbt510_xmeedocno_xmjb() THEN
                     LET g_xmee_m.xmeedocno = g_xmee_m_t.xmeedocno
                     DISPLAY BY NAME g_xmee_m.xmeedocno
                     NEXT FIELD CURRENT
                  END IF
                  #依據輸入的訂單單號，帶出單身欄位的值
                  IF NOT adbt510_xmeedocno_xmeg() THEN
                     LET g_xmee_m.xmeedocno = g_xmee_m_t.xmeedocno
                     DISPLAY BY NAME g_xmee_m.xmeedocno
                     NEXT FIELD CURRENT
                  END IF
                 #依據輸入的訂單單號，帶出訂單交期明細的值
                  IF NOT adbt510_xmeedocno_xmeh() THEN
                     LET g_xmee_m.xmeedocno = g_xmee_m_t.xmeedocno
                     DISPLAY BY NAME g_xmee_m.xmeedocno
                     NEXT FIELD CURRENT
                  END IF 
                 #依據輸入的訂單單號，帶出多期預收款的值
                  IF NOT adbt510_xmeedocno_xmef() THEN
                     LET g_xmee_m.xmeedocno = g_xmee_m_t.xmeedocno
                     DISPLAY BY NAME g_xmee_m.xmeedocno
                     NEXT FIELD CURRENT
                  END IF                  
                  
               END IF
            END IF 
            CALL adbt510_set_entry(p_cmd)
            CALL adbt510_set_no_entry(p_cmd)              ]]>
</point>
  <point name="input.a.xmeesite" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            IF NOT cl_null(g_xmee_m.xmeesite) THEN 
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmee_m.xmeesite
               LET g_chkparam.arg2 = '2'
               LET g_chkparam.arg3 = g_site
                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_ooed004") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 
               ELSE
                  #檢查失敗時後續處理
                  LET g_xmee_m.xmeesite = g_xmee_m_t.xmeesite
                  CALL adbt510_xmeesite_ref()
                  NEXT FIELD CURRENT
               END IF
            END IF  
            CALL adbt510_xmeesite_ref() 
            LET g_flag2 = TRUE
            CALL adbt510_set_entry(p_cmd)
            CALL adbt510_set_no_entry(p_cmd)            ]]>
</point>
  <point name="input.a.xmeestus" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.a.xmeeunit" cite_std="N" status="" ver="3" src="s" new="N" mark_hard="N">
<![CDATA[            IF NOT cl_null(g_xmee_m.xmeeunit) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmee_m.xmeeunit
               LET g_chkparam.arg2 = '2'
                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_ooed004_1") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 
               ELSE
                  #檢查失敗時後續處理
                  LET g_xmee_m.xmeeunit = g_xmee_m_t.xmeeunit
                  CALL adbt510_xmeeunit_ref()
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
            CALL adbt510_xmeeunit_ref()
            IF g_xmee_m.xmeeunit <> g_xmee_m_t.xmeeunit OR
               (cl_null(g_xmee_m.xmeeunit) AND NOT cl_null(g_xmee_m_t.xmeeunit)) OR
                (NOT cl_null(g_xmee_m.xmeeunit) AND cl_null(g_xmee_m_t.xmeeunit)) THEN
               IF cl_ask_confirm('adb-00205') THEN
                  LET g_upd_unit = 'Y'
               ELSE
                  LET g_upd_unit = 'N'
               END IF
            END IF]]>
</point>
  <point name="input.after_define_sql" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                  ]]>
</point>
  <point name="input.after_define_sql2" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                  ]]>
</point>
  <point name="input.after_define_sql3" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                  ]]>
</point>
  <point name="input.after_input" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[          ]]>
</point>
  <point name="input.after_set_entry" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                  ]]>
</point>
  <point name="input.b.page1.imaal004" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.b.page1.xmeg001" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.b.page1.xmeg002" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            LET l_imaa005=''
            CALL adbt510_get_imaa005(g_enterprise,g_xmeg_d[l_ac].xmeg001) RETURNING l_imaa005

            IF NOT cl_null(l_imaa005) THEN
               IF l_cmd = 'a' AND cl_null(g_xmeg_d[l_ac].xmeg002) THEN
                  CALL g_inam.clear()
                  CALL s_feature_multi(g_xmeg_d[l_ac].xmeg001,'','',g_site,g_xmee_m.xmeedocno) RETURNING l_success,g_inam
                  LET g_xmeg_d[l_ac].xmeg002 = g_inam[1].inam002
                  LET g_xmeg_d[l_ac].xmeg007 = g_inam[1].inam004
                  DISPLAY BY NAME g_xmeg_d[l_ac].xmeg002,g_xmeg_d[l_ac].xmeg007
               END IF
            END IF         ]]>
</point>
  <point name="input.b.page1.xmeg004" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.b.page1.xmeg005" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.b.page1.xmeg006" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.b.page1.xmeg007" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.b.page1.xmeg008" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.b.page1.xmeg009" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.b.page1.xmeg010" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.b.page1.xmeg011" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.b.page1.xmeg012" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.b.page1.xmeg013" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.b.page1.xmeg015" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.b.page1.xmeg016" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.b.page1.xmeg019" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.b.page1.xmeg020" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.b.page1.xmeg021" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.b.page1.xmeg022" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.b.page1.xmeg023" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.b.page1.xmeg024" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.b.page1.xmeg027" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.b.page1.xmeg045" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.b.page1.xmeg049" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.b.page1.xmeg050" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.b.page1.xmeg052" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.b.page1.xmegorga" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.b.page1.xmegseq" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.b.page1.xmegunit" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                    CALL adbt510_set_entry_b(p_cmd)
            CALL adbt510_set_no_entry_b(p_cmd)                                                ]]>
</point>
  <point name="input.b.page2.xmeg003" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.b.page2.xmeg025" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                       ]]>
</point>
  <point name="input.b.page2.xmeg026" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.b.page2.xmeg0272" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.b.page2.xmeg028" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.b.page2.xmeg029" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.b.page2.xmeg030" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.b.page2.xmeg031" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.b.page2.xmeg032" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.b.page2.xmeg033" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.b.page2.xmeg034" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.b.page2.xmeg036" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.b.page2.xmeg037" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.b.page2.xmeg038" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.b.page2.xmeg039" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.b.page3.xmeg012" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.b.page3.xmeg013" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.b.page4.xmjb003" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[]]>
</point>
  <point name="input.b.page4.xmjb004" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            LET l_imaa005=''
            CALL adbt510_get_imaa005(g_enterprise,g_xmeg4_d[l_ac].xmjb003) RETURNING l_imaa005

            IF NOT cl_null(l_imaa005) THEN
               IF l_cmd = 'a' AND cl_null(g_xmeg4_d[l_ac].xmjb004) THEN
                  CALL g_inam.clear()
                  CALL s_feature_multi(g_xmeg4_d[l_ac].xmjb003,'','',g_xmee_m.xmeesite,g_xmee_m.xmeedocno) RETURNING l_success,g_inam
                  LET g_xmeg4_d[l_ac].xmjb004 = g_inam[1].inam002
                  LET g_xmeg4_d[l_ac].xmjb012 = g_inam[1].inam004
                  CALL adbt510_xmjb012_convert()
                  DISPLAY BY NAME g_xmeg4_d[l_ac].xmjb004,g_xmeg4_d[l_ac].xmjb014
               END IF
            END IF]]>
</point>
  <point name="input.b.page4.xmjb010" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            IF g_xmeg4_d[l_ac].xmjb010 = 0 AND g_xmeg4_d[l_ac].xmjb009 > 0 THEN
               LET g_xmeg4_d[l_ac].xmjb010 = g_xmeg4_d[l_ac].xmjb009
               CALL adbt510_get_xmjb022()
            END IF]]>
</point>
  <point name="input.b.page4.xmjb011" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            CALL adbt510_set_entry_b(l_cmd)
            CALL adbt510_set_no_entry_b(l_cmd)]]>
</point>
  <point name="input.b.page4.xmjb015" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            CALL adbt510_set_no_required_b()
            CALL adbt510_set_required_b()]]>
</point>
  <point name="input.b.page4.xmjb017" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            CALL adbt510_set_no_required_b()
            CALL adbt510_set_required_b()]]>
</point>
  <point name="input.b.page4.xmjb024" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            CALL adbt510_set_entry_b(l_cmd)
            CALL adbt510_set_no_entry_b(l_cmd)]]>
</point>
  <point name="input.b.xmee001" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.b.xmee002" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.b.xmee003" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.b.xmee004" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.b.xmee005" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.b.xmee006" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.b.xmee007" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.b.xmee008" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.b.xmee009" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.b.xmee010" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.b.xmee011" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.b.xmee012" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.b.xmee013" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.b.xmee015" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.b.xmee016" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.b.xmee017" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.b.xmee018" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.b.xmee019" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.b.xmee020" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.b.xmee021" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.b.xmee022" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.b.xmee023" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.b.xmee024" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.b.xmee025" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            LET l_pmaa027 = ''
            CALL adbt510_get_pmaa027(g_xmee_m.xmee022) RETURNING l_pmaa027                                                           ]]>
</point>
  <point name="input.b.xmee026" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            LET l_pmaa027 = ''
            CALL adbt510_get_pmaa027(g_xmee_m.xmee021) RETURNING l_pmaa027                                                             ]]>
</point>
  <point name="input.b.xmee027" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.b.xmee028" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.b.xmee030" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.b.xmee031" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.b.xmee032" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.b.xmee033" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.b.xmee034" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.b.xmee035" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.b.xmee036" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.b.xmee037" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                            IF cl_null(g_xmee_m.xmee020) THEN  #運輸類型 
               CALL cl_err('','axm-00085','1')   #請先輸入運輸方式   
               NEXT FIELD xmee020
            END IF               ]]>
</point>
  <point name="input.b.xmee038" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.b.xmee039" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.b.xmee043" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.b.xmee044" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.b.xmee200" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            CALL adbt510_set_entry(p_cmd)
            CALL adbt510_set_no_entry(p_cmd)           ]]>
</point>
  <point name="input.b.xmeedocdt" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.b.xmeedocno" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.b.xmeesite" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.b.xmeestus" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.before_dialog" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[         #新增時強制從單頭開始填
         IF p_cmd = 'a' THEN
            NEXT FIELD xmeesite
         ELSE
            CASE g_aw
               WHEN "s_detail1"
                  NEXT FIELD xmegseq
               WHEN "s_detail3"
                  NEXT FIELD xmehseq
               WHEN "s_detail4"
                  NEXT FIELD xmjbseq
               WHEN "s_detail5"
                  NEXT FIELD xmef001
               WHEN "s_detail6"
                  NEXT FIELD xrcdseq
               WHEN "s_detail7"
                  NEXT FIELD rtieseq
 
            END CASE
         END IF                                                ]]>
</point>
  <point name="input.before_input" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                     LET g_flag = FALSE
   CALL adbt510_set_entry(p_cmd)
   CALL adbt510_set_no_entry(p_cmd)
]]>
</point>
  <point name="input.body.a_delete" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[    ]]>
</point>
  <point name="input.body.a_insert" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                          ]]>
</point>
  <point name="input.body.a_insert2" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[         ]]>
</point>
  <point name="input.body.a_update" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                                                                     ]]>
</point>
  <point name="input.body.after_delete" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.body.after_input" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.body.after_row" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.body.after_set_entry_b" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                          ]]>
</point>
  <point name="input.body.b_a_insert" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #檢查單身單價不可小於等於零
               ]]>
</point>
  <point name="input.body.b_delete" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                          ]]>
</point>
  <point name="input.body.b_insert" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                          ]]>
</point>
  <point name="input.body.b_update" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                          ]]>
</point>
  <point name="input.body.before_insert" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[         ]]>
</point>
  <point name="input.body.before_row" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                      ]]>
</point>
  <point name="input.body.insert.after_set_entry_b" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.body.m_delete" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                          ]]>
</point>
  <point name="input.body.m_update" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                          ]]>
</point>
  <point name="input.body2.a_delete" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                                            ]]>
</point>
  <point name="input.body2.a_insert" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                          ]]>
</point>
  <point name="input.body2.a_update" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                          ]]>
</point>
  <point name="input.body2.after_delete" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.body2.after_input" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.body2.after_insert" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                          ]]>
</point>
  <point name="input.body2.after_row" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.body2.after_set_entry_b" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                          ]]>
</point>
  <point name="input.body2.b_a_insert" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.body2.b_delete" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                          ]]>
</point>
  <point name="input.body2.b_insert" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                          ]]>
</point>
  <point name="input.body2.b_update" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                                         LET g_xmeg_d[l_ac].xmeg001 = g_xmeg2_d[l_ac].imaa001
               LET g_xmeg_d[l_ac].xmeg002 = g_xmeg2_d[l_ac].imaa005
               LET g_xmeg_d[l_ac].xmeg027 = g_xmeg2_d[l_ac].xmeg0272 ]]>
</point>
  <point name="input.body2.before_input" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.body2.before_insert" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.body2.before_row" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.body2.insert.after_set_entry_b" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.body2.m_delete" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                          ]]>
</point>
  <point name="input.body2.m_update" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                          ]]>
</point>
  <point name="input.body3.a_delete" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                                            ]]>
</point>
  <point name="input.body3.a_insert" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                          ]]>
</point>
  <point name="input.body3.a_update" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                          ]]>
</point>
  <point name="input.body3.after_delete" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.body3.after_input" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.body3.after_insert" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                          ]]>
</point>
  <point name="input.body3.after_row" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.body3.after_set_entry_b" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                          ]]>
</point>
  <point name="input.body3.b_a_insert" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.body3.b_delete" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                          ]]>
</point>
  <point name="input.body3.b_insert" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                          ]]>
</point>
  <point name="input.body3.b_update" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                          ]]>
</point>
  <point name="input.body3.before_input" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.body3.before_insert" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.body3.before_row" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.body3.insert.after_set_entry_b" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.body3.m_delete" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                          ]]>
</point>
  <point name="input.body3.m_update" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                          ]]>
</point>
  <point name="input.body4.a_delete" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                  DELETE FROM xmeh_t 
                   WHERE xmehent = g_enterprise 
                     AND xmehdocno = g_xmee_m.xmeedocno 
                     AND xmehseq = g_xmeg4_d_t.xmjbseq
                  IF SQLCA.sqlcode THEN
                     CALL cl_err("xmeh_t",SQLCA.sqlcode,1)
                     CALL s_transaction_end('N','0')
                     CANCEL DELETE
                  END IF 
                  #刪除訂單多交期匯總檔
                  LET l_cnt = 0
                  SELECT COUNT(*) INTO l_cnt
                    FROM xmdf_t
                   WHERE xmdfent = g_enterprise 
                     AND xmdfdocno = g_xmee_m.xmeedocno 
                     AND xmdfseq = g_xmeg4_d_t.xmjbseq
                  IF l_cnt > 0 THEN                     
                     DELETE FROM xmdf_t 
                      WHERE xmdfent = g_enterprise 
                        AND xmdfdocno = g_xmee_m.xmeedocno 
                        AND xmdfseq = g_xmeg4_d_t.xmjbseq
                     IF SQLCA.sqlcode THEN
                        CALL cl_err("xmdf_t",SQLCA.sqlcode,1)
                        CALL s_transaction_end('N','0')
                        CANCEL DELETE
                     END IF           
                  END IF  
                  #刪除訂單單身明細
                  LET l_cnt = 0
                  SELECT COUNT(*) INTO l_cnt
                    FROM xmeg_t
                   WHERE xmegent = g_enterprise 
                     AND xmegdocno = g_xmee_m.xmeedocno 
                     AND xmegseq = g_xmeg4_d_t.xmjbseq
                  IF l_cnt > 0 THEN                     
                     DELETE FROM xmeg_t 
                      WHERE xmegent = g_enterprise 
                        AND xmegdocno = g_xmee_m.xmeedocno 
                        AND xmegseq = g_xmeg4_d_t.xmjbseq
                     IF SQLCA.sqlcode THEN
                        CALL cl_err("xmeg_t",SQLCA.sqlcode,1)
                        CALL s_transaction_end('N','0')
                        CANCEL DELETE
                     END IF           
                  END IF
                  #刪除變更歷程檔
                  DELETE FROM xmek_t
                   WHERE xmekent = g_enterprise
                     AND xmekdocno = g_xmee_m.xmeedocno 
                     AND xmek001 =  g_xmee_m.xmee900
                     AND xmekseq = g_xmeg4_d_t.xmjbseq
                  IF SQLCA.sqlcode THEN
                     CALL cl_err("xmek_t",SQLCA.sqlcode,1)
                     CALL s_transaction_end('N','0')
                     CANCEL DELETE
                  END IF  
                  LET l_delete =TRUE]]>
</point>
  <point name="input.body4.a_update" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[               IF NOT s_adbt510_upd_xmeg(g_xmee_m.xmeedocno,g_xmeg4_d[l_ac].xmjbseq,g_xmee_m.xmee900) THEN
                  CALL cl_err("xmeg_t",SQLCA.sqlcode,1)
                  LET g_xmeg4_d[l_ac].* = g_xmeg4_d_t.*
                  CALL s_transaction_end('N','0')
               END IF
               
               IF NOT s_adbt510_gen_xmeh(g_xmee_m.xmeedocno,g_xmeg4_d[l_ac].xmjbseq,g_xmee_m.xmee900) THEN
                  CALL cl_err("xmeh_t",SQLCA.sqlcode,1)
                  LET g_xmeg4_d[l_ac].* = g_xmeg4_d_t.*
                  CALL s_transaction_end('N','0')
               END IF 

               #將單身資料寫入歷程檔中               
               IF NOT adbt510_xmjb_ins_xmek(g_xmeg4_d[l_ac].*) THEN
                  LET g_xmeg4_d[l_ac].* = g_xmeg4_d_t.*
                  CALL s_transaction_end('N','0')
               END IF 
               IF NOT adbt510_xmeg_ins_xmek(g_xmee_m.xmeedocno,g_xmeg4_d[l_ac].xmjbseq,g_xmee_m.xmee900) THEN
                  LET g_xmeg4_d[l_ac].* = g_xmeg4_d_t.*
                  CALL s_transaction_end('N','0')
               END IF
               CALL adbt510_gen_xmej(2) RETURNING l_success
               IF NOT l_success THEN
                  CALL cl_err("xmej_t",SQLCA.sqlcode,1)
                  LET g_xmeg4_d[l_ac].* = g_xmeg4_d_t.*
                  CALL s_transaction_end('N','0')
               END IF ]]>
</point>
  <point name="input.body4.after_insert" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[]]>
</point>
  <point name="input.body4.after_row" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            IF NOT INT_FLAG THEN
               LET l_ac = ARR_CURR()
               IF (l_cmd='u' AND l_delete = FALSE) OR (l_cmd='a' AND l_insert = FALSE) THEN
                  CALL adbt510_gen_xmej(1) RETURNING l_success
                  IF NOT l_success THEN
                     CALL cl_err("xmdf_t",SQLCA.sqlcode,1)
                     LET g_xmeg4_d[l_ac].* = g_xmeg4_d_t.*
                     CALL s_transaction_end('N','0')
                  END IF
               END IF
            END IF]]>
</point>
  <point name="input.body4.after_row2" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            ]]>
</point>
  <point name="input.body4.after_set_entry_b" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[               CALL adbt510_set_no_required_b()
               CALL adbt510_set_required_b()]]>
</point>
  <point name="input.body4.b_a_insert" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[ ]]>
</point>
  <point name="input.body4.b_delete" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[]]>
</point>
  <point name="input.body4.b_update" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[               IF g_xmeg4_d[l_ac].xmjb901 = '1' THEN
                  LET g_xmeg4_d[l_ac].xmjb901 = '2'
               END IF ]]>
</point>
  <point name="input.body4.before_input" cite_std="N" status="" ver="3" src="s" new="N" mark_hard="N">
<![CDATA[]]>
</point>
  <point name="input.body4.before_insert" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[]]>
</point>
  <point name="input.body4.before_row2" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            LET l_delete =FALSE]]>
</point>
  <point name="input.body4.insert.after_set_entry_b" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[]]>
</point>
  <point name="input.body5.action" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                      ]]>
</point>
  <point name="input.body5.before_row" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.body6.action" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[      DISPLAY ARRAY g_xmeg7_d TO s_detail7.* ATTRIBUTES(COUNT=g_rec_b)  
    
         BEFORE ROW
            CALL adbt510_idx_chk()
            LET l_ac = DIALOG.getCurrentRow("s_detail7")
            LET g_detail_idx = l_ac
            
            
         BEFORE DISPLAY
            CALL FGL_SET_ARR_CURR(g_detail_idx)
            LET l_ac = DIALOG.getCurrentRow("s_detail7")
            CALL adbt510_idx_chk()
            LET g_current_page = 6
      
      END DISPLAY]]>
</point>
  <point name="input.c.page1.imaal004" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.c.page1.xmeg001" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmeg_d[l_ac].xmeg001             #給予default值

            #給予arg
            LET l_sql = ''
            CALL s_control_get_sql("imaa001",'6','2',g_user,g_dept)     #銷售控制組檢核
              RETURNING l_success,l_sql
            IF l_success THEN
               LET g_qryparam.where = l_sql
            END IF

            LET l_sql = ''
            CALL s_control_get_doc_sql("imaf016",g_xmee_m.xmeedocno,'4')   #產品生命週期檢核
              RETURNING l_success,l_sql
            IF l_success THEN
               LET g_qryparam.where = g_qryparam.where ," AND ",l_sql
            END IF

            LET l_sql = ''
            CALL s_control_get_doc_sql("imaa009",g_xmee_m.xmeedocno,'5')   #產品料檢核
              RETURNING l_success,l_sql
            IF l_success THEN
               LET g_qryparam.where = g_qryparam.where ," AND ",l_sql
            END IF
            
            CALL q_imaa001()                                #呼叫開窗

            LET g_xmeg_d[l_ac].xmeg001 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmeg_d[l_ac].xmeg001 TO xmeg001              #顯示到畫面上

            NEXT FIELD xmeg001                          #返回原欄位

]]>
</point>
  <point name="input.c.page1.xmeg002" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            LET l_imaa005 = ''
            CALL adbt510_get_imaa005(g_enterprise,g_xmeg_d[l_ac].xmeg001) RETURNING l_imaa005

            IF NOT cl_null(l_imaa005) THEN
               IF l_cmd = 'u' OR (l_cmd = 'a' AND NOT cl_null(g_xmeg_d[l_ac].xmeg002)) THEN
                  CALL s_feature_single(g_xmeg_d[l_ac].xmeg001,g_xmeg_d[l_ac].xmeg002,g_site,g_xmee_m.xmeedocno)
                       RETURNING l_success,g_xmeg_d[l_ac].xmeg002
                  #依交易對象、料號、產品特徵回傳客戶料號
                  CALL s_apmi070_get_pmao004(g_xmee_m.xmee004,g_xmeg_d[l_ac].xmeg001,g_xmeg_d[l_ac].xmeg002)
                    RETURNING r_success,l_pmao004
                  IF r_success THEN
                     LET g_xmeg_d[l_ac].xmeg027 = l_pmao004
                     DISPLAY BY NAME g_xmeg_d[l_ac].xmeg027
                  END IF                       
                  DISPLAY BY NAME g_xmeg_d[l_ac].xmeg002
               END IF
            END IF                                                                        ]]>
</point>
  <point name="input.c.page1.xmeg004" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmeg_d[l_ac].xmeg004             #給予default值

            #給予arg
            LET g_qryparam.arg1 = '221' #

            CALL q_oocq002()                                #呼叫開窗

            LET g_xmeg_d[l_ac].xmeg004 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmeg_d[l_ac].xmeg004 TO xmeg004              #顯示到畫面上

            NEXT FIELD xmeg004                          #返回原欄位

]]>
</point>
  <point name="input.c.page1.xmeg005" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.c.page1.xmeg006" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmeg_d[l_ac].xmeg006             #給予default值

            #給予arg

            CALL q_ooca001_1()                                #呼叫開窗

            LET g_xmeg_d[l_ac].xmeg006 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmeg_d[l_ac].xmeg006 TO xmeg006              #顯示到畫面上

            NEXT FIELD xmeg006                          #返回原欄位

]]>
</point>
  <point name="input.c.page1.xmeg007" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.c.page1.xmeg008" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmeg_d[l_ac].xmeg008             #給予default值

            #給予arg

            CALL q_ooca001_1()                                #呼叫開窗

            LET g_xmeg_d[l_ac].xmeg008 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmeg_d[l_ac].xmeg008 TO xmeg008              #顯示到畫面上

            NEXT FIELD xmeg008                          #返回原欄位

]]>
</point>
  <point name="input.c.page1.xmeg009" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.c.page1.xmeg010" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmeg_d[l_ac].xmeg010             #給予default值

            #給予arg

            CALL q_ooca001_1()                                #呼叫開窗

            LET g_xmeg_d[l_ac].xmeg010 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmeg_d[l_ac].xmeg010 TO xmeg010              #顯示到畫面上

            NEXT FIELD xmeg010                          #返回原欄位

]]>
</point>
  <point name="input.c.page1.xmeg011" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.c.page1.xmeg012" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.c.page1.xmeg013" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.c.page1.xmeg015" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.c.page1.xmeg016" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmeg_d[l_ac].xmeg016             #給予default值
            LET g_qryparam.where = " oodb005 = '",g_oodb005,"'"
            #給予arg

            CALL q_oodb002_2()                                #呼叫開窗

            LET g_xmeg_d[l_ac].xmeg016 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmeg_d[l_ac].xmeg016 TO xmeg016              #顯示到畫面上

            NEXT FIELD xmeg016                          #返回原欄位

]]>
</point>
  <point name="input.c.page1.xmeg019" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.c.page1.xmeg020" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.c.page1.xmeg021" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.c.page1.xmeg022" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.c.page1.xmeg023" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmeg_d[l_ac].xmeg023             #給予default值


            #給予arg
            LET g_qryparam.arg1 = g_xmee_m.xmee004

            CALL q_pmac002_5()                             #呼叫開窗

            LET g_xmeg_d[l_ac].xmeg023 = g_qryparam.return1              #將開窗取得的值回傳到變數
            #LET g_xmeg_d[l_ac].pmaal004 = g_qryparam.return2 #交易對象簡稱

            DISPLAY g_xmeg_d[l_ac].xmeg023 TO xmeg023              #顯示到畫面上
            #DISPLAY g_xmeg_d[l_ac].pmaal004 TO pmaal004 #交易對象簡稱

            NEXT FIELD xmeg023                          #返回原欄位

]]>
</point>
  <point name="input.c.page1.xmeg024" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.c.page1.xmeg027" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmeg_d[l_ac].xmeg027             #給予default值

            IF cl_null(g_xmeg_d[l_ac].xmeg001) OR cl_null(g_xmeg_d[l_ac].xmeg002) THEN
               #給予arg
               LET g_qryparam.arg1 = g_xmee_m.xmee004 
               CALL q_pmao004_2()                                #呼叫開窗
            ELSE            
               #給予arg
               LET g_qryparam.arg1 = g_xmee_m.xmee004
               LET g_qryparam.arg2 = g_xmeg_d[l_ac].xmeg001
               LET g_qryparam.arg3 = g_xmeg_d[l_ac].xmeg002
               CALL q_pmao004_1()                                #呼叫開窗
            END IF
            LET g_xmeg_d[l_ac].xmeg027 = g_qryparam.return1              #將開窗取得的值回傳到變數
            DISPLAY g_xmeg_d[l_ac].xmeg027 TO xmeg027

            NEXT FIELD xmeg027                          #返回原欄位

]]>
</point>
  <point name="input.c.page1.xmeg045" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.c.page1.xmeg049" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmeg_d[l_ac].xmeg049             #給予default值

            #給予arg
            LET g_qryparam.arg1 = g_acc

            CALL q_oocq002()                                #呼叫開窗

            LET g_xmeg_d[l_ac].xmeg049 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmeg_d[l_ac].xmeg049 TO xmeg049              #顯示到畫面上

            NEXT FIELD xmeg049                          #返回原欄位

]]>
</point>
  <point name="input.c.page1.xmeg050" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.c.page1.xmeg052" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.c.page1.xmeg053" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmeg_d[l_ac].xmeg053             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "" #

            CALL q_oocq002()                                #呼叫開窗

            LET g_xmeg_d[l_ac].xmeg053 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmeg_d[l_ac].xmeg053 TO xmeg053              #顯示到畫面上

            NEXT FIELD xmeg053                          #返回原欄位

]]>
</point>
  <point name="input.c.page1.xmeg902" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmeg_d[l_ac].xmeg902             #給予default值
            LET g_qryparam.default2 = "" #g_xmeg_d[l_ac].oocq002 #應用分類碼
            #給予arg
            LET g_qryparam.arg1 = "" #

            
            CALL q_oocq002()                                #呼叫開窗

            LET g_xmeg_d[l_ac].xmeg902 = g_qryparam.return1              
            #LET g_xmeg_d[l_ac].oocq002 = g_qryparam.return2 
            DISPLAY g_xmeg_d[l_ac].xmeg902 TO xmeg902              #
            #DISPLAY g_xmeg_d[l_ac].oocq002 TO oocq002 #應用分類碼
            NEXT FIELD xmeg902                          #返回原欄位

]]>
</point>
  <point name="input.c.page1.xmegorga" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmeg_d[l_ac].xmegorga             #給予default值

            #給予arg

            CALL q_ooef001()                                #呼叫開窗

            LET g_xmeg_d[l_ac].xmegorga = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmeg_d[l_ac].xmegorga TO xmegorga              #顯示到畫面上

            NEXT FIELD xmegorga                          #返回原欄位

]]>
</point>
  <point name="input.c.page1.xmegseq" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.c.page1.xmegunit" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmeg_d[l_ac].xmegunit             #給予default值

            #給予arg

            CALL q_ooef001()                                #呼叫開窗

            LET g_xmeg_d[l_ac].xmegunit = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmeg_d[l_ac].xmegunit TO xmegunit              #顯示到畫面上

            NEXT FIELD xmegunit                          #返回原欄位

]]>
</point>
  <point name="input.c.page1.xmjb002" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmjb_d[l_ac].xmjb002             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "" #

            
            CALL q_imay003_6()                                #呼叫開窗

            LET g_xmjb_d[l_ac].xmjb002 = g_qryparam.return1              

            DISPLAY g_xmjb_d[l_ac].xmjb002 TO xmjb002              #

            NEXT FIELD xmjb002                          #返回原欄位

]]>
</point>
  <point name="input.c.page1.xmjb003" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmjb_d[l_ac].xmjb003             #給予default值
            LET g_qryparam.default2 = "" #g_xmjb_d[l_ac].imaal003 #品名
            LET g_qryparam.default3 = "" #g_xmjb_d[l_ac].imaal004 #規格
            #給予arg
            LET g_qryparam.arg1 = "" #

            
            CALL q_imaa001()                                #呼叫開窗

            LET g_xmjb_d[l_ac].xmjb003 = g_qryparam.return1              
            #LET g_xmjb_d[l_ac].imaal003 = g_qryparam.return2 
            #LET g_xmjb_d[l_ac].imaal004 = g_qryparam.return3 
            DISPLAY g_xmjb_d[l_ac].xmjb003 TO xmjb003              #
            #DISPLAY g_xmjb_d[l_ac].imaal003 TO imaal003 #品名
            #DISPLAY g_xmjb_d[l_ac].imaal004 TO imaal004 #規格
            NEXT FIELD xmjb003                          #返回原欄位

]]>
</point>
  <point name="input.c.page1.xmjb005" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmjb_d[l_ac].xmjb005             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "" #

            
            CALL q_prcf001_1()                                #呼叫開窗

            LET g_xmjb_d[l_ac].xmjb005 = g_qryparam.return1              

            DISPLAY g_xmjb_d[l_ac].xmjb005 TO xmjb005              #

            NEXT FIELD xmjb005                          #返回原欄位

]]>
</point>
  <point name="input.c.page1.xmjb006" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmjb_d[l_ac].xmjb006             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "" #

            
            CALL q_oodb002_2()                                #呼叫開窗

            LET g_xmjb_d[l_ac].xmjb006 = g_qryparam.return1              

            DISPLAY g_xmjb_d[l_ac].xmjb006 TO xmjb006              #

            NEXT FIELD xmjb006                          #返回原欄位

]]>
</point>
  <point name="input.c.page1.xmjb011" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmjb_d[l_ac].xmjb011             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "" #

            
            CALL q_ooca001_1()                                #呼叫開窗

            LET g_xmjb_d[l_ac].xmjb011 = g_qryparam.return1              

            DISPLAY g_xmjb_d[l_ac].xmjb011 TO xmjb011              #

            NEXT FIELD xmjb011                          #返回原欄位

]]>
</point>
  <point name="input.c.page1.xmjb013" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmjb_d[l_ac].xmjb013             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "" #

            
            CALL q_ooca001_1()                                #呼叫開窗

            LET g_xmjb_d[l_ac].xmjb013 = g_qryparam.return1              

            DISPLAY g_xmjb_d[l_ac].xmjb013 TO xmjb013              #

            NEXT FIELD xmjb013                          #返回原欄位

]]>
</point>
  <point name="input.c.page1.xmjb015" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmjb_d[l_ac].xmjb015             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "" #

            
            CALL q_ooca001_1()                                #呼叫開窗

            LET g_xmjb_d[l_ac].xmjb015 = g_qryparam.return1              

            DISPLAY g_xmjb_d[l_ac].xmjb015 TO xmjb015              #

            NEXT FIELD xmjb015                          #返回原欄位

]]>
</point>
  <point name="input.c.page1.xmjb017" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmjb_d[l_ac].xmjb017             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "" #

            
            CALL q_ooca001_1()                                #呼叫開窗

            LET g_xmjb_d[l_ac].xmjb017 = g_qryparam.return1              

            DISPLAY g_xmjb_d[l_ac].xmjb017 TO xmjb017              #

            NEXT FIELD xmjb017                          #返回原欄位

]]>
</point>
  <point name="input.c.page1.xmjb024" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmjb_d[l_ac].xmjb024             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "" #

            
            CALL q_pmaa001_18()                                #呼叫開窗

            LET g_xmjb_d[l_ac].xmjb024 = g_qryparam.return1              

            DISPLAY g_xmjb_d[l_ac].xmjb024 TO xmjb024              #

            NEXT FIELD xmjb024                          #返回原欄位

]]>
</point>
  <point name="input.c.page1.xmjb026" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmjb_d[l_ac].xmjb026             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "" #

            
            CALL q_oofb019()                                #呼叫開窗

            LET g_xmjb_d[l_ac].xmjb026 = g_qryparam.return1              

            DISPLAY g_xmjb_d[l_ac].xmjb026 TO xmjb026              #

            NEXT FIELD xmjb026                          #返回原欄位

]]>
</point>
  <point name="input.c.page1.xmjb033" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmjb_d[l_ac].xmjb033             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "" #
            LET g_qryparam.arg2 = "" #
            LET g_qryparam.arg3 = "" #
            
            CALL q_pmao004_1()                                #呼叫開窗

            LET g_xmjb_d[l_ac].xmjb033 = g_qryparam.return1              

            DISPLAY g_xmjb_d[l_ac].xmjb033 TO xmjb033              #

            NEXT FIELD xmjb033                          #返回原欄位

]]>
</point>
  <point name="input.c.page2.xmee0272" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmeg2_d[l_ac].xmee0272             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "" #
            LET g_qryparam.arg2 = "" #
            LET g_qryparam.arg3 = "" #

            CALL q_pmao004_1()                                #呼叫開窗

            LET g_xmeg2_d[l_ac].xmee0272 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmeg2_d[l_ac].xmee0272 TO xmee0272              #顯示到畫面上

            NEXT FIELD xmee0272                          #返回原欄位

]]>
</point>
  <point name="input.c.page2.xmeg003" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.c.page2.xmeg025" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[]]>
</point>
  <point name="input.c.page2.xmeg026" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[]]>
</point>
  <point name="input.c.page2.xmeg027" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmeg2_d[l_ac].xmeg027             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "" #
            LET g_qryparam.arg2 = "" #
            LET g_qryparam.arg3 = "" #

            CALL q_pmao004_1()                                #呼叫開窗

            LET g_xmeg2_d[l_ac].xmeg027 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmeg2_d[l_ac].xmeg027 TO xmeg027              #顯示到畫面上

            NEXT FIELD xmeg027                          #返回原欄位

]]>
</point>
  <point name="input.c.page2.xmeg0272" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmeg2_d[l_ac].xmeg0272             #給予default值

            IF cl_null(g_xmeg_d[l_ac].xmeg001) OR cl_null(g_xmeg_d[l_ac].xmeg002) THEN
               #給予arg
               LET g_qryparam.arg1 = g_xmee_m.xmee004 
               CALL q_pmao004_2()                                #呼叫開窗
            ELSE            
               #給予arg
               LET g_qryparam.arg1 = g_xmee_m.xmee004
               LET g_qryparam.arg2 = g_xmeg_d[l_ac].xmeg001
               LET g_qryparam.arg3 = g_xmeg_d[l_ac].xmeg002
               CALL q_pmao004_1()                                #呼叫開窗
            END IF                               #呼叫開窗

            LET g_xmeg2_d[l_ac].xmeg0272 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmeg2_d[l_ac].xmeg0272 TO xmeg0272              #顯示到畫面上

            NEXT FIELD xmeg0272                          #返回原欄位

]]>
</point>
  <point name="input.c.page2.xmeg028" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmeg2_d[l_ac].xmeg028             #給予default值

            #給予arg
            LET g_qryparam.arg1 = g_site #

            CALL q_inaa001_6()                                #呼叫開窗

            LET g_xmeg2_d[l_ac].xmeg028 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmeg2_d[l_ac].xmeg028 TO xmeg028              #顯示到畫面上

            NEXT FIELD xmeg028                          #返回原欄位

]]>
</point>
  <point name="input.c.page2.xmeg029" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmeg2_d[l_ac].xmeg029             #給予default值

            #給予arg
            LET g_qryparam.arg1 = g_site #
            LET g_qryparam.arg2 = g_xmeg2_d[l_ac].xmeg028 #

            CALL q_inab002_6()                                #呼叫開窗

            LET g_xmeg2_d[l_ac].xmeg029 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmeg2_d[l_ac].xmeg029 TO xmeg029              #顯示到畫面上

            NEXT FIELD xmeg029                          #返回原欄位

]]>
</point>
  <point name="input.c.page2.xmeg030" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.c.page2.xmeg031" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmeg2_d[l_ac].xmeg031            #給予default值

            #給予arg
            LET g_qryparam.arg1 = "263" #

            CALL q_oocq002()                                #呼叫開窗

            LET g_xmeg2_d[l_ac].xmeg031 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmeg2_d[l_ac].xmeg031 TO xmee031              #顯示到畫面上
            CALL adbt510_xmee020_ref(g_xmeg2_d[l_ac].xmeg031) RETURNING g_xmeg2_d[l_ac].xmeg031_desc
            DISPLAY BY NAME g_xmeg2_d[l_ac].xmeg031_desc                                                                        ]]>
</point>
  <point name="input.c.page2.xmeg032" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.c.page2.xmeg033" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.c.page2.xmeg034" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.c.page2.xmeg036" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.c.page2.xmeg037" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.c.page2.xmeg038" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.c.page2.xmeg039" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.c.page3.xmeg012" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.c.page3.xmeg013" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.c.page3.xmeh001" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmeg3_d[l_ac].xmeh001             #給予default值

            #給予arg

            CALL q_imaa001()                                #呼叫開窗

            LET g_xmeg3_d[l_ac].xmeh001 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmeg3_d[l_ac].xmeh001 TO xmeh001              #顯示到畫面上

            NEXT FIELD xmeh001                          #返回原欄位

]]>
</point>
  <point name="input.c.page3.xmeh004" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmeg3_d[l_ac].xmeh004             #給予default值

            #給予arg

            CALL q_ooca001_1()                                #呼叫開窗

            LET g_xmeg3_d[l_ac].xmeh004 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmeg3_d[l_ac].xmeh004 TO xmeh004              #顯示到畫面上

            NEXT FIELD xmeh004                          #返回原欄位

]]>
</point>
  <point name="input.c.page3.xmeh017" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmeg3_d[l_ac].xmeh017             #給予default值

            #給予arg

            CALL q_oodb002_2()                                #呼叫開窗

            LET g_xmeg3_d[l_ac].xmeh017 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmeg3_d[l_ac].xmeh017 TO xmeh017              #顯示到畫面上

            NEXT FIELD xmeh017                          #返回原欄位

]]>
</point>
  <point name="input.c.page3.xmeh022" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmeg3_d[l_ac].xmeh022             #給予default值

            #給予arg

            CALL q_ooag001()                                #呼叫開窗

            LET g_xmeg3_d[l_ac].xmeh022 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmeg3_d[l_ac].xmeh022 TO xmeh022              #顯示到畫面上

            NEXT FIELD xmeh022                          #返回原欄位

]]>
</point>
  <point name="input.c.page3.xmeh024" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmeg3_d[l_ac].xmeh024             #給予default值

            #給予arg

            CALL q_ooca001_1()                                #呼叫開窗

            LET g_xmeg3_d[l_ac].xmeh024 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmeg3_d[l_ac].xmeh024 TO xmeh024              #顯示到畫面上

            NEXT FIELD xmeh024                          #返回原欄位

]]>
</point>
  <point name="input.c.page3.xmeh026" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmeg3_d[l_ac].xmeh026             #給予default值

            #給予arg

            CALL q_ooca001_1()                                #呼叫開窗

            LET g_xmeg3_d[l_ac].xmeh026 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmeg3_d[l_ac].xmeh026 TO xmeh026              #顯示到畫面上

            NEXT FIELD xmeh026                          #返回原欄位

]]>
</point>
  <point name="input.c.page4.xmde001" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmeg4_d[l_ac].xmde001             #給予default值

            #給予arg

            CALL q_imaa001()                                #呼叫開窗

            LET g_xmeg4_d[l_ac].xmde001 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmeg4_d[l_ac].xmde001 TO xmde001              #顯示到畫面上

            NEXT FIELD xmde001                          #返回原欄位

]]>
</point>
  <point name="input.c.page4.xmde003" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmeg4_d[l_ac].xmde003             #給予default值

            #給予arg

            CALL q_xmdadocno()                                #呼叫開窗

            LET g_xmeg4_d[l_ac].xmde003 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmeg4_d[l_ac].xmde003 TO xmde003              #顯示到畫面上

            NEXT FIELD xmde003                          #返回原欄位

]]>
</point>
  <point name="input.c.page4.xmde008" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmeg4_d[l_ac].xmde008             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "" #

            CALL q_oocq002()                                #呼叫開窗

            LET g_xmeg4_d[l_ac].xmde008 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmeg4_d[l_ac].xmde008 TO xmde008              #顯示到畫面上

            NEXT FIELD xmde008                          #返回原欄位

]]>
</point>
  <point name="input.c.page4.xmde022" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmeg4_d[l_ac].xmde022             #給予default值

            #給予arg

            CALL q_ooca001_1()                                #呼叫開窗

            LET g_xmeg4_d[l_ac].xmde022 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmeg4_d[l_ac].xmde022 TO xmde022              #顯示到畫面上

            NEXT FIELD xmde022                          #返回原欄位

]]>
</point>
  <point name="input.c.page4.xmeg027" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmjb4_d[l_ac].xmeg027             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "" #
            LET g_qryparam.arg2 = "" #
            LET g_qryparam.arg3 = "" #
            
            CALL q_pmao004_1()                                #呼叫開窗

            LET g_xmjb4_d[l_ac].xmeg027 = g_qryparam.return1              

            DISPLAY g_xmjb4_d[l_ac].xmeg027 TO xmeg027              #

            NEXT FIELD xmeg027                          #返回原欄位

]]>
</point>
  <point name="input.c.page4.xmjb002" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmeg4_d[l_ac].xmjb002             #給予default值

            #給予arg
            
            CALL q_imay003_6()                                #呼叫開窗

            LET g_xmeg4_d[l_ac].xmjb002 = g_qryparam.return1              

            DISPLAY g_xmeg4_d[l_ac].xmjb002 TO xmjb002              #
            
            NEXT FIELD xmjb002                          #返回原欄位

]]>
</point>
  <point name="input.c.page4.xmjb003" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmeg4_d[l_ac].xmjb003             #給予default值
            LET g_qryparam.default2 = "" #g_xmeg4_d[l_ac].imaal003 #品名
            LET g_qryparam.default3 = "" #g_xmeg4_d[l_ac].imaal004 #規格
            #給予arg

            
            CALL q_imaa001()                                #呼叫開窗

            LET g_xmeg4_d[l_ac].xmjb003 = g_qryparam.return1              
            #LET g_xmeg4_d[l_ac].imaal003 = g_qryparam.return2 
            #LET g_xmeg4_d[l_ac].imaal004 = g_qryparam.return3 
            DISPLAY g_xmeg4_d[l_ac].xmjb003 TO xmjb003              #
            #DISPLAY g_xmeg4_d[l_ac].imaal003 TO imaal003 #品名
            #DISPLAY g_xmeg4_d[l_ac].imaal004 TO imaal004 #規格
            CALL adbt510_xmjb003_ref()
            NEXT FIELD xmjb003                          #返回原欄位

]]>
</point>
  <point name="input.c.page4.xmjb004" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            LET l_imaa005 = ''
            CALL adbt510_get_imaa005(g_enterprise,g_xmeg4_d[l_ac].xmjb003) RETURNING l_imaa005

            IF NOT cl_null(l_imaa005) THEN
               IF l_cmd = 'u' OR (l_cmd = 'a' AND NOT cl_null(g_xmeg4_d[l_ac].xmjb004)) THEN
                  CALL s_feature_single(g_xmeg4_d[l_ac].xmjb003,g_xmeg4_d[l_ac].xmjb004,g_xmee_m.xmeesite,g_xmee_m.xmeedocno)
                       RETURNING l_success,g_xmeg4_d[l_ac].xmjb004
                  #依交易對象、料號、產品特徵回傳客戶料號
                  CALL s_apmi070_get_pmao004(g_xmee_m.xmee004,g_xmeg4_d[l_ac].xmjb003,g_xmeg4_d[l_ac].xmjb004)
                    RETURNING r_success,l_pmao004
                  IF r_success THEN
                     LET g_xmeg4_d[l_ac].xmjb033 = l_pmao004
                     DISPLAY BY NAME g_xmeg4_d[l_ac].xmjb033
                  END IF                       
                  DISPLAY BY NAME g_xmeg4_d[l_ac].xmjb004
               END IF
            END IF  ]]>
</point>
  <point name="input.c.page4.xmjb005" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmeg4_d[l_ac].xmjb005             #給予default值

            #給予arg

            
            CALL q_prcf001_1()                                #呼叫開窗

            LET g_xmeg4_d[l_ac].xmjb005 = g_qryparam.return1              

            DISPLAY g_xmeg4_d[l_ac].xmjb005 TO xmjb005              #
            CALL adbt510_xmjb005_ref()
            NEXT FIELD xmjb005                          #返回原欄位

]]>
</point>
  <point name="input.c.page4.xmjb006" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmeg4_d[l_ac].xmjb006             #給予default值

            #給予arg
            
            CALL q_oodb002_2()                                #呼叫開窗

            LET g_xmeg4_d[l_ac].xmjb006 = g_qryparam.return1              

            DISPLAY g_xmeg4_d[l_ac].xmjb006 TO xmjb006              #
            CALL adbt510_xmjb006_ref()
            NEXT FIELD xmjb006                          #返回原欄位

]]>
</point>
  <point name="input.c.page4.xmjb011" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmeg4_d[l_ac].xmjb011             #給予default值

            #給予arg

            CALL q_ooca001_1()                                #呼叫開窗

            LET g_xmeg4_d[l_ac].xmjb011 = g_qryparam.return1              

            DISPLAY g_xmeg4_d[l_ac].xmjb011 TO xmjb011              #
            CALL adbt510_xmjb011_ref()
            NEXT FIELD xmjb011                          #返回原欄位

]]>
</point>
  <point name="input.c.page4.xmjb013" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmeg4_d[l_ac].xmjb013             #給予default值

            #給予arg

            CALL q_ooca001_1()                                #呼叫開窗

            LET g_xmeg4_d[l_ac].xmjb013 = g_qryparam.return1              

            DISPLAY g_xmeg4_d[l_ac].xmjb013 TO xmjb013              #
            CALL adbt510_xmjb013_ref()
            NEXT FIELD xmjb013                          #返回原欄位

]]>
</point>
  <point name="input.c.page4.xmjb015" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmeg4_d[l_ac].xmjb015             #給予default值

            #給予arg

            CALL q_ooca001_1()                                #呼叫開窗

            LET g_xmeg4_d[l_ac].xmjb015 = g_qryparam.return1              

            DISPLAY g_xmeg4_d[l_ac].xmjb015 TO xmjb015              #
            CALL adbt510_xmjb015_ref()
            NEXT FIELD xmjb015                          #返回原欄位

]]>
</point>
  <point name="input.c.page4.xmjb017" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmeg4_d[l_ac].xmjb017             #給予default值

            #給予arg
 
            CALL q_ooca001_1()                                #呼叫開窗

            LET g_xmeg4_d[l_ac].xmjb017 = g_qryparam.return1              

            DISPLAY g_xmeg4_d[l_ac].xmjb017 TO xmjb017              #
            CALL adbt510_xmjb017_ref()
            NEXT FIELD xmjb017                          #返回原欄位

]]>
</point>
  <point name="input.c.page4.xmjb024" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmeg4_d[l_ac].xmjb024             #給予default值

            #給予arg

            
            CALL q_pmaa001_18()                                #呼叫開窗

            LET g_xmeg4_d[l_ac].xmjb024 = g_qryparam.return1              

            DISPLAY g_xmeg4_d[l_ac].xmjb024 TO xmjb024              #
            CALL adbt510_xmjb024_ref()
            NEXT FIELD xmjb024                          #返回原欄位

]]>
</point>
  <point name="input.c.page4.xmjb026" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmeg4_d[l_ac].xmjb026             #給予default值
            
            #給予arg
            CALL adbt510_get_pmaa027(g_xmeg4_d[l_ac].xmjb025) RETURNING l_pmaa027_1
            LET g_qryparam.arg1 = l_pmaa027_1

            
            CALL q_oofb019()                                #呼叫開窗

            LET g_xmeg4_d[l_ac].xmjb026 = g_qryparam.return1              

            DISPLAY g_xmeg4_d[l_ac].xmjb026 TO xmjb026              #
            CALL adbt510_xmjb026_ref()
            NEXT FIELD xmjb026                          #返回原欄位

]]>
</point>
  <point name="input.c.page4.xmjb027" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmeg4_d[l_ac].xmjb027             #給予default值

            #給予arg
            
            CALL q_dbad001()                                #呼叫開窗

            LET g_xmeg4_d[l_ac].xmjb027 = g_qryparam.return1              

            DISPLAY g_xmeg4_d[l_ac].xmjb027 TO xmjb027              #
            CALL adbt510_xmjb027_ref()
            NEXT FIELD xmjb027                          #返回原欄位

]]>
</point>
  <point name="input.c.page4.xmjb033" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmeg4_d[l_ac].xmjb033             #給予default值
            
            IF cl_null(g_xmeg4_d[l_ac].xmjb003) OR cl_null(g_xmeg4_d[l_ac].xmjb004) THEN
               #給予arg
               LET g_qryparam.arg1 = g_xmee_m.xmee004 
               CALL q_pmao004_2()                                #呼叫開窗
            ELSE  
               #給予arg
               LET g_qryparam.arg1 = g_xmee_m.xmee004
               LET g_qryparam.arg2 = g_xmeg4_d[l_ac].xmjb003
               LET g_qryparam.arg3 = g_xmeg4_d[l_ac].xmjb004
            
               CALL q_pmao004_1()                                #呼叫開窗
            END IF
            LET g_xmeg4_d[l_ac].xmjb033 = g_qryparam.return1              

            DISPLAY g_xmeg4_d[l_ac].xmjb033 TO xmjb033              #

            NEXT FIELD xmjb033                          #返回原欄位

]]>
</point>
  <point name="input.c.page4.xmjb902" cite_std="N" status="u" ver="2" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmeg4_d[l_ac].xmjb902             #給予default值
            LET g_qryparam.default2 = "" #g_xmeg4_d[l_ac].oocq002 #應用分類碼
            #給予arg
            LET g_qryparam.arg1 = '267' #

            
            CALL q_oocq002()                                #呼叫開窗

            LET g_xmeg4_d[l_ac].xmjb902 = g_qryparam.return1              
            DISPLAY g_xmeg4_d[l_ac].xmjb902 TO xmjb902              #
            CALL adbt510_xmjb902_ref()
            NEXT FIELD xmjb902                          #返回原欄位

]]>
</point>
  <point name="input.c.page4.xmjbsite" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmeg4_d[l_ac].xmjbsite             #給予default值

            #給予arg
			   LET g_qryparam.arg1 = g_xmee_m.xmeesite
			   LET g_qryparam.arg2 = '2'
            
            CALL q_ooed004_3()                                #呼叫開窗

            LET g_xmeg4_d[l_ac].xmjbsite = g_qryparam.return1              

            DISPLAY g_xmeg4_d[l_ac].xmjbsite TO xmjbsite              #
            CALL adbt510_xmjbsite_ref()
            NEXT FIELD xmjbsite                          #返回原欄位

]]>
</point>
  <point name="input.c.page5.xmef002" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmeg5_d[l_ac].xmef002             #給予default值

            #給予arg
            LET g_qryparam.arg1 = g_xmee_m.xmee004

            CALL q_pmad002_3()                                #呼叫開窗

            LET g_xmeg5_d[l_ac].xmef002 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmeg5_d[l_ac].xmef002 TO xmef002              #顯示到畫面上

            NEXT FIELD xmef002                          #返回原欄位

]]>
</point>
  <point name="input.c.page5.xmef902" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmeg5_d[l_ac].xmef902             #給予default值
            LET g_qryparam.default2 = "" #g_xmeg5_d[l_ac].oocq002 #應用分類碼
            #給予arg
            LET g_qryparam.arg1 = "" #

            
            CALL q_oocq002()                                #呼叫開窗

            LET g_xmeg5_d[l_ac].xmef902 = g_qryparam.return1              
            #LET g_xmeg5_d[l_ac].oocq002 = g_qryparam.return2 
            DISPLAY g_xmeg5_d[l_ac].xmef902 TO xmef902              #
            #DISPLAY g_xmeg5_d[l_ac].oocq002 TO oocq002 #應用分類碼
            NEXT FIELD xmef902                          #返回原欄位

]]>
</point>
  <point name="input.c.page8.xmeg027" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmeg8_d[l_ac].xmeg027             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "" #
            LET g_qryparam.arg2 = "" #
            LET g_qryparam.arg3 = "" #
            
            CALL q_pmao004_1()                                #呼叫開窗

            LET g_xmeg8_d[l_ac].xmeg027 = g_qryparam.return1              

            DISPLAY g_xmeg8_d[l_ac].xmeg027 TO xmeg027              #

            NEXT FIELD xmeg027                          #返回原欄位

]]>
</point>
  <point name="input.c.xmee001" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.c.xmee002" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmee_m.xmee002             #給予default值

            #給予arg

            CALL q_ooag001()                                #呼叫開窗

            LET g_xmee_m.xmee002 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmee_m.xmee002 TO xmee002              #顯示到畫面上

            NEXT FIELD xmee002                          #返回原欄位

]]>
</point>
  <point name="input.c.xmee003" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmee_m.xmee003             #給予default值

            #給予arg
            LET g_qryparam.arg1 = g_xmee_m.xmeedocdt

            CALL q_ooeg001()                                #呼叫開窗

            LET g_xmee_m.xmee003 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmee_m.xmee003 TO xmee003              #顯示到畫面上

            NEXT FIELD xmee003                          #返回原欄位

]]>
</point>
  <point name="input.c.xmee004" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE
            LET g_qryparam.where = "1=1 "            

            CALL s_control_get_sql("pmaa001",'2','2',g_user,g_dept)
                 RETURNING l_success,g_qryparam.where
            IF NOT l_success THEN
               LET g_qryparam.where = ''
            END IF            
            LET g_qryparam.default1 = g_xmee_m.xmee004             #給予default值

            #給予arg

            CALL q_pmaa001_6()                                #呼叫開窗

            LET g_xmee_m.xmee004 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmee_m.xmee004 TO xmee004              #顯示到畫面上

            NEXT FIELD xmee004                          #返回原欄位

]]>
</point>
  <point name="input.c.xmee005" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.c.xmee006" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.c.xmee007" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.c.xmee008" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #開窗i段
		   	INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			   LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmee_m.xmee008             #給予default值


            #給予arg
            LET g_qryparam.arg1 = g_xmee_m.xmeesite
            LET g_qryparam.arg2 = '2'

            CALL q_xmdkdocno_4()                                #呼叫開窗

            LET g_xmee_m.xmee008 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmee_m.xmee008 TO xmee008              #顯示到畫面上

            NEXT FIELD xmee008                          #返回原欄位                                                            ]]>
</point>
  <point name="input.c.xmee009" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmee_m.xmee009             #給予default值

            #給予arg
            LET g_qryparam.arg1 = g_xmee_m.xmee021

            CALL q_pmad002_3()                                 #呼叫開窗

            LET g_xmee_m.xmee009 = g_qryparam.return1          #將開窗取得的值回傳到變數

            DISPLAY g_xmee_m.xmee009 TO xmee009                #顯示到畫面上
            CALL adbt510_xmee009_ref(g_xmee_m.xmee009) RETURNING g_xmee_m.xmee009_desc
            DISPLAY BY NAME g_xmee_m.xmee009_desc
            NEXT FIELD xmee009                                 #返回原欄位
  
]]>
</point>
  <point name="input.c.xmee010" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmee_m.xmee010             #給予default值

            #給予arg
			LET g_qryparam.arg1 = '238'
            CALL q_oocq002()                                #呼叫開窗

            LET g_xmee_m.xmee010 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmee_m.xmee010 TO xmee010              #顯示到畫面上
            CALL adbt510_xmee010_ref(g_xmee_m.xmee010) RETURNING g_xmee_m.xmee010_desc
            DISPLAY BY NAME g_xmee_m.xmee010_desc
            NEXT FIELD xmee010                          #返回原欄位

]]>
</point>
  <point name="input.c.xmee011" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmee_m.xmee011             #給予default值

            #給予arg
            LET g_qryparam.arg1 = g_xmee_m.xmeesite

            CALL q_oodb002_3()                                #呼叫開窗

            LET g_xmee_m.xmee011 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmee_m.xmee011 TO xmee011              #顯示到畫面上
            CALL adbt510_xmee011_ref(g_xmee_m.xmee011) RETURNING g_xmee_m.xmee011_desc
            DISPLAY BY NAME g_xmee_m.xmee011_desc
            NEXT FIELD xmee011                          #返回原欄位

]]>
</point>
  <point name="input.c.xmee012" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.c.xmee013" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.c.xmee015" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmee_m.xmee015             #給予default值

            #給予arg
            LET g_qryparam.arg1 = g_xmee_m.xmeesite
            CALL q_ooaj002_2()                                 #呼叫開窗

            LET g_xmee_m.xmee015 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmee_m.xmee015 TO xmee015              #顯示到畫面上
            CALL adbt510_xmee015_ref(g_xmee_m.xmee015) RETURNING g_xmee_m.xmee015_desc
            DISPLAY BY NAME g_xmee_m.xmee015_desc

            NEXT FIELD xmee015                          #返回原欄位

]]>
</point>
  <point name="input.c.xmee016" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.c.xmee017" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmee_m.xmee017             #給予default值

            #給予arg

            CALL q_xmah001()                                #呼叫開窗

            LET g_xmee_m.xmee017 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmee_m.xmee017 TO xmee017              #顯示到畫面上

            NEXT FIELD xmee017                               #返回原欄位
            CALL adbt510_xmee017_ref(g_xmee_m.xmee017) RETURNING g_xmee_m.xmee017_desc
            DISPLAY BY NAME g_xmee_m.xmee017_desc
]]>
</point>
  <point name="input.c.xmee018" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmee_m.xmee018             #給予default值

            #給予arg

            CALL q_ooid001_1()                                #呼叫開窗

            LET g_xmee_m.xmee018 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmee_m.xmee018 TO xmee018              #顯示到畫面上
            CALL adbt510_xmee018_ref(g_xmee_m.xmee018) RETURNING g_xmee_m.xmee018_desc
            DISPLAY BY NAME g_xmee_m.xmee018_desc
            NEXT FIELD xmee018                          #返回原欄位

]]>
</point>
  <point name="input.c.xmee019" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.c.xmee020" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmee_m.xmee020             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "263" #

            CALL q_oocq002()                                #呼叫開窗

            LET g_xmee_m.xmee020 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmee_m.xmee020 TO xmee020              #顯示到畫面上
            CALL adbt510_xmee020_ref(g_xmee_m.xmee020) RETURNING g_xmee_m.xmee020_desc
            DISPLAY BY NAME g_xmee_m.xmee020_desc
            NEXT FIELD xmee020                          #返回原欄位

]]>
</point>
  <point name="input.c.xmee021" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmee_m.xmee021             #給予default值


            #給予arg
            LET g_qryparam.arg1 = g_xmee_m.xmee004

            CALL q_pmac002_5()                                #呼叫開窗

            LET g_xmee_m.xmee021 = g_qryparam.return1              #將開窗取得的值回傳到變數
            #LET g_xmee_m.pmaal004 = g_qryparam.return2 #交易對象簡稱

            DISPLAY g_xmee_m.xmee021 TO xmee021              #顯示到畫面上
            #DISPLAY g_xmee_m.pmaal004 TO pmaal004 #交易對象簡稱

            NEXT FIELD xmee021                          #返回原欄位

]]>
</point>
  <point name="input.c.xmee022" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmee_m.xmee022             #給予default值
            LET g_qryparam.default2 = ""                           #g_xmee_m.pmaal004 #交易對象簡稱

            #給予arg
            LET g_qryparam.arg1 = g_xmee_m.xmee004 #


            CALL q_pmac002_6()                                #呼叫開窗

            LET g_xmee_m.xmee022 = g_qryparam.return1              #將開窗取得的值回傳到變數
            #LET g_xmee_m.pmaal004 = g_qryparam.return2 #交易對象簡稱

            DISPLAY g_xmee_m.xmee022 TO xmee022              #顯示到畫面上
            #DISPLAY g_xmee_m.pmaal004 TO pmaal004 #交易對象簡稱

            NEXT FIELD xmee022                          #返回原欄位

]]>
</point>
  <point name="input.c.xmee023" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        #此段落由子樣板a07產生            
            #開窗i段
			   INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			   LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmee_m.xmee023             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "1"
            CALL q_oojd001_1()                                #呼叫開窗

            LET g_xmee_m.xmee023 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmee_m.xmee023 TO xmee023              #顯示到畫面上
            CALL adbt510_xmee023_ref(g_xmee_m.xmee023) RETURNING g_xmee_m.xmee023_desc
            DISPLAY BY NAME g_xmee_m.xmee023_desc
            NEXT FIELD xmee023                          #返回原欄位

]]>
</point>
  <point name="input.c.xmee024" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmee_m.xmee024             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "295"

            CALL q_oocq002()                                #呼叫開窗

            LET g_xmee_m.xmee024 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmee_m.xmee024 TO xmee024              #顯示到畫面上
            CALL adbt510_xmee024_ref(g_xmee_m.xmee024) RETURNING g_xmee_m.xmee024_desc
            DISPLAY BY NAME g_xmee_m.xmee024_desc
            NEXT FIELD xmee024                          #返回原欄位

]]>
</point>
  <point name="input.c.xmee025" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmee_m.xmee025             #給予default值
            LET g_qryparam.where = " oofb008 = '3' "               #聯絡地址
            #給予arg
			   LET g_qryparam.arg1 = l_pmaa027
            CALL q_oofb019_1()                                     #呼叫開窗
            LET g_xmee_m.xmee025 = g_qryparam.return1              #將開窗取得的值回傳到變數
            DISPLAY g_xmee_m.xmee025 TO xmee025                    #顯示到畫面上
            CALL adbt510_xmee025_ref(l_pmaa027,g_xmee_m.xmee025) RETURNING g_xmee_m.xmee025_desc
            DISPLAY BY NAME g_xmee_m.xmee025_desc
            NEXT FIELD xmee025                                     #返回原欄位

]]>
</point>
  <point name="input.c.xmee026" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_xmee_m.xmee026             #給予default值

            #給予arg
			LET g_qryparam.arg1 = l_pmaa027
            LET g_qryparam.where = " oofb008 = '5' "          #聯絡地址
            CALL q_oofb019_1()                                #呼叫開窗

            LET g_xmee_m.xmee026 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmee_m.xmee026 TO xmee026              #顯示到畫面上
            CALL adbt510_xmee026_ref(l_pmaa027,g_xmee_m.xmee026) RETURNING g_xmee_m.xmee026_desc
            DISPLAY BY NAME g_xmee_m.xmee026_desc
            NEXT FIELD xmee026                          #返回原欄位

]]>
</point>
  <point name="input.c.xmee027" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmee_m.xmee027             #給予default值

            #給予arg
            LET g_qryparam.arg1 = g_xmee_m.xmee004 #

            CALL q_pmaj002()                                #呼叫開窗

            LET g_xmee_m.xmee027 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmee_m.xmee027 TO xmee027              #顯示到畫面上
            CALL adbt510_xmee027_ref(g_xmee_m.xmee027) RETURNING g_xmee_m.xmee027_desc
            DISPLAY BY NAME g_xmee_m.xmee027_desc
            NEXT FIELD xmee027                          #返回原欄位

]]>
</point>
  <point name="input.c.xmee028" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.c.xmee030" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.c.xmee031" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.c.xmee032" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmee_m.xmee032             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "297"

            CALL q_oocq002()                                #呼叫開窗

            LET g_xmee_m.xmee032 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmee_m.xmee032 TO xmee032              #顯示到畫面上
            CALL adbt510_xmee032_ref(g_xmee_m.xmee032) RETURNING g_xmee_m.xmee032_desc
            DISPLAY BY NAME g_xmee_m.xmee032_desc
            NEXT FIELD xmee032                          #返回原欄位

]]>
</point>
  <point name="input.c.xmee033" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.c.xmee034" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmee_m.xmee034             #給予default值
            CALL q_pmaa001_6()                                #呼叫開窗
            LET g_xmee_m.xmee034 = g_qryparam.return1              #將開窗取得的值回傳到變數
            DISPLAY g_xmee_m.xmee034 TO xmee034              #顯示到畫面上
            NEXT FIELD xmee034                          #返回原欄位

]]>
</point>
  <point name="input.c.xmee035" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmee_m.xmee035             #給予default值


            #給予arg
            SELECT ooef019 INTO l_ooef019 FROM ooef_t WHERE ooefent = g_enterprise AND ooef001 = g_xmee_m.xmeesite
            LET g_qryparam.arg1 = l_ooef019 
            LET g_qryparam.arg2 = "2" 
            CALL q_isac002_1()                            #呼叫開窗

            LET g_xmee_m.xmee035 = g_qryparam.return1              #將開窗取得的值回傳到變數
            CALL adbt510_xmee035_ref(g_xmee_m.xmee035) RETURNING g_xmee_m.xmee035_desc
            DISPLAY BY NAME g_xmee_m.xmee035_desc           

            DISPLAY g_xmee_m.xmee035 TO xmee035              #顯示到畫面上
           

            NEXT FIELD xmee035                          #返回原欄位

]]>
</point>
  <point name="input.c.xmee036" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmee_m.xmee036             #給予default值

            #給予arg

            CALL q_pmaa001_3()                                #呼叫開窗

            LET g_xmee_m.xmee036 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmee_m.xmee036 TO xmee036              #顯示到畫面上

            NEXT FIELD xmee036                          #返回原欄位

]]>
</point>
  <point name="input.c.xmee037" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                    #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_xmee_m.xmee037

            IF NOT cl_null(g_xmee_m.xmee020) THEN
               SELECT oocq019 INTO l_oocq019
                 FROM oocq_t WHERE oocq001='263' AND oocq002= g_xmee_m.xmee020
            END IF

            IF NOT cl_null(l_oocq019) THEN  #運輸類型
               CASE
                  WHEN l_oocq019 ='1' OR l_oocq019='4'
                     CALL q_oock004()

                  WHEN l_oocq019 ='2'
                     CALL q_oocq002_10()

                  WHEN l_oocq019 ='3'
                     CALL q_oocq002_12()

               END CASE
            END IF


            LET g_xmee_m.xmee037 = g_qryparam.return1              #將開窗取得的值回傳到變數       
            DISPLAY g_xmee_m.xmee037 TO xmee037
            NEXT FIELD xmee037                  ]]>
</point>
  <point name="input.c.xmee038" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                    #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_xmee_m.xmee038

            IF NOT cl_null(g_xmee_m.xmee020) THEN
               SELECT oocq019 INTO l_oocq019
                 FROM oocq_t WHERE oocq001='263' AND oocq002= g_xmee_m.xmee020
            END IF

            IF NOT cl_null(l_oocq019) THEN  #運輸類型
               CASE
                  WHEN l_oocq019 ='1' OR l_oocq019='4'
                     CALL q_oock004()

                  WHEN l_oocq019 ='2'
                     CALL q_oocq002_10()

                  WHEN l_oocq019 ='3'
                     CALL q_oocq002_12()

               END CASE
            END IF


            LET g_xmee_m.xmee038 = g_qryparam.return1              #將開窗取得的值回傳到變數       
            DISPLAY g_xmee_m.xmee038 TO xmee038
            NEXT FIELD xmee038           ]]>
</point>
  <point name="input.c.xmee039" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.c.xmee043" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.c.xmee044" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmee_m.xmee044             #給予default值

            #給予arg
            LET g_qryparam.arg1 = g_xmee_m.xmee004 #

            CALL q_itcf002()                                       #呼叫開窗

            LET g_xmee_m.xmee044 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmee_m.xmee044 TO xmee044              #顯示到畫面上

            NEXT FIELD xmee044                          #返回原欄位

]]>
</point>
  <point name="input.c.xmee200" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmee_m.xmee200             #給予default值

            #給予arg

            CALL q_pmaa001_20()                                #呼叫開窗

            LET g_xmee_m.xmee200 = g_qryparam.return1              

            DISPLAY g_xmee_m.xmee200 TO xmee200              #
            CALL adbt510_xmee200_ref()
            NEXT FIELD xmee200                          #返回原欄位

]]>
</point>
  <point name="input.c.xmee201" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmee_m.xmee201             #給予default值

            #給予arg
            
            CALL q_pmaa001_10()                                #呼叫開窗

            LET g_xmee_m.xmee201 = g_qryparam.return1              

            DISPLAY g_xmee_m.xmee201 TO xmee201              #
            CALL adbt510_xmee201_ref()
            NEXT FIELD xmee201                          #返回原欄位

]]>
</point>
  <point name="input.c.xmee202" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmee_m.xmee202             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "G" #

            
            CALL q_ooef001_3()                                #呼叫開窗

            LET g_xmee_m.xmee202 = g_qryparam.return1              

            DISPLAY g_xmee_m.xmee202 TO xmee202              #
            CALL adbt510_xmee202_ref()
            NEXT FIELD xmee202                          #返回原欄位

]]>
</point>
  <point name="input.c.xmee203" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmee_m.xmee203             #給予default值
            LET g_qryparam.default2 = "" #g_xmee_m.pmaal004 #交易對象簡稱
            #給予arg
            LET g_qryparam.arg1 = g_xmee_m.xmee004
            LET g_qryparam.arg2 = '3'
            
            CALL q_pmac002_9()                                #呼叫開窗

            LET g_xmee_m.xmee203 = g_qryparam.return1              
            #LET g_xmee_m.pmaal004 = g_qryparam.return2 
            DISPLAY g_xmee_m.xmee203 TO xmee203              #
            #DISPLAY g_xmee_m.pmaal004 TO pmaal004 #交易對象簡稱
            CALL adbt510_xmee203_ref()
            NEXT FIELD xmee203                          #返回原欄位

]]>
</point>
  <point name="input.c.xmee204" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmee_m.xmee204             #給予default值

            #給予arg
            
            CALL q_prcf001_1()                                #呼叫開窗

            LET g_xmee_m.xmee204 = g_qryparam.return1              

            DISPLAY g_xmee_m.xmee204 TO xmee204              #
            CALL adbt510_xmee204_ref()
            NEXT FIELD xmee204                          #返回原欄位

]]>
</point>
  <point name="input.c.xmee903" cite_std="N" status="u" ver="2" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmee_m.xmee903             #給予default值
            LET g_qryparam.default2 = "" #g_xmee_m.oocq002 #應用分類碼
            #給予arg
            LET g_qryparam.arg1 = '267' #

            
            CALL q_oocq002()                                #呼叫開窗

            LET g_xmee_m.xmee903 = g_qryparam.return1             
            DISPLAY g_xmee_m.xmee903 TO xmee903              #
            CALL adbt510_xmee903_ref()
            NEXT FIELD xmee903                          #返回原欄位

]]>
</point>
  <point name="input.c.xmeedocdt" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.c.xmeedocno" cite_std="N" status="" ver="3" src="s" new="N" mark_hard="N">
<![CDATA[            #開窗i段
			   INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			   LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_xmee_m.xmeedocno             #給予default值

            #給予arg
            LET g_qryparam.arg1 = g_xmee_m.xmeesite
            CALL q_xmdadocno_5()                                #呼叫開窗

            LET g_xmee_m.xmeedocno = g_qryparam.return1            #將開窗取得的值回傳到變數
            DISPLAY g_xmee_m.xmeedocno TO xmeedocno              #顯示到畫面上
            NEXT FIELD xmeedocno                          #返回原欄位
]]>
</point>
  <point name="input.c.xmeesite" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #開窗i段
			   INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			   LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmee_m.xmeesite             #給予default值

            #給予arg
            LET g_qryparam.arg1 = g_site
            LET g_qryparam.arg2 = '2'

            CALL q_ooed004_3()                                #呼叫開窗

            LET g_xmee_m.xmeesite = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmee_m.xmeesite TO xmeesite              #顯示到畫面上
            CALL adbt510_xmeesite_ref()
            NEXT FIELD xmeesite                          #返回原欄位                                                           ]]>
</point>
  <point name="input.c.xmeestus" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.c.xmeeunit" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmee_m.xmeeunit             #給予default值

            #給予arg
            LET g_qryparam.arg1 = '2'
            
            CALL q_ooed004_2()                                #呼叫開窗

            LET g_xmee_m.xmeeunit = g_qryparam.return1              

            DISPLAY g_xmee_m.xmeeunit TO xmeeunit              #
            CALL adbt510_xmeeunit_ref()
            NEXT FIELD xmeeunit                          #返回原欄位

]]>
</point>
  <point name="input.d.before_input" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            RETURN                                                         ]]>
</point>
  <point name="input.define" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[   DEFINE  l_success    LIKE type_t.num5
   DEFINE  l_flag       LIKE type_t.num5
   DEFINE  l_rate       LIKE inaj_t.inaj014
   DEFINE  l_sql        STRING
   DEFINE  l_sql1       STRING
   DEFINE  l_sql2       STRING             
   DEFINE  l_ooef004    LIKE ooef_t.ooef004
   DEFINE  l_ooef016    LIKE ooef_t.ooef016
   DEFINE  l_pmaa004    LIKE pmaa_t.pmaa004 
   DEFINE  l_pmaa027    LIKE pmaa_t.pmaa027 
   DEFINE  l_pmaa027_1  LIKE pmaa_t.pmaa027 
   DEFINE  l_pmaa002    LIKE pmaa_t.pmaa002
   DEFINE  l_oocq019    LIKE oocq_t.oocq019   
   DEFINE  l_xmah004    LIKE xmah_t.xmah004
   DEFINE  l_xmah005    LIKE xmah_t.xmah005
   DEFINE  l_xmah006    LIKE xmah_t.xmah006   
   DEFINE  l_pmao002    LIKE pmao_t.pmao002
   DEFINE  l_pmao003    LIKE pmao_t.pmao003 
   DEFINE  l_pmao004    LIKE pmao_t.pmao004 
   DEFINE  l_imaf062    LIKE imaf_t.imaf062   
   DEFINE  r_success    LIKE type_t.num5 
   DEFINE  r_address    STRING     
   DEFINE  l_imaa005    LIKE imaa_t.imaa005
   DEFINE  l_oodbl004   LIKE oodbl_t.oodbl004  #稅別名稱
   DEFINE  l_oodb005    LIKE oodb_t.oodb005    #含稅否
   DEFINE  l_oodb006    LIKE oodb_t.oodb006    #稅率 
   DEFINE  l_oodb011    LIKE oodb_t.oodb011    #取得稅別類型1:正常稅率2:依料件設定   
   DEFINE  l_imaa143    LIKE imaa_t.imaa143
   DEFINE  l_ooef019    LIKE ooef_t.ooef019
   DEFINE  l_delete     LIKE type_t.num5
   DEFINE l_slip        LIKE ooba_t.ooba001
   DEFINE l_para_data   LIKE type_t.chr80
   DEFINE l_pmaa248     LIKE pmaa_t.pmaa248
   DEFINE l_stce005     LIKE stce_t.stce005]]>
</point>
  <point name="input.define_sql" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                  ]]>
</point>
  <point name="input.define_sql2" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                  ]]>
</point>
  <point name="input.define_sql3" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                  ]]>
</point>
  <point name="input.g.page1.imaal004" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.g.page1.xmeg001" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.g.page1.xmeg002" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.g.page1.xmeg004" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.g.page1.xmeg005" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.g.page1.xmeg006" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.g.page1.xmeg007" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.g.page1.xmeg008" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.g.page1.xmeg009" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.g.page1.xmeg010" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.g.page1.xmeg011" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.g.page1.xmeg012" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.g.page1.xmeg013" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.g.page1.xmeg015" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.g.page1.xmeg016" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.g.page1.xmeg019" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.g.page1.xmeg020" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.g.page1.xmeg021" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.g.page1.xmeg022" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.g.page1.xmeg023" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.g.page1.xmeg024" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                         ]]>
</point>
  <point name="input.g.page1.xmeg027" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.g.page1.xmeg045" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.g.page1.xmeg049" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.g.page1.xmeg050" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.g.page1.xmeg052" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.g.page1.xmegorga" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.g.page1.xmegseq" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.g.page1.xmegunit" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.g.page2.xmeg003" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.g.page2.xmeg025" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.g.page2.xmeg026" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.g.page2.xmeg0272" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.g.page2.xmeg028" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.g.page2.xmeg029" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.g.page2.xmeg030" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.g.page2.xmeg031" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.g.page2.xmeg032" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.g.page2.xmeg033" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.g.page2.xmeg034" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.g.page2.xmeg036" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.g.page2.xmeg037" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.g.page2.xmeg038" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.g.page2.xmeg039" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.g.page3.xmeg012" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.g.page3.xmeg013" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.g.page4.xmjb002" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[]]>
</point>
  <point name="input.g.xmee001" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.g.xmee002" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.g.xmee003" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.g.xmee004" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.g.xmee005" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            CALL adbt510_set_entry(p_cmd)
            CALL adbt510_set_no_entry(p_cmd)          ]]>
</point>
  <point name="input.g.xmee006" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.g.xmee007" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.g.xmee008" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.g.xmee009" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.g.xmee010" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.g.xmee011" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.g.xmee012" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.g.xmee013" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.g.xmee015" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.g.xmee016" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.g.xmee017" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.g.xmee018" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.g.xmee019" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.g.xmee020" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.g.xmee021" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.g.xmee022" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.g.xmee023" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.g.xmee024" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.g.xmee025" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.g.xmee026" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.g.xmee027" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.g.xmee028" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.g.xmee030" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.g.xmee031" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.g.xmee032" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.g.xmee033" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.g.xmee034" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.g.xmee035" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.g.xmee036" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.g.xmee037" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.g.xmee038" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.g.xmee039" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.g.xmee043" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.g.xmee044" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.g.xmeedocdt" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.g.xmeedocno" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.g.xmeesite" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.g.xmeestus" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="input.head.a_insert" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[               IF NOT adbt510_upd_xmee901() THEN
                  CONTINUE DIALOG
               END IF                                                                       ]]>
</point>
  <point name="input.head.a_update" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[               IF NOT adbt510_upd_xmee901() THEN
                  CONTINUE DIALOG
               END IF                                                                      ]]>
</point>
  <point name="input.head.b_insert" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            ]]>
</point>
  <point name="input.head.b_update" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                          ]]>
</point>
  <point name="input.head.m_insert" cite_std="N" status="" ver="3" src="s" new="N" mark_hard="N">
<![CDATA[               #將單身資料新增到資料庫內
               IF NOT adbt510_ins_xmjb() THEN
                  CALL s_transaction_end('N','0')
                  CONTINUE DIALOG
               END IF 
               #將單身資料新增到資料庫內
               IF NOT adbt510_ins_xmeg() THEN
                  CALL s_transaction_end('N','0')
                  CONTINUE DIALOG
               END IF               
               #將多期預收款資料新增到資料庫內 
               IF NOT adbt510_ins_xmef() THEN
                  CALL s_transaction_end('N','0')
                  CONTINUE DIALOG
               END IF                 
               #將交期明細資料新增到資料庫內
               IF NOT adbt510_ins_xmeh() THEN
                  CALL s_transaction_end('N','0')
                  CONTINUE DIALOG
               END IF               
               #將交期明細匯總檔資料新增到資料庫內
               IF NOT adbt510_ins_xmej() THEN
                  CALL s_transaction_end('N','0')
                  CONTINUE DIALOG
               END IF   
               #單頭unit變更
               IF (g_xmee_m.xmeeunit <> g_xmee_m_t.xmeeunit OR
                  (cl_null(g_xmee_m.xmeeunit) AND NOT cl_null(g_xmee_m_t.xmeeunit)) OR
                  (NOT cl_null(g_xmee_m.xmeeunit) AND cl_null(g_xmee_m_t.xmeeunit))) AND g_upd_unit = 'Y' THEN
                  IF NOT adbt510_upd_unit() THEN
                     CALL s_transaction_end('N','0')
                     CONTINUE DIALOG
                  END IF
               END IF                ]]>
</point>
  <point name="input.head.m_update" cite_std="N" status="" ver="3" src="s" new="N" mark_hard="N">
<![CDATA[               IF g_xmee_m.xmee022 <> g_xmee_m_t.xmee022 THEN
                  CALL adbt510_change_xmee022()
               END IF 
               IF (g_xmee_m.xmeeunit <> g_xmee_m_t.xmeeunit OR
                  (cl_null(g_xmee_m.xmeeunit) AND NOT cl_null(g_xmee_m_t.xmeeunit)) OR
                  (NOT cl_null(g_xmee_m.xmeeunit) AND cl_null(g_xmee_m_t.xmeeunit))) AND g_upd_unit = 'Y' THEN
                  IF NOT adbt510_upd_unit() THEN
                     CALL s_transaction_end('N','0')
                     CONTINUE DIALOG
                  END IF
               END IF                  ]]>
</point>
  <point name="input.m.before_input" cite_std="N" status="" ver="2" src="s" new="N" mark_hard="N">
<![CDATA[            LET g_upd_unit = 'N'                                                      ]]>
</point>
  <point name="input.more_input" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                    ]]>
</point>
  <point name="input.other_sql" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[   LET g_flag2 = FALSE]]>
</point>
  <point name="insert.after_insert" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                    ]]>
</point>
  <point name="insert.default" cite_std="N" status="" ver="3" src="s" new="N" mark_hard="N">
<![CDATA[      CALL s_hint_show('xmek_t','xmee_t',' ',' ','','','')
      CALL s_hint_show('xmek_t','xmef_t',' ',' ','','','')
      #CALL s_hint_show('xmek_t','xmeg_t',' ',' ','','','')
      #CALL s_hint_show('xmek_t','xmeh_t',' ',' ','','','')
      CALL s_hint_show('xmek_t','xmjb_t',' ',' ','','','')
      
      INITIALIZE g_xmee_m_t.* TO NULL
      #LET g_xmee_m.xmeedocdt = g_today
      LET g_xmee_m.xmeesite = g_site
      LET g_xmee_m.xmee902 = g_today
      LET g_xmee_m_o.* = g_xmee_m.*              #舊值備份      ]]>
</point>
  <point name="insert.define" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[           ]]>
</point>
  <point name="insert_b.after_insert" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                    ]]>
</point>
  <point name="insert_b.after_insert2" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                    ]]>
</point>
  <point name="insert_b.after_insert3" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                    ]]>
</point>
  <point name="insert_b.before_insert" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                    ]]>
</point>
  <point name="insert_b.before_insert2" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                    ]]>
</point>
  <point name="insert_b.before_insert3" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                    ]]>
</point>
  <point name="insert_b.define" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                  ]]>
</point>
  <point name="insert_b.m_insert" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                    ]]>
</point>
  <point name="insert_b.m_insert2" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                    ]]>
</point>
  <point name="insert_b.m_insert3" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                    ]]>
</point>
  <point name="insert_b.other" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                  ]]>
</point>
  <point name="lock_b.define" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                  ]]>
</point>
  <point name="lock_b.other" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                  ]]>
</point>
  <point name="main.after_define_sql" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                  ]]>
</point>
  <point name="main.before_close" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                    ]]>
</point>
  <point name="main.define" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                  ]]>
</point>
  <point name="main.define_sql" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                  ]]>
</point>
  <point name="main.exit" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                  ]]>
</point>
  <point name="main.init" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[   #獲取當前營運據點的聯絡對象識別碼
   LET g_oofa001 = ''
   SELECT oofa001 INTO g_oofa001 FROM oofa_t WHERE oofaent = g_enterprise AND oofa002 = '1' AND oofa003 = g_site
   
   #獲得當前營運據點的所屬稅區
   LET g_ooef019 = ''
   SELECT ooef019 INTO g_ooef019 FROM ooef_t WHERE ooefent = g_enterprise AND ooef001 = g_site

   LET g_acc = ''
   #抓取[T:系統分類值檔].[C:系統分類碼]=24且[T:系統分類值檔].[C:系統分類碼]=g_prog 的[T:系統分類值檔].[C:參考欄位>
   SELECT gzcb004 INTO g_acc FROM gzcb_t WHERE gzcb001 = '24' AND gzcb002 = g_prog
   
   LET g_flag1 = FALSE
   ]]>
</point>
  <point name="main.servicecall" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                    ]]>
</point>
  <point name="menu.default.insert" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="menu.delete" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                          ]]>
</point>
  <point name="menu.detail_show.page3.adbt510_04" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[               IF l_ac > 0 THEN
                  CALL adbt500_04(g_xmee_m.xmeedocno,g_xmeg4_d[l_ac].xmjbseq,g_xmeg4_d[l_ac].xmjbsite)
               END IF]]>
</point>
  <point name="menu.detail_show.page3.open_adbt510_03" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[               IF l_ac > 0 THEN
                  IF NOT cl_null(g_xmeg4_d[l_ac].xmjbseq) THEN
                     CALL adbt510_03(g_xmee_m.xmeedocno,g_xmeg4_d[l_ac].xmjbseq,g_xmee_m.xmee900,g_xmeg4_d[l_ac].xmjb018,g_xmeg4_d[l_ac].xmjb030,g_xmeg4_d[l_ac].xmjbsite)
                     RETURNING g_xmeg4_d[l_ac].xmjb031,g_xmeg4_d[l_ac].xmjb032
                     DISPLAY BY NAME g_xmeg4_d[l_ac].xmjb031,g_xmeg4_d[l_ac].xmjb032
                     IF NOT cl_null(g_xmeg4_d[l_ac].xmjb031) AND NOT cl_null(g_xmeg4_d[l_ac].xmjb032) THEN
                        UPDATE xmjb_t
                           SET xmjb031 = g_xmeg4_d[l_ac].xmjb031,
                               xmjb032 = g_xmeg4_d[l_ac].xmjb032,
                               xmjb901 = '2'
                         WHERE xmjbent = g_enterprise
                           AND xmjbdocno = g_xmee_m.xmeedocno
                           AND xmjbseq = g_xmeg4_d[l_ac].xmjbseq
                           AND xmjb900 = g_xmee_m.xmee900
                     END IF
                     CALL s_adbt510_gen_xmeh(g_xmee_m.xmeedocno,g_xmeg4_d[l_ac].xmjbseq,g_xmee_m.xmee900) RETURNING l_success 
                  END IF
               END IF]]>
</point>
  <point name="menu.detail_show.page3.open_adbt510_04" cite_std="N" status="" ver="3" src="s" new="N" mark_hard="N">
<![CDATA[               IF l_ac > 0 THEN
                  CALL adbt510_04(g_xmee_m.xmeedocno,g_xmee_m.xmee900,g_xmeg4_d[l_ac].xmjbseq,g_xmeg4_d[l_ac].xmjbsite)
               END IF]]>
</point>
  <point name="menu.insert" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                          ]]>
</point>
  <point name="menu.modify" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                          ]]>
</point>
  <point name="menu.modify_detail" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                          ]]>
</point>
  <point name="menu.open_adbt510_02" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[               CALL adbt500_02(g_xmee_m.xmeedocno)]]>
</point>
  <point name="menu.open_apmi004_01" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[               #若輸入供應商的法人類型為'2:一次性交易'或是'4:內部員工'時，則自動串apmi004_01
               #維護一次性交易對項基本資料，維護完基本資料後會回傳一個一次性交易對象識別碼，
               #將識別碼值預設給xmee028欄位
               IF NOT cl_null(g_xmee_m.xmee004) THEN
                  LET l_pmaa004 = ''
                  SELECT pmaa004 INTO l_pmaa004 FROM pmaa_t WHERE pmaaent = g_enterprise AND pmaa001 = g_xmee_m.xmee004
                  IF l_pmaa004 = '2' THEN   #一次性交易對象
                     CALL apmi004_01('1','',g_xmee_m.xmee004,g_xmee_m.xmeedocno) RETURNING g_xmee_m.xmee028
                  END IF
                  IF l_pmaa004 = '4' THEN   #內部員工
                     CALL apmi004_01('2','',g_xmee_m.xmee004,g_xmee_m.xmeedocno) RETURNING g_xmee_m.xmee028
                  END IF                      
               END IF   ]]>
</point>
  <point name="menu.open_s_pay" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[               DECLARE adbt510_pay_cl1 CURSOR FOR
               SELECT rtiadocno 
                 FROM rtia_t
                WHERE rtiaent = g_enterprise
                  AND rtia007 = g_xmee_m.xmeedocno
                  AND rtiastus <> 'X'
               OPEN adbt510_pay_cl1
               FETCH adbt510_pay_cl1 INTO l_rtiadocno
               CLOSE adbt510_pay_cl1
               IF NOT cl_null(l_rtiadocno) THEN
                  CALL s_pay(l_rtiadocno)
                  LET g_action_choice= ""
               END IF]]>
</point>
  <point name="menu.open_s_pay09" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[               DECLARE adbt510_pay_cl2 CURSOR FOR
               SELECT rtiadocno 
                 FROM rtia_t
                WHERE rtiaent = g_enterprise
                  AND rtia007 = g_xmee_m.xmeedocno
                  AND rtiastus <> 'X'
               OPEN adbt510_pay_cl2
               FETCH adbt510_pay_cl2 INTO l_rtiadocno
               CLOSE adbt510_pay_cl2
               IF NOT cl_null(l_rtiadocno) THEN
                  CALL s_pay_09(l_rtiadocno)
                  LET g_action_choice= ""
               END IF]]>
</point>
  <point name="menu.open_xmef" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[               CALL adbt510_open_xmef()
               LET INT_FLAG = FALSE]]>
</point>
  <point name="menu.open_xmef_w" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[               CALL adbt510_open_xmef()]]>
</point>
  <point name="menu.output" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                          ]]>
</point>
  <point name="menu.query" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                          ]]>
</point>
  <point name="menu.reproduce" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                          ]]>
</point>
  <point name="modify.after_input" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                    ]]>
</point>
  <point name="modify.before_input" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[      LET g_xmee_m_o.* = g_xmee_m.*  #舊值備份
      #「D抽單 / R已拒絕」狀況碼更改資料後，需還原為「N未確認」
      IF g_xmee_m.xmeestus MATCHES "[DR]" THEN 
         LET g_xmee_m.xmeestus = "N"
      END IF
]]>
</point>
  <point name="modify.body.a_fk_update" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                      ]]>
</point>
  <point name="modify.body.a_fk_update2" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                      ]]>
</point>
  <point name="modify.body.a_fk_update3" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                      ]]>
</point>
  <point name="modify.body.b_fk_update" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                      ]]>
</point>
  <point name="modify.body.b_fk_update2" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                      ]]>
</point>
  <point name="modify.body.b_fk_update3" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                      ]]>
</point>
  <point name="modify.body.m_fk_update" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                      ]]>
</point>
  <point name="modify.body.m_fk_update2" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                      ]]>
</point>
  <point name="modify.body.m_fk_update3" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                      ]]>
</point>
  <point name="modify.define" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                  ]]>
</point>
  <point name="query.define" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                  ]]>
</point>
  <point name="query.other" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                  ]]>
</point>
  <point name="ref_show.body.reference" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmeg_d[l_ac].xmeg_t.xmeg001
            CALL ap_ref_array2(g_ref_fields,"SELECT imaal003 FROM imaal_t WHERE imaalent='"||g_enterprise||"' AND imaal001=? AND imaal002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmeg_d[l_ac].xmeg001_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmeg_d[l_ac].xmeg001_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmeg_d[l_ac].xmeg004
            CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='221' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmeg_d[l_ac].xmeg004_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmeg_d[l_ac].xmeg004_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmeg_d[l_ac].xmeg_t.xmeg006
            CALL ap_ref_array2(g_ref_fields,"SELECT oocal003 FROM oocal_t WHERE oocalent='"||g_enterprise||"' AND oocal001=? AND oocal002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmeg_d[l_ac].xmeg006_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmeg_d[l_ac].xmeg006_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmeg_d[l_ac].xmeg_t.xmeg008
            CALL ap_ref_array2(g_ref_fields,"SELECT oocal003 FROM oocal_t WHERE oocalent='"||g_enterprise||"' AND oocal001=? AND oocal002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmeg_d[l_ac].xmeg008_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmeg_d[l_ac].xmeg008_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmeg_d[l_ac].xmeg_t.xmeg010
            CALL ap_ref_array2(g_ref_fields,"SELECT oocal003 FROM oocal_t WHERE oocalent='"||g_enterprise||"' AND oocal001=? AND oocal002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmeg_d[l_ac].xmeg010_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmeg_d[l_ac].xmeg010_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmeg_d[l_ac].xmeg_t.xmeg016
            CALL ap_ref_array2(g_ref_fields,"SELECT oodbl004 FROM oodbl_t WHERE oodblent='"||g_enterprise||"' AND oodbl002=? AND oodbl003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmeg_d[l_ac].xmeg016_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmeg_d[l_ac].xmeg016_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmeg_d[l_ac].xmeg_t.xmegunit
            CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmeg_d[l_ac].xmegunit_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmeg_d[l_ac].xmegunit_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmeg_d[l_ac].xmeg_t.xmegorga
            CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmeg_d[l_ac].xmegorga_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmeg_d[l_ac].xmegorga_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmeg_d[l_ac].xmeg049
            CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='265' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmeg_d[l_ac].xmeg049_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmeg_d[l_ac].xmeg049_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmeg_d[l_ac].xmeg053
            CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='265' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmeg_d[l_ac].xmeg053_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmeg_d[l_ac].xmeg053_desc
]]>
</point>
  <point name="ref_show.body3.reference" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmeg3_d[l_ac].xmeh_t.xmeh001
            CALL ap_ref_array2(g_ref_fields,"SELECT imaal003 FROM imaal_t WHERE imaalent='"||g_enterprise||"' AND imaal001=? AND imaal002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmeg3_d[l_ac].xmeh001_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmeg3_d[l_ac].xmeh001_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmeg3_d[l_ac].xmeh001_desc
            CALL ap_ref_array2(g_ref_fields,"SELECT imaal004 FROM imaal_t WHERE imaalent='"||g_enterprise||"' AND imaal001=? AND imaal002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmeg3_d[l_ac].xmeh001_desc_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmeg3_d[l_ac].xmeh001_desc_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmeg3_d[l_ac].xmeh_t.xmeh200
            CALL ap_ref_array2(g_ref_fields,"SELECT prcfl003 FROM prcfl_t WHERE prcflent='"||g_enterprise||"' AND prcfl001=? AND prcfl002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmeg3_d[l_ac].xmeh200_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmeg3_d[l_ac].xmeh200_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmeg3_d[l_ac].xmeh_t.xmeh004
            CALL ap_ref_array2(g_ref_fields,"SELECT oocal003 FROM oocal_t WHERE oocalent='"||g_enterprise||"' AND oocal001=? AND oocal002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmeg3_d[l_ac].xmeh004_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmeg3_d[l_ac].xmeh004_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmeg3_d[l_ac].xmeh_t.xmeh201
            CALL ap_ref_array2(g_ref_fields,"SELECT oocal003 FROM oocal_t WHERE oocalent='"||g_enterprise||"' AND oocal001=? AND oocal002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmeg3_d[l_ac].xmeh201_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmeg3_d[l_ac].xmeh201_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmeg3_d[l_ac].xmeh_t.xmeh024
            CALL ap_ref_array2(g_ref_fields,"SELECT oocal003 FROM oocal_t WHERE oocalent='"||g_enterprise||"' AND oocal001=? AND oocal002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmeg3_d[l_ac].xmeh024_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmeg3_d[l_ac].xmeh024_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmeg3_d[l_ac].xmeh_t.xmeh026
            CALL ap_ref_array2(g_ref_fields,"SELECT oocal003 FROM oocal_t WHERE oocalent='"||g_enterprise||"' AND oocal001=? AND oocal002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmeg3_d[l_ac].xmeh026_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmeg3_d[l_ac].xmeh026_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmeg3_d[l_ac].xmeh_t.xmeh019
            CALL ap_ref_array2(g_ref_fields,"SELECT oodbl004 FROM oodbl_t WHERE oodblent='"||g_enterprise||"' AND oodbl002=? AND oodbl003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmeg3_d[l_ac].xmeh019_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmeg3_d[l_ac].xmeh019_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmeg3_d[l_ac].xmeh_t.xmeh207
            CALL ap_ref_array2(g_ref_fields,"SELECT pmaal004 FROM pmaal_t WHERE pmaalent='"||g_enterprise||"' AND pmaal001=? AND pmaal002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmeg3_d[l_ac].xmeh207_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmeg3_d[l_ac].xmeh207_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmeg3_d[l_ac].xmeh_t.xmehunit
            CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmeg3_d[l_ac].xmehunit_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmeg3_d[l_ac].xmehunit_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmeg3_d[l_ac].xmeh_t.xmeh210
            CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmeg3_d[l_ac].xmeh210_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmeg3_d[l_ac].xmeh210_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmeg3_d[l_ac].xmeh_t.xmeh213
            CALL ap_ref_array2(g_ref_fields,"SELECT inaa002 FROM inaa_t WHERE inaaent='"||g_enterprise||"' AND inaa001=? ","") RETURNING g_rtn_fields
            LET g_xmeg3_d[l_ac].xmeh213_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmeg3_d[l_ac].xmeh213_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmeg3_d[l_ac].xmeh213
            LET g_ref_fields[2] = g_xmeg3_d[l_ac].xmeh214
            CALL ap_ref_array2(g_ref_fields,"SELECT inab003 FROM inab_t WHERE inabent='"||g_enterprise||"' AND inab001=? AND inab002=? ","") RETURNING g_rtn_fields
            LET g_xmeg3_d[l_ac].xmeh214_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmeg3_d[l_ac].xmeh214_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmeg3_d[l_ac].xmeh_t.xmehsite
            CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmeg3_d[l_ac].xmehsite_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmeg3_d[l_ac].xmehsite_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmeg3_d[l_ac].xmeh_t.xmeh218
            CALL ap_ref_array2(g_ref_fields,"SELECT oojdl003 FROM oojdl_t WHERE oojdlent='"||g_enterprise||"' AND oojdl001=? AND oojdl002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmeg3_d[l_ac].xmeh218_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmeg3_d[l_ac].xmeh218_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmeg3_d[l_ac].xmeh_t.xmeh219
            CALL ap_ref_array2(g_ref_fields,"SELECT dbbal003 FROM dbbal_t WHERE dbbalent='"||g_enterprise||"' AND dbbal001=? AND dbbal002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmeg3_d[l_ac].xmeh219_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmeg3_d[l_ac].xmeh219_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmeg3_d[l_ac].xmeh_t.xmeh220
            CALL ap_ref_array2(g_ref_fields,"SELECT dbbcl003 FROM dbbcl_t WHERE dbbclent='"||g_enterprise||"' AND dbbcl001=? AND dbbcl002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmeg3_d[l_ac].xmeh220_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmeg3_d[l_ac].xmeh220_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmeg3_d[l_ac].xmeh_t.xmeh222
            CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmeg3_d[l_ac].xmeh222_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmeg3_d[l_ac].xmeh222_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmeg3_d[l_ac].xmeh223
            CALL ap_ref_array2(g_ref_fields,"SELECT oofa011 FROM oofa_t WHERE oofaent='"||g_enterprise||"' AND oofa002='2' AND oofa003=? ","") RETURNING g_rtn_fields
            LET g_xmeg3_d[l_ac].xmeh223_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmeg3_d[l_ac].xmeh223_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmeg3_d[l_ac].xmeh_t.xmeh224
            CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmeg3_d[l_ac].xmeh224_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmeg3_d[l_ac].xmeh224_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmeg3_d[l_ac].xmeh_t.xmehorga
            CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmeg3_d[l_ac].xmehorga_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmeg3_d[l_ac].xmehorga_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmeg3_d[l_ac].xmeh_t.xmeh227
            CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmeg3_d[l_ac].xmeh227_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmeg3_d[l_ac].xmeh227_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmeg3_d[l_ac].xmeh_t.xmeh228
            CALL ap_ref_array2(g_ref_fields,"SELECT staal003 FROM staal_t WHERE staalent='"||g_enterprise||"' AND staal001=? AND staal002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmeg3_d[l_ac].xmeh228_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmeg3_d[l_ac].xmeh228_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmeg3_d[l_ac].xmeh010
            CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001=? AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmeg3_d[l_ac].xmeh010_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmeg3_d[l_ac].xmeh010_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmeg3_d[l_ac].xmeh022
            CALL ap_ref_array2(g_ref_fields,"SELECT oofa011 FROM oofa_t WHERE oofaent='"||g_enterprise||"' AND oofa002='2' AND oofa003=? ","") RETURNING g_rtn_fields
            LET g_xmeg3_d[l_ac].xmeh022_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmeg3_d[l_ac].xmeh022_desc
]]>
</point>
  <point name="ref_show.body4.reference" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmeg4_d[l_ac].xmjb_t.xmjbsite
            CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmeg4_d[l_ac].xmjbsite_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmeg4_d[l_ac].xmjbsite_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmeg4_d[l_ac].xmjb_t.xmjb003
            CALL ap_ref_array2(g_ref_fields,"SELECT imaal003 FROM imaal_t WHERE imaalent='"||g_enterprise||"' AND imaal001=? AND imaal002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmeg4_d[l_ac].xmjb003_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmeg4_d[l_ac].xmjb003_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmeg4_d[l_ac].xmjb003_desc
            CALL ap_ref_array2(g_ref_fields,"SELECT imaal004 FROM imaal_t WHERE imaalent='"||g_enterprise||"' AND imaal001=? AND imaal002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmeg4_d[l_ac].xmjb003_desc_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmeg4_d[l_ac].xmjb003_desc_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmeg4_d[l_ac].xmjb_t.xmjb005
            CALL ap_ref_array2(g_ref_fields,"SELECT prcfl003 FROM prcfl_t WHERE prcflent='"||g_enterprise||"' AND prcfl001=? AND prcfl002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmeg4_d[l_ac].xmjb005_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmeg4_d[l_ac].xmjb005_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmeg4_d[l_ac].xmjb_t.xmjb006
            CALL ap_ref_array2(g_ref_fields,"SELECT oodbl004 FROM oodbl_t WHERE oodblent='"||g_enterprise||"' AND oodbl002=? AND oodbl003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmeg4_d[l_ac].xmjb006_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmeg4_d[l_ac].xmjb006_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmeg4_d[l_ac].xmjb_t.xmjb011
            CALL ap_ref_array2(g_ref_fields,"SELECT oocal003 FROM oocal_t WHERE oocalent='"||g_enterprise||"' AND oocal001=? AND oocal002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmeg4_d[l_ac].xmjb011_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmeg4_d[l_ac].xmjb011_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmeg4_d[l_ac].xmjb_t.xmjb013
            CALL ap_ref_array2(g_ref_fields,"SELECT oocal003 FROM oocal_t WHERE oocalent='"||g_enterprise||"' AND oocal001=? AND oocal002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmeg4_d[l_ac].xmjb013_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmeg4_d[l_ac].xmjb013_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmeg4_d[l_ac].xmjb_t.xmjb015
            CALL ap_ref_array2(g_ref_fields,"SELECT oocal003 FROM oocal_t WHERE oocalent='"||g_enterprise||"' AND oocal001=? AND oocal002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmeg4_d[l_ac].xmjb015_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmeg4_d[l_ac].xmjb015_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmeg4_d[l_ac].xmjb_t.xmjb017
            CALL ap_ref_array2(g_ref_fields,"SELECT oocal003 FROM oocal_t WHERE oocalent='"||g_enterprise||"' AND oocal001=? AND oocal002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmeg4_d[l_ac].xmjb017_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmeg4_d[l_ac].xmjb017_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmeg4_d[l_ac].xmjb_t.xmjb024
            CALL ap_ref_array2(g_ref_fields,"SELECT pmaal004 FROM pmaal_t WHERE pmaalent='"||g_enterprise||"' AND pmaal001=? AND pmaal002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmeg4_d[l_ac].xmjb024_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmeg4_d[l_ac].xmjb024_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmeg4_d[l_ac].xmjb_t.xmjb027
            CALL ap_ref_array2(g_ref_fields,"SELECT dbadl003 FROM dbadl_t WHERE dbadlent='"||g_enterprise||"' AND dbadl001=? AND dbadl002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmeg4_d[l_ac].xmjb027_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmeg4_d[l_ac].xmjb027_desc
]]>
</point>
  <point name="ref_show.body5.reference" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmeg5_d[l_ac].xmef_t.xmef002
            CALL ap_ref_array2(g_ref_fields,"SELECT ooibl004 FROM ooibl_t WHERE ooiblent='"||g_enterprise||"' AND ooibl002=? AND ooibl003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmeg5_d[l_ac].xmef002_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmeg5_d[l_ac].xmef002_desc
]]>
</point>
  <point name="ref_show.head.reference" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmee_m.xmee_t.xmeesite
            CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmee_m.xmeesite_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmee_m.xmeesite_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmee_m.xmee_t.xmee202
            CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmee_m.xmee202_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmee_m.xmee202_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmee_m.xmee_t.xmee023
            CALL ap_ref_array2(g_ref_fields,"SELECT oojdl003 FROM oojdl_t WHERE oojdlent='"||g_enterprise||"' AND oojdl001=? AND oojdl002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmee_m.xmee023_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmee_m.xmee023_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmee_m.xmee_t.xmee004
            CALL ap_ref_array2(g_ref_fields,"SELECT pmaal004 FROM pmaal_t WHERE pmaalent='"||g_enterprise||"' AND pmaal001=? AND pmaal002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmee_m.xmee004_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmee_m.xmee004_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmee_m.xmee_t.xmee200
            CALL ap_ref_array2(g_ref_fields,"SELECT pmaal004 FROM pmaal_t WHERE pmaalent='"||g_enterprise||"' AND pmaal001=? AND pmaal002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmee_m.xmee200_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmee_m.xmee200_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmee_m.xmee_t.xmee201
            CALL ap_ref_array2(g_ref_fields,"SELECT pmaal004 FROM pmaal_t WHERE pmaalent='"||g_enterprise||"' AND pmaal001=? AND pmaal002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmee_m.xmee201_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmee_m.xmee201_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmee_m.xmee_t.xmee021
            CALL ap_ref_array2(g_ref_fields,"SELECT pmaal004 FROM pmaal_t WHERE pmaalent='"||g_enterprise||"' AND pmaal001=? AND pmaal002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmee_m.xmee021_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmee_m.xmee021_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmee_m.xmee_t.xmee022
            CALL ap_ref_array2(g_ref_fields,"SELECT pmaal004 FROM pmaal_t WHERE pmaalent='"||g_enterprise||"' AND pmaal001=? AND pmaal002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmee_m.xmee022_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmee_m.xmee022_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmee_m.xmee_t.xmee203
            CALL ap_ref_array2(g_ref_fields,"SELECT pmaal004 FROM pmaal_t WHERE pmaalent='"||g_enterprise||"' AND pmaal001=? AND pmaal002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmee_m.xmee203_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmee_m.xmee203_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmee_m.xmee_t.xmee027
            CALL ap_ref_array2(g_ref_fields,"SELECT oofa011 FROM oofa_t WHERE oofaent='"||g_enterprise||"' AND oofa001=? ","") RETURNING g_rtn_fields
            LET g_xmee_m.xmee027_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmee_m.xmee027_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmee_m.xmee024
            CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='295' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmee_m.xmee024_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmee_m.xmee024_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmee_m.xmee002
            CALL ap_ref_array2(g_ref_fields,"SELECT oofa011 FROM oofa_t WHERE oofaent='"||g_enterprise||"' AND oofa002='2' AND oofa003=? ","") RETURNING g_rtn_fields
            LET g_xmee_m.xmee002_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmee_m.xmee002_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmee_m.xmee_t.xmee003
            CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmee_m.xmee003_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmee_m.xmee003_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmee_m.xmee_t.xmeeunit
            CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmee_m.xmeeunit_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmee_m.xmeeunit_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmee_m.xmee_t.xmee204
            CALL ap_ref_array2(g_ref_fields,"SELECT prcfl003 FROM prcfl_t WHERE prcflent='"||g_enterprise||"' AND prcfl001=? AND prcfl002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmee_m.xmee204_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmee_m.xmee204_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmee_m.xmee032
            CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='297' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmee_m.xmee032_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmee_m.xmee032_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmee_m.xmee_t.xmee025
            CALL ap_ref_array2(g_ref_fields,"SELECT oofb011 FROM oofb_t WHERE oofbent='"||g_enterprise||"' AND oofb001=? ","") RETURNING g_rtn_fields
            LET g_xmee_m.xmee025_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmee_m.xmee025_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmee_m.xmee_t.xmee026
            CALL ap_ref_array2(g_ref_fields,"SELECT oofb011 FROM oofb_t WHERE oofbent='"||g_enterprise||"' AND oofb001=? ","") RETURNING g_rtn_fields
            LET g_xmee_m.xmee026_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmee_m.xmee026_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmee_m.xmee_t.xmee206
            CALL ap_ref_array2(g_ref_fields,"SELECT dbadl003 FROM dbadl_t WHERE dbadlent='"||g_enterprise||"' AND dbadl001=? AND dbadl002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmee_m.xmee206_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmee_m.xmee206_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmee_m.xmee_t.xmee207
            CALL ap_ref_array2(g_ref_fields,"SELECT dbabl003 FROM dbabl_t WHERE dbablent='"||g_enterprise||"' AND dbabl001=? AND dbabl002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmee_m.xmee207_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmee_m.xmee207_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmee_m.xmee020
            CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='263' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmee_m.xmee020_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmee_m.xmee020_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmee_m.xmee_t.xmee037
            CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmee_m.xmee037_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmee_m.xmee037_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmee_m.xmee_t.xmee038
            CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmee_m.xmee038_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmee_m.xmee038_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmee_m.xmee_t.xmee036
            CALL ap_ref_array2(g_ref_fields,"SELECT pmaal004 FROM pmaal_t WHERE pmaalent='"||g_enterprise||"' AND pmaal001=? AND pmaal002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmee_m.xmee036_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmee_m.xmee036_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmee_m.xmee_t.xmee009
            CALL ap_ref_array2(g_ref_fields,"SELECT ooibl004 FROM ooibl_t WHERE ooiblent='"||g_enterprise||"' AND ooibl002=? AND ooibl003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmee_m.xmee009_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmee_m.xmee009_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmee_m.xmee010
            CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='238' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmee_m.xmee010_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmee_m.xmee010_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmee_m.xmee_t.xmee015
            CALL ap_ref_array2(g_ref_fields,"SELECT ooail003 FROM ooail_t WHERE ooailent='"||g_enterprise||"' AND ooail001=? AND ooail002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmee_m.xmee015_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmee_m.xmee015_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmee_m.xmee_t.xmee011
            CALL ap_ref_array2(g_ref_fields,"SELECT oodbl004 FROM oodbl_t WHERE oodblent='"||g_enterprise||"' AND oodbl002=? AND oodbl003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmee_m.xmee011_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmee_m.xmee011_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmee_m.xmee_t.xmee035
            CALL ap_ref_array2(g_ref_fields,"SELECT isacl004 FROM isacl_t WHERE isaclent='"||g_enterprise||"' AND isacl002=? AND isacl003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmee_m.xmee035_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmee_m.xmee035_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmee_m.xmeeownid
            CALL ap_ref_array2(g_ref_fields,"SELECT oofa011 FROM oofa_t WHERE oofaent='"||g_enterprise||"' AND oofa002='2' AND oofa003=? ","") RETURNING g_rtn_fields
            LET g_xmee_m.xmeeownid_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmee_m.xmeeownid_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmee_m.xmee_t.xmeeowndp
            CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmee_m.xmeeowndp_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmee_m.xmeeowndp_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmee_m.xmeecrtid
            CALL ap_ref_array2(g_ref_fields,"SELECT oofa011 FROM oofa_t WHERE oofaent='"||g_enterprise||"' AND oofa002='2' AND oofa003=? ","") RETURNING g_rtn_fields
            LET g_xmee_m.xmeecrtid_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmee_m.xmeecrtid_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmee_m.xmee_t.xmeecrtdp
            CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmee_m.xmeecrtdp_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmee_m.xmeecrtdp_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmee_m.xmeemodid
            CALL ap_ref_array2(g_ref_fields,"SELECT oofa011 FROM oofa_t WHERE oofaent='"||g_enterprise||"' AND oofa002='2' AND oofa003=? ","") RETURNING g_rtn_fields
            LET g_xmee_m.xmeemodid_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmee_m.xmeemodid_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmee_m.xmeecnfid
            CALL ap_ref_array2(g_ref_fields,"SELECT oofa011 FROM oofa_t WHERE oofaent='"||g_enterprise||"' AND oofa002='2' AND oofa003=? ","") RETURNING g_rtn_fields
            LET g_xmee_m.xmeecnfid_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmee_m.xmeecnfid_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmee_m.xmee_t.xmee034
            CALL ap_ref_array2(g_ref_fields,"SELECT pmaal003 FROM pmaal_t WHERE pmaalent='"||g_enterprise||"' AND pmaal001=? AND pmaal002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmee_m.xmee034_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmee_m.xmee034_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmee_m.xmee_t.xmee017
            CALL ap_ref_array2(g_ref_fields,"SELECT pmaml003 FROM pmaml_t WHERE pmamlent='"||g_enterprise||"' AND pmaml001=? AND pmaml002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmee_m.xmee017_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmee_m.xmee017_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmee_m.xmee_t.xmee018
            CALL ap_ref_array2(g_ref_fields,"SELECT ooidl003 FROM ooidl_t WHERE ooidlent='"||g_enterprise||"' AND ooidl001=? AND ooidl002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmee_m.xmee018_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmee_m.xmee018_desc
]]>
</point>
  <point name="reproduce.after_reproduce" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                  ]]>
</point>
  <point name="reproduce.define" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                  ]]>
</point>
  <point name="reproduce.head.b_input" cite_std="N" status="" ver="3" src="s" new="N" mark_hard="N">
<![CDATA[   LET g_xmee_m.xmeestus = 'N' 
   LET g_xmee_m.xmee902 = g_today
   LET g_xmee_m.xmeecnfid = ""
   LET g_xmee_m.xmeecnfdt = ""]]>
</point>
  <point name="send.before_send" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[   IF NOT s_adbt510_conf_chk(g_xmee_m.xmeedocno,g_xmee_m.xmee900) THEN
      CLOSE adbt510_cl
      CALL s_transaction_end('N','0')
      RETURN
   END IF
]]>
</point>
  <point name="set_entry.after_control" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[   CALL cl_set_comp_entry("xmee039",TRUE)
   #CALL cl_set_comp_entry("xmeg015,xmegunit,xmegorga",TRUE)
   
   CALL cl_set_comp_entry("xmee200,xmee201,xmee021,xmee022,xmee203,xmeeunit",TRUE)
   CALL cl_set_comp_required("xmee200,xmee021,xmee022,xmee203",TRUE)
]]>
</point>
  <point name="set_entry.define" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                  ]]>
</point>
  <point name="set_entry.field_control" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[      CALL cl_set_comp_entry("xmeedocdt",TRUE)
      CALL cl_set_comp_entry("xmeesite",TRUE)]]>
</point>
  <point name="set_entry_b.define" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                  ]]>
</point>
  <point name="set_entry_b.set_entry_b" cite_std="N" status="u" ver="3" src="s" new="N" mark_hard="N">
<![CDATA[   #CALL cl_set_comp_entry("xmehseq",TRUE)
   CALL cl_set_comp_entry("xmef001,xmef002,xmef003,xmef004,xmef005,xmef006",TRUE)
   CALL cl_set_comp_entry("xmjb024,xmjb026,xmjb030,xmjb031,xmjb032",TRUE)]]>
</point>
  <point name="set_no_entry.after_control" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[   IF p_cmd = 'a' AND g_flag2 THEN
      CALL cl_set_comp_entry("xmeesite",FALSE)
   END IF
   
   IF NOT g_flag1 THEN
      CALL cl_set_comp_entry("xmee039",FALSE)
   END IF
      
   IF g_xmee_m.xmee005 <> '6' THEN
      CALL cl_set_comp_entry("xmee200",FALSE)
      CALL cl_set_comp_required("xmee200",FALSE)
   ELSE
      CALL cl_set_comp_entry("xmee201",FALSE)
   END IF
   IF s_adbt510_xmdl003_exist(g_xmee_m.xmeedocno) OR adbt510_xmdb008_exist() THEN
      CALL cl_set_comp_entry("xmee200,xmee201,xmee021,xmee022,xmrr203",FALSE)
      CALL cl_set_comp_required("xmee200,xmee021,xmee022,xmee203",FALSE)
   END IF
   IF s_adbt510_xmdl003_exist(g_xmee_m.xmeedocno) THEN
      CALL cl_set_comp_entry("xmeeunit",FALSE)
   END IF]]>
</point>
  <point name="set_no_entry.define" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[   DEFINE l_pmam003   LIKE pmam_t.pmam003
]]>
</point>
  <point name="set_no_entry.field_control" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[      CALL cl_set_comp_entry("xmeedocdt",FALSE)
      CALL cl_set_comp_entry("xmeesite",FALSE)                                    ]]>
</point>
  <point name="set_no_entry_b.define" cite_std="N" status="" ver="3" src="s" new="N" mark_hard="N">
<![CDATA[   DEFINE l_pmaa002   LIKE pmaa_t.pmaa002    
   DEFINE l_xmja030   LIKE xmja_t.xmja030   ]]>
</point>
  <point name="set_no_entry_b.set_no_entry_b" cite_std="N" status="u" ver="3" src="s" new="N" mark_hard="N">
<![CDATA[   IF (NOT cl_null(g_xmeg5_d_t.xmef007)) AND (g_xmeg5_d_t.xmef008> 0 OR g_xmeg5_d_t.xmef009 > 0)  OR  NOT g_flag1 THEN
      CALL cl_set_comp_entry("xmef001,xmef002,xmef003,xmef004,xmef005,xmef006",FALSE)
   END IF

   IF l_ac > 0 THEN   
      SELECT xmja030 INTO l_xmja030
        FROM xmja_t
       WHERE xmjaent = g_enterprise
         AND xmjadocno = g_xmee_m.xmeedocno
         AND xmjaseq = g_xmeg4_d[l_ac].xmjbseq
      IF l_xmja030 = 'Y' THEN
         CALL cl_set_comp_entry("xmjb030",FALSE)
      END IF
      IF g_xmeg4_d[l_ac].xmjb030 = "Y" THEN
         CALL cl_set_comp_entry("xmjb031,xmjb032",FALSE)
      END IF
   END IF   
   SELECT pmaa002
     INTO l_pmaa002
     FROM pmaa_t
    WHERE pmaaent = g_enterprise
      AND pmaa001 = g_xmee_m.xmee004
   IF l_pmaa002 = '2' THEN
      CALL cl_set_comp_visible("xmjb024,xmjb024_desc",TRUE) 
   ELSE
      IF l_ac > 0 THEN
         LET g_xmeg4_d[l_ac].xmjb024 = NULL
         DISPLAY BY NAME g_xmeg4_d[l_ac].xmjb024
      END IF
      CALL cl_set_comp_entry("xmjb024",FALSE)
      CALL cl_set_comp_visible("xmjb024,xmjb024_desc",FALSE) 
   END IF 
   IF s_adbt510_xmdl003_exist(g_xmee_m.xmeedocno) THEN
      CALL cl_set_comp_entry("xmjb026",FALSE)
   END IF]]>
</point>
  <point name="show.after" cite_std="N" status="" ver="3" src="s" new="N" mark_hard="N">
<![CDATA[   CALL adbt510_head_color()
   CALL s_hint_show('xmek_t','xmee_t',g_xmee_m.xmeedocno,g_xmee_m.xmee900,0,'','')
   CALL s_hint_show('xmek_t','xmef_t',g_xmee_m.xmeedocno,g_xmee_m.xmee900,0,'','')
   IF g_detail_idx > 0 THEN
      #CALL s_hint_show('xmek_t','xmeg_t',g_xmee_m.xmeedocno,g_xmee_m.xmee900,g_xmeg_d[g_detail_idx].xmegseq,'','')
      CALL s_hint_show('xmek_t','xmjb_t',g_xmee_m.xmeedocno,g_xmee_m.xmee900,g_xmeg4_d[g_detail_idx].xmjbseq,'','')
      #CALL s_hint_show('xmek_t','xmeh_t',g_xmee_m.xmeedocno,g_xmee_m.xmee900,g_xmeg3_d[g_detail_idx].xmehseq,
      #                  g_xmeg3_d[g_detail_idx].xmehseq1,g_xmeg3_d[g_detail_idx].xmehseq2)   
   END IF                         ]]>
</point>
  <point name="show.before" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                  ]]>
</point>
  <point name="show.body.reference" cite_std="N" status="" ver="2" src="s" new="N" mark_hard="N">
<![CDATA[#            CALL adbt510_xmeg001_ref(g_xmeg_d[l_ac].xmeg001) RETURNING g_xmeg_d[l_ac].xmeg001_desc,g_xmeg_d[l_ac].imaal004
#            DISPLAY BY NAME g_xmeg_d[l_ac].xmeg001_desc,g_xmeg_d[l_ac].imaal004
#
#            CALL adbt510_xmeg004_ref(g_xmeg_d[l_ac].xmeg004) RETURNING g_xmeg_d[l_ac].xmeg004_desc
#            DISPLAY BY NAME g_xmeg_d[l_ac].xmeg004_desc
#
#            CALL adbt510_unit_ref(g_xmeg_d[l_ac].xmeg006) RETURNING g_xmeg_d[l_ac].xmeg006_desc
#            DISPLAY BY NAME g_xmeg_d[l_ac].xmeg006_desc
#
#            CALL adbt510_unit_ref(g_xmeg_d[l_ac].xmeg008) RETURNING g_xmeg_d[l_ac].xmeg008_desc
#            DISPLAY BY NAME g_xmeg_d[l_ac].xmeg008_desc
#
#            CALL adbt510_unit_ref(g_xmeg_d[l_ac].xmeg010) RETURNING g_xmeg_d[l_ac].xmeg010_desc
#            DISPLAY BY NAME g_xmeg_d[l_ac].xmeg010_desc
#
#            CALL adbt510_xmee011_ref(g_xmeg_d[l_ac].xmeg016) RETURNING g_xmeg_d[l_ac].xmeg016_desc
#            DISPLAY BY NAME g_xmeg_d[l_ac].xmeg016_desc
#
#            
#            CALL adbt510_xmee003_ref(g_xmeg_d[l_ac].xmegunit) RETURNING g_xmeg_d[l_ac].xmegunit_desc
#            DISPLAY BY NAME g_xmeg_d[l_ac].xmegunit_desc
#            
#            CALL adbt510_xmee003_ref(g_xmeg_d[l_ac].xmegorga) RETURNING g_xmeg_d[l_ac].xmegorga_desc
#            DISPLAY BY NAME g_xmeg_d[l_ac].xmegorga_desc
#            
#            CALL adbt510_xmeg049_ref(g_xmeg_d[l_ac].xmeg049) RETURNING g_xmeg_d[l_ac].xmeg049_desc
#            DISPLAY BY NAME g_xmeg_d[l_ac].xmeg049_desc
#
#      #抓取約定交貨日、預計簽收日期
#     SELECT xmeg012,xmeg013 
#        INTO g_xmeg3_d[l_ac].xmeg012,g_xmeg3_d[l_ac].xmeg013
#        FROM xmeg_t
#       WHERE xmegent = g_enterprise
#         AND xmegdocno = g_xmeg3_d[l_ac].xmehdocno
#         AND xmegseq = g_xmeg3_d[l_ac].xmehseq
#      DISPLAY BY NAME g_xmeg3_d[l_ac].xmeg012,g_xmeg3_d[l_ac].xmeg013]]>
</point>
  <point name="show.body2.reference" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            LET g_xmeg2_d[l_ac].xmegseq = g_xmeg_d[l_ac].xmegseq
            LET g_xmeg2_d[l_ac].imaa001 = g_xmeg_d[l_ac].xmeg001
            LET g_xmeg2_d[l_ac].imaal003 = g_xmeg_d[l_ac].xmeg001_desc
            LET g_xmeg2_d[l_ac].imaal004 = g_xmeg_d[l_ac].imaal004
            LET g_xmeg2_d[l_ac].imaa005 = g_xmeg_d[l_ac].xmeg002
            LET g_xmeg2_d[l_ac].xmeg0272 = g_xmeg_d[l_ac].xmeg027
            DISPLAY BY NAME g_xmeg2_d[l_ac].xmegseq,g_xmeg2_d[l_ac].imaa001,g_xmeg2_d[l_ac].imaal003,
                            g_xmeg2_d[l_ac].imaal004,g_xmeg2_d[l_ac].imaa005,g_xmeg2_d[l_ac].xmeg0272            
           
            CALL adbt510_xmeg028_ref(g_xmeg2_d[l_ac].xmeg028) RETURNING g_xmeg2_d[l_ac].xmeg028_desc
            DISPLAY BY NAME g_xmeg2_d[l_ac].xmeg028_desc

            CALL adbt510_xmeg029_ref(g_xmeg2_d[l_ac].xmeg028,g_xmeg2_d[l_ac].xmeg029) RETURNING g_xmeg2_d[l_ac].xmeg029_desc
            DISPLAY BY NAME g_xmeg2_d[l_ac].xmeg029_desc
            
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmeg2_d[l_ac].xmeg028
            CALL ap_ref_array2(g_ref_fields,"SELECT inaa002 FROM inaa_t WHERE inaaent='"||g_enterprise||"' AND inaa001=? ","") RETURNING g_rtn_fields
            LET g_xmeg2_d[l_ac].xmeg028_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmeg2_d[l_ac].xmeg028_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmeg2_d[l_ac].xmeg028
            LET g_ref_fields[2] = g_xmeg2_d[l_ac].xmeg029
            CALL ap_ref_array2(g_ref_fields,"SELECT inab003 FROM inab_t WHERE inabent='"||g_enterprise||"' AND inab001=? AND inab002=? ","") RETURNING g_rtn_fields
            LET g_xmeg2_d[l_ac].xmeg029_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmeg2_d[l_ac].xmeg029_desc
]]>
</point>
  <point name="show.body3.reference" cite_std="N" status="" ver="2" src="s" new="N" mark_hard="N">
<![CDATA[#      
#      CALL adbt510_unit_ref(g_xmeg3_d[l_ac].xmeh004) RETURNING g_xmeg3_d[l_ac].xmeh004_desc
#      DISPLAY BY NAME g_xmeg3_d[l_ac].xmeh004_desc
#      
#      CALL adbt510_xmee011_ref(g_xmeg3_d[l_ac].xmeh019) RETURNING g_xmeg3_d[l_ac].xmeh019_desc
#      DISPLAY BY NAME g_xmeg3_d[l_ac].xmeh019_desc
#      
#      CALL adbt510_unit_ref(g_xmeg3_d[l_ac].xmeh024) RETURNING g_xmeg3_d[l_ac].xmeh024_desc
#      DISPLAY BY NAME g_xmeg3_d[l_ac].xmeh024_desc
#      
#      CALL adbt510_unit_ref(g_xmeg3_d[l_ac].xmeh026) RETURNING g_xmeg3_d[l_ac].xmeh026_desc
#      DISPLAY BY NAME g_xmeg3_d[l_ac].xmeh026_desc
#      
#      CALL adbt510_xmeh001_ref()
#      CALL adbt510_xmeh200_ref()
#      CALL adbt510_xmeh207_ref()
#      CALL adbt510_xmeh213_ref()
#      CALL adbt510_xmeh214_ref()
#      CALL adbt510_xmeh218_ref()
#      CALL adbt510_xmeh219_ref()
#      CALL adbt510_xmeh220_ref()
#      CALL adbt510_xmeh210_ref()
#      CALL adbt510_xmehunit_ref()
#      CALL adbt510_xmeh201_ref()
#      CALL adbt510_xmeh222_ref()
#      CALL adbt510_xmeh223_ref()
#      CALL adbt510_xmeh224_ref()
#      CALL adbt510_xmehorga_ref()
#      CALL adbt510_xmeh227_ref()
#      CALL adbt510_xmeh228_ref()
#      CALL adbt510_xmehsite_ref()
]]>
</point>
  <point name="show.body4.reference" cite_std="N" status="" ver="2" src="s" new="N" mark_hard="N">
<![CDATA[#            CALL adbt510_xmjb003_ref()
            CALL adbt510_xmjb006_ref()
#            CALL adbt510_xmjb011_ref()
#            CALL adbt510_xmjb013_ref()
#            CALL adbt510_xmjb015_ref()
#            CALL adbt510_xmjb017_ref()
#            CALL adbt510_xmjb005_ref()
#            CALL adbt510_xmjb024_ref()
            CALL adbt510_xmjb026_ref()
#            CALL adbt510_xmjb027_ref()
#            CALL adbt510_xmjbsite_ref()]]>
</point>
  <point name="show.body5.reference" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                    ]]>
</point>
  <point name="show.body6.reference" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[
      CALL adbt510_xrcd002_ref()
      CALL adbt510_imaa0011_ref()]]>
</point>
  <point name="show.body7.reference" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[      CALL adbt510_rtie002_ref()
      CALL adbt510_imaa0012_ref()
]]>
</point>
  <point name="show.body8.reference" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmeg8_d[l_ac].xmeg001
            CALL ap_ref_array2(g_ref_fields,"SELECT imaal003 FROM imaal_t WHERE imaalent='"||g_enterprise||"' AND imaal001=? AND imaal002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmeg8_d[l_ac].xmeg001_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmeg8_d[l_ac].xmeg001_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmeg8_d[l_ac].xmeg004
            CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='221' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmeg8_d[l_ac].xmeg004_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmeg8_d[l_ac].xmeg004_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmeg8_d[l_ac].xmeg006
            CALL ap_ref_array2(g_ref_fields,"SELECT oocal003 FROM oocal_t WHERE oocalent='"||g_enterprise||"' AND oocal001=? AND oocal002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmeg8_d[l_ac].xmeg006_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmeg8_d[l_ac].xmeg006_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmeg8_d[l_ac].xmeg008
            CALL ap_ref_array2(g_ref_fields,"SELECT oocal003 FROM oocal_t WHERE oocalent='"||g_enterprise||"' AND oocal001=? AND oocal002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmeg8_d[l_ac].xmeg008_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmeg8_d[l_ac].xmeg008_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmeg8_d[l_ac].xmeg010
            CALL ap_ref_array2(g_ref_fields,"SELECT oocal003 FROM oocal_t WHERE oocalent='"||g_enterprise||"' AND oocal001=? AND oocal002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmeg8_d[l_ac].xmeg010_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmeg8_d[l_ac].xmeg010_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmeg8_d[l_ac].xmeg016
            CALL ap_ref_array2(g_ref_fields,"SELECT oodbl004 FROM oodbl_t WHERE oodblent='"||g_enterprise||"' AND oodbl002=? AND oodbl003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmeg8_d[l_ac].xmeg016_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmeg8_d[l_ac].xmeg016_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmeg8_d[l_ac].xmegunit
            CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmeg8_d[l_ac].xmegunit_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmeg8_d[l_ac].xmegunit_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmeg8_d[l_ac].xmegorga
            CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmeg8_d[l_ac].xmegorga_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmeg8_d[l_ac].xmegorga_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmeg8_d[l_ac].xmeg049
            CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='265' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmeg8_d[l_ac].xmeg049_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmeg8_d[l_ac].xmeg049_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmeg8_d[l_ac].xmeg053
            CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='265' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmeg8_d[l_ac].xmeg053_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmeg8_d[l_ac].xmeg053_desc
]]>
</point>
  <point name="show.define" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[   DEFINE  l_pmaa027    LIKE pmaa_t.pmaa027
   DEFINE  r_success    LIKE type_t.num5 
   DEFINE  r_address    STRING                     ]]>
</point>
  <point name="show.head.reference" cite_std="N" status="" ver="2" src="s" new="N" mark_hard="N">
<![CDATA[#            CALL adbt510_xmeesite_ref()
#            CALL adbt510_xmee200_ref()
#            CALL adbt510_xmee201_ref()
#            CALL adbt510_xmee202_ref()
#            CALL adbt510_xmee203_ref()
#            CALL adbt510_xmee204_ref()
#            CALL adbt510_xmee206_ref()
#            CALL adbt510_xmee207_ref()
#            CALL adbt510_xmeeunit_ref()
#            CALL adbt510_xmee004_ref(g_xmee_m.xmee004) RETURNING g_xmee_m.xmee004_desc
#            DISPLAY BY NAME g_xmee_m.xmee004_desc
#
#            CALL adbt510_xmee002_ref(g_xmee_m.xmee002) RETURNING g_xmee_m.xmee002_desc
#            DISPLAY BY NAME g_xmee_m.xmee002_desc
#
#            CALL adbt510_xmee003_ref(g_xmee_m.xmee003) RETURNING g_xmee_m.xmee003_desc
#            DISPLAY BY NAME g_xmee_m.xmee003_desc 
#            
#            CALL adbt510_xmee027_ref(g_xmee_m.xmee027) RETURNING g_xmee_m.xmee027_desc
#            DISPLAY BY NAME g_xmee_m.xmee027_desc
#            
#            CALL adbt510_xmee009_ref(g_xmee_m.xmee009) RETURNING g_xmee_m.xmee009_desc
#            DISPLAY BY NAME g_xmee_m.xmee009_desc
#            
#            CALL adbt510_xmee010_ref(g_xmee_m.xmee010) RETURNING g_xmee_m.xmee010_desc
#            DISPLAY BY NAME g_xmee_m.xmee010_desc
            
            CALL adbt510_xmee011_ref(g_xmee_m.xmee011) RETURNING g_xmee_m.xmee011_desc
            DISPLAY BY NAME g_xmee_m.xmee011_desc
            
#            CALL adbt510_xmee015_ref(g_xmee_m.xmee015) RETURNING g_xmee_m.xmee015_desc
#            DISPLAY BY NAME g_xmee_m.xmee015_desc
#            
#            CALL adbt510_xmee017_ref(g_xmee_m.xmee017) RETURNING g_xmee_m.xmee017_desc
#            DISPLAY BY NAME g_xmee_m.xmee017_desc
#            
#            CALL adbt510_xmee018_ref(g_xmee_m.xmee018) RETURNING g_xmee_m.xmee018_desc
#            DISPLAY BY NAME g_xmee_m.xmee018_desc         
#           
#            CALL adbt510_xmee020_ref(g_xmee_m.xmee020) RETURNING g_xmee_m.xmee020_desc
#            DISPLAY BY NAME g_xmee_m.xmee020_desc
#                        
#            CALL adbt510_xmee004_ref(g_xmee_m.xmee021) RETURNING g_xmee_m.xmee021_desc
#            DISPLAY BY NAME g_xmee_m.xmee021_desc 
#            
#            CALL adbt510_xmee004_ref(g_xmee_m.xmee022) RETURNING g_xmee_m.xmee022_desc
#            DISPLAY BY NAME g_xmee_m.xmee022_desc 
#                     
#            CALL adbt510_xmee023_ref(g_xmee_m.xmee023) RETURNING g_xmee_m.xmee023_desc
#            DISPLAY BY NAME g_xmee_m.xmee023_desc
#            
#            CALL adbt510_xmee024_ref(g_xmee_m.xmee024) RETURNING g_xmee_m.xmee024_desc
#            DISPLAY BY NAME g_xmee_m.xmee024_desc
#
#            CALL adbt510_xmee004_ref(g_xmee_m.xmee034) RETURNING g_xmee_m.xmee034_desc
#            DISPLAY BY NAME g_xmee_m.xmee034_desc
#            
#            CALL adbt510_xmee032_ref(g_xmee_m.xmee032) RETURNING g_xmee_m.xmee032_desc
#            DISPLAY BY NAME g_xmee_m.xmee032_desc
            
            CALL adbt510_xmee035_ref(g_xmee_m.xmee035) RETURNING g_xmee_m.xmee035_desc
            DISPLAY BY NAME g_xmee_m.xmee035_desc
#            
#            CALL adbt510_xmee004_ref(g_xmee_m.xmee036) RETURNING g_xmee_m.xmee036_desc
#            DISPLAY BY NAME g_xmee_m.xmee036_desc
#            
            
            LET l_pmaa027 = ''
            LET g_xmee_m.xmee026_desc = ''
            LET g_xmee_m.oofb017_1 = ''
            IF NOT cl_null(g_xmee_m.xmee021) AND NOT cl_null(g_xmee_m.xmee026) THEN 
               CALL adbt510_get_pmaa027(g_xmee_m.xmee021) RETURNING l_pmaa027  
               CALL adbt510_xmee026_ref(l_pmaa027,g_xmee_m.xmee026) RETURNING g_xmee_m.xmee026_desc
               DISPLAY BY NAME g_xmee_m.xmee026_desc               
               CALL s_aooi350_get_address(l_pmaa027,g_xmee_m.xmee026,g_lang)RETURNING r_success,r_address
               LET g_xmee_m.oofb017_1 = r_address
               DISPLAY BY NAME g_xmee_m.oofb017_1
            END IF


            LET l_pmaa027 = ''
            LET g_xmee_m.xmee025_desc = ''
            LET g_xmee_m.oofb017 = ''
            IF NOT cl_null(g_xmee_m.xmee022) AND NOT cl_null(g_xmee_m.xmee025) THEN   
               CALL adbt510_get_pmaa027(g_xmee_m.xmee022) RETURNING l_pmaa027  
               CALL adbt510_xmee025_ref(l_pmaa027,g_xmee_m.xmee025) RETURNING g_xmee_m.xmee025_desc
               DISPLAY BY NAME g_xmee_m.xmee025_desc                    
               CALL s_aooi350_get_address(l_pmaa027,g_xmee_m.xmee025,g_lang)RETURNING r_success,r_address
               LET g_xmee_m.oofb017 = r_address
               DISPLAY BY NAME g_xmee_m.oofb017
            END IF
       
#            
#            INITIALIZE g_ref_fields TO NULL
#            LET g_ref_fields[1] = g_xmee_m.xmeeownid
#            CALL ap_ref_array2(g_ref_fields,"SELECT oofa011 FROM oofa_t WHERE oofaent='"||g_enterprise||"' AND oofa002='2' AND oofa003=? ","") RETURNING g_rtn_fields
#            LET g_xmee_m.xmeeownid_desc = '', g_rtn_fields[1] , ''
#            DISPLAY BY NAME g_xmee_m.xmeeownid_desc
#
#            INITIALIZE g_ref_fields TO NULL
#            LET g_ref_fields[1] = g_xmee_m.xmeeowndp
#            CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
#            LET g_xmee_m.xmeeowndp_desc = '', g_rtn_fields[1] , ''
#            DISPLAY BY NAME g_xmee_m.xmeeowndp_desc
#
#            INITIALIZE g_ref_fields TO NULL
#            LET g_ref_fields[1] = g_xmee_m.xmeecrtid
#            CALL ap_ref_array2(g_ref_fields,"SELECT oofa011 FROM oofa_t WHERE oofaent='"||g_enterprise||"' AND oofa002='2' AND oofa003=? ","") RETURNING g_rtn_fields
#            LET g_xmee_m.xmeecrtid_desc = '', g_rtn_fields[1] , ''
#            DISPLAY BY NAME g_xmee_m.xmeecrtid_desc
#
#            INITIALIZE g_ref_fields TO NULL
#            LET g_ref_fields[1] = g_xmee_m.xmeecrtdp
#            CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
#            LET g_xmee_m.xmeecrtdp_desc = '', g_rtn_fields[1] , ''
#            DISPLAY BY NAME g_xmee_m.xmeecrtdp_desc
#
#            INITIALIZE g_ref_fields TO NULL
#            LET g_ref_fields[1] = g_xmee_m.xmeemodid
#            CALL ap_ref_array2(g_ref_fields,"SELECT oofa011 FROM oofa_t WHERE oofaent='"||g_enterprise||"' AND oofa002='2' AND oofa003=? ","") RETURNING g_rtn_fields
#            LET g_xmee_m.xmeemodid_desc = '', g_rtn_fields[1] , ''
#            DISPLAY BY NAME g_xmee_m.xmeemodid_desc
#
#            INITIALIZE g_ref_fields TO NULL
#            LET g_ref_fields[1] = g_xmee_m.xmeecnfid
#            CALL ap_ref_array2(g_ref_fields,"SELECT oofa011 FROM oofa_t WHERE oofaent='"||g_enterprise||"' AND oofa002='2' AND oofa003=? ","") RETURNING g_rtn_fields
#            LET g_xmee_m.xmeecnfid_desc = '', g_rtn_fields[1] , ''
#            DISPLAY BY NAME g_xmee_m.xmeecnfid_desc

            CALL adbt510_get_isaf011()]]>
</point>
  <point name="show.other" cite_std="N" status="" ver="3" src="s" new="N" mark_hard="N">
<![CDATA[   FOR l_ac = 1 TO g_xmeg7_d.getLength()
      CALL adbt510_rtie002_ref()
      CALL adbt510_imaa0012_ref()
   END FOR             ]]>
</point>
  <point name="statechange.a_update" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                  ]]>
</point>
  <point name="statechange.after" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                  ]]>
</point>
  <point name="statechange.b_update" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[   CALL s_transaction_begin()
   IF lc_state = 'Y' THEN
      CALL s_adbt510_conf_chk(g_xmee_m.xmeedocno,g_xmee_m.xmee900) RETURNING l_success
      IF NOT l_success THEN
         RETURN
      ELSE
         IF NOT cl_ask_confirm('aim-00108') THEN
            RETURN
         ELSE
            CALL s_adbt510_conf_upd(g_xmee_m.xmeedocno,g_xmee_m.xmee900) RETURNING l_success
            IF NOT l_success THEN
               CALL s_transaction_end('N','0')
               RETURN
            ELSE
               CALL s_transaction_end('Y','0')
            END IF
         END IF
      END IF
   END IF
   IF lc_state = 'X' THEN
      CALL s_adbt510_invalid_chk(g_xmee_m.xmeedocno,g_xmee_m.xmee900) RETURNING l_success
      IF NOT l_success THEN
         RETURN
      ELSE
         IF NOT cl_ask_confirm('aim-00109') THEN
            RETURN
         ELSE
            CALL s_adbt510_invalid_upd(g_xmee_m.xmeedocno,g_xmee_m.xmee900) RETURNING l_success
            IF NOT l_success THEN
               CALL s_transaction_end('N','0')
               RETURN
            ELSE
               CALL s_transaction_end('Y','0')
            END IF
         END IF
      END IF
   END IF]]>
</point>
  <point name="statechange.before" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[   IF g_xmee_m.xmeestus MATCHES '[XY]' THEN
      RETURN
   END IF       ]]>
</point>
  <point name="statechange.before_menu" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[      CALL cl_set_act_visible("signing,withdraw,closed",FALSE)
      #將open改為unconfirmed
      CALL cl_set_act_visible("unconfirmed,invalid,confirmed",TRUE)
      CASE g_xmee_m.xmeestus
         WHEN "N"
            CALL cl_set_act_visible("unconfirmed,hold",FALSE)
            #需提交至BPM時，則顯示「提交」功能並隱藏「確認」功能
            IF cl_bpm_chk() THEN
                CALL cl_set_act_visible("signing",TRUE)
                CALL cl_set_act_visible("confirmed",FALSE)
            END IF
         WHEN "R"   #保留修改的功能(如作廢)，隱藏其他應用功能(如: 確認、未確認、留置、過帳…)
            CALL cl_set_act_visible("confirmed,unconfirmed,hold",FALSE)
            
         WHEN "D"   #保留修改的功能(如作廢)，隱藏其他應用功能(如: 確認、未確認、留置、過帳…)
            CALL cl_set_act_visible("confirmed,unconfirmed,hold",FALSE) 

         WHEN "X"
            CALL cl_set_act_visible("unconfirmed,invalid,confirmed,hold",FALSE)
            RETURN
         WHEN "Y"
            CALL cl_set_act_visible("invalid,confirmed,hold",FALSE)
            
         WHEN "W"    #只能顯示抽單;其餘應用功能皆隱藏
             CALL cl_set_act_visible("withdraw",TRUE)  
             CALL cl_set_act_visible("unconfirmed,invalid,confirmed,hold",FALSE)
         
         WHEN "A"     #只能顯示確認; 其餘應用功能皆隱藏
             CALL cl_set_act_visible("confirmed ",TRUE)  
             CALL cl_set_act_visible("unconfirmed,invalid,hold",FALSE)

      END CASE]]>
</point>
  <point name="statechange.confirmed" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                      ]]>
</point>
  <point name="statechange.define" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                     DEFINE l_success  LIKE type_t.num5]]>
</point>
  <point name="statechange.invalid" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                      ]]>
</point>
  <point name="statechange.more_control" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                    ]]>
</point>
  <point name="statechange.open" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                      ]]>
</point>
  <point name="statechange.verify" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                      ]]>
</point>
  <point name="ui_browser_refresh.define" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                  ]]>
</point>
  <point name="ui_detailshow.after" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                  ]]>
</point>
  <point name="ui_detailshow.before" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                  ]]>
</point>
  <point name="ui_detailshow.define" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                  ]]>
</point>
  <point name="ui_dialog.action_default" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                    ]]>
</point>
  <point name="ui_dialog.before_dialog" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                  ]]>
</point>
  <point name="ui_dialog.before_dialog2" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            IF lb_first THEN
               LET lb_first = FALSE   
            END IF
            NEXT FIELD xmjbseq]]>
</point>
  <point name="ui_dialog.body2.action" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="ui_dialog.body2.before_display" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                          ]]>
</point>
  <point name="ui_dialog.body2.before_row" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                                          ]]>
</point>
  <point name="ui_dialog.body3.action" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="ui_dialog.body3.before_display" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[               CALL DIALOG.setCellAttributes(g_xmeg3_d_color)                                                            ]]>
</point>
  <point name="ui_dialog.body3.before_row" cite_std="N" status="" ver="3" src="s" new="N" mark_hard="N">
<![CDATA[               #CALL s_hint_show('xmek_t','xmeh_t',g_xmee_m.xmeedocno,g_xmee_m.xmee900,g_xmeg3_d[g_detail_idx].xmehseq,
               #                  g_xmeg3_d[g_detail_idx].xmehseq1,g_xmeg3_d[g_detail_idx].xmehseq2)                                                                           ]]>
</point>
  <point name="ui_dialog.body4.before_display" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[               CALL DIALOG.setCellAttributes(g_xmeg4_d_color) ]]>
</point>
  <point name="ui_dialog.body4.before_row" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[               CALL s_hint_show('xmek_t','xmjb_t',g_xmee_m.xmeedocno,g_xmee_m.xmee900,g_xmeg4_d[g_detail_idx].xmjbseq,'','') ]]>
</point>
  <point name="ui_dialog.body5.action" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="ui_dialog.body5.before_display" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[               CALL DIALOG.setCellAttributes(g_xmeg5_d_color)                                                                           ]]>
</point>
  <point name="ui_dialog.body5.before_row" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[               CALL s_hint_show('xmek_t','xmef_t',g_xmee_m.xmeedocno,g_xmee_m.xmee900,0,'','')                                                                            ]]>
</point>
  <point name="ui_dialog.define" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[   DEFINE l_pmaa004    LIKE pmaa_t.pmaa004 
   DEFINE l_rtiadocno  LIKE rtia_t.rtiadocno
   DEFINE l_success    LIKE type_t.num5]]>
</point>
  <point name="ui_dialog.more_displayarray" cite_std="N" status="" ver="3" src="s" new="N" mark_hard="N">
<![CDATA[         DISPLAY ARRAY g_xmeg7_d TO s_detail7.* ATTRIBUTES(COUNT=g_rec_b)  
    
            BEFORE ROW
               CALL adbt510_idx_chk()
               LET l_ac = DIALOG.getCurrentRow("s_detail7")
               LET g_detail_idx = l_ac
               
            BEFORE DISPLAY
               CALL FGL_SET_ARR_CURR(g_detail_idx)
               LET l_ac = DIALOG.getCurrentRow("s_detail7")
               LET g_current_page = 6
               CALL adbt510_idx_chk()
         END DISPLAY                                             ]]>
</point>
  <point name="ui_dialog.page1.action" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                                                        ]]>
</point>
  <point name="ui_dialog.page1.before_display" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[               CALL DIALOG.setCellAttributes(g_xmeg_d_color)                                                         ]]>
</point>
  <point name="ui_dialog.page1.before_row" cite_std="N" status="" ver="3" src="s" new="N" mark_hard="N">
<![CDATA[               #CALL s_hint_show('xmek_t','xmeg_t',g_xmee_m.xmeedocno,g_xmee_m.xmee900,g_xmeg_d[g_detail_idx].xmegseq,'','')                                                                            ]]>
</point>
  <point name="ui_headershow.define" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                  ]]>
</point>
  <point name="unlock_b.define" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                  ]]>
</point>
  <point name="unlock_b.other" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                  ]]>
</point>
  <point name="update_b.after_update" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                    ]]>
</point>
  <point name="update_b.after_update2" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                    ]]>
</point>
  <point name="update_b.after_update3" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                    ]]>
</point>
  <point name="update_b.before_update" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                    ]]>
</point>
  <point name="update_b.before_update2" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                    ]]>
</point>
  <point name="update_b.before_update3" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                    ]]>
</point>
  <point name="update_b.define" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                  ]]>
</point>
  <point name="update_b.m_update" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                    ]]>
</point>
  <point name="update_b.m_update2" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                    ]]>
</point>
  <point name="update_b.m_update3" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                                    ]]>
</point>
  <point name="update_b.other" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[                  ]]>
</point>
  <point name="global.memo" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="global.import" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="global.argv" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="main.after_refresh_sql" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="menu.detail_show.page1.open_adbt510_03" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="ui_dialog.body4.action" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="menu.detail_show.page4.open_adbt510_03" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="menu.detail_show.page4.open_adbt510_04" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="menu.bpm_status" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="ui_dialog.action.filter" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="ui_dialog.dialog.related_document" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="ui_dialog.dialog.agendum" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="ui_dialog.dialog.followup" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.xmee902" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.xmee902" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.c.xmee902" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.xmee900" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.xmee900" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.c.xmee900" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.xmee901" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.xmee901" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.c.xmee901" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.xmee202" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.xmee202" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.xmee200" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.xmee200" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.xmee201" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.xmee201" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.xmeeacti" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.xmeeacti" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.c.xmeeacti" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.xmee203" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.xmee203" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.xmeeunit" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.xmeeunit" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.xmee204" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.xmee204" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.xmee205" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.xmee205" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.c.xmee205" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.xmee071" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.xmee071" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.c.xmee071" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.xmee903" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.xmee903" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.xmee904" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.xmee904" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.c.xmee904" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.xmee025_desc" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.xmee025_desc" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.c.xmee025_desc" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.oofb017" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.oofb017" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.c.oofb017" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.xmee026_desc" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.xmee026_desc" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.c.xmee026_desc" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.oofb017_1" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.oofb017_1" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.c.oofb017_1" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.xmee206" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.xmee206" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.xmee207" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.xmee207" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.xmee011_desc" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.xmee011_desc" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.c.xmee011_desc" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.xmee035_desc" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.xmee035_desc" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.c.xmee035_desc" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page1.xmegsite" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page1.xmegsite" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.c.page1.xmegsite" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page1.xmeg016_desc" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page1.xmeg016_desc" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.c.page1.xmeg016_desc" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page1.xmeg017" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page1.xmeg017" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.c.page1.xmeg017" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page1.xmeg046" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page1.xmeg046" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.c.page1.xmeg046" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page1.xmeg047" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page1.xmeg047" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.c.page1.xmeg047" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page1.xmeg048" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page1.xmeg048" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.c.page1.xmeg048" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page1.xmeg051" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page1.xmeg051" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.c.page1.xmeg051" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page1.xmeg053" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page1.xmeg053" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page1.xmeg901" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page1.xmeg901" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.c.page1.xmeg901" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page1.xmeg902" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page1.xmeg902" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page1.xmeg903" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page1.xmeg903" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.c.page1.xmeg903" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page3.xmehdocno" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page3.xmehdocno" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.c.page3.xmehdocno" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page3.xmehseq" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page3.xmehseq" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.c.page3.xmehseq" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page3.xmehseq1" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page3.xmehseq1" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.c.page3.xmehseq1" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page3.xmeh229" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page3.xmeh229" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.c.page3.xmeh229" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page3.xmeh003" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page3.xmeh003" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.c.page3.xmeh003" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page3.xmeh001" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page3.xmeh001" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page3.xmeh002" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page3.xmeh002" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.c.page3.xmeh002" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page3.xmeh200" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page3.xmeh200" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page3.xmeh004" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page3.xmeh004" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page3.xmeh005" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page3.xmeh005" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.c.page3.xmeh005" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page3.xmeh011" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page3.xmeh011" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.c.page3.xmeh011" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page3.xmeh012" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page3.xmeh012" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.c.page3.xmeh012" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page3.xmehseq2" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page3.xmehseq2" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.c.page3.xmehseq2" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page3.xmeh006" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page3.xmeh006" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.c.page3.xmeh006" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page3.xmeh201" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page3.xmeh201" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page3.xmeh202" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page3.xmeh202" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.c.page3.xmeh202" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page3.xmeh024" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page3.xmeh024" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page3.xmeh025" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page3.xmeh025" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.c.page3.xmeh025" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page3.xmeh026" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page3.xmeh026" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page3.xmeh027" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page3.xmeh027" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.c.page3.xmeh027" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page3.xmeh203" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page3.xmeh203" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.c.page3.xmeh203" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page3.xmeh204" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page3.xmeh204" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.c.page3.xmeh204" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page3.xmeh205" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page3.xmeh205" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.c.page3.xmeh205" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page3.xmeh206" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page3.xmeh206" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.c.page3.xmeh206" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page3.xmeh029" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page3.xmeh029" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.c.page3.xmeh029" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page3.xmeh028" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page3.xmeh028" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.c.page3.xmeh028" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page3.xmeh019" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page3.xmeh019" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page3.xmeh019_desc" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page3.xmeh019_desc" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.c.page3.xmeh019_desc" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page3.xmeh030" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page3.xmeh030" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.c.page3.xmeh030" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page3.xmeh207" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page3.xmeh207" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page3.xmehunit" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page3.xmehunit" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page3.xmeh210" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page3.xmeh210" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page3.xmeh212" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page3.xmeh212" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.c.page3.xmeh212" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page3.xmeh213" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page3.xmeh213" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page3.xmeh214" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page3.xmeh214" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page3.xmeh215" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page3.xmeh215" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.c.page3.xmeh215" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page3.xmeh031" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page3.xmeh031" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.c.page3.xmeh031" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page3.xmeh014" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page3.xmeh014" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.c.page3.xmeh014" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page3.xmeh015" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page3.xmeh015" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.c.page3.xmeh015" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page3.xmeh016" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page3.xmeh016" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.c.page3.xmeh016" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page3.xmeh017" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page3.xmeh017" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page3.xmeh221" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page3.xmeh221" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.c.page3.xmeh221" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page3.xmehsite" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page3.xmehsite" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page3.xmeh218" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page3.xmeh218" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page3.xmeh219" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page3.xmeh219" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page3.xmeh220" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page3.xmeh220" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page3.xmeh222" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page3.xmeh222" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page3.xmeh223" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page3.xmeh223" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page3.xmeh224" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page3.xmeh224" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page3.xmehorga" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page3.xmehorga" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page3.xmeh226" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page3.xmeh226" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.c.page3.xmeh226" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page3.xmeh227" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page3.xmeh227" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page3.xmeh228" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page3.xmeh228" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page3.xmeh901" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page3.xmeh901" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.c.page3.xmeh901" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page4.xmjbseq" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page4.xmjbseq" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.c.page4.xmjbseq" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page4.xmjbsite" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page4.xmjbsite" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page4.xmjb001" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page4.xmjb001" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.c.page4.xmjb001" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page4.xmjb002" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page4.xmjb002" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page4.xmjb003" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page4.xmjb003" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page4.xmjb033" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page4.xmjb033" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page4.xmjb004" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page4.xmjb004" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page4.xmjb005" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page4.xmjb005" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page4.xmjb006" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page4.xmjb006" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page4.xmjb006_desc" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page4.xmjb006_desc" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.c.page4.xmjb006_desc" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page4.xmjb007" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page4.xmjb007" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.c.page4.xmjb007" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page4.xmjb011" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page4.xmjb011" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page4.xmjb012" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page4.xmjb012" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.c.page4.xmjb012" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page4.xmjb013" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page4.xmjb013" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page4.xmjb014" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page4.xmjb014" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.c.page4.xmjb014" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page4.xmjb015" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page4.xmjb015" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page4.xmjb016" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page4.xmjb016" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.c.page4.xmjb016" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page4.xmjb017" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page4.xmjb017" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page4.xmjb018" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page4.xmjb018" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.c.page4.xmjb018" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page4.xmjb008" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page4.xmjb008" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.c.page4.xmjb008" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page4.xmjb009" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page4.xmjb009" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.c.page4.xmjb009" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page4.xmjb010" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page4.xmjb010" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.c.page4.xmjb010" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page4.xmjb022" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page4.xmjb022" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.c.page4.xmjb022" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page4.xmjb019" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page4.xmjb019" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.c.page4.xmjb019" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page4.xmjb020" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page4.xmjb020" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.c.page4.xmjb020" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page4.xmjb021" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page4.xmjb021" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.c.page4.xmjb021" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page4.xmjb024" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page4.xmjb024" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page4.xmjb025" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page4.xmjb025" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.c.page4.xmjb025" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page4.xmjb026" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page4.xmjb026" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page4.xmjb027" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page4.xmjb027" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page4.xmjb028" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page4.xmjb028" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page4.xmjb029" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page4.xmjb029" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.c.page4.xmjb029" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page4.xmjb030" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page4.xmjb030" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.c.page4.xmjb030" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page4.xmjb031" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page4.xmjb031" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.c.page4.xmjb031" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page4.xmjb032" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page4.xmjb032" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.c.page4.xmjb032" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page4.xmjb034" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page4.xmjb034" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.c.page4.xmjb034" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page4.xmjb901" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page4.xmjb901" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.c.page4.xmjb901" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page4.xmjb902" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page4.xmjb902" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page4.xmjb903" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page4.xmjb903" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.c.page4.xmjb903" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="cs.body4.before_construct" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page5.xmefsite" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page5.xmefsite" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.c.page5.xmefsite" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page5.xmef001" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page5.xmef001" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.c.page5.xmef001" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page5.xmef002" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page5.xmef002" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page5.xmef003" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page5.xmef003" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.c.page5.xmef003" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page5.xmef004" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page5.xmef004" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.c.page5.xmef004" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page5.xmef005" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page5.xmef005" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.c.page5.xmef005" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page5.xmef006" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page5.xmef006" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.c.page5.xmef006" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page5.xmef007" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page5.xmef007" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.c.page5.xmef007" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page5.xmef008" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page5.xmef008" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.c.page5.xmef008" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page5.xmef009" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page5.xmef009" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.c.page5.xmef009" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page5.xmef901" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page5.xmef901" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.c.page5.xmef901" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page5.xmef902" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page5.xmef902" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.b.page5.xmef903" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.a.page5.xmef903" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="construct.c.page5.xmef903" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="filter.cs_ctrl" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="modify.before_show" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="modify.body.b_fk_update4" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="modify.body.m_fk_update4" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="modify.body.a_fk_update4" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.define_sql4" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.after_define_sql4" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.b.xmee902" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.a.xmee902" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.g.xmee902" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.b.xmee900" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.g.xmee900" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.b.xmee901" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.a.xmee901" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.g.xmee901" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.g.xmee200" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.b.xmee201" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.g.xmee201" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.b.xmeeacti" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.a.xmeeacti" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.g.xmeeacti" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.b.xmee203" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.g.xmee203" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.b.xmeeunit" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.g.xmeeunit" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.b.xmee071" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.a.xmee071" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.g.xmee071" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.b.xmee903" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.g.xmee903" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.b.xmee904" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.a.xmee904" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.g.xmee904" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.c.xmee902" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.c.xmee900" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.c.xmee901" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.c.xmeeacti" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.c.xmee071" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.c.xmee904" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.head.after_input" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.body.before_row2" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.b.page1.xmegsite" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.a.page1.xmegsite" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.g.page1.xmegsite" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.c.page1.xmegsite" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.body.after_row2" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.body4.before_row" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.body4.m_delete" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.body4.after_delete" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.body4.b_insert" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.body4.a_insert" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.body4.m_update" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.b.page4.xmjb001" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.a.page4.xmjb001" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.g.page4.xmjb001" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.g.page4.xmjb003" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.g.page4.xmjb015" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.b.page4.xmjb016" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.g.page4.xmjb016" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.g.page4.xmjb024" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.b.page4.xmjb026" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.g.page4.xmjb026" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.b.page4.xmjb030" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.g.page4.xmjb030" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.b.page4.xmjb031" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.g.page4.xmjb031" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.b.page4.xmjb032" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.g.page4.xmjb032" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.b.page4.xmjb034" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.a.page4.xmjb034" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.g.page4.xmjb034" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.b.page4.xmjb901" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.a.page4.xmjb901" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.g.page4.xmjb901" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.b.page4.xmjb902" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.g.page4.xmjb902" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.b.page4.xmjb903" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.a.page4.xmjb903" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.g.page4.xmjb903" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.c.page4.xmjb001" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.c.page4.xmjb016" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.c.page4.xmjb030" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.c.page4.xmjb031" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.c.page4.xmjb032" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.c.page4.xmjb034" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.c.page4.xmjb901" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.c.page4.xmjb903" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.body4.after_input" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.body3.action" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.accept" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="show.follow_pic" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="detail_reproduce.body.table4.b_insert" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="detail_reproduce.body.table4.m_insert" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="detail_reproduce.body.table4.a_insert" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="delete.before_ask" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="delete.befroe.related_document_remove" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="delete.body.b_delete4" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="delete.body.m_delete4" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="delete.lang.delete" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="b_fill.body4.fill_sql" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="b_fill.sql4" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="delete_b.b_delete4" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="delete_b.m_delete4" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="delete_b.a_delete4" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="insert_b.before_insert4" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="insert_b.m_insert4" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="insert_b.after_insert4" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="update_b.before_update4" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="update_b.m_update4" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="update_b.after_update4" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="statechange.unconfirmed" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="statechange.approved" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="statechange.withdraw" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="statechange.rejection" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="statechange.signing" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="fill_chk.before_chk" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="send.define" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="send.after_send" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="draw.define" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="set_pk_array.define" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="set_pk_array.before" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="set_pk_array.after" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="function.adbt510_xmjb902_ref" cite_std="N" status="u" ver="" src="s" new="Y" order="113">
<![CDATA[
PRIVATE FUNCTION adbt510_xmjb902_ref()
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmeg4_d[l_ac].xmjb902
            CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='267' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmeg4_d[l_ac].xmjb902_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmeg4_d[l_ac].xmjb902_desc
END FUNCTION]]>
</point>
  <point name="function.adbt510_xmee903_ref" cite_std="N" status="u" ver="" src="s" new="Y" order="114">
<![CDATA[
PRIVATE FUNCTION adbt510_xmee903_ref()
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmee_m.xmee903
            CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='267' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmee_m.xmee903_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmee_m.xmee903_desc
END FUNCTION]]>
</point>
  <point name="function.adbt510_xmef902_ref" cite_std="N" status="u" ver="" src="s" new="Y" order="115">
<![CDATA[
PRIVATE FUNCTION adbt510_xmef902_ref()
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmeg5_d[l_ac].xmef902
            CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='267' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmeg5_d[l_ac].xmef902_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmeg5_d[l_ac].xmef902_desc
END FUNCTION]]>
</point>
  <section id="adbt510.b_fill" ver="93" status="" src="s">
<![CDATA[#+ 單身陣列填充
PRIVATE FUNCTION adbt510_b_fill()
   DEFINE p_wc2      STRING
   #add-point:b_fill段define
   {<point name="b_fill.define"/>}
   #end add-point     
 
   CALL g_xmeg_d.clear()    #g_xmeg_d 單頭及單身 
   CALL g_xmeg3_d.clear()
   CALL g_xmeg4_d.clear()
   CALL g_xmeg5_d.clear()
 
 
   #add-point:b_fill段sql_before
   {<point name="b_fill.sql_before"/>}
   #end add-point
   
   #判斷是否填充
   IF adbt510_fill_chk(1) THEN
   
      LET g_sql = "SELECT  UNIQUE xmegsite,xmegseq,xmeg027,xmeg001,xmeg002,xmeg004,xmeg005,xmeg006,xmeg007, 
          xmeg008,xmeg009,xmeg024,xmeg012,xmeg013,xmeg045,xmeg010,xmeg011,xmeg015,xmeg016,xmeg017,xmeg046, 
          xmeg047,xmeg048,xmeg023,xmeg019,xmeg020,xmeg021,xmeg022,xmeg051,xmegunit,xmegorga,xmeg052, 
          xmeg049,xmeg053,xmeg050,xmeg901,xmeg902,xmeg903 ,t1.imaal003 ,t2.imaal004 ,t3.oocql004 ,t4.oocal003 , 
          t5.oocal003 ,t6.oocal003 ,t7.ooefl003 ,t8.ooefl003 ,t9.oocql004 ,t10.oocql004 ,t11.oocql004 FROM xmeg_t", 
             
                  " INNER JOIN xmee_t ON xmeedocno = xmegdocno ",
                  " AND xmee900 = xmeg900 ",
 
                  #"",
                  
                  "",
                                 " LEFT JOIN imaal_t t1 ON t1.imaalent='"||g_enterprise||"' AND t1.imaal001=xmeg001 AND t1.imaal002='"||g_dlang||"' ",
               " LEFT JOIN imaal_t t2 ON t2.imaalent='"||g_enterprise||"' AND t2.imaal001=xmeg001 AND t2.imaal002='"||g_dlang||"' ",
               " LEFT JOIN oocql_t t3 ON t3.oocqlent='"||g_enterprise||"' AND t3.oocql001='221' AND t3.oocql002=xmeg004 AND t3.oocql003='"||g_dlang||"' ",
               " LEFT JOIN oocal_t t4 ON t4.oocalent='"||g_enterprise||"' AND t4.oocal001=xmeg006 AND t4.oocal002='"||g_dlang||"' ",
               " LEFT JOIN oocal_t t5 ON t5.oocalent='"||g_enterprise||"' AND t5.oocal001=xmeg008 AND t5.oocal002='"||g_dlang||"' ",
               " LEFT JOIN oocal_t t6 ON t6.oocalent='"||g_enterprise||"' AND t6.oocal001=xmeg010 AND t6.oocal002='"||g_dlang||"' ",
               " LEFT JOIN ooefl_t t7 ON t7.ooeflent='"||g_enterprise||"' AND t7.ooefl001=xmegunit AND t7.ooefl002='"||g_dlang||"' ",
               " LEFT JOIN ooefl_t t8 ON t8.ooeflent='"||g_enterprise||"' AND t8.ooefl001=xmegorga AND t8.ooefl002='"||g_dlang||"' ",
               " LEFT JOIN oocql_t t9 ON t9.oocqlent='"||g_enterprise||"' AND t9.oocql001='265' AND t9.oocql002=xmeg049 AND t9.oocql003='"||g_dlang||"' ",
               " LEFT JOIN oocql_t t10 ON t10.oocqlent='"||g_enterprise||"' AND t10.oocql001='265' AND t10.oocql002=xmeg053 AND t10.oocql003='"||g_dlang||"' ",
               " LEFT JOIN oocql_t t11 ON t11.oocqlent='"||g_enterprise||"' AND t11.oocql001='267' AND t11.oocql002=xmeg902 AND t11.oocql003='"||g_dlang||"' ",
 
                  " WHERE xmegent=? AND xmegdocno=? AND xmeg900=?"
      LET g_sql = cl_sql_add_mask(g_sql)              #遮蔽特定資料
      #add-point:b_fill段sql_before
      {<point name="b_fill.body.fill_sql"/>}
      #end add-point
      IF NOT cl_null(g_wc2_table1) THEN
         LET g_sql = g_sql CLIPPED, " AND ", g_wc2_table1 CLIPPED
      END IF
      
      #子單身的WC
      
      
      LET g_sql = g_sql, " ORDER BY xmeg_t.xmegseq"
      
      #add-point:單身填充控制
      {<point name="b_fill.sql"/>}
      #end add-point
      
      LET g_sql = cl_sql_add_mask(g_sql)              #遮蔽特定資料
      PREPARE adbt510_pb FROM g_sql
      DECLARE b_fill_cs CURSOR FOR adbt510_pb
      
      LET g_cnt = l_ac
      LET l_ac = 1
      
      OPEN b_fill_cs USING g_enterprise,g_xmee_m.xmeedocno,g_xmee_m.xmee900
                                               
      FOREACH b_fill_cs INTO g_xmeg_d[l_ac].xmegsite,g_xmeg_d[l_ac].xmegseq,g_xmeg_d[l_ac].xmeg027,g_xmeg_d[l_ac].xmeg001, 
          g_xmeg_d[l_ac].xmeg002,g_xmeg_d[l_ac].xmeg004,g_xmeg_d[l_ac].xmeg005,g_xmeg_d[l_ac].xmeg006, 
          g_xmeg_d[l_ac].xmeg007,g_xmeg_d[l_ac].xmeg008,g_xmeg_d[l_ac].xmeg009,g_xmeg_d[l_ac].xmeg024, 
          g_xmeg_d[l_ac].xmeg012,g_xmeg_d[l_ac].xmeg013,g_xmeg_d[l_ac].xmeg045,g_xmeg_d[l_ac].xmeg010, 
          g_xmeg_d[l_ac].xmeg011,g_xmeg_d[l_ac].xmeg015,g_xmeg_d[l_ac].xmeg016,g_xmeg_d[l_ac].xmeg017, 
          g_xmeg_d[l_ac].xmeg046,g_xmeg_d[l_ac].xmeg047,g_xmeg_d[l_ac].xmeg048,g_xmeg_d[l_ac].xmeg023, 
          g_xmeg_d[l_ac].xmeg019,g_xmeg_d[l_ac].xmeg020,g_xmeg_d[l_ac].xmeg021,g_xmeg_d[l_ac].xmeg022, 
          g_xmeg_d[l_ac].xmeg051,g_xmeg_d[l_ac].xmegunit,g_xmeg_d[l_ac].xmegorga,g_xmeg_d[l_ac].xmeg052, 
          g_xmeg_d[l_ac].xmeg049,g_xmeg_d[l_ac].xmeg053,g_xmeg_d[l_ac].xmeg050,g_xmeg_d[l_ac].xmeg901, 
          g_xmeg_d[l_ac].xmeg902,g_xmeg_d[l_ac].xmeg903,g_xmeg_d[l_ac].xmeg001_desc,g_xmeg_d[l_ac].xmeg001_desc_desc, 
          g_xmeg_d[l_ac].xmeg004_desc,g_xmeg_d[l_ac].xmeg006_desc,g_xmeg_d[l_ac].xmeg008_desc,g_xmeg_d[l_ac].xmeg010_desc, 
          g_xmeg_d[l_ac].xmegunit_desc,g_xmeg_d[l_ac].xmegorga_desc,g_xmeg_d[l_ac].xmeg049_desc,g_xmeg_d[l_ac].xmeg053_desc, 
          g_xmeg_d[l_ac].xmeg902_desc
         IF SQLCA.sqlcode THEN
            CALL cl_err("FOREACH:",SQLCA.sqlcode,1)
            EXIT FOREACH
         END IF
        
         #add-point:b_fill段資料填充
         {<point name="b_fill.fill"/>}
         #end add-point
      
         LET l_ac = l_ac + 1
         IF l_ac > g_max_rec THEN
            IF g_error_show = 1 THEN
               CALL cl_err( '', 9035, 1)
            END IF
            EXIT FOREACH
         END IF
         
      END FOREACH
      LET g_error_show = 0
   
   END IF
   
   #判斷是否填充
   IF adbt510_fill_chk(2) THEN
      LET g_sql = "SELECT  UNIQUE xmehdocno,xmehseq,xmehseq1,xmeh229,xmeh003,xmeh001,xmeh002,xmeh200, 
          xmeh004,xmeh005,xmeh011,xmeh012,xmehseq2,xmeh006,xmeh201,xmeh202,xmeh024,xmeh025,xmeh026,xmeh027, 
          xmeh203,xmeh204,xmeh205,xmeh206,xmeh029,xmeh028,xmeh019,xmeh030,xmeh207,xmehunit,xmeh210,xmeh212, 
          xmeh213,xmeh214,xmeh215,xmeh031,xmeh014,xmeh015,xmeh016,xmeh017,xmeh221,xmehsite,xmeh218,xmeh219, 
          xmeh220,xmeh222,xmeh223,xmeh224,xmehorga,xmeh226,xmeh227,xmeh228,xmeh901 ,t12.imaal003 ,t13.imaal004 , 
          t14.prcfl003 ,t15.oocal003 ,t16.oocal003 ,t17.oocal003 ,t18.oocal003 ,t19.pmaal004 ,t20.ooefl003 , 
          t21.oocql004 ,t22.inaa002 ,t23.inab003 ,t24.ooefl003 ,t25.oojdl003 ,t26.dbbal003 ,t27.dbbcl003 , 
          t28.ooefl003 ,t29.oofa011 ,t30.ooefl003 ,t31.ooefl003 ,t32.oocql004 ,t33.staal003 FROM xmeh_t", 
             
                  " INNER JOIN xmee_t ON xmeedocno = xmehdocno ",
                  " AND xmee900 = xmeh900 ",
 
                  "",
                  
                                 " LEFT JOIN imaal_t t12 ON t12.imaalent='"||g_enterprise||"' AND t12.imaal001=xmeh001 AND t12.imaal002='"||g_dlang||"' ",
               " LEFT JOIN imaal_t t13 ON t13.imaalent='"||g_enterprise||"' AND t13.imaal001=xmeh001 AND t13.imaal002='"||g_dlang||"' ",
               " LEFT JOIN prcfl_t t14 ON t14.prcflent='"||g_enterprise||"' AND t14.prcfl001=xmeh200 AND t14.prcfl002='"||g_dlang||"' ",
               " LEFT JOIN oocal_t t15 ON t15.oocalent='"||g_enterprise||"' AND t15.oocal001=xmeh004 AND t15.oocal002='"||g_dlang||"' ",
               " LEFT JOIN oocal_t t16 ON t16.oocalent='"||g_enterprise||"' AND t16.oocal001=xmeh201 AND t16.oocal002='"||g_dlang||"' ",
               " LEFT JOIN oocal_t t17 ON t17.oocalent='"||g_enterprise||"' AND t17.oocal001=xmeh024 AND t17.oocal002='"||g_dlang||"' ",
               " LEFT JOIN oocal_t t18 ON t18.oocalent='"||g_enterprise||"' AND t18.oocal001=xmeh026 AND t18.oocal002='"||g_dlang||"' ",
               " LEFT JOIN pmaal_t t19 ON t19.pmaalent='"||g_enterprise||"' AND t19.pmaal001=xmeh207 AND t19.pmaal002='"||g_dlang||"' ",
               " LEFT JOIN ooefl_t t20 ON t20.ooeflent='"||g_enterprise||"' AND t20.ooefl001=xmehunit AND t20.ooefl002='"||g_dlang||"' ",
               " LEFT JOIN oocql_t t21 ON t21.oocqlent='"||g_enterprise||"' AND t21.oocql001='274' AND t21.oocql002=xmeh210 AND t21.oocql003='"||g_dlang||"' ",
               " LEFT JOIN inaa_t t22 ON t22.inaaent='"||g_enterprise||"' AND t22.inaasite=xmehunit AND t22.inaa001=xmeh213  ",
               " LEFT JOIN inab_t t23 ON t23.inabent='"||g_enterprise||"' AND t23.inabsite=xmehunit AND t23.inab001=xmeh213 AND t23.inab002=xmeh214  ",
               " LEFT JOIN ooefl_t t24 ON t24.ooeflent='"||g_enterprise||"' AND t24.ooefl001=xmehsite AND t24.ooefl002='"||g_dlang||"' ",
               " LEFT JOIN oojdl_t t25 ON t25.oojdlent='"||g_enterprise||"' AND t25.oojdl001=xmeh218 AND t25.oojdl002='"||g_dlang||"' ",
               " LEFT JOIN dbbal_t t26 ON t26.dbbalent='"||g_enterprise||"' AND t26.dbbal001=xmeh219 AND t26.dbbal002='"||g_dlang||"' ",
               " LEFT JOIN dbbcl_t t27 ON t27.dbbclent='"||g_enterprise||"' AND t27.dbbcl001=xmeh220 AND t27.dbbcl002='"||g_dlang||"' ",
               " LEFT JOIN ooefl_t t28 ON t28.ooeflent='"||g_enterprise||"' AND t28.ooefl001=xmeh222 AND t28.ooefl002='"||g_dlang||"' ",
               " LEFT JOIN oofa_t t29 ON t29.oofaent='"||g_enterprise||"' AND t29.oofa002='2' AND t29.oofa003=xmeh223  ",
               " LEFT JOIN ooefl_t t30 ON t30.ooeflent='"||g_enterprise||"' AND t30.ooefl001=xmeh224 AND t30.ooefl002='"||g_dlang||"' ",
               " LEFT JOIN ooefl_t t31 ON t31.ooeflent='"||g_enterprise||"' AND t31.ooefl001=xmehorga AND t31.ooefl002='"||g_dlang||"' ",
               " LEFT JOIN oocql_t t32 ON t32.oocqlent='"||g_enterprise||"' AND t32.oocql001='2060' AND t32.oocql002=xmeh227 AND t32.oocql003='"||g_dlang||"' ",
               " LEFT JOIN staal_t t33 ON t33.staalent='"||g_enterprise||"' AND t33.staal001=xmeh228 AND t33.staal002='"||g_dlang||"' ",
 
                  " WHERE xmehent=? AND xmehdocno=? AND xmeh900=?"   
      LET g_sql = cl_sql_add_mask(g_sql)              #遮蔽特定資料
      #add-point:b_fill段sql_before
      {<point name="b_fill.body2.fill_sql"/>}
      #end add-point
      IF NOT cl_null(g_wc2_table2) THEN
         LET g_sql = g_sql CLIPPED," AND ",g_wc2_table2 CLIPPED
      END IF
      
      #子單身的WC
      
      
      LET g_sql = g_sql, " ORDER BY xmeh_t.xmehseq,xmeh_t.xmehseq1,xmeh_t.xmehseq2"
      
      #add-point:單身填充控制
      {<point name="b_fill.sql2"/>}
      #end add-point
      
      LET g_sql = cl_sql_add_mask(g_sql)              #遮蔽特定資料
      PREPARE adbt510_pb2 FROM g_sql
      DECLARE b_fill_cs2 CURSOR FOR adbt510_pb2
      
      LET l_ac = 1
      
      OPEN b_fill_cs2 USING g_enterprise,g_xmee_m.xmeedocno,g_xmee_m.xmee900
                                               
      FOREACH b_fill_cs2 INTO g_xmeg3_d[l_ac].xmehdocno,g_xmeg3_d[l_ac].xmehseq,g_xmeg3_d[l_ac].xmehseq1, 
          g_xmeg3_d[l_ac].xmeh229,g_xmeg3_d[l_ac].xmeh003,g_xmeg3_d[l_ac].xmeh001,g_xmeg3_d[l_ac].xmeh002, 
          g_xmeg3_d[l_ac].xmeh200,g_xmeg3_d[l_ac].xmeh004,g_xmeg3_d[l_ac].xmeh005,g_xmeg3_d[l_ac].xmeh011, 
          g_xmeg3_d[l_ac].xmeh012,g_xmeg3_d[l_ac].xmehseq2,g_xmeg3_d[l_ac].xmeh006,g_xmeg3_d[l_ac].xmeh201, 
          g_xmeg3_d[l_ac].xmeh202,g_xmeg3_d[l_ac].xmeh024,g_xmeg3_d[l_ac].xmeh025,g_xmeg3_d[l_ac].xmeh026, 
          g_xmeg3_d[l_ac].xmeh027,g_xmeg3_d[l_ac].xmeh203,g_xmeg3_d[l_ac].xmeh204,g_xmeg3_d[l_ac].xmeh205, 
          g_xmeg3_d[l_ac].xmeh206,g_xmeg3_d[l_ac].xmeh029,g_xmeg3_d[l_ac].xmeh028,g_xmeg3_d[l_ac].xmeh019, 
          g_xmeg3_d[l_ac].xmeh030,g_xmeg3_d[l_ac].xmeh207,g_xmeg3_d[l_ac].xmehunit,g_xmeg3_d[l_ac].xmeh210, 
          g_xmeg3_d[l_ac].xmeh212,g_xmeg3_d[l_ac].xmeh213,g_xmeg3_d[l_ac].xmeh214,g_xmeg3_d[l_ac].xmeh215, 
          g_xmeg3_d[l_ac].xmeh031,g_xmeg3_d[l_ac].xmeh014,g_xmeg3_d[l_ac].xmeh015,g_xmeg3_d[l_ac].xmeh016, 
          g_xmeg3_d[l_ac].xmeh017,g_xmeg3_d[l_ac].xmeh221,g_xmeg3_d[l_ac].xmehsite,g_xmeg3_d[l_ac].xmeh218, 
          g_xmeg3_d[l_ac].xmeh219,g_xmeg3_d[l_ac].xmeh220,g_xmeg3_d[l_ac].xmeh222,g_xmeg3_d[l_ac].xmeh223, 
          g_xmeg3_d[l_ac].xmeh224,g_xmeg3_d[l_ac].xmehorga,g_xmeg3_d[l_ac].xmeh226,g_xmeg3_d[l_ac].xmeh227, 
          g_xmeg3_d[l_ac].xmeh228,g_xmeg3_d[l_ac].xmeh901,g_xmeg3_d[l_ac].xmeh001_desc,g_xmeg3_d[l_ac].xmeh001_desc_desc, 
          g_xmeg3_d[l_ac].xmeh200_desc,g_xmeg3_d[l_ac].xmeh004_desc,g_xmeg3_d[l_ac].xmeh201_desc,g_xmeg3_d[l_ac].xmeh024_desc, 
          g_xmeg3_d[l_ac].xmeh026_desc,g_xmeg3_d[l_ac].xmeh207_desc,g_xmeg3_d[l_ac].xmehunit_desc,g_xmeg3_d[l_ac].xmeh210_desc, 
          g_xmeg3_d[l_ac].xmeh213_desc,g_xmeg3_d[l_ac].xmeh214_desc,g_xmeg3_d[l_ac].xmehsite_desc,g_xmeg3_d[l_ac].xmeh218_desc, 
          g_xmeg3_d[l_ac].xmeh219_desc,g_xmeg3_d[l_ac].xmeh220_desc,g_xmeg3_d[l_ac].xmeh222_desc,g_xmeg3_d[l_ac].xmeh223_desc, 
          g_xmeg3_d[l_ac].xmeh224_desc,g_xmeg3_d[l_ac].xmehorga_desc,g_xmeg3_d[l_ac].xmeh227_desc,g_xmeg3_d[l_ac].xmeh228_desc 

         IF SQLCA.sqlcode THEN
            CALL cl_err("FOREACH:",SQLCA.sqlcode,1)
            EXIT FOREACH
         END IF
        
         #add-point:b_fill段資料填充
         {<point name="b_fill2.fill"/>}
         #end add-point
      
         LET l_ac = l_ac + 1
         IF l_ac > g_max_rec THEN
            CALL cl_err( '', 9035, 0 )
            EXIT FOREACH
         END IF
         
      END FOREACH
   END IF
 
   #判斷是否填充
   IF adbt510_fill_chk(3) THEN
      LET g_sql = "SELECT  UNIQUE xmjbunit,xmjbseq,xmjbsite,xmjb001,xmjb002,xmjb003,xmjb033,xmjb004, 
          xmjb005,xmjb006,xmjb007,xmjb011,xmjb012,xmjb013,xmjb014,xmjb015,xmjb016,xmjb017,xmjb018,xmjb008, 
          xmjb009,xmjb010,xmjb022,xmjb019,xmjb020,xmjb021,xmjb024,xmjb025,xmjb026,xmjb027,xmjb028,xmjb029, 
          xmjb030,xmjb031,xmjb032,xmjb034,xmjb901,xmjb902,xmjb903 ,t34.ooefl003 ,t35.imaal003 ,t36.imaal004 , 
          t37.prcfl003 ,t38.oocal003 ,t39.oocal003 ,t40.oocal003 ,t41.oocal003 ,t42.pmaal004 ,t43.dbadl003 , 
          t44.oocql004 FROM xmjb_t",   
                  " INNER JOIN xmee_t ON xmeedocno = xmjbdocno ",
                  " AND xmee900 = xmjb900 ",
 
                  "",
                  
                                 " LEFT JOIN ooefl_t t34 ON t34.ooeflent='"||g_enterprise||"' AND t34.ooefl001=xmjbsite AND t34.ooefl002='"||g_dlang||"' ",
               " LEFT JOIN imaal_t t35 ON t35.imaalent='"||g_enterprise||"' AND t35.imaal001=xmjb003 AND t35.imaal002='"||g_dlang||"' ",
               " LEFT JOIN imaal_t t36 ON t36.imaalent='"||g_enterprise||"' AND t36.imaal001=xmjb003 AND t36.imaal002='"||g_dlang||"' ",
               " LEFT JOIN prcfl_t t37 ON t37.prcflent='"||g_enterprise||"' AND t37.prcfl001=xmjb005 AND t37.prcfl002='"||g_dlang||"' ",
               " LEFT JOIN oocal_t t38 ON t38.oocalent='"||g_enterprise||"' AND t38.oocal001=xmjb011 AND t38.oocal002='"||g_dlang||"' ",
               " LEFT JOIN oocal_t t39 ON t39.oocalent='"||g_enterprise||"' AND t39.oocal001=xmjb013 AND t39.oocal002='"||g_dlang||"' ",
               " LEFT JOIN oocal_t t40 ON t40.oocalent='"||g_enterprise||"' AND t40.oocal001=xmjb015 AND t40.oocal002='"||g_dlang||"' ",
               " LEFT JOIN oocal_t t41 ON t41.oocalent='"||g_enterprise||"' AND t41.oocal001=xmjb017 AND t41.oocal002='"||g_dlang||"' ",
               " LEFT JOIN pmaal_t t42 ON t42.pmaalent='"||g_enterprise||"' AND t42.pmaal001=xmjb024 AND t42.pmaal002='"||g_dlang||"' ",
               " LEFT JOIN dbadl_t t43 ON t43.dbadlent='"||g_enterprise||"' AND t43.dbadl001=xmjb027 AND t43.dbadl002='"||g_dlang||"' ",
               " LEFT JOIN oocql_t t44 ON t44.oocqlent='"||g_enterprise||"' AND t44.oocql001='267' AND t44.oocql002=xmjb902 AND t44.oocql003='"||g_dlang||"' ",
 
                  " WHERE xmjbent=? AND xmjbdocno=? AND xmjb900=?"   
      LET g_sql = cl_sql_add_mask(g_sql)              #遮蔽特定資料
      #add-point:b_fill段sql_before
      {<point name="b_fill.body3.fill_sql"/>}
      #end add-point
      IF NOT cl_null(g_wc2_table3) THEN
         LET g_sql = g_sql CLIPPED," AND ",g_wc2_table3 CLIPPED
      END IF
      
      #子單身的WC
      
      
      LET g_sql = g_sql, " ORDER BY xmjb_t.xmjbseq"
      
      #add-point:單身填充控制
      {<point name="b_fill.sql3"/>}
      #end add-point
      
      LET g_sql = cl_sql_add_mask(g_sql)              #遮蔽特定資料
      PREPARE adbt510_pb3 FROM g_sql
      DECLARE b_fill_cs3 CURSOR FOR adbt510_pb3
      
      LET l_ac = 1
      
      OPEN b_fill_cs3 USING g_enterprise,g_xmee_m.xmeedocno,g_xmee_m.xmee900
                                               
      FOREACH b_fill_cs3 INTO g_xmeg4_d[l_ac].xmjbunit,g_xmeg4_d[l_ac].xmjbseq,g_xmeg4_d[l_ac].xmjbsite, 
          g_xmeg4_d[l_ac].xmjb001,g_xmeg4_d[l_ac].xmjb002,g_xmeg4_d[l_ac].xmjb003,g_xmeg4_d[l_ac].xmjb033, 
          g_xmeg4_d[l_ac].xmjb004,g_xmeg4_d[l_ac].xmjb005,g_xmeg4_d[l_ac].xmjb006,g_xmeg4_d[l_ac].xmjb007, 
          g_xmeg4_d[l_ac].xmjb011,g_xmeg4_d[l_ac].xmjb012,g_xmeg4_d[l_ac].xmjb013,g_xmeg4_d[l_ac].xmjb014, 
          g_xmeg4_d[l_ac].xmjb015,g_xmeg4_d[l_ac].xmjb016,g_xmeg4_d[l_ac].xmjb017,g_xmeg4_d[l_ac].xmjb018, 
          g_xmeg4_d[l_ac].xmjb008,g_xmeg4_d[l_ac].xmjb009,g_xmeg4_d[l_ac].xmjb010,g_xmeg4_d[l_ac].xmjb022, 
          g_xmeg4_d[l_ac].xmjb019,g_xmeg4_d[l_ac].xmjb020,g_xmeg4_d[l_ac].xmjb021,g_xmeg4_d[l_ac].xmjb024, 
          g_xmeg4_d[l_ac].xmjb025,g_xmeg4_d[l_ac].xmjb026,g_xmeg4_d[l_ac].xmjb027,g_xmeg4_d[l_ac].xmjb028, 
          g_xmeg4_d[l_ac].xmjb029,g_xmeg4_d[l_ac].xmjb030,g_xmeg4_d[l_ac].xmjb031,g_xmeg4_d[l_ac].xmjb032, 
          g_xmeg4_d[l_ac].xmjb034,g_xmeg4_d[l_ac].xmjb901,g_xmeg4_d[l_ac].xmjb902,g_xmeg4_d[l_ac].xmjb903, 
          g_xmeg4_d[l_ac].xmjbsite_desc,g_xmeg4_d[l_ac].xmjb003_desc,g_xmeg4_d[l_ac].xmjb003_desc_desc, 
          g_xmeg4_d[l_ac].xmjb005_desc,g_xmeg4_d[l_ac].xmjb011_desc,g_xmeg4_d[l_ac].xmjb013_desc,g_xmeg4_d[l_ac].xmjb015_desc, 
          g_xmeg4_d[l_ac].xmjb017_desc,g_xmeg4_d[l_ac].xmjb024_desc,g_xmeg4_d[l_ac].xmjb027_desc,g_xmeg4_d[l_ac].xmjb902_desc 

         IF SQLCA.sqlcode THEN
            CALL cl_err("FOREACH:",SQLCA.sqlcode,1)
            EXIT FOREACH
         END IF
        
         #add-point:b_fill段資料填充
         {<point name="b_fill3.fill"/>}
         #end add-point
      
         LET l_ac = l_ac + 1
         IF l_ac > g_max_rec THEN
            CALL cl_err( '', 9035, 0 )
            EXIT FOREACH
         END IF
         
      END FOREACH
   END IF
 
   #判斷是否填充
   IF adbt510_fill_chk(4) THEN
      LET g_sql = "SELECT  UNIQUE xmefsite,xmef001,xmef002,xmef003,xmef004,xmef005,xmef006,xmef007,xmef008, 
          xmef009,xmef901,xmef902,xmef903 ,t45.ooibl004 ,t46.oocql004 FROM xmef_t",   
                  " INNER JOIN xmee_t ON xmeedocno = xmefdocno ",
                  " AND xmee900 = xmef900 ",
 
                  "",
                  
                                 " LEFT JOIN ooibl_t t45 ON t45.ooiblent='"||g_enterprise||"' AND t45.ooibl002=xmef002 AND t45.ooibl003='"||g_dlang||"' ",
               " LEFT JOIN oocql_t t46 ON t46.oocqlent='"||g_enterprise||"' AND t46.oocql001='267' AND t46.oocql002=xmef902 AND t46.oocql003='"||g_dlang||"' ",
 
                  " WHERE xmefent=? AND xmefdocno=? AND xmef900=?"   
      LET g_sql = cl_sql_add_mask(g_sql)              #遮蔽特定資料
      #add-point:b_fill段sql_before
      {<point name="b_fill.body4.fill_sql"/>}
      #end add-point
      IF NOT cl_null(g_wc2_table4) THEN
         LET g_sql = g_sql CLIPPED," AND ",g_wc2_table4 CLIPPED
      END IF
      
      #子單身的WC
      
      
      LET g_sql = g_sql, " ORDER BY xmef_t.xmef001"
      
      #add-point:單身填充控制
      {<point name="b_fill.sql4"/>}
      #end add-point
      
      LET g_sql = cl_sql_add_mask(g_sql)              #遮蔽特定資料
      PREPARE adbt510_pb4 FROM g_sql
      DECLARE b_fill_cs4 CURSOR FOR adbt510_pb4
      
      LET l_ac = 1
      
      OPEN b_fill_cs4 USING g_enterprise,g_xmee_m.xmeedocno,g_xmee_m.xmee900
                                               
      FOREACH b_fill_cs4 INTO g_xmeg5_d[l_ac].xmefsite,g_xmeg5_d[l_ac].xmef001,g_xmeg5_d[l_ac].xmef002, 
          g_xmeg5_d[l_ac].xmef003,g_xmeg5_d[l_ac].xmef004,g_xmeg5_d[l_ac].xmef005,g_xmeg5_d[l_ac].xmef006, 
          g_xmeg5_d[l_ac].xmef007,g_xmeg5_d[l_ac].xmef008,g_xmeg5_d[l_ac].xmef009,g_xmeg5_d[l_ac].xmef901, 
          g_xmeg5_d[l_ac].xmef902,g_xmeg5_d[l_ac].xmef903,g_xmeg5_d[l_ac].xmef002_desc,g_xmeg5_d[l_ac].xmef902_desc 

         IF SQLCA.sqlcode THEN
            CALL cl_err("FOREACH:",SQLCA.sqlcode,1)
            EXIT FOREACH
         END IF
        
         #add-point:b_fill段資料填充
         {<point name="b_fill4.fill"/>}
         #end add-point
      
         LET l_ac = l_ac + 1
         IF l_ac > g_max_rec THEN
            CALL cl_err( '', 9035, 0 )
            EXIT FOREACH
         END IF
         
      END FOREACH
   END IF
 
 
   
   #add-point:browser_fill段其他table處理
   {<point name="browser_fill.other_fill"/>}
   #end add-point
   
   CALL g_xmeg_d.deleteElement(g_xmeg_d.getLength())
   CALL g_xmeg3_d.deleteElement(g_xmeg3_d.getLength())
   CALL g_xmeg4_d.deleteElement(g_xmeg4_d.getLength())
   CALL g_xmeg5_d.deleteElement(g_xmeg5_d.getLength())
 
   
 
   LET l_ac = g_cnt
   LET g_cnt = 0  
   
   FREE adbt510_pb
   FREE adbt510_pb2
 
   FREE adbt510_pb3
 
   FREE adbt510_pb4
 
 
   
END FUNCTION
]]>
</section>
  <section id="adbt510.b_fill2" ver="5" status="" src="s">
<![CDATA[#+ 單身陣列填充2
PRIVATE FUNCTION adbt510_b_fill2(pi_idx)
   DEFINE pi_idx          LIKE type_t.num5
   DEFINE li_ac           LIKE type_t.num5
   DEFINE ls_chk          LIKE type_t.chr1
   #add-point:b_fill2段define
   {<point name="b_fill2.define"/>}
   #end add-point
   
   LET li_ac = l_ac 
   
   IF g_detail_idx <= 0 THEN
      RETURN
   END IF
   
 
      
   #add-point:單身填充後
   {<point name="b_fill2.after_fill" />}
   #end add-point
    
   LET l_ac = li_ac
   
   CALL adbt510_detail_show()
   
END FUNCTION
]]>
</section>
  <section id="adbt510.before_delete" ver="1" status="" src="s">
<![CDATA[#+ 單身db資料刪除
PRIVATE FUNCTION adbt510_before_delete()
   #add-point:before_delete段define
   {<point name="before_delete.define"/>}
   #end add-point 
   
   #add-point:單筆刪除前
   {<point name="delete.body.b_single_delete" mark="Y"/>}
   #end add-point
   
   DELETE FROM xmeg_t
    WHERE xmegent = g_enterprise AND  = g_xmee_m.xmeedocno AND
 
          xmegdocno = g_xmeg_d_t.xmegdocno
      AND xmegseq = g_xmeg_d_t.xmegseq
      AND xmeg900 = g_xmeg_d_t.xmeg900
 
      
   #add-point:單筆刪除中
   {<point name="delete.body.m_single_delete"/>}
   #end add-point
   
   IF SQLCA.sqlcode THEN
      CALL cl_err("xmeg_t",SQLCA.sqlcode,1)
      RETURN FALSE 
   END IF
   
   #add-point:單筆刪除後
   {<point name="delete.body.a_single_delete"/>}
   #end add-point
 
   LET g_rec_b = g_rec_b-1
   DISPLAY g_rec_b TO FORMONLY.cnt
 
   RETURN TRUE
    
END FUNCTION
]]>
</section>
  <section id="adbt510.browser_fill" ver="38" status="" src="s">
<![CDATA[#+ 瀏覽頁簽資料填充
PRIVATE FUNCTION adbt510_browser_fill(ps_page_action)
   DEFINE ps_page_action    STRING
   DEFINE l_wc              STRING
   DEFINE l_wc2             STRING
   DEFINE l_sql             STRING
   DEFINE l_sub_sql         STRING
   DEFINE l_sql_rank        STRING
   DEFINE l_searchcol       STRING
   #add-point:browser_fill段define
   {<point name="browser_fill.define"/>}
   #end add-point    
 
   #清除畫面
   CLEAR FORM                
   INITIALIZE g_xmee_m.* TO NULL
   CALL g_xmeg_d.clear()        
   CALL g_xmeg3_d.clear() 
   CALL g_xmeg4_d.clear() 
   CALL g_xmeg5_d.clear() 
 
   CALL g_browser.clear()
   
   #搜尋用
   IF cl_null(g_searchcol) OR g_searchcol = '0' THEN
      LET l_searchcol = "xmeedocno,xmee900"
   ELSE
      LET l_searchcol = g_searchcol
   END IF
   
   IF cl_null(g_wc) THEN
      LET g_wc = " 1=1"
   END IF
   IF cl_null(g_wc2) THEN
      LET g_wc2 = " 1=1"
   END IF
   LET l_wc  = g_wc.trim() 
   LET l_wc2 = g_wc2.trim()
 
   #add-point:browser_fill,foreach前
   {<point name="browser_fill.before_foreach"/>}
   #end add-point
    
   IF g_wc2 <> " 1=1" THEN
      #單身有輸入搜尋條件                      
      LET l_sub_sql = " SELECT UNIQUE xmeedocno,xmee900 ",
                      " FROM xmee_t ",
                      " ",
                      " LEFT JOIN xmeg_t ON xmegent = xmeeent AND xmeedocno = xmegdocno AND xmee900 = xmeg900 ",
                      " LEFT JOIN xmeh_t ON xmehent = xmeeent AND xmeedocno = xmehdocno AND xmee900 = xmeh900", 
 
                      " LEFT JOIN xmjb_t ON xmjbent = xmeeent AND xmeedocno = xmjbdocno AND xmee900 = xmjb900", 
 
                      " LEFT JOIN xmef_t ON xmefent = xmeeent AND xmeedocno = xmefdocno AND xmee900 = xmef900", 
 
 
 
                      " ", 
                      " ", 
                      " WHERE xmeeent = '" ||g_enterprise|| "' AND xmegent = '" ||g_enterprise|| "' AND ",l_wc, " AND ", l_wc2, cl_sql_add_filter("xmee_t")
   ELSE
      #單身未輸入搜尋條件
      LET l_sub_sql = " SELECT UNIQUE xmeedocno,xmee900 ",
                      " FROM xmee_t ", 
                      "  ",
                      "  ",
                      " WHERE xmeeent = '" ||g_enterprise|| "' AND ",l_wc CLIPPED, cl_sql_add_filter("xmee_t")
   END IF
   
   LET g_sql = " SELECT COUNT(*) FROM (",l_sub_sql,")"
   
   #add-point:browser_fill,count前
   {<point name="browser_fill.before_count"/>}
   #end add-point
   
   PREPARE header_cnt_pre FROM g_sql
   EXECUTE header_cnt_pre INTO g_browser_cnt   #總筆數
   FREE header_cnt_pre
 
   DISPLAY g_browser_cnt TO FORMONLY.b_count   #總筆數的顯示
   DISPLAY g_browser_cnt TO FORMONLY.h_count   #總筆數的顯示
 
   #依照xmeedocno,xmee900,xmeedocdt,xmee001,xmee002,'',xmee003,'',xmee004,'' Browser欄位定義(取代原本bs_sql功能)
   LET g_sql = " SELECT DISTINCT xmeestus,xmeedocno,xmee900,xmeedocdt,xmee001,xmee002,'',xmee003,'', 
       xmee004,'',t1.oofa011 ,t2.ooefl003 ,t3.pmaal004 ",
               " FROM xmee_t ",
               "  ",
               "  LEFT JOIN xmeg_t ON xmegent = xmeeent AND xmeedocno = xmegdocno AND xmee900 = xmeg900 ",
               "  LEFT JOIN xmeh_t ON xmehent = xmeeent AND xmeedocno = xmehdocno AND xmee900 = xmeh900",
 
               "  LEFT JOIN xmjb_t ON xmjbent = xmeeent AND xmeedocno = xmjbdocno AND xmee900 = xmjb900",
 
               "  LEFT JOIN xmef_t ON xmefent = xmeeent AND xmeedocno = xmefdocno AND xmee900 = xmef900",
 
 
 
               "  ",
               "  ",
                              " LEFT JOIN oofa_t t1 ON t1.oofaent='"||g_enterprise||"' AND t1.oofa002='2' AND t1.oofa003=xmee002  ",
               " LEFT JOIN ooefl_t t2 ON t2.ooeflent='"||g_enterprise||"' AND t2.ooefl001=xmee003 AND t2.ooefl002='"||g_lang||"' ",
               " LEFT JOIN pmaal_t t3 ON t3.pmaalent='"||g_enterprise||"' AND t3.pmaal001=xmee004 AND t3.pmaal002='"||g_lang||"' ",
 
               " WHERE xmeeent = '" ||g_enterprise|| "' AND ",l_wc," AND ",l_wc2, cl_sql_add_filter("xmee_t"),
               " ORDER BY ",l_searchcol," ",g_order
 
   #add-point:browser_fill,before_prepare
   {<point name="browser_fill.before_prepare"/>}
   #end add-point
        
   LET g_sql = cl_sql_add_mask(g_sql)              #遮蔽特定資料
   PREPARE browse_pre FROM g_sql
   DECLARE browse_cur CURSOR FOR browse_pre
   
   #add-point:browser_fill,open
   {<point name="browser_fill.open"/>}
   #end add-point
 
   CALL g_browser.clear()
   LET g_cnt = 1
   FOREACH browse_cur INTO g_browser[g_cnt].b_statepic,g_browser[g_cnt].b_xmeedocno,g_browser[g_cnt].b_xmee900, 
       g_browser[g_cnt].b_xmeedocdt,g_browser[g_cnt].b_xmee001,g_browser[g_cnt].b_xmee002,g_browser[g_cnt].b_xmee002_desc, 
       g_browser[g_cnt].b_xmee003,g_browser[g_cnt].b_xmee003_desc,g_browser[g_cnt].b_xmee004,g_browser[g_cnt].b_xmee004_desc, 
       g_browser[g_cnt].b_xmee002_desc,g_browser[g_cnt].b_xmee003_desc,g_browser[g_cnt].b_xmee004_desc 

      IF SQLCA.sqlcode THEN
         CALL cl_err('foreach:',SQLCA.sqlcode,1)
         EXIT FOREACH
      END IF
  
      #add-point:browser_fill段reference
      {<point name="browser_fill.reference"/>}
      #end add-point
  
            #此段落由子樣板a24產生
      CASE g_browser[g_cnt].b_statepic
         WHEN "N"
            LET g_browser[g_cnt].b_statepic = "stus/16/unconfirmed.png"
         WHEN "X"
            LET g_browser[g_cnt].b_statepic = "stus/16/invalid.png"
         WHEN "Y"
            LET g_browser[g_cnt].b_statepic = "stus/16/confirmed.png"
         WHEN "A"
            LET g_browser[g_cnt].b_statepic = "stus/16/approved.png"
         WHEN "D"
            LET g_browser[g_cnt].b_statepic = "stus/16/withdraw.png"
         WHEN "R"
            LET g_browser[g_cnt].b_statepic = "stus/16/rejection.png"
         WHEN "W"
            LET g_browser[g_cnt].b_statepic = "stus/16/signing.png"
         
      END CASE
 
 
      LET g_cnt = g_cnt + 1
      IF g_cnt > g_max_rec THEN
         CALL cl_err('',9035,0)
         EXIT FOREACH
      END IF
      
   END FOREACH
 
   CALL g_browser.deleteElement(g_cnt)
   LET g_header_cnt = g_browser.getLength()
 
   LET g_rec_b = g_cnt - 1
   LET g_detail_cnt = g_rec_b
   LET g_cnt = 0
   
   FREE browse_pre
   
   #add-point:browser_fill段結束前
   {<point name="browser_fill.after"/>}
   #end add-point
   
   #若無資料則關閉相關功能
   IF g_browser_cnt = 0 THEN
      CALL cl_set_act_visible("statechange,modify,delete,reproduce", FALSE)
   ELSE
      CALL cl_set_act_visible("statechange,modify,delete,reproduce", TRUE)
   END IF
   
END FUNCTION
]]>
</section>
  <section id="adbt510.browser_search" ver="5" status="" src="s">
<![CDATA[#+ 瀏覽頁簽資料搜尋
PRIVATE FUNCTION adbt510_browser_search(p_type)
   DEFINE p_type LIKE type_t.chr10
   #add-point:browser_search段define
   {<point name="browser_search.define"/>}
   #end add-point    
   
   #若無輸入關鍵字則查找出所有資料
   IF NOT cl_null(g_searchstr) AND g_searchcol='0' THEN
      CALL cl_err("searchcol","std-00005",0)
      RETURN FALSE 
   END IF 
   
   IF NOT cl_null(g_searchstr) THEN
      LET g_wc = " lower(", g_searchcol, ") LIKE '%", g_searchstr, "%'"
      LET g_wc = g_wc.toLowerCase()
   ELSE
      LET g_wc = " 1=1 "
   END IF         
   
   #若為排序搜尋則添加以下條件
   IF cl_null(g_searchcol) OR g_searchcol = "0" THEN
      LET g_wc = g_wc, " ORDER BY xmeedocno"
   ELSE
      LET g_wc = g_wc, " ORDER BY ", g_searchcol
   END IF 
 
   CALL adbt510_browser_fill("F")
   RETURN TRUE
 
END FUNCTION
]]>
</section>
  <section id="adbt510.construct" ver="147" status="" src="s">
<![CDATA[#+ QBE資料查詢
PRIVATE FUNCTION adbt510_construct()
   DEFINE ls_return   STRING
   DEFINE ls_result   STRING 
   DEFINE ls_wc       STRING 
   #add-point:cs段define
   {<point name="cs.define"/>}
   #end add-point    
 
   #清除畫面
   CLEAR FORM                
   INITIALIZE g_xmee_m.* TO NULL
   CALL g_xmeg_d.clear()        
   CALL g_xmeg3_d.clear() 
   CALL g_xmeg4_d.clear() 
   CALL g_xmeg5_d.clear() 
 
   
   LET g_action_choice = ""
    
   INITIALIZE g_wc TO NULL
   INITIALIZE g_wc2 TO NULL
   
   INITIALIZE g_wc2_table1 TO NULL
   INITIALIZE g_wc2_table2 TO NULL
 
   INITIALIZE g_wc2_table3 TO NULL
 
   INITIALIZE g_wc2_table4 TO NULL
 
 
    
   LET g_qryparam.state = 'c'
   
   #add-point:cs段開始前
   {<point name="cs.before_construct"/>}
   #end add-point 
   
   #使用DIALOG包住 單頭CONSTRUCT及單身CONSTRUCT
   DIALOG ATTRIBUTES(UNBUFFERED,FIELD ORDER FORM)
      
      #單頭
      CONSTRUCT BY NAME g_wc ON xmeesite,xmee902,xmeedocno,xmee900,xmee901,xmee001,xmee202,xmee023,xmee004, 
          xmee200,xmee201,xmeestus,xmee005,xmee007,xmee008,xmeedocdt,xmee024,xmeeacti,xmee021,xmee022, 
          xmee203,xmee027,xmee002,xmee003,xmeeunit,xmee204,xmee205,xmee032,xmee071,xmee903,xmee904,xmee025, 
          xmee025_desc,oofb017,xmee026,xmee026_desc,oofb017_1,xmee206,xmee207,xmee020,xmee036,xmee009, 
          xmee010,xmee015,xmee016,xmee011,xmee011_desc,xmee012,xmee013,xmee035,xmee035_desc,xmee039, 
          xmeeownid,xmeeowndp,xmeecrtid,xmeecrtdp,xmeecrtdt,xmeemodid,xmeemoddt,xmeecnfid,xmeecnfdt, 
          xmee034,xmee006,xmee017,xmee018,xmee019,xmee028
 
         BEFORE CONSTRUCT
            #add-point:cs段before_construct
            {<point name="cs.head.before_construct"/>}
            #end add-point 
            
         #公用欄位開窗相關處理
         #此段落由子樣板a11產生
         ##----<<xmeecrtdt>>----
         AFTER FIELD xmeecrtdt
            CALL FGL_DIALOG_GETBUFFER() RETURNING ls_result
            IF NOT cl_null(ls_result) THEN
               IF NOT cl_chk_date_symbol(ls_result) THEN
                  LET ls_result = cl_add_date_extra_cond(ls_result)
               END IF
            END IF
            CALL FGL_DIALOG_SETBUFFER(ls_result)
         
         #----<<xmeemoddt>>----
         AFTER FIELD xmeemoddt
            CALL FGL_DIALOG_GETBUFFER() RETURNING ls_result
            IF NOT cl_null(ls_result) THEN
               IF NOT cl_chk_date_symbol(ls_result) THEN
                  LET ls_result = cl_add_date_extra_cond(ls_result)
               END IF
            END IF
            CALL FGL_DIALOG_SETBUFFER(ls_result)
         
         #----<<xmeecnfdt>>----
         AFTER FIELD xmeecnfdt
            CALL FGL_DIALOG_GETBUFFER() RETURNING ls_result
            IF NOT cl_null(ls_result) THEN
               IF NOT cl_chk_date_symbol(ls_result) THEN
                  LET ls_result = cl_add_date_extra_cond(ls_result)
               END IF
            END IF
            CALL FGL_DIALOG_SETBUFFER(ls_result)
         
         #----<<xmeepstdt>>----
 
 
            
         #一般欄位開窗相關處理    
                  #Ctrlp:construct.c.xmeesite
         ON ACTION controlp INFIELD xmeesite
            #add-point:ON ACTION controlp INFIELD xmeesite
            {<point name="construct.c.xmeesite" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeesite
            #add-point:BEFORE FIELD xmeesite
            {<point name="construct.b.xmeesite" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeesite
            
            #add-point:AFTER FIELD xmeesite
            {<point name="construct.a.xmeesite" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmee902
            #add-point:BEFORE FIELD xmee902
            {<point name="construct.b.xmee902" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmee902
            
            #add-point:AFTER FIELD xmee902
            {<point name="construct.a.xmee902" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmee902
         ON ACTION controlp INFIELD xmee902
            #add-point:ON ACTION controlp INFIELD xmee902
            {<point name="construct.c.xmee902" />}
            #END add-point
 
         #Ctrlp:construct.c.xmeedocno
         ON ACTION controlp INFIELD xmeedocno
            #add-point:ON ACTION controlp INFIELD xmeedocno
            {<point name="construct.c.xmeedocno" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeedocno
            #add-point:BEFORE FIELD xmeedocno
            {<point name="construct.b.xmeedocno" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeedocno
            
            #add-point:AFTER FIELD xmeedocno
            {<point name="construct.a.xmeedocno" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmee900
            #add-point:BEFORE FIELD xmee900
            {<point name="construct.b.xmee900" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmee900
            
            #add-point:AFTER FIELD xmee900
            {<point name="construct.a.xmee900" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmee900
         ON ACTION controlp INFIELD xmee900
            #add-point:ON ACTION controlp INFIELD xmee900
            {<point name="construct.c.xmee900" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmee901
            #add-point:BEFORE FIELD xmee901
            {<point name="construct.b.xmee901" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmee901
            
            #add-point:AFTER FIELD xmee901
            {<point name="construct.a.xmee901" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmee901
         ON ACTION controlp INFIELD xmee901
            #add-point:ON ACTION controlp INFIELD xmee901
            {<point name="construct.c.xmee901" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmee001
            #add-point:BEFORE FIELD xmee001
            {<point name="construct.b.xmee001" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmee001
            
            #add-point:AFTER FIELD xmee001
            {<point name="construct.a.xmee001" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmee001
         ON ACTION controlp INFIELD xmee001
            #add-point:ON ACTION controlp INFIELD xmee001
            {<point name="construct.c.xmee001" />}
            #END add-point
 
         #Ctrlp:construct.c.xmee202
         ON ACTION controlp INFIELD xmee202
            #add-point:ON ACTION controlp INFIELD xmee202
            {<point name="construct.c.xmee202" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmee202
            #add-point:BEFORE FIELD xmee202
            {<point name="construct.b.xmee202" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmee202
            
            #add-point:AFTER FIELD xmee202
            {<point name="construct.a.xmee202" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmee023
         ON ACTION controlp INFIELD xmee023
            #add-point:ON ACTION controlp INFIELD xmee023
            {<point name="construct.c.xmee023" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmee023
            #add-point:BEFORE FIELD xmee023
            {<point name="construct.b.xmee023" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmee023
            
            #add-point:AFTER FIELD xmee023
            {<point name="construct.a.xmee023" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmee004
         ON ACTION controlp INFIELD xmee004
            #add-point:ON ACTION controlp INFIELD xmee004
            {<point name="construct.c.xmee004" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmee004
            #add-point:BEFORE FIELD xmee004
            {<point name="construct.b.xmee004" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmee004
            
            #add-point:AFTER FIELD xmee004
            {<point name="construct.a.xmee004" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmee200
         ON ACTION controlp INFIELD xmee200
            #add-point:ON ACTION controlp INFIELD xmee200
            {<point name="construct.c.xmee200" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmee200
            #add-point:BEFORE FIELD xmee200
            {<point name="construct.b.xmee200" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmee200
            
            #add-point:AFTER FIELD xmee200
            {<point name="construct.a.xmee200" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmee201
         ON ACTION controlp INFIELD xmee201
            #add-point:ON ACTION controlp INFIELD xmee201
            {<point name="construct.c.xmee201" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmee201
            #add-point:BEFORE FIELD xmee201
            {<point name="construct.b.xmee201" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmee201
            
            #add-point:AFTER FIELD xmee201
            {<point name="construct.a.xmee201" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeestus
            #add-point:BEFORE FIELD xmeestus
            {<point name="construct.b.xmeestus" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeestus
            
            #add-point:AFTER FIELD xmeestus
            {<point name="construct.a.xmeestus" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmeestus
         ON ACTION controlp INFIELD xmeestus
            #add-point:ON ACTION controlp INFIELD xmeestus
            {<point name="construct.c.xmeestus" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmee005
            #add-point:BEFORE FIELD xmee005
            {<point name="construct.b.xmee005" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmee005
            
            #add-point:AFTER FIELD xmee005
            {<point name="construct.a.xmee005" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmee005
         ON ACTION controlp INFIELD xmee005
            #add-point:ON ACTION controlp INFIELD xmee005
            {<point name="construct.c.xmee005" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmee007
            #add-point:BEFORE FIELD xmee007
            {<point name="construct.b.xmee007" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmee007
            
            #add-point:AFTER FIELD xmee007
            {<point name="construct.a.xmee007" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmee007
         ON ACTION controlp INFIELD xmee007
            #add-point:ON ACTION controlp INFIELD xmee007
            {<point name="construct.c.xmee007" />}
            #END add-point
 
         #Ctrlp:construct.c.xmee008
         ON ACTION controlp INFIELD xmee008
            #add-point:ON ACTION controlp INFIELD xmee008
            {<point name="construct.c.xmee008" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmee008
            #add-point:BEFORE FIELD xmee008
            {<point name="construct.b.xmee008" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmee008
            
            #add-point:AFTER FIELD xmee008
            {<point name="construct.a.xmee008" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeedocdt
            #add-point:BEFORE FIELD xmeedocdt
            {<point name="construct.b.xmeedocdt" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeedocdt
            
            #add-point:AFTER FIELD xmeedocdt
            {<point name="construct.a.xmeedocdt" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmeedocdt
         ON ACTION controlp INFIELD xmeedocdt
            #add-point:ON ACTION controlp INFIELD xmeedocdt
            {<point name="construct.c.xmeedocdt" />}
            #END add-point
 
         #Ctrlp:construct.c.xmee024
         ON ACTION controlp INFIELD xmee024
            #add-point:ON ACTION controlp INFIELD xmee024
            {<point name="construct.c.xmee024" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmee024
            #add-point:BEFORE FIELD xmee024
            {<point name="construct.b.xmee024" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmee024
            
            #add-point:AFTER FIELD xmee024
            {<point name="construct.a.xmee024" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeeacti
            #add-point:BEFORE FIELD xmeeacti
            {<point name="construct.b.xmeeacti" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeeacti
            
            #add-point:AFTER FIELD xmeeacti
            {<point name="construct.a.xmeeacti" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmeeacti
         ON ACTION controlp INFIELD xmeeacti
            #add-point:ON ACTION controlp INFIELD xmeeacti
            {<point name="construct.c.xmeeacti" />}
            #END add-point
 
         #Ctrlp:construct.c.xmee021
         ON ACTION controlp INFIELD xmee021
            #add-point:ON ACTION controlp INFIELD xmee021
            {<point name="construct.c.xmee021" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmee021
            #add-point:BEFORE FIELD xmee021
            {<point name="construct.b.xmee021" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmee021
            
            #add-point:AFTER FIELD xmee021
            {<point name="construct.a.xmee021" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmee022
         ON ACTION controlp INFIELD xmee022
            #add-point:ON ACTION controlp INFIELD xmee022
            {<point name="construct.c.xmee022" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmee022
            #add-point:BEFORE FIELD xmee022
            {<point name="construct.b.xmee022" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmee022
            
            #add-point:AFTER FIELD xmee022
            {<point name="construct.a.xmee022" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmee203
         ON ACTION controlp INFIELD xmee203
            #add-point:ON ACTION controlp INFIELD xmee203
            {<point name="construct.c.xmee203" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmee203
            #add-point:BEFORE FIELD xmee203
            {<point name="construct.b.xmee203" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmee203
            
            #add-point:AFTER FIELD xmee203
            {<point name="construct.a.xmee203" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmee027
            #add-point:BEFORE FIELD xmee027
            {<point name="construct.b.xmee027" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmee027
            
            #add-point:AFTER FIELD xmee027
            {<point name="construct.a.xmee027" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmee027
         ON ACTION controlp INFIELD xmee027
            #add-point:ON ACTION controlp INFIELD xmee027
            {<point name="construct.c.xmee027" />}
            #END add-point
 
         #Ctrlp:construct.c.xmee002
         ON ACTION controlp INFIELD xmee002
            #add-point:ON ACTION controlp INFIELD xmee002
            {<point name="construct.c.xmee002" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmee002
            #add-point:BEFORE FIELD xmee002
            {<point name="construct.b.xmee002" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmee002
            
            #add-point:AFTER FIELD xmee002
            {<point name="construct.a.xmee002" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmee003
         ON ACTION controlp INFIELD xmee003
            #add-point:ON ACTION controlp INFIELD xmee003
            {<point name="construct.c.xmee003" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmee003
            #add-point:BEFORE FIELD xmee003
            {<point name="construct.b.xmee003" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmee003
            
            #add-point:AFTER FIELD xmee003
            {<point name="construct.a.xmee003" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmeeunit
         ON ACTION controlp INFIELD xmeeunit
            #add-point:ON ACTION controlp INFIELD xmeeunit
            {<point name="construct.c.xmeeunit" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeeunit
            #add-point:BEFORE FIELD xmeeunit
            {<point name="construct.b.xmeeunit" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeeunit
            
            #add-point:AFTER FIELD xmeeunit
            {<point name="construct.a.xmeeunit" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmee204
         ON ACTION controlp INFIELD xmee204
            #add-point:ON ACTION controlp INFIELD xmee204
            {<point name="construct.c.xmee204" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmee204
            #add-point:BEFORE FIELD xmee204
            {<point name="construct.b.xmee204" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmee204
            
            #add-point:AFTER FIELD xmee204
            {<point name="construct.a.xmee204" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmee205
            #add-point:BEFORE FIELD xmee205
            {<point name="construct.b.xmee205" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmee205
            
            #add-point:AFTER FIELD xmee205
            {<point name="construct.a.xmee205" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmee205
         ON ACTION controlp INFIELD xmee205
            #add-point:ON ACTION controlp INFIELD xmee205
            {<point name="construct.c.xmee205" />}
            #END add-point
 
         #Ctrlp:construct.c.xmee032
         ON ACTION controlp INFIELD xmee032
            #add-point:ON ACTION controlp INFIELD xmee032
            {<point name="construct.c.xmee032" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmee032
            #add-point:BEFORE FIELD xmee032
            {<point name="construct.b.xmee032" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmee032
            
            #add-point:AFTER FIELD xmee032
            {<point name="construct.a.xmee032" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmee071
            #add-point:BEFORE FIELD xmee071
            {<point name="construct.b.xmee071" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmee071
            
            #add-point:AFTER FIELD xmee071
            {<point name="construct.a.xmee071" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmee071
         ON ACTION controlp INFIELD xmee071
            #add-point:ON ACTION controlp INFIELD xmee071
            {<point name="construct.c.xmee071" />}
            #END add-point
 
         #Ctrlp:construct.c.xmee903
         ON ACTION controlp INFIELD xmee903
            #add-point:ON ACTION controlp INFIELD xmee903
            {<point name="construct.c.xmee903" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmee903
            #add-point:BEFORE FIELD xmee903
            {<point name="construct.b.xmee903" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmee903
            
            #add-point:AFTER FIELD xmee903
            {<point name="construct.a.xmee903" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmee904
            #add-point:BEFORE FIELD xmee904
            {<point name="construct.b.xmee904" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmee904
            
            #add-point:AFTER FIELD xmee904
            {<point name="construct.a.xmee904" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmee904
         ON ACTION controlp INFIELD xmee904
            #add-point:ON ACTION controlp INFIELD xmee904
            {<point name="construct.c.xmee904" />}
            #END add-point
 
         #Ctrlp:construct.c.xmee025
         ON ACTION controlp INFIELD xmee025
            #add-point:ON ACTION controlp INFIELD xmee025
            {<point name="construct.c.xmee025" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmee025
            #add-point:BEFORE FIELD xmee025
            {<point name="construct.b.xmee025" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmee025
            
            #add-point:AFTER FIELD xmee025
            {<point name="construct.a.xmee025" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmee025_desc
            #add-point:BEFORE FIELD xmee025_desc
            {<point name="construct.b.xmee025_desc" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmee025_desc
            
            #add-point:AFTER FIELD xmee025_desc
            {<point name="construct.a.xmee025_desc" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmee025_desc
         ON ACTION controlp INFIELD xmee025_desc
            #add-point:ON ACTION controlp INFIELD xmee025_desc
            {<point name="construct.c.xmee025_desc" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD oofb017
            #add-point:BEFORE FIELD oofb017
            {<point name="construct.b.oofb017" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD oofb017
            
            #add-point:AFTER FIELD oofb017
            {<point name="construct.a.oofb017" />}
            #END add-point
            
 
         #Ctrlp:construct.c.oofb017
         ON ACTION controlp INFIELD oofb017
            #add-point:ON ACTION controlp INFIELD oofb017
            {<point name="construct.c.oofb017" />}
            #END add-point
 
         #Ctrlp:construct.c.xmee026
         ON ACTION controlp INFIELD xmee026
            #add-point:ON ACTION controlp INFIELD xmee026
            {<point name="construct.c.xmee026" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmee026
            #add-point:BEFORE FIELD xmee026
            {<point name="construct.b.xmee026" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmee026
            
            #add-point:AFTER FIELD xmee026
            {<point name="construct.a.xmee026" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmee026_desc
            #add-point:BEFORE FIELD xmee026_desc
            {<point name="construct.b.xmee026_desc" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmee026_desc
            
            #add-point:AFTER FIELD xmee026_desc
            {<point name="construct.a.xmee026_desc" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmee026_desc
         ON ACTION controlp INFIELD xmee026_desc
            #add-point:ON ACTION controlp INFIELD xmee026_desc
            {<point name="construct.c.xmee026_desc" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD oofb017_1
            #add-point:BEFORE FIELD oofb017_1
            {<point name="construct.b.oofb017_1" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD oofb017_1
            
            #add-point:AFTER FIELD oofb017_1
            {<point name="construct.a.oofb017_1" />}
            #END add-point
            
 
         #Ctrlp:construct.c.oofb017_1
         ON ACTION controlp INFIELD oofb017_1
            #add-point:ON ACTION controlp INFIELD oofb017_1
            {<point name="construct.c.oofb017_1" />}
            #END add-point
 
         #Ctrlp:construct.c.xmee206
         ON ACTION controlp INFIELD xmee206
            #add-point:ON ACTION controlp INFIELD xmee206
            {<point name="construct.c.xmee206" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmee206
            #add-point:BEFORE FIELD xmee206
            {<point name="construct.b.xmee206" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmee206
            
            #add-point:AFTER FIELD xmee206
            {<point name="construct.a.xmee206" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmee207
         ON ACTION controlp INFIELD xmee207
            #add-point:ON ACTION controlp INFIELD xmee207
            {<point name="construct.c.xmee207" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmee207
            #add-point:BEFORE FIELD xmee207
            {<point name="construct.b.xmee207" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmee207
            
            #add-point:AFTER FIELD xmee207
            {<point name="construct.a.xmee207" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmee020
         ON ACTION controlp INFIELD xmee020
            #add-point:ON ACTION controlp INFIELD xmee020
            {<point name="construct.c.xmee020" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmee020
            #add-point:BEFORE FIELD xmee020
            {<point name="construct.b.xmee020" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmee020
            
            #add-point:AFTER FIELD xmee020
            {<point name="construct.a.xmee020" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmee036
         ON ACTION controlp INFIELD xmee036
            #add-point:ON ACTION controlp INFIELD xmee036
            {<point name="construct.c.xmee036" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmee036
            #add-point:BEFORE FIELD xmee036
            {<point name="construct.b.xmee036" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmee036
            
            #add-point:AFTER FIELD xmee036
            {<point name="construct.a.xmee036" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmee009
         ON ACTION controlp INFIELD xmee009
            #add-point:ON ACTION controlp INFIELD xmee009
            {<point name="construct.c.xmee009" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmee009
            #add-point:BEFORE FIELD xmee009
            {<point name="construct.b.xmee009" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmee009
            
            #add-point:AFTER FIELD xmee009
            {<point name="construct.a.xmee009" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmee010
         ON ACTION controlp INFIELD xmee010
            #add-point:ON ACTION controlp INFIELD xmee010
            {<point name="construct.c.xmee010" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmee010
            #add-point:BEFORE FIELD xmee010
            {<point name="construct.b.xmee010" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmee010
            
            #add-point:AFTER FIELD xmee010
            {<point name="construct.a.xmee010" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmee015
         ON ACTION controlp INFIELD xmee015
            #add-point:ON ACTION controlp INFIELD xmee015
            {<point name="construct.c.xmee015" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmee015
            #add-point:BEFORE FIELD xmee015
            {<point name="construct.b.xmee015" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmee015
            
            #add-point:AFTER FIELD xmee015
            {<point name="construct.a.xmee015" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmee016
            #add-point:BEFORE FIELD xmee016
            {<point name="construct.b.xmee016" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmee016
            
            #add-point:AFTER FIELD xmee016
            {<point name="construct.a.xmee016" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmee016
         ON ACTION controlp INFIELD xmee016
            #add-point:ON ACTION controlp INFIELD xmee016
            {<point name="construct.c.xmee016" />}
            #END add-point
 
         #Ctrlp:construct.c.xmee011
         ON ACTION controlp INFIELD xmee011
            #add-point:ON ACTION controlp INFIELD xmee011
            {<point name="construct.c.xmee011" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmee011
            #add-point:BEFORE FIELD xmee011
            {<point name="construct.b.xmee011" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmee011
            
            #add-point:AFTER FIELD xmee011
            {<point name="construct.a.xmee011" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmee011_desc
            #add-point:BEFORE FIELD xmee011_desc
            {<point name="construct.b.xmee011_desc" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmee011_desc
            
            #add-point:AFTER FIELD xmee011_desc
            {<point name="construct.a.xmee011_desc" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmee011_desc
         ON ACTION controlp INFIELD xmee011_desc
            #add-point:ON ACTION controlp INFIELD xmee011_desc
            {<point name="construct.c.xmee011_desc" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmee012
            #add-point:BEFORE FIELD xmee012
            {<point name="construct.b.xmee012" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmee012
            
            #add-point:AFTER FIELD xmee012
            {<point name="construct.a.xmee012" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmee012
         ON ACTION controlp INFIELD xmee012
            #add-point:ON ACTION controlp INFIELD xmee012
            {<point name="construct.c.xmee012" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmee013
            #add-point:BEFORE FIELD xmee013
            {<point name="construct.b.xmee013" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmee013
            
            #add-point:AFTER FIELD xmee013
            {<point name="construct.a.xmee013" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmee013
         ON ACTION controlp INFIELD xmee013
            #add-point:ON ACTION controlp INFIELD xmee013
            {<point name="construct.c.xmee013" />}
            #END add-point
 
         #Ctrlp:construct.c.xmee035
         ON ACTION controlp INFIELD xmee035
            #add-point:ON ACTION controlp INFIELD xmee035
            {<point name="construct.c.xmee035" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmee035
            #add-point:BEFORE FIELD xmee035
            {<point name="construct.b.xmee035" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmee035
            
            #add-point:AFTER FIELD xmee035
            {<point name="construct.a.xmee035" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmee035_desc
            #add-point:BEFORE FIELD xmee035_desc
            {<point name="construct.b.xmee035_desc" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmee035_desc
            
            #add-point:AFTER FIELD xmee035_desc
            {<point name="construct.a.xmee035_desc" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmee035_desc
         ON ACTION controlp INFIELD xmee035_desc
            #add-point:ON ACTION controlp INFIELD xmee035_desc
            {<point name="construct.c.xmee035_desc" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmee039
            #add-point:BEFORE FIELD xmee039
            {<point name="construct.b.xmee039" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmee039
            
            #add-point:AFTER FIELD xmee039
            {<point name="construct.a.xmee039" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmee039
         ON ACTION controlp INFIELD xmee039
            #add-point:ON ACTION controlp INFIELD xmee039
            {<point name="construct.c.xmee039" />}
            #END add-point
 
         #Ctrlp:construct.c.xmeeownid
         ON ACTION controlp INFIELD xmeeownid
            #add-point:ON ACTION controlp INFIELD xmeeownid
            {<point name="construct.c.xmeeownid" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeeownid
            #add-point:BEFORE FIELD xmeeownid
            {<point name="construct.b.xmeeownid" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeeownid
            
            #add-point:AFTER FIELD xmeeownid
            {<point name="construct.a.xmeeownid" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmeeowndp
         ON ACTION controlp INFIELD xmeeowndp
            #add-point:ON ACTION controlp INFIELD xmeeowndp
            {<point name="construct.c.xmeeowndp" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeeowndp
            #add-point:BEFORE FIELD xmeeowndp
            {<point name="construct.b.xmeeowndp" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeeowndp
            
            #add-point:AFTER FIELD xmeeowndp
            {<point name="construct.a.xmeeowndp" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmeecrtid
         ON ACTION controlp INFIELD xmeecrtid
            #add-point:ON ACTION controlp INFIELD xmeecrtid
            {<point name="construct.c.xmeecrtid" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeecrtid
            #add-point:BEFORE FIELD xmeecrtid
            {<point name="construct.b.xmeecrtid" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeecrtid
            
            #add-point:AFTER FIELD xmeecrtid
            {<point name="construct.a.xmeecrtid" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmeecrtdp
         ON ACTION controlp INFIELD xmeecrtdp
            #add-point:ON ACTION controlp INFIELD xmeecrtdp
            {<point name="construct.c.xmeecrtdp" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeecrtdp
            #add-point:BEFORE FIELD xmeecrtdp
            {<point name="construct.b.xmeecrtdp" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeecrtdp
            
            #add-point:AFTER FIELD xmeecrtdp
            {<point name="construct.a.xmeecrtdp" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeecrtdt
            #add-point:BEFORE FIELD xmeecrtdt
            {<point name="construct.b.xmeecrtdt" />}
            #END add-point
 
         #Ctrlp:construct.c.xmeemodid
         ON ACTION controlp INFIELD xmeemodid
            #add-point:ON ACTION controlp INFIELD xmeemodid
            {<point name="construct.c.xmeemodid" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeemodid
            #add-point:BEFORE FIELD xmeemodid
            {<point name="construct.b.xmeemodid" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeemodid
            
            #add-point:AFTER FIELD xmeemodid
            {<point name="construct.a.xmeemodid" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeemoddt
            #add-point:BEFORE FIELD xmeemoddt
            {<point name="construct.b.xmeemoddt" />}
            #END add-point
 
         #Ctrlp:construct.c.xmeecnfid
         ON ACTION controlp INFIELD xmeecnfid
            #add-point:ON ACTION controlp INFIELD xmeecnfid
            {<point name="construct.c.xmeecnfid" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeecnfid
            #add-point:BEFORE FIELD xmeecnfid
            {<point name="construct.b.xmeecnfid" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeecnfid
            
            #add-point:AFTER FIELD xmeecnfid
            {<point name="construct.a.xmeecnfid" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeecnfdt
            #add-point:BEFORE FIELD xmeecnfdt
            {<point name="construct.b.xmeecnfdt" />}
            #END add-point
 
         #Ctrlp:construct.c.xmee034
         ON ACTION controlp INFIELD xmee034
            #add-point:ON ACTION controlp INFIELD xmee034
            {<point name="construct.c.xmee034" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmee034
            #add-point:BEFORE FIELD xmee034
            {<point name="construct.b.xmee034" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmee034
            
            #add-point:AFTER FIELD xmee034
            {<point name="construct.a.xmee034" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmee006
            #add-point:BEFORE FIELD xmee006
            {<point name="construct.b.xmee006" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmee006
            
            #add-point:AFTER FIELD xmee006
            {<point name="construct.a.xmee006" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmee006
         ON ACTION controlp INFIELD xmee006
            #add-point:ON ACTION controlp INFIELD xmee006
            {<point name="construct.c.xmee006" />}
            #END add-point
 
         #Ctrlp:construct.c.xmee017
         ON ACTION controlp INFIELD xmee017
            #add-point:ON ACTION controlp INFIELD xmee017
            {<point name="construct.c.xmee017" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmee017
            #add-point:BEFORE FIELD xmee017
            {<point name="construct.b.xmee017" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmee017
            
            #add-point:AFTER FIELD xmee017
            {<point name="construct.a.xmee017" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmee018
         ON ACTION controlp INFIELD xmee018
            #add-point:ON ACTION controlp INFIELD xmee018
            {<point name="construct.c.xmee018" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmee018
            #add-point:BEFORE FIELD xmee018
            {<point name="construct.b.xmee018" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmee018
            
            #add-point:AFTER FIELD xmee018
            {<point name="construct.a.xmee018" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmee019
            #add-point:BEFORE FIELD xmee019
            {<point name="construct.b.xmee019" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmee019
            
            #add-point:AFTER FIELD xmee019
            {<point name="construct.a.xmee019" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmee019
         ON ACTION controlp INFIELD xmee019
            #add-point:ON ACTION controlp INFIELD xmee019
            {<point name="construct.c.xmee019" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmee028
            #add-point:BEFORE FIELD xmee028
            {<point name="construct.b.xmee028" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmee028
            
            #add-point:AFTER FIELD xmee028
            {<point name="construct.a.xmee028" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmee028
         ON ACTION controlp INFIELD xmee028
            #add-point:ON ACTION controlp INFIELD xmee028
            {<point name="construct.c.xmee028" />}
            #END add-point
 
 
         
      END CONSTRUCT
 
      #單身根據table分拆construct
      CONSTRUCT g_wc2_table1 ON xmegsite,xmegseq,xmeg027,xmeg001,xmeg002,xmeg004,xmeg005,xmeg006,xmeg007, 
          xmeg008,xmeg009,xmeg024,xmeg012,xmeg013,xmeg045,xmeg010,xmeg011,xmeg015,xmeg016,xmeg016_desc, 
          xmeg017,xmeg046,xmeg047,xmeg048,xmeg023,xmeg019,xmeg020,xmeg021,xmeg022,xmeg051,xmegunit,xmegorga, 
          xmeg052,xmeg049,xmeg053,xmeg050,xmeg901,xmeg902,xmeg903
           FROM s_detail1[1].xmegsite,s_detail1[1].xmegseq,s_detail1[1].xmeg027,s_detail1[1].xmeg001, 
               s_detail1[1].xmeg002,s_detail1[1].xmeg004,s_detail1[1].xmeg005,s_detail1[1].xmeg006,s_detail1[1].xmeg007, 
               s_detail1[1].xmeg008,s_detail1[1].xmeg009,s_detail1[1].xmeg024,s_detail1[1].xmeg012,s_detail1[1].xmeg013, 
               s_detail1[1].xmeg045,s_detail1[1].xmeg010,s_detail1[1].xmeg011,s_detail1[1].xmeg015,s_detail1[1].xmeg016, 
               s_detail1[1].xmeg016_desc,s_detail1[1].xmeg017,s_detail1[1].xmeg046,s_detail1[1].xmeg047, 
               s_detail1[1].xmeg048,s_detail1[1].xmeg023,s_detail1[1].xmeg019,s_detail1[1].xmeg020,s_detail1[1].xmeg021, 
               s_detail1[1].xmeg022,s_detail1[1].xmeg051,s_detail1[1].xmegunit,s_detail1[1].xmegorga, 
               s_detail1[1].xmeg052,s_detail1[1].xmeg049,s_detail1[1].xmeg053,s_detail1[1].xmeg050,s_detail1[1].xmeg901, 
               s_detail1[1].xmeg902,s_detail1[1].xmeg903
                      
         BEFORE CONSTRUCT
            #add-point:cs段before_construct
            {<point name="cs.body.before_construct"/>}
            #end add-point 
            
       #單身公用欄位開窗相關處理
       
         
       #單身一般欄位開窗相關處理
                #此段落由子樣板a01產生
         BEFORE FIELD xmegsite
            #add-point:BEFORE FIELD xmegsite
            {<point name="construct.b.page1.xmegsite" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmegsite
            
            #add-point:AFTER FIELD xmegsite
            {<point name="construct.a.page1.xmegsite" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmegsite
         ON ACTION controlp INFIELD xmegsite
            #add-point:ON ACTION controlp INFIELD xmegsite
            {<point name="construct.c.page1.xmegsite" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmegseq
            #add-point:BEFORE FIELD xmegseq
            {<point name="construct.b.page1.xmegseq" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmegseq
            
            #add-point:AFTER FIELD xmegseq
            {<point name="construct.a.page1.xmegseq" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmegseq
         ON ACTION controlp INFIELD xmegseq
            #add-point:ON ACTION controlp INFIELD xmegseq
            {<point name="construct.c.page1.xmegseq" />}
            #END add-point
 
         #Ctrlp:construct.c.page1.xmeg027
         ON ACTION controlp INFIELD xmeg027
            #add-point:ON ACTION controlp INFIELD xmeg027
            {<point name="construct.c.page1.xmeg027" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeg027
            #add-point:BEFORE FIELD xmeg027
            {<point name="construct.b.page1.xmeg027" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeg027
            
            #add-point:AFTER FIELD xmeg027
            {<point name="construct.a.page1.xmeg027" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmeg001
         ON ACTION controlp INFIELD xmeg001
            #add-point:ON ACTION controlp INFIELD xmeg001
            {<point name="construct.c.page1.xmeg001" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeg001
            #add-point:BEFORE FIELD xmeg001
            {<point name="construct.b.page1.xmeg001" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeg001
            
            #add-point:AFTER FIELD xmeg001
            {<point name="construct.a.page1.xmeg001" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeg002
            #add-point:BEFORE FIELD xmeg002
            {<point name="construct.b.page1.xmeg002" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeg002
            
            #add-point:AFTER FIELD xmeg002
            {<point name="construct.a.page1.xmeg002" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmeg002
         ON ACTION controlp INFIELD xmeg002
            #add-point:ON ACTION controlp INFIELD xmeg002
            {<point name="construct.c.page1.xmeg002" />}
            #END add-point
 
         #Ctrlp:construct.c.page1.xmeg004
         ON ACTION controlp INFIELD xmeg004
            #add-point:ON ACTION controlp INFIELD xmeg004
            {<point name="construct.c.page1.xmeg004" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeg004
            #add-point:BEFORE FIELD xmeg004
            {<point name="construct.b.page1.xmeg004" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeg004
            
            #add-point:AFTER FIELD xmeg004
            {<point name="construct.a.page1.xmeg004" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeg005
            #add-point:BEFORE FIELD xmeg005
            {<point name="construct.b.page1.xmeg005" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeg005
            
            #add-point:AFTER FIELD xmeg005
            {<point name="construct.a.page1.xmeg005" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmeg005
         ON ACTION controlp INFIELD xmeg005
            #add-point:ON ACTION controlp INFIELD xmeg005
            {<point name="construct.c.page1.xmeg005" />}
            #END add-point
 
         #Ctrlp:construct.c.page1.xmeg006
         ON ACTION controlp INFIELD xmeg006
            #add-point:ON ACTION controlp INFIELD xmeg006
            {<point name="construct.c.page1.xmeg006" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeg006
            #add-point:BEFORE FIELD xmeg006
            {<point name="construct.b.page1.xmeg006" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeg006
            
            #add-point:AFTER FIELD xmeg006
            {<point name="construct.a.page1.xmeg006" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeg007
            #add-point:BEFORE FIELD xmeg007
            {<point name="construct.b.page1.xmeg007" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeg007
            
            #add-point:AFTER FIELD xmeg007
            {<point name="construct.a.page1.xmeg007" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmeg007
         ON ACTION controlp INFIELD xmeg007
            #add-point:ON ACTION controlp INFIELD xmeg007
            {<point name="construct.c.page1.xmeg007" />}
            #END add-point
 
         #Ctrlp:construct.c.page1.xmeg008
         ON ACTION controlp INFIELD xmeg008
            #add-point:ON ACTION controlp INFIELD xmeg008
            {<point name="construct.c.page1.xmeg008" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeg008
            #add-point:BEFORE FIELD xmeg008
            {<point name="construct.b.page1.xmeg008" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeg008
            
            #add-point:AFTER FIELD xmeg008
            {<point name="construct.a.page1.xmeg008" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeg009
            #add-point:BEFORE FIELD xmeg009
            {<point name="construct.b.page1.xmeg009" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeg009
            
            #add-point:AFTER FIELD xmeg009
            {<point name="construct.a.page1.xmeg009" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmeg009
         ON ACTION controlp INFIELD xmeg009
            #add-point:ON ACTION controlp INFIELD xmeg009
            {<point name="construct.c.page1.xmeg009" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeg024
            #add-point:BEFORE FIELD xmeg024
            {<point name="construct.b.page1.xmeg024" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeg024
            
            #add-point:AFTER FIELD xmeg024
            {<point name="construct.a.page1.xmeg024" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmeg024
         ON ACTION controlp INFIELD xmeg024
            #add-point:ON ACTION controlp INFIELD xmeg024
            {<point name="construct.c.page1.xmeg024" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeg012
            #add-point:BEFORE FIELD xmeg012
            {<point name="construct.b.page1.xmeg012" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeg012
            
            #add-point:AFTER FIELD xmeg012
            {<point name="construct.a.page1.xmeg012" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmeg012
         ON ACTION controlp INFIELD xmeg012
            #add-point:ON ACTION controlp INFIELD xmeg012
            {<point name="construct.c.page1.xmeg012" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeg013
            #add-point:BEFORE FIELD xmeg013
            {<point name="construct.b.page1.xmeg013" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeg013
            
            #add-point:AFTER FIELD xmeg013
            {<point name="construct.a.page1.xmeg013" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmeg013
         ON ACTION controlp INFIELD xmeg013
            #add-point:ON ACTION controlp INFIELD xmeg013
            {<point name="construct.c.page1.xmeg013" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeg045
            #add-point:BEFORE FIELD xmeg045
            {<point name="construct.b.page1.xmeg045" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeg045
            
            #add-point:AFTER FIELD xmeg045
            {<point name="construct.a.page1.xmeg045" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmeg045
         ON ACTION controlp INFIELD xmeg045
            #add-point:ON ACTION controlp INFIELD xmeg045
            {<point name="construct.c.page1.xmeg045" />}
            #END add-point
 
         #Ctrlp:construct.c.page1.xmeg010
         ON ACTION controlp INFIELD xmeg010
            #add-point:ON ACTION controlp INFIELD xmeg010
            {<point name="construct.c.page1.xmeg010" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeg010
            #add-point:BEFORE FIELD xmeg010
            {<point name="construct.b.page1.xmeg010" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeg010
            
            #add-point:AFTER FIELD xmeg010
            {<point name="construct.a.page1.xmeg010" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeg011
            #add-point:BEFORE FIELD xmeg011
            {<point name="construct.b.page1.xmeg011" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeg011
            
            #add-point:AFTER FIELD xmeg011
            {<point name="construct.a.page1.xmeg011" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmeg011
         ON ACTION controlp INFIELD xmeg011
            #add-point:ON ACTION controlp INFIELD xmeg011
            {<point name="construct.c.page1.xmeg011" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeg015
            #add-point:BEFORE FIELD xmeg015
            {<point name="construct.b.page1.xmeg015" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeg015
            
            #add-point:AFTER FIELD xmeg015
            {<point name="construct.a.page1.xmeg015" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmeg015
         ON ACTION controlp INFIELD xmeg015
            #add-point:ON ACTION controlp INFIELD xmeg015
            {<point name="construct.c.page1.xmeg015" />}
            #END add-point
 
         #Ctrlp:construct.c.page1.xmeg016
         ON ACTION controlp INFIELD xmeg016
            #add-point:ON ACTION controlp INFIELD xmeg016
            {<point name="construct.c.page1.xmeg016" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeg016
            #add-point:BEFORE FIELD xmeg016
            {<point name="construct.b.page1.xmeg016" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeg016
            
            #add-point:AFTER FIELD xmeg016
            {<point name="construct.a.page1.xmeg016" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeg016_desc
            #add-point:BEFORE FIELD xmeg016_desc
            {<point name="construct.b.page1.xmeg016_desc" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeg016_desc
            
            #add-point:AFTER FIELD xmeg016_desc
            {<point name="construct.a.page1.xmeg016_desc" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmeg016_desc
         ON ACTION controlp INFIELD xmeg016_desc
            #add-point:ON ACTION controlp INFIELD xmeg016_desc
            {<point name="construct.c.page1.xmeg016_desc" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeg017
            #add-point:BEFORE FIELD xmeg017
            {<point name="construct.b.page1.xmeg017" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeg017
            
            #add-point:AFTER FIELD xmeg017
            {<point name="construct.a.page1.xmeg017" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmeg017
         ON ACTION controlp INFIELD xmeg017
            #add-point:ON ACTION controlp INFIELD xmeg017
            {<point name="construct.c.page1.xmeg017" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeg046
            #add-point:BEFORE FIELD xmeg046
            {<point name="construct.b.page1.xmeg046" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeg046
            
            #add-point:AFTER FIELD xmeg046
            {<point name="construct.a.page1.xmeg046" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmeg046
         ON ACTION controlp INFIELD xmeg046
            #add-point:ON ACTION controlp INFIELD xmeg046
            {<point name="construct.c.page1.xmeg046" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeg047
            #add-point:BEFORE FIELD xmeg047
            {<point name="construct.b.page1.xmeg047" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeg047
            
            #add-point:AFTER FIELD xmeg047
            {<point name="construct.a.page1.xmeg047" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmeg047
         ON ACTION controlp INFIELD xmeg047
            #add-point:ON ACTION controlp INFIELD xmeg047
            {<point name="construct.c.page1.xmeg047" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeg048
            #add-point:BEFORE FIELD xmeg048
            {<point name="construct.b.page1.xmeg048" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeg048
            
            #add-point:AFTER FIELD xmeg048
            {<point name="construct.a.page1.xmeg048" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmeg048
         ON ACTION controlp INFIELD xmeg048
            #add-point:ON ACTION controlp INFIELD xmeg048
            {<point name="construct.c.page1.xmeg048" />}
            #END add-point
 
         #Ctrlp:construct.c.page1.xmeg023
         ON ACTION controlp INFIELD xmeg023
            #add-point:ON ACTION controlp INFIELD xmeg023
            {<point name="construct.c.page1.xmeg023" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeg023
            #add-point:BEFORE FIELD xmeg023
            {<point name="construct.b.page1.xmeg023" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeg023
            
            #add-point:AFTER FIELD xmeg023
            {<point name="construct.a.page1.xmeg023" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeg019
            #add-point:BEFORE FIELD xmeg019
            {<point name="construct.b.page1.xmeg019" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeg019
            
            #add-point:AFTER FIELD xmeg019
            {<point name="construct.a.page1.xmeg019" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmeg019
         ON ACTION controlp INFIELD xmeg019
            #add-point:ON ACTION controlp INFIELD xmeg019
            {<point name="construct.c.page1.xmeg019" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeg020
            #add-point:BEFORE FIELD xmeg020
            {<point name="construct.b.page1.xmeg020" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeg020
            
            #add-point:AFTER FIELD xmeg020
            {<point name="construct.a.page1.xmeg020" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmeg020
         ON ACTION controlp INFIELD xmeg020
            #add-point:ON ACTION controlp INFIELD xmeg020
            {<point name="construct.c.page1.xmeg020" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeg021
            #add-point:BEFORE FIELD xmeg021
            {<point name="construct.b.page1.xmeg021" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeg021
            
            #add-point:AFTER FIELD xmeg021
            {<point name="construct.a.page1.xmeg021" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmeg021
         ON ACTION controlp INFIELD xmeg021
            #add-point:ON ACTION controlp INFIELD xmeg021
            {<point name="construct.c.page1.xmeg021" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeg022
            #add-point:BEFORE FIELD xmeg022
            {<point name="construct.b.page1.xmeg022" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeg022
            
            #add-point:AFTER FIELD xmeg022
            {<point name="construct.a.page1.xmeg022" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmeg022
         ON ACTION controlp INFIELD xmeg022
            #add-point:ON ACTION controlp INFIELD xmeg022
            {<point name="construct.c.page1.xmeg022" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeg051
            #add-point:BEFORE FIELD xmeg051
            {<point name="construct.b.page1.xmeg051" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeg051
            
            #add-point:AFTER FIELD xmeg051
            {<point name="construct.a.page1.xmeg051" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmeg051
         ON ACTION controlp INFIELD xmeg051
            #add-point:ON ACTION controlp INFIELD xmeg051
            {<point name="construct.c.page1.xmeg051" />}
            #END add-point
 
         #Ctrlp:construct.c.page1.xmegunit
         ON ACTION controlp INFIELD xmegunit
            #add-point:ON ACTION controlp INFIELD xmegunit
            {<point name="construct.c.page1.xmegunit" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmegunit
            #add-point:BEFORE FIELD xmegunit
            {<point name="construct.b.page1.xmegunit" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmegunit
            
            #add-point:AFTER FIELD xmegunit
            {<point name="construct.a.page1.xmegunit" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmegorga
         ON ACTION controlp INFIELD xmegorga
            #add-point:ON ACTION controlp INFIELD xmegorga
            {<point name="construct.c.page1.xmegorga" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmegorga
            #add-point:BEFORE FIELD xmegorga
            {<point name="construct.b.page1.xmegorga" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmegorga
            
            #add-point:AFTER FIELD xmegorga
            {<point name="construct.a.page1.xmegorga" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeg052
            #add-point:BEFORE FIELD xmeg052
            {<point name="construct.b.page1.xmeg052" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeg052
            
            #add-point:AFTER FIELD xmeg052
            {<point name="construct.a.page1.xmeg052" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmeg052
         ON ACTION controlp INFIELD xmeg052
            #add-point:ON ACTION controlp INFIELD xmeg052
            {<point name="construct.c.page1.xmeg052" />}
            #END add-point
 
         #Ctrlp:construct.c.page1.xmeg049
         ON ACTION controlp INFIELD xmeg049
            #add-point:ON ACTION controlp INFIELD xmeg049
            {<point name="construct.c.page1.xmeg049" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeg049
            #add-point:BEFORE FIELD xmeg049
            {<point name="construct.b.page1.xmeg049" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeg049
            
            #add-point:AFTER FIELD xmeg049
            {<point name="construct.a.page1.xmeg049" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmeg053
         ON ACTION controlp INFIELD xmeg053
            #add-point:ON ACTION controlp INFIELD xmeg053
            {<point name="construct.c.page1.xmeg053" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeg053
            #add-point:BEFORE FIELD xmeg053
            {<point name="construct.b.page1.xmeg053" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeg053
            
            #add-point:AFTER FIELD xmeg053
            {<point name="construct.a.page1.xmeg053" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeg050
            #add-point:BEFORE FIELD xmeg050
            {<point name="construct.b.page1.xmeg050" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeg050
            
            #add-point:AFTER FIELD xmeg050
            {<point name="construct.a.page1.xmeg050" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmeg050
         ON ACTION controlp INFIELD xmeg050
            #add-point:ON ACTION controlp INFIELD xmeg050
            {<point name="construct.c.page1.xmeg050" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeg901
            #add-point:BEFORE FIELD xmeg901
            {<point name="construct.b.page1.xmeg901" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeg901
            
            #add-point:AFTER FIELD xmeg901
            {<point name="construct.a.page1.xmeg901" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmeg901
         ON ACTION controlp INFIELD xmeg901
            #add-point:ON ACTION controlp INFIELD xmeg901
            {<point name="construct.c.page1.xmeg901" />}
            #END add-point
 
         #Ctrlp:construct.c.page1.xmeg902
         ON ACTION controlp INFIELD xmeg902
            #add-point:ON ACTION controlp INFIELD xmeg902
            {<point name="construct.c.page1.xmeg902" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeg902
            #add-point:BEFORE FIELD xmeg902
            {<point name="construct.b.page1.xmeg902" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeg902
            
            #add-point:AFTER FIELD xmeg902
            {<point name="construct.a.page1.xmeg902" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeg903
            #add-point:BEFORE FIELD xmeg903
            {<point name="construct.b.page1.xmeg903" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeg903
            
            #add-point:AFTER FIELD xmeg903
            {<point name="construct.a.page1.xmeg903" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmeg903
         ON ACTION controlp INFIELD xmeg903
            #add-point:ON ACTION controlp INFIELD xmeg903
            {<point name="construct.c.page1.xmeg903" />}
            #END add-point
 
   
       
      END CONSTRUCT
      
      CONSTRUCT g_wc2_table2 ON xmehdocno,xmehseq,xmehseq1,xmeh229,xmeh003,xmeh001,xmeh002,xmeh200,xmeh004, 
          xmeh005,xmeh011,xmeh012,xmehseq2,xmeh006,xmeh201,xmeh202,xmeh024,xmeh025,xmeh026,xmeh027,xmeh203, 
          xmeh204,xmeh205,xmeh206,xmeh029,xmeh028,xmeh019,xmeh019_desc,xmeh030,xmeh207,xmehunit,xmeh210, 
          xmeh212,xmeh213,xmeh214,xmeh215,xmeh031,xmeh014,xmeh015,xmeh016,xmeh017,xmeh221,xmehsite,xmeh218, 
          xmeh219,xmeh220,xmeh222,xmeh223,xmeh224,xmehorga,xmeh226,xmeh227,xmeh228,xmeh901
           FROM s_detail3[1].xmehdocno,s_detail3[1].xmehseq,s_detail3[1].xmehseq1,s_detail3[1].xmeh229, 
               s_detail3[1].xmeh003,s_detail3[1].xmeh001,s_detail3[1].xmeh002,s_detail3[1].xmeh200,s_detail3[1].xmeh004, 
               s_detail3[1].xmeh005,s_detail3[1].xmeh011,s_detail3[1].xmeh012,s_detail3[1].xmehseq2, 
               s_detail3[1].xmeh006,s_detail3[1].xmeh201,s_detail3[1].xmeh202,s_detail3[1].xmeh024,s_detail3[1].xmeh025, 
               s_detail3[1].xmeh026,s_detail3[1].xmeh027,s_detail3[1].xmeh203,s_detail3[1].xmeh204,s_detail3[1].xmeh205, 
               s_detail3[1].xmeh206,s_detail3[1].xmeh029,s_detail3[1].xmeh028,s_detail3[1].xmeh019,s_detail3[1].xmeh019_desc, 
               s_detail3[1].xmeh030,s_detail3[1].xmeh207,s_detail3[1].xmehunit,s_detail3[1].xmeh210, 
               s_detail3[1].xmeh212,s_detail3[1].xmeh213,s_detail3[1].xmeh214,s_detail3[1].xmeh215,s_detail3[1].xmeh031, 
               s_detail3[1].xmeh014,s_detail3[1].xmeh015,s_detail3[1].xmeh016,s_detail3[1].xmeh017,s_detail3[1].xmeh221, 
               s_detail3[1].xmehsite,s_detail3[1].xmeh218,s_detail3[1].xmeh219,s_detail3[1].xmeh220, 
               s_detail3[1].xmeh222,s_detail3[1].xmeh223,s_detail3[1].xmeh224,s_detail3[1].xmehorga, 
               s_detail3[1].xmeh226,s_detail3[1].xmeh227,s_detail3[1].xmeh228,s_detail3[1].xmeh901
                      
         BEFORE CONSTRUCT
            #add-point:cs段before_construct
            {<point name="cs.body2.before_construct"/>}
            #end add-point 
            
       #單身公用欄位開窗相關處理(table 2)
       
       
       #單身一般欄位開窗相關處理       
                #此段落由子樣板a01產生
         BEFORE FIELD xmehdocno
            #add-point:BEFORE FIELD xmehdocno
            {<point name="construct.b.page3.xmehdocno" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmehdocno
            
            #add-point:AFTER FIELD xmehdocno
            {<point name="construct.a.page3.xmehdocno" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xmehdocno
         ON ACTION controlp INFIELD xmehdocno
            #add-point:ON ACTION controlp INFIELD xmehdocno
            {<point name="construct.c.page3.xmehdocno" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmehseq
            #add-point:BEFORE FIELD xmehseq
            {<point name="construct.b.page3.xmehseq" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmehseq
            
            #add-point:AFTER FIELD xmehseq
            {<point name="construct.a.page3.xmehseq" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xmehseq
         ON ACTION controlp INFIELD xmehseq
            #add-point:ON ACTION controlp INFIELD xmehseq
            {<point name="construct.c.page3.xmehseq" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmehseq1
            #add-point:BEFORE FIELD xmehseq1
            {<point name="construct.b.page3.xmehseq1" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmehseq1
            
            #add-point:AFTER FIELD xmehseq1
            {<point name="construct.a.page3.xmehseq1" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xmehseq1
         ON ACTION controlp INFIELD xmehseq1
            #add-point:ON ACTION controlp INFIELD xmehseq1
            {<point name="construct.c.page3.xmehseq1" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeh229
            #add-point:BEFORE FIELD xmeh229
            {<point name="construct.b.page3.xmeh229" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeh229
            
            #add-point:AFTER FIELD xmeh229
            {<point name="construct.a.page3.xmeh229" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xmeh229
         ON ACTION controlp INFIELD xmeh229
            #add-point:ON ACTION controlp INFIELD xmeh229
            {<point name="construct.c.page3.xmeh229" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeh003
            #add-point:BEFORE FIELD xmeh003
            {<point name="construct.b.page3.xmeh003" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeh003
            
            #add-point:AFTER FIELD xmeh003
            {<point name="construct.a.page3.xmeh003" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xmeh003
         ON ACTION controlp INFIELD xmeh003
            #add-point:ON ACTION controlp INFIELD xmeh003
            {<point name="construct.c.page3.xmeh003" />}
            #END add-point
 
         #Ctrlp:construct.c.page3.xmeh001
         ON ACTION controlp INFIELD xmeh001
            #add-point:ON ACTION controlp INFIELD xmeh001
            {<point name="construct.c.page3.xmeh001" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeh001
            #add-point:BEFORE FIELD xmeh001
            {<point name="construct.b.page3.xmeh001" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeh001
            
            #add-point:AFTER FIELD xmeh001
            {<point name="construct.a.page3.xmeh001" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeh002
            #add-point:BEFORE FIELD xmeh002
            {<point name="construct.b.page3.xmeh002" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeh002
            
            #add-point:AFTER FIELD xmeh002
            {<point name="construct.a.page3.xmeh002" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xmeh002
         ON ACTION controlp INFIELD xmeh002
            #add-point:ON ACTION controlp INFIELD xmeh002
            {<point name="construct.c.page3.xmeh002" />}
            #END add-point
 
         #Ctrlp:construct.c.page3.xmeh200
         ON ACTION controlp INFIELD xmeh200
            #add-point:ON ACTION controlp INFIELD xmeh200
            {<point name="construct.c.page3.xmeh200" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeh200
            #add-point:BEFORE FIELD xmeh200
            {<point name="construct.b.page3.xmeh200" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeh200
            
            #add-point:AFTER FIELD xmeh200
            {<point name="construct.a.page3.xmeh200" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xmeh004
         ON ACTION controlp INFIELD xmeh004
            #add-point:ON ACTION controlp INFIELD xmeh004
            {<point name="construct.c.page3.xmeh004" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeh004
            #add-point:BEFORE FIELD xmeh004
            {<point name="construct.b.page3.xmeh004" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeh004
            
            #add-point:AFTER FIELD xmeh004
            {<point name="construct.a.page3.xmeh004" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeh005
            #add-point:BEFORE FIELD xmeh005
            {<point name="construct.b.page3.xmeh005" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeh005
            
            #add-point:AFTER FIELD xmeh005
            {<point name="construct.a.page3.xmeh005" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xmeh005
         ON ACTION controlp INFIELD xmeh005
            #add-point:ON ACTION controlp INFIELD xmeh005
            {<point name="construct.c.page3.xmeh005" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeh011
            #add-point:BEFORE FIELD xmeh011
            {<point name="construct.b.page3.xmeh011" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeh011
            
            #add-point:AFTER FIELD xmeh011
            {<point name="construct.a.page3.xmeh011" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xmeh011
         ON ACTION controlp INFIELD xmeh011
            #add-point:ON ACTION controlp INFIELD xmeh011
            {<point name="construct.c.page3.xmeh011" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeh012
            #add-point:BEFORE FIELD xmeh012
            {<point name="construct.b.page3.xmeh012" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeh012
            
            #add-point:AFTER FIELD xmeh012
            {<point name="construct.a.page3.xmeh012" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xmeh012
         ON ACTION controlp INFIELD xmeh012
            #add-point:ON ACTION controlp INFIELD xmeh012
            {<point name="construct.c.page3.xmeh012" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmehseq2
            #add-point:BEFORE FIELD xmehseq2
            {<point name="construct.b.page3.xmehseq2" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmehseq2
            
            #add-point:AFTER FIELD xmehseq2
            {<point name="construct.a.page3.xmehseq2" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xmehseq2
         ON ACTION controlp INFIELD xmehseq2
            #add-point:ON ACTION controlp INFIELD xmehseq2
            {<point name="construct.c.page3.xmehseq2" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeh006
            #add-point:BEFORE FIELD xmeh006
            {<point name="construct.b.page3.xmeh006" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeh006
            
            #add-point:AFTER FIELD xmeh006
            {<point name="construct.a.page3.xmeh006" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xmeh006
         ON ACTION controlp INFIELD xmeh006
            #add-point:ON ACTION controlp INFIELD xmeh006
            {<point name="construct.c.page3.xmeh006" />}
            #END add-point
 
         #Ctrlp:construct.c.page3.xmeh201
         ON ACTION controlp INFIELD xmeh201
            #add-point:ON ACTION controlp INFIELD xmeh201
            {<point name="construct.c.page3.xmeh201" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeh201
            #add-point:BEFORE FIELD xmeh201
            {<point name="construct.b.page3.xmeh201" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeh201
            
            #add-point:AFTER FIELD xmeh201
            {<point name="construct.a.page3.xmeh201" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeh202
            #add-point:BEFORE FIELD xmeh202
            {<point name="construct.b.page3.xmeh202" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeh202
            
            #add-point:AFTER FIELD xmeh202
            {<point name="construct.a.page3.xmeh202" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xmeh202
         ON ACTION controlp INFIELD xmeh202
            #add-point:ON ACTION controlp INFIELD xmeh202
            {<point name="construct.c.page3.xmeh202" />}
            #END add-point
 
         #Ctrlp:construct.c.page3.xmeh024
         ON ACTION controlp INFIELD xmeh024
            #add-point:ON ACTION controlp INFIELD xmeh024
            {<point name="construct.c.page3.xmeh024" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeh024
            #add-point:BEFORE FIELD xmeh024
            {<point name="construct.b.page3.xmeh024" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeh024
            
            #add-point:AFTER FIELD xmeh024
            {<point name="construct.a.page3.xmeh024" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeh025
            #add-point:BEFORE FIELD xmeh025
            {<point name="construct.b.page3.xmeh025" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeh025
            
            #add-point:AFTER FIELD xmeh025
            {<point name="construct.a.page3.xmeh025" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xmeh025
         ON ACTION controlp INFIELD xmeh025
            #add-point:ON ACTION controlp INFIELD xmeh025
            {<point name="construct.c.page3.xmeh025" />}
            #END add-point
 
         #Ctrlp:construct.c.page3.xmeh026
         ON ACTION controlp INFIELD xmeh026
            #add-point:ON ACTION controlp INFIELD xmeh026
            {<point name="construct.c.page3.xmeh026" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeh026
            #add-point:BEFORE FIELD xmeh026
            {<point name="construct.b.page3.xmeh026" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeh026
            
            #add-point:AFTER FIELD xmeh026
            {<point name="construct.a.page3.xmeh026" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeh027
            #add-point:BEFORE FIELD xmeh027
            {<point name="construct.b.page3.xmeh027" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeh027
            
            #add-point:AFTER FIELD xmeh027
            {<point name="construct.a.page3.xmeh027" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xmeh027
         ON ACTION controlp INFIELD xmeh027
            #add-point:ON ACTION controlp INFIELD xmeh027
            {<point name="construct.c.page3.xmeh027" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeh203
            #add-point:BEFORE FIELD xmeh203
            {<point name="construct.b.page3.xmeh203" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeh203
            
            #add-point:AFTER FIELD xmeh203
            {<point name="construct.a.page3.xmeh203" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xmeh203
         ON ACTION controlp INFIELD xmeh203
            #add-point:ON ACTION controlp INFIELD xmeh203
            {<point name="construct.c.page3.xmeh203" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeh204
            #add-point:BEFORE FIELD xmeh204
            {<point name="construct.b.page3.xmeh204" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeh204
            
            #add-point:AFTER FIELD xmeh204
            {<point name="construct.a.page3.xmeh204" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xmeh204
         ON ACTION controlp INFIELD xmeh204
            #add-point:ON ACTION controlp INFIELD xmeh204
            {<point name="construct.c.page3.xmeh204" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeh205
            #add-point:BEFORE FIELD xmeh205
            {<point name="construct.b.page3.xmeh205" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeh205
            
            #add-point:AFTER FIELD xmeh205
            {<point name="construct.a.page3.xmeh205" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xmeh205
         ON ACTION controlp INFIELD xmeh205
            #add-point:ON ACTION controlp INFIELD xmeh205
            {<point name="construct.c.page3.xmeh205" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeh206
            #add-point:BEFORE FIELD xmeh206
            {<point name="construct.b.page3.xmeh206" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeh206
            
            #add-point:AFTER FIELD xmeh206
            {<point name="construct.a.page3.xmeh206" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xmeh206
         ON ACTION controlp INFIELD xmeh206
            #add-point:ON ACTION controlp INFIELD xmeh206
            {<point name="construct.c.page3.xmeh206" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeh029
            #add-point:BEFORE FIELD xmeh029
            {<point name="construct.b.page3.xmeh029" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeh029
            
            #add-point:AFTER FIELD xmeh029
            {<point name="construct.a.page3.xmeh029" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xmeh029
         ON ACTION controlp INFIELD xmeh029
            #add-point:ON ACTION controlp INFIELD xmeh029
            {<point name="construct.c.page3.xmeh029" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeh028
            #add-point:BEFORE FIELD xmeh028
            {<point name="construct.b.page3.xmeh028" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeh028
            
            #add-point:AFTER FIELD xmeh028
            {<point name="construct.a.page3.xmeh028" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xmeh028
         ON ACTION controlp INFIELD xmeh028
            #add-point:ON ACTION controlp INFIELD xmeh028
            {<point name="construct.c.page3.xmeh028" />}
            #END add-point
 
         #Ctrlp:construct.c.page3.xmeh019
         ON ACTION controlp INFIELD xmeh019
            #add-point:ON ACTION controlp INFIELD xmeh019
            {<point name="construct.c.page3.xmeh019" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeh019
            #add-point:BEFORE FIELD xmeh019
            {<point name="construct.b.page3.xmeh019" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeh019
            
            #add-point:AFTER FIELD xmeh019
            {<point name="construct.a.page3.xmeh019" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeh019_desc
            #add-point:BEFORE FIELD xmeh019_desc
            {<point name="construct.b.page3.xmeh019_desc" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeh019_desc
            
            #add-point:AFTER FIELD xmeh019_desc
            {<point name="construct.a.page3.xmeh019_desc" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xmeh019_desc
         ON ACTION controlp INFIELD xmeh019_desc
            #add-point:ON ACTION controlp INFIELD xmeh019_desc
            {<point name="construct.c.page3.xmeh019_desc" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeh030
            #add-point:BEFORE FIELD xmeh030
            {<point name="construct.b.page3.xmeh030" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeh030
            
            #add-point:AFTER FIELD xmeh030
            {<point name="construct.a.page3.xmeh030" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xmeh030
         ON ACTION controlp INFIELD xmeh030
            #add-point:ON ACTION controlp INFIELD xmeh030
            {<point name="construct.c.page3.xmeh030" />}
            #END add-point
 
         #Ctrlp:construct.c.page3.xmeh207
         ON ACTION controlp INFIELD xmeh207
            #add-point:ON ACTION controlp INFIELD xmeh207
            {<point name="construct.c.page3.xmeh207" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeh207
            #add-point:BEFORE FIELD xmeh207
            {<point name="construct.b.page3.xmeh207" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeh207
            
            #add-point:AFTER FIELD xmeh207
            {<point name="construct.a.page3.xmeh207" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xmehunit
         ON ACTION controlp INFIELD xmehunit
            #add-point:ON ACTION controlp INFIELD xmehunit
            {<point name="construct.c.page3.xmehunit" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmehunit
            #add-point:BEFORE FIELD xmehunit
            {<point name="construct.b.page3.xmehunit" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmehunit
            
            #add-point:AFTER FIELD xmehunit
            {<point name="construct.a.page3.xmehunit" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xmeh210
         ON ACTION controlp INFIELD xmeh210
            #add-point:ON ACTION controlp INFIELD xmeh210
            {<point name="construct.c.page3.xmeh210" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeh210
            #add-point:BEFORE FIELD xmeh210
            {<point name="construct.b.page3.xmeh210" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeh210
            
            #add-point:AFTER FIELD xmeh210
            {<point name="construct.a.page3.xmeh210" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeh212
            #add-point:BEFORE FIELD xmeh212
            {<point name="construct.b.page3.xmeh212" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeh212
            
            #add-point:AFTER FIELD xmeh212
            {<point name="construct.a.page3.xmeh212" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xmeh212
         ON ACTION controlp INFIELD xmeh212
            #add-point:ON ACTION controlp INFIELD xmeh212
            {<point name="construct.c.page3.xmeh212" />}
            #END add-point
 
         #Ctrlp:construct.c.page3.xmeh213
         ON ACTION controlp INFIELD xmeh213
            #add-point:ON ACTION controlp INFIELD xmeh213
            {<point name="construct.c.page3.xmeh213" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeh213
            #add-point:BEFORE FIELD xmeh213
            {<point name="construct.b.page3.xmeh213" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeh213
            
            #add-point:AFTER FIELD xmeh213
            {<point name="construct.a.page3.xmeh213" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xmeh214
         ON ACTION controlp INFIELD xmeh214
            #add-point:ON ACTION controlp INFIELD xmeh214
            {<point name="construct.c.page3.xmeh214" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeh214
            #add-point:BEFORE FIELD xmeh214
            {<point name="construct.b.page3.xmeh214" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeh214
            
            #add-point:AFTER FIELD xmeh214
            {<point name="construct.a.page3.xmeh214" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeh215
            #add-point:BEFORE FIELD xmeh215
            {<point name="construct.b.page3.xmeh215" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeh215
            
            #add-point:AFTER FIELD xmeh215
            {<point name="construct.a.page3.xmeh215" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xmeh215
         ON ACTION controlp INFIELD xmeh215
            #add-point:ON ACTION controlp INFIELD xmeh215
            {<point name="construct.c.page3.xmeh215" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeh031
            #add-point:BEFORE FIELD xmeh031
            {<point name="construct.b.page3.xmeh031" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeh031
            
            #add-point:AFTER FIELD xmeh031
            {<point name="construct.a.page3.xmeh031" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xmeh031
         ON ACTION controlp INFIELD xmeh031
            #add-point:ON ACTION controlp INFIELD xmeh031
            {<point name="construct.c.page3.xmeh031" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeh014
            #add-point:BEFORE FIELD xmeh014
            {<point name="construct.b.page3.xmeh014" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeh014
            
            #add-point:AFTER FIELD xmeh014
            {<point name="construct.a.page3.xmeh014" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xmeh014
         ON ACTION controlp INFIELD xmeh014
            #add-point:ON ACTION controlp INFIELD xmeh014
            {<point name="construct.c.page3.xmeh014" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeh015
            #add-point:BEFORE FIELD xmeh015
            {<point name="construct.b.page3.xmeh015" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeh015
            
            #add-point:AFTER FIELD xmeh015
            {<point name="construct.a.page3.xmeh015" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xmeh015
         ON ACTION controlp INFIELD xmeh015
            #add-point:ON ACTION controlp INFIELD xmeh015
            {<point name="construct.c.page3.xmeh015" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeh016
            #add-point:BEFORE FIELD xmeh016
            {<point name="construct.b.page3.xmeh016" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeh016
            
            #add-point:AFTER FIELD xmeh016
            {<point name="construct.a.page3.xmeh016" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xmeh016
         ON ACTION controlp INFIELD xmeh016
            #add-point:ON ACTION controlp INFIELD xmeh016
            {<point name="construct.c.page3.xmeh016" />}
            #END add-point
 
         #Ctrlp:construct.c.page3.xmeh017
         ON ACTION controlp INFIELD xmeh017
            #add-point:ON ACTION controlp INFIELD xmeh017
            {<point name="construct.c.page3.xmeh017" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeh017
            #add-point:BEFORE FIELD xmeh017
            {<point name="construct.b.page3.xmeh017" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeh017
            
            #add-point:AFTER FIELD xmeh017
            {<point name="construct.a.page3.xmeh017" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeh221
            #add-point:BEFORE FIELD xmeh221
            {<point name="construct.b.page3.xmeh221" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeh221
            
            #add-point:AFTER FIELD xmeh221
            {<point name="construct.a.page3.xmeh221" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xmeh221
         ON ACTION controlp INFIELD xmeh221
            #add-point:ON ACTION controlp INFIELD xmeh221
            {<point name="construct.c.page3.xmeh221" />}
            #END add-point
 
         #Ctrlp:construct.c.page3.xmehsite
         ON ACTION controlp INFIELD xmehsite
            #add-point:ON ACTION controlp INFIELD xmehsite
            {<point name="construct.c.page3.xmehsite" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmehsite
            #add-point:BEFORE FIELD xmehsite
            {<point name="construct.b.page3.xmehsite" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmehsite
            
            #add-point:AFTER FIELD xmehsite
            {<point name="construct.a.page3.xmehsite" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xmeh218
         ON ACTION controlp INFIELD xmeh218
            #add-point:ON ACTION controlp INFIELD xmeh218
            {<point name="construct.c.page3.xmeh218" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeh218
            #add-point:BEFORE FIELD xmeh218
            {<point name="construct.b.page3.xmeh218" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeh218
            
            #add-point:AFTER FIELD xmeh218
            {<point name="construct.a.page3.xmeh218" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xmeh219
         ON ACTION controlp INFIELD xmeh219
            #add-point:ON ACTION controlp INFIELD xmeh219
            {<point name="construct.c.page3.xmeh219" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeh219
            #add-point:BEFORE FIELD xmeh219
            {<point name="construct.b.page3.xmeh219" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeh219
            
            #add-point:AFTER FIELD xmeh219
            {<point name="construct.a.page3.xmeh219" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xmeh220
         ON ACTION controlp INFIELD xmeh220
            #add-point:ON ACTION controlp INFIELD xmeh220
            {<point name="construct.c.page3.xmeh220" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeh220
            #add-point:BEFORE FIELD xmeh220
            {<point name="construct.b.page3.xmeh220" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeh220
            
            #add-point:AFTER FIELD xmeh220
            {<point name="construct.a.page3.xmeh220" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xmeh222
         ON ACTION controlp INFIELD xmeh222
            #add-point:ON ACTION controlp INFIELD xmeh222
            {<point name="construct.c.page3.xmeh222" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeh222
            #add-point:BEFORE FIELD xmeh222
            {<point name="construct.b.page3.xmeh222" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeh222
            
            #add-point:AFTER FIELD xmeh222
            {<point name="construct.a.page3.xmeh222" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xmeh223
         ON ACTION controlp INFIELD xmeh223
            #add-point:ON ACTION controlp INFIELD xmeh223
            {<point name="construct.c.page3.xmeh223" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeh223
            #add-point:BEFORE FIELD xmeh223
            {<point name="construct.b.page3.xmeh223" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeh223
            
            #add-point:AFTER FIELD xmeh223
            {<point name="construct.a.page3.xmeh223" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xmeh224
         ON ACTION controlp INFIELD xmeh224
            #add-point:ON ACTION controlp INFIELD xmeh224
            {<point name="construct.c.page3.xmeh224" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeh224
            #add-point:BEFORE FIELD xmeh224
            {<point name="construct.b.page3.xmeh224" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeh224
            
            #add-point:AFTER FIELD xmeh224
            {<point name="construct.a.page3.xmeh224" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xmehorga
         ON ACTION controlp INFIELD xmehorga
            #add-point:ON ACTION controlp INFIELD xmehorga
            {<point name="construct.c.page3.xmehorga" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmehorga
            #add-point:BEFORE FIELD xmehorga
            {<point name="construct.b.page3.xmehorga" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmehorga
            
            #add-point:AFTER FIELD xmehorga
            {<point name="construct.a.page3.xmehorga" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeh226
            #add-point:BEFORE FIELD xmeh226
            {<point name="construct.b.page3.xmeh226" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeh226
            
            #add-point:AFTER FIELD xmeh226
            {<point name="construct.a.page3.xmeh226" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xmeh226
         ON ACTION controlp INFIELD xmeh226
            #add-point:ON ACTION controlp INFIELD xmeh226
            {<point name="construct.c.page3.xmeh226" />}
            #END add-point
 
         #Ctrlp:construct.c.page3.xmeh227
         ON ACTION controlp INFIELD xmeh227
            #add-point:ON ACTION controlp INFIELD xmeh227
            {<point name="construct.c.page3.xmeh227" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeh227
            #add-point:BEFORE FIELD xmeh227
            {<point name="construct.b.page3.xmeh227" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeh227
            
            #add-point:AFTER FIELD xmeh227
            {<point name="construct.a.page3.xmeh227" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xmeh228
         ON ACTION controlp INFIELD xmeh228
            #add-point:ON ACTION controlp INFIELD xmeh228
            {<point name="construct.c.page3.xmeh228" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeh228
            #add-point:BEFORE FIELD xmeh228
            {<point name="construct.b.page3.xmeh228" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeh228
            
            #add-point:AFTER FIELD xmeh228
            {<point name="construct.a.page3.xmeh228" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeh901
            #add-point:BEFORE FIELD xmeh901
            {<point name="construct.b.page3.xmeh901" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeh901
            
            #add-point:AFTER FIELD xmeh901
            {<point name="construct.a.page3.xmeh901" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xmeh901
         ON ACTION controlp INFIELD xmeh901
            #add-point:ON ACTION controlp INFIELD xmeh901
            {<point name="construct.c.page3.xmeh901" />}
            #END add-point
 
   
       
      END CONSTRUCT
 
      CONSTRUCT g_wc2_table3 ON xmjbseq,xmjbsite,xmjb001,xmjb002,xmjb003,xmjb033,xmjb004,xmjb005,xmjb006, 
          xmjb006_desc,xmjb007,xmjb011,xmjb012,xmjb013,xmjb014,xmjb015,xmjb016,xmjb017,xmjb018,xmjb008, 
          xmjb009,xmjb010,xmjb022,xmjb019,xmjb020,xmjb021,xmjb024,xmjb025,xmjb026,xmjb027,xmjb028,xmjb029, 
          xmjb030,xmjb031,xmjb032,xmjb034,xmjb901,xmjb902,xmjb903
           FROM s_detail4[1].xmjbseq,s_detail4[1].xmjbsite,s_detail4[1].xmjb001,s_detail4[1].xmjb002, 
               s_detail4[1].xmjb003,s_detail4[1].xmjb033,s_detail4[1].xmjb004,s_detail4[1].xmjb005,s_detail4[1].xmjb006, 
               s_detail4[1].xmjb006_desc,s_detail4[1].xmjb007,s_detail4[1].xmjb011,s_detail4[1].xmjb012, 
               s_detail4[1].xmjb013,s_detail4[1].xmjb014,s_detail4[1].xmjb015,s_detail4[1].xmjb016,s_detail4[1].xmjb017, 
               s_detail4[1].xmjb018,s_detail4[1].xmjb008,s_detail4[1].xmjb009,s_detail4[1].xmjb010,s_detail4[1].xmjb022, 
               s_detail4[1].xmjb019,s_detail4[1].xmjb020,s_detail4[1].xmjb021,s_detail4[1].xmjb024,s_detail4[1].xmjb025, 
               s_detail4[1].xmjb026,s_detail4[1].xmjb027,s_detail4[1].xmjb028,s_detail4[1].xmjb029,s_detail4[1].xmjb030, 
               s_detail4[1].xmjb031,s_detail4[1].xmjb032,s_detail4[1].xmjb034,s_detail4[1].xmjb901,s_detail4[1].xmjb902, 
               s_detail4[1].xmjb903
                      
         BEFORE CONSTRUCT
            #add-point:cs段before_construct
            {<point name="cs.body3.before_construct"/>}
            #end add-point 
            
       #單身公用欄位開窗相關處理(table 3)
       
       
       #單身一般欄位開窗相關處理       
                #此段落由子樣板a01產生
         BEFORE FIELD xmjbseq
            #add-point:BEFORE FIELD xmjbseq
            {<point name="construct.b.page4.xmjbseq" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmjbseq
            
            #add-point:AFTER FIELD xmjbseq
            {<point name="construct.a.page4.xmjbseq" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.xmjbseq
         ON ACTION controlp INFIELD xmjbseq
            #add-point:ON ACTION controlp INFIELD xmjbseq
            {<point name="construct.c.page4.xmjbseq" />}
            #END add-point
 
         #Ctrlp:construct.c.page4.xmjbsite
         ON ACTION controlp INFIELD xmjbsite
            #add-point:ON ACTION controlp INFIELD xmjbsite
            {<point name="construct.c.page4.xmjbsite" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmjbsite
            #add-point:BEFORE FIELD xmjbsite
            {<point name="construct.b.page4.xmjbsite" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmjbsite
            
            #add-point:AFTER FIELD xmjbsite
            {<point name="construct.a.page4.xmjbsite" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmjb001
            #add-point:BEFORE FIELD xmjb001
            {<point name="construct.b.page4.xmjb001" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmjb001
            
            #add-point:AFTER FIELD xmjb001
            {<point name="construct.a.page4.xmjb001" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.xmjb001
         ON ACTION controlp INFIELD xmjb001
            #add-point:ON ACTION controlp INFIELD xmjb001
            {<point name="construct.c.page4.xmjb001" />}
            #END add-point
 
         #Ctrlp:construct.c.page4.xmjb002
         ON ACTION controlp INFIELD xmjb002
            #add-point:ON ACTION controlp INFIELD xmjb002
            {<point name="construct.c.page4.xmjb002" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmjb002
            #add-point:BEFORE FIELD xmjb002
            {<point name="construct.b.page4.xmjb002" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmjb002
            
            #add-point:AFTER FIELD xmjb002
            {<point name="construct.a.page4.xmjb002" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.xmjb003
         ON ACTION controlp INFIELD xmjb003
            #add-point:ON ACTION controlp INFIELD xmjb003
            {<point name="construct.c.page4.xmjb003" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmjb003
            #add-point:BEFORE FIELD xmjb003
            {<point name="construct.b.page4.xmjb003" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmjb003
            
            #add-point:AFTER FIELD xmjb003
            {<point name="construct.a.page4.xmjb003" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.xmjb033
         ON ACTION controlp INFIELD xmjb033
            #add-point:ON ACTION controlp INFIELD xmjb033
            {<point name="construct.c.page4.xmjb033" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmjb033
            #add-point:BEFORE FIELD xmjb033
            {<point name="construct.b.page4.xmjb033" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmjb033
            
            #add-point:AFTER FIELD xmjb033
            {<point name="construct.a.page4.xmjb033" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.xmjb004
         ON ACTION controlp INFIELD xmjb004
            #add-point:ON ACTION controlp INFIELD xmjb004
            {<point name="construct.c.page4.xmjb004" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmjb004
            #add-point:BEFORE FIELD xmjb004
            {<point name="construct.b.page4.xmjb004" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmjb004
            
            #add-point:AFTER FIELD xmjb004
            {<point name="construct.a.page4.xmjb004" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.xmjb005
         ON ACTION controlp INFIELD xmjb005
            #add-point:ON ACTION controlp INFIELD xmjb005
            {<point name="construct.c.page4.xmjb005" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmjb005
            #add-point:BEFORE FIELD xmjb005
            {<point name="construct.b.page4.xmjb005" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmjb005
            
            #add-point:AFTER FIELD xmjb005
            {<point name="construct.a.page4.xmjb005" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.xmjb006
         ON ACTION controlp INFIELD xmjb006
            #add-point:ON ACTION controlp INFIELD xmjb006
            {<point name="construct.c.page4.xmjb006" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmjb006
            #add-point:BEFORE FIELD xmjb006
            {<point name="construct.b.page4.xmjb006" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmjb006
            
            #add-point:AFTER FIELD xmjb006
            {<point name="construct.a.page4.xmjb006" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmjb006_desc
            #add-point:BEFORE FIELD xmjb006_desc
            {<point name="construct.b.page4.xmjb006_desc" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmjb006_desc
            
            #add-point:AFTER FIELD xmjb006_desc
            {<point name="construct.a.page4.xmjb006_desc" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.xmjb006_desc
         ON ACTION controlp INFIELD xmjb006_desc
            #add-point:ON ACTION controlp INFIELD xmjb006_desc
            {<point name="construct.c.page4.xmjb006_desc" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmjb007
            #add-point:BEFORE FIELD xmjb007
            {<point name="construct.b.page4.xmjb007" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmjb007
            
            #add-point:AFTER FIELD xmjb007
            {<point name="construct.a.page4.xmjb007" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.xmjb007
         ON ACTION controlp INFIELD xmjb007
            #add-point:ON ACTION controlp INFIELD xmjb007
            {<point name="construct.c.page4.xmjb007" />}
            #END add-point
 
         #Ctrlp:construct.c.page4.xmjb011
         ON ACTION controlp INFIELD xmjb011
            #add-point:ON ACTION controlp INFIELD xmjb011
            {<point name="construct.c.page4.xmjb011" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmjb011
            #add-point:BEFORE FIELD xmjb011
            {<point name="construct.b.page4.xmjb011" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmjb011
            
            #add-point:AFTER FIELD xmjb011
            {<point name="construct.a.page4.xmjb011" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmjb012
            #add-point:BEFORE FIELD xmjb012
            {<point name="construct.b.page4.xmjb012" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmjb012
            
            #add-point:AFTER FIELD xmjb012
            {<point name="construct.a.page4.xmjb012" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.xmjb012
         ON ACTION controlp INFIELD xmjb012
            #add-point:ON ACTION controlp INFIELD xmjb012
            {<point name="construct.c.page4.xmjb012" />}
            #END add-point
 
         #Ctrlp:construct.c.page4.xmjb013
         ON ACTION controlp INFIELD xmjb013
            #add-point:ON ACTION controlp INFIELD xmjb013
            {<point name="construct.c.page4.xmjb013" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmjb013
            #add-point:BEFORE FIELD xmjb013
            {<point name="construct.b.page4.xmjb013" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmjb013
            
            #add-point:AFTER FIELD xmjb013
            {<point name="construct.a.page4.xmjb013" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmjb014
            #add-point:BEFORE FIELD xmjb014
            {<point name="construct.b.page4.xmjb014" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmjb014
            
            #add-point:AFTER FIELD xmjb014
            {<point name="construct.a.page4.xmjb014" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.xmjb014
         ON ACTION controlp INFIELD xmjb014
            #add-point:ON ACTION controlp INFIELD xmjb014
            {<point name="construct.c.page4.xmjb014" />}
            #END add-point
 
         #Ctrlp:construct.c.page4.xmjb015
         ON ACTION controlp INFIELD xmjb015
            #add-point:ON ACTION controlp INFIELD xmjb015
            {<point name="construct.c.page4.xmjb015" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmjb015
            #add-point:BEFORE FIELD xmjb015
            {<point name="construct.b.page4.xmjb015" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmjb015
            
            #add-point:AFTER FIELD xmjb015
            {<point name="construct.a.page4.xmjb015" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmjb016
            #add-point:BEFORE FIELD xmjb016
            {<point name="construct.b.page4.xmjb016" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmjb016
            
            #add-point:AFTER FIELD xmjb016
            {<point name="construct.a.page4.xmjb016" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.xmjb016
         ON ACTION controlp INFIELD xmjb016
            #add-point:ON ACTION controlp INFIELD xmjb016
            {<point name="construct.c.page4.xmjb016" />}
            #END add-point
 
         #Ctrlp:construct.c.page4.xmjb017
         ON ACTION controlp INFIELD xmjb017
            #add-point:ON ACTION controlp INFIELD xmjb017
            {<point name="construct.c.page4.xmjb017" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmjb017
            #add-point:BEFORE FIELD xmjb017
            {<point name="construct.b.page4.xmjb017" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmjb017
            
            #add-point:AFTER FIELD xmjb017
            {<point name="construct.a.page4.xmjb017" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmjb018
            #add-point:BEFORE FIELD xmjb018
            {<point name="construct.b.page4.xmjb018" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmjb018
            
            #add-point:AFTER FIELD xmjb018
            {<point name="construct.a.page4.xmjb018" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.xmjb018
         ON ACTION controlp INFIELD xmjb018
            #add-point:ON ACTION controlp INFIELD xmjb018
            {<point name="construct.c.page4.xmjb018" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmjb008
            #add-point:BEFORE FIELD xmjb008
            {<point name="construct.b.page4.xmjb008" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmjb008
            
            #add-point:AFTER FIELD xmjb008
            {<point name="construct.a.page4.xmjb008" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.xmjb008
         ON ACTION controlp INFIELD xmjb008
            #add-point:ON ACTION controlp INFIELD xmjb008
            {<point name="construct.c.page4.xmjb008" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmjb009
            #add-point:BEFORE FIELD xmjb009
            {<point name="construct.b.page4.xmjb009" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmjb009
            
            #add-point:AFTER FIELD xmjb009
            {<point name="construct.a.page4.xmjb009" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.xmjb009
         ON ACTION controlp INFIELD xmjb009
            #add-point:ON ACTION controlp INFIELD xmjb009
            {<point name="construct.c.page4.xmjb009" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmjb010
            #add-point:BEFORE FIELD xmjb010
            {<point name="construct.b.page4.xmjb010" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmjb010
            
            #add-point:AFTER FIELD xmjb010
            {<point name="construct.a.page4.xmjb010" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.xmjb010
         ON ACTION controlp INFIELD xmjb010
            #add-point:ON ACTION controlp INFIELD xmjb010
            {<point name="construct.c.page4.xmjb010" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmjb022
            #add-point:BEFORE FIELD xmjb022
            {<point name="construct.b.page4.xmjb022" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmjb022
            
            #add-point:AFTER FIELD xmjb022
            {<point name="construct.a.page4.xmjb022" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.xmjb022
         ON ACTION controlp INFIELD xmjb022
            #add-point:ON ACTION controlp INFIELD xmjb022
            {<point name="construct.c.page4.xmjb022" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmjb019
            #add-point:BEFORE FIELD xmjb019
            {<point name="construct.b.page4.xmjb019" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmjb019
            
            #add-point:AFTER FIELD xmjb019
            {<point name="construct.a.page4.xmjb019" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.xmjb019
         ON ACTION controlp INFIELD xmjb019
            #add-point:ON ACTION controlp INFIELD xmjb019
            {<point name="construct.c.page4.xmjb019" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmjb020
            #add-point:BEFORE FIELD xmjb020
            {<point name="construct.b.page4.xmjb020" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmjb020
            
            #add-point:AFTER FIELD xmjb020
            {<point name="construct.a.page4.xmjb020" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.xmjb020
         ON ACTION controlp INFIELD xmjb020
            #add-point:ON ACTION controlp INFIELD xmjb020
            {<point name="construct.c.page4.xmjb020" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmjb021
            #add-point:BEFORE FIELD xmjb021
            {<point name="construct.b.page4.xmjb021" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmjb021
            
            #add-point:AFTER FIELD xmjb021
            {<point name="construct.a.page4.xmjb021" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.xmjb021
         ON ACTION controlp INFIELD xmjb021
            #add-point:ON ACTION controlp INFIELD xmjb021
            {<point name="construct.c.page4.xmjb021" />}
            #END add-point
 
         #Ctrlp:construct.c.page4.xmjb024
         ON ACTION controlp INFIELD xmjb024
            #add-point:ON ACTION controlp INFIELD xmjb024
            {<point name="construct.c.page4.xmjb024" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmjb024
            #add-point:BEFORE FIELD xmjb024
            {<point name="construct.b.page4.xmjb024" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmjb024
            
            #add-point:AFTER FIELD xmjb024
            {<point name="construct.a.page4.xmjb024" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmjb025
            #add-point:BEFORE FIELD xmjb025
            {<point name="construct.b.page4.xmjb025" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmjb025
            
            #add-point:AFTER FIELD xmjb025
            {<point name="construct.a.page4.xmjb025" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.xmjb025
         ON ACTION controlp INFIELD xmjb025
            #add-point:ON ACTION controlp INFIELD xmjb025
            {<point name="construct.c.page4.xmjb025" />}
            #END add-point
 
         #Ctrlp:construct.c.page4.xmjb026
         ON ACTION controlp INFIELD xmjb026
            #add-point:ON ACTION controlp INFIELD xmjb026
            {<point name="construct.c.page4.xmjb026" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmjb026
            #add-point:BEFORE FIELD xmjb026
            {<point name="construct.b.page4.xmjb026" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmjb026
            
            #add-point:AFTER FIELD xmjb026
            {<point name="construct.a.page4.xmjb026" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.xmjb027
         ON ACTION controlp INFIELD xmjb027
            #add-point:ON ACTION controlp INFIELD xmjb027
            {<point name="construct.c.page4.xmjb027" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmjb027
            #add-point:BEFORE FIELD xmjb027
            {<point name="construct.b.page4.xmjb027" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmjb027
            
            #add-point:AFTER FIELD xmjb027
            {<point name="construct.a.page4.xmjb027" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.xmjb028
         ON ACTION controlp INFIELD xmjb028
            #add-point:ON ACTION controlp INFIELD xmjb028
            {<point name="construct.c.page4.xmjb028" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmjb028
            #add-point:BEFORE FIELD xmjb028
            {<point name="construct.b.page4.xmjb028" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmjb028
            
            #add-point:AFTER FIELD xmjb028
            {<point name="construct.a.page4.xmjb028" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmjb029
            #add-point:BEFORE FIELD xmjb029
            {<point name="construct.b.page4.xmjb029" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmjb029
            
            #add-point:AFTER FIELD xmjb029
            {<point name="construct.a.page4.xmjb029" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.xmjb029
         ON ACTION controlp INFIELD xmjb029
            #add-point:ON ACTION controlp INFIELD xmjb029
            {<point name="construct.c.page4.xmjb029" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmjb030
            #add-point:BEFORE FIELD xmjb030
            {<point name="construct.b.page4.xmjb030" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmjb030
            
            #add-point:AFTER FIELD xmjb030
            {<point name="construct.a.page4.xmjb030" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.xmjb030
         ON ACTION controlp INFIELD xmjb030
            #add-point:ON ACTION controlp INFIELD xmjb030
            {<point name="construct.c.page4.xmjb030" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmjb031
            #add-point:BEFORE FIELD xmjb031
            {<point name="construct.b.page4.xmjb031" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmjb031
            
            #add-point:AFTER FIELD xmjb031
            {<point name="construct.a.page4.xmjb031" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.xmjb031
         ON ACTION controlp INFIELD xmjb031
            #add-point:ON ACTION controlp INFIELD xmjb031
            {<point name="construct.c.page4.xmjb031" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmjb032
            #add-point:BEFORE FIELD xmjb032
            {<point name="construct.b.page4.xmjb032" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmjb032
            
            #add-point:AFTER FIELD xmjb032
            {<point name="construct.a.page4.xmjb032" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.xmjb032
         ON ACTION controlp INFIELD xmjb032
            #add-point:ON ACTION controlp INFIELD xmjb032
            {<point name="construct.c.page4.xmjb032" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmjb034
            #add-point:BEFORE FIELD xmjb034
            {<point name="construct.b.page4.xmjb034" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmjb034
            
            #add-point:AFTER FIELD xmjb034
            {<point name="construct.a.page4.xmjb034" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.xmjb034
         ON ACTION controlp INFIELD xmjb034
            #add-point:ON ACTION controlp INFIELD xmjb034
            {<point name="construct.c.page4.xmjb034" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmjb901
            #add-point:BEFORE FIELD xmjb901
            {<point name="construct.b.page4.xmjb901" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmjb901
            
            #add-point:AFTER FIELD xmjb901
            {<point name="construct.a.page4.xmjb901" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.xmjb901
         ON ACTION controlp INFIELD xmjb901
            #add-point:ON ACTION controlp INFIELD xmjb901
            {<point name="construct.c.page4.xmjb901" />}
            #END add-point
 
         #Ctrlp:construct.c.page4.xmjb902
         ON ACTION controlp INFIELD xmjb902
            #add-point:ON ACTION controlp INFIELD xmjb902
            {<point name="construct.c.page4.xmjb902" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmjb902
            #add-point:BEFORE FIELD xmjb902
            {<point name="construct.b.page4.xmjb902" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmjb902
            
            #add-point:AFTER FIELD xmjb902
            {<point name="construct.a.page4.xmjb902" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmjb903
            #add-point:BEFORE FIELD xmjb903
            {<point name="construct.b.page4.xmjb903" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmjb903
            
            #add-point:AFTER FIELD xmjb903
            {<point name="construct.a.page4.xmjb903" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.xmjb903
         ON ACTION controlp INFIELD xmjb903
            #add-point:ON ACTION controlp INFIELD xmjb903
            {<point name="construct.c.page4.xmjb903" />}
            #END add-point
 
   
       
      END CONSTRUCT
 
      CONSTRUCT g_wc2_table4 ON xmefsite,xmef001,xmef002,xmef003,xmef004,xmef005,xmef006,xmef007,xmef008, 
          xmef009,xmef901,xmef902,xmef903
           FROM s_detail5[1].xmefsite,s_detail5[1].xmef001,s_detail5[1].xmef002,s_detail5[1].xmef003, 
               s_detail5[1].xmef004,s_detail5[1].xmef005,s_detail5[1].xmef006,s_detail5[1].xmef007,s_detail5[1].xmef008, 
               s_detail5[1].xmef009,s_detail5[1].xmef901,s_detail5[1].xmef902,s_detail5[1].xmef903
                      
         BEFORE CONSTRUCT
            #add-point:cs段before_construct
            {<point name="cs.body4.before_construct"/>}
            #end add-point 
            
       #單身公用欄位開窗相關處理(table 4)
       
       
       #單身一般欄位開窗相關處理       
                #此段落由子樣板a01產生
         BEFORE FIELD xmefsite
            #add-point:BEFORE FIELD xmefsite
            {<point name="construct.b.page5.xmefsite" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmefsite
            
            #add-point:AFTER FIELD xmefsite
            {<point name="construct.a.page5.xmefsite" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page5.xmefsite
         ON ACTION controlp INFIELD xmefsite
            #add-point:ON ACTION controlp INFIELD xmefsite
            {<point name="construct.c.page5.xmefsite" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmef001
            #add-point:BEFORE FIELD xmef001
            {<point name="construct.b.page5.xmef001" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmef001
            
            #add-point:AFTER FIELD xmef001
            {<point name="construct.a.page5.xmef001" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page5.xmef001
         ON ACTION controlp INFIELD xmef001
            #add-point:ON ACTION controlp INFIELD xmef001
            {<point name="construct.c.page5.xmef001" />}
            #END add-point
 
         #Ctrlp:construct.c.page5.xmef002
         ON ACTION controlp INFIELD xmef002
            #add-point:ON ACTION controlp INFIELD xmef002
            {<point name="construct.c.page5.xmef002" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmef002
            #add-point:BEFORE FIELD xmef002
            {<point name="construct.b.page5.xmef002" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmef002
            
            #add-point:AFTER FIELD xmef002
            {<point name="construct.a.page5.xmef002" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmef003
            #add-point:BEFORE FIELD xmef003
            {<point name="construct.b.page5.xmef003" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmef003
            
            #add-point:AFTER FIELD xmef003
            {<point name="construct.a.page5.xmef003" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page5.xmef003
         ON ACTION controlp INFIELD xmef003
            #add-point:ON ACTION controlp INFIELD xmef003
            {<point name="construct.c.page5.xmef003" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmef004
            #add-point:BEFORE FIELD xmef004
            {<point name="construct.b.page5.xmef004" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmef004
            
            #add-point:AFTER FIELD xmef004
            {<point name="construct.a.page5.xmef004" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page5.xmef004
         ON ACTION controlp INFIELD xmef004
            #add-point:ON ACTION controlp INFIELD xmef004
            {<point name="construct.c.page5.xmef004" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmef005
            #add-point:BEFORE FIELD xmef005
            {<point name="construct.b.page5.xmef005" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmef005
            
            #add-point:AFTER FIELD xmef005
            {<point name="construct.a.page5.xmef005" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page5.xmef005
         ON ACTION controlp INFIELD xmef005
            #add-point:ON ACTION controlp INFIELD xmef005
            {<point name="construct.c.page5.xmef005" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmef006
            #add-point:BEFORE FIELD xmef006
            {<point name="construct.b.page5.xmef006" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmef006
            
            #add-point:AFTER FIELD xmef006
            {<point name="construct.a.page5.xmef006" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page5.xmef006
         ON ACTION controlp INFIELD xmef006
            #add-point:ON ACTION controlp INFIELD xmef006
            {<point name="construct.c.page5.xmef006" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmef007
            #add-point:BEFORE FIELD xmef007
            {<point name="construct.b.page5.xmef007" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmef007
            
            #add-point:AFTER FIELD xmef007
            {<point name="construct.a.page5.xmef007" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page5.xmef007
         ON ACTION controlp INFIELD xmef007
            #add-point:ON ACTION controlp INFIELD xmef007
            {<point name="construct.c.page5.xmef007" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmef008
            #add-point:BEFORE FIELD xmef008
            {<point name="construct.b.page5.xmef008" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmef008
            
            #add-point:AFTER FIELD xmef008
            {<point name="construct.a.page5.xmef008" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page5.xmef008
         ON ACTION controlp INFIELD xmef008
            #add-point:ON ACTION controlp INFIELD xmef008
            {<point name="construct.c.page5.xmef008" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmef009
            #add-point:BEFORE FIELD xmef009
            {<point name="construct.b.page5.xmef009" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmef009
            
            #add-point:AFTER FIELD xmef009
            {<point name="construct.a.page5.xmef009" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page5.xmef009
         ON ACTION controlp INFIELD xmef009
            #add-point:ON ACTION controlp INFIELD xmef009
            {<point name="construct.c.page5.xmef009" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmef901
            #add-point:BEFORE FIELD xmef901
            {<point name="construct.b.page5.xmef901" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmef901
            
            #add-point:AFTER FIELD xmef901
            {<point name="construct.a.page5.xmef901" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page5.xmef901
         ON ACTION controlp INFIELD xmef901
            #add-point:ON ACTION controlp INFIELD xmef901
            {<point name="construct.c.page5.xmef901" />}
            #END add-point
 
         #Ctrlp:construct.c.page5.xmef902
         ON ACTION controlp INFIELD xmef902
            #add-point:ON ACTION controlp INFIELD xmef902
            {<point name="construct.c.page5.xmef902" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmef902
            #add-point:BEFORE FIELD xmef902
            {<point name="construct.b.page5.xmef902" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmef902
            
            #add-point:AFTER FIELD xmef902
            {<point name="construct.a.page5.xmef902" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmef903
            #add-point:BEFORE FIELD xmef903
            {<point name="construct.b.page5.xmef903" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmef903
            
            #add-point:AFTER FIELD xmef903
            {<point name="construct.a.page5.xmef903" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page5.xmef903
         ON ACTION controlp INFIELD xmef903
            #add-point:ON ACTION controlp INFIELD xmef903
            {<point name="construct.c.page5.xmef903" />}
            #END add-point
 
   
       
      END CONSTRUCT
 
 
      
 
      
      #add-point:cs段add_cs(本段內只能出現新的CONSTRUCT指令)
      {<point name="cs.add_cs"/>}
      #end add-point
 
      BEFORE DIALOG
         CALL cl_qbe_init()
         #add-point:cs段b_dialog
         {<point name="cs.b_dialog"/>}
         #end add-point  
 
      #查詢方案列表
      ON ACTION qbe_select
         LET ls_wc = ""
         CALL cl_qbe_list("c") RETURNING ls_wc
    
      #條件儲存為方案
      ON ACTION qbe_save
         CALL cl_qbe_save()
 
      ON ACTION accept
         ACCEPT DIALOG
 
      ON ACTION cancel
         LET INT_FLAG = 1
         EXIT DIALOG 
 
      #交談指令共用ACTION
      &include "common_action.4gl" 
         CONTINUE DIALOG
   END DIALOG
   
   #組合g_wc2
   LET g_wc2 = g_wc2_table1
   IF g_wc2_table2 <> " 1=1" THEN
      LET g_wc2 = g_wc2 ," AND ", g_wc2_table2
   END IF
 
   IF g_wc2_table3 <> " 1=1" THEN
      LET g_wc2 = g_wc2 ," AND ", g_wc2_table3
   END IF
 
   IF g_wc2_table4 <> " 1=1" THEN
      LET g_wc2 = g_wc2 ," AND ", g_wc2_table4
   END IF
 
 
 
 
   
   #add-point:cs段結束前
   {<point name="cs.after_construct"/>}
   #end add-point    
 
   IF INT_FLAG THEN
      RETURN
   END IF
 
END FUNCTION
]]>
</section>
  <section id="adbt510.default_search" ver="5" status="" src="s">
<![CDATA[#+ 外部參數搜尋
PRIVATE FUNCTION adbt510_default_search()
   DEFINE li_idx  LIKE type_t.num5
   DEFINE li_cnt  LIKE type_t.num5
   DEFINE ls_wc   STRING
   #add-point:default_search段define
   {<point name="default_search.define"/>}
   #end add-point  
   
   #add-point:default_search段開始前
   {<point name="default_search.before"/>}
   #end add-point  
   
   LET g_pagestart = 1
   
   IF cl_null(g_order) THEN
      LET g_order = "ASC"
   END IF
   
   IF NOT cl_null(g_argv[01]) THEN
      LET ls_wc = ls_wc, " xmeedocno = '", g_argv[01], "' AND "
   END IF
   
   IF NOT cl_null(g_argv[02]) THEN
      LET ls_wc = ls_wc, " xmee900 = '", g_argv[02], "' AND "
   END IF
 
   
   IF NOT cl_null(ls_wc) THEN
      LET g_wc = ls_wc.subString(1,ls_wc.getLength()-5)
      LET g_default = TRUE
   ELSE
      LET g_default = FALSE
      #預設查詢條件
      LET g_wc = cl_qbe_get_default_qryplan()
      IF cl_null(g_wc) THEN
         LET g_wc = " 1=1"
      END IF
   END IF
   
   #add-point:default_search段結束前
   {<point name="default_search.after"/>}
   #end add-point  
 
END FUNCTION
]]>
</section>
  <section id="adbt510.delete" ver="59" status="" src="s">
<![CDATA[#+ 資料刪除
PRIVATE FUNCTION adbt510_delete()
   DEFINE  l_var_keys      DYNAMIC ARRAY OF STRING
   DEFINE  l_field_keys    DYNAMIC ARRAY OF STRING
   DEFINE  l_vars          DYNAMIC ARRAY OF STRING
   DEFINE  l_fields        DYNAMIC ARRAY OF STRING
   DEFINE  l_var_keys_bak  DYNAMIC ARRAY OF STRING
   #add-point:delete段define
   {<point name="delete.define"/>}
   #end add-point     
   
   IF g_xmee_m.xmeedocno IS NULL
   OR g_xmee_m.xmee900 IS NULL
 
   THEN
      CALL cl_err("","std-00003",0)
      RETURN
   END IF
   
   
 
   CALL adbt510_show()
   
   CALL s_transaction_begin()
 
   OPEN adbt510_cl USING g_enterprise,g_xmee_m.xmeedocno,g_xmee_m.xmee900
   IF STATUS THEN
      CALL cl_err("OPEN adbt510_cl:", STATUS, 1)
      CLOSE adbt510_cl
      CALL s_transaction_end('N','0')
      RETURN
   END IF
 
   #顯示最新的資料
   EXECUTE adbt510_master_referesh USING g_xmee_m.xmeedocno,g_xmee_m.xmee900 INTO g_xmee_m.xmeesite, 
       g_xmee_m.xmee902,g_xmee_m.xmeedocno,g_xmee_m.xmee900,g_xmee_m.xmee901,g_xmee_m.xmee001,g_xmee_m.xmee202, 
       g_xmee_m.xmee023,g_xmee_m.xmee004,g_xmee_m.xmee200,g_xmee_m.xmee201,g_xmee_m.xmeestus,g_xmee_m.xmee005, 
       g_xmee_m.xmee007,g_xmee_m.xmee008,g_xmee_m.xmeedocdt,g_xmee_m.xmee024,g_xmee_m.xmeeacti,g_xmee_m.xmee021, 
       g_xmee_m.xmee022,g_xmee_m.xmee203,g_xmee_m.xmee027,g_xmee_m.xmee002,g_xmee_m.xmee003,g_xmee_m.xmeeunit, 
       g_xmee_m.xmee204,g_xmee_m.xmee205,g_xmee_m.xmee032,g_xmee_m.xmee071,g_xmee_m.xmee903,g_xmee_m.xmee904, 
       g_xmee_m.xmee025,g_xmee_m.xmee026,g_xmee_m.xmee206,g_xmee_m.xmee207,g_xmee_m.xmee020,g_xmee_m.xmee036, 
       g_xmee_m.xmee009,g_xmee_m.xmee010,g_xmee_m.xmee015,g_xmee_m.xmee016,g_xmee_m.xmee011,g_xmee_m.xmee012, 
       g_xmee_m.xmee013,g_xmee_m.xmee035,g_xmee_m.xmee039,g_xmee_m.xmeeownid,g_xmee_m.xmeeowndp,g_xmee_m.xmeecrtid, 
       g_xmee_m.xmeecrtdp,g_xmee_m.xmeecrtdt,g_xmee_m.xmeemodid,g_xmee_m.xmeemoddt,g_xmee_m.xmeecnfid, 
       g_xmee_m.xmeecnfdt,g_xmee_m.xmee034,g_xmee_m.xmee006,g_xmee_m.xmee017,g_xmee_m.xmee041,g_xmee_m.xmee018, 
       g_xmee_m.xmee042,g_xmee_m.xmee019,g_xmee_m.xmee043,g_xmee_m.xmee028,g_xmee_m.xmeesite_desc,g_xmee_m.xmee202_desc, 
       g_xmee_m.xmee023_desc,g_xmee_m.xmee004_desc,g_xmee_m.xmee200_desc,g_xmee_m.xmee201_desc,g_xmee_m.xmee024_desc, 
       g_xmee_m.xmee021_desc,g_xmee_m.xmee022_desc,g_xmee_m.xmee203_desc,g_xmee_m.xmee027_desc,g_xmee_m.xmee002_desc, 
       g_xmee_m.xmee003_desc,g_xmee_m.xmeeunit_desc,g_xmee_m.xmee204_desc,g_xmee_m.xmee032_desc,g_xmee_m.xmee903_desc, 
       g_xmee_m.xmee206_desc,g_xmee_m.xmee207_desc,g_xmee_m.xmee020_desc,g_xmee_m.xmee036_desc,g_xmee_m.xmee009_desc, 
       g_xmee_m.xmee010_desc,g_xmee_m.xmee015_desc,g_xmee_m.xmeeownid_desc,g_xmee_m.xmeeowndp_desc,g_xmee_m.xmeecrtid_desc, 
       g_xmee_m.xmeecrtdp_desc,g_xmee_m.xmeemodid_desc,g_xmee_m.xmeecnfid_desc,g_xmee_m.xmee034_desc, 
       g_xmee_m.xmee017_desc,g_xmee_m.xmee018_desc
 
   IF SQLCA.sqlcode THEN
      CALL cl_err(g_xmee_m.xmeedocno,SQLCA.sqlcode,0)          #資料被他人LOCK
      CALL s_transaction_end('N','0')
      RETURN
   END IF
   
   #add-point:delete段before ask
   {<point name="delete.before_ask"/>}
   #end add-point 
 
   IF cl_ask_del_master() THEN              #確認一下
   
      #add-point:單頭刪除前
      {<point name="delete.head.b_delete" mark="Y"/>}
      #end add-point   
      
      #+ 此段落由子樣板a47產生
      #刪除相關文件
      CALL adbt510_set_pk_array()
      #add-point:相關文件刪除前
      {<point name="delete.befroe.related_document_remove"/>}
      #end add-point   
      CALL cl_doc_remove()  
 
  
  
      #資料備份
      LET g_xmeedocno_t = g_xmee_m.xmeedocno
      LET g_xmee900_t = g_xmee_m.xmee900
 
 
      DELETE FROM xmee_t
       WHERE xmeeent = g_enterprise AND xmeedocno = g_xmee_m.xmeedocno
         AND xmee900 = g_xmee_m.xmee900
 
       
      #add-point:單頭刪除中
      {<point name="delete.head.m_delete"/>}
      #end add-point
       
      IF SQLCA.sqlcode THEN
         CALL cl_err(g_xmee_m.xmeedocno,SQLCA.sqlcode,0) 
         CALL s_transaction_end('N','0')
         RETURN
      END IF
      
      #add-point:單頭刪除後
      {<point name="delete.head.a_delete"/>}
      #end add-point
  
      #add-point:單身刪除前
      {<point name="delete.body.b_delete" mark="Y"/>}
      #end add-point
      
      DELETE FROM xmeg_t
       WHERE xmegent = g_enterprise AND xmegdocno = g_xmee_m.xmeedocno
         AND xmeg900 = g_xmee_m.xmee900
 
 
      #add-point:單身刪除中
      {<point name="delete.body.m_delete"/>}
      #end add-point
         
      IF SQLCA.sqlcode THEN
         CALL cl_err("xmeg_t",SQLCA.sqlcode,0) 
         CALL s_transaction_end('N','0')
         RETURN
      END IF    
 
      #add-point:單身刪除後
      {<point name="delete.body.a_delete"/>}
      #end add-point
      
            
                                                               
      #add-point:單身刪除前
      {<point name="delete.body.b_delete2" mark="Y"/>}
      #end add-point
      DELETE FROM xmeh_t
       WHERE xmehent = g_enterprise AND
             xmehdocno = g_xmee_m.xmeedocno AND xmeh900 = g_xmee_m.xmee900
      #add-point:單身刪除中
      {<point name="delete.body.m_delete2"/>}
      #end add-point
      IF SQLCA.sqlcode THEN
         CALL cl_err("xmeh_t",SQLCA.sqlcode,0) 
         CALL s_transaction_end('N','0')
         RETURN
      END IF      
 
      #add-point:單身刪除後
      {<point name="delete.body.a_delete2"/>}
      #end add-point
 
      #add-point:單身刪除前
      {<point name="delete.body.b_delete3" mark="Y"/>}
      #end add-point
      DELETE FROM xmjb_t
       WHERE xmjbent = g_enterprise AND
             xmjbdocno = g_xmee_m.xmeedocno AND xmjb900 = g_xmee_m.xmee900
      #add-point:單身刪除中
      {<point name="delete.body.m_delete3"/>}
      #end add-point
      IF SQLCA.sqlcode THEN
         CALL cl_err("xmjb_t",SQLCA.sqlcode,0) 
         CALL s_transaction_end('N','0')
         RETURN
      END IF      
 
      #add-point:單身刪除後
      {<point name="delete.body.a_delete3"/>}
      #end add-point
 
      #add-point:單身刪除前
      {<point name="delete.body.b_delete4" mark="Y"/>}
      #end add-point
      DELETE FROM xmef_t
       WHERE xmefent = g_enterprise AND
             xmefdocno = g_xmee_m.xmeedocno AND xmef900 = g_xmee_m.xmee900
      #add-point:單身刪除中
      {<point name="delete.body.m_delete4"/>}
      #end add-point
      IF SQLCA.sqlcode THEN
         CALL cl_err("xmef_t",SQLCA.sqlcode,0) 
         CALL s_transaction_end('N','0')
         RETURN
      END IF      
 
      #add-point:單身刪除後
      {<point name="delete.body.a_delete4"/>}
      #end add-point
 
 
 
 
                                                               
      CLEAR FORM
      CALL g_xmeg_d.clear() 
      CALL g_xmeg3_d.clear()       
      CALL g_xmeg4_d.clear()       
      CALL g_xmeg5_d.clear()       
 
     
      #CALL adbt510_ui_browser_refresh()  
      CALL adbt510_ui_headershow()  
      CALL adbt510_ui_detailshow()
       
      IF g_browser_cnt > 0 THEN 
         CALL adbt510_browser_fill("")
         CALL adbt510_fetch('P')
         DISPLAY g_browser_cnt TO FORMONLY.h_count   #總筆數的顯示
      ELSE
         LET g_wc = " 1=1"
         CALL adbt510_browser_fill("F")
      END IF
      
      #單頭多語言刪除
      
      
      #單身多語言刪除
      
      
 
      
 
      
 
 
 
   
      #add-point:多語言刪除
      {<point name="delete.lang.delete"/>}
      #end add-point
   
   END IF
 
   CALL s_transaction_end('Y','0')
   
   CLOSE adbt510_cl
 
   #流程通知預埋點-D
   CALL cl_flow_notify(g_xmee_m.xmeedocno,'D')
    
END FUNCTION
]]>
</section>
  <section id="adbt510.delete_b" ver="16" status="" src="s">
<![CDATA[#+ 刪除單身後其他table連動
PRIVATE FUNCTION adbt510_delete_b(ps_table,ps_keys_bak,ps_page)
   DEFINE ps_table    STRING
   DEFINE ps_page     STRING
   DEFINE ps_keys_bak DYNAMIC ARRAY OF VARCHAR(500)
   DEFINE ls_group    STRING
   #add-point:delete_b段define
   {<point name="delete_b.define"/>}
   #end add-point     
 
   #判斷是否是同一群組的table
   LET ls_group = "'1',"
   IF ls_group.getIndexOf(ps_page,1) > 0 THEN
      #add-point:delete_b段刪除前
      {<point name="delete_b.b_delete" mark="Y"/>}
      #end add-point    
      DELETE FROM xmeg_t
       WHERE xmegent = g_enterprise AND
         xmegdocno = ps_keys_bak[1] AND xmeg900 = ps_keys_bak[2] AND xmegseq = ps_keys_bak[3]
      #add-point:delete_b段刪除中
      {<point name="delete_b.m_delete"/>}
      #end add-point    
      IF SQLCA.sqlcode THEN
         CALL cl_err("",SQLCA.sqlcode,0)
      END IF
      #add-point:delete_b段刪除後
      {<point name="delete_b.a_delete"/>}
      #end add-point   
   END IF
   
   LET ls_group = "'2',"
   #判斷是否是同一群組的table
   IF ls_group.getIndexOf(ps_page,1) > 0 THEN
      #add-point:delete_b段刪除前
      {<point name="delete_b.b_delete2" mark="Y"/>}
      #end add-point    
      DELETE FROM xmeh_t
       WHERE xmehent = g_enterprise AND
         xmehdocno = ps_keys_bak[1] AND xmeh900 = ps_keys_bak[2] AND xmehseq = ps_keys_bak[3] AND xmehseq1 = ps_keys_bak[4] AND xmehseq2 = ps_keys_bak[5]
      #add-point:delete_b段刪除中
      {<point name="delete_b.m_delete2"/>}
      #end add-point    
      IF SQLCA.sqlcode THEN
         CALL cl_err("xmeh_t",SQLCA.sqlcode,0)
      END IF
      #add-point:delete_b段刪除後
      {<point name="delete_b.a_delete2"/>}
      #end add-point    
   END IF
 
   LET ls_group = "'3',"
   #判斷是否是同一群組的table
   IF ls_group.getIndexOf(ps_page,1) > 0 THEN
      #add-point:delete_b段刪除前
      {<point name="delete_b.b_delete3" mark="Y"/>}
      #end add-point    
      DELETE FROM xmjb_t
       WHERE xmjbent = g_enterprise AND
         xmjbdocno = ps_keys_bak[1] AND xmjb900 = ps_keys_bak[2] AND xmjbseq = ps_keys_bak[3]
      #add-point:delete_b段刪除中
      {<point name="delete_b.m_delete3"/>}
      #end add-point    
      IF SQLCA.sqlcode THEN
         CALL cl_err("xmjb_t",SQLCA.sqlcode,0)
      END IF
      #add-point:delete_b段刪除後
      {<point name="delete_b.a_delete3"/>}
      #end add-point    
   END IF
 
   LET ls_group = "'4',"
   #判斷是否是同一群組的table
   IF ls_group.getIndexOf(ps_page,1) > 0 THEN
      #add-point:delete_b段刪除前
      {<point name="delete_b.b_delete4" mark="Y"/>}
      #end add-point    
      DELETE FROM xmef_t
       WHERE xmefent = g_enterprise AND
         xmefdocno = ps_keys_bak[1] AND xmef900 = ps_keys_bak[2] AND xmef001 = ps_keys_bak[3]
      #add-point:delete_b段刪除中
      {<point name="delete_b.m_delete4"/>}
      #end add-point    
      IF SQLCA.sqlcode THEN
         CALL cl_err("xmef_t",SQLCA.sqlcode,0)
      END IF
      #add-point:delete_b段刪除後
      {<point name="delete_b.a_delete4"/>}
      #end add-point    
   END IF
 
 
   
 
   
   #add-point:delete_b段other
   {<point name="delete_b.other"/>}
   #end add-point  
   
END FUNCTION
]]>
</section>
  <section id="adbt510.description" ver="1020" status="" src="s">
<![CDATA[#+ Version..: T100-ERP-1.00.00(SD版次:3,PR版次:3) Build-000208
#+ 
#+ Filename...: adbt510
#+ Description: 分銷訂單變更維護作業
#+ Creator....: 02748(2014/06/17)
#+ Modifier...: 02748(2014/07/02)
#+ Buildtype..: 應用 t01 樣板自動產生
#+ 以上段落由子樣板a00產生
]]>
</section>
  <section id="adbt510.detail_reproduce" ver="17" status="" src="s">
<![CDATA[#+ 單身自動複製
PRIVATE FUNCTION adbt510_detail_reproduce()
   DEFINE ls_sql      STRING
   DEFINE ld_date     DATETIME YEAR TO SECOND
   DEFINE l_detail    RECORD LIKE xmeg_t.*
   DEFINE l_detail2    RECORD LIKE xmeh_t.*
 
   DEFINE l_detail3    RECORD LIKE xmjb_t.*
 
   DEFINE l_detail4    RECORD LIKE xmef_t.*
 
 
 
   #add-point:delete段define
   {<point name="detail_reproduce.define"/>}
   #end add-point    
   
   CALL s_transaction_begin()
   
   LET ld_date = cl_get_current()
   
   DROP TABLE adbt510_detail
   
   #add-point:單身複製前1
   {<point name="detail_reproduce.body.table1.b_insert" mark="Y"/>}
   #end add-point
   
   #CREATE TEMP TABLE
   LET ls_sql = "CREATE GLOBAL TEMPORARY TABLE adbt510_detail AS ",
                "SELECT * FROM xmeg_t "
   PREPARE repro_tbl FROM ls_sql
   EXECUTE repro_tbl
   FREE repro_tbl
                
   #將符合條件的資料丟入TEMP TABLE
   INSERT INTO adbt510_detail SELECT * FROM xmeg_t 
                                         WHERE xmegent = g_enterprise AND xmegdocno = g_xmeedocno_t
                                         AND xmeg900 = g_xmee900_t
 
   
   #將key修正為調整後   
   UPDATE adbt510_detail 
      #更新key欄位
      SET xmegdocno = g_xmee_m.xmeedocno
          , xmeg900 = g_xmee_m.xmee900
 
      #更新共用欄位
      
                                       
  
   #將資料塞回原table   
   INSERT INTO xmeg_t SELECT * FROM adbt510_detail
   
   IF SQLCA.sqlcode THEN
      CALL cl_err("reproduce",SQLCA.sqlcode,1)
      RETURN
   END IF
   
   #add-point:單身複製中1
   {<point name="detail_reproduce.body.table1.m_insert"/>}
   #end add-point
   
   #刪除TEMP TABLE
   DROP TABLE adbt510_detail
   
   #add-point:單身複製後1
   {<point name="detail_reproduce.body.table1.a_insert"/>}
   #end add-point
 
   #add-point:單身複製前
   {<point name="detail_reproduce.body.table2.b_insert" mark="Y"/>}
   #end add-point
   
   #CREATE TEMP TABLE
   LET ls_sql = 
      "CREATE GLOBAL TEMPORARY TABLE adbt510_detail AS ",
      "SELECT * FROM xmeh_t "
   PREPARE repro_tbl2 FROM ls_sql
   EXECUTE repro_tbl2
   FREE repro_tbl2
      
   #將符合條件的資料丟入TEMP TABLE
   INSERT INTO adbt510_detail SELECT * FROM xmeh_t
                                         WHERE xmehent = g_enterprise AND xmehdocno = g_xmeedocno_t
                                         AND xmeh900 = g_xmee900_t
 
 
   #將key修正為調整後   
   UPDATE adbt510_detail SET xmehdocno = g_xmee_m.xmeedocno
                                       , xmeh900 = g_xmee_m.xmee900
 
  
   #將資料塞回原table   
   INSERT INTO xmeh_t SELECT * FROM adbt510_detail
   
   #add-point:單身複製中
   {<point name="detail_reproduce.body.table2.m_insert"/>}
   #end add-point
   
   #刪除TEMP TABLE
   DROP TABLE adbt510_detail
   
   #add-point:單身複製後
   {<point name="detail_reproduce.body.table2.a_insert"/>}
   #end add-point
 
   #add-point:單身複製前
   {<point name="detail_reproduce.body.table3.b_insert" mark="Y"/>}
   #end add-point
   
   #CREATE TEMP TABLE
   LET ls_sql = 
      "CREATE GLOBAL TEMPORARY TABLE adbt510_detail AS ",
      "SELECT * FROM xmjb_t "
   PREPARE repro_tbl3 FROM ls_sql
   EXECUTE repro_tbl3
   FREE repro_tbl3
      
   #將符合條件的資料丟入TEMP TABLE
   INSERT INTO adbt510_detail SELECT * FROM xmjb_t
                                         WHERE xmjbent = g_enterprise AND xmjbdocno = g_xmeedocno_t
                                         AND xmjb900 = g_xmee900_t
 
 
   #將key修正為調整後   
   UPDATE adbt510_detail SET xmjbdocno = g_xmee_m.xmeedocno
                                       , xmjb900 = g_xmee_m.xmee900
 
  
   #將資料塞回原table   
   INSERT INTO xmjb_t SELECT * FROM adbt510_detail
   
   #add-point:單身複製中
   {<point name="detail_reproduce.body.table3.m_insert"/>}
   #end add-point
   
   #刪除TEMP TABLE
   DROP TABLE adbt510_detail
   
   #add-point:單身複製後
   {<point name="detail_reproduce.body.table3.a_insert"/>}
   #end add-point
 
   #add-point:單身複製前
   {<point name="detail_reproduce.body.table4.b_insert" mark="Y"/>}
   #end add-point
   
   #CREATE TEMP TABLE
   LET ls_sql = 
      "CREATE GLOBAL TEMPORARY TABLE adbt510_detail AS ",
      "SELECT * FROM xmef_t "
   PREPARE repro_tbl4 FROM ls_sql
   EXECUTE repro_tbl4
   FREE repro_tbl4
      
   #將符合條件的資料丟入TEMP TABLE
   INSERT INTO adbt510_detail SELECT * FROM xmef_t
                                         WHERE xmefent = g_enterprise AND xmefdocno = g_xmeedocno_t
                                         AND xmef900 = g_xmee900_t
 
 
   #將key修正為調整後   
   UPDATE adbt510_detail SET xmefdocno = g_xmee_m.xmeedocno
                                       , xmef900 = g_xmee_m.xmee900
 
  
   #將資料塞回原table   
   INSERT INTO xmef_t SELECT * FROM adbt510_detail
   
   #add-point:單身複製中
   {<point name="detail_reproduce.body.table4.m_insert"/>}
   #end add-point
   
   #刪除TEMP TABLE
   DROP TABLE adbt510_detail
   
   #add-point:單身複製後
   {<point name="detail_reproduce.body.table4.a_insert"/>}
   #end add-point
 
 
   
 
   
   #多語言複製段落
   
   
   CALL s_transaction_end('Y','0')
   
   #已新增完, 調整資料內容(修改時使用)
   LET g_xmeedocno_t = g_xmee_m.xmeedocno
   LET g_xmee900_t = g_xmee_m.xmee900
 
   
   DROP TABLE adbt510_detail
   
END FUNCTION
]]>
</section>
  <section id="adbt510.detail_show" ver="4" status="" src="s">
<![CDATA[#+ 第二階單身reference
PRIVATE FUNCTION adbt510_detail_show()
   #add-point:detail_show段define
   {<point name="detail_show.define"/>}
   #end add-point  
 
   #add-point:detail_show段之前
   {<point name="detail_show.before"/>}
   #end add-point
   
   #add-point:detail_show段之後
   {<point name="detail_show.after"/>}
   #end add-point
   
END FUNCTION
]]>
</section>
  <section id="adbt510.fetch" ver="30" status="" src="s">
<![CDATA[#+ 指定PK後抓取單頭其他資料
PRIVATE FUNCTION adbt510_fetch(p_flag)
   DEFINE p_flag     LIKE type_t.chr1
   DEFINE ls_msg     STRING
   #add-point:fetch段define
   {<point name="fetch.define"/>}
   #end add-point    
   
   IF g_browser_cnt = 0 THEN
      RETURN
   END IF
   
   CASE p_flag
      WHEN 'F' LET g_current_idx = 1
      WHEN 'L' LET g_current_idx = g_header_cnt        
      WHEN 'P'
         IF g_current_idx > 1 THEN               
            LET g_current_idx = g_current_idx - 1
         END IF 
      WHEN 'N'
         IF g_current_idx < g_header_cnt THEN
            LET g_current_idx =  g_current_idx + 1
         END IF        
      WHEN '/'
         IF (NOT g_no_ask) THEN    
            CALL cl_set_act_visible("accept,cancel", TRUE)    
            CALL cl_getmsg('fetch',g_lang) RETURNING ls_msg
            LET INT_FLAG = 0
 
            PROMPT ls_msg CLIPPED,':' FOR g_jump
               #交談指令共用ACTION
               &include "common_action.4gl" 
            END PROMPT
 
            CALL cl_set_act_visible("accept,cancel", FALSE)    
            IF INT_FLAG THEN
                LET INT_FLAG = 0
                EXIT CASE  
            END IF           
         END IF
         
         IF g_jump > 0 AND g_jump <= g_browser.getLength() THEN
             LET g_current_idx = g_jump
         END IF
         
         LET g_no_ask = FALSE  
   END CASE 
   
   
   CALL g_curr_diag.setCurrentRow("s_browse", g_current_idx) #設定browse 索引
   
   LET g_detail_cnt = g_header_cnt                  
   
   #單身總筆數顯示
   #LET g_detail_idx = 1
   IF g_detail_cnt > 0 THEN
      #LET g_detail_idx = 1
      DISPLAY g_detail_idx TO FORMONLY.idx  
   ELSE
      LET g_detail_idx = 0
      DISPLAY ' ' TO FORMONLY.idx    
   END IF
   
   #瀏覽頁筆數顯示
   LET g_browser_idx = g_pagestart+g_current_idx-1
   DISPLAY g_browser_idx TO FORMONLY.b_index   #當下筆數
   DISPLAY g_browser_idx TO FORMONLY.h_index   #當下筆數
   
   CALL cl_navigator_setting( g_current_idx, g_browser_cnt )
   
   #代表沒有資料
   IF g_current_idx = 0 OR g_browser.getLength() = 0 THEN
      RETURN
   END IF
   
   #超出範圍
   IF g_current_idx > g_browser.getLength() THEN
      LET g_current_idx = g_browser.getLength()
   END IF
   
   LET g_xmee_m.xmeedocno = g_browser[g_current_idx].b_xmeedocno
   LET g_xmee_m.xmee900 = g_browser[g_current_idx].b_xmee900
 
   
   #重讀DB,因TEMP有不被更新特性
   EXECUTE adbt510_master_referesh USING g_xmee_m.xmeedocno,g_xmee_m.xmee900 INTO g_xmee_m.xmeesite, 
       g_xmee_m.xmee902,g_xmee_m.xmeedocno,g_xmee_m.xmee900,g_xmee_m.xmee901,g_xmee_m.xmee001,g_xmee_m.xmee202, 
       g_xmee_m.xmee023,g_xmee_m.xmee004,g_xmee_m.xmee200,g_xmee_m.xmee201,g_xmee_m.xmeestus,g_xmee_m.xmee005, 
       g_xmee_m.xmee007,g_xmee_m.xmee008,g_xmee_m.xmeedocdt,g_xmee_m.xmee024,g_xmee_m.xmeeacti,g_xmee_m.xmee021, 
       g_xmee_m.xmee022,g_xmee_m.xmee203,g_xmee_m.xmee027,g_xmee_m.xmee002,g_xmee_m.xmee003,g_xmee_m.xmeeunit, 
       g_xmee_m.xmee204,g_xmee_m.xmee205,g_xmee_m.xmee032,g_xmee_m.xmee071,g_xmee_m.xmee903,g_xmee_m.xmee904, 
       g_xmee_m.xmee025,g_xmee_m.xmee026,g_xmee_m.xmee206,g_xmee_m.xmee207,g_xmee_m.xmee020,g_xmee_m.xmee036, 
       g_xmee_m.xmee009,g_xmee_m.xmee010,g_xmee_m.xmee015,g_xmee_m.xmee016,g_xmee_m.xmee011,g_xmee_m.xmee012, 
       g_xmee_m.xmee013,g_xmee_m.xmee035,g_xmee_m.xmee039,g_xmee_m.xmeeownid,g_xmee_m.xmeeowndp,g_xmee_m.xmeecrtid, 
       g_xmee_m.xmeecrtdp,g_xmee_m.xmeecrtdt,g_xmee_m.xmeemodid,g_xmee_m.xmeemoddt,g_xmee_m.xmeecnfid, 
       g_xmee_m.xmeecnfdt,g_xmee_m.xmee034,g_xmee_m.xmee006,g_xmee_m.xmee017,g_xmee_m.xmee041,g_xmee_m.xmee018, 
       g_xmee_m.xmee042,g_xmee_m.xmee019,g_xmee_m.xmee043,g_xmee_m.xmee028,g_xmee_m.xmeesite_desc,g_xmee_m.xmee202_desc, 
       g_xmee_m.xmee023_desc,g_xmee_m.xmee004_desc,g_xmee_m.xmee200_desc,g_xmee_m.xmee201_desc,g_xmee_m.xmee024_desc, 
       g_xmee_m.xmee021_desc,g_xmee_m.xmee022_desc,g_xmee_m.xmee203_desc,g_xmee_m.xmee027_desc,g_xmee_m.xmee002_desc, 
       g_xmee_m.xmee003_desc,g_xmee_m.xmeeunit_desc,g_xmee_m.xmee204_desc,g_xmee_m.xmee032_desc,g_xmee_m.xmee903_desc, 
       g_xmee_m.xmee206_desc,g_xmee_m.xmee207_desc,g_xmee_m.xmee020_desc,g_xmee_m.xmee036_desc,g_xmee_m.xmee009_desc, 
       g_xmee_m.xmee010_desc,g_xmee_m.xmee015_desc,g_xmee_m.xmeeownid_desc,g_xmee_m.xmeeowndp_desc,g_xmee_m.xmeecrtid_desc, 
       g_xmee_m.xmeecrtdp_desc,g_xmee_m.xmeemodid_desc,g_xmee_m.xmeecnfid_desc,g_xmee_m.xmee034_desc, 
       g_xmee_m.xmee017_desc,g_xmee_m.xmee018_desc
   IF SQLCA.sqlcode THEN
      CALL cl_err("xmee_t",SQLCA.sqlcode,1)
      INITIALIZE g_xmee_m.* TO NULL
      RETURN
   END IF
   
   #add-point:fetch段action控制
   {<point name="fetch.action_control"/>}
   #end add-point  
   
   
   
   #add-point:fetch結束前
   {<point name="fetch.after" />}
   #end add-point
   
   #保存單頭舊值
   LET g_xmee_m_t.* = g_xmee_m.*
   LET g_xmee_m_o.* = g_xmee_m.*
   
   #LET g_data_owner =       
   #LET g_data_group =   
   
   #重新顯示   
   CALL adbt510_show()
 
   #+ 此段落由子樣板a56產生
   #檢查此單據是否需顯示BPM簽核狀況按鈕 
   IF cl_bpm_chk() THEN
      CALL cl_set_act_visible("bpm_status",TRUE)
   ELSE
      CALL cl_set_act_visible("bpm_status",FALSE)
   END IF
 
 
 
END FUNCTION
]]>
</section>
  <section id="adbt510.fill_chk" ver="11" status="" src="s">
<![CDATA[#+ 單身填充確認
PRIVATE FUNCTION adbt510_fill_chk(ps_idx)
   DEFINE ps_idx        LIKE type_t.chr10
   #add-point:fill_chk段define
   {<point name="fill_chk.define"/>}
   #end add-point
   
   #add-point:fill_chk段before_chk
   {<point name="fill_chk.before_chk"/>}
   #end add-point
   
   #全部為1=1 or null時回傳true
   IF (cl_null(g_wc2_table1) OR g_wc2_table1.trim() = '1=1')  AND 
      (cl_null(g_wc2_table2) OR g_wc2_table2.trim() = '1=1')  AND 
      (cl_null(g_wc2_table3) OR g_wc2_table3.trim() = '1=1')  AND 
      (cl_null(g_wc2_table4) OR g_wc2_table4.trim() = '1=1') THEN
      #add-point:fill_chk段other_chk
      {<point name="fill_chk.other_chk"/>}
      #end add-point
      RETURN TRUE
   END IF
   
   #第一單身
   IF ps_idx = 1 AND
      ((NOT cl_null(g_wc2_table1) AND g_wc2_table1.trim() <> '1=1')) THEN
      RETURN TRUE
   END IF
   
   #根據wc判定是否需要填充
   IF ps_idx = 2 AND
      ((NOT cl_null(g_wc2_table2) AND g_wc2_table2.trim() <> '1=1')) THEN
      RETURN TRUE
   END IF
 
   IF ps_idx = 3 AND
      ((NOT cl_null(g_wc2_table3) AND g_wc2_table3.trim() <> '1=1')) THEN
      RETURN TRUE
   END IF
 
   IF ps_idx = 4 AND
      ((NOT cl_null(g_wc2_table4) AND g_wc2_table4.trim() <> '1=1')) THEN
      RETURN TRUE
   END IF
 
 
 
   RETURN FALSE
 
END FUNCTION
]]>
</section>
  <section id="adbt510.filter" ver="9" status="" src="s">
<![CDATA[#+ 此段落由子樣板a50產生
#+ filter過濾功能
PRIVATE FUNCTION adbt510_filter()
   #add-point:filter段define
   {<point name="filter.define"/>}
   #end add-point   
 
   #切換畫面
   IF NOT g_main_hidden THEN
      CALL gfrm_curr.setElementHidden("mainlayout",1)
      CALL gfrm_curr.setElementHidden("worksheet",0)
      LET g_main_hidden = 1
   END IF   
 
   LET INT_FLAG = 0
 
   LET g_qryparam.state = 'c'
 
   LET g_wc_filter_t = g_wc_filter.trim()
   LET g_wc_t = g_wc
 
   LET g_wc = cl_replace_str(g_wc, g_wc_filter_t, '')
 
   #使用DIALOG包住 單頭CONSTRUCT及單身CONSTRUCT
   DIALOG ATTRIBUTES(UNBUFFERED,FIELD ORDER FORM)
 
      #單頭
      CONSTRUCT g_wc_filter ON xmeedocno,xmee900,xmeedocdt,xmee001,xmee002,xmee003,xmee004
                          FROM s_browse[1].b_xmeedocno,s_browse[1].b_xmee900,s_browse[1].b_xmeedocdt, 
                              s_browse[1].b_xmee001,s_browse[1].b_xmee002,s_browse[1].b_xmee003,s_browse[1].b_xmee004 

 
         BEFORE CONSTRUCT
               DISPLAY adbt510_filter_parser('xmeedocno') TO s_browse[1].b_xmeedocno
            DISPLAY adbt510_filter_parser('xmee900') TO s_browse[1].b_xmee900
            DISPLAY adbt510_filter_parser('xmeedocdt') TO s_browse[1].b_xmeedocdt
            DISPLAY adbt510_filter_parser('xmee001') TO s_browse[1].b_xmee001
            DISPLAY adbt510_filter_parser('xmee002') TO s_browse[1].b_xmee002
            DISPLAY adbt510_filter_parser('xmee003') TO s_browse[1].b_xmee003
            DISPLAY adbt510_filter_parser('xmee004') TO s_browse[1].b_xmee004
      
         #add-point:filter段cs_ctrl
         {<point name="filter.cs_ctrl"/>}
         #end add-point
      
      END CONSTRUCT
 
      #add-point:filter段add_cs
      {<point name="filter.add_cs"/>}
      #end add-point
 
      BEFORE DIALOG
         #add-point:filter段b_dialog
         {<point name="filter.b_dialog"/>}
         #end add-point  
      
      ON ACTION accept
         ACCEPT DIALOG
 
      ON ACTION cancel
         LET INT_FLAG = 1
         EXIT DIALOG 
 
      #交談指令共用ACTION
      &include "common_action.4gl" 
         CONTINUE DIALOG
   
   END DIALOG
 
   IF NOT INT_FLAG THEN
      LET g_wc_filter = "   AND   ", g_wc_filter, "   "
      LET g_wc = g_wc , g_wc_filter
   ELSE
      LET g_wc_filter = g_wc_filter_t
      LET g_wc = g_wc_t
   END IF
 
      CALL adbt510_filter_show('xmeedocno')
   CALL adbt510_filter_show('xmee900')
   CALL adbt510_filter_show('xmeedocdt')
   CALL adbt510_filter_show('xmee001')
   CALL adbt510_filter_show('xmee002')
   CALL adbt510_filter_show('xmee003')
   CALL adbt510_filter_show('xmee004')
 
END FUNCTION
]]>
</section>
  <section id="adbt510.filter_parser" ver="2" status="" src="s">
<![CDATA[#+ filter過濾功能
PRIVATE FUNCTION adbt510_filter_parser(ps_field)
   DEFINE ps_field   STRING
   DEFINE ls_tmp     STRING
   DEFINE li_tmp     LIKE type_t.num5
   DEFINE li_tmp2    LIKE type_t.num5
   DEFINE ls_var     STRING
   #add-point:filter段define
   {<point name="filter_parser.define"/>}
   #end add-point    
 
   #一般條件解析
   LET ls_tmp = ps_field, "='"
   LET li_tmp = g_wc_filter.getIndexOf(ls_tmp,1)
   IF li_tmp > 0 THEN
      LET li_tmp = ls_tmp.getLength() + li_tmp
      LET li_tmp2 = g_wc_filter.getIndexOf("'",li_tmp + 1) - 1
      LET ls_var = g_wc_filter.subString(li_tmp,li_tmp2)
   END IF
 
   #模糊條件解析
   LET ls_tmp = ps_field, " like '"
   LET li_tmp = g_wc_filter.getIndexOf(ls_tmp,1)
   IF li_tmp > 0 THEN
      LET li_tmp = ls_tmp.getLength() + li_tmp
      LET li_tmp2 = g_wc_filter.getIndexOf("'",li_tmp + 1) - 1
      LET ls_var = g_wc_filter.subString(li_tmp,li_tmp2)
      LET ls_var = cl_replace_str(ls_var,'%','*')
   END IF
 
   RETURN ls_var
 
END FUNCTION
]]>
</section>
  <section id="adbt510.filter_show" ver="2" status="" src="s">
<![CDATA[#+ 顯示過濾條件
PRIVATE FUNCTION adbt510_filter_show(ps_field)
   DEFINE ps_field         STRING
   DEFINE lnode_item       om.DomNode
   DEFINE ls_title         STRING
   DEFINE ls_name          STRING
   DEFINE ls_condition     STRING
 
   LET ls_name = "formonly.b_", ps_field
   LET lnode_item = gfrm_curr.findNode("TableColumn", ls_name)
   LET ls_title = lnode_item.getAttribute("text")
   IF ls_title.getIndexOf('※',1) > 0 THEN
      LEt ls_title = ls_title.subString(1,ls_title.getIndexOf('※',1)-1)
   END IF
 
   #顯示資料組合
   LET ls_condition = adbt510_filter_parser(ps_field)
   IF NOT cl_null(ls_condition) THEN
      LET ls_title = ls_title, '※', ls_condition, '※'
   END IF
 
   #將資料顯示回去
   CALL lnode_item.setAttribute("text",ls_title)
 
END FUNCTION
]]>
</section>
  <section id="adbt510.global" ver="124" status="" src="s">
<![CDATA[{<point name="global.memo" />}
        
IMPORT os
IMPORT util
IMPORT FGL lib_cl_dlg
#add-point:增加匯入項目
{<point name="global.import" />}
#end add-point
 
SCHEMA ds 
 
GLOBALS "../../cfg/top_global.inc"
 
#add-point:增加匯入變數檔
{<point name="global.inc" />}
#end add-point
 
#單頭 type 宣告
PRIVATE type type_g_xmee_m        RECORD
       xmeesite LIKE xmee_t.xmeesite, 
   xmeesite_desc LIKE type_t.chr80, 
   xmee902 LIKE xmee_t.xmee902, 
   xmeedocno LIKE xmee_t.xmeedocno, 
   xmee900 LIKE xmee_t.xmee900, 
   xmee901 LIKE xmee_t.xmee901, 
   xmee001 LIKE xmee_t.xmee001, 
   xmee202 LIKE xmee_t.xmee202, 
   xmee202_desc LIKE type_t.chr80, 
   xmee023 LIKE xmee_t.xmee023, 
   xmee023_desc LIKE type_t.chr80, 
   xmee004 LIKE xmee_t.xmee004, 
   xmee004_desc LIKE type_t.chr80, 
   xmee200 LIKE xmee_t.xmee200, 
   xmee200_desc LIKE type_t.chr80, 
   xmee201 LIKE xmee_t.xmee201, 
   xmee201_desc LIKE type_t.chr80, 
   xmeestus LIKE xmee_t.xmeestus, 
   xmee005 LIKE xmee_t.xmee005, 
   xmee007 LIKE xmee_t.xmee007, 
   xmee008 LIKE xmee_t.xmee008, 
   xmeedocdt LIKE xmee_t.xmeedocdt, 
   xmee024 LIKE xmee_t.xmee024, 
   xmee024_desc LIKE type_t.chr80, 
   xmeeacti LIKE xmee_t.xmeeacti, 
   xmee021 LIKE xmee_t.xmee021, 
   xmee021_desc LIKE type_t.chr80, 
   xmee022 LIKE xmee_t.xmee022, 
   xmee022_desc LIKE type_t.chr80, 
   xmee203 LIKE xmee_t.xmee203, 
   xmee203_desc LIKE type_t.chr80, 
   xmee027 LIKE xmee_t.xmee027, 
   xmee027_desc LIKE type_t.chr80, 
   xmee002 LIKE xmee_t.xmee002, 
   xmee002_desc LIKE type_t.chr80, 
   xmee003 LIKE xmee_t.xmee003, 
   xmee003_desc LIKE type_t.chr80, 
   xmeeunit LIKE xmee_t.xmeeunit, 
   xmeeunit_desc LIKE type_t.chr80, 
   xmee204 LIKE xmee_t.xmee204, 
   xmee204_desc LIKE type_t.chr80, 
   xmee205 LIKE xmee_t.xmee205, 
   xmee032 LIKE xmee_t.xmee032, 
   xmee032_desc LIKE type_t.chr80, 
   xmee071 LIKE xmee_t.xmee071, 
   xmee903 LIKE xmee_t.xmee903, 
   xmee903_desc LIKE type_t.chr80, 
   xmee904 LIKE xmee_t.xmee904, 
   xmee025 LIKE xmee_t.xmee025, 
   xmee025_desc LIKE type_t.chr80, 
   oofb017 LIKE type_t.chr80, 
   xmee026 LIKE xmee_t.xmee026, 
   xmee026_desc LIKE type_t.chr80, 
   oofb017_1 LIKE type_t.chr80, 
   xmee206 LIKE xmee_t.xmee206, 
   xmee206_desc LIKE type_t.chr80, 
   xmee207 LIKE xmee_t.xmee207, 
   xmee207_desc LIKE type_t.chr80, 
   xmee020 LIKE xmee_t.xmee020, 
   xmee020_desc LIKE type_t.chr80, 
   xmee036 LIKE xmee_t.xmee036, 
   xmee036_desc LIKE type_t.chr80, 
   xmee009 LIKE xmee_t.xmee009, 
   xmee009_desc LIKE type_t.chr80, 
   xmee010 LIKE xmee_t.xmee010, 
   xmee010_desc LIKE type_t.chr80, 
   xmee015 LIKE xmee_t.xmee015, 
   xmee015_desc LIKE type_t.chr80, 
   xmee016 LIKE xmee_t.xmee016, 
   xmee011 LIKE xmee_t.xmee011, 
   xmee011_desc LIKE type_t.chr80, 
   xmee012 LIKE xmee_t.xmee012, 
   xmee013 LIKE xmee_t.xmee013, 
   xmee035 LIKE xmee_t.xmee035, 
   xmee035_desc LIKE type_t.chr80, 
   isaf011 LIKE type_t.chr80, 
   xmee039 LIKE xmee_t.xmee039, 
   xmeeownid LIKE xmee_t.xmeeownid, 
   xmeeownid_desc LIKE type_t.chr80, 
   xmeeowndp LIKE xmee_t.xmeeowndp, 
   xmeeowndp_desc LIKE type_t.chr80, 
   xmeecrtid LIKE xmee_t.xmeecrtid, 
   xmeecrtid_desc LIKE type_t.chr80, 
   xmeecrtdp LIKE xmee_t.xmeecrtdp, 
   xmeecrtdp_desc LIKE type_t.chr80, 
   xmeecrtdt DATETIME YEAR TO SECOND, 
   xmeemodid LIKE xmee_t.xmeemodid, 
   xmeemodid_desc LIKE type_t.chr80, 
   xmeemoddt DATETIME YEAR TO SECOND, 
   xmeecnfid LIKE xmee_t.xmeecnfid, 
   xmeecnfid_desc LIKE type_t.chr80, 
   xmeecnfdt DATETIME YEAR TO SECOND, 
   xmee034 LIKE xmee_t.xmee034, 
   xmee034_desc LIKE type_t.chr80, 
   xmee006 LIKE xmee_t.xmee006, 
   xmee017 LIKE xmee_t.xmee017, 
   xmee017_desc LIKE type_t.chr80, 
   xmee041 LIKE xmee_t.xmee041, 
   xmee018 LIKE xmee_t.xmee018, 
   xmee018_desc LIKE type_t.chr80, 
   xmee042 LIKE xmee_t.xmee042, 
   xmee019 LIKE xmee_t.xmee019, 
   xmee043 LIKE xmee_t.xmee043, 
   xmee028 LIKE xmee_t.xmee028
       END RECORD
 
#單身 type 宣告
PRIVATE TYPE type_g_xmeg_d        RECORD
       xmegsite LIKE xmeg_t.xmegsite, 
   xmegseq LIKE xmeg_t.xmegseq, 
   xmeg027 LIKE xmeg_t.xmeg027, 
   xmeg001 LIKE xmeg_t.xmeg001, 
   xmeg001_desc LIKE type_t.chr500, 
   xmeg001_desc_desc LIKE type_t.chr500, 
   xmeg002 LIKE xmeg_t.xmeg002, 
   xmeg004 LIKE xmeg_t.xmeg004, 
   xmeg004_desc LIKE type_t.chr500, 
   xmeg005 LIKE xmeg_t.xmeg005, 
   xmeg006 LIKE xmeg_t.xmeg006, 
   xmeg006_desc LIKE type_t.chr500, 
   xmeg007 LIKE xmeg_t.xmeg007, 
   xmeg008 LIKE xmeg_t.xmeg008, 
   xmeg008_desc LIKE type_t.chr500, 
   xmeg009 LIKE xmeg_t.xmeg009, 
   xmeg024 LIKE xmeg_t.xmeg024, 
   xmeg012 LIKE xmeg_t.xmeg012, 
   xmeg013 LIKE xmeg_t.xmeg013, 
   xmeg045 LIKE xmeg_t.xmeg045, 
   xmeg010 LIKE xmeg_t.xmeg010, 
   xmeg010_desc LIKE type_t.chr500, 
   xmeg011 LIKE xmeg_t.xmeg011, 
   xmeg015 LIKE xmeg_t.xmeg015, 
   xmeg016 LIKE xmeg_t.xmeg016, 
   xmeg016_desc LIKE type_t.chr80, 
   xmeg017 LIKE xmeg_t.xmeg017, 
   xmeg046 LIKE xmeg_t.xmeg046, 
   xmeg047 LIKE xmeg_t.xmeg047, 
   xmeg048 LIKE xmeg_t.xmeg048, 
   xmeg023 LIKE xmeg_t.xmeg023, 
   xmeg019 LIKE xmeg_t.xmeg019, 
   xmeg020 LIKE xmeg_t.xmeg020, 
   xmeg021 LIKE xmeg_t.xmeg021, 
   xmeg022 LIKE xmeg_t.xmeg022, 
   xmeg051 LIKE xmeg_t.xmeg051, 
   xmegunit LIKE xmeg_t.xmegunit, 
   xmegunit_desc LIKE type_t.chr500, 
   xmegorga LIKE xmeg_t.xmegorga, 
   xmegorga_desc LIKE type_t.chr500, 
   xmeg052 LIKE xmeg_t.xmeg052, 
   xmeg049 LIKE xmeg_t.xmeg049, 
   xmeg049_desc LIKE type_t.chr500, 
   xmeg053 LIKE xmeg_t.xmeg053, 
   xmeg053_desc LIKE type_t.chr500, 
   xmeg050 LIKE xmeg_t.xmeg050, 
   xmeg901 LIKE xmeg_t.xmeg901, 
   xmeg902 LIKE xmeg_t.xmeg902, 
   xmeg902_desc LIKE type_t.chr500, 
   xmeg903 LIKE xmeg_t.xmeg903
       END RECORD
PRIVATE TYPE type_g_xmeg3_d RECORD
       xmehdocno LIKE xmeh_t.xmehdocno, 
   xmehseq LIKE xmeh_t.xmehseq, 
   xmehseq1 LIKE xmeh_t.xmehseq1, 
   xmeh229 LIKE xmeh_t.xmeh229, 
   xmeh003 LIKE xmeh_t.xmeh003, 
   xmeh001 LIKE xmeh_t.xmeh001, 
   xmeh001_desc LIKE type_t.chr500, 
   xmeh001_desc_desc LIKE type_t.chr500, 
   xmeh002 LIKE xmeh_t.xmeh002, 
   xmeh200 LIKE xmeh_t.xmeh200, 
   xmeh200_desc LIKE type_t.chr500, 
   xmeh004 LIKE xmeh_t.xmeh004, 
   xmeh004_desc LIKE type_t.chr500, 
   xmeh005 LIKE xmeh_t.xmeh005, 
   xmeh011 LIKE xmeh_t.xmeh011, 
   xmeh012 LIKE xmeh_t.xmeh012, 
   xmeg012 LIKE xmeg_t.xmeg012, 
   xmeg013 LIKE xmeg_t.xmeg013, 
   xmehseq2 LIKE xmeh_t.xmehseq2, 
   xmeh006 LIKE xmeh_t.xmeh006, 
   xmeh201 LIKE xmeh_t.xmeh201, 
   xmeh201_desc LIKE type_t.chr500, 
   xmeh202 LIKE xmeh_t.xmeh202, 
   xmeh024 LIKE xmeh_t.xmeh024, 
   xmeh024_desc LIKE type_t.chr500, 
   xmeh025 LIKE xmeh_t.xmeh025, 
   xmeh026 LIKE xmeh_t.xmeh026, 
   xmeh026_desc LIKE type_t.chr500, 
   xmeh027 LIKE xmeh_t.xmeh027, 
   xmeh203 LIKE xmeh_t.xmeh203, 
   xmeh204 LIKE xmeh_t.xmeh204, 
   xmeh205 LIKE xmeh_t.xmeh205, 
   xmeh206 LIKE xmeh_t.xmeh206, 
   xmeh029 LIKE xmeh_t.xmeh029, 
   xmeh028 LIKE xmeh_t.xmeh028, 
   xmeh019 LIKE xmeh_t.xmeh019, 
   xmeh019_desc LIKE type_t.chr80, 
   xmeh030 LIKE xmeh_t.xmeh030, 
   xmeh207 LIKE xmeh_t.xmeh207, 
   xmeh207_desc LIKE type_t.chr500, 
   xmehunit LIKE xmeh_t.xmehunit, 
   xmehunit_desc LIKE type_t.chr500, 
   xmeh210 LIKE xmeh_t.xmeh210, 
   xmeh210_desc LIKE type_t.chr500, 
   xmeh212 LIKE xmeh_t.xmeh212, 
   xmeh213 LIKE xmeh_t.xmeh213, 
   xmeh213_desc LIKE type_t.chr500, 
   xmeh214 LIKE xmeh_t.xmeh214, 
   xmeh214_desc LIKE type_t.chr500, 
   xmeh215 LIKE xmeh_t.xmeh215, 
   xmeh031 LIKE xmeh_t.xmeh031, 
   xmeh014 LIKE xmeh_t.xmeh014, 
   xmeh015 LIKE xmeh_t.xmeh015, 
   xmeh016 LIKE xmeh_t.xmeh016, 
   xmeh017 LIKE xmeh_t.xmeh017, 
   xmeh221 LIKE xmeh_t.xmeh221, 
   xmehsite LIKE xmeh_t.xmehsite, 
   xmehsite_desc LIKE type_t.chr500, 
   xmeh218 LIKE xmeh_t.xmeh218, 
   xmeh218_desc LIKE type_t.chr500, 
   xmeh219 LIKE xmeh_t.xmeh219, 
   xmeh219_desc LIKE type_t.chr500, 
   xmeh220 LIKE xmeh_t.xmeh220, 
   xmeh220_desc LIKE type_t.chr500, 
   xmeh222 LIKE xmeh_t.xmeh222, 
   xmeh222_desc LIKE type_t.chr500, 
   xmeh223 LIKE xmeh_t.xmeh223, 
   xmeh223_desc LIKE type_t.chr500, 
   xmeh224 LIKE xmeh_t.xmeh224, 
   xmeh224_desc LIKE type_t.chr500, 
   xmehorga LIKE xmeh_t.xmehorga, 
   xmehorga_desc LIKE type_t.chr500, 
   xmeh226 LIKE xmeh_t.xmeh226, 
   xmeh227 LIKE xmeh_t.xmeh227, 
   xmeh227_desc LIKE type_t.chr500, 
   xmeh228 LIKE xmeh_t.xmeh228, 
   xmeh228_desc LIKE type_t.chr500, 
   xmeh901 LIKE xmeh_t.xmeh901
       END RECORD
PRIVATE TYPE type_g_xmeg4_d RECORD
       xmjbunit LIKE xmjb_t.xmjbunit, 
   xmjbseq LIKE xmjb_t.xmjbseq, 
   xmjbsite LIKE xmjb_t.xmjbsite, 
   xmjbsite_desc LIKE type_t.chr500, 
   xmjb001 LIKE xmjb_t.xmjb001, 
   xmjb002 LIKE xmjb_t.xmjb002, 
   xmjb003 LIKE xmjb_t.xmjb003, 
   xmjb003_desc LIKE type_t.chr500, 
   xmjb003_desc_desc LIKE type_t.chr500, 
   xmjb033 LIKE xmjb_t.xmjb033, 
   xmjb004 LIKE xmjb_t.xmjb004, 
   xmjb005 LIKE xmjb_t.xmjb005, 
   xmjb005_desc LIKE type_t.chr500, 
   xmjb006 LIKE xmjb_t.xmjb006, 
   xmjb006_desc LIKE type_t.chr80, 
   xmjb007 LIKE xmjb_t.xmjb007, 
   xmjb011 LIKE xmjb_t.xmjb011, 
   xmjb011_desc LIKE type_t.chr500, 
   xmjb012 LIKE xmjb_t.xmjb012, 
   xmjb013 LIKE xmjb_t.xmjb013, 
   xmjb013_desc LIKE type_t.chr500, 
   xmjb014 LIKE xmjb_t.xmjb014, 
   xmjb015 LIKE xmjb_t.xmjb015, 
   xmjb015_desc LIKE type_t.chr500, 
   xmjb016 LIKE xmjb_t.xmjb016, 
   xmjb017 LIKE xmjb_t.xmjb017, 
   xmjb017_desc LIKE type_t.chr500, 
   xmjb018 LIKE xmjb_t.xmjb018, 
   xmjb008 LIKE xmjb_t.xmjb008, 
   xmjb009 LIKE xmjb_t.xmjb009, 
   xmjb010 LIKE xmjb_t.xmjb010, 
   xmjb022 LIKE xmjb_t.xmjb022, 
   xmjb019 LIKE xmjb_t.xmjb019, 
   xmjb020 LIKE xmjb_t.xmjb020, 
   xmjb021 LIKE xmjb_t.xmjb021, 
   xmjb024 LIKE xmjb_t.xmjb024, 
   xmjb024_desc LIKE type_t.chr500, 
   xmjb025 LIKE xmjb_t.xmjb025, 
   xmjb026 LIKE xmjb_t.xmjb026, 
   xmjb026_desc LIKE type_t.chr80, 
   xmjb027 LIKE xmjb_t.xmjb027, 
   xmjb027_desc LIKE type_t.chr500, 
   xmjb028 LIKE xmjb_t.xmjb028, 
   xmjb029 LIKE xmjb_t.xmjb029, 
   xmjb030 LIKE xmjb_t.xmjb030, 
   xmjb031 LIKE xmjb_t.xmjb031, 
   xmjb032 LIKE xmjb_t.xmjb032, 
   xmjb034 LIKE xmjb_t.xmjb034, 
   xmjb901 LIKE xmjb_t.xmjb901, 
   xmjb902 LIKE xmjb_t.xmjb902, 
   xmjb902_desc LIKE type_t.chr500, 
   xmjb903 LIKE xmjb_t.xmjb903
       END RECORD
PRIVATE TYPE type_g_xmeg5_d RECORD
       xmefsite LIKE xmef_t.xmefsite, 
   xmef001 LIKE xmef_t.xmef001, 
   xmef002 LIKE xmef_t.xmef002, 
   xmef002_desc LIKE type_t.chr500, 
   xmef003 LIKE xmef_t.xmef003, 
   xmef004 LIKE xmef_t.xmef004, 
   xmef005 LIKE xmef_t.xmef005, 
   xmef006 LIKE xmef_t.xmef006, 
   xmef007 LIKE xmef_t.xmef007, 
   xmef008 LIKE xmef_t.xmef008, 
   xmef009 LIKE xmef_t.xmef009, 
   xmef901 LIKE xmef_t.xmef901, 
   xmef902 LIKE xmef_t.xmef902, 
   xmef902_desc LIKE type_t.chr500, 
   xmef903 LIKE xmef_t.xmef903
       END RECORD
 
 
#模組變數(Module Variables)
DEFINE g_xmee_m          type_g_xmee_m
DEFINE g_xmee_m_t        type_g_xmee_m
DEFINE g_xmee_m_o        type_g_xmee_m
 
   DEFINE g_xmeedocno_t LIKE xmee_t.xmeedocno
DEFINE g_xmee900_t LIKE xmee_t.xmee900
 
 
DEFINE g_xmeg_d          DYNAMIC ARRAY OF type_g_xmeg_d
DEFINE g_xmeg_d_t        type_g_xmeg_d
DEFINE g_xmeg_d_o        type_g_xmeg_d
DEFINE g_xmeg3_d   DYNAMIC ARRAY OF type_g_xmeg3_d
DEFINE g_xmeg3_d_t type_g_xmeg3_d
DEFINE g_xmeg3_d_o type_g_xmeg3_d
DEFINE g_xmeg4_d   DYNAMIC ARRAY OF type_g_xmeg4_d
DEFINE g_xmeg4_d_t type_g_xmeg4_d
DEFINE g_xmeg4_d_o type_g_xmeg4_d
DEFINE g_xmeg5_d   DYNAMIC ARRAY OF type_g_xmeg5_d
DEFINE g_xmeg5_d_t type_g_xmeg5_d
DEFINE g_xmeg5_d_o type_g_xmeg5_d
 
 
DEFINE g_browser    DYNAMIC ARRAY OF RECORD    #資料瀏覽之欄位 
         b_statepic     LIKE type_t.chr50,
            b_xmeedocno LIKE xmee_t.xmeedocno,
      b_xmee900 LIKE xmee_t.xmee900,
      b_xmeedocdt LIKE xmee_t.xmeedocdt,
      b_xmee001 LIKE xmee_t.xmee001,
      b_xmee002 LIKE xmee_t.xmee002,
   b_xmee002_desc LIKE type_t.chr80,
      b_xmee003 LIKE xmee_t.xmee003,
   b_xmee003_desc LIKE type_t.chr80,
      b_xmee004 LIKE xmee_t.xmee004,
   b_xmee004_desc LIKE type_t.chr80
      END RECORD 
      
DEFINE g_browser_f  RECORD    #資料瀏覽之欄位 
         b_statepic     LIKE type_t.chr50,
            b_xmeedocno LIKE xmee_t.xmeedocno,
      b_xmee900 LIKE xmee_t.xmee900,
      b_xmeedocdt LIKE xmee_t.xmeedocdt,
      b_xmee001 LIKE xmee_t.xmee001,
      b_xmee002 LIKE xmee_t.xmee002,
   b_xmee002_desc LIKE type_t.chr80,
      b_xmee003 LIKE xmee_t.xmee003,
   b_xmee003_desc LIKE type_t.chr80,
      b_xmee004 LIKE xmee_t.xmee004,
   b_xmee004_desc LIKE type_t.chr80
      END RECORD 
      
 
DEFINE g_wc                  STRING
DEFINE g_wc_t                STRING
DEFINE g_wc2                 STRING                          #單身CONSTRUCT結果
DEFINE g_wc2_table1          STRING
DEFINE g_wc2_table2   STRING
 
DEFINE g_wc2_table3   STRING
 
DEFINE g_wc2_table4   STRING
 
 
 
DEFINE g_wc_filter           STRING
DEFINE g_wc_filter_t         STRING
 
DEFINE g_sql                 STRING
DEFINE g_forupd_sql          STRING
DEFINE g_cnt                 LIKE type_t.num10
DEFINE g_current_idx         LIKE type_t.num10     
DEFINE g_jump                LIKE type_t.num10        
DEFINE g_no_ask              LIKE type_t.num5        
DEFINE g_rec_b               LIKE type_t.num5           
DEFINE l_ac                  LIKE type_t.num5    
DEFINE g_curr_diag           ui.Dialog                     #Current Dialog
    
DEFINE g_pagestart           LIKE type_t.num5           
DEFINE gwin_curr             ui.Window                     #Current Window
DEFINE gfrm_curr             ui.Form                       #Current Form
DEFINE g_page_action         STRING                        #page action
DEFINE g_header_hidden       LIKE type_t.num5              #隱藏單頭
DEFINE g_worksheet_hidden    LIKE type_t.num5              #隱藏工作Panel
DEFINE g_page                STRING                        #第幾頁
DEFINE g_state               STRING       
 
DEFINE g_detail_cnt          LIKE type_t.num5              #單身總筆數
DEFINE g_detail_idx          LIKE type_t.num5              #單身目前所在筆數
DEFINE g_detail_idx2         LIKE type_t.num5              #單身2目前所在筆數
DEFINE g_browser_cnt         LIKE type_t.num5              #Browser總筆數
DEFINE g_browser_idx         LIKE type_t.num5              #Browser目前所在筆數
DEFINE g_temp_idx            LIKE type_t.num5              #Browser目前所在筆數(暫存用)
 
DEFINE g_searchcol           STRING                        #查詢欄位代碼
DEFINE g_searchstr           STRING                        #查詢欄位字串
DEFINE g_order               STRING                        #查詢排序欄位
                                                        
DEFINE g_current_row         LIKE type_t.num5              #Browser所在筆數
DEFINE g_current_sw          BOOLEAN                       #Browser所在筆數用開關
DEFINE g_current_page        LIKE type_t.num5              #目前所在頁數
DEFINE g_insert              LIKE type_t.chr5              #是否導到其他page
 
DEFINE g_ref_fields          DYNAMIC ARRAY OF VARCHAR(500) #ap_ref用陣列
DEFINE g_ref_vars            DYNAMIC ARRAY OF VARCHAR(500) #ap_ref用陣列
DEFINE g_rtn_fields          DYNAMIC ARRAY OF VARCHAR(500) #ap_ref用陣列
DEFINE gs_keys               DYNAMIC ARRAY OF VARCHAR(500) #同步資料用陣列
DEFINE gs_keys_bak           DYNAMIC ARRAY OF VARCHAR(500) #同步資料用陣列
DEFINE g_bfill               LIKE type_t.chr5              #是否刷新單身
DEFINE g_error_show          LIKE type_t.num5              #
 
DEFINE g_wc_frozen           STRING                        #凍結欄位使用
DEFINE g_chk                 BOOLEAN                       #助記碼判斷用
DEFINE g_aw                  STRING                        #確定當下點擊的單身
DEFINE g_default             BOOLEAN                       #是否有外部參數查詢
DEFINE g_log1                STRING                        #log用
DEFINE g_log2                STRING                        #log用
DEFINE g_loc                 LIKE type_t.chr5              #判斷游標所在位置
 
#add-point:自定義模組變數(Module Variable)
{<point name="global.variable"/>}
#end add-point
 
#add-point:傳入參數說明(global.argv)
{<point name="global.argv"/>}
#end add-point
]]>
</section>
  <section id="adbt510.idx_chk" ver="13" status="" src="s">
<![CDATA[#+ 單身筆數變更
PRIVATE FUNCTION adbt510_idx_chk()
   #add-point:idx_chk段define
   {<point name="idx_chk.define"/>}
   #end add-point  
   
   IF g_current_page = 1 THEN
      LET g_detail_idx = g_curr_diag.getCurrentRow("s_detail1")
      IF g_detail_idx > g_xmeg_d.getLength() THEN
         LET g_detail_idx = g_xmeg_d.getLength()
      END IF
      IF g_detail_idx = 0 AND g_xmeg_d.getLength() <> 0 THEN
         LET g_detail_idx = 1
      END IF
      DISPLAY g_detail_idx TO FORMONLY.idx
      DISPLAY g_xmeg_d.getLength() TO FORMONLY.cnt
   END IF
   
   IF g_current_page = 2 THEN
      LET g_detail_idx = g_curr_diag.getCurrentRow("s_detail3")
      IF g_detail_idx > g_xmeg3_d.getLength() THEN
         LET g_detail_idx = g_xmeg3_d.getLength()
      END IF
      IF g_detail_idx = 0 AND g_xmeg3_d.getLength() <> 0 THEN
         LET g_detail_idx = 1
      END IF
      DISPLAY g_detail_idx TO FORMONLY.idx
      DISPLAY g_xmeg3_d.getLength() TO FORMONLY.cnt
   END IF
   IF g_current_page = 3 THEN
      LET g_detail_idx = g_curr_diag.getCurrentRow("s_detail4")
      IF g_detail_idx > g_xmeg4_d.getLength() THEN
         LET g_detail_idx = g_xmeg4_d.getLength()
      END IF
      IF g_detail_idx = 0 AND g_xmeg4_d.getLength() <> 0 THEN
         LET g_detail_idx = 1
      END IF
      DISPLAY g_detail_idx TO FORMONLY.idx
      DISPLAY g_xmeg4_d.getLength() TO FORMONLY.cnt
   END IF
   IF g_current_page = 4 THEN
      LET g_detail_idx = g_curr_diag.getCurrentRow("s_detail5")
      IF g_detail_idx > g_xmeg5_d.getLength() THEN
         LET g_detail_idx = g_xmeg5_d.getLength()
      END IF
      IF g_detail_idx = 0 AND g_xmeg5_d.getLength() <> 0 THEN
         LET g_detail_idx = 1
      END IF
      DISPLAY g_detail_idx TO FORMONLY.idx
      DISPLAY g_xmeg5_d.getLength() TO FORMONLY.cnt
   END IF
 
   
   #add-point:idx_chk段other
   {<point name="idx_chk.other"/>}
   #end add-point  
   
END FUNCTION
]]>
</section>
  <section id="adbt510.init" ver="24" status="" src="s">
<![CDATA[#+ 瀏覽頁簽資料初始化
PRIVATE FUNCTION adbt510_init()
   #add-point:init段define
   {<point name="init.define"/>}
   #end add-point    
   
   LET g_bfill       = "Y"
   LET g_detail_idx  = 1
   LET g_detail_idx2 = 1
   LET g_error_show  = 1
   LET l_ac = 1
      CALL cl_set_combo_scc_part('xmeestus','13','N,X,Y,A,D,R,W')
 
      CALL cl_set_combo_scc('xmee005','2063') 
   CALL cl_set_combo_scc('xmee007','2065') 
   CALL cl_set_combo_scc('xmee039','8321') 
   CALL cl_set_combo_scc('xmee006','2064') 
   CALL cl_set_combo_scc('xmeg045','2035') 
   CALL cl_set_combo_scc('xmeg019','2055') 
   CALL cl_set_combo_scc('xmeg020','2036') 
   CALL cl_set_combo_scc('xmeh003','2055') 
   CALL cl_set_combo_scc('xmeh017','2058') 
 
   LET gwin_curr = ui.Window.getCurrent()  #取得現行畫面
   LET gfrm_curr = gwin_curr.getForm()     #取出物件化後的畫面物件
 
   #add-point:畫面資料初始化
   {<point name="init.init"/>}
   #end add-point
   
   CALL adbt510_default_search()
    
END FUNCTION
]]>
</section>
  <section id="adbt510.input" ver="96" status="" src="s">
<![CDATA[#+ 資料輸入
PRIVATE FUNCTION adbt510_input(p_cmd)
   DEFINE  p_cmd                 LIKE type_t.chr1
   DEFINE  l_cmd_t               LIKE type_t.chr1
   DEFINE  l_cmd                 LIKE type_t.chr1
   DEFINE  l_n                   LIKE type_t.num5                #檢查重複用  
   DEFINE  l_cnt                 LIKE type_t.num5                #檢查重複用  
   DEFINE  l_lock_sw             LIKE type_t.chr1                #單身鎖住否  
   DEFINE  l_allow_insert        LIKE type_t.num5                #可新增否 
   DEFINE  l_allow_delete        LIKE type_t.num5                #可刪除否  
   DEFINE  l_count               LIKE type_t.num5
   DEFINE  l_i                   LIKE type_t.num5
   DEFINE  l_insert              BOOLEAN
   DEFINE  ls_return             STRING
   DEFINE  l_var_keys            DYNAMIC ARRAY OF STRING
   DEFINE  l_field_keys          DYNAMIC ARRAY OF STRING
   DEFINE  l_vars                DYNAMIC ARRAY OF STRING
   DEFINE  l_fields              DYNAMIC ARRAY OF STRING
   DEFINE  l_var_keys_bak        DYNAMIC ARRAY OF STRING
   DEFINE  lb_reproduce          BOOLEAN
   DEFINE  li_reproduce          LIKE type_t.num5
   DEFINE  li_reproduce_target   LIKE type_t.num5
   #add-point:input段define
   {<point name="input.define"/>}
   #end add-point  
 
   #先做狀態判定
   IF p_cmd = 'r' THEN
      LET l_cmd_t = 'r'
      LET p_cmd   = 'a'
   ELSE
      LET l_cmd_t = p_cmd
   END IF   
   
   #切換畫面
   IF g_main_hidden THEN
      CALL gfrm_curr.setElementHidden("mainlayout",0)
      CALL gfrm_curr.setElementHidden("worksheet",1)
      LET g_main_hidden = 0
   END IF
 
   CALL cl_set_head_visible("","YES")  
 
   LET l_insert = FALSE
   LET g_action_choice = ""
 
   #add-point:input段define_sql
   {<point name="input.define_sql" mark="Y"/>}
   #end add-point 
   LET g_forupd_sql = "SELECT xmegsite,xmegseq,xmeg027,xmeg001,xmeg002,xmeg004,xmeg005,xmeg006,xmeg007, 
       xmeg008,xmeg009,xmeg024,xmeg012,xmeg013,xmeg045,xmeg010,xmeg011,xmeg015,xmeg016,xmeg017,xmeg046, 
       xmeg047,xmeg048,xmeg023,xmeg019,xmeg020,xmeg021,xmeg022,xmeg051,xmegunit,xmegorga,xmeg052,xmeg049, 
       xmeg053,xmeg050,xmeg901,xmeg902,xmeg903 FROM xmeg_t WHERE xmegent=? AND xmegdocno=? AND xmeg900=?  
       AND xmegseq=? FOR UPDATE"
   #add-point:input段define_sql
   {<point name="input.after_define_sql"/>}
   #end add-point 
   LET g_forupd_sql = cl_sql_forupd(g_forupd_sql)
   LET g_forupd_sql = cl_sql_add_mask(g_forupd_sql)              #遮蔽特定資料
   DECLARE adbt510_bcl CURSOR FROM g_forupd_sql
   
   #add-point:input段define_sql
   {<point name="input.define_sql2" mark="Y"/>}
   #end add-point    
   LET g_forupd_sql = "SELECT xmehdocno,xmehseq,xmehseq1,xmeh229,xmeh003,xmeh001,xmeh002,xmeh200,xmeh004, 
       xmeh005,xmeh011,xmeh012,xmehseq2,xmeh006,xmeh201,xmeh202,xmeh024,xmeh025,xmeh026,xmeh027,xmeh203, 
       xmeh204,xmeh205,xmeh206,xmeh029,xmeh028,xmeh019,xmeh030,xmeh207,xmehunit,xmeh210,xmeh212,xmeh213, 
       xmeh214,xmeh215,xmeh031,xmeh014,xmeh015,xmeh016,xmeh017,xmeh221,xmehsite,xmeh218,xmeh219,xmeh220, 
       xmeh222,xmeh223,xmeh224,xmehorga,xmeh226,xmeh227,xmeh228,xmeh901 FROM xmeh_t WHERE xmehent=?  
       AND xmehdocno=? AND xmeh900=? AND xmehseq=? AND xmehseq1=? AND xmehseq2=? FOR UPDATE"
   #add-point:input段define_sql
   {<point name="input.after_define_sql2"/>}
   #end add-point
   LET g_forupd_sql = cl_sql_forupd(g_forupd_sql)
   LET g_forupd_sql = cl_sql_add_mask(g_forupd_sql)              #遮蔽特定資料
   DECLARE adbt510_bcl2 CURSOR FROM g_forupd_sql
 
   #add-point:input段define_sql
   {<point name="input.define_sql3" mark="Y"/>}
   #end add-point    
   LET g_forupd_sql = "SELECT xmjbunit,xmjbseq,xmjbsite,xmjb001,xmjb002,xmjb003,xmjb033,xmjb004,xmjb005, 
       xmjb006,xmjb007,xmjb011,xmjb012,xmjb013,xmjb014,xmjb015,xmjb016,xmjb017,xmjb018,xmjb008,xmjb009, 
       xmjb010,xmjb022,xmjb019,xmjb020,xmjb021,xmjb024,xmjb025,xmjb026,xmjb027,xmjb028,xmjb029,xmjb030, 
       xmjb031,xmjb032,xmjb034,xmjb901,xmjb902,xmjb903 FROM xmjb_t WHERE xmjbent=? AND xmjbdocno=? AND  
       xmjb900=? AND xmjbseq=? FOR UPDATE"
   #add-point:input段define_sql
   {<point name="input.after_define_sql3"/>}
   #end add-point
   LET g_forupd_sql = cl_sql_forupd(g_forupd_sql)
   LET g_forupd_sql = cl_sql_add_mask(g_forupd_sql)              #遮蔽特定資料
   DECLARE adbt510_bcl3 CURSOR FROM g_forupd_sql
 
   #add-point:input段define_sql
   {<point name="input.define_sql4" mark="Y"/>}
   #end add-point    
   LET g_forupd_sql = "SELECT xmefsite,xmef001,xmef002,xmef003,xmef004,xmef005,xmef006,xmef007,xmef008, 
       xmef009,xmef901,xmef902,xmef903 FROM xmef_t WHERE xmefent=? AND xmefdocno=? AND xmef900=? AND  
       xmef001=? FOR UPDATE"
   #add-point:input段define_sql
   {<point name="input.after_define_sql4"/>}
   #end add-point
   LET g_forupd_sql = cl_sql_forupd(g_forupd_sql)
   LET g_forupd_sql = cl_sql_add_mask(g_forupd_sql)              #遮蔽特定資料
   DECLARE adbt510_bcl4 CURSOR FROM g_forupd_sql
 
 
   
 
 
   #add-point:input段define_sql
   {<point name="input.other_sql"/>}
   #end add-point 
 
   LET l_allow_insert = cl_auth_detail_input("insert")
   LET l_allow_delete = cl_auth_detail_input("delete")
   LET g_qryparam.state = 'i'
   
   #控制key欄位可否輸入
   CALL adbt510_set_entry(p_cmd)
   #add-point:set_entry後
   {<point name="input.after_set_entry"/>}
   #end add-point
   CALL adbt510_set_no_entry(p_cmd)
 
   DISPLAY BY NAME g_xmee_m.xmeesite,g_xmee_m.xmee902,g_xmee_m.xmeedocno,g_xmee_m.xmee900,g_xmee_m.xmee901, 
       g_xmee_m.xmee200,g_xmee_m.xmee201,g_xmee_m.xmeestus,g_xmee_m.xmee024,g_xmee_m.xmeeacti,g_xmee_m.xmee021, 
       g_xmee_m.xmee022,g_xmee_m.xmee203,g_xmee_m.xmee027,g_xmee_m.xmee002,g_xmee_m.xmee003,g_xmee_m.xmeeunit, 
       g_xmee_m.xmee071,g_xmee_m.xmee903,g_xmee_m.xmee904,g_xmee_m.xmee025,g_xmee_m.xmee026,g_xmee_m.xmee020, 
       g_xmee_m.xmee036,g_xmee_m.xmee009,g_xmee_m.xmee010,g_xmee_m.xmee035,g_xmee_m.xmee039,g_xmee_m.xmee034, 
       g_xmee_m.xmee006,g_xmee_m.xmee017,g_xmee_m.xmee018,g_xmee_m.xmee019,g_xmee_m.xmee028
   
   LET lb_reproduce = FALSE
   
   #add-point:資料輸入前
   {<point name="input.before_input"/>}
   #end add-point
   
   DIALOG ATTRIBUTES(UNBUFFERED,FIELD ORDER FORM)
   
]]>
</section>
  <section id="adbt510.input.body" ver="130" status="" src="s">
<![CDATA[   
      #Page1 預設值產生於此處
      INPUT ARRAY g_xmeg_d FROM s_detail1.*
          ATTRIBUTE(COUNT = g_rec_b,MAXCOUNT = g_max_rec,WITHOUT DEFAULTS, 
                  INSERT ROW = FALSE, 
                  DELETE ROW = FALSE,
                  APPEND ROW = FALSE)
 
         #自訂ACTION(detail_input,page_1)
         
         
         BEFORE INPUT
            IF g_insert = 'Y' AND NOT cl_null(g_insert) THEN 
              CALL FGL_SET_ARR_CURR(g_xmeg_d.getLength()+1) 
              LET g_insert = 'N' 
           END IF 
 
            CALL adbt510_b_fill()
            LET g_rec_b = g_xmeg_d.getLength()
            #add-point:資料輸入前
            {<point name="input.d.before_input"/>}
            #end add-point
         
         BEFORE ROW
            #add-point:modify段before row2
            {<point name="input.body.before_row2"/>}
            #end add-point  
            LET l_insert = FALSE
            LET l_cmd = ''
            LET l_ac = ARR_CURR()
            LET g_detail_idx = l_ac
            
            LET l_lock_sw = 'N'            #DEFAULT
            LET l_n = ARR_COUNT()
            DISPLAY l_ac TO FORMONLY.idx
         
            CALL s_transaction_begin()
            OPEN adbt510_cl USING g_enterprise,g_xmee_m.xmeedocno,g_xmee_m.xmee900
            IF STATUS THEN
               CALL cl_err("OPEN adbt510_cl:", STATUS, 1)
               CLOSE adbt510_cl
               CALL s_transaction_end('N','0')
               RETURN
            END IF
            
            LET g_rec_b = g_xmeg_d.getLength()
            
            IF g_rec_b >= l_ac 
               AND g_xmeg_d[l_ac].xmegseq IS NOT NULL
 
            THEN
               LET l_cmd='u'
               LET g_xmeg_d_t.* = g_xmeg_d[l_ac].*  #BACKUP
               LET g_xmeg_d_o.* = g_xmeg_d[l_ac].*  #BACKUP
               CALL adbt510_set_entry_b(l_cmd)
               #add-point:modify段after_set_entry_b
               {<point name="input.body.after_set_entry_b"/>}
               #end add-point  
               CALL adbt510_set_no_entry_b(l_cmd)
               IF NOT adbt510_lock_b("xmeg_t","'1'") THEN
                  LET l_lock_sw='Y'
               ELSE
                  FETCH adbt510_bcl INTO g_xmeg_d[l_ac].xmegsite,g_xmeg_d[l_ac].xmegseq,g_xmeg_d[l_ac].xmeg027, 
                      g_xmeg_d[l_ac].xmeg001,g_xmeg_d[l_ac].xmeg002,g_xmeg_d[l_ac].xmeg004,g_xmeg_d[l_ac].xmeg005, 
                      g_xmeg_d[l_ac].xmeg006,g_xmeg_d[l_ac].xmeg007,g_xmeg_d[l_ac].xmeg008,g_xmeg_d[l_ac].xmeg009, 
                      g_xmeg_d[l_ac].xmeg024,g_xmeg_d[l_ac].xmeg012,g_xmeg_d[l_ac].xmeg013,g_xmeg_d[l_ac].xmeg045, 
                      g_xmeg_d[l_ac].xmeg010,g_xmeg_d[l_ac].xmeg011,g_xmeg_d[l_ac].xmeg015,g_xmeg_d[l_ac].xmeg016, 
                      g_xmeg_d[l_ac].xmeg017,g_xmeg_d[l_ac].xmeg046,g_xmeg_d[l_ac].xmeg047,g_xmeg_d[l_ac].xmeg048, 
                      g_xmeg_d[l_ac].xmeg023,g_xmeg_d[l_ac].xmeg019,g_xmeg_d[l_ac].xmeg020,g_xmeg_d[l_ac].xmeg021, 
                      g_xmeg_d[l_ac].xmeg022,g_xmeg_d[l_ac].xmeg051,g_xmeg_d[l_ac].xmegunit,g_xmeg_d[l_ac].xmegorga, 
                      g_xmeg_d[l_ac].xmeg052,g_xmeg_d[l_ac].xmeg049,g_xmeg_d[l_ac].xmeg053,g_xmeg_d[l_ac].xmeg050, 
                      g_xmeg_d[l_ac].xmeg901,g_xmeg_d[l_ac].xmeg902,g_xmeg_d[l_ac].xmeg903
                  IF SQLCA.sqlcode THEN
                     CALL cl_err(g_xmeg_d_t.xmegseq,SQLCA.sqlcode,1)
                     LET l_lock_sw = "Y"
                  END IF
                  
                  LET g_bfill = "N"
                  CALL adbt510_show()
                  LET g_bfill = "Y"
                  
                  CALL cl_show_fld_cont()
               END IF
            ELSE
               LET l_cmd='a'
            END IF
            #add-point:modify段before row
            {<point name="input.body.before_row"/>}
            #end add-point  
            #其他table資料備份(確定是否更改用)
            
            #其他table進行lock
            
        
         BEFORE INSERT
            
            LET l_insert = TRUE
            LET l_n = ARR_COUNT()
            LET l_cmd = 'a'
            INITIALIZE g_xmeg_d[l_ac].* TO NULL 
			INITIALIZE g_xmeg_d_t.* TO NULL 
            INITIALIZE g_xmeg_d_o.* TO NULL 
                  LET g_xmeg_d[l_ac].xmeg024 = "N"
      LET g_xmeg_d[l_ac].xmeg045 = "1"
      LET g_xmeg_d[l_ac].xmeg019 = "1"
      LET g_xmeg_d[l_ac].xmeg020 = "1"
      LET g_xmeg_d[l_ac].xmeg021 = "N"
      LET g_xmeg_d[l_ac].xmeg022 = "Y"
      LET g_xmeg_d[l_ac].xmeg052 = "Y"
 
            LET g_xmeg_d_t.* = g_xmeg_d[l_ac].*     #新輸入資料
            LET g_xmeg_d_o.* = g_xmeg_d[l_ac].*     #新輸入資料
            CALL cl_show_fld_cont()
            CALL adbt510_set_entry_b(l_cmd)
            #add-point:modify段after_set_entry_b
            {<point name="input.body.insert.after_set_entry_b"/>}
            #end add-point
            CALL adbt510_set_no_entry_b(l_cmd)
            IF lb_reproduce THEN
               LET lb_reproduce = FALSE
               LET g_xmeg_d[li_reproduce_target].* = g_xmeg_d[li_reproduce].*
 
               LET g_xmeg_d[li_reproduce_target].xmegseq = NULL
 
            END IF
            #公用欄位給值(單身)
            
            
            #add-point:modify段before insert
            {<point name="input.body.before_insert"/>}
            #end add-point  
  
         AFTER INSERT
            LET l_insert = FALSE
            IF INT_FLAG THEN
               CALL cl_err('',9001,0)
               LET INT_FLAG = 0
               CANCEL INSERT
            END IF
               
            #add-point:單身新增
            {<point name="input.body.b_a_insert"/>}
            #end add-point
               
            LET l_count = 1  
            SELECT COUNT(*) INTO l_count FROM xmeg_t 
             WHERE xmegent = g_enterprise AND xmegdocno = g_xmee_m.xmeedocno
               AND xmeg900 = g_xmee_m.xmee900
 
               AND xmegseq = g_xmeg_d[l_ac].xmegseq
 
                
            #資料未重複, 插入新增資料
            IF l_count = 0 THEN 
               #add-point:單身新增前
               {<point name="input.body.b_insert"/>}
               #end add-point
            
               #同步新增到同層的table
                              INITIALIZE gs_keys TO NULL 
               LET gs_keys[1] = g_xmee_m.xmeedocno
               LET gs_keys[2] = g_xmee_m.xmee900
               LET gs_keys[3] = g_xmeg_d[g_detail_idx].xmegseq
               CALL adbt510_insert_b('xmeg_t',gs_keys,"'1'")
                           
               #add-point:單身新增後
               {<point name="input.body.a_insert"/>}
               #end add-point
            ELSE    
               CALL cl_err('INSERT',"std-00006",1)
               INITIALIZE g_xmeg_d[l_ac].* TO NULL
               CALL s_transaction_end('N','0')
               CANCEL INSERT
            END IF
 
            IF SQLCA.SQLcode  THEN
               CALL cl_err("xmeg_t",SQLCA.sqlcode,1)  
               CALL s_transaction_end('N','0')                    
               CANCEL INSERT
            ELSE
               #先刷新資料
               #CALL adbt510_b_fill()
               #資料多語言用-增/改
               
               #add-point:input段-after_insert
               {<point name="input.body.a_insert2"/>}
               #end add-point
               CALL s_transaction_end('Y','0')
               ERROR 'INSERT O.K'
               LET g_rec_b = g_rec_b + 1
            END IF
              
         BEFORE DELETE                            #是否取消單身
            IF l_cmd = 'a' AND g_xmeg_d.getLength() < l_ac THEN
               CALL FGL_SET_ARR_CURR(l_ac-1)
               CALL g_xmeg_d.deleteElement(l_ac)
               NEXT FIELD xmegseq
            END IF
         
            IF g_xmeg_d[l_ac].xmegseq IS NOT NULL
 
               THEN 
               
               IF NOT cl_ask_del_detail() THEN
                  CANCEL DELETE
               END IF
               IF l_lock_sw = "Y" THEN
                  CALL cl_err("", -263, 1)
                  CANCEL DELETE
               END IF
               
               #add-point:單身刪除前
               {<point name="input.body.b_delete" mark="Y"/>}
               #end add-point 
               
               DELETE FROM xmeg_t
                WHERE xmegent = g_enterprise AND xmegdocno = g_xmee_m.xmeedocno AND
                                          xmeg900 = g_xmee_m.xmee900 AND
 
                      xmegseq = g_xmeg_d_t.xmegseq
 
                  
               #add-point:單身刪除中
               {<point name="input.body.m_delete"/>}
               #end add-point 
               
               IF SQLCA.sqlcode THEN
                  CALL cl_err("xmeg_t",SQLCA.sqlcode,1)
                  CALL s_transaction_end('N','0')
                  CANCEL DELETE   
               ELSE
                  LET g_rec_b = g_rec_b-1
                  
                  #add-point:單身刪除後
                  {<point name="input.body.a_delete"/>}
                  #end add-point
                  CALL s_transaction_end('Y','0')
               END IF 
               CLOSE adbt510_bcl
               LET l_count = g_xmeg_d.getLength()
            END IF 
            
                           INITIALIZE gs_keys TO NULL 
               LET gs_keys[1] = g_xmee_m.xmeedocno
               LET gs_keys[2] = g_xmee_m.xmee900
               LET gs_keys[3] = g_xmeg_d[g_detail_idx].xmegseq
 
              
         AFTER DELETE 
            #add-point:單身刪除後2
            {<point name="input.body.after_delete"/>}
            #end add-point
                           CALL adbt510_delete_b('xmeg_t',gs_keys,"'1'")
 
                  #此段落由子樣板a01產生
         BEFORE FIELD xmegsite
            #add-point:BEFORE FIELD xmegsite
            {<point name="input.b.page1.xmegsite" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmegsite
            
            #add-point:AFTER FIELD xmegsite
            {<point name="input.a.page1.xmegsite" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE xmegsite
            #add-point:ON CHANGE xmegsite
            {<point name="input.g.page1.xmegsite" />}
            #END add-point
 
 
                  #Ctrlp:input.c.page1.xmegsite
         ON ACTION controlp INFIELD xmegsite
            #add-point:ON ACTION controlp INFIELD xmegsite
            {<point name="input.c.page1.xmegsite" />}
            #END add-point
 
 
 
         ON ROW CHANGE
            IF INT_FLAG THEN
               CALL cl_err('',9001,0)
               LET INT_FLAG = 0
               LET g_xmeg_d[l_ac].* = g_xmeg_d_t.*
               CLOSE adbt510_bcl
               CALL s_transaction_end('N','0')
               EXIT DIALOG 
            END IF
              
            IF l_lock_sw = 'Y' THEN
               CALL cl_err(g_xmeg_d[l_ac].xmegseq,-263,1)
               LET g_xmeg_d[l_ac].* = g_xmeg_d_t.*
            ELSE
            
               #add-point:單身修改前
               {<point name="input.body.b_update" mark="Y"/>}
               #end add-point
               
               #寫入修改者/修改日期資訊(單身)
               
      
               UPDATE xmeg_t SET (xmegdocno,xmeg900,xmegsite,xmegseq,xmeg027,xmeg001,xmeg002,xmeg004, 
                   xmeg005,xmeg006,xmeg007,xmeg008,xmeg009,xmeg024,xmeg012,xmeg013,xmeg045,xmeg010,xmeg011, 
                   xmeg015,xmeg016,xmeg017,xmeg046,xmeg047,xmeg048,xmeg023,xmeg019,xmeg020,xmeg021,xmeg022, 
                   xmeg051,xmegunit,xmegorga,xmeg052,xmeg049,xmeg053,xmeg050,xmeg901,xmeg902,xmeg903) = (g_xmee_m.xmeedocno, 
                   g_xmee_m.xmee900,g_xmeg_d[l_ac].xmegsite,g_xmeg_d[l_ac].xmegseq,g_xmeg_d[l_ac].xmeg027, 
                   g_xmeg_d[l_ac].xmeg001,g_xmeg_d[l_ac].xmeg002,g_xmeg_d[l_ac].xmeg004,g_xmeg_d[l_ac].xmeg005, 
                   g_xmeg_d[l_ac].xmeg006,g_xmeg_d[l_ac].xmeg007,g_xmeg_d[l_ac].xmeg008,g_xmeg_d[l_ac].xmeg009, 
                   g_xmeg_d[l_ac].xmeg024,g_xmeg_d[l_ac].xmeg012,g_xmeg_d[l_ac].xmeg013,g_xmeg_d[l_ac].xmeg045, 
                   g_xmeg_d[l_ac].xmeg010,g_xmeg_d[l_ac].xmeg011,g_xmeg_d[l_ac].xmeg015,g_xmeg_d[l_ac].xmeg016, 
                   g_xmeg_d[l_ac].xmeg017,g_xmeg_d[l_ac].xmeg046,g_xmeg_d[l_ac].xmeg047,g_xmeg_d[l_ac].xmeg048, 
                   g_xmeg_d[l_ac].xmeg023,g_xmeg_d[l_ac].xmeg019,g_xmeg_d[l_ac].xmeg020,g_xmeg_d[l_ac].xmeg021, 
                   g_xmeg_d[l_ac].xmeg022,g_xmeg_d[l_ac].xmeg051,g_xmeg_d[l_ac].xmegunit,g_xmeg_d[l_ac].xmegorga, 
                   g_xmeg_d[l_ac].xmeg052,g_xmeg_d[l_ac].xmeg049,g_xmeg_d[l_ac].xmeg053,g_xmeg_d[l_ac].xmeg050, 
                   g_xmeg_d[l_ac].xmeg901,g_xmeg_d[l_ac].xmeg902,g_xmeg_d[l_ac].xmeg903)
                WHERE xmegent = g_enterprise AND xmegdocno = g_xmee_m.xmeedocno 
                  AND xmeg900 = g_xmee_m.xmee900 
 
                  AND xmegseq = g_xmeg_d_t.xmegseq #項次   
 
                  
               #add-point:單身修改中
               {<point name="input.body.m_update"/>}
               #end add-point
               CASE
                  WHEN SQLCA.sqlerrd[3] = 0  #更新不到的處理
                     CALL cl_err("xmeg_t","std-00009",1)
                     CALL s_transaction_end('N','0')
                     LET g_xmeg_d[l_ac].* = g_xmeg_d_t.*
                  WHEN SQLCA.sqlcode #其他錯誤
                     CALL cl_err("xmeg_t",SQLCA.sqlcode,1)
                     LET g_xmeg_d[l_ac].* = g_xmeg_d_t.*                     
                     CALL s_transaction_end('N','0')
                  OTHERWISE
                                    INITIALIZE gs_keys TO NULL 
               LET gs_keys[1] = g_xmee_m.xmeedocno
               LET gs_keys_bak[1] = g_xmeedocno_t
               LET gs_keys[2] = g_xmee_m.xmee900
               LET gs_keys_bak[2] = g_xmee900_t
               LET gs_keys[3] = g_xmeg_d[g_detail_idx].xmegseq
               LET gs_keys_bak[3] = g_xmeg_d_t.xmegseq
               CALL adbt510_update_b('xmeg_t',gs_keys,gs_keys_bak,"'1'")
                     #資料多語言用-增/改
                     
               END CASE
               
               LET g_log1 = util.JSON.stringify(g_xmee_m),util.JSON.stringify(g_xmeg_d_t)
               LET g_log2 = util.JSON.stringify(g_xmee_m),util.JSON.stringify(g_xmeg_d[l_ac])
               
               IF NOT cl_log_modified_record(g_log1,g_log2) THEN 
                  CALL s_transaction_end('N','0')
               END IF
               
               #add-point:單身修改後
               {<point name="input.body.a_update"/>}
               #end add-point
 
            END IF
            
         AFTER ROW
            #add-point:單身after_row
            {<point name="input.body.after_row"/>}
            #end add-point
            CALL adbt510_unlock_b("xmeg_t","'1'")
            CALL s_transaction_end('Y','0')
            #其他table進行unlock
            #add-point:單身after_row2
            {<point name="input.body.after_row2"/>}
            #end add-point
              
         AFTER INPUT
            #add-point:input段after input 
            {<point name="input.body.after_input"/>}
            #end add-point 
 
         ON ACTION controlo    
            CALL FGL_SET_ARR_CURR(g_xmeg_d.getLength()+1)
            LET lb_reproduce = TRUE
            LET li_reproduce = l_ac
            LET li_reproduce_target = g_xmeg_d.getLength()+1
            
         #ON ACTION cancel
         #   LET INT_FLAG = 1
         #   LET g_detail_idx = 1
         #   EXIT DIALOG 
 
      END INPUT
      
      INPUT ARRAY g_xmeg4_d FROM s_detail4.*
         ATTRIBUTE(COUNT = g_rec_b,MAXCOUNT = g_max_rec,WITHOUT DEFAULTS, 
                 INSERT ROW = FALSE, #此頁面insert功能由產生器控制, 手動之設定無效! 

                 DELETE ROW = FALSE,
                 APPEND ROW = FALSE)
                 
         #自訂ACTION(detail_input,page_3)
         
         
         BEFORE INPUT
            IF g_insert = 'Y' AND NOT cl_null(g_insert) THEN 
              CALL FGL_SET_ARR_CURR(g_xmeg4_d.getLength()+1) 
              LET g_insert = 'N' 
           END IF 
 
            CALL adbt510_b_fill()
            LET g_rec_b = g_xmeg4_d.getLength()
            #add-point:資料輸入前
            {<point name="input.body4.before_input"/>}
            #end add-point
            
         BEFORE INSERT
            
            LET l_insert = TRUE
            LET l_n = ARR_COUNT()
            LET l_cmd = 'a'
            INITIALIZE g_xmeg4_d[l_ac].* TO NULL 
            INITIALIZE g_xmeg4_d_t.* TO NULL 
            INITIALIZE g_xmeg4_d_o.* TO NULL 
                  LET g_xmeg4_d[l_ac].xmjb030 = "N"
 
            LET g_xmeg4_d_t.* = g_xmeg4_d[l_ac].*     #新輸入資料
            LET g_xmeg4_d_o.* = g_xmeg4_d[l_ac].*     #新輸入資料
            CALL cl_show_fld_cont()
            CALL adbt510_set_entry_b(l_cmd)
            #add-point:modify段after_set_entry_b
            {<point name="input.body4.insert.after_set_entry_b"/>}
            #end add-point
            CALL adbt510_set_no_entry_b(l_cmd)
            IF lb_reproduce THEN
               LET lb_reproduce = FALSE
               LET g_xmeg4_d[li_reproduce_target].* = g_xmeg4_d[li_reproduce].*
 
               LET g_xmeg4_d[li_reproduce_target].xmjbseq = NULL
            END IF
            #公用欄位給值(單身3)
            
            
            #add-point:modify段before insert
            {<point name="input.body4.before_insert"/>}
            #end add-point  
            
         BEFORE ROW     
            #add-point:modify段before row2
            {<point name="input.body4.before_row2"/>}
            #end add-point  
            LET l_insert = FALSE
            LET l_cmd = ''
            LET l_ac = ARR_CURR()
            LET g_detail_idx = l_ac
              
            LET l_lock_sw = 'N'            #DEFAULT
            LET l_n = ARR_COUNT()
            DISPLAY l_ac TO FORMONLY.idx
         
            CALL s_transaction_begin()
            OPEN adbt510_cl USING g_enterprise,g_xmee_m.xmeedocno,g_xmee_m.xmee900
            IF STATUS THEN
               CALL cl_err("OPEN adbt510_cl:", STATUS, 1)
               CLOSE adbt510_cl
               CALL s_transaction_end('N','0')
               RETURN
            END IF
            
            LET g_rec_b = g_xmeg4_d.getLength()
            
            IF g_rec_b >= l_ac 
               AND g_xmeg4_d[l_ac].xmjbseq IS NOT NULL
            THEN 
               LET l_cmd='u'
               LET g_xmeg4_d_t.* = g_xmeg4_d[l_ac].*  #BACKUP
               LET g_xmeg4_d_o.* = g_xmeg4_d[l_ac].*  #BACKUP
               CALL adbt510_set_entry_b(l_cmd)
               #add-point:modify段after_set_entry_b
               {<point name="input.body4.after_set_entry_b"/>}
               #end add-point  
               CALL adbt510_set_no_entry_b(l_cmd)
               IF NOT adbt510_lock_b("xmjb_t","'3'") THEN
                  LET l_lock_sw='Y'
               ELSE
                  FETCH adbt510_bcl3 INTO g_xmeg4_d[l_ac].xmjbunit,g_xmeg4_d[l_ac].xmjbseq,g_xmeg4_d[l_ac].xmjbsite, 
                      g_xmeg4_d[l_ac].xmjb001,g_xmeg4_d[l_ac].xmjb002,g_xmeg4_d[l_ac].xmjb003,g_xmeg4_d[l_ac].xmjb033, 
                      g_xmeg4_d[l_ac].xmjb004,g_xmeg4_d[l_ac].xmjb005,g_xmeg4_d[l_ac].xmjb006,g_xmeg4_d[l_ac].xmjb007, 
                      g_xmeg4_d[l_ac].xmjb011,g_xmeg4_d[l_ac].xmjb012,g_xmeg4_d[l_ac].xmjb013,g_xmeg4_d[l_ac].xmjb014, 
                      g_xmeg4_d[l_ac].xmjb015,g_xmeg4_d[l_ac].xmjb016,g_xmeg4_d[l_ac].xmjb017,g_xmeg4_d[l_ac].xmjb018, 
                      g_xmeg4_d[l_ac].xmjb008,g_xmeg4_d[l_ac].xmjb009,g_xmeg4_d[l_ac].xmjb010,g_xmeg4_d[l_ac].xmjb022, 
                      g_xmeg4_d[l_ac].xmjb019,g_xmeg4_d[l_ac].xmjb020,g_xmeg4_d[l_ac].xmjb021,g_xmeg4_d[l_ac].xmjb024, 
                      g_xmeg4_d[l_ac].xmjb025,g_xmeg4_d[l_ac].xmjb026,g_xmeg4_d[l_ac].xmjb027,g_xmeg4_d[l_ac].xmjb028, 
                      g_xmeg4_d[l_ac].xmjb029,g_xmeg4_d[l_ac].xmjb030,g_xmeg4_d[l_ac].xmjb031,g_xmeg4_d[l_ac].xmjb032, 
                      g_xmeg4_d[l_ac].xmjb034,g_xmeg4_d[l_ac].xmjb901,g_xmeg4_d[l_ac].xmjb902,g_xmeg4_d[l_ac].xmjb903 

                  IF SQLCA.sqlcode THEN
                     CALL cl_err('',SQLCA.sqlcode,1)
                     LET l_lock_sw = "Y"
                  END IF
                  
                  LET g_bfill = "N"
                  CALL adbt510_show()
                  LET g_bfill = "Y"
                  
                  CALL cl_show_fld_cont()
               END IF
            ELSE
               LET l_cmd='a'
            END IF
            #add-point:modify段before row
            {<point name="input.body4.before_row"/>}
            #end add-point  
            #其他table資料備份(確定是否更改用)
            
            #其他table進行lock
            
            
         BEFORE DELETE                            #是否取消單身
            IF l_cmd = 'a' AND g_xmeg4_d.getLength() < l_ac THEN
               CALL FGL_SET_ARR_CURR(l_ac-1)
               CALL g_xmeg4_d.deleteElement(l_ac)
               NEXT FIELD xmjbseq
            END IF
         
            IF g_xmeg4_d[l_ac].xmjbseq IS NOT NULL
            THEN
               IF NOT cl_ask_del_detail() THEN
                  CANCEL DELETE
               END IF
               IF l_lock_sw = "Y" THEN
                  CALL cl_err("", -263, 1)
                  CANCEL DELETE
               END IF
               
               #add-point:單身3刪除前
               {<point name="input.body4.b_delete" mark="Y"/>}
               #end add-point    
               
               DELETE FROM xmjb_t
                WHERE xmjbent = g_enterprise AND xmjbdocno = g_xmee_m.xmeedocno AND
                                          xmjb900 = g_xmee_m.xmee900 AND
                      xmjbseq = g_xmeg4_d_t.xmjbseq
                  
               #add-point:單身3刪除中
               {<point name="input.body4.m_delete"/>}
               #end add-point    
                  
               IF SQLCA.sqlcode THEN
                  CALL cl_err("xmeg_t",SQLCA.sqlcode,1)
                  CALL s_transaction_end('N','0')
                  CANCEL DELETE   
               ELSE
                  LET g_rec_b = g_rec_b-1
                  
                  #add-point:單身3刪除後
                  {<point name="input.body4.a_delete"/>}
                  #end add-point
                  CALL s_transaction_end('Y','0')
               END IF 
               CLOSE adbt510_bcl
               LET l_count = g_xmeg_d.getLength()
            END IF 
            
                           INITIALIZE gs_keys TO NULL 
               LET gs_keys[1] = g_xmee_m.xmeedocno
               LET gs_keys[2] = g_xmee_m.xmee900
               LET gs_keys[3] = g_xmeg4_d[g_detail_idx].xmjbseq
 
            
         AFTER DELETE 
            #add-point:單身AFTER DELETE 
            {<point name="input.body4.after_delete"/>}
            #end add-point
                           CALL adbt510_delete_b('xmjb_t',gs_keys,"'3'")
 
         AFTER INSERT    
            LET l_insert = FALSE
            IF INT_FLAG THEN
               CALL cl_err('',9001,0)
               LET INT_FLAG = 0
               CANCEL INSERT
            END IF
               
            #add-point:單身3新增前
            {<point name="input.body4.b_a_insert"/>}
            #end add-point
               
            LET l_count = 1  
            SELECT COUNT(*) INTO l_count FROM xmjb_t 
             WHERE xmjbent = g_enterprise AND xmjbdocno = g_xmee_m.xmeedocno
               AND xmjb900 = g_xmee_m.xmee900
               AND xmjbseq = g_xmeg4_d[l_ac].xmjbseq
                
            #資料未重複, 插入新增資料
            IF l_count = 0 THEN 
               #add-point:單身3新增前
               {<point name="input.body4.b_insert"/>}
               #end add-point
            
                              INITIALIZE gs_keys TO NULL 
               LET gs_keys[1] = g_xmee_m.xmeedocno
               LET gs_keys[2] = g_xmee_m.xmee900
               LET gs_keys[3] = g_xmeg4_d[g_detail_idx].xmjbseq
               CALL adbt510_insert_b('xmjb_t',gs_keys,"'3'")
                           
               #add-point:單身新增後3
               {<point name="input.body4.a_insert"/>}
               #end add-point
            ELSE    
               CALL cl_err('INSERT',"std-00006",1)
               INITIALIZE g_xmeg_d[l_ac].* TO NULL
               CALL s_transaction_end('N','0')
               CANCEL INSERT
            END IF
 
            IF SQLCA.SQLcode  THEN
               CALL cl_err("xmjb_t",SQLCA.sqlcode,1)  
               CALL s_transaction_end('N','0')                    
               CANCEL INSERT
            ELSE
               #先刷新資料
               #CALL adbt510_b_fill()
               #資料多語言用-增/改
               
               #add-point:單身新增後
               {<point name="input.body4.after_insert"/>}
               #end add-point
               CALL s_transaction_end('Y','0')
               ERROR 'INSERT O.K'
               LET g_rec_b = g_rec_b + 1
            END IF
            
         ON ROW CHANGE 
            IF INT_FLAG THEN
               CALL cl_err('',9001,0)
               LET INT_FLAG = 0
               LET g_xmeg4_d[l_ac].* = g_xmeg4_d_t.*
               CLOSE adbt510_bcl3
               CALL s_transaction_end('N','0')
               EXIT DIALOG 
            END IF
            
            IF l_lock_sw = 'Y' THEN
               CALL cl_err('',-263,1)
               LET g_xmeg4_d[l_ac].* = g_xmeg4_d_t.*
            ELSE
               #add-point:單身page3修改前
               {<point name="input.body4.b_update" mark="Y"/>}
               #end add-point
               
               #寫入修改者/修改日期資訊(單身3)
               
               
               UPDATE xmjb_t SET (xmjbdocno,xmjb900,xmjbunit,xmjbseq,xmjbsite,xmjb001,xmjb002,xmjb003, 
                   xmjb033,xmjb004,xmjb005,xmjb006,xmjb007,xmjb011,xmjb012,xmjb013,xmjb014,xmjb015,xmjb016, 
                   xmjb017,xmjb018,xmjb008,xmjb009,xmjb010,xmjb022,xmjb019,xmjb020,xmjb021,xmjb024,xmjb025, 
                   xmjb026,xmjb027,xmjb028,xmjb029,xmjb030,xmjb031,xmjb032,xmjb034,xmjb901,xmjb902,xmjb903) = (g_xmee_m.xmeedocno, 
                   g_xmee_m.xmee900,g_xmeg4_d[l_ac].xmjbunit,g_xmeg4_d[l_ac].xmjbseq,g_xmeg4_d[l_ac].xmjbsite, 
                   g_xmeg4_d[l_ac].xmjb001,g_xmeg4_d[l_ac].xmjb002,g_xmeg4_d[l_ac].xmjb003,g_xmeg4_d[l_ac].xmjb033, 
                   g_xmeg4_d[l_ac].xmjb004,g_xmeg4_d[l_ac].xmjb005,g_xmeg4_d[l_ac].xmjb006,g_xmeg4_d[l_ac].xmjb007, 
                   g_xmeg4_d[l_ac].xmjb011,g_xmeg4_d[l_ac].xmjb012,g_xmeg4_d[l_ac].xmjb013,g_xmeg4_d[l_ac].xmjb014, 
                   g_xmeg4_d[l_ac].xmjb015,g_xmeg4_d[l_ac].xmjb016,g_xmeg4_d[l_ac].xmjb017,g_xmeg4_d[l_ac].xmjb018, 
                   g_xmeg4_d[l_ac].xmjb008,g_xmeg4_d[l_ac].xmjb009,g_xmeg4_d[l_ac].xmjb010,g_xmeg4_d[l_ac].xmjb022, 
                   g_xmeg4_d[l_ac].xmjb019,g_xmeg4_d[l_ac].xmjb020,g_xmeg4_d[l_ac].xmjb021,g_xmeg4_d[l_ac].xmjb024, 
                   g_xmeg4_d[l_ac].xmjb025,g_xmeg4_d[l_ac].xmjb026,g_xmeg4_d[l_ac].xmjb027,g_xmeg4_d[l_ac].xmjb028, 
                   g_xmeg4_d[l_ac].xmjb029,g_xmeg4_d[l_ac].xmjb030,g_xmeg4_d[l_ac].xmjb031,g_xmeg4_d[l_ac].xmjb032, 
                   g_xmeg4_d[l_ac].xmjb034,g_xmeg4_d[l_ac].xmjb901,g_xmeg4_d[l_ac].xmjb902,g_xmeg4_d[l_ac].xmjb903)  
                   #自訂欄位頁簽
                WHERE xmjbent = g_enterprise AND xmjbdocno = g_xmee_m.xmeedocno
                  AND xmjb900 = g_xmee_m.xmee900
                  AND xmjbseq = g_xmeg4_d_t.xmjbseq #項次 
                  
               #add-point:單身page3修改中
               {<point name="input.body4.m_update"/>}
               #end add-point
                  
               CASE
                  WHEN SQLCA.sqlerrd[3] = 0  #更新不到的處理
                     CALL cl_err("xmjb_t","std-00009",1)
                     CALL s_transaction_end('N','0')
                     LET g_xmeg4_d[l_ac].* = g_xmeg4_d_t.*
                  WHEN SQLCA.sqlcode #其他錯誤
                     CALL cl_err("xmjb_t",SQLCA.sqlcode,1)  
                     CALL s_transaction_end('N','0')
                     LET g_xmeg4_d[l_ac].* = g_xmeg4_d_t.*
                  OTHERWISE
                                    INITIALIZE gs_keys TO NULL 
               LET gs_keys[1] = g_xmee_m.xmeedocno
               LET gs_keys_bak[1] = g_xmeedocno_t
               LET gs_keys[2] = g_xmee_m.xmee900
               LET gs_keys_bak[2] = g_xmee900_t
               LET gs_keys[3] = g_xmeg4_d[g_detail_idx].xmjbseq
               LET gs_keys_bak[3] = g_xmeg4_d_t.xmjbseq
               CALL adbt510_update_b('xmjb_t',gs_keys,gs_keys_bak,"'3'")
                     #資料多語言用-增/改
                     
               END CASE
               
               LET g_log1 = util.JSON.stringify(g_xmee_m),util.JSON.stringify(g_xmeg4_d_t)
               LET g_log2 = util.JSON.stringify(g_xmee_m),util.JSON.stringify(g_xmeg4_d[l_ac])
               
               IF NOT cl_log_modified_record(g_log1,g_log2) THEN 
                  CALL s_transaction_end('N','0')
               END IF
               
               #add-point:單身page3修改後
               {<point name="input.body4.a_update"/>}
               #end add-point
            END IF
         
                  #此段落由子樣板a01產生
         BEFORE FIELD xmjb001
            #add-point:BEFORE FIELD xmjb001
            {<point name="input.b.page4.xmjb001" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmjb001
            
            #add-point:AFTER FIELD xmjb001
            {<point name="input.a.page4.xmjb001" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE xmjb001
            #add-point:ON CHANGE xmjb001
            {<point name="input.g.page4.xmjb001" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmjb003
            
            #add-point:AFTER FIELD xmjb003
            {<point name="input.a.page4.xmjb003" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmjb003
            #add-point:BEFORE FIELD xmjb003
            {<point name="input.b.page4.xmjb003" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE xmjb003
            #add-point:ON CHANGE xmjb003
            {<point name="input.g.page4.xmjb003" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmjb015
            
            #add-point:AFTER FIELD xmjb015
            {<point name="input.a.page4.xmjb015" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmjb015
            #add-point:BEFORE FIELD xmjb015
            {<point name="input.b.page4.xmjb015" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE xmjb015
            #add-point:ON CHANGE xmjb015
            {<point name="input.g.page4.xmjb015" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmjb016
            #此段落由子樣板a15產生
            IF NOT cl_ap_chk_Range(g_xmeg4_d[l_ac].xmjb016,"0.000","0","","","azz-00079",1) THEN
               NEXT FIELD xmjb016
            END IF
 
 
            #add-point:AFTER FIELD xmjb016
            {<point name="input.a.page4.xmjb016" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmjb016
            #add-point:BEFORE FIELD xmjb016
            {<point name="input.b.page4.xmjb016" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE xmjb016
            #add-point:ON CHANGE xmjb016
            {<point name="input.g.page4.xmjb016" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmjb024
            
            #add-point:AFTER FIELD xmjb024
            {<point name="input.a.page4.xmjb024" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmjb024
            #add-point:BEFORE FIELD xmjb024
            {<point name="input.b.page4.xmjb024" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE xmjb024
            #add-point:ON CHANGE xmjb024
            {<point name="input.g.page4.xmjb024" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmjb026
            
            #add-point:AFTER FIELD xmjb026
            {<point name="input.a.page4.xmjb026" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmjb026
            #add-point:BEFORE FIELD xmjb026
            {<point name="input.b.page4.xmjb026" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE xmjb026
            #add-point:ON CHANGE xmjb026
            {<point name="input.g.page4.xmjb026" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmjb030
            #add-point:BEFORE FIELD xmjb030
            {<point name="input.b.page4.xmjb030" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmjb030
            
            #add-point:AFTER FIELD xmjb030
            {<point name="input.a.page4.xmjb030" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE xmjb030
            #add-point:ON CHANGE xmjb030
            {<point name="input.g.page4.xmjb030" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmjb031
            #add-point:BEFORE FIELD xmjb031
            {<point name="input.b.page4.xmjb031" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmjb031
            
            #add-point:AFTER FIELD xmjb031
            {<point name="input.a.page4.xmjb031" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE xmjb031
            #add-point:ON CHANGE xmjb031
            {<point name="input.g.page4.xmjb031" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmjb032
            #add-point:BEFORE FIELD xmjb032
            {<point name="input.b.page4.xmjb032" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmjb032
            
            #add-point:AFTER FIELD xmjb032
            {<point name="input.a.page4.xmjb032" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE xmjb032
            #add-point:ON CHANGE xmjb032
            {<point name="input.g.page4.xmjb032" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmjb034
            #add-point:BEFORE FIELD xmjb034
            {<point name="input.b.page4.xmjb034" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmjb034
            
            #add-point:AFTER FIELD xmjb034
            {<point name="input.a.page4.xmjb034" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE xmjb034
            #add-point:ON CHANGE xmjb034
            {<point name="input.g.page4.xmjb034" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmjb901
            #add-point:BEFORE FIELD xmjb901
            {<point name="input.b.page4.xmjb901" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmjb901
            
            #add-point:AFTER FIELD xmjb901
            {<point name="input.a.page4.xmjb901" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE xmjb901
            #add-point:ON CHANGE xmjb901
            {<point name="input.g.page4.xmjb901" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmjb902
            
            #add-point:AFTER FIELD xmjb902
            {<point name="input.a.page4.xmjb902" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmjb902
            #add-point:BEFORE FIELD xmjb902
            {<point name="input.b.page4.xmjb902" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE xmjb902
            #add-point:ON CHANGE xmjb902
            {<point name="input.g.page4.xmjb902" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmjb903
            #add-point:BEFORE FIELD xmjb903
            {<point name="input.b.page4.xmjb903" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmjb903
            
            #add-point:AFTER FIELD xmjb903
            {<point name="input.a.page4.xmjb903" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE xmjb903
            #add-point:ON CHANGE xmjb903
            {<point name="input.g.page4.xmjb903" />}
            #END add-point
 
 
                  #Ctrlp:input.c.page4.xmjb001
         ON ACTION controlp INFIELD xmjb001
            #add-point:ON ACTION controlp INFIELD xmjb001
            {<point name="input.c.page4.xmjb001" />}
            #END add-point
 
         #Ctrlp:input.c.page4.xmjb003
         ON ACTION controlp INFIELD xmjb003
            #add-point:ON ACTION controlp INFIELD xmjb003
            {<point name="input.c.page4.xmjb003" />}
            #END add-point
 
         #Ctrlp:input.c.page4.xmjb015
         ON ACTION controlp INFIELD xmjb015
            #add-point:ON ACTION controlp INFIELD xmjb015
            {<point name="input.c.page4.xmjb015" />}
            #END add-point
 
         #Ctrlp:input.c.page4.xmjb016
         ON ACTION controlp INFIELD xmjb016
            #add-point:ON ACTION controlp INFIELD xmjb016
            {<point name="input.c.page4.xmjb016" />}
            #END add-point
 
         #Ctrlp:input.c.page4.xmjb024
         ON ACTION controlp INFIELD xmjb024
            #add-point:ON ACTION controlp INFIELD xmjb024
            {<point name="input.c.page4.xmjb024" />}
            #END add-point
 
         #Ctrlp:input.c.page4.xmjb026
         ON ACTION controlp INFIELD xmjb026
            #add-point:ON ACTION controlp INFIELD xmjb026
            {<point name="input.c.page4.xmjb026" />}
            #END add-point
 
         #Ctrlp:input.c.page4.xmjb030
         ON ACTION controlp INFIELD xmjb030
            #add-point:ON ACTION controlp INFIELD xmjb030
            {<point name="input.c.page4.xmjb030" />}
            #END add-point
 
         #Ctrlp:input.c.page4.xmjb031
         ON ACTION controlp INFIELD xmjb031
            #add-point:ON ACTION controlp INFIELD xmjb031
            {<point name="input.c.page4.xmjb031" />}
            #END add-point
 
         #Ctrlp:input.c.page4.xmjb032
         ON ACTION controlp INFIELD xmjb032
            #add-point:ON ACTION controlp INFIELD xmjb032
            {<point name="input.c.page4.xmjb032" />}
            #END add-point
 
         #Ctrlp:input.c.page4.xmjb034
         ON ACTION controlp INFIELD xmjb034
            #add-point:ON ACTION controlp INFIELD xmjb034
            {<point name="input.c.page4.xmjb034" />}
            #END add-point
 
         #Ctrlp:input.c.page4.xmjb901
         ON ACTION controlp INFIELD xmjb901
            #add-point:ON ACTION controlp INFIELD xmjb901
            {<point name="input.c.page4.xmjb901" />}
            #END add-point
 
         #Ctrlp:input.c.page4.xmjb902
         ON ACTION controlp INFIELD xmjb902
            #add-point:ON ACTION controlp INFIELD xmjb902
            {<point name="input.c.page4.xmjb902" />}
            #END add-point
 
         #Ctrlp:input.c.page4.xmjb903
         ON ACTION controlp INFIELD xmjb903
            #add-point:ON ACTION controlp INFIELD xmjb903
            {<point name="input.c.page4.xmjb903" />}
            #END add-point
 
 
 
         AFTER ROW
            #add-point:單身page3 after_row
            {<point name="input.body4.after_row"/>}
            #end add-point
            LET l_ac = ARR_CURR()
            IF INT_FLAG THEN
               CALL cl_err('',9001,0)
               LET INT_FLAG = 0
               IF l_cmd = 'u' THEN
                  LET g_xmeg4_d[l_ac].* = g_xmeg4_d_t.*
               END IF
               CLOSE adbt510_bcl3
               CALL s_transaction_end('N','0')
               EXIT DIALOG 
            END IF
            
            #其他table進行unlock
            
            CALL adbt510_unlock_b("xmjb_t","'3'")
            CALL s_transaction_end('Y','0')
            #add-point:單身page3 after_row2
            {<point name="input.body4.after_row2"/>}
            #end add-point
 
         AFTER INPUT
            #add-point:input段after input 
            {<point name="input.body4.after_input"/>}
            #end add-point   
    
         ON ACTION controlo
            CALL FGL_SET_ARR_CURR(g_xmeg4_d.getLength()+1)
            LET lb_reproduce = TRUE
            LET li_reproduce = l_ac
            LET li_reproduce_target = g_xmeg4_d.getLength()+1
 
      END INPUT
 
      
 
      
      DISPLAY ARRAY g_xmeg3_d TO s_detail3.* ATTRIBUTES(COUNT=g_rec_b)  
    
         BEFORE ROW
            CALL adbt510_idx_chk()
            LET l_ac = DIALOG.getCurrentRow("s_detail3")
            LET g_detail_idx = l_ac
            
            #add-point:page2, before row動作
            {<point name="input.body3.before_row"/>}
            #end add-point
            
         BEFORE DISPLAY
            CALL FGL_SET_ARR_CURR(g_detail_idx)
            LET l_ac = DIALOG.getCurrentRow("s_detail3")
            CALL adbt510_idx_chk()
            LET g_current_page = 2
      
         #add-point:page2自定義行為
         {<point name="input.body3.action"/>}
         #end add-point
      
      END DISPLAY
      DISPLAY ARRAY g_xmeg5_d TO s_detail5.* ATTRIBUTES(COUNT=g_rec_b)  
    
         BEFORE ROW
            CALL adbt510_idx_chk()
            LET l_ac = DIALOG.getCurrentRow("s_detail5")
            LET g_detail_idx = l_ac
            
            #add-point:page4, before row動作
            {<point name="input.body5.before_row"/>}
            #end add-point
            
         BEFORE DISPLAY
            CALL FGL_SET_ARR_CURR(g_detail_idx)
            LET l_ac = DIALOG.getCurrentRow("s_detail5")
            CALL adbt510_idx_chk()
            LET g_current_page = 4
      
         #add-point:page4自定義行為
         {<point name="input.body5.action"/>}
         #end add-point
      
      END DISPLAY
 
      
 
      
]]>
</section>
  <section id="adbt510.input.head" ver="51" status="" src="s">
<![CDATA[      #單頭段
      INPUT BY NAME g_xmee_m.xmeesite,g_xmee_m.xmee902,g_xmee_m.xmeedocno,g_xmee_m.xmee900,g_xmee_m.xmee901, 
          g_xmee_m.xmee200,g_xmee_m.xmee201,g_xmee_m.xmeestus,g_xmee_m.xmee024,g_xmee_m.xmeeacti,g_xmee_m.xmee021, 
          g_xmee_m.xmee022,g_xmee_m.xmee203,g_xmee_m.xmee027,g_xmee_m.xmee002,g_xmee_m.xmee003,g_xmee_m.xmeeunit, 
          g_xmee_m.xmee071,g_xmee_m.xmee903,g_xmee_m.xmee904,g_xmee_m.xmee025,g_xmee_m.xmee026,g_xmee_m.xmee020, 
          g_xmee_m.xmee036,g_xmee_m.xmee009,g_xmee_m.xmee010,g_xmee_m.xmee035,g_xmee_m.xmee039,g_xmee_m.xmee034, 
          g_xmee_m.xmee006,g_xmee_m.xmee017,g_xmee_m.xmee018,g_xmee_m.xmee019,g_xmee_m.xmee028 
         ATTRIBUTE(WITHOUT DEFAULTS)
         
         #自訂ACTION(master_input)
         
     
         BEFORE INPUT
            IF s_transaction_chk("N",0) THEN
               CALL s_transaction_begin()
            END IF
            
            IF l_cmd_t = 'r' THEN
               
            END IF
            #add-point:資料輸入前
            {<point name="input.m.before_input"/>}
            #end add-point
 
                  #此段落由子樣板a02產生
         AFTER FIELD xmeesite
            
            #add-point:AFTER FIELD xmeesite
            {<point name="input.a.xmeesite" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeesite
            #add-point:BEFORE FIELD xmeesite
            {<point name="input.b.xmeesite" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE xmeesite
            #add-point:ON CHANGE xmeesite
            {<point name="input.g.xmeesite" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmee902
            #add-point:BEFORE FIELD xmee902
            {<point name="input.b.xmee902" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmee902
            
            #add-point:AFTER FIELD xmee902
            {<point name="input.a.xmee902" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE xmee902
            #add-point:ON CHANGE xmee902
            {<point name="input.g.xmee902" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeedocno
            
            #add-point:AFTER FIELD xmeedocno
            {<point name="input.a.xmeedocno" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeedocno
            #add-point:BEFORE FIELD xmeedocno
            {<point name="input.b.xmeedocno" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE xmeedocno
            #add-point:ON CHANGE xmeedocno
            {<point name="input.g.xmeedocno" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmee900
            #add-point:BEFORE FIELD xmee900
            {<point name="input.b.xmee900" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmee900
            
            #add-point:AFTER FIELD xmee900
            {<point name="input.a.xmee900" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE xmee900
            #add-point:ON CHANGE xmee900
            {<point name="input.g.xmee900" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmee901
            #add-point:BEFORE FIELD xmee901
            {<point name="input.b.xmee901" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmee901
            
            #add-point:AFTER FIELD xmee901
            {<point name="input.a.xmee901" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE xmee901
            #add-point:ON CHANGE xmee901
            {<point name="input.g.xmee901" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmee200
            
            #add-point:AFTER FIELD xmee200
            {<point name="input.a.xmee200" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmee200
            #add-point:BEFORE FIELD xmee200
            {<point name="input.b.xmee200" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE xmee200
            #add-point:ON CHANGE xmee200
            {<point name="input.g.xmee200" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmee201
            
            #add-point:AFTER FIELD xmee201
            {<point name="input.a.xmee201" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmee201
            #add-point:BEFORE FIELD xmee201
            {<point name="input.b.xmee201" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE xmee201
            #add-point:ON CHANGE xmee201
            {<point name="input.g.xmee201" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeestus
            #add-point:BEFORE FIELD xmeestus
            {<point name="input.b.xmeestus" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeestus
            
            #add-point:AFTER FIELD xmeestus
            {<point name="input.a.xmeestus" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE xmeestus
            #add-point:ON CHANGE xmeestus
            {<point name="input.g.xmeestus" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmee024
            
            #add-point:AFTER FIELD xmee024
            {<point name="input.a.xmee024" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmee024
            #add-point:BEFORE FIELD xmee024
            {<point name="input.b.xmee024" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE xmee024
            #add-point:ON CHANGE xmee024
            {<point name="input.g.xmee024" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeeacti
            #add-point:BEFORE FIELD xmeeacti
            {<point name="input.b.xmeeacti" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeeacti
            
            #add-point:AFTER FIELD xmeeacti
            {<point name="input.a.xmeeacti" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE xmeeacti
            #add-point:ON CHANGE xmeeacti
            {<point name="input.g.xmeeacti" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmee021
            
            #add-point:AFTER FIELD xmee021
            {<point name="input.a.xmee021" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmee021
            #add-point:BEFORE FIELD xmee021
            {<point name="input.b.xmee021" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE xmee021
            #add-point:ON CHANGE xmee021
            {<point name="input.g.xmee021" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmee022
            
            #add-point:AFTER FIELD xmee022
            {<point name="input.a.xmee022" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmee022
            #add-point:BEFORE FIELD xmee022
            {<point name="input.b.xmee022" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE xmee022
            #add-point:ON CHANGE xmee022
            {<point name="input.g.xmee022" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmee203
            
            #add-point:AFTER FIELD xmee203
            {<point name="input.a.xmee203" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmee203
            #add-point:BEFORE FIELD xmee203
            {<point name="input.b.xmee203" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE xmee203
            #add-point:ON CHANGE xmee203
            {<point name="input.g.xmee203" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmee027
            
            #add-point:AFTER FIELD xmee027
            {<point name="input.a.xmee027" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmee027
            #add-point:BEFORE FIELD xmee027
            {<point name="input.b.xmee027" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE xmee027
            #add-point:ON CHANGE xmee027
            {<point name="input.g.xmee027" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmee002
            
            #add-point:AFTER FIELD xmee002
            {<point name="input.a.xmee002" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmee002
            #add-point:BEFORE FIELD xmee002
            {<point name="input.b.xmee002" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE xmee002
            #add-point:ON CHANGE xmee002
            {<point name="input.g.xmee002" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmee003
            
            #add-point:AFTER FIELD xmee003
            {<point name="input.a.xmee003" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmee003
            #add-point:BEFORE FIELD xmee003
            {<point name="input.b.xmee003" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE xmee003
            #add-point:ON CHANGE xmee003
            {<point name="input.g.xmee003" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmeeunit
            
            #add-point:AFTER FIELD xmeeunit
            {<point name="input.a.xmeeunit" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmeeunit
            #add-point:BEFORE FIELD xmeeunit
            {<point name="input.b.xmeeunit" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE xmeeunit
            #add-point:ON CHANGE xmeeunit
            {<point name="input.g.xmeeunit" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmee071
            #add-point:BEFORE FIELD xmee071
            {<point name="input.b.xmee071" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmee071
            
            #add-point:AFTER FIELD xmee071
            {<point name="input.a.xmee071" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE xmee071
            #add-point:ON CHANGE xmee071
            {<point name="input.g.xmee071" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmee903
            
            #add-point:AFTER FIELD xmee903
            {<point name="input.a.xmee903" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmee903
            #add-point:BEFORE FIELD xmee903
            {<point name="input.b.xmee903" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE xmee903
            #add-point:ON CHANGE xmee903
            {<point name="input.g.xmee903" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmee904
            #add-point:BEFORE FIELD xmee904
            {<point name="input.b.xmee904" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmee904
            
            #add-point:AFTER FIELD xmee904
            {<point name="input.a.xmee904" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE xmee904
            #add-point:ON CHANGE xmee904
            {<point name="input.g.xmee904" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmee025
            
            #add-point:AFTER FIELD xmee025
            {<point name="input.a.xmee025" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmee025
            #add-point:BEFORE FIELD xmee025
            {<point name="input.b.xmee025" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE xmee025
            #add-point:ON CHANGE xmee025
            {<point name="input.g.xmee025" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmee026
            
            #add-point:AFTER FIELD xmee026
            {<point name="input.a.xmee026" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmee026
            #add-point:BEFORE FIELD xmee026
            {<point name="input.b.xmee026" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE xmee026
            #add-point:ON CHANGE xmee026
            {<point name="input.g.xmee026" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmee020
            
            #add-point:AFTER FIELD xmee020
            {<point name="input.a.xmee020" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmee020
            #add-point:BEFORE FIELD xmee020
            {<point name="input.b.xmee020" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE xmee020
            #add-point:ON CHANGE xmee020
            {<point name="input.g.xmee020" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmee036
            
            #add-point:AFTER FIELD xmee036
            {<point name="input.a.xmee036" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmee036
            #add-point:BEFORE FIELD xmee036
            {<point name="input.b.xmee036" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE xmee036
            #add-point:ON CHANGE xmee036
            {<point name="input.g.xmee036" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmee009
            
            #add-point:AFTER FIELD xmee009
            {<point name="input.a.xmee009" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmee009
            #add-point:BEFORE FIELD xmee009
            {<point name="input.b.xmee009" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE xmee009
            #add-point:ON CHANGE xmee009
            {<point name="input.g.xmee009" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmee010
            
            #add-point:AFTER FIELD xmee010
            {<point name="input.a.xmee010" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmee010
            #add-point:BEFORE FIELD xmee010
            {<point name="input.b.xmee010" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE xmee010
            #add-point:ON CHANGE xmee010
            {<point name="input.g.xmee010" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmee035
            
            #add-point:AFTER FIELD xmee035
            {<point name="input.a.xmee035" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmee035
            #add-point:BEFORE FIELD xmee035
            {<point name="input.b.xmee035" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE xmee035
            #add-point:ON CHANGE xmee035
            {<point name="input.g.xmee035" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmee039
            #add-point:BEFORE FIELD xmee039
            {<point name="input.b.xmee039" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmee039
            
            #add-point:AFTER FIELD xmee039
            {<point name="input.a.xmee039" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE xmee039
            #add-point:ON CHANGE xmee039
            {<point name="input.g.xmee039" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmee034
            
            #add-point:AFTER FIELD xmee034
            {<point name="input.a.xmee034" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmee034
            #add-point:BEFORE FIELD xmee034
            {<point name="input.b.xmee034" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE xmee034
            #add-point:ON CHANGE xmee034
            {<point name="input.g.xmee034" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmee006
            #add-point:BEFORE FIELD xmee006
            {<point name="input.b.xmee006" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmee006
            
            #add-point:AFTER FIELD xmee006
            {<point name="input.a.xmee006" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE xmee006
            #add-point:ON CHANGE xmee006
            {<point name="input.g.xmee006" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmee017
            
            #add-point:AFTER FIELD xmee017
            {<point name="input.a.xmee017" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmee017
            #add-point:BEFORE FIELD xmee017
            {<point name="input.b.xmee017" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE xmee017
            #add-point:ON CHANGE xmee017
            {<point name="input.g.xmee017" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmee018
            
            #add-point:AFTER FIELD xmee018
            {<point name="input.a.xmee018" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmee018
            #add-point:BEFORE FIELD xmee018
            {<point name="input.b.xmee018" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE xmee018
            #add-point:ON CHANGE xmee018
            {<point name="input.g.xmee018" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmee019
            #add-point:BEFORE FIELD xmee019
            {<point name="input.b.xmee019" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmee019
            
            #add-point:AFTER FIELD xmee019
            {<point name="input.a.xmee019" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE xmee019
            #add-point:ON CHANGE xmee019
            {<point name="input.g.xmee019" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmee028
            #add-point:BEFORE FIELD xmee028
            {<point name="input.b.xmee028" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmee028
            
            #add-point:AFTER FIELD xmee028
            {<point name="input.a.xmee028" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE xmee028
            #add-point:ON CHANGE xmee028
            {<point name="input.g.xmee028" />}
            #END add-point
 
 #欄位檢查
                  #Ctrlp:input.c.xmeesite
         ON ACTION controlp INFIELD xmeesite
            #add-point:ON ACTION controlp INFIELD xmeesite
            {<point name="input.c.xmeesite" />}
            #END add-point
 
         #Ctrlp:input.c.xmee902
         ON ACTION controlp INFIELD xmee902
            #add-point:ON ACTION controlp INFIELD xmee902
            {<point name="input.c.xmee902" />}
            #END add-point
 
         #Ctrlp:input.c.xmeedocno
         ON ACTION controlp INFIELD xmeedocno
            #add-point:ON ACTION controlp INFIELD xmeedocno
            {<point name="input.c.xmeedocno" />}
            #END add-point
 
         #Ctrlp:input.c.xmee900
         ON ACTION controlp INFIELD xmee900
            #add-point:ON ACTION controlp INFIELD xmee900
            {<point name="input.c.xmee900" />}
            #END add-point
 
         #Ctrlp:input.c.xmee901
         ON ACTION controlp INFIELD xmee901
            #add-point:ON ACTION controlp INFIELD xmee901
            {<point name="input.c.xmee901" />}
            #END add-point
 
         #Ctrlp:input.c.xmee200
         ON ACTION controlp INFIELD xmee200
            #add-point:ON ACTION controlp INFIELD xmee200
            {<point name="input.c.xmee200" />}
            #END add-point
 
         #Ctrlp:input.c.xmee201
         ON ACTION controlp INFIELD xmee201
            #add-point:ON ACTION controlp INFIELD xmee201
            {<point name="input.c.xmee201" />}
            #END add-point
 
         #Ctrlp:input.c.xmeestus
         ON ACTION controlp INFIELD xmeestus
            #add-point:ON ACTION controlp INFIELD xmeestus
            {<point name="input.c.xmeestus" />}
            #END add-point
 
         #Ctrlp:input.c.xmee024
         ON ACTION controlp INFIELD xmee024
            #add-point:ON ACTION controlp INFIELD xmee024
            {<point name="input.c.xmee024" />}
            #END add-point
 
         #Ctrlp:input.c.xmeeacti
         ON ACTION controlp INFIELD xmeeacti
            #add-point:ON ACTION controlp INFIELD xmeeacti
            {<point name="input.c.xmeeacti" />}
            #END add-point
 
         #Ctrlp:input.c.xmee021
         ON ACTION controlp INFIELD xmee021
            #add-point:ON ACTION controlp INFIELD xmee021
            {<point name="input.c.xmee021" />}
            #END add-point
 
         #Ctrlp:input.c.xmee022
         ON ACTION controlp INFIELD xmee022
            #add-point:ON ACTION controlp INFIELD xmee022
            {<point name="input.c.xmee022" />}
            #END add-point
 
         #Ctrlp:input.c.xmee203
         ON ACTION controlp INFIELD xmee203
            #add-point:ON ACTION controlp INFIELD xmee203
            {<point name="input.c.xmee203" />}
            #END add-point
 
         #Ctrlp:input.c.xmee027
         ON ACTION controlp INFIELD xmee027
            #add-point:ON ACTION controlp INFIELD xmee027
            {<point name="input.c.xmee027" />}
            #END add-point
 
         #Ctrlp:input.c.xmee002
         ON ACTION controlp INFIELD xmee002
            #add-point:ON ACTION controlp INFIELD xmee002
            {<point name="input.c.xmee002" />}
            #END add-point
 
         #Ctrlp:input.c.xmee003
         ON ACTION controlp INFIELD xmee003
            #add-point:ON ACTION controlp INFIELD xmee003
            {<point name="input.c.xmee003" />}
            #END add-point
 
         #Ctrlp:input.c.xmeeunit
         ON ACTION controlp INFIELD xmeeunit
            #add-point:ON ACTION controlp INFIELD xmeeunit
            {<point name="input.c.xmeeunit" />}
            #END add-point
 
         #Ctrlp:input.c.xmee071
         ON ACTION controlp INFIELD xmee071
            #add-point:ON ACTION controlp INFIELD xmee071
            {<point name="input.c.xmee071" />}
            #END add-point
 
         #Ctrlp:input.c.xmee903
         ON ACTION controlp INFIELD xmee903
            #add-point:ON ACTION controlp INFIELD xmee903
            {<point name="input.c.xmee903" />}
            #END add-point
 
         #Ctrlp:input.c.xmee904
         ON ACTION controlp INFIELD xmee904
            #add-point:ON ACTION controlp INFIELD xmee904
            {<point name="input.c.xmee904" />}
            #END add-point
 
         #Ctrlp:input.c.xmee025
         ON ACTION controlp INFIELD xmee025
            #add-point:ON ACTION controlp INFIELD xmee025
            {<point name="input.c.xmee025" />}
            #END add-point
 
         #Ctrlp:input.c.xmee026
         ON ACTION controlp INFIELD xmee026
            #add-point:ON ACTION controlp INFIELD xmee026
            {<point name="input.c.xmee026" />}
            #END add-point
 
         #Ctrlp:input.c.xmee020
         ON ACTION controlp INFIELD xmee020
            #add-point:ON ACTION controlp INFIELD xmee020
            {<point name="input.c.xmee020" />}
            #END add-point
 
         #Ctrlp:input.c.xmee036
         ON ACTION controlp INFIELD xmee036
            #add-point:ON ACTION controlp INFIELD xmee036
            {<point name="input.c.xmee036" />}
            #END add-point
 
         #Ctrlp:input.c.xmee009
         ON ACTION controlp INFIELD xmee009
            #add-point:ON ACTION controlp INFIELD xmee009
            {<point name="input.c.xmee009" />}
            #END add-point
 
         #Ctrlp:input.c.xmee010
         ON ACTION controlp INFIELD xmee010
            #add-point:ON ACTION controlp INFIELD xmee010
            {<point name="input.c.xmee010" />}
            #END add-point
 
         #Ctrlp:input.c.xmee035
         ON ACTION controlp INFIELD xmee035
            #add-point:ON ACTION controlp INFIELD xmee035
            {<point name="input.c.xmee035" />}
            #END add-point
 
         #Ctrlp:input.c.xmee039
         ON ACTION controlp INFIELD xmee039
            #add-point:ON ACTION controlp INFIELD xmee039
            {<point name="input.c.xmee039" />}
            #END add-point
 
         #Ctrlp:input.c.xmee034
         ON ACTION controlp INFIELD xmee034
            #add-point:ON ACTION controlp INFIELD xmee034
            {<point name="input.c.xmee034" />}
            #END add-point
 
         #Ctrlp:input.c.xmee006
         ON ACTION controlp INFIELD xmee006
            #add-point:ON ACTION controlp INFIELD xmee006
            {<point name="input.c.xmee006" />}
            #END add-point
 
         #Ctrlp:input.c.xmee017
         ON ACTION controlp INFIELD xmee017
            #add-point:ON ACTION controlp INFIELD xmee017
            {<point name="input.c.xmee017" />}
            #END add-point
 
         #Ctrlp:input.c.xmee018
         ON ACTION controlp INFIELD xmee018
            #add-point:ON ACTION controlp INFIELD xmee018
            {<point name="input.c.xmee018" />}
            #END add-point
 
         #Ctrlp:input.c.xmee019
         ON ACTION controlp INFIELD xmee019
            #add-point:ON ACTION controlp INFIELD xmee019
            {<point name="input.c.xmee019" />}
            #END add-point
 
         #Ctrlp:input.c.xmee028
         ON ACTION controlp INFIELD xmee028
            #add-point:ON ACTION controlp INFIELD xmee028
            {<point name="input.c.xmee028" />}
            #END add-point
 
 #欄位開窗
            
         AFTER INPUT
            IF INT_FLAG THEN
               EXIT DIALOG
            END IF
 
            CALL cl_showmsg()      #錯誤訊息統整顯示
            DISPLAY BY NAME g_xmee_m.xmeedocno,g_xmee_m.xmee900
                        
            #add-point:單頭INPUT後
            {<point name="input.head.after_input"/>}
            #end add-point
                        
            IF p_cmd <> 'u' THEN
    
               CALL s_transaction_begin()
               
               #add-point:單頭新增前
               {<point name="input.head.b_insert" mark="Y"/>}
               #end add-point
               
               INSERT INTO xmee_t (xmeeent,xmeesite,xmee902,xmeedocno,xmee900,xmee901,xmee001,xmee202, 
                   xmee023,xmee004,xmee200,xmee201,xmeestus,xmee005,xmee007,xmee008,xmeedocdt,xmee024, 
                   xmeeacti,xmee021,xmee022,xmee203,xmee027,xmee002,xmee003,xmeeunit,xmee204,xmee205, 
                   xmee032,xmee071,xmee903,xmee904,xmee025,xmee026,xmee206,xmee207,xmee020,xmee036,xmee009, 
                   xmee010,xmee015,xmee016,xmee011,xmee012,xmee013,xmee035,xmee039,xmeeownid,xmeeowndp, 
                   xmeecrtid,xmeecrtdp,xmeecrtdt,xmeecnfid,xmeecnfdt,xmee034,xmee006,xmee017,xmee041, 
                   xmee018,xmee042,xmee019,xmee043,xmee028)
               VALUES (g_enterprise,g_xmee_m.xmeesite,g_xmee_m.xmee902,g_xmee_m.xmeedocno,g_xmee_m.xmee900, 
                   g_xmee_m.xmee901,g_xmee_m.xmee001,g_xmee_m.xmee202,g_xmee_m.xmee023,g_xmee_m.xmee004, 
                   g_xmee_m.xmee200,g_xmee_m.xmee201,g_xmee_m.xmeestus,g_xmee_m.xmee005,g_xmee_m.xmee007, 
                   g_xmee_m.xmee008,g_xmee_m.xmeedocdt,g_xmee_m.xmee024,g_xmee_m.xmeeacti,g_xmee_m.xmee021, 
                   g_xmee_m.xmee022,g_xmee_m.xmee203,g_xmee_m.xmee027,g_xmee_m.xmee002,g_xmee_m.xmee003, 
                   g_xmee_m.xmeeunit,g_xmee_m.xmee204,g_xmee_m.xmee205,g_xmee_m.xmee032,g_xmee_m.xmee071, 
                   g_xmee_m.xmee903,g_xmee_m.xmee904,g_xmee_m.xmee025,g_xmee_m.xmee026,g_xmee_m.xmee206, 
                   g_xmee_m.xmee207,g_xmee_m.xmee020,g_xmee_m.xmee036,g_xmee_m.xmee009,g_xmee_m.xmee010, 
                   g_xmee_m.xmee015,g_xmee_m.xmee016,g_xmee_m.xmee011,g_xmee_m.xmee012,g_xmee_m.xmee013, 
                   g_xmee_m.xmee035,g_xmee_m.xmee039,g_xmee_m.xmeeownid,g_xmee_m.xmeeowndp,g_xmee_m.xmeecrtid, 
                   g_xmee_m.xmeecrtdp,g_xmee_m.xmeecrtdt,g_xmee_m.xmeecnfid,g_xmee_m.xmeecnfdt,g_xmee_m.xmee034, 
                   g_xmee_m.xmee006,g_xmee_m.xmee017,g_xmee_m.xmee041,g_xmee_m.xmee018,g_xmee_m.xmee042, 
                   g_xmee_m.xmee019,g_xmee_m.xmee043,g_xmee_m.xmee028) 
               IF SQLCA.sqlcode THEN
                  CALL cl_err("g_xmee_m",SQLCA.sqlcode,1)  
                  CALL s_transaction_end('N','0')
                  CONTINUE DIALOG
               END IF
               
               #add-point:單頭新增中
               {<point name="input.head.m_insert"/>}
               #end add-point
               
               
               
               
               #add-point:單頭新增後
               {<point name="input.head.a_insert"/>}
               #end add-point
               CALL s_transaction_end('Y','0') 
               
               IF l_cmd_t = 'r' AND p_cmd = 'a' THEN
                  CALL adbt510_detail_reproduce()
               END IF
               
               LET p_cmd = 'u'
            ELSE
               CALL s_transaction_begin()
            
               #add-point:單頭修改前
               {<point name="input.head.b_update" mark="Y"/>}
               #end add-point
               
               UPDATE xmee_t SET (xmeesite,xmee902,xmeedocno,xmee900,xmee901,xmee001,xmee202,xmee023, 
                   xmee004,xmee200,xmee201,xmeestus,xmee005,xmee007,xmee008,xmeedocdt,xmee024,xmeeacti, 
                   xmee021,xmee022,xmee203,xmee027,xmee002,xmee003,xmeeunit,xmee204,xmee205,xmee032, 
                   xmee071,xmee903,xmee904,xmee025,xmee026,xmee206,xmee207,xmee020,xmee036,xmee009,xmee010, 
                   xmee015,xmee016,xmee011,xmee012,xmee013,xmee035,xmee039,xmeeownid,xmeeowndp,xmeecrtid, 
                   xmeecrtdp,xmeecrtdt,xmeecnfid,xmeecnfdt,xmee034,xmee006,xmee017,xmee041,xmee018,xmee042, 
                   xmee019,xmee043,xmee028) = (g_xmee_m.xmeesite,g_xmee_m.xmee902,g_xmee_m.xmeedocno, 
                   g_xmee_m.xmee900,g_xmee_m.xmee901,g_xmee_m.xmee001,g_xmee_m.xmee202,g_xmee_m.xmee023, 
                   g_xmee_m.xmee004,g_xmee_m.xmee200,g_xmee_m.xmee201,g_xmee_m.xmeestus,g_xmee_m.xmee005, 
                   g_xmee_m.xmee007,g_xmee_m.xmee008,g_xmee_m.xmeedocdt,g_xmee_m.xmee024,g_xmee_m.xmeeacti, 
                   g_xmee_m.xmee021,g_xmee_m.xmee022,g_xmee_m.xmee203,g_xmee_m.xmee027,g_xmee_m.xmee002, 
                   g_xmee_m.xmee003,g_xmee_m.xmeeunit,g_xmee_m.xmee204,g_xmee_m.xmee205,g_xmee_m.xmee032, 
                   g_xmee_m.xmee071,g_xmee_m.xmee903,g_xmee_m.xmee904,g_xmee_m.xmee025,g_xmee_m.xmee026, 
                   g_xmee_m.xmee206,g_xmee_m.xmee207,g_xmee_m.xmee020,g_xmee_m.xmee036,g_xmee_m.xmee009, 
                   g_xmee_m.xmee010,g_xmee_m.xmee015,g_xmee_m.xmee016,g_xmee_m.xmee011,g_xmee_m.xmee012, 
                   g_xmee_m.xmee013,g_xmee_m.xmee035,g_xmee_m.xmee039,g_xmee_m.xmeeownid,g_xmee_m.xmeeowndp, 
                   g_xmee_m.xmeecrtid,g_xmee_m.xmeecrtdp,g_xmee_m.xmeecrtdt,g_xmee_m.xmeecnfid,g_xmee_m.xmeecnfdt, 
                   g_xmee_m.xmee034,g_xmee_m.xmee006,g_xmee_m.xmee017,g_xmee_m.xmee041,g_xmee_m.xmee018, 
                   g_xmee_m.xmee042,g_xmee_m.xmee019,g_xmee_m.xmee043,g_xmee_m.xmee028)
                WHERE xmeeent = g_enterprise AND xmeedocno = g_xmeedocno_t
                  AND xmee900 = g_xmee900_t
 
               IF SQLCA.sqlcode THEN
                  CALL cl_err("xmee_t",SQLCA.sqlcode,1)  
                  CALL s_transaction_end('N','0')
                  CONTINUE DIALOG
               END IF
               
               #add-point:單頭修改中
               {<point name="input.head.m_update"/>}
               #end add-point
               
               
               
               
               LET g_log1 = util.JSON.stringify(g_xmee_m_t)
               LET g_log2 = util.JSON.stringify(g_xmee_m)
               IF NOT cl_log_modified_record(g_log1,g_log2) THEN 
                  CALL s_transaction_end('N','0')
               ELSE
                  CALL s_transaction_end('Y','0')
               END IF
               
               #add-point:單頭修改後
               {<point name="input.head.a_update"/>}
               #end add-point
            END IF
            
            LET g_xmeedocno_t = g_xmee_m.xmeedocno
            LET g_xmee900_t = g_xmee_m.xmee900
 
            #controlp
            
      END INPUT
   
]]>
</section>
  <section id="adbt510.input.other" ver="19" status="" src="s">
<![CDATA[      
      #add-point:自定義input
      {<point name="input.more_input"/>}
      #end add-point
      
      BEFORE DIALOG 
         #add-point:input段before dialog
         {<point name="input.before_dialog"/>}
         #end add-point    
         #新增時強制從單頭開始填
         IF p_cmd = 'a' THEN
            NEXT FIELD xmeedocno
         ELSE
            CASE g_aw
               WHEN "s_detail1"
                  NEXT FIELD xmegsite
               WHEN "s_detail3"
                  NEXT FIELD xmehdocno
               WHEN "s_detail4"
                  NEXT FIELD xmjbunit
               WHEN "s_detail5"
                  NEXT FIELD xmefsite
 
            END CASE
         END IF
    
      ON ACTION controlf
         CALL cl_set_focus_form(ui.Interface.getRootNode()) RETURNING g_fld_name,g_frm_name
         CALL cl_fldhelp(g_frm_name,g_fld_name,g_lang)
 
      ON ACTION controlr
         CALL cl_show_req_fields()
 
      ON ACTION controls
         IF g_header_hidden THEN
            CALL gfrm_curr.setElementHidden("vb_master",0)
            CALL gfrm_curr.setElementImage("controls","small/arr-u.png")
            LET g_header_hidden = 0     #visible
         ELSE
            CALL gfrm_curr.setElementHidden("vb_master",1)
            CALL gfrm_curr.setElementImage("controls","small/arr-d.png")
            LET g_header_hidden = 1     #hidden     
         END IF
 
      ON ACTION accept
         #add-point:input段accept 
         {<point name="input.accept"/>}
         #end add-point    
         ACCEPT DIALOG
        
      ON ACTION cancel      #在dialog button (放棄)
         LET INT_FLAG = TRUE 
         LET g_detail_idx  = 1
         LET g_detail_idx2 = 1
         EXIT DIALOG
 
      ON ACTION close       #在dialog 右上角 (X)
         LET INT_FLAG = TRUE 
         EXIT DIALOG
 
      ON ACTION exit        #toolbar 離開
         LET INT_FLAG = TRUE 
         EXIT DIALOG
 
      #交談指令共用ACTION
      &include "common_action.4gl" 
         CONTINUE DIALOG 
         
   END DIALOG
    
   #add-point:input段after input 
   {<point name="input.after_input"/>}
   #end add-point    
 
END FUNCTION
]]>
</section>
  <section id="adbt510.insert" ver="31" status="" src="s">
<![CDATA[#+ 資料新增
PRIVATE FUNCTION adbt510_insert()
   #add-point:insert段define
   {<point name="insert.define"/>}
   #end add-point    
   
   #清畫面欄位內容
   CLEAR FORM                    
   CALL g_xmeg_d.clear()   
   CALL g_xmeg3_d.clear()  
   CALL g_xmeg4_d.clear()  
   CALL g_xmeg5_d.clear()  
 
 
   INITIALIZE g_xmee_m.* LIKE xmee_t.*             #DEFAULT 設定
   
   LET g_xmeedocno_t = NULL
   LET g_xmee900_t = NULL
 
   
   CALL s_transaction_begin()
   WHILE TRUE
      #公用欄位給值(單頭)
      #此段落由子樣板a14產生    
      LET g_xmee_m.xmeeownid = g_user
      LET g_xmee_m.xmeeowndp = g_dept
      LET g_xmee_m.xmeecrtid = g_user
      LET g_xmee_m.xmeecrtdp = g_dept 
      LET g_xmee_m.xmeecrtdt = cl_get_current()
      LET g_xmee_m.xmeemodid = ""
      LET g_xmee_m.xmeemoddt = ""
      LET g_xmee_m.xmeestus = "N"
 
 
 
      #append欄位給值
      
     
      #一般欄位給值
            LET g_xmee_m.xmee900 = "0"
      LET g_xmee_m.xmee901 = "N"
      LET g_xmee_m.xmee001 = "0"
      LET g_xmee_m.xmeestus = "N"
      LET g_xmee_m.xmee005 = "1"
      LET g_xmee_m.xmee007 = "1"
      LET g_xmee_m.xmeeacti = "N"
      LET g_xmee_m.xmee205 = "100"
      LET g_xmee_m.xmee013 = "N"
      LET g_xmee_m.xmee039 = "1"
      LET g_xmee_m.xmee006 = "1"
      LET g_xmee_m.xmee041 = "0"
      LET g_xmee_m.xmee042 = "0"
      LET g_xmee_m.xmee019 = "Y"
      LET g_xmee_m.xmee043 = "0"
 
  
      #add-point:單頭預設值
      {<point name="insert.default"/>}
      #end add-point 
     
      CALL adbt510_input("a")
      
      #add-point:單頭輸入後
      {<point name="insert.after_insert"/>}
      #end add-point
      
      IF INT_FLAG THEN
         LET INT_FLAG = 0
         LET g_xmee_m.* = g_xmee_m_t.*
         CALL adbt510_show()
         CALL cl_err('',9001,0)
         CALL s_transaction_end('N','0')
         EXIT WHILE
      END IF
      
      CALL g_xmeg_d.clear()
      CALL g_xmeg3_d.clear()
      CALL g_xmeg4_d.clear()
      CALL g_xmeg5_d.clear()
 
 
      LET g_rec_b = 0
      CALL s_transaction_end('Y','0')
      EXIT WHILE
        
   END WHILE
   
   LET g_state = "Y"
   LET g_current_idx = 1 
   
   LET g_xmeedocno_t = g_xmee_m.xmeedocno
   LET g_xmee900_t = g_xmee_m.xmee900
 
   
   LET g_wc = g_wc,  
              " OR ( xmeeent = '" ||g_enterprise|| "' AND",
              " xmeedocno = '", g_xmee_m.xmeedocno CLIPPED, "' "
              ," AND xmee900 = '", g_xmee_m.xmee900 CLIPPED, "' "
 
              , ") "
   
   CLOSE adbt510_cl
   
END FUNCTION
]]>
</section>
  <section id="adbt510.insert_b" ver="50" status="" src="s">
<![CDATA[#+ 新增單身後其他table連動
PRIVATE FUNCTION adbt510_insert_b(ps_table,ps_keys,ps_page)
   DEFINE ps_table    STRING
   DEFINE ps_page     STRING
   DEFINE ps_keys     DYNAMIC ARRAY OF VARCHAR(500)
   DEFINE ls_group    STRING
   DEFINE ls_page     STRING
   #add-point:insert_b段define
   {<point name="insert_b.define"/>}
   #end add-point     
   
   #判斷是否是同一群組的table
   LET ls_group = "'1',"
   IF ls_group.getIndexOf(ps_page,1) > 0 THEN
      #add-point:insert_b段資料新增前
      {<point name="insert_b.before_insert" mark="Y"/>}
      #end add-point 
      INSERT INTO xmeg_t
                  (xmegent,
                   xmegdocno,xmeg900,
                   xmegseq
                   ,xmegsite,xmeg027,xmeg001,xmeg002,xmeg004,xmeg005,xmeg006,xmeg007,xmeg008,xmeg009,xmeg024,xmeg012,xmeg013,xmeg045,xmeg010,xmeg011,xmeg015,xmeg016,xmeg017,xmeg046,xmeg047,xmeg048,xmeg023,xmeg019,xmeg020,xmeg021,xmeg022,xmeg051,xmegunit,xmegorga,xmeg052,xmeg049,xmeg053,xmeg050,xmeg901,xmeg902,xmeg903) 
            VALUES(g_enterprise,
                   ps_keys[1],ps_keys[2],ps_keys[3]
                   ,g_xmeg_d[g_detail_idx].xmegsite,g_xmeg_d[g_detail_idx].xmeg027,g_xmeg_d[g_detail_idx].xmeg001, 
                       g_xmeg_d[g_detail_idx].xmeg002,g_xmeg_d[g_detail_idx].xmeg004,g_xmeg_d[g_detail_idx].xmeg005, 
                       g_xmeg_d[g_detail_idx].xmeg006,g_xmeg_d[g_detail_idx].xmeg007,g_xmeg_d[g_detail_idx].xmeg008, 
                       g_xmeg_d[g_detail_idx].xmeg009,g_xmeg_d[g_detail_idx].xmeg024,g_xmeg_d[g_detail_idx].xmeg012, 
                       g_xmeg_d[g_detail_idx].xmeg013,g_xmeg_d[g_detail_idx].xmeg045,g_xmeg_d[g_detail_idx].xmeg010, 
                       g_xmeg_d[g_detail_idx].xmeg011,g_xmeg_d[g_detail_idx].xmeg015,g_xmeg_d[g_detail_idx].xmeg016, 
                       g_xmeg_d[g_detail_idx].xmeg017,g_xmeg_d[g_detail_idx].xmeg046,g_xmeg_d[g_detail_idx].xmeg047, 
                       g_xmeg_d[g_detail_idx].xmeg048,g_xmeg_d[g_detail_idx].xmeg023,g_xmeg_d[g_detail_idx].xmeg019, 
                       g_xmeg_d[g_detail_idx].xmeg020,g_xmeg_d[g_detail_idx].xmeg021,g_xmeg_d[g_detail_idx].xmeg022, 
                       g_xmeg_d[g_detail_idx].xmeg051,g_xmeg_d[g_detail_idx].xmegunit,g_xmeg_d[g_detail_idx].xmegorga, 
                       g_xmeg_d[g_detail_idx].xmeg052,g_xmeg_d[g_detail_idx].xmeg049,g_xmeg_d[g_detail_idx].xmeg053, 
                       g_xmeg_d[g_detail_idx].xmeg050,g_xmeg_d[g_detail_idx].xmeg901,g_xmeg_d[g_detail_idx].xmeg902, 
                       g_xmeg_d[g_detail_idx].xmeg903)
      #add-point:insert_b段資料新增中
      {<point name="insert_b.m_insert"/>}
      #end add-point 
      IF SQLCA.sqlcode THEN
         CALL cl_err("xmeg_t",SQLCA.sqlcode,0)
      END IF
      #add-point:insert_b段資料新增後
      {<point name="insert_b.after_insert"/>}
      #end add-point 
   END IF
   
   LET ls_group = "'2',"
   #判斷是否是同一群組的table
   IF ls_group.getIndexOf(ps_page,1) > 0 THEN
      #add-point:insert_b段資料新增前
      {<point name="insert_b.before_insert2" mark="Y"/>}
      #end add-point 
      INSERT INTO xmeh_t
                  (xmehent,
                   xmehdocno,xmeh900,
                   xmehseq,xmehseq1,xmehseq2
                   ,xmeh229,xmeh003,xmeh001,xmeh002,xmeh200,xmeh004,xmeh005,xmeh011,xmeh012,xmeh006,xmeh201,xmeh202,xmeh024,xmeh025,xmeh026,xmeh027,xmeh203,xmeh204,xmeh205,xmeh206,xmeh029,xmeh028,xmeh019,xmeh030,xmeh207,xmehunit,xmeh210,xmeh212,xmeh213,xmeh214,xmeh215,xmeh031,xmeh014,xmeh015,xmeh016,xmeh017,xmeh221,xmehsite,xmeh218,xmeh219,xmeh220,xmeh222,xmeh223,xmeh224,xmehorga,xmeh226,xmeh227,xmeh228,xmeh901) 
            VALUES(g_enterprise,
                   ps_keys[1],ps_keys[2],ps_keys[3],ps_keys[4],ps_keys[5]
                   ,g_xmeg3_d[g_detail_idx].xmeh229,g_xmeg3_d[g_detail_idx].xmeh003,g_xmeg3_d[g_detail_idx].xmeh001, 
                       g_xmeg3_d[g_detail_idx].xmeh002,g_xmeg3_d[g_detail_idx].xmeh200,g_xmeg3_d[g_detail_idx].xmeh004, 
                       g_xmeg3_d[g_detail_idx].xmeh005,g_xmeg3_d[g_detail_idx].xmeh011,g_xmeg3_d[g_detail_idx].xmeh012, 
                       g_xmeg3_d[g_detail_idx].xmeh006,g_xmeg3_d[g_detail_idx].xmeh201,g_xmeg3_d[g_detail_idx].xmeh202, 
                       g_xmeg3_d[g_detail_idx].xmeh024,g_xmeg3_d[g_detail_idx].xmeh025,g_xmeg3_d[g_detail_idx].xmeh026, 
                       g_xmeg3_d[g_detail_idx].xmeh027,g_xmeg3_d[g_detail_idx].xmeh203,g_xmeg3_d[g_detail_idx].xmeh204, 
                       g_xmeg3_d[g_detail_idx].xmeh205,g_xmeg3_d[g_detail_idx].xmeh206,g_xmeg3_d[g_detail_idx].xmeh029, 
                       g_xmeg3_d[g_detail_idx].xmeh028,g_xmeg3_d[g_detail_idx].xmeh019,g_xmeg3_d[g_detail_idx].xmeh030, 
                       g_xmeg3_d[g_detail_idx].xmeh207,g_xmeg3_d[g_detail_idx].xmehunit,g_xmeg3_d[g_detail_idx].xmeh210, 
                       g_xmeg3_d[g_detail_idx].xmeh212,g_xmeg3_d[g_detail_idx].xmeh213,g_xmeg3_d[g_detail_idx].xmeh214, 
                       g_xmeg3_d[g_detail_idx].xmeh215,g_xmeg3_d[g_detail_idx].xmeh031,g_xmeg3_d[g_detail_idx].xmeh014, 
                       g_xmeg3_d[g_detail_idx].xmeh015,g_xmeg3_d[g_detail_idx].xmeh016,g_xmeg3_d[g_detail_idx].xmeh017, 
                       g_xmeg3_d[g_detail_idx].xmeh221,g_xmeg3_d[g_detail_idx].xmehsite,g_xmeg3_d[g_detail_idx].xmeh218, 
                       g_xmeg3_d[g_detail_idx].xmeh219,g_xmeg3_d[g_detail_idx].xmeh220,g_xmeg3_d[g_detail_idx].xmeh222, 
                       g_xmeg3_d[g_detail_idx].xmeh223,g_xmeg3_d[g_detail_idx].xmeh224,g_xmeg3_d[g_detail_idx].xmehorga, 
                       g_xmeg3_d[g_detail_idx].xmeh226,g_xmeg3_d[g_detail_idx].xmeh227,g_xmeg3_d[g_detail_idx].xmeh228, 
                       g_xmeg3_d[g_detail_idx].xmeh901)
      #add-point:insert_b段資料新增中
      {<point name="insert_b.m_insert2"/>}
      #end add-point
      IF SQLCA.sqlcode THEN
         CALL cl_err("xmeh_t",SQLCA.sqlcode,0)
      END IF
      #add-point:insert_b段資料新增後
      {<point name="insert_b.after_insert2"/>}
      #end add-point
   END IF
 
   LET ls_group = "'3',"
   #判斷是否是同一群組的table
   IF ls_group.getIndexOf(ps_page,1) > 0 THEN
      #add-point:insert_b段資料新增前
      {<point name="insert_b.before_insert3" mark="Y"/>}
      #end add-point 
      INSERT INTO xmjb_t
                  (xmjbent,
                   xmjbdocno,xmjb900,
                   xmjbseq
                   ,xmjbunit,xmjbsite,xmjb001,xmjb002,xmjb003,xmjb033,xmjb004,xmjb005,xmjb006,xmjb007,xmjb011,xmjb012,xmjb013,xmjb014,xmjb015,xmjb016,xmjb017,xmjb018,xmjb008,xmjb009,xmjb010,xmjb022,xmjb019,xmjb020,xmjb021,xmjb024,xmjb025,xmjb026,xmjb027,xmjb028,xmjb029,xmjb030,xmjb031,xmjb032,xmjb034,xmjb901,xmjb902,xmjb903) 
            VALUES(g_enterprise,
                   ps_keys[1],ps_keys[2],ps_keys[3]
                   ,g_xmeg4_d[g_detail_idx].xmjbunit,g_xmeg4_d[g_detail_idx].xmjbsite,g_xmeg4_d[g_detail_idx].xmjb001, 
                       g_xmeg4_d[g_detail_idx].xmjb002,g_xmeg4_d[g_detail_idx].xmjb003,g_xmeg4_d[g_detail_idx].xmjb033, 
                       g_xmeg4_d[g_detail_idx].xmjb004,g_xmeg4_d[g_detail_idx].xmjb005,g_xmeg4_d[g_detail_idx].xmjb006, 
                       g_xmeg4_d[g_detail_idx].xmjb007,g_xmeg4_d[g_detail_idx].xmjb011,g_xmeg4_d[g_detail_idx].xmjb012, 
                       g_xmeg4_d[g_detail_idx].xmjb013,g_xmeg4_d[g_detail_idx].xmjb014,g_xmeg4_d[g_detail_idx].xmjb015, 
                       g_xmeg4_d[g_detail_idx].xmjb016,g_xmeg4_d[g_detail_idx].xmjb017,g_xmeg4_d[g_detail_idx].xmjb018, 
                       g_xmeg4_d[g_detail_idx].xmjb008,g_xmeg4_d[g_detail_idx].xmjb009,g_xmeg4_d[g_detail_idx].xmjb010, 
                       g_xmeg4_d[g_detail_idx].xmjb022,g_xmeg4_d[g_detail_idx].xmjb019,g_xmeg4_d[g_detail_idx].xmjb020, 
                       g_xmeg4_d[g_detail_idx].xmjb021,g_xmeg4_d[g_detail_idx].xmjb024,g_xmeg4_d[g_detail_idx].xmjb025, 
                       g_xmeg4_d[g_detail_idx].xmjb026,g_xmeg4_d[g_detail_idx].xmjb027,g_xmeg4_d[g_detail_idx].xmjb028, 
                       g_xmeg4_d[g_detail_idx].xmjb029,g_xmeg4_d[g_detail_idx].xmjb030,g_xmeg4_d[g_detail_idx].xmjb031, 
                       g_xmeg4_d[g_detail_idx].xmjb032,g_xmeg4_d[g_detail_idx].xmjb034,g_xmeg4_d[g_detail_idx].xmjb901, 
                       g_xmeg4_d[g_detail_idx].xmjb902,g_xmeg4_d[g_detail_idx].xmjb903)
      #add-point:insert_b段資料新增中
      {<point name="insert_b.m_insert3"/>}
      #end add-point
      IF SQLCA.sqlcode THEN
         CALL cl_err("xmjb_t",SQLCA.sqlcode,0)
      END IF
      #add-point:insert_b段資料新增後
      {<point name="insert_b.after_insert3"/>}
      #end add-point
   END IF
 
   LET ls_group = "'4',"
   #判斷是否是同一群組的table
   IF ls_group.getIndexOf(ps_page,1) > 0 THEN
      #add-point:insert_b段資料新增前
      {<point name="insert_b.before_insert4" mark="Y"/>}
      #end add-point 
      INSERT INTO xmef_t
                  (xmefent,
                   xmefdocno,xmef900,
                   xmef001
                   ,xmefsite,xmef002,xmef003,xmef004,xmef005,xmef006,xmef007,xmef008,xmef009,xmef901,xmef902,xmef903) 
            VALUES(g_enterprise,
                   ps_keys[1],ps_keys[2],ps_keys[3]
                   ,g_xmeg5_d[g_detail_idx].xmefsite,g_xmeg5_d[g_detail_idx].xmef002,g_xmeg5_d[g_detail_idx].xmef003, 
                       g_xmeg5_d[g_detail_idx].xmef004,g_xmeg5_d[g_detail_idx].xmef005,g_xmeg5_d[g_detail_idx].xmef006, 
                       g_xmeg5_d[g_detail_idx].xmef007,g_xmeg5_d[g_detail_idx].xmef008,g_xmeg5_d[g_detail_idx].xmef009, 
                       g_xmeg5_d[g_detail_idx].xmef901,g_xmeg5_d[g_detail_idx].xmef902,g_xmeg5_d[g_detail_idx].xmef903) 

      #add-point:insert_b段資料新增中
      {<point name="insert_b.m_insert4"/>}
      #end add-point
      IF SQLCA.sqlcode THEN
         CALL cl_err("xmef_t",SQLCA.sqlcode,0)
      END IF
      #add-point:insert_b段資料新增後
      {<point name="insert_b.after_insert4"/>}
      #end add-point
   END IF
 
 
   
 
   
   #add-point:insert_b段other
   {<point name="insert_b.other"/>}
   #end add-point     
   
END FUNCTION
]]>
</section>
  <section id="adbt510.lock_b" ver="20" status="" src="s">
<![CDATA[#+ 連動lock其他單身table資料
PRIVATE FUNCTION adbt510_lock_b(ps_table,ps_page)
   DEFINE ps_page     STRING
   DEFINE ps_table    STRING
   DEFINE ls_group    STRING
   #add-point:lock_b段define
   {<point name="lock_b.define"/>}
   #end add-point   
   
   #先刷新資料
   #CALL adbt510_b_fill()
   
   #鎖定整組table
   #LET ls_group = "'1',"
   #僅鎖定自身table
   LET ls_group = "xmeg_t"
   
   IF ls_group.getIndexOf(ps_table,1) THEN
      OPEN adbt510_bcl USING g_enterprise,
                                       g_xmee_m.xmeedocno,g_xmee_m.xmee900,g_xmeg_d[g_detail_idx].xmegseq  
                                               
      IF SQLCA.sqlcode THEN
         CALL cl_err("adbt510_bcl",SQLCA.sqlcode,1)
         RETURN FALSE
      END IF
   END IF
                                    
   #鎖定整組table
   #LET ls_group = "'2',"
   #僅鎖定自身table
   LET ls_group = "xmeh_t"
   IF ls_group.getIndexOf(ps_table,1) THEN
   
      OPEN adbt510_bcl2 USING g_enterprise,
                                             g_xmee_m.xmeedocno,g_xmee_m.xmee900,g_xmeg3_d[g_detail_idx].xmehseq, 
                                                 g_xmeg3_d[g_detail_idx].xmehseq1,g_xmeg3_d[g_detail_idx].xmehseq2 

      IF SQLCA.sqlcode THEN
         CALL cl_err("adbt510_bcl2",SQLCA.sqlcode,1)
         RETURN FALSE
      END IF
   END IF
 
   #鎖定整組table
   #LET ls_group = "'3',"
   #僅鎖定自身table
   LET ls_group = "xmjb_t"
   IF ls_group.getIndexOf(ps_table,1) THEN
   
      OPEN adbt510_bcl3 USING g_enterprise,
                                             g_xmee_m.xmeedocno,g_xmee_m.xmee900,g_xmeg4_d[g_detail_idx].xmjbseq 

      IF SQLCA.sqlcode THEN
         CALL cl_err("adbt510_bcl3",SQLCA.sqlcode,1)
         RETURN FALSE
      END IF
   END IF
 
   #鎖定整組table
   #LET ls_group = "'4',"
   #僅鎖定自身table
   LET ls_group = "xmef_t"
   IF ls_group.getIndexOf(ps_table,1) THEN
   
      OPEN adbt510_bcl4 USING g_enterprise,
                                             g_xmee_m.xmeedocno,g_xmee_m.xmee900,g_xmeg5_d[g_detail_idx].xmef001 

      IF SQLCA.sqlcode THEN
         CALL cl_err("adbt510_bcl4",SQLCA.sqlcode,1)
         RETURN FALSE
      END IF
   END IF
 
 
   
 
   
   #add-point:lock_b段other
   {<point name="lock_b.other"/>}
   #end add-point  
   
   RETURN TRUE
 
END FUNCTION
]]>
</section>
  <section id="adbt510.main" ver="47" status="" src="s">
<![CDATA[#+ 此段落由子樣板a26產生
#OPTIONS SHORT CIRCUIT
#+ 作業開始 
MAIN
   #add-point:main段define
   {<point name="main.define"/>}
   #end add-point   
 
   OPTIONS
   INPUT NO WRAP
   DEFER INTERRUPT
   
   #設定SQL錯誤記錄方式 (模組內定義有效)
   WHENEVER ERROR CALL cl_err_msg_log
       
   #依模組進行系統初始化設定(系統設定)
   CALL cl_ap_init("adb","")
 
   #add-point:作業初始化
   {<point name="main.init" />}
   #end add-point
   
   
 
   #LOCK CURSOR (identifier)
   #add-point:SQL_define
   {<point name="main.define_sql" />}
   #end add-point
   LET g_forupd_sql = " SELECT xmeesite,'',xmee902,xmeedocno,xmee900,xmee901,xmee001,xmee202,'',xmee023, 
       '',xmee004,'',xmee200,'',xmee201,'',xmeestus,xmee005,xmee007,xmee008,xmeedocdt,xmee024,'',xmeeacti, 
       xmee021,'',xmee022,'',xmee203,'',xmee027,'',xmee002,'',xmee003,'',xmeeunit,'',xmee204,'',xmee205, 
       xmee032,'',xmee071,xmee903,'',xmee904,xmee025,'','',xmee026,'','',xmee206,'',xmee207,'',xmee020, 
       '',xmee036,'',xmee009,'',xmee010,'',xmee015,'',xmee016,xmee011,'',xmee012,xmee013,xmee035,'', 
       '',xmee039,xmeeownid,'',xmeeowndp,'',xmeecrtid,'',xmeecrtdp,'',xmeecrtdt,xmeemodid,'',xmeemoddt, 
       xmeecnfid,'',xmeecnfdt,xmee034,'',xmee006,xmee017,'',xmee041,xmee018,'',xmee042,xmee019,xmee043, 
       xmee028", 
                      " FROM xmee_t",
                      " WHERE xmeeent= ? AND xmeedocno=? AND xmee900=? FOR UPDATE"
   #add-point:SQL_define
   {<point name="main.after_define_sql"/>}
   #end add-point
   LET g_forupd_sql = cl_sql_forupd(g_forupd_sql)                #轉換不同資料庫語法
   LET g_forupd_sql = cl_sql_add_mask(g_forupd_sql)              #遮蔽特定資料
   DECLARE adbt510_cl CURSOR FROM g_forupd_sql                 # LOCK CURSOR
 
   LET g_sql = " SELECT UNIQUE xmeesite,xmee902,xmeedocno,xmee900,xmee901,xmee001,xmee202,xmee023,xmee004, 
       xmee200,xmee201,xmeestus,xmee005,xmee007,xmee008,xmeedocdt,xmee024,xmeeacti,xmee021,xmee022,xmee203, 
       xmee027,xmee002,xmee003,xmeeunit,xmee204,xmee205,xmee032,xmee071,xmee903,xmee904,xmee025,xmee026, 
       xmee206,xmee207,xmee020,xmee036,xmee009,xmee010,xmee015,xmee016,xmee011,xmee012,xmee013,xmee035, 
       xmee039,xmeeownid,xmeeowndp,xmeecrtid,xmeecrtdp,xmeecrtdt,xmeemodid,xmeemoddt,xmeecnfid,xmeecnfdt, 
       xmee034,xmee006,xmee017,xmee041,xmee018,xmee042,xmee019,xmee043,xmee028,t1.ooefl003 ,t2.ooefl003 , 
       t3.oojdl003 ,t4.pmaal004 ,t5.pmaal004 ,t6.pmaal004 ,t7.oocql004 ,t8.pmaal004 ,t9.pmaal004 ,t10.pmaal004 , 
       t11.oofa011 ,t12.oofa011 ,t13.ooefl003 ,t14.ooefl003 ,t15.prcfl003 ,t16.oocql004 ,t17.oocql004 , 
       t18.dbadl003 ,t19.dbabl003 ,t20.oocql004 ,t21.pmaal004 ,t22.ooibl004 ,t23.oocql004 ,t24.ooail003 , 
       t25.oofa011 ,t26.ooefl003 ,t27.oofa011 ,t28.ooefl003 ,t29.oofa011 ,t30.oofa011 ,t31.pmaal003 , 
       t32.pmaml003 ,t33.ooidl003",
               " FROM xmee_t",
                              " LEFT JOIN ooefl_t t1 ON t1.ooeflent='"||g_enterprise||"' AND t1.ooefl001=xmeesite AND t1.ooefl002='"||g_dlang||"' ",
               " LEFT JOIN ooefl_t t2 ON t2.ooeflent='"||g_enterprise||"' AND t2.ooefl001=xmee202 AND t2.ooefl002='"||g_dlang||"' ",
               " LEFT JOIN oojdl_t t3 ON t3.oojdlent='"||g_enterprise||"' AND t3.oojdl001=xmee023 AND t3.oojdl002='"||g_dlang||"' ",
               " LEFT JOIN pmaal_t t4 ON t4.pmaalent='"||g_enterprise||"' AND t4.pmaal001=xmee004 AND t4.pmaal002='"||g_dlang||"' ",
               " LEFT JOIN pmaal_t t5 ON t5.pmaalent='"||g_enterprise||"' AND t5.pmaal001=xmee200 AND t5.pmaal002='"||g_dlang||"' ",
               " LEFT JOIN pmaal_t t6 ON t6.pmaalent='"||g_enterprise||"' AND t6.pmaal001=xmee201 AND t6.pmaal002='"||g_dlang||"' ",
               " LEFT JOIN oocql_t t7 ON t7.oocqlent='"||g_enterprise||"' AND t7.oocql001='295' AND t7.oocql002=xmee024 AND t7.oocql003='"||g_dlang||"' ",
               " LEFT JOIN pmaal_t t8 ON t8.pmaalent='"||g_enterprise||"' AND t8.pmaal001=xmee021 AND t8.pmaal002='"||g_dlang||"' ",
               " LEFT JOIN pmaal_t t9 ON t9.pmaalent='"||g_enterprise||"' AND t9.pmaal001=xmee022 AND t9.pmaal002='"||g_dlang||"' ",
               " LEFT JOIN pmaal_t t10 ON t10.pmaalent='"||g_enterprise||"' AND t10.pmaal001=xmee203 AND t10.pmaal002='"||g_dlang||"' ",
               " LEFT JOIN oofa_t t11 ON t11.oofaent='"||g_enterprise||"' AND t11.oofa001=xmee027  ",
               " LEFT JOIN oofa_t t12 ON t12.oofaent='"||g_enterprise||"' AND t12.oofa002='2' AND t12.oofa003=xmee002  ",
               " LEFT JOIN ooefl_t t13 ON t13.ooeflent='"||g_enterprise||"' AND t13.ooefl001=xmee003 AND t13.ooefl002='"||g_dlang||"' ",
               " LEFT JOIN ooefl_t t14 ON t14.ooeflent='"||g_enterprise||"' AND t14.ooefl001=xmeeunit AND t14.ooefl002='"||g_dlang||"' ",
               " LEFT JOIN prcfl_t t15 ON t15.prcflent='"||g_enterprise||"' AND t15.prcfl001=xmee204 AND t15.prcfl002='"||g_dlang||"' ",
               " LEFT JOIN oocql_t t16 ON t16.oocqlent='"||g_enterprise||"' AND t16.oocql001='297' AND t16.oocql002=xmee032 AND t16.oocql003='"||g_dlang||"' ",
               " LEFT JOIN oocql_t t17 ON t17.oocqlent='"||g_enterprise||"' AND t17.oocql001='267' AND t17.oocql002=xmee903 AND t17.oocql003='"||g_dlang||"' ",
               " LEFT JOIN dbadl_t t18 ON t18.dbadlent='"||g_enterprise||"' AND t18.dbadl001=xmee206 AND t18.dbadl002='"||g_dlang||"' ",
               " LEFT JOIN dbabl_t t19 ON t19.dbablent='"||g_enterprise||"' AND t19.dbabl001=xmee207 AND t19.dbabl002='"||g_dlang||"' ",
               " LEFT JOIN oocql_t t20 ON t20.oocqlent='"||g_enterprise||"' AND t20.oocql001='263' AND t20.oocql002=xmee020 AND t20.oocql003='"||g_dlang||"' ",
               " LEFT JOIN pmaal_t t21 ON t21.pmaalent='"||g_enterprise||"' AND t21.pmaal001=xmee036 AND t21.pmaal002='"||g_dlang||"' ",
               " LEFT JOIN ooibl_t t22 ON t22.ooiblent='"||g_enterprise||"' AND t22.ooibl002=xmee009 AND t22.ooibl003='"||g_dlang||"' ",
               " LEFT JOIN oocql_t t23 ON t23.oocqlent='"||g_enterprise||"' AND t23.oocql001='238' AND t23.oocql002=xmee010 AND t23.oocql003='"||g_dlang||"' ",
               " LEFT JOIN ooail_t t24 ON t24.ooailent='"||g_enterprise||"' AND t24.ooail001=xmee015 AND t24.ooail002='"||g_dlang||"' ",
               " LEFT JOIN oofa_t t25 ON t25.oofaent='"||g_enterprise||"' AND t25.oofa002='2' AND t25.oofa003=xmeeownid  ",
               " LEFT JOIN ooefl_t t26 ON t26.ooeflent='"||g_enterprise||"' AND t26.ooefl001=xmeeowndp AND t26.ooefl002='"||g_dlang||"' ",
               " LEFT JOIN oofa_t t27 ON t27.oofaent='"||g_enterprise||"' AND t27.oofa002='2' AND t27.oofa003=xmeecrtid  ",
               " LEFT JOIN ooefl_t t28 ON t28.ooeflent='"||g_enterprise||"' AND t28.ooefl001=xmeecrtdp AND t28.ooefl002='"||g_dlang||"' ",
               " LEFT JOIN oofa_t t29 ON t29.oofaent='"||g_enterprise||"' AND t29.oofa002='2' AND t29.oofa003=xmeemodid  ",
               " LEFT JOIN oofa_t t30 ON t30.oofaent='"||g_enterprise||"' AND t30.oofa002='2' AND t30.oofa003=xmeecnfid  ",
               " LEFT JOIN pmaal_t t31 ON t31.pmaalent='"||g_enterprise||"' AND t31.pmaal001=xmee034 AND t31.pmaal002='"||g_dlang||"' ",
               " LEFT JOIN pmaml_t t32 ON t32.pmamlent='"||g_enterprise||"' AND t32.pmaml001=xmee017 AND t32.pmaml002='"||g_dlang||"' ",
               " LEFT JOIN ooidl_t t33 ON t33.ooidlent='"||g_enterprise||"' AND t33.ooidl001=xmee018 AND t33.ooidl002='"||g_dlang||"' ",
 
               " WHERE xmeeent = '" ||g_enterprise|| "' AND xmeedocno = ? AND xmee900 = ?"
   LET g_sql = cl_sql_add_mask(g_sql)              #遮蔽特定資料
   #add-point:SQL_define
   {<point name="main.after_refresh_sql"/>}
   #end add-point
   PREPARE adbt510_master_referesh FROM g_sql
 
 
 
   
   IF g_bgjob = "Y" THEN
      #add-point:Service Call
      {<point name="main.servicecall" />}
      #end add-point
   ELSE
      #畫面開啟 (identifier)
      OPEN WINDOW w_adbt510 WITH FORM cl_ap_formpath("adb",g_code)
   
      #瀏覽頁簽資料初始化
      CALL cl_ui_init()
   
      #程式初始化
      CALL adbt510_init()   
 
      #進入選單 Menu (="N")
      CALL adbt510_ui_dialog() 
      
      #add-point:畫面關閉前
      {<point name="main.before_close" />}
      #end add-point
 
      #畫面關閉
      CLOSE WINDOW w_adbt510
      
   END IF 
   
   CLOSE adbt510_cl
   
   
 
   #add-point:作業離開前
   {<point name="main.exit" />}
   #end add-point
 
   #離開作業
   CALL cl_ap_exitprogram("0")
   
END MAIN
 
 
]]>
</section>
  <section id="adbt510.modify" ver="59" status="" src="s">
<![CDATA[#+ 資料修改
PRIVATE FUNCTION adbt510_modify()
   DEFINE l_new_key    DYNAMIC ARRAY OF STRING
   DEFINE l_old_key    DYNAMIC ARRAY OF STRING
   DEFINE l_field_key  DYNAMIC ARRAY OF STRING
   #add-point:modify段define
   {<point name="modify.define"/>}
   #end add-point    
   
   IF g_xmee_m.xmeedocno IS NULL
   OR g_xmee_m.xmee900 IS NULL
 
   THEN
      CALL cl_err("","std-00003",0)
      RETURN
   END IF
 
   ERROR ""
  
   LET g_xmeedocno_t = g_xmee_m.xmeedocno
   LET g_xmee900_t = g_xmee_m.xmee900
 
   CALL s_transaction_begin()
   
   OPEN adbt510_cl USING g_enterprise,g_xmee_m.xmeedocno,g_xmee_m.xmee900
   IF STATUS THEN
      CALL cl_err("OPEN adbt510_cl:", STATUS, 1)
      CLOSE adbt510_cl
      CALL s_transaction_end('N','0')
      RETURN
   END IF
 
   #顯示最新的資料
   EXECUTE adbt510_master_referesh USING g_xmee_m.xmeedocno,g_xmee_m.xmee900 INTO g_xmee_m.xmeesite, 
       g_xmee_m.xmee902,g_xmee_m.xmeedocno,g_xmee_m.xmee900,g_xmee_m.xmee901,g_xmee_m.xmee001,g_xmee_m.xmee202, 
       g_xmee_m.xmee023,g_xmee_m.xmee004,g_xmee_m.xmee200,g_xmee_m.xmee201,g_xmee_m.xmeestus,g_xmee_m.xmee005, 
       g_xmee_m.xmee007,g_xmee_m.xmee008,g_xmee_m.xmeedocdt,g_xmee_m.xmee024,g_xmee_m.xmeeacti,g_xmee_m.xmee021, 
       g_xmee_m.xmee022,g_xmee_m.xmee203,g_xmee_m.xmee027,g_xmee_m.xmee002,g_xmee_m.xmee003,g_xmee_m.xmeeunit, 
       g_xmee_m.xmee204,g_xmee_m.xmee205,g_xmee_m.xmee032,g_xmee_m.xmee071,g_xmee_m.xmee903,g_xmee_m.xmee904, 
       g_xmee_m.xmee025,g_xmee_m.xmee026,g_xmee_m.xmee206,g_xmee_m.xmee207,g_xmee_m.xmee020,g_xmee_m.xmee036, 
       g_xmee_m.xmee009,g_xmee_m.xmee010,g_xmee_m.xmee015,g_xmee_m.xmee016,g_xmee_m.xmee011,g_xmee_m.xmee012, 
       g_xmee_m.xmee013,g_xmee_m.xmee035,g_xmee_m.xmee039,g_xmee_m.xmeeownid,g_xmee_m.xmeeowndp,g_xmee_m.xmeecrtid, 
       g_xmee_m.xmeecrtdp,g_xmee_m.xmeecrtdt,g_xmee_m.xmeemodid,g_xmee_m.xmeemoddt,g_xmee_m.xmeecnfid, 
       g_xmee_m.xmeecnfdt,g_xmee_m.xmee034,g_xmee_m.xmee006,g_xmee_m.xmee017,g_xmee_m.xmee041,g_xmee_m.xmee018, 
       g_xmee_m.xmee042,g_xmee_m.xmee019,g_xmee_m.xmee043,g_xmee_m.xmee028,g_xmee_m.xmeesite_desc,g_xmee_m.xmee202_desc, 
       g_xmee_m.xmee023_desc,g_xmee_m.xmee004_desc,g_xmee_m.xmee200_desc,g_xmee_m.xmee201_desc,g_xmee_m.xmee024_desc, 
       g_xmee_m.xmee021_desc,g_xmee_m.xmee022_desc,g_xmee_m.xmee203_desc,g_xmee_m.xmee027_desc,g_xmee_m.xmee002_desc, 
       g_xmee_m.xmee003_desc,g_xmee_m.xmeeunit_desc,g_xmee_m.xmee204_desc,g_xmee_m.xmee032_desc,g_xmee_m.xmee903_desc, 
       g_xmee_m.xmee206_desc,g_xmee_m.xmee207_desc,g_xmee_m.xmee020_desc,g_xmee_m.xmee036_desc,g_xmee_m.xmee009_desc, 
       g_xmee_m.xmee010_desc,g_xmee_m.xmee015_desc,g_xmee_m.xmeeownid_desc,g_xmee_m.xmeeowndp_desc,g_xmee_m.xmeecrtid_desc, 
       g_xmee_m.xmeecrtdp_desc,g_xmee_m.xmeemodid_desc,g_xmee_m.xmeecnfid_desc,g_xmee_m.xmee034_desc, 
       g_xmee_m.xmee017_desc,g_xmee_m.xmee018_desc
 
   #資料被他人LOCK, 或是sql執行時出現錯誤
   IF SQLCA.sqlcode THEN
      CALL cl_err(g_xmee_m.xmeedocno,SQLCA.sqlcode,0)
      CLOSE adbt510_cl
      CALL s_transaction_end('N','0')
      RETURN
   END IF
   
   
   
   #add-point:modify段show之前
   {<point name="modify.before_show"/>}
   #end add-point  
   
   CALL adbt510_show()
   WHILE TRUE
      LET g_xmeedocno_t = g_xmee_m.xmeedocno
      LET g_xmee900_t = g_xmee_m.xmee900
 
      
      #寫入修改者/修改日期資訊(單頭)
      LET g_xmee_m.xmeemodid = g_user 
LET g_xmee_m.xmeemoddt = cl_get_current()
 
      
      #add-point:modify段修改前
      {<point name="modify.before_input"/>}
      #end add-point
      
      #欄位更改
      CALL adbt510_input("u")
 
      #add-point:modify段修改後
      {<point name="modify.after_input"/>}
      #end add-point
      
      IF INT_FLAG THEN
         LET INT_FLAG = 0
         LET g_xmee_m.* = g_xmee_m_t.*
         CALL adbt510_show()
         CALL cl_err('',9001,0)
         CALL s_transaction_end('N','0')
         EXIT WHILE
      END IF 
      
      #若有modid跟moddt則進行update
      UPDATE xmee_t SET (xmeemodid,xmeemoddt) = (g_xmee_m.xmeemodid,g_xmee_m.xmeemoddt)
       WHERE xmeeent = g_enterprise AND xmeedocno = g_xmeedocno_t
         AND xmee900 = g_xmee900_t
 
                  
      #若單頭key欄位有變更
      IF g_xmee_m.xmeedocno != g_xmeedocno_t 
      OR g_xmee_m.xmee900 != g_xmee900_t 
 
      THEN
         CALL s_transaction_begin()
         
         #add-point:單身fk修改前
         {<point name="modify.body.b_fk_update" mark="Y"/>}
         #end add-point
         
         #更新單身key值
         UPDATE xmeg_t SET xmegdocno = g_xmee_m.xmeedocno
                                       ,xmeg900 = g_xmee_m.xmee900
 
          WHERE xmegent = g_enterprise AND xmegdocno = g_xmeedocno_t
            AND xmeg900 = g_xmee900_t
 
            
         #add-point:單身fk修改中
         {<point name="modify.body.m_fk_update"/>}
         #end add-point
 
         CASE
            WHEN SQLCA.sqlerrd[3] = 0  #更新不到的處理
               CALL cl_err("xmeg_t","std-00009",1)
               CALL s_transaction_end('N','0')
               CONTINUE WHILE
            WHEN SQLCA.sqlcode #其他錯誤
               CALL cl_err("xmeg_t",SQLCA.sqlcode,1)  
               CALL s_transaction_end('N','0')
               CONTINUE WHILE
         END CASE
         
         #add-point:單身fk修改後
         {<point name="modify.body.a_fk_update"/>}
         #end add-point
         
         #更新單身key值
         #add-point:單身fk修改前
         {<point name="modify.body.b_fk_update2" mark="Y"/>}
         #end add-point
         UPDATE xmeh_t
            SET xmehdocno = g_xmee_m.xmeedocno
               ,xmeh900 = g_xmee_m.xmee900
 
          WHERE xmehent = g_enterprise AND
                xmehdocno = g_xmeedocno_t
            AND xmeh900 = g_xmee900_t
 
         #add-point:單身fk修改中
         {<point name="modify.body.m_fk_update2"/>}
         #end add-point
         CASE
            WHEN SQLCA.sqlerrd[3] = 0  #更新不到的處理
               CALL cl_err("xmeh_t","std-00009",1)
               CALL s_transaction_end('N','0')
               CONTINUE WHILE
            WHEN SQLCA.sqlcode #其他錯誤
               CALL cl_err("xmeh_t",SQLCA.sqlcode,1)  
               CALL s_transaction_end('N','0')
               CONTINUE WHILE
         END CASE
         #add-point:單身fk修改後
         {<point name="modify.body.a_fk_update2"/>}
         #end add-point
 
         #更新單身key值
         #add-point:單身fk修改前
         {<point name="modify.body.b_fk_update3" mark="Y"/>}
         #end add-point
         UPDATE xmjb_t
            SET xmjbdocno = g_xmee_m.xmeedocno
               ,xmjb900 = g_xmee_m.xmee900
 
          WHERE xmjbent = g_enterprise AND
                xmjbdocno = g_xmeedocno_t
            AND xmjb900 = g_xmee900_t
 
         #add-point:單身fk修改中
         {<point name="modify.body.m_fk_update3"/>}
         #end add-point
         CASE
            WHEN SQLCA.sqlerrd[3] = 0  #更新不到的處理
               CALL cl_err("xmjb_t","std-00009",1)
               CALL s_transaction_end('N','0')
               CONTINUE WHILE
            WHEN SQLCA.sqlcode #其他錯誤
               CALL cl_err("xmjb_t",SQLCA.sqlcode,1)  
               CALL s_transaction_end('N','0')
               CONTINUE WHILE
         END CASE
         #add-point:單身fk修改後
         {<point name="modify.body.a_fk_update3"/>}
         #end add-point
 
         #更新單身key值
         #add-point:單身fk修改前
         {<point name="modify.body.b_fk_update4" mark="Y"/>}
         #end add-point
         UPDATE xmef_t
            SET xmefdocno = g_xmee_m.xmeedocno
               ,xmef900 = g_xmee_m.xmee900
 
          WHERE xmefent = g_enterprise AND
                xmefdocno = g_xmeedocno_t
            AND xmef900 = g_xmee900_t
 
         #add-point:單身fk修改中
         {<point name="modify.body.m_fk_update4"/>}
         #end add-point
         CASE
            WHEN SQLCA.sqlerrd[3] = 0  #更新不到的處理
               CALL cl_err("xmef_t","std-00009",1)
               CALL s_transaction_end('N','0')
               CONTINUE WHILE
            WHEN SQLCA.sqlcode #其他錯誤
               CALL cl_err("xmef_t",SQLCA.sqlcode,1)  
               CALL s_transaction_end('N','0')
               CONTINUE WHILE
         END CASE
         #add-point:單身fk修改後
         {<point name="modify.body.a_fk_update4"/>}
         #end add-point
 
 
         
 
         
         #UPDATE 多語言table key值
         
         
         
         
 
         CALL s_transaction_end('Y','0')
      END IF
    
      EXIT WHILE
   END WHILE
 
   #修改歷程記錄
   #IF NOT cl_log_modified_record(g_xmee_m.xmeedocno,g_site) THEN 
   #   CALL s_transaction_end('N','0')
   #END IF
 
   CLOSE adbt510_cl
   CALL s_transaction_end('Y','0')
 
   #流程通知預埋點-U
   CALL cl_flow_notify(g_xmee_m.xmeedocno,'U')
 
END FUNCTION   
]]>
</section>
  <section id="adbt510.modify_detail_chk" ver="1" status="" src="s">
<![CDATA[#+ 單身輸入判定
PRIVATE FUNCTION adbt510_modify_detail_chk(ps_record)
   DEFINE ps_record STRING
   DEFINE ls_return STRING
   #add-point:modify_detail_chk段define
   {<point name="modify_detail_chk.define"/>}
   #end add-point
   
   #add-point:modify_detail_chk段開始前
   {<point name="modify_detail_chk.before"/>}
   #end add-point
   
   CASE ps_record
      WHEN "s_detail1" 
         LET ls_return = "xmegsite"
      WHEN "s_detail3"
         LET ls_return = "xmehdocno"
      WHEN "s_detail4"
         LET ls_return = "xmjbunit"
      WHEN "s_detail5"
         LET ls_return = "xmefsite"
 
      #add-point:modify_detail_chk段自訂page控制
      {<point name="modify_detail_chk.page_control"/>}
      #end add-point
   END CASE
    
   #add-point:modify_detail_chk段結束前
   {<point name="modify_detail_chk.after"/>}
   #end add-point
   
   RETURN ls_return
   
END FUNCTION
]]>
</section>
  <section id="adbt510.other_dialog" ver="2" status="" src="s">
<![CDATA[   
]]>
</section>
  <section id="adbt510.other_function" ver="2" status="" src="s">
<![CDATA[{<point name="other.function"/>}
]]>
</section>
  <section id="adbt510.query" ver="20" status="" src="s">
<![CDATA[#+ 資料查詢QBE功能準備
PRIVATE FUNCTION adbt510_query()
   DEFINE ls_wc STRING
   #add-point:query段define
   {<point name="query.define"/>}
   #end add-point   
 
   #切換畫面
   IF g_main_hidden THEN
      CALL gfrm_curr.setElementHidden("mainlayout",0)
      CALL gfrm_curr.setElementHidden("worksheet",1)
      LET g_main_hidden = 0
   END IF   
   
   LET ls_wc = g_wc
   
   LET INT_FLAG = 0
   CALL cl_navigator_setting( g_current_idx, g_detail_cnt )
   ERROR ""
   
   #清除畫面及相關資料
   CLEAR FORM
   CALL g_browser.clear()       
   CALL g_xmeg_d.clear()
   CALL g_xmeg3_d.clear()
   CALL g_xmeg4_d.clear()
   CALL g_xmeg5_d.clear()
 
   
   #add-point:query段other
   {<point name="query.other"/>}
   #end add-point   
   
   DISPLAY ' ' TO FORMONLY.idx
   DISPLAY ' ' TO FORMONLY.cnt
   DISPLAY ' ' TO FORMONLY.b_index
   DISPLAY ' ' TO FORMONLY.b_count
   DISPLAY ' ' TO FORMONLY.h_index
   DISPLAY ' ' TO FORMONLY.h_count
   
   CALL adbt510_construct()
 
   IF INT_FLAG THEN
      #取消查詢
      LET INT_FLAG = 0
      LET g_wc = ls_wc
      CALL adbt510_browser_fill("")
      CALL adbt510_fetch("")
      RETURN
   END IF
   
   #儲存WC資訊
   CALL cl_dlg_save_user_latestqry("("||g_wc||") AND ("||g_wc2||")")
   
   #搜尋後資料初始化 
   LET g_detail_cnt  = 0
   LET g_current_idx = 1
   LET g_current_row = 0
   LET g_detail_idx  = 1
   LET g_detail_idx2 = 1
   LET g_error_show  = 1
   LET g_wc_filter   = ""
   LET l_ac = 1
   CALL FGL_SET_ARR_CURR(1)
      CALL adbt510_filter_show('xmeedocno')
   CALL adbt510_filter_show('xmee900')
   CALL adbt510_filter_show('xmeedocdt')
   CALL adbt510_filter_show('xmee001')
   CALL adbt510_filter_show('xmee002')
   CALL adbt510_filter_show('xmee003')
   CALL adbt510_filter_show('xmee004')
   CALL adbt510_browser_fill("F")
         
   IF g_browser_cnt = 0 THEN
      CALL cl_err("","-100",1)
   ELSE
      CALL adbt510_fetch("F") 
   END IF
 
END FUNCTION
]]>
</section>
  <section id="adbt510.ref_show" ver="1" status="" src="s">
<![CDATA[#+ 帶出reference資料
PRIVATE FUNCTION adbt510_ref_show()
   DEFINE l_ac_t LIKE type_t.num10 #l_ac暫存用
   #add-point:ref_show段define
   {<point name="ref_show.define"/>}
   #end add-point
   
   LET l_ac_t = l_ac
   
   #讀入ref值(單頭)
   #add-point:ref_show段m_reference
   {<point name="ref_show.head.reference"/>}
   #end add-point
 
   #讀入ref值(單身)
   FOR l_ac = 1 TO g_xmeg_d.getLength()
      #add-point:ref_show段d_reference
      {<point name="ref_show.body.reference"/>}
      #end add-point
   END FOR
   
   FOR l_ac = 1 TO g_xmeg3_d.getLength()
      #add-point:ref_show段d2_reference
      {<point name="ref_show.body3.reference"/>}
      #end add-point
   END FOR
   FOR l_ac = 1 TO g_xmeg4_d.getLength()
      #add-point:ref_show段d3_reference
      {<point name="ref_show.body4.reference"/>}
      #end add-point
   END FOR
   FOR l_ac = 1 TO g_xmeg5_d.getLength()
      #add-point:ref_show段d4_reference
      {<point name="ref_show.body5.reference"/>}
      #end add-point
   END FOR
 
 
   #add-point:ref_show段自訂
   {<point name="ref_show.other_reference"/>}
   #end add-point
   
   LET l_ac = l_ac_t
 
END FUNCTION
]]>
</section>
  <section id="adbt510.reproduce" ver="18" status="" src="s">
<![CDATA[#+ 資料複製
PRIVATE FUNCTION adbt510_reproduce()
   DEFINE l_newno     LIKE xmee_t.xmeedocno 
   DEFINE l_oldno     LIKE xmee_t.xmeedocno 
   DEFINE l_newno02     LIKE xmee_t.xmee900 
   DEFINE l_oldno02     LIKE xmee_t.xmee900 
 
   DEFINE l_master    RECORD LIKE xmee_t.*
   DEFINE l_detail    RECORD LIKE xmeg_t.*
   DEFINE l_detail2    RECORD LIKE xmeh_t.*
 
   DEFINE l_detail3    RECORD LIKE xmjb_t.*
 
   DEFINE l_detail4    RECORD LIKE xmef_t.*
 
 
 
   DEFINE l_cnt       LIKE type_t.num5
   #add-point:reproduce段define
   {<point name="reproduce.define"/>}
   #end add-point   
 
   #切換畫面
   IF g_main_hidden THEN
      CALL gfrm_curr.setElementHidden("mainlayout",0)
      CALL gfrm_curr.setElementHidden("worksheet",1)
      LET g_main_hidden = 0
   END IF
   
   IF g_xmee_m.xmeedocno IS NULL
   OR g_xmee_m.xmee900 IS NULL
 
   THEN
      CALL cl_err("","std-00003",0)
      RETURN
   END IF
    
   LET g_xmeedocno_t = g_xmee_m.xmeedocno
   LET g_xmee900_t = g_xmee_m.xmee900
 
    
   LET g_xmee_m.xmeedocno = ""
   LET g_xmee_m.xmee900 = ""
 
    
   CALL adbt510_set_entry('a')
   CALL adbt510_set_no_entry('a')
 
   CALL cl_set_head_visible("","YES")
 
   #公用欄位給予預設值
   #此段落由子樣板a14產生    
      LET g_xmee_m.xmeeownid = g_user
      LET g_xmee_m.xmeeowndp = g_dept
      LET g_xmee_m.xmeecrtid = g_user
      LET g_xmee_m.xmeecrtdp = g_dept 
      LET g_xmee_m.xmeecrtdt = cl_get_current()
      LET g_xmee_m.xmeemodid = ""
      LET g_xmee_m.xmeemoddt = ""
      LET g_xmee_m.xmeestus = "N"
 
 
   
   CALL s_transaction_begin()
   
   #add-point:複製輸入前
   {<point name="reproduce.head.b_input"/>}
   #end add-point
   
   CALL adbt510_input("r")
   
   
   
   IF INT_FLAG THEN
      LET INT_FLAG = 0
      RETURN
   END IF
 
   LET g_state = "Y"
   LET g_current_idx = 1 
   
   LET g_wc = g_wc,  
              " OR (",
              " xmeedocno = '", g_xmee_m.xmeedocno CLIPPED, "' "
              ," AND xmee900 = '", g_xmee_m.xmee900 CLIPPED, "' "
 
              , ") "
   
   #add-point:完成複製段落後
   {<point name="reproduce.after_reproduce" />}
   #end add-point
   
END FUNCTION
]]>
</section>
  <section id="adbt510.set_entry" ver="4" status="" src="s">
<![CDATA[#+ 單頭欄位開啟設定
PRIVATE FUNCTION adbt510_set_entry(p_cmd)
   DEFINE p_cmd   LIKE type_t.chr1  
   #add-point:set_entry段define
   {<point name="set_entry.define"/>}
   #end add-point       
 
   IF p_cmd = 'a' THEN
      CALL cl_set_comp_entry("xmeedocno,xmee900",TRUE)
      #add-point:set_entry段欄位控制
      {<point name="set_entry.field_control"/>}
      #end add-point  
   END IF
   
   #add-point:set_entry段欄位控制後
   {<point name="set_entry.after_control"/>}
   #end add-point 
 
END FUNCTION
]]>
</section>
  <section id="adbt510.set_entry_b" ver="4" status="" src="s">
<![CDATA[#+ 單身欄位開啟設定
PRIVATE FUNCTION adbt510_set_entry_b(p_cmd)
   DEFINE p_cmd   LIKE type_t.chr1   
   #add-point:set_entry_b段define
   {<point name="set_entry_b.define"/>}
   #end add-point     
   #add-point:set_entry_b段
   {<point name="set_entry_b.set_entry_b"/>}
   #end add-point  
END FUNCTION
]]>
</section>
  <section id="adbt510.set_no_entry" ver="5" status="" src="s">
<![CDATA[#+ 單頭欄位關閉設定
PRIVATE FUNCTION adbt510_set_no_entry(p_cmd)
   DEFINE p_cmd   LIKE type_t.chr1   
   #add-point:set_no_entry段define
   {<point name="set_no_entry.define"/>}
   #end add-point     
 
   IF p_cmd = 'u' AND g_chkey = 'N' THEN
      CALL cl_set_comp_entry("xmeedocno,xmee900",FALSE)
      #add-point:set_no_entry段欄位控制
      {<point name="set_no_entry.field_control"/>}
      #end add-point 
   END IF 
   
   #add-point:set_no_entry段欄位控制後
   {<point name="set_no_entry.after_control"/>}
   #end add-point 
 
END FUNCTION
]]>
</section>
  <section id="adbt510.set_no_entry_b" ver="4" status="" src="s">
<![CDATA[#+ 單身欄位關閉設定
PRIVATE FUNCTION adbt510_set_no_entry_b(p_cmd)
   DEFINE p_cmd   LIKE type_t.chr1   
   #add-point:set_no_entry_b段define
   {<point name="set_no_entry_b.define"/>}
   #end add-point    
   #add-point:set_no_entry_b段
   {<point name="set_no_entry_b.set_no_entry_b"/>}
   #end add-point     
END FUNCTION
]]>
</section>
  <section id="adbt510.set_pk_array" ver="2" status="" src="s">
<![CDATA[   #+ 此段落由子樣板a51產生
#+ 給予pk_array內容
PRIVATE FUNCTION adbt510_set_pk_array()
   #add-point:set_pk_array段define
   {<point name="set_pk_array.define"/>}
   #end add-point
   
   #add-point:set_pk_array段之前
   {<point name="set_pk_array.before"/>}
   #end add-point  
   
   CALL g_pk_array.clear()
   LET g_pk_array[1].values = g_xmee_m.xmeedocno
   LET g_pk_array[1].column = 'xmeedocno'
   LET g_pk_array[2].values = g_xmee_m.xmee900
   LET g_pk_array[2].column = 'xmee900'
   
   #add-point:set_pk_array段之後
   {<point name="set_pk_array.after"/>}
   #end add-point  
   
END FUNCTION
 
 
]]>
</section>
  <section id="adbt510.show" ver="57" status="" src="s">
<![CDATA[#+ 單頭資料重新顯示及單身資料重抓
PRIVATE FUNCTION adbt510_show()
   DEFINE l_ac_t    LIKE type_t.num5
   #add-point:show段define
   {<point name="show.define"/>}
   #end add-point  
 
   #add-point:show段之前
   {<point name="show.before"/>}
   #end add-point
   
   
   
   IF g_bfill = "Y" THEN
      CALL adbt510_b_fill() #單身填充
      CALL adbt510_b_fill2('0') #單身填充
   END IF
     
   #帶出公用欄位reference值
   #此段落由子樣板a12產生
      #LET g_xmee_m.xmeeownid_desc = cl_get_username(g_xmee_m.xmeeownid)
      #LET g_xmee_m.xmeeowndp_desc = cl_get_deptname(g_xmee_m.xmeeowndp)
      #LET g_xmee_m.xmeecrtid_desc = cl_get_username(g_xmee_m.xmeecrtid)
      #LET g_xmee_m.xmeecrtdp_desc = cl_get_deptname(g_xmee_m.xmeecrtdp)
      #LET g_xmee_m.xmeemodid_desc = cl_get_username(g_xmee_m.xmeemodid)
      #LET g_xmee_m.xmeecnfid_desc = cl_get_deptname(g_xmee_m.xmeecnfid)
      
 
 
   
   #顯示followup圖示
   #+ 此段落由子樣板a48產生
   CALL adbt510_set_pk_array()
   #add-point:ON ACTION agendum
   {<point name="show.follow_pic"/>}
   #END add-point
   CALL cl_user_overview_set_follow_pic()
 
 
   
   LET l_ac_t = l_ac
   
   #讀入ref值(單頭)
   #add-point:show段reference
   {<point name="show.head.reference"/>}
   #end add-point
   
   #將資料輸出到畫面上
   DISPLAY BY NAME g_xmee_m.xmeesite,g_xmee_m.xmeesite_desc,g_xmee_m.xmee902,g_xmee_m.xmeedocno,g_xmee_m.xmee900, 
       g_xmee_m.xmee901,g_xmee_m.xmee001,g_xmee_m.xmee202,g_xmee_m.xmee202_desc,g_xmee_m.xmee023,g_xmee_m.xmee023_desc, 
       g_xmee_m.xmee004,g_xmee_m.xmee004_desc,g_xmee_m.xmee200,g_xmee_m.xmee200_desc,g_xmee_m.xmee201, 
       g_xmee_m.xmee201_desc,g_xmee_m.xmeestus,g_xmee_m.xmee005,g_xmee_m.xmee007,g_xmee_m.xmee008,g_xmee_m.xmeedocdt, 
       g_xmee_m.xmee024,g_xmee_m.xmee024_desc,g_xmee_m.xmeeacti,g_xmee_m.xmee021,g_xmee_m.xmee021_desc, 
       g_xmee_m.xmee022,g_xmee_m.xmee022_desc,g_xmee_m.xmee203,g_xmee_m.xmee203_desc,g_xmee_m.xmee027, 
       g_xmee_m.xmee027_desc,g_xmee_m.xmee002,g_xmee_m.xmee002_desc,g_xmee_m.xmee003,g_xmee_m.xmee003_desc, 
       g_xmee_m.xmeeunit,g_xmee_m.xmeeunit_desc,g_xmee_m.xmee204,g_xmee_m.xmee204_desc,g_xmee_m.xmee205, 
       g_xmee_m.xmee032,g_xmee_m.xmee032_desc,g_xmee_m.xmee071,g_xmee_m.xmee903,g_xmee_m.xmee903_desc, 
       g_xmee_m.xmee904,g_xmee_m.xmee025,g_xmee_m.xmee025_desc,g_xmee_m.oofb017,g_xmee_m.xmee026,g_xmee_m.xmee026_desc, 
       g_xmee_m.oofb017_1,g_xmee_m.xmee206,g_xmee_m.xmee206_desc,g_xmee_m.xmee207,g_xmee_m.xmee207_desc, 
       g_xmee_m.xmee020,g_xmee_m.xmee020_desc,g_xmee_m.xmee036,g_xmee_m.xmee036_desc,g_xmee_m.xmee009, 
       g_xmee_m.xmee009_desc,g_xmee_m.xmee010,g_xmee_m.xmee010_desc,g_xmee_m.xmee015,g_xmee_m.xmee015_desc, 
       g_xmee_m.xmee016,g_xmee_m.xmee011,g_xmee_m.xmee011_desc,g_xmee_m.xmee012,g_xmee_m.xmee013,g_xmee_m.xmee035, 
       g_xmee_m.xmee035_desc,g_xmee_m.isaf011,g_xmee_m.xmee039,g_xmee_m.xmeeownid,g_xmee_m.xmeeownid_desc, 
       g_xmee_m.xmeeowndp,g_xmee_m.xmeeowndp_desc,g_xmee_m.xmeecrtid,g_xmee_m.xmeecrtid_desc,g_xmee_m.xmeecrtdp, 
       g_xmee_m.xmeecrtdp_desc,g_xmee_m.xmeecrtdt,g_xmee_m.xmeemodid,g_xmee_m.xmeemodid_desc,g_xmee_m.xmeemoddt, 
       g_xmee_m.xmeecnfid,g_xmee_m.xmeecnfid_desc,g_xmee_m.xmeecnfdt,g_xmee_m.xmee034,g_xmee_m.xmee034_desc, 
       g_xmee_m.xmee006,g_xmee_m.xmee017,g_xmee_m.xmee017_desc,g_xmee_m.xmee041,g_xmee_m.xmee018,g_xmee_m.xmee018_desc, 
       g_xmee_m.xmee042,g_xmee_m.xmee019,g_xmee_m.xmee043,g_xmee_m.xmee028
   
   #顯示狀態(stus)圖片
         #此段落由子樣板a21產生
      CASE g_xmee_m.xmeestus
         WHEN "N"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/unconfirmed.png")
         WHEN "X"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/invalid.png")
         WHEN "Y"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/confirmed.png")
         WHEN "A"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/approved.png")
         WHEN "D"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/withdraw.png")
         WHEN "R"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/rejection.png")
         WHEN "W"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/signing.png")
         
      END CASE
 
 
   
   #讀入ref值(單身)
   FOR l_ac = 1 TO g_xmeg_d.getLength()
      #add-point:show段單身reference
      {<point name="show.body.reference"/>}
      #end add-point
   END FOR
   
   FOR l_ac = 1 TO g_xmeg3_d.getLength()
      #add-point:show段單身reference
      {<point name="show.body3.reference"/>}
      #end add-point
   END FOR
   FOR l_ac = 1 TO g_xmeg4_d.getLength()
      #add-point:show段單身reference
      {<point name="show.body4.reference"/>}
      #end add-point
   END FOR
   FOR l_ac = 1 TO g_xmeg5_d.getLength()
      #add-point:show段單身reference
      {<point name="show.body5.reference"/>}
      #end add-point
   END FOR
 
   
    
   
   #add-point:show段other
   {<point name="show.other"/>}
   #end add-point  
   
   LET l_ac = l_ac_t
   
   #移動上下筆可以連動切換資料
   CALL cl_show_fld_cont()     
 
   CALL adbt510_detail_show()
   
   #add-point:show段之後
   {<point name="show.after"/>}
   #end add-point
   
END FUNCTION
]]>
</section>
  <section id="adbt510.signature" ver="23" status="" src="s">
<![CDATA[   #此段落由子樣板a39產生
#+ BPM提交
PRIVATE FUNCTION adbt510_send()
 
   #add-point:send段define
   {<point name="send.define"/>}
   #end add-point 
 
   IF g_xmee_m.xmeedocno IS NULL
   OR g_xmee_m.xmee900 IS NULL
   THEN
      CALL cl_err("","std-00003",0)
      RETURN FALSE
   END IF
 
   #重新取得與顯示完整單據資料(最新單據資料)
   EXECUTE adbt510_master_referesh USING g_xmee_m.xmeedocno,g_xmee_m.xmee900 INTO g_xmee_m.xmeesite, 
       g_xmee_m.xmee902,g_xmee_m.xmeedocno,g_xmee_m.xmee900,g_xmee_m.xmee901,g_xmee_m.xmee001,g_xmee_m.xmee202, 
       g_xmee_m.xmee023,g_xmee_m.xmee004,g_xmee_m.xmee200,g_xmee_m.xmee201,g_xmee_m.xmeestus,g_xmee_m.xmee005, 
       g_xmee_m.xmee007,g_xmee_m.xmee008,g_xmee_m.xmeedocdt,g_xmee_m.xmee024,g_xmee_m.xmeeacti,g_xmee_m.xmee021, 
       g_xmee_m.xmee022,g_xmee_m.xmee203,g_xmee_m.xmee027,g_xmee_m.xmee002,g_xmee_m.xmee003,g_xmee_m.xmeeunit, 
       g_xmee_m.xmee204,g_xmee_m.xmee205,g_xmee_m.xmee032,g_xmee_m.xmee071,g_xmee_m.xmee903,g_xmee_m.xmee904, 
       g_xmee_m.xmee025,g_xmee_m.xmee026,g_xmee_m.xmee206,g_xmee_m.xmee207,g_xmee_m.xmee020,g_xmee_m.xmee036, 
       g_xmee_m.xmee009,g_xmee_m.xmee010,g_xmee_m.xmee015,g_xmee_m.xmee016,g_xmee_m.xmee011,g_xmee_m.xmee012, 
       g_xmee_m.xmee013,g_xmee_m.xmee035,g_xmee_m.xmee039,g_xmee_m.xmeeownid,g_xmee_m.xmeeowndp,g_xmee_m.xmeecrtid, 
       g_xmee_m.xmeecrtdp,g_xmee_m.xmeecrtdt,g_xmee_m.xmeemodid,g_xmee_m.xmeemoddt,g_xmee_m.xmeecnfid, 
       g_xmee_m.xmeecnfdt,g_xmee_m.xmee034,g_xmee_m.xmee006,g_xmee_m.xmee017,g_xmee_m.xmee041,g_xmee_m.xmee018, 
       g_xmee_m.xmee042,g_xmee_m.xmee019,g_xmee_m.xmee043,g_xmee_m.xmee028,g_xmee_m.xmeesite_desc,g_xmee_m.xmee202_desc, 
       g_xmee_m.xmee023_desc,g_xmee_m.xmee004_desc,g_xmee_m.xmee200_desc,g_xmee_m.xmee201_desc,g_xmee_m.xmee024_desc, 
       g_xmee_m.xmee021_desc,g_xmee_m.xmee022_desc,g_xmee_m.xmee203_desc,g_xmee_m.xmee027_desc,g_xmee_m.xmee002_desc, 
       g_xmee_m.xmee003_desc,g_xmee_m.xmeeunit_desc,g_xmee_m.xmee204_desc,g_xmee_m.xmee032_desc,g_xmee_m.xmee903_desc, 
       g_xmee_m.xmee206_desc,g_xmee_m.xmee207_desc,g_xmee_m.xmee020_desc,g_xmee_m.xmee036_desc,g_xmee_m.xmee009_desc, 
       g_xmee_m.xmee010_desc,g_xmee_m.xmee015_desc,g_xmee_m.xmeeownid_desc,g_xmee_m.xmeeowndp_desc,g_xmee_m.xmeecrtid_desc, 
       g_xmee_m.xmeecrtdp_desc,g_xmee_m.xmeemodid_desc,g_xmee_m.xmeecnfid_desc,g_xmee_m.xmee034_desc, 
       g_xmee_m.xmee017_desc,g_xmee_m.xmee018_desc
 
   ERROR ""
   
   CALL s_transaction_begin()
 
   OPEN adbt510_cl USING g_enterprise,g_xmee_m.xmeedocno,g_xmee_m.xmee900
   IF STATUS THEN
      CALL cl_err("OPEN adbt510_cl:", STATUS, 1)
      CLOSE adbt510_cl
      CALL s_transaction_end('N','0')
      RETURN FALSE
   END IF
 
   #鎖住將被更改的資料
   FETCH adbt510_cl INTO g_xmee_m.xmeesite,g_xmee_m.xmeesite_desc,g_xmee_m.xmee902,g_xmee_m.xmeedocno, 
       g_xmee_m.xmee900,g_xmee_m.xmee901,g_xmee_m.xmee001,g_xmee_m.xmee202,g_xmee_m.xmee202_desc,g_xmee_m.xmee023, 
       g_xmee_m.xmee023_desc,g_xmee_m.xmee004,g_xmee_m.xmee004_desc,g_xmee_m.xmee200,g_xmee_m.xmee200_desc, 
       g_xmee_m.xmee201,g_xmee_m.xmee201_desc,g_xmee_m.xmeestus,g_xmee_m.xmee005,g_xmee_m.xmee007,g_xmee_m.xmee008, 
       g_xmee_m.xmeedocdt,g_xmee_m.xmee024,g_xmee_m.xmee024_desc,g_xmee_m.xmeeacti,g_xmee_m.xmee021, 
       g_xmee_m.xmee021_desc,g_xmee_m.xmee022,g_xmee_m.xmee022_desc,g_xmee_m.xmee203,g_xmee_m.xmee203_desc, 
       g_xmee_m.xmee027,g_xmee_m.xmee027_desc,g_xmee_m.xmee002,g_xmee_m.xmee002_desc,g_xmee_m.xmee003, 
       g_xmee_m.xmee003_desc,g_xmee_m.xmeeunit,g_xmee_m.xmeeunit_desc,g_xmee_m.xmee204,g_xmee_m.xmee204_desc, 
       g_xmee_m.xmee205,g_xmee_m.xmee032,g_xmee_m.xmee032_desc,g_xmee_m.xmee071,g_xmee_m.xmee903,g_xmee_m.xmee903_desc, 
       g_xmee_m.xmee904,g_xmee_m.xmee025,g_xmee_m.xmee025_desc,g_xmee_m.oofb017,g_xmee_m.xmee026,g_xmee_m.xmee026_desc, 
       g_xmee_m.oofb017_1,g_xmee_m.xmee206,g_xmee_m.xmee206_desc,g_xmee_m.xmee207,g_xmee_m.xmee207_desc, 
       g_xmee_m.xmee020,g_xmee_m.xmee020_desc,g_xmee_m.xmee036,g_xmee_m.xmee036_desc,g_xmee_m.xmee009, 
       g_xmee_m.xmee009_desc,g_xmee_m.xmee010,g_xmee_m.xmee010_desc,g_xmee_m.xmee015,g_xmee_m.xmee015_desc, 
       g_xmee_m.xmee016,g_xmee_m.xmee011,g_xmee_m.xmee011_desc,g_xmee_m.xmee012,g_xmee_m.xmee013,g_xmee_m.xmee035, 
       g_xmee_m.xmee035_desc,g_xmee_m.isaf011,g_xmee_m.xmee039,g_xmee_m.xmeeownid,g_xmee_m.xmeeownid_desc, 
       g_xmee_m.xmeeowndp,g_xmee_m.xmeeowndp_desc,g_xmee_m.xmeecrtid,g_xmee_m.xmeecrtid_desc,g_xmee_m.xmeecrtdp, 
       g_xmee_m.xmeecrtdp_desc,g_xmee_m.xmeecrtdt,g_xmee_m.xmeemodid,g_xmee_m.xmeemodid_desc,g_xmee_m.xmeemoddt, 
       g_xmee_m.xmeecnfid,g_xmee_m.xmeecnfid_desc,g_xmee_m.xmeecnfdt,g_xmee_m.xmee034,g_xmee_m.xmee034_desc, 
       g_xmee_m.xmee006,g_xmee_m.xmee017,g_xmee_m.xmee017_desc,g_xmee_m.xmee041,g_xmee_m.xmee018,g_xmee_m.xmee018_desc, 
       g_xmee_m.xmee042,g_xmee_m.xmee019,g_xmee_m.xmee043,g_xmee_m.xmee028
   
   #資料被他人LOCK, 或是sql執行時出現錯誤
   IF SQLCA.sqlcode THEN
      CALL cl_err(g_xmee_m.xmeedocno,SQLCA.sqlcode,0)
      CLOSE adbt510_cl
      CALL s_transaction_end('N','0')
      RETURN FALSE
   END IF
 
   #依據單據個數，需要指定所有單身條件為" 1=1"  (單身有幾個就要設幾個)
   LET g_wc2_table1 = " 1=1"
   LET g_wc2_table2 = " 1=1"
   LET g_wc2_table3 = " 1=1"
   LET g_wc2_table4 = " 1=1"
 
 
   CALL adbt510_show()
   CALL adbt510_set_pk_array()
   
   #add-point: 提交前的ADP
   {<point name="send.before_send" />}
   #end add-point
   
   #公用變數初始化
   CALL cl_bpm_data_init()
                  
   #依照主檔/單身個數產生 CALL cl_bpm_set_master_data() / cl_bpm_set_detail_data() 
   #單頭固定為 CALL cl_bpm_set_master_data(util.JSONObject.fromFGL(xxxx)) 傳入參數: (1)單頭陣列  ; 回傳值: 無
   CALL cl_bpm_set_master_data(util.JSONObject.fromFGL(g_xmee_m))
                              
   #單身固定為 CALL cl_bpm_set_detail_data(s_detailX, util.JSONArray.fromFGL(xxxx)) 傳入參數: (1)單身SR名稱  (2)單身陣列  ; 回傳值: 無
   CALL cl_bpm_set_detail_data("s_detail1", util.JSONArray.fromFGL(g_xmeg_d))
   CALL cl_bpm_set_detail_data("s_detail3", util.JSONArray.fromFGL(g_xmeg3_d))   CALL cl_bpm_set_detail_data("s_detail4", util.JSONArray.fromFGL(g_xmeg4_d))   CALL cl_bpm_set_detail_data("s_detail5", util.JSONArray.fromFGL(g_xmeg5_d))
 
   # cl_bpm_cli() 裡有包含以前的aws_condition()=>送簽資料檢核和更新單據狀況碼為'W'
   # cl_bpm_cli() 傳入參數:無  ;  回傳值: 0 開單失敗; 1 開單成功
 
   #開單失敗
   IF NOT cl_bpm_cli() THEN 
      CLOSE adbt510_cl
      CALL s_transaction_end('N','0')
      RETURN FALSE
   END IF
 
   #add-point: 提交後的ADP
   {<point name="send.after_send" />}
   #end add-point
   
   #完成狀態更新
   CLOSE adbt510_cl
   CALL s_transaction_end('Y','0')
             
   #此段落不需要刪除資料,但是否需要refresh圖片樣式???
   #CALL adbt510_ui_browser_refresh()
 
   #重新指定此筆單據資料狀態圖片=>送簽中
   LET g_browser[g_current_row].b_statepic = "stus/16/signing.png"
 
   #重新取得單頭/單身資料,DISPLAY在畫面上
   CALL adbt510_ui_headershow()
   CALL adbt510_ui_detailshow()
 
   RETURN TRUE
   
END FUNCTION
 
 
#此段落由子樣板a40產生
#+ BPM抽單
PRIVATE FUNCTION adbt510_draw_out()
 
   #add-point:draw段define
   {<point name="draw.define"/>}
   #end add-point
 
   #檢查資料是否存在
   IF g_xmee_m.xmeedocno IS NULL
   OR g_xmee_m.xmee900 IS NULL
   THEN
      CALL cl_err("","std-00003",0)
      RETURN FALSE
   END IF
 
   #LOCK主檔資料
   CALL s_transaction_begin()
 
   #進行BPM抽單功能
   OPEN adbt510_cl USING g_enterprise,g_xmee_m.xmeedocno,g_xmee_m.xmee900
   IF STATUS THEN
      CALL cl_err("OPEN adbt510_cl:", STATUS, 1)
      CLOSE adbt510_cl
      CALL s_transaction_end('N','0')
      RETURN FALSE
   END IF
 
   #鎖住將被更改的資料
   FETCH adbt510_cl INTO g_xmee_m.xmeesite,g_xmee_m.xmeesite_desc,g_xmee_m.xmee902,g_xmee_m.xmeedocno, 
       g_xmee_m.xmee900,g_xmee_m.xmee901,g_xmee_m.xmee001,g_xmee_m.xmee202,g_xmee_m.xmee202_desc,g_xmee_m.xmee023, 
       g_xmee_m.xmee023_desc,g_xmee_m.xmee004,g_xmee_m.xmee004_desc,g_xmee_m.xmee200,g_xmee_m.xmee200_desc, 
       g_xmee_m.xmee201,g_xmee_m.xmee201_desc,g_xmee_m.xmeestus,g_xmee_m.xmee005,g_xmee_m.xmee007,g_xmee_m.xmee008, 
       g_xmee_m.xmeedocdt,g_xmee_m.xmee024,g_xmee_m.xmee024_desc,g_xmee_m.xmeeacti,g_xmee_m.xmee021, 
       g_xmee_m.xmee021_desc,g_xmee_m.xmee022,g_xmee_m.xmee022_desc,g_xmee_m.xmee203,g_xmee_m.xmee203_desc, 
       g_xmee_m.xmee027,g_xmee_m.xmee027_desc,g_xmee_m.xmee002,g_xmee_m.xmee002_desc,g_xmee_m.xmee003, 
       g_xmee_m.xmee003_desc,g_xmee_m.xmeeunit,g_xmee_m.xmeeunit_desc,g_xmee_m.xmee204,g_xmee_m.xmee204_desc, 
       g_xmee_m.xmee205,g_xmee_m.xmee032,g_xmee_m.xmee032_desc,g_xmee_m.xmee071,g_xmee_m.xmee903,g_xmee_m.xmee903_desc, 
       g_xmee_m.xmee904,g_xmee_m.xmee025,g_xmee_m.xmee025_desc,g_xmee_m.oofb017,g_xmee_m.xmee026,g_xmee_m.xmee026_desc, 
       g_xmee_m.oofb017_1,g_xmee_m.xmee206,g_xmee_m.xmee206_desc,g_xmee_m.xmee207,g_xmee_m.xmee207_desc, 
       g_xmee_m.xmee020,g_xmee_m.xmee020_desc,g_xmee_m.xmee036,g_xmee_m.xmee036_desc,g_xmee_m.xmee009, 
       g_xmee_m.xmee009_desc,g_xmee_m.xmee010,g_xmee_m.xmee010_desc,g_xmee_m.xmee015,g_xmee_m.xmee015_desc, 
       g_xmee_m.xmee016,g_xmee_m.xmee011,g_xmee_m.xmee011_desc,g_xmee_m.xmee012,g_xmee_m.xmee013,g_xmee_m.xmee035, 
       g_xmee_m.xmee035_desc,g_xmee_m.isaf011,g_xmee_m.xmee039,g_xmee_m.xmeeownid,g_xmee_m.xmeeownid_desc, 
       g_xmee_m.xmeeowndp,g_xmee_m.xmeeowndp_desc,g_xmee_m.xmeecrtid,g_xmee_m.xmeecrtid_desc,g_xmee_m.xmeecrtdp, 
       g_xmee_m.xmeecrtdp_desc,g_xmee_m.xmeecrtdt,g_xmee_m.xmeemodid,g_xmee_m.xmeemodid_desc,g_xmee_m.xmeemoddt, 
       g_xmee_m.xmeecnfid,g_xmee_m.xmeecnfid_desc,g_xmee_m.xmeecnfdt,g_xmee_m.xmee034,g_xmee_m.xmee034_desc, 
       g_xmee_m.xmee006,g_xmee_m.xmee017,g_xmee_m.xmee017_desc,g_xmee_m.xmee041,g_xmee_m.xmee018,g_xmee_m.xmee018_desc, 
       g_xmee_m.xmee042,g_xmee_m.xmee019,g_xmee_m.xmee043,g_xmee_m.xmee028
   
   #資料被他人LOCK, 或是sql執行時出現錯誤
   IF SQLCA.sqlcode THEN
      CALL cl_err(g_xmee_m.xmeedocno,SQLCA.sqlcode,0)
      CLOSE adbt510_cl
      CALL s_transaction_end('N','0')
      RETURN FALSE
   END IF
 
   #抽單失敗
   IF NOT cl_bpm_draw_out() THEN 
      CLOSE adbt510_cl
      CALL s_transaction_end('N','0')
      RETURN FALSE
   END IF    
 
   #完成狀態更新
   CLOSE adbt510_cl
   CALL s_transaction_end('Y','0')
          
   #重新指定此筆單據資料狀態圖片=>抽單
   LET g_browser[g_current_row].b_statepic = "stus/16/draw_out.png"
 
   #重新取得單頭/單身資料,DISPLAY在畫面上
   CALL adbt510_ui_headershow()  
   CALL adbt510_ui_detailshow()
 
   RETURN TRUE
   
END FUNCTION
 
 
 
]]>
</section>
  <section id="adbt510.state_change" ver="15" status="" src="s">
<![CDATA[   #+ 此段落由子樣板a09產生
#+ 確認碼變更
PRIVATE FUNCTION adbt510_statechange()
   DEFINE lc_state LIKE type_t.chr5
   #add-point:statechange段define
   {<point name="statechange.define"/>}
   #end add-point  
   
   #add-point:statechange段開始前
   {<point name="statechange.before"/>}
   #end add-point  
   
   ERROR ""     #清空畫面右下側ERROR區塊
 
   IF g_xmee_m.xmeedocno IS NULL
      OR g_xmee_m.xmee900 IS NULL
   THEN
      CALL cl_err("","std-00003",0)
      RETURN
   END IF
 
   MENU "" ATTRIBUTES (STYLE="popup")
      BEFORE MENU
         HIDE OPTION "approved"
         HIDE OPTION "rejection"
         CASE g_xmee_m.xmeestus
            WHEN "N"
               HIDE OPTION "unconfirmed"
            WHEN "X"
               HIDE OPTION "invalid"
            WHEN "Y"
               HIDE OPTION "confirmed"
            WHEN "A"
               HIDE OPTION "approved"
            WHEN "D"
               HIDE OPTION "withdraw"
            WHEN "R"
               HIDE OPTION "rejection"
            WHEN "W"
               HIDE OPTION "signing"
            
         END CASE
     
      #add-point:menu前
      {<point name="statechange.before_menu"/>}
      #end add-point
      
      ON ACTION unconfirmed
         LET lc_state = "N"
         #add-point:action控制
         {<point name="statechange.unconfirmed"/>}
         #end add-point
         EXIT MENU
      ON ACTION invalid
         LET lc_state = "X"
         #add-point:action控制
         {<point name="statechange.invalid"/>}
         #end add-point
         EXIT MENU
      ON ACTION confirmed
         LET lc_state = "Y"
         #add-point:action控制
         {<point name="statechange.confirmed"/>}
         #end add-point
         EXIT MENU
      ON ACTION approved
         LET lc_state = "A"
         #add-point:action控制
         {<point name="statechange.approved"/>}
         #end add-point
         EXIT MENU
      #ON ACTION withdraw
      #   LET lc_state = "D"
      #   #add-point:action控制
      #   {<point name="statechange.withdraw"/>}
      #   #end add-point
      #   EXIT MENU
      ON ACTION rejection
         LET lc_state = "R"
         #add-point:action控制
         {<point name="statechange.rejection"/>}
         #end add-point
         EXIT MENU
      #ON ACTION signing
      #   LET lc_state = "W"
      #   #add-point:action控制
      #   {<point name="statechange.signing"/>}
      #   #end add-point
      #   EXIT MENU
      
      #此段落由子樣板a36產生
      #提交
      ON ACTION signing
         IF cl_auth_chk_act("signing") THEN
            IF NOT adbt510_send() THEN
               RETURN
            END IF
         END IF
         LET lc_state = ''   #因為_send()已有執行update動作
 
         EXIT MENU
 
      #抽單
      ON ACTION withdraw
         IF cl_auth_chk_act("withdraw") THEN
            IF NOT adbt510_draw_out() THEN
               RETURN
            END IF
         END IF
         LET lc_state = ''   #因為_draw_out()已有執行update動作
         EXIT MENU
 
 
      
      #add-point:stus控制
      {<point name="statechange.more_control"/>}
      #end add-point
      
   END MENU
   
   IF (lc_state <> "N" 
      AND lc_state <> "X"
      AND lc_state <> "Y"
      AND lc_state <> "A"
      AND lc_state <> "D"
      AND lc_state <> "R"
      AND lc_state <> "W"
      ) OR 
      cl_null(lc_state) THEN
      RETURN
   END IF
   
   #add-point:stus修改前
   {<point name="statechange.b_update"/>}
   #end add-point
      
   UPDATE xmee_t SET xmeestus = lc_state 
    WHERE xmeeent = g_enterprise AND xmeedocno = g_xmee_m.xmeedocno
      AND xmee900 = g_xmee_m.xmee900
  
   IF SQLCA.sqlcode THEN
      CALL cl_err("",SQLCA.sqlcode,0)
   ELSE
      CASE lc_state
         WHEN "N"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/unconfirmed.png")
         WHEN "X"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/invalid.png")
         WHEN "Y"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/confirmed.png")
         WHEN "A"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/approved.png")
         WHEN "D"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/withdraw.png")
         WHEN "R"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/rejection.png")
         WHEN "W"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/signing.png")
         
      END CASE
      LET g_xmee_m.xmeestus = lc_state
      DISPLAY BY NAME g_xmee_m.xmeestus
   END IF
 
   #add-point:stus修改後
   {<point name="statechange.a_update"/>}
   #end add-point
 
   #add-point:statechange段結束前
   {<point name="statechange.after"/>}
   #end add-point  
 
END FUNCTION
 
 
]]>
</section>
  <section id="adbt510.ui_browser_refresh" ver="5" status="" src="s">
<![CDATA[#+ 瀏覽頁簽資料重新顯示
PRIVATE FUNCTION adbt510_ui_browser_refresh()
   DEFINE l_i  LIKE type_t.num10
   #add-point:ui_browser_refresh段define
   {<point name="ui_browser_refresh.define"/>}
   #end add-point    
   
   FOR l_i =1 TO g_browser.getLength()
      IF g_browser[l_i].b_xmeedocno = g_xmee_m.xmeedocno 
         AND g_browser[l_i].b_xmee900 = g_xmee_m.xmee900 
 
         THEN  
         CALL g_browser.deleteElement(l_i)
         LET g_header_cnt = g_header_cnt - 1
         EXIT FOR
      END IF
   END FOR
 
   LET g_browser_cnt = g_browser_cnt - 1
   IF g_current_row > g_browser_cnt THEN        #確定browse 筆數指在同一筆
      LET g_current_row = g_browser_cnt
   END IF
 
   #DISPLAY g_browser_cnt TO FORMONLY.b_count    #總筆數的顯示
   
END FUNCTION
]]>
</section>
  <section id="adbt510.ui_detailshow" ver="12" status="" src="s">
<![CDATA[#+ 單身資料重新顯示
PRIVATE FUNCTION adbt510_ui_detailshow()
   #add-point:ui_detailshow段define
   {<point name="ui_detailshow.define"/>}
   #end add-point    
   
   #add-point:ui_detailshow段before
   {<point name="ui_detailshow.before"/>}
   #end add-point    
   
   IF g_curr_diag IS NOT NULL THEN
      CALL g_curr_diag.setCurrentRow("s_detail1",g_detail_idx)      
      CALL g_curr_diag.setCurrentRow("s_detail3",g_detail_idx)
      CALL g_curr_diag.setCurrentRow("s_detail4",g_detail_idx)
      CALL g_curr_diag.setCurrentRow("s_detail5",g_detail_idx)
 
   END IF
   
   #add-point:ui_detailshow段after
   {<point name="ui_detailshow.after"/>}
   #end add-point    
   
END FUNCTION
]]>
</section>
  <section id="adbt510.ui_dialog" ver="160" status="" src="s">
<![CDATA[#+ 功能選單
PRIVATE FUNCTION adbt510_ui_dialog()
   DEFINE li_idx    LIKE type_t.num5
   DEFINE ls_wc     STRING
   DEFINE lb_first  BOOLEAN
   DEFINE la_param  RECORD
             prog   STRING,
             param  DYNAMIC ARRAY OF STRING
                    END RECORD
   DEFINE ls_js     STRING
   #add-point:ui_dialog段define
   {<point name="ui_dialog.define"/>}
   #end add-point
   
   CALL cl_set_act_visible("accept,cancel", FALSE)
 
   CALL gfrm_curr.setElementImage("logo","logo/applogo.png") 
   IF g_default THEN
      CALL gfrm_curr.setElementHidden("mainlayout",0)
      CALL gfrm_curr.setElementHidden("worksheet",1)
      LET g_main_hidden = 0
   ELSE
      CALL gfrm_curr.setElementHidden("mainlayout",1)
      CALL gfrm_curr.setElementHidden("worksheet",0)
      LET g_main_hidden = 1
   END IF
   
   #action default動作
   #+ 此段落由子樣板a42產生
   CASE g_actdefault
      WHEN "insert"
         LET g_action_choice="insert"
         LET g_actdefault = ""
         IF cl_auth_chk_act("insert") THEN
            CALL adbt510_insert()
            #add-point:ON ACTION insert
            {<point name="menu.default.insert" />}
            #END add-point
         END IF
 
      #add-point:action default自訂
      {<point name="ui_dialog.action_default"/>}
      #end add-point
      OTHERWISE
         
   END CASE
 
 
   
   LET lb_first = TRUE
   
   #add-point:ui_dialog段before dialog 
   {<point name="ui_dialog.before_dialog"/>}
   #end add-point
   
   WHILE TRUE 
   
      CALL adbt510_browser_fill("")
      CALL lib_cl_dlg.cl_dlg_before_display()
      CALL cl_notice()
            
      #判斷前一個動作是否為新增, 若是的話切換到新增的筆數
      IF g_state = "Y" THEN
         FOR li_idx = 1 TO g_browser.getLength()
            IF g_browser[li_idx].b_xmeedocno = g_xmeedocno_t
               AND g_browser[li_idx].b_xmee900 = g_xmee900_t
 
               THEN
               LET g_current_row = li_idx
               LET g_current_idx = li_idx
               EXIT FOR
            END IF
         END FOR
         LET g_state = ""
      END IF
            
      DIALOG ATTRIBUTES(UNBUFFERED,FIELD ORDER FORM)
 
         #左側瀏覽頁簽
         DISPLAY ARRAY g_browser TO s_browse.* ATTRIBUTES(COUNT=g_header_cnt)
 
            BEFORE ROW
               #回歸舊筆數位置 (回到當時異動的筆數)
               LET g_current_idx = DIALOG.getCurrentRow("s_browse")
               IF g_current_row > 1 AND g_current_idx = 1 AND g_current_sw = FALSE THEN
                  CALL DIALOG.setCurrentRow("s_browse",g_current_row)
                  LET g_current_idx = g_current_row
               END IF
               LET g_current_row = g_current_idx #目前指標
               LET g_current_sw = TRUE
 
               IF g_current_idx > g_browser.getLength() THEN
                  LET g_current_idx = g_browser.getLength()
               END IF 
               
               CALL adbt510_fetch('') # reload data
               LET l_ac = 1
               CALL adbt510_ui_detailshow() #Setting the current row 
      
               CALL adbt510_idx_chk()
               #NEXT FIELD xmegseq
         
         END DISPLAY
        
         DISPLAY ARRAY g_xmeg_d TO s_detail1.* ATTRIBUTES(COUNT=g_rec_b) #page1  
    
            BEFORE ROW
               CALL adbt510_idx_chk()
               LET l_ac = DIALOG.getCurrentRow("s_detail1")
               LET g_detail_idx = l_ac
               
               #add-point:page1, before row動作
               {<point name="ui_dialog.page1.before_row"/>}
               #end add-point
               
            BEFORE DISPLAY
               #如果一直都在單頭則控制筆數位置
               IF g_loc = 'm' THEN
                  CALL FGL_SET_ARR_CURR(g_detail_idx)
               END IF
               LET g_loc = 'm'
               LET l_ac = DIALOG.getCurrentRow("s_detail1")
               LET g_current_page = 1
               CALL adbt510_idx_chk()
               #add-point:page1自定義行為
               {<point name="ui_dialog.page1.before_display"/>}
               #end add-point
               
            #自訂ACTION(detail_show,page_1)
            
 
         #+ 此段落由子樣板a43產生
         ON ACTION open_adbt510_03
            LET g_action_choice="open_adbt510_03"
            IF cl_auth_chk_act("open_adbt510_03") THEN
               
               #add-point:ON ACTION open_adbt510_03
               {<point name="menu.detail_show.page1.open_adbt510_03" />}
               #END add-point
               EXIT DIALOG
            END IF
 
 
               
            #add-point:page1自定義行為
            {<point name="ui_dialog.page1.action"/>}
            #end add-point
               
         END DISPLAY
        
         DISPLAY ARRAY g_xmeg3_d TO s_detail3.* ATTRIBUTES(COUNT=g_rec_b)  
    
            BEFORE ROW
               CALL adbt510_idx_chk()
               LET l_ac = DIALOG.getCurrentRow("s_detail3")
               LET g_detail_idx = l_ac
               
               #add-point:page2, before row動作
               {<point name="ui_dialog.body3.before_row"/>}
               #end add-point
               
            BEFORE DISPLAY
               #如果一直都在單頭則控制筆數位置
               IF g_loc = 'm' THEN
                  CALL FGL_SET_ARR_CURR(g_detail_idx)
               END IF
               LET g_loc = 'm'
               LET l_ac = DIALOG.getCurrentRow("s_detail3")
               LET g_current_page = 2
               CALL adbt510_idx_chk()
               #add-point:page2自定義行為
               {<point name="ui_dialog.body3.before_display"/>}
               #end add-point
      
            #自訂ACTION(detail_show,page_2)
            
         
            #add-point:page2自定義行為
            {<point name="ui_dialog.body3.action"/>}
            #end add-point
         
         END DISPLAY
         DISPLAY ARRAY g_xmeg4_d TO s_detail4.* ATTRIBUTES(COUNT=g_rec_b)  
    
            BEFORE ROW
               CALL adbt510_idx_chk()
               LET l_ac = DIALOG.getCurrentRow("s_detail4")
               LET g_detail_idx = l_ac
               
               #add-point:page3, before row動作
               {<point name="ui_dialog.body4.before_row"/>}
               #end add-point
               
            BEFORE DISPLAY
               #如果一直都在單頭則控制筆數位置
               IF g_loc = 'm' THEN
                  CALL FGL_SET_ARR_CURR(g_detail_idx)
               END IF
               LET g_loc = 'm'
               LET l_ac = DIALOG.getCurrentRow("s_detail4")
               LET g_current_page = 3
               CALL adbt510_idx_chk()
               #add-point:page3自定義行為
               {<point name="ui_dialog.body4.before_display"/>}
               #end add-point
      
            #自訂ACTION(detail_show,page_3)
            
 
         #+ 此段落由子樣板a43產生
         ON ACTION open_adbt510_03
            LET g_action_choice="open_adbt510_03"
            IF cl_auth_chk_act("open_adbt510_03") THEN
               
               #add-point:ON ACTION open_adbt510_03
               {<point name="menu.detail_show.page3.open_adbt510_03" />}
               #END add-point
               EXIT DIALOG
            END IF
 
 
         #+ 此段落由子樣板a43產生
         ON ACTION open_adbt510_04
            LET g_action_choice="open_adbt510_04"
            IF cl_auth_chk_act("open_adbt510_04") THEN
               
               #add-point:ON ACTION open_adbt510_04
               {<point name="menu.detail_show.page3.open_adbt510_04" />}
               #END add-point
               EXIT DIALOG
            END IF
 
 
         
            #add-point:page3自定義行為
            {<point name="ui_dialog.body4.action"/>}
            #end add-point
         
         END DISPLAY
         DISPLAY ARRAY g_xmeg5_d TO s_detail5.* ATTRIBUTES(COUNT=g_rec_b)  
    
            BEFORE ROW
               CALL adbt510_idx_chk()
               LET l_ac = DIALOG.getCurrentRow("s_detail5")
               LET g_detail_idx = l_ac
               
               #add-point:page4, before row動作
               {<point name="ui_dialog.body5.before_row"/>}
               #end add-point
               
            BEFORE DISPLAY
               #如果一直都在單頭則控制筆數位置
               IF g_loc = 'm' THEN
                  CALL FGL_SET_ARR_CURR(g_detail_idx)
               END IF
               LET g_loc = 'm'
               LET l_ac = DIALOG.getCurrentRow("s_detail5")
               LET g_current_page = 4
               CALL adbt510_idx_chk()
               #add-point:page4自定義行為
               {<point name="ui_dialog.body5.before_display"/>}
               #end add-point
      
            #自訂ACTION(detail_show,page_4)
            
 
         #+ 此段落由子樣板a43產生
         ON ACTION open_adbt510_03
            LET g_action_choice="open_adbt510_03"
            IF cl_auth_chk_act("open_adbt510_03") THEN
               
               #add-point:ON ACTION open_adbt510_03
               {<point name="menu.detail_show.page4.open_adbt510_03" />}
               #END add-point
               EXIT DIALOG
            END IF
 
 
         #+ 此段落由子樣板a43產生
         ON ACTION open_adbt510_04
            LET g_action_choice="open_adbt510_04"
            IF cl_auth_chk_act("open_adbt510_04") THEN
               
               #add-point:ON ACTION open_adbt510_04
               {<point name="menu.detail_show.page4.open_adbt510_04" />}
               #END add-point
               EXIT DIALOG
            END IF
 
 
         
            #add-point:page4自定義行為
            {<point name="ui_dialog.body5.action"/>}
            #end add-point
         
         END DISPLAY
 
         
 
         
         #add-point:ui_dialog段自定義display array
         {<point name="ui_dialog.more_displayarray"/>}
         #end add-point
         
         SUBDIALOG lib_cl_dlg.cl_dlg_qryplan
         SUBDIALOG lib_cl_dlg.cl_dlg_relateapps
      
         BEFORE DIALOG
            CALL cl_navigator_setting(g_current_idx, g_detail_cnt)
            LET g_curr_diag = ui.DIALOG.getCurrent()
            LET g_page = "first"
            LET g_current_sw = FALSE
            #回歸舊筆數位置 (回到當時異動的筆數)
            LET g_current_idx = DIALOG.getCurrentRow("s_browse")
            IF g_current_row > 1 AND g_current_idx = 1 AND g_current_sw = FALSE THEN
               CALL DIALOG.setCurrentRow("s_browse",g_current_row)
               LET g_current_idx = g_current_row
            END IF
            LET g_current_row = g_current_idx #目前指標
            IF g_current_idx = 0 THEN
               LET g_current_idx = 1
            END IF
            LET g_current_sw = TRUE
            
            IF g_current_idx > g_browser.getLength() THEN
               LEt g_current_idx = g_browser.getLength()
            END IF 
            
            #有資料才進行fetch
            IF g_current_idx <> 0 THEN
               CALL adbt510_fetch('') # reload data
            END IF
            #LET g_detail_idx = 1
            CALL adbt510_ui_detailshow() #Setting the current row 
            
            #筆數顯示
            LET g_current_page = 1
            CALL adbt510_idx_chk()
            
            #add-point:ui_dialog段before_dialog2
            {<point name="ui_dialog.before_dialog2"/>}
            #end add-point
        
         ON ACTION statechange
            LET g_action_choice = "statechange"
            CALL adbt510_statechange()
            EXIT DIALOG
      
         #此段落由子樣板a32產生
         #簽核狀況
         ON ACTION bpm_status
            #查詢簽核狀況, 統一建立HyperLink
            CALL cl_bpm_status()
            #add-point:ON ACTION bpm_status
            {<point name="menu.bpm_status" />}
            #END add-point
 
 
 
 
          
         ON ACTION queryplansel
            CALL cl_dlg_qryplan_select() RETURNING ls_wc
            #不是空條件才寫入g_wc跟重新找資料
            IF NOT cl_null(ls_wc) THEN
               LET g_wc = ls_wc
               CALL adbt510_browser_fill("F")   #browser_fill()會將notice區塊清空
               CALL cl_notice()   #重新顯示,此處不可用EXIT DIALOG, SUBDIALOG重讀會導致部分變數消失
            END IF
 
         ON ACTION qbe_select
            CALL cl_qbe_list("m") RETURNING ls_wc
            IF NOT cl_null(ls_wc) THEN
               LET g_wc = ls_wc
               #取得條件後需要重查、跳到結果第一筆資料的功能程式段
               CALL adbt510_browser_fill("F")
               IF g_browser_cnt = 0 THEN
                  CALL cl_err("","-100",1)
                  CLEAR FORM
               ELSE
                  CALL adbt510_fetch("F")
               END IF
            END IF
            #重新搜尋會將notice區塊清空,此處不可用EXIT DIALOG, SUBDIALOG重讀會導致部分變數消失
            CALL cl_notice()
          
         #+ 此段落由子樣板a49產生
            ON ACTION filter
               #add-point:filter action
               {<point name="ui_dialog.action.filter"/>}
               #end add-point
               CALL adbt510_filter()
               EXIT DIALOG
 
 
 
         
         ON ACTION first
            CALL adbt510_fetch('F')
            LET g_current_row = g_current_idx
            LET g_curr_diag = ui.DIALOG.getCurrent()
            CALL adbt510_idx_chk()
            
         ON ACTION previous
            CALL adbt510_fetch('P')
            LET g_current_row = g_current_idx
            LET g_curr_diag = ui.DIALOG.getCurrent()
            CALL adbt510_idx_chk()
            
         ON ACTION jump
            CALL adbt510_fetch('/')
            LET g_current_row = g_current_idx
            LET g_curr_diag = ui.DIALOG.getCurrent()
            CALL adbt510_idx_chk()
            
         ON ACTION next
            CALL adbt510_fetch('N')
            LET g_current_row = g_current_idx
            LET g_curr_diag = ui.DIALOG.getCurrent()
            CALL adbt510_idx_chk()
            
         ON ACTION last
            CALL adbt510_fetch('L')
            LET g_current_row = g_current_idx
            LET g_curr_diag = ui.DIALOG.getCurrent()
            CALL adbt510_idx_chk()
            
         ON ACTION close
            LET INT_FLAG = FALSE
            LET g_action_choice = "exit"
            EXIT DIALOG
          
         ON ACTION exit
            LET g_action_choice = "exit"
            EXIT DIALOG
      
         ON ACTION mainhidden       #主頁摺疊
            IF g_main_hidden THEN
               CALL gfrm_curr.setElementHidden("mainlayout",0)
               CALL gfrm_curr.setElementHidden("worksheet",1)
               LET g_main_hidden = 0
            ELSE
               CALL gfrm_curr.setElementHidden("mainlayout",1)
               CALL gfrm_curr.setElementHidden("worksheet",0)
               LET g_main_hidden = 1
            END IF
            
         ON ACTION worksheethidden   #瀏覽頁折疊
            IF g_main_hidden THEN
               CALL gfrm_curr.setElementHidden("mainlayout",0)
               CALL gfrm_curr.setElementHidden("worksheet",1)
               LET g_main_hidden = 0
            ELSE
               CALL gfrm_curr.setElementHidden("mainlayout",1)
               CALL gfrm_curr.setElementHidden("worksheet",0)
               LET g_main_hidden = 1
            END IF
            IF lb_first THEN
               LET lb_first = FALSE
               NEXT FIELD xmegseq
            END IF
       
         ON ACTION controls      #單頭摺疊，可利用hot key "Ctrl-s"開啟/關閉單頭
            IF g_header_hidden THEN
               CALL gfrm_curr.setElementHidden("vb_master",0)
               CALL gfrm_curr.setElementImage("controls","small/arr-u.png")
               LET g_header_hidden = 0     #visible
            ELSE
               CALL gfrm_curr.setElementHidden("vb_master",1)
               CALL gfrm_curr.setElementImage("controls","small/arr-d.png")
               LET g_header_hidden = 1     #hidden     
            END IF
    
         
         #+ 此段落由子樣板a43產生
         ON ACTION modify
            LET g_action_choice="modify"
            IF cl_auth_chk_act("modify") THEN
               LET g_aw = ''
               CALL adbt510_modify()
               #add-point:ON ACTION modify
               {<point name="menu.modify" />}
               #END add-point
               EXIT DIALOG
            END IF
 
 
         #+ 此段落由子樣板a43產生
         ON ACTION modify_detail
            LET g_action_choice="modify_detail"
            IF cl_auth_chk_act("modify") THEN
               LET g_aw = g_curr_diag.getCurrentItem()
               CALL adbt510_modify()
               #add-point:ON ACTION modify_detail
               {<point name="menu.modify_detail" />}
               #END add-point
               EXIT DIALOG
            END IF
 
 
         #+ 此段落由子樣板a43產生
         ON ACTION open_xmef_w
            LET g_action_choice="open_xmef_w"
            IF cl_auth_chk_act("open_xmef_w") THEN
               
               #add-point:ON ACTION open_xmef_w
               {<point name="menu.open_xmef_w" />}
               #END add-point
               EXIT DIALOG
            END IF
 
 
         #+ 此段落由子樣板a43產生
         ON ACTION delete
            LET g_action_choice="delete"
            IF cl_auth_chk_act("delete") THEN
               CALL adbt510_delete()
               #add-point:ON ACTION delete
               {<point name="menu.delete" />}
               #END add-point
               
            END IF
 
 
         #+ 此段落由子樣板a43產生
         ON ACTION insert
            LET g_action_choice="insert"
            IF cl_auth_chk_act("insert") THEN
               CALL adbt510_insert()
               #add-point:ON ACTION insert
               {<point name="menu.insert" />}
               #END add-point
               EXIT DIALOG
            END IF
 
 
         #+ 此段落由子樣板a43產生
         ON ACTION output
            LET g_action_choice="output"
            IF cl_auth_chk_act("output") THEN
               
               #add-point:ON ACTION output
               {<point name="menu.output" />}
               #END add-point
               EXIT DIALOG
            END IF
 
 
         #+ 此段落由子樣板a43產生
         ON ACTION query
            LET g_action_choice="query"
            IF cl_auth_chk_act("query") THEN
               CALL adbt510_query()
               #add-point:ON ACTION query
               {<point name="menu.query" />}
               #END add-point
               
            END IF
 
 
         
         #+ 此段落由子樣板a46產生
         #新增相關文件
         ON ACTION related_document
            CALL adbt510_set_pk_array()
            IF cl_auth_chk_act("related_document") THEN
               #add-point:ON ACTION related_document
               {<point name="ui_dialog.dialog.related_document"/>}
               #END add-point
               CALL cl_doc()
            END IF
            
         ON ACTION agendum
            CALL adbt510_set_pk_array()
            #add-point:ON ACTION agendum
            {<point name="ui_dialog.dialog.agendum"/>}
            #END add-point
            CALL cl_user_overview()
            CALL cl_user_overview_set_follow_pic()
         
         ON ACTION followup
            CALL adbt510_set_pk_array()
            #add-point:ON ACTION followup
            {<point name="ui_dialog.dialog.followup"/>}
            #END add-point
            CALL cl_user_overview_follow(g_xmee_m.xmeedocdt)
 
 
         
         #主選單用ACTION
         &include "main_menu.4gl"
         &include "relating_action.4gl"
         #交談指令共用ACTION
         &include "common_action.4gl" 
            CONTINUE DIALOG
            
      END DIALOG
    
      IF g_action_choice = "exit" AND NOT cl_null(g_action_choice) THEN
         EXIT WHILE
      END IF
    
   END WHILE    
      
   CALL cl_set_act_visible("accept,cancel", TRUE)
    
END FUNCTION
]]>
</section>
  <section id="adbt510.ui_headershow" ver="25" status="" src="s">
<![CDATA[#+ 單頭資料重新顯示
PRIVATE FUNCTION adbt510_ui_headershow()
   #add-point:ui_headershow段define
   {<point name="ui_headershow.define"/>}
   #end add-point    
   
   LET g_xmee_m.xmeedocno = g_browser[g_current_idx].b_xmeedocno   
   LET g_xmee_m.xmee900 = g_browser[g_current_idx].b_xmee900   
 
   EXECUTE adbt510_master_referesh USING g_xmee_m.xmeedocno,g_xmee_m.xmee900 INTO g_xmee_m.xmeesite, 
       g_xmee_m.xmee902,g_xmee_m.xmeedocno,g_xmee_m.xmee900,g_xmee_m.xmee901,g_xmee_m.xmee001,g_xmee_m.xmee202, 
       g_xmee_m.xmee023,g_xmee_m.xmee004,g_xmee_m.xmee200,g_xmee_m.xmee201,g_xmee_m.xmeestus,g_xmee_m.xmee005, 
       g_xmee_m.xmee007,g_xmee_m.xmee008,g_xmee_m.xmeedocdt,g_xmee_m.xmee024,g_xmee_m.xmeeacti,g_xmee_m.xmee021, 
       g_xmee_m.xmee022,g_xmee_m.xmee203,g_xmee_m.xmee027,g_xmee_m.xmee002,g_xmee_m.xmee003,g_xmee_m.xmeeunit, 
       g_xmee_m.xmee204,g_xmee_m.xmee205,g_xmee_m.xmee032,g_xmee_m.xmee071,g_xmee_m.xmee903,g_xmee_m.xmee904, 
       g_xmee_m.xmee025,g_xmee_m.xmee026,g_xmee_m.xmee206,g_xmee_m.xmee207,g_xmee_m.xmee020,g_xmee_m.xmee036, 
       g_xmee_m.xmee009,g_xmee_m.xmee010,g_xmee_m.xmee015,g_xmee_m.xmee016,g_xmee_m.xmee011,g_xmee_m.xmee012, 
       g_xmee_m.xmee013,g_xmee_m.xmee035,g_xmee_m.xmee039,g_xmee_m.xmeeownid,g_xmee_m.xmeeowndp,g_xmee_m.xmeecrtid, 
       g_xmee_m.xmeecrtdp,g_xmee_m.xmeecrtdt,g_xmee_m.xmeemodid,g_xmee_m.xmeemoddt,g_xmee_m.xmeecnfid, 
       g_xmee_m.xmeecnfdt,g_xmee_m.xmee034,g_xmee_m.xmee006,g_xmee_m.xmee017,g_xmee_m.xmee041,g_xmee_m.xmee018, 
       g_xmee_m.xmee042,g_xmee_m.xmee019,g_xmee_m.xmee043,g_xmee_m.xmee028,g_xmee_m.xmeesite_desc,g_xmee_m.xmee202_desc, 
       g_xmee_m.xmee023_desc,g_xmee_m.xmee004_desc,g_xmee_m.xmee200_desc,g_xmee_m.xmee201_desc,g_xmee_m.xmee024_desc, 
       g_xmee_m.xmee021_desc,g_xmee_m.xmee022_desc,g_xmee_m.xmee203_desc,g_xmee_m.xmee027_desc,g_xmee_m.xmee002_desc, 
       g_xmee_m.xmee003_desc,g_xmee_m.xmeeunit_desc,g_xmee_m.xmee204_desc,g_xmee_m.xmee032_desc,g_xmee_m.xmee903_desc, 
       g_xmee_m.xmee206_desc,g_xmee_m.xmee207_desc,g_xmee_m.xmee020_desc,g_xmee_m.xmee036_desc,g_xmee_m.xmee009_desc, 
       g_xmee_m.xmee010_desc,g_xmee_m.xmee015_desc,g_xmee_m.xmeeownid_desc,g_xmee_m.xmeeowndp_desc,g_xmee_m.xmeecrtid_desc, 
       g_xmee_m.xmeecrtdp_desc,g_xmee_m.xmeemodid_desc,g_xmee_m.xmeecnfid_desc,g_xmee_m.xmee034_desc, 
       g_xmee_m.xmee017_desc,g_xmee_m.xmee018_desc
   CALL adbt510_show()
   
END FUNCTION
]]>
</section>
  <section id="adbt510.unlock_b" ver="15" status="" src="s">
<![CDATA[#+ 連動unlock其他單身table資料
PRIVATE FUNCTION adbt510_unlock_b(ps_table,ps_page)
   DEFINE ps_page     STRING
   DEFINE ps_table    STRING
   DEFINE ls_group    STRING
   #add-point:unlock_b段define
   {<point name="unlock_b.define"/>}
   #end add-point  
   
   LET ls_group = "'1',"
   
   IF ls_group.getIndexOf(ps_page,1) THEN
      CLOSE adbt510_bcl
   END IF
   
   LET ls_group = "'2',"
   
   IF ls_group.getIndexOf(ps_page,1) THEN
      CLOSE adbt510_bcl2
   END IF
 
   LET ls_group = "'3',"
   
   IF ls_group.getIndexOf(ps_page,1) THEN
      CLOSE adbt510_bcl3
   END IF
 
   LET ls_group = "'4',"
   
   IF ls_group.getIndexOf(ps_page,1) THEN
      CLOSE adbt510_bcl4
   END IF
 
 
   
 
 
   #add-point:unlock_b段other
   {<point name="unlock_b.other"/>}
   #end add-point  
 
END FUNCTION
]]>
</section>
  <section id="adbt510.update_b" ver="50" status="" src="s">
<![CDATA[#+ 修改單身後其他table連動
PRIVATE FUNCTION adbt510_update_b(ps_table,ps_keys,ps_keys_bak,ps_page)
   DEFINE ps_table         STRING
   DEFINE ps_page          STRING
   DEFINE ps_keys          DYNAMIC ARRAY OF VARCHAR(500)
   DEFINE ps_keys_bak      DYNAMIC ARRAY OF VARCHAR(500)
   DEFINE ls_group         STRING
   DEFINE li_idx           LIKE type_t.num5 
   DEFINE lb_chk           BOOLEAN
   DEFINE l_new_key        DYNAMIC ARRAY OF STRING
   DEFINE l_old_key        DYNAMIC ARRAY OF STRING
   DEFINE l_field_key      DYNAMIC ARRAY OF STRING
   #add-point:update_b段define
   {<point name="update_b.define"/>}
   #end add-point     
   
   #判斷key是否有改變
   LET lb_chk = TRUE
   FOR li_idx = 1 TO ps_keys.getLength()
      IF ps_keys[li_idx] <> ps_keys_bak[li_idx] THEN
         LET lb_chk = FALSE
         EXIT FOR
      END IF
   END FOR
   
   #不需要做處理
   IF lb_chk THEN
      RETURN
   END IF
   
   #判斷是否是同一群組的table
   LET ls_group = "'1',"
   IF ls_group.getIndexOf(ps_page,1) > 0 AND ps_table <> "xmeg_t" THEN
      #add-point:update_b段修改前
      {<point name="update_b.before_update" mark="Y"/>}
      #end add-point     
      UPDATE xmeg_t 
         SET (xmegdocno,xmeg900,
              xmegseq
              ,xmegsite,xmeg027,xmeg001,xmeg002,xmeg004,xmeg005,xmeg006,xmeg007,xmeg008,xmeg009,xmeg024,xmeg012,xmeg013,xmeg045,xmeg010,xmeg011,xmeg015,xmeg016,xmeg017,xmeg046,xmeg047,xmeg048,xmeg023,xmeg019,xmeg020,xmeg021,xmeg022,xmeg051,xmegunit,xmegorga,xmeg052,xmeg049,xmeg053,xmeg050,xmeg901,xmeg902,xmeg903) 
              = 
             (ps_keys[1],ps_keys[2],ps_keys[3]
              ,g_xmeg_d[g_detail_idx].xmegsite,g_xmeg_d[g_detail_idx].xmeg027,g_xmeg_d[g_detail_idx].xmeg001, 
                  g_xmeg_d[g_detail_idx].xmeg002,g_xmeg_d[g_detail_idx].xmeg004,g_xmeg_d[g_detail_idx].xmeg005, 
                  g_xmeg_d[g_detail_idx].xmeg006,g_xmeg_d[g_detail_idx].xmeg007,g_xmeg_d[g_detail_idx].xmeg008, 
                  g_xmeg_d[g_detail_idx].xmeg009,g_xmeg_d[g_detail_idx].xmeg024,g_xmeg_d[g_detail_idx].xmeg012, 
                  g_xmeg_d[g_detail_idx].xmeg013,g_xmeg_d[g_detail_idx].xmeg045,g_xmeg_d[g_detail_idx].xmeg010, 
                  g_xmeg_d[g_detail_idx].xmeg011,g_xmeg_d[g_detail_idx].xmeg015,g_xmeg_d[g_detail_idx].xmeg016, 
                  g_xmeg_d[g_detail_idx].xmeg017,g_xmeg_d[g_detail_idx].xmeg046,g_xmeg_d[g_detail_idx].xmeg047, 
                  g_xmeg_d[g_detail_idx].xmeg048,g_xmeg_d[g_detail_idx].xmeg023,g_xmeg_d[g_detail_idx].xmeg019, 
                  g_xmeg_d[g_detail_idx].xmeg020,g_xmeg_d[g_detail_idx].xmeg021,g_xmeg_d[g_detail_idx].xmeg022, 
                  g_xmeg_d[g_detail_idx].xmeg051,g_xmeg_d[g_detail_idx].xmegunit,g_xmeg_d[g_detail_idx].xmegorga, 
                  g_xmeg_d[g_detail_idx].xmeg052,g_xmeg_d[g_detail_idx].xmeg049,g_xmeg_d[g_detail_idx].xmeg053, 
                  g_xmeg_d[g_detail_idx].xmeg050,g_xmeg_d[g_detail_idx].xmeg901,g_xmeg_d[g_detail_idx].xmeg902, 
                  g_xmeg_d[g_detail_idx].xmeg903) 
         WHERE xmegent = g_enterprise AND xmegdocno = ps_keys_bak[1] AND xmeg900 = ps_keys_bak[2] AND xmegseq = ps_keys_bak[3]
      #add-point:update_b段修改中
      {<point name="update_b.m_update"/>}
      #end add-point   
      CASE
         WHEN SQLCA.sqlerrd[3] = 0  #更新不到的處理
            CALL cl_err("xmeg_t","std-00009",1)
            CALL s_transaction_end('N','0')
         WHEN SQLCA.sqlcode #其他錯誤
            CALL cl_err("xmeg_t",SQLCA.sqlcode,1)  
            CALL s_transaction_end('N','0')
         OTHERWISE
            
      END CASE
      #add-point:update_b段修改後
      {<point name="update_b.after_update"/>}
      #end add-point  
   END IF
   
   LET ls_group = "'2',"
   #判斷是否是同一群組的table
   IF ls_group.getIndexOf(ps_page,1) > 0 AND ps_table <> "xmeh_t" THEN
      #add-point:update_b段修改前
      {<point name="update_b.before_update2" mark="Y"/>}
      #end add-point     
      UPDATE xmeh_t 
         SET (xmehdocno,xmeh900,
              xmehseq,xmehseq1,xmehseq2
              ,xmeh229,xmeh003,xmeh001,xmeh002,xmeh200,xmeh004,xmeh005,xmeh011,xmeh012,xmeh006,xmeh201,xmeh202,xmeh024,xmeh025,xmeh026,xmeh027,xmeh203,xmeh204,xmeh205,xmeh206,xmeh029,xmeh028,xmeh019,xmeh030,xmeh207,xmehunit,xmeh210,xmeh212,xmeh213,xmeh214,xmeh215,xmeh031,xmeh014,xmeh015,xmeh016,xmeh017,xmeh221,xmehsite,xmeh218,xmeh219,xmeh220,xmeh222,xmeh223,xmeh224,xmehorga,xmeh226,xmeh227,xmeh228,xmeh901) 
              = 
             (ps_keys[1],ps_keys[2],ps_keys[3],ps_keys[4],ps_keys[5]
              ,g_xmeg3_d[g_detail_idx].xmeh229,g_xmeg3_d[g_detail_idx].xmeh003,g_xmeg3_d[g_detail_idx].xmeh001, 
                  g_xmeg3_d[g_detail_idx].xmeh002,g_xmeg3_d[g_detail_idx].xmeh200,g_xmeg3_d[g_detail_idx].xmeh004, 
                  g_xmeg3_d[g_detail_idx].xmeh005,g_xmeg3_d[g_detail_idx].xmeh011,g_xmeg3_d[g_detail_idx].xmeh012, 
                  g_xmeg3_d[g_detail_idx].xmeh006,g_xmeg3_d[g_detail_idx].xmeh201,g_xmeg3_d[g_detail_idx].xmeh202, 
                  g_xmeg3_d[g_detail_idx].xmeh024,g_xmeg3_d[g_detail_idx].xmeh025,g_xmeg3_d[g_detail_idx].xmeh026, 
                  g_xmeg3_d[g_detail_idx].xmeh027,g_xmeg3_d[g_detail_idx].xmeh203,g_xmeg3_d[g_detail_idx].xmeh204, 
                  g_xmeg3_d[g_detail_idx].xmeh205,g_xmeg3_d[g_detail_idx].xmeh206,g_xmeg3_d[g_detail_idx].xmeh029, 
                  g_xmeg3_d[g_detail_idx].xmeh028,g_xmeg3_d[g_detail_idx].xmeh019,g_xmeg3_d[g_detail_idx].xmeh030, 
                  g_xmeg3_d[g_detail_idx].xmeh207,g_xmeg3_d[g_detail_idx].xmehunit,g_xmeg3_d[g_detail_idx].xmeh210, 
                  g_xmeg3_d[g_detail_idx].xmeh212,g_xmeg3_d[g_detail_idx].xmeh213,g_xmeg3_d[g_detail_idx].xmeh214, 
                  g_xmeg3_d[g_detail_idx].xmeh215,g_xmeg3_d[g_detail_idx].xmeh031,g_xmeg3_d[g_detail_idx].xmeh014, 
                  g_xmeg3_d[g_detail_idx].xmeh015,g_xmeg3_d[g_detail_idx].xmeh016,g_xmeg3_d[g_detail_idx].xmeh017, 
                  g_xmeg3_d[g_detail_idx].xmeh221,g_xmeg3_d[g_detail_idx].xmehsite,g_xmeg3_d[g_detail_idx].xmeh218, 
                  g_xmeg3_d[g_detail_idx].xmeh219,g_xmeg3_d[g_detail_idx].xmeh220,g_xmeg3_d[g_detail_idx].xmeh222, 
                  g_xmeg3_d[g_detail_idx].xmeh223,g_xmeg3_d[g_detail_idx].xmeh224,g_xmeg3_d[g_detail_idx].xmehorga, 
                  g_xmeg3_d[g_detail_idx].xmeh226,g_xmeg3_d[g_detail_idx].xmeh227,g_xmeg3_d[g_detail_idx].xmeh228, 
                  g_xmeg3_d[g_detail_idx].xmeh901) 
         WHERE xmehent = g_enterprise AND xmehdocno = ps_keys_bak[1] AND xmeh900 = ps_keys_bak[2] AND xmehseq = ps_keys_bak[3] AND xmehseq1 = ps_keys_bak[4] AND xmehseq2 = ps_keys_bak[5]
      #add-point:update_b段修改中
      {<point name="update_b.m_update2"/>}
      #end add-point  
      CASE
         WHEN SQLCA.sqlerrd[3] = 0  #更新不到的處理
            CALL cl_err("xmeh_t","std-00009",1)
            CALL s_transaction_end('N','0')
         WHEN SQLCA.sqlcode #其他錯誤
            CALL cl_err("xmeh_t",SQLCA.sqlcode,1)  
            CALL s_transaction_end('N','0')
         OTHERWISE
            
      END CASE
      #add-point:update_b段修改後
      {<point name="update_b.after_update2"/>}
      #end add-point  
   END IF
 
   LET ls_group = "'3',"
   #判斷是否是同一群組的table
   IF ls_group.getIndexOf(ps_page,1) > 0 AND ps_table <> "xmjb_t" THEN
      #add-point:update_b段修改前
      {<point name="update_b.before_update3" mark="Y"/>}
      #end add-point     
      UPDATE xmjb_t 
         SET (xmjbdocno,xmjb900,
              xmjbseq
              ,xmjbunit,xmjbsite,xmjb001,xmjb002,xmjb003,xmjb033,xmjb004,xmjb005,xmjb006,xmjb007,xmjb011,xmjb012,xmjb013,xmjb014,xmjb015,xmjb016,xmjb017,xmjb018,xmjb008,xmjb009,xmjb010,xmjb022,xmjb019,xmjb020,xmjb021,xmjb024,xmjb025,xmjb026,xmjb027,xmjb028,xmjb029,xmjb030,xmjb031,xmjb032,xmjb034,xmjb901,xmjb902,xmjb903) 
              = 
             (ps_keys[1],ps_keys[2],ps_keys[3]
              ,g_xmeg4_d[g_detail_idx].xmjbunit,g_xmeg4_d[g_detail_idx].xmjbsite,g_xmeg4_d[g_detail_idx].xmjb001, 
                  g_xmeg4_d[g_detail_idx].xmjb002,g_xmeg4_d[g_detail_idx].xmjb003,g_xmeg4_d[g_detail_idx].xmjb033, 
                  g_xmeg4_d[g_detail_idx].xmjb004,g_xmeg4_d[g_detail_idx].xmjb005,g_xmeg4_d[g_detail_idx].xmjb006, 
                  g_xmeg4_d[g_detail_idx].xmjb007,g_xmeg4_d[g_detail_idx].xmjb011,g_xmeg4_d[g_detail_idx].xmjb012, 
                  g_xmeg4_d[g_detail_idx].xmjb013,g_xmeg4_d[g_detail_idx].xmjb014,g_xmeg4_d[g_detail_idx].xmjb015, 
                  g_xmeg4_d[g_detail_idx].xmjb016,g_xmeg4_d[g_detail_idx].xmjb017,g_xmeg4_d[g_detail_idx].xmjb018, 
                  g_xmeg4_d[g_detail_idx].xmjb008,g_xmeg4_d[g_detail_idx].xmjb009,g_xmeg4_d[g_detail_idx].xmjb010, 
                  g_xmeg4_d[g_detail_idx].xmjb022,g_xmeg4_d[g_detail_idx].xmjb019,g_xmeg4_d[g_detail_idx].xmjb020, 
                  g_xmeg4_d[g_detail_idx].xmjb021,g_xmeg4_d[g_detail_idx].xmjb024,g_xmeg4_d[g_detail_idx].xmjb025, 
                  g_xmeg4_d[g_detail_idx].xmjb026,g_xmeg4_d[g_detail_idx].xmjb027,g_xmeg4_d[g_detail_idx].xmjb028, 
                  g_xmeg4_d[g_detail_idx].xmjb029,g_xmeg4_d[g_detail_idx].xmjb030,g_xmeg4_d[g_detail_idx].xmjb031, 
                  g_xmeg4_d[g_detail_idx].xmjb032,g_xmeg4_d[g_detail_idx].xmjb034,g_xmeg4_d[g_detail_idx].xmjb901, 
                  g_xmeg4_d[g_detail_idx].xmjb902,g_xmeg4_d[g_detail_idx].xmjb903) 
         WHERE xmjbent = g_enterprise AND xmjbdocno = ps_keys_bak[1] AND xmjb900 = ps_keys_bak[2] AND xmjbseq = ps_keys_bak[3]
      #add-point:update_b段修改中
      {<point name="update_b.m_update3"/>}
      #end add-point  
      CASE
         WHEN SQLCA.sqlerrd[3] = 0  #更新不到的處理
            CALL cl_err("xmjb_t","std-00009",1)
            CALL s_transaction_end('N','0')
         WHEN SQLCA.sqlcode #其他錯誤
            CALL cl_err("xmjb_t",SQLCA.sqlcode,1)  
            CALL s_transaction_end('N','0')
         OTHERWISE
            
      END CASE
      #add-point:update_b段修改後
      {<point name="update_b.after_update3"/>}
      #end add-point  
   END IF
 
   LET ls_group = "'4',"
   #判斷是否是同一群組的table
   IF ls_group.getIndexOf(ps_page,1) > 0 AND ps_table <> "xmef_t" THEN
      #add-point:update_b段修改前
      {<point name="update_b.before_update4" mark="Y"/>}
      #end add-point     
      UPDATE xmef_t 
         SET (xmefdocno,xmef900,
              xmef001
              ,xmefsite,xmef002,xmef003,xmef004,xmef005,xmef006,xmef007,xmef008,xmef009,xmef901,xmef902,xmef903) 
              = 
             (ps_keys[1],ps_keys[2],ps_keys[3]
              ,g_xmeg5_d[g_detail_idx].xmefsite,g_xmeg5_d[g_detail_idx].xmef002,g_xmeg5_d[g_detail_idx].xmef003, 
                  g_xmeg5_d[g_detail_idx].xmef004,g_xmeg5_d[g_detail_idx].xmef005,g_xmeg5_d[g_detail_idx].xmef006, 
                  g_xmeg5_d[g_detail_idx].xmef007,g_xmeg5_d[g_detail_idx].xmef008,g_xmeg5_d[g_detail_idx].xmef009, 
                  g_xmeg5_d[g_detail_idx].xmef901,g_xmeg5_d[g_detail_idx].xmef902,g_xmeg5_d[g_detail_idx].xmef903)  

         WHERE xmefent = g_enterprise AND xmefdocno = ps_keys_bak[1] AND xmef900 = ps_keys_bak[2] AND xmef001 = ps_keys_bak[3]
      #add-point:update_b段修改中
      {<point name="update_b.m_update4"/>}
      #end add-point  
      CASE
         WHEN SQLCA.sqlerrd[3] = 0  #更新不到的處理
            CALL cl_err("xmef_t","std-00009",1)
            CALL s_transaction_end('N','0')
         WHEN SQLCA.sqlcode #其他錯誤
            CALL cl_err("xmef_t",SQLCA.sqlcode,1)  
            CALL s_transaction_end('N','0')
         OTHERWISE
            
      END CASE
      #add-point:update_b段修改後
      {<point name="update_b.after_update4"/>}
      #end add-point  
   END IF
 
 
   
 
   
 
   
   #add-point:update_b段other
   {<point name="update_b.other"/>}
   #end add-point  
   
END FUNCTION
]]>
</section>
</add_points>