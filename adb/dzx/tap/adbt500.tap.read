<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<add_points prog="adbt500" std_prog="adbt500" erpver="1.0" module="ADB" ver="3" env="s" zone="t10dev" booking="N" type="M" identity="s">
  <other>
    <code_template value="F" status=""/>
    <free_style value="N" status=""/>
  </other>
  <point name="function.adbt500_xmda002_ref" order="1" ver="1" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[#獲取員工編號說明
PRIVATE FUNCTION adbt500_xmda002_ref(p_xmda002)
DEFINE p_xmda002      LIKE xmda_t.xmda002
DEFINE r_xmda002_desc LIKE oofa_t.oofa011

       INITIALIZE g_ref_fields TO NULL
       LET g_ref_fields[1] = p_xmda002
       CALL ap_ref_array2(g_ref_fields,"SELECT oofa011 FROM oofa_t WHERE oofaent='"||g_enterprise||"' AND oofa002='2' AND oofa003=? ","") RETURNING g_rtn_fields
       LET r_xmda002_desc = '', g_rtn_fields[1] , ''
       RETURN r_xmda002_desc
END FUNCTION]]>
  </point>
  <point name="function.adbt500_xmda003_chk" order="2" ver="1" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[#部門檢查
PRIVATE FUNCTION adbt500_xmda003_chk(p_xmda003)
DEFINE p_xmda003      LIKE xmda_t.xmda003
DEFINE r_success   LIKE type_t.num5

       LET r_success = TRUE
       IF NOT cl_null(p_xmda003) THEN 
         #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
          INITIALIZE g_chkparam.* TO NULL
          
         #設定g_chkparam.*的參數
          LET g_chkparam.arg1 = p_xmda003
          LET g_chkparam.arg2 = g_xmda_m.xmdadocdt
  
         #呼叫檢查存在並帶值的library
          IF NOT cl_chk_exist("v_ooeg001") THEN
             LET r_success = FALSE
             RETURN r_success
          END IF
       END IF 
       RETURN r_success
END FUNCTION]]>
  </point>
  <point name="function.adbt500_xmda003_ref" order="3" ver="1" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[#獲取部門編號說明
PRIVATE FUNCTION adbt500_xmda003_ref(p_xmda003)
DEFINE p_xmda003      LIKE xmda_t.xmda003
DEFINE r_xmda003_desc LIKE ooefl_t.ooefl003

       INITIALIZE g_ref_fields TO NULL
       LET g_ref_fields[1] = p_xmda003
       CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
       LET r_xmda003_desc = '', g_rtn_fields[1] , ''
       RETURN r_xmda003_desc
END FUNCTION]]>
  </point>
  <point name="function.adbt500_xmda004_chk" order="4" ver="1" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[#客戶檢查
PRIVATE FUNCTION adbt500_xmda004_chk(p_xmda004)
DEFINE p_xmda004    LIKE xmda_t.xmda004
DEFINE l_success    LIKE type_t.num5
DEFINE l_flag       LIKE type_t.num5
DEFINE r_success    LIKE type_t.num5
DEFINE l_cnt        LIKE type_t.num5

       LET r_success = TRUE
       
       IF NOT cl_null(p_xmda004) THEN 
          #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
          INITIALIZE g_chkparam.* TO NULL
          
          #設定g_chkparam.*的參數
          LET g_chkparam.arg1 = p_xmda004
   
          #呼叫檢查存在並帶值的library
          IF NOT cl_chk_exist("v_pmaa001_3") THEN
             LET r_success = FALSE
             RETURN r_success
          END IF
          
          #判斷輸入的客戶編號是否在銷售控制組限制的供應商範圍內，若不在限制內則不允許跟此客戶訂購  
          CALL s_control_chk_group('1','2',g_user,g_dept,p_xmda004,'','','','') RETURNING l_success,l_flag
          IF NOT l_success THEN      #處理狀況
             LET r_success = FALSE
             RETURN r_success
          ELSE
             IF NOT l_flag THEN      #是否存在
                CALL cl_err(p_xmda004,'axm-00007',1)
                LET r_success = FALSE
                RETURN r_success
             END IF 
          END IF
          
          #檢核輸入的客戶是否在單據別限制範圍內，若不在限制內則不允許跟此客戶訂購
          CALL s_control_chk_doc('3',g_xmda_m.xmdadocno,p_xmda004,'','','','') RETURNING l_success,l_flag
          IF NOT l_success THEN      #處理狀況
             LET r_success = FALSE
             RETURN r_success
          ELSE
             IF NOT l_flag THEN      #是否存在
                CALL cl_err(p_xmda004,'apm-00239',1)
                LET r_success = FALSE
                RETURN r_success
             END IF 
          END IF
          IF g_xmda_m.xmda007 = '5' THEN
             SELECT COUNT(*)
               INTO l_cnt
               FROM xmdk_t
              WHERE xmdkent = g_enterprise 
                AND xmdkdocno = g_xmda_m.xmda008
                AND xmdk000 <> '2'
                AND xmdk007 = p_xmda004
             IF l_cnt = 0 THEN
                CALL cl_err(p_xmda004,'adb-00050',1)
                LET r_success = FALSE
                RETURN r_success
             END IF
          END IF
       END IF 
       RETURN r_success
END FUNCTION]]>
  </point>
  <point name="function.adbt500_xmda004_ref" order="5" ver="1" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[#帶出供應商說明
PRIVATE FUNCTION adbt500_xmda004_ref(p_xmda004)
DEFINE p_xmda004    LIKE xmda_t.xmda004
DEFINE r_pmaal004   LIKE pmaal_t.pmaal004

        INITIALIZE g_ref_fields TO NULL
        LET g_ref_fields[1] = p_xmda004
        CALL ap_ref_array2(g_ref_fields,"SELECT pmaal004 FROM pmaal_t WHERE pmaalent='"||g_enterprise||"' AND pmaal001=? AND pmaal002='"||g_dlang||"'","") RETURNING g_rtn_fields
        LET r_pmaal004 = '', g_rtn_fields[1] , ''
        RETURN r_pmaal004
END FUNCTION]]>
  </point>
  <point name="function.adbt500_xmda004_desc" order="6" ver="2" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[#根據客戶編號帶出其他欄位值
PRIVATE FUNCTION adbt500_xmda004_desc()
  DEFINE l_n         LIKE type_t.num5
  DEFINE l_success   LIKE type_t.num5
  DEFINE l_controlno LIKE ooha_t.ooha001

      LET g_xmda_m.xmda009 = ''
      LET g_xmda_m.xmda009_desc = ''
      LET g_xmda_m.xmda010 = ''
      LET g_xmda_m.xmda010_desc = ''
      LET g_xmda_m.xmda011 = ''
      LET g_xmda_m.xmda011_desc = ''
      LET g_xmda_m.xmda012 = ''
      LET g_xmda_m.xmda013 = ''
      LET g_xmda_m.xmda015 = ''
      LET g_xmda_m.xmda015_desc = ''
      LET g_xmda_m.xmda016 = ''
      LET g_xmda_m.xmda017 = ''
      LET g_xmda_m.xmda017_desc = ''
      LET g_xmda_m.xmda020 = ''
      LET g_xmda_m.xmda020_desc = ''
      #LET g_xmda_m.xmda023 = ''
      #LET g_xmda_m.xmda023_desc = ''
      LET g_xmda_m.xmda024 = ''
      LET g_xmda_m.xmda024_desc = ''
      LET g_xmda_m.xmda035 = ''
      LET g_xmda_m.xmda035_desc = ''
      
      #先判斷這個客戶是否有設多個當前銷售控制組範圍內的客戶預設條件，則開窗，讓user選擇帶哪一個控制組的資料
      LET l_controlno = ''
      CALL s_control_get_group('2',g_xmda_m.xmda002,g_xmda_m.xmda003) RETURNING l_success,l_controlno
      
      #IF NOT cl_null(l_controlno) THEN
      #   #判斷客戶是否有設置訂單控制組客戶預設條件(axmi110)，若有則抓取相關的預設條件default到訂購單上
      #   SELECT COUNT(*) INTO l_n FROM xmae_t 
      #    WHERE xmaeent = g_enterprise AND xmae001 = g_xmda_m.xmda004 
      #      AND xmae002 = l_controlno 
      #   IF l_n > 0 THEN
      #      SELECT xmae006,xmae020,xmae004,xmae003,xmae021,
      #             xmae011,xmae008,xmae009,xmae022,xmae006,xmae022
      #        INTO g_xmda_m.xmda009,g_xmda_m.xmda010,g_xmda_m.xmda011,g_xmda_m.xmda015,g_xmda_m.xmda017,
      #             g_xmda_m.xmda020,g_xmda_m.xmda023,g_xmda_m.xmda024,g_xmda_m.xmda035,g_xmda_m.xmda018,g_xmda_m.xmda035
      #        FROM xmae_t 
      #       WHERE xmaeent = g_enterprise AND xmae001 = g_xmda_m.xmda004 
      #         AND xmae002 = l_controlno 
      #   END IF
      #END IF
      
      #若沒有設置銷售控制組客戶預設條件資料則改抓客戶據點預設條件(axmm202)資料  
      #IF cl_null(l_controlno) OR l_n = 0 THEN
         SELECT pmab087,pmab103,pmab084,pmab083,
                pmab104,pmab090,
                pmab089,pmab087,pmab106
           INTO g_xmda_m.xmda009,g_xmda_m.xmda010,g_xmda_m.xmda011,g_xmda_m.xmda015,
                g_xmda_m.xmda017,g_xmda_m.xmda020,
                g_xmda_m.xmda024,g_xmda_m.xmda018,g_xmda_m.xmda035
           FROM pmab_t WHERE pmabent = g_enterprise AND pmabsite = g_xmda_m.xmdasite AND pmab001 = g_xmda_m.xmda004         
      #END IF
      CALL adbt500_head_default()

END FUNCTION]]>
  </point>
  <point name="function.adbt500_xmda008_chk" order="7" ver="1" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[#根據不同的資料來源類型，判斷資料的有效否
PRIVATE FUNCTION adbt500_xmda008_chk()
DEFINE r_success   LIKE type_t.num5
DEFINE l_cnt       LIKE type_t.num5
DEFINE l_xmdk005   LIKE xmdk_t.xmdk005
DEFINE l_xmdksite  LIKE xmdk_t.xmdksite
DEFINE l_sql       STRING

   LET r_success = TRUE

   IF g_xmda_m.xmda007 = '5' THEN
      IF cl_null(g_xmda_m.xmda008) THEN
         CALL cl_err('','adb-00047',1)
         LET r_success = FALSE
         RETURN r_success
      END IF  
      #銷退單須存在
      SELECT COUNT(*)
        INTO l_cnt
        FROM xmdk_t
       WHERE xmdkent = g_enterprise 
         AND xmdkdocno = g_xmda_m.xmda008
         AND xmdk000 = '6'
         AND xmdkstus = "Y"

      IF l_cnt = 0 THEN
         CALL cl_err('','adb-00048',1)
         LET r_success = FALSE
         RETURN r_success
      END IF
      #不可為無訂單出貨
      SELECT xmdk005,xmdksite
        INTO l_xmdk005,l_xmdksite
        FROM xmdk_t
       WHERE xmdkent = g_enterprise
         AND xmdkdocno = g_xmda_m.xmda008
         AND xmdkstus = "Y"
         AND xmdk000 = '6'
      IF NOT cl_null(l_xmdk005) THEN
         LET l_cnt = 0
         SELECT COUNT(*)
           INTO l_cnt
           FROM xmdk_t
          WHERE xmdkent = g_enterprise 
            AND xmdkdocno = l_xmdk005
            AND xmdkstus = "Y"
            AND xmdk000 = '2'
         IF l_cnt > 0 THEN
            CALL cl_err('','adb-00049',1)
            LET r_success = FALSE
            RETURN r_success
         END IF
      END IF
      
      LET l_sql = " SELECT COUNT(*) FROM ooed_t ",        
                  "  WHERE ooed004 = '",l_xmdksite,"' AND ooed001='2' ",
                  "    AND ((ooed006 <= '",g_today,"'  AND ooed007 >= '",g_today,"' ) OR ooed007 IS NULL) ",
                  "    AND ooed004  IN ((SELECT DISTINCT ooed004 FROM ooed_t ",
                  "                       WHERE ooed001='2'  AND ((ooed006 <= '",g_today,"'  AND ooed007 >= '",g_today,"' ) OR ooed007 IS NULL) ",
                  "                       START WITH ooed005='",g_xmda_m.xmdasite,"' AND ooed001 = '2' ",
                  "                         AND ((ooed006 <= '",g_today,"'  AND ooed007 >= '",g_today,"' ) OR ooed007 IS NULL) ",
                  "                     CONNECT BY  NOCYCLE PRIOR ooed004=ooed005 AND ooed001='2' ) ",
                  "                       UNION (SELECT ooed004 FROM ooed_t WHERE ooed004='",g_xmda_m.xmdasite,"' )) "
      PREPARE adbt500_site_pre FROM l_sql
      LET l_cnt = 0
      EXECUTE adbt500_site_pre INTO l_cnt
      IF l_cnt = 0 THEN
         CALL cl_err('','adb-00100',1)
         LET r_success = FALSE
         RETURN r_success
      END IF
   END IF
   RETURN r_success
END FUNCTION]]>
  </point>
  <point name="function.adbt500_xmda008_desc" order="8" ver="2" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[#依來源單號抓取相關欄位至訂單頭上
PRIVATE FUNCTION adbt500_xmda008_desc()
DEFINE p_xmda007 LIKE xmda_t.xmda007
DEFINE p_xmda008 LIKE xmda_t.xmda008

   IF cl_null(g_xmda_m.xmda007) OR cl_null(g_xmda_m.xmda008) THEN RETURN END IF
   IF g_xmda_m.xmda007 = '5' THEN
   #先判斷是否為無訂單出貨
   
   
      LET g_xmda_m.xmda009 = ''
      LET g_xmda_m.xmda009_desc = ''
      LET g_xmda_m.xmda010 = ''
      LET g_xmda_m.xmda010_desc = ''
      LET g_xmda_m.xmda011 = ''
      LET g_xmda_m.xmda011_desc = ''
      LET g_xmda_m.xmda012 = ''
      LET g_xmda_m.xmda013 = ''
      LET g_xmda_m.xmda015 = ''
      LET g_xmda_m.xmda015_desc = ''
      LET g_xmda_m.xmda016 = ''
      LET g_xmda_m.xmda017 = ''
      LET g_xmda_m.xmda017_desc = ''
      LET g_xmda_m.xmda020 = ''
      LET g_xmda_m.xmda020_desc = ''
      #LET g_xmda_m.xmda023 = ''
      #LET g_xmda_m.xmda023_desc = ''
      LET g_xmda_m.xmda024 = ''
      LET g_xmda_m.xmda024_desc = ''
      LET g_xmda_m.xmda035 = ''
      LET g_xmda_m.xmda035_desc = ''
   
      SELECT xmdk007,xmdk010,xmdk011,xmdk012,xmdk016
             xmdk018,xmdk022,
             xmdk031,xmdk019,xmdk015
        INTO g_xmda_m.xmda004,g_xmda_m.xmda009,g_xmda_m.xmda010,g_xmda_m.xmda011,g_xmda_m.xmda015,
             g_xmda_m.xmda017,g_xmda_m.xmda020,
             g_xmda_m.xmda024,g_xmda_m.xmda018,g_xmda_m.xmda035
        FROM xmdk_t
       WHERE xmdkent = g_enterprise AND xmdkdocno = g_xmda_m.xmda008
      
      CALL adbt500_head_default()
   END IF
END FUNCTION]]>
  </point>
  <point name="function.adbt500_xmda009_ref" order="9" ver="1" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[#收款條件顯示
PRIVATE FUNCTION adbt500_xmda009_ref(p_xmda009)
DEFINE p_xmda009      LIKE xmda_t.xmda009
DEFINE r_ooibl004     LIKE ooibl_t.ooibl004

       INITIALIZE g_ref_fields TO NULL
       LET g_ref_fields[1] = p_xmda009
       CALL ap_ref_array2(g_ref_fields,"SELECT ooibl004 FROM ooibl_t WHERE ooiblent='"||g_enterprise||"' AND ooibl002=? AND ooibl003='"||g_dlang||"'","") RETURNING g_rtn_fields
       LET r_ooibl004 = g_rtn_fields[1]
       RETURN r_ooibl004
END FUNCTION]]>
  </point>
  <point name="function.adbt500_xmda010_ref" order="10" ver="1" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[#交昜條件顯示
PRIVATE FUNCTION adbt500_xmda010_ref(p_xmda010)
DEFINE p_xmda010      LIKE xmda_t.xmda010
DEFINE r_oocql004     LIKE oocql_t.oocql004

       INITIALIZE g_ref_fields TO NULL
       LET g_ref_fields[1] = p_xmda010
       CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='238' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
       LET r_oocql004 = g_rtn_fields[1]
       RETURN r_oocql004
END FUNCTION]]>
  </point>
  <point name="function.adbt500_xmda011_ref" order="11" ver="1" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[#稅別顯示
PRIVATE FUNCTION adbt500_xmda011_ref(p_xmda011)
DEFINE p_xmda011      LIKE xmda_t.xmda011
DEFINE r_oodbl004     LIKE oodbl_t.oodbl004
DEFINE l_ooef019      LIKE ooef_t.ooef019

       SELECT ooef019 INTO l_ooef019 FROM ooef_t WHERE ooefent = g_enterprise AND ooef001 = g_xmda_m.xmdasite
       INITIALIZE g_ref_fields TO NULL
       LET g_ref_fields[1] = p_xmda011
       CALL ap_ref_array2(g_ref_fields,"SELECT oodbl004 FROM oodbl_t WHERE oodblent='"||g_enterprise||"' AND oodbl001='"||l_ooef019||"' AND oodbl002=? AND oodbl003='"||g_dlang||"'","") RETURNING g_rtn_fields
       LET r_oodbl004 = '', g_rtn_fields[1] , ''
       RETURN r_oodbl004
END FUNCTION]]>
  </point>
  <point name="function.adbt500_xmda011_chk" order="12" ver="1" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[#稅別檢查
PRIVATE FUNCTION adbt500_xmda011_chk(p_type,p_xmda011)
DEFINE p_type         LIKE type_t.num5
DEFINE p_xmda011      LIKE xmda_t.xmda011
DEFINE r_success      LIKE type_t.num5
DEFINE l_cnt          LIKE type_t.num5

       LET r_success = TRUE
       IF NOT cl_null(p_xmda011) THEN 
         #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
          INITIALIZE g_chkparam.* TO NULL
          
         #設定g_chkparam.*的參數
          LET g_chkparam.arg1 = g_xmda_m.xmdasite
          LET g_chkparam.arg2 = p_xmda011
          IF p_type = '2' THEN   #單身稅別檢查
             LET g_chkparam.where = " oodb005 = '",g_oodb005,"'"   
          END IF 
         #呼叫檢查存在並帶值的library
          IF NOT cl_chk_exist("v_oodb002") THEN
             LET r_success = FALSE
             RETURN r_success
          END IF
          IF p_type = '1' AND g_xmda_m.xmda007 = '5' THEN
             SELECT COUNT(*)
               INTO l_cnt
               FROM xmdk_t
              WHERE xmdkent = g_enterprise 
                AND xmdkdocno = g_xmda_m.xmda008
                AND xmdk000 <> '2'
                AND xmdk012 = p_xmda011
             IF l_cnt = 0 THEN
                CALL cl_err(p_xmda011,'adb-00050',1)
                LET r_success = FALSE
                RETURN r_success
             END IF
          END IF
       END IF 
       RETURN r_success
END FUNCTION]]>
  </point>
  <point name="function.adbt500_xmda015_ref" order="13" ver="1" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[#幣別顯示
PRIVATE FUNCTION adbt500_xmda015_ref(p_xmda015)
DEFINE p_xmda015      LIKE xmda_t.xmda015
DEFINE r_ooail003     LIKE ooail_t.ooail003

       INITIALIZE g_ref_fields TO NULL
       LET g_ref_fields[1] = p_xmda015
       CALL ap_ref_array2(g_ref_fields,"SELECT ooail003 FROM ooail_t WHERE ooailent='"||g_enterprise||"' AND ooail001=? AND ooail002='"||g_dlang||"'","") RETURNING g_rtn_fields
       LET r_ooail003 = '', g_rtn_fields[1] , ''
       RETURN r_ooail003
END FUNCTION]]>
  </point>
  <point name="function.adbt500_xmda017_ref" order="14" ver="1" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[#取價方式顯示
PRIVATE FUNCTION adbt500_xmda017_ref(p_xmda017)
DEFINE p_xmda017    LIKE xmda_t.xmda017
DEFINE r_pmaml003   LIKE pmaml_t.pmaml003

       INITIALIZE g_ref_fields TO NULL
       LET g_ref_fields[1] = p_xmda017
       CALL ap_ref_array2(g_ref_fields,"SELECT xmahl003 FROM xmahl_t WHERE xmahlent='"||g_enterprise||"' AND xmahl001=? AND xmahl002='"||g_dlang||"'","") RETURNING g_rtn_fields
       LET r_pmaml003 = '', g_rtn_fields[1] , ''
       RETURN r_pmaml003
       
END FUNCTION]]>
  </point>
  <point name="function.adbt500_xmda018_ref" order="15" ver="1" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[#付款條件顯示
PRIVATE FUNCTION adbt500_xmda018_ref(p_xmda018)
DEFINE p_xmda018    LIKE xmda_t.xmda018
DEFINE r_ooidl003   LIKE ooidl_t.ooidl003

       INITIALIZE g_ref_fields TO NULL
       LET g_ref_fields[1] = p_xmda018
       CALL ap_ref_array2(g_ref_fields,"SELECT ooidl003 FROM ooidl_t WHERE ooidlent='"||g_enterprise||"' AND ooidl001=? AND ooidl002='"||g_dlang||"'","") RETURNING g_rtn_fields
       LET r_ooidl003 = '', g_rtn_fields[1] , ''
       RETURN r_ooidl003
END FUNCTION]]>
  </point>
  <point name="function.adbt500_xmda020_ref" order="16" ver="1" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[#運送方式顯示
PRIVATE FUNCTION adbt500_xmda020_ref(p_xmda020)
DEFINE p_xmda020   LIKE xmda_t.xmda020
DEFINE r_oocql004  LIKE oocql_t.oocql004

       INITIALIZE g_ref_fields TO NULL
       LET g_ref_fields[1] = p_xmda020
       CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='263' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
       LET r_oocql004 = '', g_rtn_fields[1] , ''
       RETURN r_oocql004
END FUNCTION]]>
  </point>
  <point name="function.adbt500_xmda023_ref" order="17" ver="1" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[#銷售通路顯示
PRIVATE FUNCTION adbt500_xmda023_ref(p_xmda023)
DEFINE p_xmda023   LIKE xmda_t.xmda023
DEFINE r_oocql004  LIKE oocql_t.oocql004

       INITIALIZE g_ref_fields TO NULL
       LET g_ref_fields[1] = p_xmda023
       CALL ap_ref_array2(g_ref_fields,"SELECT oojdl003 FROM oojdl_t WHERE oojdlent='"||g_enterprise||"' AND oojdl001=? AND oojdl002='"||g_dlang||"'","") RETURNING g_rtn_fields
       LET r_oocql004 = '', g_rtn_fields[1] , ''
       RETURN r_oocql004   
       
END FUNCTION]]>
  </point>
  <point name="function.adbt500_xmda023_chk" order="18" ver="1" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[#銷售通路檢查
PRIVATE FUNCTION adbt500_xmda023_chk(p_xmda023)
DEFINE p_xmda023    LIKE xmda_t.xmda023
DEFINE r_success    LIKE type_t.num5

       LET r_success = TRUE

       IF NOT cl_null(p_xmda023) THEN
          IF NOT s_azzi650_chk_exist('275',p_xmda023) THEN
             LET r_success = FALSE
             RETURN r_success
          END IF
       END IF
       RETURN r_success
END FUNCTION]]>
  </point>
  <point name="function.adbt500_xmda024_ref" order="19" ver="1" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[#銷售分類顯示
PRIVATE FUNCTION adbt500_xmda024_ref(p_xmda024)
DEFINE p_xmda024   LIKE xmda_t.xmda024
DEFINE r_oocql004  LIKE oocql_t.oocql004

       INITIALIZE g_ref_fields TO NULL
       LET g_ref_fields[1] = p_xmda024
       CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='295' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
       LET r_oocql004 = '', g_rtn_fields[1] , ''
       RETURN r_oocql004
END FUNCTION]]>
  </point>
  <point name="function.adbt500_xmda024_chk" order="20" ver="1" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[#銷售分類檢查
PRIVATE FUNCTION adbt500_xmda024_chk(p_xmda024)
DEFINE p_xmda024    LIKE xmda_t.xmda024
DEFINE r_success    LIKE type_t.num5

       LET r_success = TRUE

       IF NOT cl_null(p_xmda024) THEN
          IF NOT s_azzi650_chk_exist('295',p_xmda024) THEN
             LET r_success = FALSE
             RETURN r_success
          END IF
       END IF
       RETURN r_success
END FUNCTION]]>
  </point>
  <point name="function.adbt500_xmda025_ref" order="21" ver="1" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[#地址簡要說明
PRIVATE FUNCTION adbt500_xmda025_ref(p_pmaa027,p_oofb019)
DEFINE p_pmaa027   LIKE pmaa_t.pmaa025
DEFINE p_oofb019   LIKE oofb_t.oofb019
DEFINE r_oofb011   LIKE oofb_t.oofb011
       
       LET r_oofb011 =  ''
       SELECT oofb011 INTO r_oofb011 FROM oofb_t 
        WHERE oofbent = g_enterprise 
          AND oofb002 = p_pmaa027 
          AND oofb008 = '3' 
          AND oofb019 = p_oofb019
       RETURN r_oofb011
END FUNCTION]]>
  </point>
  <point name="function.adbt500_xmda025_desc" order="22" ver="1" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adbt500_xmda025_desc()
  DEFINE l_pmaa027   LIKE pmaa_t.pmaa027
  DEFINE r_address   STRING
  DEFINE r_success   LIKE type_t.num5     

      #收貨地址
      LET l_pmaa027 = ''
      LET r_address = '' 
      LET g_xmda_m.xmda025 = ''
      LET g_xmda_m.xmda025_desc = ''
      LET g_xmda_m.xmda206 = ''
      LET g_xmda_m.xmda207 = ''
      LET g_xmda_m.oofb017 = ''
      IF NOT cl_null(g_xmda_m.xmda022) THEN    
         CALL adbt500_get_pmaa027(g_xmda_m.xmda022) RETURNING l_pmaa027
         SELECT oofb019,oofb022 INTO g_xmda_m.xmda025,g_xmda_m.xmda206 FROM oofb_t
          WHERE oofbent = g_enterprise
            AND oofb002 = l_pmaa027 AND oofb008 = '3' 
            AND oofbstus = 'Y' AND oofb010 = 'Y' AND rownum = 1 
         IF cl_null(g_xmda_m.xmda025) THEN
            SELECT oofb019,oofb022 INTO g_xmda_m.xmda025,g_xmda_m.xmda206 FROM oofb_t
             WHERE oofbent = g_enterprise
               AND oofb002 = l_pmaa027 AND oofb008 = '3' 
               AND oofbstus = 'Y' AND rownum = 1      
         END IF 
         CALL adbt500_xmda025_ref(l_pmaa027,g_xmda_m.xmda025) RETURNING g_xmda_m.xmda025_desc
         
         IF NOT cl_null(g_xmda_m.xmda025) THEN
            CALL s_aooi350_get_address(l_pmaa027,g_xmda_m.xmda025,g_lang)RETURNING r_success,r_address
            LET g_xmda_m.oofb017 = r_address
         ELSE
            LET g_xmda_m.oofb017 = ''
         END IF
         
         IF NOT cl_null(g_xmda_m.xmda206) THEN
            SELECT dbaf001 INTO g_xmda_m.xmda207
              FROM dbaf_t
             WHERE dbafent = g_enterprise
               AND dbaf002 = '1'
               AND dbaf003 = g_xmda_m.xmda206 
               AND dbafstus = 'Y'
            IF cl_null(g_xmda_m.xmda207) THEN 
               SELECT dbaf001 INTO g_xmda_m.xmda207
                 FROM dbaf_t
                WHERE dbafent = g_enterprise
                  AND dbaf002 = '1'
                  AND dbaf003 = g_xmda_m.xmda206 
                  AND dbafstus = 'Y'
                  AND rownum = 1 
            END IF
         ELSE
            LET g_xmda_m.xmda207 = ''    
         END IF
      END IF
      DISPLAY BY NAME g_xmda_m.xmda025,g_xmda_m.xmda025_desc,
                      g_xmda_m.xmda206,g_xmda_m.xmda207,
                      g_xmda_m.oofb017
      CALL adbt500_xmda206_ref()
      CALL adbt500_xmda207_ref()
END FUNCTION]]>
  </point>
  <point name="function.adbt500_xmda026_ref" order="23" ver="1" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adbt500_xmda026_ref(p_pmaa027,p_oofb019)
DEFINE p_pmaa027   LIKE pmaa_t.pmaa025
DEFINE p_oofb019   LIKE oofb_t.oofb019
DEFINE r_oofb011   LIKE oofb_t.oofb011
       
       LET r_oofb011 =  ''
       SELECT oofb011 INTO r_oofb011 FROM oofb_t 
        WHERE oofbent = g_enterprise 
          AND oofb002 = p_pmaa027 
          AND oofb008 = '5' 
          AND oofb019 = p_oofb019
       RETURN r_oofb011
END FUNCTION]]>
  </point>
  <point name="function.adbt500_xmda026_desc" order="24" ver="1" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adbt500_xmda026_desc()
  DEFINE l_pmaa027   LIKE pmaa_t.pmaa027
  DEFINE r_address   STRING
  DEFINE r_success   LIKE type_t.num5  

      #收款地址
      LET l_pmaa027 = ''
      LET r_address = ''
      LET g_xmda_m.xmda026 = ''
      LET g_xmda_m.xmda026_desc = ''
      LET g_xmda_m.oofb017_1 = ''
      
      IF NOT cl_null(g_xmda_m.xmda021) THEN      
         CALL adbt500_get_pmaa027(g_xmda_m.xmda021) RETURNING l_pmaa027
         
         SELECT oofb019 INTO g_xmda_m.xmda026 FROM oofb_t
          WHERE oofbent = g_enterprise
            AND oofb002 = l_pmaa027  AND oofb008 = '5' 
            AND oofbstus = 'Y' AND oofb010 = 'Y' AND rownum = 1 
         IF cl_null(g_xmda_m.xmda026) THEN
            SELECT oofb019 INTO g_xmda_m.xmda026 FROM oofb_t
             WHERE oofbent = g_enterprise
               AND oofb002 = l_pmaa027 AND oofb008 = '5' 
               AND oofbstus = 'Y' AND rownum = 1      
         END IF
         CALL adbt500_xmda025_ref(l_pmaa027,g_xmda_m.xmda026) RETURNING g_xmda_m.xmda026_desc
         
         IF NOT cl_null(g_xmda_m.xmda026) THEN
            CALL s_aooi350_get_address(l_pmaa027,g_xmda_m.xmda026,g_lang)RETURNING r_success,r_address
            LET g_xmda_m.oofb017_1 = r_address
         ELSE
            LET g_xmda_m.oofb017_1 = ''
         END IF 
      END IF
      DISPLAY BY NAME g_xmda_m.xmda026,g_xmda_m.xmda026_desc 
      DISPLAY BY NAME g_xmda_m.oofb017_1
END FUNCTION]]>
  </point>
  <point name="function.adbt500_xmda027_ref" order="25" ver="1" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adbt500_xmda027_ref(p_xmda027)
DEFINE p_xmda027   LIKE xmda_t.xmda027
DEFINE r_oofa011   LIKE oofa_t.oofa011

       LET r_oofa011 = ''
       SELECT oofa011 INTO r_oofa011 FROM oofa_t WHERE oofaent=g_enterprise AND oofa001=p_xmda027
       RETURN r_oofa011
END FUNCTION]]>
  </point>
  <point name="function.adbt500_xmda032_ref" order="26" ver="1" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[#留置原因顯示
PRIVATE FUNCTION adbt500_xmda032_ref(p_xmda032)
DEFINE p_xmda032   LIKE xmda_t.xmda032
DEFINE r_oocql004  LIKE oocql_t.oocql004

       INITIALIZE g_ref_fields TO NULL
       LET g_ref_fields[1] = p_xmda032
       CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='297' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
       LET r_oocql004 = '', g_rtn_fields[1] , ''
       RETURN r_oocql004   
             
END FUNCTION]]>
  </point>
  <point name="function.adbt500_xmda035_ref" order="27" ver="1" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[#發票類型顯示
PRIVATE FUNCTION adbt500_xmda035_ref(p_xmda035)
DEFINE p_xmda035    LIKE xmda_t.xmda035
DEFINE r_isacl004   LIKE isacl_t.isacl004
DEFINE l_ooef019    LIKE ooef_t.ooef019
        
        IF NOT cl_null(g_xmda_m.xmdasite) THEN
           SELECT ooef019 INTO l_ooef019 FROM ooef_t WHERE ooefent = g_enterprise AND ooef001 = g_xmda_m.xmdasite
        ELSE
           SELECT ooef019 INTO l_ooef019 FROM ooef_t WHERE ooefent = g_enterprise AND ooef001 = g_site
        END IF
        
        INITIALIZE g_ref_fields TO NULL
        LET g_ref_fields[1] = p_xmda035
                    CALL ap_ref_array2(g_ref_fields,"SELECT isacl004 FROM isacl_t WHERE isaclent='"||g_enterprise||"' AND isacl001= '"||l_ooef019||"' AND isacl002=? AND isacl003='"||g_dlang||"'","") RETURNING g_rtn_fields
        LET r_isacl004 = '', g_rtn_fields[1] , ''
        RETURN r_isacl004
         
END FUNCTION]]>
  </point>
  <point name="function.adbt500_xmdadocno_ref" order="28" ver="2" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[#抓取單據別說明
PRIVATE FUNCTION adbt500_xmdadocno_ref()
DEFINE l_flag            LIKE type_t.num5
DEFINE l_site            LIKE ooef_t.ooef005
DEFINE l_slip            LIKE oobal_t.oobal002

   LET g_xmda_m.xmdadocno_desc = ''
   DISPLAY BY NAME g_xmda_m.xmdadocno_desc

   IF cl_null(g_xmda_m.xmdadocno) THEN
      RETURN
   END IF


   #抓取單據別
   CALL s_aooi200_get_slip(g_xmda_m.xmdadocno) RETURNING l_flag,l_slip
   IF NOT l_flag THEN
      RETURN
   END IF

   #抓取單據別說明
   SELECT oobxl003 INTO g_xmda_m.xmdadocno_desc
     FROM oobxl_t
    WHERE oobxlent = g_enterprise
      AND oobxl001 = l_slip
      AND oobxl002 = g_dlang

   DISPLAY BY NAME g_xmda_m.xmdadocno_desc
END FUNCTION]]>
  </point>
  <point name="function.adbt500_xmdasite_ref" order="29" ver="2" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adbt500_xmdasite_ref()
      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_xmda_m.xmdasite
      CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
      LET g_xmda_m.xmdasite_desc = '', g_rtn_fields[1] , ''
      DISPLAY BY NAME g_xmda_m.xmdasite_desc
END FUNCTION]]>
  </point>
  <point name="function.adbt500_xmdaunit_ref" order="30" ver="2" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adbt500_xmdaunit_ref()
      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_xmda_m.xmdaunit
      CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
      LET g_xmda_m.xmdaunit_desc = '', g_rtn_fields[1] , ''
      DISPLAY BY NAME g_xmda_m.xmdaunit_desc
END FUNCTION]]>
  </point>
  <point name="function.adbt500_xmda200_ref" order="31" ver="2" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adbt500_xmda200_ref()
      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_xmda_m.xmda200
      CALL ap_ref_array2(g_ref_fields,"SELECT pmaal004 FROM pmaal_t WHERE pmaalent='"||g_enterprise||"' AND pmaal001=? AND pmaal002='"||g_dlang||"'","") RETURNING g_rtn_fields
      LET g_xmda_m.xmda200_desc = '', g_rtn_fields[1] , ''
      DISPLAY BY NAME g_xmda_m.xmda200_desc
END FUNCTION]]>
  </point>
  <point name="function.adbt500_xmda201_ref" order="32" ver="2" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adbt500_xmda201_ref()
      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_xmda_m.xmda201
      CALL ap_ref_array2(g_ref_fields,"SELECT pmaal004 FROM pmaal_t WHERE pmaalent='"||g_enterprise||"' AND pmaal001=? AND pmaal002='"||g_dlang||"'","") RETURNING g_rtn_fields
      LET g_xmda_m.xmda201_desc = '', g_rtn_fields[1] , ''
      DISPLAY BY NAME g_xmda_m.xmda201_desc
END FUNCTION]]>
  </point>
  <point name="function.adbt500_xmda202_ref" order="33" ver="2" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adbt500_xmda202_ref()
      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_xmda_m.xmda202
      CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
      LET g_xmda_m.xmda202_desc = '', g_rtn_fields[1] , ''
      DISPLAY BY NAME g_xmda_m.xmda202_desc
END FUNCTION]]>
  </point>
  <point name="function.adbt500_xmda202_chk" order="34" ver="2" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adbt500_xmda202_chk()
DEFINE l_cnt     LIKE type_t.num5
DEFINE r_return  LIKE type_t.num5

      LET r_return = TRUE
      IF NOT cl_null(g_xmda_m.xmda202) 
         AND cl_null(g_xmda_m.xmda023) THEN
         SELECT COUNT(*)
           INTO l_cnt
           FROM dbbc_t
          WHERE dbbc002 = g_xmda_m.xmdasite
            AND dbbc005 = g_xmda_m.xmda202
          IF l_cnt = 0 THEN
             CALL cl_err("",'adb-00042',1)
             LET r_return = FALSE
             RETURN r_return
          END IF
      END IF
      IF NOT cl_null(g_xmda_m.xmda023) 
         AND cl_null(g_xmda_m.xmda202) THEN
         SELECT COUNT(*)
           INTO l_cnt
           FROM dbbc_t
          WHERE dbbc002 = g_xmda_m.xmdasite
            AND dbbc003 = g_xmda_m.xmda023
          IF l_cnt = 0 THEN
             CALL cl_err("",'adb-00042',1)
             LET r_return = FALSE
             RETURN r_return
          END IF
      END IF
      IF NOT cl_null(g_xmda_m.xmda202) 
         AND NOT cl_null(g_xmda_m.xmda023) THEN
         SELECT COUNT(*)
           INTO l_cnt
           FROM dbbc_t
          WHERE dbbc002 = g_xmda_m.xmdasite
            AND dbbc005 = g_xmda_m.xmda202
            AND dbbc003 = g_xmda_m.xmda023
          IF l_cnt = 0 THEN
             CALL cl_err("",'adb-00042',1)
             LET r_return = FALSE
             RETURN r_return
          END IF
      END IF
      RETURN r_return
END FUNCTION]]>
  </point>
  <point name="function.adbt500_xmda203_ref" order="35" ver="2" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adbt500_xmda203_ref()
      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_xmda_m.xmda203
      CALL ap_ref_array2(g_ref_fields,"SELECT pmaal004 FROM pmaal_t WHERE pmaalent='"||g_enterprise||"' AND pmaal001=? AND pmaal002='"||g_dlang||"'","") RETURNING g_rtn_fields
      LET g_xmda_m.xmda203_desc = '', g_rtn_fields[1] , ''
      DISPLAY BY NAME g_xmda_m.xmda203_desc
END FUNCTION]]>
  </point>
  <point name="function.adbt500_xmda204_ref" order="36" ver="2" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adbt500_xmda204_ref()
      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_xmda_m.xmda204
      CALL ap_ref_array2(g_ref_fields,"SELECT prcfl003 FROM prcfl_t WHERE prcflent='"||g_enterprise||"' AND prcfl001=? AND prcfl002='"||g_dlang||"'","") RETURNING g_rtn_fields
      LET g_xmda_m.xmda204_desc = '', g_rtn_fields[1] , ''
      DISPLAY BY NAME g_xmda_m.xmda204_desc
END FUNCTION]]>
  </point>
  <point name="function.adbt500_xmda206_ref" order="37" ver="2" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adbt500_xmda206_ref()
      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_xmda_m.xmda206
      CALL ap_ref_array2(g_ref_fields,"SELECT dbadl003 FROM dbadl_t WHERE dbadlent='"||g_enterprise||"' AND dbadl001=? AND dbadl002='"||g_dlang||"'","") RETURNING g_rtn_fields
      LET g_xmda_m.xmda206_desc = '', g_rtn_fields[1] , ''
      DISPLAY BY NAME g_xmda_m.xmda206_desc
END FUNCTION]]>
  </point>
  <point name="function.adbt500_xmda207_ref" order="38" ver="2" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adbt500_xmda207_ref()
      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_xmda_m.xmda207
      CALL ap_ref_array2(g_ref_fields,"SELECT dbabl003 FROM dbabl_t WHERE dbablent='"||g_enterprise||"' AND dbabl001=? AND dbabl002='"||g_dlang||"'","") RETURNING g_rtn_fields
      LET g_xmda_m.xmda207_desc = '', g_rtn_fields[1] , ''
      DISPLAY BY NAME g_xmda_m.xmda207_desc
END FUNCTION]]>
  </point>
  <point name="function.adbt500_xmdc001_chk" order="39" ver="2" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[#料件編號檢查
PRIVATE FUNCTION adbt500_xmdc001_chk(p_xmdc001)
DEFINE p_xmdc001     LIKE xmdc_t.xmdc001
DEFINE l_flag        LIKE type_t.num5
DEFINE l_success     LIKE type_t.num5
DEFINE r_success     LIKE type_t.num5

       LET r_success = TRUE
       
       IF NOT cl_null(p_xmdc001) THEN 
          #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
          INITIALIZE g_chkparam.* TO NULL
          
          #設定g_chkparam.*的參數
          LET g_chkparam.arg1 = p_xmdc001
             
          #呼叫檢查存在並帶值的library
          IF cl_chk_exist("v_imaa001_5") THEN
             IF NOT cl_chk_exist("v_imaf001_1") THEN
                LET r_success = FALSE
                RETURN r_success
             END IF
          ELSE
             LET r_success = FALSE
             RETURN r_success
          END IF
          
          #判斷輸入的料件編號是否在控制組限制的產品範圍內，若不在限制內則不允許訂購此料
          CALL s_control_chk_group('3','2',g_user,g_dept,p_xmdc001,'','','','') RETURNING l_success,l_flag
          IF NOT l_success THEN      #處理狀態
             LET r_success = FALSE
             RETURN r_success
          ELSE
             IF NOT l_flag THEN      #是否存在
                CALL cl_err(p_xmdc001,'axm-00046',1)
                LET r_success = FALSE
                RETURN r_success
             END IF 
          END IF
          
          #檢核輸入的料件的生命週期是否在單據別限制範圍內，若不在限制內則不允許請購此料
          CALL s_control_chk_doc('4',g_xmda_m.xmdadocno,p_xmdc001,'','','','') RETURNING l_success,l_flag
          IF NOT l_success THEN      #處理狀態
             LET r_success = FALSE
             RETURN r_success
          ELSE
             IF NOT l_flag THEN      #是否存在
                CALL cl_err(p_xmdc001,'ain-00015',1)
                LET r_success = FALSE
                RETURN r_success
             END IF 
          END IF
          
          #檢核輸入的料件的產品分類是否在單據別限制範圍內，若不在限制內則不允訂請購此料
          CALL s_control_chk_doc('5',g_xmda_m.xmdadocno,p_xmdc001,'','','','') RETURNING l_success,l_flag
          IF NOT l_success THEN      #處理狀態
             LET r_success = FALSE
             RETURN r_success
          ELSE
             IF NOT l_flag THEN      #是否存在
                LET r_success = FALSE
                #CALL cl_err(p_xmdc001,'apm-00238',1)
                RETURN r_success
             END IF 
          END IF
       END IF
       RETURN r_success
END FUNCTION]]>
  </point>
  <point name="function.adbt500_xmdc001_ref" order="40" ver="2" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[#料件編號帶品名、規格
PRIVATE FUNCTION adbt500_xmdc001_ref(p_xmdc001)
DEFINE p_xmdc001     LIKE xmdc_t.xmdc001
DEFINE r_imaal003    LIKE imaal_t.imaal003
DEFINE r_imaal004    LIKE imaal_t.imaal004

       INITIALIZE g_ref_fields TO NULL
       LET g_ref_fields[1] = p_xmdc001
       CALL ap_ref_array2(g_ref_fields,"SELECT imaal003,imaal004 FROM imaal_t WHERE imaalent='"||g_enterprise||"' AND imaal001=? AND imaal002='"||g_dlang||"'","") RETURNING g_rtn_fields
       LET r_imaal003 = '', g_rtn_fields[1] , ''
       LET r_imaal004 = '', g_rtn_fields[2] , ''
       RETURN r_imaal003,r_imaal004
END FUNCTION]]>
  </point>
  <point name="function.adbt500_xmdc001_desc" order="41" ver="2" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[#根據料件編號、供應商、銷售控制組帶出欄位預設值
PRIVATE FUNCTION adbt500_xmdc001_desc()
DEFINE l_n           LIKE type_t.num5
DEFINE l_success     LIKE type_t.num5
DEFINE l_controlno   LIKE ooha_t.ooha001
DEFINE l_imaf158     LIKE imaf_t.imaf158
DEFINE l_imaf122     LIKE imaf_t.imaf122
DEFINE l_pmao004     LIKE pmao_t.pmao004
DEFINE l_oodbl004    LIKE oodbl_t.oodbl004  #稅別名稱
DEFINE l_oodb005     LIKE oodb_t.oodb005    #含稅否
DEFINE l_oodb006     LIKE oodb_t.oodb006    #稅率 
DEFINE l_oodb011     LIKE oodb_t.oodb011    #取得稅別類型1:正常稅率2:依料件設定  


      LET l_n = 0
      LET g_xmdc_d[l_ac].xmdc006 = ''               #銷售單位
      LET g_xmdc_d[l_ac].xmdc006_desc = ''   
      LET g_xmdc_d[l_ac].xmdc010 = ''               #計價單位
      LET g_xmdc_d[l_ac].xmdc010_desc = ''      

      
      #先判斷這個供應商是否有設多個當前銷售控制組範圍內的客戶預設條件，則開窗，讓user 選擇帶哪一個控制組的資料
      LET l_controlno = ''
      CALL s_control_get_group('2',g_xmda_m.xmda002,g_xmda_m.xmda003) RETURNING l_success,l_controlno
      
      IF NOT cl_null(l_controlno) THEN
         SELECT COUNT(*) INTO l_n FROM xmaf_t 
            WHERE xmafent = g_enterprise AND xmafsite = g_xmda_m.xmdasite AND xmaf001 = g_xmda_m.xmda004
              AND xmaf002 = l_controlno AND xmaf003 = g_xmdc_d[l_ac].xmdc001 AND xmaf004 = g_xmdc_d[l_ac].xmdc002
         #若訂購料件有設置客戶料件預設條件'(axmi121)時，則需將設置的預設條件值預設到訂購單對應欄位
         IF l_n > 0 THEN
            LET g_xmdc_d[l_ac].xmdc008 = ''              #參考單位
            LET g_xmdc_d[l_ac].xmdc008_desc = ''   
            LET g_xmdc_d[l_ac].xmdcunit = ''             #出貨據點
            LET g_xmdc_d[l_ac].xmdcunit_desc = ''  
            SELECT xmaf006,xmaf007,xmaf008,xmaf009
              INTO g_xmdc_d[l_ac].xmdc006,g_xmdc_d[l_ac].xmdc008,g_xmdc_d[l_ac].xmdc010,g_xmdc_d[l_ac].xmdcunit
              FROM xmaf_t 
             WHERE xmafent = g_enterprise AND xmafsite = g_xmda_m.xmdasite AND xmaf001 = g_xmda_m.xmda004
               AND xmaf002 = l_controlno AND xmaf003 = g_xmdc_d[l_ac].xmdc001 AND xmaf004 = g_xmdc_d[l_ac].xmdc002
            CALL adbt500_unit_ref(g_xmdc_d[l_ac].xmdc008) RETURNING g_xmdc_d[l_ac].xmdc008_desc   
            CALL adbt500_xmda003_ref(g_xmdc_d[l_ac].xmdcunit) RETURNING g_xmdc_d[l_ac].xmdcunit_desc
         END IF
      END IF
      
      IF cl_null(l_controlno) OR l_n = 0 THEN        
         #沒有設置'客戶控制組料件預設條件改抓料件進銷存檔預設的條件
         SELECT imaf112,imaf113
           INTO g_xmdc_d[l_ac].xmdc006,g_xmdc_d[l_ac].xmdc010
           FROM imaf_t
         WHERE imafent = g_enterprise AND imafsite = g_xmda_m.xmdasite AND imaf001 = g_xmdc_d[l_ac].xmdc001  
      END IF

      CALL adbt500_unit_ref(g_xmdc_d[l_ac].xmdc006) RETURNING g_xmdc_d[l_ac].xmdc006_desc      
      CALL adbt500_unit_ref(g_xmdc_d[l_ac].xmdc010) RETURNING g_xmdc_d[l_ac].xmdc010_desc
      
      DISPLAY BY NAME g_xmdc_d[l_ac].xmdc006,g_xmdc_d[l_ac].xmdc006_desc,
                      g_xmdc_d[l_ac].xmdc008,g_xmdc_d[l_ac].xmdc008_desc,
                      g_xmdc_d[l_ac].xmdc010,g_xmdc_d[l_ac].xmdc010_desc,
                      g_xmdc_d[l_ac].xmdcunit,g_xmdc_d[l_ac].xmdcunit_desc

            
      #若稅別應用為2.依料件設定，呼叫應用元件帶出稅別、稅率
      IF g_tax_app = '2' THEN
         CALL s_tax_chktype(g_xmda_m.xmdasite,g_xmda_m.xmda004,g_xmdc_d[l_ac].xmdc001,'1',g_pmab089)
           RETURNING l_success,g_xmdc_d[l_ac].xmdc016,g_xmdc_d[l_ac].xmdc017
         IF adbt500_xmda011_chk('2',g_xmdc_d[l_ac].xmdc016) THEN
            #帶出單身稅率
            LET l_oodb006 = ''
            CALL s_tax_chk(g_xmda_m.xmdasite,g_xmdc_d[l_ac].xmdc016)
              RETURNING l_success,g_oodbl004,l_oodb005,l_oodb006,l_oodb011     
            IF l_success THEN
               LET g_xmdc_d[l_ac].xmdc017 = l_oodb006
            END IF
         ELSE
            #檢查失敗時後續處理
            LET g_xmdc_d[l_ac].xmdc016 = ''
            LET g_xmdc_d[l_ac].xmdc017 = ''
         END IF           
      ELSE
         LET g_xmdc_d[l_ac].xmdc016 = g_xmda_m.xmda011
         LET g_xmdc_d[l_ac].xmdc017 = g_xmda_m.xmda012
      END IF      
      CALL adbt500_xmda011_ref(g_xmdc_d[l_ac].xmdc016) RETURNING g_xmdc_d[l_ac].xmdc016_desc         
      DISPLAY BY NAME g_xmdc_d[l_ac].xmdc016,g_xmdc_d[l_ac].xmdc016_desc,g_xmdc_d[l_ac].xmdc017
      
      #3.若[T:料件進銷存檔].[C:接單拆解方式(訂單)]的值為'1:自動CKD'或是'2:自動SKD'時，則[C:子件特性]的值預設'2:CKD'或是'3:SKD'
      SELECT imaf122 INTO l_imaf122 FROM imaf_t
       WHERE imafent = g_enterprise AND imafsite = g_xmda_m.xmdasite AND imaf001 = g_xmdc_d[l_ac].xmdc001
      IF l_imaf122 = '1' THEN
         LET g_xmdc_d[l_ac].xmdc019 = '2'
      ELSE
         IF l_imaf122 = '2' THEN
            LET g_xmdc_d[l_ac].xmdc019 = '3'
         END IF
      END IF      
      DISPLAY BY NAME g_xmdc_d[l_ac].xmdc019
      #4.如果整體參數使用訂單計價單位時:[C:計價單位]=[T:料件據點進銷存檔].[C:訂單計價單位] 
      #5.若訂單料件有設置'交易對象對應料號'(apmi070)有客戶料號時，需將對應的料號抓出顯示在[C:客戶料號]欄位上，若有設置多筆對應料號時以有勾選主要對應料那一筆為預設值
      IF cl_null(g_xmdc_d[l_ac].xmdc027) THEN
         SELECT pmao004 INTO l_pmao004
           FROM pmao_t
          WHERE pmaoent = g_enterprise
            AND pmao001 = g_xmda_m.xmda004
            AND pmao002 = g_xmdc_d[l_ac].xmdc001
            AND pmao003 = g_xmdc_d[l_ac].xmdc002
            AND pmao007 = 'Y'
         IF cl_null(l_pmao004) THEN
            SELECT pmao004 INTO l_pmao004
              FROM pmao_t
             WHERE pmaoent = g_enterprise
               AND pmao001 = g_xmda_m.xmda004
               AND pmao002 = g_xmdc_d[l_ac].xmdc001
               AND pmao003 = g_xmdc_d[l_ac].xmdc002
               AND rownum = 1
         END IF
         LET g_xmdc_d[l_ac].xmdc027 =  l_pmao004
         DISPLAY BY NAME g_xmdc_d[l_ac].xmdc027        
       END IF          
END FUNCTION]]>
  </point>
  <point name="function.adbt500_xmdc003_ref" order="42" ver="2" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[#包裝容器顯示
PRIVATE FUNCTION adbt500_xmdc003_ref(p_xmdc003)
DEFINE p_xmdc003     LIKE xmdc_t.xmdc003
DEFINE r_imaal003    LIKE imaal_t.imaal003

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = p_xmdc003
            CALL ap_ref_array2(g_ref_fields,"SELECT imaal003 FROM imaal_t WHERE imaalent='"||g_enterprise||"' AND imaal001=? AND imaal002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET  r_imaal003 = '', g_rtn_fields[1] , ''
            RETURN r_imaal003

END FUNCTION]]>
  </point>
  <point name="function.adbt500_xmdc004_ref" order="43" ver="2" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[#作業編號說明
PRIVATE FUNCTION adbt500_xmdc004_ref(p_xmdc004)
DEFINE p_xmdc004   LIKE xmdc_t.xmdc004
DEFINE r_oocql004  LIKE oocql_t.oocql004

       INITIALIZE g_ref_fields TO NULL
       LET g_ref_fields[1] = p_xmdc004
       CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='221' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
       LET r_oocql004 = '', g_rtn_fields[1] , ''
       RETURN r_oocql004
END FUNCTION]]>
  </point>
  <point name="function.adbt500_xmdc012_to_xmdc020" order="44" ver="2" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[#根據交貨日期計算緊急度
PRIVATE FUNCTION adbt500_xmdc012_to_xmdc020()
DEFINE l_imae071    LIKE imae_t.imae071  #固定
DEFINE l_imae072    LIKE imae_t.imae072  #變動
DEFINE l_imae074    LIKE imae_t.imae074  #QC
DEFINE l_imae076    LIKE imae_t.imae076  #嚴守交期前置時間
DEFINE l_time1      LIKE imaf_t.imaf171
DEFINE l_time2      LIKE imaf_t.imaf171

        IF NOT cl_null(g_xmdc_d[l_ac].xmdc012) THEN
           LET l_imae071 = 0   
           LET l_imae072 = 0   
           LET l_imae074 = 0  
           LET l_imae076 = 0             
           LET l_time1 = 0
           LET l_time2 = 0

          SELECT imae071,imae072,imae074,imae076 
            INTO l_imae071,l_imae072,l_imae074,l_imae076
            FROM imae_t
           WHERE imaeent = g_enterprise AND imaesite = g_xmda_m.xmdasite 
             AND imae001 = g_xmdc_d[l_ac].xmdc001

          LET l_time1 = g_xmdc_d[l_ac].xmdc012 - g_today      #交貨日期  - g_today
          LET l_time2 = l_imae071 + l_imae072 + l_imae074     #[T:料件據點生管資料檔]設置的(固定+變動+QC)前置天數

          #若輸入的交貨日期 - g_today > [T:料件據點生管資料檔]設置的(固定+變動+QC)前置天數，則[C:緊急度] = '1'(一般)
          IF l_time1 >= l_time2 THEN
             LET g_xmdc_d[l_ac].xmdc020 = '1'
          END IF

          #若輸入的交貨日期 - g_today < [T:料件據點生管資料檔]設置的(固定+變動+QC)前置天數，
          #且約定交貨日期 - g_today >[T:料件據點生管資料檔].[C:嚴守交期前置時間]時，則[C:緊急度] = '2'(緊急)
          IF l_time1 < l_time2 AND l_time1 >= l_imae076 THEN
             LET g_xmdc_d[l_ac].xmdc020 = '2'
          END IF

          #若約定交貨日期 - g_today <[T:料件據點生管資料檔].[C:嚴守交期前置時間]時，則[C:緊急度] = '3'(特急)
          IF l_time1 < l_imae076 THEN
             LET g_xmdc_d[l_ac].xmdc020 = '3'
          END IF
       END IF
END FUNCTION]]>
  </point>
  <point name="function.adbt500_xmdc049_ref" order="45" ver="2" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[#理由碼帶值
PRIVATE FUNCTION adbt500_xmdc049_ref(p_xmdc049)
DEFINE p_xmdc049  LIKE xmdc_t.xmdc049
DEFINE r_oocql004 LIKE oocql_t.oocql004

        INITIALIZE g_ref_fields TO NULL
        LET g_ref_fields[1] = p_xmdc049
        CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='"||g_acc||"' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
        LET r_oocql004 = '', g_rtn_fields[1] , ''
        RETURN r_oocql004
END FUNCTION]]>
  </point>
  <point name="function.adbt500_xmdc049_chk" order="46" ver="2" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[#檢查理由碼
PRIVATE FUNCTION adbt500_xmdc049_chk(p_xmdc049)
DEFINE p_xmdc049  LIKE xmdc_t.xmdc049
DEFINE l_success  LIKE type_t.num5
DEFINE r_success  LIKE type_t.num5
DEFINE l_flag     LIKE type_t.num5

        LET r_success = TRUE
        
        IF NOT cl_null(p_xmdc049) THEN
           CALL s_azzi650_chk_exist(g_acc,p_xmdc049) RETURNING l_success
           IF NOT l_success THEN
               LET r_success = FALSE
               RETURN r_success
           END IF
           
           #檢核輸入的理由碼是否在單據別限制範圍內，若不在限制內則不允許使用此理由碼
           CALL s_control_chk_doc('8',g_xmda_m.xmdadocno,p_xmdc049,'','','','') RETURNING l_success,l_flag
           IF NOT r_success THEN
              LET r_success = FALSE
              RETURN r_success
           ELSE
              IF NOT l_flag THEN
                 LET r_success = FALSE
                 RETURN r_success
              END IF
           END IF
        END IF           
        RETURN r_success
END FUNCTION]]>
  </point>
  <point name="function.adbt500_xmdcunit_chk" order="47" ver="2" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[#檢查營運據點
PRIVATE FUNCTION adbt500_xmdcunit_chk(p_xmdcunit)
DEFINE p_xmdcunit   LIKE xmdc_t.xmdcunit
DEFINE l_success    LIKE type_t.num5
DEFINE l_flag       LIKE type_t.num5
DEFINE r_success    LIKE type_t.num5

       LET r_success = TRUE
       
       IF NOT cl_null(p_xmdcunit) THEN 
          #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
          INITIALIZE g_chkparam.* TO NULL
          
          #設定g_chkparam.*的參數
          LET g_chkparam.arg1 = p_xmdcunit
      
          #呼叫檢查存在並帶值的library
          IF NOT cl_chk_exist("v_ooef001") THEN
             LET r_success = FALSE
             RETURN r_success
          END IF
          #檢核輸入的營運據點是否在採購控制組的限制範圍內
          CALL s_control_chk_group('5','2',g_user,g_dept,p_xmdcunit ,'','','','') RETURNING l_success,l_flag
          IF NOT l_success THEN      #處理狀況
             LET r_success = FALSE
             RETURN r_success
          ELSE
             IF NOT l_flag THEN      #是否存在
                CALL cl_err(p_xmdcunit,'apm-00274',1)
                LET r_success = FALSE
                RETURN r_success
             END IF 
          END IF
       END IF 
       RETURN r_success
END FUNCTION]]>
  </point>
  <point name="function.adbt500_xmja003_ref" order="48" ver="2" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adbt500_xmja003_ref()
      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_xmdc4_d[l_ac].xmja003
      CALL ap_ref_array2(g_ref_fields,"SELECT imaal003,imaal004 FROM imaal_t WHERE imaalent='"||g_enterprise||"' AND imaal001=? AND imaal002='"||g_dlang||"'","") RETURNING g_rtn_fields
      LET g_xmdc4_d[l_ac].xmja003_desc = '', g_rtn_fields[1] , ''
      LET g_xmdc4_d[l_ac].xmja003_desc_desc = '', g_rtn_fields[2] , ''
      DISPLAY BY NAME g_xmdc4_d[l_ac].xmja003_desc
      DISPLAY BY NAME g_xmdc4_d[l_ac].xmja003_desc_desc
END FUNCTION]]>
  </point>
  <point name="function.adbt500_xmja003_default" order="49" ver="2" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adbt500_xmja003_default()
DEFINE l_success     LIKE type_t.num5
DEFINE l_oodbl004    LIKE oodbl_t.oodbl004  #稅別名稱
DEFINE l_oodb005     LIKE oodb_t.oodb005    #含稅否
DEFINE l_oodb006     LIKE oodb_t.oodb006    #稅率 
DEFINE l_oodb011     LIKE oodb_t.oodb011    #取得稅別類型1:正常稅率2:依料件設定  

   IF cl_null(g_xmdc4_d_t.xmja003) OR g_xmdc4_d[l_ac].xmja003 <> g_xmdc4_d_t.xmja003 THEN
      IF g_tax_app = '2' THEN
         CALL s_tax_chktype(g_xmda_m.xmdasite,g_xmda_m.xmda004,g_xmdc4_d[l_ac].xmja003,'1',g_pmab089)
         RETURNING l_success,g_xmdc4_d[l_ac].xmja006,g_xmdc4_d[l_ac].xmja007
         IF adbt500_xmda011_chk('2',g_xmdc4_d[l_ac].xmja006) THEN
            #帶出單身稅率
            LET l_oodb006 = ''
            CALL s_tax_chk(g_xmda_m.xmdasite,g_xmdc4_d[l_ac].xmja006)
              RETURNING l_success,l_oodbl004,l_oodb005,l_oodb006,l_oodb011     
            IF l_success THEN
               LET g_xmdc4_d[l_ac].xmja007 = l_oodb006
            END IF
            CALL adbt500_regen_amounts()
         ELSE
            #檢查失敗時後續處理
            LET g_xmdc4_d[l_ac].xmja006 = ''
            LET g_xmdc4_d[l_ac].xmja007 = ''
         END IF
      ELSE
         LET g_xmdc4_d[l_ac].xmja006 = g_xmda_m.xmda011 
         LET g_xmdc4_d[l_ac].xmja007 = g_xmda_m.xmda012
      END IF
      
      CALL adbt500_xmja006_ref()  
      
      SELECT imaf112,imaf113,imaf015
        INTO g_xmdc4_d[l_ac].xmja013,g_xmdc4_d[l_ac].xmja017,g_xmdc4_d[l_ac].xmja015
        FROM imaf_t   
       WHERE imafent = g_enterprise
         AND imafsite = g_xmda_m.xmdasite
         AND imaf001 = g_xmdc4_d[l_ac].xmja003
         
      CALL adbt500_xmja013_ref()  
      CALL adbt500_xmja017_ref()
      CALL adbt500_xmja015_ref()
   END IF
END FUNCTION]]>
  </point>
  <point name="function.adbt500_xmja005_ref" order="50" ver="2" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adbt500_xmja005_ref()
      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_xmdc4_d[l_ac].xmja005
      CALL ap_ref_array2(g_ref_fields,"SELECT prcfl003 FROM prcfl_t WHERE prcflent='"||g_enterprise||"' AND prcfl001=? AND prcfl002='"||g_dlang||"'","") RETURNING g_rtn_fields
      LET g_xmdc4_d[l_ac].xmja005_desc = '', g_rtn_fields[1] , ''
      DISPLAY BY NAME g_xmdc4_d[l_ac].xmja005_desc
END FUNCTION]]>
  </point>
  <point name="function.adbt500_xmja006_ref" order="51" ver="2" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adbt500_xmja006_ref()
DEFINE l_ooef019      LIKE ooef_t.ooef019

      SELECT ooef019 INTO l_ooef019 FROM ooef_t WHERE ooefent = g_enterprise AND ooef001 = g_xmda_m.xmdasite
      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_xmdc4_d[l_ac].xmja006
      CALL ap_ref_array2(g_ref_fields,"SELECT oodbl004 FROM oodbl_t WHERE oodblent='"||g_enterprise||"' AND oodbl001='"||l_ooef019||"' AND oodbl002=? AND oodbl003='"||g_dlang||"'","") RETURNING g_rtn_fields
      LET g_xmdc4_d[l_ac].xmja006_desc = '', g_rtn_fields[1] , ''
      DISPLAY BY NAME g_xmdc4_d[l_ac].xmja006_desc
END FUNCTION]]>
  </point>
  <point name="function.adbt500_xmja011_ref" order="52" ver="2" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adbt500_xmja011_ref()
      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_xmdc4_d[l_ac].xmja011
      CALL ap_ref_array2(g_ref_fields,"SELECT oocal003 FROM oocal_t WHERE oocalent='"||g_enterprise||"' AND oocal001=? AND oocal002='"||g_dlang||"'","") RETURNING g_rtn_fields
      LET g_xmdc4_d[l_ac].xmja011_desc = '', g_rtn_fields[1] , ''
      DISPLAY BY NAME g_xmdc4_d[l_ac].xmja011_desc
END FUNCTION]]>
  </point>
  <point name="function.adbt500_xmja013_ref" order="53" ver="2" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adbt500_xmja013_ref()
      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_xmdc4_d[l_ac].xmja013
      CALL ap_ref_array2(g_ref_fields,"SELECT oocal003 FROM oocal_t WHERE oocalent='"||g_enterprise||"' AND oocal001=? AND oocal002='"||g_dlang||"'","") RETURNING g_rtn_fields
      LET g_xmdc4_d[l_ac].xmja013_desc = '', g_rtn_fields[1] , ''
      DISPLAY BY NAME g_xmdc4_d[l_ac].xmja013_desc
END FUNCTION]]>
  </point>
  <point name="function.adbt500_xmja015_ref" order="54" ver="2" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adbt500_xmja015_ref()
      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_xmdc4_d[l_ac].xmja015
      CALL ap_ref_array2(g_ref_fields,"SELECT oocal003 FROM oocal_t WHERE oocalent='"||g_enterprise||"' AND oocal001=? AND oocal002='"||g_dlang||"'","") RETURNING g_rtn_fields
      LET g_xmdc4_d[l_ac].xmja015_desc = '', g_rtn_fields[1] , ''
      DISPLAY BY NAME g_xmdc4_d[l_ac].xmja015_desc
END FUNCTION]]>
  </point>
  <point name="function.adbt500_xmja017_ref" order="55" ver="2" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adbt500_xmja017_ref()
      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_xmdc4_d[l_ac].xmja017
      CALL ap_ref_array2(g_ref_fields,"SELECT oocal003 FROM oocal_t WHERE oocalent='"||g_enterprise||"' AND oocal001=? AND oocal002='"||g_dlang||"'","") RETURNING g_rtn_fields
      LET g_xmdc4_d[l_ac].xmja017_desc = '', g_rtn_fields[1] , ''
      DISPLAY BY NAME g_xmdc4_d[l_ac].xmja017_desc
END FUNCTION]]>
  </point>
  <point name="function.adbt500_xmja024_ref" order="56" ver="2" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adbt500_xmja024_ref()
      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_xmdc4_d[l_ac].xmja024
      CALL ap_ref_array2(g_ref_fields,"SELECT pmaal004 FROM pmaal_t WHERE pmaalent='"||g_enterprise||"' AND pmaal001=? AND pmaal002='"||g_dlang||"'","") RETURNING g_rtn_fields
      LET g_xmdc4_d[l_ac].xmja024_desc = '', g_rtn_fields[1] , ''
      DISPLAY BY NAME g_xmdc4_d[l_ac].xmja024_desc
END FUNCTION]]>
  </point>
  <point name="function.adbt500_xmja024_desc" order="57" ver="2" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adbt500_xmja024_desc()
  DEFINE l_pmaa027   LIKE pmaa_t.pmaa027  
      
      #送貨地址
      LET l_pmaa027 = ''                                      
      CALL adbt500_get_pmaa027(g_xmdc4_d[l_ac].xmja025) RETURNING l_pmaa027
      SELECT oofb019,oofb022 INTO g_xmdc4_d[l_ac].xmja026,g_xmdc4_d[l_ac].xmja027 FROM oofb_t
       WHERE oofbent = g_enterprise
         AND oofb002 = l_pmaa027 AND oofb008 = '3' 
         AND oofbstus = 'Y' AND oofb010 = 'Y' AND rownum = 1 

      CALL adbt500_xmja026_ref()
      #CALL adbt500_xmja027_ref()
END FUNCTION]]>
  </point>
  <point name="function.adbt500_xmja026_ref" order="58" ver="2" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adbt500_xmja026_ref()
  DEFINE l_pmaa027   LIKE pmaa_t.pmaa027
  DEFINE r_address   STRING
  DEFINE r_success   LIKE type_t.num5  
  
      LET l_pmaa027 = ''
      LET r_address = ''                                       
      CALL adbt500_get_pmaa027(g_xmdc4_d[l_ac].xmja025) RETURNING l_pmaa027
      IF NOT cl_null(g_xmdc4_d[l_ac].xmja026) THEN
         CALL s_aooi350_get_address(l_pmaa027,g_xmdc4_d[l_ac].xmja026,g_lang)RETURNING r_success,r_address
         LET g_xmdc4_d[l_ac].xmja026_desc = r_address
         DISPLAY BY NAME g_xmdc4_d[l_ac].xmja026_desc
      ELSE
         LET g_xmdc4_d[l_ac].xmja026_desc = ''
         DISPLAY BY NAME g_xmdc4_d[l_ac].xmja026_desc
      END IF
END FUNCTION]]>
  </point>
  <point name="function.adbt500_xmja027_ref" order="59" ver="2" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adbt500_xmja027_ref()
      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_xmdc4_d[l_ac].xmja027
      CALL ap_ref_array2(g_ref_fields,"SELECT dbadl003 FROM dbadl_t WHERE dbadlent='"||g_enterprise||"' AND dbadl001=? AND dbadl002='"||g_dlang||"'","") RETURNING g_rtn_fields
      LET g_xmdc4_d[l_ac].xmja027_desc = '', g_rtn_fields[1] , ''
      DISPLAY BY NAME g_xmdc4_d[l_ac].xmja027_desc
END FUNCTION]]>
  </point>
  <point name="function.adbt500_xmjasite_ref" order="60" ver="2" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adbt500_xmjasite_ref()
      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_xmdc4_d[l_ac].xmjasite
      CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
      LET g_xmdc4_d[l_ac].xmjasite_desc = '', g_rtn_fields[1] , ''
      DISPLAY BY NAME g_xmdc4_d[l_ac].xmjasite_desc
END FUNCTION]]>
  </point>
  <point name="function.adbt500_xmdd001_ref" order="61" ver="2" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adbt500_xmdd001_ref()
      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_xmdc3_d[l_ac].xmdd001
      CALL ap_ref_array2(g_ref_fields,"SELECT imaal003,imaal004 FROM imaal_t WHERE imaalent='"||g_enterprise||"' AND imaal001=? AND imaal002='"||g_dlang||"'","") RETURNING g_rtn_fields
      LET g_xmdc3_d[l_ac].xmdd001_desc = '', g_rtn_fields[1] , ''
      LET g_xmdc3_d[l_ac].xmdd001_desc_desc = '', g_rtn_fields[2] , ''
      DISPLAY BY NAME g_xmdc3_d[l_ac].xmdd001_desc
      DISPLAY BY NAME g_xmdc3_d[l_ac].xmdd001_desc_desc
END FUNCTION]]>
  </point>
  <point name="function.adbt500_xmddunit_ref" order="62" ver="2" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adbt500_xmddunit_ref()
      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_xmdc3_d[l_ac].xmddunit
      CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
      LET g_xmdc3_d[l_ac].xmddunit_desc = '', g_rtn_fields[1] , ''
      DISPLAY BY NAME g_xmdc3_d[l_ac].xmddunit_desc
END FUNCTION]]>
  </point>
  <point name="function.adbt500_xmdd200_ref" order="63" ver="2" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adbt500_xmdd200_ref()
      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_xmdc3_d[l_ac].xmdd200
      CALL ap_ref_array2(g_ref_fields,"SELECT prcfl003 FROM prcfl_t WHERE prcflent='"||g_enterprise||"' AND prcfl001=? AND prcfl002='"||g_dlang||"'","") RETURNING g_rtn_fields
      LET g_xmdc3_d[l_ac].xmdd200_desc = '', g_rtn_fields[1] , ''
      DISPLAY BY NAME g_xmdc3_d[l_ac].xmdd200_desc
END FUNCTION]]>
  </point>
  <point name="function.adbt500_xmdd201_ref" order="64" ver="2" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adbt500_xmdd201_ref()
      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_xmdc3_d[l_ac].xmdd201
      CALL ap_ref_array2(g_ref_fields,"SELECT oocal003 FROM oocal_t WHERE oocalent='"||g_enterprise||"' AND oocal001=? AND oocal002='"||g_dlang||"'","") RETURNING g_rtn_fields
      LET g_xmdc3_d[l_ac].xmdd201_desc = '', g_rtn_fields[1] , ''
      DISPLAY BY NAME g_xmdc3_d[l_ac].xmdd201_desc
END FUNCTION]]>
  </point>
  <point name="function.adbt500_xmdd207_ref" order="65" ver="2" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adbt500_xmdd207_ref()
      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_xmdc3_d[l_ac].xmdd207
      CALL ap_ref_array2(g_ref_fields,"SELECT pmaal004 FROM pmaal_t WHERE pmaalent='"||g_enterprise||"' AND pmaal001=? AND pmaal002='"||g_dlang||"'","") RETURNING g_rtn_fields
      LET g_xmdc3_d[l_ac].xmdd207_desc = '', g_rtn_fields[1] , ''
      DISPLAY BY NAME g_xmdc3_d[l_ac].xmdd207_desc
END FUNCTION]]>
  </point>
  <point name="function.adbt500_xmdd210_ref" order="66" ver="2" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adbt500_xmdd210_ref()
      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_xmdc3_d[l_ac].xmdd210
      CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='274' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
      LET g_xmdc3_d[l_ac].xmdd210_desc = '', g_rtn_fields[1] , ''
      DISPLAY BY NAME g_xmdc3_d[l_ac].xmdd210_desc
END FUNCTION]]>
  </point>
  <point name="function.adbt500_xmdd213_ref" order="67" ver="2" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adbt500_xmdd213_ref()
      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_xmdc3_d[l_ac].xmdd213
      LET g_ref_fields[2] = g_xmdc3_d[l_ac].xmddunit
      CALL ap_ref_array2(g_ref_fields,"SELECT inaa002 FROM inaa_t WHERE inaaent='"||g_enterprise||"' AND inaa001=?  AND inaasite=? ","") RETURNING g_rtn_fields
      LET g_xmdc3_d[l_ac].xmdd213_desc = '', g_rtn_fields[1] , ''
      DISPLAY BY NAME g_xmdc3_d[l_ac].xmdd213_desc
END FUNCTION]]>
  </point>
  <point name="function.adbt500_xmdd214_ref" order="68" ver="2" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adbt500_xmdd214_ref()
      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_xmdc3_d[l_ac].xmdd213
      LET g_ref_fields[2] = g_xmdc3_d[l_ac].xmdd214
      LET g_ref_fields[3] = g_xmdc3_d[l_ac].xmddunit
      CALL ap_ref_array2(g_ref_fields,"SELECT inab003 FROM inab_t WHERE inabent='"||g_enterprise||"' AND inab001=? AND inab002=? AND inabsite=? ","") RETURNING g_rtn_fields
      LET g_xmdc3_d[l_ac].xmdd214_desc = '', g_rtn_fields[1] , ''
      DISPLAY BY NAME g_xmdc3_d[l_ac].xmdd214_desc
END FUNCTION]]>
  </point>
  <point name="function.adbt500_xmdd218_ref" order="69" ver="2" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adbt500_xmdd218_ref()
      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] =  g_xmdc3_d[l_ac].xmdd218
      CALL ap_ref_array2(g_ref_fields,"SELECT oojdl003 FROM oojdl_t WHERE oojdlent='"||g_enterprise||"' AND oojdl001=? AND oojdl002='"||g_dlang||"'","") RETURNING g_rtn_fields
      LET g_xmdc3_d[l_ac].xmdd218_desc = '', g_rtn_fields[1] , ''
      DISPLAY BY NAME g_xmdc3_d[l_ac].xmdd218_desc
END FUNCTION]]>
  </point>
  <point name="function.adbt500_xmdd219_ref" order="70" ver="2" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adbt500_xmdd219_ref()
      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] =  g_xmdc3_d[l_ac].xmdd219
      CALL ap_ref_array2(g_ref_fields,"SELECT dbbal003 FROM dbbal_t WHERE dbbalent='"||g_enterprise||"' AND dbbal001=? AND dbbal002='"||g_dlang||"'","") RETURNING g_rtn_fields
      LET g_xmdc3_d[l_ac].xmdd219_desc = '', g_rtn_fields[1] , ''
      DISPLAY BY NAME g_xmdc3_d[l_ac].xmdd219_desc
END FUNCTION]]>
  </point>
  <point name="function.adbt500_xmdd220_ref" order="71" ver="2" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adbt500_xmdd220_ref()
      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] =  g_xmdc3_d[l_ac].xmdd220
      CALL ap_ref_array2(g_ref_fields,"SELECT dbbcl003 FROM dbbcl_t WHERE dbbclent='"||g_enterprise||"' AND dbbcl001=? AND dbbcl002='"||g_dlang||"'","") RETURNING g_rtn_fields
      LET g_xmdc3_d[l_ac].xmdd220_desc = '', g_rtn_fields[1] , ''
      DISPLAY BY NAME g_xmdc3_d[l_ac].xmdd220_desc
END FUNCTION]]>
  </point>
  <point name="function.adbt500_xmdd222_ref" order="72" ver="2" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adbt500_xmdd222_ref()
      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_xmdc3_d[l_ac].xmdd222
      CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
      LET g_xmdc3_d[l_ac].xmdd222_desc = '', g_rtn_fields[1] , ''
      DISPLAY BY NAME g_xmdc3_d[l_ac].xmdd222_desc
END FUNCTION]]>
  </point>
  <point name="function.adbt500_xmdd223_ref" order="73" ver="2" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adbt500_xmdd223_ref()
      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_xmdc3_d[l_ac].xmdd223
      CALL ap_ref_array2(g_ref_fields,"SELECT oofa011 FROM oofa_t WHERE oofaent='"||g_enterprise||"' AND oofa002='2' AND oofa003=? ","") RETURNING g_rtn_fields
      LET g_xmdc3_d[l_ac].xmdd223_desc = '', g_rtn_fields[1] , ''
      DISPLAY BY NAME g_xmdc3_d[l_ac].xmdd223_desc
END FUNCTION]]>
  </point>
  <point name="function.adbt500_xmdd224_ref" order="74" ver="2" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adbt500_xmdd224_ref()
      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_xmdc3_d[l_ac].xmdd224
      CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
      LET g_xmdc3_d[l_ac].xmdd224_desc = '', g_rtn_fields[1] , ''
      DISPLAY BY NAME g_xmdc3_d[l_ac].xmdd224_desc
END FUNCTION]]>
  </point>
  <point name="function.adbt500_xmdd227_ref" order="75" ver="2" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adbt500_xmdd227_ref()
      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_xmdc3_d[l_ac].xmdd227
      CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='2060' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
      LET g_xmdc3_d[l_ac].xmdd227_desc = '', g_rtn_fields[1] , ''
      DISPLAY BY NAME g_xmdc3_d[l_ac].xmdd227_desc
END FUNCTION]]>
  </point>
  <point name="function.adbt500_xmdd228_ref" order="76" ver="2" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adbt500_xmdd228_ref()
      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_xmdc3_d[l_ac].xmdd228
      CALL ap_ref_array2(g_ref_fields,"SELECT staal003 FROM staal_t WHERE staalent='"||g_enterprise||"' AND staal001=? AND staal002='"||g_dlang||"'","") RETURNING g_rtn_fields
      LET g_xmdc3_d[l_ac].xmdd228_desc = '', g_rtn_fields[1] , ''
      DISPLAY BY NAME g_xmdc3_d[l_ac].xmdd228_desc
END FUNCTION]]>
  </point>
  <point name="function.adbt500_xmddorga_ref" order="77" ver="2" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adbt500_xmddorga_ref()
      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_xmdc3_d[l_ac].xmddorga
      CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
      LET g_xmdc3_d[l_ac].xmddorga_desc = '', g_rtn_fields[1] , ''
      DISPLAY BY NAME g_xmdc3_d[l_ac].xmddorga_desc
END FUNCTION]]>
  </point>
  <point name="function.adbt500_xrcd002_ref" order="78" ver="2" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adbt500_xrcd002_ref()
DEFINE l_ooef019      LIKE ooef_t.ooef019

      SELECT ooef019 INTO l_ooef019 FROM ooef_t WHERE ooefent = g_enterprise AND ooef001 = g_xmda_m.xmdasite
      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_xmdc6_d[l_ac].xrcd002
      CALL ap_ref_array2(g_ref_fields,"SELECT oodbl004 FROM oodbl_t WHERE oodblent='"||g_enterprise||"' AND oodbl001='"||l_ooef019||"' AND oodbl002=? AND oodbl003='"||g_dlang||"'","") RETURNING g_rtn_fields
      LET g_xmdc6_d[l_ac].xrcd002_desc = '', g_rtn_fields[1] , ''
      DISPLAY BY NAME g_xmdc6_d[l_ac].xrcd002_desc
END FUNCTION]]>
  </point>
  <point name="function.adbt500_imaa0011_ref" order="79" ver="2" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adbt500_imaa0011_ref()
      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_xmdc6_d[l_ac].imaa0011
      CALL ap_ref_array2(g_ref_fields,"SELECT imaal003,imaal004 FROM imaal_t WHERE imaalent='"||g_enterprise||"' AND imaal001=? AND imaal002='"||g_dlang||"'","") RETURNING g_rtn_fields
      LET g_xmdc6_d[l_ac].imaa0011_desc = '', g_rtn_fields[1] , ''
      LET g_xmdc6_d[l_ac].imaa0011_desc_desc = '', g_rtn_fields[2] , ''
      DISPLAY BY NAME g_xmdc6_d[l_ac].imaa0011_desc
      DISPLAY BY NAME g_xmdc6_d[l_ac].imaa0011_desc_desc
END FUNCTION]]>
  </point>
  <point name="function.adbt500_imaa0012_ref" order="80" ver="2" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adbt500_imaa0012_ref()
      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_xmdc7_d[l_ac].imaa0012
      CALL ap_ref_array2(g_ref_fields,"SELECT imaal003,imaal004 FROM imaal_t WHERE imaalent='"||g_enterprise||"' AND imaal001=? AND imaal002='"||g_dlang||"'","") RETURNING g_rtn_fields
      LET g_xmdc7_d[l_ac].imaa0012_desc = '', g_rtn_fields[1] , ''
      LET g_xmdc7_d[l_ac].imaa0012_desc_desc = '', g_rtn_fields[2] , ''
      DISPLAY BY NAME g_xmdc7_d[l_ac].imaa0012_desc
      DISPLAY BY NAME g_xmdc7_d[l_ac].imaa0012_desc_desc
END FUNCTION]]>
  </point>
  <point name="function.adbt500_rtie002_ref" order="81" ver="2" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adbt500_rtie002_ref()
      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_xmdc7_d[l_ac].rtie002
      CALL ap_ref_array2(g_ref_fields,"SELECT ooial003 FROM ooial_t WHERE ooialent='"||g_enterprise||"' AND ooial001=? AND ooial002='"||g_dlang||"'","") RETURNING g_rtn_fields
      LET g_xmdc7_d[l_ac].rtie002_desc = '', g_rtn_fields[1] , ''
      DISPLAY BY NAME g_xmdc7_d[l_ac].rtie002_desc
END FUNCTION]]>
  </point>
  <point name="function.adbt500_change_xmda022" order="82" ver="2" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[#單頭變更送貨客戶
PRIVATE FUNCTION adbt500_change_xmda022()
DEFINE l_pmaa002      LIKE pmaa_t.pmaa002

      SELECT pmaa002
        INTO l_pmaa002
        FROM pmaa_t
       WHERE pmaaent = g_enterprise
         AND pmaa001 = g_xmda_m.xmda004
      IF l_pmaa002 <> '2' THEN
         UPDATE xmja_t
            SET xmja024 = NULL,
                xmja025 = g_xmda_m.xmda022,
                xmja026 = g_xmda_m.xmda025,
                xmja027 = g_xmda_m.xmda206
          WHERE xmjaent = g_enterprise
            AND xmjadocno = g_xmda_m.xmdadocno
            
         CALL adbt500_b_fill()
      END IF
END FUNCTION]]>
  </point>
  <point name="function.adbt500_change_xmdc016" order="83" ver="3" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[################################################################################
# Descriptions...: 單頭稅別修改時，單身稅別一併修改
# Memo...........:
# Usage..........: CALL adbt500__change_xmdc016()
#                  
# Input parameter:
#                : 
# Return code....: 
#                : 
# Date & Author..: 2014/03/25 By polly
# Modify.........:
################################################################################
PRIVATE FUNCTION adbt500_change_xmdc016()
DEFINE p_cmd             LIKE type_t.chr1
DEFINE l_i               LIKE type_t.num10
DEFINE l_success         LIKE type_t.num5
DEFINE l_xmdcseq         LIKE xmdc_t.xmdcseq
DEFINE l_xmdc001         LIKE xmdc_t.xmdc001
DEFINE l_xmdc011         LIKE xmdc_t.xmdc011
DEFINE l_xmdc015         LIKE xmdc_t.xmdc015
DEFINE l_xmdc016         LIKE xmdc_t.xmdc016
DEFINE l_xmdc017         LIKE xmdc_t.xmdc017
DEFINE l_xmdc046         LIKE xmdc_t.xmdc046
DEFINE l_xmdc047         LIKE xmdc_t.xmdc047
DEFINE l_xmdc048         LIKE xmdc_t.xmdc048
DEFINE l_xmjaseq         LIKE xmja_t.xmjaseq
DEFINE l_xmja003         LIKE xmja_t.xmja003
DEFINE l_xmja018         LIKE xmja_t.xmja018
DEFINE l_xmja010         LIKE xmja_t.xmja010
DEFINE l_xmja006         LIKE xmja_t.xmja006
DEFINE l_xmja007         LIKE xmja_t.xmja007
DEFINE l_xmja019         LIKE xmja_t.xmja019
DEFINE l_xmja020         LIKE xmja_t.xmja020
DEFINE l_xmja021         LIKE xmja_t.xmja021
DEFINE l_xmja013         LIKE xmja_t.xmja013
DEFINE l_xmja014         LIKE xmja_t.xmja014
DEFINE l_xmja008         LIKE xmja_t.xmja008
DEFINE l_xmja009         LIKE xmja_t.xmja009
DEFINE l_xmja022         LIKE xmja_t.xmja022

      DECLARE sel_xmja_cs CURSOR FOR
       SELECT xmjaseq,xmja003,xmja018,xmja013,xmja014
         FROM xmja_t
        WHERE xmjaent = g_enterprise
          AND xmjadocno = g_xmda_m.xmdadocno
      
      FOREACH sel_xmja_cs INTO l_xmjaseq,l_xmja003,l_xmja018,l_xmja013,l_xmja014
         IF g_tax_app = '2' THEN
            #依料件設定
            CALL s_tax_chktype(g_xmda_m.xmdasite,g_xmda_m.xmda004,l_xmja003,'1',g_pmab089)
                 RETURNING l_success,l_xmja006,l_xmja007
            IF adbt500_xmda011_chk('2',l_xmja006) THEN   #稅別檢查

            ELSE
               #稅別檢查失敗，將稅別、稅率清空
               LET l_xmja006 = ''
               LET l_xmja007 = ''
            END IF                   
         ELSE
            #依正常稅率
            LET l_xmja006 = g_xmda_m.xmda011
            LET l_xmja007 = g_xmda_m.xmda012
         END IF
         #重取單價
         CALL s_get_price_adb('1',g_xmda_m.xmdadocno,g_xmda_m.xmdadocdt,l_xmjaseq,g_xmda_m.xmda004,l_xmja003,l_xmja013,l_xmja014,g_xmda_m.xmda015,l_xmja006,'1')
           RETURNING l_success,l_xmja008,l_xmja009,l_xmja010,l_xmja022

         #重計未稅金額、含稅金額、稅額
         IF l_xmja010 = 0 OR cl_null(l_xmja006) THEN
            LET l_xmja019 = 0
            LET l_xmja020 = 0
            LET l_xmja021 = 0
         ELSE 
            CALL s_adbt500_get_amounts(g_xmda_m.xmdadocno,l_xmjaseq,g_xmda_m.xmdasite,g_xmda_m.xmda015,g_xmda_m.xmda016,l_xmja006,l_xmja010,l_xmja018)
              RETURNING l_xmja019,l_xmja020,l_xmja021
         END IF 
         UPDATE xmja_t SET xmja006 = l_xmja006,
                           xmja007 = l_xmja007,
                           xmja019 = l_xmja019,
                           xmja020 = l_xmja020,
                           xmja021 = l_xmja021,
                           xmja008 = l_xmja008,
                           xmja009 = l_xmja009,
                           xmja010 = l_xmja010,
                           xmja022 = l_xmja022
          WHERE xmjaent = g_enterprise
            AND xmjacdocno = g_xmda_m.xmdadocno
            AND xmjaseq = l_xmjaseq
            
         CALL s_adbt500_gen_xmdc(g_xmda_m.xmdadocno,l_xmjaseq) RETURNING l_success
         #需呼叫"交期明細資料"的Function重新產生交期明細資料
         CALL s_adbt500_gen_xmdd(g_xmda_m.xmdadocno,l_xmjaseq) RETURNING l_success 
      END FOREACH
      
      CALL adbt500_b_fill()

END FUNCTION]]>
  </point>
  <point name="function.adbt500_feature" order="84" ver="2" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[################################################################################
# Descriptions...: 新增時，依據產品特徵開窗後的值新增到資料庫
# Memo...........:
# Usage..........: CALL adbt500_feature()
#                  RETURNING r_success
# Input parameter: 
#                : 
# Return code....: r_success      TRUE/FALSE
#                : 
# Date & Author..: 2014/04/10 By Polly
# Modify.........:
################################################################################
PRIVATE FUNCTION adbt500_feature()
   #DEFINE  l_xmdcseq    LIKE xmdc_t.xmdcseq
   #DEFINE  l_xmdc       RECORD LIKE xmdc_t.*
   DEFINE  r_success    LIKE type_t.num5
   DEFINE  l_success    LIKE type_t.num5   
   DEFINE  l_i          LIKE type_t.num5
   DEFINE  l_pmao004    LIKE pmao_t.pmao004 
   DEFINE  l_xmjaseq    LIKE xmja_t.xmjaseq
   DEFINE  l_xmja       RECORD LIKE xmja_t.*
   
   LET r_success = TRUE
  
      LET l_xmjaseq = '' 
      INITIALIZE l_xmja.* TO NULL  
      SELECT xmjaent,xmjasite,xmjaunit,xmjadocno,xmjaseq,
             xmja001,xmja002,xmja003,xmja004,xmja005,xmja006,
             xmja007,xmja008,xmja009,xmja010,xmja011,xmja012,
             xmja013,xmja014,xmja015,xmja016,xmja017,xmja018,
             xmja019,xmja020,xmja021,xmja022,xmja024,xmja025,
             xmja026,xmja027,xmja028,xmja029,xmja030,xmja031,
             xmja032,xmja033,xmja034
        INTO l_xmja.xmjaent,l_xmja.xmjasite,l_xmja.xmjaunit,l_xmja.xmjadocno,l_xmja.xmjaseq,
             l_xmja.xmja001,l_xmja.xmja002,l_xmja.xmja003,l_xmja.xmja004,l_xmja.xmja005,l_xmja.xmja006,
             l_xmja.xmja007,l_xmja.xmja008,l_xmja.xmja009,l_xmja.xmja010,l_xmja.xmja011,l_xmja.xmja012,
             l_xmja.xmja013,l_xmja.xmja014,l_xmja.xmja015,l_xmja.xmja016,l_xmja.xmja017,l_xmja.xmja018,
             l_xmja.xmja019,l_xmja.xmja020,l_xmja.xmja021,l_xmja.xmja022,l_xmja.xmja024,l_xmja.xmja025,
             l_xmja.xmja026,l_xmja.xmja027,l_xmja.xmja028,l_xmja.xmja029,l_xmja.xmja030,l_xmja.xmja031,
             l_xmja.xmja032,l_xmja.xmja033,l_xmja.xmja034
        FROM xmja_t
       WHERE xmjaent = g_enterprise
         AND xmjadocno = g_xmda_m.xmdadocno
         AND xmjaseq = g_xmdc4_d[l_ac].xmjaseq     
       
      SELECT MAX(xmjaseq) INTO l_xmjaseq
        FROM xmja_t
       WHERE xmjaent = g_enterprise
         AND xmjadocno = g_xmda_m.xmdadocno

      IF cl_null(l_xmjaseq) THEN
         LET l_xmjaseq = 0
      END IF  
      
      FOR l_i = 2 TO g_inam.getLength()
          LET l_xmjaseq = l_xmjaseq + 1
          LET l_xmja.xmjaseq = l_xmjaseq
          LET l_xmja.xmja030 = 'N' 
          LET l_xmja.xmja003 = g_inam[l_i].inam001
          LET l_xmja.xmja004 = g_inam[l_i].inam002
          LET l_xmja.xmja012 = g_inam[l_i].inam004
          LET l_xmja.xmja014 = g_inam[l_i].inam004
          LET l_xmja.xmja016 = g_inam[l_i].inam004
          LET l_xmja.xmja018 = g_inam[l_i].inam004
          
          #依交易對象、料號、產品特徵回傳客戶料號
          CALL s_apmi070_get_pmao004(g_xmda_m.xmda004,l_xmja.xmja003,g_inam[l_i].inam002)
            RETURNING l_success,l_pmao004
          IF l_success THEN
             LET l_xmja.xmja033 = l_pmao004
          END IF
          CALL s_adbt500_get_amounts(g_xmda_m.xmdadocno,l_xmja.xmjaseq,g_xmda_m.xmdasite,g_xmda_m.xmda015,g_xmda_m.xmda016,l_xmja.xmja006,l_xmja.xmja010,l_xmja.xmja018)
            RETURNING l_xmja.xmja019,l_xmja.xmja020,l_xmja.xmja021
            
          INSERT INTO xmja_t
                 (xmjaent,xmjasite,xmjaunit,xmjadocno,xmjaseq,xmja001,xmja002,
                  xmja003,xmja004,xmja005,xmja006,xmja007,xmja008,xmja009,xmja010,
                  xmja011,xmja012,xmja013,xmja014,xmja015,xmja016,xmja017,xmja018,
                  xmja019,xmja020,xmja021,xmja022,xmja024,xmja025,xmja026,xmja027,
                  xmja028,xmja029,xmja030,xmja031,xmja032,xmja033,xmja034)
          VALUES (l_xmja.xmjaent,l_xmja.xmjasite,l_xmja.xmjaunit,l_xmja.xmjadocno,l_xmja.xmjaseq,l_xmja.xmja001,l_xmja.xmja002,
                  l_xmja.xmja003,l_xmja.xmja004,l_xmja.xmja005,l_xmja.xmja006,l_xmja.xmja007,l_xmja.xmja008,l_xmja.xmja009,l_xmja.xmja010,
                  l_xmja.xmja011,l_xmja.xmja012,l_xmja.xmja013,l_xmja.xmja014,l_xmja.xmja015,l_xmja.xmja016,l_xmja.xmja017,l_xmja.xmja018,
                  l_xmja.xmja019,l_xmja.xmja020,l_xmja.xmja021,l_xmja.xmja022,l_xmja.xmja024,l_xmja.xmja025,l_xmja.xmja026,l_xmja.xmja027,
                  l_xmja.xmja028,l_xmja.xmja029,l_xmja.xmja030,l_xmja.xmja031,l_xmja.xmja032,l_xmja.xmja033,l_xmja.xmja034)
          
          CALL s_adbt500_gen_xmdc(g_xmda_m.xmdadocno,l_xmja.xmjaseq) RETURNING l_success 
          IF NOT l_success THEN
             CALL cl_err("xmdc_t",SQLCA.sqlcode,1)
             LET r_success = FALSE
             EXIT FOR
          END IF   
          CALL s_adbt500_gen_xmdd(g_xmda_m.xmdadocno,l_xmja.xmjaseq) RETURNING l_success
          IF NOT l_success THEN
             CALL cl_err("xmdd_t",SQLCA.sqlcode,1)
             LET r_success = FALSE
             EXIT FOR
          END IF                  
      END FOR 
      CALL adbt500_b_fill() 
      RETURN r_success
      
END FUNCTION]]>
  </point>
  <point name="function.adbt500_get_pmaa027" order="85" ver="2" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[#抓取聯絡對象識別碼
PRIVATE FUNCTION adbt500_get_pmaa027(p_pmaa001)
DEFINE p_pmaa001 LIKE pmaa_t.pmaa001
DEFINE r_pmaa027 LIKE pmaa_t.pmaa003

      LET r_pmaa027 = ''
      
      SELECT pmaa027 INTO r_pmaa027
        FROM pmaa_t
       WHERE pmaaent = g_enterprise
         AND pmaa001 = p_pmaa001
         
      RETURN r_pmaa027
END FUNCTION]]>
  </point>
  <point name="function.adbt500_get_col_default" order="86" ver="2" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[################################################################################
# Descriptions...: 取得單據別設定的欄位預設值
# Memo...........: 需搭配單據別aooi200的設定
################################################################################
PRIVATE FUNCTION adbt500_get_col_default()
   LET g_xmda_m.xmdadocdt = s_aooi200_get_doc_default(g_xmda_m.xmdasite,'1',g_xmda_m.xmdadocno,'xmdadocdt',g_xmda_m.xmdadocdt)
   LET g_xmda_m.xmda004 = s_aooi200_get_doc_default(g_xmda_m.xmdasite,'1',g_xmda_m.xmdadocno,'xmda004',g_xmda_m.xmda004)
   LET g_xmda_m.xmda002 = s_aooi200_get_doc_default(g_xmda_m.xmdasite,'1',g_xmda_m.xmdadocno,'xmda002',g_xmda_m.xmda002)
   LET g_xmda_m.xmda003 = s_aooi200_get_doc_default(g_xmda_m.xmdasite,'1',g_xmda_m.xmdadocno,'xmda003',g_xmda_m.xmda003)
   LET g_xmda_m.xmda005 = s_aooi200_get_doc_default(g_xmda_m.xmdasite,'1',g_xmda_m.xmdadocno,'xmda005',g_xmda_m.xmda005)
   LET g_xmda_m.xmda006 = s_aooi200_get_doc_default(g_xmda_m.xmdasite,'1',g_xmda_m.xmdadocno,'xmda006',g_xmda_m.xmda006)
   LET g_xmda_m.xmda007 = s_aooi200_get_doc_default(g_xmda_m.xmdasite,'1',g_xmda_m.xmdadocno,'xmda007',g_xmda_m.xmda007)
   LET g_xmda_m.xmda008 = s_aooi200_get_doc_default(g_xmda_m.xmdasite,'1',g_xmda_m.xmdadocno,'xmda008',g_xmda_m.xmda008)
   LET g_xmda_m.xmda033 = s_aooi200_get_doc_default(g_xmda_m.xmdasite,'1',g_xmda_m.xmdadocno,'xmda033',g_xmda_m.xmda033)
   LET g_xmda_m.xmda027 = s_aooi200_get_doc_default(g_xmda_m.xmdasite,'1',g_xmda_m.xmdadocno,'xmda027',g_xmda_m.xmda027)
   LET g_xmda_m.xmda009 = s_aooi200_get_doc_default(g_xmda_m.xmdasite,'1',g_xmda_m.xmdadocno,'xmda009',g_xmda_m.xmda009)
   LET g_xmda_m.xmda010 = s_aooi200_get_doc_default(g_xmda_m.xmdasite,'1',g_xmda_m.xmdadocno,'xmda010',g_xmda_m.xmda010)
   LET g_xmda_m.xmda011 = s_aooi200_get_doc_default(g_xmda_m.xmdasite,'1',g_xmda_m.xmdadocno,'xmda011',g_xmda_m.xmda011)
   LET g_xmda_m.xmda012 = s_aooi200_get_doc_default(g_xmda_m.xmdasite,'1',g_xmda_m.xmdadocno,'xmda012',g_xmda_m.xmda012)
   LET g_xmda_m.xmda013 = s_aooi200_get_doc_default(g_xmda_m.xmdasite,'1',g_xmda_m.xmdadocno,'xmda013',g_xmda_m.xmda013)
   LET g_xmda_m.xmda035 = s_aooi200_get_doc_default(g_xmda_m.xmdasite,'1',g_xmda_m.xmdadocno,'xmda035',g_xmda_m.xmda035)
   LET g_xmda_m.xmda015 = s_aooi200_get_doc_default(g_xmda_m.xmdasite,'1',g_xmda_m.xmdadocno,'xmda015',g_xmda_m.xmda015)
   LET g_xmda_m.xmda016 = s_aooi200_get_doc_default(g_xmda_m.xmdasite,'1',g_xmda_m.xmdadocno,'xmda016',g_xmda_m.xmda016)
   LET g_xmda_m.xmda017 = s_aooi200_get_doc_default(g_xmda_m.xmdasite,'1',g_xmda_m.xmdadocno,'xmda017',g_xmda_m.xmda017)
   LET g_xmda_m.xmda018 = s_aooi200_get_doc_default(g_xmda_m.xmdasite,'1',g_xmda_m.xmdadocno,'xmda018',g_xmda_m.xmda018)
   LET g_xmda_m.xmda019 = s_aooi200_get_doc_default(g_xmda_m.xmdasite,'1',g_xmda_m.xmdadocno,'xmda019',g_xmda_m.xmda019)
   LET g_xmda_m.xmda023 = s_aooi200_get_doc_default(g_xmda_m.xmdasite,'1',g_xmda_m.xmdadocno,'xmda023',g_xmda_m.xmda023)
   LET g_xmda_m.xmda032 = s_aooi200_get_doc_default(g_xmda_m.xmdasite,'1',g_xmda_m.xmdadocno,'xmda032',g_xmda_m.xmda032)
   LET g_xmda_m.xmda043 = s_aooi200_get_doc_default(g_xmda_m.xmdasite,'1',g_xmda_m.xmdadocno,'xmda043',g_xmda_m.xmda043)
   LET g_xmda_m.xmda021 = s_aooi200_get_doc_default(g_xmda_m.xmdasite,'1',g_xmda_m.xmdadocno,'xmda021',g_xmda_m.xmda021)
   LET g_xmda_m.xmda022 = s_aooi200_get_doc_default(g_xmda_m.xmdasite,'1',g_xmda_m.xmdadocno,'xmda022',g_xmda_m.xmda022)
   LET g_xmda_m.xmda034 = s_aooi200_get_doc_default(g_xmda_m.xmdasite,'1',g_xmda_m.xmdadocno,'xmda034',g_xmda_m.xmda034)
   LET g_xmda_m.xmda024 = s_aooi200_get_doc_default(g_xmda_m.xmdasite,'1',g_xmda_m.xmdadocno,'xmda024',g_xmda_m.xmda024)
   LET g_xmda_m.xmda044 = s_aooi200_get_doc_default(g_xmda_m.xmdasite,'1',g_xmda_m.xmdadocno,'xmda044',g_xmda_m.xmda044)
   LET g_xmda_m.xmda030 = s_aooi200_get_doc_default(g_xmda_m.xmdasite,'1',g_xmda_m.xmdadocno,'xmda030',g_xmda_m.xmda030)
   LET g_xmda_m.xmda031 = s_aooi200_get_doc_default(g_xmda_m.xmdasite,'1',g_xmda_m.xmdadocno,'xmda031',g_xmda_m.xmda031)
   LET g_xmda_m.xmda025 = s_aooi200_get_doc_default(g_xmda_m.xmdasite,'1',g_xmda_m.xmdadocno,'xmda025',g_xmda_m.xmda025)
   LET g_xmda_m.xmda026 = s_aooi200_get_doc_default(g_xmda_m.xmdasite,'1',g_xmda_m.xmdadocno,'xmda026',g_xmda_m.xmda026)
   LET g_xmda_m.xmda020 = s_aooi200_get_doc_default(g_xmda_m.xmdasite,'1',g_xmda_m.xmdadocno,'xmda020',g_xmda_m.xmda020)
   LET g_xmda_m.xmda036 = s_aooi200_get_doc_default(g_xmda_m.xmdasite,'1',g_xmda_m.xmdadocno,'xmda036',g_xmda_m.xmda036)
   
   DISPLAY g_xmda_m.xmdadocdt TO xmdadocdt
   DISPLAY g_xmda_m.xmda004 TO xmda004
   DISPLAY g_xmda_m.xmda002 TO xmda002
   DISPLAY g_xmda_m.xmda003 TO xmda003 
   DISPLAY g_xmda_m.xmda005 TO xmda005
   DISPLAY g_xmda_m.xmda006 TO xmda006
   DISPLAY g_xmda_m.xmda007 TO xmda007
   DISPLAY g_xmda_m.xmda008 TO xmda008
   DISPLAY g_xmda_m.xmda033 TO xmda033
   DISPLAY g_xmda_m.xmda027 TO xmda027
   DISPLAY g_xmda_m.xmda009 TO xmda009
   DISPLAY g_xmda_m.xmda010 TO xmda010
   DISPLAY g_xmda_m.xmda011 TO xmda011
   DISPLAY g_xmda_m.xmda012 TO xmda012
   DISPLAY g_xmda_m.xmda013 TO xmda013
   DISPLAY g_xmda_m.xmda035 TO xmda035
   DISPLAY g_xmda_m.xmda015 TO xmda015
   DISPLAY g_xmda_m.xmda016 TO xmda016
   DISPLAY g_xmda_m.xmda017 TO xmda017
   DISPLAY g_xmda_m.xmda018 TO xmda018
   DISPLAY g_xmda_m.xmda019 TO xmda019
   DISPLAY g_xmda_m.xmda023 TO xmda023
   DISPLAY g_xmda_m.xmda032 TO xmda032
   DISPLAY g_xmda_m.xmda043 TO xmda043
   DISPLAY g_xmda_m.xmda021 TO xmda021
   DISPLAY g_xmda_m.xmda022 TO xmda022
   DISPLAY g_xmda_m.xmda034 TO xmda034
   DISPLAY g_xmda_m.xmda024 TO xmda024
   DISPLAY g_xmda_m.xmda044 TO xmda044
   DISPLAY g_xmda_m.xmda030 TO xmda030
   DISPLAY g_xmda_m.xmda031 TO xmda031
   DISPLAY g_xmda_m.xmda025 TO xmda025
   DISPLAY g_xmda_m.xmda026 TO xmda026
   DISPLAY g_xmda_m.xmda020 TO xmda020
   DISPLAY g_xmda_m.xmda036 TO xmda036

 
   CALL adbt500_xmdadocno_ref()
   CALL adbt500_xmda004_ref(g_xmda_m.xmda004) RETURNING g_xmda_m.xmda004_desc
   CALL adbt500_xmda002_ref(g_xmda_m.xmda002) RETURNING g_xmda_m.xmda002_desc
   CALL adbt500_xmda003_ref(g_xmda_m.xmda003) RETURNING g_xmda_m.xmda003_desc
   CALL adbt500_xmda027_ref(g_xmda_m.xmda027) RETURNING g_xmda_m.xmda027_desc
   CALL adbt500_xmda009_ref(g_xmda_m.xmda009) RETURNING g_xmda_m.xmda009_desc
   CALL adbt500_xmda010_ref(g_xmda_m.xmda010) RETURNING g_xmda_m.xmda010_desc
   CALL adbt500_xmda011_ref(g_xmda_m.xmda011) RETURNING g_xmda_m.xmda011_desc
   CALL adbt500_xmda035_ref(g_xmda_m.xmda035) RETURNING g_xmda_m.xmda035_desc
   CALL adbt500_xmda015_ref(g_xmda_m.xmda015) RETURNING g_xmda_m.xmda015_desc
   CALL adbt500_xmda017_ref(g_xmda_m.xmda017) RETURNING g_xmda_m.xmda017_desc
   CALL adbt500_xmda018_ref(g_xmda_m.xmda018) RETURNING g_xmda_m.xmda018_desc
   CALL adbt500_xmda023_ref(g_xmda_m.xmda023) RETURNING g_xmda_m.xmda023_desc
   CALL adbt500_xmda032_ref(g_xmda_m.xmda032) RETURNING g_xmda_m.xmda032_desc
   CALL adbt500_xmda004_ref(g_xmda_m.xmda021) RETURNING g_xmda_m.xmda021_desc
   CALL adbt500_xmda004_ref(g_xmda_m.xmda022) RETURNING g_xmda_m.xmda022_desc
   CALL adbt500_xmda004_ref(g_xmda_m.xmda034) RETURNING g_xmda_m.xmda034_desc
   CALL adbt500_xmda024_ref(g_xmda_m.xmda024) RETURNING g_xmda_m.xmda024_desc
   CALL adbt500_xmda020_ref(g_xmda_m.xmda020) RETURNING g_xmda_m.xmda020_desc

   
   
   DISPLAY BY NAME g_xmda_m.xmdadocno_desc
   DISPLAY BY NAME g_xmda_m.xmda004_desc
   DISPLAY BY NAME g_xmda_m.xmda002_desc
   DISPLAY BY NAME g_xmda_m.xmda003_desc
   DISPLAY BY NAME g_xmda_m.xmda027_desc
   DISPLAY BY NAME g_xmda_m.xmda009_desc
   DISPLAY BY NAME g_xmda_m.xmda010_desc
   DISPLAY BY NAME g_xmda_m.xmda011_desc
   DISPLAY BY NAME g_xmda_m.xmda035_desc
   DISPLAY BY NAME g_xmda_m.xmda015_desc
   DISPLAY BY NAME g_xmda_m.xmda017_desc
   DISPLAY BY NAME g_xmda_m.xmda018_desc
   DISPLAY BY NAME g_xmda_m.xmda023_desc
   DISPLAY BY NAME g_xmda_m.xmda032_desc
   DISPLAY BY NAME g_xmda_m.xmda021_desc
   DISPLAY BY NAME g_xmda_m.xmda022_desc
   DISPLAY BY NAME g_xmda_m.xmda034_desc
   DISPLAY BY NAME g_xmda_m.xmda024_desc
   DISPLAY BY NAME g_xmda_m.xmda020_desc
   DISPLAY BY NAME g_xmda_m.xmda036_desc
   
END FUNCTION]]>
  </point>
  <point name="function.adbt500_get_imaa005" order="87" ver="2" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[#取得產品特徵類別
PRIVATE FUNCTION adbt500_get_imaa005(p_enterprise,p_xmdc001)
DEFINE p_enterprise   LIKE type_t.num5,
       p_xmdc001      LIKE xmdc_t.xmdc001
DEFINE r_imaa005      LIKE imaa_t.imaa005

   LET r_imaa005 = ''
   SELECT imaa005 INTO r_imaa005
     FROM imaa_t
    WHERE imaaent = p_enterprise
      AND imaa001 = p_xmdc001

   RETURN r_imaa005
END FUNCTION]]>
  </point>
  <point name="function.adbt500_get_xmdc015" order="88" ver="2" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[#取得單價
PRIVATE FUNCTION adbt500_get_xmdc015()
   SELECT xmah003 INTO g_xmah003 FROM xmah_t      
    WHERE xmahent = g_enterprise
      AND xmah001 = g_xmda_m.xmda017

END FUNCTION]]>
  </point>
  <point name="function.adbt500_get_xmja022" order="89" ver="2" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adbt500_get_xmja022()
      IF g_xmdc4_d[l_ac].xmja008 <> 0 AND g_xmdc4_d[l_ac].xmja010 <> 0 AND g_xmdc4_d[l_ac].xmja018 <> 0 THEN
         LET g_xmdc4_d[l_ac].xmja022 = (g_xmdc4_d[l_ac].xmja008 - g_xmdc4_d[l_ac].xmja010) * g_xmdc4_d[l_ac].xmja018
      END IF
END FUNCTION]]>
  </point>
  <point name="function.adbt500_gen_xmdf" order="90" ver="3" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adbt500_gen_xmdf(p_type)
DEFINE p_type                LIKE type_t.num5
DEFINE r_success             LIKE type_t.num5
DEFINE l_cnt                 LIKE type_t.num5
DEFINE l_xmja031             LIKE xmja_t.xmja031
DEFINE l_xmja032             LIKE xmja_t.xmja032
DEFINE l_xmdf200             LIKE xmdf_t.xmdf200
DEFINE l_xmdf201             LIKE xmdf_t.xmdf201
DEFINE l_xmdfunit            LIKE xmdf_t.xmdfunit

   LET r_success = TRUE
   IF cl_null(g_xmdc4_d[l_ac].xmjaseq) THEN
      RETURN r_success
   END IF
   IF g_xmdc4_d[l_ac].xmja030 = 'Y' THEN
      IF p_type = 2 AND g_xmdc4_d[l_ac].xmjaseq <> g_xmdc4_d_t.xmjaseq THEN
         LET l_cnt = 0
         SELECT COUNT(*)
           INTO l_cnt
           FROM xmdf_t
          WHERE xmdfent = g_enterprise
            AND xmdfdocno = g_xmda_m.xmdadocno
            AND xmdfseq = g_xmdc4_d_t.xmjaseq
         IF l_cnt > 0 THEN
            UPDATE xmdf_t
               SET xmdfseq = g_xmdc4_d[l_ac].xmjaseq
             WHERE xmdfent = g_enterprise
               AND xmdfdocno = g_xmda_m.xmdadocno
               AND xmdfseq = g_xmdc4_d_t.xmjaseq
            IF SQLCA.sqlcode THEN
               CALL cl_err("xmdf_t",SQLCA.sqlcode,0)
               LET r_success = FALSE
               RETURN r_success
            END IF 
         END IF
      END IF
   ELSE
      IF p_type = 1 THEN
         LET l_cnt = 0
         SELECT COUNT(*)
           INTO l_cnt
           FROM xmdf_t
          WHERE xmdfent = g_enterprise
            AND xmdfdocno = g_xmda_m.xmdadocno
            AND xmdfseq = g_xmdc4_d[l_ac].xmjaseq
         IF l_cnt = 0 THEN
            IF NOT cl_null(g_xmda_m.xmdaunit) THEN
               LET l_xmdfunit = g_xmda_m.xmdaunit
            ELSE
               LET l_xmdfunit = g_xmdc4_d[l_ac].xmjasite
            END IF
            
            SELECT dbag004,dbag005
              INTO l_xmdf200,l_xmdf201
              FROM dbag_t
             WHERE dbagent = g_enterprise
               AND dbagsite = l_xmdfunit
               AND dbag001 = '1'
               AND dbag002 = g_xmda_m.xmda004
               AND dbag003 = g_xmdc4_d[l_ac].xmja025
               
            INSERT INTO xmdf_t(xmdfent,xmdfsite,xmdfunit,xmdfdocno,xmdfseq,xmdfseq2,xmdf002,xmdf003,xmdf004,xmdf006,xmdf200,xmdf201)
                        VALUES(g_enterprise,g_xmdc4_d[l_ac].xmjasite,l_xmdfunit,g_xmda_m.xmdadocno,g_xmdc4_d[l_ac].xmjaseq,1,
                               g_xmdc4_d[l_ac].xmja014,g_xmdc4_d[l_ac].xmja031,g_xmdc4_d[l_ac].xmja032,'N',l_xmdf200,l_xmdf201)
            IF SQLCA.sqlcode THEN
               CALL cl_err("xmdf_t",SQLCA.sqlcode,0)
               LET r_success = FALSE
               RETURN r_success
            END IF 
            CALL adbt500_03(g_xmda_m.xmdadocno,g_xmdc4_d[l_ac].xmjaseq,g_xmdc4_d[l_ac].xmja014,g_xmdc4_d[l_ac].xmja030,g_xmdc4_d[l_ac].xmjasite)
            RETURNING l_xmja031,l_xmja032
            CALL s_adbt500_gen_xmdd(g_xmda_m.xmdadocno,g_xmdc4_d[l_ac].xmjaseq) RETURNING r_success  
         END IF
      ELSE
         LET l_cnt = 0
         SELECT COUNT(*)
           INTO l_cnt
           FROM xmdf_t
          WHERE xmdfent = g_enterprise
            AND xmdfdocno = g_xmda_m.xmdadocno
            AND xmdfseq = g_xmdc4_d_t.xmjaseq
         IF l_cnt > 0 THEN
            UPDATE xmdf_t
               SET xmdfseq = g_xmdc4_d[l_ac].xmjaseq,
                   xmdf002 = g_xmdc4_d[l_ac].xmja018,
                   xmdf003 = g_xmdc4_d[l_ac].xmja031,
                   xmdf004 = g_xmdc4_d[l_ac].xmja032
             WHERE xmdfent = g_enterprise
               AND xmdfdocno = g_xmda_m.xmdadocno
               AND xmdfseq = g_xmdc4_d_t.xmjaseq
            IF SQLCA.sqlcode THEN
               CALL cl_err("xmdf_t",SQLCA.sqlcode,0)
               LET r_success = FALSE
               RETURN r_success
            END IF 
         END IF
      END IF
   END IF
   RETURN r_success
END FUNCTION]]>
  </point>
  <point name="function.adbt500_get_isaf011" order="91" ver="2" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adbt500_get_isaf011()
DEFINE l_isaf011       LIKE isaf_t.isaf011
   
   LET g_xmda_m.isaf011 = ''
   DECLARE adbt500_isaf_cl1 CURSOR FOR
    SELECT DISTINCT isaf011
      FROM isaf_t,isag_t
     WHERE isafent = isagent
       AND isafcomp = isagcomp
       AND isafdocno = isagdocno
       AND isafent = g_enterprise
       AND isaf001 = '1'
       AND isag001 = 'axmt500'
       AND isag002 = g_xmda_m.xmdadocno
       AND isaf011 IS NOT NULL
       ORDER BY isaf011
       
   FOREACH adbt500_isaf_cl1 INTO l_isaf011
      IF cl_null(g_xmda_m.isaf011) THEN
         LET g_xmda_m.isaf011 = l_isaf011
      ELSE
         LET g_xmda_m.isaf011 = g_xmda_m.isaf011,",",l_isaf011
      END IF
   END FOREACH
END FUNCTION]]>
  </point>
  <point name="function.adbt500_head_default" order="92" ver="2" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adbt500_head_default()
  DEFINE l_ooef016   LIKE ooef_t.ooef016
  DEFINE l_success   LIKE type_t.num5
  DEFINE l_slip      LIKE ooba_t.ooba001
  DEFINE l_para_data LIKE type_t.chr80

      #取得銷售分類
      LET g_pmab089 = g_xmda_m.xmda024
      IF cl_null(g_xmda_m.xmda023) THEN
         SELECT pmaa231 INTO g_xmda_m.xmda023 FROM pmaa_t WHERE pmaaent = g_enterprise AND pmaa001 = g_xmda_m.xmda004
      END IF
      #取稅率、單價含稅否
      IF NOT cl_null(g_xmda_m.xmda011) THEN
         LET g_oodb005 = ''
         LET g_oodb006 = ''
         LET g_tax_app = ''
         CALL s_tax_chk(g_xmda_m.xmdasite,g_xmda_m.xmda011)
           RETURNING l_success,g_oodbl004,g_oodb005,g_oodb006,g_tax_app
         IF l_success THEN
            LET g_xmda_m.xmda012 = g_oodb006
            LET g_xmda_m.xmda013 = g_oodb005
            DISPLAY BY NAME g_xmda_m.xmda012
            DISPLAY BY NAME g_xmda_m.xmda013
         END IF           
      END IF
      
      #取匯率
      IF NOT cl_null(g_xmda_m.xmda015) THEN
         CALL s_aooi200_get_slip(g_xmda_m.xmdadocno) RETURNING l_success,l_slip               #截取單別
         IF l_success THEN
            CALL cl_get_doc_para(g_enterprise,g_xmda_m.xmdasite,l_slip,'D-BAS-0075') RETURNING l_para_data  #外幣使用匯率來源
            IF cl_null(l_para_data) THEN
               CALL cl_err('','axm-00144',1)      
            ELSE
               LET l_ooef016 = ''
               SELECT ooef016 INTO l_ooef016 FROM ooef_t WHERE ooefent = g_enterprise AND ooef001 = g_xmda_m.xmdasite
               CALL s_aooi160_get_exrate('1',g_xmda_m.xmdasite,g_today,g_xmda_m.xmda015,l_ooef016,0,l_para_data) RETURNING g_xmda_m.xmda016
            END IF   
         END IF

      END IF   
    
      CALL adbt500_xmda009_ref(g_xmda_m.xmda009) RETURNING g_xmda_m.xmda009_desc
      CALL adbt500_xmda010_ref(g_xmda_m.xmda010) RETURNING g_xmda_m.xmda010_desc
      CALL adbt500_xmda011_ref(g_xmda_m.xmda011) RETURNING g_xmda_m.xmda011_desc
      CALL adbt500_xmda015_ref(g_xmda_m.xmda015) RETURNING g_xmda_m.xmda015_desc
      CALL adbt500_xmda017_ref(g_xmda_m.xmda017) RETURNING g_xmda_m.xmda017_desc
      CALL adbt500_xmda020_ref(g_xmda_m.xmda020) RETURNING g_xmda_m.xmda020_desc      
      CALL adbt500_xmda023_ref(g_xmda_m.xmda023) RETURNING g_xmda_m.xmda023_desc
      CALL adbt500_xmda035_ref(g_xmda_m.xmda035) RETURNING g_xmda_m.xmda035_desc
      CALL adbt500_xmda024_ref(g_xmda_m.xmda024) RETURNING g_xmda_m.xmda024_desc
      CALL adbt500_xmda018_ref(g_xmda_m.xmda018) RETURNING g_xmda_m.xmda018_desc
      CALL adbt500_xmda035_ref(g_xmda_m.xmda035) RETURNING g_xmda_m.xmda035_desc

      DISPLAY BY NAME g_xmda_m.xmda009,g_xmda_m.xmda009_desc,g_xmda_m.xmda010,g_xmda_m.xmda010_desc,g_xmda_m.xmda011,
                      g_xmda_m.xmda011_desc,g_xmda_m.xmda012,g_xmda_m.xmda013,g_xmda_m.xmda015,g_xmda_m.xmda015_desc,
                      g_xmda_m.xmda016,g_xmda_m.xmda017,g_xmda_m.xmda017_desc,g_xmda_m.xmda020,g_xmda_m.xmda020_desc,
                      g_xmda_m.xmda023,g_xmda_m.xmda023_desc,g_xmda_m.xmda024,g_xmda_m.xmda024_desc,g_xmda_m.xmda035,
                      g_xmda_m.xmda035_desc,
                      g_xmda_m.xmda018,g_xmda_m.xmda018_desc,g_xmda_m.xmda035,g_xmda_m.xmda035_desc

      #收款客戶
      LET g_xmda_m.xmda021 = ''
      LET g_xmda_m.xmda021_desc = ''
      SELECT pmac002 INTO g_xmda_m.xmda021 FROM pmac_t 
       WHERE pmacent = g_enterprise AND pmac001 = g_xmda_m.xmda004 
         AND pmac003 = '1' AND pmacstus = 'Y' AND pmac004 = 'Y'
      IF cl_null(g_xmda_m.xmda021) THEN
         SELECT pmac002 INTO g_xmda_m.xmda021 FROM pmac_t 
          WHERE pmacent = g_enterprise AND pmac001 = g_xmda_m.xmda004 
            AND pmac003 = '1' AND pmacstus = 'Y' AND rownum = 1
         IF cl_null(g_xmda_m.xmda021) THEN
            LET g_xmda_m.xmda021 = g_xmda_m.xmda004
         END IF
      END IF
      CALL adbt500_xmda004_ref(g_xmda_m.xmda021) RETURNING g_xmda_m.xmda021_desc
      DISPLAY BY NAME g_xmda_m.xmda021,g_xmda_m.xmda021_desc 
      
      CALL adbt500_xmda026_desc()
      
      #收貨客戶
      LET g_xmda_m.xmda022 = ''
      LET g_xmda_m.xmda022_desc = ''
      SELECT pmac002 INTO g_xmda_m.xmda022 FROM pmac_t 
       WHERE pmacent = g_enterprise AND pmac001 = g_xmda_m.xmda004 
         AND pmac003 = '2' AND pmacstus = 'Y' AND pmac004 = 'Y'
      IF cl_null(g_xmda_m.xmda022) THEN
         SELECT pmac002 INTO g_xmda_m.xmda022 FROM pmac_t 
          WHERE pmacent = g_enterprise AND pmac001 = g_xmda_m.xmda004 
            AND pmac003 = '2' AND pmacstus = 'Y' AND rownum = 1
         IF cl_null(g_xmda_m.xmda022) THEN
            LET g_xmda_m.xmda022 = g_xmda_m.xmda004
         END IF
      END IF
      CALL adbt500_xmda004_ref(g_xmda_m.xmda022) RETURNING g_xmda_m.xmda022_desc
      DISPLAY BY NAME g_xmda_m.xmda022,g_xmda_m.xmda022_desc  
      CALL adbt500_xmda025_desc()
      
      #發票客戶
      LET g_xmda_m.xmda203 = ''
      LET g_xmda_m.xmda203_desc = ''
      SELECT pmac002 INTO g_xmda_m.xmda203 FROM pmac_t 
       WHERE pmacent = g_enterprise AND pmac001 = g_xmda_m.xmda004 
         AND pmac003 = '3' AND pmacstus = 'Y' AND pmac004 = 'Y'
      IF cl_null(g_xmda_m.xmda203) THEN
         SELECT pmac002 INTO g_xmda_m.xmda203 FROM pmac_t 
          WHERE pmacent = g_enterprise AND pmac001 = g_xmda_m.xmda004 
            AND pmac003 = '3' AND pmacstus = 'Y' AND rownum = 1
         IF cl_null(g_xmda_m.xmda203) THEN
            LET g_xmda_m.xmda203 = g_xmda_m.xmda004
         END IF
      END IF
      CALL adbt500_xmda203_ref()
      
      #抓取交易對象聯絡人明細檔的聯絡對像識別碼顯示在訂單單上的[C:客戶連絡人]，
      #若有設置多個聯絡人時，則取有勾選主要聯絡人的那一個
      LET g_xmda_m.xmda027 = ''
      LET g_xmda_m.xmda027_desc = ''
      SELECT pmaj002 INTO g_xmda_m.xmda027 FROM pmaj_t 
       WHERE pmajent = g_enterprise AND pmaj001 = g_xmda_m.xmda004 
         AND pmajstus = 'Y' AND pmaj004 = 'Y'
      IF cl_null(g_xmda_m.xmda022) THEN
         SELECT pmaj002 INTO g_xmda_m.xmda027 FROM pmaj_t 
          WHERE pmajent = g_enterprise AND pmaj001 = g_xmda_m.xmda004 
            AND pmajstus = 'Y' AND pmaj004 = 'Y' AND rownum = 1  
      END IF
      CALL adbt500_xmda027_ref(g_xmda_m.xmda027) RETURNING g_xmda_m.xmda027_desc
      DISPLAY BY NAME g_xmda_m.xmda027,g_xmda_m.xmda027_desc


END FUNCTION]]>
  </point>
  <point name="function.adbt500_location_chk" order="93" ver="2" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[#依據運輸方式所設置的運輸類型(ACC='263'對應的參考欄位16)檢核起目的地的合理性
PRIVATE FUNCTION adbt500_location_chk(p_location,p_oocq019)
   DEFINE p_location            LIKE type_t.chr10     #地點
   DEFINE l_n                   LIKE type_t.num5
   DEFINE l_stus                LIKE type_t.chr10
   DEFINE p_oocq019             LIKE oocq_t.oocq019

   LET g_errno = ''
   LET l_n = 0
   LET l_stus = ''

   CASE
      WHEN p_oocq019 ='1' OR   #1:陸運
           p_oocq019 ='4'      #4:其它    
         LET l_n=0
         SELECT COUNT(oock003) INTO l_n
           FROM oock_t
          WHERE oockent = g_enterprise
            AND oock003 = p_location
            AND oockstus = 'Y'

             #輸入資料不存在 縣市資料檔 中！
          IF l_n = 0 THEN LET g_errno = 'aoo-00015' RETURN END IF

      WHEN p_oocq019 ='2'      #2:海運
         SELECT oocqstus INTO l_stus
           FROM oocq_t
          WHERE oocqent = g_enterprise
            AND oocq001 = '262'
            AND oocq002 = p_location

         CASE
            WHEN SQLCA.sqlcode = 100
               LET g_errno = 'axm-00032'
            WHEN l_stus <> 'Y'
               LET g_errno = 'axm-00033'
            OTHERWISE
               LET g_errno = SQLCA.sqlcode USING '------'
         END CASE

      WHEN p_oocq019 ='3'      #3:空運                     
         SELECT oocqstus INTO l_stus
           FROM oocq_t
          WHERE oocqent = g_enterprise
            AND oocq001 = '276'
            AND oocq002 = p_location

         CASE
            WHEN SQLCA.sqlcode = 100
               LET g_errno = 'axm-00086'
            WHEN l_stus <> 'Y'
               LET g_errno = 'axm-00087'
            OTHERWISE
               LET g_errno = SQLCA.sqlcode USING '------'
         END CASE

   END CASE
   RETURN

END FUNCTION]]>
  </point>
  <point name="function.adbt500_open_xmdb" order="94" ver="3" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[#維護多期預付款單身
PRIVATE FUNCTION adbt500_open_xmdb()
DEFINE  l_cmd           LIKE type_t.chr1
DEFINE  l_ac_t          LIKE type_t.num5                #未取消的ARRAY CNT 
DEFINE  l_n             LIKE type_t.num5                #檢查重複用  
DEFINE  l_cnt           LIKE type_t.num5                #檢查重複用  
DEFINE  l_lock_sw       LIKE type_t.chr1                #單身鎖住否  
DEFINE  l_allow_insert  LIKE type_t.num5                #可新增否 
DEFINE  l_allow_delete  LIKE type_t.num5                #可刪除否  
DEFINE  l_count         LIKE type_t.num5
DEFINE  l_i             LIKE type_t.num5
DEFINE  l_insert        BOOLEAN
DEFINE  ls_return       STRING
DEFINE  l_var_keys      DYNAMIC ARRAY OF STRING
DEFINE  l_field_keys    DYNAMIC ARRAY OF STRING
DEFINE  l_vars          DYNAMIC ARRAY OF STRING
DEFINE  l_fields        DYNAMIC ARRAY OF STRING
DEFINE  l_var_keys_bak  DYNAMIC ARRAY OF STRING
DEFINE  l_xmdb005       LIKE xmdb_t.xmdb005
DEFINE  l_xmdb006       LIKE xmdb_t.xmdb006
DEFINE  l_forupd_sql    STRING
DEFINE  l_sum           LIKE xmdb_t.xmdb005

   IF g_xmda_m.xmdadocno IS NULL THEN
      CALL cl_err("","std-00003",0)
      RETURN
   END IF
   
   SELECT UNIQUE xmdasite,xmdadocno,xmda001,xmdadocdt,xmda002,
                 xmda004,xmda003,xmdastus,xmda005,xmda006,
                 xmda007,xmda008,xmda033,xmda027,xmda009,
                 xmda010,xmda011,xmda012,xmda013,xmda035,
                 xmda015,xmda016,xmda017,xmda018,xmda019,
                 xmda023,xmda032,xmda071,xmda021,xmda022,
                 xmda034,xmda024,xmda044,xmda030,xmda031,
                 xmda045,xmda046,xmda047,xmda028,xmda041,
                 xmda042,xmda043,xmda025,xmda026,xmda020,
                 xmda036,xmdaownid,xmdaowndp,
                 xmdacrtid,xmdacrtdp,xmdacrtdt,xmdamodid,xmdamoddt,
                 xmdacnfid,xmdacnfdt
                 
     INTO g_xmda_m.xmdasite,g_xmda_m.xmdadocno,g_xmda_m.xmda001,g_xmda_m.xmdadocdt,g_xmda_m.xmda002,
          g_xmda_m.xmda004,g_xmda_m.xmda003,g_xmda_m.xmdastus,g_xmda_m.xmda005,g_xmda_m.xmda006,
          g_xmda_m.xmda007,g_xmda_m.xmda008,g_xmda_m.xmda033,g_xmda_m.xmda027,g_xmda_m.xmda009,
          g_xmda_m.xmda010,g_xmda_m.xmda011,g_xmda_m.xmda012,g_xmda_m.xmda013,g_xmda_m.xmda035,
          g_xmda_m.xmda015,g_xmda_m.xmda016,g_xmda_m.xmda017,g_xmda_m.xmda018,g_xmda_m.xmda019,
          g_xmda_m.xmda023,g_xmda_m.xmda032,g_xmda_m.xmda071,g_xmda_m.xmda021,g_xmda_m.xmda022,
          g_xmda_m.xmda034,g_xmda_m.xmda024,g_xmda_m.xmda044,g_xmda_m.xmda030,g_xmda_m.xmda031,
          g_xmda_m.xmda045,g_xmda_m.xmda046,g_xmda_m.xmda047,g_xmda_m.xmda028,g_xmda_m.xmda041,
          g_xmda_m.xmda042,g_xmda_m.xmda043,g_xmda_m.xmda025,g_xmda_m.xmda026,g_xmda_m.xmda020,
          g_xmda_m.xmda036,g_xmda_m.xmdaownid,g_xmda_m.xmdaowndp,
          g_xmda_m.xmdacrtid,g_xmda_m.xmdacrtdp,g_xmda_m.xmdacrtdt,g_xmda_m.xmdamodid,g_xmda_m.xmdamoddt,
          g_xmda_m.xmdacnfid,g_xmda_m.xmdacnfdt
          
     FROM xmda_t
    WHERE xmdaent = g_enterprise AND xmdadocno = g_xmda_m.xmdadocno
 
   ERROR ""
  
   CALL s_transaction_begin()
           
   LET l_forupd_sql = "SELECT xmdasite,xmdadocno,xmda001,'',xmdadocdt,xmda004,'',xmda002,'',xmda003, 
       '',xmdastus,xmda005,xmda006,xmda007,xmda008,xmda033,xmda027,'',xmda009,'',xmda010,'',xmda011, 
       '',xmda012,xmda013,xmda035,'',xmda015,'',xmda016,xmda017,'',xmda018,'',xmda019,xmda023,'',xmda032, 
       '',xmda071,xmda021,'',xmda022,'',xmda034,'',xmda024,'',xmda044,xmda030,xmda031,xmda045,xmda046, 
       xmda047,xmda028,xmda041,xmda042,xmda043,xmda025,'','',xmda026,'','',xmda020,'', 
       xmda036,'',xmdaownid,'',xmdaowndp,'',xmdacrtid,'',xmdacrtdp,'',xmdacrtdt,xmdamodid, 
       '',xmdamoddt,xmdacnfid,'',xmdacnfdt FROM xmda_t WHERE xmdaent= ? AND xmdadocno=? FOR UPDATE"

   LET l_forupd_sql = cl_sql_forupd(l_forupd_sql)                #轉換不同資料庫語法
   DECLARE adbt500_cl2 CURSOR FROM l_forupd_sql
   OPEN adbt500_cl2 USING g_enterprise,g_xmda_m.xmdadocno

   IF STATUS THEN
      CALL cl_err("OPEN adbt500_cl2:", STATUS, 1)
      CLOSE adbt500_cl2
      CALL s_transaction_end('N','0')
      RETURN
   END IF

   #鎖住將被更改或取消的資料
    FETCH adbt500_cl2 INTO g_xmda_m.xmdasite,g_xmda_m.xmdadocno,g_xmda_m.xmda001,g_xmda_m.xmdadocno_desc, 
       g_xmda_m.xmdadocdt,g_xmda_m.xmda004,g_xmda_m.xmda004_desc,g_xmda_m.xmda002,g_xmda_m.xmda002_desc, 
       g_xmda_m.xmda003,g_xmda_m.xmda003_desc,g_xmda_m.xmdastus,g_xmda_m.xmda005,g_xmda_m.xmda006,g_xmda_m.xmda007, 
       g_xmda_m.xmda008,g_xmda_m.xmda033,g_xmda_m.xmda027,g_xmda_m.xmda027_desc,g_xmda_m.xmda009,g_xmda_m.xmda009_desc, 
       g_xmda_m.xmda010,g_xmda_m.xmda010_desc,g_xmda_m.xmda011,g_xmda_m.xmda011_desc,g_xmda_m.xmda012, 
       g_xmda_m.xmda013,g_xmda_m.xmda035,g_xmda_m.xmda035_desc,g_xmda_m.xmda015,g_xmda_m.xmda015_desc, 
       g_xmda_m.xmda016,g_xmda_m.xmda017,g_xmda_m.xmda017_desc,g_xmda_m.xmda018,g_xmda_m.xmda018_desc, 
       g_xmda_m.xmda019,g_xmda_m.xmda023,g_xmda_m.xmda023_desc,g_xmda_m.xmda032,g_xmda_m.xmda032_desc, 
       g_xmda_m.xmda071,g_xmda_m.xmda021,g_xmda_m.xmda021_desc,g_xmda_m.xmda022,g_xmda_m.xmda022_desc, 
       g_xmda_m.xmda034,g_xmda_m.xmda034_desc,g_xmda_m.xmda024,g_xmda_m.xmda024_desc,g_xmda_m.xmda044, 
       g_xmda_m.xmda030,g_xmda_m.xmda031,g_xmda_m.xmda045,g_xmda_m.xmda046,g_xmda_m.xmda047,g_xmda_m.xmda028, 
       g_xmda_m.xmda041,g_xmda_m.xmda042,g_xmda_m.xmda043,g_xmda_m.xmda025,g_xmda_m.xmda025_desc,g_xmda_m.oofb017, 
       g_xmda_m.xmda026,g_xmda_m.xmda026_desc,g_xmda_m.oofb017_1,g_xmda_m.xmda020,g_xmda_m.xmda020_desc, 
       g_xmda_m.xmda036, 
       g_xmda_m.xmda036_desc,g_xmda_m.xmdaownid,g_xmda_m.xmdaownid_desc,g_xmda_m.xmdaowndp, 
       g_xmda_m.xmdaowndp_desc,g_xmda_m.xmdacrtid,g_xmda_m.xmdacrtid_desc,g_xmda_m.xmdacrtdp,g_xmda_m.xmdacrtdp_desc, 
       g_xmda_m.xmdacrtdt,g_xmda_m.xmdamodid,g_xmda_m.xmdamodid_desc,g_xmda_m.xmdamoddt,g_xmda_m.xmdacnfid, 
       g_xmda_m.xmdacnfid_desc,g_xmda_m.xmdacnfdt
 
   #資料被他人LOCK, 或是sql執行時出現錯誤
   IF SQLCA.sqlcode THEN
      CALL cl_err(g_xmda_m.xmdadocno,SQLCA.sqlcode,0)
      CLOSE adbt500_cl2
      CALL s_transaction_end('N','0')
      RETURN
   END IF
 
   CALL adbt500_show()  
   LET g_forupd_sql = "SELECT xmdbsite,xmdb001,xmdb002,'',xmdb003,xmdb004,xmdb005,xmdb006,xmdb007,xmdb008,xmdb009 FROM xmdb_t WHERE xmdbent=? AND xmdbdocno=? AND xmdb001=? FOR UPDATE"

   LET g_forupd_sql = cl_sql_forupd(g_forupd_sql)
   DECLARE adbt500_bcl15 CURSOR FROM g_forupd_sql

   LET l_allow_insert = cl_auth_detail_input("insert")
   LET l_allow_delete = cl_auth_detail_input("delete")
   LET g_qryparam.state = 'i'

   DISPLAY BY NAME g_xmda_m.xmdasite,g_xmda_m.xmdadocno,g_xmda_m.xmda001,g_xmda_m.xmdadocdt,g_xmda_m.xmda002,
                   g_xmda_m.xmda004,g_xmda_m.xmda003,g_xmda_m.xmdastus,g_xmda_m.xmda005,g_xmda_m.xmda006,
                   g_xmda_m.xmda007,g_xmda_m.xmda008,g_xmda_m.xmda033,g_xmda_m.xmda027,g_xmda_m.xmda009,
                   g_xmda_m.xmda010,g_xmda_m.xmda011,g_xmda_m.xmda012,g_xmda_m.xmda013,g_xmda_m.xmda035,
                   g_xmda_m.xmda015,g_xmda_m.xmda016,g_xmda_m.xmda017,g_xmda_m.xmda018,g_xmda_m.xmda019,
                   g_xmda_m.xmda023,g_xmda_m.xmda032,g_xmda_m.xmda043,g_xmda_m.xmda021,g_xmda_m.xmda022,
                   g_xmda_m.xmda034,g_xmda_m.xmda024,g_xmda_m.xmda044,g_xmda_m.xmda030,g_xmda_m.xmda031,
                   g_xmda_m.xmda045,g_xmda_m.xmda046,g_xmda_m.xmda047,g_xmda_m.xmda028,g_xmda_m.xmda025,
                   g_xmda_m.xmda026,g_xmda_m.xmda020,g_xmda_m.xmda036
                  
   
   LET g_errshow = 1
   
   LET g_flag1 = TRUE
   CALL adbt500_set_entry('u')
   CALL adbt500_set_no_entry('u')
   
   DIALOG ATTRIBUTES(UNBUFFERED,FIELD ORDER FORM)
      INPUT BY NAME g_xmda_m.xmda039 ATTRIBUTE(WITHOUT DEFAULTS)         
                        
         AFTER INPUT
            IF INT_FLAG THEN
               EXIT DIALOG
            END IF
            UPDATE xmda_t SET xmda039 = g_xmda_m.xmda039 
              WHERE xmdaent = g_enterprise AND xmdadocno = g_xmda_m.xmdadocno
            CASE
               WHEN SQLCA.sqlerrd[3] = 0                   #更新不到的處理
                  CALL cl_err("xmda_t","std-00009",1)
                  CALL s_transaction_end('N','0')
               WHEN SQLCA.sqlcode                          #其他錯誤
                  CALL cl_err("xmda_t",SQLCA.sqlcode,1)
                  CALL s_transaction_end('N','0')
               OTHERWISE
                  CALL s_transaction_end('Y','0')
            END CASE              
            
      END INPUT
      
      INPUT ARRAY g_xmdc5_d FROM s_detail5.*
         ATTRIBUTE(COUNT = g_rec_b,MAXCOUNT = g_max_rec,WITHOUT DEFAULTS, 
                 INSERT ROW = l_allow_insert,
                 DELETE ROW = l_allow_delete,
                 APPEND ROW = l_allow_insert)
                 

         BEFORE INPUT
            IF g_insert = 'Y' AND NOT cl_null(g_insert) THEN 
              CALL FGL_SET_ARR_CURR(g_xmdc5_d.getLength()+1) 
              LET g_insert = 'N' 
            END IF 

            CALL adbt500_b_fill()
            LET g_rec_b = g_xmdc5_d.getLength()
            
         BEFORE INSERT
            
            LET l_insert = TRUE
            LET l_n = ARR_COUNT()
            LET l_cmd = 'a'
            INITIALIZE g_xmdc5_d[l_ac].* TO NULL 
            LET g_xmdc5_d[l_ac].xmdbsite = g_xmda_m.xmdasite
            LET g_xmdc5_d[l_ac].xmdb004 = g_today
            #DISPLAY BY NAME g_xmdc5_d[l_ac].xmdb004
            
            SELECT MAX(xmdb001)+1 INTO g_xmdc5_d[l_ac].xmdb001 FROM xmdb_t
              WHERE xmdbent = g_enterprise AND xmdbdocno = g_xmda_m.xmdadocno
            IF cl_null(g_xmdc5_d[l_ac].xmdb001) OR g_xmdc5_d[l_ac].xmdb001 = 0 THEN
               LET g_xmdc5_d[l_ac].xmdb001 = 1
            END IF
            
            LET g_xmdc5_d_t.* = g_xmdc5_d[l_ac].*     #新輸入資料
            CALL cl_show_fld_cont()
            CALL adbt500_set_entry_b(l_cmd)

            CALL adbt500_set_no_entry_b(l_cmd)
            
         BEFORE ROW     
            LET l_insert = FALSE
            LET l_cmd = ''
            LET l_ac = ARR_CURR()
            LET g_detail_idx = l_ac
              
            LET l_lock_sw = 'N'            #DEFAULT
            LET l_n = ARR_COUNT()
            DISPLAY l_ac TO FORMONLY.idx
         
            CALL s_transaction_begin()

           
            LET g_rec_b = g_xmdc5_d.getLength()
            
            IF g_rec_b >= l_ac 
               AND g_xmdc5_d[l_ac].xmdb001 IS NOT NULL
            THEN 
               LET l_cmd = 'u'
               LET g_xmdc5_d_t.* = g_xmdc5_d[l_ac].*  #BACKUP
               CALL adbt500_set_entry_b(l_cmd)
               CALL adbt500_set_no_entry_b(l_cmd)
               IF NOT cl_null(g_xmdc5_d[l_ac].xmdb007) OR 
                 (NOT cl_null(g_xmdc5_d[l_ac].xmdb008) AND g_xmdc5_d[l_ac].xmdb008 > 0) OR
                 (NOT cl_null(g_xmdc5_d[l_ac].xmdb009) AND g_xmdc5_d[l_ac].xmdb009 > 0)
               THEN
                  CALL cl_set_act_visible("delete", FALSE)
                  CALL FGL_SET_ARR_CURR(l_ac+1) 
                  CONTINUE DIALOG
               END IF
               
               OPEN adbt500_bcl15 USING g_enterprise,g_xmda_m.xmdadocno,g_xmdc5_d[l_ac].xmdb001
               IF SQLCA.sqlcode THEN
                  CALL cl_err("adbt500_bcl15",SQLCA.sqlcode,1)
                  LET l_lock_sw = 'Y'
               ELSE
                  FETCH adbt500_bcl15 INTO g_xmdc5_d[l_ac].xmdbsite,g_xmdc5_d[l_ac].xmdb001,g_xmdc5_d[l_ac].xmdb002,g_xmdc5_d[l_ac].xmdb002_desc,g_xmdc5_d[l_ac].xmdb003,g_xmdc5_d[l_ac].xmdb004,g_xmdc5_d[l_ac].xmdb005,g_xmdc5_d[l_ac].xmdb006,g_xmdc5_d[l_ac].xmdb007,g_xmdc5_d[l_ac].xmdb008,g_xmdc5_d[l_ac].xmdb009
                   IF SQLCA.sqlcode THEN
                     CALL cl_err('',SQLCA.sqlcode,1)
                     LET l_lock_sw = 'Y'
                  END IF
                  
                  LET g_bfill = 'N'
                  CALL adbt500_show()
                  LET g_bfill = 'Y'
                  
                  CALL cl_show_fld_cont()
               END IF
            ELSE
               LET l_cmd='a'
            END IF            
            
         BEFORE DELETE                            #是否取消單身
            IF l_cmd = 'a' THEN
               CALL FGL_SET_ARR_CURR(l_ac-1)
               CALL g_xmdc5_d.deleteElement(l_ac)
               NEXT FIELD xmdb001
            END IF
         
            IF g_xmdc5_d[l_ac].xmdb001 IS NOT NULL
            THEN
               IF NOT cl_ask_del_detail() THEN
                  CANCEL DELETE
               END IF
               IF l_lock_sw = 'Y' THEN
                  CALL cl_err("", -263, 1)
                  CANCEL DELETE
               END IF
               
               DELETE FROM xmdb_t
                WHERE xmdbent = g_enterprise AND xmdbdocno = g_xmda_m.xmdadocno AND
                      xmdb001 = g_xmdc5_d_t.xmdb001

               IF SQLCA.sqlcode THEN
                  CALL cl_err("pmdn_t",SQLCA.sqlcode,1)
                  CALL s_transaction_end('N','0')
                  CANCEL DELETE   
               ELSE
                  LET g_rec_b = g_rec_b-1

                  CALL s_transaction_end('Y','0')
               END IF 
               LET l_count = g_xmdc_d.getLength()
            END IF 

         AFTER INSERT    
            LET l_insert = FALSE
            IF INT_FLAG THEN
               CALL cl_err('',9001,0)
               LET INT_FLAG = 0
               CLOSE adbt500_bcl15
               CANCEL INSERT
            END IF
               
            LET l_count = 1  
            SELECT COUNT(*) INTO l_count FROM xmdb_t 
             WHERE xmdbent = g_enterprise AND xmdbdocno = g_xmda_m.xmdadocno
               AND xmdb001 = g_xmdc5_d[l_ac].xmdb001
                
            #資料未重複, 插入新增資料
            IF l_count = 0 THEN 
               INSERT INTO xmdb_t
                  (xmdbent,xmdbdocno,xmdb001,xmdbsite,xmdb002,xmdb003,xmdb004,xmdb005,xmdb006,xmdb007,xmdb008,xmdb009) 
                 VALUES(g_enterprise,g_xmda_m.xmdadocno,g_xmdc5_d[l_ac].xmdb001,
                   g_xmdc5_d[l_ac].xmdbsite,g_xmdc5_d[l_ac].xmdb002,g_xmdc5_d[l_ac].xmdb003, 
                   g_xmdc5_d[l_ac].xmdb004,g_xmdc5_d[l_ac].xmdb005,g_xmdc5_d[l_ac].xmdb006, 
                   g_xmdc5_d[l_ac].xmdb007,g_xmdc5_d[l_ac].xmdb008,g_xmdc5_d[l_ac].xmdb009) 

               IF SQLCA.sqlcode THEN
                  CALL cl_err("xmdb_t",SQLCA.sqlcode,1)  
                  CALL s_transaction_end('N','0')                    
                  CANCEL INSERT
               END IF
            ELSE    
               CALL cl_err('INSERT',"std-00006",1)
               INITIALIZE g_xmdc_d[l_ac].* TO NULL
               CALL s_transaction_end('N','0')
               CANCEL INSERT
            END IF
            
            CALL s_transaction_end('Y','0')
            ERROR 'INSERT O.K'
            LET g_rec_b = g_rec_b + 1
            
         ON ROW CHANGE 
            IF INT_FLAG THEN
               CALL cl_err('',9001,0)
               LET INT_FLAG = 0
               LET g_xmdc5_d[l_ac].* = g_xmdc5_d_t.*
               CALL s_transaction_end('N','0')
               EXIT DIALOG 
            END IF
            
            IF l_lock_sw = 'Y' THEN
               CALL cl_err('',-263,1)
               LET g_xmdc5_d[l_ac].* = g_xmdc5_d_t.*
            ELSE
               UPDATE xmdb_t SET (xmdbdocno,xmdbsite,xmdb001,xmdb002,xmdb003,xmdb004,xmdb005,xmdb006,xmdb007,xmdb008,xmdb009) = (g_xmda_m.xmdadocno,g_xmdc5_d[l_ac].xmdbsite,g_xmdc5_d[l_ac].xmdb001,g_xmdc5_d[l_ac].xmdb002,g_xmdc5_d[l_ac].xmdb003,g_xmdc5_d[l_ac].xmdb004,g_xmdc5_d[l_ac].xmdb005,g_xmdc5_d[l_ac].xmdb006,g_xmdc5_d[l_ac].xmdb007,g_xmdc5_d[l_ac].xmdb008,g_xmdc5_d[l_ac].xmdb009) #自訂欄位頁簽
                WHERE xmdbent = g_enterprise AND xmdbdocno = g_xmda_m.xmdadocno
                  AND xmdb001 = g_xmdc5_d_t.xmdb001 #項次                   
               CASE
                  WHEN SQLCA.sqlerrd[3] = 0  #更新不到的處理
                     CALL cl_err("xmdb_t","std-00009",1)
                     CALL s_transaction_end('N','0')
                     LET g_xmdc5_d[l_ac].* = g_xmdc5_d_t.*
                  WHEN SQLCA.sqlcode #其他錯誤
                     CALL cl_err("xmdb_t",SQLCA.sqlcode,1)  
                     CALL s_transaction_end('N','0')
                     LET g_xmdc5_d[l_ac].* = g_xmdc5_d_t.*
                  OTHERWISE
                      INITIALIZE gs_keys TO NULL 
                      LET gs_keys[1] = g_xmda_m.xmdadocno
                      LET gs_keys_bak[1] = g_xmdadocno_t
                      LET gs_keys[2] = g_xmdc5_d[g_detail_idx].xmdb001
                      LET gs_keys_bak[2] = g_xmdc5_d_t.xmdb001
                      CALL adbt500_update_b('xmdb_t',gs_keys,gs_keys_bak,"'5'")
                     #資料多語言用-增/改
                     
               END CASE
            END IF
         
         #---------------------<  Detail: page5  >---------------------
         #----<<xmdb001>>----
         #此段落由子樣板a02產生
         AFTER FIELD xmdb001
            #此段落由子樣板a15產生
            IF NOT cl_ap_chk_Range(g_xmdc5_d[l_ac].xmdb001,"0.000","0","","","azz-00079",1) THEN
               LET g_xmdc5_d[l_ac].xmdb001 = g_xmdc5_d_t.xmdb001
               NEXT FIELD xmdb001
            END IF

            #此段落由子樣板a05產生
            IF  g_xmda_m.xmdadocno IS NOT NULL AND g_xmdc5_d[l_ac].xmdb001 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmda_m.xmdadocno != g_xmdadocno_t OR g_xmdc5_d[l_ac].xmdb001 != g_xmdc5_d_t.xmdb001)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xmdb_t WHERE "||"xmdbent = '" ||g_enterprise|| "' AND "||"xmdbdocno = '"||g_xmda_m.xmdadocno ||"' AND "|| "xmdb001 = '"||g_xmdc5_d[l_ac].xmdb001 ||"'",'std-00004',0) THEN 
                     LET g_xmdc5_d[l_ac].xmdb001 = g_xmdc5_d_t.xmdb001
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

         #----<<xmdb002>>----
         #此段落由子樣板a02產生
         AFTER FIELD xmdb002
            CALL adbt500_xmda009_ref(g_xmdc5_d[l_ac].xmdb002) RETURNING g_xmdc5_d[l_ac].xmdb002_desc
            DISPLAY BY NAME g_xmdc5_d[l_ac].xmdb002_desc
            
            IF NOT cl_null(g_xmdc5_d[l_ac].xmdb002) THEN 
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmda_m.xmda021
               LET g_chkparam.arg2 = g_xmdc5_d[l_ac].xmdb002
                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_pmad002_2") THEN
                  #檢查成功時後續處理

               ELSE
                  #檢查失敗時後續處理
                  LET g_xmdc5_d[l_ac].xmdb002 = g_xmdc5_d_t.xmdb002
                  CALL adbt500_xmda009_ref(g_xmdc5_d[l_ac].xmdb002) RETURNING g_xmdc5_d[l_ac].xmdb002_desc
                  DISPLAY BY NAME g_xmdc5_d[l_ac].xmdb002_desc
                  NEXT FIELD CURRENT
               END IF
            END IF 
         #axmt500-26   
         AFTER FIELD xmdb003
            IF g_xmdc5_d[l_ac].xmdb003 > g_xmdc5_d[l_ac].xmdb004 THEN
               LET g_xmdc5_d[l_ac].xmdb003 = g_xmdc5_d_t.xmdb003
               CALL cl_err('','adb-00080',0)
               NEXT FIELD xmdb003
            END IF  
            
         AFTER FIELD xmdb004
            IF g_xmdc5_d[l_ac].xmdb004 < g_xmdc5_d[l_ac].xmdb003 THEN
               LET g_xmdc5_d[l_ac].xmdb004 = g_xmdc5_d_t.xmdb004
               CALL cl_err('','adb-00080',0)
               NEXT FIELD xmdb004
            END IF  

         #----<<xmdb005>>----
         #此段落由子樣板a02產生
         AFTER FIELD xmdb005
            #此段落由子樣板a15產生
            IF NOT cl_ap_chk_Range(g_xmdc5_d[l_ac].xmdb005,"0.000","0","","","azz-00079",1) THEN
               LET g_xmdc5_d[l_ac].xmdb005 = g_xmdc5_d_t.xmdb005
               NEXT FIELD xmdb005
            END IF

            #axmt500-37
            LET l_sum = 0
            FOR l_i = 1 TO g_xmdc5_d.getLength()
               LET l_sum = l_sum + g_xmdc5_d[l_i].xmdb005
            END FOR
            IF l_sum > g_xmda_m.xmda041 THEN
               LET g_xmdc5_d[l_ac].xmdb005 = g_xmdc5_d_t.xmdb005
               CALL cl_err('','adb-00086',0)
               NEXT FIELD xmdb005
            END IF

            #稅率依單頭需自動推算未稅金額
            IF g_tax_app = '1' THEN

            END IF
         #----<<xmdb006>>----
         #此段落由子樣板a02產生
         AFTER FIELD xmdb006
            #此段落由子樣板a15產生
            IF NOT cl_ap_chk_Range(g_xmdc5_d[l_ac].xmdb006,"0.000","0","","","azz-00079",1) THEN
               LET g_xmdc5_d[l_ac].xmdb006 = g_xmdc5_d_t.xmdb006
               NEXT FIELD xmdb006
            END IF
            #axmt500-37
            LET l_sum = 0
            FOR l_i = 1 TO g_xmdc5_d.getLength()
               LET l_sum = l_sum + g_xmdc5_d[l_i].xmdb006
            END FOR
            IF l_sum > g_xmda_m.xmda042 THEN
               LET g_xmdc5_d[l_ac].xmdb006 = g_xmdc5_d_t.xmdb006
               CALL cl_err('','adb-00087',0)
               NEXT FIELD xmdb006
            END IF
         #---------------------<  Detail: page5  >---------------------
         #----<<xmdb002>>----
         #Ctrlp:input.c.page5.xmdb002
         ON ACTION controlp INFIELD xmdb002
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmdc5_d[l_ac].xmdb002             #給予default值

            #給予arg
            LET g_qryparam.arg1 = g_xmda_m.xmda021 #

            CALL q_pmad002_3()                                #呼叫開窗

            LET g_xmdc5_d[l_ac].xmdb002 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmdc5_d[l_ac].xmdb002 TO xmdb002              #顯示到畫面上
            CALL adbt500_xmda009_ref(g_xmdc5_d[l_ac].xmdb002) RETURNING g_xmdc5_d[l_ac].xmdb002_desc
            DISPLAY BY NAME g_xmdc5_d[l_ac].xmdb002_desc

            NEXT FIELD xmdb002                          #返回原欄位

 
         AFTER ROW
            LET l_ac = ARR_CURR()
            LET l_ac_t = l_ac
            CALL cl_set_act_visible("delete", TRUE)
            IF INT_FLAG THEN
               CALL cl_err('',9001,0)
               LET INT_FLAG = 0
               IF l_cmd = 'u' THEN
                  LET g_xmdc5_d[l_ac].* = g_xmdc5_d_t.*
               END IF
               CLOSE adbt500_bcl15
               CALL s_transaction_end('N','0')
               EXIT DIALOG 
            END IF
            
            #多帳期預付款金額加總不可超過整張訂購單總訂購金額(含未稅金額均不能超過)
            LET l_xmdb005 = 0
            LET l_xmdb006 = 0
            SELECT SUM(xmdb005),SUM(xmdb006) 
              INTO l_xmdb005,l_xmdb006 FROM xmdb_t 
               WHERE xmdbent = g_enterprise AND xmdbdocno = g_xmda_m.xmdadocno

            IF l_xmdb005 > g_xmda_m.xmda041 THEN
               CALL cl_err(g_xmda_m.xmdadocno,'apm-00263',1)
               NEXT FIELD xmdb005
            END IF
            IF l_xmdb006 > g_xmda_m.xmda042 THEN
               CALL cl_err(g_xmda_m.xmdadocno,'apm-00264',1)
               LET g_xmdc5_d[l_ac].xmdb006 = g_xmdc5_d_t.xmdb006
               NEXT FIELD xmdb006
            END IF
            
            #其他table進行unlock
            CLOSE adbt500_bcl15
            CALL s_transaction_end('Y','0')  
            
         AFTER INPUT
            #多帳期預付款金額加總不可超過整張訂購單總訂金額(含未稅金額均不能超過)
            LET l_xmdb005 = 0
            LET l_xmdb006 = 0
            SELECT SUM(xmdb005),SUM(xmdb006) 
              INTO l_xmdb005,l_xmdb006 FROM xmdb_t 
             WHERE xmdbent = g_enterprise AND xmdbdocno = g_xmda_m.xmdadocno
            IF l_xmdb005 > g_xmda_m.xmda041 THEN
               CALL cl_err(g_xmda_m.xmdadocno,'apm-00263',1)
               NEXT FIELD xmdb005
            END IF
            IF l_xmdb006 > g_xmda_m.xmda042 THEN
               CALL cl_err(g_xmda_m.xmdadocno,'apm-00264',1)
               LET g_xmdc5_d[l_ac].xmdb006 = g_xmdc5_d_t.xmdb006
               NEXT FIELD xmdb006
            END IF
 
      END INPUT
   
      ON ACTION controlf
         CALL cl_set_focus_form(ui.Interface.getRootNode()) RETURNING g_fld_name,g_frm_name
         CALL cl_fldhelp(g_frm_name,g_fld_name,g_lang)
 
      ON ACTION controlr
         CALL cl_show_req_fields()
 
      ON ACTION controls
         CALL cl_set_head_visible("","AUTO")
 
      ON ACTION accept
         ACCEPT DIALOG
        
      ON ACTION cancel      #在dialog button (放棄)
         LET INT_FLAG = TRUE 
         EXIT DIALOG
 
      ON ACTION close       #在dialog 右上角 (X)
         LET INT_FLAG = TRUE 
         EXIT DIALOG
 
      ON ACTION exit        #toolbar 離開
         LET INT_FLAG = TRUE 
         EXIT DIALOG
 
      #交談指令共用ACTION
      &include "common_action.4gl" 
         CONTINUE DIALOG 
         
   END DIALOG
   CALL cl_set_act_visible("delete", TRUE)
   CLOSE adbt500_cl2
   LET g_flag1 = FALSE
   
END FUNCTION]]>
  </point>
  <point name="function.adbt500_regen_amounts" order="95" ver="2" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[#單身金額計算
PRIVATE FUNCTION adbt500_regen_amounts()
   DEFINE l_xrcd103       LIKE xrcd_t.xrcd103,
          l_xrcd104       LIKE xrcd_t.xrcd104,
          l_xrcd105       LIKE xrcd_t.xrcd105,
          l_xrcd113       LIKE xrcd_t.xrcd113,
          l_xrcd114       LIKE xrcd_t.xrcd114,
          l_xrcd115       LIKE xrcd_t.xrcd115,
          l_xrcd123       LIKE xrcd_t.xrcd113,
          l_xrcd124       LIKE xrcd_t.xrcd114,
          l_xrcd125       LIKE xrcd_t.xrcd115,
          l_xrcd133       LIKE xrcd_t.xrcd113,
          l_xrcd134       LIKE xrcd_t.xrcd114,
          l_xrcd135       LIKE xrcd_t.xrcd115
          
      IF NOT cl_null(g_xmdc4_d[l_ac].xmja006) AND NOT cl_null(g_xmdc4_d[l_ac].xmja018) AND NOT cl_null(g_xmdc4_d[l_ac].xmja010) 
         AND g_xmdc4_d[l_ac].xmja018 <> 0 AND g_xmdc4_d[l_ac].xmja010 <> 0 THEN
         CALL s_tax_ins(g_xmda_m.xmdadocno,g_xmdc4_d[l_ac].xmjaseq,0,g_xmda_m.xmdasite,g_xmdc4_d[l_ac].xmja018*g_xmdc4_d[l_ac].xmja010,
                        g_xmdc4_d[l_ac].xmja006,g_xmdc4_d[l_ac].xmja018,g_xmda_m.xmda015,g_xmda_m.xmda016,' ',' ',' ')
           RETURNING l_xrcd103,l_xrcd104, l_xrcd105,l_xrcd113,l_xrcd114,l_xrcd115,
                     l_xrcd123,l_xrcd124,l_xrcd125,l_xrcd133,l_xrcd134,l_xrcd135
         IF cl_null(l_xrcd103) THEN LET l_xrcd103 = 0 END IF
         IF cl_null(l_xrcd104) THEN LET l_xrcd104 = 0 END IF
         IF cl_null(l_xrcd105) THEN LET l_xrcd105 = 0 END IF           
         LET g_xmdc4_d[l_ac].xmja019 = l_xrcd103 
         LET g_xmdc4_d[l_ac].xmja020 = l_xrcd104 
         LET g_xmdc4_d[l_ac].xmja021 = l_xrcd105 
      END IF
END FUNCTION]]>
  </point>
  <point name="function.adbt500_set_required_b" order="96" ver="2" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adbt500_set_required_b()
   DEFINE l_imaf015     LIKE imaf_t.imaf015
   DEFINE l_imaf113     LIKE imaf_t.imaf113
   DEFINE l_pmaa002     LIKE pmaa_t.pmaa002
   
      IF l_ac > 0 THEN
         SELECT imaf015,imaf113
           INTO l_imaf015,l_imaf113
           FROM imaf_t
          WHERE imafent = g_enterprise
            AND imafsite = g_xmda_m.xmdasite
            AND imaf001 = g_xmdc4_d[l_ac].xmja003
         IF NOT cl_null(l_imaf015) THEN
            CALL cl_set_comp_required("xmja015",TRUE)
         END IF
         IF NOT cl_null(l_imaf113) THEN
            CALL cl_set_comp_required("xmja017",TRUE)
         END IF
         IF g_xmdc4_d[l_ac].xmja030 = "N" THEN
            CALL cl_set_comp_required("xmja031,xmja032",TRUE) 
         END IF
      END IF
      SELECT pmaa002
        INTO l_pmaa002
        FROM pmaa_t
       WHERE pmaaent = g_enterprise
         AND pmaa001 = g_xmda_m.xmda004
      IF l_pmaa002 = '2' THEN
         CALL cl_set_comp_required("xmja024",TRUE)
      END IF 
END FUNCTION]]>
  </point>
  <point name="function.adbt500_set_no_required_b" order="97" ver="2" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adbt500_set_no_required_b()
      CALL cl_set_comp_required("xmja015,xmja017",FALSE)  
      CALL cl_set_comp_required("xmja024,xmja031,xmja032",FALSE)       
END FUNCTION]]>
  </point>
  <point name="function.adbt500_unit_chk" order="98" ver="2" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[#單位資料檢查
PRIVATE FUNCTION adbt500_unit_chk(p_xmdc006)
DEFINE p_xmdc006    LIKE xmdc_t.xmdc006
DEFINE r_success    LIKE type_t.num5
       
       LET r_success = TRUE
       
       IF NOT cl_null(p_xmdc006) THEN 
          #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
          INITIALIZE g_chkparam.* TO NULL
          
          #設定g_chkparam.*的參數
          LET g_chkparam.arg1 = p_xmdc006
   
          #呼叫檢查存在並帶值的library
          IF NOT cl_chk_exist("v_ooca001") THEN
             LET r_success = FALSE
             RETURN r_success             
          END IF
       END IF 
       RETURN r_success 
END FUNCTION]]>
  </point>
  <point name="function.adbt500_unit_ref" order="99" ver="2" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[#單位帶出說明
PRIVATE FUNCTION adbt500_unit_ref(p_xmdc006)
DEFINE p_xmdc006    LIKE xmdc_t.xmdc006
DEFINE r_oocal003   LIKE oocal_t.oocal003

       INITIALIZE g_ref_fields TO NULL
       LET g_ref_fields[1] = p_xmdc006
       CALL ap_ref_array2(g_ref_fields,"SELECT oocal003 FROM oocal_t WHERE oocalent='"||g_enterprise||"' AND oocal001=? AND oocal002='"||g_dlang||"'","") RETURNING g_rtn_fields
       LET r_oocal003 = '', g_rtn_fields[1] , ''
       RETURN r_oocal003
END FUNCTION]]>
  </point>
  <point name="function.adbt500_xmja012_convert" order="100" ver="2" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adbt500_xmja012_convert()
DEFINE l_rate       LIKE inaj_t.inaj014
DEFINE l_success    LIKE type_t.num5  
     
   IF cl_null(g_xmdc4_d[l_ac].xmja012) OR cl_null(g_xmdc4_d[l_ac].xmja011) THEN
      RETURN
   END IF 
   #銷售數量
   IF NOT cl_null(g_xmdc4_d[l_ac].xmja013) THEN  
      CALL s_aimi190_get_convert(g_xmdc4_d[l_ac].xmja003,g_xmdc4_d[l_ac].xmja011,g_xmdc4_d[l_ac].xmja013) RETURNING l_success,l_rate
      LET g_xmdc4_d[l_ac].xmja014 = g_xmdc4_d[l_ac].xmja012 * l_rate
      #CALL s_adbt540_unit_round(g_xmdc4_d[l_ac].xmja013,g_xmdc4_d[l_ac].xmja014) RETURNING g_xmdc4_d[l_ac].xmja014
      CALL s_aooi250_take_decimals(g_xmdc4_d[l_ac].xmja013,g_xmdc4_d[l_ac].xmja014) RETURNING l_success,g_xmdc4_d[l_ac].xmja014
   END IF
   #參考單位
   IF NOT cl_null(g_xmdc4_d[l_ac].xmja015) THEN  
      CALL s_aimi190_get_convert(g_xmdc4_d[l_ac].xmja003,g_xmdc4_d[l_ac].xmja011,g_xmdc4_d[l_ac].xmja015) RETURNING l_success,l_rate
      LET g_xmdc4_d[l_ac].xmja016 = g_xmdc4_d[l_ac].xmja012 * l_rate
      #CALL s_adbt540_unit_round(g_xmdc4_d[l_ac].xmja015,g_xmdc4_d[l_ac].xmja016) RETURNING g_xmdc4_d[l_ac].xmja016
      CALL s_aooi250_take_decimals(g_xmdc4_d[l_ac].xmja015,g_xmdc4_d[l_ac].xmja016) RETURNING l_success,g_xmdc4_d[l_ac].xmja016
   END IF
   #計價數量
   IF NOT cl_null(g_xmdc4_d[l_ac].xmja017) THEN  
      CALL s_aimi190_get_convert(g_xmdc4_d[l_ac].xmja003,g_xmdc4_d[l_ac].xmja011,g_xmdc4_d[l_ac].xmja017) RETURNING l_success,l_rate
      LET g_xmdc4_d[l_ac].xmja018 = g_xmdc4_d[l_ac].xmja012 * l_rate
      #CALL s_adbt540_unit_round(g_xmdc4_d[l_ac].xmja017,g_xmdc4_d[l_ac].xmja018) RETURNING g_xmdc4_d[l_ac].xmja018
      CALL s_aooi250_take_decimals(g_xmdc4_d[l_ac].xmja017,g_xmdc4_d[l_ac].xmja018) RETURNING l_success,g_xmdc4_d[l_ac].xmja018
   END IF
END FUNCTION]]>
  </point>
  <point name="function.adbt500_xmddsite_ref" order="101" ver="2" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adbt500_xmddsite_ref()
      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_xmdc3_d[l_ac].xmddsite
      CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
      LET g_xmdc3_d[l_ac].xmddsite_desc = '', g_rtn_fields[1] , ''
      DISPLAY BY NAME g_xmdc3_d[l_ac].xmddsite_desc
END FUNCTION]]>
  </point>
  <point name="function.adbt500_get_price" order="102" ver="3" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 取價
# Memo...........:
# Usage..........: CALL adbt500_get_price()
#                  RETURNING r_success
# Input parameter: 
#                : 
# Return code....: r_success     處理狀況
#                :  
# Date & Author..: 日期 By 作者
# Modify.........:
################################################################################
PRIVATE FUNCTION adbt500_get_price()
   DEFINE l_success     LIKE type_t.num5
   
   IF NOT cl_null(g_xmdc4_d[l_ac].xmja003) AND NOT cl_null(g_xmdc4_d[l_ac].xmja013) AND 
      NOT cl_null(g_xmdc4_d[l_ac].xmja014) AND NOT cl_null(g_xmdc4_d[l_ac].xmja006) THEN
      CALL s_get_price_adb('1',g_xmda_m.xmdadocno,g_xmda_m.xmdadocdt,g_xmdc4_d[l_ac].xmjaseq,g_xmda_m.xmda004,g_xmdc4_d[l_ac].xmja003,g_xmdc4_d[l_ac].xmja013,g_xmdc4_d[l_ac].xmja014,g_xmda_m.xmda015,g_xmdc4_d[l_ac].xmja006,'1')
         RETURNING l_success,g_xmdc4_d[l_ac].xmja008,g_xmdc4_d[l_ac].xmja009,g_xmdc4_d[l_ac].xmja010,g_xmdc4_d[l_ac].xmja022
   END IF
END FUNCTION]]>
  </point>
  <point name="b_fill.body.fill_sql" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                    ]]>
  </point>
  <point name="b_fill.body2.fill_sql" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                    ]]>
  </point>
  <point name="b_fill.body3.fill_sql" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                    ]]>
  </point>
  <point name="b_fill.define" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                  ]]>
  </point>
  <point name="b_fill.fill" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="b_fill.sql" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                    ]]>
  </point>
  <point name="b_fill.sql2" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                    ]]>
  </point>
  <point name="b_fill.sql3" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                    ]]>
  </point>
  <point name="b_fill.sql_before" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                  ]]>
  </point>
  <point name="b_fill2.after_fill" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                  ]]>
  </point>
  <point name="b_fill2.define" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                  ]]>
  </point>
  <point name="b_fill2.fill" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                      ]]>
  </point>
  <point name="b_fill3.fill" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                      ]]>
  </point>
  <point name="b_fill5.fill" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[         LET g_xmdc6_d[l_ac].imay0031 = NULL
         LET g_xmdc6_d[l_ac].imaa0011 = NULL
         SELECT xmja002,xmja003
           INTO g_xmdc6_d[l_ac].imay0031,g_xmdc6_d[l_ac].imaa0011
           FROM xmja_t
          WHERE xmjaent = g_enterprise
            AND xmjadocno = g_xmda_m.xmdadocno
            AND xmjaseq = g_xmdc6_d[l_ac].xrcdseq]]>
  </point>
  <point name="b_fill6.fill" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[         LET g_xmdc7_d[l_ac].imay0032 = NULL
         LET g_xmdc7_d[l_ac].imaa0012 = NULL
         SELECT xmja002,xmja003
           INTO g_xmdc7_d[l_ac].imay0032,g_xmdc7_d[l_ac].imaa0012
           FROM xmja_t
          WHERE xmjaent = g_enterprise
            AND xmjadocno = g_xmda_m.xmdadocno
            AND xmjaseq = g_xmdc7_d[l_ac].rtieseq]]>
  </point>
  <point name="browser_fill.after" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                  ]]>
  </point>
  <point name="browser_fill.before_count" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                  ]]>
  </point>
  <point name="browser_fill.before_foreach" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[     
   IF cl_null(g_wc) THEN
      #LET g_wc = " xmdasite = '",g_site,"' AND xmda005 IN ('1','2','3','6') AND xmda007 IN ('1','5') "
      LET g_wc = " AND xmda005 IN ('1','2','3','6') AND xmda007 IN ('1','5') "
   ELSE
      #LET g_wc = g_wc," AND xmdasite = '",g_site,"'  AND xmda005 IN ('1','2','3','6') AND xmda007 IN ('1','5') "
      LET g_wc = g_wc," AND xmda005 IN ('1','2','3','6') AND xmda007 IN ('1','5') "
   END IF
   LET l_wc  = g_wc.trim()   ]]>
  </point>
  <point name="browser_fill.before_prepare" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                  ]]>
  </point>
  <point name="browser_fill.define" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                  ]]>
  </point>
  <point name="browser_fill.open" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                  ]]>
  </point>
  <point name="browser_fill.other_fill" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[
      LET g_sql = "SELECT  UNIQUE rtieseq,rtib003,rtib004,'','',rtieseq1,rtie001,rtie002,'',rtie006 FROM rtie_t", 
                  #" INNER JOIN rtia_t ON rtiaent = rtieent AND rtiadocno = rtiedocno ",
                  " INNER JOIN rtib_t ON rtibent = rtieent AND rtibdocno = rtiedocno AND rtibseq = rtieseq ",
                  " INNER JOIN xmda_t ON xmdadocno = rtie001 ",
                  " WHERE rtieent=? AND xmdadocno=?"   
      LET g_sql = g_sql, " ORDER BY rtie_t.rtieseq,rtie_t.rtieseq1"
            
      PREPARE adbt500_pb6 FROM g_sql
      DECLARE b_fill_cs6 CURSOR FOR adbt500_pb6
      
      LET l_ac = 1
      
      OPEN b_fill_cs6 USING g_enterprise,g_xmda_m.xmdadocno
 
                                               
      FOREACH b_fill_cs6 INTO g_xmdc7_d[l_ac].rtieseq,g_xmdc7_d[l_ac].imay0032,g_xmdc7_d[l_ac].imaa0012, 
          g_xmdc7_d[l_ac].imaa0012_desc,g_xmdc7_d[l_ac].imaa0012_desc_desc,g_xmdc7_d[l_ac].rtieseq1, 
          g_xmdc7_d[l_ac].rtie001,g_xmdc7_d[l_ac].rtie002,g_xmdc7_d[l_ac].rtie002_desc,g_xmdc7_d[l_ac].rtie006 

         IF SQLCA.sqlcode THEN
            CALL cl_err("FOREACH:",SQLCA.sqlcode,1)
            EXIT FOREACH
         END IF
      
         LET l_ac = l_ac + 1
         IF l_ac > g_max_rec THEN
            CALL cl_err( '', 9035, 0 )
            EXIT FOREACH
         END IF
         
      END FOREACH
   CALL g_xmdc7_d.deleteElement(g_xmdc7_d.getLength())]]>
  </point>
  <point name="browser_fill.reference" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                    ]]>
  </point>
  <point name="browser_search.define" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                  ]]>
  </point>
  <point name="construct.a.page1.imaal004" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.page1.xmdc001" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.page1.xmdc002" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.page1.xmdc004" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.page1.xmdc005" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.page1.xmdc006" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.page1.xmdc007" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.page1.xmdc008" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.page1.xmdc009" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.page1.xmdc010" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.page1.xmdc011" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.page1.xmdc012" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.page1.xmdc013" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.page1.xmdc015" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.page1.xmdc016" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.page1.xmdc019" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.page1.xmdc020" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.page1.xmdc021" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.page1.xmdc022" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.page1.xmdc023" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.page1.xmdc024" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.page1.xmdc027" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.page1.xmdc045" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.page1.xmdc049" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.page1.xmdc050" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.page1.xmdc052" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.page1.xmdcorga" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.page1.xmdcseq" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.page1.xmdcunit" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.page2.xmdc003" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.page2.xmdc025" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.page2.xmdc026" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.page2.xmdc0272" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.page2.xmdc028" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.page2.xmdc029" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.page2.xmdc030" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.page2.xmdc031" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.page2.xmdc032" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.page2.xmdc033" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.page2.xmdc034" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.page2.xmdc036" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.page2.xmdc037" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.page2.xmdc038" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.page2.xmdc039" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.page3.xmdc012" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.page3.xmdc013" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.xmda001" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.xmda002" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.xmda003" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.xmda004" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.xmda005" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.xmda006" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.xmda007" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.xmda008" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.xmda009" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.xmda010" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.xmda011" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.xmda012" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.xmda013" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.xmda015" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.xmda016" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.xmda017" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.xmda018" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.xmda019" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.xmda020" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.xmda021" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.xmda022" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.xmda023" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.xmda024" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.xmda025" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.xmda026" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.xmda027" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.xmda028" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.xmda030" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.xmda031" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.xmda032" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.xmda033" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.xmda034" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.xmda035" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.xmda036" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.xmda037" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.xmda038" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.xmda039" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.xmda043" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.xmda044" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.xmdacnfid" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.xmdacrtdp" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.xmdacrtid" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.xmdadocdt" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.xmdadocno" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.xmdamodid" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.xmdaowndp" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.xmdaownid" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.xmdapstid" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.xmdasite" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.a.xmdastus" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.page1.imaal004" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.page1.xmdc001" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.page1.xmdc002" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.page1.xmdc004" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.page1.xmdc005" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.page1.xmdc006" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.page1.xmdc007" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.page1.xmdc008" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.page1.xmdc009" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.page1.xmdc010" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.page1.xmdc011" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.page1.xmdc012" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.page1.xmdc013" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.page1.xmdc015" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.page1.xmdc016" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.page1.xmdc019" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.page1.xmdc020" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.page1.xmdc021" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.page1.xmdc022" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.page1.xmdc023" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.page1.xmdc024" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.page1.xmdc027" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.page1.xmdc045" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.page1.xmdc049" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.page1.xmdc050" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.page1.xmdc052" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.page1.xmdcorga" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.page1.xmdcseq" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.page1.xmdcunit" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.page2.xmdc003" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.page2.xmdc025" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.page2.xmdc026" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.page2.xmdc0272" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.page2.xmdc028" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.page2.xmdc029" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.page2.xmdc030" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.page2.xmdc031" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.page2.xmdc032" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.page2.xmdc033" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.page2.xmdc034" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.page2.xmdc036" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.page2.xmdc037" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.page2.xmdc038" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.page2.xmdc039" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.page3.xmdc012" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.page3.xmdc013" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.xmda001" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.xmda002" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.xmda003" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.xmda004" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.xmda005" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.xmda006" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.xmda007" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.xmda008" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.xmda009" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.xmda010" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.xmda011" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.xmda012" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.xmda013" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.xmda015" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.xmda016" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.xmda017" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.xmda018" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.xmda019" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.xmda020" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.xmda021" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.xmda022" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.xmda023" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.xmda024" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.xmda025" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.xmda026" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.xmda027" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.xmda028" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.xmda030" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.xmda031" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.xmda032" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.xmda033" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.xmda034" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.xmda035" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.xmda036" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.xmda037" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.xmda038" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.xmda039" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.xmda043" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.xmda044" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.xmdacnfdt" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.xmdacnfid" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.xmdacrtdp" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.xmdacrtdt" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.xmdacrtid" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.xmdadocdt" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.xmdadocno" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.xmdamoddt" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.xmdamodid" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.xmdaowndp" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.xmdaownid" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.xmdapstdt" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.xmdapstid" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.xmdasite" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.b.xmdastus" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.c.page1.imaal004" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.c.page1.xmdc001" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_imaa001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdc001  #顯示到畫面上

            NEXT FIELD xmdc001                     #返回原欄位

]]>
  </point>
  <point name="construct.c.page1.xmdc002" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.c.page1.xmdc004" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			LET g_qryparam.arg1 = '221'
            CALL q_oocq002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdc004  #顯示到畫面上

            NEXT FIELD xmdc004                     #返回原欄位

]]>
  </point>
  <point name="construct.c.page1.xmdc005" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.c.page1.xmdc006" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooca001_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdc006  #顯示到畫面上

            NEXT FIELD xmdc006                     #返回原欄位

]]>
  </point>
  <point name="construct.c.page1.xmdc007" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.c.page1.xmdc008" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooca001_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdc008  #顯示到畫面上

            NEXT FIELD xmdc008                     #返回原欄位

]]>
  </point>
  <point name="construct.c.page1.xmdc009" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.c.page1.xmdc010" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooca001_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdc010  #顯示到畫面上

            NEXT FIELD xmdc010                     #返回原欄位

]]>
  </point>
  <point name="construct.c.page1.xmdc011" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.c.page1.xmdc012" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.c.page1.xmdc013" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.c.page1.xmdc015" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.c.page1.xmdc016" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_oodb002_2()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdc016  #顯示到畫面上

            NEXT FIELD xmdc016                     #返回原欄位

]]>
  </point>
  <point name="construct.c.page1.xmdc019" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.c.page1.xmdc020" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.c.page1.xmdc021" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.c.page1.xmdc022" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.c.page1.xmdc023" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_pmac002_6()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdc023  #顯示到畫面上
               #DISPLAY g_qryparam.return2 TO pmaal004 #交易對象簡稱 

            NEXT FIELD xmdc023                     #返回原欄位

]]>
  </point>
  <point name="construct.c.page1.xmdc024" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.c.page1.xmdc027" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_pmao004_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdc027  #顯示到畫面上

            NEXT FIELD xmdc027                     #返回原欄位

]]>
  </point>
  <point name="construct.c.page1.xmdc045" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.c.page1.xmdc049" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			LET g_qryparam.arg1 = g_acc
            CALL q_oocq002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdc049  #顯示到畫面上

            NEXT FIELD xmdc049                     #返回原欄位

]]>
  </point>
  <point name="construct.c.page1.xmdc050" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.c.page1.xmdc052" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.c.page1.xmdc053" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			LET g_qryparam.arg1 = g_acc
            CALL q_oocq002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdc053  #顯示到畫面上

            NEXT FIELD xmdc053                     #返回原欄位

]]>
  </point>
  <point name="construct.c.page1.xmdcorga" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooef001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdcorga  #顯示到畫面上

            NEXT FIELD xmdcorga                     #返回原欄位

]]>
  </point>
  <point name="construct.c.page1.xmdcseq" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.c.page1.xmdcunit" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooef001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdcunit  #顯示到畫面上

            NEXT FIELD xmdcunit                     #返回原欄位

]]>
  </point>
  <point name="construct.c.page1.xmja002" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_imay003_6()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmja002  #顯示到畫面上
            NEXT FIELD xmja002                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page1.xmja003" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_imaa001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmja003  #顯示到畫面上
            NEXT FIELD xmja003                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page1.xmja005" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_prcf001_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmja005  #顯示到畫面上
            NEXT FIELD xmja005                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page1.xmja006" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_oodb002_2()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmja006  #顯示到畫面上
            NEXT FIELD xmja006                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page1.xmja011" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_ooca001_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmja011  #顯示到畫面上
            NEXT FIELD xmja011                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page1.xmja013" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_ooca001_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmja013  #顯示到畫面上
            NEXT FIELD xmja013                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page1.xmja015" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_ooca001_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmja015  #顯示到畫面上
            NEXT FIELD xmja015                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page1.xmja017" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_ooca001_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmja017  #顯示到畫面上
            NEXT FIELD xmja017                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page1.xmja024" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_pmaa001_18()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmja024  #顯示到畫面上
            NEXT FIELD xmja024                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page1.xmja026" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_oofb019()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmja026  #顯示到畫面上
            NEXT FIELD xmja026                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page1.xmja027" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_dbad001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmja027  #顯示到畫面上
            NEXT FIELD xmja027                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page1.xmja033" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_pmao004_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmja033  #顯示到畫面上
            NEXT FIELD xmja033                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page2.xmda0272" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_pmao004_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmda0272  #顯示到畫面上

            NEXT FIELD xmda0272                     #返回原欄位

]]>
  </point>
  <point name="construct.c.page2.xmdc003" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.c.page2.xmdc025" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			LET g_qryparam.arg1 = g_oofa001
            CALL q_oofb019_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdc025  #顯示到畫面上

            NEXT FIELD xmdc025                     #返回原欄位

]]>
  </point>
  <point name="construct.c.page2.xmdc026" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			LET g_qryparam.arg1 = g_oofa001
            CALL q_oofb019_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdc026  #顯示到畫面上

            NEXT FIELD xmdc026                     #返回原欄位

]]>
  </point>
  <point name="construct.c.page2.xmdc027" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_pmao004_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdc027  #顯示到畫面上

            NEXT FIELD xmdc027                     #返回原欄位

]]>
  </point>
  <point name="construct.c.page2.xmdc0272" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_pmao004_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdc0272  #顯示到畫面上

            NEXT FIELD xmdc0272                     #返回原欄位

]]>
  </point>
  <point name="construct.c.page2.xmdc027_1" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_pmao004_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdc027_1  #顯示到畫面上

            NEXT FIELD xmdc027_1                     #返回原欄位

]]>
  </point>
  <point name="construct.c.page2.xmdc028" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_inaa001_6()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdc028  #顯示到畫面上

            NEXT FIELD xmdc028                     #返回原欄位

]]>
  </point>
  <point name="construct.c.page2.xmdc029" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_inab002_6()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdc029  #顯示到畫面上

            NEXT FIELD xmdc029                     #返回原欄位

]]>
  </point>
  <point name="construct.c.page2.xmdc030" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.c.page2.xmdc031" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			LET g_qryparam.arg1 = "263"
            CALL q_oocq002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdc031  #顯示到畫面上
          
            NEXT FIELD xmda031                     #返回原欄位                                                                        ]]>
  </point>
  <point name="construct.c.page2.xmdc032" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.c.page2.xmdc033" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.c.page2.xmdc034" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.c.page2.xmdc036" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.c.page2.xmdc037" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.c.page2.xmdc038" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.c.page2.xmdc039" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.c.page3.xmdc012" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.c.page3.xmdc013" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.c.page3.xmdd001" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_imaa001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdd001  #顯示到畫面上

            NEXT FIELD xmdd001                     #返回原欄位

]]>
  </point>
  <point name="construct.c.page3.xmdd004" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooca001_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdd004  #顯示到畫面上

            NEXT FIELD xmdd004                     #返回原欄位

]]>
  </point>
  <point name="construct.c.page3.xmdd017" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_oodb002_2()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdd017  #顯示到畫面上

            NEXT FIELD xmdd017                     #返回原欄位

]]>
  </point>
  <point name="construct.c.page3.xmdd019" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_oodb002_2()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdd019  #顯示到畫面上
            NEXT FIELD xmdd019                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page3.xmdd022" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooag001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdd022  #顯示到畫面上

            NEXT FIELD xmdd022                     #返回原欄位

]]>
  </point>
  <point name="construct.c.page3.xmdd024" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooca001_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdd024  #顯示到畫面上

            NEXT FIELD xmdd024                     #返回原欄位

]]>
  </point>
  <point name="construct.c.page3.xmdd026" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooca001_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdd026  #顯示到畫面上

            NEXT FIELD xmdd026                     #返回原欄位

]]>
  </point>
  <point name="construct.c.page3.xmdd200" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_prcf001_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdd200  #顯示到畫面上
            NEXT FIELD xmdd200                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page3.xmdd201" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_ooca001_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdd201  #顯示到畫面上
            NEXT FIELD xmdd201                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page3.xmdd207" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_pmaa001_18()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdd207  #顯示到畫面上
            NEXT FIELD xmdd207                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page3.xmdd210" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.arg1 = "274"
            CALL q_oocq002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdd210  #顯示到畫面上
            NEXT FIELD xmdd210                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page3.xmdd213" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.arg1 = g_site
            CALL q_inaa001_4()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdd213  #顯示到畫面上
            NEXT FIELD xmdd213                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page3.xmdd214" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.arg1 = g_site
            CALL q_inab002_8()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdd214  #顯示到畫面上
            NEXT FIELD xmdd214                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page3.xmdd218" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.arg1 = "1"
            CALL q_oojd001_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdd218  #顯示到畫面上
            NEXT FIELD xmdd218                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page3.xmdd219" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_dbba001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdd219  #顯示到畫面上
            NEXT FIELD xmdd219                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page3.xmdd220" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_dbbc001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdd220  #顯示到畫面上
            NEXT FIELD xmdd220                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page3.xmdd222" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.arg1 = "G"
            CALL q_ooef001_3()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdd222  #顯示到畫面上
            NEXT FIELD xmdd222                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page3.xmdd223" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_ooag001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdd223  #顯示到畫面上
            NEXT FIELD xmdd223                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page3.xmdd224" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.arg1 = g_xmda_m.xmdadocdt
            CALL q_ooeg001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdd224  #顯示到畫面上
            NEXT FIELD xmdd224                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page3.xmdd227" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.arg1 = "2060"
            CALL q_oocq002_5()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdd227  #顯示到畫面上
            NEXT FIELD xmdd227                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page3.xmdd228" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_staa001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdd228  #顯示到畫面上
            NEXT FIELD xmdd228                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page3.xmddorga" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.arg1 = "A"
            CALL q_ooef001_3()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmddorga  #顯示到畫面上
            NEXT FIELD xmddorga                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page3.xmddsite" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.arg1 = g_site
			   LET g_qryparam.arg2 = '2'
            CALL q_ooed004_3()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmddsite  #顯示到畫面上
            NEXT FIELD xmddsite                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page3.xmddunit" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
			   LET g_qryparam.arg1 = g_site
			   LET g_qryparam.arg2 = '2'
            CALL q_ooed004_3()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmddunit  #顯示到畫面上
            NEXT FIELD xmddunit                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page4.xmdc001" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_imaa001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdc001  #顯示到畫面上
            NEXT FIELD xmdc001                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page4.xmdc004" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_oocq002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdc004  #顯示到畫面上
            NEXT FIELD xmdc004                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page4.xmdc006" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_ooca001_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdc006  #顯示到畫面上
            NEXT FIELD xmdc006                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page4.xmdc008" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_ooca001_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdc008  #顯示到畫面上
            NEXT FIELD xmdc008                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page4.xmdc010" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_ooca001_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdc010  #顯示到畫面上
            NEXT FIELD xmdc010                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page4.xmdc016" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_oodb002_2()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdc016  #顯示到畫面上
            NEXT FIELD xmdc016                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page4.xmdc023" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_pmac002_4()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdc023  #顯示到畫面上
            NEXT FIELD xmdc023                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page4.xmdc027" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_pmao004_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdc027  #顯示到畫面上
            NEXT FIELD xmdc027                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page4.xmdc049" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_oocq002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdc049  #顯示到畫面上
            NEXT FIELD xmdc049                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page4.xmdc053" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_oocq002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdc053  #顯示到畫面上
            NEXT FIELD xmdc053                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page4.xmdcorga" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_ooef001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdcorga  #顯示到畫面上
            NEXT FIELD xmdcorga                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page4.xmdcunit" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_ooef001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdcunit  #顯示到畫面上
            NEXT FIELD xmdcunit                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page4.xmde001" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_imaa001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmde001  #顯示到畫面上

            NEXT FIELD xmde001                     #返回原欄位

]]>
  </point>
  <point name="construct.c.page4.xmde003" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_xmdadocno()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmde003  #顯示到畫面上

            NEXT FIELD xmde003                     #返回原欄位

]]>
  </point>
  <point name="construct.c.page4.xmde008" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_oocq002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmde008  #顯示到畫面上

            NEXT FIELD xmde008                     #返回原欄位

]]>
  </point>
  <point name="construct.c.page4.xmde022" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooca001_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmde022  #顯示到畫面上

            NEXT FIELD xmde022                     #返回原欄位

]]>
  </point>
  <point name="construct.c.page4.xmja002" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_imay003_6()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmja002  #顯示到畫面上
            NEXT FIELD xmja002                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page4.xmja003" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_imaa001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmja003  #顯示到畫面上
            NEXT FIELD xmja003                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page4.xmja004" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_xmja004()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmja004  #顯示到畫面上
            NEXT FIELD xmja004                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page4.xmja005" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_prcf001_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmja005  #顯示到畫面上
            NEXT FIELD xmja005                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page4.xmja006" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_oodb002_2()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmja006  #顯示到畫面上
            NEXT FIELD xmja006                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page4.xmja011" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_ooca001_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmja011  #顯示到畫面上
            NEXT FIELD xmja011                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page4.xmja013" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_ooca001_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmja013  #顯示到畫面上
            NEXT FIELD xmja013                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page4.xmja015" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_ooca001_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmja015  #顯示到畫面上
            NEXT FIELD xmja015                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page4.xmja017" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_ooca001_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmja017  #顯示到畫面上
            NEXT FIELD xmja017                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page4.xmja024" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_pmaa001_18()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmja024  #顯示到畫面上
            NEXT FIELD xmja024                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page4.xmja026" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_oofb019()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmja026  #顯示到畫面上
            NEXT FIELD xmja026                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page4.xmja027" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_dbad001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmja027  #顯示到畫面上
            NEXT FIELD xmja027                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page4.xmja028" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_stce001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmja028  #顯示到畫面上
            NEXT FIELD xmja028                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page4.xmja033" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_pmao004_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmja033  #顯示到畫面上
            NEXT FIELD xmja033                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page4.xmjasite" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.arg1 = g_site
			   LET g_qryparam.arg2 = '2'
            CALL q_ooed004_3()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmjasite  #顯示到畫面上
            NEXT FIELD xmjasite                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page5.xmdb002" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooib002_2()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdb002  #顯示到畫面上

            NEXT FIELD xmdb002                     #返回原欄位

]]>
  </point>
  <point name="construct.c.page6.xrcd002" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_oodb002_2()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xrcd002  #顯示到畫面上
            NEXT FIELD xrcd002                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page7.rtie002" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_ooia001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO rtie002  #顯示到畫面上
            NEXT FIELD rtie002                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page8.xmdc001" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_imaa001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdc001  #顯示到畫面上
            NEXT FIELD xmdc001                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page8.xmdc004" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_oocq002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdc004  #顯示到畫面上
            NEXT FIELD xmdc004                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page8.xmdc006" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_ooca001_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdc006  #顯示到畫面上
            NEXT FIELD xmdc006                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page8.xmdc008" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_ooca001_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdc008  #顯示到畫面上
            NEXT FIELD xmdc008                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page8.xmdc010" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_ooca001_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdc010  #顯示到畫面上
            NEXT FIELD xmdc010                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page8.xmdc016" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_oodb002_2()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdc016  #顯示到畫面上
            NEXT FIELD xmdc016                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page8.xmdc023" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_pmac002_4()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdc023  #顯示到畫面上
            NEXT FIELD xmdc023                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page8.xmdc027" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_pmao004_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdc027  #顯示到畫面上
            NEXT FIELD xmdc027                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page8.xmdc049" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_oocq002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdc049  #顯示到畫面上
            NEXT FIELD xmdc049                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page8.xmdc053" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_oocq002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdc053  #顯示到畫面上
            NEXT FIELD xmdc053                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page8.xmdcorga" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_ooef001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdcorga  #顯示到畫面上
            NEXT FIELD xmdcorga                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page8.xmdcunit" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_ooef001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdcunit  #顯示到畫面上
            NEXT FIELD xmdcunit                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.xmda001" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.c.xmda002" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooag001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmda002  #顯示到畫面上

            NEXT FIELD xmda002                     #返回原欄位

]]>
  </point>
  <point name="construct.c.xmda003" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			LET g_qryparam.arg1 = g_xmda_m.xmdadocdt
            CALL q_ooeg001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmda003  #顯示到畫面上

            NEXT FIELD xmda003                     #返回原欄位

]]>
  </point>
  <point name="construct.c.xmda004" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE	
		
            CALL q_pmaa001_6()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmda004        #顯示到畫面上

            NEXT FIELD xmda004                           #返回原欄位

]]>
  </point>
  <point name="construct.c.xmda005" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.c.xmda006" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.c.xmda007" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.c.xmda008" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_xmda008()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmda008  #顯示到畫面上

            NEXT FIELD xmda008                     #返回原欄位

]]>
  </point>
  <point name="construct.c.xmda009" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			LET g_qryparam.arg1 = g_xmda_m.xmda004
            CALL q_ooib002_2()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmda009        #顯示到畫面上
            
            CALL adbt500_xmda009_ref(g_xmda_m.xmda009) RETURNING g_xmda_m.xmda009_desc
            DISPLAY BY NAME g_xmda_m.xmda009_desc
            NEXT FIELD xmda009                            #返回原欄位

]]>
  </point>
  <point name="construct.c.xmda010" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
		    LET g_qryparam.arg1 = '238'
            CALL q_oocq002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmda010  #顯示到畫面上

            NEXT FIELD xmda010                     #返回原欄位

]]>
  </point>
  <point name="construct.c.xmda011" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_oodb002_2()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmda011  #顯示到畫面上

            NEXT FIELD xmda011                     #返回原欄位

]]>
  </point>
  <point name="construct.c.xmda012" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.c.xmda013" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.c.xmda015" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			LET g_qryparam.arg1 = g_site
            CALL q_ooaj002_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmda015  #顯示到畫面上

            NEXT FIELD xmda015                     #返回原欄位

]]>
  </point>
  <point name="construct.c.xmda016" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.c.xmda017" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_xmah001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmda017  #顯示到畫面上

            NEXT FIELD xmda017                     #返回原欄位

]]>
  </point>
  <point name="construct.c.xmda018" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooid001_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmda018  #顯示到畫面上

            NEXT FIELD xmda018                     #返回原欄位

]]>
  </point>
  <point name="construct.c.xmda019" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.c.xmda020" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			LET g_qryparam.arg1 = "263"
            CALL q_oocq002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmda020  #顯示到畫面上

            NEXT FIELD xmda020                     #返回原欄位

]]>
  </point>
  <point name="construct.c.xmda021" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			   LET g_qryparam.reqry = FALSE
            CALL q_pmac002_5()                       #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmda021    #顯示到畫面上
            

            NEXT FIELD xmda021                     #返回原欄位

]]>
  </point>
  <point name="construct.c.xmda022" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_pmac002_6()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmda022  #顯示到畫面上
               

            NEXT FIELD xmda022                     #返回原欄位

]]>
  </point>
  <point name="construct.c.xmda023" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			   INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			   LET g_qryparam.reqry = FALSE
		      LET g_qryparam.arg1 = "1"
            CALL q_oojd001_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmda023  #顯示到畫面上

            NEXT FIELD xmda023                     #返回原欄位

]]>
  </point>
  <point name="construct.c.xmda024" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			LET g_qryparam.arg1 = "295"
            CALL q_oocq002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmda024  #顯示到畫面上

            NEXT FIELD xmda024                     #返回原欄位

]]>
  </point>
  <point name="construct.c.xmda025" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			LET g_qryparam.where = " oofb008 = '3' " 
			LET g_qryparam.arg1 = g_oofa001
            CALL q_oofb019_1()                           #呼叫開窗
            
            DISPLAY g_qryparam.return1 TO xmda025  #顯示到畫面上

            NEXT FIELD xmda025                     #返回原欄位

]]>
  </point>
  <point name="construct.c.xmda026" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			LET g_qryparam.where = " oofb008 = '5' "
			LET g_qryparam.arg1 = g_oofa001
            CALL q_oofb019_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmda026  #顯示到畫面上

            NEXT FIELD xmda026                     #返回原欄位

]]>
  </point>
  <point name="construct.c.xmda027" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			   #INITIALIZE g_qryparam.* TO NULL
            #LET g_qryparam.state = 'c'
			   #LET g_qryparam.reqry = FALSE
			   #LET g_qryparam.arg1 = g_xmda_m.xmda004
            #CALL q_pmaj002()                           #呼叫開窗
            #DISPLAY g_qryparam.return1 TO xmda027  #顯示到畫面上
            #CALL adbt500_xmda027_ref(g_xmda_m.xmda027) RETURNING g_xmda_m.xmda027_desc
            #DISPLAY BY NAME g_xmda_m.xmda027_desc
            #NEXT FIELD xmda027                     #返回原欄位

]]>
  </point>
  <point name="construct.c.xmda028" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.c.xmda030" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.c.xmda031" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_xmda031()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmda031  #顯示到畫面上

            NEXT FIELD xmda031	                     #返回原欄位                                                                        ]]>
  </point>
  <point name="construct.c.xmda032" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
		    LET g_qryparam.arg1 = "297"
            CALL q_oocq002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmda032  #顯示到畫面上

            NEXT FIELD xmda032                     #返回原欄位

]]>
  </point>
  <point name="construct.c.xmda033" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.c.xmda034" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_pmaa001_6()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmda034  #顯示到畫面上
               #DISPLAY g_qryparam.return2 TO pmaal004 #交易對象簡稱 

            NEXT FIELD xmda034                     #返回原欄位

]]>
  </point>
  <point name="construct.c.xmda035" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			   LET g_qryparam.reqry = FALSE
		      #LET g_qryparam.arg1 = g_ooef019 
            #LET g_qryparam.arg2 = "2"                
            CALL q_isac002_3()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmda035       #顯示到畫面上
            NEXT FIELD xmda035                     #返回原欄位
]]>
  </point>
  <point name="construct.c.xmda036" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_pmaa001_3()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmda036  #顯示到畫面上

            NEXT FIELD xmda036                     #返回原欄位

]]>
  </point>
  <point name="construct.c.xmda037" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_xmda037()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmda037  #顯示到畫面上

            NEXT FIELD xmda037                     #返回原欄位

]]>
  </point>
  <point name="construct.c.xmda038" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_xmda038()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmda038  #顯示到畫面上

            NEXT FIELD xmda038                     #返回原欄位

]]>
  </point>
  <point name="construct.c.xmda039" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.c.xmda043" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.c.xmda044" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			LET g_qryparam.arg1 = g_xmda_m.xmda004
            CALL q_itcf002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmda044  #顯示到畫面上

            NEXT FIELD xmda044                     #返回原欄位

]]>
  </point>
  <point name="construct.c.xmda200" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_pmaa001_20()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmda200  #顯示到畫面上
            NEXT FIELD xmda200                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.xmda201" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_pmaa001_10()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmda201  #顯示到畫面上
            NEXT FIELD xmda201                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.xmda202" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.arg1 = "G"
            CALL q_ooef001_3()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmda202  #顯示到畫面上
            NEXT FIELD xmda202                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.xmda203" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.arg1 = g_xmda_m.xmda004
            LET g_qryparam.arg2 = '3'
            CALL q_pmac002_9()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmda203  #顯示到畫面上
            NEXT FIELD xmda203                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.xmda204" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_prcf001_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmda204  #顯示到畫面上
            NEXT FIELD xmda204                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.xmda206" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_dbad001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmda206  #顯示到畫面上
            NEXT FIELD xmda206                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.xmda207" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_dbab001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmda207  #顯示到畫面上
            NEXT FIELD xmda207                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.xmdacnfid" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooag001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdacnfid  #顯示到畫面上

            NEXT FIELD xmdacnfid                     #返回原欄位

]]>
  </point>
  <point name="construct.c.xmdacrtdp" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooea001_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdacrtdp  #顯示到畫面上

            NEXT FIELD xmdacrtdp                     #返回原欄位

]]>
  </point>
  <point name="construct.c.xmdacrtid" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooag001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdacrtid  #顯示到畫面上

            NEXT FIELD xmdacrtid                     #返回原欄位

]]>
  </point>
  <point name="construct.c.xmdadocdt" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.c.xmdadocno" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			   LET g_qryparam.reqry = FALSE
            CALL q_xmdadocno_5()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdadocno  #顯示到畫面上

            NEXT FIELD xmdadocno                     #返回原欄位

]]>
  </point>
  <point name="construct.c.xmdamodid" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooag001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdamodid  #顯示到畫面上

            NEXT FIELD xmdamodid                     #返回原欄位

]]>
  </point>
  <point name="construct.c.xmdaowndp" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooea001_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdaowndp  #顯示到畫面上

            NEXT FIELD xmdaowndp                     #返回原欄位

]]>
  </point>
  <point name="construct.c.xmdaownid" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooag001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdaownid  #顯示到畫面上

            NEXT FIELD xmdaownid                     #返回原欄位

]]>
  </point>
  <point name="construct.c.xmdapstid" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooag001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdapstid  #顯示到畫面上

            NEXT FIELD xmdapstid                     #返回原欄位

]]>
  </point>
  <point name="construct.c.xmdasite" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #開窗c段
			   INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			   LET g_qryparam.reqry = FALSE
			   LET g_qryparam.arg1 = g_site
			   LET g_qryparam.arg2 = '2'
            CALL q_ooed004_3()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdasite  #顯示到畫面上
            
            NEXT FIELD xmdasite                     #返回原欄位                                                     ]]>
  </point>
  <point name="construct.c.xmdastus" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="construct.c.xmdaunit" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.arg1 = '2'
            CALL q_ooed004_2()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdaunit  #顯示到畫面上
            NEXT FIELD xmdaunit                     #返回原欄位
    

]]>
  </point>
  <point name="cs.add_cs" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                    ]]>
  </point>
  <point name="cs.after_construct" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                  ]]>
  </point>
  <point name="cs.b_dialog" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[         LET g_xmdc_d[1].xmdcseq = ""
         DISPLAY ARRAY g_xmdc_d TO s_detail1.*
            BEFORE DISPLAY
               EXIT DISPLAY
         END DISPLAY  
         LET g_xmdc3_d[1].xmddseq = ""
         DISPLAY ARRAY g_xmdc3_d TO s_detail3.*
            BEFORE DISPLAY
               EXIT DISPLAY
         END DISPLAY  
         LET g_xmdc4_d[1].xmjaseq = ""
         DISPLAY ARRAY g_xmdc4_d TO s_detail4.*
            BEFORE DISPLAY
               EXIT DISPLAY
         END DISPLAY          ]]>
  </point>
  <point name="cs.before_construct" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                  ]]>
  </point>
  <point name="cs.body.before_construct" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="cs.body2.before_construct" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="cs.body3.before_construct" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="cs.define" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[   DEFINE l_sql       STRING
   DEFINE l_success   LIKE type_t.num5  
   DEFINE l_pmaa027   LIKE pmaa_t.pmaa027   ]]>
  </point>
  <point name="cs.head.before_construct" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="default_search.after" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                  ]]>
  </point>
  <point name="default_search.before" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                  ]]>
  </point>
  <point name="default_search.define" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                  ]]>
  </point>
  <point name="delete.body.a_delete" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                    ]]>
  </point>
  <point name="delete.body.a_delete2" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                    ]]>
  </point>
  <point name="delete.body.a_delete3" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[      #刪除訂單多交期匯總檔
      LET l_cnt = 0
      SELECT COUNT(*) INTO l_cnt
        FROM xmdf_t 
       WHERE xmdfent = g_enterprise 
         AND xmdfdocno = g_xmda_m.xmdadocno
      IF l_cnt > 0 THEN   
         DELETE FROM xmdf_t WHERE xmdfent = g_enterprise AND xmdfdocno = g_xmda_m.xmdadocno
         IF SQLCA.sqlcode THEN
            CALL cl_err("xmdf_t",SQLCA.sqlcode,0)
            CALL s_transaction_end('N','0')
           RETURN
         END IF
      END IF

      #一次性交易對象
      LET l_cnt = 0
      SELECT COUNT(*) INTO l_cnt
        FROM pmak_t 
       WHERE pmakent = g_enterprise 
         AND pmak001 = g_xmda_m.xmda028
      IF l_cnt > 0 THEN
         DELETE FROM pmak_t WHERE pmakent = g_enterprise AND pmak001 = g_xmda_m.xmda028
         IF SQLCA.sqlcode THEN
            CALL cl_err("pmak_t",SQLCA.sqlcode,0)
            CALL s_transaction_end('N','0')
            RETURN
         END IF            
      END IF      ]]>
  </point>
  <point name="delete.body.b_delete" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                    ]]>
  </point>
  <point name="delete.body.b_delete2" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                    ]]>
  </point>
  <point name="delete.body.b_delete3" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                    ]]>
  </point>
  <point name="delete.body.m_delete" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                    ]]>
  </point>
  <point name="delete.body.m_delete2" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                    ]]>
  </point>
  <point name="delete.body.m_delete3" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                    ]]>
  </point>
  <point name="delete.define" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[   DEFINE  l_cnt   LIKE type_t.num5]]>
  </point>
  <point name="delete.head.a_delete" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[      IF NOT s_aooi200_del_docno(g_xmda_m.xmdadocno,g_xmda_m.xmdadocdt) THEN
         CALL s_transaction_end('N','0')
         RETURN
      END IF]]>
  </point>
  <point name="delete.head.b_delete" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                    ]]>
  </point>
  <point name="delete.head.m_delete" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                          ]]>
  </point>
  <point name="delete_b.a_delete" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                    ]]>
  </point>
  <point name="delete_b.a_delete2" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                    ]]>
  </point>
  <point name="delete_b.a_delete3" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                    ]]>
  </point>
  <point name="delete_b.b_delete" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                    ]]>
  </point>
  <point name="delete_b.b_delete2" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                    ]]>
  </point>
  <point name="delete_b.b_delete3" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                    ]]>
  </point>
  <point name="delete_b.define" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                  ]]>
  </point>
  <point name="delete_b.m_delete" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                    ]]>
  </point>
  <point name="delete_b.m_delete2" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                    ]]>
  </point>
  <point name="delete_b.m_delete3" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                    ]]>
  </point>
  <point name="delete_b.other" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                  ]]>
  </point>
  <point name="detail_reproduce.body.table1.a_insert" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                  ]]>
  </point>
  <point name="detail_reproduce.body.table1.b_insert" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                  ]]>
  </point>
  <point name="detail_reproduce.body.table1.m_insert" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                  ]]>
  </point>
  <point name="detail_reproduce.body.table2.a_insert" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                  ]]>
  </point>
  <point name="detail_reproduce.body.table2.b_insert" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                  ]]>
  </point>
  <point name="detail_reproduce.body.table2.m_insert" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                  ]]>
  </point>
  <point name="detail_reproduce.body.table3.a_insert" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                  ]]>
  </point>
  <point name="detail_reproduce.body.table3.b_insert" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                  ]]>
  </point>
  <point name="detail_reproduce.body.table3.m_insert" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                  ]]>
  </point>
  <point name="detail_reproduce.define" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                  ]]>
  </point>
  <point name="detail_show.after" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                  ]]>
  </point>
  <point name="detail_show.before" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                  ]]>
  </point>
  <point name="detail_show.define" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                  ]]>
  </point>
  <point name="fetch.action_control" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[   CALL cl_set_act_visible("modify,delete,modify_detail,open_xmdb,open_apmi004_01,open_adbt500_02,open_adbt500_03,adbt500_04,open_s_pay,open_s_pay09", TRUE)
   #IF g_xmda_m.xmdastus <> 'N' THEN
   IF g_xmda_m.xmdastus NOT MATCHES "[NDR]" THEN   # N未確認/D抽單/R已拒絕允許修改
      CALL cl_set_act_visible("modify,delete,modify_detail,open_apmi004_01,open_adbt500_03,adbt500_04,open_xmdb", FALSE)
   END IF
   IF g_xmda_m.xmdastus <> 'Y' THEN 
      CALL cl_set_act_visible("open_adbt500_02,open_s_pay,open_s_pay09", FALSE)             
   END IF 
   IF NOT cl_null(g_xmda_m.xmda004) THEN
       LET l_pmaa004 = ''
       SELECT pmaa004 INTO l_pmaa004 FROM pmaa_t WHERE pmaaent = g_enterprise AND pmaa001 = g_xmda_m.xmda004
       IF l_pmaa004 NOT MATCHES '[24]' THEN
          CALL cl_set_act_visible("open_apmi004_01", FALSE)
       ELSE
          CALL cl_set_act_visible("open_apmi004_01", TRUE)       
       END IF
    ELSE
       CALL cl_set_act_visible("open_apmi004_01", FALSE)
    END IF  
  ]]>
  </point>
  <point name="fetch.after" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[   #判斷當下的營運據點是否在控制組限制的營運據點範圍內，若不在限制內則不允許新增
   CALL cl_set_act_visible("modify,delete,insert,open_xmdb", TRUE)

   CALL s_control_chk_group('5','3',g_user,g_dept,g_site,'','','','') RETURNING l_success,l_flag
   IF l_success THEN                            #處理狀態為FALSE，則隱藏新增按鈕
      IF NOT l_flag THEN                        #不在控制組範圍內
         CALL cl_set_act_visible("insert", FALSE)
      END IF
   ELSE
      CALL cl_set_act_visible("insert", FALSE)
   END IF

   #IF g_xmda_m.xmdastus != 'N' THEN
   IF g_xmda_m.xmdastus NOT MATCHES "[NDR]" THEN   # N未確認/D抽單/R已拒絕允許修改
      CALL cl_set_act_visible("modify,delete,open_apmi004_01,open_xmdb", FALSE)
   END IF                         ]]>
  </point>
  <point name="fetch.define" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[   DEFINE l_pmaa004  LIKE pmaa_t.pmaa004 
   DEFINE l_success  LIKE type_t.num5
   DEFINE l_flag     LIKE type_t.num5  ]]>
  </point>
  <point name="fill_chk.define" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                  ]]>
  </point>
  <point name="fill_chk.other_chk" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                    ]]>
  </point>
  <point name="filter.add_cs" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                    ]]>
  </point>
  <point name="filter.b_dialog" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                      ]]>
  </point>
  <point name="filter.define" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                  ]]>
  </point>
  <point name="filter_parser.define" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                  ]]>
  </point>
  <point name="global.variable" order="" ver="3" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[DEFINE g_flag         LIKE type_t.num5
DEFINE g_flag1        LIKE type_t.num5
DEFINE g_flag2        LIKE type_t.num5
DEFINE g_flag3        LIKE type_t.num5
DEFINE g_oofa001      LIKE oofa_t.oofa001
DEFINE g_ooef019      LIKE ooef_t.ooef019
DEFINE g_acc          LIKE gzcb_t.gzcb007
DEFINE g_pmab089      LIKE pmab_t.pmab089
DEFINE g_inam       DYNAMIC ARRAY OF RECORD   #記錄產品特徵
         inam001      LIKE inam_t.inam001,
         inam002      LIKE inam_t.inam002,
         inam004      LIKE inam_t.inam004
                   END RECORD   
DEFINE g_tax_app      LIKE oodb_t.oodb011      #取得稅別類型1:正常稅率2:依料件設定
DEFINE g_oodbl004     LIKE oodbl_t.oodbl004    #課稅原则
DEFINE g_oodb005      LIKE oodb_t.oodb005      #單價是否含稅
DEFINE g_oodb006      LIKE oodb_t.oodb006      #稅率
DEFINE g_xmah003      LIKE xmah_t.xmah003      #價格是否允許修改

 TYPE type_g_xmdc7_d RECORD
       rtieseq LIKE rtie_t.rtieseq, 
   imay0032 LIKE type_t.chr80, 
   imaa0012 LIKE type_t.chr80, 
   imaa0012_desc LIKE type_t.chr500, 
   imaa0012_desc_desc LIKE type_t.chr500, 
   rtieseq1 LIKE rtie_t.rtieseq1, 
   rtie001 LIKE rtie_t.rtie001, 
   rtie002 LIKE rtie_t.rtie002, 
   rtie002_desc LIKE type_t.chr500, 
   rtie006 LIKE rtie_t.rtie006
      END RECORD 
DEFINE g_xmdc7_d   DYNAMIC ARRAY OF type_g_xmdc7_d
DEFINE g_xmdc7_d_t type_g_xmdc7_d]]>
  </point>
  <point name="idx_chk.define" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                  ]]>
  </point>
  <point name="idx_chk.other" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[   IF g_current_page = 6 THEN
      LET g_detail_idx = g_curr_diag.getCurrentRow("s_detail7")
      IF g_detail_idx > g_xmdc7_d.getLength() THEN
         LET g_detail_idx = g_xmdc7_d.getLength()
      END IF
      IF g_detail_idx = 0 AND g_xmdc7_d.getLength() <> 0 THEN
         LET g_detail_idx = 1
      END IF
      DISPLAY g_detail_idx TO FORMONLY.idx
      DISPLAY g_xmdc7_d.getLength() TO FORMONLY.cnt
   END IF            ]]>
  </point>
  <point name="init.define" order="" ver="3" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[   DEFINE l_success      LIKE type_t.num5        ]]>
  </point>
  <point name="init.init" order="" ver="3" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[   CALL s_get_price_adb_create_tab() RETURNING l_success

   CALL cl_set_combo_scc('xmdc035','2039') 
   CALL cl_set_combo_scc('xmdc040','2067') 
   CALL cl_set_combo_scc_part('xmdc019','2055','1,2,3')
   CALL cl_set_combo_scc('xmdd003','2055')
   CALL cl_set_combo_scc('xmdd009','2057')   
   CALL cl_set_combo_scc('xmdd017','2058')
   CALL cl_set_combo_scc_part('xmda005','2063','1,2,3,6')  
   CALL cl_set_combo_scc_part('xmda007','2065','1,5')  
   CALL cl_set_combo_scc('xmja001','6064')   
   CALL cl_set_combo_scc('xmdd226','6013') 
   CALL cl_set_combo_scc('xmdd229','6064')
   CALL cl_set_combo_scc('rtie001','8310')
   LET g_errshow = '1']]>
  </point>
  <point name="input.a.page1.imaal004" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.a.page1.xmdc001" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            CALL adbt500_xmdc001_ref(g_xmdc_d[l_ac].xmdc001) 
              RETURNING g_xmdc_d[l_ac].xmdc001_desc,g_xmdc_d[l_ac].imaal004
            DISPLAY BY NAME g_xmdc_d[l_ac].xmdc001_desc,g_xmdc_d[l_ac].imaal004
            IF NOT cl_null(g_xmdc_d[l_ac].xmdc001) THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmdc_d[l_ac].xmdc001 != g_xmdc_d_o.xmdc001)) THEN 
                  IF NOT adbt500_xmdc001_chk(g_xmdc_d[l_ac].xmdc001) THEN
                     LET g_xmdc_d[l_ac].xmdc001 = g_xmdc_d_o.xmdc001
                     CALL adbt500_xmdc001_ref(g_xmdc_d[l_ac].xmdc001) RETURNING g_xmdc_d[l_ac].xmdc001_desc,g_xmdc_d[l_ac].imaal004
                     DISPLAY BY NAME g_xmdc_d[l_ac].xmdc001_desc,g_xmdc_d[l_ac].imaal004
                     NEXT FIELD CURRENT
                  END IF
                  CALL adbt500_xmdc001_desc()
                  
                  #修改料號時需要開窗詢問是否重新取價，若選擇要時則需呼叫取價應用元件重新取價，
                  #並重新呼叫'計算金額'應用元件計算[C:含稅金額]、[C:未稅金額]、[C:稅額]
               END IF
               LET g_xmdc_d_o.xmdc001 = g_xmdc_d[l_ac].xmdc001
            END IF 
           
            CALL adbt500_set_entry_b(l_cmd)
            CALL adbt500_set_no_entry_b(l_cmd)
            
            LET g_xmdc2_d[l_ac].imaa001 = g_xmdc_d[l_ac].xmdc001
            LET g_xmdc2_d[l_ac].imaal003 = g_xmdc_d[l_ac].xmdc001_desc
            LET g_xmdc2_d[l_ac].imaal004 = g_xmdc_d[l_ac].imaal004]]>
  </point>
  <point name="input.a.page1.xmdc002" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #依交易對象、料號、產品特徵回傳客戶料號
            IF NOT cl_null(g_xmdc_d[l_ac].xmdc001) AND cl_null(g_xmdc_d[l_ac].xmdc002) THEN
               CALL s_apmi070_get_pmao004(g_xmda_m.xmda004,g_xmdc_d[l_ac].xmdc001,g_xmdc_d[l_ac].xmdc002)
                 RETURNING r_success,l_pmao004
               IF r_success THEN
                  LET g_xmdc_d[l_ac].xmdc027 = l_pmao004
                  DISPLAY BY NAME g_xmdc_d[l_ac].xmdc027
               END IF
            END IF                                                                       ]]>
  </point>
  <point name="input.a.page1.xmdc004" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                               CALL adbt500_xmdc004_ref(g_xmdc_d[l_ac].xmdc004) RETURNING g_xmdc_d[l_ac].xmdc004_desc
               DISPLAY BY NAME g_xmdc_d[l_ac].xmdc004_desc 
               IF NOT cl_null(g_xmdc_d[l_ac].xmdc004) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmdc_d[l_ac].xmdc004

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_oocq002_221") THEN
                  #檢查成功時後續處理
               ELSE
                  #檢查失敗時後續處理
                  LET g_xmdc_d[l_ac].xmdc004 = g_xmdc_d_t.xmdc004
                  CALL adbt500_xmdc004_ref(g_xmdc_d[l_ac].xmdc004) RETURNING g_xmdc_d[l_ac].xmdc004_desc
                  DISPLAY BY NAME g_xmdc_d[l_ac].xmdc004_desc
                  NEXT FIELD CURRENT
               END IF
            END IF 
]]>
  </point>
  <point name="input.a.page1.xmdc005" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.a.page1.xmdc006" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                            CALL adbt500_unit_ref(g_xmdc_d[l_ac].xmdc006) RETURNING g_xmdc_d[l_ac].xmdc006_desc
            DISPLAY BY NAME g_xmdc_d[l_ac].xmdc006_desc
            IF NOT cl_null(g_xmdc_d[l_ac].xmdc006) THEN 
               IF NOT adbt500_unit_chk(g_xmdc_d[l_ac].xmdc006) THEN
                  LET g_xmdc_d[l_ac].xmdc006 = g_xmdc_d_t.xmdc006
                  CALL adbt500_unit_ref(g_xmdc_d[l_ac].xmdc006) RETURNING g_xmdc_d[l_ac].xmdc006_desc
                  DISPLAY BY NAME g_xmdc_d[l_ac].xmdc006_desc
                  NEXT FIELD CURRENT
               END IF
               
               IF NOT cl_null(g_xmdc_d[l_ac].xmdc007)  THEN
                  CALL adbt500_unit_round(g_xmdc_d[l_ac].xmdc006,g_xmdc_d[l_ac].xmdc007) RETURNING g_xmdc_d[l_ac].xmdc007
                  DISPLAY BY NAME g_xmdc_d[l_ac].xmdc007   
                 #若料號有使用銷售計價單位時，則輸入[C:訂單數量]時則應自動推算計價數量
                 #[C:計價數量]=[C:訂購數量量]*[C:訂單單位]與[C:計價單位]換算率
                 IF cl_get_para(g_enterprise,g_site,'S-BAS-0019') = "Y" THEN  #體參數使用採購計價單位aoos020
                    CALL s_aimi190_get_convert(g_xmdc_d[l_ac].xmdc001,g_xmdc_d[l_ac].xmdc006,g_xmdc_d[l_ac].xmdc010) 
                      RETURNING l_success,l_rate
                    LET g_xmdc_d[l_ac].xmdc011 = g_xmdc_d[l_ac].xmdc007 * l_rate
                    IF NOT cl_null(g_xmdc_d[l_ac].xmdc011) THEN
                       CALL adbt500_unit_round(g_xmdc_d[l_ac].xmdc010,g_xmdc_d[l_ac].xmdc011) RETURNING g_xmdc_d[l_ac].xmdc011
                       DISPLAY BY NAME g_xmdc_d[l_ac].xmdc011
                    END IF 
                 END IF

               END IF 
            END IF ]]>
  </point>
  <point name="input.a.page1.xmdc007" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                            IF NOT cl_null(g_xmdc_d[l_ac].xmdc007) THEN
               IF NOT cl_null(g_xmdc_d[l_ac].xmdc006) THEN
                  CALL adbt500_unit_round(g_xmdc_d[l_ac].xmdc006,g_xmdc_d[l_ac].xmdc007) RETURNING g_xmdc_d[l_ac].xmdc007
                  DISPLAY BY NAME g_xmdc_d[l_ac].xmdc007

                  #若料號有使用銷售計價單位時，則輸入[C:訂單數量]時則應自動推算計價數量
                  #[C:計價數量]=[C:訂購數量量]*[C:訂單單位]與[C:計價單位]換算率
                  IF cl_get_para(g_enterprise,g_site,'S-BAS-0019') = "Y" THEN  #體參數使用採購計價單位
                     CALL s_aimi190_get_convert(g_xmdc_d[l_ac].xmdc001,g_xmdc_d[l_ac].xmdc006,g_xmdc_d[l_ac].xmdc010) 
                       RETURNING l_success,l_rate
                     LET g_xmdc_d[l_ac].xmdc011 = g_xmdc_d[l_ac].xmdc007 * l_rate
                     IF NOT cl_null(g_xmdc_d[l_ac].xmdc011) THEN
                        CALL adbt500_unit_round(g_xmdc_d[l_ac].xmdc010,g_xmdc_d[l_ac].xmdc011) RETURNING g_xmdc_d[l_ac].xmdc011
                        DISPLAY BY NAME g_xmdc_d[l_ac].xmdc011
                     END IF
                  END IF
                 #若料號有設置使用參考單位時且訂單單位與參考單位有設置換算率時，則應自動推算參考數量
                 #[C:參考數量]=[C:訂單量]*[C:訂單單位]與[C:參考單位]換算率
                 #當修改訂單數量時需呼叫計算金額應用元件重新計算[C:未稅金額]、[C:含稅金額]、[稅額]                  
               END IF
            END IF
]]>
  </point>
  <point name="input.a.page1.xmdc008" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                    CALL adbt500_unit_ref(g_xmdc_d[l_ac].xmdc008) RETURNING g_xmdc_d[l_ac].xmdc008_desc
            DISPLAY BY NAME g_xmdc_d[l_ac].xmdc008_desc
            IF NOT cl_null(g_xmdc_d[l_ac].xmdc008) THEN 
               IF NOT adbt500_unit_chk(g_xmdc_d[l_ac].xmdc008) THEN
                  LET g_xmdc_d[l_ac].xmdc008 = g_xmdc_d_t.xmdc008
                  CALL adbt500_unit_ref(g_xmdc_d[l_ac].xmdc008) RETURNING g_xmdc_d[l_ac].xmdc008_desc
                  DISPLAY BY NAME g_xmdc_d[l_ac].xmdc008_desc
                  NEXT FIELD CURRENT
               END IF
               
               IF NOT cl_null(g_xmdc_d[l_ac].xmdc009) THEN
                  CALL adbt500_unit_round(g_xmdc_d[l_ac].xmdc008,g_xmdc_d[l_ac].xmdc009) RETURNING g_xmdc_d[l_ac].xmdc009
                  DISPLAY BY NAME g_xmdc_d[l_ac].xmdc009   
               END IF 
            END IF 
]]>
  </point>
  <point name="input.a.page1.xmdc009" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                            IF NOT cl_null(g_xmdc_d[l_ac].xmdc009) THEN
               IF NOT cl_null(g_xmdc_d[l_ac].xmdc008) THEN
                  CALL adbt500_unit_round(g_xmdc_d[l_ac].xmdc008,g_xmdc_d[l_ac].xmdc009) RETURNING g_xmdc_d[l_ac].xmdc009
                  DISPLAY BY NAME g_xmdc_d[l_ac].xmdc009
               END IF
            END IF
             
]]>
  </point>
  <point name="input.a.page1.xmdc010" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                CALL adbt500_unit_ref(g_xmdc_d[l_ac].xmdc010) RETURNING g_xmdc_d[l_ac].xmdc010_desc
            DISPLAY BY NAME g_xmdc_d[l_ac].xmdc010_desc
            IF NOT cl_null(g_xmdc_d[l_ac].xmdc010) THEN 
               IF NOT adbt500_unit_chk(g_xmdc_d[l_ac].xmdc010) THEN
                  LET g_xmdc_d[l_ac].xmdc010 = g_xmdc_d_t.xmdc010
                  CALL adbt500_unit_ref(g_xmdc_d[l_ac].xmdc010) RETURNING g_xmdc_d[l_ac].xmdc010_desc
                  DISPLAY BY NAME g_xmdc_d[l_ac].xmdc010_desc
                  NEXT FIELD CURRENT
               END IF
               
               IF NOT cl_null(g_xmdc_d[l_ac].xmdc011) THEN
                  CALL adbt500_unit_round(g_xmdc_d[l_ac].xmdc010,g_xmdc_d[l_ac].xmdc011) RETURNING g_xmdc_d[l_ac].xmdc011
                  DISPLAY BY NAME g_xmdc_d[l_ac].xmdc011   
               END IF 
            END IF ]]>
  </point>
  <point name="input.a.page1.xmdc011" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xmdc_d[l_ac].xmdc011) THEN
               #根據單位對數量進行取位
               IF NOT cl_null(g_xmdc_d[l_ac].xmdc010) THEN
                  CALL adbt500_unit_round(g_xmdc_d[l_ac].xmdc010,g_xmdc_d[l_ac].xmdc011) RETURNING g_xmdc_d[l_ac].xmdc011
                  DISPLAY BY NAME g_xmdc_d[l_ac].xmdc011
               END IF
 
               #若有修改計價數量，則重新計算未稅金額、含稅金額、稅額
               IF g_xmdc_d[l_ac].xmdc011 <> g_xmdc_d_o.xmdc011 THEN
                  IF g_xmdc_d[l_ac].xmdc011 > 0 AND g_xmdc_d[l_ac].xmdc015 > 0 THEN
                     CALL s_axmt500_get_amount(g_xmdc_d[l_ac].xmdc011,g_xmdc_d[l_ac].xmdc015,g_xmdc_d[l_ac].xmdc016,g_xmda_m.xmda015,g_xmda_m.xmda016)
                       RETURNING g_xmdc_d[l_ac].xmdc046,g_xmdc_d[l_ac].xmdc047,g_xmdc_d[l_ac].xmdc048   
                     DISPLAY BY NAME g_xmdc_d[l_ac].xmdc046,g_xmdc_d[l_ac].xmdc047,g_xmdc_d[l_ac].xmdc048
                  END IF
               END IF
            END IF
            LET g_xmdc_d_o.xmdc011 = g_xmdc_d[l_ac].xmdc011]]>
  </point>
  <point name="input.a.page1.xmdc012" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                            #根據交貨日期計算緊急度
              CALL adbt500_xmdc012_to_xmdc020()                       ]]>
  </point>
  <point name="input.a.page1.xmdc013" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.a.page1.xmdc015" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            LET l_xmah004 = ''
            LET l_xmah005 = ''
            LET l_xmah006 = ''
            IF NOT cl_null(g_xmdc_d[l_ac].xmdc015) THEN
               SELECT xmah004,xmah005,xmah006 INTO l_xmah004,l_xmah005,l_xmah006 FROM xmah_t
                  WHERE xmahent = g_enterprise AND xmah001 = g_pmdl_m.pmdl027
               IF l_xmah006 <> 'Y' AND g_xmdc_d[l_ac].xmdc015 = 0 THEN  #價格不允許為0
                  CALL cl_err(g_xmdc_d[l_ac].xmdc015,'apm-00273',1)
                  LET g_xmdc_d[l_ac].xmdc015 = g_xmdc_d_t.xmdc015
                  NEXT FIELD CURRENT
               END IF
               #若輸入的單價超過單頭取價方式的基本資料設置的容差率時，需判斷單價與取出單價的差異是否在容差率範圍內，若在範圍外則依據取價方式的基本資料設置的處理方式進行管控
               
               #若有修改單價，則重新計算未稅金額、含稅金額、稅額
               IF g_xmdc_d[l_ac].xmdc015 <> g_xmdc_d_o.xmdc015 THEN
                  #按幣種對金額做取位
                  CALL s_curr_round(g_xmda_m.xmdasite,g_xmda_m.xmda015,g_xmdc_d[l_ac].xmdc015,'1')
                       RETURNING g_xmdc_d[l_ac].xmdc015
                  IF g_xmdc_d[l_ac].xmdc011 > 0 AND g_xmdc_d[l_ac].xmdc015 > 0 THEN
                     CALL s_axmt500_get_amount(g_xmdc_d[l_ac].xmdc011,g_xmdc_d[l_ac].xmdc015,g_xmdc_d[l_ac].xmdc016,g_xmda_m.xmda015,g_xmda_m.xmda016)
                       RETURNING g_xmdc_d[l_ac].xmdc046,g_xmdc_d[l_ac].xmdc047,g_xmdc_d[l_ac].xmdc048
                     DISPLAY BY NAME g_xmdc_d[l_ac].xmdc046,g_xmdc_d[l_ac].xmdc047,g_xmdc_d[l_ac].xmdc048
                  END IF   
               END IF
               LET g_xmdc_d_o.xmdc015 = g_xmdc_d[l_ac].xmdc015  
            END IF
           ]]>
  </point>
  <point name="input.a.page1.xmdc016" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            CALL adbt500_xmda011_ref(g_xmdc_d[l_ac].xmdc016) RETURNING g_xmdc_d[l_ac].xmdc016_desc
            DISPLAY BY NAME g_xmdc_d[l_ac].xmdc016_desc
            
            IF NOT cl_null(g_xmdc_d[l_ac].xmdc016) THEN 
               IF adbt500_xmda011_chk('2',g_xmdc_d[l_ac].xmdc016) THEN
                  #檢查成功時後續處理
                    #帶出單身稅率
                    LET l_oodb006 = ''
                    CALL s_tax_chk(g_site,g_xmdc_d[l_ac].xmdc016)
                      RETURNING l_success,g_oodbl004,l_oodb005,l_oodb006,l_oodb011     
                    IF l_success THEN
                       LET g_xmdc_d[l_ac].xmdc017 = l_oodb006
                       DISPLAY BY NAME g_xmdc_d[l_ac].xmdc017
                    END IF
               ELSE
                  #檢查失敗時後續處理
                  LET g_xmdc_d[l_ac].xmdc016 = g_xmdc_d_t.xmdc016
                  CALL adbt500_xmda011_ref(g_xmdc_d[l_ac].xmdc016) RETURNING g_xmdc_d[l_ac].xmdc016_desc
                  DISPLAY BY NAME g_xmdc_d[l_ac].xmdc016_desc
                  NEXT FIELD CURRENT
               END IF
               #若有修改稅別，則重新計算未稅金額、含稅金額、稅額
               IF g_xmdc_d[l_ac].xmdc016 <> g_xmdc_d_o.xmdc016 THEN
                  #計算未稅金額、含稅金額、稅額
                  IF g_xmdc_d[l_ac].xmdc011 > 0 AND g_xmdc_d[l_ac].xmdc015 > 0 THEN
                     CALL s_axmt500_get_amount(g_xmdc_d[l_ac].xmdc011,g_xmdc_d[l_ac].xmdc015,g_xmdc_d[l_ac].xmdc016,g_xmda_m.xmda015,g_xmda_m.xmda016)
                       RETURNING g_xmdc_d[l_ac].xmdc046,g_xmdc_d[l_ac].xmdc047,g_xmdc_d[l_ac].xmdc048
                     DISPLAY BY NAME g_xmdc_d[l_ac].xmdc046,g_xmdc_d[l_ac].xmdc047,
                                     g_xmdc_d[l_ac].xmdc048
                  END IF
               END IF                  
               LET g_xmdc_d_o.xmdc016 = g_xmdc_d[l_ac].xmdc016               
            END IF 
             
]]>
  </point>
  <point name="input.a.page1.xmdc019" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.a.page1.xmdc020" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.a.page1.xmdc021" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.a.page1.xmdc022" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.a.page1.xmdc023" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[
            
            IF NOT cl_null(g_xmdc_d[l_ac].xmdc023) THEN 

            END IF]]>
  </point>
  <point name="input.a.page1.xmdc024" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            IF g_xmdc_d[l_ac].xmdc024 = 'Y' THEN
               CALL axmt500_03(g_xmda_m.xmdadocno,g_xmdc_d[l_ac].xmdcseq,g_xmdc_d[l_ac].xmdc007)
               RETURNING g_xmdc_d[l_ac].xmdc012,g_xmdc_d[l_ac].xmdc013
               DISPLAY BY NAME g_xmdc_d[l_ac].xmdc012,g_xmdc_d[l_ac].xmdc013
               CALL adbt500_set_entry_b(l_cmd)
               CALL adbt500_set_no_entry_b(l_cmd)

            END IF
]]>
  </point>
  <point name="input.a.page1.xmdc027" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xmdc_d[l_ac].xmdc027) THEN
               IF cl_null(g_xmdc_d[l_ac].xmdc001) THEN
                  #若料件為空時，呼叫元件帶出料件+產品特徵
                  CALL s_apmi070_get_pmao002_pmao003(g_xmda_m.xmda004,g_xmdc_d[l_ac].xmdc027)
                    RETURNING r_success,l_pmao002,l_pmao003
                             
                  IF NOT r_success THEN              
                     LET g_xmdc_d[l_ac].xmdc027 = g_xmdc_d_o.xmdc027
                     DISPLAY BY NAME g_xmdc_d[l_ac].xmdc027
                     NEXT FIELD CURRENT
                  END IF
                  LET g_xmdc_d[l_ac].xmdc001 = l_pmao002
                  LET g_xmdc_d[l_ac].xmdc002 = l_pmao003
                  DISPLAY BY NAME g_xmdc_d[l_ac].xmdc001,g_xmdc_d[l_ac].xmdc002
                END IF  
                #此段落由子樣板a19產生
                #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
                INITIALIZE g_chkparam.* TO NULL
		       
                #設定g_chkparam.*的參數
                LET g_chkparam.arg1 = g_xmda_m.xmda004
                LET g_chkparam.arg2 = g_xmdc_d[l_ac].xmdc001
                LET g_chkparam.arg3 = g_xmdc_d[l_ac].xmdc002
                LET g_chkparam.arg4 = g_xmdc_d[l_ac].xmdc027
		       
		       
                #呼叫檢查存在並帶值的library
                IF NOT cl_null(g_xmdc_d[l_ac].xmdc001) AND NOT cl_null(g_xmdc_d[l_ac].xmdc002) THEN
                   IF cl_chk_exist("v_pmao004") THEN
                      #檢查成功時後續處理
                      CALL adbt500_xmdc001_ref(g_xmdc_d[l_ac].xmdc001) 
                        RETURNING g_xmdc_d[l_ac].xmdc001_desc,g_xmdc_d[l_ac].imaal004
                      DISPLAY BY NAME g_xmdc_d[l_ac].xmdc001_desc,g_xmdc_d[l_ac].imaal004
                   ELSE
                      #檢查失敗時後續處理
                      LET g_xmdc_d[l_ac].xmdc027 = g_xmdc_d_o.xmdc027
                      DISPLAY BY NAME g_xmdc_d[l_ac].xmdc027
                      NEXT FIELD CURRENT
                   END IF
                ELSE 
                   IF cl_chk_exist("v_pmao004_1") THEN
                      #檢查成功時後續處理
                      CALL adbt500_xmdc001_ref(g_xmdc_d[l_ac].xmdc001) 
                        RETURNING g_xmdc_d[l_ac].xmdc001_desc,g_xmdc_d[l_ac].imaal004
                      DISPLAY BY NAME g_xmdc_d[l_ac].xmdc001_desc,g_xmdc_d[l_ac].imaal004                     
                   ELSE
                      #檢查失敗時後續處理
                      LET g_xmdc_d[l_ac].xmdc027 = g_xmdc_d_o.xmdc027
                      DISPLAY BY NAME g_xmdc_d[l_ac].xmdc027
                      NEXT FIELD CURRENT
                   END IF           
                END IF
                LET g_xmdc_d_o.xmdc027 = g_xmdc_d[l_ac].xmdc027
                LET g_xmdc_d_o.xmdc001 = g_xmdc_d[l_ac].xmdc001
                LET g_xmdc_d_o.xmdc002 = g_xmdc_d[l_ac].xmdc002                
            END IF              ]]>
  </point>
  <point name="input.a.page1.xmdc045" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.a.page1.xmdc049" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                    CALL adbt500_xmdc049_ref(g_xmdc_d[l_ac].xmdc049) RETURNING g_xmdc_d[l_ac].xmdc049_desc
            DISPLAY BY NAME g_xmdc_d[l_ac].xmdc049_desc
            
            IF NOT cl_null(g_xmdc_d[l_ac].xmdc049) THEN
               IF NOT adbt500_xmdc049_chk(g_xmdc_d[l_ac].xmdc049) THEN
                  LET g_xmdc_d[l_ac].xmdc049 = g_xmdc_d_t.xmdc049
                  CALL adbt500_xmdc049_ref(g_xmdc_d[l_ac].xmdc049) RETURNING g_xmdc_d[l_ac].xmdc049_desc
                  DISPLAY BY NAME g_xmdc_d[l_ac].xmdc049_desc
                  NEXT FIELD CURRENT
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page1.xmdc050" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.a.page1.xmdc052" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.a.page1.xmdc053" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmdc_d[l_ac].xmdc053
            CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='265' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmdc_d[l_ac].xmdc053_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmdc_d[l_ac].xmdc053_desc
]]>
  </point>
  <point name="input.a.page1.xmdcorga" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                    CALL adbt500_xmda003_ref(g_xmdc_d[l_ac].xmdcorga) RETURNING g_xmdc_d[l_ac].xmdcorga_desc
            DISPLAY BY NAME g_xmdc_d[l_ac].xmdcorga_desc
            IF NOT cl_null(g_xmdc_d[l_ac].xmdcorga) THEN 
               IF NOT adbt500_xmdcunit_chk(g_xmdc_d[l_ac].xmdcorga) THEN
                  LET g_xmdc_d[l_ac].xmdcorga = g_xmdc_d_t.xmdcorga
                  CALL adbt500_xmda003_ref(g_xmdc_d[l_ac].xmdcorga) RETURNING g_xmdc_d[l_ac].xmdcorga_desc
                  DISPLAY BY NAME g_xmdc_d[l_ac].xmdcorga_desc
                  NEXT FIELD CURRENT
               END IF
            ELSE
               LET g_xmdc_d[l_ac].xmdcorga = g_site
               CALL adbt500_xmda003_ref(g_xmdc_d[l_ac].xmdcorga) RETURNING g_xmdc_d[l_ac].xmdcorga_desc
               DISPLAY BY NAME g_xmdc_d[l_ac].xmdcorga_desc
            END IF]]>
  </point>
  <point name="input.a.page1.xmdcseq" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                    #此段落由子樣板a05產生
            IF  g_xmda_m.xmdadocno IS NOT NULL AND g_xmdc_d[g_detail_idx].xmdcseq IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmda_m.xmdadocno != g_xmdadocno_t OR g_xmdc_d[g_detail_idx].xmdcseq != g_xmdc_d_t.xmdcseq)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xmdc_t WHERE "||"xmdcent = '" ||g_enterprise|| "' AND "||"xmdcdocno = '"||g_xmda_m.xmdadocno ||"' AND "|| "xmdcseq = '"||g_xmdc_d[g_detail_idx].xmdcseq ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page1.xmdcunit" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                    CALL adbt500_xmda003_ref(g_xmdc_d[l_ac].xmdcunit) RETURNING g_xmdc_d[l_ac].xmdcunit_desc
            DISPLAY BY NAME g_xmdc_d[l_ac].xmdcunit_desc
            IF NOT cl_null(g_xmdc_d[l_ac].xmdcunit) THEN 
               IF NOT adbt500_xmdcunit_chk(g_xmdc_d[l_ac].xmdcunit) THEN
                  LET g_xmdc_d[l_ac].xmdcunit = g_xmdc_d_t.xmdcunit
                  CALL adbt500_xmda003_ref(g_xmdc_d[l_ac].xmdcunit) RETURNING g_xmdc_d[l_ac].xmdcunit_desc
                  DISPLAY BY NAME g_xmdc_d[l_ac].xmdcunit_desc
                  NEXT FIELD CURRENT
               END IF
               
               LET g_xmdc_d[l_ac].xmdcorga = g_xmdc_d[l_ac].xmdcunit
               CALL adbt500_xmda003_ref(g_xmdc_d[l_ac].xmdcorga) RETURNING g_xmdc_d[l_ac].xmdcorga_desc
               DISPLAY BY NAME g_xmdc_d[l_ac].xmdcorga_desc
           
            ELSE
               LET g_xmdc_d[l_ac].xmdcunit = g_site
               CALL adbt500_xmda003_ref(g_xmdc_d[l_ac].xmdcunit) RETURNING g_xmdc_d[l_ac].xmdcunit_desc
               DISPLAY BY NAME g_xmdc_d[l_ac].xmdcunit_desc     
            END IF 
]]>
  </point>
  <point name="input.a.page1.xmja002" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xmja_d[l_ac].xmja002) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist_and_ref_val("v_imay003_1") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 
               ELSE
                  #檢查失敗時後續處理
                  NEXT FIELD CURRENT
               END IF
            

            END IF 

]]>
  </point>
  <point name="input.a.page1.xmja003" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xmja_d[l_ac].xmja003) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg2 = '參數2'
                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist_and_ref_val("v_imaf001_3") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 
               ELSE
                  #檢查失敗時後續處理
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmja_d[l_ac].xmja003
            CALL ap_ref_array2(g_ref_fields,"SELECT imaal003 FROM imaal_t WHERE imaalent='"||g_enterprise||"' AND imaal001=? AND imaal002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmja_d[l_ac].xmja003_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmja_d[l_ac].xmja003_desc

]]>
  </point>
  <point name="input.a.page1.xmja005" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xmja_d[l_ac].xmja005) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist_and_ref_val("v_prcf001") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 
               ELSE
                  #檢查失敗時後續處理
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmja_d[l_ac].xmja005
            CALL ap_ref_array2(g_ref_fields,"SELECT prcfl003 FROM prcfl_t WHERE prcflent='"||g_enterprise||"' AND prcfl001=? AND prcfl002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmja_d[l_ac].xmja005_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmja_d[l_ac].xmja005_desc

]]>
  </point>
  <point name="input.a.page1.xmja006" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xmja_d[l_ac].xmja006) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg2 = '參數2'
                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist_and_ref_val("v_oodb002") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 
               ELSE
                  #檢查失敗時後續處理
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmja_d[l_ac].xmja006
            CALL ap_ref_array2(g_ref_fields,"SELECT oodbl004 FROM oodbl_t WHERE oodblent='"||g_enterprise||"' AND oodbl002=? AND oodbl003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmja_d[l_ac].xmja006_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmja_d[l_ac].xmja006_desc

]]>
  </point>
  <point name="input.a.page1.xmja008" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xmja_d[l_ac].xmja008) THEN 
            END IF 

]]>
  </point>
  <point name="input.a.page1.xmja009" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xmja_d[l_ac].xmja009) THEN 
            END IF 

]]>
  </point>
  <point name="input.a.page1.xmja010" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xmja_d[l_ac].xmja010) THEN 
            END IF 

]]>
  </point>
  <point name="input.a.page1.xmja011" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xmja_d[l_ac].xmja011) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg2 = '參數2'
                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist_and_ref_val("v_imao002") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 
               ELSE
                  #檢查失敗時後續處理
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmja_d[l_ac].xmja011
            CALL ap_ref_array2(g_ref_fields,"SELECT oocal003 FROM oocal_t WHERE oocalent='"||g_enterprise||"' AND oocal001=? AND oocal002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmja_d[l_ac].xmja011_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmja_d[l_ac].xmja011_desc

]]>
  </point>
  <point name="input.a.page1.xmja013" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xmja_d[l_ac].xmja013) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg2 = '參數2'
                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist_and_ref_val("v_imao002") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 
               ELSE
                  #檢查失敗時後續處理
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmja_d[l_ac].xmja013
            CALL ap_ref_array2(g_ref_fields,"SELECT oocal003 FROM oocal_t WHERE oocalent='"||g_enterprise||"' AND oocal001=? AND oocal002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmja_d[l_ac].xmja013_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmja_d[l_ac].xmja013_desc

]]>
  </point>
  <point name="input.a.page1.xmja014" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xmja_d[l_ac].xmja014) THEN 
            END IF 

]]>
  </point>
  <point name="input.a.page1.xmja015" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xmja_d[l_ac].xmja015) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg2 = '參數2'
                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist_and_ref_val("v_imao002") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 
               ELSE
                  #檢查失敗時後續處理
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmja_d[l_ac].xmja015
            CALL ap_ref_array2(g_ref_fields,"SELECT oocal003 FROM oocal_t WHERE oocalent='"||g_enterprise||"' AND oocal001=? AND oocal002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmja_d[l_ac].xmja015_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmja_d[l_ac].xmja015_desc

]]>
  </point>
  <point name="input.a.page1.xmja016" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xmja_d[l_ac].xmja016) THEN 
            END IF 

]]>
  </point>
  <point name="input.a.page1.xmja017" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xmja_d[l_ac].xmja017) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist_and_ref_val("v_ooca001") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 
               ELSE
                  #檢查失敗時後續處理
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmja_d[l_ac].xmja017
            CALL ap_ref_array2(g_ref_fields,"SELECT oocal003 FROM oocal_t WHERE oocalent='"||g_enterprise||"' AND oocal001=? AND oocal002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmja_d[l_ac].xmja017_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmja_d[l_ac].xmja017_desc

]]>
  </point>
  <point name="input.a.page1.xmja018" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xmja_d[l_ac].xmja018) THEN 
            END IF 

]]>
  </point>
  <point name="input.a.page1.xmja024" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xmja_d[l_ac].xmja024) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist_and_ref_val("v_pmaa001_14") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 
               ELSE
                  #檢查失敗時後續處理
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmja_d[l_ac].xmja024
            CALL ap_ref_array2(g_ref_fields,"SELECT pmaal004 FROM pmaal_t WHERE pmaalent='"||g_enterprise||"' AND pmaal001=? AND pmaal002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmja_d[l_ac].xmja024_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmja_d[l_ac].xmja024_desc

]]>
  </point>
  <point name="input.a.page1.xmja026" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xmja_d[l_ac].xmja026) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg2 = '參數2'
                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist_and_ref_val("v_oofb019_1") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 
               ELSE
                  #檢查失敗時後續處理
                  NEXT FIELD CURRENT
               END IF
            

            END IF 

]]>
  </point>
  <point name="input.a.page1.xmja033" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xmja_d[l_ac].xmja033) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg2 = '參數2'
                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist_and_ref_val("v_pmao004_3") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 
               ELSE
                  #檢查失敗時後續處理
                  NEXT FIELD CURRENT
               END IF
            

            END IF 

]]>
  </point>
  <point name="input.a.page1.xmjaseq" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xmda_m.xmdadocno IS NOT NULL AND g_xmja_d[g_detail_idx].xmjaseq IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmda_m.xmdadocno != g_xmdadocno_t OR g_xmja_d[g_detail_idx].xmjaseq != g_xmja_d_t.xmjaseq)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xmja_t WHERE "||"xmjaent = '" ||g_enterprise|| "' AND "||"xmjadocno = '"||g_xmda_m.xmdadocno ||"' AND "|| "xmjaseq = '"||g_xmja_d[g_detail_idx].xmjaseq ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page2.xmdc003" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            CALL adbt500_xmdc003_ref(g_xmdc2_d[l_ac].xmdc003) RETURNING  g_xmdc2_d[l_ac].xmdc003_desc         
            DISPLAY BY NAME g_xmdc2_d[l_ac].xmdc003_desc
]]>
  </point>
  <point name="input.a.page2.xmdc025" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[
            IF NOT cl_null(g_xmdc2_d[l_ac].xmdc025) THEN 

            END IF               ]]>
  </point>
  <point name="input.a.page2.xmdc026" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xmdc2_d[l_ac].xmdc026) THEN 
 
             END IF]]>
  </point>
  <point name="input.a.page2.xmdc0272" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.a.page2.xmdc028" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                    CALL adbt500_xmdc028_ref(g_xmdc2_d[l_ac].xmdc028) RETURNING g_xmdc2_d[l_ac].xmdc028_desc
            DISPLAY BY NAME g_xmdc2_d[l_ac].xmdc028_desc
            IF NOT cl_null(g_xmdc2_d[l_ac].xmdc028) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_site
               LET g_chkparam.arg2 = g_xmdc2_d[l_ac].xmdc028
                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_inaa001_1") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 

               ELSE
                  #檢查失敗時後續處理
                  LET g_xmdc2_d[l_ac].xmdc028 = g_xmdc2_d_t.xmdc028
                  CALL adbt500_xmdc028_ref(g_xmdc2_d[l_ac].xmdc028) RETURNING g_xmdc2_d[l_ac].xmdc028_desc
                  DISPLAY BY NAME g_xmdc2_d[l_ac].xmdc028_desc                  
                  NEXT FIELD CURRENT
               END IF
               IF NOT adbt500_xmdc029_chk() THEN
                  LET g_xmdc2_d[l_ac].xmdc028 = g_xmdc2_d_t.xmdc028
                  CALL adbt500_xmdc028_ref(g_xmdc2_d[l_ac].xmdc028) RETURNING g_xmdc2_d[l_ac].xmdc028_desc
                  DISPLAY BY NAME g_xmdc2_d[l_ac].xmdc028_desc
                  NEXT FIELD CURRENT
               END IF            

            END IF 
]]>
  </point>
  <point name="input.a.page2.xmdc029" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                    CALL adbt500_xmdc029_ref(g_xmdc2_d[l_ac].xmdc028,g_xmdc2_d[l_ac].xmdc029) RETURNING g_xmdc2_d[l_ac].xmdc029_desc
            DISPLAY BY NAME g_xmdc2_d[l_ac].xmdc029_desc
            IF NOT cl_null(g_xmdc2_d[l_ac].xmdc029) THEN
               IF NOT adbt500_xmdc029_chk() THEN
                  LET g_xmdc2_d[l_ac].xmdc029 = g_xmdc2_d_t.xmdc029
                  CALL adbt500_xmdc029_ref(g_xmdc2_d[l_ac].xmdc028,g_xmdc2_d[l_ac].xmdc029) RETURNING g_xmdc2_d[l_ac].xmdc029_desc
                  DISPLAY BY NAME g_xmdc2_d[l_ac].xmdc029_desc
                  NEXT FIELD CURRENT
               END IF

            END IF
]]>
  </point>
  <point name="input.a.page2.xmdc030" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            LET l_imaf062 = ''
            SELECT imaf062 INTO l_imaf062 FROM imaf_t 
             WHERE imafent = g_enterprise 
               AND imafsite = g_site 
               AND imaf001 = l_xmdc001
            
            #判斷[T:料件據點進銷存檔].[C:批號自動編碼]是否有勾選，若勾選自動編碼時需,呼叫命名規則產生的應用元件產生批號
            IF l_imaf062 = 'Y' THEN
            END IF
            #若輸入的料件+批號不存在[T:料件批號資料檔]時，則呼叫應用元件新增料件批號基本資料                                                                        ]]>
  </point>
  <point name="input.a.page2.xmdc031" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            CALL adbt500_xmda020_ref(g_xmdc2_d[l_ac].xmdc031) RETURNING g_xmdc2_d[l_ac].xmdc031_desc
            DISPLAY BY NAME g_xmdc2_d[l_ac].xmdc031_desc
            IF NOT cl_null(g_xmdc2_d[l_ac].xmdc031) THEN 
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmdc2_d[l_ac].xmdc031

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_oocq002_263") THEN
                  #檢查成功時後續處理
                  #呼叫地址組合應用元件，將組合好的聯絡地址顯示在下方

               ELSE
                  #檢查失敗時後續處理
                  LET g_xmdc2_d[l_ac].xmdc031 = g_xmdc2_d_t.xmdc031
                  CALL adbt500_xmda020_ref(g_xmdc2_d[l_ac].xmdc031) RETURNING g_xmdc2_d[l_ac].xmdc031_desc
                  DISPLAY BY NAME g_xmdc2_d[l_ac].xmdc031_desc
                  NEXT FIELD CURRENT
               END IF
            END IF                                                                       ]]>
  </point>
  <point name="input.a.page2.xmdc032" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.a.page2.xmdc033" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                    IF NOT cl_null(g_xmdc2_d[l_ac].xmdc033) THEN 
            END IF 
]]>
  </point>
  <point name="input.a.page2.xmdc034" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                    IF NOT cl_null(g_xmdc2_d[l_ac].xmdc034) THEN 
            END IF 
]]>
  </point>
  <point name="input.a.page2.xmdc036" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.a.page2.xmdc037" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.a.page2.xmdc038" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.a.page2.xmdc039" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.a.page2.xmdcseq" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xmda_m.xmdadocno IS NOT NULL AND g_xmja2_d[g_detail_idx].xmdcseq IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmda_m.xmdadocno != g_xmdadocno_t OR g_xmja2_d[g_detail_idx].xmdcseq != g_xmja2_d_t.xmdcseq)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xmdc_t WHERE "||"xmdcent = '" ||g_enterprise|| "' AND "||"xmdcdocno = '"||g_xmda_m.xmdadocno ||"' AND "|| "xmdcseq = '"||g_xmja2_d[g_detail_idx].xmdcseq ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page2.xmdcseq_2" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xmda_m.xmdadocno IS NOT NULL AND g_xmdc2_d[g_detail_idx].xmdcseq IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmda_m.xmdadocno != g_xmdadocno_t OR g_xmdc2_d[g_detail_idx].xmdcseq != g_xmdc2_d_t.xmdcseq)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xmdc_t WHERE "||"xmdcent = '" ||g_enterprise|| "' AND "||"xmdcdocno = '"||g_xmda_m.xmdadocno ||"' AND "|| "xmdcseq = '"||g_xmdc2_d[g_detail_idx].xmdcseq ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page3.xmdc012" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.a.page3.xmdc013" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.a.page3.xmdd001" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xmdc3_d[l_ac].xmdd001) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmdc3_d[l_ac].xmdd001

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_imaa001_5") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 

               ELSE
                  #檢查失敗時後續處理
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
]]>
  </point>
  <point name="input.a.page3.xmdd004" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xmdc3_d[l_ac].xmdd004) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmdc3_d[l_ac].xmdd004

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_ooca001") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 

               ELSE
                  #檢查失敗時後續處理
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
]]>
  </point>
  <point name="input.a.page3.xmdd017" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xmdc3_d[l_ac].xmdd017) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_site
               LET g_chkparam.arg2 = g_xmdc3_d[l_ac].xmdd017 
                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_oodb002") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 

               ELSE
                  #檢查失敗時後續處理
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
]]>
  </point>
  <point name="input.a.page3.xmdd022" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xmdc3_d[l_ac].xmdd022) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmdc3_d[l_ac].xmdd022

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_ooag001") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 

               ELSE
                  #檢查失敗時後續處理
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
]]>
  </point>
  <point name="input.a.page3.xmdd024" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xmdc3_d[l_ac].xmdd024) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmdc3_d[l_ac].xmdd024

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_ooca001") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 

               ELSE
                  #檢查失敗時後續處理
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
]]>
  </point>
  <point name="input.a.page3.xmdd025" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xmdc3_d[l_ac].xmdd025) THEN 
            END IF 
]]>
  </point>
  <point name="input.a.page3.xmdd026" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xmdc3_d[l_ac].xmdd026) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmdc3_d[l_ac].xmdd026

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_ooca001") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 

               ELSE
                  #檢查失敗時後續處理
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
]]>
  </point>
  <point name="input.a.page3.xmdd027" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xmdc3_d[l_ac].xmdd027) THEN 
            END IF 
]]>
  </point>
  <point name="input.a.page3.xmddseq" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xmda_m.xmdadocno IS NOT NULL AND g_xmdc3_d[g_detail_idx].xmddseq IS NOT NULL AND g_xmdc3_d[g_detail_idx].xmddseq1 IS NOT NULL AND g_xmdc3_d[g_detail_idx].xmddseq2 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmda_m.xmdadocno != g_xmdadocno_t OR g_xmdc3_d[g_detail_idx].xmddseq != g_xmdc3_d_t.xmddseq OR g_xmdc3_d[g_detail_idx].xmddseq1 != g_xmdc3_d_t.xmddseq1 OR g_xmdc3_d[g_detail_idx].xmddseq2 != g_xmdc3_d_t.xmddseq2)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xmdd_t WHERE "||"xmddent = '" ||g_enterprise|| "' AND "||"xmdddocno = '"||g_xmda_m.xmdadocno ||"' AND "|| "xmddseq = '"||g_xmdc3_d[g_detail_idx].xmddseq ||"' AND "|| "xmddseq1 = '"||g_xmdc3_d[g_detail_idx].xmddseq1 ||"' AND "|| "xmddseq2 = '"||g_xmdc3_d[g_detail_idx].xmddseq2 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page3.xmddseq1" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xmda_m.xmdadocno IS NOT NULL AND g_xmdc3_d[g_detail_idx].xmddseq IS NOT NULL AND g_xmdc3_d[g_detail_idx].xmddseq1 IS NOT NULL AND g_xmdc3_d[g_detail_idx].xmddseq2 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmda_m.xmdadocno != g_xmdadocno_t OR g_xmdc3_d[g_detail_idx].xmddseq != g_xmdc3_d_t.xmddseq OR g_xmdc3_d[g_detail_idx].xmddseq1 != g_xmdc3_d_t.xmddseq1 OR g_xmdc3_d[g_detail_idx].xmddseq2 != g_xmdc3_d_t.xmddseq2)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xmdd_t WHERE "||"xmddent = '" ||g_enterprise|| "' AND "||"xmdddocno = '"||g_xmda_m.xmdadocno ||"' AND "|| "xmddseq = '"||g_xmdc3_d[g_detail_idx].xmddseq ||"' AND "|| "xmddseq1 = '"||g_xmdc3_d[g_detail_idx].xmddseq1 ||"' AND "|| "xmddseq2 = '"||g_xmdc3_d[g_detail_idx].xmddseq2 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page3.xmddseq2" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xmda_m.xmdadocno IS NOT NULL AND g_xmdc3_d[g_detail_idx].xmddseq IS NOT NULL AND g_xmdc3_d[g_detail_idx].xmddseq1 IS NOT NULL AND g_xmdc3_d[g_detail_idx].xmddseq2 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmda_m.xmdadocno != g_xmdadocno_t OR g_xmdc3_d[g_detail_idx].xmddseq != g_xmdc3_d_t.xmddseq OR g_xmdc3_d[g_detail_idx].xmddseq1 != g_xmdc3_d_t.xmddseq1 OR g_xmdc3_d[g_detail_idx].xmddseq2 != g_xmdc3_d_t.xmddseq2)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xmdd_t WHERE "||"xmddent = '" ||g_enterprise|| "' AND "||"xmdddocno = '"||g_xmda_m.xmdadocno ||"' AND "|| "xmddseq = '"||g_xmdc3_d[g_detail_idx].xmddseq ||"' AND "|| "xmddseq1 = '"||g_xmdc3_d[g_detail_idx].xmddseq1 ||"' AND "|| "xmddseq2 = '"||g_xmdc3_d[g_detail_idx].xmddseq2 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page4.xmdc027" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xmja4_d[l_ac].xmdc027) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist_and_ref_val("v_pmao004_1") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 
               ELSE
                  #檢查失敗時後續處理
                  NEXT FIELD CURRENT
               END IF
            

            END IF 

]]>
  </point>
  <point name="input.a.page4.xmdcseq_4" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xmda_m.xmdadocno IS NOT NULL AND g_xmja4_d[g_detail_idx].xmdcseq IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmda_m.xmdadocno != g_xmdadocno_t OR g_xmja4_d[g_detail_idx].xmdcseq != g_xmja4_d_t.xmdcseq)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xmdc_t WHERE "||"xmdcent = '" ||g_enterprise|| "' AND "||"xmdcdocno = '"||g_xmda_m.xmdadocno ||"' AND "|| "xmdcseq = '"||g_xmja4_d[g_detail_idx].xmdcseq ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page4.xmde001" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xmdc4_d[l_ac].xmde001) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmdc4_d[l_ac].xmde001

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist_and_ref_val("v_imaa001_5") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 

               ELSE
                  #檢查失敗時後續處理
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
]]>
  </point>
  <point name="input.a.page4.xmde008" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xmdc4_d[l_ac].xmde008) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmdc4_d[l_ac].xmde008

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist_and_ref_val("v_oocq002_221") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 

               ELSE
                  #檢查失敗時後續處理
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
]]>
  </point>
  <point name="input.a.page4.xmde022" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xmdc4_d[l_ac].xmde022) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmdc4_d[l_ac].xmde022

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist_and_ref_val("v_ooca001") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 

               ELSE
                  #檢查失敗時後續處理
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
]]>
  </point>
  <point name="input.a.page4.xmdeseq" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xmda_m.xmdadocno IS NOT NULL AND g_xmdc4_d[g_detail_idx].xmdeseq IS NOT NULL AND g_xmdc4_d[g_detail_idx].xmdeseq1 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmda_m.xmdadocno != g_xmdadocno_t OR g_xmdc4_d[g_detail_idx].xmdeseq != g_xmdc4_d_t.xmdeseq OR g_xmdc4_d[g_detail_idx].xmdeseq1 != g_xmdc4_d_t.xmdeseq1)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xmde_t WHERE "||"xmdeent = '" ||g_enterprise|| "' AND "||"xmdedocno = '"||g_xmda_m.xmdadocno ||"' AND "|| "xmdeseq = '"||g_xmdc4_d[g_detail_idx].xmdeseq ||"' AND "|| "xmdeseq1 = '"||g_xmdc4_d[g_detail_idx].xmdeseq1 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page4.xmdeseq1" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xmda_m.xmdadocno IS NOT NULL AND g_xmdc4_d[g_detail_idx].xmdeseq IS NOT NULL AND g_xmdc4_d[g_detail_idx].xmdeseq1 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmda_m.xmdadocno != g_xmdadocno_t OR g_xmdc4_d[g_detail_idx].xmdeseq != g_xmdc4_d_t.xmdeseq OR g_xmdc4_d[g_detail_idx].xmdeseq1 != g_xmdc4_d_t.xmdeseq1)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xmde_t WHERE "||"xmdeent = '" ||g_enterprise|| "' AND "||"xmdedocno = '"||g_xmda_m.xmdadocno ||"' AND "|| "xmdeseq = '"||g_xmdc4_d[g_detail_idx].xmdeseq ||"' AND "|| "xmdeseq1 = '"||g_xmdc4_d[g_detail_idx].xmdeseq1 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page4.xmja002" order="" ver="3" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xmdc4_d[l_ac].xmja002) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmdc4_d[l_ac].xmja002
                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_imay003_1") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 
               ELSE
                  #檢查失敗時後續處理
                  LET g_xmdc4_d[l_ac].xmja002 = g_xmdc4_d_t.xmja002
                  NEXT FIELD CURRENT
               END IF
               SELECT imay001,imay004
                 INTO g_xmdc4_d[l_ac].xmja003,g_xmdc4_d[l_ac].xmja011
                 FROM imay_t
                WHERE imayent = g_enterprise
                  AND imay003 = g_xmdc4_d[l_ac].xmja002
               IF NOT cl_null(g_xmdc4_d[l_ac].xmja003) THEN
                  INITIALIZE g_chkparam.* TO NULL
                  #設定g_chkparam.*的參數
                  LET g_chkparam.arg1 = g_xmda_m.xmdasite
                  LET g_chkparam.arg2 = g_xmdc4_d[l_ac].xmja003
                  #呼叫檢查存在並帶值的library
                  IF cl_chk_exist("v_imaf001_3") THEN
                     #檢查成功時後續處理   
                     CALL adbt500_xmja003_default()                        
                  ELSE                  
                     LET g_xmdc4_d[l_ac].xmja011 = g_xmdc4_d_t.xmja011          
                     #檢查失敗時後續處理
                     NEXT FIELD CURRENT
                  END IF
                  
               END IF
               IF cl_null(g_xmdc4_d_t.xmja003) OR g_xmdc4_d[l_ac].xmja003 <> g_xmdc4_d_t.xmja003 THEN
                  CALL adbt500_get_price()
               END IF
               CALL adbt500_xmja003_ref()
               CALL adbt500_xmja011_ref() 
            END IF 
            CALL adbt500_set_entry_b(l_cmd)
            CALL adbt500_set_no_required_b()
            CALL adbt500_set_required_b()
            CALL adbt500_set_no_entry_b(l_cmd)]]>
  </point>
  <point name="input.a.page4.xmja003" order="" ver="3" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xmdc4_d[l_ac].xmja003) THEN 
               #此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmda_m.xmdasite
               LET g_chkparam.arg2 = g_xmdc4_d[l_ac].xmja003
                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_imaf001_3") THEN
                  #檢查成功時後續處理
                  CALL adbt500_xmja003_default() 
               ELSE
                  #檢查失敗時後續處理
                  LET g_xmdc4_d[l_ac].xmja003 = g_xmdc4_d_t.xmja003
                  CALL adbt500_xmja003_ref()
                  NEXT FIELD CURRENT
               END IF
               IF cl_null(g_xmdc4_d[l_ac].xmja002) THEN
                  SELECT imaa143
                    INTO l_imaa143
                    FROM imaa_t
                   WHERE imaaent = g_enterprise
                     AND imaa001 = g_xmdc4_d[l_ac].xmja003
                     
                  LET l_cnt = 0   
                  SELECT COUNT(*)
                    INTO l_cnt
                    FROM dbbc_t
                   WHERE dbbc002 = g_xmda_m.xmdasite
                     AND dbbc005 = g_xmda_m.xmda202
                     AND dbbc003 = g_xmda_m.xmda023
                     AND dbbc004 = l_imaa143
                  IF l_cnt = 0 THEN
                     CALL cl_err("",'adb-00051',1)
                     NEXT FIELD CURRENT
                  END IF
               END IF
               IF cl_null(g_xmdc4_d_t.xmja003) OR g_xmdc4_d[l_ac].xmja003 <> g_xmdc4_d_t.xmja003 THEN
                  CALL adbt500_get_price()
               END IF
            END IF 
            CALL adbt500_xmja003_ref()
            CALL adbt500_set_entry_b(l_cmd)
            CALL adbt500_set_no_required_b()
            CALL adbt500_set_required_b()
            CALL adbt500_set_no_entry_b(l_cmd)]]>
  </point>
  <point name="input.a.page4.xmja005" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xmdc4_d[l_ac].xmja005) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmdc4_d[l_ac].xmja005
                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_prcf001") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 
               ELSE
                  #檢查失敗時後續處理
                  LET g_xmdc4_d[l_ac].xmja005 = g_xmdc4_d_t.xmja005
                  CALL adbt500_xmja005_ref()
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
            CALL adbt500_xmja005_ref()

]]>
  </point>
  <point name="input.a.page4.xmja006" order="" ver="3" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xmdc4_d[l_ac].xmja006) THEN 
               #此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmda_m.xmdasite
               LET g_chkparam.arg2 = g_xmdc4_d[l_ac].xmja006
                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_oodb002") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 
               ELSE
                  #檢查失敗時後續處理
                  LET g_xmdc4_d[l_ac].xmja006 = g_xmdc4_d_t.xmja006
                  CALL adbt500_xmja006_ref()
                  NEXT FIELD CURRENT
               END IF
               

            END IF             
             
            CALL adbt500_xmja006_ref()
            IF cl_null(g_xmdc4_d_t.xmja006) OR g_xmdc4_d[l_ac].xmja006 <> g_xmdc4_d_t.xmja006 THEN
               CALL adbt500_get_price()
               CALL adbt500_regen_amounts()
            END IF
]]>
  </point>
  <point name="input.a.page4.xmja008" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xmdc4_d[l_ac].xmja008) THEN 
            END IF 

]]>
  </point>
  <point name="input.a.page4.xmja009" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xmdc4_d[l_ac].xmja009) THEN 
            END IF 

]]>
  </point>
  <point name="input.a.page4.xmja010" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xmdc4_d[l_ac].xmja010) THEN 
               IF cl_null(g_xmdc4_d_t.xmja010) OR g_xmdc4_d[l_ac].xmja010 <> g_xmdc4_d_t.xmja010 THEN
                  CALL adbt500_regen_amounts()
                  CALL adbt500_get_xmja022()
               END IF
            END IF 

]]>
  </point>
  <point name="input.a.page4.xmja011" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xmdc4_d[l_ac].xmja011) THEN 
               #此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmdc4_d[l_ac].xmja003
               LET g_chkparam.arg2 = g_xmdc4_d[l_ac].xmja011
                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_imao002") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 
               ELSE
                  #檢查失敗時後續處理
                  LET g_xmdc4_d[l_ac].xmja011 = g_xmdc4_d_t.xmja011
                  CALL adbt500_xmja011_ref()
                  NEXT FIELD CURRENT
               END IF
           
            END IF  
            
            CALL adbt500_xmja011_ref()
            CALL adbt500_xmja012_convert()
]]>
  </point>
  <point name="input.a.page4.xmja012" order="" ver="3" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xmdc4_d[l_ac].xmja012) THEN
               #CALL s_adbt540_unit_round(g_xmdc4_d[l_ac].xmja011,g_xmdc4_d[l_ac].xmja012) RETURNING g_xmdc4_d[l_ac].xmja012
               CALL s_aooi250_take_decimals(g_xmdc4_d[l_ac].xmja011,g_xmdc4_d[l_ac].xmja012) RETURNING l_success,g_xmdc4_d[l_ac].xmja012
               CALL adbt500_xmja012_convert()
               CALL adbt500_get_price()
            END IF]]>
  </point>
  <point name="input.a.page4.xmja013" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xmdc4_d[l_ac].xmja013) THEN 
               #此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmdc4_d[l_ac].xmja003
               LET g_chkparam.arg2 = g_xmdc4_d[l_ac].xmja013
                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_imao002") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 
               ELSE
                  #檢查失敗時後續處理
                  LET g_xmdc4_d[l_ac].xmja013 = g_xmdc4_d_t.xmja013
                  CALL adbt500_xmja013_ref()
                  NEXT FIELD CURRENT
               END IF
           
            END IF  
            
            CALL adbt500_xmja013_ref()
            CALL adbt500_xmja012_convert()
]]>
  </point>
  <point name="input.a.page4.xmja014" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xmdc4_d[l_ac].xmja014) THEN 
            END IF 

]]>
  </point>
  <point name="input.a.page4.xmja015" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xmdc4_d[l_ac].xmja015) THEN 
               #此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmdc4_d[l_ac].xmja003
               LET g_chkparam.arg2 = g_xmdc4_d[l_ac].xmja015
                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_imao002") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 
               ELSE
                  #檢查失敗時後續處理
                  LET g_xmdc4_d[l_ac].xmja015 = g_xmdc4_d_t.xmja015
                  CALL adbt500_xmja015_ref()
                  NEXT FIELD CURRENT
               END IF
           
            END IF  
            
            CALL adbt500_xmja015_ref()
            CALL adbt500_xmja012_convert()

]]>
  </point>
  <point name="input.a.page4.xmja016" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xmdc4_d[l_ac].xmja016) THEN 
               #CALL s_adbt540_unit_round(g_xmdc4_d[l_ac].xmja015,g_xmdc4_d[l_ac].xmja016) RETURNING g_xmdc4_d[l_ac].xmja016
               CALL s_aooi250_take_decimals(g_xmdc4_d[l_ac].xmja015,g_xmdc4_d[l_ac].xmja016) RETURNING l_success,g_xmdc4_d[l_ac].xmja016
            END IF 
]]>
  </point>
  <point name="input.a.page4.xmja017" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xmdc4_d[l_ac].xmja017) THEN 
               #此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmdc4_d[l_ac].xmja017
                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_ooca001") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 
               ELSE
                  #檢查失敗時後續處理
                  LET g_xmdc4_d[l_ac].xmja017 = g_xmdc4_d_t.xmja017
                  CALL adbt500_xmja017_ref()
                  NEXT FIELD CURRENT
               END IF

               #CALL s_adbt540_unit_round(g_xmdc4_d[l_ac].xmja017,g_xmdc4_d[l_ac].xmja018) RETURNING g_xmdc4_d[l_ac].xmja018
               CALL s_aooi250_take_decimals(g_xmdc4_d[l_ac].xmja017,g_xmdc4_d[l_ac].xmja018) RETURNING l_success,g_xmdc4_d[l_ac].xmja018
            END IF  
            
            CALL adbt500_xmja017_ref()
            CALL adbt500_xmja012_convert()

]]>
  </point>
  <point name="input.a.page4.xmja018" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xmdc4_d[l_ac].xmja018) THEN 
               #CALL s_adbt540_unit_round(g_xmdc4_d[l_ac].xmja017,g_xmdc4_d[l_ac].xmja018) RETURNING g_xmdc4_d[l_ac].xmja018
               CALL s_aooi250_take_decimals(g_xmdc4_d[l_ac].xmja017,g_xmdc4_d[l_ac].xmja018) RETURNING l_success,g_xmdc4_d[l_ac].xmja018
               IF cl_null(g_xmdc4_d_t.xmja018) OR g_xmdc4_d[l_ac].xmja018 <> g_xmdc4_d_t.xmja018 THEN
                  CALL adbt500_regen_amounts()
                  CALL adbt500_get_xmja022()
               END IF
            END IF 

]]>
  </point>
  <point name="input.a.page4.xmja024" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xmdc4_d[l_ac].xmja024) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmdc4_d[l_ac].xmja024
                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_pmaa001_14") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 
               ELSE
                  #檢查失敗時後續處理
                  LET g_xmdc4_d[l_ac].xmja024 = g_xmdc4_d_t.xmja024
                  CALL adbt500_xmja024_ref()
                  NEXT FIELD CURRENT
               END IF
               
               CALL adbt500_xmja024_desc()

            END IF 
            LET g_xmdc4_d[l_ac].xmja025 = g_xmdc4_d[l_ac].xmja024
            CALL adbt500_xmja024_ref()

]]>
  </point>
  <point name="input.a.page4.xmja026" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xmdc4_d[l_ac].xmja026) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               CALL adbt500_get_pmaa027(g_xmdc4_d[l_ac].xmja025) RETURNING l_pmaa027_1
               LET g_chkparam.arg1 = l_pmaa027_1
               LET g_chkparam.arg2 = g_xmdc4_d[l_ac].xmja026
                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_oofb019_1") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 
               ELSE
                  #檢查失敗時後續處理
                  LET g_xmdc4_d[l_ac].xmja026 = g_xmdc4_d_t.xmja026
                  CALL adbt500_xmja026_ref()
                  NEXT FIELD CURRENT
               END IF
               CALL adbt500_get_pmaa027(g_xmdc4_d[l_ac].xmja025) RETURNING l_pmaa027   
               SELECT oofb022 INTO g_xmdc4_d[l_ac].xmja027 FROM oofb_t
                WHERE oofb002 = l_pmaa027 AND oofb008 = '3' 
                  AND oofbstus = 'Y' 
                  AND oofb019 = g_xmdc4_d[l_ac].xmja026
                  AND rownum = 1 
            ELSE
               LET g_xmdc4_d[l_ac].xmja027 = NULL
            END IF 
            CALL adbt500_xmja026_ref()
            CALL adbt500_xmja027_ref()
]]>
  </point>
  <point name="input.a.page4.xmja027" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xmdc4_d[l_ac].xmja027) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmdc4_d[l_ac].xmja027
                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist_and_ref_val("v_dbad001") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 
               ELSE
                  #檢查失敗時後續處理
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
            
            CALL adbt500_xmja027_ref()

]]>
  </point>
  <point name="input.a.page4.xmja030" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            IF g_xmdc4_d[l_ac].xmja030= 'Y' THEN
               CALL adbt500_03(g_xmda_m.xmdadocno,g_xmdc4_d[l_ac].xmjaseq,g_xmdc4_d[l_ac].xmja018,g_xmdc4_d[l_ac].xmja030,g_xmdc4_d[l_ac].xmjasite)
               RETURNING g_xmdc4_d[l_ac].xmja031,g_xmdc4_d[l_ac].xmja032
               DISPLAY BY NAME g_xmdc4_d[l_ac].xmja031,g_xmdc4_d[l_ac].xmja032
            ELSE
               #從多交期改成非多交期需清空多交期資料
               IF g_xmdc4_d_t.xmja030 = 'Y' THEN
                  DELETE FROM xmdf_t
                   WHERE xmdfent = g_enterprise
                     AND xmdfdocno = g_xmda_m.xmdadocno
                     AND xmdfseq = g_xmdc4_d[l_ac].xmjaseq
               END IF
            END IF

            CALL adbt500_set_entry_b(l_cmd)
            CALL adbt500_set_no_entry_b(l_cmd)
]]>
  </point>
  <point name="input.a.page4.xmja031" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            IF g_xmdc4_d[l_ac].xmja031 > g_xmdc4_d[l_ac].xmja032 THEN
               CALL cl_err('','adb-00079',0)
               NEXT FIELD  xmja031
            END IF ]]>
  </point>
  <point name="input.a.page4.xmja032" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            IF g_xmdc4_d[l_ac].xmja032 < g_xmdc4_d[l_ac].xmja031 THEN
               CALL cl_err('','adb-00079',0)
               NEXT FIELD  xmja032
            END IF  ]]>
  </point>
  <point name="input.a.page4.xmja033" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xmdc4_d[l_ac].xmja033) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmda_m.xmda004
               LET g_chkparam.arg2 = g_xmdc4_d[l_ac].xmja033
                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_pmao004_3") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 
               ELSE
                  #檢查失敗時後續處理
                  LET g_xmdc4_d[l_ac].xmja033 = g_xmdc4_d_t.xmja033
                  CALL adbt500_xmja003_ref()
                  NEXT FIELD CURRENT
               END IF
            

            END IF 

]]>
  </point>
  <point name="input.a.page4.xmjadocno" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xmda_m.xmdadocno IS NOT NULL AND g_xmdc4_d[g_detail_idx].xmjadocno IS NOT NULL AND g_xmdc4_d[g_detail_idx].xmjaseq IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmda_m.xmdadocno != g_xmdadocno_t OR g_xmdc4_d[g_detail_idx].xmjadocno != g_xmdc4_d_t.xmjadocno OR g_xmdc4_d[g_detail_idx].xmjaseq != g_xmdc4_d_t.xmjaseq)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xmja_t WHERE "||"xmjaent = '" ||g_enterprise|| "' AND "||"xmjadocno = '"||g_xmda_m.xmdadocno ||"' AND "|| "xmjaseq = '"||g_xmdc4_d[g_detail_idx].xmjadocno ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page4.xmjaseq" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xmda_m.xmdadocno IS NOT NULL AND g_xmdc4_d[g_detail_idx].xmjaseq IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmda_m.xmdadocno != g_xmdadocno_t OR g_xmdc4_d[g_detail_idx].xmjaseq != g_xmdc4_d_t.xmjaseq)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xmja_t WHERE "||"xmjaent = '" ||g_enterprise|| "' AND "||"xmjadocno = '"||g_xmda_m.xmdadocno ||"' AND "|| "xmjaseq = '"||g_xmdc4_d[g_detail_idx].xmjaseq ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page4.xmjaseq_4" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xmda_m.xmdadocno IS NOT NULL AND g_xmja4_d[g_detail_idx].xmjaseq IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmda_m.xmdadocno != g_xmdadocno_t OR g_xmja4_d[g_detail_idx].xmjaseq != g_xmja4_d_t.xmjaseq)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xmja_t WHERE "||"xmjaent = '" ||g_enterprise|| "' AND "||"xmjadocno = '"||g_xmda_m.xmdadocno ||"' AND "|| "xmjaseq = '"||g_xmja4_d[g_detail_idx].xmjaseq ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page4.xmjasite" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xmdc4_d[l_ac].xmjasite) AND g_xmdc4_d[l_ac].xmjasite <> g_xmdc4_d_t.xmjasite THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmdc4_d[l_ac].xmjasite
               LET g_chkparam.arg2 = '2'
               LET g_chkparam.arg3 = g_xmda_m.xmdasite
                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_ooed004") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 
               ELSE
                  #檢查失敗時後續處理
                  LET g_xmdc4_d[l_ac].xmjasite = g_xmdc4_d_t.xmjasite
                  CALL adbt500_xmjasite_ref()
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
            CALL adbt500_xmjasite_ref()
            LET g_flag3 = FALSE
            CALL adbt500_set_entry_b(l_cmd)
            CALL adbt500_set_no_entry_b(l_cmd)]]>
  </point>
  <point name="input.a.page5.xmdb001" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xmda_m.xmdadocno IS NOT NULL AND g_xmdc5_d[g_detail_idx].xmdb001 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmda_m.xmdadocno != g_xmdadocno_t OR g_xmdc5_d[g_detail_idx].xmdb001 != g_xmdc5_d_t.xmdb001)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xmdb_t WHERE "||"xmdbent = '" ||g_enterprise|| "' AND xmdbsite = '" ||g_site|| "' AND "||"xmdbdocno = '"||g_xmda_m.xmdadocno ||"' AND "|| "xmdb001 = '"||g_xmdc5_d[g_detail_idx].xmdb001 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page5.xmdb002" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xmdc5_d[l_ac].xmdb002) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_pmad002_2") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 

               ELSE
                  #檢查失敗時後續處理
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
]]>
  </point>
  <point name="input.a.page5.xmdb005" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xmdc5_d[l_ac].xmdb005) THEN 
            END IF 
]]>
  </point>
  <point name="input.a.page5.xmdb006" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xmdc5_d[l_ac].xmdb006) THEN 
            END IF 
]]>
  </point>
  <point name="input.a.page6.xrcd002" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            CALL adbt500_xrcd002_ref()]]>
  </point>
  <point name="input.a.page6.xrcd007" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xmda_m.xmdadocno IS NOT NULL AND g_xmdc6_d[g_detail_idx].xrcdld IS NOT NULL AND g_xmdc6_d[g_detail_idx].xrcdseq IS NOT NULL AND g_xmdc6_d[g_detail_idx].xrcdseq2 IS NOT NULL AND g_xmdc6_d[g_detail_idx].xrcd007 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmda_m.xmdadocno != g_xmdadocno_t OR g_xmdc6_d[g_detail_idx].xrcdld != g_xmdc6_d_t.xrcdld OR g_xmdc6_d[g_detail_idx].xrcdseq != g_xmdc6_d_t.xrcdseq OR g_xmdc6_d[g_detail_idx].xrcdseq2 != g_xmdc6_d_t.xrcdseq2 OR g_xmdc6_d[g_detail_idx].xrcd007 != g_xmdc6_d_t.xrcd007)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xrcd_t WHERE "||"xrcdent = '" ||g_enterprise|| "' AND "||"xrcddocno = '"||g_xmda_m.xmdadocno ||"' AND "|| "xrcdld = '"||g_xmdc6_d[g_detail_idx].xrcdld ||"' AND "|| "xrcdseq = '"||g_xmdc6_d[g_detail_idx].xrcdseq ||"' AND "|| "xrcdseq2 = '"||g_xmdc6_d[g_detail_idx].xrcdseq2 ||"' AND "|| "xrcd007 = '"||g_xmdc6_d[g_detail_idx].xrcd007 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page6.xrcdld" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xmda_m.xmdadocno IS NOT NULL AND g_xmdc6_d[g_detail_idx].xrcdld IS NOT NULL AND g_xmdc6_d[g_detail_idx].xrcdseq IS NOT NULL AND g_xmdc6_d[g_detail_idx].xrcdseq2 IS NOT NULL AND g_xmdc6_d[g_detail_idx].xrcd007 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmda_m.xmdadocno != g_xmdadocno_t OR g_xmdc6_d[g_detail_idx].xrcdld != g_xmdc6_d_t.xrcdld OR g_xmdc6_d[g_detail_idx].xrcdseq != g_xmdc6_d_t.xrcdseq OR g_xmdc6_d[g_detail_idx].xrcdseq2 != g_xmdc6_d_t.xrcdseq2 OR g_xmdc6_d[g_detail_idx].xrcd007 != g_xmdc6_d_t.xrcd007)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xrcd_t WHERE "||"xrcdent = '" ||g_enterprise|| "' AND "||"xrcddocno = '"||g_xmda_m.xmdadocno ||"' AND "|| "xrcdld = '"||g_xmdc6_d[g_detail_idx].xrcdld ||"' AND "|| "xrcdseq = '"||g_xmdc6_d[g_detail_idx].xrcdseq ||"' AND "|| "xrcdseq2 = '"||g_xmdc6_d[g_detail_idx].xrcdseq2 ||"' AND "|| "xrcd007 = '"||g_xmdc6_d[g_detail_idx].xrcd007 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page6.xrcdseq" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xmda_m.xmdadocno IS NOT NULL AND g_xmdc6_d[g_detail_idx].xrcdld IS NOT NULL AND g_xmdc6_d[g_detail_idx].xrcdseq IS NOT NULL AND g_xmdc6_d[g_detail_idx].xrcdseq2 IS NOT NULL AND g_xmdc6_d[g_detail_idx].xrcd007 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmda_m.xmdadocno != g_xmdadocno_t OR g_xmdc6_d[g_detail_idx].xrcdld != g_xmdc6_d_t.xrcdld OR g_xmdc6_d[g_detail_idx].xrcdseq != g_xmdc6_d_t.xrcdseq OR g_xmdc6_d[g_detail_idx].xrcdseq2 != g_xmdc6_d_t.xrcdseq2 OR g_xmdc6_d[g_detail_idx].xrcd007 != g_xmdc6_d_t.xrcd007)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xrcd_t WHERE "||"xrcdent = '" ||g_enterprise|| "' AND "||"xrcddocno = '"||g_xmda_m.xmdadocno ||"' AND "|| "xrcdld = '"||g_xmdc6_d[g_detail_idx].xrcdld ||"' AND "|| "xrcdseq = '"||g_xmdc6_d[g_detail_idx].xrcdseq ||"' AND "|| "xrcdseq2 = '"||g_xmdc6_d[g_detail_idx].xrcdseq2 ||"' AND "|| "xrcd007 = '"||g_xmdc6_d[g_detail_idx].xrcd007 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page6.xrcdseq2" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xmda_m.xmdadocno IS NOT NULL AND g_xmdc6_d[g_detail_idx].xrcdld IS NOT NULL AND g_xmdc6_d[g_detail_idx].xrcdseq IS NOT NULL AND g_xmdc6_d[g_detail_idx].xrcdseq2 IS NOT NULL AND g_xmdc6_d[g_detail_idx].xrcd007 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmda_m.xmdadocno != g_xmdadocno_t OR g_xmdc6_d[g_detail_idx].xrcdld != g_xmdc6_d_t.xrcdld OR g_xmdc6_d[g_detail_idx].xrcdseq != g_xmdc6_d_t.xrcdseq OR g_xmdc6_d[g_detail_idx].xrcdseq2 != g_xmdc6_d_t.xrcdseq2 OR g_xmdc6_d[g_detail_idx].xrcd007 != g_xmdc6_d_t.xrcd007)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xrcd_t WHERE "||"xrcdent = '" ||g_enterprise|| "' AND "||"xrcddocno = '"||g_xmda_m.xmdadocno ||"' AND "|| "xrcdld = '"||g_xmdc6_d[g_detail_idx].xrcdld ||"' AND "|| "xrcdseq = '"||g_xmdc6_d[g_detail_idx].xrcdseq ||"' AND "|| "xrcdseq2 = '"||g_xmdc6_d[g_detail_idx].xrcdseq2 ||"' AND "|| "xrcd007 = '"||g_xmdc6_d[g_detail_idx].xrcd007 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page7.rtieseq" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xmda_m.xmdadocno IS NOT NULL AND g_xmdc7_d[g_detail_idx].rtieseq IS NOT NULL AND g_xmdc7_d[g_detail_idx].rtieseq1 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmda_m.xmdadocno != g_xmdadocno_t OR g_xmdc7_d[g_detail_idx].rtieseq != g_xmdc7_d_t.rtieseq OR g_xmdc7_d[g_detail_idx].rtieseq1 != g_xmdc7_d_t.rtieseq1)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM rtie_t WHERE "||"rtieent = '" ||g_enterprise|| "' AND "||"rtiedocno = '"||g_xmda_m.xmdadocno ||"' AND "|| "rtieseq = '"||g_xmdc7_d[g_detail_idx].rtieseq ||"' AND "|| "rtieseq1 = '"||g_xmdc7_d[g_detail_idx].rtieseq1 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page7.rtieseq1" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xmda_m.xmdadocno IS NOT NULL AND g_xmdc7_d[g_detail_idx].rtieseq IS NOT NULL AND g_xmdc7_d[g_detail_idx].rtieseq1 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmda_m.xmdadocno != g_xmdadocno_t OR g_xmdc7_d[g_detail_idx].rtieseq != g_xmdc7_d_t.rtieseq OR g_xmdc7_d[g_detail_idx].rtieseq1 != g_xmdc7_d_t.rtieseq1)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM rtie_t WHERE "||"rtieent = '" ||g_enterprise|| "' AND "||"rtiedocno = '"||g_xmda_m.xmdadocno ||"' AND "|| "rtieseq = '"||g_xmdc7_d[g_detail_idx].rtieseq ||"' AND "|| "rtieseq1 = '"||g_xmdc7_d[g_detail_idx].rtieseq1 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page8.xmdc027" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xmdc8_d[l_ac].xmdc027) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist_and_ref_val("v_pmao004_1") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 
               ELSE
                  #檢查失敗時後續處理
                  NEXT FIELD CURRENT
               END IF
            

            END IF 

]]>
  </point>
  <point name="input.a.page8.xmdcseq_7" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xmda_m.xmdadocno IS NOT NULL AND g_xmdc8_d[g_detail_idx].xmdcseq IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmda_m.xmdadocno != g_xmdadocno_t OR g_xmdc8_d[g_detail_idx].xmdcseq != g_xmdc8_d_t.xmdcseq)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xmdc_t WHERE "||"xmdcent = '" ||g_enterprise|| "' AND "||"xmdcdocno = '"||g_xmda_m.xmdadocno ||"' AND "|| "xmdcseq = '"||g_xmdc8_d[g_detail_idx].xmdcseq ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.xmda001" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.a.xmda002" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            CALL adbt500_xmda002_ref(g_xmda_m.xmda002) RETURNING g_xmda_m.xmda002_desc
            DISPLAY BY NAME g_xmda_m.xmda002_desc
            IF NOT cl_null(g_xmda_m.xmda002) THEN 
              #此段落由子樣板a19產生   
               IF p_cmd = 'a' OR ( p_cmd = 'u' AND (g_xmda_m.xmda002 != g_xmda_m_t.xmda002 OR cl_null(g_xmda_m_t.xmda002))) THEN
                 #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
                  INITIALIZE g_chkparam.* TO NULL               
                  #設定g_chkparam.*的參數
                  LET g_chkparam.arg1 = g_xmda_m.xmda002
                     
                 #呼叫檢查存在並帶值的library
                  IF cl_chk_exist("v_ooag001") THEN
                     #檢查成功時後續處理
                      SELECT ooag003 INTO g_xmda_m.xmda003 FROM ooag_t WHERE ooagent = g_enterprise AND ooag001 = g_xmda_m.xmda002
                      CALL adbt500_xmda003_ref(g_xmda_m.xmda003) RETURNING g_xmda_m.xmda003_desc
                      DISPLAY BY NAME g_xmda_m.xmda003_desc 
                  ELSE
                     #檢查失敗時後續處理
                      LET g_xmda_m.xmda002 = g_xmda_m_t.xmda002
                      CALL adbt500_xmda002_ref(g_xmda_m.xmda002) RETURNING g_xmda_m.xmda002_desc
                      DISPLAY BY NAME g_xmda_m.xmda002_desc
                      NEXT FIELD CURRENT
                  END IF
               END IF

            END IF 
]]>
  </point>
  <point name="input.a.xmda003" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            CALL adbt500_xmda003_ref(g_xmda_m.xmda003) RETURNING g_xmda_m.xmda003_desc
            DISPLAY BY NAME g_xmda_m.xmda003_desc 
            
            IF NOT cl_null(g_xmda_m.xmda003) THEN 
               IF NOT adbt500_xmda003_chk(g_xmda_m.xmda003) THEN
                  LET g_xmda_m.xmda003 = g_xmda_m_t.xmda003
                  CALL adbt500_xmda003_ref(g_xmda_m.xmda003) RETURNING g_xmda_m.xmda003_desc
                  DISPLAY BY NAME g_xmda_m.xmda003_desc 
                  NEXT FIELD CURRENT
               END IF   
                              
            END IF ]]>
  </point>
  <point name="input.a.xmda004" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            CALL adbt500_xmda004_ref(g_xmda_m.xmda004) RETURNING g_xmda_m.xmda004_desc
            DISPLAY BY NAME g_xmda_m.xmda004_desc
            
            IF NOT cl_null(g_xmda_m.xmda004) THEN 
               IF p_cmd = 'a' OR ( p_cmd = 'u' AND (g_xmda_m.xmda004 != g_xmda_m_o.xmda004 OR cl_null(g_xmda_m_o.xmda004))) THEN 
                  IF NOT adbt500_xmda004_chk(g_xmda_m.xmda004) THEN
                     LET g_xmda_m.xmda004 = g_xmda_m_o.xmda004
                     CALL adbt500_xmda004_ref(g_xmda_m.xmda004) RETURNING g_xmda_m.xmda004_desc
                     DISPLAY BY NAME g_xmda_m.xmda004_desc
                     NEXT FIELD CURRENT
                  END IF
                  
                  #如果客戶有修改，根據客戶帶值
                  CALL adbt500_xmda004_desc()
                  
                  #若輸入供應商的法人類型為'2:一次性交易'或是'4:內部員工'時，則自動串apmi004_01
                  #維護一次性交易對項基本資料，維護完基本資料後會回傳一個一次性交易對象識別碼，
                  #將識別碼值預設給xmda028欄位
                  LET l_pmaa004 = ''
                  SELECT pmaa004 INTO l_pmaa004 FROM pmaa_t WHERE pmaaent = g_enterprise AND pmaa001 = g_xmda_m.xmda004
                  IF l_pmaa004 = '2' THEN   #一次性交易對象
                     CALL apmi004_01('1','',g_xmda_m.xmda004,g_xmda_m.xmdadocno) RETURNING g_xmda_m.xmda028
                  END IF
                  IF l_pmaa004 = '4' THEN   #內部員工
                     CALL apmi004_01('2','',g_xmda_m.xmda004,g_xmda_m.xmdadocno) RETURNING g_xmda_m.xmda028
                  END IF                  
               END IF
               #新增時將訂單客戶值預設給最終客戶
               IF p_cmd = 'a' THEN
                  LET g_xmda_m.xmda034 = g_xmda_m.xmda004
                  DISPLAY BY NAME g_xmda_m.xmda034
                  CALL adbt500_xmda004_ref(g_xmda_m.xmda034) RETURNING g_xmda_m.xmda034_desc
                  DISPLAY BY NAME g_xmda_m.xmda034_desc
               END IF                
               LET g_xmda_m_o.xmda004 = g_xmda_m.xmda004           
            END IF 
]]>
  </point>
  <point name="input.a.xmda005" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            IF g_xmda_m.xmda005 <> '6' THEN
               LET g_xmda_m.xmda200 = NULL
               CALL adbt500_xmda200_ref()
            ELSE
               LET g_xmda_m.xmda201 = NULL
               CALL adbt500_xmda201_ref()
            END IF            ]]>
  </point>
  <point name="input.a.xmda006" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.a.xmda007" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.a.xmda008" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xmda_m.xmda008) THEN 
               IF NOT adbt500_xmda008_chk() THEN              
                  LET g_xmda_m.xmda008 = g_xmda_m_t.xmda008
                  NEXT FIELD CURRENT
               ELSE
                  
                  #帶值:資料來源選擇是'5'時，需以輸入的來源單號抓取相關欄位預設在訂單單頭上，例如:客戶、幣別、稅別、收款條件、付款條件
                  CALL adbt500_xmda008_desc()
               END IF
            ELSE
               IF g_xmda_m.xmda007 = '5' THEN      #資料來源選擇是'5'時此欄位必須輸入不可空白
                  CALL cl_err('', 'aoo-00052', 0 )
                  NEXT FIELD CURRENT
               END IF               
            END IF
           ]]>
  </point>
  <point name="input.a.xmda009" order="" ver="3" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            CALL adbt500_xmda009_ref(g_xmda_m.xmda009) RETURNING g_xmda_m.xmda009_desc
            DISPLAY BY NAME g_xmda_m.xmda009_desc
            IF NOT cl_null(g_xmda_m.xmda009) THEN 
               #此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmda_m.xmda021
               LET g_chkparam.arg2 = g_xmda_m.xmda009
                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_pmad002_2") THEN
                  #檢查成功時後續處理
               ELSE
                  #檢查失敗時後續處理
                  LET g_xmda_m.xmda009 = g_xmda_m_t.xmda009
                  CALL adbt500_xmda009_ref(g_xmda_m.xmda009) RETURNING g_xmda_m.xmda009_desc
                  DISPLAY BY NAME g_xmda_m.xmda009_desc                  
                  NEXT FIELD CURRENT
               END IF 
               IF g_xmda_m.xmda007 = '5' THEN
                  SELECT COUNT(*)
                    INTO l_cnt
                    FROM xmdk_t
                   WHERE xmdkent = g_enterprise 
                     AND xmdkdocno = g_xmda_m.xmda008
                     AND xmdk000 <> '2'
                     AND xmdk010 = g_xmda_m.xmda009
                  IF l_cnt = 0 THEN
                     CALL cl_err(g_xmda_m.xmda009,'adb-00050',1)
                     LET g_xmda_m.xmda009 = g_xmda_m_t.xmda009
                     CALL adbt500_xmda009_ref(g_xmda_m.xmda009) RETURNING g_xmda_m.xmda009_desc
                     DISPLAY BY NAME g_xmda_m.xmda009_desc  
                     NEXT FIELD CURRENT
                  END IF
               END IF

               #重新修改收款條件時，需詢問是否要重新取價，並重新計算含稅金額、未稅金額、稅額                
             #  LET l_cnt = 0
             #  SELECT COUNT(*) INTO l_cnt    
             #    FROM xmdc_t
             #   WHERE xmdcent = g_enterprise 
             #     AND xmdcdocno = g_xmda_m.xmdadocno                
             # 
             #  IF l_cnt > 0 AND (g_xmda_m.xmda009 != g_xmda_m_o.xmda009) THEN 
             #     IF cl_ask_confirm('axm-00230') THEN
             #       #CALL adbt500_get_xmdc015()          
             #        CALL adbt500_change_xmdc016()
             #     END IF
             #     LET g_xmda_m_o.xmda009 = g_xmda_m.xmda009          
             #  END IF                
            END IF 
]]>
  </point>
  <point name="input.a.xmda010" order="" ver="3" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xmda_m.xmda010) THEN 
               #此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmda_m.xmda010

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_oocq002_238") THEN
                  #檢查成功時後續處理
               ELSE
                  #檢查失敗時後續處理
                  LET g_xmda_m.xmda010 = g_xmda_m_t.xmda010
                  CALL adbt500_xmda010_ref(g_xmda_m.xmda010) RETURNING g_xmda_m.xmda010_desc
                  DISPLAY BY NAME g_xmda_m.xmda010_desc                  
                  NEXT FIELD CURRENT
               END IF
               IF g_xmda_m.xmda007 = '5' THEN
                  SELECT COUNT(*)
                    INTO l_cnt
                    FROM xmdk_t
                   WHERE xmdkent = g_enterprise 
                     AND xmdkdocno = g_xmda_m.xmda008
                     AND xmdk000 <> '2'
                     AND xmdk011 = g_xmda_m.xmda010
                  IF l_cnt = 0 THEN
                     CALL cl_err(g_xmda_m.xmda010,'adb-00050',1)
                     LET g_xmda_m.xmda010 = g_xmda_m_t.xmda010
                     CALL adbt500_xmda010_ref(g_xmda_m.xmda010) RETURNING g_xmda_m.xmda010_desc
                     DISPLAY BY NAME g_xmda_m.xmda010_desc   
                     NEXT FIELD CURRENT
                  END IF
               END IF
               #重新修改交易條件時，需詢問是否要重新取價，並重新計算含稅金額、未稅金額、稅額  
             # LET l_cnt = 0
             # SELECT COUNT(*) INTO l_cnt    
             #   FROM xmdc_t
             #  WHERE xmdcent = g_enterprise 
             #    AND xmdcdocno = g_xmda_m.xmdadocno                 
             # IF l_cnt > 0 AND (g_xmda_m.xmda010 != g_xmda_m_o.xmda010) THEN 
             #    IF cl_ask_confirm('axm-00230') THEN
             #      #CALL adbt500_get_xmdc015()          
             #       CALL adbt500_change_xmdc016()
             #    END IF
             #    LET g_xmda_m_o.xmda010 = g_xmda_m.xmda010                       
             # END IF             
            END IF 
]]>
  </point>
  <point name="input.a.xmda011" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            CALL adbt500_xmda011_ref(g_xmda_m.xmda011) RETURNING g_xmda_m.xmda011_desc
            DISPLAY BY NAME g_xmda_m.xmda011_desc
            IF NOT cl_null(g_xmda_m.xmda011) THEN 
               #此段落由子樣板a19產生
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_xmda_m.xmda011 <> g_xmda_m_t.xmda011 OR g_xmda_m_t.xmda011 IS NULL)) THEN
	              IF adbt500_xmda011_chk('1',g_xmda_m.xmda011) THEN
                     #帶出稅率、含稅否
                     LET g_oodb005 = ''
                     LET g_oodb006 = ''
                     LET g_tax_app = ''
                     CALL s_tax_chk(g_xmda_m.xmdasite,g_xmda_m.xmda011)
                      RETURNING l_success,g_oodbl004,g_oodb005,g_oodb006,g_tax_app     
                     IF l_success THEN
                        LET g_xmda_m.xmda012 = g_oodb006
                        LET g_xmda_m.xmda013 = g_oodb005
                        DISPLAY BY NAME g_xmda_m.xmda012
                        DISPLAY BY NAME g_xmda_m.xmda013
                     END IF
                     #重新修改稅別時，需詢問是否要重新取價，並重新計算含稅金額、未稅金額、稅額                
                     LET l_cnt = 0
                     SELECT COUNT(*) INTO l_cnt    
                       FROM xmdc_t
                      WHERE xmdcent = g_enterprise 
                        AND xmdcdocno = g_xmda_m.xmdadocno 
                    IF l_cnt > 0 AND (g_xmda_m.xmda011 != g_xmda_m_o.xmda011) THEN
                       #判斷稅別修改前後是否都是「單價未含稅」，如都是則不需重新取價，只需重新計算含稅、未稅金額
                       IF g_xmda_m.xmda013 = 'N' AND g_xmda_m.xmda013 = g_xmda_m_o.xmda013 THEN
                          IF cl_ask_confirm('apm-00351') THEN
                             CALL adbt500_change_xmdc016()
                          END IF
                       ELSE 
                         #需重新取價、計算含稅、未稅金額
                         IF cl_ask_confirm('axm-00230') THEN
                           #CALL adbt500_get_xmdc015()
                            CALL adbt500_change_xmdc016()
                         END IF                          
                       END IF  
                       LET g_xmda_m_o.xmda011 = g_xmda_m.xmda011
                       LET g_xmda_m_o.xmda013 = g_xmda_m.xmda013                      
                    END IF
                    
			      ELSE
                     #檢查失敗時後續處理
                     LET g_xmda_m.xmda011 = g_xmda_m_t.xmda011 
                     CALL adbt500_xmda011_ref(g_xmda_m.xmda011) RETURNING g_xmda_m.xmda011_desc
                     DISPLAY BY NAME g_xmda_m.xmda011_desc                      
                     NEXT FIELD CURRENT
                  END IF
                  CALL adbt500_xmda011_ref(g_xmda_m.xmda011) RETURNING g_xmda_m.xmda011_desc
                  DISPLAY BY NAME g_xmda_m.xmda011_desc               
               END IF
                 
            END IF 
]]>
  </point>
  <point name="input.a.xmda012" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.a.xmda013" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.a.xmda015" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            CALL adbt500_xmda015_ref(g_xmda_m.xmda015) RETURNING g_xmda_m.xmda015_desc
            DISPLAY BY NAME g_xmda_m.xmda015_desc
            IF NOT cl_null(g_xmda_m.xmda015) THEN 
               #此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmda_m.xmdasite
               LET g_chkparam.arg2 = g_xmda_m.xmda015

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_ooaj002") THEN
                  #檢查成功時後續處理
                  CALL s_aooi200_get_slip(g_xmda_m.xmdadocno) RETURNING l_success,l_slip               #截取單別
                  IF l_success THEN
                     CALL cl_get_doc_para(g_enterprise,g_xmda_m.xmdasite,l_slip,'D-BAS-0075') RETURNING l_para_data  #外幣使用匯率來源
                     IF cl_null(l_para_data) THEN
                        CALL cl_err('','axm-00144',1)      
                     ELSE
                        LET l_ooef016 = ''
                        SELECT ooef016 INTO l_ooef016 FROM ooef_t WHERE ooefent = g_enterprise AND ooef001 = g_xmda_m.xmdasite
                        CALL s_aooi160_get_exrate('1',g_xmda_m.xmdasite,g_today,g_xmda_m.xmda015,l_ooef016,0,l_para_data) RETURNING g_xmda_m.xmda016
                        DISPLAY BY NAME g_xmda_m.xmda016
                     END IF   
                  END IF
               ELSE
                  #檢查失敗時後續處理
                  LET g_xmda_m.xmda015 = g_xmda_m_t.xmda015
                  CALL adbt500_xmda015_ref(g_xmda_m.xmda015) RETURNING g_xmda_m.xmda015_desc
                  DISPLAY BY NAME g_xmda_m.xmda015_desc
                  NEXT FIELD CURRENT
               END IF
               
               IF g_xmda_m.xmda007 = '5' THEN
                  SELECT COUNT(*)
                    INTO l_cnt
                    FROM xmdk_t
                   WHERE xmdkent = g_enterprise 
                     AND xmdkdocno = g_xmda_m.xmda008
                     AND xmdk000 <> '2'
                     AND xmdk016 = g_xmda_m.xmda015
                  IF l_cnt = 0 THEN
                     CALL cl_err(g_xmda_m.xmda015,'adb-00050',1)
                     NEXT FIELD CURRENT
                  END IF
               END IF
               #重新修改幣別時，需詢問是否要重新取價，並重新計算含稅金額、未稅金額、稅額  
               LET l_cnt = 0
               SELECT COUNT(*) INTO l_cnt    
                 FROM xmdc_t
                WHERE xmdcent = g_enterprise 
                  AND xmdcdocno = g_xmda_m.xmdadocno                 
               IF l_cnt > 0 AND (g_xmda_m.xmda015 != g_xmda_m_o.xmda015) THEN 
                  IF cl_ask_confirm('axm-00230') THEN
                    #CALL adbt500_get_xmdc015()          
                     CALL adbt500_change_xmdc016()
                  END IF
                  LET g_xmda_m_o.xmda015 = g_xmda_m.xmda015            
               END IF                
            END IF 
]]>
  </point>
  <point name="input.a.xmda016" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.a.xmda017" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            CALL adbt500_xmda017_ref(g_xmda_m.xmda017) RETURNING g_xmda_m.xmda017_desc
            DISPLAY BY NAME g_xmda_m.xmda017_desc    
            IF NOT cl_null(g_xmda_m.xmda017) THEN 
               #此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmda_m.xmda017                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_xmah001") THEN
                  CALL adbt500_get_xmdc015()
               ELSE
                  #檢查失敗時後續處理
                  LET g_xmda_m.xmda017 = g_xmda_m_t.xmda017
                  CALL adbt500_xmda017_ref(g_xmda_m.xmda017) RETURNING g_xmda_m.xmda017_desc
                  DISPLAY BY NAME g_xmda_m.xmda017_desc
                  NEXT FIELD CURRENT                                 
               END IF
               #重新修改取價方式時，需詢問是否要重新取價，並重新計算含稅金額、未稅金額、稅額                
             #  LET l_cnt = 0
             #  SELECT COUNT(*) INTO l_cnt    
             #    FROM xmdc_t
             #   WHERE xmdcent = g_enterprise 
             #     AND xmdcdocno = g_xmda_m.xmdadocno                
             # 
             #  IF l_cnt > 0 AND (g_xmda_m.xmda017 != g_xmda_m_o.xmda017) THEN 
             #     IF cl_ask_confirm('axm-00230') THEN
             #       #CALL adbt500_get_xmdc015()          
             #        CALL adbt500_change_xmdc016()
             #     END IF
             #     LET g_xmda_m_o.xmda017 = g_xmda_m.xmda017          
             #  END IF             

            END IF 
]]>
  </point>
  <point name="input.a.xmda018" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                    CALL adbt500_xmda018_ref(g_xmda_m.xmda018) RETURNING g_xmda_m.xmda018_desc
            DISPLAY BY NAME g_xmda_m.xmda018_desc
            IF NOT cl_null(g_xmda_m.xmda018) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmda_m.xmda018

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_ooid001_2") THEN
                  #檢查成功時後續處理
                ELSE
                  #檢查失敗時後續處理
                  LET g_xmda_m.xmda018 = g_xmda_m_t.xmda018
                  CALL adbt500_xmda018_ref(g_xmda_m.xmda018) RETURNING g_xmda_m.xmda018_desc
                  DISPLAY BY NAME g_xmda_m.xmda018_desc                  
                  NEXT FIELD CURRENT
               END IF
 
            END IF 
]]>
  </point>
  <point name="input.a.xmda019" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.a.xmda020" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            CALL adbt500_xmda020_ref(g_xmda_m.xmda020) RETURNING g_xmda_m.xmda020_desc
            DISPLAY BY NAME g_xmda_m.xmda020_desc  
            IF NOT cl_null(g_xmda_m.xmda020) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmda_m.xmda020

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_oocq002_263") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 

               ELSE
                  LET g_xmda_m.xmda020 = g_xmda_m_t.xmda020
                  CALL adbt500_xmda020_ref(g_xmda_m.xmda020) RETURNING g_xmda_m.xmda020_desc
                  DISPLAY BY NAME g_xmda_m.xmda020_desc  
                  NEXT FIELD CURRENT
               END IF          

            END IF 
]]>
  </point>
  <point name="input.a.xmda021" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xmda_m.xmda021) THEN 
            #此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmda_m.xmda004
               LET g_chkparam.arg2 = g_xmda_m.xmda021
                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_pmac002") THEN
                  #檢查成功時後續處理
               ELSE
                  #檢查失敗時後續處理
                  LET g_xmda_m.xmda021 = g_xmda_m_t.xmda021
                  CALL adbt500_xmda004_ref(g_xmda_m.xmda021) RETURNING g_xmda_m.xmda021_desc
                  DISPLAY BY NAME g_xmda_m.xmda021_desc                  
                  NEXT FIELD CURRENT
               END IF             
            END IF 
            CALL adbt500_xmda026_desc()
            CALL adbt500_xmda004_ref(g_xmda_m.xmda021) RETURNING g_xmda_m.xmda021_desc
            DISPLAY BY NAME g_xmda_m.xmda021_desc]]>
  </point>
  <point name="input.a.xmda022" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xmda_m.xmda022) THEN 
               #此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmda_m.xmda004
               LET g_chkparam.arg2 = g_xmda_m.xmda022                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_pmac002_2") THEN
                  #檢查成功時後續處理
               ELSE
                  #檢查失敗時後續處理
                  LET g_xmda_m.xmda022 = g_xmda_m_t.xmda022                  
                  CALL adbt500_xmda004_ref(g_xmda_m.xmda022) RETURNING g_xmda_m.xmda022_desc
                  DISPLAY BY NAME g_xmda_m.xmda022_desc                 
                  NEXT FIELD CURRENT
               END IF           
            END IF 
            CALL adbt500_xmda025_desc()
            CALL adbt500_xmda004_ref(g_xmda_m.xmda022) RETURNING g_xmda_m.xmda022_desc
            DISPLAY BY NAME g_xmda_m.xmda022_desc]]>
  </point>
  <point name="input.a.xmda023" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            
            IF NOT cl_null(g_xmda_m.xmda023) THEN 
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmda_m.xmda023
               LET g_chkparam.arg2 = '1'

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_oojd001") THEN
                  #檢查成功時後續處理
               ELSE
                  #檢查失敗時後續處理
                  LET g_xmda_m.xmda023 = g_xmda_m_t.xmda023
                  CALL adbt500_xmda023_ref(g_xmda_m.xmda023) RETURNING g_xmda_m.xmda023_desc
                  DISPLAY BY NAME g_xmda_m.xmda023_desc
                  NEXT FIELD CURRENT
               END IF
               IF NOT adbt500_xmda202_chk() THEN
                  NEXT FIELD CURRENT
               END IF
            END IF 
            
            
            CALL adbt500_xmda023_ref(g_xmda_m.xmda023) RETURNING g_xmda_m.xmda023_desc
            DISPLAY BY NAME g_xmda_m.xmda023_desc
]]>
  </point>
  <point name="input.a.xmda024" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            CALL adbt500_xmda024_ref(g_xmda_m.xmda024) RETURNING g_xmda_m.xmda024_desc
            DISPLAY BY NAME g_xmda_m.xmda024_desc
            IF NOT cl_null(g_xmda_m.xmda024) THEN
               IF NOT adbt500_xmda024_chk(g_xmda_m.xmda024) THEN
                  LET g_xmda_m.xmda024 = g_xmda_m_t.xmda024
                  CALL adbt500_xmda024_ref(g_xmda_m.xmda024) RETURNING g_xmda_m.xmda024_desc
                  DISPLAY BY NAME g_xmda_m.xmda024_desc
                  NEXT FIELD CURRENT
               END IF
            END IF            ]]>
  </point>
  <point name="input.a.xmda025" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xmda_m.xmda025) THEN 
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               
			      LET g_chkparam.arg1 = l_pmaa027
               LET g_chkparam.arg2 = g_xmda_m.xmda025
                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_oofb019_1") THEN
                  #呼叫地址組合應用元件，將組合好的聯絡地址顯示在下方
                  CALL s_aooi350_get_address(l_pmaa027,g_xmda_m.xmda025,g_lang)RETURNING r_success,r_address
                  IF r_success THEN
                     LET g_xmda_m.oofb017 = r_address
                     DISPLAY BY NAME g_xmda_m.oofb017   
                  END IF
               ELSE
                  #檢查失敗時後續處理
                  LET g_xmda_m.xmda025 = g_xmda_m_t.xmda025
                  CALL adbt500_xmda025_ref(l_pmaa027,g_xmda_m.xmda025) RETURNING g_xmda_m.xmda025_desc
                  DISPLAY BY NAME g_xmda_m.xmda025_desc
                  NEXT FIELD CURRENT
               END IF
               
               SELECT oofb022 INTO g_xmda_m.xmda206 FROM oofb_t
                WHERE oofb002 = l_pmaa027 AND oofb008 = '3' 
                  AND oofbstus = 'Y' 
                  AND oofb019 = g_xmda_m.xmda025 
                  AND rownum = 1 
               
               IF NOT cl_null(g_xmda_m.xmda206) THEN
                  SELECT dbaf001 INTO g_xmda_m.xmda207
                    FROM dbaf_t
                   WHERE dbafent = g_enterprise
                     AND dbaf002 = '1'
                     AND dbaf003 = g_xmda_m.xmda206 
                     AND dbafstus = 'Y'
                  IF cl_null(g_xmda_m.xmda207) THEN 
                     SELECT dbaf001 INTO g_xmda_m.xmda207
                       FROM dbaf_t
                      WHERE dbafent = g_enterprise
                        AND dbaf002 = '1'
                        AND dbaf003 = g_xmda_m.xmda206 
                        AND dbafstus = 'Y'
                        AND rownum = 1 
                  END IF         
               END IF
            ELSE               
               LET g_xmda_m.xmda206 = ''
               LET g_xmda_m.xmda207 = ''
               LET g_xmda_m.oofb017 = ''
            END IF
            CALL adbt500_xmda025_ref(l_pmaa027,g_xmda_m.xmda025) RETURNING g_xmda_m.xmda025_desc
            DISPLAY BY NAME g_xmda_m.xmda025_desc
            DISPLAY BY NAME g_xmda_m.xmda206,g_xmda_m.xmda207,g_xmda_m.oofb017
            CALL adbt500_xmda206_ref()
            CALL adbt500_xmda207_ref()
            ]]>
  </point>
  <point name="input.a.xmda026" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xmda_m.xmda026) THEN 
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
			   CALL adbt500_get_pmaa027(g_xmda_m.xmda021) RETURNING l_pmaa027
			   LET g_chkparam.arg1 = l_pmaa027
               LET g_chkparam.arg2 = g_xmda_m.xmda026
                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_oofb019_2") THEN
                  #呼叫地址組合應用元件，將組合好的聯絡地址顯示在下方
                  CALL s_aooi350_get_address(l_pmaa027,g_xmda_m.xmda026,g_lang)RETURNING r_success,r_address
                  IF r_success THEN
                     LET g_xmda_m.oofb017_1 = r_address
                     DISPLAY BY NAME g_xmda_m.oofb017_1
                  END IF
               ELSE
                  #檢查失敗時後續處理
                  LET g_xmda_m.xmda026 = g_xmda_m_t.xmda026
                  CALL adbt500_xmda026_ref(l_pmaa027,g_xmda_m.xmda026) RETURNING g_xmda_m.xmda026_desc
                  DISPLAY BY NAME g_xmda_m.xmda026_desc
                  NEXT FIELD CURRENT
               END IF
            END IF
            CALL adbt500_xmda026_ref(l_pmaa027,g_xmda_m.xmda026) RETURNING g_xmda_m.xmda026_desc
            DISPLAY BY NAME g_xmda_m.xmda026_desc]]>
  </point>
  <point name="input.a.xmda027" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                    CALL adbt500_xmda027_ref(g_xmda_m.xmda027) RETURNING g_xmda_m.xmda027_desc
            DISPLAY BY NAME g_xmda_m.xmda027_desc
            
            IF NOT cl_null(g_xmda_m.xmda027) THEN 
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmda_m.xmda004
               LET g_chkparam.arg2 = g_xmda_m.xmda027

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_pmaj002") THEN
                  #檢查成功時後續處理
               ELSE
                  #檢查失敗時後續處理
                  LET g_xmda_m.xmda027 = g_xmda_m_t.xmda027
                  CALL adbt500_xmda027_ref(g_xmda_m.xmda027) RETURNING g_xmda_m.xmda027_desc
                  DISPLAY BY NAME g_xmda_m.xmda027_desc
                  NEXT FIELD CURRENT
               END IF
            END IF 
]]>
  </point>
  <point name="input.a.xmda028" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.a.xmda030" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.a.xmda031" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.a.xmda032" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[           
            CALL adbt500_xmda032_ref(g_xmda_m.xmda032) RETURNING g_xmda_m.xmda032_desc
            DISPLAY BY NAME g_xmda_m.xmda032_desc

            IF NOT cl_null(g_xmda_m.xmda032) THEN
               IF NOT s_azzi650_chk_exist('298',g_xmda_m.xmda032) THEN
                  LET g_xmda_m.xmda032 = g_xmda_m_t.xmda032
                  CALL adbt500_xmda032_ref(g_xmda_m.xmda032) RETURNING g_xmda_m.xmda032_desc
                  DISPLAY BY NAME g_xmda_m.xmda032_desc
                  NEXT FIELD CURRENT               
               END IF
            END IF
]]>
  </point>
  <point name="input.a.xmda033" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.a.xmda034" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            CALL adbt500_xmda004_ref(g_xmda_m.xmda034) RETURNING g_xmda_m.xmda034_desc
            DISPLAY BY NAME g_xmda_m.xmda034_desc
            IF NOT cl_null(g_xmda_m.xmda034)  AND g_xmda_m.xmda034 <> g_xmda_m_t.xmda034 THEN 
               #此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmda_m.xmda034                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_pmaa001_3") THEN
                  #檢查成功時後續處理
               ELSE
                  #檢查失敗時後續處理
                  LET g_xmda_m.xmda034 = g_xmda_m_t.xmda034
                  CALL adbt500_xmda004_ref(g_xmda_m.xmda034) RETURNING g_xmda_m.xmda034_desc
                  DISPLAY BY NAME g_xmda_m.xmda034_desc
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
]]>
  </point>
  <point name="input.a.xmda035" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            CALL adbt500_xmda035_ref(g_xmda_m.xmda035) RETURNING g_xmda_m.xmda035_desc
            DISPLAY BY NAME g_xmda_m.xmda035_desc  
            IF NOT cl_null(g_xmda_m.xmda035) THEN
               INITIALIZE g_chkparam.* TO NULL

               #設定g_chkparam.*的參數
               SELECT ooef019 INTO l_ooef019 FROM ooef_t WHERE ooefent = g_enterprise AND ooef001 = g_xmda_m.xmdasite
               LET g_chkparam.arg1 = l_ooef019 
               LET g_chkparam.arg2 = g_xmda_m.xmda035
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_isac002") THEN
                  #檢查成功時後續處理
               ELSE
                  #檢查失敗時後續處理
                  LET g_xmda_m.xmda035 = g_xmda_m_t.xmda035
                  CALL adbt500_xmda035_ref(g_xmda_m.xmda035) RETURNING g_xmda_m.xmda035_desc
                  DISPLAY BY NAME g_xmda_m.xmda035_desc 
                  NEXT FIELD CURRENT
               END IF               
            END IF]]>
  </point>
  <point name="input.a.xmda036" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                    CALL adbt500_xmda004_ref(g_xmda_m.xmda036) RETURNING g_xmda_m.xmda036_desc
            DISPLAY BY NAME g_xmda_m.xmda036_desc
            IF NOT cl_null(g_xmda_m.xmda036) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmda_m.xmda036

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_pmaa001_1") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 

               ELSE
                  #檢查失敗時後續處理
                  LET g_xmda_m.xmda036=g_xmda_m_t.xmda036
                  CALL adbt500_xmda004_ref(g_xmda_m.xmda036) RETURNING g_xmda_m.xmda036_desc
                  DISPLAY BY NAME g_xmda_m.xmda036_desc
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmda_m.xmda036
            CALL ap_ref_array2(g_ref_fields,"SELECT pmaal004 FROM pmaal_t WHERE pmaalent='"||g_enterprise||"' AND pmaal001=? AND pmaal002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmda_m.xmda036_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmda_m.xmda036_desc
]]>
  </point>
  <point name="input.a.xmda037" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                    CALL adbt500_xmda037_ref(g_xmda_m.xmda037) RETURNING g_xmda_m.xmda037_desc
            DISPLAY BY NAME g_xmda_m.xmda037_desc

            IF NOT cl_null(g_xmda_m.xmda020) THEN  #運輸類型
               CALL adbt500_location_chk(g_xmda_m.xmda037,l_oocq019)

               IF NOT cl_null(g_errno) THEN
                  CALL cl_err(g_xmda_m.xmda037,g_errno,1)
                  LET g_xmda_m.xmda037 = g_xmda_m_t.xmda037
                  NEXT FIELD CURRENT
               END IF
            ELSE
               CALL cl_err('','axm-00085','1')   #請先輸入運輸方式
               NEXT FIELD xmda020
            END IF

]]>
  </point>
  <point name="input.a.xmda038" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                    CALL adbt500_xmda038_ref(g_xmda_m.xmda038) RETURNING g_xmda_m.xmda038_desc
            DISPLAY BY NAME g_xmda_m.xmda038_desc

            IF NOT cl_null(g_xmda_m.xmda037) THEN
               IF NOT cl_null(g_xmda_m.xmda020) THEN               #運輸類型
                  CALL adbt500_location_chk(g_xmda_m.xmda037,l_oocq019)

                  IF NOT cl_null(g_errno) THEN
                     CALL cl_err(g_xmda_m.xmda037,g_errno,1)
                     LET g_xmda_m.xmda037 = g_xmda_m_t.xmda037
                     NEXT FIELD CURRENT
                  END IF
               ELSE
                  CALL cl_err('','axm-00085','1')   #請先輸入運輸方式
                  NEXT FIELD CURRENT
               END IF
            END IF    ]]>
  </point>
  <point name="input.a.xmda039" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.a.xmda043" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.a.xmda044" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xmda_m.xmda044) THEN
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL

               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmda_m.xmda004

               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_itcf002") THEN
                  #檢查成功時後續處理
               ELSE
                  #檢查失敗時後續處理
                  LET g_xmda_m.xmda044 = g_xmda_m_t.xmda044
                  NEXT FIELD CURRENT
               END IF
            END IF                                                                        ]]>
  </point>
  <point name="input.a.xmda200" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xmda_m.xmda200) THEN 
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmda_m.xmda200
                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_pmaa001_16") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 
               ELSE
                  #檢查失敗時後續處理
                  LET g_xmda_m.xmda200 = g_xmda_m_t.xmda200
                  CALL adbt500_xmda200_ref()
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
            CALL adbt500_xmda200_ref()]]>
  </point>
  <point name="input.a.xmda201" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xmda_m.xmda201) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmda_m.xmda201
                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_pmaa001_1") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 
               ELSE
                  #檢查失敗時後續處理
                  LET g_xmda_m.xmda201 = g_xmda_m_t.xmda201
                  CALL adbt500_xmda201_ref()
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
            CALL adbt500_xmda201_ref()
]]>
  </point>
  <point name="input.a.xmda202" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xmda_m.xmda202) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmda_m.xmda202
               LET g_chkparam.arg2 = "G"
                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_ooef001_2") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 
               ELSE
                  #檢查失敗時後續處理
                  LET g_xmda_m.xmda202 = g_xmda_m_t.xmda202
                  CALL adbt500_xmda202_ref()
                  NEXT FIELD CURRENT
               END IF
               IF NOT adbt500_xmda202_chk() THEN
                  NEXT FIELD CURRENT
               END IF
            END IF 
            CALL adbt500_xmda202_ref()

]]>
  </point>
  <point name="input.a.xmda203" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xmda_m.xmda203) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmda_m.xmda004
               LET g_chkparam.arg2 = g_xmda_m.xmda203
                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_pmac002_5") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 
               ELSE
                  #檢查失敗時後續處理
                  LET g_xmda_m.xmda203 = g_xmda_m_t.xmda203
                  CALL adbt500_xmda203_ref()
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
            CALL adbt500_xmda203_ref()

]]>
  </point>
  <point name="input.a.xmda204" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xmda_m.xmda204) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmda_m.xmda204
                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_prcf001") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 
               ELSE
                  #檢查失敗時後續處理
                  LET g_xmda_m.xmda204 = g_xmda_m_t.xmda204
                  CALL adbt500_xmda204_ref()
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
            CALL adbt500_xmda204_ref()

]]>
  </point>
  <point name="input.a.xmda205" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xmda_m.xmda205) THEN 
            END IF 

]]>
  </point>
  <point name="input.a.xmdadocdt" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="input.a.xmdadocno" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                    #此段落由子樣板a05產生
            CALL adbt500_xmdadocno_ref()           
            IF  NOT cl_null(g_xmda_m.xmdadocno) THEN 
                IF p_cmd = 'a' OR ( p_cmd = 'u' AND (g_xmda_m.xmdadocno != g_xmdadocno_t )) THEN 
                   IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xmda_t WHERE "||"xmdaent = '" ||g_enterprise|| "' AND "||"xmdadocno = '"||g_xmda_m.xmdadocno ||"'",'std-00004',0) THEN 
                      LET g_xmda_m.xmdadocno = g_xmdadocno_t
                      CALL adbt500_xmdadocno_ref()
                      NEXT FIELD CURRENT
                   END IF
                  #檢核輸入的單據別是否可以被key人員對應的控制組使用,'2' 為銷售控制組類型
                   CALL s_control_chk_doc('1',g_xmda_m.xmdadocno,'2',g_user,g_dept,'','') RETURNING l_success,l_flag
                   IF l_success THEN
                      IF NOT l_flag THEN
                         CALL cl_err(g_xmda_m.xmdadocno,'axm-00015',1)
                         LET g_xmda_m.xmdadocno = g_xmdadocno_t
                         CALL adbt500_xmdadocno_ref()
                         NEXT FIELD CURRENT
                      END IF
                   ELSE
                      LET g_xmda_m.xmdadocno = g_xmdadocno_t
                      CALL adbt500_xmdadocno_ref()
                      NEXT FIELD CURRENT
                   END IF
                   IF NOT s_aooi200_chk_slip(g_xmda_m.xmdasite,'',g_xmda_m.xmdadocno,g_prog) THEN
                      LET g_xmda_m.xmdadocno = g_xmdadocno_t
                      CALL adbt500_xmdadocno_ref()
                      NEXT FIELD CURRENT   
                   END IF
                END IF   
                CALL adbt500_get_col_default()   #取得欄位預設值                
                #NEXT FIELD xmdadocdt
            ELSE
               NEXT FIELD CURRENT                 
            END IF


]]>
  </point>
  <point name="input.a.xmdasite" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xmda_m.xmdasite) THEN 
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmda_m.xmdasite
               LET g_chkparam.arg2 = '2'
               LET g_chkparam.arg3 = g_site
                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_ooed004") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 
               ELSE
                  #檢查失敗時後續處理
                  LET g_xmda_m.xmdasite = g_xmda_m_t.xmdasite
                  CALL adbt500_xmdasite_ref()
                  NEXT FIELD CURRENT
               END IF
            END IF  
            CALL adbt500_xmdasite_ref() 
            LET g_flag2 = TRUE
            CALL adbt500_set_entry(p_cmd)
            CALL adbt500_set_no_entry(p_cmd)            ]]>
  </point>
  <point name="input.a.xmdastus" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.a.xmdaunit" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xmda_m.xmdaunit) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmda_m.xmdaunit
               LET g_chkparam.arg2 = '2'
                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_ooed004_1") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 
               ELSE
                  #檢查失敗時後續處理
                  LET g_xmda_m.xmdaunit = g_xmda_m_t.xmdaunit
                  CALL adbt500_xmdaunit_ref()
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
            CALL adbt500_xmdaunit_ref()

]]>
  </point>
  <point name="input.after_define_sql" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                  ]]>
  </point>
  <point name="input.after_define_sql2" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                  ]]>
  </point>
  <point name="input.after_define_sql3" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                  ]]>
  </point>
  <point name="input.after_input" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[   #重新計算整單的未稅、含稅總金額
   CALL s_tax_recount_tmp()
   CALL s_tax_recount(g_xmda_m.xmdadocno)
     RETURNING g_xmda_m.xmda041,g_xmda_m.xmda043,g_xmda_m.xmda042,l_xrcd113,l_xrcd114,l_xrcd115
   UPDATE xmda_t SET xmda041 = g_xmda_m.xmda041,
                     xmda042 = g_xmda_m.xmda042,
                     xmda043 = g_xmda_m.xmda043
       WHERE xmdaent = g_enterprise AND xmdadocno = g_xmda_m.xmdadocno                  ]]>
  </point>
  <point name="input.after_set_entry" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                  ]]>
  </point>
  <point name="input.b.page1.imaal004" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.b.page1.xmdc001" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.b.page1.xmdc002" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            LET l_imaa005=''
            CALL adbt500_get_imaa005(g_enterprise,g_xmdc_d[l_ac].xmdc001) RETURNING l_imaa005

            IF NOT cl_null(l_imaa005) THEN
               IF l_cmd = 'a' AND cl_null(g_xmdc_d[l_ac].xmdc002) THEN
                  CALL g_inam.clear()
                  CALL s_feature_multi(g_xmdc_d[l_ac].xmdc001,'','',g_site,g_xmda_m.xmdadocno) RETURNING l_success,g_inam
                  LET g_xmdc_d[l_ac].xmdc002 = g_inam[1].inam002
                  LET g_xmdc_d[l_ac].xmdc007 = g_inam[1].inam004
                  DISPLAY BY NAME g_xmdc_d[l_ac].xmdc002,g_xmdc_d[l_ac].xmdc007
               END IF
            END IF         ]]>
  </point>
  <point name="input.b.page1.xmdc004" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.b.page1.xmdc005" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.b.page1.xmdc006" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.b.page1.xmdc007" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.b.page1.xmdc008" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.b.page1.xmdc009" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.b.page1.xmdc010" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.b.page1.xmdc011" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.b.page1.xmdc012" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.b.page1.xmdc013" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.b.page1.xmdc015" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.b.page1.xmdc016" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.b.page1.xmdc019" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.b.page1.xmdc020" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.b.page1.xmdc021" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.b.page1.xmdc022" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.b.page1.xmdc023" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.b.page1.xmdc024" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.b.page1.xmdc027" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.b.page1.xmdc045" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.b.page1.xmdc049" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.b.page1.xmdc050" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.b.page1.xmdc052" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.b.page1.xmdcorga" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.b.page1.xmdcseq" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.b.page1.xmdcunit" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                    CALL adbt500_set_entry_b(p_cmd)
            CALL adbt500_set_no_entry_b(p_cmd)                                                ]]>
  </point>
  <point name="input.b.page2.xmdc003" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.b.page2.xmdc025" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                       ]]>
  </point>
  <point name="input.b.page2.xmdc026" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.b.page2.xmdc0272" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.b.page2.xmdc028" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.b.page2.xmdc029" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.b.page2.xmdc030" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.b.page2.xmdc031" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.b.page2.xmdc032" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.b.page2.xmdc033" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.b.page2.xmdc034" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.b.page2.xmdc036" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.b.page2.xmdc037" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.b.page2.xmdc038" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.b.page2.xmdc039" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.b.page3.xmdc012" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.b.page3.xmdc013" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.b.page4.xmja003" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="input.b.page4.xmja004" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            LET l_imaa005=''
            CALL adbt500_get_imaa005(g_enterprise,g_xmdc4_d[l_ac].xmja003) RETURNING l_imaa005

            IF NOT cl_null(l_imaa005) THEN
               IF l_cmd = 'a' AND cl_null(g_xmdc4_d[l_ac].xmja004) THEN
                  CALL g_inam.clear()
                  CALL s_feature_multi(g_xmdc4_d[l_ac].xmja003,'','',g_xmda_m.xmdasite,g_xmda_m.xmdadocno) RETURNING l_success,g_inam
                  LET g_xmdc4_d[l_ac].xmja004 = g_inam[1].inam002
                  LET g_xmdc4_d[l_ac].xmja012 = g_inam[1].inam004
                  CALL adbt500_xmja012_convert()
                  DISPLAY BY NAME g_xmdc4_d[l_ac].xmja004,g_xmdc4_d[l_ac].xmja014
               END IF
            END IF]]>
  </point>
  <point name="input.b.page4.xmja010" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            IF g_xmdc4_d[l_ac].xmja010 = 0 AND g_xmdc4_d[l_ac].xmja009 > 0 THEN
               LET g_xmdc4_d[l_ac].xmja010 = g_xmdc4_d[l_ac].xmja009
               CALL adbt500_get_xmja022()
            END IF]]>
  </point>
  <point name="input.b.page4.xmja011" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            CALL adbt500_set_entry_b(l_cmd)
            CALL adbt500_set_no_entry_b(l_cmd)]]>
  </point>
  <point name="input.b.page4.xmja015" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            CALL adbt500_set_no_required_b()
            CALL adbt500_set_required_b()]]>
  </point>
  <point name="input.b.page4.xmja017" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            CALL adbt500_set_no_required_b()
            CALL adbt500_set_required_b()]]>
  </point>
  <point name="input.b.page4.xmja024" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            CALL adbt500_set_entry_b(l_cmd)
            CALL adbt500_set_no_entry_b(l_cmd)]]>
  </point>
  <point name="input.b.xmda001" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.b.xmda002" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.b.xmda003" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.b.xmda004" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.b.xmda005" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.b.xmda006" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.b.xmda007" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.b.xmda008" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.b.xmda009" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.b.xmda010" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.b.xmda011" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.b.xmda012" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.b.xmda013" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.b.xmda015" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.b.xmda016" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.b.xmda017" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.b.xmda018" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.b.xmda019" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.b.xmda020" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.b.xmda021" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.b.xmda022" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.b.xmda023" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.b.xmda024" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.b.xmda025" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            LET l_pmaa027 = ''
            CALL adbt500_get_pmaa027(g_xmda_m.xmda022) RETURNING l_pmaa027                                                           ]]>
  </point>
  <point name="input.b.xmda026" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            LET l_pmaa027 = ''
            CALL adbt500_get_pmaa027(g_xmda_m.xmda021) RETURNING l_pmaa027                                                             ]]>
  </point>
  <point name="input.b.xmda027" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.b.xmda028" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.b.xmda030" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.b.xmda031" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.b.xmda032" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.b.xmda033" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.b.xmda034" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.b.xmda035" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.b.xmda036" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.b.xmda037" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                            IF cl_null(g_xmda_m.xmda020) THEN  #運輸類型 
               CALL cl_err('','axm-00085','1')   #請先輸入運輸方式   
               NEXT FIELD xmda020
            END IF               ]]>
  </point>
  <point name="input.b.xmda038" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.b.xmda039" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.b.xmda043" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.b.xmda044" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.b.xmda200" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            CALL adbt500_set_entry(p_cmd)
            CALL adbt500_set_no_entry(p_cmd)           ]]>
  </point>
  <point name="input.b.xmdadocdt" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.b.xmdadocno" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.b.xmdasite" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.b.xmdastus" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.before_dialog" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[         #新增時強制從單頭開始填
         IF p_cmd = 'a' THEN
            NEXT FIELD xmdasite
         ELSE
            CASE g_aw
               WHEN "s_detail1"
                  NEXT FIELD xmdcseq
               WHEN "s_detail3"
                  NEXT FIELD xmddseq
               WHEN "s_detail4"
                  NEXT FIELD xmjaseq
               WHEN "s_detail5"
                  NEXT FIELD xmdb001
               WHEN "s_detail6"
                  NEXT FIELD xrcdseq
               WHEN "s_detail7"
                  NEXT FIELD rtieseq
 
            END CASE
         END IF                                                ]]>
  </point>
  <point name="input.before_input" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                     LET g_flag = FALSE
   CALL adbt500_set_entry(p_cmd)
   CALL adbt500_set_no_entry(p_cmd)
]]>
  </point>
  <point name="input.body.a_delete" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[    ]]>
  </point>
  <point name="input.body.a_insert" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                          ]]>
  </point>
  <point name="input.body.a_insert2" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[         ]]>
  </point>
  <point name="input.body.a_update" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[               #單身修改後，需重新產生交期明細資料
               IF NOT s_adbt500_gen_xmdd(g_xmda_m.xmdadocno,g_xmdc_d[l_ac].xmdcseq) THEN
                  CALL cl_err("xmdd_t",SQLCA.sqlcode,1)
                  LET g_xmdc_d[l_ac].* = g_xmdc_d_t.*
                  CALL s_transaction_end('N','0')
               END IF                                                                                                                                       ]]>
  </point>
  <point name="input.body.after_delete" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.body.after_input" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.body.after_row" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.body.after_set_entry_b" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                          ]]>
  </point>
  <point name="input.body.b_a_insert" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #檢查單身單價不可小於等於零
               ]]>
  </point>
  <point name="input.body.b_delete" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                          ]]>
  </point>
  <point name="input.body.b_insert" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                          ]]>
  </point>
  <point name="input.body.b_update" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                          ]]>
  </point>
  <point name="input.body.before_insert" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[         ]]>
  </point>
  <point name="input.body.before_row" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                      ]]>
  </point>
  <point name="input.body.insert.after_set_entry_b" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.body.m_delete" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                          ]]>
  </point>
  <point name="input.body.m_update" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                          ]]>
  </point>
  <point name="input.body2.a_delete" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                                            ]]>
  </point>
  <point name="input.body2.a_insert" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                          ]]>
  </point>
  <point name="input.body2.a_update" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                          ]]>
  </point>
  <point name="input.body2.after_delete" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.body2.after_input" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.body2.after_insert" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                          ]]>
  </point>
  <point name="input.body2.after_row" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.body2.after_set_entry_b" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                          ]]>
  </point>
  <point name="input.body2.b_a_insert" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.body2.b_delete" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                          ]]>
  </point>
  <point name="input.body2.b_insert" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                          ]]>
  </point>
  <point name="input.body2.b_update" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                                         LET g_xmdc_d[l_ac].xmdc001 = g_xmdc2_d[l_ac].imaa001
               LET g_xmdc_d[l_ac].xmdc002 = g_xmdc2_d[l_ac].imaa005
               LET g_xmdc_d[l_ac].xmdc027 = g_xmdc2_d[l_ac].xmdc0272 ]]>
  </point>
  <point name="input.body2.before_input" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.body2.before_insert" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.body2.before_row" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.body2.insert.after_set_entry_b" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.body2.m_delete" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                          ]]>
  </point>
  <point name="input.body2.m_update" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                          ]]>
  </point>
  <point name="input.body3.a_delete" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                                            ]]>
  </point>
  <point name="input.body3.a_insert" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                          ]]>
  </point>
  <point name="input.body3.a_update" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                          ]]>
  </point>
  <point name="input.body3.after_delete" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.body3.after_input" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.body3.after_insert" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                          ]]>
  </point>
  <point name="input.body3.after_row" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.body3.after_set_entry_b" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                          ]]>
  </point>
  <point name="input.body3.b_a_insert" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.body3.b_delete" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                          ]]>
  </point>
  <point name="input.body3.b_insert" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                          ]]>
  </point>
  <point name="input.body3.b_update" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                          ]]>
  </point>
  <point name="input.body3.before_input" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.body3.before_insert" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.body3.before_row" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.body3.insert.after_set_entry_b" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.body3.m_delete" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                          ]]>
  </point>
  <point name="input.body3.m_update" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                          ]]>
  </point>
  <point name="input.body4.a_delete" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                  DELETE FROM xmdd_t 
                   WHERE xmddent = g_enterprise 
                     AND xmdddocno = g_xmda_m.xmdadocno 
                     AND xmddseq = g_xmdc4_d_t.xmjaseq
                  IF SQLCA.sqlcode THEN
                     CALL cl_err("xmdd_t",SQLCA.sqlcode,1)
                     CALL s_transaction_end('N','0')
                     CANCEL DELETE
                  END IF 
                  #刪除訂單多交期匯總檔
                  LET l_cnt = 0
                  SELECT COUNT(*) INTO l_cnt
                    FROM xmdf_t
                   WHERE xmdfent = g_enterprise 
                     AND xmdfdocno = g_xmda_m.xmdadocno 
                     AND xmdfseq = g_xmdc4_d_t.xmjaseq
                  IF l_cnt > 0 THEN                     
                     DELETE FROM xmdf_t 
                      WHERE xmdfent = g_enterprise 
                        AND xmdfdocno = g_xmda_m.xmdadocno 
                        AND xmdfseq = g_xmdc4_d_t.xmjaseq
                     IF SQLCA.sqlcode THEN
                        CALL cl_err("xmdf_t",SQLCA.sqlcode,1)
                        CALL s_transaction_end('N','0')
                        CANCEL DELETE
                     END IF           
                  END IF  
                  #刪除交易稅明細
                  LET l_cnt = 0
                  SELECT COUNT(*) INTO l_cnt
                    FROM xrcd_t
                   WHERE xrcdent = g_enterprise 
                     AND xrcddocno = g_xmda_m.xmdadocno 
                     AND xrcdseq = g_xmdc4_d_t.xmjaseq
                  IF l_cnt > 0 THEN                     
                     DELETE FROM xrcd_t 
                      WHERE xrcdent = g_enterprise 
                        AND xrcddocno = g_xmda_m.xmdadocno 
                        AND xrcdseq = g_xmdc4_d_t.xmjaseq
                     IF SQLCA.sqlcode THEN
                        CALL cl_err("xrcd_t",SQLCA.sqlcode,1)
                        CALL s_transaction_end('N','0')
                        CANCEL DELETE
                     END IF           
                  END IF 
                  #刪除訂單單身明細
                  LET l_cnt = 0
                  SELECT COUNT(*) INTO l_cnt
                    FROM xmdc_t
                   WHERE xmdcent = g_enterprise 
                     AND xmdcdocno = g_xmda_m.xmdadocno 
                     AND xmdcseq = g_xmdc4_d_t.xmjaseq
                  IF l_cnt > 0 THEN                     
                     DELETE FROM xmdc_t 
                      WHERE xmdcent = g_enterprise 
                        AND xmdcdocno = g_xmda_m.xmdadocno 
                        AND xmdcseq = g_xmdc4_d_t.xmjaseq
                     IF SQLCA.sqlcode THEN
                        CALL cl_err("xmdc_t",SQLCA.sqlcode,1)
                        CALL s_transaction_end('N','0')
                        CANCEL DELETE
                     END IF           
                  END IF
                  LET l_delete =TRUE]]>
  </point>
  <point name="input.body4.a_update" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[               CALL s_adbt500_gen_xmdc(g_xmda_m.xmdadocno,g_xmdc4_d[l_ac].xmjaseq) RETURNING l_success
               IF NOT l_success THEN
                  CALL cl_err("xmdc_t",SQLCA.sqlcode,1)
                  LET g_xmdc4_d[l_ac].* = g_xmdc4_d_t.*
                  CALL s_transaction_end('N','0')
               END IF
               IF NOT s_adbt500_gen_xmdd(g_xmda_m.xmdadocno,g_xmdc4_d[l_ac].xmjaseq) THEN
                  CALL cl_err("xmdd_t",SQLCA.sqlcode,1)
                  LET g_xmdc4_d[l_ac].* = g_xmdc4_d_t.*
                  CALL s_transaction_end('N','0')
               END IF 
               CALL adbt500_gen_xmdf(2) RETURNING l_success
               IF NOT l_success THEN
                  CALL cl_err("xmdf_t",SQLCA.sqlcode,1)
                  LET g_xmdc4_d[l_ac].* = g_xmdc4_d_t.*
                  CALL s_transaction_end('N','0')
               END IF ]]>
  </point>
  <point name="input.body4.after_insert" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[               #產生訂單單身
               LET l_success = TRUE
               CALL s_adbt500_gen_xmdc(g_xmda_m.xmdadocno,g_xmdc4_d[l_ac].xmjaseq) RETURNING l_success
               IF NOT l_success THEN
                  CALL cl_err("xmdc_t",SQLCA.sqlcode,1)       
                  CALL s_transaction_end('N','0')                    
                  CANCEL INSERT   
               END IF
               #產生交期明細
               LET l_success = TRUE
               CALL s_adbt500_gen_xmdd(g_xmda_m.xmdadocno,g_xmdc4_d[l_ac].xmjaseq) RETURNING l_success
               IF NOT l_success THEN
                  CALL cl_err("xmdd_t",SQLCA.sqlcode,1)       
                  CALL s_transaction_end('N','0')                    
                  CANCEL INSERT   
               END IF
               #產生產品特徵開窗的值到資料庫
               IF g_inam.getLength() > 1 THEN
                  LET l_success = TRUE
                  CALL adbt500_feature() RETURNING l_success
                  IF NOT l_success THEN
                     CALL s_transaction_end('N','0')
                     CANCEL INSERT
                  END IF
               END IF ]]>
  </point>
  <point name="input.body4.after_row" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            IF NOT INT_FLAG THEN
               LET l_ac = ARR_CURR()
               IF (l_cmd='u' AND l_delete = FALSE) OR (l_cmd='a' AND l_insert = FALSE) THEN
                  CALL adbt500_gen_xmdf(1) RETURNING l_success
                  IF NOT l_success THEN
                     CALL cl_err("xmdf_t",SQLCA.sqlcode,1)
                     LET g_xmdc4_d[l_ac].* = g_xmdc4_d_t.*
                     CALL s_transaction_end('N','0')
                  END IF
               END IF
            END IF]]>
  </point>
  <point name="input.body4.after_row2" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.body4.after_set_entry_b" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[               CALL adbt500_set_no_required_b()
               CALL adbt500_set_required_b()]]>
  </point>
  <point name="input.body4.b_a_insert" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            LET g_flag3 = FALSE
            #檢查單身交易價不可小於等於零
            IF cl_null(g_xmdc4_d[l_ac].xmja010) OR g_xmdc4_d[l_ac].xmja010 <= 0 THEN
               CALL cl_err(g_xmda_m.xmdadocno,'sub-00543',1)
               CANCEL INSERT
            END IF 
            #檢查單身稅別不可空白
            IF cl_null(g_xmdc4_d[l_ac].xmja006) THEN
               CALL cl_err(g_xmda_m.xmdadocno,'axm-00231',1)
               CANCEL INSERT
            END IF  ]]>
  </point>
  <point name="input.body4.b_delete" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="input.body4.before_input" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            IF g_xmda_m.xmda007 = '5' THEN
               SELECT COUNT(*)
                 INTO l_cnt
                 FROM xmja_t
                WHERE xmjaent = g_enterprise
                  AND xmjadocno = g_xmda_m.xmdadocno
               IF l_cnt = 0 THEN
                  IF cl_ask_confirm('axm-00013') THEN
                     CALL s_transaction_begin()
                     CALL s_adbt500_gen_detail(g_xmda_m.xmda007,g_xmda_m.xmda008,g_xmda_m.xmdadocno)
                        RETURNING l_success
                     IF l_success THEN
                        CALL s_transaction_end('Y','0')
                     ELSE
                        CALL s_transaction_end('N','0')
                     END IF
                  END IF
               END IF
               CALL adbt500_b_fill()
               LET g_rec_b = g_xmdc4_d.getLength()
            END IF]]>
  </point>
  <point name="input.body4.before_insert" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[        #    CALL s_transaction_begin()        
            LET g_xmdc4_d[l_ac].xmja001 = '1'
            LET g_xmdc4_d[l_ac].xmjasite = g_xmda_m.xmdasite
            CALL adbt500_xmjasite_ref()
            LET g_xmdc4_d[l_ac].xmjaunit = g_xmda_m.xmdasite
            LET g_xmdc4_d[l_ac].xmja004 =  ' '          
            LET g_xmdc4_d[l_ac].xmja007 = g_xmda_m.xmda012
            LET g_xmdc4_d[l_ac].xmja022 = 0
            LET g_xmdc4_d[l_ac].xmja005 = g_xmda_m.xmda204
            CALL adbt500_xmja005_ref()
   
            SELECT pmaa002,pmaa248
              INTO l_pmaa002,l_pmaa248
              FROM pmaa_t
             WHERE pmaaent = g_enterprise
               AND pmaa001 = g_xmda_m.xmda004
            IF l_pmaa002 <> '2' THEN
               LET g_xmdc4_d[l_ac].xmja025 = g_xmda_m.xmda022
               LET g_xmdc4_d[l_ac].xmja026 = g_xmda_m.xmda025
               LET g_xmdc4_d[l_ac].xmja027 = g_xmda_m.xmda206
            ELSE
               #經銷商帶出主合約
               DECLARE adbt500_stce001_cl CURSOR FOR
               SELECT stce001,stce005 
                 FROM stce_t
                WHERE stceent = g_enterprise
                  #AND stce008 = '1'
                  AND stce010 IS NULL
                  AND stce009 = g_xmda_m.xmda004
                  AND stce012 = g_xmda_m.xmda023
                  AND stce017 <= g_xmda_m.xmdadocdt
                  AND (stce018 IS NULL OR stce018 >= g_xmda_m.xmdadocdt)
                ORDER BY stce017 DESC
                OPEN adbt500_stce001_cl
                FETCH adbt500_stce001_cl INTO g_xmdc4_d[l_ac].xmja028,l_stce005
                CLOSE adbt500_stce001_cl
                IF l_pmaa248 = 'Y' AND l_stce005 = '13' THEN
                   CALL cl_err("", 'adb-00184', 1)
                   CALL FGL_SET_ARR_CURR(l_ac-1)
                   CALL g_xmdc4_d.deleteElement(l_ac)
                   NEXT FIELD xmjaseq
                END IF
            END IF
   
            #項次加1
            SELECT MAX(xmjaseq)+1 INTO g_xmdc4_d[l_ac].xmjaseq FROM xmja_t 
             WHERE xmjaent = g_enterprise AND xmjadocno = g_xmda_m.xmdadocno
            IF cl_null(g_xmdc4_d[l_ac].xmjaseq) THEN
               LET g_xmdc4_d[l_ac].xmjaseq = 1
            END IF
            
           #新增時，若稅別應用=1.正常稅率，則單身的稅別、稅率預設為單頭的稅別、稅率
            IF g_tax_app = '1' THEN
               LET g_xmdc4_d[l_ac].xmja006 = g_xmda_m.xmda011
               LET g_xmdc4_d[l_ac].xmja006_desc = g_xmda_m.xmda011_desc
               LET g_xmdc4_d[l_ac].xmja007 = g_xmda_m.xmda012
            END IF
            LET g_xmdc4_d_t.* = g_xmdc4_d[l_ac].*]]>
  </point>
  <point name="input.body4.before_row2" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            LET g_flag3 = FALSE
            LET l_delete =FALSE]]>
  </point>
  <point name="input.body4.insert.after_set_entry_b" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            LET g_flag3 = TRUE
            CALL adbt500_set_no_required_b()
            CALL adbt500_set_required_b()]]>
  </point>
  <point name="input.body5.action" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                      ]]>
  </point>
  <point name="input.body5.before_row" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.body6.action" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[      DISPLAY ARRAY g_xmdc7_d TO s_detail7.* ATTRIBUTES(COUNT=g_rec_b)  
    
         BEFORE ROW
            CALL adbt500_idx_chk()
            LET l_ac = DIALOG.getCurrentRow("s_detail7")
            LET g_detail_idx = l_ac
            
            
         BEFORE DISPLAY
            CALL FGL_SET_ARR_CURR(g_detail_idx)
            LET l_ac = DIALOG.getCurrentRow("s_detail7")
            CALL adbt500_idx_chk()
            LET g_current_page = 6
      
      END DISPLAY]]>
  </point>
  <point name="input.c.page1.imaal004" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.c.page1.xmdc001" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmdc_d[l_ac].xmdc001             #給予default值

            #給予arg
            LET l_sql = ''
            CALL s_control_get_sql("imaa001",'6','2',g_user,g_dept)     #銷售控制組檢核
              RETURNING l_success,l_sql
            IF l_success THEN
               LET g_qryparam.where = l_sql
            END IF

            LET l_sql = ''
            CALL s_control_get_doc_sql("imaf016",g_xmda_m.xmdadocno,'4')   #產品生命週期檢核
              RETURNING l_success,l_sql
            IF l_success THEN
               LET g_qryparam.where = g_qryparam.where ," AND ",l_sql
            END IF

            LET l_sql = ''
            CALL s_control_get_doc_sql("imaa009",g_xmda_m.xmdadocno,'5')   #產品料檢核
              RETURNING l_success,l_sql
            IF l_success THEN
               LET g_qryparam.where = g_qryparam.where ," AND ",l_sql
            END IF
            
            CALL q_imaa001()                                #呼叫開窗

            LET g_xmdc_d[l_ac].xmdc001 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmdc_d[l_ac].xmdc001 TO xmdc001              #顯示到畫面上

            NEXT FIELD xmdc001                          #返回原欄位

]]>
  </point>
  <point name="input.c.page1.xmdc002" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            LET l_imaa005 = ''
            CALL adbt500_get_imaa005(g_enterprise,g_xmdc_d[l_ac].xmdc001) RETURNING l_imaa005

            IF NOT cl_null(l_imaa005) THEN
               IF l_cmd = 'u' OR (l_cmd = 'a' AND NOT cl_null(g_xmdc_d[l_ac].xmdc002)) THEN
                  CALL s_feature_single(g_xmdc_d[l_ac].xmdc001,g_xmdc_d[l_ac].xmdc002,g_site,g_xmda_m.xmdadocno)
                       RETURNING l_success,g_xmdc_d[l_ac].xmdc002
                  #依交易對象、料號、產品特徵回傳客戶料號
                  CALL s_apmi070_get_pmao004(g_xmda_m.xmda004,g_xmdc_d[l_ac].xmdc001,g_xmdc_d[l_ac].xmdc002)
                    RETURNING r_success,l_pmao004
                  IF r_success THEN
                     LET g_xmdc_d[l_ac].xmdc027 = l_pmao004
                     DISPLAY BY NAME g_xmdc_d[l_ac].xmdc027
                  END IF                       
                  DISPLAY BY NAME g_xmdc_d[l_ac].xmdc002
               END IF
            END IF                                                                        ]]>
  </point>
  <point name="input.c.page1.xmdc004" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmdc_d[l_ac].xmdc004             #給予default值

            #給予arg
            LET g_qryparam.arg1 = '221' #

            CALL q_oocq002()                                #呼叫開窗

            LET g_xmdc_d[l_ac].xmdc004 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmdc_d[l_ac].xmdc004 TO xmdc004              #顯示到畫面上

            NEXT FIELD xmdc004                          #返回原欄位

]]>
  </point>
  <point name="input.c.page1.xmdc005" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.c.page1.xmdc006" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmdc_d[l_ac].xmdc006             #給予default值

            #給予arg

            CALL q_ooca001_1()                                #呼叫開窗

            LET g_xmdc_d[l_ac].xmdc006 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmdc_d[l_ac].xmdc006 TO xmdc006              #顯示到畫面上

            NEXT FIELD xmdc006                          #返回原欄位

]]>
  </point>
  <point name="input.c.page1.xmdc007" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.c.page1.xmdc008" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmdc_d[l_ac].xmdc008             #給予default值

            #給予arg

            CALL q_ooca001_1()                                #呼叫開窗

            LET g_xmdc_d[l_ac].xmdc008 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmdc_d[l_ac].xmdc008 TO xmdc008              #顯示到畫面上

            NEXT FIELD xmdc008                          #返回原欄位

]]>
  </point>
  <point name="input.c.page1.xmdc009" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.c.page1.xmdc010" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmdc_d[l_ac].xmdc010             #給予default值

            #給予arg

            CALL q_ooca001_1()                                #呼叫開窗

            LET g_xmdc_d[l_ac].xmdc010 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmdc_d[l_ac].xmdc010 TO xmdc010              #顯示到畫面上

            NEXT FIELD xmdc010                          #返回原欄位

]]>
  </point>
  <point name="input.c.page1.xmdc011" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.c.page1.xmdc012" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.c.page1.xmdc013" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.c.page1.xmdc015" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.c.page1.xmdc016" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmdc_d[l_ac].xmdc016             #給予default值
            LET g_qryparam.where = " oodb005 = '",g_oodb005,"'"
            #給予arg

            CALL q_oodb002_2()                                #呼叫開窗

            LET g_xmdc_d[l_ac].xmdc016 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmdc_d[l_ac].xmdc016 TO xmdc016              #顯示到畫面上

            NEXT FIELD xmdc016                          #返回原欄位

]]>
  </point>
  <point name="input.c.page1.xmdc019" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.c.page1.xmdc020" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.c.page1.xmdc021" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.c.page1.xmdc022" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.c.page1.xmdc023" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmdc_d[l_ac].xmdc023             #給予default值


            #給予arg
            LET g_qryparam.arg1 = g_xmda_m.xmda004

            CALL q_pmac002_5()                             #呼叫開窗

            LET g_xmdc_d[l_ac].xmdc023 = g_qryparam.return1              #將開窗取得的值回傳到變數
            #LET g_xmdc_d[l_ac].pmaal004 = g_qryparam.return2 #交易對象簡稱

            DISPLAY g_xmdc_d[l_ac].xmdc023 TO xmdc023              #顯示到畫面上
            #DISPLAY g_xmdc_d[l_ac].pmaal004 TO pmaal004 #交易對象簡稱

            NEXT FIELD xmdc023                          #返回原欄位

]]>
  </point>
  <point name="input.c.page1.xmdc024" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.c.page1.xmdc027" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmdc_d[l_ac].xmdc027             #給予default值

            IF cl_null(g_xmdc_d[l_ac].xmdc001) OR cl_null(g_xmdc_d[l_ac].xmdc002) THEN
               #給予arg
               LET g_qryparam.arg1 = g_xmda_m.xmda004 
               CALL q_pmao004_2()                                #呼叫開窗
            ELSE            
               #給予arg
               LET g_qryparam.arg1 = g_xmda_m.xmda004
               LET g_qryparam.arg2 = g_xmdc_d[l_ac].xmdc001
               LET g_qryparam.arg3 = g_xmdc_d[l_ac].xmdc002
               CALL q_pmao004_1()                                #呼叫開窗
            END IF
            LET g_xmdc_d[l_ac].xmdc027 = g_qryparam.return1              #將開窗取得的值回傳到變數
            DISPLAY g_xmdc_d[l_ac].xmdc027 TO xmdc027

            NEXT FIELD xmdc027                          #返回原欄位

]]>
  </point>
  <point name="input.c.page1.xmdc045" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.c.page1.xmdc049" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmdc_d[l_ac].xmdc049             #給予default值

            #給予arg
            LET g_qryparam.arg1 = g_acc

            CALL q_oocq002()                                #呼叫開窗

            LET g_xmdc_d[l_ac].xmdc049 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmdc_d[l_ac].xmdc049 TO xmdc049              #顯示到畫面上

            NEXT FIELD xmdc049                          #返回原欄位

]]>
  </point>
  <point name="input.c.page1.xmdc050" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.c.page1.xmdc052" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.c.page1.xmdc053" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmdc_d[l_ac].xmdc053             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "" #

            CALL q_oocq002()                                #呼叫開窗

            LET g_xmdc_d[l_ac].xmdc053 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmdc_d[l_ac].xmdc053 TO xmdc053              #顯示到畫面上

            NEXT FIELD xmdc053                          #返回原欄位

]]>
  </point>
  <point name="input.c.page1.xmdcorga" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmdc_d[l_ac].xmdcorga             #給予default值

            #給予arg

            CALL q_ooef001()                                #呼叫開窗

            LET g_xmdc_d[l_ac].xmdcorga = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmdc_d[l_ac].xmdcorga TO xmdcorga              #顯示到畫面上

            NEXT FIELD xmdcorga                          #返回原欄位

]]>
  </point>
  <point name="input.c.page1.xmdcseq" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.c.page1.xmdcunit" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmdc_d[l_ac].xmdcunit             #給予default值

            #給予arg

            CALL q_ooef001()                                #呼叫開窗

            LET g_xmdc_d[l_ac].xmdcunit = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmdc_d[l_ac].xmdcunit TO xmdcunit              #顯示到畫面上

            NEXT FIELD xmdcunit                          #返回原欄位

]]>
  </point>
  <point name="input.c.page1.xmja002" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmja_d[l_ac].xmja002             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "" #

            
            CALL q_imay003_6()                                #呼叫開窗

            LET g_xmja_d[l_ac].xmja002 = g_qryparam.return1              

            DISPLAY g_xmja_d[l_ac].xmja002 TO xmja002              #

            NEXT FIELD xmja002                          #返回原欄位

]]>
  </point>
  <point name="input.c.page1.xmja003" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmja_d[l_ac].xmja003             #給予default值
            LET g_qryparam.default2 = "" #g_xmja_d[l_ac].imaal003 #品名
            LET g_qryparam.default3 = "" #g_xmja_d[l_ac].imaal004 #規格
            #給予arg
            LET g_qryparam.arg1 = "" #

            
            CALL q_imaa001()                                #呼叫開窗

            LET g_xmja_d[l_ac].xmja003 = g_qryparam.return1              
            #LET g_xmja_d[l_ac].imaal003 = g_qryparam.return2 
            #LET g_xmja_d[l_ac].imaal004 = g_qryparam.return3 
            DISPLAY g_xmja_d[l_ac].xmja003 TO xmja003              #
            #DISPLAY g_xmja_d[l_ac].imaal003 TO imaal003 #品名
            #DISPLAY g_xmja_d[l_ac].imaal004 TO imaal004 #規格
            NEXT FIELD xmja003                          #返回原欄位

]]>
  </point>
  <point name="input.c.page1.xmja005" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmja_d[l_ac].xmja005             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "" #

            
            CALL q_prcf001_1()                                #呼叫開窗

            LET g_xmja_d[l_ac].xmja005 = g_qryparam.return1              

            DISPLAY g_xmja_d[l_ac].xmja005 TO xmja005              #

            NEXT FIELD xmja005                          #返回原欄位

]]>
  </point>
  <point name="input.c.page1.xmja006" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmja_d[l_ac].xmja006             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "" #

            
            CALL q_oodb002_2()                                #呼叫開窗

            LET g_xmja_d[l_ac].xmja006 = g_qryparam.return1              

            DISPLAY g_xmja_d[l_ac].xmja006 TO xmja006              #

            NEXT FIELD xmja006                          #返回原欄位

]]>
  </point>
  <point name="input.c.page1.xmja011" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmja_d[l_ac].xmja011             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "" #

            
            CALL q_ooca001_1()                                #呼叫開窗

            LET g_xmja_d[l_ac].xmja011 = g_qryparam.return1              

            DISPLAY g_xmja_d[l_ac].xmja011 TO xmja011              #

            NEXT FIELD xmja011                          #返回原欄位

]]>
  </point>
  <point name="input.c.page1.xmja013" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmja_d[l_ac].xmja013             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "" #

            
            CALL q_ooca001_1()                                #呼叫開窗

            LET g_xmja_d[l_ac].xmja013 = g_qryparam.return1              

            DISPLAY g_xmja_d[l_ac].xmja013 TO xmja013              #

            NEXT FIELD xmja013                          #返回原欄位

]]>
  </point>
  <point name="input.c.page1.xmja015" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmja_d[l_ac].xmja015             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "" #

            
            CALL q_ooca001_1()                                #呼叫開窗

            LET g_xmja_d[l_ac].xmja015 = g_qryparam.return1              

            DISPLAY g_xmja_d[l_ac].xmja015 TO xmja015              #

            NEXT FIELD xmja015                          #返回原欄位

]]>
  </point>
  <point name="input.c.page1.xmja017" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmja_d[l_ac].xmja017             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "" #

            
            CALL q_ooca001_1()                                #呼叫開窗

            LET g_xmja_d[l_ac].xmja017 = g_qryparam.return1              

            DISPLAY g_xmja_d[l_ac].xmja017 TO xmja017              #

            NEXT FIELD xmja017                          #返回原欄位

]]>
  </point>
  <point name="input.c.page1.xmja024" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmja_d[l_ac].xmja024             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "" #

            
            CALL q_pmaa001_18()                                #呼叫開窗

            LET g_xmja_d[l_ac].xmja024 = g_qryparam.return1              

            DISPLAY g_xmja_d[l_ac].xmja024 TO xmja024              #

            NEXT FIELD xmja024                          #返回原欄位

]]>
  </point>
  <point name="input.c.page1.xmja026" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmja_d[l_ac].xmja026             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "" #

            
            CALL q_oofb019()                                #呼叫開窗

            LET g_xmja_d[l_ac].xmja026 = g_qryparam.return1              

            DISPLAY g_xmja_d[l_ac].xmja026 TO xmja026              #

            NEXT FIELD xmja026                          #返回原欄位

]]>
  </point>
  <point name="input.c.page1.xmja033" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmja_d[l_ac].xmja033             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "" #
            LET g_qryparam.arg2 = "" #
            LET g_qryparam.arg3 = "" #
            
            CALL q_pmao004_1()                                #呼叫開窗

            LET g_xmja_d[l_ac].xmja033 = g_qryparam.return1              

            DISPLAY g_xmja_d[l_ac].xmja033 TO xmja033              #

            NEXT FIELD xmja033                          #返回原欄位

]]>
  </point>
  <point name="input.c.page2.xmda0272" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmdc2_d[l_ac].xmda0272             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "" #
            LET g_qryparam.arg2 = "" #
            LET g_qryparam.arg3 = "" #

            CALL q_pmao004_1()                                #呼叫開窗

            LET g_xmdc2_d[l_ac].xmda0272 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmdc2_d[l_ac].xmda0272 TO xmda0272              #顯示到畫面上

            NEXT FIELD xmda0272                          #返回原欄位

]]>
  </point>
  <point name="input.c.page2.xmdc003" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.c.page2.xmdc025" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="input.c.page2.xmdc026" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="input.c.page2.xmdc027" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmdc2_d[l_ac].xmdc027             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "" #
            LET g_qryparam.arg2 = "" #
            LET g_qryparam.arg3 = "" #

            CALL q_pmao004_1()                                #呼叫開窗

            LET g_xmdc2_d[l_ac].xmdc027 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmdc2_d[l_ac].xmdc027 TO xmdc027              #顯示到畫面上

            NEXT FIELD xmdc027                          #返回原欄位

]]>
  </point>
  <point name="input.c.page2.xmdc0272" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmdc2_d[l_ac].xmdc0272             #給予default值

            IF cl_null(g_xmdc_d[l_ac].xmdc001) OR cl_null(g_xmdc_d[l_ac].xmdc002) THEN
               #給予arg
               LET g_qryparam.arg1 = g_xmda_m.xmda004 
               CALL q_pmao004_2()                                #呼叫開窗
            ELSE            
               #給予arg
               LET g_qryparam.arg1 = g_xmda_m.xmda004
               LET g_qryparam.arg2 = g_xmdc_d[l_ac].xmdc001
               LET g_qryparam.arg3 = g_xmdc_d[l_ac].xmdc002
               CALL q_pmao004_1()                                #呼叫開窗
            END IF                               #呼叫開窗

            LET g_xmdc2_d[l_ac].xmdc0272 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmdc2_d[l_ac].xmdc0272 TO xmdc0272              #顯示到畫面上

            NEXT FIELD xmdc0272                          #返回原欄位

]]>
  </point>
  <point name="input.c.page2.xmdc028" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmdc2_d[l_ac].xmdc028             #給予default值

            #給予arg
            LET g_qryparam.arg1 = g_site #

            CALL q_inaa001_6()                                #呼叫開窗

            LET g_xmdc2_d[l_ac].xmdc028 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmdc2_d[l_ac].xmdc028 TO xmdc028              #顯示到畫面上

            NEXT FIELD xmdc028                          #返回原欄位

]]>
  </point>
  <point name="input.c.page2.xmdc029" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmdc2_d[l_ac].xmdc029             #給予default值

            #給予arg
            LET g_qryparam.arg1 = g_site #
            LET g_qryparam.arg2 = g_xmdc2_d[l_ac].xmdc028 #

            CALL q_inab002_6()                                #呼叫開窗

            LET g_xmdc2_d[l_ac].xmdc029 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmdc2_d[l_ac].xmdc029 TO xmdc029              #顯示到畫面上

            NEXT FIELD xmdc029                          #返回原欄位

]]>
  </point>
  <point name="input.c.page2.xmdc030" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.c.page2.xmdc031" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmdc2_d[l_ac].xmdc031            #給予default值

            #給予arg
            LET g_qryparam.arg1 = "263" #

            CALL q_oocq002()                                #呼叫開窗

            LET g_xmdc2_d[l_ac].xmdc031 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmdc2_d[l_ac].xmdc031 TO xmda031              #顯示到畫面上
            CALL adbt500_xmda020_ref(g_xmdc2_d[l_ac].xmdc031) RETURNING g_xmdc2_d[l_ac].xmdc031_desc
            DISPLAY BY NAME g_xmdc2_d[l_ac].xmdc031_desc                                                                        ]]>
  </point>
  <point name="input.c.page2.xmdc032" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.c.page2.xmdc033" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.c.page2.xmdc034" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.c.page2.xmdc036" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.c.page2.xmdc037" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.c.page2.xmdc038" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.c.page2.xmdc039" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.c.page3.xmdc012" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.c.page3.xmdc013" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.c.page3.xmdd001" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmdc3_d[l_ac].xmdd001             #給予default值

            #給予arg

            CALL q_imaa001()                                #呼叫開窗

            LET g_xmdc3_d[l_ac].xmdd001 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmdc3_d[l_ac].xmdd001 TO xmdd001              #顯示到畫面上

            NEXT FIELD xmdd001                          #返回原欄位

]]>
  </point>
  <point name="input.c.page3.xmdd004" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmdc3_d[l_ac].xmdd004             #給予default值

            #給予arg

            CALL q_ooca001_1()                                #呼叫開窗

            LET g_xmdc3_d[l_ac].xmdd004 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmdc3_d[l_ac].xmdd004 TO xmdd004              #顯示到畫面上

            NEXT FIELD xmdd004                          #返回原欄位

]]>
  </point>
  <point name="input.c.page3.xmdd017" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmdc3_d[l_ac].xmdd017             #給予default值

            #給予arg

            CALL q_oodb002_2()                                #呼叫開窗

            LET g_xmdc3_d[l_ac].xmdd017 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmdc3_d[l_ac].xmdd017 TO xmdd017              #顯示到畫面上

            NEXT FIELD xmdd017                          #返回原欄位

]]>
  </point>
  <point name="input.c.page3.xmdd022" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmdc3_d[l_ac].xmdd022             #給予default值

            #給予arg

            CALL q_ooag001()                                #呼叫開窗

            LET g_xmdc3_d[l_ac].xmdd022 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmdc3_d[l_ac].xmdd022 TO xmdd022              #顯示到畫面上

            NEXT FIELD xmdd022                          #返回原欄位

]]>
  </point>
  <point name="input.c.page3.xmdd024" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmdc3_d[l_ac].xmdd024             #給予default值

            #給予arg

            CALL q_ooca001_1()                                #呼叫開窗

            LET g_xmdc3_d[l_ac].xmdd024 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmdc3_d[l_ac].xmdd024 TO xmdd024              #顯示到畫面上

            NEXT FIELD xmdd024                          #返回原欄位

]]>
  </point>
  <point name="input.c.page3.xmdd026" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmdc3_d[l_ac].xmdd026             #給予default值

            #給予arg

            CALL q_ooca001_1()                                #呼叫開窗

            LET g_xmdc3_d[l_ac].xmdd026 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmdc3_d[l_ac].xmdd026 TO xmdd026              #顯示到畫面上

            NEXT FIELD xmdd026                          #返回原欄位

]]>
  </point>
  <point name="input.c.page4.xmdc027" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmja4_d[l_ac].xmdc027             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "" #
            LET g_qryparam.arg2 = "" #
            LET g_qryparam.arg3 = "" #
            
            CALL q_pmao004_1()                                #呼叫開窗

            LET g_xmja4_d[l_ac].xmdc027 = g_qryparam.return1              

            DISPLAY g_xmja4_d[l_ac].xmdc027 TO xmdc027              #

            NEXT FIELD xmdc027                          #返回原欄位

]]>
  </point>
  <point name="input.c.page4.xmde001" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmdc4_d[l_ac].xmde001             #給予default值

            #給予arg

            CALL q_imaa001()                                #呼叫開窗

            LET g_xmdc4_d[l_ac].xmde001 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmdc4_d[l_ac].xmde001 TO xmde001              #顯示到畫面上

            NEXT FIELD xmde001                          #返回原欄位

]]>
  </point>
  <point name="input.c.page4.xmde003" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmdc4_d[l_ac].xmde003             #給予default值

            #給予arg

            CALL q_xmdadocno()                                #呼叫開窗

            LET g_xmdc4_d[l_ac].xmde003 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmdc4_d[l_ac].xmde003 TO xmde003              #顯示到畫面上

            NEXT FIELD xmde003                          #返回原欄位

]]>
  </point>
  <point name="input.c.page4.xmde008" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmdc4_d[l_ac].xmde008             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "" #

            CALL q_oocq002()                                #呼叫開窗

            LET g_xmdc4_d[l_ac].xmde008 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmdc4_d[l_ac].xmde008 TO xmde008              #顯示到畫面上

            NEXT FIELD xmde008                          #返回原欄位

]]>
  </point>
  <point name="input.c.page4.xmde022" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmdc4_d[l_ac].xmde022             #給予default值

            #給予arg

            CALL q_ooca001_1()                                #呼叫開窗

            LET g_xmdc4_d[l_ac].xmde022 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmdc4_d[l_ac].xmde022 TO xmde022              #顯示到畫面上

            NEXT FIELD xmde022                          #返回原欄位

]]>
  </point>
  <point name="input.c.page4.xmja002" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmdc4_d[l_ac].xmja002             #給予default值

            #給予arg
            
            CALL q_imay003_6()                                #呼叫開窗

            LET g_xmdc4_d[l_ac].xmja002 = g_qryparam.return1              

            DISPLAY g_xmdc4_d[l_ac].xmja002 TO xmja002              #
            
            NEXT FIELD xmja002                          #返回原欄位

]]>
  </point>
  <point name="input.c.page4.xmja003" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmdc4_d[l_ac].xmja003             #給予default值
            LET g_qryparam.default2 = "" #g_xmdc4_d[l_ac].imaal003 #品名
            LET g_qryparam.default3 = "" #g_xmdc4_d[l_ac].imaal004 #規格
            #給予arg

            
            CALL q_imaa001()                                #呼叫開窗

            LET g_xmdc4_d[l_ac].xmja003 = g_qryparam.return1              
            #LET g_xmdc4_d[l_ac].imaal003 = g_qryparam.return2 
            #LET g_xmdc4_d[l_ac].imaal004 = g_qryparam.return3 
            DISPLAY g_xmdc4_d[l_ac].xmja003 TO xmja003              #
            #DISPLAY g_xmdc4_d[l_ac].imaal003 TO imaal003 #品名
            #DISPLAY g_xmdc4_d[l_ac].imaal004 TO imaal004 #規格
            CALL adbt500_xmja003_ref()
            NEXT FIELD xmja003                          #返回原欄位

]]>
  </point>
  <point name="input.c.page4.xmja004" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            LET l_imaa005 = ''
            CALL adbt500_get_imaa005(g_enterprise,g_xmdc4_d[l_ac].xmja003) RETURNING l_imaa005

            IF NOT cl_null(l_imaa005) THEN
               IF l_cmd = 'u' OR (l_cmd = 'a' AND NOT cl_null(g_xmdc4_d[l_ac].xmja004)) THEN
                  CALL s_feature_single(g_xmdc4_d[l_ac].xmja003,g_xmdc4_d[l_ac].xmja004,g_xmda_m.xmdasite,g_xmda_m.xmdadocno)
                       RETURNING l_success,g_xmdc4_d[l_ac].xmja004
                  #依交易對象、料號、產品特徵回傳客戶料號
                  CALL s_apmi070_get_pmao004(g_xmda_m.xmda004,g_xmdc4_d[l_ac].xmja003,g_xmdc4_d[l_ac].xmja004)
                    RETURNING r_success,l_pmao004
                  IF r_success THEN
                     LET g_xmdc4_d[l_ac].xmja033 = l_pmao004
                     DISPLAY BY NAME g_xmdc4_d[l_ac].xmja033
                  END IF                       
                  DISPLAY BY NAME g_xmdc4_d[l_ac].xmja004
               END IF
            END IF  ]]>
  </point>
  <point name="input.c.page4.xmja005" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmdc4_d[l_ac].xmja005             #給予default值

            #給予arg

            
            CALL q_prcf001_1()                                #呼叫開窗

            LET g_xmdc4_d[l_ac].xmja005 = g_qryparam.return1              

            DISPLAY g_xmdc4_d[l_ac].xmja005 TO xmja005              #
            CALL adbt500_xmja005_ref()
            NEXT FIELD xmja005                          #返回原欄位

]]>
  </point>
  <point name="input.c.page4.xmja006" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmdc4_d[l_ac].xmja006             #給予default值

            #給予arg
            
            CALL q_oodb002_2()                                #呼叫開窗

            LET g_xmdc4_d[l_ac].xmja006 = g_qryparam.return1              

            DISPLAY g_xmdc4_d[l_ac].xmja006 TO xmja006              #
            CALL adbt500_xmja006_ref()
            NEXT FIELD xmja006                          #返回原欄位

]]>
  </point>
  <point name="input.c.page4.xmja011" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmdc4_d[l_ac].xmja011             #給予default值

            #給予arg

            CALL q_ooca001_1()                                #呼叫開窗

            LET g_xmdc4_d[l_ac].xmja011 = g_qryparam.return1              

            DISPLAY g_xmdc4_d[l_ac].xmja011 TO xmja011              #
            CALL adbt500_xmja011_ref()
            NEXT FIELD xmja011                          #返回原欄位

]]>
  </point>
  <point name="input.c.page4.xmja013" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmdc4_d[l_ac].xmja013             #給予default值

            #給予arg

            CALL q_ooca001_1()                                #呼叫開窗

            LET g_xmdc4_d[l_ac].xmja013 = g_qryparam.return1              

            DISPLAY g_xmdc4_d[l_ac].xmja013 TO xmja013              #
            CALL adbt500_xmja013_ref()
            NEXT FIELD xmja013                          #返回原欄位

]]>
  </point>
  <point name="input.c.page4.xmja015" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmdc4_d[l_ac].xmja015             #給予default值

            #給予arg

            CALL q_ooca001_1()                                #呼叫開窗

            LET g_xmdc4_d[l_ac].xmja015 = g_qryparam.return1              

            DISPLAY g_xmdc4_d[l_ac].xmja015 TO xmja015              #
            CALL adbt500_xmja015_ref()
            NEXT FIELD xmja015                          #返回原欄位

]]>
  </point>
  <point name="input.c.page4.xmja017" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmdc4_d[l_ac].xmja017             #給予default值

            #給予arg
 
            CALL q_ooca001_1()                                #呼叫開窗

            LET g_xmdc4_d[l_ac].xmja017 = g_qryparam.return1              

            DISPLAY g_xmdc4_d[l_ac].xmja017 TO xmja017              #
            CALL adbt500_xmja017_ref()
            NEXT FIELD xmja017                          #返回原欄位

]]>
  </point>
  <point name="input.c.page4.xmja024" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmdc4_d[l_ac].xmja024             #給予default值

            #給予arg

            
            CALL q_pmaa001_18()                                #呼叫開窗

            LET g_xmdc4_d[l_ac].xmja024 = g_qryparam.return1              

            DISPLAY g_xmdc4_d[l_ac].xmja024 TO xmja024              #
            CALL adbt500_xmja024_ref()
            NEXT FIELD xmja024                          #返回原欄位

]]>
  </point>
  <point name="input.c.page4.xmja026" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmdc4_d[l_ac].xmja026             #給予default值
            
            #給予arg
            CALL adbt500_get_pmaa027(g_xmdc4_d[l_ac].xmja025) RETURNING l_pmaa027_1
            LET g_qryparam.arg1 = l_pmaa027_1

            
            CALL q_oofb019()                                #呼叫開窗

            LET g_xmdc4_d[l_ac].xmja026 = g_qryparam.return1              

            DISPLAY g_xmdc4_d[l_ac].xmja026 TO xmja026              #
            CALL adbt500_xmja026_ref()
            NEXT FIELD xmja026                          #返回原欄位

]]>
  </point>
  <point name="input.c.page4.xmja027" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmdc4_d[l_ac].xmja027             #給予default值

            #給予arg
            
            CALL q_dbad001()                                #呼叫開窗

            LET g_xmdc4_d[l_ac].xmja027 = g_qryparam.return1              

            DISPLAY g_xmdc4_d[l_ac].xmja027 TO xmja027              #
            CALL adbt500_xmja027_ref()
            NEXT FIELD xmja027                          #返回原欄位

]]>
  </point>
  <point name="input.c.page4.xmja033" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmdc4_d[l_ac].xmja033             #給予default值
            
            IF cl_null(g_xmdc4_d[l_ac].xmja003) OR cl_null(g_xmdc4_d[l_ac].xmja004) THEN
               #給予arg
               LET g_qryparam.arg1 = g_xmda_m.xmda004 
               CALL q_pmao004_2()                                #呼叫開窗
            ELSE  
               #給予arg
               LET g_qryparam.arg1 = g_xmda_m.xmda004
               LET g_qryparam.arg2 = g_xmdc4_d[l_ac].xmja003
               LET g_qryparam.arg3 = g_xmdc4_d[l_ac].xmja004
            
               CALL q_pmao004_1()                                #呼叫開窗
            END IF
            LET g_xmdc4_d[l_ac].xmja033 = g_qryparam.return1              

            DISPLAY g_xmdc4_d[l_ac].xmja033 TO xmja033              #

            NEXT FIELD xmja033                          #返回原欄位

]]>
  </point>
  <point name="input.c.page4.xmjasite" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmdc4_d[l_ac].xmjasite             #給予default值

            #給予arg
			   LET g_qryparam.arg1 = g_xmda_m.xmdasite
			   LET g_qryparam.arg2 = '2'
            
            CALL q_ooed004_3()                                #呼叫開窗

            LET g_xmdc4_d[l_ac].xmjasite = g_qryparam.return1              

            DISPLAY g_xmdc4_d[l_ac].xmjasite TO xmjasite              #
            CALL adbt500_xmjasite_ref()
            NEXT FIELD xmjasite                          #返回原欄位

]]>
  </point>
  <point name="input.c.page5.xmdb002" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmdc5_d[l_ac].xmdb002             #給予default值

            #給予arg
            LET g_qryparam.arg1 = g_xmda_m.xmda004

            CALL q_pmad002_3()                                #呼叫開窗

            LET g_xmdc5_d[l_ac].xmdb002 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmdc5_d[l_ac].xmdb002 TO xmdb002              #顯示到畫面上

            NEXT FIELD xmdb002                          #返回原欄位

]]>
  </point>
  <point name="input.c.page8.xmdc027" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmdc8_d[l_ac].xmdc027             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "" #
            LET g_qryparam.arg2 = "" #
            LET g_qryparam.arg3 = "" #
            
            CALL q_pmao004_1()                                #呼叫開窗

            LET g_xmdc8_d[l_ac].xmdc027 = g_qryparam.return1              

            DISPLAY g_xmdc8_d[l_ac].xmdc027 TO xmdc027              #

            NEXT FIELD xmdc027                          #返回原欄位

]]>
  </point>
  <point name="input.c.xmda001" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.c.xmda002" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmda_m.xmda002             #給予default值

            #給予arg

            CALL q_ooag001()                                #呼叫開窗

            LET g_xmda_m.xmda002 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmda_m.xmda002 TO xmda002              #顯示到畫面上

            NEXT FIELD xmda002                          #返回原欄位

]]>
  </point>
  <point name="input.c.xmda003" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmda_m.xmda003             #給予default值

            #給予arg
            LET g_qryparam.arg1 = g_xmda_m.xmdadocdt

            CALL q_ooeg001()                                #呼叫開窗

            LET g_xmda_m.xmda003 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmda_m.xmda003 TO xmda003              #顯示到畫面上

            NEXT FIELD xmda003                          #返回原欄位

]]>
  </point>
  <point name="input.c.xmda004" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE
            LET g_qryparam.where = "1=1 "            

            CALL s_control_get_sql("pmaa001",'2','2',g_user,g_dept)
                 RETURNING l_success,g_qryparam.where
            IF NOT l_success THEN
               LET g_qryparam.where = ''
            END IF            
            LET g_qryparam.default1 = g_xmda_m.xmda004             #給予default值

            #給予arg

            CALL q_pmaa001_6()                                #呼叫開窗

            LET g_xmda_m.xmda004 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmda_m.xmda004 TO xmda004              #顯示到畫面上

            NEXT FIELD xmda004                          #返回原欄位

]]>
  </point>
  <point name="input.c.xmda005" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.c.xmda006" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.c.xmda007" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.c.xmda008" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #開窗i段
		   	INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			   LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmda_m.xmda008             #給予default值


            #給予arg
            LET g_qryparam.arg1 = g_xmda_m.xmdasite
            LET g_qryparam.arg2 = '2'

            CALL q_xmdkdocno_4()                                #呼叫開窗

            LET g_xmda_m.xmda008 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmda_m.xmda008 TO xmda008              #顯示到畫面上

            NEXT FIELD xmda008                          #返回原欄位                                                            ]]>
  </point>
  <point name="input.c.xmda009" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmda_m.xmda009             #給予default值

            #給予arg
            LET g_qryparam.arg1 = g_xmda_m.xmda021

            CALL q_pmad002_3()                                 #呼叫開窗

            LET g_xmda_m.xmda009 = g_qryparam.return1          #將開窗取得的值回傳到變數

            DISPLAY g_xmda_m.xmda009 TO xmda009                #顯示到畫面上
            CALL adbt500_xmda009_ref(g_xmda_m.xmda009) RETURNING g_xmda_m.xmda009_desc
            DISPLAY BY NAME g_xmda_m.xmda009_desc
            NEXT FIELD xmda009                                 #返回原欄位
  
]]>
  </point>
  <point name="input.c.xmda010" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmda_m.xmda010             #給予default值

            #給予arg
			LET g_qryparam.arg1 = '238'
            CALL q_oocq002()                                #呼叫開窗

            LET g_xmda_m.xmda010 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmda_m.xmda010 TO xmda010              #顯示到畫面上
            CALL adbt500_xmda010_ref(g_xmda_m.xmda010) RETURNING g_xmda_m.xmda010_desc
            DISPLAY BY NAME g_xmda_m.xmda010_desc
            NEXT FIELD xmda010                          #返回原欄位

]]>
  </point>
  <point name="input.c.xmda011" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmda_m.xmda011             #給予default值

            #給予arg
            LET g_qryparam.arg1 = g_xmda_m.xmdasite

            CALL q_oodb002_3()                                #呼叫開窗

            LET g_xmda_m.xmda011 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmda_m.xmda011 TO xmda011              #顯示到畫面上
            CALL adbt500_xmda011_ref(g_xmda_m.xmda011) RETURNING g_xmda_m.xmda011_desc
            DISPLAY BY NAME g_xmda_m.xmda011_desc
            NEXT FIELD xmda011                          #返回原欄位

]]>
  </point>
  <point name="input.c.xmda012" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.c.xmda013" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.c.xmda015" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmda_m.xmda015             #給予default值

            #給予arg
            LET g_qryparam.arg1 = g_xmda_m.xmdasite
            CALL q_ooaj002_2()                                 #呼叫開窗

            LET g_xmda_m.xmda015 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmda_m.xmda015 TO xmda015              #顯示到畫面上
            CALL adbt500_xmda015_ref(g_xmda_m.xmda015) RETURNING g_xmda_m.xmda015_desc
            DISPLAY BY NAME g_xmda_m.xmda015_desc

            NEXT FIELD xmda015                          #返回原欄位

]]>
  </point>
  <point name="input.c.xmda016" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.c.xmda017" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmda_m.xmda017             #給予default值

            #給予arg

            CALL q_xmah001()                                #呼叫開窗

            LET g_xmda_m.xmda017 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmda_m.xmda017 TO xmda017              #顯示到畫面上

            NEXT FIELD xmda017                               #返回原欄位
            CALL adbt500_xmda017_ref(g_xmda_m.xmda017) RETURNING g_xmda_m.xmda017_desc
            DISPLAY BY NAME g_xmda_m.xmda017_desc
]]>
  </point>
  <point name="input.c.xmda018" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmda_m.xmda018             #給予default值

            #給予arg

            CALL q_ooid001_1()                                #呼叫開窗

            LET g_xmda_m.xmda018 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmda_m.xmda018 TO xmda018              #顯示到畫面上
            CALL adbt500_xmda018_ref(g_xmda_m.xmda018) RETURNING g_xmda_m.xmda018_desc
            DISPLAY BY NAME g_xmda_m.xmda018_desc
            NEXT FIELD xmda018                          #返回原欄位

]]>
  </point>
  <point name="input.c.xmda019" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.c.xmda020" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmda_m.xmda020             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "263" #

            CALL q_oocq002()                                #呼叫開窗

            LET g_xmda_m.xmda020 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmda_m.xmda020 TO xmda020              #顯示到畫面上
            CALL adbt500_xmda020_ref(g_xmda_m.xmda020) RETURNING g_xmda_m.xmda020_desc
            DISPLAY BY NAME g_xmda_m.xmda020_desc
            NEXT FIELD xmda020                          #返回原欄位

]]>
  </point>
  <point name="input.c.xmda021" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmda_m.xmda021             #給予default值


            #給予arg
            LET g_qryparam.arg1 = g_xmda_m.xmda004

            CALL q_pmac002_5()                                #呼叫開窗

            LET g_xmda_m.xmda021 = g_qryparam.return1              #將開窗取得的值回傳到變數
            #LET g_xmda_m.pmaal004 = g_qryparam.return2 #交易對象簡稱

            DISPLAY g_xmda_m.xmda021 TO xmda021              #顯示到畫面上
            #DISPLAY g_xmda_m.pmaal004 TO pmaal004 #交易對象簡稱

            NEXT FIELD xmda021                          #返回原欄位

]]>
  </point>
  <point name="input.c.xmda022" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmda_m.xmda022             #給予default值
            LET g_qryparam.default2 = ""                           #g_xmda_m.pmaal004 #交易對象簡稱

            #給予arg
            LET g_qryparam.arg1 = g_xmda_m.xmda004 #


            CALL q_pmac002_6()                                #呼叫開窗

            LET g_xmda_m.xmda022 = g_qryparam.return1              #將開窗取得的值回傳到變數
            #LET g_xmda_m.pmaal004 = g_qryparam.return2 #交易對象簡稱

            DISPLAY g_xmda_m.xmda022 TO xmda022              #顯示到畫面上
            #DISPLAY g_xmda_m.pmaal004 TO pmaal004 #交易對象簡稱

            NEXT FIELD xmda022                          #返回原欄位

]]>
  </point>
  <point name="input.c.xmda023" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        #此段落由子樣板a07產生            
            #開窗i段
			   INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			   LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmda_m.xmda023             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "1"
            CALL q_oojd001_1()                                #呼叫開窗

            LET g_xmda_m.xmda023 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmda_m.xmda023 TO xmda023              #顯示到畫面上
            CALL adbt500_xmda023_ref(g_xmda_m.xmda023) RETURNING g_xmda_m.xmda023_desc
            DISPLAY BY NAME g_xmda_m.xmda023_desc
            NEXT FIELD xmda023                          #返回原欄位

]]>
  </point>
  <point name="input.c.xmda024" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmda_m.xmda024             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "295"

            CALL q_oocq002()                                #呼叫開窗

            LET g_xmda_m.xmda024 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmda_m.xmda024 TO xmda024              #顯示到畫面上
            CALL adbt500_xmda024_ref(g_xmda_m.xmda024) RETURNING g_xmda_m.xmda024_desc
            DISPLAY BY NAME g_xmda_m.xmda024_desc
            NEXT FIELD xmda024                          #返回原欄位

]]>
  </point>
  <point name="input.c.xmda025" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmda_m.xmda025             #給予default值
            LET g_qryparam.where = " oofb008 = '3' "               #聯絡地址
            #給予arg
			   LET g_qryparam.arg1 = l_pmaa027
            CALL q_oofb019_1()                                     #呼叫開窗
            LET g_xmda_m.xmda025 = g_qryparam.return1              #將開窗取得的值回傳到變數
            DISPLAY g_xmda_m.xmda025 TO xmda025                    #顯示到畫面上
            CALL adbt500_xmda025_ref(l_pmaa027,g_xmda_m.xmda025) RETURNING g_xmda_m.xmda025_desc
            DISPLAY BY NAME g_xmda_m.xmda025_desc
            NEXT FIELD xmda025                                     #返回原欄位

]]>
  </point>
  <point name="input.c.xmda026" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_xmda_m.xmda026             #給予default值

            #給予arg
			LET g_qryparam.arg1 = l_pmaa027
            LET g_qryparam.where = " oofb008 = '5' "          #聯絡地址
            CALL q_oofb019_1()                                #呼叫開窗

            LET g_xmda_m.xmda026 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmda_m.xmda026 TO xmda026              #顯示到畫面上
            CALL adbt500_xmda026_ref(l_pmaa027,g_xmda_m.xmda026) RETURNING g_xmda_m.xmda026_desc
            DISPLAY BY NAME g_xmda_m.xmda026_desc
            NEXT FIELD xmda026                          #返回原欄位

]]>
  </point>
  <point name="input.c.xmda027" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmda_m.xmda027             #給予default值

            #給予arg
            LET g_qryparam.arg1 = g_xmda_m.xmda004 #

            CALL q_pmaj002()                                #呼叫開窗

            LET g_xmda_m.xmda027 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmda_m.xmda027 TO xmda027              #顯示到畫面上
            CALL adbt500_xmda027_ref(g_xmda_m.xmda027) RETURNING g_xmda_m.xmda027_desc
            DISPLAY BY NAME g_xmda_m.xmda027_desc
            NEXT FIELD xmda027                          #返回原欄位

]]>
  </point>
  <point name="input.c.xmda028" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.c.xmda030" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.c.xmda031" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.c.xmda032" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmda_m.xmda032             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "297"

            CALL q_oocq002()                                #呼叫開窗

            LET g_xmda_m.xmda032 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmda_m.xmda032 TO xmda032              #顯示到畫面上
            CALL adbt500_xmda032_ref(g_xmda_m.xmda032) RETURNING g_xmda_m.xmda032_desc
            DISPLAY BY NAME g_xmda_m.xmda032_desc
            NEXT FIELD xmda032                          #返回原欄位

]]>
  </point>
  <point name="input.c.xmda033" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.c.xmda034" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmda_m.xmda034             #給予default值
            CALL q_pmaa001_6()                                #呼叫開窗
            LET g_xmda_m.xmda034 = g_qryparam.return1              #將開窗取得的值回傳到變數
            DISPLAY g_xmda_m.xmda034 TO xmda034              #顯示到畫面上
            NEXT FIELD xmda034                          #返回原欄位

]]>
  </point>
  <point name="input.c.xmda035" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmda_m.xmda035             #給予default值


            #給予arg
            SELECT ooef019 INTO l_ooef019 FROM ooef_t WHERE ooefent = g_enterprise AND ooef001 = g_xmda_m.xmdasite
            LET g_qryparam.arg1 = l_ooef019 
            LET g_qryparam.arg2 = "2" 
            CALL q_isac002_1()                            #呼叫開窗

            LET g_xmda_m.xmda035 = g_qryparam.return1              #將開窗取得的值回傳到變數
            CALL adbt500_xmda035_ref(g_xmda_m.xmda035) RETURNING g_xmda_m.xmda035_desc
            DISPLAY BY NAME g_xmda_m.xmda035_desc           

            DISPLAY g_xmda_m.xmda035 TO xmda035              #顯示到畫面上
           

            NEXT FIELD xmda035                          #返回原欄位

]]>
  </point>
  <point name="input.c.xmda036" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmda_m.xmda036             #給予default值

            #給予arg

            CALL q_pmaa001_3()                                #呼叫開窗

            LET g_xmda_m.xmda036 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmda_m.xmda036 TO xmda036              #顯示到畫面上

            NEXT FIELD xmda036                          #返回原欄位

]]>
  </point>
  <point name="input.c.xmda037" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                    #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_xmda_m.xmda037

            IF NOT cl_null(g_xmda_m.xmda020) THEN
               SELECT oocq019 INTO l_oocq019
                 FROM oocq_t WHERE oocq001='263' AND oocq002= g_xmda_m.xmda020
            END IF

            IF NOT cl_null(l_oocq019) THEN  #運輸類型
               CASE
                  WHEN l_oocq019 ='1' OR l_oocq019='4'
                     CALL q_oock004()

                  WHEN l_oocq019 ='2'
                     CALL q_oocq002_10()

                  WHEN l_oocq019 ='3'
                     CALL q_oocq002_12()

               END CASE
            END IF


            LET g_xmda_m.xmda037 = g_qryparam.return1              #將開窗取得的值回傳到變數       
            DISPLAY g_xmda_m.xmda037 TO xmda037
            NEXT FIELD xmda037                  ]]>
  </point>
  <point name="input.c.xmda038" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                    #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_xmda_m.xmda038

            IF NOT cl_null(g_xmda_m.xmda020) THEN
               SELECT oocq019 INTO l_oocq019
                 FROM oocq_t WHERE oocq001='263' AND oocq002= g_xmda_m.xmda020
            END IF

            IF NOT cl_null(l_oocq019) THEN  #運輸類型
               CASE
                  WHEN l_oocq019 ='1' OR l_oocq019='4'
                     CALL q_oock004()

                  WHEN l_oocq019 ='2'
                     CALL q_oocq002_10()

                  WHEN l_oocq019 ='3'
                     CALL q_oocq002_12()

               END CASE
            END IF


            LET g_xmda_m.xmda038 = g_qryparam.return1              #將開窗取得的值回傳到變數       
            DISPLAY g_xmda_m.xmda038 TO xmda038
            NEXT FIELD xmda038           ]]>
  </point>
  <point name="input.c.xmda039" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.c.xmda043" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.c.xmda044" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmda_m.xmda044             #給予default值

            #給予arg
            LET g_qryparam.arg1 = g_xmda_m.xmda004 #

            CALL q_itcf002()                                       #呼叫開窗

            LET g_xmda_m.xmda044 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmda_m.xmda044 TO xmda044              #顯示到畫面上

            NEXT FIELD xmda044                          #返回原欄位

]]>
  </point>
  <point name="input.c.xmda200" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmda_m.xmda200             #給予default值

            #給予arg

            CALL q_pmaa001_20()                                #呼叫開窗

            LET g_xmda_m.xmda200 = g_qryparam.return1              

            DISPLAY g_xmda_m.xmda200 TO xmda200              #
            CALL adbt500_xmda200_ref()
            NEXT FIELD xmda200                          #返回原欄位

]]>
  </point>
  <point name="input.c.xmda201" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmda_m.xmda201             #給予default值

            #給予arg
            
            CALL q_pmaa001_10()                                #呼叫開窗

            LET g_xmda_m.xmda201 = g_qryparam.return1              

            DISPLAY g_xmda_m.xmda201 TO xmda201              #
            CALL adbt500_xmda201_ref()
            NEXT FIELD xmda201                          #返回原欄位

]]>
  </point>
  <point name="input.c.xmda202" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmda_m.xmda202             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "G" #

            
            CALL q_ooef001_3()                                #呼叫開窗

            LET g_xmda_m.xmda202 = g_qryparam.return1              

            DISPLAY g_xmda_m.xmda202 TO xmda202              #
            CALL adbt500_xmda202_ref()
            NEXT FIELD xmda202                          #返回原欄位

]]>
  </point>
  <point name="input.c.xmda203" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmda_m.xmda203             #給予default值
            LET g_qryparam.default2 = "" #g_xmda_m.pmaal004 #交易對象簡稱
            #給予arg
            LET g_qryparam.arg1 = g_xmda_m.xmda004
            LET g_qryparam.arg2 = '3'
            
            CALL q_pmac002_9()                                #呼叫開窗

            LET g_xmda_m.xmda203 = g_qryparam.return1              
            #LET g_xmda_m.pmaal004 = g_qryparam.return2 
            DISPLAY g_xmda_m.xmda203 TO xmda203              #
            #DISPLAY g_xmda_m.pmaal004 TO pmaal004 #交易對象簡稱
            CALL adbt500_xmda203_ref()
            NEXT FIELD xmda203                          #返回原欄位

]]>
  </point>
  <point name="input.c.xmda204" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmda_m.xmda204             #給予default值

            #給予arg
            
            CALL q_prcf001_1()                                #呼叫開窗

            LET g_xmda_m.xmda204 = g_qryparam.return1              

            DISPLAY g_xmda_m.xmda204 TO xmda204              #
            CALL adbt500_xmda204_ref()
            NEXT FIELD xmda204                          #返回原欄位

]]>
  </point>
  <point name="input.c.xmdadocdt" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.c.xmdadocno" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmda_m.xmdadocno             #給予default值

            #給予arg
            LET l_ooef004 = ''
            SELECT ooef004 INTO l_ooef004 FROM ooef_t WHERE ooefent = g_enterprise AND ooef001 = g_xmda_m.xmdasite
            LET g_qryparam.arg1 = l_ooef004
            LET g_qryparam.arg2 = g_prog

            CALL q_ooba002_1()                                #呼叫開窗

            LET g_xmda_m.xmdadocno = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmda_m.xmdadocno TO xmdadocno              #顯示到畫面上
            CALL adbt500_xmdadocno_ref()
            NEXT FIELD xmdadocno                          #返回原欄位

]]>
  </point>
  <point name="input.c.xmdasite" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #開窗i段
			   INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			   LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmda_m.xmdasite             #給予default值

            #給予arg
            LET g_qryparam.arg1 = g_site
            LET g_qryparam.arg2 = '2'

            CALL q_ooed004_3()                                #呼叫開窗

            LET g_xmda_m.xmdasite = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmda_m.xmdasite TO xmdasite              #顯示到畫面上
            CALL adbt500_xmdasite_ref()
            NEXT FIELD xmdasite                          #返回原欄位                                                           ]]>
  </point>
  <point name="input.c.xmdastus" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.c.xmdaunit" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmda_m.xmdaunit             #給予default值

            #給予arg
            LET g_qryparam.arg1 = '2'
            
            CALL q_ooed004_2()                                #呼叫開窗

            LET g_xmda_m.xmdaunit = g_qryparam.return1              

            DISPLAY g_xmda_m.xmdaunit TO xmdaunit              #
            CALL adbt500_xmdaunit_ref()
            NEXT FIELD xmdaunit                          #返回原欄位

]]>
  </point>
  <point name="input.d.before_input" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            RETURN                                                         ]]>
  </point>
  <point name="input.define" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[   DEFINE  l_success    LIKE type_t.num5
   DEFINE  l_flag       LIKE type_t.num5
   DEFINE  l_rate       LIKE inaj_t.inaj014
   DEFINE  l_sql        STRING
   DEFINE  l_sql1       STRING
   DEFINE  l_sql2       STRING             
   DEFINE  l_ooef004    LIKE ooef_t.ooef004
   DEFINE  l_ooef016    LIKE ooef_t.ooef016
   DEFINE  l_pmaa004    LIKE pmaa_t.pmaa004 
   DEFINE  l_pmaa027    LIKE pmaa_t.pmaa027 
   DEFINE  l_pmaa027_1  LIKE pmaa_t.pmaa027 
   DEFINE  l_pmaa002    LIKE pmaa_t.pmaa002
   DEFINE  l_oocq019    LIKE oocq_t.oocq019   
   DEFINE  l_xmah004    LIKE xmah_t.xmah004
   DEFINE  l_xmah005    LIKE xmah_t.xmah005
   DEFINE  l_xmah006    LIKE xmah_t.xmah006   
   DEFINE  l_pmao002    LIKE pmao_t.pmao002
   DEFINE  l_pmao003    LIKE pmao_t.pmao003 
   DEFINE  l_pmao004    LIKE pmao_t.pmao004 
   DEFINE  l_imaf062    LIKE imaf_t.imaf062 
   DEFINE  l_xrcd113    LIKE xrcd_t.xrcd113
   DEFINE  l_xrcd114    LIKE xrcd_t.xrcd114
   DEFINE  l_xrcd115    LIKE xrcd_t.xrcd115   
   DEFINE  r_success    LIKE type_t.num5 
   DEFINE  r_address    STRING     
   DEFINE  l_imaa005    LIKE imaa_t.imaa005
   DEFINE  l_oodbl004   LIKE oodbl_t.oodbl004  #稅別名稱
   DEFINE  l_oodb005    LIKE oodb_t.oodb005    #含稅否
   DEFINE  l_oodb006    LIKE oodb_t.oodb006    #稅率 
   DEFINE  l_oodb011    LIKE oodb_t.oodb011    #取得稅別類型1:正常稅率2:依料件設定   
   DEFINE  l_imaa143    LIKE imaa_t.imaa143
   DEFINE  l_ooef019    LIKE ooef_t.ooef019
   DEFINE  l_delete     LIKE type_t.num5
   DEFINE l_slip        LIKE ooba_t.ooba001
   DEFINE l_para_data   LIKE type_t.chr80
   DEFINE l_pmaa248     LIKE pmaa_t.pmaa248
   DEFINE l_stce005     LIKE stce_t.stce005]]>
  </point>
  <point name="input.define_sql" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                  ]]>
  </point>
  <point name="input.define_sql2" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                  ]]>
  </point>
  <point name="input.define_sql3" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                  ]]>
  </point>
  <point name="input.g.page1.imaal004" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.g.page1.xmdc001" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.g.page1.xmdc002" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.g.page1.xmdc004" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.g.page1.xmdc005" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.g.page1.xmdc006" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.g.page1.xmdc007" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.g.page1.xmdc008" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.g.page1.xmdc009" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.g.page1.xmdc010" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.g.page1.xmdc011" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.g.page1.xmdc012" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.g.page1.xmdc013" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.g.page1.xmdc015" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.g.page1.xmdc016" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.g.page1.xmdc019" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.g.page1.xmdc020" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.g.page1.xmdc021" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.g.page1.xmdc022" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.g.page1.xmdc023" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.g.page1.xmdc024" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                         ]]>
  </point>
  <point name="input.g.page1.xmdc027" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.g.page1.xmdc045" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.g.page1.xmdc049" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.g.page1.xmdc050" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.g.page1.xmdc052" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.g.page1.xmdcorga" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.g.page1.xmdcseq" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.g.page1.xmdcunit" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.g.page2.xmdc003" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.g.page2.xmdc025" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.g.page2.xmdc026" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.g.page2.xmdc0272" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.g.page2.xmdc028" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.g.page2.xmdc029" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.g.page2.xmdc030" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.g.page2.xmdc031" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.g.page2.xmdc032" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.g.page2.xmdc033" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.g.page2.xmdc034" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.g.page2.xmdc036" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.g.page2.xmdc037" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.g.page2.xmdc038" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.g.page2.xmdc039" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.g.page3.xmdc012" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.g.page3.xmdc013" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.g.page4.xmja002" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="input.g.xmda001" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.g.xmda002" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.g.xmda003" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.g.xmda004" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.g.xmda005" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            CALL adbt500_set_entry(p_cmd)
            CALL adbt500_set_no_entry(p_cmd)          ]]>
  </point>
  <point name="input.g.xmda006" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.g.xmda007" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.g.xmda008" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.g.xmda009" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.g.xmda010" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.g.xmda011" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.g.xmda012" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.g.xmda013" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.g.xmda015" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.g.xmda016" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.g.xmda017" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.g.xmda018" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.g.xmda019" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.g.xmda020" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.g.xmda021" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.g.xmda022" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.g.xmda023" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.g.xmda024" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.g.xmda025" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.g.xmda026" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.g.xmda027" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.g.xmda028" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.g.xmda030" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.g.xmda031" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.g.xmda032" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.g.xmda033" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.g.xmda034" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.g.xmda035" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.g.xmda036" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.g.xmda037" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.g.xmda038" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.g.xmda039" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.g.xmda043" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.g.xmda044" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.g.xmdadocdt" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.g.xmdadocno" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.g.xmdasite" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.g.xmdastus" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.head.a_insert" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                          ]]>
  </point>
  <point name="input.head.a_update" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                          ]]>
  </point>
  <point name="input.head.b_insert" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[               CALL s_aooi200_gen_docno(g_xmda_m.xmdasite,g_xmda_m.xmdadocno,g_xmda_m.xmdadocdt,g_prog) RETURNING l_success,g_xmda_m.xmdadocno 
               IF NOT l_success THEN
                  CALL s_transaction_end('N','0')
                  CALL cl_err(g_xmda_m.xmdadocno,'apm-00003',1)
                  NEXT FIELD xmdodocno
                  CONTINUE DIALOG
               END IF 
               DISPLAY BY NAME g_xmda_m.xmdadocno               ]]>
  </point>
  <point name="input.head.b_update" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                          ]]>
  </point>
  <point name="input.head.m_insert" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                          ]]>
  </point>
  <point name="input.head.m_update" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[               IF g_xmda_m.xmda022 <> g_xmda_m_t.xmda022 THEN
                  CALL adbt500_change_xmda022()
               END IF                                                                            ]]>
  </point>
  <point name="input.m.before_input" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="input.more_input" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                    ]]>
  </point>
  <point name="input.other_sql" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[   IF p_cmd = 'u' THEN   
      #客戶慣用銷售分類          
      SELECT pmab089 INTO g_pmab089 FROM pmab_t
       WHERE pmabent = g_enterprise
         AND pmabsite= g_xmda_m.xmdasite
         AND pmab001 = g_xmda_m.xmda004
      #取得稅別類型
      LET g_tax_app = ''
      CALL s_tax_chk(g_xmda_m.xmdasite,g_xmda_m.xmda011)
        RETURNING l_success,g_oodbl004,g_oodb005,g_oodb006,g_tax_app
     
      #取得是否可修改單價
      CALL adbt500_get_xmdc015()
   END IF 
   LET g_flag2 = FALSE]]>
  </point>
  <point name="insert.after_insert" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                    ]]>
  </point>
  <point name="insert.default" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[      #axmt500-16
      INITIALIZE g_xmda_m_t.* TO NULL
      LET g_xmda_m.xmdadocdt = g_today
      LET g_xmda_m.xmda002 = g_user
      LET g_xmda_m.xmdasite = g_site
      LET g_xmda_m_o.* = g_xmda_m.*              #舊值備份      
      CALL adbt500_xmda002_ref(g_xmda_m.xmda002) RETURNING g_xmda_m.xmda002_desc
      DISPLAY BY NAME g_xmda_m.xmda002_desc      
      LET g_xmda_m.xmda003 = g_dept
      CALL adbt500_xmda003_ref(g_xmda_m.xmda003) RETURNING g_xmda_m.xmda003_desc
      DISPLAY BY NAME g_xmda_m.xmda003_desc
      #預設單據的單別 
      LET l_success = ''
      LET l_doctype = ''
      CALL s_arti200_get_def_doc_type(g_xmda_m.xmdasite,g_prog,'1')
           RETURNING l_success, l_doctype
      LET g_xmda_m.xmdadocno = l_doctype]]>
  </point>
  <point name="insert.define" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[   DEFINE l_success     LIKE type_t.num5
   DEFINE l_doctype     LIKE rtai_t.rtai004             ]]>
  </point>
  <point name="insert_b.after_insert" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                    ]]>
  </point>
  <point name="insert_b.after_insert2" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                    ]]>
  </point>
  <point name="insert_b.after_insert3" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                    ]]>
  </point>
  <point name="insert_b.before_insert" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                    ]]>
  </point>
  <point name="insert_b.before_insert2" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                    ]]>
  </point>
  <point name="insert_b.before_insert3" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                    ]]>
  </point>
  <point name="insert_b.define" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                  ]]>
  </point>
  <point name="insert_b.m_insert" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                    ]]>
  </point>
  <point name="insert_b.m_insert2" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                    ]]>
  </point>
  <point name="insert_b.m_insert3" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                    ]]>
  </point>
  <point name="insert_b.other" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                  ]]>
  </point>
  <point name="lock_b.define" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                  ]]>
  </point>
  <point name="lock_b.other" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                  ]]>
  </point>
  <point name="main.after_define_sql" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                  ]]>
  </point>
  <point name="main.before_close" order="" ver="3" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[      CALL s_get_price_adb_drop_tab() RETURNING l_success            ]]>
  </point>
  <point name="main.define" order="" ver="3" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[   DEFINE l_success      LIKE type_t.num5       ]]>
  </point>
  <point name="main.define_sql" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                  ]]>
  </point>
  <point name="main.exit" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                  ]]>
  </point>
  <point name="main.init" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[   #獲取當前營運據點的聯絡對象識別碼
   LET g_oofa001 = ''
   SELECT oofa001 INTO g_oofa001 FROM oofa_t WHERE oofaent = g_enterprise AND oofa002 = '1' AND oofa003 = g_site
   
   #獲得當前營運據點的所屬稅區
   LET g_ooef019 = ''
   SELECT ooef019 INTO g_ooef019 FROM ooef_t WHERE ooefent = g_enterprise AND ooef001 = g_site

   LET g_acc = ''
   #抓取[T:系統分類值檔].[C:系統分類碼]=24且[T:系統分類值檔].[C:系統分類碼]=g_prog 的[T:系統分類值檔].[C:參考欄位>
   SELECT gzcb004 INTO g_acc FROM gzcb_t WHERE gzcb001 = '24' AND gzcb002 = g_prog
   
   LET g_flag1 = FALSE
   ]]>
  </point>
  <point name="main.servicecall" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                    ]]>
  </point>
  <point name="menu.default.insert" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="menu.delete" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                          ]]>
  </point>
  <point name="menu.detail_show.page3.adbt500_04" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[               IF l_ac > 0 THEN
                  CALL adbt500_04(g_xmda_m.xmdadocno,g_xmdc4_d[l_ac].xmjaseq,g_xmdc4_d[l_ac].xmjasite)
               END IF]]>
  </point>
  <point name="menu.detail_show.page3.open_adbt500_03" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[               IF l_ac > 0 THEN
                  IF NOT cl_null(g_xmdc4_d[l_ac].xmjaseq) THEN
                     CALL adbt500_03(g_xmda_m.xmdadocno,g_xmdc4_d[l_ac].xmjaseq,g_xmdc4_d[l_ac].xmja018,g_xmdc4_d[l_ac].xmja030,g_xmdc4_d[l_ac].xmjasite)
                     RETURNING g_xmdc4_d[l_ac].xmja031,g_xmdc4_d[l_ac].xmja032
                     DISPLAY BY NAME g_xmdc4_d[l_ac].xmja031,g_xmdc4_d[l_ac].xmja032
                     IF NOT cl_null(g_xmdc4_d[l_ac].xmja031) AND NOT cl_null(g_xmdc4_d[l_ac].xmja032) THEN
                        UPDATE xmja_t
                           SET xmja031 = g_xmdc4_d[l_ac].xmja031,
                               xmja032 = g_xmdc4_d[l_ac].xmja032
                         WHERE xmjaent = g_enterprise
                           AND xmjadocno = g_xmda_m.xmdadocno
                           AND xmjaseq = g_xmdc4_d[l_ac].xmjaseq
                     END IF
                     CALL s_adbt500_gen_xmdd(g_xmda_m.xmdadocno,g_xmdc4_d[l_ac].xmjaseq) RETURNING l_success 
                  END IF
               END IF]]>
  </point>
  <point name="menu.insert" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                          ]]>
  </point>
  <point name="menu.modify" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                          ]]>
  </point>
  <point name="menu.modify_detail" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                          ]]>
  </point>
  <point name="menu.open_adbt500_02" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[               CALL adbt500_02(g_xmda_m.xmdadocno)]]>
  </point>
  <point name="menu.open_apmi004_01" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[               #若輸入供應商的法人類型為'2:一次性交易'或是'4:內部員工'時，則自動串apmi004_01
               #維護一次性交易對項基本資料，維護完基本資料後會回傳一個一次性交易對象識別碼，
               #將識別碼值預設給xmda028欄位
               IF NOT cl_null(g_xmda_m.xmda004) THEN
                  LET l_pmaa004 = ''
                  SELECT pmaa004 INTO l_pmaa004 FROM pmaa_t WHERE pmaaent = g_enterprise AND pmaa001 = g_xmda_m.xmda004
                  IF l_pmaa004 = '2' THEN   #一次性交易對象
                     CALL apmi004_01('1','',g_xmda_m.xmda004,g_xmda_m.xmdadocno) RETURNING g_xmda_m.xmda028
                  END IF
                  IF l_pmaa004 = '4' THEN   #內部員工
                     CALL apmi004_01('2','',g_xmda_m.xmda004,g_xmda_m.xmdadocno) RETURNING g_xmda_m.xmda028
                  END IF                      
               END IF   ]]>
  </point>
  <point name="menu.open_s_pay" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[               DECLARE adbt500_pay_cl1 CURSOR FOR
               SELECT rtiadocno 
                 FROM rtia_t
                WHERE rtiaent = g_enterprise
                  AND rtia007 = g_xmda_m.xmdadocno
                  AND rtiastus <> 'X'
               OPEN adbt500_pay_cl1
               FETCH adbt500_pay_cl1 INTO l_rtiadocno
               CLOSE adbt500_pay_cl1
               IF NOT cl_null(l_rtiadocno) THEN
                  CALL s_pay(l_rtiadocno)
                  LET g_action_choice= ""
               END IF]]>
  </point>
  <point name="menu.open_s_pay09" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[               DECLARE adbt500_pay_cl2 CURSOR FOR
               SELECT rtiadocno 
                 FROM rtia_t
                WHERE rtiaent = g_enterprise
                  AND rtia007 = g_xmda_m.xmdadocno
                  AND rtiastus <> 'X'
               OPEN adbt500_pay_cl2
               FETCH adbt500_pay_cl2 INTO l_rtiadocno
               CLOSE adbt500_pay_cl2
               IF NOT cl_null(l_rtiadocno) THEN
                  CALL s_pay_09(l_rtiadocno)
                  LET g_action_choice= ""
               END IF]]>
  </point>
  <point name="menu.open_xmdb" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[               CALL adbt500_open_xmdb()
               LET INT_FLAG = FALSE]]>
  </point>
  <point name="menu.output" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                          ]]>
  </point>
  <point name="menu.query" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                          ]]>
  </point>
  <point name="menu.reproduce" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                          ]]>
  </point>
  <point name="modify.after_input" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                    ]]>
  </point>
  <point name="modify.before_input" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[      LET g_xmda_m_o.* = g_xmda_m.*  #舊值備份
      #「D抽單 / R已拒絕」狀況碼更改資料後，需還原為「N未確認」
      IF g_xmda_m.xmdastus MATCHES "[DR]" THEN 
         LET g_xmda_m.xmdastus = "N"
      END IF
]]>
  </point>
  <point name="modify.body.a_fk_update" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                      ]]>
  </point>
  <point name="modify.body.a_fk_update2" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                      ]]>
  </point>
  <point name="modify.body.a_fk_update3" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                      ]]>
  </point>
  <point name="modify.body.b_fk_update" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                      ]]>
  </point>
  <point name="modify.body.b_fk_update2" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                      ]]>
  </point>
  <point name="modify.body.b_fk_update3" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                      ]]>
  </point>
  <point name="modify.body.m_fk_update" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                      ]]>
  </point>
  <point name="modify.body.m_fk_update2" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                      ]]>
  </point>
  <point name="modify.body.m_fk_update3" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                      ]]>
  </point>
  <point name="modify.define" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                  ]]>
  </point>
  <point name="query.define" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                  ]]>
  </point>
  <point name="query.other" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                  ]]>
  </point>
  <point name="reproduce.after_reproduce" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                  ]]>
  </point>
  <point name="reproduce.define" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                  ]]>
  </point>
  <point name="reproduce.head.b_input" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[   LET g_xmda_m.xmdastus = 'N' 
   #axmt500-15,32
   LET g_xmda_m.xmda002 = g_user
   LET g_xmda_m.xmda003 = g_dept
   LET g_xmda_m.xmdadocdt = g_today
   LET g_xmda_m.xmdacnfid = ""
   LET g_xmda_m.xmdacnfdt = ""]]>
  </point>
  <point name="send.before_send" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[   IF NOT s_adbt500_conf_chk(g_xmda_m.xmdadocno) THEN
      CLOSE adbt500_cl
      CALL s_transaction_end('N','0')
      RETURN
   END IF
]]>
  </point>
  <point name="set_entry.after_control" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[   CALL cl_set_comp_entry("xmda043,xmda039",TRUE)
   #CALL cl_set_comp_entry("xmdc015,xmdcunit,xmdcorga",TRUE)
   
   CALL cl_set_comp_entry("xmda200,xmda201",TRUE)
   CALL cl_set_comp_required("xmda200",TRUE)
]]>
  </point>
  <point name="set_entry.define" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                  ]]>
  </point>
  <point name="set_entry.field_control" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[      CALL cl_set_comp_entry("xmdadocdt",TRUE)
      CALL cl_set_comp_entry("xmdasite",TRUE)]]>
  </point>
  <point name="set_entry_b.define" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                  ]]>
  </point>
  <point name="set_entry_b.set_entry_b" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[   CALL cl_set_comp_entry("xmddseq",TRUE)
   CALL cl_set_comp_entry("xmdb001,xmdb002,xmdb003,xmdb004,xmdb005,xmdb006",TRUE)
   #CALL cl_set_comp_entry("xmdc012,xmdc013,xmdc015,xmdc016,xmdcunit",TRUE)
   CALL cl_set_comp_entry("xmja003,xmja005,xmja006,xmja011,xmja024,xmja031,xmja032,xmjasite",TRUE)]]>
  </point>
  <point name="set_no_entry.after_control" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[   IF p_cmd = 'a' AND g_flag2 THEN
      CALL cl_set_comp_entry("xmdasite",FALSE)
   END IF
   
   IF NOT g_flag1 THEN
      CALL cl_set_comp_entry("xmda039",FALSE)
   END IF
   
   CALL cl_set_comp_entry("xmda043",FALSE)
      
   #單頭取價方式的基本資料設置不允許修改單價
   #LET l_pmam003 = ''
   #SELECT pmam003 INTO l_pmam003 FROM pmam_t
   #  WHERE pmament = g_enterprise AND pmam001 = g_xmda_m.xmda027
   #IF l_pmam003 <> 'Y' THEN
   #   CALL cl_set_comp_entry("xmdc015",FALSE)
   #END IF
   
   #當單頭多角性質為"5:統購自付"時,收貨據點才可維護
   #IF g_xmda_m.xmda006 <> '5' THEN
   #   CALL cl_set_comp_entry("xmdcunit,xmdcorga",FALSE)
   #   IF l_ac > 0 THEN  #防止數組溢出
   #      LET g_xmdc_d[l_ac].xmdcunit = ''
   #      LET g_xmdc_d[l_ac].xmdcunit_desc = ''
   #      LET g_xmdc_d[l_ac].xmdcorga = ''
   #      LET g_xmdc_d[l_ac].xmdcorga_desc = ''
   #   END IF
   #END IF
   IF g_xmda_m.xmda005 <> '6' THEN
      CALL cl_set_comp_entry("xmda200",FALSE)
      CALL cl_set_comp_required("xmda200",FALSE)
   ELSE
      CALL cl_set_comp_entry("xmda201",FALSE)
   END IF]]>
  </point>
  <point name="set_no_entry.define" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[   DEFINE l_pmam003   LIKE pmam_t.pmam003
]]>
  </point>
  <point name="set_no_entry.field_control" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[      CALL cl_set_comp_entry("xmdadocdt",FALSE)
      CALL cl_set_comp_entry("xmdasite",FALSE)                                    ]]>
  </point>
  <point name="set_no_entry_b.define" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[   DEFINE l_xmah003   LIKE xmah_t.xmah003 
   DEFINE l_pmaa002   LIKE pmaa_t.pmaa002         ]]>
  </point>
  <point name="set_no_entry_b.set_no_entry_b" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[   CALL cl_set_comp_entry("xmddseq",FALSE)
   IF (NOT cl_null(g_xmdc5_d_t.xmdb007)) AND (g_xmdc5_d_t.xmdb008> 0 OR g_xmdc5_d_t.xmdb009 > 0)  OR  NOT g_flag1 THEN
      CALL cl_set_comp_entry("xmdb001,xmdb002,xmdb003,xmdb004,xmdb005,xmdb006",FALSE)
   END IF
#   IF l_ac > 0 THEN
#      IF g_xmdc_d[l_ac].xmdc024 = 'Y' THEN
#         CALL cl_set_comp_entry("xmdc012,xmdc013",FALSE)
#      END IF
#   END IF
  
#   #單頭多角性質為"3:統銷統收"、"4:統銷自收"時，出貨據點才可維護
#   IF g_xmda_m.xmda006 NOT MATCHES '[34]' THEN
#      CALL cl_set_comp_entry("xmdcunit",FALSE)
#   END IF
   #若1.正常稅率，則單身稅別不可輸入
   IF g_tax_app = '1' THEN
#      CALL cl_set_comp_entry("xmdc016",FALSE)
      CALL cl_set_comp_entry("xmja006",FALSE)
   END IF
#   #單頭取價方式的基本資料設置不允許修改單價
#   IF g_xmah003 <> 'Y' THEN
#      CALL cl_set_comp_entry("xmdc015",FALSE)
#   END IF
   IF l_ac > 0 THEN   
      IF NOT cl_null(g_xmdc4_d[l_ac].xmja002) AND g_xmdc4_d[l_ac].xmja002 <> " " THEN
         CALL cl_set_comp_entry("xmja003,xmja011,xmja005",FALSE)
      END IF
      IF g_xmdc4_d[l_ac].xmja030 = "Y" THEN
         CALL cl_set_comp_entry("xmja031,xmja032",FALSE)
      END IF
   END IF   
   SELECT pmaa002
     INTO l_pmaa002
     FROM pmaa_t
    WHERE pmaaent = g_enterprise
      AND pmaa001 = g_xmda_m.xmda004
   IF l_pmaa002 = '2' THEN
      CALL cl_set_comp_visible("xmja024,xmja024_desc",TRUE) 
   ELSE
      IF l_ac > 0 THEN
         LET g_xmdc4_d[l_ac].xmja024 = NULL
         DISPLAY BY NAME g_xmdc4_d[l_ac].xmja024
      END IF
      CALL cl_set_comp_entry("xmja024",FALSE)
      CALL cl_set_comp_visible("xmja024,xmja024_desc",FALSE) 
   END IF 
  
   IF NOT cl_null(g_xmda_m.xmda204) THEN
      CALL cl_set_comp_entry("xmja005",FALSE)
   END IF
   IF p_cmd <> 'a' OR NOT g_flag3 THEN
      CALL cl_set_comp_entry("xmjasite",FALSE)
   END IF]]>
  </point>
  <point name="show.after" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                  ]]>
  </point>
  <point name="show.before" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                  ]]>
  </point>
  <point name="show.body.reference" order="" ver="2" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[#            CALL adbt500_xmdc001_ref(g_xmdc_d[l_ac].xmdc001) RETURNING g_xmdc_d[l_ac].xmdc001_desc,g_xmdc_d[l_ac].imaal004
#            DISPLAY BY NAME g_xmdc_d[l_ac].xmdc001_desc,g_xmdc_d[l_ac].imaal004
#
#            CALL adbt500_xmdc004_ref(g_xmdc_d[l_ac].xmdc004) RETURNING g_xmdc_d[l_ac].xmdc004_desc
#            DISPLAY BY NAME g_xmdc_d[l_ac].xmdc004_desc
#
#            CALL adbt500_unit_ref(g_xmdc_d[l_ac].xmdc006) RETURNING g_xmdc_d[l_ac].xmdc006_desc
#            DISPLAY BY NAME g_xmdc_d[l_ac].xmdc006_desc
#
#            CALL adbt500_unit_ref(g_xmdc_d[l_ac].xmdc008) RETURNING g_xmdc_d[l_ac].xmdc008_desc
#            DISPLAY BY NAME g_xmdc_d[l_ac].xmdc008_desc
#
#            CALL adbt500_unit_ref(g_xmdc_d[l_ac].xmdc010) RETURNING g_xmdc_d[l_ac].xmdc010_desc
#            DISPLAY BY NAME g_xmdc_d[l_ac].xmdc010_desc
#
#            CALL adbt500_xmda011_ref(g_xmdc_d[l_ac].xmdc016) RETURNING g_xmdc_d[l_ac].xmdc016_desc
#            DISPLAY BY NAME g_xmdc_d[l_ac].xmdc016_desc
#
#            
#            CALL adbt500_xmda003_ref(g_xmdc_d[l_ac].xmdcunit) RETURNING g_xmdc_d[l_ac].xmdcunit_desc
#            DISPLAY BY NAME g_xmdc_d[l_ac].xmdcunit_desc
#            
#            CALL adbt500_xmda003_ref(g_xmdc_d[l_ac].xmdcorga) RETURNING g_xmdc_d[l_ac].xmdcorga_desc
#            DISPLAY BY NAME g_xmdc_d[l_ac].xmdcorga_desc
#            
#            CALL adbt500_xmdc049_ref(g_xmdc_d[l_ac].xmdc049) RETURNING g_xmdc_d[l_ac].xmdc049_desc
#            DISPLAY BY NAME g_xmdc_d[l_ac].xmdc049_desc

#     SELECT xmdc012,xmdc013 
#        INTO g_xmdc3_d[l_ac].xmdc012,g_xmdc3_d[l_ac].xmdc013
#        FROM xmdc_t
#       WHERE xmdcent = g_enterprise
#         AND xmdcdocno = g_xmdc3_d[l_ac].xmdddocno
#         AND xmdcseq = g_xmdc3_d[l_ac].xmddseq
#      DISPLAY BY NAME g_xmdc3_d[l_ac].xmdc012,g_xmdc3_d[l_ac].xmdc013]]>
  </point>
  <point name="show.body2.reference" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            LET g_xmdc2_d[l_ac].xmdcseq = g_xmdc_d[l_ac].xmdcseq
            LET g_xmdc2_d[l_ac].imaa001 = g_xmdc_d[l_ac].xmdc001
            LET g_xmdc2_d[l_ac].imaal003 = g_xmdc_d[l_ac].xmdc001_desc
            LET g_xmdc2_d[l_ac].imaal004 = g_xmdc_d[l_ac].imaal004
            LET g_xmdc2_d[l_ac].imaa005 = g_xmdc_d[l_ac].xmdc002
            LET g_xmdc2_d[l_ac].xmdc0272 = g_xmdc_d[l_ac].xmdc027
            DISPLAY BY NAME g_xmdc2_d[l_ac].xmdcseq,g_xmdc2_d[l_ac].imaa001,g_xmdc2_d[l_ac].imaal003,
                            g_xmdc2_d[l_ac].imaal004,g_xmdc2_d[l_ac].imaa005,g_xmdc2_d[l_ac].xmdc0272            
           
            CALL adbt500_xmdc028_ref(g_xmdc2_d[l_ac].xmdc028) RETURNING g_xmdc2_d[l_ac].xmdc028_desc
            DISPLAY BY NAME g_xmdc2_d[l_ac].xmdc028_desc

            CALL adbt500_xmdc029_ref(g_xmdc2_d[l_ac].xmdc028,g_xmdc2_d[l_ac].xmdc029) RETURNING g_xmdc2_d[l_ac].xmdc029_desc
            DISPLAY BY NAME g_xmdc2_d[l_ac].xmdc029_desc
            
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmdc2_d[l_ac].xmdc028
            CALL ap_ref_array2(g_ref_fields,"SELECT inaa002 FROM inaa_t WHERE inaaent='"||g_enterprise||"' AND inaa001=? ","") RETURNING g_rtn_fields
            LET g_xmdc2_d[l_ac].xmdc028_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmdc2_d[l_ac].xmdc028_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmdc2_d[l_ac].xmdc028
            LET g_ref_fields[2] = g_xmdc2_d[l_ac].xmdc029
            CALL ap_ref_array2(g_ref_fields,"SELECT inab003 FROM inab_t WHERE inabent='"||g_enterprise||"' AND inab001=? AND inab002=? ","") RETURNING g_rtn_fields
            LET g_xmdc2_d[l_ac].xmdc029_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmdc2_d[l_ac].xmdc029_desc
]]>
  </point>
  <point name="show.body3.reference" order="" ver="2" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[      #抓取約定交貨日、預計簽收日期
#      
#      CALL adbt500_unit_ref(g_xmdc3_d[l_ac].xmdd004) RETURNING g_xmdc3_d[l_ac].xmdd004_desc
#      DISPLAY BY NAME g_xmdc3_d[l_ac].xmdd004_desc
#
#      CALL adbt500_xmda002_ref(g_xmdc3_d[l_ac].xmdd022) RETURNING g_xmdc3_d[l_ac].xmdd022_desc
#      DISPLAY BY NAME g_xmdc3_d[l_ac].xmdd022_desc
#      
#      CALL adbt500_xmda011_ref(g_xmdc3_d[l_ac].xmdd019) RETURNING g_xmdc3_d[l_ac].xmdd019_desc
#      DISPLAY BY NAME g_xmdc3_d[l_ac].xmdd019_desc
#      
#      CALL adbt500_unit_ref(g_xmdc3_d[l_ac].xmdd024) RETURNING g_xmdc3_d[l_ac].xmdd024_desc
#      DISPLAY BY NAME g_xmdc3_d[l_ac].xmdd024_desc
#      
#      CALL adbt500_unit_ref(g_xmdc3_d[l_ac].xmdd026) RETURNING g_xmdc3_d[l_ac].xmdd026_desc
#      DISPLAY BY NAME g_xmdc3_d[l_ac].xmdd026_desc
#      
#      CALL adbt500_xmdd001_ref()
#      CALL adbt500_xmdd200_ref()
#      CALL adbt500_xmdd207_ref()
#      CALL adbt500_xmdd213_ref()
#      CALL adbt500_xmdd214_ref()
#      CALL adbt500_xmdd218_ref()
#      CALL adbt500_xmdd219_ref()
#      CALL adbt500_xmdd220_ref()
#      CALL adbt500_xmdd210_ref()
#      CALL adbt500_xmddunit_ref()
#      CALL adbt500_xmdd201_ref()
#      CALL adbt500_xmdd222_ref()
#      CALL adbt500_xmdd223_ref()
#      CALL adbt500_xmdd224_ref()
#      CALL adbt500_xmddorga_ref()
#      CALL adbt500_xmdd227_ref()
#      CALL adbt500_xmdd228_ref()
#      CALL adbt500_xmddsite_ref()
]]>
  </point>
  <point name="show.body4.reference" order="" ver="2" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[#            CALL adbt500_xmja003_ref()
            CALL adbt500_xmja006_ref()
#            CALL adbt500_xmja011_ref()
#            CALL adbt500_xmja013_ref()
#            CALL adbt500_xmja015_ref()
#            CALL adbt500_xmja017_ref()
#            CALL adbt500_xmja005_ref()
#            CALL adbt500_xmja024_ref()
            CALL adbt500_xmja026_ref()
#            CALL adbt500_xmja027_ref()
#            CALL adbt500_xmjasite_ref()]]>
  </point>
  <point name="show.body5.reference" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                    ]]>
  </point>
  <point name="show.body6.reference" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[
      CALL adbt500_xrcd002_ref()
      CALL adbt500_imaa0011_ref()]]>
  </point>
  <point name="show.body7.reference" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[      CALL adbt500_rtie002_ref()
      CALL adbt500_imaa0012_ref()
]]>
  </point>
  <point name="show.body8.reference" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmdc8_d[l_ac].xmdc001
            CALL ap_ref_array2(g_ref_fields,"SELECT imaal003 FROM imaal_t WHERE imaalent='"||g_enterprise||"' AND imaal001=? AND imaal002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmdc8_d[l_ac].xmdc001_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmdc8_d[l_ac].xmdc001_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmdc8_d[l_ac].xmdc004
            CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='221' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmdc8_d[l_ac].xmdc004_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmdc8_d[l_ac].xmdc004_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmdc8_d[l_ac].xmdc006
            CALL ap_ref_array2(g_ref_fields,"SELECT oocal003 FROM oocal_t WHERE oocalent='"||g_enterprise||"' AND oocal001=? AND oocal002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmdc8_d[l_ac].xmdc006_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmdc8_d[l_ac].xmdc006_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmdc8_d[l_ac].xmdc008
            CALL ap_ref_array2(g_ref_fields,"SELECT oocal003 FROM oocal_t WHERE oocalent='"||g_enterprise||"' AND oocal001=? AND oocal002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmdc8_d[l_ac].xmdc008_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmdc8_d[l_ac].xmdc008_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmdc8_d[l_ac].xmdc010
            CALL ap_ref_array2(g_ref_fields,"SELECT oocal003 FROM oocal_t WHERE oocalent='"||g_enterprise||"' AND oocal001=? AND oocal002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmdc8_d[l_ac].xmdc010_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmdc8_d[l_ac].xmdc010_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmdc8_d[l_ac].xmdc016
            CALL ap_ref_array2(g_ref_fields,"SELECT oodbl004 FROM oodbl_t WHERE oodblent='"||g_enterprise||"' AND oodbl002=? AND oodbl003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmdc8_d[l_ac].xmdc016_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmdc8_d[l_ac].xmdc016_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmdc8_d[l_ac].xmdcunit
            CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmdc8_d[l_ac].xmdcunit_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmdc8_d[l_ac].xmdcunit_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmdc8_d[l_ac].xmdcorga
            CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmdc8_d[l_ac].xmdcorga_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmdc8_d[l_ac].xmdcorga_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmdc8_d[l_ac].xmdc049
            CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='265' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmdc8_d[l_ac].xmdc049_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmdc8_d[l_ac].xmdc049_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmdc8_d[l_ac].xmdc053
            CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='265' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmdc8_d[l_ac].xmdc053_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmdc8_d[l_ac].xmdc053_desc
]]>
  </point>
  <point name="show.define" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[   DEFINE  l_pmaa027    LIKE pmaa_t.pmaa027
   DEFINE  r_success    LIKE type_t.num5 
   DEFINE  r_address    STRING                     ]]>
  </point>
  <point name="show.head.reference" order="" ver="2" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[#            CALL adbt500_xmdadocno_ref() 
#            CALL adbt500_xmdasite_ref()
#            CALL adbt500_xmda200_ref()
#            CALL adbt500_xmda201_ref()
#            CALL adbt500_xmda202_ref()
#            CALL adbt500_xmda203_ref()
#            CALL adbt500_xmda204_ref()
#            CALL adbt500_xmda206_ref()
#            CALL adbt500_xmda207_ref()
#            CALL adbt500_xmdaunit_ref()
#            CALL adbt500_xmda004_ref(g_xmda_m.xmda004) RETURNING g_xmda_m.xmda004_desc
#            DISPLAY BY NAME g_xmda_m.xmda004_desc
#
#            CALL adbt500_xmda002_ref(g_xmda_m.xmda002) RETURNING g_xmda_m.xmda002_desc
#            DISPLAY BY NAME g_xmda_m.xmda002_desc
#
#            CALL adbt500_xmda003_ref(g_xmda_m.xmda003) RETURNING g_xmda_m.xmda003_desc
#            DISPLAY BY NAME g_xmda_m.xmda003_desc 
#            
#            CALL adbt500_xmda027_ref(g_xmda_m.xmda027) RETURNING g_xmda_m.xmda027_desc
#            DISPLAY BY NAME g_xmda_m.xmda027_desc
#            
#            CALL adbt500_xmda009_ref(g_xmda_m.xmda009) RETURNING g_xmda_m.xmda009_desc
#            DISPLAY BY NAME g_xmda_m.xmda009_desc
#            
#            CALL adbt500_xmda010_ref(g_xmda_m.xmda010) RETURNING g_xmda_m.xmda010_desc
#            DISPLAY BY NAME g_xmda_m.xmda010_desc
#            
            CALL adbt500_xmda011_ref(g_xmda_m.xmda011) RETURNING g_xmda_m.xmda011_desc
            DISPLAY BY NAME g_xmda_m.xmda011_desc
            
#            CALL adbt500_xmda015_ref(g_xmda_m.xmda015) RETURNING g_xmda_m.xmda015_desc
#            DISPLAY BY NAME g_xmda_m.xmda015_desc
#            
#            CALL adbt500_xmda017_ref(g_xmda_m.xmda017) RETURNING g_xmda_m.xmda017_desc
#            DISPLAY BY NAME g_xmda_m.xmda017_desc
#            
#            CALL adbt500_xmda018_ref(g_xmda_m.xmda018) RETURNING g_xmda_m.xmda018_desc
#            DISPLAY BY NAME g_xmda_m.xmda018_desc         
#           
#            CALL adbt500_xmda020_ref(g_xmda_m.xmda020) RETURNING g_xmda_m.xmda020_desc
#            DISPLAY BY NAME g_xmda_m.xmda020_desc
#                        
#            CALL adbt500_xmda004_ref(g_xmda_m.xmda021) RETURNING g_xmda_m.xmda021_desc
#            DISPLAY BY NAME g_xmda_m.xmda021_desc 
#            
#            CALL adbt500_xmda004_ref(g_xmda_m.xmda022) RETURNING g_xmda_m.xmda022_desc
#            DISPLAY BY NAME g_xmda_m.xmda022_desc 
#                     
#            CALL adbt500_xmda023_ref(g_xmda_m.xmda023) RETURNING g_xmda_m.xmda023_desc
#            DISPLAY BY NAME g_xmda_m.xmda023_desc
#            
#            CALL adbt500_xmda024_ref(g_xmda_m.xmda024) RETURNING g_xmda_m.xmda024_desc
#            DISPLAY BY NAME g_xmda_m.xmda024_desc
#
#            CALL adbt500_xmda004_ref(g_xmda_m.xmda034) RETURNING g_xmda_m.xmda034_desc
#            DISPLAY BY NAME g_xmda_m.xmda034_desc
#            
#            CALL adbt500_xmda032_ref(g_xmda_m.xmda032) RETURNING g_xmda_m.xmda032_desc
#            DISPLAY BY NAME g_xmda_m.xmda032_desc
#            
            CALL adbt500_xmda035_ref(g_xmda_m.xmda035) RETURNING g_xmda_m.xmda035_desc
            DISPLAY BY NAME g_xmda_m.xmda035_desc
            
#            CALL adbt500_xmda004_ref(g_xmda_m.xmda036) RETURNING g_xmda_m.xmda036_desc
#            DISPLAY BY NAME g_xmda_m.xmda036_desc
            
            
            LET l_pmaa027 = ''
            LET g_xmda_m.xmda026_desc = ''
            LET g_xmda_m.oofb017_1 = ''
            IF NOT cl_null(g_xmda_m.xmda021) AND NOT cl_null(g_xmda_m.xmda026) THEN 
               CALL adbt500_get_pmaa027(g_xmda_m.xmda021) RETURNING l_pmaa027  
               CALL adbt500_xmda026_ref(l_pmaa027,g_xmda_m.xmda026) RETURNING g_xmda_m.xmda026_desc
               DISPLAY BY NAME g_xmda_m.xmda026_desc               
               CALL s_aooi350_get_address(l_pmaa027,g_xmda_m.xmda026,g_lang)RETURNING r_success,r_address
               LET g_xmda_m.oofb017_1 = r_address
               DISPLAY BY NAME g_xmda_m.oofb017_1
            END IF


            LET l_pmaa027 = ''
            LET g_xmda_m.xmda025_desc = ''
            LET g_xmda_m.oofb017 = ''
            IF NOT cl_null(g_xmda_m.xmda022) AND NOT cl_null(g_xmda_m.xmda025) THEN   
               CALL adbt500_get_pmaa027(g_xmda_m.xmda022) RETURNING l_pmaa027  
               CALL adbt500_xmda025_ref(l_pmaa027,g_xmda_m.xmda025) RETURNING g_xmda_m.xmda025_desc
               DISPLAY BY NAME g_xmda_m.xmda025_desc                    
               CALL s_aooi350_get_address(l_pmaa027,g_xmda_m.xmda025,g_lang)RETURNING r_success,r_address
               LET g_xmda_m.oofb017 = r_address
               DISPLAY BY NAME g_xmda_m.oofb017
            END IF
       
            
#            INITIALIZE g_ref_fields TO NULL
#            LET g_ref_fields[1] = g_xmda_m.xmdaownid
#            CALL ap_ref_array2(g_ref_fields,"SELECT ooag011 FROM ooag_t WHERE ooagent='"||g_enterprise||"' AND ooag001=? ","") RETURNING g_rtn_fields
#            LET g_xmda_m.xmdaownid_desc = '', g_rtn_fields[1] , ''
#            DISPLAY BY NAME g_xmda_m.xmdaownid_desc
#
#            INITIALIZE g_ref_fields TO NULL
#            LET g_ref_fields[1] = g_xmda_m.xmdaowndp
#            CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
#            LET g_xmda_m.xmdaowndp_desc = '', g_rtn_fields[1] , ''
#            DISPLAY BY NAME g_xmda_m.xmdaowndp_desc
#
#            INITIALIZE g_ref_fields TO NULL
#            LET g_ref_fields[1] = g_xmda_m.xmdacrtid
#            CALL ap_ref_array2(g_ref_fields,"SELECT ooag011 FROM ooag_t WHERE ooagent='"||g_enterprise||"' AND ooag001=? ","") RETURNING g_rtn_fields
#            LET g_xmda_m.xmdacrtid_desc = '', g_rtn_fields[1] , ''
#            DISPLAY BY NAME g_xmda_m.xmdacrtid_desc
#
#            INITIALIZE g_ref_fields TO NULL
#            LET g_ref_fields[1] = g_xmda_m.xmdacrtdp
#            CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
#            LET g_xmda_m.xmdacrtdp_desc = '', g_rtn_fields[1] , ''
#            DISPLAY BY NAME g_xmda_m.xmdacrtdp_desc
#
#            INITIALIZE g_ref_fields TO NULL
#            LET g_ref_fields[1] = g_xmda_m.xmdamodid
#            CALL ap_ref_array2(g_ref_fields,"SELECT ooag011 FROM ooag_t WHERE ooagent='"||g_enterprise||"' AND ooag001=? ","") RETURNING g_rtn_fields
#            LET g_xmda_m.xmdamodid_desc = '', g_rtn_fields[1] , ''
#            DISPLAY BY NAME g_xmda_m.xmdamodid_desc
#
#            INITIALIZE g_ref_fields TO NULL
#            LET g_ref_fields[1] = g_xmda_m.xmdacnfid
#            CALL ap_ref_array2(g_ref_fields,"SELECT ooag011 FROM ooag_t WHERE ooagent='"||g_enterprise||"' AND ooag001=? ","") RETURNING g_rtn_fields
#            LET g_xmda_m.xmdacnfid_desc = '', g_rtn_fields[1] , ''
#            DISPLAY BY NAME g_xmda_m.xmdacnfid_desc

            CALL adbt500_get_isaf011()]]>
  </point>
  <point name="show.other" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[#   FOR l_ac = 1 TO g_xmdc7_d.getLength()
#      CALL adbt500_rtie002_ref()
#      CALL adbt500_imaa0012_ref()
#   END FOR             ]]>
  </point>
  <point name="statechange.a_update" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                  ]]>
  </point>
  <point name="statechange.after" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                  ]]>
  </point>
  <point name="statechange.b_update" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                     CALL s_transaction_begin()
   IF lc_state = 'Y' THEN
      CALL s_adbt500_conf_chk(g_xmda_m.xmdadocno) RETURNING l_success
      IF NOT l_success THEN
         RETURN
      ELSE
         IF NOT cl_ask_confirm('aim-00108') THEN
            RETURN
         ELSE
            CALL s_adbt500_conf_upd(g_xmda_m.xmdadocno) RETURNING l_success
            IF NOT l_success THEN
               CALL s_transaction_end('N','0')
               RETURN
            ELSE
               CALL s_transaction_end('Y','0')
            END IF
         END IF
      END IF
   END IF
   IF lc_state = 'N' THEN
      CALL s_adbt500_unconf_chk(g_xmda_m.xmdadocno) RETURNING l_success
      IF NOT l_success THEN
         RETURN
      ELSE
         IF NOT cl_ask_confirm('aim-00110') THEN
            RETURN
         ELSE
            CALL s_adbt500_unconf_upd(g_xmda_m.xmdadocno) RETURNING l_success
            IF NOT l_success THEN
               CALL s_transaction_end('N','0')
               RETURN
            ELSE
               CALL s_transaction_end('Y','0')
            END IF
         END IF
      END IF
   END IF
   IF lc_state = 'X' THEN
      CALL s_adbt500_invalid_chk(g_xmda_m.xmdadocno) RETURNING l_success
      IF NOT l_success THEN
         RETURN
      ELSE
         IF NOT cl_ask_confirm('aim-00109') THEN
            RETURN
         ELSE
            CALL s_adbt500_invalid_upd(g_xmda_m.xmdadocno) RETURNING l_success
            IF NOT l_success THEN
               CALL s_transaction_end('N','0')
               RETURN
            ELSE
               CALL s_transaction_end('Y','0')
            END IF
         END IF
      END IF
   END IF]]>
  </point>
  <point name="statechange.before" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                  ]]>
  </point>
  <point name="statechange.before_menu" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[      CALL cl_set_act_visible("signing,withdraw,closed",FALSE)
      #將open改為unconfirmed
      CALL cl_set_act_visible("unconfirmed,invalid,confirmed",TRUE)
      CASE g_xmda_m.xmdastus
         WHEN "N"
            CALL cl_set_act_visible("unconfirmed,hold",FALSE)
            #需提交至BPM時，則顯示「提交」功能並隱藏「確認」功能
            IF cl_bpm_chk() THEN
                CALL cl_set_act_visible("signing",TRUE)
                CALL cl_set_act_visible("confirmed",FALSE)
            END IF
         WHEN "R"   #保留修改的功能(如作廢)，隱藏其他應用功能(如: 確認、未確認、留置、過帳…)
            CALL cl_set_act_visible("confirmed,unconfirmed,hold",FALSE)
            
         WHEN "D"   #保留修改的功能(如作廢)，隱藏其他應用功能(如: 確認、未確認、留置、過帳…)
            CALL cl_set_act_visible("confirmed,unconfirmed,hold",FALSE) 

         WHEN "X"
            CALL cl_set_act_visible("unconfirmed,invalid,confirmed,hold",FALSE)
            RETURN
         WHEN "Y"
            CALL cl_set_act_visible("invalid,confirmed,hold",FALSE)
            
         WHEN "W"    #只能顯示抽單;其餘應用功能皆隱藏
             CALL cl_set_act_visible("withdraw",TRUE)  
             CALL cl_set_act_visible("unconfirmed,invalid,confirmed,hold",FALSE)
         
         WHEN "A"     #只能顯示確認; 其餘應用功能皆隱藏
             CALL cl_set_act_visible("confirmed ",TRUE)  
             CALL cl_set_act_visible("unconfirmed,invalid,hold",FALSE)

      END CASE]]>
  </point>
  <point name="statechange.confirmed" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                      ]]>
  </point>
  <point name="statechange.define" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                     DEFINE l_success  LIKE type_t.num5]]>
  </point>
  <point name="statechange.invalid" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                      ]]>
  </point>
  <point name="statechange.more_control" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                    ]]>
  </point>
  <point name="statechange.open" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                      ]]>
  </point>
  <point name="statechange.verify" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                      ]]>
  </point>
  <point name="ui_browser_refresh.define" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                  ]]>
  </point>
  <point name="ui_detailshow.after" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                  ]]>
  </point>
  <point name="ui_detailshow.before" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                  ]]>
  </point>
  <point name="ui_detailshow.define" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                  ]]>
  </point>
  <point name="ui_dialog.action_default" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                    ]]>
  </point>
  <point name="ui_dialog.before_dialog" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                  ]]>
  </point>
  <point name="ui_dialog.before_dialog2" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            IF lb_first THEN
               LET lb_first = FALSE   
            END IF
            NEXT FIELD xmjaseq]]>
  </point>
  <point name="ui_dialog.body2.action" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="ui_dialog.body2.before_display" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                          ]]>
  </point>
  <point name="ui_dialog.body2.before_row" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                          ]]>
  </point>
  <point name="ui_dialog.body3.action" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="ui_dialog.body3.before_display" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                          ]]>
  </point>
  <point name="ui_dialog.body3.before_row" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                          ]]>
  </point>
  <point name="ui_dialog.body5.action" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="ui_dialog.body5.before_display" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                          ]]>
  </point>
  <point name="ui_dialog.body5.before_row" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                          ]]>
  </point>
  <point name="ui_dialog.define" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[   DEFINE l_pmaa004    LIKE pmaa_t.pmaa004 
   DEFINE l_rtiadocno  LIKE rtia_t.rtiadocno
   DEFINE l_success    LIKE type_t.num5]]>
  </point>
  <point name="ui_dialog.more_displayarray" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[#         DISPLAY ARRAY g_xmdc7_d TO s_detail7.* ATTRIBUTES(COUNT=g_rec_b)  
#    
#            BEFORE ROW
#               CALL adbt500_idx_chk()
#               LET l_ac = DIALOG.getCurrentRow("s_detail7")
#               LET g_detail_idx = l_ac
#               
#            BEFORE DISPLAY
#               CALL FGL_SET_ARR_CURR(g_detail_idx)
#               LET l_ac = DIALOG.getCurrentRow("s_detail7")
#               LET g_current_page = 6
#               CALL adbt500_idx_chk()
#         END DISPLAY                                             ]]>
  </point>
  <point name="ui_dialog.page1.action" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                        ]]>
  </point>
  <point name="ui_dialog.page1.before_display" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                          ]]>
  </point>
  <point name="ui_dialog.page1.before_row" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                                                                          ]]>
  </point>
  <point name="ui_headershow.define" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                  ]]>
  </point>
  <point name="unlock_b.define" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                  ]]>
  </point>
  <point name="unlock_b.other" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                  ]]>
  </point>
  <point name="update_b.after_update" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                    ]]>
  </point>
  <point name="update_b.after_update2" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                    ]]>
  </point>
  <point name="update_b.after_update3" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                    ]]>
  </point>
  <point name="update_b.before_update" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                    ]]>
  </point>
  <point name="update_b.before_update2" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                    ]]>
  </point>
  <point name="update_b.before_update3" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                    ]]>
  </point>
  <point name="update_b.define" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                  ]]>
  </point>
  <point name="update_b.m_update" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                    ]]>
  </point>
  <point name="update_b.m_update2" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                    ]]>
  </point>
  <point name="update_b.m_update3" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                                    ]]>
  </point>
  <point name="update_b.other" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[                  ]]>
  </point>
  <section id="adbt500.b_fill" ver="86" status="" src="s">
    <![CDATA[#+ 單身陣列填充
PRIVATE FUNCTION adbt500_b_fill()
   DEFINE p_wc2      STRING
   #add-point:b_fill段define
   {<point name="b_fill.define"/>}
   #end add-point     
 
   CALL g_xmdc_d.clear()    #g_xmdc_d 單頭及單身 
   CALL g_xmdc3_d.clear()
   CALL g_xmdc4_d.clear()
   CALL g_xmdc5_d.clear()
   CALL g_xmdc6_d.clear()
 
 
   #add-point:b_fill段sql_before
   {<point name="b_fill.sql_before"/>}
   #end add-point
   
   #判斷是否填充
   IF adbt500_fill_chk(1) THEN
   
      LET g_sql = "SELECT  UNIQUE xmdcsite,xmdcseq,xmdc027,xmdc001,xmdc002,xmdc004,xmdc005,xmdc006,xmdc007, 
          xmdc008,xmdc009,xmdc024,xmdc012,xmdc013,xmdc045,xmdc010,xmdc011,xmdc015,xmdc016,xmdc017,xmdc046, 
          xmdc047,xmdc048,xmdc023,xmdc019,xmdc020,xmdc021,xmdc022,xmdc051,xmdcunit,xmdcorga,xmdc052, 
          xmdc049,xmdc053,xmdc050 ,t1.imaal003 ,t2.oocql004 ,t3.oocal003 ,t4.oocal003 ,t5.oocal003 , 
          t6.ooefl003 ,t7.ooefl003 ,t8.oocql004 ,t9.oocql004 FROM xmdc_t",   
                  " INNER JOIN xmda_t ON xmdadocno = xmdcdocno ",
 
                  #"",
                  
                  "",
                                 " LEFT JOIN imaal_t t1 ON t1.imaalent='"||g_enterprise||"' AND t1.imaal001=xmdc001 AND t1.imaal002='"||g_dlang||"' ",
               " LEFT JOIN oocql_t t2 ON t2.oocqlent='"||g_enterprise||"' AND t2.oocql001='221' AND t2.oocql002=xmdc004 AND t2.oocql003='"||g_dlang||"' ",
               " LEFT JOIN oocal_t t3 ON t3.oocalent='"||g_enterprise||"' AND t3.oocal001=xmdc006 AND t3.oocal002='"||g_dlang||"' ",
               " LEFT JOIN oocal_t t4 ON t4.oocalent='"||g_enterprise||"' AND t4.oocal001=xmdc008 AND t4.oocal002='"||g_dlang||"' ",
               " LEFT JOIN oocal_t t5 ON t5.oocalent='"||g_enterprise||"' AND t5.oocal001=xmdc010 AND t5.oocal002='"||g_dlang||"' ",
               " LEFT JOIN ooefl_t t6 ON t6.ooeflent='"||g_enterprise||"' AND t6.ooefl001=xmdcunit AND t6.ooefl002='"||g_dlang||"' ",
               " LEFT JOIN ooefl_t t7 ON t7.ooeflent='"||g_enterprise||"' AND t7.ooefl001=xmdcorga AND t7.ooefl002='"||g_dlang||"' ",
               " LEFT JOIN oocql_t t8 ON t8.oocqlent='"||g_enterprise||"' AND t8.oocql001='265' AND t8.oocql002=xmdc049 AND t8.oocql003='"||g_dlang||"' ",
               " LEFT JOIN oocql_t t9 ON t9.oocqlent='"||g_enterprise||"' AND t9.oocql001='265' AND t9.oocql002=xmdc053 AND t9.oocql003='"||g_dlang||"' ",
 
                  " WHERE xmdcent=? AND xmdcdocno=?"
      LET g_sql = cl_sql_add_mask(g_sql)              #遮蔽特定資料
      #add-point:b_fill段sql_before
      {<point name="b_fill.body.fill_sql"/>}
      #end add-point
      IF NOT cl_null(g_wc2_table1) THEN
         LET g_sql = g_sql CLIPPED, " AND ", g_wc2_table1 CLIPPED
      END IF
      
      #子單身的WC
      
      
      LET g_sql = g_sql, " ORDER BY xmdc_t.xmdcseq"
      
      #add-point:單身填充控制
      {<point name="b_fill.sql"/>}
      #end add-point
      
      LET g_sql = cl_sql_add_mask(g_sql)              #遮蔽特定資料
      PREPARE adbt500_pb FROM g_sql
      DECLARE b_fill_cs CURSOR FOR adbt500_pb
      
      LET g_cnt = l_ac
      LET l_ac = 1
      
      OPEN b_fill_cs USING g_enterprise,g_xmda_m.xmdadocno
                                               
      FOREACH b_fill_cs INTO g_xmdc_d[l_ac].xmdcsite,g_xmdc_d[l_ac].xmdcseq,g_xmdc_d[l_ac].xmdc027,g_xmdc_d[l_ac].xmdc001, 
          g_xmdc_d[l_ac].xmdc002,g_xmdc_d[l_ac].xmdc004,g_xmdc_d[l_ac].xmdc005,g_xmdc_d[l_ac].xmdc006, 
          g_xmdc_d[l_ac].xmdc007,g_xmdc_d[l_ac].xmdc008,g_xmdc_d[l_ac].xmdc009,g_xmdc_d[l_ac].xmdc024, 
          g_xmdc_d[l_ac].xmdc012,g_xmdc_d[l_ac].xmdc013,g_xmdc_d[l_ac].xmdc045,g_xmdc_d[l_ac].xmdc010, 
          g_xmdc_d[l_ac].xmdc011,g_xmdc_d[l_ac].xmdc015,g_xmdc_d[l_ac].xmdc016,g_xmdc_d[l_ac].xmdc017, 
          g_xmdc_d[l_ac].xmdc046,g_xmdc_d[l_ac].xmdc047,g_xmdc_d[l_ac].xmdc048,g_xmdc_d[l_ac].xmdc023, 
          g_xmdc_d[l_ac].xmdc019,g_xmdc_d[l_ac].xmdc020,g_xmdc_d[l_ac].xmdc021,g_xmdc_d[l_ac].xmdc022, 
          g_xmdc_d[l_ac].xmdc051,g_xmdc_d[l_ac].xmdcunit,g_xmdc_d[l_ac].xmdcorga,g_xmdc_d[l_ac].xmdc052, 
          g_xmdc_d[l_ac].xmdc049,g_xmdc_d[l_ac].xmdc053,g_xmdc_d[l_ac].xmdc050,g_xmdc_d[l_ac].xmdc001_desc, 
          g_xmdc_d[l_ac].xmdc004_desc,g_xmdc_d[l_ac].xmdc006_desc,g_xmdc_d[l_ac].xmdc008_desc,g_xmdc_d[l_ac].xmdc010_desc, 
          g_xmdc_d[l_ac].xmdcunit_desc,g_xmdc_d[l_ac].xmdcorga_desc,g_xmdc_d[l_ac].xmdc049_desc,g_xmdc_d[l_ac].xmdc053_desc 

         IF SQLCA.sqlcode THEN
            CALL cl_err("FOREACH:",SQLCA.sqlcode,1)
            EXIT FOREACH
         END IF
        
         #add-point:b_fill段資料填充
         {<point name="b_fill.fill"/>}
         #end add-point
      
         LET l_ac = l_ac + 1
         IF l_ac > g_max_rec THEN
            IF g_error_show = 1 THEN
               CALL cl_err( '', 9035, 1)
            END IF
            EXIT FOREACH
         END IF
         
      END FOREACH
      LET g_error_show = 0
   
   END IF
   
   #判斷是否填充
   IF adbt500_fill_chk(2) THEN
      LET g_sql = "SELECT  UNIQUE xmdddocno,xmddseq,xmddseq1,xmdd229,xmdd003,xmdd001,xmdd002,xmdd200, 
          xmdd004,xmdd005,xmdd011,xmdd012,xmddseq2,xmdd006,xmdd201,xmdd202,xmdd024,xmdd025,xmdd026,xmdd027, 
          xmdd203,xmdd204,xmdd205,xmdd206,xmdd029,xmdd028,xmdd019,xmdd030,xmdd207,xmddunit,xmdd210,xmdd212, 
          xmdd213,xmdd214,xmdd215,xmdd031,xmdd014,xmdd015,xmdd016,xmdd017,xmdd221,xmddsite,xmdd218,xmdd219, 
          xmdd220,xmdd222,xmdd223,xmdd224,xmddorga,xmdd226,xmdd227,xmdd228,xmdd013,xmdd009,xmdd018,xmdd020, 
          xmdd021,xmdd022,xmdd023 ,t10.imaal003 ,t11.imaal004 ,t12.prcfl003 ,t13.oocal003 ,t14.oocal003 , 
          t15.oocal003 ,t16.oocal003 ,t17.pmaal004 ,t18.ooefl003 ,t19.oocql004 ,t20.inaa002 ,t21.inab003 , 
          t22.ooefl003 ,t23.oojdl003 ,t24.dbbal003 ,t25.dbbcl003 ,t26.ooefl003 ,t27.ooag011 ,t28.ooefl003 , 
          t29.ooefl003 ,t30.oocql004 ,t31.staal003 ,t32.ooag011 FROM xmdd_t",   
                  " INNER JOIN xmda_t ON xmdadocno = xmdddocno ",
 
                  "",
                  
                                 " LEFT JOIN imaal_t t10 ON t10.imaalent='"||g_enterprise||"' AND t10.imaal001=xmdd001 AND t10.imaal002='"||g_dlang||"' ",
               " LEFT JOIN imaal_t t11 ON t11.imaalent='"||g_enterprise||"' AND t11.imaal001=xmdd001 AND t11.imaal002='"||g_dlang||"' ",
               " LEFT JOIN prcfl_t t12 ON t12.prcflent='"||g_enterprise||"' AND t12.prcfl001=xmdd200 AND t12.prcfl002='"||g_dlang||"' ",
               " LEFT JOIN oocal_t t13 ON t13.oocalent='"||g_enterprise||"' AND t13.oocal001=xmdd004 AND t13.oocal002='"||g_dlang||"' ",
               " LEFT JOIN oocal_t t14 ON t14.oocalent='"||g_enterprise||"' AND t14.oocal001=xmdd201 AND t14.oocal002='"||g_dlang||"' ",
               " LEFT JOIN oocal_t t15 ON t15.oocalent='"||g_enterprise||"' AND t15.oocal001=xmdd024 AND t15.oocal002='"||g_dlang||"' ",
               " LEFT JOIN oocal_t t16 ON t16.oocalent='"||g_enterprise||"' AND t16.oocal001=xmdd026 AND t16.oocal002='"||g_dlang||"' ",
               " LEFT JOIN pmaal_t t17 ON t17.pmaalent='"||g_enterprise||"' AND t17.pmaal001=xmdd207 AND t17.pmaal002='"||g_dlang||"' ",
               " LEFT JOIN ooefl_t t18 ON t18.ooeflent='"||g_enterprise||"' AND t18.ooefl001=xmddunit AND t18.ooefl002='"||g_dlang||"' ",
               " LEFT JOIN oocql_t t19 ON t19.oocqlent='"||g_enterprise||"' AND t19.oocql001='274' AND t19.oocql002=xmdd210 AND t19.oocql003='"||g_dlang||"' ",
               " LEFT JOIN inaa_t t20 ON t20.inaaent='"||g_enterprise||"' AND t20.inaasite=xmddunit AND t20.inaa001=xmdd213  ",
               " LEFT JOIN inab_t t21 ON t21.inabent='"||g_enterprise||"' AND t21.inabsite=xmddunit AND t21.inab001=xmdd213 AND t21.inab002=xmdd214  ",
               " LEFT JOIN ooefl_t t22 ON t22.ooeflent='"||g_enterprise||"' AND t22.ooefl001=xmddsite AND t22.ooefl002='"||g_dlang||"' ",
               " LEFT JOIN oojdl_t t23 ON t23.oojdlent='"||g_enterprise||"' AND t23.oojdl001=xmdd218 AND t23.oojdl002='"||g_dlang||"' ",
               " LEFT JOIN dbbal_t t24 ON t24.dbbalent='"||g_enterprise||"' AND t24.dbbal001=xmdd219 AND t24.dbbal002='"||g_dlang||"' ",
               " LEFT JOIN dbbcl_t t25 ON t25.dbbclent='"||g_enterprise||"' AND t25.dbbcl001=xmdd220 AND t25.dbbcl002='"||g_dlang||"' ",
               " LEFT JOIN ooefl_t t26 ON t26.ooeflent='"||g_enterprise||"' AND t26.ooefl001=xmdd222 AND t26.ooefl002='"||g_dlang||"' ",
               " LEFT JOIN ooag_t t27 ON t27.ooagent='"||g_enterprise||"' AND t27.ooag001=xmdd223  ",
               " LEFT JOIN ooefl_t t28 ON t28.ooeflent='"||g_enterprise||"' AND t28.ooefl001=xmdd224 AND t28.ooefl002='"||g_dlang||"' ",
               " LEFT JOIN ooefl_t t29 ON t29.ooeflent='"||g_enterprise||"' AND t29.ooefl001=xmddorga AND t29.ooefl002='"||g_dlang||"' ",
               " LEFT JOIN oocql_t t30 ON t30.oocqlent='"||g_enterprise||"' AND t30.oocql001='2060' AND t30.oocql002=xmdd227 AND t30.oocql003='"||g_dlang||"' ",
               " LEFT JOIN staal_t t31 ON t31.staalent='"||g_enterprise||"' AND t31.staal001=xmdd228 AND t31.staal002='"||g_dlang||"' ",
               " LEFT JOIN ooag_t t32 ON t32.ooagent='"||g_enterprise||"' AND t32.ooag001=xmdd022  ",
 
                  " WHERE xmddent=? AND xmdddocno=?"   
      LET g_sql = cl_sql_add_mask(g_sql)              #遮蔽特定資料
      #add-point:b_fill段sql_before
      {<point name="b_fill.body2.fill_sql"/>}
      #end add-point
      IF NOT cl_null(g_wc2_table2) THEN
         LET g_sql = g_sql CLIPPED," AND ",g_wc2_table2 CLIPPED
      END IF
      
      #子單身的WC
      
      
      LET g_sql = g_sql, " ORDER BY xmdd_t.xmddseq,xmdd_t.xmddseq1,xmdd_t.xmddseq2"
      
      #add-point:單身填充控制
      {<point name="b_fill.sql2"/>}
      #end add-point
      
      LET g_sql = cl_sql_add_mask(g_sql)              #遮蔽特定資料
      PREPARE adbt500_pb2 FROM g_sql
      DECLARE b_fill_cs2 CURSOR FOR adbt500_pb2
      
      LET l_ac = 1
      
      OPEN b_fill_cs2 USING g_enterprise,g_xmda_m.xmdadocno
                                               
      FOREACH b_fill_cs2 INTO g_xmdc3_d[l_ac].xmdddocno,g_xmdc3_d[l_ac].xmddseq,g_xmdc3_d[l_ac].xmddseq1, 
          g_xmdc3_d[l_ac].xmdd229,g_xmdc3_d[l_ac].xmdd003,g_xmdc3_d[l_ac].xmdd001,g_xmdc3_d[l_ac].xmdd002, 
          g_xmdc3_d[l_ac].xmdd200,g_xmdc3_d[l_ac].xmdd004,g_xmdc3_d[l_ac].xmdd005,g_xmdc3_d[l_ac].xmdd011, 
          g_xmdc3_d[l_ac].xmdd012,g_xmdc3_d[l_ac].xmddseq2,g_xmdc3_d[l_ac].xmdd006,g_xmdc3_d[l_ac].xmdd201, 
          g_xmdc3_d[l_ac].xmdd202,g_xmdc3_d[l_ac].xmdd024,g_xmdc3_d[l_ac].xmdd025,g_xmdc3_d[l_ac].xmdd026, 
          g_xmdc3_d[l_ac].xmdd027,g_xmdc3_d[l_ac].xmdd203,g_xmdc3_d[l_ac].xmdd204,g_xmdc3_d[l_ac].xmdd205, 
          g_xmdc3_d[l_ac].xmdd206,g_xmdc3_d[l_ac].xmdd029,g_xmdc3_d[l_ac].xmdd028,g_xmdc3_d[l_ac].xmdd019, 
          g_xmdc3_d[l_ac].xmdd030,g_xmdc3_d[l_ac].xmdd207,g_xmdc3_d[l_ac].xmddunit,g_xmdc3_d[l_ac].xmdd210, 
          g_xmdc3_d[l_ac].xmdd212,g_xmdc3_d[l_ac].xmdd213,g_xmdc3_d[l_ac].xmdd214,g_xmdc3_d[l_ac].xmdd215, 
          g_xmdc3_d[l_ac].xmdd031,g_xmdc3_d[l_ac].xmdd014,g_xmdc3_d[l_ac].xmdd015,g_xmdc3_d[l_ac].xmdd016, 
          g_xmdc3_d[l_ac].xmdd017,g_xmdc3_d[l_ac].xmdd221,g_xmdc3_d[l_ac].xmddsite,g_xmdc3_d[l_ac].xmdd218, 
          g_xmdc3_d[l_ac].xmdd219,g_xmdc3_d[l_ac].xmdd220,g_xmdc3_d[l_ac].xmdd222,g_xmdc3_d[l_ac].xmdd223, 
          g_xmdc3_d[l_ac].xmdd224,g_xmdc3_d[l_ac].xmddorga,g_xmdc3_d[l_ac].xmdd226,g_xmdc3_d[l_ac].xmdd227, 
          g_xmdc3_d[l_ac].xmdd228,g_xmdc3_d[l_ac].xmdd013,g_xmdc3_d[l_ac].xmdd009,g_xmdc3_d[l_ac].xmdd018, 
          g_xmdc3_d[l_ac].xmdd020,g_xmdc3_d[l_ac].xmdd021,g_xmdc3_d[l_ac].xmdd022,g_xmdc3_d[l_ac].xmdd023, 
          g_xmdc3_d[l_ac].xmdd001_desc,g_xmdc3_d[l_ac].xmdd001_desc_desc,g_xmdc3_d[l_ac].xmdd200_desc, 
          g_xmdc3_d[l_ac].xmdd004_desc,g_xmdc3_d[l_ac].xmdd201_desc,g_xmdc3_d[l_ac].xmdd024_desc,g_xmdc3_d[l_ac].xmdd026_desc, 
          g_xmdc3_d[l_ac].xmdd207_desc,g_xmdc3_d[l_ac].xmddunit_desc,g_xmdc3_d[l_ac].xmdd210_desc,g_xmdc3_d[l_ac].xmdd213_desc, 
          g_xmdc3_d[l_ac].xmdd214_desc,g_xmdc3_d[l_ac].xmddsite_desc,g_xmdc3_d[l_ac].xmdd218_desc,g_xmdc3_d[l_ac].xmdd219_desc, 
          g_xmdc3_d[l_ac].xmdd220_desc,g_xmdc3_d[l_ac].xmdd222_desc,g_xmdc3_d[l_ac].xmdd223_desc,g_xmdc3_d[l_ac].xmdd224_desc, 
          g_xmdc3_d[l_ac].xmddorga_desc,g_xmdc3_d[l_ac].xmdd227_desc,g_xmdc3_d[l_ac].xmdd228_desc,g_xmdc3_d[l_ac].xmdd022_desc 

         IF SQLCA.sqlcode THEN
            CALL cl_err("FOREACH:",SQLCA.sqlcode,1)
            EXIT FOREACH
         END IF
        
         #add-point:b_fill段資料填充
         {<point name="b_fill2.fill"/>}
         #end add-point
      
         LET l_ac = l_ac + 1
         IF l_ac > g_max_rec THEN
            CALL cl_err( '', 9035, 0 )
            EXIT FOREACH
         END IF
         
      END FOREACH
   END IF
 
   #判斷是否填充
   IF adbt500_fill_chk(3) THEN
      LET g_sql = "SELECT  UNIQUE xmjaunit,xmjaseq,xmjasite,xmja001,xmja002,xmja003,xmja033,xmja004, 
          xmja005,xmja006,xmja007,xmja011,xmja012,xmja013,xmja014,xmja015,xmja016,xmja017,xmja018,xmja008, 
          xmja009,xmja010,xmja022,xmja019,xmja020,xmja021,xmja024,xmja025,xmja026,xmja027,xmja028,xmja029, 
          xmja030,xmja031,xmja032,xmja034 ,t33.ooefl003 ,t34.imaal003 ,t35.imaal004 ,t36.prcfl003 ,t37.oocal003 , 
          t38.oocal003 ,t39.oocal003 ,t40.oocal003 ,t41.pmaal004 ,t42.dbadl003 FROM xmja_t",   
                  " INNER JOIN xmda_t ON xmdadocno = xmjadocno ",
 
                  "",
                  
                                 " LEFT JOIN ooefl_t t33 ON t33.ooeflent='"||g_enterprise||"' AND t33.ooefl001=xmjasite AND t33.ooefl002='"||g_dlang||"' ",
               " LEFT JOIN imaal_t t34 ON t34.imaalent='"||g_enterprise||"' AND t34.imaal001=xmja003 AND t34.imaal002='"||g_dlang||"' ",
               " LEFT JOIN imaal_t t35 ON t35.imaalent='"||g_enterprise||"' AND t35.imaal001=xmja003 AND t35.imaal002='"||g_dlang||"' ",
               " LEFT JOIN prcfl_t t36 ON t36.prcflent='"||g_enterprise||"' AND t36.prcfl001=xmja005 AND t36.prcfl002='"||g_dlang||"' ",
               " LEFT JOIN oocal_t t37 ON t37.oocalent='"||g_enterprise||"' AND t37.oocal001=xmja011 AND t37.oocal002='"||g_dlang||"' ",
               " LEFT JOIN oocal_t t38 ON t38.oocalent='"||g_enterprise||"' AND t38.oocal001=xmja013 AND t38.oocal002='"||g_dlang||"' ",
               " LEFT JOIN oocal_t t39 ON t39.oocalent='"||g_enterprise||"' AND t39.oocal001=xmja015 AND t39.oocal002='"||g_dlang||"' ",
               " LEFT JOIN oocal_t t40 ON t40.oocalent='"||g_enterprise||"' AND t40.oocal001=xmja017 AND t40.oocal002='"||g_dlang||"' ",
               " LEFT JOIN pmaal_t t41 ON t41.pmaalent='"||g_enterprise||"' AND t41.pmaal001=xmja024 AND t41.pmaal002='"||g_dlang||"' ",
               " LEFT JOIN dbadl_t t42 ON t42.dbadlent='"||g_enterprise||"' AND t42.dbadl001=xmja027 AND t42.dbadl002='"||g_dlang||"' ",
 
                  " WHERE xmjaent=? AND xmjadocno=?"   
      LET g_sql = cl_sql_add_mask(g_sql)              #遮蔽特定資料
      #add-point:b_fill段sql_before
      {<point name="b_fill.body3.fill_sql"/>}
      #end add-point
      IF NOT cl_null(g_wc2_table3) THEN
         LET g_sql = g_sql CLIPPED," AND ",g_wc2_table3 CLIPPED
      END IF
      
      #子單身的WC
      
      
      LET g_sql = g_sql, " ORDER BY xmja_t.xmjaseq"
      
      #add-point:單身填充控制
      {<point name="b_fill.sql3"/>}
      #end add-point
      
      LET g_sql = cl_sql_add_mask(g_sql)              #遮蔽特定資料
      PREPARE adbt500_pb3 FROM g_sql
      DECLARE b_fill_cs3 CURSOR FOR adbt500_pb3
      
      LET l_ac = 1
      
      OPEN b_fill_cs3 USING g_enterprise,g_xmda_m.xmdadocno
                                               
      FOREACH b_fill_cs3 INTO g_xmdc4_d[l_ac].xmjaunit,g_xmdc4_d[l_ac].xmjaseq,g_xmdc4_d[l_ac].xmjasite, 
          g_xmdc4_d[l_ac].xmja001,g_xmdc4_d[l_ac].xmja002,g_xmdc4_d[l_ac].xmja003,g_xmdc4_d[l_ac].xmja033, 
          g_xmdc4_d[l_ac].xmja004,g_xmdc4_d[l_ac].xmja005,g_xmdc4_d[l_ac].xmja006,g_xmdc4_d[l_ac].xmja007, 
          g_xmdc4_d[l_ac].xmja011,g_xmdc4_d[l_ac].xmja012,g_xmdc4_d[l_ac].xmja013,g_xmdc4_d[l_ac].xmja014, 
          g_xmdc4_d[l_ac].xmja015,g_xmdc4_d[l_ac].xmja016,g_xmdc4_d[l_ac].xmja017,g_xmdc4_d[l_ac].xmja018, 
          g_xmdc4_d[l_ac].xmja008,g_xmdc4_d[l_ac].xmja009,g_xmdc4_d[l_ac].xmja010,g_xmdc4_d[l_ac].xmja022, 
          g_xmdc4_d[l_ac].xmja019,g_xmdc4_d[l_ac].xmja020,g_xmdc4_d[l_ac].xmja021,g_xmdc4_d[l_ac].xmja024, 
          g_xmdc4_d[l_ac].xmja025,g_xmdc4_d[l_ac].xmja026,g_xmdc4_d[l_ac].xmja027,g_xmdc4_d[l_ac].xmja028, 
          g_xmdc4_d[l_ac].xmja029,g_xmdc4_d[l_ac].xmja030,g_xmdc4_d[l_ac].xmja031,g_xmdc4_d[l_ac].xmja032, 
          g_xmdc4_d[l_ac].xmja034,g_xmdc4_d[l_ac].xmjasite_desc,g_xmdc4_d[l_ac].xmja003_desc,g_xmdc4_d[l_ac].xmja003_desc_desc, 
          g_xmdc4_d[l_ac].xmja005_desc,g_xmdc4_d[l_ac].xmja011_desc,g_xmdc4_d[l_ac].xmja013_desc,g_xmdc4_d[l_ac].xmja015_desc, 
          g_xmdc4_d[l_ac].xmja017_desc,g_xmdc4_d[l_ac].xmja024_desc,g_xmdc4_d[l_ac].xmja027_desc
         IF SQLCA.sqlcode THEN
            CALL cl_err("FOREACH:",SQLCA.sqlcode,1)
            EXIT FOREACH
         END IF
        
         #add-point:b_fill段資料填充
         {<point name="b_fill3.fill"/>}
         #end add-point
      
         LET l_ac = l_ac + 1
         IF l_ac > g_max_rec THEN
            CALL cl_err( '', 9035, 0 )
            EXIT FOREACH
         END IF
         
      END FOREACH
   END IF
 
   #判斷是否填充
   IF adbt500_fill_chk(4) THEN
      LET g_sql = "SELECT  UNIQUE xmdbsite,xmdb001,xmdb002,xmdb003,xmdb004,xmdb005,xmdb006,xmdb007,xmdb008, 
          xmdb009 ,t43.ooibl004 FROM xmdb_t",   
                  " INNER JOIN xmda_t ON xmdadocno = xmdbdocno ",
 
                  "",
                  
                                 " LEFT JOIN ooibl_t t43 ON t43.ooiblent='"||g_enterprise||"' AND t43.ooibl002=xmdb002 AND t43.ooibl003='"||g_dlang||"' ",
 
                  " WHERE xmdbent=? AND xmdbdocno=?"   
      LET g_sql = cl_sql_add_mask(g_sql)              #遮蔽特定資料
      #add-point:b_fill段sql_before
      {<point name="b_fill.body4.fill_sql"/>}
      #end add-point
      IF NOT cl_null(g_wc2_table4) THEN
         LET g_sql = g_sql CLIPPED," AND ",g_wc2_table4 CLIPPED
      END IF
      
      #子單身的WC
      
      
      LET g_sql = g_sql, " ORDER BY xmdb_t.xmdb001"
      
      #add-point:單身填充控制
      {<point name="b_fill.sql4"/>}
      #end add-point
      
      LET g_sql = cl_sql_add_mask(g_sql)              #遮蔽特定資料
      PREPARE adbt500_pb4 FROM g_sql
      DECLARE b_fill_cs4 CURSOR FOR adbt500_pb4
      
      LET l_ac = 1
      
      OPEN b_fill_cs4 USING g_enterprise,g_xmda_m.xmdadocno
                                               
      FOREACH b_fill_cs4 INTO g_xmdc5_d[l_ac].xmdbsite,g_xmdc5_d[l_ac].xmdb001,g_xmdc5_d[l_ac].xmdb002, 
          g_xmdc5_d[l_ac].xmdb003,g_xmdc5_d[l_ac].xmdb004,g_xmdc5_d[l_ac].xmdb005,g_xmdc5_d[l_ac].xmdb006, 
          g_xmdc5_d[l_ac].xmdb007,g_xmdc5_d[l_ac].xmdb008,g_xmdc5_d[l_ac].xmdb009,g_xmdc5_d[l_ac].xmdb002_desc 

         IF SQLCA.sqlcode THEN
            CALL cl_err("FOREACH:",SQLCA.sqlcode,1)
            EXIT FOREACH
         END IF
        
         #add-point:b_fill段資料填充
         {<point name="b_fill4.fill"/>}
         #end add-point
      
         LET l_ac = l_ac + 1
         IF l_ac > g_max_rec THEN
            CALL cl_err( '', 9035, 0 )
            EXIT FOREACH
         END IF
         
      END FOREACH
   END IF
 
   #判斷是否填充
   IF adbt500_fill_chk(5) THEN
      LET g_sql = "SELECT  UNIQUE xrcdseq,xrcdld,xrcd002,xrcdseq2,xrcd007,xrcd003,xrcd006,xrcd004,xrcd104 , 
          t46.oodbl004 FROM xrcd_t",   
                  " INNER JOIN xmda_t ON xmdadocno = xrcddocno ",
 
                  "",
                  
                                 " LEFT JOIN oodbl_t t46 ON t46.oodblent='"||g_enterprise||"' AND t46.oodbl002=xrcd002 AND t46.oodbl003='"||g_dlang||"' ",
 
                  " WHERE xrcdent=? AND xrcddocno=?"   
      LET g_sql = cl_sql_add_mask(g_sql)              #遮蔽特定資料
      #add-point:b_fill段sql_before
      {<point name="b_fill.body5.fill_sql"/>}
      #end add-point
      IF NOT cl_null(g_wc2_table5) THEN
         LET g_sql = g_sql CLIPPED," AND ",g_wc2_table5 CLIPPED
      END IF
      
      #子單身的WC
      
      
      LET g_sql = g_sql, " ORDER BY xrcd_t.xrcdld,xrcd_t.xrcdseq,xrcd_t.xrcdseq2,xrcd_t.xrcd007"
      
      #add-point:單身填充控制
      {<point name="b_fill.sql5"/>}
      #end add-point
      
      LET g_sql = cl_sql_add_mask(g_sql)              #遮蔽特定資料
      PREPARE adbt500_pb5 FROM g_sql
      DECLARE b_fill_cs5 CURSOR FOR adbt500_pb5
      
      LET l_ac = 1
      
      OPEN b_fill_cs5 USING g_enterprise,g_xmda_m.xmdadocno
                                               
      FOREACH b_fill_cs5 INTO g_xmdc6_d[l_ac].xrcdseq,g_xmdc6_d[l_ac].xrcdld,g_xmdc6_d[l_ac].xrcd002, 
          g_xmdc6_d[l_ac].xrcdseq2,g_xmdc6_d[l_ac].xrcd007,g_xmdc6_d[l_ac].xrcd003,g_xmdc6_d[l_ac].xrcd006, 
          g_xmdc6_d[l_ac].xrcd004,g_xmdc6_d[l_ac].xrcd104,g_xmdc6_d[l_ac].xrcd002_desc
         IF SQLCA.sqlcode THEN
            CALL cl_err("FOREACH:",SQLCA.sqlcode,1)
            EXIT FOREACH
         END IF
        
         #add-point:b_fill段資料填充
         {<point name="b_fill5.fill"/>}
         #end add-point
      
         LET l_ac = l_ac + 1
         IF l_ac > g_max_rec THEN
            CALL cl_err( '', 9035, 0 )
            EXIT FOREACH
         END IF
         
      END FOREACH
   END IF
 
 
   
   #add-point:browser_fill段其他table處理
   {<point name="browser_fill.other_fill"/>}
   #end add-point
   
   CALL g_xmdc_d.deleteElement(g_xmdc_d.getLength())
   CALL g_xmdc3_d.deleteElement(g_xmdc3_d.getLength())
   CALL g_xmdc4_d.deleteElement(g_xmdc4_d.getLength())
   CALL g_xmdc5_d.deleteElement(g_xmdc5_d.getLength())
   CALL g_xmdc6_d.deleteElement(g_xmdc6_d.getLength())
 
   
 
   LET l_ac = g_cnt
   LET g_cnt = 0  
   
   FREE adbt500_pb
   FREE adbt500_pb2
 
   FREE adbt500_pb3
 
   FREE adbt500_pb4
 
   FREE adbt500_pb5
 
 
   
END FUNCTION
]]>
  </section>
  <section id="adbt500.b_fill2" ver="3" status="" src="s">
    <![CDATA[#+ 單身陣列填充2
PRIVATE FUNCTION adbt500_b_fill2(pi_idx)
   DEFINE pi_idx          LIKE type_t.num5
   DEFINE li_ac           LIKE type_t.num5
   DEFINE ls_chk          LIKE type_t.chr1
   #add-point:b_fill2段define
   {<point name="b_fill2.define"/>}
   #end add-point
   
   LET li_ac = l_ac 
   
   IF g_detail_idx <= 0 THEN
      RETURN
   END IF
   
 
      
   #add-point:單身填充後
   {<point name="b_fill2.after_fill" />}
   #end add-point
    
   LET l_ac = li_ac
   
   CALL adbt500_detail_show()
   
END FUNCTION
]]>
  </section>
  <section id="adbt500.browser_fill" ver="39" status="" src="s">
    <![CDATA[#+ 瀏覽頁簽資料填充
PRIVATE FUNCTION adbt500_browser_fill(ps_page_action)
   DEFINE ps_page_action    STRING
   DEFINE l_wc              STRING
   DEFINE l_wc2             STRING
   DEFINE l_sql             STRING
   DEFINE l_sub_sql         STRING
   DEFINE l_sql_rank        STRING
   DEFINE l_searchcol       STRING
   #add-point:browser_fill段define
   {<point name="browser_fill.define"/>}
   #end add-point    
 
   #清除畫面
   CLEAR FORM                
   INITIALIZE g_xmda_m.* TO NULL
   CALL g_xmdc_d.clear()        
   CALL g_xmdc3_d.clear() 
   CALL g_xmdc4_d.clear() 
   CALL g_xmdc5_d.clear() 
   CALL g_xmdc6_d.clear() 
 
   CALL g_browser.clear()
   #add-point:browser_fill段動作開始前
   {<point name="browser_fill.before_browser_fill"/>}
   #end add-point
   
   #搜尋用
   IF cl_null(g_searchcol) OR g_searchcol = '0' THEN
      LET l_searchcol = "xmdadocno"
   ELSE
      LET l_searchcol = g_searchcol
   END IF
   
   IF cl_null(g_wc) THEN
      LET g_wc = " 1=1"
   END IF
   IF cl_null(g_wc2) THEN
      LET g_wc2 = " 1=1"
   END IF
   LET l_wc  = g_wc.trim() 
   LET l_wc2 = g_wc2.trim()
 
   #add-point:browser_fill,foreach前
   {<point name="browser_fill.before_foreach"/>}
   #end add-point
    
   IF g_wc2 <> " 1=1" THEN
      #單身有輸入搜尋條件                      
      LET l_sub_sql = " SELECT UNIQUE xmdadocno ",
                      " FROM xmda_t ",
                      " ",
                      " LEFT JOIN xmdc_t ON xmdcent = xmdaent AND xmdadocno = xmdcdocno ",
                      " LEFT JOIN xmdd_t ON xmddent = xmdaent AND xmdadocno = xmdddocno", 
 
                      " LEFT JOIN xmja_t ON xmjaent = xmdaent AND xmdadocno = xmjadocno", 
 
                      " LEFT JOIN xmdb_t ON xmdbent = xmdaent AND xmdadocno = xmdbdocno", 
 
                      " LEFT JOIN xrcd_t ON xrcdent = xmdaent AND xmdadocno = xrcddocno", 
 
 
 
                      " ", 
                      " ", 
                      " WHERE xmdaent = '" ||g_enterprise|| "' AND xmdcent = '" ||g_enterprise|| "' AND ",l_wc, " AND ", l_wc2, cl_sql_add_filter("xmda_t")
   ELSE
      #單身未輸入搜尋條件
      LET l_sub_sql = " SELECT UNIQUE xmdadocno ",
                      " FROM xmda_t ", 
                      "  ",
                      "  ",
                      " WHERE xmdaent = '" ||g_enterprise|| "' AND ",l_wc CLIPPED, cl_sql_add_filter("xmda_t")
   END IF
   
   LET g_sql = " SELECT COUNT(*) FROM (",l_sub_sql,")"
   
   #add-point:browser_fill,count前
   {<point name="browser_fill.before_count"/>}
   #end add-point
   
   PREPARE header_cnt_pre FROM g_sql
   EXECUTE header_cnt_pre INTO g_browser_cnt   #總筆數
   FREE header_cnt_pre
 
   DISPLAY g_browser_cnt TO FORMONLY.b_count   #總筆數的顯示
   DISPLAY g_browser_cnt TO FORMONLY.h_count   #總筆數的顯示
 
   #依照xmdadocno,xmdadocdt,xmda001,xmda002,'',xmda003,'',xmda004,'' Browser欄位定義(取代原本bs_sql功能)
   LET g_sql = " SELECT DISTINCT xmdastus,xmdadocno,xmdadocdt,xmda001,xmda002,'',xmda003,'',xmda004, 
       '',t1.ooag011 ,t2.ooefl003 ,t3.pmaal004 ",
               " FROM xmda_t ",
               "  ",
               "  LEFT JOIN xmdc_t ON xmdcent = xmdaent AND xmdadocno = xmdcdocno ",
               "  LEFT JOIN xmdd_t ON xmddent = xmdaent AND xmdadocno = xmdddocno",
 
               "  LEFT JOIN xmja_t ON xmjaent = xmdaent AND xmdadocno = xmjadocno",
 
               "  LEFT JOIN xmdb_t ON xmdbent = xmdaent AND xmdadocno = xmdbdocno",
 
               "  LEFT JOIN xrcd_t ON xrcdent = xmdaent AND xmdadocno = xrcddocno",
 
 
 
               "  ",
               "  ",
                              " LEFT JOIN ooag_t t1 ON t1.ooagent='"||g_enterprise||"' AND t1.ooag001=xmda002  ",
               " LEFT JOIN ooefl_t t2 ON t2.ooeflent='"||g_enterprise||"' AND t2.ooefl001=xmda003 AND t2.ooefl002='"||g_lang||"' ",
               " LEFT JOIN pmaal_t t3 ON t3.pmaalent='"||g_enterprise||"' AND t3.pmaal001=xmda004 AND t3.pmaal002='"||g_lang||"' ",
 
               " WHERE xmdaent = '" ||g_enterprise|| "' AND ",l_wc," AND ",l_wc2, cl_sql_add_filter("xmda_t"),
               " ORDER BY ",l_searchcol," ",g_order
 
   #add-point:browser_fill,before_prepare
   {<point name="browser_fill.before_prepare"/>}
   #end add-point
        
   LET g_sql = cl_sql_add_mask(g_sql)              #遮蔽特定資料
   PREPARE browse_pre FROM g_sql
   DECLARE browse_cur CURSOR FOR browse_pre
   
   #add-point:browser_fill,open
   {<point name="browser_fill.open"/>}
   #end add-point
 
   CALL g_browser.clear()
   LET g_cnt = 1
   FOREACH browse_cur INTO g_browser[g_cnt].b_statepic,g_browser[g_cnt].b_xmdadocno,g_browser[g_cnt].b_xmdadocdt, 
       g_browser[g_cnt].b_xmda001,g_browser[g_cnt].b_xmda002,g_browser[g_cnt].b_xmda002_desc,g_browser[g_cnt].b_xmda003, 
       g_browser[g_cnt].b_xmda003_desc,g_browser[g_cnt].b_xmda004,g_browser[g_cnt].b_xmda004_desc,g_browser[g_cnt].b_xmda002_desc, 
       g_browser[g_cnt].b_xmda003_desc,g_browser[g_cnt].b_xmda004_desc
      IF SQLCA.sqlcode THEN
         CALL cl_err('foreach:',SQLCA.sqlcode,1)
         EXIT FOREACH
      END IF
  
      #add-point:browser_fill段reference
      {<point name="browser_fill.reference"/>}
      #end add-point
  
            #此段落由子樣板a24產生
      CASE g_browser[g_cnt].b_statepic
         WHEN "N"
            LET g_browser[g_cnt].b_statepic = "stus/16/unconfirmed.png"
         WHEN "X"
            LET g_browser[g_cnt].b_statepic = "stus/16/invalid.png"
         WHEN "Y"
            LET g_browser[g_cnt].b_statepic = "stus/16/confirmed.png"
         WHEN "A"
            LET g_browser[g_cnt].b_statepic = "stus/16/approved.png"
         WHEN "D"
            LET g_browser[g_cnt].b_statepic = "stus/16/withdraw.png"
         WHEN "R"
            LET g_browser[g_cnt].b_statepic = "stus/16/rejection.png"
         WHEN "W"
            LET g_browser[g_cnt].b_statepic = "stus/16/signing.png"
         WHEN "C"
            LET g_browser[g_cnt].b_statepic = "stus/16/closed.png"
         WHEN "H"
            LET g_browser[g_cnt].b_statepic = "stus/16/hold.png"
         
      END CASE
 
 
      LET g_cnt = g_cnt + 1
      IF g_cnt > g_max_rec THEN
         CALL cl_err('',9035,0)
         EXIT FOREACH
      END IF
      
   END FOREACH
 
   CALL g_browser.deleteElement(g_cnt)
   LET g_header_cnt = g_browser.getLength()
 
   LET g_rec_b = g_cnt - 1
   LET g_detail_cnt = g_rec_b
   LET g_cnt = 0
   
   FREE browse_pre
   
   #add-point:browser_fill段結束前
   {<point name="browser_fill.after"/>}
   #end add-point
   
   #若無資料則關閉相關功能
   IF g_browser_cnt = 0 THEN
      CALL cl_set_act_visible("statechange,modify,delete,reproduce", FALSE)
   ELSE
      CALL cl_set_act_visible("statechange,modify,delete,reproduce", TRUE)
   END IF
   
END FUNCTION
]]>
  </section>
  <section id="adbt500.browser_search" ver="3" status="" src="s">
    <![CDATA[#+ 瀏覽頁簽資料搜尋
PRIVATE FUNCTION adbt500_browser_search(p_type)
   DEFINE p_type LIKE type_t.chr10
   #add-point:browser_search段define
   {<point name="browser_search.define"/>}
   #end add-point    
   
   #若無輸入關鍵字則查找出所有資料
   IF NOT cl_null(g_searchstr) AND g_searchcol='0' THEN
      CALL cl_err("searchcol","std-00005",0)
      RETURN FALSE 
   END IF 
   
   IF NOT cl_null(g_searchstr) THEN
      LET g_wc = " lower(", g_searchcol, ") LIKE '%", g_searchstr, "%'"
      LET g_wc = g_wc.toLowerCase()
   ELSE
      LET g_wc = " 1=1 "
   END IF         
   
   #若為排序搜尋則添加以下條件
   IF cl_null(g_searchcol) OR g_searchcol = "0" THEN
      LET g_wc = g_wc, " ORDER BY xmdadocno"
   ELSE
      LET g_wc = g_wc, " ORDER BY ", g_searchcol
   END IF 
 
   CALL adbt500_browser_fill("F")
   RETURN TRUE
 
END FUNCTION
]]>
  </section>
  <section id="adbt500.construct" ver="148" status="" src="s">
    <![CDATA[#+ QBE資料查詢
PRIVATE FUNCTION adbt500_construct()
   DEFINE ls_return   STRING
   DEFINE ls_result   STRING 
   DEFINE ls_wc       STRING 
   #add-point:cs段define
   {<point name="cs.define"/>}
   #end add-point    
 
   #清除畫面
   CLEAR FORM                
   INITIALIZE g_xmda_m.* TO NULL
   CALL g_xmdc_d.clear()        
   CALL g_xmdc3_d.clear() 
   CALL g_xmdc4_d.clear() 
   CALL g_xmdc5_d.clear() 
   CALL g_xmdc6_d.clear() 
 
   
   LET g_action_choice = ""
    
   INITIALIZE g_wc TO NULL
   INITIALIZE g_wc2 TO NULL
   
   INITIALIZE g_wc2_table1 TO NULL
   INITIALIZE g_wc2_table2 TO NULL
 
   INITIALIZE g_wc2_table3 TO NULL
 
   INITIALIZE g_wc2_table4 TO NULL
 
   INITIALIZE g_wc2_table5 TO NULL
 
 
    
   LET g_qryparam.state = 'c'
   
   #add-point:cs段開始前
   {<point name="cs.before_construct"/>}
   #end add-point 
   
   #使用DIALOG包住 單頭CONSTRUCT及單身CONSTRUCT
   DIALOG ATTRIBUTES(UNBUFFERED,FIELD ORDER FORM)
      
      #單頭
      CONSTRUCT BY NAME g_wc ON xmdasite,xmdadocdt,xmdadocno,xmda001,xmda005,xmda202,xmda023,xmda004, 
          xmda200,xmda201,xmdastus,xmda007,xmda008,xmda021,xmda022,xmda203,xmda027,xmda024,xmda002,xmda003, 
          xmdaunit,xmda204,xmda205,xmda032,xmda071,xmda025,xmda025_desc,oofb017,xmda026,xmda026_desc, 
          oofb017_1,xmda206,xmda207,xmda020,xmda036,xmda009,xmda010,xmda015,xmda016,xmda011,xmda011_desc, 
          xmda012,xmda013,xmda035,xmda035_desc,xmda039,xmdaownid,xmdaowndp,xmdacrtid,xmdacrtdp,xmdacrtdt, 
          xmdamodid,xmdamoddt,xmdacnfid,xmdacnfdt,xmda034,xmda006,xmda033,xmda017,xmda019,xmda018,xmda044, 
          xmda030,xmda031,xmda045,xmda046,xmda047,xmda028
 
         BEFORE CONSTRUCT
            #add-point:cs段before_construct
            {<point name="cs.head.before_construct"/>}
            #end add-point 
            
         #公用欄位開窗相關處理
         #此段落由子樣板a11產生
         ##----<<xmdacrtdt>>----
         AFTER FIELD xmdacrtdt
            CALL FGL_DIALOG_GETBUFFER() RETURNING ls_result
            IF NOT cl_null(ls_result) THEN
               IF NOT cl_chk_date_symbol(ls_result) THEN
                  LET ls_result = cl_add_date_extra_cond(ls_result)
               END IF
            END IF
            CALL FGL_DIALOG_SETBUFFER(ls_result)
         
         #----<<xmdamoddt>>----
         AFTER FIELD xmdamoddt
            CALL FGL_DIALOG_GETBUFFER() RETURNING ls_result
            IF NOT cl_null(ls_result) THEN
               IF NOT cl_chk_date_symbol(ls_result) THEN
                  LET ls_result = cl_add_date_extra_cond(ls_result)
               END IF
            END IF
            CALL FGL_DIALOG_SETBUFFER(ls_result)
         
         #----<<xmdacnfdt>>----
         AFTER FIELD xmdacnfdt
            CALL FGL_DIALOG_GETBUFFER() RETURNING ls_result
            IF NOT cl_null(ls_result) THEN
               IF NOT cl_chk_date_symbol(ls_result) THEN
                  LET ls_result = cl_add_date_extra_cond(ls_result)
               END IF
            END IF
            CALL FGL_DIALOG_SETBUFFER(ls_result)
         
         #----<<xmdapstdt>>----
 
 
            
         #一般欄位開窗相關處理    
                  #Ctrlp:construct.c.xmdasite
         ON ACTION controlp INFIELD xmdasite
            #add-point:ON ACTION controlp INFIELD xmdasite
            {<point name="construct.c.xmdasite" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdasite
            #add-point:BEFORE FIELD xmdasite
            {<point name="construct.b.xmdasite" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdasite
            
            #add-point:AFTER FIELD xmdasite
            {<point name="construct.a.xmdasite" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdadocdt
            #add-point:BEFORE FIELD xmdadocdt
            {<point name="construct.b.xmdadocdt" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdadocdt
            
            #add-point:AFTER FIELD xmdadocdt
            {<point name="construct.a.xmdadocdt" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmdadocdt
         ON ACTION controlp INFIELD xmdadocdt
            #add-point:ON ACTION controlp INFIELD xmdadocdt
            {<point name="construct.c.xmdadocdt" />}
            #END add-point
 
         #Ctrlp:construct.c.xmdadocno
         ON ACTION controlp INFIELD xmdadocno
            #add-point:ON ACTION controlp INFIELD xmdadocno
            {<point name="construct.c.xmdadocno" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdadocno
            #add-point:BEFORE FIELD xmdadocno
            {<point name="construct.b.xmdadocno" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdadocno
            
            #add-point:AFTER FIELD xmdadocno
            {<point name="construct.a.xmdadocno" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmda001
            #add-point:BEFORE FIELD xmda001
            {<point name="construct.b.xmda001" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmda001
            
            #add-point:AFTER FIELD xmda001
            {<point name="construct.a.xmda001" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmda001
         ON ACTION controlp INFIELD xmda001
            #add-point:ON ACTION controlp INFIELD xmda001
            {<point name="construct.c.xmda001" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmda005
            #add-point:BEFORE FIELD xmda005
            {<point name="construct.b.xmda005" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmda005
            
            #add-point:AFTER FIELD xmda005
            {<point name="construct.a.xmda005" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmda005
         ON ACTION controlp INFIELD xmda005
            #add-point:ON ACTION controlp INFIELD xmda005
            {<point name="construct.c.xmda005" />}
            #END add-point
 
         #Ctrlp:construct.c.xmda202
         ON ACTION controlp INFIELD xmda202
            #add-point:ON ACTION controlp INFIELD xmda202
            {<point name="construct.c.xmda202" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmda202
            #add-point:BEFORE FIELD xmda202
            {<point name="construct.b.xmda202" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmda202
            
            #add-point:AFTER FIELD xmda202
            {<point name="construct.a.xmda202" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmda023
         ON ACTION controlp INFIELD xmda023
            #add-point:ON ACTION controlp INFIELD xmda023
            {<point name="construct.c.xmda023" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmda023
            #add-point:BEFORE FIELD xmda023
            {<point name="construct.b.xmda023" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmda023
            
            #add-point:AFTER FIELD xmda023
            {<point name="construct.a.xmda023" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmda004
         ON ACTION controlp INFIELD xmda004
            #add-point:ON ACTION controlp INFIELD xmda004
            {<point name="construct.c.xmda004" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmda004
            #add-point:BEFORE FIELD xmda004
            {<point name="construct.b.xmda004" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmda004
            
            #add-point:AFTER FIELD xmda004
            {<point name="construct.a.xmda004" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmda200
         ON ACTION controlp INFIELD xmda200
            #add-point:ON ACTION controlp INFIELD xmda200
            {<point name="construct.c.xmda200" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmda200
            #add-point:BEFORE FIELD xmda200
            {<point name="construct.b.xmda200" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmda200
            
            #add-point:AFTER FIELD xmda200
            {<point name="construct.a.xmda200" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmda201
         ON ACTION controlp INFIELD xmda201
            #add-point:ON ACTION controlp INFIELD xmda201
            {<point name="construct.c.xmda201" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmda201
            #add-point:BEFORE FIELD xmda201
            {<point name="construct.b.xmda201" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmda201
            
            #add-point:AFTER FIELD xmda201
            {<point name="construct.a.xmda201" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdastus
            #add-point:BEFORE FIELD xmdastus
            {<point name="construct.b.xmdastus" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdastus
            
            #add-point:AFTER FIELD xmdastus
            {<point name="construct.a.xmdastus" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmdastus
         ON ACTION controlp INFIELD xmdastus
            #add-point:ON ACTION controlp INFIELD xmdastus
            {<point name="construct.c.xmdastus" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmda007
            #add-point:BEFORE FIELD xmda007
            {<point name="construct.b.xmda007" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmda007
            
            #add-point:AFTER FIELD xmda007
            {<point name="construct.a.xmda007" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmda007
         ON ACTION controlp INFIELD xmda007
            #add-point:ON ACTION controlp INFIELD xmda007
            {<point name="construct.c.xmda007" />}
            #END add-point
 
         #Ctrlp:construct.c.xmda008
         ON ACTION controlp INFIELD xmda008
            #add-point:ON ACTION controlp INFIELD xmda008
            {<point name="construct.c.xmda008" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmda008
            #add-point:BEFORE FIELD xmda008
            {<point name="construct.b.xmda008" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmda008
            
            #add-point:AFTER FIELD xmda008
            {<point name="construct.a.xmda008" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmda021
         ON ACTION controlp INFIELD xmda021
            #add-point:ON ACTION controlp INFIELD xmda021
            {<point name="construct.c.xmda021" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmda021
            #add-point:BEFORE FIELD xmda021
            {<point name="construct.b.xmda021" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmda021
            
            #add-point:AFTER FIELD xmda021
            {<point name="construct.a.xmda021" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmda022
         ON ACTION controlp INFIELD xmda022
            #add-point:ON ACTION controlp INFIELD xmda022
            {<point name="construct.c.xmda022" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmda022
            #add-point:BEFORE FIELD xmda022
            {<point name="construct.b.xmda022" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmda022
            
            #add-point:AFTER FIELD xmda022
            {<point name="construct.a.xmda022" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmda203
         ON ACTION controlp INFIELD xmda203
            #add-point:ON ACTION controlp INFIELD xmda203
            {<point name="construct.c.xmda203" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmda203
            #add-point:BEFORE FIELD xmda203
            {<point name="construct.b.xmda203" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmda203
            
            #add-point:AFTER FIELD xmda203
            {<point name="construct.a.xmda203" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmda027
            #add-point:BEFORE FIELD xmda027
            {<point name="construct.b.xmda027" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmda027
            
            #add-point:AFTER FIELD xmda027
            {<point name="construct.a.xmda027" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmda027
         ON ACTION controlp INFIELD xmda027
            #add-point:ON ACTION controlp INFIELD xmda027
            {<point name="construct.c.xmda027" />}
            #END add-point
 
         #Ctrlp:construct.c.xmda024
         ON ACTION controlp INFIELD xmda024
            #add-point:ON ACTION controlp INFIELD xmda024
            {<point name="construct.c.xmda024" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmda024
            #add-point:BEFORE FIELD xmda024
            {<point name="construct.b.xmda024" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmda024
            
            #add-point:AFTER FIELD xmda024
            {<point name="construct.a.xmda024" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmda002
         ON ACTION controlp INFIELD xmda002
            #add-point:ON ACTION controlp INFIELD xmda002
            {<point name="construct.c.xmda002" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmda002
            #add-point:BEFORE FIELD xmda002
            {<point name="construct.b.xmda002" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmda002
            
            #add-point:AFTER FIELD xmda002
            {<point name="construct.a.xmda002" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmda003
         ON ACTION controlp INFIELD xmda003
            #add-point:ON ACTION controlp INFIELD xmda003
            {<point name="construct.c.xmda003" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmda003
            #add-point:BEFORE FIELD xmda003
            {<point name="construct.b.xmda003" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmda003
            
            #add-point:AFTER FIELD xmda003
            {<point name="construct.a.xmda003" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmdaunit
         ON ACTION controlp INFIELD xmdaunit
            #add-point:ON ACTION controlp INFIELD xmdaunit
            {<point name="construct.c.xmdaunit" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdaunit
            #add-point:BEFORE FIELD xmdaunit
            {<point name="construct.b.xmdaunit" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdaunit
            
            #add-point:AFTER FIELD xmdaunit
            {<point name="construct.a.xmdaunit" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmda204
         ON ACTION controlp INFIELD xmda204
            #add-point:ON ACTION controlp INFIELD xmda204
            {<point name="construct.c.xmda204" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmda204
            #add-point:BEFORE FIELD xmda204
            {<point name="construct.b.xmda204" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmda204
            
            #add-point:AFTER FIELD xmda204
            {<point name="construct.a.xmda204" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmda205
            #add-point:BEFORE FIELD xmda205
            {<point name="construct.b.xmda205" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmda205
            
            #add-point:AFTER FIELD xmda205
            {<point name="construct.a.xmda205" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmda205
         ON ACTION controlp INFIELD xmda205
            #add-point:ON ACTION controlp INFIELD xmda205
            {<point name="construct.c.xmda205" />}
            #END add-point
 
         #Ctrlp:construct.c.xmda032
         ON ACTION controlp INFIELD xmda032
            #add-point:ON ACTION controlp INFIELD xmda032
            {<point name="construct.c.xmda032" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmda032
            #add-point:BEFORE FIELD xmda032
            {<point name="construct.b.xmda032" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmda032
            
            #add-point:AFTER FIELD xmda032
            {<point name="construct.a.xmda032" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmda071
            #add-point:BEFORE FIELD xmda071
            {<point name="construct.b.xmda071" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmda071
            
            #add-point:AFTER FIELD xmda071
            {<point name="construct.a.xmda071" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmda071
         ON ACTION controlp INFIELD xmda071
            #add-point:ON ACTION controlp INFIELD xmda071
            {<point name="construct.c.xmda071" />}
            #END add-point
 
         #Ctrlp:construct.c.xmda025
         ON ACTION controlp INFIELD xmda025
            #add-point:ON ACTION controlp INFIELD xmda025
            {<point name="construct.c.xmda025" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmda025
            #add-point:BEFORE FIELD xmda025
            {<point name="construct.b.xmda025" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmda025
            
            #add-point:AFTER FIELD xmda025
            {<point name="construct.a.xmda025" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmda025_desc
            #add-point:BEFORE FIELD xmda025_desc
            {<point name="construct.b.xmda025_desc" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmda025_desc
            
            #add-point:AFTER FIELD xmda025_desc
            {<point name="construct.a.xmda025_desc" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmda025_desc
         ON ACTION controlp INFIELD xmda025_desc
            #add-point:ON ACTION controlp INFIELD xmda025_desc
            {<point name="construct.c.xmda025_desc" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD oofb017
            #add-point:BEFORE FIELD oofb017
            {<point name="construct.b.oofb017" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD oofb017
            
            #add-point:AFTER FIELD oofb017
            {<point name="construct.a.oofb017" />}
            #END add-point
            
 
         #Ctrlp:construct.c.oofb017
         ON ACTION controlp INFIELD oofb017
            #add-point:ON ACTION controlp INFIELD oofb017
            {<point name="construct.c.oofb017" />}
            #END add-point
 
         #Ctrlp:construct.c.xmda026
         ON ACTION controlp INFIELD xmda026
            #add-point:ON ACTION controlp INFIELD xmda026
            {<point name="construct.c.xmda026" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmda026
            #add-point:BEFORE FIELD xmda026
            {<point name="construct.b.xmda026" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmda026
            
            #add-point:AFTER FIELD xmda026
            {<point name="construct.a.xmda026" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmda026_desc
            #add-point:BEFORE FIELD xmda026_desc
            {<point name="construct.b.xmda026_desc" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmda026_desc
            
            #add-point:AFTER FIELD xmda026_desc
            {<point name="construct.a.xmda026_desc" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmda026_desc
         ON ACTION controlp INFIELD xmda026_desc
            #add-point:ON ACTION controlp INFIELD xmda026_desc
            {<point name="construct.c.xmda026_desc" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD oofb017_1
            #add-point:BEFORE FIELD oofb017_1
            {<point name="construct.b.oofb017_1" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD oofb017_1
            
            #add-point:AFTER FIELD oofb017_1
            {<point name="construct.a.oofb017_1" />}
            #END add-point
            
 
         #Ctrlp:construct.c.oofb017_1
         ON ACTION controlp INFIELD oofb017_1
            #add-point:ON ACTION controlp INFIELD oofb017_1
            {<point name="construct.c.oofb017_1" />}
            #END add-point
 
         #Ctrlp:construct.c.xmda206
         ON ACTION controlp INFIELD xmda206
            #add-point:ON ACTION controlp INFIELD xmda206
            {<point name="construct.c.xmda206" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmda206
            #add-point:BEFORE FIELD xmda206
            {<point name="construct.b.xmda206" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmda206
            
            #add-point:AFTER FIELD xmda206
            {<point name="construct.a.xmda206" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmda207
         ON ACTION controlp INFIELD xmda207
            #add-point:ON ACTION controlp INFIELD xmda207
            {<point name="construct.c.xmda207" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmda207
            #add-point:BEFORE FIELD xmda207
            {<point name="construct.b.xmda207" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmda207
            
            #add-point:AFTER FIELD xmda207
            {<point name="construct.a.xmda207" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmda020
         ON ACTION controlp INFIELD xmda020
            #add-point:ON ACTION controlp INFIELD xmda020
            {<point name="construct.c.xmda020" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmda020
            #add-point:BEFORE FIELD xmda020
            {<point name="construct.b.xmda020" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmda020
            
            #add-point:AFTER FIELD xmda020
            {<point name="construct.a.xmda020" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmda036
         ON ACTION controlp INFIELD xmda036
            #add-point:ON ACTION controlp INFIELD xmda036
            {<point name="construct.c.xmda036" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmda036
            #add-point:BEFORE FIELD xmda036
            {<point name="construct.b.xmda036" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmda036
            
            #add-point:AFTER FIELD xmda036
            {<point name="construct.a.xmda036" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmda009
         ON ACTION controlp INFIELD xmda009
            #add-point:ON ACTION controlp INFIELD xmda009
            {<point name="construct.c.xmda009" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmda009
            #add-point:BEFORE FIELD xmda009
            {<point name="construct.b.xmda009" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmda009
            
            #add-point:AFTER FIELD xmda009
            {<point name="construct.a.xmda009" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmda010
         ON ACTION controlp INFIELD xmda010
            #add-point:ON ACTION controlp INFIELD xmda010
            {<point name="construct.c.xmda010" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmda010
            #add-point:BEFORE FIELD xmda010
            {<point name="construct.b.xmda010" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmda010
            
            #add-point:AFTER FIELD xmda010
            {<point name="construct.a.xmda010" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmda015
         ON ACTION controlp INFIELD xmda015
            #add-point:ON ACTION controlp INFIELD xmda015
            {<point name="construct.c.xmda015" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmda015
            #add-point:BEFORE FIELD xmda015
            {<point name="construct.b.xmda015" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmda015
            
            #add-point:AFTER FIELD xmda015
            {<point name="construct.a.xmda015" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmda016
            #add-point:BEFORE FIELD xmda016
            {<point name="construct.b.xmda016" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmda016
            
            #add-point:AFTER FIELD xmda016
            {<point name="construct.a.xmda016" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmda016
         ON ACTION controlp INFIELD xmda016
            #add-point:ON ACTION controlp INFIELD xmda016
            {<point name="construct.c.xmda016" />}
            #END add-point
 
         #Ctrlp:construct.c.xmda011
         ON ACTION controlp INFIELD xmda011
            #add-point:ON ACTION controlp INFIELD xmda011
            {<point name="construct.c.xmda011" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmda011
            #add-point:BEFORE FIELD xmda011
            {<point name="construct.b.xmda011" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmda011
            
            #add-point:AFTER FIELD xmda011
            {<point name="construct.a.xmda011" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmda011_desc
            #add-point:BEFORE FIELD xmda011_desc
            {<point name="construct.b.xmda011_desc" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmda011_desc
            
            #add-point:AFTER FIELD xmda011_desc
            {<point name="construct.a.xmda011_desc" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmda011_desc
         ON ACTION controlp INFIELD xmda011_desc
            #add-point:ON ACTION controlp INFIELD xmda011_desc
            {<point name="construct.c.xmda011_desc" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmda012
            #add-point:BEFORE FIELD xmda012
            {<point name="construct.b.xmda012" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmda012
            
            #add-point:AFTER FIELD xmda012
            {<point name="construct.a.xmda012" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmda012
         ON ACTION controlp INFIELD xmda012
            #add-point:ON ACTION controlp INFIELD xmda012
            {<point name="construct.c.xmda012" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmda013
            #add-point:BEFORE FIELD xmda013
            {<point name="construct.b.xmda013" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmda013
            
            #add-point:AFTER FIELD xmda013
            {<point name="construct.a.xmda013" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmda013
         ON ACTION controlp INFIELD xmda013
            #add-point:ON ACTION controlp INFIELD xmda013
            {<point name="construct.c.xmda013" />}
            #END add-point
 
         #Ctrlp:construct.c.xmda035
         ON ACTION controlp INFIELD xmda035
            #add-point:ON ACTION controlp INFIELD xmda035
            {<point name="construct.c.xmda035" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmda035
            #add-point:BEFORE FIELD xmda035
            {<point name="construct.b.xmda035" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmda035
            
            #add-point:AFTER FIELD xmda035
            {<point name="construct.a.xmda035" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmda035_desc
            #add-point:BEFORE FIELD xmda035_desc
            {<point name="construct.b.xmda035_desc" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmda035_desc
            
            #add-point:AFTER FIELD xmda035_desc
            {<point name="construct.a.xmda035_desc" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmda035_desc
         ON ACTION controlp INFIELD xmda035_desc
            #add-point:ON ACTION controlp INFIELD xmda035_desc
            {<point name="construct.c.xmda035_desc" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmda039
            #add-point:BEFORE FIELD xmda039
            {<point name="construct.b.xmda039" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmda039
            
            #add-point:AFTER FIELD xmda039
            {<point name="construct.a.xmda039" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmda039
         ON ACTION controlp INFIELD xmda039
            #add-point:ON ACTION controlp INFIELD xmda039
            {<point name="construct.c.xmda039" />}
            #END add-point
 
         #Ctrlp:construct.c.xmdaownid
         ON ACTION controlp INFIELD xmdaownid
            #add-point:ON ACTION controlp INFIELD xmdaownid
            {<point name="construct.c.xmdaownid" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdaownid
            #add-point:BEFORE FIELD xmdaownid
            {<point name="construct.b.xmdaownid" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdaownid
            
            #add-point:AFTER FIELD xmdaownid
            {<point name="construct.a.xmdaownid" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmdaowndp
         ON ACTION controlp INFIELD xmdaowndp
            #add-point:ON ACTION controlp INFIELD xmdaowndp
            {<point name="construct.c.xmdaowndp" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdaowndp
            #add-point:BEFORE FIELD xmdaowndp
            {<point name="construct.b.xmdaowndp" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdaowndp
            
            #add-point:AFTER FIELD xmdaowndp
            {<point name="construct.a.xmdaowndp" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmdacrtid
         ON ACTION controlp INFIELD xmdacrtid
            #add-point:ON ACTION controlp INFIELD xmdacrtid
            {<point name="construct.c.xmdacrtid" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdacrtid
            #add-point:BEFORE FIELD xmdacrtid
            {<point name="construct.b.xmdacrtid" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdacrtid
            
            #add-point:AFTER FIELD xmdacrtid
            {<point name="construct.a.xmdacrtid" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmdacrtdp
         ON ACTION controlp INFIELD xmdacrtdp
            #add-point:ON ACTION controlp INFIELD xmdacrtdp
            {<point name="construct.c.xmdacrtdp" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdacrtdp
            #add-point:BEFORE FIELD xmdacrtdp
            {<point name="construct.b.xmdacrtdp" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdacrtdp
            
            #add-point:AFTER FIELD xmdacrtdp
            {<point name="construct.a.xmdacrtdp" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdacrtdt
            #add-point:BEFORE FIELD xmdacrtdt
            {<point name="construct.b.xmdacrtdt" />}
            #END add-point
 
         #Ctrlp:construct.c.xmdamodid
         ON ACTION controlp INFIELD xmdamodid
            #add-point:ON ACTION controlp INFIELD xmdamodid
            {<point name="construct.c.xmdamodid" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdamodid
            #add-point:BEFORE FIELD xmdamodid
            {<point name="construct.b.xmdamodid" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdamodid
            
            #add-point:AFTER FIELD xmdamodid
            {<point name="construct.a.xmdamodid" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdamoddt
            #add-point:BEFORE FIELD xmdamoddt
            {<point name="construct.b.xmdamoddt" />}
            #END add-point
 
         #Ctrlp:construct.c.xmdacnfid
         ON ACTION controlp INFIELD xmdacnfid
            #add-point:ON ACTION controlp INFIELD xmdacnfid
            {<point name="construct.c.xmdacnfid" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdacnfid
            #add-point:BEFORE FIELD xmdacnfid
            {<point name="construct.b.xmdacnfid" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdacnfid
            
            #add-point:AFTER FIELD xmdacnfid
            {<point name="construct.a.xmdacnfid" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdacnfdt
            #add-point:BEFORE FIELD xmdacnfdt
            {<point name="construct.b.xmdacnfdt" />}
            #END add-point
 
         #Ctrlp:construct.c.xmda034
         ON ACTION controlp INFIELD xmda034
            #add-point:ON ACTION controlp INFIELD xmda034
            {<point name="construct.c.xmda034" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmda034
            #add-point:BEFORE FIELD xmda034
            {<point name="construct.b.xmda034" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmda034
            
            #add-point:AFTER FIELD xmda034
            {<point name="construct.a.xmda034" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmda006
            #add-point:BEFORE FIELD xmda006
            {<point name="construct.b.xmda006" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmda006
            
            #add-point:AFTER FIELD xmda006
            {<point name="construct.a.xmda006" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmda006
         ON ACTION controlp INFIELD xmda006
            #add-point:ON ACTION controlp INFIELD xmda006
            {<point name="construct.c.xmda006" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmda033
            #add-point:BEFORE FIELD xmda033
            {<point name="construct.b.xmda033" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmda033
            
            #add-point:AFTER FIELD xmda033
            {<point name="construct.a.xmda033" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmda033
         ON ACTION controlp INFIELD xmda033
            #add-point:ON ACTION controlp INFIELD xmda033
            {<point name="construct.c.xmda033" />}
            #END add-point
 
         #Ctrlp:construct.c.xmda017
         ON ACTION controlp INFIELD xmda017
            #add-point:ON ACTION controlp INFIELD xmda017
            {<point name="construct.c.xmda017" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmda017
            #add-point:BEFORE FIELD xmda017
            {<point name="construct.b.xmda017" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmda017
            
            #add-point:AFTER FIELD xmda017
            {<point name="construct.a.xmda017" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmda019
            #add-point:BEFORE FIELD xmda019
            {<point name="construct.b.xmda019" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmda019
            
            #add-point:AFTER FIELD xmda019
            {<point name="construct.a.xmda019" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmda019
         ON ACTION controlp INFIELD xmda019
            #add-point:ON ACTION controlp INFIELD xmda019
            {<point name="construct.c.xmda019" />}
            #END add-point
 
         #Ctrlp:construct.c.xmda018
         ON ACTION controlp INFIELD xmda018
            #add-point:ON ACTION controlp INFIELD xmda018
            {<point name="construct.c.xmda018" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmda018
            #add-point:BEFORE FIELD xmda018
            {<point name="construct.b.xmda018" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmda018
            
            #add-point:AFTER FIELD xmda018
            {<point name="construct.a.xmda018" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmda044
         ON ACTION controlp INFIELD xmda044
            #add-point:ON ACTION controlp INFIELD xmda044
            {<point name="construct.c.xmda044" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmda044
            #add-point:BEFORE FIELD xmda044
            {<point name="construct.b.xmda044" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmda044
            
            #add-point:AFTER FIELD xmda044
            {<point name="construct.a.xmda044" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmda030
            #add-point:BEFORE FIELD xmda030
            {<point name="construct.b.xmda030" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmda030
            
            #add-point:AFTER FIELD xmda030
            {<point name="construct.a.xmda030" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmda030
         ON ACTION controlp INFIELD xmda030
            #add-point:ON ACTION controlp INFIELD xmda030
            {<point name="construct.c.xmda030" />}
            #END add-point
 
         #Ctrlp:construct.c.xmda031
         ON ACTION controlp INFIELD xmda031
            #add-point:ON ACTION controlp INFIELD xmda031
            {<point name="construct.c.xmda031" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmda031
            #add-point:BEFORE FIELD xmda031
            {<point name="construct.b.xmda031" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmda031
            
            #add-point:AFTER FIELD xmda031
            {<point name="construct.a.xmda031" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmda045
            #add-point:BEFORE FIELD xmda045
            {<point name="construct.b.xmda045" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmda045
            
            #add-point:AFTER FIELD xmda045
            {<point name="construct.a.xmda045" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmda045
         ON ACTION controlp INFIELD xmda045
            #add-point:ON ACTION controlp INFIELD xmda045
            {<point name="construct.c.xmda045" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmda046
            #add-point:BEFORE FIELD xmda046
            {<point name="construct.b.xmda046" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmda046
            
            #add-point:AFTER FIELD xmda046
            {<point name="construct.a.xmda046" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmda046
         ON ACTION controlp INFIELD xmda046
            #add-point:ON ACTION controlp INFIELD xmda046
            {<point name="construct.c.xmda046" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmda047
            #add-point:BEFORE FIELD xmda047
            {<point name="construct.b.xmda047" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmda047
            
            #add-point:AFTER FIELD xmda047
            {<point name="construct.a.xmda047" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmda047
         ON ACTION controlp INFIELD xmda047
            #add-point:ON ACTION controlp INFIELD xmda047
            {<point name="construct.c.xmda047" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmda028
            #add-point:BEFORE FIELD xmda028
            {<point name="construct.b.xmda028" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmda028
            
            #add-point:AFTER FIELD xmda028
            {<point name="construct.a.xmda028" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmda028
         ON ACTION controlp INFIELD xmda028
            #add-point:ON ACTION controlp INFIELD xmda028
            {<point name="construct.c.xmda028" />}
            #END add-point
 
 
         
      END CONSTRUCT
 
      #單身根據table分拆construct
      CONSTRUCT g_wc2_table1 ON xmdcsite,xmdcseq,xmdc027,xmdc001,xmdc002,xmdc004,xmdc005,xmdc006,xmdc007, 
          xmdc008,xmdc009,xmdc024,xmdc012,xmdc013,xmdc045,xmdc010,xmdc011,xmdc015,xmdc016,xmdc016_desc, 
          xmdc017,xmdc046,xmdc047,xmdc048,xmdc023,xmdc019,xmdc020,xmdc021,xmdc022,xmdc051,xmdcunit,xmdcorga, 
          xmdc052,xmdc049,xmdc053,xmdc050
           FROM s_detail1[1].xmdcsite,s_detail1[1].xmdcseq,s_detail1[1].xmdc027,s_detail1[1].xmdc001, 
               s_detail1[1].xmdc002,s_detail1[1].xmdc004,s_detail1[1].xmdc005,s_detail1[1].xmdc006,s_detail1[1].xmdc007, 
               s_detail1[1].xmdc008,s_detail1[1].xmdc009,s_detail1[1].xmdc024,s_detail1[1].xmdc012,s_detail1[1].xmdc013, 
               s_detail1[1].xmdc045,s_detail1[1].xmdc010,s_detail1[1].xmdc011,s_detail1[1].xmdc015,s_detail1[1].xmdc016, 
               s_detail1[1].xmdc016_desc,s_detail1[1].xmdc017,s_detail1[1].xmdc046,s_detail1[1].xmdc047, 
               s_detail1[1].xmdc048,s_detail1[1].xmdc023,s_detail1[1].xmdc019,s_detail1[1].xmdc020,s_detail1[1].xmdc021, 
               s_detail1[1].xmdc022,s_detail1[1].xmdc051,s_detail1[1].xmdcunit,s_detail1[1].xmdcorga, 
               s_detail1[1].xmdc052,s_detail1[1].xmdc049,s_detail1[1].xmdc053,s_detail1[1].xmdc050
                      
         BEFORE CONSTRUCT
            #add-point:cs段before_construct
            {<point name="cs.body.before_construct"/>}
            #end add-point 
            
       #單身公用欄位開窗相關處理
       
         
       #單身一般欄位開窗相關處理
                #此段落由子樣板a01產生
         BEFORE FIELD xmdcsite
            #add-point:BEFORE FIELD xmdcsite
            {<point name="construct.b.page1.xmdcsite" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdcsite
            
            #add-point:AFTER FIELD xmdcsite
            {<point name="construct.a.page1.xmdcsite" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmdcsite
         ON ACTION controlp INFIELD xmdcsite
            #add-point:ON ACTION controlp INFIELD xmdcsite
            {<point name="construct.c.page1.xmdcsite" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdcseq
            #add-point:BEFORE FIELD xmdcseq
            {<point name="construct.b.page1.xmdcseq" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdcseq
            
            #add-point:AFTER FIELD xmdcseq
            {<point name="construct.a.page1.xmdcseq" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmdcseq
         ON ACTION controlp INFIELD xmdcseq
            #add-point:ON ACTION controlp INFIELD xmdcseq
            {<point name="construct.c.page1.xmdcseq" />}
            #END add-point
 
         #Ctrlp:construct.c.page1.xmdc027
         ON ACTION controlp INFIELD xmdc027
            #add-point:ON ACTION controlp INFIELD xmdc027
            {<point name="construct.c.page1.xmdc027" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdc027
            #add-point:BEFORE FIELD xmdc027
            {<point name="construct.b.page1.xmdc027" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdc027
            
            #add-point:AFTER FIELD xmdc027
            {<point name="construct.a.page1.xmdc027" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmdc001
         ON ACTION controlp INFIELD xmdc001
            #add-point:ON ACTION controlp INFIELD xmdc001
            {<point name="construct.c.page1.xmdc001" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdc001
            #add-point:BEFORE FIELD xmdc001
            {<point name="construct.b.page1.xmdc001" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdc001
            
            #add-point:AFTER FIELD xmdc001
            {<point name="construct.a.page1.xmdc001" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdc002
            #add-point:BEFORE FIELD xmdc002
            {<point name="construct.b.page1.xmdc002" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdc002
            
            #add-point:AFTER FIELD xmdc002
            {<point name="construct.a.page1.xmdc002" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmdc002
         ON ACTION controlp INFIELD xmdc002
            #add-point:ON ACTION controlp INFIELD xmdc002
            {<point name="construct.c.page1.xmdc002" />}
            #END add-point
 
         #Ctrlp:construct.c.page1.xmdc004
         ON ACTION controlp INFIELD xmdc004
            #add-point:ON ACTION controlp INFIELD xmdc004
            {<point name="construct.c.page1.xmdc004" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdc004
            #add-point:BEFORE FIELD xmdc004
            {<point name="construct.b.page1.xmdc004" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdc004
            
            #add-point:AFTER FIELD xmdc004
            {<point name="construct.a.page1.xmdc004" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdc005
            #add-point:BEFORE FIELD xmdc005
            {<point name="construct.b.page1.xmdc005" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdc005
            
            #add-point:AFTER FIELD xmdc005
            {<point name="construct.a.page1.xmdc005" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmdc005
         ON ACTION controlp INFIELD xmdc005
            #add-point:ON ACTION controlp INFIELD xmdc005
            {<point name="construct.c.page1.xmdc005" />}
            #END add-point
 
         #Ctrlp:construct.c.page1.xmdc006
         ON ACTION controlp INFIELD xmdc006
            #add-point:ON ACTION controlp INFIELD xmdc006
            {<point name="construct.c.page1.xmdc006" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdc006
            #add-point:BEFORE FIELD xmdc006
            {<point name="construct.b.page1.xmdc006" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdc006
            
            #add-point:AFTER FIELD xmdc006
            {<point name="construct.a.page1.xmdc006" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdc007
            #add-point:BEFORE FIELD xmdc007
            {<point name="construct.b.page1.xmdc007" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdc007
            
            #add-point:AFTER FIELD xmdc007
            {<point name="construct.a.page1.xmdc007" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmdc007
         ON ACTION controlp INFIELD xmdc007
            #add-point:ON ACTION controlp INFIELD xmdc007
            {<point name="construct.c.page1.xmdc007" />}
            #END add-point
 
         #Ctrlp:construct.c.page1.xmdc008
         ON ACTION controlp INFIELD xmdc008
            #add-point:ON ACTION controlp INFIELD xmdc008
            {<point name="construct.c.page1.xmdc008" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdc008
            #add-point:BEFORE FIELD xmdc008
            {<point name="construct.b.page1.xmdc008" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdc008
            
            #add-point:AFTER FIELD xmdc008
            {<point name="construct.a.page1.xmdc008" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdc009
            #add-point:BEFORE FIELD xmdc009
            {<point name="construct.b.page1.xmdc009" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdc009
            
            #add-point:AFTER FIELD xmdc009
            {<point name="construct.a.page1.xmdc009" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmdc009
         ON ACTION controlp INFIELD xmdc009
            #add-point:ON ACTION controlp INFIELD xmdc009
            {<point name="construct.c.page1.xmdc009" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdc024
            #add-point:BEFORE FIELD xmdc024
            {<point name="construct.b.page1.xmdc024" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdc024
            
            #add-point:AFTER FIELD xmdc024
            {<point name="construct.a.page1.xmdc024" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmdc024
         ON ACTION controlp INFIELD xmdc024
            #add-point:ON ACTION controlp INFIELD xmdc024
            {<point name="construct.c.page1.xmdc024" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdc012
            #add-point:BEFORE FIELD xmdc012
            {<point name="construct.b.page1.xmdc012" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdc012
            
            #add-point:AFTER FIELD xmdc012
            {<point name="construct.a.page1.xmdc012" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmdc012
         ON ACTION controlp INFIELD xmdc012
            #add-point:ON ACTION controlp INFIELD xmdc012
            {<point name="construct.c.page1.xmdc012" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdc013
            #add-point:BEFORE FIELD xmdc013
            {<point name="construct.b.page1.xmdc013" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdc013
            
            #add-point:AFTER FIELD xmdc013
            {<point name="construct.a.page1.xmdc013" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmdc013
         ON ACTION controlp INFIELD xmdc013
            #add-point:ON ACTION controlp INFIELD xmdc013
            {<point name="construct.c.page1.xmdc013" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdc045
            #add-point:BEFORE FIELD xmdc045
            {<point name="construct.b.page1.xmdc045" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdc045
            
            #add-point:AFTER FIELD xmdc045
            {<point name="construct.a.page1.xmdc045" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmdc045
         ON ACTION controlp INFIELD xmdc045
            #add-point:ON ACTION controlp INFIELD xmdc045
            {<point name="construct.c.page1.xmdc045" />}
            #END add-point
 
         #Ctrlp:construct.c.page1.xmdc010
         ON ACTION controlp INFIELD xmdc010
            #add-point:ON ACTION controlp INFIELD xmdc010
            {<point name="construct.c.page1.xmdc010" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdc010
            #add-point:BEFORE FIELD xmdc010
            {<point name="construct.b.page1.xmdc010" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdc010
            
            #add-point:AFTER FIELD xmdc010
            {<point name="construct.a.page1.xmdc010" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdc011
            #add-point:BEFORE FIELD xmdc011
            {<point name="construct.b.page1.xmdc011" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdc011
            
            #add-point:AFTER FIELD xmdc011
            {<point name="construct.a.page1.xmdc011" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmdc011
         ON ACTION controlp INFIELD xmdc011
            #add-point:ON ACTION controlp INFIELD xmdc011
            {<point name="construct.c.page1.xmdc011" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdc015
            #add-point:BEFORE FIELD xmdc015
            {<point name="construct.b.page1.xmdc015" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdc015
            
            #add-point:AFTER FIELD xmdc015
            {<point name="construct.a.page1.xmdc015" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmdc015
         ON ACTION controlp INFIELD xmdc015
            #add-point:ON ACTION controlp INFIELD xmdc015
            {<point name="construct.c.page1.xmdc015" />}
            #END add-point
 
         #Ctrlp:construct.c.page1.xmdc016
         ON ACTION controlp INFIELD xmdc016
            #add-point:ON ACTION controlp INFIELD xmdc016
            {<point name="construct.c.page1.xmdc016" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdc016
            #add-point:BEFORE FIELD xmdc016
            {<point name="construct.b.page1.xmdc016" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdc016
            
            #add-point:AFTER FIELD xmdc016
            {<point name="construct.a.page1.xmdc016" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdc016_desc
            #add-point:BEFORE FIELD xmdc016_desc
            {<point name="construct.b.page1.xmdc016_desc" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdc016_desc
            
            #add-point:AFTER FIELD xmdc016_desc
            {<point name="construct.a.page1.xmdc016_desc" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmdc016_desc
         ON ACTION controlp INFIELD xmdc016_desc
            #add-point:ON ACTION controlp INFIELD xmdc016_desc
            {<point name="construct.c.page1.xmdc016_desc" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdc017
            #add-point:BEFORE FIELD xmdc017
            {<point name="construct.b.page1.xmdc017" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdc017
            
            #add-point:AFTER FIELD xmdc017
            {<point name="construct.a.page1.xmdc017" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmdc017
         ON ACTION controlp INFIELD xmdc017
            #add-point:ON ACTION controlp INFIELD xmdc017
            {<point name="construct.c.page1.xmdc017" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdc046
            #add-point:BEFORE FIELD xmdc046
            {<point name="construct.b.page1.xmdc046" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdc046
            
            #add-point:AFTER FIELD xmdc046
            {<point name="construct.a.page1.xmdc046" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmdc046
         ON ACTION controlp INFIELD xmdc046
            #add-point:ON ACTION controlp INFIELD xmdc046
            {<point name="construct.c.page1.xmdc046" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdc047
            #add-point:BEFORE FIELD xmdc047
            {<point name="construct.b.page1.xmdc047" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdc047
            
            #add-point:AFTER FIELD xmdc047
            {<point name="construct.a.page1.xmdc047" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmdc047
         ON ACTION controlp INFIELD xmdc047
            #add-point:ON ACTION controlp INFIELD xmdc047
            {<point name="construct.c.page1.xmdc047" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdc048
            #add-point:BEFORE FIELD xmdc048
            {<point name="construct.b.page1.xmdc048" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdc048
            
            #add-point:AFTER FIELD xmdc048
            {<point name="construct.a.page1.xmdc048" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmdc048
         ON ACTION controlp INFIELD xmdc048
            #add-point:ON ACTION controlp INFIELD xmdc048
            {<point name="construct.c.page1.xmdc048" />}
            #END add-point
 
         #Ctrlp:construct.c.page1.xmdc023
         ON ACTION controlp INFIELD xmdc023
            #add-point:ON ACTION controlp INFIELD xmdc023
            {<point name="construct.c.page1.xmdc023" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdc023
            #add-point:BEFORE FIELD xmdc023
            {<point name="construct.b.page1.xmdc023" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdc023
            
            #add-point:AFTER FIELD xmdc023
            {<point name="construct.a.page1.xmdc023" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdc019
            #add-point:BEFORE FIELD xmdc019
            {<point name="construct.b.page1.xmdc019" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdc019
            
            #add-point:AFTER FIELD xmdc019
            {<point name="construct.a.page1.xmdc019" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmdc019
         ON ACTION controlp INFIELD xmdc019
            #add-point:ON ACTION controlp INFIELD xmdc019
            {<point name="construct.c.page1.xmdc019" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdc020
            #add-point:BEFORE FIELD xmdc020
            {<point name="construct.b.page1.xmdc020" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdc020
            
            #add-point:AFTER FIELD xmdc020
            {<point name="construct.a.page1.xmdc020" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmdc020
         ON ACTION controlp INFIELD xmdc020
            #add-point:ON ACTION controlp INFIELD xmdc020
            {<point name="construct.c.page1.xmdc020" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdc021
            #add-point:BEFORE FIELD xmdc021
            {<point name="construct.b.page1.xmdc021" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdc021
            
            #add-point:AFTER FIELD xmdc021
            {<point name="construct.a.page1.xmdc021" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmdc021
         ON ACTION controlp INFIELD xmdc021
            #add-point:ON ACTION controlp INFIELD xmdc021
            {<point name="construct.c.page1.xmdc021" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdc022
            #add-point:BEFORE FIELD xmdc022
            {<point name="construct.b.page1.xmdc022" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdc022
            
            #add-point:AFTER FIELD xmdc022
            {<point name="construct.a.page1.xmdc022" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmdc022
         ON ACTION controlp INFIELD xmdc022
            #add-point:ON ACTION controlp INFIELD xmdc022
            {<point name="construct.c.page1.xmdc022" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdc051
            #add-point:BEFORE FIELD xmdc051
            {<point name="construct.b.page1.xmdc051" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdc051
            
            #add-point:AFTER FIELD xmdc051
            {<point name="construct.a.page1.xmdc051" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmdc051
         ON ACTION controlp INFIELD xmdc051
            #add-point:ON ACTION controlp INFIELD xmdc051
            {<point name="construct.c.page1.xmdc051" />}
            #END add-point
 
         #Ctrlp:construct.c.page1.xmdcunit
         ON ACTION controlp INFIELD xmdcunit
            #add-point:ON ACTION controlp INFIELD xmdcunit
            {<point name="construct.c.page1.xmdcunit" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdcunit
            #add-point:BEFORE FIELD xmdcunit
            {<point name="construct.b.page1.xmdcunit" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdcunit
            
            #add-point:AFTER FIELD xmdcunit
            {<point name="construct.a.page1.xmdcunit" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmdcorga
         ON ACTION controlp INFIELD xmdcorga
            #add-point:ON ACTION controlp INFIELD xmdcorga
            {<point name="construct.c.page1.xmdcorga" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdcorga
            #add-point:BEFORE FIELD xmdcorga
            {<point name="construct.b.page1.xmdcorga" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdcorga
            
            #add-point:AFTER FIELD xmdcorga
            {<point name="construct.a.page1.xmdcorga" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdc052
            #add-point:BEFORE FIELD xmdc052
            {<point name="construct.b.page1.xmdc052" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdc052
            
            #add-point:AFTER FIELD xmdc052
            {<point name="construct.a.page1.xmdc052" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmdc052
         ON ACTION controlp INFIELD xmdc052
            #add-point:ON ACTION controlp INFIELD xmdc052
            {<point name="construct.c.page1.xmdc052" />}
            #END add-point
 
         #Ctrlp:construct.c.page1.xmdc049
         ON ACTION controlp INFIELD xmdc049
            #add-point:ON ACTION controlp INFIELD xmdc049
            {<point name="construct.c.page1.xmdc049" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdc049
            #add-point:BEFORE FIELD xmdc049
            {<point name="construct.b.page1.xmdc049" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdc049
            
            #add-point:AFTER FIELD xmdc049
            {<point name="construct.a.page1.xmdc049" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmdc053
         ON ACTION controlp INFIELD xmdc053
            #add-point:ON ACTION controlp INFIELD xmdc053
            {<point name="construct.c.page1.xmdc053" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdc053
            #add-point:BEFORE FIELD xmdc053
            {<point name="construct.b.page1.xmdc053" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdc053
            
            #add-point:AFTER FIELD xmdc053
            {<point name="construct.a.page1.xmdc053" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdc050
            #add-point:BEFORE FIELD xmdc050
            {<point name="construct.b.page1.xmdc050" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdc050
            
            #add-point:AFTER FIELD xmdc050
            {<point name="construct.a.page1.xmdc050" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmdc050
         ON ACTION controlp INFIELD xmdc050
            #add-point:ON ACTION controlp INFIELD xmdc050
            {<point name="construct.c.page1.xmdc050" />}
            #END add-point
 
   
       
      END CONSTRUCT
      
      CONSTRUCT g_wc2_table2 ON xmdddocno,xmddseq,xmddseq1,xmdd229,xmdd003,xmdd001,xmdd002,xmdd200,xmdd004, 
          xmdd005,xmdd011,xmdd012,xmddseq2,xmdd006,xmdd201,xmdd202,xmdd024,xmdd025,xmdd026,xmdd027,xmdd203, 
          xmdd204,xmdd205,xmdd206,xmdd029,xmdd028,xmdd019,xmdd019_desc,xmdd030,xmdd207,xmddunit,xmdd210, 
          xmdd212,xmdd213,xmdd214,xmdd215,xmdd031,xmdd014,xmdd015,xmdd016,xmdd017,xmdd221,xmddsite,xmdd218, 
          xmdd219,xmdd220,xmdd222,xmdd223,xmdd224,xmddorga,xmdd226,xmdd227,xmdd228,xmdd013,xmdd009,xmdd018, 
          xmdd020,xmdd021,xmdd022,xmdd023
           FROM s_detail3[1].xmdddocno,s_detail3[1].xmddseq,s_detail3[1].xmddseq1,s_detail3[1].xmdd229, 
               s_detail3[1].xmdd003,s_detail3[1].xmdd001,s_detail3[1].xmdd002,s_detail3[1].xmdd200,s_detail3[1].xmdd004, 
               s_detail3[1].xmdd005,s_detail3[1].xmdd011,s_detail3[1].xmdd012,s_detail3[1].xmddseq2, 
               s_detail3[1].xmdd006,s_detail3[1].xmdd201,s_detail3[1].xmdd202,s_detail3[1].xmdd024,s_detail3[1].xmdd025, 
               s_detail3[1].xmdd026,s_detail3[1].xmdd027,s_detail3[1].xmdd203,s_detail3[1].xmdd204,s_detail3[1].xmdd205, 
               s_detail3[1].xmdd206,s_detail3[1].xmdd029,s_detail3[1].xmdd028,s_detail3[1].xmdd019,s_detail3[1].xmdd019_desc, 
               s_detail3[1].xmdd030,s_detail3[1].xmdd207,s_detail3[1].xmddunit,s_detail3[1].xmdd210, 
               s_detail3[1].xmdd212,s_detail3[1].xmdd213,s_detail3[1].xmdd214,s_detail3[1].xmdd215,s_detail3[1].xmdd031, 
               s_detail3[1].xmdd014,s_detail3[1].xmdd015,s_detail3[1].xmdd016,s_detail3[1].xmdd017,s_detail3[1].xmdd221, 
               s_detail3[1].xmddsite,s_detail3[1].xmdd218,s_detail3[1].xmdd219,s_detail3[1].xmdd220, 
               s_detail3[1].xmdd222,s_detail3[1].xmdd223,s_detail3[1].xmdd224,s_detail3[1].xmddorga, 
               s_detail3[1].xmdd226,s_detail3[1].xmdd227,s_detail3[1].xmdd228,s_detail3[1].xmdd013,s_detail3[1].xmdd009, 
               s_detail3[1].xmdd018,s_detail3[1].xmdd020,s_detail3[1].xmdd021,s_detail3[1].xmdd022,s_detail3[1].xmdd023 

                      
         BEFORE CONSTRUCT
            #add-point:cs段before_construct
            {<point name="cs.body2.before_construct"/>}
            #end add-point 
            
       #單身公用欄位開窗相關處理(table 2)
       
       
       #單身一般欄位開窗相關處理       
                #此段落由子樣板a01產生
         BEFORE FIELD xmdddocno
            #add-point:BEFORE FIELD xmdddocno
            {<point name="construct.b.page3.xmdddocno" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdddocno
            
            #add-point:AFTER FIELD xmdddocno
            {<point name="construct.a.page3.xmdddocno" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xmdddocno
         ON ACTION controlp INFIELD xmdddocno
            #add-point:ON ACTION controlp INFIELD xmdddocno
            {<point name="construct.c.page3.xmdddocno" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmddseq
            #add-point:BEFORE FIELD xmddseq
            {<point name="construct.b.page3.xmddseq" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmddseq
            
            #add-point:AFTER FIELD xmddseq
            {<point name="construct.a.page3.xmddseq" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xmddseq
         ON ACTION controlp INFIELD xmddseq
            #add-point:ON ACTION controlp INFIELD xmddseq
            {<point name="construct.c.page3.xmddseq" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmddseq1
            #add-point:BEFORE FIELD xmddseq1
            {<point name="construct.b.page3.xmddseq1" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmddseq1
            
            #add-point:AFTER FIELD xmddseq1
            {<point name="construct.a.page3.xmddseq1" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xmddseq1
         ON ACTION controlp INFIELD xmddseq1
            #add-point:ON ACTION controlp INFIELD xmddseq1
            {<point name="construct.c.page3.xmddseq1" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdd229
            #add-point:BEFORE FIELD xmdd229
            {<point name="construct.b.page3.xmdd229" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdd229
            
            #add-point:AFTER FIELD xmdd229
            {<point name="construct.a.page3.xmdd229" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xmdd229
         ON ACTION controlp INFIELD xmdd229
            #add-point:ON ACTION controlp INFIELD xmdd229
            {<point name="construct.c.page3.xmdd229" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdd003
            #add-point:BEFORE FIELD xmdd003
            {<point name="construct.b.page3.xmdd003" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdd003
            
            #add-point:AFTER FIELD xmdd003
            {<point name="construct.a.page3.xmdd003" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xmdd003
         ON ACTION controlp INFIELD xmdd003
            #add-point:ON ACTION controlp INFIELD xmdd003
            {<point name="construct.c.page3.xmdd003" />}
            #END add-point
 
         #Ctrlp:construct.c.page3.xmdd001
         ON ACTION controlp INFIELD xmdd001
            #add-point:ON ACTION controlp INFIELD xmdd001
            {<point name="construct.c.page3.xmdd001" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdd001
            #add-point:BEFORE FIELD xmdd001
            {<point name="construct.b.page3.xmdd001" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdd001
            
            #add-point:AFTER FIELD xmdd001
            {<point name="construct.a.page3.xmdd001" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdd002
            #add-point:BEFORE FIELD xmdd002
            {<point name="construct.b.page3.xmdd002" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdd002
            
            #add-point:AFTER FIELD xmdd002
            {<point name="construct.a.page3.xmdd002" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xmdd002
         ON ACTION controlp INFIELD xmdd002
            #add-point:ON ACTION controlp INFIELD xmdd002
            {<point name="construct.c.page3.xmdd002" />}
            #END add-point
 
         #Ctrlp:construct.c.page3.xmdd200
         ON ACTION controlp INFIELD xmdd200
            #add-point:ON ACTION controlp INFIELD xmdd200
            {<point name="construct.c.page3.xmdd200" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdd200
            #add-point:BEFORE FIELD xmdd200
            {<point name="construct.b.page3.xmdd200" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdd200
            
            #add-point:AFTER FIELD xmdd200
            {<point name="construct.a.page3.xmdd200" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xmdd004
         ON ACTION controlp INFIELD xmdd004
            #add-point:ON ACTION controlp INFIELD xmdd004
            {<point name="construct.c.page3.xmdd004" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdd004
            #add-point:BEFORE FIELD xmdd004
            {<point name="construct.b.page3.xmdd004" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdd004
            
            #add-point:AFTER FIELD xmdd004
            {<point name="construct.a.page3.xmdd004" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdd005
            #add-point:BEFORE FIELD xmdd005
            {<point name="construct.b.page3.xmdd005" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdd005
            
            #add-point:AFTER FIELD xmdd005
            {<point name="construct.a.page3.xmdd005" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xmdd005
         ON ACTION controlp INFIELD xmdd005
            #add-point:ON ACTION controlp INFIELD xmdd005
            {<point name="construct.c.page3.xmdd005" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdd011
            #add-point:BEFORE FIELD xmdd011
            {<point name="construct.b.page3.xmdd011" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdd011
            
            #add-point:AFTER FIELD xmdd011
            {<point name="construct.a.page3.xmdd011" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xmdd011
         ON ACTION controlp INFIELD xmdd011
            #add-point:ON ACTION controlp INFIELD xmdd011
            {<point name="construct.c.page3.xmdd011" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdd012
            #add-point:BEFORE FIELD xmdd012
            {<point name="construct.b.page3.xmdd012" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdd012
            
            #add-point:AFTER FIELD xmdd012
            {<point name="construct.a.page3.xmdd012" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xmdd012
         ON ACTION controlp INFIELD xmdd012
            #add-point:ON ACTION controlp INFIELD xmdd012
            {<point name="construct.c.page3.xmdd012" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmddseq2
            #add-point:BEFORE FIELD xmddseq2
            {<point name="construct.b.page3.xmddseq2" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmddseq2
            
            #add-point:AFTER FIELD xmddseq2
            {<point name="construct.a.page3.xmddseq2" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xmddseq2
         ON ACTION controlp INFIELD xmddseq2
            #add-point:ON ACTION controlp INFIELD xmddseq2
            {<point name="construct.c.page3.xmddseq2" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdd006
            #add-point:BEFORE FIELD xmdd006
            {<point name="construct.b.page3.xmdd006" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdd006
            
            #add-point:AFTER FIELD xmdd006
            {<point name="construct.a.page3.xmdd006" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xmdd006
         ON ACTION controlp INFIELD xmdd006
            #add-point:ON ACTION controlp INFIELD xmdd006
            {<point name="construct.c.page3.xmdd006" />}
            #END add-point
 
         #Ctrlp:construct.c.page3.xmdd201
         ON ACTION controlp INFIELD xmdd201
            #add-point:ON ACTION controlp INFIELD xmdd201
            {<point name="construct.c.page3.xmdd201" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdd201
            #add-point:BEFORE FIELD xmdd201
            {<point name="construct.b.page3.xmdd201" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdd201
            
            #add-point:AFTER FIELD xmdd201
            {<point name="construct.a.page3.xmdd201" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdd202
            #add-point:BEFORE FIELD xmdd202
            {<point name="construct.b.page3.xmdd202" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdd202
            
            #add-point:AFTER FIELD xmdd202
            {<point name="construct.a.page3.xmdd202" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xmdd202
         ON ACTION controlp INFIELD xmdd202
            #add-point:ON ACTION controlp INFIELD xmdd202
            {<point name="construct.c.page3.xmdd202" />}
            #END add-point
 
         #Ctrlp:construct.c.page3.xmdd024
         ON ACTION controlp INFIELD xmdd024
            #add-point:ON ACTION controlp INFIELD xmdd024
            {<point name="construct.c.page3.xmdd024" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdd024
            #add-point:BEFORE FIELD xmdd024
            {<point name="construct.b.page3.xmdd024" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdd024
            
            #add-point:AFTER FIELD xmdd024
            {<point name="construct.a.page3.xmdd024" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdd025
            #add-point:BEFORE FIELD xmdd025
            {<point name="construct.b.page3.xmdd025" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdd025
            
            #add-point:AFTER FIELD xmdd025
            {<point name="construct.a.page3.xmdd025" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xmdd025
         ON ACTION controlp INFIELD xmdd025
            #add-point:ON ACTION controlp INFIELD xmdd025
            {<point name="construct.c.page3.xmdd025" />}
            #END add-point
 
         #Ctrlp:construct.c.page3.xmdd026
         ON ACTION controlp INFIELD xmdd026
            #add-point:ON ACTION controlp INFIELD xmdd026
            {<point name="construct.c.page3.xmdd026" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdd026
            #add-point:BEFORE FIELD xmdd026
            {<point name="construct.b.page3.xmdd026" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdd026
            
            #add-point:AFTER FIELD xmdd026
            {<point name="construct.a.page3.xmdd026" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdd027
            #add-point:BEFORE FIELD xmdd027
            {<point name="construct.b.page3.xmdd027" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdd027
            
            #add-point:AFTER FIELD xmdd027
            {<point name="construct.a.page3.xmdd027" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xmdd027
         ON ACTION controlp INFIELD xmdd027
            #add-point:ON ACTION controlp INFIELD xmdd027
            {<point name="construct.c.page3.xmdd027" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdd203
            #add-point:BEFORE FIELD xmdd203
            {<point name="construct.b.page3.xmdd203" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdd203
            
            #add-point:AFTER FIELD xmdd203
            {<point name="construct.a.page3.xmdd203" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xmdd203
         ON ACTION controlp INFIELD xmdd203
            #add-point:ON ACTION controlp INFIELD xmdd203
            {<point name="construct.c.page3.xmdd203" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdd204
            #add-point:BEFORE FIELD xmdd204
            {<point name="construct.b.page3.xmdd204" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdd204
            
            #add-point:AFTER FIELD xmdd204
            {<point name="construct.a.page3.xmdd204" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xmdd204
         ON ACTION controlp INFIELD xmdd204
            #add-point:ON ACTION controlp INFIELD xmdd204
            {<point name="construct.c.page3.xmdd204" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdd205
            #add-point:BEFORE FIELD xmdd205
            {<point name="construct.b.page3.xmdd205" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdd205
            
            #add-point:AFTER FIELD xmdd205
            {<point name="construct.a.page3.xmdd205" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xmdd205
         ON ACTION controlp INFIELD xmdd205
            #add-point:ON ACTION controlp INFIELD xmdd205
            {<point name="construct.c.page3.xmdd205" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdd206
            #add-point:BEFORE FIELD xmdd206
            {<point name="construct.b.page3.xmdd206" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdd206
            
            #add-point:AFTER FIELD xmdd206
            {<point name="construct.a.page3.xmdd206" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xmdd206
         ON ACTION controlp INFIELD xmdd206
            #add-point:ON ACTION controlp INFIELD xmdd206
            {<point name="construct.c.page3.xmdd206" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdd029
            #add-point:BEFORE FIELD xmdd029
            {<point name="construct.b.page3.xmdd029" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdd029
            
            #add-point:AFTER FIELD xmdd029
            {<point name="construct.a.page3.xmdd029" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xmdd029
         ON ACTION controlp INFIELD xmdd029
            #add-point:ON ACTION controlp INFIELD xmdd029
            {<point name="construct.c.page3.xmdd029" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdd028
            #add-point:BEFORE FIELD xmdd028
            {<point name="construct.b.page3.xmdd028" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdd028
            
            #add-point:AFTER FIELD xmdd028
            {<point name="construct.a.page3.xmdd028" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xmdd028
         ON ACTION controlp INFIELD xmdd028
            #add-point:ON ACTION controlp INFIELD xmdd028
            {<point name="construct.c.page3.xmdd028" />}
            #END add-point
 
         #Ctrlp:construct.c.page3.xmdd019
         ON ACTION controlp INFIELD xmdd019
            #add-point:ON ACTION controlp INFIELD xmdd019
            {<point name="construct.c.page3.xmdd019" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdd019
            #add-point:BEFORE FIELD xmdd019
            {<point name="construct.b.page3.xmdd019" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdd019
            
            #add-point:AFTER FIELD xmdd019
            {<point name="construct.a.page3.xmdd019" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdd019_desc
            #add-point:BEFORE FIELD xmdd019_desc
            {<point name="construct.b.page3.xmdd019_desc" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdd019_desc
            
            #add-point:AFTER FIELD xmdd019_desc
            {<point name="construct.a.page3.xmdd019_desc" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xmdd019_desc
         ON ACTION controlp INFIELD xmdd019_desc
            #add-point:ON ACTION controlp INFIELD xmdd019_desc
            {<point name="construct.c.page3.xmdd019_desc" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdd030
            #add-point:BEFORE FIELD xmdd030
            {<point name="construct.b.page3.xmdd030" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdd030
            
            #add-point:AFTER FIELD xmdd030
            {<point name="construct.a.page3.xmdd030" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xmdd030
         ON ACTION controlp INFIELD xmdd030
            #add-point:ON ACTION controlp INFIELD xmdd030
            {<point name="construct.c.page3.xmdd030" />}
            #END add-point
 
         #Ctrlp:construct.c.page3.xmdd207
         ON ACTION controlp INFIELD xmdd207
            #add-point:ON ACTION controlp INFIELD xmdd207
            {<point name="construct.c.page3.xmdd207" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdd207
            #add-point:BEFORE FIELD xmdd207
            {<point name="construct.b.page3.xmdd207" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdd207
            
            #add-point:AFTER FIELD xmdd207
            {<point name="construct.a.page3.xmdd207" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xmddunit
         ON ACTION controlp INFIELD xmddunit
            #add-point:ON ACTION controlp INFIELD xmddunit
            {<point name="construct.c.page3.xmddunit" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmddunit
            #add-point:BEFORE FIELD xmddunit
            {<point name="construct.b.page3.xmddunit" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmddunit
            
            #add-point:AFTER FIELD xmddunit
            {<point name="construct.a.page3.xmddunit" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xmdd210
         ON ACTION controlp INFIELD xmdd210
            #add-point:ON ACTION controlp INFIELD xmdd210
            {<point name="construct.c.page3.xmdd210" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdd210
            #add-point:BEFORE FIELD xmdd210
            {<point name="construct.b.page3.xmdd210" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdd210
            
            #add-point:AFTER FIELD xmdd210
            {<point name="construct.a.page3.xmdd210" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdd212
            #add-point:BEFORE FIELD xmdd212
            {<point name="construct.b.page3.xmdd212" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdd212
            
            #add-point:AFTER FIELD xmdd212
            {<point name="construct.a.page3.xmdd212" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xmdd212
         ON ACTION controlp INFIELD xmdd212
            #add-point:ON ACTION controlp INFIELD xmdd212
            {<point name="construct.c.page3.xmdd212" />}
            #END add-point
 
         #Ctrlp:construct.c.page3.xmdd213
         ON ACTION controlp INFIELD xmdd213
            #add-point:ON ACTION controlp INFIELD xmdd213
            {<point name="construct.c.page3.xmdd213" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdd213
            #add-point:BEFORE FIELD xmdd213
            {<point name="construct.b.page3.xmdd213" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdd213
            
            #add-point:AFTER FIELD xmdd213
            {<point name="construct.a.page3.xmdd213" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xmdd214
         ON ACTION controlp INFIELD xmdd214
            #add-point:ON ACTION controlp INFIELD xmdd214
            {<point name="construct.c.page3.xmdd214" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdd214
            #add-point:BEFORE FIELD xmdd214
            {<point name="construct.b.page3.xmdd214" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdd214
            
            #add-point:AFTER FIELD xmdd214
            {<point name="construct.a.page3.xmdd214" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdd215
            #add-point:BEFORE FIELD xmdd215
            {<point name="construct.b.page3.xmdd215" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdd215
            
            #add-point:AFTER FIELD xmdd215
            {<point name="construct.a.page3.xmdd215" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xmdd215
         ON ACTION controlp INFIELD xmdd215
            #add-point:ON ACTION controlp INFIELD xmdd215
            {<point name="construct.c.page3.xmdd215" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdd031
            #add-point:BEFORE FIELD xmdd031
            {<point name="construct.b.page3.xmdd031" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdd031
            
            #add-point:AFTER FIELD xmdd031
            {<point name="construct.a.page3.xmdd031" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xmdd031
         ON ACTION controlp INFIELD xmdd031
            #add-point:ON ACTION controlp INFIELD xmdd031
            {<point name="construct.c.page3.xmdd031" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdd014
            #add-point:BEFORE FIELD xmdd014
            {<point name="construct.b.page3.xmdd014" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdd014
            
            #add-point:AFTER FIELD xmdd014
            {<point name="construct.a.page3.xmdd014" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xmdd014
         ON ACTION controlp INFIELD xmdd014
            #add-point:ON ACTION controlp INFIELD xmdd014
            {<point name="construct.c.page3.xmdd014" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdd015
            #add-point:BEFORE FIELD xmdd015
            {<point name="construct.b.page3.xmdd015" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdd015
            
            #add-point:AFTER FIELD xmdd015
            {<point name="construct.a.page3.xmdd015" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xmdd015
         ON ACTION controlp INFIELD xmdd015
            #add-point:ON ACTION controlp INFIELD xmdd015
            {<point name="construct.c.page3.xmdd015" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdd016
            #add-point:BEFORE FIELD xmdd016
            {<point name="construct.b.page3.xmdd016" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdd016
            
            #add-point:AFTER FIELD xmdd016
            {<point name="construct.a.page3.xmdd016" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xmdd016
         ON ACTION controlp INFIELD xmdd016
            #add-point:ON ACTION controlp INFIELD xmdd016
            {<point name="construct.c.page3.xmdd016" />}
            #END add-point
 
         #Ctrlp:construct.c.page3.xmdd017
         ON ACTION controlp INFIELD xmdd017
            #add-point:ON ACTION controlp INFIELD xmdd017
            {<point name="construct.c.page3.xmdd017" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdd017
            #add-point:BEFORE FIELD xmdd017
            {<point name="construct.b.page3.xmdd017" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdd017
            
            #add-point:AFTER FIELD xmdd017
            {<point name="construct.a.page3.xmdd017" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdd221
            #add-point:BEFORE FIELD xmdd221
            {<point name="construct.b.page3.xmdd221" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdd221
            
            #add-point:AFTER FIELD xmdd221
            {<point name="construct.a.page3.xmdd221" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xmdd221
         ON ACTION controlp INFIELD xmdd221
            #add-point:ON ACTION controlp INFIELD xmdd221
            {<point name="construct.c.page3.xmdd221" />}
            #END add-point
 
         #Ctrlp:construct.c.page3.xmddsite
         ON ACTION controlp INFIELD xmddsite
            #add-point:ON ACTION controlp INFIELD xmddsite
            {<point name="construct.c.page3.xmddsite" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmddsite
            #add-point:BEFORE FIELD xmddsite
            {<point name="construct.b.page3.xmddsite" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmddsite
            
            #add-point:AFTER FIELD xmddsite
            {<point name="construct.a.page3.xmddsite" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xmdd218
         ON ACTION controlp INFIELD xmdd218
            #add-point:ON ACTION controlp INFIELD xmdd218
            {<point name="construct.c.page3.xmdd218" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdd218
            #add-point:BEFORE FIELD xmdd218
            {<point name="construct.b.page3.xmdd218" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdd218
            
            #add-point:AFTER FIELD xmdd218
            {<point name="construct.a.page3.xmdd218" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xmdd219
         ON ACTION controlp INFIELD xmdd219
            #add-point:ON ACTION controlp INFIELD xmdd219
            {<point name="construct.c.page3.xmdd219" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdd219
            #add-point:BEFORE FIELD xmdd219
            {<point name="construct.b.page3.xmdd219" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdd219
            
            #add-point:AFTER FIELD xmdd219
            {<point name="construct.a.page3.xmdd219" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xmdd220
         ON ACTION controlp INFIELD xmdd220
            #add-point:ON ACTION controlp INFIELD xmdd220
            {<point name="construct.c.page3.xmdd220" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdd220
            #add-point:BEFORE FIELD xmdd220
            {<point name="construct.b.page3.xmdd220" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdd220
            
            #add-point:AFTER FIELD xmdd220
            {<point name="construct.a.page3.xmdd220" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xmdd222
         ON ACTION controlp INFIELD xmdd222
            #add-point:ON ACTION controlp INFIELD xmdd222
            {<point name="construct.c.page3.xmdd222" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdd222
            #add-point:BEFORE FIELD xmdd222
            {<point name="construct.b.page3.xmdd222" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdd222
            
            #add-point:AFTER FIELD xmdd222
            {<point name="construct.a.page3.xmdd222" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xmdd223
         ON ACTION controlp INFIELD xmdd223
            #add-point:ON ACTION controlp INFIELD xmdd223
            {<point name="construct.c.page3.xmdd223" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdd223
            #add-point:BEFORE FIELD xmdd223
            {<point name="construct.b.page3.xmdd223" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdd223
            
            #add-point:AFTER FIELD xmdd223
            {<point name="construct.a.page3.xmdd223" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xmdd224
         ON ACTION controlp INFIELD xmdd224
            #add-point:ON ACTION controlp INFIELD xmdd224
            {<point name="construct.c.page3.xmdd224" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdd224
            #add-point:BEFORE FIELD xmdd224
            {<point name="construct.b.page3.xmdd224" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdd224
            
            #add-point:AFTER FIELD xmdd224
            {<point name="construct.a.page3.xmdd224" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xmddorga
         ON ACTION controlp INFIELD xmddorga
            #add-point:ON ACTION controlp INFIELD xmddorga
            {<point name="construct.c.page3.xmddorga" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmddorga
            #add-point:BEFORE FIELD xmddorga
            {<point name="construct.b.page3.xmddorga" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmddorga
            
            #add-point:AFTER FIELD xmddorga
            {<point name="construct.a.page3.xmddorga" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdd226
            #add-point:BEFORE FIELD xmdd226
            {<point name="construct.b.page3.xmdd226" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdd226
            
            #add-point:AFTER FIELD xmdd226
            {<point name="construct.a.page3.xmdd226" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xmdd226
         ON ACTION controlp INFIELD xmdd226
            #add-point:ON ACTION controlp INFIELD xmdd226
            {<point name="construct.c.page3.xmdd226" />}
            #END add-point
 
         #Ctrlp:construct.c.page3.xmdd227
         ON ACTION controlp INFIELD xmdd227
            #add-point:ON ACTION controlp INFIELD xmdd227
            {<point name="construct.c.page3.xmdd227" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdd227
            #add-point:BEFORE FIELD xmdd227
            {<point name="construct.b.page3.xmdd227" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdd227
            
            #add-point:AFTER FIELD xmdd227
            {<point name="construct.a.page3.xmdd227" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xmdd228
         ON ACTION controlp INFIELD xmdd228
            #add-point:ON ACTION controlp INFIELD xmdd228
            {<point name="construct.c.page3.xmdd228" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdd228
            #add-point:BEFORE FIELD xmdd228
            {<point name="construct.b.page3.xmdd228" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdd228
            
            #add-point:AFTER FIELD xmdd228
            {<point name="construct.a.page3.xmdd228" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdd013
            #add-point:BEFORE FIELD xmdd013
            {<point name="construct.b.page3.xmdd013" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdd013
            
            #add-point:AFTER FIELD xmdd013
            {<point name="construct.a.page3.xmdd013" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xmdd013
         ON ACTION controlp INFIELD xmdd013
            #add-point:ON ACTION controlp INFIELD xmdd013
            {<point name="construct.c.page3.xmdd013" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdd009
            #add-point:BEFORE FIELD xmdd009
            {<point name="construct.b.page3.xmdd009" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdd009
            
            #add-point:AFTER FIELD xmdd009
            {<point name="construct.a.page3.xmdd009" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xmdd009
         ON ACTION controlp INFIELD xmdd009
            #add-point:ON ACTION controlp INFIELD xmdd009
            {<point name="construct.c.page3.xmdd009" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdd018
            #add-point:BEFORE FIELD xmdd018
            {<point name="construct.b.page3.xmdd018" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdd018
            
            #add-point:AFTER FIELD xmdd018
            {<point name="construct.a.page3.xmdd018" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xmdd018
         ON ACTION controlp INFIELD xmdd018
            #add-point:ON ACTION controlp INFIELD xmdd018
            {<point name="construct.c.page3.xmdd018" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdd020
            #add-point:BEFORE FIELD xmdd020
            {<point name="construct.b.page3.xmdd020" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdd020
            
            #add-point:AFTER FIELD xmdd020
            {<point name="construct.a.page3.xmdd020" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xmdd020
         ON ACTION controlp INFIELD xmdd020
            #add-point:ON ACTION controlp INFIELD xmdd020
            {<point name="construct.c.page3.xmdd020" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdd021
            #add-point:BEFORE FIELD xmdd021
            {<point name="construct.b.page3.xmdd021" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdd021
            
            #add-point:AFTER FIELD xmdd021
            {<point name="construct.a.page3.xmdd021" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xmdd021
         ON ACTION controlp INFIELD xmdd021
            #add-point:ON ACTION controlp INFIELD xmdd021
            {<point name="construct.c.page3.xmdd021" />}
            #END add-point
 
         #Ctrlp:construct.c.page3.xmdd022
         ON ACTION controlp INFIELD xmdd022
            #add-point:ON ACTION controlp INFIELD xmdd022
            {<point name="construct.c.page3.xmdd022" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdd022
            #add-point:BEFORE FIELD xmdd022
            {<point name="construct.b.page3.xmdd022" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdd022
            
            #add-point:AFTER FIELD xmdd022
            {<point name="construct.a.page3.xmdd022" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdd023
            #add-point:BEFORE FIELD xmdd023
            {<point name="construct.b.page3.xmdd023" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdd023
            
            #add-point:AFTER FIELD xmdd023
            {<point name="construct.a.page3.xmdd023" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xmdd023
         ON ACTION controlp INFIELD xmdd023
            #add-point:ON ACTION controlp INFIELD xmdd023
            {<point name="construct.c.page3.xmdd023" />}
            #END add-point
 
   
       
      END CONSTRUCT
 
      CONSTRUCT g_wc2_table3 ON xmjaseq,xmjasite,xmja001,xmja002,xmja003,xmja033,xmja004,xmja005,xmja006, 
          xmja007,xmja011,xmja012,xmja013,xmja014,xmja015,xmja016,xmja017,xmja018,xmja008,xmja009,xmja010, 
          xmja022,xmja019,xmja020,xmja021,xmja024,xmja025,xmja026,xmja027,xmja028,xmja029,xmja030,xmja031, 
          xmja032,xmja034
           FROM s_detail4[1].xmjaseq,s_detail4[1].xmjasite,s_detail4[1].xmja001,s_detail4[1].xmja002, 
               s_detail4[1].xmja003,s_detail4[1].xmja033,s_detail4[1].xmja004,s_detail4[1].xmja005,s_detail4[1].xmja006, 
               s_detail4[1].xmja007,s_detail4[1].xmja011,s_detail4[1].xmja012,s_detail4[1].xmja013,s_detail4[1].xmja014, 
               s_detail4[1].xmja015,s_detail4[1].xmja016,s_detail4[1].xmja017,s_detail4[1].xmja018,s_detail4[1].xmja008, 
               s_detail4[1].xmja009,s_detail4[1].xmja010,s_detail4[1].xmja022,s_detail4[1].xmja019,s_detail4[1].xmja020, 
               s_detail4[1].xmja021,s_detail4[1].xmja024,s_detail4[1].xmja025,s_detail4[1].xmja026,s_detail4[1].xmja027, 
               s_detail4[1].xmja028,s_detail4[1].xmja029,s_detail4[1].xmja030,s_detail4[1].xmja031,s_detail4[1].xmja032, 
               s_detail4[1].xmja034
                      
         BEFORE CONSTRUCT
            #add-point:cs段before_construct
            {<point name="cs.body3.before_construct"/>}
            #end add-point 
            
       #單身公用欄位開窗相關處理(table 3)
       
       
       #單身一般欄位開窗相關處理       
                #此段落由子樣板a01產生
         BEFORE FIELD xmjaseq
            #add-point:BEFORE FIELD xmjaseq
            {<point name="construct.b.page4.xmjaseq" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmjaseq
            
            #add-point:AFTER FIELD xmjaseq
            {<point name="construct.a.page4.xmjaseq" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.xmjaseq
         ON ACTION controlp INFIELD xmjaseq
            #add-point:ON ACTION controlp INFIELD xmjaseq
            {<point name="construct.c.page4.xmjaseq" />}
            #END add-point
 
         #Ctrlp:construct.c.page4.xmjasite
         ON ACTION controlp INFIELD xmjasite
            #add-point:ON ACTION controlp INFIELD xmjasite
            {<point name="construct.c.page4.xmjasite" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmjasite
            #add-point:BEFORE FIELD xmjasite
            {<point name="construct.b.page4.xmjasite" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmjasite
            
            #add-point:AFTER FIELD xmjasite
            {<point name="construct.a.page4.xmjasite" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmja001
            #add-point:BEFORE FIELD xmja001
            {<point name="construct.b.page4.xmja001" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmja001
            
            #add-point:AFTER FIELD xmja001
            {<point name="construct.a.page4.xmja001" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.xmja001
         ON ACTION controlp INFIELD xmja001
            #add-point:ON ACTION controlp INFIELD xmja001
            {<point name="construct.c.page4.xmja001" />}
            #END add-point
 
         #Ctrlp:construct.c.page4.xmja002
         ON ACTION controlp INFIELD xmja002
            #add-point:ON ACTION controlp INFIELD xmja002
            {<point name="construct.c.page4.xmja002" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmja002
            #add-point:BEFORE FIELD xmja002
            {<point name="construct.b.page4.xmja002" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmja002
            
            #add-point:AFTER FIELD xmja002
            {<point name="construct.a.page4.xmja002" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.xmja003
         ON ACTION controlp INFIELD xmja003
            #add-point:ON ACTION controlp INFIELD xmja003
            {<point name="construct.c.page4.xmja003" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmja003
            #add-point:BEFORE FIELD xmja003
            {<point name="construct.b.page4.xmja003" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmja003
            
            #add-point:AFTER FIELD xmja003
            {<point name="construct.a.page4.xmja003" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.xmja033
         ON ACTION controlp INFIELD xmja033
            #add-point:ON ACTION controlp INFIELD xmja033
            {<point name="construct.c.page4.xmja033" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmja033
            #add-point:BEFORE FIELD xmja033
            {<point name="construct.b.page4.xmja033" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmja033
            
            #add-point:AFTER FIELD xmja033
            {<point name="construct.a.page4.xmja033" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.xmja004
         ON ACTION controlp INFIELD xmja004
            #add-point:ON ACTION controlp INFIELD xmja004
            {<point name="construct.c.page4.xmja004" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmja004
            #add-point:BEFORE FIELD xmja004
            {<point name="construct.b.page4.xmja004" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmja004
            
            #add-point:AFTER FIELD xmja004
            {<point name="construct.a.page4.xmja004" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.xmja005
         ON ACTION controlp INFIELD xmja005
            #add-point:ON ACTION controlp INFIELD xmja005
            {<point name="construct.c.page4.xmja005" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmja005
            #add-point:BEFORE FIELD xmja005
            {<point name="construct.b.page4.xmja005" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmja005
            
            #add-point:AFTER FIELD xmja005
            {<point name="construct.a.page4.xmja005" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.xmja006
         ON ACTION controlp INFIELD xmja006
            #add-point:ON ACTION controlp INFIELD xmja006
            {<point name="construct.c.page4.xmja006" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmja006
            #add-point:BEFORE FIELD xmja006
            {<point name="construct.b.page4.xmja006" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmja006
            
            #add-point:AFTER FIELD xmja006
            {<point name="construct.a.page4.xmja006" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmja007
            #add-point:BEFORE FIELD xmja007
            {<point name="construct.b.page4.xmja007" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmja007
            
            #add-point:AFTER FIELD xmja007
            {<point name="construct.a.page4.xmja007" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.xmja007
         ON ACTION controlp INFIELD xmja007
            #add-point:ON ACTION controlp INFIELD xmja007
            {<point name="construct.c.page4.xmja007" />}
            #END add-point
 
         #Ctrlp:construct.c.page4.xmja011
         ON ACTION controlp INFIELD xmja011
            #add-point:ON ACTION controlp INFIELD xmja011
            {<point name="construct.c.page4.xmja011" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmja011
            #add-point:BEFORE FIELD xmja011
            {<point name="construct.b.page4.xmja011" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmja011
            
            #add-point:AFTER FIELD xmja011
            {<point name="construct.a.page4.xmja011" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmja012
            #add-point:BEFORE FIELD xmja012
            {<point name="construct.b.page4.xmja012" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmja012
            
            #add-point:AFTER FIELD xmja012
            {<point name="construct.a.page4.xmja012" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.xmja012
         ON ACTION controlp INFIELD xmja012
            #add-point:ON ACTION controlp INFIELD xmja012
            {<point name="construct.c.page4.xmja012" />}
            #END add-point
 
         #Ctrlp:construct.c.page4.xmja013
         ON ACTION controlp INFIELD xmja013
            #add-point:ON ACTION controlp INFIELD xmja013
            {<point name="construct.c.page4.xmja013" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmja013
            #add-point:BEFORE FIELD xmja013
            {<point name="construct.b.page4.xmja013" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmja013
            
            #add-point:AFTER FIELD xmja013
            {<point name="construct.a.page4.xmja013" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmja014
            #add-point:BEFORE FIELD xmja014
            {<point name="construct.b.page4.xmja014" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmja014
            
            #add-point:AFTER FIELD xmja014
            {<point name="construct.a.page4.xmja014" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.xmja014
         ON ACTION controlp INFIELD xmja014
            #add-point:ON ACTION controlp INFIELD xmja014
            {<point name="construct.c.page4.xmja014" />}
            #END add-point
 
         #Ctrlp:construct.c.page4.xmja015
         ON ACTION controlp INFIELD xmja015
            #add-point:ON ACTION controlp INFIELD xmja015
            {<point name="construct.c.page4.xmja015" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmja015
            #add-point:BEFORE FIELD xmja015
            {<point name="construct.b.page4.xmja015" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmja015
            
            #add-point:AFTER FIELD xmja015
            {<point name="construct.a.page4.xmja015" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmja016
            #add-point:BEFORE FIELD xmja016
            {<point name="construct.b.page4.xmja016" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmja016
            
            #add-point:AFTER FIELD xmja016
            {<point name="construct.a.page4.xmja016" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.xmja016
         ON ACTION controlp INFIELD xmja016
            #add-point:ON ACTION controlp INFIELD xmja016
            {<point name="construct.c.page4.xmja016" />}
            #END add-point
 
         #Ctrlp:construct.c.page4.xmja017
         ON ACTION controlp INFIELD xmja017
            #add-point:ON ACTION controlp INFIELD xmja017
            {<point name="construct.c.page4.xmja017" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmja017
            #add-point:BEFORE FIELD xmja017
            {<point name="construct.b.page4.xmja017" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmja017
            
            #add-point:AFTER FIELD xmja017
            {<point name="construct.a.page4.xmja017" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmja018
            #add-point:BEFORE FIELD xmja018
            {<point name="construct.b.page4.xmja018" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmja018
            
            #add-point:AFTER FIELD xmja018
            {<point name="construct.a.page4.xmja018" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.xmja018
         ON ACTION controlp INFIELD xmja018
            #add-point:ON ACTION controlp INFIELD xmja018
            {<point name="construct.c.page4.xmja018" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmja008
            #add-point:BEFORE FIELD xmja008
            {<point name="construct.b.page4.xmja008" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmja008
            
            #add-point:AFTER FIELD xmja008
            {<point name="construct.a.page4.xmja008" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.xmja008
         ON ACTION controlp INFIELD xmja008
            #add-point:ON ACTION controlp INFIELD xmja008
            {<point name="construct.c.page4.xmja008" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmja009
            #add-point:BEFORE FIELD xmja009
            {<point name="construct.b.page4.xmja009" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmja009
            
            #add-point:AFTER FIELD xmja009
            {<point name="construct.a.page4.xmja009" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.xmja009
         ON ACTION controlp INFIELD xmja009
            #add-point:ON ACTION controlp INFIELD xmja009
            {<point name="construct.c.page4.xmja009" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmja010
            #add-point:BEFORE FIELD xmja010
            {<point name="construct.b.page4.xmja010" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmja010
            
            #add-point:AFTER FIELD xmja010
            {<point name="construct.a.page4.xmja010" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.xmja010
         ON ACTION controlp INFIELD xmja010
            #add-point:ON ACTION controlp INFIELD xmja010
            {<point name="construct.c.page4.xmja010" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmja022
            #add-point:BEFORE FIELD xmja022
            {<point name="construct.b.page4.xmja022" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmja022
            
            #add-point:AFTER FIELD xmja022
            {<point name="construct.a.page4.xmja022" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.xmja022
         ON ACTION controlp INFIELD xmja022
            #add-point:ON ACTION controlp INFIELD xmja022
            {<point name="construct.c.page4.xmja022" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmja019
            #add-point:BEFORE FIELD xmja019
            {<point name="construct.b.page4.xmja019" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmja019
            
            #add-point:AFTER FIELD xmja019
            {<point name="construct.a.page4.xmja019" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.xmja019
         ON ACTION controlp INFIELD xmja019
            #add-point:ON ACTION controlp INFIELD xmja019
            {<point name="construct.c.page4.xmja019" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmja020
            #add-point:BEFORE FIELD xmja020
            {<point name="construct.b.page4.xmja020" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmja020
            
            #add-point:AFTER FIELD xmja020
            {<point name="construct.a.page4.xmja020" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.xmja020
         ON ACTION controlp INFIELD xmja020
            #add-point:ON ACTION controlp INFIELD xmja020
            {<point name="construct.c.page4.xmja020" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmja021
            #add-point:BEFORE FIELD xmja021
            {<point name="construct.b.page4.xmja021" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmja021
            
            #add-point:AFTER FIELD xmja021
            {<point name="construct.a.page4.xmja021" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.xmja021
         ON ACTION controlp INFIELD xmja021
            #add-point:ON ACTION controlp INFIELD xmja021
            {<point name="construct.c.page4.xmja021" />}
            #END add-point
 
         #Ctrlp:construct.c.page4.xmja024
         ON ACTION controlp INFIELD xmja024
            #add-point:ON ACTION controlp INFIELD xmja024
            {<point name="construct.c.page4.xmja024" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmja024
            #add-point:BEFORE FIELD xmja024
            {<point name="construct.b.page4.xmja024" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmja024
            
            #add-point:AFTER FIELD xmja024
            {<point name="construct.a.page4.xmja024" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmja025
            #add-point:BEFORE FIELD xmja025
            {<point name="construct.b.page4.xmja025" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmja025
            
            #add-point:AFTER FIELD xmja025
            {<point name="construct.a.page4.xmja025" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.xmja025
         ON ACTION controlp INFIELD xmja025
            #add-point:ON ACTION controlp INFIELD xmja025
            {<point name="construct.c.page4.xmja025" />}
            #END add-point
 
         #Ctrlp:construct.c.page4.xmja026
         ON ACTION controlp INFIELD xmja026
            #add-point:ON ACTION controlp INFIELD xmja026
            {<point name="construct.c.page4.xmja026" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmja026
            #add-point:BEFORE FIELD xmja026
            {<point name="construct.b.page4.xmja026" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmja026
            
            #add-point:AFTER FIELD xmja026
            {<point name="construct.a.page4.xmja026" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.xmja027
         ON ACTION controlp INFIELD xmja027
            #add-point:ON ACTION controlp INFIELD xmja027
            {<point name="construct.c.page4.xmja027" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmja027
            #add-point:BEFORE FIELD xmja027
            {<point name="construct.b.page4.xmja027" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmja027
            
            #add-point:AFTER FIELD xmja027
            {<point name="construct.a.page4.xmja027" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.xmja028
         ON ACTION controlp INFIELD xmja028
            #add-point:ON ACTION controlp INFIELD xmja028
            {<point name="construct.c.page4.xmja028" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmja028
            #add-point:BEFORE FIELD xmja028
            {<point name="construct.b.page4.xmja028" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmja028
            
            #add-point:AFTER FIELD xmja028
            {<point name="construct.a.page4.xmja028" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmja029
            #add-point:BEFORE FIELD xmja029
            {<point name="construct.b.page4.xmja029" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmja029
            
            #add-point:AFTER FIELD xmja029
            {<point name="construct.a.page4.xmja029" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.xmja029
         ON ACTION controlp INFIELD xmja029
            #add-point:ON ACTION controlp INFIELD xmja029
            {<point name="construct.c.page4.xmja029" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmja030
            #add-point:BEFORE FIELD xmja030
            {<point name="construct.b.page4.xmja030" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmja030
            
            #add-point:AFTER FIELD xmja030
            {<point name="construct.a.page4.xmja030" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.xmja030
         ON ACTION controlp INFIELD xmja030
            #add-point:ON ACTION controlp INFIELD xmja030
            {<point name="construct.c.page4.xmja030" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmja031
            #add-point:BEFORE FIELD xmja031
            {<point name="construct.b.page4.xmja031" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmja031
            
            #add-point:AFTER FIELD xmja031
            {<point name="construct.a.page4.xmja031" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.xmja031
         ON ACTION controlp INFIELD xmja031
            #add-point:ON ACTION controlp INFIELD xmja031
            {<point name="construct.c.page4.xmja031" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmja032
            #add-point:BEFORE FIELD xmja032
            {<point name="construct.b.page4.xmja032" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmja032
            
            #add-point:AFTER FIELD xmja032
            {<point name="construct.a.page4.xmja032" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.xmja032
         ON ACTION controlp INFIELD xmja032
            #add-point:ON ACTION controlp INFIELD xmja032
            {<point name="construct.c.page4.xmja032" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmja034
            #add-point:BEFORE FIELD xmja034
            {<point name="construct.b.page4.xmja034" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmja034
            
            #add-point:AFTER FIELD xmja034
            {<point name="construct.a.page4.xmja034" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.xmja034
         ON ACTION controlp INFIELD xmja034
            #add-point:ON ACTION controlp INFIELD xmja034
            {<point name="construct.c.page4.xmja034" />}
            #END add-point
 
   
       
      END CONSTRUCT
 
      CONSTRUCT g_wc2_table4 ON xmdbsite,xmdb001,xmdb002,xmdb003,xmdb004,xmdb005,xmdb006,xmdb007,xmdb008, 
          xmdb009
           FROM s_detail5[1].xmdbsite,s_detail5[1].xmdb001,s_detail5[1].xmdb002,s_detail5[1].xmdb003, 
               s_detail5[1].xmdb004,s_detail5[1].xmdb005,s_detail5[1].xmdb006,s_detail5[1].xmdb007,s_detail5[1].xmdb008, 
               s_detail5[1].xmdb009
                      
         BEFORE CONSTRUCT
            #add-point:cs段before_construct
            {<point name="cs.body4.before_construct"/>}
            #end add-point 
            
       #單身公用欄位開窗相關處理(table 4)
       
       
       #單身一般欄位開窗相關處理       
                #此段落由子樣板a01產生
         BEFORE FIELD xmdbsite
            #add-point:BEFORE FIELD xmdbsite
            {<point name="construct.b.page5.xmdbsite" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdbsite
            
            #add-point:AFTER FIELD xmdbsite
            {<point name="construct.a.page5.xmdbsite" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page5.xmdbsite
         ON ACTION controlp INFIELD xmdbsite
            #add-point:ON ACTION controlp INFIELD xmdbsite
            {<point name="construct.c.page5.xmdbsite" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdb001
            #add-point:BEFORE FIELD xmdb001
            {<point name="construct.b.page5.xmdb001" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdb001
            
            #add-point:AFTER FIELD xmdb001
            {<point name="construct.a.page5.xmdb001" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page5.xmdb001
         ON ACTION controlp INFIELD xmdb001
            #add-point:ON ACTION controlp INFIELD xmdb001
            {<point name="construct.c.page5.xmdb001" />}
            #END add-point
 
         #Ctrlp:construct.c.page5.xmdb002
         ON ACTION controlp INFIELD xmdb002
            #add-point:ON ACTION controlp INFIELD xmdb002
            {<point name="construct.c.page5.xmdb002" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdb002
            #add-point:BEFORE FIELD xmdb002
            {<point name="construct.b.page5.xmdb002" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdb002
            
            #add-point:AFTER FIELD xmdb002
            {<point name="construct.a.page5.xmdb002" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdb003
            #add-point:BEFORE FIELD xmdb003
            {<point name="construct.b.page5.xmdb003" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdb003
            
            #add-point:AFTER FIELD xmdb003
            {<point name="construct.a.page5.xmdb003" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page5.xmdb003
         ON ACTION controlp INFIELD xmdb003
            #add-point:ON ACTION controlp INFIELD xmdb003
            {<point name="construct.c.page5.xmdb003" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdb004
            #add-point:BEFORE FIELD xmdb004
            {<point name="construct.b.page5.xmdb004" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdb004
            
            #add-point:AFTER FIELD xmdb004
            {<point name="construct.a.page5.xmdb004" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page5.xmdb004
         ON ACTION controlp INFIELD xmdb004
            #add-point:ON ACTION controlp INFIELD xmdb004
            {<point name="construct.c.page5.xmdb004" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdb005
            #add-point:BEFORE FIELD xmdb005
            {<point name="construct.b.page5.xmdb005" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdb005
            
            #add-point:AFTER FIELD xmdb005
            {<point name="construct.a.page5.xmdb005" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page5.xmdb005
         ON ACTION controlp INFIELD xmdb005
            #add-point:ON ACTION controlp INFIELD xmdb005
            {<point name="construct.c.page5.xmdb005" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdb006
            #add-point:BEFORE FIELD xmdb006
            {<point name="construct.b.page5.xmdb006" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdb006
            
            #add-point:AFTER FIELD xmdb006
            {<point name="construct.a.page5.xmdb006" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page5.xmdb006
         ON ACTION controlp INFIELD xmdb006
            #add-point:ON ACTION controlp INFIELD xmdb006
            {<point name="construct.c.page5.xmdb006" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdb007
            #add-point:BEFORE FIELD xmdb007
            {<point name="construct.b.page5.xmdb007" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdb007
            
            #add-point:AFTER FIELD xmdb007
            {<point name="construct.a.page5.xmdb007" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page5.xmdb007
         ON ACTION controlp INFIELD xmdb007
            #add-point:ON ACTION controlp INFIELD xmdb007
            {<point name="construct.c.page5.xmdb007" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdb008
            #add-point:BEFORE FIELD xmdb008
            {<point name="construct.b.page5.xmdb008" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdb008
            
            #add-point:AFTER FIELD xmdb008
            {<point name="construct.a.page5.xmdb008" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page5.xmdb008
         ON ACTION controlp INFIELD xmdb008
            #add-point:ON ACTION controlp INFIELD xmdb008
            {<point name="construct.c.page5.xmdb008" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdb009
            #add-point:BEFORE FIELD xmdb009
            {<point name="construct.b.page5.xmdb009" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdb009
            
            #add-point:AFTER FIELD xmdb009
            {<point name="construct.a.page5.xmdb009" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page5.xmdb009
         ON ACTION controlp INFIELD xmdb009
            #add-point:ON ACTION controlp INFIELD xmdb009
            {<point name="construct.c.page5.xmdb009" />}
            #END add-point
 
   
       
      END CONSTRUCT
 
      CONSTRUCT g_wc2_table5 ON xrcdseq,xrcdld,imay0031,imaa0011,xrcd002,xrcdseq2,xrcd007,xrcd003,xrcd006, 
          xrcd004,xrcd104
           FROM s_detail6[1].xrcdseq,s_detail6[1].xrcdld,s_detail6[1].imay0031,s_detail6[1].imaa0011, 
               s_detail6[1].xrcd002,s_detail6[1].xrcdseq2,s_detail6[1].xrcd007,s_detail6[1].xrcd003, 
               s_detail6[1].xrcd006,s_detail6[1].xrcd004,s_detail6[1].xrcd104
                      
         BEFORE CONSTRUCT
            #add-point:cs段before_construct
            {<point name="cs.body5.before_construct"/>}
            #end add-point 
            
       #單身公用欄位開窗相關處理(table 5)
       
       
       #單身一般欄位開窗相關處理       
                #此段落由子樣板a01產生
         BEFORE FIELD xrcdseq
            #add-point:BEFORE FIELD xrcdseq
            {<point name="construct.b.page6.xrcdseq" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xrcdseq
            
            #add-point:AFTER FIELD xrcdseq
            {<point name="construct.a.page6.xrcdseq" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page6.xrcdseq
         ON ACTION controlp INFIELD xrcdseq
            #add-point:ON ACTION controlp INFIELD xrcdseq
            {<point name="construct.c.page6.xrcdseq" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xrcdld
            #add-point:BEFORE FIELD xrcdld
            {<point name="construct.b.page6.xrcdld" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xrcdld
            
            #add-point:AFTER FIELD xrcdld
            {<point name="construct.a.page6.xrcdld" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page6.xrcdld
         ON ACTION controlp INFIELD xrcdld
            #add-point:ON ACTION controlp INFIELD xrcdld
            {<point name="construct.c.page6.xrcdld" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD imay0031
            #add-point:BEFORE FIELD imay0031
            {<point name="construct.b.page6.imay0031" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD imay0031
            
            #add-point:AFTER FIELD imay0031
            {<point name="construct.a.page6.imay0031" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page6.imay0031
         ON ACTION controlp INFIELD imay0031
            #add-point:ON ACTION controlp INFIELD imay0031
            {<point name="construct.c.page6.imay0031" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD imaa0011
            #add-point:BEFORE FIELD imaa0011
            {<point name="construct.b.page6.imaa0011" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD imaa0011
            
            #add-point:AFTER FIELD imaa0011
            {<point name="construct.a.page6.imaa0011" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page6.imaa0011
         ON ACTION controlp INFIELD imaa0011
            #add-point:ON ACTION controlp INFIELD imaa0011
            {<point name="construct.c.page6.imaa0011" />}
            #END add-point
 
         #Ctrlp:construct.c.page6.xrcd002
         ON ACTION controlp INFIELD xrcd002
            #add-point:ON ACTION controlp INFIELD xrcd002
            {<point name="construct.c.page6.xrcd002" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xrcd002
            #add-point:BEFORE FIELD xrcd002
            {<point name="construct.b.page6.xrcd002" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xrcd002
            
            #add-point:AFTER FIELD xrcd002
            {<point name="construct.a.page6.xrcd002" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xrcdseq2
            #add-point:BEFORE FIELD xrcdseq2
            {<point name="construct.b.page6.xrcdseq2" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xrcdseq2
            
            #add-point:AFTER FIELD xrcdseq2
            {<point name="construct.a.page6.xrcdseq2" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page6.xrcdseq2
         ON ACTION controlp INFIELD xrcdseq2
            #add-point:ON ACTION controlp INFIELD xrcdseq2
            {<point name="construct.c.page6.xrcdseq2" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xrcd007
            #add-point:BEFORE FIELD xrcd007
            {<point name="construct.b.page6.xrcd007" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xrcd007
            
            #add-point:AFTER FIELD xrcd007
            {<point name="construct.a.page6.xrcd007" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page6.xrcd007
         ON ACTION controlp INFIELD xrcd007
            #add-point:ON ACTION controlp INFIELD xrcd007
            {<point name="construct.c.page6.xrcd007" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xrcd003
            #add-point:BEFORE FIELD xrcd003
            {<point name="construct.b.page6.xrcd003" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xrcd003
            
            #add-point:AFTER FIELD xrcd003
            {<point name="construct.a.page6.xrcd003" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page6.xrcd003
         ON ACTION controlp INFIELD xrcd003
            #add-point:ON ACTION controlp INFIELD xrcd003
            {<point name="construct.c.page6.xrcd003" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xrcd006
            #add-point:BEFORE FIELD xrcd006
            {<point name="construct.b.page6.xrcd006" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xrcd006
            
            #add-point:AFTER FIELD xrcd006
            {<point name="construct.a.page6.xrcd006" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page6.xrcd006
         ON ACTION controlp INFIELD xrcd006
            #add-point:ON ACTION controlp INFIELD xrcd006
            {<point name="construct.c.page6.xrcd006" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xrcd004
            #add-point:BEFORE FIELD xrcd004
            {<point name="construct.b.page6.xrcd004" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xrcd004
            
            #add-point:AFTER FIELD xrcd004
            {<point name="construct.a.page6.xrcd004" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page6.xrcd004
         ON ACTION controlp INFIELD xrcd004
            #add-point:ON ACTION controlp INFIELD xrcd004
            {<point name="construct.c.page6.xrcd004" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xrcd104
            #add-point:BEFORE FIELD xrcd104
            {<point name="construct.b.page6.xrcd104" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xrcd104
            
            #add-point:AFTER FIELD xrcd104
            {<point name="construct.a.page6.xrcd104" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page6.xrcd104
         ON ACTION controlp INFIELD xrcd104
            #add-point:ON ACTION controlp INFIELD xrcd104
            {<point name="construct.c.page6.xrcd104" />}
            #END add-point
 
   
       
      END CONSTRUCT
 
 
      
 
      
      #add-point:cs段add_cs(本段內只能出現新的CONSTRUCT指令)
      {<point name="cs.add_cs"/>}
      #end add-point
 
      BEFORE DIALOG
         CALL cl_qbe_init()
         #add-point:cs段b_dialog
         {<point name="cs.b_dialog"/>}
         #end add-point  
 
      #查詢方案列表
      ON ACTION qbe_select
         LET ls_wc = ""
         CALL cl_qbe_list("c") RETURNING ls_wc
    
      #條件儲存為方案
      ON ACTION qbe_save
         CALL cl_qbe_save()
 
      ON ACTION accept
         ACCEPT DIALOG
 
      ON ACTION cancel
         LET INT_FLAG = 1
         EXIT DIALOG 
 
      #交談指令共用ACTION
      &include "common_action.4gl" 
         CONTINUE DIALOG
   END DIALOG
   
   #組合g_wc2
   LET g_wc2 = g_wc2_table1
   IF g_wc2_table2 <> " 1=1" THEN
      LET g_wc2 = g_wc2 ," AND ", g_wc2_table2
   END IF
 
   IF g_wc2_table3 <> " 1=1" THEN
      LET g_wc2 = g_wc2 ," AND ", g_wc2_table3
   END IF
 
   IF g_wc2_table4 <> " 1=1" THEN
      LET g_wc2 = g_wc2 ," AND ", g_wc2_table4
   END IF
 
   IF g_wc2_table5 <> " 1=1" THEN
      LET g_wc2 = g_wc2 ," AND ", g_wc2_table5
   END IF
 
 
 
 
   
   #add-point:cs段結束前
   {<point name="cs.after_construct"/>}
   #end add-point    
 
   IF INT_FLAG THEN
      RETURN
   END IF
 
END FUNCTION
]]>
  </section>
  <section id="adbt500.default_search" ver="4" status="" src="s">
    <![CDATA[#+ 外部參數搜尋
PRIVATE FUNCTION adbt500_default_search()
   DEFINE li_idx  LIKE type_t.num5
   DEFINE li_cnt  LIKE type_t.num5
   DEFINE ls_wc   STRING
   #add-point:default_search段define
   {<point name="default_search.define"/>}
   #end add-point  
   
   #add-point:default_search段開始前
   {<point name="default_search.before"/>}
   #end add-point  
   
   LET g_pagestart = 1
   
   IF cl_null(g_order) THEN
      LET g_order = "ASC"
   END IF
   
   IF NOT cl_null(g_argv[01]) THEN
      LET ls_wc = ls_wc, " xmdadocno = '", g_argv[01], "' AND "
   END IF
   
 
   
   IF NOT cl_null(ls_wc) THEN
      LET g_wc = ls_wc.subString(1,ls_wc.getLength()-5)
      LET g_default = TRUE
   ELSE
      LET g_default = FALSE
      #預設查詢條件
      LET g_wc = cl_qbe_get_default_qryplan()
      IF cl_null(g_wc) THEN
         LET g_wc = " 1=1"
      END IF
   END IF
   
   #add-point:default_search段結束前
   {<point name="default_search.after"/>}
   #end add-point  
 
END FUNCTION
]]>
  </section>
  <section id="adbt500.delete" ver="59" status="" src="s">
    <![CDATA[#+ 資料刪除
PRIVATE FUNCTION adbt500_delete()
   DEFINE  l_var_keys      DYNAMIC ARRAY OF STRING
   DEFINE  l_field_keys    DYNAMIC ARRAY OF STRING
   DEFINE  l_vars          DYNAMIC ARRAY OF STRING
   DEFINE  l_fields        DYNAMIC ARRAY OF STRING
   DEFINE  l_var_keys_bak  DYNAMIC ARRAY OF STRING
   #add-point:delete段define
   {<point name="delete.define"/>}
   #end add-point     
   
   IF g_xmda_m.xmdadocno IS NULL
 
   THEN
      CALL cl_err("","std-00003",0)
      RETURN
   END IF
   
   
 
   CALL adbt500_show()
   
   CALL s_transaction_begin()
 
   OPEN adbt500_cl USING g_enterprise,g_xmda_m.xmdadocno
   IF STATUS THEN
      CALL cl_err("OPEN adbt500_cl:", STATUS, 1)
      CLOSE adbt500_cl
      CALL s_transaction_end('N','0')
      RETURN
   END IF
 
   #顯示最新的資料
   EXECUTE adbt500_master_referesh USING g_xmda_m.xmdadocno INTO g_xmda_m.xmdasite,g_xmda_m.xmdadocdt, 
       g_xmda_m.xmdadocno,g_xmda_m.xmda001,g_xmda_m.xmda005,g_xmda_m.xmda202,g_xmda_m.xmda023,g_xmda_m.xmda004, 
       g_xmda_m.xmda200,g_xmda_m.xmda201,g_xmda_m.xmdastus,g_xmda_m.xmda007,g_xmda_m.xmda008,g_xmda_m.xmda021, 
       g_xmda_m.xmda022,g_xmda_m.xmda203,g_xmda_m.xmda027,g_xmda_m.xmda024,g_xmda_m.xmda002,g_xmda_m.xmda003, 
       g_xmda_m.xmdaunit,g_xmda_m.xmda204,g_xmda_m.xmda205,g_xmda_m.xmda032,g_xmda_m.xmda071,g_xmda_m.xmda025, 
       g_xmda_m.xmda026,g_xmda_m.xmda206,g_xmda_m.xmda207,g_xmda_m.xmda020,g_xmda_m.xmda036,g_xmda_m.xmda009, 
       g_xmda_m.xmda010,g_xmda_m.xmda015,g_xmda_m.xmda016,g_xmda_m.xmda011,g_xmda_m.xmda012,g_xmda_m.xmda013, 
       g_xmda_m.xmda035,g_xmda_m.xmda039,g_xmda_m.xmdaownid,g_xmda_m.xmdaowndp,g_xmda_m.xmdacrtid,g_xmda_m.xmdacrtdp, 
       g_xmda_m.xmdacrtdt,g_xmda_m.xmdamodid,g_xmda_m.xmdamoddt,g_xmda_m.xmdacnfid,g_xmda_m.xmdacnfdt, 
       g_xmda_m.xmda034,g_xmda_m.xmda006,g_xmda_m.xmda033,g_xmda_m.xmda017,g_xmda_m.xmda019,g_xmda_m.xmda018, 
       g_xmda_m.xmda044,g_xmda_m.xmda030,g_xmda_m.xmda031,g_xmda_m.xmda045,g_xmda_m.xmda046,g_xmda_m.xmda047, 
       g_xmda_m.xmda028,g_xmda_m.xmda041,g_xmda_m.xmda042,g_xmda_m.xmda043,g_xmda_m.xmdasite_desc,g_xmda_m.xmda202_desc, 
       g_xmda_m.xmda023_desc,g_xmda_m.xmda004_desc,g_xmda_m.xmda200_desc,g_xmda_m.xmda201_desc,g_xmda_m.xmda021_desc, 
       g_xmda_m.xmda022_desc,g_xmda_m.xmda203_desc,g_xmda_m.xmda027_desc,g_xmda_m.xmda024_desc,g_xmda_m.xmda002_desc, 
       g_xmda_m.xmda003_desc,g_xmda_m.xmdaunit_desc,g_xmda_m.xmda204_desc,g_xmda_m.xmda032_desc,g_xmda_m.xmda206_desc, 
       g_xmda_m.xmda207_desc,g_xmda_m.xmda020_desc,g_xmda_m.xmda036_desc,g_xmda_m.xmda009_desc,g_xmda_m.xmda010_desc, 
       g_xmda_m.xmda015_desc,g_xmda_m.xmdaownid_desc,g_xmda_m.xmdaowndp_desc,g_xmda_m.xmdacrtid_desc, 
       g_xmda_m.xmdacrtdp_desc,g_xmda_m.xmdamodid_desc,g_xmda_m.xmdacnfid_desc,g_xmda_m.xmda034_desc, 
       g_xmda_m.xmda017_desc,g_xmda_m.xmda018_desc
 
   IF SQLCA.sqlcode THEN
      CALL cl_err(g_xmda_m.xmdadocno,SQLCA.sqlcode,0)          #資料被他人LOCK
      CALL s_transaction_end('N','0')
      RETURN
   END IF
   
   #add-point:delete段before ask
   {<point name="delete.before_ask"/>}
   #end add-point 
 
   IF cl_ask_del_master() THEN              #確認一下
   
      #add-point:單頭刪除前
      {<point name="delete.head.b_delete" mark="Y"/>}
      #end add-point   
      
      #+ 此段落由子樣板a47產生
      #刪除相關文件
      CALL adbt500_set_pk_array()
      #add-point:相關文件刪除前
      {<point name="delete.befroe.related_document_remove"/>}
      #end add-point   
      CALL cl_doc_remove()  
 
  
  
      #資料備份
      LET g_xmdadocno_t = g_xmda_m.xmdadocno
 
 
      DELETE FROM xmda_t
       WHERE xmdaent = g_enterprise AND xmdadocno = g_xmda_m.xmdadocno
 
       
      #add-point:單頭刪除中
      {<point name="delete.head.m_delete"/>}
      #end add-point
       
      IF SQLCA.sqlcode THEN
         CALL cl_err(g_xmda_m.xmdadocno,SQLCA.sqlcode,0) 
         CALL s_transaction_end('N','0')
         RETURN
      END IF
      
      #add-point:單頭刪除後
      {<point name="delete.head.a_delete"/>}
      #end add-point
  
      #add-point:單身刪除前
      {<point name="delete.body.b_delete" mark="Y"/>}
      #end add-point
      
      DELETE FROM xmdc_t
       WHERE xmdcent = g_enterprise AND xmdcdocno = g_xmda_m.xmdadocno
 
 
      #add-point:單身刪除中
      {<point name="delete.body.m_delete"/>}
      #end add-point
         
      IF SQLCA.sqlcode THEN
         CALL cl_err("xmdc_t",SQLCA.sqlcode,0) 
         CALL s_transaction_end('N','0')
         RETURN
      END IF    
 
      #add-point:單身刪除後
      {<point name="delete.body.a_delete"/>}
      #end add-point
      
            
                                                               
      #add-point:單身刪除前
      {<point name="delete.body.b_delete2" mark="Y"/>}
      #end add-point
      DELETE FROM xmdd_t
       WHERE xmddent = g_enterprise AND
             xmdddocno = g_xmda_m.xmdadocno
      #add-point:單身刪除中
      {<point name="delete.body.m_delete2"/>}
      #end add-point
      IF SQLCA.sqlcode THEN
         CALL cl_err("xmdd_t",SQLCA.sqlcode,0) 
         CALL s_transaction_end('N','0')
         RETURN
      END IF      
 
      #add-point:單身刪除後
      {<point name="delete.body.a_delete2"/>}
      #end add-point
 
      #add-point:單身刪除前
      {<point name="delete.body.b_delete3" mark="Y"/>}
      #end add-point
      DELETE FROM xmja_t
       WHERE xmjaent = g_enterprise AND
             xmjadocno = g_xmda_m.xmdadocno
      #add-point:單身刪除中
      {<point name="delete.body.m_delete3"/>}
      #end add-point
      IF SQLCA.sqlcode THEN
         CALL cl_err("xmja_t",SQLCA.sqlcode,0) 
         CALL s_transaction_end('N','0')
         RETURN
      END IF      
 
      #add-point:單身刪除後
      {<point name="delete.body.a_delete3"/>}
      #end add-point
 
      #add-point:單身刪除前
      {<point name="delete.body.b_delete4" mark="Y"/>}
      #end add-point
      DELETE FROM xmdb_t
       WHERE xmdbent = g_enterprise AND
             xmdbdocno = g_xmda_m.xmdadocno
      #add-point:單身刪除中
      {<point name="delete.body.m_delete4"/>}
      #end add-point
      IF SQLCA.sqlcode THEN
         CALL cl_err("xmdb_t",SQLCA.sqlcode,0) 
         CALL s_transaction_end('N','0')
         RETURN
      END IF      
 
      #add-point:單身刪除後
      {<point name="delete.body.a_delete4"/>}
      #end add-point
 
      #add-point:單身刪除前
      {<point name="delete.body.b_delete5" mark="Y"/>}
      #end add-point
      DELETE FROM xrcd_t
       WHERE xrcdent = g_enterprise AND
             xrcddocno = g_xmda_m.xmdadocno
      #add-point:單身刪除中
      {<point name="delete.body.m_delete5"/>}
      #end add-point
      IF SQLCA.sqlcode THEN
         CALL cl_err("xrcd_t",SQLCA.sqlcode,0) 
         CALL s_transaction_end('N','0')
         RETURN
      END IF      
 
      #add-point:單身刪除後
      {<point name="delete.body.a_delete5"/>}
      #end add-point
 
 
 
 
                                                               
      CLEAR FORM
      CALL g_xmdc_d.clear() 
      CALL g_xmdc3_d.clear()       
      CALL g_xmdc4_d.clear()       
      CALL g_xmdc5_d.clear()       
      CALL g_xmdc6_d.clear()       
 
     
      #CALL adbt500_ui_browser_refresh()  
      CALL adbt500_ui_headershow()  
      CALL adbt500_ui_detailshow()
       
      IF g_browser_cnt > 0 THEN 
         CALL adbt500_browser_fill("")
         CALL adbt500_fetch('P')
         DISPLAY g_browser_cnt TO FORMONLY.h_count   #總筆數的顯示
      ELSE
         LET g_wc = " 1=1"
         CALL adbt500_browser_fill("F")
      END IF
      
      #單頭多語言刪除
      
      
      #單身多語言刪除
      
      
 
      
 
      
 
      
 
 
 
   
      #add-point:多語言刪除
      {<point name="delete.lang.delete"/>}
      #end add-point
   
   END IF
 
   CALL s_transaction_end('Y','0')
   
   CLOSE adbt500_cl
 
   #流程通知預埋點-D
   CALL cl_flow_notify(g_xmda_m.xmdadocno,'D')
    
END FUNCTION
]]>
  </section>
  <section id="adbt500.delete_b" ver="16" status="" src="s">
    <![CDATA[#+ 刪除單身後其他table連動
PRIVATE FUNCTION adbt500_delete_b(ps_table,ps_keys_bak,ps_page)
   DEFINE ps_table    STRING
   DEFINE ps_page     STRING
   DEFINE ps_keys_bak DYNAMIC ARRAY OF VARCHAR(500)
   DEFINE ls_group    STRING
   #add-point:delete_b段define
   {<point name="delete_b.define"/>}
   #end add-point     
 
   #判斷是否是同一群組的table
   LET ls_group = "'1',"
   IF ls_group.getIndexOf(ps_page,1) > 0 THEN
      #add-point:delete_b段刪除前
      {<point name="delete_b.b_delete" mark="Y"/>}
      #end add-point    
      DELETE FROM xmdc_t
       WHERE xmdcent = g_enterprise AND
         xmdcdocno = ps_keys_bak[1] AND xmdcseq = ps_keys_bak[2]
      #add-point:delete_b段刪除中
      {<point name="delete_b.m_delete"/>}
      #end add-point    
      IF SQLCA.sqlcode THEN
         CALL cl_err("",SQLCA.sqlcode,0)
      END IF
      #add-point:delete_b段刪除後
      {<point name="delete_b.a_delete"/>}
      #end add-point   
   END IF
   
   LET ls_group = "'2',"
   #判斷是否是同一群組的table
   IF ls_group.getIndexOf(ps_page,1) > 0 THEN
      #add-point:delete_b段刪除前
      {<point name="delete_b.b_delete2" mark="Y"/>}
      #end add-point    
      DELETE FROM xmdd_t
       WHERE xmddent = g_enterprise AND
         xmdddocno = ps_keys_bak[1] AND xmddseq = ps_keys_bak[2] AND xmddseq1 = ps_keys_bak[3] AND xmddseq2 = ps_keys_bak[4]
      #add-point:delete_b段刪除中
      {<point name="delete_b.m_delete2"/>}
      #end add-point    
      IF SQLCA.sqlcode THEN
         CALL cl_err("xmdd_t",SQLCA.sqlcode,0)
      END IF
      #add-point:delete_b段刪除後
      {<point name="delete_b.a_delete2"/>}
      #end add-point    
   END IF
 
   LET ls_group = "'3',"
   #判斷是否是同一群組的table
   IF ls_group.getIndexOf(ps_page,1) > 0 THEN
      #add-point:delete_b段刪除前
      {<point name="delete_b.b_delete3" mark="Y"/>}
      #end add-point    
      DELETE FROM xmja_t
       WHERE xmjaent = g_enterprise AND
         xmjadocno = ps_keys_bak[1] AND xmjaseq = ps_keys_bak[2]
      #add-point:delete_b段刪除中
      {<point name="delete_b.m_delete3"/>}
      #end add-point    
      IF SQLCA.sqlcode THEN
         CALL cl_err("xmja_t",SQLCA.sqlcode,0)
      END IF
      #add-point:delete_b段刪除後
      {<point name="delete_b.a_delete3"/>}
      #end add-point    
   END IF
 
   LET ls_group = "'4',"
   #判斷是否是同一群組的table
   IF ls_group.getIndexOf(ps_page,1) > 0 THEN
      #add-point:delete_b段刪除前
      {<point name="delete_b.b_delete4" mark="Y"/>}
      #end add-point    
      DELETE FROM xmdb_t
       WHERE xmdbent = g_enterprise AND
         xmdbdocno = ps_keys_bak[1] AND xmdb001 = ps_keys_bak[2]
      #add-point:delete_b段刪除中
      {<point name="delete_b.m_delete4"/>}
      #end add-point    
      IF SQLCA.sqlcode THEN
         CALL cl_err("xmdb_t",SQLCA.sqlcode,0)
      END IF
      #add-point:delete_b段刪除後
      {<point name="delete_b.a_delete4"/>}
      #end add-point    
   END IF
 
   LET ls_group = "'5',"
   #判斷是否是同一群組的table
   IF ls_group.getIndexOf(ps_page,1) > 0 THEN
      #add-point:delete_b段刪除前
      {<point name="delete_b.b_delete5" mark="Y"/>}
      #end add-point    
      DELETE FROM xrcd_t
       WHERE xrcdent = g_enterprise AND
         xrcddocno = ps_keys_bak[1] AND xrcdld = ps_keys_bak[2] AND xrcdseq = ps_keys_bak[3] AND xrcdseq2 = ps_keys_bak[4] AND xrcd007 = ps_keys_bak[5]
      #add-point:delete_b段刪除中
      {<point name="delete_b.m_delete5"/>}
      #end add-point    
      IF SQLCA.sqlcode THEN
         CALL cl_err("xrcd_t",SQLCA.sqlcode,0)
      END IF
      #add-point:delete_b段刪除後
      {<point name="delete_b.a_delete5"/>}
      #end add-point    
   END IF
 
 
   
 
   
   #add-point:delete_b段other
   {<point name="delete_b.other"/>}
   #end add-point  
   
END FUNCTION
]]>
  </section>
  <section id="adbt500.description" ver="1020" status="" src="s">
    <![CDATA[#+ Version..: T100-ERP-1.00.00(SD版次:3,PR版次:3) Build-000599
#+ 
#+ Filename...: adbt500
#+ Description: 分銷訂單維護作業
#+ Creator....: 02748(2014/05/02)
#+ Modifier...: 02748(2014/07/02)
#+ Buildtype..: 應用 t01 樣板自動產生
#+ 以上段落由子樣板a00產生
]]>
  </section>
  <section id="adbt500.detail_reproduce" ver="17" status="" src="s">
    <![CDATA[#+ 單身自動複製
PRIVATE FUNCTION adbt500_detail_reproduce()
   DEFINE ls_sql      STRING
   DEFINE ld_date     DATETIME YEAR TO SECOND
   DEFINE l_detail    RECORD LIKE xmdc_t.*
   DEFINE l_detail2    RECORD LIKE xmdd_t.*
 
   DEFINE l_detail3    RECORD LIKE xmja_t.*
 
   DEFINE l_detail4    RECORD LIKE xmdb_t.*
 
   DEFINE l_detail5    RECORD LIKE xrcd_t.*
 
 
 
   #add-point:delete段define
   {<point name="detail_reproduce.define"/>}
   #end add-point    
   
   CALL s_transaction_begin()
   
   LET ld_date = cl_get_current()
   
   DROP TABLE adbt500_detail
   
   #add-point:單身複製前1
   {<point name="detail_reproduce.body.table1.b_insert" mark="Y"/>}
   #end add-point
   
   #CREATE TEMP TABLE
   LET ls_sql = "CREATE GLOBAL TEMPORARY TABLE adbt500_detail AS ",
                "SELECT * FROM xmdc_t "
   PREPARE repro_tbl FROM ls_sql
   EXECUTE repro_tbl
   FREE repro_tbl
                
   #將符合條件的資料丟入TEMP TABLE
   INSERT INTO adbt500_detail SELECT * FROM xmdc_t 
                                         WHERE xmdcent = g_enterprise AND xmdcdocno = g_xmdadocno_t
 
   
   #將key修正為調整後   
   UPDATE adbt500_detail 
      #更新key欄位
      SET xmdcdocno = g_xmda_m.xmdadocno
 
      #更新共用欄位
      
                                       
  
   #將資料塞回原table   
   INSERT INTO xmdc_t SELECT * FROM adbt500_detail
   
   IF SQLCA.sqlcode THEN
      CALL cl_err("reproduce",SQLCA.sqlcode,1)
      RETURN
   END IF
   
   #add-point:單身複製中1
   {<point name="detail_reproduce.body.table1.m_insert"/>}
   #end add-point
   
   #刪除TEMP TABLE
   DROP TABLE adbt500_detail
   
   #add-point:單身複製後1
   {<point name="detail_reproduce.body.table1.a_insert"/>}
   #end add-point
 
   #add-point:單身複製前
   {<point name="detail_reproduce.body.table2.b_insert" mark="Y"/>}
   #end add-point
   
   #CREATE TEMP TABLE
   LET ls_sql = 
      "CREATE GLOBAL TEMPORARY TABLE adbt500_detail AS ",
      "SELECT * FROM xmdd_t "
   PREPARE repro_tbl2 FROM ls_sql
   EXECUTE repro_tbl2
   FREE repro_tbl2
      
   #將符合條件的資料丟入TEMP TABLE
   INSERT INTO adbt500_detail SELECT * FROM xmdd_t
                                         WHERE xmddent = g_enterprise AND xmdddocno = g_xmdadocno_t
 
 
   #將key修正為調整後   
   UPDATE adbt500_detail SET xmdddocno = g_xmda_m.xmdadocno
 
  
   #將資料塞回原table   
   INSERT INTO xmdd_t SELECT * FROM adbt500_detail
   
   #add-point:單身複製中
   {<point name="detail_reproduce.body.table2.m_insert"/>}
   #end add-point
   
   #刪除TEMP TABLE
   DROP TABLE adbt500_detail
   
   #add-point:單身複製後
   {<point name="detail_reproduce.body.table2.a_insert"/>}
   #end add-point
 
   #add-point:單身複製前
   {<point name="detail_reproduce.body.table3.b_insert" mark="Y"/>}
   #end add-point
   
   #CREATE TEMP TABLE
   LET ls_sql = 
      "CREATE GLOBAL TEMPORARY TABLE adbt500_detail AS ",
      "SELECT * FROM xmja_t "
   PREPARE repro_tbl3 FROM ls_sql
   EXECUTE repro_tbl3
   FREE repro_tbl3
      
   #將符合條件的資料丟入TEMP TABLE
   INSERT INTO adbt500_detail SELECT * FROM xmja_t
                                         WHERE xmjaent = g_enterprise AND xmjadocno = g_xmdadocno_t
 
 
   #將key修正為調整後   
   UPDATE adbt500_detail SET xmjadocno = g_xmda_m.xmdadocno
 
  
   #將資料塞回原table   
   INSERT INTO xmja_t SELECT * FROM adbt500_detail
   
   #add-point:單身複製中
   {<point name="detail_reproduce.body.table3.m_insert"/>}
   #end add-point
   
   #刪除TEMP TABLE
   DROP TABLE adbt500_detail
   
   #add-point:單身複製後
   {<point name="detail_reproduce.body.table3.a_insert"/>}
   #end add-point
 
   #add-point:單身複製前
   {<point name="detail_reproduce.body.table4.b_insert" mark="Y"/>}
   #end add-point
   
   #CREATE TEMP TABLE
   LET ls_sql = 
      "CREATE GLOBAL TEMPORARY TABLE adbt500_detail AS ",
      "SELECT * FROM xmdb_t "
   PREPARE repro_tbl4 FROM ls_sql
   EXECUTE repro_tbl4
   FREE repro_tbl4
      
   #將符合條件的資料丟入TEMP TABLE
   INSERT INTO adbt500_detail SELECT * FROM xmdb_t
                                         WHERE xmdbent = g_enterprise AND xmdbdocno = g_xmdadocno_t
 
 
   #將key修正為調整後   
   UPDATE adbt500_detail SET xmdbdocno = g_xmda_m.xmdadocno
 
  
   #將資料塞回原table   
   INSERT INTO xmdb_t SELECT * FROM adbt500_detail
   
   #add-point:單身複製中
   {<point name="detail_reproduce.body.table4.m_insert"/>}
   #end add-point
   
   #刪除TEMP TABLE
   DROP TABLE adbt500_detail
   
   #add-point:單身複製後
   {<point name="detail_reproduce.body.table4.a_insert"/>}
   #end add-point
 
   #add-point:單身複製前
   {<point name="detail_reproduce.body.table5.b_insert" mark="Y"/>}
   #end add-point
   
   #CREATE TEMP TABLE
   LET ls_sql = 
      "CREATE GLOBAL TEMPORARY TABLE adbt500_detail AS ",
      "SELECT * FROM xrcd_t "
   PREPARE repro_tbl5 FROM ls_sql
   EXECUTE repro_tbl5
   FREE repro_tbl5
      
   #將符合條件的資料丟入TEMP TABLE
   INSERT INTO adbt500_detail SELECT * FROM xrcd_t
                                         WHERE xrcdent = g_enterprise AND xrcddocno = g_xmdadocno_t
 
 
   #將key修正為調整後   
   UPDATE adbt500_detail SET xrcddocno = g_xmda_m.xmdadocno
 
  
   #將資料塞回原table   
   INSERT INTO xrcd_t SELECT * FROM adbt500_detail
   
   #add-point:單身複製中
   {<point name="detail_reproduce.body.table5.m_insert"/>}
   #end add-point
   
   #刪除TEMP TABLE
   DROP TABLE adbt500_detail
   
   #add-point:單身複製後
   {<point name="detail_reproduce.body.table5.a_insert"/>}
   #end add-point
 
 
   
 
   
   #多語言複製段落
   
   
   CALL s_transaction_end('Y','0')
   
   #已新增完, 調整資料內容(修改時使用)
   LET g_xmdadocno_t = g_xmda_m.xmdadocno
 
   
   DROP TABLE adbt500_detail
   
END FUNCTION
]]>
  </section>
  <section id="adbt500.detail_show" ver="4" status="" src="s">
    <![CDATA[#+ 第二階單身reference
PRIVATE FUNCTION adbt500_detail_show()
   #add-point:detail_show段define
   {<point name="detail_show.define"/>}
   #end add-point  
 
   #add-point:detail_show段之前
   {<point name="detail_show.before"/>}
   #end add-point
   
   #add-point:detail_show段之後
   {<point name="detail_show.after"/>}
   #end add-point
   
END FUNCTION
]]>
  </section>
  <section id="adbt500.fetch" ver="30" status="" src="s">
    <![CDATA[#+ 指定PK後抓取單頭其他資料
PRIVATE FUNCTION adbt500_fetch(p_flag)
   DEFINE p_flag     LIKE type_t.chr1
   DEFINE ls_msg     STRING
   #add-point:fetch段define
   {<point name="fetch.define"/>}
   #end add-point    
   
   IF g_browser_cnt = 0 THEN
      RETURN
   END IF
   
   CASE p_flag
      WHEN 'F' LET g_current_idx = 1
      WHEN 'L' LET g_current_idx = g_header_cnt        
      WHEN 'P'
         IF g_current_idx > 1 THEN               
            LET g_current_idx = g_current_idx - 1
         END IF 
      WHEN 'N'
         IF g_current_idx < g_header_cnt THEN
            LET g_current_idx =  g_current_idx + 1
         END IF        
      WHEN '/'
         IF (NOT g_no_ask) THEN    
            CALL cl_set_act_visible("accept,cancel", TRUE)    
            CALL cl_getmsg('fetch',g_lang) RETURNING ls_msg
            LET INT_FLAG = 0
 
            PROMPT ls_msg CLIPPED,':' FOR g_jump
               #交談指令共用ACTION
               &include "common_action.4gl" 
            END PROMPT
 
            CALL cl_set_act_visible("accept,cancel", FALSE)    
            IF INT_FLAG THEN
                LET INT_FLAG = 0
                EXIT CASE  
            END IF           
         END IF
         
         IF g_jump > 0 AND g_jump <= g_browser.getLength() THEN
             LET g_current_idx = g_jump
         END IF
         
         LET g_no_ask = FALSE  
   END CASE 
   
   
   CALL g_curr_diag.setCurrentRow("s_browse", g_current_idx) #設定browse 索引
   
   LET g_detail_cnt = g_header_cnt                  
   
   #單身總筆數顯示
   #LET g_detail_idx = 1
   IF g_detail_cnt > 0 THEN
      #LET g_detail_idx = 1
      DISPLAY g_detail_idx TO FORMONLY.idx  
   ELSE
      LET g_detail_idx = 0
      DISPLAY ' ' TO FORMONLY.idx    
   END IF
   
   #瀏覽頁筆數顯示
   LET g_browser_idx = g_pagestart+g_current_idx-1
   DISPLAY g_browser_idx TO FORMONLY.b_index   #當下筆數
   DISPLAY g_browser_idx TO FORMONLY.h_index   #當下筆數
   
   CALL cl_navigator_setting( g_current_idx, g_browser_cnt )
   
   #代表沒有資料
   IF g_current_idx = 0 OR g_browser.getLength() = 0 THEN
      RETURN
   END IF
   
   #超出範圍
   IF g_current_idx > g_browser.getLength() THEN
      LET g_current_idx = g_browser.getLength()
   END IF
   
   LET g_xmda_m.xmdadocno = g_browser[g_current_idx].b_xmdadocno
 
   
   #重讀DB,因TEMP有不被更新特性
   EXECUTE adbt500_master_referesh USING g_xmda_m.xmdadocno INTO g_xmda_m.xmdasite,g_xmda_m.xmdadocdt, 
       g_xmda_m.xmdadocno,g_xmda_m.xmda001,g_xmda_m.xmda005,g_xmda_m.xmda202,g_xmda_m.xmda023,g_xmda_m.xmda004, 
       g_xmda_m.xmda200,g_xmda_m.xmda201,g_xmda_m.xmdastus,g_xmda_m.xmda007,g_xmda_m.xmda008,g_xmda_m.xmda021, 
       g_xmda_m.xmda022,g_xmda_m.xmda203,g_xmda_m.xmda027,g_xmda_m.xmda024,g_xmda_m.xmda002,g_xmda_m.xmda003, 
       g_xmda_m.xmdaunit,g_xmda_m.xmda204,g_xmda_m.xmda205,g_xmda_m.xmda032,g_xmda_m.xmda071,g_xmda_m.xmda025, 
       g_xmda_m.xmda026,g_xmda_m.xmda206,g_xmda_m.xmda207,g_xmda_m.xmda020,g_xmda_m.xmda036,g_xmda_m.xmda009, 
       g_xmda_m.xmda010,g_xmda_m.xmda015,g_xmda_m.xmda016,g_xmda_m.xmda011,g_xmda_m.xmda012,g_xmda_m.xmda013, 
       g_xmda_m.xmda035,g_xmda_m.xmda039,g_xmda_m.xmdaownid,g_xmda_m.xmdaowndp,g_xmda_m.xmdacrtid,g_xmda_m.xmdacrtdp, 
       g_xmda_m.xmdacrtdt,g_xmda_m.xmdamodid,g_xmda_m.xmdamoddt,g_xmda_m.xmdacnfid,g_xmda_m.xmdacnfdt, 
       g_xmda_m.xmda034,g_xmda_m.xmda006,g_xmda_m.xmda033,g_xmda_m.xmda017,g_xmda_m.xmda019,g_xmda_m.xmda018, 
       g_xmda_m.xmda044,g_xmda_m.xmda030,g_xmda_m.xmda031,g_xmda_m.xmda045,g_xmda_m.xmda046,g_xmda_m.xmda047, 
       g_xmda_m.xmda028,g_xmda_m.xmda041,g_xmda_m.xmda042,g_xmda_m.xmda043,g_xmda_m.xmdasite_desc,g_xmda_m.xmda202_desc, 
       g_xmda_m.xmda023_desc,g_xmda_m.xmda004_desc,g_xmda_m.xmda200_desc,g_xmda_m.xmda201_desc,g_xmda_m.xmda021_desc, 
       g_xmda_m.xmda022_desc,g_xmda_m.xmda203_desc,g_xmda_m.xmda027_desc,g_xmda_m.xmda024_desc,g_xmda_m.xmda002_desc, 
       g_xmda_m.xmda003_desc,g_xmda_m.xmdaunit_desc,g_xmda_m.xmda204_desc,g_xmda_m.xmda032_desc,g_xmda_m.xmda206_desc, 
       g_xmda_m.xmda207_desc,g_xmda_m.xmda020_desc,g_xmda_m.xmda036_desc,g_xmda_m.xmda009_desc,g_xmda_m.xmda010_desc, 
       g_xmda_m.xmda015_desc,g_xmda_m.xmdaownid_desc,g_xmda_m.xmdaowndp_desc,g_xmda_m.xmdacrtid_desc, 
       g_xmda_m.xmdacrtdp_desc,g_xmda_m.xmdamodid_desc,g_xmda_m.xmdacnfid_desc,g_xmda_m.xmda034_desc, 
       g_xmda_m.xmda017_desc,g_xmda_m.xmda018_desc
   IF SQLCA.sqlcode THEN
      CALL cl_err("xmda_t",SQLCA.sqlcode,1)
      INITIALIZE g_xmda_m.* TO NULL
      RETURN
   END IF
   
   #add-point:fetch段action控制
   {<point name="fetch.action_control"/>}
   #end add-point  
   
   
   
   #add-point:fetch結束前
   {<point name="fetch.after" />}
   #end add-point
   
   #保存單頭舊值
   LET g_xmda_m_t.* = g_xmda_m.*
   LET g_xmda_m_o.* = g_xmda_m.*
   
   #LET g_data_owner =       
   #LET g_data_group =   
   
   #重新顯示   
   CALL adbt500_show()
 
   #+ 此段落由子樣板a56產生
   #檢查此單據是否需顯示BPM簽核狀況按鈕 
   IF cl_bpm_chk() THEN
      CALL cl_set_act_visible("bpm_status",TRUE)
   ELSE
      CALL cl_set_act_visible("bpm_status",FALSE)
   END IF
 
 
 
END FUNCTION
]]>
  </section>
  <section id="adbt500.fill_chk" ver="12" status="" src="s">
    <![CDATA[#+ 單身填充確認
PRIVATE FUNCTION adbt500_fill_chk(ps_idx)
   DEFINE ps_idx        LIKE type_t.chr10
   #add-point:fill_chk段define
   {<point name="fill_chk.define"/>}
   #end add-point
   
   #add-point:fill_chk段before_chk
   {<point name="fill_chk.before_chk"/>}
   #end add-point
   
   #全部為1=1 or null時回傳true
   IF (cl_null(g_wc2_table1) OR g_wc2_table1.trim() = '1=1')  AND 
      (cl_null(g_wc2_table2) OR g_wc2_table2.trim() = '1=1')  AND 
      (cl_null(g_wc2_table3) OR g_wc2_table3.trim() = '1=1')  AND 
      (cl_null(g_wc2_table4) OR g_wc2_table4.trim() = '1=1')  AND 
      (cl_null(g_wc2_table5) OR g_wc2_table5.trim() = '1=1') THEN
      #add-point:fill_chk段other_chk
      {<point name="fill_chk.other_chk"/>}
      #end add-point
      RETURN TRUE
   END IF
   
   #第一單身
   IF ps_idx = 1 AND
      ((NOT cl_null(g_wc2_table1) AND g_wc2_table1.trim() <> '1=1')) THEN
      RETURN TRUE
   END IF
   
   #根據wc判定是否需要填充
   IF ps_idx = 2 AND
      ((NOT cl_null(g_wc2_table2) AND g_wc2_table2.trim() <> '1=1')) THEN
      RETURN TRUE
   END IF
 
   IF ps_idx = 3 AND
      ((NOT cl_null(g_wc2_table3) AND g_wc2_table3.trim() <> '1=1')) THEN
      RETURN TRUE
   END IF
 
   IF ps_idx = 4 AND
      ((NOT cl_null(g_wc2_table4) AND g_wc2_table4.trim() <> '1=1')) THEN
      RETURN TRUE
   END IF
 
   IF ps_idx = 5 AND
      ((NOT cl_null(g_wc2_table5) AND g_wc2_table5.trim() <> '1=1')) THEN
      RETURN TRUE
   END IF
 
 
 
 
   #add-point:fill_chk段after_chk
   {<point name="fill_chk.after_chk"/>}
   #end add-point
 
   RETURN FALSE
 
END FUNCTION
]]>
  </section>
  <section id="adbt500.filter" ver="8" status="" src="s">
    <![CDATA[#+ 此段落由子樣板a50產生
#+ filter過濾功能
PRIVATE FUNCTION adbt500_filter()
   #add-point:filter段define
   {<point name="filter.define"/>}
   #end add-point   
 
   #切換畫面
   IF NOT g_main_hidden THEN
      CALL gfrm_curr.setElementHidden("mainlayout",1)
      CALL gfrm_curr.setElementHidden("worksheet",0)
      LET g_main_hidden = 1
   END IF   
 
   LET INT_FLAG = 0
 
   LET g_qryparam.state = 'c'
 
   LET g_wc_filter_t = g_wc_filter.trim()
   LET g_wc_t = g_wc
 
   LET g_wc = cl_replace_str(g_wc, g_wc_filter_t, '')
 
   #使用DIALOG包住 單頭CONSTRUCT及單身CONSTRUCT
   DIALOG ATTRIBUTES(UNBUFFERED,FIELD ORDER FORM)
 
      #單頭
      CONSTRUCT g_wc_filter ON xmdadocno,xmdadocdt,xmda001,xmda002,xmda003,xmda004
                          FROM s_browse[1].b_xmdadocno,s_browse[1].b_xmdadocdt,s_browse[1].b_xmda001, 
                              s_browse[1].b_xmda002,s_browse[1].b_xmda003,s_browse[1].b_xmda004
 
         BEFORE CONSTRUCT
               DISPLAY adbt500_filter_parser('xmdadocno') TO s_browse[1].b_xmdadocno
            DISPLAY adbt500_filter_parser('xmdadocdt') TO s_browse[1].b_xmdadocdt
            DISPLAY adbt500_filter_parser('xmda001') TO s_browse[1].b_xmda001
            DISPLAY adbt500_filter_parser('xmda002') TO s_browse[1].b_xmda002
            DISPLAY adbt500_filter_parser('xmda003') TO s_browse[1].b_xmda003
            DISPLAY adbt500_filter_parser('xmda004') TO s_browse[1].b_xmda004
      
         #add-point:filter段cs_ctrl
         {<point name="filter.cs_ctrl"/>}
         #end add-point
      
      END CONSTRUCT
 
      #add-point:filter段add_cs
      {<point name="filter.add_cs"/>}
      #end add-point
 
      BEFORE DIALOG
         #add-point:filter段b_dialog
         {<point name="filter.b_dialog"/>}
         #end add-point  
      
      ON ACTION accept
         ACCEPT DIALOG
 
      ON ACTION cancel
         LET INT_FLAG = 1
         EXIT DIALOG 
 
      #交談指令共用ACTION
      &include "common_action.4gl" 
         CONTINUE DIALOG
   
   END DIALOG
 
   IF NOT INT_FLAG THEN
      LET g_wc_filter = "   AND   ", g_wc_filter, "   "
      LET g_wc = g_wc , g_wc_filter
   ELSE
      LET g_wc_filter = g_wc_filter_t
      LET g_wc = g_wc_t
   END IF
 
      CALL adbt500_filter_show('xmdadocno')
   CALL adbt500_filter_show('xmdadocdt')
   CALL adbt500_filter_show('xmda001')
   CALL adbt500_filter_show('xmda002')
   CALL adbt500_filter_show('xmda003')
   CALL adbt500_filter_show('xmda004')
 
END FUNCTION
]]>
  </section>
  <section id="adbt500.filter_parser" ver="2" status="" src="s">
    <![CDATA[#+ filter過濾功能
PRIVATE FUNCTION adbt500_filter_parser(ps_field)
   DEFINE ps_field   STRING
   DEFINE ls_tmp     STRING
   DEFINE li_tmp     LIKE type_t.num5
   DEFINE li_tmp2    LIKE type_t.num5
   DEFINE ls_var     STRING
   #add-point:filter段define
   {<point name="filter_parser.define"/>}
   #end add-point    
 
   #一般條件解析
   LET ls_tmp = ps_field, "='"
   LET li_tmp = g_wc_filter.getIndexOf(ls_tmp,1)
   IF li_tmp > 0 THEN
      LET li_tmp = ls_tmp.getLength() + li_tmp
      LET li_tmp2 = g_wc_filter.getIndexOf("'",li_tmp + 1) - 1
      LET ls_var = g_wc_filter.subString(li_tmp,li_tmp2)
   END IF
 
   #模糊條件解析
   LET ls_tmp = ps_field, " like '"
   LET li_tmp = g_wc_filter.getIndexOf(ls_tmp,1)
   IF li_tmp > 0 THEN
      LET li_tmp = ls_tmp.getLength() + li_tmp
      LET li_tmp2 = g_wc_filter.getIndexOf("'",li_tmp + 1) - 1
      LET ls_var = g_wc_filter.subString(li_tmp,li_tmp2)
      LET ls_var = cl_replace_str(ls_var,'%','*')
   END IF
 
   RETURN ls_var
 
END FUNCTION
]]>
  </section>
  <section id="adbt500.filter_show" ver="2" status="" src="s">
    <![CDATA[#+ 顯示過濾條件
PRIVATE FUNCTION adbt500_filter_show(ps_field)
   DEFINE ps_field         STRING
   DEFINE lnode_item       om.DomNode
   DEFINE ls_title         STRING
   DEFINE ls_name          STRING
   DEFINE ls_condition     STRING
 
   LET ls_name = "formonly.b_", ps_field
   LET lnode_item = gfrm_curr.findNode("TableColumn", ls_name)
   LET ls_title = lnode_item.getAttribute("text")
   IF ls_title.getIndexOf('※',1) > 0 THEN
      LEt ls_title = ls_title.subString(1,ls_title.getIndexOf('※',1)-1)
   END IF
 
   #顯示資料組合
   LET ls_condition = adbt500_filter_parser(ps_field)
   IF NOT cl_null(ls_condition) THEN
      LET ls_title = ls_title, '※', ls_condition, '※'
   END IF
 
   #將資料顯示回去
   CALL lnode_item.setAttribute("text",ls_title)
 
END FUNCTION
]]>
  </section>
  <section id="adbt500.global" ver="122" status="" src="s">
    <![CDATA[{<point name="global.memo" />}
        
IMPORT os
IMPORT util
IMPORT FGL lib_cl_dlg
#add-point:增加匯入項目
{<point name="global.import" />}
#end add-point
 
SCHEMA ds 
 
GLOBALS "../../cfg/top_global.inc"
 
#add-point:增加匯入變數檔
{<point name="global.inc" />}
#end add-point
 
#單頭 type 宣告
PRIVATE type type_g_xmda_m        RECORD
       xmdasite LIKE xmda_t.xmdasite, 
   xmdasite_desc LIKE type_t.chr80, 
   xmdadocdt LIKE xmda_t.xmdadocdt, 
   xmdadocno LIKE xmda_t.xmdadocno, 
   xmda001 LIKE xmda_t.xmda001, 
   xmdadocno_desc LIKE type_t.chr80, 
   xmda005 LIKE xmda_t.xmda005, 
   xmda202 LIKE xmda_t.xmda202, 
   xmda202_desc LIKE type_t.chr80, 
   xmda023 LIKE xmda_t.xmda023, 
   xmda023_desc LIKE type_t.chr80, 
   xmda004 LIKE xmda_t.xmda004, 
   xmda004_desc LIKE type_t.chr80, 
   xmda200 LIKE xmda_t.xmda200, 
   xmda200_desc LIKE type_t.chr80, 
   xmda201 LIKE xmda_t.xmda201, 
   xmda201_desc LIKE type_t.chr80, 
   xmdastus LIKE xmda_t.xmdastus, 
   xmda007 LIKE xmda_t.xmda007, 
   xmda008 LIKE xmda_t.xmda008, 
   xmda021 LIKE xmda_t.xmda021, 
   xmda021_desc LIKE type_t.chr80, 
   xmda022 LIKE xmda_t.xmda022, 
   xmda022_desc LIKE type_t.chr80, 
   xmda203 LIKE xmda_t.xmda203, 
   xmda203_desc LIKE type_t.chr80, 
   xmda027 LIKE xmda_t.xmda027, 
   xmda027_desc LIKE type_t.chr80, 
   xmda024 LIKE xmda_t.xmda024, 
   xmda024_desc LIKE type_t.chr80, 
   xmda002 LIKE xmda_t.xmda002, 
   xmda002_desc LIKE type_t.chr80, 
   xmda003 LIKE xmda_t.xmda003, 
   xmda003_desc LIKE type_t.chr80, 
   xmdaunit LIKE xmda_t.xmdaunit, 
   xmdaunit_desc LIKE type_t.chr80, 
   xmda204 LIKE xmda_t.xmda204, 
   xmda204_desc LIKE type_t.chr80, 
   xmda205 LIKE xmda_t.xmda205, 
   xmda032 LIKE xmda_t.xmda032, 
   xmda032_desc LIKE type_t.chr80, 
   xmda071 LIKE xmda_t.xmda071, 
   xmda025 LIKE xmda_t.xmda025, 
   xmda025_desc LIKE type_t.chr80, 
   oofb017 LIKE type_t.chr80, 
   xmda026 LIKE xmda_t.xmda026, 
   xmda026_desc LIKE type_t.chr80, 
   oofb017_1 LIKE type_t.chr80, 
   xmda206 LIKE xmda_t.xmda206, 
   xmda206_desc LIKE type_t.chr80, 
   xmda207 LIKE xmda_t.xmda207, 
   xmda207_desc LIKE type_t.chr80, 
   xmda020 LIKE xmda_t.xmda020, 
   xmda020_desc LIKE type_t.chr80, 
   xmda036 LIKE xmda_t.xmda036, 
   xmda036_desc LIKE type_t.chr80, 
   xmda009 LIKE xmda_t.xmda009, 
   xmda009_desc LIKE type_t.chr80, 
   xmda010 LIKE xmda_t.xmda010, 
   xmda010_desc LIKE type_t.chr80, 
   xmda015 LIKE xmda_t.xmda015, 
   xmda015_desc LIKE type_t.chr80, 
   xmda016 LIKE xmda_t.xmda016, 
   xmda011 LIKE xmda_t.xmda011, 
   xmda011_desc LIKE type_t.chr80, 
   xmda012 LIKE xmda_t.xmda012, 
   xmda013 LIKE xmda_t.xmda013, 
   xmda035 LIKE xmda_t.xmda035, 
   xmda035_desc LIKE type_t.chr80, 
   isaf011 LIKE type_t.chr80, 
   xmda039 LIKE xmda_t.xmda039, 
   xmdaownid LIKE xmda_t.xmdaownid, 
   xmdaownid_desc LIKE type_t.chr80, 
   xmdaowndp LIKE xmda_t.xmdaowndp, 
   xmdaowndp_desc LIKE type_t.chr80, 
   xmdacrtid LIKE xmda_t.xmdacrtid, 
   xmdacrtid_desc LIKE type_t.chr80, 
   xmdacrtdp LIKE xmda_t.xmdacrtdp, 
   xmdacrtdp_desc LIKE type_t.chr80, 
   xmdacrtdt DATETIME YEAR TO SECOND, 
   xmdamodid LIKE xmda_t.xmdamodid, 
   xmdamodid_desc LIKE type_t.chr80, 
   xmdamoddt DATETIME YEAR TO SECOND, 
   xmdacnfid LIKE xmda_t.xmdacnfid, 
   xmdacnfid_desc LIKE type_t.chr80, 
   xmdacnfdt DATETIME YEAR TO SECOND, 
   xmda034 LIKE xmda_t.xmda034, 
   xmda034_desc LIKE type_t.chr80, 
   xmda006 LIKE xmda_t.xmda006, 
   xmda033 LIKE xmda_t.xmda033, 
   xmda017 LIKE xmda_t.xmda017, 
   xmda017_desc LIKE type_t.chr80, 
   xmda019 LIKE xmda_t.xmda019, 
   xmda018 LIKE xmda_t.xmda018, 
   xmda018_desc LIKE type_t.chr80, 
   xmda044 LIKE xmda_t.xmda044, 
   xmda030 LIKE xmda_t.xmda030, 
   xmda031 LIKE xmda_t.xmda031, 
   xmda045 LIKE xmda_t.xmda045, 
   xmda046 LIKE xmda_t.xmda046, 
   xmda047 LIKE xmda_t.xmda047, 
   xmda028 LIKE xmda_t.xmda028, 
   xmda041 LIKE xmda_t.xmda041, 
   xmda042 LIKE xmda_t.xmda042, 
   xmda043 LIKE xmda_t.xmda043
       END RECORD
 
#單身 type 宣告
PRIVATE TYPE type_g_xmdc_d        RECORD
       xmdcsite LIKE xmdc_t.xmdcsite, 
   xmdcseq LIKE xmdc_t.xmdcseq, 
   xmdc027 LIKE xmdc_t.xmdc027, 
   xmdc001 LIKE xmdc_t.xmdc001, 
   xmdc001_desc LIKE type_t.chr500, 
   imaal004 LIKE type_t.chr80, 
   xmdc002 LIKE xmdc_t.xmdc002, 
   xmdc004 LIKE xmdc_t.xmdc004, 
   xmdc004_desc LIKE type_t.chr500, 
   xmdc005 LIKE xmdc_t.xmdc005, 
   xmdc006 LIKE xmdc_t.xmdc006, 
   xmdc006_desc LIKE type_t.chr500, 
   xmdc007 LIKE xmdc_t.xmdc007, 
   xmdc008 LIKE xmdc_t.xmdc008, 
   xmdc008_desc LIKE type_t.chr500, 
   xmdc009 LIKE xmdc_t.xmdc009, 
   xmdc024 LIKE xmdc_t.xmdc024, 
   xmdc012 LIKE xmdc_t.xmdc012, 
   xmdc013 LIKE xmdc_t.xmdc013, 
   xmdc045 LIKE xmdc_t.xmdc045, 
   xmdc010 LIKE xmdc_t.xmdc010, 
   xmdc010_desc LIKE type_t.chr500, 
   xmdc011 LIKE xmdc_t.xmdc011, 
   xmdc015 LIKE xmdc_t.xmdc015, 
   xmdc016 LIKE xmdc_t.xmdc016, 
   xmdc016_desc LIKE type_t.chr80, 
   xmdc017 LIKE xmdc_t.xmdc017, 
   xmdc046 LIKE xmdc_t.xmdc046, 
   xmdc047 LIKE xmdc_t.xmdc047, 
   xmdc048 LIKE xmdc_t.xmdc048, 
   xmdc023 LIKE xmdc_t.xmdc023, 
   xmdc019 LIKE xmdc_t.xmdc019, 
   xmdc020 LIKE xmdc_t.xmdc020, 
   xmdc021 LIKE xmdc_t.xmdc021, 
   xmdc022 LIKE xmdc_t.xmdc022, 
   xmdc051 LIKE xmdc_t.xmdc051, 
   xmdcunit LIKE xmdc_t.xmdcunit, 
   xmdcunit_desc LIKE type_t.chr500, 
   xmdcorga LIKE xmdc_t.xmdcorga, 
   xmdcorga_desc LIKE type_t.chr500, 
   xmdc052 LIKE xmdc_t.xmdc052, 
   xmdc049 LIKE xmdc_t.xmdc049, 
   xmdc049_desc LIKE type_t.chr500, 
   xmdc053 LIKE xmdc_t.xmdc053, 
   xmdc053_desc LIKE type_t.chr500, 
   xmdc050 LIKE xmdc_t.xmdc050
       END RECORD
PRIVATE TYPE type_g_xmdc3_d RECORD
       xmdddocno LIKE xmdd_t.xmdddocno, 
   xmddseq LIKE xmdd_t.xmddseq, 
   xmddseq1 LIKE xmdd_t.xmddseq1, 
   xmdd229 LIKE xmdd_t.xmdd229, 
   xmdd003 LIKE xmdd_t.xmdd003, 
   xmdd001 LIKE xmdd_t.xmdd001, 
   xmdd001_desc LIKE type_t.chr500, 
   xmdd001_desc_desc LIKE type_t.chr500, 
   xmdd002 LIKE xmdd_t.xmdd002, 
   xmdd200 LIKE xmdd_t.xmdd200, 
   xmdd200_desc LIKE type_t.chr500, 
   xmdd004 LIKE xmdd_t.xmdd004, 
   xmdd004_desc LIKE type_t.chr500, 
   xmdd005 LIKE xmdd_t.xmdd005, 
   xmdd011 LIKE xmdd_t.xmdd011, 
   xmdd012 LIKE xmdd_t.xmdd012, 
   xmdc012 LIKE xmdc_t.xmdc012, 
   xmdc013 LIKE xmdc_t.xmdc013, 
   xmddseq2 LIKE xmdd_t.xmddseq2, 
   xmdd006 LIKE xmdd_t.xmdd006, 
   xmdd201 LIKE xmdd_t.xmdd201, 
   xmdd201_desc LIKE type_t.chr500, 
   xmdd202 LIKE xmdd_t.xmdd202, 
   xmdd024 LIKE xmdd_t.xmdd024, 
   xmdd024_desc LIKE type_t.chr500, 
   xmdd025 LIKE xmdd_t.xmdd025, 
   xmdd026 LIKE xmdd_t.xmdd026, 
   xmdd026_desc LIKE type_t.chr500, 
   xmdd027 LIKE xmdd_t.xmdd027, 
   xmdd203 LIKE xmdd_t.xmdd203, 
   xmdd204 LIKE xmdd_t.xmdd204, 
   xmdd205 LIKE xmdd_t.xmdd205, 
   xmdd206 LIKE xmdd_t.xmdd206, 
   xmdd029 LIKE xmdd_t.xmdd029, 
   xmdd028 LIKE xmdd_t.xmdd028, 
   xmdd019 LIKE xmdd_t.xmdd019, 
   xmdd019_desc LIKE type_t.chr80, 
   xmdd030 LIKE xmdd_t.xmdd030, 
   xmdd207 LIKE xmdd_t.xmdd207, 
   xmdd207_desc LIKE type_t.chr500, 
   xmddunit LIKE xmdd_t.xmddunit, 
   xmddunit_desc LIKE type_t.chr500, 
   xmdd210 LIKE xmdd_t.xmdd210, 
   xmdd210_desc LIKE type_t.chr500, 
   xmdd212 LIKE xmdd_t.xmdd212, 
   xmdd213 LIKE xmdd_t.xmdd213, 
   xmdd213_desc LIKE type_t.chr500, 
   xmdd214 LIKE xmdd_t.xmdd214, 
   xmdd214_desc LIKE type_t.chr500, 
   xmdd215 LIKE xmdd_t.xmdd215, 
   xmdd031 LIKE xmdd_t.xmdd031, 
   xmdd014 LIKE xmdd_t.xmdd014, 
   xmdd015 LIKE xmdd_t.xmdd015, 
   xmdd016 LIKE xmdd_t.xmdd016, 
   xmdd017 LIKE xmdd_t.xmdd017, 
   xmdd221 LIKE xmdd_t.xmdd221, 
   xmddsite LIKE xmdd_t.xmddsite, 
   xmddsite_desc LIKE type_t.chr500, 
   xmdd218 LIKE xmdd_t.xmdd218, 
   xmdd218_desc LIKE type_t.chr500, 
   xmdd219 LIKE xmdd_t.xmdd219, 
   xmdd219_desc LIKE type_t.chr500, 
   xmdd220 LIKE xmdd_t.xmdd220, 
   xmdd220_desc LIKE type_t.chr500, 
   xmdd222 LIKE xmdd_t.xmdd222, 
   xmdd222_desc LIKE type_t.chr500, 
   xmdd223 LIKE xmdd_t.xmdd223, 
   xmdd223_desc LIKE type_t.chr500, 
   xmdd224 LIKE xmdd_t.xmdd224, 
   xmdd224_desc LIKE type_t.chr500, 
   xmddorga LIKE xmdd_t.xmddorga, 
   xmddorga_desc LIKE type_t.chr500, 
   xmdd226 LIKE xmdd_t.xmdd226, 
   xmdd227 LIKE xmdd_t.xmdd227, 
   xmdd227_desc LIKE type_t.chr500, 
   xmdd228 LIKE xmdd_t.xmdd228, 
   xmdd228_desc LIKE type_t.chr500, 
   xmdd013 LIKE xmdd_t.xmdd013, 
   xmdd009 LIKE xmdd_t.xmdd009, 
   xmdd018 LIKE xmdd_t.xmdd018, 
   xmdd020 LIKE xmdd_t.xmdd020, 
   xmdd021 LIKE xmdd_t.xmdd021, 
   xmdd022 LIKE xmdd_t.xmdd022, 
   xmdd022_desc LIKE type_t.chr500, 
   xmdd023 LIKE xmdd_t.xmdd023
       END RECORD
PRIVATE TYPE type_g_xmdc4_d RECORD
       xmjaunit LIKE xmja_t.xmjaunit, 
   xmjaseq LIKE xmja_t.xmjaseq, 
   xmjasite LIKE xmja_t.xmjasite, 
   xmjasite_desc LIKE type_t.chr500, 
   xmja001 LIKE xmja_t.xmja001, 
   xmja002 LIKE xmja_t.xmja002, 
   xmja003 LIKE xmja_t.xmja003, 
   xmja003_desc LIKE type_t.chr500, 
   xmja003_desc_desc LIKE type_t.chr500, 
   xmja033 LIKE xmja_t.xmja033, 
   xmja004 LIKE xmja_t.xmja004, 
   xmja005 LIKE xmja_t.xmja005, 
   xmja005_desc LIKE type_t.chr500, 
   xmja006 LIKE xmja_t.xmja006, 
   xmja006_desc LIKE type_t.chr80, 
   xmja007 LIKE xmja_t.xmja007, 
   xmja011 LIKE xmja_t.xmja011, 
   xmja011_desc LIKE type_t.chr500, 
   xmja012 LIKE xmja_t.xmja012, 
   xmja013 LIKE xmja_t.xmja013, 
   xmja013_desc LIKE type_t.chr500, 
   xmja014 LIKE xmja_t.xmja014, 
   xmja015 LIKE xmja_t.xmja015, 
   xmja015_desc LIKE type_t.chr500, 
   xmja016 LIKE xmja_t.xmja016, 
   xmja017 LIKE xmja_t.xmja017, 
   xmja017_desc LIKE type_t.chr500, 
   xmja018 LIKE xmja_t.xmja018, 
   xmja008 LIKE xmja_t.xmja008, 
   xmja009 LIKE xmja_t.xmja009, 
   xmja010 LIKE xmja_t.xmja010, 
   xmja022 LIKE xmja_t.xmja022, 
   xmja019 LIKE xmja_t.xmja019, 
   xmja020 LIKE xmja_t.xmja020, 
   xmja021 LIKE xmja_t.xmja021, 
   xmja024 LIKE xmja_t.xmja024, 
   xmja024_desc LIKE type_t.chr500, 
   xmja025 LIKE xmja_t.xmja025, 
   xmja026 LIKE xmja_t.xmja026, 
   xmja026_desc LIKE type_t.chr80, 
   xmja027 LIKE xmja_t.xmja027, 
   xmja027_desc LIKE type_t.chr500, 
   xmja028 LIKE xmja_t.xmja028, 
   xmja029 LIKE xmja_t.xmja029, 
   xmja030 LIKE xmja_t.xmja030, 
   xmja031 LIKE xmja_t.xmja031, 
   xmja032 LIKE xmja_t.xmja032, 
   xmja034 LIKE xmja_t.xmja034
       END RECORD
PRIVATE TYPE type_g_xmdc5_d RECORD
       xmdbsite LIKE xmdb_t.xmdbsite, 
   xmdb001 LIKE xmdb_t.xmdb001, 
   xmdb002 LIKE xmdb_t.xmdb002, 
   xmdb002_desc LIKE type_t.chr500, 
   xmdb003 LIKE xmdb_t.xmdb003, 
   xmdb004 LIKE xmdb_t.xmdb004, 
   xmdb005 LIKE xmdb_t.xmdb005, 
   xmdb006 LIKE xmdb_t.xmdb006, 
   xmdb007 LIKE xmdb_t.xmdb007, 
   xmdb008 LIKE xmdb_t.xmdb008, 
   xmdb009 LIKE xmdb_t.xmdb009
       END RECORD
PRIVATE TYPE type_g_xmdc6_d RECORD
       xrcdseq LIKE xrcd_t.xrcdseq, 
   xrcdld LIKE xrcd_t.xrcdld, 
   imay0031 LIKE type_t.chr80, 
   imaa0011 LIKE type_t.chr80, 
   imaa0011_desc LIKE type_t.chr500, 
   imaa0011_desc_desc LIKE type_t.chr500, 
   xrcd002 LIKE xrcd_t.xrcd002, 
   xrcd002_desc LIKE type_t.chr500, 
   xrcdseq2 LIKE xrcd_t.xrcdseq2, 
   xrcd007 LIKE xrcd_t.xrcd007, 
   xrcd003 LIKE xrcd_t.xrcd003, 
   xrcd006 LIKE xrcd_t.xrcd006, 
   xrcd004 LIKE xrcd_t.xrcd004, 
   xrcd104 LIKE xrcd_t.xrcd104
       END RECORD
 
 
#模組變數(Module Variables)
DEFINE g_xmda_m          type_g_xmda_m
DEFINE g_xmda_m_t        type_g_xmda_m
DEFINE g_xmda_m_o        type_g_xmda_m
 
   DEFINE g_xmdadocno_t LIKE xmda_t.xmdadocno
 
 
DEFINE g_xmdc_d          DYNAMIC ARRAY OF type_g_xmdc_d
DEFINE g_xmdc_d_t        type_g_xmdc_d
DEFINE g_xmdc_d_o        type_g_xmdc_d
DEFINE g_xmdc3_d   DYNAMIC ARRAY OF type_g_xmdc3_d
DEFINE g_xmdc3_d_t type_g_xmdc3_d
DEFINE g_xmdc3_d_o type_g_xmdc3_d
DEFINE g_xmdc4_d   DYNAMIC ARRAY OF type_g_xmdc4_d
DEFINE g_xmdc4_d_t type_g_xmdc4_d
DEFINE g_xmdc4_d_o type_g_xmdc4_d
DEFINE g_xmdc5_d   DYNAMIC ARRAY OF type_g_xmdc5_d
DEFINE g_xmdc5_d_t type_g_xmdc5_d
DEFINE g_xmdc5_d_o type_g_xmdc5_d
DEFINE g_xmdc6_d   DYNAMIC ARRAY OF type_g_xmdc6_d
DEFINE g_xmdc6_d_t type_g_xmdc6_d
DEFINE g_xmdc6_d_o type_g_xmdc6_d
 
 
DEFINE g_browser    DYNAMIC ARRAY OF RECORD    #資料瀏覽之欄位 
         b_statepic     LIKE type_t.chr50,
            b_xmdadocno LIKE xmda_t.xmdadocno,
      b_xmdadocdt LIKE xmda_t.xmdadocdt,
      b_xmda001 LIKE xmda_t.xmda001,
      b_xmda002 LIKE xmda_t.xmda002,
   b_xmda002_desc LIKE type_t.chr80,
      b_xmda003 LIKE xmda_t.xmda003,
   b_xmda003_desc LIKE type_t.chr80,
      b_xmda004 LIKE xmda_t.xmda004,
   b_xmda004_desc LIKE type_t.chr80
      END RECORD 
      
DEFINE g_browser_f  RECORD    #資料瀏覽之欄位 
         b_statepic     LIKE type_t.chr50,
            b_xmdadocno LIKE xmda_t.xmdadocno,
      b_xmdadocdt LIKE xmda_t.xmdadocdt,
      b_xmda001 LIKE xmda_t.xmda001,
      b_xmda002 LIKE xmda_t.xmda002,
   b_xmda002_desc LIKE type_t.chr80,
      b_xmda003 LIKE xmda_t.xmda003,
   b_xmda003_desc LIKE type_t.chr80,
      b_xmda004 LIKE xmda_t.xmda004,
   b_xmda004_desc LIKE type_t.chr80
      END RECORD 
      
 
DEFINE g_wc                  STRING
DEFINE g_wc_t                STRING
DEFINE g_wc2                 STRING                          #單身CONSTRUCT結果
DEFINE g_wc2_table1          STRING
DEFINE g_wc2_table2   STRING
 
DEFINE g_wc2_table3   STRING
 
DEFINE g_wc2_table4   STRING
 
DEFINE g_wc2_table5   STRING
 
 
 
DEFINE g_wc_filter           STRING
DEFINE g_wc_filter_t         STRING
 
DEFINE g_sql                 STRING
DEFINE g_forupd_sql          STRING
DEFINE g_cnt                 LIKE type_t.num10
DEFINE g_current_idx         LIKE type_t.num10     
DEFINE g_jump                LIKE type_t.num10        
DEFINE g_no_ask              LIKE type_t.num5        
DEFINE g_rec_b               LIKE type_t.num5           
DEFINE l_ac                  LIKE type_t.num5    
DEFINE g_curr_diag           ui.Dialog                     #Current Dialog
    
DEFINE g_pagestart           LIKE type_t.num5           
DEFINE gwin_curr             ui.Window                     #Current Window
DEFINE gfrm_curr             ui.Form                       #Current Form
DEFINE g_page_action         STRING                        #page action
DEFINE g_header_hidden       LIKE type_t.num5              #隱藏單頭
DEFINE g_worksheet_hidden    LIKE type_t.num5              #隱藏工作Panel
DEFINE g_page                STRING                        #第幾頁
DEFINE g_state               STRING       
 
DEFINE g_detail_cnt          LIKE type_t.num5              #單身總筆數
DEFINE g_detail_idx          LIKE type_t.num5              #單身目前所在筆數
DEFINE g_detail_idx2         LIKE type_t.num5              #單身2目前所在筆數
DEFINE g_browser_cnt         LIKE type_t.num5              #Browser總筆數
DEFINE g_browser_idx         LIKE type_t.num5              #Browser目前所在筆數
DEFINE g_temp_idx            LIKE type_t.num5              #Browser目前所在筆數(暫存用)
 
DEFINE g_searchcol           STRING                        #查詢欄位代碼
DEFINE g_searchstr           STRING                        #查詢欄位字串
DEFINE g_order               STRING                        #查詢排序欄位
                                                        
DEFINE g_current_row         LIKE type_t.num5              #Browser所在筆數
DEFINE g_current_sw          BOOLEAN                       #Browser所在筆數用開關
DEFINE g_current_page        LIKE type_t.num5              #目前所在頁數
DEFINE g_insert              LIKE type_t.chr5              #是否導到其他page
 
DEFINE g_ref_fields          DYNAMIC ARRAY OF VARCHAR(500) #ap_ref用陣列
DEFINE g_ref_vars            DYNAMIC ARRAY OF VARCHAR(500) #ap_ref用陣列
DEFINE g_rtn_fields          DYNAMIC ARRAY OF VARCHAR(500) #ap_ref用陣列
DEFINE gs_keys               DYNAMIC ARRAY OF VARCHAR(500) #同步資料用陣列
DEFINE gs_keys_bak           DYNAMIC ARRAY OF VARCHAR(500) #同步資料用陣列
DEFINE g_bfill               LIKE type_t.chr5              #是否刷新單身
DEFINE g_error_show          LIKE type_t.num5              #
 
DEFINE g_wc_frozen           STRING                        #凍結欄位使用
DEFINE g_chk                 BOOLEAN                       #助記碼判斷用
DEFINE g_aw                  STRING                        #確定當下點擊的單身
DEFINE g_default             BOOLEAN                       #是否有外部參數查詢
DEFINE g_log1                STRING                        #log用
DEFINE g_log2                STRING                        #log用
DEFINE g_loc                 LIKE type_t.chr5              #判斷游標所在位置
 
#add-point:自定義模組變數(Module Variable)
{<point name="global.variable"/>}
#end add-point
 
#add-point:傳入參數說明(global.argv)
{<point name="global.argv"/>}
#end add-point
]]>
  </section>
  <section id="adbt500.idx_chk" ver="15" status="" src="s">
    <![CDATA[#+ 單身筆數變更
PRIVATE FUNCTION adbt500_idx_chk()
   #add-point:idx_chk段define
   {<point name="idx_chk.define"/>}
   #end add-point  
   
   IF g_current_page = 1 THEN
      LET g_detail_idx = g_curr_diag.getCurrentRow("s_detail1")
      IF g_detail_idx > g_xmdc_d.getLength() THEN
         LET g_detail_idx = g_xmdc_d.getLength()
      END IF
      IF g_detail_idx = 0 AND g_xmdc_d.getLength() <> 0 THEN
         LET g_detail_idx = 1
      END IF
      DISPLAY g_detail_idx TO FORMONLY.idx
      DISPLAY g_xmdc_d.getLength() TO FORMONLY.cnt
   END IF
   
   IF g_current_page = 2 THEN
      LET g_detail_idx = g_curr_diag.getCurrentRow("s_detail3")
      IF g_detail_idx > g_xmdc3_d.getLength() THEN
         LET g_detail_idx = g_xmdc3_d.getLength()
      END IF
      IF g_detail_idx = 0 AND g_xmdc3_d.getLength() <> 0 THEN
         LET g_detail_idx = 1
      END IF
      DISPLAY g_detail_idx TO FORMONLY.idx
      DISPLAY g_xmdc3_d.getLength() TO FORMONLY.cnt
   END IF
   IF g_current_page = 3 THEN
      LET g_detail_idx = g_curr_diag.getCurrentRow("s_detail4")
      IF g_detail_idx > g_xmdc4_d.getLength() THEN
         LET g_detail_idx = g_xmdc4_d.getLength()
      END IF
      IF g_detail_idx = 0 AND g_xmdc4_d.getLength() <> 0 THEN
         LET g_detail_idx = 1
      END IF
      DISPLAY g_detail_idx TO FORMONLY.idx
      DISPLAY g_xmdc4_d.getLength() TO FORMONLY.cnt
   END IF
   IF g_current_page = 4 THEN
      LET g_detail_idx = g_curr_diag.getCurrentRow("s_detail5")
      IF g_detail_idx > g_xmdc5_d.getLength() THEN
         LET g_detail_idx = g_xmdc5_d.getLength()
      END IF
      IF g_detail_idx = 0 AND g_xmdc5_d.getLength() <> 0 THEN
         LET g_detail_idx = 1
      END IF
      DISPLAY g_detail_idx TO FORMONLY.idx
      DISPLAY g_xmdc5_d.getLength() TO FORMONLY.cnt
   END IF
   IF g_current_page = 5 THEN
      LET g_detail_idx = g_curr_diag.getCurrentRow("s_detail6")
      IF g_detail_idx > g_xmdc6_d.getLength() THEN
         LET g_detail_idx = g_xmdc6_d.getLength()
      END IF
      IF g_detail_idx = 0 AND g_xmdc6_d.getLength() <> 0 THEN
         LET g_detail_idx = 1
      END IF
      DISPLAY g_detail_idx TO FORMONLY.idx
      DISPLAY g_xmdc6_d.getLength() TO FORMONLY.cnt
   END IF
 
   
   #add-point:idx_chk段other
   {<point name="idx_chk.other"/>}
   #end add-point  
   
END FUNCTION
]]>
  </section>
  <section id="adbt500.init" ver="21" status="" src="s">
    <![CDATA[#+ 瀏覽頁簽資料初始化
PRIVATE FUNCTION adbt500_init()
   #add-point:init段define
   {<point name="init.define"/>}
   #end add-point    
   
   LET g_bfill       = "Y"
   LET g_detail_idx  = 1
   LET g_detail_idx2 = 1
   LET g_error_show  = 1
   LET l_ac = 1
      CALL cl_set_combo_scc_part('xmdastus','13','N,X,Y,A,D,R,W,C,H')
 
      CALL cl_set_combo_scc('xmda005','2063') 
   CALL cl_set_combo_scc('xmda007','2065') 
   CALL cl_set_combo_scc('xmda039','8321') 
   CALL cl_set_combo_scc('xmda006','2064') 
   CALL cl_set_combo_scc('xmdc045','2035') 
   CALL cl_set_combo_scc('xmdc019','2055') 
   CALL cl_set_combo_scc('xmdc020','2036') 
   CALL cl_set_combo_scc('xmdd003','2055') 
   CALL cl_set_combo_scc('xmdd017','2058') 
   CALL cl_set_combo_scc('xmdd009','2057') 
 
   LET gwin_curr = ui.Window.getCurrent()  #取得現行畫面
   LET gfrm_curr = gwin_curr.getForm()     #取出物件化後的畫面物件
 
   #add-point:畫面資料初始化
   {<point name="init.init"/>}
   #end add-point
   
   CALL adbt500_default_search()
    
END FUNCTION
]]>
  </section>
  <section id="adbt500.input" ver="92" status="" src="s">
    <![CDATA[#+ 資料輸入
PRIVATE FUNCTION adbt500_input(p_cmd)
   DEFINE  p_cmd                 LIKE type_t.chr1
   DEFINE  l_cmd_t               LIKE type_t.chr1
   DEFINE  l_cmd                 LIKE type_t.chr1
   DEFINE  l_n                   LIKE type_t.num5                #檢查重複用  
   DEFINE  l_cnt                 LIKE type_t.num5                #檢查重複用  
   DEFINE  l_lock_sw             LIKE type_t.chr1                #單身鎖住否  
   DEFINE  l_allow_insert        LIKE type_t.num5                #可新增否 
   DEFINE  l_allow_delete        LIKE type_t.num5                #可刪除否  
   DEFINE  l_count               LIKE type_t.num5
   DEFINE  l_i                   LIKE type_t.num5
   DEFINE  l_insert              BOOLEAN
   DEFINE  ls_return             STRING
   DEFINE  l_var_keys            DYNAMIC ARRAY OF STRING
   DEFINE  l_field_keys          DYNAMIC ARRAY OF STRING
   DEFINE  l_vars                DYNAMIC ARRAY OF STRING
   DEFINE  l_fields              DYNAMIC ARRAY OF STRING
   DEFINE  l_var_keys_bak        DYNAMIC ARRAY OF STRING
   DEFINE  lb_reproduce          BOOLEAN
   DEFINE  li_reproduce          LIKE type_t.num5
   DEFINE  li_reproduce_target   LIKE type_t.num5
   #add-point:input段define
   {<point name="input.define"/>}
   #end add-point  
 
   #先做狀態判定
   IF p_cmd = 'r' THEN
      LET l_cmd_t = 'r'
      LET p_cmd   = 'a'
   ELSE
      LET l_cmd_t = p_cmd
   END IF   
   
   #切換畫面
   IF g_main_hidden THEN
      CALL gfrm_curr.setElementHidden("mainlayout",0)
      CALL gfrm_curr.setElementHidden("worksheet",1)
      LET g_main_hidden = 0
   END IF
 
   CALL cl_set_head_visible("","YES")  
 
   LET l_insert = FALSE
   LET g_action_choice = ""
 
   #add-point:input段define_sql
   {<point name="input.define_sql" mark="Y"/>}
   #end add-point 
   LET g_forupd_sql = "SELECT xmdcsite,xmdcseq,xmdc027,xmdc001,xmdc002,xmdc004,xmdc005,xmdc006,xmdc007, 
       xmdc008,xmdc009,xmdc024,xmdc012,xmdc013,xmdc045,xmdc010,xmdc011,xmdc015,xmdc016,xmdc017,xmdc046, 
       xmdc047,xmdc048,xmdc023,xmdc019,xmdc020,xmdc021,xmdc022,xmdc051,xmdcunit,xmdcorga,xmdc052,xmdc049, 
       xmdc053,xmdc050 FROM xmdc_t WHERE xmdcent=? AND xmdcdocno=? AND xmdcseq=? FOR UPDATE"
   #add-point:input段define_sql
   {<point name="input.after_define_sql"/>}
   #end add-point 
   LET g_forupd_sql = cl_sql_forupd(g_forupd_sql)
   LET g_forupd_sql = cl_sql_add_mask(g_forupd_sql)              #遮蔽特定資料
   DECLARE adbt500_bcl CURSOR FROM g_forupd_sql
   
   #add-point:input段define_sql
   {<point name="input.define_sql2" mark="Y"/>}
   #end add-point    
   LET g_forupd_sql = "SELECT xmdddocno,xmddseq,xmddseq1,xmdd229,xmdd003,xmdd001,xmdd002,xmdd200,xmdd004, 
       xmdd005,xmdd011,xmdd012,xmddseq2,xmdd006,xmdd201,xmdd202,xmdd024,xmdd025,xmdd026,xmdd027,xmdd203, 
       xmdd204,xmdd205,xmdd206,xmdd029,xmdd028,xmdd019,xmdd030,xmdd207,xmddunit,xmdd210,xmdd212,xmdd213, 
       xmdd214,xmdd215,xmdd031,xmdd014,xmdd015,xmdd016,xmdd017,xmdd221,xmddsite,xmdd218,xmdd219,xmdd220, 
       xmdd222,xmdd223,xmdd224,xmddorga,xmdd226,xmdd227,xmdd228,xmdd013,xmdd009,xmdd018,xmdd020,xmdd021, 
       xmdd022,xmdd023 FROM xmdd_t WHERE xmddent=? AND xmdddocno=? AND xmddseq=? AND xmddseq1=? AND  
       xmddseq2=? FOR UPDATE"
   #add-point:input段define_sql
   {<point name="input.after_define_sql2"/>}
   #end add-point
   LET g_forupd_sql = cl_sql_forupd(g_forupd_sql)
   LET g_forupd_sql = cl_sql_add_mask(g_forupd_sql)              #遮蔽特定資料
   DECLARE adbt500_bcl2 CURSOR FROM g_forupd_sql
 
   #add-point:input段define_sql
   {<point name="input.define_sql3" mark="Y"/>}
   #end add-point    
   LET g_forupd_sql = "SELECT xmjaunit,xmjaseq,xmjasite,xmja001,xmja002,xmja003,xmja033,xmja004,xmja005, 
       xmja006,xmja007,xmja011,xmja012,xmja013,xmja014,xmja015,xmja016,xmja017,xmja018,xmja008,xmja009, 
       xmja010,xmja022,xmja019,xmja020,xmja021,xmja024,xmja025,xmja026,xmja027,xmja028,xmja029,xmja030, 
       xmja031,xmja032,xmja034 FROM xmja_t WHERE xmjaent=? AND xmjadocno=? AND xmjaseq=? FOR UPDATE" 

   #add-point:input段define_sql
   {<point name="input.after_define_sql3"/>}
   #end add-point
   LET g_forupd_sql = cl_sql_forupd(g_forupd_sql)
   LET g_forupd_sql = cl_sql_add_mask(g_forupd_sql)              #遮蔽特定資料
   DECLARE adbt500_bcl3 CURSOR FROM g_forupd_sql
 
   #add-point:input段define_sql
   {<point name="input.define_sql4" mark="Y"/>}
   #end add-point    
   LET g_forupd_sql = "SELECT xmdbsite,xmdb001,xmdb002,xmdb003,xmdb004,xmdb005,xmdb006,xmdb007,xmdb008, 
       xmdb009 FROM xmdb_t WHERE xmdbent=? AND xmdbdocno=? AND xmdb001=? FOR UPDATE"
   #add-point:input段define_sql
   {<point name="input.after_define_sql4"/>}
   #end add-point
   LET g_forupd_sql = cl_sql_forupd(g_forupd_sql)
   LET g_forupd_sql = cl_sql_add_mask(g_forupd_sql)              #遮蔽特定資料
   DECLARE adbt500_bcl4 CURSOR FROM g_forupd_sql
 
   #add-point:input段define_sql
   {<point name="input.define_sql5" mark="Y"/>}
   #end add-point    
   LET g_forupd_sql = "SELECT xrcdseq,xrcdld,xrcd002,xrcdseq2,xrcd007,xrcd003,xrcd006,xrcd004,xrcd104  
       FROM xrcd_t WHERE xrcdent=? AND xrcddocno=? AND xrcdld=? AND xrcdseq=? AND xrcdseq2=? AND xrcd007=?  
       FOR UPDATE"
   #add-point:input段define_sql
   {<point name="input.after_define_sql5"/>}
   #end add-point
   LET g_forupd_sql = cl_sql_forupd(g_forupd_sql)
   LET g_forupd_sql = cl_sql_add_mask(g_forupd_sql)              #遮蔽特定資料
   DECLARE adbt500_bcl5 CURSOR FROM g_forupd_sql
 
 
   
 
 
   #add-point:input段define_sql
   {<point name="input.other_sql"/>}
   #end add-point 
 
   LET l_allow_insert = cl_auth_detail_input("insert")
   LET l_allow_delete = cl_auth_detail_input("delete")
   LET g_qryparam.state = 'i'
   
   #控制key欄位可否輸入
   CALL adbt500_set_entry(p_cmd)
   #add-point:set_entry後
   {<point name="input.after_set_entry"/>}
   #end add-point
   CALL adbt500_set_no_entry(p_cmd)
 
   DISPLAY BY NAME g_xmda_m.xmdasite,g_xmda_m.xmdadocdt,g_xmda_m.xmdadocno,g_xmda_m.xmda001,g_xmda_m.xmda005, 
       g_xmda_m.xmda202,g_xmda_m.xmda023,g_xmda_m.xmda004,g_xmda_m.xmda200,g_xmda_m.xmda201,g_xmda_m.xmdastus, 
       g_xmda_m.xmda007,g_xmda_m.xmda008,g_xmda_m.xmda021,g_xmda_m.xmda022,g_xmda_m.xmda203,g_xmda_m.xmda027, 
       g_xmda_m.xmda024,g_xmda_m.xmda002,g_xmda_m.xmda003,g_xmda_m.xmdaunit,g_xmda_m.xmda204,g_xmda_m.xmda205, 
       g_xmda_m.xmda071,g_xmda_m.xmda025,g_xmda_m.xmda026,g_xmda_m.xmda020,g_xmda_m.xmda036,g_xmda_m.xmda009, 
       g_xmda_m.xmda010,g_xmda_m.xmda015,g_xmda_m.xmda011,g_xmda_m.xmda035,g_xmda_m.xmda039,g_xmda_m.xmda034, 
       g_xmda_m.xmda006,g_xmda_m.xmda033,g_xmda_m.xmda017,g_xmda_m.xmda019,g_xmda_m.xmda018,g_xmda_m.xmda044, 
       g_xmda_m.xmda028
   
   LET lb_reproduce = FALSE
   
   #add-point:資料輸入前
   {<point name="input.before_input"/>}
   #end add-point
   
   DIALOG ATTRIBUTES(UNBUFFERED,FIELD ORDER FORM)
   
]]>
  </section>
  <section id="adbt500.input.body" ver="124" status="" src="s">
    <![CDATA[   
      #Page1 預設值產生於此處
      INPUT ARRAY g_xmdc_d FROM s_detail1.*
          ATTRIBUTE(COUNT = g_rec_b,MAXCOUNT = g_max_rec,WITHOUT DEFAULTS, 
                  INSERT ROW = FALSE, 
                  DELETE ROW = FALSE,
                  APPEND ROW = FALSE)
 
         #自訂ACTION(detail_input,page_1)
         
         
         BEFORE INPUT
            IF g_insert = 'Y' AND NOT cl_null(g_insert) THEN 
              CALL FGL_SET_ARR_CURR(g_xmdc_d.getLength()+1) 
              LET g_insert = 'N' 
           END IF 
 
            CALL adbt500_b_fill()
            LET g_rec_b = g_xmdc_d.getLength()
            #add-point:資料輸入前
            {<point name="input.d.before_input"/>}
            #end add-point
         
         BEFORE ROW
            #add-point:modify段before row2
            {<point name="input.body.before_row2"/>}
            #end add-point  
            LET l_insert = FALSE
            LET l_cmd = ''
            LET l_ac = ARR_CURR()
            LET g_detail_idx = l_ac
            
            LET l_lock_sw = 'N'            #DEFAULT
            LET l_n = ARR_COUNT()
            DISPLAY l_ac TO FORMONLY.idx
         
            CALL s_transaction_begin()
            OPEN adbt500_cl USING g_enterprise,g_xmda_m.xmdadocno
            IF STATUS THEN
               CALL cl_err("OPEN adbt500_cl:", STATUS, 1)
               CLOSE adbt500_cl
               CALL s_transaction_end('N','0')
               RETURN
            END IF
            
            LET g_rec_b = g_xmdc_d.getLength()
            
            IF g_rec_b >= l_ac 
               AND g_xmdc_d[l_ac].xmdcseq IS NOT NULL
 
            THEN
               LET l_cmd='u'
               LET g_xmdc_d_t.* = g_xmdc_d[l_ac].*  #BACKUP
               LET g_xmdc_d_o.* = g_xmdc_d[l_ac].*  #BACKUP
               CALL adbt500_set_entry_b(l_cmd)
               #add-point:modify段after_set_entry_b
               {<point name="input.body.after_set_entry_b"/>}
               #end add-point  
               CALL adbt500_set_no_entry_b(l_cmd)
               IF NOT adbt500_lock_b("xmdc_t","'1'") THEN
                  LET l_lock_sw='Y'
               ELSE
                  FETCH adbt500_bcl INTO g_xmdc_d[l_ac].xmdcsite,g_xmdc_d[l_ac].xmdcseq,g_xmdc_d[l_ac].xmdc027, 
                      g_xmdc_d[l_ac].xmdc001,g_xmdc_d[l_ac].xmdc002,g_xmdc_d[l_ac].xmdc004,g_xmdc_d[l_ac].xmdc005, 
                      g_xmdc_d[l_ac].xmdc006,g_xmdc_d[l_ac].xmdc007,g_xmdc_d[l_ac].xmdc008,g_xmdc_d[l_ac].xmdc009, 
                      g_xmdc_d[l_ac].xmdc024,g_xmdc_d[l_ac].xmdc012,g_xmdc_d[l_ac].xmdc013,g_xmdc_d[l_ac].xmdc045, 
                      g_xmdc_d[l_ac].xmdc010,g_xmdc_d[l_ac].xmdc011,g_xmdc_d[l_ac].xmdc015,g_xmdc_d[l_ac].xmdc016, 
                      g_xmdc_d[l_ac].xmdc017,g_xmdc_d[l_ac].xmdc046,g_xmdc_d[l_ac].xmdc047,g_xmdc_d[l_ac].xmdc048, 
                      g_xmdc_d[l_ac].xmdc023,g_xmdc_d[l_ac].xmdc019,g_xmdc_d[l_ac].xmdc020,g_xmdc_d[l_ac].xmdc021, 
                      g_xmdc_d[l_ac].xmdc022,g_xmdc_d[l_ac].xmdc051,g_xmdc_d[l_ac].xmdcunit,g_xmdc_d[l_ac].xmdcorga, 
                      g_xmdc_d[l_ac].xmdc052,g_xmdc_d[l_ac].xmdc049,g_xmdc_d[l_ac].xmdc053,g_xmdc_d[l_ac].xmdc050 

                  IF SQLCA.sqlcode THEN
                     CALL cl_err(g_xmdc_d_t.xmdcseq,SQLCA.sqlcode,1)
                     LET l_lock_sw = "Y"
                  END IF
                  
                  LET g_bfill = "N"
                  CALL adbt500_show()
                  LET g_bfill = "Y"
                  
                  CALL cl_show_fld_cont()
               END IF
            ELSE
               LET l_cmd='a'
            END IF
            #add-point:modify段before row
            {<point name="input.body.before_row"/>}
            #end add-point  
            #其他table資料備份(確定是否更改用)
            
            #其他table進行lock
            
        
         BEFORE INSERT
            
            LET l_insert = TRUE
            LET l_n = ARR_COUNT()
            LET l_cmd = 'a'
            INITIALIZE g_xmdc_d[l_ac].* TO NULL 
            INITIALIZE g_xmdc_d_t.* TO NULL 
            INITIALIZE g_xmdc_d_o.* TO NULL 
                  LET g_xmdc_d[l_ac].xmdc024 = "N"
      LET g_xmdc_d[l_ac].xmdc045 = "1"
      LET g_xmdc_d[l_ac].xmdc019 = "1"
      LET g_xmdc_d[l_ac].xmdc020 = "1"
      LET g_xmdc_d[l_ac].xmdc021 = "N"
      LET g_xmdc_d[l_ac].xmdc022 = "Y"
      LET g_xmdc_d[l_ac].xmdc052 = "Y"
 
            LET g_xmdc_d_t.* = g_xmdc_d[l_ac].*     #新輸入資料
            LET g_xmdc_d_o.* = g_xmdc_d[l_ac].*     #新輸入資料
            CALL cl_show_fld_cont()
            CALL adbt500_set_entry_b(l_cmd)
            #add-point:modify段after_set_entry_b
            {<point name="input.body.insert.after_set_entry_b"/>}
            #end add-point
            CALL adbt500_set_no_entry_b(l_cmd)
            IF lb_reproduce THEN
               LET lb_reproduce = FALSE
               LET g_xmdc_d[li_reproduce_target].* = g_xmdc_d[li_reproduce].*
 
               LET g_xmdc_d[li_reproduce_target].xmdcseq = NULL
 
            END IF
            #公用欄位給值(單身)
            
            
            #add-point:modify段before insert
            {<point name="input.body.before_insert"/>}
            #end add-point  
  
         AFTER INSERT
            LET l_insert = FALSE
            IF INT_FLAG THEN
               CALL cl_err('',9001,0)
               LET INT_FLAG = 0
               CANCEL INSERT
            END IF
               
            #add-point:單身新增
            {<point name="input.body.b_a_insert"/>}
            #end add-point
               
            LET l_count = 1  
            SELECT COUNT(*) INTO l_count FROM xmdc_t 
             WHERE xmdcent = g_enterprise AND xmdcdocno = g_xmda_m.xmdadocno
 
               AND xmdcseq = g_xmdc_d[l_ac].xmdcseq
 
                
            #資料未重複, 插入新增資料
            IF l_count = 0 THEN 
               #add-point:單身新增前
               {<point name="input.body.b_insert"/>}
               #end add-point
            
               #同步新增到同層的table
                              INITIALIZE gs_keys TO NULL 
               LET gs_keys[1] = g_xmda_m.xmdadocno
               LET gs_keys[2] = g_xmdc_d[g_detail_idx].xmdcseq
               CALL adbt500_insert_b('xmdc_t',gs_keys,"'1'")
                           
               #add-point:單身新增後
               {<point name="input.body.a_insert"/>}
               #end add-point
            ELSE    
               CALL cl_err('INSERT',"std-00006",1)
               INITIALIZE g_xmdc_d[l_ac].* TO NULL
               CALL s_transaction_end('N','0')
               CANCEL INSERT
            END IF
 
            IF SQLCA.SQLcode  THEN
               CALL cl_err("xmdc_t",SQLCA.sqlcode,1)  
               CALL s_transaction_end('N','0')                    
               CANCEL INSERT
            ELSE
               #先刷新資料
               #CALL adbt500_b_fill()
               #資料多語言用-增/改
               
               #add-point:input段-after_insert
               {<point name="input.body.a_insert2"/>}
               #end add-point
               CALL s_transaction_end('Y','0')
               ERROR 'INSERT O.K'
               LET g_rec_b = g_rec_b + 1
            END IF
              
         BEFORE DELETE                            #是否取消單身
            IF l_cmd = 'a' AND g_xmdc_d.getLength() < l_ac THEN
               CALL FGL_SET_ARR_CURR(l_ac-1)
               CALL g_xmdc_d.deleteElement(l_ac)
               NEXT FIELD xmdcseq
            END IF
         
            IF g_xmdc_d[l_ac].xmdcseq IS NOT NULL
 
               THEN 
               
               IF NOT cl_ask_del_detail() THEN
                  CANCEL DELETE
               END IF
               IF l_lock_sw = "Y" THEN
                  CALL cl_err("", -263, 1)
                  CANCEL DELETE
               END IF
               
               #add-point:單身刪除前
               {<point name="input.body.b_delete" mark="Y"/>}
               #end add-point 
               
               DELETE FROM xmdc_t
                WHERE xmdcent = g_enterprise AND xmdcdocno = g_xmda_m.xmdadocno AND
 
                      xmdcseq = g_xmdc_d_t.xmdcseq
 
                  
               #add-point:單身刪除中
               {<point name="input.body.m_delete"/>}
               #end add-point 
               
               IF SQLCA.sqlcode THEN
                  CALL cl_err("xmdc_t",SQLCA.sqlcode,1)
                  CALL s_transaction_end('N','0')
                  CANCEL DELETE   
               ELSE
                  LET g_rec_b = g_rec_b-1
                  
                  #add-point:單身刪除後
                  {<point name="input.body.a_delete"/>}
                  #end add-point
                  CALL s_transaction_end('Y','0')
               END IF 
               CLOSE adbt500_bcl
               LET l_count = g_xmdc_d.getLength()
            END IF 
            
                           INITIALIZE gs_keys TO NULL 
               LET gs_keys[1] = g_xmda_m.xmdadocno
               LET gs_keys[2] = g_xmdc_d[g_detail_idx].xmdcseq
 
              
         AFTER DELETE 
            #add-point:單身刪除後2
            {<point name="input.body.after_delete"/>}
            #end add-point
                           CALL adbt500_delete_b('xmdc_t',gs_keys,"'1'")
 
                  #此段落由子樣板a01產生
         BEFORE FIELD xmdcsite
            #add-point:BEFORE FIELD xmdcsite
            {<point name="input.b.page1.xmdcsite" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdcsite
            
            #add-point:AFTER FIELD xmdcsite
            {<point name="input.a.page1.xmdcsite" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE xmdcsite
            #add-point:ON CHANGE xmdcsite
            {<point name="input.g.page1.xmdcsite" />}
            #END add-point
 
 
                  #Ctrlp:input.c.page1.xmdcsite
         ON ACTION controlp INFIELD xmdcsite
            #add-point:ON ACTION controlp INFIELD xmdcsite
            {<point name="input.c.page1.xmdcsite" />}
            #END add-point
 
 
 
         ON ROW CHANGE
            IF INT_FLAG THEN
               CALL cl_err('',9001,0)
               LET INT_FLAG = 0
               LET g_xmdc_d[l_ac].* = g_xmdc_d_t.*
               CLOSE adbt500_bcl
               CALL s_transaction_end('N','0')
               EXIT DIALOG 
            END IF
              
            IF l_lock_sw = 'Y' THEN
               CALL cl_err(g_xmdc_d[l_ac].xmdcseq,-263,1)
               LET g_xmdc_d[l_ac].* = g_xmdc_d_t.*
            ELSE
            
               #add-point:單身修改前
               {<point name="input.body.b_update" mark="Y"/>}
               #end add-point
               
               #寫入修改者/修改日期資訊(單身)
               
      
               UPDATE xmdc_t SET (xmdcdocno,xmdcsite,xmdcseq,xmdc027,xmdc001,xmdc002,xmdc004,xmdc005, 
                   xmdc006,xmdc007,xmdc008,xmdc009,xmdc024,xmdc012,xmdc013,xmdc045,xmdc010,xmdc011,xmdc015, 
                   xmdc016,xmdc017,xmdc046,xmdc047,xmdc048,xmdc023,xmdc019,xmdc020,xmdc021,xmdc022,xmdc051, 
                   xmdcunit,xmdcorga,xmdc052,xmdc049,xmdc053,xmdc050) = (g_xmda_m.xmdadocno,g_xmdc_d[l_ac].xmdcsite, 
                   g_xmdc_d[l_ac].xmdcseq,g_xmdc_d[l_ac].xmdc027,g_xmdc_d[l_ac].xmdc001,g_xmdc_d[l_ac].xmdc002, 
                   g_xmdc_d[l_ac].xmdc004,g_xmdc_d[l_ac].xmdc005,g_xmdc_d[l_ac].xmdc006,g_xmdc_d[l_ac].xmdc007, 
                   g_xmdc_d[l_ac].xmdc008,g_xmdc_d[l_ac].xmdc009,g_xmdc_d[l_ac].xmdc024,g_xmdc_d[l_ac].xmdc012, 
                   g_xmdc_d[l_ac].xmdc013,g_xmdc_d[l_ac].xmdc045,g_xmdc_d[l_ac].xmdc010,g_xmdc_d[l_ac].xmdc011, 
                   g_xmdc_d[l_ac].xmdc015,g_xmdc_d[l_ac].xmdc016,g_xmdc_d[l_ac].xmdc017,g_xmdc_d[l_ac].xmdc046, 
                   g_xmdc_d[l_ac].xmdc047,g_xmdc_d[l_ac].xmdc048,g_xmdc_d[l_ac].xmdc023,g_xmdc_d[l_ac].xmdc019, 
                   g_xmdc_d[l_ac].xmdc020,g_xmdc_d[l_ac].xmdc021,g_xmdc_d[l_ac].xmdc022,g_xmdc_d[l_ac].xmdc051, 
                   g_xmdc_d[l_ac].xmdcunit,g_xmdc_d[l_ac].xmdcorga,g_xmdc_d[l_ac].xmdc052,g_xmdc_d[l_ac].xmdc049, 
                   g_xmdc_d[l_ac].xmdc053,g_xmdc_d[l_ac].xmdc050)
                WHERE xmdcent = g_enterprise AND xmdcdocno = g_xmda_m.xmdadocno 
 
                  AND xmdcseq = g_xmdc_d_t.xmdcseq #項次   
 
                  
               #add-point:單身修改中
               {<point name="input.body.m_update"/>}
               #end add-point
               CASE
                  WHEN SQLCA.sqlerrd[3] = 0  #更新不到的處理
                     CALL cl_err("xmdc_t","std-00009",1)
                     CALL s_transaction_end('N','0')
                     LET g_xmdc_d[l_ac].* = g_xmdc_d_t.*
                  WHEN SQLCA.sqlcode #其他錯誤
                     CALL cl_err("xmdc_t",SQLCA.sqlcode,1)
                     LET g_xmdc_d[l_ac].* = g_xmdc_d_t.*                     
                     CALL s_transaction_end('N','0')
                  OTHERWISE
                                    INITIALIZE gs_keys TO NULL 
               LET gs_keys[1] = g_xmda_m.xmdadocno
               LET gs_keys_bak[1] = g_xmdadocno_t
               LET gs_keys[2] = g_xmdc_d[g_detail_idx].xmdcseq
               LET gs_keys_bak[2] = g_xmdc_d_t.xmdcseq
               CALL adbt500_update_b('xmdc_t',gs_keys,gs_keys_bak,"'1'")
                     #資料多語言用-增/改
                     
               END CASE
               
			   #修改歷程記錄
               LET g_log1 = util.JSON.stringify(g_xmda_m),util.JSON.stringify(g_xmdc_d_t)
               LET g_log2 = util.JSON.stringify(g_xmda_m),util.JSON.stringify(g_xmdc_d[l_ac])
               IF NOT cl_log_modified_record(g_log1,g_log2) THEN 
                  CALL s_transaction_end('N','0')
               END IF
               
               #add-point:單身修改後
               {<point name="input.body.a_update"/>}
               #end add-point
 
            END IF
            
         AFTER ROW
            #add-point:單身after_row
            {<point name="input.body.after_row"/>}
            #end add-point
            CALL adbt500_unlock_b("xmdc_t","'1'")
            CALL s_transaction_end('Y','0')
            #其他table進行unlock
            #add-point:單身after_row2
            {<point name="input.body.after_row2"/>}
            #end add-point
              
         AFTER INPUT
            #add-point:input段after input 
            {<point name="input.body.after_input"/>}
            #end add-point 
 
         ON ACTION controlo    
            CALL FGL_SET_ARR_CURR(g_xmdc_d.getLength()+1)
            LET lb_reproduce = TRUE
            LET li_reproduce = l_ac
            LET li_reproduce_target = g_xmdc_d.getLength()+1
            
         #ON ACTION cancel
         #   LET INT_FLAG = 1
         #   LET g_detail_idx = 1
         #   EXIT DIALOG 
 
      END INPUT
      
      INPUT ARRAY g_xmdc4_d FROM s_detail4.*
         ATTRIBUTE(COUNT = g_rec_b,MAXCOUNT = g_max_rec,WITHOUT DEFAULTS, 
                 INSERT ROW = l_allow_insert, #此頁面insert功能由產生器控制, 手動之設定無效! 

                 DELETE ROW = l_allow_delete,
                 APPEND ROW = l_allow_insert)
                 
         #自訂ACTION(detail_input,page_3)
         
         
         BEFORE INPUT
            IF g_insert = 'Y' AND NOT cl_null(g_insert) THEN 
              CALL FGL_SET_ARR_CURR(g_xmdc4_d.getLength()+1) 
              LET g_insert = 'N' 
           END IF 
 
            CALL adbt500_b_fill()
            LET g_rec_b = g_xmdc4_d.getLength()
            #add-point:資料輸入前
            {<point name="input.body4.before_input"/>}
            #end add-point
            
         BEFORE INSERT
            
            LET l_insert = TRUE
            LET l_n = ARR_COUNT()
            LET l_cmd = 'a'
            INITIALIZE g_xmdc4_d[l_ac].* TO NULL 
            INITIALIZE g_xmdc4_d_t.* TO NULL 
            INITIALIZE g_xmdc4_d_o.* TO NULL 
                  LET g_xmdc4_d[l_ac].xmja030 = "N"
 
            LET g_xmdc4_d_t.* = g_xmdc4_d[l_ac].*     #新輸入資料
            LET g_xmdc4_d_o.* = g_xmdc4_d[l_ac].*     #新輸入資料
            CALL cl_show_fld_cont()
            CALL adbt500_set_entry_b(l_cmd)
            #add-point:modify段after_set_entry_b
            {<point name="input.body4.insert.after_set_entry_b"/>}
            #end add-point
            CALL adbt500_set_no_entry_b(l_cmd)
            IF lb_reproduce THEN
               LET lb_reproduce = FALSE
               LET g_xmdc4_d[li_reproduce_target].* = g_xmdc4_d[li_reproduce].*
 
               LET g_xmdc4_d[li_reproduce_target].xmjaseq = NULL
            END IF
            #公用欄位給值(單身3)
            
            
            #add-point:modify段before insert
            {<point name="input.body4.before_insert"/>}
            #end add-point  
            
         BEFORE ROW     
            #add-point:modify段before row2
            {<point name="input.body4.before_row2"/>}
            #end add-point  
            LET l_insert = FALSE
            LET l_cmd = ''
            LET l_ac = ARR_CURR()
            LET g_detail_idx = l_ac
              
            LET l_lock_sw = 'N'            #DEFAULT
            LET l_n = ARR_COUNT()
            DISPLAY l_ac TO FORMONLY.idx
         
            CALL s_transaction_begin()
            OPEN adbt500_cl USING g_enterprise,g_xmda_m.xmdadocno
            IF STATUS THEN
               CALL cl_err("OPEN adbt500_cl:", STATUS, 1)
               CLOSE adbt500_cl
               CALL s_transaction_end('N','0')
               RETURN
            END IF
            
            LET g_rec_b = g_xmdc4_d.getLength()
            
            IF g_rec_b >= l_ac 
               AND g_xmdc4_d[l_ac].xmjaseq IS NOT NULL
            THEN 
               LET l_cmd='u'
               LET g_xmdc4_d_t.* = g_xmdc4_d[l_ac].*  #BACKUP
               LET g_xmdc4_d_o.* = g_xmdc4_d[l_ac].*  #BACKUP
               CALL adbt500_set_entry_b(l_cmd)
               #add-point:modify段after_set_entry_b
               {<point name="input.body4.after_set_entry_b"/>}
               #end add-point  
               CALL adbt500_set_no_entry_b(l_cmd)
               IF NOT adbt500_lock_b("xmja_t","'3'") THEN
                  LET l_lock_sw='Y'
               ELSE
                  FETCH adbt500_bcl3 INTO g_xmdc4_d[l_ac].xmjaunit,g_xmdc4_d[l_ac].xmjaseq,g_xmdc4_d[l_ac].xmjasite, 
                      g_xmdc4_d[l_ac].xmja001,g_xmdc4_d[l_ac].xmja002,g_xmdc4_d[l_ac].xmja003,g_xmdc4_d[l_ac].xmja033, 
                      g_xmdc4_d[l_ac].xmja004,g_xmdc4_d[l_ac].xmja005,g_xmdc4_d[l_ac].xmja006,g_xmdc4_d[l_ac].xmja007, 
                      g_xmdc4_d[l_ac].xmja011,g_xmdc4_d[l_ac].xmja012,g_xmdc4_d[l_ac].xmja013,g_xmdc4_d[l_ac].xmja014, 
                      g_xmdc4_d[l_ac].xmja015,g_xmdc4_d[l_ac].xmja016,g_xmdc4_d[l_ac].xmja017,g_xmdc4_d[l_ac].xmja018, 
                      g_xmdc4_d[l_ac].xmja008,g_xmdc4_d[l_ac].xmja009,g_xmdc4_d[l_ac].xmja010,g_xmdc4_d[l_ac].xmja022, 
                      g_xmdc4_d[l_ac].xmja019,g_xmdc4_d[l_ac].xmja020,g_xmdc4_d[l_ac].xmja021,g_xmdc4_d[l_ac].xmja024, 
                      g_xmdc4_d[l_ac].xmja025,g_xmdc4_d[l_ac].xmja026,g_xmdc4_d[l_ac].xmja027,g_xmdc4_d[l_ac].xmja028, 
                      g_xmdc4_d[l_ac].xmja029,g_xmdc4_d[l_ac].xmja030,g_xmdc4_d[l_ac].xmja031,g_xmdc4_d[l_ac].xmja032, 
                      g_xmdc4_d[l_ac].xmja034
                  IF SQLCA.sqlcode THEN
                     CALL cl_err('',SQLCA.sqlcode,1)
                     LET l_lock_sw = "Y"
                  END IF
                  
                  LET g_bfill = "N"
                  CALL adbt500_show()
                  LET g_bfill = "Y"
                  
                  CALL cl_show_fld_cont()
               END IF
            ELSE
               LET l_cmd='a'
            END IF
            #add-point:modify段before row
            {<point name="input.body4.before_row"/>}
            #end add-point  
            #其他table資料備份(確定是否更改用)
            
            #其他table進行lock
            
            
         BEFORE DELETE                            #是否取消單身
            IF l_cmd = 'a' AND g_xmdc4_d.getLength() < l_ac THEN
               CALL FGL_SET_ARR_CURR(l_ac-1)
               CALL g_xmdc4_d.deleteElement(l_ac)
               NEXT FIELD xmjaseq
            END IF
         
            IF g_xmdc4_d[l_ac].xmjaseq IS NOT NULL
            THEN
               IF NOT cl_ask_del_detail() THEN
                  CANCEL DELETE
               END IF
               IF l_lock_sw = "Y" THEN
                  CALL cl_err("", -263, 1)
                  CANCEL DELETE
               END IF
               
               #add-point:單身3刪除前
               {<point name="input.body4.b_delete" mark="Y"/>}
               #end add-point    
               
               DELETE FROM xmja_t
                WHERE xmjaent = g_enterprise AND xmjadocno = g_xmda_m.xmdadocno AND
                      xmjaseq = g_xmdc4_d_t.xmjaseq
                  
               #add-point:單身3刪除中
               {<point name="input.body4.m_delete"/>}
               #end add-point    
                  
               IF SQLCA.sqlcode THEN
                  CALL cl_err("xmdc_t",SQLCA.sqlcode,1)
                  CALL s_transaction_end('N','0')
                  CANCEL DELETE   
               ELSE
                  LET g_rec_b = g_rec_b-1
                  
                  #add-point:單身3刪除後
                  {<point name="input.body4.a_delete"/>}
                  #end add-point
                  CALL s_transaction_end('Y','0')
               END IF 
               CLOSE adbt500_bcl
               LET l_count = g_xmdc_d.getLength()
            END IF 
            
                           INITIALIZE gs_keys TO NULL 
               LET gs_keys[1] = g_xmda_m.xmdadocno
               LET gs_keys[2] = g_xmdc4_d[g_detail_idx].xmjaseq
 
            
         AFTER DELETE 
            #add-point:單身AFTER DELETE 
            {<point name="input.body4.after_delete"/>}
            #end add-point
                           CALL adbt500_delete_b('xmja_t',gs_keys,"'3'")
 
         AFTER INSERT    
            LET l_insert = FALSE
            IF INT_FLAG THEN
               CALL cl_err('',9001,0)
               LET INT_FLAG = 0
               CANCEL INSERT
            END IF
               
            #add-point:單身3新增前
            {<point name="input.body4.b_a_insert"/>}
            #end add-point
               
            LET l_count = 1  
            SELECT COUNT(*) INTO l_count FROM xmja_t 
             WHERE xmjaent = g_enterprise AND xmjadocno = g_xmda_m.xmdadocno
               AND xmjaseq = g_xmdc4_d[l_ac].xmjaseq
                
            #資料未重複, 插入新增資料
            IF l_count = 0 THEN 
               #add-point:單身3新增前
               {<point name="input.body4.b_insert"/>}
               #end add-point
            
                              INITIALIZE gs_keys TO NULL 
               LET gs_keys[1] = g_xmda_m.xmdadocno
               LET gs_keys[2] = g_xmdc4_d[g_detail_idx].xmjaseq
               CALL adbt500_insert_b('xmja_t',gs_keys,"'3'")
                           
               #add-point:單身新增後3
               {<point name="input.body4.a_insert"/>}
               #end add-point
            ELSE    
               CALL cl_err('INSERT',"std-00006",1)
               INITIALIZE g_xmdc_d[l_ac].* TO NULL
               CALL s_transaction_end('N','0')
               CANCEL INSERT
            END IF
 
            IF SQLCA.SQLcode  THEN
               CALL cl_err("xmja_t",SQLCA.sqlcode,1)  
               CALL s_transaction_end('N','0')                    
               CANCEL INSERT
            ELSE
               #先刷新資料
               #CALL adbt500_b_fill()
               #資料多語言用-增/改
               
               #add-point:單身新增後
               {<point name="input.body4.after_insert"/>}
               #end add-point
               CALL s_transaction_end('Y','0')
               ERROR 'INSERT O.K'
               LET g_rec_b = g_rec_b + 1
            END IF
            
         ON ROW CHANGE 
            IF INT_FLAG THEN
               CALL cl_err('',9001,0)
               LET INT_FLAG = 0
               LET g_xmdc4_d[l_ac].* = g_xmdc4_d_t.*
               CLOSE adbt500_bcl3
               CALL s_transaction_end('N','0')
               EXIT DIALOG 
            END IF
            
            IF l_lock_sw = 'Y' THEN
               CALL cl_err('',-263,1)
               LET g_xmdc4_d[l_ac].* = g_xmdc4_d_t.*
            ELSE
               #add-point:單身page3修改前
               {<point name="input.body4.b_update" mark="Y"/>}
               #end add-point
               
               #寫入修改者/修改日期資訊(單身3)
               
               
               UPDATE xmja_t SET (xmjadocno,xmjaunit,xmjaseq,xmjasite,xmja001,xmja002,xmja003,xmja033, 
                   xmja004,xmja005,xmja006,xmja007,xmja011,xmja012,xmja013,xmja014,xmja015,xmja016,xmja017, 
                   xmja018,xmja008,xmja009,xmja010,xmja022,xmja019,xmja020,xmja021,xmja024,xmja025,xmja026, 
                   xmja027,xmja028,xmja029,xmja030,xmja031,xmja032,xmja034) = (g_xmda_m.xmdadocno,g_xmdc4_d[l_ac].xmjaunit, 
                   g_xmdc4_d[l_ac].xmjaseq,g_xmdc4_d[l_ac].xmjasite,g_xmdc4_d[l_ac].xmja001,g_xmdc4_d[l_ac].xmja002, 
                   g_xmdc4_d[l_ac].xmja003,g_xmdc4_d[l_ac].xmja033,g_xmdc4_d[l_ac].xmja004,g_xmdc4_d[l_ac].xmja005, 
                   g_xmdc4_d[l_ac].xmja006,g_xmdc4_d[l_ac].xmja007,g_xmdc4_d[l_ac].xmja011,g_xmdc4_d[l_ac].xmja012, 
                   g_xmdc4_d[l_ac].xmja013,g_xmdc4_d[l_ac].xmja014,g_xmdc4_d[l_ac].xmja015,g_xmdc4_d[l_ac].xmja016, 
                   g_xmdc4_d[l_ac].xmja017,g_xmdc4_d[l_ac].xmja018,g_xmdc4_d[l_ac].xmja008,g_xmdc4_d[l_ac].xmja009, 
                   g_xmdc4_d[l_ac].xmja010,g_xmdc4_d[l_ac].xmja022,g_xmdc4_d[l_ac].xmja019,g_xmdc4_d[l_ac].xmja020, 
                   g_xmdc4_d[l_ac].xmja021,g_xmdc4_d[l_ac].xmja024,g_xmdc4_d[l_ac].xmja025,g_xmdc4_d[l_ac].xmja026, 
                   g_xmdc4_d[l_ac].xmja027,g_xmdc4_d[l_ac].xmja028,g_xmdc4_d[l_ac].xmja029,g_xmdc4_d[l_ac].xmja030, 
                   g_xmdc4_d[l_ac].xmja031,g_xmdc4_d[l_ac].xmja032,g_xmdc4_d[l_ac].xmja034) #自訂欄位頁簽 

                WHERE xmjaent = g_enterprise AND xmjadocno = g_xmda_m.xmdadocno
                  AND xmjaseq = g_xmdc4_d_t.xmjaseq #項次 
                  
               #add-point:單身page3修改中
               {<point name="input.body4.m_update"/>}
               #end add-point
                  
               CASE
                  WHEN SQLCA.sqlerrd[3] = 0  #更新不到的處理
                     CALL cl_err("xmja_t","std-00009",1)
                     CALL s_transaction_end('N','0')
                     LET g_xmdc4_d[l_ac].* = g_xmdc4_d_t.*
                  WHEN SQLCA.sqlcode #其他錯誤
                     CALL cl_err("xmja_t",SQLCA.sqlcode,1)  
                     CALL s_transaction_end('N','0')
                     LET g_xmdc4_d[l_ac].* = g_xmdc4_d_t.*
                  OTHERWISE
                                    INITIALIZE gs_keys TO NULL 
               LET gs_keys[1] = g_xmda_m.xmdadocno
               LET gs_keys_bak[1] = g_xmdadocno_t
               LET gs_keys[2] = g_xmdc4_d[g_detail_idx].xmjaseq
               LET gs_keys_bak[2] = g_xmdc4_d_t.xmjaseq
               CALL adbt500_update_b('xmja_t',gs_keys,gs_keys_bak,"'3'")
                     #資料多語言用-增/改
                     
               END CASE
			   
               #修改歷程記錄
               LET g_log1 = util.JSON.stringify(g_xmda_m),util.JSON.stringify(g_xmdc4_d_t)
               LET g_log2 = util.JSON.stringify(g_xmda_m),util.JSON.stringify(g_xmdc4_d[l_ac])
               IF NOT cl_log_modified_record(g_log1,g_log2) THEN 
                  CALL s_transaction_end('N','0')
               END IF
               
               #add-point:單身page3修改後
               {<point name="input.body4.a_update"/>}
               #end add-point
            END IF
         
                  #此段落由子樣板a02產生
         AFTER FIELD xmjaseq
            #此段落由子樣板a15產生
            IF NOT cl_ap_chk_Range(g_xmdc4_d[l_ac].xmjaseq,"0.000","0","","","azz-00079",1) THEN
               NEXT FIELD xmjaseq
            END IF
 
 
            #add-point:AFTER FIELD xmjaseq
            {<point name="input.a.page4.xmjaseq" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmjaseq
            #add-point:BEFORE FIELD xmjaseq
            {<point name="input.b.page4.xmjaseq" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE xmjaseq
            #add-point:ON CHANGE xmjaseq
            {<point name="input.g.page4.xmjaseq" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmjasite
            
            #add-point:AFTER FIELD xmjasite
            {<point name="input.a.page4.xmjasite" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmjasite
            #add-point:BEFORE FIELD xmjasite
            {<point name="input.b.page4.xmjasite" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE xmjasite
            #add-point:ON CHANGE xmjasite
            {<point name="input.g.page4.xmjasite" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmja001
            #add-point:BEFORE FIELD xmja001
            {<point name="input.b.page4.xmja001" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmja001
            
            #add-point:AFTER FIELD xmja001
            {<point name="input.a.page4.xmja001" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE xmja001
            #add-point:ON CHANGE xmja001
            {<point name="input.g.page4.xmja001" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmja002
            
            #add-point:AFTER FIELD xmja002
            {<point name="input.a.page4.xmja002" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmja002
            #add-point:BEFORE FIELD xmja002
            {<point name="input.b.page4.xmja002" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE xmja002
            #add-point:ON CHANGE xmja002
            {<point name="input.g.page4.xmja002" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmja003
            
            #add-point:AFTER FIELD xmja003
            {<point name="input.a.page4.xmja003" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmja003
            #add-point:BEFORE FIELD xmja003
            {<point name="input.b.page4.xmja003" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE xmja003
            #add-point:ON CHANGE xmja003
            {<point name="input.g.page4.xmja003" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmja033
            
            #add-point:AFTER FIELD xmja033
            {<point name="input.a.page4.xmja033" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmja033
            #add-point:BEFORE FIELD xmja033
            {<point name="input.b.page4.xmja033" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE xmja033
            #add-point:ON CHANGE xmja033
            {<point name="input.g.page4.xmja033" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmja004
            #add-point:BEFORE FIELD xmja004
            {<point name="input.b.page4.xmja004" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmja004
            
            #add-point:AFTER FIELD xmja004
            {<point name="input.a.page4.xmja004" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE xmja004
            #add-point:ON CHANGE xmja004
            {<point name="input.g.page4.xmja004" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmja005
            
            #add-point:AFTER FIELD xmja005
            {<point name="input.a.page4.xmja005" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmja005
            #add-point:BEFORE FIELD xmja005
            {<point name="input.b.page4.xmja005" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE xmja005
            #add-point:ON CHANGE xmja005
            {<point name="input.g.page4.xmja005" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmja006
            
            #add-point:AFTER FIELD xmja006
            {<point name="input.a.page4.xmja006" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmja006
            #add-point:BEFORE FIELD xmja006
            {<point name="input.b.page4.xmja006" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE xmja006
            #add-point:ON CHANGE xmja006
            {<point name="input.g.page4.xmja006" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmja007
            #add-point:BEFORE FIELD xmja007
            {<point name="input.b.page4.xmja007" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmja007
            
            #add-point:AFTER FIELD xmja007
            {<point name="input.a.page4.xmja007" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE xmja007
            #add-point:ON CHANGE xmja007
            {<point name="input.g.page4.xmja007" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmja011
            
            #add-point:AFTER FIELD xmja011
            {<point name="input.a.page4.xmja011" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmja011
            #add-point:BEFORE FIELD xmja011
            {<point name="input.b.page4.xmja011" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE xmja011
            #add-point:ON CHANGE xmja011
            {<point name="input.g.page4.xmja011" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmja012
            #add-point:BEFORE FIELD xmja012
            {<point name="input.b.page4.xmja012" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmja012
            
            #add-point:AFTER FIELD xmja012
            {<point name="input.a.page4.xmja012" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE xmja012
            #add-point:ON CHANGE xmja012
            {<point name="input.g.page4.xmja012" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmja013
            
            #add-point:AFTER FIELD xmja013
            {<point name="input.a.page4.xmja013" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmja013
            #add-point:BEFORE FIELD xmja013
            {<point name="input.b.page4.xmja013" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE xmja013
            #add-point:ON CHANGE xmja013
            {<point name="input.g.page4.xmja013" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmja014
            #此段落由子樣板a15產生
            IF NOT cl_ap_chk_Range(g_xmdc4_d[l_ac].xmja014,"0.000","1","","","azz-00079",1) THEN
               NEXT FIELD xmja014
            END IF
 
 
            #add-point:AFTER FIELD xmja014
            {<point name="input.a.page4.xmja014" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmja014
            #add-point:BEFORE FIELD xmja014
            {<point name="input.b.page4.xmja014" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE xmja014
            #add-point:ON CHANGE xmja014
            {<point name="input.g.page4.xmja014" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmja015
            
            #add-point:AFTER FIELD xmja015
            {<point name="input.a.page4.xmja015" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmja015
            #add-point:BEFORE FIELD xmja015
            {<point name="input.b.page4.xmja015" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE xmja015
            #add-point:ON CHANGE xmja015
            {<point name="input.g.page4.xmja015" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmja016
            #此段落由子樣板a15產生
            IF NOT cl_ap_chk_Range(g_xmdc4_d[l_ac].xmja016,"0.000","0","","","azz-00079",1) THEN
               NEXT FIELD xmja016
            END IF
 
 
            #add-point:AFTER FIELD xmja016
            {<point name="input.a.page4.xmja016" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmja016
            #add-point:BEFORE FIELD xmja016
            {<point name="input.b.page4.xmja016" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE xmja016
            #add-point:ON CHANGE xmja016
            {<point name="input.g.page4.xmja016" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmja017
            
            #add-point:AFTER FIELD xmja017
            {<point name="input.a.page4.xmja017" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmja017
            #add-point:BEFORE FIELD xmja017
            {<point name="input.b.page4.xmja017" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE xmja017
            #add-point:ON CHANGE xmja017
            {<point name="input.g.page4.xmja017" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmja018
            #此段落由子樣板a15產生
            IF NOT cl_ap_chk_Range(g_xmdc4_d[l_ac].xmja018,"0.000","0","","","azz-00079",1) THEN
               NEXT FIELD xmja018
            END IF
 
 
            #add-point:AFTER FIELD xmja018
            {<point name="input.a.page4.xmja018" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmja018
            #add-point:BEFORE FIELD xmja018
            {<point name="input.b.page4.xmja018" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE xmja018
            #add-point:ON CHANGE xmja018
            {<point name="input.g.page4.xmja018" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmja008
            #此段落由子樣板a15產生
            IF NOT cl_ap_chk_Range(g_xmdc4_d[l_ac].xmja008,"0.000","0","","","azz-00079",1) THEN
               NEXT FIELD xmja008
            END IF
 
 
            #add-point:AFTER FIELD xmja008
            {<point name="input.a.page4.xmja008" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmja008
            #add-point:BEFORE FIELD xmja008
            {<point name="input.b.page4.xmja008" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE xmja008
            #add-point:ON CHANGE xmja008
            {<point name="input.g.page4.xmja008" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmja009
            #此段落由子樣板a15產生
            IF NOT cl_ap_chk_Range(g_xmdc4_d[l_ac].xmja009,"0.000","0","","","azz-00079",1) THEN
               NEXT FIELD xmja009
            END IF
 
 
            #add-point:AFTER FIELD xmja009
            {<point name="input.a.page4.xmja009" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmja009
            #add-point:BEFORE FIELD xmja009
            {<point name="input.b.page4.xmja009" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE xmja009
            #add-point:ON CHANGE xmja009
            {<point name="input.g.page4.xmja009" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmja010
            #此段落由子樣板a15產生
            IF NOT cl_ap_chk_Range(g_xmdc4_d[l_ac].xmja010,"0.000","0","","","azz-00079",1) THEN
               NEXT FIELD xmja010
            END IF
 
 
            #add-point:AFTER FIELD xmja010
            {<point name="input.a.page4.xmja010" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmja010
            #add-point:BEFORE FIELD xmja010
            {<point name="input.b.page4.xmja010" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE xmja010
            #add-point:ON CHANGE xmja010
            {<point name="input.g.page4.xmja010" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmja022
            #add-point:BEFORE FIELD xmja022
            {<point name="input.b.page4.xmja022" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmja022
            
            #add-point:AFTER FIELD xmja022
            {<point name="input.a.page4.xmja022" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE xmja022
            #add-point:ON CHANGE xmja022
            {<point name="input.g.page4.xmja022" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmja019
            #add-point:BEFORE FIELD xmja019
            {<point name="input.b.page4.xmja019" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmja019
            
            #add-point:AFTER FIELD xmja019
            {<point name="input.a.page4.xmja019" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE xmja019
            #add-point:ON CHANGE xmja019
            {<point name="input.g.page4.xmja019" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmja020
            #add-point:BEFORE FIELD xmja020
            {<point name="input.b.page4.xmja020" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmja020
            
            #add-point:AFTER FIELD xmja020
            {<point name="input.a.page4.xmja020" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE xmja020
            #add-point:ON CHANGE xmja020
            {<point name="input.g.page4.xmja020" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmja021
            #add-point:BEFORE FIELD xmja021
            {<point name="input.b.page4.xmja021" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmja021
            
            #add-point:AFTER FIELD xmja021
            {<point name="input.a.page4.xmja021" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE xmja021
            #add-point:ON CHANGE xmja021
            {<point name="input.g.page4.xmja021" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmja024
            
            #add-point:AFTER FIELD xmja024
            {<point name="input.a.page4.xmja024" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmja024
            #add-point:BEFORE FIELD xmja024
            {<point name="input.b.page4.xmja024" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE xmja024
            #add-point:ON CHANGE xmja024
            {<point name="input.g.page4.xmja024" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmja025
            #add-point:BEFORE FIELD xmja025
            {<point name="input.b.page4.xmja025" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmja025
            
            #add-point:AFTER FIELD xmja025
            {<point name="input.a.page4.xmja025" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE xmja025
            #add-point:ON CHANGE xmja025
            {<point name="input.g.page4.xmja025" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmja026
            
            #add-point:AFTER FIELD xmja026
            {<point name="input.a.page4.xmja026" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmja026
            #add-point:BEFORE FIELD xmja026
            {<point name="input.b.page4.xmja026" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE xmja026
            #add-point:ON CHANGE xmja026
            {<point name="input.g.page4.xmja026" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmja029
            #add-point:BEFORE FIELD xmja029
            {<point name="input.b.page4.xmja029" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmja029
            
            #add-point:AFTER FIELD xmja029
            {<point name="input.a.page4.xmja029" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE xmja029
            #add-point:ON CHANGE xmja029
            {<point name="input.g.page4.xmja029" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmja030
            #add-point:BEFORE FIELD xmja030
            {<point name="input.b.page4.xmja030" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmja030
            
            #add-point:AFTER FIELD xmja030
            {<point name="input.a.page4.xmja030" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE xmja030
            #add-point:ON CHANGE xmja030
            {<point name="input.g.page4.xmja030" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmja031
            #add-point:BEFORE FIELD xmja031
            {<point name="input.b.page4.xmja031" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmja031
            
            #add-point:AFTER FIELD xmja031
            {<point name="input.a.page4.xmja031" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE xmja031
            #add-point:ON CHANGE xmja031
            {<point name="input.g.page4.xmja031" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmja032
            #add-point:BEFORE FIELD xmja032
            {<point name="input.b.page4.xmja032" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmja032
            
            #add-point:AFTER FIELD xmja032
            {<point name="input.a.page4.xmja032" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE xmja032
            #add-point:ON CHANGE xmja032
            {<point name="input.g.page4.xmja032" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmja034
            #add-point:BEFORE FIELD xmja034
            {<point name="input.b.page4.xmja034" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmja034
            
            #add-point:AFTER FIELD xmja034
            {<point name="input.a.page4.xmja034" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE xmja034
            #add-point:ON CHANGE xmja034
            {<point name="input.g.page4.xmja034" />}
            #END add-point
 
 
                  #Ctrlp:input.c.page4.xmjaseq
         ON ACTION controlp INFIELD xmjaseq
            #add-point:ON ACTION controlp INFIELD xmjaseq
            {<point name="input.c.page4.xmjaseq" />}
            #END add-point
 
         #Ctrlp:input.c.page4.xmjasite
         ON ACTION controlp INFIELD xmjasite
            #add-point:ON ACTION controlp INFIELD xmjasite
            {<point name="input.c.page4.xmjasite" />}
            #END add-point
 
         #Ctrlp:input.c.page4.xmja001
         ON ACTION controlp INFIELD xmja001
            #add-point:ON ACTION controlp INFIELD xmja001
            {<point name="input.c.page4.xmja001" />}
            #END add-point
 
         #Ctrlp:input.c.page4.xmja002
         ON ACTION controlp INFIELD xmja002
            #add-point:ON ACTION controlp INFIELD xmja002
            {<point name="input.c.page4.xmja002" />}
            #END add-point
 
         #Ctrlp:input.c.page4.xmja003
         ON ACTION controlp INFIELD xmja003
            #add-point:ON ACTION controlp INFIELD xmja003
            {<point name="input.c.page4.xmja003" />}
            #END add-point
 
         #Ctrlp:input.c.page4.xmja033
         ON ACTION controlp INFIELD xmja033
            #add-point:ON ACTION controlp INFIELD xmja033
            {<point name="input.c.page4.xmja033" />}
            #END add-point
 
         #Ctrlp:input.c.page4.xmja004
         ON ACTION controlp INFIELD xmja004
            #add-point:ON ACTION controlp INFIELD xmja004
            {<point name="input.c.page4.xmja004" />}
            #END add-point
 
         #Ctrlp:input.c.page4.xmja005
         ON ACTION controlp INFIELD xmja005
            #add-point:ON ACTION controlp INFIELD xmja005
            {<point name="input.c.page4.xmja005" />}
            #END add-point
 
         #Ctrlp:input.c.page4.xmja006
         ON ACTION controlp INFIELD xmja006
            #add-point:ON ACTION controlp INFIELD xmja006
            {<point name="input.c.page4.xmja006" />}
            #END add-point
 
         #Ctrlp:input.c.page4.xmja007
         ON ACTION controlp INFIELD xmja007
            #add-point:ON ACTION controlp INFIELD xmja007
            {<point name="input.c.page4.xmja007" />}
            #END add-point
 
         #Ctrlp:input.c.page4.xmja011
         ON ACTION controlp INFIELD xmja011
            #add-point:ON ACTION controlp INFIELD xmja011
            {<point name="input.c.page4.xmja011" />}
            #END add-point
 
         #Ctrlp:input.c.page4.xmja012
         ON ACTION controlp INFIELD xmja012
            #add-point:ON ACTION controlp INFIELD xmja012
            {<point name="input.c.page4.xmja012" />}
            #END add-point
 
         #Ctrlp:input.c.page4.xmja013
         ON ACTION controlp INFIELD xmja013
            #add-point:ON ACTION controlp INFIELD xmja013
            {<point name="input.c.page4.xmja013" />}
            #END add-point
 
         #Ctrlp:input.c.page4.xmja014
         ON ACTION controlp INFIELD xmja014
            #add-point:ON ACTION controlp INFIELD xmja014
            {<point name="input.c.page4.xmja014" />}
            #END add-point
 
         #Ctrlp:input.c.page4.xmja015
         ON ACTION controlp INFIELD xmja015
            #add-point:ON ACTION controlp INFIELD xmja015
            {<point name="input.c.page4.xmja015" />}
            #END add-point
 
         #Ctrlp:input.c.page4.xmja016
         ON ACTION controlp INFIELD xmja016
            #add-point:ON ACTION controlp INFIELD xmja016
            {<point name="input.c.page4.xmja016" />}
            #END add-point
 
         #Ctrlp:input.c.page4.xmja017
         ON ACTION controlp INFIELD xmja017
            #add-point:ON ACTION controlp INFIELD xmja017
            {<point name="input.c.page4.xmja017" />}
            #END add-point
 
         #Ctrlp:input.c.page4.xmja018
         ON ACTION controlp INFIELD xmja018
            #add-point:ON ACTION controlp INFIELD xmja018
            {<point name="input.c.page4.xmja018" />}
            #END add-point
 
         #Ctrlp:input.c.page4.xmja008
         ON ACTION controlp INFIELD xmja008
            #add-point:ON ACTION controlp INFIELD xmja008
            {<point name="input.c.page4.xmja008" />}
            #END add-point
 
         #Ctrlp:input.c.page4.xmja009
         ON ACTION controlp INFIELD xmja009
            #add-point:ON ACTION controlp INFIELD xmja009
            {<point name="input.c.page4.xmja009" />}
            #END add-point
 
         #Ctrlp:input.c.page4.xmja010
         ON ACTION controlp INFIELD xmja010
            #add-point:ON ACTION controlp INFIELD xmja010
            {<point name="input.c.page4.xmja010" />}
            #END add-point
 
         #Ctrlp:input.c.page4.xmja022
         ON ACTION controlp INFIELD xmja022
            #add-point:ON ACTION controlp INFIELD xmja022
            {<point name="input.c.page4.xmja022" />}
            #END add-point
 
         #Ctrlp:input.c.page4.xmja019
         ON ACTION controlp INFIELD xmja019
            #add-point:ON ACTION controlp INFIELD xmja019
            {<point name="input.c.page4.xmja019" />}
            #END add-point
 
         #Ctrlp:input.c.page4.xmja020
         ON ACTION controlp INFIELD xmja020
            #add-point:ON ACTION controlp INFIELD xmja020
            {<point name="input.c.page4.xmja020" />}
            #END add-point
 
         #Ctrlp:input.c.page4.xmja021
         ON ACTION controlp INFIELD xmja021
            #add-point:ON ACTION controlp INFIELD xmja021
            {<point name="input.c.page4.xmja021" />}
            #END add-point
 
         #Ctrlp:input.c.page4.xmja024
         ON ACTION controlp INFIELD xmja024
            #add-point:ON ACTION controlp INFIELD xmja024
            {<point name="input.c.page4.xmja024" />}
            #END add-point
 
         #Ctrlp:input.c.page4.xmja025
         ON ACTION controlp INFIELD xmja025
            #add-point:ON ACTION controlp INFIELD xmja025
            {<point name="input.c.page4.xmja025" />}
            #END add-point
 
         #Ctrlp:input.c.page4.xmja026
         ON ACTION controlp INFIELD xmja026
            #add-point:ON ACTION controlp INFIELD xmja026
            {<point name="input.c.page4.xmja026" />}
            #END add-point
 
         #Ctrlp:input.c.page4.xmja029
         ON ACTION controlp INFIELD xmja029
            #add-point:ON ACTION controlp INFIELD xmja029
            {<point name="input.c.page4.xmja029" />}
            #END add-point
 
         #Ctrlp:input.c.page4.xmja030
         ON ACTION controlp INFIELD xmja030
            #add-point:ON ACTION controlp INFIELD xmja030
            {<point name="input.c.page4.xmja030" />}
            #END add-point
 
         #Ctrlp:input.c.page4.xmja031
         ON ACTION controlp INFIELD xmja031
            #add-point:ON ACTION controlp INFIELD xmja031
            {<point name="input.c.page4.xmja031" />}
            #END add-point
 
         #Ctrlp:input.c.page4.xmja032
         ON ACTION controlp INFIELD xmja032
            #add-point:ON ACTION controlp INFIELD xmja032
            {<point name="input.c.page4.xmja032" />}
            #END add-point
 
         #Ctrlp:input.c.page4.xmja034
         ON ACTION controlp INFIELD xmja034
            #add-point:ON ACTION controlp INFIELD xmja034
            {<point name="input.c.page4.xmja034" />}
            #END add-point
 
 
 
         AFTER ROW
            #add-point:單身page3 after_row
            {<point name="input.body4.after_row"/>}
            #end add-point
            LET l_ac = ARR_CURR()
            IF INT_FLAG THEN
               CALL cl_err('',9001,0)
               LET INT_FLAG = 0
               IF l_cmd = 'u' THEN
                  LET g_xmdc4_d[l_ac].* = g_xmdc4_d_t.*
               END IF
               CLOSE adbt500_bcl3
               CALL s_transaction_end('N','0')
               EXIT DIALOG 
            END IF
            
            #其他table進行unlock
            
            CALL adbt500_unlock_b("xmja_t","'3'")
            CALL s_transaction_end('Y','0')
            #add-point:單身page3 after_row2
            {<point name="input.body4.after_row2"/>}
            #end add-point
 
         AFTER INPUT
            #add-point:input段after input 
            {<point name="input.body4.after_input"/>}
            #end add-point   
    
         ON ACTION controlo
            CALL FGL_SET_ARR_CURR(g_xmdc4_d.getLength()+1)
            LET lb_reproduce = TRUE
            LET li_reproduce = l_ac
            LET li_reproduce_target = g_xmdc4_d.getLength()+1
 
      END INPUT
 
      
 
      
      DISPLAY ARRAY g_xmdc3_d TO s_detail3.* ATTRIBUTES(COUNT=g_rec_b)  
    
         BEFORE ROW
            CALL adbt500_idx_chk()
            LET l_ac = DIALOG.getCurrentRow("s_detail3")
            LET g_detail_idx = l_ac
            
            #add-point:page2, before row動作
            {<point name="input.body3.before_row"/>}
            #end add-point
            
         BEFORE DISPLAY
            CALL FGL_SET_ARR_CURR(g_detail_idx)
            LET l_ac = DIALOG.getCurrentRow("s_detail3")
            CALL adbt500_idx_chk()
            LET g_current_page = 2
      
         #add-point:page2自定義行為
         {<point name="input.body3.action"/>}
         #end add-point
      
      END DISPLAY
      DISPLAY ARRAY g_xmdc5_d TO s_detail5.* ATTRIBUTES(COUNT=g_rec_b)  
    
         BEFORE ROW
            CALL adbt500_idx_chk()
            LET l_ac = DIALOG.getCurrentRow("s_detail5")
            LET g_detail_idx = l_ac
            
            #add-point:page4, before row動作
            {<point name="input.body5.before_row"/>}
            #end add-point
            
         BEFORE DISPLAY
            CALL FGL_SET_ARR_CURR(g_detail_idx)
            LET l_ac = DIALOG.getCurrentRow("s_detail5")
            CALL adbt500_idx_chk()
            LET g_current_page = 4
      
         #add-point:page4自定義行為
         {<point name="input.body5.action"/>}
         #end add-point
      
      END DISPLAY
      DISPLAY ARRAY g_xmdc6_d TO s_detail6.* ATTRIBUTES(COUNT=g_rec_b)  
    
         BEFORE ROW
            CALL adbt500_idx_chk()
            LET l_ac = DIALOG.getCurrentRow("s_detail6")
            LET g_detail_idx = l_ac
            
            #add-point:page5, before row動作
            {<point name="input.body6.before_row"/>}
            #end add-point
            
         BEFORE DISPLAY
            CALL FGL_SET_ARR_CURR(g_detail_idx)
            LET l_ac = DIALOG.getCurrentRow("s_detail6")
            CALL adbt500_idx_chk()
            LET g_current_page = 5
      
         #add-point:page5自定義行為
         {<point name="input.body6.action"/>}
         #end add-point
      
      END DISPLAY
 
      
 
      
]]>
  </section>
  <section id="adbt500.input.head" ver="43" status="" src="s">
    <![CDATA[      #單頭段
      INPUT BY NAME g_xmda_m.xmdasite,g_xmda_m.xmdadocdt,g_xmda_m.xmdadocno,g_xmda_m.xmda001,g_xmda_m.xmda005, 
          g_xmda_m.xmda202,g_xmda_m.xmda023,g_xmda_m.xmda004,g_xmda_m.xmda200,g_xmda_m.xmda201,g_xmda_m.xmdastus, 
          g_xmda_m.xmda007,g_xmda_m.xmda008,g_xmda_m.xmda021,g_xmda_m.xmda022,g_xmda_m.xmda203,g_xmda_m.xmda027, 
          g_xmda_m.xmda024,g_xmda_m.xmda002,g_xmda_m.xmda003,g_xmda_m.xmdaunit,g_xmda_m.xmda204,g_xmda_m.xmda205, 
          g_xmda_m.xmda071,g_xmda_m.xmda025,g_xmda_m.xmda026,g_xmda_m.xmda020,g_xmda_m.xmda036,g_xmda_m.xmda009, 
          g_xmda_m.xmda010,g_xmda_m.xmda015,g_xmda_m.xmda011,g_xmda_m.xmda035,g_xmda_m.xmda039,g_xmda_m.xmda034, 
          g_xmda_m.xmda006,g_xmda_m.xmda033,g_xmda_m.xmda017,g_xmda_m.xmda019,g_xmda_m.xmda018,g_xmda_m.xmda044, 
          g_xmda_m.xmda028 
         ATTRIBUTE(WITHOUT DEFAULTS)
         
         #自訂ACTION(master_input)
         
     
         BEFORE INPUT
            IF s_transaction_chk("N",0) THEN
               CALL s_transaction_begin()
            END IF
            
            IF l_cmd_t = 'r' THEN
               
            END IF
            #add-point:資料輸入前
            {<point name="input.m.before_input"/>}
            #end add-point
 
                  #此段落由子樣板a02產生
         AFTER FIELD xmdasite
            
            #add-point:AFTER FIELD xmdasite
            {<point name="input.a.xmdasite" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdasite
            #add-point:BEFORE FIELD xmdasite
            {<point name="input.b.xmdasite" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE xmdasite
            #add-point:ON CHANGE xmdasite
            {<point name="input.g.xmdasite" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdadocdt
            #add-point:BEFORE FIELD xmdadocdt
            {<point name="input.b.xmdadocdt" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdadocdt
            
            #add-point:AFTER FIELD xmdadocdt
            {<point name="input.a.xmdadocdt" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE xmdadocdt
            #add-point:ON CHANGE xmdadocdt
            {<point name="input.g.xmdadocdt" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdadocno
            
            #add-point:AFTER FIELD xmdadocno
            {<point name="input.a.xmdadocno" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdadocno
            #add-point:BEFORE FIELD xmdadocno
            {<point name="input.b.xmdadocno" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE xmdadocno
            #add-point:ON CHANGE xmdadocno
            {<point name="input.g.xmdadocno" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmda001
            #add-point:BEFORE FIELD xmda001
            {<point name="input.b.xmda001" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmda001
            
            #add-point:AFTER FIELD xmda001
            {<point name="input.a.xmda001" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE xmda001
            #add-point:ON CHANGE xmda001
            {<point name="input.g.xmda001" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmda005
            #add-point:BEFORE FIELD xmda005
            {<point name="input.b.xmda005" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmda005
            
            #add-point:AFTER FIELD xmda005
            {<point name="input.a.xmda005" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE xmda005
            #add-point:ON CHANGE xmda005
            {<point name="input.g.xmda005" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmda202
            
            #add-point:AFTER FIELD xmda202
            {<point name="input.a.xmda202" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmda202
            #add-point:BEFORE FIELD xmda202
            {<point name="input.b.xmda202" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE xmda202
            #add-point:ON CHANGE xmda202
            {<point name="input.g.xmda202" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmda023
            
            #add-point:AFTER FIELD xmda023
            {<point name="input.a.xmda023" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmda023
            #add-point:BEFORE FIELD xmda023
            {<point name="input.b.xmda023" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE xmda023
            #add-point:ON CHANGE xmda023
            {<point name="input.g.xmda023" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmda004
            
            #add-point:AFTER FIELD xmda004
            {<point name="input.a.xmda004" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmda004
            #add-point:BEFORE FIELD xmda004
            {<point name="input.b.xmda004" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE xmda004
            #add-point:ON CHANGE xmda004
            {<point name="input.g.xmda004" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmda200
            
            #add-point:AFTER FIELD xmda200
            {<point name="input.a.xmda200" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmda200
            #add-point:BEFORE FIELD xmda200
            {<point name="input.b.xmda200" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE xmda200
            #add-point:ON CHANGE xmda200
            {<point name="input.g.xmda200" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmda201
            
            #add-point:AFTER FIELD xmda201
            {<point name="input.a.xmda201" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmda201
            #add-point:BEFORE FIELD xmda201
            {<point name="input.b.xmda201" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE xmda201
            #add-point:ON CHANGE xmda201
            {<point name="input.g.xmda201" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdastus
            #add-point:BEFORE FIELD xmdastus
            {<point name="input.b.xmdastus" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdastus
            
            #add-point:AFTER FIELD xmdastus
            {<point name="input.a.xmdastus" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE xmdastus
            #add-point:ON CHANGE xmdastus
            {<point name="input.g.xmdastus" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmda007
            #add-point:BEFORE FIELD xmda007
            {<point name="input.b.xmda007" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmda007
            
            #add-point:AFTER FIELD xmda007
            {<point name="input.a.xmda007" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE xmda007
            #add-point:ON CHANGE xmda007
            {<point name="input.g.xmda007" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmda008
            #add-point:BEFORE FIELD xmda008
            {<point name="input.b.xmda008" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmda008
            
            #add-point:AFTER FIELD xmda008
            {<point name="input.a.xmda008" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE xmda008
            #add-point:ON CHANGE xmda008
            {<point name="input.g.xmda008" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmda021
            
            #add-point:AFTER FIELD xmda021
            {<point name="input.a.xmda021" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmda021
            #add-point:BEFORE FIELD xmda021
            {<point name="input.b.xmda021" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE xmda021
            #add-point:ON CHANGE xmda021
            {<point name="input.g.xmda021" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmda022
            
            #add-point:AFTER FIELD xmda022
            {<point name="input.a.xmda022" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmda022
            #add-point:BEFORE FIELD xmda022
            {<point name="input.b.xmda022" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE xmda022
            #add-point:ON CHANGE xmda022
            {<point name="input.g.xmda022" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmda203
            
            #add-point:AFTER FIELD xmda203
            {<point name="input.a.xmda203" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmda203
            #add-point:BEFORE FIELD xmda203
            {<point name="input.b.xmda203" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE xmda203
            #add-point:ON CHANGE xmda203
            {<point name="input.g.xmda203" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmda027
            
            #add-point:AFTER FIELD xmda027
            {<point name="input.a.xmda027" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmda027
            #add-point:BEFORE FIELD xmda027
            {<point name="input.b.xmda027" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE xmda027
            #add-point:ON CHANGE xmda027
            {<point name="input.g.xmda027" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmda024
            
            #add-point:AFTER FIELD xmda024
            {<point name="input.a.xmda024" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmda024
            #add-point:BEFORE FIELD xmda024
            {<point name="input.b.xmda024" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE xmda024
            #add-point:ON CHANGE xmda024
            {<point name="input.g.xmda024" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmda002
            
            #add-point:AFTER FIELD xmda002
            {<point name="input.a.xmda002" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmda002
            #add-point:BEFORE FIELD xmda002
            {<point name="input.b.xmda002" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE xmda002
            #add-point:ON CHANGE xmda002
            {<point name="input.g.xmda002" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmda003
            
            #add-point:AFTER FIELD xmda003
            {<point name="input.a.xmda003" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmda003
            #add-point:BEFORE FIELD xmda003
            {<point name="input.b.xmda003" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE xmda003
            #add-point:ON CHANGE xmda003
            {<point name="input.g.xmda003" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmdaunit
            
            #add-point:AFTER FIELD xmdaunit
            {<point name="input.a.xmdaunit" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmdaunit
            #add-point:BEFORE FIELD xmdaunit
            {<point name="input.b.xmdaunit" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE xmdaunit
            #add-point:ON CHANGE xmdaunit
            {<point name="input.g.xmdaunit" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmda204
            
            #add-point:AFTER FIELD xmda204
            {<point name="input.a.xmda204" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmda204
            #add-point:BEFORE FIELD xmda204
            {<point name="input.b.xmda204" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE xmda204
            #add-point:ON CHANGE xmda204
            {<point name="input.g.xmda204" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmda205
            #此段落由子樣板a15產生
            IF NOT cl_ap_chk_Range(g_xmda_m.xmda205,"0","1","100","1","azz-00087",1) THEN
               NEXT FIELD xmda205
            END IF
 
 
            #add-point:AFTER FIELD xmda205
            {<point name="input.a.xmda205" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmda205
            #add-point:BEFORE FIELD xmda205
            {<point name="input.b.xmda205" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE xmda205
            #add-point:ON CHANGE xmda205
            {<point name="input.g.xmda205" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmda071
            #add-point:BEFORE FIELD xmda071
            {<point name="input.b.xmda071" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmda071
            
            #add-point:AFTER FIELD xmda071
            {<point name="input.a.xmda071" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE xmda071
            #add-point:ON CHANGE xmda071
            {<point name="input.g.xmda071" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmda025
            
            #add-point:AFTER FIELD xmda025
            {<point name="input.a.xmda025" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmda025
            #add-point:BEFORE FIELD xmda025
            {<point name="input.b.xmda025" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE xmda025
            #add-point:ON CHANGE xmda025
            {<point name="input.g.xmda025" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmda026
            
            #add-point:AFTER FIELD xmda026
            {<point name="input.a.xmda026" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmda026
            #add-point:BEFORE FIELD xmda026
            {<point name="input.b.xmda026" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE xmda026
            #add-point:ON CHANGE xmda026
            {<point name="input.g.xmda026" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmda020
            
            #add-point:AFTER FIELD xmda020
            {<point name="input.a.xmda020" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmda020
            #add-point:BEFORE FIELD xmda020
            {<point name="input.b.xmda020" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE xmda020
            #add-point:ON CHANGE xmda020
            {<point name="input.g.xmda020" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmda036
            
            #add-point:AFTER FIELD xmda036
            {<point name="input.a.xmda036" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmda036
            #add-point:BEFORE FIELD xmda036
            {<point name="input.b.xmda036" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE xmda036
            #add-point:ON CHANGE xmda036
            {<point name="input.g.xmda036" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmda009
            
            #add-point:AFTER FIELD xmda009
            {<point name="input.a.xmda009" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmda009
            #add-point:BEFORE FIELD xmda009
            {<point name="input.b.xmda009" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE xmda009
            #add-point:ON CHANGE xmda009
            {<point name="input.g.xmda009" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmda010
            
            #add-point:AFTER FIELD xmda010
            {<point name="input.a.xmda010" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmda010
            #add-point:BEFORE FIELD xmda010
            {<point name="input.b.xmda010" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE xmda010
            #add-point:ON CHANGE xmda010
            {<point name="input.g.xmda010" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmda015
            
            #add-point:AFTER FIELD xmda015
            {<point name="input.a.xmda015" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmda015
            #add-point:BEFORE FIELD xmda015
            {<point name="input.b.xmda015" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE xmda015
            #add-point:ON CHANGE xmda015
            {<point name="input.g.xmda015" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmda011
            
            #add-point:AFTER FIELD xmda011
            {<point name="input.a.xmda011" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmda011
            #add-point:BEFORE FIELD xmda011
            {<point name="input.b.xmda011" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE xmda011
            #add-point:ON CHANGE xmda011
            {<point name="input.g.xmda011" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmda035
            
            #add-point:AFTER FIELD xmda035
            {<point name="input.a.xmda035" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmda035
            #add-point:BEFORE FIELD xmda035
            {<point name="input.b.xmda035" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE xmda035
            #add-point:ON CHANGE xmda035
            {<point name="input.g.xmda035" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmda039
            #add-point:BEFORE FIELD xmda039
            {<point name="input.b.xmda039" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmda039
            
            #add-point:AFTER FIELD xmda039
            {<point name="input.a.xmda039" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE xmda039
            #add-point:ON CHANGE xmda039
            {<point name="input.g.xmda039" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmda034
            
            #add-point:AFTER FIELD xmda034
            {<point name="input.a.xmda034" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmda034
            #add-point:BEFORE FIELD xmda034
            {<point name="input.b.xmda034" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE xmda034
            #add-point:ON CHANGE xmda034
            {<point name="input.g.xmda034" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmda006
            #add-point:BEFORE FIELD xmda006
            {<point name="input.b.xmda006" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmda006
            
            #add-point:AFTER FIELD xmda006
            {<point name="input.a.xmda006" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE xmda006
            #add-point:ON CHANGE xmda006
            {<point name="input.g.xmda006" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmda033
            #add-point:BEFORE FIELD xmda033
            {<point name="input.b.xmda033" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmda033
            
            #add-point:AFTER FIELD xmda033
            {<point name="input.a.xmda033" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE xmda033
            #add-point:ON CHANGE xmda033
            {<point name="input.g.xmda033" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmda017
            
            #add-point:AFTER FIELD xmda017
            {<point name="input.a.xmda017" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmda017
            #add-point:BEFORE FIELD xmda017
            {<point name="input.b.xmda017" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE xmda017
            #add-point:ON CHANGE xmda017
            {<point name="input.g.xmda017" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmda019
            #add-point:BEFORE FIELD xmda019
            {<point name="input.b.xmda019" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmda019
            
            #add-point:AFTER FIELD xmda019
            {<point name="input.a.xmda019" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE xmda019
            #add-point:ON CHANGE xmda019
            {<point name="input.g.xmda019" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmda018
            
            #add-point:AFTER FIELD xmda018
            {<point name="input.a.xmda018" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmda018
            #add-point:BEFORE FIELD xmda018
            {<point name="input.b.xmda018" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE xmda018
            #add-point:ON CHANGE xmda018
            {<point name="input.g.xmda018" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmda044
            
            #add-point:AFTER FIELD xmda044
            {<point name="input.a.xmda044" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmda044
            #add-point:BEFORE FIELD xmda044
            {<point name="input.b.xmda044" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE xmda044
            #add-point:ON CHANGE xmda044
            {<point name="input.g.xmda044" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmda028
            #add-point:BEFORE FIELD xmda028
            {<point name="input.b.xmda028" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmda028
            
            #add-point:AFTER FIELD xmda028
            {<point name="input.a.xmda028" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE xmda028
            #add-point:ON CHANGE xmda028
            {<point name="input.g.xmda028" />}
            #END add-point
 
 #欄位檢查
                  #Ctrlp:input.c.xmdasite
         ON ACTION controlp INFIELD xmdasite
            #add-point:ON ACTION controlp INFIELD xmdasite
            {<point name="input.c.xmdasite" />}
            #END add-point
 
         #Ctrlp:input.c.xmdadocdt
         ON ACTION controlp INFIELD xmdadocdt
            #add-point:ON ACTION controlp INFIELD xmdadocdt
            {<point name="input.c.xmdadocdt" />}
            #END add-point
 
         #Ctrlp:input.c.xmdadocno
         ON ACTION controlp INFIELD xmdadocno
            #add-point:ON ACTION controlp INFIELD xmdadocno
            {<point name="input.c.xmdadocno" />}
            #END add-point
 
         #Ctrlp:input.c.xmda001
         ON ACTION controlp INFIELD xmda001
            #add-point:ON ACTION controlp INFIELD xmda001
            {<point name="input.c.xmda001" />}
            #END add-point
 
         #Ctrlp:input.c.xmda005
         ON ACTION controlp INFIELD xmda005
            #add-point:ON ACTION controlp INFIELD xmda005
            {<point name="input.c.xmda005" />}
            #END add-point
 
         #Ctrlp:input.c.xmda202
         ON ACTION controlp INFIELD xmda202
            #add-point:ON ACTION controlp INFIELD xmda202
            {<point name="input.c.xmda202" />}
            #END add-point
 
         #Ctrlp:input.c.xmda023
         ON ACTION controlp INFIELD xmda023
            #add-point:ON ACTION controlp INFIELD xmda023
            {<point name="input.c.xmda023" />}
            #END add-point
 
         #Ctrlp:input.c.xmda004
         ON ACTION controlp INFIELD xmda004
            #add-point:ON ACTION controlp INFIELD xmda004
            {<point name="input.c.xmda004" />}
            #END add-point
 
         #Ctrlp:input.c.xmda200
         ON ACTION controlp INFIELD xmda200
            #add-point:ON ACTION controlp INFIELD xmda200
            {<point name="input.c.xmda200" />}
            #END add-point
 
         #Ctrlp:input.c.xmda201
         ON ACTION controlp INFIELD xmda201
            #add-point:ON ACTION controlp INFIELD xmda201
            {<point name="input.c.xmda201" />}
            #END add-point
 
         #Ctrlp:input.c.xmdastus
         ON ACTION controlp INFIELD xmdastus
            #add-point:ON ACTION controlp INFIELD xmdastus
            {<point name="input.c.xmdastus" />}
            #END add-point
 
         #Ctrlp:input.c.xmda007
         ON ACTION controlp INFIELD xmda007
            #add-point:ON ACTION controlp INFIELD xmda007
            {<point name="input.c.xmda007" />}
            #END add-point
 
         #Ctrlp:input.c.xmda008
         ON ACTION controlp INFIELD xmda008
            #add-point:ON ACTION controlp INFIELD xmda008
            {<point name="input.c.xmda008" />}
            #END add-point
 
         #Ctrlp:input.c.xmda021
         ON ACTION controlp INFIELD xmda021
            #add-point:ON ACTION controlp INFIELD xmda021
            {<point name="input.c.xmda021" />}
            #END add-point
 
         #Ctrlp:input.c.xmda022
         ON ACTION controlp INFIELD xmda022
            #add-point:ON ACTION controlp INFIELD xmda022
            {<point name="input.c.xmda022" />}
            #END add-point
 
         #Ctrlp:input.c.xmda203
         ON ACTION controlp INFIELD xmda203
            #add-point:ON ACTION controlp INFIELD xmda203
            {<point name="input.c.xmda203" />}
            #END add-point
 
         #Ctrlp:input.c.xmda027
         ON ACTION controlp INFIELD xmda027
            #add-point:ON ACTION controlp INFIELD xmda027
            {<point name="input.c.xmda027" />}
            #END add-point
 
         #Ctrlp:input.c.xmda024
         ON ACTION controlp INFIELD xmda024
            #add-point:ON ACTION controlp INFIELD xmda024
            {<point name="input.c.xmda024" />}
            #END add-point
 
         #Ctrlp:input.c.xmda002
         ON ACTION controlp INFIELD xmda002
            #add-point:ON ACTION controlp INFIELD xmda002
            {<point name="input.c.xmda002" />}
            #END add-point
 
         #Ctrlp:input.c.xmda003
         ON ACTION controlp INFIELD xmda003
            #add-point:ON ACTION controlp INFIELD xmda003
            {<point name="input.c.xmda003" />}
            #END add-point
 
         #Ctrlp:input.c.xmdaunit
         ON ACTION controlp INFIELD xmdaunit
            #add-point:ON ACTION controlp INFIELD xmdaunit
            {<point name="input.c.xmdaunit" />}
            #END add-point
 
         #Ctrlp:input.c.xmda204
         ON ACTION controlp INFIELD xmda204
            #add-point:ON ACTION controlp INFIELD xmda204
            {<point name="input.c.xmda204" />}
            #END add-point
 
         #Ctrlp:input.c.xmda205
         ON ACTION controlp INFIELD xmda205
            #add-point:ON ACTION controlp INFIELD xmda205
            {<point name="input.c.xmda205" />}
            #END add-point
 
         #Ctrlp:input.c.xmda071
         ON ACTION controlp INFIELD xmda071
            #add-point:ON ACTION controlp INFIELD xmda071
            {<point name="input.c.xmda071" />}
            #END add-point
 
         #Ctrlp:input.c.xmda025
         ON ACTION controlp INFIELD xmda025
            #add-point:ON ACTION controlp INFIELD xmda025
            {<point name="input.c.xmda025" />}
            #END add-point
 
         #Ctrlp:input.c.xmda026
         ON ACTION controlp INFIELD xmda026
            #add-point:ON ACTION controlp INFIELD xmda026
            {<point name="input.c.xmda026" />}
            #END add-point
 
         #Ctrlp:input.c.xmda020
         ON ACTION controlp INFIELD xmda020
            #add-point:ON ACTION controlp INFIELD xmda020
            {<point name="input.c.xmda020" />}
            #END add-point
 
         #Ctrlp:input.c.xmda036
         ON ACTION controlp INFIELD xmda036
            #add-point:ON ACTION controlp INFIELD xmda036
            {<point name="input.c.xmda036" />}
            #END add-point
 
         #Ctrlp:input.c.xmda009
         ON ACTION controlp INFIELD xmda009
            #add-point:ON ACTION controlp INFIELD xmda009
            {<point name="input.c.xmda009" />}
            #END add-point
 
         #Ctrlp:input.c.xmda010
         ON ACTION controlp INFIELD xmda010
            #add-point:ON ACTION controlp INFIELD xmda010
            {<point name="input.c.xmda010" />}
            #END add-point
 
         #Ctrlp:input.c.xmda015
         ON ACTION controlp INFIELD xmda015
            #add-point:ON ACTION controlp INFIELD xmda015
            {<point name="input.c.xmda015" />}
            #END add-point
 
         #Ctrlp:input.c.xmda011
         ON ACTION controlp INFIELD xmda011
            #add-point:ON ACTION controlp INFIELD xmda011
            {<point name="input.c.xmda011" />}
            #END add-point
 
         #Ctrlp:input.c.xmda035
         ON ACTION controlp INFIELD xmda035
            #add-point:ON ACTION controlp INFIELD xmda035
            {<point name="input.c.xmda035" />}
            #END add-point
 
         #Ctrlp:input.c.xmda039
         ON ACTION controlp INFIELD xmda039
            #add-point:ON ACTION controlp INFIELD xmda039
            {<point name="input.c.xmda039" />}
            #END add-point
 
         #Ctrlp:input.c.xmda034
         ON ACTION controlp INFIELD xmda034
            #add-point:ON ACTION controlp INFIELD xmda034
            {<point name="input.c.xmda034" />}
            #END add-point
 
         #Ctrlp:input.c.xmda006
         ON ACTION controlp INFIELD xmda006
            #add-point:ON ACTION controlp INFIELD xmda006
            {<point name="input.c.xmda006" />}
            #END add-point
 
         #Ctrlp:input.c.xmda033
         ON ACTION controlp INFIELD xmda033
            #add-point:ON ACTION controlp INFIELD xmda033
            {<point name="input.c.xmda033" />}
            #END add-point
 
         #Ctrlp:input.c.xmda017
         ON ACTION controlp INFIELD xmda017
            #add-point:ON ACTION controlp INFIELD xmda017
            {<point name="input.c.xmda017" />}
            #END add-point
 
         #Ctrlp:input.c.xmda019
         ON ACTION controlp INFIELD xmda019
            #add-point:ON ACTION controlp INFIELD xmda019
            {<point name="input.c.xmda019" />}
            #END add-point
 
         #Ctrlp:input.c.xmda018
         ON ACTION controlp INFIELD xmda018
            #add-point:ON ACTION controlp INFIELD xmda018
            {<point name="input.c.xmda018" />}
            #END add-point
 
         #Ctrlp:input.c.xmda044
         ON ACTION controlp INFIELD xmda044
            #add-point:ON ACTION controlp INFIELD xmda044
            {<point name="input.c.xmda044" />}
            #END add-point
 
         #Ctrlp:input.c.xmda028
         ON ACTION controlp INFIELD xmda028
            #add-point:ON ACTION controlp INFIELD xmda028
            {<point name="input.c.xmda028" />}
            #END add-point
 
 #欄位開窗
            
         AFTER INPUT
            IF INT_FLAG THEN
               EXIT DIALOG
            END IF
 
            CALL cl_showmsg()      #錯誤訊息統整顯示
            DISPLAY BY NAME g_xmda_m.xmdadocno
                        
            #add-point:單頭INPUT後
            {<point name="input.head.after_input"/>}
            #end add-point
                        
            IF p_cmd <> 'u' THEN
    
               CALL s_transaction_begin()
               
               #add-point:單頭新增前
               {<point name="input.head.b_insert" mark="Y"/>}
               #end add-point
               
               INSERT INTO xmda_t (xmdaent,xmdasite,xmdadocdt,xmdadocno,xmda001,xmda005,xmda202,xmda023, 
                   xmda004,xmda200,xmda201,xmdastus,xmda007,xmda008,xmda021,xmda022,xmda203,xmda027, 
                   xmda024,xmda002,xmda003,xmdaunit,xmda204,xmda205,xmda032,xmda071,xmda025,xmda026, 
                   xmda206,xmda207,xmda020,xmda036,xmda009,xmda010,xmda015,xmda016,xmda011,xmda012,xmda013, 
                   xmda035,xmda039,xmdaownid,xmdaowndp,xmdacrtid,xmdacrtdp,xmdacrtdt,xmdacnfid,xmdacnfdt, 
                   xmda034,xmda006,xmda033,xmda017,xmda019,xmda018,xmda044,xmda030,xmda031,xmda045,xmda046, 
                   xmda047,xmda028,xmda041,xmda042,xmda043)
               VALUES (g_enterprise,g_xmda_m.xmdasite,g_xmda_m.xmdadocdt,g_xmda_m.xmdadocno,g_xmda_m.xmda001, 
                   g_xmda_m.xmda005,g_xmda_m.xmda202,g_xmda_m.xmda023,g_xmda_m.xmda004,g_xmda_m.xmda200, 
                   g_xmda_m.xmda201,g_xmda_m.xmdastus,g_xmda_m.xmda007,g_xmda_m.xmda008,g_xmda_m.xmda021, 
                   g_xmda_m.xmda022,g_xmda_m.xmda203,g_xmda_m.xmda027,g_xmda_m.xmda024,g_xmda_m.xmda002, 
                   g_xmda_m.xmda003,g_xmda_m.xmdaunit,g_xmda_m.xmda204,g_xmda_m.xmda205,g_xmda_m.xmda032, 
                   g_xmda_m.xmda071,g_xmda_m.xmda025,g_xmda_m.xmda026,g_xmda_m.xmda206,g_xmda_m.xmda207, 
                   g_xmda_m.xmda020,g_xmda_m.xmda036,g_xmda_m.xmda009,g_xmda_m.xmda010,g_xmda_m.xmda015, 
                   g_xmda_m.xmda016,g_xmda_m.xmda011,g_xmda_m.xmda012,g_xmda_m.xmda013,g_xmda_m.xmda035, 
                   g_xmda_m.xmda039,g_xmda_m.xmdaownid,g_xmda_m.xmdaowndp,g_xmda_m.xmdacrtid,g_xmda_m.xmdacrtdp, 
                   g_xmda_m.xmdacrtdt,g_xmda_m.xmdacnfid,g_xmda_m.xmdacnfdt,g_xmda_m.xmda034,g_xmda_m.xmda006, 
                   g_xmda_m.xmda033,g_xmda_m.xmda017,g_xmda_m.xmda019,g_xmda_m.xmda018,g_xmda_m.xmda044, 
                   g_xmda_m.xmda030,g_xmda_m.xmda031,g_xmda_m.xmda045,g_xmda_m.xmda046,g_xmda_m.xmda047, 
                   g_xmda_m.xmda028,g_xmda_m.xmda041,g_xmda_m.xmda042,g_xmda_m.xmda043) 
               IF SQLCA.sqlcode THEN
                  CALL cl_err("g_xmda_m",SQLCA.sqlcode,1)  
                  CALL s_transaction_end('N','0')
                  CONTINUE DIALOG
               END IF
               
               #add-point:單頭新增中
               {<point name="input.head.m_insert"/>}
               #end add-point
               
               
               
               
               #add-point:單頭新增後
               {<point name="input.head.a_insert"/>}
               #end add-point
               CALL s_transaction_end('Y','0') 
               
               IF l_cmd_t = 'r' AND p_cmd = 'a' THEN
                  CALL adbt500_detail_reproduce()
               END IF
               
               LET p_cmd = 'u'
            ELSE
               CALL s_transaction_begin()
            
               #add-point:單頭修改前
               {<point name="input.head.b_update" mark="Y"/>}
               #end add-point
               
               UPDATE xmda_t SET (xmdasite,xmdadocdt,xmdadocno,xmda001,xmda005,xmda202,xmda023,xmda004, 
                   xmda200,xmda201,xmdastus,xmda007,xmda008,xmda021,xmda022,xmda203,xmda027,xmda024, 
                   xmda002,xmda003,xmdaunit,xmda204,xmda205,xmda032,xmda071,xmda025,xmda026,xmda206, 
                   xmda207,xmda020,xmda036,xmda009,xmda010,xmda015,xmda016,xmda011,xmda012,xmda013,xmda035, 
                   xmda039,xmdaownid,xmdaowndp,xmdacrtid,xmdacrtdp,xmdacrtdt,xmdacnfid,xmdacnfdt,xmda034, 
                   xmda006,xmda033,xmda017,xmda019,xmda018,xmda044,xmda030,xmda031,xmda045,xmda046,xmda047, 
                   xmda028,xmda041,xmda042,xmda043) = (g_xmda_m.xmdasite,g_xmda_m.xmdadocdt,g_xmda_m.xmdadocno, 
                   g_xmda_m.xmda001,g_xmda_m.xmda005,g_xmda_m.xmda202,g_xmda_m.xmda023,g_xmda_m.xmda004, 
                   g_xmda_m.xmda200,g_xmda_m.xmda201,g_xmda_m.xmdastus,g_xmda_m.xmda007,g_xmda_m.xmda008, 
                   g_xmda_m.xmda021,g_xmda_m.xmda022,g_xmda_m.xmda203,g_xmda_m.xmda027,g_xmda_m.xmda024, 
                   g_xmda_m.xmda002,g_xmda_m.xmda003,g_xmda_m.xmdaunit,g_xmda_m.xmda204,g_xmda_m.xmda205, 
                   g_xmda_m.xmda032,g_xmda_m.xmda071,g_xmda_m.xmda025,g_xmda_m.xmda026,g_xmda_m.xmda206, 
                   g_xmda_m.xmda207,g_xmda_m.xmda020,g_xmda_m.xmda036,g_xmda_m.xmda009,g_xmda_m.xmda010, 
                   g_xmda_m.xmda015,g_xmda_m.xmda016,g_xmda_m.xmda011,g_xmda_m.xmda012,g_xmda_m.xmda013, 
                   g_xmda_m.xmda035,g_xmda_m.xmda039,g_xmda_m.xmdaownid,g_xmda_m.xmdaowndp,g_xmda_m.xmdacrtid, 
                   g_xmda_m.xmdacrtdp,g_xmda_m.xmdacrtdt,g_xmda_m.xmdacnfid,g_xmda_m.xmdacnfdt,g_xmda_m.xmda034, 
                   g_xmda_m.xmda006,g_xmda_m.xmda033,g_xmda_m.xmda017,g_xmda_m.xmda019,g_xmda_m.xmda018, 
                   g_xmda_m.xmda044,g_xmda_m.xmda030,g_xmda_m.xmda031,g_xmda_m.xmda045,g_xmda_m.xmda046, 
                   g_xmda_m.xmda047,g_xmda_m.xmda028,g_xmda_m.xmda041,g_xmda_m.xmda042,g_xmda_m.xmda043) 

                WHERE xmdaent = g_enterprise AND xmdadocno = g_xmdadocno_t
 
               IF SQLCA.sqlcode THEN
                  CALL cl_err("xmda_t",SQLCA.sqlcode,1)  
                  CALL s_transaction_end('N','0')
                  CONTINUE DIALOG
               END IF
               
               #add-point:單頭修改中
               {<point name="input.head.m_update"/>}
               #end add-point
               
               
               
               
			   #修改歷程記錄
               LET g_log1 = util.JSON.stringify(g_xmda_m_t)
               LET g_log2 = util.JSON.stringify(g_xmda_m)
               IF NOT cl_log_modified_record(g_log1,g_log2) THEN 
                  CALL s_transaction_end('N','0')
               ELSE
                  CALL s_transaction_end('Y','0')
               END IF
               
               #add-point:單頭修改後
               {<point name="input.head.a_update"/>}
               #end add-point
            END IF
            
            LET g_xmdadocno_t = g_xmda_m.xmdadocno
 
            #controlp
            
      END INPUT
   
]]>
  </section>
  <section id="adbt500.input.other" ver="21" status="" src="s">
    <![CDATA[      
      #add-point:自定義input
      {<point name="input.more_input"/>}
      #end add-point
      
      BEFORE DIALOG 
         #add-point:input段before dialog
         {<point name="input.before_dialog"/>}
         #end add-point    
         #新增時強制從單頭開始填
         IF p_cmd = 'a' THEN
            NEXT FIELD xmdadocno
         ELSE
            CASE g_aw
               WHEN "s_detail1"
                  NEXT FIELD xmdcsite
               WHEN "s_detail3"
                  NEXT FIELD xmdddocno
               WHEN "s_detail4"
                  NEXT FIELD xmjaunit
               WHEN "s_detail5"
                  NEXT FIELD xmdbsite
               WHEN "s_detail6"
                  NEXT FIELD xrcdseq
 
            END CASE
         END IF
    
      ON ACTION controlf
         CALL cl_set_focus_form(ui.Interface.getRootNode()) RETURNING g_fld_name,g_frm_name
         CALL cl_fldhelp(g_frm_name,g_fld_name,g_lang)
 
      ON ACTION controlr
         CALL cl_show_req_fields()
 
      ON ACTION controls
         IF g_header_hidden THEN
            CALL gfrm_curr.setElementHidden("vb_master",0)
            CALL gfrm_curr.setElementImage("controls","small/arr-u.png")
            LET g_header_hidden = 0     #visible
         ELSE
            CALL gfrm_curr.setElementHidden("vb_master",1)
            CALL gfrm_curr.setElementImage("controls","small/arr-d.png")
            LET g_header_hidden = 1     #hidden     
         END IF
 
      ON ACTION accept
         #add-point:input段accept 
         {<point name="input.accept"/>}
         #end add-point    
         ACCEPT DIALOG
        
      ON ACTION cancel      #在dialog button (放棄)
         LET INT_FLAG = TRUE 
         LET g_detail_idx  = 1
         LET g_detail_idx2 = 1
         EXIT DIALOG
 
      ON ACTION close       #在dialog 右上角 (X)
         LET INT_FLAG = TRUE 
         EXIT DIALOG
 
      ON ACTION exit        #toolbar 離開
         LET INT_FLAG = TRUE 
         EXIT DIALOG
 
      #交談指令共用ACTION
      &include "common_action.4gl" 
         CONTINUE DIALOG 
         
   END DIALOG
    
   #add-point:input段after input 
   {<point name="input.after_input"/>}
   #end add-point    
 
END FUNCTION
]]>
  </section>
  <section id="adbt500.insert" ver="31" status="" src="s">
    <![CDATA[#+ 資料新增
PRIVATE FUNCTION adbt500_insert()
   #add-point:insert段define
   {<point name="insert.define"/>}
   #end add-point    
   
   #清畫面欄位內容
   CLEAR FORM                    
   CALL g_xmdc_d.clear()   
   CALL g_xmdc3_d.clear()  
   CALL g_xmdc4_d.clear()  
   CALL g_xmdc5_d.clear()  
   CALL g_xmdc6_d.clear()  
 
 
   INITIALIZE g_xmda_m.* LIKE xmda_t.*             #DEFAULT 設定
   
   LET g_xmdadocno_t = NULL
 
   
   CALL s_transaction_begin()
   WHILE TRUE
      #公用欄位給值(單頭)
      #此段落由子樣板a14產生    
      LET g_xmda_m.xmdaownid = g_user
      LET g_xmda_m.xmdaowndp = g_dept
      LET g_xmda_m.xmdacrtid = g_user
      LET g_xmda_m.xmdacrtdp = g_dept 
      LET g_xmda_m.xmdacrtdt = cl_get_current()
      LET g_xmda_m.xmdamodid = ""
      LET g_xmda_m.xmdamoddt = ""
      LET g_xmda_m.xmdastus = "N"
 
 
 
      #append欄位給值
      
     
      #一般欄位給值
            LET g_xmda_m.xmda001 = "0"
      LET g_xmda_m.xmda005 = "1"
      LET g_xmda_m.xmdastus = "N"
      LET g_xmda_m.xmda007 = "1"
      LET g_xmda_m.xmda205 = "100"
      LET g_xmda_m.xmda013 = "N"
      LET g_xmda_m.xmda039 = "1"
      LET g_xmda_m.xmda006 = "1"
      LET g_xmda_m.xmda019 = "Y"
      LET g_xmda_m.xmda030 = "N"
      LET g_xmda_m.xmda045 = "N"
      LET g_xmda_m.xmda046 = "N"
      LET g_xmda_m.xmda047 = "N"
      LET g_xmda_m.xmda041 = "0"
      LET g_xmda_m.xmda042 = "0"
      LET g_xmda_m.xmda043 = "0"
 
  
      #add-point:單頭預設值
      {<point name="insert.default"/>}
      #end add-point 
     
      CALL adbt500_input("a")
      
      #add-point:單頭輸入後
      {<point name="insert.after_insert"/>}
      #end add-point
      
      IF INT_FLAG THEN
         LET INT_FLAG = 0
         LET g_xmda_m.* = g_xmda_m_t.*
         CALL adbt500_show()
         CALL cl_err('',9001,0)
         CALL s_transaction_end('N','0')
         EXIT WHILE
      END IF
      
      CALL g_xmdc_d.clear()
      CALL g_xmdc3_d.clear()
      CALL g_xmdc4_d.clear()
      CALL g_xmdc5_d.clear()
      CALL g_xmdc6_d.clear()
 
 
      LET g_rec_b = 0
      CALL s_transaction_end('Y','0')
      EXIT WHILE
        
   END WHILE
   
   #將新增的資料併入搜尋條件中
   LET g_state = "Y"
   LET g_current_idx = 1 
   
   LET g_xmdadocno_t = g_xmda_m.xmdadocno
 
   
   LET g_wc = "(",g_wc,  
              " OR ( xmdaent = '" ||g_enterprise|| "' AND",
              " xmdadocno = '", g_xmda_m.xmdadocno CLIPPED, "' "
 
              , ")) "
   
   CLOSE adbt500_cl
   
END FUNCTION
]]>
  </section>
  <section id="adbt500.insert_b" ver="46" status="" src="s">
    <![CDATA[#+ 新增單身後其他table連動
PRIVATE FUNCTION adbt500_insert_b(ps_table,ps_keys,ps_page)
   DEFINE ps_table    STRING
   DEFINE ps_page     STRING
   DEFINE ps_keys     DYNAMIC ARRAY OF VARCHAR(500)
   DEFINE ls_group    STRING
   DEFINE ls_page     STRING
   #add-point:insert_b段define
   {<point name="insert_b.define"/>}
   #end add-point     
   
   #判斷是否是同一群組的table
   LET ls_group = "'1',"
   IF ls_group.getIndexOf(ps_page,1) > 0 THEN
      #add-point:insert_b段資料新增前
      {<point name="insert_b.before_insert" mark="Y"/>}
      #end add-point 
      INSERT INTO xmdc_t
                  (xmdcent,
                   xmdcdocno,
                   xmdcseq
                   ,xmdcsite,xmdc027,xmdc001,xmdc002,xmdc004,xmdc005,xmdc006,xmdc007,xmdc008,xmdc009,xmdc024,xmdc012,xmdc013,xmdc045,xmdc010,xmdc011,xmdc015,xmdc016,xmdc017,xmdc046,xmdc047,xmdc048,xmdc023,xmdc019,xmdc020,xmdc021,xmdc022,xmdc051,xmdcunit,xmdcorga,xmdc052,xmdc049,xmdc053,xmdc050) 
            VALUES(g_enterprise,
                   ps_keys[1],ps_keys[2]
                   ,g_xmdc_d[g_detail_idx].xmdcsite,g_xmdc_d[g_detail_idx].xmdc027,g_xmdc_d[g_detail_idx].xmdc001, 
                       g_xmdc_d[g_detail_idx].xmdc002,g_xmdc_d[g_detail_idx].xmdc004,g_xmdc_d[g_detail_idx].xmdc005, 
                       g_xmdc_d[g_detail_idx].xmdc006,g_xmdc_d[g_detail_idx].xmdc007,g_xmdc_d[g_detail_idx].xmdc008, 
                       g_xmdc_d[g_detail_idx].xmdc009,g_xmdc_d[g_detail_idx].xmdc024,g_xmdc_d[g_detail_idx].xmdc012, 
                       g_xmdc_d[g_detail_idx].xmdc013,g_xmdc_d[g_detail_idx].xmdc045,g_xmdc_d[g_detail_idx].xmdc010, 
                       g_xmdc_d[g_detail_idx].xmdc011,g_xmdc_d[g_detail_idx].xmdc015,g_xmdc_d[g_detail_idx].xmdc016, 
                       g_xmdc_d[g_detail_idx].xmdc017,g_xmdc_d[g_detail_idx].xmdc046,g_xmdc_d[g_detail_idx].xmdc047, 
                       g_xmdc_d[g_detail_idx].xmdc048,g_xmdc_d[g_detail_idx].xmdc023,g_xmdc_d[g_detail_idx].xmdc019, 
                       g_xmdc_d[g_detail_idx].xmdc020,g_xmdc_d[g_detail_idx].xmdc021,g_xmdc_d[g_detail_idx].xmdc022, 
                       g_xmdc_d[g_detail_idx].xmdc051,g_xmdc_d[g_detail_idx].xmdcunit,g_xmdc_d[g_detail_idx].xmdcorga, 
                       g_xmdc_d[g_detail_idx].xmdc052,g_xmdc_d[g_detail_idx].xmdc049,g_xmdc_d[g_detail_idx].xmdc053, 
                       g_xmdc_d[g_detail_idx].xmdc050)
      #add-point:insert_b段資料新增中
      {<point name="insert_b.m_insert"/>}
      #end add-point 
      IF SQLCA.sqlcode THEN
         CALL cl_err("xmdc_t",SQLCA.sqlcode,0)
      END IF
      #add-point:insert_b段資料新增後
      {<point name="insert_b.after_insert"/>}
      #end add-point 
   END IF
   
   LET ls_group = "'2',"
   #判斷是否是同一群組的table
   IF ls_group.getIndexOf(ps_page,1) > 0 THEN
      #add-point:insert_b段資料新增前
      {<point name="insert_b.before_insert2" mark="Y"/>}
      #end add-point 
      INSERT INTO xmdd_t
                  (xmddent,
                   xmdddocno,
                   xmddseq,xmddseq1,xmddseq2
                   ,xmdd229,xmdd003,xmdd001,xmdd002,xmdd200,xmdd004,xmdd005,xmdd011,xmdd012,xmdd006,xmdd201,xmdd202,xmdd024,xmdd025,xmdd026,xmdd027,xmdd203,xmdd204,xmdd205,xmdd206,xmdd029,xmdd028,xmdd019,xmdd030,xmdd207,xmddunit,xmdd210,xmdd212,xmdd213,xmdd214,xmdd215,xmdd031,xmdd014,xmdd015,xmdd016,xmdd017,xmdd221,xmddsite,xmdd218,xmdd219,xmdd220,xmdd222,xmdd223,xmdd224,xmddorga,xmdd226,xmdd227,xmdd228,xmdd013,xmdd009,xmdd018,xmdd020,xmdd021,xmdd022,xmdd023) 
            VALUES(g_enterprise,
                   ps_keys[1],ps_keys[2],ps_keys[3],ps_keys[4]
                   ,g_xmdc3_d[g_detail_idx].xmdd229,g_xmdc3_d[g_detail_idx].xmdd003,g_xmdc3_d[g_detail_idx].xmdd001, 
                       g_xmdc3_d[g_detail_idx].xmdd002,g_xmdc3_d[g_detail_idx].xmdd200,g_xmdc3_d[g_detail_idx].xmdd004, 
                       g_xmdc3_d[g_detail_idx].xmdd005,g_xmdc3_d[g_detail_idx].xmdd011,g_xmdc3_d[g_detail_idx].xmdd012, 
                       g_xmdc3_d[g_detail_idx].xmdd006,g_xmdc3_d[g_detail_idx].xmdd201,g_xmdc3_d[g_detail_idx].xmdd202, 
                       g_xmdc3_d[g_detail_idx].xmdd024,g_xmdc3_d[g_detail_idx].xmdd025,g_xmdc3_d[g_detail_idx].xmdd026, 
                       g_xmdc3_d[g_detail_idx].xmdd027,g_xmdc3_d[g_detail_idx].xmdd203,g_xmdc3_d[g_detail_idx].xmdd204, 
                       g_xmdc3_d[g_detail_idx].xmdd205,g_xmdc3_d[g_detail_idx].xmdd206,g_xmdc3_d[g_detail_idx].xmdd029, 
                       g_xmdc3_d[g_detail_idx].xmdd028,g_xmdc3_d[g_detail_idx].xmdd019,g_xmdc3_d[g_detail_idx].xmdd030, 
                       g_xmdc3_d[g_detail_idx].xmdd207,g_xmdc3_d[g_detail_idx].xmddunit,g_xmdc3_d[g_detail_idx].xmdd210, 
                       g_xmdc3_d[g_detail_idx].xmdd212,g_xmdc3_d[g_detail_idx].xmdd213,g_xmdc3_d[g_detail_idx].xmdd214, 
                       g_xmdc3_d[g_detail_idx].xmdd215,g_xmdc3_d[g_detail_idx].xmdd031,g_xmdc3_d[g_detail_idx].xmdd014, 
                       g_xmdc3_d[g_detail_idx].xmdd015,g_xmdc3_d[g_detail_idx].xmdd016,g_xmdc3_d[g_detail_idx].xmdd017, 
                       g_xmdc3_d[g_detail_idx].xmdd221,g_xmdc3_d[g_detail_idx].xmddsite,g_xmdc3_d[g_detail_idx].xmdd218, 
                       g_xmdc3_d[g_detail_idx].xmdd219,g_xmdc3_d[g_detail_idx].xmdd220,g_xmdc3_d[g_detail_idx].xmdd222, 
                       g_xmdc3_d[g_detail_idx].xmdd223,g_xmdc3_d[g_detail_idx].xmdd224,g_xmdc3_d[g_detail_idx].xmddorga, 
                       g_xmdc3_d[g_detail_idx].xmdd226,g_xmdc3_d[g_detail_idx].xmdd227,g_xmdc3_d[g_detail_idx].xmdd228, 
                       g_xmdc3_d[g_detail_idx].xmdd013,g_xmdc3_d[g_detail_idx].xmdd009,g_xmdc3_d[g_detail_idx].xmdd018, 
                       g_xmdc3_d[g_detail_idx].xmdd020,g_xmdc3_d[g_detail_idx].xmdd021,g_xmdc3_d[g_detail_idx].xmdd022, 
                       g_xmdc3_d[g_detail_idx].xmdd023)
      #add-point:insert_b段資料新增中
      {<point name="insert_b.m_insert2"/>}
      #end add-point
      IF SQLCA.sqlcode THEN
         CALL cl_err("xmdd_t",SQLCA.sqlcode,0)
      END IF
      #add-point:insert_b段資料新增後
      {<point name="insert_b.after_insert2"/>}
      #end add-point
   END IF
 
   LET ls_group = "'3',"
   #判斷是否是同一群組的table
   IF ls_group.getIndexOf(ps_page,1) > 0 THEN
      #add-point:insert_b段資料新增前
      {<point name="insert_b.before_insert3" mark="Y"/>}
      #end add-point 
      INSERT INTO xmja_t
                  (xmjaent,
                   xmjadocno,
                   xmjaseq
                   ,xmjaunit,xmjasite,xmja001,xmja002,xmja003,xmja033,xmja004,xmja005,xmja006,xmja007,xmja011,xmja012,xmja013,xmja014,xmja015,xmja016,xmja017,xmja018,xmja008,xmja009,xmja010,xmja022,xmja019,xmja020,xmja021,xmja024,xmja025,xmja026,xmja027,xmja028,xmja029,xmja030,xmja031,xmja032,xmja034) 
            VALUES(g_enterprise,
                   ps_keys[1],ps_keys[2]
                   ,g_xmdc4_d[g_detail_idx].xmjaunit,g_xmdc4_d[g_detail_idx].xmjasite,g_xmdc4_d[g_detail_idx].xmja001, 
                       g_xmdc4_d[g_detail_idx].xmja002,g_xmdc4_d[g_detail_idx].xmja003,g_xmdc4_d[g_detail_idx].xmja033, 
                       g_xmdc4_d[g_detail_idx].xmja004,g_xmdc4_d[g_detail_idx].xmja005,g_xmdc4_d[g_detail_idx].xmja006, 
                       g_xmdc4_d[g_detail_idx].xmja007,g_xmdc4_d[g_detail_idx].xmja011,g_xmdc4_d[g_detail_idx].xmja012, 
                       g_xmdc4_d[g_detail_idx].xmja013,g_xmdc4_d[g_detail_idx].xmja014,g_xmdc4_d[g_detail_idx].xmja015, 
                       g_xmdc4_d[g_detail_idx].xmja016,g_xmdc4_d[g_detail_idx].xmja017,g_xmdc4_d[g_detail_idx].xmja018, 
                       g_xmdc4_d[g_detail_idx].xmja008,g_xmdc4_d[g_detail_idx].xmja009,g_xmdc4_d[g_detail_idx].xmja010, 
                       g_xmdc4_d[g_detail_idx].xmja022,g_xmdc4_d[g_detail_idx].xmja019,g_xmdc4_d[g_detail_idx].xmja020, 
                       g_xmdc4_d[g_detail_idx].xmja021,g_xmdc4_d[g_detail_idx].xmja024,g_xmdc4_d[g_detail_idx].xmja025, 
                       g_xmdc4_d[g_detail_idx].xmja026,g_xmdc4_d[g_detail_idx].xmja027,g_xmdc4_d[g_detail_idx].xmja028, 
                       g_xmdc4_d[g_detail_idx].xmja029,g_xmdc4_d[g_detail_idx].xmja030,g_xmdc4_d[g_detail_idx].xmja031, 
                       g_xmdc4_d[g_detail_idx].xmja032,g_xmdc4_d[g_detail_idx].xmja034)
      #add-point:insert_b段資料新增中
      {<point name="insert_b.m_insert3"/>}
      #end add-point
      IF SQLCA.sqlcode THEN
         CALL cl_err("xmja_t",SQLCA.sqlcode,0)
      END IF
      #add-point:insert_b段資料新增後
      {<point name="insert_b.after_insert3"/>}
      #end add-point
   END IF
 
   LET ls_group = "'4',"
   #判斷是否是同一群組的table
   IF ls_group.getIndexOf(ps_page,1) > 0 THEN
      #add-point:insert_b段資料新增前
      {<point name="insert_b.before_insert4" mark="Y"/>}
      #end add-point 
      INSERT INTO xmdb_t
                  (xmdbent,
                   xmdbdocno,
                   xmdb001
                   ,xmdbsite,xmdb002,xmdb003,xmdb004,xmdb005,xmdb006,xmdb007,xmdb008,xmdb009) 
            VALUES(g_enterprise,
                   ps_keys[1],ps_keys[2]
                   ,g_xmdc5_d[g_detail_idx].xmdbsite,g_xmdc5_d[g_detail_idx].xmdb002,g_xmdc5_d[g_detail_idx].xmdb003, 
                       g_xmdc5_d[g_detail_idx].xmdb004,g_xmdc5_d[g_detail_idx].xmdb005,g_xmdc5_d[g_detail_idx].xmdb006, 
                       g_xmdc5_d[g_detail_idx].xmdb007,g_xmdc5_d[g_detail_idx].xmdb008,g_xmdc5_d[g_detail_idx].xmdb009) 

      #add-point:insert_b段資料新增中
      {<point name="insert_b.m_insert4"/>}
      #end add-point
      IF SQLCA.sqlcode THEN
         CALL cl_err("xmdb_t",SQLCA.sqlcode,0)
      END IF
      #add-point:insert_b段資料新增後
      {<point name="insert_b.after_insert4"/>}
      #end add-point
   END IF
 
   LET ls_group = "'5',"
   #判斷是否是同一群組的table
   IF ls_group.getIndexOf(ps_page,1) > 0 THEN
      #add-point:insert_b段資料新增前
      {<point name="insert_b.before_insert5" mark="Y"/>}
      #end add-point 
      INSERT INTO xrcd_t
                  (xrcdent,
                   xrcddocno,
                   xrcdld,xrcdseq,xrcdseq2,xrcd007
                   ,xrcd002,xrcd003,xrcd006,xrcd004,xrcd104) 
            VALUES(g_enterprise,
                   ps_keys[1],ps_keys[2],ps_keys[3],ps_keys[4],ps_keys[5]
                   ,g_xmdc6_d[g_detail_idx].xrcd002,g_xmdc6_d[g_detail_idx].xrcd003,g_xmdc6_d[g_detail_idx].xrcd006, 
                       g_xmdc6_d[g_detail_idx].xrcd004,g_xmdc6_d[g_detail_idx].xrcd104)
      #add-point:insert_b段資料新增中
      {<point name="insert_b.m_insert5"/>}
      #end add-point
      IF SQLCA.sqlcode THEN
         CALL cl_err("xrcd_t",SQLCA.sqlcode,0)
      END IF
      #add-point:insert_b段資料新增後
      {<point name="insert_b.after_insert5"/>}
      #end add-point
   END IF
 
 
   
 
   
   #add-point:insert_b段other
   {<point name="insert_b.other"/>}
   #end add-point     
   
END FUNCTION
]]>
  </section>
  <section id="adbt500.lock_b" ver="20" status="" src="s">
    <![CDATA[#+ 連動lock其他單身table資料
PRIVATE FUNCTION adbt500_lock_b(ps_table,ps_page)
   DEFINE ps_page     STRING
   DEFINE ps_table    STRING
   DEFINE ls_group    STRING
   #add-point:lock_b段define
   {<point name="lock_b.define"/>}
   #end add-point   
   
   #先刷新資料
   #CALL adbt500_b_fill()
   
   #鎖定整組table
   #LET ls_group = "'1',"
   #僅鎖定自身table
   LET ls_group = "xmdc_t"
   
   IF ls_group.getIndexOf(ps_table,1) THEN
      OPEN adbt500_bcl USING g_enterprise,
                                       g_xmda_m.xmdadocno,g_xmdc_d[g_detail_idx].xmdcseq     
      IF SQLCA.sqlcode THEN
         CALL cl_err("adbt500_bcl",SQLCA.sqlcode,1)
         RETURN FALSE
      END IF
   END IF
                                    
   #鎖定整組table
   #LET ls_group = "'2',"
   #僅鎖定自身table
   LET ls_group = "xmdd_t"
   IF ls_group.getIndexOf(ps_table,1) THEN
   
      OPEN adbt500_bcl2 USING g_enterprise,
                                             g_xmda_m.xmdadocno,g_xmdc3_d[g_detail_idx].xmddseq,g_xmdc3_d[g_detail_idx].xmddseq1, 
                                                 g_xmdc3_d[g_detail_idx].xmddseq2
      IF SQLCA.sqlcode THEN
         CALL cl_err("adbt500_bcl2",SQLCA.sqlcode,1)
         RETURN FALSE
      END IF
   END IF
 
   #鎖定整組table
   #LET ls_group = "'3',"
   #僅鎖定自身table
   LET ls_group = "xmja_t"
   IF ls_group.getIndexOf(ps_table,1) THEN
   
      OPEN adbt500_bcl3 USING g_enterprise,
                                             g_xmda_m.xmdadocno,g_xmdc4_d[g_detail_idx].xmjaseq
      IF SQLCA.sqlcode THEN
         CALL cl_err("adbt500_bcl3",SQLCA.sqlcode,1)
         RETURN FALSE
      END IF
   END IF
 
   #鎖定整組table
   #LET ls_group = "'4',"
   #僅鎖定自身table
   LET ls_group = "xmdb_t"
   IF ls_group.getIndexOf(ps_table,1) THEN
   
      OPEN adbt500_bcl4 USING g_enterprise,
                                             g_xmda_m.xmdadocno,g_xmdc5_d[g_detail_idx].xmdb001
      IF SQLCA.sqlcode THEN
         CALL cl_err("adbt500_bcl4",SQLCA.sqlcode,1)
         RETURN FALSE
      END IF
   END IF
 
   #鎖定整組table
   #LET ls_group = "'5',"
   #僅鎖定自身table
   LET ls_group = "xrcd_t"
   IF ls_group.getIndexOf(ps_table,1) THEN
   
      OPEN adbt500_bcl5 USING g_enterprise,
                                             g_xmda_m.xmdadocno,g_xmdc6_d[g_detail_idx].xrcdld,g_xmdc6_d[g_detail_idx].xrcdseq, 
                                                 g_xmdc6_d[g_detail_idx].xrcdseq2,g_xmdc6_d[g_detail_idx].xrcd007 

      IF SQLCA.sqlcode THEN
         CALL cl_err("adbt500_bcl5",SQLCA.sqlcode,1)
         RETURN FALSE
      END IF
   END IF
 
 
   
 
   
   #add-point:lock_b段other
   {<point name="lock_b.other"/>}
   #end add-point  
   
   RETURN TRUE
 
END FUNCTION
]]>
  </section>
  <section id="adbt500.main" ver="47" status="" src="s">
    <![CDATA[#+ 此段落由子樣板a26產生
#OPTIONS SHORT CIRCUIT
#+ 作業開始 
MAIN
   #add-point:main段define
   {<point name="main.define"/>}
   #end add-point   
 
   OPTIONS
   INPUT NO WRAP
   DEFER INTERRUPT
   
   #設定SQL錯誤記錄方式 (模組內定義有效)
   WHENEVER ERROR CALL cl_err_msg_log
       
   #依模組進行系統初始化設定(系統設定)
   CALL cl_ap_init("adb","")
 
   #add-point:作業初始化
   {<point name="main.init" />}
   #end add-point
   
   
 
   #LOCK CURSOR (identifier)
   #add-point:SQL_define
   {<point name="main.define_sql" />}
   #end add-point
   LET g_forupd_sql = " SELECT xmdasite,'',xmdadocdt,xmdadocno,xmda001,'',xmda005,xmda202,'',xmda023, 
       '',xmda004,'',xmda200,'',xmda201,'',xmdastus,xmda007,xmda008,xmda021,'',xmda022,'',xmda203,'', 
       xmda027,'',xmda024,'',xmda002,'',xmda003,'',xmdaunit,'',xmda204,'',xmda205,xmda032,'',xmda071, 
       xmda025,'','',xmda026,'','',xmda206,'',xmda207,'',xmda020,'',xmda036,'',xmda009,'',xmda010,'', 
       xmda015,'',xmda016,xmda011,'',xmda012,xmda013,xmda035,'','',xmda039,xmdaownid,'',xmdaowndp,'', 
       xmdacrtid,'',xmdacrtdp,'',xmdacrtdt,xmdamodid,'',xmdamoddt,xmdacnfid,'',xmdacnfdt,xmda034,'', 
       xmda006,xmda033,xmda017,'',xmda019,xmda018,'',xmda044,xmda030,xmda031,xmda045,xmda046,xmda047, 
       xmda028,xmda041,xmda042,xmda043", 
                      " FROM xmda_t",
                      " WHERE xmdaent= ? AND xmdadocno=? FOR UPDATE"
   #add-point:SQL_define
   {<point name="main.after_define_sql"/>}
   #end add-point
   LET g_forupd_sql = cl_sql_forupd(g_forupd_sql)                #轉換不同資料庫語法
   LET g_forupd_sql = cl_sql_add_mask(g_forupd_sql)              #遮蔽特定資料
   DECLARE adbt500_cl CURSOR FROM g_forupd_sql                 # LOCK CURSOR
 
   LET g_sql = " SELECT UNIQUE xmdasite,xmdadocdt,xmdadocno,xmda001,xmda005,xmda202,xmda023,xmda004, 
       xmda200,xmda201,xmdastus,xmda007,xmda008,xmda021,xmda022,xmda203,xmda027,xmda024,xmda002,xmda003, 
       xmdaunit,xmda204,xmda205,xmda032,xmda071,xmda025,xmda026,xmda206,xmda207,xmda020,xmda036,xmda009, 
       xmda010,xmda015,xmda016,xmda011,xmda012,xmda013,xmda035,xmda039,xmdaownid,xmdaowndp,xmdacrtid, 
       xmdacrtdp,xmdacrtdt,xmdamodid,xmdamoddt,xmdacnfid,xmdacnfdt,xmda034,xmda006,xmda033,xmda017,xmda019, 
       xmda018,xmda044,xmda030,xmda031,xmda045,xmda046,xmda047,xmda028,xmda041,xmda042,xmda043,t1.ooefl003 , 
       t2.ooefl003 ,t3.oojdl003 ,t4.pmaal004 ,t5.pmaal004 ,t6.pmaal004 ,t7.pmaal004 ,t8.pmaal004 ,t9.pmaal004 , 
       t10.oofa011 ,t11.oocql004 ,t12.ooag011 ,t13.ooefl003 ,t14.ooefl003 ,t15.prcfl003 ,t16.oocql004 , 
       t17.dbadl003 ,t18.dbabl003 ,t19.oocql004 ,t20.pmaal004 ,t21.ooibl004 ,t22.oocql004 ,t23.ooail003 , 
       t24.ooag011 ,t25.ooefl003 ,t26.ooag011 ,t27.ooefl003 ,t28.ooag011 ,t29.ooag011 ,t30.pmaal003 , 
       t31.pmaml003 ,t32.ooidl003",
               " FROM xmda_t",
                              " LEFT JOIN ooefl_t t1 ON t1.ooeflent='"||g_enterprise||"' AND t1.ooefl001=xmdasite AND t1.ooefl002='"||g_dlang||"' ",
               " LEFT JOIN ooefl_t t2 ON t2.ooeflent='"||g_enterprise||"' AND t2.ooefl001=xmda202 AND t2.ooefl002='"||g_dlang||"' ",
               " LEFT JOIN oojdl_t t3 ON t3.oojdlent='"||g_enterprise||"' AND t3.oojdl001=xmda023 AND t3.oojdl002='"||g_dlang||"' ",
               " LEFT JOIN pmaal_t t4 ON t4.pmaalent='"||g_enterprise||"' AND t4.pmaal001=xmda004 AND t4.pmaal002='"||g_dlang||"' ",
               " LEFT JOIN pmaal_t t5 ON t5.pmaalent='"||g_enterprise||"' AND t5.pmaal001=xmda200 AND t5.pmaal002='"||g_dlang||"' ",
               " LEFT JOIN pmaal_t t6 ON t6.pmaalent='"||g_enterprise||"' AND t6.pmaal001=xmda201 AND t6.pmaal002='"||g_dlang||"' ",
               " LEFT JOIN pmaal_t t7 ON t7.pmaalent='"||g_enterprise||"' AND t7.pmaal001=xmda021 AND t7.pmaal002='"||g_dlang||"' ",
               " LEFT JOIN pmaal_t t8 ON t8.pmaalent='"||g_enterprise||"' AND t8.pmaal001=xmda022 AND t8.pmaal002='"||g_dlang||"' ",
               " LEFT JOIN pmaal_t t9 ON t9.pmaalent='"||g_enterprise||"' AND t9.pmaal001=xmda203 AND t9.pmaal002='"||g_dlang||"' ",
               " LEFT JOIN oofa_t t10 ON t10.oofaent='"||g_enterprise||"' AND t10.oofa001=xmda027  ",
               " LEFT JOIN oocql_t t11 ON t11.oocqlent='"||g_enterprise||"' AND t11.oocql001='295' AND t11.oocql002=xmda024 AND t11.oocql003='"||g_dlang||"' ",
               " LEFT JOIN ooag_t t12 ON t12.ooagent='"||g_enterprise||"' AND t12.ooag001=xmda002  ",
               " LEFT JOIN ooefl_t t13 ON t13.ooeflent='"||g_enterprise||"' AND t13.ooefl001=xmda003 AND t13.ooefl002='"||g_dlang||"' ",
               " LEFT JOIN ooefl_t t14 ON t14.ooeflent='"||g_enterprise||"' AND t14.ooefl001=xmdaunit AND t14.ooefl002='"||g_dlang||"' ",
               " LEFT JOIN prcfl_t t15 ON t15.prcflent='"||g_enterprise||"' AND t15.prcfl001=xmda204 AND t15.prcfl002='"||g_dlang||"' ",
               " LEFT JOIN oocql_t t16 ON t16.oocqlent='"||g_enterprise||"' AND t16.oocql001='297' AND t16.oocql002=xmda032 AND t16.oocql003='"||g_dlang||"' ",
               " LEFT JOIN dbadl_t t17 ON t17.dbadlent='"||g_enterprise||"' AND t17.dbadl001=xmda206 AND t17.dbadl002='"||g_dlang||"' ",
               " LEFT JOIN dbabl_t t18 ON t18.dbablent='"||g_enterprise||"' AND t18.dbabl001=xmda207 AND t18.dbabl002='"||g_dlang||"' ",
               " LEFT JOIN oocql_t t19 ON t19.oocqlent='"||g_enterprise||"' AND t19.oocql001='263' AND t19.oocql002=xmda020 AND t19.oocql003='"||g_dlang||"' ",
               " LEFT JOIN pmaal_t t20 ON t20.pmaalent='"||g_enterprise||"' AND t20.pmaal001=xmda036 AND t20.pmaal002='"||g_dlang||"' ",
               " LEFT JOIN ooibl_t t21 ON t21.ooiblent='"||g_enterprise||"' AND t21.ooibl002=xmda009 AND t21.ooibl003='"||g_dlang||"' ",
               " LEFT JOIN oocql_t t22 ON t22.oocqlent='"||g_enterprise||"' AND t22.oocql001='238' AND t22.oocql002=xmda010 AND t22.oocql003='"||g_dlang||"' ",
               " LEFT JOIN ooail_t t23 ON t23.ooailent='"||g_enterprise||"' AND t23.ooail001=xmda015 AND t23.ooail002='"||g_dlang||"' ",
               " LEFT JOIN ooag_t t24 ON t24.ooagent='"||g_enterprise||"' AND t24.ooag001=xmdaownid  ",
               " LEFT JOIN ooefl_t t25 ON t25.ooeflent='"||g_enterprise||"' AND t25.ooefl001=xmdaowndp AND t25.ooefl002='"||g_dlang||"' ",
               " LEFT JOIN ooag_t t26 ON t26.ooagent='"||g_enterprise||"' AND t26.ooag001=xmdacrtid  ",
               " LEFT JOIN ooefl_t t27 ON t27.ooeflent='"||g_enterprise||"' AND t27.ooefl001=xmdacrtdp AND t27.ooefl002='"||g_dlang||"' ",
               " LEFT JOIN ooag_t t28 ON t28.ooagent='"||g_enterprise||"' AND t28.ooag001=xmdamodid  ",
               " LEFT JOIN ooag_t t29 ON t29.ooagent='"||g_enterprise||"' AND t29.ooag001=xmdacnfid  ",
               " LEFT JOIN pmaal_t t30 ON t30.pmaalent='"||g_enterprise||"' AND t30.pmaal001=xmda034 AND t30.pmaal002='"||g_dlang||"' ",
               " LEFT JOIN pmaml_t t31 ON t31.pmamlent='"||g_enterprise||"' AND t31.pmaml001=xmda017 AND t31.pmaml002='"||g_dlang||"' ",
               " LEFT JOIN ooidl_t t32 ON t32.ooidlent='"||g_enterprise||"' AND t32.ooidl001=xmda018 AND t32.ooidl002='"||g_dlang||"' ",
 
               " WHERE xmdaent = '" ||g_enterprise|| "' AND xmdadocno = ?"
   LET g_sql = cl_sql_add_mask(g_sql)              #遮蔽特定資料
   #add-point:SQL_define
   {<point name="main.after_refresh_sql"/>}
   #end add-point
   PREPARE adbt500_master_referesh FROM g_sql
 
 
 
   
   IF g_bgjob = "Y" THEN
      #add-point:Service Call
      {<point name="main.servicecall" />}
      #end add-point
   ELSE
      #畫面開啟 (identifier)
      OPEN WINDOW w_adbt500 WITH FORM cl_ap_formpath("adb",g_code)
   
      #瀏覽頁簽資料初始化
      CALL cl_ui_init()
   
      #程式初始化
      CALL adbt500_init()   
 
      #進入選單 Menu (="N")
      CALL adbt500_ui_dialog() 
      
      #add-point:畫面關閉前
      {<point name="main.before_close" />}
      #end add-point
 
      #畫面關閉
      CLOSE WINDOW w_adbt500
      
   END IF 
   
   CLOSE adbt500_cl
   
   
 
   #add-point:作業離開前
   {<point name="main.exit" />}
   #end add-point
 
   #離開作業
   CALL cl_ap_exitprogram("0")
   
END MAIN
 
 
]]>
  </section>
  <section id="adbt500.modify" ver="59" status="" src="s">
    <![CDATA[#+ 資料修改
PRIVATE FUNCTION adbt500_modify()
   DEFINE l_new_key    DYNAMIC ARRAY OF STRING
   DEFINE l_old_key    DYNAMIC ARRAY OF STRING
   DEFINE l_field_key  DYNAMIC ARRAY OF STRING
   #add-point:modify段define
   {<point name="modify.define"/>}
   #end add-point    
   
   IF g_xmda_m.xmdadocno IS NULL
 
   THEN
      CALL cl_err("","std-00003",0)
      RETURN
   END IF
 
   ERROR ""
  
   LET g_xmdadocno_t = g_xmda_m.xmdadocno
 
   CALL s_transaction_begin()
   
   OPEN adbt500_cl USING g_enterprise,g_xmda_m.xmdadocno
   IF STATUS THEN
      CALL cl_err("OPEN adbt500_cl:", STATUS, 1)
      CLOSE adbt500_cl
      CALL s_transaction_end('N','0')
      RETURN
   END IF
 
   #顯示最新的資料
   EXECUTE adbt500_master_referesh USING g_xmda_m.xmdadocno INTO g_xmda_m.xmdasite,g_xmda_m.xmdadocdt, 
       g_xmda_m.xmdadocno,g_xmda_m.xmda001,g_xmda_m.xmda005,g_xmda_m.xmda202,g_xmda_m.xmda023,g_xmda_m.xmda004, 
       g_xmda_m.xmda200,g_xmda_m.xmda201,g_xmda_m.xmdastus,g_xmda_m.xmda007,g_xmda_m.xmda008,g_xmda_m.xmda021, 
       g_xmda_m.xmda022,g_xmda_m.xmda203,g_xmda_m.xmda027,g_xmda_m.xmda024,g_xmda_m.xmda002,g_xmda_m.xmda003, 
       g_xmda_m.xmdaunit,g_xmda_m.xmda204,g_xmda_m.xmda205,g_xmda_m.xmda032,g_xmda_m.xmda071,g_xmda_m.xmda025, 
       g_xmda_m.xmda026,g_xmda_m.xmda206,g_xmda_m.xmda207,g_xmda_m.xmda020,g_xmda_m.xmda036,g_xmda_m.xmda009, 
       g_xmda_m.xmda010,g_xmda_m.xmda015,g_xmda_m.xmda016,g_xmda_m.xmda011,g_xmda_m.xmda012,g_xmda_m.xmda013, 
       g_xmda_m.xmda035,g_xmda_m.xmda039,g_xmda_m.xmdaownid,g_xmda_m.xmdaowndp,g_xmda_m.xmdacrtid,g_xmda_m.xmdacrtdp, 
       g_xmda_m.xmdacrtdt,g_xmda_m.xmdamodid,g_xmda_m.xmdamoddt,g_xmda_m.xmdacnfid,g_xmda_m.xmdacnfdt, 
       g_xmda_m.xmda034,g_xmda_m.xmda006,g_xmda_m.xmda033,g_xmda_m.xmda017,g_xmda_m.xmda019,g_xmda_m.xmda018, 
       g_xmda_m.xmda044,g_xmda_m.xmda030,g_xmda_m.xmda031,g_xmda_m.xmda045,g_xmda_m.xmda046,g_xmda_m.xmda047, 
       g_xmda_m.xmda028,g_xmda_m.xmda041,g_xmda_m.xmda042,g_xmda_m.xmda043,g_xmda_m.xmdasite_desc,g_xmda_m.xmda202_desc, 
       g_xmda_m.xmda023_desc,g_xmda_m.xmda004_desc,g_xmda_m.xmda200_desc,g_xmda_m.xmda201_desc,g_xmda_m.xmda021_desc, 
       g_xmda_m.xmda022_desc,g_xmda_m.xmda203_desc,g_xmda_m.xmda027_desc,g_xmda_m.xmda024_desc,g_xmda_m.xmda002_desc, 
       g_xmda_m.xmda003_desc,g_xmda_m.xmdaunit_desc,g_xmda_m.xmda204_desc,g_xmda_m.xmda032_desc,g_xmda_m.xmda206_desc, 
       g_xmda_m.xmda207_desc,g_xmda_m.xmda020_desc,g_xmda_m.xmda036_desc,g_xmda_m.xmda009_desc,g_xmda_m.xmda010_desc, 
       g_xmda_m.xmda015_desc,g_xmda_m.xmdaownid_desc,g_xmda_m.xmdaowndp_desc,g_xmda_m.xmdacrtid_desc, 
       g_xmda_m.xmdacrtdp_desc,g_xmda_m.xmdamodid_desc,g_xmda_m.xmdacnfid_desc,g_xmda_m.xmda034_desc, 
       g_xmda_m.xmda017_desc,g_xmda_m.xmda018_desc
 
   #資料被他人LOCK, 或是sql執行時出現錯誤
   IF SQLCA.sqlcode THEN
      CALL cl_err(g_xmda_m.xmdadocno,SQLCA.sqlcode,0)
      CLOSE adbt500_cl
      CALL s_transaction_end('N','0')
      RETURN
   END IF
   
   
   
   #add-point:modify段show之前
   {<point name="modify.before_show"/>}
   #end add-point  
   
   CALL adbt500_show()
   WHILE TRUE
      LET g_xmdadocno_t = g_xmda_m.xmdadocno
 
      
      #寫入修改者/修改日期資訊(單頭)
      LET g_xmda_m.xmdamodid = g_user 
LET g_xmda_m.xmdamoddt = cl_get_current()
 
      
      #add-point:modify段修改前
      {<point name="modify.before_input"/>}
      #end add-point
      
      #欄位更改
      CALL adbt500_input("u")
 
      #add-point:modify段修改後
      {<point name="modify.after_input"/>}
      #end add-point
      
      IF INT_FLAG THEN
         LET INT_FLAG = 0
         LET g_xmda_m.* = g_xmda_m_t.*
         CALL adbt500_show()
         CALL cl_err('',9001,0)
         CALL s_transaction_end('N','0')
         EXIT WHILE
      END IF 
      
      #若有modid跟moddt則進行update
      UPDATE xmda_t SET (xmdamodid,xmdamoddt) = (g_xmda_m.xmdamodid,g_xmda_m.xmdamoddt)
       WHERE xmdaent = g_enterprise AND xmdadocno = g_xmdadocno_t
 
                  
      #若單頭key欄位有變更
      IF g_xmda_m.xmdadocno != g_xmdadocno_t 
 
      THEN
         CALL s_transaction_begin()
         
         #add-point:單身fk修改前
         {<point name="modify.body.b_fk_update" mark="Y"/>}
         #end add-point
         
         #更新單身key值
         UPDATE xmdc_t SET xmdcdocno = g_xmda_m.xmdadocno
 
          WHERE xmdcent = g_enterprise AND xmdcdocno = g_xmdadocno_t
 
            
         #add-point:單身fk修改中
         {<point name="modify.body.m_fk_update"/>}
         #end add-point
 
         CASE
            WHEN SQLCA.sqlerrd[3] = 0  #更新不到的處理
               CALL cl_err("xmdc_t","std-00009",1)
               CALL s_transaction_end('N','0')
               CONTINUE WHILE
            WHEN SQLCA.sqlcode #其他錯誤
               CALL cl_err("xmdc_t",SQLCA.sqlcode,1)  
               CALL s_transaction_end('N','0')
               CONTINUE WHILE
         END CASE
         
         #add-point:單身fk修改後
         {<point name="modify.body.a_fk_update"/>}
         #end add-point
         
         #更新單身key值
         #add-point:單身fk修改前
         {<point name="modify.body.b_fk_update2" mark="Y"/>}
         #end add-point
         UPDATE xmdd_t
            SET xmdddocno = g_xmda_m.xmdadocno
 
          WHERE xmddent = g_enterprise AND
                xmdddocno = g_xmdadocno_t
 
         #add-point:單身fk修改中
         {<point name="modify.body.m_fk_update2"/>}
         #end add-point
         CASE
            WHEN SQLCA.sqlerrd[3] = 0  #更新不到的處理
               CALL cl_err("xmdd_t","std-00009",1)
               CALL s_transaction_end('N','0')
               CONTINUE WHILE
            WHEN SQLCA.sqlcode #其他錯誤
               CALL cl_err("xmdd_t",SQLCA.sqlcode,1)  
               CALL s_transaction_end('N','0')
               CONTINUE WHILE
         END CASE
         #add-point:單身fk修改後
         {<point name="modify.body.a_fk_update2"/>}
         #end add-point
 
         #更新單身key值
         #add-point:單身fk修改前
         {<point name="modify.body.b_fk_update3" mark="Y"/>}
         #end add-point
         UPDATE xmja_t
            SET xmjadocno = g_xmda_m.xmdadocno
 
          WHERE xmjaent = g_enterprise AND
                xmjadocno = g_xmdadocno_t
 
         #add-point:單身fk修改中
         {<point name="modify.body.m_fk_update3"/>}
         #end add-point
         CASE
            WHEN SQLCA.sqlerrd[3] = 0  #更新不到的處理
               CALL cl_err("xmja_t","std-00009",1)
               CALL s_transaction_end('N','0')
               CONTINUE WHILE
            WHEN SQLCA.sqlcode #其他錯誤
               CALL cl_err("xmja_t",SQLCA.sqlcode,1)  
               CALL s_transaction_end('N','0')
               CONTINUE WHILE
         END CASE
         #add-point:單身fk修改後
         {<point name="modify.body.a_fk_update3"/>}
         #end add-point
 
         #更新單身key值
         #add-point:單身fk修改前
         {<point name="modify.body.b_fk_update4" mark="Y"/>}
         #end add-point
         UPDATE xmdb_t
            SET xmdbdocno = g_xmda_m.xmdadocno
 
          WHERE xmdbent = g_enterprise AND
                xmdbdocno = g_xmdadocno_t
 
         #add-point:單身fk修改中
         {<point name="modify.body.m_fk_update4"/>}
         #end add-point
         CASE
            WHEN SQLCA.sqlerrd[3] = 0  #更新不到的處理
               CALL cl_err("xmdb_t","std-00009",1)
               CALL s_transaction_end('N','0')
               CONTINUE WHILE
            WHEN SQLCA.sqlcode #其他錯誤
               CALL cl_err("xmdb_t",SQLCA.sqlcode,1)  
               CALL s_transaction_end('N','0')
               CONTINUE WHILE
         END CASE
         #add-point:單身fk修改後
         {<point name="modify.body.a_fk_update4"/>}
         #end add-point
 
         #更新單身key值
         #add-point:單身fk修改前
         {<point name="modify.body.b_fk_update5" mark="Y"/>}
         #end add-point
         UPDATE xrcd_t
            SET xrcddocno = g_xmda_m.xmdadocno
 
          WHERE xrcdent = g_enterprise AND
                xrcddocno = g_xmdadocno_t
 
         #add-point:單身fk修改中
         {<point name="modify.body.m_fk_update5"/>}
         #end add-point
         CASE
            WHEN SQLCA.sqlerrd[3] = 0  #更新不到的處理
               CALL cl_err("xrcd_t","std-00009",1)
               CALL s_transaction_end('N','0')
               CONTINUE WHILE
            WHEN SQLCA.sqlcode #其他錯誤
               CALL cl_err("xrcd_t",SQLCA.sqlcode,1)  
               CALL s_transaction_end('N','0')
               CONTINUE WHILE
         END CASE
         #add-point:單身fk修改後
         {<point name="modify.body.a_fk_update5"/>}
         #end add-point
 
 
         
 
         
         #UPDATE 多語言table key值
         
         
         
         
         
 
         CALL s_transaction_end('Y','0')
      END IF
    
      EXIT WHILE
   END WHILE
 
   #修改歷程記錄
   #IF NOT cl_log_modified_record(g_xmda_m.xmdadocno,g_site) THEN 
   #   CALL s_transaction_end('N','0')
   #END IF
 
   CLOSE adbt500_cl
   CALL s_transaction_end('Y','0')
 
   #流程通知預埋點-U
   CALL cl_flow_notify(g_xmda_m.xmdadocno,'U')
 
END FUNCTION   
]]>
  </section>
  <section id="adbt500.other_dialog" ver="2" status="" src="s">
    <![CDATA[   
]]>
  </section>
  <section id="adbt500.other_function" ver="2" status="" src="s">
    <![CDATA[{<point name="other.function"/>}
]]>
  </section>
  <section id="adbt500.query" ver="19" status="" src="s">
    <![CDATA[#+ 資料查詢QBE功能準備
PRIVATE FUNCTION adbt500_query()
   DEFINE ls_wc STRING
   #add-point:query段define
   {<point name="query.define"/>}
   #end add-point   
 
   #切換畫面
   IF g_main_hidden THEN
      CALL gfrm_curr.setElementHidden("mainlayout",0)
      CALL gfrm_curr.setElementHidden("worksheet",1)
      LET g_main_hidden = 0
   END IF   
   
   LET ls_wc = g_wc
   
   LET INT_FLAG = 0
   CALL cl_navigator_setting( g_current_idx, g_detail_cnt )
   ERROR ""
   
   #清除畫面及相關資料
   CLEAR FORM
   CALL g_browser.clear()       
   CALL g_xmdc_d.clear()
   CALL g_xmdc3_d.clear()
   CALL g_xmdc4_d.clear()
   CALL g_xmdc5_d.clear()
   CALL g_xmdc6_d.clear()
 
   
   #add-point:query段other
   {<point name="query.other"/>}
   #end add-point   
   
   DISPLAY ' ' TO FORMONLY.idx
   DISPLAY ' ' TO FORMONLY.cnt
   DISPLAY ' ' TO FORMONLY.b_index
   DISPLAY ' ' TO FORMONLY.b_count
   DISPLAY ' ' TO FORMONLY.h_index
   DISPLAY ' ' TO FORMONLY.h_count
   
   CALL adbt500_construct()
 
   IF INT_FLAG THEN
      #取消查詢
      LET INT_FLAG = 0
      LET g_wc = ls_wc
      CALL adbt500_browser_fill("")
      CALL adbt500_fetch("")
      RETURN
   END IF
   
   #儲存WC資訊
   CALL cl_dlg_save_user_latestqry("("||g_wc||") AND ("||g_wc2||")")
   
   #搜尋後資料初始化 
   LET g_detail_cnt  = 0
   LET g_current_idx = 1
   LET g_current_row = 0
   LET g_detail_idx  = 1
   LET g_detail_idx2 = 1
   LET g_error_show  = 1
   LET g_wc_filter   = ""
   LET l_ac = 1
   CALL FGL_SET_ARR_CURR(1)
      CALL adbt500_filter_show('xmdadocno')
   CALL adbt500_filter_show('xmdadocdt')
   CALL adbt500_filter_show('xmda001')
   CALL adbt500_filter_show('xmda002')
   CALL adbt500_filter_show('xmda003')
   CALL adbt500_filter_show('xmda004')
   CALL adbt500_browser_fill("F")
         
   IF g_browser_cnt = 0 THEN
      CALL cl_err("","-100",1)
   ELSE
      CALL adbt500_fetch("F") 
   END IF
 
END FUNCTION
]]>
  </section>
  <section id="adbt500.reproduce" ver="18" status="" src="s">
    <![CDATA[#+ 資料複製
PRIVATE FUNCTION adbt500_reproduce()
   DEFINE l_newno     LIKE xmda_t.xmdadocno 
   DEFINE l_oldno     LIKE xmda_t.xmdadocno 
 
   DEFINE l_master    RECORD LIKE xmda_t.*
   DEFINE l_detail    RECORD LIKE xmdc_t.*
   DEFINE l_detail2    RECORD LIKE xmdd_t.*
 
   DEFINE l_detail3    RECORD LIKE xmja_t.*
 
   DEFINE l_detail4    RECORD LIKE xmdb_t.*
 
   DEFINE l_detail5    RECORD LIKE xrcd_t.*
 
 
 
   DEFINE l_cnt       LIKE type_t.num5
   #add-point:reproduce段define
   {<point name="reproduce.define"/>}
   #end add-point   
 
   #切換畫面
   IF g_main_hidden THEN
      CALL gfrm_curr.setElementHidden("mainlayout",0)
      CALL gfrm_curr.setElementHidden("worksheet",1)
      LET g_main_hidden = 0
   END IF
   
   IF g_xmda_m.xmdadocno IS NULL
 
   THEN
      CALL cl_err("","std-00003",0)
      RETURN
   END IF
    
   LET g_xmdadocno_t = g_xmda_m.xmdadocno
 
    
   LET g_xmda_m.xmdadocno = ""
 
    
   CALL adbt500_set_entry('a')
   CALL adbt500_set_no_entry('a')
 
   CALL cl_set_head_visible("","YES")
 
   #公用欄位給予預設值
   #此段落由子樣板a14產生    
      LET g_xmda_m.xmdaownid = g_user
      LET g_xmda_m.xmdaowndp = g_dept
      LET g_xmda_m.xmdacrtid = g_user
      LET g_xmda_m.xmdacrtdp = g_dept 
      LET g_xmda_m.xmdacrtdt = cl_get_current()
      LET g_xmda_m.xmdamodid = ""
      LET g_xmda_m.xmdamoddt = ""
      LET g_xmda_m.xmdastus = "N"
 
 
   
   CALL s_transaction_begin()
   
   #add-point:複製輸入前
   {<point name="reproduce.head.b_input"/>}
   #end add-point
   
   CALL adbt500_input("r")
   
      LET g_xmda_m.xmdadocno_desc = ''
   DISPLAY BY NAME g_xmda_m.xmdadocno_desc
 
   
   IF INT_FLAG THEN
      LET INT_FLAG = 0
      RETURN
   END IF
   
   #將新增的資料併入搜尋條件中
   LET g_state = "Y"
   LET g_current_idx = 1 
   
   LET g_wc = "(",g_wc,  
              " OR (",
              " xmdadocno = '", g_xmda_m.xmdadocno CLIPPED, "' "
 
              , ")) "
   
   #add-point:完成複製段落後
   {<point name="reproduce.after_reproduce" />}
   #end add-point
   
END FUNCTION
]]>
  </section>
  <section id="adbt500.set_entry" ver="2" status="" src="s">
    <![CDATA[#+ 單頭欄位開啟設定
PRIVATE FUNCTION adbt500_set_entry(p_cmd)
   DEFINE p_cmd   LIKE type_t.chr1  
   #add-point:set_entry段define
   {<point name="set_entry.define"/>}
   #end add-point       
 
   IF p_cmd = 'a' THEN
      CALL cl_set_comp_entry("xmdadocno",TRUE)
      #add-point:set_entry段欄位控制
      {<point name="set_entry.field_control"/>}
      #end add-point  
   END IF
   
   #add-point:set_entry段欄位控制後
   {<point name="set_entry.after_control"/>}
   #end add-point 
 
END FUNCTION
]]>
  </section>
  <section id="adbt500.set_entry_b" ver="2" status="" src="s">
    <![CDATA[#+ 單身欄位開啟設定
PRIVATE FUNCTION adbt500_set_entry_b(p_cmd)
   DEFINE p_cmd   LIKE type_t.chr1   
   #add-point:set_entry_b段define
   {<point name="set_entry_b.define"/>}
   #end add-point     
   #add-point:set_entry_b段
   {<point name="set_entry_b.set_entry_b"/>}
   #end add-point  
END FUNCTION
]]>
  </section>
  <section id="adbt500.set_no_entry" ver="3" status="" src="s">
    <![CDATA[#+ 單頭欄位關閉設定
PRIVATE FUNCTION adbt500_set_no_entry(p_cmd)
   DEFINE p_cmd   LIKE type_t.chr1   
   #add-point:set_no_entry段define
   {<point name="set_no_entry.define"/>}
   #end add-point     
 
   IF p_cmd = 'u' AND g_chkey = 'N' THEN
      CALL cl_set_comp_entry("xmdadocno",FALSE)
      #add-point:set_no_entry段欄位控制
      {<point name="set_no_entry.field_control"/>}
      #end add-point 
   END IF 
   
   #add-point:set_no_entry段欄位控制後
   {<point name="set_no_entry.after_control"/>}
   #end add-point 
 
END FUNCTION
]]>
  </section>
  <section id="adbt500.set_no_entry_b" ver="2" status="" src="s">
    <![CDATA[#+ 單身欄位關閉設定
PRIVATE FUNCTION adbt500_set_no_entry_b(p_cmd)
   DEFINE p_cmd   LIKE type_t.chr1   
   #add-point:set_no_entry_b段define
   {<point name="set_no_entry_b.define"/>}
   #end add-point    
   #add-point:set_no_entry_b段
   {<point name="set_no_entry_b.set_no_entry_b"/>}
   #end add-point     
END FUNCTION
]]>
  </section>
  <section id="adbt500.set_pk_array" ver="1" status="" src="s">
    <![CDATA[   #+ 此段落由子樣板a51產生
#+ 給予pk_array內容
PRIVATE FUNCTION adbt500_set_pk_array()
   #add-point:set_pk_array段define
   {<point name="set_pk_array.define"/>}
   #end add-point
   
   #add-point:set_pk_array段之前
   {<point name="set_pk_array.before"/>}
   #end add-point  
   
   CALL g_pk_array.clear()
   LET g_pk_array[1].values = g_xmda_m.xmdadocno
   LET g_pk_array[1].column = 'xmdadocno'
 
   
   #add-point:set_pk_array段之後
   {<point name="set_pk_array.after"/>}
   #end add-point  
   
END FUNCTION
 
 
]]>
  </section>
  <section id="adbt500.show" ver="56" status="" src="s">
    <![CDATA[#+ 單頭資料重新顯示及單身資料重抓
PRIVATE FUNCTION adbt500_show()
   DEFINE l_ac_t    LIKE type_t.num5
   #add-point:show段define
   {<point name="show.define"/>}
   #end add-point  
 
   #add-point:show段之前
   {<point name="show.before"/>}
   #end add-point
   
   
   
   IF g_bfill = "Y" THEN
      CALL adbt500_b_fill() #單身填充
      CALL adbt500_b_fill2('0') #單身填充
   END IF
     
   #帶出公用欄位reference值
   #此段落由子樣板a12產生
      #LET g_xmda_m.xmdaownid_desc = cl_get_username(g_xmda_m.xmdaownid)
      #LET g_xmda_m.xmdaowndp_desc = cl_get_deptname(g_xmda_m.xmdaowndp)
      #LET g_xmda_m.xmdacrtid_desc = cl_get_username(g_xmda_m.xmdacrtid)
      #LET g_xmda_m.xmdacrtdp_desc = cl_get_deptname(g_xmda_m.xmdacrtdp)
      #LET g_xmda_m.xmdamodid_desc = cl_get_username(g_xmda_m.xmdamodid)
      #LET g_xmda_m.xmdacnfid_desc = cl_get_deptname(g_xmda_m.xmdacnfid)
      
 
 
   
   #顯示followup圖示
   #+ 此段落由子樣板a48產生
   CALL adbt500_set_pk_array()
   #add-point:ON ACTION agendum
   {<point name="show.follow_pic"/>}
   #END add-point
   CALL cl_user_overview_set_follow_pic()
 
 
   
   LET l_ac_t = l_ac
   
   #讀入ref值(單頭)
   #add-point:show段reference
   {<point name="show.head.reference"/>}
   #end add-point
   
   #將資料輸出到畫面上
   DISPLAY BY NAME g_xmda_m.xmdasite,g_xmda_m.xmdasite_desc,g_xmda_m.xmdadocdt,g_xmda_m.xmdadocno,g_xmda_m.xmda001, 
       g_xmda_m.xmdadocno_desc,g_xmda_m.xmda005,g_xmda_m.xmda202,g_xmda_m.xmda202_desc,g_xmda_m.xmda023, 
       g_xmda_m.xmda023_desc,g_xmda_m.xmda004,g_xmda_m.xmda004_desc,g_xmda_m.xmda200,g_xmda_m.xmda200_desc, 
       g_xmda_m.xmda201,g_xmda_m.xmda201_desc,g_xmda_m.xmdastus,g_xmda_m.xmda007,g_xmda_m.xmda008,g_xmda_m.xmda021, 
       g_xmda_m.xmda021_desc,g_xmda_m.xmda022,g_xmda_m.xmda022_desc,g_xmda_m.xmda203,g_xmda_m.xmda203_desc, 
       g_xmda_m.xmda027,g_xmda_m.xmda027_desc,g_xmda_m.xmda024,g_xmda_m.xmda024_desc,g_xmda_m.xmda002, 
       g_xmda_m.xmda002_desc,g_xmda_m.xmda003,g_xmda_m.xmda003_desc,g_xmda_m.xmdaunit,g_xmda_m.xmdaunit_desc, 
       g_xmda_m.xmda204,g_xmda_m.xmda204_desc,g_xmda_m.xmda205,g_xmda_m.xmda032,g_xmda_m.xmda032_desc, 
       g_xmda_m.xmda071,g_xmda_m.xmda025,g_xmda_m.xmda025_desc,g_xmda_m.oofb017,g_xmda_m.xmda026,g_xmda_m.xmda026_desc, 
       g_xmda_m.oofb017_1,g_xmda_m.xmda206,g_xmda_m.xmda206_desc,g_xmda_m.xmda207,g_xmda_m.xmda207_desc, 
       g_xmda_m.xmda020,g_xmda_m.xmda020_desc,g_xmda_m.xmda036,g_xmda_m.xmda036_desc,g_xmda_m.xmda009, 
       g_xmda_m.xmda009_desc,g_xmda_m.xmda010,g_xmda_m.xmda010_desc,g_xmda_m.xmda015,g_xmda_m.xmda015_desc, 
       g_xmda_m.xmda016,g_xmda_m.xmda011,g_xmda_m.xmda011_desc,g_xmda_m.xmda012,g_xmda_m.xmda013,g_xmda_m.xmda035, 
       g_xmda_m.xmda035_desc,g_xmda_m.isaf011,g_xmda_m.xmda039,g_xmda_m.xmdaownid,g_xmda_m.xmdaownid_desc, 
       g_xmda_m.xmdaowndp,g_xmda_m.xmdaowndp_desc,g_xmda_m.xmdacrtid,g_xmda_m.xmdacrtid_desc,g_xmda_m.xmdacrtdp, 
       g_xmda_m.xmdacrtdp_desc,g_xmda_m.xmdacrtdt,g_xmda_m.xmdamodid,g_xmda_m.xmdamodid_desc,g_xmda_m.xmdamoddt, 
       g_xmda_m.xmdacnfid,g_xmda_m.xmdacnfid_desc,g_xmda_m.xmdacnfdt,g_xmda_m.xmda034,g_xmda_m.xmda034_desc, 
       g_xmda_m.xmda006,g_xmda_m.xmda033,g_xmda_m.xmda017,g_xmda_m.xmda017_desc,g_xmda_m.xmda019,g_xmda_m.xmda018, 
       g_xmda_m.xmda018_desc,g_xmda_m.xmda044,g_xmda_m.xmda030,g_xmda_m.xmda031,g_xmda_m.xmda045,g_xmda_m.xmda046, 
       g_xmda_m.xmda047,g_xmda_m.xmda028,g_xmda_m.xmda041,g_xmda_m.xmda042,g_xmda_m.xmda043
   
   #顯示狀態(stus)圖片
         #此段落由子樣板a21產生
      CASE g_xmda_m.xmdastus
         WHEN "N"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/unconfirmed.png")
         WHEN "X"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/invalid.png")
         WHEN "Y"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/confirmed.png")
         WHEN "A"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/approved.png")
         WHEN "D"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/withdraw.png")
         WHEN "R"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/rejection.png")
         WHEN "W"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/signing.png")
         WHEN "C"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/closed.png")
         WHEN "H"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/hold.png")
         
      END CASE
 
 
   
   #讀入ref值(單身)
   FOR l_ac = 1 TO g_xmdc_d.getLength()
      #add-point:show段單身reference
      {<point name="show.body.reference"/>}
      #end add-point
   END FOR
   
   FOR l_ac = 1 TO g_xmdc3_d.getLength()
      #add-point:show段單身reference
      {<point name="show.body3.reference"/>}
      #end add-point
   END FOR
   FOR l_ac = 1 TO g_xmdc4_d.getLength()
      #add-point:show段單身reference
      {<point name="show.body4.reference"/>}
      #end add-point
   END FOR
   FOR l_ac = 1 TO g_xmdc5_d.getLength()
      #add-point:show段單身reference
      {<point name="show.body5.reference"/>}
      #end add-point
   END FOR
   FOR l_ac = 1 TO g_xmdc6_d.getLength()
      #add-point:show段單身reference
      {<point name="show.body6.reference"/>}
      #end add-point
   END FOR
 
   
    
   
   #add-point:show段other
   {<point name="show.other"/>}
   #end add-point  
   
   LET l_ac = l_ac_t
   
   #移動上下筆可以連動切換資料
   CALL cl_show_fld_cont()     
 
   CALL adbt500_detail_show()
   
   #add-point:show段之後
   {<point name="show.after"/>}
   #end add-point
   
END FUNCTION
]]>
  </section>
  <section id="adbt500.signature" ver="25" status="" src="s">
    <![CDATA[   #此段落由子樣板a39產生
#+ BPM提交
PRIVATE FUNCTION adbt500_send()
 
   #add-point:send段define
   {<point name="send.define"/>}
   #end add-point 
 
   IF g_xmda_m.xmdadocno IS NULL
 
   THEN
      CALL cl_err("","std-00003",0)
      RETURN FALSE
   END IF
 
   #重新取得與顯示完整單據資料(最新單據資料)
   EXECUTE adbt500_master_referesh USING g_xmda_m.xmdadocno INTO g_xmda_m.xmdasite,g_xmda_m.xmdadocdt, 
       g_xmda_m.xmdadocno,g_xmda_m.xmda001,g_xmda_m.xmda005,g_xmda_m.xmda202,g_xmda_m.xmda023,g_xmda_m.xmda004, 
       g_xmda_m.xmda200,g_xmda_m.xmda201,g_xmda_m.xmdastus,g_xmda_m.xmda007,g_xmda_m.xmda008,g_xmda_m.xmda021, 
       g_xmda_m.xmda022,g_xmda_m.xmda203,g_xmda_m.xmda027,g_xmda_m.xmda024,g_xmda_m.xmda002,g_xmda_m.xmda003, 
       g_xmda_m.xmdaunit,g_xmda_m.xmda204,g_xmda_m.xmda205,g_xmda_m.xmda032,g_xmda_m.xmda071,g_xmda_m.xmda025, 
       g_xmda_m.xmda026,g_xmda_m.xmda206,g_xmda_m.xmda207,g_xmda_m.xmda020,g_xmda_m.xmda036,g_xmda_m.xmda009, 
       g_xmda_m.xmda010,g_xmda_m.xmda015,g_xmda_m.xmda016,g_xmda_m.xmda011,g_xmda_m.xmda012,g_xmda_m.xmda013, 
       g_xmda_m.xmda035,g_xmda_m.xmda039,g_xmda_m.xmdaownid,g_xmda_m.xmdaowndp,g_xmda_m.xmdacrtid,g_xmda_m.xmdacrtdp, 
       g_xmda_m.xmdacrtdt,g_xmda_m.xmdamodid,g_xmda_m.xmdamoddt,g_xmda_m.xmdacnfid,g_xmda_m.xmdacnfdt, 
       g_xmda_m.xmda034,g_xmda_m.xmda006,g_xmda_m.xmda033,g_xmda_m.xmda017,g_xmda_m.xmda019,g_xmda_m.xmda018, 
       g_xmda_m.xmda044,g_xmda_m.xmda030,g_xmda_m.xmda031,g_xmda_m.xmda045,g_xmda_m.xmda046,g_xmda_m.xmda047, 
       g_xmda_m.xmda028,g_xmda_m.xmda041,g_xmda_m.xmda042,g_xmda_m.xmda043,g_xmda_m.xmdasite_desc,g_xmda_m.xmda202_desc, 
       g_xmda_m.xmda023_desc,g_xmda_m.xmda004_desc,g_xmda_m.xmda200_desc,g_xmda_m.xmda201_desc,g_xmda_m.xmda021_desc, 
       g_xmda_m.xmda022_desc,g_xmda_m.xmda203_desc,g_xmda_m.xmda027_desc,g_xmda_m.xmda024_desc,g_xmda_m.xmda002_desc, 
       g_xmda_m.xmda003_desc,g_xmda_m.xmdaunit_desc,g_xmda_m.xmda204_desc,g_xmda_m.xmda032_desc,g_xmda_m.xmda206_desc, 
       g_xmda_m.xmda207_desc,g_xmda_m.xmda020_desc,g_xmda_m.xmda036_desc,g_xmda_m.xmda009_desc,g_xmda_m.xmda010_desc, 
       g_xmda_m.xmda015_desc,g_xmda_m.xmdaownid_desc,g_xmda_m.xmdaowndp_desc,g_xmda_m.xmdacrtid_desc, 
       g_xmda_m.xmdacrtdp_desc,g_xmda_m.xmdamodid_desc,g_xmda_m.xmdacnfid_desc,g_xmda_m.xmda034_desc, 
       g_xmda_m.xmda017_desc,g_xmda_m.xmda018_desc
 
   ERROR ""
   
   CALL s_transaction_begin()
 
   OPEN adbt500_cl USING g_enterprise,g_xmda_m.xmdadocno
   IF STATUS THEN
      CALL cl_err("OPEN adbt500_cl:", STATUS, 1)
      CLOSE adbt500_cl
      CALL s_transaction_end('N','0')
      RETURN FALSE
   END IF
 
   #鎖住將被更改的資料
   FETCH adbt500_cl INTO g_xmda_m.xmdasite,g_xmda_m.xmdasite_desc,g_xmda_m.xmdadocdt,g_xmda_m.xmdadocno, 
       g_xmda_m.xmda001,g_xmda_m.xmdadocno_desc,g_xmda_m.xmda005,g_xmda_m.xmda202,g_xmda_m.xmda202_desc, 
       g_xmda_m.xmda023,g_xmda_m.xmda023_desc,g_xmda_m.xmda004,g_xmda_m.xmda004_desc,g_xmda_m.xmda200, 
       g_xmda_m.xmda200_desc,g_xmda_m.xmda201,g_xmda_m.xmda201_desc,g_xmda_m.xmdastus,g_xmda_m.xmda007, 
       g_xmda_m.xmda008,g_xmda_m.xmda021,g_xmda_m.xmda021_desc,g_xmda_m.xmda022,g_xmda_m.xmda022_desc, 
       g_xmda_m.xmda203,g_xmda_m.xmda203_desc,g_xmda_m.xmda027,g_xmda_m.xmda027_desc,g_xmda_m.xmda024, 
       g_xmda_m.xmda024_desc,g_xmda_m.xmda002,g_xmda_m.xmda002_desc,g_xmda_m.xmda003,g_xmda_m.xmda003_desc, 
       g_xmda_m.xmdaunit,g_xmda_m.xmdaunit_desc,g_xmda_m.xmda204,g_xmda_m.xmda204_desc,g_xmda_m.xmda205, 
       g_xmda_m.xmda032,g_xmda_m.xmda032_desc,g_xmda_m.xmda071,g_xmda_m.xmda025,g_xmda_m.xmda025_desc, 
       g_xmda_m.oofb017,g_xmda_m.xmda026,g_xmda_m.xmda026_desc,g_xmda_m.oofb017_1,g_xmda_m.xmda206,g_xmda_m.xmda206_desc, 
       g_xmda_m.xmda207,g_xmda_m.xmda207_desc,g_xmda_m.xmda020,g_xmda_m.xmda020_desc,g_xmda_m.xmda036, 
       g_xmda_m.xmda036_desc,g_xmda_m.xmda009,g_xmda_m.xmda009_desc,g_xmda_m.xmda010,g_xmda_m.xmda010_desc, 
       g_xmda_m.xmda015,g_xmda_m.xmda015_desc,g_xmda_m.xmda016,g_xmda_m.xmda011,g_xmda_m.xmda011_desc, 
       g_xmda_m.xmda012,g_xmda_m.xmda013,g_xmda_m.xmda035,g_xmda_m.xmda035_desc,g_xmda_m.isaf011,g_xmda_m.xmda039, 
       g_xmda_m.xmdaownid,g_xmda_m.xmdaownid_desc,g_xmda_m.xmdaowndp,g_xmda_m.xmdaowndp_desc,g_xmda_m.xmdacrtid, 
       g_xmda_m.xmdacrtid_desc,g_xmda_m.xmdacrtdp,g_xmda_m.xmdacrtdp_desc,g_xmda_m.xmdacrtdt,g_xmda_m.xmdamodid, 
       g_xmda_m.xmdamodid_desc,g_xmda_m.xmdamoddt,g_xmda_m.xmdacnfid,g_xmda_m.xmdacnfid_desc,g_xmda_m.xmdacnfdt, 
       g_xmda_m.xmda034,g_xmda_m.xmda034_desc,g_xmda_m.xmda006,g_xmda_m.xmda033,g_xmda_m.xmda017,g_xmda_m.xmda017_desc, 
       g_xmda_m.xmda019,g_xmda_m.xmda018,g_xmda_m.xmda018_desc,g_xmda_m.xmda044,g_xmda_m.xmda030,g_xmda_m.xmda031, 
       g_xmda_m.xmda045,g_xmda_m.xmda046,g_xmda_m.xmda047,g_xmda_m.xmda028,g_xmda_m.xmda041,g_xmda_m.xmda042, 
       g_xmda_m.xmda043
   
   #資料被他人LOCK, 或是sql執行時出現錯誤
   IF SQLCA.sqlcode THEN
      CALL cl_err(g_xmda_m.xmdadocno,SQLCA.sqlcode,0)
      CLOSE adbt500_cl
      CALL s_transaction_end('N','0')
      RETURN FALSE
   END IF
 
   #依據單據個數，需要指定所有單身條件為" 1=1"  (單身有幾個就要設幾個)
   LET g_wc2_table1 = " 1=1"
   LET g_wc2_table2 = " 1=1"
   LET g_wc2_table3 = " 1=1"
   LET g_wc2_table4 = " 1=1"
   LET g_wc2_table5 = " 1=1"
 
 
   CALL adbt500_show()
   CALL adbt500_set_pk_array()
   
   #add-point: 提交前的ADP
   {<point name="send.before_send" />}
   #end add-point
   
   #公用變數初始化
   CALL cl_bpm_data_init()
                  
   #依照主檔/單身個數產生 CALL cl_bpm_set_master_data() / cl_bpm_set_detail_data() 
   #單頭固定為 CALL cl_bpm_set_master_data(util.JSONObject.fromFGL(xxxx)) 傳入參數: (1)單頭陣列  ; 回傳值: 無
   CALL cl_bpm_set_master_data(util.JSONObject.fromFGL(g_xmda_m))
                              
   #單身固定為 CALL cl_bpm_set_detail_data(s_detailX, util.JSONArray.fromFGL(xxxx)) 傳入參數: (1)單身SR名稱  (2)單身陣列  ; 回傳值: 無
   CALL cl_bpm_set_detail_data("s_detail1", util.JSONArray.fromFGL(g_xmdc_d))
   CALL cl_bpm_set_detail_data("s_detail3", util.JSONArray.fromFGL(g_xmdc3_d))   CALL cl_bpm_set_detail_data("s_detail4", util.JSONArray.fromFGL(g_xmdc4_d))   CALL cl_bpm_set_detail_data("s_detail5", util.JSONArray.fromFGL(g_xmdc5_d))   CALL cl_bpm_set_detail_data("s_detail6", util.JSONArray.fromFGL(g_xmdc6_d))
 
   # cl_bpm_cli() 裡有包含以前的aws_condition()=>送簽資料檢核和更新單據狀況碼為'W'
   # cl_bpm_cli() 傳入參數:無  ;  回傳值: 0 開單失敗; 1 開單成功
 
   #開單失敗
   IF NOT cl_bpm_cli() THEN 
      CLOSE adbt500_cl
      CALL s_transaction_end('N','0')
      RETURN FALSE
   END IF
 
   #add-point: 提交後的ADP
   {<point name="send.after_send" />}
   #end add-point
   
   #完成狀態更新
   CLOSE adbt500_cl
   CALL s_transaction_end('Y','0')
             
   #此段落不需要刪除資料,但是否需要refresh圖片樣式???
   #CALL adbt500_ui_browser_refresh()
 
   #重新指定此筆單據資料狀態圖片=>送簽中
   LET g_browser[g_current_row].b_statepic = "stus/16/signing.png"
 
   #重新取得單頭/單身資料,DISPLAY在畫面上
   CALL adbt500_ui_headershow()
   CALL adbt500_ui_detailshow()
 
   RETURN TRUE
   
END FUNCTION
 
 
#此段落由子樣板a40產生
#+ BPM抽單
PRIVATE FUNCTION adbt500_draw_out()
 
   #add-point:draw段define
   {<point name="draw.define"/>}
   #end add-point
 
   #檢查資料是否存在
   IF g_xmda_m.xmdadocno IS NULL
 
   THEN
      CALL cl_err("","std-00003",0)
      RETURN FALSE
   END IF
 
   #LOCK主檔資料
   CALL s_transaction_begin()
 
   #進行BPM抽單功能
   OPEN adbt500_cl USING g_enterprise,g_xmda_m.xmdadocno
   IF STATUS THEN
      CALL cl_err("OPEN adbt500_cl:", STATUS, 1)
      CLOSE adbt500_cl
      CALL s_transaction_end('N','0')
      RETURN FALSE
   END IF
 
   #鎖住將被更改的資料
   FETCH adbt500_cl INTO g_xmda_m.xmdasite,g_xmda_m.xmdasite_desc,g_xmda_m.xmdadocdt,g_xmda_m.xmdadocno, 
       g_xmda_m.xmda001,g_xmda_m.xmdadocno_desc,g_xmda_m.xmda005,g_xmda_m.xmda202,g_xmda_m.xmda202_desc, 
       g_xmda_m.xmda023,g_xmda_m.xmda023_desc,g_xmda_m.xmda004,g_xmda_m.xmda004_desc,g_xmda_m.xmda200, 
       g_xmda_m.xmda200_desc,g_xmda_m.xmda201,g_xmda_m.xmda201_desc,g_xmda_m.xmdastus,g_xmda_m.xmda007, 
       g_xmda_m.xmda008,g_xmda_m.xmda021,g_xmda_m.xmda021_desc,g_xmda_m.xmda022,g_xmda_m.xmda022_desc, 
       g_xmda_m.xmda203,g_xmda_m.xmda203_desc,g_xmda_m.xmda027,g_xmda_m.xmda027_desc,g_xmda_m.xmda024, 
       g_xmda_m.xmda024_desc,g_xmda_m.xmda002,g_xmda_m.xmda002_desc,g_xmda_m.xmda003,g_xmda_m.xmda003_desc, 
       g_xmda_m.xmdaunit,g_xmda_m.xmdaunit_desc,g_xmda_m.xmda204,g_xmda_m.xmda204_desc,g_xmda_m.xmda205, 
       g_xmda_m.xmda032,g_xmda_m.xmda032_desc,g_xmda_m.xmda071,g_xmda_m.xmda025,g_xmda_m.xmda025_desc, 
       g_xmda_m.oofb017,g_xmda_m.xmda026,g_xmda_m.xmda026_desc,g_xmda_m.oofb017_1,g_xmda_m.xmda206,g_xmda_m.xmda206_desc, 
       g_xmda_m.xmda207,g_xmda_m.xmda207_desc,g_xmda_m.xmda020,g_xmda_m.xmda020_desc,g_xmda_m.xmda036, 
       g_xmda_m.xmda036_desc,g_xmda_m.xmda009,g_xmda_m.xmda009_desc,g_xmda_m.xmda010,g_xmda_m.xmda010_desc, 
       g_xmda_m.xmda015,g_xmda_m.xmda015_desc,g_xmda_m.xmda016,g_xmda_m.xmda011,g_xmda_m.xmda011_desc, 
       g_xmda_m.xmda012,g_xmda_m.xmda013,g_xmda_m.xmda035,g_xmda_m.xmda035_desc,g_xmda_m.isaf011,g_xmda_m.xmda039, 
       g_xmda_m.xmdaownid,g_xmda_m.xmdaownid_desc,g_xmda_m.xmdaowndp,g_xmda_m.xmdaowndp_desc,g_xmda_m.xmdacrtid, 
       g_xmda_m.xmdacrtid_desc,g_xmda_m.xmdacrtdp,g_xmda_m.xmdacrtdp_desc,g_xmda_m.xmdacrtdt,g_xmda_m.xmdamodid, 
       g_xmda_m.xmdamodid_desc,g_xmda_m.xmdamoddt,g_xmda_m.xmdacnfid,g_xmda_m.xmdacnfid_desc,g_xmda_m.xmdacnfdt, 
       g_xmda_m.xmda034,g_xmda_m.xmda034_desc,g_xmda_m.xmda006,g_xmda_m.xmda033,g_xmda_m.xmda017,g_xmda_m.xmda017_desc, 
       g_xmda_m.xmda019,g_xmda_m.xmda018,g_xmda_m.xmda018_desc,g_xmda_m.xmda044,g_xmda_m.xmda030,g_xmda_m.xmda031, 
       g_xmda_m.xmda045,g_xmda_m.xmda046,g_xmda_m.xmda047,g_xmda_m.xmda028,g_xmda_m.xmda041,g_xmda_m.xmda042, 
       g_xmda_m.xmda043
   
   #資料被他人LOCK, 或是sql執行時出現錯誤
   IF SQLCA.sqlcode THEN
      CALL cl_err(g_xmda_m.xmdadocno,SQLCA.sqlcode,0)
      CLOSE adbt500_cl
      CALL s_transaction_end('N','0')
      RETURN FALSE
   END IF
 
   #抽單失敗
   IF NOT cl_bpm_draw_out() THEN 
      CLOSE adbt500_cl
      CALL s_transaction_end('N','0')
      RETURN FALSE
   END IF    
 
   #完成狀態更新
   CLOSE adbt500_cl
   CALL s_transaction_end('Y','0')
          
   #重新指定此筆單據資料狀態圖片=>抽單
   LET g_browser[g_current_row].b_statepic = "stus/16/draw_out.png"
 
   #重新取得單頭/單身資料,DISPLAY在畫面上
   CALL adbt500_ui_headershow()  
   CALL adbt500_ui_detailshow()
 
   RETURN TRUE
   
END FUNCTION
 
 
 
]]>
  </section>
  <section id="adbt500.state_change" ver="13" status="" src="s">
    <![CDATA[   #+ 此段落由子樣板a09產生
#+ 確認碼變更
PRIVATE FUNCTION adbt500_statechange()
   DEFINE lc_state LIKE type_t.chr5
   #add-point:statechange段define
   {<point name="statechange.define"/>}
   #end add-point  
   
   #add-point:statechange段開始前
   {<point name="statechange.before"/>}
   #end add-point  
   
   ERROR ""     #清空畫面右下側ERROR區塊
 
   IF g_xmda_m.xmdadocno IS NULL
 
   THEN
      CALL cl_err("","std-00003",0)
      RETURN
   END IF
 
   MENU "" ATTRIBUTES (STYLE="popup")
      BEFORE MENU
         HIDE OPTION "approved"
         HIDE OPTION "rejection"
         CASE g_xmda_m.xmdastus
            WHEN "N"
               HIDE OPTION "unconfirmed"
            WHEN "X"
               HIDE OPTION "invalid"
            WHEN "Y"
               HIDE OPTION "confirmed"
            WHEN "A"
               HIDE OPTION "approved"
            WHEN "D"
               HIDE OPTION "withdraw"
            WHEN "R"
               HIDE OPTION "rejection"
            WHEN "W"
               HIDE OPTION "signing"
            WHEN "C"
               HIDE OPTION "closed"
            WHEN "H"
               HIDE OPTION "hold"
            
         END CASE
     
      #add-point:menu前
      {<point name="statechange.before_menu"/>}
      #end add-point
      
      ON ACTION unconfirmed
         LET lc_state = "N"
         #add-point:action控制
         {<point name="statechange.unconfirmed"/>}
         #end add-point
         EXIT MENU
      ON ACTION invalid
         LET lc_state = "X"
         #add-point:action控制
         {<point name="statechange.invalid"/>}
         #end add-point
         EXIT MENU
      ON ACTION confirmed
         LET lc_state = "Y"
         #add-point:action控制
         {<point name="statechange.confirmed"/>}
         #end add-point
         EXIT MENU
      ON ACTION approved
         LET lc_state = "A"
         #add-point:action控制
         {<point name="statechange.approved"/>}
         #end add-point
         EXIT MENU
      #ON ACTION withdraw
      #   LET lc_state = "D"
      #   #add-point:action控制
      #   {<point name="statechange.withdraw"/>}
      #   #end add-point
      #   EXIT MENU
      ON ACTION rejection
         LET lc_state = "R"
         #add-point:action控制
         {<point name="statechange.rejection"/>}
         #end add-point
         EXIT MENU
      #ON ACTION signing
      #   LET lc_state = "W"
      #   #add-point:action控制
      #   {<point name="statechange.signing"/>}
      #   #end add-point
      #   EXIT MENU
      ON ACTION closed
         LET lc_state = "C"
         #add-point:action控制
         {<point name="statechange.closed"/>}
         #end add-point
         EXIT MENU
      ON ACTION hold
         LET lc_state = "H"
         #add-point:action控制
         {<point name="statechange.hold"/>}
         #end add-point
         EXIT MENU
      
      #此段落由子樣板a36產生
      #提交
      ON ACTION signing
         IF cl_auth_chk_act("signing") THEN
            IF NOT adbt500_send() THEN
               RETURN
            END IF
         END IF
         LET lc_state = ''   #因為_send()已有執行update動作
 
         EXIT MENU
 
      #抽單
      ON ACTION withdraw
         IF cl_auth_chk_act("withdraw") THEN
            IF NOT adbt500_draw_out() THEN
               RETURN
            END IF
         END IF
         LET lc_state = ''   #因為_draw_out()已有執行update動作
         EXIT MENU
 
 
      
      #add-point:stus控制
      {<point name="statechange.more_control"/>}
      #end add-point
      
   END MENU
   
   IF (lc_state <> "N" 
      AND lc_state <> "X"
      AND lc_state <> "Y"
      AND lc_state <> "A"
      AND lc_state <> "D"
      AND lc_state <> "R"
      AND lc_state <> "W"
      AND lc_state <> "C"
      AND lc_state <> "H"
      ) OR 
      cl_null(lc_state) THEN
      RETURN
   END IF
   
   #add-point:stus修改前
   {<point name="statechange.b_update"/>}
   #end add-point
      
   UPDATE xmda_t SET xmdastus = lc_state 
    WHERE xmdaent = g_enterprise AND xmdadocno = g_xmda_m.xmdadocno
 
  
   IF SQLCA.sqlcode THEN
      CALL cl_err("",SQLCA.sqlcode,0)
   ELSE
      CASE lc_state
         WHEN "N"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/unconfirmed.png")
         WHEN "X"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/invalid.png")
         WHEN "Y"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/confirmed.png")
         WHEN "A"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/approved.png")
         WHEN "D"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/withdraw.png")
         WHEN "R"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/rejection.png")
         WHEN "W"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/signing.png")
         WHEN "C"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/closed.png")
         WHEN "H"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/hold.png")
         
      END CASE
      LET g_xmda_m.xmdastus = lc_state
      DISPLAY BY NAME g_xmda_m.xmdastus
   END IF
 
   #add-point:stus修改後
   {<point name="statechange.a_update"/>}
   #end add-point
 
   #add-point:statechange段結束前
   {<point name="statechange.after"/>}
   #end add-point  
 
END FUNCTION
 
 
]]>
  </section>
  <section id="adbt500.ui_browser_refresh" ver="3" status="" src="s">
    <![CDATA[#+ 瀏覽頁簽資料重新顯示
PRIVATE FUNCTION adbt500_ui_browser_refresh()
   DEFINE l_i  LIKE type_t.num10
   #add-point:ui_browser_refresh段define
   {<point name="ui_browser_refresh.define"/>}
   #end add-point    
   
   FOR l_i =1 TO g_browser.getLength()
      IF g_browser[l_i].b_xmdadocno = g_xmda_m.xmdadocno 
 
         THEN  
         CALL g_browser.deleteElement(l_i)
         LET g_header_cnt = g_header_cnt - 1
         EXIT FOR
      END IF
   END FOR
 
   LET g_browser_cnt = g_browser_cnt - 1
   IF g_current_row > g_browser_cnt THEN        #確定browse 筆數指在同一筆
      LET g_current_row = g_browser_cnt
   END IF
 
   #DISPLAY g_browser_cnt TO FORMONLY.b_count    #總筆數的顯示
   
END FUNCTION
]]>
  </section>
  <section id="adbt500.ui_detailshow" ver="12" status="" src="s">
    <![CDATA[#+ 單身資料重新顯示
PRIVATE FUNCTION adbt500_ui_detailshow()
   #add-point:ui_detailshow段define
   {<point name="ui_detailshow.define"/>}
   #end add-point    
   
   #add-point:ui_detailshow段before
   {<point name="ui_detailshow.before"/>}
   #end add-point    
   
   IF g_curr_diag IS NOT NULL THEN
      CALL g_curr_diag.setCurrentRow("s_detail1",g_detail_idx)      
      CALL g_curr_diag.setCurrentRow("s_detail3",g_detail_idx)
      CALL g_curr_diag.setCurrentRow("s_detail4",g_detail_idx)
      CALL g_curr_diag.setCurrentRow("s_detail5",g_detail_idx)
      CALL g_curr_diag.setCurrentRow("s_detail6",g_detail_idx)
 
   END IF
   
   #add-point:ui_detailshow段after
   {<point name="ui_detailshow.after"/>}
   #end add-point    
   
END FUNCTION
]]>
  </section>
  <section id="adbt500.ui_dialog" ver="157" status="" src="s">
    <![CDATA[#+ 功能選單
PRIVATE FUNCTION adbt500_ui_dialog()
   DEFINE li_idx    LIKE type_t.num5
   DEFINE ls_wc     STRING
   DEFINE lb_first  BOOLEAN
   DEFINE la_param  RECORD
             prog   STRING,
             param  DYNAMIC ARRAY OF STRING
                    END RECORD
   DEFINE ls_js     STRING
   #add-point:ui_dialog段define
   {<point name="ui_dialog.define"/>}
   #end add-point
   
   CALL cl_set_act_visible("accept,cancel", FALSE)
 
   CALL gfrm_curr.setElementImage("logo","logo/applogo.png") 
   IF g_default THEN
      CALL gfrm_curr.setElementHidden("mainlayout",0)
      CALL gfrm_curr.setElementHidden("worksheet",1)
      LET g_main_hidden = 0
   ELSE
      CALL gfrm_curr.setElementHidden("mainlayout",1)
      CALL gfrm_curr.setElementHidden("worksheet",0)
      LET g_main_hidden = 1
   END IF
   
   #action default動作
   #+ 此段落由子樣板a42產生
   CASE g_actdefault
      WHEN "insert"
         LET g_action_choice="insert"
         LET g_actdefault = ""
         IF cl_auth_chk_act("insert") THEN
            CALL adbt500_insert()
            #add-point:ON ACTION insert
            {<point name="menu.default.insert" />}
            #END add-point
         END IF
 
      #add-point:action default自訂
      {<point name="ui_dialog.action_default"/>}
      #end add-point
      OTHERWISE
         
   END CASE
 
 
   
   LET lb_first = TRUE
   
   #add-point:ui_dialog段before dialog 
   {<point name="ui_dialog.before_dialog"/>}
   #end add-point
   
   WHILE TRUE 
   
      CALL adbt500_browser_fill("")
      CALL lib_cl_dlg.cl_dlg_before_display()
      CALL cl_notice()
            
      #判斷前一個動作是否為新增, 若是的話切換到新增的筆數
      IF g_state = "Y" THEN
         FOR li_idx = 1 TO g_browser.getLength()
            IF g_browser[li_idx].b_xmdadocno = g_xmdadocno_t
 
               THEN
               LET g_current_row = li_idx
               LET g_current_idx = li_idx
               EXIT FOR
            END IF
         END FOR
         LET g_state = ""
      END IF
            
      DIALOG ATTRIBUTES(UNBUFFERED,FIELD ORDER FORM)
 
         #左側瀏覽頁簽
         DISPLAY ARRAY g_browser TO s_browse.* ATTRIBUTES(COUNT=g_header_cnt)
 
            BEFORE ROW
               #回歸舊筆數位置 (回到當時異動的筆數)
               LET g_current_idx = DIALOG.getCurrentRow("s_browse")
               IF g_current_row > 1 AND g_current_idx = 1 AND g_current_sw = FALSE THEN
                  CALL DIALOG.setCurrentRow("s_browse",g_current_row)
                  LET g_current_idx = g_current_row
               END IF
               LET g_current_row = g_current_idx #目前指標
               LET g_current_sw = TRUE
 
               IF g_current_idx > g_browser.getLength() THEN
                  LET g_current_idx = g_browser.getLength()
               END IF 
               
               CALL adbt500_fetch('') # reload data
               LET l_ac = 1
               CALL adbt500_ui_detailshow() #Setting the current row 
      
               CALL adbt500_idx_chk()
               #NEXT FIELD xmdcseq
         
         END DISPLAY
        
         DISPLAY ARRAY g_xmdc_d TO s_detail1.* ATTRIBUTES(COUNT=g_rec_b) #page1  
    
            BEFORE ROW
               CALL adbt500_idx_chk()
               LET l_ac = DIALOG.getCurrentRow("s_detail1")
               LET g_detail_idx = l_ac
               
               #add-point:page1, before row動作
               {<point name="ui_dialog.page1.before_row"/>}
               #end add-point
               
            BEFORE DISPLAY
               #如果一直都在單頭則控制筆數位置
               IF g_loc = 'm' THEN
                  CALL FGL_SET_ARR_CURR(g_detail_idx)
               END IF
               LET g_loc = 'm'
               LET l_ac = DIALOG.getCurrentRow("s_detail1")
               LET g_current_page = 1
               CALL adbt500_idx_chk()
               #add-point:page1自定義行為
               {<point name="ui_dialog.page1.before_display"/>}
               #end add-point
               
            #自訂ACTION(detail_show,page_1)
            
 
         #+ 此段落由子樣板a43產生
         ON ACTION open_adbt500_03
            LET g_action_choice="open_adbt500_03"
            IF cl_auth_chk_act("open_adbt500_03") THEN
               
               #add-point:ON ACTION open_adbt500_03
               {<point name="menu.detail_show.page1.open_adbt500_03" />}
               #END add-point
               EXIT DIALOG
            END IF
 
 
               
            #add-point:page1自定義行為
            {<point name="ui_dialog.page1.action"/>}
            #end add-point
               
         END DISPLAY
        
         DISPLAY ARRAY g_xmdc3_d TO s_detail3.* ATTRIBUTES(COUNT=g_rec_b)  
    
            BEFORE ROW
               CALL adbt500_idx_chk()
               LET l_ac = DIALOG.getCurrentRow("s_detail3")
               LET g_detail_idx = l_ac
               
               #add-point:page2, before row動作
               {<point name="ui_dialog.body3.before_row"/>}
               #end add-point
               
            BEFORE DISPLAY
               #如果一直都在單頭則控制筆數位置
               IF g_loc = 'm' THEN
                  CALL FGL_SET_ARR_CURR(g_detail_idx)
               END IF
               LET g_loc = 'm'
               LET l_ac = DIALOG.getCurrentRow("s_detail3")
               LET g_current_page = 2
               CALL adbt500_idx_chk()
               #add-point:page2自定義行為
               {<point name="ui_dialog.body3.before_display"/>}
               #end add-point
      
            #自訂ACTION(detail_show,page_2)
            
         
            #add-point:page2自定義行為
            {<point name="ui_dialog.body3.action"/>}
            #end add-point
         
         END DISPLAY
         DISPLAY ARRAY g_xmdc4_d TO s_detail4.* ATTRIBUTES(COUNT=g_rec_b)  
    
            BEFORE ROW
               CALL adbt500_idx_chk()
               LET l_ac = DIALOG.getCurrentRow("s_detail4")
               LET g_detail_idx = l_ac
               
               #add-point:page3, before row動作
               {<point name="ui_dialog.body4.before_row"/>}
               #end add-point
               
            BEFORE DISPLAY
               #如果一直都在單頭則控制筆數位置
               IF g_loc = 'm' THEN
                  CALL FGL_SET_ARR_CURR(g_detail_idx)
               END IF
               LET g_loc = 'm'
               LET l_ac = DIALOG.getCurrentRow("s_detail4")
               LET g_current_page = 3
               CALL adbt500_idx_chk()
               #add-point:page3自定義行為
               {<point name="ui_dialog.body4.before_display"/>}
               #end add-point
      
            #自訂ACTION(detail_show,page_3)
            
 
         #+ 此段落由子樣板a43產生
         ON ACTION open_adbt500_03
            LET g_action_choice="open_adbt500_03"
            IF cl_auth_chk_act("open_adbt500_03") THEN
               
               #add-point:ON ACTION open_adbt500_03
               {<point name="menu.detail_show.page3.open_adbt500_03" />}
               #END add-point
               EXIT DIALOG
            END IF
 
 
         #+ 此段落由子樣板a43產生
         ON ACTION adbt500_04
            LET g_action_choice="adbt500_04"
            IF cl_auth_chk_act("adbt500_04") THEN
               
               #add-point:ON ACTION adbt500_04
               {<point name="menu.detail_show.page3.adbt500_04" />}
               #END add-point
               EXIT DIALOG
            END IF
 
 
         
            #add-point:page3自定義行為
            {<point name="ui_dialog.body4.action"/>}
            #end add-point
         
         END DISPLAY
         DISPLAY ARRAY g_xmdc5_d TO s_detail5.* ATTRIBUTES(COUNT=g_rec_b)  
    
            BEFORE ROW
               CALL adbt500_idx_chk()
               LET l_ac = DIALOG.getCurrentRow("s_detail5")
               LET g_detail_idx = l_ac
               
               #add-point:page4, before row動作
               {<point name="ui_dialog.body5.before_row"/>}
               #end add-point
               
            BEFORE DISPLAY
               #如果一直都在單頭則控制筆數位置
               IF g_loc = 'm' THEN
                  CALL FGL_SET_ARR_CURR(g_detail_idx)
               END IF
               LET g_loc = 'm'
               LET l_ac = DIALOG.getCurrentRow("s_detail5")
               LET g_current_page = 4
               CALL adbt500_idx_chk()
               #add-point:page4自定義行為
               {<point name="ui_dialog.body5.before_display"/>}
               #end add-point
      
            #自訂ACTION(detail_show,page_4)
            
 
         #+ 此段落由子樣板a43產生
         ON ACTION open_adbt500_03
            LET g_action_choice="open_adbt500_03"
            IF cl_auth_chk_act("open_adbt500_03") THEN
               
               #add-point:ON ACTION open_adbt500_03
               {<point name="menu.detail_show.page4.open_adbt500_03" />}
               #END add-point
               EXIT DIALOG
            END IF
 
 
         #+ 此段落由子樣板a43產生
         ON ACTION adbt500_04
            LET g_action_choice="adbt500_04"
            IF cl_auth_chk_act("adbt500_04") THEN
               
               #add-point:ON ACTION adbt500_04
               {<point name="menu.detail_show.page4.adbt500_04" />}
               #END add-point
               EXIT DIALOG
            END IF
 
 
         
            #add-point:page4自定義行為
            {<point name="ui_dialog.body5.action"/>}
            #end add-point
         
         END DISPLAY
         DISPLAY ARRAY g_xmdc6_d TO s_detail6.* ATTRIBUTES(COUNT=g_rec_b)  
    
            BEFORE ROW
               CALL adbt500_idx_chk()
               LET l_ac = DIALOG.getCurrentRow("s_detail6")
               LET g_detail_idx = l_ac
               
               #add-point:page5, before row動作
               {<point name="ui_dialog.body6.before_row"/>}
               #end add-point
               
            BEFORE DISPLAY
               #如果一直都在單頭則控制筆數位置
               IF g_loc = 'm' THEN
                  CALL FGL_SET_ARR_CURR(g_detail_idx)
               END IF
               LET g_loc = 'm'
               LET l_ac = DIALOG.getCurrentRow("s_detail6")
               LET g_current_page = 5
               CALL adbt500_idx_chk()
               #add-point:page5自定義行為
               {<point name="ui_dialog.body6.before_display"/>}
               #end add-point
      
            #自訂ACTION(detail_show,page_5)
            
 
         #+ 此段落由子樣板a43產生
         ON ACTION open_adbt500_03
            LET g_action_choice="open_adbt500_03"
            IF cl_auth_chk_act("open_adbt500_03") THEN
               
               #add-point:ON ACTION open_adbt500_03
               {<point name="menu.detail_show.page5.open_adbt500_03" />}
               #END add-point
               EXIT DIALOG
            END IF
 
 
         
            #add-point:page5自定義行為
            {<point name="ui_dialog.body6.action"/>}
            #end add-point
         
         END DISPLAY
 
         
 
         
         #add-point:ui_dialog段自定義display array
         {<point name="ui_dialog.more_displayarray"/>}
         #end add-point
         
         SUBDIALOG lib_cl_dlg.cl_dlg_qryplan
         SUBDIALOG lib_cl_dlg.cl_dlg_relateapps
      
         BEFORE DIALOG
            CALL cl_navigator_setting(g_current_idx, g_detail_cnt)
            LET g_curr_diag = ui.DIALOG.getCurrent()
            LET g_page = "first"
            LET g_current_sw = FALSE
            #回歸舊筆數位置 (回到當時異動的筆數)
            LET g_current_idx = DIALOG.getCurrentRow("s_browse")
            IF g_current_row > 1 AND g_current_idx = 1 AND g_current_sw = FALSE THEN
               CALL DIALOG.setCurrentRow("s_browse",g_current_row)
               LET g_current_idx = g_current_row
            END IF
            LET g_current_row = g_current_idx #目前指標
            IF g_current_idx = 0 THEN
               LET g_current_idx = 1
            END IF
            LET g_current_sw = TRUE
            
            IF g_current_idx > g_browser.getLength() THEN
               LEt g_current_idx = g_browser.getLength()
            END IF 
            
            #有資料才進行fetch
            IF g_current_idx <> 0 THEN
               CALL adbt500_fetch('') # reload data
            END IF
            #LET g_detail_idx = 1
            CALL adbt500_ui_detailshow() #Setting the current row 
            
            #筆數顯示
            LET g_current_page = 1
            CALL adbt500_idx_chk()
            
            #add-point:ui_dialog段before_dialog2
            {<point name="ui_dialog.before_dialog2"/>}
            #end add-point
        
         ON ACTION statechange
            LET g_action_choice = "statechange"
            CALL adbt500_statechange()
            EXIT DIALOG
      
         #此段落由子樣板a32產生
         #簽核狀況
         ON ACTION bpm_status
            #查詢簽核狀況, 統一建立HyperLink
            CALL cl_bpm_status()
            #add-point:ON ACTION bpm_status
            {<point name="menu.bpm_status" />}
            #END add-point
 
 
 
 
          
         ON ACTION queryplansel
            CALL cl_dlg_qryplan_select() RETURNING ls_wc
            #不是空條件才寫入g_wc跟重新找資料
            IF NOT cl_null(ls_wc) THEN
               LET g_wc = ls_wc
               CALL adbt500_browser_fill("F")   #browser_fill()會將notice區塊清空
               CALL cl_notice()   #重新顯示,此處不可用EXIT DIALOG, SUBDIALOG重讀會導致部分變數消失
            END IF
 
         ON ACTION qbe_select
            CALL cl_qbe_list("m") RETURNING ls_wc
            IF NOT cl_null(ls_wc) THEN
               LET g_wc = ls_wc
               #取得條件後需要重查、跳到結果第一筆資料的功能程式段
               CALL adbt500_browser_fill("F")
               IF g_browser_cnt = 0 THEN
                  CALL cl_err("","-100",1)
                  CLEAR FORM
               ELSE
                  CALL adbt500_fetch("F")
               END IF
            END IF
            #重新搜尋會將notice區塊清空,此處不可用EXIT DIALOG, SUBDIALOG重讀會導致部分變數消失
            CALL cl_notice()
          
         #+ 此段落由子樣板a49產生
            ON ACTION filter
               #add-point:filter action
               {<point name="ui_dialog.action.filter"/>}
               #end add-point
               CALL adbt500_filter()
               EXIT DIALOG
 
 
 
         
         ON ACTION first
            CALL adbt500_fetch('F')
            LET g_current_row = g_current_idx
            LET g_curr_diag = ui.DIALOG.getCurrent()
            CALL adbt500_idx_chk()
            
         ON ACTION previous
            CALL adbt500_fetch('P')
            LET g_current_row = g_current_idx
            LET g_curr_diag = ui.DIALOG.getCurrent()
            CALL adbt500_idx_chk()
            
         ON ACTION jump
            CALL adbt500_fetch('/')
            LET g_current_row = g_current_idx
            LET g_curr_diag = ui.DIALOG.getCurrent()
            CALL adbt500_idx_chk()
            
         ON ACTION next
            CALL adbt500_fetch('N')
            LET g_current_row = g_current_idx
            LET g_curr_diag = ui.DIALOG.getCurrent()
            CALL adbt500_idx_chk()
            
         ON ACTION last
            CALL adbt500_fetch('L')
            LET g_current_row = g_current_idx
            LET g_curr_diag = ui.DIALOG.getCurrent()
            CALL adbt500_idx_chk()
            
         ON ACTION close
            LET INT_FLAG = FALSE
            LET g_action_choice = "exit"
            EXIT DIALOG
          
         ON ACTION exit
            LET g_action_choice = "exit"
            EXIT DIALOG
      
         ON ACTION mainhidden       #主頁摺疊
            IF g_main_hidden THEN
               CALL gfrm_curr.setElementHidden("mainlayout",0)
               CALL gfrm_curr.setElementHidden("worksheet",1)
               LET g_main_hidden = 0
            ELSE
               CALL gfrm_curr.setElementHidden("mainlayout",1)
               CALL gfrm_curr.setElementHidden("worksheet",0)
               LET g_main_hidden = 1
            END IF
            
         ON ACTION worksheethidden   #瀏覽頁折疊
            IF g_main_hidden THEN
               CALL gfrm_curr.setElementHidden("mainlayout",0)
               CALL gfrm_curr.setElementHidden("worksheet",1)
               LET g_main_hidden = 0
            ELSE
               CALL gfrm_curr.setElementHidden("mainlayout",1)
               CALL gfrm_curr.setElementHidden("worksheet",0)
               LET g_main_hidden = 1
            END IF
            IF lb_first THEN
               LET lb_first = FALSE
               NEXT FIELD xmdcseq
            END IF
       
         ON ACTION controls      #單頭摺疊，可利用hot key "Ctrl-s"開啟/關閉單頭
            IF g_header_hidden THEN
               CALL gfrm_curr.setElementHidden("vb_master",0)
               CALL gfrm_curr.setElementImage("controls","small/arr-u.png")
               LET g_header_hidden = 0     #visible
            ELSE
               CALL gfrm_curr.setElementHidden("vb_master",1)
               CALL gfrm_curr.setElementImage("controls","small/arr-d.png")
               LET g_header_hidden = 1     #hidden     
            END IF
    
         
         #+ 此段落由子樣板a43產生
         ON ACTION modify
            LET g_action_choice="modify"
            IF cl_auth_chk_act("modify") THEN
               LET g_aw = ''
               CALL adbt500_modify()
               #add-point:ON ACTION modify
               {<point name="menu.modify" />}
               #END add-point
               EXIT DIALOG
            END IF
 
 
         #+ 此段落由子樣板a43產生
         ON ACTION modify_detail
            LET g_action_choice="modify_detail"
            IF cl_auth_chk_act("modify") THEN
               LET g_aw = g_curr_diag.getCurrentItem()
               CALL adbt500_modify()
               #add-point:ON ACTION modify_detail
               {<point name="menu.modify_detail" />}
               #END add-point
               EXIT DIALOG
            END IF
 
 
         #+ 此段落由子樣板a43產生
         ON ACTION open_apmi004_01
            LET g_action_choice="open_apmi004_01"
            IF cl_auth_chk_act("open_apmi004_01") THEN
               
               #add-point:ON ACTION open_apmi004_01
               {<point name="menu.open_apmi004_01" />}
               #END add-point
               EXIT DIALOG
            END IF
 
 
         #+ 此段落由子樣板a43產生
         ON ACTION open_s_pay
            LET g_action_choice="open_s_pay"
            IF cl_auth_chk_act("open_s_pay") THEN
               
               #add-point:ON ACTION open_s_pay
               {<point name="menu.open_s_pay" />}
               #END add-point
               EXIT DIALOG
            END IF
 
 
         #+ 此段落由子樣板a43產生
         ON ACTION delete
            LET g_action_choice="delete"
            IF cl_auth_chk_act("delete") THEN
               CALL adbt500_delete()
               #add-point:ON ACTION delete
               {<point name="menu.delete" />}
               #END add-point
               
            END IF
 
 
         #+ 此段落由子樣板a43產生
         ON ACTION insert
            LET g_action_choice="insert"
            IF cl_auth_chk_act("insert") THEN
               CALL adbt500_insert()
               #add-point:ON ACTION insert
               {<point name="menu.insert" />}
               #END add-point
               EXIT DIALOG
            END IF
 
 
         #+ 此段落由子樣板a43產生
         ON ACTION open_s_pay09
            LET g_action_choice="open_s_pay09"
            IF cl_auth_chk_act("open_s_pay09") THEN
               
               #add-point:ON ACTION open_s_pay09
               {<point name="menu.open_s_pay09" />}
               #END add-point
               EXIT DIALOG
            END IF
 
 
         #+ 此段落由子樣板a43產生
         ON ACTION output
            LET g_action_choice="output"
            IF cl_auth_chk_act("output") THEN
               
               #add-point:ON ACTION output
               {<point name="menu.output" />}
               #END add-point
               EXIT DIALOG
            END IF
 
 
         #+ 此段落由子樣板a43產生
         ON ACTION reproduce
            LET g_action_choice="reproduce"
            IF cl_auth_chk_act("reproduce") THEN
               CALL adbt500_reproduce()
               #add-point:ON ACTION reproduce
               {<point name="menu.reproduce" />}
               #END add-point
               EXIT DIALOG
            END IF
 
 
         #+ 此段落由子樣板a43產生
         ON ACTION open_adbt500_02
            LET g_action_choice="open_adbt500_02"
            IF cl_auth_chk_act("open_adbt500_02") THEN
               
               #add-point:ON ACTION open_adbt500_02
               {<point name="menu.open_adbt500_02" />}
               #END add-point
               EXIT DIALOG
            END IF
 
 
         #+ 此段落由子樣板a43產生
         ON ACTION query
            LET g_action_choice="query"
            IF cl_auth_chk_act("query") THEN
               CALL adbt500_query()
               #add-point:ON ACTION query
               {<point name="menu.query" />}
               #END add-point
               
            END IF
 
 
         #+ 此段落由子樣板a43產生
         ON ACTION open_xmdb
            LET g_action_choice="open_xmdb"
            IF cl_auth_chk_act("open_xmdb") THEN
               
               #add-point:ON ACTION open_xmdb
               {<point name="menu.open_xmdb" />}
               #END add-point
               EXIT DIALOG
            END IF
 
 
         
         #+ 此段落由子樣板a46產生
         #新增相關文件
         ON ACTION related_document
            CALL adbt500_set_pk_array()
            IF cl_auth_chk_act("related_document") THEN
               #add-point:ON ACTION related_document
               {<point name="ui_dialog.dialog.related_document"/>}
               #END add-point
               CALL cl_doc()
            END IF
            
         ON ACTION agendum
            CALL adbt500_set_pk_array()
            #add-point:ON ACTION agendum
            {<point name="ui_dialog.dialog.agendum"/>}
            #END add-point
            CALL cl_user_overview()
            CALL cl_user_overview_set_follow_pic()
         
         ON ACTION followup
            CALL adbt500_set_pk_array()
            #add-point:ON ACTION followup
            {<point name="ui_dialog.dialog.followup"/>}
            #END add-point
            CALL cl_user_overview_follow(g_xmda_m.xmdadocdt)
 
 
         
         #主選單用ACTION
         &include "main_menu.4gl"
         &include "relating_action.4gl"
         #交談指令共用ACTION
         &include "common_action.4gl" 
            CONTINUE DIALOG
            
      END DIALOG
    
      IF g_action_choice = "exit" AND NOT cl_null(g_action_choice) THEN
         EXIT WHILE
      END IF
    
   END WHILE    
      
   CALL cl_set_act_visible("accept,cancel", TRUE)
    
END FUNCTION
]]>
  </section>
  <section id="adbt500.ui_headershow" ver="26" status="" src="s">
    <![CDATA[#+ 單頭資料重新顯示
PRIVATE FUNCTION adbt500_ui_headershow()
   #add-point:ui_headershow段define
   {<point name="ui_headershow.define"/>}
   #end add-point    
   
   LET g_xmda_m.xmdadocno = g_browser[g_current_idx].b_xmdadocno   
 
   EXECUTE adbt500_master_referesh USING g_xmda_m.xmdadocno INTO g_xmda_m.xmdasite,g_xmda_m.xmdadocdt, 
       g_xmda_m.xmdadocno,g_xmda_m.xmda001,g_xmda_m.xmda005,g_xmda_m.xmda202,g_xmda_m.xmda023,g_xmda_m.xmda004, 
       g_xmda_m.xmda200,g_xmda_m.xmda201,g_xmda_m.xmdastus,g_xmda_m.xmda007,g_xmda_m.xmda008,g_xmda_m.xmda021, 
       g_xmda_m.xmda022,g_xmda_m.xmda203,g_xmda_m.xmda027,g_xmda_m.xmda024,g_xmda_m.xmda002,g_xmda_m.xmda003, 
       g_xmda_m.xmdaunit,g_xmda_m.xmda204,g_xmda_m.xmda205,g_xmda_m.xmda032,g_xmda_m.xmda071,g_xmda_m.xmda025, 
       g_xmda_m.xmda026,g_xmda_m.xmda206,g_xmda_m.xmda207,g_xmda_m.xmda020,g_xmda_m.xmda036,g_xmda_m.xmda009, 
       g_xmda_m.xmda010,g_xmda_m.xmda015,g_xmda_m.xmda016,g_xmda_m.xmda011,g_xmda_m.xmda012,g_xmda_m.xmda013, 
       g_xmda_m.xmda035,g_xmda_m.xmda039,g_xmda_m.xmdaownid,g_xmda_m.xmdaowndp,g_xmda_m.xmdacrtid,g_xmda_m.xmdacrtdp, 
       g_xmda_m.xmdacrtdt,g_xmda_m.xmdamodid,g_xmda_m.xmdamoddt,g_xmda_m.xmdacnfid,g_xmda_m.xmdacnfdt, 
       g_xmda_m.xmda034,g_xmda_m.xmda006,g_xmda_m.xmda033,g_xmda_m.xmda017,g_xmda_m.xmda019,g_xmda_m.xmda018, 
       g_xmda_m.xmda044,g_xmda_m.xmda030,g_xmda_m.xmda031,g_xmda_m.xmda045,g_xmda_m.xmda046,g_xmda_m.xmda047, 
       g_xmda_m.xmda028,g_xmda_m.xmda041,g_xmda_m.xmda042,g_xmda_m.xmda043,g_xmda_m.xmdasite_desc,g_xmda_m.xmda202_desc, 
       g_xmda_m.xmda023_desc,g_xmda_m.xmda004_desc,g_xmda_m.xmda200_desc,g_xmda_m.xmda201_desc,g_xmda_m.xmda021_desc, 
       g_xmda_m.xmda022_desc,g_xmda_m.xmda203_desc,g_xmda_m.xmda027_desc,g_xmda_m.xmda024_desc,g_xmda_m.xmda002_desc, 
       g_xmda_m.xmda003_desc,g_xmda_m.xmdaunit_desc,g_xmda_m.xmda204_desc,g_xmda_m.xmda032_desc,g_xmda_m.xmda206_desc, 
       g_xmda_m.xmda207_desc,g_xmda_m.xmda020_desc,g_xmda_m.xmda036_desc,g_xmda_m.xmda009_desc,g_xmda_m.xmda010_desc, 
       g_xmda_m.xmda015_desc,g_xmda_m.xmdaownid_desc,g_xmda_m.xmdaowndp_desc,g_xmda_m.xmdacrtid_desc, 
       g_xmda_m.xmdacrtdp_desc,g_xmda_m.xmdamodid_desc,g_xmda_m.xmdacnfid_desc,g_xmda_m.xmda034_desc, 
       g_xmda_m.xmda017_desc,g_xmda_m.xmda018_desc
   CALL adbt500_show()
   
END FUNCTION
]]>
  </section>
  <section id="adbt500.unlock_b" ver="15" status="" src="s">
    <![CDATA[#+ 連動unlock其他單身table資料
PRIVATE FUNCTION adbt500_unlock_b(ps_table,ps_page)
   DEFINE ps_page     STRING
   DEFINE ps_table    STRING
   DEFINE ls_group    STRING
   #add-point:unlock_b段define
   {<point name="unlock_b.define"/>}
   #end add-point  
   
   LET ls_group = "'1',"
   
   IF ls_group.getIndexOf(ps_page,1) THEN
      CLOSE adbt500_bcl
   END IF
   
   LET ls_group = "'2',"
   
   IF ls_group.getIndexOf(ps_page,1) THEN
      CLOSE adbt500_bcl2
   END IF
 
   LET ls_group = "'3',"
   
   IF ls_group.getIndexOf(ps_page,1) THEN
      CLOSE adbt500_bcl3
   END IF
 
   LET ls_group = "'4',"
   
   IF ls_group.getIndexOf(ps_page,1) THEN
      CLOSE adbt500_bcl4
   END IF
 
   LET ls_group = "'5',"
   
   IF ls_group.getIndexOf(ps_page,1) THEN
      CLOSE adbt500_bcl5
   END IF
 
 
   
 
 
   #add-point:unlock_b段other
   {<point name="unlock_b.other"/>}
   #end add-point  
 
END FUNCTION
]]>
  </section>
  <section id="adbt500.update_b" ver="46" status="" src="s">
    <![CDATA[#+ 修改單身後其他table連動
PRIVATE FUNCTION adbt500_update_b(ps_table,ps_keys,ps_keys_bak,ps_page)
   DEFINE ps_table         STRING
   DEFINE ps_page          STRING
   DEFINE ps_keys          DYNAMIC ARRAY OF VARCHAR(500)
   DEFINE ps_keys_bak      DYNAMIC ARRAY OF VARCHAR(500)
   DEFINE ls_group         STRING
   DEFINE li_idx           LIKE type_t.num5 
   DEFINE lb_chk           BOOLEAN
   DEFINE l_new_key        DYNAMIC ARRAY OF STRING
   DEFINE l_old_key        DYNAMIC ARRAY OF STRING
   DEFINE l_field_key      DYNAMIC ARRAY OF STRING
   #add-point:update_b段define
   {<point name="update_b.define"/>}
   #end add-point     
   
   #判斷key是否有改變
   LET lb_chk = TRUE
   FOR li_idx = 1 TO ps_keys.getLength()
      IF ps_keys[li_idx] <> ps_keys_bak[li_idx] THEN
         LET lb_chk = FALSE
         EXIT FOR
      END IF
   END FOR
   
   #不需要做處理
   IF lb_chk THEN
      RETURN
   END IF
   
   #判斷是否是同一群組的table
   LET ls_group = "'1',"
   IF ls_group.getIndexOf(ps_page,1) > 0 AND ps_table <> "xmdc_t" THEN
      #add-point:update_b段修改前
      {<point name="update_b.before_update" mark="Y"/>}
      #end add-point     
      UPDATE xmdc_t 
         SET (xmdcdocno,
              xmdcseq
              ,xmdcsite,xmdc027,xmdc001,xmdc002,xmdc004,xmdc005,xmdc006,xmdc007,xmdc008,xmdc009,xmdc024,xmdc012,xmdc013,xmdc045,xmdc010,xmdc011,xmdc015,xmdc016,xmdc017,xmdc046,xmdc047,xmdc048,xmdc023,xmdc019,xmdc020,xmdc021,xmdc022,xmdc051,xmdcunit,xmdcorga,xmdc052,xmdc049,xmdc053,xmdc050) 
              = 
             (ps_keys[1],ps_keys[2]
              ,g_xmdc_d[g_detail_idx].xmdcsite,g_xmdc_d[g_detail_idx].xmdc027,g_xmdc_d[g_detail_idx].xmdc001, 
                  g_xmdc_d[g_detail_idx].xmdc002,g_xmdc_d[g_detail_idx].xmdc004,g_xmdc_d[g_detail_idx].xmdc005, 
                  g_xmdc_d[g_detail_idx].xmdc006,g_xmdc_d[g_detail_idx].xmdc007,g_xmdc_d[g_detail_idx].xmdc008, 
                  g_xmdc_d[g_detail_idx].xmdc009,g_xmdc_d[g_detail_idx].xmdc024,g_xmdc_d[g_detail_idx].xmdc012, 
                  g_xmdc_d[g_detail_idx].xmdc013,g_xmdc_d[g_detail_idx].xmdc045,g_xmdc_d[g_detail_idx].xmdc010, 
                  g_xmdc_d[g_detail_idx].xmdc011,g_xmdc_d[g_detail_idx].xmdc015,g_xmdc_d[g_detail_idx].xmdc016, 
                  g_xmdc_d[g_detail_idx].xmdc017,g_xmdc_d[g_detail_idx].xmdc046,g_xmdc_d[g_detail_idx].xmdc047, 
                  g_xmdc_d[g_detail_idx].xmdc048,g_xmdc_d[g_detail_idx].xmdc023,g_xmdc_d[g_detail_idx].xmdc019, 
                  g_xmdc_d[g_detail_idx].xmdc020,g_xmdc_d[g_detail_idx].xmdc021,g_xmdc_d[g_detail_idx].xmdc022, 
                  g_xmdc_d[g_detail_idx].xmdc051,g_xmdc_d[g_detail_idx].xmdcunit,g_xmdc_d[g_detail_idx].xmdcorga, 
                  g_xmdc_d[g_detail_idx].xmdc052,g_xmdc_d[g_detail_idx].xmdc049,g_xmdc_d[g_detail_idx].xmdc053, 
                  g_xmdc_d[g_detail_idx].xmdc050) 
         WHERE xmdcent = g_enterprise AND xmdcdocno = ps_keys_bak[1] AND xmdcseq = ps_keys_bak[2]
      #add-point:update_b段修改中
      {<point name="update_b.m_update"/>}
      #end add-point   
      CASE
         WHEN SQLCA.sqlerrd[3] = 0  #更新不到的處理
            CALL cl_err("xmdc_t","std-00009",1)
            CALL s_transaction_end('N','0')
         WHEN SQLCA.sqlcode #其他錯誤
            CALL cl_err("xmdc_t",SQLCA.sqlcode,1)  
            CALL s_transaction_end('N','0')
         OTHERWISE
            
      END CASE
      #add-point:update_b段修改後
      {<point name="update_b.after_update"/>}
      #end add-point  
   END IF
   
   LET ls_group = "'2',"
   #判斷是否是同一群組的table
   IF ls_group.getIndexOf(ps_page,1) > 0 AND ps_table <> "xmdd_t" THEN
      #add-point:update_b段修改前
      {<point name="update_b.before_update2" mark="Y"/>}
      #end add-point     
      UPDATE xmdd_t 
         SET (xmdddocno,
              xmddseq,xmddseq1,xmddseq2
              ,xmdd229,xmdd003,xmdd001,xmdd002,xmdd200,xmdd004,xmdd005,xmdd011,xmdd012,xmdd006,xmdd201,xmdd202,xmdd024,xmdd025,xmdd026,xmdd027,xmdd203,xmdd204,xmdd205,xmdd206,xmdd029,xmdd028,xmdd019,xmdd030,xmdd207,xmddunit,xmdd210,xmdd212,xmdd213,xmdd214,xmdd215,xmdd031,xmdd014,xmdd015,xmdd016,xmdd017,xmdd221,xmddsite,xmdd218,xmdd219,xmdd220,xmdd222,xmdd223,xmdd224,xmddorga,xmdd226,xmdd227,xmdd228,xmdd013,xmdd009,xmdd018,xmdd020,xmdd021,xmdd022,xmdd023) 
              = 
             (ps_keys[1],ps_keys[2],ps_keys[3],ps_keys[4]
              ,g_xmdc3_d[g_detail_idx].xmdd229,g_xmdc3_d[g_detail_idx].xmdd003,g_xmdc3_d[g_detail_idx].xmdd001, 
                  g_xmdc3_d[g_detail_idx].xmdd002,g_xmdc3_d[g_detail_idx].xmdd200,g_xmdc3_d[g_detail_idx].xmdd004, 
                  g_xmdc3_d[g_detail_idx].xmdd005,g_xmdc3_d[g_detail_idx].xmdd011,g_xmdc3_d[g_detail_idx].xmdd012, 
                  g_xmdc3_d[g_detail_idx].xmdd006,g_xmdc3_d[g_detail_idx].xmdd201,g_xmdc3_d[g_detail_idx].xmdd202, 
                  g_xmdc3_d[g_detail_idx].xmdd024,g_xmdc3_d[g_detail_idx].xmdd025,g_xmdc3_d[g_detail_idx].xmdd026, 
                  g_xmdc3_d[g_detail_idx].xmdd027,g_xmdc3_d[g_detail_idx].xmdd203,g_xmdc3_d[g_detail_idx].xmdd204, 
                  g_xmdc3_d[g_detail_idx].xmdd205,g_xmdc3_d[g_detail_idx].xmdd206,g_xmdc3_d[g_detail_idx].xmdd029, 
                  g_xmdc3_d[g_detail_idx].xmdd028,g_xmdc3_d[g_detail_idx].xmdd019,g_xmdc3_d[g_detail_idx].xmdd030, 
                  g_xmdc3_d[g_detail_idx].xmdd207,g_xmdc3_d[g_detail_idx].xmddunit,g_xmdc3_d[g_detail_idx].xmdd210, 
                  g_xmdc3_d[g_detail_idx].xmdd212,g_xmdc3_d[g_detail_idx].xmdd213,g_xmdc3_d[g_detail_idx].xmdd214, 
                  g_xmdc3_d[g_detail_idx].xmdd215,g_xmdc3_d[g_detail_idx].xmdd031,g_xmdc3_d[g_detail_idx].xmdd014, 
                  g_xmdc3_d[g_detail_idx].xmdd015,g_xmdc3_d[g_detail_idx].xmdd016,g_xmdc3_d[g_detail_idx].xmdd017, 
                  g_xmdc3_d[g_detail_idx].xmdd221,g_xmdc3_d[g_detail_idx].xmddsite,g_xmdc3_d[g_detail_idx].xmdd218, 
                  g_xmdc3_d[g_detail_idx].xmdd219,g_xmdc3_d[g_detail_idx].xmdd220,g_xmdc3_d[g_detail_idx].xmdd222, 
                  g_xmdc3_d[g_detail_idx].xmdd223,g_xmdc3_d[g_detail_idx].xmdd224,g_xmdc3_d[g_detail_idx].xmddorga, 
                  g_xmdc3_d[g_detail_idx].xmdd226,g_xmdc3_d[g_detail_idx].xmdd227,g_xmdc3_d[g_detail_idx].xmdd228, 
                  g_xmdc3_d[g_detail_idx].xmdd013,g_xmdc3_d[g_detail_idx].xmdd009,g_xmdc3_d[g_detail_idx].xmdd018, 
                  g_xmdc3_d[g_detail_idx].xmdd020,g_xmdc3_d[g_detail_idx].xmdd021,g_xmdc3_d[g_detail_idx].xmdd022, 
                  g_xmdc3_d[g_detail_idx].xmdd023) 
         WHERE xmddent = g_enterprise AND xmdddocno = ps_keys_bak[1] AND xmddseq = ps_keys_bak[2] AND xmddseq1 = ps_keys_bak[3] AND xmddseq2 = ps_keys_bak[4]
      #add-point:update_b段修改中
      {<point name="update_b.m_update2"/>}
      #end add-point  
      CASE
         WHEN SQLCA.sqlerrd[3] = 0  #更新不到的處理
            CALL cl_err("xmdd_t","std-00009",1)
            CALL s_transaction_end('N','0')
         WHEN SQLCA.sqlcode #其他錯誤
            CALL cl_err("xmdd_t",SQLCA.sqlcode,1)  
            CALL s_transaction_end('N','0')
         OTHERWISE
            
      END CASE
      #add-point:update_b段修改後
      {<point name="update_b.after_update2"/>}
      #end add-point  
   END IF
 
   LET ls_group = "'3',"
   #判斷是否是同一群組的table
   IF ls_group.getIndexOf(ps_page,1) > 0 AND ps_table <> "xmja_t" THEN
      #add-point:update_b段修改前
      {<point name="update_b.before_update3" mark="Y"/>}
      #end add-point     
      UPDATE xmja_t 
         SET (xmjadocno,
              xmjaseq
              ,xmjaunit,xmjasite,xmja001,xmja002,xmja003,xmja033,xmja004,xmja005,xmja006,xmja007,xmja011,xmja012,xmja013,xmja014,xmja015,xmja016,xmja017,xmja018,xmja008,xmja009,xmja010,xmja022,xmja019,xmja020,xmja021,xmja024,xmja025,xmja026,xmja027,xmja028,xmja029,xmja030,xmja031,xmja032,xmja034) 
              = 
             (ps_keys[1],ps_keys[2]
              ,g_xmdc4_d[g_detail_idx].xmjaunit,g_xmdc4_d[g_detail_idx].xmjasite,g_xmdc4_d[g_detail_idx].xmja001, 
                  g_xmdc4_d[g_detail_idx].xmja002,g_xmdc4_d[g_detail_idx].xmja003,g_xmdc4_d[g_detail_idx].xmja033, 
                  g_xmdc4_d[g_detail_idx].xmja004,g_xmdc4_d[g_detail_idx].xmja005,g_xmdc4_d[g_detail_idx].xmja006, 
                  g_xmdc4_d[g_detail_idx].xmja007,g_xmdc4_d[g_detail_idx].xmja011,g_xmdc4_d[g_detail_idx].xmja012, 
                  g_xmdc4_d[g_detail_idx].xmja013,g_xmdc4_d[g_detail_idx].xmja014,g_xmdc4_d[g_detail_idx].xmja015, 
                  g_xmdc4_d[g_detail_idx].xmja016,g_xmdc4_d[g_detail_idx].xmja017,g_xmdc4_d[g_detail_idx].xmja018, 
                  g_xmdc4_d[g_detail_idx].xmja008,g_xmdc4_d[g_detail_idx].xmja009,g_xmdc4_d[g_detail_idx].xmja010, 
                  g_xmdc4_d[g_detail_idx].xmja022,g_xmdc4_d[g_detail_idx].xmja019,g_xmdc4_d[g_detail_idx].xmja020, 
                  g_xmdc4_d[g_detail_idx].xmja021,g_xmdc4_d[g_detail_idx].xmja024,g_xmdc4_d[g_detail_idx].xmja025, 
                  g_xmdc4_d[g_detail_idx].xmja026,g_xmdc4_d[g_detail_idx].xmja027,g_xmdc4_d[g_detail_idx].xmja028, 
                  g_xmdc4_d[g_detail_idx].xmja029,g_xmdc4_d[g_detail_idx].xmja030,g_xmdc4_d[g_detail_idx].xmja031, 
                  g_xmdc4_d[g_detail_idx].xmja032,g_xmdc4_d[g_detail_idx].xmja034) 
         WHERE xmjaent = g_enterprise AND xmjadocno = ps_keys_bak[1] AND xmjaseq = ps_keys_bak[2]
      #add-point:update_b段修改中
      {<point name="update_b.m_update3"/>}
      #end add-point  
      CASE
         WHEN SQLCA.sqlerrd[3] = 0  #更新不到的處理
            CALL cl_err("xmja_t","std-00009",1)
            CALL s_transaction_end('N','0')
         WHEN SQLCA.sqlcode #其他錯誤
            CALL cl_err("xmja_t",SQLCA.sqlcode,1)  
            CALL s_transaction_end('N','0')
         OTHERWISE
            
      END CASE
      #add-point:update_b段修改後
      {<point name="update_b.after_update3"/>}
      #end add-point  
   END IF
 
   LET ls_group = "'4',"
   #判斷是否是同一群組的table
   IF ls_group.getIndexOf(ps_page,1) > 0 AND ps_table <> "xmdb_t" THEN
      #add-point:update_b段修改前
      {<point name="update_b.before_update4" mark="Y"/>}
      #end add-point     
      UPDATE xmdb_t 
         SET (xmdbdocno,
              xmdb001
              ,xmdbsite,xmdb002,xmdb003,xmdb004,xmdb005,xmdb006,xmdb007,xmdb008,xmdb009) 
              = 
             (ps_keys[1],ps_keys[2]
              ,g_xmdc5_d[g_detail_idx].xmdbsite,g_xmdc5_d[g_detail_idx].xmdb002,g_xmdc5_d[g_detail_idx].xmdb003, 
                  g_xmdc5_d[g_detail_idx].xmdb004,g_xmdc5_d[g_detail_idx].xmdb005,g_xmdc5_d[g_detail_idx].xmdb006, 
                  g_xmdc5_d[g_detail_idx].xmdb007,g_xmdc5_d[g_detail_idx].xmdb008,g_xmdc5_d[g_detail_idx].xmdb009)  

         WHERE xmdbent = g_enterprise AND xmdbdocno = ps_keys_bak[1] AND xmdb001 = ps_keys_bak[2]
      #add-point:update_b段修改中
      {<point name="update_b.m_update4"/>}
      #end add-point  
      CASE
         WHEN SQLCA.sqlerrd[3] = 0  #更新不到的處理
            CALL cl_err("xmdb_t","std-00009",1)
            CALL s_transaction_end('N','0')
         WHEN SQLCA.sqlcode #其他錯誤
            CALL cl_err("xmdb_t",SQLCA.sqlcode,1)  
            CALL s_transaction_end('N','0')
         OTHERWISE
            
      END CASE
      #add-point:update_b段修改後
      {<point name="update_b.after_update4"/>}
      #end add-point  
   END IF
 
   LET ls_group = "'5',"
   #判斷是否是同一群組的table
   IF ls_group.getIndexOf(ps_page,1) > 0 AND ps_table <> "xrcd_t" THEN
      #add-point:update_b段修改前
      {<point name="update_b.before_update5" mark="Y"/>}
      #end add-point     
      UPDATE xrcd_t 
         SET (xrcddocno,
              xrcdld,xrcdseq,xrcdseq2,xrcd007
              ,xrcd002,xrcd003,xrcd006,xrcd004,xrcd104) 
              = 
             (ps_keys[1],ps_keys[2],ps_keys[3],ps_keys[4],ps_keys[5]
              ,g_xmdc6_d[g_detail_idx].xrcd002,g_xmdc6_d[g_detail_idx].xrcd003,g_xmdc6_d[g_detail_idx].xrcd006, 
                  g_xmdc6_d[g_detail_idx].xrcd004,g_xmdc6_d[g_detail_idx].xrcd104) 
         WHERE xrcdent = g_enterprise AND xrcddocno = ps_keys_bak[1] AND xrcdld = ps_keys_bak[2] AND xrcdseq = ps_keys_bak[3] AND xrcdseq2 = ps_keys_bak[4] AND xrcd007 = ps_keys_bak[5]
      #add-point:update_b段修改中
      {<point name="update_b.m_update5"/>}
      #end add-point  
      CASE
         WHEN SQLCA.sqlerrd[3] = 0  #更新不到的處理
            CALL cl_err("xrcd_t","std-00009",1)
            CALL s_transaction_end('N','0')
         WHEN SQLCA.sqlcode #其他錯誤
            CALL cl_err("xrcd_t",SQLCA.sqlcode,1)  
            CALL s_transaction_end('N','0')
         OTHERWISE
            
      END CASE
      #add-point:update_b段修改後
      {<point name="update_b.after_update5"/>}
      #end add-point  
   END IF
 
 
   
 
   
 
   
   #add-point:update_b段other
   {<point name="update_b.other"/>}
   #end add-point  
   
END FUNCTION
]]>
  </section>
</add_points>
