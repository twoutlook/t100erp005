<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<add_points prog="adbm201" std_prog="adbm201" erpver="1.0" module="ADB" ver="9" env="s" zone="t10prd" booking="Y" type="M" identity="s" section_flag="N" designer_ver="1.0">
  <other>
    <code_template value="F" status="u"/>
    <free_style value="Y" status="u"/>
    <start_arg value="" status="u"/>
  </other>
  <point name="function.adbm201_init" order="1" ver="8" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adbm201_init()
   #add-point:init段define
             {#ADP版次:1#}
   DEFINE l_success LIKE type_t.num5 #150308-00001#1  By Ken 150309             
   #end add-point

   CALL cl_set_combo_scc_part('pmaastus','50','N,X,Y')


   LET g_error_show = 1
   LET gwin_curr = ui.Window.getCurrent()
   LET gfrm_curr = gwin_curr.getForm()

   #add-point:畫面資料初始化
   CALL s_aooi500_create_temp() RETURNING l_success #150308-00001#1  By Ken 150309   
   CALL cl_set_combo_scc('oofb008','9')
   CALL cl_set_combo_scc('oofc008','6')
   LET g_errshow = 1
   #嵌入
   CALL cl_ui_replace_sub_window(cl_ap_formpath("aoo", "aooi350_01"), "grid_2", "Table", "s_detail1_aooi350_01")
   CALL cl_set_combo_scc('oofb008','9')   #地址類型
   CALL cl_ui_replace_sub_window(cl_ap_formpath("aoo", "aooi350_02"), "grid_3", "Table", "s_detail1_aooi350_02")
   CALL cl_set_combo_scc('oofc008','6')   #通訊類型
   {#ADP版次:1#}
   #end add-point

   CALL adbm201_default_search()

END FUNCTION]]>
  </point>
  <point name="function.adbm201_ui_dialog" order="2" ver="9" cite_std="N" new="Y" status="u" src="s" readonly="" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adbm201_ui_dialog()
   {<Local define>}
   DEFINE li_exit  LIKE type_t.num5    #判別是否為離開作業
   DEFINE li_idx   LIKE type_t.num5
   {</Local define>}
   #add-point:ui_dialog段define
             {#ADP版次:1#}
   #end add-point

   LET li_exit = FALSE
   LET g_current_row = 0
   LET g_current_idx = 1
   CALL gfrm_curr.setElementImage("logo","logo/applogo.png")

   IF g_wc.trim() <> "1=1" THEN
      CALL gfrm_curr.setElementHidden("mainlayout",0)
      CALL gfrm_curr.setElementHidden("worksheet",1)
      LET g_main_hidden = 0
   ELSE
      CALL gfrm_curr.setElementHidden("mainlayout",1)
      CALL gfrm_curr.setElementHidden("worksheet",0)
      LET g_main_hidden = 1
   END IF

   #action default動作
   #+ 此段落由子樣板a42產生
   CASE g_actdefault
      WHEN "insert"
         LET g_action_choice="insert"
         LET g_actdefault = ""
         IF cl_auth_chk_act("insert") THEN
            CALL adbm201_insert()
            #add-point:ON ACTION insert
                      {#ADP版次:1#}
            #END add-point
         END IF

      #add-point:action default自訂
                {#ADP版次:1#}
      #end add-point
      OTHERWISE

   END CASE



   #add-point:ui_dialog段before dialog
             {#ADP版次:1#}
   #end add-point

   WHILE li_exit = FALSE

      CALL adbm201_browser_fill(g_wc,"")
      CALL lib_cl_dlg.cl_dlg_before_display()
      CALL cl_notice()

      #判斷前一個動作是否為新增, 若是的話切換到新增的筆數
      IF g_state = "Y" THEN
         FOR li_idx = 1 TO g_browser.getLength()
            IF g_browser[li_idx].b_pmaa001 = g_pmaa001_t

               THEN
               LET g_current_row = li_idx
               EXIT FOR
            END IF
         END FOR
         LET g_state = ""
      END IF
      
      DIALOG ATTRIBUTES(UNBUFFERED,FIELD ORDER FORM)
         
         #左側瀏覽頁簽
         DISPLAY ARRAY g_browser TO s_browse.* ATTRIBUTE(COUNT=g_rec_b)

            BEFORE ROW
               #回歸舊筆數位置 (回到當時異動的筆數)
               LET g_current_idx = DIALOG.getCurrentRow("s_browse")
               IF g_current_idx = 0 THEN
                  LET g_current_idx = 1
               END IF
               LET g_current_row = g_current_idx  #目前指標
               LET g_current_sw = TRUE
               CALL cl_show_fld_cont()

               #當每次點任一筆資料都會需要用到
               CALL adbm201_fetch("")


            ON COLLAPSE (g_row_index)
               #樹關閉

         END DISPLAY
         
         SUBDIALOG aoo_aooi350_01.aooi350_01_display
         SUBDIALOG aoo_aooi350_02.aooi350_02_display
         SUBDIALOG lib_cl_dlg.cl_dlg_qryplan
         SUBDIALOG lib_cl_dlg.cl_dlg_relateapps
         
         BEFORE DIALOG

            CALL cl_navigator_setting(g_current_idx, g_current_cnt)

            #還原為原本指定筆數
            IF g_current_row > 0 THEN
               LET g_current_idx = g_current_row
            END IF

            #當每次點任一筆資料都會需要用到
            IF g_browser_cnt > 0 THEN
               CALL adbm201_fetch("")
            END IF
            CALL adbm201_set_act_visible()      #150424-00018#1 150529 add by beckxie
            CALL adbm201_set_act_no_visible()   #150424-00018#1 150529 add by beckxie
            #end add-point

         ON ACTION statechange
            CALL adbm201_statechange()
            LET g_action_choice="statechange"

         ON ACTION first
            CALL adbm201_fetch("F")
            LET g_current_row = g_current_idx

         ON ACTION next
            CALL adbm201_fetch("N")
            LET g_current_row = g_current_idx

         ON ACTION jump
            CALL adbm201_fetch("/")
            LET g_current_row = g_current_idx

         ON ACTION previous
            CALL adbm201_fetch("P")
            LET g_current_row = g_current_idx

         ON ACTION last
            CALL adbm201_fetch("L")
            #CALL cl_navigator_setting(g_current_idx, g_current_cnt)
            #CALL fgl_set_arr_curr(g_current_idx)
            LET g_current_row = g_current_idx

         ON ACTION exit
            LET g_action_choice="exit"
            LET INT_FLAG = FALSE
            LET li_exit = TRUE
            EXIT DIALOG

         ON ACTION close
            LET li_exit = TRUE
            EXIT DIALOG

         ON ACTION mainhidden       #主頁摺疊
            IF g_main_hidden THEN
               CALL gfrm_curr.setElementHidden("mainlayout",0)
               CALL gfrm_curr.setElementHidden("worksheet",1)
               LET g_main_hidden = 0
            ELSE
               CALL gfrm_curr.setElementHidden("mainlayout",1)
               CALL gfrm_curr.setElementHidden("worksheet",0)
               LET g_main_hidden = 1
            END IF
            EXIT DIALOG

         ON ACTION worksheethidden   #瀏覽頁折疊
            IF g_main_hidden THEN
               CALL gfrm_curr.setElementHidden("mainlayout",0)
               CALL gfrm_curr.setElementHidden("worksheet",1)
               LET g_main_hidden = 0
            ELSE
               CALL gfrm_curr.setElementHidden("mainlayout",1)
               CALL gfrm_curr.setElementHidden("worksheet",0)
               LET g_main_hidden = 1
            END IF
            EXIT DIALOG

         #單頭摺疊，可利用hot key "Ctrl-s"開啟/關閉單頭
         ON ACTION controls
            IF g_header_hidden THEN
               CALL gfrm_curr.setElementHidden("worksheet_detail",0)
               CALL gfrm_curr.setElementImage("controls","small/arr-u.png")
               LET g_header_hidden = 0     #visible
            ELSE
               CALL gfrm_curr.setElementHidden("worksheet_detail",1)
               CALL gfrm_curr.setElementImage("controls","small/arr-d.png")
               LET g_header_hidden = 1     #hidden
            END IF



         ON ACTION delete

            LET g_action_choice="delete"
            IF cl_auth_chk_act("delete") THEN
               CALL adbm201_delete()
               #add-point:ON ACTION delete
                         {#ADP版次:1#}
               #END add-point
            END IF


         ON ACTION insert

            LET g_action_choice="insert"
            IF cl_auth_chk_act("insert") THEN
               CALL adbm201_insert()
               #add-point:ON ACTION insert
                         {#ADP版次:1#}
               #END add-point
               EXIT DIALOG
            END IF


         ON ACTION modify

            LET g_aw = ''
            LET g_action_choice="modify"
            IF cl_auth_chk_act("modify") THEN
               CALL adbm201_modify()
               #add-point:ON ACTION modify
                         {#ADP版次:1#}
               #END add-point
               EXIT DIALOG
            END IF


         ON ACTION output

            LET g_action_choice="output"
            IF cl_auth_chk_act("output") THEN
               #add-point:ON ACTION output
                         {#ADP版次:1#}
               #END add-point
               EXIT DIALOG
            END IF


         ON ACTION query

            LET g_action_choice="query"
            IF cl_auth_chk_act("query") THEN
               CALL adbm201_query()
               #add-point:ON ACTION query
               LET g_main_hidden = 0
               
                         {#ADP版次:1#}
             
               #END add-point
            END IF


         ON ACTION reproduce

            LET g_action_choice="reproduce"
            IF cl_auth_chk_act("reproduce") THEN
               CALL adbm201_reproduce()
               #add-point:ON ACTION reproduce
                         {#ADP版次:1#}
               #END add-point
               EXIT DIALOG
            END IF
            
            
         ON ACTION exporttoexcel 
            LET g_action_choice="exporttoexcel"
            IF cl_auth_chk_act("exporttoexcel") THEN
               CALL g_export_node.clear()
               IF g_main_hidden = 1 THEN
                  LET g_export_node[1] = base.typeInfo.create(g_browser)
                  LET g_export_id[1]   = "s_browse"
                  CALL cl_export_to_excel()
               #非browser
               ELSE
                  LET g_export_node[1] = base.typeInfo.create(g_pmba_d)
                  LET g_export_id[1]   = "s_detail1_aooi350_01"
                  LET g_export_node[2] = base.typeInfo.create(g_pmba2_d)
                  LET g_export_id[2]   = "s_detail1_aooi350_02"


               CALL cl_export_to_excel_getpage()
               CALL cl_export_to_excel()
               END IF
            END IF   

         #主選單用ACTION
         &include "main_menu.4gl"
         &include "relating_action.4gl"
         #交談指令共用ACTION
         &include "common_action.4gl"

       END DIALOG

   END WHILE

END FUNCTION]]>
  </point>
  <point name="function.adbm201_browser_fill" order="3" ver="3" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adbm201_browser_fill(p_wc,ps_page_action)
   {<Local define>}
   DEFINE p_wc              STRING
   DEFINE ps_page_action    STRING
   DEFINE l_searchcol       STRING
   DEFINE l_sql             STRING
   DEFINE l_sql_rank        STRING
   DEFINE l_sub_sql         STRING
   {</Local define>}
   #add-point:browser_fill段define
             {#ADP版次:1#}
   #end add-point

   CLEAR FORM
   INITIALIZE g_pmaa_m.* TO NULL
   INITIALIZE g_wc TO NULL
   CALL g_browser.clear()

   #搜尋用
   IF cl_null(g_searchcol) OR g_searchcol = "0" THEN
      LET l_searchcol = "pmaa001"
   ELSE
      LET l_searchcol = g_searchcol
   END IF

   LET p_wc = p_wc.trim() #當查詢按下Q時 按下放棄 g_wc = "  " 所以要清掉空白
   IF cl_null(p_wc) THEN  #p_wc 查詢條件
      LET p_wc = " 1=1 "
   END IF

   #add-point:browser_fill段wc控制
   CALL aooi350_01_clear_detail()
   CALL aooi350_02_clear_detail()          {#ADP版次:1#}
   #end add-point
   LET l_sub_sql = " SELECT COUNT(DISTINCT pmaa001) FROM pmaa_t ",
                   "  LEFT JOIN pmaal_t ON pmaa001 = pmaal001 AND pmaal002 = '",g_lang,"' ",
                   "  LEFT JOIN oofb_t ON oofbent = pmaaent AND pmaa027 = oofb002", 
                   "  LEFT JOIN oofc_t ON oofcent = pmaaent AND pmaa027 = oofc002", 
                   " WHERE pmaaent = '" ||g_enterprise|| "' AND pmaa002 = '2' AND pmaa230 = '2' AND ",
                   p_wc CLIPPED
   #add-point:browser_fill段cnt_sql
  {#ADP版次:1#}
   #end add-point
				
   PREPARE header_cnt_pre FROM g_sql
   EXECUTE header_cnt_pre INTO g_browser_cnt
   FREE header_cnt_pre

   #若超過最大顯示筆數
   IF g_browser_cnt > g_max_browse AND g_error_show = 1 THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = '9035'
      LET g_errparam.extend = g_browser_cnt
      LET g_errparam.popup = TRUE
      CALL cl_err()

   END IF

      LET g_error_show = 0

   DISPLAY g_browser_cnt TO FORMONLY.b_count
   DISPLAY g_browser_cnt TO FORMONLY.h_count

   LET g_wc = p_wc
   #LET g_page_action = ps_page_action          # Keep Action

   IF ps_page_action = "F" OR
      ps_page_action = "P"  OR
      ps_page_action = "N"  OR
      ps_page_action = "L"  THEN
      LET g_page_action = ps_page_action
   END IF

   CASE ps_page_action

      WHEN "F"
         LET g_pagestart = 1

      WHEN "P"
         LET g_pagestart = g_pagestart - g_max_browse
         IF g_pagestart < 1 THEN
            LET g_pagestart = 1
         END IF

      WHEN "N"
         LET g_pagestart = g_pagestart + g_max_browse
         IF g_pagestart > g_browser_cnt THEN
            LET g_pagestart = g_browser_cnt - (g_browser_cnt mod g_max_browse) + 1
            WHILE g_pagestart > g_browser_cnt
               LET g_pagestart = g_pagestart - g_max_browse
            END WHILE
         END IF

      WHEN "L"
         LET g_pagestart = g_browser_cnt - (g_browser_cnt mod g_max_browse) + 1
         WHILE g_pagestart > g_browser_cnt
            LET g_pagestart = g_pagestart - g_max_browse
         END WHILE

      WHEN '/'
         LET g_pagestart = g_jump
         IF g_pagestart > g_browser_cnt THEN
            LET g_pagestart = 1
            INITIALIZE g_errparam TO NULL
            LET g_errparam.code = 'azz-998'
            LET g_errparam.extend = g_jump
            LET g_errparam.popup = FALSE
            CALL cl_err()

         END IF

      OTHERWISE

   END CASE
   #單身有輸入查詢條件且非null
   LET l_sql_rank = "SELECT DISTINCT pmaastus,pmaa095,'',pmaa001,'','','',",
                    "                pmaa005,'',pmaa006,'',pmaa090,'',pmaa026,",
                    "                '',RANK() OVER(ORDER BY pmaa001 ",g_order,") AS RANK ",
                    " FROM pmaa_t ",
                    " LEFT JOIN pmaal_t ON pmaa001 = pmaal001 AND pmaal002 = '",g_lang,"' ",
                    " LEFT JOIN oofb_t ON oofbent = pmaaent AND pmaa027 = oofb002", 
                    " LEFT JOIN oofc_t ON oofcent = pmaaent AND pmaa027 = oofc002", 
                    " WHERE pmaaent = '" ||g_enterprise|| "' AND pmaa002 = '2'",
                    "   AND pmaa230 = '2' AND ", g_wc

   #add-point:browser_fill段before_pre
             {#ADP版次:1#}
   #end add-point					
					
   #定義翻頁CURSOR
   LET g_sql= " SELECT pmaastus,pmaa095,'',pmaa001,'','','',pmaa005,'',pmaa006,'',pmaa090,'',pmaa026,
       '' FROM (",l_sql_rank,") ",
              "  WHERE RANK >= ", g_pagestart,
              "    AND RANK <  ", (g_pagestart + g_max_browse) ,
              "  ORDER BY ",l_searchcol," ",g_order

   PREPARE browse_pre FROM g_sql
   DECLARE browse_cur CURSOR FOR browse_pre

   CALL g_browser.clear()
   LET g_cnt = 1
   FOREACH browse_cur INTO g_browser[g_cnt].b_statepic,g_browser[g_cnt].b_pmaa095,g_browser[g_cnt].b_pmaa095_desc,
       g_browser[g_cnt].b_pmaa001,g_browser[g_cnt].b_pmaa001_desc,g_browser[g_cnt].b_pmaa001_desc_desc,
       g_browser[g_cnt].b_pmaa001_desc_desc_desc,g_browser[g_cnt].b_pmaa005,g_browser[g_cnt].b_pmaa005_desc,
       g_browser[g_cnt].b_pmaa006,g_browser[g_cnt].b_pmaa006_desc,g_browser[g_cnt].b_pmaa090,g_browser[g_cnt].b_pmaa090_desc,
       g_browser[g_cnt].b_pmaa026,g_browser[g_cnt].b_pmaa026_desc
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "foreach:"
         LET g_errparam.popup = TRUE
         CALL cl_err()

         EXIT FOREACH
      END IF


      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_browser[g_cnt].b_pmaa095
      CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
      LET g_browser[g_cnt].b_pmaa095_desc = '', g_rtn_fields[1] , ''
      DISPLAY BY NAME g_browser[g_cnt].b_pmaa095_desc

      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_browser[g_cnt].b_pmaa001
      CALL ap_ref_array2(g_ref_fields,"SELECT pmaal004 FROM pmaal_t WHERE pmaalent='"||g_enterprise||"' AND pmaal001=? AND pmaal002='"||g_lang||"'",
          "") RETURNING g_rtn_fields
      LET g_browser[g_cnt].b_pmaa001_desc = '', g_rtn_fields[1] , ''
      DISPLAY BY NAME g_browser[g_cnt].b_pmaa001_desc

      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_browser[g_cnt].b_pmaa001
      CALL ap_ref_array2(g_ref_fields,"SELECT pmaal003 FROM pmaal_t WHERE pmaalent='"||g_enterprise||"' AND pmaal001=? AND pmaal002='"||g_lang||"'",
          "") RETURNING g_rtn_fields
      LET g_browser[g_cnt].b_pmaa001_desc_desc = '', g_rtn_fields[1] , ''
      DISPLAY BY NAME g_browser[g_cnt].b_pmaa001_desc_desc

      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_browser[g_cnt].b_pmaa001
      CALL ap_ref_array2(g_ref_fields,"SELECT pmaal005 FROM pmaal_t WHERE pmaalent='"||g_enterprise||"' AND pmaal001=? AND pmaal002='"||g_lang||"'",
          "") RETURNING g_rtn_fields
      LET g_browser[g_cnt].b_pmaa001_desc_desc_desc = '', g_rtn_fields[1] , ''
      DISPLAY BY NAME g_browser[g_cnt].b_pmaa001_desc_desc_desc

      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_browser[g_cnt].b_pmaa005
      CALL ap_ref_array2(g_ref_fields,"SELECT pmaal003 FROM pmaal_t WHERE pmaalent='"||g_enterprise||"' AND pmaal001=? AND pmaal002='"||g_dlang||"'",
          "") RETURNING g_rtn_fields
      LET g_browser[g_cnt].b_pmaa005_desc = '', g_rtn_fields[1] , ''
      DISPLAY BY NAME g_browser[g_cnt].b_pmaa005_desc

      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_browser[g_cnt].b_pmaa006
      CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='261' AND oocql002=? AND oocql003='"||g_lang||"'",
          "") RETURNING g_rtn_fields
      LET g_browser[g_cnt].b_pmaa006_desc = '', g_rtn_fields[1] , ''
      DISPLAY BY NAME g_browser[g_cnt].b_pmaa006_desc

      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_browser[g_cnt].b_pmaa090
      CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='281' AND oocql002=? AND oocql003='"||g_lang||"'",
          "") RETURNING g_rtn_fields
      LET g_browser[g_cnt].b_pmaa090_desc = '', g_rtn_fields[1] , ''
      DISPLAY BY NAME g_browser[g_cnt].b_pmaa090_desc

      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_browser[g_cnt].b_pmaa026
      CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='250' AND oocql002=? AND oocql003='"||g_lang||"'",
          "") RETURNING g_rtn_fields
      LET g_browser[g_cnt].b_pmaa026_desc = '', g_rtn_fields[1] , ''
      DISPLAY BY NAME g_browser[g_cnt].b_pmaa026_desc


      #add-point:browser_fill段reference
                {#ADP版次:1#}
      #end add-point
      
      #browser段落顯示圖片
      CASE g_browser[g_cnt].b_statepic
         WHEN "N"
            LET g_browser[g_cnt].b_statepic = "stus/16/open.png"
         WHEN "X"
            LET g_browser[g_cnt].b_statepic = "stus/16/void.png"
         WHEN "Y"
            LET g_browser[g_cnt].b_statepic = "stus/16/valid.png"
      END CASE
      
      LET g_cnt = g_cnt + 1
      IF g_cnt > g_max_rec THEN
         EXIT FOREACH
      END IF
   END FOREACH

   CALL g_browser.deleteElement(g_cnt)
   LET g_header_cnt = g_browser.getLength()
   LET g_rec_b = g_cnt - 1
   LET g_current_cnt = g_rec_b
   LET g_cnt = 0

   CALL adbm201_fetch("")

   FREE browse_pre

   #若無資料則關閉相關功能
   IF g_browser_cnt = 0 THEN
      CALL cl_set_act_visible("statechange,modify,delete,reproduce", FALSE)
   ELSE
      CALL cl_set_act_visible("statechange,modify,delete,reproduce", TRUE)
   END IF

END FUNCTION]]>
  </point>
  <point name="function.adbm201_construct" order="4" ver="8" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adbm201_construct()
   {<Local define>}
   DEFINE ls_return      STRING
   DEFINE ls_result      STRING
   {</Local define>}
   #add-point:cs段define
             {#ADP版次:1#}
   #end add-point

   CLEAR FORM
   INITIALIZE g_pmaa_m.* TO NULL
   INITIALIZE g_wc TO NULL
   LET g_current_row = 1

   LET g_qryparam.state = "c"

   DIALOG ATTRIBUTES(UNBUFFERED,FIELD ORDER FORM)

      #螢幕上取條件
      CONSTRUCT BY NAME g_wc ON pmaa095,pmaa001,pmaal004,pmaal003,pmaal005,pmaa005,pmaa006,pmaa090,pmaa026,
          pmaa221,pmaa232,pmaa200,pmaa201,pmaa027,pmaa004,pmaa241,pmaa242,pmaa243,pmaa244,pmaastus,pmaaownid,pmaaowndp,pmaacrtid,pmaacrtdp,
          pmaacrtdt,pmaamodid,pmaamoddt,pmaacnfid,pmaacnfdt,pmaa017,pmaa016,pmaa018,pmaa019,pmaa021,
          pmaa022,pmaa020,ooff013,pmaa291,pmaa292,pmaa293,pmaa294,pmaa295,pmaa296,pmaa297,pmaa298,pmaa299,
          pmaa300

         BEFORE CONSTRUCT
            CALL cl_qbe_init()
            #add-point:cs段more_construct
            {#ADP版次:1#}
            #end add-point

         #公用欄位開窗相關處理
         #此段落由子樣板a11產生
         ##----<<pmaaownid>>----
         #ON ACTION controlp INFIELD pmaaownid
         #   CALL q_common('pmaa_t','pmaaownid',TRUE,FALSE,g_pmaa_m.pmaaownid) RETURNING ls_return
         #   DISPLAY ls_return TO pmaaownid
         #   NEXT FIELD pmaaownid
         #
         ##----<<pmaaowndp>>----
         #ON ACTION controlp INFIELD pmaaowndp
         #   CALL q_common('pmaa_t','pmaaowndp',TRUE,FALSE,g_pmaa_m.pmaaowndp) RETURNING ls_return
         #   DISPLAY ls_return TO pmaaowndp
         #   NEXT FIELD pmaaowndp
         #
         ##----<<pmaacrtid>>----
         #ON ACTION controlp INFIELD pmaacrtid
         #   CALL q_common('pmaa_t','pmaacrtid',TRUE,FALSE,g_pmaa_m.pmaacrtid) RETURNING ls_return
         #   DISPLAY ls_return TO pmaacrtid
         #   NEXT FIELD pmaacrtid
         #
         ##----<<pmaacrtdp>>----
         #ON ACTION controlp INFIELD pmaacrtdp
         #   CALL q_common('pmaa_t','pmaacrtdp',TRUE,FALSE,g_pmaa_m.pmaacrtdp) RETURNING ls_return
         #   DISPLAY ls_return TO pmaacrtdp
         #   NEXT FIELD pmaacrtdp
         #
         ##----<<pmaamodid>>----
         #ON ACTION controlp INFIELD pmaamodid
         #   CALL q_common('pmaa_t','pmaamodid',TRUE,FALSE,g_pmaa_m.pmaamodid) RETURNING ls_return
         #   DISPLAY ls_return TO pmaamodid
         #   NEXT FIELD pmaamodid
         #
         ##----<<pmaacnfid>>----
         #ON ACTION controlp INFIELD pmaacnfid
         #   CALL q_common('pmaa_t','pmaacnfid',TRUE,FALSE,g_pmaa_m.pmaacnfid) RETURNING ls_return
         #   DISPLAY ls_return TO pmaacnfid
         #   NEXT FIELD pmaacnfid
         #
         ##----<<pmaapstid>>----
         ##ON ACTION controlp INFIELD pmaapstid
         ##   CALL q_common('pmaa_t','pmaapstid',TRUE,FALSE,g_pmaa_m.pmaapstid) RETURNING ls_return
         ##   DISPLAY ls_return TO pmaapstid
         ##   NEXT FIELD pmaapstid

         ##----<<pmaacrtdt>>----
         AFTER FIELD pmaacrtdt
            CALL FGL_DIALOG_GETBUFFER() RETURNING ls_result
            IF NOT cl_null(ls_result) THEN
               IF NOT cl_chk_date_symbol(ls_result) THEN
                  LET ls_result = cl_add_date_extra_cond(ls_result)
               END IF
            END IF
            CALL FGL_DIALOG_SETBUFFER(ls_result)

         #----<<pmaamoddt>>----
         AFTER FIELD pmaamoddt
            CALL FGL_DIALOG_GETBUFFER() RETURNING ls_result
            IF NOT cl_null(ls_result) THEN
               IF NOT cl_chk_date_symbol(ls_result) THEN
                  LET ls_result = cl_add_date_extra_cond(ls_result)
               END IF
            END IF
            CALL FGL_DIALOG_SETBUFFER(ls_result)

         #----<<pmaacnfdt>>----
         AFTER FIELD pmaacnfdt
            CALL FGL_DIALOG_GETBUFFER() RETURNING ls_result
            IF NOT cl_null(ls_result) THEN
               IF NOT cl_chk_date_symbol(ls_result) THEN
                  LET ls_result = cl_add_date_extra_cond(ls_result)
               END IF
            END IF
            CALL FGL_DIALOG_SETBUFFER(ls_result)

         #----<<pmaapstdt>>----
         #AFTER FIELD pmaapstdt
         #   CALL FGL_DIALOG_GETBUFFER() RETURNING ls_result
         #   IF NOT cl_null(ls_result) THEN
         #      IF NOT cl_chk_date_symbol(ls_result) THEN
         #         LET ls_result = cl_add_date_extra_cond(ls_result)
         #      END IF
         #   END IF
         #   CALL FGL_DIALOG_SETBUFFER(ls_result)



         #一般欄位
         #---------------------------<  Master  >---------------------------
         #----<<pmaa095>>----
         #Ctrlp:construct.c.pmaa095
         ON ACTION controlp INFIELD pmaa095
            #add-point:ON ACTION controlp INFIELD pmaa095
                        #此段落由子樣板a08產生
            #開窗c段
			   INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			   LET g_qryparam.reqry = FALSE
			   LET g_qryparam.where = s_aooi500_q_where(g_prog,'pmaaunit',g_site,'c') #150308-00001#1  By Ken add 'c' 150309
			   CALL q_ooef001_24()                    #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa095  #顯示到畫面上

            NEXT FIELD pmaa095                     #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a01產生
         BEFORE FIELD pmaa095
            #add-point:BEFORE FIELD pmaa095
                      {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD pmaa095

            #add-point:AFTER FIELD pmaa095
                      {#ADP版次:1#}
            #END add-point


         #----<<pmaa001>>----
         #Ctrlp:construct.c.pmaa001
         ON ACTION controlp INFIELD pmaa001
            #add-point:ON ACTION controlp INFIELD pmaa001
                        #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			LET g_qryparam.where = " pmaa002 = '2' AND pmaa230 = '2'"
            CALL q_pmaa001()                       #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa001  #顯示到畫面上

            NEXT FIELD pmaa001                     #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a01產生
         BEFORE FIELD pmaa001
            #add-point:BEFORE FIELD pmaa001
                      {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD pmaa001

            #add-point:AFTER FIELD pmaa001
                      {#ADP版次:1#}
            #END add-point


         #----<<pmaal004>>----
         #此段落由子樣板a01產生
         BEFORE FIELD pmaal004
            #add-point:BEFORE FIELD pmaal004
                      {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD pmaal004

            #add-point:AFTER FIELD pmaal004
                      {#ADP版次:1#}
            #END add-point


         #Ctrlp:construct.c.pmaal004
#         ON ACTION controlp INFIELD pmaal004
            #add-point:ON ACTION controlp INFIELD pmaal004
                      {#ADP版次:1#}
            #END add-point

         #----<<pmaal003>>----
         #此段落由子樣板a01產生
         BEFORE FIELD pmaal003
            #add-point:BEFORE FIELD pmaal003
                      {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD pmaal003

            #add-point:AFTER FIELD pmaal003
                      {#ADP版次:1#}
            #END add-point


         #Ctrlp:construct.c.pmaal003
#         ON ACTION controlp INFIELD pmaal003
            #add-point:ON ACTION controlp INFIELD pmaal003
                      {#ADP版次:1#}
            #END add-point

         #----<<pmaal005>>----
         #此段落由子樣板a01產生
         BEFORE FIELD pmaal005
            #add-point:BEFORE FIELD pmaal005
                      {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD pmaal005

            #add-point:AFTER FIELD pmaal005
                      {#ADP版次:1#}
            #END add-point


         #Ctrlp:construct.c.pmaal005
#         ON ACTION controlp INFIELD pmaal005
            #add-point:ON ACTION controlp INFIELD pmaal005
                      {#ADP版次:1#}
            #END add-point

         #----<<pmaa005>>----
         #Ctrlp:construct.c.pmaa005
         ON ACTION controlp INFIELD pmaa005
            #add-point:ON ACTION controlp INFIELD pmaa005
                        #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_pmaa001_14()                    #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa005  #顯示到畫面上

            NEXT FIELD pmaa005                     #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a01產生
         BEFORE FIELD pmaa005
            #add-point:BEFORE FIELD pmaa005
                      {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD pmaa005

            #add-point:AFTER FIELD pmaa005
                      {#ADP版次:1#}
            #END add-point


         #----<<pmaa006>>----
         #Ctrlp:construct.c.pmaa006
         ON ACTION controlp INFIELD pmaa006
            #add-point:ON ACTION controlp INFIELD pmaa006
                        #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			LET g_qryparam.arg1 = "1" #客戶性質
            LET g_qryparam.arg2 = "2" #客戶經營類別
            CALL q_pmaa001_12()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa006  #顯示到畫面上

            NEXT FIELD pmaa006                     #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a01產生
         BEFORE FIELD pmaa006
            #add-point:BEFORE FIELD pmaa006
                      {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD pmaa006

            #add-point:AFTER FIELD pmaa006
                      {#ADP版次:1#}
            #END add-point


         #----<<pmaa090>>----
         #Ctrlp:construct.c.pmaa090
         ON ACTION controlp INFIELD pmaa090
            #add-point:ON ACTION controlp INFIELD pmaa090
            #此段落由子樣板a08產生
            #開窗c段
			   INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			   LET g_qryparam.reqry = FALSE
			   LET g_qryparam.arg1 = '281'
            CALL q_oocq002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa090  #顯示到畫面上

            NEXT FIELD pmaa090                     #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a01產生
         BEFORE FIELD pmaa090
            #add-point:BEFORE FIELD pmaa090
                      {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD pmaa090

            #add-point:AFTER FIELD pmaa090
                      {#ADP版次:1#}
            #END add-point


         #----<<pmaa026>>----
         #Ctrlp:construct.c.pmaa026
         ON ACTION controlp INFIELD pmaa026
            #add-point:ON ACTION controlp INFIELD pmaa026
                        #此段落由子樣板a08產生
            #開窗c段
			   INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			   LET g_qryparam.reqry = FALSE
			   LET g_qryparam.arg1 = '250'
            CALL q_oocq002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa026  #顯示到畫面上

            NEXT FIELD pmaa026                     #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a01產生
         BEFORE FIELD pmaa026
            #add-point:BEFORE FIELD pmaa026
                      {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD pmaa026

            #add-point:AFTER FIELD pmaa026
                      {#ADP版次:1#}
            #END add-point


         #----<<pmaa221>>----
         #Ctrlp:construct.c.pmaa221
         ON ACTION controlp INFIELD pmaa221
            #add-point:ON ACTION controlp INFIELD pmaa221
                        #此段落由子樣板a08產生
            #開窗c段
			   INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			   LET g_qryparam.reqry = FALSE
			   LET g_qryparam.arg1 = '1'
            CALL q_oojd001_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa221  #顯示到畫面上

            NEXT FIELD pmaa221                     #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a01產生
         BEFORE FIELD pmaa221
            #add-point:BEFORE FIELD pmaa221
                      {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD pmaa221

            #add-point:AFTER FIELD pmaa221
                      {#ADP版次:1#}
            #END add-point


         #----<<pmaa232>>----
         #Ctrlp:construct.c.pmaa232
         ON ACTION controlp INFIELD pmaa232
            #add-point:ON ACTION controlp INFIELD pmaa232
                        #此段落由子樣板a08產生
            #開窗c段
			   INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			   LET g_qryparam.reqry = FALSE
			   LET g_qryparam.arg1 = '2072'
            CALL q_oocq002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa232  #顯示到畫面上

            NEXT FIELD pmaa232                     #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a01產生
         BEFORE FIELD pmaa232
            #add-point:BEFORE FIELD pmaa232
                      {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD pmaa232

            #add-point:AFTER FIELD pmaa232
                      {#ADP版次:1#}
            #END add-point


         #----<<pmaa200>>----
         #此段落由子樣板a01產生
         BEFORE FIELD pmaa200
            #add-point:BEFORE FIELD pmaa200
                      {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD pmaa200

            #add-point:AFTER FIELD pmaa200
                      {#ADP版次:1#}
            #END add-point


         #Ctrlp:construct.c.pmaa200
#         ON ACTION controlp INFIELD pmaa200
            #add-point:ON ACTION controlp INFIELD pmaa200
                      {#ADP版次:1#}
            #END add-point

         #----<<pmaa201>>----
         #此段落由子樣板a01產生
         BEFORE FIELD pmaa201
            #add-point:BEFORE FIELD pmaa201
                      {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD pmaa201

            #add-point:AFTER FIELD pmaa201
                      {#ADP版次:1#}
            #END add-point


         #Ctrlp:construct.c.pmaa201
#         ON ACTION controlp INFIELD pmaa201
            #add-point:ON ACTION controlp INFIELD pmaa201
                      {#ADP版次:1#}
            #END add-point

         #----<<pmaa027>>----
         #此段落由子樣板a01產生
         BEFORE FIELD pmaa027
            #add-point:BEFORE FIELD pmaa027
                      {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD pmaa027

            #add-point:AFTER FIELD pmaa027
                      {#ADP版次:1#}
            #END add-point


         #Ctrlp:construct.c.pmaa027
#         ON ACTION controlp INFIELD pmaa027
            #add-point:ON ACTION controlp INFIELD pmaa027
                      {#ADP版次:1#}
            #END add-point

         #----<<pmaa004>>----
         #此段落由子樣板a01產生
         BEFORE FIELD pmaa004
            #add-point:BEFORE FIELD pmaa004
            
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD pmaa004

            #add-point:AFTER FIELD pmaa004
            
            #END add-point


         #Ctrlp:construct.c.pmaa004
#         ON ACTION controlp INFIELD pmaa004
            #add-point:ON ACTION controlp INFIELD pmaa004
            
            #END add-point
            
         #Ctrlp:construct.c.pmaa241
         ON ACTION controlp INFIELD pmaa241
            #add-point:ON ACTION controlp INFIELD pmaa241
                                                                                    #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.arg1 = "1"
            CALL q_dbaa001_1()                     #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa241  #顯示到畫面上
            NEXT FIELD pmaa241                     #返回原欄位
            #END add-point

         #此段落由子樣板a01產生
         BEFORE FIELD pmaa241
            #add-point:BEFORE FIELD pmaa241

            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD pmaa241

            #add-point:AFTER FIELD pmaa241

            #END add-point


         #Ctrlp:construct.c.pmaa242
         ON ACTION controlp INFIELD pmaa242
            #add-point:ON ACTION controlp INFIELD pmaa242
                                                                                    #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.arg1 = "2"
            CALL q_dbaa001_1()                       #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa242  #顯示到畫面上
            NEXT FIELD pmaa242                     #返回原欄位
            #END add-point

         #此段落由子樣板a01產生
         BEFORE FIELD pmaa242
            #add-point:BEFORE FIELD pmaa242

            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD pmaa242

            #add-point:AFTER FIELD pmaa242

            #END add-point


         #Ctrlp:construct.c.pmaa243
         ON ACTION controlp INFIELD pmaa243
            #add-point:ON ACTION controlp INFIELD pmaa243
                                                                                    #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.arg1 = "3"
            CALL q_dbaa001_1()                       #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa243  #顯示到畫面上
            NEXT FIELD pmaa243                     #返回原欄位
            #END add-point

         #此段落由子樣板a01產生
         BEFORE FIELD pmaa243
            #add-point:BEFORE FIELD pmaa243

            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD pmaa243

            #add-point:AFTER FIELD pmaa243

            #END add-point


         #Ctrlp:construct.c.pmaa244
         ON ACTION controlp INFIELD pmaa244
            #add-point:ON ACTION controlp INFIELD pmaa244
                                                                                    #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.arg1 = "4"
            CALL q_dbaa001_1()                       #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa244  #顯示到畫面上
            NEXT FIELD pmaa244                     #返回原欄位
            #END add-point

         #此段落由子樣板a01產生
         BEFORE FIELD pmaa244
            #add-point:BEFORE FIELD pmaa244

            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD pmaa244

            #add-point:AFTER FIELD pmaa244

            #END add-point
            
         #----<<pmaastus>>----
         #此段落由子樣板a01產生
         BEFORE FIELD pmaastus
            #add-point:BEFORE FIELD pmaastus
                      {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD pmaastus

            #add-point:AFTER FIELD pmaastus
                      {#ADP版次:1#}
            #END add-point


         #Ctrlp:construct.c.pmaastus
#         ON ACTION controlp INFIELD pmaastus
            #add-point:ON ACTION controlp INFIELD pmaastus
                      {#ADP版次:1#}
            #END add-point

         #----<<pmaaownid>>----
         #Ctrlp:construct.c.pmaaownid
         ON ACTION controlp INFIELD pmaaownid
            #add-point:ON ACTION controlp INFIELD pmaaownid
                        #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooag001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaaownid  #顯示到畫面上

            NEXT FIELD pmaaownid                     #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a01產生
         BEFORE FIELD pmaaownid
            #add-point:BEFORE FIELD pmaaownid
                      {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD pmaaownid

            #add-point:AFTER FIELD pmaaownid
                      {#ADP版次:1#}
            #END add-point


         #----<<pmaaowndp>>----
         #Ctrlp:construct.c.pmaaowndp
         ON ACTION controlp INFIELD pmaaowndp
            #add-point:ON ACTION controlp INFIELD pmaaowndp
                        #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooea001_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaaowndp  #顯示到畫面上

            NEXT FIELD pmaaowndp                     #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a01產生
         BEFORE FIELD pmaaowndp
            #add-point:BEFORE FIELD pmaaowndp
                      {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD pmaaowndp

            #add-point:AFTER FIELD pmaaowndp
                      {#ADP版次:1#}
            #END add-point


         #----<<pmaacrtid>>----
         #Ctrlp:construct.c.pmaacrtid
         ON ACTION controlp INFIELD pmaacrtid
            #add-point:ON ACTION controlp INFIELD pmaacrtid
                        #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooag001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaacrtid  #顯示到畫面上

            NEXT FIELD pmaacrtid                     #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a01產生
         BEFORE FIELD pmaacrtid
            #add-point:BEFORE FIELD pmaacrtid
                      {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD pmaacrtid

            #add-point:AFTER FIELD pmaacrtid
                      {#ADP版次:1#}
            #END add-point


         #----<<pmaacrtdp>>----
         #Ctrlp:construct.c.pmaacrtdp
         ON ACTION controlp INFIELD pmaacrtdp
            #add-point:ON ACTION controlp INFIELD pmaacrtdp
                        #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooea001_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaacrtdp  #顯示到畫面上

            NEXT FIELD pmaacrtdp                     #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a01產生
         BEFORE FIELD pmaacrtdp
            #add-point:BEFORE FIELD pmaacrtdp
                      {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD pmaacrtdp

            #add-point:AFTER FIELD pmaacrtdp
                      {#ADP版次:1#}
            #END add-point


         #----<<pmaacrtdt>>----
         #此段落由子樣板a01產生
         BEFORE FIELD pmaacrtdt
            #add-point:BEFORE FIELD pmaacrtdt
                      {#ADP版次:1#}
            #END add-point

         #----<<pmaamodid>>----
         #Ctrlp:construct.c.pmaamodid
         ON ACTION controlp INFIELD pmaamodid
            #add-point:ON ACTION controlp INFIELD pmaamodid
                        #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooag001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaamodid  #顯示到畫面上

            NEXT FIELD pmaamodid                     #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a01產生
         BEFORE FIELD pmaamodid
            #add-point:BEFORE FIELD pmaamodid
                      {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD pmaamodid

            #add-point:AFTER FIELD pmaamodid
                      {#ADP版次:1#}
            #END add-point


         #----<<pmaamoddt>>----
         #此段落由子樣板a01產生
         BEFORE FIELD pmaamoddt
            #add-point:BEFORE FIELD pmaamoddt
                      {#ADP版次:1#}
            #END add-point

         #----<<pmaacnfid>>----
         #Ctrlp:construct.c.pmaacnfid
         ON ACTION controlp INFIELD pmaacnfid
            #add-point:ON ACTION controlp INFIELD pmaacnfid
                        #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooag001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaacnfid  #顯示到畫面上

            NEXT FIELD pmaacnfid                     #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a01產生
         BEFORE FIELD pmaacnfid
            #add-point:BEFORE FIELD pmaacnfid
                      {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD pmaacnfid

            #add-point:AFTER FIELD pmaacnfid
                      {#ADP版次:1#}
            #END add-point


         #----<<pmaacnfdt>>----
         #此段落由子樣板a01產生
         BEFORE FIELD pmaacnfdt
            #add-point:BEFORE FIELD pmaacnfdt
                      {#ADP版次:1#}
            #END add-point

         #----<<pmaa017>>----
         #此段落由子樣板a01產生
         BEFORE FIELD pmaa017
            #add-point:BEFORE FIELD pmaa017
                      {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD pmaa017

            #add-point:AFTER FIELD pmaa017
                      {#ADP版次:1#}
            #END add-point


         #Ctrlp:construct.c.pmaa017
#         ON ACTION controlp INFIELD pmaa017
            #add-point:ON ACTION controlp INFIELD pmaa017
                      {#ADP版次:1#}
            #END add-point

         #----<<pmaa016>>----
         #此段落由子樣板a01產生
         BEFORE FIELD pmaa016
            #add-point:BEFORE FIELD pmaa016
                      {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD pmaa016

            #add-point:AFTER FIELD pmaa016
                      {#ADP版次:1#}
            #END add-point


         #Ctrlp:construct.c.pmaa016
#         ON ACTION controlp INFIELD pmaa016
            #add-point:ON ACTION controlp INFIELD pmaa016
                      {#ADP版次:1#}
            #END add-point

         #----<<pmaa018>>----
         #此段落由子樣板a01產生
         BEFORE FIELD pmaa018
            #add-point:BEFORE FIELD pmaa018
                      {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD pmaa018

            #add-point:AFTER FIELD pmaa018
                      {#ADP版次:1#}
            #END add-point


         #Ctrlp:construct.c.pmaa018
#         ON ACTION controlp INFIELD pmaa018
            #add-point:ON ACTION controlp INFIELD pmaa018
                      {#ADP版次:1#}
            #END add-point

         #----<<pmaa019>>----
         #Ctrlp:construct.c.pmaa019
         ON ACTION controlp INFIELD pmaa019
            #add-point:ON ACTION controlp INFIELD pmaa019
                        #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooaj002_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa019  #顯示到畫面上

            NEXT FIELD pmaa019                     #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a01產生
         BEFORE FIELD pmaa019
            #add-point:BEFORE FIELD pmaa019
                      {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD pmaa019

            #add-point:AFTER FIELD pmaa019
                      {#ADP版次:1#}
            #END add-point


         #----<<pmaa021>>----
         #此段落由子樣板a01產生
         BEFORE FIELD pmaa021
            #add-point:BEFORE FIELD pmaa021
                      {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD pmaa021

            #add-point:AFTER FIELD pmaa021
                      {#ADP版次:1#}
            #END add-point


         #Ctrlp:construct.c.pmaa021
#         ON ACTION controlp INFIELD pmaa021
            #add-point:ON ACTION controlp INFIELD pmaa021
                      {#ADP版次:1#}
            #END add-point

         #----<<pmaa022>>----
         #Ctrlp:construct.c.pmaa022
         ON ACTION controlp INFIELD pmaa022
            #add-point:ON ACTION controlp INFIELD pmaa022
                        #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooai001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa022  #顯示到畫面上

            NEXT FIELD pmaa022                     #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a01產生
         BEFORE FIELD pmaa022
            #add-point:BEFORE FIELD pmaa022
                      {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD pmaa022

            #add-point:AFTER FIELD pmaa022
                      {#ADP版次:1#}
            #END add-point


         #----<<pmaa020>>----
         #此段落由子樣板a01產生
         BEFORE FIELD pmaa020
            #add-point:BEFORE FIELD pmaa020
                      {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD pmaa020

            #add-point:AFTER FIELD pmaa020
                      {#ADP版次:1#}
            #END add-point


         #Ctrlp:construct.c.pmaa020
#         ON ACTION controlp INFIELD pmaa020
            #add-point:ON ACTION controlp INFIELD pmaa020
                      {#ADP版次:1#}
            #END add-point

         #----<<ooff013>>----
         #此段落由子樣板a01產生
         BEFORE FIELD ooff013
            #add-point:BEFORE FIELD ooff013
                      {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD ooff013

            #add-point:AFTER FIELD ooff013
                      {#ADP版次:1#}
            #END add-point


         #Ctrlp:construct.c.ooff013
#         ON ACTION controlp INFIELD ooff013
            #add-point:ON ACTION controlp INFIELD ooff013
                      {#ADP版次:1#}
            #END add-point

         #----<<pmaa291>>----
         #Ctrlp:construct.c.pmaa291
         ON ACTION controlp INFIELD pmaa291
            #add-point:ON ACTION controlp INFIELD pmaa291
                        #此段落由子樣板a08產生
            #開窗c段
			   INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			   LET g_qryparam.reqry = FALSE
			   LET g_qryparam.arg1 = '2061'
            CALL q_oocq002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa291  #顯示到畫面上

            NEXT FIELD pmaa291                     #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a01產生
         BEFORE FIELD pmaa291
            #add-point:BEFORE FIELD pmaa291
                      {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD pmaa291

            #add-point:AFTER FIELD pmaa291
                      {#ADP版次:1#}
            #END add-point


         #----<<pmaa292>>----
         #Ctrlp:construct.c.pmaa292
         ON ACTION controlp INFIELD pmaa292
            #add-point:ON ACTION controlp INFIELD pmaa292
                        #此段落由子樣板a08產生
            #開窗c段
			   INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			   LET g_qryparam.reqry = FALSE
			   LET g_qryparam.arg1 = '2062'
            CALL q_oocq002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa292  #顯示到畫面上

            NEXT FIELD pmaa292                     #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a01產生
         BEFORE FIELD pmaa292
            #add-point:BEFORE FIELD pmaa292
                      {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD pmaa292

            #add-point:AFTER FIELD pmaa292
                      {#ADP版次:1#}
            #END add-point


         #----<<pmaa293>>----
         #Ctrlp:construct.c.pmaa293
         ON ACTION controlp INFIELD pmaa293
            #add-point:ON ACTION controlp INFIELD pmaa293
                        #此段落由子樣板a08產生
            #開窗c段
			   INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			   LET g_qryparam.reqry = FALSE
			   LET g_qryparam.arg1 = '2063'
            CALL q_oocq002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa293  #顯示到畫面上

            NEXT FIELD pmaa293                     #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a01產生
         BEFORE FIELD pmaa293
            #add-point:BEFORE FIELD pmaa293
                      {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD pmaa293

            #add-point:AFTER FIELD pmaa293
                      {#ADP版次:1#}
            #END add-point


         #----<<pmaa294>>----
         #Ctrlp:construct.c.pmaa294
         ON ACTION controlp INFIELD pmaa294
            #add-point:ON ACTION controlp INFIELD pmaa294
                        #此段落由子樣板a08產生
            #開窗c段
			   INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			   LET g_qryparam.reqry = FALSE
			   LET g_qryparam.arg1 = '2064'
            CALL q_oocq002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa294  #顯示到畫面上

            NEXT FIELD pmaa294                     #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a01產生
         BEFORE FIELD pmaa294
            #add-point:BEFORE FIELD pmaa294
                      {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD pmaa294

            #add-point:AFTER FIELD pmaa294
                      {#ADP版次:1#}
            #END add-point


         #----<<pmaa295>>----
         #Ctrlp:construct.c.pmaa295
         ON ACTION controlp INFIELD pmaa295
            #add-point:ON ACTION controlp INFIELD pmaa295
                        #此段落由子樣板a08產生
            #開窗c段
			   INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			   LET g_qryparam.reqry = FALSE
			   LET g_qryparam.arg1 = '2065'
            CALL q_oocq002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa295  #顯示到畫面上

            NEXT FIELD pmaa295                     #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a01產生
         BEFORE FIELD pmaa295
            #add-point:BEFORE FIELD pmaa295
                      {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD pmaa295

            #add-point:AFTER FIELD pmaa295
                      {#ADP版次:1#}
            #END add-point


         #----<<pmaa296>>----
         #Ctrlp:construct.c.pmaa296
         ON ACTION controlp INFIELD pmaa296
            #add-point:ON ACTION controlp INFIELD pmaa296
                        #此段落由子樣板a08產生
            #開窗c段
			   INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			   LET g_qryparam.reqry = FALSE
			   LET g_qryparam.arg1 = '2066'
            CALL q_oocq002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa296  #顯示到畫面上

            NEXT FIELD pmaa296                     #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a01產生
         BEFORE FIELD pmaa296
            #add-point:BEFORE FIELD pmaa296
                      {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD pmaa296

            #add-point:AFTER FIELD pmaa296
                      {#ADP版次:1#}
            #END add-point


         #----<<pmaa297>>----
         #Ctrlp:construct.c.pmaa297
         ON ACTION controlp INFIELD pmaa297
            #add-point:ON ACTION controlp INFIELD pmaa297
                        #此段落由子樣板a08產生
            #開窗c段
			   INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			   LET g_qryparam.reqry = FALSE
			   LET g_qryparam.arg1 = '2067'
            CALL q_oocq002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa297  #顯示到畫面上

            NEXT FIELD pmaa297                     #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a01產生
         BEFORE FIELD pmaa297
            #add-point:BEFORE FIELD pmaa297
                      {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD pmaa297

            #add-point:AFTER FIELD pmaa297
                      {#ADP版次:1#}
            #END add-point


         #----<<pmaa298>>----
         #Ctrlp:construct.c.pmaa298
         ON ACTION controlp INFIELD pmaa298
            #add-point:ON ACTION controlp INFIELD pmaa298
                        #此段落由子樣板a08產生
            #開窗c段
			   INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			   LET g_qryparam.reqry = FALSE
			   LET g_qryparam.arg1 = '2068'
            CALL q_oocq002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa298  #顯示到畫面上

            NEXT FIELD pmaa298                     #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a01產生
         BEFORE FIELD pmaa298
            #add-point:BEFORE FIELD pmaa298
                      {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD pmaa298

            #add-point:AFTER FIELD pmaa298
                      {#ADP版次:1#}
            #END add-point


         #----<<pmaa299>>----
         #Ctrlp:construct.c.pmaa299
         ON ACTION controlp INFIELD pmaa299
            #add-point:ON ACTION controlp INFIELD pmaa299
                        #此段落由子樣板a08產生
            #開窗c段
			   INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			   LET g_qryparam.reqry = FALSE
			   LET g_qryparam.arg1 = '2069'
            CALL q_oocq002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa299  #顯示到畫面上

            NEXT FIELD pmaa299                     #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a01產生
         BEFORE FIELD pmaa299
            #add-point:BEFORE FIELD pmaa299
                      {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD pmaa299

            #add-point:AFTER FIELD pmaa299
                      {#ADP版次:1#}
            #END add-point


         #----<<pmaa300>>----
         #Ctrlp:construct.c.pmaa300
         ON ACTION controlp INFIELD pmaa300
            #add-point:ON ACTION controlp INFIELD pmaa300
                        #此段落由子樣板a08產生
            #開窗c段
			   INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			   LET g_qryparam.reqry = FALSE
			   LET g_qryparam.arg1 = '2070'
            CALL q_oocq002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa300  #顯示到畫面上

            NEXT FIELD pmaa300                     #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a01產生
         BEFORE FIELD pmaa300
            #add-point:BEFORE FIELD pmaa300
                      {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD pmaa300

            #add-point:AFTER FIELD pmaa300
                      {#ADP版次:1#}
            #END add-point




      END CONSTRUCT

      #add-point:cs段more_construct
      SUBDIALOG aoo_aooi350_01.aooi350_01_construct
      SUBDIALOG aoo_aooi350_02.aooi350_02_construct 
      {#ADP版次:1#}
      #end add-point

      ON ACTION accept
         ACCEPT DIALOG

      ON ACTION cancel
         LET INT_FLAG = 1
         EXIT DIALOG

      #查詢CONSTRUCT共用ACTION
      &include "construct_action.4gl"

      #交談指令共用ACTION
      &include "common_action.4gl"
         CONTINUE DIALOG
   END DIALOG

   #add-point:cs段after_construct
   LET g_wc = g_wc CLIPPED , " AND ",g_wc2_i35001 ," AND ",g_wc2_i35002
   {#ADP版次:1#}
   #end add-point

   #LET g_wc = g_wc CLIPPED,cl_get_extra_cond("", "")

END FUNCTION]]>
  </point>
  <point name="function.adbm201_filter" order="5" ver="1" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adbm201_filter()
   {<Local define>}
   {</Local define>}
   #add-point:filter段define
             {#ADP版次:1#}
   #end add-point

   LET INT_FLAG = 0

   LET g_qryparam.state = 'c'

   LET g_wc_filter_t = g_wc_filter
   LET g_wc_t = g_wc

   LET g_wc = cl_replace_str(g_wc, g_wc_filter, '')

   #使用DIALOG包住 單頭CONSTRUCT及單身CONSTRUCT
   DIALOG ATTRIBUTES(UNBUFFERED,FIELD ORDER FORM)

      #單頭
      CONSTRUCT g_wc_filter ON pmaa095,pmaa001,pmaa005,pmaa006,pmaa090,pmaa026
                          FROM s_browse[1].b_pmaa095,s_browse[1].b_pmaa001,s_browse[1].b_pmaa005,s_browse[1].b_pmaa006,
                              s_browse[1].b_pmaa090,s_browse[1].b_pmaa026

         BEFORE CONSTRUCT
#saki             CALL cl_qbe_init()
               DISPLAY adbm201_filter_parser('pmaa095') TO s_browse[1].b_pmaa095
            DISPLAY adbm201_filter_parser('pmaa001') TO s_browse[1].b_pmaa001
            DISPLAY adbm201_filter_parser('pmaa005') TO s_browse[1].b_pmaa005
            DISPLAY adbm201_filter_parser('pmaa006') TO s_browse[1].b_pmaa006
            DISPLAY adbm201_filter_parser('pmaa090') TO s_browse[1].b_pmaa090
            DISPLAY adbm201_filter_parser('pmaa026') TO s_browse[1].b_pmaa026

      END CONSTRUCT

      #add-point:filter段add_cs
                {#ADP版次:1#}
      #end add-point

      BEFORE DIALOG
         #add-point:filter段b_dialog
                   {#ADP版次:1#}
         #end add-point

      ON ACTION accept
         ACCEPT DIALOG

      ON ACTION cancel
         LET INT_FLAG = 1
         EXIT DIALOG

      #交談指令共用ACTION
      &include "common_action.4gl"
         CONTINUE DIALOG

   END DIALOG

   IF NOT INT_FLAG THEN
      LET g_wc_filter = "   AND   ", g_wc_filter, "   "
      LET g_wc = g_wc , g_wc_filter
   ELSE
      LET g_wc_filter = g_wc_filter_t
      LET g_wc = g_wc_t
   END IF

END FUNCTION]]>
  </point>
  <point name="function.adbm201_filter_parser" order="6" ver="1" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adbm201_filter_parser(ps_field)
   {<Local define>}
   DEFINE ps_field   STRING
   DEFINE ls_tmp     STRING
   DEFINE li_tmp     LIKE type_t.num5
   DEFINE li_tmp2    LIKE type_t.num5
   DEFINE ls_var     STRING
   {</Local define>}
   #add-point:filter段define
             {#ADP版次:1#}
   #end add-point

   #一般條件解析
   LET ls_tmp = ps_field, "='"
   LET li_tmp = g_wc_filter.getIndexOf(ls_tmp,1)
   IF li_tmp > 0 THEN
      LET li_tmp = ls_tmp.getLength() + li_tmp
      LET li_tmp2 = g_wc_filter.getIndexOf("'",li_tmp + 1) - 1
      LET ls_var = g_wc_filter.subString(li_tmp,li_tmp2)
   END IF

   #模糊條件解析
   LET ls_tmp = ps_field, " like '"
   LET li_tmp = g_wc_filter.getIndexOf(ls_tmp,1)
   IF li_tmp > 0 THEN
      LET li_tmp = ls_tmp.getLength() + li_tmp
      LET li_tmp2 = g_wc_filter.getIndexOf("'",li_tmp + 1) - 1
      LET ls_var = g_wc_filter.subString(li_tmp,li_tmp2)
      LET ls_var = cl_replace_str(ls_var,'%','*')
   END IF

   RETURN ls_var

END FUNCTION]]>
  </point>
  <point name="function.adbm201_query" order="7" ver="3" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adbm201_query()
   {<Local define>}
   DEFINE ls_wc STRING
   {</Local define>}
   #add-point:query段define
   {#ADP版次:1#}
   #end add-point

   LET INT_FLAG = 0
   LET ls_wc = g_wc

   #切換畫面
   IF g_main_hidden THEN
      CALL gfrm_curr.setElementHidden("mainlayout",0)
      CALL gfrm_curr.setElementHidden("worksheet",1)
      LET g_main_hidden = 0
   END IF

   CALL g_browser.clear()

   IF g_worksheet_hidden THEN  #browser panel 單身折疊
      CALL gfrm_curr.setElementHidden("worksheet_vbox",0)
      CALL gfrm_curr.setElementImage("worksheethidden","worksheethidden-24.png")
      LET g_worksheet_hidden = 0
   END IF
   IF g_header_hidden THEN    #單頭折疊
      CALL gfrm_curr.setElementHidden("worksheet_detail",0)
      CALL gfrm_curr.setElementImage("controls","headerhidden-24")
      LET g_header_hidden = 0
   END IF

   INITIALIZE g_pmaa_m.* TO NULL
   ERROR ""

   DISPLAY " " TO FORMONLY.b_count
   DISPLAY " " TO FORMONLY.h_count
   CALL adbm201_construct()

   IF INT_FLAG THEN
      #取消查詢
      LET INT_FLAG = 0
      LET g_wc = ls_wc
      CALL adbm201_browser_fill(g_wc,"F")
      CALL adbm201_fetch("")
      RETURN
   ELSE
      LET g_current_row = 1
      LET g_current_cnt = 0
   END IF

   LET g_error_show = 1
   CALL adbm201_browser_fill(g_wc,"F")   # 移到第一頁

   #備份搜尋條件
   LET ls_wc = g_wc

   #第一層模糊搜尋
   IF g_browser.getLength() = 0 THEN
      LET g_wc = cl_wc_parser(ls_wc)
      LET g_error_show = 1
      CALL adbm201_browser_fill(g_wc,"F")
   END IF

   #第二層助記碼搜尋
   IF g_browser.getLength() = 0 THEN

      LET g_wc = cl_mcode_parser(ls_wc,'pmaal_t','pmaal004','pmaa_t','pmaa001','1','')

      IF NOT cl_null(g_wc) THEN
         LET g_error_show = 1
         CALL adbm201_browser_fill(g_wc,"F")
      END IF

   END IF

   IF g_browser.getLength() = 0 THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = "-100"
      LET g_errparam.extend = ""
      LET g_errparam.popup = TRUE
      CALL cl_err()

   ELSE
      CALL adbm201_fetch("F")
   END IF

   LET g_wc_filter = ""

END FUNCTION]]>
  </point>
  <point name="function.adbm201_fetch" order="8" ver="9" cite_std="N" new="Y" status="u" src="s" readonly="" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adbm201_fetch(p_fl)
   {<Local define>}
   DEFINE p_fl       LIKE type_t.chr1
   DEFINE ls_msg     STRING
   {</Local define>}

   #add-point:fetch段define
   {#ADP版次:1#}
   #end add-point

   CASE p_fl
      WHEN "F" LET g_current_idx = 1
      WHEN "P"
         IF g_current_idx > 1 THEN
            LET g_current_idx = g_current_idx - 1
         END IF
      WHEN "N"
         IF g_current_idx < g_header_cnt THEN
            LET g_current_idx =  g_current_idx + 1
         END IF
      WHEN "L"
         LET g_current_idx = g_header_cnt
      WHEN "/"
         IF (NOT g_no_ask) THEN
            CALL cl_getmsg("fetch", g_lang) RETURNING ls_msg
            LET INT_FLAG = 0

            PROMPT ls_msg CLIPPED,": " FOR g_jump
               #交談指令共用ACTION
               &include "common_action.4gl"
            END PROMPT

            IF INT_FLAG THEN
               LET INT_FLAG = 0
               EXIT CASE
            END IF
         END IF
         IF g_jump > 0 THEN
            LET g_current_idx = g_jump
         END IF
         LET g_no_ask = FALSE
   END CASE

   LET g_browser_cnt = g_browser.getLength()

   #瀏覽頁筆數顯示
   LET g_browser_idx = g_pagestart+g_current_idx-1
   DISPLAY g_browser_idx TO FORMONLY.b_index        #當下筆數
   DISPLAY g_browser_cnt TO FORMONLY.b_count        #總筆數
   DISPLAY g_browser_idx TO FORMONLY.h_index        #當下筆數
   DISPLAY g_browser_cnt TO FORMONLY.h_count        #總筆數
   CALL ui.Interface.refresh()

   #單頭筆數顯示
   #DISPLAY g_browser_idx TO FORMONLY.idx            #當下筆數
   #DISPLAY g_browser_cnt TO FORMONLY.cnt            #總筆數



   IF g_current_idx > g_browser.getLength() THEN
      LET g_current_idx = g_browser.getLength()
   END IF

   # 設定browse索引
   CALL g_curr_diag.setCurrentRow("s_browse", g_current_idx)

   CALL cl_navigator_setting(g_browser_idx, g_current_cnt)

   #代表沒有資料, 無需做後續資料撈取之動作
   IF g_current_idx = 0 THEN
      RETURN
   END IF

   LET g_pmaa_m.pmaa001 = g_browser[g_current_idx].b_pmaa001


   #重讀DB,因TEMP有不被更新特性
    SELECT UNIQUE pmaa095,pmaa001,pmaa005,pmaa006,pmaa090,pmaa026,pmaa221,pmaa232,pmaa200,pmaa201,pmaa027,
        pmaa004,pmaa241,pmaa242,pmaa243,pmaa244,pmaastus,pmaaownid,pmaaowndp,pmaacrtid,pmaacrtdp,pmaacrtdt,pmaamodid,pmaamoddt,pmaacnfid,
        pmaacnfdt,pmaa017,pmaa016,pmaa018,pmaa019,pmaa021,pmaa022,pmaa020,pmaa291,pmaa292,pmaa293,pmaa294,
        pmaa295,pmaa296,pmaa297,pmaa298,pmaa299,pmaa300
 INTO g_pmaa_m.pmaa095,g_pmaa_m.pmaa001,g_pmaa_m.pmaa005,g_pmaa_m.pmaa006,g_pmaa_m.pmaa090,g_pmaa_m.pmaa026,
     g_pmaa_m.pmaa221,g_pmaa_m.pmaa232,g_pmaa_m.pmaa200,g_pmaa_m.pmaa201,g_pmaa_m.pmaa027,g_pmaa_m.pmaa004,
     g_pmaa_m.pmaa241,g_pmaa_m.pmaa242,g_pmaa_m.pmaa243,g_pmaa_m.pmaa244,
     g_pmaa_m.pmaastus,g_pmaa_m.pmaaownid,g_pmaa_m.pmaaowndp,g_pmaa_m.pmaacrtid,g_pmaa_m.pmaacrtdp,g_pmaa_m.pmaacrtdt,
     g_pmaa_m.pmaamodid,g_pmaa_m.pmaamoddt,g_pmaa_m.pmaacnfid,g_pmaa_m.pmaacnfdt,g_pmaa_m.pmaa017,g_pmaa_m.pmaa016,
     g_pmaa_m.pmaa018,g_pmaa_m.pmaa019,g_pmaa_m.pmaa021,g_pmaa_m.pmaa022,g_pmaa_m.pmaa020,g_pmaa_m.pmaa291,
     g_pmaa_m.pmaa292,g_pmaa_m.pmaa293,g_pmaa_m.pmaa294,g_pmaa_m.pmaa295,g_pmaa_m.pmaa296,g_pmaa_m.pmaa297,
     g_pmaa_m.pmaa298,g_pmaa_m.pmaa299,g_pmaa_m.pmaa300
 FROM pmaa_t
 WHERE pmaaent = g_enterprise AND pmaa001 = g_pmaa_m.pmaa001 AND pmaa002 = '2' AND pmaa230 = '2'
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "pmaa_t"
      LET g_errparam.popup = FALSE
      CALL cl_err()

      INITIALIZE g_pmaa_m.* TO NULL
      RETURN
   END IF

   #add-point:fetch段action控制
      IF g_pmaa_m.pmaastus = 'N' THEN
      CALL cl_set_act_visible("modify,delete,modify_detail",TRUE)
   ELSE
      CALL cl_set_act_visible("modify,delete,modify_detail",FALSE)
   END IF
   CALL adbm201_set_act_visible()      #150424-00018#1 150529 add by beckxie
   CALL adbm201_set_act_no_visible()   #150424-00018#1 150529 add by beckxie

   {#ADP版次:1#}
   #end add-point



   #重新顯示
   CALL adbm201_show()

END FUNCTION]]>
  </point>
  <point name="function.adbm201_insert" order="9" ver="6" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adbm201_insert()
   #add-point:insert段define
   DEFINE l_insert     LIKE type_t.num5        {#ADP版次:1#}
   #end add-point

   CLEAR FORM                    #清畫面欄位內容

   INITIALIZE g_pmaa_m.* LIKE pmaa_t.*             #DEFAULT 設定
   LET g_pmaa001_t = NULL


   CALL s_transaction_begin()

   WHILE TRUE
      #六階樹狀給值


      #公用欄位給值
      #此段落由子樣板a14產生
      LET g_pmaa_m.pmaaownid = g_user
      LET g_pmaa_m.pmaaowndp = g_dept
      LET g_pmaa_m.pmaacrtid = g_user
      LET g_pmaa_m.pmaacrtdp = g_dept
      LET g_pmaa_m.pmaacrtdt = cl_get_current()
      LET g_pmaa_m.pmaamodid = ""
      LET g_pmaa_m.pmaamoddt = ""
      #LET g_pmaa_m.pmaastus = ""



      #append欄位給值


      #一般欄位給值
      LET g_pmaa_m.pmaa004 = "3"
      LET g_pmaa_m.pmaastus = "N"


      #add-point:單頭預設值
      LET g_pmaa_m.pmaa027 = ''
      LET g_pmaa027_d = ''
      CALL aooi350_01_clear_detail()
      CALL aooi350_02_clear_detail()
      CALL s_aooi500_default(g_prog,'pmaaunit',g_site)
         RETURNING l_insert,g_pmaa_m.pmaa095
      IF NOT l_insert THEN
        RETURN
      END IF
      CALL s_desc_get_department_desc(g_pmaa_m.pmaa095)
         RETURNING g_pmaa_m.pmaa095_desc
      DISPLAY BY NAME g_pmaa_m.pmaa095_desc
      #交易對象類型pmaa002 = '2.供應商' 且 客戶性質pmaa230 = '2.間接客戶'
      LET g_pmaa_m.pmaa002 = '2'
      LET g_pmaa_m.pmaa230 = '2'
      
      LET g_pmaa_m_t.* = g_pmaa_m.*
      LET g_pmaa_m_o.* = g_pmaa_m.*      {#ADP版次:1#}
      #end add-point

      CALL adbm201_input("a")

      #add-point:單頭輸入後
                {#ADP版次:1#}
      #end add-point

      IF INT_FLAG THEN
         LET INT_FLAG = 0
         LET g_pmaa_m.* = g_pmaa_m_t.*
         CALL adbm201_show()
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = 9001
         LET g_errparam.extend = ""
         LET g_errparam.popup = FALSE
         CALL cl_err()

         EXIT WHILE
      END IF

      LET g_rec_b = 0
      EXIT WHILE
   END WHILE

   LET g_pmaa001_t = g_pmaa_m.pmaa001


   LET g_state = "Y"

   LET g_wc = g_wc,
              " OR ( pmaaent = '" ||g_enterprise|| "' AND",
              " pmaa001 = '", g_pmaa_m.pmaa001 CLIPPED, "' "

              , ") "

END FUNCTION]]>
  </point>
  <point name="function.adbm201_modify" order="10" ver="6" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adbm201_modify()
   #add-point:modify段define
             {#ADP版次:1#}
   #end add-point

   IF g_pmaa_m.pmaa001 IS NULL

   THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = "std-00003"
      LET g_errparam.extend = ""
      LET g_errparam.popup = FALSE
      CALL cl_err()

      RETURN
   END IF

    SELECT UNIQUE pmaa095,pmaa001,pmaa005,pmaa006,pmaa090,pmaa026,pmaa221,pmaa232,pmaa200,pmaa201,pmaa027,
        pmaa004,pmaa241,pmaa242,pmaa243,pmaa244,pmaastus,pmaaownid,pmaaowndp,pmaacrtid,pmaacrtdp,pmaacrtdt,pmaamodid,pmaamoddt,pmaacnfid,
        pmaacnfdt,pmaa017,pmaa016,pmaa018,pmaa019,pmaa021,pmaa022,pmaa020,pmaa291,pmaa292,pmaa293,pmaa294,
        pmaa295,pmaa296,pmaa297,pmaa298,pmaa299,pmaa300
 INTO g_pmaa_m.pmaa095,g_pmaa_m.pmaa001,g_pmaa_m.pmaa005,g_pmaa_m.pmaa006,g_pmaa_m.pmaa090,g_pmaa_m.pmaa026,
     g_pmaa_m.pmaa221,g_pmaa_m.pmaa232,g_pmaa_m.pmaa200,g_pmaa_m.pmaa201,g_pmaa_m.pmaa027,g_pmaa_m.pmaa004,
     g_pmaa_m.pmaa241,g_pmaa_m.pmaa242,g_pmaa_m.pmaa243,g_pmaa_m.pmaa244,
     g_pmaa_m.pmaastus,g_pmaa_m.pmaaownid,g_pmaa_m.pmaaowndp,g_pmaa_m.pmaacrtid,g_pmaa_m.pmaacrtdp,g_pmaa_m.pmaacrtdt,
     g_pmaa_m.pmaamodid,g_pmaa_m.pmaamoddt,g_pmaa_m.pmaacnfid,g_pmaa_m.pmaacnfdt,g_pmaa_m.pmaa017,g_pmaa_m.pmaa016,
     g_pmaa_m.pmaa018,g_pmaa_m.pmaa019,g_pmaa_m.pmaa021,g_pmaa_m.pmaa022,g_pmaa_m.pmaa020,g_pmaa_m.pmaa291,
     g_pmaa_m.pmaa292,g_pmaa_m.pmaa293,g_pmaa_m.pmaa294,g_pmaa_m.pmaa295,g_pmaa_m.pmaa296,g_pmaa_m.pmaa297,
     g_pmaa_m.pmaa298,g_pmaa_m.pmaa299,g_pmaa_m.pmaa300
 FROM pmaa_t
 WHERE pmaaent = g_enterprise AND pmaa001 = g_pmaa_m.pmaa001 AND pmaa002 = '2' AND pmaa230 = '2'

   ERROR ""

   LET g_pmaa001_t = g_pmaa_m.pmaa001


   CALL s_transaction_begin()

   OPEN adbm201_cl USING g_enterprise,g_pmaa_m.pmaa001
   IF STATUS THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code =  STATUS
      LET g_errparam.extend = "OPEN adbm201_cl:"
      LET g_errparam.popup = TRUE
      CALL cl_err()

      CLOSE adbm201_cl
      CALL s_transaction_end('N','0')
      RETURN
   END IF

   #鎖住將被更改或取消的資料
   FETCH adbm201_cl INTO g_pmaa_m.pmaa095,g_pmaa_m.pmaa095_desc,g_pmaa_m.pmaa001,g_pmaa_m.pmaal004,g_pmaa_m.pmaal003,
       g_pmaa_m.pmaal005,g_pmaa_m.pmaa005,g_pmaa_m.pmaa005_desc,g_pmaa_m.pmaa006,g_pmaa_m.pmaa006_desc,
       g_pmaa_m.pmaa090,g_pmaa_m.pmaa090_desc,g_pmaa_m.pmaa026,g_pmaa_m.pmaa026_desc,g_pmaa_m.pmaa221,
       g_pmaa_m.pmaa221_desc,g_pmaa_m.pmaa232,g_pmaa_m.pmaa232_desc,g_pmaa_m.pmaa200,g_pmaa_m.pmaa201,
       g_pmaa_m.pmaa027,g_pmaa_m.pmaa004,g_pmaa_m.pmaa241,g_pmaa_m.pmaa241_desc,g_pmaa_m.pmaa242,g_pmaa_m.pmaa242_desc,
       g_pmaa_m.pmaa243,g_pmaa_m.pmaa243_desc,g_pmaa_m.pmaa244,g_pmaa_m.pmaa244_desc,g_pmaa_m.pmaastus,g_pmaa_m.pmaaownid,g_pmaa_m.pmaaownid_desc,
       g_pmaa_m.pmaaowndp,g_pmaa_m.pmaaowndp_desc,g_pmaa_m.pmaacrtid,g_pmaa_m.pmaacrtid_desc,g_pmaa_m.pmaacrtdp,
       g_pmaa_m.pmaacrtdp_desc,g_pmaa_m.pmaacrtdt,g_pmaa_m.pmaamodid,g_pmaa_m.pmaamodid_desc,g_pmaa_m.pmaamoddt,
       g_pmaa_m.pmaacnfid,g_pmaa_m.pmaacnfid_desc,g_pmaa_m.pmaacnfdt,g_pmaa_m.pmaa017,g_pmaa_m.pmaa016,
       g_pmaa_m.pmaa018,g_pmaa_m.pmaa019,g_pmaa_m.pmaa019_desc,g_pmaa_m.pmaa021,g_pmaa_m.pmaa022,g_pmaa_m.pmaa022_desc,
       g_pmaa_m.pmaa020,g_pmaa_m.ooff013,g_pmaa_m.pmaa291,g_pmaa_m.pmaa291_desc,g_pmaa_m.pmaa292,g_pmaa_m.pmaa292_desc,
       g_pmaa_m.pmaa293,g_pmaa_m.pmaa293_desc,g_pmaa_m.pmaa294,g_pmaa_m.pmaa294_desc,g_pmaa_m.pmaa295,
       g_pmaa_m.pmaa295_desc,g_pmaa_m.pmaa296,g_pmaa_m.pmaa296_desc,g_pmaa_m.pmaa297,g_pmaa_m.pmaa297_desc,
       g_pmaa_m.pmaa298,g_pmaa_m.pmaa298_desc,g_pmaa_m.pmaa299,g_pmaa_m.pmaa299_desc,g_pmaa_m.pmaa300,
       g_pmaa_m.pmaa300_desc

   #資料被他人LOCK, 或是sql執行時出現錯誤
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "pmaa_t"
      LET g_errparam.popup = FALSE
      CALL cl_err()

      CLOSE adbm201_cl
      CALL s_transaction_end('N','0')
      RETURN
   END IF



   CALL adbm201_show()

   WHILE TRUE
      LET g_pmaa_m.pmaa001 = g_pmaa001_t


      #寫入修改者/修改日期資訊
      LET g_pmaa_m.pmaamodid = g_user
LET g_pmaa_m.pmaamoddt = cl_get_current()


      #add-point:modify段修改前
            LET g_pmaa_m_o.* = g_pmaa_m.*          {#ADP版次:1#}
      #end add-point

      CALL adbm201_input("u")     #欄位更改

      #add-point:modify段修改後
                {#ADP版次:1#}
      #end add-point

      IF INT_FLAG THEN
         LET INT_FLAG = 0
         LET g_pmaa_m.* = g_pmaa_m_t.*
         CALL adbm201_show()
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = 9001
         LET g_errparam.extend = ""
         LET g_errparam.popup = FALSE
         CALL cl_err()

         EXIT WHILE
      END IF

      EXIT WHILE

   END WHILE

   #修改歷程記錄
   IF NOT cl_log_modified_record(g_pmaa_m.pmaa001,g_site) THEN
      CALL s_transaction_end('N','0')
   END IF

   CLOSE adbm201_cl
   CALL s_transaction_end('Y','0')

   #流程通知預埋點-U
   CALL cl_flow_notify(g_pmaa_m.pmaa001,"U")

   LET g_worksheet_hidden = 0

END FUNCTION]]>
  </point>
  <point name="function.adbm201_input" order="11" ver="9" cite_std="N" new="Y" status="u" src="s" readonly="" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adbm201_input(p_cmd)
   {<Local define>}
   DEFINE p_cmd           LIKE type_t.chr1
   DEFINE l_ac_t          LIKE type_t.num5        #未取消的ARRAY CNT
   DEFINE l_n             LIKE type_t.num5        #檢查重複用
   DEFINE l_cnt           LIKE type_t.num5        #檢查重複用
   DEFINE l_lock_sw       LIKE type_t.chr1        #單身鎖住否
   DEFINE l_allow_insert  LIKE type_t.num5        #可新增否
   DEFINE l_allow_delete  LIKE type_t.num5        #可刪除否
   DEFINE l_count         LIKE type_t.num5
   DEFINE l_i             LIKE type_t.num5
   DEFINE l_insert        LIKE type_t.num5
   DEFINE ls_return       STRING
   DEFINE l_var_keys      DYNAMIC ARRAY OF STRING
   DEFINE l_var_keys_bak  DYNAMIC ARRAY OF STRING
   DEFINE l_field_keys    DYNAMIC ARRAY OF STRING
   DEFINE l_vars          DYNAMIC ARRAY OF STRING
   DEFINE l_fields        DYNAMIC ARRAY OF STRING
   {</Local define>}
   #add-point:input段define
   DEFINE l_success       LIKE type_t.num5
   DEFINE l_errno         LIKE type_t.chr10
   {#ADP版次:1#}
   #end add-point

   #切換畫面
   IF g_main_hidden THEN
      CALL gfrm_curr.setElementHidden("mainlayout",0)
      CALL gfrm_curr.setElementHidden("worksheet",1)
      LET g_main_hidden = 0
   END IF

   CALL cl_set_head_visible("","YES")

   IF p_cmd = 'r' THEN
      #此段落的r動作等同於a
      LET p_cmd = 'a'
   END IF

   LET l_insert = FALSE
   LET g_action_choice = ""

   LET g_qryparam.state = "i"

   #控制key欄位可否輸入
   CALL adbm201_set_entry(p_cmd)
   #add-point:set_entry後
             {#ADP版次:1#}
   #end add-point
   CALL adbm201_set_no_entry(p_cmd)
   #add-point:資料輸入前
   LET l_allow_insert = cl_auth_detail_input("insert")
   LET l_allow_delete = cl_auth_detail_input("delete")
   LET g_detail_insert = l_allow_insert
   LET g_detail_delete = l_allow_delete{#ADP版次:1#}
   #end add-point

   DISPLAY BY NAME g_pmaa_m.pmaa095,g_pmaa_m.pmaa001,g_pmaa_m.pmaal004,g_pmaa_m.pmaal003,g_pmaa_m.pmaal005,
       g_pmaa_m.pmaa005,g_pmaa_m.pmaa006,g_pmaa_m.pmaa090,g_pmaa_m.pmaa026,g_pmaa_m.pmaa221,g_pmaa_m.pmaa232,
       g_pmaa_m.pmaa200,g_pmaa_m.pmaa201,g_pmaa_m.pmaa027,g_pmaa_m.pmaa004,g_pmaa_m.pmaa241,g_pmaa_m.pmaa242,
       g_pmaa_m.pmaa243,g_pmaa_m.pmaa244,g_pmaa_m.pmaastus,g_pmaa_m.pmaa017,
       g_pmaa_m.pmaa016,g_pmaa_m.pmaa018,g_pmaa_m.pmaa019,g_pmaa_m.pmaa021,g_pmaa_m.pmaa022,g_pmaa_m.pmaa020,
       g_pmaa_m.ooff013,g_pmaa_m.pmaa291,g_pmaa_m.pmaa292,g_pmaa_m.pmaa293,g_pmaa_m.pmaa294,g_pmaa_m.pmaa295,
       g_pmaa_m.pmaa296,g_pmaa_m.pmaa297,g_pmaa_m.pmaa298,g_pmaa_m.pmaa299,g_pmaa_m.pmaa300

   DIALOG ATTRIBUTES(UNBUFFERED,FIELD ORDER FORM)

      #單頭段
      INPUT BY NAME g_pmaa_m.pmaa095,g_pmaa_m.pmaa001,g_pmaa_m.pmaal004,g_pmaa_m.pmaal003,g_pmaa_m.pmaal005,
          g_pmaa_m.pmaa005,g_pmaa_m.pmaa006,g_pmaa_m.pmaa090,g_pmaa_m.pmaa026,g_pmaa_m.pmaa221,g_pmaa_m.pmaa232,
          g_pmaa_m.pmaa200,g_pmaa_m.pmaa201,g_pmaa_m.pmaa027,g_pmaa_m.pmaa004,g_pmaa_m.pmaa241,g_pmaa_m.pmaa242,
          g_pmaa_m.pmaa243,g_pmaa_m.pmaa244,g_pmaa_m.pmaastus,g_pmaa_m.pmaa017,
          g_pmaa_m.pmaa016,g_pmaa_m.pmaa018,g_pmaa_m.pmaa019,g_pmaa_m.pmaa021,g_pmaa_m.pmaa022,g_pmaa_m.pmaa020,
          g_pmaa_m.ooff013,g_pmaa_m.pmaa291,g_pmaa_m.pmaa292,g_pmaa_m.pmaa293,g_pmaa_m.pmaa294,g_pmaa_m.pmaa295,
          g_pmaa_m.pmaa296,g_pmaa_m.pmaa297,g_pmaa_m.pmaa298,g_pmaa_m.pmaa299,g_pmaa_m.pmaa300
         ATTRIBUTE(WITHOUT DEFAULTS)

         #自訂ACTION(master_input)


         ON ACTION update_item
            #add-point:ON ACTION update_item
                        IF NOT cl_null(g_pmaa_m.pmaa001)  THEN
               CALL n_pmaal(g_pmaa_m.pmaa001)
               INITIALIZE g_ref_fields TO NULL
               LET g_ref_fields[1] = g_pmaa_m.pmaa001
               CALL ap_ref_array2(g_ref_fields," SELECT pmaal003,pmaal004,pmaal005 FROM pmaal_t WHERE pmaalent = '"||g_enterprise||"' AND pmaal001 = ? AND pmaal002 = '"||g_dlang||"'","") RETURNING g_rtn_fields
               LET g_pmaa_m.pmaal003 = g_rtn_fields[1]
               LET g_pmaa_m.pmaal004 = g_rtn_fields[2]
               LET g_pmaa_m.pmaal005 = g_rtn_fields[3]
               DISPLAY BY NAME g_pmaa_m.pmaal003,g_pmaa_m.pmaal004,g_pmaa_m.pmaal005
            END IF            {#ADP版次:1#}
            #END add-point


         BEFORE INPUT
            IF s_transaction_chk("N",0) THEN
               CALL s_transaction_begin()
            END IF
            #其他table資料備份(確定是否更改用)
            LET g_master_multi_table_t.pmaal001 = g_pmaa_m.pmaa001
LET g_master_multi_table_t.pmaal004 = g_pmaa_m.pmaal004
LET g_master_multi_table_t.pmaal003 = g_pmaa_m.pmaal003
LET g_master_multi_table_t.pmaal005 = g_pmaa_m.pmaal005

            #add-point:input開始前
                      {#ADP版次:1#}
            #end add-point

         #---------------------------<  Master  >---------------------------
         #----<<pmaa095>>----
         #此段落由子樣板a02產生
         AFTER FIELD pmaa095

            #add-point:AFTER FIELD pmaa095
            LET g_pmaa_m.pmaa095_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmaa095_desc
            IF NOT cl_null(g_pmaa_m.pmaa095) THEN
               #150427-00012#2 20150504 by BeckXie--mark
#               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmaa095 != g_pmaa_m_t.pmaa095 OR g_pmaa_m_t.pmaa095 IS NULL )) THEN
               #150427-00012#2 20150504 by BeckXie--add---S
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmaa095 != g_pmaa_m_t.pmaa095 OR cl_null(g_pmaa_m_t.pmaa095) )) THEN
               #150427-00012#2 20150504 by BeckXie--add---E
                  CALL s_aooi500_chk(g_prog,'pmaaunit',g_pmaa_m.pmaa095,g_site)
                      RETURNING l_success,l_errno
                  IF NOT l_success THEN
                     LET g_pmaa_m.pmaa095 = g_pmaa_m_t.pmaa095
                     CALL s_desc_get_department_desc(g_pmaa_m.pmaa095)
                        RETURNING g_pmaa_m.pmaa095_desc
                     DISPLAY BY NAME g_pmaa_m.pmaa095_desc
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL s_desc_get_department_desc(g_pmaa_m.pmaa095)
               RETURNING g_pmaa_m.pmaa095_desc
            DISPLAY BY NAME g_pmaa_m.pmaa095_desc          {#ADP版次:1#}
            #END add-point


         #此段落由子樣板a01產生
         BEFORE FIELD pmaa095
            #add-point:BEFORE FIELD pmaa095
                      {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a04產生
         ON CHANGE pmaa095
            #add-point:ON CHANGE pmaa095
                      {#ADP版次:1#}
            #END add-point

         #----<<pmaa001>>----
         #此段落由子樣板a01產生
         BEFORE FIELD pmaa001
            #add-point:BEFORE FIELD pmaa001
            #IF cl_null(g_pmaa_m.pmaa001) THEN
            #   CALL s_aooi390('2') RETURNING l_success,g_pmaa_m.pmaa001
            #   DISPLAY BY NAME g_pmaa_m.pmaa001
            #   NEXT FIELD pmaa001
            #END IF          {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD pmaa001

            #add-point:AFTER FIELD pmaa001
            #此段落由子樣板a05產生
            IF  NOT cl_null(g_pmaa_m.pmaa001) THEN
               IF p_cmd = 'a' OR ( p_cmd = 'u' AND (g_pmaa_m.pmaa001 != g_pmaa001_t )) THEN
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM pmaa_t WHERE "||"pmaaent = '" ||g_enterprise|| "' AND "||"pmaa001 = '"||g_pmaa_m.pmaa001 ||"'",'std-00004',0) THEN
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
          {#ADP版次:1#}
            #END add-point


         #此段落由子樣板a04產生
         ON CHANGE pmaa001
            #add-point:ON CHANGE pmaa001
                      {#ADP版次:1#}
            #END add-point

         #----<<pmaal004>>----
         #此段落由子樣板a01產生
         BEFORE FIELD pmaal004
            #add-point:BEFORE FIELD pmaal004
                      {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD pmaal004

            #add-point:AFTER FIELD pmaal004
                      {#ADP版次:1#}
            #END add-point


         #此段落由子樣板a04產生
         ON CHANGE pmaal004
            #add-point:ON CHANGE pmaal004
                      {#ADP版次:1#}
            #END add-point

         #----<<pmaal003>>----
         #此段落由子樣板a01產生
         BEFORE FIELD pmaal003
            #add-point:BEFORE FIELD pmaal003
                      {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD pmaal003

            #add-point:AFTER FIELD pmaal003
                      {#ADP版次:1#}
            #END add-point


         #此段落由子樣板a04產生
         ON CHANGE pmaal003
            #add-point:ON CHANGE pmaal003
                      {#ADP版次:1#}
            #END add-point

         #----<<pmaal005>>----
         #此段落由子樣板a01產生
         BEFORE FIELD pmaal005
            #add-point:BEFORE FIELD pmaal005
                      {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD pmaal005

            #add-point:AFTER FIELD pmaal005
                      {#ADP版次:1#}
            #END add-point


         #此段落由子樣板a04產生
         ON CHANGE pmaal005
            #add-point:ON CHANGE pmaal005
                      {#ADP版次:1#}
            #END add-point

         #----<<pmaa005>>----
         #此段落由子樣板a02產生
         AFTER FIELD pmaa005

            #add-point:AFTER FIELD pmaa005
            LET g_pmaa_m.pmaa005_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmaa005_desc
            IF NOT cl_null(g_pmaa_m.pmaa005) THEN
               #150427-00012#2 20150504 by BeckXie--mark
               #IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmaa005 != g_pmaa_m_o.pmaa005 OR g_pmaa_m_o.pmaa005 IS NULL )) THEN
               IF g_pmaa_m.pmaa005 != g_pmaa_m_o.pmaa005 OR cl_null(g_pmaa_m_o.pmaa005) THEN   #150427-00012#2 20150504 by BeckXie--add
                  INITIALIZE g_chkparam.* TO NULL
                  LET g_chkparam.arg1 = g_pmaa_m.pmaa005
                  IF NOT cl_chk_exist("v_pmaa001_11") THEN
                     LET g_pmaa_m.pmaa005 = g_pmaa_m_o.pmaa005
                     CALL s_desc_get_trading_partner_abbr_desc(g_pmaa_m.pmaa005)
                        RETURNING g_pmaa_m.pmaa005_desc
                     DISPLAY BY NAME g_pmaa_m.pmaa005_desc
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL s_desc_get_trading_partner_abbr_desc(g_pmaa_m.pmaa005)
               RETURNING g_pmaa_m.pmaa005_desc
            DISPLAY BY NAME g_pmaa_m.pmaa005_desc
            LET g_pmaa_m_o.pmaa005 = g_pmaa_m.pmaa005
          {#ADP版次:1#}
            #END add-point


         #此段落由子樣板a01產生
         BEFORE FIELD pmaa005
            #add-point:BEFORE FIELD pmaa005
                      {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a04產生
         ON CHANGE pmaa005
            #add-point:ON CHANGE pmaa005
                      {#ADP版次:1#}
            #END add-point

         #----<<pmaa006>>----
         #此段落由子樣板a02產生
         AFTER FIELD pmaa006

            #add-point:AFTER FIELD pmaa006
            LET g_pmaa_m.pmaa006_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmaa006_desc
            IF NOT cl_null(g_pmaa_m.pmaa006) THEN
                #150427-00012#2 20150504 by BeckXie---mark
#               IF g_pmaa_m.pmaa006 != g_pmaa_m_o.pmaa006 OR g_pmaa_m_o.pmaa006 IS NULL THEN
               #150427-00012#2 20150504 by BeckXie--add---S
               IF g_pmaa_m.pmaa006 != g_pmaa_m_o.pmaa006 OR cl_null(g_pmaa_m_o.pmaa006) THEN   
               #150427-00012#2 20150504 by BeckXie--add---E
                  INITIALIZE g_chkparam.* TO NULL
                  LET g_chkparam.arg1 = g_pmaa_m.pmaa006
                  IF NOT cl_chk_exist("v_pmaa001_9") THEN
                     LET g_pmaa_m.pmaa006 = g_pmaa_m_o.pmaa006
                     CALL s_desc_get_trading_partner_abbr_desc(g_pmaa_m.pmaa006)
                        RETURNING g_pmaa_m.pmaa006_desc
                     DISPLAY BY NAME g_pmaa_m.pmaa006_desc
                     NEXT FIELD CURRENT
                  END IF
                  CALL adbm201_pmaa006_values()
               END IF
            END IF
            CALL s_desc_get_trading_partner_abbr_desc(g_pmaa_m.pmaa006)
               RETURNING g_pmaa_m.pmaa006_desc
            DISPLAY BY NAME g_pmaa_m.pmaa006_desc
            LET g_pmaa_m_o.pmaa006 = g_pmaa_m.pmaa006
            LET g_pmaa_m_o.pmaa241 = g_pmaa_m.pmaa241
            LET g_pmaa_m_o.pmaa242 = g_pmaa_m.pmaa242
            LET g_pmaa_m_o.pmaa243 = g_pmaa_m.pmaa243
            LET g_pmaa_m_o.pmaa244 = g_pmaa_m.pmaa244
          {#ADP版次:1#}
            #END add-point


         #此段落由子樣板a01產生
         BEFORE FIELD pmaa006
            #add-point:BEFORE FIELD pmaa006
                      {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a04產生
         ON CHANGE pmaa006
            #add-point:ON CHANGE pmaa006
                      {#ADP版次:1#}
            #END add-point

         #----<<pmaa090>>----
         #此段落由子樣板a02產生
         AFTER FIELD pmaa090

            #add-point:AFTER FIELD pmaa090
            LET g_pmaa_m.pmaa090_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmaa090_desc
            IF NOT cl_null(g_pmaa_m.pmaa090) THEN
               #150427-00012#2 20150504 by BeckXie--mark
               #IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmaa090 != g_pmaa_m_o.pmaa090 OR g_pmaa_m_o.pmaa090 IS NULL )) THEN
               IF g_pmaa_m.pmaa090 != g_pmaa_m_o.pmaa090 OR cl_null(g_pmaa_m_o.pmaa090)  THEN   #150427-00012#2 20150504 by BeckXie--add
                  IF NOT s_azzi650_chk_exist('281',g_pmaa_m.pmaa090) THEN
                     LET g_pmaa_m.pmaa090 = g_pmaa_m_o.pmaa090
                     CALL s_desc_get_acc_desc('281',g_pmaa_m.pmaa090)
                        RETURNING g_pmaa_m.pmaa090_desc
                     DISPLAY BY NAME g_pmaa_m.pmaa090_desc
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL s_desc_get_acc_desc('281',g_pmaa_m.pmaa090)
               RETURNING g_pmaa_m.pmaa090_desc
            DISPLAY BY NAME g_pmaa_m.pmaa090_desc
            LET g_pmaa_m_o.pmaa090 = g_pmaa_m.pmaa090
          {#ADP版次:1#}
            #END add-point


         #此段落由子樣板a01產生
         BEFORE FIELD pmaa090
            #add-point:BEFORE FIELD pmaa090
                      {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a04產生
         ON CHANGE pmaa090
            #add-point:ON CHANGE pmaa090
                      {#ADP版次:1#}
            #END add-point

         #----<<pmaa026>>----
         #此段落由子樣板a02產生
         AFTER FIELD pmaa026

            #add-point:AFTER FIELD pmaa026
            LET g_pmaa_m.pmaa026_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmaa026_desc
            IF NOT cl_null(g_pmaa_m.pmaa026) THEN
               #150427-00012#2 20150504 by BeckXie--mark
               #IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmaa026 != g_pmaa_m_o.pmaa026 OR g_pmaa_m_o.pmaa026 IS NULL )) THEN
               IF g_pmaa_m.pmaa026 != g_pmaa_m_o.pmaa026 OR cl_null(g_pmaa_m_o.pmaa026) THEN   #150427-00012#2 20150504 by BeckXie--add
                  IF NOT s_azzi650_chk_exist('250',g_pmaa_m.pmaa026) THEN
                     LET g_pmaa_m.pmaa026 = g_pmaa_m_o.pmaa026
                     CALL s_desc_get_acc_desc('250',g_pmaa_m.pmaa026)
                        RETURNING g_pmaa_m.pmaa026_desc
                     DISPLAY BY NAME g_pmaa_m.pmaa026_desc
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL s_desc_get_acc_desc('250',g_pmaa_m.pmaa026)
               RETURNING g_pmaa_m.pmaa026_desc
            DISPLAY BY NAME g_pmaa_m.pmaa026_desc
            LET g_pmaa_m_o.pmaa026 = g_pmaa_m.pmaa026
          {#ADP版次:1#}
            #END add-point


         #此段落由子樣板a01產生
         BEFORE FIELD pmaa026
            #add-point:BEFORE FIELD pmaa026
                      {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a04產生
         ON CHANGE pmaa026
            #add-point:ON CHANGE pmaa026
                      {#ADP版次:1#}
            #END add-point

         #----<<pmaa221>>----
         #此段落由子樣板a02產生
         AFTER FIELD pmaa221

            #add-point:AFTER FIELD pmaa221
            LET g_pmaa_m.pmaa221_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmaa221_desc
            IF NOT cl_null(g_pmaa_m.pmaa221) THEN
               #150427-00012#2 20150504 by BeckXie--mark
               #IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmaa221 != g_pmaa_m_o.pmaa221 OR g_pmaa_m_o.pmaa221 IS NULL )) THEN
               IF g_pmaa_m.pmaa221 != g_pmaa_m_o.pmaa221 OR cl_null(g_pmaa_m_o.pmaa221) THEN   #150427-00012#2 20150504 by BeckXie--add
                  INITIALIZE g_chkparam.* TO NULL
                  LET g_chkparam.arg1 = g_pmaa_m.pmaa221
                  LET g_chkparam.arg2 = '1'
                  IF NOT cl_chk_exist("v_oojd001") THEN
                     LET g_pmaa_m.pmaa221 = g_pmaa_m_o.pmaa221
                     CALL s_desc_get_oojdl003_desc(g_pmaa_m.pmaa221)
                        RETURNING g_pmaa_m.pmaa221_desc
                     DISPLAY BY NAME g_pmaa_m.pmaa221_desc
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL s_desc_get_oojdl003_desc(g_pmaa_m.pmaa221)
               RETURNING g_pmaa_m.pmaa221_desc
            DISPLAY BY NAME g_pmaa_m.pmaa221_desc
            LET g_pmaa_m_o.pmaa221 = g_pmaa_m.pmaa221
          {#ADP版次:1#}
            #END add-point


         #此段落由子樣板a01產生
         BEFORE FIELD pmaa221
            #add-point:BEFORE FIELD pmaa221
                      {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a04產生
         ON CHANGE pmaa221
            #add-point:ON CHANGE pmaa221
                      {#ADP版次:1#}
            #END add-point

         #----<<pmaa232>>----
         #此段落由子樣板a02產生
         AFTER FIELD pmaa232

            #add-point:AFTER FIELD pmaa232
            LET g_pmaa_m.pmaa232_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmaa232_desc
            IF NOT cl_null(g_pmaa_m.pmaa232) THEN
               #150427-00012#2 20150504 by BeckXie--mark
               #IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmaa232 != g_pmaa_m_o.pmaa232 OR g_pmaa_m_o.pmaa232 IS NULL )) THEN
               IF g_pmaa_m.pmaa232 != g_pmaa_m_o.pmaa232 OR cl_null(g_pmaa_m_o.pmaa232) THEN   #150427-00012#2 20150504 by BeckXie--add
                  IF NOT s_azzi650_chk_exist('2072',g_pmaa_m.pmaa232) THEN
                     LET g_pmaa_m.pmaa232 = g_pmaa_m_o.pmaa232
                     CALL s_desc_get_acc_desc('2072',g_pmaa_m.pmaa232)
                        RETURNING g_pmaa_m.pmaa232_desc
                     DISPLAY BY NAME g_pmaa_m.pmaa232_desc
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL s_desc_get_acc_desc('2072',g_pmaa_m.pmaa232)
               RETURNING g_pmaa_m.pmaa232_desc
            DISPLAY BY NAME g_pmaa_m.pmaa232_desc
            LET g_pmaa_m_o.pmaa232 = g_pmaa_m.pmaa232
          {#ADP版次:1#}
            #END add-point


         #此段落由子樣板a01產生
         BEFORE FIELD pmaa232
            #add-point:BEFORE FIELD pmaa232
                      {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a04產生
         ON CHANGE pmaa232
            #add-point:ON CHANGE pmaa232
                      {#ADP版次:1#}
            #END add-point

         #----<<pmaa200>>----
         #此段落由子樣板a01產生
         BEFORE FIELD pmaa200
            #add-point:BEFORE FIELD pmaa200
                      {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD pmaa200

            #add-point:AFTER FIELD pmaa200
                      {#ADP版次:1#}
            #END add-point


         #此段落由子樣板a04產生
         ON CHANGE pmaa200
            #add-point:ON CHANGE pmaa200
                      {#ADP版次:1#}
            #END add-point

         #----<<pmaa201>>----
         #此段落由子樣板a01產生
         BEFORE FIELD pmaa201
            #add-point:BEFORE FIELD pmaa201
                      {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD pmaa201

            #add-point:AFTER FIELD pmaa201
                      {#ADP版次:1#}
            #END add-point


         #此段落由子樣板a04產生
         ON CHANGE pmaa201
            #add-point:ON CHANGE pmaa201
                      {#ADP版次:1#}
            #END add-point

         #----<<pmaa027>>----
         #此段落由子樣板a01產生
         BEFORE FIELD pmaa027
            #add-point:BEFORE FIELD pmaa027
                      {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD pmaa027

            #add-point:AFTER FIELD pmaa027
                      {#ADP版次:1#}
            #END add-point


         #此段落由子樣板a04產生
         ON CHANGE pmaa027
            #add-point:ON CHANGE pmaa027
                      {#ADP版次:1#}
            #END add-point

         #----<<pmaa004>>----
         #此段落由子樣板a01產生
         BEFORE FIELD pmaa004
            #add-point:BEFORE FIELD pmaa004
            
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD pmaa004

            #add-point:AFTER FIELD pmaa004
            
            #END add-point


         #此段落由子樣板a04產生
         ON CHANGE pmaa004
            #add-point:ON CHANGE pmaa004
            
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD pmaa241

            #add-point:AFTER FIELD pmaa241
            LET g_pmaa_m.pmaa241_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmaa241_desc
            IF NOT cl_null(g_pmaa_m.pmaa241) THEN
               #150427-00012#2 20150504 by BeckXie--mark
#               IF g_pmaa_m.pmaa241 != g_pmaa_m_o.pmaa241 OR g_pmaa_m_o.pmaa241 IS NULL THEN
               #150427-00012#2 20150504 by BeckXie--add---S
               IF g_pmaa_m.pmaa241 != g_pmaa_m_o.pmaa241 OR cl_null(g_pmaa_m_o.pmaa241) THEN
               #150427-00012#2 20150504 by BeckXie--add---E
                  INITIALIZE g_chkparam.* TO NULL
                  LET g_chkparam.arg1 = g_pmaa_m.pmaa241
                  LET g_chkparam.arg2 = '1'
                  LET g_chkparam.err_str[1] = "acr-00004|",'1'
                  IF NOT cl_chk_exist("v_dbaa001_1") THEN
                     LET g_pmaa_m.pmaa241 = g_pmaa_m_o.pmaa241
                     LET g_pmaa_m.pmaa241_desc = s_desc_get_dbaa001_desc(g_pmaa_m.pmaa241)
                     DISPLAY BY NAME g_pmaa_m.pmaa241_desc
                     NEXT FIELD CURRENT
                  END IF
                  LET g_pmaa_m.pmaa242 = ''
                  LET g_pmaa_m.pmaa243 = ''
                  LET g_pmaa_m.pmaa244 = ''
                  LET g_pmaa_m.pmaa242_desc = ''
                  LET g_pmaa_m.pmaa243_desc = ''
                  LET g_pmaa_m.pmaa244_desc = ''
                  DISPLAY BY NAME g_pmaa_m.pmaa242_desc,g_pmaa_m.pmaa243_desc,g_pmaa_m.pmaa244_desc
               END IF
            END IF
            LET g_pmaa_m_o.pmaa244 = g_pmaa_m.pmaa244
            LET g_pmaa_m_o.pmaa243 = g_pmaa_m.pmaa243
            LET g_pmaa_m_o.pmaa242 = g_pmaa_m.pmaa242
            LET g_pmaa_m_o.pmaa241 = g_pmaa_m.pmaa241
            LET g_pmaa_m.pmaa241_desc = s_desc_get_dbaa001_desc(g_pmaa_m.pmaa241)
            DISPLAY BY NAME g_pmaa_m.pmaa241_desc
            #END add-point


         #此段落由子樣板a01產生
         BEFORE FIELD pmaa241
            #add-point:BEFORE FIELD pmaa241

            #END add-point

         #此段落由子樣板a04產生
         ON CHANGE pmaa241
            #add-point:ON CHANGE pmaa241

            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD pmaa242

            #add-point:AFTER FIELD pmaa242
            LET g_pmaa_m.pmaa242_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmaa242_desc
            IF NOT cl_null(g_pmaa_m.pmaa242) THEN
               #150427-00012#2 20150504 by BeckXie--mark
#               IF g_pmaa_m.pmaa242 != g_pmaa_m_o.pmaa242 OR g_pmaa_m_o.pmaa242 IS NULL THEN
               #150427-00012#2 20150504 by BeckXie--add---S
               IF g_pmaa_m.pmaa242 != g_pmaa_m_o.pmaa242 OR cl_null(g_pmaa_m_o.pmaa242) THEN
               #150427-00012#2 20150504 by BeckXie--add---E
                  INITIALIZE g_chkparam.* TO NULL
                  LET g_chkparam.arg1 = g_pmaa_m.pmaa242
                  LET g_chkparam.arg2 = '2'
                  LET g_chkparam.err_str[1] = "acr-00004|",'2'
                  IF NOT cl_chk_exist("v_dbaa001_1") THEN
                     LET g_pmaa_m.pmaa242 = g_pmaa_m_o.pmaa242
                     LET g_pmaa_m.pmaa242_desc = s_desc_get_dbaa001_desc(g_pmaa_m.pmaa242)
                     DISPLAY BY NAME g_pmaa_m.pmaa242_desc
                     NEXT FIELD CURRENT
                  END IF
                  IF cl_null(g_pmaa_m.pmaa241) THEN
                     CALL s_adb_get_dbaa003(g_pmaa_m.pmaa242,'2') RETURNING g_pmaa_m.pmaa241
                     LET g_pmaa_m.pmaa241_desc = s_desc_get_dbaa001_desc(g_pmaa_m.pmaa241)
                     DISPLAY BY NAME g_pmaa_m.pmaa241_desc
                  END IF
                  LET g_pmaa_m.pmaa243 = ''
                  LET g_pmaa_m.pmaa244 = ''
                  LET g_pmaa_m.pmaa243_desc = ''
                  LET g_pmaa_m.pmaa244_desc = ''
                  DISPLAY BY NAME g_pmaa_m.pmaa243_desc,g_pmaa_m.pmaa244_desc
               END IF
            END IF
            LET g_pmaa_m_o.pmaa244 = g_pmaa_m.pmaa244
            LET g_pmaa_m_o.pmaa243 = g_pmaa_m.pmaa243
            LET g_pmaa_m_o.pmaa242 = g_pmaa_m.pmaa242
            LET g_pmaa_m_o.pmaa241 = g_pmaa_m.pmaa241
            LET g_pmaa_m.pmaa242_desc = s_desc_get_dbaa001_desc(g_pmaa_m.pmaa242)
            DISPLAY BY NAME g_pmaa_m.pmaa242_desc
            #END add-point


         #此段落由子樣板a01產生
         BEFORE FIELD pmaa242
            #add-point:BEFORE FIELD pmaa242

            #END add-point

         #此段落由子樣板a04產生
         ON CHANGE pmaa242
            #add-point:ON CHANGE pmaa242

            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD pmaa243

            #add-point:AFTER FIELD pmaa243
            LET g_pmaa_m.pmaa243_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmaa243_desc
            IF NOT cl_null(g_pmaa_m.pmaa243) THEN
               #150427-00012#2 20150504 by BeckXie--mark
#               IF g_pmaa_m.pmaa243 != g_pmaa_m_o.pmaa243 OR g_pmaa_m_o.pmaa243 IS NULL THEN
               #150427-00012#2 20150504 by BeckXie--add---S
               IF g_pmaa_m.pmaa243 != g_pmaa_m_o.pmaa243 OR cl_null(g_pmaa_m_o.pmaa243) THEN
               #150427-00012#2 20150504 by BeckXie--add---E
                  INITIALIZE g_chkparam.* TO NULL
                  LET g_chkparam.arg1 = g_pmaa_m.pmaa243
                  LET g_chkparam.arg2 = '3'
                  LET g_chkparam.err_str[1] = "acr-00004|",'3'
                  IF NOT cl_chk_exist("v_dbaa001_1") THEN
                     LET g_pmaa_m.pmaa243 = g_pmaa_m_o.pmaa243
                     LET g_pmaa_m.pmaa243_desc = s_desc_get_dbaa001_desc(g_pmaa_m.pmaa243)
                     DISPLAY BY NAME g_pmaa_m.pmaa243_desc
                     NEXT FIELD CURRENT
                  END IF
                  IF cl_null(g_pmaa_m.pmaa242) THEN
                     CALL s_adb_get_dbaa003(g_pmaa_m.pmaa243,'3') RETURNING g_pmaa_m.pmaa242
                     CALL s_adb_get_dbaa003(g_pmaa_m.pmaa242,'2') RETURNING g_pmaa_m.pmaa241
                     LET g_pmaa_m.pmaa242_desc = s_desc_get_dbaa001_desc(g_pmaa_m.pmaa242)
                     DISPLAY BY NAME g_pmaa_m.pmaa242_desc
                     LET g_pmaa_m.pmaa241_desc = s_desc_get_dbaa001_desc(g_pmaa_m.pmaa241)
                     DISPLAY BY NAME g_pmaa_m.pmaa241_desc
                  END IF
                  LET g_pmaa_m.pmaa244 = ''
                  LET g_pmaa_m.pmaa244_desc = ''
                  DISPLAY BY NAME g_pmaa_m.pmaa244_desc
               END IF
            END IF
            LET g_pmaa_m_o.pmaa244 = g_pmaa_m.pmaa244
            LET g_pmaa_m_o.pmaa243 = g_pmaa_m.pmaa243
            LET g_pmaa_m_o.pmaa242 = g_pmaa_m.pmaa242
            LET g_pmaa_m_o.pmaa241 = g_pmaa_m.pmaa241
            LET g_pmaa_m.pmaa243_desc = s_desc_get_dbaa001_desc(g_pmaa_m.pmaa243)
            DISPLAY BY NAME g_pmaa_m.pmaa243_desc
            #END add-point


         #此段落由子樣板a01產生
         BEFORE FIELD pmaa243
            #add-point:BEFORE FIELD pmaa243

            #END add-point

         #此段落由子樣板a04產生
         ON CHANGE pmaa243
            #add-point:ON CHANGE pmaa243

            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD pmaa244

            #add-point:AFTER FIELD pmaa244
            LET g_pmaa_m.pmaa244_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmaa244_desc
            IF NOT cl_null(g_pmaa_m.pmaa244) THEN
               #150427-00012#2 20150504 by BeckXie--mark
#               IF g_pmaa_m.pmaa244 != g_pmaa_m_o.pmaa244 OR g_pmaa_m_o.pmaa244 IS NULL THEN
               #150427-00012#2 20150504 by BeckXie--add---S
               IF g_pmaa_m.pmaa244 != g_pmaa_m_o.pmaa244 OR cl_null(g_pmaa_m_o.pmaa244) THEN
               #150427-00012#2 20150504 by BeckXie--add---E
                  INITIALIZE g_chkparam.* TO NULL
                  LET g_chkparam.arg1 = g_pmaa_m.pmaa244
                  LET g_chkparam.arg2 = '4'
                  LET g_chkparam.err_str[1] = "acr-00004|",'4'
                  IF NOT cl_chk_exist("v_dbaa001_1") THEN
                     LET g_pmaa_m.pmaa244 = g_pmaa_m_o.pmaa244
                     LET g_pmaa_m.pmaa244_desc = s_desc_get_dbaa001_desc(g_pmaa_m.pmaa244)
                     DISPLAY BY NAME g_pmaa_m.pmaa244_desc
                     NEXT FIELD CURRENT
                  END IF
                  IF cl_null(g_pmaa_m.pmaa243) THEN
                     CALL s_adb_get_dbaa003(g_pmaa_m.pmaa244,'4') RETURNING g_pmaa_m.pmaa243
                     CALL s_adb_get_dbaa003(g_pmaa_m.pmaa243,'3') RETURNING g_pmaa_m.pmaa242
                     CALL s_adb_get_dbaa003(g_pmaa_m.pmaa242,'2') RETURNING g_pmaa_m.pmaa241
                     LET g_pmaa_m.pmaa243_desc = s_desc_get_dbaa001_desc(g_pmaa_m.pmaa243)
                     DISPLAY BY NAME g_pmaa_m.pmaa243_desc
                     LET g_pmaa_m.pmaa242_desc = s_desc_get_dbaa001_desc(g_pmaa_m.pmaa242)
                     DISPLAY BY NAME g_pmaa_m.pmaa242_desc
                     LET g_pmaa_m.pmaa241_desc = s_desc_get_dbaa001_desc(g_pmaa_m.pmaa241)
                     DISPLAY BY NAME g_pmaa_m.pmaa241_desc
                  END IF
               END IF
            END IF
            LET g_pmaa_m_o.pmaa244 = g_pmaa_m.pmaa244
            LET g_pmaa_m_o.pmaa243 = g_pmaa_m.pmaa243
            LET g_pmaa_m_o.pmaa242 = g_pmaa_m.pmaa242
            LET g_pmaa_m_o.pmaa241 = g_pmaa_m.pmaa241
            LET g_pmaa_m.pmaa244_desc = s_desc_get_dbaa001_desc(g_pmaa_m.pmaa244)
            DISPLAY BY NAME g_pmaa_m.pmaa244_desc
            #END add-point


         #此段落由子樣板a01產生
         BEFORE FIELD pmaa244
            #add-point:BEFORE FIELD pmaa244

            #END add-point

         #此段落由子樣板a04產生
         ON CHANGE pmaa244
            #add-point:ON CHANGE pmaa244

            #END add-point

         #----<<pmaastus>>----
         #此段落由子樣板a01產生
         BEFORE FIELD pmaastus
            #add-point:BEFORE FIELD pmaastus
                      {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD pmaastus

            #add-point:AFTER FIELD pmaastus
                      {#ADP版次:1#}
            #END add-point


         #此段落由子樣板a04產生
         ON CHANGE pmaastus
            #add-point:ON CHANGE pmaastus
                      {#ADP版次:1#}
            #END add-point

         #----<<pmaaownid>>----
         #----<<pmaaowndp>>----
         #----<<pmaacrtid>>----
         #----<<pmaacrtdp>>----
         #----<<pmaacrtdt>>----
         #----<<pmaamodid>>----
         #----<<pmaamoddt>>----
         #----<<pmaacnfid>>----
         #----<<pmaacnfdt>>----
         #----<<pmaa017>>----
         #此段落由子樣板a01產生
         BEFORE FIELD pmaa017
            #add-point:BEFORE FIELD pmaa017
                      {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD pmaa017

            #add-point:AFTER FIELD pmaa017
                      {#ADP版次:1#}
            #END add-point


         #此段落由子樣板a04產生
         ON CHANGE pmaa017
            #add-point:ON CHANGE pmaa017
                      {#ADP版次:1#}
            #END add-point

         #----<<pmaa016>>----
         #此段落由子樣板a01產生
         BEFORE FIELD pmaa016
            #add-point:BEFORE FIELD pmaa016
                      {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD pmaa016

            #add-point:AFTER FIELD pmaa016
                      {#ADP版次:1#}
            #END add-point


         #此段落由子樣板a04產生
         ON CHANGE pmaa016
            #add-point:ON CHANGE pmaa016
                      {#ADP版次:1#}
            #END add-point

         #----<<pmaa018>>----
         #此段落由子樣板a02產生
         AFTER FIELD pmaa018
            #此段落由子樣板a15產生
            IF NOT cl_ap_chk_Range(g_pmaa_m.pmaa018,"0.000","1","","","azz-00079",1) THEN
               NEXT FIELD pmaa018
            END IF


            #add-point:AFTER FIELD pmaa018
          {#ADP版次:1#}
            #END add-point


         #此段落由子樣板a01產生
         BEFORE FIELD pmaa018
            #add-point:BEFORE FIELD pmaa018
                      {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a04產生
         ON CHANGE pmaa018
            #add-point:ON CHANGE pmaa018
                      {#ADP版次:1#}
            #END add-point

         #----<<pmaa019>>----
         #此段落由子樣板a02產生
         AFTER FIELD pmaa019

            #add-point:AFTER FIELD pmaa019
            LET g_pmaa_m.pmaa019_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmaa019_desc
            IF NOT cl_null(g_pmaa_m.pmaa019) THEN
               #150427-00012#2 20150504 by BeckXie--mark
               #IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmaa019 != g_pmaa_m_o.pmaa019 OR g_pmaa_m_o.pmaa019 IS NULL )) THEN
               IF g_pmaa_m.pmaa019 != g_pmaa_m_o.pmaa019 OR cl_null(g_pmaa_m_o.pmaa019) THEN   #150427-00012#2 20150504 by BeckXie--add
                  INITIALIZE g_chkparam.* TO NULL
                  LET g_chkparam.arg1 = g_site
                  LET g_chkparam.arg2 = g_pmaa_m.pmaa019
                  IF NOT cl_chk_exist("v_ooaj002") THEN
                     LET g_pmaa_m.pmaa019 = g_pmaa_m_o.pmaa019
                     CALL s_desc_get_currency_desc(g_pmaa_m.pmaa019)
                        RETURNING g_pmaa_m.pmaa019_desc
                     DISPLAY BY NAME g_pmaa_m.pmaa019_desc
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL s_desc_get_currency_desc(g_pmaa_m.pmaa019)
               RETURNING g_pmaa_m.pmaa019_desc
            DISPLAY BY NAME g_pmaa_m.pmaa019_desc
            LET g_pmaa_m_o.pmaa019 = g_pmaa_m.pmaa019          {#ADP版次:1#}
            #END add-point


         #此段落由子樣板a01產生
         BEFORE FIELD pmaa019
            #add-point:BEFORE FIELD pmaa019
                      {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a04產生
         ON CHANGE pmaa019
            #add-point:ON CHANGE pmaa019
                      {#ADP版次:1#}
            #END add-point

         #----<<pmaa021>>----
         #此段落由子樣板a02產生
         AFTER FIELD pmaa021
            #此段落由子樣板a15產生
            IF NOT cl_ap_chk_Range(g_pmaa_m.pmaa021,"0.000","1","","","azz-00079",1) THEN
               NEXT FIELD pmaa021
            END IF


            #add-point:AFTER FIELD pmaa021
          {#ADP版次:1#}
            #END add-point


         #此段落由子樣板a01產生
         BEFORE FIELD pmaa021
            #add-point:BEFORE FIELD pmaa021
                      {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a04產生
         ON CHANGE pmaa021
            #add-point:ON CHANGE pmaa021
                      {#ADP版次:1#}
            #END add-point

         #----<<pmaa022>>----
         #此段落由子樣板a02產生
         AFTER FIELD pmaa022

            #add-point:AFTER FIELD pmaa022
            LET g_pmaa_m.pmaa022_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmaa022_desc
            IF NOT cl_null(g_pmaa_m.pmaa022) THEN
               #150427-00012#2 20150504 by BeckXie--mark
               #IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmaa022 != g_pmaa_m_o.pmaa022 OR g_pmaa_m_o.pmaa022 IS NULL )) THEN
               IF g_pmaa_m.pmaa022 != g_pmaa_m_o.pmaa022 OR cl_null(g_pmaa_m_o.pmaa022) THEN   #150427-00012#2 20150504 by BeckXie--add
                  INITIALIZE g_chkparam.* TO NULL
                  LET g_chkparam.arg1 = g_site
                  LET g_chkparam.arg2 = g_pmaa_m.pmaa022
                  IF NOT cl_chk_exist("v_ooaj002") THEN
                     LET g_pmaa_m.pmaa022 = g_pmaa_m_o.pmaa022
                     CALL s_desc_get_currency_desc(g_pmaa_m.pmaa022)
                        RETURNING g_pmaa_m.pmaa022_desc
                     DISPLAY BY NAME g_pmaa_m.pmaa022_desc
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL s_desc_get_currency_desc(g_pmaa_m.pmaa022)
               RETURNING g_pmaa_m.pmaa022_desc
            DISPLAY BY NAME g_pmaa_m.pmaa022_desc
            LET g_pmaa_m_o.pmaa022 = g_pmaa_m.pmaa022
          {#ADP版次:1#}
            #END add-point


         #此段落由子樣板a01產生
         BEFORE FIELD pmaa022
            #add-point:BEFORE FIELD pmaa022
                      {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a04產生
         ON CHANGE pmaa022
            #add-point:ON CHANGE pmaa022
                      {#ADP版次:1#}
            #END add-point

         #----<<pmaa020>>----
         #此段落由子樣板a02產生
         AFTER FIELD pmaa020
            #此段落由子樣板a15產生
            IF NOT cl_ap_chk_Range(g_pmaa_m.pmaa020,"0.000","1","","","azz-00079",1) THEN
               NEXT FIELD pmaa020
            END IF


            #add-point:AFTER FIELD pmaa020
                      {#ADP版次:1#}
            #END add-point


         #此段落由子樣板a01產生
         BEFORE FIELD pmaa020
            #add-point:BEFORE FIELD pmaa020
                      {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a04產生
         ON CHANGE pmaa020
            #add-point:ON CHANGE pmaa020
                      {#ADP版次:1#}
            #END add-point

         #----<<ooff013>>----
         #此段落由子樣板a01產生
         BEFORE FIELD ooff013
            #add-point:BEFORE FIELD ooff013
                      {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD ooff013

            #add-point:AFTER FIELD ooff013
                      {#ADP版次:1#}
            #END add-point


         #此段落由子樣板a04產生
         ON CHANGE ooff013
            #add-point:ON CHANGE ooff013
                      {#ADP版次:1#}
            #END add-point

         #----<<pmaa291>>----
         #此段落由子樣板a02產生
         AFTER FIELD pmaa291

            #add-point:AFTER FIELD pmaa291
            LET g_pmaa_m.pmaa291_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmaa291_desc
            IF NOT cl_null(g_pmaa_m.pmaa291) THEN
               #150427-00012#2 20150504 by BeckXie--mark
               #IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmaa291 != g_pmaa_m_o.pmaa291 OR g_pmaa_m_o.pmaa291 IS NULL )) THEN
               IF g_pmaa_m.pmaa291 != g_pmaa_m_o.pmaa291 OR cl_null(g_pmaa_m_o.pmaa291) THEN   #150427-00012#2 20150504 by BeckXie--add
                  IF NOT s_azzi650_chk_exist('2061',g_pmaa_m.pmaa291) THEN
                     LET g_pmaa_m.pmaa291 = g_pmaa_m_o.pmaa291
                     CALL s_desc_get_acc_desc('2061',g_pmaa_m.pmaa291)
                        RETURNING g_pmaa_m.pmaa291_desc
                     DISPLAY BY NAME g_pmaa_m.pmaa291_desc
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL s_desc_get_acc_desc('2061',g_pmaa_m.pmaa291)
               RETURNING g_pmaa_m.pmaa291_desc
            DISPLAY BY NAME g_pmaa_m.pmaa291_desc
            LET g_pmaa_m_o.pmaa291 = g_pmaa_m.pmaa291
          {#ADP版次:1#}
            #END add-point


         #此段落由子樣板a01產生
         BEFORE FIELD pmaa291
            #add-point:BEFORE FIELD pmaa291
                      {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a04產生
         ON CHANGE pmaa291
            #add-point:ON CHANGE pmaa291
                      {#ADP版次:1#}
            #END add-point

         #----<<pmaa292>>----
         #此段落由子樣板a02產生
         AFTER FIELD pmaa292

            #add-point:AFTER FIELD pmaa292
            LET g_pmaa_m.pmaa292_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmaa292_desc
            IF NOT cl_null(g_pmaa_m.pmaa292) THEN
               #150427-00012#2 20150504 by BeckXie--mark
               #IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmaa292 != g_pmaa_m_o.pmaa292 OR g_pmaa_m_o.pmaa292 IS NULL )) THEN
               IF g_pmaa_m.pmaa292 != g_pmaa_m_o.pmaa292 OR cl_null(g_pmaa_m_o.pmaa292) THEN   #150427-00012#2 20150504 by BeckXie--add
                  IF NOT s_azzi650_chk_exist('2062',g_pmaa_m.pmaa292) THEN
                     LET g_pmaa_m.pmaa292 = g_pmaa_m_o.pmaa292
                     CALL s_desc_get_acc_desc('2062',g_pmaa_m.pmaa292)
                        RETURNING g_pmaa_m.pmaa292_desc
                     DISPLAY BY NAME g_pmaa_m.pmaa292_desc
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL s_desc_get_acc_desc('2062',g_pmaa_m.pmaa292)
               RETURNING g_pmaa_m.pmaa292_desc
            DISPLAY BY NAME g_pmaa_m.pmaa292_desc
            LET g_pmaa_m_o.pmaa292 = g_pmaa_m.pmaa292
          {#ADP版次:1#}
            #END add-point


         #此段落由子樣板a01產生
         BEFORE FIELD pmaa292
            #add-point:BEFORE FIELD pmaa292
                      {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a04產生
         ON CHANGE pmaa292
            #add-point:ON CHANGE pmaa292
                      {#ADP版次:1#}
            #END add-point

         #----<<pmaa293>>----
         #此段落由子樣板a02產生
         AFTER FIELD pmaa293

            #add-point:AFTER FIELD pmaa293
            LET g_pmaa_m.pmaa293_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmaa293_desc
            IF NOT cl_null(g_pmaa_m.pmaa293) THEN
               #150427-00012#2 20150504 by BeckXie--mark
               #IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmaa293 != g_pmaa_m_o.pmaa293 OR g_pmaa_m_o.pmaa293 IS NULL )) THEN
               IF g_pmaa_m.pmaa293 != g_pmaa_m_o.pmaa293 OR cl_null(g_pmaa_m_o.pmaa293) THEN   #150427-00012#2 20150504 by BeckXie--add
                  IF NOT s_azzi650_chk_exist('2063',g_pmaa_m.pmaa293) THEN
                     LET g_pmaa_m.pmaa293 = g_pmaa_m_o.pmaa293
                     CALL s_desc_get_acc_desc('2063',g_pmaa_m.pmaa293)
                        RETURNING g_pmaa_m.pmaa293_desc
                     DISPLAY BY NAME g_pmaa_m.pmaa293_desc
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL s_desc_get_acc_desc('2063',g_pmaa_m.pmaa293)
               RETURNING g_pmaa_m.pmaa293_desc
            DISPLAY BY NAME g_pmaa_m.pmaa293_desc
            LET g_pmaa_m_o.pmaa293 = g_pmaa_m.pmaa293
          {#ADP版次:1#}
            #END add-point


         #此段落由子樣板a01產生
         BEFORE FIELD pmaa293
            #add-point:BEFORE FIELD pmaa293
                      {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a04產生
         ON CHANGE pmaa293
            #add-point:ON CHANGE pmaa293
                      {#ADP版次:1#}
            #END add-point

         #----<<pmaa294>>----
         #此段落由子樣板a02產生
         AFTER FIELD pmaa294

            #add-point:AFTER FIELD pmaa294
            LET g_pmaa_m.pmaa294_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmaa294_desc
            IF NOT cl_null(g_pmaa_m.pmaa294) THEN
               #150427-00012#2 20150504 by BeckXie--mark
               #IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmaa294 != g_pmaa_m_o.pmaa294 OR g_pmaa_m_o.pmaa294 IS NULL )) THEN
               IF g_pmaa_m.pmaa294 != g_pmaa_m_o.pmaa294 OR cl_null(g_pmaa_m_o.pmaa294) THEN   #150427-00012#2 20150504 by BeckXie--add
                  IF NOT s_azzi650_chk_exist('2064',g_pmaa_m.pmaa294) THEN
                     LET g_pmaa_m.pmaa294 = g_pmaa_m_o.pmaa294
                     CALL s_desc_get_acc_desc('2064',g_pmaa_m.pmaa294)
                        RETURNING g_pmaa_m.pmaa294_desc
                     DISPLAY BY NAME g_pmaa_m.pmaa294_desc
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL s_desc_get_acc_desc('2064',g_pmaa_m.pmaa294)
               RETURNING g_pmaa_m.pmaa294_desc
            DISPLAY BY NAME g_pmaa_m.pmaa294_desc
            LET g_pmaa_m_o.pmaa294 = g_pmaa_m.pmaa294
          {#ADP版次:1#}
            #END add-point


         #此段落由子樣板a01產生
         BEFORE FIELD pmaa294
            #add-point:BEFORE FIELD pmaa294
                      {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a04產生
         ON CHANGE pmaa294
            #add-point:ON CHANGE pmaa294
                      {#ADP版次:1#}
            #END add-point

         #----<<pmaa295>>----
         #此段落由子樣板a02產生
         AFTER FIELD pmaa295

            #add-point:AFTER FIELD pmaa295
            LET g_pmaa_m.pmaa295_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmaa295_desc
            IF NOT cl_null(g_pmaa_m.pmaa295) THEN
               #150427-00012#2 20150504 by BeckXie--mark
               #IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmaa295 != g_pmaa_m_o.pmaa295 OR g_pmaa_m_o.pmaa295 IS NULL )) THEN
               IF g_pmaa_m.pmaa295 != g_pmaa_m_o.pmaa295 OR cl_null(g_pmaa_m_o.pmaa295) THEN   #150427-00012#2 20150504 by BeckXie--add
                  IF NOT s_azzi650_chk_exist('2065',g_pmaa_m.pmaa295) THEN
                     LET g_pmaa_m.pmaa295 = g_pmaa_m_o.pmaa295
                     CALL s_desc_get_acc_desc('2065',g_pmaa_m.pmaa295)
                        RETURNING g_pmaa_m.pmaa295_desc
                     DISPLAY BY NAME g_pmaa_m.pmaa295_desc
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL s_desc_get_acc_desc('2065',g_pmaa_m.pmaa295)
               RETURNING g_pmaa_m.pmaa295_desc
            DISPLAY BY NAME g_pmaa_m.pmaa295_desc
            LET g_pmaa_m_o.pmaa295 = g_pmaa_m.pmaa295
          {#ADP版次:1#}
            #END add-point


         #此段落由子樣板a01產生
         BEFORE FIELD pmaa295
            #add-point:BEFORE FIELD pmaa295
                      {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a04產生
         ON CHANGE pmaa295
            #add-point:ON CHANGE pmaa295
                      {#ADP版次:1#}
            #END add-point

         #----<<pmaa296>>----
         #此段落由子樣板a02產生
         AFTER FIELD pmaa296

            #add-point:AFTER FIELD pmaa296
            LET g_pmaa_m.pmaa296_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmaa296_desc
            IF NOT cl_null(g_pmaa_m.pmaa296) THEN
               #150427-00012#2 20150504 by BeckXie--mark
               #IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmaa296 != g_pmaa_m_o.pmaa296 OR g_pmaa_m_o.pmaa296 IS NULL )) THEN
               IF g_pmaa_m.pmaa296 != g_pmaa_m_o.pmaa296 OR cl_null(g_pmaa_m_o.pmaa296) THEN   #150427-00012#2 20150504 by BeckXie--add
                  IF NOT s_azzi650_chk_exist('2066',g_pmaa_m.pmaa296) THEN
                     LET g_pmaa_m.pmaa296 = g_pmaa_m_o.pmaa296
                     CALL s_desc_get_acc_desc('2066',g_pmaa_m.pmaa296)
                        RETURNING g_pmaa_m.pmaa296_desc
                     DISPLAY BY NAME g_pmaa_m.pmaa296_desc
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL s_desc_get_acc_desc('2066',g_pmaa_m.pmaa296)
               RETURNING g_pmaa_m.pmaa296_desc
            DISPLAY BY NAME g_pmaa_m.pmaa296_desc
            LET g_pmaa_m_o.pmaa296 = g_pmaa_m.pmaa296
          {#ADP版次:1#}
            #END add-point


         #此段落由子樣板a01產生
         BEFORE FIELD pmaa296
            #add-point:BEFORE FIELD pmaa296
                      {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a04產生
         ON CHANGE pmaa296
            #add-point:ON CHANGE pmaa296
                      {#ADP版次:1#}
            #END add-point

         #----<<pmaa297>>----
         #此段落由子樣板a02產生
         AFTER FIELD pmaa297

            #add-point:AFTER FIELD pmaa297
            LET g_pmaa_m.pmaa297_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmaa297_desc
            IF NOT cl_null(g_pmaa_m.pmaa297) THEN
               #150427-00012#2 20150504 by BeckXie--mark
               #IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmaa297 != g_pmaa_m_o.pmaa297 OR g_pmaa_m_o.pmaa297 IS NULL )) THEN
               IF g_pmaa_m.pmaa297 != g_pmaa_m_o.pmaa297 OR cl_null(g_pmaa_m_o.pmaa297) THEN   #150427-00012#2 20150504 by BeckXie--add
                  IF NOT s_azzi650_chk_exist('2067',g_pmaa_m.pmaa297) THEN
                     LET g_pmaa_m.pmaa297 = g_pmaa_m_o.pmaa297
                     CALL s_desc_get_acc_desc('2067',g_pmaa_m.pmaa297)
                        RETURNING g_pmaa_m.pmaa297_desc
                     DISPLAY BY NAME g_pmaa_m.pmaa297_desc
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL s_desc_get_acc_desc('2067',g_pmaa_m.pmaa297)
               RETURNING g_pmaa_m.pmaa297_desc
            DISPLAY BY NAME g_pmaa_m.pmaa297_desc
            LET g_pmaa_m_o.pmaa297 = g_pmaa_m.pmaa297
          {#ADP版次:1#}
            #END add-point


         #此段落由子樣板a01產生
         BEFORE FIELD pmaa297
            #add-point:BEFORE FIELD pmaa297
                      {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a04產生
         ON CHANGE pmaa297
            #add-point:ON CHANGE pmaa297
                      {#ADP版次:1#}
            #END add-point

         #----<<pmaa298>>----
         #此段落由子樣板a02產生
         AFTER FIELD pmaa298

            #add-point:AFTER FIELD pmaa298
            LET g_pmaa_m.pmaa298_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmaa298_desc
            IF NOT cl_null(g_pmaa_m.pmaa298) THEN
               #150427-00012#2 20150504 by BeckXie--mark
               #IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmaa298 != g_pmaa_m_o.pmaa298 OR g_pmaa_m_o.pmaa298 IS NULL )) THEN
               IF g_pmaa_m.pmaa298 != g_pmaa_m_o.pmaa298 OR cl_null(g_pmaa_m_o.pmaa298) THEN   #150427-00012#2 20150504 by BeckXie--add
                  IF NOT s_azzi650_chk_exist('2068',g_pmaa_m.pmaa298) THEN
                     LET g_pmaa_m.pmaa298 = g_pmaa_m_o.pmaa298
                     CALL s_desc_get_acc_desc('2068',g_pmaa_m.pmaa298)
                        RETURNING g_pmaa_m.pmaa298_desc
                     DISPLAY BY NAME g_pmaa_m.pmaa298_desc
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL s_desc_get_acc_desc('2068',g_pmaa_m.pmaa298)
               RETURNING g_pmaa_m.pmaa298_desc
            DISPLAY BY NAME g_pmaa_m.pmaa298_desc
            LET g_pmaa_m_o.pmaa298 = g_pmaa_m.pmaa298
          {#ADP版次:1#}
            #END add-point


         #此段落由子樣板a01產生
         BEFORE FIELD pmaa298
            #add-point:BEFORE FIELD pmaa298
                      {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a04產生
         ON CHANGE pmaa298
            #add-point:ON CHANGE pmaa298
                      {#ADP版次:1#}
            #END add-point

         #----<<pmaa299>>----
         #此段落由子樣板a02產生
         AFTER FIELD pmaa299

            #add-point:AFTER FIELD pmaa299
            LET g_pmaa_m.pmaa299_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmaa299_desc
            IF NOT cl_null(g_pmaa_m.pmaa299) THEN
               #150427-00012#2 20150504 by BeckXie--mark
               #IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmaa299 != g_pmaa_m_o.pmaa299 OR g_pmaa_m_o.pmaa299 IS NULL )) THEN
               IF g_pmaa_m.pmaa299 != g_pmaa_m_o.pmaa299 OR cl_null(g_pmaa_m_o.pmaa299) THEN   #150427-00012#2 20150504 by BeckXie--add
                  IF NOT s_azzi650_chk_exist('2069',g_pmaa_m.pmaa299) THEN
                     LET g_pmaa_m.pmaa299 = g_pmaa_m_o.pmaa299
                     CALL s_desc_get_acc_desc('2069',g_pmaa_m.pmaa299)
                        RETURNING g_pmaa_m.pmaa299_desc
                     DISPLAY BY NAME g_pmaa_m.pmaa299_desc
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL s_desc_get_acc_desc('2069',g_pmaa_m.pmaa299)
               RETURNING g_pmaa_m.pmaa299_desc
            DISPLAY BY NAME g_pmaa_m.pmaa299_desc
            LET g_pmaa_m_o.pmaa299 = g_pmaa_m.pmaa299
          {#ADP版次:1#}
            #END add-point


         #此段落由子樣板a01產生
         BEFORE FIELD pmaa299
            #add-point:BEFORE FIELD pmaa299
                      {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a04產生
         ON CHANGE pmaa299
            #add-point:ON CHANGE pmaa299
                      {#ADP版次:1#}
            #END add-point

         #----<<pmaa300>>----
         #此段落由子樣板a02產生
         AFTER FIELD pmaa300

            #add-point:AFTER FIELD pmaa300
            LET g_pmaa_m.pmaa300_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmaa300_desc
            IF NOT cl_null(g_pmaa_m.pmaa300) THEN
               #150427-00012#2 20150504 by BeckXie--mark
               #IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmaa300 != g_pmaa_m_o.pmaa293 OR g_pmaa_m_o.pmaa293 IS NULL )) THEN
               IF g_pmaa_m.pmaa300 != g_pmaa_m_o.pmaa293 OR cl_null(g_pmaa_m_o.pmaa293) THEN   #150427-00012#2 20150504 by BeckXie--add
                  IF NOT s_azzi650_chk_exist('2070',g_pmaa_m.pmaa300) THEN
                     LET g_pmaa_m.pmaa300 = g_pmaa_m_o.pmaa300
                     CALL s_desc_get_acc_desc('2070',g_pmaa_m.pmaa300)
                        RETURNING g_pmaa_m.pmaa300_desc
                     DISPLAY BY NAME g_pmaa_m.pmaa300_desc
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL s_desc_get_acc_desc('2070',g_pmaa_m.pmaa300)
               RETURNING g_pmaa_m.pmaa300_desc
            DISPLAY BY NAME g_pmaa_m.pmaa300_desc
            LET g_pmaa_m_o.pmaa300 = g_pmaa_m.pmaa300
          {#ADP版次:1#}
            #END add-point


         #此段落由子樣板a01產生
         BEFORE FIELD pmaa300
            #add-point:BEFORE FIELD pmaa300
                      {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a04產生
         ON CHANGE pmaa300
            #add-point:ON CHANGE pmaa300
                      {#ADP版次:1#}
            #END add-point

 #欄位檢查
         #---------------------------<  Master  >---------------------------
         #----<<pmaa095>>----
         #Ctrlp:input.c.pmaa095
         ON ACTION controlp INFIELD pmaa095
            #add-point:ON ACTION controlp INFIELD pmaa095
            #此段落由子樣板a07產生
            #開窗i段
			   INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			   LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_pmaa_m.pmaa095             #給予default值

            #給予arg
            LET g_qryparam.where = s_aooi500_q_where(g_prog,'pmaaunit',g_site,'i') #150308-00001#1  By Ken add 'i' 150309
            CALL q_ooef001_24()                                #呼叫開窗

            LET g_pmaa_m.pmaa095 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_pmaa_m.pmaa095 TO pmaa095              #顯示到畫面上
            CALL s_desc_get_department_desc(g_pmaa_m.pmaa095)
               RETURNING g_pmaa_m.pmaa095_desc
            DISPLAY BY NAME g_pmaa_m.pmaa095_desc
            NEXT FIELD pmaa095                          #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #----<<pmaa001>>----
         #Ctrlp:input.c.pmaa001
#         ON ACTION controlp INFIELD pmaa001
            #add-point:ON ACTION controlp INFIELD pmaa001
                      {#ADP版次:1#}
            #END add-point

         #----<<pmaal004>>----
         #Ctrlp:input.c.pmaal004
#         ON ACTION controlp INFIELD pmaal004
            #add-point:ON ACTION controlp INFIELD pmaal004
                      {#ADP版次:1#}
            #END add-point

         #----<<pmaal003>>----
         #Ctrlp:input.c.pmaal003
#         ON ACTION controlp INFIELD pmaal003
            #add-point:ON ACTION controlp INFIELD pmaal003
                      {#ADP版次:1#}
            #END add-point

         #----<<pmaal005>>----
         #Ctrlp:input.c.pmaal005
#         ON ACTION controlp INFIELD pmaal005
            #add-point:ON ACTION controlp INFIELD pmaal005
                      {#ADP版次:1#}
            #END add-point

         #----<<pmaa005>>----
         #Ctrlp:input.c.pmaa005
         ON ACTION controlp INFIELD pmaa005
            #add-point:ON ACTION controlp INFIELD pmaa005
            #此段落由子樣板a07產生
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_pmaa_m.pmaa005             #給予default值

            #給予arg
            CALL q_pmaa001_14()                                #呼叫開窗

            LET g_pmaa_m.pmaa005 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_pmaa_m.pmaa005 TO pmaa005              #顯示到畫面上
            CALL s_desc_get_trading_partner_abbr_desc(g_pmaa_m.pmaa005)
               RETURNING g_pmaa_m.pmaa005_desc
            DISPLAY BY NAME g_pmaa_m.pmaa005_desc
            NEXT FIELD pmaa005                          #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #----<<pmaa006>>----
         #Ctrlp:input.c.pmaa006
         ON ACTION controlp INFIELD pmaa006
            #add-point:ON ACTION controlp INFIELD pmaa006
            #此段落由子樣板a07產生
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_pmaa_m.pmaa006             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "1" #客戶性質
            LET g_qryparam.arg2 = "2" #客戶經營類別

            CALL q_pmaa001_12()                                #呼叫開窗

            LET g_pmaa_m.pmaa006 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_pmaa_m.pmaa006 TO pmaa006              #顯示到畫面上
            CALL s_desc_get_trading_partner_abbr_desc(g_pmaa_m.pmaa006)
               RETURNING g_pmaa_m.pmaa006_desc
            DISPLAY BY NAME g_pmaa_m.pmaa006_desc
            NEXT FIELD pmaa006                          #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #----<<pmaa090>>----
         #Ctrlp:input.c.pmaa090
         ON ACTION controlp INFIELD pmaa090
            #add-point:ON ACTION controlp INFIELD pmaa090
            #此段落由子樣板a07產生
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_pmaa_m.pmaa090             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "281" #

            CALL q_oocq002()                                #呼叫開窗

            LET g_pmaa_m.pmaa090 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_pmaa_m.pmaa090 TO pmaa090              #顯示到畫面上
            CALL s_desc_get_acc_desc('281',g_pmaa_m.pmaa090)
               RETURNING g_pmaa_m.pmaa090_desc
            DISPLAY BY NAME g_pmaa_m.pmaa090_desc
            NEXT FIELD pmaa090                          #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #----<<pmaa026>>----
         #Ctrlp:input.c.pmaa026
         ON ACTION controlp INFIELD pmaa026
            #add-point:ON ACTION controlp INFIELD pmaa026
            #此段落由子樣板a07產生
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_pmaa_m.pmaa026             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "250" #

            CALL q_oocq002()                                #呼叫開窗

            LET g_pmaa_m.pmaa026 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_pmaa_m.pmaa026 TO pmaa026              #顯示到畫面上
            CALL s_desc_get_acc_desc('250',g_pmaa_m.pmaa026)
               RETURNING g_pmaa_m.pmaa026_desc
            DISPLAY BY NAME g_pmaa_m.pmaa026_desc
            NEXT FIELD pmaa026                          #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #----<<pmaa221>>----
         #Ctrlp:input.c.pmaa221
         ON ACTION controlp INFIELD pmaa221
            #add-point:ON ACTION controlp INFIELD pmaa221
            #此段落由子樣板a07產生
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_pmaa_m.pmaa221             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "1" #

            CALL q_oojd001_1()                                #呼叫開窗

            LET g_pmaa_m.pmaa221 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_pmaa_m.pmaa221 TO pmaa221              #顯示到畫面上
            CALL s_desc_get_oojdl003_desc(g_pmaa_m.pmaa221)
               RETURNING g_pmaa_m.pmaa221_desc
            DISPLAY BY NAME g_pmaa_m.pmaa221_desc
            NEXT FIELD pmaa221                          #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #----<<pmaa232>>----
         #Ctrlp:input.c.pmaa232
         ON ACTION controlp INFIELD pmaa232
            #add-point:ON ACTION controlp INFIELD pmaa232
            #此段落由子樣板a07產生
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_pmaa_m.pmaa232             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "2072" #

            CALL q_oocq002()                                #呼叫開窗

            LET g_pmaa_m.pmaa232 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_pmaa_m.pmaa232 TO pmaa232              #顯示到畫面上
            CALL s_desc_get_acc_desc('2072',g_pmaa_m.pmaa232)
               RETURNING g_pmaa_m.pmaa232_desc
            DISPLAY BY NAME g_pmaa_m.pmaa232_desc
            NEXT FIELD pmaa232                          #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #----<<pmaa200>>----
         #Ctrlp:input.c.pmaa200
#         ON ACTION controlp INFIELD pmaa200
            #add-point:ON ACTION controlp INFIELD pmaa200
                      {#ADP版次:1#}
            #END add-point

         #----<<pmaa201>>----
         #Ctrlp:input.c.pmaa201
#         ON ACTION controlp INFIELD pmaa201
            #add-point:ON ACTION controlp INFIELD pmaa201
                      {#ADP版次:1#}
            #END add-point

         #----<<pmaa027>>----
         #Ctrlp:input.c.pmaa027
#         ON ACTION controlp INFIELD pmaa027
            #add-point:ON ACTION controlp INFIELD pmaa027
                      {#ADP版次:1#}
            #END add-point

         #----<<pmaa004>>----
         #Ctrlp:input.c.pmaa004
#         ON ACTION controlp INFIELD pmaa004
            #add-point:ON ACTION controlp INFIELD pmaa004
            
            #END add-point
            
         #Ctrlp:input.c.pmaa241
         ON ACTION controlp INFIELD pmaa241
            #add-point:ON ACTION controlp INFIELD pmaa241
                                                                                    #此段落由子樣板a07產生
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_pmaa_m.pmaa241      #給予default值
            #給予arg
            LET g_qryparam.arg1 = "1"
            CALL q_dbaa001_1()                                #呼叫開窗
            LET g_pmaa_m.pmaa241 = g_qryparam.return1       #將開窗取得的值回傳到變數
            DISPLAY g_pmaa_m.pmaa241 TO pmaa241             #顯示到畫面上
            LET g_pmaa_m.pmaa241_desc = s_desc_get_dbaa001_desc(g_pmaa_m.pmaa241)
            DISPLAY BY NAME g_pmaa_m.pmaa241_desc
            NEXT FIELD pmaa241                              #返回原欄位
            #END add-point

         #Ctrlp:input.c.pmaa242
         ON ACTION controlp INFIELD pmaa242
            #add-point:ON ACTION controlp INFIELD pmaa242
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_pmaa_m.pmaa242      #給予default值
            IF NOT cl_null(g_pmaa_m.pmaa241) THEN
               LET g_qryparam.arg1 = "2"
               LET g_qryparam.arg2 = g_pmaa_m.pmaa241
               CALL q_dbaa001_2()                                #呼叫開窗
            ELSE
               LET g_qryparam.arg1 = "2"
               CALL q_dbaa001_1()                                #呼叫開窗
            END IF
            LET g_pmaa_m.pmaa242 = g_qryparam.return1       #將開窗取得的值回傳到變數
            DISPLAY g_pmaa_m.pmaa242 TO pmaa242             #顯示到畫面上
            LET g_pmaa_m.pmaa242_desc = s_desc_get_dbaa001_desc(g_pmaa_m.pmaa242)
            DISPLAY BY NAME g_pmaa_m.pmaa242_desc
            NEXT FIELD pmaa242                              #返回原欄位
            #END add-point

         #Ctrlp:input.c.pmaa243
         ON ACTION controlp INFIELD pmaa243
            #add-point:ON ACTION controlp INFIELD pmaa243
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_pmaa_m.pmaa243      #給予default值
            IF NOT cl_null(g_pmaa_m.pmaa242) THEN
               LET g_qryparam.arg1 = "3"
               LET g_qryparam.arg2 = g_pmaa_m.pmaa242
               CALL q_dbaa001_2()                                #呼叫開窗
            ELSE
               LET g_qryparam.arg1 = "3"
               CALL q_dbaa001_1()                                #呼叫開窗
            END IF
            LET g_pmaa_m.pmaa243 = g_qryparam.return1       #將開窗取得的值回傳到變數
            DISPLAY g_pmaa_m.pmaa243 TO pmaa243             #顯示到畫面上
            LET g_pmaa_m.pmaa243_desc = s_desc_get_dbaa001_desc(g_pmaa_m.pmaa243)
            DISPLAY BY NAME g_pmaa_m.pmaa243_desc
            NEXT FIELD pmaa243                              #返回原欄位
            #END add-point

         #Ctrlp:input.c.pmaa244
         ON ACTION controlp INFIELD pmaa244
            #add-point:ON ACTION controlp INFIELD pmaa244
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_pmaa_m.pmaa244      #給予default值
            IF NOT cl_null(g_pmaa_m.pmaa243) THEN
               LET g_qryparam.arg1 = "4"
               LET g_qryparam.arg2 = g_pmaa_m.pmaa243
               CALL q_dbaa001_2()                                #呼叫開窗
            ELSE
               LET g_qryparam.arg1 = "4"
               CALL q_dbaa001_1()                                #呼叫開窗
            END IF
            LET g_pmaa_m.pmaa244 = g_qryparam.return1       #將開窗取得的值回傳到變數
            DISPLAY g_pmaa_m.pmaa244 TO pmaa244             #顯示到畫面上
            LET g_pmaa_m.pmaa244_desc = s_desc_get_dbaa001_desc(g_pmaa_m.pmaa244)
            DISPLAY BY NAME g_pmaa_m.pmaa244_desc
            NEXT FIELD pmaa244                              #返回原欄位
            #END add-point
            
         #----<<pmaastus>>----
         #Ctrlp:input.c.pmaastus
#         ON ACTION controlp INFIELD pmaastus
            #add-point:ON ACTION controlp INFIELD pmaastus
                      {#ADP版次:1#}
            #END add-point

         #----<<pmaaownid>>----
         #----<<pmaaowndp>>----
         #----<<pmaacrtid>>----
         #----<<pmaacrtdp>>----
         #----<<pmaacrtdt>>----
         #----<<pmaamodid>>----
         #----<<pmaamoddt>>----
         #----<<pmaacnfid>>----
         #----<<pmaacnfdt>>----
         #----<<pmaa017>>----
         #Ctrlp:input.c.pmaa017
#         ON ACTION controlp INFIELD pmaa017
            #add-point:ON ACTION controlp INFIELD pmaa017
                      {#ADP版次:1#}
            #END add-point

         #----<<pmaa016>>----
         #Ctrlp:input.c.pmaa016
#         ON ACTION controlp INFIELD pmaa016
            #add-point:ON ACTION controlp INFIELD pmaa016
                      {#ADP版次:1#}
            #END add-point

         #----<<pmaa018>>----
         #Ctrlp:input.c.pmaa018
#         ON ACTION controlp INFIELD pmaa018
            #add-point:ON ACTION controlp INFIELD pmaa018
                      {#ADP版次:1#}
            #END add-point

         #----<<pmaa019>>----
         #Ctrlp:input.c.pmaa019
         ON ACTION controlp INFIELD pmaa019
            #add-point:ON ACTION controlp INFIELD pmaa019
            #此段落由子樣板a07產生
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_pmaa_m.pmaa019             #給予default值

            #給予arg
            LET g_qryparam.arg1 = g_site #營運據點

            CALL q_ooaj002_1()                                #呼叫開窗

            LET g_pmaa_m.pmaa019 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_pmaa_m.pmaa019 TO pmaa019              #顯示到畫面上
            CALL s_desc_get_currency_desc(g_pmaa_m.pmaa019)
               RETURNING g_pmaa_m.pmaa019_desc
            DISPLAY BY NAME g_pmaa_m.pmaa019_desc
            NEXT FIELD pmaa019                          #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #----<<pmaa021>>----
         #Ctrlp:input.c.pmaa021
#         ON ACTION controlp INFIELD pmaa021
            #add-point:ON ACTION controlp INFIELD pmaa021
                      {#ADP版次:1#}
            #END add-point

         #----<<pmaa022>>----
         #Ctrlp:input.c.pmaa022
         ON ACTION controlp INFIELD pmaa022
            #add-point:ON ACTION controlp INFIELD pmaa022
            #此段落由子樣板a07產生
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_pmaa_m.pmaa022             #給予default值

            #給予arg
            LET g_qryparam.arg1 = g_site #營運據點

            CALL q_ooaj002_1()                                #呼叫開窗

            LET g_pmaa_m.pmaa022 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_pmaa_m.pmaa022 TO pmaa022              #顯示到畫面上
            CALL s_desc_get_currency_desc(g_pmaa_m.pmaa022)
               RETURNING g_pmaa_m.pmaa022_desc
            DISPLAY BY NAME g_pmaa_m.pmaa022_desc
            NEXT FIELD pmaa022                          #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #----<<pmaa020>>----
         #Ctrlp:input.c.pmaa020
#         ON ACTION controlp INFIELD pmaa020
            #add-point:ON ACTION controlp INFIELD pmaa020
                      {#ADP版次:1#}
            #END add-point

         #----<<ooff013>>----
         #Ctrlp:input.c.ooff013
#         ON ACTION controlp INFIELD ooff013
            #add-point:ON ACTION controlp INFIELD ooff013
                      {#ADP版次:1#}
            #END add-point

         #----<<pmaa291>>----
         #Ctrlp:input.c.pmaa291
         ON ACTION controlp INFIELD pmaa291
            #add-point:ON ACTION controlp INFIELD pmaa291
            #此段落由子樣板a07產生
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_pmaa_m.pmaa291             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "2061" #

            CALL q_oocq002()                                #呼叫開窗

            LET g_pmaa_m.pmaa291 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_pmaa_m.pmaa291 TO pmaa291              #顯示到畫面上
            CALL s_desc_get_acc_desc('2061',g_pmaa_m.pmaa291)
               RETURNING g_pmaa_m.pmaa291_desc
            DISPLAY BY NAME g_pmaa_m.pmaa291_desc
            NEXT FIELD pmaa291                          #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #----<<pmaa292>>----
         #Ctrlp:input.c.pmaa292
         ON ACTION controlp INFIELD pmaa292
            #add-point:ON ACTION controlp INFIELD pmaa292
            #此段落由子樣板a07產生
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_pmaa_m.pmaa292             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "2062" #

            CALL q_oocq002()                                #呼叫開窗

            LET g_pmaa_m.pmaa292 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_pmaa_m.pmaa292 TO pmaa292              #顯示到畫面上
            CALL s_desc_get_acc_desc('2062',g_pmaa_m.pmaa292)
               RETURNING g_pmaa_m.pmaa292_desc
            DISPLAY BY NAME g_pmaa_m.pmaa292_desc
            NEXT FIELD pmaa292                          #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #----<<pmaa293>>----
         #Ctrlp:input.c.pmaa293
         ON ACTION controlp INFIELD pmaa293
            #add-point:ON ACTION controlp INFIELD pmaa293
            #此段落由子樣板a07產生
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_pmaa_m.pmaa293             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "2063" #

            CALL q_oocq002()                                #呼叫開窗

            LET g_pmaa_m.pmaa293 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_pmaa_m.pmaa293 TO pmaa293              #顯示到畫面上
            CALL s_desc_get_acc_desc('2063',g_pmaa_m.pmaa293)
               RETURNING g_pmaa_m.pmaa293_desc
            DISPLAY BY NAME g_pmaa_m.pmaa293_desc
            NEXT FIELD pmaa293                          #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #----<<pmaa294>>----
         #Ctrlp:input.c.pmaa294
         ON ACTION controlp INFIELD pmaa294
            #add-point:ON ACTION controlp INFIELD pmaa294
            #此段落由子樣板a07產生
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_pmaa_m.pmaa294             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "2064" #

            CALL q_oocq002()                                #呼叫開窗

            LET g_pmaa_m.pmaa294 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_pmaa_m.pmaa294 TO pmaa294              #顯示到畫面上
            CALL s_desc_get_acc_desc('2064',g_pmaa_m.pmaa294)
               RETURNING g_pmaa_m.pmaa294_desc
            DISPLAY BY NAME g_pmaa_m.pmaa294_desc
            NEXT FIELD pmaa294                          #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #----<<pmaa295>>----
         #Ctrlp:input.c.pmaa295
         ON ACTION controlp INFIELD pmaa295
            #add-point:ON ACTION controlp INFIELD pmaa295
            #此段落由子樣板a07產生
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_pmaa_m.pmaa295             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "2065" #

            CALL q_oocq002()                                #呼叫開窗

            LET g_pmaa_m.pmaa295 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_pmaa_m.pmaa295 TO pmaa295              #顯示到畫面上
            CALL s_desc_get_acc_desc('2065',g_pmaa_m.pmaa295)
               RETURNING g_pmaa_m.pmaa295_desc
            DISPLAY BY NAME g_pmaa_m.pmaa295_desc
            NEXT FIELD pmaa295                          #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #----<<pmaa296>>----
         #Ctrlp:input.c.pmaa296
         ON ACTION controlp INFIELD pmaa296
            #add-point:ON ACTION controlp INFIELD pmaa296
            #此段落由子樣板a07產生
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_pmaa_m.pmaa296             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "2066" #

            CALL q_oocq002()                                #呼叫開窗

            LET g_pmaa_m.pmaa296 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_pmaa_m.pmaa296 TO pmaa296              #顯示到畫面上
            CALL s_desc_get_acc_desc('2066',g_pmaa_m.pmaa296)
               RETURNING g_pmaa_m.pmaa296_desc
            DISPLAY BY NAME g_pmaa_m.pmaa296_desc
            NEXT FIELD pmaa296                          #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #----<<pmaa297>>----
         #Ctrlp:input.c.pmaa297
         ON ACTION controlp INFIELD pmaa297
            #add-point:ON ACTION controlp INFIELD pmaa297
            #此段落由子樣板a07產生
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_pmaa_m.pmaa297             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "2067" #

            CALL q_oocq002()                                #呼叫開窗

            LET g_pmaa_m.pmaa297 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_pmaa_m.pmaa297 TO pmaa297              #顯示到畫面上
            CALL s_desc_get_acc_desc('2067',g_pmaa_m.pmaa297)
               RETURNING g_pmaa_m.pmaa297_desc
            DISPLAY BY NAME g_pmaa_m.pmaa297_desc
            NEXT FIELD pmaa297                          #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #----<<pmaa298>>----
         #Ctrlp:input.c.pmaa298
         ON ACTION controlp INFIELD pmaa298
            #add-point:ON ACTION controlp INFIELD pmaa298
            #此段落由子樣板a07產生
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_pmaa_m.pmaa298             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "2068" #

            CALL q_oocq002()                                #呼叫開窗

            LET g_pmaa_m.pmaa298 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_pmaa_m.pmaa298 TO pmaa298              #顯示到畫面上
            CALL s_desc_get_acc_desc('2068',g_pmaa_m.pmaa298)
               RETURNING g_pmaa_m.pmaa298_desc
            DISPLAY BY NAME g_pmaa_m.pmaa298_desc
            NEXT FIELD pmaa298                          #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #----<<pmaa299>>----
         #Ctrlp:input.c.pmaa299
         ON ACTION controlp INFIELD pmaa299
            #add-point:ON ACTION controlp INFIELD pmaa299
            #此段落由子樣板a07產生
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_pmaa_m.pmaa299             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "2069" #

            CALL q_oocq002()                                #呼叫開窗

            LET g_pmaa_m.pmaa299 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_pmaa_m.pmaa299 TO pmaa299              #顯示到畫面上
            CALL s_desc_get_acc_desc('2069',g_pmaa_m.pmaa299)
               RETURNING g_pmaa_m.pmaa299_desc
            DISPLAY BY NAME g_pmaa_m.pmaa299_desc
            NEXT FIELD pmaa299                          #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #----<<pmaa300>>----
         #Ctrlp:input.c.pmaa300
         ON ACTION controlp INFIELD pmaa300
            #add-point:ON ACTION controlp INFIELD pmaa300
            #此段落由子樣板a07產生
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_pmaa_m.pmaa300             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "2070" #

            CALL q_oocq002()                                #呼叫開窗

            LET g_pmaa_m.pmaa300 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_pmaa_m.pmaa300 TO pmaa300              #顯示到畫面上
            CALL s_desc_get_acc_desc('2070',g_pmaa_m.pmaa300)
               RETURNING g_pmaa_m.pmaa300_desc
            DISPLAY BY NAME g_pmaa_m.pmaa300_desc
            NEXT FIELD pmaa300                          #返回原欄位

          {#ADP版次:1#}
            #END add-point

 #欄位開窗

         AFTER INPUT
            IF INT_FLAG THEN
               EXIT DIALOG
            END IF

            CALL cl_showmsg()   #錯誤訊息統整顯示

            IF p_cmd <> "u" THEN
               LET l_count = 1

               SELECT COUNT(*) INTO l_count FROM pmaa_t
                WHERE pmaaent = g_enterprise AND pmaa001 = g_pmaa_m.pmaa001

               IF l_count = 0 THEN

                  #add-point:單頭新增前
                  CALL s_transaction_begin()
                  CALL s_aooi350_ins_oofa('3',g_pmaa_m.pmaa001,'') RETURNING l_success,g_pmaa_m.pmaa027
                  IF NOT l_success THEN
                     INITIALIZE g_errparam TO NULL
                     LET g_errparam.code = SQLCA.sqlcode
                     LET g_errparam.extend = "oofa_t"
                     LET g_errparam.popup = TRUE
                     CALL cl_err()

                     NEXT FIELD pmaa001
                  END IF          {#ADP版次:1#}
                  #end add-point

                  INSERT INTO pmaa_t (pmaaent,pmaa095,pmaa001,pmaa005,pmaa006,pmaa090,pmaa026,pmaa221,
                      pmaa232,pmaa200,pmaa201,pmaa027,pmaa004,pmaa241,pmaa242,pmaa243,pmaa244,pmaa002,
                      pmaa230,pmaastus,pmaaownid,
                      pmaaowndp,pmaacrtid,pmaacrtdp,pmaacrtdt,pmaamodid,pmaamoddt,pmaacnfid,pmaacnfdt,
                      pmaa017,pmaa016,pmaa018,pmaa019,pmaa021,pmaa022,pmaa020,pmaa291,pmaa292,pmaa293,
                      pmaa294,pmaa295,pmaa296,pmaa297,pmaa298,pmaa299,pmaa300)
                  VALUES (g_enterprise,g_pmaa_m.pmaa095,g_pmaa_m.pmaa001,g_pmaa_m.pmaa005,g_pmaa_m.pmaa006,
                      g_pmaa_m.pmaa090,g_pmaa_m.pmaa026,g_pmaa_m.pmaa221,g_pmaa_m.pmaa232,g_pmaa_m.pmaa200,
                      g_pmaa_m.pmaa201,g_pmaa_m.pmaa027,g_pmaa_m.pmaa004,g_pmaa_m.pmaa241,g_pmaa_m.pmaa242,
                      g_pmaa_m.pmaa243,g_pmaa_m.pmaa244,g_pmaa_m.pmaa002,g_pmaa_m.pmaa230,
                      g_pmaa_m.pmaastus,g_pmaa_m.pmaaownid,g_pmaa_m.pmaaowndp,g_pmaa_m.pmaacrtid,
                      g_pmaa_m.pmaacrtdp,g_pmaa_m.pmaacrtdt,g_pmaa_m.pmaamodid,g_pmaa_m.pmaamoddt,
                      g_pmaa_m.pmaacnfid,g_pmaa_m.pmaacnfdt,g_pmaa_m.pmaa017,g_pmaa_m.pmaa016,
                      g_pmaa_m.pmaa018,g_pmaa_m.pmaa019,g_pmaa_m.pmaa021,g_pmaa_m.pmaa022,g_pmaa_m.pmaa020,
                      g_pmaa_m.pmaa291,g_pmaa_m.pmaa292,g_pmaa_m.pmaa293,g_pmaa_m.pmaa294,g_pmaa_m.pmaa295,
                      g_pmaa_m.pmaa296,g_pmaa_m.pmaa297,g_pmaa_m.pmaa298,g_pmaa_m.pmaa299,g_pmaa_m.pmaa300)


                  #add-point:單頭新增中
                            {#ADP版次:1#}
                  #end add-point

                  IF SQLCA.sqlcode THEN
                     INITIALIZE g_errparam TO NULL
                     LET g_errparam.code = SQLCA.sqlcode
                     LET g_errparam.extend = "pmaa_t"
                     LET g_errparam.popup = TRUE
                     CALL cl_err()

                     CONTINUE DIALOG
                  END IF



                  #資料多語言用-增/改
                  INITIALIZE l_var_keys TO NULL
                  INITIALIZE l_field_keys TO NULL
                  INITIALIZE l_vars TO NULL
                  INITIALIZE l_fields TO NULL
                  IF g_pmaa_m.pmaa001 = g_master_multi_table_t.pmaal001 AND
                  g_pmaa_m.pmaal004 = g_master_multi_table_t.pmaal004 AND
                  g_pmaa_m.pmaal003 = g_master_multi_table_t.pmaal003 AND
                  g_pmaa_m.pmaal005 = g_master_multi_table_t.pmaal005  THEN
               ELSE
                  LET l_var_keys[01] = g_pmaa_m.pmaa001
                  LET l_field_keys[01] = 'pmaal001'
                  LET l_var_keys_bak[01] = g_master_multi_table_t.pmaal001
                  LET l_var_keys[02] = g_dlang
                  LET l_field_keys[02] = 'pmaal002'
                  LET l_var_keys_bak[02] = g_dlang
                  LET l_vars[01] = g_pmaa_m.pmaal004
                  LET l_fields[01] = 'pmaal004'
                  LET l_vars[02] = g_pmaa_m.pmaal003
                  LET l_fields[02] = 'pmaal003'
                  LET l_vars[03] = g_pmaa_m.pmaal005
                  LET l_fields[03] = 'pmaal005'
                  LET l_vars[04] = g_enterprise
                  LET l_fields[04] = 'pmaalent'
                  CALL cl_multitable(l_var_keys,l_field_keys,l_vars,l_fields,l_var_keys_bak,'pmaal_t')
               END IF


                  #add-point:單頭新增後

                  #更新ooff_t 備註
                  IF NOT cl_null(g_pmaa_m.pmaa001) THEN
                     IF NOT cl_null(g_pmaa_m.ooff013) THEN
                        LET l_success = ''
                        CALL s_aooi360_gen('2',g_pmaa_m.pmaa001,'','','','','','','','','','4',g_pmaa_m.ooff013) RETURNING l_success
                        IF NOT l_success THEN
                           INITIALIZE g_errparam TO NULL
                           LET g_errparam.code = SQLCA.sqlcode
                           LET g_errparam.extend = "ooff_t"
                           LET g_errparam.popup = TRUE
                           CALL cl_err()

                           CONTINUE DIALOG
                        END IF
                     ELSE
                        CALL s_aooi360_del('2',g_pmaa_m.pmaa001,'','','','','','','','','','4') RETURNING l_success
                        IF NOT l_success THEN
                           INITIALIZE g_errparam TO NULL
                           LET g_errparam.code = SQLCA.sqlcode
                           LET g_errparam.extend = "ooff_t"
                           LET g_errparam.popup = TRUE
                           CALL cl_err()

                           CONTINUE DIALOG
                        END IF
                     END IF
                  END IF
                  IF NOT cl_null(g_pmaa_m.pmaa027) THEN
                     LET g_pmaa027_d = g_pmaa_m.pmaa027
                     CALL aooi350_01_b_fill(g_pmaa027_d)
                     CALL aooi350_02_b_fill(g_pmaa027_d)
                  END IF
                  LET p_cmd = 'u'                  {#ADP版次:1#}
                  #end add-point

                  CALL s_transaction_end('Y','0')
               ELSE
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code =  "std-00006"
                  LET g_errparam.extend =  "g_pmaa_m.pmaa001"
                  LET g_errparam.popup = FALSE
                  CALL cl_err()

                  CALL s_transaction_end('N','0')
               END IF
            ELSE
               #add-point:單頭修改前
                         {#ADP版次:1#}
               #end add-point
               UPDATE pmaa_t SET (pmaa095,pmaa001,pmaa005,pmaa006,pmaa090,pmaa026,pmaa221,pmaa232,pmaa200,
                   pmaa201,pmaa027,pmaa004,pmaa241,pmaa242,pmaa243,pmaa244,pmaastus,pmaaownid,pmaaowndp,pmaacrtid,pmaacrtdp,pmaacrtdt,
                   pmaamodid,pmaamoddt,pmaacnfid,pmaacnfdt,pmaa017,pmaa016,pmaa018,pmaa019,pmaa021,pmaa022,
                   pmaa020,pmaa291,pmaa292,pmaa293,pmaa294,pmaa295,pmaa296,pmaa297,pmaa298,pmaa299,pmaa300) = (g_pmaa_m.pmaa095,
                   g_pmaa_m.pmaa001,g_pmaa_m.pmaa005,g_pmaa_m.pmaa006,g_pmaa_m.pmaa090,g_pmaa_m.pmaa026,
                   g_pmaa_m.pmaa221,g_pmaa_m.pmaa232,g_pmaa_m.pmaa200,g_pmaa_m.pmaa201,g_pmaa_m.pmaa027,
                   g_pmaa_m.pmaa004,g_pmaa_m.pmaa241,g_pmaa_m.pmaa242,g_pmaa_m.pmaa243,g_pmaa_m.pmaa244,
                   g_pmaa_m.pmaastus,g_pmaa_m.pmaaownid,g_pmaa_m.pmaaowndp,g_pmaa_m.pmaacrtid,
                   g_pmaa_m.pmaacrtdp,g_pmaa_m.pmaacrtdt,g_pmaa_m.pmaamodid,g_pmaa_m.pmaamoddt,g_pmaa_m.pmaacnfid,
                   g_pmaa_m.pmaacnfdt,g_pmaa_m.pmaa017,g_pmaa_m.pmaa016,g_pmaa_m.pmaa018,g_pmaa_m.pmaa019,
                   g_pmaa_m.pmaa021,g_pmaa_m.pmaa022,g_pmaa_m.pmaa020,g_pmaa_m.pmaa291,g_pmaa_m.pmaa292,
                   g_pmaa_m.pmaa293,g_pmaa_m.pmaa294,g_pmaa_m.pmaa295,g_pmaa_m.pmaa296,g_pmaa_m.pmaa297,
                   g_pmaa_m.pmaa298,g_pmaa_m.pmaa299,g_pmaa_m.pmaa300)
                WHERE pmaaent = g_enterprise AND pmaa001 = g_pmaa001_t #

               #add-point:單頭修改中
                         {#ADP版次:1#}
               #end add-point
               CASE
                  WHEN SQLCA.sqlerrd[3] = 0  #更新不到的處理
                     INITIALIZE g_errparam TO NULL
                     LET g_errparam.code = "std-00009"
                     LET g_errparam.extend = "pmaa_t"
                     LET g_errparam.popup = TRUE
                     CALL cl_err()

                     CALL s_transaction_end('N','0')
                  WHEN SQLCA.sqlcode #其他錯誤
                     INITIALIZE g_errparam TO NULL
                     LET g_errparam.code = SQLCA.sqlcode
                     LET g_errparam.extend = "pmaa_t"
                     LET g_errparam.popup = TRUE
                     CALL cl_err()

                     CALL s_transaction_end('N','0')
                  OTHERWISE

                     #資料多語言用-增/改
                              INITIALIZE l_var_keys TO NULL
         INITIALIZE l_field_keys TO NULL
         INITIALIZE l_vars TO NULL
         INITIALIZE l_fields TO NULL
         IF g_pmaa_m.pmaa001 = g_master_multi_table_t.pmaal001 AND
         g_pmaa_m.pmaal004 = g_master_multi_table_t.pmaal004 AND
         g_pmaa_m.pmaal003 = g_master_multi_table_t.pmaal003 AND
         g_pmaa_m.pmaal005 = g_master_multi_table_t.pmaal005  THEN
         ELSE
            LET l_var_keys[01] = g_pmaa_m.pmaa001
            LET l_field_keys[01] = 'pmaal001'
            LET l_var_keys_bak[01] = g_master_multi_table_t.pmaal001
            LET l_var_keys[02] = g_dlang
            LET l_field_keys[02] = 'pmaal002'
            LET l_var_keys_bak[02] = g_dlang
            LET l_vars[01] = g_pmaa_m.pmaal004
            LET l_fields[01] = 'pmaal004'
            LET l_vars[02] = g_pmaa_m.pmaal003
            LET l_fields[02] = 'pmaal003'
            LET l_vars[03] = g_pmaa_m.pmaal005
            LET l_fields[03] = 'pmaal005'
            LET l_vars[04] = g_enterprise
            LET l_fields[04] = 'pmaalent'
            CALL cl_multitable(l_var_keys,l_field_keys,l_vars,l_fields,l_var_keys_bak,'pmaal_t')
         END IF

                     #add-point:單頭修改後
                     #更新ooff_t 備註
                     IF NOT cl_null(g_pmaa_m.pmaa001) THEN
                        IF NOT cl_null(g_pmaa_m.ooff013) THEN
                           LET l_success = ''
                           CALL s_aooi360_gen('2',g_pmaa_m.pmaa001,'','','','','','','','','','4',g_pmaa_m.ooff013) RETURNING l_success
                           IF NOT l_success THEN
                              INITIALIZE g_errparam TO NULL
                              LET g_errparam.code = SQLCA.sqlcode
                              LET g_errparam.extend = "ooff_t"
                              LET g_errparam.popup = TRUE
                              CALL cl_err()
                              CALL s_transaction_end('N','0')
                              CONTINUE DIALOG
                           END IF
                        ELSE
                           CALL s_aooi360_del('2',g_pmaa_m.pmaa001,'','','','','','','','','','4') RETURNING l_success
                           IF NOT l_success THEN
                              INITIALIZE g_errparam TO NULL
                              LET g_errparam.code = SQLCA.sqlcode
                              LET g_errparam.extend = "ooff_t"
                              LET g_errparam.popup = TRUE
                              CALL cl_err()
                              CALL s_transaction_end('N','0')
                              CONTINUE DIALOG
                           END IF
                        END IF
                     END IF
                     IF NOT cl_null(g_pmaa_m.pmaa027) THEN
                        LET g_pmaa027_d = g_pmaa_m.pmaa027
                        CALL aooi350_01_b_fill(g_pmaa027_d)
                        CALL aooi350_02_b_fill(g_pmaa027_d)
                     END IF                     {#ADP版次:1#}
                     #end add-point
                     CALL s_transaction_end('Y','0')
               END CASE
            END IF
            LET g_pmaa001_t = g_pmaa_m.pmaa001
           #controlp
      END INPUT

      #add-point:input段more input
      SUBDIALOG aoo_aooi350_01.aooi350_01_input
      SUBDIALOG aoo_aooi350_02.aooi350_02_input
      
      BEFORE DIALOG
         #為了修改功能doubleClick可以直接進入單身,需指定要進入哪一個單身
         IF NOT cl_null(p_cmd) AND p_cmd != 'a' THEN
            CASE g_aw
               WHEN "s_detail1_aooi350_01"
                  NEXT FIELD oofbstus
               WHEN "s_detail1_aooi350_02"
                  NEXT FIELD oofcstus
               OTHERWISE
                  NEXT FIELD pmaa095
            END CASE
         END IF

         IF p_cmd = 'a' THEN
            NEXT FIELD pmaa095
         END IF
      {#ADP版次:1#}
      #end add-point

      ON ACTION controlf
         CALL cl_set_focus_form(ui.Interface.getRootNode()) RETURNING g_fld_name,g_frm_name
         CALL cl_fldhelp(g_frm_name, g_fld_name, g_lang)

      ON ACTION controlr
         CALL cl_show_req_fields()

      ON ACTION controls
         CALL cl_set_head_visible("","AUTO")

      ON ACTION accept
         ACCEPT DIALOG

      ON ACTION cancel      #在dialog button (放棄)
         LET g_action_choice=""
         LET INT_FLAG = TRUE
         EXIT DIALOG

      ON ACTION close       #在dialog 右上角 (X)
         LET INT_FLAG = TRUE
         EXIT DIALOG

      ON ACTION exit        #toolbar 離開
         LET INT_FLAG = TRUE
         EXIT DIALOG

      #交談指令共用ACTION
      &include "common_action.4gl"
         CONTINUE DIALOG
   END DIALOG

   #add-point:input段after input
             {#ADP版次:1#}
   #end add-point

END FUNCTION]]>
  </point>
  <point name="function.adbm201_reproduce" order="12" ver="3" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adbm201_reproduce()
   {<Local define>}
   DEFINE l_newno     LIKE pmaa_t.pmaa001
   DEFINE l_oldno     LIKE pmaa_t.pmaa001

   DEFINE l_master    RECORD LIKE pmaa_t.*
   DEFINE l_cnt       LIKE type_t.num5
   {</Local define>}

   #add-point:reproduce段define
             {#ADP版次:1#}
   #end add-point

   #切換畫面
   IF g_main_hidden THEN
      CALL gfrm_curr.setElementHidden("mainlayout",0)
      CALL gfrm_curr.setElementHidden("worksheet",1)
      LET g_main_hidden = 0
   END IF

   IF g_pmaa_m.pmaa001 IS NULL

   THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = "std-00003"
      LET g_errparam.extend = ""
      LET g_errparam.popup = FALSE
      CALL cl_err()

      RETURN
   END IF

   LET g_pmaa001_t = g_pmaa_m.pmaa001


   LET g_pmaa_m.pmaa001 = ""


   CALL adbm201_set_entry("a")
   CALL adbm201_set_no_entry("a")

   #公用欄位給予預設值
   #此段落由子樣板a14產生
      LET g_pmaa_m.pmaaownid = g_user
      LET g_pmaa_m.pmaaowndp = g_dept
      LET g_pmaa_m.pmaacrtid = g_user
      LET g_pmaa_m.pmaacrtdp = g_dept
      LET g_pmaa_m.pmaacrtdt = cl_get_current()
      LET g_pmaa_m.pmaamodid = ""
      LET g_pmaa_m.pmaamoddt = ""
      #LET g_pmaa_m.pmaastus = ""



   #add-point:複製輸入前
   LET g_pmaa_m.pmaacnfid = ""
   LET g_pmaa_m.pmaacnfdt = ""
   LET g_pmaa_m.pmaa095 = g_site
   LET g_pmaa_m.pmaastus = 'N'
   LET g_pmaa_m.pmaacnfid = ''
   LET g_pmaa_m.pmaacnfdt = ''
   LET g_pmaa_m.pmaa002 = '2'
   LET g_pmaa_m.pmaa230 = '2'
   LET g_pmaa_m_t.* = g_pmaa_m.*
   LET g_pmaa_m_o.* = g_pmaa_m.*
   #把單身的資料清掉
   LET g_pmaa_m.pmaa027 = ''
   LET g_pmaa027_d = ''
   CALL aooi350_01_clear_detail()
   CALL aooi350_02_clear_detail(){#ADP版次:1#}
   #end add-point

   CALL adbm201_input("r")



   IF INT_FLAG  THEN
      LET INT_FLAG = 0
      RETURN
   END IF

   CALL s_transaction_begin()

   #add-point:單頭複製前
             {#ADP版次:1#}
   #end add-point

   #add-point:單頭複製中
             {#ADP版次:1#}
   #end add-point

   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "pmaa_t"
      LET g_errparam.popup = TRUE
      CALL cl_err()

      CALL s_transaction_end('N','0')
      RETURN
   END IF

   #add-point:單頭複製後
             {#ADP版次:1#}
   #end add-point

   CALL s_transaction_end('Y','0')

   LET g_state = "Y"

   LET g_wc = g_wc,
              " OR (",
              " pmaa001 = '", g_pmaa_m.pmaa001 CLIPPED, "' "

              , ") "

   LET g_pmaa001_t = g_pmaa_m.pmaa001


   #add-point:完成複製段落後
             {#ADP版次:1#}
   #end add-point

END FUNCTION]]>
  </point>
  <point name="function.adbm201_show" order="13" ver="6" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adbm201_show()
   #add-point:show段define
   DEFINE l_ac_t   LIKE type_t.num5
   {#ADP版次:1#}
   #end add-point

   #add-point:show段之前
   LET g_pmaa_m.ooff013 = ''
   SELECT ooff013 INTO g_pmaa_m.ooff013
     FROM ooff_t
    WHERE ooffent = g_enterprise
      AND ooff001 = '2'
      AND ooff002 = g_pmaa_m.pmaa001
      AND ooff012 = '4'
   DISPLAY BY NAME g_pmaa_m.ooff013          {#ADP版次:1#}
   #end add-point



   LET g_pmaa_m_t.* = g_pmaa_m.*      #保存單頭舊值

   #在browser 移動上下筆可以連動切換資料
   CALL cl_show_fld_cont()

   #帶出公用欄位reference值
   #此段落由子樣板a12產生
      #LET g_pmaa_m.pmaaownid_desc = cl_get_username(g_pmaa_m.pmaaownid)
      #LET g_pmaa_m.pmaaowndp_desc = cl_get_deptname(g_pmaa_m.pmaaowndp)
      #LET g_pmaa_m.pmaacrtid_desc = cl_get_username(g_pmaa_m.pmaacrtid)
      #LET g_pmaa_m.pmaacrtdp_desc = cl_get_deptname(g_pmaa_m.pmaacrtdp)
      #LET g_pmaa_m.pmaamodid_desc = cl_get_username(g_pmaa_m.pmaamodid)
      #LET g_pmaa_m.pmaacnfid_desc = cl_get_deptname(g_pmaa_m.pmaacnfid)
      ##LET g_pmaa_m.pmaapstid_desc = cl_get_deptname(g_pmaa_m.pmaapstid)




   #讀入ref值(單頭)
   #add-point:show段reference
   LET l_ac_t = l_ac
   
   CALL s_desc_get_department_desc(g_pmaa_m.pmaa095)
      RETURNING g_pmaa_m.pmaa095_desc
   DISPLAY BY NAME g_pmaa_m.pmaa095_desc
   CALL adbm201_pmaa001_ref()
   CALL s_desc_get_oojdl003_desc(g_pmaa_m.pmaa221)
      RETURNING g_pmaa_m.pmaa221_desc
   DISPLAY BY NAME g_pmaa_m.pmaa221_desc
   CALL s_desc_get_acc_desc('2072',g_pmaa_m.pmaa232)
      RETURNING g_pmaa_m.pmaa232_desc
   DISPLAY BY NAME g_pmaa_m.pmaa232_desc
   CALL s_desc_get_trading_partner_abbr_desc(g_pmaa_m.pmaa005)
      RETURNING g_pmaa_m.pmaa005_desc
   DISPLAY BY NAME g_pmaa_m.pmaa005_desc
   CALL s_desc_get_trading_partner_abbr_desc(g_pmaa_m.pmaa006)
      RETURNING g_pmaa_m.pmaa006_desc
   DISPLAY BY NAME g_pmaa_m.pmaa006_desc
   CALL s_desc_get_acc_desc('281',g_pmaa_m.pmaa090)
      RETURNING g_pmaa_m.pmaa090_desc
   DISPLAY BY NAME g_pmaa_m.pmaa090_desc
   CALL s_desc_get_acc_desc('250',g_pmaa_m.pmaa026)
      RETURNING g_pmaa_m.pmaa026_desc
   DISPLAY BY NAME g_pmaa_m.pmaa026_desc
   CALL s_desc_get_currency_desc(g_pmaa_m.pmaa019)
      RETURNING g_pmaa_m.pmaa019_desc
   DISPLAY BY NAME g_pmaa_m.pmaa019_desc
   CALL s_desc_get_currency_desc(g_pmaa_m.pmaa022)
      RETURNING g_pmaa_m.pmaa022_desc
   DISPLAY BY NAME g_pmaa_m.pmaa022_desc
   CALL s_desc_get_acc_desc('2061',g_pmaa_m.pmaa291)
      RETURNING g_pmaa_m.pmaa291_desc
   DISPLAY BY NAME g_pmaa_m.pmaa291_desc
   CALL s_desc_get_acc_desc('2062',g_pmaa_m.pmaa292)
      RETURNING g_pmaa_m.pmaa292_desc
   DISPLAY BY NAME g_pmaa_m.pmaa292_desc
   CALL s_desc_get_acc_desc('2063',g_pmaa_m.pmaa293)
      RETURNING g_pmaa_m.pmaa293_desc
   DISPLAY BY NAME g_pmaa_m.pmaa293_desc
   CALL s_desc_get_acc_desc('2064',g_pmaa_m.pmaa294)
      RETURNING g_pmaa_m.pmaa294_desc
   DISPLAY BY NAME g_pmaa_m.pmaa294_desc
   CALL s_desc_get_acc_desc('2065',g_pmaa_m.pmaa295)
      RETURNING g_pmaa_m.pmaa295_desc
   DISPLAY BY NAME g_pmaa_m.pmaa295_desc
   CALL s_desc_get_acc_desc('2066',g_pmaa_m.pmaa296)
      RETURNING g_pmaa_m.pmaa296_desc
   DISPLAY BY NAME g_pmaa_m.pmaa296_desc
   CALL s_desc_get_acc_desc('2067',g_pmaa_m.pmaa297)
      RETURNING g_pmaa_m.pmaa297_desc
   DISPLAY BY NAME g_pmaa_m.pmaa297_desc
   CALL s_desc_get_acc_desc('2068',g_pmaa_m.pmaa298)
      RETURNING g_pmaa_m.pmaa298_desc
   DISPLAY BY NAME g_pmaa_m.pmaa298_desc
   CALL s_desc_get_acc_desc('2069',g_pmaa_m.pmaa299)
      RETURNING g_pmaa_m.pmaa299_desc
   DISPLAY BY NAME g_pmaa_m.pmaa299_desc
   CALL s_desc_get_acc_desc('2070',g_pmaa_m.pmaa300)
      RETURNING g_pmaa_m.pmaa300_desc
   DISPLAY BY NAME g_pmaa_m.pmaa300_desc

   CALL s_desc_get_dbaa001_desc(g_pmaa_m.pmaa241)
      RETURNING g_pmaa_m.pmaa241_desc
   DISPLAY BY NAME g_pmaa_m.pmaa241_desc
   CALL s_desc_get_dbaa001_desc(g_pmaa_m.pmaa242)
      RETURNING g_pmaa_m.pmaa242_desc
   DISPLAY BY NAME g_pmaa_m.pmaa242_desc
   CALL s_desc_get_dbaa001_desc(g_pmaa_m.pmaa243)
      RETURNING g_pmaa_m.pmaa243_desc
   DISPLAY BY NAME g_pmaa_m.pmaa243_desc
   CALL s_desc_get_dbaa001_desc(g_pmaa_m.pmaa244)
      RETURNING g_pmaa_m.pmaa244_desc
   DISPLAY BY NAME g_pmaa_m.pmaa244_desc

   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmaa_m.pmaaownid
   CALL ap_ref_array2(g_ref_fields,"SELECT ooag011 FROM ooag_t WHERE ooagent='"||g_enterprise||"' AND ooag001=? ","") RETURNING g_rtn_fields
   LET g_pmaa_m.pmaaownid_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_pmaa_m.pmaaownid_desc

   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmaa_m.pmaaowndp
   CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_pmaa_m.pmaaowndp_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_pmaa_m.pmaaowndp_desc

   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmaa_m.pmaacrtid
   CALL ap_ref_array2(g_ref_fields,"SELECT ooag011 FROM ooag_t WHERE ooagent='"||g_enterprise||"' AND ooag001=? ","") RETURNING g_rtn_fields
   LET g_pmaa_m.pmaacrtid_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_pmaa_m.pmaacrtid_desc

   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmaa_m.pmaacrtdp
   CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_pmaa_m.pmaacrtdp_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_pmaa_m.pmaacrtdp_desc

   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmaa_m.pmaamodid
   CALL ap_ref_array2(g_ref_fields,"SELECT ooag011 FROM ooag_t WHERE ooagent='"||g_enterprise||"' AND ooag001=? ","") RETURNING g_rtn_fields
   LET g_pmaa_m.pmaamodid_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_pmaa_m.pmaamodid_desc

   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmaa_m.pmaacnfid
   CALL ap_ref_array2(g_ref_fields,"SELECT ooag011 FROM ooag_t WHERE ooagent='"||g_enterprise||"' AND ooag001=? ","") RETURNING g_rtn_fields
   LET g_pmaa_m.pmaacnfid_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_pmaa_m.pmaacnfid_desc
          {#ADP版次:1#}
   #end add-point

   #將資料輸出到畫面上
   DISPLAY BY NAME g_pmaa_m.pmaa095,g_pmaa_m.pmaa095_desc,g_pmaa_m.pmaa001,g_pmaa_m.pmaal004,g_pmaa_m.pmaal003,
       g_pmaa_m.pmaal005,g_pmaa_m.pmaa005,g_pmaa_m.pmaa005_desc,g_pmaa_m.pmaa006,g_pmaa_m.pmaa006_desc,
       g_pmaa_m.pmaa090,g_pmaa_m.pmaa090_desc,g_pmaa_m.pmaa026,g_pmaa_m.pmaa026_desc,g_pmaa_m.pmaa221,
       g_pmaa_m.pmaa221_desc,g_pmaa_m.pmaa232,g_pmaa_m.pmaa232_desc,g_pmaa_m.pmaa200,g_pmaa_m.pmaa201,
       g_pmaa_m.pmaa027,g_pmaa_m.pmaa004,g_pmaa_m.pmaa241,g_pmaa_m.pmaa241_desc,g_pmaa_m.pmaa242,g_pmaa_m.pmaa242_desc,
       g_pmaa_m.pmaa243,g_pmaa_m.pmaa243_desc,g_pmaa_m.pmaa244,g_pmaa_m.pmaa244_desc,g_pmaa_m.pmaastus,g_pmaa_m.pmaaownid,g_pmaa_m.pmaaownid_desc,
       g_pmaa_m.pmaaowndp,g_pmaa_m.pmaaowndp_desc,g_pmaa_m.pmaacrtid,g_pmaa_m.pmaacrtid_desc,g_pmaa_m.pmaacrtdp,
       g_pmaa_m.pmaacrtdp_desc,g_pmaa_m.pmaacrtdt,g_pmaa_m.pmaamodid,g_pmaa_m.pmaamodid_desc,g_pmaa_m.pmaamoddt,
       g_pmaa_m.pmaacnfid,g_pmaa_m.pmaacnfid_desc,g_pmaa_m.pmaacnfdt,g_pmaa_m.pmaa017,g_pmaa_m.pmaa016,
       g_pmaa_m.pmaa018,g_pmaa_m.pmaa019,g_pmaa_m.pmaa019_desc,g_pmaa_m.pmaa021,g_pmaa_m.pmaa022,g_pmaa_m.pmaa022_desc,
       g_pmaa_m.pmaa020,g_pmaa_m.ooff013,g_pmaa_m.pmaa291,g_pmaa_m.pmaa291_desc,g_pmaa_m.pmaa292,g_pmaa_m.pmaa292_desc,
       g_pmaa_m.pmaa293,g_pmaa_m.pmaa293_desc,g_pmaa_m.pmaa294,g_pmaa_m.pmaa294_desc,g_pmaa_m.pmaa295,
       g_pmaa_m.pmaa295_desc,g_pmaa_m.pmaa296,g_pmaa_m.pmaa296_desc,g_pmaa_m.pmaa297,g_pmaa_m.pmaa297_desc,
       g_pmaa_m.pmaa298,g_pmaa_m.pmaa298_desc,g_pmaa_m.pmaa299,g_pmaa_m.pmaa299_desc,g_pmaa_m.pmaa300,
       g_pmaa_m.pmaa300_desc

   #顯示狀態(stus)圖片
         #此段落由子樣板a21產生
      CASE g_pmaa_m.pmaastus
         WHEN "N"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/open.png")
         WHEN "X"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/void.png")

         WHEN "Y"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/valid.png")



      END CASE



   #add-point:show段之後
   IF NOT cl_null(g_pmaa_m.pmaa027) THEN
      LET g_pmaa027_d = g_pmaa_m.pmaa027
      CALL aooi350_01_b_fill(g_pmaa027_d)
      CALL aooi350_02_b_fill(g_pmaa027_d)
   END IF
   LET l_ac = l_ac_t   {#ADP版次:1#}
   #end add-point

END FUNCTION]]>
  </point>
  <point name="function.adbm201_delete" order="14" ver="6" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adbm201_delete()
   {<Local define>}
   DEFINE  l_var_keys      DYNAMIC ARRAY OF STRING
   DEFINE  l_field_keys    DYNAMIC ARRAY OF STRING
   DEFINE  l_vars          DYNAMIC ARRAY OF STRING
   DEFINE  l_fields        DYNAMIC ARRAY OF STRING
   DEFINE  l_var_keys_bak  DYNAMIC ARRAY OF STRING
   {</Local define>}
   #add-point:delete段define
      DEFINE  l_success       LIKE type_t.chr1          {#ADP版次:1#}
   #end add-point

   IF g_pmaa_m.pmaa001 IS NULL

   THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = "std-00003"
      LET g_errparam.extend = ""
      LET g_errparam.popup = FALSE
      CALL cl_err()

      RETURN
   END IF

   CALL adbm201_show()

   CALL s_transaction_begin()

   LET g_pmaa001_t = g_pmaa_m.pmaa001


   LET g_master_multi_table_t.pmaal001 = g_pmaa_m.pmaa001
LET g_master_multi_table_t.pmaal004 = g_pmaa_m.pmaal004
LET g_master_multi_table_t.pmaal003 = g_pmaa_m.pmaal003
LET g_master_multi_table_t.pmaal005 = g_pmaa_m.pmaal005


   OPEN adbm201_cl USING g_enterprise,
                           g_pmaa_m.pmaa001

   IF STATUS THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code =  STATUS
      LET g_errparam.extend = "OPEN adbm201_cl:"
      LET g_errparam.popup = FALSE
      CALL cl_err()

      CLOSE adbm201_cl
      CALL s_transaction_end('N','0')
      RETURN
   END IF

   FETCH adbm201_cl INTO g_pmaa_m.pmaa095,g_pmaa_m.pmaa095_desc,g_pmaa_m.pmaa001,g_pmaa_m.pmaal004,g_pmaa_m.pmaal003,
       g_pmaa_m.pmaal005,g_pmaa_m.pmaa005,g_pmaa_m.pmaa005_desc,g_pmaa_m.pmaa006,g_pmaa_m.pmaa006_desc,
       g_pmaa_m.pmaa090,g_pmaa_m.pmaa090_desc,g_pmaa_m.pmaa026,g_pmaa_m.pmaa026_desc,g_pmaa_m.pmaa221,
       g_pmaa_m.pmaa221_desc,g_pmaa_m.pmaa232,g_pmaa_m.pmaa232_desc,g_pmaa_m.pmaa200,g_pmaa_m.pmaa201,
       g_pmaa_m.pmaa027,g_pmaa_m.pmaa004,g_pmaa_m.pmaa241,g_pmaa_m.pmaa241_desc,g_pmaa_m.pmaa242,g_pmaa_m.pmaa242_desc,
       g_pmaa_m.pmaa243,g_pmaa_m.pmaa243_desc,g_pmaa_m.pmaa244,g_pmaa_m.pmaa244_desc,g_pmaa_m.pmaastus,g_pmaa_m.pmaaownid,g_pmaa_m.pmaaownid_desc,
       g_pmaa_m.pmaaowndp,g_pmaa_m.pmaaowndp_desc,g_pmaa_m.pmaacrtid,g_pmaa_m.pmaacrtid_desc,g_pmaa_m.pmaacrtdp,
       g_pmaa_m.pmaacrtdp_desc,g_pmaa_m.pmaacrtdt,g_pmaa_m.pmaamodid,g_pmaa_m.pmaamodid_desc,g_pmaa_m.pmaamoddt,
       g_pmaa_m.pmaacnfid,g_pmaa_m.pmaacnfid_desc,g_pmaa_m.pmaacnfdt,g_pmaa_m.pmaa017,g_pmaa_m.pmaa016,
       g_pmaa_m.pmaa018,g_pmaa_m.pmaa019,g_pmaa_m.pmaa019_desc,g_pmaa_m.pmaa021,g_pmaa_m.pmaa022,g_pmaa_m.pmaa022_desc,
       g_pmaa_m.pmaa020,g_pmaa_m.ooff013,g_pmaa_m.pmaa291,g_pmaa_m.pmaa291_desc,g_pmaa_m.pmaa292,g_pmaa_m.pmaa292_desc,
       g_pmaa_m.pmaa293,g_pmaa_m.pmaa293_desc,g_pmaa_m.pmaa294,g_pmaa_m.pmaa294_desc,g_pmaa_m.pmaa295,
       g_pmaa_m.pmaa295_desc,g_pmaa_m.pmaa296,g_pmaa_m.pmaa296_desc,g_pmaa_m.pmaa297,g_pmaa_m.pmaa297_desc,
       g_pmaa_m.pmaa298,g_pmaa_m.pmaa298_desc,g_pmaa_m.pmaa299,g_pmaa_m.pmaa299_desc,g_pmaa_m.pmaa300,
       g_pmaa_m.pmaa300_desc
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = g_pmaa_m.pmaa001
      LET g_errparam.popup = FALSE
      CALL cl_err()

      RETURN
   END IF

   IF cl_ask_del_master() THEN
      INITIALIZE g_doc.* TO NULL
      LET g_doc.column1 = "pmaa001"
      LET g_doc.value1 = g_pmaa_m.pmaa001
      CALL cl_doc_remove()  

      #add-point:單頭刪除前
          {#ADP版次:1#}
      #end add-point

      DELETE FROM pmaa_t
       WHERE pmaaent = g_enterprise AND pmaa001 = g_pmaa_m.pmaa001


      #add-point:單頭刪除中
                {#ADP版次:1#}
      #end add-point

      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "pmaa_t"
         LET g_errparam.popup = FALSE
         CALL cl_err()

         CALL s_transaction_end('N','0')
      END IF

      INITIALIZE l_var_keys_bak TO NULL
   INITIALIZE l_field_keys   TO NULL
   LET l_var_keys_bak[01] = g_master_multi_table_t.pmaal001
   LET l_field_keys[01] = 'pmaal001'
   LET l_var_keys_bak[02] = g_dlang
   LET l_field_keys[02] = 'pmaal002'
   CALL cl_multitable_delete(l_field_keys,l_var_keys_bak,'pmaal_t')


      #add-point:單頭刪除後
      DELETE FROM pmaal_t
       WHERE pmaalent = g_enterprise AND pmaal001 = g_pmaa_m.pmaa001

      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = 'del pmaal_t'
         LET g_errparam.popup = FALSE
         CALL cl_err()

         CALL s_transaction_end('N','0')
         RETURN
      END IF

      #刪除ooff_t備註
      LET l_success = ''
      CALL s_aooi360_del('2',g_pmaa_m.pmaa001,'','','','','','','','','','4') RETURNING l_success
      IF NOT l_success THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "ooff_t"
         LET g_errparam.popup = FALSE
         CALL cl_err()

         CALL s_transaction_end('N','0')
         RETURN
      END IF

      IF NOT cl_null(g_pmaa_m.pmaa027) THEN
         IF NOT s_aooi350_del(g_pmaa_m.pmaa027) THEN
            INITIALIZE g_errparam TO NULL
            LET g_errparam.code = SQLCA.sqlcode
            LET g_errparam.extend = "del oofa_t"
            LET g_errparam.popup = FALSE
            CALL cl_err()

            CALL s_transaction_end('N','0')
            RETURN
         END IF
      END IF           {#ADP版次:1#}
      #end add-point



      CLEAR FORM
      CALL adbm201_ui_browser_refresh()
      IF g_browser_cnt > 0 THEN
         CALL adbm201_fetch("P")
      ELSE
         CALL adbm201_browser_fill(" 1=1 ","F")
      END IF

   END IF

   CLOSE adbm201_cl
   CALL s_transaction_end('Y','0')

   #流程通知預埋點-D
   CALL cl_flow_notify(g_pmaa_m.pmaa001,"D")

END FUNCTION]]>
  </point>
  <point name="function.adbm201_ui_browser_refresh" order="15" ver="1" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adbm201_ui_browser_refresh()
   {<Local define>}
   DEFINE l_i  LIKE type_t.num10
   {</Local define>}

   #add-point:ui_browser_refresh段define
             {#ADP版次:1#}
   #end add-point

   FOR l_i =1 TO g_browser.getLength()
      IF g_browser[l_i].b_pmaa001 = g_pmaa_m.pmaa001 THEN
         CALL g_browser.deleteElement(l_i)
         LET g_header_cnt = g_header_cnt - 1
       END IF
   END FOR

   DISPLAY g_header_cnt TO FORMONLY.b_count     #page count
   DISPLAY g_header_cnt TO FORMONLY.h_count     #page count
   LET g_browser_cnt = g_browser_cnt-1
   IF g_current_idx > g_browser_cnt THEN        #確定browse 筆數指在同一筆
      LET g_current_idx = g_browser_cnt
   END IF

END FUNCTION]]>
  </point>
  <point name="function.adbm201_set_entry" order="16" ver="1" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adbm201_set_entry(p_cmd)
   {<Local define>}
   DEFINE p_cmd LIKE type_t.chr1
   {</Local define>}
   #add-point:set_entry段define
             {#ADP版次:1#}
   #end add-point

   IF p_cmd = "a" THEN
      CALL cl_set_comp_entry("pmaa001",TRUE)
      #add-point:set_entry段欄位控制
            CALL cl_set_comp_entry("pmaa095",TRUE)          {#ADP版次:1#}
      #end add-point
   END IF

   #add-point:set_entry段欄位控制後
             {#ADP版次:1#}
   #end add-point

END FUNCTION]]>
  </point>
  <point name="function.adbm201_set_no_entry" order="17" ver="6" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adbm201_set_no_entry(p_cmd)
   {<Local define>}
   DEFINE p_cmd LIKE type_t.chr1
   {</Local define>}
   #add-point:set_no_entry段define
             {#ADP版次:1#}
   #end add-point

   IF p_cmd = "u" THEN
      CALL cl_set_comp_entry("pmaa001",FALSE)
      #add-point:set_no_entry段欄位控制
       {#ADP版次:1#}
      #end add-point
   END IF

   #add-point:set_no_entry段欄位控制後
   IF NOT s_aooi500_comp_entry(g_prog,'pmaaunit') THEN
      CALL cl_set_comp_entry("pmaa095",FALSE)
   END IF          {#ADP版次:1#}
   #end add-point

END FUNCTION]]>
  </point>
  <point name="function.adbm201_default_search" order="18" ver="1" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adbm201_default_search()
   {<Local define>}
   DEFINE li_idx  LIKE type_t.num5
   DEFINE li_cnt  LIKE type_t.num5
   DEFINE ls_wc   STRING
   {</Local define>}
   #add-point:default_search段define
             {#ADP版次:1#}
   #end add-point

   #add-point:default_search段開始前
             {#ADP版次:1#}
   #end add-point

   LET g_pagestart = 1
   IF cl_null(g_order) THEN
      LET g_order = "ASC"
   END IF
   IF NOT cl_null(g_argv[1]) THEN
      LET ls_wc = ls_wc, " pmaa001 = '", g_argv[1], "' AND "
   END IF



   IF NOT cl_null(ls_wc) THEN
      LET g_wc = ls_wc.subString(1,ls_wc.getLength()-5)
   ELSE
      IF cl_null(g_wc) THEN
         LET g_wc = " 1=1"
      END IF
   END IF

   #add-point:default_search段結束前
             {#ADP版次:1#}
   #end add-point

END FUNCTION]]>
  </point>
  <point name="function.adbm201_statechange" order="19" ver="1" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adbm201_statechange()
   {<Local define>}
   DEFINE lc_state LIKE type_t.chr5
   {</Local define>}
   #add-point:statechange段define
      DEFINE l_success   LIKE type_t.num5          {#ADP版次:1#}
   #end add-point

   #add-point:statechange段開始前
        {#ADP版次:1#}
   #end add-point

   ERROR ""     #清空畫面右下側ERROR區塊

   IF g_pmaa_m.pmaa001 IS NULL

   THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = "std-00003"
      LET g_errparam.extend = ""
      LET g_errparam.popup = FALSE
      CALL cl_err()

      RETURN
   END IF

   MENU "" ATTRIBUTES (STYLE="popup")
      BEFORE MENU
         CASE g_pmaa_m.pmaastus
            WHEN "N"
               HIDE OPTION "open"
            WHEN "X"
               HIDE OPTION "void"

            WHEN "Y"
               HIDE OPTION "valid"



         END CASE

      #add-point:menu前
      CALL cl_set_act_visible("open,valid,void",TRUE)
      CASE g_pmaa_m.pmaastus
         WHEN "N"
            CALL cl_set_act_visible("open",FALSE)

         WHEN "X"
            CALL cl_set_act_visible("valid,void",FALSE)

         WHEN "Y"
            CALL cl_set_act_visible("valid,void",FALSE)
      END CASE          {#ADP版次:1#}
      #end add-point

      ON ACTION open
         LET lc_state = "N"
         #add-point:action控制
                   {#ADP版次:1#}
         #end add-point
         EXIT MENU
      ON ACTION void
         LET lc_state = "X"
         #add-point:action控制
                   {#ADP版次:1#}
         #end add-point
         EXIT MENU

      ON ACTION valid
         LET lc_state = "Y"
         #add-point:action控制
                   {#ADP版次:1#}
         #end add-point
         EXIT MENU





      #add-point:stus控制
                {#ADP版次:1#}
      #end add-point

   END MENU

   IF (lc_state <> "N"
      AND lc_state <> "X"

      AND lc_state <> "Y"


      ) OR
      cl_null(lc_state) THEN
      RETURN
   END IF

   #add-point:stus修改前
   CALL s_transaction_begin()
   LET l_success = TRUE
   CASE
      #狀態由未確認(N)改成確認狀態(Y)
      WHEN lc_state = 'Y' AND g_pmaa_m.pmaastus = 'N'
         CALL s_adbm201_conf_chk(g_pmaa_m.pmaa001) RETURNING l_success
         IF NOT l_success THEN
            CALL s_transaction_end('N','0')
            RETURN
         ELSE
            IF NOT cl_ask_confirm('aim-00108') THEN
               CALL s_transaction_end('N','0')
               RETURN
            ELSE
               CALL s_adbm201_conf_upd(g_pmaa_m.pmaa001) RETURNING l_success
               IF NOT l_success THEN
                  CALL s_transaction_end('N','0')
                  RETURN
               ELSE
                  CALL s_transaction_end('Y','0')
               END IF
            END IF
         END IF
         
      #有未確認(N)改為無效(X)
      WHEN lc_state = 'X' AND g_pmaa_m.pmaastus = 'N'
         CALL s_adbm201_void_chk(g_pmaa_m.pmaa001) RETURNING l_success
         IF NOT l_success THEN
            CALL s_transaction_end('N','0')
            RETURN
         ELSE
            IF NOT cl_ask_confirm('lib-011') THEN
               CALL s_transaction_end('N','0')
               RETURN
            ELSE
               CALL s_adbm201_void_upd(g_pmaa_m.pmaa001) RETURNING l_success
               IF NOT l_success THEN
                  CALL s_transaction_end('N','0')
                  RETURN
               ELSE
                  CALL s_transaction_end('Y','0')
               END IF
            END IF
         END IF
         
      #由已確認(Y)改為未確認狀態(N)
      WHEN lc_state = 'N' AND g_pmaa_m.pmaastus = 'Y'
         CALL s_adbm201_unconf_chk(g_pmaa_m.pmaa001) RETURNING l_success
         IF NOT l_success THEN
            CALL s_transaction_end('N','0')
            RETURN
         ELSE
            IF NOT cl_ask_confirm('aim-00110') THEN
               CALL s_transaction_end('N','0')
               RETURN
            ELSE
               CALL s_adbm201_unconf_upd(g_pmaa_m.pmaa001) RETURNING l_success
               IF NOT l_success THEN
                  CALL s_transaction_end('N','0')
                  RETURN
               ELSE
                  CALL s_transaction_end('Y','0')
               END IF
            END IF
         END IF
         
      #由無效(X)改為未確認(N)
      WHEN lc_state = 'N' AND g_pmaa_m.pmaastus = 'X'
         CALL s_adbm201_valid_chk(g_pmaa_m.pmaa001) RETURNING l_success
         IF NOT l_success THEN
            CALL s_transaction_end('N','0')
            RETURN
         ELSE
            IF NOT cl_ask_confirm('art-00038') THEN
               CALL s_transaction_end('N','0')
               RETURN
            ELSE
               CALL s_adbm201_valid_upd(g_pmaa_m.pmaa001) RETURNING l_success
               IF NOT l_success THEN
                  CALL s_transaction_end('N','0')
                  RETURN
               ELSE
                  CALL s_transaction_end('Y','0')
               END IF
            END IF
         END IF
      OTHERWISE
         RETURN
   END CASE
            {#ADP版次:1#}
   #end add-point

   UPDATE pmaa_t SET pmaastus = lc_state
    WHERE pmaaent = g_enterprise AND pmaa001 = g_pmaa_m.pmaa001


   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = ""
      LET g_errparam.popup = FALSE
      CALL cl_err()

   ELSE
      CASE lc_state
         WHEN "N"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/open.png")
         WHEN "X"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/void.png")

         WHEN "Y"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/valid.png")



      END CASE
      LET g_pmaa_m.pmaastus = lc_state
      DISPLAY BY NAME g_pmaa_m.pmaastus
   END IF

   #add-point:stus修改後
             {#ADP版次:1#}
   #end add-point

   #add-point:statechange段結束前
   CALL adbm201_fetch("")          {#ADP版次:1#}
   #end add-point

END FUNCTION]]>
  </point>
  <point name="function.adbm201_pmaa001_ref" order="20" ver="3" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[################################################################################
# Descriptions...: 網點編號(pmaa001)帶出簡稱.全名.助記碼
# Memo...........:
# Usage..........: CALL adbm201_pmaa001_ref()
# Input parameter: 無
# Return code....: 無
# Date & Author..: 2014/02/26 By pomelo
# Modify.........:
################################################################################
PUBLIC FUNCTION adbm201_pmaa001_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmaa_m.pmaa001
   CALL ap_ref_array2(g_ref_fields,"SELECT pmaal003,pmaal004,pmaal005 FROM pmaal_t WHERE pmaalent='"||g_enterprise||"' AND pmaal001=? AND pmaal002='"||g_lang||"'","") RETURNING g_rtn_fields
   LET g_pmaa_m.pmaal003 = '', g_rtn_fields[1] , ''
   LET g_pmaa_m.pmaal004 = '', g_rtn_fields[2] , ''
   LET g_pmaa_m.pmaal005 = '', g_rtn_fields[3] , ''
END FUNCTION]]>
  </point>
  <point name="function.adbm201_pmaa006_values" order="21" ver="6" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 帶出此經銷商的所屬法人
# Memo...........:
# Usage..........: CALL adbm201_pmaa006_values()
# Input parameter: 無
# Return code....: 無
# Date & Author..: 2014/07/31 By pomelo
# Modify.........:
################################################################################
PUBLIC FUNCTION adbm201_pmaa006_values()
   SELECT pmaa005,pmaa241,pmaa242,pmaa243,pmaa244
     INTO g_pmaa_m.pmaa005,g_pmaa_m.pmaa241,g_pmaa_m.pmaa242,
          g_pmaa_m.pmaa243,g_pmaa_m.pmaa244
     FROM pmaa_t
    WHERE pmaaent = g_enterprise
      AND pmaa001 = g_pmaa_m.pmaa006
   CALL s_desc_get_trading_partner_abbr_desc(g_pmaa_m.pmaa005)
      RETURNING g_pmaa_m.pmaa005_desc
      CALL s_desc_get_dbaa001_desc(g_pmaa_m.pmaa241)
      RETURNING g_pmaa_m.pmaa241_desc
   CALL s_desc_get_dbaa001_desc(g_pmaa_m.pmaa242)
      RETURNING g_pmaa_m.pmaa242_desc
   CALL s_desc_get_dbaa001_desc(g_pmaa_m.pmaa243)
      RETURNING g_pmaa_m.pmaa243_desc
   CALL s_desc_get_dbaa001_desc(g_pmaa_m.pmaa244)
      RETURNING g_pmaa_m.pmaa244_desc
   DISPLAY BY NAME g_pmaa_m.pmaa005,g_pmaa_m.pmaa005_desc,
                   g_pmaa_m.pmaa241,g_pmaa_m.pmaa241_desc,
                   g_pmaa_m.pmaa242,g_pmaa_m.pmaa242_desc,
                   g_pmaa_m.pmaa243,g_pmaa_m.pmaa243_desc,
                   g_pmaa_m.pmaa244,g_pmaa_m.pmaa244_desc
END FUNCTION]]>
  </point>
  <point name="function.adbm201_adbm201_set_act_visible" order="22" ver="9" cite_std="N" new="Y" status="d" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="function.adbm201_set_act_visible" order="22" ver="9" cite_std="N" new="Y" status="u" src="s" readonly="" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adbm201_set_act_visible()
   #add-point:set_act_visible段define
   #150424-00018#1 150528 add by beckxie
   CALL cl_set_act_visible("insert,modify,modify_detail,reproduce,delete,statechange",TRUE)
   #end add-point   
   #add-point:set_act_visible段define(客製用)

   #end add-point   
   #add-point:set_act_visible段

   #end add-point   
END FUNCTION]]>
  </point>
  <point name="function.adbm201_set_act_no_visible" order="23" ver="9" cite_std="N" new="Y" status="u" src="s" readonly="" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adbm201_set_act_no_visible()
   #add-point:set_act_no_visible段define
   #150424-00018#1 150529 add by beckxie---S
   IF cl_get_para(g_enterprise,g_site,'E-CIR-0025')='Y' THEN
      CALL cl_set_act_visible("insert,modify,modify_detail,reproduce,delete,statechange",FALSE)
   END IF
   #150424-00018#1 150529 add by beckxie---E
   #end add-point   
   #add-point:set_act_no_visible段define(客製用)

   #end add-point   
   #add-point:set_act_no_visible段
   
   #end add-point   
END FUNCTION]]>
  </point>
  <point name="browser_fill.before_pre" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   ]]>
  </point>
  <point name="browser_fill.cnt_sql" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   ]]>
  </point>
  <point name="browser_fill.define" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   ]]>
  </point>
  <point name="browser_fill.reference" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[      ]]>
  </point>
  <point name="browser_fill.wc" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   ]]>
  </point>
  <point name="construct.a.ooff013" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.a.pmaa001" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.a.pmaa004" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.a.pmaa005" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.a.pmaa006" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.a.pmaa016" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.a.pmaa017" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.a.pmaa018" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.a.pmaa019" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.a.pmaa020" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.a.pmaa021" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.a.pmaa022" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.a.pmaa026" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.a.pmaa027" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.a.pmaa090" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.a.pmaa095" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.a.pmaa200" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.a.pmaa201" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.a.pmaa221" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.a.pmaa232" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.a.pmaa291" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.a.pmaa292" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.a.pmaa293" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.a.pmaa294" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.a.pmaa295" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.a.pmaa296" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.a.pmaa297" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.a.pmaa298" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.a.pmaa299" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.a.pmaa300" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.a.pmaacnfid" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.a.pmaacrtdp" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.a.pmaacrtid" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.a.pmaal003" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.a.pmaal004" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.a.pmaal005" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.a.pmaamodid" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.a.pmaaowndp" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.a.pmaaownid" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.a.pmaastus" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.b.ooff013" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.b.pmaa001" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.b.pmaa004" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.b.pmaa005" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.b.pmaa006" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.b.pmaa016" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.b.pmaa017" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.b.pmaa018" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.b.pmaa019" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.b.pmaa020" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.b.pmaa021" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.b.pmaa022" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.b.pmaa026" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.b.pmaa027" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.b.pmaa090" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.b.pmaa095" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.b.pmaa200" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.b.pmaa201" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.b.pmaa221" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.b.pmaa232" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.b.pmaa291" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.b.pmaa292" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.b.pmaa293" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.b.pmaa294" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.b.pmaa295" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.b.pmaa296" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.b.pmaa297" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.b.pmaa298" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.b.pmaa299" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.b.pmaa300" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.b.pmaacnfdt" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.b.pmaacnfid" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.b.pmaacrtdp" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.b.pmaacrtdt" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.b.pmaacrtid" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.b.pmaal003" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.b.pmaal004" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.b.pmaal005" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.b.pmaamoddt" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.b.pmaamodid" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.b.pmaaowndp" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.b.pmaaownid" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.b.pmaastus" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.c.ooff013" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.c.pmaa001" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_pmaa001_5()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa001  #顯示到畫面上

            NEXT FIELD pmaa001                     #返回原欄位

]]>
  </point>
  <point name="construct.c.pmaa004" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.c.pmaa005" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooed004_2()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa005  #顯示到畫面上

            NEXT FIELD pmaa005                     #返回原欄位

]]>
  </point>
  <point name="construct.c.pmaa006" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_pmaa001_3()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa006  #顯示到畫面上

            NEXT FIELD pmaa006                     #返回原欄位

]]>
  </point>
  <point name="construct.c.pmaa016" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.c.pmaa017" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.c.pmaa018" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.c.pmaa019" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooaj002_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa019  #顯示到畫面上

            NEXT FIELD pmaa019                     #返回原欄位

]]>
  </point>
  <point name="construct.c.pmaa020" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.c.pmaa021" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.c.pmaa022" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooai001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa022  #顯示到畫面上

            NEXT FIELD pmaa022                     #返回原欄位

]]>
  </point>
  <point name="construct.c.pmaa026" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_oocq002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa026  #顯示到畫面上

            NEXT FIELD pmaa026                     #返回原欄位

]]>
  </point>
  <point name="construct.c.pmaa027" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.c.pmaa090" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_oocq002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa090  #顯示到畫面上

            NEXT FIELD pmaa090                     #返回原欄位

]]>
  </point>
  <point name="construct.c.pmaa095" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooed004()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa095  #顯示到畫面上

            NEXT FIELD pmaa095                     #返回原欄位

]]>
  </point>
  <point name="construct.c.pmaa200" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.c.pmaa201" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.c.pmaa221" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_oocq002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa221  #顯示到畫面上

            NEXT FIELD pmaa221                     #返回原欄位

]]>
  </point>
  <point name="construct.c.pmaa232" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_oocq002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa232  #顯示到畫面上

            NEXT FIELD pmaa232                     #返回原欄位

]]>
  </point>
  <point name="construct.c.pmaa291" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_oocq002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa291  #顯示到畫面上

            NEXT FIELD pmaa291                     #返回原欄位

]]>
  </point>
  <point name="construct.c.pmaa292" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_oocq002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa292  #顯示到畫面上

            NEXT FIELD pmaa292                     #返回原欄位

]]>
  </point>
  <point name="construct.c.pmaa293" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_oocq002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa293  #顯示到畫面上

            NEXT FIELD pmaa293                     #返回原欄位

]]>
  </point>
  <point name="construct.c.pmaa294" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_oocq002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa294  #顯示到畫面上

            NEXT FIELD pmaa294                     #返回原欄位

]]>
  </point>
  <point name="construct.c.pmaa295" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_oocq002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa295  #顯示到畫面上

            NEXT FIELD pmaa295                     #返回原欄位

]]>
  </point>
  <point name="construct.c.pmaa296" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_oocq002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa296  #顯示到畫面上

            NEXT FIELD pmaa296                     #返回原欄位

]]>
  </point>
  <point name="construct.c.pmaa297" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_oocq002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa297  #顯示到畫面上

            NEXT FIELD pmaa297                     #返回原欄位

]]>
  </point>
  <point name="construct.c.pmaa298" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_oocq002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa298  #顯示到畫面上

            NEXT FIELD pmaa298                     #返回原欄位

]]>
  </point>
  <point name="construct.c.pmaa299" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_oocq002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa299  #顯示到畫面上

            NEXT FIELD pmaa299                     #返回原欄位

]]>
  </point>
  <point name="construct.c.pmaa300" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_oocq002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaa300  #顯示到畫面上

            NEXT FIELD pmaa300                     #返回原欄位

]]>
  </point>
  <point name="construct.c.pmaacnfid" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooag001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaacnfid  #顯示到畫面上

            NEXT FIELD pmaacnfid                     #返回原欄位

]]>
  </point>
  <point name="construct.c.pmaacrtdp" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooeg001_9()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaacrtdp  #顯示到畫面上

            NEXT FIELD pmaacrtdp                     #返回原欄位

]]>
  </point>
  <point name="construct.c.pmaacrtid" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooag001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaacrtid  #顯示到畫面上

            NEXT FIELD pmaacrtid                     #返回原欄位

]]>
  </point>
  <point name="construct.c.pmaal003" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.c.pmaal004" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.c.pmaal005" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="construct.c.pmaamodid" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooag001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaamodid  #顯示到畫面上

            NEXT FIELD pmaamodid                     #返回原欄位

]]>
  </point>
  <point name="construct.c.pmaaowndp" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooeg001_9()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaaowndp  #顯示到畫面上

            NEXT FIELD pmaaowndp                     #返回原欄位

]]>
  </point>
  <point name="construct.c.pmaaownid" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooag001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmaaownid  #顯示到畫面上

            NEXT FIELD pmaaownid                     #返回原欄位

]]>
  </point>
  <point name="construct.c.pmaastus" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="cs.after_construct" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   ]]>
  </point>
  <point name="cs.before_construct" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="cs.define" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   ]]>
  </point>
  <point name="cs.more_construct" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[      ]]>
  </point>
  <point name="default_search.after" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   ]]>
  </point>
  <point name="default_search.before" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   ]]>
  </point>
  <point name="default_search.define" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   ]]>
  </point>
  <point name="delete.define" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[      DEFINE  l_success       LIKE type_t.chr1]]>
  </point>
  <point name="delete.head.a_delete" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[      DELETE FROM pmaal_t
       WHERE pmaalent = g_enterprise AND pmaal001 = g_pmaa_m.pmaa001
       
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = 'del pmaal_t'
         LET g_errparam.popup = FALSE
         CALL cl_err()
 
         CALL s_transaction_end('N','0')
         RETURN
      END IF 
      
      #刪除ooff_t備註
      LET l_success = ''
      CALL s_aooi360_del('99',g_prog,g_pmaa_m.pmaa001,'','','','','','','','','4') RETURNING l_success
      IF NOT l_success THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "ooff_t"
         LET g_errparam.popup = FALSE
         CALL cl_err()

         CALL s_transaction_end('N','0')
         RETURN
      END IF
      
      IF NOT cl_null(g_pmaa_m.pmaa027) THEN
         IF NOT s_aooi350_del(g_pmaa_m.pmaa027) THEN
            INITIALIZE g_errparam TO NULL
            LET g_errparam.code = SQLCA.sqlcode
            LET g_errparam.extend = "del oofa_t"
            LET g_errparam.popup = FALSE
            CALL cl_err()

            CALL s_transaction_end('N','0')
            RETURN
         END IF
      END IF ]]>
  </point>
  <point name="delete.head.b_delete" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="delete.head.m_delete" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[      ]]>
  </point>
  <point name="fetch.action_control" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[      IF g_pmaa_m.pmaastus = 'N' THEN
      CALL cl_set_act_visible("modify,delete,modify_detail",TRUE)
   ELSE
      CALL cl_set_act_visible("modify,delete,modify_detail",FALSE)
   END IF]]>
  </point>
  <point name="fetch.define" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[      CALL g_pmbg1_d.clear()
   CALL g_pmbg2_d.clear()]]>
  </point>
  <point name="filter.add_cs" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[      ]]>
  </point>
  <point name="filter.b_dialog" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[         ]]>
  </point>
  <point name="filter.define" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   ]]>
  </point>
  <point name="filter_parser.define" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   ]]>
  </point>
  <point name="free_style.variable" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[{<Module define>}

#單頭 type 宣告
 TYPE type_g_pmaa_m RECORD
   pmaa095 LIKE pmaa_t.pmaa095,
   pmaa095_desc LIKE type_t.chr80,
   pmaa001 LIKE pmaa_t.pmaa001,
   pmaal004 LIKE pmaal_t.pmaal004,
   pmaal003 LIKE pmaal_t.pmaal003,
   pmaal005 LIKE pmaal_t.pmaal005,
   pmaa005 LIKE pmaa_t.pmaa005,
   pmaa005_desc LIKE type_t.chr80,
   pmaa006 LIKE pmaa_t.pmaa006,
   pmaa006_desc LIKE type_t.chr80,
   pmaa090 LIKE pmaa_t.pmaa090,
   pmaa090_desc LIKE type_t.chr80,
   pmaa026 LIKE pmaa_t.pmaa026,
   pmaa026_desc LIKE type_t.chr80,
   pmaa221 LIKE pmaa_t.pmaa221,
   pmaa221_desc LIKE type_t.chr80,
   pmaa232 LIKE pmaa_t.pmaa232,
   pmaa232_desc LIKE type_t.chr80,
   pmaa200 LIKE pmaa_t.pmaa200,
   pmaa201 LIKE pmaa_t.pmaa201,
   pmaa027 LIKE pmaa_t.pmaa027,
   pmaa002 LIKE pmaa_t.pmaa002,
   pmaa230 LIKE pmaa_t.pmaa230,
   pmaa004 LIKE type_t.chr1,
   pmaa241 LIKE pmaa_t.pmaa241,
   pmaa241_desc LIKE type_t.chr80,
   pmaa242 LIKE pmaa_t.pmaa242,
   pmaa242_desc LIKE type_t.chr80,
   pmaa243 LIKE pmaa_t.pmaa243,
   pmaa243_desc LIKE type_t.chr80,
   pmaa244 LIKE pmaa_t.pmaa244,
   pmaa244_desc LIKE type_t.chr80,
   pmaastus LIKE pmaa_t.pmaastus,
   pmaaownid LIKE pmaa_t.pmaaownid,
   pmaaownid_desc LIKE type_t.chr80,
   pmaaowndp LIKE pmaa_t.pmaaowndp,
   pmaaowndp_desc LIKE type_t.chr80,
   pmaacrtid LIKE pmaa_t.pmaacrtid,
   pmaacrtid_desc LIKE type_t.chr80,
   pmaacrtdp LIKE pmaa_t.pmaacrtdp,
   pmaacrtdp_desc LIKE type_t.chr80,
   pmaacrtdt DATETIME YEAR TO SECOND,
   pmaamodid LIKE pmaa_t.pmaamodid,
   pmaamodid_desc LIKE type_t.chr80,
   pmaamoddt DATETIME YEAR TO SECOND,
   pmaacnfid LIKE pmaa_t.pmaacnfid,
   pmaacnfid_desc LIKE type_t.chr80,
   pmaacnfdt DATETIME YEAR TO SECOND,
   pmaa017 LIKE pmaa_t.pmaa017,
   pmaa016 LIKE pmaa_t.pmaa016,
   pmaa018 LIKE pmaa_t.pmaa018,
   pmaa019 LIKE pmaa_t.pmaa019,
   pmaa019_desc LIKE type_t.chr80,
   pmaa021 LIKE pmaa_t.pmaa021,
   pmaa022 LIKE pmaa_t.pmaa022,
   pmaa022_desc LIKE type_t.chr80,
   pmaa020 LIKE pmaa_t.pmaa020,
   ooff013 LIKE ooff_t.ooff013,
   pmaa291 LIKE pmaa_t.pmaa291,
   pmaa291_desc LIKE type_t.chr80,
   pmaa292 LIKE pmaa_t.pmaa292,
   pmaa292_desc LIKE type_t.chr80,
   pmaa293 LIKE pmaa_t.pmaa293,
   pmaa293_desc LIKE type_t.chr80,
   pmaa294 LIKE pmaa_t.pmaa294,
   pmaa294_desc LIKE type_t.chr80,
   pmaa295 LIKE pmaa_t.pmaa295,
   pmaa295_desc LIKE type_t.chr80,
   pmaa296 LIKE pmaa_t.pmaa296,
   pmaa296_desc LIKE type_t.chr80,
   pmaa297 LIKE pmaa_t.pmaa297,
   pmaa297_desc LIKE type_t.chr80,
   pmaa298 LIKE pmaa_t.pmaa298,
   pmaa298_desc LIKE type_t.chr80,
   pmaa299 LIKE pmaa_t.pmaa299,
   pmaa299_desc LIKE type_t.chr80,
   pmaa300 LIKE pmaa_t.pmaa300,
   pmaa300_desc LIKE type_t.chr80
       END RECORD

#模組變數(Module Variables)
DEFINE g_pmaa_m        type_g_pmaa_m
DEFINE g_pmaa_m_t      type_g_pmaa_m                #備份舊值
DEFINE g_pmaa001_t LIKE pmaa_t.pmaa001


DEFINE g_browser    DYNAMIC ARRAY OF RECORD                   #資料瀏覽之欄位
   b_statepic     LIKE type_t.chr50,
   b_pmaa095 LIKE pmaa_t.pmaa095,
   b_pmaa095_desc LIKE type_t.chr80,
   b_pmaa001 LIKE pmaa_t.pmaa001,
   b_pmaa001_desc LIKE type_t.chr80,
   b_pmaa001_desc_desc LIKE type_t.chr80,
   b_pmaa001_desc_desc_desc LIKE type_t.chr80,
   b_pmaa005 LIKE pmaa_t.pmaa005,
   b_pmaa005_desc LIKE type_t.chr80,
   b_pmaa006 LIKE pmaa_t.pmaa006,
   b_pmaa006_desc LIKE type_t.chr80,
   b_pmaa090 LIKE pmaa_t.pmaa090,
   b_pmaa090_desc LIKE type_t.chr80,
   b_pmaa026 LIKE pmaa_t.pmaa026,
   b_pmaa026_desc LIKE type_t.chr80
   #,rank           LIKE type_t.num10
      END RECORD

DEFINE g_master_multi_table_t    RECORD
      pmaal001 LIKE pmaal_t.pmaal001,
      pmaal004 LIKE pmaal_t.pmaal004,
      pmaal003 LIKE pmaal_t.pmaal003,
      pmaal005 LIKE pmaal_t.pmaal005
      END RECORD

DEFINE g_wc                  STRING                        #儲存 user 的查詢條件
DEFINE g_wc_t                STRING                        #儲存 user 的查詢條件
DEFINE g_wc_filter           STRING
DEFINE g_wc_filter_t         STRING

DEFINE g_sql                 STRING                        #組 sql 用
DEFINE g_forupd_sql          STRING                        #SELECT ... FOR UPDATE  SQL
DEFINE g_cnt                 LIKE type_t.num10
DEFINE g_jump                LIKE type_t.num10             #查詢指定的筆數
DEFINE g_no_ask              LIKE type_t.num5              #是否開啟指定筆視窗
DEFINE g_rec_b               LIKE type_t.num5              #單身筆數
DEFINE l_ac                  LIKE type_t.num5              #目前處理的ARRAY CNT
DEFINE g_curr_diag           ui.Dialog                     #Current Dialog
DEFINE gwin_curr             ui.Window                     #Current Window
DEFINE gfrm_curr             ui.Form                       #Current Form
DEFINE g_pagestart           LIKE type_t.num5              #page起始筆數
DEFINE g_page_action         STRING                        #page action
DEFINE g_header_hidden       LIKE type_t.num5              #隱藏單頭
DEFINE g_worksheet_hidden    LIKE type_t.num5              #隱藏工作Panel
DEFINE g_page                STRING                        #第幾頁
DEFINE g_current_sw          BOOLEAN                       #Browser所在筆數用開關
DEFINE g_ch                  base.Channel                  #外串程式用
DEFINE g_state               STRING
DEFINE g_ref_fields          DYNAMIC ARRAY OF VARCHAR(500) #ap_ref用陣列
DEFINE g_ref_vars            DYNAMIC ARRAY OF VARCHAR(500) #ap_ref用陣列
DEFINE g_rtn_fields          DYNAMIC ARRAY OF VARCHAR(500) #ap_ref用陣列
DEFINE g_error_show          LIKE type_t.num5
DEFINE g_aw                  STRING             #確定當下點擊的單身

#快速搜尋用
DEFINE g_searchcol           STRING             #查詢欄位代碼
DEFINE g_searchstr           STRING             #查詢欄位字串
DEFINE g_order               STRING             #查詢排序模式

#Browser用
DEFINE g_current_idx         LIKE type_t.num5   #Browser 所在筆數(當下page)
DEFINE g_current_row         LIKE type_t.num5   #Browser 所在筆數(暫存用)
DEFINE g_current_cnt         LIKE type_t.num10  #Browser 總筆數(當下page)
DEFINE g_browser_idx         LIKE type_t.num5   #Browser 所在筆數(所有資料)
DEFINE g_browser_cnt         LIKE type_t.num5   #Browser 總筆數(所有資料)
DEFINE g_tmp_page            LIKE type_t.num5
DEFINE g_row_index           LIKE type_t.num5
DEFINE g_chk                 BOOLEAN

{</Module define>}]]>
  </point>
  <point name="global.import" order="" ver="3" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#嵌入
IMPORT FGL aoo_aooi350_01
IMPORT FGL aoo_aooi350_02]]>
  </point>
  <point name="global.variable" order="" ver="9" cite_std="N" new="N" status="u" src="s" readonly="" mark_hard="N">
    <![CDATA[DEFINE g_pmaa_m_o      type_g_pmaa_m
GLOBALS
   DEFINE g_detail_insert   LIKE type_t.num5   #單身的新增權限
   DEFINE g_detail_delete   LIKE type_t.num5   #單身的刪除權限
   DEFINE g_wc2_i35001      STRING             #聯絡地址QBE條件
   DEFINE g_wc2_i35002      STRING             #通訊方式QBE條件
   DEFINE g_d_idx_i35001    LIKE type_t.num5   #聯絡地址所在筆數
   DEFINE g_d_cnt_i35001    LIKE type_t.num5   #聯絡地址總筆數
   DEFINE g_d_idx_i35002    LIKE type_t.num5   #通訊方式所在筆數
   DEFINE g_d_cnt_i35002    LIKE type_t.num5   #通訊方式總筆數
   DEFINE g_pmaa027_d       LIKE pmaa_t.pmaa027
   DEFINE g_appoint_idx     LIKE type_t.num5   #指定進入單身行數
   
#ken---add---s 需求單號：150107-00009 項次：4
 TYPE type_g_oofb_d        RECORD
       oofbstus LIKE oofb_t.oofbstus,
   oofb001 LIKE oofb_t.oofb001,
   oofb019 LIKE oofb_t.oofb019,
   oofb011 LIKE oofb_t.oofb011,
   oofb008 LIKE oofb_t.oofb008,
   oofb009 LIKE oofb_t.oofb009,
   oofb009_desc LIKE type_t.chr500,
   oofb010 LIKE oofb_t.oofb010,
   oofb012 LIKE oofb_t.oofb012,
   oofb012_desc LIKE type_t.chr500,
   oofb013 LIKE oofb_t.oofb013,
   oofb014 LIKE oofb_t.oofb014,
   oofb014_desc LIKE type_t.chr500,
   oofb015 LIKE oofb_t.oofb015,
   oofb015_desc LIKE type_t.chr500,
   oofb016 LIKE oofb_t.oofb016,
   oofb016_desc LIKE type_t.chr500,
   oofb017 LIKE oofb_t.oofb017,
   oofb022 LIKE oofb_t.oofb022,
   oofb022_desc LIKE type_t.chr500,
   oofb020 LIKE oofb_t.oofb020,
   oofb021 LIKE oofb_t.oofb021,
   oofb018 LIKE oofb_t.oofb018
       END RECORD
DEFINE g_pmba_d          DYNAMIC ARRAY OF type_g_oofb_d

 TYPE type_g_oofc_d        RECORD
       oofcstus LIKE oofc_t.oofcstus,
   oofc001 LIKE oofc_t.oofc001,
   oofc008 LIKE oofc_t.oofc008,
   oofc009 LIKE oofc_t.oofc009,
   oofc009_desc LIKE type_t.chr500,
   oofc012 LIKE oofc_t.oofc012,
   oofc010 LIKE oofc_t.oofc010,
   oofc014 LIKE oofc_t.oofc014,
   oofc011 LIKE oofc_t.oofc011,
   oofc015 LIKE oofc_t.oofc015,
   oofc013 LIKE oofc_t.oofc013
       END RECORD
DEFINE g_pmba2_d          DYNAMIC ARRAY OF type_g_oofc_d
#ken---add---e   
END GLOBALS]]>
  </point>
  <point name="init.define" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   ]]>
  </point>
  <point name="init.init" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[      CALL cl_set_combo_scc('oofb008','9') 
   CALL cl_set_combo_scc('oofc008','6') 
   LET g_errshow = 1
   LET g_bfill = "Y"]]>
  </point>
  <point name="input.a.ooff013" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.a.pmaa001" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  NOT cl_null(g_pmaa_m.pmaa001) THEN 
               IF p_cmd = 'a' OR ( p_cmd = 'u' AND (g_pmaa_m.pmaa001 != g_pmaa001_t )) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM pmaa_t WHERE "||"pmaaent = '" ||g_enterprise|| "' AND "||"pmaa001 = '"||g_pmaa_m.pmaa001 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
]]>
  </point>
  <point name="input.a.pmaa004" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.a.pmaa005" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_pmaa_m.pmaa005_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmaa005_desc
            IF NOT cl_null(g_pmaa_m.pmaa005) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmaa005 != g_pmaa_m_o.pmaa005 OR g_pmaa_m_o.pmaa005 IS NULL )) THEN
                  INITIALIZE g_chkparam.* TO NULL
                  LET g_chkparam.arg1 = g_pmaa_m.pmaa005
                  LET g_chkparam.arg2 = '1'
                  IF NOT cl_chk_exist("v_ooed004_1") THEN
                     LET g_pmaa_m.pmaa005 = g_pmaa_m_o.pmaa005
                     CALL adbm201_pmaa005_ref()
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL adbm201_pmaa005_ref()
            LET g_pmaa_m_o.pmaa005 = g_pmaa_m.pmaa005
]]>
  </point>
  <point name="input.a.pmaa006" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_pmaa_m.pmaa006_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmaa006_desc
            IF NOT cl_null(g_pmaa_m.pmaa006) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmaa006 != g_pmaa_m_o.pmaa006 OR g_pmaa_m_o.pmaa006 IS NULL )) THEN
                  INITIALIZE g_chkparam.* TO NULL
                  LET g_chkparam.arg1 = g_pmaa_m.pmaa006
                  IF NOT cl_chk_exist("v_pmaa001_9") THEN
                     LET g_pmaa_m.pmaa006 = g_pmaa_m_o.pmaa006
                     CALL adbm201_pmaa006_ref()
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL adbm201_pmaa006_ref()
            LET g_pmaa_m_o.pmaa006 = g_pmaa_m.pmaa006
]]>
  </point>
  <point name="input.a.pmaa016" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.a.pmaa017" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.a.pmaa018" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="input.a.pmaa019" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_pmaa_m.pmaa019_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmaa019_desc
            IF NOT cl_null(g_pmaa_m.pmaa019) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmaa019 != g_pmaa_m_o.pmaa019 OR g_pmaa_m_o.pmaa019 IS NULL )) THEN
                  INITIALIZE g_chkparam.* TO NULL
                  LET g_chkparam.arg1 = g_site
                  LET g_chkparam.arg2 = g_pmaa_m.pmaa019
                  IF NOT cl_chk_exist("v_ooaj002") THEN
                     LET g_pmaa_m.pmaa019 = g_pmaa_m_o.pmaa019
                     CALL adbm201_pmaa019_ref()
                     NEXT FIELD CURRENT                  
                  END IF
               END IF
            END IF
            CALL adbm201_pmaa019_ref()
            LET g_pmaa_m_o.pmaa019 = g_pmaa_m.pmaa019]]>
  </point>
  <point name="input.a.pmaa020" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.a.pmaa021" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="input.a.pmaa022" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_pmaa_m.pmaa022_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmaa022_desc
            IF NOT cl_null(g_pmaa_m.pmaa022) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmaa022 != g_pmaa_m_o.pmaa022 OR g_pmaa_m_o.pmaa022 IS NULL )) THEN
                  INITIALIZE g_chkparam.* TO NULL
                  LET g_chkparam.arg1 = g_site
                  LET g_chkparam.arg2 = g_pmaa_m.pmaa022
                  IF NOT cl_chk_exist("v_ooaj002") THEN
                     LET g_pmaa_m.pmaa022 = g_pmaa_m_o.pmaa022
                     CALL adbm201_pmaa022_ref()
                     NEXT FIELD CURRENT                  
                  END IF
               END IF
            END IF
            CALL adbm201_pmaa022_ref()
            LET g_pmaa_m_o.pmaa022 = g_pmaa_m.pmaa022
]]>
  </point>
  <point name="input.a.pmaa026" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_pmaa_m.pmaa026_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmaa026_desc
            IF NOT cl_null(g_pmaa_m.pmaa026) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmaa026 != g_pmaa_m_o.pmaa026 OR g_pmaa_m_o.pmaa026 IS NULL )) THEN
                  CALL adbm201_chk_acc_code('250',g_pmaa_m.pmaa026)
                  IF NOT cl_null(g_errno) THEN
                     LET l_msg = cl_getmsg('art-00005',g_dlang)
                     LET l_msg = cl_replace_str(l_msg,"%1","250")
                     LET l_msg = cl_replace_str(l_msg,"%2",g_pmaa_m.pmaa026)
                     INITIALIZE g_errparam TO NULL
                     LET g_errparam.code = g_errno
                     LET g_errparam.extend = l_msg
                     LET g_errparam.popup = TRUE
                     CALL cl_err()

                     LET g_pmaa_m.pmaa026 = g_pmaa_m_o.pmaa026
                     CALL adbm201_pmaa026_ref()
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL adbm201_pmaa026_ref()
            LET g_pmaa_m_o.pmaa026 = g_pmaa_m.pmaa026
]]>
  </point>
  <point name="input.a.pmaa027" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.a.pmaa090" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_pmaa_m.pmaa090_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmaa090_desc
            IF NOT cl_null(g_pmaa_m.pmaa090) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmaa090 != g_pmaa_m_o.pmaa090 OR g_pmaa_m_o.pmaa090 IS NULL )) THEN
                  CALL adbm201_chk_acc_code('281',g_pmaa_m.pmaa090)
                  IF NOT cl_null(g_errno) THEN
                     LET l_msg = cl_getmsg('art-00005',g_dlang)
                     LET l_msg = cl_replace_str(l_msg,"%1","281")
                     LET l_msg = cl_replace_str(l_msg,"%2",g_pmaa_m.pmaa090)
                     INITIALIZE g_errparam TO NULL
                     LET g_errparam.code = g_errno
                     LET g_errparam.extend = l_msg
                     LET g_errparam.popup = TRUE
                     CALL cl_err()

                     LET g_pmaa_m.pmaa090 = g_pmaa_m_o.pmaa090
                     CALL adbm201_pmaa090_ref()
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL adbm201_pmaa090_ref()
            LET g_pmaa_m_o.pmaa090 = g_pmaa_m.pmaa090
]]>
  </point>
  <point name="input.a.pmaa095" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        LET g_pmaa_m.pmaa095_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmaa095_desc
            IF NOT cl_null(g_pmaa_m.pmaa095) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmaa095 != g_pmaa_m_t.pmaa095 OR g_pmaa_m_t.pmaa095 IS NULL )) THEN
                  INITIALIZE g_chkparam.* TO NULL
                  LET g_chkparam.arg1 = g_pmaa_m.pmaa095
                  LET g_chkparam.arg2 = '2'
                  LET g_chkparam.arg3 = g_site

                  IF NOT cl_chk_exist("v_ooed004") THEN
                     LET g_pmaa_m.pmaa095 = g_pmaa_m_t.pmaa095
                     CALL adbm201_pmaa095_ref()
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL adbm201_pmaa095_ref()]]>
  </point>
  <point name="input.a.pmaa200" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.a.pmaa201" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.a.pmaa221" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_pmaa_m.pmaa221_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmaa221_desc
            IF NOT cl_null(g_pmaa_m.pmaa221) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmaa221 != g_pmaa_m_o.pmaa221 OR g_pmaa_m_o.pmaa221 IS NULL )) THEN
                  CALL adbm201_chk_acc_code('2073',g_pmaa_m.pmaa221)
                  IF NOT cl_null(g_errno) THEN
                     LET l_msg = cl_getmsg('art-00005',g_dlang)
                     LET l_msg = cl_replace_str(l_msg,"%1","2073")
                     LET l_msg = cl_replace_str(l_msg,"%2",g_pmaa_m.pmaa221)
                     INITIALIZE g_errparam TO NULL
                     LET g_errparam.code = g_errno
                     LET g_errparam.extend = l_msg
                     LET g_errparam.popup = TRUE
                     CALL cl_err()

                     LET g_pmaa_m.pmaa221 = g_pmaa_m_o.pmaa221
                     CALL adbm201_pmaa221_ref()
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL adbm201_pmaa221_ref()
            LET g_pmaa_m_o.pmaa221 = g_pmaa_m.pmaa221
]]>
  </point>
  <point name="input.a.pmaa232" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_pmaa_m.pmaa232_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmaa232_desc
            IF NOT cl_null(g_pmaa_m.pmaa232) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmaa232 != g_pmaa_m_o.pmaa232 OR g_pmaa_m_o.pmaa232 IS NULL )) THEN
                  CALL adbm201_chk_acc_code('2072',g_pmaa_m.pmaa232)
                  IF NOT cl_null(g_errno) THEN
                     LET l_msg = cl_getmsg('art-00005',g_dlang)
                     LET l_msg = cl_replace_str(l_msg,"%1","2072")
                     LET l_msg = cl_replace_str(l_msg,"%2",g_pmaa_m.pmaa232)
                     INITIALIZE g_errparam TO NULL
                     LET g_errparam.code = g_errno
                     LET g_errparam.extend = l_msg
                     LET g_errparam.popup = TRUE
                     CALL cl_err()

                     LET g_pmaa_m.pmaa232 = g_pmaa_m_o.pmaa232
                     CALL adbm201_pmaa232_ref()
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL adbm201_pmaa232_ref()
            LET g_pmaa_m_o.pmaa232 = g_pmaa_m.pmaa232
]]>
  </point>
  <point name="input.a.pmaa291" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_pmaa_m.pmaa291_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmaa291_desc
            IF NOT cl_null(g_pmaa_m.pmaa291) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmaa291 != g_pmaa_m_o.pmaa291 OR g_pmaa_m_o.pmaa291 IS NULL )) THEN
                  CALL adbm201_chk_acc_code('2061',g_pmaa_m.pmaa291)
                  IF NOT cl_null(g_errno) THEN
                     LET l_msg = cl_getmsg('art-00005',g_dlang)
                     LET l_msg = cl_replace_str(l_msg,"%1","2061")
                     LET l_msg = cl_replace_str(l_msg,"%2",g_pmaa_m.pmaa291)
                     INITIALIZE g_errparam TO NULL
                     LET g_errparam.code = g_errno
                     LET g_errparam.extend = l_msg
                     LET g_errparam.popup = TRUE
                     CALL cl_err()

                     LET g_pmaa_m.pmaa291 = g_pmaa_m_o.pmaa291
                     CALL adbm201_pmaa291_ref()
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL adbm201_pmaa291_ref()
            LET g_pmaa_m_o.pmaa291 = g_pmaa_m.pmaa291
]]>
  </point>
  <point name="input.a.pmaa292" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_pmaa_m.pmaa292_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmaa292_desc
            IF NOT cl_null(g_pmaa_m.pmaa292) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmaa292 != g_pmaa_m_o.pmaa292 OR g_pmaa_m_o.pmaa292 IS NULL )) THEN
                  CALL adbm201_chk_acc_code('2062',g_pmaa_m.pmaa292)
                  IF NOT cl_null(g_errno) THEN
                     LET l_msg = cl_getmsg('art-00005',g_dlang)
                     LET l_msg = cl_replace_str(l_msg,"%1","2062")
                     LET l_msg = cl_replace_str(l_msg,"%2",g_pmaa_m.pmaa292)
                     INITIALIZE g_errparam TO NULL
                     LET g_errparam.code = g_errno
                     LET g_errparam.extend = l_msg
                     LET g_errparam.popup = TRUE
                     CALL cl_err()

                     LET g_pmaa_m.pmaa292 = g_pmaa_m_o.pmaa292
                     CALL adbm201_pmaa292_ref()
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL adbm201_pmaa292_ref()
            LET g_pmaa_m_o.pmaa292 = g_pmaa_m.pmaa292
]]>
  </point>
  <point name="input.a.pmaa293" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_pmaa_m.pmaa293_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmaa293_desc
            IF NOT cl_null(g_pmaa_m.pmaa293) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmaa293 != g_pmaa_m_o.pmaa293 OR g_pmaa_m_o.pmaa293 IS NULL )) THEN
                  CALL adbm201_chk_acc_code('2063',g_pmaa_m.pmaa293)
                  IF NOT cl_null(g_errno) THEN
                     LET l_msg = cl_getmsg('art-00005',g_dlang)
                     LET l_msg = cl_replace_str(l_msg,"%1","2063")
                     LET l_msg = cl_replace_str(l_msg,"%2",g_pmaa_m.pmaa293)
                     INITIALIZE g_errparam TO NULL
                     LET g_errparam.code = g_errno
                     LET g_errparam.extend = l_msg
                     LET g_errparam.popup = TRUE
                     CALL cl_err()

                     LET g_pmaa_m.pmaa293 = g_pmaa_m_o.pmaa293
                     CALL adbm201_pmaa293_ref()
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL adbm201_pmaa293_ref()
            LET g_pmaa_m_o.pmaa293 = g_pmaa_m.pmaa293
]]>
  </point>
  <point name="input.a.pmaa294" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_pmaa_m.pmaa294_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmaa294_desc
            IF NOT cl_null(g_pmaa_m.pmaa294) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmaa294 != g_pmaa_m_o.pmaa294 OR g_pmaa_m_o.pmaa294 IS NULL )) THEN
                  CALL adbm201_chk_acc_code('2064',g_pmaa_m.pmaa294)
                  IF NOT cl_null(g_errno) THEN
                     LET l_msg = cl_getmsg('art-00005',g_dlang)
                     LET l_msg = cl_replace_str(l_msg,"%1","2064")
                     LET l_msg = cl_replace_str(l_msg,"%2",g_pmaa_m.pmaa294)
                     INITIALIZE g_errparam TO NULL
                     LET g_errparam.code = g_errno
                     LET g_errparam.extend = l_msg
                     LET g_errparam.popup = TRUE
                     CALL cl_err()

                     LET g_pmaa_m.pmaa294 = g_pmaa_m_o.pmaa294
                     CALL adbm201_pmaa294_ref()
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL adbm201_pmaa294_ref()
            LET g_pmaa_m_o.pmaa294 = g_pmaa_m.pmaa294
]]>
  </point>
  <point name="input.a.pmaa295" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_pmaa_m.pmaa295_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmaa295_desc
            IF NOT cl_null(g_pmaa_m.pmaa295) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmaa295 != g_pmaa_m_o.pmaa295 OR g_pmaa_m_o.pmaa295 IS NULL )) THEN
                  CALL adbm201_chk_acc_code('2065',g_pmaa_m.pmaa295)
                  IF NOT cl_null(g_errno) THEN
                     LET l_msg = cl_getmsg('art-00005',g_dlang)
                     LET l_msg = cl_replace_str(l_msg,"%1","2065")
                     LET l_msg = cl_replace_str(l_msg,"%2",g_pmaa_m.pmaa295)
                     INITIALIZE g_errparam TO NULL
                     LET g_errparam.code = g_errno
                     LET g_errparam.extend = l_msg
                     LET g_errparam.popup = TRUE
                     CALL cl_err()

                     LET g_pmaa_m.pmaa295 = g_pmaa_m_o.pmaa295
                     CALL adbm201_pmaa295_ref()
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL adbm201_pmaa295_ref()
            LET g_pmaa_m_o.pmaa295 = g_pmaa_m.pmaa295
]]>
  </point>
  <point name="input.a.pmaa296" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_pmaa_m.pmaa296_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmaa296_desc
            IF NOT cl_null(g_pmaa_m.pmaa296) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmaa296 != g_pmaa_m_o.pmaa296 OR g_pmaa_m_o.pmaa296 IS NULL )) THEN
                  CALL adbm201_chk_acc_code('2066',g_pmaa_m.pmaa296)
                  IF NOT cl_null(g_errno) THEN
                     LET l_msg = cl_getmsg('art-00005',g_dlang)
                     LET l_msg = cl_replace_str(l_msg,"%1","2066")
                     LET l_msg = cl_replace_str(l_msg,"%2",g_pmaa_m.pmaa296)
                     INITIALIZE g_errparam TO NULL
                     LET g_errparam.code = g_errno
                     LET g_errparam.extend = l_msg
                     LET g_errparam.popup = TRUE
                     CALL cl_err()

                     LET g_pmaa_m.pmaa296 = g_pmaa_m_o.pmaa296
                     CALL adbm201_pmaa296_ref()
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL adbm201_pmaa296_ref()
            LET g_pmaa_m_o.pmaa296 = g_pmaa_m.pmaa296
]]>
  </point>
  <point name="input.a.pmaa297" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_pmaa_m.pmaa297_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmaa297_desc
            IF NOT cl_null(g_pmaa_m.pmaa297) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmaa297 != g_pmaa_m_o.pmaa297 OR g_pmaa_m_o.pmaa297 IS NULL )) THEN
                  CALL adbm201_chk_acc_code('2067',g_pmaa_m.pmaa297)
                  IF NOT cl_null(g_errno) THEN
                     LET l_msg = cl_getmsg('art-00005',g_dlang)
                     LET l_msg = cl_replace_str(l_msg,"%1","2067")
                     LET l_msg = cl_replace_str(l_msg,"%2",g_pmaa_m.pmaa297)
                     INITIALIZE g_errparam TO NULL
                     LET g_errparam.code = g_errno
                     LET g_errparam.extend = l_msg
                     LET g_errparam.popup = TRUE
                     CALL cl_err()

                     LET g_pmaa_m.pmaa297 = g_pmaa_m_o.pmaa297
                     CALL adbm201_pmaa297_ref()
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL adbm201_pmaa297_ref()
            LET g_pmaa_m_o.pmaa297 = g_pmaa_m.pmaa297
]]>
  </point>
  <point name="input.a.pmaa298" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_pmaa_m.pmaa298_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmaa298_desc
            IF NOT cl_null(g_pmaa_m.pmaa298) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmaa298 != g_pmaa_m_o.pmaa298 OR g_pmaa_m_o.pmaa298 IS NULL )) THEN
                  CALL adbm201_chk_acc_code('2068',g_pmaa_m.pmaa298)
                  IF NOT cl_null(g_errno) THEN
                     LET l_msg = cl_getmsg('art-00005',g_dlang)
                     LET l_msg = cl_replace_str(l_msg,"%1","2068")
                     LET l_msg = cl_replace_str(l_msg,"%2",g_pmaa_m.pmaa298)
                     INITIALIZE g_errparam TO NULL
                     LET g_errparam.code = g_errno
                     LET g_errparam.extend = l_msg
                     LET g_errparam.popup = TRUE
                     CALL cl_err()

                     LET g_pmaa_m.pmaa298 = g_pmaa_m_o.pmaa298
                     CALL adbm201_pmaa298_ref()
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL adbm201_pmaa298_ref()
            LET g_pmaa_m_o.pmaa298 = g_pmaa_m.pmaa298
]]>
  </point>
  <point name="input.a.pmaa299" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_pmaa_m.pmaa299_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmaa299_desc
            IF NOT cl_null(g_pmaa_m.pmaa299) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmaa299 != g_pmaa_m_o.pmaa299 OR g_pmaa_m_o.pmaa299 IS NULL )) THEN
                  CALL adbm201_chk_acc_code('2069',g_pmaa_m.pmaa299)
                  IF NOT cl_null(g_errno) THEN
                     LET l_msg = cl_getmsg('art-00005',g_dlang)
                     LET l_msg = cl_replace_str(l_msg,"%1","2069")
                     LET l_msg = cl_replace_str(l_msg,"%2",g_pmaa_m.pmaa299)
                     INITIALIZE g_errparam TO NULL
                     LET g_errparam.code = g_errno
                     LET g_errparam.extend = l_msg
                     LET g_errparam.popup = TRUE
                     CALL cl_err()

                     LET g_pmaa_m.pmaa299 = g_pmaa_m_o.pmaa299
                     CALL adbm201_pmaa299_ref()
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL adbm201_pmaa299_ref()
            LET g_pmaa_m_o.pmaa299 = g_pmaa_m.pmaa299
]]>
  </point>
  <point name="input.a.pmaa300" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_pmaa_m.pmaa300_desc = ' '
            DISPLAY BY NAME g_pmaa_m.pmaa300_desc
            IF NOT cl_null(g_pmaa_m.pmaa300) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmaa_m.pmaa300 != g_pmaa_m_o.pmaa293 OR g_pmaa_m_o.pmaa293 IS NULL )) THEN
                  CALL adbm201_chk_acc_code('2070',g_pmaa_m.pmaa300)
                  IF NOT cl_null(g_errno) THEN
                     LET l_msg = cl_getmsg('art-00005',g_dlang)
                     LET l_msg = cl_replace_str(l_msg,"%1","2070")
                     LET l_msg = cl_replace_str(l_msg,"%2",g_pmaa_m.pmaa300)
                     INITIALIZE g_errparam TO NULL
                     LET g_errparam.code = g_errno
                     LET g_errparam.extend = l_msg
                     LET g_errparam.popup = TRUE
                     CALL cl_err()

                     LET g_pmaa_m.pmaa300 = g_pmaa_m_o.pmaa300
                     CALL adbm201_pmaa300_ref()
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL adbm201_pmaa300_ref()
            LET g_pmaa_m_o.pmaa300 = g_pmaa_m.pmaa300
]]>
  </point>
  <point name="input.a.pmaal003" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.a.pmaal004" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.a.pmaal005" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.a.pmaastus" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.after_input" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   ]]>
  </point>
  <point name="input.after_set_entry" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   ]]>
  </point>
  <point name="input.b.ooff013" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.b.pmaa001" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #IF cl_null(g_pmaa_m.pmaa001) THEN
            #   CALL s_aooi390('2') RETURNING l_success,g_pmaa_m.pmaa001
            #   DISPLAY BY NAME g_pmaa_m.pmaa001
            #   NEXT FIELD pmaa001
            #END IF]]>
  </point>
  <point name="input.b.pmaa004" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.b.pmaa005" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.b.pmaa006" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.b.pmaa016" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.b.pmaa017" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.b.pmaa018" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.b.pmaa019" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.b.pmaa020" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.b.pmaa021" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.b.pmaa022" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.b.pmaa026" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.b.pmaa027" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.b.pmaa090" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.b.pmaa095" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.b.pmaa200" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.b.pmaa201" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.b.pmaa221" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.b.pmaa232" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.b.pmaa291" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.b.pmaa292" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.b.pmaa293" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.b.pmaa294" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.b.pmaa295" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.b.pmaa296" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.b.pmaa297" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.b.pmaa298" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.b.pmaa299" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.b.pmaa300" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.b.pmaal003" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.b.pmaal004" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.b.pmaal005" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.b.pmaastus" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.before.input" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.before_input" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[      LET g_forupd_sql = "SELECT oofb001,oofbstus,oofb008,oofb009,'',oofb010,oofb019,",
                      "       oofb011,oofb012,'',oofb013,oofb014,'',oofb015,'',oofb016,'',",
                      "       oofb017,oofb018 ",
                      "  FROM oofb_t",
                      " WHERE oofbent=? AND oofb001=? AND oofb002=? FOR UPDATE"
   LET g_forupd_sql = cl_sql_forupd(g_forupd_sql)
   DECLARE adbm201_bcl1 CURSOR FROM g_forupd_sql

   LET g_forupd_sql = "SELECT oofc001,oofcstus,oofc008,oofc009,'',oofc010,oofc014,",
                      "       oofc011,oofc012,oofc013",
                      "  FROM oofc_t",
                      " WHERE oofcent=? AND oofc001=? AND oofc002=? FOR UPDATE"
   LET g_forupd_sql = cl_sql_forupd(g_forupd_sql)
   DECLARE adbm201_bcl2 CURSOR FROM g_forupd_sql  
   
   LET l_allow_insert = cl_auth_detail_input("insert")
   LET l_allow_delete = cl_auth_detail_input("delete")]]>
  </point>
  <point name="input.c.ooff013" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.c.pmaa001" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.c.pmaa004" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.c.pmaa005" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_pmaa_m.pmaa005             #給予default值

            #給予arg
            LET g_qryparam.arg1 = '1'
            CALL q_ooed004_2()                                #呼叫開窗

            LET g_pmaa_m.pmaa005 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_pmaa_m.pmaa005 TO pmaa005              #顯示到畫面上
            CALL adbm201_pmaa005_ref()
            NEXT FIELD pmaa005                          #返回原欄位

]]>
  </point>
  <point name="input.c.pmaa006" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_pmaa_m.pmaa006             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "1" #客戶性質
            LET g_qryparam.arg2 = "2" #客戶經營類別

            CALL q_pmaa001_3()                                #呼叫開窗

            LET g_pmaa_m.pmaa006 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_pmaa_m.pmaa006 TO pmaa006              #顯示到畫面上
            CALL adbm201_pmaa006_ref()
            NEXT FIELD pmaa006                          #返回原欄位

]]>
  </point>
  <point name="input.c.pmaa016" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.c.pmaa017" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.c.pmaa018" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.c.pmaa019" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_pmaa_m.pmaa019             #給予default值

            #給予arg
            LET g_qryparam.arg1 = g_site #營運據點

            CALL q_ooaj002_1()                                #呼叫開窗

            LET g_pmaa_m.pmaa019 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_pmaa_m.pmaa019 TO pmaa019              #顯示到畫面上
            CALL adbm201_pmaa019_ref()
            NEXT FIELD pmaa019                          #返回原欄位

]]>
  </point>
  <point name="input.c.pmaa020" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.c.pmaa021" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.c.pmaa022" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_pmaa_m.pmaa022             #給予default值

            #給予arg
            LET g_qryparam.arg1 = g_site #營運據點

            CALL q_ooaj002_1()                                #呼叫開窗

            LET g_pmaa_m.pmaa022 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_pmaa_m.pmaa022 TO pmaa022              #顯示到畫面上
            CALL adbm201_pmaa022_ref()
            NEXT FIELD pmaa022                          #返回原欄位

]]>
  </point>
  <point name="input.c.pmaa026" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_pmaa_m.pmaa026             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "250" #

            CALL q_oocq002()                                #呼叫開窗

            LET g_pmaa_m.pmaa026 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_pmaa_m.pmaa026 TO pmaa026              #顯示到畫面上
            CALL adbm201_pmaa026_ref()
            NEXT FIELD pmaa026                          #返回原欄位

]]>
  </point>
  <point name="input.c.pmaa027" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.c.pmaa090" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_pmaa_m.pmaa090             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "281" #

            CALL q_oocq002()                                #呼叫開窗

            LET g_pmaa_m.pmaa090 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_pmaa_m.pmaa090 TO pmaa090              #顯示到畫面上
            CALL adbm201_pmaa090_ref()
            NEXT FIELD pmaa090                          #返回原欄位

]]>
  </point>
  <point name="input.c.pmaa095" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_pmaa_m.pmaa095             #給予default值

            #給予arg
            LET g_qryparam.arg1 = g_site
            LET g_qryparam.arg2 = '2'
            CALL q_ooed004()                                #呼叫開窗

            LET g_pmaa_m.pmaa095 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_pmaa_m.pmaa095 TO pmaa095              #顯示到畫面上
            CALL adbm201_pmaa095_ref()
            NEXT FIELD pmaa095                          #返回原欄位

]]>
  </point>
  <point name="input.c.pmaa200" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.c.pmaa201" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.c.pmaa221" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_pmaa_m.pmaa221             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "2073" #

            CALL q_oocq002()                                #呼叫開窗

            LET g_pmaa_m.pmaa221 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_pmaa_m.pmaa221 TO pmaa221              #顯示到畫面上
            CALL adbm201_pmaa221_ref()
            NEXT FIELD pmaa221                          #返回原欄位

]]>
  </point>
  <point name="input.c.pmaa232" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_pmaa_m.pmaa232             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "2072" #

            CALL q_oocq002()                                #呼叫開窗

            LET g_pmaa_m.pmaa232 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_pmaa_m.pmaa232 TO pmaa232              #顯示到畫面上
            CALL adbm201_pmaa232_ref()
            NEXT FIELD pmaa232                          #返回原欄位

]]>
  </point>
  <point name="input.c.pmaa291" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_pmaa_m.pmaa291             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "2061" #

            CALL q_oocq002()                                #呼叫開窗

            LET g_pmaa_m.pmaa291 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_pmaa_m.pmaa291 TO pmaa291              #顯示到畫面上
            CALL adbm201_pmaa291_ref()
            NEXT FIELD pmaa291                          #返回原欄位

]]>
  </point>
  <point name="input.c.pmaa292" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_pmaa_m.pmaa292             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "2062" #

            CALL q_oocq002()                                #呼叫開窗

            LET g_pmaa_m.pmaa292 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_pmaa_m.pmaa292 TO pmaa292              #顯示到畫面上
            CALL adbm201_pmaa292_ref()
            NEXT FIELD pmaa292                          #返回原欄位

]]>
  </point>
  <point name="input.c.pmaa293" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_pmaa_m.pmaa293             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "2063" #

            CALL q_oocq002()                                #呼叫開窗

            LET g_pmaa_m.pmaa293 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_pmaa_m.pmaa293 TO pmaa293              #顯示到畫面上
            CALL adbm201_pmaa293_ref()
            NEXT FIELD pmaa293                          #返回原欄位

]]>
  </point>
  <point name="input.c.pmaa294" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_pmaa_m.pmaa294             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "2064" #

            CALL q_oocq002()                                #呼叫開窗

            LET g_pmaa_m.pmaa294 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_pmaa_m.pmaa294 TO pmaa294              #顯示到畫面上
            CALL adbm201_pmaa294_ref()
            NEXT FIELD pmaa294                          #返回原欄位

]]>
  </point>
  <point name="input.c.pmaa295" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_pmaa_m.pmaa295             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "2065" #

            CALL q_oocq002()                                #呼叫開窗

            LET g_pmaa_m.pmaa295 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_pmaa_m.pmaa295 TO pmaa295              #顯示到畫面上
            CALL adbm201_pmaa295_ref()
            NEXT FIELD pmaa295                          #返回原欄位

]]>
  </point>
  <point name="input.c.pmaa296" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_pmaa_m.pmaa296             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "2066" #

            CALL q_oocq002()                                #呼叫開窗

            LET g_pmaa_m.pmaa296 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_pmaa_m.pmaa296 TO pmaa296              #顯示到畫面上
            CALL adbm201_pmaa296_ref()
            NEXT FIELD pmaa296                          #返回原欄位

]]>
  </point>
  <point name="input.c.pmaa297" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_pmaa_m.pmaa297             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "2067" #

            CALL q_oocq002()                                #呼叫開窗

            LET g_pmaa_m.pmaa297 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_pmaa_m.pmaa297 TO pmaa297              #顯示到畫面上
            CALL adbm201_pmaa297_ref()
            NEXT FIELD pmaa297                          #返回原欄位

]]>
  </point>
  <point name="input.c.pmaa298" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_pmaa_m.pmaa298             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "2068" #

            CALL q_oocq002()                                #呼叫開窗

            LET g_pmaa_m.pmaa298 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_pmaa_m.pmaa298 TO pmaa298              #顯示到畫面上
            CALL adbm201_pmaa298_ref()
            NEXT FIELD pmaa298                          #返回原欄位

]]>
  </point>
  <point name="input.c.pmaa299" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_pmaa_m.pmaa299             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "2069" #

            CALL q_oocq002()                                #呼叫開窗

            LET g_pmaa_m.pmaa299 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_pmaa_m.pmaa299 TO pmaa299              #顯示到畫面上
            CALL adbm201_pmaa299_ref()
            NEXT FIELD pmaa299                          #返回原欄位

]]>
  </point>
  <point name="input.c.pmaa300" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_pmaa_m.pmaa300             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "2070" #

            CALL q_oocq002()                                #呼叫開窗

            LET g_pmaa_m.pmaa300 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_pmaa_m.pmaa300 TO pmaa300              #顯示到畫面上
            CALL adbm201_pmaa300_ref()
            NEXT FIELD pmaa300                          #返回原欄位

]]>
  </point>
  <point name="input.c.pmaal003" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.c.pmaal004" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.c.pmaal005" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.c.pmaastus" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.define" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   DEFINE l_msg                  STRING
   DEFINE l_success              LIKE type_t.num5
   DEFINE l_cmd                  LIKE type_t.chr1
   DEFINE g_insert               LIKE type_t.chr5              #是否導到其他page
   DEFINE gs_keys                DYNAMIC ARRAY OF VARCHAR(500) #同步資料用陣列
   DEFINE gs_keys_bak            DYNAMIC ARRAY OF VARCHAR(500) #同步資料用陣列
   DEFINE lb_reproduce           BOOLEAN
   DEFINE li_reproduce           LIKE type_t.num5
   DEFINE li_reproduce_target    LIKE type_t.num5
   DEFINE l_wc                   STRING]]>
  </point>
  <point name="input.g.ooff013" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.g.pmaa001" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.g.pmaa004" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.g.pmaa005" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.g.pmaa006" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.g.pmaa016" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.g.pmaa017" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.g.pmaa018" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.g.pmaa019" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.g.pmaa020" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.g.pmaa021" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.g.pmaa022" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.g.pmaa026" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.g.pmaa027" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.g.pmaa090" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.g.pmaa095" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.g.pmaa200" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.g.pmaa201" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.g.pmaa221" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.g.pmaa232" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.g.pmaa291" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.g.pmaa292" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.g.pmaa293" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.g.pmaa294" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.g.pmaa295" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.g.pmaa296" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.g.pmaa297" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.g.pmaa298" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.g.pmaa299" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.g.pmaa300" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.g.pmaal003" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.g.pmaal004" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.g.pmaal005" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.g.pmaastus" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.head.a_insert" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                  INSERT INTO ooff_t(ooffent,ooff001,ooff002,ooff003,ooff004,
                                     ooff005,ooff006,ooff007,ooff008,ooff009,
                                     ooff010,ooff011,ooff012,ooff013 )
                  VALUES(g_enterprise,'99',g_prog,g_pmaa_m.pmaa001,
                         ' ',' ',' ',' ',' ',' ',' ',' ','4',g_pmaa_m.ooff013 )
                  IF SQLCA.sqlcode THEN
                     INITIALIZE g_errparam TO NULL
                     LET g_errparam.code = SQLCA.sqlcode
                     LET g_errparam.extend = "ins ooff_t"
                     LET g_errparam.popup = TRUE
                     CALL cl_err()

                     CALL s_transaction_end('N','0')
                     CONTINUE DIALOG
                  END IF
                  
                  #更新ooff_t 備註
                  IF NOT cl_null(g_pmaa_m.pmaa001) THEN
                     IF NOT cl_null(g_pmaa_m.ooff013) THEN
                        LET l_success = ''
                        CALL s_aooi360_gen('99',g_prog,g_pmaa_m.pmaa001,'','','','','','','','','4',g_pmaa_m.ooff013) RETURNING l_success
                        IF NOT l_success THEN
                           INITIALIZE g_errparam TO NULL
                           LET g_errparam.code = SQLCA.sqlcode
                           LET g_errparam.extend = "ooff_t"
                           LET g_errparam.popup = TRUE
                           CALL cl_err()

                           CONTINUE DIALOG
                        END IF
                     ELSE
                        CALL s_aooi360_del('99',g_prog,g_pmaa_m.pmaa001,'','','','','','','','','4') RETURNING l_success
                        IF NOT l_success THEN
                           INITIALIZE g_errparam TO NULL
                           LET g_errparam.code = SQLCA.sqlcode
                           LET g_errparam.extend = "ooff_t"
                           LET g_errparam.popup = TRUE
                           CALL cl_err()

                           CONTINUE DIALOG
                        END IF
                     END IF
                  END IF]]>
  </point>
  <point name="input.head.a_update" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                     #更新ooff_t 備註
                     IF NOT cl_null(g_pmaa_m.pmaa001) THEN
                        IF NOT cl_null(g_pmaa_m.ooff013) THEN
                           LET l_success = ''
                           CALL s_aooi360_gen('99',g_prog,g_pmaa_m.pmaa001,'','','','','','','','','4',g_pmaa_m.ooff013) RETURNING l_success
                           IF NOT l_success THEN
                              INITIALIZE g_errparam TO NULL
                              LET g_errparam.code = SQLCA.sqlcode
                              LET g_errparam.extend = "ooff_t"
                              LET g_errparam.popup = TRUE
                              CALL cl_err()

                              CALL s_transaction_end('N','0')
                              CONTINUE DIALOG
                           END IF
                        ELSE
                           CALL s_aooi360_del('99',g_prog,g_pmaa_m.pmaa001,'','','','','','','','','4') RETURNING l_success
                           IF NOT l_success THEN
                              INITIALIZE g_errparam TO NULL
                              LET g_errparam.code = SQLCA.sqlcode
                              LET g_errparam.extend = "ooff_t"
                              LET g_errparam.popup = TRUE
                              CALL cl_err()

                              CALL s_transaction_end('N','0')
                              CONTINUE DIALOG
                           END IF
                        END IF
                     END IF  ]]>
  </point>
  <point name="input.head.b_insert" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                  CALL s_transaction_begin()
                  CALL s_aooi350_ins_oofa('3',g_pmaa_m.pmaa001,'') RETURNING l_success,g_pmaa_m.pmaa027
                  IF NOT l_success THEN
                     INITIALIZE g_errparam TO NULL
                     LET g_errparam.code = SQLCA.sqlcode
                     LET g_errparam.extend = "oofa_t"
                     LET g_errparam.popup = TRUE
                     CALL cl_err()

                     NEXT FIELD pmaa001
                  END IF]]>
  </point>
  <point name="input.head.b_update" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[               ]]>
  </point>
  <point name="input.head.m_insert" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                  ]]>
  </point>
  <point name="input.head.m_update" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[               ]]>
  </point>
  <point name="input.master_input.update_item" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        IF NOT cl_null(g_pmaa_m.pmaa001)  THEN
               CALL n_pmaal(g_pmaa_m.pmaa001)
               INITIALIZE g_ref_fields TO NULL
               LET g_ref_fields[1] = g_pmaa_m.pmaa001
               CALL ap_ref_array2(g_ref_fields," SELECT pmaal003,pmaal004,pmaal005 FROM pmaal_t WHERE pmaalent = '"||g_enterprise||"' AND pmaal001 = ? AND pmaal002 = '"||g_dlang||"'","") RETURNING g_rtn_fields 
               LET g_pmaa_m.pmaal003 = g_rtn_fields[1] 
               LET g_pmaa_m.pmaal004 = g_rtn_fields[2] 
               LET g_pmaa_m.pmaal005 = g_rtn_fields[3] 
               DISPLAY BY NAME g_pmaa_m.pmaal003,g_pmaa_m.pmaal004,g_pmaa_m.pmaal005
            END IF  ]]>
  </point>
  <point name="input.more_input" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[      INPUT ARRAY g_pmbg1_d FROM s_detail1.*
         ATTRIBUTE(COUNT = g_rec_b1,MAXCOUNT = g_max_rec,WITHOUT DEFAULTS, 
                 INSERT ROW = l_allow_insert, #此頁面insert功能由產生器控制, 手動之設定無效! 
                 DELETE ROW = l_allow_delete,
                 APPEND ROW = l_allow_insert)
         
         BEFORE INPUT
            IF g_insert = 'Y' AND NOT cl_null(g_insert) THEN 
               CALL FGL_SET_ARR_CURR(g_pmbg1_d.getLength()+1) 
               LET g_insert = 'N' 
            END IF 
 
            CALL adbm201_b_fill()
            LET g_rec_b1 = g_pmbg1_d.getLength()
            
         BEFORE INSERT            
            LET l_insert = TRUE
            LET l_n = ARR_COUNT()
            LET l_cmd = 'a'
            INITIALIZE g_pmbg1_d[l_ac].* TO NULL 
            LET g_pmbg1_d[l_ac].oofbstus = "Y"
            LET g_pmbg1_d[l_ac].oofb008 = "1"
            LET g_pmbg1_d[l_ac].oofb010 = "N"
            LET g_pmbg1_d_t.* = g_pmbg1_d[l_ac].*  #新輸入資料
            LET g_pmbg1_d_o.* = g_pmbg1_d[l_ac].*  #BACKUP
            CALL cl_show_fld_cont()
            #CALL adbm201_set_entry_b(l_cmd)
            #CALL adbm201_set_no_entry_b(l_cmd)
            IF lb_reproduce THEN
               LET lb_reproduce = FALSE
               LET g_pmbg1_d[li_reproduce_target].* = g_pmbg1_d[li_reproduce].*
               LET g_pmbg1_d[li_reproduce_target].oofb001 = NULL
            END IF
            
         BEFORE ROW     
            LET l_insert = FALSE
            LET l_cmd = ''
            LET l_ac = ARR_CURR()
            LET g_detail_idx = l_ac
              
            LET l_lock_sw = 'N'            #DEFAULT
            LET l_n = ARR_COUNT()
         
            CALL s_transaction_begin()
            OPEN adbm201_cl USING g_enterprise,g_pmaa_m.pmaa001
            IF STATUS THEN
               INITIALIZE g_errparam TO NULL
               LET g_errparam.code =  STATUS
               LET g_errparam.extend = "OPEN adbm201_cl:"
               LET g_errparam.popup = TRUE
               CALL cl_err()

               CLOSE adbm201_cl
               CALL s_transaction_end('N','0')
               RETURN
            END IF
            
            LET g_rec_b1 = g_pmbg1_d.getLength()
            
            IF g_rec_b1 >= l_ac 
               AND g_pmbg1_d[l_ac].oofb001 IS NOT NULL
            THEN 
               LET l_cmd='u'
               LET g_pmbg1_d_t.* = g_pmbg1_d[l_ac].*  #BACKUP
               LET g_pmbg1_d_o.* = g_pmbg1_d[l_ac].*  #BACKUP
               #CALL adbm201_set_entry_b(l_cmd)
               #CALL adbm201_set_no_entry_b(l_cmd)
               IF NOT adbm201_lock_b("oofb_t","'1'") THEN
                  LET l_lock_sw='Y'
               ELSE
                  FETCH adbm201_bcl1 INTO g_pmbg1_d[l_ac].oofb001,g_pmbg1_d[l_ac].oofbstus,
                            g_pmbg1_d[l_ac].oofb008,g_pmbg1_d[l_ac].oofb009,
                            g_pmbg1_d[l_ac].oofb009_desc, g_pmbg1_d[l_ac].oofb010, g_pmbg1_d[l_ac].oofb019, 
                            g_pmbg1_d[l_ac].oofb011, g_pmbg1_d[l_ac].oofb012, g_pmbg1_d[l_ac].oofb012_desc, 
                            g_pmbg1_d[l_ac].oofb013, g_pmbg1_d[l_ac].oofb014, g_pmbg1_d[l_ac].oofb014_desc, 
                            g_pmbg1_d[l_ac].oofb015, g_pmbg1_d[l_ac].oofb015_desc, g_pmbg1_d[l_ac].oofb016, 
                            g_pmbg1_d[l_ac].oofb016_desc, g_pmbg1_d[l_ac].oofb017, g_pmbg1_d[l_ac].oofb018  

                  IF SQLCA.sqlcode THEN
                     INITIALIZE g_errparam TO NULL
                     LET g_errparam.code = SQLCA.sqlcode
                     LET g_errparam.extend = ''
                     LET g_errparam.popup = TRUE
                     CALL cl_err()

                     LET l_lock_sw = "Y"
                  END IF
                  
                  LET g_bfill = "N"
                  CALL adbm201_show()
                  LET g_bfill = "Y"
                  
                  CALL cl_show_fld_cont()
               END IF
            ELSE
               LET l_cmd='a'
            END IF
            
            
         BEFORE DELETE                            #是否取消單身
            IF l_cmd = 'a' THEN
               CALL FGL_SET_ARR_CURR(l_ac-1)
               CALL g_pmbg1_d.deleteElement(l_ac)
               NEXT FIELD oofbstus
            END IF
         
            IF g_pmbg1_d[l_ac].oofb001 IS NOT NULL
 
            THEN
               IF NOT cl_ask_del_detail() THEN
                  CANCEL DELETE
               END IF
               IF l_lock_sw = "Y" THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code =  -263
                  LET g_errparam.extend = ""
                  LET g_errparam.popup = TRUE
                  CALL cl_err()

                  CANCEL DELETE
               END IF
               
               DELETE FROM oofb_t
                WHERE oofbent = g_enterprise 
                  AND oofb001 = g_pmbg1_d_t.oofb001
                  AND oofb002 = g_pmaa_m.pmaa027
                  
               IF SQLCA.sqlcode THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = SQLCA.sqlcode
                  LET g_errparam.extend = "oofb_t"
                  LET g_errparam.popup = TRUE
                  CALL cl_err()

                  CALL s_transaction_end('N','0')
                  CANCEL DELETE   
               ELSE
                  LET g_rec_b1 = g_rec_b1-1
                  CALL s_transaction_end('Y','0')
               END IF 
               CLOSE adbm201_bcl1
            END IF 
            
            INITIALIZE gs_keys TO NULL 
            LET gs_keys[1] = g_pmbg1_d_t.oofb001
            LET gs_keys[2] = g_pmaa_m.pmaa027
 
            
         AFTER DELETE 
            CALL adbm201_delete_b('oofb_t',gs_keys,"'1'")
 
         AFTER INSERT    
            LET l_insert = FALSE
            IF INT_FLAG THEN
               INITIALIZE g_errparam TO NULL
               LET g_errparam.code = 9001
               LET g_errparam.extend = ''
               LET g_errparam.popup = FALSE
               CALL cl_err()

               LET INT_FLAG = 0
               CANCEL INSERT
            END IF
               
            LET l_wc = " oofbent = ",g_enterprise
            CALL s_aooi350_get_idno('oofb001','oofb_t',l_wc)
               RETURNING l_success,g_pmbg1_d[l_ac].oofb001
            IF NOT l_success THEN
               CALL s_transaction_end('N','0')                    
               CANCEL INSERT
            END IF

            LET l_count = 1  
            SELECT COUNT(*) INTO l_count
              FROM oofb_t 
             WHERE oofbent = g_enterprise 
               AND oofb001 = g_pmbg1_d[l_ac].oofb001
               AND oofb002 = g_pmaa_m.pmaa027
 
                
            #資料未重複, 插入新增資料
            IF l_count = 0 THEN 
               INITIALIZE gs_keys TO NULL 
               LET gs_keys[1] = g_pmbg1_d[l_ac].oofb001
               LET gs_keys[2] = g_pmaa_m.pmaa027
               CALL adbm201_insert_b('oofb_t',gs_keys,"'1'")
            ELSE    
               INITIALIZE g_errparam TO NULL
               LET g_errparam.code = "std-00006"
               LET g_errparam.extend = 'INSERT'
               LET g_errparam.popup = TRUE
               CALL cl_err()

               INITIALIZE g_pmbg1_d[l_ac].* TO NULL
               CALL s_transaction_end('N','0')
               CANCEL INSERT
            END IF
 
            IF SQLCA.SQLcode  THEN
               INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = SQLCA.sqlcode
                  LET g_errparam.extend = "oofb_t"
                  LET g_errparam.popup = TRUE
                  CALL cl_err()
  
               CALL s_transaction_end('N','0')                    
               CANCEL INSERT
            ELSE
               CALL s_transaction_end('Y','0')
               ERROR 'INSERT O.K'
               LET g_rec_b1 = g_rec_b1 + 1
            END IF
            
         ON ROW CHANGE 
            IF INT_FLAG THEN
               INITIALIZE g_errparam TO NULL
               LET g_errparam.code = 9001
               LET g_errparam.extend = ''
               LET g_errparam.popup = FALSE
               CALL cl_err()

               LET INT_FLAG = 0
               LET g_pmbg1_d[l_ac].* = g_pmbg1_d_t.*
               CLOSE adbm201_bcl1
               CALL s_transaction_end('N','0')
               EXIT DIALOG 
            END IF
            
            IF l_lock_sw = 'Y' THEN
               INITIALIZE g_errparam TO NULL
               LET g_errparam.code = -263
               LET g_errparam.extend = ''
               LET g_errparam.popup = TRUE
               CALL cl_err()

               LET g_pmbg1_d[l_ac].* = g_pmbg1_d_t.*
            ELSE
 
               
               UPDATE oofb_t SET (oofbstus,oofb008,oofb009, oofb010,oofb019,oofb011,
                                   oofb012,oofb013,oofb014, oofb015,oofb016,oofb017,
                                   oofb018)
                         = (g_pmbg1_d[l_ac].oofbstus,g_pmbg1_d[l_ac].oofb008,g_pmbg1_d[l_ac].oofb009,
                            g_pmbg1_d[l_ac].oofb010, g_pmbg1_d[l_ac].oofb019,g_pmbg1_d[l_ac].oofb011,
                            g_pmbg1_d[l_ac].oofb012, g_pmbg1_d[l_ac].oofb013,g_pmbg1_d[l_ac].oofb014,
                            g_pmbg1_d[l_ac].oofb015, g_pmbg1_d[l_ac].oofb016,g_pmbg1_d[l_ac].oofb017, 
                            g_pmbg1_d[l_ac].oofb018)
                WHERE oofbent = g_enterprise 
                  AND oofb001 = g_pmbg1_d_t.oofb001 
                  AND oofb002 = g_pmaa_m.pmaa027
                  
               CASE
                  WHEN SQLCA.sqlerrd[3] = 0  #更新不到的處理
                     INITIALIZE g_errparam TO NULL
                     LET g_errparam.code = "std-00009"
                     LET g_errparam.extend = "oofb_t"
                     LET g_errparam.popup = TRUE
                     CALL cl_err()

                     CALL s_transaction_end('N','0')
                     LET g_pmbg1_d[l_ac].* = g_pmbg1_d_t.*
                  WHEN SQLCA.sqlcode #其他錯誤
                     INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = SQLCA.sqlcode
                  LET g_errparam.extend = "oofb_t"
                  LET g_errparam.popup = TRUE
                  CALL cl_err()
  
                     CALL s_transaction_end('N','0')
                     LET g_pmbg1_d[l_ac].* = g_pmbg1_d_t.*
                  OTHERWISE
                     INITIALIZE gs_keys TO NULL 
                     LET gs_keys[1] = g_pmbg1_d[l_ac].oofb001
                     LET gs_keys_bak[1] = g_pmbg1_d_t.oofb001
                     LET gs_keys[2] = g_pmaa_m.pmaa027
                     LET gs_keys_bak[2] = g_pmaa_m.pmaa027
                     CALL adbm201_update_b('oofb_t',gs_keys,gs_keys_bak,"'1'")
               END CASE
            END IF
 
 
         AFTER FIELD oofb009
            LET g_pmbg1_d[l_ac].oofb009_desc = ' '
            DISPLAY BY NAME g_pmbg1_d[l_ac].oofb009_desc
            IF NOT cl_null(g_pmbg1_d[l_ac].oofb009) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmbg1_d[l_ac].oofb009 != g_pmbg1_d_t.oofb009 OR g_pmbg1_d_t.oofb009 IS NULL )) THEN
                  CALL adbm201_chk_acc_code('1',g_pmbg1_d[l_ac].oofb009)
                  IF NOT cl_null(g_errno) THEN
                     LET l_msg = cl_getmsg('art-00005',g_dlang)
                     LET l_msg = cl_replace_str(l_msg,"%1","1")
                     LET l_msg = cl_replace_str(l_msg,"%2",g_pmbg1_d[l_ac].oofb009)
                     INITIALIZE g_errparam TO NULL
                     LET g_errparam.code = g_errno
                     LET g_errparam.extend = l_msg
                     LET g_errparam.popup = TRUE
                     CALL cl_err()

                     LET g_pmbg1_d[l_ac].oofb009 = g_pmbg1_d_t.oofb009
                     CALL adbm201_oofb009_ref()
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL adbm201_oofb009_ref()
            
         ON ACTION controlp INFIELD oofb009
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_pmbg1_d[l_ac].oofb009 #給予default值
            #給予arg
            LET g_qryparam.arg1 = "1"  
            CALL q_oocq002()                                  #呼叫開窗
            LET g_pmbg1_d[l_ac].oofb009 = g_qryparam.return1  #將開窗取得的值回傳到變數
            DISPLAY g_pmbg1_d[l_ac].oofb009 TO oofb009        #顯示到畫面上
            CALL adbm201_oofb009_ref()
            NEXT FIELD oofb009                                #返回原欄位
            
         ON CHANGE oofb010
            IF g_pmbg1_d[l_ac].oofb010 = 'Y' THEN
               LET l_cnt = 0 
               IF cl_null(g_pmbg1_d_t.oofb001) THEN
                  SELECT COUNT(*) INTO l_cnt FROM oofb_t
                   WHERE oofbent = g_enterprise
                     AND oofb002 = g_pmaa_m.pmaa027
                     AND oofb010 = 'Y'
                     AND oofb008 = g_pmbg1_d[l_ac].oofb008
               ELSE
                  SELECT COUNT(*) INTO l_cnt FROM oofb_t
                   WHERE oofbent = g_enterprise
                     AND oofb002 = g_pmaa_m.pmaa027
                     AND oofb008 = g_pmbg1_d[l_ac].oofb008
                     AND oofb010 = 'Y'
                     AND oofb001 != g_pmbg1_d_t.oofb001
               END IF
               IF l_cnt > 0 THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = 'aoo-00156'
                  LET g_errparam.extend = ''
                  LET g_errparam.popup = TRUE
                  CALL cl_err()

                  LET g_pmbg1_d[l_ac].oofb010 = g_pmbg1_d_t.oofb010
                  NEXT FIELD CURRENT
               END IF
            END IF
            
         AFTER FIELD oofb008 
            LET g_pmbg1_d_o.oofb008 = g_pmbg1_d[l_ac].oofb008 
            
         ON CHANGE oofb008
            IF g_pmbg1_d[l_ac].oofb010 = 'Y' THEN
               LET l_cnt = 0 
               IF cl_null(g_pmbg1_d_t.oofb001) THEN
                  SELECT COUNT(*) INTO l_cnt FROM oofb_t
                   WHERE oofbent = g_enterprise
                     AND oofb002 = g_pmaa_m.pmaa027
                     AND oofb010 = 'Y'
                     AND oofb008 = g_pmbg1_d[l_ac].oofb008
               ELSE
                  SELECT COUNT(*) INTO l_cnt FROM oofb_t
                   WHERE oofbent = g_enterprise
                     AND oofb002 = g_pmaa_m.pmaa027
                     AND oofb008 = g_pmbg1_d[l_ac].oofb008
                     AND oofb010 = 'Y'
                     AND oofb001 != g_pmbg1_d_t.oofb001
               END IF
               IF l_cnt > 0 THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = 'aoo-00156'
                  LET g_errparam.extend = ''
                  LET g_errparam.popup = TRUE
                  CALL cl_err()

                  LET g_pmbg1_d[l_ac].oofb008 = g_pmbg1_d_o.oofb008
                  NEXT FIELD CURRENT
               END IF
            END IF

         AFTER FIELD oofb019
            IF NOT cl_null(g_pmbg1_d[l_ac].oofb019) THEN
               LET l_cnt = 0 
               IF NOT cl_null(g_pmbg1_d_t.oofb001) THEN
                  SELECT COUNT(*) INTO l_cnt FROM oofb_t
                   WHERE oofb019 = g_pmbg1_d[l_ac].oofb019
                     AND oofb002 = g_pmaa_m.pmaa027
                     AND oofb001 != g_pmbg1_d_t.oofb001
               ELSE
                  SELECT COUNT(*) INTO l_cnt FROM oofb_t
                   WHERE oofb019 = g_pmbg1_d[l_ac].oofb019
                     AND oofb002 = g_pmaa_m.pmaa027
               END IF
               IF l_cnt > 0 THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = 'apm-00318'
                  LET g_errparam.extend = ''
                  LET g_errparam.popup = TRUE
                  CALL cl_err()

                  LET g_pmbg1_d[l_ac].oofb019 = g_pmbg1_d_t.oofb019
                  NEXT FIELD CURRENT
               END IF
            END IF
         
         AFTER FIELD oofb012
            IF NOT cl_null(g_pmbg1_d[l_ac].oofb012) THEN
               IF g_pmbg1_d[l_ac].oofb012 != g_pmbg1_d_o.oofb012 OR g_pmbg1_d_o.oofb012 IS NULL THEN
                  INITIALIZE g_chkparam.* TO NULL
                  LET g_chkparam.arg1 = g_pmbg1_d[l_ac].oofb012
                  IF NOT cl_chk_exist("v_oocg001") THEN
                     LET g_pmbg1_d[l_ac].oofb012 = g_pmbg1_d_o.oofb012
                     CALL adbm201_oofb012_ref()
                     NEXT FIELD CURRENT                  
                  ELSE
                     LET g_pmbg1_d[l_ac].oofb013 = ''
                     LET g_pmbg1_d[l_ac].oofb014 = ''
                     LET g_pmbg1_d[l_ac].oofb015 = ''
                     LET g_pmbg1_d[l_ac].oofb016 = ''
                     LET g_pmbg1_d[l_ac].oofb017 = ''
                     CALL adbm201_oofb014_ref()
                     CALL adbm201_oofb015_ref()
                     CALL adbm201_oofb016_ref()
                  END IF
                  
               END IF
            END IF
            LET g_pmbg1_d_o.oofb012 = g_pmbg1_d[l_ac].oofb012 
            CALL adbm201_oofb012_ref()

         ON ACTION controlp INFIELD oofb012
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_pmbg1_d[l_ac].oofb012 
            CALL q_oocg001()                                  
            LET g_pmbg1_d[l_ac].oofb012 = g_qryparam.return1 
            DISPLAY g_pmbg1_d[l_ac].oofb012 TO oofb012      
            CALL adbm201_oofb012_ref()
            NEXT FIELD oofb012     
            
         BEFORE FIELD oofb013 
            LET g_change_oocn002 = 'N'
         
         AFTER FIELD oofb013
            IF NOT cl_null(g_pmbg1_d[l_ac].oofb013) THEN
               IF g_pmbg1_d[l_ac].oofb013 != g_pmbg1_d_o.oofb013 OR g_pmbg1_d_o.oofb013 IS NULL THEN
                  CALL adbm201_chk_oocn() 
                  IF NOT cl_null(g_errno) THEN
                     INITIALIZE g_errparam TO NULL
                     LET g_errparam.code = g_errno
                     LET g_errparam.extend = g_pmbg1_d[l_ac].oofb013
                     LET g_errparam.popup = TRUE
                     CALL cl_err()

                     LET g_pmbg1_d[l_ac].oofb013 = g_pmbg1_d_o.oofb013
                     NEXT FIELD CURRENT                  
                  END IF
               END IF
            END IF
            LET g_pmbg1_d_o.oofb013 = g_pmbg1_d[l_ac].oofb013 

         ON ACTION controlp INFIELD oofb013
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_pmbg1_d[l_ac].oofb013 
            LET g_qryparam.default2 = g_pmbg1_d[l_ac].oofb012 
            LET g_qryparam.default3 = g_pmbg1_d[l_ac].oofb014 
            LET g_qryparam.default4 = g_pmbg1_d[l_ac].oofb015 
            LET g_qryparam.default5 = g_pmbg1_d[l_ac].oofb016 
            IF NOT cl_null(g_pmbg1_d[l_ac].oofb012) THEN
               LET g_qryparam.where = "oocn001 = '",g_pmbg1_d[l_ac].oofb012,"'"
            END IF
            CALL q_oocn002_1()                                  
            LET g_pmbg1_d[l_ac].oofb013 = g_qryparam.return1 
            LET g_pmbg1_d[l_ac].oofb012 = g_qryparam.return2 
            LET g_pmbg1_d[l_ac].oofb014 = g_qryparam.return3 
            LET g_pmbg1_d[l_ac].oofb015 = g_qryparam.return4 
            LET g_pmbg1_d[l_ac].oofb016 = g_qryparam.return5 
            CALL adbm201_oofb012_ref()
            CALL adbm201_oofb014_ref()
            CALL adbm201_oofb015_ref()
            CALL adbm201_oofb016_ref()

            IF g_pmbg1_d_o.oofb013 = g_qryparam.return1 AND  
               g_pmbg1_d_o.oofb012 = g_qryparam.return2 AND  
               g_pmbg1_d_o.oofb014 = g_qryparam.return3 AND  
               g_pmbg1_d_o.oofb015 = g_qryparam.return4 AND  
               g_pmbg1_d_o.oofb016 = g_qryparam.return5 THEN
               LET g_change_oocn002 = 'N'
            ELSE
               LET g_change_oocn002 = 'Y'
               LET g_pmbg1_d_o.oofb012 = g_pmbg1_d[l_ac].oofb012
               LET g_pmbg1_d_o.oofb013 = g_pmbg1_d[l_ac].oofb013
               LET g_pmbg1_d_o.oofb014 = g_pmbg1_d[l_ac].oofb014
               LET g_pmbg1_d_o.oofb015 = g_pmbg1_d[l_ac].oofb015
               LET g_pmbg1_d_o.oofb016 = g_pmbg1_d[l_ac].oofb016
            END IF
            DISPLAY BY NAME g_pmbg1_d[l_ac].oofb013
            NEXT FIELD oofb013   
            
         AFTER FIELD oofb014
            IF NOT cl_null(g_pmbg1_d[l_ac].oofb014) THEN
               IF g_pmbg1_d[l_ac].oofb014 != g_pmbg1_d_o.oofb014 OR g_pmbg1_d_o.oofb014 IS NULL THEN
                  INITIALIZE g_chkparam.* TO NULL
                  LET g_chkparam.arg1 = g_pmbg1_d[l_ac].oofb012
                  LET g_chkparam.arg2 = g_pmbg1_d[l_ac].oofb014
                  IF NOT cl_chk_exist("v_ooci002_1") THEN
                     LET g_pmbg1_d[l_ac].oofb014 = g_pmbg1_d_o.oofb014
                     CALL adbm201_oofb014_ref()
                     NEXT FIELD CURRENT                  
                  ELSE
                     LET g_pmbg1_d[l_ac].oofb013 = ''
                     LET g_pmbg1_d[l_ac].oofb015 = ''
                     LET g_pmbg1_d[l_ac].oofb016 = ''
                     LET g_pmbg1_d[l_ac].oofb017 = ''
                     CALL adbm201_oofb015_ref()
                     CALL adbm201_oofb016_ref()
                  END IF
               END IF
            END IF
            LET g_pmbg1_d_o.oofb014 = g_pmbg1_d[l_ac].oofb014 
            CALL adbm201_oofb014_ref()

         ON ACTION controlp INFIELD oofb014
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_pmbg1_d[l_ac].oofb014 
            LET g_qryparam.where = "ooci001 = '",g_pmbg1_d[l_ac].oofb012,"'"
            CALL q_ooci002()                                  
            LET g_pmbg1_d[l_ac].oofb014 = g_qryparam.return1 
            DISPLAY g_pmbg1_d[l_ac].oofb014 TO oofb014      
            CALL adbm201_oofb014_ref()
            NEXT FIELD oofb014    

         AFTER FIELD oofb015
            IF NOT cl_null(g_pmbg1_d[l_ac].oofb015) THEN
               IF g_pmbg1_d[l_ac].oofb015 != g_pmbg1_d_o.oofb015 OR g_pmbg1_d_o.oofb015 IS NULL THEN
                  INITIALIZE g_chkparam.* TO NULL
                  LET g_chkparam.arg1 = g_pmbg1_d[l_ac].oofb012
                  LET g_chkparam.arg2 = g_pmbg1_d[l_ac].oofb014
                  LET g_chkparam.arg3 = g_pmbg1_d[l_ac].oofb015
                  IF NOT cl_chk_exist("v_oock003") THEN
                     LET g_pmbg1_d[l_ac].oofb015 = g_pmbg1_d_o.oofb015
                     CALL adbm201_oofb015_ref()
                     NEXT FIELD CURRENT                  
                  ELSE
                     LET g_pmbg1_d[l_ac].oofb013 = ''
                     LET g_pmbg1_d[l_ac].oofb016 = ''
                     LET g_pmbg1_d[l_ac].oofb017 = ''
                     CALL adbm201_oofb016_ref()
                  END IF
               END IF
            END IF
            LET g_pmbg1_d_o.oofb015 = g_pmbg1_d[l_ac].oofb015 
            CALL adbm201_oofb015_ref()

         ON ACTION controlp INFIELD oofb015
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_pmbg1_d[l_ac].oofb015 
            LET g_qryparam.where = "oock001 = '",g_pmbg1_d[l_ac].oofb012,"' AND ",
                                   "oock002 = '",g_pmbg1_d[l_ac].oofb014,"' "
            CALL q_oock003()                                  
            LET g_pmbg1_d[l_ac].oofb015 = g_qryparam.return1 
            DISPLAY g_pmbg1_d[l_ac].oofb015 TO oofb015      
            CALL adbm201_oofb015_ref()
            NEXT FIELD oofb015    

         AFTER FIELD oofb016
            IF NOT cl_null(g_pmbg1_d[l_ac].oofb016) THEN
               IF g_pmbg1_d[l_ac].oofb016 != g_pmbg1_d_o.oofb016 OR g_pmbg1_d_o.oofb016 IS NULL THEN
                  INITIALIZE g_chkparam.* TO NULL
                  LET g_chkparam.arg1 = g_pmbg1_d[l_ac].oofb012
                  LET g_chkparam.arg2 = g_pmbg1_d[l_ac].oofb014
                  IF cl_null(g_pmbg1_d[l_ac].oofb015) THEN
                     LET g_chkparam.arg3 = ' '
                  ELSE
                     LET g_chkparam.arg3 = g_pmbg1_d[l_ac].oofb015
                  END IF
                  LET g_chkparam.arg4 = g_pmbg1_d[l_ac].oofb016
                  IF NOT cl_chk_exist("v_oocm004") THEN
                     LET g_pmbg1_d[l_ac].oofb016 = g_pmbg1_d_o.oofb016
                     CALL adbm201_oofb016_ref()
                     NEXT FIELD CURRENT                  
                  ELSE
                     LET g_pmbg1_d[l_ac].oofb013 = ''
                     LET g_pmbg1_d[l_ac].oofb017 = ''
                     CALL adbm201_oofb016_ref()
                  END IF
               END IF
            END IF
            LET g_pmbg1_d_o.oofb016 = g_pmbg1_d[l_ac].oofb016 
            CALL adbm201_oofb016_ref()

         ON ACTION controlp INFIELD oofb016
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_pmbg1_d[l_ac].oofb016 
            
            IF cl_null(g_pmbg1_d[l_ac].oofb015) THEN
               LET g_qryparam.where = "oocm001 = '",g_pmbg1_d[l_ac].oofb012,"' AND ",
                                      "oocm002 = '",g_pmbg1_d[l_ac].oofb014,"' AND ", 
                                      "oocm003 = ' ' "  
            ELSE
               LET g_qryparam.where = "oocm001 = '",g_pmbg1_d[l_ac].oofb012,"' AND ",
                                      "oocm002 = '",g_pmbg1_d[l_ac].oofb014,"' AND ", 
                                      "oocm003 = '",g_pmbg1_d[l_ac].oofb015,"' "  
            END IF
            CALL q_oocm004()                                  
            LET g_pmbg1_d[l_ac].oofb016 = g_qryparam.return1 
            DISPLAY g_pmbg1_d[l_ac].oofb016 TO oofb016      
            CALL adbm201_oofb016_ref()
            NEXT FIELD oofb016    
            
         AFTER ROW
            LET l_ac = ARR_CURR()
            LET l_ac_t = l_ac
            IF INT_FLAG THEN
               INITIALIZE g_errparam TO NULL
               LET g_errparam.code = 9001
               LET g_errparam.extend = ''
               LET g_errparam.popup = FALSE
               CALL cl_err()

               LET INT_FLAG = 0
               IF l_cmd = 'u' THEN
                  LET g_pmbg1_d[l_ac].* = g_pmbg1_d_t.*
               END IF
               CLOSE adbm201_bcl1
               CALL s_transaction_end('N','0')
               EXIT DIALOG 
            END IF
            
            #其他table進行unlock
            CALL adbm201_unlock_b("oofb_t","'1'")
            CALL s_transaction_end('Y','0')
 
         AFTER INPUT
            #單身主要的收款條件 update 單頭資料
            
         ON ACTION controlo
            CALL FGL_SET_ARR_CURR(g_pmbg1_d.getLength()+1)
            LET lb_reproduce = TRUE
            LET li_reproduce = l_ac
            LET li_reproduce_target = g_pmbg1_d.getLength()+1
 
      END INPUT
 
      INPUT ARRAY g_pmbg2_d FROM s_detail2.*
         ATTRIBUTE(COUNT = g_rec_b1,MAXCOUNT = g_max_rec,WITHOUT DEFAULTS, 
                 INSERT ROW = l_allow_insert, #此頁面insert功能由產生器控制, 手動之設定無效! 
                 DELETE ROW = l_allow_delete,
                 APPEND ROW = l_allow_insert)
         
         BEFORE INPUT
            IF g_insert = 'Y' AND NOT cl_null(g_insert) THEN 
               CALL FGL_SET_ARR_CURR(g_pmbg2_d.getLength()+1) 
               LET g_insert = 'N' 
            END IF 
 
            CALL adbm201_b_fill()
            LET g_rec_b1 = g_pmbg2_d.getLength()
            
         BEFORE INSERT            
            LET l_insert = TRUE
            LET l_n = ARR_COUNT()
            LET l_cmd = 'a'
            INITIALIZE g_pmbg2_d[l_ac].* TO NULL 
            LET g_pmbg2_d[l_ac].oofcstus = "Y"
            LET g_pmbg2_d[l_ac].oofc008 = "1"
            LET g_pmbg2_d[l_ac].oofc010 = "N"
            LET g_pmbg2_d_t.* = g_pmbg2_d[l_ac].*     #新輸入資料
            LET g_pmbg2_d_o.* = g_pmbg2_d[l_ac].*  #BACKUP
            CALL cl_show_fld_cont()
            #CALL adbm201_set_entry_b(l_cmd)
            #CALL adbm201_set_no_entry_b(l_cmd)
            IF lb_reproduce THEN
               LET lb_reproduce = FALSE
               LET g_pmbg2_d[li_reproduce_target].* = g_pmbg2_d[li_reproduce].*
               LET g_pmbg2_d[li_reproduce_target].oofc001 = NULL
            END IF
            
         BEFORE ROW     
            LET l_insert = FALSE
            LET l_cmd = ''
            LET l_ac = ARR_CURR()
            LET g_detail_idx = l_ac
              
            LET l_lock_sw = 'N'            #DEFAULT
            LET l_n = ARR_COUNT()
         
            CALL s_transaction_begin()
            OPEN adbm201_cl USING g_enterprise,g_pmaa_m.pmaa001
            IF STATUS THEN
               INITIALIZE g_errparam TO NULL
               LET g_errparam.code =  STATUS
               LET g_errparam.extend = "OPEN adbm201_cl:"
               LET g_errparam.popup = TRUE
               CALL cl_err()

               CLOSE adbm201_cl
               CALL s_transaction_end('N','0')
               RETURN
            END IF
            
            LET g_rec_b1 = g_pmbg2_d.getLength()
            
            IF g_rec_b1 >= l_ac 
               AND g_pmbg2_d[l_ac].oofc001 IS NOT NULL
            THEN 
               LET l_cmd='u'
               LET g_pmbg2_d_t.* = g_pmbg2_d[l_ac].*  #BACKUP
               LET g_pmbg2_d_o.* = g_pmbg2_d[l_ac].*  #BACKUP
               #CALL adbm201_set_entry_b(l_cmd)
               #CALL adbm201_set_no_entry_b(l_cmd)
               IF NOT adbm201_lock_b("oofc_t","'2'") THEN
                  LET l_lock_sw='Y'
               ELSE
                  FETCH adbm201_bcl2 INTO g_pmbg2_d[l_ac].oofc001,g_pmbg2_d[l_ac].oofcstus,
                            g_pmbg2_d[l_ac].oofc008,g_pmbg2_d[l_ac].oofc009,
                            g_pmbg2_d[l_ac].oofc009_desc, g_pmbg2_d[l_ac].oofc010, g_pmbg2_d[l_ac].oofc014, 
                            g_pmbg2_d[l_ac].oofc011, g_pmbg2_d[l_ac].oofc012, g_pmbg2_d[l_ac].oofc013
                  IF SQLCA.sqlcode THEN
                     INITIALIZE g_errparam TO NULL
                     LET g_errparam.code = SQLCA.sqlcode
                     LET g_errparam.extend = ''
                     LET g_errparam.popup = TRUE
                     CALL cl_err()

                     LET l_lock_sw = "Y"
                  END IF
                  
                  LET g_bfill = "N"
                  CALL adbm201_show()
                  LET g_bfill = "Y"
                  
                  CALL cl_show_fld_cont()
               END IF
            ELSE
               LET l_cmd='a'
            END IF
            
            
         BEFORE DELETE                            #是否取消單身
            IF l_cmd = 'a' THEN
               CALL FGL_SET_ARR_CURR(l_ac-1)
               CALL g_pmbg2_d.deleteElement(l_ac)
               NEXT FIELD oofcstus
            END IF
         
            IF g_pmbg2_d[l_ac].oofc001 IS NOT NULL
 
            THEN
               IF NOT cl_ask_del_detail() THEN
                  CANCEL DELETE
               END IF
               IF l_lock_sw = "Y" THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code =  -263
                  LET g_errparam.extend = ""
                  LET g_errparam.popup = TRUE
                  CALL cl_err()

                  CANCEL DELETE
               END IF
               
               DELETE FROM oofc_t
                WHERE oofcent = g_enterprise 
                  AND oofc001 = g_pmbg2_d_t.oofc001
                  AND oofc002 = g_pmaa_m.pmaa027
                  
               IF SQLCA.sqlcode THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = SQLCA.sqlcode
                  LET g_errparam.extend = "oofc_t"
                  LET g_errparam.popup = TRUE
                  CALL cl_err()

                  CALL s_transaction_end('N','0')
                  CANCEL DELETE   
               ELSE
                  LET g_rec_b1 = g_rec_b1-1
                  CALL s_transaction_end('Y','0')
               END IF 
               CLOSE adbm201_bcl2
            END IF 
            
            INITIALIZE gs_keys TO NULL 
            LET gs_keys[1] = g_pmbg2_d_t.oofc001
            LET gs_keys[2] = g_pmaa_m.pmaa027
 
            
         AFTER DELETE 
            CALL adbm201_delete_b('oofc_t',gs_keys,"'2'")
 
         AFTER INSERT    
            LET l_insert = FALSE
            IF INT_FLAG THEN
               INITIALIZE g_errparam TO NULL
               LET g_errparam.code = 9001
               LET g_errparam.extend = ''
               LET g_errparam.popup = FALSE
               CALL cl_err()

               LET INT_FLAG = 0
               CANCEL INSERT
            END IF
               
            LET l_wc = " oofcent = ",g_enterprise
            CALL s_aooi350_get_idno('oofc001','oofc_t',l_wc)
               RETURNING l_success,g_pmbg2_d[l_ac].oofc001
            IF NOT l_success THEN
               CALL s_transaction_end('N','0')                    
               CANCEL INSERT
            END IF

            LET l_count = 1  
            SELECT COUNT(*) INTO l_count FROM oofc_t 
             WHERE oofcent = g_enterprise 
               AND oofc001 = g_pmbg2_d[l_ac].oofc001
               AND oofc002 = g_pmaa_m.pmaa027
 
                
            #資料未重複, 插入新增資料
            IF l_count = 0 THEN 
               INITIALIZE gs_keys TO NULL 
               LET gs_keys[1] = g_pmbg2_d[l_ac].oofc001
               LET gs_keys[2] = g_pmaa_m.pmaa027
               CALL adbm201_insert_b('oofc_t',gs_keys,"'2'")
            ELSE    
               INITIALIZE g_errparam TO NULL
               LET g_errparam.code = "std-00006"
               LET g_errparam.extend = 'INSERT'
               LET g_errparam.popup = TRUE
               CALL cl_err()

               INITIALIZE g_pmbg2_d[l_ac].* TO NULL
               CALL s_transaction_end('N','0')
               CANCEL INSERT
            END IF
 
            IF SQLCA.SQLcode  THEN
               INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = SQLCA.sqlcode
                  LET g_errparam.extend = "oofc_t"
                  LET g_errparam.popup = TRUE
                  CALL cl_err()
  
               CALL s_transaction_end('N','0')                    
               CANCEL INSERT
            ELSE
               CALL s_transaction_end('Y','0')
               ERROR 'INSERT O.K'
               LET g_rec_b = g_rec_b + 1
            END IF
            
         ON ROW CHANGE 
            IF INT_FLAG THEN
               INITIALIZE g_errparam TO NULL
               LET g_errparam.code = 9001
               LET g_errparam.extend = ''
               LET g_errparam.popup = FALSE
               CALL cl_err()

               LET INT_FLAG = 0
               LET g_pmbg2_d[l_ac].* = g_pmbg2_d_t.*
               CLOSE adbm201_bcl2
               CALL s_transaction_end('N','0')
               EXIT DIALOG 
            END IF
            
            IF l_lock_sw = 'Y' THEN
               INITIALIZE g_errparam TO NULL
               LET g_errparam.code = -263
               LET g_errparam.extend = ''
               LET g_errparam.popup = TRUE
               CALL cl_err()

               LET g_pmbg2_d[l_ac].* = g_pmbg2_d_t.*
            ELSE
 
               
               UPDATE oofc_t SET (oofcstus,oofc008,oofc009,oofc010,oofc011,oofc012,oofc013,oofc014)
                         = (g_pmbg2_d[l_ac].oofcstus,g_pmbg2_d[l_ac].oofc008,g_pmbg2_d[l_ac].oofc009,
                            g_pmbg2_d[l_ac].oofc010, g_pmbg2_d[l_ac].oofc011,
                            g_pmbg2_d[l_ac].oofc012, g_pmbg2_d[l_ac].oofc013,g_pmbg2_d[l_ac].oofc014)
                WHERE oofcent = g_enterprise 
                  AND oofc001 = g_pmbg2_d_t.oofc001 
                  AND oofc002 = g_pmaa_m.pmaa027
                  
               CASE
                  WHEN SQLCA.sqlerrd[3] = 0  #更新不到的處理
                     INITIALIZE g_errparam TO NULL
                     LET g_errparam.code = "std-00009"
                     LET g_errparam.extend = "oofc_t"
                     LET g_errparam.popup = TRUE
                     CALL cl_err()

                     CALL s_transaction_end('N','0')
                     LET g_pmbg2_d[l_ac].* = g_pmbg2_d_t.*
                  WHEN SQLCA.sqlcode #其他錯誤
                     INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = SQLCA.sqlcode
                  LET g_errparam.extend = "oofc_t"
                  LET g_errparam.popup = TRUE
                  CALL cl_err()
  
                     CALL s_transaction_end('N','0')
                     LET g_pmbg2_d[l_ac].* = g_pmbg2_d_t.*
                  OTHERWISE
                     INITIALIZE gs_keys TO NULL 
                     LET gs_keys[1] = g_pmbg2_d[l_ac].oofc001
                     LET gs_keys_bak[1] = g_pmbg2_d_t.oofc001
                     LET gs_keys[2] = g_pmaa_m.pmaa027
                     LET gs_keys_bak[2] = g_pmaa_m.pmaa027
                     CALL adbm201_update_b('oofc_t',gs_keys,gs_keys_bak,"'2'")
               END CASE
            END IF
 
 
         AFTER FIELD oofc009
            LET g_pmbg2_d[l_ac].oofc009_desc = ' '
            DISPLAY BY NAME g_pmbg2_d[l_ac].oofc009_desc
            IF NOT cl_null(g_pmbg2_d[l_ac].oofc009) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_pmbg2_d[l_ac].oofc009 != g_pmbg2_d_t.oofc009 OR g_pmbg2_d_t.oofc009 IS NULL )) THEN
                  CALL adbm201_chk_acc_code('3',g_pmbg2_d[l_ac].oofc009)
                  IF NOT cl_null(g_errno) THEN
                     LET l_msg = cl_getmsg('art-00005',g_dlang)
                     LET l_msg = cl_replace_str(l_msg,"%1","3")
                     LET l_msg = cl_replace_str(l_msg,"%2",g_pmbg2_d[l_ac].oofc009)
                     INITIALIZE g_errparam TO NULL
                     LET g_errparam.code = g_errno
                     LET g_errparam.extend = l_msg
                     LET g_errparam.popup = TRUE
                     CALL cl_err()

                     LET g_pmbg2_d[l_ac].oofc009 = g_pmbg2_d_t.oofc009
                     CALL adbm201_oofc009_ref()
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL adbm201_oofc009_ref()
            
         ON ACTION controlp INFIELD oofc009
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_pmbg2_d[l_ac].oofc009 #給予default值
            #給予arg
            LET g_qryparam.arg1 = "3"  
            CALL q_oocq002()                                   #呼叫開窗
            LET g_pmbg2_d[l_ac].oofc009 = g_qryparam.return1  #將開窗取得的值回傳到變數
            DISPLAY g_pmbg2_d[l_ac].oofc009 TO oofc009        #顯示到畫面上
            CALL adbm201_oofc009_ref()
            NEXT FIELD oofc009                                 #返回原欄位
            
         ON CHANGE oofc010
            IF g_pmbg2_d[l_ac].oofc010 = 'Y' THEN
               LET l_cnt = 0 
               IF cl_null(g_pmbg2_d_t.oofc001) THEN
                  SELECT COUNT(*) INTO l_cnt FROM oofc_t
                   WHERE oofcent = g_enterprise
                     AND oofc002 = g_pmaa_m.pmaa027
                     AND oofc010 = 'Y'
                     AND oofc008 = g_pmbg2_d[l_ac].oofc008
               ELSE
                  SELECT COUNT(*) INTO l_cnt FROM oofc_t
                   WHERE oofcent = g_enterprise
                     AND oofc002 = g_pmaa_m.pmaa027
                     AND oofc008 = g_pmbg2_d[l_ac].oofc008
                     AND oofc010 = 'Y'
                     AND oofc001 != g_pmbg2_d_t.oofc001
               END IF
               IF l_cnt > 0 THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = 'aoo-00153'
                  LET g_errparam.extend = ''
                  LET g_errparam.popup = TRUE
                  CALL cl_err()

                  LET g_pmbg2_d[l_ac].oofc010 = g_pmbg2_d_t.oofc010
                  NEXT FIELD CURRENT
               END IF
            END IF
            
         AFTER FIELD oofc008 
            LET g_pmbg2_d_o.oofc008 = g_pmbg2_d[l_ac].oofc008 
            
         ON CHANGE oofc008
            IF g_pmbg2_d[l_ac].oofc010 = 'Y' THEN
               LET l_cnt = 0 
               IF cl_null(g_pmbg2_d_t.oofc001) THEN
                  SELECT COUNT(*) INTO l_cnt FROM oofc_t
                   WHERE oofcent = g_enterprise
                     AND oofc002 = g_pmaa_m.pmaa027
                     AND oofc010 = 'Y'
                     AND oofc008 = g_pmbg2_d[l_ac].oofc008
               ELSE
                  SELECT COUNT(*) INTO l_cnt FROM oofc_t
                   WHERE oofcent = g_enterprise
                     AND oofc002 = g_pmaa_m.pmaa027
                     AND oofc008 = g_pmbg2_d[l_ac].oofc008
                     AND oofc010 = 'Y'
                     AND oofc001 != g_pmbg2_d_t.oofc001
               END IF
               IF l_cnt > 0 THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = 'aoo-00153'
                  LET g_errparam.extend = ''
                  LET g_errparam.popup = TRUE
                  CALL cl_err()

                  LET g_pmbg2_d[l_ac].oofc008 = g_pmbg2_d_o.oofc008
                  NEXT FIELD CURRENT
               END IF
            END IF

         AFTER FIELD oofc014
            IF NOT cl_null(g_pmbg2_d[l_ac].oofc014) THEN
               LET l_cnt = 0 
               IF NOT cl_null(g_pmbg2_d_t.oofc001) THEN
                  SELECT COUNT(*) INTO l_cnt FROM oofc_t
                   WHERE oofc014 = g_pmbg2_d[l_ac].oofc014
                     AND oofc002 = g_pmaa_m.pmaa027
                     AND oofc001 != g_pmbg2_d_t.oofc001
               ELSE
                  SELECT COUNT(*) INTO l_cnt FROM oofc_t
                   WHERE oofc014 = g_pmbg2_d[l_ac].oofc014
                     AND oofc002 = g_pmaa_m.pmaa027
               END IF
               IF l_cnt > 0 THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = 'apm-00321'
                  LET g_errparam.extend = ''
                  LET g_errparam.popup = TRUE
                  CALL cl_err()

                  LET g_pmbg2_d[l_ac].oofc014 = g_pmbg2_d_t.oofc014
                  NEXT FIELD CURRENT
               END IF
            END IF
         
         AFTER ROW
            LET l_ac = ARR_CURR()
            LET l_ac_t = l_ac
            IF INT_FLAG THEN
               INITIALIZE g_errparam TO NULL
               LET g_errparam.code = 9001
               LET g_errparam.extend = ''
               LET g_errparam.popup = FALSE
               CALL cl_err()

               LET INT_FLAG = 0
               IF l_cmd = 'u' THEN
                  LET g_pmbg2_d[l_ac].* = g_pmbg2_d_t.*
               END IF
               CLOSE adbm201_bcl2
               CALL s_transaction_end('N','0')
               EXIT DIALOG 
            END IF
            
            #其他table進行unlock
            CALL adbm201_unlock_b("oofc_t","'2'")
            CALL s_transaction_end('Y','0')
 
         AFTER INPUT
            #單身主要的收款條件 update 單頭資料
            
         ON ACTION controlo
            CALL FGL_SET_ARR_CURR(g_pmbg2_d.getLength()+1)
            LET lb_reproduce = TRUE
            LET li_reproduce = l_ac
            LET li_reproduce_target = g_pmbg2_d.getLength()+1
 
      END INPUT]]>
  </point>
  <point name="insert.after_insert" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[      ]]>
  </point>
  <point name="insert.default" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_pmaa_m.pmaa095 = g_site
      LET g_pmaa_m.pmaa004 = '3']]>
  </point>
  <point name="insert.define" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   ]]>
  </point>
  <point name="main.after_define_sql" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   ]]>
  </point>
  <point name="main.before_close" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[      ]]>
  </point>
  <point name="main.define" order="" ver="8" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   DEFINE l_success LIKE type_t.num5 #150308-00001#1  By Ken 150309                                                ]]>
  </point>
  <point name="main.define_sql" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                                 LET g_forupd_sql = "SELECT pmaa095,'',pmaa001,'','','',pmaa005,'',pmaa006,'',pmaa090,'',pmaa026,'', 
                       pmaa221,'',pmaa232,'',pmaa200,pmaa201,pmaa027,pmaa004,pmaa241,'',pmaa242,'',pmaa243,'',pmaa244,'',pmaastus,pmaaownid,'',pmaaowndp,'',pmaacrtid, 
                       '',pmaacrtdp,'',pmaacrtdt,pmaamodid,'',pmaamoddt,pmaacnfid,'',pmaacnfdt,pmaa017,pmaa016,pmaa018, 
                       pmaa019,'',pmaa021,pmaa022,'',pmaa020,'',pmaa291,'',pmaa292,'',pmaa293,'',pmaa294,'',pmaa295, 
                       '',pmaa296,'',pmaa297,'',pmaa298,'',pmaa299,'',pmaa300,''",
                      "FROM pmaa_t WHERE pmaaent= ? AND pmaa001=? AND pmaa002 = '2' AND pmaa230 = '2' FOR UPDATE"]]>
  </point>
  <point name="main.exit" order="" ver="8" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   CALL s_aooi500_drop_temp() RETURNING l_success #150308-00001#1  By Ken 150309                                                ]]>
  </point>
  <point name="main.init" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                                                ]]>
  </point>
  <point name="main.servicecall" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                                                                                                ]]>
  </point>
  <point name="menu.default.insert" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="menu.delete" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[               ]]>
  </point>
  <point name="menu.insert" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[               ]]>
  </point>
  <point name="menu.modify" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[               ]]>
  </point>
  <point name="menu.output" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[               ]]>
  </point>
  <point name="menu.query" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[               ]]>
  </point>
  <point name="menu.reproduce" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[               ]]>
  </point>
  <point name="menu2.delete" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[               ]]>
  </point>
  <point name="menu2.insert" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[               ]]>
  </point>
  <point name="menu2.modify" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[               ]]>
  </point>
  <point name="menu2.output" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[               ]]>
  </point>
  <point name="menu2.query" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[               ]]>
  </point>
  <point name="menu2.reproduce" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[               ]]>
  </point>
  <point name="modify.after_input" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[      ]]>
  </point>
  <point name="modify.before_input" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_pmaa_m_o.* = g_pmaa_m.*]]>
  </point>
  <point name="modify.define" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   ]]>
  </point>
  <point name="query.define" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[      CALL g_pmbg1_d.clear()
   CALL g_pmbg2_d.clear()]]>
  </point>
  <point name="reproduce.after_reproduce" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   ]]>
  </point>
  <point name="reproduce.define" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   ]]>
  </point>
  <point name="reproduce.head.a_insert" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   ]]>
  </point>
  <point name="reproduce.head.b_input" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[      LET g_pmaa_m.pmaa095 = g_site
   LET g_pmaa_m.pmaastus = 'N'
   LET g_pmaa_m.pmaacnfid = ''
   LET g_pmaa_m.pmaacnfdt = ''
   LET g_pmaa_m_t.* = g_pmaa_m.*
   LET g_pmaa_m_o.* = g_pmaa_m.*]]>
  </point>
  <point name="reproduce.head.b_insert" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   ]]>
  </point>
  <point name="reproduce.head.m_insert" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   ]]>
  </point>
  <point name="set_entry.after_control" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   ]]>
  </point>
  <point name="set_entry.define" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   ]]>
  </point>
  <point name="set_entry.field_control" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            CALL cl_set_comp_entry("pmaa095",TRUE)]]>
  </point>
  <point name="set_no_entry.after_control" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   ]]>
  </point>
  <point name="set_no_entry.define" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   ]]>
  </point>
  <point name="set_no_entry.field_control" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            CALL cl_set_comp_entry("pmaa095",FALSE)]]>
  </point>
  <point name="show.after" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   FOR l_ac = 1 TO g_pmbg1_d.getLength()
      CALL adbm201_oofb009_ref()
      CALL adbm201_oofb012_ref()
      CALL adbm201_oofb014_ref()
      CALL adbm201_oofb015_ref()
      CALL adbm201_oofb016_ref()
   END FOR
   
   FOR l_ac = 1 TO g_pmbg2_d.getLength()
      CALL adbm201_oofc009_ref()  
   END FOR]]>
  </point>
  <point name="show.before" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   LET g_pmaa_m.ooff013 = ''
   SELECT ooff013 INTO g_pmaa_m.ooff013
     FROM ooff_t
    WHERE ooffent = g_enterprise 
      AND ooff001 = '99' 
      AND ooff002 = g_prog
      AND ooff003 = g_pmaa_m.pmaa001
      AND ooff012 = '4'
   DISPLAY BY NAME g_pmaa_m.ooff013]]>
  </point>
  <point name="show.define" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   ]]>
  </point>
  <point name="show.head.reference" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[      IF g_bfill = "Y" THEN
      CALL adbm201_b_fill() #單身填充
   END IF
   
   CALL adbm201_pmaa095_ref()
   CALL adbm201_pmaa001_ref()   
   CALL adbm201_pmaa232_ref()
   CALL adbm201_pmaa005_ref()
   CALL adbm201_pmaa006_ref()
   CALL adbm201_pmaa090_ref()
   CALL adbm201_pmaa026_ref()
   CALL adbm201_pmaa019_ref()
   CALL adbm201_pmaa022_ref()
   CALL adbm201_pmaa291_ref()
   CALL adbm201_pmaa292_ref()
   CALL adbm201_pmaa293_ref()
   CALL adbm201_pmaa294_ref()
   CALL adbm201_pmaa295_ref()
   CALL adbm201_pmaa296_ref()
   CALL adbm201_pmaa297_ref()
   CALL adbm201_pmaa298_ref()
   CALL adbm201_pmaa299_ref()
   CALL adbm201_pmaa300_ref()

   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmaa_m.pmaaownid
   CALL ap_ref_array2(g_ref_fields,"SELECT ooag011 FROM ooag_t WHERE ooagent='"||g_enterprise||"' AND ooag001=? ","") RETURNING g_rtn_fields
   LET g_pmaa_m.pmaaownid_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_pmaa_m.pmaaownid_desc

   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmaa_m.pmaaowndp
   CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_pmaa_m.pmaaowndp_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_pmaa_m.pmaaowndp_desc

   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmaa_m.pmaacrtid
   CALL ap_ref_array2(g_ref_fields,"SELECT ooag011 FROM ooag_t WHERE ooagent='"||g_enterprise||"' AND ooag001=? ","") RETURNING g_rtn_fields
   LET g_pmaa_m.pmaacrtid_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_pmaa_m.pmaacrtid_desc

   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmaa_m.pmaacrtdp
   CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_pmaa_m.pmaacrtdp_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_pmaa_m.pmaacrtdp_desc

   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmaa_m.pmaamodid
   CALL ap_ref_array2(g_ref_fields,"SELECT ooag011 FROM ooag_t WHERE ooagent='"||g_enterprise||"' AND ooag001=? ","") RETURNING g_rtn_fields
   LET g_pmaa_m.pmaamodid_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_pmaa_m.pmaamodid_desc

   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_pmaa_m.pmaacnfid
   CALL ap_ref_array2(g_ref_fields,"SELECT ooag011 FROM ooag_t WHERE ooagent='"||g_enterprise||"' AND ooag001=? ","") RETURNING g_rtn_fields
   LET g_pmaa_m.pmaacnfid_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_pmaa_m.pmaacnfid_desc
]]>
  </point>
  <point name="statechange.a_update" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   ]]>
  </point>
  <point name="statechange.after" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   ]]>
  </point>
  <point name="statechange.b_update" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[      CALL s_transaction_begin()
   IF lc_state = 'Y' THEN
      CALL s_adbm201_conf_chk(g_pmaa_m.pmaa001) RETURNING l_success
      IF NOT l_success THEN
         CALL s_transaction_end('N','0')
         RETURN
      ELSE
         IF NOT cl_ask_confirm('aim-00108') THEN
            CALL s_transaction_end('N','0')
            RETURN
         ELSE
            CALL s_adbm201_conf_upd(g_pmaa_m.pmaa001) RETURNING l_success
            IF NOT l_success THEN
               CALL s_transaction_end('N','0')
               RETURN
            ELSE
               CALL s_transaction_end('Y','0')
            END IF
         END IF
      END IF
   END IF
   IF lc_state = 'N' THEN
      CALL s_adbm201_unconf_chk(g_pmaa_m.pmaa001) RETURNING l_success
      IF NOT l_success THEN
         CALL s_transaction_end('N','0')
         RETURN
      ELSE
         IF NOT cl_ask_confirm('aim-00110') THEN
            CALL s_transaction_end('N','0')
            RETURN
         ELSE
            CALL s_adbm201_unconf_upd(g_pmaa_m.pmaa001) RETURNING l_success
            IF NOT l_success THEN
               CALL s_transaction_end('N','0')
               RETURN
            ELSE
               CALL s_transaction_end('Y','0')
            END IF
         END IF
      END IF
   END IF
   IF lc_state = 'X' THEN
      CALL s_adbm201_invalid_chk(g_pmaa_m.pmaa001) RETURNING l_success
      IF NOT l_success THEN
         CALL s_transaction_end('N','0')
         RETURN
      ELSE
         IF NOT cl_ask_confirm('lib-011') THEN
            CALL s_transaction_end('N','0')
            RETURN
         ELSE
            CALL s_adbm201_invalid_upd(g_pmaa_m.pmaa001) RETURNING l_success
            IF NOT l_success THEN
               CALL s_transaction_end('N','0')
               RETURN
            ELSE
               CALL s_transaction_end('Y','0')
            END IF
         END IF
      END IF
   END IF]]>
  </point>
  <point name="statechange.before" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[      IF g_pmaa_m.pmaastus = 'X' THEN
      RETURN
   END IF]]>
  </point>
  <point name="statechange.before_menu" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            CALL cl_set_act_visible("open,valid,void",TRUE)
      CASE g_pmaa_m.pmaastus 
         WHEN "N"
            CALL cl_set_act_visible("open",FALSE)
            
         WHEN "X"
            CALL cl_set_act_visible("open,valid,void",FALSE)

         WHEN "Y"
            CALL cl_set_act_visible("valid,void",FALSE)
      END CASE]]>
  </point>
  <point name="statechange.define" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[      DEFINE l_success   LIKE type_t.num5]]>
  </point>
  <point name="statechange.more_control" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[      ]]>
  </point>
  <point name="statechange.open" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[         ]]>
  </point>
  <point name="statechange.valid" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[         ]]>
  </point>
  <point name="statechange.void" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[         ]]>
  </point>
  <point name="ui_browser_refresh.define" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   ]]>
  </point>
  <point name="ui_dialog.action_default" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[      ]]>
  </point>
  <point name="ui_dialog.after_dialog" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[               ]]>
  </point>
  <point name="ui_dialog.before_dialog" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   ]]>
  </point>
  <point name="ui_dialog.define" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   ]]>
  </point>
  <point name="ui_dialog.more_displayarray" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        DISPLAY ARRAY g_pmbg1_d TO s_detail1.* ATTRIBUTES(COUNT=g_rec_b1)
		   
               BEFORE ROW
                  CALL adbm201_idx_chk()
                  LET l_ac = DIALOG.getCurrentRow("s_detail1")
                  LET g_detail_idx = l_ac
		   
               BEFORE DISPLAY
                  CALL FGL_SET_ARR_CURR(g_detail_idx)
                  LET l_ac = DIALOG.getCurrentRow("s_detail1")
                  LET g_current_page = 1
                  CALL adbm201_idx_chk()
            END DISPLAY
            
            DISPLAY ARRAY g_pmbg2_d TO s_detail2.* ATTRIBUTES(COUNT=g_rec_b1)
		   
               BEFORE ROW
                  CALL adbm201_idx_chk()
                  LET l_ac = DIALOG.getCurrentRow("s_detail2")
                  LET g_detail_idx = l_ac
		   
               BEFORE DISPLAY
                  CALL FGL_SET_ARR_CURR(g_detail_idx)
                  LET l_ac = DIALOG.getCurrentRow("s_detail2")
                  LET g_current_page = 2
                  CALL adbm201_idx_chk()
            END DISPLAY]]>
  </point>
  <section id="adbm201.description" ver="261" status="" src="s" readonly="">
    <![CDATA[#應用 a00 樣板自動產生(Version:1)
#+ Version..: T100-ERP-1.00.00(SD版次:9,PR版次:9) Build-000347
#+ 
#+ Filename...: adbm201
#+ Description: 經銷商網點維護作業
#+ Creator....: 04226(2014-02-24 14:26:04)
#+ Modifier...: 06815(2015-05-04 10:14:43) -SD/PR-
]]>
  </section>
  <section id="adbm201.global" ver="27" status="" src="s" readonly="">
    <![CDATA[#應用 i00 樣板自動產生(Version:3)
{<point name="global.memo" />}
 
IMPORT os
IMPORT FGL lib_cl_dlg
#add-point:增加匯入項目
{<point name="global.import" />}
#end add-point
 
SCHEMA ds
 
GLOBALS "../../cfg/top_global.inc"
 
#add-point:free_style模組變數(Module Variable)
{<point name="free_style.variable"/>}
#end add-point
 
#add-point:自定義模組變數(Module Variable)
{<point name="global.variable" edit="s"/>}
#end add-point
 
#add-point:自定義客戶專用模組變數(Module Variable)
{<point name="global.variable_customerization" edit="c"/>}
#end add-point
]]>
  </section>
  <section id="adbm201.main" ver="14" status="" src="s" readonly="">
    <![CDATA[#+ 作業開始
MAIN
   #add-point:main段define (標準程式用)
   {<point name="main.define" edit="s"/>}
   #end add-point    
   #add-point:main段define (客製程式用)
   {<point name="main.define_customerization" edit="c"/>}
   #end add-point
 
   #定義在其他link的程式則無效
   WHENEVER ERROR CALL cl_err_msg_log
 
   #依模組進行系統初始化設定(系統設定)
   CALL cl_ap_init("adb","")
 
   #add-point:作業初始化
   {<point name="main.init"/>}
   #end add-point
 
   #add-point:SQL_define
   {<point name="main.define_sql" />}
   #end add-point
   LET g_forupd_sql = cl_sql_forupd(g_forupd_sql)    #轉換不同資料庫語法
   DECLARE adbm201_cl CURSOR FROM g_forupd_sql 
   
   IF g_bgjob = "Y" THEN
 
      #add-point:Service Call
      {<point name="main.servicecall" />}
      #end add-point
   ELSE
      #畫面開啟 (identifier)
      OPEN WINDOW w_adbm201 WITH FORM cl_ap_formpath("adb",g_code)
 
      #瀏覽頁簽資料初始化
      CALL cl_ui_init()
 
      #程式初始化
      CALL adbm201_init()
 
      #進入選單 Menu (='N')
      CALL adbm201_ui_dialog()
   
      #畫面關閉
      CLOSE WINDOW w_adbm201
   END IF
 
   #add-point:作業離開前
   {<point name="main.exit" />}
   #end add-point
 
   #離開作業
   CALL cl_ap_exitprogram("0")
 
END MAIN
]]>
  </section>
  <section id="adbm201.other_function" ver="2" status="" src="s" readonly="">
    <![CDATA[#add-point:自定義元件(Function)
{<point name="other.function"/>}
#end add-point
]]>
  </section>
</add_points>
