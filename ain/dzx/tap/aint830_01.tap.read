<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<add_points prog="aint830_01" std_prog="aint830_01" erpver="1.0" module="AIN" ver="4" env="s" zone="t10prd" booking="N" type="S" identity="s" section_flag="N" designer_ver="1.0">
  <other>
    <code_template value="F" status=""/>
    <free_style value="N" status=""/>
    <start_arg value="" status=""/>
  </other>
  <point name="dialog.aint830_01_display" order="1" ver="1" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 單身顯示
# Memo...........:
# Usage..........: CALL aint830_01_display()
# Input parameter: 传入参数变量1   传入参数变量说明1
#                : 传入参数变量2   传入参数变量说明2
# Return code....: 回传参数变量1   回传参数变量说明1
#                : 回传参数变量2   回传参数变量说明2
# Date & Author..: 日期 By lixh
# Modify.........:
################################################################################
DIALOG aint830_01_display()

   DISPLAY ARRAY g_inpe_d TO s_detail1_aint830_01.* ATTRIBUTES(COUNT=g_rec_b) 
      
      BEFORE ROW
         LET l_ac = DIALOG.getCurrentRow("s_detail1_aint830_01")
         LET g_detail_idx = l_ac
       
               
      BEFORE DISPLAY
         CALL FGL_SET_ARR_CURR(g_detail_idx)
         LET l_ac = DIALOG.getCurrentRow("s_detail1_aint830_01")
         LET g_current_page = 1
            CALL cl_set_comp_visible("inpe030,inpe031,inpe032,inpe033,inpe033_desc,inpe034,inpe035,inpe036,inpe037,inpe038,inpe038_desc,inpe039",FALSE)
            CALL cl_set_comp_visible("inpe050,inpe051,inpe052,inpe053,inpe053_desc,inpe054,inpe055,inpe056,inpe057,inpe058,inpe058_desc,inpe059",FALSE)
            IF g_type = '1' THEN   #初盤一
               CALL cl_set_comp_visible("inpe030,inpe033,inpe033_desc,inpe034",TRUE)
            END IF
            IF g_type = '2' THEN   #初盤二
               CALL cl_set_comp_visible("inpe035,inpe038,inpe038_desc,inpe039",TRUE)
            END IF   
            IF g_type = '3' THEN   #復盤一
               CALL cl_set_comp_visible("inpe050,inpe053,inpe053_desc,inpe054",TRUE)
            END IF     
            IF g_type = '4' THEN   #復盤二
               CALL cl_set_comp_visible("inpe055,inpe058,inpe058_desc,inpe059",TRUE)
            END IF    
      AFTER DISPLAY
         LET g_inpe3_d.* = g_inpe_d.*            
   END DISPLAY
END DIALOG]]>
  </point>
  <point name="function.aint830_01_lock_b" order="1" ver="1" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 連動lock其他單身table資料
# Memo...........:
# Usage..........: CALL aint830_01_lock_b(ps_table)
#                  RETURNING 回传参数
# Input parameter: 传入参数变量1   传入参数变量说明1
#                : 传入参数变量2   传入参数变量说明2
# Return code....: 回传参数变量1   回传参数变量说明1
#                : 回传参数变量2   回传参数变量说明2
# Date & Author..: 日期 By lixh
# Modify.........:
################################################################################
PRIVATE FUNCTION aint830_01_lock_b(ps_table)
   DEFINE ps_table STRING
   DEFINE ls_group STRING
   #add-point:lock_b段define

   #end add-point   
   
   #先刷新資料
   #CALL aint830_01_b_fill(g_wc2)
   
   #鎖定整組table
   #LET ls_group = ""
   #僅鎖定自身table
   LET ls_group = "inpe_t"
   
   IF ls_group.getIndexOf(ps_table,1) THEN
   
      OPEN aint830_01_bcl USING g_enterprise,
                                       g_inpe_d[g_detail_idx].inpesite,g_inpe_d[g_detail_idx].inpedocno, 
                                           g_inpe_d[g_detail_idx].inpeseq,g_inpe_d[g_detail_idx].inpeseq2 

                                       
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "aint830_01_bcl"
         LET g_errparam.popup = TRUE
         CALL cl_err()

         RETURN FALSE
      END IF
   
   END IF
                                      
   RETURN TRUE
END FUNCTION]]>
  </point>
  <point name="dialog.aint830_01_construct" order="2" ver="1" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 單身查詢
# Memo...........:
# Usage..........: CALL aint830_01_construct()
# Input parameter: 传入参数变量1   传入参数变量说明1
#                : 传入参数变量2   传入参数变量说明2
# Return code....: 回传参数变量1   回传参数变量说明1
#                : 回传参数变量2   回传参数变量说明2
# Date & Author..: 日期 By lixh
# Modify.........:
################################################################################
DIALOG aint830_01_construct()
      CONSTRUCT g_wc_source ON inpedocno,inpeseq,inpeseq2,inpesite,inpe008,inpe009,inpe012,inpe030,inpe035, 
          inpe050,inpe055,inpe010,inpe011,inpe031,inpe032,inpe033,inpe034,inpe036,inpe037,inpe038,inpe039, 
          inpe051,inpe052,inpe053,inpe054,inpe056,inpe057,inpe058,inpe059 
 
        FROM s_detail1_aint830_01[1].inpedocno,s_detail1_aint830_01[1].inpeseq,s_detail1_aint830_01[1].inpeseq2,s_detail1_aint830_01[1].inpesite, 
             s_detail1_aint830_01[1].inpe008,s_detail1_aint830_01[1].inpe009,s_detail1_aint830_01[1].inpe012,s_detail1_aint830_01[1].inpe030,s_detail1_aint830_01[1].inpe035, 
             s_detail1_aint830_01[1].inpe050,s_detail1_aint830_01[1].inpe055,s_detail1_aint830_01[1].inpe010,s_detail1_aint830_01[1].inpe011,s_detail1_aint830_01[1].inpe031, 
             s_detail1_aint830_01[1].inpe032,s_detail1_aint830_01[1].inpe033,s_detail1_aint830_01[1].inpe034,s_detail1_aint830_01[1].inpe036,s_detail1_aint830_01[1].inpe037, 
             s_detail1_aint830_01[1].inpe038,s_detail1_aint830_01[1].inpe039,s_detail1_aint830_01[1].inpe051,s_detail1_aint830_01[1].inpe052,s_detail1_aint830_01[1].inpe053, 
             s_detail1_aint830_01[1].inpe054,s_detail1_aint830_01[1].inpe056,s_detail1_aint830_01[1].inpe057,s_detail1_aint830_01[1].inpe058,s_detail1_aint830_01[1].inpe059  

      
         
      
                  #此段落由子樣板a01產生
         BEFORE FIELD inpedocno
            #add-point:BEFORE FIELD inpedocno

            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD inpedocno
            
            #add-point:AFTER FIELD inpedocno

            #END add-point
            
 
         #Ctrlp:query.c.page1.inpedocno
         ON ACTION controlp INFIELD inpedocno
            #add-point:ON ACTION controlp INFIELD inpedocno

            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD inpeseq
            #add-point:BEFORE FIELD inpeseq

            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD inpeseq
            
            #add-point:AFTER FIELD inpeseq

            #END add-point
            
 
         #Ctrlp:query.c.page1.inpeseq
         ON ACTION controlp INFIELD inpeseq
            #add-point:ON ACTION controlp INFIELD inpeseq

            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD inpeseq2
            #add-point:BEFORE FIELD inpeseq2

            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD inpeseq2
            
            #add-point:AFTER FIELD inpeseq2

            #END add-point
            
 
         #Ctrlp:query.c.page1.inpeseq2
         ON ACTION controlp INFIELD inpeseq2
            #add-point:ON ACTION controlp INFIELD inpeseq2

            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD inpesite
            #add-point:BEFORE FIELD inpesite

            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD inpesite
            
            #add-point:AFTER FIELD inpesite

            #END add-point
            
 
         #Ctrlp:query.c.page1.inpesite
         ON ACTION controlp INFIELD inpesite
            #add-point:ON ACTION controlp INFIELD inpesite

            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD inpe008
            #add-point:BEFORE FIELD inpe008

            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD inpe008
            
            #add-point:AFTER FIELD inpe008

            #END add-point
            
 
         #Ctrlp:query.c.page1.inpe008
         ON ACTION controlp INFIELD inpe008
            #add-point:ON ACTION controlp INFIELD inpe008

            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD inpe009
            #add-point:BEFORE FIELD inpe009

            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD inpe009
            
            #add-point:AFTER FIELD inpe009

            #END add-point
            
 
         #Ctrlp:query.c.page1.inpe009
         ON ACTION controlp INFIELD inpe009
            #add-point:ON ACTION controlp INFIELD inpe009

            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD inpe012
            #add-point:BEFORE FIELD inpe012

            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD inpe012
            
            #add-point:AFTER FIELD inpe012

            #END add-point
            
 
         #Ctrlp:query.c.page1.inpe012
         ON ACTION controlp INFIELD inpe012
            #add-point:ON ACTION controlp INFIELD inpe012

            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD inpe030
            #add-point:BEFORE FIELD inpe030

            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD inpe030
            
            #add-point:AFTER FIELD inpe030

            #END add-point
            
 
         #Ctrlp:query.c.page1.inpe030
         ON ACTION controlp INFIELD inpe030
            #add-point:ON ACTION controlp INFIELD inpe030

            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD inpe035
            #add-point:BEFORE FIELD inpe035

            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD inpe035
            
            #add-point:AFTER FIELD inpe035

            #END add-point
            
 
         #Ctrlp:query.c.page1.inpe035
         ON ACTION controlp INFIELD inpe035
            #add-point:ON ACTION controlp INFIELD inpe035

            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD inpe050
            #add-point:BEFORE FIELD inpe050

            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD inpe050
            
            #add-point:AFTER FIELD inpe050

            #END add-point
            
 
         #Ctrlp:query.c.page1.inpe050
         ON ACTION controlp INFIELD inpe050
            #add-point:ON ACTION controlp INFIELD inpe050

            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD inpe055
            #add-point:BEFORE FIELD inpe055

            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD inpe055
            
            #add-point:AFTER FIELD inpe055

            #END add-point
            
 
         #Ctrlp:query.c.page1.inpe055
         ON ACTION controlp INFIELD inpe055
            #add-point:ON ACTION controlp INFIELD inpe055

            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD inpe010
            #add-point:BEFORE FIELD inpe010

            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD inpe010
            
            #add-point:AFTER FIELD inpe010

            #END add-point
            
 
         #Ctrlp:query.c.page1.inpe010
         ON ACTION controlp INFIELD inpe010
            #add-point:ON ACTION controlp INFIELD inpe010

            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD inpe011
            #add-point:BEFORE FIELD inpe011

            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD inpe011
            
            #add-point:AFTER FIELD inpe011

            #END add-point
            
 
         #Ctrlp:query.c.page1.inpe011
         ON ACTION controlp INFIELD inpe011
            #add-point:ON ACTION controlp INFIELD inpe011

            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD inpe031
            #add-point:BEFORE FIELD inpe031

            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD inpe031
            
            #add-point:AFTER FIELD inpe031

            #END add-point
            
 
         #Ctrlp:query.c.page1.inpe031
         ON ACTION controlp INFIELD inpe031
            #add-point:ON ACTION controlp INFIELD inpe031

            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD inpe032
            #add-point:BEFORE FIELD inpe032

            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD inpe032
            
            #add-point:AFTER FIELD inpe032

            #END add-point
            
 
         #Ctrlp:query.c.page1.inpe032
         ON ACTION controlp INFIELD inpe032
            #add-point:ON ACTION controlp INFIELD inpe032

            #END add-point
 
         #Ctrlp:construct.c.page1.inpe033
         ON ACTION controlp INFIELD inpe033
            #add-point:ON ACTION controlp INFIELD inpe033
            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_ooag001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO inpe033  #顯示到畫面上
            NEXT FIELD inpe033                     #返回原欄位
    


            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD inpe033
            #add-point:BEFORE FIELD inpe033

            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD inpe033
            
            #add-point:AFTER FIELD inpe033

            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD inpe034
            #add-point:BEFORE FIELD inpe034

            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD inpe034
            
            #add-point:AFTER FIELD inpe034

            #END add-point
            
 
         #Ctrlp:query.c.page1.inpe034
         ON ACTION controlp INFIELD inpe034
            #add-point:ON ACTION controlp INFIELD inpe034

            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD inpe036
            #add-point:BEFORE FIELD inpe036

            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD inpe036
            
            #add-point:AFTER FIELD inpe036

            #END add-point
            
 
         #Ctrlp:query.c.page1.inpe036
         ON ACTION controlp INFIELD inpe036
            #add-point:ON ACTION controlp INFIELD inpe036

            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD inpe037
            #add-point:BEFORE FIELD inpe037

            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD inpe037
            
            #add-point:AFTER FIELD inpe037

            #END add-point
            
 
         #Ctrlp:query.c.page1.inpe037
         ON ACTION controlp INFIELD inpe037
            #add-point:ON ACTION controlp INFIELD inpe037

            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD inpe038
            #add-point:BEFORE FIELD inpe038

            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD inpe038
            
            #add-point:AFTER FIELD inpe038

            #END add-point
            
 
         #Ctrlp:query.c.page1.inpe038
         ON ACTION controlp INFIELD inpe038
            #add-point:ON ACTION controlp INFIELD inpe038
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_ooag001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO inpe038  #顯示到畫面上
            NEXT FIELD inpe038                     #返回原欄位
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD inpe039
            #add-point:BEFORE FIELD inpe039

            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD inpe039
            
            #add-point:AFTER FIELD inpe039

            #END add-point
            
 
         #Ctrlp:query.c.page1.inpe039
         ON ACTION controlp INFIELD inpe039
            #add-point:ON ACTION controlp INFIELD inpe039

            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD inpe051
            #add-point:BEFORE FIELD inpe051

            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD inpe051
            
            #add-point:AFTER FIELD inpe051

            #END add-point
            
 
         #Ctrlp:query.c.page1.inpe051
         ON ACTION controlp INFIELD inpe051
            #add-point:ON ACTION controlp INFIELD inpe051

            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD inpe052
            #add-point:BEFORE FIELD inpe052

            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD inpe052
            
            #add-point:AFTER FIELD inpe052

            #END add-point
            
 
         #Ctrlp:query.c.page1.inpe052
         ON ACTION controlp INFIELD inpe052
            #add-point:ON ACTION controlp INFIELD inpe052

            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD inpe053
            #add-point:BEFORE FIELD inpe053

            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD inpe053
            
            #add-point:AFTER FIELD inpe053

            #END add-point
            
 
         #Ctrlp:query.c.page1.inpe053
         ON ACTION controlp INFIELD inpe053
            #add-point:ON ACTION controlp INFIELD inpe053
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_ooag001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO inpe053  #顯示到畫面上
            NEXT FIELD inpe053                     #返回原欄位
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD inpe054
            #add-point:BEFORE FIELD inpe054

            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD inpe054
            
            #add-point:AFTER FIELD inpe054

            #END add-point
            
 
         #Ctrlp:query.c.page1.inpe054
         ON ACTION controlp INFIELD inpe054
            #add-point:ON ACTION controlp INFIELD inpe054

            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD inpe056
            #add-point:BEFORE FIELD inpe056

            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD inpe056
            
            #add-point:AFTER FIELD inpe056

            #END add-point
            
 
         #Ctrlp:query.c.page1.inpe056
         ON ACTION controlp INFIELD inpe056
            #add-point:ON ACTION controlp INFIELD inpe056

            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD inpe057
            #add-point:BEFORE FIELD inpe057

            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD inpe057
            
            #add-point:AFTER FIELD inpe057

            #END add-point
            
 
         #Ctrlp:query.c.page1.inpe057
         ON ACTION controlp INFIELD inpe057
            #add-point:ON ACTION controlp INFIELD inpe057

            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD inpe058
            #add-point:BEFORE FIELD inpe058

            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD inpe058
            
            #add-point:AFTER FIELD inpe058

            #END add-point
            
 
         #Ctrlp:query.c.page1.inpe058
         ON ACTION controlp INFIELD inpe058
            #add-point:ON ACTION controlp INFIELD inpe058
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_ooag001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO inpe058  #顯示到畫面上
            NEXT FIELD inpe058                     #返回原欄位
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD inpe059
            #add-point:BEFORE FIELD inpe059

            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD inpe059
            
            #add-point:AFTER FIELD inpe059

            #END add-point
            
 
         #Ctrlp:query.c.page1.inpe059
         ON ACTION controlp INFIELD inpe059
            #add-point:ON ACTION controlp INFIELD inpe059

            #END add-point
 
  
         
 
      
         BEFORE CONSTRUCT
            #add-point:cs段more_construct

            #end add-point 
      
      END CONSTRUCT
END DIALOG]]>
  </point>
  <point name="function.aint830_01_unlock_b" order="2" ver="1" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 連動unlock其他單身table資料
# Memo...........:
# Usage..........: CALL aint830_01_unlock_b(ps_table)
#                  RETURNING 回传参数
# Input parameter: 传入参数变量1   传入参数变量说明1
#                : 传入参数变量2   传入参数变量说明2
# Return code....: 回传参数变量1   回传参数变量说明1
#                : 回传参数变量2   回传参数变量说明2
# Date & Author..: 日期 By lixh
# Modify.........:
################################################################################
PRIVATE FUNCTION aint830_01_unlock_b(ps_table)
   DEFINE ps_table STRING
   DEFINE ls_group STRING
   #add-point:unlock_b段define

   #end add-point  
   
   LET ls_group = ""
   
   #IF ls_group.getIndexOf(ps_table,1) THEN
   CLOSE aint830_01_bcl
   #END IF
END FUNCTION]]>
  </point>
  <point name="dialog.aint830_01_input" order="3" ver="4" cite_std="N" new="Y" status="u" src="s" readonly="" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 單身修改
# Memo...........:
# Usage..........: CALL aint830_01_input()
#                  RETURNING 回传参数
# Input parameter: 传入参数变量1   传入参数变量说明1
#                : 传入参数变量2   传入参数变量说明2
# Return code....: 回传参数变量1   回传参数变量说明1
#                : 回传参数变量2   回传参数变量说明2
# Date & Author..: 日期 By lixh
# Modify.........:
################################################################################
DIALOG aint830_01_input()
DEFINE  l_inpd001       LIKE inpd_t.inpd001 
DEFINE  l_inpd002       LIKE inpd_t.inpd002
DEFINE  l_inpd009       LIKE inpd_t.inpd009
DEFINE  l_inpdstus      LIKE inpd_t.inpdstus
DEFINE  g_inpesite      LIKE inpe_t.inpesite
DEFINE  g_inpedocno     LIKE inpe_t.inpedocno
DEFINE  g_inpeseq       LIKE inpe_t.inpeseq
DEFINE  l_cnt           LIKE type_t.num5
DEFINE  g_inpd030       LIKE inpe_t.inpe030
DEFINE  g_inpd036       LIKE inpe_t.inpe035
DEFINE  g_inpd050       LIKE inpe_t.inpe050
DEFINE  g_inpd056       LIKE inpe_t.inpe055
DEFINE  l_sum           LIKE inpe_t.inpe030 
DEFINE  s_inpe_sum      LIKE inpe_t.inpe030
DEFINE  l_success       LIKE type_t.num5  #add--2015/07/02 By shiun

      INPUT ARRAY g_inpe_d FROM s_detail1_aint830_01.*
          ATTRIBUTE(COUNT = g_detail_cnt,MAXCOUNT = g_max_rec,WITHOUT DEFAULTS, 
                  INSERT ROW = g_detail_insert, 
                  DELETE ROW = g_detail_delete,
                  APPEND ROW = g_detail_insert)
 
         #自訂ACTION(detail_input,page_1)
         
         
         BEFORE INPUT
            CALL cl_set_comp_visible("inpe030,inpe031,inpe032,inpe033,inpe033_desc,inpe034,inpe035,inpe036,inpe037,inpe038,inpe038_desc,inpe039",FALSE)
            CALL cl_set_comp_visible("inpe050,inpe051,inpe052,inpe053,inpe053_desc,inpe054,inpe055,inpe056,inpe057,inpe058,inpe058_desc,inpe059",FALSE)
            CALL cl_set_comp_entry("inpe008,inpe009,inpe010,inpe011,inpe012,inpe030,inpe035,inpe050,inpe055,inpe033,inpe034,inpe038,inpe039,inpe053,inpe054,inpe058,inpe059",TRUE)
            IF g_type = '1' THEN   #初盤一
               CALL cl_set_comp_visible("inpe030,inpe033,inpe033_desc,inpe034",TRUE)
            END IF
            IF g_type = '2' THEN   #初盤二
               CALL cl_set_comp_visible("inpe035,inpe038,inpe038_desc,inpe039",TRUE)
            END IF   
            IF g_type = '3' THEN   #復盤一
               CALL cl_set_comp_visible("inpe050,inpe053,inpe053_desc,inpe054",TRUE)
            END IF     
            IF g_type = '4' THEN   #復盤二
               CALL cl_set_comp_visible("inpe055,inpe058,inpe058_desc,inpe059",TRUE)
            END IF    

            LET INT_FLAG = FALSE 
          
            SELECT inpd001,inpd002,inpd009,inpdstus,inpd030,inpd036,inpd050,inpd056 
              INTO l_inpd001,l_inpd002,l_inpd009,l_inpdstus,g_inpd030,g_inpd036,g_inpd050,g_inpd056 FROM inpd_t
             WHERE inpdent = g_enterprise
               AND inpdsite = g_inpdsite
               AND inpddocno = g_inpddocno
               AND inpdseq = g_inpdseq
               
            IF l_inpd002 IS NULL THEN
               LET l_inpd002 = ' '
            END IF                   
            SELECT imaf071,imaf072,imaf073,imaf074,imaf081,imaf082,imaf083,imaf084,imaf032 
              INTO g_imaf071,g_imaf072,g_imaf073,g_imaf074,g_imaf081,g_imaf082,g_imaf083,g_imaf084,g_imaf032 FROM imaf_t
             WHERE imafent = g_enterprise
               AND imafsite = g_inpdsite
               AND imaf001 = l_inpd001               
      
            IF g_imaf071 = '2' AND g_imaf081 = '2' THEN
#               RETURN
               EXIT DIALOG
            END IF 
            IF l_inpdstus <> 'N' AND (g_type = '1' OR g_type = '2' ) THEN
               EXIT DIALOG
            END IF
            
            IF (l_inpdstus ='S' OR l_inpdstus ='6') AND (g_type = '3' OR g_type = '4' ) THEN
               EXIT DIALOG
            END IF            
            
#            IF l_inpdstus <> 'N' OR l_inpd009 = 'N' THEN
#               LET l_allow_insert = FALSE
#               LET l_allow_delete = FALSE
#               LET l_allow_insert = FALSE
#            END IF  
#            IF l_inpdstus <> 'N' THEN   
#               CALL cl_set_comp_entry("inpe008,inpe009,inpe010,inpe011,inpe012,inpe030,inpe035,inpe050,inpe055,inpe033,inpe034,inpe038,inpe039,inpe053,inpe054,inpe058,inpe059",FALSE)
#            END IF    
            IF l_inpd009 = 'N' THEN
               CALL cl_set_comp_entry("inpe008,inpe009,inpe010,inpe011,inpe012,inpeseq2",FALSE)
            END IF             
            CALL aint830_01_b_fill(g_inpdsite,g_inpddocno,g_inpdseq)          
            IF g_insert = 'Y' AND NOT cl_null(g_insert) THEN 
              CALL FGL_SET_ARR_CURR(g_inpe_d.getLength()+1) 
              LET g_insert = 'N' 
            END IF 
            CALL aint830_01_set_entry_b()
            CALL aint830_01_set_no_required()
            CALL aint830_01_set_required(g_inpdsite,g_inpddocno,g_inpdseq)            
            CALL aint830_01_set_no_entry_b(g_inpdsite,g_inpddocno,g_inpdseq)
 
            LET l_forupd_sql = "SELECT inpedocno,inpeseq,inpeseq2,inpesite,inpe008,inpe009,inpe012,inpe030,inpe035, 
                                inpe050,inpe055,inpe010,inpe011,inpe031,inpe032,inpe033,inpe034,inpe036,inpe037,inpe038,inpe039, 
                                inpe051,inpe052,inpe053,inpe054,inpe056,inpe057,inpe058,inpe059 FROM inpe_t WHERE inpeent=? AND  
                                inpesite = ? AND inpedocno=? AND inpeseq=? AND inpeseq2=? FOR UPDATE"

            LET l_forupd_sql= cl_sql_forupd(l_forupd_sql)
            LET l_forupd_sql = cl_sql_add_mask(l_forupd_sql)              #遮蔽特定資料
            DECLARE aint830_01_bcl CURSOR FROM l_forupd_sql  
         
         BEFORE ROW
            #add-point:modify段before row

            #end add-point  
            LET l_insert = FALSE
            LET l_ac = ARR_CURR()           
            LET g_detail_idx = DIALOG.getCurrentRow("s_detail1_aint830_01")
            LET l_cmd = ''
            LET l_ac = g_detail_idx
            LET l_lock_sw = 'N'            #DEFAULT
            LET l_n = ARR_COUNT()
            DISPLAY l_ac TO FORMONLY.idx
            DISPLAY g_inpe_d.getLength() TO FORMONLY.cnt
         
            CALL s_transaction_begin()
            LET g_detail_cnt = g_inpe_d.getLength()
            
            IF g_detail_cnt >= l_ac 
               AND g_inpe_d[l_ac].inpesite IS NOT NULL
               AND g_inpe_d[l_ac].inpedocno IS NOT NULL
               AND g_inpe_d[l_ac].inpeseq IS NOT NULL
               AND g_inpe_d[l_ac].inpeseq2 IS NOT NULL
 
            THEN
               LET l_cmd='u'
               LET g_inpe_d_t.* = g_inpe_d[l_ac].*  #BACKUP
               LET g_inpe_d_o.* = g_inpe_d[l_ac].*  #BACKUP
               IF NOT aint830_01_lock_b("inpe_t") THEN
                  LET l_lock_sw='Y'
               ELSE
                  FETCH aint830_01_bcl INTO g_inpe_d[l_ac].inpedocno,g_inpe_d[l_ac].inpeseq,g_inpe_d[l_ac].inpeseq2, 
                      g_inpe_d[l_ac].inpesite,g_inpe_d[l_ac].inpe008,g_inpe_d[l_ac].inpe009,g_inpe_d[l_ac].inpe012, 
                      g_inpe_d[l_ac].inpe030,g_inpe_d[l_ac].inpe035,g_inpe_d[l_ac].inpe050,g_inpe_d[l_ac].inpe055, 
                      g_inpe_d[l_ac].inpe010,g_inpe_d[l_ac].inpe011,g_inpe_d[l_ac].inpe031,g_inpe_d[l_ac].inpe032, 
                      g_inpe_d[l_ac].inpe033,g_inpe_d[l_ac].inpe034,g_inpe_d[l_ac].inpe036,g_inpe_d[l_ac].inpe037, 
                      g_inpe_d[l_ac].inpe038,g_inpe_d[l_ac].inpe039,g_inpe_d[l_ac].inpe051,g_inpe_d[l_ac].inpe052, 
                      g_inpe_d[l_ac].inpe053,g_inpe_d[l_ac].inpe054,g_inpe_d[l_ac].inpe056,g_inpe_d[l_ac].inpe057, 
                      g_inpe_d[l_ac].inpe058,g_inpe_d[l_ac].inpe059
                  IF SQLCA.sqlcode THEN
                     INITIALIZE g_errparam TO NULL
                     LET g_errparam.code = SQLCA.sqlcode
                     LET g_errparam.extend = g_inpe_d_t.inpesite
                     LET g_errparam.popup = TRUE
                     CALL cl_err()

                     LET l_lock_sw = "Y"
                  END IF
                  
#                  CALL aint830_01_detail_show()
                  CALL cl_show_fld_cont()
               END IF
            ELSE
               LET l_cmd='a'
            END IF
            IF g_type = '1' THEN            #add by lixh 20150211
               IF cl_null(g_inpe_d[l_ac].inpe033) THEN
                  LET g_inpe_d[l_ac].inpe033 = g_user
                  CALL s_desc_get_person_desc(g_inpe_d[l_ac].inpe033) RETURNING g_inpe_d[l_ac].inpe033_desc                  
                  DISPLAY BY NAME g_inpe_d[l_ac].inpe033_desc
               END IF
               IF cl_null(g_inpe_d[l_ac].inpe034) THEN               
                  LET g_inpe_d[l_ac].inpe034 = g_today
               END IF 
               #add by lixh 20150320
               IF cl_null(g_inpe_d[l_ac].inpe030) AND g_imaf081 <> 2 THEN 
                  LET g_inpe_d[l_ac].inpe030 = 1
               END IF
               #add by lixh 20150320                 
            END IF     
            IF g_type = '2' THEN
               IF cl_null(g_inpe_d[l_ac].inpe038) THEN
                  LET g_inpe_d[l_ac].inpe038 = g_user
                  CALL s_desc_get_person_desc(g_inpe_d[l_ac].inpe038) RETURNING g_inpe_d[l_ac].inpe038_desc
                  DISPLAY BY NAME g_inpe_d[l_ac].inpe038_desc
               END IF
               IF cl_null(g_inpe_d[l_ac].inpe039) THEN              
                  LET g_inpe_d[l_ac].inpe039 = g_today
               END IF 
               #add by lixh 20150320
               IF cl_null(g_inpe_d[l_ac].inpe035) AND g_imaf081 <> 2 THEN 
                  LET g_inpe_d[l_ac].inpe035 = 1
               END IF
               #add by lixh 20150320               
            END IF                
            IF g_type = '3' THEN
               IF cl_null(g_inpe_d[l_ac].inpe053) THEN
                  LET g_inpe_d[l_ac].inpe053 = g_user
                  CALL s_desc_get_person_desc(g_inpe_d[l_ac].inpe053) RETURNING g_inpe_d[l_ac].inpe053_desc
                  DISPLAY BY NAME g_inpe_d[l_ac].inpe053_desc
               END IF
               IF cl_null(g_inpe_d[l_ac].inpe054) THEN
                  LET g_inpe_d[l_ac].inpe054 = g_today
               END IF   
               #add by lixh 20150320
               IF cl_null(g_inpe_d[l_ac].inpe050) AND g_imaf081 <> 2 THEN 
                  LET g_inpe_d[l_ac].inpe050 = 1
               END IF
               #add by lixh 20150320                 
            END IF          
            IF g_type = '4' THEN
               IF cl_null(g_inpe_d[l_ac].inpe058) THEN
                  LET g_inpe_d[l_ac].inpe058 = g_user
                  CALL s_desc_get_person_desc(g_inpe_d[l_ac].inpe058) RETURNING g_inpe_d[l_ac].inpe058_desc
                  DISPLAY BY NAME g_inpe_d[l_ac].inpe058_desc
               END IF
               IF cl_null(g_inpe_d[l_ac].inpe059) THEN
                  LET g_inpe_d[l_ac].inpe059 = g_today
               END IF 
               #add by lixh 20150320
               IF cl_null(g_inpe_d[l_ac].inpe055) AND g_imaf081 <> 2 THEN 
                  LET g_inpe_d[l_ac].inpe055 = 1
               END IF
               #add by lixh 20150320                
            END IF              
            #add-point:modify段before row
            CALL aint830_01_set_entry_b()
            CALL aint830_01_set_no_required()
            CALL aint830_01_set_required(g_inpdsite,g_inpddocno,g_inpdseq)             
            CALL aint830_01_set_no_entry_b(g_inpdsite,g_inpddocno,g_inpdseq)
            #end add-point  
            #其他table資料備份(確定是否更改用)
            
            #其他table進行lock
            
        
         BEFORE INSERT
            
            CALL s_transaction_begin()
            LET l_n = ARR_COUNT()
            LET l_cmd = 'a'
            INITIALIZE g_inpe_d_t.* TO NULL
            INITIALIZE g_inpe_d_o.* TO NULL
            INITIALIZE g_inpe_d[l_ac].* TO NULL 
            #公用欄位給值(單身)
            
            
            LET g_inpe_d_t.* = g_inpe_d[l_ac].*     #新輸入資料
            LET g_inpe_d_o.* = g_inpe_d[l_ac].*     #新輸入資料
            CALL cl_show_fld_cont()
            CALL aint830_01_set_entry_b()
            CALL aint830_01_set_no_entry_b(g_inpdsite,g_inpddocno,g_inpdseq)
            IF lb_reproduce THEN
               LET lb_reproduce = FALSE
               LET g_inpe_d[li_reproduce_target].* = g_inpe_d[li_reproduce].*
 
               LET g_inpe_d[g_inpe_d.getLength()].inpesite = NULL
               LET g_inpe_d[g_inpe_d.getLength()].inpedocno = NULL
               LET g_inpe_d[g_inpe_d.getLength()].inpeseq = NULL
               LET g_inpe_d[g_inpe_d.getLength()].inpeseq2 = NULL
 
            END IF
            
            #add-point:modify段before insert
            LET g_inpe_d[l_ac].inpesite = g_inpdsite
            LET g_inpe_d[l_ac].inpedocno = g_inpddocno
            LET g_inpe_d[l_ac].inpeseq = g_inpdseq
            SELECT MAX(inpeseq2)+1 INTO g_inpe_d[l_ac].inpeseq2 FROM inpe_t
             WHERE inpeent = g_enterprise
               AND inpesite = g_inpe_d[l_ac].inpesite               
               AND inpedocno = g_inpe_d[l_ac].inpedocno
               AND inpeseq = g_inpe_d[l_ac].inpeseq
            IF cl_null(g_inpe_d[l_ac].inpeseq2) THEN LET g_inpe_d[l_ac].inpeseq2 = 1 END IF   
            
            SELECT inpd001,inpd002,inpd003,inpd004,inpd005,inpd006,inpd007,inpd032,inpd033,inpd038,inpd039,inpd052,inpd053,inpd058,inpd059
              INTO g_inpd001,g_inpd002,g_inpd003,g_inpd004,g_inpd005,g_inpd006,g_inpd007,g_inpe_d[l_ac].inpe031,g_inpe_d[l_ac].inpe032,g_inpe_d[l_ac].inpe036,g_inpe_d[l_ac].inpe037,
                   g_inpe_d[l_ac].inpe051,g_inpe_d[l_ac].inpe052,g_inpe_d[l_ac].inpe056,g_inpe_d[l_ac].inpe057
              FROM inpd_t
              WHERE inpdent = g_enterprise
                AND inpdsite = g_inpdsite
                AND inpddocno = g_inpddocno
                AND inpdseq = g_inpdseq
                
            LET g_inpe_d[l_ac].inpe010 = g_today
            IF NOT cl_null(g_imaf032) THEN
               LET g_inpe_d[l_ac].inpe011 = g_inpe_d[l_ac].inpe010 + g_imaf032
            END IF
            IF g_type = '1' THEN
               LET g_inpe_d[l_ac].inpe033 = g_user
               CALL s_desc_get_person_desc(g_inpe_d[l_ac].inpe033) RETURNING g_inpe_d[l_ac].inpe033_desc
               DISPLAY BY NAME g_inpe_d[l_ac].inpe033_desc
               LET g_inpe_d[l_ac].inpe034 = g_today
            END IF     
            IF g_type = '2' THEN
               LET g_inpe_d[l_ac].inpe038 = g_user
               CALL s_desc_get_person_desc(g_inpe_d[l_ac].inpe038) RETURNING g_inpe_d[l_ac].inpe038_desc
               DISPLAY BY NAME g_inpe_d[l_ac].inpe038_desc
               LET g_inpe_d[l_ac].inpe039 = g_today
            END IF                
            IF g_type = '3' THEN
               LET g_inpe_d[l_ac].inpe053 = g_user
               CALL s_desc_get_person_desc(g_inpe_d[l_ac].inpe053) RETURNING g_inpe_d[l_ac].inpe053_desc
               DISPLAY BY NAME g_inpe_d[l_ac].inpe053_desc
               LET g_inpe_d[l_ac].inpe054 = g_today
            END IF          
            IF g_type = '4' THEN
               LET g_inpe_d[l_ac].inpe058 = g_user
               CALL s_desc_get_person_desc(g_inpe_d[l_ac].inpe058) RETURNING g_inpe_d[l_ac].inpe058_desc
               DISPLAY BY NAME g_inpe_d[l_ac].inpe058_desc
               LET g_inpe_d[l_ac].inpe059 = g_today
            END IF               
            #end add-point  
  
         AFTER INSERT
            IF INT_FLAG THEN
               INITIALIZE g_errparam TO NULL
               LET g_errparam.code = 9001
               LET g_errparam.extend = ''
               LET g_errparam.popup = FALSE
               CALL cl_err()

               LET INT_FLAG = 0
#               CANCEL INSERT
            END IF
               
            LET l_count = 1  
            SELECT COUNT(*) INTO l_count FROM inpe_t 
             WHERE inpeent = g_enterprise AND inpesite = g_inpe_d[l_ac].inpesite
                                       AND inpedocno = g_inpe_d[l_ac].inpedocno
                                       AND inpeseq = g_inpe_d[l_ac].inpeseq
                                       AND inpeseq2 = g_inpe_d[l_ac].inpeseq2
 
                
            #資料未重複, 插入新增資料
            IF l_count = 0 THEN 
               #add-point:單身新增前

               #end add-point
            
                              INITIALIZE gs_keys TO NULL 
               LET gs_keys[1] = g_inpe_d[g_detail_idx].inpesite
               LET gs_keys[2] = g_inpe_d[g_detail_idx].inpedocno
               LET gs_keys[3] = g_inpe_d[g_detail_idx].inpeseq
               LET gs_keys[4] = g_inpe_d[g_detail_idx].inpeseq2
               IF NOT aint830_01_insert_b('inpe_t',gs_keys,"'1'") THEN 
                  CALL s_transaction_end('N','0')
#                 CANCEL INSERT                   
               END IF             
               #add-point:單身新增後

               #end add-point
            ELSE    
               INITIALIZE g_errparam TO NULL
               LET g_errparam.code = "std-00006"
               LET g_errparam.extend = 'INSERT'
               LET g_errparam.popup = TRUE
               CALL cl_err()

               INITIALIZE g_inpe_d[l_ac].* TO NULL
               CALL s_transaction_end('N','0')
#               CANCEL INSERT
            END IF
 
            IF SQLCA.SQLcode  THEN
               INITIALIZE g_errparam TO NULL
               LET g_errparam.code = SQLCA.sqlcode
               LET g_errparam.extend = "inpe_t"
               LET g_errparam.popup = TRUE
               CALL cl_err()
  
               CALL s_transaction_end('N','0')                    
#               CANCEL INSERT
            ELSE
               #先刷新資料
               #CALL aint830_01_b_fill(g_wc_source)
               #資料多語言用-增/改
               
               #add-point:input段-after_insert

               #end add-point
               CALL s_transaction_end('Y','0')
               ERROR 'INSERT O.K'
               LET g_detail_cnt = g_detail_cnt + 1
               
#              LET g_wc_source = g_wc_source, " OR (inpesite = '", g_inpe_d[l_ac].inpesite, "' "   #mark by lixh 20141029
#                                 ," AND inpedocno = '", g_inpe_d[l_ac].inpedocno, "' "
#                                 ," AND inpeseq = '", g_inpe_d[l_ac].inpeseq, "' "
#                                 ," AND inpeseq2 = '", g_inpe_d[l_ac].inpeseq2, "' "
#
#                                 ,")"
            END IF                
              
         BEFORE DELETE                            #是否取消單身
            IF l_cmd = 'a' AND g_inpe_d.getLength() < l_ac THEN
               CALL FGL_SET_ARR_CURR(l_ac-1)
               CALL g_inpe_d.deleteElement(l_ac)
               NEXT FIELD inpesite
            END IF
            IF g_inpe_d[l_ac].inpesite IS NOT NULL
               AND g_inpe_d_t.inpedocno IS NOT NULL
               AND g_inpe_d_t.inpeseq IS NOT NULL
               AND g_inpe_d_t.inpeseq2 IS NOT NULL
 
               THEN     
            
               #add-point:單身刪除ask前

               #end add-point   
               
               IF NOT cl_ask_del_detail() THEN
#                  CANCEL DELETE
               END IF
               IF l_lock_sw = "Y" THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code =  -263
                  LET g_errparam.extend = ""
                  LET g_errparam.popup = TRUE
                  CALL cl_err()

#                  CANCEL DELETE
               END IF
               
               #add-point:單身刪除前

               #end add-point   
               
               DELETE FROM inpe_t
                WHERE inpeent = g_enterprise AND 
                      inpesite = g_inpe_d_t.inpesite
                      AND inpedocno = g_inpe_d_t.inpedocno
                      AND inpeseq = g_inpe_d_t.inpeseq
                      AND inpeseq2 = g_inpe_d_t.inpeseq2
 
                      
               #add-point:單身刪除中

               #end add-point  
                      
               IF SQLCA.sqlcode THEN
                  INITIALIZE g_errparam TO NULL
               LET g_errparam.code = SQLCA.sqlcode
               LET g_errparam.extend = "inpe_t"
               LET g_errparam.popup = TRUE
               CALL cl_err()

                  CALL s_transaction_end('N','0')
#                  CANCEL DELETE   
               ELSE
                  LET g_detail_cnt = g_detail_cnt-1
                  
                  #add-point:單身刪除後

                  #end add-point
                  CALL s_transaction_end('Y','0')
               END IF 
               CLOSE aint830_01_bcl
               LET l_count = g_inpe_d.getLength()
            END IF 
                           INITIALIZE gs_keys TO NULL 
               LET gs_keys[1] = g_inpe_d[g_detail_idx].inpesite
               LET gs_keys[2] = g_inpe_d[g_detail_idx].inpedocno
               LET gs_keys[3] = g_inpe_d[g_detail_idx].inpeseq
               LET gs_keys[4] = g_inpe_d[g_detail_idx].inpeseq2
 
              
         AFTER DELETE 
            #add-point:單身刪除後2

            #end add-point
            CALL aint830_01_delete_b('inpe_t',gs_keys,"'1'")
 
                  #此段落由子樣板a01產生
         BEFORE FIELD inpedocno
            #add-point:BEFORE FIELD inpedocno

            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD inpedocno
            
            #add-point:AFTER FIELD inpedocno
            #此段落由子樣板a05產生
            IF  g_inpe_d[g_detail_idx].inpesite IS NOT NULL AND g_inpe_d[g_detail_idx].inpedocno IS NOT NULL AND g_inpe_d[g_detail_idx].inpeseq IS NOT NULL AND g_inpe_d[g_detail_idx].inpeseq2 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_inpe_d[g_detail_idx].inpesite != g_inpe_d_t.inpesite OR g_inpe_d[g_detail_idx].inpedocno != g_inpe_d_t.inpedocno OR g_inpe_d[g_detail_idx].inpeseq != g_inpe_d_t.inpeseq OR g_inpe_d[g_detail_idx].inpeseq2 != g_inpe_d_t.inpeseq2)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM inpe_t WHERE "||"inpeent = '" ||g_enterprise|| "' AND "||"inpesite = '"||g_inpe_d[g_detail_idx].inpesite ||"' AND "|| "inpedocno = '"||g_inpe_d[g_detail_idx].inpedocno ||"' AND "|| "inpeseq = '"||g_inpe_d[g_detail_idx].inpeseq ||"' AND "|| "inpeseq2 = '"||g_inpe_d[g_detail_idx].inpeseq2 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF


            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE inpedocno
            #add-point:ON CHANGE inpedocno

            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD inpeseq
            #add-point:BEFORE FIELD inpeseq

            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD inpeseq
            
            #add-point:AFTER FIELD inpeseq
            #此段落由子樣板a05產生
            IF  g_inpe_d[g_detail_idx].inpesite IS NOT NULL AND g_inpe_d[g_detail_idx].inpedocno IS NOT NULL AND g_inpe_d[g_detail_idx].inpeseq IS NOT NULL AND g_inpe_d[g_detail_idx].inpeseq2 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_inpe_d[g_detail_idx].inpesite != g_inpe_d_t.inpesite OR g_inpe_d[g_detail_idx].inpedocno != g_inpe_d_t.inpedocno OR g_inpe_d[g_detail_idx].inpeseq != g_inpe_d_t.inpeseq OR g_inpe_d[g_detail_idx].inpeseq2 != g_inpe_d_t.inpeseq2)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM inpe_t WHERE "||"inpeent = '" ||g_enterprise|| "' AND "||"inpesite = '"||g_inpe_d[g_detail_idx].inpesite ||"' AND "|| "inpedocno = '"||g_inpe_d[g_detail_idx].inpedocno ||"' AND "|| "inpeseq = '"||g_inpe_d[g_detail_idx].inpeseq ||"' AND "|| "inpeseq2 = '"||g_inpe_d[g_detail_idx].inpeseq2 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF


            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE inpeseq
            #add-point:ON CHANGE inpeseq

            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD inpeseq2
            #add-point:BEFORE FIELD inpeseq2
            IF cl_null(g_inpe_d[l_ac].inpeseq2) THEN
               SELECT MAX(inpeseq2)+1 INTO g_inpe_d[l_ac].inpeseq2 FROM inpe_t
                WHERE inpeent = g_enterprise
                  AND inpesite = g_inpe_d[l_ac].inpesite               
                  AND inpedocno = g_inpe_d[l_ac].inpedocno
                  AND inpeseq = g_inpe_d[l_ac].inpeseq
            END IF   
            IF cl_null(g_inpe_d[l_ac].inpeseq2) THEN LET g_inpe_d[l_ac].inpeseq2 = 1 END IF  
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD inpeseq2
            
            #add-point:AFTER FIELD inpeseq2
            #此段落由子樣板a05產生
            IF  g_inpe_d[g_detail_idx].inpesite IS NOT NULL AND g_inpe_d[g_detail_idx].inpedocno IS NOT NULL AND g_inpe_d[g_detail_idx].inpeseq IS NOT NULL AND g_inpe_d[g_detail_idx].inpeseq2 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_inpe_d[g_detail_idx].inpesite != g_inpe_d_t.inpesite OR g_inpe_d[g_detail_idx].inpedocno != g_inpe_d_t.inpedocno OR g_inpe_d[g_detail_idx].inpeseq != g_inpe_d_t.inpeseq OR g_inpe_d[g_detail_idx].inpeseq2 != g_inpe_d_t.inpeseq2)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM inpe_t WHERE "||"inpeent = '" ||g_enterprise|| "' AND "||"inpesite = '"||g_inpe_d[g_detail_idx].inpesite ||"' AND "|| "inpedocno = '"||g_inpe_d[g_detail_idx].inpedocno ||"' AND "|| "inpeseq = '"||g_inpe_d[g_detail_idx].inpeseq ||"' AND "|| "inpeseq2 = '"||g_inpe_d[g_detail_idx].inpeseq2 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF


            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE inpeseq2
            #add-point:ON CHANGE inpeseq2

            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD inpesite
            #add-point:BEFORE FIELD inpesite

            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD inpesite
            
            #add-point:AFTER FIELD inpesite
            #此段落由子樣板a05產生
            IF  g_inpe_d[g_detail_idx].inpesite IS NOT NULL AND g_inpe_d[g_detail_idx].inpedocno IS NOT NULL AND g_inpe_d[g_detail_idx].inpeseq IS NOT NULL AND g_inpe_d[g_detail_idx].inpeseq2 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_inpe_d[g_detail_idx].inpesite != g_inpe_d_t.inpesite OR g_inpe_d[g_detail_idx].inpedocno != g_inpe_d_t.inpedocno OR g_inpe_d[g_detail_idx].inpeseq != g_inpe_d_t.inpeseq OR g_inpe_d[g_detail_idx].inpeseq2 != g_inpe_d_t.inpeseq2)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM inpe_t WHERE "||"inpeent = '" ||g_enterprise|| "' AND "||"inpesite = '"||g_inpe_d[g_detail_idx].inpesite ||"' AND "|| "inpedocno = '"||g_inpe_d[g_detail_idx].inpedocno ||"' AND "|| "inpeseq = '"||g_inpe_d[g_detail_idx].inpeseq ||"' AND "|| "inpeseq2 = '"||g_inpe_d[g_detail_idx].inpeseq2 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF


            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE inpesite
            #add-point:ON CHANGE inpesite

            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD inpe008
            #add-point:BEFORE FIELD inpe008

            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD inpe008
            
            #add-point:AFTER FIELD inpe008
            IF NOT cl_null(g_inpe_d[l_ac].inpe008)  THEN
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND g_inpe_d[g_detail_idx].inpe008 != g_inpe_d_t.inpe008) THEN
                  #若料號有作製造批號唯一時，需檢核維護的製造批號資是否已經存在inai_t檔中
                  LET l_cnt = 0
                  SELECT COUNT(*) INTO l_cnt
                    FROM inai_t
                   WHERE inaient = g_enterprise
                     AND inai007 = g_inpe_d[l_ac].inpe008
                     AND inaisite = p_inpesite
                     AND inai001 = l_inpd001
                     AND inai002 = l_inpd002
                  IF cl_null(l_cnt) THEN LET l_cnt = 0 END IF
                  IF l_cnt = 0 THEN
                     SELECT COUNT(*) INTO l_cnt
                       FROM inpe_t
                      WHERE inpeent = g_enterprise
                        AND inpesite = p_inpesite
                        AND inpe001 = l_inpd001
                        AND inpe002 = l_inpd002
                        AND inpe008 = g_inpe_d[l_ac].inpe008
                     IF cl_null(l_cnt) THEN LET l_cnt = 0 END IF
                  END IF
                  #若有請依據料號設置的控管方式控管
                  IF l_cnt <> 0 THEN
                     CASE g_imaf074
                        WHEN '1'
                           INITIALIZE g_errparam TO NULL
                           LET g_errparam.code = 'sub-00502'
                           LET g_errparam.extend = g_inpe_d[l_ac].inpe008
                           LET g_errparam.popup = TRUE
                           CALL cl_err()

                           LET g_inpe_d[l_ac].inpe008 = g_inpe_d_t.inpe008
                           NEXT FIELD inpe008
                        WHEN '2'
                           CALL cl_ask_pressanykey('sub-00503')
                        OTHERWISE EXIT CASE
                     END CASE
                  END IF
               END IF
            END IF
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE inpe008
            #add-point:ON CHANGE inpe008

            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD inpe009
            #add-point:BEFORE FIELD inpe009

            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD inpe009
            
            #add-point:AFTER FIELD inpe009

            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE inpe009
            #add-point:ON CHANGE inpe009

            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD inpe012
            #此段落由子樣板a15產生
            IF NOT cl_ap_chk_Range(g_inpe_d[l_ac].inpe012,"0.000","0","","","azz-00079",1) THEN
               NEXT FIELD inpe012
            END IF
 
 
            #add-point:AFTER FIELD inpe012
            IF NOT cl_null(g_inpe_d[l_ac].inpe012) THEN 
            END IF 


            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD inpe012
            #add-point:BEFORE FIELD inpe012

            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE inpe012
            #add-point:ON CHANGE inpe012

            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD inpe030
            #add-point:BEFORE FIELD inpe030

            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD inpe030
            
            #add-point:AFTER FIELD inpe030
            IF NOT cl_ap_chk_range(g_inpe_d[l_ac].inpe030,"0","1","","","azz-00079",1) THEN
               NEXT FIELD inpe030
            END IF   
            IF NOT cl_null(g_inpe_d[l_ac].inpe030) THEN            
               LET l_sum = 0
               SELECT SUM(inpe030) INTO l_sum FROM inpe_t
                WHERE inpeent = g_enterprise
                  AND inpesite = g_site 
                  AND inpedocno = p_inpedocno
                  AND inpeseq = p_inpeseq
                  AND inpeseq2 <> g_inpe_d[l_ac].inpeseq2
               IF cl_null(l_sum) THEN
                  LET l_sum = 0
               END IF
               IF l_sum + g_inpe_d[l_ac].inpe030 > g_inpd_sum THEN                  
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = 'ain-00474'
                  LET g_errparam.extend = g_inpe_d[l_ac].inpe030
                  LET g_errparam.popup = TRUE
                  CALL cl_err()   
                  LET g_inpe_d[l_ac].inpe030 = g_inpe_d_t.inpe030 
                  NEXT FIELD inpe030                   
               END IF 
               IF NOT cl_null(g_inpe_d[l_ac].inpe009) THEN   #add by lixh 20150323
                  IF NOT aint830_01_num_chk(g_inpe_d[l_ac].inpe030) THEN
                     LET g_inpe_d[l_ac].inpe030 = g_inpe_d_t.inpe030
                     NEXT FIELD inpe030 
                  END IF
               END IF               
            END IF               
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE inpe030
            #add-point:ON CHANGE inpe030

            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD inpe035
            #add-point:BEFORE FIELD inpe035

            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD inpe035
            
            #add-point:AFTER FIELD inpe035
            IF NOT cl_ap_chk_range(g_inpe_d[l_ac].inpe035,"0","1","","","azz-00079",1) THEN
               NEXT FIELD inpe035
            END IF   
            IF NOT cl_null(g_inpe_d[l_ac].inpe035) THEN            
               LET l_sum = 0
               SELECT SUM(inpe035) INTO l_sum FROM inpe_t
                WHERE inpeent = g_enterprise
                  AND inpesite = g_site 
                  AND inpedocno = p_inpedocno
                  AND inpeseq = p_inpeseq
                  AND inpeseq2 <> g_inpe_d[l_ac].inpeseq2
               IF cl_null(l_sum) THEN
                  LET l_sum = 0
               END IF
               IF l_sum + g_inpe_d[l_ac].inpe035 > g_inpd_sum THEN                  
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = 'ain-00474'
                  LET g_errparam.extend = g_inpe_d[l_ac].inpe035
                  LET g_errparam.popup = TRUE
                  CALL cl_err()   
                  LET g_inpe_d[l_ac].inpe035 = g_inpe_d_t.inpe035  
                  NEXT FIELD inpe035                  
               END IF  
               IF NOT cl_null(g_inpe_d[l_ac].inpe009) THEN   #add by lixh 20150323
                  IF NOT aint830_01_num_chk(g_inpe_d[l_ac].inpe035) THEN
                     LET g_inpe_d[l_ac].inpe035 = g_inpe_d_t.inpe035
                     NEXT FIELD inpe035 
                  END IF  
               END IF               
            END IF  
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE inpe035
            #add-point:ON CHANGE inpe035

            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD inpe050
            #add-point:BEFORE FIELD inpe050

            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD inpe050
            
            #add-point:AFTER FIELD inpe050
            IF NOT cl_ap_chk_range(g_inpe_d[l_ac].inpe050,"0","1","","","azz-00079",1) THEN
               NEXT FIELD inpe050
            END IF   
            IF NOT cl_null(g_inpe_d[l_ac].inpe050) THEN            
               LET l_sum = 0
               SELECT SUM(inpe050) INTO l_sum FROM inpe_t
                WHERE inpeent = g_enterprise
                  AND inpesite = g_site 
                  AND inpedocno = p_inpedocno
                  AND inpeseq = p_inpeseq
                  AND inpeseq2 <> g_inpe_d[l_ac].inpeseq2
               IF cl_null(l_sum) THEN
                  LET l_sum = 0
               END IF
               IF l_sum + g_inpe_d[l_ac].inpe050 > g_inpd_sum THEN                  
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = 'ain-00474'
                  LET g_errparam.extend = g_inpe_d[l_ac].inpe050
                  LET g_errparam.popup = TRUE
                  CALL cl_err()   
                  LET g_inpe_d[l_ac].inpe050 = g_inpe_d_t.inpe050 
                  NEXT FIELD inpe050                   
               END IF 
               IF NOT cl_null(g_inpe_d[l_ac].inpe009) THEN   #add by lixh 20150323
                  IF NOT aint830_01_num_chk(g_inpe_d[l_ac].inpe050) THEN
                     LET g_inpe_d[l_ac].inpe050 = g_inpe_d_t.inpe050
                     NEXT FIELD inpe050 
                  END IF 
               END IF               
            END IF  
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE inpe050
            #add-point:ON CHANGE inpe050

            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD inpe055
            #add-point:BEFORE FIELD inpe055

            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD inpe055
            
            #add-point:AFTER FIELD inpe055
            IF NOT cl_ap_chk_range(g_inpe_d[l_ac].inpe055,"0","1","","","azz-00079",1) THEN
               NEXT FIELD inpe055
            END IF   
            IF NOT cl_null(g_inpe_d[l_ac].inpe055) THEN            
               LET l_sum = 0
               SELECT SUM(inpe055) INTO l_sum FROM inpe_t
                WHERE inpeent = g_enterprise
                  AND inpesite = g_site 
                  AND inpedocno = p_inpedocno
                  AND inpeseq = p_inpeseq
                  AND inpeseq2 <> g_inpe_d[l_ac].inpeseq2
               IF cl_null(l_sum) THEN
                  LET l_sum = 0
               END IF
               IF l_sum + g_inpe_d[l_ac].inpe055 > g_inpd_sum THEN                  
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = 'ain-00474'
                  LET g_errparam.extend = g_inpe_d[l_ac].inpe055
                  LET g_errparam.popup = TRUE
                  CALL cl_err()   
                  LET g_inpe_d[l_ac].inpe055 = g_inpe_d_t.inpe055  
                  NEXT FIELD inpe055                   
               END IF  
               #add by lixh 20150320
               IF NOT cl_null(g_inpe_d[l_ac].inpe009) THEN   #add by lixh 20150323
                  IF NOT aint830_01_num_chk(g_inpe_d[l_ac].inpe055) THEN
                     LET g_inpe_d[l_ac].inpe055 = g_inpe_d_t.inpe055
                     NEXT FIELD inpe055 
                  END IF  
               END IF
               #add by lixh 20150320               
            END IF  
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE inpe055
            #add-point:ON CHANGE inpe055

            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD inpe010
            #add-point:BEFORE FIELD inpe010

            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD inpe010
            
            #add-point:AFTER FIELD inpe010

            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE inpe010
            #add-point:ON CHANGE inpe010

            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD inpe011
            #add-point:BEFORE FIELD inpe011

            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD inpe011
            
            #add-point:AFTER FIELD inpe011

            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE inpe011
            #add-point:ON CHANGE inpe011

            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD inpe031
            
            #add-point:AFTER FIELD inpe031
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_inpe_d[l_ac].inpe031
            CALL ap_ref_array2(g_ref_fields,"SELECT ooag011 FROM ooag_t WHERE ooagent='"||g_enterprise||"' AND ooag001=? ","") RETURNING g_rtn_fields
            LET g_inpe_d[l_ac].inpe031_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_inpe_d[l_ac].inpe031_desc


            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD inpe031
            #add-point:BEFORE FIELD inpe031

            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE inpe031
            #add-point:ON CHANGE inpe031

            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD inpe032
            #add-point:BEFORE FIELD inpe032

            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD inpe032
            
            #add-point:AFTER FIELD inpe032

            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE inpe032
            #add-point:ON CHANGE inpe032

            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD inpe033
            
            #add-point:AFTER FIELD inpe033
            CALL s_desc_get_person_desc(g_inpe_d[l_ac].inpe033) RETURNING g_inpe_d[l_ac].inpe033_desc
            IF NOT cl_null(g_inpe_d[l_ac].inpe033) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數

               LET g_chkparam.arg1 = g_inpe_d[l_ac].inpe033 
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_ooag001") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 
               ELSE
                  #檢查失敗時後續處理
                  LET g_inpe_d[l_ac].inpe033 = g_inpe_d_t.inpe033 
                  CALL s_desc_get_person_desc(g_inpe_d[l_ac].inpe033) RETURNING g_inpe_d[l_ac].inpe033_desc
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
            CALL s_desc_get_person_desc(g_inpe_d[l_ac].inpe033) RETURNING g_inpe_d[l_ac].inpe033_desc


            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD inpe033
            #add-point:BEFORE FIELD inpe033

            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE inpe033
            #add-point:ON CHANGE inpe033

            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD inpe034
            #add-point:BEFORE FIELD inpe034

            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD inpe034
            
            #add-point:AFTER FIELD inpe034

            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE inpe034
            #add-point:ON CHANGE inpe034

            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD inpe036
            
            #add-point:AFTER FIELD inpe036
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_inpe_d[l_ac].inpe036
            CALL ap_ref_array2(g_ref_fields,"SELECT ooag011 FROM ooag_t WHERE ooagent='"||g_enterprise||"' AND ooag001=? ","") RETURNING g_rtn_fields
            LET g_inpe_d[l_ac].inpe036_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_inpe_d[l_ac].inpe036_desc


            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD inpe036
            #add-point:BEFORE FIELD inpe036

            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE inpe036
            #add-point:ON CHANGE inpe036

            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD inpe037
            #add-point:BEFORE FIELD inpe037

            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD inpe037
            
            #add-point:AFTER FIELD inpe037

            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE inpe037
            #add-point:ON CHANGE inpe037

            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD inpe038
            
            #add-point:AFTER FIELD inpe038
            #add-point:AFTER FIELD inpe038
            CALL s_desc_get_person_desc(g_inpe_d[l_ac].inpe038) RETURNING g_inpe_d[l_ac].inpe038_desc
            IF NOT cl_null(g_inpe_d[l_ac].inpe038) THEN 
#此段落由子樣板a19產生
               #校驗代值
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數

               LET g_chkparam.arg1 = g_inpe_d[l_ac].inpe038   
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_ooag001") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 
               ELSE
                  #檢查失敗時後續處理
                  LET g_inpe_d[l_ac].inpe038 = g_inpe_d_t.inpe038  
                  CALL s_desc_get_person_desc(g_inpe_d[l_ac].inpe038) RETURNING g_inpe_d[l_ac].inpe038_desc
                  NEXT FIELD CURRENT
               END IF
              
            END IF 
            CALL s_desc_get_person_desc(g_inpe_d[l_ac].inpe038) RETURNING g_inpe_d[l_ac].inpe038_desc

            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD inpe038
            #add-point:BEFORE FIELD inpe038

            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE inpe038
            #add-point:ON CHANGE inpe038

            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD inpe039
            #add-point:BEFORE FIELD inpe039

            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD inpe039
            
            #add-point:AFTER FIELD inpe039

            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE inpe039
            #add-point:ON CHANGE inpe039

            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD inpe051
            
            #add-point:AFTER FIELD inpe051
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_inpe_d[l_ac].inpe051
            CALL ap_ref_array2(g_ref_fields,"SELECT ooag011 FROM ooag_t WHERE ooagent='"||g_enterprise||"' AND ooag001=? ","") RETURNING g_rtn_fields
            LET g_inpe_d[l_ac].inpe051_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_inpe_d[l_ac].inpe051_desc


            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD inpe051
            #add-point:BEFORE FIELD inpe051

            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE inpe051
            #add-point:ON CHANGE inpe051

            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD inpe052
            #add-point:BEFORE FIELD inpe052

            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD inpe052
            
            #add-point:AFTER FIELD inpe052

            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE inpe052
            #add-point:ON CHANGE inpe052

            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD inpe053
            
            #add-point:AFTER FIELD inpe053
            CALL s_desc_get_person_desc(g_inpe_d[l_ac].inpe053) RETURNING g_inpe_d[l_ac].inpe053_desc
            IF NOT cl_null(g_inpe_d[l_ac].inpe053) THEN 
#此段落由子樣板a19產生
               #校驗代值
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數

               LET g_chkparam.arg1 = g_inpe_d[l_ac].inpe053   
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_ooag001") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 
               ELSE
                  #檢查失敗時後續處理
                  LET g_inpe_d[l_ac].inpe053 = g_inpe_d_t.inpe053  
                  CALL s_desc_get_person_desc(g_inpe_d[l_ac].inpe053) RETURNING g_inpe_d[l_ac].inpe053_desc
                  NEXT FIELD CURRENT
               END IF
              
            END IF 
            CALL s_desc_get_person_desc(g_inpe_d[l_ac].inpe053) RETURNING g_inpe_d[l_ac].inpe053_desc
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD inpe053
            #add-point:BEFORE FIELD inpe053

            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE inpe053
            #add-point:ON CHANGE inpe053

            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD inpe054
            #add-point:BEFORE FIELD inpe054

            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD inpe054
            
            #add-point:AFTER FIELD inpe054

            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE inpe054
            #add-point:ON CHANGE inpe054

            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD inpe056
            
            #add-point:AFTER FIELD inpe056
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_inpe_d[l_ac].inpe056
            CALL ap_ref_array2(g_ref_fields,"SELECT ooag011 FROM ooag_t WHERE ooagent='"||g_enterprise||"' AND ooag001=? ","") RETURNING g_rtn_fields
            LET g_inpe_d[l_ac].inpe056_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_inpe_d[l_ac].inpe056_desc


            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD inpe056
            #add-point:BEFORE FIELD inpe056

            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE inpe056
            #add-point:ON CHANGE inpe056

            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD inpe057
            #add-point:BEFORE FIELD inpe057

            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD inpe057
            
            #add-point:AFTER FIELD inpe057

            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE inpe057
            #add-point:ON CHANGE inpe057

            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD inpe058
            
            #add-point:AFTER FIELD inpe058
            CALL s_desc_get_person_desc(g_inpe_d[l_ac].inpe058) RETURNING g_inpe_d[l_ac].inpe058_desc
            IF NOT cl_null(g_inpe_d[l_ac].inpe058) THEN 
#此段落由子樣板a19產生
               #校驗代值
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數

               LET g_chkparam.arg1 = g_inpe_d[l_ac].inpe058   
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_ooag001") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 
               ELSE
                  #檢查失敗時後續處理
                  LET g_inpe_d[l_ac].inpe058 = g_inpe_d_t.inpe058  
                  CALL s_desc_get_person_desc(g_inpe_d[l_ac].inpe058) RETURNING g_inpe_d[l_ac].inpe058_desc
                  NEXT FIELD CURRENT
               END IF
              
            END IF 
            CALL s_desc_get_person_desc(g_inpe_d[l_ac].inpe058) RETURNING g_inpe_d[l_ac].inpe058_desc
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD inpe058
            #add-point:BEFORE FIELD inpe058

            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE inpe058
            #add-point:ON CHANGE inpe058

            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD inpe059
            #add-point:BEFORE FIELD inpe059

            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD inpe059
            
            #add-point:AFTER FIELD inpe059

            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE inpe059
            #add-point:ON CHANGE inpe059

            #END add-point
 
 
                  #Ctrlp:input.c.page1.inpedocno
         ON ACTION controlp INFIELD inpedocno
            #add-point:ON ACTION controlp INFIELD inpedocno

            #END add-point
 
         #Ctrlp:input.c.page1.inpeseq
         ON ACTION controlp INFIELD inpeseq
            #add-point:ON ACTION controlp INFIELD inpeseq

            #END add-point
 
         #Ctrlp:input.c.page1.inpeseq2
         ON ACTION controlp INFIELD inpeseq2
            #add-point:ON ACTION controlp INFIELD inpeseq2

            #END add-point
 
         #Ctrlp:input.c.page1.inpesite
         ON ACTION controlp INFIELD inpesite
            #add-point:ON ACTION controlp INFIELD inpesite

            #END add-point
 
         #Ctrlp:input.c.page1.inpe008
         ON ACTION controlp INFIELD inpe008
            #add-point:ON ACTION controlp INFIELD inpe008

            #END add-point
 
         #Ctrlp:input.c.page1.inpe009
         ON ACTION controlp INFIELD inpe009
            #add-point:ON ACTION controlp INFIELD inpe009

            #END add-point
 
         #Ctrlp:input.c.page1.inpe012
         ON ACTION controlp INFIELD inpe012
            #add-point:ON ACTION controlp INFIELD inpe012

            #END add-point
 
         #Ctrlp:input.c.page1.inpe030
         ON ACTION controlp INFIELD inpe030
            #add-point:ON ACTION controlp INFIELD inpe030

            #END add-point
 
         #Ctrlp:input.c.page1.inpe035
         ON ACTION controlp INFIELD inpe035
            #add-point:ON ACTION controlp INFIELD inpe035

            #END add-point
 
         #Ctrlp:input.c.page1.inpe050
         ON ACTION controlp INFIELD inpe050
            #add-point:ON ACTION controlp INFIELD inpe050

            #END add-point
 
         #Ctrlp:input.c.page1.inpe055
         ON ACTION controlp INFIELD inpe055
            #add-point:ON ACTION controlp INFIELD inpe055

            #END add-point
 
         #Ctrlp:input.c.page1.inpe010
         ON ACTION controlp INFIELD inpe010
            #add-point:ON ACTION controlp INFIELD inpe010

            #END add-point
 
         #Ctrlp:input.c.page1.inpe011
         ON ACTION controlp INFIELD inpe011
            #add-point:ON ACTION controlp INFIELD inpe011

            #END add-point
 
         #Ctrlp:input.c.page1.inpe031
         ON ACTION controlp INFIELD inpe031
            #add-point:ON ACTION controlp INFIELD inpe031

            #END add-point
 
         #Ctrlp:input.c.page1.inpe032
         ON ACTION controlp INFIELD inpe032
            #add-point:ON ACTION controlp INFIELD inpe032

            #END add-point
 
         #Ctrlp:input.c.page1.inpe033
         ON ACTION controlp INFIELD inpe033
            #add-point:ON ACTION controlp INFIELD inpe033
            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_inpe_d[l_ac].inpe033             #給予default值

            #給予arg
            
            CALL q_ooag001()                                #呼叫開窗

            LET g_inpe_d[l_ac].inpe033 = g_qryparam.return1              

            DISPLAY g_inpe_d[l_ac].inpe033 TO inpe033              #

            NEXT FIELD inpe033                          #返回原欄位


            #END add-point
 
         #Ctrlp:input.c.page1.inpe034
         ON ACTION controlp INFIELD inpe034
            #add-point:ON ACTION controlp INFIELD inpe034

            #END add-point
 
         #Ctrlp:input.c.page1.inpe036
         ON ACTION controlp INFIELD inpe036
            #add-point:ON ACTION controlp INFIELD inpe036

            #END add-point
 
         #Ctrlp:input.c.page1.inpe037
         ON ACTION controlp INFIELD inpe037
            #add-point:ON ACTION controlp INFIELD inpe037

            #END add-point
 
         #Ctrlp:input.c.page1.inpe038
         ON ACTION controlp INFIELD inpe038
            #add-point:ON ACTION controlp INFIELD inpe038
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_inpe_d[l_ac].inpe038            #給予default值

            #給予arg
            
            CALL q_ooag001()                                #呼叫開窗

            LET g_inpe_d[l_ac].inpe038 = g_qryparam.return1              

            DISPLAY g_inpe_d[l_ac].inpe038 TO inpe038              #

            NEXT FIELD inpe038                          #返回原欄位
            #END add-point
 
         #Ctrlp:input.c.page1.inpe039
         ON ACTION controlp INFIELD inpe039
            #add-point:ON ACTION controlp INFIELD inpe039

            #END add-point
 
         #Ctrlp:input.c.page1.inpe051
         ON ACTION controlp INFIELD inpe051
            #add-point:ON ACTION controlp INFIELD inpe051

            #END add-point
 
         #Ctrlp:input.c.page1.inpe052
         ON ACTION controlp INFIELD inpe052
            #add-point:ON ACTION controlp INFIELD inpe052

            #END add-point
 
         #Ctrlp:input.c.page1.inpe053
         ON ACTION controlp INFIELD inpe053
            #add-point:ON ACTION controlp INFIELD inpe053
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_inpe_d[l_ac].inpe053             #給予default值

            #給予arg
            
            CALL q_ooag001()                                #呼叫開窗

            LET g_inpe_d[l_ac].inpe053 = g_qryparam.return1              

            DISPLAY g_inpe_d[l_ac].inpe053 TO inpe053              #

            NEXT FIELD inpe053                          #返回原欄位
            #END add-point
 
         #Ctrlp:input.c.page1.inpe054
         ON ACTION controlp INFIELD inpe054
            #add-point:ON ACTION controlp INFIELD inpe054

            #END add-point
 
         #Ctrlp:input.c.page1.inpe056
         ON ACTION controlp INFIELD inpe056
            #add-point:ON ACTION controlp INFIELD inpe056

            #END add-point
 
         #Ctrlp:input.c.page1.inpe057
         ON ACTION controlp INFIELD inpe057
            #add-point:ON ACTION controlp INFIELD inpe057

            #END add-point
 
         #Ctrlp:input.c.page1.inpe058
         ON ACTION controlp INFIELD inpe058
            #add-point:ON ACTION controlp INFIELD inpe058
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_inpe_d[l_ac].inpe058             #給予default值

            #給予arg
            
            CALL q_ooag001()                                #呼叫開窗

            LET g_inpe_d[l_ac].inpe058 = g_qryparam.return1              

            DISPLAY g_inpe_d[l_ac].inpe058 TO inpe058             #

            NEXT FIELD inpe058                          #返回原欄位
            #END add-point
 
         #Ctrlp:input.c.page1.inpe059
         ON ACTION controlp INFIELD inpe059
            #add-point:ON ACTION controlp INFIELD inpe059

            #END add-point
 
 
 
         ON ROW CHANGE
            IF INT_FLAG THEN
               INITIALIZE g_errparam TO NULL
               LET g_errparam.code = 9001
               LET g_errparam.extend = ''
               LET g_errparam.popup = FALSE
               CALL cl_err()

               LET INT_FLAG = 0
               LET g_inpe_d[l_ac].* = g_inpe_d_t.*
               CLOSE aint830_01_bcl
               CALL s_transaction_end('N','0')
               EXIT DIALOG 
            END IF
              
            IF l_lock_sw = 'Y' THEN
               INITIALIZE g_errparam TO NULL
               LET g_errparam.code = -263
               LET g_errparam.extend = g_inpe_d[l_ac].inpesite
               LET g_errparam.popup = TRUE
               CALL cl_err()

               LET g_inpe_d[l_ac].* = g_inpe_d_t.*
            ELSE
               
               #寫入修改者/修改日期資訊(單身)
               
            
               #add-point:單身修改前
               #mark by lixh 20141024
#               IF g_inpe_d[l_ac].inpe008 IS NULL THEN
#                  LET g_inpe_d[l_ac].inpe008 = ' '
#               END IF
#               IF g_inpe_d[l_ac].inpe009 IS NULL THEN
#                  LET g_inpe_d[l_ac].inpe009 = ' '
#               END IF 
               #end add-point
               
               #add--2015/07/02 By shiun--(S)
               CALL s_aooi390_get_auto_no('7',g_inpe_d[l_ac].inpe008) RETURNING l_success,g_inpe_d[l_ac].inpe008
               IF NOT l_success THEN
                  CALL s_transaction_end('N','0')
                  NEXT FIELD CURRENT
               END IF
               DISPLAY BY NAME g_inpe_d[l_ac].inpe008
               CALL s_aooi390_oofi_upd('7',g_inpe_d[l_ac].inpe008) RETURNING l_success
               
               CALL s_aooi390_get_auto_no('8',g_inpe_d[l_ac].inpe009) RETURNING l_success,g_inpe_d[l_ac].inpe009
               IF NOT l_success THEN
                  CALL s_transaction_end('N','0')
                  NEXT FIELD CURRENT
               END IF 
               DISPLAY BY NAME g_inpe_d[l_ac].inpe009
               CALL s_aooi390_oofi_upd('8',g_inpe_d[l_ac].inpe009) RETURNING l_success
               #add--2015/07/02 By shiun--(E)
               
               UPDATE inpe_t SET (inpedocno,inpeseq,inpeseq2,inpesite,inpe008,inpe009,inpe012,inpe030, 
                   inpe035,inpe050,inpe055,inpe010,inpe011,inpe031,inpe032,inpe033,inpe034,inpe036,inpe037, 
                   inpe038,inpe039,inpe051,inpe052,inpe053,inpe054,inpe056,inpe057,inpe058,inpe059) = (g_inpe_d[l_ac].inpedocno, 
                   g_inpe_d[l_ac].inpeseq,g_inpe_d[l_ac].inpeseq2,g_inpe_d[l_ac].inpesite,g_inpe_d[l_ac].inpe008, 
                   g_inpe_d[l_ac].inpe009,g_inpe_d[l_ac].inpe012,g_inpe_d[l_ac].inpe030,g_inpe_d[l_ac].inpe035, 
                   g_inpe_d[l_ac].inpe050,g_inpe_d[l_ac].inpe055,g_inpe_d[l_ac].inpe010,g_inpe_d[l_ac].inpe011, 
                   g_inpe_d[l_ac].inpe031,g_inpe_d[l_ac].inpe032,g_inpe_d[l_ac].inpe033,g_inpe_d[l_ac].inpe034, 
                   g_inpe_d[l_ac].inpe036,g_inpe_d[l_ac].inpe037,g_inpe_d[l_ac].inpe038,g_inpe_d[l_ac].inpe039, 
                   g_inpe_d[l_ac].inpe051,g_inpe_d[l_ac].inpe052,g_inpe_d[l_ac].inpe053,g_inpe_d[l_ac].inpe054, 
                   g_inpe_d[l_ac].inpe056,g_inpe_d[l_ac].inpe057,g_inpe_d[l_ac].inpe058,g_inpe_d[l_ac].inpe059) 

                WHERE inpeent = g_enterprise AND
                  inpesite = g_inpe_d_t.inpesite #項次   
                  AND inpedocno = g_inpe_d_t.inpedocno  
                  AND inpeseq = g_inpe_d_t.inpeseq  
                  AND inpeseq2 = g_inpe_d_t.inpeseq2  
 
                  
               #add-point:單身修改中

               #end add-point
                  
               CASE
                  WHEN SQLCA.sqlerrd[3] = 0  #更新不到的處理
                     INITIALIZE g_errparam TO NULL
                     LET g_errparam.code = "std-00009"
                     LET g_errparam.extend = "inpe_t"
                     LET g_errparam.popup = TRUE
                     CALL cl_err()

                     CALL s_transaction_end('N','0')
                    WHEN SQLCA.sqlcode #其他錯誤
                     INITIALIZE g_errparam TO NULL
               LET g_errparam.code = SQLCA.sqlcode
               LET g_errparam.extend = "inpe_t"
               LET g_errparam.popup = TRUE
               CALL cl_err()
  
                     CALL s_transaction_end('N','0')
                  OTHERWISE
                                    INITIALIZE gs_keys TO NULL 
               LET gs_keys[1] = g_inpe_d[g_detail_idx].inpesite
               LET gs_keys_bak[1] = g_inpe_d_t.inpesite
               LET gs_keys[2] = g_inpe_d[g_detail_idx].inpedocno
               LET gs_keys_bak[2] = g_inpe_d_t.inpedocno
               LET gs_keys[3] = g_inpe_d[g_detail_idx].inpeseq
               LET gs_keys_bak[3] = g_inpe_d_t.inpeseq
               LET gs_keys[4] = g_inpe_d[g_detail_idx].inpeseq2
               LET gs_keys_bak[4] = g_inpe_d_t.inpeseq2
               CALL aint830_01_update_b('inpe_t',gs_keys,gs_keys_bak,"'1'")
                     #資料多語言用-增/改
                     
#                     LET g_log1 = util.JSON.stringify(g_inpe_d_t)
#                     LET g_log2 = util.JSON.stringify(g_inpe_d[l_ac])
#                     IF NOT cl_log_modified_record(g_log1,g_log2) THEN 
#                        CALL s_transaction_end('N','0')
#                     END IF
               END CASE
               
               #add-point:單身修改後

               #end add-point
 
            END IF
            
         AFTER ROW
            CALL aint830_01_unlock_b("inpe_t")
            CALL s_transaction_end('Y','0')
            #其他table進行unlock
            
             #add-point:單身after row

            #end add-point
            
         AFTER INPUT
            #add-point:單身input後
            LET g_inpe3_d.* = g_inpe_d.*  
            #add by lixh 20150323
            IF g_type = '1' THEN
               LET s_inpe_sum = 0
               SELECT SUM(inpe030) INTO s_inpe_sum FROM inpe_t
                WHERE inpeent = g_enterprise
                  AND inpesite = g_inpesite
                  AND inpedocno = g_inpedocno
                  AND inpeseq = g_inpeseq
                  AND inpe030 IS NOT NULL
               IF s_inpe_sum <> g_inpd_sum THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = 'ain-00531'
                  LET g_errparam.extend = ''
                  LET g_errparam.popup = TRUE
                  CALL cl_err()    
                  NEXT FIELD inpe030             
               END IF
            END IF
            IF g_type = '2' THEN
               LET s_inpe_sum = 0
               SELECT SUM(inpe035) INTO s_inpe_sum FROM inpe_t
                WHERE inpeent = g_enterprise
                  AND inpesite = g_inpesite
                  AND inpedocno = g_inpedocno
                  AND inpeseq = g_inpeseq
                  AND inpe035 IS NOT NULL
               IF s_inpe_sum <> g_inpd_sum THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = 'ain-00531'
                  LET g_errparam.extend = ''
                  LET g_errparam.popup = TRUE
                  CALL cl_err()    
                  NEXT FIELD inpe035             
               END IF
            END IF   
            IF g_type = '3' THEN
               LET s_inpe_sum = 0
               SELECT SUM(inpe050) INTO s_inpe_sum FROM inpe_t
                WHERE inpeent = g_enterprise
                  AND inpesite = g_inpesite
                  AND inpedocno = g_inpedocno
                  AND inpeseq = g_inpeseq
                  AND inpe050 IS NOT NULL
               IF s_inpe_sum <> g_inpd_sum THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = 'ain-00531'
                  LET g_errparam.extend = ''
                  LET g_errparam.popup = TRUE
                  CALL cl_err()    
                  NEXT FIELD inpe050             
               END IF
            END IF  
            IF g_type = '4' THEN
               LET s_inpe_sum = 0
               SELECT SUM(inpe055) INTO s_inpe_sum FROM inpe_t
                WHERE inpeent = g_enterprise
                  AND inpesite = g_inpesite
                  AND inpedocno = g_inpedocno
                  AND inpeseq = g_inpeseq
                  AND inpe055 IS NOT NULL
               IF s_inpe_sum <> g_inpd_sum THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = 'ain-00531'
                  LET g_errparam.extend = ''
                  LET g_errparam.popup = TRUE
                  CALL cl_err()    
                  NEXT FIELD inpe055             
               END IF
            END IF                
            #end add-point
            
         ON ACTION controlo   
            CALL FGL_SET_ARR_CURR(g_inpe_d.getLength()+1)
            LET lb_reproduce = TRUE
            LET li_reproduce = l_ac
            LET li_reproduce_target = g_inpe_d.getLength()+1
            
      END INPUT
END DIALOG]]>
  </point>
  <point name="function.aint830_01_b_fill" order="3" ver="1" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 單身填充
# Memo...........:
# Usage..........: CALL aint830_01_b_fill(p_site,p_inpddocno,p_inpdseq)
#                  RETURNING 回传参数
# Input parameter: 传入参数变量1   传入参数变量说明1
#                : 传入参数变量2   传入参数变量说明2
# Return code....: 回传参数变量1   回传参数变量说明1
#                : 回传参数变量2   回传参数变量说明2
# Date & Author..: 日期 By lixh
# Modify.........:
################################################################################
PUBLIC FUNCTION aint830_01_b_fill(p_site,p_inpddocno,p_inpdseq)
   DEFINE p_site        LIKE inpd_t.inpdsite
   DEFINE p_inpddocno   LIKE inpd_t.inpddocno
   DEFINE p_inpdseq     LIKE inpd_t.inpdseq
   #add-point:b_fill段define
   #end add-point
   
   IF cl_null(g_wc_source) THEN
      LET g_wc_source = " 1=1"
   END IF
   
   #add-point:b_fill段sql之前

   #end add-point
 
   LET g_sql = "SELECT  UNIQUE inpedocno,inpeseq,inpeseq2,inpesite,inpe008,inpe009,inpe012,inpe030,inpe035, 
       inpe050,inpe055,inpe010,inpe011,inpe031,inpe032,inpe033,inpe034,inpe036,inpe037,inpe038,inpe039, 
       inpe051,inpe052,inpe053,inpe054,inpe056,inpe057,inpe058,inpe059 ,t1.ooag011 ,t2.ooag011 ,t3.ooag011 , 
       t4.ooag011 ,t5.ooag011 ,t6.ooag011 ,t7.ooag011 ,t8.ooag011 FROM inpe_t",
               "",
                              " LEFT JOIN ooag_t t1 ON t1.ooagent='"||g_enterprise||"' AND t1.ooag001=inpe031  ",
               " LEFT JOIN ooag_t t2 ON t2.ooagent='"||g_enterprise||"' AND t2.ooag001=inpe033  ",
               " LEFT JOIN ooag_t t3 ON t3.ooagent='"||g_enterprise||"' AND t3.ooag001=inpe036  ",
               " LEFT JOIN ooag_t t4 ON t4.ooagent='"||g_enterprise||"' AND t4.ooag001=inpe038  ",
               " LEFT JOIN ooag_t t5 ON t5.ooagent='"||g_enterprise||"' AND t5.ooag001=inpe051  ",
               " LEFT JOIN ooag_t t6 ON t6.ooagent='"||g_enterprise||"' AND t6.ooag001=inpe053  ",
               " LEFT JOIN ooag_t t7 ON t7.ooagent='"||g_enterprise||"' AND t7.ooag001=inpe056  ",
               " LEFT JOIN ooag_t t8 ON t8.ooagent='"||g_enterprise||"' AND t8.ooag001=inpe058  ",
 
               " WHERE inpeent= ? AND inpesite = ? AND inpedocno = ? AND inpeseq = ? AND 1=1 AND ", g_wc_source 
    
   LET g_sql = g_sql, cl_sql_add_filter("inpe_t"),
                      " ORDER BY inpe_t.inpesite,inpe_t.inpedocno,inpe_t.inpeseq,inpe_t.inpeseq2"
   
   #add-point:b_fill段sql之後

   #end add-point
   
   LET g_sql = cl_sql_add_mask(g_sql)              #遮蔽特定資料
   PREPARE aint830_01_pb FROM g_sql
   DECLARE b_fill_curs CURSOR FOR aint830_01_pb
   
   OPEN b_fill_curs USING g_enterprise,p_site,p_inpddocno,p_inpdseq
 
   CALL g_inpe_d.clear()
 
 
   LET g_cnt = l_ac
   LET l_ac = 1   
   ERROR "Searching!" 
 
   FOREACH b_fill_curs INTO g_inpe_d[l_ac].inpedocno,g_inpe_d[l_ac].inpeseq,g_inpe_d[l_ac].inpeseq2, 
       g_inpe_d[l_ac].inpesite,g_inpe_d[l_ac].inpe008,g_inpe_d[l_ac].inpe009,g_inpe_d[l_ac].inpe012, 
       g_inpe_d[l_ac].inpe030,g_inpe_d[l_ac].inpe035,g_inpe_d[l_ac].inpe050,g_inpe_d[l_ac].inpe055,g_inpe_d[l_ac].inpe010, 
       g_inpe_d[l_ac].inpe011,g_inpe_d[l_ac].inpe031,g_inpe_d[l_ac].inpe032,g_inpe_d[l_ac].inpe033,g_inpe_d[l_ac].inpe034, 
       g_inpe_d[l_ac].inpe036,g_inpe_d[l_ac].inpe037,g_inpe_d[l_ac].inpe038,g_inpe_d[l_ac].inpe039,g_inpe_d[l_ac].inpe051, 
       g_inpe_d[l_ac].inpe052,g_inpe_d[l_ac].inpe053,g_inpe_d[l_ac].inpe054,g_inpe_d[l_ac].inpe056,g_inpe_d[l_ac].inpe057, 
       g_inpe_d[l_ac].inpe058,g_inpe_d[l_ac].inpe059,g_inpe_d[l_ac].inpe031_desc,g_inpe_d[l_ac].inpe033_desc, 
       g_inpe_d[l_ac].inpe036_desc,g_inpe_d[l_ac].inpe038_desc,g_inpe_d[l_ac].inpe051_desc,g_inpe_d[l_ac].inpe053_desc, 
       g_inpe_d[l_ac].inpe056_desc,g_inpe_d[l_ac].inpe058_desc
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "FOREACH:"
         LET g_errparam.popup = TRUE
         CALL cl_err()

         EXIT FOREACH
      END IF
  
      #add-point:b_fill段資料填充

      #end add-point
      
#      CALL aint830_01_detail_show()      
 
      LET l_ac = l_ac + 1
      IF l_ac > g_max_rec THEN
         EXIT FOREACH
      END IF
      
   END FOREACH
   
   IF l_ac > g_max_rec THEN
      IF g_error_show = 1 THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = 9035
         LET g_errparam.extend = "inpe_t"
         LET g_errparam.popup = TRUE
         CALL cl_err()

      END IF
   END IF 
   LET g_error_show = 0
   
 
   
   CALL g_inpe_d.deleteElement(g_inpe_d.getLength())   
 
   
   #將key欄位填到每個page
   FOR l_ac = 1 TO g_inpe_d.getLength()
 
   END FOR
   
   IF g_cnt > g_inpe_d.getLength() THEN
      LET l_ac = g_inpe_d.getLength()
   ELSE
      LET l_ac = g_cnt
   END IF
   LET g_cnt = l_ac
 
   #add-point:b_fill段資料填充(其他單身)

   #end add-point
   
   ERROR "" 
 
   LET g_detail_cnt = g_inpe_d.getLength()
   DISPLAY g_detail_cnt TO FORMONLY.cnt
   LET g_inpe3_d.* = g_inpe_d.*
   CLOSE b_fill_curs
   FREE aint830_01_pb
END FUNCTION]]>
  </point>
  <point name="function.aint830_01_set_entry_b" order="4" ver="1" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 欄位開啟
# Memo...........:
# Usage..........: CALL aint830_01_set_entry_b()
# Input parameter: 传入参数变量1   传入参数变量说明1
#                : 传入参数变量2   传入参数变量说明2
# Return code....: 回传参数变量1   回传参数变量说明1
#                : 回传参数变量2   回传参数变量说明2
# Date & Author..: 日期 By 作者
# Modify.........:
################################################################################
PRIVATE FUNCTION aint830_01_set_entry_b()
   CALL cl_set_comp_entry("inpe008,inpe009,inpe010,inpe011,inpe012",TRUE) 
END FUNCTION]]>
  </point>
  <point name="function.aint830_01_set_no_entry_b" order="5" ver="1" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 欄位關閉
# Memo...........:
# Usage..........: CALL aint830_01_set_no_entry_b(p_inpdsite,p_inpddocno,p_inpdseq)
# Input parameter: 传入参数变量1   传入参数变量说明1
#                : 传入参数变量2   传入参数变量说明2
# Return code....: 回传参数变量1   回传参数变量说明1
#                : 回传参数变量2   回传参数变量说明2
# Date & Author..: 日期 By lixh
# Modify.........:
################################################################################
PRIVATE FUNCTION aint830_01_set_no_entry_b(p_inpdsite,p_inpddocno,p_inpdseq)
DEFINE   l_inpd009    LIKE inpd_t.inpd009
DEFINE   l_inpd001    LIKE inpd_t.inpd001
DEFINE   p_inpddocno  LIKE inpd_t.inpddocno
DEFINE   p_inpdsite   LIKE inpd_t.inpdsite
DEFINE   p_inpdseq    LIKE inpd_t.inpdseq

   SELECT inpd001,inpd009 INTO l_inpd001,l_inpd009 FROM inpd_t
    WHERE inpdent = g_enterprise
      AND inpddocno = p_inpddocno
      AND inpdseq = p_inpdseq
      AND inpdsite = p_inpdsite
      
#   SELECT imaf071,imaf072,imaf073,imaf074,imaf081,imaf082,imaf083,imaf084,imaf032 
#     INTO g_imaf071,g_imaf072,g_imaf073,g_imaf074,g_imaf081,g_imaf082,g_imaf083,g_imaf084,g_imaf032 FROM imaf_t
#    WHERE imafent = g_enterprise
#      AND imaf001 = l_inpd001
#      AND imafsite = p_inpdsite
               
   IF l_inpd009 = 'Y' THEN     #空白標籤
      IF g_imaf071 = '2'  THEN  #批號 
         CALL cl_set_comp_entry("inpe008,inpe010,inpe011",FALSE)   
         IF l_ac <> 0 THEN
            LET g_inpe_d[l_ac].inpe008 = ' '
         END IF   
      END IF
      IF g_imaf081 = '2'  THEN  #序號 
         CALL cl_set_comp_entry("inpe009",FALSE)
         IF l_ac <> 0 THEN
            LET g_inpe_d[l_ac].inpe009 = ' ' 
         END IF            
      END IF      
   END IF   
   IF l_inpd009 = 'N' THEN  
      CALL cl_set_comp_entry("inpe008,inpe009,inpe010,inpe011,inpe012",FALSE)   
   END IF  
   IF g_type MATCHES'[56]' THEN  #調整單
      CALL cl_set_comp_entry("inpe008,inpe009,inpe010,inpe011,inpe012",FALSE)   
   END IF   
END FUNCTION]]>
  </point>
  <point name="function.aint830_01_insert_b" order="6" ver="4" cite_std="N" new="Y" status="u" src="s" readonly="" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 新增
# Memo...........:
# Usage..........: CALL aint830_01_insert_b(ps_table,ps_keys,ps_page)
# Input parameter: 传入参数变量1   传入参数变量说明1
#                : 传入参数变量2   传入参数变量说明2
# Return code....: 回传参数变量1   回传参数变量说明1
#                : 回传参数变量2   回传参数变量说明2
# Date & Author..: 日期 By lixh
# Modify.........:
################################################################################
PRIVATE FUNCTION aint830_01_insert_b(ps_table,ps_keys,ps_page)
   DEFINE ps_table    STRING
   DEFINE ps_page     STRING
   DEFINE ps_keys     DYNAMIC ARRAY OF VARCHAR(500)
   DEFINE ls_group    STRING
   #add-point:insert_b段define
   DEFINE l_inae      RECORD LIKE inae_t.*
   DEFINE l_time      DATETIME YEAR TO SECOND
   DEFINE l_cnt       LIKE type_t.num5
   DEFINE l_success   LIKE type_t.num5   #add--2015/07/02 By shiun
   DEFINE r_success   LIKE type_t.num5
   #end add-point     
 
   #判斷是否是同一群組的table
   LET ls_group = "inpe_t,"
   #IF ls_group.getIndexOf(ps_table,1) > 0 THEN
      
   LET r_success = TRUE    
      #add-point:insert_b段新增前
      IF g_inpd002 IS NULL THEN 
         LET g_inpd002 = ' '
      END IF
      IF g_inpe_d[l_ac].inpe008 IS NULL THEN
         LET g_inpe_d[l_ac].inpe008 = ' '
      END IF
      IF g_inpe_d[l_ac].inpe009 IS NULL THEN
         LET g_inpe_d[l_ac].inpe009 = ' '
      END IF
      LET g_inpe_d[l_ac].inpe012 = 0 #add by lixh 20150326      
      #add--2015/07/02 By shiun--(S)
      CALL s_aooi390_get_auto_no('7',g_inpe_d[l_ac].inpe008) RETURNING l_success,g_inpe_d[l_ac].inpe008
      IF NOT l_success THEN
         CALL s_transaction_end('N','0')
         LET r_success = FALSE
         RETURN r_success
      END IF   
      DISPLAY BY NAME g_inpe_d[l_ac].inpe008
      CALL s_aooi390_oofi_upd('7',g_inpe_d[l_ac].inpe008) RETURNING l_success
      
      CALL s_aooi390_get_auto_no('8',g_inpe_d[l_ac].inpe009) RETURNING l_success,g_inpe_d[l_ac].inpe009
      IF NOT l_success THEN
         CALL s_transaction_end('N','0')
         LET r_success = FALSE
         RETURN r_success
      END IF   
      DISPLAY BY NAME g_inpe_d[l_ac].inpe009
      CALL s_aooi390_oofi_upd('8',g_inpe_d[l_ac].inpe009) RETURNING l_success
      #add--2015/07/02 By shiun--(E)
      
      #end add-point    
      INSERT INTO inpe_t
                  (inpeent,
                   inpesite,inpedocno,inpeseq,inpeseq2,inpe001,inpe002,inpe003,inpe004,inpe005,inpe006,inpe007,
                   inpe008,inpe009,inpe012,inpe030,inpe035,inpe050,inpe055,inpe010,inpe011,inpe031,inpe032,inpe033,inpe034,inpe036,inpe037,inpe038,
                   inpe039,inpe051,inpe052,inpe053,inpe054,inpe056,inpe057,inpe058,inpe059) 
            VALUES(g_enterprise,
                   ps_keys[1],ps_keys[2],ps_keys[3],ps_keys[4],g_inpd001,g_inpd002,g_inpd003,g_inpd004,g_inpd005,g_inpd006,g_inpd007,                   
                   g_inpe_d[l_ac].inpe008,g_inpe_d[l_ac].inpe009,g_inpe_d[l_ac].inpe012,g_inpe_d[l_ac].inpe030, 
                       g_inpe_d[l_ac].inpe035,g_inpe_d[l_ac].inpe050,g_inpe_d[l_ac].inpe055,g_inpe_d[l_ac].inpe010, 
                       g_inpe_d[l_ac].inpe011,g_inpe_d[l_ac].inpe031,g_inpe_d[l_ac].inpe032,g_inpe_d[l_ac].inpe033, 
                       g_inpe_d[l_ac].inpe034,g_inpe_d[l_ac].inpe036,g_inpe_d[l_ac].inpe037,g_inpe_d[l_ac].inpe038, 
                       g_inpe_d[l_ac].inpe039,g_inpe_d[l_ac].inpe051,g_inpe_d[l_ac].inpe052,g_inpe_d[l_ac].inpe053, 
                       g_inpe_d[l_ac].inpe054,g_inpe_d[l_ac].inpe056,g_inpe_d[l_ac].inpe057,g_inpe_d[l_ac].inpe058, 
                       g_inpe_d[l_ac].inpe059)
      #add-point:insert_b段新增中

      #end add-point    
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "inpe_t"
         LET g_errparam.popup = FALSE
         CALL cl_err()
         LET r_success = FALSE
      ELSE
         IF g_inpd002 IS NULL THEN
            LET g_inpd002 = ' '
         END IF
         IF g_inpe_d[l_ac].inpe008 IS NULL THEN
            LET g_inpe_d[l_ac].inpe008 = ' '
         END IF
         IF g_inpe_d[l_ac].inpe009 IS NULL THEN
            LET g_inpe_d[l_ac].inpe009 = ' '
         END IF         
         SELECT COUNT(*) INTO l_cnt FROM inae_t
          WHERE inaeent = g_enterprise
            AND inaesite = g_site
            AND inae001 = g_inpd001
            AND inae002 = g_inpd002
            AND inae003 = g_inpe_d[l_ac].inpe008
            AND inae004 = g_inpe_d[l_ac].inpe009
         IF cl_null(l_cnt) THEN LET l_cnt = 0 END IF
         IF l_cnt = 0 THEN   #產生inae_t的資料
            LET l_inae.inaesite = g_site
            LET l_inae.inae001 = g_inpd001
            LET l_inae.inae002 = g_inpd002
            IF l_inae.inae002 IS NULL THEN
               LET l_inae.inae002 = ' '
            END IF
            LET l_inae.inae003 = g_inpe_d[l_ac].inpe008
            LET l_inae.inae004 = g_inpe_d[l_ac].inpe009
            LET l_inae.inae005 = g_inpddocno
            LET l_inae.inae006 = g_inpdseq
            LET l_inae.inae007 = ps_keys[4]
            LET l_inae.inae008 = g_dept
            LET l_inae.inae010 = g_inpe_d[l_ac].inpe010
            LET l_inae.inae011 = g_inpe_d[l_ac].inpe011
            LET l_inae.inaestus = 'Y'
            LET l_inae.inaeownid = g_user
            LET l_inae.inaeowndp = g_dept
            LET l_inae.inaecrtid = g_user
            LET l_inae.inaecrtdp = g_dept
            LET l_time = cl_get_current() 
            LET l_inae.inaecrtdt = l_time
            INSERT INTO inae_t (inaeent,inaesite,inae001,inae002,inae003,inae004,inae005,inae006,inae007,inae008,inae010,inae011,
                                inaestus,inaeownid,inaeowndp,inaecrtid,inaecrtdp,inaecrtdt)
                        VALUES (g_enterprise,g_site,l_inae.inae001,l_inae.inae002,l_inae.inae003,l_inae.inae004,l_inae.inae005,
                                l_inae.inae006,l_inae.inae007,l_inae.inae008,l_inae.inae010,l_inae.inae011,l_inae.inaestus,                        
                                l_inae.inaeownid,l_inae.inaeowndp,l_inae.inaecrtid,l_inae.inaecrtdp,l_inae.inaecrtdt)  
            IF SQLCA.sqlcode THEN
               INITIALIZE g_errparam TO NULL
               LET g_errparam.code = SQLCA.sqlcode
               LET g_errparam.extend = "inae_t"
               LET g_errparam.popup = FALSE
               CALL cl_err()
               LET r_success = FALSE                 
            END IF     
         END IF            
      END IF
      RETURN r_success
END FUNCTION]]>
  </point>
  <point name="function.aint830_01_update_b" order="7" ver="4" cite_std="N" new="Y" status="u" src="s" readonly="" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 更新inpe_t
# Memo...........:
# Usage..........: CALL aint830_01_update_b(ps_table,ps_keys,ps_keys_bak,ps_page)
# Input parameter: 传入参数变量1   传入参数变量说明1
#                : 传入参数变量2   传入参数变量说明2
# Return code....: 回传参数变量1   回传参数变量说明1
#                : 回传参数变量2   回传参数变量说明2
# Date & Author..: 日期 By lixh
# Modify.........:
################################################################################
PRIVATE FUNCTION aint830_01_update_b(ps_table,ps_keys,ps_keys_bak,ps_page)
   DEFINE ps_page          STRING
   DEFINE ps_table         STRING
   DEFINE ps_keys          DYNAMIC ARRAY OF VARCHAR(500)
   DEFINE ps_keys_bak      DYNAMIC ARRAY OF VARCHAR(500)
   DEFINE ls_group         STRING
   DEFINE li_idx           LIKE type_t.num5 
   DEFINE lb_chk           BOOLEAN
   DEFINE l_new_key        DYNAMIC ARRAY OF STRING
   DEFINE l_old_key        DYNAMIC ARRAY OF STRING
   DEFINE l_field_key      DYNAMIC ARRAY OF STRING
   DEFINE l_success        LIKE type_t.num5  #add--2015/07/02 By shiun
   #add-point:update_b段define

   #end add-point     
   
   #判斷key是否有改變
   LET lb_chk = TRUE
   FOR li_idx = 1 TO ps_keys.getLength()
      IF ps_keys[li_idx] <> ps_keys_bak[li_idx] THEN
         LET lb_chk = FALSE
         EXIT FOR
      END IF
   END FOR
   
   #不需要做處理
   IF lb_chk THEN
      RETURN
   END IF
    
   #判斷是否是同一群組的table
   LET ls_group = "inpe_t,"
   IF ls_group.getIndexOf(ps_table,1) > 0 AND ps_table <> "inpe_t" THEN
      #add-point:update_b段修改前
      IF g_inpe_d[l_ac].inpe008 IS NULL THEN
         LET g_inpe_d[l_ac].inpe008 = ' '
      END IF
      IF g_inpe_d[l_ac].inpe009 IS NULL THEN
         LET g_inpe_d[l_ac].inpe009 = ' '
      END IF 
      #end add-point   
      
      #add--2015/07/02 By shiun--(S)
      CALL s_aooi390_get_auto_no('7',g_inpe_d[l_ac].inpe008) RETURNING l_success,g_inpe_d[l_ac].inpe008
      IF NOT l_success THEN
         CALL s_transaction_end('N','0')
         RETURN
      END IF
      DISPLAY BY NAME g_inpe_d[l_ac].inpe008
      CALL s_aooi390_oofi_upd('7',g_inpe_d[l_ac].inpe008) RETURNING l_success
      
      CALL s_aooi390_get_auto_no('8',g_inpe_d[l_ac].inpe009) RETURNING l_success,g_inpe_d[l_ac].inpe009
      IF NOT l_success THEN
         CALL s_transaction_end('N','0')
         RETURN
      END IF 
      DISPLAY BY NAME g_inpe_d[l_ac].inpe009
      CALL s_aooi390_oofi_upd('8',g_inpe_d[l_ac].inpe009) RETURNING l_success
      #add--2015/07/02 By shiun--(E)      
      
      UPDATE inpe_t 
         SET (inpesite,inpedocno,inpeseq,inpeseq2
              ,inpe008,inpe009,inpe012,inpe030,inpe035,inpe050,inpe055,inpe010,inpe011,inpe031,inpe032,inpe033,inpe034,inpe036,inpe037,inpe038,inpe039,inpe051,inpe052,inpe053,inpe054,inpe056,inpe057,inpe058,inpe059) 
              = 
             (ps_keys[1],ps_keys[2],ps_keys[3],ps_keys[4]
              ,g_inpe_d[l_ac].inpe008,g_inpe_d[l_ac].inpe009,g_inpe_d[l_ac].inpe012,g_inpe_d[l_ac].inpe030, 
                  g_inpe_d[l_ac].inpe035,g_inpe_d[l_ac].inpe050,g_inpe_d[l_ac].inpe055,g_inpe_d[l_ac].inpe010, 
                  g_inpe_d[l_ac].inpe011,g_inpe_d[l_ac].inpe031,g_inpe_d[l_ac].inpe032,g_inpe_d[l_ac].inpe033, 
                  g_inpe_d[l_ac].inpe034,g_inpe_d[l_ac].inpe036,g_inpe_d[l_ac].inpe037,g_inpe_d[l_ac].inpe038, 
                  g_inpe_d[l_ac].inpe039,g_inpe_d[l_ac].inpe051,g_inpe_d[l_ac].inpe052,g_inpe_d[l_ac].inpe053, 
                  g_inpe_d[l_ac].inpe054,g_inpe_d[l_ac].inpe056,g_inpe_d[l_ac].inpe057,g_inpe_d[l_ac].inpe058, 
                  g_inpe_d[l_ac].inpe059) 
         WHERE inpesite = ps_keys_bak[1] AND inpedocno = ps_keys_bak[2] AND inpeseq = ps_keys_bak[3] AND inpeseq2 = ps_keys_bak[4]
      #add-point:update_b段修改中

      #end add-point 
      CASE
         WHEN SQLCA.sqlerrd[3] = 0  #更新不到的處理
            INITIALIZE g_errparam TO NULL
            LET g_errparam.code = "std-00009"
            LET g_errparam.extend = "inpe_t"
            LET g_errparam.popup = TRUE
            CALL cl_err()

            CALL s_transaction_end('N','0')
         WHEN SQLCA.sqlcode #其他錯誤
            INITIALIZE g_errparam TO NULL
            LET g_errparam.code = SQLCA.sqlcode
            LET g_errparam.extend = "inpe_t"
            LET g_errparam.popup = TRUE
            CALL cl_err()
  
            CALL s_transaction_end('N','0')
         OTHERWISE
            
      END CASE
      #add-point:update_b段修改後

      #end add-point 
      RETURN
   END IF
END FUNCTION]]>
  </point>
  <point name="function.aint830_01_delete_b" order="8" ver="1" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 刪除資料
# Memo...........:
# Usage..........: CALL aint830_01_delete_b(ps_table,ps_keys_bak,ps_page)
# Input parameter: 传入参数变量1   传入参数变量说明1
#                : 传入参数变量2   传入参数变量说明2
# Return code....: 回传参数变量1   回传参数变量说明1
#                : 回传参数变量2   回传参数变量说明2
# Date & Author..: 日期 By lixh
# Modify.........:
################################################################################
PRIVATE FUNCTION aint830_01_delete_b(ps_table,ps_keys_bak,ps_page)
   DEFINE ps_table    STRING
   DEFINE ps_page     STRING
   DEFINE ps_keys_bak DYNAMIC ARRAY OF VARCHAR(500)
   DEFINE ls_group    STRING
   #add-point:delete_b段define

   #end add-point     
 
   #判斷是否是同一群組的table
   LET ls_group = "inpe_t,"
   IF ls_group.getIndexOf(ps_table,1) > 0 AND ps_table <> 'inpe_t' THEN
   
      #add-point:delete_b段刪除前

      #end add-point     
   
      DELETE FROM inpe_t
       WHERE inpeent = g_enterprise AND
         inpesite = ps_keys_bak[1] AND inpedocno = ps_keys_bak[2] AND inpeseq = ps_keys_bak[3] AND inpeseq2 = ps_keys_bak[4]
 
      #add-point:delete_b段刪除中

      #end add-point  
         
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = ""
         LET g_errparam.popup = FALSE
         CALL cl_err()

      END IF
      
      #add-point:delete_b段刪除後

      #end add-point
      
      RETURN
   END IF
END FUNCTION]]>
  </point>
  <point name="function.aint830_01_lock_b_2" order="9" ver="1" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 連動lock其他單身table資料
# Memo...........:
# Usage..........: CALL aint830_01_lock_b_2(ps_table)
#                  RETURNING 回传参数
# Input parameter: 传入参数变量1   传入参数变量说明1
#                : 传入参数变量2   传入参数变量说明2
# Return code....: 回传参数变量1   回传参数变量说明1
#                : 回传参数变量2   回传参数变量说明2
# Date & Author..: 日期 By lixh
# Modify.........:
################################################################################
PRIVATE FUNCTION aint830_01_lock_b_2(ps_table)
   DEFINE ps_table STRING
   DEFINE ls_group STRING
   #add-point:lock_b段define

   #end add-point   
   
   #先刷新資料
   #CALL aint830_01_b_fill(g_wc2)
   
   #鎖定整組table
   #LET ls_group = ""
   #僅鎖定自身table
   LET ls_group = "inpe_t"
   
   IF ls_group.getIndexOf(ps_table,1) THEN
   
      OPEN aint830_01_bc2 USING g_enterprise,
                                       g_inpe_d[g_detail_idx].inpesite,g_inpe_d[g_detail_idx].inpedocno, 
                                           g_inpe_d[g_detail_idx].inpeseq,g_inpe_d[g_detail_idx].inpeseq2 

                                       
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "aint830_01_bc2"
         LET g_errparam.popup = TRUE
         CALL cl_err()

         RETURN FALSE
      END IF
   
   END IF
                                      
   RETURN TRUE 
END FUNCTION]]>
  </point>
  <point name="function.aint830_01_set_no_required" order="10" ver="1" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 描述说明
# Memo...........:
# Usage..........: CALL aint830_01_set_no_required()
#                  RETURNING 回传参数
# Input parameter: 传入参数变量1   传入参数变量说明1
#                : 传入参数变量2   传入参数变量说明2
# Return code....: 回传参数变量1   回传参数变量说明1
#                : 回传参数变量2   回传参数变量说明2
# Date & Author..: 日期 By lixh
# Modify.........:
################################################################################
PRIVATE FUNCTION aint830_01_set_no_required()
   CALL cl_set_comp_required("inpe008,inpe009",FALSE)
END FUNCTION]]>
  </point>
  <point name="function.aint830_01_set_required" order="11" ver="1" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 描述说明
# Memo...........:
# Usage..........: CALL aint830_01_set_required(p_inpdsite,p_inpddocno,p_inpdseq)
#                  RETURNING 回传参数
# Input parameter: 传入参数变量1   传入参数变量说明1
#                : 传入参数变量2   传入参数变量说明2
# Return code....: 回传参数变量1   回传参数变量说明1
#                : 回传参数变量2   回传参数变量说明2
# Date & Author..: 日期 By lixh
# Modify.........:
################################################################################
PRIVATE FUNCTION aint830_01_set_required(p_inpdsite,p_inpddocno,p_inpdseq)
DEFINE   l_inpd009    LIKE inpd_t.inpd009
DEFINE   l_inpd001    LIKE inpd_t.inpd001
DEFINE   p_inpddocno  LIKE inpd_t.inpddocno
DEFINE   p_inpdsite   LIKE inpd_t.inpdsite
DEFINE   p_inpdseq    LIKE inpd_t.inpdseq

   SELECT inpd001,inpd009 INTO l_inpd001,l_inpd009 FROM inpd_t
    WHERE inpdent = g_enterprise
      AND inpddocno = p_inpddocno
      AND inpdseq = p_inpdseq
      AND inpdsite = p_inpdsite
   IF l_inpd009 = 'Y' THEN      #空白標籤
      IF g_imaf071 = '1'  THEN  #批號 
         CALL cl_set_comp_required("inpe008",TRUE)   
#         IF l_ac <> 0 THEN
#            LET g_inpe_d[l_ac].inpe008 = ' '
#         END IF   
      END IF
      IF g_imaf081 = '1'  THEN  #序號 
#         CALL cl_set_comp_required("inpe009",TRUE)
         CALL cl_set_comp_required("inpe009",TRUE)   
#         IF l_ac <> 0 THEN
#            LET g_inpe_d[l_ac].inpe009 = ' ' 
#         END IF            
      END IF      
   END IF        
END FUNCTION]]>
  </point>
  <point name="function.aint830_01_num_chk" order="12" ver="3" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 數量檢查
# Memo...........:
# Usage..........: CALL aint830_01_num_chk(p_num)
#                  RETURNING TRUE/FALSE
# Input parameter: 传入参数变量1   传入参数变量说明1
#                : 传入参数变量2   传入参数变量说明2
# Return code....: 回传参数变量1   回传参数变量说明1
#                : 回传参数变量2   回传参数变量说明2
# Date & Author..: 日期 By lixh
# Modify.........:
################################################################################
PRIVATE FUNCTION aint830_01_num_chk(p_num)
DEFINE  p_num    LIKE inpe_t.inpe030
   IF g_imaf081 <> '2' THEN
      IF p_num <> 0 AND p_num <> 1 THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = 'ain-00506'
         LET g_errparam.extend = p_num
         LET g_errparam.popup = TRUE
         CALL cl_err() 
         RETURN FALSE         
      END IF
   END IF
   RETURN TRUE
END FUNCTION]]>
  </point>
  <point name="construct.c.page1.inpe033" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_ooag001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO inpe033  #顯示到畫面上
            NEXT FIELD inpe033                     #返回原欄位
    

]]>
  </point>
  <point name="global.inc" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#GLOBALS "../4gl/aint830_01.inc"]]>
  </point>
  <point name="global.variable" order="" ver="2" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[GLOBALS

   DEFINE g_detail_insert      LIKE type_t.num5   #單身的新增權限
   DEFINE g_detail_delete      LIKE type_t.num5   #單身的刪除權限
   DEFINE g_inpdsite           LIKE inpd_t.inpdsite
   DEFINE g_inpddocno          LIKE inpd_t.inpddocno
   DEFINE g_inpdseq            LIKE inpd_t.inpdseq 
   DEFINE g_inpd_sum           LIKE inpd_t.inpd030
   DEFINE g_type               LIKE type_t.chr1    
   DEFINE g_wc_source          STRING   

   DEFINE g_inpe3_d            DYNAMIC ARRAY OF type_g_inpe_d
   
END GLOBALS

DEFINE gs_keys               DYNAMIC ARRAY OF VARCHAR(500) #同步資料用陣列
DEFINE gs_keys_bak           DYNAMIC ARRAY OF VARCHAR(500) #同步資料用陣列
DEFINE g_sql                 STRING
DEFINE g_cnt                 LIKE type_t.num10
DEFINE g_error_show          LIKE type_t.num5              #
DEFINE g_current_page        LIKE type_t.num5              #目前所在頁數   
DEFINE g_curr_diag           ui.Dialog                     #Current Dialog
DEFINE l_forupd_sql          STRING                        #SELECT ... FOR UPDATE  SQL  
DEFINE l_allow_insert        LIKE type_t.num5              #可新增否 
DEFINE l_allow_delete        LIKE type_t.num5              #可刪除否
DEFINE g_insert              LIKE type_t.chr5              #是否導到其他page
DEFINE l_insert              BOOLEAN
DEFINE l_cmd                 LIKE type_t.chr1
DEFINE l_n                   LIKE type_t.num5              #檢查重複用
DEFINE l_count               LIKE type_t.num5
DEFINE l_lock_sw             LIKE type_t.chr1              #單身鎖住否
DEFINE lb_reproduce          BOOLEAN
DEFINE li_reproduce          LIKE type_t.num5
DEFINE li_reproduce_target   LIKE type_t.num5
DEFINE g_detail_cnt          LIKE type_t.num5
DEFINE g_inpe_d_o            type_g_inpe_d
DEFINE g_imaf071             LIKE imaf_t.imaf071
DEFINE g_imaf072             LIKE imaf_t.imaf072
DEFINE g_imaf073             LIKE imaf_t.imaf073
DEFINE g_imaf074             LIKE imaf_t.imaf074
DEFINE g_imaf081             LIKE imaf_t.imaf081
DEFINE g_imaf082             LIKE imaf_t.imaf082
DEFINE g_imaf083             LIKE imaf_t.imaf083
DEFINE g_imaf084             LIKE imaf_t.imaf084
DEFINE g_imaf032             LIKE imaf_t.imaf032
DEFINE g_inpd001             LIKE inpd_t.inpd001
DEFINE g_inpd002             LIKE inpd_t.inpd002
DEFINE g_inpd003             LIKE inpd_t.inpd003
DEFINE g_inpd004             LIKE inpd_t.inpd004
DEFINE g_inpd005             LIKE inpd_t.inpd005
DEFINE g_inpd006             LIKE inpd_t.inpd006
DEFINE g_inpd007             LIKE inpd_t.inpd007
#DEFINE g_wc_source           STRING]]>
  </point>
  <point name="input.a.page1.inpe012" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_inpe_d[l_ac].inpe012) THEN 
            END IF 

]]>
  </point>
  <point name="input.a.page1.inpe031" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_inpe_d[l_ac].inpe031
            CALL ap_ref_array2(g_ref_fields,"SELECT ooag011 FROM ooag_t WHERE ooagent='"||g_enterprise||"' AND ooag001=? ","") RETURNING g_rtn_fields
            LET g_inpe_d[l_ac].inpe031_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_inpe_d[l_ac].inpe031_desc

]]>
  </point>
  <point name="input.a.page1.inpe033" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_inpe_d[l_ac].inpe033) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist_and_ref_val("v_ooag001") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 
               ELSE
                  #檢查失敗時後續處理
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_inpe_d[l_ac].inpe033
            CALL ap_ref_array2(g_ref_fields,"SELECT ooag011 FROM ooag_t WHERE ooagent='"||g_enterprise||"' AND ooag001=? ","") RETURNING g_rtn_fields
            LET g_inpe_d[l_ac].inpe033_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_inpe_d[l_ac].inpe033_desc

]]>
  </point>
  <point name="input.a.page1.inpe036" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_inpe_d[l_ac].inpe036
            CALL ap_ref_array2(g_ref_fields,"SELECT ooag011 FROM ooag_t WHERE ooagent='"||g_enterprise||"' AND ooag001=? ","") RETURNING g_rtn_fields
            LET g_inpe_d[l_ac].inpe036_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_inpe_d[l_ac].inpe036_desc

]]>
  </point>
  <point name="input.a.page1.inpe038" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_inpe_d[l_ac].inpe038
            CALL ap_ref_array2(g_ref_fields,"SELECT ooag011 FROM ooag_t WHERE ooagent='"||g_enterprise||"' AND ooag001=? ","") RETURNING g_rtn_fields
            LET g_inpe_d[l_ac].inpe038_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_inpe_d[l_ac].inpe038_desc

]]>
  </point>
  <point name="input.a.page1.inpe051" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_inpe_d[l_ac].inpe051
            CALL ap_ref_array2(g_ref_fields,"SELECT ooag011 FROM ooag_t WHERE ooagent='"||g_enterprise||"' AND ooag001=? ","") RETURNING g_rtn_fields
            LET g_inpe_d[l_ac].inpe051_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_inpe_d[l_ac].inpe051_desc

]]>
  </point>
  <point name="input.a.page1.inpe053" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_inpe_d[l_ac].inpe053
            CALL ap_ref_array2(g_ref_fields,"SELECT ooag011 FROM ooag_t WHERE ooagent='"||g_enterprise||"' AND ooag001=? ","") RETURNING g_rtn_fields
            LET g_inpe_d[l_ac].inpe053_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_inpe_d[l_ac].inpe053_desc

]]>
  </point>
  <point name="input.a.page1.inpe056" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_inpe_d[l_ac].inpe056
            CALL ap_ref_array2(g_ref_fields,"SELECT ooag011 FROM ooag_t WHERE ooagent='"||g_enterprise||"' AND ooag001=? ","") RETURNING g_rtn_fields
            LET g_inpe_d[l_ac].inpe056_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_inpe_d[l_ac].inpe056_desc

]]>
  </point>
  <point name="input.a.page1.inpe058" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_inpe_d[l_ac].inpe058
            CALL ap_ref_array2(g_ref_fields,"SELECT ooag011 FROM ooag_t WHERE ooagent='"||g_enterprise||"' AND ooag001=? ","") RETURNING g_rtn_fields
            LET g_inpe_d[l_ac].inpe058_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_inpe_d[l_ac].inpe058_desc

]]>
  </point>
  <point name="input.a.page1.inpedocno" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_inpe_d[g_detail_idx].inpesite IS NOT NULL AND g_inpe_d[g_detail_idx].inpedocno IS NOT NULL AND g_inpe_d[g_detail_idx].inpeseq IS NOT NULL AND g_inpe_d[g_detail_idx].inpeseq2 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_inpe_d[g_detail_idx].inpesite != g_inpe_d_t.inpesite OR g_inpe_d[g_detail_idx].inpedocno != g_inpe_d_t.inpedocno OR g_inpe_d[g_detail_idx].inpeseq != g_inpe_d_t.inpeseq OR g_inpe_d[g_detail_idx].inpeseq2 != g_inpe_d_t.inpeseq2)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM inpe_t WHERE "||"inpeent = '" ||g_enterprise|| "' AND "||"inpesite = '"||g_inpe_d[g_detail_idx].inpesite ||"' AND "|| "inpedocno = '"||g_inpe_d[g_detail_idx].inpedocno ||"' AND "|| "inpeseq = '"||g_inpe_d[g_detail_idx].inpeseq ||"' AND "|| "inpeseq2 = '"||g_inpe_d[g_detail_idx].inpeseq2 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page1.inpeseq" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_inpe_d[g_detail_idx].inpesite IS NOT NULL AND g_inpe_d[g_detail_idx].inpedocno IS NOT NULL AND g_inpe_d[g_detail_idx].inpeseq IS NOT NULL AND g_inpe_d[g_detail_idx].inpeseq2 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_inpe_d[g_detail_idx].inpesite != g_inpe_d_t.inpesite OR g_inpe_d[g_detail_idx].inpedocno != g_inpe_d_t.inpedocno OR g_inpe_d[g_detail_idx].inpeseq != g_inpe_d_t.inpeseq OR g_inpe_d[g_detail_idx].inpeseq2 != g_inpe_d_t.inpeseq2)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM inpe_t WHERE "||"inpeent = '" ||g_enterprise|| "' AND "||"inpesite = '"||g_inpe_d[g_detail_idx].inpesite ||"' AND "|| "inpedocno = '"||g_inpe_d[g_detail_idx].inpedocno ||"' AND "|| "inpeseq = '"||g_inpe_d[g_detail_idx].inpeseq ||"' AND "|| "inpeseq2 = '"||g_inpe_d[g_detail_idx].inpeseq2 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page1.inpeseq2" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_inpe_d[g_detail_idx].inpesite IS NOT NULL AND g_inpe_d[g_detail_idx].inpedocno IS NOT NULL AND g_inpe_d[g_detail_idx].inpeseq IS NOT NULL AND g_inpe_d[g_detail_idx].inpeseq2 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_inpe_d[g_detail_idx].inpesite != g_inpe_d_t.inpesite OR g_inpe_d[g_detail_idx].inpedocno != g_inpe_d_t.inpedocno OR g_inpe_d[g_detail_idx].inpeseq != g_inpe_d_t.inpeseq OR g_inpe_d[g_detail_idx].inpeseq2 != g_inpe_d_t.inpeseq2)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM inpe_t WHERE "||"inpeent = '" ||g_enterprise|| "' AND "||"inpesite = '"||g_inpe_d[g_detail_idx].inpesite ||"' AND "|| "inpedocno = '"||g_inpe_d[g_detail_idx].inpedocno ||"' AND "|| "inpeseq = '"||g_inpe_d[g_detail_idx].inpeseq ||"' AND "|| "inpeseq2 = '"||g_inpe_d[g_detail_idx].inpeseq2 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page1.inpesite" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_inpe_d[g_detail_idx].inpesite IS NOT NULL AND g_inpe_d[g_detail_idx].inpedocno IS NOT NULL AND g_inpe_d[g_detail_idx].inpeseq IS NOT NULL AND g_inpe_d[g_detail_idx].inpeseq2 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_inpe_d[g_detail_idx].inpesite != g_inpe_d_t.inpesite OR g_inpe_d[g_detail_idx].inpedocno != g_inpe_d_t.inpedocno OR g_inpe_d[g_detail_idx].inpeseq != g_inpe_d_t.inpeseq OR g_inpe_d[g_detail_idx].inpeseq2 != g_inpe_d_t.inpeseq2)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM inpe_t WHERE "||"inpeent = '" ||g_enterprise|| "' AND "||"inpesite = '"||g_inpe_d[g_detail_idx].inpesite ||"' AND "|| "inpedocno = '"||g_inpe_d[g_detail_idx].inpedocno ||"' AND "|| "inpeseq = '"||g_inpe_d[g_detail_idx].inpeseq ||"' AND "|| "inpeseq2 = '"||g_inpe_d[g_detail_idx].inpeseq2 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page1_aint830_01.inpe008" order="" ver="4" cite_std="N" new="N" status="u" src="s" readonly="" mark_hard="N">
    <![CDATA[#            IF g_inpe_d[l_ac].inpe008 IS NOT NULL THEN
#               LET g_inpe_d[l_ac].inpe008 = ' '
#            END IF
            IF NOT cl_null(g_inpe_d[l_ac].inpe008)  THEN
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND g_inpe_d[g_detail_idx].inpe008 != g_inpe_d_t.inpe008) THEN
                  #若料號有作製造批號唯一時，需檢核維護的製造批號資是否已經存在inai_t檔中
                  LET l_cnt = 0
                  SELECT COUNT(*) INTO l_cnt
                    FROM inai_t
                   WHERE inaient = g_enterprise
                     AND inai007 = g_inpe_d[l_ac].inpe008
                     AND inaisite = p_inpesite
                     AND inai001 = l_inpd001
                     AND inai002 = l_inpd002
                  IF cl_null(l_cnt) THEN LET l_cnt = 0 END IF
                  IF l_cnt = 0 THEN
                     SELECT COUNT(*) INTO l_cnt
                       FROM inpe_t
                      WHERE inpeent = g_enterprise
                        AND inpesite = p_inpesite
#                        AND inpedocno= p_inpedocno
#                        AND inpeseq = p_inpeseq
                        AND inpe001 = l_inpd001
                        AND inpe002 = l_inpd002
                        AND inpe008 = g_inpe_d[l_ac].inpe008
                     IF cl_null(l_cnt) THEN LET l_cnt = 0 END IF
                  END IF
                  #若有請依據料號設置的控管方式控管
                  IF l_cnt <> 0 THEN
                     CASE g_imaf074
                        WHEN '1'
                           INITIALIZE g_errparam TO NULL
                           LET g_errparam.code = 'sub-00502'
                           LET g_errparam.extend = g_inpe_d[l_ac].inpe008
                           LET g_errparam.popup = TRUE
                           CALL cl_err()

                           LET g_inpe_d[l_ac].inpe008 = g_inpe_d_t.inpe008
                           NEXT FIELD inpe008
                        WHEN '2'
                           CALL cl_ask_pressanykey('sub-00503')
                        OTHERWISE EXIT CASE
                     END CASE
                  END IF
                  #add--2015/05/08 By shiun--(S)
                  IF NOT s_aooi390_chk('7',g_inpe_d[l_ac].inpe008) THEN
                     LET g_inpe_d[l_ac].inpe008 = g_inpe_d_t.inpe008
                     DISPLAY BY NAME g_inpe_d[l_ac].inpe008
                     NEXT FIELD CURRENT
                  END IF
                  #add--2015/05/08 By shiun--(E)
               END IF
            END IF]]>
  </point>
  <point name="input.a.page1_aint830_01.inpe009" order="" ver="4" cite_std="N" new="N" status="u" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_inpe_d[l_ac].inpe009) THEN
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND g_inpe_d[l_ac].inpe009 != g_inpe_d_t.inpe009) THEN
                  #檢核維護的製造序號資是否已經存在inai_t檔中
                  LET l_cnt = 0
                  SELECT COUNT(*) INTO l_cnt
                    FROM inai_t
                   WHERE inaient = g_enterprise
                     AND inai008 = g_inpe_d[l_ac].inpe009
                     AND inaisite = p_inpesite
                     AND inai001 = l_inpd001
                     AND inai002 = l_inpd002                   
                  IF cl_null(l_cnt) THEN LET l_cnt = 0 END IF
                  IF l_cnt <> 0 THEN
                     INITIALIZE g_errparam TO NULL
                     LET g_errparam.code = 'sub-00130'
                     LET g_errparam.extend = g_inpe_d[l_ac].inpe009
                     LET g_errparam.popup = TRUE
                     CALL cl_err()

                     LET g_inpe_d[l_ac].inpe009 = g_inpe_d_t.inpe009
                     NEXT FIELD inpe009
                  END IF
                  #料號有作製造序號唯一
                  LET l_cnt = 0
                  SELECT COUNT(*) INTO l_cnt
                    FROM inpe_t
                   WHERE inpeent = g_enterprise
                     AND inpesite = p_inpesite
#                     AND inpedocno = p_inpedocno
#                     AND inpeseq = p_inpeseq
                     AND inpe001 = l_inpd001
                     AND inpe002 = l_inpd002
                     AND inpe009 = g_inpe_d[l_ac].inpe009
                  IF cl_null(l_cnt) THEN LET l_cnt = 0 END IF
                  #若有請依據料號設置的控管方式控管
                  IF l_cnt <> 0 THEN
                     CASE g_imaf084
                        WHEN '1'
                           INITIALIZE g_errparam TO NULL
                           LET g_errparam.code = 'sub-00504'
                           LET g_errparam.extend = g_inpe_d[l_ac].inpe009
                           LET g_errparam.popup = TRUE
                           CALL cl_err()

                           LET g_inpe_d[l_ac].inpe009 = g_inpe_d_t.inpe009
                           NEXT FIELD inpe009
                        WHEN '2'
                           CALL cl_ask_pressanykey('sub-00505')
                        OTHERWISE EXIT CASE
                     END CASE
                  END IF
                  #add--2015/05/08 By shiun--(S)
                  IF NOT s_aooi390_chk('8',g_inpe_d[l_ac].inpe009) THEN
                     LET g_inpe_d[l_ac].inpe009 = g_inpe_d_t.inpe009
                     DISPLAY BY NAME g_inpe_d[l_ac].inpe009
                     NEXT FIELD CURRENT
                  END IF
                  #add--2015/05/08 By shiun--(E)
               END IF
            END IF]]>
  </point>
  <point name="input.a.page1_aint830_01.inpe010" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_inpe_d[l_ac].inpe010) THEN
               LET g_inpe_d[l_ac].inpe011 = g_inpe_d[l_ac].inpe010 + g_imaf032
            END IF 
            IF NOT cl_null(g_inpe_d[l_ac].inpe011) AND NOT cl_null(g_inpe_d[l_ac].inpe010) THEN
               IF g_inpe_d[l_ac].inpe011 < g_inpe_d[l_ac].inpe010 THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = 'ain-00311'
                  LET g_errparam.extend = ''
                  LET g_errparam.popup = TRUE
                  CALL cl_err()  
                  NEXT FIELD inpe010                  
               END IF
            END IF]]>
  </point>
  <point name="input.a.page1_aint830_01.inpe011" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_inpe_d[l_ac].inpe011) AND NOT cl_null(g_inpe_d[l_ac].inpe010) THEN
               IF g_inpe_d[l_ac].inpe011 < g_inpe_d[l_ac].inpe010 THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = 'ain-00311'
                  LET g_errparam.extend = ''
                  LET g_errparam.popup = TRUE
                  CALL cl_err()    
                  NEXT FIELD inpe011                  
               END IF
            END IF]]>
  </point>
  <point name="input.a.page1_aint830_01.inpe012" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_inpe_d[l_ac].inpe012) THEN 
            END IF 

]]>
  </point>
  <point name="input.a.page1_aint830_01.inpe030" order="" ver="3" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_inpe_d[l_ac].inpe030) THEN 
               LET l_sum = 0
               SELECT SUM(inpe030) INTO l_sum FROM inpe_t
                WHERE inpeent = g_enterprise
                  AND inpesite = g_site 
                  AND inpedocno = p_inpedocno
                  AND inpeseq = p_inpeseq
                  AND inpeseq2 <> g_inpe_d[l_ac].inpeseq2
               IF cl_null(l_sum) THEN
                  LET l_sum = 0
               END IF
               IF l_sum + g_inpe_d[l_ac].inpe030 > p_sum THEN                  
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = 'ain-00474'
                  LET g_errparam.extend = g_inpe_d[l_ac].inpe030
                  LET g_errparam.popup = TRUE
                  CALL cl_err()   
                  LET g_inpe_d[l_ac].inpe030 = g_inpe_d_t.inpe030     
                  NEXT FIELD inpe030                   
               END IF 
               IF NOT cl_null(g_inpe_d[l_ac].inpe009) THEN   #add by lixh 20150323              
                  IF NOT aint830_01_num_chk(g_inpe_d[l_ac].inpe030) THEN
                     LET g_inpe_d[l_ac].inpe030 = g_inpe_d_t.inpe030
                     NEXT FIELD inpe030 
                  END IF
               END IF               
            END IF 
            
]]>
  </point>
  <point name="input.a.page1_aint830_01.inpe031" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_inpe_d[l_ac].inpe031
            CALL ap_ref_array2(g_ref_fields,"SELECT ooag011 FROM ooag_t WHERE ooagent='"||g_enterprise||"' AND ooag001=? ","") RETURNING g_rtn_fields
            LET g_inpe_d[l_ac].inpe031_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_inpe_d[l_ac].inpe031_desc

]]>
  </point>
  <point name="input.a.page1_aint830_01.inpe033" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            CALL s_desc_get_person_desc(g_inpe_d[l_ac].inpe033) RETURNING g_inpe_d[l_ac].inpe033_desc
            IF NOT cl_null(g_inpe_d[l_ac].inpe033) THEN 
#此段落由子樣板a19產生
               #校驗代值
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數

               LET g_chkparam.arg1 = g_inpe_d[l_ac].inpe033   
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_ooag001") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 
               ELSE
                  #檢查失敗時後續處理
                  LET g_inpe_d[l_ac].inpe033 = g_inpe_d_t.inpe033  
                  CALL s_desc_get_person_desc(g_inpe_d[l_ac].inpe033) RETURNING g_inpe_d[l_ac].inpe033_desc
                  NEXT FIELD CURRENT
               END IF
              
            END IF 
            CALL s_desc_get_person_desc(g_inpe_d[l_ac].inpe033) RETURNING g_inpe_d[l_ac].inpe033_desc
#            INITIALIZE g_ref_fields TO NULL
#            LET g_ref_fields[1] = g_inpe_d[l_ac].inpe033
#            CALL ap_ref_array2(g_ref_fields,"SELECT ooag011 FROM ooag_t WHERE ooagent='"||g_enterprise||"' AND ooag001=? ","") RETURNING g_rtn_fields
#            LET g_inpe_d[l_ac].inpe033_desc = '', g_rtn_fields[1] , ''
#            DISPLAY BY NAME g_inpe_d[l_ac].inpe033_desc

]]>
  </point>
  <point name="input.a.page1_aint830_01.inpe035" order="" ver="3" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_inpe_d[l_ac].inpe035) THEN 
               LET l_sum = 0
               SELECT SUM(inpe035) INTO l_sum FROM inpe_t
                WHERE inpeent = g_enterprise
                  AND inpesite = g_site 
                  AND inpedocno = p_inpedocno
                  AND inpeseq = p_inpeseq
                  AND inpeseq2 <> g_inpe_d[l_ac].inpeseq2
               IF cl_null(l_sum) THEN
                  LET l_sum = 0
               END IF
               IF l_sum + g_inpe_d[l_ac].inpe035 > p_sum THEN                  
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = 'ain-00474'
                  LET g_errparam.extend = g_inpe_d[l_ac].inpe035
                  LET g_errparam.popup = TRUE
                  CALL cl_err()   
                  LET g_inpe_d[l_ac].inpe035 = g_inpe_d_t.inpe035   
                  NEXT FIELD inpe035                  
               END IF   
               IF NOT cl_null(g_inpe_d[l_ac].inpe009) THEN   #add by lixh 20150323               
                  IF NOT aint830_01_num_chk(g_inpe_d[l_ac].inpe035) THEN
                     LET g_inpe_d[l_ac].inpe035 = g_inpe_d_t.inpe035
                     NEXT FIELD inpe035 
                  END IF 
               END IF               
            END IF 

]]>
  </point>
  <point name="input.a.page1_aint830_01.inpe036" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_inpe_d[l_ac].inpe036
            CALL ap_ref_array2(g_ref_fields,"SELECT ooag011 FROM ooag_t WHERE ooagent='"||g_enterprise||"' AND ooag001=? ","") RETURNING g_rtn_fields
            LET g_inpe_d[l_ac].inpe036_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_inpe_d[l_ac].inpe036_desc

]]>
  </point>
  <point name="input.a.page1_aint830_01.inpe038" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
            CALL s_desc_get_person_desc(g_inpe_d[l_ac].inpe038) RETURNING g_inpe_d[l_ac].inpe038_desc
            IF NOT cl_null(g_inpe_d[l_ac].inpe038) THEN 
               #此段落由子樣板a19產生
               #校驗代值
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數

               LET g_chkparam.arg1 = g_inpe_d[l_ac].inpe038   
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_ooag001") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 
               ELSE
                  #檢查失敗時後續處理
                  LET g_inpe_d[l_ac].inpe038 = g_inpe_d_t.inpe038  
                  CALL s_desc_get_person_desc(g_inpe_d[l_ac].inpe038) RETURNING g_inpe_d[l_ac].inpe038_desc
                  NEXT FIELD CURRENT
               END IF
              
            END IF 
            CALL s_desc_get_person_desc(g_inpe_d[l_ac].inpe038) RETURNING g_inpe_d[l_ac].inpe038_desc

]]>
  </point>
  <point name="input.a.page1_aint830_01.inpe050" order="" ver="3" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_inpe_d[l_ac].inpe050) THEN 
               LET l_sum = 0
               SELECT SUM(inpe050) INTO l_sum FROM inpe_t
                WHERE inpeent = g_enterprise
                  AND inpesite = g_site 
                  AND inpedocno = p_inpedocno
                  AND inpeseq = p_inpeseq
                  AND inpeseq2 <> g_inpe_d[l_ac].inpeseq2
               IF cl_null(l_sum) THEN
                  LET l_sum = 0
               END IF
               IF l_sum + g_inpe_d[l_ac].inpe050 > p_sum THEN                  
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = 'ain-00474'
                  LET g_errparam.extend = g_inpe_d[l_ac].inpe050
                  LET g_errparam.popup = TRUE
                  CALL cl_err()   
                  LET g_inpe_d[l_ac].inpe050 = g_inpe_d_t.inpe050    
                  NEXT FIELD inpe050                  
               END IF 
               IF NOT cl_null(g_inpe_d[l_ac].inpe009) THEN   #add by lixh 20150323
                  IF NOT aint830_01_num_chk(g_inpe_d[l_ac].inpe050) THEN    #add by lixh 20150320
                     LET g_inpe_d[l_ac].inpe050 = g_inpe_d_t.inpe050
                     NEXT FIELD inpe050 
                  END IF 
               END IF               
            END IF 

]]>
  </point>
  <point name="input.a.page1_aint830_01.inpe051" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_inpe_d[l_ac].inpe051
            CALL ap_ref_array2(g_ref_fields,"SELECT ooag011 FROM ooag_t WHERE ooagent='"||g_enterprise||"' AND ooag001=? ","") RETURNING g_rtn_fields
            LET g_inpe_d[l_ac].inpe051_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_inpe_d[l_ac].inpe051_desc

]]>
  </point>
  <point name="input.a.page1_aint830_01.inpe053" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            CALL s_desc_get_person_desc(g_inpe_d[l_ac].inpe053) RETURNING g_inpe_d[l_ac].inpe053_desc
            IF NOT cl_null(g_inpe_d[l_ac].inpe053) THEN 
#此段落由子樣板a19產生
               #校驗代值
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數

               LET g_chkparam.arg1 = g_inpe_d[l_ac].inpe053   
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_ooag001") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 
               ELSE
                  #檢查失敗時後續處理
                  LET g_inpe_d[l_ac].inpe053 = g_inpe_d_t.inpe053  
                  CALL s_desc_get_person_desc(g_inpe_d[l_ac].inpe053) RETURNING g_inpe_d[l_ac].inpe053_desc
                  NEXT FIELD CURRENT
               END IF
              
            END IF 
            CALL s_desc_get_person_desc(g_inpe_d[l_ac].inpe053) RETURNING g_inpe_d[l_ac].inpe053_desc

]]>
  </point>
  <point name="input.a.page1_aint830_01.inpe055" order="" ver="3" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_inpe_d[l_ac].inpe055) THEN 
               LET l_sum = 0
               SELECT SUM(inpe055) INTO l_sum FROM inpe_t
                WHERE inpeent = g_enterprise
                  AND inpesite = g_site 
                  AND inpedocno = p_inpedocno
                  AND inpeseq = p_inpeseq
                  AND inpeseq2 <> g_inpe_d[l_ac].inpeseq2
               IF cl_null(l_sum) THEN
                  LET l_sum = 0
               END IF
               IF l_sum + g_inpe_d[l_ac].inpe055 > p_sum THEN                  
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = 'ain-00474'
                  LET g_errparam.extend = g_inpe_d[l_ac].inpe055
                  LET g_errparam.popup = TRUE
                  CALL cl_err()   
                  LET g_inpe_d[l_ac].inpe055 = g_inpe_d_t.inpe055 
                  NEXT FIELD inpe055                  
               END IF   
               IF NOT cl_null(g_inpe_d[l_ac].inpe009) THEN   #add by lixh 20150323
                  IF NOT aint830_01_num_chk(g_inpe_d[l_ac].inpe055) THEN
                     LET g_inpe_d[l_ac].inpe055 = g_inpe_d_t.inpe055
                     NEXT FIELD inpe055 
                  END IF 
               END IF               
            END IF 

]]>
  </point>
  <point name="input.a.page1_aint830_01.inpe056" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_inpe_d[l_ac].inpe056
            CALL ap_ref_array2(g_ref_fields,"SELECT ooag011 FROM ooag_t WHERE ooagent='"||g_enterprise||"' AND ooag001=? ","") RETURNING g_rtn_fields
            LET g_inpe_d[l_ac].inpe056_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_inpe_d[l_ac].inpe056_desc

]]>
  </point>
  <point name="input.a.page1_aint830_01.inpe058" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            CALL s_desc_get_person_desc(g_inpe_d[l_ac].inpe058) RETURNING g_inpe_d[l_ac].inpe058_desc
            IF NOT cl_null(g_inpe_d[l_ac].inpe058) THEN 
#此段落由子樣板a19產生
               #校驗代值
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數

               LET g_chkparam.arg1 = g_inpe_d[l_ac].inpe058   
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_ooag001") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 
               ELSE
                  #檢查失敗時後續處理
                  LET g_inpe_d[l_ac].inpe058 = g_inpe_d_t.inpe058  
                  CALL s_desc_get_person_desc(g_inpe_d[l_ac].inpe058) RETURNING g_inpe_d[l_ac].inpe058_desc
                  NEXT FIELD CURRENT
               END IF
              
            END IF 
            CALL s_desc_get_person_desc(g_inpe_d[l_ac].inpe058) RETURNING g_inpe_d[l_ac].inpe058_desc]]>
  </point>
  <point name="input.a.page1_aint830_01.inpedocno" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            #確認資料無重複
            IF  g_inpe_d[g_detail_idx].inpesite IS NOT NULL AND g_inpe_d[g_detail_idx].inpedocno IS NOT NULL AND g_inpe_d[g_detail_idx].inpeseq IS NOT NULL AND g_inpe_d[g_detail_idx].inpeseq2 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_inpe_d[g_detail_idx].inpesite != g_inpe_d_t.inpesite OR g_inpe_d[g_detail_idx].inpedocno != g_inpe_d_t.inpedocno OR g_inpe_d[g_detail_idx].inpeseq != g_inpe_d_t.inpeseq OR g_inpe_d[g_detail_idx].inpeseq2 != g_inpe_d_t.inpeseq2)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM inpe_t WHERE "||"inpeent = '" ||g_enterprise|| "' AND "||"inpesite = '"||g_inpe_d[g_detail_idx].inpesite ||"' AND "|| "inpedocno = '"||g_inpe_d[g_detail_idx].inpedocno ||"' AND "|| "inpeseq = '"||g_inpe_d[g_detail_idx].inpeseq ||"' AND "|| "inpeseq2 = '"||g_inpe_d[g_detail_idx].inpeseq2 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page1_aint830_01.inpeseq" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            #確認資料無重複
            IF  g_inpe_d[g_detail_idx].inpesite IS NOT NULL AND g_inpe_d[g_detail_idx].inpedocno IS NOT NULL AND g_inpe_d[g_detail_idx].inpeseq IS NOT NULL AND g_inpe_d[g_detail_idx].inpeseq2 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_inpe_d[g_detail_idx].inpesite != g_inpe_d_t.inpesite OR g_inpe_d[g_detail_idx].inpedocno != g_inpe_d_t.inpedocno OR g_inpe_d[g_detail_idx].inpeseq != g_inpe_d_t.inpeseq OR g_inpe_d[g_detail_idx].inpeseq2 != g_inpe_d_t.inpeseq2)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM inpe_t WHERE "||"inpeent = '" ||g_enterprise|| "' AND "||"inpesite = '"||g_inpe_d[g_detail_idx].inpesite ||"' AND "|| "inpedocno = '"||g_inpe_d[g_detail_idx].inpedocno ||"' AND "|| "inpeseq = '"||g_inpe_d[g_detail_idx].inpeseq ||"' AND "|| "inpeseq2 = '"||g_inpe_d[g_detail_idx].inpeseq2 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page1_aint830_01.inpeseq2" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            #確認資料無重複
            IF  g_inpe_d[g_detail_idx].inpesite IS NOT NULL AND g_inpe_d[g_detail_idx].inpedocno IS NOT NULL AND g_inpe_d[g_detail_idx].inpeseq IS NOT NULL AND g_inpe_d[g_detail_idx].inpeseq2 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_inpe_d[g_detail_idx].inpesite != g_inpe_d_t.inpesite OR g_inpe_d[g_detail_idx].inpedocno != g_inpe_d_t.inpedocno OR g_inpe_d[g_detail_idx].inpeseq != g_inpe_d_t.inpeseq OR g_inpe_d[g_detail_idx].inpeseq2 != g_inpe_d_t.inpeseq2)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM inpe_t WHERE "||"inpeent = '" ||g_enterprise|| "' AND "||"inpesite = '"||g_inpe_d[g_detail_idx].inpesite ||"' AND "|| "inpedocno = '"||g_inpe_d[g_detail_idx].inpedocno ||"' AND "|| "inpeseq = '"||g_inpe_d[g_detail_idx].inpeseq ||"' AND "|| "inpeseq2 = '"||g_inpe_d[g_detail_idx].inpeseq2 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page1_aint830_01.inpesite" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            #確認資料無重複
            IF  g_inpe_d[g_detail_idx].inpesite IS NOT NULL AND g_inpe_d[g_detail_idx].inpedocno IS NOT NULL AND g_inpe_d[g_detail_idx].inpeseq IS NOT NULL AND g_inpe_d[g_detail_idx].inpeseq2 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_inpe_d[g_detail_idx].inpesite != g_inpe_d_t.inpesite OR g_inpe_d[g_detail_idx].inpedocno != g_inpe_d_t.inpedocno OR g_inpe_d[g_detail_idx].inpeseq != g_inpe_d_t.inpeseq OR g_inpe_d[g_detail_idx].inpeseq2 != g_inpe_d_t.inpeseq2)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM inpe_t WHERE "||"inpeent = '" ||g_enterprise|| "' AND "||"inpesite = '"||g_inpe_d[g_detail_idx].inpesite ||"' AND "|| "inpedocno = '"||g_inpe_d[g_detail_idx].inpedocno ||"' AND "|| "inpeseq = '"||g_inpe_d[g_detail_idx].inpeseq ||"' AND "|| "inpeseq2 = '"||g_inpe_d[g_detail_idx].inpeseq2 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.action" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[         ]]>
  </point>
  <point name="input.after_input" order="" ver="3" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #add by lixh 20150323
            IF p_type = '1' THEN
               LET s_inpe_sum = 0
               SELECT SUM(inpe030) INTO s_inpe_sum FROM inpe_t
                WHERE inpeent = g_enterprise
                  AND inpesite = p_inpesite
                  AND inpedocno = p_inpedocno
                  AND inpeseq = p_inpeseq
                  AND inpe030 IS NOT NULL
               IF s_inpe_sum <> p_sum THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = 'ain-00531'
                  LET g_errparam.extend = ''
                  LET g_errparam.popup = TRUE
                  CALL cl_err()    
                  NEXT FIELD inpe030             
               END IF
            END IF
            IF p_type = '2' THEN
               LET s_inpe_sum = 0
               SELECT SUM(inpe035) INTO s_inpe_sum FROM inpe_t
                WHERE inpeent = g_enterprise
                  AND inpesite = p_inpesite
                  AND inpedocno = p_inpedocno
                  AND inpeseq = p_inpeseq
                  AND inpe035 IS NOT NULL
               IF s_inpe_sum <> p_sum THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = 'ain-00531'
                  LET g_errparam.extend = ''
                  LET g_errparam.popup = TRUE
                  CALL cl_err()    
                  NEXT FIELD inpe035             
               END IF
            END IF   
            IF p_type = '3' THEN
               LET s_inpe_sum = 0
               SELECT SUM(inpe050) INTO s_inpe_sum FROM inpe_t
                WHERE inpeent = g_enterprise
                  AND inpesite = p_inpesite
                  AND inpedocno = p_inpedocno
                  AND inpeseq = p_inpeseq
                  AND inpe050 IS NOT NULL
               IF s_inpe_sum <> p_sum THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = 'ain-00531'
                  LET g_errparam.extend = ''
                  LET g_errparam.popup = TRUE
                  CALL cl_err()    
                  NEXT FIELD inpe050             
               END IF
            END IF  
            IF p_type = '4' THEN
               LET s_inpe_sum = 0
               SELECT SUM(inpe055) INTO s_inpe_sum FROM inpe_t
                WHERE inpeent = g_enterprise
                  AND inpesite = p_inpesite
                  AND inpedocno = p_inpedocno
                  AND inpeseq = p_inpeseq
                  AND inpe055 IS NOT NULL
               IF s_inpe_sum <> p_sum THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = 'ain-00531'
                  LET g_errparam.extend = ''
                  LET g_errparam.popup = TRUE
                  CALL cl_err()    
                  NEXT FIELD inpe055             
               END IF
            END IF              
            #add by lixh 20150323]]>
  </point>
  <point name="input.b.page1_aint830_01.inpe008" order="" ver="4" cite_std="N" new="N" status="u" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF cl_null(g_inpe_d[l_ac].inpe008) THEN
               #若料件有作製造批號自動編碼時，需呼叫自動編號應用元件進行編碼
               IF g_imaf072 = 'Y'  THEN
                  #modify--2015/07/02 By shiun--(S)
                  CALL s_aooi390_gen_1('7',g_imaf073)
                       RETURNING l_success,g_inpe_d[l_ac].inpe008,l_oofg_return
                  #modify--2015/07/02 By shiun--(E)
               END IF
            END IF]]>
  </point>
  <point name="input.b.page1_aint830_01.inpe009" order="" ver="4" cite_std="N" new="N" status="u" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF cl_null(g_inpe_d[l_ac].inpe009) THEN
               #若料件有作製造序號自動編碼時，需呼叫自動編號應用元件進行編碼
               IF g_imaf082 = 'Y' THEN
                  CALL s_aooi390_gen_1('8',g_imaf083)
                       RETURNING l_success,g_inpe_d[l_ac].inpe009,l_oofg_return
               END IF
            END IF]]>
  </point>
  <point name="input.before_close" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   END IF]]>
  </point>
  <point name="input.before_input" order="" ver="3" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            SELECT inpd001,inpdstus INTO l_inpd001,l_inpdstus FROM inpd_t
             WHERE inpdent = g_enterprise
               AND inpdsite = p_inpesite
               AND inpddocno = p_inpedocno
               AND inpdseq = p_inpeseq           
            SELECT imaf071,imaf072,imaf073,imaf074,imaf081,imaf082,imaf083,imaf084,imaf032 
              INTO g_imaf071,g_imaf072,g_imaf073,g_imaf074,g_imaf081,g_imaf082,g_imaf083,g_imaf084,g_imaf032 FROM imaf_t
             WHERE imafent = g_enterprise
               AND imaf001 = l_inpd001
               AND imafsite = p_inpesite
      
            IF g_imaf071 = '2' AND g_imaf081 = '2' THEN
               INITIALIZE g_errparam TO NULL
               LET g_errparam.code = 'ain-00316'
               LET g_errparam.extend = l_inpd001
               LET g_errparam.popup = TRUE
               CALL cl_err()               
               RETURN
            END IF 
            IF l_inpdstus <> 'N' AND (g_type = '1' OR g_type = '2' ) THEN    #初盤
               EXIT DIALOG
            END IF
            
            IF (l_inpdstus ='S' OR l_inpdstus ='6') AND (g_type = '3' OR g_type = '4' ) THEN   #復盤
               EXIT DIALOG
            END IF       
     
            CALL aint830_01_b_fill(p_inpesite,p_inpedocno,p_inpeseq)          
            IF g_insert = 'Y' AND NOT cl_null(g_insert) THEN 
              CALL FGL_SET_ARR_CURR(g_inpe_d.getLength()+1) 
              LET g_insert = 'N' 
           END IF 
           CALL aint830_01_set_entry_b()
           CALL aint830_01_set_no_required()
           call aint830_01_set_required(p_inpesite,p_inpedocno,p_inpeseq)
           CALL aint830_01_set_no_entry_b(p_inpesite,p_inpedocno,p_inpeseq)
#            CALL aint830_01_b_fill(p_inpesite,p_inpedocno,p_inpeseq)
            LET g_detail_cnt = g_inpe_d.getLength()
         
         BEFORE ROW
            #add-point:modify段before row

            #end add-point  
            LET g_detail_idx = DIALOG.getCurrentRow("s_detail1_aint830_01")
            LET l_cmd = ''
            LET l_ac = g_detail_idx
            LET l_lock_sw = 'N'            #DEFAULT
            LET l_n = ARR_COUNT()
            DISPLAY l_ac TO FORMONLY.idx
            DISPLAY g_inpe_d.getLength() TO FORMONLY.cnt
         
            CALL s_transaction_begin()
            LET g_detail_cnt = g_inpe_d.getLength()
            
            IF g_detail_cnt >= l_ac 
               AND g_inpe_d[l_ac].inpesite IS NOT NULL
               AND g_inpe_d[l_ac].inpedocno IS NOT NULL
               AND g_inpe_d[l_ac].inpeseq IS NOT NULL
               AND g_inpe_d[l_ac].inpeseq2 IS NOT NULL
 
            THEN
               LET l_cmd='u'
               LET g_inpe_d_t.* = g_inpe_d[l_ac].*  #BACKUP
               LET g_inpe_d_o.* = g_inpe_d[l_ac].*  #BACKUP
               IF NOT aint830_01_lock_b_2("inpe_t") THEN
                  LET l_lock_sw='Y'
               ELSE
                  FETCH aint830_01_bc2 INTO g_inpe_d[l_ac].inpedocno,g_inpe_d[l_ac].inpeseq,g_inpe_d[l_ac].inpeseq2, 
                      g_inpe_d[l_ac].inpesite,g_inpe_d[l_ac].inpe008,g_inpe_d[l_ac].inpe009,g_inpe_d[l_ac].inpe012, 
                      g_inpe_d[l_ac].inpe030,g_inpe_d[l_ac].inpe035,g_inpe_d[l_ac].inpe050,g_inpe_d[l_ac].inpe055, 
                      g_inpe_d[l_ac].inpe010,g_inpe_d[l_ac].inpe011,g_inpe_d[l_ac].inpe031,g_inpe_d[l_ac].inpe032, 
                      g_inpe_d[l_ac].inpe033,g_inpe_d[l_ac].inpe034,g_inpe_d[l_ac].inpe036,g_inpe_d[l_ac].inpe037, 
                      g_inpe_d[l_ac].inpe038,g_inpe_d[l_ac].inpe039,g_inpe_d[l_ac].inpe051,g_inpe_d[l_ac].inpe052, 
                      g_inpe_d[l_ac].inpe053,g_inpe_d[l_ac].inpe054,g_inpe_d[l_ac].inpe056,g_inpe_d[l_ac].inpe057, 
                      g_inpe_d[l_ac].inpe058,g_inpe_d[l_ac].inpe059
                  IF SQLCA.sqlcode THEN
                     INITIALIZE g_errparam TO NULL
                     LET g_errparam.code = SQLCA.sqlcode
                     LET g_errparam.extend = g_inpe_d_t.inpesite
                     LET g_errparam.popup = TRUE
                     CALL cl_err()

                     LET l_lock_sw = "Y"
                  END IF
                  
#                  CALL aint830_01_detail_show()
                  CALL cl_show_fld_cont()
               END IF
            ELSE
               LET l_cmd='a'
            END IF
            IF p_type = '1' THEN     #add by lixh 20150211
               IF cl_null(g_inpe_d[l_ac].inpe033) THEN
                  LET g_inpe_d[l_ac].inpe033 = g_user
                  CALL s_desc_get_person_desc(g_inpe_d[l_ac].inpe033) RETURNING g_inpe_d[l_ac].inpe033_desc                  
                  DISPLAY BY NAME g_inpe_d[l_ac].inpe033_desc
               END IF
               IF cl_null(g_inpe_d[l_ac].inpe034) THEN               
                  LET g_inpe_d[l_ac].inpe034 = g_today
               END IF   
            END IF     
            IF p_type = '2' THEN
               IF cl_null(g_inpe_d[l_ac].inpe038) THEN
                  LET g_inpe_d[l_ac].inpe038 = g_user
                  CALL s_desc_get_person_desc(g_inpe_d[l_ac].inpe038) RETURNING g_inpe_d[l_ac].inpe038_desc
                  DISPLAY BY NAME g_inpe_d[l_ac].inpe038_desc
               END IF
               IF cl_null(g_inpe_d[l_ac].inpe039) THEN              
                  LET g_inpe_d[l_ac].inpe039 = g_today
               END IF    
            END IF                
            IF p_type = '3' THEN
               IF cl_null(g_inpe_d[l_ac].inpe053) THEN
                  LET g_inpe_d[l_ac].inpe053 = g_user
                  CALL s_desc_get_person_desc(g_inpe_d[l_ac].inpe053) RETURNING g_inpe_d[l_ac].inpe053_desc
                  DISPLAY BY NAME g_inpe_d[l_ac].inpe053_desc
               END IF
               IF cl_null(g_inpe_d[l_ac].inpe054) THEN
                  LET g_inpe_d[l_ac].inpe054 = g_today
               END IF   
            END IF          
            IF p_type = '4' THEN
               IF cl_null(g_inpe_d[l_ac].inpe058) THEN
                  LET g_inpe_d[l_ac].inpe058 = g_user
                  CALL s_desc_get_person_desc(g_inpe_d[l_ac].inpe058) RETURNING g_inpe_d[l_ac].inpe058_desc
                  DISPLAY BY NAME g_inpe_d[l_ac].inpe058_desc
               END IF
               IF cl_null(g_inpe_d[l_ac].inpe059) THEN
                  LET g_inpe_d[l_ac].inpe059 = g_today
               END IF   
            END IF              
            CALL aint830_01_set_entry_b()
            CALL aint830_01_set_no_required()
            CALL aint830_01_set_required(p_inpesite,p_inpedocno,p_inpeseq)           
            CALL aint830_01_set_no_entry_b(p_inpesite,p_inpedocno,p_inpeseq)            

         BEFORE INSERT
            
            CALL s_transaction_begin()
            LET l_n = ARR_COUNT()
            LET l_cmd = 'a'
            INITIALIZE g_inpe_d_t.* TO NULL
            INITIALIZE g_inpe_d_o.* TO NULL
            INITIALIZE g_inpe_d[l_ac].* TO NULL 
            #公用欄位給值(單身)
            
            
            LET g_inpe_d_t.* = g_inpe_d[l_ac].*     #新輸入資料
            LET g_inpe_d_o.* = g_inpe_d[l_ac].*     #新輸入資料
            CALL cl_show_fld_cont()
            CALL aint830_01_set_entry_b()
            CALL aint830_01_set_no_required()
            CALL aint830_01_set_required(p_inpesite,p_inpedocno,p_inpeseq)            
            CALL aint830_01_set_no_entry_b(p_inpesite,p_inpedocno,p_inpeseq)
            IF lb_reproduce THEN
               LET lb_reproduce = FALSE
               LET g_inpe_d[li_reproduce_target].* = g_inpe_d[li_reproduce].*
 
               LET g_inpe_d[g_inpe_d.getLength()].inpesite = NULL
               LET g_inpe_d[g_inpe_d.getLength()].inpedocno = NULL
               LET g_inpe_d[g_inpe_d.getLength()].inpeseq = NULL
               LET g_inpe_d[g_inpe_d.getLength()].inpeseq2 = NULL
 
            END IF
            
            #add-point:modify段before insert
            LET g_inpe_d[l_ac].inpesite = p_inpesite
            LET g_inpe_d[l_ac].inpedocno = p_inpedocno
            LET g_inpe_d[l_ac].inpeseq = p_inpeseq
            SELECT MAX(inpeseq2)+1 INTO g_inpe_d[l_ac].inpeseq2 FROM inpe_t
             WHERE inpeent = g_enterprise
               AND inpesite = g_inpe_d[l_ac].inpesite               
               AND inpedocno = g_inpe_d[l_ac].inpedocno
               AND inpeseq = g_inpe_d[l_ac].inpeseq
            IF cl_null(g_inpe_d[l_ac].inpeseq2) THEN LET g_inpe_d[l_ac].inpeseq2 = 1 END IF   
            
            SELECT inpd001,inpd002,inpd003,inpd004,inpd005,inpd006,inpd007,inpd032,inpd033,inpd038,inpd039,inpd052,inpd053,inpd058,inpd059
              INTO g_inpd001,g_inpd002,g_inpd003,g_inpd004,g_inpd005,g_inpd006,g_inpd007,g_inpe_d[l_ac].inpe031,g_inpe_d[l_ac].inpe032,g_inpe_d[l_ac].inpe036,g_inpe_d[l_ac].inpe037,
                   g_inpe_d[l_ac].inpe051,g_inpe_d[l_ac].inpe052,g_inpe_d[l_ac].inpe056,g_inpe_d[l_ac].inpe057
              FROM inpd_t
              WHERE inpdent = g_enterprise
                AND inpdsite = p_inpesite
                AND inpddocno = p_inpedocno
                AND inpdseq = p_inpeseq
                
            LET g_inpe_d[l_ac].inpe010 = g_today
            IF NOT cl_null(g_imaf032) THEN
               LET g_inpe_d[l_ac].inpe011 = g_inpe_d[l_ac].inpe010 + g_imaf032
            END IF   
            IF p_type = '1' THEN
               LET g_inpe_d[l_ac].inpe033 = g_user
               LET g_inpe_d[l_ac].inpe034 = g_today
               CALL s_desc_get_person_desc(g_inpe_d[l_ac].inpe033) RETURNING g_inpe_d[l_ac].inpe033_desc
               #add by lixh 20150320
               IF g_imaf081 <> '2' THEN    
                  LET g_inpe_d[l_ac].inpe030 = 1
               END IF 
               #add by lixh 20150320               
            END IF
            #add by lixh 20150320 
            IF p_type = '2' THEN
               LET g_inpe_d[l_ac].inpe038 = g_user
               LET g_inpe_d[l_ac].inpe039 = g_today
               CALL s_desc_get_person_desc(g_inpe_d[l_ac].inpe038) RETURNING g_inpe_d[l_ac].inpe038_desc
               IF g_imaf081 <> '2' THEN    
                  LET g_inpe_d[l_ac].inpe035 = 1
               END IF               
            END IF 
            IF p_type = '3' THEN
               LET g_inpe_d[l_ac].inpe053 = g_user
               LET g_inpe_d[l_ac].inpe054 = g_today
               CALL s_desc_get_person_desc(g_inpe_d[l_ac].inpe053) RETURNING g_inpe_d[l_ac].inpe053_desc
               IF g_imaf081 <> '2' THEN    
                  LET g_inpe_d[l_ac].inpe050 = 1
               END IF               
            END IF  
            IF p_type = '4' THEN
               LET g_inpe_d[l_ac].inpe058 = g_user
               LET g_inpe_d[l_ac].inpe059 = g_today
               CALL s_desc_get_person_desc(g_inpe_d[l_ac].inpe058) RETURNING g_inpe_d[l_ac].inpe058_desc
               IF g_imaf081 <> '2' THEN    
                  LET g_inpe_d[l_ac].inpe055 = 1
               END IF               
            END IF             
            #add by lixh 20150320             
            #end add-point  
  
         AFTER INSERT
            IF INT_FLAG THEN
               INITIALIZE g_errparam TO NULL
               LET g_errparam.code = 9001
               LET g_errparam.extend = ''
               LET g_errparam.popup = FALSE
               CALL cl_err()

               LET INT_FLAG = 0
               CANCEL INSERT
            END IF
               
            LET l_count = 1  
            SELECT COUNT(*) INTO l_count FROM inpe_t 
             WHERE inpeent = g_enterprise AND inpesite = g_inpe_d[l_ac].inpesite
                                       AND inpedocno = g_inpe_d[l_ac].inpedocno
                                       AND inpeseq = g_inpe_d[l_ac].inpeseq
                                       AND inpeseq2 = g_inpe_d[l_ac].inpeseq2
 
                
            #資料未重複, 插入新增資料
            IF l_count = 0 THEN 
               #add-point:單身新增前

               #end add-point
            
               INITIALIZE gs_keys TO NULL 
               LET gs_keys[1] = g_inpe_d[g_detail_idx].inpesite
               LET gs_keys[2] = g_inpe_d[g_detail_idx].inpedocno
               LET gs_keys[3] = g_inpe_d[g_detail_idx].inpeseq
               LET gs_keys[4] = g_inpe_d[g_detail_idx].inpeseq2
               IF NOT aint830_01_insert_b('inpe_t',gs_keys,"'1'") THEN 
                  CALL s_transaction_end('N','0')
                  CANCEL INSERT                  
               END IF           
               #add-point:單身新增後
#               INSERT INTO inpe_t (inpesite,inpesite,inpedocno,inpeseq,inpeseq2,inpe001,inpd002,inpd003,inpd004,inpd005,inpd006,inpd007,
#                                   inpd008,inpd009,inpd010,inpd011,inpd012,inpd030,inpd031,inpd032,inpd033,inpd034,inpd035,inpd036,inpd037,
#                                   inpd038,inpd039,inpd050,inpd051,inpd052,inpd053,inpd054,inpd055,inpd056,inpd057,inpd058,inpd059)
#                           VALUES (g_enterprise,gs_keys[1],gs_keys[2],gs_keys[3],gs_keys[4],g_inpe001,g_inpe002,g_inpe003,g_inpe004,
#                                   g_inpe005,g_inpe006,g_inpe007,g_inpe_d[l_ac].inpe008,g_inpe_d[l_ac].inpe009,g_inpe_d[l_ac].inpe010,g_inpe_d[l_ac].inpe011,
#                                   g_inpe_d[l_ac].inpe012,g_inpe_d[l_ac].inpe030,g_inpe_d[l_ac].inpe031,g_inpe_d[l_ac].inpe032,g_inpe_d[l_ac].inpe033,g_inpe_d[l_ac].inpe034,g_inpe_d[l_ac].inpe035,
#                                   g_inpe_d[l_ac].inpe036,g_inpe_d[l_ac].inpe037,g_inpe_d[l_ac].inpe038,g_inpe_d[l_ac].inpe039,g_inpe_d[l_ac].inpe050,g_inpe_d[l_ac].inpe051,g_inpe_d[l_ac].inpe052,
#                                   g_inpe_d[l_ac].inpe053,g_inpe_d[l_ac].inpe054,g_inpe_d[l_ac].inpe055,g_inpe_d[l_ac].inpe056,g_inpe_d[l_ac].inpe057,g_inpe_d[l_ac].inpe058,g_inpe_d[l_ac].inpe059)
#               IF SQLCA.sqlcode THEN
#                  INITIALIZE g_errparam TO NULL
#                  LET g_errparam.code = SQLCA.sqlcode
#                  LET g_errparam.extend = 'INSERT'
#                  LET g_errparam.popup = TRUE
#                  CALL cl_err()
#
#                  INITIALIZE g_inpe_d[l_ac].* TO NULL
#                  CALL s_transaction_end('N','0')
#                  CANCEL INSERT
#               END IF               
               #end add-point
            ELSE    
               INITIALIZE g_errparam TO NULL
               LET g_errparam.code = "std-00006"
               LET g_errparam.extend = 'INSERT'
               LET g_errparam.popup = TRUE
               CALL cl_err()

               INITIALIZE g_inpe_d[l_ac].* TO NULL
               CALL s_transaction_end('N','0')
               CANCEL INSERT
            END IF
 
            IF SQLCA.SQLcode  THEN
               INITIALIZE g_errparam TO NULL
               LET g_errparam.code = SQLCA.sqlcode
               LET g_errparam.extend = "inpe_t"
               LET g_errparam.popup = TRUE
               CALL cl_err()
  
               CALL s_transaction_end('N','0')                    
               CANCEL INSERT
            ELSE
               #先刷新資料
               #CALL aint830_01_b_fill(g_wc_source)
               #資料多語言用-增/改
               
               #add-point:input段-after_insert

               #end add-point
               CALL s_transaction_end('Y','0')
               ERROR 'INSERT O.K'
               LET g_detail_cnt = g_detail_cnt + 1
               
#               LET g_wc_source = g_wc_source, " OR (inpesite = '", g_inpe_d[l_ac].inpesite, "' "
#                                  ," AND inpedocno = '", g_inpe_d[l_ac].inpedocno, "' "
#                                  ," AND inpeseq = '", g_inpe_d[l_ac].inpeseq, "' "
#                                  ," AND inpeseq2 = '", g_inpe_d[l_ac].inpeseq2, "' "
# 
#                                  ,")"
            END IF                
              
         BEFORE DELETE                            #是否取消單身
            IF l_cmd = 'a' AND g_inpe_d.getLength() < l_ac THEN
               CALL FGL_SET_ARR_CURR(l_ac-1)
               CALL g_inpe_d.deleteElement(l_ac)
               NEXT FIELD inpesite
            END IF
            IF g_inpe_d[l_ac].inpesite IS NOT NULL
               AND g_inpe_d_t.inpedocno IS NOT NULL
               AND g_inpe_d_t.inpeseq IS NOT NULL
               AND g_inpe_d_t.inpeseq2 IS NOT NULL
 
               THEN     
            
               #add-point:單身刪除ask前

               #end add-point   
               
               IF NOT cl_ask_del_detail() THEN
                  CANCEL DELETE
               END IF
               IF l_lock_sw = "Y" THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code =  -263
                  LET g_errparam.extend = ""
                  LET g_errparam.popup = TRUE
                  CALL cl_err()

                  CANCEL DELETE
               END IF
               
               #add-point:單身刪除前

               #end add-point   
               
               DELETE FROM inpe_t
                WHERE inpeent = g_enterprise AND 
                      inpesite = g_inpe_d_t.inpesite
                      AND inpedocno = g_inpe_d_t.inpedocno
                      AND inpeseq = g_inpe_d_t.inpeseq
                      AND inpeseq2 = g_inpe_d_t.inpeseq2
 
                      
               #add-point:單身刪除中

               #end add-point  
                      
               IF SQLCA.sqlcode THEN
                  INITIALIZE g_errparam TO NULL
               LET g_errparam.code = SQLCA.sqlcode
               LET g_errparam.extend = "inpe_t"
               LET g_errparam.popup = TRUE
               CALL cl_err()

                  CALL s_transaction_end('N','0')
                  CANCEL DELETE   
               ELSE
                  LET g_detail_cnt = g_detail_cnt-1
                  
                  #add-point:單身刪除後

                  #end add-point
                  CALL s_transaction_end('Y','0')
               END IF 
               CLOSE aint830_01_bc2
               LET l_count = g_inpe_d.getLength()
            END IF 
                           INITIALIZE gs_keys TO NULL 
               LET gs_keys[1] = g_inpe_d[g_detail_idx].inpesite
               LET gs_keys[2] = g_inpe_d[g_detail_idx].inpedocno
               LET gs_keys[3] = g_inpe_d[g_detail_idx].inpeseq
               LET gs_keys[4] = g_inpe_d[g_detail_idx].inpeseq2
               
         AFTER ROW
            CLOSE aint830_01_bc2      
            
           ]]>
  </point>
  <point name="input.c.page1.inpe031" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_ooag001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO inpe031  #顯示到畫面上
            NEXT FIELD inpe031                     #返回原欄位]]>
  </point>
  <point name="input.c.page1.inpe033" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_inpe_d[l_ac].inpe033             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "" #

            
            CALL q_ooag001()                                #呼叫開窗

            LET g_inpe_d[l_ac].inpe033 = g_qryparam.return1              

            DISPLAY g_inpe_d[l_ac].inpe033 TO inpe033              #

            NEXT FIELD inpe033                          #返回原欄位

]]>
  </point>
  <point name="input.c.page1_aint830_01.inpe008" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
#            INITIALIZE g_qryparam.* TO NULL
#            LET g_qryparam.state = 'i'
#            LET g_qryparam.reqry = FALSE
#
#            LET g_qryparam.default1 = g_inpe_d[l_ac].inpe008             #給予default值
#            
#            CALL q_inai007()                                #呼叫開窗
#
#            LET g_inpe_d[l_ac].inpe008 = g_qryparam.return1              
#
#            DISPLAY g_inpe_d[l_ac].inpe008 TO inpe008              #
#
#            NEXT FIELD inpe008                          #返回原欄位

]]>
  </point>
  <point name="input.c.page1_aint830_01.inpe009" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
#            INITIALIZE g_qryparam.* TO NULL
#            LET g_qryparam.state = 'i'
#            LET g_qryparam.reqry = FALSE
#
#            LET g_qryparam.default1 = g_inpe_d[l_ac].inpe009             #給予default值
#           
#            CALL q_inai008()                                #呼叫開窗
#
#            LET g_inpe_d[l_ac].inpe009 = g_qryparam.return1              
#
#            DISPLAY g_inpe_d[l_ac].inpe009 TO inpe009              #
#
#            NEXT FIELD inpe009                          #返回原欄位

]]>
  </point>
  <point name="input.c.page1_aint830_01.inpe033" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_inpe_d[l_ac].inpe033             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "" #

            
            CALL q_ooag001()                                #呼叫開窗

            LET g_inpe_d[l_ac].inpe033 = g_qryparam.return1              

            DISPLAY g_inpe_d[l_ac].inpe033 TO inpe033              #

            NEXT FIELD inpe033                          #返回原欄位

]]>
  </point>
  <point name="input.define" order="" ver="4" cite_std="N" new="N" status="u" src="s" readonly="" mark_hard="N">
    <![CDATA[   DEFINE p_inpesite      LIKE inpe_t.inpesite
   DEFINE p_inpedocno     LIKE inpe_t.inpedocno
   DEFINE p_inpeseq       LIKE inpe_t.inpeseq
   DEFINE p_type          LIKE type_t.chr1
   DEFINE p_sum           LIKE inpd_t.inpd030
   DEFINE l_inpd002       LIKE inpd_t.inpd002
   DEFINE l_inpd001       LIKE inpd_t.inpd001
   DEFINE l_inpd009       LIKE inpd_t.inpd009
   DEFINE l_cnt           LIKE type_t.num5
   DEFINE l_success       LIKE type_t.num5
   DEFINE l_inpdstus      LIKE inpd_t.inpdstus
   DEFINE l_inpd008       LIKE inpd_t.inpd008
   DEFINE l_inpa009       LIKE inpa_t.inpa009
   DEFINE l_inpa010       LIKE inpa_t.inpa009
   DEFINE l_inpa011       LIKE inpa_t.inpa009
   DEFINE l_inpa012       LIKE inpa_t.inpa009
   DEFINE g_inpd030       LIKE inpe_t.inpe030
   DEFINE g_inpd036       LIKE inpe_t.inpe035
   DEFINE g_inpd050       LIKE inpe_t.inpe050
   DEFINE g_inpd056       LIKE inpe_t.inpe055
   DEFINE l_sum           LIKE inpe_t.inpe030  
   DEFINE s_inpe_sum      LIKE inpe_t.inpe030
   #add--2015/07/02--By shiun--(S)
   DEFINE l_oofg_return    DYNAMIC ARRAY OF RECORD    
                   oofg019     LIKE oofg_t.oofg019,   #field
                   oofg020     LIKE oofg_t.oofg020    #value
                           END RECORD
   #add--2015/07/02--By shiun--(E)]]>
  </point>
  <point name="input.get_var" order="" ver="2" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   p_inpesite,
   p_inpedocno,
   p_inpeseq,
   p_type,
   p_sum]]>
  </point>
  <point name="input.more_input" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#      DISPLAY ARRAY g_inpe_d TO s_detail1_aint830_01.* ATTRIBUTES(COUNT=g_rec_b) 
#         
#         BEFORE ROW
#            LET l_ac = DIALOG.getCurrentRow("s_detail1_aint830_01")
#            LET g_detail_idx = l_ac
#          
#                  
#         BEFORE DISPLAY
#            CALL FGL_SET_ARR_CURR(g_detail_idx)
#            LET l_ac = DIALOG.getCurrentRow("s_detail1_aint830_01")
#            LET g_current_page = 1
##               CALL cl_set_comp_visible("inpe030,inpe031,inpe032,inpe033,inpe033_desc,inpe034,inpe035,inpe036,inpe037,inpe038,inpe038_desc,inpe039",FALSE)
##               CALL cl_set_comp_visible("inpe050,inpe051,inpe052,inpe053,inpe053_desc,inpe054,inpe055,inpe056,inpe057,inpe058,inpe058_desc,inpe059",FALSE)
##               IF g_type = '1' THEN   #初盤一
##                  CALL cl_set_comp_visible("inpe030,inpe033,inpe033_desc,inpe034",TRUE)
##               END IF
##               IF g_type = '2' THEN   #初盤二
##                  CALL cl_set_comp_visible("inpe035,inpe038,inpe038_desc,inpe039",TRUE)
##               END IF   
##               IF g_type = '3' THEN   #復盤一
##                  CALL cl_set_comp_visible("inpe050,inpe053,inpe053_desc,inpe054",TRUE)
##               END IF     
##               IF g_type = '4' THEN   #復盤二
##                  CALL cl_set_comp_visible("inpe055,inpe058,inpe058_desc,inpe059",TRUE)
##               END IF      
#      END DISPLAY    
      
      BEFORE DIALOG
 
         SELECT inpd001,inpd009,inpdstus INTO l_inpd001,l_inpd009,l_inpdstus FROM inpd_t
          WHERE inpdent = g_enterprise
            AND inpdsite = p_inpesite
            AND inpddocno = p_inpedocno
            AND inpdseq = p_inpeseq 
          
         IF p_type MATCHES '[12]' AND l_inpdstus <> 'N' AND l_inpd009 = 'Y' THEN
            CALL cl_set_act_visible("insert,delete", FALSE)
#         ELSE
#            CALL cl_set_act_visible("insert,delete", TRUE)           
         END IF
         IF p_type MATCHES '[34]' AND l_inpdstus = '6' AND l_inpd009 = 'Y' THEN 
            CALL cl_set_act_visible("insert,delete", FALSE)
#         ELSE
#            CALL cl_set_act_visible("insert,delete", TRUE)               
         END IF            
         IF l_inpd009 = 'N' THEN
            CALL cl_set_act_visible("insert,delete", FALSE)
         ELSE
            CALL cl_set_act_visible("insert,delete", TRUE)           
         END IF 

         IF p_type MATCHES '[12]' AND l_inpdstus <> 'N' THEN   
            CALL cl_set_comp_entry("inpe008,inpe009,inpe010,inpe011,inpe012,inpe030,inpe035,inpe050,inpe055,inpe033,inpe034,inpe038,inpe039,inpe053,inpe054,inpe058,inpe059",FALSE)
         END IF  
         IF p_type MATCHES '[34]' AND l_inpdstus = '6' THEN   
            CALL cl_set_comp_entry("inpe008,inpe009,inpe010,inpe011,inpe012,inpe030,inpe035,inpe050,inpe055,inpe033,inpe034,inpe038,inpe039,inpe053,inpe054,inpe058,inpe059",FALSE)
         END IF          ]]>
  </point>
  <point name="input.other" order="" ver="4" cite_std="N" new="N" status="u" src="s" readonly="" mark_hard="N">
    <![CDATA[#            CALL s_transaction_begin()
#            LET l_n = ARR_COUNT()
#            LET l_cmd = 'a'
#            INITIALIZE g_inpe_d_t.* TO NULL
#            INITIALIZE g_inpe_d_o.* TO NULL
#            INITIALIZE g_inpe_d[l_ac].* TO NULL 
#            #公用欄位給值(單身)
#            
#            
#            LET g_inpe_d_t.* = g_inpe_d[l_ac].*     #新輸入資料
#            LET g_inpe_d_o.* = g_inpe_d[l_ac].*     #新輸入資料
#            CALL cl_show_fld_cont()
#            CALL aint830_01_set_entry_b()
#            CALL aint830_01_set_no_required()
#            CALL aint830_01_set_required(p_inpesite,p_inpedocno,p_inpeseq)            
#            CALL aint830_01_set_no_entry_b(p_inpesite,p_inpedocno,p_inpeseq)
#            IF lb_reproduce THEN
#               LET lb_reproduce = FALSE
#               LET g_inpe_d[li_reproduce_target].* = g_inpe_d[li_reproduce].*
# 
#               LET g_inpe_d[g_inpe_d.getLength()].inpesite = NULL
#               LET g_inpe_d[g_inpe_d.getLength()].inpedocno = NULL
#               LET g_inpe_d[g_inpe_d.getLength()].inpeseq = NULL
#               LET g_inpe_d[g_inpe_d.getLength()].inpeseq2 = NULL
# 
#            END IF
#            
#            #add-point:modify段before insert
#            LET g_inpe_d[l_ac].inpesite = g_inpdsite
#            LET g_inpe_d[l_ac].inpedocno = g_inpddocno
#            LET g_inpe_d[l_ac].inpeseq = g_inpdseq
#            SELECT MAX(inpeseq2)+1 INTO g_inpe_d[l_ac].inpeseq2 FROM inpe_t
#             WHERE inpeent = g_enterprise
#               AND inpesite = g_inpe_d[l_ac].inpesite               
#               AND inpedocno = g_inpe_d[l_ac].inpedocno
#               AND inpeseq = g_inpe_d[l_ac].inpeseq
#            IF cl_null(g_inpe_d[l_ac].inpeseq2) THEN LET g_inpe_d[l_ac].inpeseq2 = 1 END IF   
#            
#            SELECT inpd001,inpd002,inpd003,inpd004,inpd005,inpd006,inpd007,inpd032,inpd033,inpd038,inpd039,inpd052,inpd053,inpd058,inpd059
#              INTO g_inpd001,g_inpd002,g_inpd003,g_inpd004,g_inpd005,g_inpd006,g_inpd007,g_inpe_d[l_ac].inpe031,g_inpe_d[l_ac].inpe032,g_inpe_d[l_ac].inpe036,g_inpe_d[l_ac].inpe037,
#                   g_inpe_d[l_ac].inpe051,g_inpe_d[l_ac].inpe052,g_inpe_d[l_ac].inpe056,g_inpe_d[l_ac].inpe057
#              FROM inpd_t
#              WHERE inpdent = g_enterprise
#                AND inpdsite = g_inpdsite
#                AND inpddocno = g_inpddocno
#                AND inpdseq = g_inpdseq
#                
#            LET g_inpe_d[l_ac].inpe010 = g_today
#            LET g_inpe_d[l_ac].inpe011 = g_inpe_d[l_ac].inpe010 + g_imaf032
            
         ON ROW CHANGE
            
            IF INT_FLAG THEN
               INITIALIZE g_errparam TO NULL
               LET g_errparam.code = 9001
               LET g_errparam.extend = ''
               LET g_errparam.popup = FALSE
               CALL cl_err()

               LET INT_FLAG = 0
               LET g_inpe_d[l_ac].* = g_inpe_d_t.*
               CLOSE aint830_01_bc2
               CALL s_transaction_end('N','0')
               EXIT DIALOG 
            END IF
              
            IF l_lock_sw = 'Y' THEN
               INITIALIZE g_errparam TO NULL
               LET g_errparam.code = -263
               LET g_errparam.extend = g_inpe_d[l_ac].inpesite
               LET g_errparam.popup = TRUE
               CALL cl_err()

               LET g_inpe_d[l_ac].* = g_inpe_d_t.*
            ELSE
               
               #寫入修改者/修改日期資訊(單身)
               
            
               #add-point:單身修改前
               #mark by lixh 20141024
#               IF g_inpe_d[l_ac].inpe008 IS NULL THEN
#                  LET g_inpe_d[l_ac].inpe008 = ' '
#               END IF
#               IF g_inpe_d[l_ac].inpe009 IS NULL THEN
#                  LET g_inpe_d[l_ac].inpe009 = ' '
#               END IF 
               #end add-point
               #add--2015/07/02 By shiun--(S)
               CALL s_aooi390_get_auto_no('7',g_inpe_d[l_ac].inpe008) RETURNING l_success,g_inpe_d[l_ac].inpe008
               IF NOT l_success THEN
                  CALL s_transaction_end('N','0')
                  NEXT FIELD CURRENT
               END IF
               DISPLAY BY NAME g_inpe_d[l_ac].inpe008
               CALL s_aooi390_oofi_upd('7',g_inpe_d[l_ac].inpe008) RETURNING l_success
               
               CALL s_aooi390_get_auto_no('8',g_inpe_d[l_ac].inpe009) RETURNING l_success,g_inpe_d[l_ac].inpe009
               IF NOT l_success THEN
                  CALL s_transaction_end('N','0')
                  NEXT FIELD CURRENT
               END IF  
               DISPLAY BY NAME g_inpe_d[l_ac].inpe009
               CALL s_aooi390_oofi_upd('8',g_inpe_d[l_ac].inpe009) RETURNING l_success
               #add--2015/07/02 By shiun--(E)
               
               UPDATE inpe_t SET (inpedocno,inpeseq,inpeseq2,inpesite,inpe008,inpe009,inpe012,inpe030, 
                   inpe035,inpe050,inpe055,inpe010,inpe011,inpe031,inpe032,inpe033,inpe034,inpe036,inpe037, 
                   inpe038,inpe039,inpe051,inpe052,inpe053,inpe054,inpe056,inpe057,inpe058,inpe059) = (g_inpe_d[l_ac].inpedocno, 
                   g_inpe_d[l_ac].inpeseq,g_inpe_d[l_ac].inpeseq2,g_inpe_d[l_ac].inpesite,g_inpe_d[l_ac].inpe008, 
                   g_inpe_d[l_ac].inpe009,g_inpe_d[l_ac].inpe012,g_inpe_d[l_ac].inpe030,g_inpe_d[l_ac].inpe035, 
                   g_inpe_d[l_ac].inpe050,g_inpe_d[l_ac].inpe055,g_inpe_d[l_ac].inpe010,g_inpe_d[l_ac].inpe011, 
                   g_inpe_d[l_ac].inpe031,g_inpe_d[l_ac].inpe032,g_inpe_d[l_ac].inpe033,g_inpe_d[l_ac].inpe034, 
                   g_inpe_d[l_ac].inpe036,g_inpe_d[l_ac].inpe037,g_inpe_d[l_ac].inpe038,g_inpe_d[l_ac].inpe039, 
                   g_inpe_d[l_ac].inpe051,g_inpe_d[l_ac].inpe052,g_inpe_d[l_ac].inpe053,g_inpe_d[l_ac].inpe054, 
                   g_inpe_d[l_ac].inpe056,g_inpe_d[l_ac].inpe057,g_inpe_d[l_ac].inpe058,g_inpe_d[l_ac].inpe059) 

                WHERE inpeent = g_enterprise AND
                  inpesite = g_inpe_d_t.inpesite #項次   
                  AND inpedocno = g_inpe_d_t.inpedocno  
                  AND inpeseq = g_inpe_d_t.inpeseq  
                  AND inpeseq2 = g_inpe_d_t.inpeseq2  
 
                  
               #add-point:單身修改中

               #end add-point
                  
               CASE
                  WHEN SQLCA.sqlerrd[3] = 0  #更新不到的處理
                     INITIALIZE g_errparam TO NULL
                     LET g_errparam.code = "std-00009"
                     LET g_errparam.extend = "inpe_t"
                     LET g_errparam.popup = TRUE
                     CALL cl_err()

                     CALL s_transaction_end('N','0')
                    WHEN SQLCA.sqlcode #其他錯誤
                     INITIALIZE g_errparam TO NULL
               LET g_errparam.code = SQLCA.sqlcode
               LET g_errparam.extend = "inpe_t"
               LET g_errparam.popup = TRUE
               CALL cl_err()
  
                     CALL s_transaction_end('N','0')
                  OTHERWISE
               INITIALIZE gs_keys TO NULL 
               LET gs_keys[1] = g_inpe_d[g_detail_idx].inpesite
               LET gs_keys_bak[1] = g_inpe_d_t.inpesite
               LET gs_keys[2] = g_inpe_d[g_detail_idx].inpedocno
               LET gs_keys_bak[2] = g_inpe_d_t.inpedocno
               LET gs_keys[3] = g_inpe_d[g_detail_idx].inpeseq
               LET gs_keys_bak[3] = g_inpe_d_t.inpeseq
               LET gs_keys[4] = g_inpe_d[g_detail_idx].inpeseq2
               LET gs_keys_bak[4] = g_inpe_d_t.inpeseq2
               CALL aint830_01_update_b('inpe_t',gs_keys,gs_keys_bak,"'1'")
                     #資料多語言用-增/改
                     
               END CASE
               
               #add-point:單身修改後

               #end add-point
 
            END IF            ]]>
  </point>
  <point name="input.pre_input" order="" ver="2" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   WHENEVER ERROR CALL cl_err_msg_log   
   CALL cl_set_act_visible("insert,delete", TRUE)  
   CALL cl_set_comp_visible("inpe030,inpe031,inpe032,inpe033,inpe033_desc,inpe034,inpe035,inpe036,inpe037,inpe038,inpe038_desc,inpe039",FALSE)
   CALL cl_set_comp_visible("inpe050,inpe051,inpe052,inpe053,inpe053_desc,inpe054,inpe055,inpe056,inpe057,inpe058,inpe058_desc,inpe059",FALSE)
   CALL cl_set_comp_entry("inpe008,inpe009,inpe010,inpe011,inpe012,inpe030,inpe035,inpe050,inpe055,inpe033,inpe034,inpe038,inpe039,inpe053,inpe054,inpe058,inpe059",TRUE)
   IF p_type = '1' THEN   #初盤一
      CALL cl_set_comp_visible("inpe030,inpe033,inpe033_desc,inpe034",TRUE)
      CALL cl_set_comp_required("inpe030",TRUE)
   END IF
   IF p_type = '2' THEN   #初盤二
      CALL cl_set_comp_visible("inpe035,inpe038,inpe038_desc,inpe039",TRUE)
      CALL cl_set_comp_required("inpe035",TRUE)
   END IF   
   IF p_type = '3' THEN   #復盤一
      CALL cl_set_comp_visible("inpe050,inpe053,inpe053_desc,inpe054",TRUE)
      CALL cl_set_comp_required("inpe050",TRUE)
   END IF     
   IF p_type = '4' THEN   #復盤二
      CALL cl_set_comp_visible("inpe055,inpe058,inpe058_desc,inpe059",TRUE)
      CALL cl_set_comp_required("inpe055",TRUE)
   END IF 
   
   SELECT inpd001,inpd002,inpd009,inpdstus,inpd008 INTO l_inpd001,l_inpd002,l_inpd009,l_inpdstus,l_inpd008 FROM inpd_t
    WHERE inpdent = g_enterprise
      AND inpdsite = p_inpesite
      AND inpddocno = p_inpedocno
      AND inpdseq = p_inpeseq
      
   SELECT inpa009,inpa010,inpa011,inpa012 INTO l_inpa009,l_inpa010,l_inpa011,l_inpa012 FROM inpa_t
    WHERE inpaent = g_enterprise
      AND inpasite = p_inpesite
      AND inpadocno = l_inpd008      
      
   IF p_type = '5' THEN   #初盘调整      
      CALL cl_set_comp_visible("inpe030,inpe031,inpe032,inpe033,inpe033_desc,inpe034,inpe035,inpe036,inpe037,inpe038,inpe038_desc,inpe039",TRUE)
      IF l_inpa010 = 'Y'  THEN   #初盤二
         CALL cl_set_comp_entry("inpe030,inpe033,inpe033_desc,inpe034",FALSE)
         CALL cl_set_comp_required("inpe035",TRUE)
      ELSE 
         CALL cl_set_comp_entry("inpe035,inpe038,inpe038_desc,inpe039",FALSE)   
         CALL cl_set_comp_required("inpe030",TRUE)         
      END IF      
   END IF
   
   IF p_type = '6' THEN   #复盘调整
      CALL cl_set_comp_visible("inpe050,inpe051,inpe052,inpe053,inpe053_desc,inpe054,inpe055,inpe056,inpe057,inpe058,inpe058_desc,inpe059",TRUE)
      IF l_inpa012 = 'Y'  THEN  #復盤二
         CALL cl_set_comp_entry("inpe050,inpe053,inpe053_desc,inpe054",TRUE)
         CALL cl_set_comp_required("inpe055",TRUE)
      ELSE
         CALL cl_set_comp_entry("inpe055,inpe058,inpe058_desc,inpe059",TRUE)
         CALL cl_set_comp_required("inpe050",TRUE)
      END IF       
   END IF   
   LET l_forupd_sql = "SELECT inpedocno,inpeseq,inpeseq2,inpesite,inpe008,inpe009,inpe012,inpe030,inpe035, 
       inpe050,inpe055,inpe010,inpe011,inpe031,inpe032,inpe033,inpe034,inpe036,inpe037,inpe038,inpe039, 
       inpe051,inpe052,inpe053,inpe054,inpe056,inpe057,inpe058,inpe059 FROM inpe_t WHERE inpeent=? AND inpesite = ? AND  
       inpedocno=? AND inpeseq=? AND inpeseq2=? FOR UPDATE"

   LET l_forupd_sql= cl_sql_forupd(l_forupd_sql)
   LET l_forupd_sql = cl_sql_add_mask(l_forupd_sql)              #遮蔽特定資料
   DECLARE aint830_01_bc2 CURSOR FROM l_forupd_sql  
   LET INT_FLAG = FALSE   
   LET g_errshow = 1  

   IF l_inpd002 IS NULL THEN
      LET l_inpd002 = ' '
   END IF      
   IF l_inpd009 = 'N' THEN
      LET l_allow_insert = FALSE
      LET l_allow_delete = FALSE
      LET l_allow_insert = FALSE
   END IF 
   IF p_type MATCHES '[12]' AND l_inpdstus <> 'N' THEN  #初盤
      LET l_allow_insert = FALSE
      LET l_allow_delete = FALSE      
   END IF   
   IF p_type MATCHES '[34]' AND l_inpdstus = '6' THEN  #復盤
      LET l_allow_insert = FALSE
      LET l_allow_delete = FALSE      
   END IF     
   IF p_type MATCHES '[12]' AND l_inpdstus <> 'N' THEN   
      CALL cl_set_comp_entry("inpe008,inpe009,inpe010,inpe011,inpe012,inpe030,inpe035,inpe050,inpe055,inpe033,inpe034,inpe038,inpe039,inpe053,inpe054,inpe058,inpe059",FALSE)
   END IF  
   IF p_type MATCHES '[34]' AND l_inpdstus = '6' THEN   
      CALL cl_set_comp_entry("inpe008,inpe009,inpe010,inpe011,inpe012,inpe030,inpe035,inpe050,inpe055,inpe033,inpe034,inpe038,inpe039,inpe053,inpe054,inpe058,inpe059",FALSE)
   END IF      
   IF l_inpd009 = 'N' THEN
      CALL cl_set_comp_entry("inpe008,inpe009,inpe010,inpe011,inpe012,inpeseq2",FALSE)
   END IF
   SELECT inpd030,inpd036,inpd050,inpd056 INTO g_inpd030,g_inpd036,g_inpd050,g_inpd056 FROM inpd_t
    WHERE inpdent = g_enterprise
      AND inpdsite = g_site
      AND inpddocno = p_inpedocno
      AND inpdseq = p_inpeseq
   IF (p_type = '5' AND l_inpdstus <> 'N') OR (p_type = '6' AND (l_inpdstus = '6' OR l_inpdstus ='S')) THEN
      CALL aint830_01_b_fill(p_inpesite,p_inpedocno,p_inpeseq)   
      DIALOG ATTRIBUTES(UNBUFFERED,FIELD ORDER FORM)
         DISPLAY ARRAY g_inpe_d TO s_detail1_aint830_01.* ATTRIBUTES(COUNT=g_rec_b) 
            
            BEFORE ROW
               LET l_ac = DIALOG.getCurrentRow("s_detail1_aint830_01")
               LET g_detail_idx = l_ac
             
                     
            BEFORE DISPLAY
               CALL FGL_SET_ARR_CURR(g_detail_idx)
               LET l_ac = DIALOG.getCurrentRow("s_detail1_aint830_01")
               LET g_current_page = 1
#                  CALL cl_set_comp_visible("inpe030,inpe031,inpe032,inpe033,inpe033_desc,inpe034,inpe035,inpe036,inpe037,inpe038,inpe038_desc,inpe039",FALSE)
#                  CALL cl_set_comp_visible("inpe050,inpe051,inpe052,inpe053,inpe053_desc,inpe054,inpe055,inpe056,inpe057,inpe058,inpe058_desc,inpe059",FALSE)
#                  IF p_type = '1' THEN   #初盤一
#                     CALL cl_set_comp_visible("inpe030,inpe033,inpe033_desc,inpe034",TRUE)
#                  END IF
#                  IF p_type = '2' THEN   #初盤二
#                     CALL cl_set_comp_visible("inpe035,inpe038,inpe038_desc,inpe039",TRUE)
#                  END IF   
#                  IF p_type = '3' THEN   #復盤一
#                     CALL cl_set_comp_visible("inpe050,inpe053,inpe053_desc,inpe054",TRUE)
#                  END IF     
#                  IF p_type = '4' THEN   #復盤二
#                     CALL cl_set_comp_visible("inpe055,inpe058,inpe058_desc,inpe059",TRUE)
#                  END IF      
         END DISPLAY    
         BEFORE DIALOG
         #公用action
         ON ACTION accept
            ACCEPT DIALOG
           
         ON ACTION cancel
            #add-point:cancel
      
            #end add-point
            LET INT_FLAG = TRUE 
            EXIT DIALOG
      
         ON ACTION close
            LET INT_FLAG = TRUE 
            EXIT DIALOG
      
         ON ACTION exit
            LET INT_FLAG = TRUE 
            EXIT DIALOG
      
         #交談指令共用ACTION
         &include "common_action.4gl" 
            CONTINUE DIALOG          
      END DIALOG
   ELSE   ]]>
  </point>
  <section id="aint830_01.description" ver="1" status="" src="s" readonly="">
    <![CDATA[#應用 a00 樣板自動產生(Version:1)
#+ Version..: T100-ERP-1.00.00(SD版次:4,PR版次:4) Build-000067
#+ 
#+ Filename...: aint830_01
#+ Description: 盤點單製造批序號維護作業
#+ Creator....: 01534(2014-07-06 22:15:18)
#+ Modifier...: 01534(2015-03-26 16:47:18) -SD/PR-
]]>
  </section>
  <section id="aint830_01.global" ver="5" status="" src="s" readonly="">
    <![CDATA[#應用 c02b 樣板自動產生(Version:5)
{<point name="global.memo" />}
 
IMPORT os
IMPORT FGL lib_cl_dlg
#add-point:增加匯入項目
{<point name="global.import" />}
#end add-point
 
SCHEMA ds
 
GLOBALS "../../cfg/top_global.inc"
 
#add-point:增加匯入變數檔
{<point name="global.inc" />}
#end add-point
 
#單身 type 宣告
PRIVATE TYPE type_g_inpe_d        RECORD
       inpedocno LIKE inpe_t.inpedocno, 
   inpeseq LIKE inpe_t.inpeseq, 
   inpeseq2 LIKE inpe_t.inpeseq2, 
   inpesite LIKE inpe_t.inpesite, 
   inpe008 LIKE inpe_t.inpe008, 
   inpe009 LIKE inpe_t.inpe009, 
   inpe012 LIKE inpe_t.inpe012, 
   inpe030 LIKE inpe_t.inpe030, 
   inpe035 LIKE inpe_t.inpe035, 
   inpe050 LIKE inpe_t.inpe050, 
   inpe055 LIKE inpe_t.inpe055, 
   inpe010 LIKE inpe_t.inpe010, 
   inpe011 LIKE inpe_t.inpe011, 
   inpe031 LIKE inpe_t.inpe031, 
   inpe031_desc LIKE type_t.chr500, 
   inpe032 LIKE inpe_t.inpe032, 
   inpe033 LIKE inpe_t.inpe033, 
   inpe033_desc LIKE type_t.chr500, 
   inpe034 LIKE inpe_t.inpe034, 
   inpe036 LIKE inpe_t.inpe036, 
   inpe036_desc LIKE type_t.chr500, 
   inpe037 LIKE inpe_t.inpe037, 
   inpe038 LIKE inpe_t.inpe038, 
   inpe038_desc LIKE type_t.chr500, 
   inpe039 LIKE inpe_t.inpe039, 
   inpe051 LIKE inpe_t.inpe051, 
   inpe051_desc LIKE type_t.chr500, 
   inpe052 LIKE inpe_t.inpe052, 
   inpe053 LIKE inpe_t.inpe053, 
   inpe053_desc LIKE type_t.chr500, 
   inpe054 LIKE inpe_t.inpe054, 
   inpe056 LIKE inpe_t.inpe056, 
   inpe056_desc LIKE type_t.chr500, 
   inpe057 LIKE inpe_t.inpe057, 
   inpe058 LIKE inpe_t.inpe058, 
   inpe058_desc LIKE type_t.chr500, 
   inpe059 LIKE inpe_t.inpe059
       END RECORD
 
 
DEFINE g_inpe_d          DYNAMIC ARRAY OF type_g_inpe_d
DEFINE g_inpe_d_t        type_g_inpe_d
 
 
DEFINE g_inpesite_t   LIKE inpe_t.inpesite    #Key值備份
DEFINE g_inpedocno_t      LIKE inpe_t.inpedocno    #Key值備份
DEFINE g_inpeseq_t      LIKE inpe_t.inpeseq    #Key值備份
DEFINE g_inpeseq2_t      LIKE inpe_t.inpeseq2    #Key值備份
 
 
DEFINE l_ac                  LIKE type_t.num10
DEFINE g_ref_fields          DYNAMIC ARRAY OF VARCHAR(500) #ap_ref用陣列
DEFINE g_rtn_fields          DYNAMIC ARRAY OF VARCHAR(500) #ap_ref用陣列
DEFINE g_ref_vars            DYNAMIC ARRAY OF VARCHAR(500) #ap_ref用陣列
DEFINE g_rec_b               LIKE type_t.num10 
DEFINE g_detail_idx          LIKE type_t.num10
 
 
#add-point:自定義模組變數(Module Variable)
{<point name="global.variable" edit="s"/>}
#end add-point
    
#add-point:自定義客戶專用模組變數(Module Variable)
{<point name="global.variable_customerization" edit="c"/>}
#end add-point
    
#add-point:傳入參數說明(global.argv)
{<point name="global.argv"/>}
#end add-point    
]]>
  </section>
  <section id="aint830_01.input" ver="9" status="" src="s" readonly="">
    <![CDATA[#+ 資料輸入
PUBLIC FUNCTION aint830_01(--)
   #add-point:input段變數傳入
   {<point name="input.get_var"/>}
   #end add-point
   )
   DEFINE l_ac_t          LIKE type_t.num10       #未取消的ARRAY CNT 
   DEFINE l_allow_insert  LIKE type_t.num5        #可新增否 
   DEFINE l_allow_delete  LIKE type_t.num5        #可刪除否  
   DEFINE l_count         LIKE type_t.num10
   DEFINE l_insert        LIKE type_t.num5
   DEFINE l_cmd           LIKE type_t.chr5
   #add-point:input段define
   {<point name="input.define" edit="s"/>}
   #end add-point
   #add-point:input段define
   {<point name="input.define_customerization" edit="c"/>}
   #end add-point
 
   #畫面開啟 (identifier)
   OPEN WINDOW w_aint830_01 WITH FORM cl_ap_formpath("ain","aint830_01")
 
   #瀏覽頁簽資料初始化
   CALL cl_ui_init()
   
   LET g_qryparam.state = "i"
   
   LET l_allow_insert = cl_auth_detail_input("insert")
   LET l_allow_delete = cl_auth_detail_input("delete")
   
   #輸入前處理
   #add-point:單身前置處理
   {<point name="input.pre_input"/>}
   #end add-point
  
   DIALOG ATTRIBUTES(UNBUFFERED,FIELD ORDER FORM)
   
      #輸入開始
      INPUT ARRAY g_inpe_d FROM s_detail1_aint830_01.*
          ATTRIBUTE(COUNT = g_rec_b,MAXCOUNT = g_max_rec,WITHOUT DEFAULTS, 
                  INSERT ROW = l_allow_insert,
                  DELETE ROW = l_allow_delete,
                  APPEND ROW = l_allow_insert)
         
         #自訂ACTION
         #add-point:單身前置處理
         {<point name="input.action"/>}
         #end add-point
         
         #自訂ACTION(detail_input)
         
         
         BEFORE INPUT
            #add-point:單身輸入前處理
            {<point name="input.before_input"/>}
            #end add-point
          
                  #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD inpedocno
            #add-point:BEFORE FIELD inpedocno
            {<point name="input.b.page1_aint830_01.inpedocno" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD inpedocno
            
            #add-point:AFTER FIELD inpedocno
            {<point name="input.a.page1_aint830_01.inpedocno" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE inpedocno
            #add-point:ON CHANGE inpedocno
            {<point name="input.g.page1_aint830_01.inpedocno" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD inpeseq
            #add-point:BEFORE FIELD inpeseq
            {<point name="input.b.page1_aint830_01.inpeseq" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD inpeseq
            
            #add-point:AFTER FIELD inpeseq
            {<point name="input.a.page1_aint830_01.inpeseq" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE inpeseq
            #add-point:ON CHANGE inpeseq
            {<point name="input.g.page1_aint830_01.inpeseq" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD inpeseq2
            #add-point:BEFORE FIELD inpeseq2
            {<point name="input.b.page1_aint830_01.inpeseq2" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD inpeseq2
            
            #add-point:AFTER FIELD inpeseq2
            {<point name="input.a.page1_aint830_01.inpeseq2" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE inpeseq2
            #add-point:ON CHANGE inpeseq2
            {<point name="input.g.page1_aint830_01.inpeseq2" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD inpesite
            #add-point:BEFORE FIELD inpesite
            {<point name="input.b.page1_aint830_01.inpesite" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD inpesite
            
            #add-point:AFTER FIELD inpesite
            {<point name="input.a.page1_aint830_01.inpesite" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE inpesite
            #add-point:ON CHANGE inpesite
            {<point name="input.g.page1_aint830_01.inpesite" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD inpe008
            #add-point:BEFORE FIELD inpe008
            {<point name="input.b.page1_aint830_01.inpe008" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD inpe008
            
            #add-point:AFTER FIELD inpe008
            {<point name="input.a.page1_aint830_01.inpe008" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE inpe008
            #add-point:ON CHANGE inpe008
            {<point name="input.g.page1_aint830_01.inpe008" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD inpe009
            #add-point:BEFORE FIELD inpe009
            {<point name="input.b.page1_aint830_01.inpe009" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD inpe009
            
            #add-point:AFTER FIELD inpe009
            {<point name="input.a.page1_aint830_01.inpe009" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE inpe009
            #add-point:ON CHANGE inpe009
            {<point name="input.g.page1_aint830_01.inpe009" />}
            #END add-point 
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD inpe012
            #應用 a15 樣板自動產生(Version:2)
            #確認欄位值在特定區間內
            IF NOT cl_ap_chk_range(g_inpe_d[l_ac].inpe012,"0.000","0","","","azz-00079",1) THEN
               NEXT FIELD inpe012
            END IF 
 
 
            #add-point:AFTER FIELD inpe012
            {<point name="input.a.page1_aint830_01.inpe012" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD inpe012
            #add-point:BEFORE FIELD inpe012
            {<point name="input.b.page1_aint830_01.inpe012" />}
            #END add-point
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE inpe012
            #add-point:ON CHANGE inpe012
            {<point name="input.g.page1_aint830_01.inpe012" />}
            #END add-point 
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD inpe030
            #應用 a15 樣板自動產生(Version:2)
            #確認欄位值在特定區間內
            IF NOT cl_ap_chk_range(g_inpe_d[l_ac].inpe030,"0","1","","","azz-00079",1) THEN
               NEXT FIELD inpe030
            END IF 
 
 
            #add-point:AFTER FIELD inpe030
            {<point name="input.a.page1_aint830_01.inpe030" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD inpe030
            #add-point:BEFORE FIELD inpe030
            {<point name="input.b.page1_aint830_01.inpe030" />}
            #END add-point
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE inpe030
            #add-point:ON CHANGE inpe030
            {<point name="input.g.page1_aint830_01.inpe030" />}
            #END add-point 
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD inpe035
            #應用 a15 樣板自動產生(Version:2)
            #確認欄位值在特定區間內
            IF NOT cl_ap_chk_range(g_inpe_d[l_ac].inpe035,"0","1","","","azz-00079",1) THEN
               NEXT FIELD inpe035
            END IF 
 
 
            #add-point:AFTER FIELD inpe035
            {<point name="input.a.page1_aint830_01.inpe035" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD inpe035
            #add-point:BEFORE FIELD inpe035
            {<point name="input.b.page1_aint830_01.inpe035" />}
            #END add-point
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE inpe035
            #add-point:ON CHANGE inpe035
            {<point name="input.g.page1_aint830_01.inpe035" />}
            #END add-point 
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD inpe050
            #應用 a15 樣板自動產生(Version:2)
            #確認欄位值在特定區間內
            IF NOT cl_ap_chk_range(g_inpe_d[l_ac].inpe050,"0","1","","","azz-00079",1) THEN
               NEXT FIELD inpe050
            END IF 
 
 
            #add-point:AFTER FIELD inpe050
            {<point name="input.a.page1_aint830_01.inpe050" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD inpe050
            #add-point:BEFORE FIELD inpe050
            {<point name="input.b.page1_aint830_01.inpe050" />}
            #END add-point
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE inpe050
            #add-point:ON CHANGE inpe050
            {<point name="input.g.page1_aint830_01.inpe050" />}
            #END add-point 
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD inpe055
            #應用 a15 樣板自動產生(Version:2)
            #確認欄位值在特定區間內
            IF NOT cl_ap_chk_range(g_inpe_d[l_ac].inpe055,"0","1","","","azz-00079",1) THEN
               NEXT FIELD inpe055
            END IF 
 
 
            #add-point:AFTER FIELD inpe055
            {<point name="input.a.page1_aint830_01.inpe055" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD inpe055
            #add-point:BEFORE FIELD inpe055
            {<point name="input.b.page1_aint830_01.inpe055" />}
            #END add-point
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE inpe055
            #add-point:ON CHANGE inpe055
            {<point name="input.g.page1_aint830_01.inpe055" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD inpe010
            #add-point:BEFORE FIELD inpe010
            {<point name="input.b.page1_aint830_01.inpe010" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD inpe010
            
            #add-point:AFTER FIELD inpe010
            {<point name="input.a.page1_aint830_01.inpe010" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE inpe010
            #add-point:ON CHANGE inpe010
            {<point name="input.g.page1_aint830_01.inpe010" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD inpe011
            #add-point:BEFORE FIELD inpe011
            {<point name="input.b.page1_aint830_01.inpe011" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD inpe011
            
            #add-point:AFTER FIELD inpe011
            {<point name="input.a.page1_aint830_01.inpe011" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE inpe011
            #add-point:ON CHANGE inpe011
            {<point name="input.g.page1_aint830_01.inpe011" />}
            #END add-point 
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD inpe031
            
            #add-point:AFTER FIELD inpe031
            {<point name="input.a.page1_aint830_01.inpe031" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD inpe031
            #add-point:BEFORE FIELD inpe031
            {<point name="input.b.page1_aint830_01.inpe031" />}
            #END add-point
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE inpe031
            #add-point:ON CHANGE inpe031
            {<point name="input.g.page1_aint830_01.inpe031" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD inpe032
            #add-point:BEFORE FIELD inpe032
            {<point name="input.b.page1_aint830_01.inpe032" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD inpe032
            
            #add-point:AFTER FIELD inpe032
            {<point name="input.a.page1_aint830_01.inpe032" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE inpe032
            #add-point:ON CHANGE inpe032
            {<point name="input.g.page1_aint830_01.inpe032" />}
            #END add-point 
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD inpe033
            
            #add-point:AFTER FIELD inpe033
            {<point name="input.a.page1_aint830_01.inpe033" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD inpe033
            #add-point:BEFORE FIELD inpe033
            {<point name="input.b.page1_aint830_01.inpe033" />}
            #END add-point
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE inpe033
            #add-point:ON CHANGE inpe033
            {<point name="input.g.page1_aint830_01.inpe033" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD inpe034
            #add-point:BEFORE FIELD inpe034
            {<point name="input.b.page1_aint830_01.inpe034" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD inpe034
            
            #add-point:AFTER FIELD inpe034
            {<point name="input.a.page1_aint830_01.inpe034" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE inpe034
            #add-point:ON CHANGE inpe034
            {<point name="input.g.page1_aint830_01.inpe034" />}
            #END add-point 
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD inpe036
            
            #add-point:AFTER FIELD inpe036
            {<point name="input.a.page1_aint830_01.inpe036" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD inpe036
            #add-point:BEFORE FIELD inpe036
            {<point name="input.b.page1_aint830_01.inpe036" />}
            #END add-point
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE inpe036
            #add-point:ON CHANGE inpe036
            {<point name="input.g.page1_aint830_01.inpe036" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD inpe037
            #add-point:BEFORE FIELD inpe037
            {<point name="input.b.page1_aint830_01.inpe037" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD inpe037
            
            #add-point:AFTER FIELD inpe037
            {<point name="input.a.page1_aint830_01.inpe037" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE inpe037
            #add-point:ON CHANGE inpe037
            {<point name="input.g.page1_aint830_01.inpe037" />}
            #END add-point 
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD inpe038
            
            #add-point:AFTER FIELD inpe038
            {<point name="input.a.page1_aint830_01.inpe038" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD inpe038
            #add-point:BEFORE FIELD inpe038
            {<point name="input.b.page1_aint830_01.inpe038" />}
            #END add-point
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE inpe038
            #add-point:ON CHANGE inpe038
            {<point name="input.g.page1_aint830_01.inpe038" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD inpe039
            #add-point:BEFORE FIELD inpe039
            {<point name="input.b.page1_aint830_01.inpe039" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD inpe039
            
            #add-point:AFTER FIELD inpe039
            {<point name="input.a.page1_aint830_01.inpe039" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE inpe039
            #add-point:ON CHANGE inpe039
            {<point name="input.g.page1_aint830_01.inpe039" />}
            #END add-point 
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD inpe051
            
            #add-point:AFTER FIELD inpe051
            {<point name="input.a.page1_aint830_01.inpe051" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD inpe051
            #add-point:BEFORE FIELD inpe051
            {<point name="input.b.page1_aint830_01.inpe051" />}
            #END add-point
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE inpe051
            #add-point:ON CHANGE inpe051
            {<point name="input.g.page1_aint830_01.inpe051" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD inpe052
            #add-point:BEFORE FIELD inpe052
            {<point name="input.b.page1_aint830_01.inpe052" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD inpe052
            
            #add-point:AFTER FIELD inpe052
            {<point name="input.a.page1_aint830_01.inpe052" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE inpe052
            #add-point:ON CHANGE inpe052
            {<point name="input.g.page1_aint830_01.inpe052" />}
            #END add-point 
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD inpe053
            
            #add-point:AFTER FIELD inpe053
            {<point name="input.a.page1_aint830_01.inpe053" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD inpe053
            #add-point:BEFORE FIELD inpe053
            {<point name="input.b.page1_aint830_01.inpe053" />}
            #END add-point
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE inpe053
            #add-point:ON CHANGE inpe053
            {<point name="input.g.page1_aint830_01.inpe053" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD inpe054
            #add-point:BEFORE FIELD inpe054
            {<point name="input.b.page1_aint830_01.inpe054" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD inpe054
            
            #add-point:AFTER FIELD inpe054
            {<point name="input.a.page1_aint830_01.inpe054" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE inpe054
            #add-point:ON CHANGE inpe054
            {<point name="input.g.page1_aint830_01.inpe054" />}
            #END add-point 
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD inpe056
            
            #add-point:AFTER FIELD inpe056
            {<point name="input.a.page1_aint830_01.inpe056" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD inpe056
            #add-point:BEFORE FIELD inpe056
            {<point name="input.b.page1_aint830_01.inpe056" />}
            #END add-point
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE inpe056
            #add-point:ON CHANGE inpe056
            {<point name="input.g.page1_aint830_01.inpe056" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD inpe057
            #add-point:BEFORE FIELD inpe057
            {<point name="input.b.page1_aint830_01.inpe057" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD inpe057
            
            #add-point:AFTER FIELD inpe057
            {<point name="input.a.page1_aint830_01.inpe057" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE inpe057
            #add-point:ON CHANGE inpe057
            {<point name="input.g.page1_aint830_01.inpe057" />}
            #END add-point 
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD inpe058
            
            #add-point:AFTER FIELD inpe058
            {<point name="input.a.page1_aint830_01.inpe058" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD inpe058
            #add-point:BEFORE FIELD inpe058
            {<point name="input.b.page1_aint830_01.inpe058" />}
            #END add-point
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE inpe058
            #add-point:ON CHANGE inpe058
            {<point name="input.g.page1_aint830_01.inpe058" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD inpe059
            #add-point:BEFORE FIELD inpe059
            {<point name="input.b.page1_aint830_01.inpe059" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD inpe059
            
            #add-point:AFTER FIELD inpe059
            {<point name="input.a.page1_aint830_01.inpe059" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE inpe059
            #add-point:ON CHANGE inpe059
            {<point name="input.g.page1_aint830_01.inpe059" />}
            #END add-point 
 
 
                  #Ctrlp:input.c.page1_aint830_01.inpedocno
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD inpedocno
            #add-point:ON ACTION controlp INFIELD inpedocno
            {<point name="input.c.page1_aint830_01.inpedocno" />}
            #END add-point
 
         #Ctrlp:input.c.page1_aint830_01.inpeseq
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD inpeseq
            #add-point:ON ACTION controlp INFIELD inpeseq
            {<point name="input.c.page1_aint830_01.inpeseq" />}
            #END add-point
 
         #Ctrlp:input.c.page1_aint830_01.inpeseq2
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD inpeseq2
            #add-point:ON ACTION controlp INFIELD inpeseq2
            {<point name="input.c.page1_aint830_01.inpeseq2" />}
            #END add-point
 
         #Ctrlp:input.c.page1_aint830_01.inpesite
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD inpesite
            #add-point:ON ACTION controlp INFIELD inpesite
            {<point name="input.c.page1_aint830_01.inpesite" />}
            #END add-point
 
         #Ctrlp:input.c.page1_aint830_01.inpe008
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD inpe008
            #add-point:ON ACTION controlp INFIELD inpe008
            {<point name="input.c.page1_aint830_01.inpe008" />}
            #END add-point
 
         #Ctrlp:input.c.page1_aint830_01.inpe009
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD inpe009
            #add-point:ON ACTION controlp INFIELD inpe009
            {<point name="input.c.page1_aint830_01.inpe009" />}
            #END add-point
 
         #Ctrlp:input.c.page1_aint830_01.inpe012
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD inpe012
            #add-point:ON ACTION controlp INFIELD inpe012
            {<point name="input.c.page1_aint830_01.inpe012" />}
            #END add-point
 
         #Ctrlp:input.c.page1_aint830_01.inpe030
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD inpe030
            #add-point:ON ACTION controlp INFIELD inpe030
            {<point name="input.c.page1_aint830_01.inpe030" />}
            #END add-point
 
         #Ctrlp:input.c.page1_aint830_01.inpe035
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD inpe035
            #add-point:ON ACTION controlp INFIELD inpe035
            {<point name="input.c.page1_aint830_01.inpe035" />}
            #END add-point
 
         #Ctrlp:input.c.page1_aint830_01.inpe050
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD inpe050
            #add-point:ON ACTION controlp INFIELD inpe050
            {<point name="input.c.page1_aint830_01.inpe050" />}
            #END add-point
 
         #Ctrlp:input.c.page1_aint830_01.inpe055
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD inpe055
            #add-point:ON ACTION controlp INFIELD inpe055
            {<point name="input.c.page1_aint830_01.inpe055" />}
            #END add-point
 
         #Ctrlp:input.c.page1_aint830_01.inpe010
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD inpe010
            #add-point:ON ACTION controlp INFIELD inpe010
            {<point name="input.c.page1_aint830_01.inpe010" />}
            #END add-point
 
         #Ctrlp:input.c.page1_aint830_01.inpe011
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD inpe011
            #add-point:ON ACTION controlp INFIELD inpe011
            {<point name="input.c.page1_aint830_01.inpe011" />}
            #END add-point
 
         #Ctrlp:input.c.page1_aint830_01.inpe031
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD inpe031
            #add-point:ON ACTION controlp INFIELD inpe031
            {<point name="input.c.page1_aint830_01.inpe031" />}
            #END add-point
 
         #Ctrlp:input.c.page1_aint830_01.inpe032
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD inpe032
            #add-point:ON ACTION controlp INFIELD inpe032
            {<point name="input.c.page1_aint830_01.inpe032" />}
            #END add-point
 
         #Ctrlp:input.c.page1_aint830_01.inpe033
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD inpe033
            #add-point:ON ACTION controlp INFIELD inpe033
            {<point name="input.c.page1_aint830_01.inpe033" />}
            #END add-point
 
         #Ctrlp:input.c.page1_aint830_01.inpe034
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD inpe034
            #add-point:ON ACTION controlp INFIELD inpe034
            {<point name="input.c.page1_aint830_01.inpe034" />}
            #END add-point
 
         #Ctrlp:input.c.page1_aint830_01.inpe036
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD inpe036
            #add-point:ON ACTION controlp INFIELD inpe036
            {<point name="input.c.page1_aint830_01.inpe036" />}
            #END add-point
 
         #Ctrlp:input.c.page1_aint830_01.inpe037
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD inpe037
            #add-point:ON ACTION controlp INFIELD inpe037
            {<point name="input.c.page1_aint830_01.inpe037" />}
            #END add-point
 
         #Ctrlp:input.c.page1_aint830_01.inpe038
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD inpe038
            #add-point:ON ACTION controlp INFIELD inpe038
            {<point name="input.c.page1_aint830_01.inpe038" />}
            #END add-point
 
         #Ctrlp:input.c.page1_aint830_01.inpe039
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD inpe039
            #add-point:ON ACTION controlp INFIELD inpe039
            {<point name="input.c.page1_aint830_01.inpe039" />}
            #END add-point
 
         #Ctrlp:input.c.page1_aint830_01.inpe051
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD inpe051
            #add-point:ON ACTION controlp INFIELD inpe051
            {<point name="input.c.page1_aint830_01.inpe051" />}
            #END add-point
 
         #Ctrlp:input.c.page1_aint830_01.inpe052
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD inpe052
            #add-point:ON ACTION controlp INFIELD inpe052
            {<point name="input.c.page1_aint830_01.inpe052" />}
            #END add-point
 
         #Ctrlp:input.c.page1_aint830_01.inpe053
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD inpe053
            #add-point:ON ACTION controlp INFIELD inpe053
            {<point name="input.c.page1_aint830_01.inpe053" />}
            #END add-point
 
         #Ctrlp:input.c.page1_aint830_01.inpe054
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD inpe054
            #add-point:ON ACTION controlp INFIELD inpe054
            {<point name="input.c.page1_aint830_01.inpe054" />}
            #END add-point
 
         #Ctrlp:input.c.page1_aint830_01.inpe056
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD inpe056
            #add-point:ON ACTION controlp INFIELD inpe056
            {<point name="input.c.page1_aint830_01.inpe056" />}
            #END add-point
 
         #Ctrlp:input.c.page1_aint830_01.inpe057
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD inpe057
            #add-point:ON ACTION controlp INFIELD inpe057
            {<point name="input.c.page1_aint830_01.inpe057" />}
            #END add-point
 
         #Ctrlp:input.c.page1_aint830_01.inpe058
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD inpe058
            #add-point:ON ACTION controlp INFIELD inpe058
            {<point name="input.c.page1_aint830_01.inpe058" />}
            #END add-point
 
         #Ctrlp:input.c.page1_aint830_01.inpe059
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD inpe059
            #add-point:ON ACTION controlp INFIELD inpe059
            {<point name="input.c.page1_aint830_01.inpe059" />}
            #END add-point
 
 
 
         #自訂ACTION
         #add-point:單身其他段落處理(EX:on row change, etc...)
         {<point name="input.other"/>}
         #end add-point
 
         AFTER INPUT
            #add-point:單身輸入後處理
            {<point name="input.after_input"/>}
            #end add-point
            
      END INPUT
      
 
      
      #add-point:自定義input
      {<point name="input.more_input"/>}
      #end add-point
    
      #公用action
      ON ACTION accept
         ACCEPT DIALOG
        
      ON ACTION cancel
         #add-point:cancel
         {<point name="input.cancel"/>}
         #end add-point
         LET INT_FLAG = TRUE 
         EXIT DIALOG
 
      ON ACTION close
         LET INT_FLAG = TRUE 
         EXIT DIALOG
 
      ON ACTION exit
         LET INT_FLAG = TRUE 
         EXIT DIALOG
   
      #交談指令共用ACTION
      &include "common_action.4gl" 
         CONTINUE DIALOG 
   END DIALOG
 
   #add-point:畫面關閉前
   {<point name="input.before_close"/>}
   #end add-point
   
   #畫面關閉
   CLOSE WINDOW w_aint830_01 
   
   #add-point:input段after input 
   {<point name="input.post_input"/>}
   #end add-point    
   
END FUNCTION
]]>
  </section>
  <section id="aint830_01.other_dialog" ver="1" status="" src="s" readonly="">
    <![CDATA[{<point name="other.dialog"/>}
]]>
  </section>
  <section id="aint830_01.other_function" ver="1" status="" src="s" readonly="">
    <![CDATA[{<point name="other.function"/>}
]]>
  </section>
</add_points>
