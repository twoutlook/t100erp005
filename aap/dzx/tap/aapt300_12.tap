<add_points prog="aapt300_12" std_prog="aapt300_12" erpver="1.0" module="AAP" ver="1" env="s" zone="t10dev" booking="Y">
  <point name="function.aapt300_12_move_to_g_apcb" cite_std="N" status="u" ver="1" src="s" new="Y" order="1" mark_hard="N">
<![CDATA[################################################################################
# Descriptions...: 把傳入的ARRAY值分配到g_apcb_m中
# Memo...........:
# Usage..........: CALL aapt300_12_move_to_g_apcb()
# Input parameter: 
# Return code....: 
# Date & Author..: 14/03/17 By albireo
# Modify.........:
################################################################################
PUBLIC FUNCTION aapt300_12_move_to_g_apcb()
   LET g_apcb_m.apcbdocno = g_array[1].chr 
   LET g_apcb_m.apcbld    = g_array[2].chr
   LET g_apcb_m.apcb004   = g_array[3].chr  
   LET g_apcb_m.apcb005   = g_array[4].chr  
   LET g_apcb_m.apcb002   = g_array[5].chr  
   LET g_apcb_m.apcb003   = g_array[6].chr  
   LET g_apcb_m.apcb008   = g_array[7].chr  
   LET g_apcb_m.apcb009   = g_array[8].chr  
   LET g_apcb_m.apcb023   = g_array[9].chr  
   LET g_apcb_m.apcb010   = g_array[10].chr
   LET g_apcb_m.apcb011   = g_array[11].chr
   LET g_apcb_m.apcblegl  = g_array[12].chr
   LET g_apcb_m.apcb012   = g_array[13].chr
   LET g_apcb_m.apcb014   = g_array[14].chr
   LET g_apcb_m.apcb028   = g_array[15].chr
   LET g_apcb_m.apcb021   = g_array[16].chr
   LET g_apcb_m.apcb015   = g_array[17].chr
   LET g_apcb_m.apcb016   = g_array[18].chr
   LET g_apcb_m.apcb017   = g_array[19].chr
   LET g_apcb_m.apcb024   = g_array[20].chr
   
   CALL s_ld_sel_glaa(g_apcb_m.apcbld,'glaa004') RETURNING  g_success,g_glaa004
   SELECT apcadocdt INTO g_apcadocdt
     FROM apca_t
    WHERE apcaent = g_enterprise AND apcald = g_apcb_m.apcbld
      AND apcadocno = g_apcb_m.apcbdocno
   LET g_apcb_m.apcblegl_desc= s_desc_get_department_desc(g_apcb_m.apcblegl)    #核算組織
   LET g_apcb_m.apcb010_desc = s_desc_get_department_desc(g_apcb_m.apcb010)      #業務部門
   LET g_apcb_m.apcb011_desc = s_desc_get_department_desc(g_apcb_m.apcb011)      #責任中心
   LET g_apcb_m.apcb012_desc = s_desc_get_rtaxl003_desc(g_apcb_m.apcb012)        #產品類別
   LET g_apcb_m.apcb014_desc = s_desc_get_acc_desc('3212',g_apcb_m.apcb014)      #理由碼
   LET g_apcb_m.apcb015_desc = s_desc_get_project_desc(g_apcb_m.apcb015)         #專案代碼
   LET g_apcb_m.apcb017_desc = s_desc_get_budget_desc(g_apcb_m.apcb017)          #預算項目
   LET g_apcb_m.apcb021_desc = s_desc_get_account_desc(g_apcb_m.apcbld,g_apcb_m.apcb021)   #會計科目 
   LET g_apcb_m.apcb024_desc = s_desc_get_acc_desc('2082',g_apcb_m.apcb024)      #區域
   LET g_apcb_m_t.* = g_apcb_m.*
   DISPLAY BY NAME g_apcb_m.apcblegl_desc,g_apcb_m.apcb010_desc,g_apcb_m.apcb011_desc,g_apcb_m.apcb012_desc,
                   g_apcb_m.apcb014_desc, g_apcb_m.apcb015_desc,g_apcb_m.apcb017_desc,g_apcb_m.apcb021_desc,
                   g_apcb_m.apcb024_desc

END FUNCTION]]>
</point>
  <point name="function.aapt300_12_move_to_array" cite_std="N" status="" ver="1" src="s" new="Y" order="2" mark_hard="N">
<![CDATA[################################################################################
# Descriptions...: 把g_apca_m的東西移到要傳出的array中
# Memo...........:
# Usage..........: CALL aapt300_12_move_to_array()
# Input parameter: 
# Return code....: 
# Date & Author..: 14/03/17 By albireo
# Modify.........:
################################################################################
PUBLIC FUNCTION aapt300_12_move_to_array()
   LET g_array[1].chr  = g_apcb_m.apcbdocno 
   LET g_array[2].chr  = g_apcb_m.apcbld    
   LET g_array[3].chr  = g_apcb_m.apcb004    
   LET g_array[4].chr  = g_apcb_m.apcb005    
   LET g_array[5].chr  = g_apcb_m.apcb002    
   LET g_array[6].chr  = g_apcb_m.apcb003    
   LET g_array[7].chr  = g_apcb_m.apcb008    
   LET g_array[8].chr  = g_apcb_m.apcb009    
   LET g_array[9].chr  = g_apcb_m.apcb023    
   LET g_array[10].chr = g_apcb_m.apcb010   
   LET g_array[11].chr = g_apcb_m.apcb011   
   LET g_array[12].chr = g_apcb_m.apcblegl  
   LET g_array[13].chr = g_apcb_m.apcb012   
   LET g_array[14].chr = g_apcb_m.apcb014   
   LET g_array[15].chr = g_apcb_m.apcb028   
   LET g_array[16].chr = g_apcb_m.apcb021   
   LET g_array[17].chr = g_apcb_m.apcb015   
   LET g_array[18].chr = g_apcb_m.apcb016   
   LET g_array[19].chr = g_apcb_m.apcb017   
   LET g_array[20].chr = g_apcb_m.apcb024   
END FUNCTION]]>
</point>
  <point name="global.variable" cite_std="N" status="" ver="1" src="s" new="N" order="" mark_hard="N">
<![CDATA[DEFINE g_array         DYNAMIC ARRAY OF RECORD
                 chr      LIKE type_t.chr500,
                 dat      LIKE type_t.dat
                          END RECORD
DEFINE g_apcb_m_t      type_g_apcb_m
DEFINE g_glaa004       LIKE glaa_t.glaa004      #科目參照表
DEFINE g_apcadocdt     LIKE apca_t.apcadocdt    #立帳日期]]>
</point>
  <point name="input.a.apcb010" cite_std="N" status="" ver="1" src="s" new="N" order="" mark_hard="N">
<![CDATA[            #業務部門
            LET g_apcb_m.apcb010_desc = ''
            IF NOT cl_null(g_apcb_m.apcb010) THEN
               IF (g_apcb_m.apcb010 != g_apcb_m_t.apcb010 OR g_apcb_m_t.apcb010 IS NULL ) THEN
                  CALL s_department_chk(g_apcb_m.apcb010,g_apcadocdt) RETURNING g_success
                  IF NOT g_success THEN
                     #CALL cl_err('',g_errno,1)
                     LET g_apcb_m.apcb010 = g_apcb_m_t.apcb010
                     CALL s_desc_get_department_desc(g_apcb_m.apcb010) RETURNING g_apcb_m.apcb010_desc
                     DISPLAY BY NAME g_apcb_m.apcb010_desc
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL s_desc_get_department_desc(g_apcb_m.apcb010) RETURNING g_apcb_m.apcb010_desc
            DISPLAY BY NAME g_apcb_m.apcb010_desc]]>
</point>
  <point name="input.a.apcb011" cite_std="N" status="" ver="1" src="s" new="N" order="" mark_hard="N">
<![CDATA[            #責任中心
            LET g_apcb_m.apcb011_desc = ' '
            IF NOT cl_null(g_apcb_m.apcb011) THEN
               IF g_apcb_m.apcb011 != g_apcb_m_t.apcb011 OR g_apcb_m.apcb011 IS NULL THEN
                  CALL s_department_chk(g_apcb_m.apcb011,g_apcadocdt) RETURNING g_success
                  IF NOT g_success THEN
                     #CALL cl_err('',g_errno,1)
                     LET g_apcb_m.apcb011 = g_apcb_m_t.apcb011
                     CALL s_desc_get_department_desc(g_apcb_m.apcb011) RETURNING g_apcb_m.apcb011_desc
                     DISPLAY BY NAME g_apcb_m.apcb011_desc
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL s_desc_get_department_desc(g_apcb_m.apcb011) RETURNING g_apcb_m.apcb011_desc
            DISPLAY BY NAME g_apcb_m.apcb011_desc]]>
</point>
  <point name="input.a.apcb012" cite_std="N" status="" ver="1" src="s" new="N" order="" mark_hard="N">
<![CDATA[            
            LET g_apcb_m.apcb012_desc = ' '
            IF NOT cl_null(g_apcb_m.apcb012) THEN
               IF g_apcb_m.apcb012 != g_apcb_m_t.apcb012 OR g_apcb_m_t.apcb012 IS NULL THEN
                  ##Belle產品類別
                  #IF NOT s_azzi650_chk_exist('3211',g_apcb_m.apcb012) THEN
                  #   LET g_apcb_m.apcb012  = g_apcb_m_t.apcb012
                  #   CALL s_desc_get_rtaxl003_desc(g_apcb_m.apcb012) RETURNING g_apcb_m.apcb012_desc
                  #   DISPLAY BY NAME g_apcb_m.apcb012_desc
                  #   NEXT FIELD CURRENT
                  #END IF
               END IF
            END IF   
            CALL s_desc_get_rtaxl003_desc(g_apcb_m.apcb012) RETURNING g_apcb_m.apcb012_desc
            DISPLAY BY NAME g_apcb_m.apcb012_desc
]]>
</point>
  <point name="input.a.apcb014" cite_std="N" status="" ver="1" src="s" new="N" order="" mark_hard="N">
<![CDATA[            #理由碼
            LET g_apcb_m.apcb014_desc = ' '
            IF NOT cl_null(g_apcb_m.apcb014) THEN
               IF g_apcb_m.apcb014 != g_apcb_m_t.apcb014 OR g_apcb_m_t.apcb014 IS NULL THEN
                  IF NOT s_azzi650_chk_exist('3211',g_apcb_m.apcb014) THEN
                     LET g_apcb_m.apcb014  = g_apcb_m_t.apcb014
                     CALL s_desc_get_acc_desc('3212',g_apcb_m.apcb014) RETURNING g_apcb_m.apcb014_desc
                     DISPLAY BY NAME g_apcb_m.apcb014_desc
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF   
            CALL s_desc_get_acc_desc('3212',g_apcb_m.apcb014) RETURNING g_apcb_m.apcb014_desc
            DISPLAY BY NAME g_apcb_m.apcb014_desc]]>
</point>
  <point name="input.a.apcb015" cite_std="N" status="" ver="1" src="s" new="N" order="" mark_hard="N">
<![CDATA[            #專案編號
            LET g_apcb_m.apcb015_desc = ' '
            IF NOT cl_null(g_apcb_m.apcb015) THEN
               IF g_apcb_m.apcb015 != g_apcb_m_t.apcb015 OR g_apcb_m_t.apcb015 IS NULL THEN
                  CALL s_aap_project_chk(g_apcb_m.apcb015) RETURNING g_success,g_errno
                  IF NOT g_success THEN
                     CALL cl_err('',g_errno,1)
                     LET g_apcb_m.apcb015 = g_apcb_m_t.apcb015
                     CALL s_desc_get_project_desc(g_apcb_m.apcb015) RETURNING　g_apcb_m.apcb015_desc
                     DISPLAY BY NAME g_apcb_m.apcb015_desc
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF           
            CALL s_desc_get_project_desc(g_apcb_m.apcb015) RETURNING　g_apcb_m.apcb015_desc
            DISPLAY BY NAME g_apcb_m.apcb015_desc  ]]>
</point>
  <point name="input.a.apcb017" cite_std="N" status="" ver="1" src="s" new="N" order="" mark_hard="N">
<![CDATA[            #預算項目
            LET g_apcb_m.apcb017_desc = ''
            IF NOT cl_null(g_apcb_m.apcb017) THEN
               IF g_apcb_m.apcb017 != g_apcb_m_t.apcb017 OR g_apcb_m_t.apcb017 IS NULL THEN
                  CALL s_fin_budget_chk(g_apcb_m.apcb017) RETURNING g_success,g_errno
                  IF NOT g_success THEN
                     CALL cl_err('',g_errno,1)
                     LET g_apcb_m.apcb017 = g_apcb_m_t.apcb017
                     CALL s_desc_get_budget_desc(g_apcb_m.apcb017) RETURNING g_apcb_m.apcb017_desc
                     DISPLAY BY NAME g_apcb_m.apcb017_desc
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL s_desc_get_budget_desc(g_apcb_m.apcb017) RETURNING g_apcb_m.apcb017_desc
            DISPLAY BY NAME g_apcb_m.apcb017_desc]]>
</point>
  <point name="input.a.apcb021" cite_std="N" status="" ver="1" src="s" new="N" order="" mark_hard="N">
<![CDATA[            #費用會計科目
            LET g_apcb_m.apcb021_desc = ''
            IF NOT cl_null(g_apcb_m.apcb021) THEN
               IF g_apcb_m.apcb021 != g_apcb_m_t.apcb021 OR g_apcb_m.apcb021 IS NULL THEN
                  CALL s_aap_glac002_chk(g_apcb_m.apcb021,g_apcb_m.apcbld) RETURNING g_success,g_errno
                  IF NOT g_success THEN
                     CALL cl_err('',g_errno,1)
                     LET g_apcb_m.apcb021 = g_apcb_m_t.apcb021
                     CALL s_desc_get_account_desc(g_apcb_m.apcbld,g_apcb_m.apcb021) RETURNING g_apcb_m.apcb021_desc
                     DISPLAY BY NAME g_apcb_m.apcb021_desc
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL s_desc_get_account_desc(g_apcb_m.apcbld,g_apcb_m.apcb021)  RETURNING g_apcb_m.apcb021_desc
            DISPLAY BY NAME g_apcb_m.apcb021_desc]]>
</point>
  <point name="input.a.apcb024" cite_std="N" status="" ver="1" src="s" new="N" order="" mark_hard="N">
<![CDATA[            #區域
            LET g_apcb_m.apcb024_desc = ''
            IF NOT cl_null(g_apcb_m.apcb024) THEN
               IF g_apcb_m.apcb024 != g_apcb_m_t.apcb024 OR g_apcb_m_t.apcb024 IS NULL THEN
                  IF NOT s_azzi650_chk_exist('2082',g_apcb_m.apcb024) THEN
                     LET g_apcb_m.apcb024  = g_apcb_m_t.apcb024
                     CALL s_desc_get_acc_desc('2082',g_apcb_m.apcb024) RETURNING g_apcb_m.apcb024_desc
                     DISPLAY BY NAME g_apcb_m.apcb024_desc
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF   
            CALL s_desc_get_acc_desc('2082',g_apcb_m.apcb024) RETURNING g_apcb_m.apcb024_desc
            DISPLAY BY NAME g_apcb_m.apcb024_desc]]>
</point>
  <point name="input.a.apcbdocno" cite_std="N" status="" ver="1" src="s" new="N" order="" mark_hard="N">
<![CDATA[            #此段落由子樣板a05產生
            IF  NOT cl_null(g_apcb_m.apcbld) AND NOT cl_null(g_apcb_m.apcbdocno) AND NOT cl_null(g_apcb_m.apcbseq) THEN 
               IF p_cmd = 'a' OR ( p_cmd = 'u' AND (g_apcb_m.apcbld != g_apcbld_t  OR g_apcb_m.apcbdocno != g_apcbdocno_t  OR g_apcb_m.apcbseq != g_apcbseq_t )) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM apcb_t WHERE "||"apcbent = '" ||g_enterprise|| "' AND "||"apcbld = '"||g_apcb_m.apcbld ||"' AND "|| "apcbdocno = '"||g_apcb_m.apcbdocno ||"' AND "|| "apcbseq = '"||g_apcb_m.apcbseq ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF]]>
</point>
  <point name="input.a.apcbld" cite_std="N" status="" ver="1" src="s" new="N" order="" mark_hard="N">
<![CDATA[            #此段落由子樣板a05產生
            IF  NOT cl_null(g_apcb_m.apcbld) AND NOT cl_null(g_apcb_m.apcbdocno) AND NOT cl_null(g_apcb_m.apcbseq) THEN 
               IF p_cmd = 'a' OR ( p_cmd = 'u' AND (g_apcb_m.apcbld != g_apcbld_t  OR g_apcb_m.apcbdocno != g_apcbdocno_t  OR g_apcb_m.apcbseq != g_apcbseq_t )) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM apcb_t WHERE "||"apcbent = '" ||g_enterprise|| "' AND "||"apcbld = '"||g_apcb_m.apcbld ||"' AND "|| "apcbdocno = '"||g_apcb_m.apcbdocno ||"' AND "|| "apcbseq = '"||g_apcb_m.apcbseq ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF


]]>
</point>
  <point name="input.a.apcblegl" cite_std="N" status="u" ver="1" src="s" new="N" order="" mark_hard="N">
<![CDATA[            #核算組織
            LET g_apcb_m.apcblegl_desc = ''
            IF NOT cl_null(g_apcb_m.apcblegl) THEN
               IF g_apcb_m.apcblegl != g_apcb_m_t.apcblegl OR g_apcb_m.apcblegl IS NULL THEN
                  CALL s_fin_account_legl_chk(g_apcb_m.apcblegl) RETURNING g_success,g_errno
                  IF NOT g_success THEN
                     CALL cl_err('',g_errno,1)
                     LET g_apcb_m.apcblegl = g_apcb_m_t.apcblegl
                     CALL s_desc_get_department_desc(g_apcb_m.apcblegl) RETURNING g_apcb_m.apcblegl_desc
                     DISPLAY BY NAME g_apcb_m.apcblegl_desc
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL s_desc_get_department_desc(g_apcb_m.apcblegl) RETURNING g_apcb_m.apcblegl_desc
            DISPLAY BY NAME g_apcb_m.apcblegl_desc]]>
</point>
  <point name="input.a.apcbseq" cite_std="N" status="" ver="1" src="s" new="N" order="" mark_hard="N">
<![CDATA[            #此段落由子樣板a05產生
            IF  NOT cl_null(g_apcb_m.apcbld) AND NOT cl_null(g_apcb_m.apcbdocno) AND NOT cl_null(g_apcb_m.apcbseq) THEN 
               IF p_cmd = 'a' OR ( p_cmd = 'u' AND (g_apcb_m.apcbld != g_apcbld_t  OR g_apcb_m.apcbdocno != g_apcbdocno_t  OR g_apcb_m.apcbseq != g_apcbseq_t )) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM apcb_t WHERE "||"apcbent = '" ||g_enterprise|| "' AND "||"apcbld = '"||g_apcb_m.apcbld ||"' AND "|| "apcbdocno = '"||g_apcb_m.apcbdocno ||"' AND "|| "apcbseq = '"||g_apcb_m.apcbseq ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF


            IF NOT cl_null(g_apcb_m.apcbseq) THEN 
            END IF 
]]>
</point>
  <point name="input.action" cite_std="N" status="" ver="1" src="s" new="N" order="" mark_hard="N">
<![CDATA[]]>
</point>
  <point name="input.before_close" cite_std="N" status="" ver="1" src="s" new="N" order="" mark_hard="N">
<![CDATA[   ]]>
</point>
  <point name="input.before_input" cite_std="N" status="" ver="1" src="s" new="N" order="" mark_hard="N">
<![CDATA[]]>
</point>
  <point name="input.c.apcb004" cite_std="N" status="" ver="1" src="s" new="N" order="" mark_hard="N">
<![CDATA[            #產品編號
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_apcb_m.apcb004       #給予default值
            CALL q_imaa001_14()                              #呼叫開窗
            LET g_apcb_m.apcb004 = g_qryparam.return1        #將開窗取得的值回傳到變數
            DISPLAY g_apcb_m.apcb004 TO apcb004              #顯示到畫面上
            NEXT FIELD apcb004                               #返回原欄位]]>
</point>
  <point name="input.c.apcb010" cite_std="N" status="" ver="1" src="s" new="N" order="" mark_hard="N">
<![CDATA[            #業務部門
 		    INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_apcb_m.apcb010        #給予default值
            #給予arg
            SELECT apcadocdt INTO l_apcadocdt FROM apca_t
             WHERE apcaent  = g_enterprise
               AND apcadocno= g_apcb_m.apcbdocno
               AND apcald   = g_apcb_m.apcbld
            LET g_qryparam.arg1 = l_apcadocdt
            CALL q_ooeg001_4()                                #呼叫開窗
            LET g_apcb_m.apcb010 = g_qryparam.return1         #將開窗取得的值回傳到變數
            CALL s_desc_get_department_desc(g_apcb_m.apcb010) RETURNING g_apcb_m.apcb010_desc
            DISPLAY BY NAME g_apcb_m.apcb010,g_apcb_m.apcb010_desc       
            NEXT FIELD apcb010                                #返回原欄位]]>
</point>
  <point name="input.c.apcb011" cite_std="N" status="" ver="1" src="s" new="N" order="" mark_hard="N">
<![CDATA[			#責任中心
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_apcb_m.apcb011        #給予default值
            CALL q_ooeg001_2()                                #呼叫開窗
            LET g_apcb_m.apcb011 = g_qryparam.return1         #將開窗取得的值回傳到變數
            CALL s_desc_get_department_desc(g_apcb_m.apcb011) RETURNING g_apcb_m.apcb011_desc
            DISPLAY BY NAME g_apcb_m.apcb011,g_apcb_m.apcb011_desc            
            NEXT FIELD apcb011 ]]>
</point>
  <point name="input.c.apcb012" cite_std="N" status="" ver="1" src="s" new="N" order="" mark_hard="N">
<![CDATA[		    #產品類別
		    INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_apcb_m.apcb012         #給予default值
            CALL q_rtax001()                                   #呼叫開窗
            LET g_apcb_m.apcb012 = g_qryparam.return1          #將開窗取得的值回傳到變數
            CALL s_desc_get_rtaxl003_desc(g_apcb_m.apcb012) RETURNING g_apcb_m.apcb012_desc
            DISPLAY BY NAME g_apcb_m.apcb012,g_apcb_m.apcb012_desc       
            NEXT FIELD apcb012                                               #返回原欄位]]>
</point>
  <point name="input.c.apcb014" cite_std="N" status="" ver="1" src="s" new="N" order="" mark_hard="N">
<![CDATA[            #理由碼            
            #開窗i段
		    INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_apcb_m.apcb014      #給予default值
            LET g_qryparam.arg1 = "3212" 
            CALL q_oocq002()                                #呼叫開窗
            LET g_apcb_m.apcb014 = g_qryparam.return1       #將開窗取得的值回傳到變數
            CALL s_desc_get_acc_desc('3212',g_apcb_m.apcb014) RETURNING g_apcb_m.apcb014_desc
            DISPLAY BY NAME g_apcb_m.apcb014,g_apcb_m.apcb014_desc
            NEXT FIELD apcb014  ]]>
</point>
  <point name="input.c.apcb015" cite_std="N" status="" ver="1" src="s" new="N" order="" mark_hard="N">
<![CDATA[            #專案代號
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_apcb_m.apcb015         #給予default值
            CALL q_pjba001()                                   #呼叫開窗
            LET g_apcb_m.apcb015 = g_qryparam.return1          #將開窗取得的值回傳到變數
            CALL s_desc_get_project_desc(g_apcb_m.apcb015) RETURNING g_apcb_m.apcb015_desc
            DISPLAY BY NAME g_apcb_m.apcb015,g_apcb_m.apcb015_desc
            NEXT FIELD apcb015        　　　　                  #返回原欄位]]>
</point>
  <point name="input.c.apcb017" cite_std="N" status="" ver="1" src="s" new="N" order="" mark_hard="N">
<![CDATA[            #預算編號
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_apcb_m.apcb017      #給予default值
            CALL q_bgaa001()                                #呼叫開窗
            LET g_apcb_m.apcb017 = g_qryparam.return1       #將開窗取得的值回傳到變數
            CALL s_desc_get_budget_desc(g_apcb_m.apcb017) RETURNING g_apcb_m.apcb017_desc
            DISPLAY BY NAME g_apcb_m.apcb017,g_apcb_m.apcb017_desc]]>
</point>
  <point name="input.c.apcb021" cite_std="N" status="" ver="1" src="s" new="N" order="" mark_hard="N">
<![CDATA[            #費用會計科目            
		    INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_apcb_m.apcb021       #給予default值
            LET g_qryparam.where = "glac001 = '",g_glaa004,"' AND  glac003 <>'1' "  #glac001(會計科目參照表)/glac003(科目類型)
            CALL aglt310_04()                                #呼叫開窗
            LET g_apcb_m.apcb021 = g_qryparam.return1        #將開窗取得的值回傳到變數
            CALL s_desc_get_account_desc(g_apcb_m.apcbld,g_apcb_m.apcb021) RETURNING g_apcb_m.apcb021_desc
            DISPLAY BY NAME g_apcb_m.apcb021,g_apcb_m.apcb021_desc
            NEXT FIELD apcb021                                          #返回原欄位]]>
</point>
  <point name="input.c.apcb024" cite_std="N" status="" ver="1" src="s" new="N" order="" mark_hard="N">
<![CDATA[            #區域
            #開窗i段
		    INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_apcb_m.apcb024      #給予default值
            LET g_qryparam.arg1 = "2082" 
            CALL q_oocq002()                                #呼叫開窗
            LET g_apcb_m.apcb024 = g_qryparam.return1       #將開窗取得的值回傳到變數
            CALL s_desc_get_acc_desc('2082',g_apcb_m.apcb024) RETURNING g_apcb_m.apcb024_desc
            DISPLAY BY NAME g_apcb_m.apcb024,g_apcb_m.apcb024_desc
            NEXT FIELD apcb024  ]]>
</point>
  <point name="input.c.apcb028" cite_std="N" status="" ver="1" src="s" new="N" order="" mark_hard="N">
<![CDATA[		    #發票號碼
		    INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_apcb_m.apcb028        #給予default值
            LET g_qryparam.where = " isam001 = 'aapt300' "
            CALL q_isam010_2()                                #呼叫開窗
            LET g_apcb_m.apcb028 = g_qryparam.return1         #將開窗取得的值回傳到變數
            DISPLAY g_apcb_m.apcb028 TO apcb028               #顯示到畫面上
            NEXT FIELD apcb028                                #返回原欄位]]>
</point>
  <point name="input.c.apcbdocno" cite_std="N" status="" ver="1" src="s" new="N" order="" mark_hard="N">
<![CDATA[]]>
</point>
  <point name="input.c.apcblegl" cite_std="N" status="u" ver="1" src="s" new="N" order="" mark_hard="N">
<![CDATA[            #核算組織            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_apcb_m.apcblegl       #給予default值
            CALL q_ooef001()                                  #呼叫開窗
            LET g_apcb_m.apcblegl = g_qryparam.return1        #將開窗取得的值回傳到變數
            CALL s_desc_get_department_desc(g_apcb_m.apcblegl) RETURNING g_apcb_m.apcblegl_desc 
            DISPLAY BY NAME g_apcb_m.apcblegl,g_apcb_m.apcblegl_desc            
            NEXT FIELD apcblegl                               #返回原欄位

]]>
</point>
  <point name="input.define" cite_std="N" status="" ver="1" src="s" new="N" order="" mark_hard="N">
<![CDATA[   ####################################################
   DEFINE p_array         DYNAMIC ARRAY OF RECORD
                 chr      LIKE type_t.chr500,
                 dat      LIKE type_t.dat
                          END RECORD

   #p_array[1]  apcadocno 應付單號
   #p_array[2]  apcald    帳別
   #p_array[3]  apcb004   產品編號
   #p_array[4]  apcb005   品名規格
   #p_array[5]  apcb002   來源單號
   #p_array[6]  apcb003   來源項次
   #p_array[7]  apcb008   參考單據
   #p_array[8]  apcb009   參考單據項次
   #p_array[9]  apcb023   沖暫估
   #p_array[10] apcb010   業務部門
   #p_array[11] apcb011   責任中心
   #p_array[12] apcblegl  核算組織
   #p_array[13] apcb012   產品類別
   #p_array[14] apcb014   理由碼
   #p_array[15] apcb028   發票號碼
   #p_array[16] apcb021   費用會科
   #p_array[17] apcb015   專案代號
   #p_array[18] apcb016   WBS
   #p_array[19] apcb017   預算項目
   #p_array[20] apcb024   發票號碼
   ####################################################
   DEFINE p_type          LIKE type_t.chr1        #p_type         類型   1:應收 2:應付 3:資金 4:資產
   DEFINE l_apcadocdt     LIKE apca_t.apcadocdt]]>
</point>
  <point name="input.get_var" cite_std="N" status="" ver="1" src="s" new="N" order="" mark_hard="N">
<![CDATA[   p_array,p_type]]>
</point>
  <point name="input.post_input" cite_std="N" status="" ver="1" src="s" new="N" order="" mark_hard="N">
<![CDATA[   CALL aapt300_12_move_to_array()
   RETURN p_array]]>
</point>
  <point name="input.pre_input" cite_std="N" status="" ver="1" src="s" new="N" order="" mark_hard="N">
<![CDATA[   LET g_array = p_array
   CALL aapt300_12_move_to_g_apcb()

   LET l_apcadocdt = NULL
   SELECT apcadocdt INTO l_apcadocdt FROM apca_t
    WHERE apcadocno = g_apcb_m.apcbdocno
      AND apcald    = g_apcb_m.apcbld
      AND apcaent   = g_enterprise]]>
</point>
  <point name="show.head.reference" cite_std="N" status="" ver="1" src="s" new="N" order="" mark_hard="N">
<![CDATA[
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_apcb_m.apcb010
            CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_apcb_m.apcb010_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_apcb_m.apcb010_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_apcb_m.apcb011
            CALL ap_ref_array2(g_ref_fields,"SELECT oofa011 FROM oofa_t WHERE oofaent='"||g_enterprise||"' AND oofa002='2' AND oofa003=? ","") RETURNING g_rtn_fields
            LET g_apcb_m.apcb011_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_apcb_m.apcb011_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_apcb_m.apcblegl
            CALL ap_ref_array2(g_ref_fields,"SELECT ooefl002 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? ","") RETURNING g_rtn_fields
            LET g_apcb_m.apcblegl_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_apcb_m.apcblegl_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_apcb_m.apcb012
            CALL ap_ref_array2(g_ref_fields,"SELECT rtaxl002 FROM rtaxl_t WHERE rtaxlent='"||g_enterprise||"' AND rtaxl001=? ","") RETURNING g_rtn_fields
            LET g_apcb_m.apcb012_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_apcb_m.apcb012_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_apcb_m.apcb014
            CALL ap_ref_array2(g_ref_fields,"SELECT oocql003 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='3212' AND oocql002=? ","") RETURNING g_rtn_fields
            LET g_apcb_m.apcb014_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_apcb_m.apcb014_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_apcb_m.apcb021
            CALL ap_ref_array2(g_ref_fields,"SELECT glacl003 FROM glacl_t WHERE glaclent='"||g_enterprise||"' AND ',glacl002=? ","") RETURNING g_rtn_fields
            LET g_apcb_m.apcb021_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_apcb_m.apcb021_desc
]]>
</point>
  <point name="global.memo" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="global.import" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="global.inc" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="global.argv" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.b.apcb004" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.a.apcb004" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.g.apcb004" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.b.apcb005" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.a.apcb005" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.g.apcb005" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.b.apcb002" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.a.apcb002" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.g.apcb002" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.b.apcb003" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.a.apcb003" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.g.apcb003" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.b.apcb008" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.a.apcb008" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.g.apcb008" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.b.apcb009" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.a.apcb009" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.g.apcb009" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.b.apcb023" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.a.apcb023" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.g.apcb023" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.b.apcbdocno" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.g.apcbdocno" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.b.apcbld" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.g.apcbld" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.b.apcbseq" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.g.apcbseq" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.b.apcb010" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.g.apcb010" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.b.apcb011" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.g.apcb011" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.b.apcblegl" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.g.apcblegl" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.b.apcb012" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.g.apcb012" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.b.apcb014" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.g.apcb014" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.b.apcb024" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.g.apcb024" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.b.apcb021" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.g.apcb021" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.b.apcb015" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.g.apcb015" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.b.apcb016" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.a.apcb016" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.g.apcb016" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.b.apcb017" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.g.apcb017" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.b.apcb028" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.a.apcb028" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.g.apcb028" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.c.apcb005" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.c.apcb002" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.c.apcb003" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.c.apcb008" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.c.apcb009" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.c.apcb023" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.c.apcbld" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.c.apcbseq" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.c.apcb016" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.after_input" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="input.more_input" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <section id="aapt300_12.description" ver="65" status="" src="s">
<![CDATA[#+ Version..: T100-ERP-1.00.00(SD版次:1,PD版次:1) Build-000064
#+ 
#+ Filename...: aapt300_12
#+ Description: ...
#+ Creator....: 03080(2014/03/17)
#+ Modifier...: 03080(2014/03/17)
#+ Buildtype..: 應用 c01b 樣板自動產生
#+ 以上段落由子樣板a00產生
]]>
</section>
  <section id="aapt300_12.global" ver="5" status="" src="s">
<![CDATA[{<point name="global.memo" />}
 
IMPORT os
IMPORT FGL lib_cl_dlg
#add-point:增加匯入項目
{<point name="global.import" />}
#end add-point
 
SCHEMA ds
 
GLOBALS "../../cfg/top_global.inc"
 
#add-point:增加匯入變數檔
{<point name="global.inc" />}
#end add-point
 
#單頭 type 宣告
PRIVATE type type_g_apcb_m        RECORD
       apcb004 LIKE apcb_t.apcb004, 
   ffspace1 LIKE type_t.chr80, 
   apcb005 LIKE apcb_t.apcb005, 
   ffspace2 LIKE type_t.chr80, 
   apcb002 LIKE apcb_t.apcb002, 
   apcb003 LIKE apcb_t.apcb003, 
   ffspace3 LIKE type_t.chr80, 
   apcb008 LIKE apcb_t.apcb008, 
   apcb009 LIKE apcb_t.apcb009, 
   apcb023 LIKE apcb_t.apcb023, 
   apcbdocno LIKE apcb_t.apcbdocno, 
   apcbld LIKE apcb_t.apcbld, 
   apcbseq LIKE apcb_t.apcbseq, 
   apcb010 LIKE apcb_t.apcb010, 
   apcb010_desc LIKE type_t.chr80, 
   apcb011 LIKE apcb_t.apcb011, 
   apcb011_desc LIKE type_t.chr80, 
   apcblegl LIKE apcb_t.apcblegl, 
   apcblegl_desc LIKE type_t.chr80, 
   apcb012 LIKE apcb_t.apcb012, 
   apcb012_desc LIKE type_t.chr80, 
   apcb014 LIKE apcb_t.apcb014, 
   apcb014_desc LIKE type_t.chr80, 
   apcb024 LIKE apcb_t.apcb024, 
   apcb024_desc LIKE type_t.chr80, 
   apcb021 LIKE apcb_t.apcb021, 
   apcb021_desc LIKE type_t.chr80, 
   apcb015 LIKE apcb_t.apcb015, 
   apcb015_desc LIKE type_t.chr80, 
   apcb016 LIKE apcb_t.apcb016, 
   apcb017 LIKE apcb_t.apcb017, 
   apcb017_desc LIKE type_t.chr80, 
   apcb028 LIKE apcb_t.apcb028
       END RECORD
DEFINE g_apcb_m        type_g_apcb_m
 
   DEFINE g_apcbdocno_t LIKE apcb_t.apcbdocno
DEFINE g_apcbld_t LIKE apcb_t.apcbld
DEFINE g_apcbseq_t LIKE apcb_t.apcbseq
 
 
DEFINE g_ref_fields          DYNAMIC ARRAY OF VARCHAR(500) #ap_ref用陣列
DEFINE g_rtn_fields          DYNAMIC ARRAY OF VARCHAR(500) #ap_ref用陣列
 
#add-point:自定義模組變數(Module Variable)
{<point name="global.variable"/>}
#end add-point
 
#add-point:傳入參數說明(global.argv)
{<point name="global.argv"/>}
#end add-point
]]>
</section>
  <section id="aapt300_12.input" ver="5" status="" src="s">
<![CDATA[#+ 資料輸入
PUBLIC FUNCTION aapt300_12(--)
   #add-point:input段變數傳入
   {<point name="input.get_var"/>}
   #end add-point
   )
   DEFINE l_ac_t          LIKE type_t.num5        #未取消的ARRAY CNT 
   DEFINE l_allow_insert  LIKE type_t.num5        #可新增否 
   DEFINE l_allow_delete  LIKE type_t.num5        #可刪除否  
   DEFINE l_count         LIKE type_t.num5
   DEFINE l_insert        LIKE type_t.num5
   DEFINE p_cmd           LIKE type_t.chr5
   #add-point:input段define
   {<point name="input.define"/>}
   #end add-point
 
   #畫面開啟 (identifier)
   OPEN WINDOW w_aapt300_12 WITH FORM cl_ap_formpath("aap","aapt300_12")
 
   #瀏覽頁簽資料初始化
   CALL cl_ui_init()
   
   LET g_qryparam.state = "i"
   LET p_cmd = 'a'
   
   #輸入前處理
   #add-point:單頭前置處理
   {<point name="input.pre_input"/>}
   #end add-point
  
   DIALOG ATTRIBUTES(UNBUFFERED,FIELD ORDER FORM)
   
      #輸入開始
      INPUT BY NAME g_apcb_m.apcb004,g_apcb_m.apcb005,g_apcb_m.apcb002,g_apcb_m.apcb003,g_apcb_m.apcb008, 
          g_apcb_m.apcb009,g_apcb_m.apcb023,g_apcb_m.apcbdocno,g_apcb_m.apcbld,g_apcb_m.apcbseq,g_apcb_m.apcb010, 
          g_apcb_m.apcb011,g_apcb_m.apcblegl,g_apcb_m.apcb012,g_apcb_m.apcb014,g_apcb_m.apcb024,g_apcb_m.apcb021, 
          g_apcb_m.apcb015,g_apcb_m.apcb016,g_apcb_m.apcb017,g_apcb_m.apcb028 ATTRIBUTE(WITHOUT DEFAULTS) 

         
         #自訂ACTION
         #add-point:單頭前置處理
         {<point name="input.action"/>}
         #end add-point
         
         #自訂ACTION(master_input)
         
         
         BEFORE INPUT
            #add-point:單頭輸入前處理
            {<point name="input.before_input"/>}
            #end add-point
          
         #---------------------------<  Master  >---------------------------
         #----<<apcb004>>----
         #此段落由子樣板a01產生
         BEFORE FIELD apcb004
            #add-point:BEFORE FIELD apcb004
            {<point name="input.b.apcb004" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD apcb004
            
            #add-point:AFTER FIELD apcb004
            {<point name="input.a.apcb004" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE apcb004
            #add-point:ON CHANGE apcb004
            {<point name="input.g.apcb004" />}
            #END add-point
 
         #----<<ffspace1>>----
         #----<<apcb005>>----
         #此段落由子樣板a01產生
         BEFORE FIELD apcb005
            #add-point:BEFORE FIELD apcb005
            {<point name="input.b.apcb005" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD apcb005
            
            #add-point:AFTER FIELD apcb005
            {<point name="input.a.apcb005" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE apcb005
            #add-point:ON CHANGE apcb005
            {<point name="input.g.apcb005" />}
            #END add-point
 
         #----<<ffspace2>>----
         #----<<apcb002>>----
         #此段落由子樣板a01產生
         BEFORE FIELD apcb002
            #add-point:BEFORE FIELD apcb002
            {<point name="input.b.apcb002" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD apcb002
            
            #add-point:AFTER FIELD apcb002
            {<point name="input.a.apcb002" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE apcb002
            #add-point:ON CHANGE apcb002
            {<point name="input.g.apcb002" />}
            #END add-point
 
         #----<<apcb003>>----
         #此段落由子樣板a01產生
         BEFORE FIELD apcb003
            #add-point:BEFORE FIELD apcb003
            {<point name="input.b.apcb003" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD apcb003
            
            #add-point:AFTER FIELD apcb003
            {<point name="input.a.apcb003" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE apcb003
            #add-point:ON CHANGE apcb003
            {<point name="input.g.apcb003" />}
            #END add-point
 
         #----<<ffspace3>>----
         #----<<apcb008>>----
         #此段落由子樣板a01產生
         BEFORE FIELD apcb008
            #add-point:BEFORE FIELD apcb008
            {<point name="input.b.apcb008" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD apcb008
            
            #add-point:AFTER FIELD apcb008
            {<point name="input.a.apcb008" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE apcb008
            #add-point:ON CHANGE apcb008
            {<point name="input.g.apcb008" />}
            #END add-point
 
         #----<<apcb009>>----
         #此段落由子樣板a01產生
         BEFORE FIELD apcb009
            #add-point:BEFORE FIELD apcb009
            {<point name="input.b.apcb009" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD apcb009
            
            #add-point:AFTER FIELD apcb009
            {<point name="input.a.apcb009" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE apcb009
            #add-point:ON CHANGE apcb009
            {<point name="input.g.apcb009" />}
            #END add-point
 
         #----<<apcb023>>----
         #此段落由子樣板a01產生
         BEFORE FIELD apcb023
            #add-point:BEFORE FIELD apcb023
            {<point name="input.b.apcb023" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD apcb023
            
            #add-point:AFTER FIELD apcb023
            {<point name="input.a.apcb023" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE apcb023
            #add-point:ON CHANGE apcb023
            {<point name="input.g.apcb023" />}
            #END add-point
 
         #----<<apcbdocno>>----
         #此段落由子樣板a01產生
         BEFORE FIELD apcbdocno
            #add-point:BEFORE FIELD apcbdocno
            {<point name="input.b.apcbdocno" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD apcbdocno
            
            #add-point:AFTER FIELD apcbdocno
            {<point name="input.a.apcbdocno" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE apcbdocno
            #add-point:ON CHANGE apcbdocno
            {<point name="input.g.apcbdocno" />}
            #END add-point
 
         #----<<apcbld>>----
         #此段落由子樣板a01產生
         BEFORE FIELD apcbld
            #add-point:BEFORE FIELD apcbld
            {<point name="input.b.apcbld" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD apcbld
            
            #add-point:AFTER FIELD apcbld
            {<point name="input.a.apcbld" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE apcbld
            #add-point:ON CHANGE apcbld
            {<point name="input.g.apcbld" />}
            #END add-point
 
         #----<<apcbseq>>----
         #此段落由子樣板a02產生
         AFTER FIELD apcbseq
            #此段落由子樣板a15產生
            IF NOT cl_ap_chk_Range(g_apcb_m.apcbseq,"1.000","1","","","azz-00079",1) THEN
               NEXT FIELD apcbseq
            END IF
 
 
            #add-point:AFTER FIELD apcbseq
            {<point name="input.a.apcbseq" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD apcbseq
            #add-point:BEFORE FIELD apcbseq
            {<point name="input.b.apcbseq" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE apcbseq
            #add-point:ON CHANGE apcbseq
            {<point name="input.g.apcbseq" />}
            #END add-point
 
         #----<<apcb010>>----
         #此段落由子樣板a02產生
         AFTER FIELD apcb010
            
            #add-point:AFTER FIELD apcb010
            {<point name="input.a.apcb010" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD apcb010
            #add-point:BEFORE FIELD apcb010
            {<point name="input.b.apcb010" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE apcb010
            #add-point:ON CHANGE apcb010
            {<point name="input.g.apcb010" />}
            #END add-point
 
         #----<<apcb010_desc>>----
         #----<<apcb011>>----
         #此段落由子樣板a02產生
         AFTER FIELD apcb011
            
            #add-point:AFTER FIELD apcb011
            {<point name="input.a.apcb011" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD apcb011
            #add-point:BEFORE FIELD apcb011
            {<point name="input.b.apcb011" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE apcb011
            #add-point:ON CHANGE apcb011
            {<point name="input.g.apcb011" />}
            #END add-point
 
         #----<<apcb011_desc>>----
         #----<<apcblegl>>----
         #此段落由子樣板a02產生
         AFTER FIELD apcblegl
            
            #add-point:AFTER FIELD apcblegl
            {<point name="input.a.apcblegl" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD apcblegl
            #add-point:BEFORE FIELD apcblegl
            {<point name="input.b.apcblegl" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE apcblegl
            #add-point:ON CHANGE apcblegl
            {<point name="input.g.apcblegl" />}
            #END add-point
 
         #----<<apcblegl_desc>>----
         #----<<apcb012>>----
         #此段落由子樣板a02產生
         AFTER FIELD apcb012
            
            #add-point:AFTER FIELD apcb012
            {<point name="input.a.apcb012" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD apcb012
            #add-point:BEFORE FIELD apcb012
            {<point name="input.b.apcb012" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE apcb012
            #add-point:ON CHANGE apcb012
            {<point name="input.g.apcb012" />}
            #END add-point
 
         #----<<apcb012_desc>>----
         #----<<apcb014>>----
         #此段落由子樣板a02產生
         AFTER FIELD apcb014
            
            #add-point:AFTER FIELD apcb014
            {<point name="input.a.apcb014" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD apcb014
            #add-point:BEFORE FIELD apcb014
            {<point name="input.b.apcb014" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE apcb014
            #add-point:ON CHANGE apcb014
            {<point name="input.g.apcb014" />}
            #END add-point
 
         #----<<apcb014_desc>>----
         #----<<apcb024>>----
         #此段落由子樣板a02產生
         AFTER FIELD apcb024
            
            #add-point:AFTER FIELD apcb024
            {<point name="input.a.apcb024" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD apcb024
            #add-point:BEFORE FIELD apcb024
            {<point name="input.b.apcb024" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE apcb024
            #add-point:ON CHANGE apcb024
            {<point name="input.g.apcb024" />}
            #END add-point
 
         #----<<apcb024_desc>>----
         #----<<apcb021>>----
         #此段落由子樣板a02產生
         AFTER FIELD apcb021
            
            #add-point:AFTER FIELD apcb021
            {<point name="input.a.apcb021" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD apcb021
            #add-point:BEFORE FIELD apcb021
            {<point name="input.b.apcb021" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE apcb021
            #add-point:ON CHANGE apcb021
            {<point name="input.g.apcb021" />}
            #END add-point
 
         #----<<apcb021_desc>>----
         #----<<apcb015>>----
         #此段落由子樣板a02產生
         AFTER FIELD apcb015
            
            #add-point:AFTER FIELD apcb015
            {<point name="input.a.apcb015" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD apcb015
            #add-point:BEFORE FIELD apcb015
            {<point name="input.b.apcb015" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE apcb015
            #add-point:ON CHANGE apcb015
            {<point name="input.g.apcb015" />}
            #END add-point
 
         #----<<apcb015_desc>>----
         #----<<apcb016>>----
         #此段落由子樣板a01產生
         BEFORE FIELD apcb016
            #add-point:BEFORE FIELD apcb016
            {<point name="input.b.apcb016" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD apcb016
            
            #add-point:AFTER FIELD apcb016
            {<point name="input.a.apcb016" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE apcb016
            #add-point:ON CHANGE apcb016
            {<point name="input.g.apcb016" />}
            #END add-point
 
         #----<<apcb017>>----
         #此段落由子樣板a02產生
         AFTER FIELD apcb017
            
            #add-point:AFTER FIELD apcb017
            {<point name="input.a.apcb017" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD apcb017
            #add-point:BEFORE FIELD apcb017
            {<point name="input.b.apcb017" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE apcb017
            #add-point:ON CHANGE apcb017
            {<point name="input.g.apcb017" />}
            #END add-point
 
         #----<<apcb017_desc>>----
         #----<<apcb028>>----
         #此段落由子樣板a01產生
         BEFORE FIELD apcb028
            #add-point:BEFORE FIELD apcb028
            {<point name="input.b.apcb028" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD apcb028
            
            #add-point:AFTER FIELD apcb028
            {<point name="input.a.apcb028" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE apcb028
            #add-point:ON CHANGE apcb028
            {<point name="input.g.apcb028" />}
            #END add-point
 
 #欄位檢查
         #---------------------------<  Master  >---------------------------
         #----<<apcb004>>----
         #Ctrlp:input.c.apcb004
         ON ACTION controlp INFIELD apcb004
            #add-point:ON ACTION controlp INFIELD apcb004
            {<point name="input.c.apcb004" />}
            #END add-point
 
         #----<<ffspace1>>----
         #----<<apcb005>>----
         #Ctrlp:input.c.apcb005
         ON ACTION controlp INFIELD apcb005
            #add-point:ON ACTION controlp INFIELD apcb005
            {<point name="input.c.apcb005" />}
            #END add-point
 
         #----<<ffspace2>>----
         #----<<apcb002>>----
         #Ctrlp:input.c.apcb002
         ON ACTION controlp INFIELD apcb002
            #add-point:ON ACTION controlp INFIELD apcb002
            {<point name="input.c.apcb002" />}
            #END add-point
 
         #----<<apcb003>>----
         #Ctrlp:input.c.apcb003
         ON ACTION controlp INFIELD apcb003
            #add-point:ON ACTION controlp INFIELD apcb003
            {<point name="input.c.apcb003" />}
            #END add-point
 
         #----<<ffspace3>>----
         #----<<apcb008>>----
         #Ctrlp:input.c.apcb008
         ON ACTION controlp INFIELD apcb008
            #add-point:ON ACTION controlp INFIELD apcb008
            {<point name="input.c.apcb008" />}
            #END add-point
 
         #----<<apcb009>>----
         #Ctrlp:input.c.apcb009
         ON ACTION controlp INFIELD apcb009
            #add-point:ON ACTION controlp INFIELD apcb009
            {<point name="input.c.apcb009" />}
            #END add-point
 
         #----<<apcb023>>----
         #Ctrlp:input.c.apcb023
         ON ACTION controlp INFIELD apcb023
            #add-point:ON ACTION controlp INFIELD apcb023
            {<point name="input.c.apcb023" />}
            #END add-point
 
         #----<<apcbdocno>>----
         #Ctrlp:input.c.apcbdocno
         ON ACTION controlp INFIELD apcbdocno
            #add-point:ON ACTION controlp INFIELD apcbdocno
            {<point name="input.c.apcbdocno" />}
            #END add-point
 
         #----<<apcbld>>----
         #Ctrlp:input.c.apcbld
         ON ACTION controlp INFIELD apcbld
            #add-point:ON ACTION controlp INFIELD apcbld
            {<point name="input.c.apcbld" />}
            #END add-point
 
         #----<<apcbseq>>----
         #Ctrlp:input.c.apcbseq
         ON ACTION controlp INFIELD apcbseq
            #add-point:ON ACTION controlp INFIELD apcbseq
            {<point name="input.c.apcbseq" />}
            #END add-point
 
         #----<<apcb010>>----
         #Ctrlp:input.c.apcb010
         ON ACTION controlp INFIELD apcb010
            #add-point:ON ACTION controlp INFIELD apcb010
            {<point name="input.c.apcb010" />}
            #END add-point
 
         #----<<apcb010_desc>>----
         #----<<apcb011>>----
         #Ctrlp:input.c.apcb011
         ON ACTION controlp INFIELD apcb011
            #add-point:ON ACTION controlp INFIELD apcb011
            {<point name="input.c.apcb011" />}
            #END add-point
 
         #----<<apcb011_desc>>----
         #----<<apcblegl>>----
         #Ctrlp:input.c.apcblegl
         ON ACTION controlp INFIELD apcblegl
            #add-point:ON ACTION controlp INFIELD apcblegl
            {<point name="input.c.apcblegl" />}
            #END add-point
 
         #----<<apcblegl_desc>>----
         #----<<apcb012>>----
         #Ctrlp:input.c.apcb012
         ON ACTION controlp INFIELD apcb012
            #add-point:ON ACTION controlp INFIELD apcb012
            {<point name="input.c.apcb012" />}
            #END add-point
 
         #----<<apcb012_desc>>----
         #----<<apcb014>>----
         #Ctrlp:input.c.apcb014
         ON ACTION controlp INFIELD apcb014
            #add-point:ON ACTION controlp INFIELD apcb014
            {<point name="input.c.apcb014" />}
            #END add-point
 
         #----<<apcb014_desc>>----
         #----<<apcb024>>----
         #Ctrlp:input.c.apcb024
         ON ACTION controlp INFIELD apcb024
            #add-point:ON ACTION controlp INFIELD apcb024
            {<point name="input.c.apcb024" />}
            #END add-point
 
         #----<<apcb024_desc>>----
         #----<<apcb021>>----
         #Ctrlp:input.c.apcb021
         ON ACTION controlp INFIELD apcb021
            #add-point:ON ACTION controlp INFIELD apcb021
            {<point name="input.c.apcb021" />}
            #END add-point
 
         #----<<apcb021_desc>>----
         #----<<apcb015>>----
         #Ctrlp:input.c.apcb015
         ON ACTION controlp INFIELD apcb015
            #add-point:ON ACTION controlp INFIELD apcb015
            {<point name="input.c.apcb015" />}
            #END add-point
 
         #----<<apcb015_desc>>----
         #----<<apcb016>>----
         #Ctrlp:input.c.apcb016
         ON ACTION controlp INFIELD apcb016
            #add-point:ON ACTION controlp INFIELD apcb016
            {<point name="input.c.apcb016" />}
            #END add-point
 
         #----<<apcb017>>----
         #Ctrlp:input.c.apcb017
         ON ACTION controlp INFIELD apcb017
            #add-point:ON ACTION controlp INFIELD apcb017
            {<point name="input.c.apcb017" />}
            #END add-point
 
         #----<<apcb017_desc>>----
         #----<<apcb028>>----
         #Ctrlp:input.c.apcb028
         ON ACTION controlp INFIELD apcb028
            #add-point:ON ACTION controlp INFIELD apcb028
            {<point name="input.c.apcb028" />}
            #END add-point
 
 #欄位開窗
 
         AFTER INPUT
            #add-point:單頭輸入後處理
            {<point name="input.after_input"/>}
            #end add-point
            
      END INPUT
    
      #add-point:自定義input
      {<point name="input.more_input"/>}
      #end add-point
    
      #公用action
      ON ACTION accept
         ACCEPT DIALOG
        
      ON ACTION cancel
         LET INT_FLAG = TRUE 
         EXIT DIALOG
 
      ON ACTION close
         LET INT_FLAG = TRUE 
         EXIT DIALOG
 
      ON ACTION exit
         LET INT_FLAG = TRUE 
         EXIT DIALOG
   
      #交談指令共用ACTION
      &include "common_action.4gl" 
         CONTINUE DIALOG 
   END DIALOG
 
   #add-point:畫面關閉前
   {<point name="input.before_close"/>}
   #end add-point
   
   #畫面關閉
   CLOSE WINDOW w_aapt300_12 
   
   #add-point:input段after input 
   {<point name="input.post_input"/>}
   #end add-point    
   
END FUNCTION
]]>
</section>
  <section id="aapt300_12.other_dialog" ver="1" status="" src="s">
<![CDATA[{<point name="other.dialog"/>}
]]>
</section>
  <section id="aapt300_12.other_function" ver="2" status="" src="s">
<![CDATA[{<point name="other.function"/>}
]]>
</section>
</add_points>