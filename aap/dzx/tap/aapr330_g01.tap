<add_points prog="aapr330_g01" std_prog="aapr330_g01" erpver="1.0" module="AAP" ver="1" env="s" zone="t10dev" booking="Y">
  <point name="report.aapr330_g01_subrep05" cite_std="N" status="d" ver="1" src="s" new="N" order="2" mark_hard="N">
<![CDATA[
PRIVATE REPORT aapr330_g01_subrep05(sr5)
DEFINE sr9  sr9_r
    FORMAT
          
        ON EVERY ROW
            
            PRINTX sr9.*
END REPORT]]>
</point>
  <point name="report.aapr330_g01_subrep04" cite_std="N" status="d" ver="1" src="s" new="N" order="3" mark_hard="N">
<![CDATA[
PRIVATE REPORT aapr330_g01_subrep04(sr4,p_docno,p_ent)
DEFINE sr8         sr8_r
DEFINE p_docno     LIKE apca_t.apcadocno
DEFINE p_ent       LIKE apca_t.apcaent
DEFINE l_isam028   LIKE isam_t.isam028

    FORMAT
        ON LAST ROW
           SELECT SUM(isam028) INTO l_isam028
             FROM isam_t
            WHERE isamdocno = p_docno 
              AND isament   = p_ent
           
           PRINTX l_isam028
           
        ON EVERY ROW
            
            PRINTX sr8.*
END REPORT]]>
</point>
  <point name="report.aapr330_g01_subrep03" cite_std="N" status="d" ver="1" src="s" new="N" order="1" mark_hard="N">
<![CDATA[
PRIVATE REPORT aapr330_g01_subrep03(sr3_1)
DEFINE sr7_1  sr7_r
    FORMAT
           
        ON EVERY ROW
            
            PRINTX sr7_1.*
END REPORT]]>
</point>
  <point name="report.aapr330_g01_subrep02" cite_std="N" status="d" ver="1" src="s" new="N" order="6" mark_hard="N">
<![CDATA[
PRIVATE REPORT aapr330_g01_subrep02(sr3)
DEFINE sr7  sr7_r
    FORMAT
               
        ON EVERY ROW
            
            PRINTX sr7.*
END REPORT]]>
</point>
  <point name="report.aapr330_g01_subrep01" cite_std="N" status="d" ver="1" src="s" new="N" order="5" mark_hard="N">
<![CDATA[
PRIVATE REPORT aapr330_g01_subrep01(sr2)
#apcc_t
DEFINE sr6 sr6_r

    FORMAT
    
           
        ON EVERY ROW
            
            PRINTX sr6.*
END REPORT]]>
</point>
  <point name="report.aapr330_g01_subrep07" cite_std="N" status="u" ver="1" src="s" new="N" order="1" mark_hard="N">
<![CDATA[
PRIVATE REPORT aapr330_g01_subrep07(sr7_1)
DEFINE sr7_1  sr7_r
    FORMAT
           
        ON EVERY ROW
            
            PRINTX sr7_1.*
END REPORT]]>
</point>
  <point name="report.aapr330_g01_subrep09" cite_std="N" status="u" ver="1" src="s" new="N" order="2" mark_hard="N">
<![CDATA[
PRIVATE REPORT aapr330_g01_subrep09(sr9)
DEFINE sr9  sr9_r
    FORMAT
          
        ON EVERY ROW
            
            PRINTX sr9.*
END REPORT]]>
</point>
  <point name="report.aapr330_g01_subrep08" cite_std="N" status="u" ver="1" src="s" new="N" order="3" mark_hard="N">
<![CDATA[
PRIVATE REPORT aapr330_g01_subrep08(sr8,p_docno,p_ent)
DEFINE sr8         sr8_r
DEFINE p_docno     LIKE apca_t.apcadocno
DEFINE p_ent       LIKE apca_t.apcaent
DEFINE l_isam028   LIKE isam_t.isam028

    FORMAT
        ON LAST ROW
           SELECT SUM(isam028) INTO l_isam028
             FROM isam_t
            WHERE isamdocno = p_docno 
              AND isament   = p_ent
           
           PRINTX l_isam028
           
        ON EVERY ROW
            
            PRINTX sr8.*
END REPORT]]>
</point>
  <point name="report.aapr330_g01_subrep05" cite_std="N" status="u" ver="1" src="s" new="N" order="5" mark_hard="N">
<![CDATA[
PRIVATE REPORT aapr330_g01_subrep05(sr6)
#apcc_t
DEFINE sr6 sr6_r

    FORMAT
    
           
        ON EVERY ROW
            
            PRINTX sr6.*
END REPORT]]>
</point>
  <point name="report.aapr330_g01_subrep06" cite_std="N" status="u" ver="1" src="s" new="N" order="6" mark_hard="N">
<![CDATA[
PRIVATE REPORT aapr330_g01_subrep06(sr7)
DEFINE sr7  sr7_r
    FORMAT
               
        ON EVERY ROW
            
            PRINTX sr7.*
END REPORT]]>
</point>
  <point name="component.get_var" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[p_arg1]]>
</point>
  <point name="global.variable" cite_std="N" status="u" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[TYPE sr6_r RECORD
   apcc002   LIKE apcc_t.apcc002,
   l_apcc002 LIKE type_t.chr500,
   apcc003   LIKE apcc_t.apcc003,
   glaa001   LIKE glaa_t.glaa001,
   apcc118   LIKE apcc_t.apcc118
END RECORD
TYPE sr7_r RECORD
   apceseq   LIKE apce_t.apceseq,
   apce002   LIKE apce_t.apce002,
   l_apce002 LIKE type_t.chr500,
   apce100   LIKE apce_t.apce100,
   apce109   LIKE apce_t.apce109,
   apce101   LIKE apce_t.apce101,
   apce119   LIKE apce_t.apce119,
   apce003   LIKE apce_t.apce003,
   apce004   LIKE apce_t.apce004,
   apce010   LIKE apce_t.apce010,
   apce008   LIKE apce_t.apce008
END RECORD
TYPE sr8_r RECORD
   isamseq   LIKE isam_t.isamseq,
   isam008   LIKE isam_t.isam008,
   l_isam008 LIKE type_t.chr500,
   isam009   LIKE isam_t.isam009,
   isam010   LIKE isam_t.isam010,
   isam011   LIKE isam_t.isam011,
   isam014   LIKE isam_t.isam014,
   isam026   LIKE isam_t.isam026,
   isam015   LIKE isam_t.isam015,
   isam028   LIKE isam_t.isam028
END RECORD
TYPE sr9_r RECORD
   apcb100 LIKE apcb_t.apcb100,
   apcb105 LIKE apcb_t.apcb105,
   glaa001 LIKE glaa_t.glaa001,
   apcb115 LIKE apcb_t.apcb115
END RECORD]]>
</point>
  <point name="ins_data.after" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[    ]]>
</point>
  <point name="ins_data.after.save" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[
]]>
</point>
  <point name="ins_data.before" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[   LET l_sql = " SELECT apca003,apca007,apca014,apca015,apca057,apcasite",
               "   FROM apca_t", g_where CLIPPED
   PREPARE sel_data FROM l_sql
   EXECUTE sel_data INTO l_apca003,l_apca007,l_apca014,l_apca015,l_apca057,l_apcasite
   
   LET l_apca007_desc = s_desc_get_acc_desc('3211',l_apca007) CLIPPED
   LET l_apca003_desc = l_apca003 CLIPPED,".",s_desc_get_person_desc(l_apca003) CLIPPED
   LET l_apca014_desc = l_apca014 CLIPPED,".",s_desc_get_person_desc(l_apca014)  CLIPPED
   LET l_apca015_desc = l_apca015 CLIPPED,".",s_desc_get_department_desc(l_apca015)  CLIPPED
   LET l_apca057_desc = l_apca057 CLIPPED,".",s_desc_get_person_desc(l_apca057) CLIPPED
   LET l_apcasite_desc = s_desc_get_department_desc(l_apcasite) CLIPPED]]>
</point>
  <point name="ins_data.before.save" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[       LET sr_s.l_apca007 = l_apca007_desc
       LET sr_s.l_apca003 = l_apca003_desc
       LET sr_s.l_apca014 = l_apca014_desc
       LET sr_s.l_apca015 = l_apca015_desc
       LET sr_s.l_apca057 = l_apca057_desc
       LET sr_s.l_apcasite = l_apcasite_desc]]>
</point>
  <point name="ins_data.define" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[DEFINE l_sql           STRING
DEFINE l_apca003       LIKE apca_t.apca003
DEFINE l_apca007       LIKE apca_t.apca007
DEFINE l_apca014       LIKE apca_t.apca014
DEFINE l_apca015       LIKE apca_t.apca015
DEFINE l_apca057       LIKE apca_t.apca057
DEFINE l_apcasite      LIKE apca_t.apcasite
DEFINE l_apca003_desc  LIKE type_t.chr500
DEFINE l_apca007_desc  LIKE type_t.chr500
DEFINE l_apca014_desc  LIKE type_t.chr500
DEFINE l_apca015_desc  LIKE type_t.chr500
DEFINE l_apca057_desc  LIKE type_t.chr500
DEFINE l_apcasite_desc LIKE type_t.chr500
DEFINE l_str           LIKE type_t.chr500]]>
</point>
  <point name="rep.a_group.apcadocno.before" cite_std="N" status="u" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[            #合計金額
            LET l_sql = "SELECT apcb100,sum(apcb105),'',NULL ",
                        "  FROM apcb_t ",
                        " WHERE apcbdocno = '",sr1.apcadocno CLIPPED,"'",
                        "   AND apcbld    = '",sr1.apcald    CLIPPED,"'",
                        "   AND apcbent   = '",sr1.apcaent   CLIPPED,"'",
                        " GROUP BY apcb100"
           
           START REPORT aapr330_g01_subrep09
           DECLARE apcb_repcur1 CURSOR FROM l_sql
           LET i = 0
           FOREACH apcb_repcur1 INTO sr9.*
               IF i = 0 THEN
                  LET i = 1
                  SELECT glaa001      INTO sr9.glaa001
                    FROM glaa_t
                   WHERE glaaent = sr1.apcaent AND glaald = sr1.apcald
                  SELECT SUM(apcb115) INTO sr9.apcb115
                    FROM apcb_t
                   WHERE apcbent = sr1.apcaent AND apcbld = sr1.apcald
                     AND apcbdocno = sr1.apcadocno
               END IF
               OUTPUT TO REPORT aapr330_g01_subrep09(sr9.*)
           END FOREACH
           FINISH REPORT aapr330_g01_subrep09
           #預支沖銷
           LET l_sql = "SELECT apceseq,apce002,(SELECT gzcbl004 FROM gzcbl_t WHERE gzcbl001 = '8506' AND gzcbl002 = apce002 AND gzcbl003 = '",g_dlang,"'),",
                       "       apce100,apce109,apce101,apce119,apce003,",
                       "       apce004,apce010,apce008",
                       "  FROM apce_t ",
                       " WHERE apcedocno = '",sr1.apcadocno CLIPPED,"'",
                       "   AND apceld    = '",sr1.apcald    CLIPPED,"'",
                       "   AND apceent   = '",sr1.apcaent   CLIPPED,"'",
                       "   AND apce002   IN ('30','41')",
                       " ORDER BY apceseq"
           START REPORT aapr330_g01_subrep06
           DECLARE apce_repcur1 CURSOR FROM l_sql
           FOREACH apce_repcur1 INTO sr7.*
               OUTPUT TO REPORT aapr330_g01_subrep06(sr7.*)
           END FOREACH
           FINISH REPORT aapr330_g01_subrep06
           #繳回款項
           LET l_sql = "SELECT apceseq,apce002,(SELECT gzcbl004 FROM gzcbl_t WHERE gzcbl001 = '8506' AND gzcbl002 = apce002 AND gzcbl003 = '",g_dlang,"'),",
                       "       apce100,apce109,apce101,apce119,apce003,",
                       "       apce004,apce010,apce008",
                       "  FROM apce_t ",
                       " WHERE apcedocno = '",sr1.apcadocno CLIPPED,"'",
                       "   AND apceld    = '",sr1.apcald    CLIPPED,"'",
                       "   AND apceent   = '",sr1.apcaent   CLIPPED,"'",
                       "   AND apce002   ='17'",
                       " ORDER BY apceseq"
           START REPORT aapr330_g01_subrep07
           DECLARE apce_repcur2 CURSOR FROM l_sql
           FOREACH apce_repcur2 INTO sr7_1.*
               OUTPUT TO REPORT aapr330_g01_subrep07(sr7_1.*)
           END FOREACH
           FINISH REPORT aapr330_g01_subrep07           
           #發票/收據
           LET l_sql = "SELECT isamseq,isam008,'',",
                       "       isam009,isam010,isam011,isam014,isam026,isam015,isam028 ",
                       "  FROM isam_t ",
                       " WHERE isamdocno = '",sr1.apcadocno CLIPPED,"'",
                       "   AND isament   = '",sr1.apcaent   CLIPPED,"'",
                       " ORDER BY isamseq"
           START REPORT aapr330_g01_subrep08
           DECLARE isam_repcur CURSOR FROM l_sql
           FOREACH isam_repcur INTO sr8.*
               OUTPUT TO REPORT aapr330_g01_subrep08(sr8.*,sr1.apcadocno,sr1.apcaent)
           END FOREACH
           FINISH REPORT aapr330_g01_subrep08      ]]>
</point>
  <point name="rep.apr.signstr" cite_std="N" status="u" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[
           LET l_sql = "SELECT apcc002,(SELECT ooibl004 FROM ooibl_t WHERE ooiblent = apccent AND ooibl002 = apcc002 AND ooibl003 = '",g_dlang,"'),",
                       "       apcc003,'',apcc118 ",
                       "  FROM apcc_t ",
                       " WHERE apccdocno = '",sr1.apcadocno CLIPPED,"'",
                       "   AND apccld    = '",sr1.apcald    CLIPPED,"'",
                       "   AND apccent   = '",sr1.apcaent   CLIPPED,"'",
                       "   AND apccseq = 1"
           START REPORT aapr330_g01_subrep05
           DECLARE apcc_repcur1 CURSOR FROM l_sql
           FOREACH apcc_repcur1 INTO sr6.*
               SELECT glaa001      INTO sr6.glaa001
                 FROM glaa_t
                WHERE glaaent = sr1.apcaent AND glaald = sr1.apcald

               OUTPUT TO REPORT aapr330_g01_subrep05(sr6.*)
           END FOREACH
           FINISH REPORT aapr330_g01_subrep05
]]>
</point>
  <point name="rep.define" cite_std="N" status="u" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[DEFINE l_sql     STRING
DEFINE sr6       sr6_r
DEFINE sr7       sr7_r
DEFINE sr7_1     sr7_r
DEFINE sr8       sr8_r
DEFINE sr9       sr9_r
DEFINE i         INTEGER]]>
</point>
  <point name="rep.everyrow.afterrow" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[]]>
</point>
  <point name="rep.everyrow.beforerow" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[]]>
</point>
  <point name="rep.lastrow.before" cite_std="N" status="" ver="1" src="s" new="N" mark_hard="N">
<![CDATA[]]>
</point>
  <point name="global.import" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="component_name.define" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="component.arg.prep" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="sel_prep.define" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="sel_prep.before" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="sel_prep.g_select" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="sel_prep.g_from" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="sel_prep.g_where" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="sel_prep.g_order" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="ins_data.foreach" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="rep.header" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="rep.b_group.apcadocno.before" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="rep.sub01.before" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="rep.sub01.sql" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="rep.sub01.foreach" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="rep.sub01.after" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="rep.b_group.apcadocno.after" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="rep.b_group.apcbseq.before" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="rep.b_group.apcbseq.after" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="rep.everyrow.before" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="rep.sub02.before" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="rep.sub02.sql" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="rep.sub02.foreach" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="rep.sub02.after" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="rep.sub03.before" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="rep.sub03.sql" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="rep.sub03.foreach" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="rep.sub03.after" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="rep.everyrow.after" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="rep.sub04.before" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="rep.sub04.sql" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="rep.sub04.foreach" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="rep.sub04.after" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="rep.a_group.apcadocno.after" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="rep.a_group.apcbseq.before" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="rep.a_group.apcbseq.after" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="rep.lastrow.after" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="sub01.define" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="sub01.order.before" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="sub01.everyrow.before" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="sub01.everyrow.after" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="sub02.define" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="sub02.order.before" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="sub02.everyrow.before" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="sub02.everyrow.after" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="sub03.define" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="sub03.order.before" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="sub03.everyrow.before" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="sub03.everyrow.after" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="sub04.define" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="sub04.order.before" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="sub04.everyrow.before" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <point name="sub04.everyrow.after" cite_std="N" status="" ver="" src="s" new="Y">
<![CDATA[]]>
</point>
  <section id="aapr330_g01.description" ver="86" status="" src="s">
<![CDATA[#+ Version..: T100-ERP-1.00.00(SD版次:1,PD版次:) Build-000089
#+ 
#+ Filename...: aapr330_g01
#+ Description: 費用報支單列印
#+ Creator....: 02097(2014/04/23)
#+ Modifier...: 02716(2014/06/23)
#+ Buildtype..: 應用 g01 樣板自動產生
#+ 以上段落由子樣板a00產生
]]>
</section>
  <section id="aapr330_g01.global" ver="7" status="" src="s">
<![CDATA[ 
IMPORT os
#add-point:增加匯入項目
{<point name="global.import" />}
#end add-point
 
SCHEMA ds
 
GLOBALS "../../cfg/top_global.inc"
GLOBALS "../../cfg/top_report.inc"                  #報表使用的global
 
#報表 type 宣告
PRIVATE TYPE sr1_r RECORD
   apcadocdt LIKE apca_t.apcadocdt, 
   apcadocno LIKE apca_t.apcadocno, 
   apca050 LIKE apca_t.apca050, 
   apca053 LIKE apca_t.apca053, 
   apcaent LIKE apca_t.apcaent, 
   apcald LIKE apca_t.apcald, 
   apcb005 LIKE apcb_t.apcb005, 
   apcb100 LIKE apcb_t.apcb100, 
   apcb101 LIKE apcb_t.apcb101, 
   apcb105 LIKE apcb_t.apcb105, 
   apcb115 LIKE apcb_t.apcb115, 
   apcb007 LIKE apcb_t.apcb007, 
   apcb008 LIKE apcb_t.apcb008, 
   apcb009 LIKE apcb_t.apcb009, 
   apcb023 LIKE apcb_t.apcb023, 
   apcbld LIKE apcb_t.apcbld, 
   apcbent LIKE apcb_t.apcbent, 
   apcbseq LIKE apcb_t.apcbseq, 
   apcbdocno LIKE apcb_t.apcbdocno, 
   l_apca014 LIKE type_t.chr500, 
   l_apca015 LIKE type_t.chr500, 
   l_apca007 LIKE type_t.chr500, 
   l_apca057 LIKE type_t.chr500, 
   l_apcasite LIKE type_t.chr500, 
   l_apca003 LIKE type_t.chr500
END RECORD
 
PRIVATE TYPE sr2_r RECORD
   ooff013 LIKE ooff_t.ooff013
END RECORD
 
 
DEFINE tm RECORD
       wc STRING                   #condition
       END RECORD
DEFINE sr DYNAMIC ARRAY OF sr1_r                   #宣告sr為sr1_t資料結構的動態陣列
DEFINE g_select        STRING
DEFINE g_from          STRING
DEFINE g_where         STRING
DEFINE g_order         STRING
DEFINE g_sql           STRING                         #report_select_prep,REPORT段使用
 
#add-point:自定義環境變數(Global Variable)
{<point name="global.variable"/>}
#end add-point
]]>
</section>
  <section id="aapr330_g01.ins_data" ver="6" status="" src="s">
<![CDATA[PRIVATE FUNCTION aapr330_g01_ins_data()
#主報表record(用於select子句)
DEFINE sr_s RECORD 
   apca001 LIKE apca_t.apca001, 
   apca003 LIKE apca_t.apca003, 
   apca007 LIKE apca_t.apca007, 
   apca014 LIKE apca_t.apca014, 
   apca015 LIKE apca_t.apca015, 
   apca057 LIKE apca_t.apca057, 
   apcacomp LIKE apca_t.apcacomp, 
   apcadocdt LIKE apca_t.apcadocdt, 
   apcadocno LIKE apca_t.apcadocno, 
   apca050 LIKE apca_t.apca050, 
   apca053 LIKE apca_t.apca053, 
   apcaent LIKE apca_t.apcaent, 
   apcald LIKE apca_t.apcald, 
   apcasite LIKE apca_t.apcasite, 
   apcastus LIKE apca_t.apcastus, 
   apcb005 LIKE apcb_t.apcb005, 
   apcb100 LIKE apcb_t.apcb100, 
   apcb101 LIKE apcb_t.apcb101, 
   apcb105 LIKE apcb_t.apcb105, 
   apcb115 LIKE apcb_t.apcb115, 
   apcb007 LIKE apcb_t.apcb007, 
   apcb008 LIKE apcb_t.apcb008, 
   apcb009 LIKE apcb_t.apcb009, 
   apcb023 LIKE apcb_t.apcb023, 
   apcbld LIKE apcb_t.apcbld, 
   apcbent LIKE apcb_t.apcbent, 
   apcbseq LIKE apcb_t.apcbseq, 
   apcbdocno LIKE apcb_t.apcbdocno, 
   l_apca014 LIKE type_t.chr500, 
   l_apca015 LIKE type_t.chr500, 
   l_apca007 LIKE type_t.chr500, 
   l_apca057 LIKE type_t.chr500, 
   l_apcasite LIKE type_t.chr500, 
   l_apca003 LIKE type_t.chr500
 END RECORD
DEFINE l_cnt           INTEGER
#add-point:ins_data段define
{<point name="ins_data.define"/>}
#end add-point
 
    #add-point:ins_data段before
    {<point name="ins_data.before"/>}
    #end add-point
 
    CALL sr.clear()                                  #rep sr
    LET l_cnt = 1
    FOREACH aapr330_g01_curs INTO sr_s.*
       IF STATUS THEN
          CALL cl_err('foreach:',STATUS,1)
          EXIT FOREACH
       END IF
 
       #add-point:ins_data段foreach
       {<point name="ins_data.foreach"/>}
       #end add-point
 
       #add-point:ins_data段before_arr
       {<point name="ins_data.before.save"/>}
       #end add-point
 
       #set rep array value
       LET sr[l_cnt].apcadocdt = sr_s.apcadocdt
       LET sr[l_cnt].apcadocno = sr_s.apcadocno
       LET sr[l_cnt].apca050 = sr_s.apca050
       LET sr[l_cnt].apca053 = sr_s.apca053
       LET sr[l_cnt].apcaent = sr_s.apcaent
       LET sr[l_cnt].apcald = sr_s.apcald
       LET sr[l_cnt].apcb005 = sr_s.apcb005
       LET sr[l_cnt].apcb100 = sr_s.apcb100
       LET sr[l_cnt].apcb101 = sr_s.apcb101
       LET sr[l_cnt].apcb105 = sr_s.apcb105
       LET sr[l_cnt].apcb115 = sr_s.apcb115
       LET sr[l_cnt].apcb007 = sr_s.apcb007
       LET sr[l_cnt].apcb008 = sr_s.apcb008
       LET sr[l_cnt].apcb009 = sr_s.apcb009
       LET sr[l_cnt].apcb023 = sr_s.apcb023
       LET sr[l_cnt].apcbld = sr_s.apcbld
       LET sr[l_cnt].apcbent = sr_s.apcbent
       LET sr[l_cnt].apcbseq = sr_s.apcbseq
       LET sr[l_cnt].apcbdocno = sr_s.apcbdocno
       LET sr[l_cnt].l_apca014 = sr_s.l_apca014
       LET sr[l_cnt].l_apca015 = sr_s.l_apca015
       LET sr[l_cnt].l_apca007 = sr_s.l_apca007
       LET sr[l_cnt].l_apca057 = sr_s.l_apca057
       LET sr[l_cnt].l_apcasite = sr_s.l_apcasite
       LET sr[l_cnt].l_apca003 = sr_s.l_apca003
 
 
       #add-point:ins_data段after_arr
       {<point name="ins_data.after.save"/>}
       #end add-point
       LET l_cnt = l_cnt + 1
    END FOREACH
    CALL sr.deleteElement(l_cnt)
 
    #add-point:ins_data段after
    {<point name="ins_data.after"/>}
    #end add-point
END FUNCTION
]]>
</section>
  <section id="aapr330_g01.main" ver="2" status="" src="s">
<![CDATA[PUBLIC FUNCTION aapr330_g01(--)
   #add-point:component段變數傳入
   {<point name="component.get_var"/>}
   #end add-point
   )
DEFINE  p_arg1 STRING                  #tm.wc  condition
#add-point:init段define
{<point name="component_name.define"/>}
#end add-point
 
   LET tm.wc = p_arg1
 
   #add-point:報表元件參數準備
   {<point name="component.arg.prep" />}
   #end add-point
   #報表元件代號
   LET g_rep_code = "aapr330_g01"
   IF cl_null(tm.wc) THEN LET tm.wc = " 1=1" END IF
 
   #主報表select子句準備
   CALL aapr330_g01_sel_prep()
 
   #將資料存入array
   CALL aapr330_g01_ins_data()
 
   #將資料印出
   CALL aapr330_g01_rep_data()
 
END FUNCTION
]]>
</section>
  <section id="aapr330_g01.other_function" ver="1" status="" src="s">
<![CDATA[{<point name="other.function"/>}
]]>
</section>
  <section id="aapr330_g01.other_report" ver="1" status="" src="s">
<![CDATA[{<point name="other.report"/>}
]]>
</section>
  <section id="aapr330_g01.rep" ver="8" status="" src="s">
<![CDATA[PRIVATE REPORT aapr330_g01_rep(sr1)
DEFINE sr1 sr1_r
DEFINE sr2 sr2_r
DEFINE l_subrep01_show  LIKE type_t.chr1,
       l_subrep02_show  LIKE type_t.chr1,
       l_subrep03_show  LIKE type_t.chr1,
       l_subrep04_show  LIKE type_t.chr1
DEFINE l_cnt           LIKE type_t.num5
DEFINE l_sub_sql       STRING
#add-point:rep段define
{<point name="rep.define"/>}
#end add-point
 
    ORDER  BY sr1.apcadocno,sr1.apcbseq
    
    FORMAT
        FIRST PAGE HEADER
 
            #add-point:rep.header  #公司資訊(不在公用變數內)
            {<point name="rep.header"/>}
            #end add-point:rep.header
            PRINTX g_grPageHeader.*
            PRINTX g_user,g_pdate,g_prog,g_company,g_ptime,g_user_name
            PRINTX tm.*
            PRINTX g_grNumFmt.*
 
            #讀取beforeGrup子樣板+子報表樣板
        BEFORE GROUP OF sr1.apcadocno
            CALL cl_gr_init_apr(sr1.apcadocno)
            #add-point:rep.apr.signstr
            {<point name="rep.apr.signstr"/>}              
            #end add-point:rep.apr.signstr
            PRINTX g_grSign.*
 
 
 
           #add-point:rep.b_group.apcadocno.before
           {<point name="rep.b_group.apcadocno.before"/>}
           #end add-point:
 
           #add-point:rep.sub01.before
           {<point name="rep.sub01.before"/>}
           #end add-point:rep.sub01.before
 
           #add-point:rep.sub01.sql
           {<point name="rep.sub01.sql"/>}
           #end add-point:rep.sub01.sql
 
           LET g_sql = " SELECT ooff013 FROM ooff_t WHERE ooffstus='Y' and ooff001='6' AND ooff012='2' AND ooffent = '", 
                sr1.apcaent CLIPPED ,"'", " AND  ooff002 = '", sr1.apcadocno CLIPPED ,"'"
 
           LET l_cnt = 0
           LET l_sub_sql = ""
           LET l_subrep01_show ="N"
           LET l_sub_sql = "SELECT COUNT(1) FROM (",g_sql,")"
           PREPARE aapr330_g01_repcur01_cnt_pre FROM l_sub_sql
           EXECUTE aapr330_g01_repcur01_cnt_pre INTO l_cnt
           IF l_cnt > 0 THEN 
              LET l_subrep01_show ="Y"
           END IF
           PRINTX l_subrep01_show
           START REPORT aapr330_g01_subrep01
           DECLARE aapr330_g01_repcur01 CURSOR FROM g_sql
           FOREACH aapr330_g01_repcur01 INTO sr2.*
              IF STATUS THEN CALL cl_err('aapr330_g01_repcur01:',STATUS,1) EXIT FOREACH END IF
              #add-point:rep.sub01.foreach
              {<point name="rep.sub01.foreach"/>}
              #end add-point:rep.sub01.foreach
              OUTPUT TO REPORT aapr330_g01_subrep01(sr2.*)
              END FOREACH
           FINISH REPORT aapr330_g01_subrep01
           #add-point:rep.sub01.after
           {<point name="rep.sub01.after"/>}
           #end add-point:rep.sub01.after
 
 
 
           #add-point:rep.b_group.apcadocno.after
           {<point name="rep.b_group.apcadocno.after"/>}
           #end add-point:
 
 
        BEFORE GROUP OF sr1.apcbseq
 
           #add-point:rep.b_group.apcbseq.before
           {<point name="rep.b_group.apcbseq.before"/>}
           #end add-point:
 
 
           #add-point:rep.b_group.apcbseq.after
           {<point name="rep.b_group.apcbseq.after"/>}
           #end add-point:
 
 
 
 
        ON EVERY ROW
            #add-point:rep.everyrow.before
            {<point name="rep.everyrow.before"/>}
            #end add-point:rep.everyrow.before
 
             #單身前備註
             #add-point:rep.sub02.before
           {<point name="rep.sub02.before"/>}
           #end add-point:rep.sub02.before
 
           #add-point:rep.sub02.sql
           {<point name="rep.sub02.sql"/>}
           #end add-point:rep.sub02.sql
 
           LET g_sql = " SELECT ooff013 FROM ooff_t WHERE ooffstus='Y' and ooff001='7' AND ooff012='2' AND ooffent = '", 
                sr1.apcaent CLIPPED ,"'", " AND  ooff002 = '", sr1.apcadocno CLIPPED ,"'", " AND  ooff003 = '", 
                sr1.apcbseq CLIPPED ,"'"
 
           LET l_cnt = 0
           LET l_sub_sql = ""
           LET l_subrep02_show ="N"
           LET l_sub_sql = "SELECT COUNT(1) FROM (",g_sql,")"
           PREPARE aapr330_g01_repcur02_cnt_pre FROM l_sub_sql
           EXECUTE aapr330_g01_repcur02_cnt_pre INTO l_cnt
           IF l_cnt > 0 THEN 
              LET l_subrep02_show ="Y"
           END IF
           PRINTX l_subrep02_show
           START REPORT aapr330_g01_subrep02
           DECLARE aapr330_g01_repcur02 CURSOR FROM g_sql
           FOREACH aapr330_g01_repcur02 INTO sr2.*
              IF STATUS THEN CALL cl_err('aapr330_g01_repcur02:',STATUS,1) EXIT FOREACH END IF
              #add-point:rep.sub02.foreach
              {<point name="rep.sub02.foreach"/>}
              #end add-point:rep.sub02.foreach
              OUTPUT TO REPORT aapr330_g01_subrep02(sr2.*)
              END FOREACH
           FINISH REPORT aapr330_g01_subrep02
           #add-point:rep.sub02.after
           {<point name="rep.sub02.after"/>}
           #end add-point:rep.sub02.after
 
 
 
            #add-point:rep.everyrow.beforerow
            {<point name="rep.everyrow.beforerow"/>}
            #end add-point:rep.everyrow.beforerow
            
            PRINTX sr1.*
 
            #add-point:rep.everyrow.afterrow
            {<point name="rep.everyrow.afterrow"/>}
            #end add-point:rep.everyrow.afterrow
 
             #單身後備註
             #add-point:rep.sub03.before
           {<point name="rep.sub03.before"/>}
           #end add-point:rep.sub03.before
 
           #add-point:rep.sub03.sql
           {<point name="rep.sub03.sql"/>}
           #end add-point:rep.sub03.sql
 
           LET g_sql = " SELECT ooff013 FROM ooff_t WHERE ooffstus='Y' and ooff001='7' AND ooff012='1' AND ooffent = '", 
                sr1.apcaent CLIPPED ,"'", " AND  ooff002 = '", sr1.apcadocno CLIPPED ,"'", " AND  ooff003 = '", 
                sr1.apcbseq CLIPPED ,"'"
 
           LET l_cnt = 0
           LET l_sub_sql = ""
           LET l_subrep03_show ="N"
           LET l_sub_sql = "SELECT COUNT(1) FROM (",g_sql,")"
           PREPARE aapr330_g01_repcur03_cnt_pre FROM l_sub_sql
           EXECUTE aapr330_g01_repcur03_cnt_pre INTO l_cnt
           IF l_cnt > 0 THEN 
              LET l_subrep03_show ="Y"
           END IF
           PRINTX l_subrep03_show
           START REPORT aapr330_g01_subrep03
           DECLARE aapr330_g01_repcur03 CURSOR FROM g_sql
           FOREACH aapr330_g01_repcur03 INTO sr2.*
              IF STATUS THEN CALL cl_err('aapr330_g01_repcur03:',STATUS,1) EXIT FOREACH END IF
              #add-point:rep.sub03.foreach
              {<point name="rep.sub03.foreach"/>}
              #end add-point:rep.sub03.foreach
              OUTPUT TO REPORT aapr330_g01_subrep03(sr2.*)
              END FOREACH
           FINISH REPORT aapr330_g01_subrep03
           #add-point:rep.sub03.after
           {<point name="rep.sub03.after"/>}
           #end add-point:rep.sub03.after
 
 
 
            #add-point:rep.everyrow.after
            {<point name="rep.everyrow.after"/>}
            #end add-point:rep.everyrow.after        
 
        #讀取afterGrup子樣板+子報表樣板
        AFTER GROUP OF sr1.apcadocno
 
           #add-point:rep.a_group.apcadocno.before
           {<point name="rep.a_group.apcadocno.before"/>}
           #end add-point:
 
           #add-point:rep.sub04.before
           {<point name="rep.sub04.before"/>}
           #end add-point:rep.sub04.before
 
           #add-point:rep.sub04.sql
           {<point name="rep.sub04.sql"/>}
           #end add-point:rep.sub04.sql
 
           LET g_sql = " SELECT ooff013 FROM ooff_t WHERE ooffstus='Y' and ooff001='6' AND ooff012='1' AND ooffent = '", 
                sr1.apcaent CLIPPED ,"'", " AND  ooff002 = '", sr1.apcadocno CLIPPED ,"'"
 
           LET l_cnt = 0
           LET l_sub_sql = ""
           LET l_subrep04_show ="N"
           LET l_sub_sql = "SELECT COUNT(1) FROM (",g_sql,")"
           PREPARE aapr330_g01_repcur04_cnt_pre FROM l_sub_sql
           EXECUTE aapr330_g01_repcur04_cnt_pre INTO l_cnt
           IF l_cnt > 0 THEN 
              LET l_subrep04_show ="Y"
           END IF
           PRINTX l_subrep04_show
           START REPORT aapr330_g01_subrep04
           DECLARE aapr330_g01_repcur04 CURSOR FROM g_sql
           FOREACH aapr330_g01_repcur04 INTO sr2.*
              IF STATUS THEN CALL cl_err('aapr330_g01_repcur04:',STATUS,1) EXIT FOREACH END IF
              #add-point:rep.sub04.foreach
              {<point name="rep.sub04.foreach"/>}
              #end add-point:rep.sub04.foreach
              OUTPUT TO REPORT aapr330_g01_subrep04(sr2.*)
              END FOREACH
           FINISH REPORT aapr330_g01_subrep04
           #add-point:rep.sub04.after
           {<point name="rep.sub04.after"/>}
           #end add-point:rep.sub04.after
 
 
 
           #add-point:rep.a_group.apcadocno.after
           {<point name="rep.a_group.apcadocno.after"/>}
           #end add-point:
 
 
        AFTER GROUP OF sr1.apcbseq
 
           #add-point:rep.a_group.apcbseq.before
           {<point name="rep.a_group.apcbseq.before"/>}
           #end add-point:
 
 
           #add-point:rep.a_group.apcbseq.after
           {<point name="rep.a_group.apcbseq.after"/>}
           #end add-point:
 
 
 
        ON LAST ROW
            #add-point:rep.lastrow.before  
            {<point name="rep.lastrow.before"/>}        
            #edn add point :rep.lastrow.before
 
            #add-point:rep.lastrow.after
            {<point name="rep.lastrow.after"/>}
            #edn add point :rep.lastrow.after
END REPORT
]]>
</section>
  <section id="aapr330_g01.rep_data" ver="2" status="" src="s">
<![CDATA[PRIVATE FUNCTION aapr330_g01_rep_data()
DEFINE HANDLER         om.SaxDocumentHandler
DEFINE l_i             INTEGER
 
    #判斷是否有報表資料，若回彈出訊息視窗
    IF sr.getLength() = 0 THEN
       CALL cl_err_msg(NULL , "adz-00285", '', 1)
       RETURN 
    END IF
    #CALL cl_gr_init_apr()                          #t100先不用
    WHILE TRUE
        CALL cl_gr_init_pageheader()               
        LET handler = cl_gr_handler()
        IF handler IS NOT NULL THEN
            START REPORT aapr330_g01_rep TO XML HANDLER handler
            FOR l_i = 1 TO sr.getLength()
                OUTPUT TO REPORT aapr330_g01_rep(sr[l_i].*)
            END FOR
            FINISH REPORT aapr330_g01_rep
        END IF
        IF INT_FLAG = TRUE THEN
            LET INT_FLAG = FALSE
            EXIT WHILE
        END IF
    END WHILE
END FUNCTION
]]>
</section>
  <section id="aapr330_g01.sel_prep" ver="5" status="" src="s">
<![CDATA[#+ 選單功能實際執行處
PRIVATE FUNCTION aapr330_g01_sel_prep()
   #add-point:sel_prep段define
   {<point name="sel_prep.define"/>}
   #end add-point
 
   #add-point:sel_prep before
   {<point name="sel_prep.before" mark="Y"/>}
   #end add-point
   
   #add-point:sel_prep g_select
   {<point name="sel_prep.g_select" mark="Y"/>}
   #end add-point
   LET g_select = " SELECT apca001,apca003,apca007,apca014,apca015,apca057,apcacomp,apcadocdt,apcadocno, 
       apca050,apca053,apcaent,apcald,apcasite,apcastus,apcb005,apcb100,apcb101,apcb105,apcb115,apcb007, 
       apcb008,apcb009,apcb023,apcbld,apcbent,apcbseq,apcbdocno,NULL,NULL,NULL,NULL,NULL,NULL"
 
   #add-point:sel_prep g_from
   {<point name="sel_prep.g_from" mark="Y"/>}
   #end add-point
    LET g_from = " FROM apcb_t LEFT OUTER JOIN apca_t ON apca_t.apcaent = apcb_t.apcbent AND apca_t.apcald = apcb_t.apcbld AND apca_t.apcadocno = apcb_t.apcbdocno AND apca_t.apcasite = apcb_t.apcbsite             LEFT OUTER JOIN ooefl_t ON ooefl_t.ooefl001 = apcb_t.apcborga AND ooefl_t.ooeflent = apcb_t.apcbent AND ooefl_t.ooefl002 = '" , 
        g_dlang,"'" ,""
 
   #add-point:sel_prep g_where
   {<point name="sel_prep.g_where" mark="Y"/>}
   #end add-point
    LET g_where = " WHERE " ,tm.wc CLIPPED
 
   #add-point:sel_prep g_order
   {<point name="sel_prep.g_order" mark="Y"/>}
   #end add-point
    LET g_order = " ORDER BY apcadocno,apcbseq"
 
   #add-point:sel_prep.sql.before
   {<point name="sel_prep.sql.before mark="Y""/>}
   #end add-point:sel_prep.sql.before
 
   LET g_sql = g_select CLIPPED ," ",g_from CLIPPED ," ",g_where CLIPPED ," ",g_order CLIPPED 
 
   #add-point:sel_prep.sql.after
   {<point name="sel_prep.sql.after mark="Y""/>}
   #end add-point
   PREPARE aapr330_g01_prepare FROM g_sql
   IF STATUS THEN
      CALL cl_err('prepare:',STATUS,1)
      CALL cl_ap_exitprogram("0")
   END IF
   DECLARE aapr330_g01_curs CURSOR FOR aapr330_g01_prepare
 
END FUNCTION
]]>
</section>
  <section id="aapr330_g01.subrep_str" ver="3" status="" src="s">
<![CDATA[#讀取子報表樣板
PRIVATE REPORT aapr330_g01_subrep01(sr2)
DEFINE  sr2  sr2_r
#add-point:sub01.define
{<point name="sub01.define"/>}
#end add-point:sub01.define
 
    #add-point:sub01.order.before
    {<point name="sub01.order.before"/>}
    #end add-point:sub01.order.before
 
 
 
    FORMAT
 
 
 
       ON EVERY ROW
            #add-point:sub01.everyrow.before
            {<point name="sub01.everyrow.before"/>}              
            #end add-point:sub01.everyrow.before
 
            PRINTX sr2.*
 
            #add-point:sub01.everyrow.after
            {<point name="sub01.everyrow.after"/>}
            #end add-point:sub01.everyrow.after
 
 
END REPORT
 
 
PRIVATE REPORT aapr330_g01_subrep02(sr2)
DEFINE  sr2  sr2_r
#add-point:sub02.define
{<point name="sub02.define"/>}
#end add-point:sub02.define
 
    #add-point:sub02.order.before
    {<point name="sub02.order.before"/>}
    #end add-point:sub02.order.before
 
 
 
    FORMAT
 
 
 
       ON EVERY ROW
            #add-point:sub02.everyrow.before
            {<point name="sub02.everyrow.before"/>}              
            #end add-point:sub02.everyrow.before
 
            PRINTX sr2.*
 
            #add-point:sub02.everyrow.after
            {<point name="sub02.everyrow.after"/>}
            #end add-point:sub02.everyrow.after
 
 
END REPORT
 
 
PRIVATE REPORT aapr330_g01_subrep03(sr2)
DEFINE  sr2  sr2_r
#add-point:sub03.define
{<point name="sub03.define"/>}
#end add-point:sub03.define
 
    #add-point:sub03.order.before
    {<point name="sub03.order.before"/>}
    #end add-point:sub03.order.before
 
 
 
    FORMAT
 
 
 
       ON EVERY ROW
            #add-point:sub03.everyrow.before
            {<point name="sub03.everyrow.before"/>}              
            #end add-point:sub03.everyrow.before
 
            PRINTX sr2.*
 
            #add-point:sub03.everyrow.after
            {<point name="sub03.everyrow.after"/>}
            #end add-point:sub03.everyrow.after
 
 
END REPORT
 
 
PRIVATE REPORT aapr330_g01_subrep04(sr2)
DEFINE  sr2  sr2_r
#add-point:sub04.define
{<point name="sub04.define"/>}
#end add-point:sub04.define
 
    #add-point:sub04.order.before
    {<point name="sub04.order.before"/>}
    #end add-point:sub04.order.before
 
 
 
    FORMAT
 
 
 
       ON EVERY ROW
            #add-point:sub04.everyrow.before
            {<point name="sub04.everyrow.before"/>}              
            #end add-point:sub04.everyrow.before
 
            PRINTX sr2.*
 
            #add-point:sub04.everyrow.after
            {<point name="sub04.everyrow.after"/>}
            #end add-point:sub04.everyrow.after
 
 
END REPORT
 
 
 
]]>
</section>
</add_points>