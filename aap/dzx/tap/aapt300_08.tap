<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<add_points prog="aapt300_08" std_prog="aapt300_08" erpver="1.0" module="AAP" ver="3" env="s" zone="t10prd" booking="Y" type="S" identity="s" section_flag="N" designer_ver="1.0">
  <other>
    <code_template value="F" status=""/>
    <free_style value="N" status=""/>
    <start_arg value="" status=""/>
  </other>
  <point name="dialog.aapt300_08_display" order="1" ver="2" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 單身其他訊息
# Memo...........:
# Usage..........: aapt300_08_display()
# Date & Author..: 14/09/25 By Belle
# Modify.........:
################################################################################
DIALOG aapt300_08_display()

   DISPLAY ARRAY g_apcb_d TO s_detail1_aapt300_08.* ATTRIBUTES(COUNT=g_rec_b04) 
   
      BEFORE DISPLAY
         CALL FGL_SET_ARR_CURR(g_detail_idx)
      
      AFTER DISPLAY
         LET g_apcb_d4.* = g_apcb_d.*
   END DISPLAY
   
END DIALOG]]>
  </point>
  <point name="function.aapt300_08_b_fill" order="1" ver="2" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 單身填充
# Usage..........: CALL aapt300_08_b_fill(p_ent,p_ld,p_docno)
# Date & Author..: 14/10/01 By Belle
# Modify.........:
################################################################################
PUBLIC FUNCTION aapt300_08_b_fill(p_ent,p_ld,p_docno)
DEFINE p_ent          LIKE apca_t.apcaent     
DEFINE p_ld           LIKE apca_t.apcald      #帳套
DEFINE p_docno        LIKE apca_t.apcadocno   #單據編號
DEFINE l_sql          STRING
DEFINE l_glad         RECORD
                      glad0171    LIKE  glad_t.glad0171, 
                      glad0172    LIKE  glad_t.glad0172,
                      glad0181    LIKE  glad_t.glad0181,
                      glad0182    LIKE  glad_t.glad0182,
                      glad0191    LIKE  glad_t.glad0191,
                      glad0192    LIKE  glad_t.glad0192,
                      glad0201    LIKE  glad_t.glad0201,
                      glad0202    LIKE  glad_t.glad0202,
                      glad0211    LIKE  glad_t.glad0211,
                      glad0212    LIKE  glad_t.glad0212,
                      glad0221    LIKE  glad_t.glad0221,
                      glad0222    LIKE  glad_t.glad0222,
                      glad0231    LIKE  glad_t.glad0231,
                      glad0232    LIKE  glad_t.glad0232,
                      glad0241    LIKE  glad_t.glad0241,
                      glad0242    LIKE  glad_t.glad0242,
                      glad0251    LIKE  glad_t.glad0251,
                      glad0252    LIKE  glad_t.glad0252,
                      glad0261    LIKE  glad_t.glad0261,
                      glad0262    LIKE  glad_t.glad0262
                  END RECORD
   
   CALL aapt300_08_clear_detail()

   LET l_ac = 1   

   LET l_sql= " SELECT apcbdocno,apcbld,apcbseq,apcb047,  ",
              "        apcb021,'',apcb029,'',apcb051,'',apcb010,'',apcb011,'',apcb024,'',",
              "        apcb012,'',apcb015,'',apcb016,'',apcb033,   apcb034,'',",
              "        apcb035,'',apcb036,'',",
              "        apcb037,'',apcb038,'',apcb039,'',apcb040,'',apcb041,'',",
              "        apcb042,'',apcb043,'',apcb044,'',apcb045,'',apcb046,'' ",
              "   FROM apcb_t ",
              "  WHERE apcbent = ? AND apcbld = ? AND apcbdocno = ?",
              "  ORDER BY apcbseq"
   PREPARE apcb_pre_1 FROM l_sql
   DECLARE apcb_cur_1 CURSOR FOR apcb_pre_1
   FOREACH apcb_cur_1 USING p_ent,p_ld,p_docno INTO g_apcb_d[l_ac].*     
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "foreach:"
         LET g_errparam.popup = TRUE
         CALL cl_err()
         EXIT FOREACH
      END IF
     
      CALL s_fin_sel_glad(g_apcb_d[l_ac].apcbld,g_apcb_d[l_ac].apcb021,'glad0171|glad0172|glad0181|glad0182|glad0191|glad0192|glad0201|glad0202|glad0211|glad0212|glad0221|glad0222|glad0231|glad0232|glad0241|glad0242|glad0251|glad0252|glad0261|glad0262') 
           RETURNING g_errno,l_glad.*
      
      #業務人員
      LET g_apcb_d[l_ac].l_apcb051_desc = s_desc_show1(g_apcb_d[l_ac].apcb051,s_desc_get_person_desc(g_apcb_d[l_ac].apcb051))
      #業務部門
      LET g_apcb_d[l_ac].l_apcb010_desc = s_desc_show1(g_apcb_d[l_ac].apcb010,s_desc_get_department_desc(g_apcb_d[l_ac].apcb010))
      #責任中心
      LET g_apcb_d[l_ac].l_apcb011_desc = s_desc_show1(g_apcb_d[l_ac].apcb011,s_desc_get_department_desc(g_apcb_d[l_ac].apcb011))
      #產品類型
      LET g_apcb_d[l_ac].l_apcb012_desc = s_desc_show1(g_apcb_d[l_ac].apcb012,s_desc_get_rtaxl003_desc(g_apcb_d[l_ac].apcb012))
      #專案代號
      LET g_apcb_d[l_ac].l_apcb015_desc = s_desc_show1(g_apcb_d[l_ac].apcb015,s_desc_get_project_desc(g_apcb_d[l_ac].apcb015))
      
      LET g_apcb_d[l_ac].l_apcb024_desc = s_desc_show1(g_apcb_d[l_ac].apcb024,s_desc_get_acc_desc('287',g_apcb_d[l_ac].apcb024))
      LET g_apcb_d[l_ac].l_apcb034_desc = s_desc_show1(g_apcb_d[l_ac].apcb034, s_desc_get_oojdl003_desc(g_apcb_d[l_ac].apcb034))
      LET g_apcb_d[l_ac].l_apcb035_desc = s_desc_show1(g_apcb_d[l_ac].apcb035,s_desc_get_acc_desc('2002',g_apcb_d[l_ac].apcb035))
      LET g_apcb_d[l_ac].l_apcb036_desc = s_desc_show1(g_apcb_d[l_ac].apcb036,s_desc_get_acc_desc('281',g_apcb_d[l_ac].apcb036))
      
      #費用會計科目
      LET g_apcb_d[l_ac].l_apcb021_desc = s_desc_show1(g_apcb_d[l_ac].apcb021,s_desc_get_account_desc(g_apcb_d[l_ac].apcbld,g_apcb_d[l_ac].apcb021))
      #應付帳款科目
      LET g_apcb_d[l_ac].l_apcb029_desc = s_desc_show1(g_apcb_d[l_ac].apcb029,s_desc_get_account_desc(g_apcb_d[l_ac].apcbld,g_apcb_d[l_ac].apcb029))
      
      IF NOT cl_null(g_apcb_d[l_ac].apcb037) THEN
         LET g_apcb_d[l_ac].l_apcb037_desc = s_desc_show1(g_apcb_d[l_ac].apcb037,s_fin_get_accting_desc(l_glad.glad0171,g_apcb_d[l_ac].apcb037))
      END IF
      IF NOT cl_null(g_apcb_d[l_ac].apcb038) THEN
         LET g_apcb_d[l_ac].l_apcb038_desc = s_desc_show1(g_apcb_d[l_ac].apcb038,s_fin_get_accting_desc(l_glad.glad0181,g_apcb_d[l_ac].apcb038))
      END IF
      IF NOT cl_null(g_apcb_d[l_ac].apcb039) THEN
         LET g_apcb_d[l_ac].l_apcb039_desc = s_desc_show1(g_apcb_d[l_ac].apcb039,s_fin_get_accting_desc(l_glad.glad0191,g_apcb_d[l_ac].apcb039))
      END IF
      IF NOT cl_null(g_apcb_d[l_ac].apcb040) THEN
         LET g_apcb_d[l_ac].l_apcb040_desc = s_desc_show1(g_apcb_d[l_ac].apcb040,s_fin_get_accting_desc(l_glad.glad0201,g_apcb_d[l_ac].apcb040))
      END IF
      IF NOT cl_null(g_apcb_d[l_ac].apcb041) THEN
         LET g_apcb_d[l_ac].l_apcb041_desc = s_desc_show1(g_apcb_d[l_ac].apcb041,s_fin_get_accting_desc(l_glad.glad0211,g_apcb_d[l_ac].apcb041))
      END IF
      IF NOT cl_null(g_apcb_d[l_ac].apcb042) THEN   
         LET g_apcb_d[l_ac].l_apcb042_desc = s_desc_show1(g_apcb_d[l_ac].apcb042,s_fin_get_accting_desc(l_glad.glad0221,g_apcb_d[l_ac].apcb042))
      END IF
      IF NOT cl_null(g_apcb_d[l_ac].apcb043) THEN
         LET g_apcb_d[l_ac].l_apcb043_desc = s_desc_show1(g_apcb_d[l_ac].apcb043,s_fin_get_accting_desc(l_glad.glad0231,g_apcb_d[l_ac].apcb043))
      END IF
      IF NOT cl_null(g_apcb_d[l_ac].apcb044) THEN   
         LET g_apcb_d[l_ac].l_apcb044_desc = s_desc_show1(g_apcb_d[l_ac].apcb044,s_fin_get_accting_desc(l_glad.glad0241,g_apcb_d[l_ac].apcb044))
      END IF
      IF NOT cl_null(g_apcb_d[l_ac].apcb045) THEN   
         LET g_apcb_d[l_ac].l_apcb045_desc = s_desc_show1(g_apcb_d[l_ac].apcb045,s_fin_get_accting_desc(l_glad.glad0251,g_apcb_d[l_ac].apcb045))
      END IF
      IF NOT cl_null(g_apcb_d[l_ac].apcb046) THEN   
         LET g_apcb_d[l_ac].l_apcb046_desc = s_desc_show1(g_apcb_d[l_ac].apcb046,s_fin_get_accting_desc(l_glad.glad0261,g_apcb_d[l_ac].apcb046))
      END IF
     
      LET l_ac = l_ac + 1
      
   END FOREACH
   CALL g_apcb_d.deleteElement(l_ac)
   
   LET g_rec_b04 = l_ac - 1
   LET g_apcb_d4.* = g_apcb_d.*
   FREE apcb_pre_1

END FUNCTION]]>
  </point>
  <point name="dialog.aapt300_08_input" order="2" ver="2" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 
# Memo...........:
# Usage..........: aapt300_08_input()
# Date & Author..: 14/09/25 By Belle
# Modify.........:
################################################################################
DIALOG aapt300_08_input()
DEFINE l_apcb         RECORD LIKE apcb_t.*
DEFINE l_forupd_sql   STRING
DEFINE l_lock_sw      LIKE type_t.chr1 
DEFINE l_apcadocdt    LIKE apca_t.apcadocdt
DEFINE l_apcald       LIKE apca_t.apcald
DEFINE l_apcadocno    LIKE apca_t.apcadocno
DEFINE l_glaa004      LIKE glaa_t.glaa004   
DEFINE l_glaa121      LIKE glaa_t.glaa121  
DEFINE l_glaacomp     LIKE glaa_t.glaacomp
DEFINE l_dfin0030     LIKE type_t.chr1
DEFINE l_ap_slip      LIKE apca_t.apcadocno
DEFINE l_cmd          LIKE type_t.chr5
DEFINE l_glae009      LIKE glae_t.glae009
DEFINE l_glad         RECORD
                      glad0171    LIKE  glad_t.glad0171, 
                      glad0172    LIKE  glad_t.glad0172,
                      glad0181    LIKE  glad_t.glad0181,
                      glad0182    LIKE  glad_t.glad0182,
                      glad0191    LIKE  glad_t.glad0191,
                      glad0192    LIKE  glad_t.glad0192,
                      glad0201    LIKE  glad_t.glad0201,
                      glad0202    LIKE  glad_t.glad0202,
                      glad0211    LIKE  glad_t.glad0211,
                      glad0212    LIKE  glad_t.glad0212,
                      glad0221    LIKE  glad_t.glad0221,
                      glad0222    LIKE  glad_t.glad0222,
                      glad0231    LIKE  glad_t.glad0231,
                      glad0232    LIKE  glad_t.glad0232,
                      glad0241    LIKE  glad_t.glad0241,
                      glad0242    LIKE  glad_t.glad0242,
                      glad0251    LIKE  glad_t.glad0251,
                      glad0252    LIKE  glad_t.glad0252,
                      glad0261    LIKE  glad_t.glad0261,
                      glad0262    LIKE  glad_t.glad0262
                  END RECORD
   
   INPUT ARRAY g_apcb_d FROM s_detail1_aapt300_08.*
      ATTRIBUTE(COUNT = g_rec_b04,MAXCOUNT = g_rec_b04,WITHOUT DEFAULTS, 
                INSERT ROW = FALSE,
                DELETE ROW = FALSE,
                APPEND ROW = FALSE)
         
      BEFORE INPUT 
         SELECT apcadocdt INTO l_apcadocdt
           FROM apca_t
          WHERE apcaent = g_enterprise
            AND apcald  = g_apcb_d[1].apcbld AND apcadocno =  g_apcb_d[1].apcbdocno
         CALL s_ld_sel_glaa(g_apcb_d[1].apcbld,'glaa004|glaa121|glaacomp') RETURNING g_sub_success,l_glaa004,l_glaa121,l_glaacomp
         CALL cl_set_combo_scc('apcb033','6013')
         LET l_forupd_sql = " SELECT apcbdocno,apcbld,apcbseq,apcb047,  ",
                            "        apcb021,'',apcb029,'',apcb051,'',apcb010,'',apcb011,'',apcb024,'',",
                            "        apcb012,'',apcb015,'',apcb016,'',apcb033,   apcb034,'',",
                            "        apcb035,'',apcb036,'',",
                            "        apcb037,'',apcb038,'',apcb039,'',apcb040,'',apcb041,'',",
                            "        apcb042,'',apcb043,'',apcb044,'',apcb045,'',apcb046,'' ",
                            "   FROM apcb_t ",
                            "  WHERE apcbent = ",g_enterprise," AND apcbld = ? AND apcbdocno = ? AND apcbseq = ?",
                            "    FOR UPDATE"
         LET l_forupd_sql = cl_sql_forupd(l_forupd_sql)  
         PREPARE aapt300_08_input_p FROM l_forupd_sql
         DECLARE aapt300_08_input_c CURSOR FOR aapt300_08_input_p

            
      BEFORE ROW
         LET l_cmd = ''
         LET l_ac = ARR_CURR()
         LET l_lock_sw = 'N'            #DEFAULT
         DISPLAY l_ac TO FORMONLY.idx
      
         CALL s_transaction_begin()
         LET g_rec_b = g_apcb_d.getLength()
         
         LET l_cmd='u'
         SELECT apcadocdt INTO l_apcadocdt
           FROM apca_t
          WHERE apcaent = g_enterprise  
            AND apcald  = g_apcb_d[l_ac].apcbld AND apcadocno = g_apcb_d[l_ac].apcbdocno
         LET l_apcald   = g_apcb_d[l_ac].apcbld
         LET l_apcadocno= g_apcb_d[l_ac].apcbdocno
         LET g_apcb_d_t.* = g_apcb_d[l_ac].*  
         CALL s_transaction_begin()
         
         OPEN aapt300_08_input_c USING g_apcb_d[l_ac].apcbld,g_apcb_d[l_ac].apcbdocno,g_apcb_d[l_ac].apcbseq 
         IF SQLCA.sqlcode THEN
            LET l_lock_sw='Y'
         ELSE
            FETCH aapt300_08_input_c INTO g_apcb_d[l_ac].*
            IF SQLCA.sqlcode THEN
               LET l_lock_sw = "Y"
            END IF
            CALL cl_show_fld_cont()
            
            #一定要寫在這個位置，避免觸發SQLCA.sqlcode導致l_lock_sw = "Y"
            CALL s_fin_sel_glad(g_apcb_d[l_ac].apcbld,g_apcb_d[l_ac].apcb021,'glad0171|glad0172|glad0181|glad0182|glad0191|glad0192|glad0201|glad0202|glad0211|glad0212|glad0221|glad0222|glad0231|glad0232|glad0241|glad0242|glad0251|glad0252|glad0261|glad0262') 
                 RETURNING g_errno,l_glad.*
            LET g_apcb_d[l_ac].l_apcb051_desc = s_desc_show1(g_apcb_d[l_ac].apcb051,s_desc_get_person_desc(g_apcb_d[l_ac].apcb051))
            LET g_apcb_d[l_ac].l_apcb010_desc = s_desc_show1(g_apcb_d[l_ac].apcb010,s_desc_get_department_desc(g_apcb_d[l_ac].apcb010))
            LET g_apcb_d[l_ac].l_apcb011_desc = s_desc_show1(g_apcb_d[l_ac].apcb011,s_desc_get_department_desc(g_apcb_d[l_ac].apcb011))
            LET g_apcb_d[l_ac].l_apcb012_desc = s_desc_show1(g_apcb_d[l_ac].apcb012,s_desc_get_rtaxl003_desc(g_apcb_d[l_ac].apcb012))
            LET g_apcb_d[l_ac].l_apcb015_desc = s_desc_show1(g_apcb_d[l_ac].apcb015,s_desc_get_project_desc(g_apcb_d[l_ac].apcb015))
            LET g_apcb_d[l_ac].l_apcb021_desc = s_desc_show1(g_apcb_d[l_ac].apcb021 ,s_desc_get_account_desc(g_apcb_d[l_ac].apcbld,g_apcb_d[l_ac].apcb021))
            LET g_apcb_d[l_ac].l_apcb024_desc = s_desc_show1(g_apcb_d[l_ac].apcb024,s_desc_get_acc_desc('287',g_apcb_d[l_ac].apcb024))
            
            LET g_apcb_d[l_ac].l_apcb029_desc = s_desc_show1(g_apcb_d[l_ac].apcb029 ,s_desc_get_account_desc(g_apcb_d[l_ac].apcbld,g_apcb_d[l_ac].apcb029))
            LET g_apcb_d[l_ac].l_apcb034_desc = s_desc_show1(g_apcb_d[l_ac].apcb034, s_desc_get_oojdl003_desc(g_apcb_d[l_ac].apcb034))
            LET g_apcb_d[l_ac].l_apcb035_desc = s_desc_show1(g_apcb_d[l_ac].apcb035,s_desc_get_acc_desc('2002',g_apcb_d[l_ac].apcb035))
            LET g_apcb_d[l_ac].l_apcb036_desc = s_desc_show1(g_apcb_d[l_ac].apcb036,s_desc_get_acc_desc('281',g_apcb_d[l_ac].apcb036))
            IF NOT cl_null(g_apcb_d[l_ac].l_apcb037_desc) THEN
               LET g_apcb_d[l_ac].l_apcb037_desc = s_desc_show1(g_apcb_d[l_ac].apcb037,s_fin_get_accting_desc(l_glad.glad0171,g_apcb_d[l_ac].apcb037))
            END IF
            IF NOT cl_null(g_apcb_d[l_ac].l_apcb038_desc) THEN
               LET g_apcb_d[l_ac].l_apcb038_desc = s_desc_show1(g_apcb_d[l_ac].apcb038,s_fin_get_accting_desc(l_glad.glad0181,g_apcb_d[l_ac].apcb038))
            END IF
            IF NOT cl_null(g_apcb_d[l_ac].l_apcb039_desc) THEN
               LET g_apcb_d[l_ac].l_apcb039_desc = s_desc_show1(g_apcb_d[l_ac].apcb039,s_fin_get_accting_desc(l_glad.glad0191,g_apcb_d[l_ac].apcb039))
            END IF
            IF NOT cl_null(g_apcb_d[l_ac].l_apcb040_desc) THEN
               LET g_apcb_d[l_ac].l_apcb040_desc = s_desc_show1(g_apcb_d[l_ac].apcb040,s_fin_get_accting_desc(l_glad.glad0201,g_apcb_d[l_ac].apcb040))
            END IF
            IF NOT cl_null(g_apcb_d[l_ac].l_apcb041_desc) THEN
               LET g_apcb_d[l_ac].l_apcb041_desc = s_desc_show1(g_apcb_d[l_ac].apcb041,s_fin_get_accting_desc(l_glad.glad0211,g_apcb_d[l_ac].apcb041))
            END IF
            IF NOT cl_null(g_apcb_d[l_ac].l_apcb042_desc) THEN
               LET g_apcb_d[l_ac].l_apcb042_desc = s_desc_show1(g_apcb_d[l_ac].apcb042,s_fin_get_accting_desc(l_glad.glad0221,g_apcb_d[l_ac].apcb042))
            END IF
            IF NOT cl_null(g_apcb_d[l_ac].l_apcb043_desc) THEN
               LET g_apcb_d[l_ac].l_apcb043_desc = s_desc_show1(g_apcb_d[l_ac].apcb043,s_fin_get_accting_desc(l_glad.glad0231,g_apcb_d[l_ac].apcb043))
            END IF
            IF NOT cl_null(g_apcb_d[l_ac].l_apcb044_desc) THEN
               LET g_apcb_d[l_ac].l_apcb044_desc = s_desc_show1(g_apcb_d[l_ac].apcb044,s_fin_get_accting_desc(l_glad.glad0241,g_apcb_d[l_ac].apcb044))
            END IF
            IF NOT cl_null(g_apcb_d[l_ac].l_apcb045_desc) THEN
               LET g_apcb_d[l_ac].l_apcb045_desc = s_desc_show1(g_apcb_d[l_ac].apcb045,s_fin_get_accting_desc(l_glad.glad0251,g_apcb_d[l_ac].apcb045))
            END IF
            IF NOT cl_null(g_apcb_d[l_ac].l_apcb046_desc) THEN
               LET g_apcb_d[l_ac].l_apcb046_desc = s_desc_show1(g_apcb_d[l_ac].apcb046,s_fin_get_accting_desc(l_glad.glad0261,g_apcb_d[l_ac].apcb046))
            END IF
      
         END IF

      ON ROW CHANGE
         IF INT_FLAG THEN
            INITIALIZE g_errparam TO NULL
            LET g_errparam.code = 9001
            LET g_errparam.extend = ''
            LET g_errparam.popup = TRUE
            CALL cl_err()
            LET INT_FLAG = 0
            LET g_apcb_d[l_ac].* = g_apcb_d_t.*
            CLOSE aapt300_08_input_c
            CALL s_transaction_end('N',0)
            EXIT DIALOG 
         END IF
            
            
         IF l_lock_sw = 'Y' THEN
            INITIALIZE g_errparam TO NULL
            LET g_errparam.code = -263
            LET g_errparam.extend = g_apcb_d[l_ac].apcbseq                
            LET g_errparam.popup = TRUE
            CALL cl_err()
            LET g_apcb_d[l_ac].* = g_apcb_d_t.*
         ELSE

            UPDATE apcb_t SET apcb021 = g_apcb_d[l_ac].apcb021, apcb029 = g_apcb_d[l_ac].apcb029,
                              apcb051 = g_apcb_d[l_ac].apcb051, 
                              apcb010 = g_apcb_d[l_ac].apcb010, apcb011 = g_apcb_d[l_ac].apcb011,
                              apcb024 = g_apcb_d[l_ac].apcb024, apcb012 = g_apcb_d[l_ac].apcb012,
                              apcb015 = g_apcb_d[l_ac].apcb015, apcb016 = g_apcb_d[l_ac].apcb016,
                              apcb033 = g_apcb_d[l_ac].apcb033, apcb034 = g_apcb_d[l_ac].apcb034,
                              apcb035 = g_apcb_d[l_ac].apcb035, apcb036 = g_apcb_d[l_ac].apcb036,
                              apcb037 = g_apcb_d[l_ac].apcb037, apcb038 = g_apcb_d[l_ac].apcb038,
                              apcb039 = g_apcb_d[l_ac].apcb039, apcb040 = g_apcb_d[l_ac].apcb040,
                              apcb041 = g_apcb_d[l_ac].apcb041, apcb042 = g_apcb_d[l_ac].apcb042,
                              apcb043 = g_apcb_d[l_ac].apcb043, apcb044 = g_apcb_d[l_ac].apcb044,
                              apcb045 = g_apcb_d[l_ac].apcb045, apcb046 = g_apcb_d[l_ac].apcb046,
                              apcb047 = g_apcb_d[l_ac].apcb047
             WHERE apcbent = g_enterprise AND apcbld = g_apcb_d[l_ac].apcbld
               AND apcbdocno = g_apcb_d[l_ac].apcbdocno AND apcbseq = g_apcb_d[l_ac].apcbseq  

            IF SQLCA.sqlcode THEN
               INITIALIZE g_errparam TO NULL
               LET g_errparam.code = SQLCA.sqlcode
               LET g_errparam.extend = "apcb_t"
               LET g_errparam.popup = TRUE
               CALL cl_err()

               LET g_apcb_d[l_ac].* = g_apcb_d_t.*
               CALL s_transaction_end('N',0) 
            ELSE
               CALL s_transaction_end('Y',0)                
            END IF

         END IF
            
         AFTER ROW
            CLOSE aapt300_08_input_c
  
         BEFORE FIELD l_apcb021_desc                                    #150205-00012#1
            LET g_apcb_d[l_ac].l_apcb021_desc = g_apcb_d[l_ac].apcb021  #150205-00012#1  
         
         #費用會計科目     
         AFTER FIELD l_apcb021_desc
            IF NOT cl_null(g_apcb_d[l_ac].l_apcb021_desc) THEN
               IF g_apcb_d[l_ac].l_apcb021_desc != g_apcb_d_t.l_apcb021_desc OR g_apcb_d_t.l_apcb021_desc IS NULL THEN
                  LET g_apcb_d[l_ac].apcb021 = g_apcb_d[l_ac].l_apcb021_desc
                  IF (g_apcb_d[l_ac].apcb021 != g_apcb_d_t.apcb021 OR g_apcb_d_t.apcb021 IS NULL) THEN
                     CALL s_aap_glac002_chk(g_apcb_d[l_ac].apcb021,g_apcb_d[l_ac].apcbld) RETURNING g_sub_success,g_errno
                     IF NOT g_sub_success THEN
                        INITIALIZE g_errparam TO NULL
                        LET g_errparam.code = g_errno
                        LET g_errparam.extend = ''
                        LET g_errparam.popup = TRUE
                        CALL cl_err()
                        LET g_apcb_d[l_ac].apcb021        = g_apcb_d_t.apcb021
                        LET g_apcb_d[l_ac].l_apcb021_desc = g_apcb_d_t.l_apcb021_desc
                        DISPLAY BY NAME g_apcb_d[l_ac].apcb021,g_apcb_d[l_ac].l_apcb021_desc
                        NEXT FIELD CURRENT
                     END IF
                  END IF
               END IF
            ELSE
               LET g_apcb_d[l_ac].apcb021 = ''
            END IF
            LET g_apcb_d[l_ac].l_apcb021_desc = s_desc_show1(g_apcb_d[l_ac].apcb021 ,s_desc_get_account_desc(g_apcb_d[l_ac].apcbld,g_apcb_d[l_ac].apcb021))
            LET g_apcb_d_t.l_apcb021_desc = g_apcb_d[l_ac].l_apcb021_desc            
            DISPLAY BY NAME g_apcb_d[l_ac].apcb021,g_apcb_d[l_ac].l_apcb021_desc
            
            
         ON ACTION controlp INFIELD l_apcb021_desc
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_apcb_d[l_ac].apcb021    
            LET g_qryparam.where = "glac001 = '",l_glaa004,"' AND  glac003 <>'1' "  #glac001(會計科目參照表)/glac003(科目類型)
            CALL aglt310_04()                               
            LET g_apcb_d[l_ac].apcb021       = g_qryparam.return1
            LET g_apcb_d[l_ac].l_apcb021_desc= g_apcb_d[l_ac].apcb021
            DISPLAY BY NAME g_apcb_d[l_ac].apcb021,g_apcb_d[l_ac].l_apcb021_desc
            NEXT FIELD l_apcb021_desc     
         
         BEFORE FIELD l_apcb029_desc                                    #150205-00012#1
            LET g_apcb_d[l_ac].l_apcb029_desc = g_apcb_d[l_ac].apcb029  #150205-00012#1
            
         #應付帳款科目               
         AFTER FIELD l_apcb029_desc
            IF NOT cl_null(g_apcb_d[l_ac].l_apcb029_desc) THEN
               IF g_apcb_d[l_ac].l_apcb029_desc != g_apcb_d_t.l_apcb029_desc OR g_apcb_d_t.l_apcb029_desc IS NULL THEN
                  LET g_apcb_d[l_ac].apcb029 = g_apcb_d[l_ac].l_apcb029_desc
                  IF (g_apcb_d[l_ac].apcb029 != g_apcb_d_t.apcb029 OR g_apcb_d_t.apcb029 IS NULL) THEN
                     CALL s_aap_glac002_chk(g_apcb_d[l_ac].apcb029,g_apcb_d[l_ac].apcbld) RETURNING g_sub_success,g_errno
                     IF NOT g_sub_success THEN
                        INITIALIZE g_errparam TO NULL
                        LET g_errparam.code = g_errno
                        LET g_errparam.extend = ''
                        LET g_errparam.popup = TRUE
                        CALL cl_err()
                        LET g_apcb_d[l_ac].apcb029        = g_apcb_d_t.apcb029
                        LET g_apcb_d[l_ac].l_apcb029_desc = g_apcb_d_t.l_apcb029_desc
                        DISPLAY BY NAME g_apcb_d[l_ac].apcb029,g_apcb_d[l_ac].l_apcb029_desc
                        NEXT FIELD CURRENT
                     END IF
                  END IF
               END IF
            ELSE
               LET g_apcb_d[l_ac].apcb029 = ''
            END IF
            LET g_apcb_d[l_ac].l_apcb029_desc = s_desc_show1(g_apcb_d[l_ac].apcb029 ,s_desc_get_account_desc(g_apcb_d[l_ac].apcbld,g_apcb_d[l_ac].apcb029))
            LET g_apcb_d_t.l_apcb029_desc = g_apcb_d[l_ac].l_apcb029_desc
            DISPLAY BY NAME g_apcb_d[l_ac].apcb029,g_apcb_d[l_ac].l_apcb029_desc

         ON ACTION controlp INFIELD l_apcb029_desc
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_apcb_d[l_ac].apcb029
            LET g_qryparam.where = "glac001 = '",l_glaa004,"' AND  glac003 <>'1' "  #glac001(會計科目參照表)/glac003(科目類型)
            CALL aglt310_04()                               
            LET g_apcb_d[l_ac].apcb029       = g_qryparam.return1
            LET g_apcb_d[l_ac].l_apcb029_desc= g_apcb_d[l_ac].apcb029
            DISPLAY BY NAME g_apcb_d[l_ac].apcb029,g_apcb_d[l_ac].l_apcb029_desc
            NEXT FIELD l_apcb029_desc     
          
         BEFORE FIELD l_apcb051_desc                                    #150205-00012#1
            LET g_apcb_d[l_ac].l_apcb051_desc = g_apcb_d[l_ac].apcb051  #150205-00012#1
         
         #業務人員
         AFTER FIELD l_apcb051_desc
            IF NOT cl_null(g_apcb_d[l_ac].l_apcb051_desc) THEN
               IF ( g_apcb_d[l_ac].l_apcb051_desc != g_apcb_d_t.l_apcb051_desc OR g_apcb_d_t.l_apcb051_desc IS NULL ) THEN
                  LET g_apcb_d[l_ac].apcb051 = g_apcb_d[l_ac].l_apcb051_desc
                  IF l_glaa121 = 'N' THEN     #141218-00011#6
                     IF (g_apcb_d[l_ac].apcb051 != g_apcb_d_t.apcb051 OR g_apcb_d_t.apcb051 IS NULL) THEN
                        CALL s_employee_chk(g_apcb_d[l_ac].apcb051) RETURNING g_sub_success
                        IF NOT g_sub_success THEN
                           LET g_apcb_d[l_ac].apcb051        = g_apcb_d_t.apcb051
                           LET g_apcb_d[l_ac].l_apcb051_desc = g_apcb_d_t.l_apcb051_desc
                           DISPLAY BY NAME g_apcb_d[l_ac].apcb051,g_apcb_d[l_ac].l_apcb051_desc
                           NEXT FIELD CURRENT
                        END IF
                     END IF
                  END IF
               END IF
            ELSE
               LET g_apcb_d[l_ac].apcb051 = ''
            END IF
            LET g_apcb_d[l_ac].l_apcb051_desc = s_desc_show1(g_apcb_d[l_ac].apcb051,s_desc_get_person_desc(g_apcb_d[l_ac].apcb051))
            LET g_apcb_d_t.l_apcb051_desc = g_apcb_d[l_ac].l_apcb051_desc
            DISPLAY BY NAME g_apcb_d[l_ac].apcb051,g_apcb_d[l_ac].l_apcb051_desc
            
         ON ACTION controlp INFIELD l_apcb051_desc
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_apcb_d[l_ac].apcb051
            CALL q_ooag001_8()                               
            LET g_apcb_d[l_ac].apcb051 = g_qryparam.return1    
            LET g_apcb_d[l_ac].l_apcb051_desc= g_apcb_d[l_ac].apcb051
            DISPLAY BY NAME g_apcb_d[l_ac].apcb051,g_apcb_d[l_ac].l_apcb051_desc
            NEXT FIELD l_apcb051_desc   
            
         BEFORE FIELD l_apcb010_desc                                    #150205-00012#1
            LET g_apcb_d[l_ac].l_apcb010_desc = g_apcb_d[l_ac].apcb010  #150205-00012#1
            
         #業務部門
         AFTER FIELD l_apcb010_desc
            IF NOT cl_null(g_apcb_d[l_ac].l_apcb010_desc)  THEN
               IF ( g_apcb_d[l_ac].l_apcb010_desc != g_apcb_d_t.l_apcb010_desc OR g_apcb_d_t.l_apcb010_desc IS NULL ) THEN
                  LET g_apcb_d[l_ac].apcb010 = g_apcb_d[l_ac].l_apcb010_desc
                  IF l_glaa121 = 'N' THEN     #141218-00011#6
                     IF (g_apcb_d[l_ac].apcb010 != g_apcb_d_t.apcb010 OR g_apcb_d_t.apcb010 IS NULL) THEN
                        CALL s_department_chk(g_apcb_d[l_ac].apcb010,l_apcadocdt) RETURNING g_sub_success
                        IF NOT g_sub_success THEN
                           LET g_apcb_d[l_ac].apcb010        = g_apcb_d_t.apcb010
                           LET g_apcb_d[l_ac].l_apcb010_desc = g_apcb_d_t.l_apcb010_desc
                           DISPLAY BY NAME g_apcb_d[l_ac].apcb010,g_apcb_d[l_ac].l_apcb010_desc
                           NEXT FIELD CURRENT
                        END IF
                     END IF
                  END IF
                  #141114-00010#20--(S)
                  CALL s_department_get_respon_center(g_apcb_d[l_ac].apcb010,l_apcadocdt)
                       RETURNING g_sub_success,g_errno,g_apcb_d[l_ac].apcb011,g_apcb_d[l_ac].l_apcb011_desc
                  LET g_apcb_d[l_ac].l_apcb011_desc = s_desc_show1(g_apcb_d[l_ac].apcb011,g_apcb_d[l_ac].l_apcb011_desc)
                  LET g_apcb_d_t.l_apcb011_desc = g_apcb_d[l_ac].l_apcb011_desc
                  DISPLAY BY NAME g_apcb_d[l_ac].apcb011,g_apcb_d[l_ac].l_apcb011_desc
                  #141114-00010#20--(E)
               END IF
            ELSE
               LET g_apcb_d[l_ac].apcb010 = ''
            END IF
            LET g_apcb_d[l_ac].l_apcb010_desc = s_desc_show1(g_apcb_d[l_ac].apcb010,s_desc_get_department_desc(g_apcb_d[l_ac].apcb010))
            LET g_apcb_d_t.l_apcb010_desc = g_apcb_d[l_ac].l_apcb010_desc
            DISPLAY BY NAME g_apcb_d[l_ac].apcb010,g_apcb_d[l_ac].l_apcb010_desc
            
         ON ACTION controlp INFIELD l_apcb010_desc
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_apcb_d[l_ac].apcb010
            LET g_qryparam.arg1 = l_apcadocdt
            CALL q_ooeg001_4()                             
            LET g_apcb_d[l_ac].apcb010 = g_qryparam.return1    
            LET g_apcb_d[l_ac].l_apcb010_desc= g_apcb_d[l_ac].apcb010
            DISPLAY BY NAME g_apcb_d[l_ac].apcb010,g_apcb_d[l_ac].l_apcb010_desc
            NEXT FIELD l_apcb010_desc               
            
         BEFORE FIELD l_apcb011_desc                                    #150205-00012#1
            LET g_apcb_d[l_ac].l_apcb011_desc = g_apcb_d[l_ac].apcb011  #150205-00012#1   
            
         #責任中心
         AFTER FIELD l_apcb011_desc
            IF NOT cl_null(g_apcb_d[l_ac].l_apcb011_desc) THEN
               IF ( g_apcb_d[l_ac].l_apcb011_desc != g_apcb_d_t.l_apcb011_desc OR g_apcb_d_t.l_apcb011_desc IS NULL ) THEN
                  LET g_apcb_d[l_ac].apcb011 = g_apcb_d[l_ac].l_apcb011_desc
                  IF l_glaa121 = 'N' THEN     #141218-00011#6
                     IF (g_apcb_d[l_ac].apcb011 != g_apcb_d_t.apcb011 OR g_apcb_d_t.apcb011 IS NULL) THEN
                        CALL s_voucher_glaq019_chk(g_apcb_d[l_ac].l_apcb011_desc,l_apcadocdt)
                        IF NOT cl_null(g_errno) THEN
                           LET g_apcb_d[l_ac].apcb011        = g_apcb_d_t.apcb011
                           LET g_apcb_d[l_ac].l_apcb011_desc = g_apcb_d_t.l_apcb011_desc
                           DISPLAY BY NAME g_apcb_d[l_ac].apcb011,g_apcb_d[l_ac].l_apcb011_desc
                           NEXT FIELD CURRENT
                        END IF
                     END IF
                  END IF
               END IF
            ELSE
               LET g_apcb_d[l_ac].apcb011 = ''
            END IF
            LET g_apcb_d[l_ac].l_apcb011_desc = s_desc_show1(g_apcb_d[l_ac].apcb011,s_desc_get_department_desc(g_apcb_d[l_ac].apcb011))
            LET g_apcb_d_t.l_apcb011_desc = g_apcb_d[l_ac].l_apcb011_desc
            DISPLAY BY NAME g_apcb_d[l_ac].apcb011,g_apcb_d[l_ac].l_apcb011_desc

         ON ACTION controlp INFIELD l_apcb011_desc
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_apcb_d[l_ac].l_apcb011_desc
            LET g_qryparam.arg1 = l_apcadocdt
            LET g_qryparam.where = " ooeg003 IN ('1','2','3')"
            CALL q_ooeg001_5()    
            LET g_apcb_d[l_ac].apcb011        = g_qryparam.return1
            LET g_apcb_d[l_ac].l_apcb011_desc = g_apcb_d[l_ac].apcb011
            DISPLAY BY NAME g_apcb_d[l_ac].apcb011 ,g_apcb_d[l_ac].l_apcb011_desc
            NEXT FIELD l_apcb011_desc
            
         BEFORE FIELD l_apcb024_desc                                    #150205-00012#1
            LET g_apcb_d[l_ac].l_apcb024_desc = g_apcb_d[l_ac].apcb024  #150205-00012#1      
         
         #區域 
         AFTER FIELD l_apcb024_desc
            IF NOT cl_null(g_apcb_d[l_ac].l_apcb024_desc) THEN
               IF ( g_apcb_d[l_ac].l_apcb024_desc != g_apcb_d_t.l_apcb024_desc OR g_apcb_d_t.l_apcb024_desc IS NULL ) THEN
                  LET g_apcb_d[l_ac].apcb024 = g_apcb_d[l_ac].l_apcb024_desc
                  IF l_glaa121 = 'N' THEN     #141218-00011#6
                     IF (g_apcb_d[l_ac].apcb024 != g_apcb_d_t.apcb024 OR g_apcb_d_t.apcb024 IS NULL) THEN
                        IF NOT s_azzi650_chk_exist('287',g_apcb_d[l_ac].l_apcb024_desc) THEN
                           LET g_apcb_d[l_ac].apcb024        = g_apcb_d_t.apcb024
                           LET g_apcb_d[l_ac].l_apcb024_desc = g_apcb_d_t.l_apcb024_desc
                           DISPLAY BY NAME g_apcb_d[l_ac].apcb024,g_apcb_d[l_ac].l_apcb024_desc
                           NEXT FIELD CURRENT
                        END IF
                     END IF
                  END IF
               END IF
            ELSE
               LET g_apcb_d[l_ac].apcb024 = ''
            END IF
            LET g_apcb_d[l_ac].l_apcb024_desc = s_desc_show1(g_apcb_d[l_ac].apcb024,s_desc_get_acc_desc('287',g_apcb_d[l_ac].apcb024))
            LET g_apcb_d_t.l_apcb024_desc = g_apcb_d[l_ac].l_apcb024_desc
            DISPLAY BY NAME g_apcb_d[l_ac].apcb024,g_apcb_d[l_ac].l_apcb024_desc

         ON ACTION controlp INFIELD l_apcb024_desc
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_apcb_d[l_ac].l_apcb024_desc
            CALL q_oocq002_287()
            LET g_apcb_d[l_ac].apcb024        = g_qryparam.return1
            LET g_apcb_d[l_ac].l_apcb024_desc = g_apcb_d[l_ac].apcb024
            DISPLAY BY NAME g_apcb_d[l_ac].apcb024 ,g_apcb_d[l_ac].l_apcb024_desc
            NEXT FIELD l_apcb024_desc
            
         BEFORE FIELD l_apcb012_desc                                    #150205-00012#1
            LET g_apcb_d[l_ac].l_apcb012_desc = g_apcb_d[l_ac].apcb012  #150205-00012#1   
            
         #產品類別 
         AFTER FIELD l_apcb012_desc
            IF NOT cl_null(g_apcb_d[l_ac].l_apcb012_desc) THEN
               IF ( g_apcb_d[l_ac].l_apcb012_desc != g_apcb_d_t.l_apcb012_desc OR g_apcb_d_t.l_apcb012_desc IS NULL ) THEN
                  LET g_apcb_d[l_ac].apcb012 = g_apcb_d[l_ac].l_apcb012_desc
                  IF l_glaa121 = 'N' THEN     #141218-00011#6
                     IF (g_apcb_d[l_ac].apcb012 != g_apcb_d_t.apcb012 OR g_apcb_d_t.apcb012 IS NULL) THEN
                        CALL s_voucher_glaq024_chk(g_apcb_d[l_ac].l_apcb012_desc)
                        IF NOT cl_null(g_errno) THEN
                           LET g_apcb_d[l_ac].apcb012        = g_apcb_d_t.apcb012
                           LET g_apcb_d[l_ac].l_apcb012_desc = g_apcb_d_t.l_apcb012_desc
                           DISPLAY BY NAME g_apcb_d[l_ac].apcb012,g_apcb_d[l_ac].l_apcb012_desc
                           NEXT FIELD CURRENT
                        END IF
                     END IF
                  END IF
               END IF
            ELSE
               LET g_apcb_d[l_ac].apcb012 = ''
            END IF
            LET g_apcb_d[l_ac].l_apcb012_desc = s_desc_show1(g_apcb_d[l_ac].apcb012,s_desc_get_rtaxl003_desc(g_apcb_d[l_ac].apcb012))
            LET g_apcb_d_t.l_apcb012_desc = g_apcb_d[l_ac].l_apcb012_desc
            DISPLAY BY NAME g_apcb_d[l_ac].apcb012,g_apcb_d[l_ac].l_apcb012_desc

         ON ACTION controlp INFIELD l_apcb012_desc
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_apcb_d[l_ac].l_apcb012_desc
            CALL q_rtax001()                          
            LET g_apcb_d[l_ac].apcb012        = g_qryparam.return1
            LET g_apcb_d[l_ac].l_apcb012_desc = g_apcb_d[l_ac].apcb012
            DISPLAY BY NAME g_apcb_d[l_ac].apcb012 ,g_apcb_d[l_ac].l_apcb012_desc
            NEXT FIELD l_apcb012_desc   
      
         BEFORE FIELD l_apcb016_desc                                    #150205-00012#1
            LET g_apcb_d[l_ac].l_apcb016_desc = g_apcb_d[l_ac].apcb016  #150205-00012#1
            
         #WBS
         AFTER FIELD l_apcb016_desc
            IF NOT cl_null(g_apcb_d[l_ac].l_apcb016_desc)  THEN
               IF ( g_apcb_d[l_ac].l_apcb016_desc != g_apcb_d_t.l_apcb016_desc OR g_apcb_d_t.l_apcb016_desc IS NULL ) THEN
                  LET g_apcb_d[l_ac].apcb016 = g_apcb_d[l_ac].l_apcb016_desc
                  IF l_glaa121 = 'N' THEN     #141218-00011#6
                     IF (g_apcb_d[l_ac].apcb016 != g_apcb_d_t.apcb016 OR g_apcb_d_t.apcb016 IS NULL) THEN
                        CALL s_voucher_glaq028_chk(g_apcb_d[l_ac].apcb015,g_apcb_d[l_ac].apcb016) 
                       #CALL s_aap_project_chk( g_apcb_d[l_ac].apcb016) RETURNING g_sub_success,g_errno
                        IF NOT cl_null(g_errno) THEN
                           LET g_apcb_d[l_ac].apcb016        = g_apcb_d_t.apcb016
                           LET g_apcb_d[l_ac].l_apcb016_desc = g_apcb_d_t.l_apcb016_desc
                           DISPLAY BY NAME g_apcb_d[l_ac].apcb016,g_apcb_d[l_ac].l_apcb016_desc
                           NEXT FIELD CURRENT
                        END IF
                     END IF
                  END IF
               END IF
            ELSE
               LET g_apcb_d[l_ac].apcb016 = ''
            END IF
            LET g_apcb_d[l_ac].l_apcb016_desc = s_desc_show1(g_apcb_d[l_ac].apcb016,s_desc_get_pjbbl004_desc(g_apcb_d[l_ac].apcb015,g_apcb_d[l_ac].apcb016))
            LET g_apcb_d_t.l_apcb016_desc = g_apcb_d[l_ac].l_apcb016_desc
            DISPLAY BY NAME g_apcb_d[l_ac].apcb011,g_apcb_d[l_ac].l_apcb016_desc
            
         ON ACTION controlp INFIELD l_apcb016_desc
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_apcb_d[l_ac].apcb016
            IF NOT cl_null(g_apcb_d[l_ac].apcb015) THEN
               LET g_qryparam.where = "pjbb012='1' AND pjbb001='",g_apcb_d[l_ac].apcb015,"'"
            ELSE
               LET g_qryparam.where = "pjbb012='1'"
            END IF  

            CALL q_pjbb002()
            LET g_apcb_d[l_ac].apcb016        = g_qryparam.return1
            LET g_apcb_d[l_ac].l_apcb016_desc = g_apcb_d[l_ac].apcb016
            DISPLAY BY NAME g_apcb_d[l_ac].apcb016,g_apcb_d[l_ac].l_apcb016_desc
            NEXT FIELD l_apcb016_desc
            
         BEFORE FIELD l_apcb015_desc                                    #150205-00012#1
            LET g_apcb_d[l_ac].l_apcb015_desc = g_apcb_d[l_ac].apcb015  #150205-00012#1   
            
         #專案代號
         AFTER FIELD l_apcb015_desc
            IF NOT cl_null(g_apcb_d[l_ac].l_apcb015_desc) THEN
               IF ( g_apcb_d[l_ac].l_apcb015_desc != g_apcb_d_t.l_apcb015_desc OR g_apcb_d_t.l_apcb015_desc IS NULL ) THEN
                  LET g_apcb_d[l_ac].apcb015 = g_apcb_d[l_ac].l_apcb015_desc
                  IF l_glaa121 = 'N' THEN     #141218-00011#6
                     IF (g_apcb_d[l_ac].apcb015 != g_apcb_d_t.apcb015 OR g_apcb_d_t.apcb015 IS NULL) THEN
                        CALL s_aap_project_chk( g_apcb_d[l_ac].apcb015) RETURNING g_sub_success,g_errno
                        IF NOT g_sub_success THEN
                           INITIALIZE g_errparam TO NULL
                           LET g_errparam.code = g_errno
                           LET g_errparam.extend = ''
                           LET g_errparam.popup = TRUE
                           CALL cl_err()
                           LET g_apcb_d[l_ac].apcb015        = g_apcb_d_t.apcb015
                           LET g_apcb_d[l_ac].l_apcb015_desc = g_apcb_d_t.l_apcb015_desc
                           DISPLAY BY NAME g_apcb_d[l_ac].apcb015,g_apcb_d[l_ac].l_apcb015_desc
                           NEXT FIELD CURRENT
                        END IF
                     END IF
                  END IF
               END IF
            ELSE
               LET g_apcb_d[l_ac].apcb015 = ''
            END IF
            LET g_apcb_d[l_ac].l_apcb015_desc = s_desc_show1(g_apcb_d[l_ac].apcb015,s_desc_get_project_desc(g_apcb_d[l_ac].apcb015))
            LET g_apcb_d_t.l_apcb015_desc = g_apcb_d[l_ac].l_apcb015_desc
            DISPLAY BY NAME g_apcb_d[l_ac].apcb011,g_apcb_d[l_ac].l_apcb015_desc
            
         ON ACTION controlp INFIELD l_apcb015_desc
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_apcb_d[l_ac].apcb015
            CALL q_pjba001()
            LET g_apcb_d[l_ac].apcb015        = g_qryparam.return1
            LET g_apcb_d[l_ac].l_apcb015_desc = g_apcb_d[l_ac].apcb015
            DISPLAY BY NAME g_apcb_d[l_ac].apcb015,g_apcb_d[l_ac].l_apcb015_desc
            NEXT FIELD l_apcb015_desc
         
         BEFORE FIELD l_apcb036_desc                                    #150205-00012#1
            LET g_apcb_d[l_ac].l_apcb036_desc = g_apcb_d[l_ac].apcb036  #150205-00012#1
            
         #客群
         AFTER FIELD l_apcb036_desc
            IF NOT cl_null(g_apcb_d[l_ac].l_apcb036_desc) THEN
               IF ( g_apcb_d[l_ac].l_apcb036_desc != g_apcb_d_t.l_apcb036_desc OR g_apcb_d_t.l_apcb036_desc IS NULL ) THEN
                  LET g_apcb_d[l_ac].apcb036 = g_apcb_d[l_ac].l_apcb036_desc
                  IF l_glaa121 = 'N' THEN     #141218-00011#6
                     IF (g_apcb_d[l_ac].apcb036 != g_apcb_d_t.apcb036 OR g_apcb_d_t.apcb036 IS NULL) THEN
                        IF NOT s_azzi650_chk_exist('281',g_apcb_d[l_ac].l_apcb036_desc) THEN
                           LET g_apcb_d[l_ac].apcb036        = g_apcb_d_t.apcb036
                           LET g_apcb_d[l_ac].l_apcb036_desc = g_apcb_d_t.l_apcb036_desc
                           DISPLAY BY NAME g_apcb_d[l_ac].apcb036,g_apcb_d[l_ac].l_apcb036_desc
                           NEXT FIELD CURRENT
                        END IF
                     END IF
                  END IF
               END IF
            ELSE
               LET g_apcb_d[l_ac].apcb036 = ''
            END IF
            LET g_apcb_d[l_ac].l_apcb036_desc = s_desc_show1(g_apcb_d[l_ac].apcb036,s_desc_get_acc_desc('281',g_apcb_d[l_ac].apcb036))
            LET g_apcb_d_t.l_apcb036_desc = g_apcb_d[l_ac].l_apcb036_desc
            DISPLAY BY NAME g_apcb_d[l_ac].apcb036,g_apcb_d[l_ac].l_apcb036_desc

         ON ACTION controlp INFIELD l_apcb036_desc
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_apcb_d[l_ac].l_apcb036_desc
            CALL q_oocq002_281()
            LET g_apcb_d[l_ac].apcb036        = g_qryparam.return1
            LET g_apcb_d[l_ac].l_apcb036_desc = g_apcb_d[l_ac].apcb036
            DISPLAY BY NAME g_apcb_d[l_ac].apcb036 ,g_apcb_d[l_ac].l_apcb036_desc
            NEXT FIELD l_apcb036_desc         
            
         #經營方式
         AFTER FIELD apcb033
            IF NOT cl_null(g_apcb_d[l_ac].apcb033) THEN
               IF ( g_apcb_d[l_ac].apcb033 != g_apcb_d_t.apcb033 OR g_apcb_d_t.apcb033 IS NULL ) THEN
                  IF l_glaa121 = 'N' THEN     #141218-00011#6
                     IF (g_apcb_d[l_ac].apcb033 != g_apcb_d_t.apcb033 OR g_apcb_d_t.apcb033 IS NULL) THEN
                        CALL s_voucher_glaq051_chk(g_apcb_d[l_ac].apcb033)
                        IF NOT cl_null(g_errno) THEN
                           LET g_apcb_d[l_ac].apcb033        = g_apcb_d_t.apcb033
                           LET g_apcb_d[l_ac].apcb033 = g_apcb_d_t.apcb033
                           DISPLAY BY NAME g_apcb_d[l_ac].apcb033,g_apcb_d[l_ac].apcb033
                           NEXT FIELD CURRENT
                        END IF
                     END IF
                  END IF
               END IF
            END IF
            DISPLAY BY NAME g_apcb_d[l_ac].apcb033
         
         BEFORE FIELD l_apcb034_desc                                    #150205-00012#1
            LET g_apcb_d[l_ac].l_apcb034_desc = g_apcb_d[l_ac].apcb034  #150205-00012#1
         #渠道
         AFTER FIELD l_apcb034_desc
            IF NOT cl_null(g_apcb_d[l_ac].l_apcb034_desc) THEN
               IF ( g_apcb_d[l_ac].l_apcb034_desc != g_apcb_d_t.l_apcb034_desc OR g_apcb_d_t.l_apcb034_desc IS NULL ) THEN
                  LET g_apcb_d[l_ac].apcb034 = g_apcb_d[l_ac].l_apcb034_desc
                  IF l_glaa121 = 'N' THEN     #141218-00011#6
                     IF (g_apcb_d[l_ac].apcb034 != g_apcb_d_t.apcb034 OR g_apcb_d_t.apcb034 IS NULL) THEN
                        CALL s_voucher_glaq052_chk(g_apcb_d[l_ac].l_apcb034_desc)
                        IF NOT cl_null(g_errno) THEN
                           LET g_apcb_d[l_ac].apcb034        = g_apcb_d_t.apcb034
                           LET g_apcb_d[l_ac].l_apcb034_desc = g_apcb_d_t.l_apcb034_desc
                           DISPLAY BY NAME g_apcb_d[l_ac].apcb034,g_apcb_d[l_ac].l_apcb034_desc
                           NEXT FIELD CURRENT
                        END IF
                     END IF
                  END IF
               END IF
            ELSE
               LET g_apcb_d[l_ac].apcb034 = ''
            END IF
            LET g_apcb_d[l_ac].l_apcb034_desc = s_desc_show1(g_apcb_d[l_ac].apcb034,s_desc_get_oojdl003_desc(g_apcb_d[l_ac].apcb034))
            LET g_apcb_d_t.l_apcb034_desc = g_apcb_d[l_ac].l_apcb034_desc
            DISPLAY BY NAME g_apcb_d[l_ac].apcb034,g_apcb_d[l_ac].l_apcb034_desc

         ON ACTION controlp INFIELD l_apcb034_desc
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_apcb_d[l_ac].l_apcb034_desc
            CALL q_oojd001_2()
            LET g_apcb_d[l_ac].apcb034        = g_qryparam.return1
            LET g_apcb_d[l_ac].l_apcb034_desc = g_apcb_d[l_ac].apcb034
            DISPLAY BY NAME g_apcb_d[l_ac].apcb034 ,g_apcb_d[l_ac].l_apcb034_desc
            NEXT FIELD l_apcb034_desc
            
         BEFORE FIELD l_apcb035_desc                                    #150205-00012#1
            LET g_apcb_d[l_ac].l_apcb035_desc = g_apcb_d[l_ac].apcb035  #150205-00012#1   
         #品牌
         AFTER FIELD l_apcb035_desc
            IF NOT cl_null(g_apcb_d[l_ac].l_apcb035_desc) THEN
               IF ( g_apcb_d[l_ac].l_apcb035_desc != g_apcb_d_t.l_apcb035_desc OR g_apcb_d_t.l_apcb035_desc IS NULL ) THEN
                  LET g_apcb_d[l_ac].apcb035 = g_apcb_d[l_ac].l_apcb035_desc
                  IF l_glaa121 = 'N' THEN     #141218-00011#6
                     IF (g_apcb_d[l_ac].apcb035 != g_apcb_d_t.apcb035 OR g_apcb_d_t.apcb035 IS NULL) THEN
                        IF NOT s_azzi650_chk_exist('2002',g_apcb_d[l_ac].l_apcb035_desc) THEN
                           LET g_apcb_d[l_ac].apcb035        = g_apcb_d_t.apcb035
                           LET g_apcb_d[l_ac].l_apcb035_desc = g_apcb_d_t.l_apcb035_desc
                           DISPLAY BY NAME g_apcb_d[l_ac].apcb035,g_apcb_d[l_ac].l_apcb035_desc
                           NEXT FIELD CURRENT
                        END IF
                     END IF
                  END IF
               END IF
            ELSE
               LET g_apcb_d[l_ac].apcb035 = ''
            END IF
            LET g_apcb_d[l_ac].l_apcb035_desc = s_desc_show1(g_apcb_d[l_ac].apcb035,s_desc_get_acc_desc('2002',g_apcb_d[l_ac].apcb035))
            LET g_apcb_d_t.l_apcb035_desc = g_apcb_d[l_ac].l_apcb035_desc
            DISPLAY BY NAME g_apcb_d[l_ac].apcb035,g_apcb_d[l_ac].l_apcb035_desc

         ON ACTION controlp INFIELD l_apcb035_desc
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_apcb_d[l_ac].l_apcb035_desc
            CALL q_oocq002_2002()
            LET g_apcb_d[l_ac].apcb035        = g_qryparam.return1
            LET g_apcb_d[l_ac].l_apcb035_desc = g_apcb_d[l_ac].apcb035
            DISPLAY BY NAME g_apcb_d[l_ac].apcb035 ,g_apcb_d[l_ac].l_apcb035_desc
            NEXT FIELD l_apcb035_desc
            
         #自由核算項一
         BEFORE FIELD l_apcb037_desc
            CALL s_fin_get_glae009(l_glad.glad0171) RETURNING l_glae009
            LET g_apcb_d[l_ac].l_apcb037_desc = g_apcb_d[l_ac].apcb037  #150205-00012#1
            
         AFTER FIELD l_apcb037_desc
            IF NOT cl_null(g_apcb_d[l_ac].l_apcb037_desc) THEN
               IF ( g_apcb_d[l_ac].l_apcb037_desc != g_apcb_d_t.l_apcb037_desc OR g_apcb_d_t.l_apcb037_desc IS NULL ) THEN
                  LET g_apcb_d[l_ac].apcb037 = g_apcb_d[l_ac].l_apcb037_desc
                  IF l_glaa121 = 'N' THEN     #141218-00011#6
                     IF (g_apcb_d[l_ac].apcb037 != g_apcb_d_t.apcb037 OR g_apcb_d_t.apcb037 IS NULL) THEN
                        CALL s_voucher_free_account_chk(l_glad.glad0171,g_apcb_d[l_ac].l_apcb037_desc,l_glad.glad0172) RETURNING g_errno
                        IF NOT cl_null(g_errno) THEN
                           LET g_apcb_d[l_ac].apcb037        = g_apcb_d_t.apcb037
                           LET g_apcb_d[l_ac].l_apcb037_desc = g_apcb_d_t.l_apcb037_desc
                           DISPLAY BY NAME g_apcb_d[l_ac].apcb037,g_apcb_d[l_ac].l_apcb037_desc
                           NEXT FIELD CURRENT
                        END IF
                     END IF
                  END IF
               END IF
            ELSE
               LET g_apcb_d[l_ac].apcb037 = ''
            END IF
            LET g_apcb_d[l_ac].l_apcb037_desc = s_desc_show1(g_apcb_d[l_ac].apcb037,s_fin_get_accting_desc(l_glad.glad0171,g_apcb_d[l_ac].apcb037))
            LET g_apcb_d_t.l_apcb037_desc = g_apcb_d[l_ac].l_apcb037_desc
            DISPLAY BY NAME g_apcb_d[l_ac].apcb037,g_apcb_d[l_ac].l_apcb037_desc

         ON ACTION controlp INFIELD l_apcb037_desc
            IF NOT cl_null(l_glae009) THEN
               INITIALIZE g_qryparam.* TO NULL
               LET g_qryparam.state = 'i'
               LET g_qryparam.reqry = FALSE
               LET g_qryparam.default1 = g_apcb_d[l_ac].l_apcb037_desc
               IF l_glae009 = 'q_glaf002' THEN    
                  LET g_qryparam.where = "glaf001 = '",l_glad.glad0171,"'" #自由核算項類型
               END IF 
               CALL q_agli041(l_glae009) 
               LET g_apcb_d[l_ac].apcb037        = g_qryparam.return1
               LET g_apcb_d[l_ac].l_apcb037_desc = g_apcb_d[l_ac].apcb037
               DISPLAY BY NAME g_apcb_d[l_ac].apcb037 ,g_apcb_d[l_ac].l_apcb037_desc
               NEXT FIELD l_apcb037_desc
            END IF
         
         #自由核算項二
         BEFORE FIELD l_apcb038_desc
            CALL s_fin_get_glae009(l_glad.glad0181) RETURNING l_glae009
            LET g_apcb_d[l_ac].l_apcb038_desc = g_apcb_d[l_ac].apcb038  #150205-00012#1
         
         AFTER FIELD l_apcb038_desc
            IF NOT cl_null(g_apcb_d[l_ac].l_apcb038_desc) THEN
               IF ( g_apcb_d[l_ac].l_apcb038_desc != g_apcb_d_t.l_apcb038_desc OR g_apcb_d_t.l_apcb038_desc IS NULL ) THEN
                  LET g_apcb_d[l_ac].apcb038 = g_apcb_d[l_ac].l_apcb038_desc
                  IF l_glaa121 = 'N' THEN     #141218-00011#6
                     IF (g_apcb_d[l_ac].apcb038 != g_apcb_d_t.apcb038 OR g_apcb_d_t.apcb038 IS NULL) THEN
                        CALL s_voucher_free_account_chk(l_glad.glad0181,g_apcb_d[l_ac].l_apcb038_desc,l_glad.glad0182) RETURNING g_errno
                        IF NOT cl_null(g_errno) THEN
                           LET g_apcb_d[l_ac].apcb038        = g_apcb_d_t.apcb038
                           LET g_apcb_d[l_ac].l_apcb038_desc = g_apcb_d_t.l_apcb038_desc
                           DISPLAY BY NAME g_apcb_d[l_ac].apcb038,g_apcb_d[l_ac].l_apcb038_desc
                           NEXT FIELD CURRENT
                        END IF
                     END IF
                  END IF
               END IF
            ELSE
               LET g_apcb_d[l_ac].apcb038 = ''
            END IF
            LET g_apcb_d[l_ac].l_apcb038_desc = s_desc_show1(g_apcb_d[l_ac].apcb038,s_fin_get_accting_desc(l_glad.glad0181,g_apcb_d[l_ac].apcb038))
            LET g_apcb_d_t.l_apcb038_desc = g_apcb_d[l_ac].l_apcb038_desc
            DISPLAY BY NAME g_apcb_d[l_ac].apcb038,g_apcb_d[l_ac].l_apcb038_desc

         ON ACTION controlp INFIELD l_apcb038_desc
            IF NOT cl_null(l_glae009) THEN
               INITIALIZE g_qryparam.* TO NULL
               LET g_qryparam.state = 'i'
               LET g_qryparam.reqry = FALSE
               LET g_qryparam.default1 = g_apcb_d[l_ac].l_apcb038_desc
               IF l_glae009 = 'q_glaf002' THEN    
                  LET g_qryparam.where = "glaf001 = '",l_glad.glad0181,"'" #自由核算項類型
               END IF 
               CALL q_agli041(l_glae009) 
               LET g_apcb_d[l_ac].apcb038        = g_qryparam.return1
               LET g_apcb_d[l_ac].l_apcb038_desc = g_apcb_d[l_ac].apcb038
               DISPLAY BY NAME g_apcb_d[l_ac].apcb038 ,g_apcb_d[l_ac].l_apcb038_desc
               NEXT FIELD l_apcb038_desc
            END IF    
         
         #自由核算項三
         BEFORE FIELD l_apcb039_desc
            CALL s_fin_get_glae009(l_glad.glad0191) RETURNING l_glae009
            LET g_apcb_d[l_ac].l_apcb039_desc = g_apcb_d[l_ac].apcb039  #150205-00012#1
         
         AFTER FIELD l_apcb039_desc
            IF NOT cl_null(g_apcb_d[l_ac].l_apcb039_desc)  THEN
               IF ( g_apcb_d[l_ac].l_apcb039_desc != g_apcb_d_t.l_apcb039_desc OR g_apcb_d_t.l_apcb039_desc IS NULL ) THEN
                  LET g_apcb_d[l_ac].apcb039 = g_apcb_d[l_ac].l_apcb039_desc
                  IF l_glaa121 = 'N' THEN     #141218-00011#6
                     IF (g_apcb_d[l_ac].apcb039 != g_apcb_d_t.apcb039 OR g_apcb_d_t.apcb039 IS NULL) THEN
                        CALL s_voucher_free_account_chk(l_glad.glad0191,g_apcb_d[l_ac].l_apcb039_desc,l_glad.glad0192) RETURNING g_errno
                        IF NOT cl_null(g_errno) THEN
                           LET g_apcb_d[l_ac].apcb039        = g_apcb_d_t.apcb039
                           LET g_apcb_d[l_ac].l_apcb039_desc = g_apcb_d_t.l_apcb039_desc
                           DISPLAY BY NAME g_apcb_d[l_ac].apcb039,g_apcb_d[l_ac].l_apcb039_desc
                           NEXT FIELD CURRENT
                        END IF
                     END IF
                  END IF
               END IF
            ELSE
               LET g_apcb_d[l_ac].apcb039 = ''
            END IF
            LET g_apcb_d[l_ac].l_apcb039_desc = s_desc_show1(g_apcb_d[l_ac].apcb039,s_fin_get_accting_desc(l_glad.glad0191,g_apcb_d[l_ac].apcb039))
            LET g_apcb_d_t.l_apcb039_desc = g_apcb_d[l_ac].l_apcb039_desc
            DISPLAY BY NAME g_apcb_d[l_ac].apcb039,g_apcb_d[l_ac].l_apcb039_desc

         ON ACTION controlp INFIELD l_apcb039_desc
            IF NOT cl_null(l_glae009) THEN
               INITIALIZE g_qryparam.* TO NULL
               LET g_qryparam.state = 'i'
               LET g_qryparam.reqry = FALSE
               LET g_qryparam.default1 = g_apcb_d[l_ac].l_apcb039_desc
               IF l_glae009 = 'q_glaf002' THEN    
                  LET g_qryparam.where = "glaf001 = '",l_glad.glad0191,"'" #自由核算項類型
               END IF 
               CALL q_agli041(l_glae009) 
               LET g_apcb_d[l_ac].apcb039        = g_qryparam.return1
               LET g_apcb_d[l_ac].l_apcb039_desc = g_apcb_d[l_ac].apcb039
               DISPLAY BY NAME g_apcb_d[l_ac].apcb039 ,g_apcb_d[l_ac].l_apcb039_desc
               NEXT FIELD l_apcb039_desc
            END IF
            
         #自由核算項四
         BEFORE FIELD l_apcb040_desc
            CALL s_fin_get_glae009(l_glad.glad0201) RETURNING l_glae009
            LET g_apcb_d[l_ac].l_apcb040_desc = g_apcb_d[l_ac].apcb040  #150205-00012#1
         
         AFTER FIELD l_apcb040_desc
            IF NOT cl_null(g_apcb_d[l_ac].l_apcb040_desc) THEN
               IF ( g_apcb_d[l_ac].l_apcb040_desc != g_apcb_d_t.l_apcb040_desc OR g_apcb_d_t.l_apcb040_desc IS NULL ) THEN
                  LET g_apcb_d[l_ac].apcb040 = g_apcb_d[l_ac].l_apcb040_desc
                  IF l_glaa121 = 'N' THEN     #141218-00011#6
                     IF (g_apcb_d[l_ac].apcb040 != g_apcb_d_t.apcb040 OR g_apcb_d_t.apcb040 IS NULL) THEN
                        CALL s_voucher_free_account_chk(l_glad.glad0201,g_apcb_d[l_ac].l_apcb040_desc,l_glad.glad0202) RETURNING g_errno
                        IF NOT cl_null(g_errno) THEN
                           LET g_apcb_d[l_ac].apcb040        = g_apcb_d_t.apcb040
                           LET g_apcb_d[l_ac].l_apcb040_desc = g_apcb_d_t.l_apcb040_desc
                           DISPLAY BY NAME g_apcb_d[l_ac].apcb040,g_apcb_d[l_ac].l_apcb040_desc
                           NEXT FIELD CURRENT
                        END IF
                     END IF
                  END IF
               END IF
            ELSE
               LET g_apcb_d[l_ac].apcb040 = ''
            END IF
            LET g_apcb_d[l_ac].l_apcb040_desc = s_desc_show1(g_apcb_d[l_ac].apcb040,s_fin_get_accting_desc(l_glad.glad0201,g_apcb_d[l_ac].apcb040))
            LET g_apcb_d_t.l_apcb040_desc = g_apcb_d[l_ac].l_apcb040_desc
            DISPLAY BY NAME g_apcb_d[l_ac].apcb040,g_apcb_d[l_ac].l_apcb040_desc

         ON ACTION controlp INFIELD l_apcb040_desc
            IF NOT cl_null(l_glae009) THEN
               INITIALIZE g_qryparam.* TO NULL
               LET g_qryparam.state = 'i'
               LET g_qryparam.reqry = FALSE
               LET g_qryparam.default1 = g_apcb_d[l_ac].l_apcb040_desc
               IF l_glae009 = 'q_glaf002' THEN    
                  LET g_qryparam.where = "glaf001 = '",l_glad.glad0201,"'" #自由核算項類型
               END IF 
               CALL q_agli041(l_glae009) 
               LET g_apcb_d[l_ac].apcb040        = g_qryparam.return1
               LET g_apcb_d[l_ac].l_apcb040_desc = g_apcb_d[l_ac].apcb040
               DISPLAY BY NAME g_apcb_d[l_ac].apcb040 ,g_apcb_d[l_ac].l_apcb040_desc
               NEXT FIELD l_apcb040_desc
            END IF    
         
         #自由核算項五
         BEFORE FIELD l_apcb041_desc
            CALL s_fin_get_glae009(l_glad.glad0211) RETURNING l_glae009
            LET g_apcb_d[l_ac].l_apcb041_desc = g_apcb_d[l_ac].apcb041  #150205-00012#1
         
         AFTER FIELD l_apcb041_desc 
            IF NOT cl_null(g_apcb_d[l_ac].l_apcb041_desc) THEN
               IF ( g_apcb_d[l_ac].l_apcb041_desc != g_apcb_d_t.l_apcb041_desc OR g_apcb_d_t.l_apcb041_desc IS NULL ) THEN
                  LET g_apcb_d[l_ac].apcb041 = g_apcb_d[l_ac].l_apcb041_desc
                  IF l_glaa121 = 'N' THEN     #141218-00011#6
                     IF (g_apcb_d[l_ac].apcb041 != g_apcb_d_t.apcb041 OR g_apcb_d_t.apcb041 IS NULL) THEN
                        CALL s_voucher_free_account_chk(l_glad.glad0211,g_apcb_d[l_ac].l_apcb041_desc,l_glad.glad0212) RETURNING g_errno
                        IF NOT cl_null(g_errno) THEN
                           LET g_apcb_d[l_ac].apcb041        = g_apcb_d_t.apcb041
                           LET g_apcb_d[l_ac].l_apcb041_desc = g_apcb_d_t.l_apcb041_desc
                           DISPLAY BY NAME g_apcb_d[l_ac].apcb041,g_apcb_d[l_ac].l_apcb041_desc
                           NEXT FIELD CURRENT
                        END IF
                     END IF
                  END IF
               END IF
            ELSE
               LET g_apcb_d[l_ac].apcb041 = ''
            END IF
            LET g_apcb_d[l_ac].l_apcb041_desc = s_desc_show1(g_apcb_d[l_ac].apcb041,s_fin_get_accting_desc(l_glad.glad0211,g_apcb_d[l_ac].apcb041))
            LET g_apcb_d_t.l_apcb041_desc = g_apcb_d[l_ac].l_apcb041_desc
            DISPLAY BY NAME g_apcb_d[l_ac].apcb041,g_apcb_d[l_ac].l_apcb041_desc

         ON ACTION controlp INFIELD l_apcb041_desc
            IF NOT cl_null(l_glae009) THEN
               INITIALIZE g_qryparam.* TO NULL
               LET g_qryparam.state = 'i'
               LET g_qryparam.reqry = FALSE
               LET g_qryparam.default1 = g_apcb_d[l_ac].l_apcb041_desc
               IF l_glae009 = 'q_glaf002' THEN    
                  LET g_qryparam.where = "glaf001 = '",l_glad.glad0211,"'" #自由核算項類型
               END IF 
               CALL q_agli041(l_glae009) 
               LET g_apcb_d[l_ac].apcb041        = g_qryparam.return1
               LET g_apcb_d[l_ac].l_apcb041_desc = g_apcb_d[l_ac].apcb041
               DISPLAY BY NAME g_apcb_d[l_ac].apcb041 ,g_apcb_d[l_ac].l_apcb041_desc
               NEXT FIELD l_apcb041_desc
            END IF             

         #自由核算項六
         BEFORE FIELD l_apcb042_desc
            CALL s_fin_get_glae009(l_glad.glad0221) RETURNING l_glae009
            LET g_apcb_d[l_ac].l_apcb042_desc = g_apcb_d[l_ac].apcb042  #150205-00012#1
         
         AFTER FIELD l_apcb042_desc
            IF NOT cl_null(g_apcb_d[l_ac].l_apcb042_desc) THEN
               IF ( g_apcb_d[l_ac].l_apcb042_desc != g_apcb_d_t.l_apcb042_desc OR g_apcb_d_t.l_apcb042_desc IS NULL ) THEN
                  LET g_apcb_d[l_ac].apcb042 = g_apcb_d[l_ac].l_apcb042_desc
                  IF l_glaa121 = 'N' THEN     #141218-00011#6
                     IF (g_apcb_d[l_ac].apcb042 != g_apcb_d_t.apcb042 OR g_apcb_d_t.apcb042 IS NULL) THEN
                        CALL s_voucher_free_account_chk(l_glad.glad0221,g_apcb_d[l_ac].l_apcb042_desc,l_glad.glad0222) RETURNING g_errno
                        IF NOT cl_null(g_errno) THEN
                           LET g_apcb_d[l_ac].apcb042        = g_apcb_d_t.apcb042
                           LET g_apcb_d[l_ac].l_apcb042_desc = g_apcb_d_t.l_apcb042_desc
                           DISPLAY BY NAME g_apcb_d[l_ac].apcb042,g_apcb_d[l_ac].l_apcb042_desc
                           NEXT FIELD CURRENT
                        END IF
                     END IF
                  END IF
               END IF
            ELSE
               LET g_apcb_d[l_ac].apcb042 = ''
            END IF
            LET g_apcb_d[l_ac].l_apcb042_desc = s_desc_show1(g_apcb_d[l_ac].apcb042,s_fin_get_accting_desc(l_glad.glad0221,g_apcb_d[l_ac].apcb042))
            LET g_apcb_d_t.l_apcb042_desc = g_apcb_d[l_ac].l_apcb042_desc
            DISPLAY BY NAME g_apcb_d[l_ac].apcb042,g_apcb_d[l_ac].l_apcb042_desc

         ON ACTION controlp INFIELD l_apcb042_desc
            IF NOT cl_null(l_glae009) THEN
               INITIALIZE g_qryparam.* TO NULL
               LET g_qryparam.state = 'i'
               LET g_qryparam.reqry = FALSE
               LET g_qryparam.default1 = g_apcb_d[l_ac].l_apcb042_desc
               IF l_glae009 = 'q_glaf002' THEN    
                  LET g_qryparam.where = "glaf001 = '",l_glad.glad0221,"'" #自由核算項類型
               END IF 
               CALL q_agli041(l_glae009) 
               LET g_apcb_d[l_ac].apcb042        = g_qryparam.return1
               LET g_apcb_d[l_ac].l_apcb042_desc = g_apcb_d[l_ac].apcb042
               DISPLAY BY NAME g_apcb_d[l_ac].apcb042 ,g_apcb_d[l_ac].l_apcb042_desc
               NEXT FIELD l_apcb042_desc
            END IF
         
         #自由核算項七
         BEFORE FIELD l_apcb043_desc
            CALL s_fin_get_glae009(l_glad.glad0231) RETURNING l_glae009
            LET g_apcb_d[l_ac].l_apcb043_desc = g_apcb_d[l_ac].apcb043  #150205-00012#1
         
         AFTER FIELD l_apcb043_desc
            IF NOT cl_null(g_apcb_d[l_ac].l_apcb043_desc) THEN
               IF ( g_apcb_d[l_ac].l_apcb043_desc != g_apcb_d_t.l_apcb043_desc OR g_apcb_d_t.l_apcb043_desc IS NULL ) THEN
                  LET g_apcb_d[l_ac].apcb043 = g_apcb_d[l_ac].l_apcb043_desc
                  IF l_glaa121 = 'N' THEN     #141218-00011#6
                     IF (g_apcb_d[l_ac].apcb043 != g_apcb_d_t.apcb043 OR g_apcb_d_t.apcb043 IS NULL) THEN
                        CALL s_voucher_free_account_chk(l_glad.glad0231,g_apcb_d[l_ac].l_apcb043_desc,l_glad.glad0232) RETURNING g_errno
                        IF NOT cl_null(g_errno) THEN
                           LET g_apcb_d[l_ac].apcb043        = g_apcb_d_t.apcb043
                           LET g_apcb_d[l_ac].l_apcb043_desc = g_apcb_d_t.l_apcb043_desc
                           DISPLAY BY NAME g_apcb_d[l_ac].apcb043,g_apcb_d[l_ac].l_apcb043_desc
                           NEXT FIELD CURRENT
                        END IF
                     END IF
                  END IF
               END IF
            ELSE
               LET g_apcb_d[l_ac].apcb043 = ''
            END IF
            LET g_apcb_d[l_ac].l_apcb043_desc = s_desc_show1(g_apcb_d[l_ac].apcb043,s_fin_get_accting_desc(l_glad.glad0231,g_apcb_d[l_ac].apcb043))
            LET g_apcb_d_t.l_apcb043_desc = g_apcb_d[l_ac].l_apcb043_desc
            DISPLAY BY NAME g_apcb_d[l_ac].apcb043,g_apcb_d[l_ac].l_apcb043_desc

         ON ACTION controlp INFIELD l_apcb043_desc
            IF NOT cl_null(l_glae009) THEN
               INITIALIZE g_qryparam.* TO NULL
               LET g_qryparam.state = 'i'
               LET g_qryparam.reqry = FALSE
               LET g_qryparam.default1 = g_apcb_d[l_ac].l_apcb043_desc
               IF l_glae009 = 'q_glaf002' THEN    
                  LET g_qryparam.where = "glaf001 = '",l_glad.glad0231,"'" #自由核算項類型
               END IF 
               CALL q_agli041(l_glae009) 
               LET g_apcb_d[l_ac].apcb043        = g_qryparam.return1
               LET g_apcb_d[l_ac].l_apcb043_desc = g_apcb_d[l_ac].apcb043
               DISPLAY BY NAME g_apcb_d[l_ac].apcb043 ,g_apcb_d[l_ac].l_apcb043_desc
               NEXT FIELD l_apcb043_desc
            END IF    
         
         #自由核算項八
         BEFORE FIELD l_apcb044_desc
            CALL s_fin_get_glae009(l_glad.glad0241) RETURNING l_glae009
            LET g_apcb_d[l_ac].l_apcb044_desc = g_apcb_d[l_ac].apcb044  #150205-00012#1
         
         AFTER FIELD l_apcb044_desc
            IF NOT cl_null(g_apcb_d[l_ac].l_apcb044_desc) THEN
               IF ( g_apcb_d[l_ac].l_apcb044_desc != g_apcb_d_t.l_apcb044_desc OR g_apcb_d_t.l_apcb044_desc IS NULL ) THEN
                  LET g_apcb_d[l_ac].apcb044 = g_apcb_d[l_ac].l_apcb044_desc
                  IF l_glaa121 = 'N' THEN     #141218-00011#6
                     IF (g_apcb_d[l_ac].apcb044 != g_apcb_d_t.apcb044 OR g_apcb_d_t.apcb044 IS NULL) THEN
                        CALL s_voucher_free_account_chk(l_glad.glad0241,g_apcb_d[l_ac].l_apcb044_desc,l_glad.glad0242) RETURNING g_errno
                        IF NOT cl_null(g_errno) THEN
                           LET g_apcb_d[l_ac].apcb044        = g_apcb_d_t.apcb044
                           LET g_apcb_d[l_ac].l_apcb044_desc = g_apcb_d_t.l_apcb044_desc
                           DISPLAY BY NAME g_apcb_d[l_ac].apcb044,g_apcb_d[l_ac].l_apcb044_desc
                           NEXT FIELD CURRENT
                        END IF
                     END IF
                  END IF
               END IF
            ELSE
               LET g_apcb_d[l_ac].apcb044 = ''
            END IF
            LET g_apcb_d[l_ac].l_apcb044_desc = s_desc_show1(g_apcb_d[l_ac].apcb044,s_fin_get_accting_desc(l_glad.glad0241,g_apcb_d[l_ac].apcb044))
            LET g_apcb_d_t.l_apcb044_desc = g_apcb_d[l_ac].l_apcb044_desc
            DISPLAY BY NAME g_apcb_d[l_ac].apcb044,g_apcb_d[l_ac].l_apcb044_desc

         ON ACTION controlp INFIELD l_apcb044_desc
            IF NOT cl_null(l_glae009) THEN
               INITIALIZE g_qryparam.* TO NULL
               LET g_qryparam.state = 'i'
               LET g_qryparam.reqry = FALSE
               LET g_qryparam.default1 = g_apcb_d[l_ac].l_apcb044_desc
               IF l_glae009 = 'q_glaf002' THEN    
                  LET g_qryparam.where = "glaf001 = '",l_glad.glad0241,"'" #自由核算項類型
               END IF 
               CALL q_agli041(l_glae009) 
               LET g_apcb_d[l_ac].apcb044        = g_qryparam.return1
               LET g_apcb_d[l_ac].l_apcb044_desc = g_apcb_d[l_ac].apcb044
               DISPLAY BY NAME g_apcb_d[l_ac].apcb044 ,g_apcb_d[l_ac].l_apcb044_desc
               NEXT FIELD l_apcb044_desc
            END IF
            
         #自由核算項九
         BEFORE FIELD l_apcb045_desc
            CALL s_fin_get_glae009(l_glad.glad0251) RETURNING l_glae009
            LET g_apcb_d[l_ac].l_apcb045_desc = g_apcb_d[l_ac].apcb045  #150205-00012#1
         
         AFTER FIELD l_apcb045_desc
            IF NOT cl_null(g_apcb_d[l_ac].l_apcb045_desc) THEN
               IF ( g_apcb_d[l_ac].l_apcb045_desc != g_apcb_d_t.l_apcb045_desc OR g_apcb_d_t.l_apcb045_desc IS NULL ) THEN
                  LET g_apcb_d[l_ac].apcb045 = g_apcb_d[l_ac].l_apcb045_desc
                  IF l_glaa121 = 'N' THEN     #141218-00011#6
                     IF (g_apcb_d[l_ac].apcb045 != g_apcb_d_t.apcb045 OR g_apcb_d_t.apcb045 IS NULL) THEN
                        CALL s_voucher_free_account_chk(l_glad.glad0251,g_apcb_d[l_ac].l_apcb045_desc,l_glad.glad0252) RETURNING g_errno
                        IF NOT cl_null(g_errno) THEN
                           LET g_apcb_d[l_ac].apcb045        = g_apcb_d_t.apcb045
                           LET g_apcb_d[l_ac].l_apcb045_desc = g_apcb_d_t.l_apcb045_desc
                           DISPLAY BY NAME g_apcb_d[l_ac].apcb045,g_apcb_d[l_ac].l_apcb045_desc
                           NEXT FIELD CURRENT
                        END IF
                     END IF
                  END IF
               END IF
            ELSE
               LET g_apcb_d[l_ac].apcb045 = ''
            END IF
            LET g_apcb_d[l_ac].l_apcb045_desc = s_desc_show1(g_apcb_d[l_ac].apcb045,s_fin_get_accting_desc(l_glad.glad0251,g_apcb_d[l_ac].apcb045))
            LET g_apcb_d_t.l_apcb045_desc = g_apcb_d[l_ac].l_apcb045_desc
            DISPLAY BY NAME g_apcb_d[l_ac].apcb045,g_apcb_d[l_ac].l_apcb045_desc

         ON ACTION controlp INFIELD l_apcb045_desc
            IF NOT cl_null(l_glae009) THEN
               INITIALIZE g_qryparam.* TO NULL
               LET g_qryparam.state = 'i'
               LET g_qryparam.reqry = FALSE
               LET g_qryparam.default1 = g_apcb_d[l_ac].l_apcb045_desc
               IF l_glae009 = 'q_glaf002' THEN    
                  LET g_qryparam.where = "glaf001 = '",l_glad.glad0251,"'" #自由核算項類型
               END IF 
               CALL q_agli041(l_glae009) 
               LET g_apcb_d[l_ac].apcb045        = g_qryparam.return1
               LET g_apcb_d[l_ac].l_apcb045_desc = g_apcb_d[l_ac].apcb045
               DISPLAY BY NAME g_apcb_d[l_ac].apcb045 ,g_apcb_d[l_ac].l_apcb045_desc
               NEXT FIELD l_apcb045_desc
            END IF    
         
         #自由核算項十
         BEFORE FIELD l_apcb046_desc
            CALL s_fin_get_glae009(l_glad.glad0261) RETURNING l_glae009
            LET g_apcb_d[l_ac].l_apcb046_desc = g_apcb_d[l_ac].apcb046  #150205-00012#1
         
         AFTER FIELD l_apcb046_desc
            IF NOT cl_null(g_apcb_d[l_ac].l_apcb046_desc)  THEN
               IF ( g_apcb_d[l_ac].l_apcb046_desc != g_apcb_d_t.l_apcb046_desc OR g_apcb_d_t.l_apcb046_desc IS NULL ) THEN
                  LET g_apcb_d[l_ac].apcb046 = g_apcb_d[l_ac].l_apcb046_desc
                  IF l_glaa121 = 'N' THEN     #141218-00011#6
                     IF (g_apcb_d[l_ac].apcb046 != g_apcb_d_t.apcb046 OR g_apcb_d_t.apcb046 IS NULL) THEN
                        CALL s_voucher_free_account_chk(l_glad.glad0261,g_apcb_d[l_ac].l_apcb046_desc,l_glad.glad0262) RETURNING g_errno
                        IF NOT cl_null(g_errno) THEN
                           LET g_apcb_d[l_ac].apcb046        = g_apcb_d_t.apcb046
                           LET g_apcb_d[l_ac].l_apcb046_desc = g_apcb_d_t.l_apcb046_desc
                           DISPLAY BY NAME g_apcb_d[l_ac].apcb046,g_apcb_d[l_ac].l_apcb046_desc
                           NEXT FIELD CURRENT
                        END IF
                     END IF
                  END IF
               END IF
            ELSE
               LET g_apcb_d[l_ac].apcb046 = ''
            END IF
            LET g_apcb_d[l_ac].l_apcb046_desc = s_desc_show1(g_apcb_d[l_ac].apcb046,s_fin_get_accting_desc(l_glad.glad0261,g_apcb_d[l_ac].apcb046))
            LET g_apcb_d_t.l_apcb046_desc = g_apcb_d[l_ac].l_apcb046_desc
            DISPLAY BY NAME g_apcb_d[l_ac].apcb046,g_apcb_d[l_ac].l_apcb046_desc

         ON ACTION controlp INFIELD l_apcb046_desc
            IF NOT cl_null(l_glae009) THEN
               INITIALIZE g_qryparam.* TO NULL
               LET g_qryparam.state = 'i'
               LET g_qryparam.reqry = FALSE
               LET g_qryparam.default1 = g_apcb_d[l_ac].l_apcb046_desc
               IF l_glae009 = 'q_glaf002' THEN    
                  LET g_qryparam.where = "glaf001 = '",l_glad.glad0261,"'" #自由核算項類型
               END IF 
               CALL q_agli041(l_glae009) 
               LET g_apcb_d[l_ac].apcb046        = g_qryparam.return1
               LET g_apcb_d[l_ac].l_apcb046_desc = g_apcb_d[l_ac].apcb046
               DISPLAY BY NAME g_apcb_d[l_ac].apcb046 ,g_apcb_d[l_ac].l_apcb046_desc
               NEXT FIELD l_apcb046_desc
            END IF
       
       ON ACTION accept   #150206-00013#3  
          ACCEPT DIALOG   #150206-00013#3  
                  
       AFTER INPUT
           ##150210-00009#1--Mark
           ##141202-00061-15--(S)
           #CALL s_aooi200_get_slip(l_apcadocno) RETURNING g_sub_success,l_ap_slip               
           #CALL s_fin_get_doc_para(l_apcald,l_glaacomp,l_ap_slip,'D-FIN-0030') RETURNING l_dfin0030
           #IF l_glaa121 = 'Y' AND l_dfin0030 = 'Y'THEN
           #   CALL s_transaction_begin()
           #   CALL s_pre_voucher_ins('AP','P10',g_apcb_d[l_ac].apcbld , g_apcb_d[l_ac].apcbdocno,l_apcadocdt,'1')
           #        RETURNING g_sub_success
           #   IF g_sub_success THEN 
           #      CALL s_transaction_end('Y','0')
           #   ELSE
           #      CALL s_transaction_end('N','0')
           #   END IF
           #END IF
           ##141202-00061-15--(E)  
           #150210-00009#1--Mark
            LET g_apcb_d4.* = g_apcb_d.*      
            
   END INPUT
   
END DIALOG]]>
  </point>
  <point name="function.aapt300_08_clear_detail" order="2" ver="1" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
PUBLIC FUNCTION aapt300_08_clear_detail()
   CALL g_apcb_d.clear()
END FUNCTION]]>
  </point>
  <point name="dialog.aapt300_08_construct" order="3" ver="2" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 
# Usage..........: CALL aapt300_08_construct
# Date & Author..: 14/10/06 By Belle
# Modify.........:
################################################################################
DIALOG aapt300_08_construct()
DEFINE g_wc_t300_08  STRING

   CONSTRUCT g_wc_t300_08 ON apcb021,apcb029,apcb010,apcb011,
                             apcb024,apcb036,apcb012,apcb015,
                             apcb016,apcb034,apcb035
       
        FROM s_detail1_aapt300_08[1].l_apcb021_desc,s_detail1_aapt300_08[1].l_apcb029_desc,s_detail1_aapt300_08[1].l_apcb010_desc,s_detail1_aapt300_08[1].l_apcb011_desc,
             s_detail1_aapt300_08[1].l_apcb024_desc,s_detail1_aapt300_08[1].l_apcb036_desc,s_detail1_aapt300_08[1].l_apcb012_desc,s_detail1_aapt300_08[1].l_apcb015_desc,
             s_detail1_aapt300_08[1].l_apcb016_desc,s_detail1_aapt300_08[1].l_apcb034_desc,s_detail1_aapt300_08[1].l_apcb035_desc
             
      #費用會計科目     
      ON ACTION controlp INFIELD l_apcb021_desc
         INITIALIZE g_qryparam.* TO NULL
         LET g_qryparam.state = 'c'
         LET g_qryparam.reqry = FALSE
         LET g_qryparam.where = "glac003 <>'1' "  #glac003(科目類型)
         CALL aglt310_04()                               
         DISPLAY g_qryparam.return1 TO apcb021
         DISPLAY g_qryparam.return1 TO l_apcb021_desc
         NEXT FIELD l_apcb021_desc     
         
         #應付帳款科目               
         ON ACTION controlp INFIELD l_apcb029_desc
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.where = " glac003 <>'1' "  #glac001(會計科目參照表)/glac003(科目類型)
            CALL aglt310_04()                               
            DISPLAY g_qryparam.return1 TO apcb029
            DISPLAY g_qryparam.return1 TO l_apcb029_desc
            NEXT FIELD l_apcb029_desc     
         
         
        ##業務人員
        #ON ACTION controlp INFIELD l_apcb051_desc
        #   INITIALIZE g_qryparam.* TO NULL
        #   LET g_qryparam.state = 'c'
        #   LET g_qryparam.reqry = FALSE
        #   LET g_qryparam.default1 = g_apcb_d[l_ac].apcb051
        #   CALL q_ooag001_8()                               
        #   LET g_apcb_d[l_ac].apcb051 = g_qryparam.return1    
        #   LET g_apcb_d[l_ac].l_apcb051_desc= g_apcb_d[l_ac].apcb051
        #   DISPLAY BY NAME g_apcb_d[l_ac].apcb051,g_apcb_d[l_ac].l_apcb051_desc
        #   NEXT FIELD l_apcb051_desc   
            
         #業務部門
         ON ACTION controlp INFIELD l_apcb010_desc
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.arg1 = g_today
            CALL q_ooeg001_4()                             
            DISPLAY g_qryparam.return1 TO apcb010
            DISPLAY g_qryparam.return1 TO l_apcb010_desc
            NEXT FIELD l_apcb010_desc   
            
         #責任中心
         ON ACTION controlp INFIELD l_apcb011_desc
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.arg1 = g_today
            LET g_qryparam.where = " ooeg003 IN ('1','2','3')"
            CALL q_ooeg001_4()    
            DISPLAY g_qryparam.return1 TO apcb011
            DISPLAY g_qryparam.return1 TO l_apcb011_desc
            NEXT FIELD l_apcb011_desc
         
         #區域 
         ON ACTION controlp INFIELD l_apcb024_desc
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_oocq002_287()
            DISPLAY g_qryparam.return1 TO apcb024
            DISPLAY g_qryparam.return1 TO l_apcb024_desc
            NEXT FIELD l_apcb024_desc
            
         #產品類別 
         ON ACTION controlp INFIELD l_apcb012_desc
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_rtax001()                          
            DISPLAY g_qryparam.return1 TO apcb012
            DISPLAY g_qryparam.return1 TO l_apcb012_desc
            NEXT FIELD l_apcb012_desc   
      
      
         #WBS
         ON ACTION controlp INFIELD l_apcb016_desc
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.where = "pjbb012='1'"
            CALL q_pjbb002()
            DISPLAY g_qryparam.return1 TO apcb016
            DISPLAY g_qryparam.return1 TO l_apcb016_desc
            NEXT FIELD l_apcb016_desc
            
         #專案代號
         ON ACTION controlp INFIELD l_apcb015_desc
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_pjba001()
            DISPLAY g_qryparam.return1 TO apcb015
            DISPLAY g_qryparam.return1 TO l_apcb015_desc
            NEXT FIELD l_apcb015_desc
         
         #客群
         ON ACTION controlp INFIELD l_apcb036_desc
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_oocq002_281()
            DISPLAY g_qryparam.return1 TO apcb036
            DISPLAY g_qryparam.return1 TO l_apcb036_desc
            NEXT FIELD l_apcb036_desc
         
         #渠道
         ON ACTION controlp INFIELD l_apcb034_desc
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
            CALL q_oojd001_2()
            DISPLAY g_qryparam.return1 TO apcb034
            DISPLAY g_qryparam.return1 TO l_apcb034_desc
            NEXT FIELD l_apcb034_desc
            
         #品牌
         ON ACTION controlp INFIELD l_apcb035_desc
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_oocq002_2002()
            DISPLAY g_qryparam.return1 TO apcb035
            DISPLAY g_qryparam.return1 TO l_apcb035_desc
            NEXT FIELD l_apcb035_desc
            
   END CONSTRUCT

END DIALOG]]>
  </point>
  <point name="global.memo" order="" ver="3" cite_std="N" new="N" status="u" src="s" readonly="" mark_hard="N">
    <![CDATA[#141218-00011#6               By Belle    單身維護時：其他信息的核算，不必檢核是否有輸入及合理性。
#150106-00011#3               By Belle    修改部門/責任中心預設值
#150205-00012#1               BY Hans     進欄位之後只顯示編號不顯示中文名稱
#150206-00013#3               BY Hans     單身最後方,參考單號之後,增加【存貨科目】apcb021、科目說明、【摘要】apcb047 的顯示及維護。
#150210-00009#1   2015/02/12  By Belle    修改 詢問分錄底稿產生位置
#150310-00009#10  2015/06/30  By lixiang  應付帶入來源單據的專案編號、WBS編號、活動編號，不可修改]]>
  </point>
  <point name="global.variable" order="" ver="2" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[DEFINE g_rec_b04              LIKE type_t.num5
GLOBALS
   DEFINE g_apcb_d4              DYNAMIC ARRAY OF type_g_apcb_d
END GLOBALS]]>
  </point>
  <point name="input.a.page1.apcb010" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_apcb_d[l_ac].apcb010
            CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_apcb_d[l_ac].apcb010_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_apcb_d[l_ac].apcb010_desc

]]>
  </point>
  <point name="input.a.page1.apcb011" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_apcb_d[l_ac].apcb011
            CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? ","") RETURNING g_rtn_fields
            LET g_apcb_d[l_ac].apcb011_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_apcb_d[l_ac].apcb011_desc

]]>
  </point>
  <point name="input.a.page1.apcb012" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_apcb_d[l_ac].apcb012
            CALL ap_ref_array2(g_ref_fields,"SELECT rtaxl002 FROM rtaxl_t WHERE rtaxlent='"||g_enterprise||"' AND rtaxl001=? ","") RETURNING g_rtn_fields
            LET g_apcb_d[l_ac].apcb012_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_apcb_d[l_ac].apcb012_desc

]]>
  </point>
  <point name="input.a.page1.apcb021" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_apcb_d[l_ac].apcb021
            CALL ap_ref_array2(g_ref_fields,"SELECT glacl003 FROM glacl_t WHERE glaclent='"||g_enterprise||"' AND ',glacl002=? ","") RETURNING g_rtn_fields
            LET g_apcb_d[l_ac].apcb021_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_apcb_d[l_ac].apcb021_desc

]]>
  </point>
  <point name="input.a.page1.apcbdocno" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            #確認資料無重複
            IF  g_apcb_d[g_detail_idx].apcbld IS NOT NULL AND g_apcb_d[g_detail_idx].apcbdocno IS NOT NULL AND g_apcb_d[g_detail_idx].apcbseq IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_apcb_d[g_detail_idx].apcbld != g_apcb_d_t.apcbld OR g_apcb_d[g_detail_idx].apcbdocno != g_apcb_d_t.apcbdocno OR g_apcb_d[g_detail_idx].apcbseq != g_apcb_d_t.apcbseq)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM apcb_t WHERE "||"apcbent = '" ||g_enterprise|| "' AND "||"apcbld = '"||g_apcb_d[g_detail_idx].apcbld ||"' AND "|| "apcbdocno = '"||g_apcb_d[g_detail_idx].apcbdocno ||"' AND "|| "apcbseq = '"||g_apcb_d[g_detail_idx].apcbseq ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page1.apcbld" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            #確認資料無重複
            IF  g_apcb_d[g_detail_idx].apcbld IS NOT NULL AND g_apcb_d[g_detail_idx].apcbdocno IS NOT NULL AND g_apcb_d[g_detail_idx].apcbseq IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_apcb_d[g_detail_idx].apcbld != g_apcb_d_t.apcbld OR g_apcb_d[g_detail_idx].apcbdocno != g_apcb_d_t.apcbdocno OR g_apcb_d[g_detail_idx].apcbseq != g_apcb_d_t.apcbseq)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM apcb_t WHERE "||"apcbent = '" ||g_enterprise|| "' AND "||"apcbld = '"||g_apcb_d[g_detail_idx].apcbld ||"' AND "|| "apcbdocno = '"||g_apcb_d[g_detail_idx].apcbdocno ||"' AND "|| "apcbseq = '"||g_apcb_d[g_detail_idx].apcbseq ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page1.apcbseq" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            #確認資料無重複
            IF  g_apcb_d[g_detail_idx].apcbld IS NOT NULL AND g_apcb_d[g_detail_idx].apcbdocno IS NOT NULL AND g_apcb_d[g_detail_idx].apcbseq IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_apcb_d[g_detail_idx].apcbld != g_apcb_d_t.apcbld OR g_apcb_d[g_detail_idx].apcbdocno != g_apcb_d_t.apcbdocno OR g_apcb_d[g_detail_idx].apcbseq != g_apcb_d_t.apcbseq)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM apcb_t WHERE "||"apcbent = '" ||g_enterprise|| "' AND "||"apcbld = '"||g_apcb_d[g_detail_idx].apcbld ||"' AND "|| "apcbdocno = '"||g_apcb_d[g_detail_idx].apcbdocno ||"' AND "|| "apcbseq = '"||g_apcb_d[g_detail_idx].apcbseq ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF


            IF NOT cl_null(g_apcb_d[l_ac].apcbseq) THEN 
            END IF 

]]>
  </point>
  <point name="input.a.page1_aapt300_08.apcb010" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="input.a.page1_aapt300_08.apcb011" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="input.a.page1_aapt300_08.apcb015" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="input.a.page1_aapt300_08.apcb016" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="input.a.page1_aapt300_08.apcb021" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="input.a.page1_aapt300_08.apcb024" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="input.a.page1_aapt300_08.apcb029" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="input.a.page1_aapt300_08.apcbdocno" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="input.a.page1_aapt300_08.apcbld" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="input.a.page1_aapt300_08.apcbseq" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="input.c.page1.apcb010" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_apcb_d[l_ac].apcb010             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "" #

            
            CALL q_ooeg001_4()                                #呼叫開窗

            LET g_apcb_d[l_ac].apcb010 = g_qryparam.return1              

            DISPLAY g_apcb_d[l_ac].apcb010 TO apcb010              #

            NEXT FIELD apcb010                          #返回原欄位

]]>
  </point>
  <point name="input.c.page1.apcb011" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_apcb_d[l_ac].apcb011             #給予default值
            LET g_qryparam.default2 = "" #g_apcb_d[l_ac].ooefl003 #說明(簡稱)
            #給予arg
            LET g_qryparam.arg1 = "" #

            
            CALL q_ooef001()                                #呼叫開窗

            LET g_apcb_d[l_ac].apcb011 = g_qryparam.return1              
            #LET g_apcb_d[l_ac].ooefl003 = g_qryparam.return2 
            DISPLAY g_apcb_d[l_ac].apcb011 TO apcb011              #
            #DISPLAY g_apcb_d[l_ac].ooefl003 TO ooefl003 #說明(簡稱)
            NEXT FIELD apcb011                          #返回原欄位

]]>
  </point>
  <point name="input.c.page1.apcb012" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_apcb_d[l_ac].apcb012             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "" #

            
            CALL q_rtax001()                                #呼叫開窗

            LET g_apcb_d[l_ac].apcb012 = g_qryparam.return1              

            DISPLAY g_apcb_d[l_ac].apcb012 TO apcb012              #

            NEXT FIELD apcb012                          #返回原欄位

]]>
  </point>
  <point name="input.c.page1.apcb021" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_apcb_d[l_ac].apcb021             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "" #

            
            CALL aglt310_04()                                #呼叫開窗

            LET g_apcb_d[l_ac].apcb021 = g_qryparam.return1              

            DISPLAY g_apcb_d[l_ac].apcb021 TO apcb021              #

            NEXT FIELD apcb021                          #返回原欄位

]]>
  </point>
  <point name="input.c.page1.apcb024" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_apcb_d[l_ac].apcb024             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "" #

            
            CALL q_isam010()                                #呼叫開窗

            LET g_apcb_d[l_ac].apcb024 = g_qryparam.return1              

            DISPLAY g_apcb_d[l_ac].apcb024 TO apcb024              #

            NEXT FIELD apcb024                          #返回原欄位

]]>
  </point>
  <point name="input.c.page1.apcbdocno" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_apcb_d[l_ac].apcbdocno             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "" #

            
            CALL q_apcadocno()                                #呼叫開窗

            LET g_apcb_d[l_ac].apcbdocno = g_qryparam.return1              

            DISPLAY g_apcb_d[l_ac].apcbdocno TO apcbdocno              #

            NEXT FIELD apcbdocno                          #返回原欄位

]]>
  </point>
  <point name="input.c.page1_aapt300_08.apcb010" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="input.c.page1_aapt300_08.apcb011" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="input.c.page1_aapt300_08.apcb012" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="input.c.page1_aapt300_08.apcb021" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="input.c.page1_aapt300_08.apcb024" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="input.c.page1_aapt300_08.apcb035" order="" ver="2" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="input.c.page1_aapt300_08.apcbdocno" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="input.c.page1_aapt300_08.l_apcb034_desc" order="" ver="2" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="input.c.page1_aapt300_08.l_apcb035_desc" order="" ver="2" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="input.pre_input" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   CALL cl_set_combo_scc('apcb033','6310')]]>
  </point>
  <section id="aapt300_08.description" ver="1" status="" src="s" readonly="">
    <![CDATA[#應用 a00 樣板自動產生(Version:1)
#+ Version..: T100-ERP-1.00.00(SD版次:3,PR版次:3) Build-000075
#+ 
#+ Filename...: aapt300_08
#+ Description: 其他訊息
#+ Creator....: 02097(2014-09-25 17:19:08)
#+ Modifier...: 02294(2015-06-30 10:50:52) -SD/PR-
]]>
  </section>
  <section id="aapt300_08.global" ver="27" status="" src="s" readonly="">
    <![CDATA[#應用 c02b 樣板自動產生(Version:5)
{<point name="global.memo" />}
 
IMPORT os
IMPORT FGL lib_cl_dlg
#add-point:增加匯入項目
{<point name="global.import" />}
#end add-point
 
SCHEMA ds
 
GLOBALS "../../cfg/top_global.inc"
 
#add-point:增加匯入變數檔
{<point name="global.inc" />}
#end add-point
 
#單身 type 宣告
PRIVATE TYPE type_g_apcb_d        RECORD
       apcbdocno LIKE apcb_t.apcbdocno, 
   apcbld LIKE apcb_t.apcbld, 
   apcbseq LIKE apcb_t.apcbseq, 
   apcb047 LIKE apcb_t.apcb047, 
   apcb021 LIKE apcb_t.apcb021, 
   l_apcb021_desc LIKE type_t.chr500, 
   apcb029 LIKE apcb_t.apcb029, 
   l_apcb029_desc LIKE type_t.chr500, 
   apcb051 LIKE apcb_t.apcb051, 
   l_apcb051_desc LIKE type_t.chr500, 
   apcb010 LIKE apcb_t.apcb010, 
   l_apcb010_desc LIKE type_t.chr500, 
   apcb011 LIKE apcb_t.apcb011, 
   l_apcb011_desc LIKE type_t.chr500, 
   apcb024 LIKE apcb_t.apcb024, 
   l_apcb024_desc LIKE type_t.chr500, 
   apcb012 LIKE apcb_t.apcb012, 
   l_apcb012_desc LIKE type_t.chr500, 
   apcb015 LIKE apcb_t.apcb015, 
   l_apcb015_desc LIKE type_t.chr500, 
   apcb016 LIKE apcb_t.apcb016, 
   l_apcb016_desc LIKE type_t.chr500, 
   apcb033 LIKE apcb_t.apcb033, 
   apcb034 LIKE apcb_t.apcb034, 
   l_apcb034_desc LIKE type_t.chr500, 
   apcb035 LIKE apcb_t.apcb035, 
   l_apcb035_desc LIKE type_t.chr500, 
   apcb036 LIKE apcb_t.apcb036, 
   l_apcb036_desc LIKE type_t.chr500, 
   apcb037 LIKE apcb_t.apcb037, 
   l_apcb037_desc LIKE type_t.chr500, 
   apcb038 LIKE apcb_t.apcb038, 
   l_apcb038_desc LIKE type_t.chr500, 
   apcb039 LIKE apcb_t.apcb039, 
   l_apcb039_desc LIKE type_t.chr500, 
   apcb040 LIKE apcb_t.apcb040, 
   l_apcb040_desc LIKE type_t.chr500, 
   apcb041 LIKE apcb_t.apcb041, 
   l_apcb041_desc LIKE type_t.chr500, 
   apcb042 LIKE apcb_t.apcb042, 
   l_apcb042_desc LIKE type_t.chr500, 
   apcb043 LIKE apcb_t.apcb043, 
   l_apcb043_desc LIKE type_t.chr500, 
   apcb044 LIKE apcb_t.apcb044, 
   l_apcb044_desc LIKE type_t.chr500, 
   apcb045 LIKE apcb_t.apcb045, 
   l_apcb045_desc LIKE type_t.chr500, 
   apcb046 LIKE apcb_t.apcb046, 
   l_apcb046_desc LIKE type_t.chr500, 
   img1 LIKE type_t.chr500
       END RECORD
 
 
DEFINE g_apcb_d          DYNAMIC ARRAY OF type_g_apcb_d
DEFINE g_apcb_d_t        type_g_apcb_d
 
 
DEFINE g_apcbld_t   LIKE apcb_t.apcbld    #Key值備份
DEFINE g_apcbdocno_t      LIKE apcb_t.apcbdocno    #Key值備份
DEFINE g_apcbseq_t      LIKE apcb_t.apcbseq    #Key值備份
 
 
DEFINE l_ac                  LIKE type_t.num10
DEFINE g_ref_fields          DYNAMIC ARRAY OF VARCHAR(500) #ap_ref用陣列
DEFINE g_rtn_fields          DYNAMIC ARRAY OF VARCHAR(500) #ap_ref用陣列
DEFINE g_ref_vars            DYNAMIC ARRAY OF VARCHAR(500) #ap_ref用陣列
DEFINE g_rec_b               LIKE type_t.num10 
DEFINE g_detail_idx          LIKE type_t.num10
 
 
#add-point:自定義模組變數(Module Variable)
{<point name="global.variable" edit="s"/>}
#end add-point
    
#add-point:自定義客戶專用模組變數(Module Variable)
{<point name="global.variable_customerization" edit="c"/>}
#end add-point
    
#add-point:傳入參數說明(global.argv)
{<point name="global.argv"/>}
#end add-point    
]]>
  </section>
  <section id="aapt300_08.input" ver="29" status="" src="s" readonly="">
    <![CDATA[#+ 資料輸入
PUBLIC FUNCTION aapt300_08(--)
   #add-point:input段變數傳入
   {<point name="input.get_var"/>}
   #end add-point
   )
   DEFINE l_ac_t          LIKE type_t.num10       #未取消的ARRAY CNT 
   DEFINE l_allow_insert  LIKE type_t.num5        #可新增否 
   DEFINE l_allow_delete  LIKE type_t.num5        #可刪除否  
   DEFINE l_count         LIKE type_t.num10
   DEFINE l_insert        LIKE type_t.num5
   DEFINE l_cmd           LIKE type_t.chr5
   #add-point:input段define
   {<point name="input.define" edit="s"/>}
   #end add-point
   #add-point:input段define
   {<point name="input.define_customerization" edit="c"/>}
   #end add-point
 
   #畫面開啟 (identifier)
   OPEN WINDOW w_aapt300_08 WITH FORM cl_ap_formpath("aap","aapt300_08")
 
   #瀏覽頁簽資料初始化
   CALL cl_ui_init()
   
   LET g_qryparam.state = "i"
   
   LET l_allow_insert = cl_auth_detail_input("insert")
   LET l_allow_delete = cl_auth_detail_input("delete")
   
   #輸入前處理
   #add-point:單身前置處理
   {<point name="input.pre_input"/>}
   #end add-point
  
   DIALOG ATTRIBUTES(UNBUFFERED,FIELD ORDER FORM)
   
      #輸入開始
      INPUT ARRAY g_apcb_d FROM s_detail1_aapt300_08.*
          ATTRIBUTE(COUNT = g_rec_b,MAXCOUNT = g_max_rec,WITHOUT DEFAULTS, 
                  INSERT ROW = FALSE,
                  DELETE ROW = FALSE,
                  APPEND ROW = FALSE)
         
         #自訂ACTION
         #add-point:單身前置處理
         {<point name="input.action"/>}
         #end add-point
         
         #自訂ACTION(detail_input)
         
         
         BEFORE INPUT
            #add-point:單身輸入前處理
            {<point name="input.before_input"/>}
            #end add-point
          
                  #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD apcbdocno
            #add-point:BEFORE FIELD apcbdocno
            {<point name="input.b.page1_aapt300_08.apcbdocno" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD apcbdocno
            
            #add-point:AFTER FIELD apcbdocno
            {<point name="input.a.page1_aapt300_08.apcbdocno" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE apcbdocno
            #add-point:ON CHANGE apcbdocno
            {<point name="input.g.page1_aapt300_08.apcbdocno" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD apcbld
            #add-point:BEFORE FIELD apcbld
            {<point name="input.b.page1_aapt300_08.apcbld" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD apcbld
            
            #add-point:AFTER FIELD apcbld
            {<point name="input.a.page1_aapt300_08.apcbld" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE apcbld
            #add-point:ON CHANGE apcbld
            {<point name="input.g.page1_aapt300_08.apcbld" />}
            #END add-point 
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD apcbseq
            #應用 a15 樣板自動產生(Version:2)
            #確認欄位值在特定區間內
            IF NOT cl_ap_chk_range(g_apcb_d[l_ac].apcbseq,"1.000","1","","","azz-00079",1) THEN
               NEXT FIELD apcbseq
            END IF 
 
 
            #add-point:AFTER FIELD apcbseq
            {<point name="input.a.page1_aapt300_08.apcbseq" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD apcbseq
            #add-point:BEFORE FIELD apcbseq
            {<point name="input.b.page1_aapt300_08.apcbseq" />}
            #END add-point
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE apcbseq
            #add-point:ON CHANGE apcbseq
            {<point name="input.g.page1_aapt300_08.apcbseq" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD apcb047
            #add-point:BEFORE FIELD apcb047
            {<point name="input.b.page1_aapt300_08.apcb047" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD apcb047
            
            #add-point:AFTER FIELD apcb047
            {<point name="input.a.page1_aapt300_08.apcb047" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE apcb047
            #add-point:ON CHANGE apcb047
            {<point name="input.g.page1_aapt300_08.apcb047" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD apcb021
            #add-point:BEFORE FIELD apcb021
            {<point name="input.b.page1_aapt300_08.apcb021" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD apcb021
            
            #add-point:AFTER FIELD apcb021
            {<point name="input.a.page1_aapt300_08.apcb021" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE apcb021
            #add-point:ON CHANGE apcb021
            {<point name="input.g.page1_aapt300_08.apcb021" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD apcb029
            #add-point:BEFORE FIELD apcb029
            {<point name="input.b.page1_aapt300_08.apcb029" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD apcb029
            
            #add-point:AFTER FIELD apcb029
            {<point name="input.a.page1_aapt300_08.apcb029" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE apcb029
            #add-point:ON CHANGE apcb029
            {<point name="input.g.page1_aapt300_08.apcb029" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD apcb051
            #add-point:BEFORE FIELD apcb051
            {<point name="input.b.page1_aapt300_08.apcb051" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD apcb051
            
            #add-point:AFTER FIELD apcb051
            {<point name="input.a.page1_aapt300_08.apcb051" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE apcb051
            #add-point:ON CHANGE apcb051
            {<point name="input.g.page1_aapt300_08.apcb051" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD l_apcb051_desc
            #add-point:BEFORE FIELD l_apcb051_desc
            {<point name="input.b.page1_aapt300_08.l_apcb051_desc" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD l_apcb051_desc
            
            #add-point:AFTER FIELD l_apcb051_desc
            {<point name="input.a.page1_aapt300_08.l_apcb051_desc" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE l_apcb051_desc
            #add-point:ON CHANGE l_apcb051_desc
            {<point name="input.g.page1_aapt300_08.l_apcb051_desc" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD apcb010
            #add-point:BEFORE FIELD apcb010
            {<point name="input.b.page1_aapt300_08.apcb010" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD apcb010
            
            #add-point:AFTER FIELD apcb010
            {<point name="input.a.page1_aapt300_08.apcb010" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE apcb010
            #add-point:ON CHANGE apcb010
            {<point name="input.g.page1_aapt300_08.apcb010" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD l_apcb010_desc
            #add-point:BEFORE FIELD l_apcb010_desc
            {<point name="input.b.page1_aapt300_08.l_apcb010_desc" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD l_apcb010_desc
            
            #add-point:AFTER FIELD l_apcb010_desc
            {<point name="input.a.page1_aapt300_08.l_apcb010_desc" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE l_apcb010_desc
            #add-point:ON CHANGE l_apcb010_desc
            {<point name="input.g.page1_aapt300_08.l_apcb010_desc" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD apcb011
            #add-point:BEFORE FIELD apcb011
            {<point name="input.b.page1_aapt300_08.apcb011" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD apcb011
            
            #add-point:AFTER FIELD apcb011
            {<point name="input.a.page1_aapt300_08.apcb011" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE apcb011
            #add-point:ON CHANGE apcb011
            {<point name="input.g.page1_aapt300_08.apcb011" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD l_apcb011_desc
            #add-point:BEFORE FIELD l_apcb011_desc
            {<point name="input.b.page1_aapt300_08.l_apcb011_desc" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD l_apcb011_desc
            
            #add-point:AFTER FIELD l_apcb011_desc
            {<point name="input.a.page1_aapt300_08.l_apcb011_desc" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE l_apcb011_desc
            #add-point:ON CHANGE l_apcb011_desc
            {<point name="input.g.page1_aapt300_08.l_apcb011_desc" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD apcb024
            #add-point:BEFORE FIELD apcb024
            {<point name="input.b.page1_aapt300_08.apcb024" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD apcb024
            
            #add-point:AFTER FIELD apcb024
            {<point name="input.a.page1_aapt300_08.apcb024" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE apcb024
            #add-point:ON CHANGE apcb024
            {<point name="input.g.page1_aapt300_08.apcb024" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD l_apcb024_desc
            #add-point:BEFORE FIELD l_apcb024_desc
            {<point name="input.b.page1_aapt300_08.l_apcb024_desc" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD l_apcb024_desc
            
            #add-point:AFTER FIELD l_apcb024_desc
            {<point name="input.a.page1_aapt300_08.l_apcb024_desc" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE l_apcb024_desc
            #add-point:ON CHANGE l_apcb024_desc
            {<point name="input.g.page1_aapt300_08.l_apcb024_desc" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD apcb012
            #add-point:BEFORE FIELD apcb012
            {<point name="input.b.page1_aapt300_08.apcb012" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD apcb012
            
            #add-point:AFTER FIELD apcb012
            {<point name="input.a.page1_aapt300_08.apcb012" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE apcb012
            #add-point:ON CHANGE apcb012
            {<point name="input.g.page1_aapt300_08.apcb012" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD l_apcb012_desc
            #add-point:BEFORE FIELD l_apcb012_desc
            {<point name="input.b.page1_aapt300_08.l_apcb012_desc" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD l_apcb012_desc
            
            #add-point:AFTER FIELD l_apcb012_desc
            {<point name="input.a.page1_aapt300_08.l_apcb012_desc" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE l_apcb012_desc
            #add-point:ON CHANGE l_apcb012_desc
            {<point name="input.g.page1_aapt300_08.l_apcb012_desc" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD apcb015
            #add-point:BEFORE FIELD apcb015
            {<point name="input.b.page1_aapt300_08.apcb015" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD apcb015
            
            #add-point:AFTER FIELD apcb015
            {<point name="input.a.page1_aapt300_08.apcb015" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE apcb015
            #add-point:ON CHANGE apcb015
            {<point name="input.g.page1_aapt300_08.apcb015" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD l_apcb015_desc
            #add-point:BEFORE FIELD l_apcb015_desc
            {<point name="input.b.page1_aapt300_08.l_apcb015_desc" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD l_apcb015_desc
            
            #add-point:AFTER FIELD l_apcb015_desc
            {<point name="input.a.page1_aapt300_08.l_apcb015_desc" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE l_apcb015_desc
            #add-point:ON CHANGE l_apcb015_desc
            {<point name="input.g.page1_aapt300_08.l_apcb015_desc" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD apcb016
            #add-point:BEFORE FIELD apcb016
            {<point name="input.b.page1_aapt300_08.apcb016" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD apcb016
            
            #add-point:AFTER FIELD apcb016
            {<point name="input.a.page1_aapt300_08.apcb016" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE apcb016
            #add-point:ON CHANGE apcb016
            {<point name="input.g.page1_aapt300_08.apcb016" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD l_apcb016_desc
            #add-point:BEFORE FIELD l_apcb016_desc
            {<point name="input.b.page1_aapt300_08.l_apcb016_desc" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD l_apcb016_desc
            
            #add-point:AFTER FIELD l_apcb016_desc
            {<point name="input.a.page1_aapt300_08.l_apcb016_desc" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE l_apcb016_desc
            #add-point:ON CHANGE l_apcb016_desc
            {<point name="input.g.page1_aapt300_08.l_apcb016_desc" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD apcb033
            #add-point:BEFORE FIELD apcb033
            {<point name="input.b.page1_aapt300_08.apcb033" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD apcb033
            
            #add-point:AFTER FIELD apcb033
            {<point name="input.a.page1_aapt300_08.apcb033" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE apcb033
            #add-point:ON CHANGE apcb033
            {<point name="input.g.page1_aapt300_08.apcb033" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD apcb034
            #add-point:BEFORE FIELD apcb034
            {<point name="input.b.page1_aapt300_08.apcb034" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD apcb034
            
            #add-point:AFTER FIELD apcb034
            {<point name="input.a.page1_aapt300_08.apcb034" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE apcb034
            #add-point:ON CHANGE apcb034
            {<point name="input.g.page1_aapt300_08.apcb034" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD l_apcb034_desc
            #add-point:BEFORE FIELD l_apcb034_desc
            {<point name="input.b.page1_aapt300_08.l_apcb034_desc" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD l_apcb034_desc
            
            #add-point:AFTER FIELD l_apcb034_desc
            {<point name="input.a.page1_aapt300_08.l_apcb034_desc" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE l_apcb034_desc
            #add-point:ON CHANGE l_apcb034_desc
            {<point name="input.g.page1_aapt300_08.l_apcb034_desc" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD apcb035
            #add-point:BEFORE FIELD apcb035
            {<point name="input.b.page1_aapt300_08.apcb035" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD apcb035
            
            #add-point:AFTER FIELD apcb035
            {<point name="input.a.page1_aapt300_08.apcb035" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE apcb035
            #add-point:ON CHANGE apcb035
            {<point name="input.g.page1_aapt300_08.apcb035" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD l_apcb035_desc
            #add-point:BEFORE FIELD l_apcb035_desc
            {<point name="input.b.page1_aapt300_08.l_apcb035_desc" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD l_apcb035_desc
            
            #add-point:AFTER FIELD l_apcb035_desc
            {<point name="input.a.page1_aapt300_08.l_apcb035_desc" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE l_apcb035_desc
            #add-point:ON CHANGE l_apcb035_desc
            {<point name="input.g.page1_aapt300_08.l_apcb035_desc" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD apcb036
            #add-point:BEFORE FIELD apcb036
            {<point name="input.b.page1_aapt300_08.apcb036" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD apcb036
            
            #add-point:AFTER FIELD apcb036
            {<point name="input.a.page1_aapt300_08.apcb036" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE apcb036
            #add-point:ON CHANGE apcb036
            {<point name="input.g.page1_aapt300_08.apcb036" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD l_apcb036_desc
            #add-point:BEFORE FIELD l_apcb036_desc
            {<point name="input.b.page1_aapt300_08.l_apcb036_desc" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD l_apcb036_desc
            
            #add-point:AFTER FIELD l_apcb036_desc
            {<point name="input.a.page1_aapt300_08.l_apcb036_desc" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE l_apcb036_desc
            #add-point:ON CHANGE l_apcb036_desc
            {<point name="input.g.page1_aapt300_08.l_apcb036_desc" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD apcb037
            #add-point:BEFORE FIELD apcb037
            {<point name="input.b.page1_aapt300_08.apcb037" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD apcb037
            
            #add-point:AFTER FIELD apcb037
            {<point name="input.a.page1_aapt300_08.apcb037" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE apcb037
            #add-point:ON CHANGE apcb037
            {<point name="input.g.page1_aapt300_08.apcb037" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD l_apcb037_desc
            #add-point:BEFORE FIELD l_apcb037_desc
            {<point name="input.b.page1_aapt300_08.l_apcb037_desc" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD l_apcb037_desc
            
            #add-point:AFTER FIELD l_apcb037_desc
            {<point name="input.a.page1_aapt300_08.l_apcb037_desc" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE l_apcb037_desc
            #add-point:ON CHANGE l_apcb037_desc
            {<point name="input.g.page1_aapt300_08.l_apcb037_desc" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD apcb038
            #add-point:BEFORE FIELD apcb038
            {<point name="input.b.page1_aapt300_08.apcb038" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD apcb038
            
            #add-point:AFTER FIELD apcb038
            {<point name="input.a.page1_aapt300_08.apcb038" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE apcb038
            #add-point:ON CHANGE apcb038
            {<point name="input.g.page1_aapt300_08.apcb038" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD l_apcb038_desc
            #add-point:BEFORE FIELD l_apcb038_desc
            {<point name="input.b.page1_aapt300_08.l_apcb038_desc" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD l_apcb038_desc
            
            #add-point:AFTER FIELD l_apcb038_desc
            {<point name="input.a.page1_aapt300_08.l_apcb038_desc" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE l_apcb038_desc
            #add-point:ON CHANGE l_apcb038_desc
            {<point name="input.g.page1_aapt300_08.l_apcb038_desc" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD apcb039
            #add-point:BEFORE FIELD apcb039
            {<point name="input.b.page1_aapt300_08.apcb039" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD apcb039
            
            #add-point:AFTER FIELD apcb039
            {<point name="input.a.page1_aapt300_08.apcb039" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE apcb039
            #add-point:ON CHANGE apcb039
            {<point name="input.g.page1_aapt300_08.apcb039" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD l_apcb039_desc
            #add-point:BEFORE FIELD l_apcb039_desc
            {<point name="input.b.page1_aapt300_08.l_apcb039_desc" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD l_apcb039_desc
            
            #add-point:AFTER FIELD l_apcb039_desc
            {<point name="input.a.page1_aapt300_08.l_apcb039_desc" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE l_apcb039_desc
            #add-point:ON CHANGE l_apcb039_desc
            {<point name="input.g.page1_aapt300_08.l_apcb039_desc" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD apcb040
            #add-point:BEFORE FIELD apcb040
            {<point name="input.b.page1_aapt300_08.apcb040" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD apcb040
            
            #add-point:AFTER FIELD apcb040
            {<point name="input.a.page1_aapt300_08.apcb040" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE apcb040
            #add-point:ON CHANGE apcb040
            {<point name="input.g.page1_aapt300_08.apcb040" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD l_apcb040_desc
            #add-point:BEFORE FIELD l_apcb040_desc
            {<point name="input.b.page1_aapt300_08.l_apcb040_desc" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD l_apcb040_desc
            
            #add-point:AFTER FIELD l_apcb040_desc
            {<point name="input.a.page1_aapt300_08.l_apcb040_desc" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE l_apcb040_desc
            #add-point:ON CHANGE l_apcb040_desc
            {<point name="input.g.page1_aapt300_08.l_apcb040_desc" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD apcb041
            #add-point:BEFORE FIELD apcb041
            {<point name="input.b.page1_aapt300_08.apcb041" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD apcb041
            
            #add-point:AFTER FIELD apcb041
            {<point name="input.a.page1_aapt300_08.apcb041" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE apcb041
            #add-point:ON CHANGE apcb041
            {<point name="input.g.page1_aapt300_08.apcb041" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD l_apcb041_desc
            #add-point:BEFORE FIELD l_apcb041_desc
            {<point name="input.b.page1_aapt300_08.l_apcb041_desc" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD l_apcb041_desc
            
            #add-point:AFTER FIELD l_apcb041_desc
            {<point name="input.a.page1_aapt300_08.l_apcb041_desc" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE l_apcb041_desc
            #add-point:ON CHANGE l_apcb041_desc
            {<point name="input.g.page1_aapt300_08.l_apcb041_desc" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD apcb042
            #add-point:BEFORE FIELD apcb042
            {<point name="input.b.page1_aapt300_08.apcb042" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD apcb042
            
            #add-point:AFTER FIELD apcb042
            {<point name="input.a.page1_aapt300_08.apcb042" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE apcb042
            #add-point:ON CHANGE apcb042
            {<point name="input.g.page1_aapt300_08.apcb042" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD l_apcb042_desc
            #add-point:BEFORE FIELD l_apcb042_desc
            {<point name="input.b.page1_aapt300_08.l_apcb042_desc" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD l_apcb042_desc
            
            #add-point:AFTER FIELD l_apcb042_desc
            {<point name="input.a.page1_aapt300_08.l_apcb042_desc" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE l_apcb042_desc
            #add-point:ON CHANGE l_apcb042_desc
            {<point name="input.g.page1_aapt300_08.l_apcb042_desc" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD apcb043
            #add-point:BEFORE FIELD apcb043
            {<point name="input.b.page1_aapt300_08.apcb043" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD apcb043
            
            #add-point:AFTER FIELD apcb043
            {<point name="input.a.page1_aapt300_08.apcb043" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE apcb043
            #add-point:ON CHANGE apcb043
            {<point name="input.g.page1_aapt300_08.apcb043" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD l_apcb043_desc
            #add-point:BEFORE FIELD l_apcb043_desc
            {<point name="input.b.page1_aapt300_08.l_apcb043_desc" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD l_apcb043_desc
            
            #add-point:AFTER FIELD l_apcb043_desc
            {<point name="input.a.page1_aapt300_08.l_apcb043_desc" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE l_apcb043_desc
            #add-point:ON CHANGE l_apcb043_desc
            {<point name="input.g.page1_aapt300_08.l_apcb043_desc" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD apcb044
            #add-point:BEFORE FIELD apcb044
            {<point name="input.b.page1_aapt300_08.apcb044" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD apcb044
            
            #add-point:AFTER FIELD apcb044
            {<point name="input.a.page1_aapt300_08.apcb044" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE apcb044
            #add-point:ON CHANGE apcb044
            {<point name="input.g.page1_aapt300_08.apcb044" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD l_apcb044_desc
            #add-point:BEFORE FIELD l_apcb044_desc
            {<point name="input.b.page1_aapt300_08.l_apcb044_desc" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD l_apcb044_desc
            
            #add-point:AFTER FIELD l_apcb044_desc
            {<point name="input.a.page1_aapt300_08.l_apcb044_desc" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE l_apcb044_desc
            #add-point:ON CHANGE l_apcb044_desc
            {<point name="input.g.page1_aapt300_08.l_apcb044_desc" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD apcb045
            #add-point:BEFORE FIELD apcb045
            {<point name="input.b.page1_aapt300_08.apcb045" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD apcb045
            
            #add-point:AFTER FIELD apcb045
            {<point name="input.a.page1_aapt300_08.apcb045" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE apcb045
            #add-point:ON CHANGE apcb045
            {<point name="input.g.page1_aapt300_08.apcb045" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD l_apcb045_desc
            #add-point:BEFORE FIELD l_apcb045_desc
            {<point name="input.b.page1_aapt300_08.l_apcb045_desc" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD l_apcb045_desc
            
            #add-point:AFTER FIELD l_apcb045_desc
            {<point name="input.a.page1_aapt300_08.l_apcb045_desc" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE l_apcb045_desc
            #add-point:ON CHANGE l_apcb045_desc
            {<point name="input.g.page1_aapt300_08.l_apcb045_desc" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD apcb046
            #add-point:BEFORE FIELD apcb046
            {<point name="input.b.page1_aapt300_08.apcb046" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD apcb046
            
            #add-point:AFTER FIELD apcb046
            {<point name="input.a.page1_aapt300_08.apcb046" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE apcb046
            #add-point:ON CHANGE apcb046
            {<point name="input.g.page1_aapt300_08.apcb046" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD l_apcb046_desc
            #add-point:BEFORE FIELD l_apcb046_desc
            {<point name="input.b.page1_aapt300_08.l_apcb046_desc" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD l_apcb046_desc
            
            #add-point:AFTER FIELD l_apcb046_desc
            {<point name="input.a.page1_aapt300_08.l_apcb046_desc" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE l_apcb046_desc
            #add-point:ON CHANGE l_apcb046_desc
            {<point name="input.g.page1_aapt300_08.l_apcb046_desc" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD img1
            #add-point:BEFORE FIELD img1
            {<point name="input.b.page1_aapt300_08.img1" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD img1
            
            #add-point:AFTER FIELD img1
            {<point name="input.a.page1_aapt300_08.img1" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE img1
            #add-point:ON CHANGE img1
            {<point name="input.g.page1_aapt300_08.img1" />}
            #END add-point 
 
 
                  #Ctrlp:input.c.page1_aapt300_08.apcbdocno
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD apcbdocno
            #add-point:ON ACTION controlp INFIELD apcbdocno
            {<point name="input.c.page1_aapt300_08.apcbdocno" />}
            #END add-point
 
         #Ctrlp:input.c.page1_aapt300_08.apcbld
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD apcbld
            #add-point:ON ACTION controlp INFIELD apcbld
            {<point name="input.c.page1_aapt300_08.apcbld" />}
            #END add-point
 
         #Ctrlp:input.c.page1_aapt300_08.apcbseq
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD apcbseq
            #add-point:ON ACTION controlp INFIELD apcbseq
            {<point name="input.c.page1_aapt300_08.apcbseq" />}
            #END add-point
 
         #Ctrlp:input.c.page1_aapt300_08.apcb047
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD apcb047
            #add-point:ON ACTION controlp INFIELD apcb047
            {<point name="input.c.page1_aapt300_08.apcb047" />}
            #END add-point
 
         #Ctrlp:input.c.page1_aapt300_08.apcb021
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD apcb021
            #add-point:ON ACTION controlp INFIELD apcb021
            {<point name="input.c.page1_aapt300_08.apcb021" />}
            #END add-point
 
         #Ctrlp:input.c.page1_aapt300_08.apcb029
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD apcb029
            #add-point:ON ACTION controlp INFIELD apcb029
            {<point name="input.c.page1_aapt300_08.apcb029" />}
            #END add-point
 
         #Ctrlp:input.c.page1_aapt300_08.apcb051
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD apcb051
            #add-point:ON ACTION controlp INFIELD apcb051
            {<point name="input.c.page1_aapt300_08.apcb051" />}
            #END add-point
 
         #Ctrlp:input.c.page1_aapt300_08.l_apcb051_desc
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD l_apcb051_desc
            #add-point:ON ACTION controlp INFIELD l_apcb051_desc
            {<point name="input.c.page1_aapt300_08.l_apcb051_desc" />}
            #END add-point
 
         #Ctrlp:input.c.page1_aapt300_08.apcb010
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD apcb010
            #add-point:ON ACTION controlp INFIELD apcb010
            {<point name="input.c.page1_aapt300_08.apcb010" />}
            #END add-point
 
         #Ctrlp:input.c.page1_aapt300_08.l_apcb010_desc
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD l_apcb010_desc
            #add-point:ON ACTION controlp INFIELD l_apcb010_desc
            {<point name="input.c.page1_aapt300_08.l_apcb010_desc" />}
            #END add-point
 
         #Ctrlp:input.c.page1_aapt300_08.apcb011
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD apcb011
            #add-point:ON ACTION controlp INFIELD apcb011
            {<point name="input.c.page1_aapt300_08.apcb011" />}
            #END add-point
 
         #Ctrlp:input.c.page1_aapt300_08.l_apcb011_desc
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD l_apcb011_desc
            #add-point:ON ACTION controlp INFIELD l_apcb011_desc
            {<point name="input.c.page1_aapt300_08.l_apcb011_desc" />}
            #END add-point
 
         #Ctrlp:input.c.page1_aapt300_08.apcb024
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD apcb024
            #add-point:ON ACTION controlp INFIELD apcb024
            {<point name="input.c.page1_aapt300_08.apcb024" />}
            #END add-point
 
         #Ctrlp:input.c.page1_aapt300_08.l_apcb024_desc
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD l_apcb024_desc
            #add-point:ON ACTION controlp INFIELD l_apcb024_desc
            {<point name="input.c.page1_aapt300_08.l_apcb024_desc" />}
            #END add-point
 
         #Ctrlp:input.c.page1_aapt300_08.apcb012
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD apcb012
            #add-point:ON ACTION controlp INFIELD apcb012
            {<point name="input.c.page1_aapt300_08.apcb012" />}
            #END add-point
 
         #Ctrlp:input.c.page1_aapt300_08.l_apcb012_desc
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD l_apcb012_desc
            #add-point:ON ACTION controlp INFIELD l_apcb012_desc
            {<point name="input.c.page1_aapt300_08.l_apcb012_desc" />}
            #END add-point
 
         #Ctrlp:input.c.page1_aapt300_08.apcb015
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD apcb015
            #add-point:ON ACTION controlp INFIELD apcb015
            {<point name="input.c.page1_aapt300_08.apcb015" />}
            #END add-point
 
         #Ctrlp:input.c.page1_aapt300_08.l_apcb015_desc
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD l_apcb015_desc
            #add-point:ON ACTION controlp INFIELD l_apcb015_desc
            {<point name="input.c.page1_aapt300_08.l_apcb015_desc" />}
            #END add-point
 
         #Ctrlp:input.c.page1_aapt300_08.apcb016
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD apcb016
            #add-point:ON ACTION controlp INFIELD apcb016
            {<point name="input.c.page1_aapt300_08.apcb016" />}
            #END add-point
 
         #Ctrlp:input.c.page1_aapt300_08.l_apcb016_desc
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD l_apcb016_desc
            #add-point:ON ACTION controlp INFIELD l_apcb016_desc
            {<point name="input.c.page1_aapt300_08.l_apcb016_desc" />}
            #END add-point
 
         #Ctrlp:input.c.page1_aapt300_08.apcb033
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD apcb033
            #add-point:ON ACTION controlp INFIELD apcb033
            {<point name="input.c.page1_aapt300_08.apcb033" />}
            #END add-point
 
         #Ctrlp:input.c.page1_aapt300_08.apcb034
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD apcb034
            #add-point:ON ACTION controlp INFIELD apcb034
            {<point name="input.c.page1_aapt300_08.apcb034" />}
            #END add-point
 
         #Ctrlp:input.c.page1_aapt300_08.l_apcb034_desc
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD l_apcb034_desc
            #add-point:ON ACTION controlp INFIELD l_apcb034_desc
            {<point name="input.c.page1_aapt300_08.l_apcb034_desc" />}
            #END add-point
 
         #Ctrlp:input.c.page1_aapt300_08.apcb035
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD apcb035
            #add-point:ON ACTION controlp INFIELD apcb035
            {<point name="input.c.page1_aapt300_08.apcb035" />}
            #END add-point
 
         #Ctrlp:input.c.page1_aapt300_08.l_apcb035_desc
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD l_apcb035_desc
            #add-point:ON ACTION controlp INFIELD l_apcb035_desc
            {<point name="input.c.page1_aapt300_08.l_apcb035_desc" />}
            #END add-point
 
         #Ctrlp:input.c.page1_aapt300_08.apcb036
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD apcb036
            #add-point:ON ACTION controlp INFIELD apcb036
            {<point name="input.c.page1_aapt300_08.apcb036" />}
            #END add-point
 
         #Ctrlp:input.c.page1_aapt300_08.l_apcb036_desc
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD l_apcb036_desc
            #add-point:ON ACTION controlp INFIELD l_apcb036_desc
            {<point name="input.c.page1_aapt300_08.l_apcb036_desc" />}
            #END add-point
 
         #Ctrlp:input.c.page1_aapt300_08.apcb037
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD apcb037
            #add-point:ON ACTION controlp INFIELD apcb037
            {<point name="input.c.page1_aapt300_08.apcb037" />}
            #END add-point
 
         #Ctrlp:input.c.page1_aapt300_08.l_apcb037_desc
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD l_apcb037_desc
            #add-point:ON ACTION controlp INFIELD l_apcb037_desc
            {<point name="input.c.page1_aapt300_08.l_apcb037_desc" />}
            #END add-point
 
         #Ctrlp:input.c.page1_aapt300_08.apcb038
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD apcb038
            #add-point:ON ACTION controlp INFIELD apcb038
            {<point name="input.c.page1_aapt300_08.apcb038" />}
            #END add-point
 
         #Ctrlp:input.c.page1_aapt300_08.l_apcb038_desc
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD l_apcb038_desc
            #add-point:ON ACTION controlp INFIELD l_apcb038_desc
            {<point name="input.c.page1_aapt300_08.l_apcb038_desc" />}
            #END add-point
 
         #Ctrlp:input.c.page1_aapt300_08.apcb039
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD apcb039
            #add-point:ON ACTION controlp INFIELD apcb039
            {<point name="input.c.page1_aapt300_08.apcb039" />}
            #END add-point
 
         #Ctrlp:input.c.page1_aapt300_08.l_apcb039_desc
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD l_apcb039_desc
            #add-point:ON ACTION controlp INFIELD l_apcb039_desc
            {<point name="input.c.page1_aapt300_08.l_apcb039_desc" />}
            #END add-point
 
         #Ctrlp:input.c.page1_aapt300_08.apcb040
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD apcb040
            #add-point:ON ACTION controlp INFIELD apcb040
            {<point name="input.c.page1_aapt300_08.apcb040" />}
            #END add-point
 
         #Ctrlp:input.c.page1_aapt300_08.l_apcb040_desc
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD l_apcb040_desc
            #add-point:ON ACTION controlp INFIELD l_apcb040_desc
            {<point name="input.c.page1_aapt300_08.l_apcb040_desc" />}
            #END add-point
 
         #Ctrlp:input.c.page1_aapt300_08.apcb041
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD apcb041
            #add-point:ON ACTION controlp INFIELD apcb041
            {<point name="input.c.page1_aapt300_08.apcb041" />}
            #END add-point
 
         #Ctrlp:input.c.page1_aapt300_08.l_apcb041_desc
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD l_apcb041_desc
            #add-point:ON ACTION controlp INFIELD l_apcb041_desc
            {<point name="input.c.page1_aapt300_08.l_apcb041_desc" />}
            #END add-point
 
         #Ctrlp:input.c.page1_aapt300_08.apcb042
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD apcb042
            #add-point:ON ACTION controlp INFIELD apcb042
            {<point name="input.c.page1_aapt300_08.apcb042" />}
            #END add-point
 
         #Ctrlp:input.c.page1_aapt300_08.l_apcb042_desc
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD l_apcb042_desc
            #add-point:ON ACTION controlp INFIELD l_apcb042_desc
            {<point name="input.c.page1_aapt300_08.l_apcb042_desc" />}
            #END add-point
 
         #Ctrlp:input.c.page1_aapt300_08.apcb043
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD apcb043
            #add-point:ON ACTION controlp INFIELD apcb043
            {<point name="input.c.page1_aapt300_08.apcb043" />}
            #END add-point
 
         #Ctrlp:input.c.page1_aapt300_08.l_apcb043_desc
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD l_apcb043_desc
            #add-point:ON ACTION controlp INFIELD l_apcb043_desc
            {<point name="input.c.page1_aapt300_08.l_apcb043_desc" />}
            #END add-point
 
         #Ctrlp:input.c.page1_aapt300_08.apcb044
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD apcb044
            #add-point:ON ACTION controlp INFIELD apcb044
            {<point name="input.c.page1_aapt300_08.apcb044" />}
            #END add-point
 
         #Ctrlp:input.c.page1_aapt300_08.l_apcb044_desc
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD l_apcb044_desc
            #add-point:ON ACTION controlp INFIELD l_apcb044_desc
            {<point name="input.c.page1_aapt300_08.l_apcb044_desc" />}
            #END add-point
 
         #Ctrlp:input.c.page1_aapt300_08.apcb045
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD apcb045
            #add-point:ON ACTION controlp INFIELD apcb045
            {<point name="input.c.page1_aapt300_08.apcb045" />}
            #END add-point
 
         #Ctrlp:input.c.page1_aapt300_08.l_apcb045_desc
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD l_apcb045_desc
            #add-point:ON ACTION controlp INFIELD l_apcb045_desc
            {<point name="input.c.page1_aapt300_08.l_apcb045_desc" />}
            #END add-point
 
         #Ctrlp:input.c.page1_aapt300_08.apcb046
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD apcb046
            #add-point:ON ACTION controlp INFIELD apcb046
            {<point name="input.c.page1_aapt300_08.apcb046" />}
            #END add-point
 
         #Ctrlp:input.c.page1_aapt300_08.l_apcb046_desc
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD l_apcb046_desc
            #add-point:ON ACTION controlp INFIELD l_apcb046_desc
            {<point name="input.c.page1_aapt300_08.l_apcb046_desc" />}
            #END add-point
 
         #Ctrlp:input.c.page1_aapt300_08.img1
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD img1
            #add-point:ON ACTION controlp INFIELD img1
            {<point name="input.c.page1_aapt300_08.img1" />}
            #END add-point
 
 
 
         #自訂ACTION
         #add-point:單身其他段落處理(EX:on row change, etc...)
         {<point name="input.other"/>}
         #end add-point
 
         AFTER INPUT
            #add-point:單身輸入後處理
            {<point name="input.after_input"/>}
            #end add-point
            
      END INPUT
      
 
      
      #add-point:自定義input
      {<point name="input.more_input"/>}
      #end add-point
    
      #公用action
      ON ACTION accept
         ACCEPT DIALOG
        
      ON ACTION cancel
         #add-point:cancel
         {<point name="input.cancel"/>}
         #end add-point
         LET INT_FLAG = TRUE 
         EXIT DIALOG
 
      ON ACTION close
         LET INT_FLAG = TRUE 
         EXIT DIALOG
 
      ON ACTION exit
         LET INT_FLAG = TRUE 
         EXIT DIALOG
   
      #交談指令共用ACTION
      &include "common_action.4gl" 
         CONTINUE DIALOG 
   END DIALOG
 
   #add-point:畫面關閉前
   {<point name="input.before_close"/>}
   #end add-point
   
   #畫面關閉
   CLOSE WINDOW w_aapt300_08 
   
   #add-point:input段after input 
   {<point name="input.post_input"/>}
   #end add-point    
   
END FUNCTION
]]>
  </section>
  <section id="aapt300_08.other_dialog" ver="1" status="" src="s" readonly="">
    <![CDATA[{<point name="other.dialog"/>}
]]>
  </section>
  <section id="aapt300_08.other_function" ver="1" status="" src="s" readonly="">
    <![CDATA[{<point name="other.function"/>}
]]>
  </section>
</add_points>
