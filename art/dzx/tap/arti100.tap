<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<add_points prog="arti100" std_prog="arti100" erpver="1.0" module="ART" ver="7" env="s" zone="t10prd" booking="Y" type="M" identity="s" section_flag="N" designer_ver="1.0">
  <other>
    <code_template value="F" status="u"/>
    <free_style value="Y" status="u"/>
    <start_arg value="" status="u"/>
  </other>
  <point name="construct.c.ooef001" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooef001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO ooef001  #顯示到畫面上

            NEXT FIELD ooef001                     #返回原欄位

]]>
  </point>
  <point name="show.head.reference" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_ooef_m.ooef001
            CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_ooef_m.ooef001_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_ooef_m.ooef001_desc
            
            call arti100_ooef001_ref()
            call arti100_ooef018_ref()
            call arti100_ooefunit_ref()

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_ooef_m.ooef017
            CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_ooef_m.ooef017_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_ooef_m.ooef017_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_ooef_m.ooef104
            CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='2076' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_ooef_m.ooef104_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_ooef_m.ooef104_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_ooef_m.ooef105
            CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_ooef_m.ooef105_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_ooef_m.ooef105_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_ooef_m.ooef106
            CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_ooef_m.ooef106_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_ooef_m.ooef106_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_ooef_m.ooef108
            CALL ap_ref_array2(g_ref_fields,"SELECT pmaal003 FROM pmaal_t WHERE pmaalent='"||g_enterprise||"' AND pmaal001=? AND pmaal002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_ooef_m.ooef108_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_ooef_m.ooef108_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_ooef_m.ooef123
            CALL ap_ref_array2(g_ref_fields,"SELECT inaa002 FROM inaa_t WHERE inaaent='"||g_enterprise||"' AND inaa001=? ","") RETURNING g_rtn_fields
            LET g_ooef_m.ooef123_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_ooef_m.ooef123_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_ooef_m.ooef124
            CALL ap_ref_array2(g_ref_fields,"SELECT inaa002 FROM inaa_t WHERE inaaent='"||g_enterprise||"' AND inaa001=? ","") RETURNING g_rtn_fields
            LET g_ooef_m.ooef124_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_ooef_m.ooef124_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_ooef_m.ooef125
            CALL ap_ref_array2(g_ref_fields,"SELECT inaa002 FROM inaa_t WHERE inaaent='"||g_enterprise||"' AND inaa001=? ","") RETURNING g_rtn_fields
            LET g_ooef_m.ooef125_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_ooef_m.ooef125_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_ooef_m.ooefownid
            CALL ap_ref_array2(g_ref_fields,"SELECT ooag011 FROM ooag_t WHERE ooagent='"||g_enterprise||"' AND ooag001=? ","") RETURNING g_rtn_fields
            LET g_ooef_m.ooefownid_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_ooef_m.ooefownid_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_ooef_m.ooefowndp
            CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_ooef_m.ooefowndp_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_ooef_m.ooefowndp_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_ooef_m.ooefcrtid
            CALL ap_ref_array2(g_ref_fields,"SELECT ooag011 FROM ooag_t WHERE ooagent='"||g_enterprise||"' AND ooag001=? ","") RETURNING g_rtn_fields
            LET g_ooef_m.ooefcrtid_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_ooef_m.ooefcrtid_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_ooef_m.ooefcrtdp
            CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_ooef_m.ooefcrtdp_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_ooef_m.ooefcrtdp_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_ooef_m.ooefmodid
            CALL ap_ref_array2(g_ref_fields,"SELECT ooag011 FROM ooag_t WHERE ooagent='"||g_enterprise||"' AND ooag001=? ","") RETURNING g_rtn_fields
            LET g_ooef_m.ooefmodid_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_ooef_m.ooefmodid_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_ooef_m.ooef004
            CALL ap_ref_array2(g_ref_fields,"SELECT ooall004 FROM ooall_t WHERE ooallent='"||g_enterprise||"' AND ooall001='3' AND ooall002=? AND ooall003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_ooef_m.ooef004_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_ooef_m.ooef004_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_ooef_m.ooef014
            CALL ap_ref_array2(g_ref_fields,"SELECT ooall004 FROM ooall_t WHERE ooallent='"||g_enterprise||"' AND ooall001='10' AND ooall002=? AND ooall003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_ooef_m.ooef014_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_ooef_m.ooef014_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_ooef_m.ooef016
            CALL ap_ref_array2(g_ref_fields,"SELECT ooail003 FROM ooail_t WHERE ooailent='"||g_enterprise||"' AND ooail001=? AND ooail002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_ooef_m.ooef016_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_ooef_m.ooef016_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_ooef_m.ooef006
            CALL ap_ref_array2(g_ref_fields,"SELECT oocgl003 FROM oocgl_t WHERE oocglent='"||g_enterprise||"' AND oocgl001=? AND oocgl002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_ooef_m.ooef006_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_ooef_m.ooef006_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_ooef_m.ooef008
            CALL ap_ref_array2(g_ref_fields,"SELECT ooall004 FROM ooall_t WHERE ooallent='"||g_enterprise||"' AND ooall001='4' AND ooall002=? AND ooall003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_ooef_m.ooef008_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_ooef_m.ooef008_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_ooef_m.ooef010
            CALL ap_ref_array2(g_ref_fields,"SELECT gzcbl004 FROM gzcbl_t WHERE gzcbl001='25' AND gzcbl002=? AND gzcbl003='"||g_lang||"'","") RETURNING g_rtn_fields
            LET g_ooef_m.ooef010_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_ooef_m.ooef010_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_ooef_m.ooef015
            CALL ap_ref_array2(g_ref_fields,"SELECT ooall004 FROM ooall_t WHERE ooallent='"||g_enterprise||"' AND ooall001='1' AND ooall002=? AND ooall003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_ooef_m.ooef015_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_ooef_m.ooef015_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_ooef_m.ooef019
            CALL ap_ref_array2(g_ref_fields,"SELECT ooall004 FROM ooall_t WHERE ooallent='"||g_enterprise||"' AND ooall001='2' AND ooall002=? AND ooall003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_ooef_m.ooef019_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_ooef_m.ooef019_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_ooef_m.ooef024
            CALL ap_ref_array2(g_ref_fields,"SELECT pmaal003 FROM pmaal_t WHERE pmaalent='"||g_enterprise||"' AND pmaal001=? AND pmaal002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_ooef_m.ooef024_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_ooef_m.ooef024_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_ooef_m.ooef150
            CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='2077' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_ooef_m.ooef150_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_ooef_m.ooef150_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_ooef_m.ooef151
            CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='2078' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_ooef_m.ooef151_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_ooef_m.ooef151_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_ooef_m.ooef152
            CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='2079' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_ooef_m.ooef152_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_ooef_m.ooef152_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_ooef_m.ooef153
            CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='2080' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_ooef_m.ooef153_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_ooef_m.ooef153_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_ooef_m.ooef154
            CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='2081' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_ooef_m.ooef154_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_ooef_m.ooef154_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_ooef_m.ooef155
            CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='2082' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_ooef_m.ooef155_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_ooef_m.ooef155_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_ooef_m.ooef156
            CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='2083' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_ooef_m.ooef156_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_ooef_m.ooef156_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_ooef_m.ooef157
            CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='2084' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_ooef_m.ooef157_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_ooef_m.ooef157_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_ooef_m.ooef158
            CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='2085' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_ooef_m.ooef158_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_ooef_m.ooef158_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_ooef_m.ooef159
            CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='2086' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_ooef_m.ooef159_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_ooef_m.ooef159_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_ooef_m.ooef160
            CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='2087' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_ooef_m.ooef160_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_ooef_m.ooef160_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_ooef_m.ooef161
            CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='2088' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_ooef_m.ooef161_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_ooef_m.ooef161_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_ooef_m.ooef162
            CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='2089' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_ooef_m.ooef162_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_ooef_m.ooef162_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_ooef_m.ooef163
            CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='2090' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_ooef_m.ooef163_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_ooef_m.ooef163_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_ooef_m.ooef164
            CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='2091' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_ooef_m.ooef164_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_ooef_m.ooef164_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_ooef_m.ooef165
            CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='2092' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_ooef_m.ooef165_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_ooef_m.ooef165_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_ooef_m.ooef166
            CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='2093' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_ooef_m.ooef166_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_ooef_m.ooef166_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_ooef_m.ooef167
            CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='2094' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_ooef_m.ooef167_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_ooef_m.ooef167_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_ooef_m.ooef168
            CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='2095' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_ooef_m.ooef168_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_ooef_m.ooef168_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_ooef_m.ooef169
            CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='2096' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_ooef_m.ooef169_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_ooef_m.ooef169_desc
]]>
  </point>
  <point name="input.c.ooef169" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_ooef_m.ooef169             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "2096" #

            CALL q_oocq002_3()                                #呼叫開窗

            LET g_ooef_m.ooef169 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_ooef_m.ooef169 TO ooef169              #顯示到畫面上
            call arti100_ooef169_ref()
            NEXT FIELD ooef169                          #返回原欄位

]]>
  </point>
  <point name="input.c.ooef168" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_ooef_m.ooef168             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "2095" #

            CALL q_oocq002_3()                                #呼叫開窗

            LET g_ooef_m.ooef168 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_ooef_m.ooef168 TO ooef168              #顯示到畫面上
            call arti100_ooef168_ref()
            NEXT FIELD ooef168                          #返回原欄位

]]>
  </point>
  <point name="input.c.ooef167" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_ooef_m.ooef167             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "2094" #

            CALL q_oocq002_3()                                #呼叫開窗

            LET g_ooef_m.ooef167 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_ooef_m.ooef167 TO ooef167              #顯示到畫面上
            call arti100_ooef167_ref()
            NEXT FIELD ooef167                          #返回原欄位

]]>
  </point>
  <point name="input.c.ooef166" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_ooef_m.ooef166             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "2093" #

            CALL q_oocq002_3()                                #呼叫開窗

            LET g_ooef_m.ooef166 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_ooef_m.ooef166 TO ooef166              #顯示到畫面上
            call arti100_ooef166_ref() 
            NEXT FIELD ooef166                          #返回原欄位

]]>
  </point>
  <point name="input.c.ooef165" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_ooef_m.ooef165             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "2092" #

            CALL q_oocq002_3()                                #呼叫開窗

            LET g_ooef_m.ooef165 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_ooef_m.ooef165 TO ooef165              #顯示到畫面上
            call arti100_ooef165_ref()
            NEXT FIELD ooef165                          #返回原欄位

]]>
  </point>
  <point name="input.c.ooef164" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_ooef_m.ooef164             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "2091" #

            CALL q_oocq002_3()                                #呼叫開窗

            LET g_ooef_m.ooef164 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_ooef_m.ooef164 TO ooef164              #顯示到畫面上
            call arti100_ooef164_ref()
            NEXT FIELD ooef164                          #返回原欄位

]]>
  </point>
  <point name="input.c.ooef163" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_ooef_m.ooef163             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "2090" #

            CALL q_oocq002_3()                                #呼叫開窗

            LET g_ooef_m.ooef163 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_ooef_m.ooef163 TO ooef163              #顯示到畫面上
            call arti100_ooef163_ref()
            NEXT FIELD ooef163                          #返回原欄位

]]>
  </point>
  <point name="input.c.ooef162" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_ooef_m.ooef162             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "2089" #

            CALL q_oocq002_3()                                #呼叫開窗

            LET g_ooef_m.ooef162 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_ooef_m.ooef162 TO ooef162              #顯示到畫面上
            call arti100_ooef162_ref()
            NEXT FIELD ooef162                          #返回原欄位

]]>
  </point>
  <point name="input.c.ooef161" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_ooef_m.ooef161             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "2088" #

            CALL q_oocq002_3()                                #呼叫開窗

            LET g_ooef_m.ooef161 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_ooef_m.ooef161 TO ooef161              #顯示到畫面上
            call arti100_ooef161_ref()
            NEXT FIELD ooef161                          #返回原欄位

]]>
  </point>
  <point name="input.c.ooef160" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_ooef_m.ooef160             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "2087" #

            CALL q_oocq002_3()                                #呼叫開窗

            LET g_ooef_m.ooef160 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_ooef_m.ooef160 TO ooef160              #顯示到畫面上
            call arti100_ooef160_ref()
            NEXT FIELD ooef160                          #返回原欄位

]]>
  </point>
  <point name="input.c.ooef159" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_ooef_m.ooef159             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "2086" #

            CALL q_oocq002_3()                                #呼叫開窗

            LET g_ooef_m.ooef159 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_ooef_m.ooef159 TO ooef159              #顯示到畫面上
            call arti100_ooef159_ref()
            NEXT FIELD ooef159                          #返回原欄位

]]>
  </point>
  <point name="input.c.ooef158" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_ooef_m.ooef158             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "2085" #

            CALL q_oocq002_3()                                #呼叫開窗

            LET g_ooef_m.ooef158 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_ooef_m.ooef158 TO ooef158              #顯示到畫面上
            call arti100_ooef158_ref()
            NEXT FIELD ooef158                          #返回原欄位

]]>
  </point>
  <point name="input.c.ooef157" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_ooef_m.ooef157             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "2084" #

            CALL q_oocq002_3()                                #呼叫開窗

            LET g_ooef_m.ooef157 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_ooef_m.ooef157 TO ooef157              #顯示到畫面上
            call arti100_ooef157_ref()
            NEXT FIELD ooef157                          #返回原欄位

]]>
  </point>
  <point name="input.c.ooef156" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_ooef_m.ooef156             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "2083" #

            CALL q_oocq002_3()                                #呼叫開窗

            LET g_ooef_m.ooef156 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_ooef_m.ooef156 TO ooef156              #顯示到畫面上
            call arti100_ooef156_ref()
            NEXT FIELD ooef156                          #返回原欄位

]]>
  </point>
  <point name="input.c.ooef155" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_ooef_m.ooef155             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "2082" #

            CALL q_oocq002_3()                                #呼叫開窗

            LET g_ooef_m.ooef155 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_ooef_m.ooef155 TO ooef155              #顯示到畫面上
            call arti100_ooef155_ref()
            NEXT FIELD ooef155                          #返回原欄位

]]>
  </point>
  <point name="input.c.ooef154" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_ooef_m.ooef154             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "2081" #

            CALL q_oocq002_3()                                #呼叫開窗

            LET g_ooef_m.ooef154 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_ooef_m.ooef154 TO ooef154              #顯示到畫面上
            call arti100_ooef154_ref()
            NEXT FIELD ooef154                          #返回原欄位

]]>
  </point>
  <point name="input.c.ooef153" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_ooef_m.ooef153             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "2080" #

            CALL q_oocq002_3()                                #呼叫開窗

            LET g_ooef_m.ooef153 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_ooef_m.ooef153 TO ooef153              #顯示到畫面上
            call arti100_ooef153_ref()
            NEXT FIELD ooef153                          #返回原欄位

]]>
  </point>
  <point name="input.c.ooef152" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_ooef_m.ooef152             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "2079" #

            CALL q_oocq002_3()                                #呼叫開窗

            LET g_ooef_m.ooef152 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_ooef_m.ooef152 TO ooef152              #顯示到畫面上
            call arti100_ooef152_ref()
            NEXT FIELD ooef152                          #返回原欄位

]]>
  </point>
  <point name="input.c.ooef151" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_ooef_m.ooef151             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "2078" #

            CALL q_oocq002_3()                                #呼叫開窗

            LET g_ooef_m.ooef151 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_ooef_m.ooef151 TO ooef151              #顯示到畫面上
            call arti100_ooef151_ref()
            NEXT FIELD ooef151                          #返回原欄位

]]>
  </point>
  <point name="input.c.ooef150" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_ooef_m.ooef150             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "2077" #

            CALL q_oocq002_3()                                #呼叫開窗

            LET g_ooef_m.ooef150 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_ooef_m.ooef150 TO ooef150              #顯示到畫面上
            call arti100_ooef150_ref()
            NEXT FIELD ooef150                          #返回原欄位

]]>
  </point>
  <point name="input.c.ooef125" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_ooef_m.ooef125             #給予default值

            #給予arg
            LET g_qryparam.arg1 = g_ooef_m.ooefunit #

            CALL q_inaa001_6()                                #呼叫開窗

            LET g_ooef_m.ooef125 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_ooef_m.ooef125 TO ooef125              #顯示到畫面上
            call arti100_ooef125_ref()
            NEXT FIELD ooef125                          #返回原欄位

]]>
  </point>
  <point name="input.c.ooef124" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_ooef_m.ooef124             #給予default值

            #給予arg
            LET g_qryparam.arg1 = g_ooef_m.ooefunit #

            CALL q_inaa001_6()                                #呼叫開窗

            LET g_ooef_m.ooef124 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_ooef_m.ooef124 TO ooef124              #顯示到畫面上
            call arti100_ooef123_ref()
            NEXT FIELD ooef124                          #返回原欄位

]]>
  </point>
  <point name="input.c.ooef123" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_ooef_m.ooef123             #給予default值

            #給予arg
            LET g_qryparam.arg1 = g_ooef_m.ooefunit #

            CALL q_inaa001_6()                                #呼叫開窗

            LET g_ooef_m.ooef123 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_ooef_m.ooef123 TO ooef123              #顯示到畫面上
            call arti100_ooef123_ref()
            NEXT FIELD ooef123                          #返回原欄位

]]>
  </point>
  <point name="input.c.ooef108" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_ooef_m.ooef108             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "('2')" #

            CALL q_pmaa001_1()                                #呼叫開窗

            LET g_ooef_m.ooef108 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_ooef_m.ooef108 TO ooef108              #顯示到畫面上
            call arti100_ooef108_ref()
            NEXT FIELD ooef108                          #返回原欄位

]]>
  </point>
  <point name="input.c.ooef106" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_ooef_m.ooef106             #給予default值

            #給予arg

            CALL q_ooea001_8()                                #呼叫開窗

            LET g_ooef_m.ooef106 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_ooef_m.ooef106 TO ooef106              #顯示到畫面上
            call arti100_ooef106_ref()
            NEXT FIELD ooef106                          #返回原欄位

]]>
  </point>
  <point name="input.c.ooef105" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_ooef_m.ooef105             #給予default值

            #給予arg

            CALL q_ooea001_8()                                #呼叫開窗

            LET g_ooef_m.ooef105 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_ooef_m.ooef105 TO ooef105              #顯示到畫面上
            call arti100_ooef105_ref()
            NEXT FIELD ooef105                          #返回原欄位

]]>
  </point>
  <point name="input.c.ooef104" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_ooef_m.ooef104             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "2076" #

            CALL q_oocq002_3()                                #呼叫開窗

            LET g_ooef_m.ooef104 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_ooef_m.ooef104 TO ooef104              #顯示到畫面上
            call arti100_ooef104_ref()
            NEXT FIELD ooef104                          #返回原欄位

]]>
  </point>
  <point name="input.c.ooef024" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_ooef_m.ooef024             #給予default值

            #給予arg

            CALL q_pmaa001()                                #呼叫開窗

            LET g_ooef_m.ooef024 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_ooef_m.ooef024 TO ooef024              #顯示到畫面上
            call arti100_ooef024_ref()
            NEXT FIELD ooef024                          #返回原欄位

]]>
  </point>
  <point name="input.c.ooef019" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_ooef_m.ooef019             #給予default值

            #給予arg

            CALL q_ooal002_11()                                #呼叫開窗

            LET g_ooef_m.ooef019 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_ooef_m.ooef019 TO ooef019              #顯示到畫面上
            call arti100_ooef019_ref()
            NEXT FIELD ooef019                          #返回原欄位

]]>
  </point>
  <point name="input.c.ooef018" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_ooef_m.ooef018             #給予default值

            #給予arg

            CALL q_gzot001_1()                                #呼叫開窗

            LET g_ooef_m.ooef018 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_ooef_m.ooef018 TO ooef018              #顯示到畫面上
            call arti100_ooef018_ref()
            NEXT FIELD ooef018                          #返回原欄位

]]>
  </point>
  <point name="input.c.ooef017" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_ooef_m.ooef017             #給予default值

            #給予arg

            CALL q_ooea001_2()                                #呼叫開窗

            LET g_ooef_m.ooef017 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_ooef_m.ooef017 TO ooef017              #顯示到畫面上
            call arti100_ooef017_ref()
            NEXT FIELD ooef017                          #返回原欄位

]]>
  </point>
  <point name="input.c.ooef016" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_ooef_m.ooef016             #給予default值

            #給予arg
            LET g_qryparam.arg1 = g_ooef_m.ooefunit #

            CALL q_ooaj002_1()                                #呼叫開窗

            LET g_ooef_m.ooef016 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_ooef_m.ooef016 TO ooef016              #顯示到畫面上
            call arti100_ooef016_ref()
            NEXT FIELD ooef016                          #返回原欄位

]]>
  </point>
  <point name="input.c.ooef015" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_ooef_m.ooef015             #給予default值

            #給予arg

            CALL q_ooal002_3()                                #呼叫開窗

            LET g_ooef_m.ooef015 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_ooef_m.ooef015 TO ooef015              #顯示到畫面上
            call arti100_ooef015_ref()
            NEXT FIELD ooef015                          #返回原欄位

]]>
  </point>
  <point name="input.c.ooef014" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_ooef_m.ooef014             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "10" #

            CALL q_ooal002_0()                                #呼叫開窗

            LET g_ooef_m.ooef014 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_ooef_m.ooef014 TO ooef014              #顯示到畫面上
            call arti100_ooef014_ref()
            NEXT FIELD ooef014                          #返回原欄位

]]>
  </point>
  <point name="input.c.ooef008" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_ooef_m.ooef008             #給予default值

            #給予arg

            CALL q_ooal002_5()                                #呼叫開窗

            LET g_ooef_m.ooef008 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_ooef_m.ooef008 TO ooef008              #顯示到畫面上
            call arti100_ooef008_ref()
            NEXT FIELD ooef008                          #返回原欄位

]]>
  </point>
  <point name="input.c.ooef006" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_ooef_m.ooef006             #給予default值

            #給予arg

            CALL q_oocg001()                                #呼叫開窗

            LET g_ooef_m.ooef006 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_ooef_m.ooef006 TO ooef006              #顯示到畫面上
            call arti100_ooef006_ref()
            NEXT FIELD ooef006                          #返回原欄位

]]>
  </point>
  <point name="input.c.ooef004" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_ooef_m.ooef004             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "3" #

            CALL q_ooal002_0()                                #呼叫開窗

            LET g_ooef_m.ooef004 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_ooef_m.ooef004 TO ooef004              #顯示到畫面上
            call arti100_ooef004_ref()
            NEXT FIELD ooef004                          #返回原欄位

]]>
  </point>
  <point name="input.c.ooef001" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_ooef_m.ooef001             #給予default值

            #給予arg

            CALL q_ooea001_8()                                #呼叫開窗

            LET g_ooef_m.ooef001 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_ooef_m.ooef001 TO ooef001              #顯示到畫面上
            call arti100_ooef001_ref()
            NEXT FIELD ooef001                          #返回原欄位

]]>
  </point>
  <point name="input.a.ooefunit" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="input.a.ooef169" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_ooef_m.ooef169_desc = null
            DISPLAY BY NAME g_ooef_m.ooef169_desc
            IF NOT cl_null(g_ooef_m.ooef169) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_ooef_m.ooef169

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_oocq002_2096") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 

               ELSE
                  #檢查失敗時後續處理
                  LET g_ooef_m.ooef169 = g_ooef_m_t.ooef169
                  CALL arti100_ooef169_ref()
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
            CALL arti100_ooef169_ref()
]]>
  </point>
  <point name="input.a.ooef168" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_ooef_m.ooef168_desc = null
            DISPLAY BY NAME g_ooef_m.ooef168_desc
            IF NOT cl_null(g_ooef_m.ooef168) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_ooef_m.ooef168

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_oocq002_2095") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 

               ELSE
                  #檢查失敗時後續處理
                  LET g_ooef_m.ooef168 = g_ooef_m_t.ooef168
                  CALL arti100_ooef168_ref()
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
            CALL arti100_ooef168_ref()
]]>
  </point>
  <point name="input.a.ooef167" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_ooef_m.ooef167_desc = null
            DISPLAY BY NAME g_ooef_m.ooef167_desc
            IF NOT cl_null(g_ooef_m.ooef167) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_ooef_m.ooef167

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_oocq002_2094") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 

               ELSE
                  #檢查失敗時後續處理
                  LET g_ooef_m.ooef167 = g_ooef_m_t.ooef167
                  CALL arti100_ooef167_ref()
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
            CALL arti100_ooef167_ref()
]]>
  </point>
  <point name="input.a.ooef166" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_ooef_m.ooef166_desc = null
            DISPLAY BY NAME g_ooef_m.ooef166_desc
            IF NOT cl_null(g_ooef_m.ooef166) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_ooef_m.ooef166

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_oocq002_2093") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 

               ELSE
                  #檢查失敗時後續處理
                  LET g_ooef_m.ooef166 = g_ooef_m_t.ooef166
                  CALL arti100_ooef166_ref()
                  NEXT FIELD CURRENT
               END IF
            

            END IF
            CALL arti100_ooef166_ref()           
]]>
  </point>
  <point name="input.a.ooef165" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_ooef_m.ooef165_desc = null
            DISPLAY BY NAME g_ooef_m.ooef165_desc
            IF NOT cl_null(g_ooef_m.ooef165) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_ooef_m.ooef165

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_oocq002_2092") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 

               ELSE
                  #檢查失敗時後續處理
                  LET g_ooef_m.ooef165 = g_ooef_m_t.ooef165
                  CALL arti100_ooef165_ref()
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
            CALL arti100_ooef165_ref()
]]>
  </point>
  <point name="input.a.ooef164" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_ooef_m.ooef164_desc = null
            DISPLAY BY NAME g_ooef_m.ooef164_desc
            IF NOT cl_null(g_ooef_m.ooef164) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_ooef_m.ooef164

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_oocq002_2091") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 

               ELSE
                  #檢查失敗時後續處理
                  LET g_ooef_m.ooef164 = g_ooef_m_t.ooef164
                  CALL arti100_ooef164_ref()
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
            CALL arti100_ooef164_ref()
]]>
  </point>
  <point name="input.a.ooef163" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_ooef_m.ooef163_desc = null
            DISPLAY BY NAME g_ooef_m.ooef163_desc
            IF NOT cl_null(g_ooef_m.ooef163) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_ooef_m.ooef163

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_oocq002_2090") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 

               ELSE
                  #檢查失敗時後續處理
                  LET g_ooef_m.ooef163 = g_ooef_m_t.ooef163
                  CALL arti100_ooef163_ref()
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
            CALL arti100_ooef163_ref()
]]>
  </point>
  <point name="input.a.ooef162" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_ooef_m.ooef162_desc = null
            DISPLAY BY NAME g_ooef_m.ooef162_desc
            IF NOT cl_null(g_ooef_m.ooef162) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_ooef_m.ooef162

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_oocq002_2089") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 

               ELSE
                  #檢查失敗時後續處理
                  LET g_ooef_m.ooef161 = g_ooef_m_t.ooef161
                  CALL arti100_ooef161_ref()
                  NEXT FIELD CURRENT
               END IF
            

            END IF
            CALL arti100_ooef161_ref()             
]]>
  </point>
  <point name="input.a.ooef161" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_ooef_m.ooef161_desc = null
            DISPLAY BY NAME g_ooef_m.ooef161_desc
            IF NOT cl_null(g_ooef_m.ooef161) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_ooef_m.ooef161

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_oocq002_2088") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 

               ELSE
                  #檢查失敗時後續處理
                  LET g_ooef_m.ooef161 = g_ooef_m_t.ooef161
                  CALL arti100_ooef161_ref()
                  NEXT FIELD CURRENT
               END IF
            

            END IF
            CALL arti100_ooef161_ref()            
]]>
  </point>
  <point name="input.a.ooef160" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_ooef_m.ooef160_desc = null
            DISPLAY BY NAME g_ooef_m.ooef160_desc
            IF NOT cl_null(g_ooef_m.ooef160) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_ooef_m.ooef160

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_oocq002_2087") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 

               ELSE
                  #檢查失敗時後續處理
                  LET g_ooef_m.ooef160 = g_ooef_m_t.ooef160
                  CALL arti100_ooef160_ref()
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
            CALL arti100_ooef160_ref()
]]>
  </point>
  <point name="input.a.ooef159" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_ooef_m.ooef159_desc = null
            DISPLAY BY NAME g_ooef_m.ooef159_desc
            IF NOT cl_null(g_ooef_m.ooef159) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_ooef_m.ooef159

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_oocq002_2086") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 

               ELSE
                  #檢查失敗時後續處理
                  LET g_ooef_m.ooef159 = g_ooef_m_t.ooef159
                  CALL arti100_ooef159_ref()
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
            CALL arti100_ooef159_ref()
]]>
  </point>
  <point name="input.a.ooef158" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_ooef_m.ooef158_desc = null
            DISPLAY BY NAME g_ooef_m.ooef158_desc
            IF NOT cl_null(g_ooef_m.ooef158) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_ooef_m.ooef158

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_oocq002_2085") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 

               ELSE
                  #檢查失敗時後續處理
                  LET g_ooef_m.ooef158 = g_ooef_m_t.ooef158
                  CALL arti100_ooef158_ref()
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
            CALL arti100_ooef158_ref()
]]>
  </point>
  <point name="input.a.ooef157" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_ooef_m.ooef157_desc = null
            DISPLAY BY NAME g_ooef_m.ooef157_desc
            IF NOT cl_null(g_ooef_m.ooef157) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_ooef_m.ooef157

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_oocq002_2084") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 

               ELSE
                  #檢查失敗時後續處理
                  LET g_ooef_m.ooef157 = g_ooef_m_t.ooef157
                  CALL arti100_ooef157_ref()
                  NEXT FIELD CURRENT
               END IF
            

            END IF
            CALL arti100_ooef157_ref()              
]]>
  </point>
  <point name="input.a.ooef156" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            let g_ooef_m.ooef156_desc = null
            display by name g_ooef_m.ooef156_desc
            IF NOT cl_null(g_ooef_m.ooef156) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_ooef_m.ooef156

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_oocq002_2083") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 

               ELSE
                  #檢查失敗時後續處理
                  LET g_ooef_m.ooef156 = g_ooef_m_t.ooef156
                  CALL arti100_ooef156_ref()
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
            CALL arti100_ooef156_ref()
]]>
  </point>
  <point name="input.a.ooef155" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_ooef_m.ooef155_desc = null
            DISPLAY BY NAME g_ooef_m.ooef155_desc
            IF NOT cl_null(g_ooef_m.ooef155) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_ooef_m.ooef155

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_oocq002_2082") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 

               ELSE
                  #檢查失敗時後續處理
                  LET g_ooef_m.ooef155 = g_ooef_m_t.ooef155
                  CALL arti100_ooef155_ref()
                  NEXT FIELD CURRENT
               END IF
            

            END IF
            CALL arti100_ooef155_ref()            
]]>
  </point>
  <point name="input.a.ooef154" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_ooef_m.ooef154_desc = null
            DISPLAY BY NAME g_ooef_m.ooef154_desc
            IF NOT cl_null(g_ooef_m.ooef154) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_ooef_m.ooef154

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_oocq002_2081") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 

               ELSE
                  #檢查失敗時後續處理
                  LET g_ooef_m.ooef154 = g_ooef_m_t.ooef154
                  CALL arti100_ooef154_ref()
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
            CALL arti100_ooef154_ref()
]]>
  </point>
  <point name="input.a.ooef153" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_ooef_m.ooef153_desc = null
            DISPLAY BY NAME g_ooef_m.ooef153_desc
            IF NOT cl_null(g_ooef_m.ooef153) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_ooef_m.ooef153

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_oocq002_2080") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 

               ELSE
                  #檢查失敗時後續處理
                  LET g_ooef_m.ooef153 = g_ooef_m_t.ooef153
                  CALL arti100_ooef153_ref()
                  NEXT FIELD CURRENT
               END IF
            

            END IF
            CALL arti100_ooef153_ref()            
]]>
  </point>
  <point name="input.a.ooef152" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_ooef_m.ooef153_desc = null
            DISPLAY BY NAME g_ooef_m.ooef153_desc
            IF NOT cl_null(g_ooef_m.ooef152) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_ooef_m.ooef152

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_oocq002_2079") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 

               ELSE
                  #檢查失敗時後續處理
                  LET g_ooef_m.ooef152 = g_ooef_m_t.ooef152
                  CALL arti100_ooef152_ref()
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
            CALL arti100_ooef152_ref()
]]>
  </point>
  <point name="input.a.ooef151" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_ooef_m.ooef151_desc = null
            DISPLAY BY NAME g_ooef_m.ooef151_desc
            IF NOT cl_null(g_ooef_m.ooef151) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_ooef_m.ooef151

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_oocq002_2078") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 

               ELSE
                  #檢查失敗時後續處理
                  LET g_ooef_m.ooef151 = g_ooef_m_t.ooef151
                  CALL arti100_ooef151_ref()
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
            CALL arti100_ooef151_ref()
]]>
  </point>
  <point name="input.a.ooef150" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_ooef_m.ooef150_desc = null
            DISPLAY BY NAME g_ooef_m.ooef150_desc
            IF NOT cl_null(g_ooef_m.ooef150) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_ooef_m.ooef150

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_oocq002_2077") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 

               ELSE
                  #檢查失敗時後續處理
                  LET g_ooef_m.ooef150 = g_ooef_m_t.ooef150
                  CALL arti100_ooef150_ref()
                  NEXT FIELD CURRENT
               END IF
            

            END IF
            CALL arti100_ooef150_ref()            
]]>
  </point>
  <point name="input.a.ooef125" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_ooef_m.ooef125_desc = null
            DISPLAY BY NAME g_ooef_m.ooef125_desc
            IF NOT cl_null(g_ooef_m.ooef125) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_ooef_m.ooefunit
               LET g_chkparam.arg2 = g_ooef_m.ooef125

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_inaa001") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 

               ELSE
                  #檢查失敗時後續處理
                  let g_ooef_m.ooef125 = g_ooef_m_t.ooef125
                  call arti100_ooef125_ref()
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
            call arti100_ooef125_ref()
]]>
  </point>
  <point name="input.a.ooef124" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_ooef_m.ooef124_desc = null
            DISPLAY BY NAME g_ooef_m.ooef124_desc
            IF NOT cl_null(g_ooef_m.ooef124) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_ooef_m.ooefunit
               LET g_chkparam.arg2 = g_ooef_m.ooef124

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_inaa001") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 

               ELSE
                  #檢查失敗時後續處理
                  let g_ooef_m.ooef124 = g_ooef_m_t.ooef124
                  call arti100_ooef124_ref()
                  NEXT FIELD CURRENT
               END IF
            

            END IF
            call arti100_ooef124_ref()            
]]>
  </point>
  <point name="input.a.ooef123" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_ooef_m.ooef123_desc = null
            DISPLAY BY NAME g_ooef_m.ooef123_desc
            IF NOT cl_null(g_ooef_m.ooef123) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_ooef_m.ooefunit
               LET g_chkparam.arg2 = g_ooef_m.ooef123

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_inaa001") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 

               ELSE
                  #檢查失敗時後續處理
                  let g_ooef_m.ooef123 = g_ooef_m_t.ooef123
                  call arti100_ooef123_ref()
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
            call arti100_ooef123_ref()
]]>
  </point>
  <point name="input.a.ooef122" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_ooef_m.ooef122) THEN 
            END IF 
]]>
  </point>
  <point name="input.a.ooef121" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_ooef_m.ooef121) THEN 
            END IF 
]]>
  </point>
  <point name="input.a.ooef120" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_ooef_m.ooef120) THEN 
            END IF 
]]>
  </point>
  <point name="input.a.ooef113" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_ooef_m.ooef113) THEN 
            END IF 
]]>
  </point>
  <point name="input.a.ooef112" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_ooef_m.ooef112) THEN 
            END IF 
]]>
  </point>
  <point name="input.a.ooef111" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_ooef_m.ooef111) THEN 
            END IF 
]]>
  </point>
  <point name="input.a.ooef108" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_ooef_m.ooef108_desc = null
            DISPLAY BY NAME g_ooef_m.ooef108_desc
            IF NOT cl_null(g_ooef_m.ooef108) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_ooef_m.ooef108

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_pmaa001_8") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 

               ELSE
                  #檢查失敗時後續處理
                  let g_ooef_m.ooef108 = g_ooef_m_t.ooef108
                  call arti100_ooef108_ref()
                  NEXT FIELD CURRENT
               END IF
            

            END IF
            call arti100_ooef108_ref()            
]]>
  </point>
  <point name="input.a.ooef106" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_ooef_m.ooef106_desc = null
            DISPLAY BY NAME g_ooef_m.ooef106_desc
            IF NOT cl_null(g_ooef_m.ooef106) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_ooef_m.ooef106

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_ooea001_4") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 

               ELSE
                  #檢查失敗時後續處理
                  let g_ooef_m.ooef106 = g_ooef_m_t.ooef106
                  call arti100_ooef106_ref()
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
            call arti100_ooef106_ref()
]]>
  </point>
  <point name="input.a.ooef105" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_ooef_m.ooef105_desc =null
            DISPLAY BY NAME g_ooef_m.ooef105_desc
            IF NOT cl_null(g_ooef_m.ooef105) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_ooef_m.ooef105

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_ooea001_4") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 

               ELSE
                  #檢查失敗時後續處理
                  let g_ooef_m.ooef105 = g_ooef_m_t.ooef105
                  call arti100_ooef105_ref()
                  NEXT FIELD CURRENT
               END IF
            

            END IF
            call arti100_ooef105_ref()            
]]>
  </point>
  <point name="input.a.ooef104" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_ooef_m.ooef104_desc = null
            DISPLAY BY NAME g_ooef_m.ooef104_desc
            IF NOT cl_null(g_ooef_m.ooef104) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_ooef_m.ooef104

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_oocq002_2076") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 

               ELSE
                  #檢查失敗時後續處理
                  let g_ooef_m.ooef104 = g_ooef_m_t.ooef104
                  call arti100_ooef104_ref() 
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
            call arti100_ooef104_ref()
]]>
  </point>
  <point name="input.a.ooef024" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_ooef_m.ooef024_desc = null
            DISPLAY BY NAME g_ooef_m.ooef024_desc
            IF NOT cl_null(g_ooef_m.ooef024) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_ooef_m.ooef024

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_pmaa001_6") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 

               ELSE
                  #檢查失敗時後續處理
                  LET g_ooef_m.ooef024 = g_ooef_m_t.ooef024
                  CALL arti100_ooef024_ref()
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
            CALL arti100_ooef024_ref()
]]>
  </point>
  <point name="input.a.ooef019" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_ooef_m.ooef019_desc = null
            DISPLAY BY NAME g_ooef_m.ooef019_desc
            IF NOT cl_null(g_ooef_m.ooef019) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_ooef_m.ooef019

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_ooal002_2") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 

               ELSE
                  #檢查失敗時後續處理
                  LET g_ooef_m.ooef019 = g_ooef_m_t.ooef019
                  CALL arti100_ooef019_ref()
                  NEXT FIELD CURRENT
               END IF
            

            END IF
            CALL arti100_ooef019_ref()            
]]>
  </point>
  <point name="input.a.ooef018" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_ooef_m.ooef018_desc = null
            DISPLAY BY NAME g_ooef_m.ooef018_desc
            IF NOT cl_null(g_ooef_m.ooef018) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_ooef_m.ooef018

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_gzot001") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 

               ELSE
                  #檢查失敗時後續處理
                  let g_ooef_m.ooef018 = g_ooef_m_t.ooef018
                  call arti100_ooef018_ref()
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
            call arti100_ooef018_ref() ]]>
  </point>
  <point name="input.a.ooef017" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_ooef_m.ooef017_desc = null
            DISPLAY BY NAME g_ooef_m.ooef017_desc
            IF NOT cl_null(g_ooef_m.ooef017) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_ooef_m.ooef017

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_ooea001_2") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 

               ELSE
                  #檢查失敗時後續處理
                  let g_ooef_m.ooef017 = g_ooef_m_t.ooef017
                  call arti100_ooef017_ref()
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
            call arti100_ooef017_ref()
]]>
  </point>
  <point name="input.a.ooef016" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_ooef_m.ooef016_desc = null
            DISPLAY BY NAME g_ooef_m.ooef016_desc
            IF NOT cl_null(g_ooef_m.ooef016) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_ooef_m.ooefunit
               LET g_chkparam.arg2 = g_ooef_m.ooef016

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_ooaj002") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 

               ELSE
                  #檢查失敗時後續處理
                  let g_ooef_m.ooef016 = g_ooef_m_t.ooef016
                  call arti100_ooef016_ref()
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
            call arti100_ooef016_ref()
]]>
  </point>
  <point name="input.a.ooef015" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_ooef_m.ooef015_desc = null
            DISPLAY BY NAME g_ooef_m.ooef015_desc
            IF NOT cl_null(g_ooef_m.ooef015) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg2 = g_ooef_m.ooef015

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_ooal002_1") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 

               ELSE
                  #檢查失敗時後續處理
                  let g_ooef_m.ooef015 = g_ooef_m_t.ooef015
                  call arti100_ooef015_ref()
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
            call arti100_ooef015_ref()
]]>
  </point>
  <point name="input.a.ooef014" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_ooef_m.ooef014_desc = null
            DISPLAY BY NAME g_ooef_m.ooef014_desc
            IF NOT cl_null(g_ooef_m.ooef014) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = '10'
               LET g_chkparam.arg2 = g_ooef_m.ooef014

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_ooal002_3") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 

               ELSE
                  #檢查失敗時後續處理
                  let g_ooef_m.ooef014 = g_ooef_m_t.ooef014
                  call arti100_ooef014_ref()
                  NEXT FIELD CURRENT
               END IF
            

            END IF
            call arti100_ooef014_ref()             
]]>
  </point>
  <point name="input.a.ooef010" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_ooef_m.ooef010
            CALL ap_ref_array2(g_ref_fields,"SELECT gzcbl004 FROM gzcbl_t WHERE gzcbl001='25' AND gzcbl002=? AND gzcbl003='"||g_lang||"'","") RETURNING g_rtn_fields
            LET g_ooef_m.ooef010_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_ooef_m.ooef010_desc
]]>
  </point>
  <point name="input.a.ooef008" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_ooef_m.ooef008_desc = null
            DISPLAY BY NAME g_ooef_m.ooef008_desc
            IF NOT cl_null(g_ooef_m.ooef008) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg2 = g_ooef_m.ooef008

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_ooal002_41") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 

               ELSE
                  #檢查失敗時後續處理
                  LET g_ooef_m.ooef008 = g_ooef_m_t.ooef008
                  CALL arti100_ooef008_ref()
                  NEXT FIELD CURRENT
               END IF
            

            END IF
            CALL arti100_ooef008_ref()            
]]>
  </point>
  <point name="input.a.ooef006" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_ooef_m.ooef006_desc = null
            DISPLAY BY NAME g_ooef_m.ooef006_desc
            IF NOT cl_null(g_ooef_m.ooef006) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_ooef_m.ooef006

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_oocg001") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 

               ELSE
                  #檢查失敗時後續處理
                  let g_ooef_m.ooef006 = g_ooef_m_t.ooef006
                  call arti100_ooef006_ref()
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
            call arti100_ooef006_ref()
]]>
  </point>
  <point name="input.a.ooef004" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_ooef_m.ooef004_desc = null
            DISPLAY BY NAME g_ooef_m.ooef004_desc
            IF NOT cl_null(g_ooef_m.ooef004) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg2 = g_ooef_m.ooef004

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_ooal002_4") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 

               ELSE
                  #檢查失敗時後續處理
                  let g_ooef_m.ooef004 = g_ooef_m_t.ooef004
                  call arti100_ooef004_ref()
                  NEXT FIELD CURRENT
               END IF
            

            END IF
            call arti100_ooef004_ref()            
]]>
  </point>
  <point name="input.a.ooef001" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            LET g_ooef_m.ooef001_desc = null
            DISPLAY BY NAME g_ooef_m.ooef001_desc
            IF  NOT cl_null(g_ooef_m.ooef001) THEN 
               IF p_cmd = 'a' OR ( p_cmd = 'u' AND (g_ooef_m.ooef001 != g_ooef001_t )) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM ooef_t WHERE "||"ooefent = '" ||g_enterprise|| "' AND "||"ooef001 = '"||g_ooef_m.ooef001 ||"'",'std-00004',0) THEN 
                     let g_ooef_m.ooef001 = g_ooef_m_t.ooef001
                     call arti100_ooef001_ref()
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF


            IF NOT cl_null(g_ooef_m.ooef001) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_ooef_m.ooef001

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_ooea001_4") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 

               ELSE
                  #檢查失敗時後續處理
                  let g_ooef_m.ooef001 = g_ooef_m_t.ooef001
                  call arti100_ooef001_ref()
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
            call arti100_ooef001_ref()
]]>
  </point>
  <point name="input.a.ooed005" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="construct.c.ooef004" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooef004()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO ooef004  #顯示到畫面上

            NEXT FIELD ooef004                     #返回原欄位

]]>
  </point>
  <point name="construct.c.ooef006" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooef006()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO ooef006  #顯示到畫面上

            NEXT FIELD ooef006                     #返回原欄位

]]>
  </point>
  <point name="construct.c.ooef008" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooef008()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO ooef008  #顯示到畫面上

            NEXT FIELD ooef008                     #返回原欄位

]]>
  </point>
  <point name="construct.c.ooef014" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooal002_0()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO ooef014  #顯示到畫面上

            NEXT FIELD ooef014                     #返回原欄位

]]>
  </point>
  <point name="construct.c.ooef015" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooal002_3()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO ooef015  #顯示到畫面上

            NEXT FIELD ooef015                     #返回原欄位

]]>
  </point>
  <point name="construct.c.ooef016" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooaj002_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO ooef016  #顯示到畫面上

            NEXT FIELD ooef016                     #返回原欄位

]]>
  </point>
  <point name="construct.c.ooef017" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooea001_2()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO ooef017  #顯示到畫面上

            NEXT FIELD ooef017                     #返回原欄位

]]>
  </point>
  <point name="construct.c.ooef018" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_gzot001_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO ooef018  #顯示到畫面上

            NEXT FIELD ooef018                     #返回原欄位

]]>
  </point>
  <point name="construct.c.ooef019" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooal002_11()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO ooef019  #顯示到畫面上

            NEXT FIELD ooef019                     #返回原欄位

]]>
  </point>
  <point name="construct.c.ooef024" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_pmaa001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO ooef024  #顯示到畫面上

            NEXT FIELD ooef024                     #返回原欄位

]]>
  </point>
  <point name="construct.c.ooef104" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_oocq002_3()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO ooef104  #顯示到畫面上

            NEXT FIELD ooef104                     #返回原欄位

]]>
  </point>
  <point name="construct.c.ooef105" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooea001_8()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO ooef105  #顯示到畫面上

            NEXT FIELD ooef105                     #返回原欄位

]]>
  </point>
  <point name="construct.c.ooef106" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooea001_8()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO ooef106  #顯示到畫面上

            NEXT FIELD ooef106                     #返回原欄位

]]>
  </point>
  <point name="construct.c.ooef108" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_pmaa001_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO ooef108  #顯示到畫面上

            NEXT FIELD ooef108                     #返回原欄位

]]>
  </point>
  <point name="construct.c.ooef123" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_inaa001_6()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO ooef123  #顯示到畫面上

            NEXT FIELD ooef123                     #返回原欄位

]]>
  </point>
  <point name="construct.c.ooef124" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_inaa001_6()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO ooef124  #顯示到畫面上

            NEXT FIELD ooef124                     #返回原欄位

]]>
  </point>
  <point name="construct.c.ooef125" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_inaa001_6()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO ooef125  #顯示到畫面上

            NEXT FIELD ooef125                     #返回原欄位

]]>
  </point>
  <point name="construct.c.ooef150" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_oocq002_3()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO ooef150  #顯示到畫面上

            NEXT FIELD ooef150                     #返回原欄位

]]>
  </point>
  <point name="construct.c.ooef151" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_oocq002_3()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO ooef151  #顯示到畫面上

            NEXT FIELD ooef151                     #返回原欄位

]]>
  </point>
  <point name="construct.c.ooef152" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_oocq002_3()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO ooef152  #顯示到畫面上

            NEXT FIELD ooef152                     #返回原欄位

]]>
  </point>
  <point name="construct.c.ooef153" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_oocq002_3()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO ooef153  #顯示到畫面上

            NEXT FIELD ooef153                     #返回原欄位

]]>
  </point>
  <point name="construct.c.ooef154" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_oocq002_3()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO ooef154  #顯示到畫面上

            NEXT FIELD ooef154                     #返回原欄位

]]>
  </point>
  <point name="construct.c.ooef155" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_oocq002_3()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO ooef155  #顯示到畫面上

            NEXT FIELD ooef155                     #返回原欄位

]]>
  </point>
  <point name="construct.c.ooef156" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_oocq002_3()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO ooef156  #顯示到畫面上

            NEXT FIELD ooef156                     #返回原欄位

]]>
  </point>
  <point name="construct.c.ooef157" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_oocq002_3()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO ooef157  #顯示到畫面上

            NEXT FIELD ooef157                     #返回原欄位

]]>
  </point>
  <point name="construct.c.ooef158" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_oocq002_3()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO ooef158  #顯示到畫面上

            NEXT FIELD ooef158                     #返回原欄位

]]>
  </point>
  <point name="construct.c.ooef159" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_oocq002_3()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO ooef159  #顯示到畫面上

            NEXT FIELD ooef159                     #返回原欄位

]]>
  </point>
  <point name="construct.c.ooef160" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_oocq002_3()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO ooef160  #顯示到畫面上

            NEXT FIELD ooef160                     #返回原欄位

]]>
  </point>
  <point name="construct.c.ooef161" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_oocq002_3()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO ooef161  #顯示到畫面上

            NEXT FIELD ooef161                     #返回原欄位

]]>
  </point>
  <point name="construct.c.ooef162" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_oocq002_3()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO ooef162  #顯示到畫面上

            NEXT FIELD ooef162                     #返回原欄位

]]>
  </point>
  <point name="construct.c.ooef163" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_oocq002_3()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO ooef163  #顯示到畫面上

            NEXT FIELD ooef163                     #返回原欄位

]]>
  </point>
  <point name="construct.c.ooef164" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_oocq002_3()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO ooef164  #顯示到畫面上

            NEXT FIELD ooef164                     #返回原欄位

]]>
  </point>
  <point name="construct.c.ooef165" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_oocq002_3()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO ooef165  #顯示到畫面上

            NEXT FIELD ooef165                     #返回原欄位

]]>
  </point>
  <point name="construct.c.ooef166" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_oocq002_3()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO ooef166  #顯示到畫面上

            NEXT FIELD ooef166                     #返回原欄位

]]>
  </point>
  <point name="construct.c.ooef167" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_oocq002_3()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO ooef167  #顯示到畫面上

            NEXT FIELD ooef167                     #返回原欄位

]]>
  </point>
  <point name="construct.c.ooef168" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_oocq002_3()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO ooef168  #顯示到畫面上

            NEXT FIELD ooef168                     #返回原欄位

]]>
  </point>
  <point name="construct.c.ooef169" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_oocq002_3()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO ooef169  #顯示到畫面上

            NEXT FIELD ooef169                     #返回原欄位

]]>
  </point>
  <point name="construct.c.ooefcrtdp" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooeg001_9()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO ooefcrtdp  #顯示到畫面上

            NEXT FIELD ooefcrtdp                     #返回原欄位

]]>
  </point>
  <point name="construct.c.ooefcrtid" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooag001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO ooefcrtid  #顯示到畫面上

            NEXT FIELD ooefcrtid                     #返回原欄位

]]>
  </point>
  <point name="construct.c.ooefmodid" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooag001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO ooefmodid  #顯示到畫面上

            NEXT FIELD ooefmodid                     #返回原欄位

]]>
  </point>
  <point name="construct.c.ooefowndp" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooeg001_9()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO ooefowndp  #顯示到畫面上

            NEXT FIELD ooefowndp                     #返回原欄位

]]>
  </point>
  <point name="construct.c.ooefownid" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooag001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO ooefownid  #顯示到畫面上

            NEXT FIELD ooefownid                     #返回原欄位

]]>
  </point>
  <point name="function.arti100_chk_ooef108" order="1" ver="5" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
#chk ooef108
PRIVATE FUNCTION arti100_chk_ooef108()
   DEFINE l_stus      LIKE type_t.chr10
   DEFINE l_pmaa002   LIKE pmaa_t.pmaa002
   DEFINE l_pmab087   LIKE pmab_t.pmab087
   DEFINE l_ooib007   LIKE ooib_t.ooib007
   #150504-00023#1 Add-S By Ken 150506
   DEFINE l_pmaa230   LIKE pmaa_t.pmaa230
   DEFINE l_pmaa092   LIKE pmaa_t.pmaa092
   #150504-00023#1 Add-E By Ken 150506
   
   LET l_stus = ''
   LET g_errno = ''
   LET l_pmaa002 = ''
   #150504-00023#1 Modify-S By Ken 150506
   SELECT pmaastus,pmaa002,pmaa230,pmaa092 INTO l_stus,l_pmaa002,l_pmaa230,l_pmaa092 FROM pmaa_t
    WHERE pmaaent = g_enterprise
      AND pmaa001 = g_ooef_m.ooef108
   #SELECT pmaastus,pmaa002 INTO l_stus,l_pmaa002 FROM pmaa_t
   # WHERE pmaaent = g_enterprise
   #   AND pmaa001 = g_ooef_m.ooef108
   #150504-00023#1 Modify-E By Ken 150506
      
   CASE WHEN SQLCA.SQLCODE = 100   LET g_errno = 'sub-00416'
        WHEN l_stus='N'            LET g_errno = 'sub-00415'
        WHEN l_stus='X'            LET g_errno = 'sub-00414'
        WHEN l_pmaa002 != '2'      LET g_errno = 'adb-00019'
        #150504-00023#1 Add-S By Ken 150506
        WHEN l_pmaa230 != '1'      LET g_errno = 'adb-00422'
        WHEN l_pmaa092 != '1'      LET g_errno = 'adb-00423'
        #150504-00023#1 Add-E By Ken 150506
        OTHERWISE                  LET g_errno = SQLCA.SQLCODE USING '-------'
   END CASE
   
   IF NOT cl_null(g_errno) THEN
      RETURN
   END IF
   
   LET l_stus = ''
   LET l_pmab087 = ''
   SELECT pmabstus,pmab087 INTO l_stus,l_pmab087 FROM pmab_t
    WHERE pmabent = g_enterprise
      AND pmabsite = 'ALL'
      AND pmab001 = g_ooef_m.ooef108
   CASE WHEN SQLCA.SQLCODE = 100   LET g_errno = 'ais-00055'
        WHEN (l_stus !='Y' or l_stus is null)          LET g_errno = 'art-00350'
        WHEN cl_null(l_pmab087)    LET g_errno = 'art-00346'
        OTHERWISE                  LET g_errno = SQLCA.SQLCODE USING '-------'
   END CASE
   
   IF NOT cl_null(g_errno) THEN
      RETURN
   END IF
   
   LET l_stus = ''
   LET l_ooib007 = ''
   SELECT ooibstus,ooib007 INTO l_stus,l_ooib007 FROM ooib_t
    WHERE ooibent = g_enterprise
      AND ooib001 = '2'
      AND ooib002 = l_pmab087
      
   CASE WHEN SQLCA.SQLCODE = 100   LET g_errno = 'art-00347'
        WHEN (l_stus !='Y' or l_stus is null)          LET g_errno = 'art-00348'
        WHEN l_ooib007 != 'Y'      LET g_errno = 'art-00349'
        OTHERWISE                  LET g_errno = SQLCA.SQLCODE USING '-------'
   END CASE
END FUNCTION]]>
  </point>
  <point name="function.arti100_ooefunit_ref" order="2" ver="3" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#display ooefunit
PRIVATE FUNCTION arti100_ooefunit_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_ooef_m.ooefunit
   CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_ooef_m.ooefunit_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_ooef_m.ooefunit_desc
END FUNCTION]]>
  </point>
  <point name="function.arti100_ooef001_ref" order="3" ver="3" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#display ooef001
PRIVATE FUNCTION arti100_ooef001_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_ooef_m.ooef001
   CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_ooef_m.ooef001_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_ooef_m.ooef001_desc
   
   select ooed005 into g_ooef_m.ooed005 from ooed_t
    where ooed004 = g_ooef_m.ooef001 and ooedent = g_enterprise
      and rownum=1
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_ooef_m.ooed005
   CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_ooef_m.ooed005_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_ooef_m.ooed005_desc   
END FUNCTION]]>
  </point>
  <point name="function.arti100_ooef017_ref" order="4" ver="3" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#display ooef017
PRIVATE FUNCTION arti100_ooef017_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_ooef_m.ooef017
   CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_ooef_m.ooef017_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_ooef_m.ooef017_desc
END FUNCTION]]>
  </point>
  <point name="function.arti100_ooef105_ref" order="5" ver="3" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#display ooef105
PRIVATE FUNCTION arti100_ooef105_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_ooef_m.ooef105
   CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_ooef_m.ooef105_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_ooef_m.ooef105_desc
END FUNCTION]]>
  </point>
  <point name="function.arti100_ooef104_ref" order="6" ver="3" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#display ooef104
PRIVATE FUNCTION arti100_ooef104_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_ooef_m.ooef104
   CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='2076' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_ooef_m.ooef104_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_ooef_m.ooef104_desc
END FUNCTION]]>
  </point>
  <point name="function.arti100_ooef106_ref" order="7" ver="3" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#display ooef106
PRIVATE FUNCTION arti100_ooef106_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_ooef_m.ooef106
   CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_ooef_m.ooef106_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_ooef_m.ooef106_desc
END FUNCTION]]>
  </point>
  <point name="function.arti100_ooef108_ref" order="8" ver="3" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#display ooef108
PRIVATE FUNCTION arti100_ooef108_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_ooef_m.ooef108
   CALL ap_ref_array2(g_ref_fields,"SELECT pmaal003 FROM pmaal_t WHERE pmaalent='"||g_enterprise||"' AND pmaal001=? AND pmaal002='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_ooef_m.ooef108_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_ooef_m.ooef108_desc
END FUNCTION]]>
  </point>
  <point name="function.arti100_ooef123_ref" order="9" ver="3" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#display ooef123
PRIVATE FUNCTION arti100_ooef123_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_ooef_m.ooef123
   CALL ap_ref_array2(g_ref_fields,"SELECT inayl003 FROM inayl_t WHERE inaylent='"||g_enterprise||"' AND inayl001=? AND inayl002='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_ooef_m.ooef123_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_ooef_m.ooef123_desc
END FUNCTION]]>
  </point>
  <point name="function.arti100_ooef125_ref" order="10" ver="3" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[##display ooef125
PRIVATE FUNCTION arti100_ooef125_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_ooef_m.ooef125
   CALL ap_ref_array2(g_ref_fields,"SELECT inayl003 FROM inayl_t WHERE inaylent='"||g_enterprise||"' AND inayl001=? AND inayl002='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_ooef_m.ooef125_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_ooef_m.ooef125_desc
END FUNCTION]]>
  </point>
  <point name="function.arti100_ooef004_ref" order="11" ver="3" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#display ooef004
PRIVATE FUNCTION arti100_ooef004_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_ooef_m.ooef004
   CALL ap_ref_array2(g_ref_fields,"SELECT ooall004 FROM ooall_t WHERE ooallent='"||g_enterprise||"' AND ooall001='3' AND ooall002=? AND ooall003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_ooef_m.ooef004_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_ooef_m.ooef004_desc
END FUNCTION]]>
  </point>
  <point name="function.arti100_ooef014_ref" order="12" ver="3" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#display ooef014
PRIVATE FUNCTION arti100_ooef014_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_ooef_m.ooef014
   CALL ap_ref_array2(g_ref_fields,"SELECT ooall004 FROM ooall_t WHERE ooallent='"||g_enterprise||"' AND ooall001='10' AND ooall002=? AND ooall003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_ooef_m.ooef014_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_ooef_m.ooef014_desc
END FUNCTION]]>
  </point>
  <point name="function.arti100_ooef016_ref" order="13" ver="3" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#display ooef016
PRIVATE FUNCTION arti100_ooef016_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_ooef_m.ooef016
   CALL ap_ref_array2(g_ref_fields,"SELECT ooail003 FROM ooail_t WHERE ooailent='"||g_enterprise||"' AND ooail001=? AND ooail002='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_ooef_m.ooef016_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_ooef_m.ooef016_desc
END FUNCTION]]>
  </point>
  <point name="function.arti100_ooef015_ref" order="14" ver="3" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#display ooef015
PRIVATE FUNCTION arti100_ooef015_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_ooef_m.ooef015
   CALL ap_ref_array2(g_ref_fields,"SELECT ooall004 FROM ooall_t WHERE ooallent='"||g_enterprise||"' AND ooall001='1' AND ooall002=? AND ooall003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_ooef_m.ooef015_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_ooef_m.ooef015_desc
END FUNCTION]]>
  </point>
  <point name="function.arti100_ooef006_ref" order="15" ver="3" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#display ooef006
PRIVATE FUNCTION arti100_ooef006_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_ooef_m.ooef006
   CALL ap_ref_array2(g_ref_fields,"SELECT oocgl003 FROM oocgl_t WHERE oocglent='"||g_enterprise||"' AND oocgl001=? AND oocgl002='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_ooef_m.ooef006_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_ooef_m.ooef006_desc
END FUNCTION]]>
  </point>
  <point name="function.arti100_ooef019_ref" order="16" ver="3" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#display ooef019
PRIVATE FUNCTION arti100_ooef019_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_ooef_m.ooef019
   CALL ap_ref_array2(g_ref_fields,"SELECT ooall004 FROM ooall_t WHERE ooallent='"||g_enterprise||"' AND ooall001='2' AND ooall002=? AND ooall003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_ooef_m.ooef019_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_ooef_m.ooef019_desc
END FUNCTION]]>
  </point>
  <point name="function.arti100_ooef008_ref" order="17" ver="3" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#display ooef008
PRIVATE FUNCTION arti100_ooef008_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_ooef_m.ooef008
   CALL ap_ref_array2(g_ref_fields,"SELECT ooall004 FROM ooall_t WHERE ooallent='"||g_enterprise||"' AND ooall001='4' AND ooall002=? AND ooall003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_ooef_m.ooef008_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_ooef_m.ooef008_desc
END FUNCTION]]>
  </point>
  <point name="function.arti100_ooef010_ref" order="18" ver="3" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#display ooef010
PRIVATE FUNCTION arti100_ooef010_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_ooef_m.ooef010
   CALL ap_ref_array2(g_ref_fields,"SELECT gzcbl004 FROM gzcbl_t WHERE gzcbl001='25' AND gzcbl002=? AND gzcbl003='"||g_lang||"'","") RETURNING g_rtn_fields
   LET g_ooef_m.ooef010_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_ooef_m.ooef010_desc
END FUNCTION]]>
  </point>
  <point name="function.arti100_ooef024_ref" order="19" ver="3" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#display ooef024
PRIVATE FUNCTION arti100_ooef024_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_ooef_m.ooef024
   CALL ap_ref_array2(g_ref_fields,"SELECT pmaal003 FROM pmaal_t WHERE pmaalent='"||g_enterprise||"' AND pmaal001=? AND pmaal002='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_ooef_m.ooef024_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_ooef_m.ooef024_desc
END FUNCTION]]>
  </point>
  <point name="function.arti100_ooef150_ref" order="20" ver="3" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#display ooef150
PRIVATE FUNCTION arti100_ooef150_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_ooef_m.ooef150
   CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='2077' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_ooef_m.ooef150_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_ooef_m.ooef150_desc
END FUNCTION]]>
  </point>
  <point name="function.arti100_ooef151_ref" order="21" ver="3" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#display ooef151
PRIVATE FUNCTION arti100_ooef151_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_ooef_m.ooef151
   CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='2078' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_ooef_m.ooef151_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_ooef_m.ooef151_desc
END FUNCTION]]>
  </point>
  <point name="function.arti100_ooef152_ref" order="22" ver="3" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#display ooef152
PRIVATE FUNCTION arti100_ooef152_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_ooef_m.ooef152
   CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='2079' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_ooef_m.ooef152_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_ooef_m.ooef152_desc
END FUNCTION]]>
  </point>
  <point name="function.arti100_ooef153_ref" order="23" ver="3" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#display ooef153
PRIVATE FUNCTION arti100_ooef153_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_ooef_m.ooef153
   CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='2080' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_ooef_m.ooef153_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_ooef_m.ooef153_desc
END FUNCTION]]>
  </point>
  <point name="function.arti100_ooef154_ref" order="24" ver="3" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#display ooef154
PRIVATE FUNCTION arti100_ooef154_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_ooef_m.ooef154
   CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='2081' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_ooef_m.ooef154_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_ooef_m.ooef154_desc
END FUNCTION]]>
  </point>
  <point name="function.arti100_ooef155_ref" order="25" ver="3" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#display ooef155
PRIVATE FUNCTION arti100_ooef155_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_ooef_m.ooef155
   CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='2082' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_ooef_m.ooef155_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_ooef_m.ooef155_desc
END FUNCTION]]>
  </point>
  <point name="function.arti100_ooef157_ref" order="26" ver="3" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#display ooef157
PRIVATE FUNCTION arti100_ooef157_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_ooef_m.ooef157
   CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='2084' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_ooef_m.ooef157_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_ooef_m.ooef157_desc
END FUNCTION]]>
  </point>
  <point name="function.arti100_ooef158_ref" order="27" ver="3" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#display ooef158
PRIVATE FUNCTION arti100_ooef158_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_ooef_m.ooef158
   CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='2085' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_ooef_m.ooef158_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_ooef_m.ooef158_desc
END FUNCTION]]>
  </point>
  <point name="function.arti100_ooef159_ref" order="28" ver="3" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#display ooef159
PRIVATE FUNCTION arti100_ooef159_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_ooef_m.ooef159
   CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='2086' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_ooef_m.ooef159_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_ooef_m.ooef159_desc
END FUNCTION]]>
  </point>
  <point name="function.arti100_ooef160_ref" order="29" ver="3" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#dosplay ooef160
PRIVATE FUNCTION arti100_ooef160_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_ooef_m.ooef160
   CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='2087' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_ooef_m.ooef160_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_ooef_m.ooef160_desc
END FUNCTION]]>
  </point>
  <point name="function.arti100_ooef161_ref" order="30" ver="3" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#display ooef161
PRIVATE FUNCTION arti100_ooef161_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_ooef_m.ooef161
   CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='2088' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_ooef_m.ooef161_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_ooef_m.ooef161_desc
END FUNCTION]]>
  </point>
  <point name="function.arti100_ooef162_ref" order="31" ver="3" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#display ooef162
PRIVATE FUNCTION arti100_ooef162_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_ooef_m.ooef162
   CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='2089' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_ooef_m.ooef162_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_ooef_m.ooef162_desc
END FUNCTION]]>
  </point>
  <point name="function.arti100_ooef163_ref" order="32" ver="3" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[##display ooef163
PRIVATE FUNCTION arti100_ooef163_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_ooef_m.ooef163
   CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='2090' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_ooef_m.ooef163_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_ooef_m.ooef163_desc
END FUNCTION]]>
  </point>
  <point name="function.arti100_ooef164_ref" order="33" ver="3" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#display ooef164
PRIVATE FUNCTION arti100_ooef164_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_ooef_m.ooef164
   CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='2091' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_ooef_m.ooef164_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_ooef_m.ooef164_desc
END FUNCTION]]>
  </point>
  <point name="function.arti100_ooef165_ref" order="34" ver="3" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#display ooef165
PRIVATE FUNCTION arti100_ooef165_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_ooef_m.ooef165
   CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='2092' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_ooef_m.ooef165_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_ooef_m.ooef165_desc
END FUNCTION]]>
  </point>
  <point name="function.arti100_ooef166_ref" order="35" ver="3" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#display ooef166
PRIVATE FUNCTION arti100_ooef166_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_ooef_m.ooef166
   CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='2093' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_ooef_m.ooef166_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_ooef_m.ooef166_desc
END FUNCTION]]>
  </point>
  <point name="function.arti100_ooef167_ref" order="36" ver="3" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#display ooef167
PRIVATE FUNCTION arti100_ooef167_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_ooef_m.ooef167
   CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='2094' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_ooef_m.ooef167_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_ooef_m.ooef167_desc
END FUNCTION]]>
  </point>
  <point name="function.arti100_ooef168_ref" order="37" ver="3" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#display ooef168
PRIVATE FUNCTION arti100_ooef168_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_ooef_m.ooef168
   CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='2095' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_ooef_m.ooef168_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_ooef_m.ooef168_desc
END FUNCTION]]>
  </point>
  <point name="function.arti100_ooef169_ref" order="38" ver="3" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#display ooef169
PRIVATE FUNCTION arti100_ooef169_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_ooef_m.ooef169
   CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='2096' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_ooef_m.ooef169_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_ooef_m.ooef169_desc
END FUNCTION]]>
  </point>
  <point name="function.arti100_ooef018_ref" order="39" ver="3" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#display ooef018
PRIVATE FUNCTION arti100_ooef018_ref()
   DEFINE l_gzot002   LIKE gzot_t.gzot002
   DEFINE l_gzot003   LIKE gzot_t.gzot003
   define l_ooef018_desc like type_t.chr80
   SELECT gzot002,gzot003 INTO l_gzot002,l_gzot003
     FROM gzot_t
    WHERE gzot001 = g_ooef_m.ooef018
   LET g_ooef_m.ooef018_desc = l_gzot002," ",l_gzot003
   DISPLAY  BY name g_ooef_m.ooef018_desc
END FUNCTION]]>
  </point>
  <point name="function.arti100_ooef124_ref" order="40" ver="3" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#display ooef124
PRIVATE FUNCTION arti100_ooef124_ref()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_ooef_m.ooef124
   CALL ap_ref_array2(g_ref_fields,"SELECT inayl003 FROM inayl_t WHERE inaylent='"||g_enterprise||"' AND inayl001=? AND inayl002='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_ooef_m.ooef124_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_ooef_m.ooef124_desc
END FUNCTION]]>
  </point>
  <point name="function.arti100_init" order="41" ver="5" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION arti100_init()
   
   #add-point:init段define
   {<point name="init.define"/>}
   DEFINE l_success LIKE type_t.num5      #150308-00001#5  By benson 150309
   #end add-point

   #該樣板不需此段落LET g_main_hidden = 0
      CALL cl_set_combo_scc_part('ooefstus','17','N,Y')

      CALL cl_set_combo_scc('ooef101','6540')
   CALL cl_set_combo_scc('ooef102','6201')
   CALL cl_set_combo_scc('ooef103','6541')
   CALL cl_set_combo_scc('ooef100','6542')
   CALL cl_set_combo_scc('ooef010','25')
   CALL cl_set_combo_scc('ooef011','27')
   CALL cl_set_combo_scc('ooef013','10')
   CALL cl_set_combo_scc('ooef023','49')

   LET g_error_show = 1
   LET gwin_curr = ui.Window.getCurrent()
   LET gfrm_curr = gwin_curr.getForm()

   #add-point:畫面資料初始化
   {<point name="init.init" />}
   LET g_errshow = 1
   CALL cl_set_combo_scc('ooef003','42')
    CALL cl_set_combo_scc('b_ooef101','6540')
   CALL cl_set_combo_scc('b_ooef102','6201')
   CALL cl_set_combo_scc('b_ooef103','6541')
   CALL cl_ui_replace_sub_window(cl_ap_formpath("aoo", "aooi350_01"), "grid_contact", "Table", "s_detail1_aooi350_01")
   CALL cl_set_combo_scc('oofb008','9')   #地址類型
   CALL cl_ui_replace_sub_window(cl_ap_formpath("aoo", "aooi350_02"), "grid_communication", "Table", "s_detail1_aooi350_02")
   CALL cl_set_combo_scc('oofc008','6')   #通訊類型
   CALL s_aooi500_create_temp() RETURNING l_success    #150308-00001#5  By benson 150309
   CALL cl_set_combo_lang("ooef116") #150429-00001#1  By geza 150430
   #end add-point
   
   CALL arti100_default_search()

END FUNCTION]]>
  </point>
  <point name="function.arti100_ui_dialog" order="42" ver="7" cite_std="N" new="Y" status="u" src="s" readonly="" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION arti100_ui_dialog()
   {<Local define>}
   DEFINE li_exit  LIKE type_t.num5    #判別是否為離開作業
   DEFINE li_idx   LIKE type_t.num5
   {</Local define>}
   #add-point:ui_dialog段define
   {<point name="ui_dialog.define"/>}
   #end add-point

   LET li_exit = FALSE
   LET g_current_row = 0
   LET g_current_idx = 1
   CALL gfrm_curr.setElementImage("logo","logo/applogo.png")

   IF g_wc.trim() <> "1=1" THEN
      CALL gfrm_curr.setElementHidden("mainlayout",0)
      CALL gfrm_curr.setElementHidden("worksheet",1)
      LET g_main_hidden = 0
   ELSE
      CALL gfrm_curr.setElementHidden("mainlayout",1)
      CALL gfrm_curr.setElementHidden("worksheet",0)
      LET g_main_hidden = 1
   END IF

   #add-point:ui_dialog段before dialog
   {<point name="ui_dialog.before_dialog"/>}
   IF cl_null(g_wc) THEN
      LET g_wc = " 1=1"
   END IF
   LET g_wc = g_wc," AND ooef304='Y' "
 
   #end add-point
   #150424-00018#3 150529 by s983961 add(s)  aoos010走申請流程控管
   CALL arti100_set_act_visible()
   CALL arti100_set_act_no_visible() 
   #150424-00018#3 150529 by s983961 add(e)  aoos010走申請流程控管 
   WHILE li_exit = FALSE

      CALL arti100_browser_fill(g_wc,"")
      CALL lib_cl_dlg.cl_dlg_before_display()
      CALL cl_notice()

      #判斷前一個動作是否為新增, 若是的話切換到新增的筆數
      IF g_state = "Y" THEN
         FOR li_idx = 1 TO g_browser.getLength()
            IF g_browser[li_idx].b_ooef001 = g_ooef001_t

               THEN
               LET g_current_row = li_idx
               EXIT FOR
            END IF
         END FOR
         LET g_state = ""
      END IF

#      #該樣板不需此段落IF g_main_hidden = 2 THEN
#      IF g_main_hidden = 0 THEN
#         MENU
#            BEFORE MENU
#
#               CALL cl_navigator_setting(g_current_idx, g_current_cnt)
#
#               #還原為原本指定筆數
#               IF g_current_row > 0 THEN
#                  LET g_current_idx = g_current_row
#               END IF
#
#               #當每次點任一筆資料都會需要用到
#               IF g_browser_cnt > 0 THEN
#                  CALL arti100_fetch("")
#               END IF
#
#            ON ACTION statechange
#               CALL arti100_statechange()
#               LET g_action_choice="statechange"
#
#            ON ACTION first
#               CALL arti100_fetch("F")
#               LET g_current_row = g_current_idx
#
#            ON ACTION next
#               CALL arti100_fetch("N")
#               LET g_current_row = g_current_idx
#
#            ON ACTION jump
#               CALL arti100_fetch("/")
#               LET g_current_row = g_current_idx
#
#            ON ACTION previous
#               CALL arti100_fetch("P")
#               LET g_current_row = g_current_idx
#
#            ON ACTION last
#               CALL arti100_fetch("L")
#               #CALL cl_navigator_setting(g_current_idx, g_current_cnt)
#               #CALL fgl_set_arr_curr(g_current_idx)
#               LET g_current_row = g_current_idx
#
#            ON ACTION exit
#               LET g_action_choice="exit"
#               LET INT_FLAG = FALSE
#               LET li_exit = TRUE
#               EXIT MENU
#
#            ON ACTION close
#               LET li_exit = TRUE
#               EXIT MENU
#
#            ON ACTION mainhidden       #主頁摺疊
#               IF g_main_hidden THEN
#                  CALL gfrm_curr.setElementHidden("mainlayout",0)
#                  CALL gfrm_curr.setElementHidden("worksheet",1)
#                  LET g_main_hidden = 0
#               ELSE
#                  CALL gfrm_curr.setElementHidden("mainlayout",1)
#                  CALL gfrm_curr.setElementHidden("worksheet",0)
#                  LET g_main_hidden = 1
#               END IF
#               EXIT MENU
#
#            ON ACTION worksheethidden   #瀏覽頁折疊
#               IF g_main_hidden THEN
#                  CALL gfrm_curr.setElementHidden("mainlayout",0)
#                  CALL gfrm_curr.setElementHidden("worksheet",1)
#                  LET g_main_hidden = 0
#               ELSE
#                  CALL gfrm_curr.setElementHidden("mainlayout",1)
#                  CALL gfrm_curr.setElementHidden("worksheet",0)
#                  LET g_main_hidden = 1
#               END IF
#               EXIT MENU
#
#            #單頭摺疊，可利用hot key "Ctrl-s"開啟/關閉單頭
#            ON ACTION controls
#               IF g_header_hidden THEN
#                  CALL gfrm_curr.setElementHidden("worksheet_detail",0)
#                  CALL gfrm_curr.setElementImage("controls","small/arr-u.png")
#                  LET g_header_hidden = 0     #visible
#               ELSE
#                  CALL gfrm_curr.setElementHidden("worksheet_detail",1)
#                  CALL gfrm_curr.setElementImage("controls","small/arr-d.png")
#                  LET g_header_hidden = 1     #hidden
#               END IF
#
#
#
#         ON ACTION delete
#
#            LET g_action_choice="delete"
#            IF cl_auth_chk_act("delete") THEN
#               CALL arti100_delete()
#               #add-point:ON ACTION delete
#               {<point name="menu2.delete" />}
#               #END add-point
#            END IF
#
#
#         ON ACTION insert
#
#            LET g_action_choice="insert"
#            IF cl_auth_chk_act("insert") THEN
#               CALL arti100_insert()
#               #add-point:ON ACTION insert
#               {<point name="menu2.insert" />}
#               #END add-point
#               EXIT MENU
#            END IF
#
#
#         ON ACTION modify
#
#            LET g_action_choice="modify"
#            IF cl_auth_chk_act("modify") THEN
#               CALL arti100_modify()
#               #add-point:ON ACTION modify
#               {<point name="menu2.modify" />}
#               #END add-point
#               EXIT MENU
#            END IF
#
#
#         ON ACTION output
#
#            LET g_action_choice="output"
#            IF cl_auth_chk_act("output") THEN
#               #add-point:ON ACTION output
#               {<point name="menu2.output" />}
#               #END add-point
#               EXIT MENU
#            END IF
#
#
#         ON ACTION query
#
#            LET g_action_choice="query"
#            IF cl_auth_chk_act("query") THEN
#               CALL arti100_query()
#               #add-point:ON ACTION query
#               {<point name="menu2.query" />}
#               #END add-point
#            END IF
#
#
#         ON ACTION reproduce
#
#            LET g_action_choice="reproduce"
#            IF cl_auth_chk_act("reproduce") THEN
#               CALL arti100_reproduce()
#               #add-point:ON ACTION reproduce
#               {<point name="menu2.reproduce" />}
#               #END add-point
#               EXIT MENU
#            END IF
#
#
#
#
#            #主選單用ACTION
#            &include "main_menu.4gl"
#            &include "relating_action.4gl"
#            #交談指令共用ACTION
#            &include "common_action.4gl"
#
#         END MENU
#
#      ELSE

         DIALOG ATTRIBUTES(UNBUFFERED,FIELD ORDER FORM)

            #該樣板不需此段落INPUT g_searchstr,g_searchcol FROM formonly.searchstr,formonly.cbo_searchcol
            #該樣板不需此段落   BEFORE INPUT
            #該樣板不需此段落
            #該樣板不需此段落END INPUT

            #左側瀏覽頁簽
            DISPLAY ARRAY g_browser TO s_browse.* ATTRIBUTE(COUNT=g_rec_b)

               BEFORE ROW
                  #回歸舊筆數位置 (回到當時異動的筆數)
                  LET g_current_idx = DIALOG.getCurrentRow("s_browse")
                  IF g_current_idx = 0 THEN
                     LET g_current_idx = 1
                  END IF
                  LET g_current_row = g_current_idx  #目前指標
                  LET g_current_sw = TRUE
                  CALL cl_show_fld_cont()

                  #當每次點任一筆資料都會需要用到
                  CALL arti100_fetch("")

               #該樣板不需此段落ON EXPAND (g_row_index)
               #該樣板不需此段落   #樹展開
               #該樣板不需此段落   CALL arti100_browser_expand(g_row_index)
               #該樣板不需此段落   LET g_browser[g_row_index].b_isExp = 1

               ON COLLAPSE (g_row_index)
                  #樹關閉

            END DISPLAY

            SUBDIALOG lib_cl_dlg.cl_dlg_qryplan
            SUBDIALOG lib_cl_dlg.cl_dlg_relateapps

            #add-point:ui_dialog段define
            {<point name="ui_dialog.more_displayarray"/>}
            SUBDIALOG aoo_aooi350_01.aooi350_01_display
            SUBDIALOG aoo_aooi350_02.aooi350_02_display
            #end add-point

            BEFORE DIALOG
               CALL cl_navigator_setting(g_current_idx, g_current_cnt)
               LET g_curr_diag = ui.DIALOG.getCurrent()
               #LET g_page = "first"
               #還原為原本指定筆數
               IF g_current_row > 1 THEN
                  #當刪除最後一筆資料時可能產生錯誤, 進行額外判斷
                  IF g_current_row > g_browser.getLength() THEN
                     LET g_current_row = g_browser.getLength()
                  END IF
                  LET g_current_idx = g_current_row
                  CALL DIALOG.setCurrentRow("s_browse",g_current_idx)
               END IF

               #當每次點任一筆資料都會需要用到
               IF g_browser_cnt > 0 THEN
                  CALL arti100_fetch("")
               END IF

            AFTER DIALOG
               #add-point:ui_dialog段 after dialog
               {<point name="ui_dialog.after_dialog"/>}
               #end add-point

            ON ACTION statechange
               CALL arti100_statechange()
               LET g_action_choice="statechange"
               EXIT DIALOG

            ON ACTION filter
               CALL arti100_filter()
               EXIT DIALOG

            ON ACTION first
               CALL arti100_fetch("F")
               LET g_current_row = g_current_idx

            ON ACTION next
               CALL arti100_fetch("N")
               LET g_current_row = g_current_idx

            ON ACTION jump
               CALL arti100_fetch("/")
               LET g_current_row = g_current_idx

            ON ACTION previous
               CALL arti100_fetch("P")
               LET g_current_row = g_current_idx

            ON ACTION last
               CALL arti100_fetch("L")
               #CALL cl_navigator_setting(g_current_idx, g_current_cnt)
               #CALL fgl_set_arr_curr(g_current_idx)
               LET g_current_row = g_current_idx

            ON ACTION exit
               LET g_action_choice="exit"
               LET INT_FLAG = FALSE
               LET li_exit = TRUE
               EXIT DIALOG

            ON ACTION close
               LET li_exit = TRUE
               EXIT DIALOG

            ON ACTION mainhidden       #主頁摺疊
               IF g_main_hidden THEN
                  CALL gfrm_curr.setElementHidden("mainlayout",0)
                  CALL gfrm_curr.setElementHidden("worksheet",1)
                  LET g_main_hidden = 0
                  #該樣板不需此段落CALL gfrm_curr.setElementHidden("mainlayout",1)
                  #該樣板不需此段落LET g_main_hidden = 0
                  #該樣板不需此段落CALL gfrm_curr.setElementImage("mainhidden","small/arr-u.png")
               ELSE
                  CALL gfrm_curr.setElementHidden("mainlayout",1)
                  CALL gfrm_curr.setElementHidden("worksheet",0)
                  LET g_main_hidden = 1
                  #該樣板不需此段落CALL gfrm_curr.setElementHidden("mainlayout",0)
                  #該樣板不需此段落LET g_main_hidden = 1
                  #該樣板不需此段落CALL gfrm_curr.setElementImage("mainhidden","small/arr-d.png")
               END IF
               EXIT DIALOG

            ON ACTION worksheethidden   #瀏覽頁折疊
               IF g_main_hidden THEN
                  CALL gfrm_curr.setElementHidden("mainlayout",0)
                  CALL gfrm_curr.setElementHidden("worksheet",1)
                  LET g_main_hidden = 0
               ELSE
                  CALL gfrm_curr.setElementHidden("mainlayout",1)
                  CALL gfrm_curr.setElementHidden("worksheet",0)
                  LET g_main_hidden = 1
               END IF
               EXIT DIALOG

            #單頭摺疊，可利用hot key "Ctrl-s"開啟/關閉單頭
            ON ACTION controls
               IF g_header_hidden THEN
                  CALL gfrm_curr.setElementHidden("worksheet_detail",0)
                  CALL gfrm_curr.setElementImage("controls","small/arr-u.png")
                  LET g_header_hidden = 0     #visible
               ELSE
                  CALL gfrm_curr.setElementHidden("worksheet_detail",1)
                  CALL gfrm_curr.setElementImage("controls","small/arr-d.png")
                  LET g_header_hidden = 1     #hidden
               END IF

            #快速搜尋
            #該樣板不需此段落ON ACTION searchdata
            #該樣板不需此段落   LET g_current_idx = 1
            #該樣板不需此段落   LET g_searchstr = GET_FLDBUF(searchstr)
            #該樣板不需此段落   CALL arti100_browser_search()
            #該樣板不需此段落   EXIT DIALOG



         ON ACTION delete

            LET g_action_choice="delete"
            IF cl_auth_chk_act("delete") THEN
               CALL arti100_delete()
               #add-point:ON ACTION delete
               {<point name="menu.delete" />}
               #END add-point
            END IF


         ON ACTION insert

            LET g_action_choice="insert"
            IF cl_auth_chk_act("insert") THEN
               CALL arti100_insert()
               #add-point:ON ACTION insert
               {<point name="menu.insert" />}
               #END add-point
               EXIT DIALOG
            END IF


         ON ACTION modify

            LET g_action_choice="modify"
            IF cl_auth_chk_act("modify") THEN
               CALL arti100_modify()
               #add-point:ON ACTION modify
               {<point name="menu.modify" />}
               #END add-point
               EXIT DIALOG
            END IF


         ON ACTION output

            LET g_action_choice="output"
            IF cl_auth_chk_act("output") THEN
               #add-point:ON ACTION output
               {<point name="menu.output" />}
               #END add-point
               EXIT DIALOG
            END IF


         ON ACTION query

            LET g_action_choice="query"
            IF cl_auth_chk_act("query") THEN
               CALL arti100_query()
               #add-point:ON ACTION query
               {<point name="menu.query" />}
               EXIT DIALOG #150424-00018#3 15/06/17 by s983961---add aoos010走申請流程控管
                 
               #END add-point
            END IF


         ON ACTION reproduce

            LET g_action_choice="reproduce"
            IF cl_auth_chk_act("reproduce") THEN
               CALL arti100_reproduce()
               #add-point:ON ACTION reproduce
               {<point name="menu.reproduce" />}
               #END add-point
               EXIT DIALOG
            END IF

         #ken---add---s 需求單號：150107-00009 項次：5
         ON ACTION exporttoexcel
            LET g_action_choice="exporttoexcel"
            IF cl_auth_chk_act("exporttoexcel") THEN
               #browser
               CALL g_export_node.clear()
               IF g_main_hidden = 1 THEN
                  LET g_export_node[1] = base.typeInfo.create(g_browser)
                  LET g_export_id[1]   = "s_browse"
                  CALL cl_export_to_excel()
               #非browser
               ELSE
                  LET g_export_node[1] = base.typeInfo.create(g_pmba_d)
                  LET g_export_id[1]   = "s_detail1_aooi350_01"
                  LET g_export_node[2] = base.typeInfo.create(g_pmba2_d)
                  LET g_export_id[2]   = "s_detail1_aooi350_02"

                  CALL cl_export_to_excel_getpage()
                  CALL cl_export_to_excel()
               END IF
            END IF            
         #ken---add---e   


            #主選單用ACTION
            &include "main_menu.4gl"
            &include "relating_action.4gl"
            #交談指令共用ACTION
            &include "common_action.4gl"

         END DIALOG

#      END IF

   END WHILE

END FUNCTION]]>
  </point>
  <point name="function.arti100_browser_fill" order="43" ver="3" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION arti100_browser_fill(p_wc,ps_page_action)
   {<Local define>}
   DEFINE p_wc              STRING
   DEFINE ps_page_action    STRING
   DEFINE l_searchcol       STRING
   DEFINE l_sql             STRING
   DEFINE l_sql_rank        STRING
   {</Local define>}
   #add-point:browser_fill段define
   {<point name="browser_fill.define"/>}
   #end add-point

   CLEAR FORM
   INITIALIZE g_ooef_m.* TO NULL
   INITIALIZE g_wc TO NULL
   CALL g_browser.clear()
   
   CALL aooi350_01_clear_detail()  #qiaozy--
   CALL aooi350_02_clear_detail()  #qiaozy--

   #搜尋用
   IF cl_null(g_searchcol) OR g_searchcol = "0" THEN
      LET l_searchcol = "ooef001"
   ELSE
      LET l_searchcol = g_searchcol
   END IF

   LET p_wc = p_wc.trim() #當查詢按下Q時 按下放棄 g_wc = "  " 所以要清掉空白
   IF cl_null(p_wc) THEN  #p_wc 查詢條件
      LET p_wc = " 1=1 "
   END IF

   #add-point:browser_fill段wc控制
   {<point name="browser_fill.wc"/>}
   #end add-point

   LET g_sql = " SELECT COUNT(*) FROM ooef_t ",
               "  ",
               "  LEFT JOIN ooefl_t ON ooeflent = '"||g_enterprise||"' AND ooef001 = ooefl001 AND ooefl002 = '",g_dlang,"' ",
               "   LEFT JOIN oofb_t ON oofbent = ooefent AND ooef012 = oofb002",
               "   LEFT JOIN oofc_t ON oofcent = ooefent AND ooef012 = oofc002",
               " WHERE ooefent = '" ||g_enterprise|| "' AND ",
               p_wc CLIPPED

   #add-point:browser_fill段cnt_sql
   {<point name="browser_fill.cnt_sql"/>}
   #end add-point
				
   PREPARE header_cnt_pre FROM g_sql
   EXECUTE header_cnt_pre INTO g_browser_cnt
   FREE header_cnt_pre

   #若超過最大顯示筆數
   IF g_browser_cnt > g_max_browse AND g_error_show = 1 THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = '9035'
      LET g_errparam.extend = g_browser_cnt
      LET g_errparam.popup = TRUE
      CALL cl_err()

   END IF

      LET g_error_show = 0

   DISPLAY g_browser_cnt TO FORMONLY.b_count
   DISPLAY g_browser_cnt TO FORMONLY.h_count

   LET g_wc = p_wc
   #LET g_page_action = ps_page_action          # Keep Action

   IF ps_page_action = "F" OR
      ps_page_action = "P"  OR
      ps_page_action = "N"  OR
      ps_page_action = "L"  THEN
      LET g_page_action = ps_page_action
   END IF

   CASE ps_page_action

      WHEN "F"
         LET g_pagestart = 1

      WHEN "P"
         LET g_pagestart = g_pagestart - g_max_browse
         IF g_pagestart < 1 THEN
            LET g_pagestart = 1
         END IF

      WHEN "N"
         LET g_pagestart = g_pagestart + g_max_browse
         IF g_pagestart > g_browser_cnt THEN
            LET g_pagestart = g_browser_cnt - (g_browser_cnt mod g_max_browse) + 1
            WHILE g_pagestart > g_browser_cnt
               LET g_pagestart = g_pagestart - g_max_browse
            END WHILE
         END IF

      WHEN "L"
         LET g_pagestart = g_browser_cnt - (g_browser_cnt mod g_max_browse) + 1
         WHILE g_pagestart > g_browser_cnt
            LET g_pagestart = g_pagestart - g_max_browse
         END WHILE

      WHEN '/'
         LET g_pagestart = g_jump
         IF g_pagestart > g_browser_cnt THEN
            LET g_pagestart = 1
            INITIALIZE g_errparam TO NULL
            LET g_errparam.code = 'azz-998'
            LET g_errparam.extend = g_jump
            LET g_errparam.popup = FALSE
            CALL cl_err()

         END IF

      OTHERWISE

   END CASE

   LET l_sql_rank = "SELECT ooefstus,ooef001,'',ooef017,'',ooef101,ooef105,'',ooef102,ooef103,ooef104,'',RANK() OVER(ORDER BY ooef001 ",

                    g_order,
                    ") AS RANK ",
                    " FROM ooef_t ",
                    "  LEFT JOIN ooefl_t ON ooeflent = '"||g_enterprise||"' AND ooef001 = ooefl001 AND ooefl002 = '",g_dlang,"' ",
                    "   LEFT JOIN oofb_t ON oofbent = ooefent AND ooef012 = oofb002",
                    "   LEFT JOIN oofc_t ON oofcent = ooefent AND ooef012 = oofc002",
                    " WHERE ooefent = '" ||g_enterprise|| "' AND ", g_wc

   #add-point:browser_fill段before_pre
   {<point name="browser_fill.before_pre"/>}
   #end add-point					
					
   #定義翻頁CURSOR
   LET g_sql= " SELECT unique ooefstus,ooef001,'',ooef017,'',ooef101,ooef105,'',ooef102,ooef103,ooef104,'' FROM (",l_sql_rank,") ",
              "  WHERE RANK >= ", g_pagestart,
              "    AND RANK <  ", (g_pagestart + g_max_browse) ,
              "  ORDER BY ",l_searchcol," ",g_order

   PREPARE browse_pre FROM g_sql
   DECLARE browse_cur CURSOR FOR browse_pre

   CALL g_browser.clear()
   LET g_cnt = 1
   FOREACH browse_cur INTO g_browser[g_cnt].b_statepic,g_browser[g_cnt].b_ooef001,g_browser[g_cnt].b_ooef001_desc,g_browser[g_cnt].b_ooef017,g_browser[g_cnt].b_ooef017_desc,g_browser[g_cnt].b_ooef101,g_browser[g_cnt].b_ooef105,g_browser[g_cnt].b_ooef105_desc,g_browser[g_cnt].b_ooef102,g_browser[g_cnt].b_ooef103,g_browser[g_cnt].b_ooef104,g_browser[g_cnt].b_ooef104_desc   #單身 ARRAY 填充
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "foreach:"
         LET g_errparam.popup = TRUE
         CALL cl_err()

         EXIT FOREACH
      END IF


      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_browser[g_cnt].b_ooef001
      CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_lang||"'","") RETURNING g_rtn_fields
      LET g_browser[g_cnt].b_ooef001_desc = '', g_rtn_fields[1] , ''
      DISPLAY BY NAME g_browser[g_cnt].b_ooef001_desc

      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_browser[g_cnt].b_ooef017
      CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_lang||"'","") RETURNING g_rtn_fields
      LET g_browser[g_cnt].b_ooef017_desc = '', g_rtn_fields[1] , ''
      DISPLAY BY NAME g_browser[g_cnt].b_ooef017_desc

      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_browser[g_cnt].b_ooef105
      CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_lang||"'","") RETURNING g_rtn_fields
      LET g_browser[g_cnt].b_ooef105_desc = '', g_rtn_fields[1] , ''
      DISPLAY BY NAME g_browser[g_cnt].b_ooef105_desc

      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_browser[g_cnt].b_ooef104
      CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='2076' AND oocql002=? AND oocql003='"||g_lang||"'","") RETURNING g_rtn_fields
      LET g_browser[g_cnt].b_ooef104_desc = '', g_rtn_fields[1] , ''
      DISPLAY BY NAME g_browser[g_cnt].b_ooef104_desc


      #add-point:browser_fill段reference
      {<point name="browser_fill.reference"/>}
      #end add-point

      LET g_browser[g_cnt].b_statepic = cl_get_actipic(g_browser[g_cnt].b_statepic)
      LET g_cnt = g_cnt + 1
      IF g_cnt > g_max_rec THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = "std-00002"
         LET g_errparam.extend = "Max_Row:"||g_max_rec USING "<<<<<"
         LET g_errparam.popup = FALSE
         CALL cl_err()

         EXIT FOREACH
      END IF
   END FOREACH

   CALL g_browser.deleteElement(g_cnt)
   LET g_header_cnt = g_browser.getLength()
   #該樣板不需此段落LET g_header_cnt = g_browser_cnt
   LET g_rec_b = g_cnt - 1
   LET g_current_cnt = g_rec_b
   #該樣板不需此段落LET g_current_cnt = g_browser_cnt
   LET g_cnt = 0

   CALL arti100_fetch("")

   FREE browse_pre

END FUNCTION]]>
  </point>
  <point name="function.arti100_construct" order="44" ver="5" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION arti100_construct()
   {<Local define>}
   DEFINE ls_return      STRING
   DEFINE ls_result      STRING
   {</Local define>}
   #add-point:cs段define
   {<point name="cs.define"/>}
   #end add-point

   CLEAR FORM
   INITIALIZE g_ooef_m.* TO NULL
   INITIALIZE g_wc TO NULL
   LET g_current_row = 1

   LET g_qryparam.state = "c"

   DIALOG ATTRIBUTES(UNBUFFERED,FIELD ORDER FORM)
      
      
      
      #螢幕上取條件
      CONSTRUCT BY NAME g_wc ON ooefunit,ooef001,ooefl003,ooefl004,ooefl005,ooefl006,ooef003,ooef017,ooef101,ooef105,ooef102,ooef103,ooef100,ooefstus,ooef104,ooef106,ooef108,ooef107,ooef109,ooef110,ooef115,ooef116,ooef111,ooef112,ooef113,ooef114,ooef120,ooef121,ooef122,ooef123,ooef124,ooef125,ooefownid,ooefowndp,ooefcrtid,ooefcrtdp,ooefcrtdt,ooefmodid,ooefmoddt,ooef014,ooef016,ooef004,ooef005,ooef015,ooef006,ooef018,ooef019,ooef007,ooef020,ooef022,ooef008,ooef010,ooef011,ooef013,ooef023,ooef024,ooef026,ooef150,ooef151,ooef152,ooef153,ooef154,ooef155,ooef156,ooef157,ooef158,ooef159,ooef160,ooef161,ooef162,ooef163,ooef164,ooef165,ooef166,ooef167,ooef168,ooef169

         BEFORE CONSTRUCT
#            CALL cl_qbe_init()
            #add-point:cs段more_construct
            {<point name="cs.before_construct"/>}
            #end add-point

         #公用欄位開窗相關處理
         #此段落由子樣板a11產生
         ##----<<ooefownid>>----
         #ON ACTION controlp INFIELD ooefownid
         #   CALL q_common('ooef_t','ooefownid',TRUE,FALSE,g_ooef_m.ooefownid) RETURNING ls_return
         #   DISPLAY ls_return TO ooefownid
         #   NEXT FIELD ooefownid
         #
         ##----<<ooefowndp>>----
         #ON ACTION controlp INFIELD ooefowndp
         #   CALL q_common('ooef_t','ooefowndp',TRUE,FALSE,g_ooef_m.ooefowndp) RETURNING ls_return
         #   DISPLAY ls_return TO ooefowndp
         #   NEXT FIELD ooefowndp
         #
         ##----<<ooefcrtid>>----
         #ON ACTION controlp INFIELD ooefcrtid
         #   CALL q_common('ooef_t','ooefcrtid',TRUE,FALSE,g_ooef_m.ooefcrtid) RETURNING ls_return
         #   DISPLAY ls_return TO ooefcrtid
         #   NEXT FIELD ooefcrtid
         #
         ##----<<ooefcrtdp>>----
         #ON ACTION controlp INFIELD ooefcrtdp
         #   CALL q_common('ooef_t','ooefcrtdp',TRUE,FALSE,g_ooef_m.ooefcrtdp) RETURNING ls_return
         #   DISPLAY ls_return TO ooefcrtdp
         #   NEXT FIELD ooefcrtdp
         #
         ##----<<ooefmodid>>----
         #ON ACTION controlp INFIELD ooefmodid
         #   CALL q_common('ooef_t','ooefmodid',TRUE,FALSE,g_ooef_m.ooefmodid) RETURNING ls_return
         #   DISPLAY ls_return TO ooefmodid
         #   NEXT FIELD ooefmodid
         #
         ##----<<ooefcnfid>>----
         ##ON ACTION controlp INFIELD ooefcnfid
         ##   CALL q_common('ooef_t','ooefcnfid',TRUE,FALSE,g_ooef_m.ooefcnfid) RETURNING ls_return
         ##   DISPLAY ls_return TO ooefcnfid
         ##   NEXT FIELD ooefcnfid
         #
         ##----<<ooefpstid>>----
         ##ON ACTION controlp INFIELD ooefpstid
         ##   CALL q_common('ooef_t','ooefpstid',TRUE,FALSE,g_ooef_m.ooefpstid) RETURNING ls_return
         ##   DISPLAY ls_return TO ooefpstid
         ##   NEXT FIELD ooefpstid

         ##----<<ooefcrtdt>>----
         AFTER FIELD ooefcrtdt
            CALL FGL_DIALOG_GETBUFFER() RETURNING ls_result
            IF NOT cl_null(ls_result) THEN
               IF NOT cl_chk_date_symbol(ls_result) THEN
                  LET ls_result = cl_add_date_extra_cond(ls_result)
               END IF
            END IF
            CALL FGL_DIALOG_SETBUFFER(ls_result)

         #----<<ooefmoddt>>----
         AFTER FIELD ooefmoddt
            CALL FGL_DIALOG_GETBUFFER() RETURNING ls_result
            IF NOT cl_null(ls_result) THEN
               IF NOT cl_chk_date_symbol(ls_result) THEN
                  LET ls_result = cl_add_date_extra_cond(ls_result)
               END IF
            END IF
            CALL FGL_DIALOG_SETBUFFER(ls_result)

         #----<<ooefcnfdt>>----
         #AFTER FIELD ooefcnfdt
         #   CALL FGL_DIALOG_GETBUFFER() RETURNING ls_result
         #   IF NOT cl_null(ls_result) THEN
         #      IF NOT cl_chk_date_symbol(ls_result) THEN
         #         LET ls_result = cl_add_date_extra_cond(ls_result)
         #      END IF
         #   END IF
         #   CALL FGL_DIALOG_SETBUFFER(ls_result)

         #----<<ooefpstdt>>----
         #AFTER FIELD ooefpstdt
         #   CALL FGL_DIALOG_GETBUFFER() RETURNING ls_result
         #   IF NOT cl_null(ls_result) THEN
         #      IF NOT cl_chk_date_symbol(ls_result) THEN
         #         LET ls_result = cl_add_date_extra_cond(ls_result)
         #      END IF
         #   END IF
         #   CALL FGL_DIALOG_SETBUFFER(ls_result)



         #一般欄位
         #---------------------------<  Master  >---------------------------
         #----<<ooefunit>>----
         #Ctrlp:construct.c.ooefunit
         ON ACTION controlp INFIELD ooefunit
            #add-point:ON ACTION controlp INFIELD ooefunit
            {<point name="construct.c.ooefunit" />}
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			   LET g_qryparam.reqry = FALSE
#            CALL q_ooef001()                           #呼叫開窗
            LET g_qryparam.where = s_aooi500_q_where(g_prog,'ooefunit',g_site,'c')   #150308-00001#5  By benson add 'c'
            CALL q_ooef001_24()
            DISPLAY g_qryparam.return1 TO ooef001  #顯示到畫面上

            NEXT FIELD ooefunit                    #返回原欄位
            #END add-point

         #----<<ooef001>>----
         #Ctrlp:construct.c.ooef001
         ON ACTION controlp INFIELD ooef001
            #add-point:ON ACTION controlp INFIELD ooef001
            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
#			   LET g_qryparam.where = "ooef304='Y'"
#            CALL q_ooef001()                           #呼叫開窗
            IF s_aooi500_setpoint(g_prog,'ooef001') THEN
               LET g_qryparam.where = s_aooi500_q_where(g_prog,'ooef001',g_site,'c')   #150308-00001#5  By benson add 'c'
               CALL q_ooef001_24()
            ELSE
               LET g_qryparam.where = "ooef304='Y'"
               CALL q_ooef001()  
            END IF
            DISPLAY g_qryparam.return1 TO ooef001  #顯示到畫面上

            NEXT FIELD ooef001                     #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a01產生
         BEFORE FIELD ooef001
            #add-point:BEFORE FIELD ooef001
            {<point name="construct.b.ooef001" />}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD ooef001

            #add-point:AFTER FIELD ooef001
            {<point name="construct.a.ooef001" />}
            #END add-point


         #----<<ooef017>>----
         #Ctrlp:construct.c.ooef017
         ON ACTION controlp INFIELD ooef017
            #add-point:ON ACTION controlp INFIELD ooef017
            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			LET g_qryparam.where  = "ooef003='Y'"
            CALL q_ooef001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO ooef017  #顯示到畫面上

            NEXT FIELD ooef017                     #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a01產生
         BEFORE FIELD ooef017
            #add-point:BEFORE FIELD ooef017
            {<point name="construct.b.ooef017" />}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD ooef017

            #add-point:AFTER FIELD ooef017
            {<point name="construct.a.ooef017" />}
            #END add-point


         #----<<ooef101>>----
         #此段落由子樣板a01產生
         BEFORE FIELD ooef101
            #add-point:BEFORE FIELD ooef101
            {<point name="construct.b.ooef101" />}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD ooef101

            #add-point:AFTER FIELD ooef101
            {<point name="construct.a.ooef101" />}
            #END add-point


         #Ctrlp:construct.c.ooef101
#         ON ACTION controlp INFIELD ooef101
            #add-point:ON ACTION controlp INFIELD ooef101
            {<point name="construct.c.ooef101" />}
            #END add-point

         #----<<ooed005>>----
         #此段落由子樣板a01產生
         BEFORE FIELD ooed005
            #add-point:BEFORE FIELD ooed005
            {<point name="construct.b.ooed005" />}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD ooed005

            #add-point:AFTER FIELD ooed005
            {<point name="construct.a.ooed005" />}
            #END add-point


         #Ctrlp:construct.c.ooed005
#         ON ACTION controlp INFIELD ooed005
            #add-point:ON ACTION controlp INFIELD ooed005
            {<point name="construct.c.ooed005" />}
            #END add-point

         #----<<ooef105>>----
         #Ctrlp:construct.c.ooef105
         ON ACTION controlp INFIELD ooef105
            #add-point:ON ACTION controlp INFIELD ooef105
            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
#			LET g_qryparam.where  = "ooef304='Y'"
#            CALL q_ooef001()                           #呼叫開窗
            IF s_aooi500_setpoint(g_prog,'ooef105') THEN
               LET g_qryparam.where = s_aooi500_q_where(g_prog,'ooef105',g_site,'c')   #150308-00001#5  By benson add 'c'
               CALL q_ooef001_24()
            ELSE
               LET g_qryparam.where  = "ooef304='Y'"
               CALL q_ooef001() 
            END IF
            DISPLAY g_qryparam.return1 TO ooef105  #顯示到畫面上

            NEXT FIELD ooef105                     #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a01產生
         BEFORE FIELD ooef105
            #add-point:BEFORE FIELD ooef105
            {<point name="construct.b.ooef105" />}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD ooef105

            #add-point:AFTER FIELD ooef105
            {<point name="construct.a.ooef105" />}
            #END add-point


         #----<<ooef102>>----
         #此段落由子樣板a01產生
         BEFORE FIELD ooef102
            #add-point:BEFORE FIELD ooef102
            {<point name="construct.b.ooef102" />}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD ooef102

            #add-point:AFTER FIELD ooef102
            {<point name="construct.a.ooef102" />}
            #END add-point


         #Ctrlp:construct.c.ooef102
#         ON ACTION controlp INFIELD ooef102
            #add-point:ON ACTION controlp INFIELD ooef102
            {<point name="construct.c.ooef102" />}
            #END add-point

         #----<<ooef103>>----
         #此段落由子樣板a01產生
         BEFORE FIELD ooef103
            #add-point:BEFORE FIELD ooef103
            {<point name="construct.b.ooef103" />}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD ooef103

            #add-point:AFTER FIELD ooef103
            {<point name="construct.a.ooef103" />}
            #END add-point


         #Ctrlp:construct.c.ooef103
#         ON ACTION controlp INFIELD ooef103
            #add-point:ON ACTION controlp INFIELD ooef103
            {<point name="construct.c.ooef103" />}
            #END add-point

         #----<<ooef100>>----
         #此段落由子樣板a01產生
         BEFORE FIELD ooef100
            #add-point:BEFORE FIELD ooef100
            {<point name="construct.b.ooef100" />}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD ooef100

            #add-point:AFTER FIELD ooef100
            {<point name="construct.a.ooef100" />}
            #END add-point


         #Ctrlp:construct.c.ooef100
#         ON ACTION controlp INFIELD ooef100
            #add-point:ON ACTION controlp INFIELD ooef100
            {<point name="construct.c.ooef100" />}
            #END add-point

         #----<<ooefstus>>----
         #此段落由子樣板a01產生
         BEFORE FIELD ooefstus
            #add-point:BEFORE FIELD ooefstus
            {<point name="construct.b.ooefstus" />}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD ooefstus

            #add-point:AFTER FIELD ooefstus
            {<point name="construct.a.ooefstus" />}
            #END add-point


         #Ctrlp:construct.c.ooefstus
#         ON ACTION controlp INFIELD ooefstus
            #add-point:ON ACTION controlp INFIELD ooefstus
            {<point name="construct.c.ooefstus" />}
            #END add-point

         #----<<ooef104>>----
         #Ctrlp:construct.c.ooef104
         ON ACTION controlp INFIELD ooef104
            #add-point:ON ACTION controlp INFIELD ooef104
            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			   LET g_qryparam.arg1 = "2076"
            CALL q_oocq002_4()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO ooef104  #顯示到畫面上

            NEXT FIELD ooef104                     #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a01產生
         BEFORE FIELD ooef104
            #add-point:BEFORE FIELD ooef104
            {<point name="construct.b.ooef104" />}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD ooef104

            #add-point:AFTER FIELD ooef104
            {<point name="construct.a.ooef104" />}
            #END add-point


         #----<<ooef106>>----
         #Ctrlp:construct.c.ooef106
         ON ACTION controlp INFIELD ooef106
            #add-point:ON ACTION controlp INFIELD ooef106
            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
#			LET g_qryparam.where = "ooef304='Y'"
#            CALL q_ooef001()                           #呼叫開窗
            IF s_aooi500_setpoint(g_prog,'ooef106') THEN
               LET g_qryparam.where = s_aooi500_q_where(g_prog,'ooef106',g_site,'c')   #150308-00001#5  By benson add 'c'
               CALL q_ooef001_24()
            ELSE
               LET g_qryparam.where = "ooef304='Y'"
               CALL q_ooef001()
            END IF
            DISPLAY g_qryparam.return1 TO ooef106  #顯示到畫面上

            NEXT FIELD ooef106                     #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a01產生
         BEFORE FIELD ooef106
            #add-point:BEFORE FIELD ooef106
            {<point name="construct.b.ooef106" />}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD ooef106

            #add-point:AFTER FIELD ooef106
            {<point name="construct.a.ooef106" />}
            #END add-point


         #----<<ooef108>>----
         #Ctrlp:construct.c.ooef108
         ON ACTION controlp INFIELD ooef108
            #add-point:ON ACTION controlp INFIELD ooef108
            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
#			   LET g_qryparam.arg1 = "('2')" #
            LET g_qryparam.where = "pmaa230 = '1' AND pmaa092 = '1' " #150504-00023#1 Add By Ken 150506
            CALL q_pmaa001_15()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO ooef108  #顯示到畫面上

            NEXT FIELD ooef108                     #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a01產生
         BEFORE FIELD ooef108
            #add-point:BEFORE FIELD ooef108
            {<point name="construct.b.ooef108" />}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD ooef108

            #add-point:AFTER FIELD ooef108
            {<point name="construct.a.ooef108" />}
            #END add-point


         #----<<date>>----
         #此段落由子樣板a01產生
         BEFORE FIELD ooef107
            #add-point:BEFORE FIELD date
            {<point name="construct.b.date" />}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD ooef107

            #add-point:AFTER FIELD date
            {<point name="construct.a.date" />}
            #END add-point


         #Ctrlp:construct.c.date
#         ON ACTION controlp INFIELD date
            #add-point:ON ACTION controlp INFIELD date
            {<point name="construct.c.date" />}
            #END add-point

         #----<<ooef109>>----
         #此段落由子樣板a01產生
         BEFORE FIELD ooef109
            #add-point:BEFORE FIELD ooef109
            {<point name="construct.b.ooef109" />}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD ooef109

            #add-point:AFTER FIELD ooef109
            {<point name="construct.a.ooef109" />}
            #END add-point


         #Ctrlp:construct.c.ooef109
#         ON ACTION controlp INFIELD ooef109
            #add-point:ON ACTION controlp INFIELD ooef109
            {<point name="construct.c.ooef109" />}
            #END add-point

         #----<<ooef110>>----
         #此段落由子樣板a01產生
         BEFORE FIELD ooef110
            #add-point:BEFORE FIELD ooef110
            {<point name="construct.b.ooef110" />}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD ooef110

            #add-point:AFTER FIELD ooef110
            {<point name="construct.a.ooef110" />}
            #END add-point


         #Ctrlp:construct.c.ooef110
#         ON ACTION controlp INFIELD ooef110
            #add-point:ON ACTION controlp INFIELD ooef110
            {<point name="construct.c.ooef110" />}
            #END add-point

         #----<<ooef115>>----
         #此段落由子樣板a01產生
         BEFORE FIELD ooef115
            #add-point:BEFORE FIELD ooef115
            {<point name="construct.b.ooef115" />}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD ooef115

            #add-point:AFTER FIELD ooef115
            {<point name="construct.a.ooef115" />}
            #END add-point


         #Ctrlp:construct.c.ooef115
#         ON ACTION controlp INFIELD ooef115
            #add-point:ON ACTION controlp INFIELD ooef115
            {<point name="construct.c.ooef115" />}
            #END add-point
         
         
         
         
         #----<<ooef111>>----
         #此段落由子樣板a01產生
         BEFORE FIELD ooef111
            #add-point:BEFORE FIELD ooef111
            {<point name="construct.b.ooef111" />}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD ooef111

            #add-point:AFTER FIELD ooef111
            {<point name="construct.a.ooef111" />}
            #END add-point


         #Ctrlp:construct.c.ooef111
#         ON ACTION controlp INFIELD ooef111
            #add-point:ON ACTION controlp INFIELD ooef111
            {<point name="construct.c.ooef111" />}
            #END add-point

         #----<<ooef112>>----
         #此段落由子樣板a01產生
         BEFORE FIELD ooef112
            #add-point:BEFORE FIELD ooef112
            {<point name="construct.b.ooef112" />}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD ooef112

            #add-point:AFTER FIELD ooef112
            {<point name="construct.a.ooef112" />}
            #END add-point


         #Ctrlp:construct.c.ooef112
#         ON ACTION controlp INFIELD ooef112
            #add-point:ON ACTION controlp INFIELD ooef112
            {<point name="construct.c.ooef112" />}
            #END add-point

         #----<<ooef113>>----
         #此段落由子樣板a01產生
         BEFORE FIELD ooef113
            #add-point:BEFORE FIELD ooef113
            {<point name="construct.b.ooef113" />}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD ooef113

            #add-point:AFTER FIELD ooef113
            {<point name="construct.a.ooef113" />}
            #END add-point


         #Ctrlp:construct.c.ooef113
#         ON ACTION controlp INFIELD ooef113
            #add-point:ON ACTION controlp INFIELD ooef113
            {<point name="construct.c.ooef113" />}
            #END add-point

         #----<<ooef114>>----
         #此段落由子樣板a01產生
         BEFORE FIELD ooef114
            #add-point:BEFORE FIELD ooef114
            {<point name="construct.b.ooef114" />}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD ooef114

            #add-point:AFTER FIELD ooef114
            {<point name="construct.a.ooef114" />}
            #END add-point


         #Ctrlp:construct.c.ooef114
#         ON ACTION controlp INFIELD ooef114
            #add-point:ON ACTION controlp INFIELD ooef114
            {<point name="construct.c.ooef114" />}
            #END add-point

         #----<<ooef120>>----
         #此段落由子樣板a01產生
         BEFORE FIELD ooef120
            #add-point:BEFORE FIELD ooef120
            {<point name="construct.b.ooef120" />}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD ooef120

            #add-point:AFTER FIELD ooef120
            {<point name="construct.a.ooef120" />}
            #END add-point


         #Ctrlp:construct.c.ooef120
#         ON ACTION controlp INFIELD ooef120
            #add-point:ON ACTION controlp INFIELD ooef120
            {<point name="construct.c.ooef120" />}
            #END add-point

         #----<<ooef121>>----
         #此段落由子樣板a01產生
         BEFORE FIELD ooef121
            #add-point:BEFORE FIELD ooef121
            {<point name="construct.b.ooef121" />}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD ooef121

            #add-point:AFTER FIELD ooef121
            {<point name="construct.a.ooef121" />}
            #END add-point


         #Ctrlp:construct.c.ooef121
#         ON ACTION controlp INFIELD ooef121
            #add-point:ON ACTION controlp INFIELD ooef121
            {<point name="construct.c.ooef121" />}
            #END add-point

         #----<<ooef122>>----
         #此段落由子樣板a01產生
         BEFORE FIELD ooef122
            #add-point:BEFORE FIELD ooef122
            {<point name="construct.b.ooef122" />}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD ooef122

            #add-point:AFTER FIELD ooef122
            {<point name="construct.a.ooef122" />}
            #END add-point


         #Ctrlp:construct.c.ooef122
#         ON ACTION controlp INFIELD ooef122
            #add-point:ON ACTION controlp INFIELD ooef122
            {<point name="construct.c.ooef122" />}
            #END add-point

         #----<<ooef123>>----
         #Ctrlp:construct.c.ooef123
         ON ACTION controlp INFIELD ooef123
            #add-point:ON ACTION controlp INFIELD ooef123
            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_inaa001_6()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO ooef123  #顯示到畫面上

            NEXT FIELD ooef123                     #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a01產生
         BEFORE FIELD ooef123
            #add-point:BEFORE FIELD ooef123
            {<point name="construct.b.ooef123" />}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD ooef123

            #add-point:AFTER FIELD ooef123
            {<point name="construct.a.ooef123" />}
            #END add-point


         #----<<ooef124>>----
         #Ctrlp:construct.c.ooef124
         ON ACTION controlp INFIELD ooef124
            #add-point:ON ACTION controlp INFIELD ooef124
            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_inaa001_6()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO ooef124  #顯示到畫面上

            NEXT FIELD ooef124                     #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a01產生
         BEFORE FIELD ooef124
            #add-point:BEFORE FIELD ooef124
            {<point name="construct.b.ooef124" />}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD ooef124

            #add-point:AFTER FIELD ooef124
            {<point name="construct.a.ooef124" />}
            #END add-point


         #----<<ooef125>>----
         #Ctrlp:construct.c.ooef125
         ON ACTION controlp INFIELD ooef125
            #add-point:ON ACTION controlp INFIELD ooef125
            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_inaa001_6()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO ooef125  #顯示到畫面上

            NEXT FIELD ooef125                     #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a01產生
         BEFORE FIELD ooef125
            #add-point:BEFORE FIELD ooef125
            {<point name="construct.b.ooef125" />}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD ooef125

            #add-point:AFTER FIELD ooef125
            {<point name="construct.a.ooef125" />}
            #END add-point


         #----<<ooefownid>>----
         #Ctrlp:construct.c.ooefownid
         ON ACTION controlp INFIELD ooefownid
            #add-point:ON ACTION controlp INFIELD ooefownid
            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooag001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO ooefownid  #顯示到畫面上

            NEXT FIELD ooefownid                     #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a01產生
         BEFORE FIELD ooefownid
            #add-point:BEFORE FIELD ooefownid
            {<point name="construct.b.ooefownid" />}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD ooefownid

            #add-point:AFTER FIELD ooefownid
            {<point name="construct.a.ooefownid" />}
            #END add-point


         #----<<ooefowndp>>----
         #Ctrlp:construct.c.ooefowndp
         ON ACTION controlp INFIELD ooefowndp
            #add-point:ON ACTION controlp INFIELD ooefowndp
            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooea001_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO ooefowndp  #顯示到畫面上

            NEXT FIELD ooefowndp                     #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a01產生
         BEFORE FIELD ooefowndp
            #add-point:BEFORE FIELD ooefowndp
            {<point name="construct.b.ooefowndp" />}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD ooefowndp

            #add-point:AFTER FIELD ooefowndp
            {<point name="construct.a.ooefowndp" />}
            #END add-point


         #----<<ooefcrtid>>----
         #Ctrlp:construct.c.ooefcrtid
         ON ACTION controlp INFIELD ooefcrtid
            #add-point:ON ACTION controlp INFIELD ooefcrtid
            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooag001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO ooefcrtid  #顯示到畫面上

            NEXT FIELD ooefcrtid                     #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a01產生
         BEFORE FIELD ooefcrtid
            #add-point:BEFORE FIELD ooefcrtid
            {<point name="construct.b.ooefcrtid" />}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD ooefcrtid

            #add-point:AFTER FIELD ooefcrtid
            {<point name="construct.a.ooefcrtid" />}
            #END add-point


         #----<<ooefcrtdp>>----
         #Ctrlp:construct.c.ooefcrtdp
         ON ACTION controlp INFIELD ooefcrtdp
            #add-point:ON ACTION controlp INFIELD ooefcrtdp
            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooea001_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO ooefcrtdp  #顯示到畫面上

            NEXT FIELD ooefcrtdp                     #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a01產生
         BEFORE FIELD ooefcrtdp
            #add-point:BEFORE FIELD ooefcrtdp
            {<point name="construct.b.ooefcrtdp" />}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD ooefcrtdp

            #add-point:AFTER FIELD ooefcrtdp
            {<point name="construct.a.ooefcrtdp" />}
            #END add-point


         #----<<ooefcrtdt>>----
         #此段落由子樣板a01產生
         BEFORE FIELD ooefcrtdt
            #add-point:BEFORE FIELD ooefcrtdt
            {<point name="construct.b.ooefcrtdt" />}
            #END add-point

         #----<<ooefmodid>>----
         #Ctrlp:construct.c.ooefmodid
         ON ACTION controlp INFIELD ooefmodid
            #add-point:ON ACTION controlp INFIELD ooefmodid
            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooag001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO ooefmodid  #顯示到畫面上

            NEXT FIELD ooefmodid                     #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a01產生
         BEFORE FIELD ooefmodid
            #add-point:BEFORE FIELD ooefmodid
            {<point name="construct.b.ooefmodid" />}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD ooefmodid

            #add-point:AFTER FIELD ooefmodid
            {<point name="construct.a.ooefmodid" />}
            #END add-point


         #----<<ooefmoddt>>----
         #此段落由子樣板a01產生
         BEFORE FIELD ooefmoddt
            #add-point:BEFORE FIELD ooefmoddt
            {<point name="construct.b.ooefmoddt" />}
            #END add-point

         #----<<ooef014>>----
         #Ctrlp:construct.c.ooef014
         ON ACTION controlp INFIELD ooef014
            #add-point:ON ACTION controlp INFIELD ooef014
            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			   LET g_qryparam.arg1 = "10" #
            CALL q_ooal002_0()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO ooef014  #顯示到畫面上

            NEXT FIELD ooef014                     #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a01產生
         BEFORE FIELD ooef014
            #add-point:BEFORE FIELD ooef014
            {<point name="construct.b.ooef014" />}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD ooef014

            #add-point:AFTER FIELD ooef014
            {<point name="construct.a.ooef014" />}
            #END add-point


         #----<<ooef016>>----
         #Ctrlp:construct.c.ooef016
         ON ACTION controlp INFIELD ooef016
            #add-point:ON ACTION controlp INFIELD ooef016
            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			   LET g_qryparam.arg1 = g_site
            CALL q_ooaj002_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO ooef016  #顯示到畫面上

            NEXT FIELD ooef016                     #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a01產生
         BEFORE FIELD ooef016
            #add-point:BEFORE FIELD ooef016
            {<point name="construct.b.ooef016" />}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD ooef016

            #add-point:AFTER FIELD ooef016
            {<point name="construct.a.ooef016" />}
            #END add-point


         #----<<ooef004>>----
         #Ctrlp:construct.c.ooef004
         ON ACTION controlp INFIELD ooef004
            #add-point:ON ACTION controlp INFIELD ooef004
            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooef004()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO ooef004  #顯示到畫面上

            NEXT FIELD ooef004                     #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a01產生
         BEFORE FIELD ooef004
            #add-point:BEFORE FIELD ooef004
            {<point name="construct.b.ooef004" />}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD ooef004

            #add-point:AFTER FIELD ooef004
            {<point name="construct.a.ooef004" />}
            #END add-point


         #----<<ooef005>>----
         #此段落由子樣板a01產生
         BEFORE FIELD ooef005
            #add-point:BEFORE FIELD ooef005
            {<point name="construct.b.ooef005" />}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD ooef005

            #add-point:AFTER FIELD ooef005
            {<point name="construct.a.ooef005" />}
            #END add-point


         #Ctrlp:construct.c.ooef005
#         ON ACTION controlp INFIELD ooef005
            #add-point:ON ACTION controlp INFIELD ooef005
            {<point name="construct.c.ooef005" />}
            #END add-point

         #----<<ooef015>>----
         #Ctrlp:construct.c.ooef015
         ON ACTION controlp INFIELD ooef015
            #add-point:ON ACTION controlp INFIELD ooef015
            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooal002_3()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO ooef015  #顯示到畫面上

            NEXT FIELD ooef015                     #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a01產生
         BEFORE FIELD ooef015
            #add-point:BEFORE FIELD ooef015
            {<point name="construct.b.ooef015" />}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD ooef015

            #add-point:AFTER FIELD ooef015
            {<point name="construct.a.ooef015" />}
            #END add-point


         #----<<ooef006>>----
         #Ctrlp:construct.c.ooef006
         ON ACTION controlp INFIELD ooef006
            #add-point:ON ACTION controlp INFIELD ooef006
            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooef006()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO ooef006  #顯示到畫面上

            NEXT FIELD ooef006                     #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a01產生
         BEFORE FIELD ooef006
            #add-point:BEFORE FIELD ooef006
            {<point name="construct.b.ooef006" />}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD ooef006

            #add-point:AFTER FIELD ooef006
            {<point name="construct.a.ooef006" />}
            #END add-point


         #----<<ooef018>>----
         #Ctrlp:construct.c.ooef018
         ON ACTION controlp INFIELD ooef018
            #add-point:ON ACTION controlp INFIELD ooef018
            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_gzot001_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO ooef018  #顯示到畫面上

            NEXT FIELD ooef018                     #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a01產生
         BEFORE FIELD ooef018
            #add-point:BEFORE FIELD ooef018
            {<point name="construct.b.ooef018" />}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD ooef018

            #add-point:AFTER FIELD ooef018
            {<point name="construct.a.ooef018" />}
            #END add-point


         #----<<ooef019>>----
         #Ctrlp:construct.c.ooef019
         ON ACTION controlp INFIELD ooef019
            #add-point:ON ACTION controlp INFIELD ooef019
            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooal002_11()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO ooef019  #顯示到畫面上

            NEXT FIELD ooef019                     #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a01產生
         BEFORE FIELD ooef019
            #add-point:BEFORE FIELD ooef019
            {<point name="construct.b.ooef019" />}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD ooef019

            #add-point:AFTER FIELD ooef019
            {<point name="construct.a.ooef019" />}
            #END add-point


         #----<<ooef007>>----
         #此段落由子樣板a01產生
         BEFORE FIELD ooef007
            #add-point:BEFORE FIELD ooef007
            {<point name="construct.b.ooef007" />}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD ooef007

            #add-point:AFTER FIELD ooef007
            {<point name="construct.a.ooef007" />}
            #END add-point


         #Ctrlp:construct.c.ooef007
#         ON ACTION controlp INFIELD ooef007
            #add-point:ON ACTION controlp INFIELD ooef007
            {<point name="construct.c.ooef007" />}
            #END add-point

         #----<<ooef020>>----
         #此段落由子樣板a01產生
         BEFORE FIELD ooef020
            #add-point:BEFORE FIELD ooef020
            {<point name="construct.b.ooef020" />}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD ooef020

            #add-point:AFTER FIELD ooef020
            {<point name="construct.a.ooef020" />}
            #END add-point


         #Ctrlp:construct.c.ooef020
#         ON ACTION controlp INFIELD ooef020
            #add-point:ON ACTION controlp INFIELD ooef020
            {<point name="construct.c.ooef020" />}
            #END add-point

         #----<<ooef022>>----
         #此段落由子樣板a01產生
         BEFORE FIELD ooef022
            #add-point:BEFORE FIELD ooef022
            {<point name="construct.b.ooef022" />}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD ooef022

            #add-point:AFTER FIELD ooef022
            {<point name="construct.a.ooef022" />}
            #END add-point


         #Ctrlp:construct.c.ooef022
#         ON ACTION controlp INFIELD ooef022
            #add-point:ON ACTION controlp INFIELD ooef022
            {<point name="construct.c.ooef022" />}
            #END add-point

         #----<<ooef008>>----
         #Ctrlp:construct.c.ooef008
         ON ACTION controlp INFIELD ooef008
            #add-point:ON ACTION controlp INFIELD ooef008
            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooef008()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO ooef008  #顯示到畫面上

            NEXT FIELD ooef008                     #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a01產生
         BEFORE FIELD ooef008
            #add-point:BEFORE FIELD ooef008
            {<point name="construct.b.ooef008" />}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD ooef008

            #add-point:AFTER FIELD ooef008
            {<point name="construct.a.ooef008" />}
            #END add-point


         #----<<ooef010>>----
         #此段落由子樣板a01產生
         BEFORE FIELD ooef010
            #add-point:BEFORE FIELD ooef010
            {<point name="construct.b.ooef010" />}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD ooef010

            #add-point:AFTER FIELD ooef010
            {<point name="construct.a.ooef010" />}
            #END add-point


         #Ctrlp:construct.c.ooef010
#         ON ACTION controlp INFIELD ooef010
            #add-point:ON ACTION controlp INFIELD ooef010
            {<point name="construct.c.ooef010" />}
            #END add-point

         #----<<ooef011>>----
         #此段落由子樣板a01產生
         BEFORE FIELD ooef011
            #add-point:BEFORE FIELD ooef011
            {<point name="construct.b.ooef011" />}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD ooef011

            #add-point:AFTER FIELD ooef011
            {<point name="construct.a.ooef011" />}
            #END add-point


         #Ctrlp:construct.c.ooef011
#         ON ACTION controlp INFIELD ooef011
            #add-point:ON ACTION controlp INFIELD ooef011
            {<point name="construct.c.ooef011" />}
            #END add-point

         #----<<ooef013>>----
         #此段落由子樣板a01產生
         BEFORE FIELD ooef013
            #add-point:BEFORE FIELD ooef013
            {<point name="construct.b.ooef013" />}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD ooef013

            #add-point:AFTER FIELD ooef013
            {<point name="construct.a.ooef013" />}
            #END add-point


         #Ctrlp:construct.c.ooef013
#         ON ACTION controlp INFIELD ooef013
            #add-point:ON ACTION controlp INFIELD ooef013
            {<point name="construct.c.ooef013" />}
            #END add-point

         #----<<ooef023>>----
         #此段落由子樣板a01產生
         BEFORE FIELD ooef023
            #add-point:BEFORE FIELD ooef023
            {<point name="construct.b.ooef023" />}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD ooef023

            #add-point:AFTER FIELD ooef023
            {<point name="construct.a.ooef023" />}
            #END add-point


         #Ctrlp:construct.c.ooef023
#         ON ACTION controlp INFIELD ooef023
            #add-point:ON ACTION controlp INFIELD ooef023
            {<point name="construct.c.ooef023" />}
            #END add-point

         #----<<ooef024>>----
         #Ctrlp:construct.c.ooef024
         ON ACTION controlp INFIELD ooef024
            #add-point:ON ACTION controlp INFIELD ooef024
            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_pmaa001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO ooef024  #顯示到畫面上

            NEXT FIELD ooef024                     #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a01產生
         BEFORE FIELD ooef024
            #add-point:BEFORE FIELD ooef024
            {<point name="construct.b.ooef024" />}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD ooef024

            #add-point:AFTER FIELD ooef024
            {<point name="construct.a.ooef024" />}
            #END add-point

         #dongsz--add--str---
         ON ACTION controlp INFIELD ooef026
            #add-point:ON ACTION controlp INFIELD ooef026
            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			LET g_qryparam.arg1 = g_site
            CALL q_nmas002_3()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO ooef026  #顯示到畫面上

            NEXT FIELD ooef026                     #返回原欄位
         #dongsz--add--end---

         #----<<ooef150>>----
         #Ctrlp:construct.c.ooef150
         ON ACTION controlp INFIELD ooef150
            #add-point:ON ACTION controlp INFIELD ooef150
            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			   LET g_qryparam.arg1 = "2077" #
            CALL q_oocq002_4()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO ooef150  #顯示到畫面上

            NEXT FIELD ooef150                     #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a01產生
         BEFORE FIELD ooef150
            #add-point:BEFORE FIELD ooef150
            {<point name="construct.b.ooef150" />}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD ooef150

            #add-point:AFTER FIELD ooef150
            {<point name="construct.a.ooef150" />}
            #END add-point


         #----<<ooef151>>----
         #Ctrlp:construct.c.ooef151
         ON ACTION controlp INFIELD ooef151
            #add-point:ON ACTION controlp INFIELD ooef151
            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			   LET g_qryparam.arg1 = "2078" #
            CALL q_oocq002_4()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO ooef151  #顯示到畫面上

            NEXT FIELD ooef151                     #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a01產生
         BEFORE FIELD ooef151
            #add-point:BEFORE FIELD ooef151
            {<point name="construct.b.ooef151" />}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD ooef151

            #add-point:AFTER FIELD ooef151
            {<point name="construct.a.ooef151" />}
            #END add-point


         #----<<ooef152>>----
         #Ctrlp:construct.c.ooef152
         ON ACTION controlp INFIELD ooef152
            #add-point:ON ACTION controlp INFIELD ooef152
            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			   LET g_qryparam.arg1 = "2079" #
            CALL q_oocq002_4()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO ooef152  #顯示到畫面上

            NEXT FIELD ooef152                     #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a01產生
         BEFORE FIELD ooef152
            #add-point:BEFORE FIELD ooef152
            {<point name="construct.b.ooef152" />}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD ooef152

            #add-point:AFTER FIELD ooef152
            {<point name="construct.a.ooef152" />}
            #END add-point


         #----<<ooef153>>----
         #Ctrlp:construct.c.ooef153
         ON ACTION controlp INFIELD ooef153
            #add-point:ON ACTION controlp INFIELD ooef153
            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			   LET g_qryparam.arg1 = "2080" #
            CALL q_oocq002_4()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO ooef153  #顯示到畫面上

            NEXT FIELD ooef153                     #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a01產生
         BEFORE FIELD ooef153
            #add-point:BEFORE FIELD ooef153
            {<point name="construct.b.ooef153" />}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD ooef153

            #add-point:AFTER FIELD ooef153
            {<point name="construct.a.ooef153" />}
            #END add-point


         #----<<ooef154>>----
         #Ctrlp:construct.c.ooef154
         ON ACTION controlp INFIELD ooef154
            #add-point:ON ACTION controlp INFIELD ooef154
            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			   LET g_qryparam.arg1 = "2081" #
            CALL q_oocq002_4()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO ooef154  #顯示到畫面上

            NEXT FIELD ooef154                     #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a01產生
         BEFORE FIELD ooef154
            #add-point:BEFORE FIELD ooef154
            {<point name="construct.b.ooef154" />}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD ooef154

            #add-point:AFTER FIELD ooef154
            {<point name="construct.a.ooef154" />}
            #END add-point


         #----<<ooef155>>----
         #Ctrlp:construct.c.ooef155
         ON ACTION controlp INFIELD ooef155
            #add-point:ON ACTION controlp INFIELD ooef155
            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			   LET g_qryparam.arg1 = "2082" #
            CALL q_oocq002_4()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO ooef155  #顯示到畫面上

            NEXT FIELD ooef155                     #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a01產生
         BEFORE FIELD ooef155
            #add-point:BEFORE FIELD ooef155
            {<point name="construct.b.ooef155" />}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD ooef155

            #add-point:AFTER FIELD ooef155
            {<point name="construct.a.ooef155" />}
            #END add-point


         #----<<ooef156>>----
         #Ctrlp:construct.c.ooef156
         ON ACTION controlp INFIELD ooef156
            #add-point:ON ACTION controlp INFIELD ooef156
            #此段落由子樣板a08產生
            #開窗c段
			   INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			   LET g_qryparam.reqry = FALSE
			   CALL q_dbac001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO ooef156  #顯示到畫面上

            NEXT FIELD ooef156                     #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a01產生
         BEFORE FIELD ooef156
            #add-point:BEFORE FIELD ooef156
            {<point name="construct.b.ooef156" />}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD ooef156

            #add-point:AFTER FIELD ooef156
            {<point name="construct.a.ooef156" />}
            #END add-point


         #----<<ooef157>>----
         #Ctrlp:construct.c.ooef157
         ON ACTION controlp INFIELD ooef157
            #add-point:ON ACTION controlp INFIELD ooef157
            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			   LET g_qryparam.arg1 = "2084" #
            CALL q_oocq002_4()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO ooef157  #顯示到畫面上

            NEXT FIELD ooef157                     #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a01產生
         BEFORE FIELD ooef157
            #add-point:BEFORE FIELD ooef157
            {<point name="construct.b.ooef157" />}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD ooef157

            #add-point:AFTER FIELD ooef157
            {<point name="construct.a.ooef157" />}
            #END add-point


         #----<<ooef158>>----
         #Ctrlp:construct.c.ooef158
         ON ACTION controlp INFIELD ooef158
            #add-point:ON ACTION controlp INFIELD ooef158
            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			   LET g_qryparam.arg1 = "2085" #
            CALL q_oocq002_4()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO ooef158  #顯示到畫面上

            NEXT FIELD ooef158                     #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a01產生
         BEFORE FIELD ooef158
            #add-point:BEFORE FIELD ooef158
            {<point name="construct.b.ooef158" />}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD ooef158

            #add-point:AFTER FIELD ooef158
            {<point name="construct.a.ooef158" />}
            #END add-point


         #----<<ooef159>>----
         #Ctrlp:construct.c.ooef159
         ON ACTION controlp INFIELD ooef159
            #add-point:ON ACTION controlp INFIELD ooef159
            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			   LET g_qryparam.arg1 = "2086" #
            CALL q_oocq002_4()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO ooef159  #顯示到畫面上

            NEXT FIELD ooef159                     #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a01產生
         BEFORE FIELD ooef159
            #add-point:BEFORE FIELD ooef159
            {<point name="construct.b.ooef159" />}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD ooef159

            #add-point:AFTER FIELD ooef159
            {<point name="construct.a.ooef159" />}
            #END add-point


         #----<<ooef160>>----
         #Ctrlp:construct.c.ooef160
         ON ACTION controlp INFIELD ooef160
            #add-point:ON ACTION controlp INFIELD ooef160
            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			   LET g_qryparam.arg1 = "2087" #
            CALL q_oocq002_4()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO ooef160  #顯示到畫面上

            NEXT FIELD ooef160                     #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a01產生
         BEFORE FIELD ooef160
            #add-point:BEFORE FIELD ooef160
            {<point name="construct.b.ooef160" />}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD ooef160

            #add-point:AFTER FIELD ooef160
            {<point name="construct.a.ooef160" />}
            #END add-point


         #----<<ooef161>>----
         #Ctrlp:construct.c.ooef161
         ON ACTION controlp INFIELD ooef161
            #add-point:ON ACTION controlp INFIELD ooef161
            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			   LET g_qryparam.arg1 = "2088" #
            CALL q_oocq002_4()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO ooef161  #顯示到畫面上

            NEXT FIELD ooef161                     #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a01產生
         BEFORE FIELD ooef161
            #add-point:BEFORE FIELD ooef161
            {<point name="construct.b.ooef161" />}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD ooef161

            #add-point:AFTER FIELD ooef161
            {<point name="construct.a.ooef161" />}
            #END add-point


         #----<<ooef162>>----
         #Ctrlp:construct.c.ooef162
         ON ACTION controlp INFIELD ooef162
            #add-point:ON ACTION controlp INFIELD ooef162
            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			   LET g_qryparam.arg1 = "2089" #
            CALL q_oocq002_4()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO ooef162  #顯示到畫面上

            NEXT FIELD ooef162                     #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a01產生
         BEFORE FIELD ooef162
            #add-point:BEFORE FIELD ooef162
            {<point name="construct.b.ooef162" />}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD ooef162

            #add-point:AFTER FIELD ooef162
            {<point name="construct.a.ooef162" />}
            #END add-point


         #----<<ooef163>>----
         #Ctrlp:construct.c.ooef163
         ON ACTION controlp INFIELD ooef163
            #add-point:ON ACTION controlp INFIELD ooef163
            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			   LET g_qryparam.arg1 = "2090" #
            CALL q_oocq002_4()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO ooef163  #顯示到畫面上

            NEXT FIELD ooef163                     #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a01產生
         BEFORE FIELD ooef163
            #add-point:BEFORE FIELD ooef163
            {<point name="construct.b.ooef163" />}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD ooef163

            #add-point:AFTER FIELD ooef163
            {<point name="construct.a.ooef163" />}
            #END add-point


         #----<<ooef164>>----
         #Ctrlp:construct.c.ooef164
         ON ACTION controlp INFIELD ooef164
            #add-point:ON ACTION controlp INFIELD ooef164
            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			   LET g_qryparam.arg1 = "2091" #
            CALL q_oocq002_4()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO ooef164  #顯示到畫面上

            NEXT FIELD ooef164                     #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a01產生
         BEFORE FIELD ooef164
            #add-point:BEFORE FIELD ooef164
            {<point name="construct.b.ooef164" />}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD ooef164

            #add-point:AFTER FIELD ooef164
            {<point name="construct.a.ooef164" />}
            #END add-point


         #----<<ooef165>>----
         #Ctrlp:construct.c.ooef165
         ON ACTION controlp INFIELD ooef165
            #add-point:ON ACTION controlp INFIELD ooef165
            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			   LET g_qryparam.arg1 = "2092" #
            CALL q_oocq002_4()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO ooef165  #顯示到畫面上

            NEXT FIELD ooef165                     #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a01產生
         BEFORE FIELD ooef165
            #add-point:BEFORE FIELD ooef165
            {<point name="construct.b.ooef165" />}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD ooef165

            #add-point:AFTER FIELD ooef165
            {<point name="construct.a.ooef165" />}
            #END add-point


         #----<<ooef166>>----
         #Ctrlp:construct.c.ooef166
         ON ACTION controlp INFIELD ooef166
            #add-point:ON ACTION controlp INFIELD ooef166
            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			   LET g_qryparam.arg1 = "2093" #
            CALL q_oocq002_4()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO ooef166  #顯示到畫面上

            NEXT FIELD ooef166                     #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a01產生
         BEFORE FIELD ooef166
            #add-point:BEFORE FIELD ooef166
            {<point name="construct.b.ooef166" />}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD ooef166

            #add-point:AFTER FIELD ooef166
            {<point name="construct.a.ooef166" />}
            #END add-point


         #----<<ooef167>>----
         #Ctrlp:construct.c.ooef167
         ON ACTION controlp INFIELD ooef167
            #add-point:ON ACTION controlp INFIELD ooef167
            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			   LET g_qryparam.arg1 = "2094" #
            CALL q_oocq002_4()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO ooef167  #顯示到畫面上

            NEXT FIELD ooef167                     #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a01產生
         BEFORE FIELD ooef167
            #add-point:BEFORE FIELD ooef167
            {<point name="construct.b.ooef167" />}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD ooef167

            #add-point:AFTER FIELD ooef167
            {<point name="construct.a.ooef167" />}
            #END add-point


         #----<<ooef168>>----
         #Ctrlp:construct.c.ooef168
         ON ACTION controlp INFIELD ooef168
            #add-point:ON ACTION controlp INFIELD ooef168
            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			   LET g_qryparam.arg1 = "2095" #
            CALL q_oocq002_4()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO ooef168  #顯示到畫面上

            NEXT FIELD ooef168                     #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a01產生
         BEFORE FIELD ooef168
            #add-point:BEFORE FIELD ooef168
            {<point name="construct.b.ooef168" />}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD ooef168

            #add-point:AFTER FIELD ooef168
            {<point name="construct.a.ooef168" />}
            #END add-point


         #----<<ooef169>>----
         #Ctrlp:construct.c.ooef169
         ON ACTION controlp INFIELD ooef169
            #add-point:ON ACTION controlp INFIELD ooef169
            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			   LET g_qryparam.arg1 = "2096" #
            CALL q_oocq002_4()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO ooef169  #顯示到畫面上

            NEXT FIELD ooef169                     #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #此段落由子樣板a01產生
         BEFORE FIELD ooef169
            #add-point:BEFORE FIELD ooef169
            {<point name="construct.b.ooef169" />}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD ooef169

            #add-point:AFTER FIELD ooef169
            {<point name="construct.a.ooef169" />}
            #END add-point




      END CONSTRUCT
      
      SUBDIALOG aoo_aooi350_01.aooi350_01_construct
      SUBDIALOG aoo_aooi350_02.aooi350_02_construct
      
      BEFORE DIALOG
         CALL cl_qbe_init()
         
      ON ACTION accept
         ACCEPT DIALOG

      ON ACTION cancel
         LET INT_FLAG = 1
         EXIT DIALOG

      #add-point:cs段more_construct
      {<point name="cs.more_construct"/>}
      #end add-point

      #查詢CONSTRUCT共用ACTION
      &include "construct_action.4gl"

      #交談指令共用ACTION
      &include "common_action.4gl"
         CONTINUE DIALOG
   END DIALOG

   #add-point:cs段after_construct
   {<point name="cs.after_construct"/>}
   IF cl_null(g_wc2_i35001)  THEN
      LET g_wc2_i35001 = " 1=1"
   END IF

   IF cl_null(g_wc2_i35002)  THEN
      LET g_wc2_i35002 = " 1=1"
   END IF
   IF cl_null(g_wc) THEN
      LET g_wc = " 1=1"
   END IF
   
   LET g_wc = g_wc CLIPPED , " AND ooef304='Y' AND ",g_wc2_i35001 ," AND ",g_wc2_i35002
   #end add-point

   #LET g_wc = g_wc CLIPPED,cl_get_extra_cond("", "")

END FUNCTION]]>
  </point>
  <point name="function.arti100_filter" order="45" ver="3" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION arti100_filter()
   {<Local define>}
   {</Local define>}
   #add-point:filter段define
   {<point name="filter.define"/>}
   #end add-point

   LET INT_FLAG = 0

   LET g_qryparam.state = 'c'

   LET g_wc_filter_t = g_wc_filter
   LET g_wc_t = g_wc

   LET g_wc = cl_replace_str(g_wc, g_wc_filter, '')

   #使用DIALOG包住 單頭CONSTRUCT及單身CONSTRUCT
   DIALOG ATTRIBUTES(UNBUFFERED,FIELD ORDER FORM)

      #單頭
      CONSTRUCT g_wc_filter ON ooef001,ooef017,ooef101,ooef105,ooef102,ooef103,ooef104
                          FROM s_browse[1].b_ooef001,s_browse[1].b_ooef017,s_browse[1].b_ooef101,s_browse[1].b_ooef105,s_browse[1].b_ooef102,s_browse[1].b_ooef103,s_browse[1].b_ooef104

         BEFORE CONSTRUCT
            CALL cl_qbe_init()
               DISPLAY arti100_filter_parser('ooef001') TO s_browse[1].b_ooef001
            DISPLAY arti100_filter_parser('ooef017') TO s_browse[1].b_ooef017
            DISPLAY arti100_filter_parser('ooef101') TO s_browse[1].b_ooef101
            DISPLAY arti100_filter_parser('ooef105') TO s_browse[1].b_ooef105
            DISPLAY arti100_filter_parser('ooef102') TO s_browse[1].b_ooef102
            DISPLAY arti100_filter_parser('ooef103') TO s_browse[1].b_ooef103
            DISPLAY arti100_filter_parser('ooef104') TO s_browse[1].b_ooef104

      END CONSTRUCT

      #add-point:filter段add_cs
      {<point name="filter.add_cs"/>}
      SUBDIALOG aoo_aooi350_01.aooi350_01_construct
      SUBDIALOG aoo_aooi350_02.aooi350_02_construct
      #end add-point

      BEFORE DIALOG
         #add-point:filter段b_dialog
         {<point name="filter.b_dialog"/>}
         #end add-point

      ON ACTION accept
         ACCEPT DIALOG

      ON ACTION cancel
         LET INT_FLAG = 1
         EXIT DIALOG

      #交談指令共用ACTION
      &include "common_action.4gl"
         CONTINUE DIALOG

   END DIALOG

   IF NOT INT_FLAG THEN
      LET g_wc_filter = "   AND   ", g_wc_filter, "   "
      LET g_wc = g_wc , g_wc_filter
   ELSE
      LET g_wc_filter = g_wc_filter_t
      LET g_wc = g_wc_t
   END IF

END FUNCTION]]>
  </point>
  <point name="function.arti100_filter_parser" order="46" ver="3" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION arti100_filter_parser(ps_field)
   {<Local define>}
   DEFINE ps_field   STRING
   DEFINE ls_tmp     STRING
   DEFINE li_tmp     LIKE type_t.num5
   DEFINE li_tmp2    LIKE type_t.num5
   DEFINE ls_var     STRING
   {</Local define>}
   #add-point:filter段define
   {<point name="filter_parser.define"/>}
   #end add-point

   #一般條件解析
   LET ls_tmp = ps_field, "='"
   LET li_tmp = g_wc_filter.getIndexOf(ls_tmp,1)
   IF li_tmp > 0 THEN
      LET li_tmp = ls_tmp.getLength() + li_tmp
      LET li_tmp2 = g_wc_filter.getIndexOf("'",li_tmp + 1) - 1
      LET ls_var = g_wc_filter.subString(li_tmp,li_tmp2)
   END IF

   #模糊條件解析
   LET ls_tmp = ps_field, " like '"
   LET li_tmp = g_wc_filter.getIndexOf(ls_tmp,1)
   IF li_tmp > 0 THEN
      LET li_tmp = ls_tmp.getLength() + li_tmp
      LET li_tmp2 = g_wc_filter.getIndexOf("'",li_tmp + 1) - 1
      LET ls_var = g_wc_filter.subString(li_tmp,li_tmp2)
      LET ls_var = cl_replace_str(ls_var,'%','*')
   END IF

   RETURN ls_var

END FUNCTION]]>
  </point>
  <point name="function.arti100_query" order="47" ver="3" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION arti100_query()
   {<Local define>}
   DEFINE ls_wc STRING
   {</Local define>}
   #add-point:query段define
   {<point name="query.define"/>}
   #end add-point

   LET INT_FLAG = 0
   LET ls_wc = g_wc

   #切換畫面
   IF g_main_hidden THEN
      CALL gfrm_curr.setElementHidden("mainlayout",0)
      CALL gfrm_curr.setElementHidden("worksheet",1)
      LET g_main_hidden = 0
   END IF

   CALL g_browser.clear()

   IF g_worksheet_hidden THEN  #browser panel 單身折疊
      CALL gfrm_curr.setElementHidden("worksheet_vbox",0)
      CALL gfrm_curr.setElementImage("worksheethidden","worksheethidden-24.png")
      LET g_worksheet_hidden = 0
   END IF
   IF g_header_hidden THEN    #單頭折疊
      CALL gfrm_curr.setElementHidden("worksheet_detail",0)
      CALL gfrm_curr.setElementImage("controls","headerhidden-24")
      LET g_header_hidden = 0
   END IF

   INITIALIZE g_ooef_m.* TO NULL
   ERROR ""

   DISPLAY " " TO FORMONLY.b_count
   DISPLAY " " TO FORMONLY.h_count
   CALL arti100_construct()

   IF INT_FLAG THEN
      #取消查詢
      LET INT_FLAG = 0
      LET g_wc = ls_wc
      CALL arti100_browser_fill(g_wc,"F")
      CALL arti100_fetch("")
      RETURN
   ELSE
      LET g_current_row = 1
      LET g_current_cnt = 0
   END IF

   LET g_error_show = 1
   CALL arti100_browser_fill(g_wc,"F")   # 移到第一頁

   #備份搜尋條件
   LET ls_wc = g_wc

   #第一層模糊搜尋
   IF g_browser.getLength() = 0 THEN
      LET g_wc = cl_wc_parser(ls_wc)
      LET g_error_show = 1
      CALL arti100_browser_fill(g_wc,"F")
   END IF

   #第二層助記碼搜尋
   IF g_browser.getLength() = 0 THEN



      IF NOT cl_null(g_wc) THEN
         LET g_error_show = 1
         CALL arti100_browser_fill(g_wc,"F")
      END IF

   END IF

   IF g_browser.getLength() = 0 THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = "-100"
      LET g_errparam.extend = ""
      LET g_errparam.popup = TRUE
      CALL cl_err()

   ELSE
      CALL arti100_fetch("F")
   END IF

   LET g_wc_filter = ""

END FUNCTION]]>
  </point>
  <point name="function.arti100_fetch" order="48" ver="7" cite_std="N" new="Y" status="u" src="s" readonly="" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION arti100_fetch(p_fl)

   {<Local define>}
   DEFINE p_fl       LIKE type_t.chr1
   DEFINE ls_msg     STRING
   {</Local define>}

   #add-point:fetch段define
   {<point name="fetch.define"/>}
   #end add-point

   CASE p_fl
      WHEN "F" LET g_current_idx = 1
      WHEN "P"
         IF g_current_idx > 1 THEN
            LET g_current_idx = g_current_idx - 1
         END IF
      WHEN "N"
         IF g_current_idx < g_header_cnt THEN
            LET g_current_idx =  g_current_idx + 1
         END IF
      WHEN "L"
         LET g_current_idx = g_header_cnt
      WHEN "/"
         IF (NOT g_no_ask) THEN
            CALL cl_getmsg("fetch", g_lang) RETURNING ls_msg
            LET INT_FLAG = 0

            PROMPT ls_msg CLIPPED,": " FOR g_jump
               #交談指令共用ACTION
               &include "common_action.4gl"
            END PROMPT

            IF INT_FLAG THEN
               LET INT_FLAG = 0
               EXIT CASE
            END IF
         END IF
         IF g_jump > 0 THEN
            LET g_current_idx = g_jump
         END IF
         LET g_no_ask = FALSE
   END CASE

   LET g_browser_cnt = g_browser.getLength()

   #瀏覽頁筆數顯示
   LET g_browser_idx = g_pagestart+g_current_idx-1
   DISPLAY g_browser_idx TO FORMONLY.b_index        #當下筆數
   DISPLAY g_browser_cnt TO FORMONLY.b_count        #總筆數
   DISPLAY g_browser_idx TO FORMONLY.h_index        #當下筆數
   DISPLAY g_browser_cnt TO FORMONLY.h_count        #總筆數
   CALL ui.Interface.refresh()

   #單頭筆數顯示
   #DISPLAY g_browser_idx TO FORMONLY.idx            #當下筆數
   #DISPLAY g_browser_cnt TO FORMONLY.cnt            #總筆數

   #該樣板不需此段落IF g_browser[g_current_idx].b_expcode <> "1" THEN
   #該樣板不需此段落   INITIALIZE g_ooef_m.* TO NULL
   #該樣板不需此段落   DISPLAY BY NAME g_ooef_m.*
   #該樣板不需此段落   CALL cl_set_act_visible("statechange,modify,delete,reproduce", FALSE)
   #該樣板不需此段落   RETURN
   #該樣板不需此段落ELSE
   #該樣板不需此段落   CALL cl_set_act_visible("statechange,modify,delete,reproduce", TRUE)
   #該樣板不需此段落END IF

   #該樣板不需此段落CALL arti100_browser_fill(g_wc,p_fl)

   IF g_current_idx > g_browser.getLength() THEN
      LET g_current_idx = g_browser.getLength()
   END IF

   # 設定browse索引
   CALL g_curr_diag.setCurrentRow("s_browse", g_current_idx)

   CALL cl_navigator_setting(g_browser_idx, g_current_cnt)
   #該樣板不需此段落CALL cl_navigator_setting(g_browser_idx, g_browser_cnt )

   #代表沒有資料, 無需做後續資料撈取之動作
   IF g_current_idx = 0 THEN
      RETURN
   END IF

   LET g_ooef_m.ooef001 = g_browser[g_current_idx].b_ooef001


   #重讀DB,因TEMP有不被更新特性
    SELECT UNIQUE ooefunit,ooef001,ooef003,ooef017,ooef101,ooef105,ooef102,ooef103,ooef100,ooefstus,ooef104,ooef106,ooef108,ooef107,ooef109,ooef110,ooef115,ooef116,ooef111,ooef112,ooef113,ooef114,ooef120,ooef121,ooef122,ooef123,ooef124,ooef125,ooefownid,ooefowndp,ooefcrtid,ooefcrtdp,ooefcrtdt,ooefmodid,ooefmoddt,ooef014,ooef016,ooef004,ooef005,ooef015,ooef006,ooef018,ooef019,ooef007,ooef020,ooef022,ooef008,ooef010,ooef011,ooef013,ooef023,ooef024,ooef026,ooef150,ooef151,ooef152,ooef153,ooef154,ooef155,ooef156,ooef157,ooef158,ooef159,ooef160,ooef161,ooef162,ooef163,ooef164,ooef165,ooef166,ooef167,ooef168,ooef169,ooef012
 INTO g_ooef_m.ooefunit,g_ooef_m.ooef001,g_ooef_m.ooef003,g_ooef_m.ooef017,g_ooef_m.ooef101,g_ooef_m.ooef105,g_ooef_m.ooef102,g_ooef_m.ooef103,g_ooef_m.ooef100,g_ooef_m.ooefstus,g_ooef_m.ooef104,g_ooef_m.ooef106,g_ooef_m.ooef108,g_ooef_m.ooef107,g_ooef_m.ooef109,g_ooef_m.ooef110,g_ooef_m.ooef115,g_ooef_m.ooef116,g_ooef_m.ooef111,g_ooef_m.ooef112,g_ooef_m.ooef113,g_ooef_m.ooef114,g_ooef_m.ooef120,g_ooef_m.ooef121,g_ooef_m.ooef122,g_ooef_m.ooef123,g_ooef_m.ooef124,g_ooef_m.ooef125,g_ooef_m.ooefownid,g_ooef_m.ooefowndp,g_ooef_m.ooefcrtid,g_ooef_m.ooefcrtdp,g_ooef_m.ooefcrtdt,g_ooef_m.ooefmodid,g_ooef_m.ooefmoddt,g_ooef_m.ooef014,g_ooef_m.ooef016,g_ooef_m.ooef004,g_ooef_m.ooef005,g_ooef_m.ooef015,g_ooef_m.ooef006,g_ooef_m.ooef018,g_ooef_m.ooef019,g_ooef_m.ooef007,g_ooef_m.ooef020,g_ooef_m.ooef022,g_ooef_m.ooef008,g_ooef_m.ooef010,g_ooef_m.ooef011,g_ooef_m.ooef013,g_ooef_m.ooef023,g_ooef_m.ooef024,g_ooef_m.ooef026,g_ooef_m.ooef150,g_ooef_m.ooef151,g_ooef_m.ooef152,g_ooef_m.ooef153,g_ooef_m.ooef154,g_ooef_m.ooef155,g_ooef_m.ooef156,g_ooef_m.ooef157,g_ooef_m.ooef158,g_ooef_m.ooef159,g_ooef_m.ooef160,g_ooef_m.ooef161,g_ooef_m.ooef162,g_ooef_m.ooef163,g_ooef_m.ooef164,g_ooef_m.ooef165,g_ooef_m.ooef166,g_ooef_m.ooef167,g_ooef_m.ooef168,g_ooef_m.ooef169,g_ooef_m.ooef012
 FROM ooef_t
 WHERE ooefent = g_enterprise AND ooef001 = g_ooef_m.ooef001
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "ooef_t"
      LET g_errparam.popup = FALSE
      CALL cl_err()

      INITIALIZE g_ooef_m.* TO NULL
      RETURN
   END IF
  #150424-00018#3 15/06/17 by s983961--mark(s) 統一寫入function內
  # #若無資料則關閉相關功能
  # IF g_browser_cnt = 0 THEN
  #    CALL cl_set_act_visible("statechange,modify,delete,reproduce", FALSE)
  # ELSE
  #    CALL cl_set_act_visible("statechange,modify,delete,reproduce", TRUE)
  #150424-00018#3 15/06/17 by s983961--mark(e) 統一寫入function內 
  # END IF
  #150424-00018#3 150529 by s983961 add(s)  aoos010走申請流程控管
  CALL arti100_set_act_visible()
  CALL arti100_set_act_no_visible() 
  #150424-00018#3 150529 by s983961 add(e)  aoos010走申請流程控管 
   #add-point:fetch段action控制
   {<point name="fetch.action_control"/>}
   #150424-00018#3 15/06/17 by s983961--mark(s) 統一寫入function內
   #CALL cl_set_act_visible("delete", TRUE)
   #IF g_ooef_m.ooefstus <> 'Y' THEN
   #   CALL cl_set_act_visible("delete", FALSE)
   #ELSE
   #   CALL cl_set_act_visible("delete", TRUE)   
   #END IF
   #150424-00018#3 15/06/17 by s983961--mark(e) 統一寫入function內
   #150424-00018#3 150529 by s983961 add(s)  aoos010走申請流程控管
   CALL arti100_set_act_visible()
   CALL arti100_set_act_no_visible() 
   #150424-00018#3 150529 by s983961 add(e)  aoos010走申請流程控管
   #end add-point

   LET g_ooef_m_t.* = g_ooef_m.*
   LET g_ooef_m_o.* = g_ooef_m.*
   #重新顯示
   CALL arti100_show()

END FUNCTION]]>
  </point>
  <point name="function.arti100_insert" order="49" ver="6" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION arti100_insert()
   #add-point:insert段define
   {<point name="insert.define"/>}
   DEFINE l_insert      LIKE type_t.num5
   #end add-point

   CLEAR FORM                    #清畫面欄位內容

   INITIALIZE g_ooef_m.* LIKE ooef_t.*             #DEFAULT 設定
   LET g_ooef001_t = NULL


   CALL s_transaction_begin()

   WHILE TRUE
      #六階樹狀給值

      #該樣板不需此段落LET g_current_idx = g_curr_diag.getCurrentRow("s_browse")
      #該樣板不需此段落IF g_current_idx > 0 THEN
         #該樣板不需此段落IF NOT cl_null(g_browser[g_current_idx].b_show) THEN
            #該樣板不需此段落LET  = g_browser[g_current_idx].b_ooef001
            #該樣板不需此段落#LET  = g_browser[g_current_idx].b_
            #該樣板不需此段落#LET  = g_browser[g_current_idx].b_
            #該樣板不需此段落#LET  = g_browser[g_current_idx].b_
            #該樣板不需此段落#LET  = g_browser[g_current_idx].b_
            #該樣板不需此段落#LET  = g_browser[g_current_idx].b_
         #該樣板不需此段落END IF
      #該樣板不需此段落END IF

      #公用欄位給值
      #此段落由子樣板a14產生
      LET g_ooef_m.ooefownid = g_user
      LET g_ooef_m.ooefowndp = g_dept
      LET g_ooef_m.ooefcrtid = g_user
      LET g_ooef_m.ooefcrtdp = g_dept
      LET g_ooef_m.ooefcrtdt = cl_get_current()
      LET g_ooef_m.ooefmodid = ""
      LET g_ooef_m.ooefmoddt = ""
      #LET g_ooef_m.ooefstus = ""



      #append欄位給值


      #一般欄位給值
            LET g_ooef_m.ooef101 = "4"
      LET g_ooef_m.ooef102 = "1"
      LET g_ooef_m.ooef103 = "1"
      LET g_ooef_m.ooef100 = "1"
      LET g_ooef_m.ooef115 = "Y"
      LET g_ooef_m.ooef010 = "1"
      LET g_ooef_m.ooef011 = "0"
      LET g_ooef_m.ooef023 = "1"


      #add-point:單頭預設值
      INITIALIZE g_ooef_m_t.* TO NULL
      INITIALIZE g_ooef_m_o.* TO NULL
#      LET g_ooef_m.ooefunit = g_site
      LET g_site_flag = FALSE
      CALL s_aooi500_default(g_prog,'ooefunit',g_ooef_m.ooefunit)
         RETURNING l_insert,g_ooef_m.ooefunit
      IF NOT l_insert THEN
         RETURN
      END IF
      call arti100_ooefunit_ref()
      LET g_ooef_m.ooefstus = "Y"
      LET g_ooef_m.ooef003 = "N"
      #先給預設語言別 简体    # add by geza 201504030
      LET g_ooef_m.ooef116 = "zh_CN" 
      LET g_ooef_m_t.* = g_ooef_m.*          {#ADP版次:1#}
      
      CALL aooi350_01_clear_detail()
      CALL aooi350_02_clear_detail()
      #end add-point

      CALL arti100_input("a")

      #add-point:單頭輸入後
      {<point name="insert.after_insert"/>}
      #end add-point

      IF INT_FLAG THEN
         LET INT_FLAG = 0
         LET g_ooef_m.* = g_ooef_m_t.*
         CALL arti100_show()
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = 9001
         LET g_errparam.extend = ""
         LET g_errparam.popup = FALSE
         CALL cl_err()

         EXIT WHILE
      END IF

      LET g_rec_b = 0
      EXIT WHILE
   END WHILE

   LET g_ooef001_t = g_ooef_m.ooef001


   LET g_state = "Y"

   LET g_wc = g_wc,
              " OR ( ooefent = '" ||g_enterprise|| "' AND",
              " ooef001 = '", g_ooef_m.ooef001 CLIPPED, "' "

              , ") "

END FUNCTION]]>
  </point>
  <point name="function.arti100_modify" order="50" ver="3" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION arti100_modify()
   #add-point:modify段define
   {<point name="modify.define"/>}
   #end add-point

   IF g_ooef_m.ooef001 IS NULL

   THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = "std-00003"
      LET g_errparam.extend = ""
      LET g_errparam.popup = FALSE
      CALL cl_err()

      RETURN
   END IF

    SELECT UNIQUE ooefunit,ooef001,ooef003,ooef017,ooef101,ooef105,ooef102,ooef103,ooef100,ooefstus,ooef104,ooef106,ooef108,ooef109,ooef110,ooef115,ooef111,ooef112,ooef113,ooef114,ooef120,ooef121,ooef122,ooef123,ooef124,ooef125,ooefownid,ooefowndp,ooefcrtid,ooefcrtdp,ooefcrtdt,ooefmodid,ooefmoddt,ooef014,ooef016,ooef004,ooef005,ooef015,ooef006,ooef018,ooef019,ooef007,ooef020,ooef022,ooef008,ooef010,ooef011,ooef013,ooef023,ooef024,ooef026,ooef150,ooef151,ooef152,ooef153,ooef154,ooef155,ooef156,ooef157,ooef158,ooef159,ooef160,ooef161,ooef162,ooef163,ooef164,ooef165,ooef166,ooef167,ooef168,ooef169
 INTO g_ooef_m.ooefunit,g_ooef_m.ooef001,g_ooef_m.ooef003,g_ooef_m.ooef017,g_ooef_m.ooef101,g_ooef_m.ooef105,g_ooef_m.ooef102,g_ooef_m.ooef103,g_ooef_m.ooef100,g_ooef_m.ooefstus,g_ooef_m.ooef104,g_ooef_m.ooef106,g_ooef_m.ooef108,g_ooef_m.ooef109,g_ooef_m.ooef110,g_ooef_m.ooef115,g_ooef_m.ooef111,g_ooef_m.ooef112,g_ooef_m.ooef113,g_ooef_m.ooef114,g_ooef_m.ooef120,g_ooef_m.ooef121,g_ooef_m.ooef122,g_ooef_m.ooef123,g_ooef_m.ooef124,g_ooef_m.ooef125,g_ooef_m.ooefownid,g_ooef_m.ooefowndp,g_ooef_m.ooefcrtid,g_ooef_m.ooefcrtdp,g_ooef_m.ooefcrtdt,g_ooef_m.ooefmodid,g_ooef_m.ooefmoddt,g_ooef_m.ooef014,g_ooef_m.ooef016,g_ooef_m.ooef004,g_ooef_m.ooef005,g_ooef_m.ooef015,g_ooef_m.ooef006,g_ooef_m.ooef018,g_ooef_m.ooef019,g_ooef_m.ooef007,g_ooef_m.ooef020,g_ooef_m.ooef022,g_ooef_m.ooef008,g_ooef_m.ooef010,g_ooef_m.ooef011,g_ooef_m.ooef013,g_ooef_m.ooef023,g_ooef_m.ooef024,g_ooef_m.ooef026,g_ooef_m.ooef150,g_ooef_m.ooef151,g_ooef_m.ooef152,g_ooef_m.ooef153,g_ooef_m.ooef154,g_ooef_m.ooef155,g_ooef_m.ooef156,g_ooef_m.ooef157,g_ooef_m.ooef158,g_ooef_m.ooef159,g_ooef_m.ooef160,g_ooef_m.ooef161,g_ooef_m.ooef162,g_ooef_m.ooef163,g_ooef_m.ooef164,g_ooef_m.ooef165,g_ooef_m.ooef166,g_ooef_m.ooef167,g_ooef_m.ooef168,g_ooef_m.ooef169
 FROM ooef_t
 WHERE ooefent = g_enterprise AND ooef001 = g_ooef_m.ooef001

   ERROR ""

   LET g_ooef001_t = g_ooef_m.ooef001


   CALL s_transaction_begin()

   OPEN arti100_cl USING g_enterprise,g_ooef_m.ooef001
   IF STATUS THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code =  STATUS
      LET g_errparam.extend = "OPEN arti100_cl:"
      LET g_errparam.popup = TRUE
      CALL cl_err()

      CLOSE arti100_cl
      CALL s_transaction_end('N','0')
      RETURN
   END IF

   #鎖住將被更改或取消的資料
   FETCH arti100_cl INTO g_ooef_m.ooefunit,g_ooef_m.ooefunit_desc,g_ooef_m.ooef001,g_ooef_m.ooef001_desc,g_ooef_m.ooef003,g_ooef_m.ooef017,g_ooef_m.ooef017_desc,g_ooef_m.ooef101,g_ooef_m.ooed005,g_ooef_m.ooed005_desc,g_ooef_m.ooef105,g_ooef_m.ooef105_desc,g_ooef_m.ooef102,g_ooef_m.ooef103,g_ooef_m.ooef100,g_ooef_m.ooefstus,g_ooef_m.ooef104,g_ooef_m.ooef104_desc,g_ooef_m.ooef106,g_ooef_m.ooef106_desc,g_ooef_m.ooef108,g_ooef_m.ooef108_desc,g_ooef_m.ooef107,g_ooef_m.ooef109,g_ooef_m.ooef110,g_ooef_m.ooef115,g_ooef_m.ooef111,g_ooef_m.ooef112,g_ooef_m.ooef113,g_ooef_m.ooef114,g_ooef_m.ooef120,g_ooef_m.ooef121,g_ooef_m.ooef122,g_ooef_m.ooef123,g_ooef_m.ooef123_desc,g_ooef_m.ooef124,g_ooef_m.ooef124_desc,g_ooef_m.ooef125,g_ooef_m.ooef125_desc,g_ooef_m.ooefownid,g_ooef_m.ooefownid_desc,g_ooef_m.ooefowndp,g_ooef_m.ooefowndp_desc,g_ooef_m.ooefcrtid,g_ooef_m.ooefcrtid_desc,g_ooef_m.ooefcrtdp,g_ooef_m.ooefcrtdp_desc,g_ooef_m.ooefcrtdt,g_ooef_m.ooefmodid,g_ooef_m.ooefmodid_desc,g_ooef_m.ooefmoddt,g_ooef_m.ooef014,g_ooef_m.ooef014_desc,g_ooef_m.ooef016,g_ooef_m.ooef016_desc,g_ooef_m.ooef004,g_ooef_m.ooef004_desc,g_ooef_m.ooef005,g_ooef_m.ooef015,g_ooef_m.ooef015_desc,g_ooef_m.ooef006,g_ooef_m.ooef006_desc,g_ooef_m.ooef018,g_ooef_m.ooef018_desc,g_ooef_m.ooef019,g_ooef_m.ooef019_desc,g_ooef_m.ooef007,g_ooef_m.ooef020,g_ooef_m.ooef022,g_ooef_m.ooef008,g_ooef_m.ooef008_desc,g_ooef_m.ooef010,g_ooef_m.ooef010_desc,g_ooef_m.ooef011,g_ooef_m.ooef013,g_ooef_m.ooef023,g_ooef_m.ooef024,g_ooef_m.ooef024_desc,g_ooef_m.ooef026,g_ooef_m.ooef026_desc,g_ooef_m.ooef150,g_ooef_m.ooef150_desc,g_ooef_m.ooef151,g_ooef_m.ooef151_desc,g_ooef_m.ooef152,g_ooef_m.ooef152_desc,g_ooef_m.ooef153,g_ooef_m.ooef153_desc,g_ooef_m.ooef154,g_ooef_m.ooef154_desc,g_ooef_m.ooef155,g_ooef_m.ooef155_desc,g_ooef_m.ooef156,g_ooef_m.ooef156_desc,g_ooef_m.ooef157,g_ooef_m.ooef157_desc,g_ooef_m.ooef158,g_ooef_m.ooef158_desc,g_ooef_m.ooef159,g_ooef_m.ooef159_desc,g_ooef_m.ooef160,g_ooef_m.ooef160_desc,g_ooef_m.ooef161,g_ooef_m.ooef161_desc,g_ooef_m.ooef162,g_ooef_m.ooef162_desc,g_ooef_m.ooef163,g_ooef_m.ooef163_desc,g_ooef_m.ooef164,g_ooef_m.ooef164_desc,g_ooef_m.ooef165,g_ooef_m.ooef165_desc,g_ooef_m.ooef166,g_ooef_m.ooef166_desc,g_ooef_m.ooef167,g_ooef_m.ooef167_desc,g_ooef_m.ooef168,g_ooef_m.ooef168_desc,g_ooef_m.ooef169,g_ooef_m.ooef169_desc

   #資料被他人LOCK, 或是sql執行時出現錯誤
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "ooef_t"
      LET g_errparam.popup = FALSE
      CALL cl_err()

      CLOSE arti100_cl
      CALL s_transaction_end('N','0')
      RETURN
   END IF



   CALL arti100_show()

   WHILE TRUE
      LET g_ooef_m.ooef001 = g_ooef001_t


      #寫入修改者/修改日期資訊
      LET g_ooef_m.ooefmodid = g_user
LET g_ooef_m.ooefmoddt = cl_get_current()


      #add-point:modify段修改前
      {<point name="modify.before_input"/>}
      LET g_ooef_m_t.* = g_ooef_m.*
      LET g_ooef_m_o.* = g_ooef_m.*
      #end add-point

      CALL arti100_input("u")     #欄位更改

      #add-point:modify段修改後
      {<point name="modify.after_input"/>}
      #end add-point

      IF INT_FLAG THEN
         LET INT_FLAG = 0
         LET g_ooef_m.* = g_ooef_m_t.*
         CALL arti100_show()
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = 9001
         LET g_errparam.extend = ""
         LET g_errparam.popup = FALSE
         CALL cl_err()

         EXIT WHILE
      END IF

      EXIT WHILE

   END WHILE

   #修改歷程記錄
   IF NOT cl_log_modified_record(g_ooef_m.ooef001,g_site) THEN
      CALL s_transaction_end('N','0')
   END IF

   CLOSE arti100_cl
   CALL s_transaction_end('Y','0')

   #流程通知預埋點-U
   CALL cl_flow_notify(g_ooef_m.ooef001,"U")

   LET g_worksheet_hidden = 0

END FUNCTION]]>
  </point>
  <point name="function.arti100_input" order="51" ver="5" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION arti100_input(p_cmd)
   {<Local define>}
   DEFINE p_cmd           LIKE type_t.chr1
   DEFINE l_ac_t          LIKE type_t.num5        #未取消的ARRAY CNT
   DEFINE l_n             LIKE type_t.num5        #檢查重複用
   DEFINE l_cnt           LIKE type_t.num5        #檢查重複用
   DEFINE l_lock_sw       LIKE type_t.chr1        #單身鎖住否
   DEFINE l_allow_insert  LIKE type_t.num5        #可新增否
   DEFINE l_allow_delete  LIKE type_t.num5        #可刪除否
   DEFINE l_count         LIKE type_t.num5
   DEFINE l_i             LIKE type_t.num5
   DEFINE l_insert        LIKE type_t.num5
   DEFINE ls_return       STRING
   DEFINE l_var_keys      DYNAMIC ARRAY OF STRING
   DEFINE l_var_keys_bak  DYNAMIC ARRAY OF STRING
   DEFINE l_field_keys    DYNAMIC ARRAY OF STRING
   DEFINE l_vars          DYNAMIC ARRAY OF STRING
   DEFINE l_fields        DYNAMIC ARRAY OF STRING
   {</Local define>}
   #add-point:input段define
   DEFINE l_ooea003       LIKE ooea_t.ooea003          {#ADP版次:1#}
   DEFINE l_success       LIKE type_t.num5
   DEFINE l_len           LIKE type_t.num5
   DEFINE l_len1          LIKE type_t.num5
   DEFINE l_ooef005       STRING
   DEFINE l_errno         LIKE type_t.chr10
   #end add-point

   #切換畫面
   IF g_main_hidden THEN
      CALL gfrm_curr.setElementHidden("mainlayout",0)
      CALL gfrm_curr.setElementHidden("worksheet",1)
      LET g_main_hidden = 0
   END IF
   #該樣板不需此段落CALL gfrm_curr.setElementHidden("mainlayout",0)
   #該樣板不需此段落CALL gfrm_curr.setElementImage("mainhidden","small/arr-u.png")
   #該樣板不需此段落LET g_main_hidden = 1

   CALL cl_set_head_visible("","YES")

   IF p_cmd = 'r' THEN
      #此段落的r動作等同於a
      LET p_cmd = 'a'
   END IF

   LET l_insert = FALSE
   LET g_action_choice = ""

   LET g_qryparam.state = "i"

   #控制key欄位可否輸入
   CALL arti100_set_entry(p_cmd)
   #add-point:set_entry後
   {<point name="input.after_set_entry"/>}
   #end add-point
   CALL arti100_set_no_entry(p_cmd)
   #add-point:資料輸入前
   {<point name="input.before_input"/>}
   LET g_errshow=1
   LET l_allow_insert = cl_auth_detail_input("insert")
   LET l_allow_delete = cl_auth_detail_input("delete")
   LET g_detail_insert = l_allow_insert
   LET g_detail_delete = l_allow_delete
   #end add-point

   DISPLAY BY NAME g_ooef_m.ooefunit,g_ooef_m.ooef001,g_ooef_m.ooefl003,g_ooef_m.ooefl004,g_ooef_m.ooefl006,g_ooef_m.ooefl005,g_ooef_m.ooef003,g_ooef_m.ooef017,g_ooef_m.ooef101,g_ooef_m.ooed005,g_ooef_m.ooef105,g_ooef_m.ooef102,g_ooef_m.ooef103,g_ooef_m.ooef100,g_ooef_m.ooefstus,g_ooef_m.ooef104,g_ooef_m.ooef106,g_ooef_m.ooef108,g_ooef_m.ooef107,g_ooef_m.ooef109,g_ooef_m.ooef110,g_ooef_m.ooef115,g_ooef_m.ooef111,g_ooef_m.ooef112,g_ooef_m.ooef113,g_ooef_m.ooef114,g_ooef_m.ooef120,g_ooef_m.ooef121,g_ooef_m.ooef122,g_ooef_m.ooef123,g_ooef_m.ooef124,g_ooef_m.ooef125,g_ooef_m.ooef014,g_ooef_m.ooef016,g_ooef_m.ooef004,g_ooef_m.ooef005,g_ooef_m.ooef015,g_ooef_m.ooef006,g_ooef_m.ooef018,g_ooef_m.ooef019,g_ooef_m.ooef007,g_ooef_m.ooef020,g_ooef_m.ooef022,g_ooef_m.ooef008,g_ooef_m.ooef010,g_ooef_m.ooef011,g_ooef_m.ooef013,g_ooef_m.ooef023,g_ooef_m.ooef024,g_ooef_m.ooef026,g_ooef_m.ooef150,g_ooef_m.ooef151,g_ooef_m.ooef152,g_ooef_m.ooef153,g_ooef_m.ooef154,g_ooef_m.ooef155,g_ooef_m.ooef156,g_ooef_m.ooef157,g_ooef_m.ooef158,g_ooef_m.ooef159,g_ooef_m.ooef160,g_ooef_m.ooef161,g_ooef_m.ooef162,g_ooef_m.ooef163,g_ooef_m.ooef164,g_ooef_m.ooef165,g_ooef_m.ooef166,g_ooef_m.ooef167,g_ooef_m.ooef168,g_ooef_m.ooef169

   DIALOG ATTRIBUTES(UNBUFFERED,FIELD ORDER FORM)

      #單頭段
      INPUT BY NAME g_ooef_m.ooefunit,g_ooef_m.ooef001,g_ooef_m.ooefl003,g_ooef_m.ooefl004,g_ooef_m.ooefl006,g_ooef_m.ooefl005,g_ooef_m.ooef003,g_ooef_m.ooef017,g_ooef_m.ooef101,g_ooef_m.ooed005,g_ooef_m.ooef105,g_ooef_m.ooef102,g_ooef_m.ooef103,g_ooef_m.ooef100,g_ooef_m.ooefstus,g_ooef_m.ooef104,g_ooef_m.ooef106,g_ooef_m.ooef108,g_ooef_m.ooef107,g_ooef_m.ooef109,g_ooef_m.ooef110,g_ooef_m.ooef115,g_ooef_m.ooef116,g_ooef_m.ooef111,g_ooef_m.ooef112,g_ooef_m.ooef113,g_ooef_m.ooef114,g_ooef_m.ooef120,g_ooef_m.ooef121,g_ooef_m.ooef122,g_ooef_m.ooef123,g_ooef_m.ooef124,g_ooef_m.ooef125,g_ooef_m.ooef014,g_ooef_m.ooef016,g_ooef_m.ooef004,g_ooef_m.ooef005,g_ooef_m.ooef015,g_ooef_m.ooef006,g_ooef_m.ooef018,g_ooef_m.ooef019,g_ooef_m.ooef007,g_ooef_m.ooef020,g_ooef_m.ooef022,g_ooef_m.ooef008,g_ooef_m.ooef010,g_ooef_m.ooef011,g_ooef_m.ooef013,g_ooef_m.ooef023,g_ooef_m.ooef024,g_ooef_m.ooef026,g_ooef_m.ooef150,g_ooef_m.ooef151,g_ooef_m.ooef152,g_ooef_m.ooef153,g_ooef_m.ooef154,g_ooef_m.ooef155,g_ooef_m.ooef156,g_ooef_m.ooef157,g_ooef_m.ooef158,g_ooef_m.ooef159,g_ooef_m.ooef160,g_ooef_m.ooef161,g_ooef_m.ooef162,g_ooef_m.ooef163,g_ooef_m.ooef164,g_ooef_m.ooef165,g_ooef_m.ooef166,g_ooef_m.ooef167,g_ooef_m.ooef168,g_ooef_m.ooef169
         ATTRIBUTE(WITHOUT DEFAULTS)

         #自訂ACTION(master_input)
         #+ 此段落由子樣板a43產生
         ON ACTION update_item
            LET g_action_choice="update_item"
            IF cl_auth_chk_act("update_item") THEN
               
               #add-point:ON ACTION update_item
               IF NOT cl_null(g_ooef_m.ooef001) THEN
                  CALL n_ooefl(g_ooef_m.ooef001)
                  INITIALIZE g_ref_fields TO NULL
                  LET g_ref_fields[1] = g_ooef_m.ooef001
                  CALL ap_ref_array2(g_ref_fields," SELECT ooefl003,ooefl004,ooefl005 FROM ooefl_t WHERE ooeflent = '" 
                      ||g_enterprise||"' AND ooefl001 = ? AND ooefl002 = '"||g_dlang||"'","") RETURNING g_rtn_fields
                  LET g_ooef_m.ooefl003 = g_rtn_fields[1]
                  LET g_ooef_m.ooefl004 = g_rtn_fields[2]
                  LET g_ooef_m.ooefl005 = g_rtn_fields[3]
                  LET g_ooef_m.ooefl006 = g_ooef_m.ooefl004
                  DISPLAY BY NAME g_ooef_m.ooefl003,g_ooef_m.ooefl004,
                                  g_ooef_m.ooefl005,g_ooef_m.ooefl006
               END IF
               #END add-point
            END IF

         BEFORE INPUT
            IF s_transaction_chk("N",0) THEN
               CALL s_transaction_begin()
            END IF
            #其他table資料備份(確定是否更改用)
            LET g_master_multi_table_t.ooefl001 = g_ooef_m.ooef001
LET g_master_multi_table_t.ooefl003 = g_ooef_m.ooefl003
LET g_master_multi_table_t.ooefl004 = g_ooef_m.ooefl004
LET g_master_multi_table_t.ooefl006 = g_ooef_m.ooefl004
LET g_master_multi_table_t.ooefl005 = g_ooef_m.ooefl005 
            #add-point:input開始前
            {<point name="input.before.input"/>}
            IF NOT cl_null(g_ooef_m.ooef001) THEN
               LET l_n = 0
               SELECT COUNT(*) INTO l_n FROM ooef_t WHERE ooefent = g_enterprise AND ooef001 = g_ooef_m.ooef001
               IF l_n > 0 AND p_cmd = 'a' THEN
                  LET p_cmd = 'u'
                  LET g_ooef001_t = g_ooef_m.ooef001
               END IF
               CALL arti100_upd_ooef156()
            END IF
            
            CALL arti100_set_entry(p_cmd)
            CALL arti100_set_no_entry(p_cmd)
            #end add-point

         #---------------------------<  Master  >---------------------------
         #----<<ooefunit>>----
         #此段落由子樣板a02產生
         AFTER FIELD ooefunit

            #add-point:AFTER FIELD ooefunit
          {#ADP版次:1#}
            LET g_ooef_m.ooefunit_desc = null
            DISPLAY BY NAME g_ooef_m.ooefunit_desc
            IF NOT cl_null(g_ooef_m.ooefunit) THEN
               IF p_cmd = 'a' OR ( p_cmd = 'u' AND (g_ooef_m.ooefunit != g_ooef_m_t.ooefunit or g_ooef_m_t.ooefunit is null )) THEN
                  CALL s_aooi500_chk(g_prog,'ooefunit',g_ooef_m.ooefunit,g_ooef_m.ooefunit) RETURNING l_success,l_errno
                  IF NOT l_success THEN
                     INITIALIZE g_errparam TO NULL
                     LET g_errparam.extend = g_ooef_m.ooefunit
                     LET g_errparam.code   = l_errno
                     LET g_errparam.popup  = TRUE
                     CALL cl_err()
                  
                     LET g_ooef_m.ooefunit = g_ooef_m_t.ooefunit
                     CALL arti100_ooefunit_ref()
                     NEXT FIELD CURRENT
                  END IF

                  LET g_site_flag = TRUE
                  CALL arti100_set_entry(p_cmd)
                  CALL arti100_set_no_entry(p_cmd)
               END IF                
            END IF
            #END add-point


         #此段落由子樣板a01產生
         BEFORE FIELD ooefunit
            #add-point:BEFORE FIELD ooefunit
            {<point name="input.b.ooefunit" />}
            #END add-point

         #此段落由子樣板a04產生
         ON CHANGE ooefunit
            #add-point:ON CHANGE ooefunit
            {<point name="input.g.ooefunit" />}
            #END add-point

         #----<<ooef001>>----
         #此段落由子樣板a02產生
         AFTER FIELD ooef001

            #add-point:AFTER FIELD ooef001
            #此段落由子樣板a05產生
            LET g_ooef_m.ooef001_desc = null
            DISPLAY BY NAME g_ooef_m.ooef001_desc
            IF NOT cl_null(g_ooef_m.ooef001) THEN
               IF p_cmd = 'a' OR ( p_cmd = 'u' AND (g_ooef_m.ooef001 != g_ooef001_t )) THEN
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM ooef_t WHERE "||"ooefent = '" ||g_enterprise|| "' AND "||"ooef001 = '"||g_ooef_m.ooef001 ||"'",'std-00004',0) THEN
                     let g_ooef_m.ooef001 = g_ooef_m_t.ooef001
                     call arti100_ooef001_ref()
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            call arti100_ooef001_ref()
          {#ADP版次:1#}
            #END add-point


         #此段落由子樣板a01產生
         BEFORE FIELD ooef001
            #add-point:BEFORE FIELD ooef001
            {<point name="input.b.ooef001" />}
            #END add-point

         #此段落由子樣板a04產生
         ON CHANGE ooef001
            #add-point:ON CHANGE ooef001
            {<point name="input.g.ooef001" />}
            #END add-point

         #----<<ooef017>>----
         AFTER FIELD ooefl004
            LET g_ooef_m.ooefl006 = g_ooef_m.ooefl004
         ON CHANGE ooefl004
            LET g_ooef_m.ooefl006 = g_ooef_m.ooefl004
         #此段落由子樣板a02產生
         ON CHANGE ooef003
            CALL arti100_set_entry(p_cmd)
            CALL arti100_set_no_entry(p_cmd)
            CALL arti100_chk_ooef003()
            IF NOT cl_null(g_errno) THEN
               INITIALIZE g_errparam TO NULL
               LET g_errparam.code = g_errno
               LET g_errparam.extend = ""
               LET g_errparam.popup = TRUE
               CALL cl_err()
               LET g_ooef_m.ooef003 = g_ooef_m_t.ooef003
               NEXT FIELD ooef003
            END IF
            IF g_ooef_m.ooef003 = 'N' THEN 
               LET g_ooef_m.ooef022 = NULL
               DISPLAY BY NAME g_ooef_m.ooef022
               CALL arti100_ooef017_empty()
            END IF
            
         AFTER FIELD ooef003
            IF NOT cl_null(g_ooef_m.ooef003) THEN
               IF p_cmd = 'a' OR ( p_cmd = 'u' AND (g_ooef_m.ooef003 != g_ooef_m_t.ooef003 OR g_ooef_m_t.ooef003 IS NULL )) THEN
                  CALL arti100_chk_ooef003()
                  IF NOT cl_null(g_errno) THEN
                     INITIALIZE g_errparam TO NULL
                     LET g_errparam.code = g_errno
                     LET g_errparam.extend = ""
                     LET g_errparam.popup = TRUE
                     CALL cl_err()
                     LET g_ooef_m.ooef003 = g_ooef_m_t.ooef003
                     NEXT FIELD ooef003
                  END IF
                  IF g_ooef_m.ooef003 = 'Y' THEN 
                     LET  g_ooef_m.ooef017 = g_ooef_m.ooef001
                      LET g_ooef_m_o.ooef017 = g_ooef_m.ooef017
                     DISPLAY BY NAME g_ooef_m.ooef017
                  END IF 
               END IF
            END IF
            IF g_ooef_m.ooef003 = 'N' THEN 
               LET g_ooef_m.ooef022 = NULL
               DISPLAY BY NAME g_ooef_m.ooef022
            END IF
            CALL arti100_set_entry(p_cmd)
            CALL arti100_set_no_entry(p_cmd)             
         AFTER FIELD ooef017

            #add-point:AFTER FIELD ooef017
            CALL arti100_ooef017() RETURNING l_success
            LET g_ooef_m.ooef017_desc = null
            DISPLAY BY NAME g_ooef_m.ooef017_desc
            IF NOT cl_null(g_ooef_m.ooef017) THEN
               IF p_cmd = 'a' OR ( p_cmd = 'u' AND (g_ooef_m.ooef017 != g_ooef_m_t.ooef017 or g_ooef_m_t.ooef017 is null )) THEN
                  #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
                  INITIALIZE g_chkparam.* TO NULL

                  #設定g_chkparam.*的參數
                  LET g_chkparam.arg1 = g_ooef_m.ooef017
                  #呼叫檢查存在並帶值的library
                  IF cl_chk_exist("v_ooef001_1") THEN
 
                  ELSE
                     #檢查失敗時後續處理
                     LET g_ooef_m.ooef017 = g_ooef_m_t.ooef017
                     CALL arti100_ooef017_ref()
                     NEXT FIELD CURRENT
                  END IF
                  
                     
               END IF
                
            END IF
            IF g_ooef_m.ooef003 = 'N' AND (NOT cl_null(g_ooef_m.ooef017)) THEN
               IF (p_cmd = 'a' AND cl_null(g_ooef_m_o.ooef017)) OR ((NOT cl_null(g_ooef_m_o.ooef017) AND g_ooef_m_o.ooef017 != g_ooef_m.ooef017) or g_ooef_m_o.ooef017 is null) THEN
                  CALL arti100_ooef017_default()
               END IF
            END IF      
            LET g_ooef_m_o.ooef017 = g_ooef_m.ooef017
            CALL arti100_ooef017() RETURNING l_success
#            IF NOT l_success THEN
#               IF cl_null(g_ooef_m.ooef017) THEN
#                  INITIALIZE g_errparam TO NULL
#                  LET g_errparam.code = "acr-00015"
#                  LET g_errparam.extend = ""
#                  LET g_errparam.popup = FALSE
#                  CALL cl_err()
#                  NEXT FIELD ooef017
#               END IF
#            END IF
            CALL arti100_ooef017_ref()
          {#ADP版次:1#}
            #END add-point


         #此段落由子樣板a01產生
         BEFORE FIELD ooef017
            #add-point:BEFORE FIELD ooef017
            {<point name="input.b.ooef017" />}
            #END add-point

         #此段落由子樣板a04產生
         ON CHANGE ooef017
            #add-point:ON CHANGE ooef017
            {<point name="input.g.ooef017" />}
            #END add-point

         #----<<ooef101>>----
         #此段落由子樣板a01產生
         BEFORE FIELD ooef101
            #add-point:BEFORE FIELD ooef101
            {<point name="input.b.ooef101" />}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD ooef101

            #add-point:AFTER FIELD ooef101
            {<point name="input.a.ooef101" />}
            #END add-point


         #此段落由子樣板a04產生
         ON CHANGE ooef101
            #add-point:ON CHANGE ooef101
            {<point name="input.g.ooef101" />}
            #END add-point

         #----<<ooed005>>----
         #此段落由子樣板a02產生
         AFTER FIELD ooed005

            #add-point:AFTER FIELD ooed005
          {#ADP版次:1#}
            #END add-point


         #此段落由子樣板a01產生
         BEFORE FIELD ooed005
            #add-point:BEFORE FIELD ooed005
            {<point name="input.b.ooed005" />}
            #END add-point

         #此段落由子樣板a04產生
         ON CHANGE ooed005
            #add-point:ON CHANGE ooed005
            {<point name="input.g.ooed005" />}
            #END add-point

         #----<<ooef105>>----
         #此段落由子樣板a02產生
         AFTER FIELD ooef105

            #add-point:AFTER FIELD ooef105
            LET g_ooef_m.ooef105_desc =null
            DISPLAY BY NAME g_ooef_m.ooef105_desc
            IF NOT cl_null(g_ooef_m.ooef105) THEN
               IF p_cmd = 'a' OR ( p_cmd = 'u' AND (g_ooef_m.ooef105 != g_ooef_m_t.ooef105 OR g_ooef_m_t.ooef105 IS NULL )) THEN
#                  #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
#                  INITIALIZE g_chkparam.* TO NULL
#
#                  #設定g_chkparam.*的參數
#                  LET g_chkparam.arg1 = g_ooef_m.ooef105
#
#                  #呼叫檢查存在並帶值的library
#                  IF cl_chk_exist("v_ooef001_35") THEN
#                  #檢查成功時後續處理
#                  #LET  = g_chkparam.return1
#                  #DISPLAY BY NAME
#
#                  ELSE
#                  #檢查失敗時後續處理
#                     LET g_ooef_m.ooef105 = g_ooef_m_t.ooef105
#                     CALL arti100_ooef105_ref()
#                     NEXT FIELD CURRENT
#                  END IF
                  
                  IF s_aooi500_setpoint(g_prog,'ooef105') THEN
                     CALL s_aooi500_chk(g_prog,'ooef105',g_ooef_m.ooef105,g_ooef_m.ooefunit) RETURNING l_success,l_errno
                     IF NOT l_success THEN
                        INITIALIZE g_errparam TO NULL
                        LET g_errparam.extend = g_ooef_m.ooef105
                        LET g_errparam.code   = l_errno
                        LET g_errparam.popup  = TRUE
                        CALL cl_err()
                     
                        LET g_ooef_m.ooef105 = g_ooef_m_t.ooef105
                        CALL arti100_ooef105_ref()
                        NEXT FIELD CURRENT
                     END IF
                  ELSE
                     #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
                     INITIALIZE g_chkparam.* TO NULL
                     
                     #設定g_chkparam.*的參數
                     LET g_chkparam.arg1 = g_ooef_m.ooef105
                     
                     #呼叫檢查存在並帶值的library
                     IF cl_chk_exist("v_ooef001_35") THEN
                     #檢查成功時後續處理
                     #LET  = g_chkparam.return1
                     #DISPLAY BY NAME
                     
                     ELSE
                     #檢查失敗時後續處理
                        LET g_ooef_m.ooef105 = g_ooef_m_t.ooef105
                        CALL arti100_ooef105_ref()
                        NEXT FIELD CURRENT
                     END IF
                  END IF
               END IF

            END IF
            CALL arti100_ooef105_ref()
          {#ADP版次:1#}
            #END add-point


         #此段落由子樣板a01產生
         BEFORE FIELD ooef105
            #add-point:BEFORE FIELD ooef105
            {<point name="input.b.ooef105" />}
            #END add-point

         #此段落由子樣板a04產生
         ON CHANGE ooef105
            #add-point:ON CHANGE ooef105
            {<point name="input.g.ooef105" />}
            #END add-point

         #----<<ooef102>>----
         #此段落由子樣板a01產生
         BEFORE FIELD ooef102
            #add-point:BEFORE FIELD ooef102
            {<point name="input.b.ooef102" />}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD ooef102

            #add-point:AFTER FIELD ooef102
            {<point name="input.a.ooef102" />}
            #END add-point


         #此段落由子樣板a04產生
         ON CHANGE ooef102
            #add-point:ON CHANGE ooef102
            {<point name="input.g.ooef102" />}
            #END add-point

         #----<<ooef103>>----
         #此段落由子樣板a01產生
         BEFORE FIELD ooef103
            #add-point:BEFORE FIELD ooef103
            {<point name="input.b.ooef103" />}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD ooef103

            #add-point:AFTER FIELD ooef103
            {<point name="input.a.ooef103" />}
            #END add-point


         #此段落由子樣板a04產生
         ON CHANGE ooef103
            #add-point:ON CHANGE ooef103
            {<point name="input.g.ooef103" />}
            #END add-point

         #----<<ooef100>>----
         #此段落由子樣板a01產生
         BEFORE FIELD ooef100
            #add-point:BEFORE FIELD ooef100
            {<point name="input.b.ooef100" />}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD ooef100

            #add-point:AFTER FIELD ooef100
            {<point name="input.a.ooef100" />}
            #END add-point


         #此段落由子樣板a04產生
         ON CHANGE ooef100
            #add-point:ON CHANGE ooef100
            {<point name="input.g.ooef100" />}
            #END add-point

         #----<<ooefstus>>----
         #此段落由子樣板a01產生
         BEFORE FIELD ooefstus
            #add-point:BEFORE FIELD ooefstus
            {<point name="input.b.ooefstus" />}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD ooefstus

            #add-point:AFTER FIELD ooefstus
            {<point name="input.a.ooefstus" />}
            #END add-point


         #此段落由子樣板a04產生
         ON CHANGE ooefstus
            #add-point:ON CHANGE ooefstus
            {<point name="input.g.ooefstus" />}
            #END add-point

         #----<<ooef104>>----
         #此段落由子樣板a02產生
         AFTER FIELD ooef104

            #add-point:AFTER FIELD ooef104
            LET g_ooef_m.ooef104_desc = NULL
            DISPLAY BY NAME g_ooef_m.ooef104_desc
            IF NOT cl_null(g_ooef_m.ooef104) THEN
               IF p_cmd = 'a' OR ( p_cmd = 'u' AND (g_ooef_m.ooef104 != g_ooef_m_t.ooef104 OR g_ooef_m_t.ooef104 IS NULL )) THEN 
                  #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
                  INITIALIZE g_chkparam.* TO NULL

                  #設定g_chkparam.*的參數
                  LET g_chkparam.arg1 = g_ooef_m.ooef104


                  #呼叫檢查存在並帶值的library
                  IF NOT s_azzi650_chk_exist('2076', g_ooef_m.ooef104) THEN
                     LET g_ooef_m.ooef104 = g_ooef_m_t.ooef104
                     CALL arti100_ooef104_ref()
                     NEXT FIELD CURRENT
                  END IF
               END IF

            END IF
            CALL arti100_ooef104_ref()
          {#ADP版次:1#}
            #END add-point


         #此段落由子樣板a01產生
         BEFORE FIELD ooef104
            #add-point:BEFORE FIELD ooef104
            {<point name="input.b.ooef104" />}
            #END add-point

         #此段落由子樣板a04產生
         ON CHANGE ooef104
            #add-point:ON CHANGE ooef104
            {<point name="input.g.ooef104" />}
            #END add-point

         #----<<ooef106>>----
         #此段落由子樣板a02產生
         AFTER FIELD ooef106

            #add-point:AFTER FIELD ooef106
            LET g_ooef_m.ooef106_desc = NULL
            DISPLAY BY NAME g_ooef_m.ooef106_desc
            IF NOT cl_null(g_ooef_m.ooef106) THEN
               IF p_cmd = 'a' OR ( p_cmd = 'u' AND (g_ooef_m.ooef106 != g_ooef_m_t.ooef106 OR g_ooef_m_t.ooef106 IS NULL )) THEN
                  #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
                  INITIALIZE g_chkparam.* TO NULL

                  #設定g_chkparam.*的參數
                  LET g_chkparam.arg1 = g_ooef_m.ooef106

                  #呼叫檢查存在並帶值的library
                  IF cl_chk_exist("v_ooef001_35") THEN
                     #檢查成功時後續處理
                     #LET  = g_chkparam.return1
                     #DISPLAY BY NAME

                  ELSE
                     #檢查失敗時後續處理
                     LET g_ooef_m.ooef106 = g_ooef_m_t.ooef106
                     CALL arti100_ooef106_ref()
                     NEXT FIELD CURRENT
                  END IF
                  
                  IF s_aooi500_setpoint(g_prog,'ooef106') THEN
                     CALL s_aooi500_chk(g_prog,'ooef106',g_ooef_m.ooef106,g_ooef_m.ooefunit) RETURNING l_success,l_errno
                     IF NOT l_success THEN
                        INITIALIZE g_errparam TO NULL
                        LET g_errparam.extend = g_ooef_m.ooef106
                        LET g_errparam.code   = l_errno
                        LET g_errparam.popup  = TRUE
                        CALL cl_err()
                     
                        LET g_ooef_m.ooef106 = g_ooef_m_t.ooef106
                        CALL arti100_ooef106_ref()
                        NEXT FIELD CURRENT
                     END IF
                  ELSE
                     #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
                     INITIALIZE g_chkparam.* TO NULL
                     
                     #設定g_chkparam.*的參數
                     LET g_chkparam.arg1 = g_ooef_m.ooef106
                     
                     #呼叫檢查存在並帶值的library
                     IF cl_chk_exist("v_ooef001_35") THEN
                        #檢查成功時後續處理
                        #LET  = g_chkparam.return1
                        #DISPLAY BY NAME
                     
                     ELSE
                        #檢查失敗時後續處理
                        LET g_ooef_m.ooef106 = g_ooef_m_t.ooef106
                        CALL arti100_ooef106_ref()
                        NEXT FIELD CURRENT
                     END IF
                  END IF

               END IF
            END IF
            CALL arti100_ooef106_ref()
          {#ADP版次:1#}
            #END add-point


         #此段落由子樣板a01產生
         BEFORE FIELD ooef106
            #add-point:BEFORE FIELD ooef106
            {<point name="input.b.ooef106" />}
            #END add-point

         #此段落由子樣板a04產生
         ON CHANGE ooef106
            #add-point:ON CHANGE ooef106
            {<point name="input.g.ooef106" />}
            #END add-point

         #----<<ooef108>>----
         #此段落由子樣板a02產生
         AFTER FIELD ooef108

            #add-point:AFTER FIELD ooef108
            LET g_ooef_m.ooef108_desc = NULL
            DISPLAY BY NAME g_ooef_m.ooef108_desc
            IF NOT cl_null(g_ooef_m.ooef108) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_ooef_m.ooef108 != g_ooef_m_t.ooef108 OR
                                                   g_ooef_m_t.ooef108 IS NULL)) THEN 
               CALL arti100_chk_ooef108()
               IF NOT cl_null(g_errno) THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = g_errno
                  LET g_errparam.extend = g_ooef_m.ooef108
                  LET g_errparam.popup = TRUE
                  CALL cl_err()

                  LET g_ooef_m.ooef108 = g_ooef_m_t.ooef108
                  CALL arti100_ooef108_ref()
                  NEXT FIELD CURRENT
               END IF
               end if

            END IF
            CALL arti100_ooef108_ref()
          {#ADP版次:1#}
            #END add-point


         #此段落由子樣板a01產生
         BEFORE FIELD ooef108
            #add-point:BEFORE FIELD ooef108
            {<point name="input.b.ooef108" />}
            #END add-point

         #此段落由子樣板a04產生
         ON CHANGE ooef108
            #add-point:ON CHANGE ooef108
            {<point name="input.g.ooef108" />}
            #END add-point

         #----<<date>>----
         #此段落由子樣板a01產生
         BEFORE FIELD ooef107
            #add-point:BEFORE FIELD date
            {<point name="input.b.date" />}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD ooef107

            #add-point:AFTER FIELD date
            {<point name="input.a.date" />}
            #END add-point


         #此段落由子樣板a04產生
         ON CHANGE ooef107
            #add-point:ON CHANGE date
            {<point name="input.g.date" />}
            #END add-point

         #----<<ooef109>>----
         #此段落由子樣板a01產生
         BEFORE FIELD ooef109
            #add-point:BEFORE FIELD ooef109
            {<point name="input.b.ooef109" />}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD ooef109

            #add-point:AFTER FIELD ooef109
            {<point name="input.a.ooef109" />}
            #END add-point


         #此段落由子樣板a04產生
         ON CHANGE ooef109
            #add-point:ON CHANGE ooef109
            {<point name="input.g.ooef109" />}
            #END add-point

         #----<<ooef110>>----
         #此段落由子樣板a01產生
         BEFORE FIELD ooef110
            #add-point:BEFORE FIELD ooef110
            {<point name="input.b.ooef110" />}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD ooef110

            #add-point:AFTER FIELD ooef110
            {<point name="input.a.ooef110" />}
            #END add-point


         #此段落由子樣板a04產生
         ON CHANGE ooef110
            #add-point:ON CHANGE ooef110
            {<point name="input.g.ooef110" />}
            #END add-point

         #----<<ooef115>>----
         #此段落由子樣板a01產生
         BEFORE FIELD ooef115
            #add-point:BEFORE FIELD ooef115
            {<point name="input.b.ooef115" />}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD ooef115

            #add-point:AFTER FIELD ooef115
            {<point name="input.a.ooef115" />}
            #END add-point


         #此段落由子樣板a04產生
         ON CHANGE ooef115
            #add-point:ON CHANGE ooef115
            {<point name="input.g.ooef115" />}
            #END add-point

         #----<<ooef111>>----
         #此段落由子樣板a02產生
         AFTER FIELD ooef111
            #此段落由子樣板a15產生
            IF NOT cl_ap_chk_Range(g_ooef_m.ooef111,"0","0","","","azz-00079",1) THEN
               LET g_ooef_m.ooef111 = g_ooef_m_t.ooef111
               NEXT FIELD ooef111
            END IF


            #add-point:AFTER FIELD ooef111
            IF NOT cl_null(g_ooef_m.ooef111) THEN
            END IF
          {#ADP版次:1#}
            #END add-point


         #此段落由子樣板a01產生
         BEFORE FIELD ooef111
            #add-point:BEFORE FIELD ooef111
            {<point name="input.b.ooef111" />}
            #END add-point

         #此段落由子樣板a04產生
         ON CHANGE ooef111
            #add-point:ON CHANGE ooef111
            {<point name="input.g.ooef111" />}
            #END add-point

         #----<<ooef112>>----
         #此段落由子樣板a02產生
         AFTER FIELD ooef112
            #此段落由子樣板a15產生
            IF NOT cl_ap_chk_Range(g_ooef_m.ooef112,"0","0","","","azz-00079",1) THEN
               LET g_ooef_m.ooef112 = g_ooef_m_t.ooef112
               NEXT FIELD ooef112
            END IF


            #add-point:AFTER FIELD ooef112
            IF NOT cl_null(g_ooef_m.ooef112) THEN
            END IF
          {#ADP版次:1#}
            #END add-point


         #此段落由子樣板a01產生
         BEFORE FIELD ooef112
            #add-point:BEFORE FIELD ooef112
            {<point name="input.b.ooef112" />}
            #END add-point

         #此段落由子樣板a04產生
         ON CHANGE ooef112
            #add-point:ON CHANGE ooef112
            {<point name="input.g.ooef112" />}
            #END add-point

         #----<<ooef113>>----
         #此段落由子樣板a02產生
         AFTER FIELD ooef113
            #此段落由子樣板a15產生
            IF NOT cl_ap_chk_Range(g_ooef_m.ooef113,"0","0","","","azz-00079",1) THEN
               LET g_ooef_m.ooef113 = g_ooef_m_t.ooef113
               NEXT FIELD ooef113
            END IF


            #add-point:AFTER FIELD ooef113
            IF NOT cl_null(g_ooef_m.ooef113) THEN
            END IF
          {#ADP版次:1#}
            #END add-point


         #此段落由子樣板a01產生
         BEFORE FIELD ooef113
            #add-point:BEFORE FIELD ooef113
            {<point name="input.b.ooef113" />}
            #END add-point

         #此段落由子樣板a04產生
         ON CHANGE ooef113
            #add-point:ON CHANGE ooef113
            {<point name="input.g.ooef113" />}
            #END add-point

         #----<<ooef114>>----
         #此段落由子樣板a01產生
         BEFORE FIELD ooef114
            #add-point:BEFORE FIELD ooef114
            {<point name="input.b.ooef114" />}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD ooef114

            #add-point:AFTER FIELD ooef114
            {<point name="input.a.ooef114" />}
            IF NOT cl_ap_chk_Range(g_ooef_m.ooef114,"0","0","","","azz-00079",1) THEN
               LET g_ooef_m.ooef114 = g_ooef_m_t.ooef114
               NEXT FIELD ooef114
            END IF
            #END add-point


         #此段落由子樣板a04產生
         ON CHANGE ooef114
            #add-point:ON CHANGE ooef114
            {<point name="input.g.ooef114" />}
            #END add-point

         #----<<ooef120>>----
         #此段落由子樣板a02產生
         AFTER FIELD ooef120
            #此段落由子樣板a15產生
            IF NOT cl_ap_chk_Range(g_ooef_m.ooef120,"0.000","1","","","azz-00079",1) THEN
               LET g_ooef_m.ooef120 = g_ooef_m_t.ooef120
               NEXT FIELD ooef120
            END IF


            #add-point:AFTER FIELD ooef120
            IF NOT cl_null(g_ooef_m.ooef120) THEN
            END IF
          {#ADP版次:1#}
            #END add-point


         #此段落由子樣板a01產生
         BEFORE FIELD ooef120
            #add-point:BEFORE FIELD ooef120
            {<point name="input.b.ooef120" />}
            #END add-point

         #此段落由子樣板a04產生
         ON CHANGE ooef120
            #add-point:ON CHANGE ooef120
            {<point name="input.g.ooef120" />}
            #END add-point

         #----<<ooef121>>----
         #此段落由子樣板a02產生
         AFTER FIELD ooef121
            #此段落由子樣板a15產生
            IF NOT cl_ap_chk_Range(g_ooef_m.ooef121,"0.000","1","","","azz-00079",1) THEN
               LET g_ooef_m.ooef121 = g_ooef_m_t.ooef121
               NEXT FIELD ooef121
            END IF


            #add-point:AFTER FIELD ooef121
            IF NOT cl_null(g_ooef_m.ooef121) THEN
            END IF
          {#ADP版次:1#}
            #END add-point


         #此段落由子樣板a01產生
         BEFORE FIELD ooef121
            #add-point:BEFORE FIELD ooef121
            {<point name="input.b.ooef121" />}
            #END add-point

         #此段落由子樣板a04產生
         ON CHANGE ooef121
            #add-point:ON CHANGE ooef121
            {<point name="input.g.ooef121" />}
            #END add-point

         #----<<ooef122>>----
         #此段落由子樣板a02產生
         AFTER FIELD ooef122
            #此段落由子樣板a15產生
            IF NOT cl_ap_chk_Range(g_ooef_m.ooef122,"0.000","1","","","azz-00079",1) THEN
               LET g_ooef_m.ooef122 = g_ooef_m_t.ooef122
               NEXT FIELD ooef122
            END IF


            #add-point:AFTER FIELD ooef122
            IF NOT cl_null(g_ooef_m.ooef122) THEN
            END IF
          {#ADP版次:1#}
            #END add-point


         #此段落由子樣板a01產生
         BEFORE FIELD ooef122
            #add-point:BEFORE FIELD ooef122
            {<point name="input.b.ooef122" />}
            #END add-point

         #此段落由子樣板a04產生
         ON CHANGE ooef122
            #add-point:ON CHANGE ooef122
            {<point name="input.g.ooef122" />}
            #END add-point

         #----<<ooef123>>----
         #此段落由子樣板a02產生
         AFTER FIELD ooef123

            #add-point:AFTER FIELD ooef123
            LET g_ooef_m.ooef123_desc = NULL
            DISPLAY BY NAME g_ooef_m.ooef123_desc
            IF NOT cl_null(g_ooef_m.ooef123) THEN
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL

               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_ooef_m.ooef001
               LET g_chkparam.arg2 = g_ooef_m.ooef123


               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_inaa001") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME

               ELSE
                  #檢查失敗時後續處理
                  LET g_ooef_m.ooef123 = g_ooef_m_t.ooef123
                  CALL arti100_ooef123_ref()
                  NEXT FIELD CURRENT
               END IF


            END IF
            CALL arti100_ooef123_ref()
          {#ADP版次:1#}
            #END add-point


         #此段落由子樣板a01產生
         BEFORE FIELD ooef123
            #add-point:BEFORE FIELD ooef123
            {<point name="input.b.ooef123" />}
            #END add-point

         #此段落由子樣板a04產生
         ON CHANGE ooef123
            #add-point:ON CHANGE ooef123
            {<point name="input.g.ooef123" />}
            #END add-point

         #----<<ooef124>>----
         #此段落由子樣板a02產生
         AFTER FIELD ooef124

            #add-point:AFTER FIELD ooef124
            LET g_ooef_m.ooef124_desc = NULL
            DISPLAY BY NAME g_ooef_m.ooef124_desc
            IF NOT cl_null(g_ooef_m.ooef124) THEN
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL

               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_ooef_m.ooef001
               LET g_chkparam.arg2 = g_ooef_m.ooef124


               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_inaa001") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME

               ELSE
                  #檢查失敗時後續處理
                  LET g_ooef_m.ooef124 = g_ooef_m_t.ooef124
                  CALL arti100_ooef124_ref()
                  NEXT FIELD CURRENT
               END IF


            END IF
            CALL arti100_ooef124_ref()
          {#ADP版次:1#}
            #END add-point


         #此段落由子樣板a01產生
         BEFORE FIELD ooef124
            #add-point:BEFORE FIELD ooef124
            {<point name="input.b.ooef124" />}
            #END add-point

         #此段落由子樣板a04產生
         ON CHANGE ooef124
            #add-point:ON CHANGE ooef124
            {<point name="input.g.ooef124" />}
            #END add-point

         #----<<ooef125>>----
         #此段落由子樣板a02產生
         AFTER FIELD ooef125

            #add-point:AFTER FIELD ooef125
            LET g_ooef_m.ooef125_desc = NULL
            DISPLAY BY NAME g_ooef_m.ooef125_desc
            IF NOT cl_null(g_ooef_m.ooef125) THEN
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL

               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_ooef_m.ooef001
               LET g_chkparam.arg2 = g_ooef_m.ooef125


               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_inaa001") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME

               ELSE
                  #檢查失敗時後續處理
                  LET g_ooef_m.ooef125 = g_ooef_m_t.ooef125
                  CALL arti100_ooef125_ref()
                  NEXT FIELD CURRENT
               END IF


            END IF
            CALL arti100_ooef125_ref()
          {#ADP版次:1#}
            #END add-point


         #此段落由子樣板a01產生
         BEFORE FIELD ooef125
            #add-point:BEFORE FIELD ooef125
            {<point name="input.b.ooef125" />}
            #END add-point

         #此段落由子樣板a04產生
         ON CHANGE ooef125
            #add-point:ON CHANGE ooef125
            {<point name="input.g.ooef125" />}
            #END add-point

         #----<<ooefownid>>----
         #----<<ooefowndp>>----
         #----<<ooefcrtid>>----
         #----<<ooefcrtdp>>----
         #----<<ooefcrtdt>>----
         #----<<ooefmodid>>----
         #----<<ooefmoddt>>----
         #----<<ooef014>>----
         #此段落由子樣板a02產生
         AFTER FIELD ooef014

            #add-point:AFTER FIELD ooef014
            LET g_ooef_m.ooef014_desc = NULL
            DISPLAY BY NAME g_ooef_m.ooef014_desc
            IF NOT cl_null(g_ooef_m.ooef014) THEN
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL

               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_ooef_m.ooef014


               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_ooal002_10") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME

               ELSE
                  #檢查失敗時後續處理
                  LET g_ooef_m.ooef014 = g_ooef_m_t.ooef014
                  CALL arti100_ooef014_ref()
                  NEXT FIELD CURRENT
               END IF

               IF NOT cl_null(g_ooef_m.ooef016) THEN
                  INITIALIZE g_chkparam.* TO NULL

                  #設定g_chkparam.*的參數
                  LET g_chkparam.arg1 = g_ooef_m.ooef014
                  LET g_chkparam.arg2 = g_ooef_m.ooef016

                  #呼叫檢查存在並帶值的library
                  IF cl_chk_exist("v_ooaj002_1") THEN

                  ELSE
                  #檢查失敗時後續處理
                     LET g_ooef_m.ooef016 = g_ooef_m_t.ooef016
                     CALL arti100_ooef016_ref()
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL arti100_ooef014_ref()
          {#ADP版次:1#}
            #END add-point


         #此段落由子樣板a01產生
         BEFORE FIELD ooef014
            #add-point:BEFORE FIELD ooef014
            {<point name="input.b.ooef014" />}
            #END add-point

         #此段落由子樣板a04產生
         ON CHANGE ooef014
            #add-point:ON CHANGE ooef014
            {<point name="input.g.ooef014" />}
            #END add-point

         #----<<ooef016>>----
         #此段落由子樣板a02產生
         AFTER FIELD ooef016

            #add-point:AFTER FIELD ooef016
            LET g_ooef_m.ooef016_desc = NULL
            DISPLAY BY NAME g_ooef_m.ooef016_desc
            IF NOT cl_null(g_ooef_m.ooef016) THEN
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL

               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_ooef_m.ooef014
               LET g_chkparam.arg2 = g_ooef_m.ooef016


               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_ooaj002_1") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME

               ELSE
                  #檢查失敗時後續處理
                  LET g_ooef_m.ooef016 = g_ooef_m_t.ooef016
                  CALL arti100_ooef016_ref()
                  NEXT FIELD CURRENT
               END IF


            END IF
            CALL arti100_ooef016_ref()
          {#ADP版次:1#}
            #END add-point


         #此段落由子樣板a01產生
         BEFORE FIELD ooef016
            #add-point:BEFORE FIELD ooef016
            {<point name="input.b.ooef016" />}
            #END add-point

         #此段落由子樣板a04產生
         ON CHANGE ooef016
            #add-point:ON CHANGE ooef016
            {<point name="input.g.ooef016" />}
            #END add-point

         #----<<ooef004>>----
         #此段落由子樣板a02產生
         AFTER FIELD ooef004

            #add-point:AFTER FIELD ooef004
            LET g_ooef_m.ooef004_desc = NULL
            DISPLAY BY NAME g_ooef_m.ooef004_desc
            IF NOT cl_null(g_ooef_m.ooef004) THEN
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL

               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_ooef_m.ooef004


               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_ooal002_3") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME

               ELSE
                  #檢查失敗時後續處理
                  LET g_ooef_m.ooef004 = g_ooef_m_t.ooef004
                  CALL arti100_ooef004_ref()
                  NEXT FIELD CURRENT
               END IF


            END IF
            CALL arti100_ooef004_ref()
          {#ADP版次:1#}
            #END add-point


         #此段落由子樣板a01產生
         BEFORE FIELD ooef004
            #add-point:BEFORE FIELD ooef004
            {<point name="input.b.ooef004" />}
            #END add-point

         #此段落由子樣板a04產生
         ON CHANGE ooef004
            #add-point:ON CHANGE ooef004
            {<point name="input.g.ooef004" />}
            #END add-point

         #----<<ooef005>>----
         #此段落由子樣板a01產生
         BEFORE FIELD ooef005
            #add-point:BEFORE FIELD ooef005
            {<point name="input.b.ooef005" />}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD ooef005

            #add-point:AFTER FIELD ooef005
            {<point name="input.a.ooef005" />}
            IF NOT cl_null(g_ooef_m.ooef005) THEN
               SELECT upper(g_ooef_m.ooef005) INTO g_ooef_m.ooef005 FROM dual
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_ooef_m.ooef005 != g_ooef_m_t.ooef005 OR
                                                   g_ooef_m_t.ooef005 IS NULL)) THEN

                  #依參數設定，對輸入值長度判斷
                  LET l_len = 0
                  LET l_len1 = 0
                  LET l_len = cl_get_para(g_enterprise,g_site,'E-COM-0003')
                  LET l_ooef005 = g_ooef_m.ooef005  #轉換成STRING類型
                  LET l_len1 = Length(l_ooef005)
                  IF l_len1 > l_len THEN            #輸入值大於設定的長度
                     LET l_ooef005 = l_ooef005.subString(1,l_len)
                     LET g_ooef_m.ooef005 = l_ooef005
                     DISPLAY BY NAME g_ooef_m.ooef005
                  END IF

                  #輸入值不可重複
                  CALL arti100_chk_ooef005() RETURNING l_success
                  IF NOT cl_null(g_errno) THEN
                     INITIALIZE g_errparam TO NULL
                     LET g_errparam.code = g_errno
                     LET g_errparam.extend = g_ooef_m.ooef005
                     LET g_errparam.popup = TRUE
                     CALL cl_err()

                     LET g_ooef_m.ooef005 = g_ooef_m_t.ooef005
                     NEXT FIELD CURRENT
                  END IF

               END IF
            END IF
            #END add-point


         #此段落由子樣板a04產生
         ON CHANGE ooef005
            #add-point:ON CHANGE ooef005
            {<point name="input.g.ooef005" />}
            #END add-point

         #----<<ooef015>>----
         #此段落由子樣板a02產生
         AFTER FIELD ooef015

            #add-point:AFTER FIELD ooef015
            LET g_ooef_m.ooef015_desc = NULL
            DISPLAY BY NAME g_ooef_m.ooef015_desc
            IF NOT cl_null(g_ooef_m.ooef015) THEN
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL

               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_ooef_m.ooef015


               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_ooal002_1") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME

               ELSE
                  #檢查失敗時後續處理
                  LET g_ooef_m.ooef015 = g_ooef_m_t.ooef015
                  CALL arti100_ooef015_ref()
                  NEXT FIELD CURRENT
               END IF


            END IF
            CALL arti100_ooef015_ref()
          {#ADP版次:1#}
            #END add-point


         #此段落由子樣板a01產生
         BEFORE FIELD ooef015
            #add-point:BEFORE FIELD ooef015
            {<point name="input.b.ooef015" />}
            #END add-point

         #此段落由子樣板a04產生
         ON CHANGE ooef015
            #add-point:ON CHANGE ooef015
            {<point name="input.g.ooef015" />}
            #END add-point

         #----<<ooef006>>----
         #此段落由子樣板a02產生
         AFTER FIELD ooef006

            #add-point:AFTER FIELD ooef006
            LET g_ooef_m.ooef006_desc = NULL
            DISPLAY BY NAME g_ooef_m.ooef006_desc
            IF NOT cl_null(g_ooef_m.ooef006) THEN
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL

               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_ooef_m.ooef006


               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_oocg001") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME

               ELSE
                  #檢查失敗時後續處理
                  LET g_ooef_m.ooef006 = g_ooef_m_t.ooef006
                  CALL arti100_ooef006_ref()
                  NEXT FIELD CURRENT
               END IF


            END IF
            CALL arti100_ooef006_ref()
          {#ADP版次:1#}
            #END add-point


         #此段落由子樣板a01產生
         BEFORE FIELD ooef006
            #add-point:BEFORE FIELD ooef006
            {<point name="input.b.ooef006" />}
            #END add-point

         #此段落由子樣板a04產生
         ON CHANGE ooef006
            #add-point:ON CHANGE ooef006
            {<point name="input.g.ooef006" />}
            #END add-point

         #----<<ooef018>>----
         #此段落由子樣板a02產生
         AFTER FIELD ooef018

            #add-point:AFTER FIELD ooef018
            LET g_ooef_m.ooef018_desc = NULL
            DISPLAY BY NAME g_ooef_m.ooef018_desc
            IF NOT cl_null(g_ooef_m.ooef018) THEN
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL

               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_ooef_m.ooef018


               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_gzot001") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME

               ELSE
                  #檢查失敗時後續處理
                  LET g_ooef_m.ooef018 = g_ooef_m_t.ooef018
                  CALL arti100_ooef018_ref()
                  NEXT FIELD CURRENT
               END IF


            END IF
            CALL arti100_ooef018_ref()           {#ADP版次:1#}
            #END add-point


         #此段落由子樣板a01產生
         BEFORE FIELD ooef018
            #add-point:BEFORE FIELD ooef018
            {<point name="input.b.ooef018" />}
            #END add-point

         #此段落由子樣板a04產生
         ON CHANGE ooef018
            #add-point:ON CHANGE ooef018
            {<point name="input.g.ooef018" />}
            #END add-point

         #----<<ooef019>>----
         #此段落由子樣板a02產生
         AFTER FIELD ooef019

            #add-point:AFTER FIELD ooef019
            LET g_ooef_m.ooef019_desc = NULL
            DISPLAY BY NAME g_ooef_m.ooef019_desc
            IF NOT cl_null(g_ooef_m.ooef019) THEN
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL

               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_ooef_m.ooef019


               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_ooal002_2") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME

               ELSE
                  #檢查失敗時後續處理
                  LET g_ooef_m.ooef019 = g_ooef_m_t.ooef019
                  CALL arti100_ooef019_ref()
                  NEXT FIELD CURRENT
               END IF


            END IF
            CALL arti100_ooef019_ref()
          {#ADP版次:1#}
            #END add-point


         #此段落由子樣板a01產生
         BEFORE FIELD ooef019
            #add-point:BEFORE FIELD ooef019
            {<point name="input.b.ooef019" />}
            #END add-point

         #此段落由子樣板a04產生
         ON CHANGE ooef019
            #add-point:ON CHANGE ooef019
            {<point name="input.g.ooef019" />}
            #END add-point

         #----<<ooef007>>----
         #此段落由子樣板a01產生
         BEFORE FIELD ooef007
            #add-point:BEFORE FIELD ooef007
            {<point name="input.b.ooef007" />}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD ooef007

            #add-point:AFTER FIELD ooef007
            {<point name="input.a.ooef007" />}
            #END add-point


         #此段落由子樣板a04產生
         ON CHANGE ooef007
            #add-point:ON CHANGE ooef007
            {<point name="input.g.ooef007" />}
            #END add-point

         #----<<ooef020>>----
         #此段落由子樣板a01產生
         BEFORE FIELD ooef020
            #add-point:BEFORE FIELD ooef020
            {<point name="input.b.ooef020" />}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD ooef020

            #add-point:AFTER FIELD ooef020
            {<point name="input.a.ooef020" />}
            #END add-point


         #此段落由子樣板a04產生
         ON CHANGE ooef020
            #add-point:ON CHANGE ooef020
            {<point name="input.g.ooef020" />}
            #END add-point

         #----<<ooef022>>----
         #此段落由子樣板a01產生
         BEFORE FIELD ooef022
            #add-point:BEFORE FIELD ooef022
            {<point name="input.b.ooef022" />}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD ooef022

            #add-point:AFTER FIELD ooef022
            {<point name="input.a.ooef022" />}
            #END add-point


         #此段落由子樣板a04產生
         ON CHANGE ooef022
            #add-point:ON CHANGE ooef022
            {<point name="input.g.ooef022" />}
            #END add-point

         #----<<ooef008>>----
         #此段落由子樣板a02產生
         AFTER FIELD ooef008

            #add-point:AFTER FIELD ooef008
            LET g_ooef_m.ooef008_desc = NULL
            DISPLAY BY NAME g_ooef_m.ooef008_desc
            IF NOT cl_null(g_ooef_m.ooef008) THEN
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL

               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_ooef_m.ooef008


               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_ooal002_4") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME

               ELSE
                  #檢查失敗時後續處理
                  LET g_ooef_m.ooef008 = g_ooef_m_t.ooef008
                  CALL arti100_ooef008_ref()
                  NEXT FIELD CURRENT
               END IF


            END IF
            CALL arti100_ooef008_ref()
          {#ADP版次:1#}
            #END add-point


         #此段落由子樣板a01產生
         BEFORE FIELD ooef008
            #add-point:BEFORE FIELD ooef008
            {<point name="input.b.ooef008" />}
            #END add-point

         #此段落由子樣板a04產生
         ON CHANGE ooef008
            #add-point:ON CHANGE ooef008
            {<point name="input.g.ooef008" />}
            #END add-point

         #----<<ooef010>>----
         #此段落由子樣板a02產生
         AFTER FIELD ooef010

            #add-point:AFTER FIELD ooef010
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_ooef_m.ooef010
            CALL ap_ref_array2(g_ref_fields,"SELECT gzcbl004 FROM gzcbl_t WHERE gzcbl001='25' AND gzcbl002=? AND gzcbl003='"||g_lang||"'","") RETURNING g_rtn_fields
            LET g_ooef_m.ooef010_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_ooef_m.ooef010_desc
          {#ADP版次:1#}
            #END add-point


         #此段落由子樣板a01產生
         BEFORE FIELD ooef010
            #add-point:BEFORE FIELD ooef010
            {<point name="input.b.ooef010" />}
            #END add-point

         #此段落由子樣板a04產生
         ON CHANGE ooef010
            #add-point:ON CHANGE ooef010
            {<point name="input.g.ooef010" />}
            #END add-point

         #----<<ooef011>>----
         #此段落由子樣板a01產生
         BEFORE FIELD ooef011
            #add-point:BEFORE FIELD ooef011
            {<point name="input.b.ooef011" />}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD ooef011

            #add-point:AFTER FIELD ooef011
            {<point name="input.a.ooef011" />}
            #END add-point


         #此段落由子樣板a04產生
         ON CHANGE ooef011
            #add-point:ON CHANGE ooef011
            {<point name="input.g.ooef011" />}
            #END add-point

         #----<<ooef013>>----
         #此段落由子樣板a01產生
         BEFORE FIELD ooef013
            #add-point:BEFORE FIELD ooef013
            {<point name="input.b.ooef013" />}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD ooef013

            #add-point:AFTER FIELD ooef013
            {<point name="input.a.ooef013" />}
            #END add-point


         #此段落由子樣板a04產生
         ON CHANGE ooef013
            #add-point:ON CHANGE ooef013
            {<point name="input.g.ooef013" />}
            #END add-point

         #----<<ooef023>>----
         #此段落由子樣板a01產生
         BEFORE FIELD ooef023
            #add-point:BEFORE FIELD ooef023
            {<point name="input.b.ooef023" />}
            #END add-point

         #此段落由子樣板a02產生
         AFTER FIELD ooef023

            #add-point:AFTER FIELD ooef023
            {<point name="input.a.ooef023" />}
            #END add-point


         #此段落由子樣板a04產生
         ON CHANGE ooef023
            #add-point:ON CHANGE ooef023
            {<point name="input.g.ooef023" />}
            #END add-point

         #----<<ooef024>>----
         #此段落由子樣板a02產生
         AFTER FIELD ooef024

            #add-point:AFTER FIELD ooef024
            LET g_ooef_m.ooef024_desc = null
            DISPLAY BY NAME g_ooef_m.ooef024_desc
            IF NOT cl_null(g_ooef_m.ooef024) THEN
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL

               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_ooef_m.ooef024


               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_pmaa001_6") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME

               ELSE
                  #檢查失敗時後續處理
                  LET g_ooef_m.ooef024 = g_ooef_m_t.ooef024
                  CALL arti100_ooef024_ref()
                  NEXT FIELD CURRENT
               END IF


            END IF
            CALL arti100_ooef024_ref()
          {#ADP版次:1#}
            #END add-point


         #此段落由子樣板a01產生
         BEFORE FIELD ooef024
            #add-point:BEFORE FIELD ooef024
            {<point name="input.b.ooef024" />}
            #END add-point

         #此段落由子樣板a04產生
         ON CHANGE ooef024
            #add-point:ON CHANGE ooef024
            {<point name="input.g.ooef024" />}
            #END add-point

         #dongsz--add--str---
         #此段落由子樣板a02產生
         AFTER FIELD ooef026

            #add-point:AFTER FIELD ooef026
            LET g_ooef_m.ooef026_desc = null
            DISPLAY BY NAME g_ooef_m.ooef026_desc
            IF NOT cl_null(g_ooef_m.ooef026) THEN
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL

               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_ooef_m.ooef001
               LET g_chkparam.arg2 = g_ooef_m.ooef026

               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_nmas002_2") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME

               ELSE
                  #檢查失敗時後續處理
                  LET g_ooef_m.ooef026 = g_ooef_m_t.ooef026
                  CALL arti100_ooef026_ref()
                  NEXT FIELD CURRENT
               END IF


            END IF
            CALL arti100_ooef026_ref()
         #dongsz--add--end---

         #----<<ooef150>>----
         #此段落由子樣板a02產生
         AFTER FIELD ooef150

            #add-point:AFTER FIELD ooef150
            LET g_ooef_m.ooef150_desc = null
            DISPLAY BY NAME g_ooef_m.ooef150_desc
            IF NOT cl_null(g_ooef_m.ooef150) THEN
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL

               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_ooef_m.ooef150


                IF NOT s_azzi650_chk_exist('2077',g_ooef_m.ooef150) THEN
                  #檢查失敗時後續處理
                  LET g_ooef_m.ooef150 = g_ooef_m_t.ooef150
                  CALL arti100_ooef150_ref()
                  NEXT FIELD CURRENT
               END IF


            END IF
            CALL arti100_ooef150_ref()
          {#ADP版次:1#}
            #END add-point


         #此段落由子樣板a01產生
         BEFORE FIELD ooef150
            #add-point:BEFORE FIELD ooef150
            {<point name="input.b.ooef150" />}
            #END add-point

         #此段落由子樣板a04產生
         ON CHANGE ooef150
            #add-point:ON CHANGE ooef150
            {<point name="input.g.ooef150" />}
            #END add-point

         #----<<ooef151>>----
         #此段落由子樣板a02產生
         AFTER FIELD ooef151

            #add-point:AFTER FIELD ooef151
            LET g_ooef_m.ooef151_desc = null
            DISPLAY BY NAME g_ooef_m.ooef151_desc
            IF NOT cl_null(g_ooef_m.ooef151) THEN
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL

               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_ooef_m.ooef151


               #呼叫檢查存在並帶值的library
               IF NOT s_azzi650_chk_exist('2078',g_ooef_m.ooef151) THEN
                  #檢查失敗時後續處理
                  LET g_ooef_m.ooef151 = g_ooef_m_t.ooef151
                  CALL arti100_ooef151_ref()
                  NEXT FIELD CURRENT
               END IF


            END IF
            CALL arti100_ooef151_ref()
          {#ADP版次:1#}
            #END add-point


         #此段落由子樣板a01產生
         BEFORE FIELD ooef151
            #add-point:BEFORE FIELD ooef151
            {<point name="input.b.ooef151" />}
            #END add-point

         #此段落由子樣板a04產生
         ON CHANGE ooef151
            #add-point:ON CHANGE ooef151
            {<point name="input.g.ooef151" />}
            #END add-point

         #----<<ooef152>>----
         #此段落由子樣板a02產生
         AFTER FIELD ooef152

            #add-point:AFTER FIELD ooef152
            LET g_ooef_m.ooef152_desc = null
            DISPLAY BY NAME g_ooef_m.ooef152_desc
            IF NOT cl_null(g_ooef_m.ooef152) THEN
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL

               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_ooef_m.ooef152


               #呼叫檢查存在並帶值的library
               IF NOT s_azzi650_chk_exist('2079',g_ooef_m.ooef152) THEN
                  #檢查失敗時後續處理
                  LET g_ooef_m.ooef152 = g_ooef_m_t.ooef152
                  CALL arti100_ooef152_ref()
                  NEXT FIELD CURRENT
               END IF


            END IF
            CALL arti100_ooef152_ref()
          {#ADP版次:1#}
            #END add-point


         #此段落由子樣板a01產生
         BEFORE FIELD ooef152
            #add-point:BEFORE FIELD ooef152
            {<point name="input.b.ooef152" />}
            #END add-point

         #此段落由子樣板a04產生
         ON CHANGE ooef152
            #add-point:ON CHANGE ooef152
            {<point name="input.g.ooef152" />}
            #END add-point

         #----<<ooef153>>----
         #此段落由子樣板a02產生
         AFTER FIELD ooef153

            #add-point:AFTER FIELD ooef153
            LET g_ooef_m.ooef153_desc = null
            DISPLAY BY NAME g_ooef_m.ooef153_desc
            IF NOT cl_null(g_ooef_m.ooef153) THEN
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL

               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_ooef_m.ooef153


               #呼叫檢查存在並帶值的library
               IF NOT s_azzi650_chk_exist('2080',g_ooef_m.ooef153) THEN
                  #檢查失敗時後續處理
                  LET g_ooef_m.ooef153 = g_ooef_m_t.ooef153
                  CALL arti100_ooef153_ref()
                  NEXT FIELD CURRENT
               END IF


            END IF
            CALL arti100_ooef153_ref()
          {#ADP版次:1#}
            #END add-point


         #此段落由子樣板a01產生
         BEFORE FIELD ooef153
            #add-point:BEFORE FIELD ooef153
            {<point name="input.b.ooef153" />}
            #END add-point

         #此段落由子樣板a04產生
         ON CHANGE ooef153
            #add-point:ON CHANGE ooef153
            {<point name="input.g.ooef153" />}
            #END add-point

         #----<<ooef154>>----
         #此段落由子樣板a02產生
         AFTER FIELD ooef154

            #add-point:AFTER FIELD ooef154
            LET g_ooef_m.ooef154_desc = null
            DISPLAY BY NAME g_ooef_m.ooef154_desc
            IF NOT cl_null(g_ooef_m.ooef154) THEN
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL

               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_ooef_m.ooef154


               #呼叫檢查存在並帶值的library
               IF NOT s_azzi650_chk_exist('2081',g_ooef_m.ooef154) THEN
                  #檢查失敗時後續處理
                  LET g_ooef_m.ooef154 = g_ooef_m_t.ooef154
                  CALL arti100_ooef154_ref()
                  NEXT FIELD CURRENT
               END IF


            END IF
            CALL arti100_ooef154_ref()
          {#ADP版次:1#}
            #END add-point


         #此段落由子樣板a01產生
         BEFORE FIELD ooef154
            #add-point:BEFORE FIELD ooef154
            {<point name="input.b.ooef154" />}
            #END add-point

         #此段落由子樣板a04產生
         ON CHANGE ooef154
            #add-point:ON CHANGE ooef154
            {<point name="input.g.ooef154" />}
            #END add-point

         #----<<ooef155>>----
         #此段落由子樣板a02產生
         AFTER FIELD ooef155

            #add-point:AFTER FIELD ooef155
            LET g_ooef_m.ooef155_desc = null
            DISPLAY BY NAME g_ooef_m.ooef155_desc
            IF NOT cl_null(g_ooef_m.ooef155) THEN
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL

               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_ooef_m.ooef155


               #呼叫檢查存在並帶值的library
               IF NOT s_azzi650_chk_exist('2082',g_ooef_m.ooef155) THEN
                  #檢查失敗時後續處理
                  LET g_ooef_m.ooef155 = g_ooef_m_t.ooef155
                  CALL arti100_ooef155_ref()
                  NEXT FIELD CURRENT
               END IF


            END IF
            CALL arti100_ooef155_ref()
          {#ADP版次:1#}
            #END add-point


         #此段落由子樣板a01產生
         BEFORE FIELD ooef155
            #add-point:BEFORE FIELD ooef155
            {<point name="input.b.ooef155" />}
            #END add-point

         #此段落由子樣板a04產生
         ON CHANGE ooef155
            #add-point:ON CHANGE ooef155
            {<point name="input.g.ooef155" />}
            #END add-point

         #----<<ooef156>>----
         #此段落由子樣板a02產生
         AFTER FIELD ooef156

            #add-point:AFTER FIELD ooef156
            LET g_ooef_m.ooef156_desc = ''
            DISPLAY BY NAME g_ooef_m.ooef156_desc
            IF NOT cl_null(g_ooef_m.ooef156) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_ooef_m.ooef156 != g_ooef_m_t.ooef156 OR g_ooef_m_t.ooef156 IS NULL )) THEN
                  INITIALIZE g_chkparam.* TO NULL
                  LET g_chkparam.arg1 = g_ooef_m.ooef156
                  IF NOT cl_chk_exist("v_dbac001") THEN
                     LET g_ooef_m.ooef156 = g_ooef_m_t.ooef156
                     LET g_ooef_m.ooef156_desc = s_desc_get_dbad002_desc(g_ooef_m.ooef156)
                     DISPLAY BY NAME g_ooef_m.ooef156,g_ooef_m.ooef156_desc
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            LET g_ooef_m.ooef156_desc = s_desc_get_dbad002_desc(g_ooef_m.ooef156)
            DISPLAY BY NAME g_ooef_m.ooef156,g_ooef_m.ooef156_desc
          {#ADP版次:1#}
            #END add-point


         #此段落由子樣板a01產生
         BEFORE FIELD ooef156
            #add-point:BEFORE FIELD ooef156
            {<point name="input.b.ooef156" />}
            #END add-point

         #此段落由子樣板a04產生
         ON CHANGE ooef156
            #add-point:ON CHANGE ooef156
            {<point name="input.g.ooef156" />}
            #END add-point

         #----<<ooef157>>----
         #此段落由子樣板a02產生
         AFTER FIELD ooef157

            #add-point:AFTER FIELD ooef157
            LET g_ooef_m.ooef157_desc = null
            DISPLAY BY NAME g_ooef_m.ooef157_desc
            IF NOT cl_null(g_ooef_m.ooef157) THEN
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL

               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_ooef_m.ooef157


               #呼叫檢查存在並帶值的library
               IF NOT s_azzi650_chk_exist('2084',g_ooef_m.ooef157) THEN
                  #檢查失敗時後續處理
                  LET g_ooef_m.ooef157 = g_ooef_m_t.ooef157
                  CALL arti100_ooef157_ref()
                  NEXT FIELD CURRENT
               END IF


            END IF
            CALL arti100_ooef157_ref()
          {#ADP版次:1#}
            #END add-point


         #此段落由子樣板a01產生
         BEFORE FIELD ooef157
            #add-point:BEFORE FIELD ooef157
            {<point name="input.b.ooef157" />}
            #END add-point

         #此段落由子樣板a04產生
         ON CHANGE ooef157
            #add-point:ON CHANGE ooef157
            {<point name="input.g.ooef157" />}
            #END add-point

         #----<<ooef158>>----
         #此段落由子樣板a02產生
         AFTER FIELD ooef158

            #add-point:AFTER FIELD ooef158
            LET g_ooef_m.ooef158_desc = null
            DISPLAY BY NAME g_ooef_m.ooef158_desc
            IF NOT cl_null(g_ooef_m.ooef158) THEN
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL

               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_ooef_m.ooef158


               #呼叫檢查存在並帶值的library
               IF NOT s_azzi650_chk_exist('2085',g_ooef_m.ooef158) THEN
                  #檢查失敗時後續處理
                  LET g_ooef_m.ooef158 = g_ooef_m_t.ooef158
                  CALL arti100_ooef158_ref()
                  NEXT FIELD CURRENT
               END IF


            END IF
            CALL arti100_ooef158_ref()
          {#ADP版次:1#}
            #END add-point


         #此段落由子樣板a01產生
         BEFORE FIELD ooef158
            #add-point:BEFORE FIELD ooef158
            {<point name="input.b.ooef158" />}
            #END add-point

         #此段落由子樣板a04產生
         ON CHANGE ooef158
            #add-point:ON CHANGE ooef158
            {<point name="input.g.ooef158" />}
            #END add-point

         #----<<ooef159>>----
         #此段落由子樣板a02產生
         AFTER FIELD ooef159

            #add-point:AFTER FIELD ooef159
            LET g_ooef_m.ooef159_desc = null
            DISPLAY BY NAME g_ooef_m.ooef159_desc
            IF NOT cl_null(g_ooef_m.ooef159) THEN
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL

               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_ooef_m.ooef159


               #呼叫檢查存在並帶值的library
               IF NOT s_azzi650_chk_exist('2086',g_ooef_m.ooef159) THEN
                  #檢查失敗時後續處理
                  LET g_ooef_m.ooef159 = g_ooef_m_t.ooef159
                  CALL arti100_ooef159_ref()
                  NEXT FIELD CURRENT
               END IF


            END IF
            CALL arti100_ooef159_ref()
          {#ADP版次:1#}
            #END add-point


         #此段落由子樣板a01產生
         BEFORE FIELD ooef159
            #add-point:BEFORE FIELD ooef159
            {<point name="input.b.ooef159" />}
            #END add-point

         #此段落由子樣板a04產生
         ON CHANGE ooef159
            #add-point:ON CHANGE ooef159
            {<point name="input.g.ooef159" />}
            #END add-point

         #----<<ooef160>>----
         #此段落由子樣板a02產生
         AFTER FIELD ooef160

            #add-point:AFTER FIELD ooef160
            LET g_ooef_m.ooef160_desc = null
            DISPLAY BY NAME g_ooef_m.ooef160_desc
            IF NOT cl_null(g_ooef_m.ooef160) THEN
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL

               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_ooef_m.ooef160


               #呼叫檢查存在並帶值的library
               IF NOT s_azzi650_chk_exist('2087',g_ooef_m.ooef160) THEN
                  #檢查失敗時後續處理
                  LET g_ooef_m.ooef160 = g_ooef_m_t.ooef160
                  CALL arti100_ooef160_ref()
                  NEXT FIELD CURRENT
               END IF


            END IF
            CALL arti100_ooef160_ref()
          {#ADP版次:1#}
            #END add-point


         #此段落由子樣板a01產生
         BEFORE FIELD ooef160
            #add-point:BEFORE FIELD ooef160
            {<point name="input.b.ooef160" />}
            #END add-point

         #此段落由子樣板a04產生
         ON CHANGE ooef160
            #add-point:ON CHANGE ooef160
            {<point name="input.g.ooef160" />}
            #END add-point

         #----<<ooef161>>----
         #此段落由子樣板a02產生
         AFTER FIELD ooef161

            #add-point:AFTER FIELD ooef161
            LET g_ooef_m.ooef161_desc = null
            DISPLAY BY NAME g_ooef_m.ooef161_desc
            IF NOT cl_null(g_ooef_m.ooef161) THEN
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL

               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_ooef_m.ooef161


               #呼叫檢查存在並帶值的library
               IF NOT s_azzi650_chk_exist('2088',g_ooef_m.ooef161) THEN
                  #檢查失敗時後續處理
                  LET g_ooef_m.ooef161 = g_ooef_m_t.ooef161
                  CALL arti100_ooef161_ref()
                  NEXT FIELD CURRENT
               END IF


            END IF
            CALL arti100_ooef161_ref()
          {#ADP版次:1#}
            #END add-point


         #此段落由子樣板a01產生
         BEFORE FIELD ooef161
            #add-point:BEFORE FIELD ooef161
            {<point name="input.b.ooef161" />}
            #END add-point

         #此段落由子樣板a04產生
         ON CHANGE ooef161
            #add-point:ON CHANGE ooef161
            {<point name="input.g.ooef161" />}
            #END add-point

         #----<<ooef162>>----
         #此段落由子樣板a02產生
         AFTER FIELD ooef162

            #add-point:AFTER FIELD ooef162
            LET g_ooef_m.ooef162_desc = null
            DISPLAY BY NAME g_ooef_m.ooef162_desc
            IF NOT cl_null(g_ooef_m.ooef162) THEN
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL

               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_ooef_m.ooef162


               #呼叫檢查存在並帶值的library
               IF NOT s_azzi650_chk_exist('2089',g_ooef_m.ooef162) THEN
                  #檢查失敗時後續處理
                  LET g_ooef_m.ooef162 = g_ooef_m_t.ooef162
                  CALL arti100_ooef162_ref()
                  NEXT FIELD CURRENT
               END IF


            END IF
            CALL arti100_ooef162_ref()
          {#ADP版次:1#}
            #END add-point


         #此段落由子樣板a01產生
         BEFORE FIELD ooef162
            #add-point:BEFORE FIELD ooef162
            {<point name="input.b.ooef162" />}
            #END add-point

         #此段落由子樣板a04產生
         ON CHANGE ooef162
            #add-point:ON CHANGE ooef162
            {<point name="input.g.ooef162" />}
            #END add-point

         #----<<ooef163>>----
         #此段落由子樣板a02產生
         AFTER FIELD ooef163

            #add-point:AFTER FIELD ooef163
            LET g_ooef_m.ooef163_desc = null
            DISPLAY BY NAME g_ooef_m.ooef163_desc
            IF NOT cl_null(g_ooef_m.ooef163) THEN
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL

               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_ooef_m.ooef163


               #呼叫檢查存在並帶值的library
               IF NOT s_azzi650_chk_exist('2090',g_ooef_m.ooef163) THEN
                  #檢查失敗時後續處理
                  LET g_ooef_m.ooef163 = g_ooef_m_t.ooef163
                  CALL arti100_ooef163_ref()
                  NEXT FIELD CURRENT
               END IF


            END IF
            CALL arti100_ooef163_ref()
          {#ADP版次:1#}
            #END add-point


         #此段落由子樣板a01產生
         BEFORE FIELD ooef163
            #add-point:BEFORE FIELD ooef163
            {<point name="input.b.ooef163" />}
            #END add-point

         #此段落由子樣板a04產生
         ON CHANGE ooef163
            #add-point:ON CHANGE ooef163
            {<point name="input.g.ooef163" />}
            #END add-point

         #----<<ooef164>>----
         #此段落由子樣板a02產生
         AFTER FIELD ooef164

            #add-point:AFTER FIELD ooef164
            LET g_ooef_m.ooef164_desc = null
            DISPLAY BY NAME g_ooef_m.ooef164_desc
            IF NOT cl_null(g_ooef_m.ooef164) THEN
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL

               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_ooef_m.ooef164


               #呼叫檢查存在並帶值的library
               IF NOT s_azzi650_chk_exist('2091',g_ooef_m.ooef164) THEN
                  #檢查失敗時後續處理
                  LET g_ooef_m.ooef164 = g_ooef_m_t.ooef164
                  CALL arti100_ooef164_ref()
                  NEXT FIELD CURRENT
               END IF


            END IF
            CALL arti100_ooef164_ref()
          {#ADP版次:1#}
            #END add-point


         #此段落由子樣板a01產生
         BEFORE FIELD ooef164
            #add-point:BEFORE FIELD ooef164
            {<point name="input.b.ooef164" />}
            #END add-point

         #此段落由子樣板a04產生
         ON CHANGE ooef164
            #add-point:ON CHANGE ooef164
            {<point name="input.g.ooef164" />}
            #END add-point

         #----<<ooef165>>----
         #此段落由子樣板a02產生
         AFTER FIELD ooef165

            #add-point:AFTER FIELD ooef165
            LET g_ooef_m.ooef165_desc = null
            DISPLAY BY NAME g_ooef_m.ooef165_desc
            IF NOT cl_null(g_ooef_m.ooef165) THEN
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL

               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_ooef_m.ooef165


               #呼叫檢查存在並帶值的library
               IF NOT s_azzi650_chk_exist('2092',g_ooef_m.ooef165) THEN
                  #檢查失敗時後續處理
                  LET g_ooef_m.ooef165 = g_ooef_m_t.ooef165
                  CALL arti100_ooef165_ref()
                  NEXT FIELD CURRENT
               END IF


            END IF
            CALL arti100_ooef165_ref()
          {#ADP版次:1#}
            #END add-point


         #此段落由子樣板a01產生
         BEFORE FIELD ooef165
            #add-point:BEFORE FIELD ooef165
            {<point name="input.b.ooef165" />}
            #END add-point

         #此段落由子樣板a04產生
         ON CHANGE ooef165
            #add-point:ON CHANGE ooef165
            {<point name="input.g.ooef165" />}
            #END add-point

         #----<<ooef166>>----
         #此段落由子樣板a02產生
         AFTER FIELD ooef166

            #add-point:AFTER FIELD ooef166
            LET g_ooef_m.ooef166_desc = null
            DISPLAY BY NAME g_ooef_m.ooef166_desc
            IF NOT cl_null(g_ooef_m.ooef166) THEN
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL

               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_ooef_m.ooef166


               #呼叫檢查存在並帶值的library
               IF NOT s_azzi650_chk_exist('2093',g_ooef_m.ooef166) THEN
                  #檢查失敗時後續處理
                  LET g_ooef_m.ooef166 = g_ooef_m_t.ooef166
                  CALL arti100_ooef166_ref()
                  NEXT FIELD CURRENT
               END IF


            END IF
            CALL arti100_ooef166_ref()
          {#ADP版次:1#}
            #END add-point


         #此段落由子樣板a01產生
         BEFORE FIELD ooef166
            #add-point:BEFORE FIELD ooef166
            {<point name="input.b.ooef166" />}
            #END add-point

         #此段落由子樣板a04產生
         ON CHANGE ooef166
            #add-point:ON CHANGE ooef166
            {<point name="input.g.ooef166" />}
            #END add-point

         #----<<ooef167>>----
         #此段落由子樣板a02產生
         AFTER FIELD ooef167

            #add-point:AFTER FIELD ooef167
            LET g_ooef_m.ooef167_desc = null
            DISPLAY BY NAME g_ooef_m.ooef167_desc
            IF NOT cl_null(g_ooef_m.ooef167) THEN
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL

               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_ooef_m.ooef167


               #呼叫檢查存在並帶值的library
               IF NOT s_azzi650_chk_exist('2094',g_ooef_m.ooef167) THEN
                  #檢查失敗時後續處理
                  LET g_ooef_m.ooef167 = g_ooef_m_t.ooef167
                  CALL arti100_ooef167_ref()
                  NEXT FIELD CURRENT
               END IF


            END IF
            CALL arti100_ooef167_ref()
          {#ADP版次:1#}
            #END add-point


         #此段落由子樣板a01產生
         BEFORE FIELD ooef167
            #add-point:BEFORE FIELD ooef167
            {<point name="input.b.ooef167" />}
            #END add-point

         #此段落由子樣板a04產生
         ON CHANGE ooef167
            #add-point:ON CHANGE ooef167
            {<point name="input.g.ooef167" />}
            #END add-point

         #----<<ooef168>>----
         #此段落由子樣板a02產生
         AFTER FIELD ooef168

            #add-point:AFTER FIELD ooef168
            LET g_ooef_m.ooef168_desc = null
            DISPLAY BY NAME g_ooef_m.ooef168_desc
            IF NOT cl_null(g_ooef_m.ooef168) THEN
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL

               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_ooef_m.ooef168


               #呼叫檢查存在並帶值的library
               IF NOT s_azzi650_chk_exist('2095',g_ooef_m.ooef168) THEN
                  #檢查失敗時後續處理
                  LET g_ooef_m.ooef168 = g_ooef_m_t.ooef168
                  CALL arti100_ooef168_ref()
                  NEXT FIELD CURRENT
               END IF


            END IF
            CALL arti100_ooef168_ref()
          {#ADP版次:1#}
            #END add-point


         #此段落由子樣板a01產生
         BEFORE FIELD ooef168
            #add-point:BEFORE FIELD ooef168
            {<point name="input.b.ooef168" />}
            #END add-point

         #此段落由子樣板a04產生
         ON CHANGE ooef168
            #add-point:ON CHANGE ooef168
            {<point name="input.g.ooef168" />}
            #END add-point

         #----<<ooef169>>----
         #此段落由子樣板a02產生
         AFTER FIELD ooef169

            #add-point:AFTER FIELD ooef169
            LET g_ooef_m.ooef169_desc = null
            DISPLAY BY NAME g_ooef_m.ooef169_desc
            IF NOT cl_null(g_ooef_m.ooef169) THEN
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL

               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_ooef_m.ooef169


               #呼叫檢查存在並帶值的library
               IF NOT s_azzi650_chk_exist('2096',g_ooef_m.ooef169) THEN
                  #檢查失敗時後續處理
                  LET g_ooef_m.ooef169 = g_ooef_m_t.ooef169
                  CALL arti100_ooef169_ref()
                  NEXT FIELD CURRENT
               END IF


            END IF
            CALL arti100_ooef169_ref()
          {#ADP版次:1#}
            #END add-point


         #此段落由子樣板a01產生
         BEFORE FIELD ooef169
            #add-point:BEFORE FIELD ooef169
            {<point name="input.b.ooef169" />}
            #END add-point

         #此段落由子樣板a04產生
         ON CHANGE ooef169
            #add-point:ON CHANGE ooef169
            {<point name="input.g.ooef169" />}
            #END add-point

 #欄位檢查
         #---------------------------<  Master  >---------------------------
         #----<<ooefunit>>----
         #Ctrlp:input.c.ooefunit
         ON ACTION controlp INFIELD ooefunit
            #add-point:ON ACTION controlp INFIELD ooefunit
            {<point name="input.c.ooefunit" />}
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			   LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_ooef_m.ooefunit             #給予default值

            #給予arg
            LET g_qryparam.where = s_aooi500_q_where(g_prog,'ooefunit',g_ooef_m.ooefunit,'i')   #150308-00001#5  By benson add 'i' 
            CALL q_ooef001_24()                                #呼叫開窗

            LET g_ooef_m.ooefunit = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_ooef_m.ooefunit TO ooefunit              #顯示到畫面上
            CALL arti100_ooefunit_ref()
            NEXT FIELD ooefunit                          #返回原欄位
            #END add-point

         #----<<ooef001>>----
         #Ctrlp:input.c.ooef001
         ON ACTION controlp INFIELD ooef001
            #add-point:ON ACTION controlp INFIELD ooef001

          {#ADP版次:1#}
            #END add-point

         #----<<ooef017>>----
         #Ctrlp:input.c.ooef017
         ON ACTION controlp INFIELD ooef017
            #add-point:ON ACTION controlp INFIELD ooef017
#此段落由子樣板a07產生
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_ooef_m.ooef017             #給予default值

            #給予arg
            LET g_qryparam.where = "ooef003='Y'" 
            CALL q_ooef001()                                #呼叫開窗

            LET g_ooef_m.ooef017 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_ooef_m.ooef017 TO ooef017              #顯示到畫面上
            call arti100_ooef017_ref()
            NEXT FIELD ooef017                          #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #----<<ooef101>>----
         #Ctrlp:input.c.ooef101
#         ON ACTION controlp INFIELD ooef101
            #add-point:ON ACTION controlp INFIELD ooef101
            {<point name="input.c.ooef101" />}
            #END add-point

         #----<<ooed005>>----
         #Ctrlp:input.c.ooed005
#         ON ACTION controlp INFIELD ooed005
            #add-point:ON ACTION controlp INFIELD ooed005
            {<point name="input.c.ooed005" />}
            #END add-point

         #----<<ooef105>>----
         #Ctrlp:input.c.ooef105
         ON ACTION controlp INFIELD ooef105
            #add-point:ON ACTION controlp INFIELD ooef105
#此段落由子樣板a07產生
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_ooef_m.ooef105             #給予default值

            #給予arg
#            LET g_qryparam.where = "ooef304='Y'"
#            CALL q_ooef001()                                #呼叫開窗
            IF s_aooi500_setpoint(g_prog,'ooef105') THEN #150504-00035#1 Add By Ken 150506
               LET g_qryparam.where = s_aooi500_q_where(g_prog,'ooef105',g_ooef_m.ooefunit,'i')   #150308-00001#5  By benson add 'i'
               CALL q_ooef001_24()
            #150504-00035#1 Add-S By Ken 150506
            ELSE
               LET g_qryparam.where = " ooef304 = 'Y'"
               CALL q_ooef001()
            END IF
            #150504-00035#1 Add-E
            LET g_ooef_m.ooef105 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_ooef_m.ooef105 TO ooef105              #顯示到畫面上
            call arti100_ooef105_ref()
            NEXT FIELD ooef105                          #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #----<<ooef102>>----
         #Ctrlp:input.c.ooef102
#         ON ACTION controlp INFIELD ooef102
            #add-point:ON ACTION controlp INFIELD ooef102
            {<point name="input.c.ooef102" />}
            #END add-point

         #----<<ooef103>>----
         #Ctrlp:input.c.ooef103
#         ON ACTION controlp INFIELD ooef103
            #add-point:ON ACTION controlp INFIELD ooef103
            {<point name="input.c.ooef103" />}
            #END add-point

         #----<<ooef100>>----
         #Ctrlp:input.c.ooef100
#         ON ACTION controlp INFIELD ooef100
            #add-point:ON ACTION controlp INFIELD ooef100
            {<point name="input.c.ooef100" />}
            #END add-point

         #----<<ooefstus>>----
         #Ctrlp:input.c.ooefstus
#         ON ACTION controlp INFIELD ooefstus
            #add-point:ON ACTION controlp INFIELD ooefstus
            {<point name="input.c.ooefstus" />}
            #END add-point

         #----<<ooef104>>----
         #Ctrlp:input.c.ooef104
         ON ACTION controlp INFIELD ooef104
            #add-point:ON ACTION controlp INFIELD ooef104
#此段落由子樣板a07產生
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_ooef_m.ooef104             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "2076" #

            CALL q_oocq002_4()                                #呼叫開窗

            LET g_ooef_m.ooef104 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_ooef_m.ooef104 TO ooef104              #顯示到畫面上
            call arti100_ooef104_ref()
            NEXT FIELD ooef104                          #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #----<<ooef106>>----
         #Ctrlp:input.c.ooef106
         ON ACTION controlp INFIELD ooef106
            #add-point:ON ACTION controlp INFIELD ooef106
#此段落由子樣板a07產生
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_ooef_m.ooef106             #給予default值

            #給予arg
#            LET g_qryparam.where= " ooef304='Y' "
#            CALL q_ooef001()                                #呼叫開窗
            LET g_qryparam.where = s_aooi500_q_where(g_prog,'ooef106',g_ooef_m.ooefunit,'i')   #150308-00001#5  By benson add 'i'
            CALL q_ooef001_24()

            LET g_ooef_m.ooef106 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_ooef_m.ooef106 TO ooef106              #顯示到畫面上
            call arti100_ooef106_ref()
            NEXT FIELD ooef106                          #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #----<<ooef108>>----
         #Ctrlp:input.c.ooef108
         ON ACTION controlp INFIELD ooef108
            #add-point:ON ACTION controlp INFIELD ooef108
#此段落由子樣板a07產生
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_ooef_m.ooef108             #給予default值

            #給予arg
            LET g_qryparam.where = "pmaa230 = '1' AND pmaa092 = '1' " #150504-00023#1 Add By Ken 150506
            CALL q_pmaa001_15()                                #呼叫開窗

            LET g_ooef_m.ooef108 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_ooef_m.ooef108 TO ooef108              #顯示到畫面上
            call arti100_ooef108_ref()
            NEXT FIELD ooef108                          #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #----<<date>>----
         #Ctrlp:input.c.date
#         ON ACTION controlp INFIELD date
            #add-point:ON ACTION controlp INFIELD date
            {<point name="input.c.date" />}
            #END add-point

         #----<<ooef109>>----
         #Ctrlp:input.c.ooef109
#         ON ACTION controlp INFIELD ooef109
            #add-point:ON ACTION controlp INFIELD ooef109
            {<point name="input.c.ooef109" />}
            #END add-point

         #----<<ooef110>>----
         #Ctrlp:input.c.ooef110
#         ON ACTION controlp INFIELD ooef110
            #add-point:ON ACTION controlp INFIELD ooef110
            {<point name="input.c.ooef110" />}
            #END add-point

         #----<<ooef115>>----
         #Ctrlp:input.c.ooef115
#         ON ACTION controlp INFIELD ooef115
            #add-point:ON ACTION controlp INFIELD ooef115
            {<point name="input.c.ooef115" />}
            #END add-point

         #----<<ooef111>>----
         #Ctrlp:input.c.ooef111
#         ON ACTION controlp INFIELD ooef111
            #add-point:ON ACTION controlp INFIELD ooef111
            {<point name="input.c.ooef111" />}
            #END add-point

         #----<<ooef112>>----
         #Ctrlp:input.c.ooef112
#         ON ACTION controlp INFIELD ooef112
            #add-point:ON ACTION controlp INFIELD ooef112
            {<point name="input.c.ooef112" />}
            #END add-point

         #----<<ooef113>>----
         #Ctrlp:input.c.ooef113
#         ON ACTION controlp INFIELD ooef113
            #add-point:ON ACTION controlp INFIELD ooef113
            {<point name="input.c.ooef113" />}
            #END add-point

         #----<<ooef114>>----
         #Ctrlp:input.c.ooef114
#         ON ACTION controlp INFIELD ooef114
            #add-point:ON ACTION controlp INFIELD ooef114
            {<point name="input.c.ooef114" />}
            #END add-point

         #----<<ooef120>>----
         #Ctrlp:input.c.ooef120
#         ON ACTION controlp INFIELD ooef120
            #add-point:ON ACTION controlp INFIELD ooef120
            {<point name="input.c.ooef120" />}
            #END add-point

         #----<<ooef121>>----
         #Ctrlp:input.c.ooef121
#         ON ACTION controlp INFIELD ooef121
            #add-point:ON ACTION controlp INFIELD ooef121
            {<point name="input.c.ooef121" />}
            #END add-point

         #----<<ooef122>>----
         #Ctrlp:input.c.ooef122
#         ON ACTION controlp INFIELD ooef122
            #add-point:ON ACTION controlp INFIELD ooef122
            {<point name="input.c.ooef122" />}
            #END add-point

         #----<<ooef123>>----
         #Ctrlp:input.c.ooef123
         ON ACTION controlp INFIELD ooef123
            #add-point:ON ACTION controlp INFIELD ooef123
#此段落由子樣板a07產生
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_ooef_m.ooef123             #給予default值

            #給予arg
            LET g_qryparam.arg1 = g_ooef_m.ooef001 #

            CALL q_inaa001_23()                                #呼叫開窗

            LET g_ooef_m.ooef123 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_ooef_m.ooef123 TO ooef123              #顯示到畫面上
            call arti100_ooef123_ref()
            NEXT FIELD ooef123                          #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #----<<ooef124>>----
         #Ctrlp:input.c.ooef124
         ON ACTION controlp INFIELD ooef124
            #add-point:ON ACTION controlp INFIELD ooef124
#此段落由子樣板a07產生
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_ooef_m.ooef124             #給予default值

            #給予arg
            LET g_qryparam.arg1 = g_ooef_m.ooef001 #

            CALL q_inaa001_23()                                #呼叫開窗

            LET g_ooef_m.ooef124 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_ooef_m.ooef124 TO ooef124              #顯示到畫面上
            call arti100_ooef123_ref()
            NEXT FIELD ooef124                          #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #----<<ooef125>>----
         #Ctrlp:input.c.ooef125
         ON ACTION controlp INFIELD ooef125
            #add-point:ON ACTION controlp INFIELD ooef125
#此段落由子樣板a07產生
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_ooef_m.ooef125             #給予default值

            #給予arg
            LET g_qryparam.arg1 = g_ooef_m.ooef001 #

            CALL q_inaa001_23()                                #呼叫開窗

            LET g_ooef_m.ooef125 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_ooef_m.ooef125 TO ooef125              #顯示到畫面上
            call arti100_ooef125_ref()
            NEXT FIELD ooef125                          #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #----<<ooefownid>>----
         #----<<ooefowndp>>----
         #----<<ooefcrtid>>----
         #----<<ooefcrtdp>>----
         #----<<ooefcrtdt>>----
         #----<<ooefmodid>>----
         #----<<ooefmoddt>>----
         #----<<ooef014>>----
         #Ctrlp:input.c.ooef014
         ON ACTION controlp INFIELD ooef014
            #add-point:ON ACTION controlp INFIELD ooef014
#此段落由子樣板a07產生
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_ooef_m.ooef014             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "10" #

            CALL q_ooal002_0()                                #呼叫開窗

            LET g_ooef_m.ooef014 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_ooef_m.ooef014 TO ooef014              #顯示到畫面上
            call arti100_ooef014_ref()
            NEXT FIELD ooef014                          #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #----<<ooef016>>----
         #Ctrlp:input.c.ooef016
         ON ACTION controlp INFIELD ooef016
            #add-point:ON ACTION controlp INFIELD ooef016
#此段落由子樣板a07產生
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_ooef_m.ooef016             #給予default值

            #給予arg
            LET g_qryparam.where = " ooaj001 = '",g_ooef_m.ooef014,"' " #幣別參照表編號

            CALL q_ooaj002()                                #呼叫開窗

            LET g_ooef_m.ooef016 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_ooef_m.ooef016 TO ooef016              #顯示到畫面上
            call arti100_ooef016_ref()
            NEXT FIELD ooef016                          #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #----<<ooef004>>----
         #Ctrlp:input.c.ooef004
         ON ACTION controlp INFIELD ooef004
            #add-point:ON ACTION controlp INFIELD ooef004
#此段落由子樣板a07產生
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_ooef_m.ooef004             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "3" #

            CALL q_ooal002_0()                                #呼叫開窗

            LET g_ooef_m.ooef004 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_ooef_m.ooef004 TO ooef004              #顯示到畫面上
            call arti100_ooef004_ref()
            NEXT FIELD ooef004                          #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #----<<ooef005>>----
         #Ctrlp:input.c.ooef005
#         ON ACTION controlp INFIELD ooef005
            #add-point:ON ACTION controlp INFIELD ooef005
            {<point name="input.c.ooef005" />}
            #END add-point

         #----<<ooef015>>----
         #Ctrlp:input.c.ooef015
         ON ACTION controlp INFIELD ooef015
            #add-point:ON ACTION controlp INFIELD ooef015
#此段落由子樣板a07產生
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_ooef_m.ooef015             #給予default值

            #給予arg

            CALL q_ooal002_3()                                #呼叫開窗

            LET g_ooef_m.ooef015 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_ooef_m.ooef015 TO ooef015              #顯示到畫面上
            CALL arti100_ooef015_ref()
            NEXT FIELD ooef015                          #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #----<<ooef006>>----
         #Ctrlp:input.c.ooef006
         ON ACTION controlp INFIELD ooef006
            #add-point:ON ACTION controlp INFIELD ooef006
#此段落由子樣板a07產生
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_ooef_m.ooef006             #給予default值

            #給予arg

            CALL q_oocg001()                                #呼叫開窗

            LET g_ooef_m.ooef006 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_ooef_m.ooef006 TO ooef006              #顯示到畫面上
            call arti100_ooef006_ref()
            NEXT FIELD ooef006                          #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #----<<ooef018>>----
         #Ctrlp:input.c.ooef018
         ON ACTION controlp INFIELD ooef018
            #add-point:ON ACTION controlp INFIELD ooef018
#此段落由子樣板a07產生
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_ooef_m.ooef018             #給予default值

            #給予arg

            CALL q_gzot001_1()                                #呼叫開窗

            LET g_ooef_m.ooef018 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_ooef_m.ooef018 TO ooef018              #顯示到畫面上
            call arti100_ooef018_ref()
            NEXT FIELD ooef018                          #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #----<<ooef019>>----
         #Ctrlp:input.c.ooef019
         ON ACTION controlp INFIELD ooef019
            #add-point:ON ACTION controlp INFIELD ooef019
#此段落由子樣板a07產生
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_ooef_m.ooef019             #給予default值

            #給予arg

            CALL q_ooal002_11()                                #呼叫開窗

            LET g_ooef_m.ooef019 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_ooef_m.ooef019 TO ooef019              #顯示到畫面上
            call arti100_ooef019_ref()
            NEXT FIELD ooef019                          #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #----<<ooef007>>----
         #Ctrlp:input.c.ooef007
#         ON ACTION controlp INFIELD ooef007
            #add-point:ON ACTION controlp INFIELD ooef007
            {<point name="input.c.ooef007" />}
            #END add-point

         #----<<ooef020>>----
         #Ctrlp:input.c.ooef020
#         ON ACTION controlp INFIELD ooef020
            #add-point:ON ACTION controlp INFIELD ooef020
            {<point name="input.c.ooef020" />}
            #END add-point

         #----<<ooef022>>----
         #Ctrlp:input.c.ooef022
#         ON ACTION controlp INFIELD ooef022
            #add-point:ON ACTION controlp INFIELD ooef022
            {<point name="input.c.ooef022" />}
            #END add-point

         #----<<ooef008>>----
         #Ctrlp:input.c.ooef008
         ON ACTION controlp INFIELD ooef008
            #add-point:ON ACTION controlp INFIELD ooef008
#此段落由子樣板a07產生
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_ooef_m.ooef008             #給予default值

            #給予arg

            CALL q_ooal002_5()                                #呼叫開窗

            LET g_ooef_m.ooef008 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_ooef_m.ooef008 TO ooef008              #顯示到畫面上
            call arti100_ooef008_ref()
            NEXT FIELD ooef008                          #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #----<<ooef010>>----
         #Ctrlp:input.c.ooef010
#         ON ACTION controlp INFIELD ooef010
            #add-point:ON ACTION controlp INFIELD ooef010
            {<point name="input.c.ooef010" />}
            #END add-point

         #----<<ooef011>>----
         #Ctrlp:input.c.ooef011
#         ON ACTION controlp INFIELD ooef011
            #add-point:ON ACTION controlp INFIELD ooef011
            {<point name="input.c.ooef011" />}
            #END add-point

         #----<<ooef013>>----
         #Ctrlp:input.c.ooef013
#         ON ACTION controlp INFIELD ooef013
            #add-point:ON ACTION controlp INFIELD ooef013
            {<point name="input.c.ooef013" />}
            #END add-point

         #----<<ooef023>>----
         #Ctrlp:input.c.ooef023
#         ON ACTION controlp INFIELD ooef023
            #add-point:ON ACTION controlp INFIELD ooef023
            {<point name="input.c.ooef023" />}
            #END add-point

         #----<<ooef024>>----
         #Ctrlp:input.c.ooef024
         ON ACTION controlp INFIELD ooef024
            #add-point:ON ACTION controlp INFIELD ooef024
#此段落由子樣板a07產生
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_ooef_m.ooef024             #給予default值

            #給予arg

            CALL q_pmaa001()                                #呼叫開窗

            LET g_ooef_m.ooef024 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_ooef_m.ooef024 TO ooef024              #顯示到畫面上
            call arti100_ooef024_ref()
            NEXT FIELD ooef024                          #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #dongsz--add--str---
         #----<<ooef026>>----
         #Ctrlp:input.c.ooef026
         ON ACTION controlp INFIELD ooef026
            #add-point:ON ACTION controlp INFIELD ooef026
#此段落由子樣板a07產生
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_ooef_m.ooef026             #給予default值
            LET g_qryparam.default2 = g_ooef_m.ooef026_desc        #給予default值

            #給予arg
            LET g_qryparam.arg1 = g_ooef_m.ooef001

            CALL q_nmas002_3()                                #呼叫開窗

            LET g_ooef_m.ooef026 = g_qryparam.return1              #將開窗取得的值回傳到變數
            LET g_ooef_m.ooef026_desc = g_qryparam.return2              #將開窗取得的值回傳到變數

            DISPLAY g_ooef_m.ooef026 TO ooef026              #顯示到畫面上
            DISPLAY g_ooef_m.ooef026_desc TO ooef026_desc
            CALL arti100_ooef026_ref()
            NEXT FIELD ooef026                          #返回原欄位

          {#ADP版次:1#}
         #dongsz--add--end---

         #----<<ooef150>>----
         #Ctrlp:input.c.ooef150
         ON ACTION controlp INFIELD ooef150
            #add-point:ON ACTION controlp INFIELD ooef150
#此段落由子樣板a07產生
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_ooef_m.ooef150             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "2077" #

            CALL q_oocq002_4()                                #呼叫開窗

            LET g_ooef_m.ooef150 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_ooef_m.ooef150 TO ooef150              #顯示到畫面上
            call arti100_ooef150_ref()
            NEXT FIELD ooef150                          #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #----<<ooef151>>----
         #Ctrlp:input.c.ooef151
         ON ACTION controlp INFIELD ooef151
            #add-point:ON ACTION controlp INFIELD ooef151
#此段落由子樣板a07產生
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_ooef_m.ooef151             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "2078" #

            CALL q_oocq002_4()                                #呼叫開窗

            LET g_ooef_m.ooef151 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_ooef_m.ooef151 TO ooef151              #顯示到畫面上
            call arti100_ooef151_ref()
            NEXT FIELD ooef151                          #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #----<<ooef152>>----
         #Ctrlp:input.c.ooef152
         ON ACTION controlp INFIELD ooef152
            #add-point:ON ACTION controlp INFIELD ooef152
#此段落由子樣板a07產生
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_ooef_m.ooef152             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "2079" #

            CALL q_oocq002_4()                                #呼叫開窗

            LET g_ooef_m.ooef152 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_ooef_m.ooef152 TO ooef152              #顯示到畫面上
            call arti100_ooef152_ref()
            NEXT FIELD ooef152                          #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #----<<ooef153>>----
         #Ctrlp:input.c.ooef153
         ON ACTION controlp INFIELD ooef153
            #add-point:ON ACTION controlp INFIELD ooef153
#此段落由子樣板a07產生
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_ooef_m.ooef153             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "2080" #

            CALL q_oocq002_4()                                #呼叫開窗

            LET g_ooef_m.ooef153 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_ooef_m.ooef153 TO ooef153              #顯示到畫面上
            call arti100_ooef153_ref()
            NEXT FIELD ooef153                          #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #----<<ooef154>>----
         #Ctrlp:input.c.ooef154
         ON ACTION controlp INFIELD ooef154
            #add-point:ON ACTION controlp INFIELD ooef154
#此段落由子樣板a07產生
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_ooef_m.ooef154             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "2081" #

            CALL q_oocq002_4()                                #呼叫開窗

            LET g_ooef_m.ooef154 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_ooef_m.ooef154 TO ooef154              #顯示到畫面上
            call arti100_ooef154_ref()
            NEXT FIELD ooef154                          #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #----<<ooef155>>----
         #Ctrlp:input.c.ooef155
         ON ACTION controlp INFIELD ooef155
            #add-point:ON ACTION controlp INFIELD ooef155
#此段落由子樣板a07產生
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_ooef_m.ooef155             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "2082" #

            CALL q_oocq002_4()                                #呼叫開窗

            LET g_ooef_m.ooef155 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_ooef_m.ooef155 TO ooef155              #顯示到畫面上
            call arti100_ooef155_ref()
            NEXT FIELD ooef155                          #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #----<<ooef156>>----
         #Ctrlp:input.c.ooef156
         ON ACTION controlp INFIELD ooef156
            #add-point:ON ACTION controlp INFIELD ooef156
#此段落由子樣板a07產生
            #開窗i段
			   INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			   LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_ooef_m.ooef156      #給予default值
            CALL q_dbac001()                                #呼叫開窗

            LET g_ooef_m.ooef156 = g_qryparam.return1       #將開窗取得的值回傳到變數

            DISPLAY g_ooef_m.ooef156 TO ooef156             #顯示到畫面上
            LET g_ooef_m.ooef156_desc = s_desc_get_dbad002_desc(g_ooef_m.ooef156)
            DISPLAY BY NAME g_ooef_m.ooef156_desc
            NEXT FIELD ooef156                          #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #----<<ooef157>>----
         #Ctrlp:input.c.ooef157
         ON ACTION controlp INFIELD ooef157
            #add-point:ON ACTION controlp INFIELD ooef157
#此段落由子樣板a07產生
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_ooef_m.ooef157             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "2084" #

            CALL q_oocq002_4()                                #呼叫開窗

            LET g_ooef_m.ooef157 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_ooef_m.ooef157 TO ooef157              #顯示到畫面上
            call arti100_ooef157_ref()
            NEXT FIELD ooef157                          #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #----<<ooef158>>----
         #Ctrlp:input.c.ooef158
         ON ACTION controlp INFIELD ooef158
            #add-point:ON ACTION controlp INFIELD ooef158
#此段落由子樣板a07產生
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_ooef_m.ooef158             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "2085" #

            CALL q_oocq002_4()                                #呼叫開窗

            LET g_ooef_m.ooef158 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_ooef_m.ooef158 TO ooef158              #顯示到畫面上
            call arti100_ooef158_ref()
            NEXT FIELD ooef158                          #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #----<<ooef159>>----
         #Ctrlp:input.c.ooef159
         ON ACTION controlp INFIELD ooef159
            #add-point:ON ACTION controlp INFIELD ooef159
#此段落由子樣板a07產生
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_ooef_m.ooef159             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "2086" #

            CALL q_oocq002_4()                                #呼叫開窗

            LET g_ooef_m.ooef159 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_ooef_m.ooef159 TO ooef159              #顯示到畫面上
            call arti100_ooef159_ref()
            NEXT FIELD ooef159                          #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #----<<ooef160>>----
         #Ctrlp:input.c.ooef160
         ON ACTION controlp INFIELD ooef160
            #add-point:ON ACTION controlp INFIELD ooef160
#此段落由子樣板a07產生
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_ooef_m.ooef160             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "2087" #

            CALL q_oocq002_4()                                #呼叫開窗

            LET g_ooef_m.ooef160 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_ooef_m.ooef160 TO ooef160              #顯示到畫面上
            call arti100_ooef160_ref()
            NEXT FIELD ooef160                          #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #----<<ooef161>>----
         #Ctrlp:input.c.ooef161
         ON ACTION controlp INFIELD ooef161
            #add-point:ON ACTION controlp INFIELD ooef161
#此段落由子樣板a07產生
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_ooef_m.ooef161             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "2088" #

            CALL q_oocq002_4()                                #呼叫開窗

            LET g_ooef_m.ooef161 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_ooef_m.ooef161 TO ooef161              #顯示到畫面上
            call arti100_ooef161_ref()
            NEXT FIELD ooef161                          #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #----<<ooef162>>----
         #Ctrlp:input.c.ooef162
         ON ACTION controlp INFIELD ooef162
            #add-point:ON ACTION controlp INFIELD ooef162
#此段落由子樣板a07產生
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_ooef_m.ooef162             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "2089" #

            CALL q_oocq002_4()                                #呼叫開窗

            LET g_ooef_m.ooef162 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_ooef_m.ooef162 TO ooef162              #顯示到畫面上
            call arti100_ooef162_ref()
            NEXT FIELD ooef162                          #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #----<<ooef163>>----
         #Ctrlp:input.c.ooef163
         ON ACTION controlp INFIELD ooef163
            #add-point:ON ACTION controlp INFIELD ooef163
#此段落由子樣板a07產生
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_ooef_m.ooef163             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "2090" #

            CALL q_oocq002_4()                                #呼叫開窗

            LET g_ooef_m.ooef163 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_ooef_m.ooef163 TO ooef163              #顯示到畫面上
            call arti100_ooef163_ref()
            NEXT FIELD ooef163                          #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #----<<ooef164>>----
         #Ctrlp:input.c.ooef164
         ON ACTION controlp INFIELD ooef164
            #add-point:ON ACTION controlp INFIELD ooef164
#此段落由子樣板a07產生
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_ooef_m.ooef164             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "2091" #

            CALL q_oocq002_4()                                #呼叫開窗

            LET g_ooef_m.ooef164 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_ooef_m.ooef164 TO ooef164              #顯示到畫面上
            call arti100_ooef164_ref()
            NEXT FIELD ooef164                          #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #----<<ooef165>>----
         #Ctrlp:input.c.ooef165
         ON ACTION controlp INFIELD ooef165
            #add-point:ON ACTION controlp INFIELD ooef165
#此段落由子樣板a07產生
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_ooef_m.ooef165             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "2092" #

            CALL q_oocq002_4()                                #呼叫開窗

            LET g_ooef_m.ooef165 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_ooef_m.ooef165 TO ooef165              #顯示到畫面上
            call arti100_ooef165_ref()
            NEXT FIELD ooef165                          #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #----<<ooef166>>----
         #Ctrlp:input.c.ooef166
         ON ACTION controlp INFIELD ooef166
            #add-point:ON ACTION controlp INFIELD ooef166
#此段落由子樣板a07產生
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_ooef_m.ooef166             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "2093" #

            CALL q_oocq002_4()                                #呼叫開窗

            LET g_ooef_m.ooef166 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_ooef_m.ooef166 TO ooef166              #顯示到畫面上
            call arti100_ooef166_ref()
            NEXT FIELD ooef166                          #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #----<<ooef167>>----
         #Ctrlp:input.c.ooef167
         ON ACTION controlp INFIELD ooef167
            #add-point:ON ACTION controlp INFIELD ooef167
#此段落由子樣板a07產生
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_ooef_m.ooef167             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "2094" #

            CALL q_oocq002_4()                                #呼叫開窗

            LET g_ooef_m.ooef167 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_ooef_m.ooef167 TO ooef167              #顯示到畫面上
            call arti100_ooef167_ref()
            NEXT FIELD ooef167                          #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #----<<ooef168>>----
         #Ctrlp:input.c.ooef168
         ON ACTION controlp INFIELD ooef168
            #add-point:ON ACTION controlp INFIELD ooef168
#此段落由子樣板a07產生
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_ooef_m.ooef168             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "2095" #

            CALL q_oocq002_4()                                #呼叫開窗

            LET g_ooef_m.ooef168 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_ooef_m.ooef168 TO ooef168              #顯示到畫面上
            call arti100_ooef168_ref()
            NEXT FIELD ooef168                          #返回原欄位

          {#ADP版次:1#}
            #END add-point

         #----<<ooef169>>----
         #Ctrlp:input.c.ooef169
         ON ACTION controlp INFIELD ooef169
            #add-point:ON ACTION controlp INFIELD ooef169
#此段落由子樣板a07產生
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_ooef_m.ooef169             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "2096" #

            CALL q_oocq002_4()                                #呼叫開窗

            LET g_ooef_m.ooef169 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_ooef_m.ooef169 TO ooef169              #顯示到畫面上
            call arti100_ooef169_ref()
            NEXT FIELD ooef169                          #返回原欄位

          {#ADP版次:1#}
            #END add-point

 #欄位開窗

         AFTER INPUT
            IF INT_FLAG THEN
               EXIT DIALOG
            END IF

            CALL cl_showmsg()   #錯誤訊息統整顯示

            IF p_cmd <> "u" THEN
               LET l_count = 1

               SELECT COUNT(*) INTO l_count FROM ooef_t
                WHERE ooefent = g_enterprise AND ooef001 = g_ooef_m.ooef001

               IF l_count = 0 THEN

                  #add-point:單頭新增前
                  
#                  IF g_ooef_m.ooef003<>'Y' THEN
##                     INITIALIZE g_errparam TO NULL
##                     LET g_errparam.code = "art-00209"
##                     LET g_errparam.extend = g_ooef_m.ooef001
##                     LET g_errparam.popup = TRUE
##                     CALL cl_err()
##
##                     NEXT FIELD ooef017
#                  ELSE
#                     LET g_ooef_m.ooef017 = g_ooef_m.ooef001
#                  END IF                             {#ADP版次:1#}
                  
                  IF cl_null(g_ooef_m.ooef012) THEN
                     LET l_success = ''
                     CALL s_aooi350_ins_oofa('3',g_ooef_m.ooef001,'') RETURNING l_success,g_ooef_m.ooef012
                     IF NOT l_success THEN
                        INITIALIZE g_errparam TO NULL
                        LET g_errparam.code = SQLCA.sqlcode
                        LET g_errparam.extend = "oofa_t"
                        LET g_errparam.popup = TRUE
                        CALL cl_err()

                        CONTINUE DIALOG
                     END IF
                     LET g_pmaa027_d = g_ooef_m.ooef012
                  END IF
                  #end add-point

                  INSERT INTO ooef_t (ooefent,ooefunit,ooef001,ooef003,ooef017,ooef101,ooef105,ooef102,ooef103,
                                      ooef100,ooefstus,ooef104,ooef106,ooef108,ooef107,ooef109,ooef110,ooef115,ooef116,
                                      ooef111,ooef112,ooef113,ooef114,ooef120,ooef121,ooef122,ooef123,
                                      ooef124,ooef125,ooefownid,ooefowndp,ooefcrtid,ooefcrtdp,ooefcrtdt,
                                      ooefmodid,ooefmoddt,ooef014,ooef016,ooef004,ooef005,ooef015,ooef006,
                                      ooef018,ooef019,ooef007,ooef020,ooef022,ooef008,ooef010,ooef011,
                                      ooef013,ooef023,ooef024,ooef026,ooef150,ooef151,ooef152,ooef153,ooef154,
                                      ooef155,ooef156,ooef157,ooef158,ooef159,ooef160,ooef161,ooef162,
                                      ooef163,ooef164,ooef165,ooef166,ooef167,ooef168,ooef169,ooef012,
                                      ooef201,ooef202,ooef203,ooef204,ooef205,ooef206,ooef207,
                                      ooef208,ooef209,ooef210,ooef211,ooef212,ooef301,ooef302,ooef303,ooef304,ooef305)
                  VALUES (g_enterprise,g_ooef_m.ooefunit,g_ooef_m.ooef001,g_ooef_m.ooef003,g_ooef_m.ooef017,g_ooef_m.ooef101,g_ooef_m.ooef105,g_ooef_m.ooef102,g_ooef_m.ooef103,
                         g_ooef_m.ooef100,g_ooef_m.ooefstus,g_ooef_m.ooef104,g_ooef_m.ooef106,g_ooef_m.ooef108,g_ooef_m.ooef107,g_ooef_m.ooef109,g_ooef_m.ooef110,g_ooef_m.ooef115,g_ooef_m.ooef116,
                         g_ooef_m.ooef111,g_ooef_m.ooef112,g_ooef_m.ooef113,g_ooef_m.ooef114,g_ooef_m.ooef120,g_ooef_m.ooef121,g_ooef_m.ooef122,g_ooef_m.ooef123,
                         g_ooef_m.ooef124,g_ooef_m.ooef125,g_ooef_m.ooefownid,g_ooef_m.ooefowndp,g_ooef_m.ooefcrtid,g_ooef_m.ooefcrtdp,g_ooef_m.ooefcrtdt,g_ooef_m.ooefmodid,
                         g_ooef_m.ooefmoddt,g_ooef_m.ooef014,g_ooef_m.ooef016,g_ooef_m.ooef004,g_ooef_m.ooef005,g_ooef_m.ooef015,g_ooef_m.ooef006,g_ooef_m.ooef018,
                         g_ooef_m.ooef019,g_ooef_m.ooef007,g_ooef_m.ooef020,g_ooef_m.ooef022,g_ooef_m.ooef008,g_ooef_m.ooef010,g_ooef_m.ooef011,g_ooef_m.ooef013,
                         g_ooef_m.ooef023,g_ooef_m.ooef024,g_ooef_m.ooef026,g_ooef_m.ooef150,g_ooef_m.ooef151,g_ooef_m.ooef152,g_ooef_m.ooef153,g_ooef_m.ooef154,g_ooef_m.ooef155,g_ooef_m.ooef156,
                         g_ooef_m.ooef157,g_ooef_m.ooef158,g_ooef_m.ooef159,g_ooef_m.ooef160,g_ooef_m.ooef161,g_ooef_m.ooef162,g_ooef_m.ooef163,g_ooef_m.ooef164,g_ooef_m.ooef165,
                         g_ooef_m.ooef166,g_ooef_m.ooef167,g_ooef_m.ooef168,g_ooef_m.ooef169,g_ooef_m.ooef012,'Y','N','N','N','N','N','N','Y','N','N','N','N','N','N','N','Y','N')

                  #add-point:單頭新增中
                  {<point name="input.head.m_insert"/>}
                  #end add-point

                  IF SQLCA.sqlcode THEN
                     INITIALIZE g_errparam TO NULL
                     LET g_errparam.code = SQLCA.sqlcode
                     LET g_errparam.extend = "ooef_t"
                     LET g_errparam.popup = TRUE
                     CALL cl_err()

                     CONTINUE DIALOG
                  END IF



                  #資料多語言用-增/改
                           INITIALIZE l_var_keys TO NULL 
         INITIALIZE l_field_keys TO NULL 
         INITIALIZE l_vars TO NULL 
         INITIALIZE l_fields TO NULL 
         IF g_ooef_m.ooef001 = g_master_multi_table_t.ooefl001 AND
         g_ooef_m.ooefl003 = g_master_multi_table_t.ooefl003 AND 
         g_ooef_m.ooefl004 = g_master_multi_table_t.ooefl004 AND 
         g_ooef_m.ooefl006 = g_master_multi_table_t.ooefl006 AND 
         g_ooef_m.ooefl005 = g_master_multi_table_t.ooefl005  THEN
         ELSE 
            LET l_var_keys[01] = g_ooef_m.ooef001
            LET l_field_keys[01] = 'ooefl001'
            LET l_var_keys_bak[01] = g_master_multi_table_t.ooefl001
            LET l_var_keys[02] = g_dlang
            LET l_field_keys[02] = 'ooefl002'
            LET l_var_keys_bak[02] = g_dlang
            LET l_vars[01] = g_ooef_m.ooefl003
            LET l_fields[01] = 'ooefl003'
            LET l_vars[02] = g_ooef_m.ooefl004
            LET l_fields[02] = 'ooefl004'
            LET l_vars[03] = g_ooef_m.ooefl004
            LET l_fields[03] = 'ooefl006'
            LET l_vars[04] = g_ooef_m.ooefl005
            LET l_fields[04] = 'ooefl005'
            LET l_vars[05] = g_enterprise 
            LET l_fields[05] = 'ooeflent'
            CALL cl_multitable(l_var_keys,l_field_keys,l_vars,l_fields,l_var_keys_bak,'ooefl_t')
         END IF 


                  #add-point:單頭新增後
                  {<point name="input.head.a_insert"/>}
                  #end add-point

                  CALL s_transaction_end('Y','0')
               ELSE
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code =  "std-00006"
                  LET g_errparam.extend =  "g_ooef_m.ooef001"
                  LET g_errparam.popup = FALSE
                  CALL cl_err()

                  CALL s_transaction_end('N','0')
               END IF
            ELSE
               #add-point:單頭修改前
               {<point name="input.head.b_update" mark="Y"/>}
               #end add-point
               UPDATE ooef_t SET (ooefunit,ooef001,ooef003,ooef017,ooef101,ooef105,ooef102,ooef103,
                                  ooef100,ooefstus,ooef104,ooef106,ooef108,ooef107,ooef109,ooef110,
                                  ooef115,ooef116,ooef111,ooef112,ooef113,ooef114,ooef120,ooef121,ooef122,
                                  ooef123,ooef124,ooef125,ooefownid,ooefowndp,ooefcrtid,ooefcrtdp,
                                  ooefcrtdt,ooefmodid,ooefmoddt,ooef014,ooef016,ooef004,ooef005,
                                  ooef015,ooef006,ooef018,ooef019,ooef007,ooef020,ooef022,ooef008,
                                  ooef010,ooef011,ooef013,ooef023,ooef024,ooef026,ooef150,ooef151,ooef152,
                                  ooef153,ooef154,ooef155,ooef156,ooef157,ooef158,ooef159,ooef160,
                                  ooef161,ooef162,ooef163,ooef164,ooef165,ooef166,ooef167,ooef168,
                                  ooef169) = (g_ooef_m.ooefunit,g_ooef_m.ooef001,g_ooef_m.ooef003,g_ooef_m.ooef017,g_ooef_m.ooef101,g_ooef_m.ooef105,g_ooef_m.ooef102,g_ooef_m.ooef103,
                                  g_ooef_m.ooef100,g_ooef_m.ooefstus,g_ooef_m.ooef104,g_ooef_m.ooef106,g_ooef_m.ooef108,g_ooef_m.ooef107,g_ooef_m.ooef109,g_ooef_m.ooef110,
                                  g_ooef_m.ooef115,g_ooef_m.ooef116,g_ooef_m.ooef111,g_ooef_m.ooef112,g_ooef_m.ooef113,g_ooef_m.ooef114,g_ooef_m.ooef120,g_ooef_m.ooef121,g_ooef_m.ooef122,
                                  g_ooef_m.ooef123,g_ooef_m.ooef124,g_ooef_m.ooef125,g_ooef_m.ooefownid,g_ooef_m.ooefowndp,g_ooef_m.ooefcrtid,g_ooef_m.ooefcrtdp,
                                  g_ooef_m.ooefcrtdt,g_ooef_m.ooefmodid,g_ooef_m.ooefmoddt,g_ooef_m.ooef014,g_ooef_m.ooef016,g_ooef_m.ooef004,g_ooef_m.ooef005,g_ooef_m.ooef015,g_ooef_m.ooef006,g_ooef_m.ooef018,g_ooef_m.ooef019,g_ooef_m.ooef007,g_ooef_m.ooef020,g_ooef_m.ooef022,g_ooef_m.ooef008,g_ooef_m.ooef010,g_ooef_m.ooef011,g_ooef_m.ooef013,g_ooef_m.ooef023,g_ooef_m.ooef024,g_ooef_m.ooef026,g_ooef_m.ooef150,g_ooef_m.ooef151,g_ooef_m.ooef152,g_ooef_m.ooef153,g_ooef_m.ooef154,g_ooef_m.ooef155,g_ooef_m.ooef156,g_ooef_m.ooef157,g_ooef_m.ooef158,g_ooef_m.ooef159,g_ooef_m.ooef160,g_ooef_m.ooef161,g_ooef_m.ooef162,g_ooef_m.ooef163,g_ooef_m.ooef164,g_ooef_m.ooef165,g_ooef_m.ooef166,g_ooef_m.ooef167,g_ooef_m.ooef168,g_ooef_m.ooef169)
                WHERE ooefent = g_enterprise AND ooef001 = g_ooef001_t #

               #add-point:單頭修改中
               {<point name="input.head.m_update"/>}
               #end add-point
               CASE
                  WHEN SQLCA.sqlerrd[3] = 0  #更新不到的處理
                     INITIALIZE g_errparam TO NULL
                     LET g_errparam.code = "std-00009"
                     LET g_errparam.extend = "ooef_t"
                     LET g_errparam.popup = TRUE
                     CALL cl_err()

                     CALL s_transaction_end('N','0')
                  WHEN SQLCA.sqlcode #其他錯誤
                     INITIALIZE g_errparam TO NULL
                     LET g_errparam.code = SQLCA.sqlcode
                     LET g_errparam.extend = "ooef_t"
                     LET g_errparam.popup = TRUE
                     CALL cl_err()

                     CALL s_transaction_end('N','0')
                  OTHERWISE

                     #資料多語言用-增/改
                              INITIALIZE l_var_keys TO NULL 
         INITIALIZE l_field_keys TO NULL 
         INITIALIZE l_vars TO NULL 
         INITIALIZE l_fields TO NULL 
         IF g_ooef_m.ooef001 = g_master_multi_table_t.ooefl001 AND
         g_ooef_m.ooefl003 = g_master_multi_table_t.ooefl003 AND 
         g_ooef_m.ooefl004 = g_master_multi_table_t.ooefl004 AND 
         g_ooef_m.ooefl006 = g_master_multi_table_t.ooefl006 AND 
         g_ooef_m.ooefl005 = g_master_multi_table_t.ooefl005  THEN
         ELSE 
            LET l_var_keys[01] = g_ooef_m.ooef001
            LET l_field_keys[01] = 'ooefl001'
            LET l_var_keys_bak[01] = g_master_multi_table_t.ooefl001
            LET l_var_keys[02] = g_dlang
            LET l_field_keys[02] = 'ooefl002'
            LET l_var_keys_bak[02] = g_dlang
            LET l_vars[01] = g_ooef_m.ooefl003
            LET l_fields[01] = 'ooefl003'
            LET l_vars[02] = g_ooef_m.ooefl004
            LET l_fields[02] = 'ooefl004'
            LET l_vars[03] = g_ooef_m.ooefl004
            LET l_fields[03] = 'ooefl006'
            LET l_vars[04] = g_ooef_m.ooefl005
            LET l_fields[04] = 'ooefl005'
            LET l_vars[05] = g_enterprise 
            LET l_fields[05] = 'ooeflent'
            CALL cl_multitable(l_var_keys,l_field_keys,l_vars,l_fields,l_var_keys_bak,'ooefl_t')
         END IF 

                     #add-point:單頭修改後
                     {<point name="input.head.a_update"/>}
                     IF g_ooef_m.ooef003 = 'Y' THEN
                        IF NOT arti100_change_ooef017() THEN
                           CALL s_transaction_end('N','0')
                        END IF
                     END IF
                     IF NOT cl_null(g_ooef_m.ooef012) THEN
                        LET g_pmaa027_d = g_ooef_m.ooef012
                        CALL aooi350_01_b_fill(g_pmaa027_d)
                        CALL aooi350_02_b_fill(g_pmaa027_d)
                     END IF
                     #end add-point
                     CALL s_transaction_end('Y','0')
               END CASE
            END IF
            LET g_ooef001_t = g_ooef_m.ooef001
           #controlp
      END INPUT

      #add-point:input段more input
      {<point name="input.more_input"/>}
      SUBDIALOG aoo_aooi350_01.aooi350_01_input
      SUBDIALOG aoo_aooi350_02.aooi350_02_input
      BEFORE DIALOG
         #為了修改功能doubleClick可以直接進入單身,需指定要進入哪一個單身
         IF NOT cl_null(p_cmd) AND p_cmd != 'a' THEN
            CASE g_aw
               WHEN "s_detail1_aooi350_01"
                  NEXT FIELD oofbstus
               WHEN "s_detail1_aooi350_02"
                  NEXT FIELD oofcstus
               OTHERWISE
                  NEXT FIELD ooefunit
            END CASE
         END IF

         IF p_cmd = 'a' THEN
            NEXT FIELD ooefunit
         END IF
         
      AFTER DIALOG 
         CALL s_transaction_begin()
         CALL arti100_upd_ooef156()
         CALL s_transaction_end('Y',0)
                  
      #end add-point
		
      ON ACTION controlf
         CALL cl_set_focus_form(ui.Interface.getRootNode()) RETURNING g_fld_name,g_frm_name
         CALL cl_fldhelp(g_frm_name, g_fld_name, g_lang)

      ON ACTION controlr
         CALL cl_show_req_fields()

      ON ACTION controls
         CALL cl_set_head_visible("","AUTO")

      ON ACTION accept
         ACCEPT DIALOG

      ON ACTION cancel      #在dialog button (放棄)
         LET g_action_choice=""
         LET INT_FLAG = TRUE
         EXIT DIALOG

      ON ACTION close       #在dialog 右上角 (X)
         LET INT_FLAG = TRUE
         EXIT DIALOG

      ON ACTION exit        #toolbar 離開
         LET INT_FLAG = TRUE
         EXIT DIALOG

      #交談指令共用ACTION
      &include "common_action.4gl"
         CONTINUE DIALOG
   END DIALOG

   #add-point:input段after input
   {<point name="input.after_input"/>}
   #end add-point

END FUNCTION]]>
  </point>
  <point name="function.arti100_reproduce" order="52" ver="5" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION arti100_reproduce()
   {<Local define>}
   DEFINE l_newno     LIKE ooef_t.ooef001
   DEFINE l_oldno     LIKE ooef_t.ooef001

   DEFINE l_master    RECORD LIKE ooef_t.*
   DEFINE l_cnt       LIKE type_t.num5
   DEFINE l_insert    LIKE type_t.num5
   {</Local define>}

   #add-point:reproduce段define
   {<point name="reproduce.define"/>}
   #end add-point

   #切換畫面
   IF g_main_hidden THEN
      CALL gfrm_curr.setElementHidden("mainlayout",0)
      CALL gfrm_curr.setElementHidden("worksheet",1)
      LET g_main_hidden = 0
   END IF

   IF g_ooef_m.ooef001 IS NULL

   THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = "std-00003"
      LET g_errparam.extend = ""
      LET g_errparam.popup = FALSE
      CALL cl_err()

      RETURN
   END IF

   LET g_ooef001_t = g_ooef_m.ooef001


   LET g_ooef_m.ooef001 = ""


   CALL arti100_set_entry("a")
   CALL arti100_set_no_entry("a")

   #公用欄位給予預設值
   #此段落由子樣板a14產生
      LET g_ooef_m.ooefownid = g_user
      LET g_ooef_m.ooefowndp = g_dept
      LET g_ooef_m.ooefcrtid = g_user
      LET g_ooef_m.ooefcrtdp = g_dept
      LET g_ooef_m.ooefcrtdt = cl_get_current()
      LET g_ooef_m.ooefmodid = ""
      LET g_ooef_m.ooefmoddt = ""
      #LET g_ooef_m.ooefstus = ""
         


   #add-point:複製輸入前
   LET g_ooef_m.ooefstus = "Y"          {#ADP版次:1#}
   LET g_pmaa027_d = ''
   CALL s_aooi500_default(g_prog,'ooefunit',g_ooef_m.ooefunit)
      RETURNING l_insert,g_ooef_m.ooefunit
   IF NOT l_insert THEN
      RETURN
   END IF
   LET g_ooef_m.ooef012 = ''
   LET g_ooef_m.ooef005 = ''
   LET g_ooef_m_t.ooef005 = ''
   #先給預設語言別 简体    # add by geza 201504030
   LET g_ooef_m.ooef116 = "zh_CN" 
   CALL aooi350_01_clear_detail()
   CALL aooi350_02_clear_detail()
   #end add-point

   CALL arti100_input("r")

      LET g_ooef_m.ooef001_desc = ''
   DISPLAY BY NAME g_ooef_m.ooef001_desc


   IF INT_FLAG  THEN
      LET INT_FLAG = 0
      RETURN
   END IF

   CALL s_transaction_begin()

   #add-point:單頭複製前
   {<point name="reproduce.head.b_insert" mark="Y"/>}
   #end add-point

   #add-point:單頭複製中
   {<point name="reproduce.head.m_insert"/>}
   #end add-point

   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "ooef_t"
      LET g_errparam.popup = TRUE
      CALL cl_err()

      CALL s_transaction_end('N','0')
      RETURN
   END IF

   #add-point:單頭複製後
   {<point name="reproduce.head.a_insert"/>}
   #end add-point

   CALL s_transaction_end('Y','0')

   LET g_state = "Y"

   LET g_wc = g_wc,
              " OR (",
              " ooef001 = '", g_ooef_m.ooef001 CLIPPED, "' "

              , ") "

   LET g_ooef001_t = g_ooef_m.ooef001


   #add-point:完成複製段落後
   {<point name="reproduce.after_reproduce" />}
   #end add-point

END FUNCTION]]>
  </point>
  <point name="function.arti100_show" order="53" ver="5" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION arti100_show()
   #add-point:show段define
   {<point name="show.define"/>}
   #end add-point
   DEFINE l_nmaa001   LIKE nmaa_t.nmaa001
   #add-point:show段之前
   {<point name="show.before"/>}
   #end add-point



   LET g_ooef_m_t.* = g_ooef_m.*      #保存單頭舊值

   #在browser 移動上下筆可以連動切換資料
   CALL cl_show_fld_cont()

   #帶出公用欄位reference值
   #此段落由子樣板a12產生
      #LET g_ooef_m.ooefownid_desc = cl_get_username(g_ooef_m.ooefownid)
      #LET g_ooef_m.ooefowndp_desc = cl_get_deptname(g_ooef_m.ooefowndp)
      #LET g_ooef_m.ooefcrtid_desc = cl_get_username(g_ooef_m.ooefcrtid)
      #LET g_ooef_m.ooefcrtdp_desc = cl_get_deptname(g_ooef_m.ooefcrtdp)
      #LET g_ooef_m.ooefmodid_desc = cl_get_username(g_ooef_m.ooefmodid)
      ##LET g_ooef_m.ooefcnfid_desc = cl_get_deptname(g_ooef_m.ooefcnfid)
      ##LET g_ooef_m.ooefpstid_desc = cl_get_deptname(g_ooef_m.ooefpstid)




   #讀入ref值(單頭)
   #add-point:show段reference
            SELECT ooed005 INTO g_ooef_m.ooed005 FROM ooed_t
             WHERE ooedent = g_enterprise AND ooed001='2'
               AND ooed004 = g_ooef_m.ooef001 AND rownum = 1
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_ooef_m.ooed005
            CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_ooef_m.ooed005_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_ooef_m.ooed005_desc   

            CALL arti100_ooef001_desc(g_ooef_m.ooef001) RETURNING g_ooef_m.ooefl003,g_ooef_m.ooefl004,g_ooef_m.ooefl005,g_ooef_m.ooefl006
            DISPLAY BY NAME g_ooef_m.ooefl003,g_ooef_m.ooefl004,g_ooef_m.ooefl005,g_ooef_m.ooefl006
            call arti100_ooef018_ref()
            call arti100_ooefunit_ref()

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_ooef_m.ooef017
            CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_ooef_m.ooef017_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_ooef_m.ooef017_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_ooef_m.ooef104
            CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='2076' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_ooef_m.ooef104_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_ooef_m.ooef104_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_ooef_m.ooef105
            CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_ooef_m.ooef105_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_ooef_m.ooef105_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_ooef_m.ooef106
            CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_ooef_m.ooef106_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_ooef_m.ooef106_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_ooef_m.ooef108
            CALL ap_ref_array2(g_ref_fields,"SELECT pmaal003 FROM pmaal_t WHERE pmaalent='"||g_enterprise||"' AND pmaal001=? AND pmaal002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_ooef_m.ooef108_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_ooef_m.ooef108_desc

            CALL arti100_ooef123_ref()
            CALL arti100_ooef124_ref()
            CALL arti100_ooef125_ref()            

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_ooef_m.ooefownid
            CALL ap_ref_array2(g_ref_fields,"SELECT ooag011 FROM ooag_t WHERE ooagent='"||g_enterprise||"' AND ooag001=? ","") RETURNING g_rtn_fields
            LET g_ooef_m.ooefownid_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_ooef_m.ooefownid_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_ooef_m.ooefowndp
            CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_ooef_m.ooefowndp_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_ooef_m.ooefowndp_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_ooef_m.ooefcrtid
            CALL ap_ref_array2(g_ref_fields,"SELECT ooag011 FROM ooag_t WHERE ooagent='"||g_enterprise||"' AND ooag001=? ","") RETURNING g_rtn_fields
            LET g_ooef_m.ooefcrtid_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_ooef_m.ooefcrtid_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_ooef_m.ooefcrtdp
            CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_ooef_m.ooefcrtdp_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_ooef_m.ooefcrtdp_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_ooef_m.ooefmodid
            CALL ap_ref_array2(g_ref_fields,"SELECT ooag011 FROM ooag_t WHERE ooagent='"||g_enterprise||"' AND ooag001=? ","") RETURNING g_rtn_fields
            LET g_ooef_m.ooefmodid_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_ooef_m.ooefmodid_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_ooef_m.ooef004
            CALL ap_ref_array2(g_ref_fields,"SELECT ooall004 FROM ooall_t WHERE ooallent='"||g_enterprise||"' AND ooall001='3' AND ooall002=? AND ooall003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_ooef_m.ooef004_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_ooef_m.ooef004_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_ooef_m.ooef014
            CALL ap_ref_array2(g_ref_fields,"SELECT ooall004 FROM ooall_t WHERE ooallent='"||g_enterprise||"' AND ooall001='10' AND ooall002=? AND ooall003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_ooef_m.ooef014_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_ooef_m.ooef014_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_ooef_m.ooef016
            CALL ap_ref_array2(g_ref_fields,"SELECT ooail003 FROM ooail_t WHERE ooailent='"||g_enterprise||"' AND ooail001=? AND ooail002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_ooef_m.ooef016_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_ooef_m.ooef016_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_ooef_m.ooef006
            CALL ap_ref_array2(g_ref_fields,"SELECT oocgl003 FROM oocgl_t WHERE oocglent='"||g_enterprise||"' AND oocgl001=? AND oocgl002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_ooef_m.ooef006_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_ooef_m.ooef006_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_ooef_m.ooef008
            CALL ap_ref_array2(g_ref_fields,"SELECT ooall004 FROM ooall_t WHERE ooallent='"||g_enterprise||"' AND ooall001='4' AND ooall002=? AND ooall003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_ooef_m.ooef008_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_ooef_m.ooef008_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_ooef_m.ooef010
            CALL ap_ref_array2(g_ref_fields,"SELECT gzcbl004 FROM gzcbl_t WHERE gzcbl001='25' AND gzcbl002=? AND gzcbl003='"||g_lang||"'","") RETURNING g_rtn_fields
            LET g_ooef_m.ooef010_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_ooef_m.ooef010_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_ooef_m.ooef015
            CALL ap_ref_array2(g_ref_fields,"SELECT ooall004 FROM ooall_t WHERE ooallent='"||g_enterprise||"' AND ooall001='1' AND ooall002=? AND ooall003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_ooef_m.ooef015_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_ooef_m.ooef015_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_ooef_m.ooef019
            CALL ap_ref_array2(g_ref_fields,"SELECT ooall004 FROM ooall_t WHERE ooallent='"||g_enterprise||"' AND ooall001='2' AND ooall002=? AND ooall003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_ooef_m.ooef019_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_ooef_m.ooef019_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_ooef_m.ooef024
            CALL ap_ref_array2(g_ref_fields,"SELECT pmaal003 FROM pmaal_t WHERE pmaalent='"||g_enterprise||"' AND pmaal001=? AND pmaal002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_ooef_m.ooef024_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_ooef_m.ooef024_desc
            
            #dongsz--add--str---
            INITIALIZE g_ref_fields TO NULL
            SELECT nmaa001 INTO l_nmaa001
              FROM nmaa_t,nmas_t
             WHERE nmaaent = nmasent
               AND nmaa001 = nmas001
               AND nmaaent = g_enterprise
               AND nmas002 = g_ooef_m.ooef026
            LET g_ref_fields[1] = l_nmaa001
            CALL ap_ref_array2(g_ref_fields,
                               "SELECT nmaal003 FROM nmaal_t WHERE nmaalent='"||g_enterprise||"' AND nmaal001=? AND nmaal002='"||g_dlang||"'",
                               "")
                 RETURNING g_rtn_fields
            LET g_ooef_m.ooef026_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_ooef_m.ooef026_desc
            #dongsz--add--end---

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_ooef_m.ooef150
            CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='2077' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_ooef_m.ooef150_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_ooef_m.ooef150_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_ooef_m.ooef151
            CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='2078' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_ooef_m.ooef151_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_ooef_m.ooef151_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_ooef_m.ooef152
            CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='2079' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_ooef_m.ooef152_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_ooef_m.ooef152_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_ooef_m.ooef153
            CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='2080' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_ooef_m.ooef153_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_ooef_m.ooef153_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_ooef_m.ooef154
            CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='2081' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_ooef_m.ooef154_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_ooef_m.ooef154_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_ooef_m.ooef155
            CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='2082' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_ooef_m.ooef155_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_ooef_m.ooef155_desc

            LET g_ooef_m.ooef156_desc = s_desc_get_dbad002_desc(g_ooef_m.ooef156)
            DISPLAY BY NAME g_ooef_m.ooef156,g_ooef_m.ooef156_desc
            
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_ooef_m.ooef157
            CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='2084' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_ooef_m.ooef157_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_ooef_m.ooef157_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_ooef_m.ooef158
            CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='2085' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_ooef_m.ooef158_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_ooef_m.ooef158_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_ooef_m.ooef159
            CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='2086' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_ooef_m.ooef159_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_ooef_m.ooef159_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_ooef_m.ooef160
            CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='2087' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_ooef_m.ooef160_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_ooef_m.ooef160_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_ooef_m.ooef161
            CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='2088' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_ooef_m.ooef161_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_ooef_m.ooef161_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_ooef_m.ooef162
            CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='2089' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_ooef_m.ooef162_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_ooef_m.ooef162_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_ooef_m.ooef163
            CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='2090' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_ooef_m.ooef163_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_ooef_m.ooef163_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_ooef_m.ooef164
            CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='2091' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_ooef_m.ooef164_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_ooef_m.ooef164_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_ooef_m.ooef165
            CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='2092' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_ooef_m.ooef165_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_ooef_m.ooef165_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_ooef_m.ooef166
            CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='2093' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_ooef_m.ooef166_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_ooef_m.ooef166_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_ooef_m.ooef167
            CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='2094' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_ooef_m.ooef167_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_ooef_m.ooef167_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_ooef_m.ooef168
            CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='2095' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_ooef_m.ooef168_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_ooef_m.ooef168_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_ooef_m.ooef169
            CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='2096' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_ooef_m.ooef169_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_ooef_m.ooef169_desc
          {#ADP版次:1#}
   #end add-point

   #將資料輸出到畫面上
   DISPLAY BY NAME g_ooef_m.ooefunit,g_ooef_m.ooefunit_desc,g_ooef_m.ooef001,g_ooef_m.ooefl003,g_ooef_m.ooefl004,g_ooef_m.ooefl006,g_ooef_m.ooefl005,g_ooef_m.ooef001_desc,
   g_ooef_m.ooef003,g_ooef_m.ooef017,g_ooef_m.ooef017_desc,g_ooef_m.ooef101,g_ooef_m.ooed005,g_ooef_m.ooed005_desc,g_ooef_m.ooef105,g_ooef_m.ooef105_desc,g_ooef_m.ooef102,
   g_ooef_m.ooef103,g_ooef_m.ooef100,g_ooef_m.ooefstus,g_ooef_m.ooef104,g_ooef_m.ooef104_desc,g_ooef_m.ooef106,g_ooef_m.ooef106_desc,g_ooef_m.ooef108,g_ooef_m.ooef108_desc,
   g_ooef_m.ooef107,g_ooef_m.ooef109,g_ooef_m.ooef110,g_ooef_m.ooef115,g_ooef_m.ooef116,g_ooef_m.ooef111,g_ooef_m.ooef112,g_ooef_m.ooef113,g_ooef_m.ooef114,g_ooef_m.ooef120,g_ooef_m.ooef121,
   g_ooef_m.ooef122,g_ooef_m.ooef123,g_ooef_m.ooef123_desc,g_ooef_m.ooef124,g_ooef_m.ooef124_desc,g_ooef_m.ooef125,g_ooef_m.ooef125_desc,g_ooef_m.ooefownid,g_ooef_m.ooefownid_desc,
   g_ooef_m.ooefowndp,g_ooef_m.ooefowndp_desc,g_ooef_m.ooefcrtid,g_ooef_m.ooefcrtid_desc,g_ooef_m.ooefcrtdp,g_ooef_m.ooefcrtdp_desc,g_ooef_m.ooefcrtdt,g_ooef_m.ooefmodid,
   g_ooef_m.ooefmodid_desc,g_ooef_m.ooefmoddt,g_ooef_m.ooef014,g_ooef_m.ooef014_desc,g_ooef_m.ooef016,g_ooef_m.ooef016_desc,g_ooef_m.ooef004,g_ooef_m.ooef004_desc,g_ooef_m.ooef005,
   g_ooef_m.ooef015,g_ooef_m.ooef015_desc,g_ooef_m.ooef006,g_ooef_m.ooef006_desc,g_ooef_m.ooef018,g_ooef_m.ooef018_desc,g_ooef_m.ooef019,g_ooef_m.ooef019_desc,g_ooef_m.ooef007,
   g_ooef_m.ooef020,g_ooef_m.ooef022,g_ooef_m.ooef008,g_ooef_m.ooef008_desc,g_ooef_m.ooef010,g_ooef_m.ooef010_desc,g_ooef_m.ooef011,g_ooef_m.ooef013,g_ooef_m.ooef023,g_ooef_m.ooef024,
   g_ooef_m.ooef024_desc,g_ooef_m.ooef026,g_ooef_m.ooef026_desc,g_ooef_m.ooef150,g_ooef_m.ooef150_desc,g_ooef_m.ooef151,g_ooef_m.ooef151_desc,g_ooef_m.ooef152,g_ooef_m.ooef152_desc,g_ooef_m.ooef153,g_ooef_m.ooef153_desc,
   g_ooef_m.ooef154,g_ooef_m.ooef154_desc,g_ooef_m.ooef155,g_ooef_m.ooef155_desc,g_ooef_m.ooef156,g_ooef_m.ooef156_desc,g_ooef_m.ooef157,g_ooef_m.ooef157_desc,g_ooef_m.ooef158,g_ooef_m.ooef158_desc,
   g_ooef_m.ooef159,g_ooef_m.ooef159_desc,g_ooef_m.ooef160,g_ooef_m.ooef160_desc,g_ooef_m.ooef161,g_ooef_m.ooef161_desc,g_ooef_m.ooef162,g_ooef_m.ooef162_desc,g_ooef_m.ooef163,g_ooef_m.ooef163_desc,
   g_ooef_m.ooef164,g_ooef_m.ooef164_desc,g_ooef_m.ooef165,g_ooef_m.ooef165_desc,g_ooef_m.ooef166,g_ooef_m.ooef166_desc,g_ooef_m.ooef167,g_ooef_m.ooef167_desc,g_ooef_m.ooef168,g_ooef_m.ooef168_desc,
   g_ooef_m.ooef169,g_ooef_m.ooef169_desc

   #顯示狀態(stus)圖片
         #此段落由子樣板a21產生
      CASE g_ooef_m.ooefstus
         WHEN "N"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/inactive.png")
         WHEN "Y"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/active.png")


		
      END CASE



   #add-point:show段之後
   {<point name="show.after"/>}
   IF NOT cl_null(g_ooef_m.ooef012) THEN
      LET g_pmaa027_d = g_ooef_m.ooef012
      CALL aooi350_01_b_fill(g_pmaa027_d)
      CALL aooi350_02_b_fill(g_pmaa027_d)
   END IF
   #end add-point

END FUNCTION]]>
  </point>
  <point name="function.arti100_delete" order="54" ver="3" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION arti100_delete()
   {<Local define>}
   DEFINE  l_var_keys      DYNAMIC ARRAY OF STRING
   DEFINE  l_field_keys    DYNAMIC ARRAY OF STRING
   DEFINE  l_vars          DYNAMIC ARRAY OF STRING
   DEFINE  l_fields        DYNAMIC ARRAY OF STRING
   DEFINE  l_var_keys_bak  DYNAMIC ARRAY OF STRING
   {</Local define>}
   #add-point:delete段define
   {<point name="delete.define"/>}
   #end add-point

   IF g_ooef_m.ooef001 IS NULL

   THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = "std-00003"
      LET g_errparam.extend = ""
      LET g_errparam.popup = FALSE
      CALL cl_err()

      RETURN
   END IF

   CALL s_transaction_begin()

   LET g_ooef001_t = g_ooef_m.ooef001
   LET g_master_multi_table_t.ooefl001 = g_ooef_m.ooef001
LET g_master_multi_table_t.ooefl003 = g_ooef_m.ooefl003
LET g_master_multi_table_t.ooefl004 = g_ooef_m.ooefl004
LET g_master_multi_table_t.ooefl006 = g_ooef_m.ooefl006
LET g_master_multi_table_t.ooefl005 = g_ooef_m.ooefl005



   OPEN arti100_cl USING g_enterprise,
                           g_ooef_m.ooef001

   IF STATUS THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code =  STATUS
      LET g_errparam.extend = "OPEN arti100_cl:"
      LET g_errparam.popup = FALSE
      CALL cl_err()

      CLOSE arti100_cl
      CALL s_transaction_end('N','0')
      RETURN
   END IF
   

   FETCH arti100_cl INTO g_ooef_m.ooefunit,g_ooef_m.ooefunit_desc,g_ooef_m.ooef001,g_ooef_m.ooef001_desc,g_ooef_m.ooef003,g_ooef_m.ooef017,g_ooef_m.ooef017_desc,g_ooef_m.ooef101,g_ooef_m.ooed005,g_ooef_m.ooed005_desc,g_ooef_m.ooef105,g_ooef_m.ooef105_desc,g_ooef_m.ooef102,g_ooef_m.ooef103,g_ooef_m.ooef100,g_ooef_m.ooefstus,g_ooef_m.ooef104,g_ooef_m.ooef104_desc,g_ooef_m.ooef106,g_ooef_m.ooef106_desc,g_ooef_m.ooef108,g_ooef_m.ooef108_desc,g_ooef_m.ooef107,g_ooef_m.ooef109,g_ooef_m.ooef110,g_ooef_m.ooef115,g_ooef_m.ooef111,g_ooef_m.ooef112,g_ooef_m.ooef113,g_ooef_m.ooef114,g_ooef_m.ooef120,g_ooef_m.ooef121,g_ooef_m.ooef122,g_ooef_m.ooef123,g_ooef_m.ooef123_desc,g_ooef_m.ooef124,g_ooef_m.ooef124_desc,g_ooef_m.ooef125,g_ooef_m.ooef125_desc,g_ooef_m.ooefownid,g_ooef_m.ooefownid_desc,g_ooef_m.ooefowndp,g_ooef_m.ooefowndp_desc,g_ooef_m.ooefcrtid,g_ooef_m.ooefcrtid_desc,g_ooef_m.ooefcrtdp,g_ooef_m.ooefcrtdp_desc,g_ooef_m.ooefcrtdt,g_ooef_m.ooefmodid,g_ooef_m.ooefmodid_desc,g_ooef_m.ooefmoddt,g_ooef_m.ooef014,g_ooef_m.ooef014_desc,g_ooef_m.ooef016,g_ooef_m.ooef016_desc,g_ooef_m.ooef004,g_ooef_m.ooef004_desc,g_ooef_m.ooef005,g_ooef_m.ooef015,g_ooef_m.ooef015_desc,g_ooef_m.ooef006,g_ooef_m.ooef006_desc,g_ooef_m.ooef018,g_ooef_m.ooef018_desc,g_ooef_m.ooef019,g_ooef_m.ooef019_desc,g_ooef_m.ooef007,g_ooef_m.ooef020,g_ooef_m.ooef022,g_ooef_m.ooef008,g_ooef_m.ooef008_desc,g_ooef_m.ooef010,g_ooef_m.ooef010_desc,g_ooef_m.ooef011,g_ooef_m.ooef013,g_ooef_m.ooef023,g_ooef_m.ooef024,g_ooef_m.ooef024_desc,g_ooef_m.ooef026,g_ooef_m.ooef026_desc,g_ooef_m.ooef150,g_ooef_m.ooef150_desc,g_ooef_m.ooef151,g_ooef_m.ooef151_desc,g_ooef_m.ooef152,g_ooef_m.ooef152_desc,g_ooef_m.ooef153,g_ooef_m.ooef153_desc,g_ooef_m.ooef154,g_ooef_m.ooef154_desc,g_ooef_m.ooef155,g_ooef_m.ooef155_desc,g_ooef_m.ooef156,g_ooef_m.ooef156_desc,g_ooef_m.ooef157,g_ooef_m.ooef157_desc,g_ooef_m.ooef158,g_ooef_m.ooef158_desc,g_ooef_m.ooef159,g_ooef_m.ooef159_desc,g_ooef_m.ooef160,g_ooef_m.ooef160_desc,g_ooef_m.ooef161,g_ooef_m.ooef161_desc,g_ooef_m.ooef162,g_ooef_m.ooef162_desc,g_ooef_m.ooef163,g_ooef_m.ooef163_desc,g_ooef_m.ooef164,g_ooef_m.ooef164_desc,g_ooef_m.ooef165,g_ooef_m.ooef165_desc,g_ooef_m.ooef166,g_ooef_m.ooef166_desc,g_ooef_m.ooef167,g_ooef_m.ooef167_desc,g_ooef_m.ooef168,g_ooef_m.ooef168_desc,g_ooef_m.ooef169,g_ooef_m.ooef169_desc
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = g_ooef_m.ooef001
      LET g_errparam.popup = FALSE
      CALL cl_err()

      RETURN
   END IF

   CALL arti100_show()
   IF cl_ask_delete() THEN
      INITIALIZE g_doc.* TO NULL
      LET g_doc.column1 = "ooef001"
      LET g_doc.value1 = g_ooef_m.ooef001
#      CALL cl_del_doc()

      #add-point:單頭刪除前
      {<point name="delete.head.b_delete" mark="Y"/>}
      #end add-point

      DELETE FROM ooef_t
       WHERE ooefent = g_enterprise AND ooef001 = g_ooef_m.ooef001


      #add-point:單頭刪除中
      {<point name="delete.head.m_delete"/>}
      #end add-point

      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "ooef_t"
         LET g_errparam.popup = FALSE
         CALL cl_err()

         CALL s_transaction_end('N','0')
      END IF

      INITIALIZE l_var_keys_bak TO NULL 
      INITIALIZE l_field_keys   TO NULL 
      LET l_var_keys_bak[01] = g_master_multi_table_t.ooefl001
      LET l_field_keys[01] = 'ooefl001'
      CALL cl_multitable_delete(l_field_keys,l_var_keys_bak,'ooefl_t')

      #add-point:單頭刪除後
      {<point name="delete.head.a_delete"/>}
      IF NOT cl_null(g_ooef_m.ooef012) THEN
         IF NOT s_aooi350_del(g_ooef_m.ooef012) THEN
            INITIALIZE g_errparam TO NULL
            LET g_errparam.code = SQLCA.sqlcode
            LET g_errparam.extend = "oofa_t"
            LET g_errparam.popup = FALSE
            CALL cl_err()

            CALL s_transaction_end('N','0')
            RETURN
         END IF
      END IF
      #end add-point



      CLEAR FORM
      CALL arti100_ui_browser_refresh()
      IF g_browser_cnt > 0 THEN
         CALL arti100_fetch("P")
      ELSE
         CALL arti100_browser_fill(" 1=1 ","F")
      END IF

   END IF

   CLOSE arti100_cl
   CALL s_transaction_end('Y','0')

   #流程通知預埋點-D
   CALL cl_flow_notify(g_ooef_m.ooef001,"D")

END FUNCTION]]>
  </point>
  <point name="function.arti100_ui_browser_refresh" order="55" ver="3" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION arti100_ui_browser_refresh()
   {<Local define>}
   DEFINE l_i  LIKE type_t.num10
   {</Local define>}

   #add-point:ui_browser_refresh段define
   {<point name="ui_browser_refresh.define"/>}
   #end add-point

   FOR l_i =1 TO g_browser.getLength()
      IF g_browser[l_i].b_ooef001 = g_ooef_m.ooef001 THEN
         CALL g_browser.deleteElement(l_i)
         LET g_header_cnt = g_header_cnt - 1
       END IF
   END FOR

   DISPLAY g_header_cnt TO FORMONLY.b_count     #page count
   DISPLAY g_header_cnt TO FORMONLY.h_count     #page count
   LET g_browser_cnt = g_browser_cnt-1
   IF g_current_idx > g_browser_cnt THEN        #確定browse 筆數指在同一筆
      LET g_current_idx = g_browser_cnt
   END IF

END FUNCTION]]>
  </point>
  <point name="function.arti100_set_entry" order="56" ver="3" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION arti100_set_entry(p_cmd)

   {<Local define>}
   DEFINE p_cmd LIKE type_t.chr1
   {</Local define>}

   #add-point:set_entry段define
   {<point name="set_entry.define"/>}
   #end add-point

   IF p_cmd = "a" THEN
      CALL cl_set_comp_entry("ooef001",TRUE)
      #add-point:set_entry段欄位控制
      {<point name="set_entry.field_control"/>}
      CALL cl_set_comp_entry("ooefunit",TRUE)
      #end add-point
   END IF

   #add-point:set_entry段欄位控制後
   {<point name="set_entry.after_control"/>}
   CALL cl_set_comp_entry("ooef022,ooef017",TRUE) 
   CALL cl_set_comp_entry("ooef007,ooef020,ooef022,ooef011,ooef013,ooef023,ooef014,ooef016,ooef015,ooef006,ooef018,ooef019", TRUE)
   CALL cl_set_comp_entry("ooef156",TRUE)
   #end add-point

END FUNCTION]]>
  </point>
  <point name="function.arti100_set_no_entry" order="57" ver="3" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION arti100_set_no_entry(p_cmd)

   {<Local define>}
   DEFINE p_cmd LIKE type_t.chr1
   DEFINE l_ooef003 LIKE type_t.num5
   DEFINE l_n   LIKE type_t.num5
   {</Local define>}
   
   #add-point:set_no_entry段define
   {<point name="set_no_entry.define"/>}
   #end add-point

   IF p_cmd = "u" THEN
      CALL cl_set_comp_entry("ooef001",FALSE)
      #add-point:set_no_entry段欄位控制
      {<point name="set_no_entry.field_control"/>}
      #end add-point
   END IF

   #add-point:set_no_entry段欄位控制後
   {<point name="set_no_entry.after_control"/>}
   IF g_ooef_m.ooef003<>'Y' THEN 
      CALL cl_set_comp_entry("ooef022",FALSE)
      CALL cl_set_comp_entry("ooef0017",TRUE)
   ELSE
      CALL cl_set_comp_entry("ooef022",TRUE)
      CALL cl_set_comp_entry("ooef017",false)      
   END IF
   IF g_ooef_m.ooef003 = 'Y' THEN
      CALL cl_set_comp_entry('ooef017', FALSE)
      LET g_ooef_m.ooef017 = g_ooef_m.ooef001
      let g_ooef_m_o.ooef017 = g_ooef_m.ooef017
      DISPLAY BY NAME g_ooef_m.ooef017
      CALL arti100_ooef017_ref()
   ELSE
      CALL cl_set_comp_entry("ooef007,ooef020,ooef022,ooef011,ooef013,ooef023,ooef014,ooef016,ooef015,ooef006,ooef018,ooef019",FALSE)
   END IF
   
   LET l_n = 0 
   SELECT COUNT(*) INTO l_n FROM glap_t WHERE glapent = g_enterprise AND glapcomp = g_ooef_m.ooef001
   IF l_n > 0 THEN
      CALL cl_set_comp_entry("ooef016",FALSE)
   END IF
   
   IF NOT s_aooi500_comp_entry(g_prog,'ooefunit') OR g_site_flag THEN
      CALL cl_set_comp_entry("ooefunit",FALSE)
   END IF
   
   LET l_n = 0 
   SELECT COUNT(*) INTO l_n
     FROM oofb_t
    WHERE oofbent = g_enterprise
      AND oofb002 = g_ooef_m.ooef012
      AND oofb008 = '3'
      AND oofb010 = 'Y'
      AND COALESCE(oofb022,'-1') <> '-1'    #取代IS NOT NULL 的寫法
   IF l_n > 0 THEN
      CALL cl_set_comp_entry("ooef156",FALSE)
   END IF      
   #end add-point

END FUNCTION]]>
  </point>
  <point name="function.arti100_default_search" order="58" ver="3" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION arti100_default_search()
   {<Local define>}
   DEFINE li_idx  LIKE type_t.num5
   DEFINE li_cnt  LIKE type_t.num5
   DEFINE ls_wc   STRING
   {</Local define>}
   #add-point:default_search段define
   {<point name="default_search.define"/>}
   #end add-point

   #add-point:default_search段開始前
   {<point name="default_search.before"/>}
   #end add-point

   LET g_pagestart = 1
   IF cl_null(g_order) THEN
      LET g_order = "ASC"
   END IF
   IF NOT cl_null(g_argv[1]) THEN
      LET ls_wc = ls_wc, " ooef001 = '", g_argv[1], "' AND "
   END IF



   IF NOT cl_null(ls_wc) THEN
      LET g_wc = ls_wc.subString(1,ls_wc.getLength()-5)
   ELSE
      IF cl_null(g_wc) THEN
         LET g_wc = " 1=1"
      END IF
   END IF

   #add-point:default_search段結束前
   {<point name="default_search.after"/>}
   #end add-point

END FUNCTION]]>
  </point>
  <point name="function.arti100_statechange" order="59" ver="7" cite_std="N" new="Y" status="u" src="s" readonly="" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION arti100_statechange()
   {<Local define>}
   DEFINE lc_state LIKE type_t.chr5
   {</Local define>}
   #add-point:statechange段define
   {<point name="statechange.define"/>}
   #end add-point

   #add-point:statechange段開始前
   {<point name="statechange.before"/>}
   #end add-point

   ERROR ""     #清空畫面右下側ERROR區塊

   IF g_ooef_m.ooef001 IS NULL

   THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = "std-00003"
      LET g_errparam.extend = ""
      LET g_errparam.popup = FALSE
      CALL cl_err()

      RETURN
   END IF

   MENU "" ATTRIBUTES (STYLE="popup")
      BEFORE MENU
         CASE g_ooef_m.ooefstus
            WHEN "N"
               HIDE OPTION "inactive"
            WHEN "Y"
               HIDE OPTION "active"


			
         END CASE

      #add-point:menu前
      {<point name="statechange.before_menu"/>}
      #end add-point
	
      ON ACTION inactive
         LET lc_state = "N"
         #add-point:action控制
         {<point name="statechange.inactive"/>}
         #end add-point
         EXIT MENU
      ON ACTION active
         LET lc_state = "Y"
         #add-point:action控制
         {<point name="statechange.active"/>}
         #end add-point
         EXIT MENU


	
	
	
      #add-point:stus控制
      {<point name="statechange.more_control"/>}
      #end add-point
	
   END MENU

   IF (lc_state <> "N"
      AND lc_state <> "Y"


      ) OR
      cl_null(lc_state) THEN
      RETURN
   END IF

   #add-point:stus修改前
   {<point name="statechange.b_update"/>}
   #end add-point

   UPDATE ooef_t SET ooefstus = lc_state
    WHERE ooefent = g_enterprise AND ooef001 = g_ooef_m.ooef001


   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = ""
      LET g_errparam.popup = FALSE
      CALL cl_err()

   ELSE
      CASE lc_state
         WHEN "N"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/inactive.png")
         WHEN "Y"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/active.png")


		
      END CASE
      LET g_ooef_m.ooefstus = lc_state
      DISPLAY BY NAME g_ooef_m.ooefstus
   END IF

   #add-point:stus修改後
   {<point name="statechange.a_update"/>}
   #150424-00018#3 15/06/17 by s983961--mark(s) 統一寫入function內
   #IF g_ooef_m.ooefstus <> 'Y' THEN
   #   CALL cl_set_act_visible("delete", FALSE)
   #ELSE
   #   CALL cl_set_act_visible("delete", TRUE) 
   #END IF   
   #150424-00018#3 15/06/17 by s983961--mark(e) 統一寫入function內
   #150424-00018#3 15/06/17 by s983961 add(s)  aoos010走申請流程控管
   CALL arti100_set_act_visible()
   CALL arti100_set_act_no_visible() 
   #150424-00018#3 15/06/17 by s983961 add(e)  aoos010走申請流程控管
   #end add-point

   #add-point:statechange段結束前
   {<point name="statechange.after"/>}
   #end add-point

END FUNCTION]]>
  </point>
  <point name="function.arti100_ooef001_desc" order="60" ver="3" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
###display ooef001
PRIVATE FUNCTION arti100_ooef001_desc(p_ooef001)
DEFINE p_ooef001      LIKE ooef_t.ooef001
DEFINE r_ooefl003     LIKE ooefl_t.ooefl003   
DEFINE r_ooefl004     LIKE ooefl_t.ooefl004 
DEFINE r_ooefl005     LIKE ooefl_t.ooefl005 
DEFINE r_ooefl006     LIKE ooefl_t.ooefl006
             INITIALIZE g_ref_fields TO NULL
             LET g_ref_fields[1] = p_ooef001
             CALL ap_ref_array2(g_ref_fields," SELECT ooefl003,ooefl004,ooefl005,ooefl006 FROM ooefl_t WHERE ooeflent = '" 
                 ||g_enterprise||"' AND ooefl001 = ? AND ooefl002 = '"||g_dlang||"'","") RETURNING g_rtn_fields
             LET r_ooefl003 ='', g_rtn_fields[1] , ''
             LET r_ooefl004 ='', g_rtn_fields[2] , ''
             LET r_ooefl005 ='', g_rtn_fields[3] , ''
             LET r_ooefl006 ='', g_rtn_fields[4] , ''
            RETURN r_ooefl003,r_ooefl004,r_ooefl005,r_ooefl006
END FUNCTION]]>
  </point>
  <point name="function.arti100_ooef017" order="61" ver="3" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
#chk ooef017
PRIVATE FUNCTION arti100_ooef017()
   DEFINE l_ooef003  LIKE ooef_t.ooef003
   DEFINE l_success  LIKE type_t.num5
   
   LET l_success = TRUE
   LET g_errno = NULL
   IF g_ooef_m.ooef003 = 'Y' THEN
      LET g_ooef_m.ooef017 = g_ooef_m.ooef001
   ELSE
      LET l_success = FALSE
   END IF
   RETURN  l_success  
END FUNCTION]]>
  </point>
  <point name="function.arti100_chk_ooef005" order="62" ver="3" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
##chk 單據別是否重複
PRIVATE FUNCTION arti100_chk_ooef005()
   DEFINE l_cnt  LIKE type_t.num5
   DEFINE l_success LIKE type_t.num5
   LET l_success = TRUE
   LET g_errno = NULL
   SELECT count(*) INTO l_cnt FROM ooef_t WHERE ooefent = g_enterprise
      AND ooef005 = g_ooef_m.ooef005
   IF l_cnt > 0 THEN
      LET l_success = FALSE
      LET g_errno = "aoo-00277"
      RETURN l_success
   END IF   
   RETURN l_success
END FUNCTION]]>
  </point>
  <point name="function.arti100_ooef017_empty" order="63" ver="3" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
##chk ooef017
PRIVATE FUNCTION arti100_ooef017_empty()
   LET g_ooef_m.ooef022 = ''   LET g_ooef_m.ooef014 = ''   LET g_ooef_m.ooef018 = '' 
   LET g_ooef_m.ooef007 = ''     LET g_ooef_m.ooef011 = ''   LET g_ooef_m.ooef016 = ''   LET g_ooef_m.ooef019 = '' 
   LET g_ooef_m.ooef020 = ''     LET g_ooef_m.ooef013 = ''   LET g_ooef_m.ooef015 = ''   LET g_ooef_m.ooef006_desc = '' 
   LET g_ooef_m.ooef023 = ''   LET g_ooef_m.ooef006 = ''   LET g_ooef_m.ooef014_desc = ''
   LET g_ooef_m.ooef015_desc = '' LET g_ooef_m.ooef016_desc = '' LET g_ooef_m.ooef018_desc = ''  LET g_ooef_m.ooef019_desc = '' 
   LET g_ooef_m.ooef017 = ''     LET g_ooef_m.ooef017_desc = ''
   DISPLAY BY NAME g_ooef_m.ooef007,g_ooef_m.ooef020,g_ooef_m.ooef022,g_ooef_m.ooef011,
                      g_ooef_m.ooef013,g_ooef_m.ooef023,g_ooef_m.ooef014,g_ooef_m.ooef016,g_ooef_m.ooef015,g_ooef_m.ooef006,
                      g_ooef_m.ooef018,g_ooef_m.ooef019,g_ooef_m.ooef006_desc,g_ooef_m.ooef014_desc,g_ooef_m.ooef015_desc,
                      g_ooef_m.ooef016_desc,g_ooef_m.ooef018_desc,g_ooef_m.ooef019_desc,g_ooef_m.ooef017,g_ooef_m.ooef017_desc
   LET g_ooef_m_o.ooef017 = g_ooef_m.ooef017                   
END FUNCTION]]>
  </point>
  <point name="function.arti100_ooef017_default" order="64" ver="3" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
#chk ooef017
PRIVATE FUNCTION arti100_ooef017_default()
   SELECT ooef007,ooef020,ooef022,ooef011,ooef013,ooef023,ooef014,ooef016,ooef015,ooef006,ooef018,ooef019
     INTO g_ooef_m.ooef007,g_ooef_m.ooef020,g_ooef_m.ooef022,g_ooef_m.ooef011,g_ooef_m.ooef013,
          g_ooef_m.ooef023,g_ooef_m.ooef014,g_ooef_m.ooef016,g_ooef_m.ooef015,g_ooef_m.ooef006,g_ooef_m.ooef018,g_ooef_m.ooef019
     FROM ooef_t WHERE ooefent = g_enterprise AND ooef001 = g_ooef_m.ooef017
   CALL arti100_ooef006_ref() 
   
   CALL arti100_ooef014_ref() 
  
   CALL arti100_ooef015_ref() 
 
   CALL arti100_ooef016_ref() 
   
   CALL arti100_ooef018_ref() 
   
   CALL arti100_ooef019_ref() 
END FUNCTION]]>
  </point>
  <point name="function.arti100_change_ooef017" order="65" ver="3" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
##change ooef017
PRIVATE FUNCTION arti100_change_ooef017()
   
   
   IF (g_ooef_m.ooef007 != g_ooef_m_t.ooef007) OR (NOT cl_null(g_ooef_m.ooef007) AND cl_null(g_ooef_m_t.ooef007)) OR (NOT cl_null(g_ooef_m_t.ooef007) AND cl_null(g_ooef_m.ooef007)) THEN
      IF NOT arti100_upd_ooef(g_ooef_m.ooef007,'ooef007') THEN
         RETURN FALSE
      END IF
   END IF
   
   IF (g_ooef_m.ooef020 != g_ooef_m_t.ooef020) OR (NOT cl_null(g_ooef_m.ooef020) AND cl_null(g_ooef_m_t.ooef020)) OR (NOT cl_null(g_ooef_m_t.ooef020) AND cl_null(g_ooef_m.ooef020)) THEN
      IF NOT arti100_upd_ooef(g_ooef_m.ooef020,'ooef020') THEN
         RETURN FALSE
      END IF
   END IF
   
   
   IF (g_ooef_m.ooef022 != g_ooef_m_t.ooef022) OR (NOT cl_null(g_ooef_m.ooef022) AND cl_null(g_ooef_m_t.ooef022)) OR (NOT cl_null(g_ooef_m_t.ooef022) AND cl_null(g_ooef_m.ooef022)) THEN
      IF NOT arti100_upd_ooef(g_ooef_m.ooef022,'ooef022') THEN
         RETURN FALSE
      END IF
   END IF
   
   IF (g_ooef_m.ooef011 != g_ooef_m_t.ooef011) OR (NOT cl_null(g_ooef_m.ooef011) AND cl_null(g_ooef_m_t.ooef011)) OR (NOT cl_null(g_ooef_m_t.ooef011) AND cl_null(g_ooef_m.ooef011)) THEN
      IF NOT arti100_upd_ooef(g_ooef_m.ooef011,'ooef011') THEN
         RETURN FALSE
      END IF
   END IF
   
   IF (g_ooef_m.ooef013 != g_ooef_m_t.ooef013) OR (NOT cl_null(g_ooef_m.ooef013) AND cl_null(g_ooef_m_t.ooef013)) OR (NOT cl_null(g_ooef_m_t.ooef013) AND cl_null(g_ooef_m.ooef013)) THEN
      IF NOT arti100_upd_ooef(g_ooef_m.ooef013,'ooef013') THEN
         RETURN FALSE
      END IF
   END IF
   
   IF (g_ooef_m.ooef023 != g_ooef_m_t.ooef023) OR (NOT cl_null(g_ooef_m.ooef023) AND cl_null(g_ooef_m_t.ooef023)) OR (NOT cl_null(g_ooef_m_t.ooef023) AND cl_null(g_ooef_m.ooef023)) THEN
      IF NOT arti100_upd_ooef(g_ooef_m.ooef023,'ooef023') THEN
         RETURN FALSE
      END IF
   END IF
   
   IF (g_ooef_m.ooef014 != g_ooef_m_t.ooef014) OR (NOT cl_null(g_ooef_m.ooef014) AND cl_null(g_ooef_m_t.ooef014)) OR (NOT cl_null(g_ooef_m_t.ooef014) AND cl_null(g_ooef_m.ooef014)) THEN
      IF NOT arti100_upd_ooef(g_ooef_m.ooef014,'ooef014') THEN
         RETURN FALSE
      END IF
   END IF
   
   IF (g_ooef_m.ooef016 != g_ooef_m_t.ooef016) OR (NOT cl_null(g_ooef_m.ooef016) AND cl_null(g_ooef_m_t.ooef016)) OR (NOT cl_null(g_ooef_m_t.ooef016) AND cl_null(g_ooef_m.ooef016)) THEN
      IF NOT arti100_upd_ooef(g_ooef_m.ooef016,'ooef016') THEN
         RETURN FALSE
      END IF
   END IF
   
   IF (g_ooef_m.ooef015 != g_ooef_m_t.ooef015) OR (NOT cl_null(g_ooef_m.ooef015) AND cl_null(g_ooef_m_t.ooef015)) OR (NOT cl_null(g_ooef_m_t.ooef015) AND cl_null(g_ooef_m.ooef015)) THEN
      IF NOT arti100_upd_ooef(g_ooef_m.ooef015,'ooef015') THEN
         RETURN FALSE
      END IF
   END IF
   
   IF (g_ooef_m.ooef006 != g_ooef_m_t.ooef006) OR (NOT cl_null(g_ooef_m.ooef006) AND cl_null(g_ooef_m_t.ooef006)) OR (NOT cl_null(g_ooef_m_t.ooef006) AND cl_null(g_ooef_m.ooef006)) THEN
      IF NOT arti100_upd_ooef(g_ooef_m.ooef006,'ooef006') THEN
         RETURN FALSE
      END IF
   END IF
   
   IF (g_ooef_m.ooef018 != g_ooef_m_t.ooef018) OR (NOT cl_null(g_ooef_m.ooef018) AND cl_null(g_ooef_m_t.ooef018)) OR (NOT cl_null(g_ooef_m_t.ooef018) AND cl_null(g_ooef_m.ooef018)) THEN
      IF NOT arti100_upd_ooef(g_ooef_m.ooef018,'ooef018') THEN
         RETURN FALSE
      END IF
   END IF
   
   IF (g_ooef_m.ooef019 != g_ooef_m_t.ooef019) OR (NOT cl_null(g_ooef_m.ooef019) AND cl_null(g_ooef_m_t.ooef019)) OR (NOT cl_null(g_ooef_m_t.ooef019) AND cl_null(g_ooef_m.ooef019)) THEN
      IF NOT arti100_upd_ooef(g_ooef_m.ooef019,'ooef019') THEN
         RETURN FALSE
      END IF
   END IF
   
   
   
   RETURN TRUE
END FUNCTION]]>
  </point>
  <point name="function.arti100_upd_ooef" order="66" ver="3" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
##update ooef
PRIVATE FUNCTION arti100_upd_ooef(p_field,p_column)
DEFINE l_sql   STRING
DEFINE p_field  LIKE type_t.chr80
DEFINE p_column  STRING
   LET l_sql = "UPDATE ooef_t SET ",p_column CLIPPED," = ? ",
               " WHERE ooefent = ",g_enterprise," AND ooef017 = '",g_ooef_m.ooef001,"'",
               "   AND ooef001 <> '",g_ooef_m.ooef001,"'"
   PREPARE upd_ooef_prep FROM l_sql
   EXECUTE upd_ooef_prep USING p_field
   IF SQLCA.SQLCODE THEN
      RETURN FALSE
   END IF
   
   RETURN TRUE
END FUNCTION]]>
  </point>
  <point name="function.arti100_chk_ooef003" order="67" ver="3" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
##chk ooef003
PRIVATE FUNCTION arti100_chk_ooef003()
   DEFINE l_cnt LIKE type_t.num5
   LET l_cnt = 0
   LET g_errno = NULL
   SELECT count(*) INTO l_cnt FROM ooef_t WHERE ooefent = g_enterprise
      AND ooef017 = g_ooef_m.ooef001 AND ooef001<>g_ooef_m.ooef001
   IF l_cnt>0 THEN
      LET g_errno = "art-00400"
   END IF   
END FUNCTION]]>
  </point>
  <point name="function.arti100_ooef026_ref" order="68" ver="3" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
################################################################################
#display ooef026
################################################################################
PRIVATE FUNCTION arti100_ooef026_ref()
DEFINE l_nmaa001   LIKE nmaa_t.nmaa001

   INITIALIZE g_ref_fields TO NULL
   SELECT nmaa001 INTO l_nmaa001
     FROM nmaa_t,nmas_t
    WHERE nmaaent = nmasent
      AND nmaa001 = nmas001
      AND nmaaent = g_enterprise
      AND nmas002 = g_ooef_m.ooef026
   LET g_ref_fields[1] = l_nmaa001
   CALL ap_ref_array2(g_ref_fields,
                      "SELECT nmaal003 FROM nmaal_t WHERE nmaalent='"||g_enterprise||"' AND nmaal001=? AND nmaal002='"||g_dlang||"'",
                      "")
        RETURNING g_rtn_fields
   LET g_ooef_m.ooef026_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_ooef_m.ooef026_desc
END FUNCTION]]>
  </point>
  <point name="function.arti100_upd_ooef156" order="69" ver="3" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 聯絡地址維護後同步更新銷售片區
# Memo...........:
# Usage..........: CALL arti100_upd_ooef156()
# Date & Author..: 2014/11/21 By Lori
# Modify.........:
################################################################################
PRIVATE FUNCTION arti100_upd_ooef156()
   DEFINE l_oofb022   LIKE oofb_t.oofb022   
   DEFINE l_ooef156   LIKE ooef_t.ooef156
   
   LET l_oofb022 = '' 
   SELECT oofb022 INTO l_oofb022
     FROM oofb_t
    WHERE oofbent = g_enterprise
      AND oofb002 = g_ooef_m.ooef012
      AND oofb008 = '3'
      AND oofb010 = 'Y'
   
   IF cl_null(l_oofb022) > 0 THEN
      RETURN
   ELSE
      LET l_ooef156 = ''
      SELECT dbad002 INTO l_ooef156
        FROM dbad_t
       WHERE dbadent = g_enterprise
         AND dbad001 = l_oofb022
      
      IF cl_null(l_ooef156) THEN
         RETURN
      ELSE
         UPDATE ooef_t
            SET ooef156 = l_ooef156
          WHERE ooefent = g_enterprise
            AND ooef001 = g_ooef_m.ooef001

         LET g_ooef_m.ooef156 = l_ooef156
         LET g_ooef_m.ooef156_desc = s_desc_get_dbad002_desc(l_ooef156)
         DISPLAY BY NAME g_ooef_m.ooef156,g_ooef_m.ooef156_desc
      END IF      
   END IF
   
END FUNCTION]]>
  </point>
  <point name="function.arti100_set_act_visible" order="70" ver="7" cite_std="N" new="Y" status="u" src="s" readonly="" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION arti100_set_act_visible()
CALL cl_set_act_visible("statechange,modify,delete,reproduce", TRUE)
CALL cl_set_act_visible("insert,modify_detail,statechange",TRUE)
END FUNCTION]]>
  </point>
  <point name="function.arti100_set_act_no_visible" order="71" ver="7" cite_std="N" new="Y" status="u" src="s" readonly="" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION arti100_set_act_no_visible()
#150424-00018#3 150529 by s983961 add(s) aoos010走申請流程控管
 IF cl_get_para(g_enterprise,g_site,'E-CIR-0018')='Y' THEN
     CALL cl_set_act_visible("insert,modify,modify_detail,reproduce,delete,statechange",FALSE)
 END IF
#150424-00018#3 150529 by s983961 add(e) aoos010走申請流程控管

#150424-00018#3 15/06/17 by s983961--mark(s) 統一寫入function內

#若無資料則關閉相關功能
 IF g_browser_cnt = 0 THEN
    CALL cl_set_act_visible("statechange,modify,delete,reproduce", FALSE)
 END IF
#
 IF g_ooef_m.ooefstus <> 'Y' THEN
     CALL cl_set_act_visible("delete", FALSE)
 END IF
#150424-00018#3 15/06/17 by s983961--mark(e) 統一寫入function內
END FUNCTION]]>
  </point>
  <point name="free_style.variable" order="" ver="5" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[{<Module define>}

#單頭 type 宣告
 TYPE type_g_ooef_m RECORD
       ooefunit LIKE ooef_t.ooefunit,
   ooefunit_desc LIKE type_t.chr80,
   ooef001 LIKE ooef_t.ooef001,
   ooef001_desc LIKE type_t.chr80,
   ooefl003 LIKE ooefl_t.ooefl003, 
   ooefl004 LIKE ooefl_t.ooefl004, 
   ooefl006 LIKE ooefl_t.ooefl006, 
   ooefl005 LIKE ooefl_t.ooefl005,
   ooef003  LIKE ooef_t.ooef003,   
   ooef017 LIKE ooef_t.ooef017,
   ooef017_desc LIKE type_t.chr80,
   ooef101 LIKE ooef_t.ooef101,
   ooed005 LIKE type_t.chr10,
   ooed005_desc LIKE type_t.chr80,
   ooef105 LIKE ooef_t.ooef105,
   ooef105_desc LIKE type_t.chr80,
   ooef102 LIKE ooef_t.ooef102,
   ooef103 LIKE ooef_t.ooef103,
   ooef100 LIKE ooef_t.ooef100,
   ooefstus LIKE ooef_t.ooefstus,
   ooef104 LIKE ooef_t.ooef104,
   ooef104_desc LIKE type_t.chr80,
   ooef106 LIKE ooef_t.ooef106,
   ooef106_desc LIKE type_t.chr80,
   ooef108 LIKE ooef_t.ooef108,
   ooef108_desc LIKE type_t.chr80,
   ooef107 LIKE ooef_t.ooef107,
   ooef109 LIKE ooef_t.ooef109,
   ooef110 LIKE ooef_t.ooef110,
   ooef115 LIKE ooef_t.ooef115,
   ooef116 LIKE ooef_t.ooef116,
   ooef111 LIKE ooef_t.ooef111,
   ooef112 LIKE ooef_t.ooef112,
   ooef113 LIKE ooef_t.ooef113,
   ooef114 LIKE ooef_t.ooef114,
   ooef120 LIKE ooef_t.ooef120,
   ooef121 LIKE ooef_t.ooef121,
   ooef122 LIKE ooef_t.ooef122,
   ooef123 LIKE ooef_t.ooef123,
   ooef123_desc LIKE type_t.chr80,
   ooef124 LIKE ooef_t.ooef124,
   ooef124_desc LIKE type_t.chr80,
   ooef125 LIKE ooef_t.ooef125,
   ooef125_desc LIKE type_t.chr80,
   ooefownid LIKE ooef_t.ooefownid,
   ooefownid_desc LIKE type_t.chr80,
   ooefowndp LIKE ooef_t.ooefowndp,
   ooefowndp_desc LIKE type_t.chr80,
   ooefcrtid LIKE ooef_t.ooefcrtid,
   ooefcrtid_desc LIKE type_t.chr80,
   ooefcrtdp LIKE ooef_t.ooefcrtdp,
   ooefcrtdp_desc LIKE type_t.chr80,
   ooefcrtdt DATETIME YEAR TO SECOND,
   ooefmodid LIKE ooef_t.ooefmodid,
   ooefmodid_desc LIKE type_t.chr80,
   ooefmoddt DATETIME YEAR TO SECOND,
   ooef014 LIKE ooef_t.ooef014,
   ooef014_desc LIKE type_t.chr80,
   ooef016 LIKE ooef_t.ooef016,
   ooef016_desc LIKE type_t.chr80,
   ooef004 LIKE ooef_t.ooef004,
   ooef004_desc LIKE type_t.chr80,
   ooef005 LIKE ooef_t.ooef005,
   ooef015 LIKE ooef_t.ooef015,
   ooef015_desc LIKE type_t.chr80,
   ooef006 LIKE ooef_t.ooef006,
   ooef006_desc LIKE type_t.chr80,
   ooef018 LIKE ooef_t.ooef018,
   ooef018_desc LIKE type_t.chr80,
   ooef019 LIKE ooef_t.ooef019,
   ooef019_desc LIKE type_t.chr80,
   ooef007 LIKE ooef_t.ooef007,
   ooef020 LIKE ooef_t.ooef020,
   ooef022 LIKE ooef_t.ooef022,
   ooef008 LIKE ooef_t.ooef008,
   ooef008_desc LIKE type_t.chr80,
   ooef010 LIKE ooef_t.ooef010,
   ooef010_desc LIKE type_t.chr80,
   ooef011 LIKE ooef_t.ooef011,
   ooef013 LIKE ooef_t.ooef013,
   ooef023 LIKE ooef_t.ooef023,
   ooef024 LIKE ooef_t.ooef024,
   ooef024_desc LIKE type_t.chr80,
   ooef026 LIKE ooef_t.ooef026,
   ooef026_desc LIKE type_t.chr80,
   ooef150 LIKE ooef_t.ooef150,
   ooef150_desc LIKE type_t.chr80,
   ooef151 LIKE ooef_t.ooef151,
   ooef151_desc LIKE type_t.chr80,
   ooef152 LIKE ooef_t.ooef152,
   ooef152_desc LIKE type_t.chr80,
   ooef153 LIKE ooef_t.ooef153,
   ooef153_desc LIKE type_t.chr80,
   ooef154 LIKE ooef_t.ooef154,
   ooef154_desc LIKE type_t.chr80,
   ooef155 LIKE ooef_t.ooef155,
   ooef155_desc LIKE type_t.chr80,
   ooef156 LIKE ooef_t.ooef156,
   ooef156_desc LIKE type_t.chr80,
   ooef157 LIKE ooef_t.ooef157,
   ooef157_desc LIKE type_t.chr80,
   ooef158 LIKE ooef_t.ooef158,
   ooef158_desc LIKE type_t.chr80,
   ooef159 LIKE ooef_t.ooef159,
   ooef159_desc LIKE type_t.chr80,
   ooef160 LIKE ooef_t.ooef160,
   ooef160_desc LIKE type_t.chr80,
   ooef161 LIKE ooef_t.ooef161,
   ooef161_desc LIKE type_t.chr80,
   ooef162 LIKE ooef_t.ooef162,
   ooef162_desc LIKE type_t.chr80,
   ooef163 LIKE ooef_t.ooef163,
   ooef163_desc LIKE type_t.chr80,
   ooef164 LIKE ooef_t.ooef164,
   ooef164_desc LIKE type_t.chr80,
   ooef165 LIKE ooef_t.ooef165,
   ooef165_desc LIKE type_t.chr80,
   ooef166 LIKE ooef_t.ooef166,
   ooef166_desc LIKE type_t.chr80,
   ooef167 LIKE ooef_t.ooef167,
   ooef167_desc LIKE type_t.chr80,
   ooef168 LIKE ooef_t.ooef168,
   ooef168_desc LIKE type_t.chr80,
   ooef169 LIKE ooef_t.ooef169,
   ooef169_desc LIKE type_t.chr80,
   ooef012 LIKE ooef_t.ooef012
       END RECORD

#模組變數(Module Variables)
DEFINE g_ooef_m        type_g_ooef_m
DEFINE g_ooef_m_t      type_g_ooef_m                #備份舊值
DEFINE g_ooef_m_o      type_g_ooef_m                #備份舊值
DEFINE g_ooef001_t   LIKE ooef_t.ooef001    #Key值備份


DEFINE g_browser    DYNAMIC ARRAY OF RECORD                   #資料瀏覽之欄位
         b_statepic     LIKE type_t.chr50,
            b_ooef001 LIKE ooef_t.ooef001,
   b_ooef001_desc LIKE type_t.chr80,
      b_ooef017 LIKE ooef_t.ooef017,
   b_ooef017_desc LIKE type_t.chr80,
      b_ooef101 LIKE ooef_t.ooef101,
      b_ooef105 LIKE ooef_t.ooef105,
   b_ooef105_desc LIKE type_t.chr80,
      b_ooef102 LIKE ooef_t.ooef102,
      b_ooef103 LIKE ooef_t.ooef103,
      b_ooef104 LIKE ooef_t.ooef104,
   b_ooef104_desc LIKE type_t.chr80
         #,rank           LIKE type_t.num10
      END RECORD

#無單頭append欄位定義
DEFINE g_master_multi_table_t    RECORD
      ooefl001 LIKE ooefl_t.ooefl001,
      ooefl003 LIKE ooefl_t.ooefl003,
      ooefl004 LIKE ooefl_t.ooefl004,
      ooefl006 LIKE ooefl_t.ooefl006,
      ooefl005 LIKE ooefl_t.ooefl005
      END RECORD

DEFINE g_wc                  STRING                        #儲存 user 的查詢條件
DEFINE g_wc_t                STRING                        #儲存 user 的查詢條件
DEFINE g_wc_filter           STRING
DEFINE g_wc_filter_t         STRING

DEFINE g_sql                 STRING                        #組 sql 用
DEFINE g_forupd_sql          STRING                        #SELECT ... FOR UPDATE  SQL
DEFINE g_cnt                 LIKE type_t.num10
DEFINE g_jump                LIKE type_t.num10             #查詢指定的筆數
DEFINE g_no_ask              LIKE type_t.num5              #是否開啟指定筆視窗
DEFINE g_rec_b               LIKE type_t.num5              #單身筆數
DEFINE l_ac                  LIKE type_t.num5              #目前處理的ARRAY CNT
DEFINE g_curr_diag           ui.Dialog                     #Current Dialog
DEFINE gwin_curr             ui.Window                     #Current Window
DEFINE gfrm_curr             ui.Form                       #Current Form
DEFINE g_pagestart           LIKE type_t.num5              #page起始筆數
DEFINE g_page_action         STRING                        #page action
DEFINE g_header_hidden       LIKE type_t.num5              #隱藏單頭
DEFINE g_worksheet_hidden    LIKE type_t.num5              #隱藏工作Panel
DEFINE g_page                STRING                        #第幾頁
DEFINE g_current_sw          BOOLEAN                       #Browser所在筆數用開關
DEFINE g_ch                  base.Channel                  #外串程式用
DEFINE g_state               STRING
DEFINE g_ref_fields          DYNAMIC ARRAY OF VARCHAR(500) #ap_ref用陣列
DEFINE g_ref_vars            DYNAMIC ARRAY OF VARCHAR(500) #ap_ref用陣列
DEFINE g_rtn_fields          DYNAMIC ARRAY OF VARCHAR(500) #ap_ref用陣列
DEFINE g_error_show          LIKE type_t.num5

DEFINE g_aw                  STRING                        #確定當下點擊的單身(modify_detail用)
DEFINE g_chk                 BOOLEAN                       #助記碼判斷用
DEFINE g_default             BOOLEAN                       #是否有外部參數查詢
DEFINE g_log1                STRING                        #cl_log_modified_record用(舊值) #qiaozy
DEFINE g_log2                STRING                        #cl_log_modified_record用(新值) #qiaozy

#快速搜尋用
DEFINE g_searchcol           STRING             #查詢欄位代碼
DEFINE g_searchstr           STRING             #查詢欄位字串
DEFINE g_order               STRING             #查詢排序模式

#Browser用
DEFINE g_current_idx         LIKE type_t.num5   #Browser 所在筆數(當下page)
DEFINE g_current_row         LIKE type_t.num5   #Browser 所在筆數(暫存用)
DEFINE g_current_cnt         LIKE type_t.num10  #Browser 總筆數(當下page)
DEFINE g_browser_idx         LIKE type_t.num5   #Browser 所在筆數(所有資料)
DEFINE g_browser_cnt         LIKE type_t.num5   #Browser 總筆數(所有資料)
DEFINE g_tmp_page            LIKE type_t.num5
DEFINE g_row_index           LIKE type_t.num5

GLOBALS
   DEFINE g_detail_insert   LIKE type_t.num5   #單身的新增權限
   DEFINE g_detail_delete   LIKE type_t.num5   #單身的刪除權限
   DEFINE g_wc2_i35001      STRING             #聯絡地址QBE條件
   DEFINE g_wc2_i35002      STRING             #通訊方式QBE條件
   DEFINE g_d_idx_i35001    LIKE type_t.num5   #聯絡地址所在筆數
   DEFINE g_d_cnt_i35001    LIKE type_t.num5   #聯絡地址總筆數
   DEFINE g_d_idx_i35002    LIKE type_t.num5   #通訊方式所在筆數
   DEFINE g_d_cnt_i35002    LIKE type_t.num5   #通訊方式總筆數
   DEFINE g_pmaa027_d       LIKE pmaa_t.pmaa027
   DEFINE g_appoint_idx     LIKE type_t.num5   #指定進入單身行數
END GLOBALS
DEFINE g_detail_id          STRING             #紀錄停留在聯絡地址, 通訊方式或不在此兩個Page
DEFINE g_detail_idx         LIKE type_t.num5  
DEFINE g_insert             LIKE type_t.chr5  
DEFINE gs_keys              DYNAMIC ARRAY OF VARCHAR(500) #同步資料用陣列
DEFINE gs_keys_bak          DYNAMIC ARRAY OF VARCHAR(500) #同步資料用陣列

{</Module define>}]]>
  </point>
  <point name="global.import" order="" ver="2" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[IMPORT FGL aoo_aooi350_01
IMPORT FGL aoo_aooi350_02]]>
  </point>
  <point name="global.variable" order="" ver="7" cite_std="N" new="N" status="u" src="s" readonly="" mark_hard="N">
    <![CDATA[DEFINE g_site_flag          LIKE type_t.num5
#ken---add---s 需求單號：150107-00009 項次：5
GLOBALS
 TYPE type_g_oofb_d        RECORD
       oofbstus LIKE oofb_t.oofbstus,
   oofb001 LIKE oofb_t.oofb001,
   oofb019 LIKE oofb_t.oofb019,
   oofb011 LIKE oofb_t.oofb011,
   oofb008 LIKE oofb_t.oofb008,
   oofb009 LIKE oofb_t.oofb009,
   oofb009_desc LIKE type_t.chr500,
   oofb010 LIKE oofb_t.oofb010,
   oofb012 LIKE oofb_t.oofb012,
   oofb012_desc LIKE type_t.chr500,
   oofb013 LIKE oofb_t.oofb013,
   oofb014 LIKE oofb_t.oofb014,
   oofb014_desc LIKE type_t.chr500,
   oofb015 LIKE oofb_t.oofb015,
   oofb015_desc LIKE type_t.chr500,
   oofb016 LIKE oofb_t.oofb016,
   oofb016_desc LIKE type_t.chr500,
   oofb017 LIKE oofb_t.oofb017,
   oofb022 LIKE oofb_t.oofb022,
   oofb022_desc LIKE type_t.chr500,
   oofb020 LIKE oofb_t.oofb020,
   oofb021 LIKE oofb_t.oofb021,
   oofb018 LIKE oofb_t.oofb018
       END RECORD
DEFINE g_pmba_d          DYNAMIC ARRAY OF type_g_oofb_d

 TYPE type_g_oofc_d        RECORD
       oofcstus LIKE oofc_t.oofcstus,
   oofc001 LIKE oofc_t.oofc001,
   oofc008 LIKE oofc_t.oofc008,
   oofc009 LIKE oofc_t.oofc009,
   oofc009_desc LIKE type_t.chr500,
   oofc012 LIKE oofc_t.oofc012,
   oofc010 LIKE oofc_t.oofc010,
   oofc014 LIKE oofc_t.oofc014,
   oofc011 LIKE oofc_t.oofc011,
   oofc015 LIKE oofc_t.oofc015,
   oofc013 LIKE oofc_t.oofc013
       END RECORD
DEFINE g_pmba2_d          DYNAMIC ARRAY OF type_g_oofc_d
END GLOBALS
#ken---add---e]]>
  </point>
  <point name="input.define" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   define l_ooea003       like ooea_t.ooea003]]>
  </point>
  <point name="input.head.b_insert" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                  select ooea003 into l_ooea003 from ooea_t 
                   where ooea001 = g_ooef_m.ooef001 AND ooeaent=g_enterprise
                  if l_ooea003<>'Y' then
                     INITIALIZE g_errparam TO NULL
LET g_errparam.code = "art-00209"
LET g_errparam.extend = g_ooef_m.ooef001
LET g_errparam.popup = TRUE
CALL cl_err()

                     next field ooef017
                  else
                     LET g_ooef_m.ooef017 = g_ooef_m.ooef001                  
                  end if                   ]]>
  </point>
  <point name="insert.default" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[      LET g_ooef_m.ooefunit = g_site
      call arti100_ooefunit_ref()
      LET g_ooef_m.ooefstus = "Y"
      LET g_ooef_m_t.* = g_ooef_m.*]]>
  </point>
  <point name="main.define" order="" ver="4" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   DEFINE l_success LIKE type_t.num5      #150308-00001#5  By benson 150309]]>
  </point>
  <point name="main.define_sql" order="" ver="2" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   LET g_forupd_sql = "SELECT ooefunit,'',ooef001,'',ooef003,ooef017,'',ooef101,'','',ooef105,'',ooef102,ooef103,ooef100,ooefstus,ooef104,'',ooef106,'',ooef108,'',ooef107,ooef109,ooef110,ooef115,ooef111,ooef112,ooef113,ooef114,ooef120,ooef121,ooef122,ooef123,'',ooef124,'',ooef125,'',ooefownid,'',ooefowndp,'',ooefcrtid,'',ooefcrtdp,'',ooefcrtdt,ooefmodid,'',ooefmoddt,ooef014,'',ooef016,'',ooef004,'',ooef005,ooef015,'',ooef006,'',ooef018,'',ooef019,'',ooef007,ooef020,ooef022,ooef008,'',ooef010,'',ooef011,ooef013,ooef023,ooef024,'',ooef026,'',ooef150,'',ooef151,'',ooef152,'',ooef153,'',ooef154,'',ooef155,'',ooef156,'',ooef157,'',ooef158,'',ooef159,'',ooef160,'',ooef161,'',ooef162,'',ooef163,'',ooef164,'',ooef165,'',ooef166,'',ooef167,'',ooef168,'',ooef169,'' FROM ooef_t WHERE ooefent= ? AND ooef001=? FOR UPDATE"]]>
  </point>
  <point name="main.exit" order="" ver="4" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   CALL s_aooi500_drop_temp() RETURNING l_success      #150308-00001#5  By benson 150309]]>
  </point>
  <point name="reproduce.head.b_input" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   LET g_ooef_m.ooefstus = "Y"]]>
  </point>
  <section id="arti100.description" ver="18" status="" src="s" readonly="">
    <![CDATA[#應用 a00 樣板自動產生(Version:1)
#+ Version..: T100-ERP-1.00.00(SD版次:7,PR版次:7) Build-000167
#+ 
#+ Filename...: arti100
#+ Description: 門店資訊維護作業
#+ Creator....: 02296(2013-12-28 17:30:48)
#+ Modifier...: 06189(2015-04-30 14:00:50) -SD/PR-
]]>
  </section>
  <section id="arti100.global" ver="4" status="" src="s" readonly="">
    <![CDATA[#應用 i00 樣板自動產生(Version:3)
{<point name="global.memo" />}
 
IMPORT os
IMPORT FGL lib_cl_dlg
#add-point:增加匯入項目
{<point name="global.import" />}
#end add-point
 
SCHEMA ds
 
GLOBALS "../../cfg/top_global.inc"
 
#add-point:free_style模組變數(Module Variable)
{<point name="free_style.variable"/>}
#end add-point
 
#add-point:自定義模組變數(Module Variable)
{<point name="global.variable" edit="s"/>}
#end add-point
 
#add-point:自定義客戶專用模組變數(Module Variable)
{<point name="global.variable_customerization" edit="c"/>}
#end add-point
]]>
  </section>
  <section id="arti100.main" ver="3" status="" src="s" readonly="">
    <![CDATA[#+ 作業開始
MAIN
   #add-point:main段define (標準程式用)
   {<point name="main.define" edit="s"/>}
   #end add-point    
   #add-point:main段define (客製程式用)
   {<point name="main.define_customerization" edit="c"/>}
   #end add-point
 
   #定義在其他link的程式則無效
   WHENEVER ERROR CALL cl_err_msg_log
 
   #依模組進行系統初始化設定(系統設定)
   CALL cl_ap_init("art","")
 
   #add-point:作業初始化
   {<point name="main.init"/>}
   #end add-point
 
   #add-point:SQL_define
   {<point name="main.define_sql" />}
   #end add-point
   LET g_forupd_sql = cl_sql_forupd(g_forupd_sql)    #轉換不同資料庫語法
   DECLARE arti100_cl CURSOR FROM g_forupd_sql 
   
   IF g_bgjob = "Y" THEN
 
      #add-point:Service Call
      {<point name="main.servicecall" />}
      #end add-point
   ELSE
      #畫面開啟 (identifier)
      OPEN WINDOW w_arti100 WITH FORM cl_ap_formpath("art",g_code)
 
      #瀏覽頁簽資料初始化
      CALL cl_ui_init()
 
      #程式初始化
      CALL arti100_init()
 
      #進入選單 Menu (='N')
      CALL arti100_ui_dialog()
   
      #畫面關閉
      CLOSE WINDOW w_arti100
   END IF
 
   #add-point:作業離開前
   {<point name="main.exit" />}
   #end add-point
 
   #離開作業
   CALL cl_ap_exitprogram("0")
 
END MAIN
]]>
  </section>
  <section id="arti100.other_function" ver="1" status="" src="s" readonly="">
    <![CDATA[#add-point:自定義元件(Function)
{<point name="other.function"/>}
#end add-point
]]>
  </section>
</add_points>
