#該程式未解開Section, 採用最新樣板產出!
{<section id="afat504_01.description" >}
#應用 a00 樣板自動產生(Version:3)
#+ Standard Version.....: SD版次:0007(2014-11-12 14:07:21), PR版次:0007(2017-02-20 10:11:05)
#+ Customerized Version.: SD版次:0000(1900-01-01 00:00:00), PR版次:0000(1900-01-01 00:00:00)
#+ Build......: 000170
#+ Filename...: afat504_01
#+ Description: 科目與核算項明細
#+ Creator....: 02599(2014-08-07 18:34:59)
#+ Modifier...: 02599 -SD/PR- 07900
 
{</section>}
 
{<section id="afat504_01.global" >}
#應用 c02b 樣板自動產生(Version:10)
#add-point:填寫註解說明 name="global.memo"
#150916-00015#1   2015/12/07 By Xiaozg  1.快捷带出类似科目编号 2.当有账套时，科目检查改为检查是否存在于glad_t中
#160321-00016#26  2016/03/24 By Jessy   修正azzi920重複定義之錯誤訊息
#160318-00005#11  2016/03/25 by 07675   將重複內容的錯誤訊息置換為公用錯誤訊息
#160318-00025#13  2016/04/15 By 07673   將重複內容的錯誤訊息置換為公用錯誤訊息
#160913-00017#1   2016/09/23 By 07900   AFA模组调整交易客商开窗
#160927-00013#1   2016/09/27 By 02114   afat504單身的核算項交易客商欄位沒有依單頭的交易客商帶默認值
#161024-00008#4   2016/10/27 By Hans     AFA組織類型與職能開窗清單調整。
#161111-00028#7   2016/11/24 by 02481       标准程式定义采用宣告模式,弃用.*写法
#161221-00054#4   2017/02/17  By 07900    相關單身(會計科目+部門) 及傳票預覽( 會計科目+部門), 要擋<<科目拒絕部門>> 參照agli060擋拒絕部門設定 
#end add-point
#add-point:填寫註解說明(客製用) name="global.memo_customerization"

#end add-point
 
IMPORT os
IMPORT FGL lib_cl_dlg
#add-point:增加匯入項目 name="global.import"
IMPORT util
#end add-point
 
SCHEMA ds
 
GLOBALS "../../cfg/top_global.inc"
 
#add-point:增加匯入變數檔 name="global.inc"

#end add-point
 
#單身 type 宣告
PRIVATE TYPE type_g_fabo_d        RECORD
       faboseq LIKE fabo_t.faboseq, 
   fabo024 LIKE fabo_t.fabo024, 
   fabo024_desc LIKE type_t.chr500, 
   fabo042 LIKE fabo_t.fabo042, 
   fabo031 LIKE fabo_t.fabo031, 
   fabo031_desc LIKE type_t.chr500, 
   fabo032 LIKE fabo_t.fabo032, 
   fabo032_desc LIKE type_t.chr500, 
   fabo033 LIKE fabo_t.fabo033, 
   fabo033_desc LIKE type_t.chr500, 
   fabo034 LIKE fabo_t.fabo034, 
   fabo034_desc LIKE type_t.chr500, 
   fabo035 LIKE fabo_t.fabo035, 
   fabo035_desc LIKE type_t.chr500, 
   fabo036 LIKE fabo_t.fabo036, 
   fabo036_desc LIKE type_t.chr500, 
   fabo037 LIKE fabo_t.fabo037, 
   fabo037_desc LIKE type_t.chr500, 
   fabo038 LIKE fabo_t.fabo038, 
   fabo038_desc LIKE type_t.chr500, 
   fabo039 LIKE fabo_t.fabo039, 
   fabo039_desc LIKE type_t.chr500, 
   fabo040 LIKE fabo_t.fabo040, 
   fabo040_desc LIKE type_t.chr500, 
   fabo054 LIKE fabo_t.fabo054, 
   fabo055 LIKE fabo_t.fabo055, 
   fabo055_desc LIKE type_t.chr500, 
   fabo056 LIKE fabo_t.fabo056, 
   fabo056_desc LIKE type_t.chr500, 
   fabo060 LIKE fabo_t.fabo060, 
   fabo060_desc LIKE type_t.chr500, 
   fabo061 LIKE fabo_t.fabo061, 
   fabo061_desc LIKE type_t.chr500, 
   fabo062 LIKE fabo_t.fabo062, 
   fabo062_desc LIKE type_t.chr500, 
   fabo063 LIKE fabo_t.fabo063, 
   fabo063_desc LIKE type_t.chr500, 
   fabo064 LIKE fabo_t.fabo064, 
   fabo064_desc LIKE type_t.chr500, 
   fabo065 LIKE fabo_t.fabo065, 
   fabo065_desc LIKE type_t.chr500, 
   fabo066 LIKE fabo_t.fabo066, 
   fabo066_desc LIKE type_t.chr500, 
   fabo067 LIKE fabo_t.fabo067, 
   fabo067_desc LIKE type_t.chr500, 
   fabo068 LIKE fabo_t.fabo068, 
   fabo068_desc LIKE type_t.chr500, 
   fabo069 LIKE fabo_t.fabo069, 
   fabo069_desc LIKE type_t.chr500
       END RECORD
 
 
#add-point:自定義模組變數(Module Variable)(請盡量不要在客製環境修改此段落內容, 否則將後續patch的調整需人工處理) name="global.variable"
DEFINE g_loc                 LIKE type_t.chr5 
DEFINE g_fabo2_d             DYNAMIC ARRAY OF type_g_fabo_d
DEFINE g_fabo2_d_t           type_g_fabo_d
GLOBALS
   DEFINE p_prog             LIKE type_t.chr20
   DEFINE g_wc_subject       STRING
   DEFINE g_wc_d             STRING
   DEFINE g_fabgld           LIKE fabg_t.fabgld
   DEFINE g_fabgdocno        LIKE fabg_t.fabgdocno
   DEFINE g_faboseq          LIKE fabo_t.faboseq
   DEFINE g_fabgld_o         LIKE fabg_t.fabgld
   DEFINE g_fabgdocno_o      LIKE fabg_t.fabgdocno
   DEFINE g_faboseq_o        LIKE fabo_t.faboseq
   DEFINE g_detail_insert    LIKE type_t.num5   #單身的新增權限
   DEFINE g_detail_delete    LIKE type_t.num5   #單身的刪除權限
   DEFINE g_fabo_d2          DYNAMIC ARRAY OF type_g_fabo_d
END GLOBALS
DEFINE gs_keys               DYNAMIC ARRAY OF VARCHAR(500) #同步資料用陣列
DEFINE gs_keys_bak           DYNAMIC ARRAY OF VARCHAR(500) #同步資料用陣列
DEFINE g_sql                 STRING
DEFINE g_cnt                 LIKE type_t.num10
DEFINE g_error_show          LIKE type_t.num5              #
DEFINE g_current_page        LIKE type_t.num5              #目前所在頁數   
DEFINE g_curr_diag           ui.Dialog                     #Current Dialog
DEFINE g_glaald              LIKE glaa_t.glaald
DEFINE g_glaa004             LIKE glaa_t.glaa004
DEFINE g_forupd_sql          STRING                        #SELECT ... FOR UPDATE  SQL  
DEFINE g_insert              LIKE type_t.chr5              #是否導到其他page
DEFINE l_insert              BOOLEAN
DEFINE l_cmd                 LIKE type_t.chr1
DEFINE l_n                   LIKE type_t.num5              #檢查重複用
DEFINE l_count               LIKE type_t.num5
DEFINE l_lock_sw             LIKE type_t.chr1              #單身鎖住否
DEFINE lb_reproduce          BOOLEAN
DEFINE li_reproduce          LIKE type_t.num5
DEFINE li_reproduce_target   LIKE type_t.num5
DEFINE g_log1                STRING                        #log用
DEFINE g_log2                STRING                        #log用
DEFINE g_fabgdocdt           LIKE fabg_t.fabgdocdt

#end add-point
 
DEFINE g_fabo_d          DYNAMIC ARRAY OF type_g_fabo_d
DEFINE g_fabo_d_t        type_g_fabo_d
 
 
DEFINE g_fabold_t   LIKE fabo_t.fabold    #Key值備份
DEFINE g_fabodocno_t      LIKE fabo_t.fabodocno    #Key值備份
DEFINE g_faboseq_t      LIKE fabo_t.faboseq    #Key值備份
 
 
DEFINE l_ac                  LIKE type_t.num10
DEFINE g_ref_fields          DYNAMIC ARRAY OF VARCHAR(500) #ap_ref用陣列
DEFINE g_rtn_fields          DYNAMIC ARRAY OF VARCHAR(500) #ap_ref用陣列
DEFINE g_ref_vars            DYNAMIC ARRAY OF VARCHAR(500) #ap_ref用陣列
DEFINE g_rec_b               LIKE type_t.num10 
DEFINE g_detail_idx          LIKE type_t.num10
 
#add-point:自定義客戶專用模組變數(Module Variable) name="global.variable_customerization"

#end add-point
    
#add-point:傳入參數說明(global.argv) name="global.argv"

#end add-point    
 
{</section>}
 
{<section id="afat504_01.input" >}
#+ 資料輸入
PUBLIC FUNCTION afat504_01(--)
   #add-point:input段變數傳入 name="input.get_var"
   
   #end add-point
   )
   #add-point:input段define name="input.define_customerization"
   
   #end add-point
   DEFINE l_ac_t          LIKE type_t.num10       #未取消的ARRAY CNT 
   DEFINE l_allow_insert  LIKE type_t.num5        #可新增否 
   DEFINE l_allow_delete  LIKE type_t.num5        #可刪除否  
   DEFINE l_count         LIKE type_t.num10
   DEFINE l_insert        LIKE type_t.num5
   DEFINE l_cmd           LIKE type_t.chr5
   #add-point:input段define(請盡量不要在客製環境修改此段落內容, 否則將後續patch的調整需人工處理) name="input.define"
   DEFINE l_sql                  STRING
   DEFINE l_glaa004              LIKE  glaa_t.glaa004
   #end add-point
 
   #畫面開啟 (identifier)
   OPEN WINDOW w_afat504_01 WITH FORM cl_ap_formpath("afa","afat504_01")
 
   #瀏覽頁簽資料初始化
   CALL cl_ui_init()
   
   LET g_qryparam.state = "i"
   
   LET l_allow_insert = cl_auth_detail_input("insert")
   LET l_allow_delete = cl_auth_detail_input("delete")
   
   #輸入前處理
   #add-point:單身前置處理 name="input.pre_input"
   
   #end add-point
  
   DIALOG ATTRIBUTES(UNBUFFERED,FIELD ORDER FORM)
   
      #輸入開始
      INPUT ARRAY g_fabo_d FROM s_detail1_afat504_01.*
          ATTRIBUTE(COUNT = g_rec_b,MAXCOUNT = g_max_rec,WITHOUT DEFAULTS, 
                  INSERT ROW = l_allow_insert,
                  DELETE ROW = l_allow_delete,
                  APPEND ROW = l_allow_insert)
         
         #自訂ACTION
         #add-point:單身前置處理 name="input.action"
         
         #end add-point
         
         #自訂ACTION(detail_input)
         
         
         BEFORE INPUT
            #add-point:單身輸入前處理 name="input.before_input"
            
            #end add-point
          
                  #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD faboseq_2
            #add-point:BEFORE FIELD faboseq_2 name="input.b.page1_afat504_01.faboseq_2"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD faboseq_2
            
            #add-point:AFTER FIELD faboseq_2 name="input.a.page1_afat504_01.faboseq_2"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE faboseq_2
            #add-point:ON CHANGE faboseq_2 name="input.g.page1_afat504_01.faboseq_2"
            
            #END add-point 
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD fabo024
            
            #add-point:AFTER FIELD fabo024 name="input.a.page1_afat504_01.fabo024"
            IF NOT cl_null(g_fabo_d[l_ac].fabo024) THEN 
              #  150916-00015#1 BEGIN    快捷带出类似科目编号     ADD BY XZG201511202
              LET l_sql = " "
              IF  s_aglt310_getlike_lc_subject(g_fabgld,g_fabo_d[l_ac].fabo024,l_sql) THEN
                 INITIALIZE g_qryparam.* TO NULL
                 SELECT glaa004 INTO l_glaa004
                  FROM glaa_t
                 WHERE glaaent = g_enterprise
                   AND glaald = g_fabgld
                 LET g_qryparam.state = 'i'
                 LET g_qryparam.reqry = 'FALSE'
                 LET g_qryparam.default1 =g_fabo_d[l_ac].fabo024
                 
                 LET g_qryparam.arg1 = l_glaa004
                 LET g_qryparam.arg2 = g_fabo_d[l_ac].fabo024
                 LET g_qryparam.arg3 = g_fabgld
                 LET g_qryparam.arg4 = "1 "
                 CALL q_glac002_6()
                 LET g_fabo2_d[l_ac].fabo024 = g_qryparam.return1              
               
                 DISPLAY g_fabo2_d[l_ac].fabo024 TO fabo024              #
                 CALL afat504_01_fabo024_desc(g_fabo2_d[l_ac].fabo024) RETURNING g_fabo2_d[l_ac].fabo024_desc 
              END IF
               IF  NOT s_aglt310_lc_subject(g_fabgld,g_fabo_d[l_ac].fabo024,'N') THEN
                     NEXT FIELD CURRENT
               END IF
           #  150916-00015#1 END
#此段落由子樣板a19產生
               #校驗代值
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_fabo_d[l_ac].fabo024
               LET g_chkparam.arg2 = '參數2'
               LET g_errshow = TRUE   #160318-00025#13
               LET g_chkparam.err_str[1] = "agl-00012:sub-01302|agli020|",cl_get_progname("agli020",g_lang,"2"),"|:EXEPROGagli020"    #160318-00025#13   
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist_and_ref_val("v_glac002_3") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 
               ELSE
                  #檢查失敗時後續處理
                  NEXT FIELD CURRENT
               END IF
            

            END IF 


            #END add-point
            
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD fabo024
            #add-point:BEFORE FIELD fabo024 name="input.b.page1_afat504_01.fabo024"
            
            #END add-point
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE fabo024
            #add-point:ON CHANGE fabo024 name="input.g.page1_afat504_01.fabo024"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD fabo024_desc
            #add-point:BEFORE FIELD fabo024_desc name="input.b.page1_afat504_01.fabo024_desc"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD fabo024_desc
            
            #add-point:AFTER FIELD fabo024_desc name="input.a.page1_afat504_01.fabo024_desc"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE fabo024_desc
            #add-point:ON CHANGE fabo024_desc name="input.g.page1_afat504_01.fabo024_desc"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD fabo042
            #add-point:BEFORE FIELD fabo042 name="input.b.page1_afat504_01.fabo042"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD fabo042
            
            #add-point:AFTER FIELD fabo042 name="input.a.page1_afat504_01.fabo042"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE fabo042
            #add-point:ON CHANGE fabo042 name="input.g.page1_afat504_01.fabo042"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD fabo031
            #add-point:BEFORE FIELD fabo031 name="input.b.page1_afat504_01.fabo031"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD fabo031
            
            #add-point:AFTER FIELD fabo031 name="input.a.page1_afat504_01.fabo031"
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_fabo2_d[l_ac].fabo031
            CALL ap_ref_array2(g_ref_fields,"SELECT pmaal004 FROM pmaal_t WHERE pmaalent='"||g_enterprise||"' AND pmaal001=? AND pmaal002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_fabo2_d[l_ac].fabo031_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_fabo2_d[l_ac].fabo031_desc


            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE fabo031
            #add-point:ON CHANGE fabo031 name="input.g.page1_afat504_01.fabo031"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD fabo031_desc
            #add-point:BEFORE FIELD fabo031_desc name="input.b.page1_afat504_01.fabo031_desc"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD fabo031_desc
            
            #add-point:AFTER FIELD fabo031_desc name="input.a.page1_afat504_01.fabo031_desc"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE fabo031_desc
            #add-point:ON CHANGE fabo031_desc name="input.g.page1_afat504_01.fabo031_desc"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD fabo032
            #add-point:BEFORE FIELD fabo032 name="input.b.page1_afat504_01.fabo032"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD fabo032
            
            #add-point:AFTER FIELD fabo032 name="input.a.page1_afat504_01.fabo032"
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_fabo2_d[l_ac].fabo032
            CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='281' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_fabo2_d[l_ac].fabo032_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_fabo2_d[l_ac].fabo032_desc


            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE fabo032
            #add-point:ON CHANGE fabo032 name="input.g.page1_afat504_01.fabo032"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD fabo032_desc
            #add-point:BEFORE FIELD fabo032_desc name="input.b.page1_afat504_01.fabo032_desc"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD fabo032_desc
            
            #add-point:AFTER FIELD fabo032_desc name="input.a.page1_afat504_01.fabo032_desc"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE fabo032_desc
            #add-point:ON CHANGE fabo032_desc name="input.g.page1_afat504_01.fabo032_desc"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD fabo033
            #add-point:BEFORE FIELD fabo033 name="input.b.page1_afat504_01.fabo033"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD fabo033
            
            #add-point:AFTER FIELD fabo033 name="input.a.page1_afat504_01.fabo033"


            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE fabo033
            #add-point:ON CHANGE fabo033 name="input.g.page1_afat504_01.fabo033"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD fabo033_desc
            #add-point:BEFORE FIELD fabo033_desc name="input.b.page1_afat504_01.fabo033_desc"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD fabo033_desc
            
            #add-point:AFTER FIELD fabo033_desc name="input.a.page1_afat504_01.fabo033_desc"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE fabo033_desc
            #add-point:ON CHANGE fabo033_desc name="input.g.page1_afat504_01.fabo033_desc"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD fabo034
            #add-point:BEFORE FIELD fabo034 name="input.b.page1_afat504_01.fabo034"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD fabo034
            
            #add-point:AFTER FIELD fabo034 name="input.a.page1_afat504_01.fabo034"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE fabo034
            #add-point:ON CHANGE fabo034 name="input.g.page1_afat504_01.fabo034"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD fabo034_desc
            #add-point:BEFORE FIELD fabo034_desc name="input.b.page1_afat504_01.fabo034_desc"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD fabo034_desc
            
            #add-point:AFTER FIELD fabo034_desc name="input.a.page1_afat504_01.fabo034_desc"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE fabo034_desc
            #add-point:ON CHANGE fabo034_desc name="input.g.page1_afat504_01.fabo034_desc"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD fabo035
            #add-point:BEFORE FIELD fabo035 name="input.b.page1_afat504_01.fabo035"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD fabo035
            
            #add-point:AFTER FIELD fabo035 name="input.a.page1_afat504_01.fabo035"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE fabo035
            #add-point:ON CHANGE fabo035 name="input.g.page1_afat504_01.fabo035"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD fabo035_desc
            #add-point:BEFORE FIELD fabo035_desc name="input.b.page1_afat504_01.fabo035_desc"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD fabo035_desc
            
            #add-point:AFTER FIELD fabo035_desc name="input.a.page1_afat504_01.fabo035_desc"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE fabo035_desc
            #add-point:ON CHANGE fabo035_desc name="input.g.page1_afat504_01.fabo035_desc"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD fabo036
            #add-point:BEFORE FIELD fabo036 name="input.b.page1_afat504_01.fabo036"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD fabo036
            
            #add-point:AFTER FIELD fabo036 name="input.a.page1_afat504_01.fabo036"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE fabo036
            #add-point:ON CHANGE fabo036 name="input.g.page1_afat504_01.fabo036"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD fabo036_desc
            #add-point:BEFORE FIELD fabo036_desc name="input.b.page1_afat504_01.fabo036_desc"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD fabo036_desc
            
            #add-point:AFTER FIELD fabo036_desc name="input.a.page1_afat504_01.fabo036_desc"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE fabo036_desc
            #add-point:ON CHANGE fabo036_desc name="input.g.page1_afat504_01.fabo036_desc"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD fabo037
            #add-point:BEFORE FIELD fabo037 name="input.b.page1_afat504_01.fabo037"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD fabo037
            
            #add-point:AFTER FIELD fabo037 name="input.a.page1_afat504_01.fabo037"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE fabo037
            #add-point:ON CHANGE fabo037 name="input.g.page1_afat504_01.fabo037"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD fabo037_desc
            #add-point:BEFORE FIELD fabo037_desc name="input.b.page1_afat504_01.fabo037_desc"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD fabo037_desc
            
            #add-point:AFTER FIELD fabo037_desc name="input.a.page1_afat504_01.fabo037_desc"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE fabo037_desc
            #add-point:ON CHANGE fabo037_desc name="input.g.page1_afat504_01.fabo037_desc"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD fabo038
            #add-point:BEFORE FIELD fabo038 name="input.b.page1_afat504_01.fabo038"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD fabo038
            
            #add-point:AFTER FIELD fabo038 name="input.a.page1_afat504_01.fabo038"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE fabo038
            #add-point:ON CHANGE fabo038 name="input.g.page1_afat504_01.fabo038"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD fabo038_desc
            #add-point:BEFORE FIELD fabo038_desc name="input.b.page1_afat504_01.fabo038_desc"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD fabo038_desc
            
            #add-point:AFTER FIELD fabo038_desc name="input.a.page1_afat504_01.fabo038_desc"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE fabo038_desc
            #add-point:ON CHANGE fabo038_desc name="input.g.page1_afat504_01.fabo038_desc"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD fabo039
            #add-point:BEFORE FIELD fabo039 name="input.b.page1_afat504_01.fabo039"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD fabo039
            
            #add-point:AFTER FIELD fabo039 name="input.a.page1_afat504_01.fabo039"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE fabo039
            #add-point:ON CHANGE fabo039 name="input.g.page1_afat504_01.fabo039"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD fabo039_desc
            #add-point:BEFORE FIELD fabo039_desc name="input.b.page1_afat504_01.fabo039_desc"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD fabo039_desc
            
            #add-point:AFTER FIELD fabo039_desc name="input.a.page1_afat504_01.fabo039_desc"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE fabo039_desc
            #add-point:ON CHANGE fabo039_desc name="input.g.page1_afat504_01.fabo039_desc"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD fabo040
            #add-point:BEFORE FIELD fabo040 name="input.b.page1_afat504_01.fabo040"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD fabo040
            
            #add-point:AFTER FIELD fabo040 name="input.a.page1_afat504_01.fabo040"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE fabo040
            #add-point:ON CHANGE fabo040 name="input.g.page1_afat504_01.fabo040"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD fabo040_desc
            #add-point:BEFORE FIELD fabo040_desc name="input.b.page1_afat504_01.fabo040_desc"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD fabo040_desc
            
            #add-point:AFTER FIELD fabo040_desc name="input.a.page1_afat504_01.fabo040_desc"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE fabo040_desc
            #add-point:ON CHANGE fabo040_desc name="input.g.page1_afat504_01.fabo040_desc"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD fabo054
            #add-point:BEFORE FIELD fabo054 name="input.b.page1_afat504_01.fabo054"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD fabo054
            
            #add-point:AFTER FIELD fabo054 name="input.a.page1_afat504_01.fabo054"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE fabo054
            #add-point:ON CHANGE fabo054 name="input.g.page1_afat504_01.fabo054"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD fabo055
            #add-point:BEFORE FIELD fabo055 name="input.b.page1_afat504_01.fabo055"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD fabo055
            
            #add-point:AFTER FIELD fabo055 name="input.a.page1_afat504_01.fabo055"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE fabo055
            #add-point:ON CHANGE fabo055 name="input.g.page1_afat504_01.fabo055"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD fabo055_desc
            #add-point:BEFORE FIELD fabo055_desc name="input.b.page1_afat504_01.fabo055_desc"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD fabo055_desc
            
            #add-point:AFTER FIELD fabo055_desc name="input.a.page1_afat504_01.fabo055_desc"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE fabo055_desc
            #add-point:ON CHANGE fabo055_desc name="input.g.page1_afat504_01.fabo055_desc"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD fabo056
            #add-point:BEFORE FIELD fabo056 name="input.b.page1_afat504_01.fabo056"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD fabo056
            
            #add-point:AFTER FIELD fabo056 name="input.a.page1_afat504_01.fabo056"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE fabo056
            #add-point:ON CHANGE fabo056 name="input.g.page1_afat504_01.fabo056"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD fabo056_desc
            #add-point:BEFORE FIELD fabo056_desc name="input.b.page1_afat504_01.fabo056_desc"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD fabo056_desc
            
            #add-point:AFTER FIELD fabo056_desc name="input.a.page1_afat504_01.fabo056_desc"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE fabo056_desc
            #add-point:ON CHANGE fabo056_desc name="input.g.page1_afat504_01.fabo056_desc"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD fabo060
            #add-point:BEFORE FIELD fabo060 name="input.b.page1_afat504_01.fabo060"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD fabo060
            
            #add-point:AFTER FIELD fabo060 name="input.a.page1_afat504_01.fabo060"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE fabo060
            #add-point:ON CHANGE fabo060 name="input.g.page1_afat504_01.fabo060"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD fabo060_desc
            #add-point:BEFORE FIELD fabo060_desc name="input.b.page1_afat504_01.fabo060_desc"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD fabo060_desc
            
            #add-point:AFTER FIELD fabo060_desc name="input.a.page1_afat504_01.fabo060_desc"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE fabo060_desc
            #add-point:ON CHANGE fabo060_desc name="input.g.page1_afat504_01.fabo060_desc"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD fabo061
            #add-point:BEFORE FIELD fabo061 name="input.b.page1_afat504_01.fabo061"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD fabo061
            
            #add-point:AFTER FIELD fabo061 name="input.a.page1_afat504_01.fabo061"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE fabo061
            #add-point:ON CHANGE fabo061 name="input.g.page1_afat504_01.fabo061"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD fabo061_desc
            #add-point:BEFORE FIELD fabo061_desc name="input.b.page1_afat504_01.fabo061_desc"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD fabo061_desc
            
            #add-point:AFTER FIELD fabo061_desc name="input.a.page1_afat504_01.fabo061_desc"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE fabo061_desc
            #add-point:ON CHANGE fabo061_desc name="input.g.page1_afat504_01.fabo061_desc"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD fabo062
            #add-point:BEFORE FIELD fabo062 name="input.b.page1_afat504_01.fabo062"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD fabo062
            
            #add-point:AFTER FIELD fabo062 name="input.a.page1_afat504_01.fabo062"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE fabo062
            #add-point:ON CHANGE fabo062 name="input.g.page1_afat504_01.fabo062"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD fabo062_desc
            #add-point:BEFORE FIELD fabo062_desc name="input.b.page1_afat504_01.fabo062_desc"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD fabo062_desc
            
            #add-point:AFTER FIELD fabo062_desc name="input.a.page1_afat504_01.fabo062_desc"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE fabo062_desc
            #add-point:ON CHANGE fabo062_desc name="input.g.page1_afat504_01.fabo062_desc"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD fabo063
            #add-point:BEFORE FIELD fabo063 name="input.b.page1_afat504_01.fabo063"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD fabo063
            
            #add-point:AFTER FIELD fabo063 name="input.a.page1_afat504_01.fabo063"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE fabo063
            #add-point:ON CHANGE fabo063 name="input.g.page1_afat504_01.fabo063"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD fabo063_desc
            #add-point:BEFORE FIELD fabo063_desc name="input.b.page1_afat504_01.fabo063_desc"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD fabo063_desc
            
            #add-point:AFTER FIELD fabo063_desc name="input.a.page1_afat504_01.fabo063_desc"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE fabo063_desc
            #add-point:ON CHANGE fabo063_desc name="input.g.page1_afat504_01.fabo063_desc"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD fabo064
            #add-point:BEFORE FIELD fabo064 name="input.b.page1_afat504_01.fabo064"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD fabo064
            
            #add-point:AFTER FIELD fabo064 name="input.a.page1_afat504_01.fabo064"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE fabo064
            #add-point:ON CHANGE fabo064 name="input.g.page1_afat504_01.fabo064"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD fabo064_desc
            #add-point:BEFORE FIELD fabo064_desc name="input.b.page1_afat504_01.fabo064_desc"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD fabo064_desc
            
            #add-point:AFTER FIELD fabo064_desc name="input.a.page1_afat504_01.fabo064_desc"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE fabo064_desc
            #add-point:ON CHANGE fabo064_desc name="input.g.page1_afat504_01.fabo064_desc"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD fabo065
            #add-point:BEFORE FIELD fabo065 name="input.b.page1_afat504_01.fabo065"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD fabo065
            
            #add-point:AFTER FIELD fabo065 name="input.a.page1_afat504_01.fabo065"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE fabo065
            #add-point:ON CHANGE fabo065 name="input.g.page1_afat504_01.fabo065"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD fabo065_desc
            #add-point:BEFORE FIELD fabo065_desc name="input.b.page1_afat504_01.fabo065_desc"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD fabo065_desc
            
            #add-point:AFTER FIELD fabo065_desc name="input.a.page1_afat504_01.fabo065_desc"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE fabo065_desc
            #add-point:ON CHANGE fabo065_desc name="input.g.page1_afat504_01.fabo065_desc"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD fabo066
            #add-point:BEFORE FIELD fabo066 name="input.b.page1_afat504_01.fabo066"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD fabo066
            
            #add-point:AFTER FIELD fabo066 name="input.a.page1_afat504_01.fabo066"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE fabo066
            #add-point:ON CHANGE fabo066 name="input.g.page1_afat504_01.fabo066"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD fabo066_desc
            #add-point:BEFORE FIELD fabo066_desc name="input.b.page1_afat504_01.fabo066_desc"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD fabo066_desc
            
            #add-point:AFTER FIELD fabo066_desc name="input.a.page1_afat504_01.fabo066_desc"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE fabo066_desc
            #add-point:ON CHANGE fabo066_desc name="input.g.page1_afat504_01.fabo066_desc"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD fabo067
            #add-point:BEFORE FIELD fabo067 name="input.b.page1_afat504_01.fabo067"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD fabo067
            
            #add-point:AFTER FIELD fabo067 name="input.a.page1_afat504_01.fabo067"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE fabo067
            #add-point:ON CHANGE fabo067 name="input.g.page1_afat504_01.fabo067"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD fabo067_desc
            #add-point:BEFORE FIELD fabo067_desc name="input.b.page1_afat504_01.fabo067_desc"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD fabo067_desc
            
            #add-point:AFTER FIELD fabo067_desc name="input.a.page1_afat504_01.fabo067_desc"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE fabo067_desc
            #add-point:ON CHANGE fabo067_desc name="input.g.page1_afat504_01.fabo067_desc"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD fabo068
            #add-point:BEFORE FIELD fabo068 name="input.b.page1_afat504_01.fabo068"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD fabo068
            
            #add-point:AFTER FIELD fabo068 name="input.a.page1_afat504_01.fabo068"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE fabo068
            #add-point:ON CHANGE fabo068 name="input.g.page1_afat504_01.fabo068"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD fabo068_desc
            #add-point:BEFORE FIELD fabo068_desc name="input.b.page1_afat504_01.fabo068_desc"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD fabo068_desc
            
            #add-point:AFTER FIELD fabo068_desc name="input.a.page1_afat504_01.fabo068_desc"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE fabo068_desc
            #add-point:ON CHANGE fabo068_desc name="input.g.page1_afat504_01.fabo068_desc"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD fabo069
            #add-point:BEFORE FIELD fabo069 name="input.b.page1_afat504_01.fabo069"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD fabo069
            
            #add-point:AFTER FIELD fabo069 name="input.a.page1_afat504_01.fabo069"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE fabo069
            #add-point:ON CHANGE fabo069 name="input.g.page1_afat504_01.fabo069"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD fabo069_desc
            #add-point:BEFORE FIELD fabo069_desc name="input.b.page1_afat504_01.fabo069_desc"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD fabo069_desc
            
            #add-point:AFTER FIELD fabo069_desc name="input.a.page1_afat504_01.fabo069_desc"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE fabo069_desc
            #add-point:ON CHANGE fabo069_desc name="input.g.page1_afat504_01.fabo069_desc"
            
            #END add-point 
 
 
 
                  #Ctrlp:input.c.page1_afat504_01.faboseq_2
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD faboseq_2
            #add-point:ON ACTION controlp INFIELD faboseq_2 name="input.c.page1_afat504_01.faboseq_2"
            
            #END add-point
 
 
         #Ctrlp:input.c.page1_afat504_01.fabo024
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD fabo024
            #add-point:ON ACTION controlp INFIELD fabo024 name="input.c.page1_afat504_01.fabo024"
            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_fabo_d[l_ac].fabo024             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "" #

            
            CALL aglt310_04()                                #呼叫開窗

            LET g_fabo_d[l_ac].fabo024 = g_qryparam.return1              

            DISPLAY g_fabo_d[l_ac].fabo024 TO fabo024              #

            NEXT FIELD fabo024                          #返回原欄位


            #END add-point
 
 
         #Ctrlp:input.c.page1_afat504_01.fabo024_desc
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD fabo024_desc
            #add-point:ON ACTION controlp INFIELD fabo024_desc name="input.c.page1_afat504_01.fabo024_desc"
            
            #END add-point
 
 
         #Ctrlp:input.c.page1_afat504_01.fabo042
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD fabo042
            #add-point:ON ACTION controlp INFIELD fabo042 name="input.c.page1_afat504_01.fabo042"
            
            #END add-point
 
 
         #Ctrlp:input.c.page1_afat504_01.fabo031
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD fabo031
            #add-point:ON ACTION controlp INFIELD fabo031 name="input.c.page1_afat504_01.fabo031"
            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_fabo2_d[l_ac].fabo031             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "" #

            
           #CALL q_pmaa001()    #160913-00017#1  mark               #呼叫開窗
           #CALL q_pmaa001_25() #160913-00017#1  add                   #161024-00008#4 
           CALL q_ooef001_1()                                          #161024-00008#4 

            LET g_fabo2_d[l_ac].fabo031 = g_qryparam.return1              

            DISPLAY g_fabo2_d[l_ac].fabo031 TO fabo031              #

            NEXT FIELD fabo031                          #返回原欄位


            #END add-point
 
 
         #Ctrlp:input.c.page1_afat504_01.fabo031_desc
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD fabo031_desc
            #add-point:ON ACTION controlp INFIELD fabo031_desc name="input.c.page1_afat504_01.fabo031_desc"
            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_fabo_d[l_ac].fabo031_desc             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "" #

            
            #CALL q_ooed004_1()                                #呼叫開窗 #161024-00008#4 
            CALL q_ooef001_1()                                          #161024-00008#4 

            LET g_fabo_d[l_ac].fabo031_desc = g_qryparam.return1              

            DISPLAY g_fabo_d[l_ac].fabo031_desc TO fabo031_desc              #

            NEXT FIELD fabo031_desc                          #返回原欄位


            #END add-point
 
 
         #Ctrlp:input.c.page1_afat504_01.fabo032
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD fabo032
            #add-point:ON ACTION controlp INFIELD fabo032 name="input.c.page1_afat504_01.fabo032"
            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_fabo2_d[l_ac].fabo032             #給予default值
            LET g_qryparam.default2 = "" #g_fabo2_d[l_ac].oocq002 #應用分類碼
            #給予arg
            LET g_qryparam.arg1 = "" #

            
            CALL q_oocq002()                                #呼叫開窗

            LET g_fabo2_d[l_ac].fabo032 = g_qryparam.return1              
            #LET g_fabo2_d[l_ac].oocq002 = g_qryparam.return2 
            DISPLAY g_fabo2_d[l_ac].fabo032 TO fabo032              #
            #DISPLAY g_fabo2_d[l_ac].oocq002 TO oocq002 #應用分類碼
            NEXT FIELD fabo032                          #返回原欄位


            #END add-point
 
 
         #Ctrlp:input.c.page1_afat504_01.fabo032_desc
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD fabo032_desc
            #add-point:ON ACTION controlp INFIELD fabo032_desc name="input.c.page1_afat504_01.fabo032_desc"
            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_fabo_d[l_ac].fabo032_desc             #給予default值
            LET g_qryparam.default2 = "" #g_fabo_d[l_ac].ooeg001 #部門編號
            #給予arg
            LET g_qryparam.arg1 = "" #

            
            CALL q_ooeg001()                                #呼叫開窗

            LET g_fabo_d[l_ac].fabo032_desc = g_qryparam.return1              
            #LET g_fabo_d[l_ac].ooeg001 = g_qryparam.return2 
            DISPLAY g_fabo_d[l_ac].fabo032_desc TO fabo032_desc              #
            #DISPLAY g_fabo_d[l_ac].ooeg001 TO ooeg001 #部門編號
            NEXT FIELD fabo032_desc                          #返回原欄位


            #END add-point
 
 
         #Ctrlp:input.c.page1_afat504_01.fabo033
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD fabo033
            #add-point:ON ACTION controlp INFIELD fabo033 name="input.c.page1_afat504_01.fabo033"
            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_fabo2_d[l_ac].fabo033             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "" #

            
            CALL q_ooag001()                                #呼叫開窗

            LET g_fabo2_d[l_ac].fabo033 = g_qryparam.return1              

            DISPLAY g_fabo2_d[l_ac].fabo033 TO fabo033              #

            NEXT FIELD fabo033                          #返回原欄位


            #END add-point
 
 
         #Ctrlp:input.c.page1_afat504_01.fabo033_desc
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD fabo033_desc
            #add-point:ON ACTION controlp INFIELD fabo033_desc name="input.c.page1_afat504_01.fabo033_desc"
            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_fabo2_d[l_ac].fabo033_desc             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "" #

            
            CALL q_ooag001()                                #呼叫開窗

            LET g_fabo2_d[l_ac].fabo033_desc = g_qryparam.return1              

            DISPLAY g_fabo2_d[l_ac].fabo033_desc TO fabo033_desc              #

            NEXT FIELD fabo033_desc                          #返回原欄位


            #END add-point
 
 
         #Ctrlp:input.c.page1_afat504_01.fabo034
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD fabo034
            #add-point:ON ACTION controlp INFIELD fabo034 name="input.c.page1_afat504_01.fabo034"
            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_fabo2_d[l_ac].fabo034             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "" #

            
            CALL q_pjba001()                                #呼叫開窗

            LET g_fabo2_d[l_ac].fabo034 = g_qryparam.return1              

            DISPLAY g_fabo2_d[l_ac].fabo034 TO fabo034              #

            NEXT FIELD fabo034                          #返回原欄位


            #END add-point
 
 
         #Ctrlp:input.c.page1_afat504_01.fabo034_desc
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD fabo034_desc
            #add-point:ON ACTION controlp INFIELD fabo034_desc name="input.c.page1_afat504_01.fabo034_desc"
            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_fabo_d[l_ac].fabo034_desc             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "" #

            
            CALL q_pjba001()                                #呼叫開窗

            LET g_fabo_d[l_ac].fabo034_desc = g_qryparam.return1              

            DISPLAY g_fabo_d[l_ac].fabo034_desc TO fabo034_desc              #

            NEXT FIELD fabo034_desc                          #返回原欄位


            #END add-point
 
 
         #Ctrlp:input.c.page1_afat504_01.fabo035
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD fabo035
            #add-point:ON ACTION controlp INFIELD fabo035 name="input.c.page1_afat504_01.fabo035"
            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_fabo2_d[l_ac].fabo035             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "" #

            
            CALL q_pjbb002()                                #呼叫開窗

            LET g_fabo2_d[l_ac].fabo035 = g_qryparam.return1              

            DISPLAY g_fabo2_d[l_ac].fabo035 TO fabo035              #

            NEXT FIELD fabo035                          #返回原欄位


            #END add-point
 
 
         #Ctrlp:input.c.page1_afat504_01.fabo035_desc
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD fabo035_desc
            #add-point:ON ACTION controlp INFIELD fabo035_desc name="input.c.page1_afat504_01.fabo035_desc"
            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_fabo_d[l_ac].fabo035_desc             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "" #

            
            #CALL q_pmaa001()    #160913-00017#1  mark               #呼叫開窗
           CALL q_pmaa001_25() #160913-00017#1  add                          #呼叫開窗

            LET g_fabo_d[l_ac].fabo035_desc = g_qryparam.return1              

            DISPLAY g_fabo_d[l_ac].fabo035_desc TO fabo035_desc              #

            NEXT FIELD fabo035_desc                          #返回原欄位


            #END add-point
 
 
         #Ctrlp:input.c.page1_afat504_01.fabo036
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD fabo036
            #add-point:ON ACTION controlp INFIELD fabo036 name="input.c.page1_afat504_01.fabo036"
            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_fabo_d[l_ac].fabo036             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "" #

            
            #CALL q_pmaa001()    #160913-00017#1  mark               #呼叫開窗
           CALL q_pmaa001_25() #160913-00017#1  add 

            LET g_fabo_d[l_ac].fabo036 = g_qryparam.return1              

            DISPLAY g_fabo_d[l_ac].fabo036 TO fabo036              #

            NEXT FIELD fabo036                          #返回原欄位


            #END add-point
 
 
         #Ctrlp:input.c.page1_afat504_01.fabo036_desc
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD fabo036_desc
            #add-point:ON ACTION controlp INFIELD fabo036_desc name="input.c.page1_afat504_01.fabo036_desc"
            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_fabo_d[l_ac].fabo036_desc             #給予default值
            LET g_qryparam.default2 = "" #g_fabo_d[l_ac].oocq002 #應用分類碼
            #給予arg
            LET g_qryparam.arg1 = "" #

            
            CALL q_oocq002()                                #呼叫開窗

            LET g_fabo_d[l_ac].fabo036_desc = g_qryparam.return1              
            #LET g_fabo_d[l_ac].oocq002 = g_qryparam.return2 
            DISPLAY g_fabo_d[l_ac].fabo036_desc TO fabo036_desc              #
            #DISPLAY g_fabo_d[l_ac].oocq002 TO oocq002 #應用分類碼
            NEXT FIELD fabo036_desc                          #返回原欄位


            #END add-point
 
 
         #Ctrlp:input.c.page1_afat504_01.fabo037
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD fabo037
            #add-point:ON ACTION controlp INFIELD fabo037 name="input.c.page1_afat504_01.fabo037"
            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_fabo_d[l_ac].fabo037             #給予default值
            LET g_qryparam.default2 = "" #g_fabo_d[l_ac].oocq002 #應用分類碼
            #給予arg
            LET g_qryparam.arg1 = "" #

            
            CALL q_oocq002()                                #呼叫開窗

            LET g_fabo_d[l_ac].fabo037 = g_qryparam.return1              
            #LET g_fabo_d[l_ac].oocq002 = g_qryparam.return2 
            DISPLAY g_fabo_d[l_ac].fabo037 TO fabo037              #
            #DISPLAY g_fabo_d[l_ac].oocq002 TO oocq002 #應用分類碼
            NEXT FIELD fabo037                          #返回原欄位


            #END add-point
 
 
         #Ctrlp:input.c.page1_afat504_01.fabo037_desc
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD fabo037_desc
            #add-point:ON ACTION controlp INFIELD fabo037_desc name="input.c.page1_afat504_01.fabo037_desc"
            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_fabo_d[l_ac].fabo037_desc             #給予default值
            LET g_qryparam.default2 = "" #g_fabo_d[l_ac].oocq002 #應用分類碼
            #給予arg
            LET g_qryparam.arg1 = "" #

            
            CALL q_oocq002()                                #呼叫開窗

            LET g_fabo_d[l_ac].fabo037_desc = g_qryparam.return1              
            #LET g_fabo_d[l_ac].oocq002 = g_qryparam.return2 
            DISPLAY g_fabo_d[l_ac].fabo037_desc TO fabo037_desc              #
            #DISPLAY g_fabo_d[l_ac].oocq002 TO oocq002 #應用分類碼
            NEXT FIELD fabo037_desc                          #返回原欄位


            #END add-point
 
 
         #Ctrlp:input.c.page1_afat504_01.fabo038
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD fabo038
            #add-point:ON ACTION controlp INFIELD fabo038 name="input.c.page1_afat504_01.fabo038"
            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_fabo_d[l_ac].fabo038             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "" #

            
            CALL q_ooag001()                                #呼叫開窗

            LET g_fabo_d[l_ac].fabo038 = g_qryparam.return1              

            DISPLAY g_fabo_d[l_ac].fabo038 TO fabo038              #

            NEXT FIELD fabo038                          #返回原欄位


            #END add-point
 
 
         #Ctrlp:input.c.page1_afat504_01.fabo038_desc
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD fabo038_desc
            #add-point:ON ACTION controlp INFIELD fabo038_desc name="input.c.page1_afat504_01.fabo038_desc"
            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_fabo_d[l_ac].fabo038_desc             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "" #

            
            CALL q_ooag001()                                #呼叫開窗

            LET g_fabo_d[l_ac].fabo038_desc = g_qryparam.return1              

            DISPLAY g_fabo_d[l_ac].fabo038_desc TO fabo038_desc              #

            NEXT FIELD fabo038_desc                          #返回原欄位


            #END add-point
 
 
         #Ctrlp:input.c.page1_afat504_01.fabo039
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD fabo039
            #add-point:ON ACTION controlp INFIELD fabo039 name="input.c.page1_afat504_01.fabo039"
            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_fabo_d[l_ac].fabo039             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "" #

            
            CALL q_pjba001()                                #呼叫開窗

            LET g_fabo_d[l_ac].fabo039 = g_qryparam.return1              

            DISPLAY g_fabo_d[l_ac].fabo039 TO fabo039              #

            NEXT FIELD fabo039                          #返回原欄位


            #END add-point
 
 
         #Ctrlp:input.c.page1_afat504_01.fabo039_desc
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD fabo039_desc
            #add-point:ON ACTION controlp INFIELD fabo039_desc name="input.c.page1_afat504_01.fabo039_desc"
            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_fabo_d[l_ac].fabo039_desc             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "" #

            
            CALL q_pjba001()                                #呼叫開窗

            LET g_fabo_d[l_ac].fabo039_desc = g_qryparam.return1              

            DISPLAY g_fabo_d[l_ac].fabo039_desc TO fabo039_desc              #

            NEXT FIELD fabo039_desc                          #返回原欄位


            #END add-point
 
 
         #Ctrlp:input.c.page1_afat504_01.fabo040
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD fabo040
            #add-point:ON ACTION controlp INFIELD fabo040 name="input.c.page1_afat504_01.fabo040"
            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_fabo_d[l_ac].fabo040             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "" #

            
            CALL q_pjbb002()                                #呼叫開窗

            LET g_fabo_d[l_ac].fabo040 = g_qryparam.return1              

            DISPLAY g_fabo_d[l_ac].fabo040 TO fabo040              #

            NEXT FIELD fabo040                          #返回原欄位


            #END add-point
 
 
         #Ctrlp:input.c.page1_afat504_01.fabo040_desc
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD fabo040_desc
            #add-point:ON ACTION controlp INFIELD fabo040_desc name="input.c.page1_afat504_01.fabo040_desc"
            
            #END add-point
 
 
         #Ctrlp:input.c.page1_afat504_01.fabo054
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD fabo054
            #add-point:ON ACTION controlp INFIELD fabo054 name="input.c.page1_afat504_01.fabo054"
            
            #END add-point
 
 
         #Ctrlp:input.c.page1_afat504_01.fabo055
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD fabo055
            #add-point:ON ACTION controlp INFIELD fabo055 name="input.c.page1_afat504_01.fabo055"
            
            #END add-point
 
 
         #Ctrlp:input.c.page1_afat504_01.fabo055_desc
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD fabo055_desc
            #add-point:ON ACTION controlp INFIELD fabo055_desc name="input.c.page1_afat504_01.fabo055_desc"
            
            #END add-point
 
 
         #Ctrlp:input.c.page1_afat504_01.fabo056
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD fabo056
            #add-point:ON ACTION controlp INFIELD fabo056 name="input.c.page1_afat504_01.fabo056"
            
            #END add-point
 
 
         #Ctrlp:input.c.page1_afat504_01.fabo056_desc
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD fabo056_desc
            #add-point:ON ACTION controlp INFIELD fabo056_desc name="input.c.page1_afat504_01.fabo056_desc"
            
            #END add-point
 
 
         #Ctrlp:input.c.page1_afat504_01.fabo060
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD fabo060
            #add-point:ON ACTION controlp INFIELD fabo060 name="input.c.page1_afat504_01.fabo060"
            
            #END add-point
 
 
         #Ctrlp:input.c.page1_afat504_01.fabo060_desc
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD fabo060_desc
            #add-point:ON ACTION controlp INFIELD fabo060_desc name="input.c.page1_afat504_01.fabo060_desc"
            
            #END add-point
 
 
         #Ctrlp:input.c.page1_afat504_01.fabo061
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD fabo061
            #add-point:ON ACTION controlp INFIELD fabo061 name="input.c.page1_afat504_01.fabo061"
            
            #END add-point
 
 
         #Ctrlp:input.c.page1_afat504_01.fabo061_desc
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD fabo061_desc
            #add-point:ON ACTION controlp INFIELD fabo061_desc name="input.c.page1_afat504_01.fabo061_desc"
            
            #END add-point
 
 
         #Ctrlp:input.c.page1_afat504_01.fabo062
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD fabo062
            #add-point:ON ACTION controlp INFIELD fabo062 name="input.c.page1_afat504_01.fabo062"
            
            #END add-point
 
 
         #Ctrlp:input.c.page1_afat504_01.fabo062_desc
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD fabo062_desc
            #add-point:ON ACTION controlp INFIELD fabo062_desc name="input.c.page1_afat504_01.fabo062_desc"
            
            #END add-point
 
 
         #Ctrlp:input.c.page1_afat504_01.fabo063
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD fabo063
            #add-point:ON ACTION controlp INFIELD fabo063 name="input.c.page1_afat504_01.fabo063"
            
            #END add-point
 
 
         #Ctrlp:input.c.page1_afat504_01.fabo063_desc
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD fabo063_desc
            #add-point:ON ACTION controlp INFIELD fabo063_desc name="input.c.page1_afat504_01.fabo063_desc"
            
            #END add-point
 
 
         #Ctrlp:input.c.page1_afat504_01.fabo064
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD fabo064
            #add-point:ON ACTION controlp INFIELD fabo064 name="input.c.page1_afat504_01.fabo064"
            
            #END add-point
 
 
         #Ctrlp:input.c.page1_afat504_01.fabo064_desc
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD fabo064_desc
            #add-point:ON ACTION controlp INFIELD fabo064_desc name="input.c.page1_afat504_01.fabo064_desc"
            
            #END add-point
 
 
         #Ctrlp:input.c.page1_afat504_01.fabo065
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD fabo065
            #add-point:ON ACTION controlp INFIELD fabo065 name="input.c.page1_afat504_01.fabo065"
            
            #END add-point
 
 
         #Ctrlp:input.c.page1_afat504_01.fabo065_desc
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD fabo065_desc
            #add-point:ON ACTION controlp INFIELD fabo065_desc name="input.c.page1_afat504_01.fabo065_desc"
            
            #END add-point
 
 
         #Ctrlp:input.c.page1_afat504_01.fabo066
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD fabo066
            #add-point:ON ACTION controlp INFIELD fabo066 name="input.c.page1_afat504_01.fabo066"
            
            #END add-point
 
 
         #Ctrlp:input.c.page1_afat504_01.fabo066_desc
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD fabo066_desc
            #add-point:ON ACTION controlp INFIELD fabo066_desc name="input.c.page1_afat504_01.fabo066_desc"
            
            #END add-point
 
 
         #Ctrlp:input.c.page1_afat504_01.fabo067
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD fabo067
            #add-point:ON ACTION controlp INFIELD fabo067 name="input.c.page1_afat504_01.fabo067"
            
            #END add-point
 
 
         #Ctrlp:input.c.page1_afat504_01.fabo067_desc
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD fabo067_desc
            #add-point:ON ACTION controlp INFIELD fabo067_desc name="input.c.page1_afat504_01.fabo067_desc"
            
            #END add-point
 
 
         #Ctrlp:input.c.page1_afat504_01.fabo068
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD fabo068
            #add-point:ON ACTION controlp INFIELD fabo068 name="input.c.page1_afat504_01.fabo068"
            
            #END add-point
 
 
         #Ctrlp:input.c.page1_afat504_01.fabo068_desc
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD fabo068_desc
            #add-point:ON ACTION controlp INFIELD fabo068_desc name="input.c.page1_afat504_01.fabo068_desc"
            
            #END add-point
 
 
         #Ctrlp:input.c.page1_afat504_01.fabo069
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD fabo069
            #add-point:ON ACTION controlp INFIELD fabo069 name="input.c.page1_afat504_01.fabo069"
            
            #END add-point
 
 
         #Ctrlp:input.c.page1_afat504_01.fabo069_desc
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD fabo069_desc
            #add-point:ON ACTION controlp INFIELD fabo069_desc name="input.c.page1_afat504_01.fabo069_desc"
            
            #END add-point
 
 
 
 
         #自訂ACTION
         #add-point:單身其他段落處理(EX:on row change, etc...) name="input.other"
         
         #end add-point
 
         AFTER INPUT
            #add-point:單身輸入後處理 name="input.after_input"
            
            #end add-point
            
      END INPUT
      
 
      
      #add-point:自定義input name="input.more_input"
      
      #end add-point
    
      #公用action
      ON ACTION accept
         ACCEPT DIALOG
        
      ON ACTION cancel
         #add-point:cancel name="input.cancel"
         
         #end add-point
         LET INT_FLAG = TRUE 
         EXIT DIALOG
 
      ON ACTION close
         LET INT_FLAG = TRUE 
         EXIT DIALOG
 
      ON ACTION exit
         LET INT_FLAG = TRUE 
         EXIT DIALOG
   
      #交談指令共用ACTION
      &include "common_action.4gl" 
         CONTINUE DIALOG 
   END DIALOG
 
   #add-point:畫面關閉前 name="input.before_close"
   
   #end add-point
   
   #畫面關閉
   CLOSE WINDOW w_afat504_01 
   
   #add-point:input段after input name="input.post_input"
   
   #end add-point    
   
END FUNCTION
 
{</section>}
 
{<section id="afat504_01.other_dialog" readonly="Y" >}

################################################################################
# Descriptions...: 顯示科目與核算項
# Memo...........:
# Usage..........: CALL afat504_01_display()
# Modify.........:
################################################################################
DIALOG afat504_01_display()
   DISPLAY ARRAY g_fabo2_d TO s_detail1_afat504_01.* ATTRIBUTES(COUNT=g_rec_b) 
      
      BEFORE ROW
         LET l_ac = DIALOG.getCurrentRow("s_detail1_afat504_01")
         LET g_detail_idx = l_ac
               
      BEFORE DISPLAY
         IF g_loc = 'm' THEN
            CALL FGL_SET_ARR_CURR(g_detail_idx)
         END IF
         LET g_loc = 'm'
         LET l_ac = DIALOG.getCurrentRow("s_detail1_afat504_01")
         LET g_current_page = 2  
         
      AFTER DISPLAY
         LET g_fabo_d2.* = g_fabo2_d.*
         
   END DISPLAY
END DIALOG

################################################################################
# Descriptions...: 录入科目與核算項
# Memo...........:
# Usage..........: CALL afat504_01_input()
# Modify.........:
################################################################################
DIALOG afat504_01_input()
   DEFINE l_forupd_sql          STRING                        #SELECT ... FOR UPDATE  SQL  
   DEFINE g_insert              LIKE type_t.chr5              #是否導到其他page
   DEFINE l_insert              BOOLEAN
   DEFINE l_cmd                 LIKE type_t.chr1
   DEFINE l_n                   LIKE type_t.num5              #檢查重複用
   DEFINE l_count               LIKE type_t.num5
   DEFINE l_lock_sw             LIKE type_t.chr1              #單身鎖住否
   DEFINE lb_reproduce          BOOLEAN
   DEFINE li_reproduce          LIKE type_t.num5
   DEFINE li_reproduce_target   LIKE type_t.num5
   DEFINE l_success             LIKE type_t.num5 
   DEFINE l_errno               LIKE type_t.chr80   
   DEFINE l_desc                LIKE type_t.chr80     #接受s_get_orga返回值
   DEFINE l_date                LIKE ooed_t.ooed006   #接受s_get_orga返回值
   DEFINE l_faal004             LIKE faal_t.faal004   #清理资产否
   DEFINE l_faah006             LIKE faah_t.faah006   #资产主类型
   DEFINE l_scccode             LIKE fabo_t.fabo024   #科目SCC码
   DEFINE l_fabo001             LIKE fabo_t.fabo001           #财编
   DEFINE l_fabo002             LIKE fabo_t.fabo002           #附号
   DEFINE l_fabo003             LIKE fabo_t.fabo003           #卡片编号
   DEFINE l_fabo049             LIKE fabo_t.fabo049
   DEFINE l_glab002             LIKE glab_t.glab002  
   DEFINE l_glaacomp      LIKE glaa_t.glaacomp  #20141109
   DEFINE l_para_data     STRING                #20141109 
   #161111-00028#7--modify---begin-------------
  #DEFINE g_glad                RECORD LIKE glad_t.*
   DEFINE g_glad RECORD  #帳套科目管理設定檔
       gladent LIKE glad_t.gladent, #企業編號
       gladownid LIKE glad_t.gladownid, #資料所有者
       gladowndp LIKE glad_t.gladowndp, #資料所屬部門
       gladcrtid LIKE glad_t.gladcrtid, #資料建立者
       gladcrtdp LIKE glad_t.gladcrtdp, #資料建立部門
       gladcrtdt LIKE glad_t.gladcrtdt, #資料創建日
       gladmodid LIKE glad_t.gladmodid, #資料修改者
       gladmoddt LIKE glad_t.gladmoddt, #最近修改日
       gladstus LIKE glad_t.gladstus, #狀態碼
       gladld LIKE glad_t.gladld, #帳套
       glad001 LIKE glad_t.glad001, #會計科目編號
       glad002 LIKE glad_t.glad002, #是否按餘額類型產生分錄
       glad003 LIKE glad_t.glad003, #啟用傳票項次細項立沖
       glad004 LIKE glad_t.glad004, #傳票項次異動別
       glad005 LIKE glad_t.glad005, #是否啟用數量金額式
       glad006 LIKE glad_t.glad006, #借方現金變動碼
       glad007 LIKE glad_t.glad007, #啟用部門管理
       glad008 LIKE glad_t.glad008, #啟用利潤成本管理
       glad009 LIKE glad_t.glad009, #啟用區域管理
       glad010 LIKE glad_t.glad010, #啟用收付款客商管理
       glad011 LIKE glad_t.glad011, #啟用客群管理
       glad012 LIKE glad_t.glad012, #啟用產品類別管理
       glad013 LIKE glad_t.glad013, #啟用人員管理
       glad014 LIKE glad_t.glad014, #no use
       glad015 LIKE glad_t.glad015, #啟用專案管理
       glad016 LIKE glad_t.glad016, #啟用WBS管理
       glad017 LIKE glad_t.glad017, #啟用自由核算項一
       glad0171 LIKE glad_t.glad0171, #自由核算項一類型編號
       glad0172 LIKE glad_t.glad0172, #自由核算項一控制方式
       glad018 LIKE glad_t.glad018, #啟用自由核算項二
       glad0181 LIKE glad_t.glad0181, #自由核算項二類型編號
       glad0182 LIKE glad_t.glad0182, #自由核算項二控制方式
       glad019 LIKE glad_t.glad019, #啟用自由核算項三
       glad0191 LIKE glad_t.glad0191, #自由核算項三類型編號
       glad0192 LIKE glad_t.glad0192, #自由核算項三控制方式
       glad020 LIKE glad_t.glad020, #啟用自由核算項四
       glad0201 LIKE glad_t.glad0201, #自由核算項四類型編號
       glad0202 LIKE glad_t.glad0202, #自由核算項四控制方式
       glad021 LIKE glad_t.glad021, #啟用自由核算項五
       glad0211 LIKE glad_t.glad0211, #自由核算項五類型編號
       glad0212 LIKE glad_t.glad0212, #自由核算項五控制方式
       glad022 LIKE glad_t.glad022, #啟用自由核算項六
       glad0221 LIKE glad_t.glad0221, #自由核算項六類型編號
       glad0222 LIKE glad_t.glad0222, #自由核算項六控制方式
       glad023 LIKE glad_t.glad023, #啟用自由核算項七
       glad0231 LIKE glad_t.glad0231, #自由核算項七類型編號
       glad0232 LIKE glad_t.glad0232, #自由核算項七控制方式
       glad024 LIKE glad_t.glad024, #啟用自由核算項八
       glad0241 LIKE glad_t.glad0241, #自由核算項八類型編號
       glad0242 LIKE glad_t.glad0242, #自由核算項八控制方式
       glad025 LIKE glad_t.glad025, #啟用自由核算項九
       glad0251 LIKE glad_t.glad0251, #自由核算項九類型編號
       glad0252 LIKE glad_t.glad0252, #自由核算項九控制方式
       glad026 LIKE glad_t.glad026, #啟用自由核算項十
       glad0261 LIKE glad_t.glad0261, #自由核算項十類型編號
       glad0262 LIKE glad_t.glad0262, #自由核算項十控制方式
       glad027 LIKE glad_t.glad027, #啟用帳款客商管理
       glad030 LIKE glad_t.glad030, #是否進行預算管控
       glad031 LIKE glad_t.glad031, #啟用經營方式管理
       glad032 LIKE glad_t.glad032, #啟用渠道管理
       glad033 LIKE glad_t.glad033, #啟用品牌管理
       glad034 LIKE glad_t.glad034, #科目做多幣別管理
       glad035 LIKE glad_t.glad035, #是否是子系統科目
       glad036 LIKE glad_t.glad036  #貸方現金變動碼
       END RECORD
   #161111-00028#7--modify---end-------------
   DEFINE l_glae009             LIKE glae_t.glae009
   #161221-00054#4--add--s--
   DEFINE l_wc                   STRING
   DEFINE l_glak_sql             STRING
   #161221-00054#4--add--e--   
   
   INPUT ARRAY g_fabo2_d FROM s_detail1_afat504_01.*
         ATTRIBUTE(COUNT = g_rec_b,MAXCOUNT = g_max_rec,WITHOUT DEFAULTS, 
                 INSERT ROW = FALSE, #此頁面insert功能由產生器控制, 手動之設定無效! 

                 DELETE ROW = g_detail_delete,
                 APPEND ROW = g_detail_delete)
                 
         #自訂ACTION(detail_input,page_2)
         
         
         BEFORE INPUT
           
            CALL afat504_01_b_fill()
            LET g_rec_b = g_fabo2_d.getLength()
            
            LET g_forupd_sql = " SELECT fabgsite,'',fabg001,'',fabgld,'',fabg002,'',fabg003,'',fabg004,fabg005, 
            fabgdocno,fabgdocdt,fabg008,fabg009,fabg015,fabg016,fabgstus,fabgownid,'',fabgowndp,'',fabgcrtid, 
            '',fabgcrtdp,'',fabgcrtdt,fabgmodid,'',fabgmoddt,fabgcnfid,'',fabgcnfdt,fabgpstid,'',fabgpstdt", 
             
                           " FROM fabg_t",
                           " WHERE fabgent= ? AND fabgld=? AND fabgdocno=? FOR UPDATE"
   
            LET g_forupd_sql = cl_sql_forupd(g_forupd_sql)                #轉換不同資料庫語法
            LET g_forupd_sql = cl_sql_add_mask(g_forupd_sql)              #遮蔽特定資料
            DECLARE afat504_01_cl CURSOR FROM g_forupd_sql      
            
            LET g_forupd_sql = "SELECT faboseq,fabo024,fabo042,fabo031,'',fabo032,'',fabo033,'',fabo034,'',fabo035,
                               '',fabo036,'',fabo037,'',fabo038,'',fabo039,'',fabo040,'',fabo054,fabo055,'',fabo056,''
                               FROM fabo_t  
                               WHERE faboent=? AND fabold=? AND fabodocno=? AND faboseq=? FOR UPDATE"


#            LET g_forupd_sql = "SELECT faboseq,fabo024,fabo042,faajsite,'',faaj039,'',faaj040,'',faaj041,'',faaj042,
#                               '',faaj043,'',faaj044,'',faaj047,'',faaj045,'',faaj046
#                               FROM fabo_t,faaj_t  
#                               WHERE faaj001=fabo001 AND faaj002=fabo002 AND faaj037=fabo003 AND faajent=faboent
#                               AND faboent=? AND fabold=? AND fabodocno=? AND faboseq=? FOR UPDATE"
            
            LET g_forupd_sql = cl_sql_forupd(g_forupd_sql)
            LET g_forupd_sql = cl_sql_add_mask(g_forupd_sql)              #遮蔽特定資料
            DECLARE afat504_01_bcl CURSOR FROM g_forupd_sql
            
            SELECT glaa004 INTO g_glaa004 FROM glaa_t WHERE glaaent=g_enterprise AND glaald=g_fabgld
            SELECT fabgdocdt INTO g_fabgdocdt FROM fabg_t 
            WHERE fabgent=g_enterprise AND fabgld=g_fabgld AND fabgdocno=g_fabgdocno
            #end add-point
            
         BEFORE INSERT
            LET g_insert = 'Y' 
            NEXT FIELD faboseq_2
 
            LET l_insert = TRUE
            LET l_n = ARR_COUNT()
            LET l_cmd = 'a'
            INITIALIZE g_fabo2_d[l_ac].* TO NULL 
            INITIALIZE g_fabo2_d_t.* TO NULL 
            
            #add-point:modify段before備份

            #end add-point
            LET g_fabo2_d_t.* = g_fabo2_d[l_ac].*     #新輸入資料
            CALL cl_show_fld_cont()
            
            #add-point:modify段after_set_entry_b

            #end add-point
    
            IF lb_reproduce THEN
               LET lb_reproduce = FALSE
               LET g_fabo2_d[li_reproduce_target].* = g_fabo2_d[li_reproduce].*
               LET g_fabo2_d[li_reproduce_target].faboseq = NULL
            END IF
            #公用欄位給值(單身2)
            
            
            #add-point:modify段before insert

            #end add-point  
            
         BEFORE ROW     
            #add-point:modify段before row2

            #end add-point  
            LET l_insert = FALSE
            LET l_cmd = ''
            LET l_ac = ARR_CURR()
            LET g_detail_idx = l_ac
              
            LET l_lock_sw = 'N'            #DEFAULT
            LET l_n = ARR_COUNT()
            DISPLAY l_ac TO FORMONLY.idx
         
            CALL s_transaction_begin()
            OPEN afat504_01_cl USING g_enterprise,g_fabgld,g_fabgdocno
            IF STATUS THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = "OPEN afat504_cl:" 
               LET g_errparam.code   = STATUS 
               LET g_errparam.popup  = TRUE 
               CALL cl_err()
               CLOSE afat504_01_cl
               CALL s_transaction_end('N','0')
               RETURN
            END IF
            LET g_rec_b = g_fabo2_d.getLength()
            
            IF g_rec_b >= l_ac 
               AND g_fabo2_d[l_ac].faboseq IS NOT NULL
            THEN 
               LET l_cmd='u'
               LET g_fabo2_d_t.* = g_fabo2_d[l_ac].*  #BACKUP
               #add-point:modify段after_set_entry_b

               #end add-point  
               IF NOT afat504_01_lock_b("fabo_t","'2'") THEN
                  LET l_lock_sw='Y'
               ELSE
                  FETCH afat504_01_bcl INTO g_fabo2_d[l_ac].faboseq,g_fabo2_d[l_ac].fabo024, 
                      g_fabo2_d[l_ac].fabo042,
                      g_fabo2_d[l_ac].fabo031,g_fabo2_d[l_ac].fabo031_desc,
                      g_fabo2_d[l_ac].fabo032,g_fabo2_d[l_ac].fabo032_desc,
                      g_fabo2_d[l_ac].fabo033,g_fabo2_d[l_ac].fabo033_desc,
                      g_fabo2_d[l_ac].fabo034,g_fabo2_d[l_ac].fabo034_desc,
                      g_fabo2_d[l_ac].fabo035,g_fabo2_d[l_ac].fabo035_desc,
                      g_fabo2_d[l_ac].fabo036,g_fabo2_d[l_ac].fabo036_desc,
                      g_fabo2_d[l_ac].fabo037,g_fabo2_d[l_ac].fabo037_desc, 
                      g_fabo2_d[l_ac].fabo038,g_fabo2_d[l_ac].fabo038_desc,
                      g_fabo2_d[l_ac].fabo039,g_fabo2_d[l_ac].fabo039_desc,
                      g_fabo2_d[l_ac].fabo040,g_fabo2_d[l_ac].fabo040_desc,
                      g_fabo2_d[l_ac].fabo055,g_fabo2_d[l_ac].fabo055_desc,
                      g_fabo2_d[l_ac].fabo056,g_fabo2_d[l_ac].fabo056_desc
                      
                  IF SQLCA.sqlcode THEN
                     INITIALIZE g_errparam TO NULL 
                     LET g_errparam.extend = '' 
                     LET g_errparam.code   = SQLCA.sqlcode 
                     LET g_errparam.popup  = TRUE 
                     CALL cl_err()
                     LET l_lock_sw = "Y"
                  END IF
                  
                  CALL cl_show_fld_cont()
               END IF
            ELSE
               LET l_cmd='a'
            END IF
            #add-point:modify段before row
            #161221-00054#4--add--s--xul
            LET l_wc = g_fabo2_d[l_ac].fabo024
            CALL s_fin_get_wc_str(l_wc) RETURNING l_wc
            #161221-00054#4--add--e--xul
            CALL s_fin_sel_glad(g_fabgld,g_fabo2_d[l_ac].fabo024,'ALL') RETURNING g_glad.* #20150115 add by chenying
            IF cl_null(g_fabo2_d[l_ac].fabo024) THEN 
               SELECT fabo001,fabo002,fabo003,fabo049 INTO l_fabo001,l_fabo002,l_fabo003,l_fabo049 FROM fabo_t WHERE faboent=g_enterprise
                     AND fabodocno=g_fabgdocno AND  faboseq=g_fabo2_d[l_ac].faboseq
               #根据财编+卡片编号+附号获取资产主类别
               SELECT faah006 INTO l_faah006 FROM faah_t WHERE faahent=g_enterprise AND faah001=l_fabo001 AND faah003=l_fabo002 AND faah004=l_fabo003
              
               #根据帐套+资产主类别判断是否转入清理科目
#1109 mod
#               SELECT faal004 INTO l_faal004 FROM faal_t WHERE faalent=g_enterprise AND faalld=g_fabgld AND faal001=l_faah006
#               IF l_faal004='Y' THEN               #资产处置转入清理科目，则取资产清理科目（afai071）作为异动科目
                SELECT glaacomp INTO l_glaacomp FROM glaa_t WHERE glaaent = g_enterprise AND glaald = g_fabgld
                CALL cl_get_para(g_enterprise,l_glaacomp,'S-FIN-9017') RETURNING l_para_data
                IF l_para_data = 'Y' THEN         
#1109 mod                  
                  LET l_scccode='9902_12'
                  LET l_glab002='25' 
               ELSE 
                   #资产处置不转入清理科目，判断‘处分损益fabo049’是否大于零 如果大于零，
                   #则取出售收益科目作为异动科目，否则取出售损失科目作为异动科目
                  IF l_fabo049>0 THEN  
                     LET l_scccode='9902_06'
                     LET l_glab002='41'                     
                  ELSE 
                     LET l_scccode='9902_07' 
                     LET l_glab002='42' 
                  END IF                     
               END IF
              
               SELECT glab005 INTO g_fabo2_d[l_ac].fabo024 FROM glab_t
               WHERE glabent=g_enterprise AND glabld=g_fabgld AND glab001='90' AND glab002=l_glab002 AND glab003=l_scccode
               DISPLAY BY NAME g_fabo2_d[l_ac].fabo024
               CALL afat504_01_fabo024_desc(g_fabo2_d[l_ac].fabo024) RETURNING g_fabo2_d[l_ac].fabo024_desc  #20141112 add returning
            END IF
            CALL s_fin_sel_glad(g_fabgld,g_fabo2_d[l_ac].fabo024,'ALL') RETURNING g_glad.* #20150115 add by chenying
            LET g_fabo2_d[l_ac].fabo031_desc=g_fabo2_d[l_ac].fabo031
            LET g_fabo2_d[l_ac].fabo032_desc=g_fabo2_d[l_ac].fabo032
            LET g_fabo2_d[l_ac].fabo033_desc=g_fabo2_d[l_ac].fabo033
            LET g_fabo2_d[l_ac].fabo034_desc=g_fabo2_d[l_ac].fabo034
            LET g_fabo2_d[l_ac].fabo035_desc=g_fabo2_d[l_ac].fabo035
            LET g_fabo2_d[l_ac].fabo036_desc=g_fabo2_d[l_ac].fabo036
            LET g_fabo2_d[l_ac].fabo037_desc=g_fabo2_d[l_ac].fabo037
            LET g_fabo2_d[l_ac].fabo038_desc=g_fabo2_d[l_ac].fabo038
            LET g_fabo2_d[l_ac].fabo039_desc=g_fabo2_d[l_ac].fabo039
            LET g_fabo2_d[l_ac].fabo040_desc=g_fabo2_d[l_ac].fabo040
            LET g_fabo2_d[l_ac].fabo055_desc=g_fabo2_d[l_ac].fabo055
            LET g_fabo2_d[l_ac].fabo056_desc=g_fabo2_d[l_ac].fabo056 
            LET g_fabo2_d[l_ac].fabo060_desc=g_fabo2_d[l_ac].fabo060
            LET g_fabo2_d[l_ac].fabo061_desc=g_fabo2_d[l_ac].fabo061
            LET g_fabo2_d[l_ac].fabo062_desc=g_fabo2_d[l_ac].fabo062
            LET g_fabo2_d[l_ac].fabo063_desc=g_fabo2_d[l_ac].fabo063
            LET g_fabo2_d[l_ac].fabo064_desc=g_fabo2_d[l_ac].fabo064
            LET g_fabo2_d[l_ac].fabo065_desc=g_fabo2_d[l_ac].fabo065
            LET g_fabo2_d[l_ac].fabo066_desc=g_fabo2_d[l_ac].fabo066
            LET g_fabo2_d[l_ac].fabo067_desc=g_fabo2_d[l_ac].fabo067 
            LET g_fabo2_d[l_ac].fabo068_desc=g_fabo2_d[l_ac].fabo068
            LET g_fabo2_d[l_ac].fabo069_desc=g_fabo2_d[l_ac].fabo069              
            CALL afat504_01_b_ref()
            #end add-point  
            #其他table資料備份(確定是否更改用)
            
            #其他table進行lock
            
            
         BEFORE DELETE                            #是否取消單身
            IF l_cmd = 'a' THEN
               LET l_cmd='d'
            ELSE
               IF NOT cl_ask_del_detail() THEN
#                  CANCEL DELETE
               END IF
               IF l_lock_sw = "Y" THEN
                  INITIALIZE g_errparam TO NULL 
                  LET g_errparam.extend = "" 
                  LET g_errparam.code   = -263 
                  LET g_errparam.popup  = TRUE 
                  CALL cl_err()
#                  CANCEL DELETE
               END IF
               
               #add-point:單身2刪除前

               #end add-point    
               
               DELETE FROM fabo_t
                WHERE faboent = g_enterprise AND fabold = g_fabgld AND
                                          fabodocno = g_fabgdocno AND
                      faboseq = g_fabo2_d_t.faboseq
                  
               #add-point:單身2刪除中

               #end add-point    
                  
               IF SQLCA.sqlcode THEN
                  INITIALIZE g_errparam TO NULL 
                  LET g_errparam.extend = "fabo_t" 
                  LET g_errparam.code   = SQLCA.sqlcode 
                  LET g_errparam.popup  = TRUE 
                  CALL cl_err()
                  CALL s_transaction_end('N','0')
#                  CANCEL DELETE   
               ELSE
                  LET g_rec_b = g_rec_b-1
                  
                  #add-point:單身2刪除後

                  #end add-point
                  CALL s_transaction_end('Y','0')
               END IF 
               CLOSE afat504_01_bcl
#               LET l_count = g_fabo_d.getLength()
                              INITIALIZE gs_keys TO NULL 
               LET gs_keys[1] = g_fabgld
               LET gs_keys[2] = g_fabgdocno
               LET gs_keys[3] = g_fabo2_d[g_detail_idx].faboseq
 
            END IF 
            
         AFTER DELETE 
            IF l_cmd <> 'd' THEN
               #add-point:單身AFTER DELETE 

               #end add-point
                              CALL afat504_01_delete_b('fabo_t',gs_keys,"'2'")
            END IF
            #如果是最後一筆
            IF l_ac = (g_fabo2_d.getLength() + 1) THEN
               CALL FGL_SET_ARR_CURR(l_ac-1)
            END IF
 
         AFTER INSERT    
            LET l_insert = FALSE
            IF INT_FLAG THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = '' 
               LET g_errparam.code   = 9001 
               LET g_errparam.popup  = FALSE 
               CALL cl_err()
               LET INT_FLAG = 0
#               CANCEL INSERT
            END IF
               
            #add-point:單身2新增前

            #end add-point
               
            LET l_count = 1  
            SELECT COUNT(*) INTO l_count FROM fabo_t 
             WHERE faboent = g_enterprise AND fabold = g_fabgld
               AND fabodocno = g_fabgdocno
               AND faboseq = g_fabo2_d[l_ac].faboseq
                
            #資料未重複, 插入新增資料
            IF l_count = 0 THEN 
               #add-point:單身2新增前

               #end add-point
            
                              INITIALIZE gs_keys TO NULL 
               LET gs_keys[1] = g_fabgld
               LET gs_keys[2] = g_fabgdocno
               LET gs_keys[3] = g_fabo2_d[g_detail_idx].faboseq
#               CALL afat504_01_insert_b('fabo_t',gs_keys,"'2'")
                           
               #add-point:單身新增後2

               #end add-point
            ELSE    
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = 'INSERT' 
               LET g_errparam.code   = "std-00006" 
               LET g_errparam.popup  = TRUE 
               CALL cl_err()
               INITIALIZE g_fabo2_d[l_ac].* TO NULL
               CALL s_transaction_end('N','0')
#               CANCEL INSERT
            END IF
 
            IF SQLCA.SQLcode  THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = "fabo_t" 
               LET g_errparam.code   = SQLCA.sqlcode 
               LET g_errparam.popup  = TRUE 
               CALL cl_err()
               CALL s_transaction_end('N','0')                    
#               CANCEL INSERT
            ELSE
               #先刷新資料
               #CALL afat503_b_fill()
               #資料多語言用-增/改
               
               #add-point:單身新增後

               #end add-point
               CALL s_transaction_end('Y','0')
               ERROR 'INSERT O.K'
               LET g_rec_b = g_rec_b + 1
            END IF
            
         ON ROW CHANGE 
            IF INT_FLAG THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = '' 
               LET g_errparam.code   = 9001 
               LET g_errparam.popup  = FALSE 
               CALL cl_err()
               LET INT_FLAG = 0
               LET g_fabo2_d[l_ac].* = g_fabo2_d_t.*
               CLOSE afat504_01_bcl
               CALL s_transaction_end('N','0')
               EXIT DIALOG 
            END IF
            
            IF l_lock_sw = 'Y' THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = '' 
               LET g_errparam.code   = -263 
               LET g_errparam.popup  = TRUE 
               CALL cl_err()
               LET g_fabo2_d[l_ac].* = g_fabo2_d_t.*
            ELSE
               #add-point:單身page2修改前

               #end add-point
               
               #寫入修改者/修改日期資訊(單身2)
               
               
               UPDATE fabo_t SET (fabo024, 
                   fabo042,fabo031,fabo032,fabo033,fabo034,fabo035,fabo036,fabo037,fabo038,fabo039,fabo040,
                   fabo054,fabo055,fabo056,fabo060,fabo061,fabo062,fabo063,fabo064,fabo065,fabo066,fabo067,fabo068,fabo069 
                   ) = (g_fabo2_d[l_ac].fabo024, 
                   g_fabo2_d[l_ac].fabo042,g_fabo2_d[l_ac].fabo031,g_fabo2_d[l_ac].fabo032,g_fabo2_d[l_ac].fabo033, 
                   g_fabo2_d[l_ac].fabo034,g_fabo2_d[l_ac].fabo035,g_fabo2_d[l_ac].fabo036,g_fabo2_d[l_ac].fabo037, 
                   g_fabo2_d[l_ac].fabo038,g_fabo2_d[l_ac].fabo039,g_fabo2_d[l_ac].fabo040,g_fabo2_d[l_ac].fabo054,
                   g_fabo2_d[l_ac].fabo055,g_fabo2_d[l_ac].fabo056,g_fabo2_d[l_ac].fabo060,g_fabo2_d[l_ac].fabo061,
                   g_fabo2_d[l_ac].fabo062,g_fabo2_d[l_ac].fabo063,g_fabo2_d[l_ac].fabo064,g_fabo2_d[l_ac].fabo065,
                   g_fabo2_d[l_ac].fabo066,g_fabo2_d[l_ac].fabo067,g_fabo2_d[l_ac].fabo068,g_fabo2_d[l_ac].fabo069 
                   ) #自訂欄位頁簽 

                WHERE faboent = g_enterprise AND fabold = g_fabgld
                  AND fabodocno = g_fabgdocno
                  AND faboseq = g_fabo2_d_t.faboseq #項次 
                  
               #add-point:單身page2修改中

               #end add-point
                  
               CASE
                  WHEN SQLCA.sqlerrd[3] = 0  #更新不到的處理
                     INITIALIZE g_errparam TO NULL 
                     LET g_errparam.extend = "fabo_t" 
                     LET g_errparam.code   = "std-00009" 
                     LET g_errparam.popup  = TRUE 
                     CALL cl_err()
                     CALL s_transaction_end('N','0')
                     LET g_fabo2_d[l_ac].* = g_fabo2_d_t.*
                  WHEN SQLCA.sqlcode #其他錯誤
                     INITIALIZE g_errparam TO NULL 
                     LET g_errparam.extend = "fabo_t" 
                     LET g_errparam.code   = SQLCA.sqlcode 
                     LET g_errparam.popup  = TRUE 
                     CALL cl_err()
                     CALL s_transaction_end('N','0')
                     LET g_fabo2_d[l_ac].* = g_fabo2_d_t.*
                  OTHERWISE
                                    INITIALIZE gs_keys TO NULL 
               LET gs_keys[1] = g_fabgld
               LET gs_keys_bak[1] = g_fabgld_o
               LET gs_keys[2] = g_fabgdocno
               LET gs_keys_bak[2] = g_fabgdocno_o
               LET gs_keys[3] = g_fabo2_d[g_detail_idx].faboseq
               LET gs_keys_bak[3] = g_fabo2_d_t.faboseq
               CALL afat504_01_update_b('fabo_t',gs_keys,gs_keys_bak,"'2'")
                     #資料多語言用-增/改
                     
               END CASE
               
               #修改歷程記錄
               LET g_log1 = util.JSON.stringify(g_fabo2_d_t)
               LET g_log2 = util.JSON.stringify(g_fabo2_d[l_ac])
               IF NOT cl_log_modified_record(g_log1,g_log2) THEN 
                  CALL s_transaction_end('N','0')
               END IF
               
               #add-point:單身page2修改後

               #end add-point
            END IF
         
                  #此段落由子樣板a02產生
         AFTER FIELD fabo024
            
            #add-point:AFTER FIELD fabo024
            IF NOT cl_null(g_fabo2_d[l_ac].fabo024) THEN                                           
               CALL afat504_01_fabo024_chk(g_fabo2_d[l_ac].fabo024)
               IF NOT cl_null(g_errno) THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = g_errno
                  LET g_errparam.extend = g_fabo2_d[l_ac].fabo024
                  #160318-00005#11   --add--str
                  LET g_errparam.replace[1] ='agli020'
                  LET g_errparam.replace[2] = cl_get_progname('agli020',g_lang,"2")
                  LET g_errparam.exeprog    ='agli020'
                  #160318-00005#11  --add--end
                  LET g_errparam.popup = FALSE
                  CALL cl_err()

                  LET g_fabo2_d[l_ac].fabo024 = g_fabo_d_t.fabo024
                  NEXT FIELD fabo024                  
               END IF 
            END IF
            #161221-00054#4--add--s--xul
            LET l_wc = g_fabo2_d[l_ac].fabo024
            CALL s_fin_get_wc_str(l_wc) RETURNING l_wc
            #161221-00054#4--add--e--xul   
            CALL afat504_01_fabo024_desc(g_fabo2_d[l_ac].fabo024) RETURNING g_fabo2_d[l_ac].fabo024_desc  #20141112 add returning
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD fabo024
            #add-point:BEFORE FIELD fabo024

            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE fabo024
            #add-point:ON CHANGE fabo024

            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD fabo042
            #add-point:BEFORE FIELD fabo042

            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD fabo042
            
            #add-point:AFTER FIELD fabo042

            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE fabo042
            #add-point:ON CHANGE fabo042

            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD fabo031
            #add-point:BEFORE FIELD fabo031

            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD fabo031
            
            #add-point:AFTER FIELD fabo031
            
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE fabo031
            #add-point:ON CHANGE fabo031

            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD fabo031_desc
            #add-point:BEFORE FIELD fabo031_desc
            LET g_fabo2_d[l_ac].fabo031_desc = g_fabo2_d[l_ac].fabo031
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD fabo031_desc
            
            #add-point:AFTER FIELD fabo031_desc
            IF NOT cl_null(g_fabo2_d[l_ac].fabo031_desc) THEN
#               CALL s_get_orga('2',g_fabo2_d[l_ac].fabo031_desc,'',g_fabgdocdt) 
#               RETURNING l_success,g_fabo2_d[l_ac].fabo031_desc,l_desc,l_desc,l_date,l_date,l_errno
#               IF l_success = FALSE THEN
#                  INITIALIZE g_errparam TO NULL
#                  LET g_errparam.code = l_errno
#                  LET g_errparam.extend = g_fabo2_d[l_ac].fabo031_desc
#                  LET g_errparam.popup = FALSE
#                  CALL cl_err()
#               
#                  LET g_fabo2_d[l_ac].fabo031_desc = g_fabo2_d_t.fabo031
#                  NEXT FIELD fabo031_desc
#               END IF 
               CALL s_voucher_glaq017_chk(g_fabo2_d[l_ac].fabo031_desc)
               IF NOT cl_null(g_errno) THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.extend = ''
                  LET g_errparam.code   = g_errno
                  #160321-00016#26 --s add
                  LET g_errparam.replace[1] = 'aooi100'
                  LET g_errparam.replace[2] = cl_get_progname('aooi100',g_lang,"2")
                  LET g_errparam.exeprog = 'aooi100'
                  #160321-00016#26 --e add
                  LET g_errparam.popup  = TRUE 
                  CALL cl_err()   
                  
                  LET g_fabo2_d[l_ac].fabo031_desc = g_fabo2_d_t.fabo031
                  NEXT FIELD fabo031_desc
               END IF            
               #161024-00008#4---s---
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_fabo2_d[l_ac].fabo031_desc 
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_ooef001_20") THEN
                  #161221-00054#4--add--s--xul
                  #判断agli060是否设置限制核算项资料，如果设置，判断是否满足agli060条件
                  CALL s_voucher_hsx_glak_chk(g_fabgld,'01',g_fabo2_d[l_ac].fabo024,g_fabo2_d[l_ac].fabo031_desc) RETURNING g_sub_success
                  IF NOT g_sub_success THEN
                     LET g_fabo2_d[l_ac].fabo031_desc = g_fabo2_d_t.fabo031
                     NEXT FIELD fabo031_desc
                  END IF
                  #161221-00054#4--add--e--xul
               ELSE
                  #檢查失敗時後續處理
                  LET g_fabo2_d[l_ac].fabo031_desc = g_fabo2_d_t.fabo031
                  NEXT FIELD fabo031_desc
               END IF
               #161024-00008#4---e---               
               
            END IF
            LET g_fabo2_d[l_ac].fabo031 = g_fabo2_d[l_ac].fabo031_desc
            CALL afat504_01_fabo031_desc(g_fabo2_d[l_ac].fabo031_desc) RETURNING l_desc
            LET g_fabo2_d[l_ac].fabo031_desc=g_fabo2_d[l_ac].fabo031_desc,l_desc
            DISPLAY BY NAME g_fabo2_d[l_ac].fabo031_desc
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE fabo031_desc
            #add-point:ON CHANGE fabo031_desc

            #END add-point
            
         #此段落由子樣板a01產生
         BEFORE FIELD fabo032
            #add-point:BEFORE FIELD fabo032

            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD fabo032
            
            #add-point:AFTER FIELD fabo032
            
            
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE fabo032
            #add-point:ON CHANGE fabo032

            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD fabo032_desc
            #add-point:BEFORE FIELD fabo032_desc
            LET g_fabo2_d[l_ac].fabo032_desc = g_fabo2_d[l_ac].fabo032
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD fabo032_desc
            
            #add-point:AFTER FIELD fabo032_desc
            IF NOT cl_null(g_fabo2_d[l_ac].fabo032_desc) THEN
#               CALL afat504_01_fabo032_chk(g_fabo2_d[l_ac].fabo032_desc)
#               IF NOT cl_null(g_errno) THEN
#                  INITIALIZE g_errparam TO NULL
#                  LET g_errparam.code = g_errno
#                  LET g_errparam.extend = g_fabo2_d[l_ac].fabo032_desc
#                  LET g_errparam.popup = FALSE
#                  CALL cl_err()
#
#                  LET g_fabo2_d[l_ac].fabo032_desc = g_fabo_d_t.fabo032
#                  NEXT FIELD fabo032_desc                  
#               END IF
               CALL s_department_chk(g_fabo2_d[l_ac].fabo032_desc,g_fabgdocdt) RETURNING g_sub_success
               IF NOT g_sub_success THEN
                  LET g_fabo2_d[l_ac].fabo032_desc = g_fabo_d_t.fabo032 
                  NEXT FIELD fabo032_desc                  
               END IF
               #161221-00054#4--add--s--xul
               #判断agli060是否设置限制核算项资料，如果设置，判断是否满足agli060条件
               CALL s_voucher_hsx_glak_chk(g_fabgld,'02',g_fabo2_d[l_ac].fabo024,g_fabo2_d[l_ac].fabo032_desc) RETURNING g_sub_success
               IF NOT g_sub_success THEN
                  LET g_fabo2_d[l_ac].fabo032_desc = g_fabo_d_t.fabo032 
                  NEXT FIELD fabo032_desc
               END IF
               #161221-00054#4--add--e--xul               
            END IF
            LET g_fabo2_d[l_ac].fabo032 = g_fabo2_d[l_ac].fabo032_desc
            CALL afat504_01_fabo031_desc(g_fabo2_d[l_ac].fabo032_desc) RETURNING l_desc
            LET g_fabo2_d[l_ac].fabo032_desc=g_fabo2_d[l_ac].fabo032_desc,l_desc
            DISPLAY BY NAME g_fabo2_d[l_ac].fabo032_desc
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE fabo032_desc
            #add-point:ON CHANGE fabo032_desc

            #END add-point
            
         #此段落由子樣板a01產生
         BEFORE FIELD fabo033
            #add-point:BEFORE FIELD fabo033

            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD fabo033
            
            #add-point:AFTER FIELD fabo033
            
            
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE fabo033
            #add-point:ON CHANGE fabo033

            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD fabo033_desc
            #add-point:BEFORE FIELD fabo033_desc
            LET g_fabo2_d[l_ac].fabo033_desc = g_fabo2_d[l_ac].fabo033
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD fabo033_desc
            
            #add-point:AFTER FIELD fabo033_desc
            IF NOT cl_null(g_fabo2_d[l_ac].fabo033_desc) THEN
#               CALL s_get_orga('6',g_fabo2_d[l_ac].fabo033_desc,'',g_fabgdocdt) 
#               RETURNING l_success,g_fabo2_d[l_ac].fabo033_desc,l_desc,l_desc,l_date,l_date,l_errno
#               IF l_success = FALSE THEN
#                  INITIALIZE g_errparam TO NULL
#                  LET g_errparam.code = l_errno
#                  LET g_errparam.extend = g_fabo2_d[l_ac].fabo033_desc
#                  LET g_errparam.popup = FALSE
#                  CALL cl_err()
#               
#                  LET g_fabo2_d[l_ac].fabo033_desc = g_fabo2_d_t.fabo033
#                  NEXT FIELD fabo033_desc
#               END IF
               CALL s_voucher_glaq019_chk(g_fabo2_d[l_ac].fabo033_desc,g_fabgdocdt) 
               IF NOT cl_null(g_errno) THEN
                  LET g_fabo2_d[l_ac].fabo033_desc = g_fabo2_d_t.fabo033
                  NEXT FIELD fabo033_desc
               END IF
               #161221-00054#4--add--s--xul
               #判断agli060是否设置限制核算项资料，如果设置，判断是否满足agli060条件
               CALL s_voucher_hsx_glak_chk(g_fabgld,'03',g_fabo2_d[l_ac].fabo024,g_fabo2_d[l_ac].fabo033_desc) RETURNING g_sub_success
               IF NOT g_sub_success THEN
                  LET g_fabo2_d[l_ac].fabo033_desc = g_fabo2_d_t.fabo033
                  NEXT FIELD fabo033_desc
               END IF
               #161221-00054#4--add--e--xul                  
            END IF
            LET g_fabo2_d[l_ac].fabo033 = g_fabo2_d[l_ac].fabo033_desc
            CALL afat504_01_fabo031_desc(g_fabo2_d[l_ac].fabo033_desc) RETURNING l_desc
            LET g_fabo2_d[l_ac].fabo033_desc=g_fabo2_d[l_ac].fabo033_desc,l_desc
            DISPLAY BY NAME g_fabo2_d[l_ac].fabo033_desc
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE fabo033_desc
            #add-point:ON CHANGE fabo033_desc

            #END add-point
            
         #此段落由子樣板a01產生
         BEFORE FIELD fabo034
            #add-point:BEFORE FIELD fabo034

            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD fabo034
            
            #add-point:AFTER FIELD fabo034
            
            
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE fabo034
            #add-point:ON CHANGE fabo034

            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD fabo034_desc
            #add-point:BEFORE FIELD fabo034_desc
            LET g_fabo2_d[l_ac].fabo034_desc = g_fabo2_d[l_ac].fabo034
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD fabo034_desc
            
            #add-point:AFTER FIELD fabo034_desc
            IF NOT cl_null(g_fabo2_d[l_ac].fabo034_desc) THEN
#               CALL afat504_01_fabo034_chk('287',g_fabo2_d[l_ac].fabo034_desc)
#               IF NOT cl_null(g_errno) THEN
#                  INITIALIZE g_errparam TO NULL
#                  LET g_errparam.code = g_errno
#                  LET g_errparam.extend = g_fabo2_d[l_ac].fabo034_desc
#                  LET g_errparam.popup = FALSE
#                  CALL cl_err()
#                  LET g_fabo2_d[l_ac].fabo034_desc = g_fabo2_d_t.fabo034
#                  NEXT FIELD fabo034_desc
#               END IF
               IF NOT s_azzi650_chk_exist('287',g_fabo2_d[l_ac].fabo034_desc) THEN
                  LET g_fabo2_d[l_ac].fabo034_desc = g_fabo2_d_t.fabo034
                  NEXT FIELD fabo034_desc               
               END IF
               #161221-00054#4--add--s--xul
               #判断agli060是否设置限制核算项资料，如果设置，判断是否满足agli060条件
               CALL s_voucher_hsx_glak_chk(g_fabgld,'04',g_fabo2_d[l_ac].fabo024,g_fabo2_d[l_ac].fabo034_desc) RETURNING g_sub_success
               IF NOT g_sub_success THEN
                  LET g_fabo2_d[l_ac].fabo034_desc = g_fabo2_d_t.fabo034
                  NEXT FIELD fabo034_desc  
               END IF
               #161221-00054#4--add--e--xul                 
            END IF
            LET g_fabo2_d[l_ac].fabo034 = g_fabo2_d[l_ac].fabo034_desc
            CALL afat504_01_fabo056_desc('287',g_fabo2_d[l_ac].fabo034_desc) RETURNING l_desc
            LET g_fabo2_d[l_ac].fabo034_desc=g_fabo2_d[l_ac].fabo034_desc,l_desc
            DISPLAY BY NAME g_fabo2_d[l_ac].fabo034_desc
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE fabo034_desc
            #add-point:ON CHANGE fabo034_desc

            #END add-point
            
         #此段落由子樣板a01產生
         BEFORE FIELD fabo035
            #add-point:BEFORE FIELD fabo035

            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD fabo035
            
            #add-point:AFTER FIELD fabo035
            
            
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE fabo035
            #add-point:ON CHANGE fabo035

            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD fabo035_desc
            #add-point:BEFORE FIELD fabo035_desc
            LET g_fabo2_d[l_ac].fabo035_desc = g_fabo2_d[l_ac].fabo035
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD fabo035_desc
            
            #add-point:AFTER FIELD fabo035_desc
            IF NOT cl_null(g_fabo2_d[l_ac].fabo035_desc) THEN
#               CALL afat504_01_fabo035_chk(g_fabo2_d[l_ac].fabo035_desc)
#               IF NOT cl_null(g_errno) THEN
#                  INITIALIZE g_errparam TO NULL
#                  LET g_errparam.code = g_errno
#                  LET g_errparam.extend = g_fabo2_d[l_ac].fabo035_desc
#                  LET g_errparam.popup = FALSE
#                  CALL cl_err()
#               
#                  LET g_fabo2_d[l_ac].fabo035_desc = g_fabo2_d_t.fabo035
#                  NEXT FIELD fabo035_desc
#               END IF
               CALL s_voucher_glaq021_chk(g_fabo2_d[l_ac].fabo035_desc)
               IF NOT cl_null(g_errno) THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.extend = ''
                  LET g_errparam.code   = g_errno
                  #160321-00016#26 --s add
                  LET g_errparam.replace[1] = 'apmm100'
                  LET g_errparam.replace[2] = cl_get_progname('apmm100',g_lang,"2")
                  LET g_errparam.exeprog = 'apmm100'
                  #160321-00016#26 --e add
                  LET g_errparam.popup  = TRUE 
                  CALL cl_err()
                  
                  LET g_fabo2_d[l_ac].fabo035_desc = g_fabo2_d_t.fabo035
                  NEXT FIELD fabo035_desc
               END IF
               #161221-00054#4--add--s--xul
               #判断agli060是否设置限制核算项资料，如果设置，判断是否满足agli060条件
               CALL s_voucher_hsx_glak_chk(g_fabgld,'05',g_fabo2_d[l_ac].fabo024,g_fabo2_d[l_ac].fabo035_desc) RETURNING g_sub_success
               IF NOT g_sub_success THEN
                  LET g_fabo2_d[l_ac].fabo035_desc = g_fabo2_d_t.fabo035
                  NEXT FIELD fabo035_desc
               END IF
               #161221-00054#4--add--e--xul                 
            END IF
            LET g_fabo2_d[l_ac].fabo035 = g_fabo2_d[l_ac].fabo035_desc
            CALL afat504_01_fabo035_desc(g_fabo2_d[l_ac].fabo035_desc) RETURNING l_desc
            LET g_fabo2_d[l_ac].fabo035_desc=g_fabo2_d[l_ac].fabo035_desc,l_desc
            DISPLAY BY NAME g_fabo2_d[l_ac].fabo035_desc
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE fabo035_desc
            #add-point:ON CHANGE fabo035_desc

            #END add-point
            
         #此段落由子樣板a01產生
         BEFORE FIELD fabo036
            #add-point:BEFORE FIELD fabo036

            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD fabo036
            
            #add-point:AFTER FIELD fabo036
            
            
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE fabo036
            #add-point:ON CHANGE fabo036

            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD fabo036_desc
            #add-point:BEFORE FIELD fabo036_desc
            LET g_fabo2_d[l_ac].fabo036_desc = g_fabo2_d[l_ac].fabo036
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD fabo036_desc
            
            #add-point:AFTER FIELD fabo036_desc
            IF NOT cl_null(g_fabo2_d[l_ac].fabo036_desc) THEN
#               CALL afat504_01_fabo035_chk(g_fabo2_d[l_ac].fabo036_desc)
#               IF NOT cl_null(g_errno) THEN
#                  INITIALIZE g_errparam TO NULL
#                  LET g_errparam.code = g_errno
#                  LET g_errparam.extend = g_fabo2_d[l_ac].fabo036_desc
#                  LET g_errparam.popup = FALSE
#                  CALL cl_err()
#               
#                  LET g_fabo2_d[l_ac].fabo036_desc = g_fabo2_d_t.fabo036
#                  NEXT FIELD fabo036_desc
#               END IF
               CALL s_voucher_glaq021_chk(g_fabo2_d[l_ac].fabo036_desc)
               IF NOT cl_null(g_errno) THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.extend = ''
                  LET g_errparam.code   = g_errno
                  #160321-00016#26 --s add
                  LET g_errparam.replace[1] = 'apmm100'
                  LET g_errparam.replace[2] = cl_get_progname('apmm100',g_lang,"2")
                  LET g_errparam.exeprog = 'apmm100'
                  #160321-00016#26 --e add
                  LET g_errparam.popup  = TRUE 
                  CALL cl_err()
                  
                  LET g_fabo2_d[l_ac].fabo036_desc = g_fabo2_d_t.fabo036
                  NEXT FIELD fabo036_desc
               END IF
               #161221-00054#4--add--s--xul
               #判断agli060是否设置限制核算项资料，如果设置，判断是否满足agli060条件
               CALL s_voucher_hsx_glak_chk(g_fabgld,'06',g_fabo2_d[l_ac].fabo024,g_fabo2_d[l_ac].fabo036_desc) RETURNING g_sub_success
               IF NOT g_sub_success THEN
                  LET g_fabo2_d[l_ac].fabo036_desc = g_fabo2_d_t.fabo036
                  NEXT FIELD fabo036_desc
               END IF
               #161221-00054#4--add--e--xul   
               
            END IF
            LET g_fabo2_d[l_ac].fabo036 = g_fabo2_d[l_ac].fabo036_desc
            CALL afat504_01_fabo035_desc(g_fabo2_d[l_ac].fabo036_desc) RETURNING l_desc
            LET g_fabo2_d[l_ac].fabo036_desc=g_fabo2_d[l_ac].fabo036_desc,l_desc
            DISPLAY BY NAME g_fabo2_d[l_ac].fabo036_desc
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE fabo036_desc
            #add-point:ON CHANGE fabo036_desc

            #END add-point
            
         #此段落由子樣板a01產生
         BEFORE FIELD fabo037
            #add-point:BEFORE FIELD fabo037

            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD fabo037
            
            #add-point:AFTER FIELD fabo037
            
           
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE fabo037
            #add-point:ON CHANGE fabo037

            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD fabo037_desc
            #add-point:BEFORE FIELD fabo037_desc
            LET g_fabo2_d[l_ac].fabo037_desc = g_fabo2_d[l_ac].fabo037
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD fabo037_desc
            
            #add-point:AFTER FIELD fabo037_desc
            IF NOT cl_null(g_fabo2_d[l_ac].fabo037_desc) THEN
#               CALL afat504_01_fabo034_chk('281',g_fabo2_d[l_ac].fabo037_desc)
#               IF NOT cl_null(g_errno) THEN
#                  INITIALIZE g_errparam TO NULL
#                  LET g_errparam.code = g_errno
#                  LET g_errparam.extend = g_fabo2_d[l_ac].fabo037_desc
#                  LET g_errparam.popup = FALSE
#                  CALL cl_err()
#               
#                  LET g_fabo2_d[l_ac].fabo037_desc = g_fabo2_d_t.fabo037
#                  NEXT FIELD fabo037_desc
#               END IF 
               IF NOT s_azzi650_chk_exist('281',g_fabo2_d[l_ac].fabo037_desc) THEN
                  LET g_fabo2_d[l_ac].fabo037_desc = g_fabo2_d_t.fabo037
                  NEXT FIELD fabo037_desc               
               END IF
               #161221-00054#4--add--s--xul
               #判断agli060是否设置限制核算项资料，如果设置，判断是否满足agli060条件
               CALL s_voucher_hsx_glak_chk(g_fabgld,'07',g_fabo2_d[l_ac].fabo024,g_fabo2_d[l_ac].fabo037_desc) RETURNING g_sub_success
               IF NOT g_sub_success THEN
                  LET g_fabo2_d[l_ac].fabo037_desc = g_fabo2_d_t.fabo037
                  NEXT FIELD fabo037_desc 
               END IF
               #161221-00054#4--add--e--xul   
            END IF
            LET g_fabo2_d[l_ac].fabo037 = g_fabo2_d[l_ac].fabo037_desc
            CALL afat504_01_fabo056_desc('281',g_fabo2_d[l_ac].fabo037_desc) RETURNING l_desc 
            LET g_fabo2_d[l_ac].fabo037_desc=g_fabo2_d[l_ac].fabo037_desc,l_desc
            DISPLAY BY NAME g_fabo2_d[l_ac].fabo037_desc
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE fabo037_desc
            #add-point:ON CHANGE fabo037_desc

            #END add-point
            
         #此段落由子樣板a01產生
         BEFORE FIELD fabo038
            #add-point:BEFORE FIELD fabo038

            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD fabo038
            
            #add-point:AFTER FIELD fabo038
            
            
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE fabo038
            #add-point:ON CHANGE fabo038

            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD fabo038_desc
            #add-point:BEFORE FIELD fabo038_desc
            LET g_fabo2_d[l_ac].fabo038_desc = g_fabo2_d[l_ac].fabo038
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD fabo038_desc
            
            #add-point:AFTER FIELD fabo038_desc
            IF NOT cl_null(g_fabo2_d[l_ac].fabo038_desc) THEN
#               CALL afat504_01_fabo038_chk(g_fabo2_d[l_ac].fabo038_desc)
#               IF NOT cl_null(g_errno) THEN
#                  INITIALIZE g_errparam TO NULL
#                  LET g_errparam.code = g_errno
#                  LET g_errparam.extend = g_fabo2_d[l_ac].fabo038_desc
#                  LET g_errparam.popup = FALSE
#                  CALL cl_err()
#               
#                  LET g_fabo2_d[l_ac].fabo038_desc = g_fabo2_d_t.fabo038
#                  NEXT FIELD fabo038_desc
#               END IF
               CALL s_employee_chk(g_fabo2_d[l_ac].fabo038_desc) RETURNING g_sub_success
               IF NOT g_sub_success THEN 
                  LET g_fabo2_d[l_ac].fabo038_desc = g_fabo2_d_t.fabo038
                  NEXT FIELD fabo038_desc
               END IF
               #161221-00054#4--add--s--xul
               #判断agli060是否设置限制核算项资料，如果设置，判断是否满足agli060条件
               CALL s_voucher_hsx_glak_chk(g_fabgld,'12',g_fabo2_d[l_ac].fabo024,g_fabo2_d[l_ac].fabo038_desc) RETURNING g_sub_success
               IF NOT g_sub_success THEN
                  LET g_fabo2_d[l_ac].fabo038_desc = g_fabo2_d_t.fabo038
                  NEXT FIELD fabo038_desc
               END IF
               #161221-00054#4--add--e--xul                
            END IF
            LET g_fabo2_d[l_ac].fabo038 = g_fabo2_d[l_ac].fabo038_desc 
            CALL afat504_01_fabo038_desc(g_fabo2_d[l_ac].fabo038_desc) RETURNING l_desc
            LET g_fabo2_d[l_ac].fabo038_desc=g_fabo2_d[l_ac].fabo038_desc,l_desc
            DISPLAY BY NAME g_fabo2_d[l_ac].fabo038_desc
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE fabo038_desc
            #add-point:ON CHANGE fabo038_desc

            #END add-point
            
         #此段落由子樣板a01產生
         BEFORE FIELD fabo039
            #add-point:BEFORE FIELD fabo039

            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD fabo039
            
            #add-point:AFTER FIELD fabo039

            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE fabo039
            #add-point:ON CHANGE fabo039

            #END add-point
         BEFORE FIELD fabo039_desc
            LET g_fabo2_d[l_ac].fabo039_desc=g_fabo2_d[l_ac].fabo039
            
         AFTER FIELD fabo039_desc
            IF NOT cl_null(g_fabo2_d[l_ac].fabo039_desc) THEN 
#               #此段落由子樣板a19產生
#               #校驗代值
#               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
#               INITIALIZE g_chkparam.* TO NULL
#               
#               #設定g_chkparam.*的參數
#               LET g_chkparam.arg1 = g_fabo2_d[l_ac].fabo039_desc
#                  
#               #呼叫檢查存在並帶值的library
#               IF cl_chk_exist("v_pjba001") THEN
#                  #檢查成功時後續處理
#                  #LET  = g_chkparam.return1
#                  #DISPLAY BY NAME 
#                  LET g_fabo2_d[l_ac].fabo039=g_fabo2_d[l_ac].fabo039_desc
#               ELSE
#                  #檢查失敗時後續處理
#                  LET g_fabo2_d[l_ac].fabo039_desc=g_fabo2_d_t.fabo039
#                  NEXT FIELD CURRENT
#               END IF
               CALL s_aap_project_chk(g_fabo2_d[l_ac].fabo039_desc) RETURNING g_sub_success,g_errno
               IF NOT g_sub_success THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = g_errno
                  LET g_errparam.extend = ''
                  #160321-00016#26 --s add
                  LET g_errparam.replace[1] = 'apjm200'
                  LET g_errparam.replace[2] = cl_get_progname('apjm200',g_lang,"2")
                  LET g_errparam.exeprog = 'apjm200'
                  #160321-00016#26 --e add
                  LET g_errparam.popup = TRUE
                  CALL cl_err()
                  LET g_fabo2_d[l_ac].fabo039_desc=g_fabo2_d_t.fabo039
                  NEXT FIELD CURRENT
               END IF 
               #161221-00054#4--add--s--xul
               #判断agli060是否设置限制核算项资料，如果设置，判断是否满足agli060条件
               CALL s_voucher_hsx_glak_chk(g_fabgld,'13',g_fabo2_d[l_ac].fabo024,g_fabo2_d[l_ac].fabo039_desc) RETURNING g_sub_success
               IF NOT g_sub_success THEN
                  LET g_fabo2_d[l_ac].fabo039_desc=g_fabo2_d_t.fabo039
                  NEXT FIELD CURRENT
               END IF
               #161221-00054#4--add--e--xul  
            END IF
            LET g_fabo2_d[l_ac].fabo039=g_fabo2_d[l_ac].fabo039_desc            
            CALL afat504_01_fabo039_desc(g_fabo2_d[l_ac].fabo039_desc) RETURNING l_desc
            LET g_fabo2_d[l_ac].fabo039_desc=g_fabo2_d[l_ac].fabo039_desc,l_desc
            DISPLAY BY NAME g_fabo2_d[l_ac].fabo039_desc
            
         #此段落由子樣板a01產生
         BEFORE FIELD fabo040
            #add-point:BEFORE FIELD fabo040

            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD fabo040
            
            #add-point:AFTER FIELD fabo040

            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE fabo040
            #add-point:ON CHANGE fabo040

            #END add-point

         #20150115 add by chenying
          BEFORE FIELD fabo040_desc
            LET g_fabo2_d[l_ac].fabo040_desc=g_fabo2_d[l_ac].fabo040
            
         AFTER FIELD fabo040_desc
            IF NOT cl_null(g_fabo2_d[l_ac].fabo040_desc) THEN  
               CALL s_voucher_glaq028_chk(g_fabo2_d[l_ac].fabo039,g_fabo2_d[l_ac].fabo040_desc)
               IF NOT cl_null(g_errno) THEN  
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = g_errno
                  LET g_errparam.extend = ''
                  LET g_errparam.popup = TRUE
                  CALL cl_err()
                  LET g_fabo2_d[l_ac].fabo040_desc = g_fabo2_d_t.fabo040
                  NEXT FIELD CURRENT
               END IF    
               #161221-00054#4--add--s--xul
               #判断agli060是否设置限制核算项资料，如果设置，判断是否满足agli060条件
               CALL s_voucher_hsx_glak_chk(g_fabgld,'14',g_fabo2_d[l_ac].fabo024,g_fabo2_d[l_ac].fabo040_desc) RETURNING g_sub_success
               IF NOT g_sub_success THEN
                 LET g_fabo2_d[l_ac].fabo040_desc = g_fabo2_d_t.fabo040
                 NEXT FIELD CURRENT
               END IF
               #161221-00054#4--add--e--xul              
            END IF 
            LET g_fabo2_d[l_ac].fabo040=g_fabo2_d[l_ac].fabo040_desc
            CALL afat504_01_fabo040_desc(g_fabo2_d[l_ac].fabo039,g_fabo2_d[l_ac].fabo040_desc) RETURNING l_desc
            LET g_fabo2_d[l_ac].fabo040_desc=g_fabo2_d[l_ac].fabo040_desc,l_desc
            DISPLAY BY NAME g_fabo2_d[l_ac].fabo040_desc  

         AFTER FIELD fabo054
            IF NOT cl_null(g_fabo2_d[l_ac].fabo054) THEN
               CALL s_voucher_glaq051_chk(g_fabo2_d[l_ac].fabo054)
               IF NOT cl_null(g_errno) THEN
                  LET g_fabo2_d[l_ac].fabo054 = g_fabo2_d_t.fabo054
                  NEXT FIELD CURRENT                 
               END IF
               #161221-00054#4--add--s--xul
               #判断agli060是否设置限制核算项资料，如果设置，判断是否满足agli060条件
               CALL s_voucher_hsx_glak_chk(g_fabgld,'09',g_fabo2_d[l_ac].fabo024,g_fabo2_d[l_ac].fabo054) RETURNING g_sub_success
               IF NOT g_sub_success THEN
                  LET g_fabo2_d[l_ac].fabo054 = g_fabo2_d_t.fabo054
                  NEXT FIELD CURRENT
               END IF
               #161221-00054#4--add--e--xul    
            END IF 

         BEFORE FIELD fabo055_desc
            LET g_fabo2_d[l_ac].fabo055_desc=g_fabo2_d[l_ac].fabo055
            
         AFTER FIELD fabo055_desc
            IF NOT cl_null(g_fabo2_d[l_ac].fabo055_desc) THEN
               CALL s_voucher_glaq052_chk(g_fabo2_d[l_ac].fabo055_desc)
               IF NOT cl_null(g_errno) THEN 
                  LET g_fabo2_d[l_ac].fabo055_desc = g_fabo2_d_t.fabo055
                  NEXT FIELD CURRENT
               END IF
               #161221-00054#4--add--s--xul
               #判断agli060是否设置限制核算项资料，如果设置，判断是否满足agli060条件
               CALL s_voucher_hsx_glak_chk(g_fabgld,'10',g_fabo2_d[l_ac].fabo024,g_fabo2_d[l_ac].fabo055_desc) RETURNING g_sub_success
               IF NOT g_sub_success THEN
                  LET g_fabo2_d[l_ac].fabo055_desc = g_fabo2_d_t.fabo055
                  NEXT FIELD CURRENT
               END IF
               #161221-00054#4--add--e--xul  
            END IF 
            LET g_fabo2_d[l_ac].fabo055 = g_fabo2_d[l_ac].fabo055_desc
            CALL afat504_01_fabo055_desc(g_fabo2_d[l_ac].fabo055_desc)  RETURNING l_desc     
            LET g_fabo2_d[l_ac].fabo055_desc=g_fabo2_d[l_ac].fabo055_desc,l_desc
            DISPLAY BY NAME g_fabo2_d[l_ac].fabo055_desc   

         BEFORE FIELD fabo056_desc
            LET g_fabo2_d[l_ac].fabo056_desc=g_fabo2_d[l_ac].fabo056
            
         AFTER FIELD fabo056_desc
            IF NOT cl_null(g_fabo2_d[l_ac].fabo056_desc) THEN
               IF NOT s_azzi650_chk_exist('2002',g_fabo2_d[l_ac].fabo056_desc) THEN
                  LET g_fabo2_d[l_ac].fabo056_desc = g_fabo2_d_t.fabo056
                  NEXT FIELD CURRENT
               END IF
               #161221-00054#4--add--s--xul
               #判断agli060是否设置限制核算项资料，如果设置，判断是否满足agli060条件
               CALL s_voucher_hsx_glak_chk(g_fabgld,'11',g_fabo2_d[l_ac].fabo024,g_fabo2_d[l_ac].fabo056_desc) RETURNING g_sub_success
               IF NOT g_sub_success THEN
                  LET g_fabo2_d[l_ac].fabo056_desc = g_fabo2_d_t.fabo056
                  NEXT FIELD CURRENT
               END IF
               #161221-00054#4--add--e--xul  
            END IF 
            LET g_fabo2_d[l_ac].fabo056 = g_fabo2_d[l_ac].fabo056_desc
            CALL afat504_01_fabo056_desc('2002',g_fabo2_d[l_ac].fabo056_desc)  RETURNING l_desc     
            LET g_fabo2_d[l_ac].fabo056_desc=g_fabo2_d[l_ac].fabo056_desc,l_desc
            DISPLAY BY NAME g_fabo2_d[l_ac].fabo056_desc  
            
         #自由核算项
         #自由核算項一
         BEFORE FIELD fabo060_desc
            CALL s_fin_get_glae009(g_glad.glad0171) RETURNING l_glae009
            LET g_fabo2_d[l_ac].fabo060_desc=g_fabo2_d[l_ac].fabo060
         
         AFTER FIELD fabo060_desc
            IF NOT cl_null(g_fabo2_d[l_ac].fabo060_desc) THEN
               IF ( g_fabo2_d[l_ac].fabo060_desc != g_fabo2_d_t.fabo060_desc OR g_fabo2_d_t.fabo060_desc IS NULL ) THEN
                  LET g_fabo2_d[l_ac].fabo060 = g_fabo2_d[l_ac].fabo060_desc
 
                     CALL s_voucher_free_account_chk(g_glad.glad0171,g_fabo2_d[l_ac].fabo060_desc,g_glad.glad0172) RETURNING g_errno
                     IF NOT cl_null(g_errno) THEN
                        LET g_fabo2_d[l_ac].fabo060        = g_fabo2_d_t.fabo060
                        LET g_fabo2_d[l_ac].fabo060_desc = g_fabo2_d_t.fabo060_desc
                        DISPLAY BY NAME g_fabo2_d[l_ac].fabo060,g_fabo2_d[l_ac].fabo060_desc
                        NEXT FIELD CURRENT
                     END IF
                    
               END IF
            END IF
          LET g_fabo2_d[l_ac].fabo060 = g_fabo2_d[l_ac].fabo060_desc   
         LET g_fabo2_d[l_ac].fabo060_desc = s_desc_show1(g_fabo2_d[l_ac].fabo060,s_fin_get_accting_desc(g_glad.glad0171,g_fabo2_d[l_ac].fabo060))
         LET g_fabo2_d_t.fabo060_desc = g_fabo2_d[l_ac].fabo060_desc
         DISPLAY BY NAME g_fabo2_d[l_ac].fabo060,g_fabo2_d[l_ac].fabo060_desc 

         #自由核算項二
         BEFORE FIELD fabo061_desc
            CALL s_fin_get_glae009(g_glad.glad0181) RETURNING l_glae009
            LET g_fabo2_d[l_ac].fabo061_desc=g_fabo2_d[l_ac].fabo061
            
         AFTER FIELD fabo061_desc
            IF NOT cl_null(g_fabo2_d[l_ac].fabo061_desc) THEN
               IF ( g_fabo2_d[l_ac].fabo061_desc != g_fabo2_d_t.fabo061_desc OR g_fabo2_d_t.fabo061_desc IS NULL ) THEN
                  LET g_fabo2_d[l_ac].fabo061 = g_fabo2_d[l_ac].fabo061_desc
                   
                     CALL s_voucher_free_account_chk(g_glad.glad0181,g_fabo2_d[l_ac].fabo061_desc,g_glad.glad0182) RETURNING g_errno
                     IF NOT cl_null(g_errno) THEN
                        LET g_fabo2_d[l_ac].fabo061        = g_fabo2_d_t.fabo061
                        LET g_fabo2_d[l_ac].fabo061_desc = g_fabo2_d_t.fabo061_desc
                        DISPLAY BY NAME g_fabo2_d[l_ac].fabo061,g_fabo2_d[l_ac].fabo061_desc
                        NEXT FIELD CURRENT
                     END IF
                     
               END IF
            END IF
            LET g_fabo2_d[l_ac].fabo061 = g_fabo2_d[l_ac].fabo061_desc
            LET g_fabo2_d[l_ac].fabo061_desc = s_desc_show1(g_fabo2_d[l_ac].fabo061,s_fin_get_accting_desc(g_glad.glad0181,g_fabo2_d[l_ac].fabo061))
            LET g_fabo2_d_t.fabo061_desc = g_fabo2_d[l_ac].fabo061_desc
            DISPLAY BY NAME g_fabo2_d[l_ac].fabo061,g_fabo2_d[l_ac].fabo061_desc

   
         
         #自由核算項三
         BEFORE FIELD fabo062_desc
            CALL s_fin_get_glae009(g_glad.glad0191) RETURNING l_glae009
            LET g_fabo2_d[l_ac].fabo062_desc=g_fabo2_d[l_ac].fabo062

         
         AFTER FIELD fabo062_desc
            IF NOT cl_null(g_fabo2_d[l_ac].fabo062_desc)  THEN
               IF ( g_fabo2_d[l_ac].fabo062_desc != g_fabo2_d_t.fabo062_desc OR g_fabo2_d_t.fabo062_desc IS NULL ) THEN
                  LET g_fabo2_d[l_ac].fabo062 = g_fabo2_d[l_ac].fabo062_desc
                   
                     CALL s_voucher_free_account_chk(g_glad.glad0191,g_fabo2_d[l_ac].fabo062_desc,g_glad.glad0192) RETURNING g_errno
                     IF NOT cl_null(g_errno) THEN
                        LET g_fabo2_d[l_ac].fabo062        = g_fabo2_d_t.fabo062
                        LET g_fabo2_d[l_ac].fabo062_desc = g_fabo2_d_t.fabo062_desc
                        DISPLAY BY NAME g_fabo2_d[l_ac].fabo062,g_fabo2_d[l_ac].fabo062_desc
                        NEXT FIELD CURRENT
                     END IF
                     
               END IF
            END IF
            LET g_fabo2_d[l_ac].fabo062 = g_fabo2_d[l_ac].fabo062_desc
            LET g_fabo2_d[l_ac].fabo062_desc = s_desc_show1(g_fabo2_d[l_ac].fabo062,s_fin_get_accting_desc(g_glad.glad0191,g_fabo2_d[l_ac].fabo062))
            LET g_fabo2_d_t.fabo062_desc = g_fabo2_d[l_ac].fabo062_desc
            DISPLAY BY NAME g_fabo2_d[l_ac].fabo062,g_fabo2_d[l_ac].fabo062_desc

 
            
         #自由核算項四
         BEFORE FIELD fabo063_desc
            CALL s_fin_get_glae009(g_glad.glad0201) RETURNING l_glae009
            LET g_fabo2_d[l_ac].fabo063_desc=g_fabo2_d[l_ac].fabo063

         
         AFTER FIELD fabo063_desc
            IF NOT cl_null(g_fabo2_d[l_ac].fabo063_desc) THEN
               IF ( g_fabo2_d[l_ac].fabo063_desc != g_fabo2_d_t.fabo063_desc OR g_fabo2_d_t.fabo063_desc IS NULL ) THEN
                  LET g_fabo2_d[l_ac].fabo063 = g_fabo2_d[l_ac].fabo063_desc
                   
                     CALL s_voucher_free_account_chk(g_glad.glad0201,g_fabo2_d[l_ac].fabo063_desc,g_glad.glad0202) RETURNING g_errno
                     IF NOT cl_null(g_errno) THEN
                        LET g_fabo2_d[l_ac].fabo063        = g_fabo2_d_t.fabo063
                        LET g_fabo2_d[l_ac].fabo063_desc = g_fabo2_d_t.fabo063_desc
                        DISPLAY BY NAME g_fabo2_d[l_ac].fabo063,g_fabo2_d[l_ac].fabo063_desc
                        NEXT FIELD CURRENT
                     END IF
                     
               END IF
            END IF
            LET g_fabo2_d[l_ac].fabo063 = g_fabo2_d[l_ac].fabo063_desc
            LET g_fabo2_d[l_ac].fabo063_desc = s_desc_show1(g_fabo2_d[l_ac].fabo063,s_fin_get_accting_desc(g_glad.glad0201,g_fabo2_d[l_ac].fabo063))
            LET g_fabo2_d_t.fabo063_desc = g_fabo2_d[l_ac].fabo063_desc
            DISPLAY BY NAME g_fabo2_d[l_ac].fabo063,g_fabo2_d[l_ac].fabo063_desc

  
         
         #自由核算項五
         BEFORE FIELD fabo064_desc
            CALL s_fin_get_glae009(g_glad.glad0211) RETURNING l_glae009
            LET g_fabo2_d[l_ac].fabo064_desc=g_fabo2_d[l_ac].fabo064

         AFTER FIELD fabo064_desc 
            IF NOT cl_null(g_fabo2_d[l_ac].fabo064_desc) THEN
               IF ( g_fabo2_d[l_ac].fabo064_desc != g_fabo2_d_t.fabo064_desc OR g_fabo2_d_t.fabo064_desc IS NULL ) THEN
                  LET g_fabo2_d[l_ac].fabo064 = g_fabo2_d[l_ac].fabo064_desc
                   
                     CALL s_voucher_free_account_chk(g_glad.glad0211,g_fabo2_d[l_ac].fabo064_desc,g_glad.glad0212) RETURNING g_errno
                     IF NOT cl_null(g_errno) THEN
                        LET g_fabo2_d[l_ac].fabo064        = g_fabo2_d_t.fabo064
                        LET g_fabo2_d[l_ac].fabo064_desc = g_fabo2_d_t.fabo064_desc
                        DISPLAY BY NAME g_fabo2_d[l_ac].fabo064,g_fabo2_d[l_ac].fabo064_desc
                        NEXT FIELD CURRENT
                     END IF
                     
               END IF
            END IF
            LET g_fabo2_d[l_ac].fabo064 = g_fabo2_d[l_ac].fabo064_desc
            LET g_fabo2_d[l_ac].fabo064_desc = s_desc_show1(g_fabo2_d[l_ac].fabo064,s_fin_get_accting_desc(g_glad.glad0211,g_fabo2_d[l_ac].fabo064))
            LET g_fabo2_d_t.fabo064_desc = g_fabo2_d[l_ac].fabo064_desc
            DISPLAY BY NAME g_fabo2_d[l_ac].fabo064,g_fabo2_d[l_ac].fabo064_desc

            

         #自由核算項六
         BEFORE FIELD fabo065_desc
            CALL s_fin_get_glae009(g_glad.glad0221) RETURNING l_glae009
            LET g_fabo2_d[l_ac].fabo065_desc=g_fabo2_d[l_ac].fabo065
            
         AFTER FIELD fabo065_desc
            IF NOT cl_null(g_fabo2_d[l_ac].fabo065_desc) THEN
               IF ( g_fabo2_d[l_ac].fabo065_desc != g_fabo2_d_t.fabo065_desc OR g_fabo2_d_t.fabo065_desc IS NULL ) THEN
                  LET g_fabo2_d[l_ac].fabo065 = g_fabo2_d[l_ac].fabo065_desc
                   
                     CALL s_voucher_free_account_chk(g_glad.glad0221,g_fabo2_d[l_ac].fabo065_desc,g_glad.glad0222) RETURNING g_errno
                     IF NOT cl_null(g_errno) THEN
                        LET g_fabo2_d[l_ac].fabo065        = g_fabo2_d_t.fabo065
                        LET g_fabo2_d[l_ac].fabo065_desc = g_fabo2_d_t.fabo065_desc
                        DISPLAY BY NAME g_fabo2_d[l_ac].fabo065,g_fabo2_d[l_ac].fabo065_desc
                        NEXT FIELD CURRENT
                     END IF
                     
               END IF
            END IF
            LET g_fabo2_d[l_ac].fabo065 = g_fabo2_d[l_ac].fabo065_desc
            LET g_fabo2_d[l_ac].fabo065_desc = s_desc_show1(g_fabo2_d[l_ac].fabo065,s_fin_get_accting_desc(g_glad.glad0221,g_fabo2_d[l_ac].fabo065))
            LET g_fabo2_d_t.fabo065_desc = g_fabo2_d[l_ac].fabo065_desc
            DISPLAY BY NAME g_fabo2_d[l_ac].fabo065,g_fabo2_d[l_ac].fabo065_desc

 
         
         #自由核算項七
         BEFORE FIELD fabo066_desc
            CALL s_fin_get_glae009(g_glad.glad0231) RETURNING l_glae009
            LET g_fabo2_d[l_ac].fabo066_desc=g_fabo2_d[l_ac].fabo066
         AFTER FIELD fabo066_desc
            IF NOT cl_null(g_fabo2_d[l_ac].fabo066_desc) THEN
               IF ( g_fabo2_d[l_ac].fabo066_desc != g_fabo2_d_t.fabo066_desc OR g_fabo2_d_t.fabo066_desc IS NULL ) THEN
                  LET g_fabo2_d[l_ac].fabo066 = g_fabo2_d[l_ac].fabo066_desc
                   
                     CALL s_voucher_free_account_chk(g_glad.glad0231,g_fabo2_d[l_ac].fabo066_desc,g_glad.glad0232) RETURNING g_errno
                     IF NOT cl_null(g_errno) THEN
                        LET g_fabo2_d[l_ac].fabo066        = g_fabo2_d_t.fabo066
                        LET g_fabo2_d[l_ac].fabo066_desc = g_fabo2_d_t.fabo066_desc
                        DISPLAY BY NAME g_fabo2_d[l_ac].fabo066,g_fabo2_d[l_ac].fabo066_desc
                        NEXT FIELD CURRENT
                     END IF
                     
               END IF
            END IF
            LET g_fabo2_d[l_ac].fabo066 = g_fabo2_d[l_ac].fabo066_desc
            LET g_fabo2_d[l_ac].fabo066_desc = s_desc_show1(g_fabo2_d[l_ac].fabo066,s_fin_get_accting_desc(g_glad.glad0231,g_fabo2_d[l_ac].fabo066))
            LET g_fabo2_d_t.fabo066_desc = g_fabo2_d[l_ac].fabo066_desc
            DISPLAY BY NAME g_fabo2_d[l_ac].fabo066,g_fabo2_d[l_ac].fabo066_desc

   
         
         #自由核算項八
         BEFORE FIELD fabo067_desc
            CALL s_fin_get_glae009(g_glad.glad0241) RETURNING l_glae009
            LET g_fabo2_d[l_ac].fabo067_desc=g_fabo2_d[l_ac].fabo067
         AFTER FIELD fabo067_desc
            IF NOT cl_null(g_fabo2_d[l_ac].fabo067_desc) THEN
               IF ( g_fabo2_d[l_ac].fabo067_desc != g_fabo2_d_t.fabo067_desc OR g_fabo2_d_t.fabo067_desc IS NULL ) THEN
                  LET g_fabo2_d[l_ac].fabo067 = g_fabo2_d[l_ac].fabo067_desc
                   
                     CALL s_voucher_free_account_chk(g_glad.glad0241,g_fabo2_d[l_ac].fabo067_desc,g_glad.glad0242) RETURNING g_errno
                     IF NOT cl_null(g_errno) THEN
                        LET g_fabo2_d[l_ac].fabo067        = g_fabo2_d_t.fabo067
                        LET g_fabo2_d[l_ac].fabo067_desc = g_fabo2_d_t.fabo067_desc
                        DISPLAY BY NAME g_fabo2_d[l_ac].fabo067,g_fabo2_d[l_ac].fabo067_desc
                        NEXT FIELD CURRENT
                     END IF
                     
               END IF
            END IF
            LET g_fabo2_d[l_ac].fabo067 = g_fabo2_d[l_ac].fabo067_desc
            LET g_fabo2_d[l_ac].fabo067_desc = s_desc_show1(g_fabo2_d[l_ac].fabo067,s_fin_get_accting_desc(g_glad.glad0241,g_fabo2_d[l_ac].fabo067))
            LET g_fabo2_d_t.fabo067_desc = g_fabo2_d[l_ac].fabo067_desc
            DISPLAY BY NAME g_fabo2_d[l_ac].fabo067,g_fabo2_d[l_ac].fabo067_desc

 
            
         #自由核算項九
         BEFORE FIELD fabo068_desc
            CALL s_fin_get_glae009(g_glad.glad0251) RETURNING l_glae009
            LET g_fabo2_d[l_ac].fabo068_desc=g_fabo2_d[l_ac].fabo068
         AFTER FIELD fabo068_desc
            IF NOT cl_null(g_fabo2_d[l_ac].fabo068_desc) THEN
               IF ( g_fabo2_d[l_ac].fabo068_desc != g_fabo2_d_t.fabo068_desc OR g_fabo2_d_t.fabo068_desc IS NULL ) THEN
                  LET g_fabo2_d[l_ac].fabo068 = g_fabo2_d[l_ac].fabo068_desc
                
                     CALL s_voucher_free_account_chk(g_glad.glad0251,g_fabo2_d[l_ac].fabo068_desc,g_glad.glad0252) RETURNING g_errno
                     IF NOT cl_null(g_errno) THEN
                        LET g_fabo2_d[l_ac].fabo068        = g_fabo2_d_t.fabo068
                        LET g_fabo2_d[l_ac].fabo068_desc = g_fabo2_d_t.fabo068_desc
                        DISPLAY BY NAME g_fabo2_d[l_ac].fabo068,g_fabo2_d[l_ac].fabo068_desc
                        NEXT FIELD CURRENT
                     END IF
                     
               END IF
            END IF
            LET g_fabo2_d[l_ac].fabo068 = g_fabo2_d[l_ac].fabo068_desc
            LET g_fabo2_d[l_ac].fabo068_desc = s_desc_show1(g_fabo2_d[l_ac].fabo068,s_fin_get_accting_desc(g_glad.glad0251,g_fabo2_d[l_ac].fabo068))
            LET g_fabo2_d_t.fabo068_desc = g_fabo2_d[l_ac].fabo068_desc
            DISPLAY BY NAME g_fabo2_d[l_ac].fabo068,g_fabo2_d[l_ac].fabo068_desc

   
         
         #自由核算項十
         BEFORE FIELD fabo069_desc
            CALL s_fin_get_glae009(g_glad.glad0261) RETURNING l_glae009
            LET g_fabo2_d[l_ac].fabo069_desc=g_fabo2_d[l_ac].fabo069
         AFTER FIELD fabo069_desc
            IF NOT cl_null(g_fabo2_d[l_ac].fabo069_desc)  THEN
               IF ( g_fabo2_d[l_ac].fabo069_desc != g_fabo2_d_t.fabo069_desc OR g_fabo2_d_t.fabo069_desc IS NULL ) THEN
                  LET g_fabo2_d[l_ac].fabo069 = g_fabo2_d[l_ac].fabo069_desc
               
                     CALL s_voucher_free_account_chk(g_glad.glad0261,g_fabo2_d[l_ac].fabo069_desc,g_glad.glad0262) RETURNING g_errno
                     IF NOT cl_null(g_errno) THEN
                        LET g_fabo2_d[l_ac].fabo069        = g_fabo2_d_t.fabo069
                        LET g_fabo2_d[l_ac].fabo069_desc = g_fabo2_d_t.fabo069_desc
                        DISPLAY BY NAME g_fabo2_d[l_ac].fabo069,g_fabo2_d[l_ac].fabo069_desc
                        NEXT FIELD CURRENT
                     END IF
                     
               END IF
            END IF
            LET g_fabo2_d[l_ac].fabo069 = g_fabo2_d[l_ac].fabo069_desc
            LET g_fabo2_d[l_ac].fabo069_desc = s_desc_show1(g_fabo2_d[l_ac].fabo069,s_fin_get_accting_desc(g_glad.glad0261,g_fabo2_d[l_ac].fabo069))
            LET g_fabo2_d_t.fabo069_desc = g_fabo2_d[l_ac].fabo069_desc
            DISPLAY BY NAME g_fabo2_d[l_ac].fabo069,g_fabo2_d[l_ac].fabo069_desc
         #20150114 add by chenying         
 
                  #Ctrlp:input.c.page2.fabo024
         ON ACTION controlp INFIELD fabo024
            #add-point:ON ACTION controlp INFIELD fabo024
            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_fabo2_d[l_ac].fabo024             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "" #
            LET g_qryparam.where = "glac001 = '",g_glaa004,"' AND  glac003 <>'1' AND glac006 = '1'",
                                     " AND glac002 IN (SELECT glad001 FROM glad_t,glac_t WHERE glad001= glac002 ",
                                   "AND gladld='",g_fabgld,"' AND gladent='",g_enterprise,"'",
                                   " AND gladstus = 'Y' )"
            
            CALL aglt310_04()                                #呼叫開窗

            LET g_fabo2_d[l_ac].fabo024 = g_qryparam.return1              

            DISPLAY g_fabo2_d[l_ac].fabo024 TO fabo024              #
            CALL afat504_01_fabo024_desc(g_fabo2_d[l_ac].fabo024) RETURNING g_fabo2_d[l_ac].fabo024_desc  #20141112 add returning

            NEXT FIELD fabo024                          #返回原欄位


            #END add-point
 
         #Ctrlp:input.c.page1_afat504_01.fabo042
         ON ACTION controlp INFIELD fabo042
            #add-point:ON ACTION controlp INFIELD fabo042

            #END add-point
 
         #Ctrlp:input.c.page1_afat504_01.fabo031
         ON ACTION controlp INFIELD fabo031
         
         ON ACTION controlp INFIELD fabo031_desc
            #add-point:ON ACTION controlp INFIELD fabo031
            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_fabo2_d[l_ac].fabo031             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "" #
#            LET g_qryparam.where ="ooed001 = '2' AND ooed006<='",g_fabgdocdt,"' AND (ooed007 IS NULL OR ooed007 >='",g_fabgdocdt,"')"
#            
#            CALL q_ooed004_1()                                #呼叫開窗
            LET g_qryparam.where ="ooefstus='Y'"
            #161221-00054#4--add--s--xul
            #agli060设置的客群限制条件
            CALL s_voucher_get_glak_sql(g_fabgld,'01',l_wc) RETURNING l_glak_sql
            LET g_qryparam.where = g_qryparam.where," AND ",l_glak_sql
            #161221-00054#4--add--e--xul
            #CALL q_ooef001()                                           #161024-00008#4 
            CALL q_ooef001_1()                                          #161024-00008#4 
            
            LET g_fabo2_d[l_ac].fabo031_desc = g_qryparam.return1              
 
            LET g_fabo2_d[l_ac].fabo031 = g_fabo2_d[l_ac].fabo031_desc
            DISPLAY BY NAME g_fabo2_d[l_ac].fabo031_desc               #

            NEXT FIELD fabo031_desc                          #返回原欄位


            #END add-point
 
         #Ctrlp:input.c.page1_afat504_01.fabo032
         ON ACTION controlp INFIELD fabo032
         
         ON ACTION controlp INFIELD fabo032_desc
            #add-point:ON ACTION controlp INFIELD fabo032
            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_fabo2_d[l_ac].fabo032             #給予default值
            LET g_qryparam.default2 = "" #g_fabo2_d[l_ac].ooeg001 #部門編號
            #給予arg
            LET g_qryparam.arg1 = g_fabgdocdt
            #161221-00054#4--add--s--xul
            #agli060设置的客群限制条件
            CALL s_voucher_get_glak_sql(g_fabgld,'02',l_wc) RETURNING l_glak_sql
            LET g_qryparam.where = l_glak_sql
            #161221-00054#4--add--e--xul
            
#            CALL q_ooeg001()                                #呼叫開窗
            CALL q_ooeg001_4()

            LET g_fabo2_d[l_ac].fabo032 = g_qryparam.return1  
            LET g_fabo2_d[l_ac].fabo032_desc = g_fabo2_d[l_ac].fabo032            
            #LET g_fabo2_d[l_ac].ooeg001 = g_qryparam.return2 
            DISPLAY g_fabo2_d[l_ac].fabo032_desc TO fabo032_desc              #
            #DISPLAY g_fabo2_d[l_ac].ooeg001 TO ooeg001 #部門編號
            NEXT FIELD fabo032_desc                          #返回原欄位


            #END add-point
 
         #Ctrlp:input.c.page1_afat504_01.fabo033
         ON ACTION controlp INFIELD fabo033
         
         ON ACTION controlp INFIELD fabo033_desc
            #add-point:ON ACTION controlp INFIELD fabo033
            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_fabo2_d[l_ac].fabo033             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "" #
#            LET g_qryparam.where ="ooed001 = '2' AND ooed006<='",g_fabgdocdt,"' AND (ooed007 IS NULL OR ooed007 >='",g_fabgdocdt,"')"
#            
#            CALL q_ooed004_1()                                #呼叫開窗
            LET g_qryparam.where = " (ooeg003 = '2' OR ooeg003 = '3')"
            #161221-00054#4--add--s--xul
            #agli060设置的客群限制条件
            CALL s_voucher_get_glak_sql(g_fabgld,'03',l_wc) RETURNING l_glak_sql
            LET g_qryparam.where = g_qryparam.where," AND ",l_glak_sql
            #161221-00054#4--add--e--xul
            LET g_qryparam.arg1 = g_fabgdocdt
           #CALL q_ooeg001_5()                #呼叫開窗   #161221-00054#4 MARK xul
            CALL q_ooeg001_15()       #161221-00054#4 add xul      
            LET g_fabo2_d[l_ac].fabo033 = g_qryparam.return1              
            LET g_fabo2_d[l_ac].fabo033_desc = g_fabo2_d[l_ac].fabo033
            DISPLAY g_fabo2_d[l_ac].fabo033_desc TO fabo033_desc              #

            NEXT FIELD fabo033_desc                          #返回原欄位


            #END add-point
 
         #Ctrlp:input.c.page1_afat504_01.fabo034
         ON ACTION controlp INFIELD fabo034
         
         ON ACTION controlp INFIELD fabo034_desc
            #add-point:ON ACTION controlp INFIELD fabo034
            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_fabo2_d[l_ac].fabo034             #給予default值
            LET g_qryparam.default2 = "" #g_fabo2_d[l_ac].oocq002 #應用分類碼
            #161221-00054#4--add--s--xul
            #agli060设置的客群限制条件
            CALL s_voucher_get_glak_sql(g_fabgld,'04',l_wc) RETURNING l_glak_sql
            LET g_qryparam.where = l_glak_sql
            #161221-00054#4--add--e--xul
            
            #給予arg
#            LET g_qryparam.arg1 = "287" #
#
#            
#            CALL q_oocq002()                                #呼叫開窗
            CALL q_oocq002_287()
            LET g_fabo2_d[l_ac].fabo034 = g_qryparam.return1
            LET g_fabo2_d[l_ac].fabo034_desc = g_fabo2_d[l_ac].fabo034            
            #LET g_fabo2_d[l_ac].oocq002 = g_qryparam.return2 
            DISPLAY g_fabo2_d[l_ac].fabo034_desc TO fabo034_desc              #
            #DISPLAY g_fabo2_d[l_ac].oocq002 TO oocq002 #應用分類碼
            NEXT FIELD fabo034_desc                          #返回原欄位


            #END add-point
 
         #Ctrlp:input.c.page1_afat504_01.fabo035
         ON ACTION controlp INFIELD fabo035
         
         ON ACTION controlp INFIELD fabo035_desc
            #add-point:ON ACTION controlp INFIELD fabo035
            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_fabo2_d[l_ac].fabo035             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "" #
            #161221-00054#4--add--s--xul
            #agli060设置的客群限制条件
            CALL s_voucher_get_glak_sql(g_fabgld,'05',l_wc) RETURNING l_glak_sql
            LET g_qryparam.where = l_glak_sql
            #161221-00054#4--add--e--xul
            
           #CALL q_pmaa001()    #160913-00017#1  mark               #呼叫開窗
           CALL q_pmaa001_25() #160913-00017#1  add 

            LET g_fabo2_d[l_ac].fabo035 = g_qryparam.return1              
            LET g_fabo2_d[l_ac].fabo035_desc = g_fabo2_d[l_ac].fabo035 
            DISPLAY g_fabo2_d[l_ac].fabo035_desc TO fabo035_desc              #

            NEXT FIELD fabo035_desc                          #返回原欄位


            #END add-point
 
         #Ctrlp:input.c.page1_afat504_01.fabo036
         ON ACTION controlp INFIELD fabo036
         
         ON ACTION controlp INFIELD fabo036_desc
            #add-point:ON ACTION controlp INFIELD fabo036
            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_fabo2_d[l_ac].fabo036             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "" #
            #161221-00054#4--add--s--xul
            #agli060设置的客群限制条件
            CALL s_voucher_get_glak_sql(g_fabgld,'06',l_wc) RETURNING l_glak_sql
            LET g_qryparam.where = l_glak_sql
            #161221-00054#4--add--e--xul
            
            #CALL q_pmaa001()    #160913-00017#1  mark               #呼叫開窗
           CALL q_pmaa001_25() #160913-00017#1  add 
            LET g_fabo2_d[l_ac].fabo036 = g_qryparam.return1              
            LET g_fabo2_d[l_ac].fabo036_desc = g_fabo2_d[l_ac].fabo036
            DISPLAY g_fabo2_d[l_ac].fabo036_desc TO fabo036_desc              #

            NEXT FIELD fabo036_desc                          #返回原欄位


            #END add-point
 
         #Ctrlp:input.c.page1_afat504_01.fabo037
         ON ACTION controlp INFIELD fabo037
         
         ON ACTION controlp INFIELD fabo037_desc
            #add-point:ON ACTION controlp INFIELD fabo037
            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_fabo2_d[l_ac].fabo037             #給予default值
            LET g_qryparam.default2 = "" #g_fabo2_d[l_ac].oocq002 #應用分類碼
             #161221-00054#4--add--s--xul
            #agli060设置的客群限制条件
            CALL s_voucher_get_glak_sql(g_fabgld,'07',l_wc) RETURNING l_glak_sql
            LET g_qryparam.where = l_glak_sql
            #161221-00054#4--add--e--xul
            #給予arg
#            LET g_qryparam.arg1 = "281" #
#
#            
#            CALL q_oocq002()                                #呼叫開窗
            CALL q_oocq002_281() 
            LET g_fabo2_d[l_ac].fabo037 = g_qryparam.return1 
            LET g_fabo2_d[l_ac].fabo037_desc = g_fabo2_d[l_ac].fabo037            
            #LET g_fabo2_d[l_ac].oocq002 = g_qryparam.return2 
            DISPLAY g_fabo2_d[l_ac].fabo037_desc TO fabo037_desc              #
            #DISPLAY g_fabo2_d[l_ac].oocq002 TO oocq002 #應用分類碼
            NEXT FIELD fabo037_desc                          #返回原欄位


            #END add-point
 
         #Ctrlp:input.c.page1_afat504_01.fabo038
         ON ACTION controlp INFIELD fabo038
         
         ON ACTION controlp INFIELD fabo038_desc
            #add-point:ON ACTION controlp INFIELD fabo038
            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_fabo2_d[l_ac].fabo038             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "" #
            #161221-00054#4--add--s--xul
            #agli060设置的客群限制条件
            CALL s_voucher_get_glak_sql(g_fabgld,'12',l_wc) RETURNING l_glak_sql
            LET g_qryparam.where = l_glak_sql
            #161221-00054#4--add--e--xul
            
#            CALL q_ooag001()                                #呼叫開窗
            CALL q_ooag001_8() 
            LET g_fabo2_d[l_ac].fabo038 = g_qryparam.return1              
            LET g_fabo2_d[l_ac].fabo038_desc = g_fabo2_d[l_ac].fabo038
            DISPLAY g_fabo2_d[l_ac].fabo038_desc TO fabo038_desc              #

            NEXT FIELD fabo038_desc                          #返回原欄位


            #END add-point
 
         #Ctrlp:input.c.page1_afat504_01.fabo039
         ON ACTION controlp INFIELD fabo039
         
         ON ACTION controlp INFIELD fabo039_desc
            #add-point:ON ACTION controlp INFIELD fabo039
            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_fabo2_d[l_ac].fabo039             #給予default值
             #161221-00054#4--add--s--xul
            #agli060设置的客群限制条件
            CALL s_voucher_get_glak_sql(g_fabgld,'13',l_wc) RETURNING l_glak_sql
            LET g_qryparam.where = l_glak_sql
            #161221-00054#4--add--e--xul
            #給予arg
            LET g_qryparam.arg1 = "" #

            
            CALL q_pjba001()                                #呼叫開窗

            LET g_fabo2_d[l_ac].fabo039 = g_qryparam.return1              
            DISPLAY g_fabo2_d[l_ac].fabo039 TO fabo039              #

            NEXT FIELD fabo039                        #返回原欄位


            #END add-point

         #20150114 add by chenying
         ON ACTION controlp INFIELD fabo040_desc
            #add-point:ON ACTION controlp INFIELD fabo040
            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_fabo2_d[l_ac].fabo040             #給予default值
          
#            #給予arg
#            LET g_qryparam.arg1 = g_fabo2_d[l_ac].fabo039
#
#            
#            CALL q_pjbb002_2()                                #呼叫開窗

            IF NOT cl_null(g_fabo2_d[l_ac].fabo039) THEN
               LET g_qryparam.where = "pjbb012='1' AND pjbb001='",g_fabo2_d[l_ac].fabo039,"'"
            ELSE
               LET g_qryparam.where = "pjbb012='1'"
            END IF
            #161221-00054#4--add--s--xul
            #agli060设置的客群限制条件
            CALL s_voucher_get_glak_sql(g_fabgld,'14',l_wc) RETURNING l_glak_sql
            LET g_qryparam.where = g_qryparam.where," AND ",l_glak_sql
            #161221-00054#4--add--e--xul
            
            CALL q_pjbb002()             #呼叫開窗

            LET g_fabo2_d[l_ac].fabo040 = g_qryparam.return1              
            LET g_fabo2_d[l_ac].fabo040_desc = g_fabo2_d[l_ac].fabo040 
            DISPLAY g_fabo2_d[l_ac].fabo040_desc TO fabo040_desc            #

            NEXT FIELD fabo040_desc                
         
         
         ON ACTION controlp INFIELD fabo055_desc
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_fabo2_d[l_ac].fabo055
             #161221-00054#4--add--s--xul
            #agli060设置的客群限制条件
            CALL s_voucher_get_glak_sql(g_fabgld,'10',l_wc) RETURNING l_glak_sql
            LET g_qryparam.where = l_glak_sql
            #161221-00054#4--add--e--xul
            CALL q_oojd001_2()
            LET g_fabo2_d[l_ac].fabo055 = g_qryparam.return1
            LET g_fabo2_d[l_ac].fabo055_desc = g_fabo2_d[l_ac].fabo055
            DISPLAY g_fabo2_d[l_ac].fabo055_desc TO fabo055_desc
            NEXT FIELD fabo055_desc 

         ON ACTION controlp INFIELD fabo056_desc
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_fabo2_d[l_ac].fabo056
             #161221-00054#4--add--s--xul
            #agli060设置的客群限制条件
            CALL s_voucher_get_glak_sql(g_fabgld,'11',l_wc) RETURNING l_glak_sql
            LET g_qryparam.where = l_glak_sql
            #161221-00054#4--add--e--xul
            CALL q_oocq002_2002()
            LET g_fabo2_d[l_ac].fabo056 = g_qryparam.return1
            LET g_fabo2_d[l_ac].fabo056_desc = g_fabo2_d[l_ac].fabo056
            DISPLAY g_fabo2_d[l_ac].fabo056_desc TO fabo056_desc
            NEXT FIELD fabo056_desc 

         #自由核算项（一~十）
         ON ACTION controlp INFIELD fabo060_desc
            IF NOT cl_null(l_glae009) THEN
               INITIALIZE g_qryparam.* TO NULL
               LET g_qryparam.state = 'i'
               LET g_qryparam.reqry = FALSE
               LET g_qryparam.default1 = g_fabo2_d[l_ac].fabo060_desc
               IF l_glae009 = 'q_glaf002' THEN    
                  LET g_qryparam.where = "glaf001 = '",g_glad.glad0171,"'" #自由核算項類型
               END IF 
               CALL q_agli041(l_glae009) 
               LET g_fabo2_d[l_ac].fabo060        = g_qryparam.return1
               LET g_fabo2_d[l_ac].fabo060_desc = g_fabo2_d[l_ac].fabo060
               DISPLAY BY NAME g_fabo2_d[l_ac].fabo060 ,g_fabo2_d[l_ac].fabo060_desc
               NEXT FIELD fabo060_desc
            END IF  
            
         ON ACTION controlp INFIELD fabo061_desc
            IF NOT cl_null(l_glae009) THEN
               INITIALIZE g_qryparam.* TO NULL
               LET g_qryparam.state = 'i'
               LET g_qryparam.reqry = FALSE
               LET g_qryparam.default1 = g_fabo2_d[l_ac].fabo061_desc
               IF l_glae009 = 'q_glaf002' THEN    
                  LET g_qryparam.where = "glaf001 = '",g_glad.glad0181,"'" #自由核算項類型
               END IF 
               CALL q_agli041(l_glae009) 
               LET g_fabo2_d[l_ac].fabo061        = g_qryparam.return1
               LET g_fabo2_d[l_ac].fabo061_desc = g_fabo2_d[l_ac].fabo061
               DISPLAY BY NAME g_fabo2_d[l_ac].fabo061 ,g_fabo2_d[l_ac].fabo061_desc
               NEXT FIELD fabo061_desc
            END IF   

         ON ACTION controlp INFIELD fabo062_desc
            IF NOT cl_null(l_glae009) THEN
               INITIALIZE g_qryparam.* TO NULL
               LET g_qryparam.state = 'i'
               LET g_qryparam.reqry = FALSE
               LET g_qryparam.default1 = g_fabo2_d[l_ac].fabo062_desc
               IF l_glae009 = 'q_glaf002' THEN    
                  LET g_qryparam.where = "glaf001 = '",g_glad.glad0191,"'" #自由核算項類型
               END IF 
               CALL q_agli041(l_glae009) 
               LET g_fabo2_d[l_ac].fabo062        = g_qryparam.return1
               LET g_fabo2_d[l_ac].fabo062_desc = g_fabo2_d[l_ac].fabo062
               DISPLAY BY NAME g_fabo2_d[l_ac].fabo062 ,g_fabo2_d[l_ac].fabo062_desc
               NEXT FIELD fabo062_desc
            END IF  
            
         ON ACTION controlp INFIELD fabo063_desc
            IF NOT cl_null(l_glae009) THEN
               INITIALIZE g_qryparam.* TO NULL
               LET g_qryparam.state = 'i'
               LET g_qryparam.reqry = FALSE
               LET g_qryparam.default1 = g_fabo2_d[l_ac].fabo063_desc
               IF l_glae009 = 'q_glaf002' THEN    
                  LET g_qryparam.where = "glaf001 = '",g_glad.glad0201,"'" #自由核算項類型
               END IF 
               CALL q_agli041(l_glae009) 
               LET g_fabo2_d[l_ac].fabo063        = g_qryparam.return1
               LET g_fabo2_d[l_ac].fabo063_desc = g_fabo2_d[l_ac].fabo063
               DISPLAY BY NAME g_fabo2_d[l_ac].fabo063 ,g_fabo2_d[l_ac].fabo063_desc
               NEXT FIELD fabo063_desc
            END IF   

         ON ACTION controlp INFIELD fabo064_desc
            IF NOT cl_null(l_glae009) THEN
               INITIALIZE g_qryparam.* TO NULL
               LET g_qryparam.state = 'i'
               LET g_qryparam.reqry = FALSE
               LET g_qryparam.default1 = g_fabo2_d[l_ac].fabo064_desc
               IF l_glae009 = 'q_glaf002' THEN    
                  LET g_qryparam.where = "glaf001 = '",g_glad.glad0211,"'" #自由核算項類型
               END IF 
               CALL q_agli041(l_glae009) 
               LET g_fabo2_d[l_ac].fabo064        = g_qryparam.return1
               LET g_fabo2_d[l_ac].fabo064_desc = g_fabo2_d[l_ac].fabo064
               DISPLAY BY NAME g_fabo2_d[l_ac].fabo064 ,g_fabo2_d[l_ac].fabo064_desc
               NEXT FIELD fabo064_desc
            END IF  
            
         ON ACTION controlp INFIELD fabo065_desc
            IF NOT cl_null(l_glae009) THEN
               INITIALIZE g_qryparam.* TO NULL
               LET g_qryparam.state = 'i'
               LET g_qryparam.reqry = FALSE
               LET g_qryparam.default1 = g_fabo2_d[l_ac].fabo065_desc
               IF l_glae009 = 'q_glaf002' THEN    
                  LET g_qryparam.where = "glaf001 = '",g_glad.glad0221,"'" #自由核算項類型
               END IF 
               CALL q_agli041(l_glae009) 
               LET g_fabo2_d[l_ac].fabo065        = g_qryparam.return1
               LET g_fabo2_d[l_ac].fabo065_desc = g_fabo2_d[l_ac].fabo065
               DISPLAY BY NAME g_fabo2_d[l_ac].fabo065 ,g_fabo2_d[l_ac].fabo065_desc
               NEXT FIELD fabo065_desc
            END IF 

         ON ACTION controlp INFIELD fabo066_desc
            IF NOT cl_null(l_glae009) THEN
               INITIALIZE g_qryparam.* TO NULL
               LET g_qryparam.state = 'i'
               LET g_qryparam.reqry = FALSE
               LET g_qryparam.default1 = g_fabo2_d[l_ac].fabo066_desc
               IF l_glae009 = 'q_glaf002' THEN    
                  LET g_qryparam.where = "glaf001 = '",g_glad.glad0231,"'" #自由核算項類型
               END IF 
               CALL q_agli041(l_glae009) 
               LET g_fabo2_d[l_ac].fabo066        = g_qryparam.return1
               LET g_fabo2_d[l_ac].fabo066_desc = g_fabo2_d[l_ac].fabo066
               DISPLAY BY NAME g_fabo2_d[l_ac].fabo066 ,g_fabo2_d[l_ac].fabo066_desc
               NEXT FIELD fabo066_desc
            END IF  

         ON ACTION controlp INFIELD fabo067_desc
            IF NOT cl_null(l_glae009) THEN
               INITIALIZE g_qryparam.* TO NULL
               LET g_qryparam.state = 'i'
               LET g_qryparam.reqry = FALSE
               LET g_qryparam.default1 = g_fabo2_d[l_ac].fabo067_desc
               IF l_glae009 = 'q_glaf002' THEN    
                  LET g_qryparam.where = "glaf001 = '",g_glad.glad0241,"'" #自由核算項類型
               END IF 
               CALL q_agli041(l_glae009) 
               LET g_fabo2_d[l_ac].fabo067        = g_qryparam.return1
               LET g_fabo2_d[l_ac].fabo067_desc = g_fabo2_d[l_ac].fabo067
               DISPLAY BY NAME g_fabo2_d[l_ac].fabo067 ,g_fabo2_d[l_ac].fabo067_desc
               NEXT FIELD fabo067_desc
            END IF

         ON ACTION controlp INFIELD fabo068_desc
            IF NOT cl_null(l_glae009) THEN
               INITIALIZE g_qryparam.* TO NULL
               LET g_qryparam.state = 'i'
               LET g_qryparam.reqry = FALSE
               LET g_qryparam.default1 = g_fabo2_d[l_ac].fabo068_desc
               IF l_glae009 = 'q_glaf002' THEN    
                  LET g_qryparam.where = "glaf001 = '",g_glad.glad0251,"'" #自由核算項類型
               END IF 
               CALL q_agli041(l_glae009) 
               LET g_fabo2_d[l_ac].fabo068        = g_qryparam.return1
               LET g_fabo2_d[l_ac].fabo068_desc = g_fabo2_d[l_ac].fabo068
               DISPLAY BY NAME g_fabo2_d[l_ac].fabo068 ,g_fabo2_d[l_ac].fabo068_desc
               NEXT FIELD fabo068_desc
            END IF 

         ON ACTION controlp INFIELD fabo069_desc
            IF NOT cl_null(l_glae009) THEN
               INITIALIZE g_qryparam.* TO NULL
               LET g_qryparam.state = 'i'
               LET g_qryparam.reqry = FALSE
               LET g_qryparam.default1 = g_fabo2_d[l_ac].fabo069_desc
               IF l_glae009 = 'q_glaf002' THEN    
                  LET g_qryparam.where = "glaf001 = '",g_glad.glad0261,"'" #自由核算項類型
               END IF 
               CALL q_agli041(l_glae009) 
               LET g_fabo2_d[l_ac].fabo069        = g_qryparam.return1
               LET g_fabo2_d[l_ac].fabo069_desc = g_fabo2_d[l_ac].fabo069
               DISPLAY BY NAME g_fabo2_d[l_ac].fabo069 ,g_fabo2_d[l_ac].fabo069_desc
               NEXT FIELD fabo069_desc
            END IF      
         #20150114 add by chenying 

         #Ctrlp:input.c.page1_afat504_01.fabo040
         ON ACTION controlp INFIELD fabo040
            #add-point:ON ACTION controlp INFIELD fabo040
            #此段落由子樣板a07產生            
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_fabo2_d[l_ac].fabo040             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "" #

            
            CALL q_pjbb002()                                #呼叫開窗

            LET g_fabo2_d[l_ac].fabo040 = g_qryparam.return1              

            DISPLAY g_fabo2_d[l_ac].fabo040 TO fabo040            #

            NEXT FIELD fabo040                
 
 
 
         AFTER ROW
            #add-point:單身page2 after_row

            #end add-point
            LET l_ac = ARR_CURR()
            IF INT_FLAG THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = '' 
               LET g_errparam.code   = 9001 
               LET g_errparam.popup  = FALSE 
               CALL cl_err()
               LET INT_FLAG = 0
               IF l_cmd = 'u' THEN
                  LET g_fabo2_d[l_ac].* = g_fabo2_d_t.*
               END IF
               CLOSE afat504_01_bcl
               CALL s_transaction_end('N','0')
               EXIT DIALOG 
            END IF
            
            #其他table進行unlock
            
            CALL afat504_01_unlock_b("fabo_t","'2'")
            CALL s_transaction_end('Y','0')
            #add-point:單身page2 after_row2

            #end add-point
 
         AFTER INPUT
            #add-point:input段after input 
            LET g_fabo_d2.* = g_fabo2_d.*
            #end add-point   
    
         ON ACTION controlo
            CALL FGL_SET_ARR_CURR(g_fabo2_d.getLength()+1)
            LET lb_reproduce = TRUE
            LET li_reproduce = l_ac
            LET li_reproduce_target = g_fabo2_d.getLength()+1
 
      END INPUT
      
END DIALOG

################################################################################
# Descriptions...: 查詢
# Memo...........:
# Usage..........: CALL afat504_01_construct()
# Modify.........:
################################################################################
DIALOG afat504_01_construct()

   CONSTRUCT g_wc_subject ON fabo024,fabo042,fabo031,fabo031_desc,fabo032,fabo032_desc,fabo033,fabo033_desc,
                             fabo034,fabo034_desc,fabo035,fabo035_desc,fabo036,fabo036_desc,
                             fabo037,fabo037_desc,fabo038,fabo038_desc,fabo039,fabo039_desc,fabo040,fabo040_desc,
                             fabo054,fabo055,fabo055_desc,fabo056,fabo056_desc
                             #,fabo060,fabo061,fabo062,fabo063,fabo064,fabo065,
                             #fabo066,fabo067,fabo068,fabo069 

        FROM s_detail1_afat504_01[1].fabo024,s_detail1_afat504_01[1].fabo042,
             s_detail1_afat504_01[1].fabo031,s_detail1_afat504_01[1].fabo031_desc,
             s_detail1_afat504_01[1].fabo032,s_detail1_afat504_01[1].fabo032_desc,
             s_detail1_afat504_01[1].fabo033,s_detail1_afat504_01[1].fabo033_desc,
             s_detail1_afat504_01[1].fabo034,s_detail1_afat504_01[1].fabo034_desc,
             s_detail1_afat504_01[1].fabo035,s_detail1_afat504_01[1].fabo035_desc,
             s_detail1_afat504_01[1].fabo036,s_detail1_afat504_01[1].fabo036_desc,
             s_detail1_afat504_01[1].fabo037,s_detail1_afat504_01[1].fabo037_desc,
             s_detail1_afat504_01[1].fabo038,s_detail1_afat504_01[1].fabo038_desc,
             s_detail1_afat504_01[1].fabo039,s_detail1_afat504_01[1].fabo039_desc,
             s_detail1_afat504_01[1].fabo040,s_detail1_afat504_01[1].fabo040_desc,
             s_detail1_afat504_01[1].fabo054,
             s_detail1_afat504_01[1].fabo055,s_detail1_afat504_01[1].fabo055_desc,
             s_detail1_afat504_01[1].fabo056,s_detail1_afat504_01[1].fabo056_desc
#             ,s_detail1_afat504_01[1].fabo060,s_detail1_afat504_01[1].fabo061,
#             s_detail1_afat504_01[1].fabo062,s_detail1_afat504_01[1].fabo063,s_detail1_afat504_01[1].fabo064,
#             s_detail1_afat504_01[1].fabo065,s_detail1_afat504_01[1].fabo066,s_detail1_afat504_01[1].fabo067,
#             s_detail1_afat504_01[1].fabo068,s_detail1_afat504_01[1].fabo069 
                   
      BEFORE CONSTRUCT
         SELECT glaa004 INTO g_glaa004 FROM glaa_t WHERE glaaent=g_enterprise AND glaald=g_fabgld
         
      ON ACTION controlp INFIELD fabo024
            #add-point:ON ACTION controlp INFIELD fabo024
            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.where = "glac001 = '",g_glaa004,"' AND  glac003 <>'1' AND glac006 = '1'"
            CALL aglt310_04()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO fabo024  #顯示到畫面上
            NEXT FIELD fabo024                     #返回原欄位
    
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD fabo024
            #add-point:BEFORE FIELD fabo024

            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD fabo024
            
            #add-point:AFTER FIELD fabo024

            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD fabo042
            #add-point:BEFORE FIELD fabo042

            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD fabo042
            
            #add-point:AFTER FIELD fabo042

            #END add-point
            
 
         #Ctrlp:construct.c.page2.fabo042
         ON ACTION controlp INFIELD fabo042
            #add-point:ON ACTION controlp INFIELD fabo042

            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD fabo031
            #add-point:BEFORE FIELD fabo031

            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD fabo031
            
            #add-point:AFTER FIELD fabo031

            #END add-point
            
 
         #Ctrlp:construct.c.page2.fabo031
         ON ACTION controlp INFIELD fabo031
         
         ON ACTION controlp INFIELD fabo031_desc
            #add-point:ON ACTION controlp INFIELD fabo031
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            #CALL q_ooef001()                                           #161024-00008#4 
            CALL q_ooef001_1()                                          #161024-00008#4 
            DISPLAY g_qryparam.return1 TO fabo031_desc  #顯示到畫面上
            NEXT FIELD fabo031_desc                     #返回原欄位            
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD fabo032
            #add-point:BEFORE FIELD fabo032

            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD fabo032
            
            #add-point:AFTER FIELD fabo032

            #END add-point
            
 
         #Ctrlp:construct.c.page2.fabo032
         ON ACTION controlp INFIELD fabo032
         
         ON ACTION controlp INFIELD fabo032_desc
            #add-point:ON ACTION controlp INFIELD fabo032
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
#            CALL q_ooeg001()
            LET g_qryparam.arg1 = g_today    
            CALL q_ooeg001_4()
            DISPLAY g_qryparam.return1 TO fabo032_desc  #顯示到畫面上
            NEXT FIELD fabo032_desc 
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD fabo033
            #add-point:BEFORE FIELD fabo033

            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD fabo033
            
            #add-point:AFTER FIELD fabo033

            #END add-point
            
 
         #Ctrlp:construct.c.page2.fabo033
         ON ACTION controlp INFIELD fabo033
         
         ON ACTION controlp INFIELD fabo033_desc
            #add-point:ON ACTION controlp INFIELD fabo033
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
#            CALL q_ooef001()
            LET g_qryparam.where = " (ooeg003 = '2' OR ooeg003 = '3')"
            LET g_qryparam.arg1 = g_today
            #CALL q_ooeg001_5()                #呼叫開窗   #161221-00054#4 MARK xul
            CALL q_ooeg001_15()       #161221-00054#4 add xul      
            DISPLAY g_qryparam.return1 TO fabo033_desc  #顯示到畫面上
            NEXT FIELD fabo033_desc  
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD fabo034
            #add-point:BEFORE FIELD fabo034

            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD fabo034
            
            #add-point:AFTER FIELD fabo034

            #END add-point
            
 
         #Ctrlp:construct.c.page2.fabo034
         ON ACTION controlp INFIELD fabo034
         
         ON ACTION controlp INFIELD fabo034_desc
            #add-point:ON ACTION controlp INFIELD fabo034
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
#            LET g_qryparam.arg1 = "287"  
#            CALL q_oocq002()                                
            CALL q_oocq002_287()
            DISPLAY g_qryparam.return1 TO fabo034_desc  #顯示到畫面上
            NEXT FIELD fabo034_desc  
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD fabo035
            #add-point:BEFORE FIELD fabo035

            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD fabo035
            
            #add-point:AFTER FIELD fabo035

            #END add-point
            
 
         #Ctrlp:construct.c.page2.fabo035
         ON ACTION controlp INFIELD fabo035
         
         ON ACTION controlp INFIELD fabo035_desc
            #add-point:ON ACTION controlp INFIELD fabo035
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
           #CALL q_pmaa001()    #160913-00017#1  mark               #呼叫開窗
           CALL q_pmaa001_25() #160913-00017#1  add 
            DISPLAY g_qryparam.return1 TO fabo035_desc  #顯示到畫面上
            NEXT FIELD fabo035_desc  
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD fabo036
            #add-point:BEFORE FIELD fabo036

            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD fabo036
            
            #add-point:AFTER FIELD fabo036

            #END add-point
            
 
         #Ctrlp:construct.c.page2.fabo036
         ON ACTION controlp INFIELD fabo036
         
         ON ACTION controlp INFIELD fabo036_desc
            #add-point:ON ACTION controlp INFIELD fabo036
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            #CALL q_pmaa001()    #160913-00017#1  mark               #呼叫開窗
           CALL q_pmaa001_25() #160913-00017#1  add 
            DISPLAY g_qryparam.return1 TO fabo036_desc  #顯示到畫面上
            NEXT FIELD fabo036_desc  
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD fabo037
            #add-point:BEFORE FIELD fabo037

            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD fabo037
            
            #add-point:AFTER FIELD fabo037

            #END add-point
            
 
         #Ctrlp:construct.c.page2.fabo037
         ON ACTION controlp INFIELD fabo037
         
         ON ACTION controlp INFIELD fabo037_desc
            #add-point:ON ACTION controlp INFIELD fabo037
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
#            LET g_qryparam.arg1='281'
#            CALL q_oocq002()
            CALL q_oocq002_281()    
            DISPLAY g_qryparam.return1 TO fabo037_desc  #顯示到畫面上
            NEXT FIELD fabo037_desc  
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD fabo038
            #add-point:BEFORE FIELD fabo038

            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD fabo038
            
            #add-point:AFTER FIELD fabo038

            #END add-point
            
 
         #Ctrlp:construct.c.page2.fabo038
         ON ACTION controlp INFIELD fabo038
         
         ON ACTION controlp INFIELD fabo038_desc
            #add-point:ON ACTION controlp INFIELD fabo038
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
#            CALL q_ooag001()
            CALL q_ooag001_8()
            DISPLAY g_qryparam.return1 TO fabo038_desc  #顯示到畫面上
            NEXT FIELD fabo038_desc 
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD fabo039
            #add-point:BEFORE FIELD fabo039

            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD fabo039
            
            #add-point:AFTER FIELD fabo039

            #END add-point
            
 
         #Ctrlp:construct.c.page2.fabo039
         ON ACTION controlp INFIELD fabo039
         
         ON ACTION controlp INFIELD fabo039_desc
            #add-point:ON ACTION controlp INFIELD fabo039
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_pjba001()
            DISPLAY g_qryparam.return1 TO fabo039_desc  #顯示到畫面上
            NEXT FIELD fabo039_desc 
            #END add-point

         #20150113 add by chenying
         #Ctrlp:construct.c.page2.fabo040
         ON ACTION controlp INFIELD fabo040_desc
            #add-point:ON ACTION controlp INFIELD fabo040
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_pjbb002_2()
            DISPLAY g_qryparam.return1 TO fabo040_desc  #顯示到畫面上
            NEXT FIELD fabo040_desc
            #END add-point

         ON ACTION controlp INFIELD fabo055_desc
            #add-point:ON ACTION controlp INFIELD fabo055
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_oojd001_2()
            DISPLAY g_qryparam.return1 TO fabo055_desc  #顯示到畫面上
            NEXT FIELD fabo055_desc
            #END add-point
 
         ON ACTION controlp INFIELD fabo056_desc
            #add-point:ON ACTION controlp INFIELD fabo056
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_oocq002_2002()
            DISPLAY g_qryparam.return1 TO fabo056_desc  #顯示到畫面上
            NEXT FIELD fabo056_desc
            #END add-point 
         #20150113 add by chenying 
         
         #此段落由子樣板a01產生
         BEFORE FIELD fabo040
            #add-point:BEFORE FIELD fabo040

            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD fabo040
            
            #add-point:AFTER FIELD fabo040

            #END add-point
            
 
         #Ctrlp:construct.c.page2.fabo040
         ON ACTION controlp INFIELD fabo040
            #add-point:ON ACTION controlp INFIELD fabo040
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_pjbb002()
            DISPLAY g_qryparam.return1 TO fabo040  #顯示到畫面上
            NEXT FIELD fabo040
            #END add-point
   END CONSTRUCT
END DIALOG

 
{</section>}
 
{<section id="afat504_01.other_function" readonly="Y" >}

################################################################################
# Descriptions...: 顯示單身
# Memo...........:
# Usage..........: CALL afat504_01_b_fill()
# Modify.........:
################################################################################
PUBLIC FUNCTION afat504_01_b_fill()
   DEFINE p_wc2      STRING
   #161111-00028#7--modify---begin-------------
  #DEFINE g_glad                RECORD LIKE glad_t.*
   DEFINE g_glad RECORD  #帳套科目管理設定檔
       gladent LIKE glad_t.gladent, #企業編號
       gladownid LIKE glad_t.gladownid, #資料所有者
       gladowndp LIKE glad_t.gladowndp, #資料所屬部門
       gladcrtid LIKE glad_t.gladcrtid, #資料建立者
       gladcrtdp LIKE glad_t.gladcrtdp, #資料建立部門
       gladcrtdt LIKE glad_t.gladcrtdt, #資料創建日
       gladmodid LIKE glad_t.gladmodid, #資料修改者
       gladmoddt LIKE glad_t.gladmoddt, #最近修改日
       gladstus LIKE glad_t.gladstus, #狀態碼
       gladld LIKE glad_t.gladld, #帳套
       glad001 LIKE glad_t.glad001, #會計科目編號
       glad002 LIKE glad_t.glad002, #是否按餘額類型產生分錄
       glad003 LIKE glad_t.glad003, #啟用傳票項次細項立沖
       glad004 LIKE glad_t.glad004, #傳票項次異動別
       glad005 LIKE glad_t.glad005, #是否啟用數量金額式
       glad006 LIKE glad_t.glad006, #借方現金變動碼
       glad007 LIKE glad_t.glad007, #啟用部門管理
       glad008 LIKE glad_t.glad008, #啟用利潤成本管理
       glad009 LIKE glad_t.glad009, #啟用區域管理
       glad010 LIKE glad_t.glad010, #啟用收付款客商管理
       glad011 LIKE glad_t.glad011, #啟用客群管理
       glad012 LIKE glad_t.glad012, #啟用產品類別管理
       glad013 LIKE glad_t.glad013, #啟用人員管理
       glad014 LIKE glad_t.glad014, #no use
       glad015 LIKE glad_t.glad015, #啟用專案管理
       glad016 LIKE glad_t.glad016, #啟用WBS管理
       glad017 LIKE glad_t.glad017, #啟用自由核算項一
       glad0171 LIKE glad_t.glad0171, #自由核算項一類型編號
       glad0172 LIKE glad_t.glad0172, #自由核算項一控制方式
       glad018 LIKE glad_t.glad018, #啟用自由核算項二
       glad0181 LIKE glad_t.glad0181, #自由核算項二類型編號
       glad0182 LIKE glad_t.glad0182, #自由核算項二控制方式
       glad019 LIKE glad_t.glad019, #啟用自由核算項三
       glad0191 LIKE glad_t.glad0191, #自由核算項三類型編號
       glad0192 LIKE glad_t.glad0192, #自由核算項三控制方式
       glad020 LIKE glad_t.glad020, #啟用自由核算項四
       glad0201 LIKE glad_t.glad0201, #自由核算項四類型編號
       glad0202 LIKE glad_t.glad0202, #自由核算項四控制方式
       glad021 LIKE glad_t.glad021, #啟用自由核算項五
       glad0211 LIKE glad_t.glad0211, #自由核算項五類型編號
       glad0212 LIKE glad_t.glad0212, #自由核算項五控制方式
       glad022 LIKE glad_t.glad022, #啟用自由核算項六
       glad0221 LIKE glad_t.glad0221, #自由核算項六類型編號
       glad0222 LIKE glad_t.glad0222, #自由核算項六控制方式
       glad023 LIKE glad_t.glad023, #啟用自由核算項七
       glad0231 LIKE glad_t.glad0231, #自由核算項七類型編號
       glad0232 LIKE glad_t.glad0232, #自由核算項七控制方式
       glad024 LIKE glad_t.glad024, #啟用自由核算項八
       glad0241 LIKE glad_t.glad0241, #自由核算項八類型編號
       glad0242 LIKE glad_t.glad0242, #自由核算項八控制方式
       glad025 LIKE glad_t.glad025, #啟用自由核算項九
       glad0251 LIKE glad_t.glad0251, #自由核算項九類型編號
       glad0252 LIKE glad_t.glad0252, #自由核算項九控制方式
       glad026 LIKE glad_t.glad026, #啟用自由核算項十
       glad0261 LIKE glad_t.glad0261, #自由核算項十類型編號
       glad0262 LIKE glad_t.glad0262, #自由核算項十控制方式
       glad027 LIKE glad_t.glad027, #啟用帳款客商管理
       glad030 LIKE glad_t.glad030, #是否進行預算管控
       glad031 LIKE glad_t.glad031, #啟用經營方式管理
       glad032 LIKE glad_t.glad032, #啟用渠道管理
       glad033 LIKE glad_t.glad033, #啟用品牌管理
       glad034 LIKE glad_t.glad034, #科目做多幣別管理
       glad035 LIKE glad_t.glad035, #是否是子系統科目
       glad036 LIKE glad_t.glad036  #貸方現金變動碼
       END RECORD
   #161111-00028#7--modify---end------------- 
   SELECT glaa004 INTO g_glaa004 FROM glaa_t WHERE glaaent=g_enterprise AND glaald=g_fabgld
   CALL g_fabo2_d.clear()
      
   LET g_sql = "SELECT  UNIQUE faboseq,fabo024,fabo042,fabo031, 
               fabo032,fabo033,fabo034,fabo035,fabo036,fabo037,fabo038,fabo039,fabo040,
               fabo054,fabo055,fabo056,fabo060,fabo061,fabo062,fabo063,fabo064,fabo065,
               fabo066,fabo067,fabo068,fabo069
               FROM fabo_t",   
               " INNER JOIN fabg_t ON fabgld = fabold AND fabgent = faboent ",#161221-00054#4 add  AND fabgent = faboent
               " AND fabgdocno = fabodocno ",
               " WHERE faboent=? AND fabold=? AND fabodocno=?"
   LET g_sql = cl_sql_add_mask(g_sql)              #遮蔽特定資料
   
   IF NOT cl_null(g_wc_d) THEN
      LET g_sql = g_sql CLIPPED, " AND ", g_wc_d CLIPPED
   END IF
   
   #子單身的WC
   
   LET g_sql = g_sql, " ORDER BY fabo_t.faboseq"
   
   LET g_sql = cl_sql_add_mask(g_sql)              #遮蔽特定資料
   PREPARE afat504_01_pb2 FROM g_sql
   DECLARE b_fill2_cs CURSOR FOR afat504_01_pb2
   
   LET g_cnt = l_ac
   LET l_ac = 1
   
   OPEN b_fill2_cs USING g_enterprise,g_fabgld,g_fabgdocno
                                            
   FOREACH b_fill2_cs INTO g_fabo2_d[l_ac].faboseq,g_fabo2_d[l_ac].fabo024,g_fabo2_d[l_ac].fabo042, 
       g_fabo2_d[l_ac].fabo031,g_fabo2_d[l_ac].fabo032,g_fabo2_d[l_ac].fabo033,g_fabo2_d[l_ac].fabo034, 
       g_fabo2_d[l_ac].fabo035,g_fabo2_d[l_ac].fabo036,g_fabo2_d[l_ac].fabo037,g_fabo2_d[l_ac].fabo038, 
       g_fabo2_d[l_ac].fabo039,g_fabo2_d[l_ac].fabo040,g_fabo2_d[l_ac].fabo054,
       g_fabo2_d[l_ac].fabo055,g_fabo2_d[l_ac].fabo056,g_fabo2_d[l_ac].fabo060,g_fabo2_d[l_ac].fabo061,
       g_fabo2_d[l_ac].fabo062,g_fabo2_d[l_ac].fabo063,g_fabo2_d[l_ac].fabo064,g_fabo2_d[l_ac].fabo065,
       g_fabo2_d[l_ac].fabo066,g_fabo2_d[l_ac].fabo067,g_fabo2_d[l_ac].fabo068,g_fabo2_d[l_ac].fabo069 
      
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = "FOREACH:" 
         LET g_errparam.code   = SQLCA.sqlcode 
         LET g_errparam.popup  = TRUE 
         CALL cl_err()
 
         EXIT FOREACH
      END IF
#20141112 --add--str--
     CALL s_fin_sel_glad(g_fabgld,g_fabo2_d[l_ac].fabo024,'ALL') RETURNING g_glad.* #20150115 add by chenying
     #科目
     CALL afat504_01_fabo024_desc(g_fabo2_d[l_ac].fabo024) RETURNING g_fabo2_d[l_ac].fabo024_desc  #20141112 add returning
     #營運中心
     CALL afat504_01_fabo031_desc(g_fabo2_d[l_ac].fabo031) RETURNING g_fabo2_d[l_ac].fabo031_desc
     LET g_fabo2_d[l_ac].fabo031_desc=g_fabo2_d[l_ac].fabo031,g_fabo2_d[l_ac].fabo031_desc
     #部門
     CALL afat504_01_fabo031_desc(g_fabo2_d[l_ac].fabo032) RETURNING g_fabo2_d[l_ac].fabo032_desc
     LET g_fabo2_d[l_ac].fabo032_desc=g_fabo2_d[l_ac].fabo032,g_fabo2_d[l_ac].fabo032_desc
     #利潤中心
     CALL afat504_01_fabo031_desc(g_fabo2_d[l_ac].fabo033) RETURNING g_fabo2_d[l_ac].fabo033_desc
     LET g_fabo2_d[l_ac].fabo033_desc=g_fabo2_d[l_ac].fabo033,g_fabo2_d[l_ac].fabo033_desc
     #區域
     CALL afat504_01_fabo056_desc("287",g_fabo2_d[l_ac].fabo034) RETURNING g_fabo2_d[l_ac].fabo034_desc
     LET g_fabo2_d[l_ac].fabo034_desc=g_fabo2_d[l_ac].fabo034,g_fabo2_d[l_ac].fabo034_desc
     #交易客戶
     CALL afat504_01_fabo035_desc(g_fabo2_d[l_ac].fabo035) RETURNING g_fabo2_d[l_ac].fabo035_desc
     LET g_fabo2_d[l_ac].fabo035_desc=g_fabo2_d[l_ac].fabo035,g_fabo2_d[l_ac].fabo035_desc
     #帳款客戶
     CALL afat504_01_fabo035_desc(g_fabo2_d[l_ac].fabo036) RETURNING g_fabo2_d[l_ac].fabo036_desc
     LET g_fabo2_d[l_ac].fabo036_desc=g_fabo2_d[l_ac].fabo036,g_fabo2_d[l_ac].fabo036_desc
     #客群
     CALL afat504_01_fabo056_desc("281",g_fabo2_d[l_ac].fabo037) RETURNING g_fabo2_d[l_ac].fabo037_desc
     LET g_fabo2_d[l_ac].fabo037_desc=g_fabo2_d[l_ac].fabo037,g_fabo2_d[l_ac].fabo037_desc
     #人員
     CALL afat504_01_fabo038_desc(g_fabo2_d[l_ac].fabo038) RETURNING g_fabo2_d[l_ac].fabo038_desc
     LET g_fabo2_d[l_ac].fabo038_desc=g_fabo2_d[l_ac].fabo038,g_fabo2_d[l_ac].fabo038_desc
     #專案編號
     CALL afat504_01_fabo039_desc(g_fabo2_d[l_ac].fabo039) RETURNING g_fabo2_d[l_ac].fabo039_desc
     LET g_fabo2_d[l_ac].fabo039_desc=g_fabo2_d[l_ac].fabo039,g_fabo2_d[l_ac].fabo039_desc

 
     #20150114 add by chenying
     #WBS
     CALL afat504_01_fabo040_desc(g_fabo2_d[l_ac].fabo039,g_fabo2_d[l_ac].fabo040) RETURNING g_fabo2_d[l_ac].fabo040_desc
     LET g_fabo2_d[l_ac].fabo040_desc=g_fabo2_d[l_ac].fabo040,g_fabo2_d[l_ac].fabo040_desc  
     #渠道
     CALL afat504_01_fabo055_desc(g_fabo2_d[l_ac].fabo055)  RETURNING g_fabo2_d[l_ac].fabo055_desc
     LET g_fabo2_d[l_ac].fabo055_desc=g_fabo2_d[l_ac].fabo055,g_fabo2_d[l_ac].fabo055_desc  
     #品牌
     CALL afat504_01_fabo056_desc('2002',g_fabo2_d[l_ac].fabo056) RETURNING g_fabo2_d[l_ac].fabo056_desc
     LET g_fabo2_d[l_ac].fabo056_desc=g_fabo2_d[l_ac].fabo056,g_fabo2_d[l_ac].fabo056_desc   
     CALL cl_set_combo_scc('fabo054','6013')  
     
     IF g_glad.glad017 = 'Y' AND NOT cl_null(g_fabo2_d[l_ac].fabo060) THEN
        LET g_fabo2_d[l_ac].fabo060_desc = s_desc_show1(g_fabo2_d[l_ac].fabo060,s_fin_get_accting_desc(g_glad.glad0171,g_fabo2_d[l_ac].fabo060))
     END IF
     IF g_glad.glad018 = 'Y' AND NOT cl_null(g_fabo2_d[l_ac].fabo061) THEN
        LET g_fabo2_d[l_ac].fabo061_desc = s_desc_show1(g_fabo2_d[l_ac].fabo061,s_fin_get_accting_desc(g_glad.glad0181,g_fabo2_d[l_ac].fabo061))
     END IF
     IF g_glad.glad019 = 'Y' AND NOT cl_null(g_fabo2_d[l_ac].fabo062) THEN
        LET g_fabo2_d[l_ac].fabo062_desc = s_desc_show1(g_fabo2_d[l_ac].fabo062,s_fin_get_accting_desc(g_glad.glad0191,g_fabo2_d[l_ac].fabo062))
     END IF
     IF g_glad.glad020 = 'Y' AND NOT cl_null(g_fabo2_d[l_ac].fabo063) THEN
        LET g_fabo2_d[l_ac].fabo063_desc = s_desc_show1(g_fabo2_d[l_ac].fabo063,s_fin_get_accting_desc(g_glad.glad0201,g_fabo2_d[l_ac].fabo063))
     END IF
     IF g_glad.glad021 = 'Y' AND NOT cl_null(g_fabo2_d[l_ac].fabo064) THEN
        LET g_fabo2_d[l_ac].fabo064_desc = s_desc_show1(g_fabo2_d[l_ac].fabo064,s_fin_get_accting_desc(g_glad.glad0211,g_fabo2_d[l_ac].fabo064))
     END IF
     IF g_glad.glad022 = 'Y' AND NOT cl_null(g_fabo2_d[l_ac].fabo065) THEN   
        LET g_fabo2_d[l_ac].fabo065_desc = s_desc_show1(g_fabo2_d[l_ac].fabo065,s_fin_get_accting_desc(g_glad.glad0221,g_fabo2_d[l_ac].fabo065))
     END IF
     IF g_glad.glad023 = 'Y' AND NOT cl_null(g_fabo2_d[l_ac].fabo066) THEN
        LET g_fabo2_d[l_ac].fabo066_desc = s_desc_show1(g_fabo2_d[l_ac].fabo066,s_fin_get_accting_desc(g_glad.glad0231,g_fabo2_d[l_ac].fabo066))
     END IF
     IF g_glad.glad024 = 'Y' AND NOT cl_null(g_fabo2_d[l_ac].fabo067) THEN   
        LET g_fabo2_d[l_ac].fabo067_desc = s_desc_show1(g_fabo2_d[l_ac].fabo067,s_fin_get_accting_desc(g_glad.glad0241,g_fabo2_d[l_ac].fabo067))
     END IF
     IF g_glad.glad025 = 'Y' AND NOT cl_null(g_fabo2_d[l_ac].fabo068) THEN   
        LET g_fabo2_d[l_ac].fabo068_desc = s_desc_show1(g_fabo2_d[l_ac].fabo068,s_fin_get_accting_desc(g_glad.glad0251,g_fabo2_d[l_ac].fabo068))
     END IF
     IF g_glad.glad026 = 'Y' AND NOT cl_null(g_fabo2_d[l_ac].fabo069) THEN   
        LET g_fabo2_d[l_ac].fabo069_desc = s_desc_show1(g_fabo2_d[l_ac].fabo069,s_fin_get_accting_desc(g_glad.glad0261,g_fabo2_d[l_ac].fabo069))
     END IF       
     #20150114 add by chenying   
#20141112 --add--end--

#      CALL afat504_01_b_ref() #20141112 mark
      LET l_ac = l_ac + 1
      IF l_ac > g_max_rec THEN
         EXIT FOREACH
      END IF
      
   END FOREACH
   LET g_error_show = 0
   LET l_ac=l_ac-1
   CALL g_fabo2_d.deleteElement(g_fabo2_d.getLength())
   
   LET l_ac = g_cnt
   LET g_cnt = 0  
   LET g_fabo_d2.* = g_fabo2_d.*
   FREE afat504_01_pb2
END FUNCTION

################################################################################
# Descriptions...: 連動lock其他單身table資料
# Memo...........:
# Usage..........: CALL afat504_01_lock_b(ps_table,ps_page)
# Modify.........:
################################################################################
PRIVATE FUNCTION afat504_01_lock_b(ps_table,ps_page)
   DEFINE ps_page     STRING
   DEFINE ps_table    STRING
   DEFINE ls_group    STRING
   
   #鎖定整組table
   #LET ls_group = "'1','2','3',"
   #僅鎖定自身table
   LET ls_group = "fabo_t"
   
   IF ls_group.getIndexOf(ps_table,1) THEN
      OPEN afat504_01_bcl USING g_enterprise,
                                       g_fabgld,g_fabgdocno,g_fabo2_d[g_detail_idx].faboseq  
                                               
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = "afat504_01_bcl" 
         LET g_errparam.code   = SQLCA.sqlcode 
         LET g_errparam.popup  = TRUE 
         CALL cl_err()
 
         RETURN FALSE
      END IF
   END IF
   RETURN TRUE
END FUNCTION

################################################################################
# Descriptions...: 科目說明
# Memo...........:
# Usage..........: CALL afat504_01_fabo024_desc(p_fabo024)
# Input parameter: p_fabo024      科目編號
# Modify.........:
################################################################################
PRIVATE FUNCTION afat504_01_fabo024_desc(p_fabo024)
   DEFINE p_fabo024  LIKE fabo_t.fabo024
   DEFINE r_desc     LIKE oocql_t.oocql004 #20141112
   
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_glaa004
   LET g_ref_fields[2] = p_fabo024
   CALL ap_ref_array2(g_ref_fields,"SELECT glacl004 FROM glacl_t WHERE glaclent='"||g_enterprise||"' AND glacl001=? AND glacl002=? AND glacl003='"||g_dlang||"'","") RETURNING g_rtn_fields
#20141112 mod--str--
#   LET g_fabo2_d[l_ac].fabo024_desc = '', g_rtn_fields[1] , ''
#   DISPLAY BY NAME g_fabo2_d[l_ac].fabo024_desc
   LET r_desc = '', g_rtn_fields[1] , ''
   RETURN r_desc
#20141112 mod--end--   
END FUNCTION

################################################################################
# Descriptions...: 刪除單身後其他table連動
# Memo...........:
# Usage..........: CALL afat504_01_delete_b(ps_table,ps_keys_bak,ps_page)
# Modify.........:
################################################################################
PRIVATE FUNCTION afat504_01_delete_b(ps_table,ps_keys_bak,ps_page)
   DEFINE ps_table    STRING
   DEFINE ps_page     STRING
   DEFINE ps_keys_bak DYNAMIC ARRAY OF VARCHAR(500)
   DEFINE ls_group    STRING
 
   #判斷是否是同一群組的table
   LET ls_group = "'1','2','3',"
   IF ls_group.getIndexOf(ps_page,1) > 0 THEN
    
      DELETE FROM fabo_t
       WHERE faboent = g_enterprise AND
         fabold = ps_keys_bak[1] AND fabodocno = ps_keys_bak[2] AND faboseq = ps_keys_bak[3]
         
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = "" 
         LET g_errparam.code   = SQLCA.sqlcode 
         LET g_errparam.popup  = FALSE 
         CALL cl_err()
 
      END IF
        
   END IF
END FUNCTION

################################################################################
# Descriptions...: 修改單身後其他table連動
# Memo...........:
# Usage..........: CALL afat504_01_update_b(ps_table,ps_keys,ps_keys_bak,ps_page)
# Modify.........:
################################################################################
PRIVATE FUNCTION afat504_01_update_b(ps_table,ps_keys,ps_keys_bak,ps_page)
   DEFINE ps_table         STRING
   DEFINE ps_page          STRING
   DEFINE ps_keys          DYNAMIC ARRAY OF VARCHAR(500)
   DEFINE ps_keys_bak      DYNAMIC ARRAY OF VARCHAR(500)
   DEFINE ls_group         STRING
   DEFINE li_idx           LIKE type_t.num5 
   DEFINE lb_chk           BOOLEAN
   DEFINE l_new_key        DYNAMIC ARRAY OF STRING
   DEFINE l_old_key        DYNAMIC ARRAY OF STRING
   DEFINE l_field_key      DYNAMIC ARRAY OF STRING
   
   #判斷key是否有改變
   LET lb_chk = TRUE
   FOR li_idx = 1 TO ps_keys.getLength()
      IF ps_keys[li_idx] <> ps_keys_bak[li_idx] THEN
         LET lb_chk = FALSE
         EXIT FOR
      END IF
   END FOR
   
   #不需要做處理
   IF lb_chk THEN
      RETURN
   END IF
   
   #判斷是否是同一群組的table
   LET ls_group = "'1','2','3',"
   IF ls_group.getIndexOf(ps_page,1) > 0 AND ps_table <> "fabo_t" THEN
      
     UPDATE fabo_t 
        SET (fabold,fabodocno,
             faboseq
             ,fabo024,fabo042,fabo031,fabo032,fabo033,fabo034,fabo035,fabo036,fabo037,fabo038,fabo039,fabo040,
             fabo054,fabo055,fabo056,fabo060,fabo061,fabo062,fabo063,fabo064,fabo065,
               fabo066,fabo067,fabo068,fabo069) 
             = 
            (ps_keys[1],ps_keys[2],ps_keys[3]
             ,g_fabo2_d[g_detail_idx].fabo024,g_fabo2_d[g_detail_idx].fabo042, 
                 g_fabo2_d[g_detail_idx].fabo031,g_fabo2_d[g_detail_idx].fabo032,g_fabo2_d[g_detail_idx].fabo033, 
                 g_fabo2_d[g_detail_idx].fabo034,g_fabo2_d[g_detail_idx].fabo035,g_fabo2_d[g_detail_idx].fabo036, 
                 g_fabo2_d[g_detail_idx].fabo037,g_fabo2_d[g_detail_idx].fabo038,g_fabo2_d[g_detail_idx].fabo039, 
                 g_fabo2_d[g_detail_idx].fabo040,g_fabo2_d[l_ac].fabo054,
                 g_fabo2_d[l_ac].fabo055,g_fabo2_d[l_ac].fabo056,g_fabo2_d[l_ac].fabo060,g_fabo2_d[l_ac].fabo061,
                 g_fabo2_d[l_ac].fabo062,g_fabo2_d[l_ac].fabo063,g_fabo2_d[l_ac].fabo064,g_fabo2_d[l_ac].fabo065,
                 g_fabo2_d[l_ac].fabo066,g_fabo2_d[l_ac].fabo067,g_fabo2_d[l_ac].fabo068,g_fabo2_d[l_ac].fabo069
                 ) 
        WHERE faboent = g_enterprise AND fabold = ps_keys_bak[1] AND fabodocno = ps_keys_bak[2] AND faboseq = ps_keys_bak[3]   
      
      CASE
         WHEN SQLCA.sqlerrd[3] = 0  #更新不到的處理
            INITIALIZE g_errparam TO NULL 
            LET g_errparam.extend = "fabo_t" 
            LET g_errparam.code   = "std-00009" 
            LET g_errparam.popup  = TRUE 
            CALL cl_err()
 
            CALL s_transaction_end('N','0')
         WHEN SQLCA.sqlcode #其他錯誤
            INITIALIZE g_errparam TO NULL 
            LET g_errparam.extend = "fabo_t" 
            LET g_errparam.code   = SQLCA.sqlcode 
            LET g_errparam.popup  = TRUE 
            CALL cl_err()
 
            CALL s_transaction_end('N','0')
         OTHERWISE
            
      END CASE
      
   END IF
   
END FUNCTION

################################################################################
# Descriptions...: 連動unlock其他單身table資料
# Memo...........:
# Usage..........: CALL afat504_01_unlock_b(ps_table,ps_page)
# Modify.........:
################################################################################
PRIVATE FUNCTION afat504_01_unlock_b(ps_table,ps_page)
   DEFINE ps_page     STRING
   DEFINE ps_table    STRING
   DEFINE ls_group    STRING
   
   
   LET ls_group = "'1','2','3',"
   
   IF ls_group.getIndexOf(ps_page,1) THEN
      CLOSE afat504_01_bcl
   END IF
   
END FUNCTION

################################################################################
# Descriptions...: 科目檢查
# Memo...........:
# Usage..........: CALL afat504_01_fabo024_chk(p_fabo024)
#                  RETURNING g_errno
# Input parameter: p_fabo024    科目編號
# Return code....: g_errno      錯誤編號
# Modify.........:
################################################################################
PRIVATE FUNCTION afat504_01_fabo024_chk(p_fabo024)
   DEFINE p_fabo024    LIKE fabo_t.fabo024
   DEFINE l_glacstus   LIKE glac_t.glacstus
   DEFINE l_glac003    LIKE glac_t.glac003
   DEFINE l_glac006    LIKE glac_t.glac006
   
   LET g_errno = ''
   SELECT glacstus,glac003,glac006 INTO l_glacstus,l_glac003,l_glac006 FROM glac_t
    WHERE glacent = g_enterprise
      AND glac001 = g_glaa004  #会计科目参照表号
      AND glac002 = p_fabo024
       
   CASE
      WHEN SQLCA.SQLCODE = 100   LET g_errno = 'agl-00011'
      WHEN l_glacstus = 'N'      LET g_errno = 'sub-01302' #'agl-00012'   #160318-00005#11 mod 
      WHEN l_glac003 = '1'       LET g_errno = 'agl-00013'  #必须为非统治类科目
      WHEN l_glac006 <>'1'       LET g_errno = 'agl-00030'  #须为账户性质   
   END CASE   
END FUNCTION

################################################################################
# Descriptions...: 部門檢查
# Memo...........:
# Usage..........: CALL afat504_01_fabo032_chk(p_fabo032)
#                  RETURNING g_errno
# Input parameter: p_fabo032    部門編號
# Return code....: g_errno      錯誤代碼
# Modify.........:
################################################################################
PRIVATE FUNCTION afat504_01_fabo032_chk(p_fabo032)
   DEFINE p_fabo032      LIKE fabo_t.fabo032
   DEFINE l_ooegstus     LIKE ooeg_t.ooegstus
   
   LET g_errno = ''
   
   SELECT ooegstus INTO l_ooegstus FROM ooeg_t
    WHERE ooegent = g_enterprise
      AND ooeg001 = p_fabo032
      AND ooeg006 <= g_fabgdocdt
      AND (ooeg007 IS NULL OR ooeg007 >= g_fabgdocdt ) 
   CASE
      WHEN SQLCA.SQLCODE = 100    LET g_errno = 'abm-00006'
      WHEN l_ooegstus = 'N'       LET g_errno = 'sub-01302'#'abm-00007'  #160318-00005#11 mod 
   END CASE
END FUNCTION

################################################################################
# Descriptions...: 區域/客群編號檢核
# Memo...........:
# Usage..........: CALL afat504_01_fabo034_chk(p_oocq001,p_oocq002)
# Input parameter: p_oocq001      應用分類類型
#                : p_oocq002      應用分類碼
# Modify.........:
################################################################################
PRIVATE FUNCTION afat504_01_fabo034_chk(p_oocq001,p_oocq002)
   DEFINE p_oocq001     LIKE oocq_t.oocq001
   DEFINE p_oocq002     LIKE oocq_t.oocq002
   DEFINE l_oocqstus     LIKE oocq_t.oocqstus
   
   LET g_errno = ''
   SELECT oocqstus INTO l_oocqstus FROM oocq_t
    WHERE oocqent = g_enterprise
      AND oocq001 = p_oocq001
      AND oocq002 = p_oocq002
   CASE
     WHEN SQLCA.SQLCODE = 100 
        IF p_oocq001 = '287' THEN      
           LET g_errno = 'sub-01303'  #'apm-00092'#160318-00005#11 mod 
        ELSE
           LET g_errno = 'axm-00003'  
        END IF 
     
     WHEN l_oocqstus = 'N'
        IF p_oocq001 = '287' THEN    
           LET g_errno = 'sub-01302' # 'apm-00093' #160318-00005#11 mod 
        ELSE
           LET g_errno = 'sub-01302' #'axm-00004'  #160318-00005#11 mod 
        END IF       
   END CASE
END FUNCTION

################################################################################
# Descriptions...: 客商編號檢查
# Memo...........:
# Usage..........: CALL afat504_01_fabo035_chk(p_pmaa001)
# Input parameter: p_pmaa001     客商編號
# Modify.........:
################################################################################
PRIVATE FUNCTION afat504_01_fabo035_chk(p_pmaa001)
   DEFINE p_pmaa001     LIKE pmaa_t.pmaa001
   DEFINE l_pmaastus    LIKE pmaa_t.pmaastus

   LET g_errno = ''
   SELECT pmaastus INTO l_pmaastus FROM pmaa_t
    WHERE pmaaent = g_enterprise
      AND pmaa001 = p_pmaa001

   CASE
      WHEN SQLCA.SQLCODE = 100   LET g_errno = 'apm-00028'
      WHEN l_pmaastus = 'N'      LET g_errno = 'sub-01302' #'apm-00029'#160318-00005#11 mod  
   END CASE
END FUNCTION

################################################################################
# Descriptions...: 人員編號檢查
# Memo...........:
# Usage..........: CALL afat504_01_fabo038_chk(p_fabo038)
# Input parameter: p_fabo038     人員編號
# Modify.........:
################################################################################
PRIVATE FUNCTION afat504_01_fabo038_chk(p_fabo038)
   DEFINE p_fabo038    LIKE fabo_t.fabo038
   DEFINE l_ooagstus   LIKE ooag_t.ooagstus


   LET g_errno=''
   SELECT ooagstus INTO l_ooagstus FROM ooag_t
    WHERE ooagent = g_enterprise
      AND ooag001 = p_fabo038

   CASE
      WHEN SQLCA.SQLCODE=100   LET g_errno = 'aoo-00074'
      WHEN l_ooagstus ='N'     LET g_errno = 'sub-01302' #'aoo-00071'  #160318-00005#11 mod 
   END CASE
END FUNCTION

################################################################################
# Descriptions...: 組織說明
# Memo...........:
# Usage..........: CALL afat504_01_fabo031_desc(p_ooefl001)
# Input parameter: p_ooefl001     組織編號
# Modify.........:
################################################################################
PRIVATE FUNCTION afat504_01_fabo031_desc(p_ooefl001)
   DEFINE p_ooefl001       LIKE ooefl_t.ooefl001
   DEFINE r_desc           LIKE ooefl_t.ooefl003
   
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = p_ooefl001
   CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET r_desc = '', g_rtn_fields[1] , ''
   RETURN r_desc
END FUNCTION

################################################################################
# Descriptions...: 區域/客群說明
# Memo...........:
# Usage..........: CALL afat504_01_fabo034_desc(p_oocql001,p_oocql002)
#                  RETURNING 回传参数
# Input parameter: p_oocql001     應用分類
#                : p_oocql002     應用分類碼
# Modify.........:
################################################################################
PRIVATE FUNCTION afat504_01_fabo034_desc(p_oocql001,p_oocql002)
   DEFINE p_oocql001         LIKE oocql_t.oocql001
   DEFINE p_oocql002         LIKE oocql_t.oocql002
   DEFINE r_desc             LIKE oocql_t.oocql004
   
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = p_oocql001
   LET g_ref_fields[2] = p_oocql002
   CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001=? AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET r_desc = '', g_rtn_fields[1] , ''
   RETURN r_desc
END FUNCTION

################################################################################
# Descriptions...: 客戶名稱
# Memo...........:
# Usage..........: CALL afat504_01_fabo035_desc(p_pmaal001)
# Input parameter: p_pmaal001     客戶編號
# Modify.........:
################################################################################
PRIVATE FUNCTION afat504_01_fabo035_desc(p_pmaal001)
   DEFINE p_pmaal001     LIKE pmaal_t.pmaal001
   DEFINE r_desc         LIKE pmaal_t.pmaal004
   
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = p_pmaal001
   CALL ap_ref_array2(g_ref_fields,"SELECT pmaal004 FROM pmaal_t WHERE pmaalent='"||g_enterprise||"' AND pmaal001=? AND pmaal002='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET r_desc = '', g_rtn_fields[1] , ''
   RETURN r_desc
END FUNCTION

################################################################################
# Descriptions...: 姓名
# Memo...........:
# Usage..........: CALL afat504_01_fabo038_desc(p_fabo038)
# Input parameter: p_fabo038      與昂編號
# Modify.........:
################################################################################
PRIVATE FUNCTION afat504_01_fabo038_desc(p_fabo038)
   DEFINE p_fabo038     LIKE fabo_t.fabo038
   DEFINE r_ooag011     LIKE ooag_t.ooag011
   
   SELECT ooag011 INTO r_ooag011 FROM ooag_t
   WHERE ooagent=g_enterprise AND ooag001=p_fabo038
   
   RETURN r_ooag011
END FUNCTION

#+欄位說明
PRIVATE FUNCTION afat504_01_b_ref()
   #161111-00028#7--modify---begin-------------
  #DEFINE g_glad                RECORD LIKE glad_t.*
   DEFINE g_glad RECORD  #帳套科目管理設定檔
       gladent LIKE glad_t.gladent, #企業編號
       gladownid LIKE glad_t.gladownid, #資料所有者
       gladowndp LIKE glad_t.gladowndp, #資料所屬部門
       gladcrtid LIKE glad_t.gladcrtid, #資料建立者
       gladcrtdp LIKE glad_t.gladcrtdp, #資料建立部門
       gladcrtdt LIKE glad_t.gladcrtdt, #資料創建日
       gladmodid LIKE glad_t.gladmodid, #資料修改者
       gladmoddt LIKE glad_t.gladmoddt, #最近修改日
       gladstus LIKE glad_t.gladstus, #狀態碼
       gladld LIKE glad_t.gladld, #帳套
       glad001 LIKE glad_t.glad001, #會計科目編號
       glad002 LIKE glad_t.glad002, #是否按餘額類型產生分錄
       glad003 LIKE glad_t.glad003, #啟用傳票項次細項立沖
       glad004 LIKE glad_t.glad004, #傳票項次異動別
       glad005 LIKE glad_t.glad005, #是否啟用數量金額式
       glad006 LIKE glad_t.glad006, #借方現金變動碼
       glad007 LIKE glad_t.glad007, #啟用部門管理
       glad008 LIKE glad_t.glad008, #啟用利潤成本管理
       glad009 LIKE glad_t.glad009, #啟用區域管理
       glad010 LIKE glad_t.glad010, #啟用收付款客商管理
       glad011 LIKE glad_t.glad011, #啟用客群管理
       glad012 LIKE glad_t.glad012, #啟用產品類別管理
       glad013 LIKE glad_t.glad013, #啟用人員管理
       glad014 LIKE glad_t.glad014, #no use
       glad015 LIKE glad_t.glad015, #啟用專案管理
       glad016 LIKE glad_t.glad016, #啟用WBS管理
       glad017 LIKE glad_t.glad017, #啟用自由核算項一
       glad0171 LIKE glad_t.glad0171, #自由核算項一類型編號
       glad0172 LIKE glad_t.glad0172, #自由核算項一控制方式
       glad018 LIKE glad_t.glad018, #啟用自由核算項二
       glad0181 LIKE glad_t.glad0181, #自由核算項二類型編號
       glad0182 LIKE glad_t.glad0182, #自由核算項二控制方式
       glad019 LIKE glad_t.glad019, #啟用自由核算項三
       glad0191 LIKE glad_t.glad0191, #自由核算項三類型編號
       glad0192 LIKE glad_t.glad0192, #自由核算項三控制方式
       glad020 LIKE glad_t.glad020, #啟用自由核算項四
       glad0201 LIKE glad_t.glad0201, #自由核算項四類型編號
       glad0202 LIKE glad_t.glad0202, #自由核算項四控制方式
       glad021 LIKE glad_t.glad021, #啟用自由核算項五
       glad0211 LIKE glad_t.glad0211, #自由核算項五類型編號
       glad0212 LIKE glad_t.glad0212, #自由核算項五控制方式
       glad022 LIKE glad_t.glad022, #啟用自由核算項六
       glad0221 LIKE glad_t.glad0221, #自由核算項六類型編號
       glad0222 LIKE glad_t.glad0222, #自由核算項六控制方式
       glad023 LIKE glad_t.glad023, #啟用自由核算項七
       glad0231 LIKE glad_t.glad0231, #自由核算項七類型編號
       glad0232 LIKE glad_t.glad0232, #自由核算項七控制方式
       glad024 LIKE glad_t.glad024, #啟用自由核算項八
       glad0241 LIKE glad_t.glad0241, #自由核算項八類型編號
       glad0242 LIKE glad_t.glad0242, #自由核算項八控制方式
       glad025 LIKE glad_t.glad025, #啟用自由核算項九
       glad0251 LIKE glad_t.glad0251, #自由核算項九類型編號
       glad0252 LIKE glad_t.glad0252, #自由核算項九控制方式
       glad026 LIKE glad_t.glad026, #啟用自由核算項十
       glad0261 LIKE glad_t.glad0261, #自由核算項十類型編號
       glad0262 LIKE glad_t.glad0262, #自由核算項十控制方式
       glad027 LIKE glad_t.glad027, #啟用帳款客商管理
       glad030 LIKE glad_t.glad030, #是否進行預算管控
       glad031 LIKE glad_t.glad031, #啟用經營方式管理
       glad032 LIKE glad_t.glad032, #啟用渠道管理
       glad033 LIKE glad_t.glad033, #啟用品牌管理
       glad034 LIKE glad_t.glad034, #科目做多幣別管理
       glad035 LIKE glad_t.glad035, #是否是子系統科目
       glad036 LIKE glad_t.glad036  #貸方現金變動碼
       END RECORD
   #161111-00028#7--modify---end------------- 
   CALL s_fin_sel_glad(g_fabgld,g_fabo2_d[l_ac].fabo024,'ALL') RETURNING g_glad.* #20150115 add by chenying
   
   #科目
   CALL afat504_01_fabo024_desc(g_fabo2_d[l_ac].fabo024) RETURNING g_fabo2_d[l_ac].fabo024_desc  #20141112 add returning
   #營運中心
   CALL afat504_01_fabo031_desc(g_fabo2_d[l_ac].fabo031) RETURNING g_fabo2_d[l_ac].fabo031_desc
   LET g_fabo2_d[l_ac].fabo031_desc=g_fabo2_d[l_ac].fabo031,g_fabo2_d[l_ac].fabo031_desc
   #部門
   CALL afat504_01_fabo031_desc(g_fabo2_d[l_ac].fabo032) RETURNING g_fabo2_d[l_ac].fabo032_desc
   LET g_fabo2_d[l_ac].fabo032_desc=g_fabo2_d[l_ac].fabo032,g_fabo2_d[l_ac].fabo032_desc
   #利潤中心
   CALL afat504_01_fabo031_desc(g_fabo2_d[l_ac].fabo033) RETURNING g_fabo2_d[l_ac].fabo033_desc
   LET g_fabo2_d[l_ac].fabo033_desc=g_fabo2_d[l_ac].fabo033,g_fabo2_d[l_ac].fabo033_desc
   #區域
   CALL afat504_01_fabo056_desc("287",g_fabo2_d[l_ac].fabo034) RETURNING g_fabo2_d[l_ac].fabo034_desc
   LET g_fabo2_d[l_ac].fabo034_desc=g_fabo2_d[l_ac].fabo034,g_fabo2_d[l_ac].fabo034_desc
   #交易客戶
   CALL afat504_01_fabo035_desc(g_fabo2_d[l_ac].fabo035) RETURNING g_fabo2_d[l_ac].fabo035_desc
   LET g_fabo2_d[l_ac].fabo035_desc=g_fabo2_d[l_ac].fabo035,g_fabo2_d[l_ac].fabo035_desc
   #帳款客戶
   CALL afat504_01_fabo035_desc(g_fabo2_d[l_ac].fabo036) RETURNING g_fabo2_d[l_ac].fabo036_desc
   LET g_fabo2_d[l_ac].fabo036_desc=g_fabo2_d[l_ac].fabo036,g_fabo2_d[l_ac].fabo036_desc
   #客群
   CALL afat504_01_fabo056_desc("281",g_fabo2_d[l_ac].fabo037) RETURNING g_fabo2_d[l_ac].fabo037_desc
   LET g_fabo2_d[l_ac].fabo037_desc=g_fabo2_d[l_ac].fabo037,g_fabo2_d[l_ac].fabo037_desc
   #人員
   CALL afat504_01_fabo038_desc(g_fabo2_d[l_ac].fabo038) RETURNING g_fabo2_d[l_ac].fabo038_desc
   LET g_fabo2_d[l_ac].fabo038_desc=g_fabo2_d[l_ac].fabo038,g_fabo2_d[l_ac].fabo038_desc
   #專案編號
   CALL afat504_01_fabo039_desc(g_fabo2_d[l_ac].fabo039) RETURNING g_fabo2_d[l_ac].fabo039_desc
   LET g_fabo2_d[l_ac].fabo039_desc=g_fabo2_d[l_ac].fabo039,g_fabo2_d[l_ac].fabo039_desc

   IF g_glad.glad017 = 'Y' AND NOT cl_null(g_fabo2_d[l_ac].fabo060) THEN
      LET g_fabo2_d[l_ac].fabo060_desc = s_desc_show1(g_fabo2_d[l_ac].fabo060,s_fin_get_accting_desc(g_glad.glad0171,g_fabo2_d[l_ac].fabo060))
   END IF
   IF g_glad.glad018 = 'Y' AND NOT cl_null(g_fabo2_d[l_ac].fabo061) THEN
      LET g_fabo2_d[l_ac].fabo061_desc = s_desc_show1(g_fabo2_d[l_ac].fabo061,s_fin_get_accting_desc(g_glad.glad0181,g_fabo2_d[l_ac].fabo061))
   END IF
   IF g_glad.glad019 = 'Y' AND NOT cl_null(g_fabo2_d[l_ac].fabo062) THEN
      LET g_fabo2_d[l_ac].fabo062_desc = s_desc_show1(g_fabo2_d[l_ac].fabo062,s_fin_get_accting_desc(g_glad.glad0191,g_fabo2_d[l_ac].fabo062))
   END IF
   IF g_glad.glad020 = 'Y' AND NOT cl_null(g_fabo2_d[l_ac].fabo063) THEN
      LET g_fabo2_d[l_ac].fabo063_desc = s_desc_show1(g_fabo2_d[l_ac].fabo063,s_fin_get_accting_desc(g_glad.glad0201,g_fabo2_d[l_ac].fabo063))
   END IF
   IF g_glad.glad021 = 'Y' AND NOT cl_null(g_fabo2_d[l_ac].fabo064) THEN
      LET g_fabo2_d[l_ac].fabo064_desc = s_desc_show1(g_fabo2_d[l_ac].fabo064,s_fin_get_accting_desc(g_glad.glad0211,g_fabo2_d[l_ac].fabo064))
   END IF
   IF g_glad.glad022 = 'Y' AND NOT cl_null(g_fabo2_d[l_ac].fabo065) THEN   
      LET g_fabo2_d[l_ac].fabo065_desc = s_desc_show1(g_fabo2_d[l_ac].fabo065,s_fin_get_accting_desc(g_glad.glad0221,g_fabo2_d[l_ac].fabo065))
   END IF
   IF g_glad.glad023 = 'Y' AND NOT cl_null(g_fabo2_d[l_ac].fabo066) THEN
      LET g_fabo2_d[l_ac].fabo066_desc = s_desc_show1(g_fabo2_d[l_ac].fabo066,s_fin_get_accting_desc(g_glad.glad0231,g_fabo2_d[l_ac].fabo066))
   END IF
   IF g_glad.glad024 = 'Y' AND NOT cl_null(g_fabo2_d[l_ac].fabo067) THEN   
      LET g_fabo2_d[l_ac].fabo067_desc = s_desc_show1(g_fabo2_d[l_ac].fabo067,s_fin_get_accting_desc(g_glad.glad0241,g_fabo2_d[l_ac].fabo067))
   END IF
   IF g_glad.glad025 = 'Y' AND NOT cl_null(g_fabo2_d[l_ac].fabo068) THEN   
      LET g_fabo2_d[l_ac].fabo068_desc = s_desc_show1(g_fabo2_d[l_ac].fabo068,s_fin_get_accting_desc(g_glad.glad0251,g_fabo2_d[l_ac].fabo068))
   END IF
   IF g_glad.glad026 = 'Y' AND NOT cl_null(g_fabo2_d[l_ac].fabo069) THEN   
      LET g_fabo2_d[l_ac].fabo069_desc = s_desc_show1(g_fabo2_d[l_ac].fabo069,s_fin_get_accting_desc(g_glad.glad0261,g_fabo2_d[l_ac].fabo069))
   END IF   
   #20150114 add by chenying
   #WBS
   CALL afat504_01_fabo040_desc(g_fabo2_d[l_ac].fabo039,g_fabo2_d[l_ac].fabo040) RETURNING g_fabo2_d[l_ac].fabo040_desc
   LET g_fabo2_d[l_ac].fabo040_desc=g_fabo2_d[l_ac].fabo040,g_fabo2_d[l_ac].fabo040_desc  
   #渠道
   CALL afat504_01_fabo055_desc(g_fabo2_d[l_ac].fabo055)  RETURNING g_fabo2_d[l_ac].fabo055_desc
   LET g_fabo2_d[l_ac].fabo055_desc=g_fabo2_d[l_ac].fabo055,g_fabo2_d[l_ac].fabo055_desc  
   #品牌
   CALL afat504_01_fabo056_desc('2002',g_fabo2_d[l_ac].fabo056) RETURNING g_fabo2_d[l_ac].fabo056_desc
   LET g_fabo2_d[l_ac].fabo056_desc=g_fabo2_d[l_ac].fabo056,g_fabo2_d[l_ac].fabo056_desc   
   CALL cl_set_combo_scc('fabo054','6013')  
   #20150114 add by chenying   
   
   DISPLAY BY NAME g_fabo2_d[l_ac].fabo024_desc,g_fabo2_d[l_ac].fabo031_desc,g_fabo2_d[l_ac].fabo032_desc,
      g_fabo2_d[l_ac].fabo033_desc,g_fabo2_d[l_ac].fabo034_desc,g_fabo2_d[l_ac].fabo035_desc,
      g_fabo2_d[l_ac].fabo036_desc,g_fabo2_d[l_ac].fabo037_desc,g_fabo2_d[l_ac].fabo038_desc,
      g_fabo2_d[l_ac].fabo039_desc,
      g_fabo2_d[l_ac].fabo040_desc,g_fabo2_d[l_ac].fabo055_desc,g_fabo2_d[l_ac].fabo056_desc #20150114 add by chenying
END FUNCTION

################################################################################
# Descriptions...: 專案說明
# Memo...........:
# Usage..........: CALL afat504_01_fabo039_desc(p_fabo039)
#                  RETURNING r_desc
# Input parameter: p_fabo039   專案編號
# Return code....: r_desc      說明
# Date & Author..: 2014/8/7 By wangrr
# Modify.........:
################################################################################
PRIVATE FUNCTION afat504_01_fabo039_desc(p_fabo039)
   DEFINE p_fabo039      LIKE fabo_t.fabo039
   DEFINE r_desc         LIKE pjbal_t.pjbal003
   
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = p_fabo039
   CALL ap_ref_array2(g_ref_fields,"SELECT pjbal003 FROM pjbal_t WHERE pjbalent='"||g_enterprise||"' AND pjbal001=? AND pjbal002='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET r_desc = '', g_rtn_fields[1] , ''
   RETURN r_desc
END FUNCTION

################################################################################
# Descriptions...: 描述说明
# Memo...........:
# Usage..........: CALL s_aooi150_ins (传入参数)
#                  RETURNING 回传参数
# Input parameter: 传入参数变量1   传入参数变量说明1
#                : 传入参数变量2   传入参数变量说明2
# Return code....: 回传参数变量1   回传参数变量说明1
#                : 回传参数变量2   回传参数变量说明2
# Date & Author..: 日期 By 作者
# Modify.........:
################################################################################
PUBLIC FUNCTION afat504_01_set_default_value(p_fabgdocno,p_fabold,p_faboseq)
DEFINE p_fabgdocno     LIKE fabg_t.fabgdocno
DEFINE p_fabold        LIKE fabo_t.fabold
DEFINE p_faboseq       LIKE fabo_t.faboseq
DEFINE l_faah006       LIKE faah_t.faah006
DEFINE l_faal004       LIKE faal_t.faal004
DEFINE l_faboseq       LIKE fabo_t.faboseq
DEFINE l_fabo001       LIKE fabo_t.fabo001
DEFINE l_fabo002       LIKE fabo_t.fabo002
DEFINE l_fabo003       LIKE fabo_t.fabo003
DEFINE l_fabo049       LIKE fabo_t.fabo049
DEFINE l_fabo024       LIKE fabo_t.fabo024
DEFINE l_fabo023       LIKE fabo_t.fabo023
DEFINE l_fabo042       LIKE fabo_t.fabo042
DEFINE l_scccode       LIKE fabo_t.fabo024   #科目SCC码
DEFINE l_glab002       LIKE glab_t.glab002   
DEFINE l_glaacomp      LIKE glaa_t.glaacomp  #20141109
DEFINE l_para_data     STRING                #20141109
DEFINE l_fabo024_desc  LIKE type_t.chr500    #20141112
DEFINE l_glab005       LIKE glab_t.glab005
DEFINE l_fabo009       LIKE fabo_t.fabo009
DEFINE l_fabgsite      LIKE fabg_t.fabgsite
DEFINE l_fabg006       LIKE fabg_t.fabg006
DEFINE l_pmab105       LIKE pmab_t.pmab105
DEFINE l_fabo036       LIKE fabo_t.fabo036
DEFINE l_fabo038       LIKE fabo_t.fabo038
DEFINE l_fabo035       LIKE fabo_t.fabo035   #160927-00013#1 add lujh

   LET g_fabgdocno=p_fabgdocno
   LET g_fabgld=p_fabold
   LET l_faboseq=p_faboseq


   SELECT glaa004 INTO g_glaa004 FROM glaa_t WHERE glaaent=g_enterprise AND glaald=g_fabgld
    ##################交易税科目  
    SELECT fabo009 INTO l_fabo009 FROM fabo_t
      WHERE fabold=g_fabgld AND fabodocno=g_fabgdocno AND faboseq=l_faboseq AND faboent=g_enterprise     
      #應收有帳套時要取帳套慣用稅別設定會科
      SELECT glab005 INTO l_glab005
        FROM glab_t
       WHERE glabent = g_enterprise
         AND glabld = g_fabgld
         AND glab001 = '14'
         AND glab002 = '2'  # 銷項
         AND glab003 = l_fabo009
      #取不到會科時表示以常用會科設定
      IF cl_null(l_glab005) THEN
         SELECT glab005 INTO l_glab005
           FROM glab_t
          WHERE glabent = g_enterprise
            AND glabld = g_fabgld
            AND glab001 ='12'
            AND glab002  ='9711'
            AND glab003 = '9711_91'
      END IF
      #再取不到，取帐款客户对应的账款类别设定的科目axri011
      IF cl_null(l_glab005) THEN 
          SELECT fabg006 INTO l_fabg006,l_fabgsite FROM fabg_t 
           WHERE fabgent = g_enterprise AND fabgdocno = g_fabgdocno
          SELECT pmab105 INTO l_pmab105 FROM pmab_t
           WHERE pmabent = g_enterprise AND pmabsite = l_fabgsite AND pmab001 =l_fabg006
                      
          SELECT glab005 INTO l_glab005 FROM glab_t 
           WHERE glabld = g_fabgld
             AND glab001 = '14'              
             AND glab003 = '8304_29'
             AND glabent = g_enterprise
             AND glab002 =  l_pmab105                           
       END IF   
    IF NOT cl_null(l_glab005) THEN
      UPDATE fabo_t SET  fabo030=l_glab005
       WHERE fabold=g_fabgld AND fabodocno=g_fabgdocno AND faboseq=l_faboseq AND faboent=g_enterprise   
    END IF    
    #######################################      
      
   SELECT  fabo024,fabo023 INTO l_fabo024,l_fabo023 FROM fabo_t WHERE fabold=g_fabgld AND fabodocno=g_fabgdocno AND faboseq=l_faboseq AND faboent=g_enterprise
   
  #预设带afai090的摘要
   SELECT oocq009 INTO l_fabo042 FROM oocq_t WHERE  oocqent=g_enterprise AND oocq001='3902' AND oocq002=l_fabo023 
   UPDATE fabo_t SET  fabo042=l_fabo042
    WHERE fabold=g_fabgld AND fabodocno=g_fabgdocno AND faboseq=l_faboseq AND faboent=g_enterprise   
   IF cl_null(l_fabo024) THEN 

      SELECT fabo001,fabo002,fabo003,fabo049 INTO l_fabo001,l_fabo002,l_fabo003,l_fabo049 FROM fabo_t WHERE faboent=g_enterprise
      AND fabodocno=g_fabgdocno AND  faboseq=l_faboseq
       #根据财编+卡片编号+附号获取资产主类别
      SELECT faah006 INTO l_faah006 FROM faah_t WHERE faahent=g_enterprise AND faah001=l_fabo001 AND faah003=l_fabo002 AND faah004=l_fabo003
              
      #根据帐套+资产主类别判断是否转入清理科目
#1109 mod      
#      SELECT faal004 INTO l_faal004 FROM faal_t WHERE faalent=g_enterprise AND faalld=g_fabgld AND faal001=l_faah006
#      IF l_faal004='Y' THEN               #资产处置转入清理科目，则取资产清理科目（afai071）作为异动科目
       SELECT glaacomp INTO l_glaacomp FROM glaa_t WHERE glaaent = g_enterprise AND glaald = g_fabgld
       CALL cl_get_para(g_enterprise,l_glaacomp,'S-FIN-9017') RETURNING l_para_data
       IF l_para_data = 'Y' THEN         
#1109 mod      
         LET l_scccode='9902_12'
         LET l_glab002='25'
      ELSE 
         #资产处置不转入清理科目，判断‘处分损益fabo049’是否大于零 如果大于零，
         #则取出售收益科目作为异动科目，否则取出售损失科目作为异动科目
         IF l_fabo049>0 THEN  
            LET l_scccode='9902_06' 
            LET l_glab002='41'            
         ELSE 
            LET l_scccode='9902_07'
            LET l_glab002='42'            
         END IF                     
      END IF
                                 
      SELECT glab005 INTO l_fabo024 FROM glab_t
      WHERE glabent=g_enterprise AND glabld=g_fabgld AND glab001='90' AND glab002=l_glab002 AND glab003=l_scccode
      LET l_ac=l_faboseq
      IF l_ac > 0 THEN 
         LET g_fabo2_d[l_ac].fabo024=l_fabo024
         DISPLAY BY NAME g_fabo2_d[1].fabo024
         CALL afat504_01_fabo024_desc(l_fabo024) RETURNING l_fabo024_desc  #20141112 add returning
         UPDATE fabo_t SET fabo024=l_fabo024
          WHERE fabold=g_fabgld AND fabodocno=g_fabgdocno AND faboseq=l_faboseq AND faboent=g_enterprise
      END IF 
   END IF
   
   #20141221 add by chenying
   SELECT fabg006,fabg001,fabg007 INTO l_fabo036,l_fabo038,l_fabo035 FROM fabg_t    #160927-00013#1 add fabg007 l_fabo035 lujh 
    WHERE fabgent = g_enterprise AND fabgdocno = g_fabgdocno AND fabgld = g_fabgld
   IF NOT cl_null(l_fabo036) THEN
      UPDATE fabo_t SET fabo036=l_fabo036
       WHERE fabold=g_fabgld AND fabodocno=g_fabgdocno AND faboseq=l_faboseq AND faboent=g_enterprise
   END IF
   #160927-00013#1--add--str--lujh
   IF NOT cl_null(l_fabo035) THEN
      UPDATE fabo_t SET fabo035=l_fabo035
       WHERE fabold=g_fabgld AND fabodocno=g_fabgdocno AND faboseq=l_faboseq AND faboent=g_enterprise
   END IF
   #160927-00013#1--add--end--lujh
   IF NOT cl_null(l_fabo038) THEN
      UPDATE fabo_t SET fabo038=l_fabo038
       WHERE fabold=g_fabgld AND fabodocno=g_fabgdocno AND faboseq=l_faboseq AND faboent=g_enterprise
   END IF   
   #20141221 add by chenying
END FUNCTION

################################################################################
# Descriptions...:  
# Memo...........:
# Usage..........: CALL afat504_01_fabo040_desc(p_fabo039,p_fabo040)
# Input parameter:  
# Date & Author..: 20150114 By 01531
# Modify.........:
################################################################################
PRIVATE FUNCTION afat504_01_fabo040_desc(p_fabo039,p_fabo040)
   DEFINE p_fabo039      LIKE fabo_t.fabo039
   DEFINE p_fabo040      LIKE fabo_t.fabo040
   DEFINE r_desc         LIKE pjbbl_t.pjbbl004
   
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = p_fabo039
   LET g_ref_fields[2] = p_fabo040
   CALL ap_ref_array2(g_ref_fields,"SELECT pjbbl004 FROM pjbbl_t WHERE pjbblent='"||g_enterprise||"' AND pjbbl001=? AND pjbbl002=? AND pjbbl003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET r_desc = '', g_rtn_fields[1] , ''
   RETURN r_desc
END FUNCTION

################################################################################
# Descriptions...: 描述说明
# Memo...........:
# Usage..........: CALL afat504_01_fabo055_desc(p_fabo055)
# Input parameter:  
# Date & Author..: 20150114 By 01531
# Modify.........:
################################################################################
PRIVATE FUNCTION afat504_01_fabo055_desc(p_fabo055)
   DEFINE p_fabo055        LIKE fabo_t.fabo055
   DEFINE r_desc           LIKE oojdl_t.oojdl003
   
   LET r_desc = ''
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = p_fabo055 
   CALL ap_ref_array2(g_ref_fields,"SELECT oojdl003 FROM oojdl_t WHERE oojdlent='"||g_enterprise||"' AND oojdl001=? AND oojdl002='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET r_desc = '', g_rtn_fields[1] , ''
   
   RETURN r_desc
END FUNCTION

################################################################################
# Descriptions...: 描述说明
# Memo...........:
# Usage..........: CALL afat504_01_fabo056_desc(p_oocq001,p_oocq002)
# Input parameter:  
# Date & Author..: 20150114 By 01531
# Modify.........:
################################################################################
PRIVATE FUNCTION afat504_01_fabo056_desc(p_oocq001,p_oocq002)
   DEFINE p_oocq001   LIKE oocq_t.oocq001
   DEFINE p_oocq002   LIKE oocq_t.oocq002
   DEFINE r_ref       LIKE type_t.chr500
   WHENEVER ERROR CONTINUE

   LET r_ref = NULL

   SELECT oocql004 INTO r_ref FROM oocql_t
    WHERE oocqlent = g_enterprise
      AND oocql001 = p_oocq001
      AND oocql002 = p_oocq002
      AND oocql003 = g_dlang

   RETURN r_ref
END FUNCTION

 
{</section>}
 
