<spec prog="afap240" std_prog="afap240" erpver="1.0" ver="1" module="AFA" booking="Y" class="p" template="P001_00" env="s" zone="t10dev">
  <other>
    <code_template value="P" status="" />
    <free_style value="N" status="" />
  </other>
  <toolbar items="output" />
  <prog_rel />
  <ref_field>
    <rfield cite_std="" ver="1" name="faah006_desc" src="s" depend_filed="faah_t.faah006" correspon_key="faah006" ref_table="faacl_t" ref_fk="faacl001" ref_dlang="faacl002" ref_rtn="faacl003" status="" />
    <rfield cite_std="" ver="1" name="faah007_desc" src="s" depend_filed="faah_t.faah007" correspon_key="faah007" ref_table="faadl_t" ref_fk="faadl001" ref_dlang="faadl002" ref_rtn="faadl003" status="" />
    <rfield cite_std="" ver="1" name="faah008_desc" src="s" depend_filed="faah_t.faah008" correspon_key="'3903',faah008" ref_table="oocql_t" ref_fk="oocql001,oocql002" ref_dlang="oocql003" ref_rtn="oocql004" status="" />
    <rfield cite_std="" ver="1" name="glaa001_desc" src="s" depend_filed="glaa_t.glaa001" correspon_key="glaaent,glaa001" ref_table="ooail_t" ref_fk="ooailent,ooail001" ref_dlang="ooail002" ref_rtn="ooail003" status="" />
    <rfield cite_std="" ver="1" name="glaacomp_desc" src="s" depend_filed="glaa_t.glaacomp" correspon_key="glaaent,glaacomp" ref_table="ooefl_t" ref_fk="ooeflent,ooefl001" ref_dlang="ooefl002" ref_rtn="ooefl003" status="" />
    <rfield cite_std="" ver="1" name="glaald_desc" src="s" depend_filed="glaa_t.glaald" correspon_key="glaald" ref_table="glaal_t" ref_fk="glaalld" ref_dlang="glaal001" ref_rtn="glaal002" status="" />
  </ref_field>
  <multi_lang />
  <help_code>
    <hfield src="s" ver="1" name="faah_t.faah022" depend_filed="" correspon_key="" help_table="" help_fk="" help_rtn="" help_dlang="" status="" />
    <hfield src="s" ver="1" name="faah_t.faah024" depend_filed="" correspon_key="" help_table="" help_fk="" help_rtn="" help_dlang="" status="" />
    <hfield src="s" ver="1" name="glaa_t.glaa001" depend_filed="" correspon_key="" help_table="" help_fk="" help_rtn="" help_dlang="" status="" />
    <hfield src="s" ver="1" name="glaa_t.glaacomp" depend_filed="" correspon_key="" help_table="" help_fk="" help_rtn="" help_dlang="" status="" />
    <hfield src="s" ver="1" name="mm" depend_filed="" correspon_key="" help_table="" help_fk="" help_rtn="" help_dlang="" status="" />
    <hfield src="s" ver="1" name="yy" depend_filed="" correspon_key="" help_table="" help_fk="" help_rtn="" help_dlang="" status="" />
  </help_code>
  <strings>
    <sfield name="condition_page" text="條件輸入" comment="" lstr="" />
    <sfield name="group_qbe" text="帳套" comment="" lstr="" />
    <sfield name="lbl_glaald" text="帳套" comment="" lstr="" />
    <sfield name="lbl_glaal002" text="說明" comment="" lstr="" />
    <sfield name="lbl_glaacomp" text="歸屬法人" comment="" lstr="" />
    <sfield name="lbl_ooefl003" text="說明(簡稱)" comment="" lstr="" />
    <sfield name="lbl_glaa001" text="幣種" comment="" lstr="" />
    <sfield name="lbl_ooail003" text="說明" comment="" lstr="" />
    <sfield name="group_input" text="其他條件" comment="" lstr="" />
    <sfield name="lbl_yy" text="折舊年度" comment="" lstr="" />
    <sfield name="lbl_mm" text="折舊期別" comment="" lstr="" />
    <sfield name="sel_all" text="全選" comment="" lstr="" />
    <sfield name="regain" text="攤提還原" comment="" lstr="" />
    <sfield name="sel_none" text="取消全選" comment="" lstr="" />
    <sfield name="page1" text="符合條件資料" comment="" lstr="" />
    <sfield name="lbl_sel" text="選擇" comment="" lstr="" />
    <sfield name="lbl_faah003" text="財產編號" comment="" lstr="" />
    <sfield name="lbl_faah004" text="附號" comment="" lstr="" />
    <sfield name="lbl_faah006" text="資產主要類型" comment="" lstr="" />
    <sfield name="lbl_faacl003" text="主要類型名稱" comment="" lstr="" />
    <sfield name="lbl_faah007" text="資產次要類型" comment="" lstr="" />
    <sfield name="lbl_faadl003" text="次要類型名稱" comment="" lstr="" />
    <sfield name="lbl_faah005" text="資產性質" comment="" lstr="" />
    <sfield name="lbl_faah008" text="資產組" comment="" lstr="" />
    <sfield name="lbl_oocql004" text="資產組名稱" comment="" lstr="" />
    <sfield name="lbl_faah042" text="資產屬性" comment="" lstr="" />
    <sfield name="lbl_faah022" text="原幣金額" comment="" lstr="" />
    <sfield name="lbl_faah024" text="本幣金額" comment="" lstr="" />
    <sfield name="scheduling_page" text="排程設定" comment="" lstr="" />
    <sfield name="history_page" text="執行歷程" comment="" lstr="" />
    <sfield name="group_progress" text="處理進度" comment="" lstr="" />
    <sfield name="lbl_stagenow" text="目前處理階段:" comment="" lstr="" />
    <sfield name="lbl_stagecomplete" text="整體完成進度:" comment="" lstr="" />
    <sact name="regain" text="攤提還原" comment="" lstr="" />
    <sact name="sel_all" text="全選" comment="" lstr="" />
    <sact name="sel_none" text="取消全選" comment="" lstr="" />
  </strings>
  <sa_spec />
  <table ver="" cite_std="N" />
  <all cite_std="" ver="1" src="s" status="">
<![CDATA[帐套参数：
1：固定资产入帐开始计提方式（1，次月，2，本月，3，15号前为本月，4，本月（入帐日至月底比率）
2：当月处份是否计提折旧（注：若是部份出售/销帐/报废,当月应可针对未处分的资产进行折旧）
3，已停用资产是否提列折旧


资产主档SQL:组sql时以帐套为基本条件
1： 取折旧明细档中分摊别不为3被分摊都，还原资产明细档（其中有传票单号的不可还原）
2：不可有大于该还原月份的异动
3：不可有大于该还原月份的折旧明细档
4：参数：当月处份是否计提折旧=Y，处分需先确认还原
5：若在折旧月份前就为先前折毕：
   IF 未使用年限 = 0 and ( 最近折旧年度 < 此次还原年度 or
             ( 最近折旧年度=此次还原年度 and 最近折旧月份< 此次还原月份 )) THEN
          LET l_over = 'Y'    
       ELSE 
          LET l_over = 'N'    
       END IF 
6： IF l_lover= N and 明细档中分摊别不为3被分摊时：还原折旧年月，累折，未折减额，本期累折，

未用月数，资产状态等栏位
    （涉及到资产状态时，以主帐套还原为准）
      其中如果折旧方式为4：本月折旧（入帐日到月底比率）
   1）判断此次还原是否为残月（状态为折毕或是折毕再提的是是最后一期）
   2）再判断已存在的折旧明细档的折旧次数+1是否等于耐用年限，且入帐日不为1
   3）还原时未用年限还原如为0，则第一个月折旧额需写回
        IF (资产状态= '折毕' OR 资产状态 ='折毕再提') AND  
                l_cnt = 折旧次数+1 AND DAY(取得日期) != 1
            LET 未使用年限=0 
         ELSE 未使用年限=未使用年限+1 
      如查是资产状态=折毕再提，判段是不是此还原月份是不是第一次进入状态为折毕再提，还原的话

要把未使用年限回写为1
7：更新完还原的资产卡片档时，删除此次还原月份的折旧明细档（faam_t)
 8:本位币二与三的资料删除与处理
]]>
</all>
  <field cite_std="N" name="faah_t.faah003" ver="1" src="s" column="faah003" table="faah_t" attribute="C580" type="varchar2(10)" req="N" i_zoom="" c_zoom="" chk_ref="" items="" default="" max="" min="" can_edit="Y" can_query="Y" widget="ButtonEdit" status="u">
<![CDATA[]]>
</field>
  <field cite_std="N" name="faah_t.faah004" ver="1" src="s" column="faah004" table="faah_t" attribute="C581" type="varchar2(4)" req="N" i_zoom="" c_zoom="" chk_ref="" items="" default="" max="" min="" can_edit="Y" can_query="Y" widget="ButtonEdit" status="u">
<![CDATA[]]>
</field>
  <field cite_std="N" name="faah_t.faah005" ver="1" src="s" column="faah005" table="faah_t" attribute="N806" type="number(10)" req="N" i_zoom="" c_zoom="" chk_ref="" items="" default="" max="" min="" can_edit="Y" can_query="Y" widget="ComboBox" status="">
<![CDATA[]]>
</field>
  <field cite_std="N" name="faah_t.faah006" ver="1" src="s" column="faah006" table="faah_t" attribute="C002" type="varchar2(10)" req="N" i_zoom="" c_zoom="" chk_ref="" items="" default="" max="" min="" can_edit="Y" can_query="Y" widget="ButtonEdit" status="">
<![CDATA[]]>
</field>
  <field cite_std="N" name="faah_t.faah007" ver="1" src="s" column="faah007" table="faah_t" attribute="C002" type="varchar2(10)" req="N" i_zoom="" c_zoom="" chk_ref="" items="" default="" max="" min="" can_edit="Y" can_query="Y" widget="ButtonEdit" status="">
<![CDATA[]]>
</field>
  <field cite_std="N" name="faah_t.faah008" ver="1" src="s" column="faah008" table="faah_t" attribute="N806" type="number(10)" req="N" i_zoom="" c_zoom="" chk_ref="" items="" default="" max="" min="" can_edit="Y" can_query="Y" widget="ButtonEdit" status="">
<![CDATA[]]>
</field>
  <field cite_std="N" name="faah_t.faah022" ver="1" src="s" column="faah022" table="faah_t" attribute="N202" type="number(20,6)" req="N" i_zoom="" c_zoom="" chk_ref="" items="" default="" max="" min="" can_edit="Y" can_query="Y" widget="Edit" status="">
<![CDATA[]]>
</field>
  <field cite_std="N" name="faah_t.faah024" ver="1" src="s" column="faah024" table="faah_t" attribute="N202" type="number(20,6)" req="N" i_zoom="" c_zoom="" chk_ref="" items="" default="" max="" min="" can_edit="Y" can_query="Y" widget="Edit" status="">
<![CDATA[]]>
</field>
  <field cite_std="N" name="faah_t.faah042" ver="1" src="s" column="faah042" table="faah_t" attribute="N806" type="number(10)" req="N" i_zoom="" c_zoom="" chk_ref="" items="" default="" max="" min="" can_edit="Y" can_query="Y" widget="ComboBox" status="">
<![CDATA[]]>
</field>
  <field cite_std="N" name="glaa_t.glaa001" ver="1" src="s" column="glaa001" table="glaa_t" attribute="C008" type="varchar2(10)" req="Y" i_zoom="q_ooai001" c_zoom="q_ooai001" chk_ref="" items="" default="" max="" min="" can_edit="Y" can_query="Y" widget="Edit" status="">
<![CDATA[]]>
</field>
  <field cite_std="N" name="glaa_t.glaacomp" ver="1" src="s" column="glaacomp" table="glaa_t" attribute="C007" type="varchar2(10)" req="Y" i_zoom="q_ooea001_2" c_zoom="q_ooea001_2" chk_ref="" items="" default="" max="" min="" can_edit="Y" can_query="Y" widget="Edit" status="">
<![CDATA[]]>
</field>
  <field cite_std="N" name="glaa_t.glaald" ver="1" src="s" column="glaald" table="glaa_t" attribute="C501" type="varchar2(5)" req="Y" i_zoom="q_authorised_ld" c_zoom="q_authorised_ld" chk_ref="" items="" default="" max="" min="" can_edit="Y" can_query="Y" widget="ButtonEdit" status="">
<![CDATA[帳套：
   ●欄位控管：
     資料欄位:glaald /可Display 可Input
     預設值:
            
     校驗:1.不允許空白
        
     帶值:帳套名稱，歸屬法人，法人名稱,币别

　　　]]>
</field>
  <field cite_std="N" name="mm" ver="1" src="s" column="" table="" attribute="" type="" req="Y" i_zoom="" c_zoom="" chk_ref="" items="" default="" max="" min="" can_edit="Y" can_query="Y" widget="Edit" status="">
<![CDATA[]]>
</field>
  <field cite_std="N" name="sel" ver="1" src="s" column="" table="" attribute="" type="" req="Y" i_zoom="" c_zoom="" chk_ref="" items="" default="N" max="" min="" can_edit="Y" can_query="Y" widget="CheckBox" status="">
<![CDATA[]]>
</field>
  <field cite_std="N" name="yy" ver="1" src="s" column="" table="" attribute="" type="" req="Y" i_zoom="" c_zoom="" chk_ref="" items="" default="" max="" min="" can_edit="Y" can_query="Y" widget="Edit" status="">
<![CDATA[]]>
</field>
  <field src="s" ver="1" column="" name="faah003" table="" attribute="" type="" req="" i_zoom="" c_zoom="" chk_ref="" items="" default="" max="" min="" can_edit="Y" can_query="Y" widget="ButtonEdit" cite_std="N" status="d">
<![CDATA[]]>
</field>
  <field src="s" ver="1" column="" name="faah004" table="" attribute="" type="" req="" i_zoom="" c_zoom="" chk_ref="" items="" default="" max="" min="" can_edit="Y" can_query="Y" widget="ButtonEdit" cite_std="N" status="d">
<![CDATA[]]>
</field>
  <act cite_std="N" id="regain" ver="1" src="s" type="all" status="">
<![CDATA[]]>
</act>
  <act cite_std="N" id="sel_all" ver="1" src="s" type="all" status="">
<![CDATA[]]>
</act>
  <act cite_std="N" id="sel_none" ver="1" src="s" type="all" status="">
<![CDATA[]]>
</act>
  <exclude ver="" cite_std="N" src="" />
</spec>