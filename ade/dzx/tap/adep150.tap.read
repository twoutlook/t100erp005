<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<add_points prog="adep150" std_prog="adep150" erpver="1.0" module="ADE" ver="1" env="s" zone="t10prd" booking="N" type="M" identity="s" section_flag="N" designer_ver="1.0">
  <other>
    <code_template value="P" status="u"/>
    <free_style value="N" status="u"/>
    <start_arg value="1" status="u"/>
  </other>
  <point name="function.adep150_process0" order="1" ver="1" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#門店單品週結
PRIVATE FUNCTION adep150_process0(p_del)
   DEFINE p_del               LIKE type_t.chr1
   DEFINE r_success           LIKE type_t.num5
   DEFINE l_decfsite          LIKE decf_t.decfsite
   DEFINE l_decf041           LIKE decf_t.decf041
   DEFINE l_decf042           LIKE decf_t.decf042
   DEFINE l_decgsite          LIKE decg_t.decgsite
   DEFINE l_decg035           LIKE decg_t.decg035
   DEFINE l_decg036           LIKE decg_t.decg036
   
   LET r_success = TRUE  
   
   #decf_t已結轉資料 
   DECLARE adep150_decf_cs1 CURSOR FOR
    SELECT DISTINCT a.decfsite,a.decf041,a.decf042
      FROM adep150_decf_temp a
     WHERE EXISTS (SELECT 1 FROM decf_t b
             WHERE b.decfent  = a.decfent
               AND b.decfsite = a.decfsite
               AND b.decf041  = a.decf041 
               AND b.decf042  = a.decf042 ) 

   #decg_t已結轉資料
   DECLARE adep150_decg_cs1 CURSOR FOR
    SELECT DISTINCT a.decgsite,a.decg035,a.decg036
      FROM adep150_decg_temp a
     WHERE EXISTS (SELECT 1 FROM decg_t b
                    WHERE a.decgent  = b.decgent    
                      AND a.decgsite = b.decgsite   
                      AND a.decg035  = b.decg035    
                      AND a.decg036  = b.decg036)  
       AND NOT EXISTS (SELECT 1 FROM adep150_decf_temp c 
                        WHERE a.decgent  = c.decfent
                          AND a.decgsite = c.decfsite
                          AND a.decg035  = c.decf041 
                          AND a.decg036  = c.decf042 )

   IF p_del = "Y" THEN

      FOREACH adep150_decf_cs1 INTO l_decfsite,l_decf041,l_decf042
         INITIALIZE g_errparam TO NULL
         LET g_errparam.replace[1] = l_decfsite
         LET g_errparam.replace[2] = l_decf041
         LET g_errparam.replace[3] = l_decf042
         LET g_errparam.code = 'ade-00121'
         LET g_errparam.popup = TRUE
         CALL cl_err()
      END FOREACH

      #刪除已結轉資料
      LET g_sql = "DELETE FROM decf_t a ",
                  " WHERE EXISTS (SELECT 1 FROM adep150_decf_temp b ",
                  "         WHERE a.decfent  = b.decfent ",
                  "           AND a.decfsite = b.decfsite",
                  "           AND a.decf041  = b.decf041 ", 
                  "           AND a.decf042  = b.decf042 )" 
      PREPARE adep150_del_decf_prep1 FROM g_sql
      EXECUTE adep150_del_decf_prep1

      #塞資料                  
      INSERT INTO decf_t ( decfent, decfsite,decf001, decf005, decf006,
                           decf007, decf008, decf009, decf010, decf011,
                           decf012, decf013, decf014, decf015, decf016,
                           decf017, decf018, decf019, decf020, decf021,
                           decf022, decf023, decf024, decf025, decf026,
                           decf027, decf028, decf029, decf030, decf031,
                           decf032, decf033, decf034, decf035, decf036,
                           decf037, decf038, decf039, decf040, decf041,
                           decf042, decf043, decf044, decf045, decf046, 
                           decf047, decf048)
      SELECT decfent, decfsite,decf001, decf005, decf006,
             decf007, decf008, decf009, decf010, decf011,
             decf012, decf013, decf014, decf015, decf016,
             decf017, decf018, decf019, decf020, decf021,
             decf022, decf023, decf024, decf025, decf026,
             decf027, decf028, decf029, decf030, decf031,
             decf032, decf033, decf034, decf035, decf036,
             decf037, decf038, decf039, decf040, decf041,
             decf042, decf043, decf044, decf045, decf046,
             decf047, decf048
        FROM adep150_decf_temp

      IF SQLCA.SQLcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "ins decf_t"
         LET g_errparam.popup = TRUE
         CALL cl_err()
         LET r_success = FALSE
         RETURN r_success
      END IF

      FOREACH adep150_decg_cs1 INTO l_decgsite,l_decg035,l_decg036
         INITIALIZE g_errparam TO NULL
         LET g_errparam.replace[1] = l_decgsite
         LET g_errparam.replace[2] = l_decg035
         LET g_errparam.replace[3] = l_decg036
         LET g_errparam.code = 'ade-00121'
         LET g_errparam.popup = TRUE
         CALL cl_err()
      END FOREACH

      #刪除已結轉資料
      LET g_sql = "DELETE FROM decg_t a ",
                  " WHERE EXISTS (SELECT 1 FROM adep150_decg_temp b ",
                  "                WHERE b.decgent  = a.decgent ",
                  "                  AND b.decgsite = a.decgsite",
                  "                  AND b.decg035  = a.decg035 ",
                  "                  AND b.decg036  = a.decg036)"
      PREPARE adep150_del_decg_prep1 FROM g_sql
      EXECUTE adep150_del_decg_prep1

      #塞資料                  
      INSERT INTO decg_t ( decgent,  decgsite, decg001, decg005, decg006,
                           decg007,  decg008,  decg009, decg010, decg011,
                           decg012,  decg013,  decg014, decg015, decg016,
                           decg017,  decg018,  decg019, decg020, decg021,   
                           decg022,  decg023,  decg024, decg025, decg026,
                           decg027,  decg028,  decg029, decg030, decg031, 
                           decg032,  decg033,  decg034, decg035, decg036,
                           decg037,  decg038)
      SELECT decgent,  decgsite, decg001, decg005, decg006,
             decg007,  decg008,  decg009, decg010, decg011,
             decg012,  decg013,  decg014, decg015, decg016,
             decg017,  decg018,  decg019, decg020, decg021,   
             decg022,  decg023,  decg024, decg025, decg026,
             decg027,  decg028,  decg029, decg030, decg031, 
             decg032,  decg033,  decg034, decg035, decg036,
             decg037,  decg038
        FROM adep150_decg_temp

      IF SQLCA.SQLcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "ins decg_t"
         LET g_errparam.popup = TRUE
         CALL cl_err()
         LET r_success = FALSE
         RETURN r_success
      END IF
   ELSE
      FOREACH adep150_decf_cs1 INTO l_decfsite,l_decf041,l_decf042
         INITIALIZE g_errparam TO NULL
         LET g_errparam.replace[1] = l_decfsite
         LET g_errparam.replace[2] = l_decf041
         LET g_errparam.replace[3] = l_decf042
         LET g_errparam.code = 'ade-00122'
         LET g_errparam.popup = TRUE
         CALL cl_err()
      END FOREACH

      #塞資料
      INSERT INTO decf_t ( decfent, decfsite,decf001, decf005, decf006,
                           decf007, decf008, decf009, decf010, decf011,
                           decf012, decf013, decf014, decf015, decf016,
                           decf017, decf018, decf019, decf020, decf021,
                           decf022, decf023, decf024, decf025, decf026,
                           decf027, decf028, decf029, decf030, decf031,
                           decf032, decf033, decf034, decf035, decf036,
                           decf037, decf038, decf039, decf040, decf041,
                           decf042, decf043, decf044, decf045, decf046, 
                           decf047, decf048)
      SELECT a.decfent, a.decfsite, a.decf001, a.decf005, a.decf006,
             a.decf007, a.decf008,  a.decf009, a.decf010, a.decf011,
             a.decf012, a.decf013,  a.decf014, a.decf015, a.decf016,
             a.decf017, a.decf018,  a.decf019, a.decf020, a.decf021,
             a.decf022, a.decf023,  a.decf024, a.decf025, a.decf026,
             a.decf027, a.decf028,  a.decf029, a.decf030, a.decf031,
             a.decf032, a.decf033,  a.decf034, a.decf035, a.decf036,
             a.decf037, a.decf038,  a.decf039, a.decf040, a.decf041,
             a.decf042, a.decf043,  a.decf044, a.decf045, a.decf046,
             a.decf047, a.decf048
        FROM adep150_decf_temp a
       WHERE NOT EXISTS (SELECT 1 FROM decf_t b
                          WHERE b.decfent  = a.decfent
                            AND b.decfsite = a.decfsite
                            AND b.decf041  = a.decf041 
                            AND b.decf042  = a.decf042 ) 

      IF SQLCA.SQLcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "ins decf_t"
         LET g_errparam.popup = TRUE
         CALL cl_err()
         LET r_success = FALSE
         RETURN r_success
      END IF

      FOREACH adep150_decg_cs1 INTO l_decgsite,l_decg035,l_decg036
         INITIALIZE g_errparam TO NULL
         LET g_errparam.replace[1] = l_decgsite
         LET g_errparam.replace[2] = l_decg035
         LET g_errparam.replace[3] = l_decg036
         LET g_errparam.code = 'ade-00122'
         LET g_errparam.popup = TRUE
         CALL cl_err()
      END FOREACH


      INSERT INTO decg_t ( decgent,  decgsite, decg001, decg005, decg006,
                           decg007,  decg008,  decg009, decg010, decg011,
                           decg012,  decg013,  decg014, decg015, decg016,
                           decg017,  decg018,  decg019, decg020, decg021,   
                           decg022,  decg023,  decg024, decg025, decg026,
                           decg027,  decg028,  decg029, decg030, decg031, 
                           decg032,  decg033,  decg034, decg035, decg036,
                           decg037,  decg038)
      SELECT a.decgent,  a.decgsite, a.decg001, a.decg005, a.decg006,
             a.decg007,  a.decg008,  a.decg009, a.decg010, a.decg011,
             a.decg012,  a.decg013,  a.decg014, a.decg015, a.decg016,
             a.decg017,  a.decg018,  a.decg019, a.decg020, a.decg021,   
             a.decg022,  a.decg023,  a.decg024, a.decg025, a.decg026,
             a.decg027,  a.decg028,  a.decg029, a.decg030, a.decg031, 
             a.decg032,  a.decg033,  a.decg034, a.decg035, a.decg036,
             a.decg037,  a.decg038
        FROM adep150_decg_temp a 
       WHERE NOT EXISTS (SELECT 1 FROM decg_t b
                          WHERE a.decgent  = b.decgent    
                            AND a.decgsite = b.decgsite   
                            AND a.decg035  = b.decg035    
                            AND a.decg036  = b.decg036)  
      IF SQLCA.SQLcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "ins decg_t"
         LET g_errparam.popup = TRUE
         CALL cl_err()
         LET r_success = FALSE
         RETURN r_success
      END IF

   END IF  
   
   RETURN r_success
END FUNCTION]]>
  </point>
  <point name="function.adep150_process2" order="2" ver="1" cite_std="N" new="Y" status="d" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="function.adep150_process1" order="2" ver="1" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#門店品類週結
PRIVATE FUNCTION adep150_process1(p_del)
   DEFINE p_del               LIKE type_t.chr1
   DEFINE r_success           LIKE type_t.num5
   DEFINE l_dectsite          LIKE dect_t.dectsite
   DEFINE l_dect034           LIKE dect_t.dect034
   DEFINE l_dect035           LIKE dect_t.dect035
   DEFINE l_decusite          LIKE decu_t.decusite
   DEFINE l_decu025           LIKE decu_t.decu025
   DEFINE l_decu026           LIKE decu_t.decu026
   
   LET r_success = TRUE  
   
   #dect_t已結轉資料 
   DECLARE adep150_dect_cs1 CURSOR FOR
    SELECT DISTINCT a.dectsite,a.dect034,a.dect035
      FROM adep150_dect_temp a
     WHERE EXISTS (SELECT 1 FROM dect_t b
             WHERE b.dectent  = a.dectent
               AND b.dectsite = a.dectsite
               AND b.dect034  = a.dect034 
               AND b.dect035  = a.dect035 ) 

   #decu_t已結轉資料
   DECLARE adep150_decu_cs1 CURSOR FOR
    SELECT DISTINCT a.decusite,a.decu025,a.decu026
      FROM adep150_decu_temp a
     WHERE EXISTS (SELECT 1 FROM decu_t b
                    WHERE a.decuent  = b.decuent    
                      AND a.decusite = b.decusite   
                      AND a.decu025  = b.decu025    
                      AND a.decu026  = b.decu026)  
       AND NOT EXISTS (SELECT 1 FROM adep150_dect_temp c 
                        WHERE a.decuent  = c.dectent
                          AND a.decusite = c.dectsite
                          AND a.decu025  = c.dect034 
                          AND a.decu026  = c.dect035 )

   IF p_del = "Y" THEN

      FOREACH adep150_dect_cs1 INTO l_dectsite,l_dect034,l_dect035
         INITIALIZE g_errparam TO NULL
         LET g_errparam.replace[1] = l_dectsite
         LET g_errparam.replace[2] = l_dect034
         LET g_errparam.replace[3] = l_dect035
         LET g_errparam.code = 'ade-00121'
         LET g_errparam.popup = TRUE
         CALL cl_err()
      END FOREACH

      #刪除已結轉資料
      LET g_sql = "DELETE FROM dect_t a ",
                  " WHERE EXISTS (SELECT 1 FROM adep150_dect_temp b ",
                  "         WHERE a.dectent  = b.dectent ",
                  "           AND a.dectsite = b.dectsite",
                  "           AND a.dect034  = b.dect034 ", 
                  "           AND a.dect035  = b.dect035 )" 
      PREPARE adep150_del_dect_prep1 FROM g_sql
      EXECUTE adep150_del_dect_prep1

      #塞資料                  
      INSERT INTO dect_t ( dectent, dectsite,dect001, dect005, dect006,
                           dect007, dect008, dect009, dect010, dect011,
                           dect012, dect013, dect014, dect015, dect016,
                           dect017, dect018, dect019, dect020, dect021,
                           dect022, dect023, dect024, dect025, dect026,
                           dect027, dect028, dect029, dect030, dect031,
                           dect032, dect033, dect034, dect035, dect036,
                           dect037)
      SELECT dectent, dectsite,dect001, dect005, dect006,
             dect007, dect008, dect009, dect010, dect011,
             dect012, dect013, dect014, dect015, dect016,
             dect017, dect018, dect019, dect020, dect021,
             dect022, dect023, dect024, dect025, dect026,
             dect027, dect028, dect029, dect030, dect031,
             dect032, dect033, dect034, dect035, dect036,
             dect037
        FROM adep150_dect_temp

      IF SQLCA.SQLcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "ins dect_t"
         LET g_errparam.popup = TRUE
         CALL cl_err()
         LET r_success = FALSE
         RETURN r_success
      END IF

      FOREACH adep150_decu_cs1 INTO l_decusite,l_decu025,l_decu026
         INITIALIZE g_errparam TO NULL
         LET g_errparam.replace[1] = l_decusite
         LET g_errparam.replace[2] = l_decu025
         LET g_errparam.replace[3] = l_decu026
         LET g_errparam.code = 'ade-00121'
         LET g_errparam.popup = TRUE
         CALL cl_err()
      END FOREACH

      #刪除已結轉資料
      LET g_sql = "DELETE FROM decu_t a ",
                  " WHERE EXISTS (SELECT 1 FROM adep150_decu_temp b ",
                  "                WHERE b.decuent  = a.decuent ",
                  "                  AND b.decusite = a.decusite",
                  "                  AND b.decu025  = a.decu025 ",
                  "                  AND b.decu026  = a.decu026)"
      PREPARE adep150_del_decu_prep1 FROM g_sql
      EXECUTE adep150_del_decu_prep1

      #塞資料                  
      INSERT INTO decu_t ( decuent,  decusite, decu001, decu005, decu006,
                           decu007,  decu008,  decu009, decu010, decu011,
                           decu012,  decu013,  decu014, decu015, decu016,
                           decu017,  decu018,  decu019, decu020, decu021,   
                           decu022,  decu023,  decu024, decu025, decu026,
                           decu027,  decu028)
      SELECT decuent,  decusite, decu001, decu005, decu006,
             decu007,  decu008,  decu009, decu010, decu011,
             decu012,  decu013,  decu014, decu015, decu016,
             decu017,  decu018,  decu019, decu020, decu021,   
             decu022,  decu023,  decu024, decu025, decu026,
             decu027,  decu028
        FROM adep150_decu_temp

      IF SQLCA.SQLcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "ins decu_t"
         LET g_errparam.popup = TRUE
         CALL cl_err()
         LET r_success = FALSE
         RETURN r_success
      END IF
   ELSE
      FOREACH adep150_dect_cs1 INTO l_dectsite,l_dect034,l_dect035
         INITIALIZE g_errparam TO NULL
         LET g_errparam.replace[1] = l_dectsite
         LET g_errparam.replace[2] = l_dect034
         LET g_errparam.replace[3] = l_dect035
         LET g_errparam.code = 'ade-00122'
         LET g_errparam.popup = TRUE
         CALL cl_err()
      END FOREACH

      #塞資料
      INSERT INTO dect_t ( dectent, dectsite,dect001, dect005, dect006,
                           dect007, dect008, dect009, dect010, dect011,
                           dect012, dect013, dect014, dect015, dect016,
                           dect017, dect018, dect019, dect020, dect021,
                           dect022, dect023, dect024, dect025, dect026,
                           dect027, dect028, dect029, dect030, dect031,
                           dect032, dect033, dect034, dect035, dect036,
                           dect037)
      SELECT a.dectent, a.dectsite, a.dect001, a.dect005, a.dect006,
             a.dect007, a.dect008,  a.dect009, a.dect010, a.dect011,
             a.dect012, a.dect013,  a.dect014, a.dect015, a.dect016,
             a.dect017, a.dect018,  a.dect019, a.dect020, a.dect021,
             a.dect022, a.dect023,  a.dect024, a.dect025, a.dect026,
             a.dect027, a.dect028,  a.dect029, a.dect030, a.dect031,
             a.dect032, a.dect033,  a.dect034, a.dect035, a.dect036,
             a.dect037
        FROM adep150_dect_temp a
       WHERE NOT EXISTS (SELECT 1 FROM dect_t b
                          WHERE b.dectent  = a.dectent
                            AND b.dectsite = a.dectsite
                            AND b.dect034  = a.dect034 
                            AND b.dect035  = a.dect035 ) 

      IF SQLCA.SQLcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "ins dect_t"
         LET g_errparam.popup = TRUE
         CALL cl_err()
         LET r_success = FALSE
         RETURN r_success
      END IF

      FOREACH adep150_decu_cs1 INTO l_decusite,l_decu025,l_decu026
         INITIALIZE g_errparam TO NULL
         LET g_errparam.replace[1] = l_decusite
         LET g_errparam.replace[2] = l_decu025
         LET g_errparam.replace[3] = l_decu026
         LET g_errparam.code = 'ade-00122'
         LET g_errparam.popup = TRUE
         CALL cl_err()
      END FOREACH


      INSERT INTO decu_t ( decuent,  decusite, decu001, decu005, decu006,
                           decu007,  decu008,  decu009, decu010, decu011,
                           decu012,  decu013,  decu014, decu015, decu016,
                           decu017,  decu018,  decu019, decu020, decu021,   
                           decu022,  decu023,  decu024, decu025, decu026,
                           decu027,  decu028)
      SELECT a.decuent,  a.decusite, a.decu001, a.decu005, a.decu006,
             a.decu007,  a.decu008,  a.decu009, a.decu010, a.decu011,
             a.decu012,  a.decu013,  a.decu014, a.decu015, a.decu016,
             a.decu017,  a.decu018,  a.decu019, a.decu020, a.decu021,   
             a.decu022,  a.decu023,  a.decu024, a.decu025, a.decu026,
             a.decu027,  a.decu028
        FROM adep150_decu_temp a 
       WHERE NOT EXISTS (SELECT 1 FROM decu_t b
                          WHERE a.decuent  = b.decuent    
                            AND a.decusite = b.decusite   
                            AND a.decu025  = b.decu025    
                            AND a.decu026  = b.decu026)  
      IF SQLCA.SQLcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "ins decu_t"
         LET g_errparam.popup = TRUE
         CALL cl_err()
         LET r_success = FALSE
         RETURN r_success
      END IF

   END IF  
   
   RETURN r_success
   
END FUNCTION]]>
  </point>
  <point name="function.adep150_process4" order="3" ver="1" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#門店庫區週結
PRIVATE FUNCTION adep150_process4(p_del)
   DEFINE p_del               LIKE type_t.chr1
   DEFINE r_success           LIKE type_t.num5
   DEFINE l_dechsite          LIKE dech_t.dechsite
   DEFINE l_dech031           LIKE dech_t.dech031
   DEFINE l_dech032           LIKE dech_t.dech032
   DEFINE l_decisite          LIKE deci_t.decisite
   DEFINE l_deci027           LIKE deci_t.deci027
   DEFINE l_deci028           LIKE deci_t.deci028
   DEFINE l_decjsite          LIKE decj_t.decjsite
   DEFINE l_decj015           LIKE decj_t.decj015
   DEFINE l_decj016           LIKE decj_t.decj016
   
   LET r_success = TRUE  
   
   #dech_t已結轉資料 
   DECLARE adep150_dech_cs1 CURSOR FOR
    SELECT DISTINCT a.dechsite,a.dech031,a.dech032
      FROM adep150_dech_temp a
     WHERE EXISTS (SELECT 1 FROM dech_t b
             WHERE b.dechent  = a.dechent
               AND b.dechsite = a.dechsite
               AND b.dech031  = a.dech031 
               AND b.dech032  = a.dech032 ) 

   #deci_t已結轉資料
   DECLARE adep150_deci_cs1 CURSOR FOR
    SELECT DISTINCT a.decisite,a.deci027,a.deci028
      FROM adep150_deci_temp a
     WHERE EXISTS (SELECT 1 FROM deci_t b
                    WHERE a.decient  = b.decient    
                      AND a.decisite = b.decisite   
                      AND a.deci027  = b.deci027    
                      AND a.deci028  = b.deci028)  
       AND NOT EXISTS (SELECT 1 FROM adep150_dech_temp c 
                        WHERE a.decient  = c.dechent
                          AND a.decisite = c.dechsite
                          AND a.deci027  = c.dech031 
                          AND a.deci028  = c.dech032 )

   #decj_t已結轉資料
   DECLARE adep150_decj_cs1 CURSOR FOR
    SELECT DISTINCT a.decjsite,a.decj015,a.decj016
      FROM adep150_decj_temp a
     WHERE EXISTS (SELECT 1 FROM decj_t b
                    WHERE a.decjent  = b.decjent    
                      AND a.decjsite = b.decjsite   
                      AND a.decj015  = b.decj015    
                      AND a.decj016  = b.decj016)  
       AND NOT EXISTS (SELECT 1 FROM adep150_dech_temp c 
                        WHERE a.decjent  = c.dechent
                          AND a.decjsite = c.dechsite
                          AND a.decj015  = c.dech031 
                          AND a.decj016  = c.dech032 )

   IF p_del = "Y" THEN

      FOREACH adep150_dech_cs1 INTO l_dechsite,l_dech031,l_dech032
         INITIALIZE g_errparam TO NULL
         LET g_errparam.replace[1] = l_dechsite
         LET g_errparam.replace[2] = l_dech031
         LET g_errparam.replace[3] = l_dech032
         LET g_errparam.code = 'ade-00121'
         LET g_errparam.popup = TRUE
         CALL cl_err()
      END FOREACH

      #刪除已結轉資料
      LET g_sql = "DELETE FROM dech_t a ",
                  " WHERE EXISTS (SELECT 1 FROM adep150_dech_temp b ",
                  "         WHERE a.dechent  = b.dechent ",
                  "           AND a.dechsite = b.dechsite",
                  "           AND a.dech031  = b.dech031 ", 
                  "           AND a.dech032  = b.dech032 )" 
      PREPARE adep150_del_dech_prep1 FROM g_sql
      EXECUTE adep150_del_dech_prep1

      #塞資料                  
      INSERT INTO dech_t ( dechent, dechsite,dech001, dech005, dech006,
                           dech007, dech008, dech009, dech010, dech011,
                           dech012, dech013, dech014, dech015, dech016,
                           dech017, dech018, dech019, dech020, dech021,
                           dech022, dech023, dech024, dech025, dech026,
                           dech027, dech028, dech029, dech030, dech031,
                           dech032, dech033)
      SELECT dechent, dechsite,dech001, dech005, dech006,
             dech007, dech008, dech009, dech010, dech011,
             dech012, dech013, dech014, dech015, dech016,
             dech017, dech018, dech019, dech020, dech021,
             dech022, dech023, dech024, dech025, dech026,
             dech027, dech028, dech029, dech030, dech031,
             dech032, dech033
        FROM adep150_dech_temp

      IF SQLCA.SQLcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "ins dech_t"
         LET g_errparam.popup = TRUE
         CALL cl_err()
         LET r_success = FALSE
         RETURN r_success
      END IF

      FOREACH adep150_deci_cs1 INTO l_decisite,l_deci027,l_deci028
         INITIALIZE g_errparam TO NULL
         LET g_errparam.replace[1] = l_decisite
         LET g_errparam.replace[2] = l_deci027
         LET g_errparam.replace[3] = l_deci028
         LET g_errparam.code = 'ade-00121'
         LET g_errparam.popup = TRUE
         CALL cl_err()
      END FOREACH

      #刪除已結轉資料
      LET g_sql = "DELETE FROM deci_t a ",
                  " WHERE EXISTS (SELECT 1 FROM adep150_deci_temp b ",
                  "                WHERE b.decient  = a.decient ",
                  "                  AND b.decisite = a.decisite",
                  "                  AND b.deci027  = a.deci027 ",
                  "                  AND b.deci028  = a.deci028)"
      PREPARE adep150_del_deci_prep1 FROM g_sql
      EXECUTE adep150_del_deci_prep1

      #塞資料                  
      INSERT INTO deci_t ( decient,  decisite, deci001, deci005, deci006,
                           deci007,  deci008,  deci009, deci010, deci011,
                           deci012,  deci013,  deci014, deci015, deci016,
                           deci017,  deci018,  deci019, deci020, deci021,   
                           deci022,  deci023,  deci024, deci025, deci026,
                           deci027,  deci028,  deci029)
      SELECT decient,  decisite, deci001, deci005, deci006,
             deci007,  deci008,  deci009, deci010, deci011,
             deci012,  deci013,  deci014, deci015, deci016,
             deci017,  deci018,  deci019, deci020, deci021,   
             deci022,  deci023,  deci024, deci025, deci026,
             deci027,  deci028,  deci029
        FROM adep150_deci_temp

      IF SQLCA.SQLcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "ins deci_t"
         LET g_errparam.popup = TRUE
         CALL cl_err()
         LET r_success = FALSE
         RETURN r_success
      END IF

      FOREACH adep150_decj_cs1 INTO l_decjsite,l_decj015,l_decj016
         INITIALIZE g_errparam TO NULL
         LET g_errparam.replace[1] = l_decjsite
         LET g_errparam.replace[2] = l_decj015
         LET g_errparam.replace[3] = l_decj016
         LET g_errparam.code = 'ade-00121'
         LET g_errparam.popup = TRUE
         CALL cl_err()
      END FOREACH

      #刪除已結轉資料
      LET g_sql = "DELETE FROM decj_t a ",
                  " WHERE EXISTS (SELECT 1 FROM adep150_decj_temp b ",
                  "                WHERE b.decjent  = a.decjent ",
                  "                  AND b.decjsite = a.decjsite",
                  "                  AND b.decj015  = a.decj015 ",
                  "                  AND b.decj016  = a.decj016)"
      PREPARE adep150_del_decj_prep1 FROM g_sql
      EXECUTE adep150_del_decj_prep1

      #塞資料                  
      INSERT INTO decj_t ( decjent,  decjsite, decj001, decj005, decj006,
                           decj007,  decj008,  decj009, decj010, decj011,
                           decj012,  decj013,  decj014, decj015, decj016)
      SELECT decjent,  decjsite, decj001, decj005, decj006,
             decj007,  decj008,  decj009, decj010, decj011,
             decj012,  decj013,  decj014, decj015, decj016 
        FROM adep150_decj_temp

      IF SQLCA.SQLcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "ins decj_t"
         LET g_errparam.popup = TRUE
         CALL cl_err()
         LET r_success = FALSE
         RETURN r_success
      END IF
   ELSE
      FOREACH adep150_dech_cs1 INTO l_dechsite,l_dech031,l_dech032
         INITIALIZE g_errparam TO NULL
         LET g_errparam.replace[1] = l_dechsite
         LET g_errparam.replace[2] = l_dech031
         LET g_errparam.replace[3] = l_dech032
         LET g_errparam.code = 'ade-00122'
         LET g_errparam.popup = TRUE
         CALL cl_err()
      END FOREACH

      #塞資料
      INSERT INTO dech_t ( dechent, dechsite,dech001, dech005, dech006,
                           dech007, dech008, dech009, dech010, dech011,
                           dech012, dech013, dech014, dech015, dech016,
                           dech017, dech018, dech019, dech020, dech021,
                           dech022, dech023, dech024, dech025, dech026,
                           dech027, dech028, dech029, dech030, dech031,
                           dech032, dech033)
      SELECT a.dechent, a.dechsite, a.dech001, a.dech005, a.dech006,
             a.dech007, a.dech008,  a.dech009, a.dech010, a.dech011,
             a.dech012, a.dech013,  a.dech014, a.dech015, a.dech016,
             a.dech017, a.dech018,  a.dech019, a.dech020, a.dech021,
             a.dech022, a.dech023,  a.dech024, a.dech025, a.dech026,
             a.dech027, a.dech028,  a.dech029, a.dech030, a.dech031,
             a.dech032, a.dech033
        FROM adep150_dech_temp a
       WHERE NOT EXISTS (SELECT 1 FROM dech_t b
                          WHERE b.dechent  = a.dechent
                            AND b.dechsite = a.dechsite
                            AND b.dech031  = a.dech031 
                            AND b.dech032  = a.dech032 ) 

      IF SQLCA.SQLcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "ins dech_t"
         LET g_errparam.popup = TRUE
         CALL cl_err()
         LET r_success = FALSE
         RETURN r_success
      END IF

      FOREACH adep150_deci_cs1 INTO l_decisite,l_deci027,l_deci028
         INITIALIZE g_errparam TO NULL
         LET g_errparam.replace[1] = l_decisite
         LET g_errparam.replace[2] = l_deci027
         LET g_errparam.replace[3] = l_deci028
         LET g_errparam.code = 'ade-00122'
         LET g_errparam.popup = TRUE
         CALL cl_err()
      END FOREACH


      INSERT INTO deci_t ( decient,  decisite, deci001, deci005, deci006,
                           deci007,  deci008,  deci009, deci010, deci011,
                           deci012,  deci013,  deci014, deci015, deci016,
                           deci017,  deci018,  deci019, deci020, deci021,   
                           deci022,  deci023,  deci024, deci025, deci026,
                           deci027,  deci028,  deci029)
      SELECT a.decient,  a.decisite, a.deci001, a.deci005, a.deci006,
             a.deci007,  a.deci008,  a.deci009, a.deci010, a.deci011,
             a.deci012,  a.deci013,  a.deci014, a.deci015, a.deci016,
             a.deci017,  a.deci018,  a.deci019, a.deci020, a.deci021,   
             a.deci022,  a.deci023,  a.deci024, a.deci025, a.deci026,
             a.deci027,  a.deci028,  a.deci029
        FROM adep150_deci_temp a 
       WHERE NOT EXISTS (SELECT 1 FROM deci_t b
                          WHERE a.decient  = b.decient    
                            AND a.decisite = b.decisite   
                            AND a.deci027  = b.deci027    
                            AND a.deci028  = b.deci028)  
      IF SQLCA.SQLcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "ins deci_t"
         LET g_errparam.popup = TRUE
         CALL cl_err()
         LET r_success = FALSE
         RETURN r_success
      END IF

      FOREACH adep150_decj_cs1 INTO l_decjsite,l_decj015,l_decj016
         INITIALIZE g_errparam TO NULL
         LET g_errparam.replace[1] = l_decjsite
         LET g_errparam.replace[2] = l_decj015
         LET g_errparam.replace[3] = l_decj016
         LET g_errparam.code = 'ade-00122'
         LET g_errparam.popup = TRUE
         CALL cl_err()
      END FOREACH

      #塞資料                  
      INSERT INTO decj_t ( decjent,  decjsite, decj001, decj005, decj006,
                           decj007,  decj008,  decj009, decj010, decj011,
                           decj012,  decj013,  decj014, decj015, decj016)
      SELECT decjent,  decjsite, decj001, decj005, decj006,
             decj007,  decj008,  decj009, decj010, decj011,
             decj012,  decj013,  decj014, decj015, decj016 
        FROM adep150_decj_temp
       WHERE NOT EXISTS (SELECT 1 FROM decj_t b
                          WHERE a.decjent  = b.decjent    
                            AND a.decjsite = b.decjsite   
                            AND a.decj015  = b.decj015    
                            AND a.decj016  = b.decj016)  

      IF SQLCA.SQLcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "ins decj_t"
         LET g_errparam.popup = TRUE
         CALL cl_err()
         LET r_success = FALSE
         RETURN r_success
      END IF

   END IF  
   
   RETURN r_success
END FUNCTION]]>
  </point>
  <point name="function.adep150_process5" order="4" ver="1" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#門店專櫃週結
PRIVATE FUNCTION adep150_process5(p_del)
   DEFINE p_del               LIKE type_t.chr1
   DEFINE r_success           LIKE type_t.num5
   DEFINE l_decksite          LIKE deck_t.decksite
   DEFINE l_deck027           LIKE deck_t.deck027
   DEFINE l_deck028           LIKE deck_t.deck028
   DEFINE l_declsite          LIKE decl_t.declsite
   DEFINE l_decl023           LIKE decl_t.decl023
   DEFINE l_decl024           LIKE decl_t.decl024
   DEFINE l_decmsite          LIKE decm_t.decmsite
   DEFINE l_decm012           LIKE decm_t.decm012
   DEFINE l_decm013           LIKE decm_t.decm013
   
   LET r_success = TRUE  
   
   #deck_t已結轉資料 
   DECLARE adep150_deck_cs1 CURSOR FOR
    SELECT DISTINCT a.decksite,a.deck027,a.deck028
      FROM adep150_deck_temp a
     WHERE EXISTS (SELECT 1 FROM deck_t b
             WHERE b.deckent  = a.deckent
               AND b.decksite = a.decksite
               AND b.deck027  = a.deck027 
               AND b.deck028  = a.deck028 ) 

   #decl_t已結轉資料
   DECLARE adep150_decl_cs1 CURSOR FOR
    SELECT DISTINCT a.declsite,a.decl023,a.decl024
      FROM adep150_decl_temp a
     WHERE EXISTS (SELECT 1 FROM decl_t b
                    WHERE a.declent  = b.declent    
                      AND a.declsite = b.declsite   
                      AND a.decl023  = b.decl023    
                      AND a.decl024  = b.decl024)  
       AND NOT EXISTS (SELECT 1 FROM adep150_deck_temp c 
                        WHERE a.declent  = c.deckent
                          AND a.declsite = c.decksite
                          AND a.decl023  = c.deck027 
                          AND a.decl024  = c.deck028 )

   #decm_t已結轉資料
   DECLARE adep150_decm_cs1 CURSOR FOR
    SELECT DISTINCT a.decmsite,a.decm012,a.decm013
      FROM adep150_decm_temp a
     WHERE EXISTS (SELECT 1 FROM decm_t b
                    WHERE a.decment  = b.decment    
                      AND a.decmsite = b.decmsite   
                      AND a.decm012  = b.decm012    
                      AND a.decm013  = b.decm013)  
       AND NOT EXISTS (SELECT 1 FROM adep150_deck_temp c 
                        WHERE a.decment  = c.deckent
                          AND a.decmsite = c.decksite
                          AND a.decm012  = c.deck027 
                          AND a.decm013  = c.deck028 )

   IF p_del = "Y" THEN

      FOREACH adep150_deck_cs1 INTO l_decksite,l_deck027,l_deck028
         INITIALIZE g_errparam TO NULL
         LET g_errparam.replace[1] = l_decksite
         LET g_errparam.replace[2] = l_deck027
         LET g_errparam.replace[3] = l_deck028
         LET g_errparam.code = 'ade-00121'
         LET g_errparam.popup = TRUE
         CALL cl_err()
      END FOREACH

      #刪除已結轉資料
      LET g_sql = "DELETE FROM deck_t a ",
                  " WHERE EXISTS (SELECT 1 FROM adep150_deck_temp b ",
                  "         WHERE a.deckent  = b.deckent ",
                  "           AND a.decksite = b.decksite",
                  "           AND a.deck027  = b.deck027 ", 
                  "           AND a.deck028  = b.deck028 )" 
      PREPARE adep150_del_deck_prep1 FROM g_sql
      EXECUTE adep150_del_deck_prep1

      #塞資料                  
      INSERT INTO deck_t ( deckent, decksite,deck001, deck005, deck006,
                           deck007, deck008, deck009, deck010, deck011,
                           deck012, deck013, deck014, deck015, deck016,
                           deck017, deck018, deck019, deck020, deck021,
                           deck022, deck023, deck024, deck025, deck026,
                           deck027, deck028)
      SELECT deckent, decksite,deck001, deck005, deck006,
             deck007, deck008, deck009, deck010, deck011,
             deck012, deck013, deck014, deck015, deck016,
             deck017, deck018, deck019, deck020, deck021,
             deck022, deck023, deck024, deck025, deck026,
             deck027, deck028
        FROM adep150_deck_temp

      IF SQLCA.SQLcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "ins deck_t"
         LET g_errparam.popup = TRUE
         CALL cl_err()
         LET r_success = FALSE
         RETURN r_success
      END IF

      FOREACH adep150_decl_cs1 INTO l_declsite,l_decl023,l_decl024
         INITIALIZE g_errparam TO NULL
         LET g_errparam.replace[1] = l_declsite
         LET g_errparam.replace[2] = l_decl023
         LET g_errparam.replace[3] = l_decl024
         LET g_errparam.code = 'ade-00121'
         LET g_errparam.popup = TRUE
         CALL cl_err()
      END FOREACH

      #刪除已結轉資料
      LET g_sql = "DELETE FROM decl_t a ",
                  " WHERE EXISTS (SELECT 1 FROM adep150_decl_temp b ",
                  "                WHERE b.declent  = a.declent ",
                  "                  AND b.declsite = a.declsite",
                  "                  AND b.decl023  = a.decl023 ",
                  "                  AND b.decl024  = a.decl024)"
      PREPARE adep150_del_decl_prep1 FROM g_sql
      EXECUTE adep150_del_decl_prep1

      #塞資料                  
      INSERT INTO decl_t ( declent,  declsite, decl001, decl005, decl006,
                           decl007,  decl008,  decl009, decl010, decl011,
                           decl012,  decl013,  decl014, decl015, decl016,
                           decl017,  decl018,  decl019, decl020, decl021,   
                           decl022,  decl023,  decl024)
      SELECT declent,  declsite, decl001, decl005, decl006,
             decl007,  decl008,  decl009, decl010, decl011,
             decl012,  decl013,  decl014, decl015, decl016,
             decl017,  decl018,  decl019, decl020, decl021,   
             decl022,  decl023,  decl024
        FROM adep150_decl_temp

      IF SQLCA.SQLcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "ins decl_t"
         LET g_errparam.popup = TRUE
         CALL cl_err()
         LET r_success = FALSE
         RETURN r_success
      END IF

      FOREACH adep150_decm_cs1 INTO l_decmsite,l_decm012,l_decm013
         INITIALIZE g_errparam TO NULL
         LET g_errparam.replace[1] = l_decmsite
         LET g_errparam.replace[2] = l_decm012
         LET g_errparam.replace[3] = l_decm013
         LET g_errparam.code = 'ade-00121'
         LET g_errparam.popup = TRUE
         CALL cl_err()
      END FOREACH

      #刪除已結轉資料
      LET g_sql = "DELETE FROM decm_t a ",
                  " WHERE EXISTS (SELECT 1 FROM adep150_decm_temp b ",
                  "                WHERE b.decment  = a.decment ",
                  "                  AND b.decmsite = a.decmsite",
                  "                  AND b.decm012  = a.decm012 ",
                  "                  AND b.decm013  = a.decm013)"
      PREPARE adep150_del_decm_prep1 FROM g_sql
      EXECUTE adep150_del_decm_prep1

      #塞資料                  
      INSERT INTO decm_t ( decment,  decmsite, decm001, decm005, decm006,
                           decm007,  decm008,  decm009, decm010, decm011,
                           decm012,  decm013)
      SELECT decment,  decmsite, decm001, decm005, decm006,
             decm007,  decm008,  decm009, decm010, decm011,
             decm012,  decm013
        FROM adep150_decm_temp

      IF SQLCA.SQLcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "ins decm_t"
         LET g_errparam.popup = TRUE
         CALL cl_err()
         LET r_success = FALSE
         RETURN r_success
      END IF
   ELSE
      FOREACH adep150_deck_cs1 INTO l_decksite,l_deck027,l_deck028
         INITIALIZE g_errparam TO NULL
         LET g_errparam.replace[1] = l_decksite
         LET g_errparam.replace[2] = l_deck027
         LET g_errparam.replace[3] = l_deck028
         LET g_errparam.code = 'ade-00122'
         LET g_errparam.popup = TRUE
         CALL cl_err()
      END FOREACH

      #塞資料
      INSERT INTO deck_t ( deckent, decksite,deck001, deck005, deck006,
                           deck007, deck008, deck009, deck010, deck011,
                           deck012, deck013, deck014, deck015, deck016,
                           deck017, deck018, deck019, deck020, deck021,
                           deck022, deck023, deck024, deck025, deck026,
                           deck027, deck028)
      SELECT a.deckent, a.decksite, a.deck001, a.deck005, a.deck006,
             a.deck007, a.deck008,  a.deck009, a.deck010, a.deck011,
             a.deck012, a.deck013,  a.deck014, a.deck015, a.deck016,
             a.deck017, a.deck018,  a.deck019, a.deck020, a.deck021,
             a.deck022, a.deck023,  a.deck024, a.deck025, a.deck026,
             a.deck027, a.deck028
        FROM adep150_deck_temp a
       WHERE NOT EXISTS (SELECT 1 FROM deck_t b
                          WHERE b.deckent  = a.deckent
                            AND b.decksite = a.decksite
                            AND b.deck027  = a.deck027 
                            AND b.deck028  = a.deck028 ) 

      IF SQLCA.SQLcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "ins deck_t"
         LET g_errparam.popup = TRUE
         CALL cl_err()
         LET r_success = FALSE
         RETURN r_success
      END IF

      FOREACH adep150_decl_cs1 INTO l_declsite,l_decl023,l_decl024
         INITIALIZE g_errparam TO NULL
         LET g_errparam.replace[1] = l_declsite
         LET g_errparam.replace[2] = l_decl023
         LET g_errparam.replace[3] = l_decl024
         LET g_errparam.code = 'ade-00122'
         LET g_errparam.popup = TRUE
         CALL cl_err()
      END FOREACH


      INSERT INTO decl_t ( declent,  declsite, decl001, decl005, decl006,
                           decl007,  decl008,  decl009, decl010, decl011,
                           decl012,  decl013,  decl014, decl015, decl016,
                           decl017,  decl018,  decl019, decl020, decl021,   
                           decl022,  decl023,  decl024)
      SELECT a.declent,  a.declsite, a.decl001, a.decl005, a.decl006,
             a.decl007,  a.decl008,  a.decl009, a.decl010, a.decl011,
             a.decl012,  a.decl013,  a.decl014, a.decl015, a.decl016,
             a.decl017,  a.decl018,  a.decl019, a.decl020, a.decl021,   
             a.decl022,  a.decl023,  a.decl024
        FROM adep150_decl_temp a 
       WHERE NOT EXISTS (SELECT 1 FROM decl_t b
                          WHERE a.declent  = b.declent    
                            AND a.declsite = b.declsite   
                            AND a.decl023  = b.decl023    
                            AND a.decl024  = b.decl024)  
      IF SQLCA.SQLcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "ins decl_t"
         LET g_errparam.popup = TRUE
         CALL cl_err()
         LET r_success = FALSE
         RETURN r_success
      END IF

      FOREACH adep150_decm_cs1 INTO l_decmsite,l_decm012,l_decm013
         INITIALIZE g_errparam TO NULL
         LET g_errparam.replace[1] = l_decmsite
         LET g_errparam.replace[2] = l_decm012
         LET g_errparam.replace[3] = l_decm013
         LET g_errparam.code = 'ade-00122'
         LET g_errparam.popup = TRUE
         CALL cl_err()
      END FOREACH

      #塞資料                  
      INSERT INTO decm_t ( decment,  decmsite, decm001, decm005, decm006,
                           decm007,  decm008,  decm009, decm010, decm011,
                           decm012,  decm013)
      SELECT decment,  decmsite, decm001, decm005, decm006,
             decm007,  decm008,  decm009, decm010, decm011,
             decm012,  decm013
        FROM adep150_decm_temp
       WHERE NOT EXISTS (SELECT 1 FROM decm_t b
                          WHERE a.decment  = b.decment    
                            AND a.decmsite = b.decmsite   
                            AND a.decm012  = b.decm012    
                            AND a.decm013  = b.decm013)  

      IF SQLCA.SQLcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "ins decm_t"
         LET g_errparam.popup = TRUE
         CALL cl_err()
         LET r_success = FALSE
         RETURN r_success
      END IF

   END IF  
   
   RETURN r_success
END FUNCTION]]>
  </point>
  <point name="function.adep150_process6" order="5" ver="1" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#門店部門週結
PRIVATE FUNCTION adep150_process6(p_del)
   DEFINE p_del               LIKE type_t.chr1
   DEFINE r_success           LIKE type_t.num5
   DEFINE l_decnsite          LIKE decn_t.decnsite
   DEFINE l_decn024           LIKE decn_t.decn024
   DEFINE l_decn025           LIKE decn_t.decn025
   DEFINE l_decosite          LIKE deco_t.decosite
   DEFINE l_deco021           LIKE deco_t.deco021
   DEFINE l_deco022           LIKE deco_t.deco022
   DEFINE l_decpsite          LIKE decp_t.decpsite
   DEFINE l_decp009           LIKE decp_t.decp009
   DEFINE l_decp010           LIKE decp_t.decp010
   
   LET r_success = TRUE  
   
   #decn_t已結轉資料 
   DECLARE adep150_decn_cs1 CURSOR FOR
    SELECT DISTINCT a.decnsite,a.decn024,a.decn025
      FROM adep150_decn_temp a
     WHERE EXISTS (SELECT 1 FROM decn_t b
             WHERE b.decnent  = a.decnent
               AND b.decnsite = a.decnsite
               AND b.decn024  = a.decn024 
               AND b.decn025  = a.decn025 ) 

   #deco_t已結轉資料
   DECLARE adep150_deco_cs1 CURSOR FOR
    SELECT DISTINCT a.decosite,a.deco021,a.deco022
      FROM adep150_deco_temp a
     WHERE EXISTS (SELECT 1 FROM deco_t b
                    WHERE a.decoent  = b.decoent    
                      AND a.decosite = b.decosite   
                      AND a.deco021  = b.deco021    
                      AND a.deco022  = b.deco022)  
       AND NOT EXISTS (SELECT 1 FROM adep150_decn_temp c 
                        WHERE a.decoent  = c.decnent
                          AND a.decosite = c.decnsite
                          AND a.deco021  = c.decn024 
                          AND a.deco022  = c.decn025 )

   #decp_t已結轉資料
   DECLARE adep150_decp_cs1 CURSOR FOR
    SELECT DISTINCT a.decpsite,a.decp009,a.decp010
      FROM adep150_decp_temp a
     WHERE EXISTS (SELECT 1 FROM decp_t b
                    WHERE a.decpent  = b.decpent    
                      AND a.decpsite = b.decpsite   
                      AND a.decp009  = b.decp009    
                      AND a.decp010  = b.decp010)  
       AND NOT EXISTS (SELECT 1 FROM adep150_decn_temp c 
                        WHERE a.decpent  = c.decnent
                          AND a.decpsite = c.decnsite
                          AND a.decp009  = c.decn024 
                          AND a.decp010  = c.decn025 )

   IF p_del = "Y" THEN

      FOREACH adep150_decn_cs1 INTO l_decnsite,l_decn024,l_decn025
         INITIALIZE g_errparam TO NULL
         LET g_errparam.replace[1] = l_decnsite
         LET g_errparam.replace[2] = l_decn024
         LET g_errparam.replace[3] = l_decn025
         LET g_errparam.code = 'ade-00121'
         LET g_errparam.popup = TRUE
         CALL cl_err()
      END FOREACH

      #刪除已結轉資料
      LET g_sql = "DELETE FROM decn_t a ",
                  " WHERE EXISTS (SELECT 1 FROM adep150_decn_temp b ",
                  "         WHERE a.decnent  = b.decnent ",
                  "           AND a.decnsite = b.decnsite",
                  "           AND a.decn024  = b.decn024 ", 
                  "           AND a.decn025  = b.decn025 )" 
      PREPARE adep150_del_decn_prep1 FROM g_sql
      EXECUTE adep150_del_decn_prep1

      #塞資料                  
      INSERT INTO decn_t ( decnent, decnsite,decn001, decn005, decn006,
                           decn007, decn008, decn009, decn010, decn011,
                           decn012, decn013, decn014, decn015, decn016,
                           decn017, decn018, decn019, decn020, decn021,
                           decn022, decn023, decn024, decn025)
      SELECT decnent, decnsite,decn001, decn005, decn006,
             decn007, decn008, decn009, decn010, decn011,
             decn012, decn013, decn014, decn015, decn016,
             decn017, decn018, decn019, decn020, decn021,
             decn022, decn023, decn024, decn025
        FROM adep150_decn_temp

      IF SQLCA.SQLcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "ins decn_t"
         LET g_errparam.popup = TRUE
         CALL cl_err()
         LET r_success = FALSE
         RETURN r_success
      END IF

      FOREACH adep150_deco_cs1 INTO l_decosite,l_deco021,l_deco022
         INITIALIZE g_errparam TO NULL
         LET g_errparam.replace[1] = l_decosite
         LET g_errparam.replace[2] = l_deco021
         LET g_errparam.replace[3] = l_deco022
         LET g_errparam.code = 'ade-00121'
         LET g_errparam.popup = TRUE
         CALL cl_err()
      END FOREACH

      #刪除已結轉資料
      LET g_sql = "DELETE FROM deco_t a ",
                  " WHERE EXISTS (SELECT 1 FROM adep150_deco_temp b ",
                  "                WHERE b.decoent  = a.decoent ",
                  "                  AND b.decosite = a.decosite",
                  "                  AND b.deco021  = a.deco021 ",
                  "                  AND b.deco022  = a.deco022)"
      PREPARE adep150_del_deco_prep1 FROM g_sql
      EXECUTE adep150_del_deco_prep1

      #塞資料                  
      INSERT INTO deco_t ( decoent,  decosite, deco001, deco005, deco006,
                           deco007,  deco008,  deco009, deco010, deco011,
                           deco012,  deco013,  deco014, deco015, deco016,
                           deco017,  deco018,  deco019, deco020, deco021,   
                           deco022)
      SELECT decoent,  decosite, deco001, deco005, deco006,
             deco007,  deco008,  deco009, deco010, deco011,
             deco012,  deco013,  deco014, deco015, deco016,
             deco017,  deco018,  deco019, deco020, deco021,   
             deco022
        FROM adep150_deco_temp

      IF SQLCA.SQLcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "ins deco_t"
         LET g_errparam.popup = TRUE
         CALL cl_err()
         LET r_success = FALSE
         RETURN r_success
      END IF

      FOREACH adep150_decp_cs1 INTO l_decpsite,l_decp009,l_decp010
         INITIALIZE g_errparam TO NULL
         LET g_errparam.replace[1] = l_decpsite
         LET g_errparam.replace[2] = l_decp009
         LET g_errparam.replace[3] = l_decp010
         LET g_errparam.code = 'ade-00121'
         LET g_errparam.popup = TRUE
         CALL cl_err()
      END FOREACH

      #刪除已結轉資料
      LET g_sql = "DELETE FROM decp_t a ",
                  " WHERE EXISTS (SELECT 1 FROM adep150_decp_temp b ",
                  "                WHERE b.decpent  = a.decpent ",
                  "                  AND b.decpsite = a.decpsite",
                  "                  AND b.decp009  = a.decp009 ",
                  "                  AND b.decp010  = a.decp010)"
      PREPARE adep150_del_decp_prep1 FROM g_sql
      EXECUTE adep150_del_decp_prep1

      #塞資料                  
      INSERT INTO decp_t ( decpent,  decpsite, decp001, decp005, decp006,
                           decp007,  decp008,  decp009, decp010)
      SELECT decpent,  decpsite, decp001, decp005, decp006,
             decp007,  decp008,  decp009, decp010
        FROM adep150_decp_temp

      IF SQLCA.SQLcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "ins decp_t"
         LET g_errparam.popup = TRUE
         CALL cl_err()
         LET r_success = FALSE
         RETURN r_success
      END IF
   ELSE
      FOREACH adep150_decn_cs1 INTO l_decnsite,l_decn024,l_decn025
         INITIALIZE g_errparam TO NULL
         LET g_errparam.replace[1] = l_decnsite
         LET g_errparam.replace[2] = l_decn024
         LET g_errparam.replace[3] = l_decn025
         LET g_errparam.code = 'ade-00122'
         LET g_errparam.popup = TRUE
         CALL cl_err()
      END FOREACH

      #塞資料
      INSERT INTO decn_t ( decnent, decnsite,decn001, decn005, decn006,
                           decn007, decn008, decn009, decn010, decn011,
                           decn012, decn013, decn014, decn015, decn016,
                           decn017, decn018, decn019, decn020, decn021,
                           decn022, decn023, decn024, decn025)
      SELECT a.decnent, a.decnsite, a.decn001, a.decn005, a.decn006,
             a.decn007, a.decn008,  a.decn009, a.decn010, a.decn011,
             a.decn012, a.decn013,  a.decn014, a.decn015, a.decn016,
             a.decn017, a.decn018,  a.decn019, a.decn020, a.decn021,
             a.decn022, a.decn023,  a.decn024, a.decn025
        FROM adep150_decn_temp a
       WHERE NOT EXISTS (SELECT 1 FROM decn_t b
                          WHERE b.decnent  = a.decnent
                            AND b.decnsite = a.decnsite
                            AND b.decn024  = a.decn024 
                            AND b.decn025  = a.decn025 ) 

      IF SQLCA.SQLcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "ins decn_t"
         LET g_errparam.popup = TRUE
         CALL cl_err()
         LET r_success = FALSE
         RETURN r_success
      END IF

      FOREACH adep150_deco_cs1 INTO l_decosite,l_deco021,l_deco022
         INITIALIZE g_errparam TO NULL
         LET g_errparam.replace[1] = l_decosite
         LET g_errparam.replace[2] = l_deco021
         LET g_errparam.replace[3] = l_deco022
         LET g_errparam.code = 'ade-00122'
         LET g_errparam.popup = TRUE
         CALL cl_err()
      END FOREACH


      INSERT INTO deco_t ( decoent,  decosite, deco001, deco005, deco006,
                           deco007,  deco008,  deco009, deco010, deco011,
                           deco012,  deco013,  deco014, deco015, deco016,
                           deco017,  deco018,  deco019, deco020, deco021,   
                           deco022)
      SELECT a.decoent,  a.decosite, a.deco001, a.deco005, a.deco006,
             a.deco007,  a.deco008,  a.deco009, a.deco010, a.deco011,
             a.deco012,  a.deco013,  a.deco014, a.deco015, a.deco016,
             a.deco017,  a.deco018,  a.deco019, a.deco020, a.deco021,   
             a.deco022
        FROM adep150_deco_temp a 
       WHERE NOT EXISTS (SELECT 1 FROM deco_t b
                          WHERE a.decoent  = b.decoent    
                            AND a.decosite = b.decosite   
                            AND a.deco021  = b.deco021    
                            AND a.deco022  = b.deco022)  
      IF SQLCA.SQLcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "ins deco_t"
         LET g_errparam.popup = TRUE
         CALL cl_err()
         LET r_success = FALSE
         RETURN r_success
      END IF

      FOREACH adep150_decp_cs1 INTO l_decpsite,l_decp009,l_decp010
         INITIALIZE g_errparam TO NULL
         LET g_errparam.replace[1] = l_decpsite
         LET g_errparam.replace[2] = l_decp009
         LET g_errparam.replace[3] = l_decp010
         LET g_errparam.code = 'ade-00122'
         LET g_errparam.popup = TRUE
         CALL cl_err()
      END FOREACH

      #塞資料                  
      INSERT INTO decp_t ( decpent,  decpsite, decp001, decp005, decp006,
                           decp007,  decp008,  decp009, decp010)
      SELECT decpent,  decpsite, decp001, decp005, decp006,
             decp007,  decp008,  decp009, decp010
        FROM adep150_decp_temp
       WHERE NOT EXISTS (SELECT 1 FROM decp_t b
                          WHERE a.decpent  = b.decpent    
                            AND a.decpsite = b.decpsite   
                            AND a.decp009  = b.decp009    
                            AND a.decp010  = b.decp010)  

      IF SQLCA.SQLcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "ins decp_t"
         LET g_errparam.popup = TRUE
         CALL cl_err()
         LET r_success = FALSE
         RETURN r_success
      END IF

   END IF  
   
   RETURN r_success
END FUNCTION]]>
  </point>
  <point name="function.adep150_process7" order="6" ver="1" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#門店週結
PRIVATE FUNCTION adep150_process7(p_del)
   DEFINE p_del               LIKE type_t.chr1
   DEFINE r_success           LIKE type_t.num5
   DEFINE l_decqsite          LIKE decq_t.decqsite
   DEFINE l_decq025           LIKE decq_t.decq025
   DEFINE l_decq026           LIKE decq_t.decq026
   DEFINE l_decrsite          LIKE decr_t.decrsite
   DEFINE l_decr020           LIKE decr_t.decr020
   DEFINE l_decr021           LIKE decr_t.decr021
   DEFINE l_decssite          LIKE decs_t.decssite
   DEFINE l_decs008           LIKE decs_t.decs008
   DEFINE l_decs009           LIKE decs_t.decs009
   
   LET r_success = TRUE  
   
   #decq_t已結轉資料 
   DECLARE adep150_decq_cs1 CURSOR FOR
    SELECT DISTINCT a.decqsite,a.decq025,a.decq026
      FROM adep150_decq_temp a
     WHERE EXISTS (SELECT 1 FROM decq_t b
             WHERE b.decqent  = a.decqent
               AND b.decqsite = a.decqsite
               AND b.decq025  = a.decq025 
               AND b.decq026  = a.decq026 ) 

   #decr_t已結轉資料
   DECLARE adep150_decr_cs1 CURSOR FOR
    SELECT DISTINCT a.decrsite,a.decr020,a.decr021
      FROM adep150_decr_temp a
     WHERE EXISTS (SELECT 1 FROM decr_t b
                    WHERE a.decrent  = b.decrent    
                      AND a.decrsite = b.decrsite   
                      AND a.decr020  = b.decr020    
                      AND a.decr021  = b.decr021)  
       AND NOT EXISTS (SELECT 1 FROM adep150_decq_temp c 
                        WHERE a.decrent  = c.decqent
                          AND a.decrsite = c.decqsite
                          AND a.decr020  = c.decq025 
                          AND a.decr021  = c.decq026 )

   #decs_t已結轉資料
   DECLARE adep150_decs_cs1 CURSOR FOR
    SELECT DISTINCT a.decssite,a.decs008,a.decs009
      FROM adep150_decs_temp a
     WHERE EXISTS (SELECT 1 FROM decs_t b
                    WHERE a.decsent  = b.decsent    
                      AND a.decssite = b.decssite   
                      AND a.decs008  = b.decs008    
                      AND a.decs009  = b.decs009)  
       AND NOT EXISTS (SELECT 1 FROM adep150_decq_temp c 
                        WHERE a.decsent  = c.decqent
                          AND a.decssite = c.decqsite
                          AND a.decs008  = c.decq025 
                          AND a.decs009  = c.decq026 )

   IF p_del = "Y" THEN

      FOREACH adep150_decq_cs1 INTO l_decqsite,l_decq025,l_decq026
         INITIALIZE g_errparam TO NULL
         LET g_errparam.replace[1] = l_decqsite
         LET g_errparam.replace[2] = l_decq025
         LET g_errparam.replace[3] = l_decq026
         LET g_errparam.code = 'ade-00121'
         LET g_errparam.popup = TRUE
         CALL cl_err()
      END FOREACH

      #刪除已結轉資料
      LET g_sql = "DELETE FROM decq_t a ",
                  " WHERE EXISTS (SELECT 1 FROM adep150_decq_temp b ",
                  "         WHERE a.decqent  = b.decqent ",
                  "           AND a.decqsite = b.decqsite",
                  "           AND a.decq025  = b.decq025 ", 
                  "           AND a.decq026  = b.decq026 )" 
      PREPARE adep150_del_decq_prep1 FROM g_sql
      EXECUTE adep150_del_decq_prep1

      #塞資料                  
      INSERT INTO decq_t ( decqent, decqsite,decq001, decq005, decq006,
                           decq007, decq008, decq009, decq010, decq011,
                           decq012, decq013, decq014, decq015, decq016,
                           decq017, decq018, decq019, decq020, decq023, 
                           decq024, decq025, decq026, decq027)
      SELECT decqent, decqsite,decq001, decq005, decq006,
             decq007, decq008, decq009, decq010, decq011,
             decq012, decq013, decq014, decq015, decq016,
             decq017, decq018, decq019, decq020, decq023, 
             decq024, decq025, decq026, decq027
        FROM adep150_decq_temp

      IF SQLCA.SQLcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "ins decq_t"
         LET g_errparam.popup = TRUE
         CALL cl_err()
         LET r_success = FALSE
         RETURN r_success
      END IF

      FOREACH adep150_decr_cs1 INTO l_decrsite,l_decr020,l_decr021
         INITIALIZE g_errparam TO NULL
         LET g_errparam.replace[1] = l_decrsite
         LET g_errparam.replace[2] = l_decr020
         LET g_errparam.replace[3] = l_decr021
         LET g_errparam.code = 'ade-00121'
         LET g_errparam.popup = TRUE
         CALL cl_err()
      END FOREACH

      #刪除已結轉資料
      LET g_sql = "DELETE FROM decr_t a ",
                  " WHERE EXISTS (SELECT 1 FROM adep150_decr_temp b ",
                  "                WHERE b.decrent  = a.decrent ",
                  "                  AND b.decrsite = a.decrsite",
                  "                  AND b.decr020  = a.decr020 ",
                  "                  AND b.decr021  = a.decr021)"
      PREPARE adep150_del_decr_prep1 FROM g_sql
      EXECUTE adep150_del_decr_prep1

      #塞資料                  
      INSERT INTO decr_t ( decrent,  decrsite, decr001, decr005, decr006,
                           decr007,  decr008,  decr009, decr010, decr011,
                           decr012,  decr013,  decr014, decr015, decr016,
                           decr017,  decr018,  decr019, decr020, decr021,
                           decr022)   
      SELECT decrent,  decrsite, decr001, decr005, decr006,
             decr007,  decr008,  decr009, decr010, decr011,
             decr012,  decr013,  decr014, decr015, decr016,
             decr017,  decr018,  decr019, decr020, decr021,
             decr022             
        FROM adep150_decr_temp

      IF SQLCA.SQLcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "ins decr_t"
         LET g_errparam.popup = TRUE
         CALL cl_err()
         LET r_success = FALSE
         RETURN r_success
      END IF

      FOREACH adep150_decs_cs1 INTO l_decssite,l_decs008,l_decs009
         INITIALIZE g_errparam TO NULL
         LET g_errparam.replace[1] = l_decssite
         LET g_errparam.replace[2] = l_decs008
         LET g_errparam.replace[3] = l_decs009
         LET g_errparam.code = 'ade-00121'
         LET g_errparam.popup = TRUE
         CALL cl_err()
      END FOREACH

      #刪除已結轉資料
      LET g_sql = "DELETE FROM decs_t a ",
                  " WHERE EXISTS (SELECT 1 FROM adep150_decs_temp b ",
                  "                WHERE b.decsent  = a.decsent ",
                  "                  AND b.decssite = a.decssite",
                  "                  AND b.decs008  = a.decs008 ",
                  "                  AND b.decs009  = a.decs009)"
      PREPARE adep150_del_decs_prep1 FROM g_sql
      EXECUTE adep150_del_decs_prep1

      #塞資料                  
      INSERT INTO decs_t ( decsent,  decssite, decs001, decs005, decs006,
                           decs007,  decs008,  decs009)
      SELECT decsent,  decssite, decs001, decs005, decs006,
             decs007,  decs008,  decs009
        FROM adep150_decs_temp

      IF SQLCA.SQLcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "ins decs_t"
         LET g_errparam.popup = TRUE
         CALL cl_err()
         LET r_success = FALSE
         RETURN r_success
      END IF
   ELSE
      FOREACH adep150_decq_cs1 INTO l_decqsite,l_decq025,l_decq026
         INITIALIZE g_errparam TO NULL
         LET g_errparam.replace[1] = l_decqsite
         LET g_errparam.replace[2] = l_decq025
         LET g_errparam.replace[3] = l_decq026
         LET g_errparam.code = 'ade-00122'
         LET g_errparam.popup = TRUE
         CALL cl_err()
      END FOREACH

      #塞資料
      INSERT INTO decq_t ( decqent, decqsite,decq001, decq005, decq006,
                           decq007, decq008, decq009, decq010, decq011,
                           decq012, decq013, decq014, decq015, decq016,
                           decq017, decq018, decq019, decq020, decq023,
                           decq024, decq025, decq026, decq027)
      SELECT a.decqent, a.decqsite, a.decq001, a.decq005, a.decq006,
             a.decq007, a.decq008,  a.decq009, a.decq010, a.decq011,
             a.decq012, a.decq013,  a.decq014, a.decq015, a.decq016,
             a.decq017, a.decq018,  a.decq019, a.decq020, a.decq023,
             a.decq024, a.decq025,  a.decq026, a.decq027
        FROM adep150_decq_temp a
       WHERE NOT EXISTS (SELECT 1 FROM decq_t b
                          WHERE b.decqent  = a.decqent
                            AND b.decqsite = a.decqsite
                            AND b.decq025  = a.decq025 
                            AND b.decq026  = a.decq026 ) 

      IF SQLCA.SQLcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "ins decq_t"
         LET g_errparam.popup = TRUE
         CALL cl_err()
         LET r_success = FALSE
         RETURN r_success
      END IF

      FOREACH adep150_decr_cs1 INTO l_decrsite,l_decr020,l_decr021
         INITIALIZE g_errparam TO NULL
         LET g_errparam.replace[1] = l_decrsite
         LET g_errparam.replace[2] = l_decr020
         LET g_errparam.replace[3] = l_decr021
         LET g_errparam.code = 'ade-00122'
         LET g_errparam.popup = TRUE
         CALL cl_err()
      END FOREACH


      INSERT INTO decr_t ( decrent,  decrsite, decr001, decr005, decr006,
                           decr007,  decr008,  decr009, decr010, decr011,
                           decr012,  decr013,  decr014, decr015, decr016,
                           decr017,  decr018,  decr019, decr020, decr021,
                           decr022 )   
      SELECT a.decrent,  a.decrsite, a.decr001, a.decr005, a.decr006,
             a.decr007,  a.decr008,  a.decr009, a.decr010, a.decr011,
             a.decr012,  a.decr013,  a.decr014, a.decr015, a.decr016,
             a.decr017,  a.decr018,  a.decr019, a.decr020, a.decr021,
             a.decr022
        FROM adep150_decr_temp a 
       WHERE NOT EXISTS (SELECT 1 FROM decr_t b
                          WHERE a.decrent  = b.decrent    
                            AND a.decrsite = b.decrsite   
                            AND a.decr020  = b.decr020    
                            AND a.decr021  = b.decr021)  
      IF SQLCA.SQLcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "ins decr_t"
         LET g_errparam.popup = TRUE
         CALL cl_err()
         LET r_success = FALSE
         RETURN r_success
      END IF

      FOREACH adep150_decs_cs1 INTO l_decssite,l_decs008,l_decs009
         INITIALIZE g_errparam TO NULL
         LET g_errparam.replace[1] = l_decssite
         LET g_errparam.replace[2] = l_decs008
         LET g_errparam.replace[3] = l_decs009
         LET g_errparam.code = 'ade-00122'
         LET g_errparam.popup = TRUE
         CALL cl_err()
      END FOREACH

      #塞資料                  
      INSERT INTO decs_t ( decsent,  decssite, decs001, decs005, decs006,
                           decs007,  decs008,  decs009)
      SELECT decsent,  decssite, decs001, decs005, decs006,
             decs007,  decs008,  decs009
        FROM adep150_decs_temp
       WHERE NOT EXISTS (SELECT 1 FROM decs_t b
                          WHERE a.decsent  = b.decsent    
                            AND a.decssite = b.decssite   
                            AND a.decs008  = b.decs008    
                            AND a.decs009  = b.decs009)  

      IF SQLCA.SQLcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "ins decs_t"
         LET g_errparam.popup = TRUE
         CALL cl_err()
         LET r_success = FALSE
         RETURN r_success
      END IF

   END IF  
   
   RETURN r_success
   
END FUNCTION]]>
  </point>
  <point name="function.adep150_process9" order="7" ver="1" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#收入收款週結
PRIVATE FUNCTION adep150_process9(p_del)
   DEFINE p_del               LIKE type_t.chr1
   DEFINE r_success           LIKE type_t.num5
   DEFINE l_decvsite          LIKE decv_t.decvsite
   DEFINE l_decv019           LIKE decv_t.decv019
   DEFINE l_decv020           LIKE decv_t.decv020
   DEFINE l_decwsite          LIKE decw_t.decwsite
   DEFINE l_decw019           LIKE decw_t.decw019
   DEFINE l_decw020           LIKE decw_t.decw020
   
   LET r_success = TRUE  
   
   #decv_t已結轉資料 
   DECLARE adep150_decv_cs1 CURSOR FOR
    SELECT DISTINCT a.decvsite,a.decv019,a.decv020
      FROM adep150_decv_temp a
     WHERE EXISTS (SELECT 1 FROM decv_t b
             WHERE b.decvent  = a.decvent
               AND b.decvsite = a.decvsite
               AND b.decv019  = a.decv019 
               AND b.decv020  = a.decv020 ) 

   #decw_t已結轉資料
   DECLARE adep150_decw_cs1 CURSOR FOR
    SELECT DISTINCT a.decwsite,a.decw019,a.decw020
      FROM adep150_decw_temp a
     WHERE EXISTS (SELECT 1 FROM decw_t b
                    WHERE a.decwent  = b.decwent    
                      AND a.decwsite = b.decwsite   
                      AND a.decw019  = b.decw019    
                      AND a.decw020  = b.decw020)  
       AND NOT EXISTS (SELECT 1 FROM adep150_decv_temp c 
                        WHERE a.decwent  = c.decvent
                          AND a.decwsite = c.decvsite
                          AND a.decw019  = c.decv019 
                          AND a.decw020  = c.decv020 )

   IF p_del = "Y" THEN

      FOREACH adep150_decv_cs1 INTO l_decvsite,l_decv019,l_decv020
         INITIALIZE g_errparam TO NULL
         LET g_errparam.replace[1] = l_decvsite
         LET g_errparam.replace[2] = l_decv019
         LET g_errparam.replace[3] = l_decv020
         LET g_errparam.code = 'ade-00121'
         LET g_errparam.popup = TRUE
         CALL cl_err()
      END FOREACH

      #刪除已結轉資料
      LET g_sql = "DELETE FROM decv_t a ",
                  " WHERE EXISTS (SELECT 1 FROM adep150_decv_temp b ",
                  "         WHERE a.decvent  = b.decvent ",
                  "           AND a.decvsite = b.decvsite",
                  "           AND a.decv019  = b.decv019 ", 
                  "           AND a.decv020  = b.decv020 )" 
      PREPARE adep150_del_decv_prep1 FROM g_sql
      EXECUTE adep150_del_decv_prep1

      #塞資料                  
      INSERT INTO decv_t ( decvent, decvsite,decv001, decv002, decv004,
                           decv005, decv006, decv007, decv008, decv009,
                           decv010, decv011, decv012, decv013, decv014,
                           decv015, decv016, decv017, decv018, decv019,
                           decv020)
      SELECT decvent, decvsite,decv001, decv002, decv004,
             decv005, decv006, decv007, decv008, decv009, 
             decv010, decv011, decv012, decv013, decv014,
             decv015, decv016, decv017, decv018, decv019,
             decv020
        FROM adep150_decv_temp

      IF SQLCA.SQLcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "ins decv_t"
         LET g_errparam.popup = TRUE
         CALL cl_err()
         LET r_success = FALSE
         RETURN r_success
      END IF

      FOREACH adep150_decw_cs1 INTO l_decwsite,l_decw019,l_decw020
         INITIALIZE g_errparam TO NULL
         LET g_errparam.replace[1] = l_decwsite
         LET g_errparam.replace[2] = l_decw019
         LET g_errparam.replace[3] = l_decw020
         LET g_errparam.code = 'ade-00121'
         LET g_errparam.popup = TRUE
         CALL cl_err()
      END FOREACH

      #刪除已結轉資料
      LET g_sql = "DELETE FROM decw_t a ",
                  " WHERE EXISTS (SELECT 1 FROM adep150_decw_temp b ",
                  "                WHERE b.decwent  = a.decwent ",
                  "                  AND b.decwsite = a.decwsite",
                  "                  AND b.decw019  = a.decw019 ",
                  "                  AND b.decw020  = a.decw020)"
      PREPARE adep150_del_decw_prep1 FROM g_sql
      EXECUTE adep150_del_decw_prep1

      #塞資料                  
      INSERT INTO decw_t ( decwent,  decwsite, decw001, decw005, decw006,
                           decw007,  decw008,  decw009, decw010, decw011,
                           decw012,  decw013,  decw014, decw015, decw016,
                           decw017,  decw018,  decw019, decw020)
      SELECT decwent,  decwsite, decw001, decw005, decw006,
             decw007,  decw008,  decw009, decw010, decw011,
             decw012,  decw013,  decw014, decw015, decw016,
             decw017,  decw018,  decw019, decw020
        FROM adep150_decw_temp

      IF SQLCA.SQLcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "ins decw_t"
         LET g_errparam.popup = TRUE
         CALL cl_err()
         LET r_success = FALSE
         RETURN r_success
      END IF
   ELSE
      FOREACH adep150_decv_cs1 INTO l_decvsite,l_decv019,l_decv020
         INITIALIZE g_errparam TO NULL
         LET g_errparam.replace[1] = l_decvsite
         LET g_errparam.replace[2] = l_decv019
         LET g_errparam.replace[3] = l_decv020
         LET g_errparam.code = 'ade-00122'
         LET g_errparam.popup = TRUE
         CALL cl_err()
      END FOREACH

      #塞資料
      INSERT INTO decv_t ( decvent, decvsite,decv001, decv002, decv004,
                           decv005, decv006, decv007, decv008, decv009,
                           decv010, decv011, decv012, decv013, decv014,
                           decv015, decv016, decv017, decv018, decv019,
                           decv020)
      SELECT a.decvent, a.decvsite, a.decv001, a.decv002, a.decv004,
             a.decv005, a.decv006,  a.decv007, a.decv008, a.decv009,
             a.decv010, a.decv011,  a.decv012, a.decv013, a.decv014,
             a.decv015, a.decv016,  a.decv017, a.decv018, a.decv019,
             a.decv020
        FROM adep150_decv_temp a
       WHERE NOT EXISTS (SELECT 1 FROM decv_t b
                          WHERE b.decvent  = a.decvent
                            AND b.decvsite = a.decvsite
                            AND b.decv019  = a.decv019 
                            AND b.decv020  = a.decv020 ) 

      IF SQLCA.SQLcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "ins decv_t"
         LET g_errparam.popup = TRUE
         CALL cl_err()
         LET r_success = FALSE
         RETURN r_success
      END IF

      FOREACH adep150_decw_cs1 INTO l_decwsite,l_decw019,l_decw020
         INITIALIZE g_errparam TO NULL
         LET g_errparam.replace[1] = l_decwsite
         LET g_errparam.replace[2] = l_decw019
         LET g_errparam.replace[3] = l_decw020
         LET g_errparam.code = 'ade-00122'
         LET g_errparam.popup = TRUE
         CALL cl_err()
      END FOREACH


      INSERT INTO decw_t ( decwent,  decwsite, decw001, decw005, decw006,
                           decw007,  decw008,  decw009, decw010, decw011,
                           decw012,  decw013,  decw014, decw015, decw016,
                           decw017,  decw018,  decw019, decw020)
      SELECT a.decwent,  a.decwsite, a.decw001, a.decw005, a.decw006,
             a.decw007,  a.decw008,  a.decw009, a.decw010, a.decw011,
             a.decw012,  a.decw013,  a.decw014, a.decw015, a.decw016,
             a.decw017,  a.decw018,  a.decw019, a.decw020
        FROM adep150_decw_temp a 
       WHERE NOT EXISTS (SELECT 1 FROM decw_t b
                          WHERE a.decwent  = b.decwent    
                            AND a.decwsite = b.decwsite   
                            AND a.decw019  = b.decw019    
                            AND a.decw020  = b.decw020)  
      IF SQLCA.SQLcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "ins decw_t"
         LET g_errparam.popup = TRUE
         CALL cl_err()
         LET r_success = FALSE
         RETURN r_success
      END IF

   END IF  
   
   RETURN r_success
END FUNCTION]]>
  </point>
  <point name="function.adep150_create_temp0" order="8" ver="1" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adep150_create_temp0()
   DEFINE r_success         LIKE type_t.num5

   WHENEVER ERROR CONTINUE

   LET r_success = TRUE

   IF NOT adep150_drop_temp0() THEN
      LET r_success = FALSE
      RETURN r_success
   END IF

   CREATE TEMP TABLE adep150_decf_temp(
      decfent        LIKE decf_t.decfent,  
      decfsite       LIKE decf_t.decfsite,  
      decf001        LIKE decf_t.decf001,  
      decf005        LIKE decf_t.decf005,  
      decf006        LIKE decf_t.decf006,  
      decf007        LIKE decf_t.decf007,  
      decf008        LIKE decf_t.decf008,  
      decf009        LIKE decf_t.decf009,  
      decf010        LIKE decf_t.decf010,  
      decf011        LIKE decf_t.decf011,  
      decf012        LIKE decf_t.decf012,  
      decf013        LIKE decf_t.decf013,  
      decf014        LIKE decf_t.decf014,  
      decf015        LIKE decf_t.decf015,  
      decf016        LIKE decf_t.decf016,  
      decf017        LIKE decf_t.decf017,  
      decf018        LIKE decf_t.decf018,  
      decf019        LIKE decf_t.decf019,  
      decf020        LIKE decf_t.decf020,  
      decf021        LIKE decf_t.decf021,  
      decf022        LIKE decf_t.decf022,  
      decf023        LIKE decf_t.decf023,  
      decf024        LIKE decf_t.decf024,  
      decf025        LIKE decf_t.decf025,  
      decf026        LIKE decf_t.decf026,  
      decf027        LIKE decf_t.decf027,  
      decf028        LIKE decf_t.decf028,  
      decf029        LIKE decf_t.decf029,  
      decf030        LIKE decf_t.decf030,  
      decf031        LIKE decf_t.decf031,  
      decf032        LIKE decf_t.decf032,  
      decf033        LIKE decf_t.decf033,  
      decf034        LIKE decf_t.decf034,  
      decf035        LIKE decf_t.decf035,  
      decf036        LIKE decf_t.decf036,  
      decf037        LIKE decf_t.decf037,  
      decf038        LIKE decf_t.decf038,  
      decf039        LIKE decf_t.decf039,  
      decf040        LIKE decf_t.decf040,  
      decf041        LIKE decf_t.decf041,  
      decf042        LIKE decf_t.decf042,  
      decf043        LIKE decf_t.decf043,  
      decf044        LIKE decf_t.decf044,  
      decf045        LIKE decf_t.decf045,  
      decf046        LIKE decf_t.decf046,  
      decf047        LIKE decf_t.decf047,
      decf048        LIKE decf_t.decf048
     )

   IF SQLCA.sqlcode != 0 THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'create adep150_decf_temp'
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF

   CREATE TEMP TABLE adep150_decg_temp(
      decgent        LIKE decg_t.decgent,  
      decgsite       LIKE decg_t.decgsite,
      decg001        LIKE decg_t.decg001,
      decg005        LIKE decg_t.decg005,
      decg006        LIKE decg_t.decg006,
      decg007        LIKE decg_t.decg007,
      decg008        LIKE decg_t.decg008,
      decg009        LIKE decg_t.decg009,
      decg010        LIKE decg_t.decg010,
      decg011        LIKE decg_t.decg011,
      decg012        LIKE decg_t.decg012,
      decg013        LIKE decg_t.decg013,
      decg014        LIKE decg_t.decg014,
      decg015        LIKE decg_t.decg015,
      decg016        LIKE decg_t.decg016,
      decg017        LIKE decg_t.decg017,
      decg018        LIKE decg_t.decg018,
      decg019        LIKE decg_t.decg019,
      decg020        LIKE decg_t.decg020,
      decg021        LIKE decg_t.decg021,   
      decg022        LIKE decg_t.decg022,
      decg023        LIKE decg_t.decg023,
      decg024        LIKE decg_t.decg024,
      decg025        LIKE decg_t.decg025,
      decg026        LIKE decg_t.decg026,
      decg027        LIKE decg_t.decg027,
      decg028        LIKE decg_t.decg028,
      decg029        LIKE decg_t.decg029,
      decg030        LIKE decg_t.decg030,  
      decg031        LIKE decg_t.decg031,
      decg032        LIKE decg_t.decg032,
      decg033        LIKE decg_t.decg033,
      decg034        LIKE decg_t.decg034,
      decg035        LIKE decg_t.decg035,
      decg036        LIKE decg_t.decg036,
      decg037        LIKE decg_t.decg037,
      decg038        LIKE decg_t.decg038
     )               
                    
   IF SQLCA.sqlcode != 0 THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'create adep150_decg_temp'
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   RETURN r_success 
END FUNCTION]]>
  </point>
  <point name="function.adep150_create_temp1" order="9" ver="1" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adep150_create_temp1()
   DEFINE r_success         LIKE type_t.num5

   WHENEVER ERROR CONTINUE

   LET r_success = TRUE

   IF NOT adep150_drop_temp1() THEN
      LET r_success = FALSE
      RETURN r_success
   END IF

   CREATE TEMP TABLE adep150_dect_temp(
      dectent        LIKE dect_t.dectent,  
      dectsite       LIKE dect_t.dectsite,  
      dect001        LIKE dect_t.dect001,  
      dect005        LIKE dect_t.dect005,  
      dect006        LIKE dect_t.dect006,  
      dect007        LIKE dect_t.dect007,  
      dect008        LIKE dect_t.dect008,  
      dect009        LIKE dect_t.dect009,  
      dect010        LIKE dect_t.dect010,  
      dect011        LIKE dect_t.dect011,  
      dect012        LIKE dect_t.dect012,  
      dect013        LIKE dect_t.dect013,  
      dect014        LIKE dect_t.dect014,  
      dect015        LIKE dect_t.dect015,  
      dect016        LIKE dect_t.dect016,  
      dect017        LIKE dect_t.dect017,  
      dect018        LIKE dect_t.dect018,  
      dect019        LIKE dect_t.dect019,  
      dect020        LIKE dect_t.dect020,  
      dect021        LIKE dect_t.dect021,  
      dect022        LIKE dect_t.dect022,  
      dect023        LIKE dect_t.dect023,  
      dect024        LIKE dect_t.dect024,  
      dect025        LIKE dect_t.dect025,  
      dect026        LIKE dect_t.dect026,  
      dect027        LIKE dect_t.dect027,  
      dect028        LIKE dect_t.dect028,  
      dect029        LIKE dect_t.dect029,  
      dect030        LIKE dect_t.dect030,  
      dect031        LIKE dect_t.dect031,  
      dect032        LIKE dect_t.dect032,  
      dect033        LIKE dect_t.dect033,  
      dect034        LIKE dect_t.dect034,  
      dect035        LIKE dect_t.dect035,
      dect036        LIKE dect_t.dect036,
      dect037        LIKE dect_t.dect037      
     )

   IF SQLCA.sqlcode != 0 THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'create adep150_dect_temp'
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF

   CREATE TEMP TABLE adep150_decu_temp(
      decuent        LIKE decu_t.decuent,  
      decusite       LIKE decu_t.decusite,
      decu001        LIKE decu_t.decu001,
      decu005        LIKE decu_t.decu005,
      decu006        LIKE decu_t.decu006,
      decu007        LIKE decu_t.decu007,
      decu008        LIKE decu_t.decu008,
      decu009        LIKE decu_t.decu009,
      decu010        LIKE decu_t.decu010,
      decu011        LIKE decu_t.decu011,
      decu012        LIKE decu_t.decu012,
      decu013        LIKE decu_t.decu013,
      decu014        LIKE decu_t.decu014,
      decu015        LIKE decu_t.decu015,
      decu016        LIKE decu_t.decu016,
      decu017        LIKE decu_t.decu017,
      decu018        LIKE decu_t.decu018,
      decu019        LIKE decu_t.decu019,
      decu020        LIKE decu_t.decu020,
      decu021        LIKE decu_t.decu021,   
      decu022        LIKE decu_t.decu022,
      decu023        LIKE decu_t.decu023,
      decu024        LIKE decu_t.decu024,
      decu025        LIKE decu_t.decu025,
      decu026        LIKE decu_t.decu026,
      decu027        LIKE decu_t.decu027,
      decu028        LIKE decu_t.decu028
     )               
                    
   IF SQLCA.sqlcode != 0 THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'create adep150_decu_temp'
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   RETURN r_success 
END FUNCTION]]>
  </point>
  <point name="function.adep150_create_temp4" order="10" ver="1" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adep150_create_temp4()
   DEFINE r_success         LIKE type_t.num5

   WHENEVER ERROR CONTINUE

   LET r_success = TRUE

   IF NOT adep150_drop_temp4() THEN
      LET r_success = FALSE
      RETURN r_success
   END IF

   CREATE TEMP TABLE adep150_dech_temp(
      dechent        LIKE dech_t.dechent,  
      dechsite       LIKE dech_t.dechsite,  
      dech001        LIKE dech_t.dech001,  
      dech005        LIKE dech_t.dech005,  
      dech006        LIKE dech_t.dech006,  
      dech007        LIKE dech_t.dech007,  
      dech008        LIKE dech_t.dech008,  
      dech009        LIKE dech_t.dech009,  
      dech010        LIKE dech_t.dech010,  
      dech011        LIKE dech_t.dech011,  
      dech012        LIKE dech_t.dech012,  
      dech013        LIKE dech_t.dech013,  
      dech014        LIKE dech_t.dech014,  
      dech015        LIKE dech_t.dech015,  
      dech016        LIKE dech_t.dech016,  
      dech017        LIKE dech_t.dech017,  
      dech018        LIKE dech_t.dech018,  
      dech019        LIKE dech_t.dech019,  
      dech020        LIKE dech_t.dech020,  
      dech021        LIKE dech_t.dech021,  
      dech022        LIKE dech_t.dech022,  
      dech023        LIKE dech_t.dech023,  
      dech024        LIKE dech_t.dech024,  
      dech025        LIKE dech_t.dech025,  
      dech026        LIKE dech_t.dech026,  
      dech027        LIKE dech_t.dech027,  
      dech028        LIKE dech_t.dech028,  
      dech029        LIKE dech_t.dech029,  
      dech030        LIKE dech_t.dech030,  
      dech031        LIKE dech_t.dech031,  
      dech032        LIKE dech_t.dech032,
      dech033        LIKE dech_t.dech033      
     )

   IF SQLCA.sqlcode != 0 THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'create adep150_dech_temp'
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF

   CREATE TEMP TABLE adep150_deci_temp(
      decient        LIKE deci_t.decient,  
      decisite       LIKE deci_t.decisite,
      deci001        LIKE deci_t.deci001,
      deci005        LIKE deci_t.deci005,
      deci006        LIKE deci_t.deci006,
      deci007        LIKE deci_t.deci007,
      deci008        LIKE deci_t.deci008,
      deci009        LIKE deci_t.deci009,
      deci010        LIKE deci_t.deci010,
      deci011        LIKE deci_t.deci011,
      deci012        LIKE deci_t.deci012,
      deci013        LIKE deci_t.deci013,
      deci014        LIKE deci_t.deci014,
      deci015        LIKE deci_t.deci015,
      deci016        LIKE deci_t.deci016,
      deci017        LIKE deci_t.deci017,
      deci018        LIKE deci_t.deci018,
      deci019        LIKE deci_t.deci019,
      deci020        LIKE deci_t.deci020,
      deci021        LIKE deci_t.deci021,   
      deci022        LIKE deci_t.deci022,
      deci023        LIKE deci_t.deci023,
      deci024        LIKE deci_t.deci024,
      deci025        LIKE deci_t.deci025,
      deci026        LIKE deci_t.deci026,
      deci027        LIKE deci_t.deci027,
      deci028        LIKE deci_t.deci028,
      deci029        LIKE deci_t.deci029
     )               
                    
   IF SQLCA.sqlcode != 0 THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'create adep150_deci_temp'
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   CREATE TEMP TABLE adep150_decj_temp(
      decjent        LIKE decj_t.decjent,  
      decjsite       LIKE decj_t.decjsite,
      decj001        LIKE decj_t.decj001,
      decj005        LIKE decj_t.decj005,
      decj006        LIKE decj_t.decj006,
      decj007        LIKE decj_t.decj007,
      decj008        LIKE decj_t.decj008,
      decj009        LIKE decj_t.decj009,
      decj010        LIKE decj_t.decj010,
      decj011        LIKE decj_t.decj011,
      decj012        LIKE decj_t.decj012,
      decj013        LIKE decj_t.decj013,
      decj014        LIKE decj_t.decj014,
      decj015        LIKE decj_t.decj015,
      decj016        LIKE decj_t.decj016 
     )               
                    
   IF SQLCA.sqlcode != 0 THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'create adep150_decj_temp'
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   RETURN r_success 
END FUNCTION]]>
  </point>
  <point name="function.adep150_create_temp5" order="11" ver="1" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adep150_create_temp5()
   DEFINE r_success         LIKE type_t.num5

   WHENEVER ERROR CONTINUE

   LET r_success = TRUE

   IF NOT adep150_drop_temp5() THEN
      LET r_success = FALSE
      RETURN r_success
   END IF

   CREATE TEMP TABLE adep150_deck_temp(
      deckent        LIKE deck_t.deckent,  
      decksite       LIKE deck_t.decksite,  
      deck001        LIKE deck_t.deck001,  
      deck005        LIKE deck_t.deck005,  
      deck006        LIKE deck_t.deck006,  
      deck007        LIKE deck_t.deck007,  
      deck008        LIKE deck_t.deck008,  
      deck009        LIKE deck_t.deck009,  
      deck010        LIKE deck_t.deck010,  
      deck011        LIKE deck_t.deck011,  
      deck012        LIKE deck_t.deck012,  
      deck013        LIKE deck_t.deck013,  
      deck014        LIKE deck_t.deck014,  
      deck015        LIKE deck_t.deck015,  
      deck016        LIKE deck_t.deck016,  
      deck017        LIKE deck_t.deck017,  
      deck018        LIKE deck_t.deck018,  
      deck019        LIKE deck_t.deck019,  
      deck020        LIKE deck_t.deck020,  
      deck021        LIKE deck_t.deck021,  
      deck022        LIKE deck_t.deck022,  
      deck023        LIKE deck_t.deck023,  
      deck024        LIKE deck_t.deck024,  
      deck025        LIKE deck_t.deck025,  
      deck026        LIKE deck_t.deck026,  
      deck027        LIKE deck_t.deck027,  
      deck028        LIKE deck_t.deck028   
     )

   IF SQLCA.sqlcode != 0 THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'create adep150_deck_temp'
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF

   CREATE TEMP TABLE adep150_decl_temp(
      declent        LIKE decl_t.declent,  
      declsite       LIKE decl_t.declsite,
      decl001        LIKE decl_t.decl001,
      decl005        LIKE decl_t.decl005,
      decl006        LIKE decl_t.decl006,
      decl007        LIKE decl_t.decl007,
      decl008        LIKE decl_t.decl008,
      decl009        LIKE decl_t.decl009,
      decl010        LIKE decl_t.decl010,
      decl011        LIKE decl_t.decl011,
      decl012        LIKE decl_t.decl012,
      decl013        LIKE decl_t.decl013,
      decl014        LIKE decl_t.decl014,
      decl015        LIKE decl_t.decl015,
      decl016        LIKE decl_t.decl016,
      decl017        LIKE decl_t.decl017,
      decl018        LIKE decl_t.decl018,
      decl019        LIKE decl_t.decl019,
      decl020        LIKE decl_t.decl020,
      decl021        LIKE decl_t.decl021,   
      decl022        LIKE decl_t.decl022,
      decl023        LIKE decl_t.decl023,
      decl024        LIKE decl_t.decl024 
     )               
                    
   IF SQLCA.sqlcode != 0 THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'create adep150_decl_temp'
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
 
   CREATE TEMP TABLE adep150_decm_temp(
      decment        LIKE decm_t.decment,  
      decmsite       LIKE decm_t.decmsite,
      decm001        LIKE decm_t.decm001,
      decm005        LIKE decm_t.decm005,
      decm006        LIKE decm_t.decm006,
      decm007        LIKE decm_t.decm007,
      decm008        LIKE decm_t.decm008,
      decm009        LIKE decm_t.decm009,
      decm010        LIKE decm_t.decm010,
      decm011        LIKE decm_t.decm011,
      decm012        LIKE decm_t.decm012,
      decm013        LIKE decm_t.decm013 
     )               
                    
   IF SQLCA.sqlcode != 0 THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'create adep150_decm_temp'
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   RETURN r_success 
END FUNCTION]]>
  </point>
  <point name="function.adep150_create_temp6" order="12" ver="1" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adep150_create_temp6()
   DEFINE r_success         LIKE type_t.num5

   WHENEVER ERROR CONTINUE

   LET r_success = TRUE

   IF NOT adep150_drop_temp6() THEN
      LET r_success = FALSE
      RETURN r_success
   END IF

   CREATE TEMP TABLE adep150_decn_temp(
      decnent        LIKE decn_t.decnent,  
      decnsite       LIKE decn_t.decnsite,  
      decn001        LIKE decn_t.decn001,  
      decn005        LIKE decn_t.decn005,  
      decn006        LIKE decn_t.decn006,  
      decn007        LIKE decn_t.decn007,  
      decn008        LIKE decn_t.decn008,  
      decn009        LIKE decn_t.decn009,  
      decn010        LIKE decn_t.decn010,  
      decn011        LIKE decn_t.decn011,  
      decn012        LIKE decn_t.decn012,  
      decn013        LIKE decn_t.decn013,  
      decn014        LIKE decn_t.decn014,  
      decn015        LIKE decn_t.decn015,  
      decn016        LIKE decn_t.decn016,  
      decn017        LIKE decn_t.decn017,  
      decn018        LIKE decn_t.decn018,  
      decn019        LIKE decn_t.decn019,  
      decn020        LIKE decn_t.decn020,  
      decn021        LIKE decn_t.decn021,  
      decn022        LIKE decn_t.decn022,  
      decn023        LIKE decn_t.decn023,  
      decn024        LIKE decn_t.decn024,  
      decn025        LIKE decn_t.decn025   
     )

   IF SQLCA.sqlcode != 0 THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'create adep150_decn_temp'
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF

   CREATE TEMP TABLE adep150_deco_temp(
      decoent        LIKE deco_t.decoent,  
      decosite       LIKE deco_t.decosite,
      deco001        LIKE deco_t.deco001,
      deco005        LIKE deco_t.deco005,
      deco006        LIKE deco_t.deco006,
      deco007        LIKE deco_t.deco007,
      deco008        LIKE deco_t.deco008,
      deco009        LIKE deco_t.deco009,
      deco010        LIKE deco_t.deco010,
      deco011        LIKE deco_t.deco011,
      deco012        LIKE deco_t.deco012,
      deco013        LIKE deco_t.deco013,
      deco014        LIKE deco_t.deco014,
      deco015        LIKE deco_t.deco015,
      deco016        LIKE deco_t.deco016,
      deco017        LIKE deco_t.deco017,
      deco018        LIKE deco_t.deco018,
      deco019        LIKE deco_t.deco019,
      deco020        LIKE deco_t.deco020,
      deco021        LIKE deco_t.deco021,   
      deco022        LIKE deco_t.deco022 
     )               
                    
   IF SQLCA.sqlcode != 0 THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'create adep150_deco_temp'
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   CREATE TEMP TABLE adep150_decp_temp(
      decpent        LIKE decp_t.decpent,  
      decpsite       LIKE decp_t.decpsite,
      decp001        LIKE decp_t.decp001,
      decp005        LIKE decp_t.decp005,
      decp006        LIKE decp_t.decp006,
      decp007        LIKE decp_t.decp007,
      decp008        LIKE decp_t.decp008,
      decp009        LIKE decp_t.decp009,
      decp010        LIKE decp_t.decp010 
     )               
                    
   IF SQLCA.sqlcode != 0 THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'create adep150_decp_temp'
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   RETURN r_success 
END FUNCTION]]>
  </point>
  <point name="function.adep150_create_temp7" order="13" ver="1" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adep150_create_temp7()
   DEFINE r_success         LIKE type_t.num5

   WHENEVER ERROR CONTINUE

   LET r_success = TRUE

   IF NOT adep150_drop_temp7() THEN
      LET r_success = FALSE
      RETURN r_success
   END IF

   CREATE TEMP TABLE adep150_decq_temp(
      decqent        LIKE decq_t.decqent,  
      decqsite       LIKE decq_t.decqsite,  
      decq001        LIKE decq_t.decq001,  
      decq005        LIKE decq_t.decq005,  
      decq006        LIKE decq_t.decq006,  
      decq007        LIKE decq_t.decq007,  
      decq008        LIKE decq_t.decq008,  
      decq009        LIKE decq_t.decq009,  
      decq010        LIKE decq_t.decq010,  
      decq011        LIKE decq_t.decq011,  
      decq012        LIKE decq_t.decq012,  
      decq013        LIKE decq_t.decq013,  
      decq014        LIKE decq_t.decq014,  
      decq015        LIKE decq_t.decq015,  
      decq016        LIKE decq_t.decq016,  
      decq017        LIKE decq_t.decq017,  
      decq018        LIKE decq_t.decq018,  
      decq019        LIKE decq_t.decq019,  
      decq020        LIKE decq_t.decq020,   
      decq023        LIKE decq_t.decq023,  
      decq024        LIKE decq_t.decq024,  
      decq025        LIKE decq_t.decq025,
      decq026        LIKE decq_t.decq026,
      decq027        LIKE decq_t.decq027
     )

   IF SQLCA.sqlcode != 0 THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'create adep150_decq_temp'
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF

   CREATE TEMP TABLE adep150_decr_temp(
      decrent        LIKE decr_t.decrent,  
      decrsite       LIKE decr_t.decrsite,
      decr001        LIKE decr_t.decr001,
      decr005        LIKE decr_t.decr005,
      decr006        LIKE decr_t.decr006,
      decr007        LIKE decr_t.decr007,
      decr008        LIKE decr_t.decr008,
      decr009        LIKE decr_t.decr009,
      decr010        LIKE decr_t.decr010,
      decr011        LIKE decr_t.decr011,
      decr012        LIKE decr_t.decr012,
      decr013        LIKE decr_t.decr013,
      decr014        LIKE decr_t.decr014,
      decr015        LIKE decr_t.decr015,
      decr016        LIKE decr_t.decr016,
      decr017        LIKE decr_t.decr017,
      decr018        LIKE decr_t.decr018,
      decr019        LIKE decr_t.decr019,
      decr020        LIKE decr_t.decr020,
      decr021        LIKE decr_t.decr021,
      decr022        LIKE decr_t.decr022      
     )               
                    
   IF SQLCA.sqlcode != 0 THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'create adep150_decr_temp'
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   CREATE TEMP TABLE adep150_decs_temp(
      decsent        LIKE decs_t.decsent,  
      decssite       LIKE decs_t.decssite,
      decs001        LIKE decs_t.decs001,
      decs005        LIKE decs_t.decs005,
      decs006        LIKE decs_t.decs006,
      decs007        LIKE decs_t.decs007,
      decs008        LIKE decs_t.decs008,
      decs009        LIKE decs_t.decs009 
     )               
                    
   IF SQLCA.sqlcode != 0 THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'create adep150_decs_temp'
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   RETURN r_success 

END FUNCTION]]>
  </point>
  <point name="function.adep150_create_temp9" order="14" ver="1" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adep150_create_temp9()
   DEFINE r_success         LIKE type_t.num5

   WHENEVER ERROR CONTINUE

   LET r_success = TRUE

   IF NOT adep150_drop_temp9() THEN
      LET r_success = FALSE
      RETURN r_success
   END IF

   CREATE TEMP TABLE adep150_decv_temp(
      decvent        LIKE decv_t.decvent,  
      decvsite       LIKE decv_t.decvsite,  
      decv001        LIKE decv_t.decv001,  
      decv002        LIKE decv_t.decv002,  
      decv004        LIKE decv_t.decv004,  
      decv005        LIKE decv_t.decv005,  
      decv006        LIKE decv_t.decv006,  
      decv007        LIKE decv_t.decv007,  
      decv008        LIKE decv_t.decv008,  
      decv009        LIKE decv_t.decv009,  
      decv010        LIKE decv_t.decv010,  
      decv011        LIKE decv_t.decv011,  
      decv012        LIKE decv_t.decv012,  
      decv013        LIKE decv_t.decv013,  
      decv014        LIKE decv_t.decv014,  
      decv015        LIKE decv_t.decv015,  
      decv016        LIKE decv_t.decv016,  
      decv017        LIKE decv_t.decv017,  
      decv018        LIKE decv_t.decv018,  
      decv019        LIKE decv_t.decv019,  
      decv020        LIKE decv_t.decv020   
     )

   IF SQLCA.sqlcode != 0 THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'create adep150_decv_temp'
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF

   CREATE TEMP TABLE adep150_decw_temp(
      decwent        LIKE decw_t.decwent,  
      decwsite       LIKE decw_t.decwsite,
      decw001        LIKE decw_t.decw001,
      decw005        LIKE decw_t.decw005,
      decw006        LIKE decw_t.decw006,
      decw007        LIKE decw_t.decw007,
      decw008        LIKE decw_t.decw008,
      decw009        LIKE decw_t.decw009,
      decw010        LIKE decw_t.decw010,
      decw011        LIKE decw_t.decw011,
      decw012        LIKE decw_t.decw012,
      decw013        LIKE decw_t.decw013,
      decw014        LIKE decw_t.decw014,
      decw015        LIKE decw_t.decw015,
      decw016        LIKE decw_t.decw016,
      decw017        LIKE decw_t.decw017,
      decw018        LIKE decw_t.decw018,
      decw019        LIKE decw_t.decw019,
      decw020        LIKE decw_t.decw020 
     )               
                    
   IF SQLCA.sqlcode != 0 THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'create adep150_decw_temp'
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   RETURN r_success 
END FUNCTION]]>
  </point>
  <point name="function.adep150_drop_temp0" order="15" ver="1" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adep150_drop_temp0()
   DEFINE r_success          LIKE type_t.num5

   WHENEVER ERROR CONTINUE

   LET r_success = TRUE

   DROP TABLE adep150_decf_temp

   IF NOT (SQLCA.sqlcode = 0 OR SQLCA.sqlcode = -206) THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'drop adep150_decf_temp'
      LET g_errparam.popup = TRUE
      CALL cl_err()

      LET r_success = FALSE
      RETURN r_success
   END IF

   DROP TABLE adep150_decg_temp

   IF NOT (SQLCA.sqlcode = 0 OR SQLCA.sqlcode = -206) THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'drop adep150_decg_temp'
      LET g_errparam.popup = TRUE
      CALL cl_err()

      LET r_success = FALSE
      RETURN r_success
   END IF

   RETURN r_success
END FUNCTION]]>
  </point>
  <point name="function.adep150_drop_temp1" order="16" ver="1" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adep150_drop_temp1()
   DEFINE r_success          LIKE type_t.num5

   WHENEVER ERROR CONTINUE

   LET r_success = TRUE

   DROP TABLE adep150_dect_temp

   IF NOT (SQLCA.sqlcode = 0 OR SQLCA.sqlcode = -206) THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'drop adep150_dect_temp'
      LET g_errparam.popup = TRUE
      CALL cl_err()

      LET r_success = FALSE
      RETURN r_success
   END IF

   DROP TABLE adep150_decu_temp

   IF NOT (SQLCA.sqlcode = 0 OR SQLCA.sqlcode = -206) THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'drop adep150_decu_temp'
      LET g_errparam.popup = TRUE
      CALL cl_err()

      LET r_success = FALSE
      RETURN r_success
   END IF

   RETURN r_success

END FUNCTION]]>
  </point>
  <point name="function.adep150_drop_temp4" order="17" ver="1" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adep150_drop_temp4()
   DEFINE r_success          LIKE type_t.num5

   WHENEVER ERROR CONTINUE

   LET r_success = TRUE

   DROP TABLE adep150_dech_temp

   IF NOT (SQLCA.sqlcode = 0 OR SQLCA.sqlcode = -206) THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'drop adep150_dech_temp'
      LET g_errparam.popup = TRUE
      CALL cl_err()

      LET r_success = FALSE
      RETURN r_success
   END IF

   DROP TABLE adep150_deci_temp

   IF NOT (SQLCA.sqlcode = 0 OR SQLCA.sqlcode = -206) THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'drop adep150_deci_temp'
      LET g_errparam.popup = TRUE
      CALL cl_err()

      LET r_success = FALSE
      RETURN r_success
   END IF

   DROP TABLE adep150_decj_temp

   IF NOT (SQLCA.sqlcode = 0 OR SQLCA.sqlcode = -206) THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'drop adep150_decj_temp'
      LET g_errparam.popup = TRUE
      CALL cl_err()

      LET r_success = FALSE
      RETURN r_success
   END IF

   RETURN r_success
END FUNCTION]]>
  </point>
  <point name="function.adep150_drop_temp5" order="18" ver="1" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adep150_drop_temp5()
   DEFINE r_success          LIKE type_t.num5

   WHENEVER ERROR CONTINUE

   LET r_success = TRUE

   DROP TABLE adep150_deck_temp

   IF NOT (SQLCA.sqlcode = 0 OR SQLCA.sqlcode = -206) THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'drop adep150_deck_temp'
      LET g_errparam.popup = TRUE
      CALL cl_err()

      LET r_success = FALSE
      RETURN r_success
   END IF

   DROP TABLE adep150_decl_temp

   IF NOT (SQLCA.sqlcode = 0 OR SQLCA.sqlcode = -206) THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'drop adep150_decl_temp'
      LET g_errparam.popup = TRUE
      CALL cl_err()

      LET r_success = FALSE
      RETURN r_success
   END IF

   DROP TABLE adep150_decm_temp

   IF NOT (SQLCA.sqlcode = 0 OR SQLCA.sqlcode = -206) THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'drop adep150_decm_temp'
      LET g_errparam.popup = TRUE
      CALL cl_err()

      LET r_success = FALSE
      RETURN r_success
   END IF

   RETURN r_success

END FUNCTION]]>
  </point>
  <point name="function.adep150_drop_temp7" order="19" ver="1" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adep150_drop_temp7()
   DEFINE r_success          LIKE type_t.num5

   WHENEVER ERROR CONTINUE

   LET r_success = TRUE

   DROP TABLE adep150_decq_temp

   IF NOT (SQLCA.sqlcode = 0 OR SQLCA.sqlcode = -206) THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'drop adep150_decq_temp'
      LET g_errparam.popup = TRUE
      CALL cl_err()

      LET r_success = FALSE
      RETURN r_success
   END IF

   DROP TABLE adep150_decr_temp

   IF NOT (SQLCA.sqlcode = 0 OR SQLCA.sqlcode = -206) THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'drop adep150_decr_temp'
      LET g_errparam.popup = TRUE
      CALL cl_err()

      LET r_success = FALSE
      RETURN r_success
   END IF

   DROP TABLE adep150_decs_temp

   IF NOT (SQLCA.sqlcode = 0 OR SQLCA.sqlcode = -206) THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'drop adep150_decs_temp'
      LET g_errparam.popup = TRUE
      CALL cl_err()

      LET r_success = FALSE
      RETURN r_success
   END IF

   RETURN r_success
END FUNCTION]]>
  </point>
  <point name="function.adep150_drop_temp6" order="20" ver="1" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adep150_drop_temp6()
   DEFINE r_success          LIKE type_t.num5

   WHENEVER ERROR CONTINUE

   LET r_success = TRUE

   DROP TABLE adep150_decn_temp

   IF NOT (SQLCA.sqlcode = 0 OR SQLCA.sqlcode = -206) THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'drop adep150_decn_temp'
      LET g_errparam.popup = TRUE
      CALL cl_err()

      LET r_success = FALSE
      RETURN r_success
   END IF

   DROP TABLE adep150_deco_temp

   IF NOT (SQLCA.sqlcode = 0 OR SQLCA.sqlcode = -206) THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'drop adep150_deco_temp'
      LET g_errparam.popup = TRUE
      CALL cl_err()

      LET r_success = FALSE
      RETURN r_success
   END IF

   DROP TABLE adep150_decp_temp

   IF NOT (SQLCA.sqlcode = 0 OR SQLCA.sqlcode = -206) THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'drop adep150_decp_temp'
      LET g_errparam.popup = TRUE
      CALL cl_err()

      LET r_success = FALSE
      RETURN r_success
   END IF

   RETURN r_success
END FUNCTION]]>
  </point>
  <point name="function.adep150_drop_temp9" order="21" ver="1" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adep150_drop_temp9()
   DEFINE r_success          LIKE type_t.num5

   WHENEVER ERROR CONTINUE

   LET r_success = TRUE

   DROP TABLE adep150_decv_temp

   IF NOT (SQLCA.sqlcode = 0 OR SQLCA.sqlcode = -206) THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'drop adep150_decv_temp'
      LET g_errparam.popup = TRUE
      CALL cl_err()

      LET r_success = FALSE
      RETURN r_success
   END IF

   DROP TABLE adep150_decw_temp

   IF NOT (SQLCA.sqlcode = 0 OR SQLCA.sqlcode = -206) THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'drop adep150_decw_temp'
      LET g_errparam.popup = TRUE
      CALL cl_err()

      LET r_success = FALSE
      RETURN r_success
   END IF

   RETURN r_success
END FUNCTION]]>
  </point>
  <point name="function.adep150_ins_temp0" order="22" ver="1" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adep150_ins_temp0(p_wc)
   DEFINE p_wc           STRING
   DEFINE l_wc           STRING
   DEFINE r_success      LIKE type_t.num5
   DEFINE l_sql          STRING
   DEFINE l_where        STRING
   
   LET r_success = TRUE
   DELETE FROM adep150_decf_temp
   LET l_where = s_aooi500_sql_where(g_prog,'debasite') 
   LET l_wc = cl_replace_str(p_wc,'rtjasite','debasite')
   
   LET l_sql = " INSERT INTO adep150_decf_temp( decfent, decfsite,decf005, decf009, decf014, decf015,",
               "                                decf017, decf018, decf019, decf020, decf021, ",
               "                                decf022, decf023, decf024, decf025, decf026, ",
               "                                decf027, decf029, decf030, decf031, decf032, ",
               "                                decf033, decf034, decf035, decf036, decf037, ",
               "                                decf038, decf039, decf040, decf043, decf044, ",
               "                                decf045, decf046, decf047 ) ",                
               " SELECT debaent,      debasite,     deba005,      deba009,  COALESCE(deba014,' ') ,   COALESCE(deba015,' '),",
               "        deba017,                  deba018,                  SUM(COALESCE(deba019,0)), deba020,                  SUM(COALESCE(deba021,0)),",
               "        SUM(COALESCE(deba022,0)), SUM(COALESCE(deba023,0)), SUM(COALESCE(deba024,0)), SUM(COALESCE(deba025,0)), SUM(COALESCE(deba026,0)),",
               "        SUM(COALESCE(deba027,0)), SUM(COALESCE(deba029,0)), SUM(COALESCE(deba030,0)), SUM(COALESCE(deba031,0)), SUM(COALESCE(deba032,0)),",
               "        SUM(COALESCE(deba033,0)), SUM(COALESCE(deba034,0)), SUM(COALESCE(deba035,0)), SUM(COALESCE(deba036,0)), SUM(COALESCE(deba037,0)),",
               "        SUM(COALESCE(deba038,0)), SUM(COALESCE(deba039,0)), SUM(COALESCE(deba040,0)), deba043,                  SUM(COALESCE(deba044,0)),",
               "        SUM(COALESCE(deba045,0)), SUM(COALESCE(deba046,0)), SUM(COALESCE(deba047,0)) ",
               "   FROM deba_t ",
               "  WHERE debaent = ",g_enterprise,
               "    AND deba002 BETWEEN ? AND ? ",
               "    AND ",l_wc,
               "    AND ",l_where,
               "  GROUP BY debaent, debasite, deba005, deba009, deba014,",
               "           deba015, deba017,  deba018, deba020, deba043 "

   PREPARE adep150_ins_decf_temp_prep FROM l_sql
   EXECUTE adep150_ins_decf_temp_prep USING g_sdate,g_edate
   
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "INSERT adep150_decf_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   LET l_sql = "UPDATE adep150_decf_temp SET decf001 = (SELECT ooef101 FROM ooef_t WHERE ooefent = decfent AND ooef001 = decfsite),",
               "                            (decf010,decf013,decf016) = ( SELECT imaa014,imaa126,COALESCE(imaa009,' ')  ",
               "                                                           FROM imaa_t  ",
               "                                                          WHERE imaaent = decfent AND imaa001 = decf009), ",
               "                            (decf011,decf012) = (SELECT imaal003,imaal004 FROM imaal_t  ",
               "                                                  WHERE imaalent = decfent AND imaal001 = decf009 ",
               "                                                    AND imaal002 = '",g_dlang,"'),",
               "                            (decf006,decf007,decf008) = (SELECT inaa102,inaa111,inaa105 FROM inaa_t ",
               "                                                          WHERE inaaent = decfent AND inaasite = decfsite  ",
               "                                                            AND inaa001 = decf005 ), ",
               "                            decf028 = CASE WHEN decf027 = 0 THEN 0 ELSE (decf027 / (CASE WHEN decf026 = 0 THEN decf027 ELSE decf026 END) * 100) END,",
               "                            decf048 = decf026 / (CASE WHEN decf029 = 0 THEN 1 ELSE decf029 END), ",
               "                            decf041 = ",g_yearmonth,",",
               "                            decf042 = ",g_week

   PREPARE adep150_decf_upd FROM l_sql 
   EXECUTE adep150_decf_upd
   
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "UPDATE adep150_decf_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   CREATE INDEX decf_temp_01 ON adep150_decf_temp(decfent,decfsite,decf041,decf042)
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "CREATE INDEX adep150_decf_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF      
   DELETE FROM adep150_decg_temp
   LET l_where = s_aooi500_sql_where(g_prog,'debbsite')    
   LET l_wc = cl_replace_str(p_wc,'rtjasite','debbsite')
   
   LET l_sql = " INSERT INTO adep150_decg_temp( decgent,  decgsite, decg005, decg009, ",
               "                                decg017,  decg018,  decg019, decg020, decg021,",   
               "                                decg022,  decg023,  decg024, decg025, decg026,",
               "                                decg027,  decg028,  decg030, decg031, decg032,",
               "                                decg033,  decg034,  decg037)",
               " SELECT debbent,       debbsite,      debb005,      debb009, ",
               "        debb017,       debb018,       debb019,      debb020,      debb021,",  
               "        SUM(COALESCE(debb022,0)),  SUM(COALESCE(debb023,0)),  SUM(COALESCE(debb024,0)), SUM(COALESCE(debb025,0)), SUM(COALESCE(debb026,0)),",
               "        SUM(COALESCE(debb027,0)),  SUM(COALESCE(debb028,0)),  SUM(COALESCE(debb030,0)), SUM(COALESCE(debb031,0)), SUM(COALESCE(debb032,0)),",
               "        SUM(COALESCE(debb033,0)),  SUM(COALESCE(debb034,0)),  debb035 ",
               "   FROM debb_t ",
               "  WHERE debbent = ",g_enterprise,
               "    AND debb002 BETWEEN ? AND ? ",
               "    AND ",l_wc,
               "    AND ",l_where,
               "  GROUP BY debbent, debbsite, debb005, debb009, debb017, ",
               "           debb018,  debb019, debb020, debb021, debb035"
                    
   PREPARE adep150_ins_decg_temp_prep FROM l_sql
   EXECUTE adep150_ins_decg_temp_prep USING g_sdate,g_edate   
   
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "INSERT adep150_decg_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   LET l_sql = "UPDATE adep150_decg_temp SET decg001 = (SELECT ooef101 FROM ooef_t WHERE ooefent = decgent AND ooef001 = decgsite),",
               "                            (decg010,decg013,decg016) = ( SELECT imaa014,imaa126,COALESCE(imaa009,' ')  ",
               "                                                           FROM imaa_t  ",
               "                                                          WHERE imaaent = decgent AND imaa001 = decg009), ",
               "                            (decg011,decg012) = (SELECT imaal003,imaal004 FROM imaal_t  ",
               "                                                  WHERE imaalent = decgent AND imaal001 = decg009 ",
               "                                                    AND imaal002 = '",g_dlang,"'),",
               "                            (decg006,decg007,decg008) = (SELECT inaa102,inaa111,inaa105 FROM inaa_t ",
               "                                                          WHERE inaaent = decgent AND inaasite = decgsite  ",
               "                                                            AND inaa001 = decg005 ), ",
               "                            decg014 = (SELECT imaf153 FROM imaf_t  ",
               "                                          WHERE imafent = decgent AND imafsite = decgsite  ",
               "                                            AND imaf001 = decg009),",
               "                            decg029 = CASE WHEN decg028 = 0 THEN 0 ELSE (decg028 / (CASE WHEN decg027 = 0 THEN decg028 ELSE decg027 END) * 100) END,",
               "                            decg038 = decg027 / (CASE WHEN decg031 = 0 THEN 1 ELSE decg031 END), ",
               "                            decg035 = ",g_yearmonth,",",
               "                            decg036 = ",g_week
   PREPARE adep150_decg_upd FROM l_sql 
   EXECUTE adep150_decg_upd
               
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "UPDATE adep150_decg_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   CREATE INDEX decg_temp_01 ON adep150_decg_temp(decgent,decgsite,decg035,decg036)
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "CREATE INDEX adep150_decg_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   RETURN r_success   
   
END FUNCTION]]>
  </point>
  <point name="function.adep150_ins_temp1" order="23" ver="1" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adep150_ins_temp1(p_wc)
   DEFINE p_wc           STRING
   DEFINE l_wc           STRING
   DEFINE r_success      LIKE type_t.num5
   DEFINE l_sql          STRING
   DEFINE l_where        STRING
   
   LET r_success = TRUE
   
   DELETE FROM adep150_dect_temp
   LET l_where = s_aooi500_sql_where(g_prog,'debssite')
   LET l_wc = cl_replace_str(p_wc,'rtjasite','debssite')
   LET l_sql = " INSERT INTO adep150_dect_temp( dectent, dectsite,dect005, dect006,",
               "                                dect007, dect008, dect009, dect010, dect011,",
               "                                dect012, dect013, dect014, dect015, dect016,",
               "                                dect017, dect019, dect020, dect021, dect022,",
               "                                dect023, dect024, dect025, dect026, dect027,",
               "                                dect028, dect029, dect030, dect031, dect032,",
               "                                dect033, dect037)",
               " SELECT debsent,      debssite,     debs005,      debs006,     ",
               "        debs007,      debs008,      debs009,      SUM(COALESCE(debs010,0)),      SUM(COALESCE(debs011,0)),",
               "        SUM(COALESCE(debs012,0)), SUM(COALESCE(debs013,0)), SUM(COALESCE(debs014,0)), SUM(COALESCE(debs015,0)), SUM(COALESCE(debs016,0)),",
               "        SUM(COALESCE(debs017,0)), SUM(COALESCE(debs019,0)), SUM(COALESCE(debs020,0)), SUM(COALESCE(debs021,0)), SUM(COALESCE(debs022,0)),",
               "        SUM(COALESCE(debs023,0)), SUM(COALESCE(debs024,0)), SUM(COALESCE(debs025,0)), SUM(COALESCE(debs026,0)), SUM(COALESCE(debs027,0)),",
               "        SUM(COALESCE(debs028,0)), SUM(COALESCE(debs029,0)), SUM(COALESCE(debs030,0)), SUM(COALESCE(debs031,0)), SUM(COALESCE(debs032,0)),", 
               "        SUM(COALESCE(debs033,0)), debs035",
               "   FROM debs_t ",
               "  WHERE debsent = ", g_enterprise,
               "    AND debs002 BETWEEN ? AND ? ",
               "    AND ",l_wc,
               "    AND ",l_where,
               "  GROUP BY debsent, debssite, debs005, debs006,",
               "           debs007, debs008,  debs009, debs035  "
               
   PREPARE adep150_ins_dect_temp_prep FROM l_sql
   EXECUTE adep150_ins_dect_temp_prep USING g_sdate,g_edate
   
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "INSERT adep150_dect_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   LET l_sql = "UPDATE adep150_dect_temp SET dect001 = (SELECT ooef101 FROM ooef_t WHERE ooefent = dectent AND ooef001 = dectsite),",
               "                             dect018 = CASE WHEN dect017 = 0 THEN 0 ELSE (dect017 / (CASE WHEN dect016 = 0 THEN dect017 ELSE dect016 END) * 100) END,",
               "                             dect036 = dect016 / (CASE WHEN dect019 = 0 THEN 1 ELSE dect019 END), ",
               "                             dect034 = ",g_yearmonth,",",
               "                             dect035 = ",g_week
   PREPARE adep150_dect_upd FROM l_sql 
   EXECUTE adep150_dect_upd
   
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "UPDATE adep150_dect_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   CREATE INDEX dect_temp_01 ON adep150_dect_temp(dectent,dectsite,dect034,dect035)
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "CREATE INDEX adep150_dect_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF      
   DELETE FROM adep150_decu_temp
   LET l_where = s_aooi500_sql_where(g_prog,'debtsite')
   LET l_wc = cl_replace_str(p_wc,'rtjasite','debtsite')
   
   LET l_sql = " INSERT INTO adep150_decu_temp( decuent,  decusite, decu001, decu005, decu006,",
               "                                decu007,  decu008,  decu009, decu010, decu011,",
               "                                decu012,  decu013,  decu014, decu015, decu016,",
               "                                decu017,  decu018,  decu020, decu021, decu022,",
               "                                decu023,  decu024,  decu028) ",
               " SELECT debtent,       debtsite,      debt001,      debt005,      debt006,     ",
               "        debt007,       debt008,       debt009,      debt010,      debt011,     ",
               "        SUM(COALESCE(debt012,0)),  SUM(COALESCE(debt013,0)),  SUM(COALESCE(debt014,0)), SUM(COALESCE(debt015,0)), SUM(COALESCE(debt016,0)),",
               "        SUM(COALESCE(debt017,0)),  SUM(COALESCE(debt018,0)),  SUM(COALESCE(debt020,0)), SUM(COALESCE(debt021,0)), SUM(COALESCE(debt022,0)),",
               "        SUM(COALESCE(debt023,0)),  SUM(COALESCE(debt024,0)),  debt026 ",
               "   FROM debt_t ",
               "  WHERE debtent = ",g_enterprise,
               "    AND debt002 BETWEEN ? AND ? ",
               "    AND ",l_wc,
               "    AND ",l_where,
               "  GROUP BY debtent, debtsite, debt001, debt005, debt006,",
               "           debt007, debt008,  debt009, debt010, debt011, debt026"
               
   PREPARE adep150_ins_decu_temp_prep FROM l_sql
   EXECUTE adep150_ins_decu_temp_prep USING g_sdate,g_edate   
   
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "INSERT adep150_decu_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   LET l_sql = "UPDATE adep150_decu_temp SET decu001 = (SELECT ooef101 FROM ooef_t WHERE ooefent = decuent AND ooef001 = decusite),",
               "                             decu019 = CASE WHEN decu018 = 0 THEN 0 ELSE (decu018 / (CASE WHEN decu017 = 0 THEN decu018 ELSE decu017 END) * 100) END,",
               "                             decu027 = decu017 / (CASE WHEN decu021 = 0 THEN 1 ELSE decu021 END), ",
               "                             decu025 = ",g_yearmonth,",",
               "                             decu026 = ",g_week
   PREPARE adep150_decu_upd FROM l_sql 
   EXECUTE adep150_decu_upd
   
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "UPDATE adep150_decu_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   CREATE INDEX decu_temp_01 ON adep150_decu_temp(decuent,decusite,decu025,decu026)
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "CREATE INDEX adep150_decu_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   RETURN r_success   
END FUNCTION]]>
  </point>
  <point name="function.adep150_ins_temp4" order="24" ver="1" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adep150_ins_temp4(p_wc)
   DEFINE p_wc           STRING
   DEFINE l_wc           STRING
   DEFINE r_success      LIKE type_t.num5
   DEFINE l_sql          STRING
   DEFINE l_where        STRING
   
   LET r_success = TRUE
   DELETE FROM adep150_dech_temp
   LET l_where = s_aooi500_sql_where(g_prog,'debcsite')
   LET l_wc = cl_replace_str(p_wc,'rtjasite','debcsite')
   
   LET l_sql = " INSERT INTO adep150_dech_temp( dechent, dechsite,dech005, dech009, dech010, dech011,",
               "                                dech012, dech013, dech014, dech015, dech016,",
               "                                dech017, dech018, dech019, dech020, dech021,",
               "                                dech022, dech024, dech025, dech026, dech027,",
               "                                dech028, dech029, dech030)",
               " SELECT debcent,      debcsite,     debc005,      debc009,      debc010,      debc011,     ",
               "        SUM(COALESCE(debc012,0)), SUM(COALESCE(debc013,0)), SUM(COALESCE(debc014,0)), SUM(COALESCE(debc015,0)), SUM(COALESCE(debc016,0)),",
               "        SUM(COALESCE(debc017,0)), SUM(COALESCE(debc018,0)), SUM(COALESCE(debc019,0)), SUM(COALESCE(debc020,0)), SUM(COALESCE(debc021,0)),",
               "        SUM(COALESCE(debc022,0)), SUM(COALESCE(debc024,0)), SUM(COALESCE(debc025,0)), SUM(COALESCE(debc026,0)), SUM(COALESCE(debc027,0)),",
               "        SUM(COALESCE(debc028,0)), SUM(COALESCE(debc029,0)), SUM(COALESCE(debc030,0))",
               "   FROM debc_t",
               "  WHERE debcent = ",g_enterprise,
               "    AND debc002 BETWEEN ? AND ? ",
               "    AND ",l_wc,
               "    AND ",l_where,
               "  GROUP BY debcent, debcsite, debc005, debc009, debc010, debc011 "
               
   PREPARE adep150_ins_dech_temp_prep FROM l_sql
   EXECUTE adep150_ins_dech_temp_prep USING g_sdate,g_edate
   
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "INSERT adep150_dech_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   LET l_sql = "UPDATE adep150_dech_temp SET dech001 = (SELECT ooef101 FROM ooef_t WHERE ooefent = dechent AND ooef001 = dechsite),",
               "                            (dech006,dech007,dech008) = (SELECT inaa102,inaa111,inaa105 FROM inaa_t ",
               "                                                          WHERE inaaent = dechent AND inaasite = dechsite  ",
               "                                                            AND inaa001 = dech005 ), ",
               "                            dech023 = CASE WHEN dech022 = 0 THEN 0 ELSE (dech022 / (CASE WHEN dech018 = 0 THEN dech022 ELSE dech018 END) * 100) END,",
               "                            dech033 = dech018 / (CASE WHEN dech024 = 0 THEN 1 ELSE dech024 END), ",
               "                            dech031 = ",g_yearmonth,",",
               "                            dech032 = ",g_week
   PREPARE adep150_dech_upd FROM l_sql 
   EXECUTE adep150_dech_upd
   
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "UPDATE adep150_dech_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   CREATE INDEX dech_temp_01 ON adep150_dech_temp(dechent,dechsite,dech031,dech032)
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "CREATE INDEX adep150_dech_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF      
   DELETE FROM adep150_deci_temp
   LET l_where = s_aooi500_sql_where(g_prog,'debdsite')
   LET l_wc = cl_replace_str(p_wc,'rtjasite','debdsite')
   
   LET l_sql = " INSERT INTO adep150_deci_temp( decient,  decisite, deci005, deci009, deci010, deci011,",
               "                                deci012,  deci013,  deci014, deci015, deci016,",
               "                                deci017,  deci018,  deci019, deci020, deci022,",
               "                                deci023,  deci024,  deci025, deci026)",
               " SELECT debdent,      debdsite,      debd005,      debd009,       debd010,      debd011,",
               "        debd012,                   debd013,                   SUM(COALESCE(debd014,0)), SUM(COALESCE(debd015,0)), SUM(COALESCE(debd016,0)),",
               "        SUM(COALESCE(debd017,0)),  SUM(COALESCE(debd018,0)),  SUM(COALESCE(debd019,0)), SUM(COALESCE(debd020,0)), SUM(COALESCE(debd022,0)),",
               "        SUM(COALESCE(debd023,0)),  SUM(COALESCE(debd024,0)),  SUM(COALESCE(debd025,0)), SUM(COALESCE(debd026,0))",
               "   FROM debd_t",
               "  WHERE debdent = ",g_enterprise,
               "    AND debd002 BETWEEN ? AND ? ",
               "    AND ",l_wc,
               "    AND ",l_where,
               "  GROUP BY debdent, debdsite, debd005, debd009, debd010, debd011,",
               "           debd012, debd013 "
   
   PREPARE adep150_ins_deci_temp_prep FROM l_sql
   EXECUTE adep150_ins_deci_temp_prep USING g_sdate,g_edate

   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "INSERT adep150_deci_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   LET l_sql = "UPDATE adep150_deci_temp SET deci001 = (SELECT ooef101 FROM ooef_t WHERE ooefent = decient AND ooef001 = decisite),",
               "                            (deci006,deci007,deci008) = (SELECT inaa102,inaa111,inaa105 FROM inaa_t ",
               "                                                          WHERE inaaent = decient AND inaasite = decisite  ",
               "                                                            AND inaa001 = deci005 ), ",
               "                            deci021 = CASE WHEN deci020 = 0 THEN 0 ELSE (deci020 / (CASE WHEN deci019 = 0 THEN deci020 ELSE deci019 END) * 100) END,",
               "                            deci029 = deci019 / (CASE WHEN deci023 = 0 THEN 1 ELSE deci023 END), ",
               "                            deci027 = ",g_yearmonth,",",
               "                            deci028 = ",g_week
   PREPARE adep150_deci_upd FROM l_sql 
   EXECUTE adep150_deci_upd
   
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "UPDATE adep150_deci_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   CREATE INDEX deci_temp_01 ON adep150_deci_temp(decient,decisite,deci027,deci028)
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "CREATE INDEX adep150_deci_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   DELETE FROM adep150_decj_temp
   LET l_where = s_aooi500_sql_where(g_prog,'debesite')
   LET l_wc = cl_replace_str(p_wc,'rtjasite','debesite')
   LET l_sql = " INSERT INTO adep150_decj_temp( decjent,  decjsite, decj005, decj009, decj010,",
               "                                decj011,  decj012,  decj013, decj014) ",
               " SELECT debeent,       debesite,      debe005,       debe009,      debe010,",
               "        debe011,       debe012,       debe013,       SUM(COALESCE(debe014,0)) ",
               "   FROM debe_t ",
               "  WHERE debeent = ",g_enterprise,
               "    AND debe002 BETWEEN ? AND ? ",
               "    AND ",l_wc,
               "    AND ",l_where,
               "  GROUP BY debeent, debesite, debe005, debe009, debe010,",
               "           debe011, debe012,  debe013 "

   PREPARE adep150_ins_decj_temp_prep FROM l_sql
   EXECUTE adep150_ins_decj_temp_prep USING g_sdate,g_edate

   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "INSERT adep150_decj_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   LET l_sql = "UPDATE adep150_decj_temp SET decj001 = (SELECT ooef101 FROM ooef_t WHERE ooefent = decjent AND ooef001 = decjsite),",
               "                            (decj006,decj007,decj008) = (SELECT inaa102,inaa111,inaa105 FROM inaa_t ",
               "                                                          WHERE inaaent = decjent AND inaasite = decjsite  ",
               "                                                            AND inaa001 = decj005 ), ",
               "                            decj015 = ",g_yearmonth,",",
               "                            decj016 = ",g_week
   PREPARE adep150_decj_upd FROM l_sql 
   EXECUTE adep150_decj_upd
   
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "UPDATE adep150_decj_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   CREATE INDEX decj_temp_01 ON adep150_decj_temp(decjent,decjsite,decj015,decj016)
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "CREATE INDEX adep150_decj_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF

   RETURN r_success   
   
END FUNCTION]]>
  </point>
  <point name="function.adep150_ins_temp5" order="25" ver="1" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adep150_ins_temp5(p_wc)
   DEFINE p_wc           STRING
   DEFINE l_wc           STRING
   DEFINE r_success      LIKE type_t.num5
   DEFINE l_sql          STRING
   DEFINE l_where        STRING
   
   LET r_success = TRUE
   DELETE FROM adep150_deck_temp
   LET l_where = s_aooi500_sql_where(g_prog,'debgsite')
   LET l_wc = cl_replace_str(p_wc,'rtjasite','debgsite')
   
   LET l_sql = " INSERT INTO adep150_deck_temp( deckent, decksite,deck005, ",
               "                                deck007, deck008, deck009, deck010, deck011,",
               "                                deck012, deck013, deck014, deck015, deck016,",
               "                                deck017, deck018, deck020, deck021, deck022,",
               "                                deck023, deck024, deck025, deck026)",
               " SELECT debgent,      debgsite,        debg005,",
               "        debg007,                  debg008,                  SUM(COALESCE(debg009,0)), SUM(COALESCE(debg010,0)), SUM(COALESCE(debg011,0)),",
               "        SUM(COALESCE(debg012,0)), SUM(COALESCE(debg013,0)), SUM(COALESCE(debg014,0)), SUM(COALESCE(debg015,0)), SUM(COALESCE(debg016,0)),",
               "        SUM(COALESCE(debg017,0)), SUM(COALESCE(debg018,0)), SUM(COALESCE(debg020,0)), SUM(COALESCE(debg021,0)), SUM(COALESCE(debg022,0)),",
               "        SUM(COALESCE(debg023,0)), SUM(COALESCE(debg024,0)), SUM(COALESCE(debg025,0)), SUM(COALESCE(debg026,0))",
               "   FROM debg_t",
               "  WHERE debgent = ",g_enterprise,
               "    AND debg002 BETWEEN ? AND ? ",
               "    AND ",l_wc,
               "    AND ",l_where,
               "  GROUP BY debgent, debgsite, debg005, debg007, debg008 "

   PREPARE adep150_ins_deck_temp_prep FROM l_sql
   EXECUTE adep150_ins_deck_temp_prep USING g_sdate,g_edate
   
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "INSERT adep150_deck_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   LET l_sql = "UPDATE adep150_deck_temp SET deck001 = (SELECT ooef101 FROM ooef_t WHERE ooefent = deckent AND ooef001 = decksite),",
               "                             deck006 = (SELECT mhae002 FROM mhae_t WHERE mhaeent = deckent AND mhaesite = decksite AND mhae001 = deck005),", 
               "                             deck019 = CASE WHEN deck018 = 0 THEN 0 ELSE (deck018 / (CASE WHEN deck015 = 0 THEN deck018 ELSE deck015 END) * 100) END,",
               "                             deck027 = ",g_yearmonth,",",
               "                             deck028 = ",g_week
   PREPARE adep150_deck_upd FROM l_sql 
   EXECUTE adep150_deck_upd
   
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "UPDATE adep150_deck_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   CREATE INDEX deck_temp_01 ON adep150_deck_temp(deckent,decksite,deck027,deck028)
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "CREATE INDEX adep150_deck_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF      
   DELETE FROM adep150_decl_temp
   LET l_where = s_aooi500_sql_where(g_prog,'debhsite')
   LET l_wc = cl_replace_str(p_wc,'rtjasite','debhsite')
   
   LET l_sql = "INSERT INTO adep150_decl_temp( declent,  declsite, decl005, decl006,",
               "                               decl007,  decl008,  decl009, decl010, decl011,",
               "                               decl012,  decl013,  decl014, decl015, decl016,",
               "                               decl018,  decl019,  decl020, decl021, decl022)",
               " SELECT debhent,       debhsite,         debh005,      debh006,",
               "        debh007,                   debh008,                   debh009,                  SUM(COALESCE(debh010,0)), SUM(COALESCE(debh011,0)),",
               "        SUM(COALESCE(debh012,0)),  SUM(COALESCE(debh013,0)),  SUM(COALESCE(debh014,0)), SUM(COALESCE(debh015,0)), SUM(COALESCE(debh016,0)),",
               "        SUM(COALESCE(debh018,0)),  SUM(COALESCE(debh019,0)),  SUM(COALESCE(debh020,0)), SUM(COALESCE(debh021,0)), SUM(COALESCE(debh022,0))",
               "   FROM debh_t",
               "  WHERE debhent = ",g_enterprise,
               "    AND debh002 BETWEEN ? AND ? ",
               "    AND ",l_wc,
               "    AND ",l_where,
               "  GROUP BY debhent, debhsite, debh005, debh006,",
               "           debh007, debh008,  debh009"
               
   PREPARE adep150_ins_decl_temp_prep FROM l_sql
   EXECUTE adep150_ins_decl_temp_prep USING g_sdate,g_edate
   
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "INSERT adep150_decl_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF   

   LET l_sql = "UPDATE adep150_decl_temp SET decl001 = (SELECT ooef101 FROM ooef_t WHERE ooefent = declent AND ooef001 = declsite),",
               "                             decl017 = CASE WHEN decl016 = 0 THEN 0 ELSE (decl016 / (CASE WHEN decl015 = 0 THEN decl016 ELSE decl015 END) * 100) END,",
               "                             decl023 = ",g_yearmonth,",",
               "                             decl024 = ",g_week
   PREPARE adep150_decl_upd FROM l_sql 
   EXECUTE adep150_decl_upd
   
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "UPDATE adep150_decl_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   CREATE INDEX decl_temp_01 ON adep150_decl_temp(declent,declsite,decl023,decl024)
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "CREATE INDEX adep150_decl_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   DELETE FROM adep150_decm_temp
   LET l_where = s_aooi500_sql_where(g_prog,'debisite')
   LET l_wc = cl_replace_str(p_wc,'rtjasite','debisite')
   
   LET l_sql = " INSERT INTO adep150_decm_temp( decment,  decmsite, decm005, ",
               "                                decm007,  decm008,  decm009, decm010, decm011) ",
               " SELECT debient,       debisite,      debi005, ",
               "        debi007,       debi008,       debi009,      debi010,      SUM(COALESCE(debi011,0))",
               "   FROM debi_t",
               "  WHERE debient = ",g_enterprise,
               "    AND debi002 BETWEEN ? AND ? ",
               "    AND ",l_wc,
               "    AND ",l_where,
               "  GROUP BY debient, debisite, debi005, ",
               "           debi007, debi008,  debi009, debi010"
               
   PREPARE adep150_ins_decm_temp_prep FROM l_sql
   EXECUTE adep150_ins_decm_temp_prep USING g_sdate,g_edate   
   
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "INSERT adep150_decm_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   LET l_sql = "UPDATE adep150_decm_temp SET decm001 = (SELECT ooef101 FROM ooef_t WHERE ooefent = decment AND ooef001 = decmsite),",
               "                             decm006 = (SELECT mhae002 FROM mhae_t WHERE mhaeent = decment AND mhaesite = decmsite AND mhae001 = decm005),", 
               "                             decm012 = ",g_yearmonth,",",
               "                             decm013 = ",g_week
   PREPARE adep150_decm_upd FROM l_sql 
   EXECUTE adep150_decm_upd
   
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "UPDATE adep150_decm_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   CREATE INDEX decm_temp_01 ON adep150_decm_temp(decment,decmsite,decm012,decm013)
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "CREATE INDEX adep150_decm_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF

   RETURN r_success   

END FUNCTION]]>
  </point>
  <point name="function.adep150_ins_temp6" order="26" ver="1" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adep150_ins_temp6(p_wc)
   DEFINE p_wc           STRING
   DEFINE l_wc           STRING
   DEFINE r_success      LIKE type_t.num5
   DEFINE l_sql          STRING
   DEFINE l_where        STRING
   
   LET r_success = TRUE
   DELETE FROM adep150_decn_temp
   LET l_where = s_aooi500_sql_where(g_prog,'debksite')
   LET l_wc = cl_replace_str(p_wc,'rtjasite','debksite')
   
   LET l_sql = " INSERT INTO adep150_decn_temp( decnent, decnsite,decn005, decn006,",
               "                                decn007, decn008, decn009, decn010, decn011,",
               "                                decn012, decn013, decn014, decn015, decn017,",
               "                                decn018, decn019, decn020, decn021, decn022,",
               "                                decn023) ",
               " SELECT debkent,      debksite,       debk005,      SUM(COALESCE(debk006,0)),",
               "        SUM(COALESCE(debk007,0)), SUM(COALESCE(debk008,0)), SUM(COALESCE(debk009,0)), SUM(COALESCE(debk010,0)), SUM(COALESCE(debk011,0)),",
               "        SUM(COALESCE(debk012,0)), SUM(COALESCE(debk013,0)), SUM(COALESCE(debk014,0)), SUM(COALESCE(debk015,0)), SUM(COALESCE(debk017,0)),",
               "        SUM(COALESCE(debk018,0)), SUM(COALESCE(debk019,0)), SUM(COALESCE(debk020,0)), SUM(COALESCE(debk021,0)), SUM(COALESCE(debk022,0)),",
               "        SUM(COALESCE(debk023,0)) ",
               "   FROM debk_t",
               "  WHERE debkent = ",g_enterprise,
               "    AND debk002 BETWEEN ? AND ? ",
               "    AND ",l_wc,
               "    AND ",l_where,
               "  GROUP BY debkent, debksite, debk005 "

   PREPARE adep150_ins_decn_temp_prep FROM l_sql
   EXECUTE adep150_ins_decn_temp_prep USING g_sdate,g_edate
   
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "INSERT adep150_decn_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   LET l_sql = "UPDATE adep150_decn_temp SET decn001 = (SELECT ooef101 FROM ooef_t WHERE ooefent = decnent AND ooef001 = decnsite),", 
               "                             decn016 = CASE WHEN decn015 = 0 THEN 0 ELSE (decn015 / (CASE WHEN decn011 = 0 THEN decn015 ELSE decn011 END) * 100) END,",
               "                             decn024 = ",g_yearmonth,",",
               "                             decn025 = ",g_week               
   PREPARE adep150_decn_upd FROM l_sql 
   EXECUTE adep150_decn_upd       
   
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "UPDATE adep150_decn_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   CREATE INDEX decn_temp_01 ON adep150_decn_temp(decnent,decnsite,decn024,decn025)
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "CREATE INDEX adep150_decn_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF      
   DELETE FROM adep150_deco_temp
   LET l_where = s_aooi500_sql_where(g_prog,'deblsite')
   LET l_wc = cl_replace_str(p_wc,'rtjasite','deblsite')
   
   LET l_sql = " INSERT INTO adep150_deco_temp( decoent,  decosite, deco005, deco006,",
               "                                deco007,  deco008,  deco009, deco010, deco011,",
               "                                deco012,  deco013,  deco014, deco016, deco017,",
               "                                deco018,  deco019,  deco020) ",
               " SELECT deblent,       deblsite,      debl005,      debl006, ",
               "        debl007,                   SUM(COALESCE(debl008,0)),  SUM(COALESCE(debl009,0)), SUM(COALESCE(debl010,0)), SUM(COALESCE(debl011,0)),",
               "        SUM(COALESCE(debl012,0)),  SUM(COALESCE(debl013,0)),  SUM(COALESCE(debl014,0)), SUM(COALESCE(debl016,0)), SUM(COALESCE(debl017,0)),",
               "        SUM(COALESCE(debl018,0)),  SUM(COALESCE(debl019,0)),  SUM(COALESCE(debl020,0))",
               "   FROM debl_t ",
               "  WHERE deblent = ",g_enterprise,
               "    AND debl002 BETWEEN ? AND ? ",
               "    AND ",l_wc,
               "    AND ",l_where,
               "  GROUP BY deblent, deblsite, debl005, debl006, debl007 "
                    
   PREPARE adep150_ins_deco_temp_prep FROM l_sql
   EXECUTE adep150_ins_deco_temp_prep USING g_sdate,g_edate
   
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "INSERT adep150_deco_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   LET l_sql = "UPDATE adep150_deco_temp SET deco001 = (SELECT ooef101 FROM ooef_t WHERE ooefent = decoent AND ooef001 = decosite),",
               "                             deco015 = CASE WHEN deco014 = 0 THEN 0 ELSE (deco014 / (CASE WHEN deco013 = 0 THEN deco014 ELSE deco013 END) * 100) END,",
               "                             deco021 = ",g_yearmonth,",",
               "                             deco022 = ",g_week
   PREPARE adep150_deco_upd FROM l_sql 
   EXECUTE adep150_deco_upd
   
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "UPDATE adep150_deco_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   CREATE INDEX deco_temp_01 ON adep150_deco_temp(decoent,decosite,deco021,deco022)
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "CREATE INDEX adep150_deco_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   DELETE FROM adep150_decp_temp
   LET l_where = s_aooi500_sql_where(g_prog,'debmsite')
   LET l_wc = cl_replace_str(p_wc,'rtjasite','debmsite')
   
   LET l_sql = " INSERT INTO adep150_decp_temp( decpent,  decpsite,  decp005, decp006,",
               "                                decp007,  decp008)",
               " SELECT debment,       debmsite,      debm005,      debm006,",
               "        debm007,       SUM(COALESCE(debm008,0))",
               "   FROM debm_t",
               "  WHERE debment = ",g_enterprise,
               "    AND debm002 BETWEEN ? AND ? ",
               "    AND ",l_wc,
               "    AND ",l_where,
               "  GROUP BY debment, debmsite, debm005, debm006,  debm007"
               
   PREPARE adep150_ins_decp_temp_prep FROM l_sql
   EXECUTE adep150_ins_decp_temp_prep USING g_sdate,g_edate
   
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "INSERT adep150_decp_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   LET l_sql = "UPDATE adep150_decp_temp SET decp001 = (SELECT ooef101 FROM ooef_t WHERE ooefent = decpent AND ooef001 = decpsite),",
               "                             decp009 = ",g_yearmonth,",",
               "                             decp010 = ",g_week
   PREPARE adep150_decp_upd FROM l_sql 
   EXECUTE adep150_decp_upd
   
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "UPDATE adep150_decp_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   CREATE INDEX decp_temp_01 ON adep150_decp_temp(decpent,decpsite,decp009,decp010)
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "CREATE INDEX adep150_decp_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF

   RETURN r_success  
END FUNCTION]]>
  </point>
  <point name="function.adep150_ins_temp7" order="27" ver="1" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adep150_ins_temp7(p_wc)
   DEFINE p_wc           STRING
   DEFINE l_wc           STRING
   DEFINE r_success      LIKE type_t.num5
   DEFINE l_sql          STRING
   DEFINE l_where        STRING
   
   LET r_success = TRUE
   DELETE FROM adep150_decq_temp
   LET l_where = s_aooi500_sql_where(g_prog,'debosite')
   LET l_wc = cl_replace_str(p_wc,'rtjasite','debosite')
   
   LET l_sql = " INSERT INTO adep150_decq_temp( decqent, decqsite,decq005, decq006,",
               "                                decq007, decq008, decq009, decq010, decq011,",
               "                                decq012, decq013, decq014, decq016, decq017,",
               "                                decq018, decq019, decq020, decq023, decq024)",
               " SELECT deboent,                  debosite,                 SUM(COALESCE(debo005,0)), SUM(COALESCE(debo006,0)),",
               "        SUM(COALESCE(debo007,0)), SUM(COALESCE(debo008,0)), SUM(COALESCE(debo009,0)), SUM(COALESCE(debo010,0)), SUM(COALESCE(debo011,0)),",
               "        SUM(COALESCE(debo012,0)), SUM(COALESCE(debo013,0)), SUM(COALESCE(debo014,0)), SUM(COALESCE(debo016,0)), SUM(COALESCE(debo017,0)),",
               "        SUM(COALESCE(debo018,0)), SUM(COALESCE(debo019,0)), SUM(COALESCE(debo020,0)), SUM(COALESCE(debo023,0)), SUM(COALESCE(debo024,0)) ",
               "   FROM debo_t",
               "  WHERE deboent = ",g_enterprise,
               "    AND debo002 BETWEEN ? AND ? ",
               "    AND ",l_wc,
               "    AND ",l_where,
               "  GROUP BY deboent, debosite "
               
   PREPARE adep150_ins_decq_temp_prep FROM l_sql
   EXECUTE adep150_ins_decq_temp_prep USING g_sdate,g_edate
   
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "INSERT adep150_decq_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   LET l_sql = "UPDATE adep150_decq_temp SET decq001 = (SELECT ooef101 FROM ooef_t WHERE ooefent = decqent AND ooef001 = decqsite),",
               "                             decq015 = CASE WHEN decq014 = 0 THEN 0 ELSE (decq014 / (CASE WHEN decq010 = 0 THEN decq014 ELSE decq010 END) * 100) END,",
               "                             decq027 = decq010 / (CASE WHEN decq016 = 0 THEN 1 ELSE decq016 END), ",
               "                             decq025 = ",g_yearmonth,",",
               "                             decq026 = ",g_week
               
   PREPARE adep150_decq_upd FROM l_sql 
   EXECUTE adep150_decq_upd
   
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "UPDATE adep150_decq_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   CREATE INDEX decq_temp_01 ON adep150_decq_temp(decqent,decqsite,decq025,decq026)
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "CREATE INDEX adep150_decq_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF      
   DELETE FROM adep150_decr_temp
   LET l_where = s_aooi500_sql_where(g_prog,'debpsite')
   LET l_wc = cl_replace_str(p_wc,'rtjasite','debpsite')
   LET l_sql = " INSERT INTO adep150_decr_temp( decrent,  decrsite, decr005, decr006,",
               "                                decr007,  decr008,  decr009, decr010, decr011,",
               "                                decr012,  decr013,  decr015, decr016, decr017,",
               "                                decr018,  decr019)",
               " SELECT debpent,       debpsite,         debp005,      debp006,",
               "        SUM(COALESCE(debp007,0)),  SUM(COALESCE(debp008,0)),  SUM(COALESCE(debp009,0)), SUM(COALESCE(debp010,0)), SUM(COALESCE(debp011,0)),",
               "        SUM(COALESCE(debp012,0)),  SUM(COALESCE(debp013,0)),  SUM(COALESCE(debp015,0)), SUM(COALESCE(debp016,0)), SUM(COALESCE(debp017,0)),",
               "        SUM(COALESCE(debp018,0)),  SUM(COALESCE(debp019,0))",
               "   FROM debp_t",
               "  WHERE debpent = ",g_enterprise,
               "    AND debp002 BETWEEN ? AND ? ",
               "    AND ",l_wc,
               "    AND ",l_where,
               "  GROUP BY debpent, debpsite, debp005, debp006 "

   PREPARE adep150_ins_decr_temp_prep FROM l_sql
   EXECUTE adep150_ins_decr_temp_prep USING g_sdate,g_edate

   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "INSERT adep150_decr_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   LET l_sql = "UPDATE adep150_decr_temp SET decr001 = (SELECT ooef101 FROM ooef_t WHERE ooefent = decrent AND ooef001 = decrsite),",
               "                             decr014 = CASE WHEN decr013 = 0 THEN 0 ELSE (decr013 / (CASE WHEN decr012 = 0 THEN decr013 ELSE decr012 END) * 100) END,",
               "                             decr022 = decr012 / (CASE WHEN decr016 = 0 THEN 1 ELSE decr016 END), ",
               "                             decr020 = ",g_yearmonth,",",
               "                             decr021 = ",g_week
   PREPARE adep150_decr_upd FROM l_sql 
   EXECUTE adep150_decr_upd

   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "UPDATE adep150_decr_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   CREATE INDEX decr_temp_01 ON adep150_decr_temp(decrent,decrsite,decr020,decr021)
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "CREATE INDEX adep150_decr_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   DELETE FROM adep150_decs_temp
   LET l_where = s_aooi500_sql_where(g_prog,'debqsite')
   LET l_wc = cl_replace_str(p_wc,'rtjasite','debqsite')
   
   LET l_sql = " INSERT INTO adep150_decs_temp( decsent,  decssite,  decs005, decs006, decs007) ",
               " SELECT debqent,       debqsite,        debq005,      debq006,  SUM(COALESCE(debq007,0))",
               "   FROM debq_t",
               "  WHERE debqent = ",g_enterprise,
               "    AND debq002 BETWEEN ? AND ? ",
               "    AND ",l_wc,
               "    AND ",l_where,
               "  GROUP BY debqent, debqsite,  debq005, debq006 "

   PREPARE adep150_ins_decs_temp_prep FROM l_sql
   EXECUTE adep150_ins_decs_temp_prep USING g_sdate,g_edate
   
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "INSERT adep150_decs_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   LET l_sql = "UPDATE adep150_decs_temp SET decs001 = (SELECT ooef101 FROM ooef_t WHERE ooefent = decsent AND ooef001 = decssite),",
               "                             decs008 = ",g_yearmonth,",",
               "                             decs009 = ",g_week
   PREPARE adep150_decs_upd FROM l_sql 
   EXECUTE adep150_decs_upd
   
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "UPDATE adep150_decs_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   CREATE INDEX decs_temp_01 ON adep150_decs_temp(decsent,decssite,decs008,decs009)
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "CREATE INDEX adep150_decs_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF

   RETURN r_success 
END FUNCTION]]>
  </point>
  <point name="function.adep150_ins_temp9" order="28" ver="1" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adep150_ins_temp9(p_wc)
   DEFINE p_wc           STRING
   DEFINE l_wc           STRING
   DEFINE r_success      LIKE type_t.num5
   DEFINE l_sql          STRING
   DEFINE l_where        STRING
   DEFINE l_init_date    LIKE type_t.dat
   
   LET r_success = TRUE
   DELETE FROM adep150_decv_temp
   LET l_where = s_aooi500_sql_where(g_prog,'debysite')
   LET l_wc = cl_replace_str(p_wc,'rtjasite','debysite')
   
   LET l_sql = " INSERT INTO adep150_decv_temp( decvent, decvsite,decv002, decv004,",
               "                                decv005, decv006, decv007, decv008, decv009,",
               "                                decv010, decv011, decv012, decv013, decv014,",
               "                                decv015, decv016, decv017, decv018 ) ",
               " SELECT debyent,               debysite,                 deby002,                    SUM(COALESCE(deby004,0)),",
               "        deby005,               SUM(COALESCE(deby006,0)), COALESCE(deby007,?),        COALESCE(deby008,' '),    COALESCE(deby009,' '),     ",
               "        COALESCE(deby010,' '), deby011,                  SUM(COALESCE(deby012,0)),   COALESCE(deby013,' '),    SUM(COALESCE(deby014,0)),",
               "        COALESCE(deby015,' '), SUM(COALESCE(deby016,0)), SUM(COALESCE(deby017,0)),   SUM(COALESCE(deby018,0)) ",
               "   FROM deby_t ",
               "  WHERE debyent = ",g_enterprise,
               "    AND deby003 BETWEEN ? AND ? ",
               "    AND ",l_wc,
               "    AND ",l_where,
               "  GROUP BY debyent, debysite, deby002, deby005,",
               "           deby007, deby008,  deby009, deby010, deby011,",
               "           deby013, deby015 "
               
   PREPARE adep150_ins_decv_temp_prep FROM l_sql
   EXECUTE adep150_ins_decv_temp_prep USING l_init_date,g_sdate,g_edate
   
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "INSERT adep150_decv_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   LET l_sql = "UPDATE adep150_decv_temp SET decv001 = (SELECT ooia002 FROM ooia_t WHERE ooiaent = decvent AND ooia001 = decv002),",
               "                             decv019 = ",g_yearmonth,",",
               "                             decv020 = ",g_week
   PREPARE adep150_decv_upd FROM l_sql 
   EXECUTE adep150_decv_upd

   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "UPDATE adep150_decv_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   CREATE INDEX decv_temp_01 ON adep150_decv_temp(decvent,decvsite,decv019,decv020)
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "CREATE INDEX adep150_decv_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF      
   DELETE FROM adep150_decw_temp
   LET l_where = s_aooi500_sql_where(g_prog,'debzsite')
   LET l_wc = cl_replace_str(p_wc,'rtjasite','debzsite')
   
   LET l_sql = " INSERT INTO adep150_decw_temp( decwent,  decwsite, decw005, ",
               "                                decw007,  decw008,  decw009, decw010, decw011,",
               "                                decw012,  decw013,  decw014, decw015, decw016,",
               "                                decw017,  decw018) ",
               " SELECT debzent,                   debzsite,                  debz005, ",
               "        debz007,                   debz008,                   SUM(COALESCE(debz009,0)), SUM(COALESCE(debz010,0)), SUM(COALESCE(debz011,0)),",
               "        SUM(COALESCE(debz012,0)),  SUM(COALESCE(debz013,0)),  debz014 ,                 SUM(COALESCE(debz015,0)), SUM(COALESCE(debz016,0)),",
               "        SUM(COALESCE(debz017,0)),  debz018 ",
               "   FROM debz_t ",
               "  WHERE debzent = ",g_enterprise,
               "    AND debz002 BETWEEN ? AND ? ",
               "    AND ",l_wc,
               "    AND ",l_where,
               "  GROUP BY debzent, debzsite, debz005, ",
               "           debz007, debz008,  debz014, debz018"
               
   PREPARE adep150_ins_decw_temp_prep FROM l_sql
   EXECUTE adep150_ins_decw_temp_prep USING g_sdate,g_edate   
   
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "INSERT adep150_decw_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   

   LET l_sql = "UPDATE adep150_decw_temp SET decw001 = (SELECT ooef101 FROM ooef_t WHERE ooefent = decwent AND ooef001 = decwsite),",
               "                             decw006 = (SELECT mhae002 FROM mhae_t WHERE mhaeent = decwent AND mhaesite = decwsite AND mhae001 = decw005), ", 
               "                             decw019 = ",g_yearmonth,",",
               "                             decw020 = ",g_week
   PREPARE adep150_decw_upd FROM l_sql 
   EXECUTE adep150_decw_upd
   
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "UPDATE adep150_decw_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   CREATE INDEX decw_temp_01 ON adep150_decw_temp(decwent,decwsite,decw019,decw020)
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "CREATE INDEX adep150_decw_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   RETURN r_success   
END FUNCTION]]>
  </point>
  <point name="function.adep150_process10" order="29" ver="1" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#門店單品月結
PRIVATE FUNCTION adep150_process10(p_del)
   DEFINE p_del               LIKE type_t.chr1 
   DEFINE r_success           LIKE type_t.num5
   DEFINE l_debusite          LIKE debu_t.debusite
   DEFINE l_debu002           LIKE debu_t.debu002
   DEFINE l_debu003           LIKE debu_t.debu003
   DEFINE l_dedesite          LIKE dede_t.dedesite
   DEFINE l_dede035           LIKE dede_t.dede035
   DEFINE l_dede036           LIKE dede_t.dede036
   
   LET r_success = TRUE  
   
   #debu_t已結轉資料 
   DECLARE adep150_debu_cs1 CURSOR FOR
    SELECT DISTINCT a.debusite,a.debu002,a.debu003
      FROM adep150_debu_temp a
     WHERE EXISTS (SELECT 1 FROM debu_t b
             WHERE b.debuent  = a.debuent
               AND b.debusite = a.debusite
               AND b.debu002  = a.debu002 
               AND b.debu003  = a.debu003 ) 

   #dede_t已結轉資料
   DECLARE adep150_dede_cs1 CURSOR FOR
    SELECT DISTINCT a.dedesite,a.dede035,a.dede036
      FROM adep150_dede_temp a
     WHERE EXISTS (SELECT 1 FROM dede_t b
                    WHERE a.dedeent  = b.dedeent    
                      AND a.dedesite = b.dedesite   
                      AND a.dede035  = b.dede035    
                      AND a.dede036  = b.dede036)  
       AND NOT EXISTS (SELECT 1 FROM adep150_debu_temp c 
                        WHERE a.dedeent  = c.debuent
                          AND a.dedesite = c.debusite
                          AND a.dede035  = c.debu002 
                          AND a.dede036  = c.debu003 )

   IF p_del = "Y" THEN

      FOREACH adep150_debu_cs1 INTO l_debusite,l_debu002,l_debu003
         INITIALIZE g_errparam TO NULL
         LET g_errparam.replace[1] = l_debusite
         LET g_errparam.replace[2] = l_debu002
         LET g_errparam.replace[3] = l_debu003
         LET g_errparam.code = 'ade-00123'
         LET g_errparam.popup = TRUE
         CALL cl_err()
      END FOREACH

      #刪除已結轉資料
      LET g_sql = "DELETE FROM debu_t a ",
                  " WHERE EXISTS (SELECT 1 FROM adep150_debu_temp b ",
                  "         WHERE a.debuent  = b.debuent ",
                  "           AND a.debusite = b.debusite",
                  "           AND a.debu002  = b.debu002 ", 
                  "           AND a.debu003  = b.debu003 )" 
      PREPARE adep150_del_debu_prep1 FROM g_sql
      EXECUTE adep150_del_debu_prep1

      #塞資料                  
      INSERT INTO debu_t ( debuent, debusite,debu001, debu002, debu003,
                           debu004, debu005, debu006, debu007, debu008,
                           debu009, debu010, debu011, debu012, debu013,
                           debu014, debu015, debu016, debu017, debu018,
                           debu019, debu020, debu021, debu022, debu023,
                           debu024, debu025, debu026, debu027, debu028,
                           debu029, debu030, debu031, debu032, debu033,
                           debu034, debu035, debu036, debu037, debu038,
                           debu039, debu040, debu041, debu042, debu043,
                           debu044, debu045)
      SELECT debuent, debusite,debu001, debu002, debu003,
             debu004, debu005, debu006, debu007, debu008,
             debu009, debu010, debu011, debu012, debu013,
             debu014, debu015, debu016, debu017, debu018,
             debu019, debu020, debu021, debu022, debu023,
             debu024, debu025, debu026, debu027, debu028,
             debu029, debu030, debu031, debu032, debu033,
             debu034, debu035, debu036, debu037, debu038,
             debu039, debu040, debu041, debu042, debu043,
             debu044, debu045
        FROM adep150_debu_temp

      IF SQLCA.SQLcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "ins debu_t"
         LET g_errparam.popup = TRUE
         CALL cl_err()
         LET r_success = FALSE
         RETURN r_success
      END IF

      FOREACH adep150_dede_cs1 INTO l_dedesite,l_dede035,l_dede036
         INITIALIZE g_errparam TO NULL
         LET g_errparam.replace[1] = l_dedesite
         LET g_errparam.replace[2] = l_dede035
         LET g_errparam.replace[3] = l_dede036
         LET g_errparam.code = 'ade-00123'
         LET g_errparam.popup = TRUE
         CALL cl_err()
      END FOREACH

      #刪除已結轉資料
      LET g_sql = "DELETE FROM dede_t a ",
                  " WHERE EXISTS (SELECT 1 FROM adep150_dede_temp b ",
                  "                WHERE b.dedeent  = a.dedeent ",
                  "                  AND b.dedesite = a.dedesite",
                  "                  AND b.dede035  = a.dede035 ",
                  "                  AND b.dede036  = a.dede036)"
      PREPARE adep150_del_dede_prep1 FROM g_sql
      EXECUTE adep150_del_dede_prep1

      #塞資料                  
      INSERT INTO dede_t ( dedeent,  dedesite, dede001, dede005, dede006,
                           dede007,  dede008,  dede009, dede010, dede011,
                           dede012,  dede013,  dede014, dede015, dede016,
                           dede017,  dede018,  dede019, dede020, dede021,   
                           dede022,  dede023,  dede024, dede025, dede026,
                           dede027,  dede028,  dede029, dede030, dede031, 
                           dede032,  dede033,  dede034, dede035, dede036,
                           dede037,  dede038)
      SELECT dedeent,  dedesite, dede001, dede005, dede006,
             dede007,  dede008,  dede009, dede010, dede011,
             dede012,  dede013,  dede014, dede015, dede016,
             dede017,  dede018,  dede019, dede020, dede021,   
             dede022,  dede023,  dede024, dede025, dede026,
             dede027,  dede028,  dede029, dede030, dede031, 
             dede032,  dede033,  dede034, dede035, dede036,
             dede037,  dede038
        FROM adep150_dede_temp

      IF SQLCA.SQLcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "ins dede_t"
         LET g_errparam.popup = TRUE
         CALL cl_err()
         LET r_success = FALSE
         RETURN r_success
      END IF
   ELSE
      FOREACH adep150_debu_cs1 INTO l_debusite,l_debu002,l_debu003
         INITIALIZE g_errparam TO NULL
         LET g_errparam.replace[1] = l_debusite
         LET g_errparam.replace[2] = l_debu002
         LET g_errparam.replace[3] = l_debu003
         LET g_errparam.code = 'ade-00124'
         LET g_errparam.popup = TRUE
         CALL cl_err()
      END FOREACH

      #塞資料
      #塞資料                  
      INSERT INTO debu_t ( debuent, debusite,debu001, debu002, debu003,
                           debu004, debu005, debu006, debu007, debu008,
                           debu009, debu010, debu011, debu012, debu013,
                           debu014, debu015, debu016, debu017, debu018,
                           debu019, debu020, debu021, debu022, debu023,
                           debu024, debu025, debu026, debu027, debu028,
                           debu029, debu030, debu031, debu032, debu033,
                           debu034, debu035, debu036, debu037, debu038,
                           debu039, debu040, debu041, debu042, debu043,
                           debu044, debu045)
      SELECT a.debuent, a.debusite, a.debu001, a.debu002, a.debu003,
             a.debu004, a.debu005,  a.debu006, a.debu007, a.debu008,
             a.debu009, a.debu010,  a.debu011, a.debu012, a.debu013,
             a.debu014, a.debu015,  a.debu016, a.debu017, a.debu018,
             a.debu019, a.debu020,  a.debu021, a.debu022, a.debu023,
             a.debu024, a.debu025,  a.debu026, a.debu027, a.debu028,
             a.debu029, a.debu030,  a.debu031, a.debu032, a.debu033,
             a.debu034, a.debu035,  a.debu036, a.debu037, a.debu038,
             a.debu039, a.debu040,  a.debu041, a.debu042, a.debu043,
             a.debu044, a.debu045
        FROM adep150_debu_temp a
       WHERE NOT EXISTS (SELECT 1 FROM debu_t b
                          WHERE b.debuent  = a.debuent
                            AND b.debusite = a.debusite
                            AND b.debu002  = a.debu002 
                            AND b.debu003  = a.debu003 ) 

      IF SQLCA.SQLcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "ins debu_t"
         LET g_errparam.popup = TRUE
         CALL cl_err()
         LET r_success = FALSE
         RETURN r_success
      END IF

      FOREACH adep150_dede_cs1 INTO l_dedesite,l_dede035,l_dede036
         INITIALIZE g_errparam TO NULL
         LET g_errparam.replace[1] = l_dedesite
         LET g_errparam.replace[2] = l_dede035
         LET g_errparam.replace[3] = l_dede036
         LET g_errparam.code = 'ade-00124'
         LET g_errparam.popup = TRUE
         CALL cl_err()
      END FOREACH


      INSERT INTO dede_t ( dedeent,  dedesite, dede001, dede005, dede006,
                           dede007,  dede008,  dede009, dede010, dede011,
                           dede012,  dede013,  dede014, dede015, dede016,
                           dede017,  dede018,  dede019, dede020, dede021,   
                           dede022,  dede023,  dede024, dede025, dede026,
                           dede027,  dede028,  dede029, dede030, dede031, 
                           dede032,  dede033,  dede034, dede035, dede036,
                           dede037,  dede038)
      SELECT a.dedeent,  a.dedesite, a.dede001, a.dede005, a.dede006,
             a.dede007,  a.dede008,  a.dede009, a.dede010, a.dede011,
             a.dede012,  a.dede013,  a.dede014, a.dede015, a.dede016,
             a.dede017,  a.dede018,  a.dede019, a.dede020, a.dede021,   
             a.dede022,  a.dede023,  a.dede024, a.dede025, a.dede026,
             a.dede027,  a.dede028,  a.dede029, a.dede030, a.dede031, 
             a.dede032,  a.dede033,  a.dede034, a.dede035, a.dede036,
             a.dede037,  a.dede038
        FROM adep150_dede_temp a 
       WHERE NOT EXISTS (SELECT 1 FROM dede_t b
                          WHERE a.dedeent  = b.dedeent    
                            AND a.dedesite = b.dedesite   
                            AND a.dede035  = b.dede035    
                            AND a.dede036  = b.dede036)  
      IF SQLCA.SQLcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "ins dede_t"
         LET g_errparam.popup = TRUE
         CALL cl_err()
         LET r_success = FALSE
         RETURN r_success
      END IF

   END IF  
   
   RETURN r_success
END FUNCTION]]>
  </point>
  <point name="function.adep150_process11" order="30" ver="1" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#門店品類月結
PRIVATE FUNCTION adep150_process11(p_del)
   DEFINE p_del               LIKE type_t.chr1
   DEFINE r_success           LIKE type_t.num5
   DEFINE l_dedqsite          LIKE dedq_t.dedqsite
   DEFINE l_dedq034           LIKE dedq_t.dedq034
   DEFINE l_dedq035           LIKE dedq_t.dedq035
   DEFINE l_dedrsite          LIKE dedr_t.dedrsite
   DEFINE l_dedr025           LIKE dedr_t.dedr025
   DEFINE l_dedr026           LIKE dedr_t.dedr026
   
   LET r_success = TRUE  
   
   #dedq_t已結轉資料 
   DECLARE adep150_dedq_cs1 CURSOR FOR
    SELECT DISTINCT a.dedqsite,a.dedq034,a.dedq035
      FROM adep150_dedq_temp a
     WHERE EXISTS (SELECT 1 FROM dedq_t b
             WHERE b.dedqent  = a.dedqent
               AND b.dedqsite = a.dedqsite
               AND b.dedq034  = a.dedq034 
               AND b.dedq035  = a.dedq035 ) 

   #dedr_t已結轉資料
   DECLARE adep150_dedr_cs1 CURSOR FOR
    SELECT DISTINCT a.dedrsite,a.dedr025,a.dedr026
      FROM adep150_dedr_temp a
     WHERE EXISTS (SELECT 1 FROM dedr_t b
                    WHERE a.dedrent  = b.dedrent    
                      AND a.dedrsite = b.dedrsite   
                      AND a.dedr025  = b.dedr025    
                      AND a.dedr026  = b.dedr026)  
       AND NOT EXISTS (SELECT 1 FROM adep150_dedq_temp c 
                        WHERE a.dedrent  = c.dedqent
                          AND a.dedrsite = c.dedqsite
                          AND a.dedr025  = c.dedq034 
                          AND a.dedr026  = c.dedq035 )

   IF p_del = "Y" THEN

      FOREACH adep150_dedq_cs1 INTO l_dedqsite,l_dedq034,l_dedq035
         INITIALIZE g_errparam TO NULL
         LET g_errparam.replace[1] = l_dedqsite
         LET g_errparam.replace[2] = l_dedq034
         LET g_errparam.replace[3] = l_dedq035
         LET g_errparam.code = 'ade-00123'
         LET g_errparam.popup = TRUE
         CALL cl_err()
      END FOREACH

      #刪除已結轉資料
      LET g_sql = "DELETE FROM dedq_t a ",
                  " WHERE EXISTS (SELECT 1 FROM adep150_dedq_temp b ",
                  "         WHERE a.dedqent  = b.dedqent ",
                  "           AND a.dedqsite = b.dedqsite",
                  "           AND a.dedq034  = b.dedq034 ", 
                  "           AND a.dedq035  = b.dedq035 )" 
      PREPARE adep150_del_dedq_prep1 FROM g_sql
      EXECUTE adep150_del_dedq_prep1

      #塞資料                  
      INSERT INTO dedq_t ( dedqent, dedqsite,dedq001, dedq005, dedq006,
                           dedq007, dedq008, dedq009, dedq010, dedq011,
                           dedq012, dedq013, dedq014, dedq015, dedq016,
                           dedq017, dedq018, dedq019, dedq020, dedq021,
                           dedq022, dedq023, dedq024, dedq025, dedq026,
                           dedq027, dedq028, dedq029, dedq030, dedq031,
                           dedq032, dedq033, dedq034, dedq035, dedq036,
                           dedq037)
      SELECT dedqent, dedqsite,dedq001, dedq005, dedq006,
             dedq007, dedq008, dedq009, dedq010, dedq011,
             dedq012, dedq013, dedq014, dedq015, dedq016,
             dedq017, dedq018, dedq019, dedq020, dedq021,
             dedq022, dedq023, dedq024, dedq025, dedq026,
             dedq027, dedq028, dedq029, dedq030, dedq031,
             dedq032, dedq033, dedq034, dedq035, dedq036,
             dedq037
        FROM adep150_dedq_temp

      IF SQLCA.SQLcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "ins dedq_t"
         LET g_errparam.popup = TRUE
         CALL cl_err()
         LET r_success = FALSE
         RETURN r_success
      END IF

      FOREACH adep150_dedr_cs1 INTO l_dedrsite,l_dedr025,l_dedr026
         INITIALIZE g_errparam TO NULL
         LET g_errparam.replace[1] = l_dedrsite
         LET g_errparam.replace[2] = l_dedr025
         LET g_errparam.replace[3] = l_dedr026
         LET g_errparam.code = 'ade-00123'
         LET g_errparam.popup = TRUE
         CALL cl_err()
      END FOREACH

      #刪除已結轉資料
      LET g_sql = "DELETE FROM dedr_t a ",
                  " WHERE EXISTS (SELECT 1 FROM adep150_dedr_temp b ",
                  "                WHERE b.dedrent  = a.dedrent ",
                  "                  AND b.dedrsite = a.dedrsite",
                  "                  AND b.dedr025  = a.dedr025 ",
                  "                  AND b.dedr026  = a.dedr026)"
      PREPARE adep150_del_dedr_prep1 FROM g_sql
      EXECUTE adep150_del_dedr_prep1

      #塞資料                  
      INSERT INTO dedr_t ( dedrent,  dedrsite, dedr001, dedr005, dedr006,
                           dedr007,  dedr008,  dedr009, dedr010, dedr011,
                           dedr012,  dedr013,  dedr014, dedr015, dedr016,
                           dedr017,  dedr018,  dedr019, dedr020, dedr021,   
                           dedr022,  dedr023,  dedr024, dedr025, dedr026,
                           dedr027,  dedr028)
      SELECT dedrent,  dedrsite, dedr001, dedr005, dedr006,
             dedr007,  dedr008,  dedr009, dedr010, dedr011,
             dedr012,  dedr013,  dedr014, dedr015, dedr016,
             dedr017,  dedr018,  dedr019, dedr020, dedr021,   
             dedr022,  dedr023,  dedr024, dedr025, dedr026,
             dedr027,  dedr028
        FROM adep150_dedr_temp

      IF SQLCA.SQLcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "ins dedr_t"
         LET g_errparam.popup = TRUE
         CALL cl_err()
         LET r_success = FALSE
         RETURN r_success
      END IF
   ELSE
      FOREACH adep150_dedq_cs1 INTO l_dedqsite,l_dedq034,l_dedq035
         INITIALIZE g_errparam TO NULL
         LET g_errparam.replace[1] = l_dedqsite
         LET g_errparam.replace[2] = l_dedq034
         LET g_errparam.replace[3] = l_dedq035
         LET g_errparam.code = 'ade-00124'
         LET g_errparam.popup = TRUE
         CALL cl_err()
      END FOREACH

      #塞資料
      INSERT INTO dedq_t ( dedqent, dedqsite,dedq001, dedq005, dedq006,
                           dedq007, dedq008, dedq009, dedq010, dedq011,
                           dedq012, dedq013, dedq014, dedq015, dedq016,
                           dedq017, dedq018, dedq019, dedq020, dedq021,
                           dedq022, dedq023, dedq024, dedq025, dedq026,
                           dedq027, dedq028, dedq029, dedq030, dedq031,
                           dedq032, dedq033, dedq034, dedq035, dedq036,
                           dedq037 )
      SELECT a.dedqent, a.dedqsite, a.dedq001, a.dedq005, a.dedq006,
             a.dedq007, a.dedq008,  a.dedq009, a.dedq010, a.dedq011,
             a.dedq012, a.dedq013,  a.dedq014, a.dedq015, a.dedq016,
             a.dedq017, a.dedq018,  a.dedq019, a.dedq020, a.dedq021,
             a.dedq022, a.dedq023,  a.dedq024, a.dedq025, a.dedq026,
             a.dedq027, a.dedq028,  a.dedq029, a.dedq030, a.dedq031,
             a.dedq032, a.dedq033,  a.dedq034, a.dedq035, a.dedq036,
             a.dedq037
        FROM adep150_dedq_temp a
       WHERE NOT EXISTS (SELECT 1 FROM dedq_t b
                          WHERE b.dedqent  = a.dedqent
                            AND b.dedqsite = a.dedqsite
                            AND b.dedq034  = a.dedq034 
                            AND b.dedq035  = a.dedq035 ) 

      IF SQLCA.SQLcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "ins dedq_t"
         LET g_errparam.popup = TRUE
         CALL cl_err()
         LET r_success = FALSE
         RETURN r_success
      END IF

      FOREACH adep150_dedr_cs1 INTO l_dedrsite,l_dedr025,l_dedr026
         INITIALIZE g_errparam TO NULL
         LET g_errparam.replace[1] = l_dedrsite
         LET g_errparam.replace[2] = l_dedr025
         LET g_errparam.replace[3] = l_dedr026
         LET g_errparam.code = 'ade-00124'
         LET g_errparam.popup = TRUE
         CALL cl_err()
      END FOREACH


      INSERT INTO dedr_t ( dedrent,  dedrsite, dedr001, dedr005, dedr006,
                           dedr007,  dedr008,  dedr009, dedr010, dedr011,
                           dedr012,  dedr013,  dedr014, dedr015, dedr016,
                           dedr017,  dedr018,  dedr019, dedr020, dedr021,   
                           dedr022,  dedr023,  dedr024, dedr025, dedr026,
                           dedr027,  dedr028)
      SELECT a.dedrent,  a.dedrsite, a.dedr001, a.dedr005, a.dedr006,
             a.dedr007,  a.dedr008,  a.dedr009, a.dedr010, a.dedr011,
             a.dedr012,  a.dedr013,  a.dedr014, a.dedr015, a.dedr016,
             a.dedr017,  a.dedr018,  a.dedr019, a.dedr020, a.dedr021,   
             a.dedr022,  a.dedr023,  a.dedr024, a.dedr025, a.dedr026,
             a.dedr027,  a.dedr028
        FROM adep150_dedr_temp a 
       WHERE NOT EXISTS (SELECT 1 FROM dedr_t b
                          WHERE a.dedrent  = b.dedrent    
                            AND a.dedrsite = b.dedrsite   
                            AND a.dedr025  = b.dedr025    
                            AND a.dedr026  = b.dedr026)  
      IF SQLCA.SQLcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "ins dedr_t"
         LET g_errparam.popup = TRUE
         CALL cl_err()
         LET r_success = FALSE
         RETURN r_success
      END IF

   END IF  
   
   RETURN r_success
   
END FUNCTION]]>
  </point>
  <point name="function.adep150_process13" order="31" ver="1" cite_std="N" new="Y" status="d" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="function.adep150_process14" order="31" ver="1" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#門店庫區月結
PRIVATE FUNCTION adep150_process14(p_del)
   DEFINE p_del               LIKE type_t.chr1
   DEFINE r_success           LIKE type_t.num5
   DEFINE l_dedfsite          LIKE dedf_t.dedfsite
   DEFINE l_dedf031           LIKE dedf_t.dedf031
   DEFINE l_dedf032           LIKE dedf_t.dedf032
   DEFINE l_dedgsite          LIKE dedg_t.dedgsite
   DEFINE l_dedg027           LIKE dedg_t.dedg027
   DEFINE l_dedg028           LIKE dedg_t.dedg028
   DEFINE l_dedhsite          LIKE dedh_t.dedhsite
   DEFINE l_dedh015           LIKE dedh_t.dedh015
   DEFINE l_dedh016           LIKE dedh_t.dedh016
   
   LET r_success = TRUE  
   
   #dedf_t已結轉資料 
   DECLARE adep150_dedf_cs1 CURSOR FOR
    SELECT DISTINCT a.dedfsite,a.dedf031,a.dedf032
      FROM adep150_dedf_temp a
     WHERE EXISTS (SELECT 1 FROM dedf_t b
             WHERE b.dedfent  = a.dedfent
               AND b.dedfsite = a.dedfsite
               AND b.dedf031  = a.dedf031 
               AND b.dedf032  = a.dedf032 ) 

   #dedg_t已結轉資料
   DECLARE adep150_dedg_cs1 CURSOR FOR
    SELECT DISTINCT a.dedgsite,a.dedg027,a.dedg028
      FROM adep150_dedg_temp a
     WHERE EXISTS (SELECT 1 FROM dedg_t b
                    WHERE a.dedgent  = b.dedgent    
                      AND a.dedgsite = b.dedgsite   
                      AND a.dedg027  = b.dedg027    
                      AND a.dedg028  = b.dedg028)  
       AND NOT EXISTS (SELECT 1 FROM adep150_dedf_temp c 
                        WHERE a.dedgent  = c.dedfent
                          AND a.dedgsite = c.dedfsite
                          AND a.dedg027  = c.dedf031 
                          AND a.dedg028  = c.dedf032 )

   #dedh_t已結轉資料
   DECLARE adep150_dedh_cs1 CURSOR FOR
    SELECT DISTINCT a.dedhsite,a.dedh015,a.dedh016
      FROM adep150_dedh_temp a
     WHERE EXISTS (SELECT 1 FROM dedh_t b
                    WHERE a.dedhent  = b.dedhent    
                      AND a.dedhsite = b.dedhsite   
                      AND a.dedh015  = b.dedh015    
                      AND a.dedh016  = b.dedh016)  
       AND NOT EXISTS (SELECT 1 FROM adep150_dedf_temp c 
                        WHERE a.dedhent  = c.dedfent
                          AND a.dedhsite = c.dedfsite
                          AND a.dedh015  = c.dedf031 
                          AND a.dedh016  = c.dedf032 )

   IF p_del = "Y" THEN

      FOREACH adep150_dedf_cs1 INTO l_dedfsite,l_dedf031,l_dedf032
         INITIALIZE g_errparam TO NULL
         LET g_errparam.replace[1] = l_dedfsite
         LET g_errparam.replace[2] = l_dedf031
         LET g_errparam.replace[3] = l_dedf032
         LET g_errparam.code = 'ade-00123'
         LET g_errparam.popup = TRUE
         CALL cl_err()
      END FOREACH

      #刪除已結轉資料
      LET g_sql = "DELETE FROM dedf_t a ",
                  " WHERE EXISTS (SELECT 1 FROM adep150_dedf_temp b ",
                  "         WHERE a.dedfent  = b.dedfent ",
                  "           AND a.dedfsite = b.dedfsite",
                  "           AND a.dedf031  = b.dedf031 ", 
                  "           AND a.dedf032  = b.dedf032 )" 
      PREPARE adep150_del_dedf_prep1 FROM g_sql
      EXECUTE adep150_del_dedf_prep1

      #塞資料                  
      INSERT INTO dedf_t ( dedfent, dedfsite,dedf001, dedf005, dedf006,
                           dedf007, dedf008, dedf009, dedf010, dedf011,
                           dedf012, dedf013, dedf014, dedf015, dedf016,
                           dedf017, dedf018, dedf019, dedf020, dedf021,
                           dedf022, dedf023, dedf024, dedf025, dedf026,
                           dedf027, dedf028, dedf029, dedf030, dedf031,
                           dedf032, dedf033)
      SELECT dedfent, dedfsite,dedf001, dedf005, dedf006,
             dedf007, dedf008, dedf009, dedf010, dedf011,
             dedf012, dedf013, dedf014, dedf015, dedf016,
             dedf017, dedf018, dedf019, dedf020, dedf021,
             dedf022, dedf023, dedf024, dedf025, dedf026,
             dedf027, dedf028, dedf029, dedf030, dedf031,
             dedf032, dedf033
        FROM adep150_dedf_temp

      IF SQLCA.SQLcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "ins dedf_t"
         LET g_errparam.popup = TRUE
         CALL cl_err()
         LET r_success = FALSE
         RETURN r_success
      END IF

      FOREACH adep150_dedg_cs1 INTO l_dedgsite,l_dedg027,l_dedg028
         INITIALIZE g_errparam TO NULL
         LET g_errparam.replace[1] = l_dedgsite
         LET g_errparam.replace[2] = l_dedg027
         LET g_errparam.replace[3] = l_dedg028
         LET g_errparam.code = 'ade-00123'
         LET g_errparam.popup = TRUE
         CALL cl_err()
      END FOREACH

      #刪除已結轉資料
      LET g_sql = "DELETE FROM dedg_t a ",
                  " WHERE EXISTS (SELECT 1 FROM adep150_dedg_temp b ",
                  "                WHERE b.dedgent  = a.dedgent ",
                  "                  AND b.dedgsite = a.dedgsite",
                  "                  AND b.dedg027  = a.dedg027 ",
                  "                  AND b.dedg028  = a.dedg028)"
      PREPARE adep150_del_dedg_prep1 FROM g_sql
      EXECUTE adep150_del_dedg_prep1

      #塞資料                  
      INSERT INTO dedg_t ( dedgent,  dedgsite, dedg001, dedg005, dedg006,
                           dedg007,  dedg008,  dedg009, dedg010, dedg011,
                           dedg012,  dedg013,  dedg014, dedg015, dedg016,
                           dedg017,  dedg018,  dedg019, dedg020, dedg021,   
                           dedg022,  dedg023,  dedg024, dedg025, dedg026,
                           dedg027,  dedg028,  dedg029)
      SELECT dedgent,  dedgsite, dedg001, dedg005, dedg006,
             dedg007,  dedg008,  dedg009, dedg010, dedg011,
             dedg012,  dedg013,  dedg014, dedg015, dedg016,
             dedg017,  dedg018,  dedg019, dedg020, dedg021,   
             dedg022,  dedg023,  dedg024, dedg025, dedg026,
             dedg027,  dedg028,  dedg029
        FROM adep150_dedg_temp

      IF SQLCA.SQLcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "ins dedg_t"
         LET g_errparam.popup = TRUE
         CALL cl_err()
         LET r_success = FALSE
         RETURN r_success
      END IF

      FOREACH adep150_dedh_cs1 INTO l_dedhsite,l_dedh015,l_dedh016
         INITIALIZE g_errparam TO NULL
         LET g_errparam.replace[1] = l_dedhsite
         LET g_errparam.replace[2] = l_dedh015
         LET g_errparam.replace[3] = l_dedh016
         LET g_errparam.code = 'ade-00123'
         LET g_errparam.popup = TRUE
         CALL cl_err()
      END FOREACH

      #刪除已結轉資料
      LET g_sql = "DELETE FROM dedh_t a ",
                  " WHERE EXISTS (SELECT 1 FROM adep150_dedh_temp b ",
                  "                WHERE b.dedhent  = a.dedhent ",
                  "                  AND b.dedhsite = a.dedhsite",
                  "                  AND b.dedh015  = a.dedh015 ",
                  "                  AND b.dedh016  = a.dedh016)"
      PREPARE adep150_del_dedh_prep1 FROM g_sql
      EXECUTE adep150_del_dedh_prep1

      #塞資料                  
      INSERT INTO dedh_t ( dedhent,  dedhsite, dedh001, dedh005, dedh006,
                           dedh007,  dedh008,  dedh009, dedh010, dedh011,
                           dedh012,  dedh013,  dedh014, dedh015, dedh016)
      SELECT dedhent,  dedhsite, dedh001, dedh005, dedh006,
             dedh007,  dedh008,  dedh009, dedh010, dedh011,
             dedh012,  dedh013,  dedh014, dedh015, dedh016 
        FROM adep150_dedh_temp

      IF SQLCA.SQLcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "ins dedh_t"
         LET g_errparam.popup = TRUE
         CALL cl_err()
         LET r_success = FALSE
         RETURN r_success
      END IF
   ELSE
      FOREACH adep150_dedf_cs1 INTO l_dedfsite,l_dedf031,l_dedf032
         INITIALIZE g_errparam TO NULL
         LET g_errparam.replace[1] = l_dedfsite
         LET g_errparam.replace[2] = l_dedf031
         LET g_errparam.replace[3] = l_dedf032
         LET g_errparam.code = 'ade-00124'
         LET g_errparam.popup = TRUE
         CALL cl_err()
      END FOREACH

      #塞資料
      INSERT INTO dedf_t ( dedfent, dedfsite,dedf001, dedf005, dedf006,
                           dedf007, dedf008, dedf009, dedf010, dedf011,
                           dedf012, dedf013, dedf014, dedf015, dedf016,
                           dedf017, dedf018, dedf019, dedf020, dedf021,
                           dedf022, dedf023, dedf024, dedf025, dedf026,
                           dedf027, dedf028, dedf029, dedf030, dedf031,
                           dedf032, dedf033)
      SELECT a.dedfent, a.dedfsite, a.dedf001, a.dedf005, a.dedf006,
             a.dedf007, a.dedf008,  a.dedf009, a.dedf010, a.dedf011,
             a.dedf012, a.dedf013,  a.dedf014, a.dedf015, a.dedf016,
             a.dedf017, a.dedf018,  a.dedf019, a.dedf020, a.dedf021,
             a.dedf022, a.dedf023,  a.dedf024, a.dedf025, a.dedf026,
             a.dedf027, a.dedf028,  a.dedf029, a.dedf030, a.dedf031,
             a.dedf032, a.dedf033
        FROM adep150_dedf_temp a
       WHERE NOT EXISTS (SELECT 1 FROM dedf_t b
                          WHERE b.dedfent  = a.dedfent
                            AND b.dedfsite = a.dedfsite
                            AND b.dedf031  = a.dedf031 
                            AND b.dedf032  = a.dedf032 ) 

      IF SQLCA.SQLcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "ins dedf_t"
         LET g_errparam.popup = TRUE
         CALL cl_err()
         LET r_success = FALSE
         RETURN r_success
      END IF

      FOREACH adep150_dedg_cs1 INTO l_dedgsite,l_dedg027,l_dedg028
         INITIALIZE g_errparam TO NULL
         LET g_errparam.replace[1] = l_dedgsite
         LET g_errparam.replace[2] = l_dedg027
         LET g_errparam.replace[3] = l_dedg028
         LET g_errparam.code = 'ade-00124'
         LET g_errparam.popup = TRUE
         CALL cl_err()
      END FOREACH


      INSERT INTO dedg_t ( dedgent,  dedgsite, dedg001, dedg005, dedg006,
                           dedg007,  dedg008,  dedg009, dedg010, dedg011,
                           dedg012,  dedg013,  dedg014, dedg015, dedg016,
                           dedg017,  dedg018,  dedg019, dedg020, dedg021,   
                           dedg022,  dedg023,  dedg024, dedg025, dedg026,
                           dedg027,  dedg028,  dedg029)
      SELECT a.dedgent,  a.dedgsite, a.dedg001, a.dedg005, a.dedg006,
             a.dedg007,  a.dedg008,  a.dedg009, a.dedg010, a.dedg011,
             a.dedg012,  a.dedg013,  a.dedg014, a.dedg015, a.dedg016,
             a.dedg017,  a.dedg018,  a.dedg019, a.dedg020, a.dedg021,   
             a.dedg022,  a.dedg023,  a.dedg024, a.dedg025, a.dedg026,
             a.dedg027,  a.dedg028,  a. dedg029
        FROM adep150_dedg_temp a 
       WHERE NOT EXISTS (SELECT 1 FROM dedg_t b
                          WHERE a.dedgent  = b.dedgent    
                            AND a.dedgsite = b.dedgsite   
                            AND a.dedg027  = b.dedg027    
                            AND a.dedg028  = b.dedg028)  
      IF SQLCA.SQLcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "ins dedg_t"
         LET g_errparam.popup = TRUE
         CALL cl_err()
         LET r_success = FALSE
         RETURN r_success
      END IF

      FOREACH adep150_dedh_cs1 INTO l_dedhsite,l_dedh015,l_dedh016
         INITIALIZE g_errparam TO NULL
         LET g_errparam.replace[1] = l_dedhsite
         LET g_errparam.replace[2] = l_dedh015
         LET g_errparam.replace[3] = l_dedh016
         LET g_errparam.code = 'ade-00124'
         LET g_errparam.popup = TRUE
         CALL cl_err()
      END FOREACH

      #塞資料                  
      INSERT INTO dedh_t ( dedhent,  dedhsite, dedh001, dedh005, dedh006,
                           dedh007,  dedh008,  dedh009, dedh010, dedh011,
                           dedh012,  dedh013,  dedh014, dedh015, dedh016)
      SELECT dedhent,  dedhsite, dedh001, dedh005, dedh006,
             dedh007,  dedh008,  dedh009, dedh010, dedh011,
             dedh012,  dedh013,  dedh014, dedh015, dedh016 
        FROM adep150_dedh_temp
       WHERE NOT EXISTS (SELECT 1 FROM dedh_t b
                          WHERE a.dedhent  = b.dedhent    
                            AND a.dedhsite = b.dedhsite   
                            AND a.dedh015  = b.dedh015    
                            AND a.dedh016  = b.dedh016)  

      IF SQLCA.SQLcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "ins dedh_t"
         LET g_errparam.popup = TRUE
         CALL cl_err()
         LET r_success = FALSE
         RETURN r_success
      END IF

   END IF  
   
   RETURN r_success
END FUNCTION]]>
  </point>
  <point name="function.adep150_process15" order="32" ver="1" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#門店專櫃週結
PRIVATE FUNCTION adep150_process15(p_del)
   DEFINE p_del               LIKE type_t.chr1
   DEFINE r_success           LIKE type_t.num5
   DEFINE l_dedisite          LIKE dedi_t.dedisite
   DEFINE l_dedi027           LIKE dedi_t.dedi027
   DEFINE l_dedi028           LIKE dedi_t.dedi028
   DEFINE l_dedjsite          LIKE dedj_t.dedjsite
   DEFINE l_dedj023           LIKE dedj_t.dedj023
   DEFINE l_dedj024           LIKE dedj_t.dedj024
   DEFINE l_dedksite          LIKE dedk_t.dedksite
   DEFINE l_dedk012           LIKE dedk_t.dedk012
   DEFINE l_dedk013           LIKE dedk_t.dedk013
   
   LET r_success = TRUE  
   
   #dedi_t已結轉資料 
   DECLARE adep150_dedi_cs1 CURSOR FOR
    SELECT DISTINCT a.dedisite,a.dedi027,a.dedi028
      FROM adep150_dedi_temp a
     WHERE EXISTS (SELECT 1 FROM dedi_t b
             WHERE b.dedient  = a.dedient
               AND b.dedisite = a.dedisite
               AND b.dedi027  = a.dedi027 
               AND b.dedi028  = a.dedi028 ) 

   #dedj_t已結轉資料
   DECLARE adep150_dedj_cs1 CURSOR FOR
    SELECT DISTINCT a.dedjsite,a.dedj023,a.dedj024
      FROM adep150_dedj_temp a
     WHERE EXISTS (SELECT 1 FROM dedj_t b
                    WHERE a.dedjent  = b.dedjent    
                      AND a.dedjsite = b.dedjsite   
                      AND a.dedj023  = b.dedj023    
                      AND a.dedj024  = b.dedj024)  
       AND NOT EXISTS (SELECT 1 FROM adep150_dedi_temp c 
                        WHERE a.dedjent  = c.dedient
                          AND a.dedjsite = c.dedisite
                          AND a.dedj023  = c.dedi027 
                          AND a.dedj024  = c.dedi028 )

   #dedk_t已結轉資料
   DECLARE adep150_dedk_cs1 CURSOR FOR
    SELECT DISTINCT a.dedksite,a.dedk012,a.dedk013
      FROM adep150_dedk_temp a
     WHERE EXISTS (SELECT 1 FROM dedk_t b
                    WHERE a.dedkent  = b.dedkent    
                      AND a.dedksite = b.dedksite   
                      AND a.dedk012  = b.dedk012    
                      AND a.dedk013  = b.dedk013)  
       AND NOT EXISTS (SELECT 1 FROM adep150_dedi_temp c 
                        WHERE a.dedkent  = c.dedient
                          AND a.dedksite = c.dedisite
                          AND a.dedk012  = c.dedi027 
                          AND a.dedk013  = c.dedi028 )

   IF p_del = "Y" THEN

      FOREACH adep150_dedi_cs1 INTO l_dedisite,l_dedi027,l_dedi028
         INITIALIZE g_errparam TO NULL
         LET g_errparam.replace[1] = l_dedisite
         LET g_errparam.replace[2] = l_dedi027
         LET g_errparam.replace[3] = l_dedi028
         LET g_errparam.code = 'ade-00123'
         LET g_errparam.popup = TRUE
         CALL cl_err()
      END FOREACH

      #刪除已結轉資料
      LET g_sql = "DELETE FROM dedi_t a ",
                  " WHERE EXISTS (SELECT 1 FROM adep150_dedi_temp b ",
                  "         WHERE a.dedient  = b.dedient ",
                  "           AND a.dedisite = b.dedisite",
                  "           AND a.dedi027  = b.dedi027 ", 
                  "           AND a.dedi028  = b.dedi028 )" 
      PREPARE adep150_del_dedi_prep1 FROM g_sql
      EXECUTE adep150_del_dedi_prep1

      #塞資料                  
      INSERT INTO dedi_t ( dedient, dedisite,dedi001, dedi005, dedi006,
                           dedi007, dedi008, dedi009, dedi010, dedi011,
                           dedi012, dedi013, dedi014, dedi015, dedi016,
                           dedi017, dedi018, dedi019, dedi020, dedi021,
                           dedi022, dedi023, dedi024, dedi025, dedi026,
                           dedi027, dedi028)
      SELECT dedient, dedisite,dedi001, dedi005, dedi006,
             dedi007, dedi008, dedi009, dedi010, dedi011,
             dedi012, dedi013, dedi014, dedi015, dedi016,
             dedi017, dedi018, dedi019, dedi020, dedi021,
             dedi022, dedi023, dedi024, dedi025, dedi026,
             dedi027, dedi028
        FROM adep150_dedi_temp

      IF SQLCA.SQLcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "ins dedi_t"
         LET g_errparam.popup = TRUE
         CALL cl_err()
         LET r_success = FALSE
         RETURN r_success
      END IF

      FOREACH adep150_dedj_cs1 INTO l_dedjsite,l_dedj023,l_dedj024
         INITIALIZE g_errparam TO NULL
         LET g_errparam.replace[1] = l_dedjsite
         LET g_errparam.replace[2] = l_dedj023
         LET g_errparam.replace[3] = l_dedj024
         LET g_errparam.code = 'ade-00123'
         LET g_errparam.popup = TRUE
         CALL cl_err()
      END FOREACH

      #刪除已結轉資料
      LET g_sql = "DELETE FROM dedj_t a ",
                  " WHERE EXISTS (SELECT 1 FROM adep150_dedj_temp b ",
                  "                WHERE b.dedjent  = a.dedjent ",
                  "                  AND b.dedjsite = a.dedjsite",
                  "                  AND b.dedj023  = a.dedj023 ",
                  "                  AND b.dedj024  = a.dedj024)"
      PREPARE adep150_del_dedj_prep1 FROM g_sql
      EXECUTE adep150_del_dedj_prep1

      #塞資料                  
      INSERT INTO dedj_t ( dedjent,  dedjsite, dedj001, dedj005, dedj006,
                           dedj007,  dedj008,  dedj009, dedj010, dedj011,
                           dedj012,  dedj013,  dedj014, dedj015, dedj016,
                           dedj017,  dedj018,  dedj019, dedj020, dedj021,   
                           dedj022,  dedj023,  dedj024)
      SELECT dedjent,  dedjsite, dedj001, dedj005, dedj006,
             dedj007,  dedj008,  dedj009, dedj010, dedj011,
             dedj012,  dedj013,  dedj014, dedj015, dedj016,
             dedj017,  dedj018,  dedj019, dedj020, dedj021,   
             dedj022,  dedj023,  dedj024
        FROM adep150_dedj_temp

      IF SQLCA.SQLcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "ins dedj_t"
         LET g_errparam.popup = TRUE
         CALL cl_err()
         LET r_success = FALSE
         RETURN r_success
      END IF

      FOREACH adep150_dedk_cs1 INTO l_dedksite,l_dedk012,l_dedk013
         INITIALIZE g_errparam TO NULL
         LET g_errparam.replace[1] = l_dedksite
         LET g_errparam.replace[2] = l_dedk012
         LET g_errparam.replace[3] = l_dedk013
         LET g_errparam.code = 'ade-00123'
         LET g_errparam.popup = TRUE
         CALL cl_err()
      END FOREACH

      #刪除已結轉資料
      LET g_sql = "DELETE FROM dedk_t a ",
                  " WHERE EXISTS (SELECT 1 FROM adep150_dedk_temp b ",
                  "                WHERE b.dedkent  = a.dedkent ",
                  "                  AND b.dedksite = a.dedksite",
                  "                  AND b.dedk012  = a.dedk012 ",
                  "                  AND b.dedk013  = a.dedk013)"
      PREPARE adep150_del_dedk_prep1 FROM g_sql
      EXECUTE adep150_del_dedk_prep1

      #塞資料                  
      INSERT INTO dedk_t ( dedkent,  dedksite, dedk001, dedk005, dedk006,
                           dedk007,  dedk008,  dedk009, dedk010, dedk011,
                           dedk012,  dedk013)
      SELECT dedkent,  dedksite, dedk001, dedk005, dedk006,
             dedk007,  dedk008,  dedk009, dedk010, dedk011,
             dedk012,  dedk013
        FROM adep150_dedk_temp

      IF SQLCA.SQLcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "ins dedk_t"
         LET g_errparam.popup = TRUE
         CALL cl_err()
         LET r_success = FALSE
         RETURN r_success
      END IF
   ELSE
      FOREACH adep150_dedi_cs1 INTO l_dedisite,l_dedi027,l_dedi028
         INITIALIZE g_errparam TO NULL
         LET g_errparam.replace[1] = l_dedisite
         LET g_errparam.replace[2] = l_dedi027
         LET g_errparam.replace[3] = l_dedi028
         LET g_errparam.code = 'ade-00124'
         LET g_errparam.popup = TRUE
         CALL cl_err()
      END FOREACH

      #塞資料
      INSERT INTO dedi_t ( dedient, dedisite,dedi001, dedi005, dedi006,
                           dedi007, dedi008, dedi009, dedi010, dedi011,
                           dedi012, dedi013, dedi014, dedi015, dedi016,
                           dedi017, dedi018, dedi019, dedi020, dedi021,
                           dedi022, dedi023, dedi024, dedi025, dedi026,
                           dedi027, dedi028)
      SELECT a.dedient, a.dedisite, a.dedi001, a.dedi005, a.dedi006,
             a.dedi007, a.dedi008,  a.dedi009, a.dedi010, a.dedi011,
             a.dedi012, a.dedi013,  a.dedi014, a.dedi015, a.dedi016,
             a.dedi017, a.dedi018,  a.dedi019, a.dedi020, a.dedi021,
             a.dedi022, a.dedi023,  a.dedi024, a.dedi025, a.dedi026,
             a.dedi027, a.dedi028
        FROM adep150_dedi_temp a
       WHERE NOT EXISTS (SELECT 1 FROM dedi_t b
                          WHERE b.dedient  = a.dedient
                            AND b.dedisite = a.dedisite
                            AND b.dedi027  = a.dedi027 
                            AND b.dedi028  = a.dedi028 ) 

      IF SQLCA.SQLcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "ins dedi_t"
         LET g_errparam.popup = TRUE
         CALL cl_err()
         LET r_success = FALSE
         RETURN r_success
      END IF

      FOREACH adep150_dedj_cs1 INTO l_dedjsite,l_dedj023,l_dedj024
         INITIALIZE g_errparam TO NULL
         LET g_errparam.replace[1] = l_dedjsite
         LET g_errparam.replace[2] = l_dedj023
         LET g_errparam.replace[3] = l_dedj024
         LET g_errparam.code = 'ade-00124'
         LET g_errparam.popup = TRUE
         CALL cl_err()
      END FOREACH


      INSERT INTO dedj_t ( dedjent,  dedjsite, dedj001, dedj005, dedj006,
                           dedj007,  dedj008,  dedj009, dedj010, dedj011,
                           dedj012,  dedj013,  dedj014, dedj015, dedj016,
                           dedj017,  dedj018,  dedj019, dedj020, dedj021,   
                           dedj022,  dedj023,  dedj024)
      SELECT a.dedjent,  a.dedjsite, a.dedj001, a.dedj005, a.dedj006,
             a.dedj007,  a.dedj008,  a.dedj009, a.dedj010, a.dedj011,
             a.dedj012,  a.dedj013,  a.dedj014, a.dedj015, a.dedj016,
             a.dedj017,  a.dedj018,  a.dedj019, a.dedj020, a.dedj021,   
             a.dedj022,  a.dedj023,  a.dedj024
        FROM adep150_dedj_temp a 
       WHERE NOT EXISTS (SELECT 1 FROM dedj_t b
                          WHERE a.dedjent  = b.dedjent    
                            AND a.dedjsite = b.dedjsite   
                            AND a.dedj023  = b.dedj023    
                            AND a.dedj024  = b.dedj024)  
      IF SQLCA.SQLcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "ins dedj_t"
         LET g_errparam.popup = TRUE
         CALL cl_err()
         LET r_success = FALSE
         RETURN r_success
      END IF

      FOREACH adep150_dedk_cs1 INTO l_dedksite,l_dedk012,l_dedk013
         INITIALIZE g_errparam TO NULL
         LET g_errparam.replace[1] = l_dedksite
         LET g_errparam.replace[2] = l_dedk012
         LET g_errparam.replace[3] = l_dedk013
         LET g_errparam.code = 'ade-00124'
         LET g_errparam.popup = TRUE
         CALL cl_err()
      END FOREACH

      #塞資料                  
      INSERT INTO dedk_t ( dedkent,  dedksite, dedk001, dedk005, dedk006,
                           dedk007,  dedk008,  dedk009, dedk010, dedk011,
                           dedk012,  dedk013)
      SELECT dedkent,  dedksite, dedk001, dedk005, dedk006,
             dedk007,  dedk008,  dedk009, dedk010, dedk011,
             dedk012,  dedk013
        FROM adep150_dedk_temp
       WHERE NOT EXISTS (SELECT 1 FROM dedk_t b
                          WHERE a.dedkent  = b.dedkent    
                            AND a.dedksite = b.dedksite   
                            AND a.dedk012  = b.dedk012    
                            AND a.dedk013  = b.dedk013)  

      IF SQLCA.SQLcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "ins dedk_t"
         LET g_errparam.popup = TRUE
         CALL cl_err()
         LET r_success = FALSE
         RETURN r_success
      END IF

   END IF  
   
   RETURN r_success

END FUNCTION]]>
  </point>
  <point name="function.adep150_process16" order="33" ver="1" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#門店部門月結
PRIVATE FUNCTION adep150_process16(p_del)
   DEFINE p_del               LIKE type_t.chr1
   DEFINE r_success           LIKE type_t.num5
   DEFINE l_dedlsite          LIKE dedl_t.dedlsite
   DEFINE l_dedl024           LIKE dedl_t.dedl024
   DEFINE l_dedl025           LIKE dedl_t.dedl025
   DEFINE l_dedmsite          LIKE dedm_t.dedmsite
   DEFINE l_dedm021           LIKE dedm_t.dedm021
   DEFINE l_dedm022           LIKE dedm_t.dedm022
   DEFINE l_dednsite          LIKE dedn_t.dednsite
   DEFINE l_dedn009           LIKE dedn_t.dedn009
   DEFINE l_dedn010           LIKE dedn_t.dedn010
   
   LET r_success = TRUE  
   
   #dedl_t已結轉資料 
   DECLARE adep150_dedl_cs1 CURSOR FOR
    SELECT DISTINCT a.dedlsite,a.dedl024,a.dedl025
      FROM adep150_dedl_temp a
     WHERE EXISTS (SELECT 1 FROM dedl_t b
             WHERE b.dedlent  = a.dedlent
               AND b.dedlsite = a.dedlsite
               AND b.dedl024  = a.dedl024 
               AND b.dedl025  = a.dedl025 ) 

   #dedm_t已結轉資料
   DECLARE adep150_dedm_cs1 CURSOR FOR
    SELECT DISTINCT a.dedmsite,a.dedm021,a.dedm022
      FROM adep150_dedm_temp a
     WHERE EXISTS (SELECT 1 FROM dedm_t b
                    WHERE a.dedment  = b.dedment    
                      AND a.dedmsite = b.dedmsite   
                      AND a.dedm021  = b.dedm021    
                      AND a.dedm022  = b.dedm022)  
       AND NOT EXISTS (SELECT 1 FROM adep150_dedl_temp c 
                        WHERE a.dedment  = c.dedlent
                          AND a.dedmsite = c.dedlsite
                          AND a.dedm021  = c.dedl024 
                          AND a.dedm022  = c.dedl025 )

   #dedn_t已結轉資料
   DECLARE adep150_dedn_cs1 CURSOR FOR
    SELECT DISTINCT a.dednsite,a.dedn009,a.dedn010
      FROM adep150_dedn_temp a
     WHERE EXISTS (SELECT 1 FROM dedn_t b
                    WHERE a.dednent  = b.dednent    
                      AND a.dednsite = b.dednsite   
                      AND a.dedn009  = b.dedn009    
                      AND a.dedn010  = b.dedn010)  
       AND NOT EXISTS (SELECT 1 FROM adep150_dedl_temp c 
                        WHERE a.dednent  = c.dedlent
                          AND a.dednsite = c.dedlsite
                          AND a.dedn009  = c.dedl024 
                          AND a.dedn010  = c.dedl025 )

   IF p_del = "Y" THEN

      FOREACH adep150_dedl_cs1 INTO l_dedlsite,l_dedl024,l_dedl025
         INITIALIZE g_errparam TO NULL
         LET g_errparam.replace[1] = l_dedlsite
         LET g_errparam.replace[2] = l_dedl024
         LET g_errparam.replace[3] = l_dedl025
         LET g_errparam.code = 'ade-00123'
         LET g_errparam.popup = TRUE
         CALL cl_err()
      END FOREACH

      #刪除已結轉資料
      LET g_sql = "DELETE FROM dedl_t a ",
                  " WHERE EXISTS (SELECT 1 FROM adep150_dedl_temp b ",
                  "         WHERE a.dedlent  = b.dedlent ",
                  "           AND a.dedlsite = b.dedlsite",
                  "           AND a.dedl024  = b.dedl024 ", 
                  "           AND a.dedl025  = b.dedl025 )" 
      PREPARE adep150_del_dedl_prep1 FROM g_sql
      EXECUTE adep150_del_dedl_prep1

      #塞資料                  
      INSERT INTO dedl_t ( dedlent, dedlsite,dedl001, dedl005, dedl006,
                           dedl007, dedl008, dedl009, dedl010, dedl011,
                           dedl012, dedl013, dedl014, dedl015, dedl016,
                           dedl017, dedl018, dedl019, dedl020, dedl021,
                           dedl022, dedl023, dedl024, dedl025)
      SELECT dedlent, dedlsite,dedl001, dedl005, dedl006,
             dedl007, dedl008, dedl009, dedl010, dedl011,
             dedl012, dedl013, dedl014, dedl015, dedl016,
             dedl017, dedl018, dedl019, dedl020, dedl021,
             dedl022, dedl023, dedl024, dedl025
        FROM adep150_dedl_temp

      IF SQLCA.SQLcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "ins dedl_t"
         LET g_errparam.popup = TRUE
         CALL cl_err()
         LET r_success = FALSE
         RETURN r_success
      END IF

      FOREACH adep150_dedm_cs1 INTO l_dedmsite,l_dedm021,l_dedm022
         INITIALIZE g_errparam TO NULL
         LET g_errparam.replace[1] = l_dedmsite
         LET g_errparam.replace[2] = l_dedm021
         LET g_errparam.replace[3] = l_dedm022
         LET g_errparam.code = 'ade-00123'
         LET g_errparam.popup = TRUE
         CALL cl_err()
      END FOREACH

      #刪除已結轉資料
      LET g_sql = "DELETE FROM dedm_t a ",
                  " WHERE EXISTS (SELECT 1 FROM adep150_dedm_temp b ",
                  "                WHERE b.dedment  = a.dedment ",
                  "                  AND b.dedmsite = a.dedmsite",
                  "                  AND b.dedm021  = a.dedm021 ",
                  "                  AND b.dedm022  = a.dedm022)"
      PREPARE adep150_del_dedm_prep1 FROM g_sql
      EXECUTE adep150_del_dedm_prep1

      #塞資料                  
      INSERT INTO dedm_t ( dedment,  dedmsite, dedm001, dedm005, dedm006,
                           dedm007,  dedm008,  dedm009, dedm010, dedm011,
                           dedm012,  dedm013,  dedm014, dedm015, dedm016,
                           dedm017,  dedm018,  dedm019, dedm020, dedm021,   
                           dedm022)
      SELECT dedment,  dedmsite, dedm001, dedm005, dedm006,
             dedm007,  dedm008,  dedm009, dedm010, dedm011,
             dedm012,  dedm013,  dedm014, dedm015, dedm016,
             dedm017,  dedm018,  dedm019, dedm020, dedm021,   
             dedm022
        FROM adep150_dedm_temp

      IF SQLCA.SQLcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "ins dedm_t"
         LET g_errparam.popup = TRUE
         CALL cl_err()
         LET r_success = FALSE
         RETURN r_success
      END IF

      FOREACH adep150_dedn_cs1 INTO l_dednsite,l_dedn009,l_dedn010
         INITIALIZE g_errparam TO NULL
         LET g_errparam.replace[1] = l_dednsite
         LET g_errparam.replace[2] = l_dedn009
         LET g_errparam.replace[3] = l_dedn010
         LET g_errparam.code = 'ade-00123'
         LET g_errparam.popup = TRUE
         CALL cl_err()
      END FOREACH

      #刪除已結轉資料
      LET g_sql = "DELETE FROM dedn_t a ",
                  " WHERE EXISTS (SELECT 1 FROM adep150_dedn_temp b ",
                  "                WHERE b.dednent  = a.dednent ",
                  "                  AND b.dednsite = a.dednsite",
                  "                  AND b.dedn009  = a.dedn009 ",
                  "                  AND b.dedn010  = a.dedn010)"
      PREPARE adep150_del_dedn_prep1 FROM g_sql
      EXECUTE adep150_del_dedn_prep1

      #塞資料                  
      INSERT INTO dedn_t ( dednent,  dednsite, dedn001, dedn005, dedn006,
                           dedn007,  dedn008,  dedn009, dedn010)
      SELECT dednent,  dednsite, dedn001, dedn005, dedn006,
             dedn007,  dedn008,  dedn009, dedn010
        FROM adep150_dedn_temp

      IF SQLCA.SQLcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "ins dedn_t"
         LET g_errparam.popup = TRUE
         CALL cl_err()
         LET r_success = FALSE
         RETURN r_success
      END IF
   ELSE
      FOREACH adep150_dedl_cs1 INTO l_dedlsite,l_dedl024,l_dedl025
         INITIALIZE g_errparam TO NULL
         LET g_errparam.replace[1] = l_dedlsite
         LET g_errparam.replace[2] = l_dedl024
         LET g_errparam.replace[3] = l_dedl025
         LET g_errparam.code = 'ade-00124'
         LET g_errparam.popup = TRUE
         CALL cl_err()
      END FOREACH

      #塞資料
      INSERT INTO dedl_t ( dedlent, dedlsite,dedl001, dedl005, dedl006,
                           dedl007, dedl008, dedl009, dedl010, dedl011,
                           dedl012, dedl013, dedl014, dedl015, dedl016,
                           dedl017, dedl018, dedl019, dedl020, dedl021,
                           dedl022, dedl023, dedl024, dedl025)
      SELECT a.dedlent, a.dedlsite, a.dedl001, a.dedl005, a.dedl006,
             a.dedl007, a.dedl008,  a.dedl009, a.dedl010, a.dedl011,
             a.dedl012, a.dedl013,  a.dedl014, a.dedl015, a.dedl016,
             a.dedl017, a.dedl018,  a.dedl019, a.dedl020, a.dedl021,
             a.dedl022, a.dedl023,  a.dedl024, a.dedl025
        FROM adep150_dedl_temp a
       WHERE NOT EXISTS (SELECT 1 FROM dedl_t b
                          WHERE b.dedlent  = a.dedlent
                            AND b.dedlsite = a.dedlsite
                            AND b.dedl024  = a.dedl024 
                            AND b.dedl025  = a.dedl025 ) 

      IF SQLCA.SQLcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "ins dedl_t"
         LET g_errparam.popup = TRUE
         CALL cl_err()
         LET r_success = FALSE
         RETURN r_success
      END IF

      FOREACH adep150_dedm_cs1 INTO l_dedmsite,l_dedm021,l_dedm022
         INITIALIZE g_errparam TO NULL
         LET g_errparam.replace[1] = l_dedmsite
         LET g_errparam.replace[2] = l_dedm021
         LET g_errparam.replace[3] = l_dedm022
         LET g_errparam.code = 'ade-00124'
         LET g_errparam.popup = TRUE
         CALL cl_err()
      END FOREACH


      INSERT INTO dedm_t ( dedment,  dedmsite, dedm001, dedm005, dedm006,
                           dedm007,  dedm008,  dedm009, dedm010, dedm011,
                           dedm012,  dedm013,  dedm014, dedm015, dedm016,
                           dedm017,  dedm018,  dedm019, dedm020, dedm021,   
                           dedm022)
      SELECT a.dedment,  a.dedmsite, a.dedm001, a.dedm005, a.dedm006,
             a.dedm007,  a.dedm008,  a.dedm009, a.dedm010, a.dedm011,
             a.dedm012,  a.dedm013,  a.dedm014, a.dedm015, a.dedm016,
             a.dedm017,  a.dedm018,  a.dedm019, a.dedm020, a.dedm021,   
             a.dedm022
        FROM adep150_dedm_temp a 
       WHERE NOT EXISTS (SELECT 1 FROM dedm_t b
                          WHERE a.dedment  = b.dedment    
                            AND a.dedmsite = b.dedmsite   
                            AND a.dedm021  = b.dedm021    
                            AND a.dedm022  = b.dedm022)  
      IF SQLCA.SQLcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "ins dedm_t"
         LET g_errparam.popup = TRUE
         CALL cl_err()
         LET r_success = FALSE
         RETURN r_success
      END IF

      FOREACH adep150_dedn_cs1 INTO l_dednsite,l_dedn009,l_dedn010
         INITIALIZE g_errparam TO NULL
         LET g_errparam.replace[1] = l_dednsite
         LET g_errparam.replace[2] = l_dedn009
         LET g_errparam.replace[3] = l_dedn010
         LET g_errparam.code = 'ade-00124'
         LET g_errparam.popup = TRUE
         CALL cl_err()
      END FOREACH

      #塞資料                  
      INSERT INTO dedn_t ( dednent,  dednsite, dedn001, dedn005, dedn006,
                           dedn007,  dedn008,  dedn009, dedn010)
      SELECT dednent,  dednsite, dedn001, dedn005, dedn006,
             dedn007,  dedn008,  dedn009, dedn010
        FROM adep150_dedn_temp
       WHERE NOT EXISTS (SELECT 1 FROM dedn_t b
                          WHERE a.dednent  = b.dednent    
                            AND a.dednsite = b.dednsite   
                            AND a.dedn009  = b.dedn009    
                            AND a.dedn010  = b.dedn010)  

      IF SQLCA.SQLcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "ins dedn_t"
         LET g_errparam.popup = TRUE
         CALL cl_err()
         LET r_success = FALSE
         RETURN r_success
      END IF

   END IF  
   
   RETURN r_success

END FUNCTION]]>
  </point>
  <point name="function.adep150_process17" order="34" ver="1" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#門店月結
PRIVATE FUNCTION adep150_process17(p_del)
   DEFINE p_del               LIKE type_t.chr1
   DEFINE r_success           LIKE type_t.num5
   DEFINE l_debvsite          LIKE debv_t.debvsite
   DEFINE l_debv002           LIKE debv_t.debv002
   DEFINE l_debv003           LIKE debv_t.debv003
   DEFINE l_dedosite          LIKE dedo_t.dedosite
   DEFINE l_dedo020           LIKE dedo_t.dedo020
   DEFINE l_dedo021           LIKE dedo_t.dedo021
   DEFINE l_dedpsite          LIKE dedp_t.dedpsite
   DEFINE l_dedp008           LIKE dedp_t.dedp008
   DEFINE l_dedp009           LIKE dedp_t.dedp009
   
   LET r_success = TRUE  
   
   #debv_t已結轉資料 
   DECLARE adep150_debv_cs1 CURSOR FOR
    SELECT DISTINCT a.debvsite,a.debv002,a.debv003
      FROM adep150_debv_temp a
     WHERE EXISTS (SELECT 1 FROM debv_t b
             WHERE b.debvent  = a.debvent
               AND b.debvsite = a.debvsite
               AND b.debv002  = a.debv002 
               AND b.debv003  = a.debv003 ) 

   #dedo_t已結轉資料
   DECLARE adep150_dedo_cs1 CURSOR FOR
    SELECT DISTINCT a.dedosite,a.dedo020,a.dedo021
      FROM adep150_dedo_temp a
     WHERE EXISTS (SELECT 1 FROM dedo_t b
                    WHERE a.dedoent  = b.dedoent    
                      AND a.dedosite = b.dedosite   
                      AND a.dedo020  = b.dedo020    
                      AND a.dedo021  = b.dedo021)  
       AND NOT EXISTS (SELECT 1 FROM adep150_debv_temp c 
                        WHERE a.dedoent  = c.debvent
                          AND a.dedosite = c.debvsite
                          AND a.dedo020  = c.debv002 
                          AND a.dedo021  = c.debv003 )

   #dedp_t已結轉資料
   DECLARE adep150_dedp_cs1 CURSOR FOR
    SELECT DISTINCT a.dedpsite,a.dedp008,a.dedp009
      FROM adep150_dedp_temp a
     WHERE EXISTS (SELECT 1 FROM dedp_t b
                    WHERE a.dedpent  = b.dedpent    
                      AND a.dedpsite = b.dedpsite   
                      AND a.dedp008  = b.dedp008    
                      AND a.dedp009  = b.dedp009)  
       AND NOT EXISTS (SELECT 1 FROM adep150_debv_temp c 
                        WHERE a.dedpent  = c.debvent
                          AND a.dedpsite = c.debvsite
                          AND a.dedp008  = c.debv002 
                          AND a.dedp009  = c.debv003 )

   IF p_del = "Y" THEN

      FOREACH adep150_debv_cs1 INTO l_debvsite,l_debv002,l_debv003
         INITIALIZE g_errparam TO NULL
         LET g_errparam.replace[1] = l_debvsite
         LET g_errparam.replace[2] = l_debv002
         LET g_errparam.replace[3] = l_debv003
         LET g_errparam.code = 'ade-00123'
         LET g_errparam.popup = TRUE
         CALL cl_err()
      END FOREACH

      #刪除已結轉資料
      LET g_sql = "DELETE FROM debv_t a ",
                  " WHERE EXISTS (SELECT 1 FROM adep150_debv_temp b ",
                  "         WHERE a.debvent  = b.debvent ",
                  "           AND a.debvsite = b.debvsite",
                  "           AND a.debv002  = b.debv002 ", 
                  "           AND a.debv003  = b.debv003 )" 
      PREPARE adep150_del_debv_prep1 FROM g_sql
      EXECUTE adep150_del_debv_prep1

      #塞資料                  
      INSERT INTO debv_t ( debvent, debvsite,debv001, debv002, debv003,
                           debv012, debv013, debv014, debv015, debv016,
                           debv017, debv018, debv019, debv020, debv025,
                           debv026, debv027, debv028, debv029, debv030,
                           debv031, debv032, debv033, debv034)
      SELECT debvent, debvsite,debv001, debv002, debv003,
             debv012, debv013, debv014, debv015, debv016,
             debv017, debv018, debv019, debv020, debv025,
             debv026, debv027, debv028, debv029, debv030,
             debv031, debv032, debv033, debv034
        FROM adep150_debv_temp

      IF SQLCA.SQLcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "ins debv_t"
         LET g_errparam.popup = TRUE
         CALL cl_err()
         LET r_success = FALSE
         RETURN r_success
      END IF

      FOREACH adep150_dedo_cs1 INTO l_dedosite,l_dedo020,l_dedo021
         INITIALIZE g_errparam TO NULL
         LET g_errparam.replace[1] = l_dedosite
         LET g_errparam.replace[2] = l_dedo020
         LET g_errparam.replace[3] = l_dedo021
         LET g_errparam.code = 'ade-00123'
         LET g_errparam.popup = TRUE
         CALL cl_err()
      END FOREACH

      #刪除已結轉資料
      LET g_sql = "DELETE FROM dedo_t a ",
                  " WHERE EXISTS (SELECT 1 FROM adep150_dedo_temp b ",
                  "                WHERE b.dedoent  = a.dedoent ",
                  "                  AND b.dedosite = a.dedosite",
                  "                  AND b.dedo020  = a.dedo020 ",
                  "                  AND b.dedo021  = a.dedo021)"
      PREPARE adep150_del_dedo_prep1 FROM g_sql
      EXECUTE adep150_del_dedo_prep1

      #塞資料                  
      INSERT INTO dedo_t ( dedoent,  dedosite, dedo001, dedo005, dedo006,
                           dedo007,  dedo008,  dedo009, dedo010, dedo011,
                           dedo012,  dedo013,  dedo014, dedo015, dedo016,
                           dedo017,  dedo018,  dedo019, dedo020, dedo021,
                           dedo022)   
      SELECT dedoent,  dedosite, dedo001, dedo005, dedo006,
             dedo007,  dedo008,  dedo009, dedo010, dedo011,
             dedo012,  dedo013,  dedo014, dedo015, dedo016,
             dedo017,  dedo018,  dedo019, dedo020, dedo021,
             dedo022             
        FROM adep150_dedo_temp

      IF SQLCA.SQLcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "ins dedo_t"
         LET g_errparam.popup = TRUE
         CALL cl_err()
         LET r_success = FALSE
         RETURN r_success
      END IF

      FOREACH adep150_dedp_cs1 INTO l_dedpsite,l_dedp008,l_dedp009
         INITIALIZE g_errparam TO NULL
         LET g_errparam.replace[1] = l_dedpsite
         LET g_errparam.replace[2] = l_dedp008
         LET g_errparam.replace[3] = l_dedp009
         LET g_errparam.code = 'ade-00123'
         LET g_errparam.popup = TRUE
         CALL cl_err()
      END FOREACH

      #刪除已結轉資料
      LET g_sql = "DELETE FROM dedp_t a ",
                  " WHERE EXISTS (SELECT 1 FROM adep150_dedp_temp b ",
                  "                WHERE b.dedpent  = a.dedpent ",
                  "                  AND b.dedpsite = a.dedpsite",
                  "                  AND b.dedp008  = a.dedp008 ",
                  "                  AND b.dedp009  = a.dedp009)"
      PREPARE adep150_del_dedp_prep1 FROM g_sql
      EXECUTE adep150_del_dedp_prep1

      #塞資料                  
      INSERT INTO dedp_t ( dedpent,  dedpsite, dedp001, dedp005, dedp006,
                           dedp007,  dedp008,  dedp009)
      SELECT dedpent,  dedpsite, dedp001, dedp005, dedp006,
             dedp007,  dedp008,  dedp009
        FROM adep150_dedp_temp

      IF SQLCA.SQLcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "ins dedp_t"
         LET g_errparam.popup = TRUE
         CALL cl_err()
         LET r_success = FALSE
         RETURN r_success
      END IF
   ELSE
      FOREACH adep150_debv_cs1 INTO l_debvsite,l_debv002,l_debv003
         INITIALIZE g_errparam TO NULL
         LET g_errparam.replace[1] = l_debvsite
         LET g_errparam.replace[2] = l_debv002
         LET g_errparam.replace[3] = l_debv003
         LET g_errparam.code = 'ade-00124'
         LET g_errparam.popup = TRUE
         CALL cl_err()
      END FOREACH

      #塞資料
      INSERT INTO debv_t ( debvent, debvsite,debv001, debv002, debv003,
                           debv012, debv013, debv014, debv015, debv016,
                           debv017, debv018, debv019, debv020, debv025,
                           debv026, debv027, debv028, debv029, debv030,
                           debv031, debv032, debv033, debv034)
      SELECT a.debvent, a.debvsite, a.debv001, a.debv002, a.debv003,
             a.debv012, a.debv013,  a.debv014, a.debv015, a.debv016,
             a.debv017, a.debv018,  a.debv019, a.debv020, a.debv025,
             a.debv026, a.debv027,  a.debv028, a.debv029, a.debv030,
             a.debv031, a.debv032,  a.debv033, a.debv034
        FROM adep150_debv_temp a
       WHERE NOT EXISTS (SELECT 1 FROM debv_t b
                          WHERE b.debvent  = a.debvent
                            AND b.debvsite = a.debvsite
                            AND b.debv002  = a.debv002 
                            AND b.debv003  = a.debv003 ) 

      IF SQLCA.SQLcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "ins debv_t"
         LET g_errparam.popup = TRUE
         CALL cl_err()
         LET r_success = FALSE
         RETURN r_success
      END IF

      FOREACH adep150_dedo_cs1 INTO l_dedosite,l_dedo020,l_dedo021
         INITIALIZE g_errparam TO NULL
         LET g_errparam.replace[1] = l_dedosite
         LET g_errparam.replace[2] = l_dedo020
         LET g_errparam.replace[3] = l_dedo021
         LET g_errparam.code = 'ade-00124'
         LET g_errparam.popup = TRUE
         CALL cl_err()
      END FOREACH


      INSERT INTO dedo_t ( dedoent,  dedosite, dedo001, dedo005, dedo006,
                           dedo007,  dedo008,  dedo009, dedo010, dedo011,
                           dedo012,  dedo013,  dedo014, dedo015, dedo016,
                           dedo017,  dedo018,  dedo019, dedo020, dedo021,
                           dedo022)   
      SELECT a.dedoent,  a.dedosite, a.dedo001, a.dedo005, a.dedo006,
             a.dedo007,  a.dedo008,  a.dedo009, a.dedo010, a.dedo011,
             a.dedo012,  a.dedo013,  a.dedo014, a.dedo015, a.dedo016,
             a.dedo017,  a.dedo018,  a.dedo019, a.dedo020, a.dedo021,
             a.dedo022             
        FROM adep150_dedo_temp a 
       WHERE NOT EXISTS (SELECT 1 FROM dedo_t b
                          WHERE a.dedoent  = b.dedoent    
                            AND a.dedosite = b.dedosite   
                            AND a.dedo020  = b.dedo020    
                            AND a.dedo021  = b.dedo021)  
      IF SQLCA.SQLcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "ins dedo_t"
         LET g_errparam.popup = TRUE
         CALL cl_err()
         LET r_success = FALSE
         RETURN r_success
      END IF

      FOREACH adep150_dedp_cs1 INTO l_dedpsite,l_dedp008,l_dedp009
         INITIALIZE g_errparam TO NULL
         LET g_errparam.replace[1] = l_dedpsite
         LET g_errparam.replace[2] = l_dedp008
         LET g_errparam.replace[3] = l_dedp009
         LET g_errparam.code = 'ade-00124'
         LET g_errparam.popup = TRUE
         CALL cl_err()
      END FOREACH

      #塞資料                  
      INSERT INTO dedp_t ( dedpent,  dedpsite, dedp001, dedp005, dedp006,
                           dedp007,  dedp008,  dedp009)
      SELECT dedpent,  dedpsite, dedp001, dedp005, dedp006,
             dedp007,  dedp008,  dedp009
        FROM adep150_dedp_temp
       WHERE NOT EXISTS (SELECT 1 FROM dedp_t b
                          WHERE a.dedpent  = b.dedpent    
                            AND a.dedpsite = b.dedpsite   
                            AND a.dedp008  = b.dedp008    
                            AND a.dedp009  = b.dedp009)  

      IF SQLCA.SQLcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "ins dedp_t"
         LET g_errparam.popup = TRUE
         CALL cl_err()
         LET r_success = FALSE
         RETURN r_success
      END IF

   END IF  
   
   RETURN r_success

END FUNCTION]]>
  </point>
  <point name="function.adep150_process19" order="35" ver="1" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#收入收款月結
PRIVATE FUNCTION adep150_process19(p_del)
   DEFINE p_del               LIKE type_t.chr1
   DEFINE r_success           LIKE type_t.num5
   DEFINE l_dedssite          LIKE deds_t.dedssite
   DEFINE l_deds019           LIKE deds_t.deds019
   DEFINE l_deds020           LIKE deds_t.deds020
   DEFINE l_dedtsite          LIKE dedt_t.dedtsite
   DEFINE l_dedt019           LIKE dedt_t.dedt019
   DEFINE l_dedt020           LIKE dedt_t.dedt020
   
   LET r_success = TRUE  
   
   #deds_t已結轉資料 
   DECLARE adep150_deds_cs1 CURSOR FOR
    SELECT DISTINCT a.dedssite,a.deds019,a.deds020
      FROM adep150_deds_temp a
     WHERE EXISTS (SELECT 1 FROM deds_t b
             WHERE b.dedsent  = a.dedsent
               AND b.dedssite = a.dedssite
               AND b.deds019  = a.deds019 
               AND b.deds020  = a.deds020 ) 

   #dedt_t已結轉資料
   DECLARE adep150_dedt_cs1 CURSOR FOR
    SELECT DISTINCT a.dedtsite,a.dedt019,a.dedt020
      FROM adep150_dedt_temp a
     WHERE EXISTS (SELECT 1 FROM dedt_t b
                    WHERE a.dedtent  = b.dedtent    
                      AND a.dedtsite = b.dedtsite   
                      AND a.dedt019  = b.dedt019    
                      AND a.dedt020  = b.dedt020)  
       AND NOT EXISTS (SELECT 1 FROM adep150_deds_temp c 
                        WHERE a.dedtent  = c.dedsent
                          AND a.dedtsite = c.dedssite
                          AND a.dedt019  = c.deds019 
                          AND a.dedt020  = c.deds020 )

   IF p_del = "Y" THEN

      FOREACH adep150_deds_cs1 INTO l_dedssite,l_deds019,l_deds020
         INITIALIZE g_errparam TO NULL
         LET g_errparam.replace[1] = l_dedssite
         LET g_errparam.replace[2] = l_deds019
         LET g_errparam.replace[3] = l_deds020
         LET g_errparam.code = 'ade-00123'
         LET g_errparam.popup = TRUE
         CALL cl_err()
      END FOREACH

      #刪除已結轉資料
      LET g_sql = "DELETE FROM deds_t a ",
                  " WHERE EXISTS (SELECT 1 FROM adep150_deds_temp b ",
                  "         WHERE a.dedsent  = b.dedsent ",
                  "           AND a.dedssite = b.dedssite",
                  "           AND a.deds019  = b.deds019 ", 
                  "           AND a.deds020  = b.deds020 )" 
      PREPARE adep150_del_deds_prep1 FROM g_sql
      EXECUTE adep150_del_deds_prep1

      #塞資料                  
      INSERT INTO deds_t ( dedsent, dedssite,deds001, deds002, deds004,
                           deds005, deds006, deds007, deds008, deds009,
                           deds010, deds011, deds012, deds013, deds014,
                           deds015, deds016, deds017, deds018, deds019,
                           deds020)
      SELECT dedsent, dedssite,deds001, deds002, deds004,
             deds005, deds006, deds007, deds008, deds009, 
             deds010, deds011, deds012, deds013, deds014,
             deds015, deds016, deds017, deds018, deds019,
             deds020
        FROM adep150_deds_temp

      IF SQLCA.SQLcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "ins deds_t"
         LET g_errparam.popup = TRUE
         CALL cl_err()
         LET r_success = FALSE
         RETURN r_success
      END IF

      FOREACH adep150_dedt_cs1 INTO l_dedtsite,l_dedt019,l_dedt020
         INITIALIZE g_errparam TO NULL
         LET g_errparam.replace[1] = l_dedtsite
         LET g_errparam.replace[2] = l_dedt019
         LET g_errparam.replace[3] = l_dedt020
         LET g_errparam.code = 'ade-00123'
         LET g_errparam.popup = TRUE
         CALL cl_err()
      END FOREACH

      #刪除已結轉資料
      LET g_sql = "DELETE FROM dedt_t a ",
                  " WHERE EXISTS (SELECT 1 FROM adep150_dedt_temp b ",
                  "                WHERE b.dedtent  = a.dedtent ",
                  "                  AND b.dedtsite = a.dedtsite",
                  "                  AND b.dedt019  = a.dedt019 ",
                  "                  AND b.dedt020  = a.dedt020)"
      PREPARE adep150_del_dedt_prep1 FROM g_sql
      EXECUTE adep150_del_dedt_prep1

      #塞資料                  
      INSERT INTO dedt_t ( dedtent,  dedtsite, dedt001, dedt005, dedt006,
                           dedt007,  dedt008,  dedt009, dedt010, dedt011,
                           dedt012,  dedt013,  dedt014, dedt015, dedt016,
                           dedt017,  dedt018,  dedt019, dedt020)
      SELECT dedtent,  dedtsite, dedt001, dedt005, dedt006,
             dedt007,  dedt008,  dedt009, dedt010, dedt011,
             dedt012,  dedt013,  dedt014, dedt015, dedt016,
             dedt017,  dedt018,  dedt019, dedt020
        FROM adep150_dedt_temp

      IF SQLCA.SQLcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "ins dedt_t"
         LET g_errparam.popup = TRUE
         CALL cl_err()
         LET r_success = FALSE
         RETURN r_success
      END IF
   ELSE
      FOREACH adep150_deds_cs1 INTO l_dedssite,l_deds019,l_deds020
         INITIALIZE g_errparam TO NULL
         LET g_errparam.replace[1] = l_dedssite
         LET g_errparam.replace[2] = l_deds019
         LET g_errparam.replace[3] = l_deds020
         LET g_errparam.code = 'ade-00124'
         LET g_errparam.popup = TRUE
         CALL cl_err()
      END FOREACH

      #塞資料
      INSERT INTO deds_t ( dedsent, dedssite,deds001, deds002, deds004,
                           deds005, deds006, deds007, deds008, deds009,
                           deds010, deds011, deds012, deds013, deds014,
                           deds015, deds016, deds017, deds018, deds019,
                           deds020)
      SELECT a.dedsent, a.dedssite, a.deds001, a.deds002, a.deds004,
             a.deds005, a.deds006,  a.deds007, a.deds008, a.deds009,
             a.deds010, a.deds011,  a.deds012, a.deds013, a.deds014,
             a.deds015, a.deds016,  a.deds017, a.deds018, a.deds019,
             a.deds020
        FROM adep150_deds_temp a
       WHERE NOT EXISTS (SELECT 1 FROM deds_t b
                          WHERE b.dedsent  = a.dedsent
                            AND b.dedssite = a.dedssite
                            AND b.deds019  = a.deds019 
                            AND b.deds020  = a.deds020 ) 

      IF SQLCA.SQLcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "ins deds_t"
         LET g_errparam.popup = TRUE
         CALL cl_err()
         LET r_success = FALSE
         RETURN r_success
      END IF

      FOREACH adep150_dedt_cs1 INTO l_dedtsite,l_dedt019,l_dedt020
         INITIALIZE g_errparam TO NULL
         LET g_errparam.replace[1] = l_dedtsite
         LET g_errparam.replace[2] = l_dedt019
         LET g_errparam.replace[3] = l_dedt020
         LET g_errparam.code = 'ade-00124'
         LET g_errparam.popup = TRUE
         CALL cl_err()
      END FOREACH


      INSERT INTO dedt_t ( dedtent,  dedtsite, dedt001, dedt005, dedt006,
                           dedt007,  dedt008,  dedt009, dedt010, dedt011,
                           dedt012,  dedt013,  dedt014, dedt015, dedt016,
                           dedt017,  dedt018,  dedt019, dedt020)
      SELECT a.dedtent,  a.dedtsite, a.dedt001, a.dedt005, a.dedt006,
             a.dedt007,  a.dedt008,  a.dedt009, a.dedt010, a.dedt011,
             a.dedt012,  a.dedt013,  a.dedt014, a.dedt015, a.dedt016,
             a.dedt017,  a.dedt018,  a.dedt019, a.dedt020
        FROM adep150_dedt_temp a 
       WHERE NOT EXISTS (SELECT 1 FROM dedt_t b
                          WHERE a.dedtent  = b.dedtent    
                            AND a.dedtsite = b.dedtsite   
                            AND a.dedt019  = b.dedt019    
                            AND a.dedt020  = b.dedt020)  
      IF SQLCA.SQLcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "ins dedt_t"
         LET g_errparam.popup = TRUE
         CALL cl_err()
         LET r_success = FALSE
         RETURN r_success
      END IF

   END IF  
   
   RETURN r_success

END FUNCTION]]>
  </point>
  <point name="function.adep150_create_temp10" order="36" ver="1" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adep150_create_temp10()
   DEFINE r_success         LIKE type_t.num5

   WHENEVER ERROR CONTINUE

   LET r_success = TRUE

   IF NOT adep150_drop_temp10() THEN
      LET r_success = FALSE
      RETURN r_success
   END IF

   CREATE TEMP TABLE adep150_debu_temp(
      debuent        LIKE debu_t.debuent,  
      debusite       LIKE debu_t.debusite,  
      debu001        LIKE debu_t.debu001,  
      debu002        LIKE debu_t.debu001,  
      debu003        LIKE debu_t.debu001,  
      debu004        LIKE debu_t.debu001,  
      debu005        LIKE debu_t.debu005,  
      debu006        LIKE debu_t.debu006,  
      debu007        LIKE debu_t.debu007,  
      debu008        LIKE debu_t.debu008,  
      debu009        LIKE debu_t.debu009,  
      debu010        LIKE debu_t.debu010,  
      debu011        LIKE debu_t.debu011,  
      debu012        LIKE debu_t.debu012,  
      debu013        LIKE debu_t.debu013,  
      debu014        LIKE debu_t.debu014,  
      debu015        LIKE debu_t.debu015,  
      debu016        LIKE debu_t.debu016,  
      debu017        LIKE debu_t.debu017,  
      debu018        LIKE debu_t.debu018,  
      debu019        LIKE debu_t.debu019,  
      debu020        LIKE debu_t.debu020,  
      debu021        LIKE debu_t.debu021,  
      debu022        LIKE debu_t.debu022,  
      debu023        LIKE debu_t.debu023,  
      debu024        LIKE debu_t.debu024,  
      debu025        LIKE debu_t.debu025,  
      debu026        LIKE debu_t.debu026,  
      debu027        LIKE debu_t.debu027,  
      debu028        LIKE debu_t.debu028,  
      debu029        LIKE debu_t.debu029,  
      debu030        LIKE debu_t.debu030,  
      debu031        LIKE debu_t.debu031,  
      debu032        LIKE debu_t.debu032,  
      debu033        LIKE debu_t.debu033,  
      debu034        LIKE debu_t.debu034,  
      debu035        LIKE debu_t.debu035,  
      debu036        LIKE debu_t.debu036,  
      debu037        LIKE debu_t.debu037,  
      debu038        LIKE debu_t.debu038,  
      debu039        LIKE debu_t.debu039,  
      debu040        LIKE debu_t.debu040,  
      debu041        LIKE debu_t.debu041,
      debu042        LIKE debu_t.debu042,
      debu043        LIKE debu_t.debu043,
      debu044        LIKE debu_t.debu044,
      debu045        LIKE debu_t.debu045
     )

   IF SQLCA.sqlcode != 0 THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'create adep150_debu_temp'
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF

   CREATE TEMP TABLE adep150_dede_temp(
      dedeent        LIKE dede_t.dedeent,  
      dedesite       LIKE dede_t.dedesite,
      dede001        LIKE dede_t.dede001,
      dede005        LIKE dede_t.dede005,
      dede006        LIKE dede_t.dede006,
      dede007        LIKE dede_t.dede007,
      dede008        LIKE dede_t.dede008,
      dede009        LIKE dede_t.dede009,
      dede010        LIKE dede_t.dede010,
      dede011        LIKE dede_t.dede011,
      dede012        LIKE dede_t.dede012,
      dede013        LIKE dede_t.dede013,
      dede014        LIKE dede_t.dede014,
      dede015        LIKE dede_t.dede015,
      dede016        LIKE dede_t.dede016,
      dede017        LIKE dede_t.dede017,
      dede018        LIKE dede_t.dede018,
      dede019        LIKE dede_t.dede019,
      dede020        LIKE dede_t.dede020,
      dede021        LIKE dede_t.dede021,   
      dede022        LIKE dede_t.dede022,
      dede023        LIKE dede_t.dede023,
      dede024        LIKE dede_t.dede024,
      dede025        LIKE dede_t.dede025,
      dede026        LIKE dede_t.dede026,
      dede027        LIKE dede_t.dede027,
      dede028        LIKE dede_t.dede028,
      dede029        LIKE dede_t.dede029,
      dede030        LIKE dede_t.dede030,  
      dede031        LIKE dede_t.dede031,
      dede032        LIKE dede_t.dede032,
      dede033        LIKE dede_t.dede033,
      dede034        LIKE dede_t.dede034,
      dede035        LIKE dede_t.dede035,
      dede036        LIKE dede_t.dede036,
      dede037        LIKE dede_t.dede037,
      dede038        LIKE dede_t.dede038
     )               
                    
   IF SQLCA.sqlcode != 0 THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'create adep150_dede_temp'
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   RETURN r_success 
END FUNCTION]]>
  </point>
  <point name="function.adep150_create_temp11" order="37" ver="1" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adep150_create_temp11()
   DEFINE r_success         LIKE type_t.num5

   WHENEVER ERROR CONTINUE

   LET r_success = TRUE

   IF NOT adep150_drop_temp11() THEN
      LET r_success = FALSE
      RETURN r_success
   END IF

   CREATE TEMP TABLE adep150_dedq_temp(
      dedqent        LIKE dedq_t.dedqent,  
      dedqsite       LIKE dedq_t.dedqsite,  
      dedq001        LIKE dedq_t.dedq001,  
      dedq005        LIKE dedq_t.dedq005,  
      dedq006        LIKE dedq_t.dedq006,  
      dedq007        LIKE dedq_t.dedq007,  
      dedq008        LIKE dedq_t.dedq008,  
      dedq009        LIKE dedq_t.dedq009,  
      dedq010        LIKE dedq_t.dedq010,  
      dedq011        LIKE dedq_t.dedq011,  
      dedq012        LIKE dedq_t.dedq012,  
      dedq013        LIKE dedq_t.dedq013,  
      dedq014        LIKE dedq_t.dedq014,  
      dedq015        LIKE dedq_t.dedq015,  
      dedq016        LIKE dedq_t.dedq016,  
      dedq017        LIKE dedq_t.dedq017,  
      dedq018        LIKE dedq_t.dedq018,  
      dedq019        LIKE dedq_t.dedq019,  
      dedq020        LIKE dedq_t.dedq020,  
      dedq021        LIKE dedq_t.dedq021,  
      dedq022        LIKE dedq_t.dedq022,  
      dedq023        LIKE dedq_t.dedq023,  
      dedq024        LIKE dedq_t.dedq024,  
      dedq025        LIKE dedq_t.dedq025,  
      dedq026        LIKE dedq_t.dedq026,  
      dedq027        LIKE dedq_t.dedq027,  
      dedq028        LIKE dedq_t.dedq028,  
      dedq029        LIKE dedq_t.dedq029,  
      dedq030        LIKE dedq_t.dedq030,  
      dedq031        LIKE dedq_t.dedq031,  
      dedq032        LIKE dedq_t.dedq032,  
      dedq033        LIKE dedq_t.dedq033,  
      dedq034        LIKE dedq_t.dedq034,  
      dedq035        LIKE dedq_t.dedq035,
      dedq036        LIKE dedq_t.dedq036,
      dedq037        LIKE dedq_t.dedq037      
     )

   IF SQLCA.sqlcode != 0 THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'create adep150_dedq_temp'
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF

   CREATE TEMP TABLE adep150_dedr_temp(
      dedrent        LIKE dedr_t.dedrent,  
      dedrsite       LIKE dedr_t.dedrsite,
      dedr001        LIKE dedr_t.dedr001,
      dedr005        LIKE dedr_t.dedr005,
      dedr006        LIKE dedr_t.dedr006,
      dedr007        LIKE dedr_t.dedr007,
      dedr008        LIKE dedr_t.dedr008,
      dedr009        LIKE dedr_t.dedr009,
      dedr010        LIKE dedr_t.dedr010,
      dedr011        LIKE dedr_t.dedr011,
      dedr012        LIKE dedr_t.dedr012,
      dedr013        LIKE dedr_t.dedr013,
      dedr014        LIKE dedr_t.dedr014,
      dedr015        LIKE dedr_t.dedr015,
      dedr016        LIKE dedr_t.dedr016,
      dedr017        LIKE dedr_t.dedr017,
      dedr018        LIKE dedr_t.dedr018,
      dedr019        LIKE dedr_t.dedr019,
      dedr020        LIKE dedr_t.dedr020,
      dedr021        LIKE dedr_t.dedr021,   
      dedr022        LIKE dedr_t.dedr022,
      dedr023        LIKE dedr_t.dedr023,
      dedr024        LIKE dedr_t.dedr024,
      dedr025        LIKE dedr_t.dedr025,
      dedr026        LIKE dedr_t.dedr026,
      dedr027        LIKE dedr_t.dedr027,
      dedr028        LIKE dedr_t.dedr028
     )               
                    
   IF SQLCA.sqlcode != 0 THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'create adep150_dedr_temp'
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   RETURN r_success 
END FUNCTION]]>
  </point>
  <point name="function.adep150_create_temp14" order="38" ver="1" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adep150_create_temp14()
   DEFINE r_success         LIKE type_t.num5

   WHENEVER ERROR CONTINUE

   LET r_success = TRUE

   IF NOT adep150_drop_temp14() THEN
      LET r_success = FALSE
      RETURN r_success
   END IF

   CREATE TEMP TABLE adep150_dedf_temp(
      dedfent        LIKE dedf_t.dedfent,  
      dedfsite       LIKE dedf_t.dedfsite,  
      dedf001        LIKE dedf_t.dedf001,  
      dedf005        LIKE dedf_t.dedf005,  
      dedf006        LIKE dedf_t.dedf006,  
      dedf007        LIKE dedf_t.dedf007,  
      dedf008        LIKE dedf_t.dedf008,  
      dedf009        LIKE dedf_t.dedf009,  
      dedf010        LIKE dedf_t.dedf010,  
      dedf011        LIKE dedf_t.dedf011,  
      dedf012        LIKE dedf_t.dedf012,  
      dedf013        LIKE dedf_t.dedf013,  
      dedf014        LIKE dedf_t.dedf014,  
      dedf015        LIKE dedf_t.dedf015,  
      dedf016        LIKE dedf_t.dedf016,  
      dedf017        LIKE dedf_t.dedf017,  
      dedf018        LIKE dedf_t.dedf018,  
      dedf019        LIKE dedf_t.dedf019,  
      dedf020        LIKE dedf_t.dedf020,  
      dedf021        LIKE dedf_t.dedf021,  
      dedf022        LIKE dedf_t.dedf022,  
      dedf023        LIKE dedf_t.dedf023,  
      dedf024        LIKE dedf_t.dedf024,  
      dedf025        LIKE dedf_t.dedf025,  
      dedf026        LIKE dedf_t.dedf026,  
      dedf027        LIKE dedf_t.dedf027,  
      dedf028        LIKE dedf_t.dedf028,  
      dedf029        LIKE dedf_t.dedf029,  
      dedf030        LIKE dedf_t.dedf030,  
      dedf031        LIKE dedf_t.dedf031,  
      dedf032        LIKE dedf_t.dedf032,
      dedf033        LIKE dedf_t.dedf033      
     )

   IF SQLCA.sqlcode != 0 THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'create adep150_dedf_temp'
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF

   CREATE TEMP TABLE adep150_dedg_temp(
      dedgent        LIKE dedg_t.dedgent,  
      dedgsite       LIKE dedg_t.dedgsite,
      dedg001        LIKE dedg_t.dedg001,
      dedg005        LIKE dedg_t.dedg005,
      dedg006        LIKE dedg_t.dedg006,
      dedg007        LIKE dedg_t.dedg007,
      dedg008        LIKE dedg_t.dedg008,
      dedg009        LIKE dedg_t.dedg009,
      dedg010        LIKE dedg_t.dedg010,
      dedg011        LIKE dedg_t.dedg011,
      dedg012        LIKE dedg_t.dedg012,
      dedg013        LIKE dedg_t.dedg013,
      dedg014        LIKE dedg_t.dedg014,
      dedg015        LIKE dedg_t.dedg015,
      dedg016        LIKE dedg_t.dedg016,
      dedg017        LIKE dedg_t.dedg017,
      dedg018        LIKE dedg_t.dedg018,
      dedg019        LIKE dedg_t.dedg019,
      dedg020        LIKE dedg_t.dedg020,
      dedg021        LIKE dedg_t.dedg021,   
      dedg022        LIKE dedg_t.dedg022,
      dedg023        LIKE dedg_t.dedg023,
      dedg024        LIKE dedg_t.dedg024,
      dedg025        LIKE dedg_t.dedg025,
      dedg026        LIKE dedg_t.dedg026,
      dedg027        LIKE dedg_t.dedg027,
      dedg028        LIKE dedg_t.dedg028,
      dedg029        LIKE dedg_t.dedg029
     )               
                    
   IF SQLCA.sqlcode != 0 THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'create adep150_dedg_temp'
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   CREATE TEMP TABLE adep150_dedh_temp(
      dedhent        LIKE dedh_t.dedhent,  
      dedhsite       LIKE dedh_t.dedhsite,
      dedh001        LIKE dedh_t.dedh001,
      dedh005        LIKE dedh_t.dedh005,
      dedh006        LIKE dedh_t.dedh006,
      dedh007        LIKE dedh_t.dedh007,
      dedh008        LIKE dedh_t.dedh008,
      dedh009        LIKE dedh_t.dedh009,
      dedh010        LIKE dedh_t.dedh010,
      dedh011        LIKE dedh_t.dedh011,
      dedh012        LIKE dedh_t.dedh012,
      dedh013        LIKE dedh_t.dedh013,
      dedh014        LIKE dedh_t.dedh014,
      dedh015        LIKE dedh_t.dedh015,
      dedh016        LIKE dedh_t.dedh016 
     )               
                    
   IF SQLCA.sqlcode != 0 THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'create adep150_dedh_temp'
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   RETURN r_success 

END FUNCTION]]>
  </point>
  <point name="function.adep150_create_temp15" order="39" ver="1" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adep150_create_temp15()
   DEFINE r_success         LIKE type_t.num5

   WHENEVER ERROR CONTINUE

   LET r_success = TRUE

   IF NOT adep150_drop_temp15() THEN
      LET r_success = FALSE
      RETURN r_success
   END IF

   CREATE TEMP TABLE adep150_dedi_temp(
      dedient        LIKE dedi_t.dedient,  
      dedisite       LIKE dedi_t.dedisite,  
      dedi001        LIKE dedi_t.dedi001,  
      dedi005        LIKE dedi_t.dedi005,  
      dedi006        LIKE dedi_t.dedi006,  
      dedi007        LIKE dedi_t.dedi007,  
      dedi008        LIKE dedi_t.dedi008,  
      dedi009        LIKE dedi_t.dedi009,  
      dedi010        LIKE dedi_t.dedi010,  
      dedi011        LIKE dedi_t.dedi011,  
      dedi012        LIKE dedi_t.dedi012,  
      dedi013        LIKE dedi_t.dedi013,  
      dedi014        LIKE dedi_t.dedi014,  
      dedi015        LIKE dedi_t.dedi015,  
      dedi016        LIKE dedi_t.dedi016,  
      dedi017        LIKE dedi_t.dedi017,  
      dedi018        LIKE dedi_t.dedi018,  
      dedi019        LIKE dedi_t.dedi019,  
      dedi020        LIKE dedi_t.dedi020,  
      dedi021        LIKE dedi_t.dedi021,  
      dedi022        LIKE dedi_t.dedi022,  
      dedi023        LIKE dedi_t.dedi023,  
      dedi024        LIKE dedi_t.dedi024,  
      dedi025        LIKE dedi_t.dedi025,  
      dedi026        LIKE dedi_t.dedi026,  
      dedi027        LIKE dedi_t.dedi027,  
      dedi028        LIKE dedi_t.dedi028   
     )

   IF SQLCA.sqlcode != 0 THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'create adep150_dedi_temp'
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF

   CREATE TEMP TABLE adep150_dedj_temp(
      dedjent        LIKE dedj_t.dedjent,  
      dedjsite       LIKE dedj_t.dedjsite,
      dedj001        LIKE dedj_t.dedj001,
      dedj005        LIKE dedj_t.dedj005,
      dedj006        LIKE dedj_t.dedj006,
      dedj007        LIKE dedj_t.dedj007,
      dedj008        LIKE dedj_t.dedj008,
      dedj009        LIKE dedj_t.dedj009,
      dedj010        LIKE dedj_t.dedj010,
      dedj011        LIKE dedj_t.dedj011,
      dedj012        LIKE dedj_t.dedj012,
      dedj013        LIKE dedj_t.dedj013,
      dedj014        LIKE dedj_t.dedj014,
      dedj015        LIKE dedj_t.dedj015,
      dedj016        LIKE dedj_t.dedj016,
      dedj017        LIKE dedj_t.dedj017,
      dedj018        LIKE dedj_t.dedj018,
      dedj019        LIKE dedj_t.dedj019,
      dedj020        LIKE dedj_t.dedj020,
      dedj021        LIKE dedj_t.dedj021,   
      dedj022        LIKE dedj_t.dedj022,
      dedj023        LIKE dedj_t.dedj023,
      dedj024        LIKE dedj_t.dedj024 
     )               
                    
   IF SQLCA.sqlcode != 0 THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'create adep150_dedj_temp'
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
 
   CREATE TEMP TABLE adep150_dedk_temp(
      dedkent        LIKE dedk_t.dedkent,  
      dedksite       LIKE dedk_t.dedksite,
      dedk001        LIKE dedk_t.dedk001,
      dedk005        LIKE dedk_t.dedk005,
      dedk006        LIKE dedk_t.dedk006,
      dedk007        LIKE dedk_t.dedk007,
      dedk008        LIKE dedk_t.dedk008,
      dedk009        LIKE dedk_t.dedk009,
      dedk010        LIKE dedk_t.dedk010,
      dedk011        LIKE dedk_t.dedk011,
      dedk012        LIKE dedk_t.dedk012,
      dedk013        LIKE dedk_t.dedk013 
     )               
                    
   IF SQLCA.sqlcode != 0 THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'create adep150_dedk_temp'
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   RETURN r_success 
END FUNCTION]]>
  </point>
  <point name="function.adep150_create_temp16" order="40" ver="1" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adep150_create_temp16()
   DEFINE r_success         LIKE type_t.num5

   WHENEVER ERROR CONTINUE

   LET r_success = TRUE

   IF NOT adep150_drop_temp16() THEN
      LET r_success = FALSE
      RETURN r_success
   END IF

   CREATE TEMP TABLE adep150_dedl_temp(
      dedlent        LIKE dedl_t.dedlent,  
      dedlsite       LIKE dedl_t.dedlsite,  
      dedl001        LIKE dedl_t.dedl001,  
      dedl005        LIKE dedl_t.dedl005,  
      dedl006        LIKE dedl_t.dedl006,  
      dedl007        LIKE dedl_t.dedl007,  
      dedl008        LIKE dedl_t.dedl008,  
      dedl009        LIKE dedl_t.dedl009,  
      dedl010        LIKE dedl_t.dedl010,  
      dedl011        LIKE dedl_t.dedl011,  
      dedl012        LIKE dedl_t.dedl012,  
      dedl013        LIKE dedl_t.dedl013,  
      dedl014        LIKE dedl_t.dedl014,  
      dedl015        LIKE dedl_t.dedl015,  
      dedl016        LIKE dedl_t.dedl016,  
      dedl017        LIKE dedl_t.dedl017,  
      dedl018        LIKE dedl_t.dedl018,  
      dedl019        LIKE dedl_t.dedl019,  
      dedl020        LIKE dedl_t.dedl020,  
      dedl021        LIKE dedl_t.dedl021,  
      dedl022        LIKE dedl_t.dedl022,  
      dedl023        LIKE dedl_t.dedl023,  
      dedl024        LIKE dedl_t.dedl024,  
      dedl025        LIKE dedl_t.dedl025   
     )

   IF SQLCA.sqlcode != 0 THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'create adep150_dedl_temp'
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF

   CREATE TEMP TABLE adep150_dedm_temp(
      dedment        LIKE dedm_t.dedment,  
      dedmsite       LIKE dedm_t.dedmsite,
      dedm001        LIKE dedm_t.dedm001,
      dedm005        LIKE dedm_t.dedm005,
      dedm006        LIKE dedm_t.dedm006,
      dedm007        LIKE dedm_t.dedm007,
      dedm008        LIKE dedm_t.dedm008,
      dedm009        LIKE dedm_t.dedm009,
      dedm010        LIKE dedm_t.dedm010,
      dedm011        LIKE dedm_t.dedm011,
      dedm012        LIKE dedm_t.dedm012,
      dedm013        LIKE dedm_t.dedm013,
      dedm014        LIKE dedm_t.dedm014,
      dedm015        LIKE dedm_t.dedm015,
      dedm016        LIKE dedm_t.dedm016,
      dedm017        LIKE dedm_t.dedm017,
      dedm018        LIKE dedm_t.dedm018,
      dedm019        LIKE dedm_t.dedm019,
      dedm020        LIKE dedm_t.dedm020,
      dedm021        LIKE dedm_t.dedm021,   
      dedm022        LIKE dedm_t.dedm022 
     )               
                    
   IF SQLCA.sqlcode != 0 THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'create adep150_dedm_temp'
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   CREATE TEMP TABLE adep150_dedn_temp(
      dednent        LIKE dedn_t.dednent,  
      dednsite       LIKE dedn_t.dednsite,
      dedn001        LIKE dedn_t.dedn001,
      dedn005        LIKE dedn_t.dedn005,
      dedn006        LIKE dedn_t.dedn006,
      dedn007        LIKE dedn_t.dedn007,
      dedn008        LIKE dedn_t.dedn008,
      dedn009        LIKE dedn_t.dedn009,
      dedn010        LIKE dedn_t.dedn010 
     )               
                    
   IF SQLCA.sqlcode != 0 THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'create adep150_dedn_temp'
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   RETURN r_success 

END FUNCTION]]>
  </point>
  <point name="function.adep150_create_temp17" order="41" ver="1" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adep150_create_temp17()
   DEFINE r_success         LIKE type_t.num5

   WHENEVER ERROR CONTINUE

   LET r_success = TRUE

   IF NOT adep150_drop_temp17() THEN
      LET r_success = FALSE
      RETURN r_success
   END IF

   CREATE TEMP TABLE adep150_debv_temp(
      debvent        LIKE debv_t.debvent,  
      debvsite       LIKE debv_t.debvsite,  
      debv001        LIKE debv_t.debv001,  
      debv002        LIKE debv_t.debv002,  
      debv003        LIKE debv_t.debv003,  
      debv012        LIKE debv_t.debv012,  
      debv013        LIKE debv_t.debv013,  
      debv014        LIKE debv_t.debv014,  
      debv015        LIKE debv_t.debv015,  
      debv016        LIKE debv_t.debv016,  
      debv017        LIKE debv_t.debv017,  
      debv018        LIKE debv_t.debv018,  
      debv019        LIKE debv_t.debv019,  
      debv020        LIKE debv_t.debv020,  
      debv025        LIKE debv_t.debv025,
      debv026        LIKE debv_t.debv026,  
      debv027        LIKE debv_t.debv027,  
      debv028        LIKE debv_t.debv028,
      debv029        LIKE debv_t.debv029,
      debv030        LIKE debv_t.debv030,
      debv031        LIKE debv_t.debv031,
      debv032        LIKE debv_t.debv032,
      debv033        LIKE debv_t.debv033,
      debv034        LIKE debv_t.debv034      
     )

   IF SQLCA.sqlcode != 0 THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'create adep150_debv_temp'
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF

   CREATE TEMP TABLE adep150_dedo_temp(
      dedoent        LIKE dedo_t.dedoent,  
      dedosite       LIKE dedo_t.dedosite,
      dedo001        LIKE dedo_t.dedo001,
      dedo005        LIKE dedo_t.dedo005,
      dedo006        LIKE dedo_t.dedo006,
      dedo007        LIKE dedo_t.dedo007,
      dedo008        LIKE dedo_t.dedo008,
      dedo009        LIKE dedo_t.dedo009,
      dedo010        LIKE dedo_t.dedo010,
      dedo011        LIKE dedo_t.dedo011,
      dedo012        LIKE dedo_t.dedo012,
      dedo013        LIKE dedo_t.dedo013,
      dedo014        LIKE dedo_t.dedo014,
      dedo015        LIKE dedo_t.dedo015,
      dedo016        LIKE dedo_t.dedo016,
      dedo017        LIKE dedo_t.dedo017,
      dedo018        LIKE dedo_t.dedo018,
      dedo019        LIKE dedo_t.dedo019,
      dedo020        LIKE dedo_t.dedo020,
      dedo021        LIKE dedo_t.dedo021,
      dedo022        LIKE dedo_t.dedo022      
     )               
                    
   IF SQLCA.sqlcode != 0 THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'create adep150_dedo_temp'
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   CREATE TEMP TABLE adep150_dedp_temp(
      dedpent        LIKE dedp_t.dedpent,  
      dedpsite       LIKE dedp_t.dedpsite,
      dedp001        LIKE dedp_t.dedp001,
      dedp005        LIKE dedp_t.dedp005,
      dedp006        LIKE dedp_t.dedp006,
      dedp007        LIKE dedp_t.dedp007,
      dedp008        LIKE dedp_t.dedp008,
      dedp009        LIKE dedp_t.dedp009 
     )               
                    
   IF SQLCA.sqlcode != 0 THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'create adep150_dedp_temp'
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   RETURN r_success 
END FUNCTION]]>
  </point>
  <point name="function.adep150_create_temp19" order="42" ver="1" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adep150_create_temp19()
   DEFINE r_success         LIKE type_t.num5

   WHENEVER ERROR CONTINUE

   LET r_success = TRUE

   IF NOT adep150_drop_temp19() THEN
      LET r_success = FALSE
      RETURN r_success
   END IF

   CREATE TEMP TABLE adep150_deds_temp(
      dedsent        LIKE deds_t.dedsent,  
      dedssite       LIKE deds_t.dedssite,  
      deds001        LIKE deds_t.deds001,  
      deds002        LIKE deds_t.deds002,  
      deds004        LIKE deds_t.deds004,  
      deds005        LIKE deds_t.deds005,  
      deds006        LIKE deds_t.deds006,  
      deds007        LIKE deds_t.deds007,  
      deds008        LIKE deds_t.deds008,  
      deds009        LIKE deds_t.deds009,  
      deds010        LIKE deds_t.deds010,  
      deds011        LIKE deds_t.deds011,  
      deds012        LIKE deds_t.deds012,  
      deds013        LIKE deds_t.deds013,  
      deds014        LIKE deds_t.deds014,  
      deds015        LIKE deds_t.deds015,  
      deds016        LIKE deds_t.deds016,  
      deds017        LIKE deds_t.deds017,  
      deds018        LIKE deds_t.deds018,  
      deds019        LIKE deds_t.deds019,  
      deds020        LIKE deds_t.deds020   
     )

   IF SQLCA.sqlcode != 0 THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'create adep150_deds_temp'
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF

   CREATE TEMP TABLE adep150_dedt_temp(
      dedtent        LIKE dedt_t.dedtent,  
      dedtsite       LIKE dedt_t.dedtsite,
      dedt001        LIKE dedt_t.dedt001,
      dedt005        LIKE dedt_t.dedt005,
      dedt006        LIKE dedt_t.dedt006,
      dedt007        LIKE dedt_t.dedt007,
      dedt008        LIKE dedt_t.dedt008,
      dedt009        LIKE dedt_t.dedt009,
      dedt010        LIKE dedt_t.dedt010,
      dedt011        LIKE dedt_t.dedt011,
      dedt012        LIKE dedt_t.dedt012,
      dedt013        LIKE dedt_t.dedt013,
      dedt014        LIKE dedt_t.dedt014,
      dedt015        LIKE dedt_t.dedt015,
      dedt016        LIKE dedt_t.dedt016,
      dedt017        LIKE dedt_t.dedt017,
      dedt018        LIKE dedt_t.dedt018,
      dedt019        LIKE dedt_t.dedt019,
      dedt020        LIKE dedt_t.dedt020 
     )               
                    
   IF SQLCA.sqlcode != 0 THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'create adep150_dedt_temp'
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   RETURN r_success

END FUNCTION]]>
  </point>
  <point name="function.adep150_adep150_drop_temp10" order="43" ver="1" cite_std="N" new="Y" status="d" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="function.adep150_drop_temp10" order="43" ver="1" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adep150_drop_temp10()
   DEFINE r_success          LIKE type_t.num5

   WHENEVER ERROR CONTINUE

   LET r_success = TRUE

   DROP TABLE adep150_debu_temp

   IF NOT (SQLCA.sqlcode = 0 OR SQLCA.sqlcode = -206) THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'drop adep150_debu_temp'
      LET g_errparam.popup = TRUE
      CALL cl_err()

      LET r_success = FALSE
      RETURN r_success
   END IF

   DROP TABLE adep150_dede_temp

   IF NOT (SQLCA.sqlcode = 0 OR SQLCA.sqlcode = -206) THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'drop adep150_dede_temp'
      LET g_errparam.popup = TRUE
      CALL cl_err()

      LET r_success = FALSE
      RETURN r_success
   END IF

   RETURN r_success

END FUNCTION]]>
  </point>
  <point name="function.adep150_drop_temp11" order="44" ver="1" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adep150_drop_temp11()
   DEFINE r_success          LIKE type_t.num5

   WHENEVER ERROR CONTINUE

   LET r_success = TRUE

   DROP TABLE adep150_dedq_temp

   IF NOT (SQLCA.sqlcode = 0 OR SQLCA.sqlcode = -206) THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'drop adep150_dedq_temp'
      LET g_errparam.popup = TRUE
      CALL cl_err()

      LET r_success = FALSE
      RETURN r_success
   END IF

   DROP TABLE adep150_dedr_temp

   IF NOT (SQLCA.sqlcode = 0 OR SQLCA.sqlcode = -206) THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'drop adep150_dedr_temp'
      LET g_errparam.popup = TRUE
      CALL cl_err()

      LET r_success = FALSE
      RETURN r_success
   END IF

   RETURN r_success
END FUNCTION]]>
  </point>
  <point name="function.adep150_drop_temp14" order="45" ver="1" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adep150_drop_temp14()
   DEFINE r_success          LIKE type_t.num5

   WHENEVER ERROR CONTINUE

   LET r_success = TRUE

   DROP TABLE adep150_dedf_temp

   IF NOT (SQLCA.sqlcode = 0 OR SQLCA.sqlcode = -206) THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'drop adep150_dedf_temp'
      LET g_errparam.popup = TRUE
      CALL cl_err()

      LET r_success = FALSE
      RETURN r_success
   END IF

   DROP TABLE adep150_dedg_temp

   IF NOT (SQLCA.sqlcode = 0 OR SQLCA.sqlcode = -206) THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'drop adep150_dedg_temp'
      LET g_errparam.popup = TRUE
      CALL cl_err()

      LET r_success = FALSE
      RETURN r_success
   END IF

   DROP TABLE adep150_dedh_temp

   IF NOT (SQLCA.sqlcode = 0 OR SQLCA.sqlcode = -206) THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'drop adep150_dedh_temp'
      LET g_errparam.popup = TRUE
      CALL cl_err()

      LET r_success = FALSE
      RETURN r_success
   END IF

   RETURN r_success
END FUNCTION]]>
  </point>
  <point name="function.adep150_drop_temp15" order="46" ver="1" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adep150_drop_temp15()
   DEFINE r_success          LIKE type_t.num5

   WHENEVER ERROR CONTINUE

   LET r_success = TRUE

   DROP TABLE adep150_dedi_temp

   IF NOT (SQLCA.sqlcode = 0 OR SQLCA.sqlcode = -206) THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'drop adep150_dedi_temp'
      LET g_errparam.popup = TRUE
      CALL cl_err()

      LET r_success = FALSE
      RETURN r_success
   END IF

   DROP TABLE adep150_dedj_temp

   IF NOT (SQLCA.sqlcode = 0 OR SQLCA.sqlcode = -206) THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'drop adep150_dedj_temp'
      LET g_errparam.popup = TRUE
      CALL cl_err()

      LET r_success = FALSE
      RETURN r_success
   END IF

   DROP TABLE adep150_dedk_temp

   IF NOT (SQLCA.sqlcode = 0 OR SQLCA.sqlcode = -206) THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'drop adep150_dedk_temp'
      LET g_errparam.popup = TRUE
      CALL cl_err()

      LET r_success = FALSE
      RETURN r_success
   END IF

   RETURN r_success
END FUNCTION]]>
  </point>
  <point name="function.adep150_drop_temp16" order="47" ver="1" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adep150_drop_temp16()
   DEFINE r_success          LIKE type_t.num5

   WHENEVER ERROR CONTINUE

   LET r_success = TRUE

   DROP TABLE adep150_dedl_temp

   IF NOT (SQLCA.sqlcode = 0 OR SQLCA.sqlcode = -206) THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'drop adep150_dedl_temp'
      LET g_errparam.popup = TRUE
      CALL cl_err()

      LET r_success = FALSE
      RETURN r_success
   END IF

   DROP TABLE adep150_dedm_temp

   IF NOT (SQLCA.sqlcode = 0 OR SQLCA.sqlcode = -206) THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'drop adep150_dedm_temp'
      LET g_errparam.popup = TRUE
      CALL cl_err()

      LET r_success = FALSE
      RETURN r_success
   END IF

   DROP TABLE adep150_dedn_temp

   IF NOT (SQLCA.sqlcode = 0 OR SQLCA.sqlcode = -206) THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'drop adep150_dedn_temp'
      LET g_errparam.popup = TRUE
      CALL cl_err()

      LET r_success = FALSE
      RETURN r_success
   END IF

   RETURN r_success

END FUNCTION]]>
  </point>
  <point name="function.adep150_drop_temp17" order="48" ver="1" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adep150_drop_temp17()
   DEFINE r_success          LIKE type_t.num5

   WHENEVER ERROR CONTINUE

   LET r_success = TRUE

   DROP TABLE adep150_debv_temp

   IF NOT (SQLCA.sqlcode = 0 OR SQLCA.sqlcode = -206) THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'drop adep150_debv_temp'
      LET g_errparam.popup = TRUE
      CALL cl_err()

      LET r_success = FALSE
      RETURN r_success
   END IF

   DROP TABLE adep150_dedo_temp

   IF NOT (SQLCA.sqlcode = 0 OR SQLCA.sqlcode = -206) THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'drop adep150_dedo_temp'
      LET g_errparam.popup = TRUE
      CALL cl_err()

      LET r_success = FALSE
      RETURN r_success
   END IF

   DROP TABLE adep150_dedp_temp

   IF NOT (SQLCA.sqlcode = 0 OR SQLCA.sqlcode = -206) THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'drop adep150_dedp_temp'
      LET g_errparam.popup = TRUE
      CALL cl_err()

      LET r_success = FALSE
      RETURN r_success
   END IF

   RETURN r_success
END FUNCTION]]>
  </point>
  <point name="function.adep150_drop_temp19" order="49" ver="1" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adep150_drop_temp19()
   DEFINE r_success          LIKE type_t.num5

   WHENEVER ERROR CONTINUE

   LET r_success = TRUE

   DROP TABLE adep150_deds_temp

   IF NOT (SQLCA.sqlcode = 0 OR SQLCA.sqlcode = -206) THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'drop adep150_deds_temp'
      LET g_errparam.popup = TRUE
      CALL cl_err()

      LET r_success = FALSE
      RETURN r_success
   END IF

   DROP TABLE adep150_dedt_temp

   IF NOT (SQLCA.sqlcode = 0 OR SQLCA.sqlcode = -206) THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = 'drop adep150_dedt_temp'
      LET g_errparam.popup = TRUE
      CALL cl_err()

      LET r_success = FALSE
      RETURN r_success
   END IF

   RETURN r_success

END FUNCTION]]>
  </point>
  <point name="function.adep150_ins_temp10" order="50" ver="1" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adep150_ins_temp10(p_wc)
   DEFINE p_wc           STRING
   DEFINE l_wc           STRING
   DEFINE r_success      LIKE type_t.num5
   DEFINE l_sql          STRING
   DEFINE l_where        STRING
   
   LET r_success = TRUE
   DELETE FROM adep150_debu_temp
   LET l_where = s_aooi500_sql_where(g_prog,'debasite')
   LET l_wc = cl_replace_str(p_wc,'rtjasite','debasite')
   
   LET l_sql = " INSERT INTO adep150_debu_temp( debuent, debusite,debu004, debu007, debu012, debu013,",
               "                                debu015, debu016, debu017, debu018, debu019, ",
               "                                debu020, debu021, debu022, debu023, debu024, ",
               "                                debu025, debu027, debu028, debu029, debu030, ",
               "                                debu031, debu032, debu033, debu034, debu035, ",
               "                                debu036, debu037, debu038, debu008, debu039, ",
               "                                debu042, debu043, debu044)  ",
               " SELECT debaent,      debasite,     deba005,     deba009,   COALESCE(deba014,' ') ,   COALESCE(deba015,' '),",
               "        deba017,                  deba018,                  SUM(COALESCE(deba019,0)), deba020,                  SUM(COALESCE(deba021,0)),",
               "        SUM(COALESCE(deba022,0)), SUM(COALESCE(deba023,0)), SUM(COALESCE(deba024,0)), SUM(COALESCE(deba025,0)), SUM(COALESCE(deba026,0)),",
               "        SUM(COALESCE(deba027,0)), SUM(COALESCE(deba029,0)), SUM(COALESCE(deba030,0)), SUM(COALESCE(deba031,0)), SUM(COALESCE(deba032,0)),",
               "        SUM(COALESCE(deba033,0)), SUM(COALESCE(deba034,0)), SUM(COALESCE(deba035,0)), SUM(COALESCE(deba036,0)), SUM(COALESCE(deba037,0)),",
               "        SUM(COALESCE(deba038,0)), SUM(COALESCE(deba039,0)), SUM(COALESCE(deba040,0)), deba043,                  SUM(COALESCE(deba044,0)),",
               "        SUM(COALESCE(deba045,0)), SUM(COALESCE(deba046,0)), SUM(COALESCE(deba047,0))  ",
               "   FROM deba_t ",
               "  WHERE debaent = ",g_enterprise,
               "    AND deba002 BETWEEN ? AND ? ",
               "    AND ",l_wc,
               "    AND ",l_where,
               "  GROUP BY debaent, debasite, deba005, deba009, deba014,",
               "           deba015, deba017,  deba018, deba020, deba043 "        

   PREPARE adep150_ins_debu_temp_prep FROM l_sql
   EXECUTE adep150_ins_debu_temp_prep USING g_sdate,g_edate
   
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "INSERT adep150_debu_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   LET l_sql = "UPDATE adep150_debu_temp SET debu001 = (SELECT ooef101 FROM ooef_t WHERE ooefent = debuent AND ooef001 = debusite),",
               "                            (debu040,debu011,debu014) = ( SELECT imaa014,imaa126,COALESCE(imaa009,' ')  ",
               "                                                           FROM imaa_t  ",
               "                                                          WHERE imaaent = debuent AND imaa001 = debu007), ",
               "                            (debu009,debu010) = (SELECT imaal003,imaal004 FROM imaal_t  ",
               "                                                  WHERE imaalent = debuent AND imaal001 = debu007 ",
               "                                                    AND imaal002 = '",g_dlang,"'),",
               "                            (debu041,debu005,debu006) = (SELECT inaa102,inaa111,inaa105 FROM inaa_t ",
               "                                                          WHERE inaaent = debuent AND inaasite = debusite  ",
               "                                                            AND inaa001 = debu004 ), ",
               "                            debu026 = CASE WHEN debu025 = 0 THEN 0 ELSE (debu025 / (CASE WHEN debu024 = 0 THEN debu025 ELSE debu024 END) * 100) END,",
               "                            debu045 = debu024 / (CASE WHEN debu027 = 0 THEN 1 ELSE debu027 END), ",
               "                            debu002 = ",g_year,",",
               "                            debu003 = ",g_month

   PREPARE adep150_debu_upd FROM l_sql 
   EXECUTE adep150_debu_upd
   
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "UPDATE adep150_debu_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   CREATE INDEX debu_temp_01 ON adep150_debu_temp(debuent,debusite,debu002,debu003)
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "CREATE INDEX adep150_debu_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF      
   DELETE FROM adep150_dede_temp
   LET l_where = s_aooi500_sql_where(g_prog,'debbsite')
   LET l_wc = cl_replace_str(p_wc,'rtjasite','debbsite') 
   
   LET l_sql = " INSERT INTO adep150_dede_temp( dedeent,  dedesite, dede005, dede009, ",
               "                                dede017,  dede018,  dede019, dede020, dede021,",   
               "                                dede022,  dede023,  dede024, dede025, dede026,",
               "                                dede027,  dede028,  dede030, dede031, dede032,",
               "                                dede033,  dede034,  dede037)",
               " SELECT debbent,       debbsite,      debb005,      debb009, ",
               "        debb017,       debb018,       debb019,      debb020,      debb021,",  
               "        SUM(COALESCE(debb022,0)),  SUM(COALESCE(debb023,0)),  SUM(COALESCE(debb024,0)), SUM(COALESCE(debb025,0)), SUM(COALESCE(debb026,0)),",
               "        SUM(COALESCE(debb027,0)),  SUM(COALESCE(debb028,0)),  SUM(COALESCE(debb030,0)), SUM(COALESCE(debb031,0)), SUM(COALESCE(debb032,0)),",
               "        SUM(COALESCE(debb033,0)),  SUM(COALESCE(debb034,0)),  debb035 ",
               "   FROM debb_t ",
               "  WHERE debbent = ",g_enterprise,
               "    AND debb002 BETWEEN ? AND ? ",
               "    AND ",l_wc,
               "    AND ",l_where,
               "  GROUP BY debbent, debbsite, debb005, debb009, debb017, ",
               "           debb018,  debb019, debb020, debb021, debb035"
                    
   PREPARE adep150_ins_dede_temp_prep FROM l_sql
   EXECUTE adep150_ins_dede_temp_prep USING g_sdate,g_edate   
   
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "INSERT adep150_dede_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   LET l_sql = "UPDATE adep150_dede_temp SET dede001 = (SELECT ooef101 FROM ooef_t WHERE ooefent = dedeent AND ooef001 = dedesite),",
               "                            (dede010,dede013,dede016) = ( SELECT imaa014,imaa126,COALESCE(imaa009,' ')  ",
               "                                                           FROM imaa_t  ",
               "                                                          WHERE imaaent = dedeent AND imaa001 = dede009), ",
               "                            (dede011,dede012) = (SELECT imaal003,imaal004 FROM imaal_t  ",
               "                                                  WHERE imaalent = dedeent AND imaal001 = dede009 ",
               "                                                    AND imaal002 = '",g_dlang,"'),",
               "                            (dede006,dede007,dede008) = (SELECT inaa102,inaa111,inaa105 FROM inaa_t ",
               "                                                          WHERE inaaent = dedeent AND inaasite = dedesite  ",
               "                                                            AND inaa001 = dede005 ), ",
               "                            dede014 = (SELECT imaf153 FROM imaf_t  ",
               "                                          WHERE imafent = dedeent AND imafsite = dedesite  ",
               "                                            AND imaf001 = dede009),",
               "                            dede029 = CASE WHEN dede028 = 0 THEN 0 ELSE (dede028 / (CASE WHEN dede027 = 0 THEN dede028 ELSE dede027 END) * 100) END,",
               "                            dede038 = dede027 / (CASE WHEN dede031 = 0 THEN 1 ELSE dede031 END), ",
               "                            dede035 = ",g_year,",",
               "                            dede036 = ",g_month
   PREPARE adep150_dede_upd FROM l_sql 
   EXECUTE adep150_dede_upd
   
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "UPDATE adep150_dede_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   CREATE INDEX dede_temp_01 ON adep150_dede_temp(dedeent,dedesite,dede035,dede036)
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "CREATE INDEX adep150_dede_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   RETURN r_success   
END FUNCTION]]>
  </point>
  <point name="function.adep150_ins_temp11" order="51" ver="1" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adep150_ins_temp11(p_wc)
   DEFINE p_wc           STRING
   DEFINE l_wc           STRING
   DEFINE r_success      LIKE type_t.num5
   DEFINE l_sql          STRING
   DEFINE l_where        STRING
   
   LET r_success = TRUE
   DELETE FROM adep150_dedq_temp
   LET l_where = s_aooi500_sql_where(g_prog,'debssite')
   LET l_wc = cl_replace_str(p_wc,'rtjasite','debssite')
   
   LET l_sql = " INSERT INTO adep150_dedq_temp( dedqent, dedqsite,dedq001, dedq005, dedq006,",
               "                                dedq007, dedq008, dedq009, dedq010, dedq011,",
               "                                dedq012, dedq013, dedq014, dedq015, dedq016,",
               "                                dedq017, dedq019, dedq020, dedq021, dedq022,",
               "                                dedq023, dedq024, dedq025, dedq026, dedq027,",
               "                                dedq028, dedq029, dedq030, dedq031, dedq032,",
               "                                dedq033, dedq037)",
               " SELECT debsent,      debssite,     debs001,      debs005,      debs006,     ",
               "        debs007,      debs008,      debs009,      SUM(COALESCE(debs010,0)),      SUM(COALESCE(debs011,0)),",
               "        SUM(COALESCE(debs012,0)), SUM(COALESCE(debs013,0)), SUM(COALESCE(debs014,0)), SUM(COALESCE(debs015,0)), SUM(COALESCE(debs016,0)),",
               "        SUM(COALESCE(debs017,0)), SUM(COALESCE(debs019,0)), SUM(COALESCE(debs020,0)), SUM(COALESCE(debs021,0)), SUM(COALESCE(debs022,0)),",
               "        SUM(COALESCE(debs023,0)), SUM(COALESCE(debs024,0)), SUM(COALESCE(debs025,0)), SUM(COALESCE(debs026,0)), SUM(COALESCE(debs027,0)),",
               "        SUM(COALESCE(debs028,0)), SUM(COALESCE(debs029,0)), SUM(COALESCE(debs030,0)), SUM(COALESCE(debs031,0)), SUM(COALESCE(debs032,0)),", 
               "        SUM(COALESCE(debs033,0)), debs035",
               "   FROM debs_t ",
               "  WHERE debsent = ", g_enterprise,
               "    AND debs002 BETWEEN ? AND ? ",
               "    AND ",l_wc,
               "    AND ",l_where,
               "  GROUP BY debsent, debssite, debs001, debs005, debs006,",
               "           debs007, debs008,  debs009, debs035"
               
   PREPARE adep150_ins_dedq_temp_prep FROM l_sql
   EXECUTE adep150_ins_dedq_temp_prep USING g_sdate,g_edate
   
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "INSERT adep150_dedq_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   LET l_sql = "UPDATE adep150_dedq_temp SET dedq001 = (SELECT ooef101 FROM ooef_t WHERE ooefent = dedqent AND ooef001 = dedqsite),",
               "                             dedq018 = CASE WHEN dedq017 = 0 THEN 0 ELSE (dedq017 / (CASE WHEN dedq016 = 0 THEN dedq017 ELSE dedq016 END) * 100) END,",
               "                             dedq036 = dedq016 / (CASE WHEN dedq019 = 0 THEN 1 ELSE dedq019 END), ",
               "                             dedq034 = ",g_year,",",
               "                             dedq035 = ",g_month
   PREPARE adep150_dedq_upd FROM l_sql 
   EXECUTE adep150_dedq_upd
   
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "UPDATE adep150_dedq_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   CREATE INDEX dedq_temp_01 ON adep150_dedq_temp(dedqent,dedqsite,dedq034,dedq035)
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "CREATE INDEX adep150_dedq_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF      
   DELETE FROM adep150_dedr_temp
   LET l_where = s_aooi500_sql_where(g_prog,'debtsite')
   LET l_wc = cl_replace_str(p_wc,'rtjasite','debtsite')
   
   LET l_sql = " INSERT INTO adep150_dedr_temp( dedrent,  dedrsite, dedr001, dedr005, dedr006,",
               "                                dedr007,  dedr008,  dedr009, dedr010, dedr011,",
               "                                dedr012,  dedr013,  dedr014, dedr015, dedr016,",
               "                                dedr017,  dedr018,  dedr020, dedr021, dedr022,",
               "                                dedr023,  dedr024,  dedr028) ",
               " SELECT debtent,       debtsite,      debt001,      debt005,      debt006,     ",
               "        debt007,       debt008,       debt009,      debt010,      debt011,     ",
               "        SUM(COALESCE(debt012,0)),  SUM(COALESCE(debt013,0)),  SUM(COALESCE(debt014,0)), SUM(COALESCE(debt015,0)), SUM(COALESCE(debt016,0)),",
               "        SUM(COALESCE(debt017,0)),  SUM(COALESCE(debt018,0)),  SUM(COALESCE(debt020,0)), SUM(COALESCE(debt021,0)), SUM(COALESCE(debt022,0)),",
               "        SUM(COALESCE(debt023,0)),  SUM(COALESCE(debt024,0)),  debt026 ",
               "   FROM debt_t ",
               "  WHERE debtent = ",g_enterprise,
               "    AND debt002 BETWEEN ? AND ? ",
               "    AND ",l_wc,
               "    AND ",l_where,
               "  GROUP BY debtent, debtsite, debt001, debt005, debt006,",
               "           debt007, debt008,  debt009, debt010, debt011, debt026"
               
   PREPARE adep150_ins_dedr_temp_prep FROM l_sql
   EXECUTE adep150_ins_dedr_temp_prep USING g_sdate,g_edate   
   
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "INSERT adep150_dedr_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   LET l_sql = "UPDATE adep150_dedr_temp SET dedr001 = (SELECT ooef101 FROM ooef_t WHERE ooefent = dedrent AND ooef001 = dedrsite),",
               "                             dedr019 = CASE WHEN dedr018 = 0 THEN 0 ELSE (dedr018 / (CASE WHEN dedr017 = 0 THEN dedr018 ELSE dedr017 END) * 100) END,",
               "                             dedr027 = dedr017 / (CASE WHEN dedr021 = 0 THEN 1 ELSE dedr021 END), ",
               "                             dedr025 = ",g_year,",",
               "                             dedr026 = ",g_month
   PREPARE adep150_dedr_upd FROM l_sql 
   EXECUTE adep150_dedr_upd
   
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "UPDATE adep150_dedr_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   CREATE INDEX dedr_temp_01 ON adep150_dedr_temp(dedrent,dedrsite,dedr025,dedr026)
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "CREATE INDEX adep150_dedr_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   RETURN r_success   
   
END FUNCTION]]>
  </point>
  <point name="function.adep150_ins_temp14" order="52" ver="1" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adep150_ins_temp14(p_wc)
   DEFINE p_wc           STRING
   DEFINE l_wc           STRING
   DEFINE r_success      LIKE type_t.num5
   DEFINE l_sql          STRING
   DEFINE l_where        STRING
   
   LET r_success = TRUE
   DELETE FROM adep150_dedf_temp
   LET l_where = s_aooi500_sql_where(g_prog,'debcsite')
   LET l_wc = cl_replace_str(p_wc,'rtjasite','debcsite')
   LET l_sql = " INSERT INTO adep150_dedf_temp( dedfent, dedfsite,dedf005, dedf009, dedf010, dedf011,",
               "                                dedf012, dedf013, dedf014, dedf015, dedf016,",
               "                                dedf017, dedf018, dedf019, dedf020, dedf021,",
               "                                dedf022, dedf024, dedf025, dedf026, dedf027,",
               "                                dedf028, dedf029, dedf030)",
               " SELECT debcent,      debcsite,     debc005,      debc009,      debc010,      debc011,     ",
               "        SUM(COALESCE(debc012,0)), SUM(COALESCE(debc013,0)), SUM(COALESCE(debc014,0)), SUM(COALESCE(debc015,0)), SUM(COALESCE(debc016,0)),",
               "        SUM(COALESCE(debc017,0)), SUM(COALESCE(debc018,0)), SUM(COALESCE(debc019,0)), SUM(COALESCE(debc020,0)), SUM(COALESCE(debc021,0)),",
               "        SUM(COALESCE(debc022,0)), SUM(COALESCE(debc024,0)), SUM(COALESCE(debc025,0)), SUM(COALESCE(debc026,0)), SUM(COALESCE(debc027,0)),",
               "        SUM(COALESCE(debc028,0)), SUM(COALESCE(debc029,0)), SUM(COALESCE(debc030,0))",
               "   FROM debc_t",
               "  WHERE debcent = ",g_enterprise,
               "    AND debc002 BETWEEN ? AND ? ",
               "    AND ",l_wc,
               "    AND ",l_where,
               "  GROUP BY debcent, debcsite, debc005, debc009, debc010, debc011 "
               
   PREPARE adep150_ins_dedf_temp_prep FROM l_sql
   EXECUTE adep150_ins_dedf_temp_prep USING g_sdate,g_edate
   
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "INSERT adep150_dedf_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   LET l_sql = "UPDATE adep150_dedf_temp SET dedf001 = (SELECT ooef101 FROM ooef_t WHERE ooefent = dedfent AND ooef001 = dedfsite),",
               "                            (dedf006,dedf007,dedf008) = (SELECT inaa102,inaa111,inaa105 FROM inaa_t ",
               "                                                          WHERE inaaent = dedfent AND inaasite = dedfsite  ",
               "                                                            AND inaa001 = dedf005 ), ",
               "                            dedf023 = CASE WHEN dedf022 = 0 THEN 0 ELSE (dedf022 / (CASE WHEN dedf018 = 0 THEN dedf022 ELSE dedf018 END) * 100) END,",
               "                            dedf033 = dedf018 / (CASE WHEN dedf024 = 0 THEN 1 ELSE dedf024 END), ",
               "                            dedf031 = ",g_year,",",
               "                            dedf032 = ",g_month
   PREPARE adep150_dedf_upd FROM l_sql 
   EXECUTE adep150_dedf_upd
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "UPDATE adep150_dedf_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   CREATE INDEX dedf_temp_01 ON adep150_dedf_temp(dedfent,dedfsite,dedf031,dedf032)
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "CREATE INDEX adep150_dedf_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF      
   DELETE FROM adep150_dedg_temp
   LET l_where = s_aooi500_sql_where(g_prog,'debdsite')
   LET l_wc = cl_replace_str(p_wc,'rtjasite','debdsite')
   
   LET l_sql = " INSERT INTO adep150_dedg_temp( dedgent,  dedgsite, dedg005, dedg009, dedg010, dedg011,",
               "                                dedg012,  dedg013,  dedg014, dedg015, dedg016,",
               "                                dedg017,  dedg018,  dedg019, dedg020, dedg022,",
               "                                dedg023,  dedg024,  dedg025, dedg026)",
               " SELECT debdent,      debdsite,      debd005,      debd009,       debd010,      debd011,",
               "        debd012,                   debd013,                   SUM(COALESCE(debd014,0)), SUM(COALESCE(debd015,0)), SUM(COALESCE(debd016,0)),",
               "        SUM(COALESCE(debd017,0)),  SUM(COALESCE(debd018,0)),  SUM(COALESCE(debd019,0)), SUM(COALESCE(debd020,0)), SUM(COALESCE(debd022,0)),",
               "        SUM(COALESCE(debd023,0)),  SUM(COALESCE(debd024,0)),  SUM(COALESCE(debd025,0)), SUM(COALESCE(debd026,0))",
               "   FROM debd_t",
               "  WHERE debdent = ",g_enterprise,
               "    AND debd002 BETWEEN ? AND ? ",
               "    AND ",l_wc,
               "    AND ",l_where,
               "  GROUP BY debdent, debdsite, debd005, debd009, debd010, debd011,",
               "           debd012, debd013 "
   
   PREPARE adep150_ins_dedg_temp_prep FROM l_sql
   EXECUTE adep150_ins_dedg_temp_prep USING g_sdate,g_edate

   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "INSERT adep150_dedg_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   LET l_sql = "UPDATE adep150_dedg_temp SET dedg001 = (SELECT ooef101 FROM ooef_t WHERE ooefent = dedgent AND ooef001 = dedgsite),",
               "                            (dedg006,dedg007,dedg008) = (SELECT inaa102,inaa111,inaa105 FROM inaa_t ",
               "                                                          WHERE inaaent = dedgent AND inaasite = dedgsite  ",
               "                                                            AND inaa001 = dedg005 ), ",
               "                            dedg021 = CASE WHEN dedg020 = 0 THEN 0 ELSE (dedg020 / (CASE WHEN dedg019 = 0 THEN dedg020 ELSE dedg019 END) * 100) END,",
               "                            dedg029 = dedg019 / (CASE WHEN dedg023 = 0 THEN 1 ELSE dedg023 END), ",
               "                            dedg027 = ",g_year,",",
               "                            dedg028 = ",g_month
   PREPARE adep150_dedg_upd FROM l_sql 
   EXECUTE adep150_dedg_upd
   
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "UPDATE adep150_dedg_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   CREATE INDEX dedg_temp_01 ON adep150_dedg_temp(dedgent,dedgsite,dedg027,dedg028)
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "CREATE INDEX adep150_dedg_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   DELETE FROM adep150_dedh_temp
   LET l_where = s_aooi500_sql_where(g_prog,'debesite')
   LET l_wc = cl_replace_str(p_wc,'rtjasite','debesite')
   
   LET l_sql = " INSERT INTO adep150_dedh_temp( dedhent,  dedhsite, dedh005, dedh009, dedh010,",
               "                                dedh011,  dedh012,  dedh013, dedh014) ",
               " SELECT debeent,       debesite,      debe005,       debe009,      debe010,",
               "        debe011,       debe012,       debe013,       SUM(COALESCE(debe014,0)) ",
               "   FROM debe_t ",
               "  WHERE debeent = ",g_enterprise,
               "    AND debe002 BETWEEN ? AND ? ",
               "    AND ",l_wc,
               "    AND ",l_where,
               "  GROUP BY debeent, debesite, debe005, debe009, debe010,",
               "           debe011, debe012,  debe013 "

   PREPARE adep150_ins_dedh_temp_prep FROM l_sql
   EXECUTE adep150_ins_dedh_temp_prep USING g_sdate,g_edate

   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "INSERT adep150_dedh_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   LET l_sql = "UPDATE adep150_dedh_temp SET dedh001 = (SELECT ooef101 FROM ooef_t WHERE ooefent = dedhent AND ooef001 = dedhsite),",
               "                            (dedh006,dedh007,dedh008) = (SELECT inaa102,inaa111,inaa105 FROM inaa_t ",
               "                                                          WHERE inaaent = dedhent AND inaasite = dedhsite  ",
               "                                                            AND inaa001 = dedh005 ), ",
               "                            dedh015 = ",g_year,",",
               "                            dedh016 = ",g_month
   PREPARE adep150_dedh_upd FROM l_sql 
   EXECUTE adep150_dedh_upd

   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "UPDATE adep150_dedh_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   CREATE INDEX dedh_temp_01 ON adep150_dedh_temp(dedhent,dedhsite,dedh015,dedh016)
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "CREATE INDEX adep150_dedh_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF

   RETURN r_success   
END FUNCTION]]>
  </point>
  <point name="function.adep150_ins_temp15" order="53" ver="1" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adep150_ins_temp15(p_wc)
   DEFINE p_wc           STRING
   DEFINE l_wc           STRING
   DEFINE r_success      LIKE type_t.num5
   DEFINE l_sql          STRING
   DEFINE l_where        STRING
   
   LET r_success = TRUE
   DELETE FROM adep150_dedi_temp
   LET l_where = s_aooi500_sql_where(g_prog,'debgsite')
   LET l_wc = cl_replace_str(p_wc,'rtjasite','debgsite')
   
   LET l_sql = " INSERT INTO adep150_dedi_temp( dedient, dedisite,dedi005, ",
               "                                dedi007, dedi008, dedi009, dedi010, dedi011,",
               "                                dedi012, dedi013, dedi014, dedi015, dedi016,",
               "                                dedi017, dedi018, dedi020, dedi021, dedi022,",
               "                                dedi023, dedi024, dedi025, dedi026)",
               " SELECT debgent,      debgsite,        debg005,",
               "        debg007,                  debg008,                  SUM(COALESCE(debg009,0)), SUM(COALESCE(debg010,0)), SUM(COALESCE(debg011,0)),",
               "        SUM(COALESCE(debg012,0)), SUM(COALESCE(debg013,0)), SUM(COALESCE(debg014,0)), SUM(COALESCE(debg015,0)), SUM(COALESCE(debg016,0)),",
               "        SUM(COALESCE(debg017,0)), SUM(COALESCE(debg018,0)), SUM(COALESCE(debg020,0)), SUM(COALESCE(debg021,0)), SUM(COALESCE(debg022,0)),",
               "        SUM(COALESCE(debg023,0)), SUM(COALESCE(debg024,0)), SUM(COALESCE(debg025,0)), SUM(COALESCE(debg026,0))",
               "   FROM debg_t",
               "  WHERE debgent = ",g_enterprise,
               "    AND debg002 BETWEEN ? AND ? ",
               "    AND ",l_wc,
               "    AND ",l_where,
               "  GROUP BY debgent, debgsite, debg005, debg007, debg008 "

   PREPARE adep150_ins_dedi_temp_prep FROM l_sql
   EXECUTE adep150_ins_dedi_temp_prep USING g_sdate,g_edate
   
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "INSERT adep150_dedi_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   LET l_sql = "UPDATE adep150_dedi_temp SET dedi001 = (SELECT ooef101 FROM ooef_t WHERE ooefent = dedient AND ooef001 = dedisite),",
               "                             dedi006 = (SELECT mhae002 FROM mhae_t WHERE mhaeent = dedient AND mhaesite = dedisite AND mhae001 = dedi005),", 
               "                             dedi019 = CASE WHEN dedi018 = 0 THEN 0 ELSE (dedi018 / (CASE WHEN dedi015 = 0 THEN dedi018 ELSE dedi015 END) * 100) END,",
               "                             dedi027 = ",g_year,",",
               "                             dedi028 = ",g_month
   PREPARE adep150_dedi_upd FROM l_sql 
   EXECUTE adep150_dedi_upd
   
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "UPDATE adep150_dedi_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   CREATE INDEX dedi_temp_01 ON adep150_dedi_temp(dedient,dedisite,dedi027,dedi028)
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "CREATE INDEX adep150_dedi_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF      
   DELETE FROM adep150_dedj_temp
   LET l_where = s_aooi500_sql_where(g_prog,'debhsite')
   LET l_wc = cl_replace_str(p_wc,'rtjasite','debhsite')
   
   LET l_sql = "INSERT INTO adep150_dedj_temp( dedjent,  dedjsite, dedj005, dedj006,",
               "                               dedj007,  dedj008,  dedj009, dedj010, dedj011,",
               "                               dedj012,  dedj013,  dedj014, dedj015, dedj016,",
               "                               dedj018,  dedj019,  dedj020, dedj021, dedj022)",
               " SELECT debhent,       debhsite,         debh005,      debh006,",
               "        debh007,                   debh008,                   debh009,                  SUM(COALESCE(debh010,0)), SUM(COALESCE(debh011,0)),",
               "        SUM(COALESCE(debh012,0)),  SUM(COALESCE(debh013,0)),  SUM(COALESCE(debh014,0)), SUM(COALESCE(debh015,0)), SUM(COALESCE(debh016,0)),",
               "        SUM(COALESCE(debh018,0)),  SUM(COALESCE(debh019,0)),  SUM(COALESCE(debh020,0)), SUM(COALESCE(debh021,0)), SUM(COALESCE(debh022,0))",
               "   FROM debh_t",
               "  WHERE debhent = ",g_enterprise,
               "    AND debh002 BETWEEN ? AND ? ",
               "    AND ",l_wc,
               "    AND ",l_where,
               "  GROUP BY debhent, debhsite, debh005, debh006,",
               "           debh007, debh008,  debh009"
               
   PREPARE adep150_ins_dedj_temp_prep FROM l_sql
   EXECUTE adep150_ins_dedj_temp_prep USING g_sdate,g_edate
   
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "INSERT adep150_dedj_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF   

   LET l_sql = "UPDATE adep150_dedj_temp SET dedj001 = (SELECT ooef101 FROM ooef_t WHERE ooefent = dedjent AND ooef001 = dedjsite),",
               "                             dedj017 = CASE WHEN dedj016 = 0 THEN 0 ELSE (dedj016 / (CASE WHEN dedj015 = 0 THEN dedj016 ELSE dedj015 END) * 100) END,",
               "                             dedj023 = ",g_year,",",
               "                             dedj024 = ",g_month
   PREPARE adep150_dedj_upd FROM l_sql 
   EXECUTE adep150_dedj_upd

   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "UPDATE adep150_dedj_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   CREATE INDEX dedj_temp_01 ON adep150_dedj_temp(dedjent,dedjsite,dedj023,dedj024)
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "CREATE INDEX adep150_dedj_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   DELETE FROM adep150_dedk_temp
   LET l_where = s_aooi500_sql_where(g_prog,'debisite')
   LET l_wc = cl_replace_str(p_wc,'rtjasite','debisite')
   
   LET l_sql = " INSERT INTO adep150_dedk_temp( dedkent,  dedksite, dedk005, ",
               "                                dedk007,  dedk008,  dedk009, dedk010, dedk011) ",
               " SELECT debient,       debisite,      debi005, ",
               "        debi007,       debi008,       debi009,      debi010,      SUM(COALESCE(debi011,0))",
               "   FROM debi_t",
               "  WHERE debient = ",g_enterprise,
               "    AND debi002 BETWEEN ? AND ? ",
               "    AND ",l_wc,
               "    AND ",l_where,
               "  GROUP BY debient, debisite, debi005, ",
               "           debi007, debi008,  debi009, debi010"
               
   PREPARE adep150_ins_dedk_temp_prep FROM l_sql
   EXECUTE adep150_ins_dedk_temp_prep USING g_sdate,g_edate   
   
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "INSERT adep150_dedk_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   LET l_sql = "UPDATE adep150_dedk_temp SET dedk001 = (SELECT ooef101 FROM ooef_t WHERE ooefent = dedkent AND ooef001 = dedksite),",
               "                             dedk006 = (SELECT mhae002 FROM mhae_t WHERE mhaeent = dedkent AND mhaesite = dedksite AND mhae001 = dedk005),", 
               "                             dedk012 = ",g_year,",",
               "                             dedk013 = ",g_month
   PREPARE adep150_dedk_upd FROM l_sql 
   EXECUTE adep150_dedk_upd

   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "UPDATE adep150_dedk_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   CREATE INDEX dedk_temp_01 ON adep150_dedk_temp(dedkent,dedksite,dedk012,dedk013)
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "CREATE INDEX adep150_dedk_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF

   RETURN r_success  
END FUNCTION]]>
  </point>
  <point name="function.adep150_ins_temp16" order="54" ver="1" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adep150_ins_temp16(p_wc)
   DEFINE p_wc           STRING
   DEFINE l_wc           STRING
   DEFINE r_success      LIKE type_t.num5
   DEFINE l_sql          STRING
   DEFINE l_where        STRING
   
   LET r_success = TRUE
   DELETE FROM adep150_dedl_temp
   LET l_where = s_aooi500_sql_where(g_prog,'debksite')
   LET l_wc = cl_replace_str(p_wc,'rtjasite','debksite')
   
   LET l_sql = " INSERT INTO adep150_dedl_temp( dedlent, dedlsite,dedl005, dedl006,",
               "                                dedl007, dedl008, dedl009, dedl010, dedl011,",
               "                                dedl012, dedl013, dedl014, dedl015, dedl017,",
               "                                dedl018, dedl019, dedl020, dedl021, dedl022,",
               "                                dedl023) ",
               " SELECT debkent,      debksite,       debk005,      SUM(COALESCE(debk006,0)),",
               "        SUM(COALESCE(debk007,0)), SUM(COALESCE(debk008,0)), SUM(COALESCE(debk009,0)), SUM(COALESCE(debk010,0)), SUM(COALESCE(debk011,0)),",
               "        SUM(COALESCE(debk012,0)), SUM(COALESCE(debk013,0)), SUM(COALESCE(debk014,0)), SUM(COALESCE(debk015,0)), SUM(COALESCE(debk017,0)),",
               "        SUM(COALESCE(debk018,0)), SUM(COALESCE(debk019,0)), SUM(COALESCE(debk020,0)), SUM(COALESCE(debk021,0)), SUM(COALESCE(debk022,0)),",
               "        SUM(COALESCE(debk023,0)) ",
               "   FROM debk_t",
               "  WHERE debkent = ",g_enterprise,
               "    AND debk002 BETWEEN ? AND ? ",
               "    AND ",l_wc,
               "    AND ",l_where,
               "  GROUP BY debkent, debksite, debk005 "

   PREPARE adep150_ins_dedl_temp_prep FROM l_sql
   EXECUTE adep150_ins_dedl_temp_prep USING g_sdate,g_edate
   
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "INSERT adep150_dedl_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   LET l_sql = "UPDATE adep150_dedl_temp SET dedl001 = (SELECT ooef101 FROM ooef_t WHERE ooefent = dedlent AND ooef001 = dedlsite),", 
               "                             dedl016 = CASE WHEN dedl015 = 0 THEN 0 ELSE (dedl015 / (CASE WHEN dedl011 = 0 THEN dedl015 ELSE dedl011 END) * 100) END,",
               "                             dedl024 = ",g_year,",",
               "                             dedl025 = ",g_month               
   PREPARE adep150_dedl_upd FROM l_sql 
   EXECUTE adep150_dedl_upd    
   
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "UPDATE adep150_dedl_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   CREATE INDEX dedl_temp_01 ON adep150_dedl_temp(dedlent,dedlsite,dedl024,dedl025)
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "CREATE INDEX adep150_dedl_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF      
   DELETE FROM adep150_dedm_temp
   LET l_where = s_aooi500_sql_where(g_prog,'deblsite')
   LET l_wc = cl_replace_str(p_wc,'rtjasite','deblsite')
   LET l_sql = " INSERT INTO adep150_dedm_temp( dedment,  dedmsite, dedm005, dedm006,",
               "                                dedm007,  dedm008,  dedm009, dedm010, dedm011,",
               "                                dedm012,  dedm013,  dedm014, dedm016, dedm017,",
               "                                dedm018,  dedm019,  dedm020) ",
               " SELECT deblent,       deblsite,      debl005,      debl006, ",
               "        debl007,                   SUM(COALESCE(debl008,0)),  SUM(COALESCE(debl009,0)), SUM(COALESCE(debl010,0)), SUM(COALESCE(debl011,0)),",
               "        SUM(COALESCE(debl012,0)),  SUM(COALESCE(debl013,0)),  SUM(COALESCE(debl014,0)), SUM(COALESCE(debl016,0)), SUM(COALESCE(debl017,0)),",
               "        SUM(COALESCE(debl018,0)),  SUM(COALESCE(debl019,0)),  SUM(COALESCE(debl020,0))",
               "   FROM debl_t ",
               "  WHERE deblent = ",g_enterprise,
               "    AND debl002 BETWEEN ? AND ? ",
               "    AND ",l_wc,
               "    AND ",l_where,
               "  GROUP BY deblent, deblsite, debl005, debl006, debl007 "
                    
   PREPARE adep150_ins_dedm_temp_prep FROM l_sql
   EXECUTE adep150_ins_dedm_temp_prep USING g_sdate,g_edate
   
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "INSERT adep150_dedm_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   LET l_sql = "UPDATE adep150_dedm_temp SET dedm001 = (SELECT ooef101 FROM ooef_t WHERE ooefent = dedment AND ooef001 = dedmsite),",
               "                             dedm015 = CASE WHEN dedm014 = 0 THEN 0 ELSE (dedm014 / (CASE WHEN dedm013 = 0 THEN dedm014 ELSE dedm013 END) * 100) END,",
               "                             dedm021 = ",g_year,",",
               "                             dedm022 = ",g_month
   PREPARE adep150_dedm_upd FROM l_sql 
   EXECUTE adep150_dedm_upd
   
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "UPDATE adep150_dedm_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   CREATE INDEX dedm_temp_01 ON adep150_dedm_temp(dedment,dedmsite,dedm021,dedm022)
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "CREATE INDEX adep150_dedm_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   DELETE FROM adep150_dedn_temp
   LET l_where = s_aooi500_sql_where(g_prog,'debmsite')
   LET l_wc = cl_replace_str(p_wc,'rtjasite','debmsite')
   LET l_sql = " INSERT INTO adep150_dedn_temp( dednent,  dednsite,  dedn005, dedn006,",
               "                                dedn007,  dedn008)",
               " SELECT debment,       debmsite,       debm005,      debm006,",
               "        debm007,       SUM(COALESCE(debm008,0))",
               "   FROM debm_t",
               "  WHERE debment = ",g_enterprise,
               "    AND debm002 BETWEEN ? AND ? ",
               "    AND ",l_wc,
               "    AND ",l_where,
               "  GROUP BY debment, debmsite, debm005, debm006, debm007"
               
   PREPARE adep150_ins_dedn_temp_prep FROM l_sql
   EXECUTE adep150_ins_dedn_temp_prep USING g_sdate,g_edate
   
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "INSERT adep150_dedn_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   

   LET l_sql = "UPDATE adep150_dedn_temp SET dedn001 = (SELECT ooef101 FROM ooef_t WHERE ooefent = dednent AND ooef001 = dednsite),",
               "                             dedn009 = ",g_year,",",
               "                             dedn010 = ",g_month
   PREPARE adep150_dedn_upd FROM l_sql 
   EXECUTE adep150_dedn_upd       
               
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "UPDATE adep150_dedn_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   CREATE INDEX dedn_temp_01 ON adep150_dedn_temp(dednent,dednsite,dedn009,dedn010)
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "CREATE INDEX adep150_dedn_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF

   RETURN r_success

END FUNCTION]]>
  </point>
  <point name="function.adep150_ins_temp17" order="55" ver="1" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adep150_ins_temp17(p_wc)
   DEFINE p_wc           STRING
   DEFINE l_wc           STRING
   DEFINE r_success      LIKE type_t.num5
   DEFINE l_sql          STRING
   DEFINE l_where        STRING
   
   LET r_success = TRUE
   DELETE FROM adep150_debv_temp
   LET l_where = s_aooi500_sql_where(g_prog,'debosite')
   LET l_wc = cl_replace_str(p_wc,'rtjasite','debosite')
   LET l_sql = " INSERT INTO adep150_debv_temp( debvent, debvsite,debv012, debv013,",
               "                                debv014, debv015, debv016, debv017, debv018,",
               "                                debv020, debv025, debv026, debv027, debv028,",
               "                                debv029, debv030, debv031, debv032, debv033)",
               " SELECT deboent,      debosite,   SUM(COALESCE(debo005,0)), SUM(COALESCE(debo006,0)),",
               "        SUM(COALESCE(debo007,0)), SUM(COALESCE(debo008,0)), SUM(COALESCE(debo009,0)), SUM(COALESCE(debo010,0)), SUM(COALESCE(debo014,0)),",
               "        SUM(COALESCE(debo016,0)), SUM(COALESCE(debo017,0)), SUM(COALESCE(debo018,0)), SUM(COALESCE(debo019,0)), SUM(COALESCE(debo020,0)),",
               "        SUM(COALESCE(debo011,0)), SUM(COALESCE(debo012,0)), SUM(COALESCE(debo013,0)), SUM(COALESCE(debo023,0)), SUM(COALESCE(debo024,0)) ",
               "   FROM debo_t",
               "  WHERE deboent = ",g_enterprise,
               "    AND debo002 BETWEEN ? AND ? ",
               "    AND ",l_wc,
               "    AND ",l_where,
               "  GROUP BY deboent, debosite "
               
   PREPARE adep150_ins_debv_temp_prep FROM l_sql
   EXECUTE adep150_ins_debv_temp_prep USING g_sdate,g_edate
   
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "INSERT adep150_debv_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   LET l_sql = "UPDATE adep150_debv_temp SET debv001 = (SELECT ooef101 FROM ooef_t WHERE ooefent = debvent AND ooef001 = debvsite),",
               "                             debv019 = CASE WHEN debv018 = 0 THEN 0 ELSE (debv018 / (CASE WHEN debv017 = 0 THEN debv018 ELSE debv017 END) * 100) END,",
               "                             debv034 = debv017 / (CASE WHEN debv020 = 0 THEN 1 ELSE debv020 END),",
               "                             debv002 = ",g_year,",",
               "                             debv003 = ",g_month
               
   PREPARE adep150_debv_upd FROM l_sql 
   EXECUTE adep150_debv_upd
   
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "UPDATE adep150_debv_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   CREATE INDEX debv_temp_01 ON adep150_debv_temp(debvent,debvsite,debv002,debv003)
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "CREATE INDEX adep150_debv_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF      
   DELETE FROM adep150_dedo_temp
   LET l_where = s_aooi500_sql_where(g_prog,'debpsite')
   LET l_wc = cl_replace_str(p_wc,'rtjasite','debpsite')
   LET l_sql = " INSERT INTO adep150_dedo_temp( dedoent,  dedosite, dedo005, dedo006,",
               "                                dedo007,  dedo008,  dedo009, dedo010, dedo011,",
               "                                dedo012,  dedo013,  dedo015, dedo016, dedo017,",
               "                                dedo018,  dedo019)",
               " SELECT debpent,       debpsite,        debp005,      debp006,",
               "        SUM(COALESCE(debp007,0)),  SUM(COALESCE(debp008,0)),  SUM(COALESCE(debp009,0)), SUM(COALESCE(debp010,0)), SUM(COALESCE(debp011,0)),",
               "        SUM(COALESCE(debp012,0)),  SUM(COALESCE(debp013,0)),  SUM(COALESCE(debp015,0)), SUM(COALESCE(debp016,0)), SUM(COALESCE(debp017,0)),",
               "        SUM(COALESCE(debp018,0)),  SUM(COALESCE(debp019,0))",
               "   FROM debp_t",
               "  WHERE debpent = ",g_enterprise,
               "    AND debp002 BETWEEN ? AND ? ",
               "    AND ",l_wc,
               "    AND ",l_where,
               "  GROUP BY debpent, debpsite, debp005, debp006 "

   PREPARE adep150_ins_dedo_temp_prep FROM l_sql
   EXECUTE adep150_ins_dedo_temp_prep USING g_sdate,g_edate

   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "INSERT adep150_dedo_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   LET l_sql = "UPDATE adep150_dedo_temp SET dedo001 = (SELECT ooef101 FROM ooef_t WHERE ooefent = dedoent AND ooef001 = dedosite),",
               "                             dedo014 = CASE WHEN dedo013 = 0 THEN 0 ELSE (dedo013 / (CASE WHEN dedo012 = 0 THEN dedo013 ELSE dedo012 END) * 100) END,",
               "                             dedo022 = dedo012 / (CASE WHEN dedo016 = 0 THEN 1 ELSE dedo016 END), ",
               "                             dedo020 = ",g_year,",",
               "                             dedo021 = ",g_month
   PREPARE adep150_dedo_upd FROM l_sql 
   EXECUTE adep150_dedo_upd
   
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "UPDATE adep150_dedo_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   CREATE INDEX dedo_temp_01 ON adep150_dedo_temp(dedoent,dedosite,dedo020,dedo021)
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "CREATE INDEX adep150_dedo_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   DELETE FROM adep150_dedp_temp
   LET l_where = s_aooi500_sql_where(g_prog,'debqsite')
   LET l_wc = cl_replace_str(p_wc,'rtjasite','debqsite')
   LET l_sql = " INSERT INTO adep150_dedp_temp( dedpent,  dedpsite, dedp005, dedp006, dedp007) ",
               " SELECT debqent,       debqsite,       debq005,      debq006,  SUM(COALESCE(debq007,0))",
               "   FROM debq_t",  
               "  WHERE debqent = ",g_enterprise,
               "    AND debq002 BETWEEN ? AND ? ",
               "    AND ",l_wc,
               "    AND ",l_where,
               "  GROUP BY debqent, debqsite, debq005, debq006 "

   PREPARE adep150_ins_dedp_temp_prep FROM l_sql
   EXECUTE adep150_ins_dedp_temp_prep USING g_sdate,g_edate
   
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "INSERT adep150_dedp_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   LET l_sql = "UPDATE adep150_dedp_temp SET dedp001 = (SELECT ooef101 FROM ooef_t WHERE ooefent = dedpent AND ooef001 = dedpsite),", 
               "                             dedp008 = ",g_year,",",
               "                             dedp009 = ",g_month
   PREPARE adep150_dedp_upd FROM l_sql
   EXECUTE adep150_dedp_upd
   
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "UPDATE adep150_dedp_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   CREATE INDEX dedp_temp_01 ON adep150_dedp_temp(dedpent,dedpsite,dedp008,dedp009)
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "CREATE INDEX adep150_dedp_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF

   RETURN r_success 

END FUNCTION]]>
  </point>
  <point name="function.adep150_ins_temp19" order="56" ver="1" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION adep150_ins_temp19(p_wc)
   DEFINE p_wc           STRING
   DEFINE l_wc           STRING
   DEFINE r_success      LIKE type_t.num5
   DEFINE l_sql          STRING
   DEFINE l_where        STRING
   DEFINE l_init_date    LIKE type_t.dat
   
   LET r_success = TRUE
   DELETE FROM adep150_deds_temp
   LET l_where = s_aooi500_sql_where(g_prog,'debysite')
   LET l_wc = cl_replace_str(p_wc,'rtjasite','debysite')
   LET l_sql = " INSERT INTO adep150_deds_temp( dedsent, dedssite,deds002, deds004,",
               "                                deds005, deds006, deds007, deds008, deds009,",
               "                                deds010, deds011, deds012, deds013, deds014,",
               "                                deds015, deds016, deds017, deds018 ) ",
               " SELECT debyent,                  debysite,                 deby002,                  SUM(COALESCE(deby004,0)),",
               "        deby005,                  SUM(COALESCE(deby006,0)), COALESCE(deby007,? ),    COALESCE(deby008,' '),       COALESCE(deby009,' '),",
               "        COALESCE(deby010,' '),    deby011,                  SUM(COALESCE(deby012,0)), COALESCE(deby013,' '),       SUM(COALESCE(deby014,0)),",
               "        COALESCE(deby015,' '),    SUM(COALESCE(deby016,0)), SUM(COALESCE(deby017,0)), SUM(COALESCE(deby018,0)) ",
               "   FROM deby_t ",
               "  WHERE debyent = ",g_enterprise,
               "    AND deby003 BETWEEN ? AND ? ",
               "    AND ",l_wc,
               "    AND ",l_where,
               "  GROUP BY debyent, debysite, deby002, deby005,",
               "           deby007, deby008,  deby009, deby010, deby011,",
               "           deby013, deby015 "
               
   PREPARE adep150_ins_deds_temp_prep FROM l_sql
   EXECUTE adep150_ins_deds_temp_prep USING l_init_date,g_sdate,g_edate
   
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "INSERT adep150_deds_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   LET l_sql = "UPDATE adep150_deds_temp SET deds001 = (SELECT ooia002 FROM ooia_t WHERE ooiaent = dedsent AND ooia001 = deds002),",
               "                             deds019 = ",g_year,",",
               "                             deds020 = ",g_month
   PREPARE adep150_deds_upd FROM l_sql 
   EXECUTE adep150_deds_upd
   
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "UPDATE adep150_deds_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   CREATE INDEX deds_temp_01 ON adep150_deds_temp(dedsent,dedssite,deds019,deds020)
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "CREATE INDEX adep150_deds_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF      
   DELETE FROM adep150_dedt_temp
   LET l_where = s_aooi500_sql_where(g_prog,'debzsite')
   LET l_wc = cl_replace_str(p_wc,'rtjasite','debzsite')
   
   LET l_sql = " INSERT INTO adep150_dedt_temp( dedtent,  dedtsite, dedt005, ",
               "                                dedt007,  dedt008,  dedt009, dedt010, dedt011,",
               "                                dedt012,  dedt013,  dedt014, dedt015, dedt016,",
               "                                dedt017,  dedt018) ",
               " SELECT debzent,                   debzsite,                  debz005, ",
               "        debz007,                   debz008,                   SUM(COALESCE(debz009,0)), SUM(COALESCE(debz010,0)), SUM(COALESCE(debz011,0)),",
               "        SUM(COALESCE(debz012,0)),  SUM(COALESCE(debz013,0)),  debz014 ,                 SUM(COALESCE(debz015,0)), SUM(COALESCE(debz016,0)),",
               "        SUM(COALESCE(debz017,0)),  debz018 ",
               "   FROM debz_t ",
               "  WHERE debzent = ",g_enterprise,
               "    AND debz002 BETWEEN ? AND ? ",
               "    AND ",l_wc,
               "    AND ",l_where,
               "  GROUP BY debzent, debzsite, debz005, ",
               "           debz007, debz008,  debz014, debz018"
               
   PREPARE adep150_ins_dedt_temp_prep FROM l_sql
   EXECUTE adep150_ins_dedt_temp_prep USING g_sdate,g_edate   
   
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "INSERT adep150_dedt_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF   

   LET l_sql = "UPDATE adep150_dedt_temp SET dedt001 = (SELECT ooef101 FROM ooef_t WHERE ooefent = dedtent AND ooef001 = dedtsite),",
               "                             dedt006 = (SELECT mhae002 FROM mhae_t WHERE mhaeent = dedtent AND mhaesite = dedtsite AND mhae001 = dedt005), ", 
               "                             dedt019 = ",g_year,",",
               "                             dedt020 = ",g_month
   PREPARE adep150_dedt_upd FROM l_sql 
   EXECUTE adep150_dedt_upd

   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "UPDATE adep150_dedt_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   CREATE INDEX dedt_temp_01 ON adep150_dedt_temp(dedtent,dedtsite,dedt019,dedt020)
   IF SQLCA.SQLcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "CREATE INDEX adep150_dedt_temp"
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   RETURN r_success
END FUNCTION]]>
  </point>
  <point name="construct.c.rtjasite" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.where = s_aooi500_q_where(g_prog,'rtjasite',g_site,'c')
            CALL q_ooef001_24()
            DISPLAY g_qryparam.return1 TO rtjasite  #顯示到畫面上
            NEXT FIELD rtjasite                     #返回原欄位  ]]>
  </point>
  <point name="global.parameter" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[        rtjadocdt        LIKE rtja_t.rtjadocdt,
        l_del            LIKE type_t.chr1,]]>
  </point>
  <point name="global.variable" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[DEFINE g_yearmonth   LIKE type_t.num10
DEFINE g_week        LIKE type_t.num5
DEFINE g_sdate       LIKE type_t.dat
DEFINE g_edate       LIKE type_t.dat
DEFINE g_year        LIKE type_t.num5
DEFINE g_month       LIKE type_t.num5]]>
  </point>
  <point name="init.define" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   DEFINE l_success LIKE type_t.num5]]>
  </point>
  <point name="init.init" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   ]]>
  </point>
  <point name="main.background" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   CALL s_aooi500_create_temp() RETURNING l_success]]>
  </point>
  <point name="main.define" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   DEFINE l_success LIKE type_t.num5]]>
  </point>
  <point name="main.exit" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   CALL s_aooi500_drop_temp() RETURNING l_success]]>
  </point>
  <point name="process.count_progress" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[      CALL cl_progress_bar_no_window(3)]]>
  </point>
  <point name="process.define" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   DEFINE l_success     LIKE type_t.num5
   DEFINE l_year        LIKE type_t.num10
   DEFINE l_month       LIKE type_t.num10   
   DEFINE l_week        LIKE type_t.num5
   DEFINE l_sdate       LIKE type_t.dat
   DEFINE l_edate       LIKE type_t.dat
   DEFINE l_msg         STRING]]>
  </point>
  <point name="process.exit_dialog" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[      LET lc_param.rtjadocdt = g_master.rtjadocdt
      LET lc_param.l_del  = g_master.l_del]]>
  </point>
  <point name="process.pre_process" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="process.process" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   
   #取得週結範圍與日期相關資料
   LET l_year = YEAR(lc_param.rtjadocdt)
   LET l_month = MONTH(lc_param.rtjadocdt)   
   LET g_yearmonth = (l_year * 100) + l_month 
   
   LET l_sdate = MDY(l_month,1,l_year)                                   #結算日期的該月第一天
   LET l_edate = MDY(l_month,s_date_get_max_day(l_year,l_month),l_year)  #結算日期的該月最後一天
   
   IF g_argv[1] = '0' OR g_argv[1] = '1' OR g_argv[1] = '4' OR g_argv[1] = '5' OR
      g_argv[1] = '6' OR g_argv[1] = '7' OR g_argv[1] = '9' THEN
      
      #週結資料範圍 主要欄位抓取
      LET l_week = ''
      SELECT ooga013 INTO l_week FROM ooga_t
       WHERE oogaent = g_enterprise
         AND ooga001 = lc_param.rtjadocdt
      IF cl_null(l_week) THEN 
         #日曆檔中取不到本日"月週"的資料
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = 'ade-00116'
         LET g_errparam.extend = lc_param.rtjadocdt
         LET g_errparam.popup = TRUE
         CALL cl_err()      
         RETURN
      END IF   
     
      LET g_sdate = ''    #此次結算的起始日
      LET g_edate = ''    #此次結算的截止日
      
      #每個月只計4週,超過第四週的都以第四週計算
      IF l_week >= 4 THEN 
         LET g_week = 4       
         SELECT min(ooga001) INTO g_sdate FROM ooga_t
          WHERE oogaent = g_enterprise
            AND ooga012 = l_month
            AND ooga013 = g_week
            AND ooga001 BETWEEN l_sdate AND l_edate
     
         LET g_edate = l_edate
      ELSE 
         LET g_week = l_week
         
         SELECT min(ooga001),max(ooga001) INTO g_sdate,g_edate FROM ooga_t
          WHERE oogaent = g_enterprise
            AND ooga012 = l_month
            AND ooga013 = l_week
            AND ooga001 BETWEEN l_sdate AND l_edate
      END IF  
   ELSE
      #月結資料範圍 主要欄位
      LET g_year = l_year
      LET g_month = l_month
      LET g_sdate = l_sdate
      LET g_edate = l_edate
   END IF
   
   CASE g_argv[1]
      WHEN '0'
         IF adep150_create_temp0() THEN
            LET l_msg = cl_getmsg('ade-00114',g_lang)
            CALL cl_progress_no_window_ing(l_msg)
            IF NOT adep150_ins_temp0(lc_param.wc) THEN
               CALL adep150_drop_temp0() RETURNING l_success
               RETURN
            END IF
         ELSE
            CALL adep150_drop_temp0() RETURNING l_success
            RETURN
         END IF    

         CALL cl_err_collect_init()
         CALL s_transaction_begin()  
         LET l_msg = cl_getmsg('ast-00330',g_lang)
         CALL cl_progress_no_window_ing(l_msg)         
         CALL adep150_process0(lc_param.l_del) RETURNING l_success
         CALL cl_err_collect_show()
         IF l_success THEN
            LET l_msg = cl_getmsg('std-00012',g_lang)
            CALL cl_progress_no_window_ing(l_msg)
            CALL s_transaction_end('Y','1')
         ELSE
            CALL s_transaction_end('N','0')
         END IF
         
         CALL adep150_drop_temp0() RETURNING l_success

      WHEN '1'
         IF adep150_create_temp1() THEN
            LET l_msg = cl_getmsg('ade-00114',g_lang)
            CALL cl_progress_no_window_ing(l_msg)
            IF NOT adep150_ins_temp1(lc_param.wc) THEN
               CALL adep150_drop_temp1() RETURNING l_success
               RETURN
            END IF
         ELSE
            CALL adep150_drop_temp1() RETURNING l_success
            RETURN
         END IF    

         CALL cl_err_collect_init()
         CALL s_transaction_begin()  
         LET l_msg = cl_getmsg('ast-00330',g_lang)
         CALL cl_progress_no_window_ing(l_msg)         
         CALL adep150_process1(lc_param.l_del) RETURNING l_success
         CALL cl_err_collect_show()
         IF l_success THEN
            LET l_msg = cl_getmsg('std-00012',g_lang)
            CALL cl_progress_no_window_ing(l_msg)
            CALL s_transaction_end('Y','1')
         ELSE
            CALL s_transaction_end('N','0')
         END IF
         
         CALL adep150_drop_temp1() RETURNING l_success
      WHEN '4'
         IF adep150_create_temp4() THEN
            LET l_msg = cl_getmsg('ade-00114',g_lang)
            CALL cl_progress_no_window_ing(l_msg)
            IF NOT adep150_ins_temp4(lc_param.wc) THEN
               CALL adep150_drop_temp4() RETURNING l_success
               RETURN
            END IF
         ELSE
            CALL adep150_drop_temp4() RETURNING l_success
            RETURN
         END IF    

         CALL cl_err_collect_init()
         CALL s_transaction_begin()  
         LET l_msg = cl_getmsg('ast-00330',g_lang)
         CALL cl_progress_no_window_ing(l_msg)         
         CALL adep150_process4(lc_param.l_del) RETURNING l_success
         CALL cl_err_collect_show()
         IF l_success THEN
            LET l_msg = cl_getmsg('std-00012',g_lang)
            CALL cl_progress_no_window_ing(l_msg)
            CALL s_transaction_end('Y','1')
         ELSE
            CALL s_transaction_end('N','0')
         END IF
         
         CALL adep150_drop_temp4() RETURNING l_success
      WHEN '5'
         IF adep150_create_temp5() THEN
            LET l_msg = cl_getmsg('ade-00114',g_lang)
            CALL cl_progress_no_window_ing(l_msg)
            IF NOT adep150_ins_temp5(lc_param.wc) THEN
               CALL adep150_drop_temp5() RETURNING l_success
               RETURN
            END IF
         ELSE
            CALL adep150_drop_temp5() RETURNING l_success
            RETURN
         END IF    

         CALL cl_err_collect_init()
         CALL s_transaction_begin()  
         LET l_msg = cl_getmsg('ast-00330',g_lang)
         CALL cl_progress_no_window_ing(l_msg)         
         CALL adep150_process5(lc_param.l_del) RETURNING l_success
         CALL cl_err_collect_show()
         IF l_success THEN
            LET l_msg = cl_getmsg('std-00012',g_lang)
            CALL cl_progress_no_window_ing(l_msg)
            CALL s_transaction_end('Y','1')
         ELSE
            CALL s_transaction_end('N','0')
         END IF
         
         CALL adep150_drop_temp5() RETURNING l_success

      WHEN '6'
         IF adep150_create_temp6() THEN
            LET l_msg = cl_getmsg('ade-00114',g_lang)
            CALL cl_progress_no_window_ing(l_msg)
            IF NOT adep150_ins_temp6(lc_param.wc) THEN
               CALL adep150_drop_temp6() RETURNING l_success
               RETURN
            END IF
         ELSE
            CALL adep150_drop_temp6() RETURNING l_success
            RETURN
         END IF    

         CALL cl_err_collect_init()
         CALL s_transaction_begin()  
         LET l_msg = cl_getmsg('ast-00330',g_lang)
         CALL cl_progress_no_window_ing(l_msg)         
         CALL adep150_process6(lc_param.l_del) RETURNING l_success
         CALL cl_err_collect_show()
         IF l_success THEN
            LET l_msg = cl_getmsg('std-00012',g_lang)
            CALL cl_progress_no_window_ing(l_msg)
            CALL s_transaction_end('Y','1')
         ELSE
            CALL s_transaction_end('N','0')
         END IF
         
         CALL adep150_drop_temp6() RETURNING l_success
      WHEN '7'
         IF adep150_create_temp7() THEN
            LET l_msg = cl_getmsg('ade-00114',g_lang)
            CALL cl_progress_no_window_ing(l_msg)
            IF NOT adep150_ins_temp7(lc_param.wc) THEN
               CALL adep150_drop_temp7() RETURNING l_success
               RETURN
            END IF
         ELSE
            CALL adep150_drop_temp7() RETURNING l_success
            RETURN
         END IF    

         CALL cl_err_collect_init()
         CALL s_transaction_begin()  
         LET l_msg = cl_getmsg('ast-00330',g_lang)
         CALL cl_progress_no_window_ing(l_msg)         
         CALL adep150_process7(lc_param.l_del) RETURNING l_success
         CALL cl_err_collect_show()
         IF l_success THEN
            LET l_msg = cl_getmsg('std-00012',g_lang)
            CALL cl_progress_no_window_ing(l_msg)
            CALL s_transaction_end('Y','1')
         ELSE
            CALL s_transaction_end('N','0')
         END IF
         
         CALL adep150_drop_temp7() RETURNING l_success
      WHEN '9'
         IF adep150_create_temp9() THEN
            LET l_msg = cl_getmsg('ade-00114',g_lang)
            CALL cl_progress_no_window_ing(l_msg)
            IF NOT adep150_ins_temp9(lc_param.wc) THEN
               CALL adep150_drop_temp9() RETURNING l_success
               RETURN
            END IF
         ELSE
            CALL adep150_drop_temp9() RETURNING l_success
            RETURN
         END IF    

         CALL cl_err_collect_init()
         CALL s_transaction_begin()  
         LET l_msg = cl_getmsg('ast-00330',g_lang)
         CALL cl_progress_no_window_ing(l_msg)         
         CALL adep150_process9(lc_param.l_del) RETURNING l_success
         CALL cl_err_collect_show()
         IF l_success THEN
            LET l_msg = cl_getmsg('std-00012',g_lang)
            CALL cl_progress_no_window_ing(l_msg)
            CALL s_transaction_end('Y','1')
         ELSE
            CALL s_transaction_end('N','0')
         END IF
         
         CALL adep150_drop_temp9() RETURNING l_success

      WHEN '10'
         IF adep150_create_temp10() THEN
            LET l_msg = cl_getmsg('ade-00114',g_lang)
            CALL cl_progress_no_window_ing(l_msg)
            IF NOT adep150_ins_temp10(lc_param.wc) THEN
               CALL adep150_drop_temp10() RETURNING l_success
               RETURN
            END IF
         ELSE
            CALL adep150_drop_temp10() RETURNING l_success
            RETURN
         END IF    

         CALL cl_err_collect_init()
         CALL s_transaction_begin()  
         LET l_msg = cl_getmsg('ast-00330',g_lang)
         CALL cl_progress_no_window_ing(l_msg)         
         CALL adep150_process10(lc_param.l_del) RETURNING l_success
         CALL cl_err_collect_show()
         IF l_success THEN
            LET l_msg = cl_getmsg('std-00012',g_lang)
            CALL cl_progress_no_window_ing(l_msg)
            CALL s_transaction_end('Y','1')
         ELSE
            CALL s_transaction_end('N','0')
         END IF
         
         CALL adep150_drop_temp10() RETURNING l_success
      WHEN '11'
         IF adep150_create_temp11() THEN
            LET l_msg = cl_getmsg('ade-00114',g_lang)
            CALL cl_progress_no_window_ing(l_msg)
            IF NOT adep150_ins_temp11(lc_param.wc) THEN
               CALL adep150_drop_temp11() RETURNING l_success
               RETURN
            END IF
         ELSE
            CALL adep150_drop_temp11() RETURNING l_success
            RETURN
         END IF    

         CALL cl_err_collect_init()
         CALL s_transaction_begin()  
         LET l_msg = cl_getmsg('ast-00330',g_lang)
         CALL cl_progress_no_window_ing(l_msg)         
         CALL adep150_process11(lc_param.l_del) RETURNING l_success
         CALL cl_err_collect_show()
         IF l_success THEN
            LET l_msg = cl_getmsg('std-00012',g_lang)
            CALL cl_progress_no_window_ing(l_msg)
            CALL s_transaction_end('Y','1')
         ELSE
            CALL s_transaction_end('N','0')
         END IF
         
         CALL adep150_drop_temp11() RETURNING l_success
      WHEN '14'
         IF adep150_create_temp14() THEN
            LET l_msg = cl_getmsg('ade-00114',g_lang)
            CALL cl_progress_no_window_ing(l_msg)
            IF NOT adep150_ins_temp14(lc_param.wc) THEN
               CALL adep150_drop_temp14() RETURNING l_success
               RETURN
            END IF
         ELSE
            CALL adep150_drop_temp14() RETURNING l_success
            RETURN
         END IF    

         CALL cl_err_collect_init()
         CALL s_transaction_begin()  
         LET l_msg = cl_getmsg('ast-00330',g_lang)
         CALL cl_progress_no_window_ing(l_msg)         
         CALL adep150_process14(lc_param.l_del) RETURNING l_success
         CALL cl_err_collect_show()
         IF l_success THEN
            LET l_msg = cl_getmsg('std-00012',g_lang)
            CALL cl_progress_no_window_ing(l_msg)
            CALL s_transaction_end('Y','1')
         ELSE
            CALL s_transaction_end('N','0')
         END IF
         
         CALL adep150_drop_temp14() RETURNING l_success
      WHEN '15'
         IF adep150_create_temp15() THEN
            LET l_msg = cl_getmsg('ade-00114',g_lang)
            CALL cl_progress_no_window_ing(l_msg)
            IF NOT adep150_ins_temp15(lc_param.wc) THEN
               CALL adep150_drop_temp15() RETURNING l_success
               RETURN
            END IF
         ELSE
            CALL adep150_drop_temp15() RETURNING l_success
            RETURN
         END IF    

         CALL cl_err_collect_init()
         CALL s_transaction_begin()  
         LET l_msg = cl_getmsg('ast-00330',g_lang)
         CALL cl_progress_no_window_ing(l_msg)         
         CALL adep150_process15(lc_param.l_del) RETURNING l_success
         CALL cl_err_collect_show()
         IF l_success THEN
            LET l_msg = cl_getmsg('std-00012',g_lang)
            CALL cl_progress_no_window_ing(l_msg)
            CALL s_transaction_end('Y','1')
         ELSE
            CALL s_transaction_end('N','0')
         END IF
         
         CALL adep150_drop_temp15() RETURNING l_success

      WHEN '16'
         IF adep150_create_temp16() THEN
            LET l_msg = cl_getmsg('ade-00114',g_lang)
            CALL cl_progress_no_window_ing(l_msg)
            IF NOT adep150_ins_temp16(lc_param.wc) THEN
               CALL adep150_drop_temp16() RETURNING l_success
               RETURN
            END IF
         ELSE
            CALL adep150_drop_temp16() RETURNING l_success
            RETURN
         END IF    

         CALL cl_err_collect_init()
         CALL s_transaction_begin()  
         LET l_msg = cl_getmsg('ast-00330',g_lang)
         CALL cl_progress_no_window_ing(l_msg)         
         CALL adep150_process16(lc_param.l_del) RETURNING l_success
         CALL cl_err_collect_show()
         IF l_success THEN
            LET l_msg = cl_getmsg('std-00012',g_lang)
            CALL cl_progress_no_window_ing(l_msg)
            CALL s_transaction_end('Y','1')
         ELSE
            CALL s_transaction_end('N','0')
         END IF
         
         CALL adep150_drop_temp16() RETURNING l_success
      WHEN '17'
         IF adep150_create_temp17() THEN
            LET l_msg = cl_getmsg('ade-00114',g_lang)
            CALL cl_progress_no_window_ing(l_msg)
            IF NOT adep150_ins_temp17(lc_param.wc) THEN
               CALL adep150_drop_temp17() RETURNING l_success
               RETURN
            END IF
         ELSE
            CALL adep150_drop_temp17() RETURNING l_success
            RETURN
         END IF    
      
         CALL cl_err_collect_init()
         CALL s_transaction_begin()  
         LET l_msg = cl_getmsg('ast-00330',g_lang)
         CALL cl_progress_no_window_ing(l_msg)         
         CALL adep150_process17(lc_param.l_del) RETURNING l_success
         CALL cl_err_collect_show()
         IF l_success THEN
            LET l_msg = cl_getmsg('std-00012',g_lang)
            CALL cl_progress_no_window_ing(l_msg)
            CALL s_transaction_end('Y','1')
         ELSE
            CALL s_transaction_end('N','0')
         END IF
         
         CALL adep150_drop_temp17() RETURNING l_success
      WHEN '19'
         IF adep150_create_temp19() THEN
            LET l_msg = cl_getmsg('ade-00114',g_lang)
            CALL cl_progress_no_window_ing(l_msg)
            IF NOT adep150_ins_temp19(lc_param.wc) THEN
               CALL adep150_drop_temp19() RETURNING l_success
               RETURN
            END IF
         ELSE
            CALL adep150_drop_temp19() RETURNING l_success
            RETURN
         END IF    

         CALL cl_err_collect_init()
         CALL s_transaction_begin()  
         LET l_msg = cl_getmsg('ast-00330',g_lang)
         CALL cl_progress_no_window_ing(l_msg)         
         CALL adep150_process19(lc_param.l_del) RETURNING l_success
         CALL cl_err_collect_show()
         IF l_success THEN
            LET l_msg = cl_getmsg('std-00012',g_lang)
            CALL cl_progress_no_window_ing(l_msg)
            CALL s_transaction_end('Y','1')
         ELSE
            CALL s_transaction_end('N','0')
         END IF
         
         CALL adep150_drop_temp19() RETURNING l_success
         
      OTHERWISE
         #傳入的參數 沒有對應的相關後續程序
         
   END CASE
   
   ]]>
  </point>
  <point name="ui_dialog.before_dialog3" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_master.rtjadocdt = g_today
            DISPLAY BY NAME g_master.rtjadocdt
            LET g_master.l_del  = 'Y'
            DISPLAY g_master.l_del TO l_del]]>
  </point>
  <section id="adep150.description" ver="1" status="" src="s" readonly="">
    <![CDATA[#應用 a00 樣板自動產生(Version:1)
#+ Version..: T100-ERP-1.00.00(SD版次:1,PR版次:1) Build-000007
#+ 
#+ Filename...: adep150
#+ Description: 門店銷售單品週結批次處理作業
#+ Creator....: 01752(2015-06-22 11:06:03)
#+ Modifier...: 01752(2015-06-22 11:19:59) -SD/PR-
]]>
  </section>
  <section id="adep150.get_buffer" ver="1" status="" src="s" readonly="">
    <![CDATA[PRIVATE FUNCTION adep150_get_buffer(p_dialog)
   DEFINE p_dialog   ui.DIALOG
   
   LET g_master.rtjadocdt = p_dialog.getFieldBuffer('rtjadocdt')
   LET g_master.l_del = p_dialog.getFieldBuffer('l_del')
 
   CALL cl_schedule_get_buffer(p_dialog)
 
   #add-point:get_buffer段其他欄位處理
   {<point name="get_buffer.others"/>}
   #end add-point
END FUNCTION
]]>
  </section>
  <section id="adep150.global" ver="1" status="" src="s" readonly="">
    <![CDATA[#應用 p01 樣板自動產生(Version:10)
{<point name="global.memo" />}
 
IMPORT os
IMPORT util
IMPORT FGL lib_cl_schedule
#add-point:增加匯入項目
{<point name="global.import" />}
#end add-point
 
SCHEMA ds
 
GLOBALS "../../cfg/top_global.inc"
GLOBALS "../../cfg/top_schedule.inc"
GLOBALS
   DEFINE gwin_curr2  ui.Window
   DEFINE gfrm_curr2  ui.Form
   DEFINE gi_hiden_asign       LIKE type_t.num5
   DEFINE gi_hiden_exec        LIKE type_t.num5
   DEFINE gi_hiden_spec        LIKE type_t.num5
   DEFINE gi_hiden_exec_end    LIKE type_t.num5
   DEFINE g_chk_jobid          LIKE type_t.num5
END GLOBALS
 
PRIVATE TYPE type_parameter RECORD
   #add-point:自定背景執行須傳遞的參數(Module Variable)
   {<point name="global.parameter"/>}
   #end add-point
        wc               STRING
                     END RECORD
 
DEFINE g_sql             STRING        #組 sql 用
DEFINE g_forupd_sql      STRING        #SELECT ... FOR UPDATE  SQL
DEFINE g_error_show      LIKE type_t.num5
DEFINE g_jobid           STRING
DEFINE g_wc              STRING
 
PRIVATE TYPE type_master RECORD
       rtjasite LIKE rtja_t.rtjasite, 
   rtjadocdt LIKE rtja_t.rtjadocdt, 
   l_del LIKE type_t.chr500, 
   stagenow LIKE type_t.chr80,
       wc               STRING
       END RECORD
 
#模組變數(Module Variables)
DEFINE g_master type_master
 
#add-point:自定義模組變數(Module Variable)
{<point name="global.variable" edit="s"/>}
#end add-point
 
#add-point:自定義客戶專用模組變數(Module Variable)
{<point name="global.variable_customerization" edit="c"/>}
#end add-point
 
#add-point:傳入參數說明
{<point name="global.argv"/>}
#end add-point
]]>
  </section>
  <section id="adep150.init" ver="1" status="" src="s" readonly="">
    <![CDATA[#+ 初始化作業
PRIVATE FUNCTION adep150_init()
   #add-point:init段define 
   {<point name="init.define" edit="s"/>}
   #end add-point
   #add-point:init段define (客製用)
   {<point name="init.define_customerization" edit="c"/>}
   #end add-point
 
   LET g_error_show = 1
   LET gwin_curr2 = ui.Window.getCurrent()
   LET gfrm_curr2 = gwin_curr2.getForm()
   CALL cl_schedule_import_4fd()
   CALL cl_set_combo_scc("gzpa003","75")
   IF cl_get_para(g_enterprise,"","E-SYS-0005") = "N" THEN
       CALL cl_set_comp_visible("scheduling_page,history_page",FALSE)
   END IF 
   #add-point:畫面資料初始化
   {<point name="init.init" />}
   #end add-point
   
END FUNCTION
]]>
  </section>
  <section id="adep150.main" ver="2" status="" src="s" readonly="">
    <![CDATA[MAIN
   DEFINE ls_js    STRING
   DEFINE lc_param type_parameter  
   #add-point:main段define 
   {<point name="main.define" edit="s"/>}
   #end add-point 
   #add-point:main段define (客製用)
   {<point name="main.define_customerization" edit="c"/>}
   #end add-point 
  
   #設定SQL錯誤記錄方式 (模組內定義有效)
   WHENEVER ERROR CALL cl_err_msg_log
 
   #依模組進行系統初始化設定(系統設定)
   CALL cl_ap_init("ade","")
 
   #add-point:定義背景狀態與整理進入需用參數ls_js
   {<point name="main.background"/>}
   #end add-point
 
   #背景(Y) 或半背景(T) 時不做主畫面開窗
   IF g_bgjob = "Y" OR g_bgjob = "T" THEN
      #排程參數由02開始，若不是1開始，表示有保留參數
      LET ls_js = g_argv[02]
     #CALL util.JSON.parse(ls_js,g_master)   #p類主要使用l_param,此處不解析
      #add-point:Service Call
      {<point name="main.servicecall" />}
      #end add-point
      CALL adep150_process(ls_js)
   ELSE
      #畫面開啟 (identifier)
      OPEN WINDOW w_adep150 WITH FORM cl_ap_formpath("ade",g_code)
 
      #瀏覽頁簽資料初始化
      CALL cl_ui_init()
 
      #程式初始化
      CALL adep150_init()
 
      #進入選單 Menu (="N")
      CALL adep150_ui_dialog()
 
      #add-point:畫面關閉前
      {<point name="main.before_close" />}
      #end add-point
      #畫面關閉
      CLOSE WINDOW w_adep150
   END IF
 
   #add-point:作業離開前
   {<point name="main.exit" />}
   #end add-point
 
   #離開作業
   CALL cl_ap_exitprogram("0")
END MAIN
]]>
  </section>
  <section id="adep150.msgcentre_notify" ver="1" status="" src="s" readonly="">
    <![CDATA[PRIVATE FUNCTION adep150_msgcentre_notify()
 
   DEFINE lc_state LIKE type_t.chr5
 
   INITIALIZE g_msgparam TO NULL
 
   #action-id與狀態填寫
   LET g_msgparam.state = "process"
 
   #add-point:msgcentre其他通知
   {<point name="msg_centre.process"/>}
   #end add-point
 
   #呼叫訊息中心傳遞本關完成訊息
   CALL cl_msgcentre_notify()
 
END FUNCTION
]]>
  </section>
  <section id="adep150.other_function" ver="1" status="" src="s" readonly="">
    <![CDATA[#add-point:自定義元件(Function)
{<point name="other.function"/>}
#end add-point
]]>
  </section>
  <section id="adep150.process" ver="1" status="" src="s" readonly="">
    <![CDATA[#+ 資料處理   (r類使用g_master為主處理/p類使用l_param為主)
PRIVATE FUNCTION adep150_process(ls_js)
   DEFINE ls_js         STRING
   DEFINE lc_param      type_parameter
   DEFINE li_stus       LIKE type_t.num5
   DEFINE li_count      LIKE type_t.num10  #progressbar計量
   DEFINE ls_sql        STRING             #主SQL
   DEFINE li_p01_status LIKE type_t.num5
   #add-point:process段define 
   {<point name="process.define" edit="s"/>}
   #end add-point
   #add-point:process段define (客製用)
   {<point name="process.define_customerization" edit="c"/>}
   #end add-point
 
  #INITIALIZE lc_param TO NULL           #p類不可以清空
   CALL util.JSON.parse(ls_js,lc_param)  #r類作業被t類呼叫時使用, p類主要解開參數處
 
  #IF lc_param.wc IS NOT NULL THEN
  #   LET g_bgjob = "T"       #特殊情況,此為t類作業鬆耦合串入報表主程式使用
  #END IF
 
   #add-point:process段前處理
   {<point name="process.pre_process"/>}
   #end add-point
 
   #預先計算progressbar迴圈次數
   IF g_bgjob <> "Y" THEN
      #add-point:process段count_progress
      {<point name="process.count_progress"/>}
      #end add-point
   END IF
 
   #主SQL及相關FOREACH前置處理
#  DECLARE adep150_process_cs CURSOR FROM ls_sql
#  FOREACH adep150_process_cs INTO
   #add-point:process段process
   {<point name="process.process"/>}
   #end add-point
#  END FOREACH
 
   IF g_bgjob = "N" THEN
      #前景作業完成處理
      #add-point:process段foreground完成處理
      {<point name="process.foreground_finish"/>}
      #end add-point
      CALL cl_ask_confirm3("std-00012","")
   ELSE
      #背景作業完成處理
      #add-point:process段background完成處理
      {<point name="process.background_finish"/>}
      #end add-point
      CALL cl_schedule_exec_call(li_p01_status)
   END IF
 
   #呼叫訊息中心傳遞本關完成訊息
   CALL adep150_msgcentre_notify()
 
END FUNCTION
]]>
  </section>
  <section id="adep150.transfer_argv" ver="1" status="" src="s" readonly="">
    <![CDATA[#+ 轉換本地參數至cmdrun參數內,準備進入背景執行
PRIVATE FUNCTION adep150_transfer_argv(ls_js)
   DEFINE ls_js       STRING
   DEFINE la_cmdrun   RECORD
             prog       STRING,
             actionid   STRING,
             background LIKE type_t.chr1,
             param      DYNAMIC ARRAY OF STRING
                  END RECORD
   DEFINE la_param    type_parameter
   #add-point:transfer_agrv段define 
   {<point name="transfer_agrv.define" edit="s"/>}
   #end add-point
   #add-point:transfer_agrv段define (客製用)
   {<point name="transfer_agrv.define_customerization" edit="c"/>}
   #end add-point
 
   LET la_cmdrun.prog = g_prog
   LET la_cmdrun.background = "Y"
   LET la_cmdrun.param[1] = ls_js
 
   #add-point:transfer.argv段程式內容
   {<point name="transfer.argv.define"/>}
   #end add-point
 
   RETURN util.JSON.stringify( la_cmdrun )
END FUNCTION
]]>
  </section>
  <section id="adep150.ui_dialog" ver="1" status="" src="s" readonly="">
    <![CDATA[#+ 選單功能實際執行處
PRIVATE FUNCTION adep150_ui_dialog()
   DEFINE li_exit  LIKE type_t.num5    #判別是否為離開作業
   DEFINE li_idx   LIKE type_t.num10
   DEFINE ls_js    STRING
   DEFINE ls_wc    STRING
   DEFINE l_dialog ui.DIALOG
   DEFINE lc_param type_parameter
   #add-point:ui_dialog段define 
   {<point name="ui_dialog.define" edit="s"/>}
   #end add-point
   #add-point:ui_dialog段define (客製用)
   {<point name="ui_dialog.define_customerization" edit="c"/>}
   #end add-point
   
   #add-point:ui_dialog段before dialog
   {<point name="ui_dialog.before_dialog"/>}
   #end add-point
 
   WHILE TRUE
      #add-point:ui_dialog段before dialog2
      {<point name="ui_dialog.before_dialog2"/>}
      #end add-point
 
      DIALOG ATTRIBUTES(UNBUFFERED,FIELD ORDER FORM)
         #應用 a57 樣板自動產生(Version:2)
         INPUT BY NAME g_master.rtjadocdt,g_master.l_del 
            ATTRIBUTE(WITHOUT DEFAULTS)
            
            #自訂ACTION(master_input)
            
         
            BEFORE INPUT
               #add-point:資料輸入前
               {<point name="input.m.before_input"/>}
               #end add-point
         
                     #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD rtjadocdt
            #add-point:BEFORE FIELD rtjadocdt
            {<point name="input.b.rtjadocdt" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD rtjadocdt
            
            #add-point:AFTER FIELD rtjadocdt
            {<point name="input.a.rtjadocdt" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE rtjadocdt
            #add-point:ON CHANGE rtjadocdt
            {<point name="input.g.rtjadocdt" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD l_del
            #add-point:BEFORE FIELD l_del
            {<point name="input.b.l_del" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD l_del
            
            #add-point:AFTER FIELD l_del
            {<point name="input.a.l_del" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE l_del
            #add-point:ON CHANGE l_del
            {<point name="input.g.l_del" />}
            #END add-point 
 
 
                     #Ctrlp:input.c.rtjadocdt
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD rtjadocdt
            #add-point:ON ACTION controlp INFIELD rtjadocdt
            {<point name="input.c.rtjadocdt" />}
            #END add-point
 
         #Ctrlp:input.c.l_del
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD l_del
            #add-point:ON ACTION controlp INFIELD l_del
            {<point name="input.c.l_del" />}
            #END add-point
 
 
               
            AFTER INPUT
               #add-point:資料輸入後
               {<point name="input.m.after_input"/>}
               #end add-point
               
            #add-point:其他管控(on row change, etc...)
            {<point name="input.other"/>}
            #end add-point
         END INPUT
 
 
         
         #應用 a58 樣板自動產生(Version:2)
         CONSTRUCT BY NAME g_master.wc ON rtjasite
            BEFORE CONSTRUCT
               #add-point:cs段before_construct
               {<point name="cs.head.before_construct"/>}
               #end add-point 
         
            #公用欄位開窗相關處理
            
               
            #一般欄位開窗相關處理    
                     #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD rtjasite
            #add-point:BEFORE FIELD rtjasite
            {<point name="construct.b.rtjasite" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD rtjasite
            
            #add-point:AFTER FIELD rtjasite
            {<point name="construct.a.rtjasite" />}
            #END add-point
            
 
         #Ctrlp:construct.c.rtjasite
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD rtjasite
            #add-point:ON ACTION controlp INFIELD rtjasite
            {<point name="construct.c.rtjasite" />}
            #END add-point
 
 
            
            #add-point:其他管控
            {<point name="cs.other"/>}
            #end add-point
            
         END CONSTRUCT
 
 
      
         #add-point:ui_dialog段construct
         {<point name="ui_dialog.more_construct"/>}
         #end add-point
         #add-point:ui_dialog段input
         {<point name="ui_dialog.more_input"/>}
         #end add-point
         #add-point:ui_dialog段自定義display array
         {<point name="ui_dialog.more_displayarray"/>}
         #end add-point
 
         SUBDIALOG lib_cl_schedule.cl_schedule_setting
         SUBDIALOG lib_cl_schedule.cl_schedule_setting_exec_call
         SUBDIALOG lib_cl_schedule.cl_schedule_select_show_history
         SUBDIALOG lib_cl_schedule.cl_schedule_show_history
 
         BEFORE DIALOG
            LET l_dialog = ui.DIALOG.getCurrent()
            CALL adep150_get_buffer(l_dialog)
            #add-point:ui_dialog段before dialog
            {<point name="ui_dialog.before_dialog3"/>}
            #end add-point
 
         ON ACTION batch_execute
            LET g_action_choice = "batch_execute"
            ACCEPT DIALOG
 
         #add-point:ui_dialog段before_qbeclear
         {<point name="ui_dialog.before_qbeclear" mark="Y"/>}
         #end add-point
 
         ON ACTION qbeclear         
            CLEAR FORM
            INITIALIZE g_master.* TO NULL   #畫面變數清空
            INITIALIZE lc_param.* TO NULL   #傳遞參數變數清空
            #add-point:ui_dialog段qbeclear
            {<point name="ui_dialog.qbeclear"/>}
            #end add-point
 
         ON ACTION history_fill
            CALL cl_schedule_history_fill()
 
         ON ACTION close
            LET INT_FLAG = TRUE
            EXIT DIALOG
         
         ON ACTION exit
            LET INT_FLAG = TRUE
            EXIT DIALOG
 
         #add-point:ui_dialog段action
         {<point name="ui_dialog.more_action"/>}
         #end add-point
 
         #主選單用ACTION
         &include "main_menu_exit_dialog.4gl"
         &include "relating_action.4gl"
         #交談指令共用ACTION
         &include "common_action.4gl"
            CONTINUE DIALOG
      END DIALOG
 
      IF g_action_choice = "logistics" THEN
         #清除畫面及相關資料
         CLEAR FORM   
         INITIALIZE g_master.* TO NULL
         LET g_wc  = ' 1=2'
         LET g_action_choice = ""
         CALL adep150_init()
         CONTINUE WHILE
      END IF
 
      #檢查批次設定是否有錯(或未設定完成)
      IF NOT cl_schedule_exec_check() THEN
         CONTINUE WHILE
      END IF
      
      LET lc_param.wc = g_master.wc    #把畫面上的wc傳遞到參數變數
      #請在下方的add-point內進行把畫面的輸入資料(g_master)轉換到傳遞參數變數(lc_param)的動作
      #add-point:ui_dialog段exit dialog
      {<point name="process.exit_dialog"/>}
      #end add-point
 
      LET ls_js = util.JSON.stringify(lc_param)  #r類使用g_master/p類使用lc_param
 
      IF INT_FLAG THEN
         LET INT_FLAG = FALSE
         EXIT WHILE
      ELSE
         IF g_chk_jobid THEN 
            LET g_jobid = g_schedule.gzpa001
         ELSE 
            LET g_jobid = cl_schedule_get_jobid(g_prog)
         END IF 
 
         #依照指定模式執行報表列印
         CASE 
            WHEN g_schedule.gzpa003 = "0"
                 CALL adep150_process(ls_js)
 
            WHEN g_schedule.gzpa003 = "1"
                 LET ls_js = adep150_transfer_argv(ls_js)
                 CALL cl_cmdrun(ls_js)
 
            WHEN g_schedule.gzpa003 = "2"
                 CALL cl_schedule_update_data(g_jobid,ls_js)
 
            WHEN g_schedule.gzpa003 = "3"
                 CALL cl_schedule_update_data(g_jobid,ls_js)
         END CASE  
 
         IF g_schedule.gzpa003 = "2" OR g_schedule.gzpa003 = "3" THEN 
            CALL cl_ask_confirm3("std-00014","") #設定完成
         END IF    
         LET g_schedule.gzpa003 = "0" #預設一開始 立即於前景執行
 
         #add-point:ui_dialog段after schedule
         {<point name="process.after_schedule"/>}
         #end add-point
 
         #欄位初始資訊 
         CALL cl_schedule_init_info("all",g_schedule.gzpa003) 
         LET gi_hiden_asign = FALSE 
         LET gi_hiden_exec = FALSE 
         LET gi_hiden_spec = FALSE 
         LET gi_hiden_exec_end = FALSE 
         CALL cl_schedule_hidden()
      END IF
   END WHILE
 
END FUNCTION
]]>
  </section>
</add_points>
