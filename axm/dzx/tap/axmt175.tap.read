<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<add_points prog="axmt175" std_prog="axmt175" erpver="1.0" module="AXM" ver="1" env="s" zone="t10dev" booking="N" type="M" identity="s">
  <other>
    <code_template value="F" status=""/>
    <free_style value="N" status=""/>
  </other>
  <point name="function.axmt175_b_desc" order="1" ver="1" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 不同的期别顯示在一筆單身資料中
# Memo...........:
# Usage..........: CALL axmt175_b_desc(p_xmii014,p_ac)
# Input parameter: p_xmii014   期别
#                : p_ac        行标
# Date & Author..: 2014/04/12 by lixh
################################################################################
PRIVATE FUNCTION axmt175_b_desc(p_xmii014,p_ac)
DEFINE  p_xmii014     LIKE xmii_t.xmii014
DEFINE  p_ac          LIKE type_t.num5
   IF p_xmii014 = 2 THEN 
      LET g_xmii_d[p_ac].l_xmii018_02 = g_xmii_d[p_ac+1].l_xmii018_01
      LET g_xmii_d[p_ac].l_xmii019_02 = g_xmii_d[p_ac+1].l_xmii019_01
      LET g_xmii_d[p_ac].l_xmii018_s = g_xmii_d[p_ac].l_xmii018_s + g_xmii_d[p_ac].l_xmii018_02
      LET g_xmii_d[p_ac].l_xmii019_s = g_xmii_d[p_ac].l_xmii019_s + g_xmii_d[p_ac].l_xmii019_02
      LET g_xmii2_d[p_ac].l_xmii022_02 = g_xmii2_d[p_ac+1].l_xmii022_01
      LET g_xmii2_d[p_ac].l_xmii023_02 = g_xmii2_d[p_ac+1].l_xmii023_01
      LET g_xmii2_d[p_ac].l_xmii022_s = g_xmii2_d[p_ac].l_xmii022_s + g_xmii2_d[p_ac].l_xmii022_02
      LET g_xmii2_d[p_ac].l_xmii023_s = g_xmii2_d[p_ac].l_xmii023_s + g_xmii2_d[p_ac].l_xmii023_02 
      LET g_xmii3_d[p_ac].l_xmii018_3_02 = g_xmii3_d[p_ac+1].l_xmii018_3_01
      LET g_xmii3_d[p_ac].l_xmii019_3_02 = g_xmii3_d[p_ac+1].l_xmii019_3_01
      LET g_xmii3_d[p_ac].l_xmii018_3_s = g_xmii3_d[p_ac].l_xmii018_3_s + g_xmii3_d[p_ac].l_xmii018_3_02
      LET g_xmii3_d[p_ac].l_xmii019_3_s = g_xmii3_d[p_ac].l_xmii019_3_s + g_xmii3_d[p_ac].l_xmii019_3_02          
      LET g_xmii3_d[p_ac].l_xmii022_3_02 = g_xmii3_d[p_ac+1].l_xmii022_3_01
      LET g_xmii3_d[p_ac].l_xmii023_3_02 = g_xmii3_d[p_ac+1].l_xmii023_3_01
      LET g_xmii3_d[p_ac].l_xmii022_3_s = g_xmii3_d[p_ac].l_xmii022_3_s + g_xmii3_d[p_ac].l_xmii022_3_02
      LET g_xmii3_d[p_ac].l_xmii023_3_s = g_xmii3_d[p_ac].l_xmii023_3_s + g_xmii3_d[p_ac].l_xmii023_3_02   
   END IF
   IF p_xmii014 = 3 THEN 
      LET g_xmii_d[p_ac].l_xmii018_03 = g_xmii_d[p_ac+1].l_xmii018_01
      LET g_xmii_d[p_ac].l_xmii019_03 = g_xmii_d[p_ac+1].l_xmii019_01
      LET g_xmii_d[p_ac].l_xmii018_s = g_xmii_d[p_ac].l_xmii018_s + g_xmii_d[p_ac].l_xmii018_03
      LET g_xmii_d[p_ac].l_xmii019_s = g_xmii_d[p_ac].l_xmii019_s + g_xmii_d[p_ac].l_xmii019_03
      LET g_xmii2_d[p_ac].l_xmii022_03 = g_xmii2_d[p_ac+1].l_xmii022_01
      LET g_xmii2_d[p_ac].l_xmii023_03 = g_xmii2_d[p_ac+1].l_xmii023_01
      LET g_xmii2_d[p_ac].l_xmii022_s = g_xmii2_d[p_ac].l_xmii022_s + g_xmii2_d[p_ac].l_xmii022_03
      LET g_xmii2_d[p_ac].l_xmii023_s = g_xmii2_d[p_ac].l_xmii023_s + g_xmii2_d[p_ac].l_xmii023_03 
      LET g_xmii3_d[p_ac].l_xmii018_3_03 = g_xmii3_d[p_ac+1].l_xmii018_3_01
      LET g_xmii3_d[p_ac].l_xmii019_3_03 = g_xmii3_d[p_ac+1].l_xmii019_3_01
      LET g_xmii3_d[p_ac].l_xmii018_3_s = g_xmii3_d[p_ac].l_xmii018_3_s + g_xmii3_d[p_ac].l_xmii018_3_03
      LET g_xmii3_d[p_ac].l_xmii019_3_s = g_xmii3_d[p_ac].l_xmii019_3_s + g_xmii3_d[p_ac].l_xmii019_3_03          
      LET g_xmii3_d[p_ac].l_xmii022_3_03 = g_xmii3_d[p_ac+1].l_xmii022_3_01
      LET g_xmii3_d[p_ac].l_xmii023_3_03 = g_xmii3_d[p_ac+1].l_xmii023_3_01
      LET g_xmii3_d[p_ac].l_xmii022_3_s = g_xmii3_d[p_ac].l_xmii022_3_s + g_xmii3_d[p_ac].l_xmii022_3_03
      LET g_xmii3_d[p_ac].l_xmii023_3_s = g_xmii3_d[p_ac].l_xmii023_3_s + g_xmii3_d[p_ac].l_xmii023_3_03            
   END IF
   IF p_xmii014 = 4 THEN 
      LET g_xmii_d[p_ac].l_xmii018_04 = g_xmii_d[p_ac+1].l_xmii018_01
      LET g_xmii_d[p_ac].l_xmii019_04 = g_xmii_d[p_ac+1].l_xmii019_01
      LET g_xmii_d[p_ac].l_xmii018_s = g_xmii_d[p_ac].l_xmii018_s + g_xmii_d[p_ac].l_xmii018_04
      LET g_xmii_d[p_ac].l_xmii019_s = g_xmii_d[p_ac].l_xmii019_s + g_xmii_d[p_ac].l_xmii019_04
      LET g_xmii2_d[p_ac].l_xmii022_04 = g_xmii2_d[p_ac+1].l_xmii022_01
      LET g_xmii2_d[p_ac].l_xmii023_04 = g_xmii2_d[p_ac+1].l_xmii023_01
      LET g_xmii2_d[p_ac].l_xmii022_s = g_xmii2_d[p_ac].l_xmii022_s + g_xmii2_d[p_ac].l_xmii022_04
      LET g_xmii2_d[p_ac].l_xmii023_s = g_xmii2_d[p_ac].l_xmii023_s + g_xmii2_d[p_ac].l_xmii023_04 
      LET g_xmii3_d[p_ac].l_xmii018_3_04 = g_xmii3_d[p_ac+1].l_xmii018_3_01
      LET g_xmii3_d[p_ac].l_xmii019_3_04 = g_xmii3_d[p_ac+1].l_xmii019_3_01
      LET g_xmii3_d[p_ac].l_xmii018_3_s = g_xmii3_d[p_ac].l_xmii018_3_s + g_xmii3_d[p_ac].l_xmii018_3_04
      LET g_xmii3_d[p_ac].l_xmii019_3_s = g_xmii3_d[p_ac].l_xmii019_3_s + g_xmii3_d[p_ac].l_xmii019_3_04          
      LET g_xmii3_d[p_ac].l_xmii022_3_04 = g_xmii3_d[p_ac+1].l_xmii022_3_01
      LET g_xmii3_d[p_ac].l_xmii023_3_04 = g_xmii3_d[p_ac+1].l_xmii023_3_01
      LET g_xmii3_d[p_ac].l_xmii022_3_s = g_xmii3_d[p_ac].l_xmii022_3_s + g_xmii3_d[p_ac].l_xmii022_3_04
      LET g_xmii3_d[p_ac].l_xmii023_3_s = g_xmii3_d[p_ac].l_xmii023_3_s + g_xmii3_d[p_ac].l_xmii023_3_04     
   END IF
   IF p_xmii014 = 5 THEN 
      LET g_xmii_d[p_ac].l_xmii018_05 = g_xmii_d[p_ac+1].l_xmii018_01
      LET g_xmii_d[p_ac].l_xmii019_05 = g_xmii_d[p_ac+1].l_xmii019_01
      LET g_xmii_d[p_ac].l_xmii018_s = g_xmii_d[p_ac].l_xmii018_s + g_xmii_d[p_ac].l_xmii018_05
      LET g_xmii_d[p_ac].l_xmii019_s = g_xmii_d[p_ac].l_xmii019_s + g_xmii_d[p_ac].l_xmii019_05
      LET g_xmii2_d[p_ac].l_xmii022_05 = g_xmii2_d[p_ac+1].l_xmii022_01
      LET g_xmii2_d[p_ac].l_xmii023_05 = g_xmii2_d[p_ac+1].l_xmii023_01
      LET g_xmii2_d[p_ac].l_xmii022_s = g_xmii2_d[p_ac].l_xmii022_s + g_xmii2_d[p_ac].l_xmii022_05
      LET g_xmii2_d[p_ac].l_xmii023_s = g_xmii2_d[p_ac].l_xmii023_s + g_xmii2_d[p_ac].l_xmii023_05 
      LET g_xmii3_d[p_ac].l_xmii018_3_05 = g_xmii3_d[p_ac+1].l_xmii018_3_01
      LET g_xmii3_d[p_ac].l_xmii019_3_05 = g_xmii3_d[p_ac+1].l_xmii019_3_01
      LET g_xmii3_d[p_ac].l_xmii018_3_s = g_xmii3_d[p_ac].l_xmii018_3_s + g_xmii3_d[p_ac].l_xmii018_3_05
      LET g_xmii3_d[p_ac].l_xmii019_3_s = g_xmii3_d[p_ac].l_xmii019_3_s + g_xmii3_d[p_ac].l_xmii019_3_05          
      LET g_xmii3_d[p_ac].l_xmii022_3_05 = g_xmii3_d[p_ac+1].l_xmii022_3_01
      LET g_xmii3_d[p_ac].l_xmii023_3_05 = g_xmii3_d[p_ac+1].l_xmii023_3_01
      LET g_xmii3_d[p_ac].l_xmii022_3_s = g_xmii3_d[p_ac].l_xmii022_3_s + g_xmii3_d[p_ac].l_xmii022_3_05
      LET g_xmii3_d[p_ac].l_xmii023_3_s = g_xmii3_d[p_ac].l_xmii023_3_s + g_xmii3_d[p_ac].l_xmii023_3_05        
   END IF
   IF p_xmii014 = 6 THEN 
      LET g_xmii_d[p_ac].l_xmii018_06 = g_xmii_d[p_ac+1].l_xmii018_01
      LET g_xmii_d[p_ac].l_xmii019_06 = g_xmii_d[p_ac+1].l_xmii019_01
      LET g_xmii_d[p_ac].l_xmii018_s = g_xmii_d[p_ac].l_xmii018_s + g_xmii_d[p_ac].l_xmii018_06
      LET g_xmii_d[p_ac].l_xmii019_s = g_xmii_d[p_ac].l_xmii019_s + g_xmii_d[p_ac].l_xmii019_06
      LET g_xmii2_d[p_ac].l_xmii022_06 = g_xmii2_d[p_ac+1].l_xmii022_01
      LET g_xmii2_d[p_ac].l_xmii023_06 = g_xmii2_d[p_ac+1].l_xmii023_01
      LET g_xmii2_d[p_ac].l_xmii022_s = g_xmii2_d[p_ac].l_xmii022_s + g_xmii2_d[p_ac].l_xmii022_06
      LET g_xmii2_d[p_ac].l_xmii023_s = g_xmii2_d[p_ac].l_xmii023_s + g_xmii2_d[p_ac].l_xmii023_06 
      LET g_xmii3_d[p_ac].l_xmii018_3_06 = g_xmii3_d[p_ac+1].l_xmii018_3_01
      LET g_xmii3_d[p_ac].l_xmii019_3_06 = g_xmii3_d[p_ac+1].l_xmii019_3_01
      LET g_xmii3_d[p_ac].l_xmii018_3_s = g_xmii3_d[p_ac].l_xmii018_3_s + g_xmii3_d[p_ac].l_xmii018_3_06
      LET g_xmii3_d[p_ac].l_xmii019_3_s = g_xmii3_d[p_ac].l_xmii019_3_s + g_xmii3_d[p_ac].l_xmii019_3_06          
      LET g_xmii3_d[p_ac].l_xmii022_3_06 = g_xmii3_d[p_ac+1].l_xmii022_3_01
      LET g_xmii3_d[p_ac].l_xmii023_3_06 = g_xmii3_d[p_ac+1].l_xmii023_3_01
      LET g_xmii3_d[p_ac].l_xmii022_3_s = g_xmii3_d[p_ac].l_xmii022_3_s + g_xmii3_d[p_ac].l_xmii022_3_06
      LET g_xmii3_d[p_ac].l_xmii023_3_s = g_xmii3_d[p_ac].l_xmii023_3_s + g_xmii3_d[p_ac].l_xmii023_3_06        
   END IF
   IF p_xmii014 = 7 THEN 
      LET g_xmii_d[p_ac].l_xmii018_07 = g_xmii_d[p_ac+1].l_xmii018_01
      LET g_xmii_d[p_ac].l_xmii019_07 = g_xmii_d[p_ac+1].l_xmii019_01
      LET g_xmii_d[p_ac].l_xmii018_s = g_xmii_d[p_ac].l_xmii018_s + g_xmii_d[p_ac].l_xmii018_07
      LET g_xmii_d[p_ac].l_xmii019_s = g_xmii_d[p_ac].l_xmii019_s + g_xmii_d[p_ac].l_xmii019_07
      LET g_xmii2_d[p_ac].l_xmii022_07 = g_xmii2_d[p_ac+1].l_xmii022_01
      LET g_xmii2_d[p_ac].l_xmii023_07 = g_xmii2_d[p_ac+1].l_xmii023_01
      LET g_xmii2_d[p_ac].l_xmii022_s = g_xmii2_d[p_ac].l_xmii022_s + g_xmii2_d[p_ac].l_xmii022_07
      LET g_xmii2_d[p_ac].l_xmii023_s = g_xmii2_d[p_ac].l_xmii023_s + g_xmii2_d[p_ac].l_xmii023_07 
      LET g_xmii3_d[p_ac].l_xmii018_3_07 = g_xmii3_d[p_ac+1].l_xmii018_3_01
      LET g_xmii3_d[p_ac].l_xmii019_3_07 = g_xmii3_d[p_ac+1].l_xmii019_3_01
      LET g_xmii3_d[p_ac].l_xmii018_3_s = g_xmii3_d[p_ac].l_xmii018_3_s + g_xmii3_d[p_ac].l_xmii018_3_07
      LET g_xmii3_d[p_ac].l_xmii019_3_s = g_xmii3_d[p_ac].l_xmii019_3_s + g_xmii3_d[p_ac].l_xmii019_3_07          
      LET g_xmii3_d[p_ac].l_xmii022_3_07 = g_xmii3_d[p_ac+1].l_xmii022_3_01
      LET g_xmii3_d[p_ac].l_xmii023_3_07 = g_xmii3_d[p_ac+1].l_xmii023_3_01
      LET g_xmii3_d[p_ac].l_xmii022_3_s = g_xmii3_d[p_ac].l_xmii022_3_s + g_xmii3_d[p_ac].l_xmii022_3_07
      LET g_xmii3_d[p_ac].l_xmii023_3_s = g_xmii3_d[p_ac].l_xmii023_3_s + g_xmii3_d[p_ac].l_xmii023_3_07      
   END IF
   IF p_xmii014 = 8 THEN 
      LET g_xmii_d[p_ac].l_xmii018_08 = g_xmii_d[p_ac+1].l_xmii018_01
      LET g_xmii_d[p_ac].l_xmii019_08 = g_xmii_d[p_ac+1].l_xmii019_01
      LET g_xmii_d[p_ac].l_xmii018_s = g_xmii_d[p_ac].l_xmii018_s + g_xmii_d[p_ac].l_xmii018_08
      LET g_xmii_d[p_ac].l_xmii019_s = g_xmii_d[p_ac].l_xmii019_s + g_xmii_d[p_ac].l_xmii019_08
      LET g_xmii2_d[p_ac].l_xmii022_08 = g_xmii2_d[p_ac+1].l_xmii022_01
      LET g_xmii2_d[p_ac].l_xmii023_08 = g_xmii2_d[p_ac+1].l_xmii023_01
      LET g_xmii2_d[p_ac].l_xmii022_s = g_xmii2_d[p_ac].l_xmii022_s + g_xmii2_d[p_ac].l_xmii022_08
      LET g_xmii2_d[p_ac].l_xmii023_s = g_xmii2_d[p_ac].l_xmii023_s + g_xmii2_d[p_ac].l_xmii023_08 
      LET g_xmii3_d[p_ac].l_xmii018_3_08 = g_xmii3_d[p_ac+1].l_xmii018_3_01
      LET g_xmii3_d[p_ac].l_xmii019_3_08 = g_xmii3_d[p_ac+1].l_xmii019_3_01
      LET g_xmii3_d[p_ac].l_xmii018_3_s = g_xmii3_d[p_ac].l_xmii018_3_s + g_xmii3_d[p_ac].l_xmii018_3_08
      LET g_xmii3_d[p_ac].l_xmii019_3_s = g_xmii3_d[p_ac].l_xmii019_3_s + g_xmii3_d[p_ac].l_xmii019_3_08          
      LET g_xmii3_d[p_ac].l_xmii022_3_08 = g_xmii3_d[p_ac+1].l_xmii022_3_01
      LET g_xmii3_d[p_ac].l_xmii023_3_08 = g_xmii3_d[p_ac+1].l_xmii023_3_01
      LET g_xmii3_d[p_ac].l_xmii022_3_s = g_xmii3_d[p_ac].l_xmii022_3_s + g_xmii3_d[p_ac].l_xmii022_3_08
      LET g_xmii3_d[p_ac].l_xmii023_3_s = g_xmii3_d[p_ac].l_xmii023_3_s + g_xmii3_d[p_ac].l_xmii023_3_08             
   END IF
   IF p_xmii014 = 9 THEN 
      LET g_xmii_d[p_ac].l_xmii018_09 = g_xmii_d[p_ac+1].l_xmii018_01
      LET g_xmii_d[p_ac].l_xmii019_09 = g_xmii_d[p_ac+1].l_xmii019_01
      LET g_xmii_d[p_ac].l_xmii018_s = g_xmii_d[p_ac].l_xmii018_s + g_xmii_d[p_ac].l_xmii018_09
      LET g_xmii_d[p_ac].l_xmii019_s = g_xmii_d[p_ac].l_xmii019_s + g_xmii_d[p_ac].l_xmii019_09
      LET g_xmii2_d[p_ac].l_xmii022_09 = g_xmii2_d[p_ac+1].l_xmii022_01
      LET g_xmii2_d[p_ac].l_xmii023_09 = g_xmii2_d[p_ac+1].l_xmii023_01
      LET g_xmii2_d[p_ac].l_xmii022_s = g_xmii2_d[p_ac].l_xmii022_s + g_xmii2_d[p_ac].l_xmii022_09
      LET g_xmii2_d[p_ac].l_xmii023_s = g_xmii2_d[p_ac].l_xmii023_s + g_xmii2_d[p_ac].l_xmii023_09 
      LET g_xmii3_d[p_ac].l_xmii018_3_09 = g_xmii3_d[p_ac+1].l_xmii018_3_01
      LET g_xmii3_d[p_ac].l_xmii019_3_09 = g_xmii3_d[p_ac+1].l_xmii019_3_01
      LET g_xmii3_d[p_ac].l_xmii018_3_s = g_xmii3_d[p_ac].l_xmii018_3_s + g_xmii3_d[p_ac].l_xmii018_3_09
      LET g_xmii3_d[p_ac].l_xmii019_3_s = g_xmii3_d[p_ac].l_xmii019_3_s + g_xmii3_d[p_ac].l_xmii019_3_09          
      LET g_xmii3_d[p_ac].l_xmii022_3_09 = g_xmii3_d[p_ac+1].l_xmii022_3_01
      LET g_xmii3_d[p_ac].l_xmii023_3_09 = g_xmii3_d[p_ac+1].l_xmii023_3_01
      LET g_xmii3_d[p_ac].l_xmii022_3_s = g_xmii3_d[p_ac].l_xmii022_3_s + g_xmii3_d[p_ac].l_xmii022_3_09
      LET g_xmii3_d[p_ac].l_xmii023_3_s = g_xmii3_d[p_ac].l_xmii023_3_s + g_xmii3_d[p_ac].l_xmii023_3_09            
   END IF
   IF p_xmii014 = 10 THEN 
      LET g_xmii_d[p_ac].l_xmii018_10 = g_xmii_d[p_ac+1].l_xmii018_01
      LET g_xmii_d[p_ac].l_xmii019_10 = g_xmii_d[p_ac+1].l_xmii019_01
      LET g_xmii_d[p_ac].l_xmii018_s = g_xmii_d[p_ac].l_xmii018_s + g_xmii_d[p_ac].l_xmii018_10
      LET g_xmii_d[p_ac].l_xmii019_s = g_xmii_d[p_ac].l_xmii019_s + g_xmii_d[p_ac].l_xmii019_10
      LET g_xmii2_d[p_ac].l_xmii022_10 = g_xmii2_d[p_ac+1].l_xmii022_01
      LET g_xmii2_d[p_ac].l_xmii023_10 = g_xmii2_d[p_ac+1].l_xmii023_01
      LET g_xmii2_d[p_ac].l_xmii022_s = g_xmii2_d[p_ac].l_xmii022_s + g_xmii2_d[p_ac].l_xmii022_10
      LET g_xmii2_d[p_ac].l_xmii023_s = g_xmii2_d[p_ac].l_xmii023_s + g_xmii2_d[p_ac].l_xmii023_10 
      LET g_xmii3_d[p_ac].l_xmii018_3_10 = g_xmii3_d[p_ac+1].l_xmii018_3_01
      LET g_xmii3_d[p_ac].l_xmii019_3_10 = g_xmii3_d[p_ac+1].l_xmii019_3_01
      LET g_xmii3_d[p_ac].l_xmii018_3_s = g_xmii3_d[p_ac].l_xmii018_3_s + g_xmii3_d[p_ac].l_xmii018_3_10
      LET g_xmii3_d[p_ac].l_xmii019_3_s = g_xmii3_d[p_ac].l_xmii019_3_s + g_xmii3_d[p_ac].l_xmii019_3_10          
      LET g_xmii3_d[p_ac].l_xmii022_3_10 = g_xmii3_d[p_ac+1].l_xmii022_3_01
      LET g_xmii3_d[p_ac].l_xmii023_3_10 = g_xmii3_d[p_ac+1].l_xmii023_3_01
      LET g_xmii3_d[p_ac].l_xmii022_3_s = g_xmii3_d[p_ac].l_xmii022_3_s + g_xmii3_d[p_ac].l_xmii022_3_10
      LET g_xmii3_d[p_ac].l_xmii023_3_s = g_xmii3_d[p_ac].l_xmii023_3_s + g_xmii3_d[p_ac].l_xmii023_3_10      
   END IF
   IF p_xmii014 = 11 THEN 
      LET g_xmii_d[p_ac].l_xmii018_11 = g_xmii_d[p_ac+1].l_xmii018_01
      LET g_xmii_d[p_ac].l_xmii019_11 = g_xmii_d[p_ac+1].l_xmii019_01
      LET g_xmii_d[p_ac].l_xmii018_s = g_xmii_d[p_ac].l_xmii018_s + g_xmii_d[p_ac].l_xmii018_11
      LET g_xmii_d[p_ac].l_xmii019_s = g_xmii_d[p_ac].l_xmii019_s + g_xmii_d[p_ac].l_xmii019_11
      LET g_xmii2_d[p_ac].l_xmii022_11 = g_xmii2_d[p_ac+1].l_xmii022_01
      LET g_xmii2_d[p_ac].l_xmii023_11 = g_xmii2_d[p_ac+1].l_xmii023_01
      LET g_xmii2_d[p_ac].l_xmii022_s = g_xmii2_d[p_ac].l_xmii022_s + g_xmii2_d[p_ac].l_xmii022_11
      LET g_xmii2_d[p_ac].l_xmii023_s = g_xmii2_d[p_ac].l_xmii023_s + g_xmii2_d[p_ac].l_xmii023_11 
      LET g_xmii3_d[p_ac].l_xmii018_3_11 = g_xmii3_d[p_ac+1].l_xmii018_3_01
      LET g_xmii3_d[p_ac].l_xmii019_3_11 = g_xmii3_d[p_ac+1].l_xmii019_3_01
      LET g_xmii3_d[p_ac].l_xmii018_3_s = g_xmii3_d[p_ac].l_xmii018_3_s + g_xmii3_d[p_ac].l_xmii018_3_11
      LET g_xmii3_d[p_ac].l_xmii019_3_s = g_xmii3_d[p_ac].l_xmii019_3_s + g_xmii3_d[p_ac].l_xmii019_3_11          
      LET g_xmii3_d[p_ac].l_xmii022_3_11 = g_xmii3_d[p_ac+1].l_xmii022_3_01
      LET g_xmii3_d[p_ac].l_xmii023_3_11 = g_xmii3_d[p_ac+1].l_xmii023_3_01
      LET g_xmii3_d[p_ac].l_xmii022_3_s = g_xmii3_d[p_ac].l_xmii022_3_s + g_xmii3_d[p_ac].l_xmii022_3_11
      LET g_xmii3_d[p_ac].l_xmii023_3_s = g_xmii3_d[p_ac].l_xmii023_3_s + g_xmii3_d[p_ac].l_xmii023_3_11      
   END IF
   IF p_xmii014 = 12 THEN 
      LET g_xmii_d[p_ac].l_xmii018_12 = g_xmii_d[p_ac+1].l_xmii018_01
      LET g_xmii_d[p_ac].l_xmii019_12 = g_xmii_d[p_ac+1].l_xmii019_01
      LET g_xmii_d[p_ac].l_xmii018_s = g_xmii_d[p_ac].l_xmii018_s + g_xmii_d[p_ac].l_xmii018_12
      LET g_xmii_d[p_ac].l_xmii019_s = g_xmii_d[p_ac].l_xmii019_s + g_xmii_d[p_ac].l_xmii019_12
      LET g_xmii2_d[p_ac].l_xmii022_12 = g_xmii2_d[p_ac+1].l_xmii022_01
      LET g_xmii2_d[p_ac].l_xmii023_12 = g_xmii2_d[p_ac+1].l_xmii023_01
      LET g_xmii2_d[p_ac].l_xmii022_s = g_xmii2_d[p_ac].l_xmii022_s + g_xmii2_d[p_ac].l_xmii022_12
      LET g_xmii2_d[p_ac].l_xmii023_s = g_xmii2_d[p_ac].l_xmii023_s + g_xmii2_d[p_ac].l_xmii023_12 
      LET g_xmii3_d[p_ac].l_xmii018_3_12 = g_xmii3_d[p_ac+1].l_xmii018_3_01
      LET g_xmii3_d[p_ac].l_xmii019_3_12 = g_xmii3_d[p_ac+1].l_xmii019_3_01
      LET g_xmii3_d[p_ac].l_xmii018_3_s = g_xmii3_d[p_ac].l_xmii018_3_s + g_xmii3_d[p_ac].l_xmii018_3_12
      LET g_xmii3_d[p_ac].l_xmii019_3_s = g_xmii3_d[p_ac].l_xmii019_3_s + g_xmii3_d[p_ac].l_xmii019_3_12          
      LET g_xmii3_d[p_ac].l_xmii022_3_12 = g_xmii3_d[p_ac+1].l_xmii022_3_01
      LET g_xmii3_d[p_ac].l_xmii023_3_12 = g_xmii3_d[p_ac+1].l_xmii023_3_01
      LET g_xmii3_d[p_ac].l_xmii022_3_s = g_xmii3_d[p_ac].l_xmii022_3_s + g_xmii3_d[p_ac].l_xmii022_3_12
      LET g_xmii3_d[p_ac].l_xmii023_3_s = g_xmii3_d[p_ac].l_xmii023_3_s + g_xmii3_d[p_ac].l_xmii023_3_12            
   END IF
   IF p_xmii014 = 13 THEN 
      LET g_xmii_d[p_ac].l_xmii018_13 = g_xmii_d[p_ac+1].l_xmii018_01
      LET g_xmii_d[p_ac].l_xmii019_13 = g_xmii_d[p_ac+1].l_xmii019_01
      LET g_xmii_d[p_ac].l_xmii018_s = g_xmii_d[p_ac].l_xmii018_s + g_xmii_d[p_ac].l_xmii018_13
      LET g_xmii_d[p_ac].l_xmii019_s = g_xmii_d[p_ac].l_xmii019_s + g_xmii_d[p_ac].l_xmii019_13
      LET g_xmii2_d[p_ac].l_xmii022_13 = g_xmii2_d[p_ac+1].l_xmii022_01
      LET g_xmii2_d[p_ac].l_xmii023_13 = g_xmii2_d[p_ac+1].l_xmii023_01
      LET g_xmii2_d[p_ac].l_xmii022_s = g_xmii2_d[p_ac].l_xmii022_s + g_xmii2_d[p_ac].l_xmii022_13
      LET g_xmii2_d[p_ac].l_xmii023_s = g_xmii2_d[p_ac].l_xmii023_s + g_xmii2_d[p_ac].l_xmii023_13 
      LET g_xmii3_d[p_ac].l_xmii018_3_13 = g_xmii3_d[p_ac+1].l_xmii018_3_01
      LET g_xmii3_d[p_ac].l_xmii019_3_13 = g_xmii3_d[p_ac+1].l_xmii019_3_01
      LET g_xmii3_d[p_ac].l_xmii018_3_s = g_xmii3_d[p_ac].l_xmii018_3_s + g_xmii3_d[p_ac].l_xmii018_3_13
      LET g_xmii3_d[p_ac].l_xmii019_3_s = g_xmii3_d[p_ac].l_xmii019_3_s + g_xmii3_d[p_ac].l_xmii019_3_13          
      LET g_xmii3_d[p_ac].l_xmii022_3_13 = g_xmii3_d[p_ac+1].l_xmii022_3_01
      LET g_xmii3_d[p_ac].l_xmii023_3_13 = g_xmii3_d[p_ac+1].l_xmii023_3_01
      LET g_xmii3_d[p_ac].l_xmii022_3_s = g_xmii3_d[p_ac].l_xmii022_3_s + g_xmii3_d[p_ac].l_xmii022_3_13
      LET g_xmii3_d[p_ac].l_xmii023_3_s = g_xmii3_d[p_ac].l_xmii023_3_s + g_xmii3_d[p_ac].l_xmii023_3_13            
   END IF
   IF p_xmii014 = 14 THEN 
      LET g_xmii_d[p_ac].l_xmii018_14 = g_xmii_d[p_ac+1].l_xmii018_01
      LET g_xmii_d[p_ac].l_xmii019_14 = g_xmii_d[p_ac+1].l_xmii019_01
      LET g_xmii_d[p_ac].l_xmii018_s = g_xmii_d[p_ac].l_xmii018_s + g_xmii_d[p_ac].l_xmii018_14
      LET g_xmii_d[p_ac].l_xmii019_s = g_xmii_d[p_ac].l_xmii019_s + g_xmii_d[p_ac].l_xmii019_14
      LET g_xmii2_d[p_ac].l_xmii022_14 = g_xmii2_d[p_ac+1].l_xmii022_01
      LET g_xmii2_d[p_ac].l_xmii023_14 = g_xmii2_d[p_ac+1].l_xmii023_01
      LET g_xmii2_d[p_ac].l_xmii022_s = g_xmii2_d[p_ac].l_xmii022_s + g_xmii2_d[p_ac].l_xmii022_14
      LET g_xmii2_d[p_ac].l_xmii023_s = g_xmii2_d[p_ac].l_xmii023_s + g_xmii2_d[p_ac].l_xmii023_14 
      LET g_xmii3_d[p_ac].l_xmii018_3_14 = g_xmii3_d[p_ac+1].l_xmii018_3_01
      LET g_xmii3_d[p_ac].l_xmii019_3_14 = g_xmii3_d[p_ac+1].l_xmii019_3_01
      LET g_xmii3_d[p_ac].l_xmii018_3_s = g_xmii3_d[p_ac].l_xmii018_3_s + g_xmii3_d[p_ac].l_xmii018_3_14
      LET g_xmii3_d[p_ac].l_xmii019_3_s = g_xmii3_d[p_ac].l_xmii019_3_s + g_xmii3_d[p_ac].l_xmii019_3_14          
      LET g_xmii3_d[p_ac].l_xmii022_3_14 = g_xmii3_d[p_ac+1].l_xmii022_3_01
      LET g_xmii3_d[p_ac].l_xmii023_3_14 = g_xmii3_d[p_ac+1].l_xmii023_3_01
      LET g_xmii3_d[p_ac].l_xmii022_3_s = g_xmii3_d[p_ac].l_xmii022_3_s + g_xmii3_d[p_ac].l_xmii022_3_14
      LET g_xmii3_d[p_ac].l_xmii023_3_s = g_xmii3_d[p_ac].l_xmii023_3_s + g_xmii3_d[p_ac].l_xmii023_3_14            
   END IF
   IF p_xmii014 = 15 THEN 
      LET g_xmii_d[p_ac].l_xmii018_15 = g_xmii_d[p_ac+1].l_xmii018_01
      LET g_xmii_d[p_ac].l_xmii019_15 = g_xmii_d[p_ac+1].l_xmii019_01
      LET g_xmii_d[p_ac].l_xmii018_s = g_xmii_d[p_ac].l_xmii018_s + g_xmii_d[p_ac].l_xmii018_15
      LET g_xmii_d[p_ac].l_xmii019_s = g_xmii_d[p_ac].l_xmii019_s + g_xmii_d[p_ac].l_xmii019_15
      LET g_xmii2_d[p_ac].l_xmii022_15 = g_xmii2_d[p_ac+1].l_xmii022_01
      LET g_xmii2_d[p_ac].l_xmii023_15 = g_xmii2_d[p_ac+1].l_xmii023_01
      LET g_xmii2_d[p_ac].l_xmii022_s = g_xmii2_d[p_ac].l_xmii022_s + g_xmii2_d[p_ac].l_xmii022_15
      LET g_xmii2_d[p_ac].l_xmii023_s = g_xmii2_d[p_ac].l_xmii023_s + g_xmii2_d[p_ac].l_xmii023_15 
      LET g_xmii3_d[p_ac].l_xmii018_3_15 = g_xmii3_d[p_ac+1].l_xmii018_3_01
      LET g_xmii3_d[p_ac].l_xmii019_3_15 = g_xmii3_d[p_ac+1].l_xmii019_3_01
      LET g_xmii3_d[p_ac].l_xmii018_3_s = g_xmii3_d[p_ac].l_xmii018_3_s + g_xmii3_d[p_ac].l_xmii018_3_15
      LET g_xmii3_d[p_ac].l_xmii019_3_s = g_xmii3_d[p_ac].l_xmii019_3_s + g_xmii3_d[p_ac].l_xmii019_3_15          
      LET g_xmii3_d[p_ac].l_xmii022_3_15 = g_xmii3_d[p_ac+1].l_xmii022_3_01
      LET g_xmii3_d[p_ac].l_xmii023_3_15 = g_xmii3_d[p_ac+1].l_xmii023_3_01
      LET g_xmii3_d[p_ac].l_xmii022_3_s = g_xmii3_d[p_ac].l_xmii022_3_s + g_xmii3_d[p_ac].l_xmii022_3_15
      LET g_xmii3_d[p_ac].l_xmii023_3_s = g_xmii3_d[p_ac].l_xmii023_3_s + g_xmii3_d[p_ac].l_xmii023_3_15       
   END IF
   IF p_xmii014 = 16 THEN 
      LET g_xmii_d[p_ac].l_xmii018_16 = g_xmii_d[p_ac+1].l_xmii018_01
      LET g_xmii_d[p_ac].l_xmii019_16 = g_xmii_d[p_ac+1].l_xmii019_01
      LET g_xmii_d[p_ac].l_xmii018_s = g_xmii_d[p_ac].l_xmii018_s + g_xmii_d[p_ac].l_xmii018_16
      LET g_xmii_d[p_ac].l_xmii019_s = g_xmii_d[p_ac].l_xmii019_s + g_xmii_d[p_ac].l_xmii019_16
      LET g_xmii2_d[p_ac].l_xmii022_16 = g_xmii2_d[p_ac+1].l_xmii022_01
      LET g_xmii2_d[p_ac].l_xmii023_16 = g_xmii2_d[p_ac+1].l_xmii023_01
      LET g_xmii2_d[p_ac].l_xmii022_s = g_xmii2_d[p_ac].l_xmii022_s + g_xmii2_d[p_ac].l_xmii022_16
      LET g_xmii2_d[p_ac].l_xmii023_s = g_xmii2_d[p_ac].l_xmii023_s + g_xmii2_d[p_ac].l_xmii023_16 
      LET g_xmii3_d[p_ac].l_xmii018_3_16 = g_xmii3_d[p_ac+1].l_xmii018_3_01
      LET g_xmii3_d[p_ac].l_xmii019_3_16 = g_xmii3_d[p_ac+1].l_xmii019_3_01
      LET g_xmii3_d[p_ac].l_xmii018_3_s = g_xmii3_d[p_ac].l_xmii018_3_s + g_xmii3_d[p_ac].l_xmii018_3_16
      LET g_xmii3_d[p_ac].l_xmii019_3_s = g_xmii3_d[p_ac].l_xmii019_3_s + g_xmii3_d[p_ac].l_xmii019_3_16          
      LET g_xmii3_d[p_ac].l_xmii022_3_16 = g_xmii3_d[p_ac+1].l_xmii022_3_01
      LET g_xmii3_d[p_ac].l_xmii023_3_16 = g_xmii3_d[p_ac+1].l_xmii023_3_01
      LET g_xmii3_d[p_ac].l_xmii022_3_s = g_xmii3_d[p_ac].l_xmii022_3_s + g_xmii3_d[p_ac].l_xmii022_3_16
      LET g_xmii3_d[p_ac].l_xmii023_3_s = g_xmii3_d[p_ac].l_xmii023_3_s + g_xmii3_d[p_ac].l_xmii023_3_16      
   END IF
   IF p_xmii014 = 17 THEN 
      LET g_xmii_d[p_ac].l_xmii018_17 = g_xmii_d[p_ac+1].l_xmii018_01
      LET g_xmii_d[p_ac].l_xmii019_17 = g_xmii_d[p_ac+1].l_xmii019_01
      LET g_xmii_d[p_ac].l_xmii018_s = g_xmii_d[p_ac].l_xmii018_s + g_xmii_d[p_ac].l_xmii018_17
      LET g_xmii_d[p_ac].l_xmii019_s = g_xmii_d[p_ac].l_xmii019_s + g_xmii_d[p_ac].l_xmii019_17
      LET g_xmii2_d[p_ac].l_xmii022_17 = g_xmii2_d[p_ac+1].l_xmii022_01
      LET g_xmii2_d[p_ac].l_xmii023_17 = g_xmii2_d[p_ac+1].l_xmii023_01
      LET g_xmii2_d[p_ac].l_xmii022_s = g_xmii2_d[p_ac].l_xmii022_s + g_xmii2_d[p_ac].l_xmii022_17
      LET g_xmii2_d[p_ac].l_xmii023_s = g_xmii2_d[p_ac].l_xmii023_s + g_xmii2_d[p_ac].l_xmii023_17 
      LET g_xmii3_d[p_ac].l_xmii018_3_17 = g_xmii3_d[p_ac+1].l_xmii018_3_01
      LET g_xmii3_d[p_ac].l_xmii019_3_17 = g_xmii3_d[p_ac+1].l_xmii019_3_01
      LET g_xmii3_d[p_ac].l_xmii018_3_s = g_xmii3_d[p_ac].l_xmii018_3_s + g_xmii3_d[p_ac].l_xmii018_3_17
      LET g_xmii3_d[p_ac].l_xmii019_3_s = g_xmii3_d[p_ac].l_xmii019_3_s + g_xmii3_d[p_ac].l_xmii019_3_17          
      LET g_xmii3_d[p_ac].l_xmii022_3_17 = g_xmii3_d[p_ac+1].l_xmii022_3_01
      LET g_xmii3_d[p_ac].l_xmii023_3_17 = g_xmii3_d[p_ac+1].l_xmii023_3_01
      LET g_xmii3_d[p_ac].l_xmii022_3_s = g_xmii3_d[p_ac].l_xmii022_3_s + g_xmii3_d[p_ac].l_xmii022_3_17
      LET g_xmii3_d[p_ac].l_xmii023_3_s = g_xmii3_d[p_ac].l_xmii023_3_s + g_xmii3_d[p_ac].l_xmii023_3_17        
   END IF
   IF p_xmii014 = 18 THEN 
      LET g_xmii_d[p_ac].l_xmii018_18 = g_xmii_d[p_ac+1].l_xmii018_01
      LET g_xmii_d[p_ac].l_xmii019_18 = g_xmii_d[p_ac+1].l_xmii019_01
      LET g_xmii_d[p_ac].l_xmii018_s = g_xmii_d[p_ac].l_xmii018_s + g_xmii_d[p_ac].l_xmii018_18
      LET g_xmii_d[p_ac].l_xmii019_s = g_xmii_d[p_ac].l_xmii019_s + g_xmii_d[p_ac].l_xmii019_18
      LET g_xmii2_d[p_ac].l_xmii022_18 = g_xmii2_d[p_ac+1].l_xmii022_01
      LET g_xmii2_d[p_ac].l_xmii023_18 = g_xmii2_d[p_ac+1].l_xmii023_01
      LET g_xmii2_d[p_ac].l_xmii022_s = g_xmii2_d[p_ac].l_xmii022_s + g_xmii2_d[p_ac].l_xmii022_18
      LET g_xmii2_d[p_ac].l_xmii023_s = g_xmii2_d[p_ac].l_xmii023_s + g_xmii2_d[p_ac].l_xmii023_18 
      LET g_xmii3_d[p_ac].l_xmii018_3_18 = g_xmii3_d[p_ac+1].l_xmii018_3_01
      LET g_xmii3_d[p_ac].l_xmii019_3_18 = g_xmii3_d[p_ac+1].l_xmii019_3_01
      LET g_xmii3_d[p_ac].l_xmii018_3_s = g_xmii3_d[p_ac].l_xmii018_3_s + g_xmii3_d[p_ac].l_xmii018_3_18
      LET g_xmii3_d[p_ac].l_xmii019_3_s = g_xmii3_d[p_ac].l_xmii019_3_s + g_xmii3_d[p_ac].l_xmii019_3_18          
      LET g_xmii3_d[p_ac].l_xmii022_3_18 = g_xmii3_d[p_ac+1].l_xmii022_3_01
      LET g_xmii3_d[p_ac].l_xmii023_3_18 = g_xmii3_d[p_ac+1].l_xmii023_3_01
      LET g_xmii3_d[p_ac].l_xmii022_3_s = g_xmii3_d[p_ac].l_xmii022_3_s + g_xmii3_d[p_ac].l_xmii022_3_18
      LET g_xmii3_d[p_ac].l_xmii023_3_s = g_xmii3_d[p_ac].l_xmii023_3_s + g_xmii3_d[p_ac].l_xmii023_3_18          
   END IF
   IF p_xmii014 = 19 THEN 
      LET g_xmii_d[p_ac].l_xmii018_19 = g_xmii_d[p_ac+1].l_xmii018_01
      LET g_xmii_d[p_ac].l_xmii019_19 = g_xmii_d[p_ac+1].l_xmii019_01
      LET g_xmii_d[p_ac].l_xmii018_s = g_xmii_d[p_ac].l_xmii018_s + g_xmii_d[p_ac].l_xmii018_19
      LET g_xmii_d[p_ac].l_xmii019_s = g_xmii_d[p_ac].l_xmii019_s + g_xmii_d[p_ac].l_xmii019_19
      LET g_xmii2_d[p_ac].l_xmii022_19 = g_xmii2_d[p_ac+1].l_xmii022_01
      LET g_xmii2_d[p_ac].l_xmii023_19 = g_xmii2_d[p_ac+1].l_xmii023_01
      LET g_xmii2_d[p_ac].l_xmii022_s = g_xmii2_d[p_ac].l_xmii022_s + g_xmii2_d[p_ac].l_xmii022_19
      LET g_xmii2_d[p_ac].l_xmii023_s = g_xmii2_d[p_ac].l_xmii023_s + g_xmii2_d[p_ac].l_xmii023_19 
      LET g_xmii3_d[p_ac].l_xmii018_3_19 = g_xmii3_d[p_ac+1].l_xmii018_3_01
      LET g_xmii3_d[p_ac].l_xmii019_3_19 = g_xmii3_d[p_ac+1].l_xmii019_3_01
      LET g_xmii3_d[p_ac].l_xmii018_3_s = g_xmii3_d[p_ac].l_xmii018_3_s + g_xmii3_d[p_ac].l_xmii018_3_19
      LET g_xmii3_d[p_ac].l_xmii019_3_s = g_xmii3_d[p_ac].l_xmii019_3_s + g_xmii3_d[p_ac].l_xmii019_3_19          
      LET g_xmii3_d[p_ac].l_xmii022_3_19 = g_xmii3_d[p_ac+1].l_xmii022_3_01
      LET g_xmii3_d[p_ac].l_xmii023_3_19 = g_xmii3_d[p_ac+1].l_xmii023_3_01
      LET g_xmii3_d[p_ac].l_xmii022_3_s = g_xmii3_d[p_ac].l_xmii022_3_s + g_xmii3_d[p_ac].l_xmii022_3_19
      LET g_xmii3_d[p_ac].l_xmii023_3_s = g_xmii3_d[p_ac].l_xmii023_3_s + g_xmii3_d[p_ac].l_xmii023_3_19          
   END IF
   IF p_xmii014 = 20 THEN 
      LET g_xmii_d[p_ac].l_xmii018_20 = g_xmii_d[p_ac+1].l_xmii018_01
      LET g_xmii_d[p_ac].l_xmii019_20 = g_xmii_d[p_ac+1].l_xmii019_01
      LET g_xmii_d[p_ac].l_xmii018_s = g_xmii_d[p_ac].l_xmii018_s + g_xmii_d[p_ac].l_xmii018_20
      LET g_xmii_d[p_ac].l_xmii019_s = g_xmii_d[p_ac].l_xmii019_s + g_xmii_d[p_ac].l_xmii019_20
      LET g_xmii2_d[p_ac].l_xmii022_20 = g_xmii2_d[p_ac+1].l_xmii022_01
      LET g_xmii2_d[p_ac].l_xmii023_20 = g_xmii2_d[p_ac+1].l_xmii023_01
      LET g_xmii2_d[p_ac].l_xmii022_s = g_xmii2_d[p_ac].l_xmii022_s + g_xmii2_d[p_ac].l_xmii022_20
      LET g_xmii2_d[p_ac].l_xmii023_s = g_xmii2_d[p_ac].l_xmii023_s + g_xmii2_d[p_ac].l_xmii023_20 
      LET g_xmii3_d[p_ac].l_xmii018_3_20 = g_xmii3_d[p_ac+1].l_xmii018_3_01
      LET g_xmii3_d[p_ac].l_xmii019_3_20 = g_xmii3_d[p_ac+1].l_xmii019_3_01
      LET g_xmii3_d[p_ac].l_xmii018_3_s = g_xmii3_d[p_ac].l_xmii018_3_s + g_xmii3_d[p_ac].l_xmii018_3_20
      LET g_xmii3_d[p_ac].l_xmii019_3_s = g_xmii3_d[p_ac].l_xmii019_3_s + g_xmii3_d[p_ac].l_xmii019_3_20          
      LET g_xmii3_d[p_ac].l_xmii022_3_20 = g_xmii3_d[p_ac+1].l_xmii022_3_01
      LET g_xmii3_d[p_ac].l_xmii023_3_20 = g_xmii3_d[p_ac+1].l_xmii023_3_01
      LET g_xmii3_d[p_ac].l_xmii022_3_s = g_xmii3_d[p_ac].l_xmii022_3_s + g_xmii3_d[p_ac].l_xmii022_3_20
      LET g_xmii3_d[p_ac].l_xmii023_3_s = g_xmii3_d[p_ac].l_xmii023_3_s + g_xmii3_d[p_ac].l_xmii023_3_20            
   END IF
   IF p_xmii014 = 21 THEN 
      LET g_xmii_d[p_ac].l_xmii018_21 = g_xmii_d[p_ac+1].l_xmii018_01
      LET g_xmii_d[p_ac].l_xmii019_21 = g_xmii_d[p_ac+1].l_xmii019_01
      LET g_xmii_d[p_ac].l_xmii018_s = g_xmii_d[p_ac].l_xmii018_s + g_xmii_d[p_ac].l_xmii018_21
      LET g_xmii_d[p_ac].l_xmii019_s = g_xmii_d[p_ac].l_xmii019_s + g_xmii_d[p_ac].l_xmii019_21
      LET g_xmii2_d[p_ac].l_xmii022_21 = g_xmii2_d[p_ac+1].l_xmii022_01
      LET g_xmii2_d[p_ac].l_xmii023_21 = g_xmii2_d[p_ac+1].l_xmii023_01
      LET g_xmii2_d[p_ac].l_xmii022_s = g_xmii2_d[p_ac].l_xmii022_s + g_xmii2_d[p_ac].l_xmii022_21
      LET g_xmii2_d[p_ac].l_xmii023_s = g_xmii2_d[p_ac].l_xmii023_s + g_xmii2_d[p_ac].l_xmii023_21 
      LET g_xmii3_d[p_ac].l_xmii018_3_21 = g_xmii3_d[p_ac+1].l_xmii018_3_01
      LET g_xmii3_d[p_ac].l_xmii019_3_21 = g_xmii3_d[p_ac+1].l_xmii019_3_01
      LET g_xmii3_d[p_ac].l_xmii018_3_s = g_xmii3_d[p_ac].l_xmii018_3_s + g_xmii3_d[p_ac].l_xmii018_3_21
      LET g_xmii3_d[p_ac].l_xmii019_3_s = g_xmii3_d[p_ac].l_xmii019_3_s + g_xmii3_d[p_ac].l_xmii019_3_21          
      LET g_xmii3_d[p_ac].l_xmii022_3_21 = g_xmii3_d[p_ac+1].l_xmii022_3_01
      LET g_xmii3_d[p_ac].l_xmii023_3_21 = g_xmii3_d[p_ac+1].l_xmii023_3_01
      LET g_xmii3_d[p_ac].l_xmii022_3_s = g_xmii3_d[p_ac].l_xmii022_3_s + g_xmii3_d[p_ac].l_xmii022_3_21
      LET g_xmii3_d[p_ac].l_xmii023_3_s = g_xmii3_d[p_ac].l_xmii023_3_s + g_xmii3_d[p_ac].l_xmii023_3_21            
   END IF
   IF p_xmii014 = 22 THEN 
      LET g_xmii_d[p_ac].l_xmii018_22 = g_xmii_d[p_ac+1].l_xmii018_01
      LET g_xmii_d[p_ac].l_xmii019_22 = g_xmii_d[p_ac+1].l_xmii019_01
      LET g_xmii_d[p_ac].l_xmii018_s = g_xmii_d[p_ac].l_xmii018_s + g_xmii_d[p_ac].l_xmii018_22
      LET g_xmii_d[p_ac].l_xmii019_s = g_xmii_d[p_ac].l_xmii019_s + g_xmii_d[p_ac].l_xmii019_22
      LET g_xmii2_d[p_ac].l_xmii022_22 = g_xmii2_d[p_ac+1].l_xmii022_01
      LET g_xmii2_d[p_ac].l_xmii023_22 = g_xmii2_d[p_ac+1].l_xmii023_01
      LET g_xmii2_d[p_ac].l_xmii022_s = g_xmii2_d[p_ac].l_xmii022_s + g_xmii2_d[p_ac].l_xmii022_22
      LET g_xmii2_d[p_ac].l_xmii023_s = g_xmii2_d[p_ac].l_xmii023_s + g_xmii2_d[p_ac].l_xmii023_22 
      LET g_xmii3_d[p_ac].l_xmii018_3_22 = g_xmii3_d[p_ac+1].l_xmii018_3_01
      LET g_xmii3_d[p_ac].l_xmii019_3_22 = g_xmii3_d[p_ac+1].l_xmii019_3_01
      LET g_xmii3_d[p_ac].l_xmii018_3_s = g_xmii3_d[p_ac].l_xmii018_3_s + g_xmii3_d[p_ac].l_xmii018_3_22
      LET g_xmii3_d[p_ac].l_xmii019_3_s = g_xmii3_d[p_ac].l_xmii019_3_s + g_xmii3_d[p_ac].l_xmii019_3_22          
      LET g_xmii3_d[p_ac].l_xmii022_3_22 = g_xmii3_d[p_ac+1].l_xmii022_3_01
      LET g_xmii3_d[p_ac].l_xmii023_3_22 = g_xmii3_d[p_ac+1].l_xmii023_3_01
      LET g_xmii3_d[p_ac].l_xmii022_3_s = g_xmii3_d[p_ac].l_xmii022_3_s + g_xmii3_d[p_ac].l_xmii022_3_22
      LET g_xmii3_d[p_ac].l_xmii023_3_s = g_xmii3_d[p_ac].l_xmii023_3_s + g_xmii3_d[p_ac].l_xmii023_3_22            
   END IF
   IF p_xmii014 = 23 THEN 


      LET g_xmii_d[p_ac].l_xmii018_23 = g_xmii_d[p_ac+1].l_xmii018_01
      LET g_xmii_d[p_ac].l_xmii019_23 = g_xmii_d[p_ac+1].l_xmii019_01
      LET g_xmii_d[p_ac].l_xmii018_s = g_xmii_d[p_ac].l_xmii018_s + g_xmii_d[p_ac].l_xmii018_23
      LET g_xmii_d[p_ac].l_xmii019_s = g_xmii_d[p_ac].l_xmii019_s + g_xmii_d[p_ac].l_xmii019_23
      LET g_xmii2_d[p_ac].l_xmii022_23 = g_xmii2_d[p_ac+1].l_xmii022_01
      LET g_xmii2_d[p_ac].l_xmii023_23 = g_xmii2_d[p_ac+1].l_xmii023_01
      LET g_xmii2_d[p_ac].l_xmii022_s = g_xmii2_d[p_ac].l_xmii022_s + g_xmii2_d[p_ac].l_xmii022_23
      LET g_xmii2_d[p_ac].l_xmii023_s = g_xmii2_d[p_ac].l_xmii023_s + g_xmii2_d[p_ac].l_xmii023_23 
      LET g_xmii3_d[p_ac].l_xmii018_3_23 = g_xmii3_d[p_ac+1].l_xmii018_3_01
      LET g_xmii3_d[p_ac].l_xmii019_3_23 = g_xmii3_d[p_ac+1].l_xmii019_3_01
      LET g_xmii3_d[p_ac].l_xmii018_3_s = g_xmii3_d[p_ac].l_xmii018_3_s + g_xmii3_d[p_ac].l_xmii018_3_23
      LET g_xmii3_d[p_ac].l_xmii019_3_s = g_xmii3_d[p_ac].l_xmii019_3_s + g_xmii3_d[p_ac].l_xmii019_3_23          
      LET g_xmii3_d[p_ac].l_xmii022_3_23 = g_xmii3_d[p_ac+1].l_xmii022_3_01
      LET g_xmii3_d[p_ac].l_xmii023_3_23 = g_xmii3_d[p_ac+1].l_xmii023_3_01
      LET g_xmii3_d[p_ac].l_xmii022_3_s = g_xmii3_d[p_ac].l_xmii022_3_s + g_xmii3_d[p_ac].l_xmii022_3_23
      LET g_xmii3_d[p_ac].l_xmii023_3_s = g_xmii3_d[p_ac].l_xmii023_3_s + g_xmii3_d[p_ac].l_xmii023_3_23       
   END IF
   IF p_xmii014 = 24 THEN 
      LET g_xmii_d[p_ac].l_xmii018_24 = g_xmii_d[p_ac+1].l_xmii018_01
      LET g_xmii_d[p_ac].l_xmii019_24 = g_xmii_d[p_ac+1].l_xmii019_01
      LET g_xmii_d[p_ac].l_xmii018_s = g_xmii_d[p_ac].l_xmii018_s + g_xmii_d[p_ac].l_xmii018_24
      LET g_xmii_d[p_ac].l_xmii019_s = g_xmii_d[p_ac].l_xmii019_s + g_xmii_d[p_ac].l_xmii019_24
      LET g_xmii2_d[p_ac].l_xmii022_24 = g_xmii2_d[p_ac+1].l_xmii022_01
      LET g_xmii2_d[p_ac].l_xmii023_24 = g_xmii2_d[p_ac+1].l_xmii023_01
      LET g_xmii2_d[p_ac].l_xmii022_s = g_xmii2_d[p_ac].l_xmii022_s + g_xmii2_d[p_ac].l_xmii022_24
      LET g_xmii2_d[p_ac].l_xmii023_s = g_xmii2_d[p_ac].l_xmii023_s + g_xmii2_d[p_ac].l_xmii023_24 
      LET g_xmii3_d[p_ac].l_xmii018_3_24 = g_xmii3_d[p_ac+1].l_xmii018_3_01
      LET g_xmii3_d[p_ac].l_xmii019_3_24 = g_xmii3_d[p_ac+1].l_xmii019_3_01
      LET g_xmii3_d[p_ac].l_xmii018_3_s = g_xmii3_d[p_ac].l_xmii018_3_s + g_xmii3_d[p_ac].l_xmii018_3_24
      LET g_xmii3_d[p_ac].l_xmii019_3_s = g_xmii3_d[p_ac].l_xmii019_3_s + g_xmii3_d[p_ac].l_xmii019_3_24          
      LET g_xmii3_d[p_ac].l_xmii022_3_24 = g_xmii3_d[p_ac+1].l_xmii022_3_01
      LET g_xmii3_d[p_ac].l_xmii023_3_24 = g_xmii3_d[p_ac+1].l_xmii023_3_01
      LET g_xmii3_d[p_ac].l_xmii022_3_s = g_xmii3_d[p_ac].l_xmii022_3_s + g_xmii3_d[p_ac].l_xmii022_3_24
      LET g_xmii3_d[p_ac].l_xmii023_3_s = g_xmii3_d[p_ac].l_xmii023_3_s + g_xmii3_d[p_ac].l_xmii023_3_24      
   END IF   
END FUNCTION]]>
  </point>
  <point name="function.axmt175_b_fill3" order="2" ver="1" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 下層調整資料
# Memo...........:
# Usage..........: CALL axmt175_b_fill3()
# Date & Author..: 日期 By 作者
# Modify.........:
################################################################################
PRIVATE FUNCTION axmt175_b_fill3()
DEFINE   l_xmii005   LIKE xmii_t.xmii005
DEFINE   g_xmii005   LIKE xmii_t.xmii005
DEFINE   l_xmii014   LIKE xmii_t.xmii014
DEFINE   l_xmii004   LIKE xmii_t.xmii004
DEFINE   l_xmia002   LIKE xmia_t.xmia002
DEFINE   i           LIKE type_t.num5

   CALL g_xmii5_d.clear()

   LET g_sql = "SELECT  UNIQUE xmii005,xmii007,'',xmii006,'',xmii008,'',xmii012,'',xmii013,'',xmii011,'', 
          xmii009,'','',xmii010,xmii017,'',xmii014,xmii018,xmii019,'','','','','','','','','','','','','','','', 
          '','','','','','','','','','','','','','','','','','','','','','','','','','','','','','', 
          '','','' FROM xmii_t",   
                  " INNER JOIN xmih_t ON xmih001 = xmii001 ",
                  " AND xmih002 = xmii002 ",
                  " AND xmih003 = xmii003 ",
                  " AND xmih004 = xmii004 ",
                  "",
                  " WHERE xmiient=? AND xmii001=? AND xmii002=? AND xmii003=? AND xmii004=? ",
                  "   AND xmii006=? AND xmii007=? AND xmii008=? AND xmii009=? AND xmii010=? ",
                  "   AND xmii011=? AND xmii012=? AND xmii013=? "
      IF NOT cl_null(g_wc2_table1) THEN
         LET g_sql = g_sql CLIPPED, " AND ", g_wc2_table1 CLIPPED
      END IF     
      LET g_sql = g_sql, " ORDER BY xmii_t.xmii005,xmii_t.xmii006,xmii_t.xmii007,xmii_t.xmii008,xmii_t.xmii009,xmii_t.xmii010,xmii_t.xmii011,xmii_t.xmii012,xmii_t.xmii013,xmii_t.xmii017,xmii_t.xmii014" 
      PREPARE axmt175_pb_5 FROM g_sql
      DECLARE b_fill_cs_5 CURSOR FOR axmt175_pb_5  
      SELECT xmii004 INTO l_xmii004 FROM xmii_t 
       WHERE xmiient = g_enterprise
         AND xmii001 = g_xmih_m.xmih001              
         AND xmii002 = g_xmih_m.xmih002
         AND xmii003 = g_xmih_m.xmih003          
         AND xmii005 = g_xmih_m.xmih004       
         AND xmii006 = g_xmii_d[l_ac].xmii006        
         AND xmii007 = g_xmii_d[l_ac].xmii007       
         AND xmii008 = g_xmii_d[l_ac].xmii008       
         AND xmii009 = g_xmii_d[l_ac].xmii009       
         AND xmii010 = g_xmii_d[l_ac].xmii010  
         AND xmii011 = g_xmii_d[l_ac].xmii011       
         AND xmii012 = g_xmii_d[l_ac].xmii012       

      OPEN b_fill_cs_5 USING g_enterprise,g_xmih_m.xmih001
                                               ,g_xmih_m.xmih002
                                               ,g_xmih_m.xmih003
                                               ,l_xmii004
                                               ,g_xmii_d[l_ac].xmii006     
                                               ,g_xmii_d[l_ac].xmii007   
                                               ,g_xmii_d[l_ac].xmii008   
                                               ,g_xmii_d[l_ac].xmii009   
                                               ,g_xmii_d[l_ac].xmii010   
                                               ,g_xmii_d[l_ac].xmii011   
                                               ,g_xmii_d[l_ac].xmii012  
                                               ,g_xmii_d[l_ac].xmii013 
     LET l_ac = 1
     LET l_xmii005 = NULL     
     FOREACH b_fill_cs_5 INTO g_xmii005,g_xmii5_d[l_ac].l_xmii007_1,g_xmii5_d[l_ac].l_xmii007_1_desc,g_xmii5_d[l_ac].l_xmii006_1,g_xmii5_d[l_ac].l_xmii006_1_desc,
                              g_xmii5_d[l_ac].l_xmii008_1,g_xmii5_d[l_ac].l_xmii008_1_desc,g_xmii5_d[l_ac].l_xmii012_1,g_xmii5_d[l_ac].l_xmii012_1_desc,
                              g_xmii5_d[l_ac].l_xmii013_1,g_xmii5_d[l_ac].l_xmii013_1_desc,g_xmii5_d[l_ac].l_xmii011_1,g_xmii5_d[l_ac].l_xmii011_1_desc,g_xmii5_d[l_ac].l_xmii009_1,
                              g_xmii5_d[l_ac].l_xmii009_1_desc,g_xmii5_d[l_ac].l_xmii009_1_desc_1,g_xmii5_d[l_ac].l_xmii010_1,g_xmii5_d[l_ac].l_xmii017_1,
                              g_xmii5_d[l_ac].l_xmii017_1_desc,g_xmii5_d[l_ac].l_xmii014_1,g_xmii5_d[l_ac].l_xmii018_5_01,g_xmii5_d[l_ac].l_xmii019_5_01,g_xmii5_d[l_ac].l_xmii018_5_02,g_xmii5_d[l_ac].l_xmii019_5_02,
                              g_xmii5_d[l_ac].l_xmii018_5_03,g_xmii5_d[l_ac].l_xmii019_5_03,g_xmii5_d[l_ac].l_xmii018_5_04,g_xmii5_d[l_ac].l_xmii019_5_04,g_xmii5_d[l_ac].l_xmii018_5_05,g_xmii5_d[l_ac].l_xmii019_5_05,
                              g_xmii5_d[l_ac].l_xmii018_5_06,g_xmii5_d[l_ac].l_xmii019_5_06,g_xmii5_d[l_ac].l_xmii018_5_07,g_xmii5_d[l_ac].l_xmii019_5_07,g_xmii5_d[l_ac].l_xmii018_5_08,g_xmii5_d[l_ac].l_xmii019_5_08, 
                              g_xmii5_d[l_ac].l_xmii018_5_09,g_xmii5_d[l_ac].l_xmii019_5_09,g_xmii5_d[l_ac].l_xmii018_5_10,g_xmii5_d[l_ac].l_xmii019_5_10,g_xmii5_d[l_ac].l_xmii018_5_11,g_xmii5_d[l_ac].l_xmii019_5_11,
                              g_xmii5_d[l_ac].l_xmii018_5_12,g_xmii5_d[l_ac].l_xmii019_5_12,g_xmii5_d[l_ac].l_xmii018_5_13,g_xmii5_d[l_ac].l_xmii019_5_13,g_xmii5_d[l_ac].l_xmii018_5_14,g_xmii5_d[l_ac].l_xmii019_5_14,     
                              g_xmii5_d[l_ac].l_xmii018_5_15,g_xmii5_d[l_ac].l_xmii019_5_15,g_xmii5_d[l_ac].l_xmii018_5_16,g_xmii5_d[l_ac].l_xmii019_5_16,g_xmii5_d[l_ac].l_xmii018_5_17,g_xmii5_d[l_ac].l_xmii019_5_17,
                              g_xmii5_d[l_ac].l_xmii018_5_18,g_xmii5_d[l_ac].l_xmii019_5_18,g_xmii5_d[l_ac].l_xmii018_5_19,g_xmii5_d[l_ac].l_xmii019_5_19,g_xmii5_d[l_ac].l_xmii018_5_20,g_xmii5_d[l_ac].l_xmii019_5_20, 
                              g_xmii5_d[l_ac].l_xmii018_5_21,g_xmii5_d[l_ac].l_xmii019_5_21,g_xmii5_d[l_ac].l_xmii018_5_22,g_xmii5_d[l_ac].l_xmii019_5_22,g_xmii5_d[l_ac].l_xmii018_5_23,g_xmii5_d[l_ac].l_xmii019_5_23,
                              g_xmii5_d[l_ac].l_xmii018_5_24,g_xmii5_d[l_ac].l_xmii019_5_24,g_xmii5_d[l_ac].l_xmii018_5_s,g_xmii5_d[l_ac].l_xmii019_5_s         

         IF SQLCA.sqlcode THEN
            CALL cl_err("FOREACH:",SQLCA.sqlcode,1)
            EXIT FOREACH
         END IF
         IF l_ac = 1 THEN
            LET l_xmii005 = g_xmii005
            LET g_xmii5_d[l_ac].l_xmii018_5_s = g_xmii5_d[l_ac].l_xmii018_5_01
            LET g_xmii5_d[l_ac].l_xmii019_5_s = g_xmii5_d[l_ac].l_xmii019_5_01 
         END IF
         LET l_xmii014 = g_xmii5_d[l_ac].l_xmii014_1 
         IF g_xmii005 <> l_xmii005 THEN
            LET l_xmii005 = g_xmii005      
            LET g_xmii5_d[l_ac].l_xmii018_5_s = g_xmii5_d[l_ac].l_xmii018_5_01
            LET g_xmii5_d[l_ac].l_xmii019_5_s = g_xmii5_d[l_ac].l_xmii019_5_01             
         ELSE
            IF l_ac > 1 THEN
               LET l_ac = l_ac - 1
            END IF
            IF l_xmii014 > 1 THEN
               CALL axmt175_b_desc_5(l_xmii014,l_ac)
            END IF              
         END IF
         CALL axmt175_xmii006_desc(g_xmii5_d[l_ac].l_xmii007_1) RETURNING g_xmii5_d[l_ac].l_xmii007_1_desc
         CALL axmt175_xmii006_desc(g_xmii5_d[l_ac].l_xmii006_1) RETURNING g_xmii5_d[l_ac].l_xmii006_1_desc
         CALL axmt175_xmii008_desc(g_xmii5_d[l_ac].l_xmii008_1) RETURNING g_xmii5_d[l_ac].l_xmii008_1_desc
         CALL axmt175_xmii011_desc(g_xmii5_d[l_ac].l_xmii011_1) RETURNING g_xmii5_d[l_ac].l_xmii011_1_desc    
         CALL axmt175_xmii012_desc(g_xmii5_d[l_ac].l_xmii012_1) RETURNING g_xmii5_d[l_ac].l_xmii012_1_desc
         CALL axmt175_xmii013_desc(g_xmii5_d[l_ac].l_xmii013_1) RETURNING g_xmii5_d[l_ac].l_xmii013_1_desc
         CALL axmt175_xmii009_desc(g_xmii5_d[l_ac].l_xmii009_1) RETURNING g_xmii5_d[l_ac].l_xmii009_1_desc,g_xmii5_d[l_ac].l_xmii009_1_desc_1
         CALL axmt175_xmii017_desc(g_xmii5_d[l_ac].l_xmii017_1) RETURNING g_xmii5_d[l_ac].l_xmii017_1_desc
         LET l_ac = l_ac + 1
         IF l_ac > g_max_rec AND g_error_show = 1 THEN
            CALL cl_err( '', 9035, 1)
            EXIT FOREACH
         END IF
     END FOREACH  
     
   IF l_ac > 1 THEN
      INITIALIZE g_xmii5_d[l_ac].* TO NULL   
      CALL cl_getmsg('axc-00204',g_lang) RETURNING g_xmii5_d[l_ac].l_xmii009_1
      SELECT xmia002 INTO l_xmia002 FROM xmia_t
       WHERE xmiaent = g_enterprise
         AND xmia001 = g_xmih_m.xmih001
      FOR i = 1 TO l_xmia002
          CALL axmt175_sum_xmii_5(i,l_xmii004)
      END FOR
      SELECT SUM(xmii018),SUM(xmii019),SUM(xmii022),SUM(xmii023)
        INTO g_xmii5_d[l_ac].l_xmii018_5_s,g_xmii5_d[l_ac].l_xmii019_5_s,g_xmii6_d[l_ac].l_xmii022_6_s,g_xmii6_d[l_ac].l_xmii023_6_s
        FROM xmii_t
       WHERE xmiient = g_enterprise
         AND xmii001 = g_xmih_m.xmih001
         AND xmii002 = g_xmih_m.xmih002
         AND xmii003 = g_xmih_m.xmih003
         AND xmii004 = l_xmii004
         AND xmii006 = g_xmii_d[l_ac].xmii006
         AND xmii007 = g_xmii_d[l_ac].xmii007
         AND xmii008 = g_xmii_d[l_ac].xmii008
         AND xmii009 = g_xmii_d[l_ac].xmii009
         AND xmii010 = g_xmii_d[l_ac].xmii010
         AND xmii011 = g_xmii_d[l_ac].xmii011
         AND xmii012 = g_xmii_d[l_ac].xmii012
         AND xmii013 = g_xmii_d[l_ac].xmii013     
   ELSE
      CALL g_xmii5_d.deleteElement(g_xmii5_d.getLength())
   END IF       
     LET g_error_show = 0     
END FUNCTION]]>
  </point>
  <point name="function.axmt175_xmii_hide" order="3" ver="1" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 數量金額欄位的動態顯示
# Memo...........:
# Usage..........: CALL axmt175_xmii_hide()
#                  RETURNING 回传参数
# Input parameter: 传入参数变量1   传入参数变量说明1
#                : 传入参数变量2   传入参数变量说明2
# Return code....: 回传参数变量1   回传参数变量说明1
#                : 回传参数变量2   回传参数变量说明2
# Date & Author..: 日期 By 作者
# Modify.........:
################################################################################
PRIVATE FUNCTION axmt175_xmii_hide()
DEFINE l_str_field     LIKE type_t.chr14
DEFINE lc_index        LIKE type_t.chr2
DEFINE li_i            LIKE type_t.num5
DEFINE li_j            LIKE type_t.num5
DEFINE l_xmia002       LIKE xmia_t.xmia002
DEFINE l_msg           LIKE type_t.chr80
DEFINE l_xmij004       LIKE xmij_t.xmij004
DEFINE l_xmij005       LIKE xmij_t.xmij005
DEFINE l_xmij006       LIKE xmij_t.xmij006
DEFINE l_xmij007       LIKE xmij_t.xmij007
DEFINE l_xmij008       LIKE xmij_t.xmij008
DEFINE l_xmij009       LIKE xmij_t.xmij009
DEFINE l_xmij011       LIKE xmij_t.xmij011
DEFINE ls_show         STRING
DEFINE ls_hide         STRING
DEFINE l_field         STRING

   SELECT xmia002 INTO l_xmia002 FROM xmia_t
    WHERE xmiaent = g_enterprise
      AND xmia001 = g_xmih_m.xmih001
   LET l_msg = ''      
   LET ls_hide = ' '
   LET ls_show = ' '
   LET l_field = ' '
   FOR li_i = 1 TO l_xmia002    #欄位的顯示  
      LET l_msg = ''
      LET l_msg = g_xmib[li_i].b_date,'~',g_xmib[li_i].e_date
      LET lc_index = li_i USING '&&' 
      IF li_i = 1 THEN
         LET ls_show = ls_show || "l_xmii018_" || lc_index || ",l_xmii019_" || lc_index || ",l_xmii022_" || lc_index || ",l_xmii023_" || lc_index
                               || ",l_xmii018_4_" || lc_index || ",l_xmii019_4_" || lc_index || ",l_xmii018_5_" || lc_index || ",l_xmii019_5_" || lc_index
                               || ",l_xmii022_6_" || lc_index || ",l_xmii023_6_" || lc_index || ",l_xmii022_7_" || lc_index || ",l_xmii023_7_" || lc_index
                               || ",l_xmii018_3_" || lc_index || ",l_xmii019_3_" || lc_index || ",l_xmii022_3_" || lc_index || ",l_xmii023_3_" || lc_index
      ELSE
         LET ls_show = ls_show || ",l_xmii018_" || lc_index || ",l_xmii019_" || lc_index || ",l_xmii022_" || lc_index || ",l_xmii023_" || lc_index
                               || ",l_xmii018_4_" || lc_index || ",l_xmii019_4_" || lc_index || ",l_xmii018_5_" || lc_index || ",l_xmii019_5_" || lc_index
                               || ",l_xmii022_6_" || lc_index || ",l_xmii023_6_" || lc_index || ",l_xmii022_7_" || lc_index || ",l_xmii023_7_" || lc_index  
                               || ",l_xmii018_3_" || lc_index || ",l_xmii019_3_" || lc_index || ",l_xmii022_3_" || lc_index || ",l_xmii023_3_" || lc_index                                
      END IF      
   
#      LET l_field = 'l_xmii018_' CLIPPED,lc_index CLIPPED     
#      LET l_field = l_field.trim()
#      CALL cl_set_comp_att_text(l_field,l_msg)  
#      LET l_field = ''
#      LET l_field = 'l_xmii019_' CLIPPED,lc_index CLIPPED    
#      LET l_field = l_field.trim()
#      CALL cl_set_comp_att_text(l_field,l_msg)  
#      LET l_field = ''
#      LET l_field = 'l_xmii022_' CLIPPED,lc_index CLIPPED    
#      LET l_field = l_field.trim()
#      CALL cl_set_comp_att_text(l_field,l_msg) 
#      LET l_field = ''
#      LET l_field = 'l_xmii023_' CLIPPED,lc_index CLIPPED    
#      LET l_field = l_field.trim()
#      CALL cl_set_comp_att_text(l_field,l_msg) 
#      LET l_field = ''
#      LET l_field = 'l_xmii018_4_' CLIPPED,lc_index CLIPPED    
#      LET l_field = l_field.trim()
#      CALL cl_set_comp_att_text(l_field,l_msg) 
#      LET l_field = ''
#      LET l_field = 'l_xmii019_4_' CLIPPED,lc_index CLIPPED    
#      LET l_field = l_field.trim()
#      CALL cl_set_comp_att_text(l_field,l_msg) 
#      LET l_field = ''
#      LET l_field = 'l_xmii018_5_' CLIPPED,lc_index CLIPPED    
#      LET l_field = l_field.trim()
#      CALL cl_set_comp_att_text(l_field,l_msg) 
#      LET l_field = ''
#      LET l_field = 'l_xmii019_5_' CLIPPED,lc_index CLIPPED    
#      LET l_field = l_field.trim()
#      CALL cl_set_comp_att_text(l_field,l_msg) 
#      LET l_field = ''
#      LET l_field = 'l_xmii022_6_' CLIPPED,lc_index CLIPPED    
#      LET l_field = l_field.trim()
#      CALL cl_set_comp_att_text(l_field,l_msg) 
#      LET l_field = ''
#      LET l_field = 'l_xmii023_6_' CLIPPED,lc_index CLIPPED    
#      LET l_field = l_field.trim()
#      CALL cl_set_comp_att_text(l_field,l_msg)       
#      LET l_field = ''
#      LET l_field = 'l_xmii022_7_' CLIPPED,lc_index CLIPPED    
#      LET l_field = l_field.trim()
#      CALL cl_set_comp_att_text(l_field,l_msg) 
#      LET l_field = ''
#      LET l_field = 'l_xmii023_7_' CLIPPED,lc_index CLIPPED    
#      LET l_field = l_field.trim()
#      CALL cl_set_comp_att_text(l_field,l_msg)           
#      LET l_field = ''
#      LET l_field = 'l_xmii018_3_' CLIPPED,lc_index CLIPPED    
#      LET l_field = l_field.trim()
#      CALL cl_set_comp_att_text(l_field,l_msg) 
#      LET l_field = ''
#      LET l_field = 'l_xmii019_3_' CLIPPED,lc_index CLIPPED    
#      LET l_field = l_field.trim()
#      CALL cl_set_comp_att_text(l_field,l_msg) 
#      LET l_field = ''
#      LET l_field = 'l_xmii022_3_' CLIPPED,lc_index CLIPPED    
#      LET l_field = l_field.trim()
#      CALL cl_set_comp_att_text(l_field,l_msg) 
#      LET l_field = ''
#      LET l_field = 'l_xmii023_3_' CLIPPED,lc_index CLIPPED    
#      LET l_field = l_field.trim()
#      CALL cl_set_comp_att_text(l_field,l_msg)      
   END FOR
   CALL cl_set_comp_visible(ls_show,TRUE)  
   
   LET ls_hide = ' '   
   FOR li_j = li_i TO 24     #欄位的隱藏
      LET lc_index = li_j USING '&&' 
      IF li_j = li_i THEN      
         LET ls_hide = ls_hide || "l_xmii018_" || lc_index || ",l_xmii019_" || lc_index || ",l_xmii022_" || lc_index || ",l_xmii023_" || lc_index
                               || ",l_xmii018_4_" || lc_index || ",l_xmii019_4_" || lc_index || ",l_xmii018_5_" || lc_index || ",l_xmii019_5_" || lc_index
                               || ",l_xmii022_6_" || lc_index || ",l_xmii023_6_" || lc_index || ",l_xmii022_7_" || lc_index || ",l_xmii023_7_" || lc_index  
                               || ",l_xmii018_3_" || lc_index || ",l_xmii019_3_" || lc_index || ",l_xmii022_3_" || lc_index || ",l_xmii023_3_" || lc_index                               
      ELSE
         LET ls_hide = ls_hide || ",l_xmii018_" || lc_index || ",l_xmii019_" || lc_index || ",l_xmii022_" || lc_index || ",l_xmii023_" || lc_index
                               || ",l_xmii018_4_" || lc_index || ",l_xmii019_4_" || lc_index || ",l_xmii018_5_" || lc_index || ",l_xmii019_5_" || lc_index
                               || ",l_xmii022_6_" || lc_index || ",l_xmii023_6_" || lc_index || ",l_xmii022_7_" || lc_index || ",l_xmii023_7_" || lc_index     
                               || ",l_xmii018_3_" || lc_index || ",l_xmii019_3_" || lc_index || ",l_xmii022_3_" || lc_index || ",l_xmii023_3_" || lc_index                               
      END IF      
   END FOR  
   CALL cl_set_comp_visible(ls_hide,FALSE)
   LET l_xmij004 = ''
   LET l_xmij005 = ''
   LET l_xmij006 = ''
   LET l_xmij007 = ''
   LET l_xmij008 = ''
   LET l_xmij009 = ''
   LET l_xmij011 = ''   
   SELECT xmij004,xmij005,xmij006,xmij007,xmij008,xmij009,xmij011 INTO l_xmij004,l_xmij005,l_xmij006,l_xmij007,l_xmij008,l_xmij009,l_xmij011 FROM xmij_t
    WHERE xmijent = g_enterprise
      AND xmij001 = g_xmih_m.xmih004
    
   IF l_xmij004 = 'N' THEN
      CALL cl_set_comp_visible("xmii006,xmii006_desc,xmii006_2,xmii006_2_desc,xmii006_3,xmii006_3_desc",FALSE)
   ELSE
      CALL cl_set_comp_visible("xmii006,xmii006_desc,xmii006_2,xmii006_2_desc,xmii006_3,xmii006_3_desc",TRUE)
   END IF  
   
   IF l_xmij005 = 'N' THEN
      CALL cl_set_comp_visible("xmii007,xmii007_desc,xmii007_2,xmii007_2_desc,xmii007_3,xmii007_3_desc",FALSE)
   ELSE
      CALL cl_set_comp_visible("xmii007,xmii007_desc,xmii007_2,xmii007_2_desc,xmii007_3,xmii007_3_desc",TRUE)
   END IF     
   IF l_xmij006 = 'N' THEN
      CALL cl_set_comp_visible("xmii012,xmii012_desc,xmii012_2,xmii012_2_desc,xmii012_3,xmii012_3_desc",FALSE)
   ELSE
      CALL cl_set_comp_visible("xmii012,xmii012_desc,xmii012_2,xmii012_2_desc,xmii012_3,xmii012_3_desc",TRUE)
   END IF  
   IF l_xmij007 = 'N' THEN
      CALL cl_set_comp_visible("xmii013,xmii013_desc,xmii013_2,xmii013_2_desc,xmii013_3,xmii013_3_desc",FALSE)
   ELSE
      CALL cl_set_comp_visible("xmii013,xmii013_desc,xmii013_2,xmii013_2_desc,xmii013_3,xmii013_3_desc",TRUE)   
   END IF 
   IF l_xmij008 = 'N' THEN
      CALL cl_set_comp_visible("xmii008,xmii008_desc,xmii008_2,xmii008_2_desc,xmii008_3,xmii008_3_desc",FALSE)
   ELSE
      CALL cl_set_comp_visible("xmii008,xmii008_desc,xmii008_2,xmii008_2_desc,xmii008_3,xmii008_3_desc",TRUE)   
   END IF  
   IF l_xmij009 = 'N' THEN
      CALL cl_set_comp_visible("xmii011,xmii011_desc,xmii011_2,xmii011_2_desc,xmii011_3,xmii011_3_desc",FALSE)
   ELSE
      CALL cl_set_comp_visible("xmii011,xmii011_desc,xmii011_2,xmii011_2_desc,xmii011_3,xmii011_3_desc",TRUE)   
   END IF   
   IF l_xmij011 = 'N' THEN 
      CALL cl_set_comp_visible("xmii010,xmii010_2,xmii010_3,xmii010_3_desc",FALSE)
   ELSE
      CALL cl_set_comp_visible("xmii010,xmii010_2,xmii010_3,xmii010_3_desc",TRUE)
   END IF  
   CALL cl_set_comp_visible("xmii005_3",FALSE)   
   LET l_xmij004 = ''
   LET l_xmij005 = ''
   LET l_xmij006 = ''
   LET l_xmij007 = ''
   LET l_xmij008 = ''
   LET l_xmij009 = ''
   LET l_xmij011 = ''
   SELECT xmij004,xmij005,xmij006,xmij007,xmij008,xmij009,xmij011 INTO l_xmij004,l_xmij005,l_xmij006,l_xmij007,l_xmij008,l_xmij009,l_xmij011 FROM xmij_t
    WHERE xmijent = g_enterprise
      AND xmij001 = g_xmih_m.xmih005
   IF l_xmij004 = 'N' THEN
      CALL cl_set_comp_visible("xmii006_4,xmii006_4_desc,l_xmii006_6,l_xmii006_6_desc",FALSE)
   ELSE
      CALL cl_set_comp_visible("xmii006_4,xmii006_4_desc,l_xmii006_6,l_xmii006_6_desc",TRUE)
   END IF  
   
   IF l_xmij005 = 'N' THEN
      CALL cl_set_comp_visible("xmii007_4,xmii007_4_desc,xmii007_6,xmii007_6_desc,l_xmii005_6,l_xmii005_6_desc",FALSE)
   ELSE
      CALL cl_set_comp_visible("xmii007_4,xmii007_4_desc,xmii007_6,xmii007_6_desc,l_xmii005_6,l_xmii005_6_desc",TRUE)
   END IF     
   IF l_xmij006 = 'N' THEN
      CALL cl_set_comp_visible("xmii012_4,xmii012_4_desc,l_xmii012_6,l_xmii012_6_desc",FALSE)
   ELSE
      CALL cl_set_comp_visible("xmii012_4,xmii012_4_desc,l_xmii012_6,l_xmii012_6_desc",TRUE)
   END IF  
   IF l_xmij007 = 'N' THEN
      CALL cl_set_comp_visible("xmii013_4,xmii013_4_desc,l_xmii013_6,l_xmii013_6_desc",FALSE)
   ELSE
      CALL cl_set_comp_visible("xmii013_4,xmii013_4_desc,l_xmii013_6,l_xmii013_6_desc",TRUE)   
   END IF 
   IF l_xmij008 = 'N' THEN
      CALL cl_set_comp_visible("xmii008_4,xmii008_4_desc,l_xmii008_6,l_xmii008_6_desc",FALSE)
   ELSE
      CALL cl_set_comp_visible("xmii008_4,xmii008_4_desc,l_xmii008_6,l_xmii008_6_desc",TRUE)   
   END IF  
   IF l_xmij009 = 'N' THEN
      CALL cl_set_comp_visible("xmii011_4,xmii011_4_desc,l_xmii011_6,l_xmii011_6_desc",FALSE)
   ELSE
      CALL cl_set_comp_visible("xmii011_4,xmii011_4_desc,l_xmii011_6,l_xmii011_6_desc",TRUE)   
   END IF   
   IF l_xmij011 = 'N' THEN 
      CALL cl_set_comp_visible("xmii010_4,l_xmii010_6",FALSE)
   ELSE
      CALL cl_set_comp_visible("xmii010_4,l_xmii010_6",TRUE)
   END IF       
END FUNCTION]]>
  </point>
  <point name="function.axmt175_b_fill4" order="4" ver="1" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 下層調整金額
# Memo...........:
# Usage..........: CALL axmt175_b_fill4()
# Date & Author..: 日期 By lixh
# Modify.........:
################################################################################
PRIVATE FUNCTION axmt175_b_fill4()
DEFINE   l_xmii005   LIKE xmii_t.xmii005
DEFINE   g_xmii005   LIKE xmii_t.xmii005
DEFINE   l_xmii014   LIKE xmii_t.xmii014
DEFINE   l_xmii004   LIKE xmii_t.xmii004
DEFINE   l_xmia002   LIKE xmii_t.xmii002
DEFINE   i           LIKE type_t.num5
   CALL g_xmii7_d.clear()
   LET g_sql = "SELECT  UNIQUE xmii005,xmii007,'',xmii006,'',xmii008,'',xmii012,'',xmii013,'',xmii011,'', 
          xmii009,'','',xmii010,xmii017,'',xmii014,xmii022,xmii023,'','','','','','','','','','','','','','','', 
          '','','','','','','','','','','','','','','','','','','','','','','','','','','','','','', 
          '','','' FROM xmii_t",   
                  " INNER JOIN xmih_t ON xmih001 = xmii001 ",
                  " AND xmih002 = xmii002 ",
                  " AND xmih003 = xmii003 ",
                  " AND xmih004 = xmii004 ",
                  "",
                  " WHERE xmiient=? AND xmii001=? AND xmii002=? AND xmii003=? AND xmii004=? ",
                  "   AND xmii006=? AND xmii007=? AND xmii008=? AND xmii009=? AND xmii010=? ",
                  "   AND xmii011=? AND xmii012=? AND xmii013=? "
      IF NOT cl_null(g_wc2_table1) THEN
         LET g_sql = g_sql CLIPPED, " AND ", g_wc2_table1 CLIPPED
      END IF     
      LET g_sql = g_sql, " ORDER BY xmii_t.xmii005,xmii_t.xmii006,xmii_t.xmii007,xmii_t.xmii008,xmii_t.xmii009,xmii_t.xmii010,xmii_t.xmii011,xmii_t.xmii012,xmii_t.xmii013,xmii_t.xmii017,xmii_t.xmii014" 
      PREPARE axmt175_pb_7 FROM g_sql
      DECLARE b_fill_cs_7 CURSOR FOR axmt175_pb_7  
      SELECT xmii004 INTO l_xmii004 FROM xmii_t 
       WHERE xmiient = g_enterprise
         AND xmii001 = g_xmih_m.xmih001              
         AND xmii002 = g_xmih_m.xmih002
         AND xmii003 = g_xmih_m.xmih003          
         AND xmii005 = g_xmih_m.xmih004       
         AND xmii006 = g_xmii2_d[l_ac].xmii006        
         AND xmii007 = g_xmii2_d[l_ac].xmii007       
         AND xmii008 = g_xmii2_d[l_ac].xmii008       
         AND xmii009 = g_xmii2_d[l_ac].xmii009       
         AND xmii010 = g_xmii2_d[l_ac].xmii010  
         AND xmii011 = g_xmii2_d[l_ac].xmii011       
         AND xmii012 = g_xmii2_d[l_ac].xmii012       
      OPEN b_fill_cs_7 USING g_enterprise,g_xmih_m.xmih001
                                               ,g_xmih_m.xmih002
                                               ,g_xmih_m.xmih003
                                               ,l_xmii004 
                                               ,g_xmii2_d[l_ac].xmii006      
                                               ,g_xmii2_d[l_ac].xmii007    
                                               ,g_xmii2_d[l_ac].xmii008    
                                               ,g_xmii2_d[l_ac].xmii009    
                                               ,g_xmii2_d[l_ac].xmii010    
                                               ,g_xmii2_d[l_ac].xmii011    
                                               ,g_xmii2_d[l_ac].xmii012  
                                               ,g_xmii2_d[l_ac].xmii013 
     LET l_ac = 1
     LET l_xmii005 = NULL     
     FOREACH b_fill_cs_5 INTO g_xmii005,g_xmii7_d[l_ac].l_xmii007_7,g_xmii7_d[l_ac].l_xmii007_7_desc,g_xmii7_d[l_ac].l_xmii006_7,g_xmii7_d[l_ac].l_xmii006_7_desc,
                              g_xmii7_d[l_ac].l_xmii008_7,g_xmii7_d[l_ac].l_xmii008_7_desc,g_xmii7_d[l_ac].l_xmii012_7,g_xmii7_d[l_ac].l_xmii012_7_desc,
                              g_xmii7_d[l_ac].l_xmii013_7,g_xmii7_d[l_ac].l_xmii013_7_desc,g_xmii7_d[l_ac].l_xmii011_7,g_xmii7_d[l_ac].l_xmii011_7_desc,g_xmii7_d[l_ac].l_xmii009_7,
                              g_xmii7_d[l_ac].l_xmii009_7_desc,g_xmii7_d[l_ac].l_xmii009_7_desc_1,g_xmii7_d[l_ac].l_xmii010_7,g_xmii7_d[l_ac].l_xmii017_7,
                              g_xmii7_d[l_ac].l_xmii017_7_desc,g_xmii7_d[l_ac].l_xmii014_7,g_xmii7_d[l_ac].l_xmii022_7_01,g_xmii7_d[l_ac].l_xmii023_7_01,g_xmii7_d[l_ac].l_xmii022_7_02,g_xmii7_d[l_ac].l_xmii023_7_02,
                              g_xmii7_d[l_ac].l_xmii022_7_03,g_xmii7_d[l_ac].l_xmii023_7_03,g_xmii7_d[l_ac].l_xmii022_7_04,g_xmii7_d[l_ac].l_xmii023_7_04,g_xmii7_d[l_ac].l_xmii022_7_05,g_xmii7_d[l_ac].l_xmii023_7_05,
                              g_xmii7_d[l_ac].l_xmii022_7_06,g_xmii7_d[l_ac].l_xmii023_7_06,g_xmii7_d[l_ac].l_xmii022_7_07,g_xmii7_d[l_ac].l_xmii023_7_07,g_xmii7_d[l_ac].l_xmii022_7_08,g_xmii7_d[l_ac].l_xmii023_7_08, 
                              g_xmii7_d[l_ac].l_xmii022_7_09,g_xmii7_d[l_ac].l_xmii023_7_09,g_xmii7_d[l_ac].l_xmii022_7_10,g_xmii7_d[l_ac].l_xmii023_7_10,g_xmii7_d[l_ac].l_xmii022_7_11,g_xmii7_d[l_ac].l_xmii023_7_11,
                              g_xmii7_d[l_ac].l_xmii022_7_12,g_xmii7_d[l_ac].l_xmii023_7_12,g_xmii7_d[l_ac].l_xmii022_7_13,g_xmii7_d[l_ac].l_xmii023_7_13,g_xmii7_d[l_ac].l_xmii022_7_14,g_xmii7_d[l_ac].l_xmii023_7_14,     
                              g_xmii7_d[l_ac].l_xmii022_7_15,g_xmii7_d[l_ac].l_xmii023_7_15,g_xmii7_d[l_ac].l_xmii022_7_16,g_xmii7_d[l_ac].l_xmii023_7_16,g_xmii7_d[l_ac].l_xmii022_7_17,g_xmii7_d[l_ac].l_xmii023_7_17,
                              g_xmii7_d[l_ac].l_xmii022_7_18,g_xmii7_d[l_ac].l_xmii023_7_18,g_xmii7_d[l_ac].l_xmii022_7_19,g_xmii7_d[l_ac].l_xmii023_7_19,g_xmii7_d[l_ac].l_xmii022_7_20,g_xmii7_d[l_ac].l_xmii023_7_20, 
                              g_xmii7_d[l_ac].l_xmii022_7_21,g_xmii7_d[l_ac].l_xmii023_7_21,g_xmii7_d[l_ac].l_xmii022_7_22,g_xmii7_d[l_ac].l_xmii023_7_22,g_xmii7_d[l_ac].l_xmii022_7_23,g_xmii7_d[l_ac].l_xmii023_7_23,
                              g_xmii7_d[l_ac].l_xmii022_7_24,g_xmii7_d[l_ac].l_xmii023_7_24,g_xmii7_d[l_ac].l_xmii022_7_s,g_xmii7_d[l_ac].l_xmii023_7_s         

         IF SQLCA.sqlcode THEN
            CALL cl_err("FOREACH:",SQLCA.sqlcode,1)
            EXIT FOREACH
         END IF
         IF l_ac = 1 THEN
            LET l_xmii005 = g_xmii005
            LET g_xmii7_d[l_ac].l_xmii022_7_s = g_xmii7_d[l_ac].l_xmii022_7_01
            LET g_xmii7_d[l_ac].l_xmii023_7_s = g_xmii7_d[l_ac].l_xmii023_7_01 
         END IF
         LET l_xmii014 = g_xmii7_d[l_ac].l_xmii014_7 
         IF g_xmii005 <> l_xmii005 THEN
            LET l_xmii005 = g_xmii005      
            LET g_xmii7_d[l_ac].l_xmii022_7_s = g_xmii7_d[l_ac].l_xmii022_7_01
            LET g_xmii7_d[l_ac].l_xmii023_7_s = g_xmii7_d[l_ac].l_xmii023_7_01             
         ELSE
            IF l_ac > 1 THEN
               LET l_ac = l_ac - 1
            END IF
            IF l_xmii014 > 1 THEN
               CALL axmt175_b_desc_7(l_xmii014,l_ac)
            END IF              
         END IF
         CALL axmt175_xmii006_desc(g_xmii7_d[l_ac].l_xmii007_7) RETURNING g_xmii7_d[l_ac].l_xmii007_7_desc
         CALL axmt175_xmii006_desc(g_xmii7_d[l_ac].l_xmii006_7) RETURNING g_xmii7_d[l_ac].l_xmii006_7_desc
         CALL axmt175_xmii008_desc(g_xmii7_d[l_ac].l_xmii008_7) RETURNING g_xmii7_d[l_ac].l_xmii008_7_desc
         CALL axmt175_xmii011_desc(g_xmii7_d[l_ac].l_xmii011_7) RETURNING g_xmii7_d[l_ac].l_xmii011_7_desc         
         CALL axmt175_xmii012_desc(g_xmii7_d[l_ac].l_xmii012_7) RETURNING g_xmii7_d[l_ac].l_xmii012_7_desc
         CALL axmt175_xmii013_desc(g_xmii7_d[l_ac].l_xmii013_7) RETURNING g_xmii7_d[l_ac].l_xmii013_7_desc
         CALL axmt175_xmii009_desc(g_xmii7_d[l_ac].l_xmii009_7) RETURNING g_xmii7_d[l_ac].l_xmii009_7_desc,g_xmii7_d[l_ac].l_xmii009_7_desc_1
         CALL axmt175_xmii017_desc(g_xmii7_d[l_ac].l_xmii017_7) RETURNING g_xmii7_d[l_ac].l_xmii017_7_desc         
         LET l_ac = l_ac + 1
         IF l_ac > g_max_rec AND g_error_show = 1 THEN
            CALL cl_err( '', 9035, 1)
            EXIT FOREACH
         END IF
     END FOREACH
   IF l_ac > 1 THEN
      INITIALIZE g_xmii7_d[l_ac].* TO NULL   
      CALL cl_getmsg('axc-00204',g_lang) RETURNING g_xmii7_d[l_ac].l_xmii009_7
      SELECT xmia002 INTO l_xmia002 FROM xmia_t
       WHERE xmiaent = g_enterprise
         AND xmia001 = g_xmih_m.xmih001
      FOR i = 1 TO l_xmia002
          CALL axmt175_sum_xmii_7(i,l_xmii004)
      END FOR
      SELECT SUM(xmii022),SUM(xmii023)
        INTO g_xmii7_d[l_ac].l_xmii022_7_s,g_xmii7_d[l_ac].l_xmii023_7_s
        FROM xmii_t
       WHERE xmiient = g_enterprise
         AND xmii001 = g_xmih_m.xmih001
         AND xmii002 = g_xmih_m.xmih002
         AND xmii003 = g_xmih_m.xmih003
         AND xmii004 = l_xmii004
         AND xmii006 = g_xmii_d[l_ac].xmii006
         AND xmii007 = g_xmii_d[l_ac].xmii007
         AND xmii008 = g_xmii_d[l_ac].xmii008
         AND xmii009 = g_xmii_d[l_ac].xmii009
         AND xmii010 = g_xmii_d[l_ac].xmii010
         AND xmii011 = g_xmii_d[l_ac].xmii011
         AND xmii012 = g_xmii_d[l_ac].xmii012
         AND xmii013 = g_xmii_d[l_ac].xmii013     
   ELSE
      CALL g_xmii7_d.deleteElement(g_xmii7_d.getLength())
   END IF      
#     CALL g_xmii7_d.deleteElement(g_xmii7_d.getLength())       
     LET g_error_show = 0
END FUNCTION]]>
  </point>
  <point name="function.axmt175_b_desc_5" order="5" ver="1" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 不同期別的資料顯示在一筆單身資料中
# Memo...........:
# Usage..........: CALL axmt175_b_desc_5(p_xmii014,p_ac)
#                  RETURNING 回传参数
# Input parameter: p_xmii014      期別
#                : p_ac           行標
# Date & Author..: 日期 By lixh
# Modify.........:
################################################################################
PRIVATE FUNCTION axmt175_b_desc_5(p_xmii014,p_ac)
DEFINE   p_xmii014    LIKE xmii_t.xmii014
DEFINE   p_ac         LIKE type_t.num5
   IF p_xmii014 = 2 THEN
      LET g_xmii5_d[p_ac].l_xmii018_5_02 = g_xmii5_d[p_ac+1].l_xmii018_5_01
      LET g_xmii5_d[p_ac].l_xmii019_5_02 = g_xmii5_d[p_ac+1].l_xmii019_5_01
      LET g_xmii5_d[p_ac].l_xmii018_5_s = g_xmii5_d[p_ac].l_xmii018_5_s + g_xmii5_d[p_ac].l_xmii018_5_02
      LET g_xmii5_d[p_ac].l_xmii019_5_s = g_xmii5_d[p_ac].l_xmii019_5_s + g_xmii5_d[p_ac].l_xmii019_5_02
   END IF
   IF p_xmii014 = 3 THEN
      LET g_xmii5_d[p_ac].l_xmii018_5_03 = g_xmii5_d[p_ac+1].l_xmii018_5_01
      LET g_xmii5_d[p_ac].l_xmii019_5_03 = g_xmii5_d[p_ac+1].l_xmii019_5_01
      LET g_xmii5_d[p_ac].l_xmii018_5_s = g_xmii5_d[p_ac].l_xmii018_5_s + g_xmii5_d[p_ac].l_xmii018_5_03
      LET g_xmii5_d[p_ac].l_xmii019_5_s = g_xmii5_d[p_ac].l_xmii019_5_s + g_xmii5_d[p_ac].l_xmii019_5_03   
   END IF
   IF p_xmii014 = 4 THEN
      LET g_xmii5_d[p_ac].l_xmii018_5_04 = g_xmii5_d[p_ac+1].l_xmii018_5_01
      LET g_xmii5_d[p_ac].l_xmii019_5_04 = g_xmii5_d[p_ac+1].l_xmii019_5_01
      LET g_xmii5_d[p_ac].l_xmii018_5_s = g_xmii5_d[p_ac].l_xmii018_5_s + g_xmii5_d[p_ac].l_xmii018_5_04
      LET g_xmii5_d[p_ac].l_xmii019_5_s = g_xmii5_d[p_ac].l_xmii019_5_s + g_xmii5_d[p_ac].l_xmii019_5_04   
   END IF
   IF p_xmii014 = 5 THEN
      LET g_xmii5_d[p_ac].l_xmii018_5_05 = g_xmii5_d[p_ac+1].l_xmii018_5_01
      LET g_xmii5_d[p_ac].l_xmii019_5_05 = g_xmii5_d[p_ac+1].l_xmii019_5_01
      LET g_xmii5_d[p_ac].l_xmii018_5_s = g_xmii5_d[p_ac].l_xmii018_5_s + g_xmii5_d[p_ac].l_xmii018_5_05
      LET g_xmii5_d[p_ac].l_xmii019_5_s = g_xmii5_d[p_ac].l_xmii019_5_s + g_xmii5_d[p_ac].l_xmii019_5_05   
   END IF
   IF p_xmii014 = 6 THEN
      LET g_xmii5_d[p_ac].l_xmii018_5_06 = g_xmii5_d[p_ac+1].l_xmii018_5_01
      LET g_xmii5_d[p_ac].l_xmii019_5_06 = g_xmii5_d[p_ac+1].l_xmii019_5_01
      LET g_xmii5_d[p_ac].l_xmii018_5_s = g_xmii5_d[p_ac].l_xmii018_5_s + g_xmii5_d[p_ac].l_xmii018_5_06
      LET g_xmii5_d[p_ac].l_xmii019_5_s = g_xmii5_d[p_ac].l_xmii019_5_s + g_xmii5_d[p_ac].l_xmii019_5_06   
   END IF
   IF p_xmii014 = 7 THEN
      LET g_xmii5_d[p_ac].l_xmii018_5_07 = g_xmii5_d[p_ac+1].l_xmii018_5_01
      LET g_xmii5_d[p_ac].l_xmii019_5_07 = g_xmii5_d[p_ac+1].l_xmii019_5_01
      LET g_xmii5_d[p_ac].l_xmii018_5_s = g_xmii5_d[p_ac].l_xmii018_5_s + g_xmii5_d[p_ac].l_xmii018_5_07
      LET g_xmii5_d[p_ac].l_xmii019_5_s = g_xmii5_d[p_ac].l_xmii019_5_s + g_xmii5_d[p_ac].l_xmii019_5_07   
   END IF
   IF p_xmii014 = 8 THEN
      LET g_xmii5_d[p_ac].l_xmii018_5_08 = g_xmii5_d[p_ac+1].l_xmii018_5_01
      LET g_xmii5_d[p_ac].l_xmii019_5_08 = g_xmii5_d[p_ac+1].l_xmii019_5_01
      LET g_xmii5_d[p_ac].l_xmii018_5_s = g_xmii5_d[p_ac].l_xmii018_5_s + g_xmii5_d[p_ac].l_xmii018_5_08
      LET g_xmii5_d[p_ac].l_xmii019_5_s = g_xmii5_d[p_ac].l_xmii019_5_s + g_xmii5_d[p_ac].l_xmii019_5_08   
   END IF
   IF p_xmii014 = 9 THEN
      LET g_xmii5_d[p_ac].l_xmii018_5_09 = g_xmii5_d[p_ac+1].l_xmii018_5_01
      LET g_xmii5_d[p_ac].l_xmii019_5_09 = g_xmii5_d[p_ac+1].l_xmii019_5_01
      LET g_xmii5_d[p_ac].l_xmii018_5_s = g_xmii5_d[p_ac].l_xmii018_5_s + g_xmii5_d[p_ac].l_xmii018_5_09
      LET g_xmii5_d[p_ac].l_xmii019_5_s = g_xmii5_d[p_ac].l_xmii019_5_s + g_xmii5_d[p_ac].l_xmii019_5_09   
   END IF
   IF p_xmii014 = 10 THEN
      LET g_xmii5_d[p_ac].l_xmii018_5_10 = g_xmii5_d[p_ac+1].l_xmii018_5_01
      LET g_xmii5_d[p_ac].l_xmii019_5_10 = g_xmii5_d[p_ac+1].l_xmii019_5_01
      LET g_xmii5_d[p_ac].l_xmii018_5_s = g_xmii5_d[p_ac].l_xmii018_5_s + g_xmii5_d[p_ac].l_xmii018_5_10
      LET g_xmii5_d[p_ac].l_xmii019_5_s = g_xmii5_d[p_ac].l_xmii019_5_s + g_xmii5_d[p_ac].l_xmii019_5_10   
   END IF
   IF p_xmii014 = 11 THEN
      LET g_xmii5_d[p_ac].l_xmii018_5_11 = g_xmii5_d[p_ac+1].l_xmii018_5_01
      LET g_xmii5_d[p_ac].l_xmii019_5_11 = g_xmii5_d[p_ac+1].l_xmii019_5_01
      LET g_xmii5_d[p_ac].l_xmii018_5_s = g_xmii5_d[p_ac].l_xmii018_5_s + g_xmii5_d[p_ac].l_xmii018_5_11
      LET g_xmii5_d[p_ac].l_xmii019_5_s = g_xmii5_d[p_ac].l_xmii019_5_s + g_xmii5_d[p_ac].l_xmii019_5_11   
   END IF
   IF p_xmii014 = 12 THEN
      LET g_xmii5_d[p_ac].l_xmii018_5_12 = g_xmii5_d[p_ac+1].l_xmii018_5_01
      LET g_xmii5_d[p_ac].l_xmii019_5_12 = g_xmii5_d[p_ac+1].l_xmii019_5_01
      LET g_xmii5_d[p_ac].l_xmii018_5_s = g_xmii5_d[p_ac].l_xmii018_5_s + g_xmii5_d[p_ac].l_xmii018_5_12
      LET g_xmii5_d[p_ac].l_xmii019_5_s = g_xmii5_d[p_ac].l_xmii019_5_s + g_xmii5_d[p_ac].l_xmii019_5_12   
   END IF
   IF p_xmii014 = 13 THEN
      LET g_xmii5_d[p_ac].l_xmii018_5_13 = g_xmii5_d[p_ac+1].l_xmii018_5_01
      LET g_xmii5_d[p_ac].l_xmii019_5_13 = g_xmii5_d[p_ac+1].l_xmii019_5_01
      LET g_xmii5_d[p_ac].l_xmii018_5_s = g_xmii5_d[p_ac].l_xmii018_5_s + g_xmii5_d[p_ac].l_xmii018_5_13
      LET g_xmii5_d[p_ac].l_xmii019_5_s = g_xmii5_d[p_ac].l_xmii019_5_s + g_xmii5_d[p_ac].l_xmii019_5_13   
   END IF
   IF p_xmii014 = 14 THEN
      LET g_xmii5_d[p_ac].l_xmii018_5_14 = g_xmii5_d[p_ac+1].l_xmii018_5_01
      LET g_xmii5_d[p_ac].l_xmii019_5_14 = g_xmii5_d[p_ac+1].l_xmii019_5_01
      LET g_xmii5_d[p_ac].l_xmii018_5_s = g_xmii5_d[p_ac].l_xmii018_5_s + g_xmii5_d[p_ac].l_xmii018_5_14
      LET g_xmii5_d[p_ac].l_xmii019_5_s = g_xmii5_d[p_ac].l_xmii019_5_s + g_xmii5_d[p_ac].l_xmii019_5_14   
   END IF
   IF p_xmii014 = 15 THEN
      LET g_xmii5_d[p_ac].l_xmii018_5_15 = g_xmii5_d[p_ac+1].l_xmii018_5_01
      LET g_xmii5_d[p_ac].l_xmii019_5_15 = g_xmii5_d[p_ac+1].l_xmii019_5_01
      LET g_xmii5_d[p_ac].l_xmii018_5_s = g_xmii5_d[p_ac].l_xmii018_5_s + g_xmii5_d[p_ac].l_xmii018_5_15
      LET g_xmii5_d[p_ac].l_xmii019_5_s = g_xmii5_d[p_ac].l_xmii019_5_s + g_xmii5_d[p_ac].l_xmii019_5_15   
   END IF
   IF p_xmii014 = 16 THEN
      LET g_xmii5_d[p_ac].l_xmii018_5_16 = g_xmii5_d[p_ac+1].l_xmii018_5_01
      LET g_xmii5_d[p_ac].l_xmii019_5_16 = g_xmii5_d[p_ac+1].l_xmii019_5_01
      LET g_xmii5_d[p_ac].l_xmii018_5_s = g_xmii5_d[p_ac].l_xmii018_5_s + g_xmii5_d[p_ac].l_xmii018_5_16
      LET g_xmii5_d[p_ac].l_xmii019_5_s = g_xmii5_d[p_ac].l_xmii019_5_s + g_xmii5_d[p_ac].l_xmii019_5_16   
   END IF
   IF p_xmii014 = 17 THEN
      LET g_xmii5_d[p_ac].l_xmii018_5_17 = g_xmii5_d[p_ac+1].l_xmii018_5_01
      LET g_xmii5_d[p_ac].l_xmii019_5_17 = g_xmii5_d[p_ac+1].l_xmii019_5_01
      LET g_xmii5_d[p_ac].l_xmii018_5_s = g_xmii5_d[p_ac].l_xmii018_5_s + g_xmii5_d[p_ac].l_xmii018_5_17
      LET g_xmii5_d[p_ac].l_xmii019_5_s = g_xmii5_d[p_ac].l_xmii019_5_s + g_xmii5_d[p_ac].l_xmii019_5_17   
   END IF
   IF p_xmii014 = 18 THEN
      LET g_xmii5_d[p_ac].l_xmii018_5_18 = g_xmii5_d[p_ac+1].l_xmii018_5_01
      LET g_xmii5_d[p_ac].l_xmii019_5_18 = g_xmii5_d[p_ac+1].l_xmii019_5_01
      LET g_xmii5_d[p_ac].l_xmii018_5_s = g_xmii5_d[p_ac].l_xmii018_5_s + g_xmii5_d[p_ac].l_xmii018_5_18
      LET g_xmii5_d[p_ac].l_xmii019_5_s = g_xmii5_d[p_ac].l_xmii019_5_s + g_xmii5_d[p_ac].l_xmii019_5_18   
   END IF
   IF p_xmii014 = 19 THEN
      LET g_xmii5_d[p_ac].l_xmii018_5_19 = g_xmii5_d[p_ac+1].l_xmii018_5_01
      LET g_xmii5_d[p_ac].l_xmii019_5_19 = g_xmii5_d[p_ac+1].l_xmii019_5_01
      LET g_xmii5_d[p_ac].l_xmii018_5_s = g_xmii5_d[p_ac].l_xmii018_5_s + g_xmii5_d[p_ac].l_xmii018_5_19
      LET g_xmii5_d[p_ac].l_xmii019_5_s = g_xmii5_d[p_ac].l_xmii019_5_s + g_xmii5_d[p_ac].l_xmii019_5_19   
   END IF
   IF p_xmii014 = 20 THEN
      LET g_xmii5_d[p_ac].l_xmii018_5_20 = g_xmii5_d[p_ac+1].l_xmii018_5_01
      LET g_xmii5_d[p_ac].l_xmii019_5_20 = g_xmii5_d[p_ac+1].l_xmii019_5_01
      LET g_xmii5_d[p_ac].l_xmii018_5_s = g_xmii5_d[p_ac].l_xmii018_5_s + g_xmii5_d[p_ac].l_xmii018_5_20
      LET g_xmii5_d[p_ac].l_xmii019_5_s = g_xmii5_d[p_ac].l_xmii019_5_s + g_xmii5_d[p_ac].l_xmii019_5_20   
   END IF
   IF p_xmii014 = 21 THEN
      LET g_xmii5_d[p_ac].l_xmii018_5_21 = g_xmii5_d[p_ac+1].l_xmii018_5_01
      LET g_xmii5_d[p_ac].l_xmii019_5_21 = g_xmii5_d[p_ac+1].l_xmii019_5_01
      LET g_xmii5_d[p_ac].l_xmii018_5_s = g_xmii5_d[p_ac].l_xmii018_5_s + g_xmii5_d[p_ac].l_xmii018_5_21
      LET g_xmii5_d[p_ac].l_xmii019_5_s = g_xmii5_d[p_ac].l_xmii019_5_s + g_xmii5_d[p_ac].l_xmii019_5_21   
   END IF
   IF p_xmii014 = 22 THEN
      LET g_xmii5_d[p_ac].l_xmii018_5_22 = g_xmii5_d[p_ac+1].l_xmii018_5_01
      LET g_xmii5_d[p_ac].l_xmii019_5_22 = g_xmii5_d[p_ac+1].l_xmii019_5_01
      LET g_xmii5_d[p_ac].l_xmii018_5_s = g_xmii5_d[p_ac].l_xmii018_5_s + g_xmii5_d[p_ac].l_xmii018_5_22
      LET g_xmii5_d[p_ac].l_xmii019_5_s = g_xmii5_d[p_ac].l_xmii019_5_s + g_xmii5_d[p_ac].l_xmii019_5_22   
   END IF 
   IF p_xmii014 = 23 THEN
      LET g_xmii5_d[p_ac].l_xmii018_5_23 = g_xmii5_d[p_ac+1].l_xmii018_5_01
      LET g_xmii5_d[p_ac].l_xmii019_5_23 = g_xmii5_d[p_ac+1].l_xmii019_5_01
      LET g_xmii5_d[p_ac].l_xmii018_5_s = g_xmii5_d[p_ac].l_xmii018_5_s + g_xmii5_d[p_ac].l_xmii018_5_23
      LET g_xmii5_d[p_ac].l_xmii019_5_s = g_xmii5_d[p_ac].l_xmii019_5_s + g_xmii5_d[p_ac].l_xmii019_5_23   
   END IF   
   IF p_xmii014 = 24 THEN
      LET g_xmii5_d[p_ac].l_xmii018_5_24 = g_xmii5_d[p_ac+1].l_xmii018_5_01
      LET g_xmii5_d[p_ac].l_xmii019_5_24 = g_xmii5_d[p_ac+1].l_xmii019_5_01
      LET g_xmii5_d[p_ac].l_xmii018_5_s = g_xmii5_d[p_ac].l_xmii018_5_s + g_xmii5_d[p_ac].l_xmii018_5_24
      LET g_xmii5_d[p_ac].l_xmii019_5_s = g_xmii5_d[p_ac].l_xmii019_5_s + g_xmii5_d[p_ac].l_xmii019_5_24   
   END IF         
END FUNCTION]]>
  </point>
  <point name="function.axmt175_upd_xmii019" order="6" ver="1" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[################################################################################
# Descriptions...: 修改調整數量
# Memo...........:
# Usage..........: CALL axmt175_upd_xmii019(p_xmii019,p_xmii014)
#                  RETURNING TRUE/FALSE
# Input parameter: p_xmii019      數量
#                : p_xmii014      期別
# Return code....: TRUE/FALSE    
# Date & Author..: 日期 By 作者
# Modify.........:
################################################################################
PRIVATE FUNCTION axmt175_upd_xmii019(p_xmii019,p_xmii014)
DEFINE  p_xmii019     LIKE xmii_t.xmii019
DEFINE  p_xmii014     LIKE xmii_t.xmii014
   UPDATE xmii_t SET xmii019 = p_xmii019
    WHERE xmiient = g_enterprise
      AND xmii001 = g_xmih_m.xmih001
      AND xmii002 = g_xmih_m.xmih002
      AND xmii003 = g_xmih_m.xmih003
      AND xmii004 = g_xmih_m.xmih004
      AND xmii005 = g_xmii_d_t.xmii005  
      AND xmii006 = g_xmii_d_t.xmii006
      AND xmii007 = g_xmii_d_t.xmii007
      AND xmii008 = g_xmii_d_t.xmii008
      AND xmii009 = g_xmii_d_t.xmii009
      AND xmii010 = g_xmii_d_t.xmii010
      AND xmii011 = g_xmii_d_t.xmii011
      AND xmii012 = g_xmii_d_t.xmii012
      AND xmii013 = g_xmii_d_t.xmii013
      AND xmii014 = p_xmii014
      AND xmii017 = g_xmii_d_t.xmii017      
   IF SQLCA.sqlcode THEN 
      CALL cl_err("xmii_t",SQLCA.sqlcode,1)
      RETURN FALSE
   END IF      
   RETURN TRUE      
END FUNCTION]]>
  </point>
  <point name="function.axmt175_b_desc_4" order="7" ver="1" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 不同期別的資料顯示在一筆單身資料中
# Memo...........:
# Usage..........: CALL axmt175_b_desc_4(p_xmii014,p_ac)
#                  RETURNING 回传参数
# Input parameter: p_xmii014      期別
#                : p_ac           行標
# Date & Author..: 日期 By lixh
# Modify.........:#####################################################
PRIVATE FUNCTION axmt175_b_desc_4(p_xmii014,p_ac)
DEFINE p_xmii014        LIKE xmii_t.xmii014
DEFINE p_ac             LIKE type_t.num5
   IF p_xmii014 = 2 THEN
      LET g_xmii4_d[p_ac].l_xmii018_4_02 = g_xmii4_d[p_ac+1].l_xmii018_4_01
      LET g_xmii4_d[p_ac].l_xmii019_4_02 = g_xmii4_d[p_ac+1].l_xmii019_4_01
      LET g_xmii4_d[p_ac].l_xmii018_4_s = g_xmii4_d[p_ac].l_xmii018_4_s + g_xmii4_d[p_ac].l_xmii018_4_02
      LET g_xmii4_d[p_ac].l_xmii019_4_s = g_xmii4_d[p_ac].l_xmii019_4_s + g_xmii4_d[p_ac].l_xmii019_4_02

      LET g_xmii6_d[p_ac].l_xmii022_6_02 = g_xmii6_d[p_ac+1].l_xmii022_6_01
      LET g_xmii6_d[p_ac].l_xmii023_6_02 = g_xmii6_d[p_ac+1].l_xmii023_6_01
      LET g_xmii6_d[p_ac].l_xmii022_6_s = g_xmii6_d[p_ac].l_xmii022_6_s + g_xmii6_d[p_ac].l_xmii022_6_02
      LET g_xmii6_d[p_ac].l_xmii023_6_s = g_xmii6_d[p_ac].l_xmii023_6_s + g_xmii6_d[p_ac].l_xmii023_6_02
   END IF
   IF p_xmii014 = 3 THEN
      LET g_xmii4_d[p_ac].l_xmii018_4_03 = g_xmii4_d[p_ac+1].l_xmii018_4_01
      LET g_xmii4_d[p_ac].l_xmii019_4_03 = g_xmii4_d[p_ac+1].l_xmii019_4_01
      LET g_xmii4_d[p_ac].l_xmii018_4_s = g_xmii4_d[p_ac].l_xmii018_4_s + g_xmii4_d[p_ac].l_xmii018_4_03
      LET g_xmii4_d[p_ac].l_xmii019_4_s = g_xmii4_d[p_ac].l_xmii019_4_s + g_xmii4_d[p_ac].l_xmii019_4_03

      LET g_xmii6_d[p_ac].l_xmii022_6_03 = g_xmii6_d[p_ac+1].l_xmii022_6_01
      LET g_xmii6_d[p_ac].l_xmii023_6_03 = g_xmii6_d[p_ac+1].l_xmii023_6_01
      LET g_xmii6_d[p_ac].l_xmii022_6_s = g_xmii6_d[p_ac].l_xmii022_6_s + g_xmii6_d[p_ac].l_xmii022_6_03
      LET g_xmii6_d[p_ac].l_xmii023_6_s = g_xmii6_d[p_ac].l_xmii023_6_s + g_xmii6_d[p_ac].l_xmii023_6_03
   END IF   
   IF p_xmii014 = 4 THEN
      LET g_xmii4_d[p_ac].l_xmii018_4_04 = g_xmii4_d[p_ac+1].l_xmii018_4_01
      LET g_xmii4_d[p_ac].l_xmii019_4_04 = g_xmii4_d[p_ac+1].l_xmii019_4_01
      LET g_xmii4_d[p_ac].l_xmii018_4_s = g_xmii4_d[p_ac].l_xmii018_4_s + g_xmii4_d[p_ac].l_xmii018_4_04
      LET g_xmii4_d[p_ac].l_xmii019_4_s = g_xmii4_d[p_ac].l_xmii019_4_s + g_xmii4_d[p_ac].l_xmii019_4_04

      LET g_xmii6_d[p_ac].l_xmii022_6_04 = g_xmii6_d[p_ac+1].l_xmii022_6_01
      LET g_xmii6_d[p_ac].l_xmii023_6_04 = g_xmii6_d[p_ac+1].l_xmii023_6_01
      LET g_xmii6_d[p_ac].l_xmii022_6_s = g_xmii6_d[p_ac].l_xmii022_6_s + g_xmii6_d[p_ac].l_xmii022_6_04
      LET g_xmii6_d[p_ac].l_xmii023_6_s = g_xmii6_d[p_ac].l_xmii023_6_s + g_xmii6_d[p_ac].l_xmii023_6_04
   END IF
   IF p_xmii014 = 5 THEN
      LET g_xmii4_d[p_ac].l_xmii018_4_05 = g_xmii4_d[p_ac+1].l_xmii018_4_01
      LET g_xmii4_d[p_ac].l_xmii019_4_05 = g_xmii4_d[p_ac+1].l_xmii019_4_01
      LET g_xmii4_d[p_ac].l_xmii018_4_s = g_xmii4_d[p_ac].l_xmii018_4_s + g_xmii4_d[p_ac].l_xmii018_4_05
      LET g_xmii4_d[p_ac].l_xmii019_4_s = g_xmii4_d[p_ac].l_xmii019_4_s + g_xmii4_d[p_ac].l_xmii019_4_05

      LET g_xmii6_d[p_ac].l_xmii022_6_05 = g_xmii6_d[p_ac+1].l_xmii022_6_01
      LET g_xmii6_d[p_ac].l_xmii023_6_05 = g_xmii6_d[p_ac+1].l_xmii023_6_01
      LET g_xmii6_d[p_ac].l_xmii022_6_s = g_xmii6_d[p_ac].l_xmii022_6_s + g_xmii6_d[p_ac].l_xmii022_6_05
      LET g_xmii6_d[p_ac].l_xmii023_6_s = g_xmii6_d[p_ac].l_xmii023_6_s + g_xmii6_d[p_ac].l_xmii023_6_05
   END IF   
   IF p_xmii014 = 6 THEN
      LET g_xmii4_d[p_ac].l_xmii018_4_06 = g_xmii4_d[p_ac+1].l_xmii018_4_01
      LET g_xmii4_d[p_ac].l_xmii019_4_06 = g_xmii4_d[p_ac+1].l_xmii019_4_01
      LET g_xmii4_d[p_ac].l_xmii018_4_s = g_xmii4_d[p_ac].l_xmii018_4_s + g_xmii4_d[p_ac].l_xmii018_4_06
      LET g_xmii4_d[p_ac].l_xmii019_4_s = g_xmii4_d[p_ac].l_xmii019_4_s + g_xmii4_d[p_ac].l_xmii019_4_06

      LET g_xmii6_d[p_ac].l_xmii022_6_06 = g_xmii6_d[p_ac+1].l_xmii022_6_01
      LET g_xmii6_d[p_ac].l_xmii023_6_06 = g_xmii6_d[p_ac+1].l_xmii023_6_01
      LET g_xmii6_d[p_ac].l_xmii022_6_s = g_xmii6_d[p_ac].l_xmii022_6_s + g_xmii6_d[p_ac].l_xmii022_6_06
      LET g_xmii6_d[p_ac].l_xmii023_6_s = g_xmii6_d[p_ac].l_xmii023_6_s + g_xmii6_d[p_ac].l_xmii023_6_06
   END IF   
   IF p_xmii014 = 7 THEN
      LET g_xmii4_d[p_ac].l_xmii018_4_07 = g_xmii4_d[p_ac+1].l_xmii018_4_01
      LET g_xmii4_d[p_ac].l_xmii019_4_07 = g_xmii4_d[p_ac+1].l_xmii019_4_01
      LET g_xmii4_d[p_ac].l_xmii018_4_s = g_xmii4_d[p_ac].l_xmii018_4_s + g_xmii4_d[p_ac].l_xmii018_4_07
      LET g_xmii4_d[p_ac].l_xmii019_4_s = g_xmii4_d[p_ac].l_xmii019_4_s + g_xmii4_d[p_ac].l_xmii019_4_07

      LET g_xmii6_d[p_ac].l_xmii022_6_07 = g_xmii6_d[p_ac+1].l_xmii022_6_01
      LET g_xmii6_d[p_ac].l_xmii023_6_07 = g_xmii6_d[p_ac+1].l_xmii023_6_01
      LET g_xmii6_d[p_ac].l_xmii022_6_s = g_xmii6_d[p_ac].l_xmii022_6_s + g_xmii6_d[p_ac].l_xmii022_6_07
      LET g_xmii6_d[p_ac].l_xmii023_6_s = g_xmii6_d[p_ac].l_xmii023_6_s + g_xmii6_d[p_ac].l_xmii023_6_07
   END IF 
   IF p_xmii014 = 8 THEN
      LET g_xmii4_d[p_ac].l_xmii018_4_08 = g_xmii4_d[p_ac+1].l_xmii018_4_01
      LET g_xmii4_d[p_ac].l_xmii019_4_08 = g_xmii4_d[p_ac+1].l_xmii019_4_01
      LET g_xmii4_d[p_ac].l_xmii018_4_s = g_xmii4_d[p_ac].l_xmii018_4_s + g_xmii4_d[p_ac].l_xmii018_4_08
      LET g_xmii4_d[p_ac].l_xmii019_4_s = g_xmii4_d[p_ac].l_xmii019_4_s + g_xmii4_d[p_ac].l_xmii019_4_08

      LET g_xmii6_d[p_ac].l_xmii022_6_08 = g_xmii6_d[p_ac+1].l_xmii022_6_01
      LET g_xmii6_d[p_ac].l_xmii023_6_08 = g_xmii6_d[p_ac+1].l_xmii023_6_01
      LET g_xmii6_d[p_ac].l_xmii022_6_s = g_xmii6_d[p_ac].l_xmii022_6_s + g_xmii6_d[p_ac].l_xmii022_6_08
      LET g_xmii6_d[p_ac].l_xmii023_6_s = g_xmii6_d[p_ac].l_xmii023_6_s + g_xmii6_d[p_ac].l_xmii023_6_08
   END IF
   IF p_xmii014 = 9 THEN
      LET g_xmii4_d[p_ac].l_xmii018_4_09 = g_xmii4_d[p_ac+1].l_xmii018_4_01
      LET g_xmii4_d[p_ac].l_xmii019_4_09 = g_xmii4_d[p_ac+1].l_xmii019_4_01
      LET g_xmii4_d[p_ac].l_xmii018_4_s = g_xmii4_d[p_ac].l_xmii018_4_s + g_xmii4_d[p_ac].l_xmii018_4_09
      LET g_xmii4_d[p_ac].l_xmii019_4_s = g_xmii4_d[p_ac].l_xmii019_4_s + g_xmii4_d[p_ac].l_xmii019_4_09

      LET g_xmii6_d[p_ac].l_xmii022_6_09 = g_xmii6_d[p_ac+1].l_xmii022_6_01
      LET g_xmii6_d[p_ac].l_xmii023_6_09 = g_xmii6_d[p_ac+1].l_xmii023_6_01
      LET g_xmii6_d[p_ac].l_xmii022_6_s = g_xmii6_d[p_ac].l_xmii022_6_s + g_xmii6_d[p_ac].l_xmii022_6_09
      LET g_xmii6_d[p_ac].l_xmii023_6_s = g_xmii6_d[p_ac].l_xmii023_6_s + g_xmii6_d[p_ac].l_xmii023_6_09
   END IF
   IF p_xmii014 = 10 THEN
      LET g_xmii4_d[p_ac].l_xmii018_4_10 = g_xmii4_d[p_ac+1].l_xmii018_4_01
      LET g_xmii4_d[p_ac].l_xmii019_4_10 = g_xmii4_d[p_ac+1].l_xmii019_4_01
      LET g_xmii4_d[p_ac].l_xmii018_4_s = g_xmii4_d[p_ac].l_xmii018_4_s + g_xmii4_d[p_ac].l_xmii018_4_10
      LET g_xmii4_d[p_ac].l_xmii019_4_s = g_xmii4_d[p_ac].l_xmii019_4_s + g_xmii4_d[p_ac].l_xmii019_4_10

      LET g_xmii6_d[p_ac].l_xmii022_6_10 = g_xmii6_d[p_ac+1].l_xmii022_6_01
      LET g_xmii6_d[p_ac].l_xmii023_6_10 = g_xmii6_d[p_ac+1].l_xmii023_6_01
      LET g_xmii6_d[p_ac].l_xmii022_6_s = g_xmii6_d[p_ac].l_xmii022_6_s + g_xmii6_d[p_ac].l_xmii022_6_10
      LET g_xmii6_d[p_ac].l_xmii023_6_s = g_xmii6_d[p_ac].l_xmii023_6_s + g_xmii6_d[p_ac].l_xmii023_6_10
   END IF   
   IF p_xmii014 = 11 THEN
      LET g_xmii4_d[p_ac].l_xmii018_4_11 = g_xmii4_d[p_ac+1].l_xmii018_4_01
      LET g_xmii4_d[p_ac].l_xmii019_4_11 = g_xmii4_d[p_ac+1].l_xmii019_4_01
      LET g_xmii4_d[p_ac].l_xmii018_4_s = g_xmii4_d[p_ac].l_xmii018_4_s + g_xmii4_d[p_ac].l_xmii018_4_11
      LET g_xmii4_d[p_ac].l_xmii019_4_s = g_xmii4_d[p_ac].l_xmii019_4_s + g_xmii4_d[p_ac].l_xmii019_4_11

      LET g_xmii6_d[p_ac].l_xmii022_6_11 = g_xmii6_d[p_ac+1].l_xmii022_6_01
      LET g_xmii6_d[p_ac].l_xmii023_6_11 = g_xmii6_d[p_ac+1].l_xmii023_6_01
      LET g_xmii6_d[p_ac].l_xmii022_6_s = g_xmii6_d[p_ac].l_xmii022_6_s + g_xmii6_d[p_ac].l_xmii022_6_11
      LET g_xmii6_d[p_ac].l_xmii023_6_s = g_xmii6_d[p_ac].l_xmii023_6_s + g_xmii6_d[p_ac].l_xmii023_6_11
   END IF
   IF p_xmii014 = 12 THEN
      LET g_xmii4_d[p_ac].l_xmii018_4_12 = g_xmii4_d[p_ac+1].l_xmii018_4_01
      LET g_xmii4_d[p_ac].l_xmii019_4_12 = g_xmii4_d[p_ac+1].l_xmii019_4_01
      LET g_xmii4_d[p_ac].l_xmii018_4_s = g_xmii4_d[p_ac].l_xmii018_4_s + g_xmii4_d[p_ac].l_xmii018_4_12
      LET g_xmii4_d[p_ac].l_xmii019_4_s = g_xmii4_d[p_ac].l_xmii019_4_s + g_xmii4_d[p_ac].l_xmii019_4_12

      LET g_xmii6_d[p_ac].l_xmii022_6_12 = g_xmii6_d[p_ac+1].l_xmii022_6_01
      LET g_xmii6_d[p_ac].l_xmii023_6_12 = g_xmii6_d[p_ac+1].l_xmii023_6_01
      LET g_xmii6_d[p_ac].l_xmii022_6_s = g_xmii6_d[p_ac].l_xmii022_6_s + g_xmii6_d[p_ac].l_xmii022_6_12
      LET g_xmii6_d[p_ac].l_xmii023_6_s = g_xmii6_d[p_ac].l_xmii023_6_s + g_xmii6_d[p_ac].l_xmii023_6_12
   END IF  
   IF p_xmii014 = 13 THEN
      LET g_xmii4_d[p_ac].l_xmii018_4_13 = g_xmii4_d[p_ac+1].l_xmii018_4_01
      LET g_xmii4_d[p_ac].l_xmii019_4_13 = g_xmii4_d[p_ac+1].l_xmii019_4_01
      LET g_xmii4_d[p_ac].l_xmii018_4_s = g_xmii4_d[p_ac].l_xmii018_4_s + g_xmii4_d[p_ac].l_xmii018_4_13
      LET g_xmii4_d[p_ac].l_xmii019_4_s = g_xmii4_d[p_ac].l_xmii019_4_s + g_xmii4_d[p_ac].l_xmii019_4_13

      LET g_xmii6_d[p_ac].l_xmii022_6_13 = g_xmii6_d[p_ac+1].l_xmii022_6_01
      LET g_xmii6_d[p_ac].l_xmii023_6_13 = g_xmii6_d[p_ac+1].l_xmii023_6_01
      LET g_xmii6_d[p_ac].l_xmii022_6_s = g_xmii6_d[p_ac].l_xmii022_6_s + g_xmii6_d[p_ac].l_xmii022_6_13
      LET g_xmii6_d[p_ac].l_xmii023_6_s = g_xmii6_d[p_ac].l_xmii023_6_s + g_xmii6_d[p_ac].l_xmii023_6_13
   END IF   
   IF p_xmii014 = 14 THEN
      LET g_xmii4_d[p_ac].l_xmii018_4_14 = g_xmii4_d[p_ac+1].l_xmii018_4_01
      LET g_xmii4_d[p_ac].l_xmii019_4_14 = g_xmii4_d[p_ac+1].l_xmii019_4_01
      LET g_xmii4_d[p_ac].l_xmii018_4_s = g_xmii4_d[p_ac].l_xmii018_4_s + g_xmii4_d[p_ac].l_xmii018_4_14
      LET g_xmii4_d[p_ac].l_xmii019_4_s = g_xmii4_d[p_ac].l_xmii019_4_s + g_xmii4_d[p_ac].l_xmii019_4_14

      LET g_xmii6_d[p_ac].l_xmii022_6_14 = g_xmii6_d[p_ac+1].l_xmii022_6_01
      LET g_xmii6_d[p_ac].l_xmii023_6_14 = g_xmii6_d[p_ac+1].l_xmii023_6_01
      LET g_xmii6_d[p_ac].l_xmii022_6_s = g_xmii6_d[p_ac].l_xmii022_6_s + g_xmii6_d[p_ac].l_xmii022_6_14
      LET g_xmii6_d[p_ac].l_xmii023_6_s = g_xmii6_d[p_ac].l_xmii023_6_s + g_xmii6_d[p_ac].l_xmii023_6_14
   END IF 
   IF p_xmii014 = 15 THEN
      LET g_xmii4_d[p_ac].l_xmii018_4_15 = g_xmii4_d[p_ac+1].l_xmii018_4_01
      LET g_xmii4_d[p_ac].l_xmii019_4_15 = g_xmii4_d[p_ac+1].l_xmii019_4_01
      LET g_xmii4_d[p_ac].l_xmii018_4_s = g_xmii4_d[p_ac].l_xmii018_4_s + g_xmii4_d[p_ac].l_xmii018_4_15
      LET g_xmii4_d[p_ac].l_xmii019_4_s = g_xmii4_d[p_ac].l_xmii019_4_s + g_xmii4_d[p_ac].l_xmii019_4_15

      LET g_xmii6_d[p_ac].l_xmii022_6_15 = g_xmii6_d[p_ac+1].l_xmii022_6_01
      LET g_xmii6_d[p_ac].l_xmii023_6_15 = g_xmii6_d[p_ac+1].l_xmii023_6_01
      LET g_xmii6_d[p_ac].l_xmii022_6_s = g_xmii6_d[p_ac].l_xmii022_6_s + g_xmii6_d[p_ac].l_xmii022_6_15
      LET g_xmii6_d[p_ac].l_xmii023_6_s = g_xmii6_d[p_ac].l_xmii023_6_s + g_xmii6_d[p_ac].l_xmii023_6_15
   END IF 
   IF p_xmii014 = 16 THEN
      LET g_xmii4_d[p_ac].l_xmii018_4_16 = g_xmii4_d[p_ac+1].l_xmii018_4_01
      LET g_xmii4_d[p_ac].l_xmii019_4_16 = g_xmii4_d[p_ac+1].l_xmii019_4_01
      LET g_xmii4_d[p_ac].l_xmii018_4_s = g_xmii4_d[p_ac].l_xmii018_4_s + g_xmii4_d[p_ac].l_xmii018_4_16
      LET g_xmii4_d[p_ac].l_xmii019_4_s = g_xmii4_d[p_ac].l_xmii019_4_s + g_xmii4_d[p_ac].l_xmii019_4_16

      LET g_xmii6_d[p_ac].l_xmii022_6_16 = g_xmii6_d[p_ac+1].l_xmii022_6_01
      LET g_xmii6_d[p_ac].l_xmii023_6_16 = g_xmii6_d[p_ac+1].l_xmii023_6_01
      LET g_xmii6_d[p_ac].l_xmii022_6_s = g_xmii6_d[p_ac].l_xmii022_6_s + g_xmii6_d[p_ac].l_xmii022_6_16
      LET g_xmii6_d[p_ac].l_xmii023_6_s = g_xmii6_d[p_ac].l_xmii023_6_s + g_xmii6_d[p_ac].l_xmii023_6_16
   END IF   
   IF p_xmii014 = 17 THEN
      LET g_xmii4_d[p_ac].l_xmii018_4_17 = g_xmii4_d[p_ac+1].l_xmii018_4_01
      LET g_xmii4_d[p_ac].l_xmii019_4_17 = g_xmii4_d[p_ac+1].l_xmii019_4_01
      LET g_xmii4_d[p_ac].l_xmii018_4_s = g_xmii4_d[p_ac].l_xmii018_4_s + g_xmii4_d[p_ac].l_xmii018_4_17
      LET g_xmii4_d[p_ac].l_xmii019_4_s = g_xmii4_d[p_ac].l_xmii019_4_s + g_xmii4_d[p_ac].l_xmii019_4_17

      LET g_xmii6_d[p_ac].l_xmii022_6_17 = g_xmii6_d[p_ac+1].l_xmii022_6_01
      LET g_xmii6_d[p_ac].l_xmii023_6_17 = g_xmii6_d[p_ac+1].l_xmii023_6_01
      LET g_xmii6_d[p_ac].l_xmii022_6_s = g_xmii6_d[p_ac].l_xmii022_6_s + g_xmii6_d[p_ac].l_xmii022_6_17
      LET g_xmii6_d[p_ac].l_xmii023_6_s = g_xmii6_d[p_ac].l_xmii023_6_s + g_xmii6_d[p_ac].l_xmii023_6_17
   END IF 
   IF p_xmii014 = 18 THEN
      LET g_xmii4_d[p_ac].l_xmii018_4_18 = g_xmii4_d[p_ac+1].l_xmii018_4_01   
      LET g_xmii4_d[p_ac].l_xmii019_4_18 = g_xmii4_d[p_ac+1].l_xmii019_4_01
      LET g_xmii4_d[p_ac].l_xmii018_4_s = g_xmii4_d[p_ac].l_xmii018_4_s + g_xmii4_d[p_ac].l_xmii018_4_18
      LET g_xmii4_d[p_ac].l_xmii019_4_s = g_xmii4_d[p_ac].l_xmii019_4_s + g_xmii4_d[p_ac].l_xmii019_4_18

      LET g_xmii6_d[p_ac].l_xmii022_6_18 = g_xmii6_d[p_ac+1].l_xmii022_6_01
      LET g_xmii6_d[p_ac].l_xmii023_6_18 = g_xmii6_d[p_ac+1].l_xmii023_6_01
      LET g_xmii6_d[p_ac].l_xmii022_6_s = g_xmii6_d[p_ac].l_xmii022_6_s + g_xmii6_d[p_ac].l_xmii022_6_18
      LET g_xmii6_d[p_ac].l_xmii023_6_s = g_xmii6_d[p_ac].l_xmii023_6_s + g_xmii6_d[p_ac].l_xmii023_6_18
   END IF 
   IF p_xmii014 = 19 THEN
      LET g_xmii4_d[p_ac].l_xmii018_4_19 = g_xmii4_d[p_ac+1].l_xmii018_4_01
      LET g_xmii4_d[p_ac].l_xmii019_4_19 = g_xmii4_d[p_ac+1].l_xmii019_4_01
      LET g_xmii4_d[p_ac].l_xmii018_4_s = g_xmii4_d[p_ac].l_xmii018_4_s + g_xmii4_d[p_ac].l_xmii018_4_19
      LET g_xmii4_d[p_ac].l_xmii019_4_s = g_xmii4_d[p_ac].l_xmii019_4_s + g_xmii4_d[p_ac].l_xmii019_4_19

      LET g_xmii6_d[p_ac].l_xmii022_6_19 = g_xmii6_d[p_ac+1].l_xmii022_6_01
      LET g_xmii6_d[p_ac].l_xmii023_6_19 = g_xmii6_d[p_ac+1].l_xmii023_6_01
      LET g_xmii6_d[p_ac].l_xmii022_6_s = g_xmii6_d[p_ac].l_xmii022_6_s + g_xmii6_d[p_ac].l_xmii022_6_19
      LET g_xmii6_d[p_ac].l_xmii023_6_s = g_xmii6_d[p_ac].l_xmii023_6_s + g_xmii6_d[p_ac].l_xmii023_6_19
   END IF   
   IF p_xmii014 = 20 THEN
      LET g_xmii4_d[p_ac].l_xmii018_4_20 = g_xmii4_d[p_ac+1].l_xmii018_4_01
      LET g_xmii4_d[p_ac].l_xmii019_4_20 = g_xmii4_d[p_ac+1].l_xmii019_4_01
      LET g_xmii4_d[p_ac].l_xmii018_4_s = g_xmii4_d[p_ac].l_xmii018_4_s + g_xmii4_d[p_ac].l_xmii018_4_20
      LET g_xmii4_d[p_ac].l_xmii019_4_s = g_xmii4_d[p_ac].l_xmii019_4_s + g_xmii4_d[p_ac].l_xmii019_4_20

      LET g_xmii6_d[p_ac].l_xmii022_6_20 = g_xmii6_d[p_ac+1].l_xmii022_6_01
      LET g_xmii6_d[p_ac].l_xmii023_6_20 = g_xmii6_d[p_ac+1].l_xmii023_6_01
      LET g_xmii6_d[p_ac].l_xmii022_6_s = g_xmii6_d[p_ac].l_xmii022_6_s + g_xmii6_d[p_ac].l_xmii022_6_20
      LET g_xmii6_d[p_ac].l_xmii023_6_s = g_xmii6_d[p_ac].l_xmii023_6_s + g_xmii6_d[p_ac].l_xmii023_6_20
   END IF  
   IF p_xmii014 = 21 THEN
      LET g_xmii4_d[p_ac].l_xmii018_4_21 = g_xmii4_d[p_ac+1].l_xmii018_4_01
      LET g_xmii4_d[p_ac].l_xmii019_4_21 = g_xmii4_d[p_ac+1].l_xmii019_4_01
      LET g_xmii4_d[p_ac].l_xmii018_4_s = g_xmii4_d[p_ac].l_xmii018_4_s + g_xmii4_d[p_ac].l_xmii018_4_21
      LET g_xmii4_d[p_ac].l_xmii019_4_s = g_xmii4_d[p_ac].l_xmii019_4_s + g_xmii4_d[p_ac].l_xmii019_4_21

      LET g_xmii6_d[p_ac].l_xmii022_6_21 = g_xmii6_d[p_ac+1].l_xmii022_6_01
      LET g_xmii6_d[p_ac].l_xmii023_6_21 = g_xmii6_d[p_ac+1].l_xmii023_6_01
      LET g_xmii6_d[p_ac].l_xmii022_6_s = g_xmii6_d[p_ac].l_xmii022_6_s + g_xmii6_d[p_ac].l_xmii022_6_21
      LET g_xmii6_d[p_ac].l_xmii023_6_s = g_xmii6_d[p_ac].l_xmii023_6_s + g_xmii6_d[p_ac].l_xmii023_6_21
   END IF
   IF p_xmii014 = 22 THEN
      LET g_xmii4_d[p_ac].l_xmii018_4_22 = g_xmii4_d[p_ac+1].l_xmii018_4_01
      LET g_xmii4_d[p_ac].l_xmii019_4_22 = g_xmii4_d[p_ac+1].l_xmii019_4_01
      LET g_xmii4_d[p_ac].l_xmii018_4_s = g_xmii4_d[p_ac].l_xmii018_4_s + g_xmii4_d[p_ac].l_xmii018_4_22
      LET g_xmii4_d[p_ac].l_xmii019_4_s = g_xmii4_d[p_ac].l_xmii019_4_s + g_xmii4_d[p_ac].l_xmii019_4_22

      LET g_xmii6_d[p_ac].l_xmii022_6_22 = g_xmii6_d[p_ac+1].l_xmii022_6_01
      LET g_xmii6_d[p_ac].l_xmii023_6_22 = g_xmii6_d[p_ac+1].l_xmii023_6_01
      LET g_xmii6_d[p_ac].l_xmii022_6_s = g_xmii6_d[p_ac].l_xmii022_6_s + g_xmii6_d[p_ac].l_xmii022_6_22
      LET g_xmii6_d[p_ac].l_xmii023_6_s = g_xmii6_d[p_ac].l_xmii023_6_s + g_xmii6_d[p_ac].l_xmii023_6_22
   END IF   
   IF p_xmii014 = 23 THEN   
      LET g_xmii4_d[p_ac].l_xmii018_4_23 = g_xmii4_d[p_ac+1].l_xmii018_4_01
      LET g_xmii4_d[p_ac].l_xmii019_4_23 = g_xmii4_d[p_ac+1].l_xmii019_4_01
      LET g_xmii4_d[p_ac].l_xmii018_4_s = g_xmii4_d[p_ac].l_xmii018_4_s + g_xmii4_d[p_ac].l_xmii018_4_23
      LET g_xmii4_d[p_ac].l_xmii019_4_s = g_xmii4_d[p_ac].l_xmii019_4_s + g_xmii4_d[p_ac].l_xmii019_4_23

      LET g_xmii6_d[p_ac].l_xmii022_6_23 = g_xmii6_d[p_ac+1].l_xmii022_6_01
      LET g_xmii6_d[p_ac].l_xmii023_6_23 = g_xmii6_d[p_ac+1].l_xmii023_6_01
      LET g_xmii6_d[p_ac].l_xmii022_6_s = g_xmii6_d[p_ac].l_xmii022_6_s + g_xmii6_d[p_ac].l_xmii022_6_23
      LET g_xmii6_d[p_ac].l_xmii023_6_s = g_xmii6_d[p_ac].l_xmii023_6_s + g_xmii6_d[p_ac].l_xmii023_6_23   
   END IF   
   IF p_xmii014 = 24 THEN   
      LET g_xmii4_d[p_ac].l_xmii018_4_24 = g_xmii4_d[p_ac+1].l_xmii018_4_01
      LET g_xmii4_d[p_ac].l_xmii019_4_24 = g_xmii4_d[p_ac+1].l_xmii019_4_01
      LET g_xmii4_d[p_ac].l_xmii018_4_s = g_xmii4_d[p_ac].l_xmii018_4_s + g_xmii4_d[p_ac].l_xmii018_4_24
      LET g_xmii4_d[p_ac].l_xmii019_4_s = g_xmii4_d[p_ac].l_xmii019_4_s + g_xmii4_d[p_ac].l_xmii019_4_24

      LET g_xmii6_d[p_ac].l_xmii022_6_24 = g_xmii6_d[p_ac+1].l_xmii022_6_01
      LET g_xmii6_d[p_ac].l_xmii023_6_24 = g_xmii6_d[p_ac+1].l_xmii023_6_01
      LET g_xmii6_d[p_ac].l_xmii022_6_s = g_xmii6_d[p_ac].l_xmii022_6_s + g_xmii6_d[p_ac].l_xmii022_6_24
      LET g_xmii6_d[p_ac].l_xmii023_6_s = g_xmii6_d[p_ac].l_xmii023_6_s + g_xmii6_d[p_ac].l_xmii023_6_24   
   END IF     
END FUNCTION]]>
  </point>
  <point name="function.axmt175_b_desc_7" order="8" ver="1" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 不同期別的資料顯示在一筆單身資料中
# Memo...........:
# Usage..........: CALL axmt175_b_desc_7(p_xmii014,p_ac)
#                  RETURNING 回传参数
# Input parameter: p_xmii014      期別
#                : p_ac           行標
# Date & Author..: 日期 By lixh
# Modify.........:
################################################################################
PRIVATE FUNCTION axmt175_b_desc_7(p_xmii014,p_ac)
DEFINE   p_xmii014    LIKE xmii_t.xmii014
DEFINE   p_ac         LIKE type_t.num5
   IF p_xmii014 = 2 THEN
      LET g_xmii7_d[p_ac].l_xmii022_7_02 = g_xmii7_d[p_ac+1].l_xmii022_7_01
      LET g_xmii7_d[p_ac].l_xmii023_7_02 = g_xmii7_d[p_ac+1].l_xmii023_7_01
      LET g_xmii7_d[p_ac].l_xmii022_7_s = g_xmii7_d[p_ac].l_xmii022_7_s + g_xmii7_d[p_ac].l_xmii022_7_02
      LET g_xmii7_d[p_ac].l_xmii023_7_s = g_xmii7_d[p_ac].l_xmii023_7_s + g_xmii7_d[p_ac].l_xmii023_7_02
   END IF
   IF p_xmii014 = 3 THEN
      LET g_xmii7_d[p_ac].l_xmii022_7_03 = g_xmii7_d[p_ac+1].l_xmii022_7_01
      LET g_xmii7_d[p_ac].l_xmii023_7_03 = g_xmii7_d[p_ac+1].l_xmii023_7_01
      LET g_xmii7_d[p_ac].l_xmii022_7_s = g_xmii7_d[p_ac].l_xmii022_7_s + g_xmii7_d[p_ac].l_xmii022_7_03
      LET g_xmii7_d[p_ac].l_xmii023_7_s = g_xmii7_d[p_ac].l_xmii023_7_s + g_xmii7_d[p_ac].l_xmii023_7_03   
   END IF
   IF p_xmii014 = 4 THEN
      LET g_xmii7_d[p_ac].l_xmii022_7_04 = g_xmii7_d[p_ac+1].l_xmii022_7_01
      LET g_xmii7_d[p_ac].l_xmii023_7_04 = g_xmii7_d[p_ac+1].l_xmii023_7_01
      LET g_xmii7_d[p_ac].l_xmii022_7_s = g_xmii7_d[p_ac].l_xmii022_7_s + g_xmii7_d[p_ac].l_xmii022_7_04
      LET g_xmii7_d[p_ac].l_xmii023_7_s = g_xmii7_d[p_ac].l_xmii023_7_s + g_xmii7_d[p_ac].l_xmii023_7_04   
   END IF
   IF p_xmii014 = 5 THEN
      LET g_xmii7_d[p_ac].l_xmii022_7_05 = g_xmii7_d[p_ac+1].l_xmii022_7_01
      LET g_xmii7_d[p_ac].l_xmii023_7_05 = g_xmii7_d[p_ac+1].l_xmii023_7_01
      LET g_xmii7_d[p_ac].l_xmii022_7_s = g_xmii7_d[p_ac].l_xmii022_7_s + g_xmii7_d[p_ac].l_xmii022_7_05
      LET g_xmii7_d[p_ac].l_xmii023_7_s = g_xmii7_d[p_ac].l_xmii023_7_s + g_xmii7_d[p_ac].l_xmii023_7_05   
   END IF
   IF p_xmii014 = 6 THEN
      LET g_xmii7_d[p_ac].l_xmii022_7_06 = g_xmii7_d[p_ac+1].l_xmii022_7_01
      LET g_xmii7_d[p_ac].l_xmii023_7_06 = g_xmii7_d[p_ac+1].l_xmii023_7_01
      LET g_xmii7_d[p_ac].l_xmii022_7_s = g_xmii7_d[p_ac].l_xmii022_7_s + g_xmii7_d[p_ac].l_xmii022_7_06
      LET g_xmii7_d[p_ac].l_xmii023_7_s = g_xmii7_d[p_ac].l_xmii023_7_s + g_xmii7_d[p_ac].l_xmii023_7_06   
   END IF
   IF p_xmii014 = 7 THEN
      LET g_xmii7_d[p_ac].l_xmii022_7_07 = g_xmii7_d[p_ac+1].l_xmii022_7_01
      LET g_xmii7_d[p_ac].l_xmii023_7_07 = g_xmii7_d[p_ac+1].l_xmii023_7_01
      LET g_xmii7_d[p_ac].l_xmii022_7_s = g_xmii7_d[p_ac].l_xmii022_7_s + g_xmii7_d[p_ac].l_xmii022_7_07
      LET g_xmii7_d[p_ac].l_xmii023_7_s = g_xmii7_d[p_ac].l_xmii023_7_s + g_xmii7_d[p_ac].l_xmii023_7_07   
   END IF
   IF p_xmii014 = 8 THEN
      LET g_xmii7_d[p_ac].l_xmii022_7_08 = g_xmii7_d[p_ac+1].l_xmii022_7_01
      LET g_xmii7_d[p_ac].l_xmii023_7_08 = g_xmii7_d[p_ac+1].l_xmii023_7_01
      LET g_xmii7_d[p_ac].l_xmii022_7_s = g_xmii7_d[p_ac].l_xmii022_7_s + g_xmii7_d[p_ac].l_xmii022_7_08
      LET g_xmii7_d[p_ac].l_xmii023_7_s = g_xmii7_d[p_ac].l_xmii023_7_s + g_xmii7_d[p_ac].l_xmii023_7_08   
   END IF
   IF p_xmii014 = 9 THEN
      LET g_xmii7_d[p_ac].l_xmii022_7_09 = g_xmii7_d[p_ac+1].l_xmii022_7_01
      LET g_xmii7_d[p_ac].l_xmii023_7_09 = g_xmii7_d[p_ac+1].l_xmii023_7_01
      LET g_xmii7_d[p_ac].l_xmii022_7_s = g_xmii7_d[p_ac].l_xmii022_7_s + g_xmii7_d[p_ac].l_xmii022_7_09
      LET g_xmii7_d[p_ac].l_xmii023_7_s = g_xmii7_d[p_ac].l_xmii023_7_s + g_xmii7_d[p_ac].l_xmii023_7_09   
   END IF
   IF p_xmii014 = 10 THEN
      LET g_xmii7_d[p_ac].l_xmii022_7_10 = g_xmii7_d[p_ac+1].l_xmii022_7_01
      LET g_xmii7_d[p_ac].l_xmii023_7_10 = g_xmii7_d[p_ac+1].l_xmii023_7_01
      LET g_xmii7_d[p_ac].l_xmii022_7_s = g_xmii7_d[p_ac].l_xmii022_7_s + g_xmii7_d[p_ac].l_xmii022_7_10
      LET g_xmii7_d[p_ac].l_xmii023_7_s = g_xmii7_d[p_ac].l_xmii023_7_s + g_xmii7_d[p_ac].l_xmii023_7_10   
   END IF
   IF p_xmii014 = 11 THEN
      LET g_xmii7_d[p_ac].l_xmii022_7_11 = g_xmii7_d[p_ac+1].l_xmii022_7_01
      LET g_xmii7_d[p_ac].l_xmii023_7_11 = g_xmii7_d[p_ac+1].l_xmii023_7_01
      LET g_xmii7_d[p_ac].l_xmii022_7_s = g_xmii7_d[p_ac].l_xmii022_7_s + g_xmii7_d[p_ac].l_xmii022_7_11
      LET g_xmii7_d[p_ac].l_xmii023_7_s = g_xmii7_d[p_ac].l_xmii023_7_s + g_xmii7_d[p_ac].l_xmii023_7_11   
   END IF
   IF p_xmii014 = 12 THEN
      LET g_xmii7_d[p_ac].l_xmii022_7_12 = g_xmii7_d[p_ac+1].l_xmii022_7_01
      LET g_xmii7_d[p_ac].l_xmii023_7_12 = g_xmii7_d[p_ac+1].l_xmii023_7_01
      LET g_xmii7_d[p_ac].l_xmii022_7_s = g_xmii7_d[p_ac].l_xmii022_7_s + g_xmii7_d[p_ac].l_xmii022_7_12
      LET g_xmii7_d[p_ac].l_xmii023_7_s = g_xmii7_d[p_ac].l_xmii023_7_s + g_xmii7_d[p_ac].l_xmii023_7_12   
   END IF
   IF p_xmii014 = 13 THEN
      LET g_xmii7_d[p_ac].l_xmii022_7_13 = g_xmii7_d[p_ac+1].l_xmii022_7_01
      LET g_xmii7_d[p_ac].l_xmii023_7_13 = g_xmii7_d[p_ac+1].l_xmii023_7_01
      LET g_xmii7_d[p_ac].l_xmii022_7_s = g_xmii7_d[p_ac].l_xmii022_7_s + g_xmii7_d[p_ac].l_xmii022_7_13
      LET g_xmii7_d[p_ac].l_xmii023_7_s = g_xmii7_d[p_ac].l_xmii023_7_s + g_xmii7_d[p_ac].l_xmii023_7_13   
   END IF
   IF p_xmii014 = 14 THEN
      LET g_xmii7_d[p_ac].l_xmii022_7_14 = g_xmii7_d[p_ac+1].l_xmii022_7_01
      LET g_xmii7_d[p_ac].l_xmii023_7_14 = g_xmii7_d[p_ac+1].l_xmii023_7_01
      LET g_xmii7_d[p_ac].l_xmii022_7_s = g_xmii7_d[p_ac].l_xmii022_7_s + g_xmii7_d[p_ac].l_xmii022_7_14
      LET g_xmii7_d[p_ac].l_xmii023_7_s = g_xmii7_d[p_ac].l_xmii023_7_s + g_xmii7_d[p_ac].l_xmii023_7_14   
   END IF
   IF p_xmii014 = 15 THEN
      LET g_xmii7_d[p_ac].l_xmii022_7_15 = g_xmii7_d[p_ac+1].l_xmii022_7_01
      LET g_xmii7_d[p_ac].l_xmii023_7_15 = g_xmii7_d[p_ac+1].l_xmii023_7_01
      LET g_xmii7_d[p_ac].l_xmii022_7_s = g_xmii7_d[p_ac].l_xmii022_7_s + g_xmii7_d[p_ac].l_xmii022_7_15
      LET g_xmii7_d[p_ac].l_xmii023_7_s = g_xmii7_d[p_ac].l_xmii023_7_s + g_xmii7_d[p_ac].l_xmii023_7_15   
   END IF
   IF p_xmii014 = 16 THEN
      LET g_xmii7_d[p_ac].l_xmii022_7_16 = g_xmii7_d[p_ac+1].l_xmii022_7_01
      LET g_xmii7_d[p_ac].l_xmii023_7_16 = g_xmii7_d[p_ac+1].l_xmii023_7_01
      LET g_xmii7_d[p_ac].l_xmii022_7_s = g_xmii7_d[p_ac].l_xmii022_7_s + g_xmii7_d[p_ac].l_xmii022_7_16
      LET g_xmii7_d[p_ac].l_xmii023_7_s = g_xmii7_d[p_ac].l_xmii023_7_s + g_xmii7_d[p_ac].l_xmii023_7_16   
   END IF
   IF p_xmii014 = 17 THEN
      LET g_xmii7_d[p_ac].l_xmii022_7_17 = g_xmii7_d[p_ac+1].l_xmii022_7_01
      LET g_xmii7_d[p_ac].l_xmii023_7_17 = g_xmii7_d[p_ac+1].l_xmii023_7_01
      LET g_xmii7_d[p_ac].l_xmii022_7_s = g_xmii7_d[p_ac].l_xmii022_7_s + g_xmii7_d[p_ac].l_xmii022_7_17
      LET g_xmii7_d[p_ac].l_xmii023_7_s = g_xmii7_d[p_ac].l_xmii023_7_s + g_xmii7_d[p_ac].l_xmii023_7_17   
   END IF
   IF p_xmii014 = 18 THEN
      LET g_xmii7_d[p_ac].l_xmii022_7_18 = g_xmii7_d[p_ac+1].l_xmii022_7_01
      LET g_xmii7_d[p_ac].l_xmii023_7_18 = g_xmii7_d[p_ac+1].l_xmii023_7_01
      LET g_xmii7_d[p_ac].l_xmii022_7_s = g_xmii7_d[p_ac].l_xmii022_7_s + g_xmii7_d[p_ac].l_xmii022_7_18
      LET g_xmii7_d[p_ac].l_xmii023_7_s = g_xmii7_d[p_ac].l_xmii023_7_s + g_xmii7_d[p_ac].l_xmii023_7_18   
   END IF
   IF p_xmii014 = 19 THEN
      LET g_xmii7_d[p_ac].l_xmii022_7_19 = g_xmii7_d[p_ac+1].l_xmii022_7_01
      LET g_xmii7_d[p_ac].l_xmii023_7_19 = g_xmii7_d[p_ac+1].l_xmii023_7_01
      LET g_xmii7_d[p_ac].l_xmii022_7_s = g_xmii7_d[p_ac].l_xmii022_7_s + g_xmii7_d[p_ac].l_xmii022_7_19
      LET g_xmii7_d[p_ac].l_xmii023_7_s = g_xmii7_d[p_ac].l_xmii023_7_s + g_xmii7_d[p_ac].l_xmii023_7_19   
   END IF
   IF p_xmii014 = 20 THEN
      LET g_xmii7_d[p_ac].l_xmii022_7_20 = g_xmii7_d[p_ac+1].l_xmii022_7_01
      LET g_xmii7_d[p_ac].l_xmii023_7_20 = g_xmii7_d[p_ac+1].l_xmii023_7_01
      LET g_xmii7_d[p_ac].l_xmii022_7_s = g_xmii7_d[p_ac].l_xmii022_7_s + g_xmii7_d[p_ac].l_xmii022_7_20
      LET g_xmii7_d[p_ac].l_xmii023_7_s = g_xmii7_d[p_ac].l_xmii023_7_s + g_xmii7_d[p_ac].l_xmii023_7_20   
   END IF
   IF p_xmii014 = 21 THEN
      LET g_xmii7_d[p_ac].l_xmii022_7_21 = g_xmii7_d[p_ac+1].l_xmii022_7_01
      LET g_xmii7_d[p_ac].l_xmii023_7_21 = g_xmii7_d[p_ac+1].l_xmii023_7_01
      LET g_xmii7_d[p_ac].l_xmii022_7_s = g_xmii7_d[p_ac].l_xmii022_7_s + g_xmii7_d[p_ac].l_xmii022_7_21
      LET g_xmii7_d[p_ac].l_xmii023_7_s = g_xmii7_d[p_ac].l_xmii023_7_s + g_xmii7_d[p_ac].l_xmii023_7_21   
   END IF
   IF p_xmii014 = 22 THEN
      LET g_xmii7_d[p_ac].l_xmii022_7_22 = g_xmii7_d[p_ac+1].l_xmii022_7_01
      LET g_xmii7_d[p_ac].l_xmii023_7_22 = g_xmii7_d[p_ac+1].l_xmii023_7_01
      LET g_xmii7_d[p_ac].l_xmii022_7_s = g_xmii7_d[p_ac].l_xmii022_7_s + g_xmii7_d[p_ac].l_xmii022_7_22
      LET g_xmii7_d[p_ac].l_xmii023_7_s = g_xmii7_d[p_ac].l_xmii023_7_s + g_xmii7_d[p_ac].l_xmii023_7_22   
   END IF 
   IF p_xmii014 = 23 THEN
      LET g_xmii7_d[p_ac].l_xmii022_7_23 = g_xmii7_d[p_ac+1].l_xmii022_7_01
      LET g_xmii7_d[p_ac].l_xmii023_7_23 = g_xmii7_d[p_ac+1].l_xmii023_7_01
      LET g_xmii7_d[p_ac].l_xmii022_7_s = g_xmii7_d[p_ac].l_xmii022_7_s + g_xmii7_d[p_ac].l_xmii022_7_23
      LET g_xmii7_d[p_ac].l_xmii023_7_s = g_xmii7_d[p_ac].l_xmii023_7_s + g_xmii7_d[p_ac].l_xmii023_7_23   
   END IF   
   IF p_xmii014 = 24 THEN
      LET g_xmii7_d[p_ac].l_xmii022_7_24 = g_xmii7_d[p_ac+1].l_xmii022_7_01
      LET g_xmii7_d[p_ac].l_xmii023_7_24 = g_xmii7_d[p_ac+1].l_xmii023_7_01
      LET g_xmii7_d[p_ac].l_xmii022_7_s = g_xmii7_d[p_ac].l_xmii022_7_s + g_xmii7_d[p_ac].l_xmii022_7_24
      LET g_xmii7_d[p_ac].l_xmii023_7_s = g_xmii7_d[p_ac].l_xmii023_7_s + g_xmii7_d[p_ac].l_xmii023_7_24   
   END IF   
END FUNCTION]]>
  </point>
  <point name="function.axmt175_upd_xmii" order="9" ver="1" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 更改資料
# Memo...........:
# Usage..........: CALL axmt175_upd_xmii()
# Date & Author..: 日期 By 作者
# Modify.........:
################################################################################
PRIVATE FUNCTION axmt175_upd_xmii()
DEFINE   r_success      LIKE type_t.chr1
   IF NOT cl_null(g_xmii_d[l_ac].l_xmii019_01) AND (g_xmii_d[l_ac].l_xmii019_01 <> g_xmii_d_t.l_xmii019_01 OR g_xmii_d_t.l_xmii019_01 IS NULL) THEN
      IF NOT axmt175_upd_xmii019(g_xmii_d[l_ac].l_xmii019_01,1) THEN
         LET r_success = 'N'
      END IF
   END IF
   IF NOT cl_null(g_xmii_d[l_ac].l_xmii019_02) AND (g_xmii_d[l_ac].l_xmii019_02 <> g_xmii_d_t.l_xmii019_02 OR g_xmii_d_t.l_xmii019_02 IS NULL) THEN
      IF NOT axmt175_upd_xmii019(g_xmii_d[l_ac].l_xmii019_02,2) THEN
         LET r_success = 'N'
      END IF            
   END IF   
   IF NOT cl_null(g_xmii_d[l_ac].l_xmii019_03) AND (g_xmii_d[l_ac].l_xmii019_03 <> g_xmii_d_t.l_xmii019_03 OR g_xmii_d_t.l_xmii019_03 IS NULL)THEN
      IF NOT axmt175_upd_xmii019(g_xmii_d[l_ac].l_xmii019_03,3) THEN
        LET r_success = 'N'
      END IF   
   END IF  
   IF NOT cl_null(g_xmii_d[l_ac].l_xmii019_04) AND (g_xmii_d[l_ac].l_xmii019_04 <> g_xmii_d_t.l_xmii019_04 OR g_xmii_d_t.l_xmii019_04 IS NULL) THEN
      IF NOT axmt175_upd_xmii019(g_xmii_d[l_ac].l_xmii019_04,4) THEN
         LET r_success = 'N'
      END IF   
   END IF  
   IF NOT cl_null(g_xmii_d[l_ac].l_xmii019_05) AND (g_xmii_d[l_ac].l_xmii019_05 <> g_xmii_d_t.l_xmii019_05 OR g_xmii_d_t.l_xmii019_05 IS NULL) THEN
      IF NOT axmt175_upd_xmii019(g_xmii_d[l_ac].l_xmii019_05,5) THEN
         LET r_success = 'N'
      END IF
   END IF  
   IF NOT cl_null(g_xmii_d[l_ac].l_xmii019_06) AND (g_xmii_d[l_ac].l_xmii019_06 <> g_xmii_d_t.l_xmii019_06 OR g_xmii_d_t.l_xmii019_06 IS NULL) THEN
      IF NOT axmt175_upd_xmii019(g_xmii_d[l_ac].l_xmii019_06,6) THEN
         LET r_success = 'N'
      END IF   
   END IF  
   IF NOT cl_null(g_xmii_d[l_ac].l_xmii019_07) AND (g_xmii_d[l_ac].l_xmii019_07 <> g_xmii_d_t.l_xmii019_07 OR g_xmii_d_t.l_xmii019_07 IS NULL) THEN
      IF NOT axmt175_upd_xmii019(g_xmii_d[l_ac].l_xmii019_07,7) THEN
         LET r_success = 'N'
      END IF   
   END IF  
   IF NOT cl_null(g_xmii_d[l_ac].l_xmii019_08) AND (g_xmii_d[l_ac].l_xmii019_08 <> g_xmii_d_t.l_xmii019_08 OR g_xmii_d_t.l_xmii019_08 IS NULL) THEN
      IF NOT axmt175_upd_xmii019(g_xmii_d[l_ac].l_xmii019_08,8) THEN
         LET r_success = 'N'   
      END IF         
   END IF  
   IF NOT cl_null(g_xmii_d[l_ac].l_xmii019_09) AND (g_xmii_d[l_ac].l_xmii019_09 <> g_xmii_d_t.l_xmii019_09 OR g_xmii_d_t.l_xmii019_09 IS NULL) THEN
      IF NOT axmt175_upd_xmii019(g_xmii_d[l_ac].l_xmii019_09,9) THEN
         LET r_success = 'N'   
      END IF      
   END IF  
   IF NOT cl_null(g_xmii_d[l_ac].l_xmii019_10) AND (g_xmii_d[l_ac].l_xmii019_10 <> g_xmii_d_t.l_xmii019_10 OR g_xmii_d_t.l_xmii019_10 IS NULL) THEN
      IF NOT axmt175_upd_xmii019(g_xmii_d[l_ac].l_xmii019_10,10) THEN
         LET r_success = 'N'   
      END IF      
   END IF  
   IF NOT cl_null(g_xmii_d[l_ac].l_xmii019_11) AND (g_xmii_d[l_ac].l_xmii019_11 <> g_xmii_d_t.l_xmii019_11 OR g_xmii_d_t.l_xmii019_11 IS NULL) THEN
      IF NOT axmt175_upd_xmii019(g_xmii_d[l_ac].l_xmii019_11,11) THEN
         LET r_success = 'N'
      END IF
   END IF
   IF NOT cl_null(g_xmii_d[l_ac].l_xmii019_12) AND (g_xmii_d[l_ac].l_xmii019_12 <> g_xmii_d_t.l_xmii019_12 OR g_xmii_d_t.l_xmii019_12 IS NULL) THEN
      IF NOT axmt175_upd_xmii019(g_xmii_d[l_ac].l_xmii019_12,12) THEN
         LET r_success = 'N'
      END IF            
   END IF   
   IF NOT cl_null(g_xmii_d[l_ac].l_xmii019_13) AND (g_xmii_d[l_ac].l_xmii019_13 <> g_xmii_d_t.l_xmii019_13 OR g_xmii_d_t.l_xmii019_13 IS NULL) THEN
      IF NOT axmt175_upd_xmii019(g_xmii_d[l_ac].l_xmii019_13,13) THEN
        LET r_success = 'N'
      END IF   
   END IF  
   IF NOT cl_null(g_xmii_d[l_ac].l_xmii019_14) AND (g_xmii_d[l_ac].l_xmii019_14 <> g_xmii_d_t.l_xmii019_14 OR g_xmii_d_t.l_xmii019_14 IS NULL) THEN
      IF NOT axmt175_upd_xmii019(g_xmii_d[l_ac].l_xmii019_14,14) THEN
         LET r_success = 'N'
      END IF   
   END IF  
   IF NOT cl_null(g_xmii_d[l_ac].l_xmii019_15) AND (g_xmii_d[l_ac].l_xmii019_15 <> g_xmii_d_t.l_xmii019_15 OR g_xmii_d_t.l_xmii019_15 IS NULL) THEN
      IF NOT axmt175_upd_xmii019(g_xmii_d[l_ac].l_xmii019_15,15) THEN
         LET r_success = 'N'
      END IF
   END IF  
   IF NOT cl_null(g_xmii_d[l_ac].l_xmii019_16) AND (g_xmii_d[l_ac].l_xmii019_16 <> g_xmii_d_t.l_xmii019_16 OR g_xmii_d_t.l_xmii019_16 IS NULL)THEN
      IF NOT axmt175_upd_xmii019(g_xmii_d[l_ac].l_xmii019_16,16) THEN
         LET r_success = 'N'
      END IF   
   END IF  
   IF NOT cl_null(g_xmii_d[l_ac].l_xmii019_17) AND (g_xmii_d[l_ac].l_xmii019_17 <> g_xmii_d_t.l_xmii019_17 OR g_xmii_d_t.l_xmii019_17 IS NULL) THEN
      IF NOT axmt175_upd_xmii019(g_xmii_d[l_ac].l_xmii019_17,17) THEN
         LET r_success = 'N'
      END IF   
   END IF  
   IF NOT cl_null(g_xmii_d[l_ac].l_xmii019_18) AND (g_xmii_d[l_ac].l_xmii019_18 <> g_xmii_d_t.l_xmii019_18 OR g_xmii_d_t.l_xmii019_18 IS NULL) THEN
      IF NOT axmt175_upd_xmii019(g_xmii_d[l_ac].l_xmii019_18,18) THEN
         LET r_success = 'N'   
      END IF         
   END IF  
   IF NOT cl_null(g_xmii_d[l_ac].l_xmii019_19) AND (g_xmii_d[l_ac].l_xmii019_19 <> g_xmii_d_t.l_xmii019_19 OR g_xmii_d_t.l_xmii019_19 IS NULL) THEN
      IF NOT axmt175_upd_xmii019(g_xmii_d[l_ac].l_xmii019_19,19) THEN
         LET r_success = 'N'   
      END IF      
   END IF  
   IF NOT cl_null(g_xmii_d[l_ac].l_xmii019_20) AND (g_xmii_d[l_ac].l_xmii019_20 <> g_xmii_d_t.l_xmii019_20 OR g_xmii_d_t.l_xmii019_20 IS NULL) THEN
      IF NOT axmt175_upd_xmii019(g_xmii_d[l_ac].l_xmii019_20,20) THEN
         LET r_success = 'N'   
      END IF      
   END IF 
   IF NOT cl_null(g_xmii_d[l_ac].l_xmii019_21) AND (g_xmii_d[l_ac].l_xmii019_21 <> g_xmii_d_t.l_xmii019_21 OR g_xmii_d_t.l_xmii019_21 IS NULL) THEN
      IF NOT axmt175_upd_xmii019(g_xmii_d[l_ac].l_xmii019_21,21) THEN
         LET r_success = 'N'   
      END IF 
   END IF  
   IF NOT cl_null(g_xmii_d[l_ac].l_xmii019_22) AND (g_xmii_d[l_ac].l_xmii019_22 <> g_xmii_d_t.l_xmii019_22 OR g_xmii_d_t.l_xmii019_22 IS NULL) THEN
      IF NOT axmt175_upd_xmii019(g_xmii_d[l_ac].l_xmii019_22,22) THEN
         LET r_success = 'N'   
      END IF 
   END IF  
   IF NOT cl_null(g_xmii_d[l_ac].l_xmii019_23) AND (g_xmii_d[l_ac].l_xmii019_23 <> g_xmii_d_t.l_xmii019_23 OR g_xmii_d_t.l_xmii019_23 IS NULL) THEN
      IF NOT axmt175_upd_xmii019(g_xmii_d[l_ac].l_xmii019_23,23) THEN
         LET r_success = 'N'   
      END IF 
   END IF  
   IF NOT cl_null(g_xmii_d[l_ac].l_xmii019_24) AND (g_xmii_d[l_ac].l_xmii019_24 <> g_xmii_d_t.l_xmii019_24 OR g_xmii_d_t.l_xmii019_24 IS NULL) THEN
      IF NOT axmt175_upd_xmii019(g_xmii_d[l_ac].l_xmii019_24,24) THEN
         LET r_success = 'N'   
      END IF 
   END IF 
   RETURN r_success
END FUNCTION]]>
  </point>
  <point name="function.axmt175_upd_xmii_2" order="10" ver="1" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 更改資料
# Memo...........:
# Usage..........: CALL axmt175_upd_xmii_2()
# Date & Author..: 日期 By 作者
# Modify.........:
################################################################################
PRIVATE FUNCTION axmt175_upd_xmii_2()
DEFINE   r_success      LIKE type_t.chr1
   IF NOT cl_null(g_xmii2_d[l_ac].l_xmii023_01) AND (g_xmii2_d[l_ac].l_xmii023_01 <> g_xmii2_d_t.l_xmii023_01 OR g_xmii2_d_t.l_xmii023_01 IS NULL) THEN
      IF NOT axmt175_upd_xmii023(g_xmii2_d[l_ac].l_xmii023_01,1) THEN
         LET r_success = 'N'
      END IF
   END IF
   IF NOT cl_null(g_xmii2_d[l_ac].l_xmii023_02) AND (g_xmii2_d[l_ac].l_xmii023_02 <> g_xmii2_d_t.l_xmii023_02 OR g_xmii2_d_t.l_xmii023_02 IS NULL) THEN
      IF NOT axmt175_upd_xmii023(g_xmii2_d[l_ac].l_xmii023_02,2) THEN
         LET r_success = 'N'
      END IF            
   END IF   
   IF NOT cl_null(g_xmii2_d[l_ac].l_xmii023_03) AND (g_xmii2_d[l_ac].l_xmii023_03 <> g_xmii2_d_t.l_xmii023_03 OR g_xmii2_d_t.l_xmii023_03 IS NULL)THEN
      IF NOT axmt175_upd_xmii023(g_xmii2_d[l_ac].l_xmii023_03,3) THEN
        LET r_success = 'N'
      END IF   
   END IF  
   IF NOT cl_null(g_xmii2_d[l_ac].l_xmii023_04) AND (g_xmii2_d[l_ac].l_xmii023_04 <> g_xmii2_d_t.l_xmii023_04 OR g_xmii2_d_t.l_xmii023_04 IS NULL) THEN
      IF NOT axmt175_upd_xmii023(g_xmii2_d[l_ac].l_xmii023_04,4) THEN
         LET r_success = 'N'
      END IF   
   END IF  
   IF NOT cl_null(g_xmii2_d[l_ac].l_xmii023_05) AND (g_xmii2_d[l_ac].l_xmii023_05 <> g_xmii2_d_t.l_xmii023_05 OR g_xmii2_d_t.l_xmii023_05 IS NULL) THEN
      IF NOT axmt175_upd_xmii023(g_xmii2_d[l_ac].l_xmii023_05,5) THEN
         LET r_success = 'N'
      END IF
   END IF  
   IF NOT cl_null(g_xmii2_d[l_ac].l_xmii023_06) AND (g_xmii2_d[l_ac].l_xmii023_06 <> g_xmii2_d_t.l_xmii023_06 OR g_xmii2_d_t.l_xmii023_06 IS NULL) THEN
      IF NOT axmt175_upd_xmii023(g_xmii2_d[l_ac].l_xmii023_06,6) THEN
         LET r_success = 'N'
      END IF   
   END IF  
   IF NOT cl_null(g_xmii2_d[l_ac].l_xmii023_07) AND (g_xmii2_d[l_ac].l_xmii023_07 <> g_xmii2_d_t.l_xmii023_07 OR g_xmii2_d_t.l_xmii023_07 IS NULL) THEN
      IF NOT axmt175_upd_xmii023(g_xmii2_d[l_ac].l_xmii023_07,7) THEN
         LET r_success = 'N'
      END IF   
   END IF  
   IF NOT cl_null(g_xmii2_d[l_ac].l_xmii023_08) AND (g_xmii2_d[l_ac].l_xmii023_08 <> g_xmii2_d_t.l_xmii023_08 OR g_xmii2_d_t.l_xmii023_08 IS NULL) THEN
      IF NOT axmt175_upd_xmii023(g_xmii2_d[l_ac].l_xmii023_08,8) THEN
         LET r_success = 'N'   
      END IF         
   END IF  
   IF NOT cl_null(g_xmii2_d[l_ac].l_xmii023_09) AND (g_xmii2_d[l_ac].l_xmii023_09 <> g_xmii2_d_t.l_xmii023_09 OR g_xmii2_d_t.l_xmii023_09 IS NULL) THEN
      IF NOT axmt175_upd_xmii023(g_xmii2_d[l_ac].l_xmii023_09,9) THEN
         LET r_success = 'N'   
      END IF      
   END IF  
   IF NOT cl_null(g_xmii2_d[l_ac].l_xmii023_10) AND (g_xmii2_d[l_ac].l_xmii023_10 <> g_xmii2_d_t.l_xmii023_10 OR g_xmii2_d_t.l_xmii023_10 IS NULL) THEN
      IF NOT axmt175_upd_xmii023(g_xmii2_d[l_ac].l_xmii023_10,10) THEN
         LET r_success = 'N'   
      END IF      
   END IF  
   IF NOT cl_null(g_xmii2_d[l_ac].l_xmii023_11) AND (g_xmii2_d[l_ac].l_xmii023_11 <> g_xmii2_d_t.l_xmii023_11 OR g_xmii2_d_t.l_xmii023_11 IS NULL) THEN
      IF NOT axmt175_upd_xmii023(g_xmii2_d[l_ac].l_xmii023_11,11) THEN
         LET r_success = 'N'
      END IF
   END IF
   IF NOT cl_null(g_xmii2_d[l_ac].l_xmii023_12) AND (g_xmii2_d[l_ac].l_xmii023_12 <> g_xmii2_d_t.l_xmii023_12 OR g_xmii2_d_t.l_xmii023_12 IS NULL) THEN
      IF NOT axmt175_upd_xmii023(g_xmii2_d[l_ac].l_xmii023_12,12) THEN
         LET r_success = 'N'
      END IF            
   END IF   
   IF NOT cl_null(g_xmii2_d[l_ac].l_xmii023_13) AND (g_xmii2_d[l_ac].l_xmii023_13 <> g_xmii2_d_t.l_xmii023_13 OR g_xmii2_d_t.l_xmii023_13 IS NULL) THEN
      IF NOT axmt175_upd_xmii023(g_xmii2_d[l_ac].l_xmii023_13,13) THEN
        LET r_success = 'N'
      END IF   
   END IF  
   IF NOT cl_null(g_xmii2_d[l_ac].l_xmii023_14) AND (g_xmii2_d[l_ac].l_xmii023_14 <> g_xmii2_d_t.l_xmii023_14 OR g_xmii2_d_t.l_xmii023_14 IS NULL) THEN
      IF NOT axmt175_upd_xmii023(g_xmii2_d[l_ac].l_xmii023_14,14) THEN
         LET r_success = 'N'
      END IF   
   END IF  
   IF NOT cl_null(g_xmii2_d[l_ac].l_xmii023_15) AND (g_xmii2_d[l_ac].l_xmii023_15 <> g_xmii2_d_t.l_xmii023_15 OR g_xmii2_d_t.l_xmii023_15 IS NULL) THEN
      IF NOT axmt175_upd_xmii023(g_xmii2_d[l_ac].l_xmii023_15,15) THEN
         LET r_success = 'N'
      END IF
   END IF  
   IF NOT cl_null(g_xmii2_d[l_ac].l_xmii023_16) AND (g_xmii2_d[l_ac].l_xmii023_16 <> g_xmii2_d_t.l_xmii023_16 OR g_xmii2_d_t.l_xmii023_16 IS NULL)THEN
      IF NOT axmt175_upd_xmii023(g_xmii2_d[l_ac].l_xmii023_16,16) THEN
         LET r_success = 'N'
      END IF   
   END IF  
   IF NOT cl_null(g_xmii2_d[l_ac].l_xmii023_17) AND (g_xmii2_d[l_ac].l_xmii023_17 <> g_xmii2_d_t.l_xmii023_17 OR g_xmii2_d_t.l_xmii023_17 IS NULL) THEN
      IF NOT axmt175_upd_xmii023(g_xmii2_d[l_ac].l_xmii023_17,17) THEN
         LET r_success = 'N'
      END IF   
   END IF  
   IF NOT cl_null(g_xmii2_d[l_ac].l_xmii023_18) AND (g_xmii2_d[l_ac].l_xmii023_18 <> g_xmii2_d_t.l_xmii023_18 OR g_xmii2_d_t.l_xmii023_18 IS NULL) THEN
      IF NOT axmt175_upd_xmii023(g_xmii2_d[l_ac].l_xmii023_18,18) THEN
         LET r_success = 'N'   
      END IF         
   END IF  
   IF NOT cl_null(g_xmii2_d[l_ac].l_xmii023_19) AND (g_xmii2_d[l_ac].l_xmii023_19 <> g_xmii2_d_t.l_xmii023_19 OR g_xmii2_d_t.l_xmii023_19 IS NULL) THEN
      IF NOT axmt175_upd_xmii023(g_xmii2_d[l_ac].l_xmii023_19,19) THEN
         LET r_success = 'N'   
      END IF      
   END IF  
   IF NOT cl_null(g_xmii2_d[l_ac].l_xmii023_20) AND (g_xmii2_d[l_ac].l_xmii023_20 <> g_xmii2_d_t.l_xmii023_20 OR g_xmii2_d_t.l_xmii023_20 IS NULL) THEN
      IF NOT axmt175_upd_xmii023(g_xmii2_d[l_ac].l_xmii023_20,20) THEN
         LET r_success = 'N'   
      END IF      
   END IF 
   IF NOT cl_null(g_xmii2_d[l_ac].l_xmii023_21) AND (g_xmii2_d[l_ac].l_xmii023_21 <> g_xmii2_d_t.l_xmii023_21 OR g_xmii2_d_t.l_xmii023_21 IS NULL) THEN
      IF NOT axmt175_upd_xmii023(g_xmii2_d[l_ac].l_xmii023_21,21) THEN
         LET r_success = 'N'   
      END IF 
   END IF  
   IF NOT cl_null(g_xmii2_d[l_ac].l_xmii023_22) AND (g_xmii2_d[l_ac].l_xmii023_22 <> g_xmii2_d_t.l_xmii023_22 OR g_xmii2_d_t.l_xmii023_22 IS NULL) THEN
      IF NOT axmt175_upd_xmii023(g_xmii2_d[l_ac].l_xmii023_22,22) THEN
         LET r_success = 'N'   
      END IF 
   END IF  
   IF NOT cl_null(g_xmii2_d[l_ac].l_xmii023_23) AND (g_xmii2_d[l_ac].l_xmii023_23 <> g_xmii2_d_t.l_xmii023_23 OR g_xmii2_d_t.l_xmii023_23 IS NULL) THEN
      IF NOT axmt175_upd_xmii023(g_xmii2_d[l_ac].l_xmii023_23,23) THEN
         LET r_success = 'N'   
      END IF 
   END IF  
   IF NOT cl_null(g_xmii2_d[l_ac].l_xmii023_24) AND (g_xmii2_d[l_ac].l_xmii023_24 <> g_xmii2_d_t.l_xmii023_24 OR g_xmii2_d_t.l_xmii023_24 IS NULL) THEN
      IF NOT axmt175_upd_xmii023(g_xmii2_d[l_ac].l_xmii023_24,24) THEN
         LET r_success = 'N'   
      END IF 
   END IF 
   RETURN r_success
END FUNCTION]]>
  </point>
  <point name="function.axmt175_upd_xmii_3" order="11" ver="1" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 修改單身資料
# Memo...........:
# Usage..........: CALL axmt175_upd_xmii_3()
#                  RETURNING TRUE/FALSE
# Date & Author..: 日期 By 作者
# Modify.........:
################################################################################
PRIVATE FUNCTION axmt175_upd_xmii_3()
DEFINE   r_success      LIKE type_t.chr1
   IF NOT cl_null(g_xmii3_d[l_ac].l_xmii023_3_01) AND (g_xmii3_d[l_ac].l_xmii023_3_01 <> g_xmii3_d_t.l_xmii023_3_01 OR g_xmii3_d_t.l_xmii023_3_01 IS NULL) THEN
      IF NOT axmt175_upd_xmii023_3(g_xmii3_d[l_ac].l_xmii019_3_01,g_xmii3_d[l_ac].l_xmii023_3_01,1) THEN
         LET r_success = 'N'
      END IF
   END IF
   IF NOT cl_null(g_xmii3_d[l_ac].l_xmii023_3_02) AND (g_xmii3_d[l_ac].l_xmii023_3_02 <> g_xmii3_d_t.l_xmii023_3_02 OR g_xmii3_d_t.l_xmii023_3_02 IS NULL) THEN
      IF NOT axmt175_upd_xmii023_3(g_xmii3_d[l_ac].l_xmii019_3_02,g_xmii3_d[l_ac].l_xmii023_3_02,2) THEN
         LET r_success = 'N'
      END IF            
   END IF   
   IF NOT cl_null(g_xmii3_d[l_ac].l_xmii023_3_03) AND (g_xmii3_d[l_ac].l_xmii023_3_03 <> g_xmii3_d_t.l_xmii023_3_03 OR g_xmii3_d_t.l_xmii023_3_03 IS NULL)THEN
      IF NOT axmt175_upd_xmii023_3(g_xmii3_d[l_ac].l_xmii019_3_03,g_xmii3_d[l_ac].l_xmii023_3_03,3) THEN
        LET r_success = 'N'
      END IF   
   END IF  
   IF NOT cl_null(g_xmii3_d[l_ac].l_xmii023_3_04) AND (g_xmii3_d[l_ac].l_xmii023_3_04 <> g_xmii3_d_t.l_xmii023_3_04 OR g_xmii3_d_t.l_xmii023_3_04 IS NULL) THEN
      IF NOT axmt175_upd_xmii023_3(g_xmii3_d[l_ac].l_xmii019_3_04,g_xmii3_d[l_ac].l_xmii023_3_04,4) THEN
         LET r_success = 'N'
      END IF   
   END IF  
   IF NOT cl_null(g_xmii3_d[l_ac].l_xmii023_3_05) AND (g_xmii3_d[l_ac].l_xmii023_3_05 <> g_xmii3_d_t.l_xmii023_3_05 OR g_xmii3_d_t.l_xmii023_3_05 IS NULL) THEN
      IF NOT axmt175_upd_xmii023_3(g_xmii3_d[l_ac].l_xmii019_3_05,g_xmii3_d[l_ac].l_xmii023_3_05,5) THEN
         LET r_success = 'N'
      END IF
   END IF  
   IF NOT cl_null(g_xmii3_d[l_ac].l_xmii023_3_06) AND (g_xmii3_d[l_ac].l_xmii023_3_06 <> g_xmii3_d_t.l_xmii023_3_06 OR g_xmii3_d_t.l_xmii023_3_06 IS NULL) THEN
      IF NOT axmt175_upd_xmii023_3(g_xmii3_d[l_ac].l_xmii019_3_06,g_xmii3_d[l_ac].l_xmii023_3_06,6) THEN
         LET r_success = 'N'
      END IF   
   END IF  
   IF NOT cl_null(g_xmii3_d[l_ac].l_xmii023_3_07) AND (g_xmii3_d[l_ac].l_xmii023_3_07 <> g_xmii3_d_t.l_xmii023_3_07 OR g_xmii3_d_t.l_xmii023_3_07 IS NULL) THEN
      IF NOT axmt175_upd_xmii023_3(g_xmii3_d[l_ac].l_xmii019_3_07,g_xmii3_d[l_ac].l_xmii023_3_07,7) THEN
         LET r_success = 'N'
      END IF   
   END IF  
   IF NOT cl_null(g_xmii3_d[l_ac].l_xmii023_3_08) AND (g_xmii3_d[l_ac].l_xmii023_3_08 <> g_xmii3_d_t.l_xmii023_3_08 OR g_xmii3_d_t.l_xmii023_3_08 IS NULL) THEN
      IF NOT axmt175_upd_xmii023_3(g_xmii3_d[l_ac].l_xmii019_3_08,g_xmii3_d[l_ac].l_xmii023_3_08,8) THEN
         LET r_success = 'N'   
      END IF         
   END IF  
   IF NOT cl_null(g_xmii3_d[l_ac].l_xmii023_3_09) AND (g_xmii3_d[l_ac].l_xmii023_3_09 <> g_xmii3_d_t.l_xmii023_3_09 OR g_xmii3_d_t.l_xmii023_3_09 IS NULL) THEN
      IF NOT axmt175_upd_xmii023_3(g_xmii3_d[l_ac].l_xmii019_3_09,g_xmii3_d[l_ac].l_xmii023_3_09,9) THEN
         LET r_success = 'N'   
      END IF      
   END IF  
   IF NOT cl_null(g_xmii3_d[l_ac].l_xmii023_3_10) AND (g_xmii3_d[l_ac].l_xmii023_3_10 <> g_xmii3_d_t.l_xmii023_3_10 OR g_xmii3_d_t.l_xmii023_3_10 IS NULL) THEN
      IF NOT axmt175_upd_xmii023_3(g_xmii3_d[l_ac].l_xmii019_3_10,g_xmii3_d[l_ac].l_xmii023_3_10,10) THEN
         LET r_success = 'N'   
      END IF      
   END IF  
   IF NOT cl_null(g_xmii3_d[l_ac].l_xmii023_3_11) AND (g_xmii3_d[l_ac].l_xmii023_3_11 <> g_xmii3_d_t.l_xmii023_3_11 OR g_xmii3_d_t.l_xmii023_3_11 IS NULL) THEN
      IF NOT axmt175_upd_xmii023_3(g_xmii3_d[l_ac].l_xmii019_3_11,g_xmii3_d[l_ac].l_xmii023_3_11,11) THEN
         LET r_success = 'N'
      END IF
   END IF
   IF NOT cl_null(g_xmii3_d[l_ac].l_xmii023_3_12) AND (g_xmii3_d[l_ac].l_xmii023_3_12 <> g_xmii3_d_t.l_xmii023_3_12 OR g_xmii3_d_t.l_xmii023_3_12 IS NULL) THEN
      IF NOT axmt175_upd_xmii023_3(g_xmii3_d[l_ac].l_xmii019_3_12,g_xmii3_d[l_ac].l_xmii023_3_12,12) THEN
         LET r_success = 'N'
      END IF            
   END IF   
   IF NOT cl_null(g_xmii3_d[l_ac].l_xmii023_3_13) AND (g_xmii3_d[l_ac].l_xmii023_3_13 <> g_xmii3_d_t.l_xmii023_3_13 OR g_xmii3_d_t.l_xmii023_3_13 IS NULL) THEN
      IF NOT axmt175_upd_xmii023_3(g_xmii3_d[l_ac].l_xmii019_3_13,g_xmii3_d[l_ac].l_xmii023_3_13,13) THEN
        LET r_success = 'N'
      END IF   
   END IF  
   IF NOT cl_null(g_xmii3_d[l_ac].l_xmii023_3_14) AND (g_xmii3_d[l_ac].l_xmii023_3_14 <> g_xmii3_d_t.l_xmii023_3_14 OR g_xmii3_d_t.l_xmii023_3_14 IS NULL) THEN
      IF NOT axmt175_upd_xmii023_3(g_xmii3_d[l_ac].l_xmii019_3_14,g_xmii3_d[l_ac].l_xmii023_3_14,14) THEN
         LET r_success = 'N'
      END IF   
   END IF  
   IF NOT cl_null(g_xmii3_d[l_ac].l_xmii023_3_15) AND (g_xmii3_d[l_ac].l_xmii023_3_15 <> g_xmii3_d_t.l_xmii023_3_15 OR g_xmii3_d_t.l_xmii023_3_15 IS NULL) THEN
      IF NOT axmt175_upd_xmii023_3(g_xmii3_d[l_ac].l_xmii019_3_15,g_xmii3_d[l_ac].l_xmii023_3_15,15) THEN
         LET r_success = 'N'
      END IF
   END IF  
   IF NOT cl_null(g_xmii3_d[l_ac].l_xmii023_3_16) AND (g_xmii3_d[l_ac].l_xmii023_3_16 <> g_xmii3_d_t.l_xmii023_3_16 OR g_xmii3_d_t.l_xmii023_3_16 IS NULL)THEN
      IF NOT axmt175_upd_xmii023_3(g_xmii3_d[l_ac].l_xmii019_3_16,g_xmii3_d[l_ac].l_xmii023_3_16,16) THEN
         LET r_success = 'N'
      END IF   
   END IF  
   IF NOT cl_null(g_xmii3_d[l_ac].l_xmii023_3_17) AND (g_xmii3_d[l_ac].l_xmii023_3_17 <> g_xmii3_d_t.l_xmii023_3_17 OR g_xmii3_d_t.l_xmii023_3_17 IS NULL) THEN
      IF NOT axmt175_upd_xmii023_3(g_xmii3_d[l_ac].l_xmii019_3_17,g_xmii3_d[l_ac].l_xmii023_3_17,17) THEN
         LET r_success = 'N'
      END IF   
   END IF  
   IF NOT cl_null(g_xmii3_d[l_ac].l_xmii023_3_18) AND (g_xmii3_d[l_ac].l_xmii023_3_18 <> g_xmii3_d_t.l_xmii023_3_18 OR g_xmii3_d_t.l_xmii023_3_18 IS NULL) THEN
      IF NOT axmt175_upd_xmii023_3(g_xmii3_d[l_ac].l_xmii019_3_18,g_xmii3_d[l_ac].l_xmii023_3_18,18) THEN
         LET r_success = 'N'   
      END IF         
   END IF  
   IF NOT cl_null(g_xmii3_d[l_ac].l_xmii023_3_19) AND (g_xmii3_d[l_ac].l_xmii023_3_19 <> g_xmii3_d_t.l_xmii023_3_19 OR g_xmii3_d_t.l_xmii023_3_19 IS NULL) THEN
      IF NOT axmt175_upd_xmii023_3(g_xmii3_d[l_ac].l_xmii019_3_19,g_xmii3_d[l_ac].l_xmii023_3_19,19) THEN
         LET r_success = 'N'   
      END IF      
   END IF  
   IF NOT cl_null(g_xmii3_d[l_ac].l_xmii023_3_20) AND (g_xmii3_d[l_ac].l_xmii023_3_20 <> g_xmii3_d_t.l_xmii023_3_20 OR g_xmii3_d_t.l_xmii023_3_20 IS NULL) THEN
      IF NOT axmt175_upd_xmii023_3(g_xmii3_d[l_ac].l_xmii019_3_20,g_xmii3_d[l_ac].l_xmii023_3_20,20) THEN
         LET r_success = 'N'   
      END IF      
   END IF 
   IF NOT cl_null(g_xmii3_d[l_ac].l_xmii023_3_21) AND (g_xmii3_d[l_ac].l_xmii023_3_21 <> g_xmii3_d_t.l_xmii023_3_21 OR g_xmii3_d_t.l_xmii023_3_21 IS NULL) THEN
      IF NOT axmt175_upd_xmii023_3(g_xmii3_d[l_ac].l_xmii019_3_21,g_xmii3_d[l_ac].l_xmii023_3_21,21) THEN
         LET r_success = 'N'   
      END IF 
   END IF  
   IF NOT cl_null(g_xmii3_d[l_ac].l_xmii023_3_22) AND (g_xmii3_d[l_ac].l_xmii023_3_22 <> g_xmii3_d_t.l_xmii023_3_22 OR g_xmii3_d_t.l_xmii023_3_22 IS NULL) THEN
      IF NOT axmt175_upd_xmii023_3(g_xmii3_d[l_ac].l_xmii019_3_22,g_xmii3_d[l_ac].l_xmii023_3_22,22) THEN
         LET r_success = 'N'   
      END IF 
   END IF  
   IF NOT cl_null(g_xmii3_d[l_ac].l_xmii023_3_23) AND (g_xmii3_d[l_ac].l_xmii023_3_23 <> g_xmii3_d_t.l_xmii023_3_23 OR g_xmii3_d_t.l_xmii023_3_23 IS NULL) THEN
      IF NOT axmt175_upd_xmii023_3(g_xmii3_d[l_ac].l_xmii019_3_23,g_xmii3_d[l_ac].l_xmii023_3_23,23) THEN
         LET r_success = 'N'   
      END IF 
   END IF  
   IF NOT cl_null(g_xmii3_d[l_ac].l_xmii023_3_24) AND (g_xmii3_d[l_ac].l_xmii023_3_24 <> g_xmii3_d_t.l_xmii023_3_24 OR g_xmii3_d_t.l_xmii023_3_24 IS NULL) THEN
      IF NOT axmt175_upd_xmii023_3(g_xmii3_d[l_ac].l_xmii019_3_24,g_xmii3_d[l_ac].l_xmii023_3_24,24) THEN
         LET r_success = 'N'   
      END IF 
   END IF 
   RETURN r_success
END FUNCTION]]>
  </point>
  <point name="function.axmt175_upd_xmii023" order="12" ver="1" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 修改調整數量
# Memo...........:
# Usage..........: CALL axmt175_upd_xmii023(p_xmii023,p_xmii014)
#                  RETURNING TRUE/FALSE
# Input parameter: p_xmii023      數量
#                : p_xmii014      期別
# Return code....: TRUE/FALSE    
# Date & Author..: 日期 By 作者
# Modify.........:
################################################################################
PRIVATE FUNCTION axmt175_upd_xmii023(p_xmii023,p_xmii014)
DEFINE  p_xmii023     LIKE xmii_t.xmii023
DEFINE  p_xmii014     LIKE xmii_t.xmii014
   UPDATE xmii_t SET xmii023 = p_xmii023
    WHERE xmiient = g_enterprise
      AND xmii001 = g_xmih_m.xmih001
      AND xmii002 = g_xmih_m.xmih002
      AND xmii003 = g_xmih_m.xmih003
      AND xmii004 = g_xmih_m.xmih004
      AND xmii005 = g_xmii2_d_t.xmii005  
      AND xmii006 = g_xmii2_d_t.xmii006
      AND xmii007 = g_xmii2_d_t.xmii007
      AND xmii008 = g_xmii2_d_t.xmii008
      AND xmii009 = g_xmii2_d_t.xmii009
      AND xmii010 = g_xmii2_d_t.xmii010
      AND xmii011 = g_xmii2_d_t.xmii011
      AND xmii012 = g_xmii2_d_t.xmii012
      AND xmii013 = g_xmii2_d_t.xmii013
      AND xmii014 = p_xmii014
      AND xmii017 = g_xmii2_d_t.xmii017      
   IF SQLCA.sqlcode THEN 
      CALL cl_err("xmii_t",SQLCA.sqlcode,1)
      RETURN FALSE
   END IF      
   RETURN TRUE  
END FUNCTION]]>
  </point>
  <point name="function.axmt175_upd_xmii023_3" order="13" ver="1" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 修改調整數量/金額
# Memo...........:
# Usage..........: axmt175_upd_xmii023_3(p_xmii019,p_xmii023,p_xmii014)
#                  RETURNING TRUE/FALSE
# Input parameter: p_xmii019      調整數量
#                : p_xmii023      調整金額
#                : p_xmii014      期別
# Return code....: TRUE/FALSE    
# Date & Author..: 日期 By 作者
# Modify.........:
################################################################################
PRIVATE FUNCTION axmt175_upd_xmii023_3(p_xmii019,p_xmii023,p_xmii014)
DEFINE  p_xmii019     LIKE xmii_t.xmii019
DEFINE  p_xmii023     LIKE xmii_t.xmii023
DEFINE  p_xmii014     LIKE xmii_t.xmii014
   UPDATE xmii_t SET xmii023 = p_xmii023
    WHERE xmiient = g_enterprise
      AND xmii001 = g_xmih_m.xmih001
      AND xmii002 = g_xmih_m.xmih002
      AND xmii003 = g_xmih_m.xmih003
      AND xmii004 = g_xmih_m.xmih004
      AND xmii005 = g_xmii3_d_t.xmii005  
      AND xmii006 = g_xmii3_d_t.xmii006
      AND xmii007 = g_xmii3_d_t.xmii007
      AND xmii008 = g_xmii3_d_t.xmii008
      AND xmii009 = g_xmii3_d_t.xmii009
      AND xmii010 = g_xmii3_d_t.xmii010
      AND xmii011 = g_xmii3_d_t.xmii011
      AND xmii012 = g_xmii3_d_t.xmii012
      AND xmii013 = g_xmii3_d_t.xmii013
      AND xmii014 = p_xmii014
      AND xmii017 = g_xmii3_d_t.xmii017      
   IF SQLCA.sqlcode THEN 
      CALL cl_err("xmii_t",SQLCA.sqlcode,1)
      RETURN FALSE
   END IF      
   RETURN TRUE 
END FUNCTION]]>
  </point>
  <point name="function.axmt175_xmii006_desc" order="14" ver="1" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 帶出說明欄位
# Memo...........:
# Usage..........: CALL axmt175_xmii006_desc(p_xmii006)
#                  RETURNING p_xmii006_desc
# Input parameter: p_xmii006        營運據點編號
# Return code....: p_xmii006_desc   說明
# Date & Author..: 日期 By lixh
# Modify.........:
################################################################################
PRIVATE FUNCTION axmt175_xmii006_desc(p_xmii006)
DEFINE  p_xmii006        LIKE xmii_t.xmii006
DEFINE  p_xmii006_desc   LIKE type_t.chr500
    INITIALIZE g_ref_fields TO NULL
    LET g_ref_fields[1] = p_xmii006
    CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
    LET p_xmii006_desc = '', g_rtn_fields[1] , ''
    RETURN p_xmii006_desc
END FUNCTION]]>
  </point>
  <point name="function.axmt175_desc_date" order="15" ver="1" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 獲取計算期間
# Memo...........:
# Usage..........: CALL axmt175_desc_date()
# Date & Author..: 日期 By lixh
# Modify.........:
################################################################################
PRIVATE FUNCTION axmt175_desc_date()
DEFINE   l_yy       LIKE type_t.num5
DEFINE   l_mm       LIKE type_t.num5
DEFINE   l_dd       LIKE type_t.num5
DEFINE   l_dd_1     LIKE type_t.num5
DEFINE   l_ac       LIKE type_t.num5
DEFINE   l_e_date   LIKE type_t.chr80
DEFINE   l_sql      STRING

   IF cl_null(g_xmih_m.xmih001) OR cl_null(g_xmih_m.xmih002) THEN
      RETURN
   END IF

   LET l_sql = " SELECT xmib002,xmib003 FROM xmib_t",
               "  WHERE xmibent = '",g_enterprise,"'",
               "    AND xmib001 = '",g_xmih_m.xmih001,"'"
   PREPARE axmt174_xmib002 FROM l_sql
   DECLARE axmt174_xmib002_cur CURSOR FOR axmt174_xmib002
   CALL g_xmib.clear()
   LET l_ac = 1
   LET g_xmib[l_ac].b_date = g_xmih_m.xmih002
   FOREACH axmt174_xmib002_cur INTO g_xmib[l_ac].xmib002,g_xmib[l_ac].xmib003
      IF g_xmib[l_ac].xmib002 = 1 THEN
         LET g_xmib[l_ac].b_date = g_xmih_m.xmih002
         LET l_yy = YEAR(g_xmib[l_ac].b_date)
         LET l_mm = MONTH(g_xmib[l_ac].b_date)
         LET l_dd = DAY(g_xmib[l_ac].b_date) 
         IF g_xmib[l_ac].xmib003 = '1' THEN   #周
            IF l_dd = 1 THEN
               LET g_xmib[l_ac].e_date = g_xmib[l_ac].b_date + 6
            END IF
            IF l_dd = 8 OR l_dd = 16 THEN
               LET g_xmib[l_ac].e_date = g_xmib[l_ac].b_date + 7
            END IF
            IF l_dd = 24 THEN
               CALL s_date_get_last_date(g_xmib[l_ac].b_date) RETURNING g_xmib[l_ac].e_date
            END IF 
         END IF
         IF g_xmib[l_ac].xmib003 = '2' THEN   #旬
            IF l_dd = 1 THEN
               LET g_xmib[l_ac].e_date = MDY(l_mm,10,l_yy)
            END IF
            IF l_dd = 11 THEN
               LET g_xmib[l_ac].e_date = MDY(l_mm,20,l_yy)
            END IF
            IF l_dd = 21 THEN
               CALL s_date_get_last_date(g_xmib[l_ac].b_date) RETURNING g_xmib[l_ac].e_date
            END IF
         END IF
         IF g_xmib[l_ac].xmib003 = '3' THEN   #月
            IF l_dd = 1 THEN
               CALL s_date_get_last_date(g_xmib[l_ac].b_date) RETURNING g_xmib[l_ac].e_date
            ELSE 
               IF l_mm = 12 THEN
                  LET l_yy = l_yy +1
                  LET l_mm = 1
               ELSE
                  LET l_mm = l_mm + 1
               END IF               
               LET g_xmib[l_ac].e_date = MDY(l_mm,l_dd-1,l_yy)
            END IF                      
         END IF
      ELSE
         LET l_yy = YEAR(g_xmib[l_ac-1].e_date)
         LET l_mm = MONTH(g_xmib[l_ac-1].e_date)
         LET l_dd = DAY(g_xmib[l_ac-1].e_date)
         IF g_xmib[l_ac].xmib003 = '1' THEN   #周 
            IF l_dd > 23 THEN
               IF l_mm = 12 THEN
                  LET l_yy = l_yy + 1
                  LET l_mm = 1
               ELSE    
                  LET l_mm = l_mm + 1
               END IF                    
               LET g_xmib[l_ac].b_date = MDY(l_mm,1,l_yy)
               LET g_xmib[l_ac].e_date = MDY(l_mm,7,l_yy)
            END IF 
            IF l_dd = 7 THEN
               LET g_xmib[l_ac].b_date = MDY(l_mm,8,l_yy)
               LET g_xmib[l_ac].e_date = MDY(l_mm,15,l_yy)
            END IF
            IF l_dd = 15 THEN
               LET g_xmib[l_ac].b_date = MDY(l_mm,16,l_yy)
               LET g_xmib[l_ac].e_date = MDY(l_mm,23,l_yy)
            END IF
            IF l_dd = 23 THEN
               LET g_xmib[l_ac].b_date = MDY(l_mm,24,l_yy)
               CALL s_date_get_last_date(g_xmib[l_ac].b_date) RETURNING g_xmib[l_ac].e_date
            END IF
         END IF
         IF g_xmib[l_ac].xmib003 = '2' THEN   #旬
            IF l_dd > 20 THEN
               IF l_mm = 12 THEN
                  LET l_yy = l_yy + 1
                  LET l_mm = 1
               ELSE
                 LET l_mm = l_mm + 1                
               END IF
               LET g_xmib[l_ac].b_date = MDY(l_mm,1,l_yy)
               LET g_xmib[l_ac].e_date = MDY(l_mm,10,l_yy)
            END IF
            IF l_dd = 10 THEN
               LET g_xmib[l_ac].b_date = MDY(l_mm,11,l_yy)
               LET g_xmib[l_ac].e_date = MDY(l_mm,20,l_yy)
            END IF
            IF l_dd = 20 THEN
               LET g_xmib[l_ac].b_date = MDY(l_mm,21,l_yy)
               CALL s_date_get_last_date(g_xmib[l_ac].b_date) RETURNING g_xmib[l_ac].e_date
            END IF
         END IF

         IF g_xmib[l_ac].xmib003 = '3' THEN   #月
            CALL s_date_get_last_date(g_xmib[l_ac-1].e_date) RETURNING l_e_date
            IF g_xmib[l_ac-1].e_date = l_e_date THEN   #最後一天
               LET l_dd = 1 
            END IF   
            IF l_dd = 1 THEN
               IF l_mm = 12 THEN
                  LET l_yy = l_yy + 1
                  LET l_mm = 1
               ELSE
                  LET l_mm = l_mm + 1             
               END IF
               LET g_xmib[l_ac].b_date = MDY(l_mm,1,l_yy)
               CALL s_date_get_last_date(g_xmib[l_ac].b_date) RETURNING g_xmib[l_ac].e_date
            ELSE
               LET g_xmib[l_ac].b_date = MDY(l_mm,l_dd+1,l_yy)
               IF l_mm = 12 THEN
                  LET l_yy = l_yy + 1
                  LET l_mm = 1
               ELSE
                  LET l_mm = l_mm + 1                  
               END IF
               LET g_xmib[l_ac].e_date = MDY(l_mm,l_dd,l_yy)
            END IF
         END IF               
      END IF
      LET l_ac = l_ac + 1
   END FOREACH
   CALL g_xmib.deleteElement(g_xmib.getLength()) 
END FUNCTION]]>
  </point>
  <point name="function.axmt175_xmii008_desc" order="16" ver="1" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 描述说明
# Memo...........:
# Usage..........: CALL axmt175_xmii008_desc(p_xmii008)
#                  RETURNING p_xmii008_desc
# Input parameter: p_xmii008   传入参数变量说明1
# Return code....: p_xmii008_desc   回传参数变量说明1
# Date & Author..: 日期 By lixh
# Modify.........:
################################################################################
PRIVATE FUNCTION axmt175_xmii008_desc(p_xmii008)
DEFINE  p_xmii008         LIKE xmii_t.xmii008
DEFINE  p_xmii008_desc    LIKE type_t.chr500
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = p_xmii008
            CALL ap_ref_array2(g_ref_fields,"SELECT oofa011 FROM oofa_t WHERE oofaent='"||g_enterprise||"' AND oofa002 = '2' AND oofa003 =? ","") RETURNING g_rtn_fields
            LET p_xmii008_desc = '', g_rtn_fields[1] , ''
            RETURN p_xmii008_desc
END FUNCTION]]>
  </point>
  <point name="function.axmt175_xmii012_desc" order="17" ver="1" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 描述说明
# Memo...........:
# Usage..........: CALL axmt175_xmii012_desc(p_xmii012)
#                  RETURNING p_xmii012_desc
# Input parameter: p_xmii012   传入参数变量说明1
# Return code....: p_xmii012_desc   回传参数变量说明1
# Date & Author..: 日期 By lixh
# Modify.........:
################################################################################
PRIVATE FUNCTION axmt175_xmii012_desc(p_xmii012)
DEFINE    p_xmii012        LIKE xmii_t.xmii012
DEFINE    p_xmii012_desc   LIKE type_t.chr500
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = p_xmii012
            CALL ap_ref_array2(g_ref_fields,"SELECT pmaal004 FROM pmaal_t WHERE pmaalent='"||g_enterprise||"' AND pmaal001=? AND pmaal002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET p_xmii012_desc = '', g_rtn_fields[1] , ''
            RETURN p_xmii012_desc
END FUNCTION]]>
  </point>
  <point name="function.axmt175_xmii013_desc" order="18" ver="1" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 描述说明
# Memo...........:
# Usage..........: CALL axmt175_xmii013_desc(p_xmii013)
#                  RETURNING p_xmii013_desc
# Input parameter: p_xmii013        传入参数变量说明1
# Return code....: p_xmii013_desc   回传参数变量说明1
# Date & Author..: 日期 By 作者
# Modify.........:
################################################################################
PRIVATE FUNCTION axmt175_xmii013_desc(p_xmii013)
DEFINE   p_xmii013        LIKE xmii_t.xmii013
DEFINE   p_xmii013_desc   LIKE type_t.chr500
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = p_xmii013
            CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocq001='275' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET p_xmii013_desc = '', g_rtn_fields[1] , ''
            RETURN p_xmii013_desc 
END FUNCTION]]>
  </point>
  <point name="function.axmt175_xmii009_desc" order="19" ver="1" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 描述说明
# Memo...........:
# Usage..........: CALL axmt175_xmii009_desc(p_xmii009)
#                  RETURNING p_xmii009_desc
# Input parameter: p_xmii009        传入参数变量说明1
# Return code....: p_xmii009_desc   回传参数变量说明1
# Date & Author..: 日期 By lixh
# Modify.........:
################################################################################
PRIVATE FUNCTION axmt175_xmii009_desc(p_xmii009)
DEFINE    p_xmii009        LIKE xmii_t.xmii009
DEFINE    p_xmii009_desc   LIKE type_t.chr500
DEFINE    p_xmii009_desc_1 LIKE type_t.chr500
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = p_xmii009
            CALL ap_ref_array2(g_ref_fields,"SELECT imaal003,imaal004 FROM imaal_t WHERE imaalent='"||g_enterprise||"' AND imaal001=? AND imaal002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET p_xmii009_desc = '', g_rtn_fields[1] , ''
            LET p_xmii009_desc_1 = '', g_rtn_fields[2] , ''
            RETURN p_xmii009_desc,p_xmii009_desc_1 
END FUNCTION]]>
  </point>
  <point name="function.axmt175_xmii017_desc" order="20" ver="1" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 描述说明
# Memo...........:
# Usage..........: CALL axmt175_xmii017_desc(p_xmii017)
#                  RETURNING p_xmii017_desc
# Input parameter: p_xmii017   传入参数变量说明1
# Return code....: p_xmii017_desc   回传参数变量说明1
# Date & Author..: 日期 By lixh
# Modify.........:
################################################################################
PRIVATE FUNCTION axmt175_xmii017_desc(p_xmii017)
DEFINE   p_xmii017        LIKE xmii_t.xmii017
DEFINE   p_xmii017_desc   LIKE type_t.chr500
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = p_xmii017
            CALL ap_ref_array2(g_ref_fields,"SELECT oocal003 FROM oocal_t WHERE oocalent='"||g_enterprise||"' AND oocal001=? AND oocal002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET p_xmii017_desc = '', g_rtn_fields[1] , ''
            RETURN p_xmii017_desc
END FUNCTION]]>
  </point>
  <point name="function.axmt175_conf_chk" order="21" ver="1" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 描述说明
# Memo...........:
# Usage..........: CALL axmt175_conf_chk()
#                  RETURNING 回传参数
# Input parameter: 传入参数变量1   传入参数变量说明1
#                : 传入参数变量2   传入参数变量说明2
# Return code....: 回传参数变量1   回传参数变量说明1
#                : 回传参数变量2   回传参数变量说明2
# Date & Author..: 日期 By lixh
# Modify.........:
################################################################################
PRIVATE FUNCTION axmt175_conf_chk()
DEFINE  l_gzze001        LIKE gzze_t.gzze001
DEFINE  r_success        LIKE type_t.num5
  LET r_success = TRUE
  IF cl_null(g_xmih_m.xmih001) OR  cl_null(g_xmih_m.xmih002) OR cl_null(g_xmih_m.xmih003) OR cl_null(g_xmih_m.xmih004)  THEN     
      LET r_success = FALSE
      LET l_gzze001 = 'axm-00202'
      RETURN r_success,l_gzze001
   END IF
   IF g_xmih_m.xmihstus <> 'N' THEN
      LET r_success = FALSE
      LET l_gzze001 = 'axm-00203'
      RETURN r_success,l_gzze001  
   END IF
   RETURN TRUE,''
END FUNCTION]]>
  </point>
  <point name="function.axmt175_conf_upd" order="22" ver="1" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 描述说明
# Memo...........:
# Usage..........: CALL axmt175_conf_upd()
#                  RETURNING 回传参数
# Input parameter: 传入参数变量1   传入参数变量说明1
#                : 传入参数变量2   传入参数变量说明2
# Return code....: 回传参数变量1   回传参数变量说明1
#                : 回传参数变量2   回传参数变量说明2
# Date & Author..: 日期 By lixh
# Modify.........:
################################################################################
PRIVATE FUNCTION axmt175_conf_upd()
DEFINE     l_xmig      RECORD LIKE xmig_t.*
DEFINE     l_i         LIKE type_t.num5
DEFINE     l_sql       STRING 
DEFINE     l_xmia009   LIKE xmia_t.xmia009   
DEFINE     r_success   LIKE type_t.num5
DEFINE     l_time      DATETIME YEAR TO SECOND

   LET r_success = TRUE
   SELECT xmia009 INTO l_xmia009 FROM xmia_t
    WHERE xmiaent = g_enterprise
      AND xmia001 = g_xmih_m.xmih001
     
   IF l_xmia009 = 'N' THEN
   LET l_sql = " SELECT xmiient,xmii006,xmii001,xmii002,xmii003,xmii007,xmii008,xmii009,xmii010,xmii012, ",
               "        xmii013,xmii014,xmii015,xmii016,xmii018,xmii018,xmii021,xmii022,xmii020,'1',xmii017 ",
               "   FROM xmii_t ",
               "  WHERE xmiient = '",g_enterprise,"'",
               "    AND xmii001 = '",g_xmih_m.xmih001,"'",
               "    AND xmii002 = '",g_xmih_m.xmih002,"'",
               "    AND xmii003 = '",g_xmih_m.xmih003,"'",
               "    AND xmii004 = '",g_xmih_m.xmih004,"'"  
   PREPARE axmt175_xmig_pb FROM l_sql
   DECLARE axmt175_xmig_ins CURSOR FOR axmt175_xmig_pb
   FOREACH axmt175_xmig_ins INTO l_xmig.*  
      IF SQLCA.sqlcode THEN
         LET r_success = FALSE
         RETURN r_success
         EXIT FOREACH
      END IF
      INSERT INTO xmig_t
                  (xmigent,
                  xmigsite,xmig001,xmig002,xmig003,
                  xmig004,xmig005,xmig006,xmig007,xmig008,xmig009,xmig010,xmig011,
                  xmig012,xmig013,xmig014,xmig015,xmig016,xmig017,xmig018)
           VALUES (g_enterprise,l_xmig.xmigsite,l_xmig.xmig001,l_xmig.xmig002,l_xmig.xmig003,l_xmig.xmig004,l_xmig.xmig005,l_xmig.xmig006,l_xmig.xmig007,
                  l_xmig.xmig008,l_xmig.xmig009,l_xmig.xmig010, l_xmig.xmig011,l_xmig.xmig012,l_xmig.xmig013,l_xmig.xmig014,l_xmig.xmig015,
                  l_xmig.xmig016,l_xmig.xmig017,l_xmig.xmig018)
      IF SQLCA.sqlcode THEN
         LET r_success = FALSE
         CALL cl_err('',SQLCA.sqlcode,1)
         RETURN r_success
         EXIT FOREACH 
      END IF   
   END FOREACH   
   END IF  
   LET l_time = cl_get_current() 
   UPDATE xmih_t SET xmihstus = 'N',
                     xmihcnfid = g_user,
                     xmihcnfdt = l_time
    WHERE xmihent = g_enterprise
      AND xmih001 = g_xmih_m.xmih001
      AND xmih002 = g_xmih_m.xmih002
      AND xmih003 = g_xmih_m.xmih003
      AND xmih004 = g_xmih_m.xmih004

   IF SQLCA.sqlerrd[3] = 0 THEN
      LET r_success = FALSE
   END IF   
   RETURN r_success    
END FUNCTION]]>
  </point>
  <point name="function.axmt175_unconf_chk" order="23" ver="1" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 描述说明
# Memo...........:
# Usage..........: CALL axmt175_unconf_chk()
# Input parameter: 传入参数变量1   传入参数变量说明1
#                : 传入参数变量2   传入参数变量说明2
# Return code....: 回传参数变量1   回传参数变量说明1
#                : 回传参数变量2   回传参数变量说明2
# Date & Author..: 日期 By lixh
# Modify.........:
################################################################################
PRIVATE FUNCTION axmt175_unconf_chk()
DEFINE   l_gzze001     LIKE gzze_t.gzze001
DEFINE   r_success     LIKE type_t.num5
   IF cl_null(g_xmih_m.xmih001) OR cl_null(g_xmih_m.xmih002) OR cl_null(g_xmih_m.xmih003) OR cl_null(g_xmih_m.xmih004) THEN
      LET r_success = FALSE
      LET l_gzze001 = 'axm-00234'            
   END IF      
   IF g_xmih_m.xmihstus <> 'Y' THEN
      LET r_success = FALSE
      LET l_gzze001 = 'axm-00235' 
   END IF    
   RETURN TRUE,''  
END FUNCTION]]>
  </point>
  <point name="function.axmt175_unconf_upd" order="24" ver="1" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 描述说明
# Memo...........:
# Usage..........: CALL axmt175_unconf_upd()
#                  RETURNING 回传参数
# Input parameter: 传入参数变量1   传入参数变量说明1
#                : 传入参数变量2   传入参数变量说明2
# Return code....: 回传参数变量1   回传参数变量说明1
#                : 回传参数变量2   回传参数变量说明2
# Date & Author..: 日期 By lixh
# Modify.........:
################################################################################
PRIVATE FUNCTION axmt175_unconf_upd()
DEFINE  r_success        LIKE type_t.num5
DEFINE  l_xmia009        LIKE xmia_t.xmia009
DEFINE  l_time           DATETIME YEAR TO SECOND

   LET r_success = TRUE
   #检查:应在事物中的
   IF NOT s_transaction_chk('Y','0') THEN
      LET r_success = FALSE
      RETURN r_success
   END IF
  
   UPDATE xmih_t SET xmihstus = 'N',
                     xmihcnfid = '',
                     xmihcnfdt = ''
    WHERE xmihent = g_enterprise
      AND xmih001 = g_xmih_m.xmih001
      AND xmih002 = g_xmih_m.xmih002
      AND xmih003 = g_xmih_m.xmih003
      AND xmih004 = g_xmih_m.xmih004

   IF SQLCA.sqlerrd[3] = 0 THEN
      LET r_success = FALSE
   END IF
   SELECT xmia009 INTO l_xmia009 FROM xmia_t
    WHERE xmiaent = g_enterprise
      AND xmia001 = g_xmih_m.xmih001
   IF l_xmia009 = 'N' THEN   
      DELETE FROM xmig_t WHERE xmigent = g_enterprise
                           AND xmigsite = g_xmih_m.xmih004
                           AND xmig001 =  g_xmih_m.xmih001
                           AND xmig002 =  g_xmih_m.xmih002
                           AND xmig003 =  g_xmih_m.xmih003
                           AND xmig004 =  g_xmih_m.xmih004

      IF SQLCA.sqlerrd[3] = 0 THEN
         LET r_success = FALSE
      END IF  
   END IF      
   RETURN r_success 
END FUNCTION]]>
  </point>
  <point name="function.axmt175_closed_chk" order="25" ver="1" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 描述说明
# Memo...........:
# Usage..........: CALL axmt175_closed_chk()
#                  RETURNING 回传参数
# Input parameter: 传入参数变量1   传入参数变量说明1
#                : 传入参数变量2   传入参数变量说明2
# Return code....: 回传参数变量1   回传参数变量说明1
#                : 回传参数变量2   回传参数变量说明2
# Date & Author..: 日期 By lixh
# Modify.........:
################################################################################
PRIVATE FUNCTION axmt175_closed_chk()
DEFINE   l_gzze001     LIKE gzze_t.gzze001
DEFINE   r_success     LIKE type_t.num5
   IF cl_null(g_xmih_m.xmih001) OR cl_null(g_xmih_m.xmih002) OR cl_null(g_xmih_m.xmih003) OR cl_null(g_xmih_m.xmih004) THEN
      LET r_success = FALSE
      LET l_gzze001 = 'axm-00234'            
   END IF      
   IF g_xmih_m.xmihstus <> 'Y' THEN
      LET r_success = FALSE
      LET l_gzze001 = 'axm-00236' 
   END IF    
   RETURN TRUE,'' 
END FUNCTION]]>
  </point>
  <point name="function.axmt175_closed_upd" order="26" ver="1" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 描述说明
# Memo...........:
# Usage..........: CALL axmt175_closed_upd()
#                  RETURNING 回传参数
# Input parameter: 传入参数变量1   传入参数变量说明1
#                : 传入参数变量2   传入参数变量说明2
# Return code....: 回传参数变量1   回传参数变量说明1
#                : 回传参数变量2   回传参数变量说明2
# Date & Author..: 日期 By 作者
# Modify.........:
################################################################################
PRIVATE FUNCTION axmt175_closed_upd()
DEFINE  r_success        LIKE type_t.num5
   LET r_success = TRUE
   #检查:应在事物中的
   IF NOT s_transaction_chk('Y','0') THEN
      LET r_success = FALSE
      RETURN r_success
   END IF   
   UPDATE xmih_t SET xmihstus = 'C' 
    WHERE xmihent = g_enterprise
      AND xmih001 = g_xmih_m.xmih001
      AND xmih002 = g_xmih_m.xmih002
      AND xmih003 = g_xmih_m.xmih003
      AND xmih004 = g_xmih_m.xmih004

   IF SQLCA.sqlerrd[3] = 0 THEN
      LET r_success = FALSE
   END IF
   RETURN r_success   
END FUNCTION]]>
  </point>
  <point name="function.axmt175_sum_xmii" order="27" ver="1" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 描述说明
# Memo...........:
# Usage..........: CALL axmt175_sum_xmii(p_xmii014)
#                  RETURNING 回传参数
# Input parameter: 传入参数变量1   传入参数变量说明1
#                : 传入参数变量2   传入参数变量说明2
# Return code....: 回传参数变量1   回传参数变量说明1
#                : 回传参数变量2   回传参数变量说明2
# Date & Author..: 日期 By lixh
# Modify.........:
################################################################################
PRIVATE FUNCTION axmt175_sum_xmii(p_xmii014)
DEFINE  p_xmii014       LIKE xmii_t.xmii011
DEFINE  l_sum_xmii018   LIKE xmii_t.xmii018
DEFINE  l_sum_xmii019   LIKE xmii_t.xmii019
DEFINE  l_sum_xmii022   LIKE xmii_t.xmii022
DEFINE  l_sum_xmii023   LIKE xmii_t.xmii023
DEFINE  l_sql           STRING

   LET l_sql = "SELECT SUM(xmii018),SUM(xmii019),SUM(xmii022),SUM(xmii023) FROM xmii_t",
               " WHERE xmiient = '",g_enterprise,"'",
               "   AND xmii001 = '",g_xmih_m.xmih001,"'",
               "   AND xmii002 = '",g_xmih_m.xmih002,"'",
               "   AND xmii003 = '",g_xmih_m.xmih003,"'",
               "   AND xmii004 = '",g_xmih_m.xmih005,"'",
               "   AND xmii014 = ?"
   PREPARE axmt175_sum_xmii018 FROM l_sql     
   LET l_sum_xmii018 = 0
   LET l_sum_xmii019 = 0
   LET l_sum_xmii022 = 0
   LET l_sum_xmii023 = 0   
   EXECUTE axmt175_sum_xmii018 USING p_xmii014 
                                INTO l_sum_xmii018,l_sum_xmii019,l_sum_xmii022,l_sum_xmii023
                                                                                              
   IF p_xmii014 = 1 THEN
      LET g_xmii4_d[l_ac].l_xmii018_4_01 = l_sum_xmii018
      LET g_xmii4_d[l_ac].l_xmii019_4_01 = l_sum_xmii019
      LET g_xmii6_d[l_ac].l_xmii022_6_01 = l_sum_xmii022
      LET g_xmii6_d[l_ac].l_xmii023_6_01 = l_sum_xmii023                  
   END IF   
   IF p_xmii014 = 2 THEN
      LET g_xmii4_d[l_ac].l_xmii018_4_02 = l_sum_xmii018
      LET g_xmii4_d[l_ac].l_xmii019_4_02 = l_sum_xmii019
      LET g_xmii6_d[l_ac].l_xmii022_6_02 = l_sum_xmii022
      LET g_xmii6_d[l_ac].l_xmii023_6_02 = l_sum_xmii023                    
   END IF         
   IF p_xmii014 = 3 THEN
      LET g_xmii4_d[l_ac].l_xmii018_4_03 = l_sum_xmii018
      LET g_xmii4_d[l_ac].l_xmii019_4_03 = l_sum_xmii019
      LET g_xmii6_d[l_ac].l_xmii022_6_03 = l_sum_xmii022
      LET g_xmii6_d[l_ac].l_xmii023_6_03 = l_sum_xmii023       
   END IF
   IF p_xmii014 = 4 THEN
      LET g_xmii4_d[l_ac].l_xmii018_4_04 = l_sum_xmii018
      LET g_xmii4_d[l_ac].l_xmii019_4_04 = l_sum_xmii019
      LET g_xmii6_d[l_ac].l_xmii022_6_04 = l_sum_xmii022
      LET g_xmii6_d[l_ac].l_xmii023_6_04 = l_sum_xmii023       
   END IF 
   IF p_xmii014 = 5 THEN
      LET g_xmii4_d[l_ac].l_xmii018_4_05 = l_sum_xmii018
      LET g_xmii4_d[l_ac].l_xmii019_4_05 = l_sum_xmii019
      LET g_xmii6_d[l_ac].l_xmii022_6_05 = l_sum_xmii022
      LET g_xmii6_d[l_ac].l_xmii023_6_05 = l_sum_xmii023        
   END IF 
   IF p_xmii014 = 6 THEN
      LET g_xmii4_d[l_ac].l_xmii018_4_06 = l_sum_xmii018
      LET g_xmii4_d[l_ac].l_xmii019_4_06 = l_sum_xmii019
      LET g_xmii6_d[l_ac].l_xmii022_6_06 = l_sum_xmii022
      LET g_xmii6_d[l_ac].l_xmii023_6_06 = l_sum_xmii023       
   END IF 
   IF p_xmii014 = 7 THEN
      LET g_xmii4_d[l_ac].l_xmii018_4_07 = l_sum_xmii018
      LET g_xmii4_d[l_ac].l_xmii019_4_07 = l_sum_xmii019
      LET g_xmii6_d[l_ac].l_xmii022_6_07 = l_sum_xmii022
      LET g_xmii6_d[l_ac].l_xmii023_6_07 = l_sum_xmii023       
   END IF 
   IF p_xmii014 = 8 THEN
      LET g_xmii4_d[l_ac].l_xmii018_4_08 = l_sum_xmii018
      LET g_xmii4_d[l_ac].l_xmii019_4_08 = l_sum_xmii019
      LET g_xmii6_d[l_ac].l_xmii022_6_08 = l_sum_xmii022
      LET g_xmii6_d[l_ac].l_xmii023_6_08 = l_sum_xmii023         
   END IF 
   IF p_xmii014 = 9 THEN
      LET g_xmii4_d[l_ac].l_xmii018_4_09 = l_sum_xmii018
      LET g_xmii4_d[l_ac].l_xmii019_4_09 = l_sum_xmii019
      LET g_xmii6_d[l_ac].l_xmii022_6_09 = l_sum_xmii022
      LET g_xmii6_d[l_ac].l_xmii023_6_09 = l_sum_xmii023        
   END IF 
   IF p_xmii014 = 10 THEN
      LET g_xmii4_d[l_ac].l_xmii018_4_10 = l_sum_xmii018
      LET g_xmii4_d[l_ac].l_xmii019_4_10 = l_sum_xmii019
      LET g_xmii6_d[l_ac].l_xmii022_6_10 = l_sum_xmii022
      LET g_xmii6_d[l_ac].l_xmii023_6_10 = l_sum_xmii023        
   END IF
   IF p_xmii014 = 11 THEN   
      LET g_xmii4_d[l_ac].l_xmii018_4_11 = l_sum_xmii018
      LET g_xmii4_d[l_ac].l_xmii019_4_11 = l_sum_xmii019
      LET g_xmii6_d[l_ac].l_xmii022_6_11 = l_sum_xmii022
      LET g_xmii6_d[l_ac].l_xmii023_6_11 = l_sum_xmii023    
   END IF 
   IF p_xmii014 = 12 THEN  
      LET g_xmii4_d[l_ac].l_xmii018_4_12 = l_sum_xmii018
      LET g_xmii4_d[l_ac].l_xmii019_4_12 = l_sum_xmii019
      LET g_xmii6_d[l_ac].l_xmii022_6_12 = l_sum_xmii022
      LET g_xmii6_d[l_ac].l_xmii023_6_12 = l_sum_xmii023       
   END IF   
   IF p_xmii014 = 13 THEN   
      LET g_xmii4_d[l_ac].l_xmii018_4_13 = l_sum_xmii018
      LET g_xmii4_d[l_ac].l_xmii019_4_13 = l_sum_xmii019
      LET g_xmii6_d[l_ac].l_xmii022_6_13 = l_sum_xmii022
      LET g_xmii6_d[l_ac].l_xmii023_6_13 = l_sum_xmii023        
   END IF
   IF p_xmii014 = 14 THEN   
      LET g_xmii4_d[l_ac].l_xmii018_4_14 = l_sum_xmii018
      LET g_xmii4_d[l_ac].l_xmii019_4_14 = l_sum_xmii019
      LET g_xmii6_d[l_ac].l_xmii022_6_14 = l_sum_xmii022
      LET g_xmii6_d[l_ac].l_xmii023_6_14 = l_sum_xmii023        
   END IF  
   IF p_xmii014 = 15 THEN 
      LET g_xmii4_d[l_ac].l_xmii018_4_15 = l_sum_xmii018
      LET g_xmii4_d[l_ac].l_xmii019_4_15 = l_sum_xmii019
      LET g_xmii6_d[l_ac].l_xmii022_6_15 = l_sum_xmii022
      LET g_xmii6_d[l_ac].l_xmii023_6_15 = l_sum_xmii023     
   END IF
   IF p_xmii014 = 16 THEN   
      LET g_xmii4_d[l_ac].l_xmii018_4_16 = l_sum_xmii018
      LET g_xmii4_d[l_ac].l_xmii019_4_16 = l_sum_xmii019
      LET g_xmii6_d[l_ac].l_xmii022_6_16 = l_sum_xmii022
      LET g_xmii6_d[l_ac].l_xmii023_6_16 = l_sum_xmii023        
   END IF
   IF p_xmii014 = 17 THEN   
      LET g_xmii4_d[l_ac].l_xmii018_4_17 = l_sum_xmii018
      LET g_xmii4_d[l_ac].l_xmii019_4_17 = l_sum_xmii019
      LET g_xmii6_d[l_ac].l_xmii022_6_17 = l_sum_xmii022
      LET g_xmii6_d[l_ac].l_xmii023_6_17 = l_sum_xmii023        
   END IF
   IF p_xmii014 = 18 THEN   
      LET g_xmii4_d[l_ac].l_xmii018_4_18 = l_sum_xmii018
      LET g_xmii4_d[l_ac].l_xmii019_4_18 = l_sum_xmii019
      LET g_xmii6_d[l_ac].l_xmii022_6_18 = l_sum_xmii022
      LET g_xmii6_d[l_ac].l_xmii023_6_18 = l_sum_xmii023       
   END IF
   IF p_xmii014 = 19 THEN   
      LET g_xmii4_d[l_ac].l_xmii018_4_19 = l_sum_xmii018
      LET g_xmii4_d[l_ac].l_xmii019_4_19 = l_sum_xmii019
      LET g_xmii6_d[l_ac].l_xmii022_6_19 = l_sum_xmii022
      LET g_xmii6_d[l_ac].l_xmii023_6_19 = l_sum_xmii023      
   END IF
   IF p_xmii014 = 20 THEN   
      LET g_xmii4_d[l_ac].l_xmii018_4_20 = l_sum_xmii018
      LET g_xmii4_d[l_ac].l_xmii019_4_20 = l_sum_xmii019
      LET g_xmii6_d[l_ac].l_xmii022_6_20 = l_sum_xmii022
      LET g_xmii6_d[l_ac].l_xmii023_6_20 = l_sum_xmii023       
   END IF   
   IF p_xmii014 = 21 THEN   
      LET g_xmii4_d[l_ac].l_xmii018_4_21 = l_sum_xmii018
      LET g_xmii4_d[l_ac].l_xmii019_4_21 = l_sum_xmii019
      LET g_xmii6_d[l_ac].l_xmii022_6_21 = l_sum_xmii022
      LET g_xmii6_d[l_ac].l_xmii023_6_21 = l_sum_xmii023        
   END IF      
   IF p_xmii014 = 22 THEN   
      LET g_xmii4_d[l_ac].l_xmii018_4_22 = l_sum_xmii018
      LET g_xmii4_d[l_ac].l_xmii019_4_22 = l_sum_xmii019
      LET g_xmii6_d[l_ac].l_xmii022_6_22 = l_sum_xmii022
      LET g_xmii6_d[l_ac].l_xmii023_6_22 = l_sum_xmii023        
   END IF      
   IF p_xmii014 = 23 THEN   
      LET g_xmii4_d[l_ac].l_xmii018_4_23 = l_sum_xmii018
      LET g_xmii4_d[l_ac].l_xmii019_4_23 = l_sum_xmii019
      LET g_xmii6_d[l_ac].l_xmii022_6_23 = l_sum_xmii022
      LET g_xmii6_d[l_ac].l_xmii023_6_23 = l_sum_xmii023      
   END IF 
   IF p_xmii014 = 24 THEN   
      LET g_xmii4_d[l_ac].l_xmii018_4_24 = l_sum_xmii018
      LET g_xmii4_d[l_ac].l_xmii019_4_24 = l_sum_xmii019
      LET g_xmii6_d[l_ac].l_xmii022_6_24 = l_sum_xmii022
      LET g_xmii6_d[l_ac].l_xmii023_6_24 = l_sum_xmii023      
   END IF       
END FUNCTION]]>
  </point>
  <point name="function.axmt175_sum_xmii_5" order="28" ver="1" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 描述说明
# Memo...........:
# Usage..........: CALL axmt175_sum_xmii_5(p_xmii014,p_xmii004)
#                  RETURNING 回传参数
# Input parameter: 传入参数变量1   传入参数变量说明1
#                : 传入参数变量2   传入参数变量说明2
# Return code....: 回传参数变量1   回传参数变量说明1
#                : 回传参数变量2   回传参数变量说明2
# Date & Author..: 日期 By lixh
# Modify.........:
################################################################################
PRIVATE FUNCTION axmt175_sum_xmii_5(p_xmii014,p_xmii004)
DEFINE  p_xmii014       LIKE xmii_t.xmii011
DEFINE  p_xmii004       LIKE xmii_t.xmii004
DEFINE  l_sum_xmii018   LIKE xmii_t.xmii018
DEFINE  l_sum_xmii019   LIKE xmii_t.xmii019
DEFINE  l_sql           STRING

   LET l_sql = "SELECT SUM(xmii018),SUM(xmii019) FROM xmii_t",
               " WHERE xmiient = '",g_enterprise,"'",
               "   AND xmii001 = '",g_xmih_m.xmih001,"'",
               "   AND xmii002 = '",g_xmih_m.xmih002,"'",
               "   AND xmii003 = '",g_xmih_m.xmih003,"'",
               "   AND xmii004 = '",p_xmii004,"'",
               "   AND xmii006 = '",g_xmii_d[l_ac].xmii006,"'",
               "   AND xmii007 = '",g_xmii_d[l_ac].xmii007,"'",
               "   AND xmii008 = '",g_xmii_d[l_ac].xmii008,"'",
               "   AND xmii009 = '",g_xmii_d[l_ac].xmii009,"'",
               "   AND xmii010 = '",g_xmii_d[l_ac].xmii010,"'",
               "   AND xmii011 = '",g_xmii_d[l_ac].xmii011,"'",
               "   AND xmii012 = '",g_xmii_d[l_ac].xmii012,"'",
               "   AND xmii013 = '",g_xmii_d[l_ac].xmii013,"'",
               "   AND xmii014 = ?"

   PREPARE axmt175_sum_5_xmii018 FROM l_sql     
   LET l_sum_xmii018 = 0
   LET l_sum_xmii019 = 0 
   EXECUTE axmt175_sum_5_xmii018 USING p_xmii014 
                                INTO l_sum_xmii018,l_sum_xmii019
                                                                                              
   IF p_xmii014 = 1 THEN
      LET g_xmii5_d[l_ac].l_xmii018_5_01 = l_sum_xmii018
      LET g_xmii5_d[l_ac].l_xmii019_5_01 = l_sum_xmii019                 
   END IF   
   IF p_xmii014 = 2 THEN
      LET g_xmii5_d[l_ac].l_xmii018_5_02 = l_sum_xmii018
      LET g_xmii5_d[l_ac].l_xmii019_5_02 = l_sum_xmii019                   
   END IF         
   IF p_xmii014 = 3 THEN
      LET g_xmii5_d[l_ac].l_xmii018_5_03 = l_sum_xmii018
      LET g_xmii5_d[l_ac].l_xmii019_5_03 = l_sum_xmii019      
   END IF
   IF p_xmii014 = 4 THEN
      LET g_xmii5_d[l_ac].l_xmii018_5_04 = l_sum_xmii018
      LET g_xmii5_d[l_ac].l_xmii019_5_04 = l_sum_xmii019      
   END IF 
   IF p_xmii014 = 5 THEN
      LET g_xmii5_d[l_ac].l_xmii018_5_05 = l_sum_xmii018
      LET g_xmii5_d[l_ac].l_xmii019_5_05 = l_sum_xmii019       
   END IF 
   IF p_xmii014 = 6 THEN
      LET g_xmii5_d[l_ac].l_xmii018_5_06 = l_sum_xmii018
      LET g_xmii5_d[l_ac].l_xmii019_5_06 = l_sum_xmii019      
   END IF 
   IF p_xmii014 = 7 THEN
      LET g_xmii5_d[l_ac].l_xmii018_5_07 = l_sum_xmii018
      LET g_xmii5_d[l_ac].l_xmii019_5_07 = l_sum_xmii019       
   END IF 
   IF p_xmii014 = 8 THEN
      LET g_xmii5_d[l_ac].l_xmii018_5_08 = l_sum_xmii018
      LET g_xmii5_d[l_ac].l_xmii019_5_08 = l_sum_xmii019        
   END IF 
   IF p_xmii014 = 9 THEN
      LET g_xmii5_d[l_ac].l_xmii018_5_09 = l_sum_xmii018
      LET g_xmii5_d[l_ac].l_xmii019_5_09 = l_sum_xmii019      
   END IF 
   IF p_xmii014 = 10 THEN
      LET g_xmii5_d[l_ac].l_xmii018_5_10 = l_sum_xmii018
      LET g_xmii5_d[l_ac].l_xmii019_5_10 = l_sum_xmii019       
   END IF
   IF p_xmii014 = 11 THEN   
      LET g_xmii5_d[l_ac].l_xmii018_5_11 = l_sum_xmii018
      LET g_xmii5_d[l_ac].l_xmii019_5_11 = l_sum_xmii019   
   END IF 
   IF p_xmii014 = 12 THEN  
      LET g_xmii5_d[l_ac].l_xmii018_5_12 = l_sum_xmii018
      LET g_xmii5_d[l_ac].l_xmii019_5_12 = l_sum_xmii019       
   END IF   
   IF p_xmii014 = 13 THEN   
      LET g_xmii5_d[l_ac].l_xmii018_5_13 = l_sum_xmii018
      LET g_xmii5_d[l_ac].l_xmii019_5_13 = l_sum_xmii019       
   END IF
   IF p_xmii014 = 14 THEN   
      LET g_xmii5_d[l_ac].l_xmii018_5_14 = l_sum_xmii018
      LET g_xmii5_d[l_ac].l_xmii019_5_14 = l_sum_xmii019      
   END IF  
   IF p_xmii014 = 15 THEN 
      LET g_xmii5_d[l_ac].l_xmii018_5_15 = l_sum_xmii018
      LET g_xmii5_d[l_ac].l_xmii019_5_15 = l_sum_xmii019    
   END IF
   IF p_xmii014 = 16 THEN   
      LET g_xmii5_d[l_ac].l_xmii018_5_16 = l_sum_xmii018
      LET g_xmii5_d[l_ac].l_xmii019_5_16 = l_sum_xmii019        
   END IF
   IF p_xmii014 = 17 THEN   
      LET g_xmii5_d[l_ac].l_xmii018_5_17 = l_sum_xmii018
      LET g_xmii5_d[l_ac].l_xmii019_5_17 = l_sum_xmii019       
   END IF
   IF p_xmii014 = 18 THEN   
      LET g_xmii5_d[l_ac].l_xmii018_5_18 = l_sum_xmii018
      LET g_xmii5_d[l_ac].l_xmii019_5_18 = l_sum_xmii019     
   END IF
   IF p_xmii014 = 19 THEN   
      LET g_xmii5_d[l_ac].l_xmii018_5_19 = l_sum_xmii018
      LET g_xmii5_d[l_ac].l_xmii019_5_19 = l_sum_xmii019    
   END IF
   IF p_xmii014 = 20 THEN   
      LET g_xmii5_d[l_ac].l_xmii018_5_20 = l_sum_xmii018
      LET g_xmii5_d[l_ac].l_xmii019_5_20 = l_sum_xmii019      
   END IF   
   IF p_xmii014 = 21 THEN   
      LET g_xmii5_d[l_ac].l_xmii018_5_21 = l_sum_xmii018
      LET g_xmii5_d[l_ac].l_xmii019_5_21 = l_sum_xmii019      
   END IF      
   IF p_xmii014 = 22 THEN   
      LET g_xmii5_d[l_ac].l_xmii018_5_22 = l_sum_xmii018
      LET g_xmii5_d[l_ac].l_xmii019_5_22 = l_sum_xmii019      
   END IF      
   IF p_xmii014 = 23 THEN   
      LET g_xmii5_d[l_ac].l_xmii018_5_23 = l_sum_xmii018
      LET g_xmii5_d[l_ac].l_xmii019_5_23 = l_sum_xmii019     
   END IF 
   IF p_xmii014 = 24 THEN   
      LET g_xmii5_d[l_ac].l_xmii018_5_24 = l_sum_xmii018
      LET g_xmii5_d[l_ac].l_xmii019_5_24 = l_sum_xmii019     
   END IF    
END FUNCTION]]>
  </point>
  <point name="function.axmt175_sum_xmii_7" order="29" ver="1" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 描述说明
# Memo...........:
# Usage..........: CALL axmt175_sum_xmii_7(p_xmii014,p_xmii004)
#                  RETURNING 回传参数
# Input parameter: 传入参数变量1   传入参数变量说明1
#                : 传入参数变量2   传入参数变量说明2
# Return code....: 回传参数变量1   回传参数变量说明1
#                : 回传参数变量2   回传参数变量说明2
# Date & Author..: 日期 By lixh
# Modify.........:
################################################################################
PRIVATE FUNCTION axmt175_sum_xmii_7(p_xmii014,p_xmii004)
DEFINE  p_xmii014       LIKE xmii_t.xmii011
DEFINE  l_sum_xmii022   LIKE xmii_t.xmii018
DEFINE  l_sum_xmii023   LIKE xmii_t.xmii019
DEFINE  p_xmii004       LIKE xmii_t.xmii004
DEFINE  l_sql           STRING

   LET l_sql = "SELECT SUM(xmii022),SUM(xmii023) FROM xmii_t",
               " WHERE xmiient = '",g_enterprise,"'",
               "   AND xmii001 = '",g_xmih_m.xmih001,"'",
               "   AND xmii002 = '",g_xmih_m.xmih002,"'",
               "   AND xmii003 = '",g_xmih_m.xmih003,"'",
               "   AND xmii004 = '",p_xmii004,"'",
               "   AND xmii006 = '",g_xmii_d[l_ac].xmii006,"'",
               "   AND xmii007 = '",g_xmii_d[l_ac].xmii007,"'",
               "   AND xmii008 = '",g_xmii_d[l_ac].xmii008,"'",
               "   AND xmii009 = '",g_xmii_d[l_ac].xmii009,"'",
               "   AND xmii010 = '",g_xmii_d[l_ac].xmii010,"'",
               "   AND xmii011 = '",g_xmii_d[l_ac].xmii011,"'",
               "   AND xmii012 = '",g_xmii_d[l_ac].xmii012,"'",
               "   AND xmii013 = '",g_xmii_d[l_ac].xmii013,"'",
               "   AND xmii014 = ?"

   PREPARE axmt175_sum_5_xmii022 FROM l_sql     
   LET l_sum_xmii022 = 0
   LET l_sum_xmii023 = 0  
   EXECUTE axmt175_sum_5_xmii022 USING p_xmii014 
                                INTO l_sum_xmii022,l_sum_xmii023
                                                                                              
   IF p_xmii014 = 1 THEN
      LET g_xmii7_d[l_ac].l_xmii022_7_01 = l_sum_xmii022
      LET g_xmii7_d[l_ac].l_xmii023_7_01 = l_sum_xmii023                 
   END IF   
   IF p_xmii014 = 2 THEN
      LET g_xmii7_d[l_ac].l_xmii022_7_02 = l_sum_xmii022
      LET g_xmii7_d[l_ac].l_xmii023_7_02 = l_sum_xmii023                   
   END IF         
   IF p_xmii014 = 3 THEN
      LET g_xmii7_d[l_ac].l_xmii022_7_03 = l_sum_xmii022
      LET g_xmii7_d[l_ac].l_xmii023_7_03 = l_sum_xmii023      
   END IF
   IF p_xmii014 = 4 THEN
      LET g_xmii7_d[l_ac].l_xmii022_7_04 = l_sum_xmii022
      LET g_xmii7_d[l_ac].l_xmii023_7_04 = l_sum_xmii023      
   END IF 
   IF p_xmii014 = 5 THEN
      LET g_xmii7_d[l_ac].l_xmii022_7_05 = l_sum_xmii022
      LET g_xmii7_d[l_ac].l_xmii023_7_05 = l_sum_xmii023       
   END IF 
   IF p_xmii014 = 6 THEN
      LET g_xmii7_d[l_ac].l_xmii022_7_06 = l_sum_xmii022
      LET g_xmii7_d[l_ac].l_xmii023_7_06 = l_sum_xmii023      
   END IF 
   IF p_xmii014 = 7 THEN
      LET g_xmii7_d[l_ac].l_xmii022_7_07 = l_sum_xmii022
      LET g_xmii7_d[l_ac].l_xmii023_7_07 = l_sum_xmii023       
   END IF 
   IF p_xmii014 = 8 THEN
      LET g_xmii7_d[l_ac].l_xmii022_7_08 = l_sum_xmii022
      LET g_xmii7_d[l_ac].l_xmii023_7_08 = l_sum_xmii023        
   END IF 
   IF p_xmii014 = 9 THEN
      LET g_xmii7_d[l_ac].l_xmii022_7_09 = l_sum_xmii022
      LET g_xmii7_d[l_ac].l_xmii023_7_09 = l_sum_xmii023      
   END IF 
   IF p_xmii014 = 10 THEN
      LET g_xmii7_d[l_ac].l_xmii022_7_10 = l_sum_xmii022
      LET g_xmii7_d[l_ac].l_xmii023_7_10 = l_sum_xmii023       
   END IF
   IF p_xmii014 = 11 THEN   
      LET g_xmii7_d[l_ac].l_xmii022_7_11 = l_sum_xmii022
      LET g_xmii7_d[l_ac].l_xmii023_7_11 = l_sum_xmii023   
   END IF 
   IF p_xmii014 = 12 THEN  
      LET g_xmii7_d[l_ac].l_xmii022_7_12 = l_sum_xmii022
      LET g_xmii7_d[l_ac].l_xmii023_7_12 = l_sum_xmii023       
   END IF   
   IF p_xmii014 = 13 THEN   
      LET g_xmii7_d[l_ac].l_xmii022_7_13 = l_sum_xmii022
      LET g_xmii7_d[l_ac].l_xmii023_7_13 = l_sum_xmii023       
   END IF
   IF p_xmii014 = 14 THEN   
      LET g_xmii7_d[l_ac].l_xmii022_7_14 = l_sum_xmii022
      LET g_xmii7_d[l_ac].l_xmii023_7_14 = l_sum_xmii023      
   END IF  
   IF p_xmii014 = 15 THEN 
      LET g_xmii7_d[l_ac].l_xmii022_7_15 = l_sum_xmii022
      LET g_xmii7_d[l_ac].l_xmii023_7_15 = l_sum_xmii023    
   END IF
   IF p_xmii014 = 16 THEN   
      LET g_xmii7_d[l_ac].l_xmii022_7_16 = l_sum_xmii022
      LET g_xmii7_d[l_ac].l_xmii023_7_16 = l_sum_xmii023        
   END IF
   IF p_xmii014 = 17 THEN   
      LET g_xmii7_d[l_ac].l_xmii022_7_17 = l_sum_xmii022
      LET g_xmii7_d[l_ac].l_xmii023_7_17 = l_sum_xmii023       
   END IF
   IF p_xmii014 = 18 THEN   
      LET g_xmii7_d[l_ac].l_xmii022_7_18 = l_sum_xmii022
      LET g_xmii7_d[l_ac].l_xmii023_7_18 = l_sum_xmii023     
   END IF
   IF p_xmii014 = 19 THEN   
      LET g_xmii7_d[l_ac].l_xmii022_7_19 = l_sum_xmii022
      LET g_xmii7_d[l_ac].l_xmii023_7_19 = l_sum_xmii023    
   END IF
   IF p_xmii014 = 20 THEN   
      LET g_xmii7_d[l_ac].l_xmii022_7_20 = l_sum_xmii022
      LET g_xmii7_d[l_ac].l_xmii023_7_20 = l_sum_xmii023      
   END IF   
   IF p_xmii014 = 21 THEN   
      LET g_xmii7_d[l_ac].l_xmii022_7_21 = l_sum_xmii022
      LET g_xmii7_d[l_ac].l_xmii023_7_21 = l_sum_xmii023      
   END IF      
   IF p_xmii014 = 22 THEN   
      LET g_xmii7_d[l_ac].l_xmii022_7_22 = l_sum_xmii022
      LET g_xmii7_d[l_ac].l_xmii023_7_22 = l_sum_xmii023      
   END IF      
   IF p_xmii014 = 23 THEN   
      LET g_xmii7_d[l_ac].l_xmii022_7_23 = l_sum_xmii022
      LET g_xmii7_d[l_ac].l_xmii023_7_23 = l_sum_xmii023     
   END IF 
   IF p_xmii014 = 24 THEN   
      LET g_xmii7_d[l_ac].l_xmii022_7_24 = l_sum_xmii022
      LET g_xmii7_d[l_ac].l_xmii023_7_24 = l_sum_xmii023     
   END IF 
END FUNCTION]]>
  </point>
  <point name="function.axmt175_xmii011_desc" order="30" ver="1" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 產品分類说明
# Memo...........:
# Usage..........: CALL axmt175_xmii011_desc(p_xmii011)
#                  RETURNING p_xmii011_desc
# Input parameter: 传入参数变量1   传入参数变量说明1
#                : 传入参数变量2   传入参数变量说明2
# Return code....: 回传参数变量1   回传参数变量说明1
#                : 回传参数变量2   回传参数变量说明2
# Date & Author..: 日期 By lixh
# Modify.........:
################################################################################
PRIVATE FUNCTION axmt175_xmii011_desc(p_xmii011)
DEFINE  p_xmii011        LIKE xmii_t.xmii011
DEFINE  p_xmii011_desc   LIKE type_t.chr500            
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = p_xmii011
            CALL ap_ref_array2(g_ref_fields,"SELECT rtaxl003 FROM rtaxl_t WHERE rtaxlent='"||g_enterprise||"' AND rtaxl001=? AND rtaxl002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET p_xmii011_desc = '', g_rtn_fields[1] , ''
            RETURN p_xmii011_desc
END FUNCTION]]>
  </point>
  <point name="function.axmt175_xmii007_desc" order="31" ver="1" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 描述说明
# Memo...........:
# Usage..........: CALL s_aooi150_ins (传入参数)
#                  RETURNING 回传参数
# Input parameter: 传入参数变量1   传入参数变量说明1
#                : 传入参数变量2   传入参数变量说明2
# Return code....: 回传参数变量1   回传参数变量说明1
#                : 回传参数变量2   回传参数变量说明2
# Date & Author..: 日期 By 作者
# Modify.........:
################################################################################
PRIVATE FUNCTION axmt175_xmii007_desc(p_xmii007)
DEFINE   p_xmii007       LIKE xmii_t.xmii007
DEFINE   r_xmii007_desc  LIKE type_t.chr500
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = p_xmii007
            CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET r_xmii007_desc = '', g_rtn_fields[1] , ''
            RETURN r_xmii007_desc
END FUNCTION]]>
  </point>
  <point name="b_fill.body.fill_sql" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[      LET g_sql = "SELECT  UNIQUE xmii005,xmii007,'',xmii006,'',xmii008,'',xmii012,'',xmii013,'',xmii011,'', 
          xmii009,'','',xmii010,xmii017,'',xmii014,xmii018,xmii019,'','','','','','','','','','','','','','','', 
          '','','','','','','','','','','','','','','','','','','','','','','','','','','','','','', 
          '','','',xmii005,xmii007,'',xmii006,'',xmii008,'',xmii012,'',xmii013,'',xmii011,'',xmii009,'', 
          '',xmii010,xmii017,'',xmii014,xmii022,xmii023,'','','','','','','','','','','','','','','','','','','','','','', 
          '','','','','','','','','','','','','','','','','','','','','','','','','','',xmii005,xmii007,'', 
          xmii006,'',xmii008,'',xmii012,'',xmii013,'',xmii011,'',xmii009,'','',xmii010,xmii017,'',xmii014, 
          xmii018,xmii019,'','','','','','','','','','','','','','','','','','','','','','','','','','','','', 
          '','','','','','','','','','','','','','','','','','','','',xmii022,xmii023,'','','','','','','','', 
          '','','','','','','','','','','','','','','','','','','','','','','','','','','','','','', 
          '','','','','','','','','','' FROM xmii_t",   
                  " INNER JOIN xmih_t ON xmih001 = xmii001 ",
                  " AND xmih002 = xmii002 ",
                  " AND xmih003 = xmii003 ",
                  " AND xmih004 = xmii004 ",
                  "",
                  " WHERE xmiient=? AND xmii001=? AND xmii002=? AND xmii003=? AND xmii004=?"
      IF NOT cl_null(g_wc2_table1) THEN
         LET g_sql = g_sql CLIPPED, " AND ", g_wc2_table1 CLIPPED
      END IF                  
      LET g_sql = g_sql, " ORDER BY xmii_t.xmii006,xmii_t.xmii007,xmii_t.xmii008,xmii_t.xmii009,xmii_t.xmii010,xmii_t.xmii011,xmii_t.xmii012,xmii_t.xmii013,xmii_t.xmii017,xmii_t.xmii014" 
      IF 1 <> 1 THEN      ]]>
  </point>
  <point name="b_fill.define" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[   DEFINE l_xmii005  LIKE xmii_t.xmii005
   DEFINE l_xmii006  LIKE xmii_t.xmii006
   DEFINE l_xmii007  LIKE xmii_t.xmii007
   DEFINE l_xmii008  LIKE xmii_t.xmii008
   DEFINE l_xmii009  LIKE xmii_t.xmii009
   DEFINE l_xmii010  LIKE xmii_t.xmii010
   DEFINE l_xmii011  LIKE xmii_t.xmii011
   DEFINE l_xmii012  LIKE xmii_t.xmii012
   DEFINE l_xmii013  LIKE xmii_t.xmii013
   DEFINE l_xmii014  LIKE xmii_t.xmii014
   DEFINE l_xmii017  LIKE xmii_t.xmii017
   DEFINE l_xmia002  LIKE xmia_t.xmia002
   DEFINE i          LIKE type_t.num5]]>
  </point>
  <point name="b_fill.fill" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[         IF l_ac = 1 THEN
            LET l_xmii005 = g_xmii_d[l_ac].xmii005
            LET l_xmii006 = g_xmii_d[l_ac].xmii006
            LET l_xmii007 = g_xmii_d[l_ac].xmii007
            LET l_xmii008 = g_xmii_d[l_ac].xmii008 
            LET l_xmii009 = g_xmii_d[l_ac].xmii009
            LET l_xmii010 = g_xmii_d[l_ac].xmii010  
            LET l_xmii011 = g_xmii_d[l_ac].xmii011
            LET l_xmii012 = g_xmii_d[l_ac].xmii012 
            LET l_xmii013 = g_xmii_d[l_ac].xmii013   
            LET l_xmii017 = g_xmii_d[l_ac].xmii017              
            LET g_xmii_d[l_ac].l_xmii018_s = g_xmii_d[l_ac].l_xmii018_01 
            LET g_xmii_d[l_ac].l_xmii019_s = g_xmii_d[l_ac].l_xmii019_01     
            LET g_xmii2_d[l_ac].l_xmii022_s = g_xmii2_d[l_ac].l_xmii022_01 
            LET g_xmii2_d[l_ac].l_xmii023_s = g_xmii2_d[l_ac].l_xmii023_01              
            LET g_xmii3_d[l_ac].l_xmii018_3_s = g_xmii3_d[l_ac].l_xmii018_3_01 
            LET g_xmii3_d[l_ac].l_xmii019_3_s = g_xmii3_d[l_ac].l_xmii019_3_01  
            LET g_xmii3_d[l_ac].l_xmii022_3_s = g_xmii3_d[l_ac].l_xmii022_3_01 
            LET g_xmii3_d[l_ac].l_xmii023_3_s = g_xmii3_d[l_ac].l_xmii023_3_01            
         END IF
         LET l_xmii014 = g_xmii_d[l_ac].xmii014
         #另起一行
         IF g_xmii_d[l_ac].xmii005 <> l_xmii005 OR g_xmii_d[l_ac].xmii006 <> l_xmii006 OR g_xmii_d[l_ac].xmii007 <> l_xmii007 OR 
            g_xmii_d[l_ac].xmii008 <> l_xmii008 OR g_xmii_d[l_ac].xmii009 <> l_xmii009 OR g_xmii_d[l_ac].xmii010 <> l_xmii010 OR
            g_xmii_d[l_ac].xmii011 <> l_xmii011 OR g_xmii_d[l_ac].xmii012 <> l_xmii012 OR g_xmii_d[l_ac].xmii013 <> l_xmii013 OR
            g_xmii_d[l_ac].xmii017 <> l_xmii017 THEN 

            LET l_xmii005 = g_xmii_d[l_ac].xmii005
            LET l_xmii006 = g_xmii_d[l_ac].xmii006
            LET l_xmii007 = g_xmii_d[l_ac].xmii007
            LET l_xmii008 = g_xmii_d[l_ac].xmii008 
            LET l_xmii009 = g_xmii_d[l_ac].xmii009
            LET l_xmii010 = g_xmii_d[l_ac].xmii010  
            LET l_xmii011 = g_xmii_d[l_ac].xmii011
            LET l_xmii012 = g_xmii_d[l_ac].xmii012 
            LET l_xmii013 = g_xmii_d[l_ac].xmii013 
            LET l_xmii017 = g_xmii_d[l_ac].xmii017             
            LET g_xmii_d[l_ac].l_xmii018_s = g_xmii_d[l_ac].l_xmii018_01 
            LET g_xmii_d[l_ac].l_xmii019_s = g_xmii_d[l_ac].l_xmii019_01  
            LET g_xmii2_d[l_ac].l_xmii022_s = g_xmii2_d[l_ac].l_xmii022_01 
            LET g_xmii2_d[l_ac].l_xmii023_s = g_xmii2_d[l_ac].l_xmii023_01              
            LET g_xmii3_d[l_ac].l_xmii018_3_s = g_xmii3_d[l_ac].l_xmii018_3_01 
            LET g_xmii3_d[l_ac].l_xmii019_3_s = g_xmii3_d[l_ac].l_xmii019_3_01  
            LET g_xmii3_d[l_ac].l_xmii022_3_s = g_xmii3_d[l_ac].l_xmii022_3_01 
            LET g_xmii3_d[l_ac].l_xmii023_3_s = g_xmii3_d[l_ac].l_xmii023_3_01              
         ELSE
            IF l_ac > 1 THEN
               LET l_ac = l_ac-1
            END IF   
            IF l_xmii014 > 1 THEN
               CALL axmt175_b_desc(l_xmii014,l_ac)
            END IF   
         END IF         ]]>
  </point>
  <point name="b_fill.sql" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[      END IF
      LET l_xmii005 = NULL
      LET l_xmii006 = NULL
      LET l_xmii007 = NULL
      LET l_xmii008 = NULL
      LET l_xmii009 = NULL
      LET l_xmii010 = NULL
      LET l_xmii011 = NULL
      LET l_xmii012 = NULL
      LET l_xmii013 = NULL
      LET l_xmii014 = NULL
      LET l_xmii017 = NULL]]>
  </point>
  <point name="b_fill.sql_before" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[   CALL g_xmii4_d.clear()
   CALL g_xmii6_d.clear()]]>
  </point>
  <point name="browser_fill.other_fill" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[   IF axmt175_fill_chk(1) AND NOT cl_null(g_xmih_m.xmih005) THEN
      LET g_sql = "SELECT  UNIQUE xmii006,'',xmii007,'',xmii008,'',xmii012,'',xmii013,'',xmii011,'', 
          xmii009,'','',xmii010,xmii017,'',xmii014,xmii018,xmii019,'','','','','','','','','','','','','','','', 
          '','','','','','','','','','','','','','','','','','','','','','','','','','','','','','', 
          '','','',xmii006,'',xmii007,'',xmii008,'',xmii012,'',xmii013,'',xmii011,'', 
          xmii009,'','',xmii010,xmii017,'',xmii014,xmii022,xmii023,'','','','','','','','','','','','','','','', 
          '','','','','','','','','','','','','','','','','','','','','','','','','','','','','','', 
          '','','' FROM xmii_t",   
                  " INNER JOIN xmih_t ON xmih001 = xmii001 ",
                  " AND xmih002 = xmii002 ",
                  " AND xmih003 = xmii003 ",
                  " AND xmih004 = xmii004 ",
                  "",
                  " WHERE xmiient=? AND xmii001=? AND xmii002=? AND xmii003=? AND xmii004=?"      
      IF NOT cl_null(g_wc2_table1) THEN
         LET g_sql = g_sql CLIPPED, " AND ", g_wc2_table1 CLIPPED
      END IF  
      LET g_sql = g_sql, " ORDER BY xmii_t.xmii006,xmii_t.xmii007,xmii_t.xmii008,xmii_t.xmii009,xmii_t.xmii010,xmii_t.xmii011,xmii_t.xmii012,xmii_t.xmii013,xmii_t.xmii017,xmii_t.xmii014"      
      PREPARE axmt175_pb_4 FROM g_sql
      DECLARE b_fill_cs_4 CURSOR FOR axmt175_pb_4      
      
      OPEN b_fill_cs_4 USING g_enterprise,g_xmih_m.xmih001
                                               ,g_xmih_m.xmih002
                                               ,g_xmih_m.xmih003
                                               ,g_xmih_m.xmih005      
      
      LET l_ac = 1
      LET l_xmii005 = NULL
      LET l_xmii006 = NULL
      LET l_xmii007 = NULL
      LET l_xmii008 = NULL
      LET l_xmii009 = NULL
      LET l_xmii010 = NULL
      LET l_xmii011 = NULL
      LET l_xmii012 = NULL
      LET l_xmii013 = NULL
      LET l_xmii014 = NULL 
      LET l_xmii017 = NULL      
   
     FOREACH b_fill_cs_4 INTO g_xmii4_d[l_ac].xmii006,g_xmii4_d[l_ac].xmii006_4_desc,g_xmii4_d[l_ac].xmii007,g_xmii4_d[l_ac].xmii007_4_desc,
                              g_xmii4_d[l_ac].xmii008,g_xmii4_d[l_ac].xmii008_4_desc,g_xmii4_d[l_ac].xmii012,g_xmii4_d[l_ac].xmii012_4_desc,
                              g_xmii4_d[l_ac].xmii013,g_xmii4_d[l_ac].xmii013_4_desc,g_xmii4_d[l_ac].xmii011,g_xmii4_d[l_ac].xmii011_4_desc,g_xmii4_d[l_ac].xmii009,
                              g_xmii4_d[l_ac].xmii009_4_desc,g_xmii4_d[l_ac].xmii009_4_desc_1,g_xmii4_d[l_ac].xmii010,g_xmii4_d[l_ac].xmii017,
                              g_xmii4_d[l_ac].xmii017_4_desc,g_xmii4_d[l_ac].xmii014,g_xmii4_d[l_ac].l_xmii018_4_01,g_xmii4_d[l_ac].l_xmii019_4_01,g_xmii4_d[l_ac].l_xmii018_4_02,g_xmii4_d[l_ac].l_xmii019_4_02,
                              g_xmii4_d[l_ac].l_xmii018_4_03,g_xmii4_d[l_ac].l_xmii019_4_03,g_xmii4_d[l_ac].l_xmii018_4_04,g_xmii4_d[l_ac].l_xmii019_4_04,g_xmii4_d[l_ac].l_xmii018_4_05,g_xmii4_d[l_ac].l_xmii019_4_05,
                              g_xmii4_d[l_ac].l_xmii018_4_06,g_xmii4_d[l_ac].l_xmii019_4_06,g_xmii4_d[l_ac].l_xmii018_4_07,g_xmii4_d[l_ac].l_xmii019_4_07,g_xmii4_d[l_ac].l_xmii018_4_08,g_xmii4_d[l_ac].l_xmii019_4_08, 
                              g_xmii4_d[l_ac].l_xmii018_4_09,g_xmii4_d[l_ac].l_xmii019_4_09,g_xmii4_d[l_ac].l_xmii018_4_10,g_xmii4_d[l_ac].l_xmii019_4_10,g_xmii4_d[l_ac].l_xmii018_4_11,g_xmii4_d[l_ac].l_xmii019_4_11,
                              g_xmii4_d[l_ac].l_xmii018_4_12,g_xmii4_d[l_ac].l_xmii019_4_12,g_xmii4_d[l_ac].l_xmii018_4_13,g_xmii4_d[l_ac].l_xmii019_4_13,g_xmii4_d[l_ac].l_xmii018_4_14,g_xmii4_d[l_ac].l_xmii019_4_14,     
                              g_xmii4_d[l_ac].l_xmii018_4_15,g_xmii4_d[l_ac].l_xmii019_4_15,g_xmii4_d[l_ac].l_xmii018_4_16,g_xmii4_d[l_ac].l_xmii019_4_16,g_xmii4_d[l_ac].l_xmii018_4_17,g_xmii4_d[l_ac].l_xmii019_4_17,
                              g_xmii4_d[l_ac].l_xmii018_4_18,g_xmii4_d[l_ac].l_xmii019_4_18,g_xmii4_d[l_ac].l_xmii018_4_19,g_xmii4_d[l_ac].l_xmii019_4_19,g_xmii4_d[l_ac].l_xmii018_4_20,g_xmii4_d[l_ac].l_xmii019_4_20, 
                              g_xmii4_d[l_ac].l_xmii018_4_21,g_xmii4_d[l_ac].l_xmii019_4_21,g_xmii4_d[l_ac].l_xmii018_4_22,g_xmii4_d[l_ac].l_xmii019_4_22,g_xmii4_d[l_ac].l_xmii018_4_23,g_xmii4_d[l_ac].l_xmii019_4_23,
                              g_xmii4_d[l_ac].l_xmii018_4_24,g_xmii4_d[l_ac].l_xmii019_4_24,g_xmii4_d[l_ac].l_xmii018_4_s,g_xmii4_d[l_ac].l_xmii019_4_s,         
                              g_xmii6_d[l_ac].l_xmii006_6,g_xmii6_d[l_ac].l_xmii006_6_desc,g_xmii6_d[l_ac].l_xmii007_6,g_xmii6_d[l_ac].l_xmii007_6_desc,
                              g_xmii6_d[l_ac].l_xmii008_6,g_xmii6_d[l_ac].l_xmii008_6_desc,g_xmii6_d[l_ac].l_xmii012_6,g_xmii6_d[l_ac].l_xmii012_6_desc,
                              g_xmii6_d[l_ac].l_xmii013_6,g_xmii6_d[l_ac].l_xmii013_6_desc,g_xmii6_d[l_ac].l_xmii011_6,g_xmii6_d[l_ac].l_xmii011_6_desc,g_xmii6_d[l_ac].l_xmii009_6,
                              g_xmii6_d[l_ac].l_xmii009_6_desc,g_xmii6_d[l_ac].l_xmii009_6_desc_1,g_xmii6_d[l_ac].l_xmii010_6,g_xmii6_d[l_ac].l_xmii017_6,
                              g_xmii6_d[l_ac].l_xmii017_6_desc,g_xmii6_d[l_ac].l_xmii014_6,g_xmii6_d[l_ac].l_xmii022_6_01,g_xmii6_d[l_ac].l_xmii023_6_01,g_xmii6_d[l_ac].l_xmii022_6_02,g_xmii6_d[l_ac].l_xmii023_6_02,
                              g_xmii6_d[l_ac].l_xmii022_6_03,g_xmii6_d[l_ac].l_xmii023_6_03,g_xmii6_d[l_ac].l_xmii022_6_04,g_xmii6_d[l_ac].l_xmii023_6_04,g_xmii6_d[l_ac].l_xmii022_6_05,g_xmii6_d[l_ac].l_xmii023_6_05,
                              g_xmii6_d[l_ac].l_xmii022_6_06,g_xmii6_d[l_ac].l_xmii023_6_06,g_xmii6_d[l_ac].l_xmii022_6_07,g_xmii6_d[l_ac].l_xmii023_6_07,g_xmii6_d[l_ac].l_xmii022_6_08,g_xmii6_d[l_ac].l_xmii023_6_08, 
                              g_xmii6_d[l_ac].l_xmii022_6_09,g_xmii6_d[l_ac].l_xmii023_6_09,g_xmii6_d[l_ac].l_xmii022_6_10,g_xmii6_d[l_ac].l_xmii023_6_10,g_xmii6_d[l_ac].l_xmii022_6_11,g_xmii6_d[l_ac].l_xmii023_6_11,
                              g_xmii6_d[l_ac].l_xmii022_6_12,g_xmii6_d[l_ac].l_xmii023_6_12,g_xmii6_d[l_ac].l_xmii022_6_13,g_xmii6_d[l_ac].l_xmii023_6_13,g_xmii6_d[l_ac].l_xmii022_6_14,g_xmii6_d[l_ac].l_xmii023_6_14,     
                              g_xmii6_d[l_ac].l_xmii022_6_15,g_xmii6_d[l_ac].l_xmii023_6_15,g_xmii6_d[l_ac].l_xmii022_6_16,g_xmii6_d[l_ac].l_xmii023_6_16,g_xmii6_d[l_ac].l_xmii022_6_17,g_xmii6_d[l_ac].l_xmii023_6_17,
                              g_xmii6_d[l_ac].l_xmii022_6_18,g_xmii6_d[l_ac].l_xmii023_6_18,g_xmii6_d[l_ac].l_xmii022_6_19,g_xmii6_d[l_ac].l_xmii023_6_19,g_xmii6_d[l_ac].l_xmii022_6_20,g_xmii6_d[l_ac].l_xmii023_6_20, 
                              g_xmii6_d[l_ac].l_xmii022_6_21,g_xmii6_d[l_ac].l_xmii023_6_21,g_xmii6_d[l_ac].l_xmii022_6_22,g_xmii6_d[l_ac].l_xmii023_6_22,g_xmii6_d[l_ac].l_xmii022_6_23,g_xmii6_d[l_ac].l_xmii023_6_23,
                              g_xmii6_d[l_ac].l_xmii022_6_24,g_xmii6_d[l_ac].l_xmii023_6_24,g_xmii6_d[l_ac].l_xmii022_6_s,g_xmii6_d[l_ac].l_xmii023_6_s 

         IF SQLCA.sqlcode THEN
            CALL cl_err("FOREACH:",SQLCA.sqlcode,1)
            EXIT FOREACH
         END IF
         IF l_ac = 1 THEN
            LET l_xmii006 = g_xmii4_d[l_ac].xmii006
            LET l_xmii007 = g_xmii4_d[l_ac].xmii007
            LET l_xmii008 = g_xmii4_d[l_ac].xmii008 
            LET l_xmii009 = g_xmii4_d[l_ac].xmii009
            LET l_xmii010 = g_xmii4_d[l_ac].xmii010  
            LET l_xmii011 = g_xmii4_d[l_ac].xmii011
            LET l_xmii012 = g_xmii4_d[l_ac].xmii012 
            LET l_xmii013 = g_xmii4_d[l_ac].xmii013   
            LET l_xmii017 = g_xmii4_d[l_ac].xmii017             
            LET g_xmii4_d[l_ac].l_xmii018_4_s = g_xmii4_d[l_ac].l_xmii018_4_01 
            LET g_xmii4_d[l_ac].l_xmii019_4_s = g_xmii4_d[l_ac].l_xmii019_4_01    
            LET g_xmii6_d[l_ac].l_xmii022_6_s = g_xmii6_d[l_ac].l_xmii022_6_01 
            LET g_xmii6_d[l_ac].l_xmii023_6_s = g_xmii6_d[l_ac].l_xmii023_6_01               
         END IF
         LET l_xmii014 = g_xmii4_d[l_ac].xmii014
         #另起一行
         IF g_xmii4_d[l_ac].xmii006 <> l_xmii006 OR g_xmii4_d[l_ac].xmii007 <> l_xmii007 OR
            g_xmii4_d[l_ac].xmii008 <> l_xmii008 OR g_xmii4_d[l_ac].xmii009 <> l_xmii009 OR g_xmii4_d[l_ac].xmii010 <> l_xmii010 OR
            g_xmii4_d[l_ac].xmii011 <> l_xmii011 OR g_xmii4_d[l_ac].xmii012 <> l_xmii012 OR g_xmii4_d[l_ac].xmii013 <> l_xmii013 OR
            g_xmii4_d[l_ac].xmii017 <> l_xmii017 THEN 

            LET l_xmii006 = g_xmii4_d[l_ac].xmii006
            LET l_xmii007 = g_xmii4_d[l_ac].xmii007
            LET l_xmii008 = g_xmii4_d[l_ac].xmii008 
            LET l_xmii009 = g_xmii4_d[l_ac].xmii009
            LET l_xmii010 = g_xmii4_d[l_ac].xmii010  
            LET l_xmii011 = g_xmii4_d[l_ac].xmii011
            LET l_xmii012 = g_xmii4_d[l_ac].xmii012 
            LET l_xmii013 = g_xmii4_d[l_ac].xmii013  
            LET l_xmii017 = g_xmii4_d[l_ac].xmii017    
            LET g_xmii4_d[l_ac].l_xmii018_4_s = g_xmii4_d[l_ac].l_xmii018_4_01 
            LET g_xmii4_d[l_ac].l_xmii019_4_s = g_xmii4_d[l_ac].l_xmii019_4_01  
            LET g_xmii6_d[l_ac].l_xmii022_6_s = g_xmii6_d[l_ac].l_xmii022_6_01 
            LET g_xmii6_d[l_ac].l_xmii023_6_s = g_xmii6_d[l_ac].l_xmii023_6_01            
         ELSE
            IF l_ac > 1 THEN
               LET l_ac = l_ac-1
            END IF   
            IF l_xmii014 > 1 THEN
               CALL axmt175_b_desc_4(l_xmii014,l_ac)
            END IF   
         END IF         
         CALL axmt175_xmii006_desc(g_xmii4_d[l_ac].xmii006) RETURNING g_xmii4_d[l_ac].xmii006_4_desc
         LET g_xmii6_d[l_ac].l_xmii006_6_desc = g_xmii4_d[l_ac].xmii006_4_desc
         CALL axmt175_xmii007_desc(g_xmii4_d[l_ac].xmii007) RETURNING g_xmii4_d[l_ac].xmii007_4_desc
         LET g_xmii6_d[l_ac].l_xmii007_6_desc = g_xmii4_d[l_ac].xmii007_4_desc
         CALL axmt175_xmii008_desc(g_xmii4_d[l_ac].xmii008) RETURNING g_xmii4_d[l_ac].xmii008_4_desc
         LET g_xmii6_d[l_ac].l_xmii008_6_desc = g_xmii4_d[l_ac].xmii008_4_desc
         CALL axmt175_xmii011_desc(g_xmii4_d[l_ac].xmii011) RETURNING g_xmii4_d[l_ac].xmii011_4_desc
         LET g_xmii6_d[l_ac].l_xmii011_6_desc = g_xmii4_d[l_ac].xmii011_4_desc         
         CALL axmt175_xmii012_desc(g_xmii4_d[l_ac].xmii012) RETURNING g_xmii4_d[l_ac].xmii012_4_desc
         LET g_xmii6_d[l_ac].l_xmii012_6_desc = g_xmii4_d[l_ac].xmii012_4_desc
         CALL axmt175_xmii013_desc(g_xmii4_d[l_ac].xmii013) RETURNING g_xmii4_d[l_ac].xmii013_4_desc
         LET g_xmii6_d[l_ac].l_xmii013_6_desc = g_xmii4_d[l_ac].xmii013_4_desc
         CALL axmt175_xmii009_desc(g_xmii4_d[l_ac].xmii009) RETURNING g_xmii4_d[l_ac].xmii009_4_desc,g_xmii4_d[l_ac].xmii009_4_desc_1
         LET g_xmii6_d[l_ac].l_xmii009_6_desc = g_xmii4_d[l_ac].xmii009_4_desc
         LET g_xmii6_d[l_ac].l_xmii009_6_desc_1 = g_xmii4_d[l_ac].xmii009_4_desc_1
         CALL axmt175_xmii017_desc(g_xmii4_d[l_ac].xmii017) RETURNING g_xmii4_d[l_ac].xmii017_4_desc
         LET g_xmii6_d[l_ac].l_xmii017_6_desc = g_xmii4_d[l_ac].xmii017_4_desc
         
         #end add-point
      
         LET l_ac = l_ac + 1
         IF l_ac > g_max_rec AND g_error_show = 1 THEN
            CALL cl_err( '', 9035, 1)
            EXIT FOREACH
         END IF         
      END FOREACH         
   END IF
   
   IF l_ac > 1 THEN
      INITIALIZE g_xmii4_d[l_ac].* TO NULL
      INITIALIZE g_xmii6_d[l_ac].* TO NULL   
      CALL cl_getmsg('axc-00204',g_lang) RETURNING g_xmii4_d[l_ac].xmii009
      LET g_xmii6_d[l_ac].l_xmii009_6 = g_xmii4_d[l_ac].xmii009
      SELECT xmia002 INTO l_xmia002 FROM xmia_t
       WHERE xmiaent = g_enterprise
         AND xmia001 = g_xmih_m.xmih001
      FOR i = 1 TO l_xmia002
          CALL axmt175_sum_xmii(i)
      END FOR
      SELECT SUM(xmii018),SUM(xmii019),SUM(xmii022),SUM(xmii023)
        INTO g_xmii4_d[l_ac].l_xmii018_4_s,g_xmii4_d[l_ac].l_xmii019_4_s,g_xmii6_d[l_ac].l_xmii022_6_s,g_xmii6_d[l_ac].l_xmii023_6_s
        FROM xmii_t
       WHERE xmiient = g_enterprise
         AND xmii001 = g_xmih_m.xmih001
         AND xmii002 = g_xmih_m.xmih002
         AND xmii003 = g_xmih_m.xmih003
         AND xmii004 = g_xmih_m.xmih005
   ELSE
      CALL g_xmii4_d.deleteElement(g_xmii4_d.getLength())
      CALL g_xmii6_d.deleteElement(g_xmii6_d.getLength())
   END IF 
   
#   LET g_rec_b1 = g_xmii4_d.getLength() - 1
#   CALL g_xmii4_d.deleteElement(g_xmii4_d.getLength())
#   CALL g_xmii6_d.deleteElement(g_xmii6_d.getLength())]]>
  </point>
  <point name="construct.c.ooai001" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_ooai001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO ooai001  #顯示到畫面上
            NEXT FIELD ooai001                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page1.xmii006" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_ooef001_12()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmii006  #顯示到畫面上
            NEXT FIELD xmii006                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page1.xmii007" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_ooef001_16()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmii007  #顯示到畫面上
            NEXT FIELD xmii007                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page1.xmii008" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_ooag001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmii008  #顯示到畫面上
            NEXT FIELD xmii008                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page1.xmii009" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_imaa001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmii009  #顯示到畫面上
            NEXT FIELD xmii009                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page1.xmii010" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_xmii010()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmii010  #顯示到畫面上
            NEXT FIELD xmii010                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page1.xmii011" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_xmii011()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmii011  #顯示到畫面上
            NEXT FIELD xmii011                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page1.xmii012" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_pmaa001_6()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmii012  #顯示到畫面上
            NEXT FIELD xmii012                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page1.xmii013" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_oocq002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmii013  #顯示到畫面上
            NEXT FIELD xmii013                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page1.xmii017" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_ooca001_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmii017  #顯示到畫面上
            NEXT FIELD xmii017                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.xmih001" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_xmia001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmih001  #顯示到畫面上
            NEXT FIELD xmih001                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.xmih004" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_ooef001_16()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmih004  #顯示到畫面上
            NEXT FIELD xmih004                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.xmih005" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_ooef001_16()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmih005  #顯示到畫面上
            NEXT FIELD xmih005                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.xmihcnfid" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_ooag001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmihcnfid  #顯示到畫面上
            NEXT FIELD xmihcnfid                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.xmihcrtdp" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_ooea001_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmihcrtdp  #顯示到畫面上
            NEXT FIELD xmihcrtdp                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.xmihcrtid" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_ooag001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmihcrtid  #顯示到畫面上
            NEXT FIELD xmihcrtid                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.xmihmodid" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_ooag001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmihmodid  #顯示到畫面上
            NEXT FIELD xmihmodid                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.xmihowndp" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_ooea001_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmihowndp  #顯示到畫面上
            NEXT FIELD xmihowndp                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.xmihownid" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_ooag001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmihownid  #顯示到畫面上
            NEXT FIELD xmihownid                     #返回原欄位
    

]]>
  </point>
  <point name="cs.b_dialog" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[         LET g_xmii_d[1].xmii007 = ""
         DISPLAY ARRAY g_xmii_d TO s_detail1.*
            BEFORE DISPLAY
               EXIT DISPLAY
         END DISPLAY]]>
  </point>
  <point name="cs.before_construct" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[   LET ls_hide = ' '   
   FOR li_i = 1 TO 24     #欄位的隱藏
      LET lc_index = li_i USING '&&' 
      IF li_i = 1 THEN      
         LET ls_hide = ls_hide || "l_xmii018_" || lc_index || ",l_xmii019_" || lc_index || ",l_xmii022_" || lc_index || ",l_xmii023_" || lc_index
                               || ",l_xmii018_4_" || lc_index || ",l_xmii019_4_" || lc_index || ",l_xmii018_5_" || lc_index || ",l_xmii019_5_" || lc_index
                               || ",l_xmii022_6_" || lc_index || ",l_xmii023_6_" || lc_index || ",l_xmii022_7_" || lc_index || ",l_xmii023_7_" || lc_index  
                               || ",l_xmii018_3_" || lc_index || ",l_xmii019_3_" || lc_index || ",l_xmii022_3_" || lc_index || ",l_xmii023_3_" || lc_index                               
      ELSE
         LET ls_hide = ls_hide || ",l_xmii018_" || lc_index || ",l_xmii019_" || lc_index || ",l_xmii022_" || lc_index || ",l_xmii023_" || lc_index
                               || ",l_xmii018_4_" || lc_index || ",l_xmii019_4_" || lc_index || ",l_xmii018_5_" || lc_index || ",l_xmii019_5_" || lc_index
                               || ",l_xmii022_6_" || lc_index || ",l_xmii023_6_" || lc_index || ",l_xmii022_7_" || lc_index || ",l_xmii023_7_" || lc_index     
                               || ",l_xmii018_3_" || lc_index || ",l_xmii019_3_" || lc_index || ",l_xmii022_3_" || lc_index || ",l_xmii023_3_" || lc_index                               
      END IF      
   END FOR  
   CALL cl_set_comp_visible(ls_hide,FALSE)  ]]>
  </point>
  <point name="cs.define" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[   DEFINE ls_hide   STRING
   DEFINE li_i      LIKE type_t.num5
   DEFINE lc_index  LIKE type_t.chr2]]>
  </point>
  <point name="fetch.action_control" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[   CALL axmt175_desc_date()
   CALL axmt175_xmii_hide()]]>
  </point>
  <point name="global.variable" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[DEFINE g_xmib   DYNAMIC ARRAY OF RECORD
              xmib002     LIKE xmib_t.xmib002,
              xmib003     LIKE xmib_t.xmib003,
              b_date      LIKE type_t.chr80,
              e_date      LIKE type_t.chr80
       END RECORD  
 TYPE type_g_xmii4_d        RECORD
   xmii006 LIKE xmii_t.xmii006, 
   xmii006_4_desc LIKE type_t.chr500,   
   xmii007 LIKE xmii_t.xmii007, 
   xmii007_4_desc LIKE type_t.chr500,     
   xmii008 LIKE xmii_t.xmii008, 
   xmii008_4_desc LIKE type_t.chr500, 
   xmii012 LIKE xmii_t.xmii012, 
   xmii012_4_desc LIKE type_t.chr500, 
   xmii013 LIKE xmii_t.xmii013, 
   xmii013_4_desc LIKE type_t.chr500, 
   xmii011 LIKE xmii_t.xmii011,
   xmii011_4_desc LIKE type_t.chr500,    
   xmii009 LIKE xmii_t.xmii009, 
   xmii009_4_desc   LIKE type_t.chr500, 
   xmii009_4_desc_1 LIKE type_t.chr500, 
   xmii010 LIKE xmii_t.xmii010, 
   xmii017 LIKE xmii_t.xmii017, 
   xmii017_4_desc LIKE type_t.chr500, 
   xmii014 LIKE xmii_t.xmii014, 
   l_xmii018_4_01 LIKE type_t.num20_6, 
   l_xmii019_4_01 LIKE type_t.num20_6, 
   l_xmii018_4_02 LIKE type_t.num20_6, 
   l_xmii019_4_02 LIKE type_t.num20_6, 
   l_xmii018_4_03 LIKE type_t.num20_6, 
   l_xmii019_4_03 LIKE type_t.num20_6, 
   l_xmii018_4_04 LIKE type_t.num20_6, 
   l_xmii019_4_04 LIKE type_t.num20_6, 
   l_xmii018_4_05 LIKE type_t.num20_6, 
   l_xmii019_4_05 LIKE type_t.num20_6, 
   l_xmii018_4_06 LIKE type_t.num20_6, 
   l_xmii019_4_06 LIKE type_t.num20_6, 
   l_xmii018_4_07 LIKE type_t.num20_6, 
   l_xmii019_4_07 LIKE type_t.num20_6, 
   l_xmii018_4_08 LIKE type_t.num20_6, 
   l_xmii019_4_08 LIKE type_t.num20_6, 
   l_xmii018_4_09 LIKE type_t.num20_6, 
   l_xmii019_4_09 LIKE type_t.num20_6, 
   l_xmii018_4_10 LIKE type_t.num20_6, 
   l_xmii019_4_10 LIKE type_t.num20_6, 
   l_xmii018_4_11 LIKE type_t.num20_6, 
   l_xmii019_4_11 LIKE type_t.num20_6, 
   l_xmii018_4_12 LIKE type_t.num20_6, 
   l_xmii019_4_12 LIKE type_t.num20_6, 
   l_xmii018_4_13 LIKE type_t.num20_6, 
   l_xmii019_4_13 LIKE type_t.num20_6, 
   l_xmii018_4_14 LIKE type_t.num20_6, 
   l_xmii019_4_14 LIKE type_t.num20_6, 
   l_xmii018_4_15 LIKE type_t.num20_6, 
   l_xmii019_4_15 LIKE type_t.num20_6, 
   l_xmii018_4_16 LIKE type_t.num20_6, 
   l_xmii019_4_16 LIKE type_t.num20_6, 
   l_xmii018_4_17 LIKE type_t.num20_6, 
   l_xmii019_4_17 LIKE type_t.num20_6, 
   l_xmii018_4_18 LIKE type_t.num20_6, 
   l_xmii019_4_18 LIKE type_t.num20_6, 
   l_xmii018_4_19 LIKE type_t.num20_6, 
   l_xmii019_4_19 LIKE type_t.num20_6, 
   l_xmii018_4_20 LIKE type_t.num20_6, 
   l_xmii019_4_20 LIKE type_t.num20_6, 
   l_xmii018_4_21 LIKE type_t.num20_6, 
   l_xmii019_4_21 LIKE type_t.num20_6, 
   l_xmii018_4_22 LIKE type_t.num20_6, 
   l_xmii019_4_22 LIKE type_t.num20_6, 
   l_xmii018_4_23 LIKE type_t.num20_6, 
   l_xmii019_4_23 LIKE type_t.num20_6, 
   l_xmii018_4_24 LIKE type_t.num20_6, 
   l_xmii019_4_24 LIKE type_t.num20_6, 
   l_xmii018_4_s LIKE type_t.num20_6, 
   l_xmii019_4_s LIKE type_t.num20_6
       END RECORD  
       
 TYPE type_g_xmii5_d        RECORD
   l_xmii007_1 LIKE xmii_t.xmii007, 
   l_xmii007_1_desc LIKE type_t.chr500, 
   l_xmii006_1 LIKE xmii_t.xmii006, 
   l_xmii006_1_desc LIKE type_t.chr500, 
   l_xmii008_1 LIKE xmii_t.xmii008, 
   l_xmii008_1_desc LIKE type_t.chr500, 
   l_xmii012_1 LIKE xmii_t.xmii012, 
   l_xmii012_1_desc LIKE type_t.chr500, 
   l_xmii013_1 LIKE xmii_t.xmii013, 
   l_xmii013_1_desc LIKE type_t.chr500, 
   l_xmii011_1 LIKE xmii_t.xmii011, 
   l_xmii011_1_desc LIKE type_t.chr500,
   l_xmii009_1 LIKE xmii_t.xmii009, 
   l_xmii009_1_desc LIKE type_t.chr500, 
   l_xmii009_1_desc_1 LIKE type_t.chr500, 
   l_xmii010_1 LIKE xmii_t.xmii010, 
   l_xmii017_1 LIKE xmii_t.xmii017, 
   l_xmii017_1_desc LIKE type_t.chr500, 
   l_xmii014_1 LIKE xmii_t.xmii014, 
   l_xmii018_5_01 LIKE type_t.num20_6, 
   l_xmii019_5_01 LIKE type_t.num20_6, 
   l_xmii018_5_02 LIKE type_t.num20_6, 
   l_xmii019_5_02 LIKE type_t.num20_6, 
   l_xmii018_5_03 LIKE type_t.num20_6, 
   l_xmii019_5_03 LIKE type_t.num20_6, 
   l_xmii018_5_04 LIKE type_t.num20_6, 
   l_xmii019_5_04 LIKE type_t.num20_6, 
   l_xmii018_5_05 LIKE type_t.num20_6, 
   l_xmii019_5_05 LIKE type_t.num20_6, 
   l_xmii018_5_06 LIKE type_t.num20_6, 
   l_xmii019_5_06 LIKE type_t.num20_6, 
   l_xmii018_5_07 LIKE type_t.num20_6, 
   l_xmii019_5_07 LIKE type_t.num20_6, 
   l_xmii018_5_08 LIKE type_t.num20_6, 
   l_xmii019_5_08 LIKE type_t.num20_6, 
   l_xmii018_5_09 LIKE type_t.num20_6, 
   l_xmii019_5_09 LIKE type_t.num20_6, 
   l_xmii018_5_10 LIKE type_t.num20_6, 
   l_xmii019_5_10 LIKE type_t.num20_6, 
   l_xmii018_5_11 LIKE type_t.num20_6, 
   l_xmii019_5_11 LIKE type_t.num20_6, 
   l_xmii018_5_12 LIKE type_t.num20_6, 
   l_xmii019_5_12 LIKE type_t.num20_6, 
   l_xmii018_5_13 LIKE type_t.num20_6, 
   l_xmii019_5_13 LIKE type_t.num20_6, 
   l_xmii018_5_14 LIKE type_t.num20_6, 
   l_xmii019_5_14 LIKE type_t.num20_6, 
   l_xmii018_5_15 LIKE type_t.num20_6, 
   l_xmii019_5_15 LIKE type_t.num20_6, 
   l_xmii018_5_16 LIKE type_t.num20_6, 
   l_xmii019_5_16 LIKE type_t.num20_6, 
   l_xmii018_5_17 LIKE type_t.num20_6, 
   l_xmii019_5_17 LIKE type_t.num20_6, 
   l_xmii018_5_18 LIKE type_t.num20_6, 
   l_xmii019_5_18 LIKE type_t.num20_6, 
   l_xmii018_5_19 LIKE type_t.num20_6, 
   l_xmii019_5_19 LIKE type_t.num20_6, 
   l_xmii018_5_20 LIKE type_t.num20_6, 
   l_xmii019_5_20 LIKE type_t.num20_6, 
   l_xmii018_5_21 LIKE type_t.num20_6, 
   l_xmii019_5_21 LIKE type_t.num20_6, 
   l_xmii018_5_22 LIKE type_t.num20_6, 
   l_xmii019_5_22 LIKE type_t.num20_6, 
   l_xmii018_5_23 LIKE type_t.num20_6, 
   l_xmii019_5_23 LIKE type_t.num20_6, 
   l_xmii018_5_24 LIKE type_t.num20_6, 
   l_xmii019_5_24 LIKE type_t.num20_6, 
   l_xmii018_5_s LIKE type_t.num20_6, 
   l_xmii019_5_s LIKE type_t.num20_6
       END RECORD   

 TYPE type_g_xmii6_d        RECORD
   l_xmii006_6 LIKE xmii_t.xmii006, 
   l_xmii006_6_desc LIKE type_t.chr500, 
   l_xmii007_6 LIKE xmii_t.xmii007, 
   l_xmii007_6_desc LIKE type_t.chr500,    
   l_xmii008_6 LIKE xmii_t.xmii008, 
   l_xmii008_6_desc LIKE type_t.chr500, 
   l_xmii012_6 LIKE xmii_t.xmii012, 
   l_xmii012_6_desc LIKE type_t.chr500, 
   l_xmii013_6 LIKE xmii_t.xmii013, 
   l_xmii013_6_desc LIKE type_t.chr500, 
   l_xmii011_6 LIKE xmii_t.xmii011, 
   l_xmii011_6_desc LIKE type_t.chr500,
   l_xmii009_6 LIKE xmii_t.xmii009, 
   l_xmii009_6_desc LIKE type_t.chr500, 
   l_xmii009_6_desc_1 LIKE type_t.chr500, 
   l_xmii010_6 LIKE xmii_t.xmii010, 
   l_xmii017_6 LIKE xmii_t.xmii017, 
   l_xmii017_6_desc LIKE type_t.chr500, 
   l_xmii014_6 LIKE xmii_t.xmii014, 
   l_xmii022_6_01 LIKE type_t.num20_6, 
   l_xmii023_6_01 LIKE type_t.num20_6, 
   l_xmii022_6_02 LIKE type_t.num20_6, 
   l_xmii023_6_02 LIKE type_t.num20_6, 
   l_xmii022_6_03 LIKE type_t.num20_6, 
   l_xmii023_6_03 LIKE type_t.num20_6, 
   l_xmii022_6_04 LIKE type_t.num20_6, 
   l_xmii023_6_04 LIKE type_t.num20_6, 
   l_xmii022_6_05 LIKE type_t.num20_6, 
   l_xmii023_6_05 LIKE type_t.num20_6, 
   l_xmii022_6_06 LIKE type_t.num20_6, 
   l_xmii023_6_06 LIKE type_t.num20_6, 
   l_xmii022_6_07 LIKE type_t.num20_6, 
   l_xmii023_6_07 LIKE type_t.num20_6, 
   l_xmii022_6_08 LIKE type_t.num20_6, 
   l_xmii023_6_08 LIKE type_t.num20_6, 
   l_xmii022_6_09 LIKE type_t.num20_6, 
   l_xmii023_6_09 LIKE type_t.num20_6, 
   l_xmii022_6_10 LIKE type_t.num20_6, 
   l_xmii023_6_10 LIKE type_t.num20_6, 
   l_xmii022_6_11 LIKE type_t.num20_6, 
   l_xmii023_6_11 LIKE type_t.num20_6, 
   l_xmii022_6_12 LIKE type_t.num20_6, 
   l_xmii023_6_12 LIKE type_t.num20_6, 
   l_xmii022_6_13 LIKE type_t.num20_6, 
   l_xmii023_6_13 LIKE type_t.num20_6, 
   l_xmii022_6_14 LIKE type_t.num20_6, 
   l_xmii023_6_14 LIKE type_t.num20_6, 
   l_xmii022_6_15 LIKE type_t.num20_6, 
   l_xmii023_6_15 LIKE type_t.num20_6, 
   l_xmii022_6_16 LIKE type_t.num20_6, 
   l_xmii023_6_16 LIKE type_t.num20_6, 
   l_xmii022_6_17 LIKE type_t.num20_6, 
   l_xmii023_6_17 LIKE type_t.num20_6, 
   l_xmii022_6_18 LIKE type_t.num20_6, 
   l_xmii023_6_18 LIKE type_t.num20_6, 
   l_xmii022_6_19 LIKE type_t.num20_6, 
   l_xmii023_6_19 LIKE type_t.num20_6, 
   l_xmii022_6_20 LIKE type_t.num20_6, 
   l_xmii023_6_20 LIKE type_t.num20_6, 
   l_xmii022_6_21 LIKE type_t.num20_6, 
   l_xmii023_6_21 LIKE type_t.num20_6, 
   l_xmii022_6_22 LIKE type_t.num20_6, 
   l_xmii023_6_22 LIKE type_t.num20_6, 
   l_xmii022_6_23 LIKE type_t.num20_6, 
   l_xmii023_6_23 LIKE type_t.num20_6, 
   l_xmii022_6_24 LIKE type_t.num20_6, 
   l_xmii023_6_24 LIKE type_t.num20_6, 
   l_xmii022_6_s LIKE type_t.num20_6, 
   l_xmii023_6_s LIKE type_t.num20_6
       END RECORD  

 TYPE type_g_xmii7_d        RECORD
   l_xmii007_7 LIKE xmii_t.xmii007, 
   l_xmii007_7_desc LIKE type_t.chr500, 
   l_xmii006_7 LIKE xmii_t.xmii006, 
   l_xmii006_7_desc LIKE type_t.chr500, 
   l_xmii008_7 LIKE xmii_t.xmii008, 
   l_xmii008_7_desc LIKE type_t.chr500, 
   l_xmii012_7 LIKE xmii_t.xmii012, 
   l_xmii012_7_desc LIKE type_t.chr500, 
   l_xmii013_7 LIKE xmii_t.xmii013, 
   l_xmii013_7_desc LIKE type_t.chr500, 
   l_xmii011_7 LIKE xmii_t.xmii011, 
   l_xmii011_7_desc LIKE type_t.chr500,
   l_xmii009_7 LIKE xmii_t.xmii009, 
   l_xmii009_7_desc LIKE type_t.chr500, 
   l_xmii009_7_desc_1 LIKE type_t.chr500, 
   l_xmii010_7 LIKE xmii_t.xmii010, 
   l_xmii017_7 LIKE xmii_t.xmii017, 
   l_xmii017_7_desc LIKE type_t.chr500, 
   l_xmii014_7 LIKE xmii_t.xmii014, 
   l_xmii022_7_01 LIKE type_t.num20_6, 
   l_xmii023_7_01 LIKE type_t.num20_6, 
   l_xmii022_7_02 LIKE type_t.num20_6, 
   l_xmii023_7_02 LIKE type_t.num20_6, 
   l_xmii022_7_03 LIKE type_t.num20_6, 
   l_xmii023_7_03 LIKE type_t.num20_6, 
   l_xmii022_7_04 LIKE type_t.num20_6, 
   l_xmii023_7_04 LIKE type_t.num20_6, 
   l_xmii022_7_05 LIKE type_t.num20_6, 
   l_xmii023_7_05 LIKE type_t.num20_6, 
   l_xmii022_7_06 LIKE type_t.num20_6, 
   l_xmii023_7_06 LIKE type_t.num20_6, 
   l_xmii022_7_07 LIKE type_t.num20_6, 
   l_xmii023_7_07 LIKE type_t.num20_6, 
   l_xmii022_7_08 LIKE type_t.num20_6, 
   l_xmii023_7_08 LIKE type_t.num20_6, 
   l_xmii022_7_09 LIKE type_t.num20_6, 
   l_xmii023_7_09 LIKE type_t.num20_6, 
   l_xmii022_7_10 LIKE type_t.num20_6, 
   l_xmii023_7_10 LIKE type_t.num20_6, 
   l_xmii022_7_11 LIKE type_t.num20_6, 
   l_xmii023_7_11 LIKE type_t.num20_6, 
   l_xmii022_7_12 LIKE type_t.num20_6, 
   l_xmii023_7_12 LIKE type_t.num20_6, 
   l_xmii022_7_13 LIKE type_t.num20_6, 
   l_xmii023_7_13 LIKE type_t.num20_6, 
   l_xmii022_7_14 LIKE type_t.num20_6, 
   l_xmii023_7_14 LIKE type_t.num20_6, 
   l_xmii022_7_15 LIKE type_t.num20_6, 
   l_xmii023_7_15 LIKE type_t.num20_6, 
   l_xmii022_7_16 LIKE type_t.num20_6, 
   l_xmii023_7_16 LIKE type_t.num20_6, 
   l_xmii022_7_17 LIKE type_t.num20_6, 
   l_xmii023_7_17 LIKE type_t.num20_6, 
   l_xmii022_7_18 LIKE type_t.num20_6, 
   l_xmii023_7_18 LIKE type_t.num20_6, 
   l_xmii022_7_19 LIKE type_t.num20_6, 
   l_xmii023_7_19 LIKE type_t.num20_6, 
   l_xmii022_7_20 LIKE type_t.num20_6, 
   l_xmii023_7_20 LIKE type_t.num20_6, 
   l_xmii022_7_21 LIKE type_t.num20_6, 
   l_xmii023_7_21 LIKE type_t.num20_6, 
   l_xmii022_7_22 LIKE type_t.num20_6, 
   l_xmii023_7_22 LIKE type_t.num20_6, 
   l_xmii022_7_23 LIKE type_t.num20_6, 
   l_xmii023_7_23 LIKE type_t.num20_6, 
   l_xmii022_7_24 LIKE type_t.num20_6, 
   l_xmii023_7_24 LIKE type_t.num20_6, 
   l_xmii022_7_s LIKE type_t.num20_6, 
   l_xmii023_7_s LIKE type_t.num20_6
                      END RECORD
DEFINE g_xmii4_d          DYNAMIC ARRAY OF type_g_xmii4_d
DEFINE g_xmii5_d          DYNAMIC ARRAY OF type_g_xmii5_d
DEFINE g_xmii6_d          DYNAMIC ARRAY OF type_g_xmii6_d
DEFINE g_xmii7_d          DYNAMIC ARRAY OF type_g_xmii7_d
DEFINE g_rec_b1           LIKE type_t.num5]]>
  </point>
  <point name="init.define" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[   DEFINE ls_hide   STRING
   DEFINE li_i      LIKE type_t.num5
   DEFINE lc_index  LIKE type_t.chr2]]>
  </point>
  <point name="init.init" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[   CALL cl_set_combo_scc_part('xmih005_stus','13','N,Y,C')
   LET ls_hide = ' '   
   FOR li_i = 1 TO 24     #欄位的隱藏
      LET lc_index = li_i USING '&&' 
      IF li_i = 1 THEN      
         LET ls_hide = ls_hide || "l_xmii018_" || lc_index || ",l_xmii019_" || lc_index || ",l_xmii022_" || lc_index || ",l_xmii023_" || lc_index
                               || ",l_xmii018_4_" || lc_index || ",l_xmii019_4_" || lc_index || ",l_xmii018_5_" || lc_index || ",l_xmii019_5_" || lc_index
                               || ",l_xmii022_6_" || lc_index || ",l_xmii023_6_" || lc_index || ",l_xmii022_7_" || lc_index || ",l_xmii023_7_" || lc_index  
                               || ",l_xmii018_3_" || lc_index || ",l_xmii019_3_" || lc_index || ",l_xmii022_3_" || lc_index || ",l_xmii023_3_" || lc_index                               
      ELSE
         LET ls_hide = ls_hide || ",l_xmii018_" || lc_index || ",l_xmii019_" || lc_index || ",l_xmii022_" || lc_index || ",l_xmii023_" || lc_index
                               || ",l_xmii018_4_" || lc_index || ",l_xmii019_4_" || lc_index || ",l_xmii018_5_" || lc_index || ",l_xmii019_5_" || lc_index
                               || ",l_xmii022_6_" || lc_index || ",l_xmii023_6_" || lc_index || ",l_xmii022_7_" || lc_index || ",l_xmii023_7_" || lc_index     
                               || ",l_xmii018_3_" || lc_index || ",l_xmii019_3_" || lc_index || ",l_xmii022_3_" || lc_index || ",l_xmii023_3_" || lc_index                               
      END IF      
   END FOR  
   CALL cl_set_comp_visible(ls_hide,FALSE)    ]]>
  </point>
  <point name="input.a.ooai001" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmih_m.ooai001
            CALL ap_ref_array2(g_ref_fields,"SELECT ooail003 FROM ooail_t WHERE ooailent='"||g_enterprise||"' AND ooail001=? AND ooail002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmih_m.ooai001_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmih_m.ooai001_desc

]]>
  </point>
  <point name="input.a.page1.l_xmii019_01" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xmii_d[l_ac].l_xmii019_01) AND NOT cl_null(g_xmii_d[l_ac].l_xmii018_01) THEN
               IF g_xmii_d[l_ac].l_xmii019_01 < 0 AND g_xmii_d[l_ac].l_xmii019_01*(-1) > g_xmii_d[l_ac].l_xmii018_01 THEN
                  CALL cl_err(g_xmii_d[l_ac].l_xmii019_01,'axm-00257',1)    
                  NEXT FIELD l_xmii019_01  
               END IF
#               LET g_xmii[1].xmii020 = g_xmii_d[l_ac].l_xmii018_01 + g_xmii_d[l_ac].l_xmii019_01 
#               LET g_xmii[1].xmii022 = g_xmii[1].xmii020 *  g_xmii2_d[l_ac].l_xmii022_01
            END IF
           ]]>
  </point>
  <point name="input.a.page1.xmii005" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xmih_m.xmih001 IS NOT NULL AND g_xmih_m.xmih002 IS NOT NULL AND g_xmih_m.xmih003 IS NOT NULL AND g_xmih_m.xmih004 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii005 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii006 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii007 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii008 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii009 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii010 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii011 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii012 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii013 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii014 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmih_m.xmih001 != g_xmih001_t OR g_xmih_m.xmih002 != g_xmih002_t OR g_xmih_m.xmih003 != g_xmih003_t OR g_xmih_m.xmih004 != g_xmih004_t OR g_xmii_d[g_detail_idx].xmii005 != g_xmii_d_t.xmii005 OR g_xmii_d[g_detail_idx].xmii006 != g_xmii_d_t.xmii006 OR g_xmii_d[g_detail_idx].xmii007 != g_xmii_d_t.xmii007 OR g_xmii_d[g_detail_idx].xmii008 != g_xmii_d_t.xmii008 OR g_xmii_d[g_detail_idx].xmii009 != g_xmii_d_t.xmii009 OR g_xmii_d[g_detail_idx].xmii010 != g_xmii_d_t.xmii010 OR g_xmii_d[g_detail_idx].xmii011 != g_xmii_d_t.xmii011 OR g_xmii_d[g_detail_idx].xmii012 != g_xmii_d_t.xmii012 OR g_xmii_d[g_detail_idx].xmii013 != g_xmii_d_t.xmii013 OR g_xmii_d[g_detail_idx].xmii014 != g_xmii_d_t.xmii014)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xmii_t WHERE "||"xmiient = '" ||g_enterprise|| "' AND "||"xmii001 = '"||g_xmih_m.xmih001 ||"' AND "|| "xmii002 = '"||g_xmih_m.xmih002 ||"' AND "|| "xmii003 = '"||g_xmih_m.xmih003 ||"' AND "|| "xmii004 = '"||g_xmih_m.xmih004 ||"' AND "|| "xmii005 = '"||g_xmii_d[g_detail_idx].xmii005 ||"' AND "|| "xmii006 = '"||g_xmii_d[g_detail_idx].xmii006 ||"' AND "|| "xmii007 = '"||g_xmii_d[g_detail_idx].xmii007 ||"' AND "|| "xmii008 = '"||g_xmii_d[g_detail_idx].xmii008 ||"' AND "|| "xmii009 = '"||g_xmii_d[g_detail_idx].xmii009 ||"' AND "|| "xmii010 = '"||g_xmii_d[g_detail_idx].xmii010 ||"' AND "|| "xmii011 = '"||g_xmii_d[g_detail_idx].xmii011 ||"' AND "|| "xmii012 = '"||g_xmii_d[g_detail_idx].xmii012 ||"' AND "|| "xmii013 = '"||g_xmii_d[g_detail_idx].xmii013 ||"' AND "|| "xmii014 = '"||g_xmii_d[g_detail_idx].xmii014 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page1.xmii006" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xmih_m.xmih001 IS NOT NULL AND g_xmih_m.xmih002 IS NOT NULL AND g_xmih_m.xmih003 IS NOT NULL AND g_xmih_m.xmih004 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii005 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii006 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii007 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii008 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii009 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii010 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii011 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii012 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii013 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii014 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmih_m.xmih001 != g_xmih001_t OR g_xmih_m.xmih002 != g_xmih002_t OR g_xmih_m.xmih003 != g_xmih003_t OR g_xmih_m.xmih004 != g_xmih004_t OR g_xmii_d[g_detail_idx].xmii005 != g_xmii_d_t.xmii005 OR g_xmii_d[g_detail_idx].xmii006 != g_xmii_d_t.xmii006 OR g_xmii_d[g_detail_idx].xmii007 != g_xmii_d_t.xmii007 OR g_xmii_d[g_detail_idx].xmii008 != g_xmii_d_t.xmii008 OR g_xmii_d[g_detail_idx].xmii009 != g_xmii_d_t.xmii009 OR g_xmii_d[g_detail_idx].xmii010 != g_xmii_d_t.xmii010 OR g_xmii_d[g_detail_idx].xmii011 != g_xmii_d_t.xmii011 OR g_xmii_d[g_detail_idx].xmii012 != g_xmii_d_t.xmii012 OR g_xmii_d[g_detail_idx].xmii013 != g_xmii_d_t.xmii013 OR g_xmii_d[g_detail_idx].xmii014 != g_xmii_d_t.xmii014)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xmii_t WHERE "||"xmiient = '" ||g_enterprise|| "' AND "||"xmii001 = '"||g_xmih_m.xmih001 ||"' AND "|| "xmii002 = '"||g_xmih_m.xmih002 ||"' AND "|| "xmii003 = '"||g_xmih_m.xmih003 ||"' AND "|| "xmii004 = '"||g_xmih_m.xmih004 ||"' AND "|| "xmii005 = '"||g_xmii_d[g_detail_idx].xmii005 ||"' AND "|| "xmii006 = '"||g_xmii_d[g_detail_idx].xmii006 ||"' AND "|| "xmii007 = '"||g_xmii_d[g_detail_idx].xmii007 ||"' AND "|| "xmii008 = '"||g_xmii_d[g_detail_idx].xmii008 ||"' AND "|| "xmii009 = '"||g_xmii_d[g_detail_idx].xmii009 ||"' AND "|| "xmii010 = '"||g_xmii_d[g_detail_idx].xmii010 ||"' AND "|| "xmii011 = '"||g_xmii_d[g_detail_idx].xmii011 ||"' AND "|| "xmii012 = '"||g_xmii_d[g_detail_idx].xmii012 ||"' AND "|| "xmii013 = '"||g_xmii_d[g_detail_idx].xmii013 ||"' AND "|| "xmii014 = '"||g_xmii_d[g_detail_idx].xmii014 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page1.xmii007" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xmih_m.xmih001 IS NOT NULL AND g_xmih_m.xmih002 IS NOT NULL AND g_xmih_m.xmih003 IS NOT NULL AND g_xmih_m.xmih004 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii005 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii006 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii007 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii008 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii009 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii010 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii011 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii012 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii013 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii014 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmih_m.xmih001 != g_xmih001_t OR g_xmih_m.xmih002 != g_xmih002_t OR g_xmih_m.xmih003 != g_xmih003_t OR g_xmih_m.xmih004 != g_xmih004_t OR g_xmii_d[g_detail_idx].xmii005 != g_xmii_d_t.xmii005 OR g_xmii_d[g_detail_idx].xmii006 != g_xmii_d_t.xmii006 OR g_xmii_d[g_detail_idx].xmii007 != g_xmii_d_t.xmii007 OR g_xmii_d[g_detail_idx].xmii008 != g_xmii_d_t.xmii008 OR g_xmii_d[g_detail_idx].xmii009 != g_xmii_d_t.xmii009 OR g_xmii_d[g_detail_idx].xmii010 != g_xmii_d_t.xmii010 OR g_xmii_d[g_detail_idx].xmii011 != g_xmii_d_t.xmii011 OR g_xmii_d[g_detail_idx].xmii012 != g_xmii_d_t.xmii012 OR g_xmii_d[g_detail_idx].xmii013 != g_xmii_d_t.xmii013 OR g_xmii_d[g_detail_idx].xmii014 != g_xmii_d_t.xmii014)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xmii_t WHERE "||"xmiient = '" ||g_enterprise|| "' AND "||"xmii001 = '"||g_xmih_m.xmih001 ||"' AND "|| "xmii002 = '"||g_xmih_m.xmih002 ||"' AND "|| "xmii003 = '"||g_xmih_m.xmih003 ||"' AND "|| "xmii004 = '"||g_xmih_m.xmih004 ||"' AND "|| "xmii005 = '"||g_xmii_d[g_detail_idx].xmii005 ||"' AND "|| "xmii006 = '"||g_xmii_d[g_detail_idx].xmii006 ||"' AND "|| "xmii007 = '"||g_xmii_d[g_detail_idx].xmii007 ||"' AND "|| "xmii008 = '"||g_xmii_d[g_detail_idx].xmii008 ||"' AND "|| "xmii009 = '"||g_xmii_d[g_detail_idx].xmii009 ||"' AND "|| "xmii010 = '"||g_xmii_d[g_detail_idx].xmii010 ||"' AND "|| "xmii011 = '"||g_xmii_d[g_detail_idx].xmii011 ||"' AND "|| "xmii012 = '"||g_xmii_d[g_detail_idx].xmii012 ||"' AND "|| "xmii013 = '"||g_xmii_d[g_detail_idx].xmii013 ||"' AND "|| "xmii014 = '"||g_xmii_d[g_detail_idx].xmii014 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page1.xmii008" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xmih_m.xmih001 IS NOT NULL AND g_xmih_m.xmih002 IS NOT NULL AND g_xmih_m.xmih003 IS NOT NULL AND g_xmih_m.xmih004 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii005 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii006 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii007 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii008 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii009 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii010 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii011 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii012 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii013 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii014 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmih_m.xmih001 != g_xmih001_t OR g_xmih_m.xmih002 != g_xmih002_t OR g_xmih_m.xmih003 != g_xmih003_t OR g_xmih_m.xmih004 != g_xmih004_t OR g_xmii_d[g_detail_idx].xmii005 != g_xmii_d_t.xmii005 OR g_xmii_d[g_detail_idx].xmii006 != g_xmii_d_t.xmii006 OR g_xmii_d[g_detail_idx].xmii007 != g_xmii_d_t.xmii007 OR g_xmii_d[g_detail_idx].xmii008 != g_xmii_d_t.xmii008 OR g_xmii_d[g_detail_idx].xmii009 != g_xmii_d_t.xmii009 OR g_xmii_d[g_detail_idx].xmii010 != g_xmii_d_t.xmii010 OR g_xmii_d[g_detail_idx].xmii011 != g_xmii_d_t.xmii011 OR g_xmii_d[g_detail_idx].xmii012 != g_xmii_d_t.xmii012 OR g_xmii_d[g_detail_idx].xmii013 != g_xmii_d_t.xmii013 OR g_xmii_d[g_detail_idx].xmii014 != g_xmii_d_t.xmii014)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xmii_t WHERE "||"xmiient = '" ||g_enterprise|| "' AND "||"xmii001 = '"||g_xmih_m.xmih001 ||"' AND "|| "xmii002 = '"||g_xmih_m.xmih002 ||"' AND "|| "xmii003 = '"||g_xmih_m.xmih003 ||"' AND "|| "xmii004 = '"||g_xmih_m.xmih004 ||"' AND "|| "xmii005 = '"||g_xmii_d[g_detail_idx].xmii005 ||"' AND "|| "xmii006 = '"||g_xmii_d[g_detail_idx].xmii006 ||"' AND "|| "xmii007 = '"||g_xmii_d[g_detail_idx].xmii007 ||"' AND "|| "xmii008 = '"||g_xmii_d[g_detail_idx].xmii008 ||"' AND "|| "xmii009 = '"||g_xmii_d[g_detail_idx].xmii009 ||"' AND "|| "xmii010 = '"||g_xmii_d[g_detail_idx].xmii010 ||"' AND "|| "xmii011 = '"||g_xmii_d[g_detail_idx].xmii011 ||"' AND "|| "xmii012 = '"||g_xmii_d[g_detail_idx].xmii012 ||"' AND "|| "xmii013 = '"||g_xmii_d[g_detail_idx].xmii013 ||"' AND "|| "xmii014 = '"||g_xmii_d[g_detail_idx].xmii014 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page1.xmii009" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xmih_m.xmih001 IS NOT NULL AND g_xmih_m.xmih002 IS NOT NULL AND g_xmih_m.xmih003 IS NOT NULL AND g_xmih_m.xmih004 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii005 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii006 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii007 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii008 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii009 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii010 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii011 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii012 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii013 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii014 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmih_m.xmih001 != g_xmih001_t OR g_xmih_m.xmih002 != g_xmih002_t OR g_xmih_m.xmih003 != g_xmih003_t OR g_xmih_m.xmih004 != g_xmih004_t OR g_xmii_d[g_detail_idx].xmii005 != g_xmii_d_t.xmii005 OR g_xmii_d[g_detail_idx].xmii006 != g_xmii_d_t.xmii006 OR g_xmii_d[g_detail_idx].xmii007 != g_xmii_d_t.xmii007 OR g_xmii_d[g_detail_idx].xmii008 != g_xmii_d_t.xmii008 OR g_xmii_d[g_detail_idx].xmii009 != g_xmii_d_t.xmii009 OR g_xmii_d[g_detail_idx].xmii010 != g_xmii_d_t.xmii010 OR g_xmii_d[g_detail_idx].xmii011 != g_xmii_d_t.xmii011 OR g_xmii_d[g_detail_idx].xmii012 != g_xmii_d_t.xmii012 OR g_xmii_d[g_detail_idx].xmii013 != g_xmii_d_t.xmii013 OR g_xmii_d[g_detail_idx].xmii014 != g_xmii_d_t.xmii014)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xmii_t WHERE "||"xmiient = '" ||g_enterprise|| "' AND "||"xmii001 = '"||g_xmih_m.xmih001 ||"' AND "|| "xmii002 = '"||g_xmih_m.xmih002 ||"' AND "|| "xmii003 = '"||g_xmih_m.xmih003 ||"' AND "|| "xmii004 = '"||g_xmih_m.xmih004 ||"' AND "|| "xmii005 = '"||g_xmii_d[g_detail_idx].xmii005 ||"' AND "|| "xmii006 = '"||g_xmii_d[g_detail_idx].xmii006 ||"' AND "|| "xmii007 = '"||g_xmii_d[g_detail_idx].xmii007 ||"' AND "|| "xmii008 = '"||g_xmii_d[g_detail_idx].xmii008 ||"' AND "|| "xmii009 = '"||g_xmii_d[g_detail_idx].xmii009 ||"' AND "|| "xmii010 = '"||g_xmii_d[g_detail_idx].xmii010 ||"' AND "|| "xmii011 = '"||g_xmii_d[g_detail_idx].xmii011 ||"' AND "|| "xmii012 = '"||g_xmii_d[g_detail_idx].xmii012 ||"' AND "|| "xmii013 = '"||g_xmii_d[g_detail_idx].xmii013 ||"' AND "|| "xmii014 = '"||g_xmii_d[g_detail_idx].xmii014 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page1.xmii010" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xmih_m.xmih001 IS NOT NULL AND g_xmih_m.xmih002 IS NOT NULL AND g_xmih_m.xmih003 IS NOT NULL AND g_xmih_m.xmih004 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii005 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii006 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii007 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii008 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii009 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii010 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii011 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii012 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii013 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii014 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmih_m.xmih001 != g_xmih001_t OR g_xmih_m.xmih002 != g_xmih002_t OR g_xmih_m.xmih003 != g_xmih003_t OR g_xmih_m.xmih004 != g_xmih004_t OR g_xmii_d[g_detail_idx].xmii005 != g_xmii_d_t.xmii005 OR g_xmii_d[g_detail_idx].xmii006 != g_xmii_d_t.xmii006 OR g_xmii_d[g_detail_idx].xmii007 != g_xmii_d_t.xmii007 OR g_xmii_d[g_detail_idx].xmii008 != g_xmii_d_t.xmii008 OR g_xmii_d[g_detail_idx].xmii009 != g_xmii_d_t.xmii009 OR g_xmii_d[g_detail_idx].xmii010 != g_xmii_d_t.xmii010 OR g_xmii_d[g_detail_idx].xmii011 != g_xmii_d_t.xmii011 OR g_xmii_d[g_detail_idx].xmii012 != g_xmii_d_t.xmii012 OR g_xmii_d[g_detail_idx].xmii013 != g_xmii_d_t.xmii013 OR g_xmii_d[g_detail_idx].xmii014 != g_xmii_d_t.xmii014)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xmii_t WHERE "||"xmiient = '" ||g_enterprise|| "' AND "||"xmii001 = '"||g_xmih_m.xmih001 ||"' AND "|| "xmii002 = '"||g_xmih_m.xmih002 ||"' AND "|| "xmii003 = '"||g_xmih_m.xmih003 ||"' AND "|| "xmii004 = '"||g_xmih_m.xmih004 ||"' AND "|| "xmii005 = '"||g_xmii_d[g_detail_idx].xmii005 ||"' AND "|| "xmii006 = '"||g_xmii_d[g_detail_idx].xmii006 ||"' AND "|| "xmii007 = '"||g_xmii_d[g_detail_idx].xmii007 ||"' AND "|| "xmii008 = '"||g_xmii_d[g_detail_idx].xmii008 ||"' AND "|| "xmii009 = '"||g_xmii_d[g_detail_idx].xmii009 ||"' AND "|| "xmii010 = '"||g_xmii_d[g_detail_idx].xmii010 ||"' AND "|| "xmii011 = '"||g_xmii_d[g_detail_idx].xmii011 ||"' AND "|| "xmii012 = '"||g_xmii_d[g_detail_idx].xmii012 ||"' AND "|| "xmii013 = '"||g_xmii_d[g_detail_idx].xmii013 ||"' AND "|| "xmii014 = '"||g_xmii_d[g_detail_idx].xmii014 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page1.xmii011" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xmih_m.xmih001 IS NOT NULL AND g_xmih_m.xmih002 IS NOT NULL AND g_xmih_m.xmih003 IS NOT NULL AND g_xmih_m.xmih004 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii005 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii006 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii007 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii008 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii009 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii010 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii011 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii012 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii013 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii014 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmih_m.xmih001 != g_xmih001_t OR g_xmih_m.xmih002 != g_xmih002_t OR g_xmih_m.xmih003 != g_xmih003_t OR g_xmih_m.xmih004 != g_xmih004_t OR g_xmii_d[g_detail_idx].xmii005 != g_xmii_d_t.xmii005 OR g_xmii_d[g_detail_idx].xmii006 != g_xmii_d_t.xmii006 OR g_xmii_d[g_detail_idx].xmii007 != g_xmii_d_t.xmii007 OR g_xmii_d[g_detail_idx].xmii008 != g_xmii_d_t.xmii008 OR g_xmii_d[g_detail_idx].xmii009 != g_xmii_d_t.xmii009 OR g_xmii_d[g_detail_idx].xmii010 != g_xmii_d_t.xmii010 OR g_xmii_d[g_detail_idx].xmii011 != g_xmii_d_t.xmii011 OR g_xmii_d[g_detail_idx].xmii012 != g_xmii_d_t.xmii012 OR g_xmii_d[g_detail_idx].xmii013 != g_xmii_d_t.xmii013 OR g_xmii_d[g_detail_idx].xmii014 != g_xmii_d_t.xmii014)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xmii_t WHERE "||"xmiient = '" ||g_enterprise|| "' AND "||"xmii001 = '"||g_xmih_m.xmih001 ||"' AND "|| "xmii002 = '"||g_xmih_m.xmih002 ||"' AND "|| "xmii003 = '"||g_xmih_m.xmih003 ||"' AND "|| "xmii004 = '"||g_xmih_m.xmih004 ||"' AND "|| "xmii005 = '"||g_xmii_d[g_detail_idx].xmii005 ||"' AND "|| "xmii006 = '"||g_xmii_d[g_detail_idx].xmii006 ||"' AND "|| "xmii007 = '"||g_xmii_d[g_detail_idx].xmii007 ||"' AND "|| "xmii008 = '"||g_xmii_d[g_detail_idx].xmii008 ||"' AND "|| "xmii009 = '"||g_xmii_d[g_detail_idx].xmii009 ||"' AND "|| "xmii010 = '"||g_xmii_d[g_detail_idx].xmii010 ||"' AND "|| "xmii011 = '"||g_xmii_d[g_detail_idx].xmii011 ||"' AND "|| "xmii012 = '"||g_xmii_d[g_detail_idx].xmii012 ||"' AND "|| "xmii013 = '"||g_xmii_d[g_detail_idx].xmii013 ||"' AND "|| "xmii014 = '"||g_xmii_d[g_detail_idx].xmii014 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page1.xmii012" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xmih_m.xmih001 IS NOT NULL AND g_xmih_m.xmih002 IS NOT NULL AND g_xmih_m.xmih003 IS NOT NULL AND g_xmih_m.xmih004 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii005 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii006 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii007 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii008 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii009 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii010 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii011 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii012 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii013 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii014 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmih_m.xmih001 != g_xmih001_t OR g_xmih_m.xmih002 != g_xmih002_t OR g_xmih_m.xmih003 != g_xmih003_t OR g_xmih_m.xmih004 != g_xmih004_t OR g_xmii_d[g_detail_idx].xmii005 != g_xmii_d_t.xmii005 OR g_xmii_d[g_detail_idx].xmii006 != g_xmii_d_t.xmii006 OR g_xmii_d[g_detail_idx].xmii007 != g_xmii_d_t.xmii007 OR g_xmii_d[g_detail_idx].xmii008 != g_xmii_d_t.xmii008 OR g_xmii_d[g_detail_idx].xmii009 != g_xmii_d_t.xmii009 OR g_xmii_d[g_detail_idx].xmii010 != g_xmii_d_t.xmii010 OR g_xmii_d[g_detail_idx].xmii011 != g_xmii_d_t.xmii011 OR g_xmii_d[g_detail_idx].xmii012 != g_xmii_d_t.xmii012 OR g_xmii_d[g_detail_idx].xmii013 != g_xmii_d_t.xmii013 OR g_xmii_d[g_detail_idx].xmii014 != g_xmii_d_t.xmii014)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xmii_t WHERE "||"xmiient = '" ||g_enterprise|| "' AND "||"xmii001 = '"||g_xmih_m.xmih001 ||"' AND "|| "xmii002 = '"||g_xmih_m.xmih002 ||"' AND "|| "xmii003 = '"||g_xmih_m.xmih003 ||"' AND "|| "xmii004 = '"||g_xmih_m.xmih004 ||"' AND "|| "xmii005 = '"||g_xmii_d[g_detail_idx].xmii005 ||"' AND "|| "xmii006 = '"||g_xmii_d[g_detail_idx].xmii006 ||"' AND "|| "xmii007 = '"||g_xmii_d[g_detail_idx].xmii007 ||"' AND "|| "xmii008 = '"||g_xmii_d[g_detail_idx].xmii008 ||"' AND "|| "xmii009 = '"||g_xmii_d[g_detail_idx].xmii009 ||"' AND "|| "xmii010 = '"||g_xmii_d[g_detail_idx].xmii010 ||"' AND "|| "xmii011 = '"||g_xmii_d[g_detail_idx].xmii011 ||"' AND "|| "xmii012 = '"||g_xmii_d[g_detail_idx].xmii012 ||"' AND "|| "xmii013 = '"||g_xmii_d[g_detail_idx].xmii013 ||"' AND "|| "xmii014 = '"||g_xmii_d[g_detail_idx].xmii014 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page1.xmii013" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xmih_m.xmih001 IS NOT NULL AND g_xmih_m.xmih002 IS NOT NULL AND g_xmih_m.xmih003 IS NOT NULL AND g_xmih_m.xmih004 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii005 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii006 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii007 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii008 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii009 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii010 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii011 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii012 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii013 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii014 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmih_m.xmih001 != g_xmih001_t OR g_xmih_m.xmih002 != g_xmih002_t OR g_xmih_m.xmih003 != g_xmih003_t OR g_xmih_m.xmih004 != g_xmih004_t OR g_xmii_d[g_detail_idx].xmii005 != g_xmii_d_t.xmii005 OR g_xmii_d[g_detail_idx].xmii006 != g_xmii_d_t.xmii006 OR g_xmii_d[g_detail_idx].xmii007 != g_xmii_d_t.xmii007 OR g_xmii_d[g_detail_idx].xmii008 != g_xmii_d_t.xmii008 OR g_xmii_d[g_detail_idx].xmii009 != g_xmii_d_t.xmii009 OR g_xmii_d[g_detail_idx].xmii010 != g_xmii_d_t.xmii010 OR g_xmii_d[g_detail_idx].xmii011 != g_xmii_d_t.xmii011 OR g_xmii_d[g_detail_idx].xmii012 != g_xmii_d_t.xmii012 OR g_xmii_d[g_detail_idx].xmii013 != g_xmii_d_t.xmii013 OR g_xmii_d[g_detail_idx].xmii014 != g_xmii_d_t.xmii014)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xmii_t WHERE "||"xmiient = '" ||g_enterprise|| "' AND "||"xmii001 = '"||g_xmih_m.xmih001 ||"' AND "|| "xmii002 = '"||g_xmih_m.xmih002 ||"' AND "|| "xmii003 = '"||g_xmih_m.xmih003 ||"' AND "|| "xmii004 = '"||g_xmih_m.xmih004 ||"' AND "|| "xmii005 = '"||g_xmii_d[g_detail_idx].xmii005 ||"' AND "|| "xmii006 = '"||g_xmii_d[g_detail_idx].xmii006 ||"' AND "|| "xmii007 = '"||g_xmii_d[g_detail_idx].xmii007 ||"' AND "|| "xmii008 = '"||g_xmii_d[g_detail_idx].xmii008 ||"' AND "|| "xmii009 = '"||g_xmii_d[g_detail_idx].xmii009 ||"' AND "|| "xmii010 = '"||g_xmii_d[g_detail_idx].xmii010 ||"' AND "|| "xmii011 = '"||g_xmii_d[g_detail_idx].xmii011 ||"' AND "|| "xmii012 = '"||g_xmii_d[g_detail_idx].xmii012 ||"' AND "|| "xmii013 = '"||g_xmii_d[g_detail_idx].xmii013 ||"' AND "|| "xmii014 = '"||g_xmii_d[g_detail_idx].xmii014 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page1.xmii014" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xmih_m.xmih001 IS NOT NULL AND g_xmih_m.xmih002 IS NOT NULL AND g_xmih_m.xmih003 IS NOT NULL AND g_xmih_m.xmih004 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii005 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii006 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii007 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii008 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii009 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii010 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii011 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii012 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii013 IS NOT NULL AND g_xmii_d[g_detail_idx].xmii014 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmih_m.xmih001 != g_xmih001_t OR g_xmih_m.xmih002 != g_xmih002_t OR g_xmih_m.xmih003 != g_xmih003_t OR g_xmih_m.xmih004 != g_xmih004_t OR g_xmii_d[g_detail_idx].xmii005 != g_xmii_d_t.xmii005 OR g_xmii_d[g_detail_idx].xmii006 != g_xmii_d_t.xmii006 OR g_xmii_d[g_detail_idx].xmii007 != g_xmii_d_t.xmii007 OR g_xmii_d[g_detail_idx].xmii008 != g_xmii_d_t.xmii008 OR g_xmii_d[g_detail_idx].xmii009 != g_xmii_d_t.xmii009 OR g_xmii_d[g_detail_idx].xmii010 != g_xmii_d_t.xmii010 OR g_xmii_d[g_detail_idx].xmii011 != g_xmii_d_t.xmii011 OR g_xmii_d[g_detail_idx].xmii012 != g_xmii_d_t.xmii012 OR g_xmii_d[g_detail_idx].xmii013 != g_xmii_d_t.xmii013 OR g_xmii_d[g_detail_idx].xmii014 != g_xmii_d_t.xmii014)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xmii_t WHERE "||"xmiient = '" ||g_enterprise|| "' AND "||"xmii001 = '"||g_xmih_m.xmih001 ||"' AND "|| "xmii002 = '"||g_xmih_m.xmih002 ||"' AND "|| "xmii003 = '"||g_xmih_m.xmih003 ||"' AND "|| "xmii004 = '"||g_xmih_m.xmih004 ||"' AND "|| "xmii005 = '"||g_xmii_d[g_detail_idx].xmii005 ||"' AND "|| "xmii006 = '"||g_xmii_d[g_detail_idx].xmii006 ||"' AND "|| "xmii007 = '"||g_xmii_d[g_detail_idx].xmii007 ||"' AND "|| "xmii008 = '"||g_xmii_d[g_detail_idx].xmii008 ||"' AND "|| "xmii009 = '"||g_xmii_d[g_detail_idx].xmii009 ||"' AND "|| "xmii010 = '"||g_xmii_d[g_detail_idx].xmii010 ||"' AND "|| "xmii011 = '"||g_xmii_d[g_detail_idx].xmii011 ||"' AND "|| "xmii012 = '"||g_xmii_d[g_detail_idx].xmii012 ||"' AND "|| "xmii013 = '"||g_xmii_d[g_detail_idx].xmii013 ||"' AND "|| "xmii014 = '"||g_xmii_d[g_detail_idx].xmii014 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page1.xmii017" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmii_d[l_ac].xmii017
            CALL ap_ref_array2(g_ref_fields,"SELECT oocal003 FROM oocal_t WHERE oocalent='"||g_enterprise||"' AND oocal001=? AND oocal002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmii_d[l_ac].xmii017_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmii_d[l_ac].xmii017_desc

]]>
  </point>
  <point name="input.a.page2.xmii005_2" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xmih_m.xmih001 IS NOT NULL AND g_xmih_m.xmih002 IS NOT NULL AND g_xmih_m.xmih003 IS NOT NULL AND g_xmih_m.xmih004 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii005 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii006 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii007 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii008 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii009 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii010 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii011 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii012 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii013 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii014 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmih_m.xmih001 != g_xmih001_t OR g_xmih_m.xmih002 != g_xmih002_t OR g_xmih_m.xmih003 != g_xmih003_t OR g_xmih_m.xmih004 != g_xmih004_t OR g_xmii2_d[g_detail_idx].xmii005 != g_xmii2_d_t.xmii005 OR g_xmii2_d[g_detail_idx].xmii006 != g_xmii2_d_t.xmii006 OR g_xmii2_d[g_detail_idx].xmii007 != g_xmii2_d_t.xmii007 OR g_xmii2_d[g_detail_idx].xmii008 != g_xmii2_d_t.xmii008 OR g_xmii2_d[g_detail_idx].xmii009 != g_xmii2_d_t.xmii009 OR g_xmii2_d[g_detail_idx].xmii010 != g_xmii2_d_t.xmii010 OR g_xmii2_d[g_detail_idx].xmii011 != g_xmii2_d_t.xmii011 OR g_xmii2_d[g_detail_idx].xmii012 != g_xmii2_d_t.xmii012 OR g_xmii2_d[g_detail_idx].xmii013 != g_xmii2_d_t.xmii013 OR g_xmii2_d[g_detail_idx].xmii014 != g_xmii2_d_t.xmii014)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xmii_t WHERE "||"xmiient = '" ||g_enterprise|| "' AND "||"xmii001 = '"||g_xmih_m.xmih001 ||"' AND "|| "xmii002 = '"||g_xmih_m.xmih002 ||"' AND "|| "xmii003 = '"||g_xmih_m.xmih003 ||"' AND "|| "xmii004 = '"||g_xmih_m.xmih004 ||"' AND "|| "xmii005 = '"||g_xmii2_d[g_detail_idx].xmii005 ||"' AND "|| "xmii006 = '"||g_xmii2_d[g_detail_idx].xmii006 ||"' AND "|| "xmii007 = '"||g_xmii2_d[g_detail_idx].xmii007 ||"' AND "|| "xmii008 = '"||g_xmii2_d[g_detail_idx].xmii008 ||"' AND "|| "xmii009 = '"||g_xmii2_d[g_detail_idx].xmii009 ||"' AND "|| "xmii010 = '"||g_xmii2_d[g_detail_idx].xmii010 ||"' AND "|| "xmii011 = '"||g_xmii2_d[g_detail_idx].xmii011 ||"' AND "|| "xmii012 = '"||g_xmii2_d[g_detail_idx].xmii012 ||"' AND "|| "xmii013 = '"||g_xmii2_d[g_detail_idx].xmii013 ||"' AND "|| "xmii014 = '"||g_xmii2_d[g_detail_idx].xmii014 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page2.xmii006_2" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xmih_m.xmih001 IS NOT NULL AND g_xmih_m.xmih002 IS NOT NULL AND g_xmih_m.xmih003 IS NOT NULL AND g_xmih_m.xmih004 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii005 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii006 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii007 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii008 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii009 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii010 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii011 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii012 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii013 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii014 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmih_m.xmih001 != g_xmih001_t OR g_xmih_m.xmih002 != g_xmih002_t OR g_xmih_m.xmih003 != g_xmih003_t OR g_xmih_m.xmih004 != g_xmih004_t OR g_xmii2_d[g_detail_idx].xmii005 != g_xmii2_d_t.xmii005 OR g_xmii2_d[g_detail_idx].xmii006 != g_xmii2_d_t.xmii006 OR g_xmii2_d[g_detail_idx].xmii007 != g_xmii2_d_t.xmii007 OR g_xmii2_d[g_detail_idx].xmii008 != g_xmii2_d_t.xmii008 OR g_xmii2_d[g_detail_idx].xmii009 != g_xmii2_d_t.xmii009 OR g_xmii2_d[g_detail_idx].xmii010 != g_xmii2_d_t.xmii010 OR g_xmii2_d[g_detail_idx].xmii011 != g_xmii2_d_t.xmii011 OR g_xmii2_d[g_detail_idx].xmii012 != g_xmii2_d_t.xmii012 OR g_xmii2_d[g_detail_idx].xmii013 != g_xmii2_d_t.xmii013 OR g_xmii2_d[g_detail_idx].xmii014 != g_xmii2_d_t.xmii014)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xmii_t WHERE "||"xmiient = '" ||g_enterprise|| "' AND "||"xmii001 = '"||g_xmih_m.xmih001 ||"' AND "|| "xmii002 = '"||g_xmih_m.xmih002 ||"' AND "|| "xmii003 = '"||g_xmih_m.xmih003 ||"' AND "|| "xmii004 = '"||g_xmih_m.xmih004 ||"' AND "|| "xmii005 = '"||g_xmii2_d[g_detail_idx].xmii005 ||"' AND "|| "xmii006 = '"||g_xmii2_d[g_detail_idx].xmii006 ||"' AND "|| "xmii007 = '"||g_xmii2_d[g_detail_idx].xmii007 ||"' AND "|| "xmii008 = '"||g_xmii2_d[g_detail_idx].xmii008 ||"' AND "|| "xmii009 = '"||g_xmii2_d[g_detail_idx].xmii009 ||"' AND "|| "xmii010 = '"||g_xmii2_d[g_detail_idx].xmii010 ||"' AND "|| "xmii011 = '"||g_xmii2_d[g_detail_idx].xmii011 ||"' AND "|| "xmii012 = '"||g_xmii2_d[g_detail_idx].xmii012 ||"' AND "|| "xmii013 = '"||g_xmii2_d[g_detail_idx].xmii013 ||"' AND "|| "xmii014 = '"||g_xmii2_d[g_detail_idx].xmii014 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page2.xmii007_2" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xmih_m.xmih001 IS NOT NULL AND g_xmih_m.xmih002 IS NOT NULL AND g_xmih_m.xmih003 IS NOT NULL AND g_xmih_m.xmih004 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii005 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii006 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii007 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii008 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii009 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii010 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii011 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii012 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii013 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii014 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmih_m.xmih001 != g_xmih001_t OR g_xmih_m.xmih002 != g_xmih002_t OR g_xmih_m.xmih003 != g_xmih003_t OR g_xmih_m.xmih004 != g_xmih004_t OR g_xmii2_d[g_detail_idx].xmii005 != g_xmii2_d_t.xmii005 OR g_xmii2_d[g_detail_idx].xmii006 != g_xmii2_d_t.xmii006 OR g_xmii2_d[g_detail_idx].xmii007 != g_xmii2_d_t.xmii007 OR g_xmii2_d[g_detail_idx].xmii008 != g_xmii2_d_t.xmii008 OR g_xmii2_d[g_detail_idx].xmii009 != g_xmii2_d_t.xmii009 OR g_xmii2_d[g_detail_idx].xmii010 != g_xmii2_d_t.xmii010 OR g_xmii2_d[g_detail_idx].xmii011 != g_xmii2_d_t.xmii011 OR g_xmii2_d[g_detail_idx].xmii012 != g_xmii2_d_t.xmii012 OR g_xmii2_d[g_detail_idx].xmii013 != g_xmii2_d_t.xmii013 OR g_xmii2_d[g_detail_idx].xmii014 != g_xmii2_d_t.xmii014)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xmii_t WHERE "||"xmiient = '" ||g_enterprise|| "' AND "||"xmii001 = '"||g_xmih_m.xmih001 ||"' AND "|| "xmii002 = '"||g_xmih_m.xmih002 ||"' AND "|| "xmii003 = '"||g_xmih_m.xmih003 ||"' AND "|| "xmii004 = '"||g_xmih_m.xmih004 ||"' AND "|| "xmii005 = '"||g_xmii2_d[g_detail_idx].xmii005 ||"' AND "|| "xmii006 = '"||g_xmii2_d[g_detail_idx].xmii006 ||"' AND "|| "xmii007 = '"||g_xmii2_d[g_detail_idx].xmii007 ||"' AND "|| "xmii008 = '"||g_xmii2_d[g_detail_idx].xmii008 ||"' AND "|| "xmii009 = '"||g_xmii2_d[g_detail_idx].xmii009 ||"' AND "|| "xmii010 = '"||g_xmii2_d[g_detail_idx].xmii010 ||"' AND "|| "xmii011 = '"||g_xmii2_d[g_detail_idx].xmii011 ||"' AND "|| "xmii012 = '"||g_xmii2_d[g_detail_idx].xmii012 ||"' AND "|| "xmii013 = '"||g_xmii2_d[g_detail_idx].xmii013 ||"' AND "|| "xmii014 = '"||g_xmii2_d[g_detail_idx].xmii014 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page2.xmii008_2" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xmih_m.xmih001 IS NOT NULL AND g_xmih_m.xmih002 IS NOT NULL AND g_xmih_m.xmih003 IS NOT NULL AND g_xmih_m.xmih004 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii005 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii006 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii007 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii008 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii009 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii010 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii011 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii012 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii013 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii014 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmih_m.xmih001 != g_xmih001_t OR g_xmih_m.xmih002 != g_xmih002_t OR g_xmih_m.xmih003 != g_xmih003_t OR g_xmih_m.xmih004 != g_xmih004_t OR g_xmii2_d[g_detail_idx].xmii005 != g_xmii2_d_t.xmii005 OR g_xmii2_d[g_detail_idx].xmii006 != g_xmii2_d_t.xmii006 OR g_xmii2_d[g_detail_idx].xmii007 != g_xmii2_d_t.xmii007 OR g_xmii2_d[g_detail_idx].xmii008 != g_xmii2_d_t.xmii008 OR g_xmii2_d[g_detail_idx].xmii009 != g_xmii2_d_t.xmii009 OR g_xmii2_d[g_detail_idx].xmii010 != g_xmii2_d_t.xmii010 OR g_xmii2_d[g_detail_idx].xmii011 != g_xmii2_d_t.xmii011 OR g_xmii2_d[g_detail_idx].xmii012 != g_xmii2_d_t.xmii012 OR g_xmii2_d[g_detail_idx].xmii013 != g_xmii2_d_t.xmii013 OR g_xmii2_d[g_detail_idx].xmii014 != g_xmii2_d_t.xmii014)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xmii_t WHERE "||"xmiient = '" ||g_enterprise|| "' AND "||"xmii001 = '"||g_xmih_m.xmih001 ||"' AND "|| "xmii002 = '"||g_xmih_m.xmih002 ||"' AND "|| "xmii003 = '"||g_xmih_m.xmih003 ||"' AND "|| "xmii004 = '"||g_xmih_m.xmih004 ||"' AND "|| "xmii005 = '"||g_xmii2_d[g_detail_idx].xmii005 ||"' AND "|| "xmii006 = '"||g_xmii2_d[g_detail_idx].xmii006 ||"' AND "|| "xmii007 = '"||g_xmii2_d[g_detail_idx].xmii007 ||"' AND "|| "xmii008 = '"||g_xmii2_d[g_detail_idx].xmii008 ||"' AND "|| "xmii009 = '"||g_xmii2_d[g_detail_idx].xmii009 ||"' AND "|| "xmii010 = '"||g_xmii2_d[g_detail_idx].xmii010 ||"' AND "|| "xmii011 = '"||g_xmii2_d[g_detail_idx].xmii011 ||"' AND "|| "xmii012 = '"||g_xmii2_d[g_detail_idx].xmii012 ||"' AND "|| "xmii013 = '"||g_xmii2_d[g_detail_idx].xmii013 ||"' AND "|| "xmii014 = '"||g_xmii2_d[g_detail_idx].xmii014 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page2.xmii009_2" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xmih_m.xmih001 IS NOT NULL AND g_xmih_m.xmih002 IS NOT NULL AND g_xmih_m.xmih003 IS NOT NULL AND g_xmih_m.xmih004 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii005 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii006 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii007 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii008 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii009 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii010 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii011 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii012 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii013 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii014 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmih_m.xmih001 != g_xmih001_t OR g_xmih_m.xmih002 != g_xmih002_t OR g_xmih_m.xmih003 != g_xmih003_t OR g_xmih_m.xmih004 != g_xmih004_t OR g_xmii2_d[g_detail_idx].xmii005 != g_xmii2_d_t.xmii005 OR g_xmii2_d[g_detail_idx].xmii006 != g_xmii2_d_t.xmii006 OR g_xmii2_d[g_detail_idx].xmii007 != g_xmii2_d_t.xmii007 OR g_xmii2_d[g_detail_idx].xmii008 != g_xmii2_d_t.xmii008 OR g_xmii2_d[g_detail_idx].xmii009 != g_xmii2_d_t.xmii009 OR g_xmii2_d[g_detail_idx].xmii010 != g_xmii2_d_t.xmii010 OR g_xmii2_d[g_detail_idx].xmii011 != g_xmii2_d_t.xmii011 OR g_xmii2_d[g_detail_idx].xmii012 != g_xmii2_d_t.xmii012 OR g_xmii2_d[g_detail_idx].xmii013 != g_xmii2_d_t.xmii013 OR g_xmii2_d[g_detail_idx].xmii014 != g_xmii2_d_t.xmii014)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xmii_t WHERE "||"xmiient = '" ||g_enterprise|| "' AND "||"xmii001 = '"||g_xmih_m.xmih001 ||"' AND "|| "xmii002 = '"||g_xmih_m.xmih002 ||"' AND "|| "xmii003 = '"||g_xmih_m.xmih003 ||"' AND "|| "xmii004 = '"||g_xmih_m.xmih004 ||"' AND "|| "xmii005 = '"||g_xmii2_d[g_detail_idx].xmii005 ||"' AND "|| "xmii006 = '"||g_xmii2_d[g_detail_idx].xmii006 ||"' AND "|| "xmii007 = '"||g_xmii2_d[g_detail_idx].xmii007 ||"' AND "|| "xmii008 = '"||g_xmii2_d[g_detail_idx].xmii008 ||"' AND "|| "xmii009 = '"||g_xmii2_d[g_detail_idx].xmii009 ||"' AND "|| "xmii010 = '"||g_xmii2_d[g_detail_idx].xmii010 ||"' AND "|| "xmii011 = '"||g_xmii2_d[g_detail_idx].xmii011 ||"' AND "|| "xmii012 = '"||g_xmii2_d[g_detail_idx].xmii012 ||"' AND "|| "xmii013 = '"||g_xmii2_d[g_detail_idx].xmii013 ||"' AND "|| "xmii014 = '"||g_xmii2_d[g_detail_idx].xmii014 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page2.xmii010_2" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xmih_m.xmih001 IS NOT NULL AND g_xmih_m.xmih002 IS NOT NULL AND g_xmih_m.xmih003 IS NOT NULL AND g_xmih_m.xmih004 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii005 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii006 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii007 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii008 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii009 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii010 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii011 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii012 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii013 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii014 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmih_m.xmih001 != g_xmih001_t OR g_xmih_m.xmih002 != g_xmih002_t OR g_xmih_m.xmih003 != g_xmih003_t OR g_xmih_m.xmih004 != g_xmih004_t OR g_xmii2_d[g_detail_idx].xmii005 != g_xmii2_d_t.xmii005 OR g_xmii2_d[g_detail_idx].xmii006 != g_xmii2_d_t.xmii006 OR g_xmii2_d[g_detail_idx].xmii007 != g_xmii2_d_t.xmii007 OR g_xmii2_d[g_detail_idx].xmii008 != g_xmii2_d_t.xmii008 OR g_xmii2_d[g_detail_idx].xmii009 != g_xmii2_d_t.xmii009 OR g_xmii2_d[g_detail_idx].xmii010 != g_xmii2_d_t.xmii010 OR g_xmii2_d[g_detail_idx].xmii011 != g_xmii2_d_t.xmii011 OR g_xmii2_d[g_detail_idx].xmii012 != g_xmii2_d_t.xmii012 OR g_xmii2_d[g_detail_idx].xmii013 != g_xmii2_d_t.xmii013 OR g_xmii2_d[g_detail_idx].xmii014 != g_xmii2_d_t.xmii014)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xmii_t WHERE "||"xmiient = '" ||g_enterprise|| "' AND "||"xmii001 = '"||g_xmih_m.xmih001 ||"' AND "|| "xmii002 = '"||g_xmih_m.xmih002 ||"' AND "|| "xmii003 = '"||g_xmih_m.xmih003 ||"' AND "|| "xmii004 = '"||g_xmih_m.xmih004 ||"' AND "|| "xmii005 = '"||g_xmii2_d[g_detail_idx].xmii005 ||"' AND "|| "xmii006 = '"||g_xmii2_d[g_detail_idx].xmii006 ||"' AND "|| "xmii007 = '"||g_xmii2_d[g_detail_idx].xmii007 ||"' AND "|| "xmii008 = '"||g_xmii2_d[g_detail_idx].xmii008 ||"' AND "|| "xmii009 = '"||g_xmii2_d[g_detail_idx].xmii009 ||"' AND "|| "xmii010 = '"||g_xmii2_d[g_detail_idx].xmii010 ||"' AND "|| "xmii011 = '"||g_xmii2_d[g_detail_idx].xmii011 ||"' AND "|| "xmii012 = '"||g_xmii2_d[g_detail_idx].xmii012 ||"' AND "|| "xmii013 = '"||g_xmii2_d[g_detail_idx].xmii013 ||"' AND "|| "xmii014 = '"||g_xmii2_d[g_detail_idx].xmii014 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page2.xmii011_2" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xmih_m.xmih001 IS NOT NULL AND g_xmih_m.xmih002 IS NOT NULL AND g_xmih_m.xmih003 IS NOT NULL AND g_xmih_m.xmih004 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii005 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii006 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii007 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii008 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii009 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii010 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii011 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii012 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii013 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii014 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmih_m.xmih001 != g_xmih001_t OR g_xmih_m.xmih002 != g_xmih002_t OR g_xmih_m.xmih003 != g_xmih003_t OR g_xmih_m.xmih004 != g_xmih004_t OR g_xmii2_d[g_detail_idx].xmii005 != g_xmii2_d_t.xmii005 OR g_xmii2_d[g_detail_idx].xmii006 != g_xmii2_d_t.xmii006 OR g_xmii2_d[g_detail_idx].xmii007 != g_xmii2_d_t.xmii007 OR g_xmii2_d[g_detail_idx].xmii008 != g_xmii2_d_t.xmii008 OR g_xmii2_d[g_detail_idx].xmii009 != g_xmii2_d_t.xmii009 OR g_xmii2_d[g_detail_idx].xmii010 != g_xmii2_d_t.xmii010 OR g_xmii2_d[g_detail_idx].xmii011 != g_xmii2_d_t.xmii011 OR g_xmii2_d[g_detail_idx].xmii012 != g_xmii2_d_t.xmii012 OR g_xmii2_d[g_detail_idx].xmii013 != g_xmii2_d_t.xmii013 OR g_xmii2_d[g_detail_idx].xmii014 != g_xmii2_d_t.xmii014)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xmii_t WHERE "||"xmiient = '" ||g_enterprise|| "' AND "||"xmii001 = '"||g_xmih_m.xmih001 ||"' AND "|| "xmii002 = '"||g_xmih_m.xmih002 ||"' AND "|| "xmii003 = '"||g_xmih_m.xmih003 ||"' AND "|| "xmii004 = '"||g_xmih_m.xmih004 ||"' AND "|| "xmii005 = '"||g_xmii2_d[g_detail_idx].xmii005 ||"' AND "|| "xmii006 = '"||g_xmii2_d[g_detail_idx].xmii006 ||"' AND "|| "xmii007 = '"||g_xmii2_d[g_detail_idx].xmii007 ||"' AND "|| "xmii008 = '"||g_xmii2_d[g_detail_idx].xmii008 ||"' AND "|| "xmii009 = '"||g_xmii2_d[g_detail_idx].xmii009 ||"' AND "|| "xmii010 = '"||g_xmii2_d[g_detail_idx].xmii010 ||"' AND "|| "xmii011 = '"||g_xmii2_d[g_detail_idx].xmii011 ||"' AND "|| "xmii012 = '"||g_xmii2_d[g_detail_idx].xmii012 ||"' AND "|| "xmii013 = '"||g_xmii2_d[g_detail_idx].xmii013 ||"' AND "|| "xmii014 = '"||g_xmii2_d[g_detail_idx].xmii014 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page2.xmii012_2" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xmih_m.xmih001 IS NOT NULL AND g_xmih_m.xmih002 IS NOT NULL AND g_xmih_m.xmih003 IS NOT NULL AND g_xmih_m.xmih004 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii005 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii006 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii007 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii008 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii009 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii010 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii011 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii012 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii013 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii014 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmih_m.xmih001 != g_xmih001_t OR g_xmih_m.xmih002 != g_xmih002_t OR g_xmih_m.xmih003 != g_xmih003_t OR g_xmih_m.xmih004 != g_xmih004_t OR g_xmii2_d[g_detail_idx].xmii005 != g_xmii2_d_t.xmii005 OR g_xmii2_d[g_detail_idx].xmii006 != g_xmii2_d_t.xmii006 OR g_xmii2_d[g_detail_idx].xmii007 != g_xmii2_d_t.xmii007 OR g_xmii2_d[g_detail_idx].xmii008 != g_xmii2_d_t.xmii008 OR g_xmii2_d[g_detail_idx].xmii009 != g_xmii2_d_t.xmii009 OR g_xmii2_d[g_detail_idx].xmii010 != g_xmii2_d_t.xmii010 OR g_xmii2_d[g_detail_idx].xmii011 != g_xmii2_d_t.xmii011 OR g_xmii2_d[g_detail_idx].xmii012 != g_xmii2_d_t.xmii012 OR g_xmii2_d[g_detail_idx].xmii013 != g_xmii2_d_t.xmii013 OR g_xmii2_d[g_detail_idx].xmii014 != g_xmii2_d_t.xmii014)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xmii_t WHERE "||"xmiient = '" ||g_enterprise|| "' AND "||"xmii001 = '"||g_xmih_m.xmih001 ||"' AND "|| "xmii002 = '"||g_xmih_m.xmih002 ||"' AND "|| "xmii003 = '"||g_xmih_m.xmih003 ||"' AND "|| "xmii004 = '"||g_xmih_m.xmih004 ||"' AND "|| "xmii005 = '"||g_xmii2_d[g_detail_idx].xmii005 ||"' AND "|| "xmii006 = '"||g_xmii2_d[g_detail_idx].xmii006 ||"' AND "|| "xmii007 = '"||g_xmii2_d[g_detail_idx].xmii007 ||"' AND "|| "xmii008 = '"||g_xmii2_d[g_detail_idx].xmii008 ||"' AND "|| "xmii009 = '"||g_xmii2_d[g_detail_idx].xmii009 ||"' AND "|| "xmii010 = '"||g_xmii2_d[g_detail_idx].xmii010 ||"' AND "|| "xmii011 = '"||g_xmii2_d[g_detail_idx].xmii011 ||"' AND "|| "xmii012 = '"||g_xmii2_d[g_detail_idx].xmii012 ||"' AND "|| "xmii013 = '"||g_xmii2_d[g_detail_idx].xmii013 ||"' AND "|| "xmii014 = '"||g_xmii2_d[g_detail_idx].xmii014 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page2.xmii013_2" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xmih_m.xmih001 IS NOT NULL AND g_xmih_m.xmih002 IS NOT NULL AND g_xmih_m.xmih003 IS NOT NULL AND g_xmih_m.xmih004 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii005 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii006 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii007 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii008 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii009 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii010 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii011 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii012 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii013 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii014 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmih_m.xmih001 != g_xmih001_t OR g_xmih_m.xmih002 != g_xmih002_t OR g_xmih_m.xmih003 != g_xmih003_t OR g_xmih_m.xmih004 != g_xmih004_t OR g_xmii2_d[g_detail_idx].xmii005 != g_xmii2_d_t.xmii005 OR g_xmii2_d[g_detail_idx].xmii006 != g_xmii2_d_t.xmii006 OR g_xmii2_d[g_detail_idx].xmii007 != g_xmii2_d_t.xmii007 OR g_xmii2_d[g_detail_idx].xmii008 != g_xmii2_d_t.xmii008 OR g_xmii2_d[g_detail_idx].xmii009 != g_xmii2_d_t.xmii009 OR g_xmii2_d[g_detail_idx].xmii010 != g_xmii2_d_t.xmii010 OR g_xmii2_d[g_detail_idx].xmii011 != g_xmii2_d_t.xmii011 OR g_xmii2_d[g_detail_idx].xmii012 != g_xmii2_d_t.xmii012 OR g_xmii2_d[g_detail_idx].xmii013 != g_xmii2_d_t.xmii013 OR g_xmii2_d[g_detail_idx].xmii014 != g_xmii2_d_t.xmii014)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xmii_t WHERE "||"xmiient = '" ||g_enterprise|| "' AND "||"xmii001 = '"||g_xmih_m.xmih001 ||"' AND "|| "xmii002 = '"||g_xmih_m.xmih002 ||"' AND "|| "xmii003 = '"||g_xmih_m.xmih003 ||"' AND "|| "xmii004 = '"||g_xmih_m.xmih004 ||"' AND "|| "xmii005 = '"||g_xmii2_d[g_detail_idx].xmii005 ||"' AND "|| "xmii006 = '"||g_xmii2_d[g_detail_idx].xmii006 ||"' AND "|| "xmii007 = '"||g_xmii2_d[g_detail_idx].xmii007 ||"' AND "|| "xmii008 = '"||g_xmii2_d[g_detail_idx].xmii008 ||"' AND "|| "xmii009 = '"||g_xmii2_d[g_detail_idx].xmii009 ||"' AND "|| "xmii010 = '"||g_xmii2_d[g_detail_idx].xmii010 ||"' AND "|| "xmii011 = '"||g_xmii2_d[g_detail_idx].xmii011 ||"' AND "|| "xmii012 = '"||g_xmii2_d[g_detail_idx].xmii012 ||"' AND "|| "xmii013 = '"||g_xmii2_d[g_detail_idx].xmii013 ||"' AND "|| "xmii014 = '"||g_xmii2_d[g_detail_idx].xmii014 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page2.xmii014_2" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xmih_m.xmih001 IS NOT NULL AND g_xmih_m.xmih002 IS NOT NULL AND g_xmih_m.xmih003 IS NOT NULL AND g_xmih_m.xmih004 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii005 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii006 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii007 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii008 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii009 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii010 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii011 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii012 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii013 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii014 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmih_m.xmih001 != g_xmih001_t OR g_xmih_m.xmih002 != g_xmih002_t OR g_xmih_m.xmih003 != g_xmih003_t OR g_xmih_m.xmih004 != g_xmih004_t OR g_xmii2_d[g_detail_idx].xmii005 != g_xmii2_d_t.xmii005 OR g_xmii2_d[g_detail_idx].xmii006 != g_xmii2_d_t.xmii006 OR g_xmii2_d[g_detail_idx].xmii007 != g_xmii2_d_t.xmii007 OR g_xmii2_d[g_detail_idx].xmii008 != g_xmii2_d_t.xmii008 OR g_xmii2_d[g_detail_idx].xmii009 != g_xmii2_d_t.xmii009 OR g_xmii2_d[g_detail_idx].xmii010 != g_xmii2_d_t.xmii010 OR g_xmii2_d[g_detail_idx].xmii011 != g_xmii2_d_t.xmii011 OR g_xmii2_d[g_detail_idx].xmii012 != g_xmii2_d_t.xmii012 OR g_xmii2_d[g_detail_idx].xmii013 != g_xmii2_d_t.xmii013 OR g_xmii2_d[g_detail_idx].xmii014 != g_xmii2_d_t.xmii014)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xmii_t WHERE "||"xmiient = '" ||g_enterprise|| "' AND "||"xmii001 = '"||g_xmih_m.xmih001 ||"' AND "|| "xmii002 = '"||g_xmih_m.xmih002 ||"' AND "|| "xmii003 = '"||g_xmih_m.xmih003 ||"' AND "|| "xmii004 = '"||g_xmih_m.xmih004 ||"' AND "|| "xmii005 = '"||g_xmii2_d[g_detail_idx].xmii005 ||"' AND "|| "xmii006 = '"||g_xmii2_d[g_detail_idx].xmii006 ||"' AND "|| "xmii007 = '"||g_xmii2_d[g_detail_idx].xmii007 ||"' AND "|| "xmii008 = '"||g_xmii2_d[g_detail_idx].xmii008 ||"' AND "|| "xmii009 = '"||g_xmii2_d[g_detail_idx].xmii009 ||"' AND "|| "xmii010 = '"||g_xmii2_d[g_detail_idx].xmii010 ||"' AND "|| "xmii011 = '"||g_xmii2_d[g_detail_idx].xmii011 ||"' AND "|| "xmii012 = '"||g_xmii2_d[g_detail_idx].xmii012 ||"' AND "|| "xmii013 = '"||g_xmii2_d[g_detail_idx].xmii013 ||"' AND "|| "xmii014 = '"||g_xmii2_d[g_detail_idx].xmii014 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page2.xmii017_2" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xmih_m.xmih001 IS NOT NULL AND g_xmih_m.xmih002 IS NOT NULL AND g_xmih_m.xmih003 IS NOT NULL AND g_xmih_m.xmih004 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii005 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii006 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii007 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii008 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii009 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii010 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii011 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii012 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii013 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii014 IS NOT NULL AND g_xmii2_d[g_detail_idx].xmii017 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmih_m.xmih001 != g_xmih001_t OR g_xmih_m.xmih002 != g_xmih002_t OR g_xmih_m.xmih003 != g_xmih003_t OR g_xmih_m.xmih004 != g_xmih004_t OR g_xmii2_d[g_detail_idx].xmii005 != g_xmii2_d_t.xmii005 OR g_xmii2_d[g_detail_idx].xmii006 != g_xmii2_d_t.xmii006 OR g_xmii2_d[g_detail_idx].xmii007 != g_xmii2_d_t.xmii007 OR g_xmii2_d[g_detail_idx].xmii008 != g_xmii2_d_t.xmii008 OR g_xmii2_d[g_detail_idx].xmii009 != g_xmii2_d_t.xmii009 OR g_xmii2_d[g_detail_idx].xmii010 != g_xmii2_d_t.xmii010 OR g_xmii2_d[g_detail_idx].xmii011 != g_xmii2_d_t.xmii011 OR g_xmii2_d[g_detail_idx].xmii012 != g_xmii2_d_t.xmii012 OR g_xmii2_d[g_detail_idx].xmii013 != g_xmii2_d_t.xmii013 OR g_xmii2_d[g_detail_idx].xmii014 != g_xmii2_d_t.xmii014 OR g_xmii2_d[g_detail_idx].xmii017 != g_xmii2_d_t.xmii017)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xmii_t WHERE "||"xmiient = '" ||g_enterprise|| "' AND "||"xmii001 = '"||g_xmih_m.xmih001 ||"' AND "|| "xmii002 = '"||g_xmih_m.xmih002 ||"' AND "|| "xmii003 = '"||g_xmih_m.xmih003 ||"' AND "|| "xmii004 = '"||g_xmih_m.xmih004 ||"' AND "|| "xmii005 = '"||g_xmii2_d[g_detail_idx].xmii005 ||"' AND "|| "xmii006 = '"||g_xmii2_d[g_detail_idx].xmii006 ||"' AND "|| "xmii007 = '"||g_xmii2_d[g_detail_idx].xmii007 ||"' AND "|| "xmii008 = '"||g_xmii2_d[g_detail_idx].xmii008 ||"' AND "|| "xmii009 = '"||g_xmii2_d[g_detail_idx].xmii009 ||"' AND "|| "xmii010 = '"||g_xmii2_d[g_detail_idx].xmii010 ||"' AND "|| "xmii011 = '"||g_xmii2_d[g_detail_idx].xmii011 ||"' AND "|| "xmii012 = '"||g_xmii2_d[g_detail_idx].xmii012 ||"' AND "|| "xmii013 = '"||g_xmii2_d[g_detail_idx].xmii013 ||"' AND "|| "xmii014 = '"||g_xmii2_d[g_detail_idx].xmii014 ||"' AND "|| "xmii017 = '"||g_xmii2_d[g_detail_idx].xmii017 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page3.xmii005_3" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xmih_m.xmih001 IS NOT NULL AND g_xmih_m.xmih002 IS NOT NULL AND g_xmih_m.xmih003 IS NOT NULL AND g_xmih_m.xmih004 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii005 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii006 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii007 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii008 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii009 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii010 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii011 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii012 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii013 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii014 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmih_m.xmih001 != g_xmih001_t OR g_xmih_m.xmih002 != g_xmih002_t OR g_xmih_m.xmih003 != g_xmih003_t OR g_xmih_m.xmih004 != g_xmih004_t OR g_xmii3_d[g_detail_idx].xmii005 != g_xmii3_d_t.xmii005 OR g_xmii3_d[g_detail_idx].xmii006 != g_xmii3_d_t.xmii006 OR g_xmii3_d[g_detail_idx].xmii007 != g_xmii3_d_t.xmii007 OR g_xmii3_d[g_detail_idx].xmii008 != g_xmii3_d_t.xmii008 OR g_xmii3_d[g_detail_idx].xmii009 != g_xmii3_d_t.xmii009 OR g_xmii3_d[g_detail_idx].xmii010 != g_xmii3_d_t.xmii010 OR g_xmii3_d[g_detail_idx].xmii011 != g_xmii3_d_t.xmii011 OR g_xmii3_d[g_detail_idx].xmii012 != g_xmii3_d_t.xmii012 OR g_xmii3_d[g_detail_idx].xmii013 != g_xmii3_d_t.xmii013 OR g_xmii3_d[g_detail_idx].xmii014 != g_xmii3_d_t.xmii014)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xmii_t WHERE "||"xmiient = '" ||g_enterprise|| "' AND "||"xmii001 = '"||g_xmih_m.xmih001 ||"' AND "|| "xmii002 = '"||g_xmih_m.xmih002 ||"' AND "|| "xmii003 = '"||g_xmih_m.xmih003 ||"' AND "|| "xmii004 = '"||g_xmih_m.xmih004 ||"' AND "|| "xmii005 = '"||g_xmii3_d[g_detail_idx].xmii005 ||"' AND "|| "xmii006 = '"||g_xmii3_d[g_detail_idx].xmii006 ||"' AND "|| "xmii007 = '"||g_xmii3_d[g_detail_idx].xmii007 ||"' AND "|| "xmii008 = '"||g_xmii3_d[g_detail_idx].xmii008 ||"' AND "|| "xmii009 = '"||g_xmii3_d[g_detail_idx].xmii009 ||"' AND "|| "xmii010 = '"||g_xmii3_d[g_detail_idx].xmii010 ||"' AND "|| "xmii011 = '"||g_xmii3_d[g_detail_idx].xmii011 ||"' AND "|| "xmii012 = '"||g_xmii3_d[g_detail_idx].xmii012 ||"' AND "|| "xmii013 = '"||g_xmii3_d[g_detail_idx].xmii013 ||"' AND "|| "xmii014 = '"||g_xmii3_d[g_detail_idx].xmii014 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page3.xmii006_3" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xmih_m.xmih001 IS NOT NULL AND g_xmih_m.xmih002 IS NOT NULL AND g_xmih_m.xmih003 IS NOT NULL AND g_xmih_m.xmih004 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii005 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii006 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii007 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii008 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii009 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii010 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii011 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii012 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii013 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii014 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmih_m.xmih001 != g_xmih001_t OR g_xmih_m.xmih002 != g_xmih002_t OR g_xmih_m.xmih003 != g_xmih003_t OR g_xmih_m.xmih004 != g_xmih004_t OR g_xmii3_d[g_detail_idx].xmii005 != g_xmii3_d_t.xmii005 OR g_xmii3_d[g_detail_idx].xmii006 != g_xmii3_d_t.xmii006 OR g_xmii3_d[g_detail_idx].xmii007 != g_xmii3_d_t.xmii007 OR g_xmii3_d[g_detail_idx].xmii008 != g_xmii3_d_t.xmii008 OR g_xmii3_d[g_detail_idx].xmii009 != g_xmii3_d_t.xmii009 OR g_xmii3_d[g_detail_idx].xmii010 != g_xmii3_d_t.xmii010 OR g_xmii3_d[g_detail_idx].xmii011 != g_xmii3_d_t.xmii011 OR g_xmii3_d[g_detail_idx].xmii012 != g_xmii3_d_t.xmii012 OR g_xmii3_d[g_detail_idx].xmii013 != g_xmii3_d_t.xmii013 OR g_xmii3_d[g_detail_idx].xmii014 != g_xmii3_d_t.xmii014)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xmii_t WHERE "||"xmiient = '" ||g_enterprise|| "' AND "||"xmii001 = '"||g_xmih_m.xmih001 ||"' AND "|| "xmii002 = '"||g_xmih_m.xmih002 ||"' AND "|| "xmii003 = '"||g_xmih_m.xmih003 ||"' AND "|| "xmii004 = '"||g_xmih_m.xmih004 ||"' AND "|| "xmii005 = '"||g_xmii3_d[g_detail_idx].xmii005 ||"' AND "|| "xmii006 = '"||g_xmii3_d[g_detail_idx].xmii006 ||"' AND "|| "xmii007 = '"||g_xmii3_d[g_detail_idx].xmii007 ||"' AND "|| "xmii008 = '"||g_xmii3_d[g_detail_idx].xmii008 ||"' AND "|| "xmii009 = '"||g_xmii3_d[g_detail_idx].xmii009 ||"' AND "|| "xmii010 = '"||g_xmii3_d[g_detail_idx].xmii010 ||"' AND "|| "xmii011 = '"||g_xmii3_d[g_detail_idx].xmii011 ||"' AND "|| "xmii012 = '"||g_xmii3_d[g_detail_idx].xmii012 ||"' AND "|| "xmii013 = '"||g_xmii3_d[g_detail_idx].xmii013 ||"' AND "|| "xmii014 = '"||g_xmii3_d[g_detail_idx].xmii014 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page3.xmii007_3" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xmih_m.xmih001 IS NOT NULL AND g_xmih_m.xmih002 IS NOT NULL AND g_xmih_m.xmih003 IS NOT NULL AND g_xmih_m.xmih004 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii005 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii006 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii007 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii008 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii009 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii010 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii011 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii012 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii013 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii014 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmih_m.xmih001 != g_xmih001_t OR g_xmih_m.xmih002 != g_xmih002_t OR g_xmih_m.xmih003 != g_xmih003_t OR g_xmih_m.xmih004 != g_xmih004_t OR g_xmii3_d[g_detail_idx].xmii005 != g_xmii3_d_t.xmii005 OR g_xmii3_d[g_detail_idx].xmii006 != g_xmii3_d_t.xmii006 OR g_xmii3_d[g_detail_idx].xmii007 != g_xmii3_d_t.xmii007 OR g_xmii3_d[g_detail_idx].xmii008 != g_xmii3_d_t.xmii008 OR g_xmii3_d[g_detail_idx].xmii009 != g_xmii3_d_t.xmii009 OR g_xmii3_d[g_detail_idx].xmii010 != g_xmii3_d_t.xmii010 OR g_xmii3_d[g_detail_idx].xmii011 != g_xmii3_d_t.xmii011 OR g_xmii3_d[g_detail_idx].xmii012 != g_xmii3_d_t.xmii012 OR g_xmii3_d[g_detail_idx].xmii013 != g_xmii3_d_t.xmii013 OR g_xmii3_d[g_detail_idx].xmii014 != g_xmii3_d_t.xmii014)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xmii_t WHERE "||"xmiient = '" ||g_enterprise|| "' AND "||"xmii001 = '"||g_xmih_m.xmih001 ||"' AND "|| "xmii002 = '"||g_xmih_m.xmih002 ||"' AND "|| "xmii003 = '"||g_xmih_m.xmih003 ||"' AND "|| "xmii004 = '"||g_xmih_m.xmih004 ||"' AND "|| "xmii005 = '"||g_xmii3_d[g_detail_idx].xmii005 ||"' AND "|| "xmii006 = '"||g_xmii3_d[g_detail_idx].xmii006 ||"' AND "|| "xmii007 = '"||g_xmii3_d[g_detail_idx].xmii007 ||"' AND "|| "xmii008 = '"||g_xmii3_d[g_detail_idx].xmii008 ||"' AND "|| "xmii009 = '"||g_xmii3_d[g_detail_idx].xmii009 ||"' AND "|| "xmii010 = '"||g_xmii3_d[g_detail_idx].xmii010 ||"' AND "|| "xmii011 = '"||g_xmii3_d[g_detail_idx].xmii011 ||"' AND "|| "xmii012 = '"||g_xmii3_d[g_detail_idx].xmii012 ||"' AND "|| "xmii013 = '"||g_xmii3_d[g_detail_idx].xmii013 ||"' AND "|| "xmii014 = '"||g_xmii3_d[g_detail_idx].xmii014 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page3.xmii008_3" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xmih_m.xmih001 IS NOT NULL AND g_xmih_m.xmih002 IS NOT NULL AND g_xmih_m.xmih003 IS NOT NULL AND g_xmih_m.xmih004 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii005 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii006 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii007 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii008 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii009 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii010 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii011 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii012 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii013 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii014 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmih_m.xmih001 != g_xmih001_t OR g_xmih_m.xmih002 != g_xmih002_t OR g_xmih_m.xmih003 != g_xmih003_t OR g_xmih_m.xmih004 != g_xmih004_t OR g_xmii3_d[g_detail_idx].xmii005 != g_xmii3_d_t.xmii005 OR g_xmii3_d[g_detail_idx].xmii006 != g_xmii3_d_t.xmii006 OR g_xmii3_d[g_detail_idx].xmii007 != g_xmii3_d_t.xmii007 OR g_xmii3_d[g_detail_idx].xmii008 != g_xmii3_d_t.xmii008 OR g_xmii3_d[g_detail_idx].xmii009 != g_xmii3_d_t.xmii009 OR g_xmii3_d[g_detail_idx].xmii010 != g_xmii3_d_t.xmii010 OR g_xmii3_d[g_detail_idx].xmii011 != g_xmii3_d_t.xmii011 OR g_xmii3_d[g_detail_idx].xmii012 != g_xmii3_d_t.xmii012 OR g_xmii3_d[g_detail_idx].xmii013 != g_xmii3_d_t.xmii013 OR g_xmii3_d[g_detail_idx].xmii014 != g_xmii3_d_t.xmii014)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xmii_t WHERE "||"xmiient = '" ||g_enterprise|| "' AND "||"xmii001 = '"||g_xmih_m.xmih001 ||"' AND "|| "xmii002 = '"||g_xmih_m.xmih002 ||"' AND "|| "xmii003 = '"||g_xmih_m.xmih003 ||"' AND "|| "xmii004 = '"||g_xmih_m.xmih004 ||"' AND "|| "xmii005 = '"||g_xmii3_d[g_detail_idx].xmii005 ||"' AND "|| "xmii006 = '"||g_xmii3_d[g_detail_idx].xmii006 ||"' AND "|| "xmii007 = '"||g_xmii3_d[g_detail_idx].xmii007 ||"' AND "|| "xmii008 = '"||g_xmii3_d[g_detail_idx].xmii008 ||"' AND "|| "xmii009 = '"||g_xmii3_d[g_detail_idx].xmii009 ||"' AND "|| "xmii010 = '"||g_xmii3_d[g_detail_idx].xmii010 ||"' AND "|| "xmii011 = '"||g_xmii3_d[g_detail_idx].xmii011 ||"' AND "|| "xmii012 = '"||g_xmii3_d[g_detail_idx].xmii012 ||"' AND "|| "xmii013 = '"||g_xmii3_d[g_detail_idx].xmii013 ||"' AND "|| "xmii014 = '"||g_xmii3_d[g_detail_idx].xmii014 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page3.xmii009_3" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xmih_m.xmih001 IS NOT NULL AND g_xmih_m.xmih002 IS NOT NULL AND g_xmih_m.xmih003 IS NOT NULL AND g_xmih_m.xmih004 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii005 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii006 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii007 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii008 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii009 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii010 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii011 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii012 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii013 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii014 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmih_m.xmih001 != g_xmih001_t OR g_xmih_m.xmih002 != g_xmih002_t OR g_xmih_m.xmih003 != g_xmih003_t OR g_xmih_m.xmih004 != g_xmih004_t OR g_xmii3_d[g_detail_idx].xmii005 != g_xmii3_d_t.xmii005 OR g_xmii3_d[g_detail_idx].xmii006 != g_xmii3_d_t.xmii006 OR g_xmii3_d[g_detail_idx].xmii007 != g_xmii3_d_t.xmii007 OR g_xmii3_d[g_detail_idx].xmii008 != g_xmii3_d_t.xmii008 OR g_xmii3_d[g_detail_idx].xmii009 != g_xmii3_d_t.xmii009 OR g_xmii3_d[g_detail_idx].xmii010 != g_xmii3_d_t.xmii010 OR g_xmii3_d[g_detail_idx].xmii011 != g_xmii3_d_t.xmii011 OR g_xmii3_d[g_detail_idx].xmii012 != g_xmii3_d_t.xmii012 OR g_xmii3_d[g_detail_idx].xmii013 != g_xmii3_d_t.xmii013 OR g_xmii3_d[g_detail_idx].xmii014 != g_xmii3_d_t.xmii014)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xmii_t WHERE "||"xmiient = '" ||g_enterprise|| "' AND "||"xmii001 = '"||g_xmih_m.xmih001 ||"' AND "|| "xmii002 = '"||g_xmih_m.xmih002 ||"' AND "|| "xmii003 = '"||g_xmih_m.xmih003 ||"' AND "|| "xmii004 = '"||g_xmih_m.xmih004 ||"' AND "|| "xmii005 = '"||g_xmii3_d[g_detail_idx].xmii005 ||"' AND "|| "xmii006 = '"||g_xmii3_d[g_detail_idx].xmii006 ||"' AND "|| "xmii007 = '"||g_xmii3_d[g_detail_idx].xmii007 ||"' AND "|| "xmii008 = '"||g_xmii3_d[g_detail_idx].xmii008 ||"' AND "|| "xmii009 = '"||g_xmii3_d[g_detail_idx].xmii009 ||"' AND "|| "xmii010 = '"||g_xmii3_d[g_detail_idx].xmii010 ||"' AND "|| "xmii011 = '"||g_xmii3_d[g_detail_idx].xmii011 ||"' AND "|| "xmii012 = '"||g_xmii3_d[g_detail_idx].xmii012 ||"' AND "|| "xmii013 = '"||g_xmii3_d[g_detail_idx].xmii013 ||"' AND "|| "xmii014 = '"||g_xmii3_d[g_detail_idx].xmii014 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page3.xmii010_3" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xmih_m.xmih001 IS NOT NULL AND g_xmih_m.xmih002 IS NOT NULL AND g_xmih_m.xmih003 IS NOT NULL AND g_xmih_m.xmih004 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii005 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii006 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii007 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii008 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii009 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii010 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii011 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii012 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii013 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii014 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmih_m.xmih001 != g_xmih001_t OR g_xmih_m.xmih002 != g_xmih002_t OR g_xmih_m.xmih003 != g_xmih003_t OR g_xmih_m.xmih004 != g_xmih004_t OR g_xmii3_d[g_detail_idx].xmii005 != g_xmii3_d_t.xmii005 OR g_xmii3_d[g_detail_idx].xmii006 != g_xmii3_d_t.xmii006 OR g_xmii3_d[g_detail_idx].xmii007 != g_xmii3_d_t.xmii007 OR g_xmii3_d[g_detail_idx].xmii008 != g_xmii3_d_t.xmii008 OR g_xmii3_d[g_detail_idx].xmii009 != g_xmii3_d_t.xmii009 OR g_xmii3_d[g_detail_idx].xmii010 != g_xmii3_d_t.xmii010 OR g_xmii3_d[g_detail_idx].xmii011 != g_xmii3_d_t.xmii011 OR g_xmii3_d[g_detail_idx].xmii012 != g_xmii3_d_t.xmii012 OR g_xmii3_d[g_detail_idx].xmii013 != g_xmii3_d_t.xmii013 OR g_xmii3_d[g_detail_idx].xmii014 != g_xmii3_d_t.xmii014)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xmii_t WHERE "||"xmiient = '" ||g_enterprise|| "' AND "||"xmii001 = '"||g_xmih_m.xmih001 ||"' AND "|| "xmii002 = '"||g_xmih_m.xmih002 ||"' AND "|| "xmii003 = '"||g_xmih_m.xmih003 ||"' AND "|| "xmii004 = '"||g_xmih_m.xmih004 ||"' AND "|| "xmii005 = '"||g_xmii3_d[g_detail_idx].xmii005 ||"' AND "|| "xmii006 = '"||g_xmii3_d[g_detail_idx].xmii006 ||"' AND "|| "xmii007 = '"||g_xmii3_d[g_detail_idx].xmii007 ||"' AND "|| "xmii008 = '"||g_xmii3_d[g_detail_idx].xmii008 ||"' AND "|| "xmii009 = '"||g_xmii3_d[g_detail_idx].xmii009 ||"' AND "|| "xmii010 = '"||g_xmii3_d[g_detail_idx].xmii010 ||"' AND "|| "xmii011 = '"||g_xmii3_d[g_detail_idx].xmii011 ||"' AND "|| "xmii012 = '"||g_xmii3_d[g_detail_idx].xmii012 ||"' AND "|| "xmii013 = '"||g_xmii3_d[g_detail_idx].xmii013 ||"' AND "|| "xmii014 = '"||g_xmii3_d[g_detail_idx].xmii014 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page3.xmii011_3" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xmih_m.xmih001 IS NOT NULL AND g_xmih_m.xmih002 IS NOT NULL AND g_xmih_m.xmih003 IS NOT NULL AND g_xmih_m.xmih004 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii005 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii006 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii007 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii008 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii009 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii010 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii011 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii012 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii013 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii014 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmih_m.xmih001 != g_xmih001_t OR g_xmih_m.xmih002 != g_xmih002_t OR g_xmih_m.xmih003 != g_xmih003_t OR g_xmih_m.xmih004 != g_xmih004_t OR g_xmii3_d[g_detail_idx].xmii005 != g_xmii3_d_t.xmii005 OR g_xmii3_d[g_detail_idx].xmii006 != g_xmii3_d_t.xmii006 OR g_xmii3_d[g_detail_idx].xmii007 != g_xmii3_d_t.xmii007 OR g_xmii3_d[g_detail_idx].xmii008 != g_xmii3_d_t.xmii008 OR g_xmii3_d[g_detail_idx].xmii009 != g_xmii3_d_t.xmii009 OR g_xmii3_d[g_detail_idx].xmii010 != g_xmii3_d_t.xmii010 OR g_xmii3_d[g_detail_idx].xmii011 != g_xmii3_d_t.xmii011 OR g_xmii3_d[g_detail_idx].xmii012 != g_xmii3_d_t.xmii012 OR g_xmii3_d[g_detail_idx].xmii013 != g_xmii3_d_t.xmii013 OR g_xmii3_d[g_detail_idx].xmii014 != g_xmii3_d_t.xmii014)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xmii_t WHERE "||"xmiient = '" ||g_enterprise|| "' AND "||"xmii001 = '"||g_xmih_m.xmih001 ||"' AND "|| "xmii002 = '"||g_xmih_m.xmih002 ||"' AND "|| "xmii003 = '"||g_xmih_m.xmih003 ||"' AND "|| "xmii004 = '"||g_xmih_m.xmih004 ||"' AND "|| "xmii005 = '"||g_xmii3_d[g_detail_idx].xmii005 ||"' AND "|| "xmii006 = '"||g_xmii3_d[g_detail_idx].xmii006 ||"' AND "|| "xmii007 = '"||g_xmii3_d[g_detail_idx].xmii007 ||"' AND "|| "xmii008 = '"||g_xmii3_d[g_detail_idx].xmii008 ||"' AND "|| "xmii009 = '"||g_xmii3_d[g_detail_idx].xmii009 ||"' AND "|| "xmii010 = '"||g_xmii3_d[g_detail_idx].xmii010 ||"' AND "|| "xmii011 = '"||g_xmii3_d[g_detail_idx].xmii011 ||"' AND "|| "xmii012 = '"||g_xmii3_d[g_detail_idx].xmii012 ||"' AND "|| "xmii013 = '"||g_xmii3_d[g_detail_idx].xmii013 ||"' AND "|| "xmii014 = '"||g_xmii3_d[g_detail_idx].xmii014 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page3.xmii012_3" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xmih_m.xmih001 IS NOT NULL AND g_xmih_m.xmih002 IS NOT NULL AND g_xmih_m.xmih003 IS NOT NULL AND g_xmih_m.xmih004 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii005 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii006 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii007 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii008 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii009 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii010 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii011 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii012 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii013 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii014 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmih_m.xmih001 != g_xmih001_t OR g_xmih_m.xmih002 != g_xmih002_t OR g_xmih_m.xmih003 != g_xmih003_t OR g_xmih_m.xmih004 != g_xmih004_t OR g_xmii3_d[g_detail_idx].xmii005 != g_xmii3_d_t.xmii005 OR g_xmii3_d[g_detail_idx].xmii006 != g_xmii3_d_t.xmii006 OR g_xmii3_d[g_detail_idx].xmii007 != g_xmii3_d_t.xmii007 OR g_xmii3_d[g_detail_idx].xmii008 != g_xmii3_d_t.xmii008 OR g_xmii3_d[g_detail_idx].xmii009 != g_xmii3_d_t.xmii009 OR g_xmii3_d[g_detail_idx].xmii010 != g_xmii3_d_t.xmii010 OR g_xmii3_d[g_detail_idx].xmii011 != g_xmii3_d_t.xmii011 OR g_xmii3_d[g_detail_idx].xmii012 != g_xmii3_d_t.xmii012 OR g_xmii3_d[g_detail_idx].xmii013 != g_xmii3_d_t.xmii013 OR g_xmii3_d[g_detail_idx].xmii014 != g_xmii3_d_t.xmii014)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xmii_t WHERE "||"xmiient = '" ||g_enterprise|| "' AND "||"xmii001 = '"||g_xmih_m.xmih001 ||"' AND "|| "xmii002 = '"||g_xmih_m.xmih002 ||"' AND "|| "xmii003 = '"||g_xmih_m.xmih003 ||"' AND "|| "xmii004 = '"||g_xmih_m.xmih004 ||"' AND "|| "xmii005 = '"||g_xmii3_d[g_detail_idx].xmii005 ||"' AND "|| "xmii006 = '"||g_xmii3_d[g_detail_idx].xmii006 ||"' AND "|| "xmii007 = '"||g_xmii3_d[g_detail_idx].xmii007 ||"' AND "|| "xmii008 = '"||g_xmii3_d[g_detail_idx].xmii008 ||"' AND "|| "xmii009 = '"||g_xmii3_d[g_detail_idx].xmii009 ||"' AND "|| "xmii010 = '"||g_xmii3_d[g_detail_idx].xmii010 ||"' AND "|| "xmii011 = '"||g_xmii3_d[g_detail_idx].xmii011 ||"' AND "|| "xmii012 = '"||g_xmii3_d[g_detail_idx].xmii012 ||"' AND "|| "xmii013 = '"||g_xmii3_d[g_detail_idx].xmii013 ||"' AND "|| "xmii014 = '"||g_xmii3_d[g_detail_idx].xmii014 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page3.xmii013_3" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xmih_m.xmih001 IS NOT NULL AND g_xmih_m.xmih002 IS NOT NULL AND g_xmih_m.xmih003 IS NOT NULL AND g_xmih_m.xmih004 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii005 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii006 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii007 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii008 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii009 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii010 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii011 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii012 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii013 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii014 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmih_m.xmih001 != g_xmih001_t OR g_xmih_m.xmih002 != g_xmih002_t OR g_xmih_m.xmih003 != g_xmih003_t OR g_xmih_m.xmih004 != g_xmih004_t OR g_xmii3_d[g_detail_idx].xmii005 != g_xmii3_d_t.xmii005 OR g_xmii3_d[g_detail_idx].xmii006 != g_xmii3_d_t.xmii006 OR g_xmii3_d[g_detail_idx].xmii007 != g_xmii3_d_t.xmii007 OR g_xmii3_d[g_detail_idx].xmii008 != g_xmii3_d_t.xmii008 OR g_xmii3_d[g_detail_idx].xmii009 != g_xmii3_d_t.xmii009 OR g_xmii3_d[g_detail_idx].xmii010 != g_xmii3_d_t.xmii010 OR g_xmii3_d[g_detail_idx].xmii011 != g_xmii3_d_t.xmii011 OR g_xmii3_d[g_detail_idx].xmii012 != g_xmii3_d_t.xmii012 OR g_xmii3_d[g_detail_idx].xmii013 != g_xmii3_d_t.xmii013 OR g_xmii3_d[g_detail_idx].xmii014 != g_xmii3_d_t.xmii014)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xmii_t WHERE "||"xmiient = '" ||g_enterprise|| "' AND "||"xmii001 = '"||g_xmih_m.xmih001 ||"' AND "|| "xmii002 = '"||g_xmih_m.xmih002 ||"' AND "|| "xmii003 = '"||g_xmih_m.xmih003 ||"' AND "|| "xmii004 = '"||g_xmih_m.xmih004 ||"' AND "|| "xmii005 = '"||g_xmii3_d[g_detail_idx].xmii005 ||"' AND "|| "xmii006 = '"||g_xmii3_d[g_detail_idx].xmii006 ||"' AND "|| "xmii007 = '"||g_xmii3_d[g_detail_idx].xmii007 ||"' AND "|| "xmii008 = '"||g_xmii3_d[g_detail_idx].xmii008 ||"' AND "|| "xmii009 = '"||g_xmii3_d[g_detail_idx].xmii009 ||"' AND "|| "xmii010 = '"||g_xmii3_d[g_detail_idx].xmii010 ||"' AND "|| "xmii011 = '"||g_xmii3_d[g_detail_idx].xmii011 ||"' AND "|| "xmii012 = '"||g_xmii3_d[g_detail_idx].xmii012 ||"' AND "|| "xmii013 = '"||g_xmii3_d[g_detail_idx].xmii013 ||"' AND "|| "xmii014 = '"||g_xmii3_d[g_detail_idx].xmii014 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page3.xmii014_3" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xmih_m.xmih001 IS NOT NULL AND g_xmih_m.xmih002 IS NOT NULL AND g_xmih_m.xmih003 IS NOT NULL AND g_xmih_m.xmih004 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii005 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii006 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii007 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii008 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii009 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii010 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii011 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii012 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii013 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii014 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmih_m.xmih001 != g_xmih001_t OR g_xmih_m.xmih002 != g_xmih002_t OR g_xmih_m.xmih003 != g_xmih003_t OR g_xmih_m.xmih004 != g_xmih004_t OR g_xmii3_d[g_detail_idx].xmii005 != g_xmii3_d_t.xmii005 OR g_xmii3_d[g_detail_idx].xmii006 != g_xmii3_d_t.xmii006 OR g_xmii3_d[g_detail_idx].xmii007 != g_xmii3_d_t.xmii007 OR g_xmii3_d[g_detail_idx].xmii008 != g_xmii3_d_t.xmii008 OR g_xmii3_d[g_detail_idx].xmii009 != g_xmii3_d_t.xmii009 OR g_xmii3_d[g_detail_idx].xmii010 != g_xmii3_d_t.xmii010 OR g_xmii3_d[g_detail_idx].xmii011 != g_xmii3_d_t.xmii011 OR g_xmii3_d[g_detail_idx].xmii012 != g_xmii3_d_t.xmii012 OR g_xmii3_d[g_detail_idx].xmii013 != g_xmii3_d_t.xmii013 OR g_xmii3_d[g_detail_idx].xmii014 != g_xmii3_d_t.xmii014)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xmii_t WHERE "||"xmiient = '" ||g_enterprise|| "' AND "||"xmii001 = '"||g_xmih_m.xmih001 ||"' AND "|| "xmii002 = '"||g_xmih_m.xmih002 ||"' AND "|| "xmii003 = '"||g_xmih_m.xmih003 ||"' AND "|| "xmii004 = '"||g_xmih_m.xmih004 ||"' AND "|| "xmii005 = '"||g_xmii3_d[g_detail_idx].xmii005 ||"' AND "|| "xmii006 = '"||g_xmii3_d[g_detail_idx].xmii006 ||"' AND "|| "xmii007 = '"||g_xmii3_d[g_detail_idx].xmii007 ||"' AND "|| "xmii008 = '"||g_xmii3_d[g_detail_idx].xmii008 ||"' AND "|| "xmii009 = '"||g_xmii3_d[g_detail_idx].xmii009 ||"' AND "|| "xmii010 = '"||g_xmii3_d[g_detail_idx].xmii010 ||"' AND "|| "xmii011 = '"||g_xmii3_d[g_detail_idx].xmii011 ||"' AND "|| "xmii012 = '"||g_xmii3_d[g_detail_idx].xmii012 ||"' AND "|| "xmii013 = '"||g_xmii3_d[g_detail_idx].xmii013 ||"' AND "|| "xmii014 = '"||g_xmii3_d[g_detail_idx].xmii014 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page3.xmii017_3" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xmih_m.xmih001 IS NOT NULL AND g_xmih_m.xmih002 IS NOT NULL AND g_xmih_m.xmih003 IS NOT NULL AND g_xmih_m.xmih004 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii005 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii006 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii007 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii008 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii009 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii010 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii011 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii012 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii013 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii014 IS NOT NULL AND g_xmii3_d[g_detail_idx].xmii017 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmih_m.xmih001 != g_xmih001_t OR g_xmih_m.xmih002 != g_xmih002_t OR g_xmih_m.xmih003 != g_xmih003_t OR g_xmih_m.xmih004 != g_xmih004_t OR g_xmii3_d[g_detail_idx].xmii005 != g_xmii3_d_t.xmii005 OR g_xmii3_d[g_detail_idx].xmii006 != g_xmii3_d_t.xmii006 OR g_xmii3_d[g_detail_idx].xmii007 != g_xmii3_d_t.xmii007 OR g_xmii3_d[g_detail_idx].xmii008 != g_xmii3_d_t.xmii008 OR g_xmii3_d[g_detail_idx].xmii009 != g_xmii3_d_t.xmii009 OR g_xmii3_d[g_detail_idx].xmii010 != g_xmii3_d_t.xmii010 OR g_xmii3_d[g_detail_idx].xmii011 != g_xmii3_d_t.xmii011 OR g_xmii3_d[g_detail_idx].xmii012 != g_xmii3_d_t.xmii012 OR g_xmii3_d[g_detail_idx].xmii013 != g_xmii3_d_t.xmii013 OR g_xmii3_d[g_detail_idx].xmii014 != g_xmii3_d_t.xmii014 OR g_xmii3_d[g_detail_idx].xmii017 != g_xmii3_d_t.xmii017)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xmii_t WHERE "||"xmiient = '" ||g_enterprise|| "' AND "||"xmii001 = '"||g_xmih_m.xmih001 ||"' AND "|| "xmii002 = '"||g_xmih_m.xmih002 ||"' AND "|| "xmii003 = '"||g_xmih_m.xmih003 ||"' AND "|| "xmii004 = '"||g_xmih_m.xmih004 ||"' AND "|| "xmii005 = '"||g_xmii3_d[g_detail_idx].xmii005 ||"' AND "|| "xmii006 = '"||g_xmii3_d[g_detail_idx].xmii006 ||"' AND "|| "xmii007 = '"||g_xmii3_d[g_detail_idx].xmii007 ||"' AND "|| "xmii008 = '"||g_xmii3_d[g_detail_idx].xmii008 ||"' AND "|| "xmii009 = '"||g_xmii3_d[g_detail_idx].xmii009 ||"' AND "|| "xmii010 = '"||g_xmii3_d[g_detail_idx].xmii010 ||"' AND "|| "xmii011 = '"||g_xmii3_d[g_detail_idx].xmii011 ||"' AND "|| "xmii012 = '"||g_xmii3_d[g_detail_idx].xmii012 ||"' AND "|| "xmii013 = '"||g_xmii3_d[g_detail_idx].xmii013 ||"' AND "|| "xmii014 = '"||g_xmii3_d[g_detail_idx].xmii014 ||"' AND "|| "xmii017 = '"||g_xmii3_d[g_detail_idx].xmii017 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.xmih001" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  NOT cl_null(g_xmih_m.xmih001) AND NOT cl_null(g_xmih_m.xmih002) AND NOT cl_null(g_xmih_m.xmih003) AND NOT cl_null(g_xmih_m.xmih004) THEN 
               IF p_cmd = 'a' OR ( p_cmd = 'u' AND (g_xmih_m.xmih001 != g_xmih001_t  OR g_xmih_m.xmih002 != g_xmih002_t  OR g_xmih_m.xmih003 != g_xmih003_t  OR g_xmih_m.xmih004 != g_xmih004_t )) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xmih_t WHERE "||"xmihent = '" ||g_enterprise|| "' AND "||"xmih001 = '"||g_xmih_m.xmih001 ||"' AND "|| "xmih002 = '"||g_xmih_m.xmih002 ||"' AND "|| "xmih003 = '"||g_xmih_m.xmih003 ||"' AND "|| "xmih004 = '"||g_xmih_m.xmih004 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF


]]>
  </point>
  <point name="input.a.xmih002" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  NOT cl_null(g_xmih_m.xmih001) AND NOT cl_null(g_xmih_m.xmih002) AND NOT cl_null(g_xmih_m.xmih003) AND NOT cl_null(g_xmih_m.xmih004) THEN 
               IF p_cmd = 'a' OR ( p_cmd = 'u' AND (g_xmih_m.xmih001 != g_xmih001_t  OR g_xmih_m.xmih002 != g_xmih002_t  OR g_xmih_m.xmih003 != g_xmih003_t  OR g_xmih_m.xmih004 != g_xmih004_t )) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xmih_t WHERE "||"xmihent = '" ||g_enterprise|| "' AND "||"xmih001 = '"||g_xmih_m.xmih001 ||"' AND "|| "xmih002 = '"||g_xmih_m.xmih002 ||"' AND "|| "xmih003 = '"||g_xmih_m.xmih003 ||"' AND "|| "xmih004 = '"||g_xmih_m.xmih004 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF


]]>
  </point>
  <point name="input.a.xmih003" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  NOT cl_null(g_xmih_m.xmih001) AND NOT cl_null(g_xmih_m.xmih002) AND NOT cl_null(g_xmih_m.xmih003) AND NOT cl_null(g_xmih_m.xmih004) THEN 
               IF p_cmd = 'a' OR ( p_cmd = 'u' AND (g_xmih_m.xmih001 != g_xmih001_t  OR g_xmih_m.xmih002 != g_xmih002_t  OR g_xmih_m.xmih003 != g_xmih003_t  OR g_xmih_m.xmih004 != g_xmih004_t )) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xmih_t WHERE "||"xmihent = '" ||g_enterprise|| "' AND "||"xmih001 = '"||g_xmih_m.xmih001 ||"' AND "|| "xmih002 = '"||g_xmih_m.xmih002 ||"' AND "|| "xmih003 = '"||g_xmih_m.xmih003 ||"' AND "|| "xmih004 = '"||g_xmih_m.xmih004 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF


]]>
  </point>
  <point name="input.a.xmih004" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  NOT cl_null(g_xmih_m.xmih001) AND NOT cl_null(g_xmih_m.xmih002) AND NOT cl_null(g_xmih_m.xmih003) AND NOT cl_null(g_xmih_m.xmih004) THEN 
               IF p_cmd = 'a' OR ( p_cmd = 'u' AND (g_xmih_m.xmih001 != g_xmih001_t  OR g_xmih_m.xmih002 != g_xmih002_t  OR g_xmih_m.xmih003 != g_xmih003_t  OR g_xmih_m.xmih004 != g_xmih004_t )) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xmih_t WHERE "||"xmihent = '" ||g_enterprise|| "' AND "||"xmih001 = '"||g_xmih_m.xmih001 ||"' AND "|| "xmih002 = '"||g_xmih_m.xmih002 ||"' AND "|| "xmih003 = '"||g_xmih_m.xmih003 ||"' AND "|| "xmih004 = '"||g_xmih_m.xmih004 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF


]]>
  </point>
  <point name="input.a.xmih005" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmih_m.xmih005
            CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmih_m.xmih005_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmih_m.xmih005_desc

]]>
  </point>
  <point name="input.after_define_sql" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[   LET g_forupd_sql = "SELECT xmii005,xmii007,'',xmii006,'',xmii008,'',xmii012,'',xmii013,'',xmii011, 
       '',xmii009,'','',xmii010,xmii017,'',xmii014,xmii018,xmii019,'','','','','','','','','','','','','','','','', 
       '','','','','','','','','','','','','','','','','','','','','','','','','','','','','','','', 
       '',xmii005,xmii007,'',xmii006,'',xmii008,'',xmii012,'',xmii013,'',xmii011,xmii009,
       '','',xmii010,xmii017,'',xmii014,xmii022,xmii023,'','','','','','','','','', 
       '','','','','','','','','','','','','','','','','','','','','','','','','','','','','','','', 
       '','','','','','','','','','','','','','','','','','','','','','','','','','','','','','','', 
       '','','','','','','','','','','','','','','','','','','','','','','','','','','','','','','', 
       '','','','','','','','','','','','','','','','','','','','','','','','','','','','','','','', 
       '','','','','','','','','','','','','','','','','','','','','','','','','','','','','','','', 
       '','' FROM xmii_t WHERE xmiient=? AND xmii001=? AND xmii002=? AND xmii003=? AND xmii004=? AND  
       xmii005=? AND xmii006=? AND xmii007=? AND xmii008=? AND xmii009=? AND xmii010=? AND xmii011=?  
       AND xmii012=? AND xmii013=? AND xmii017=? FOR UPDATE"]]>
  </point>
  <point name="input.before_dialog" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[         CALL cl_set_act_visible("insert,delete,reproduce", FALSE)]]>
  </point>
  <point name="input.before_input" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[   LET g_errshow = 1]]>
  </point>
  <point name="input.body.m_update" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[               CALL axmt175_upd_xmii() RETURNING r_success
               IF r_success = 'N' THEN
                  LET g_xmii_d[l_ac].* = g_xmii_d_t.*                     
                  CALL s_transaction_end('N','0')               
               END IF                 ]]>
  </point>
  <point name="input.body2.m_update" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[               CALL axmt175_upd_xmii_2() RETURNING r_success
               IF r_success = 'N' THEN
                  LET g_xmii2_d[l_ac].* = g_xmii2_d_t.*                     
                  CALL s_transaction_end('N','0')               
               END IF]]>
  </point>
  <point name="input.body3.m_update" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[               CALL axmt175_upd_xmii_3() RETURNING r_success
               IF r_success = 'N' THEN
                  LET g_xmii3_d[l_ac].* = g_xmii3_d_t.*                     
                  CALL s_transaction_end('N','0')               
               END IF]]>
  </point>
  <point name="input.define" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[   DEFINE  r_success             LIKE type_t.chr1]]>
  </point>
  <point name="lock_b.define" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[   LET ls_group = "xmii_t"
   IF ls_group.getIndexOf(ps_table,1) THEN
      OPEN axmt175_bcl USING g_enterprise,
                                       g_xmih_m.xmih001,g_xmih_m.xmih002,g_xmih_m.xmih003,g_xmih_m.xmih004, 
                                           g_xmii_d[g_detail_idx].xmii005,g_xmii_d[g_detail_idx].xmii006, 
                                           g_xmii_d[g_detail_idx].xmii007,g_xmii_d[g_detail_idx].xmii008, 
                                           g_xmii_d[g_detail_idx].xmii009,g_xmii_d[g_detail_idx].xmii010, 
                                           g_xmii_d[g_detail_idx].xmii011,g_xmii_d[g_detail_idx].xmii012, 
                                           g_xmii_d[g_detail_idx].xmii013,g_xmii_d[g_detail_idx].xmii017  
                                               
      IF SQLCA.sqlcode THEN
         CALL cl_err("axmt175_bcl",SQLCA.sqlcode,1)
         RETURN FALSE
      END IF
   END IF
   RETURN TRUE]]>
  </point>
  <point name="query.other" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[   CALL g_xmii4_d.clear()
   CALL g_xmii5_d.clear()
   CALL g_xmii6_d.clear()
   CALL g_xmii7_d.clear()]]>
  </point>
  <point name="show.before" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[   LET g_bfill = "Y"]]>
  </point>
  <point name="show.body.reference" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmii_d[l_ac].xmii007
            CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmii_d[l_ac].xmii007_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmii_d[l_ac].xmii007_desc
            LET g_xmii2_d[l_ac].xmii007_2_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmii2_d[l_ac].xmii007_2_desc
            LET g_xmii3_d[l_ac].xmii007_3_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmii3_d[l_ac].xmii007_3_desc
            
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmii_d[l_ac].xmii006
            CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmii_d[l_ac].xmii006_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmii_d[l_ac].xmii006_desc
            LET g_xmii2_d[l_ac].xmii006_2_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmii2_d[l_ac].xmii006_2_desc      
            LET g_xmii3_d[l_ac].xmii006_3_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmii3_d[l_ac].xmii006_3_desc                

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmii_d[l_ac].xmii008
            CALL ap_ref_array2(g_ref_fields,"SELECT oofa011 FROM oofa_t WHERE oofaent='"||g_enterprise||"' AND oofa001=? ","") RETURNING g_rtn_fields
            LET g_xmii_d[l_ac].xmii008_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmii_d[l_ac].xmii008_desc
            LET g_xmii2_d[l_ac].xmii008_2_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmii2_d[l_ac].xmii008_2_desc     
            LET g_xmii3_d[l_ac].xmii008_3_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmii3_d[l_ac].xmii008_3_desc                  

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmii_d[l_ac].xmii011
            CALL ap_ref_array2(g_ref_fields,"SELECT rtaxl003 FROM rtaxl_t WHERE rtaxlent='"||g_enterprise||"' AND rtaxl001=? AND rtaxl002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmii_d[l_ac].xmii011_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmii_d[l_ac].xmii011_desc
            LET g_xmii2_d[l_ac].xmii011_2_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmii2_d[l_ac].xmii011_2_desc     
            LET g_xmii3_d[l_ac].xmii011_3_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmii3_d[l_ac].xmii011_3_desc              
            
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmii_d[l_ac].xmii012
            CALL ap_ref_array2(g_ref_fields,"SELECT pmaal004 FROM pmaal_t WHERE pmaalent='"||g_enterprise||"' AND pmaal001=? AND pmaal002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmii_d[l_ac].xmii012_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmii_d[l_ac].xmii012_desc
            LET g_xmii2_d[l_ac].xmii012_2_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmii2_d[l_ac].xmii012_2_desc 
            LET g_xmii3_d[l_ac].xmii012_3_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmii3_d[l_ac].xmii012_3_desc                

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmii_d[l_ac].xmii013
            CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocq001='275' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmii_d[l_ac].xmii013_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmii_d[l_ac].xmii013_desc
            LET g_xmii2_d[l_ac].xmii013_2_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmii2_d[l_ac].xmii013_2_desc
            LET g_xmii3_d[l_ac].xmii013_3_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmii3_d[l_ac].xmii013_3_desc            
            
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmii_d[l_ac].xmii009
            CALL ap_ref_array2(g_ref_fields,"SELECT imaal003,imaal004 FROM imaal_t WHERE imaalent='"||g_enterprise||"' AND imaal001=? AND imaal002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmii_d[l_ac].xmii009_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmii_d[l_ac].xmii009_desc
            LET g_xmii2_d[l_ac].xmii009_2_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmii2_d[l_ac].xmii009_2_desc        
            LET g_xmii3_d[l_ac].xmii009_3_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmii3_d[l_ac].xmii009_3_desc       
            LET g_xmii_d[l_ac].xmii009_desc1 = '', g_rtn_fields[2] , ''
            DISPLAY BY NAME g_xmii_d[l_ac].xmii009_desc1
            LET g_xmii2_d[l_ac].xmii009_2_desc_1 = '', g_rtn_fields[2] , ''
            DISPLAY BY NAME g_xmii2_d[l_ac].xmii009_2_desc_1        
            LET g_xmii3_d[l_ac].xmii009_3_desc_1 = '', g_rtn_fields[2] , ''
            DISPLAY BY NAME g_xmii3_d[l_ac].xmii009_3_desc_1                

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmii_d[l_ac].xmii017
            CALL ap_ref_array2(g_ref_fields,"SELECT oocal003 FROM oocal_t WHERE oocalent='"||g_enterprise||"' AND oocal001=? AND oocal002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmii_d[l_ac].xmii017_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmii_d[l_ac].xmii017_desc
            LET g_xmii2_d[l_ac].xmii017_2_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmii2_d[l_ac].xmii017_2_desc
            LET g_xmii3_d[l_ac].xmii017_3_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmii3_d[l_ac].xmii017_3_desc            ]]>
  </point>
  <point name="show.head.reference" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmih_m.xmihownid
            CALL ap_ref_array2(g_ref_fields,"SELECT oofa011 FROM oofa_t WHERE oofa002='2' AND oofa003=? ","") RETURNING g_rtn_fields
            LET g_xmih_m.xmihownid_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmih_m.xmihownid_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmih_m.xmihowndp
            CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmih_m.xmihowndp_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmih_m.xmihowndp_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmih_m.xmihcrtid
            CALL ap_ref_array2(g_ref_fields,"SELECT oofa011 FROM oofa_t WHERE oofa002='2' AND oofa003=? ","") RETURNING g_rtn_fields
            LET g_xmih_m.xmihcrtid_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmih_m.xmihcrtid_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmih_m.xmihcrtdp
            CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmih_m.xmihcrtdp_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmih_m.xmihcrtdp_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmih_m.xmihmodid
            CALL ap_ref_array2(g_ref_fields,"SELECT oofa011 FROM oofa_t WHERE oofa002='2' AND oofa003=? ","") RETURNING g_rtn_fields
            LET g_xmih_m.xmihmodid_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmih_m.xmihmodid_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmih_m.xmihcnfid
            CALL ap_ref_array2(g_ref_fields,"SELECT oofa011 FROM oofa_t WHERE oofa002='2' AND oofa003=? ","") RETURNING g_rtn_fields
            LET g_xmih_m.xmihcnfid_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmih_m.xmihcnfid_desc
            
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmih_m.xmih001
            CALL ap_ref_array2(g_ref_fields,"SELECT xmial003 FROM xmial_t WHERE xmialent='"||g_enterprise||"' AND xmial001=? AND xmial002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmih_m.xmih001_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmih_m.xmih001_desc             
            
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmih_m.xmih004
            CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmih_m.xmih004_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmih_m.xmih004_desc
            
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmih_m.xmih005
            CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmih_m.xmih005_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmih_m.xmih005_desc
                        
            SELECT xmia004 INTO g_xmih_m.ooai001 FROM xmia_t
             WHERE xmiaent = g_enterprise
               AND xmia001 = g_xmih_m.xmih001      
               
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmih_m.ooai001
            CALL ap_ref_array2(g_ref_fields,"SELECT ooail003 FROM ooail_t WHERE ooailent='"||g_enterprise||"' AND ooail001=? AND ooail002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmih_m.ooai001_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmih_m.ooai001_desc
            
            IF NOT cl_null(g_xmih_m.xmih005) THEN
               SELECT xmihstus INTO g_xmih_m.xmih005_stus FROM xmih_t
                WHERE xmihent = g_enterprise
                  AND xmih001 = g_xmih_m.xmih001
                  AND xmih002 = g_xmih_m.xmih002
                  AND xmih003 = g_xmih_m.xmih003
                  AND xmih004 = g_xmih_m.xmih005  
               CALL cl_set_comp_visible("group1",TRUE)  
               CALL cl_set_comp_visible("group5",TRUE)                     
            ELSE
               CALL cl_set_comp_visible("group1",FALSE)  
               CALL cl_set_comp_visible("group5",FALSE)                 
            END IF     ]]>
  </point>
  <point name="statechange.b_update" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[      CALL s_transaction_begin()
      IF lc_state = 'Y' THEN 
         CALL axmt175_conf_chk()
            RETURNING r_success,g_errno
         IF NOT r_success THEN
            CALL cl_err(g_xmih_m.xmih001,g_errno,1)
            RETURN
         ELSE
            IF NOT cl_ask_confirm('aim-00108') THEN
               RETURN
            ELSE
               CALL axmt175_conf_upd() RETURNING r_success
               IF NOT r_success THEN
                  CALL s_transaction_end('N','0')
                  RETURN
               ELSE
                  CALL s_transaction_end('Y','0')
               END IF
            END IF
         END IF
      END IF
      IF lc_state = 'N' THEN
         CALL axmt175_unconf_chk() 
              RETURNING r_success,g_errno
         IF NOT r_success THEN
            CALL cl_err(g_xmih_m.xmih001,g_errno,1)
            RETURN
         ELSE
            IF NOT cl_ask_confirm('axm-00233') THEN
               RETURN
            ELSE
               CALL axmt175_unconf_upd() RETURNING r_success
               IF NOT r_success THEN
                  CALL s_transaction_end('N','0')
                  RETURN
               ELSE
                  CALL s_transaction_end('Y','0')
               END IF
            END IF
         END IF
      END IF
      IF lc_state = 'C' THEN
         CALL axmt175_closed_chk() 
              RETURNING r_success,g_errno
         IF NOT r_success THEN
            CALL cl_err(g_xmih_m.xmih001,g_errno,1)
            RETURN
         ELSE
            IF NOT cl_ask_confirm('axm-00201') THEN
               RETURN
            ELSE
               CALL axmt175_closed_upd() 
                    RETURNING r_success
               IF NOT r_success THEN
                  CALL s_transaction_end('N','0')
                  RETURN
               ELSE
                  CALL s_transaction_end('Y','0')
               END IF
            END IF
         END IF
      END IF ]]>
  </point>
  <point name="statechange.before_menu" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[      CALL cl_set_act_visible("unconfirmed,closed,confirmed",TRUE)
      
      CASE g_xmih_m.xmihstus
         WHEN "N"
            CALL cl_set_act_visible("unconfirmed,closed",FALSE)
         WHEN "Y"
            CALL cl_set_act_visible("confirmed",FALSE)
         WHEN "C"
            CALL cl_set_act_visible("unconfirmed,closed,confirmed",FALSE)            
      END CASE   ]]>
  </point>
  <point name="statechange.define" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[   DEFINE r_success  LIKE type_t.num5]]>
  </point>
  <point name="ui_dialog.before_dialog2" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            CALL cl_set_act_visible("insert,delete,reproduce", FALSE)]]>
  </point>
  <point name="ui_dialog.more_displayarray" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[         DISPLAY ARRAY g_xmii4_d TO s_detail4.* ATTRIBUTES(COUNT=g_rec_b1) #page1                     
            BEFORE DISPLAY
               CALL FGL_SET_ARR_CURR(g_detail_idx)
               LET l_ac = DIALOG.getCurrentRow("s_detail4")             
         END DISPLAY 
         DISPLAY ARRAY g_xmii6_d TO s_detail6.* ATTRIBUTES(COUNT=g_rec_b1) #page1                                     
            BEFORE ROW
               LET g_detail_idx = DIALOG.getCurrentRow("s_detail6")
               LET l_ac = g_detail_idx
               DISPLAY g_detail_idx TO FORMONLY.idx

            BEFORE DISPLAY
               CALL FGL_SET_ARR_CURR(g_detail_idx)
               LET l_ac = DIALOG.getCurrentRow("s_detail6")
               DISPLAY g_rec_b1 TO FORMONLY.cnt               
         END DISPLAY      
         DISPLAY ARRAY g_xmii5_d TO s_detail5.* ATTRIBUTES(COUNT=g_rec_b1) #page1                     
            BEFORE DISPLAY
               CALL FGL_SET_ARR_CURR(g_detail_idx)
               LET l_ac = DIALOG.getCurrentRow("s_detail5")             
         END DISPLAY     
         DISPLAY ARRAY g_xmii7_d TO s_detail7.* ATTRIBUTES(COUNT=g_rec_b1) #page1                     
            BEFORE DISPLAY
               CALL FGL_SET_ARR_CURR(g_detail_idx)
               LET l_ac = DIALOG.getCurrentRow("s_detail7")             
         END DISPLAY          ]]>
  </point>
  <point name="ui_dialog.page1.before_row" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[               IF NOT cl_null(g_detail_idx) AND g_detail_idx <> 0 AND NOT cl_null(g_xmih_m.xmih005) THEN
                  CALL axmt175_b_fill3()
               END IF]]>
  </point>
  <section id="axmt175.b_fill" ver="19" status="" src="s">
    <![CDATA[#+ 單身陣列填充
PRIVATE FUNCTION axmt175_b_fill()
   DEFINE p_wc2      STRING
   #add-point:b_fill段define
   {<point name="b_fill.define"/>}
   #end add-point     
 
   CALL g_xmii_d.clear()    #g_xmii_d 單頭及單身 
   CALL g_xmii2_d.clear()
   CALL g_xmii3_d.clear()
 
 
   #add-point:b_fill段sql_before
   {<point name="b_fill.sql_before"/>}
   #end add-point
   
   #判斷是否填充
   IF axmt175_fill_chk(1) THEN
   
      LET g_sql = "SELECT  UNIQUE xmii005,xmii007,xmii006,xmii008,xmii012,xmii013,xmii011,xmii009,xmii010, 
          xmii017,xmii014,xmii005,xmii007,xmii006,xmii008,xmii012,xmii013,xmii011,xmii009,xmii010,xmii017, 
          xmii014,xmii005,xmii007,xmii006,xmii008,xmii012,xmii013,xmii011,xmii009,xmii010,xmii017,xmii014 , 
          t1.ooefl003 ,t2.ooefl003 ,t3.ooag011 ,t4.pmaal004 ,t5.oocql004 ,t6.rtaxl003 ,t7.imaal003 , 
          t8.oocal003 FROM xmii_t",   
                  " INNER JOIN xmih_t ON xmih001 = xmii001 ",
                  " AND xmih002 = xmii002 ",
                  " AND xmih003 = xmii003 ",
                  " AND xmih004 = xmii004 ",
 
                  #"",
                  
                  "",
                                 " LEFT JOIN ooefl_t t1 ON t1.ooeflent='"||g_enterprise||"' AND t1.ooefl001=xmii007 AND t1.ooefl002='"||g_dlang||"' ",
               " LEFT JOIN ooefl_t t2 ON t2.ooeflent='"||g_enterprise||"' AND t2.ooefl001=xmii006 AND t2.ooefl002='"||g_dlang||"' ",
               " LEFT JOIN ooag_t t3 ON t3.ooagent='"||g_enterprise||"' AND t3.ooag001=xmii008  ",
               " LEFT JOIN pmaal_t t4 ON t4.pmaalent='"||g_enterprise||"' AND t4.pmaal001=xmii012 AND t4.pmaal002='"||g_dlang||"' ",
               " LEFT JOIN oocql_t t5 ON t5.oocqlent='"||g_enterprise||"' AND oocq001='275' AND t5.oocql002=xmii013 AND t5.oocql003='"||g_dlang||"' ",
               " LEFT JOIN rtaxl_t t6 ON t6.rtaxlent='"||g_enterprise||"' AND t6.rtaxl001=xmii011 AND t6.rtaxl002='"||g_dlang||"' ",
               " LEFT JOIN imaal_t t7 ON t7.imaalent='"||g_enterprise||"' AND t7.imaal001=xmii009 AND t7.imaal002='"||g_dlang||"' ",
               " LEFT JOIN oocal_t t8 ON t8.oocalent='"||g_enterprise||"' AND t8.oocal001=xmii017 AND t8.oocal002='"||g_dlang||"' ",
 
                  " WHERE xmiient=? AND xmii001=? AND xmii002=? AND xmii003=? AND xmii004=?"
      LET g_sql = cl_sql_add_mask(g_sql)              #遮蔽特定資料
      #add-point:b_fill段sql_before
      {<point name="b_fill.body.fill_sql"/>}
      #end add-point
      IF NOT cl_null(g_wc2_table1) THEN
         LET g_sql = g_sql CLIPPED, " AND ", g_wc2_table1 CLIPPED
      END IF
      
      #子單身的WC
      
      
      LET g_sql = g_sql, " ORDER BY xmii_t.xmii006,xmii_t.xmii007,xmii_t.xmii008,xmii_t.xmii009,xmii_t.xmii010,xmii_t.xmii011,xmii_t.xmii012,xmii_t.xmii013,xmii_t.xmii014,xmii_t.xmii017"
      
      #add-point:單身填充控制
      {<point name="b_fill.sql"/>}
      #end add-point
      
      LET g_sql = cl_sql_add_mask(g_sql)              #遮蔽特定資料
      PREPARE axmt175_pb FROM g_sql
      DECLARE b_fill_cs CURSOR FOR axmt175_pb
      
      LET g_cnt = l_ac
      LET l_ac = 1
      
      OPEN b_fill_cs USING g_enterprise,g_xmih_m.xmih001,g_xmih_m.xmih002,g_xmih_m.xmih003,g_xmih_m.xmih004
                                               
      FOREACH b_fill_cs INTO g_xmii_d[l_ac].xmii005,g_xmii_d[l_ac].xmii007,g_xmii_d[l_ac].xmii006,g_xmii_d[l_ac].xmii008, 
          g_xmii_d[l_ac].xmii012,g_xmii_d[l_ac].xmii013,g_xmii_d[l_ac].xmii011,g_xmii_d[l_ac].xmii009, 
          g_xmii_d[l_ac].xmii010,g_xmii_d[l_ac].xmii017,g_xmii_d[l_ac].xmii014,g_xmii2_d[l_ac].xmii005, 
          g_xmii2_d[l_ac].xmii007,g_xmii2_d[l_ac].xmii006,g_xmii2_d[l_ac].xmii008,g_xmii2_d[l_ac].xmii012, 
          g_xmii2_d[l_ac].xmii013,g_xmii2_d[l_ac].xmii011,g_xmii2_d[l_ac].xmii009,g_xmii2_d[l_ac].xmii010, 
          g_xmii2_d[l_ac].xmii017,g_xmii2_d[l_ac].xmii014,g_xmii3_d[l_ac].xmii005,g_xmii3_d[l_ac].xmii007, 
          g_xmii3_d[l_ac].xmii006,g_xmii3_d[l_ac].xmii008,g_xmii3_d[l_ac].xmii012,g_xmii3_d[l_ac].xmii013, 
          g_xmii3_d[l_ac].xmii011,g_xmii3_d[l_ac].xmii009,g_xmii3_d[l_ac].xmii010,g_xmii3_d[l_ac].xmii017, 
          g_xmii3_d[l_ac].xmii014,g_xmii_d[l_ac].xmii007_desc,g_xmii_d[l_ac].xmii006_desc,g_xmii_d[l_ac].xmii008_desc, 
          g_xmii_d[l_ac].xmii012_desc,g_xmii_d[l_ac].xmii013_desc,g_xmii_d[l_ac].xmii011_desc,g_xmii_d[l_ac].xmii009_desc, 
          g_xmii_d[l_ac].xmii017_desc
         IF SQLCA.sqlcode THEN
            CALL cl_err("FOREACH:",SQLCA.sqlcode,1)
            EXIT FOREACH
         END IF
        
         #add-point:b_fill段資料填充
         {<point name="b_fill.fill"/>}
         #end add-point
      
         LET l_ac = l_ac + 1
         IF l_ac > g_max_rec THEN
            IF g_error_show = 1 THEN
               CALL cl_err( '', 9035, 1)
            END IF
            EXIT FOREACH
         END IF
         
      END FOREACH
      LET g_error_show = 0
   
   END IF
   
 
   
   #add-point:browser_fill段其他table處理
   {<point name="browser_fill.other_fill"/>}
   #end add-point
   
   CALL g_xmii_d.deleteElement(g_xmii_d.getLength())
   CALL g_xmii2_d.deleteElement(g_xmii2_d.getLength())
   CALL g_xmii3_d.deleteElement(g_xmii3_d.getLength())
 
   
 
   LET l_ac = g_cnt
   LET g_cnt = 0  
   
   FREE axmt175_pb
 
   
END FUNCTION
]]>
  </section>
  <section id="axmt175.b_fill2" ver="2" status="" src="s">
    <![CDATA[#+ 單身陣列填充2
PRIVATE FUNCTION axmt175_b_fill2(pi_idx)
   DEFINE pi_idx          LIKE type_t.num5
   DEFINE li_ac           LIKE type_t.num5
   DEFINE ls_chk          LIKE type_t.chr1
   #add-point:b_fill2段define
   {<point name="b_fill2.define"/>}
   #end add-point
   
   LET li_ac = l_ac 
   
   IF g_detail_idx <= 0 THEN
      RETURN
   END IF
   
 
      
   #add-point:單身填充後
   {<point name="b_fill2.after_fill" />}
   #end add-point
    
   LET l_ac = li_ac
   
   CALL axmt175_detail_show()
   
END FUNCTION
]]>
  </section>
  <section id="axmt175.browser_fill" ver="10" status="" src="s">
    <![CDATA[#+ 瀏覽頁簽資料填充
PRIVATE FUNCTION axmt175_browser_fill(ps_page_action)
   DEFINE ps_page_action    STRING
   DEFINE l_wc              STRING
   DEFINE l_wc2             STRING
   DEFINE l_sql             STRING
   DEFINE l_sub_sql         STRING
   DEFINE l_sql_rank        STRING
   DEFINE l_searchcol       STRING
   #add-point:browser_fill段define
   {<point name="browser_fill.define"/>}
   #end add-point    
 
   #清除畫面
   CLEAR FORM                
   INITIALIZE g_xmih_m.* TO NULL
   CALL g_xmii_d.clear()        
   CALL g_xmii2_d.clear() 
   CALL g_xmii3_d.clear() 
 
   CALL g_browser.clear()
   #add-point:browser_fill段動作開始前
   {<point name="browser_fill.before_browser_fill"/>}
   #end add-point
   
   #搜尋用
   IF cl_null(g_searchcol) OR g_searchcol = '0' THEN
      LET l_searchcol = "xmih001,xmih002,xmih003,xmih004"
   ELSE
      LET l_searchcol = g_searchcol
   END IF
   
   IF cl_null(g_wc) THEN
      LET g_wc = " 1=1"
   END IF
   IF cl_null(g_wc2) THEN
      LET g_wc2 = " 1=1"
   END IF
   LET l_wc  = g_wc.trim() 
   LET l_wc2 = g_wc2.trim()
 
   #add-point:browser_fill,foreach前
   {<point name="browser_fill.before_foreach"/>}
   #end add-point
    
   IF g_wc2 <> " 1=1" THEN
      #單身有輸入搜尋條件                      
      LET l_sub_sql = " SELECT UNIQUE xmih001,xmih002,xmih003,xmih004 ",
                      " FROM xmih_t ",
                      " ",
                      " LEFT JOIN xmii_t ON xmiient = xmihent AND xmih001 = xmii001 AND xmih002 = xmii002 AND xmih003 = xmii003 AND xmih004 = xmii004 ",
 
 
                      " ", 
                      " ", 
                      " WHERE xmihent = '" ||g_enterprise|| "' AND xmiient = '" ||g_enterprise|| "' AND ",l_wc, " AND ", l_wc2, cl_sql_add_filter("xmih_t")
   ELSE
      #單身未輸入搜尋條件
      LET l_sub_sql = " SELECT UNIQUE xmih001,xmih002,xmih003,xmih004 ",
                      " FROM xmih_t ", 
                      "  ",
                      "  ",
                      " WHERE xmihent = '" ||g_enterprise|| "' AND ",l_wc CLIPPED, cl_sql_add_filter("xmih_t")
   END IF
   
   LET g_sql = " SELECT COUNT(*) FROM (",l_sub_sql,")"
   
   #add-point:browser_fill,count前
   {<point name="browser_fill.before_count"/>}
   #end add-point
   
   PREPARE header_cnt_pre FROM g_sql
   EXECUTE header_cnt_pre INTO g_browser_cnt   #總筆數
   FREE header_cnt_pre
 
   DISPLAY g_browser_cnt TO FORMONLY.b_count   #總筆數的顯示
   DISPLAY g_browser_cnt TO FORMONLY.h_count   #總筆數的顯示
 
   #依照xmih001,'',xmih002,xmih003,xmih004,'' Browser欄位定義(取代原本bs_sql功能)
   LET g_sql = " SELECT DISTINCT xmihstus,xmih001,'',xmih002,xmih003,xmih004,'',t1.xmial003 ,t2.ooefl003 ", 

               " FROM xmih_t ",
               "  ",
               "  LEFT JOIN xmii_t ON xmiient = xmihent AND xmih001 = xmii001 AND xmih002 = xmii002 AND xmih003 = xmii003 AND xmih004 = xmii004 ",
 
 
               "  ",
               "  ",
                              " LEFT JOIN xmial_t t1 ON t1.xmialent='"||g_enterprise||"' AND t1.xmial001=xmih001 AND t1.xmial002='"||g_lang||"' ",
               " LEFT JOIN ooefl_t t2 ON t2.ooeflent='"||g_enterprise||"' AND t2.ooefl001=xmih004 AND t2.ooefl002='"||g_lang||"' ",
 
               " WHERE xmihent = '" ||g_enterprise|| "' AND ",l_wc," AND ",l_wc2, cl_sql_add_filter("xmih_t"),
               " ORDER BY ",l_searchcol," ",g_order
 
   #add-point:browser_fill,before_prepare
   {<point name="browser_fill.before_prepare"/>}
   #end add-point
        
   LET g_sql = cl_sql_add_mask(g_sql)              #遮蔽特定資料
   PREPARE browse_pre FROM g_sql
   DECLARE browse_cur CURSOR FOR browse_pre
   
   #add-point:browser_fill,open
   {<point name="browser_fill.open"/>}
   #end add-point
 
   CALL g_browser.clear()
   LET g_cnt = 1
   FOREACH browse_cur INTO g_browser[g_cnt].b_statepic,g_browser[g_cnt].b_xmih001,g_browser[g_cnt].b_xmih001_desc, 
       g_browser[g_cnt].b_xmih002,g_browser[g_cnt].b_xmih003,g_browser[g_cnt].b_xmih004,g_browser[g_cnt].b_xmih004_desc, 
       g_browser[g_cnt].b_xmih001_desc,g_browser[g_cnt].b_xmih004_desc
      IF SQLCA.sqlcode THEN
         CALL cl_err('foreach:',SQLCA.sqlcode,1)
         EXIT FOREACH
      END IF
  
      #add-point:browser_fill段reference
      {<point name="browser_fill.reference"/>}
      #end add-point
  
            #此段落由子樣板a24產生
      CASE g_browser[g_cnt].b_statepic
         WHEN "N"
            LET g_browser[g_cnt].b_statepic = "stus/16/unconfirmed.png"
         WHEN "Y"
            LET g_browser[g_cnt].b_statepic = "stus/16/confirmed.png"
         WHEN "C"
            LET g_browser[g_cnt].b_statepic = "stus/16/closed.png"
         
      END CASE
 
 
      LET g_cnt = g_cnt + 1
      IF g_cnt > g_max_rec THEN
         CALL cl_err('',9035,0)
         EXIT FOREACH
      END IF
      
   END FOREACH
 
   CALL g_browser.deleteElement(g_cnt)
   LET g_header_cnt = g_browser.getLength()
 
   LET g_rec_b = g_cnt - 1
   LET g_detail_cnt = g_rec_b
   LET g_cnt = 0
   
   FREE browse_pre
   
   #add-point:browser_fill段結束前
   {<point name="browser_fill.after"/>}
   #end add-point
   
   #若無資料則關閉相關功能
   IF g_browser_cnt = 0 THEN
      CALL cl_set_act_visible("statechange,modify,delete,reproduce", FALSE)
   ELSE
      CALL cl_set_act_visible("statechange,modify,delete,reproduce", TRUE)
   END IF
   
END FUNCTION
]]>
  </section>
  <section id="axmt175.browser_search" ver="3" status="" src="s">
    <![CDATA[#+ 瀏覽頁簽資料搜尋
PRIVATE FUNCTION axmt175_browser_search(p_type)
   DEFINE p_type LIKE type_t.chr10
   #add-point:browser_search段define
   {<point name="browser_search.define"/>}
   #end add-point    
   
   #若無輸入關鍵字則查找出所有資料
   IF NOT cl_null(g_searchstr) AND g_searchcol='0' THEN
      CALL cl_err("searchcol","std-00005",0)
      RETURN FALSE 
   END IF 
   
   IF NOT cl_null(g_searchstr) THEN
      LET g_wc = " lower(", g_searchcol, ") LIKE '%", g_searchstr, "%'"
      LET g_wc = g_wc.toLowerCase()
   ELSE
      LET g_wc = " 1=1 "
   END IF         
   
   #若為排序搜尋則添加以下條件
   IF cl_null(g_searchcol) OR g_searchcol = "0" THEN
      LET g_wc = g_wc, " ORDER BY xmih001,xmih002,xmih003,xmih004"
   ELSE
      LET g_wc = g_wc, " ORDER BY ", g_searchcol
   END IF 
 
   CALL axmt175_browser_fill("F")
   RETURN TRUE
 
END FUNCTION
]]>
  </section>
  <section id="axmt175.construct" ver="26" status="" src="s">
    <![CDATA[#+ QBE資料查詢
PRIVATE FUNCTION axmt175_construct()
   DEFINE ls_return   STRING
   DEFINE ls_result   STRING 
   DEFINE ls_wc       STRING 
   #add-point:cs段define
   {<point name="cs.define"/>}
   #end add-point    
 
   #清除畫面
   CLEAR FORM                
   INITIALIZE g_xmih_m.* TO NULL
   CALL g_xmii_d.clear()        
   CALL g_xmii2_d.clear() 
   CALL g_xmii3_d.clear() 
 
   
   LET g_action_choice = ""
    
   INITIALIZE g_wc TO NULL
   INITIALIZE g_wc2 TO NULL
   
   INITIALIZE g_wc2_table1 TO NULL
 
    
   LET g_qryparam.state = 'c'
   
   #add-point:cs段開始前
   {<point name="cs.before_construct"/>}
   #end add-point 
   
   #使用DIALOG包住 單頭CONSTRUCT及單身CONSTRUCT
   DIALOG ATTRIBUTES(UNBUFFERED,FIELD ORDER FORM)
      
      #單頭
      CONSTRUCT BY NAME g_wc ON xmih001,xmih004,xmih002,xmih005,xmih003,xmihstus,xmihownid,xmihcrtdp, 
          xmihowndp,xmihcrtdt,xmihcrtid,xmihmodid,xmihcnfid,xmihmoddt,xmihcnfdt
 
         BEFORE CONSTRUCT
            #add-point:cs段before_construct
            {<point name="cs.head.before_construct"/>}
            #end add-point 
            
         #公用欄位開窗相關處理
         #此段落由子樣板a11產生
         ##----<<xmihcrtdt>>----
         AFTER FIELD xmihcrtdt
            CALL FGL_DIALOG_GETBUFFER() RETURNING ls_result
            IF NOT cl_null(ls_result) THEN
               IF NOT cl_chk_date_symbol(ls_result) THEN
                  LET ls_result = cl_add_date_extra_cond(ls_result)
               END IF
            END IF
            CALL FGL_DIALOG_SETBUFFER(ls_result)
         
         #----<<xmihmoddt>>----
         AFTER FIELD xmihmoddt
            CALL FGL_DIALOG_GETBUFFER() RETURNING ls_result
            IF NOT cl_null(ls_result) THEN
               IF NOT cl_chk_date_symbol(ls_result) THEN
                  LET ls_result = cl_add_date_extra_cond(ls_result)
               END IF
            END IF
            CALL FGL_DIALOG_SETBUFFER(ls_result)
         
         #----<<xmihcnfdt>>----
         AFTER FIELD xmihcnfdt
            CALL FGL_DIALOG_GETBUFFER() RETURNING ls_result
            IF NOT cl_null(ls_result) THEN
               IF NOT cl_chk_date_symbol(ls_result) THEN
                  LET ls_result = cl_add_date_extra_cond(ls_result)
               END IF
            END IF
            CALL FGL_DIALOG_SETBUFFER(ls_result)
         
         #----<<xmihpstdt>>----
 
 
            
         #一般欄位開窗相關處理    
                  #Ctrlp:construct.c.xmih001
         ON ACTION controlp INFIELD xmih001
            #add-point:ON ACTION controlp INFIELD xmih001
            {<point name="construct.c.xmih001" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmih001
            #add-point:BEFORE FIELD xmih001
            {<point name="construct.b.xmih001" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmih001
            
            #add-point:AFTER FIELD xmih001
            {<point name="construct.a.xmih001" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmih004
         ON ACTION controlp INFIELD xmih004
            #add-point:ON ACTION controlp INFIELD xmih004
            {<point name="construct.c.xmih004" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmih004
            #add-point:BEFORE FIELD xmih004
            {<point name="construct.b.xmih004" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmih004
            
            #add-point:AFTER FIELD xmih004
            {<point name="construct.a.xmih004" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmih002
            #add-point:BEFORE FIELD xmih002
            {<point name="construct.b.xmih002" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmih002
            
            #add-point:AFTER FIELD xmih002
            {<point name="construct.a.xmih002" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmih002
         ON ACTION controlp INFIELD xmih002
            #add-point:ON ACTION controlp INFIELD xmih002
            {<point name="construct.c.xmih002" />}
            #END add-point
 
         #Ctrlp:construct.c.xmih005
         ON ACTION controlp INFIELD xmih005
            #add-point:ON ACTION controlp INFIELD xmih005
            {<point name="construct.c.xmih005" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmih005
            #add-point:BEFORE FIELD xmih005
            {<point name="construct.b.xmih005" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmih005
            
            #add-point:AFTER FIELD xmih005
            {<point name="construct.a.xmih005" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmih003
            #add-point:BEFORE FIELD xmih003
            {<point name="construct.b.xmih003" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmih003
            
            #add-point:AFTER FIELD xmih003
            {<point name="construct.a.xmih003" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmih003
         ON ACTION controlp INFIELD xmih003
            #add-point:ON ACTION controlp INFIELD xmih003
            {<point name="construct.c.xmih003" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmihstus
            #add-point:BEFORE FIELD xmihstus
            {<point name="construct.b.xmihstus" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmihstus
            
            #add-point:AFTER FIELD xmihstus
            {<point name="construct.a.xmihstus" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmihstus
         ON ACTION controlp INFIELD xmihstus
            #add-point:ON ACTION controlp INFIELD xmihstus
            {<point name="construct.c.xmihstus" />}
            #END add-point
 
         #Ctrlp:construct.c.xmihownid
         ON ACTION controlp INFIELD xmihownid
            #add-point:ON ACTION controlp INFIELD xmihownid
            {<point name="construct.c.xmihownid" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmihownid
            #add-point:BEFORE FIELD xmihownid
            {<point name="construct.b.xmihownid" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmihownid
            
            #add-point:AFTER FIELD xmihownid
            {<point name="construct.a.xmihownid" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmihcrtdp
         ON ACTION controlp INFIELD xmihcrtdp
            #add-point:ON ACTION controlp INFIELD xmihcrtdp
            {<point name="construct.c.xmihcrtdp" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmihcrtdp
            #add-point:BEFORE FIELD xmihcrtdp
            {<point name="construct.b.xmihcrtdp" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmihcrtdp
            
            #add-point:AFTER FIELD xmihcrtdp
            {<point name="construct.a.xmihcrtdp" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmihowndp
         ON ACTION controlp INFIELD xmihowndp
            #add-point:ON ACTION controlp INFIELD xmihowndp
            {<point name="construct.c.xmihowndp" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmihowndp
            #add-point:BEFORE FIELD xmihowndp
            {<point name="construct.b.xmihowndp" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmihowndp
            
            #add-point:AFTER FIELD xmihowndp
            {<point name="construct.a.xmihowndp" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmihcrtdt
            #add-point:BEFORE FIELD xmihcrtdt
            {<point name="construct.b.xmihcrtdt" />}
            #END add-point
 
         #Ctrlp:construct.c.xmihcrtid
         ON ACTION controlp INFIELD xmihcrtid
            #add-point:ON ACTION controlp INFIELD xmihcrtid
            {<point name="construct.c.xmihcrtid" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmihcrtid
            #add-point:BEFORE FIELD xmihcrtid
            {<point name="construct.b.xmihcrtid" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmihcrtid
            
            #add-point:AFTER FIELD xmihcrtid
            {<point name="construct.a.xmihcrtid" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmihmodid
         ON ACTION controlp INFIELD xmihmodid
            #add-point:ON ACTION controlp INFIELD xmihmodid
            {<point name="construct.c.xmihmodid" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmihmodid
            #add-point:BEFORE FIELD xmihmodid
            {<point name="construct.b.xmihmodid" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmihmodid
            
            #add-point:AFTER FIELD xmihmodid
            {<point name="construct.a.xmihmodid" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmihcnfid
         ON ACTION controlp INFIELD xmihcnfid
            #add-point:ON ACTION controlp INFIELD xmihcnfid
            {<point name="construct.c.xmihcnfid" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmihcnfid
            #add-point:BEFORE FIELD xmihcnfid
            {<point name="construct.b.xmihcnfid" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmihcnfid
            
            #add-point:AFTER FIELD xmihcnfid
            {<point name="construct.a.xmihcnfid" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmihmoddt
            #add-point:BEFORE FIELD xmihmoddt
            {<point name="construct.b.xmihmoddt" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmihcnfdt
            #add-point:BEFORE FIELD xmihcnfdt
            {<point name="construct.b.xmihcnfdt" />}
            #END add-point
 
 
         
      END CONSTRUCT
 
      #單身根據table分拆construct
      CONSTRUCT g_wc2_table1 ON xmii007,xmii006,xmii008,xmii012,xmii013,xmii011,xmii009,xmii010,xmii017, 
          xmii014,l_xmii022_01,l_xmii023_01,l_xmii023_02,l_xmii023_03,l_xmii023_04,l_xmii023_05,l_xmii023_06, 
          l_xmii023_07,l_xmii023_08,l_xmii023_09,l_xmii023_10,l_xmii023_11,l_xmii023_12,l_xmii023_13, 
          l_xmii023_14,l_xmii023_15,l_xmii023_16,l_xmii023_17,l_xmii023_18,l_xmii023_19,l_xmii023_20, 
          l_xmii023_21,l_xmii023_22,l_xmii023_23,l_xmii023_24
           FROM s_detail1[1].xmii007,s_detail1[1].xmii006,s_detail1[1].xmii008,s_detail1[1].xmii012, 
               s_detail1[1].xmii013,s_detail1[1].xmii011,s_detail1[1].xmii009,s_detail1[1].xmii010,s_detail1[1].xmii017, 
               s_detail1[1].xmii014,s_detail2[1].l_xmii022_01,s_detail2[1].l_xmii023_01,s_detail2[1].l_xmii023_02, 
               s_detail2[1].l_xmii023_03,s_detail2[1].l_xmii023_04,s_detail2[1].l_xmii023_05,s_detail2[1].l_xmii023_06, 
               s_detail2[1].l_xmii023_07,s_detail2[1].l_xmii023_08,s_detail2[1].l_xmii023_09,s_detail2[1].l_xmii023_10, 
               s_detail2[1].l_xmii023_11,s_detail2[1].l_xmii023_12,s_detail2[1].l_xmii023_13,s_detail2[1].l_xmii023_14, 
               s_detail2[1].l_xmii023_15,s_detail2[1].l_xmii023_16,s_detail2[1].l_xmii023_17,s_detail2[1].l_xmii023_18, 
               s_detail2[1].l_xmii023_19,s_detail2[1].l_xmii023_20,s_detail2[1].l_xmii023_21,s_detail2[1].l_xmii023_22, 
               s_detail2[1].l_xmii023_23,s_detail2[1].l_xmii023_24
                      
         BEFORE CONSTRUCT
            #add-point:cs段before_construct
            {<point name="cs.body.before_construct"/>}
            #end add-point 
            
       #單身公用欄位開窗相關處理
       
         
       #單身一般欄位開窗相關處理
                #Ctrlp:construct.c.page1.xmii007
         ON ACTION controlp INFIELD xmii007
            #add-point:ON ACTION controlp INFIELD xmii007
            {<point name="construct.c.page1.xmii007" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmii007
            #add-point:BEFORE FIELD xmii007
            {<point name="construct.b.page1.xmii007" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmii007
            
            #add-point:AFTER FIELD xmii007
            {<point name="construct.a.page1.xmii007" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmii006
         ON ACTION controlp INFIELD xmii006
            #add-point:ON ACTION controlp INFIELD xmii006
            {<point name="construct.c.page1.xmii006" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmii006
            #add-point:BEFORE FIELD xmii006
            {<point name="construct.b.page1.xmii006" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmii006
            
            #add-point:AFTER FIELD xmii006
            {<point name="construct.a.page1.xmii006" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmii008
         ON ACTION controlp INFIELD xmii008
            #add-point:ON ACTION controlp INFIELD xmii008
            {<point name="construct.c.page1.xmii008" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmii008
            #add-point:BEFORE FIELD xmii008
            {<point name="construct.b.page1.xmii008" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmii008
            
            #add-point:AFTER FIELD xmii008
            {<point name="construct.a.page1.xmii008" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmii012
         ON ACTION controlp INFIELD xmii012
            #add-point:ON ACTION controlp INFIELD xmii012
            {<point name="construct.c.page1.xmii012" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmii012
            #add-point:BEFORE FIELD xmii012
            {<point name="construct.b.page1.xmii012" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmii012
            
            #add-point:AFTER FIELD xmii012
            {<point name="construct.a.page1.xmii012" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmii013
         ON ACTION controlp INFIELD xmii013
            #add-point:ON ACTION controlp INFIELD xmii013
            {<point name="construct.c.page1.xmii013" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmii013
            #add-point:BEFORE FIELD xmii013
            {<point name="construct.b.page1.xmii013" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmii013
            
            #add-point:AFTER FIELD xmii013
            {<point name="construct.a.page1.xmii013" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmii011
         ON ACTION controlp INFIELD xmii011
            #add-point:ON ACTION controlp INFIELD xmii011
            {<point name="construct.c.page1.xmii011" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmii011
            #add-point:BEFORE FIELD xmii011
            {<point name="construct.b.page1.xmii011" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmii011
            
            #add-point:AFTER FIELD xmii011
            {<point name="construct.a.page1.xmii011" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmii009
         ON ACTION controlp INFIELD xmii009
            #add-point:ON ACTION controlp INFIELD xmii009
            {<point name="construct.c.page1.xmii009" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmii009
            #add-point:BEFORE FIELD xmii009
            {<point name="construct.b.page1.xmii009" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmii009
            
            #add-point:AFTER FIELD xmii009
            {<point name="construct.a.page1.xmii009" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmii010
         ON ACTION controlp INFIELD xmii010
            #add-point:ON ACTION controlp INFIELD xmii010
            {<point name="construct.c.page1.xmii010" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmii010
            #add-point:BEFORE FIELD xmii010
            {<point name="construct.b.page1.xmii010" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmii010
            
            #add-point:AFTER FIELD xmii010
            {<point name="construct.a.page1.xmii010" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmii017
         ON ACTION controlp INFIELD xmii017
            #add-point:ON ACTION controlp INFIELD xmii017
            {<point name="construct.c.page1.xmii017" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmii017
            #add-point:BEFORE FIELD xmii017
            {<point name="construct.b.page1.xmii017" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmii017
            
            #add-point:AFTER FIELD xmii017
            {<point name="construct.a.page1.xmii017" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmii014
            #add-point:BEFORE FIELD xmii014
            {<point name="construct.b.page1.xmii014" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmii014
            
            #add-point:AFTER FIELD xmii014
            {<point name="construct.a.page1.xmii014" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmii014
         ON ACTION controlp INFIELD xmii014
            #add-point:ON ACTION controlp INFIELD xmii014
            {<point name="construct.c.page1.xmii014" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii022_01
            #add-point:BEFORE FIELD l_xmii022_01
            {<point name="construct.b.page2.l_xmii022_01" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii022_01
            
            #add-point:AFTER FIELD l_xmii022_01
            {<point name="construct.a.page2.l_xmii022_01" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page2.l_xmii022_01
         ON ACTION controlp INFIELD l_xmii022_01
            #add-point:ON ACTION controlp INFIELD l_xmii022_01
            {<point name="construct.c.page2.l_xmii022_01" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii023_01
            #add-point:BEFORE FIELD l_xmii023_01
            {<point name="construct.b.page2.l_xmii023_01" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii023_01
            
            #add-point:AFTER FIELD l_xmii023_01
            {<point name="construct.a.page2.l_xmii023_01" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page2.l_xmii023_01
         ON ACTION controlp INFIELD l_xmii023_01
            #add-point:ON ACTION controlp INFIELD l_xmii023_01
            {<point name="construct.c.page2.l_xmii023_01" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii023_02
            #add-point:BEFORE FIELD l_xmii023_02
            {<point name="construct.b.page2.l_xmii023_02" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii023_02
            
            #add-point:AFTER FIELD l_xmii023_02
            {<point name="construct.a.page2.l_xmii023_02" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page2.l_xmii023_02
         ON ACTION controlp INFIELD l_xmii023_02
            #add-point:ON ACTION controlp INFIELD l_xmii023_02
            {<point name="construct.c.page2.l_xmii023_02" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii023_03
            #add-point:BEFORE FIELD l_xmii023_03
            {<point name="construct.b.page2.l_xmii023_03" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii023_03
            
            #add-point:AFTER FIELD l_xmii023_03
            {<point name="construct.a.page2.l_xmii023_03" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page2.l_xmii023_03
         ON ACTION controlp INFIELD l_xmii023_03
            #add-point:ON ACTION controlp INFIELD l_xmii023_03
            {<point name="construct.c.page2.l_xmii023_03" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii023_04
            #add-point:BEFORE FIELD l_xmii023_04
            {<point name="construct.b.page2.l_xmii023_04" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii023_04
            
            #add-point:AFTER FIELD l_xmii023_04
            {<point name="construct.a.page2.l_xmii023_04" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page2.l_xmii023_04
         ON ACTION controlp INFIELD l_xmii023_04
            #add-point:ON ACTION controlp INFIELD l_xmii023_04
            {<point name="construct.c.page2.l_xmii023_04" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii023_05
            #add-point:BEFORE FIELD l_xmii023_05
            {<point name="construct.b.page2.l_xmii023_05" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii023_05
            
            #add-point:AFTER FIELD l_xmii023_05
            {<point name="construct.a.page2.l_xmii023_05" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page2.l_xmii023_05
         ON ACTION controlp INFIELD l_xmii023_05
            #add-point:ON ACTION controlp INFIELD l_xmii023_05
            {<point name="construct.c.page2.l_xmii023_05" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii023_06
            #add-point:BEFORE FIELD l_xmii023_06
            {<point name="construct.b.page2.l_xmii023_06" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii023_06
            
            #add-point:AFTER FIELD l_xmii023_06
            {<point name="construct.a.page2.l_xmii023_06" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page2.l_xmii023_06
         ON ACTION controlp INFIELD l_xmii023_06
            #add-point:ON ACTION controlp INFIELD l_xmii023_06
            {<point name="construct.c.page2.l_xmii023_06" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii023_07
            #add-point:BEFORE FIELD l_xmii023_07
            {<point name="construct.b.page2.l_xmii023_07" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii023_07
            
            #add-point:AFTER FIELD l_xmii023_07
            {<point name="construct.a.page2.l_xmii023_07" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page2.l_xmii023_07
         ON ACTION controlp INFIELD l_xmii023_07
            #add-point:ON ACTION controlp INFIELD l_xmii023_07
            {<point name="construct.c.page2.l_xmii023_07" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii023_08
            #add-point:BEFORE FIELD l_xmii023_08
            {<point name="construct.b.page2.l_xmii023_08" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii023_08
            
            #add-point:AFTER FIELD l_xmii023_08
            {<point name="construct.a.page2.l_xmii023_08" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page2.l_xmii023_08
         ON ACTION controlp INFIELD l_xmii023_08
            #add-point:ON ACTION controlp INFIELD l_xmii023_08
            {<point name="construct.c.page2.l_xmii023_08" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii023_09
            #add-point:BEFORE FIELD l_xmii023_09
            {<point name="construct.b.page2.l_xmii023_09" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii023_09
            
            #add-point:AFTER FIELD l_xmii023_09
            {<point name="construct.a.page2.l_xmii023_09" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page2.l_xmii023_09
         ON ACTION controlp INFIELD l_xmii023_09
            #add-point:ON ACTION controlp INFIELD l_xmii023_09
            {<point name="construct.c.page2.l_xmii023_09" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii023_10
            #add-point:BEFORE FIELD l_xmii023_10
            {<point name="construct.b.page2.l_xmii023_10" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii023_10
            
            #add-point:AFTER FIELD l_xmii023_10
            {<point name="construct.a.page2.l_xmii023_10" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page2.l_xmii023_10
         ON ACTION controlp INFIELD l_xmii023_10
            #add-point:ON ACTION controlp INFIELD l_xmii023_10
            {<point name="construct.c.page2.l_xmii023_10" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii023_11
            #add-point:BEFORE FIELD l_xmii023_11
            {<point name="construct.b.page2.l_xmii023_11" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii023_11
            
            #add-point:AFTER FIELD l_xmii023_11
            {<point name="construct.a.page2.l_xmii023_11" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page2.l_xmii023_11
         ON ACTION controlp INFIELD l_xmii023_11
            #add-point:ON ACTION controlp INFIELD l_xmii023_11
            {<point name="construct.c.page2.l_xmii023_11" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii023_12
            #add-point:BEFORE FIELD l_xmii023_12
            {<point name="construct.b.page2.l_xmii023_12" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii023_12
            
            #add-point:AFTER FIELD l_xmii023_12
            {<point name="construct.a.page2.l_xmii023_12" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page2.l_xmii023_12
         ON ACTION controlp INFIELD l_xmii023_12
            #add-point:ON ACTION controlp INFIELD l_xmii023_12
            {<point name="construct.c.page2.l_xmii023_12" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii023_13
            #add-point:BEFORE FIELD l_xmii023_13
            {<point name="construct.b.page2.l_xmii023_13" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii023_13
            
            #add-point:AFTER FIELD l_xmii023_13
            {<point name="construct.a.page2.l_xmii023_13" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page2.l_xmii023_13
         ON ACTION controlp INFIELD l_xmii023_13
            #add-point:ON ACTION controlp INFIELD l_xmii023_13
            {<point name="construct.c.page2.l_xmii023_13" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii023_14
            #add-point:BEFORE FIELD l_xmii023_14
            {<point name="construct.b.page2.l_xmii023_14" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii023_14
            
            #add-point:AFTER FIELD l_xmii023_14
            {<point name="construct.a.page2.l_xmii023_14" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page2.l_xmii023_14
         ON ACTION controlp INFIELD l_xmii023_14
            #add-point:ON ACTION controlp INFIELD l_xmii023_14
            {<point name="construct.c.page2.l_xmii023_14" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii023_15
            #add-point:BEFORE FIELD l_xmii023_15
            {<point name="construct.b.page2.l_xmii023_15" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii023_15
            
            #add-point:AFTER FIELD l_xmii023_15
            {<point name="construct.a.page2.l_xmii023_15" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page2.l_xmii023_15
         ON ACTION controlp INFIELD l_xmii023_15
            #add-point:ON ACTION controlp INFIELD l_xmii023_15
            {<point name="construct.c.page2.l_xmii023_15" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii023_16
            #add-point:BEFORE FIELD l_xmii023_16
            {<point name="construct.b.page2.l_xmii023_16" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii023_16
            
            #add-point:AFTER FIELD l_xmii023_16
            {<point name="construct.a.page2.l_xmii023_16" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page2.l_xmii023_16
         ON ACTION controlp INFIELD l_xmii023_16
            #add-point:ON ACTION controlp INFIELD l_xmii023_16
            {<point name="construct.c.page2.l_xmii023_16" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii023_17
            #add-point:BEFORE FIELD l_xmii023_17
            {<point name="construct.b.page2.l_xmii023_17" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii023_17
            
            #add-point:AFTER FIELD l_xmii023_17
            {<point name="construct.a.page2.l_xmii023_17" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page2.l_xmii023_17
         ON ACTION controlp INFIELD l_xmii023_17
            #add-point:ON ACTION controlp INFIELD l_xmii023_17
            {<point name="construct.c.page2.l_xmii023_17" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii023_18
            #add-point:BEFORE FIELD l_xmii023_18
            {<point name="construct.b.page2.l_xmii023_18" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii023_18
            
            #add-point:AFTER FIELD l_xmii023_18
            {<point name="construct.a.page2.l_xmii023_18" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page2.l_xmii023_18
         ON ACTION controlp INFIELD l_xmii023_18
            #add-point:ON ACTION controlp INFIELD l_xmii023_18
            {<point name="construct.c.page2.l_xmii023_18" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii023_19
            #add-point:BEFORE FIELD l_xmii023_19
            {<point name="construct.b.page2.l_xmii023_19" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii023_19
            
            #add-point:AFTER FIELD l_xmii023_19
            {<point name="construct.a.page2.l_xmii023_19" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page2.l_xmii023_19
         ON ACTION controlp INFIELD l_xmii023_19
            #add-point:ON ACTION controlp INFIELD l_xmii023_19
            {<point name="construct.c.page2.l_xmii023_19" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii023_20
            #add-point:BEFORE FIELD l_xmii023_20
            {<point name="construct.b.page2.l_xmii023_20" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii023_20
            
            #add-point:AFTER FIELD l_xmii023_20
            {<point name="construct.a.page2.l_xmii023_20" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page2.l_xmii023_20
         ON ACTION controlp INFIELD l_xmii023_20
            #add-point:ON ACTION controlp INFIELD l_xmii023_20
            {<point name="construct.c.page2.l_xmii023_20" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii023_21
            #add-point:BEFORE FIELD l_xmii023_21
            {<point name="construct.b.page2.l_xmii023_21" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii023_21
            
            #add-point:AFTER FIELD l_xmii023_21
            {<point name="construct.a.page2.l_xmii023_21" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page2.l_xmii023_21
         ON ACTION controlp INFIELD l_xmii023_21
            #add-point:ON ACTION controlp INFIELD l_xmii023_21
            {<point name="construct.c.page2.l_xmii023_21" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii023_22
            #add-point:BEFORE FIELD l_xmii023_22
            {<point name="construct.b.page2.l_xmii023_22" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii023_22
            
            #add-point:AFTER FIELD l_xmii023_22
            {<point name="construct.a.page2.l_xmii023_22" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page2.l_xmii023_22
         ON ACTION controlp INFIELD l_xmii023_22
            #add-point:ON ACTION controlp INFIELD l_xmii023_22
            {<point name="construct.c.page2.l_xmii023_22" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii023_23
            #add-point:BEFORE FIELD l_xmii023_23
            {<point name="construct.b.page2.l_xmii023_23" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii023_23
            
            #add-point:AFTER FIELD l_xmii023_23
            {<point name="construct.a.page2.l_xmii023_23" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page2.l_xmii023_23
         ON ACTION controlp INFIELD l_xmii023_23
            #add-point:ON ACTION controlp INFIELD l_xmii023_23
            {<point name="construct.c.page2.l_xmii023_23" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii023_24
            #add-point:BEFORE FIELD l_xmii023_24
            {<point name="construct.b.page2.l_xmii023_24" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii023_24
            
            #add-point:AFTER FIELD l_xmii023_24
            {<point name="construct.a.page2.l_xmii023_24" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page2.l_xmii023_24
         ON ACTION controlp INFIELD l_xmii023_24
            #add-point:ON ACTION controlp INFIELD l_xmii023_24
            {<point name="construct.c.page2.l_xmii023_24" />}
            #END add-point
 
   
       
      END CONSTRUCT
      
 
      
 
      
      #add-point:cs段add_cs(本段內只能出現新的CONSTRUCT指令)
      {<point name="cs.add_cs"/>}
      #end add-point
 
      BEFORE DIALOG
         CALL cl_qbe_init()
         #add-point:cs段b_dialog
         {<point name="cs.b_dialog"/>}
         #end add-point  
 
      #查詢方案列表
      ON ACTION qbe_select
         LET ls_wc = ""
         CALL cl_qbe_list("c") RETURNING ls_wc
    
      #條件儲存為方案
      ON ACTION qbe_save
         CALL cl_qbe_save()
 
      ON ACTION accept
         ACCEPT DIALOG
 
      ON ACTION cancel
         LET INT_FLAG = 1
         EXIT DIALOG 
 
      #交談指令共用ACTION
      &include "common_action.4gl" 
         CONTINUE DIALOG
   END DIALOG
   
   #組合g_wc2
   LET g_wc2 = g_wc2_table1
 
 
 
   
   #add-point:cs段結束前
   {<point name="cs.after_construct"/>}
   #end add-point    
 
   IF INT_FLAG THEN
      RETURN
   END IF
 
END FUNCTION
]]>
  </section>
  <section id="axmt175.default_search" ver="3" status="" src="s">
    <![CDATA[#+ 外部參數搜尋
PRIVATE FUNCTION axmt175_default_search()
   DEFINE li_idx  LIKE type_t.num5
   DEFINE li_cnt  LIKE type_t.num5
   DEFINE ls_wc   STRING
   #add-point:default_search段define
   {<point name="default_search.define"/>}
   #end add-point  
   
   #add-point:default_search段開始前
   {<point name="default_search.before"/>}
   #end add-point  
   
   LET g_pagestart = 1
   
   IF cl_null(g_order) THEN
      LET g_order = "ASC"
   END IF
   
   IF NOT cl_null(g_argv[01]) THEN
      LET ls_wc = ls_wc, " xmih001 = '", g_argv[01], "' AND "
   END IF
   
   IF NOT cl_null(g_argv[02]) THEN
      LET ls_wc = ls_wc, " xmih002 = '", g_argv[02], "' AND "
   END IF
   IF NOT cl_null(g_argv[03]) THEN
      LET ls_wc = ls_wc, " xmih003 = '", g_argv[03], "' AND "
   END IF
   IF NOT cl_null(g_argv[04]) THEN
      LET ls_wc = ls_wc, " xmih004 = '", g_argv[04], "' AND "
   END IF
 
   
   IF NOT cl_null(ls_wc) THEN
      LET g_wc = ls_wc.subString(1,ls_wc.getLength()-5)
      LET g_default = TRUE
   ELSE
      LET g_default = FALSE
      #預設查詢條件
      LET g_wc = cl_qbe_get_default_qryplan()
      IF cl_null(g_wc) THEN
         LET g_wc = " 1=1"
      END IF
   END IF
   
   #add-point:default_search段結束前
   {<point name="default_search.after"/>}
   #end add-point  
 
END FUNCTION
]]>
  </section>
  <section id="axmt175.delete" ver="10" status="" src="s">
    <![CDATA[#+ 資料刪除
PRIVATE FUNCTION axmt175_delete()
   DEFINE  l_var_keys      DYNAMIC ARRAY OF STRING
   DEFINE  l_field_keys    DYNAMIC ARRAY OF STRING
   DEFINE  l_vars          DYNAMIC ARRAY OF STRING
   DEFINE  l_fields        DYNAMIC ARRAY OF STRING
   DEFINE  l_var_keys_bak  DYNAMIC ARRAY OF STRING
   #add-point:delete段define
   {<point name="delete.define"/>}
   #end add-point     
   
   IF g_xmih_m.xmih001 IS NULL
   OR g_xmih_m.xmih002 IS NULL
   OR g_xmih_m.xmih003 IS NULL
   OR g_xmih_m.xmih004 IS NULL
 
   THEN
      CALL cl_err("","std-00003",0)
      RETURN
   END IF
   
   
 
   CALL axmt175_show()
   
   CALL s_transaction_begin()
 
   OPEN axmt175_cl USING g_enterprise,g_xmih_m.xmih001,g_xmih_m.xmih002,g_xmih_m.xmih003,g_xmih_m.xmih004
   IF STATUS THEN
      CALL cl_err("OPEN axmt175_cl:", STATUS, 1)
      CLOSE axmt175_cl
      CALL s_transaction_end('N','0')
      RETURN
   END IF
 
   #顯示最新的資料
   EXECUTE axmt175_master_referesh USING g_xmih_m.xmih001,g_xmih_m.xmih002,g_xmih_m.xmih003,g_xmih_m.xmih004 INTO g_xmih_m.xmih001, 
       g_xmih_m.xmih004,g_xmih_m.xmih002,g_xmih_m.xmih005,g_xmih_m.xmih003,g_xmih_m.xmihstus,g_xmih_m.xmihownid, 
       g_xmih_m.xmihcrtdp,g_xmih_m.xmihowndp,g_xmih_m.xmihcrtdt,g_xmih_m.xmihcrtid,g_xmih_m.xmihmodid, 
       g_xmih_m.xmihcnfid,g_xmih_m.xmihmoddt,g_xmih_m.xmihcnfdt,g_xmih_m.xmih001_desc,g_xmih_m.xmih004_desc, 
       g_xmih_m.xmih005_desc,g_xmih_m.xmihownid_desc,g_xmih_m.xmihcrtdp_desc,g_xmih_m.xmihowndp_desc, 
       g_xmih_m.xmihcrtid_desc,g_xmih_m.xmihmodid_desc,g_xmih_m.xmihcnfid_desc
 
   IF SQLCA.sqlcode THEN
      CALL cl_err(g_xmih_m.xmih001,SQLCA.sqlcode,0)          #資料被他人LOCK
      CALL s_transaction_end('N','0')
      RETURN
   END IF
   
   #add-point:delete段before ask
   {<point name="delete.before_ask"/>}
   #end add-point 
 
   IF cl_ask_del_master() THEN              #確認一下
   
      #add-point:單頭刪除前
      {<point name="delete.head.b_delete" mark="Y"/>}
      #end add-point   
      
      #+ 此段落由子樣板a47產生
      #刪除相關文件
      CALL axmt175_set_pk_array()
      #add-point:相關文件刪除前
      {<point name="delete.befroe.related_document_remove"/>}
      #end add-point   
      CALL cl_doc_remove()  
 
  
  
      #資料備份
      LET g_xmih001_t = g_xmih_m.xmih001
      LET g_xmih002_t = g_xmih_m.xmih002
      LET g_xmih003_t = g_xmih_m.xmih003
      LET g_xmih004_t = g_xmih_m.xmih004
 
 
      DELETE FROM xmih_t
       WHERE xmihent = g_enterprise AND xmih001 = g_xmih_m.xmih001
         AND xmih002 = g_xmih_m.xmih002
         AND xmih003 = g_xmih_m.xmih003
         AND xmih004 = g_xmih_m.xmih004
 
       
      #add-point:單頭刪除中
      {<point name="delete.head.m_delete"/>}
      #end add-point
       
      IF SQLCA.sqlcode THEN
         CALL cl_err(g_xmih_m.xmih001,SQLCA.sqlcode,0) 
         CALL s_transaction_end('N','0')
         RETURN
      END IF
      
      #add-point:單頭刪除後
      {<point name="delete.head.a_delete"/>}
      #end add-point
  
      #add-point:單身刪除前
      {<point name="delete.body.b_delete" mark="Y"/>}
      #end add-point
      
      DELETE FROM xmii_t
       WHERE xmiient = g_enterprise AND xmii001 = g_xmih_m.xmih001
         AND xmii002 = g_xmih_m.xmih002
         AND xmii003 = g_xmih_m.xmih003
         AND xmii004 = g_xmih_m.xmih004
 
 
      #add-point:單身刪除中
      {<point name="delete.body.m_delete"/>}
      #end add-point
         
      IF SQLCA.sqlcode THEN
         CALL cl_err("xmii_t",SQLCA.sqlcode,0) 
         CALL s_transaction_end('N','0')
         RETURN
      END IF    
 
      #add-point:單身刪除後
      {<point name="delete.body.a_delete"/>}
      #end add-point
      
            
                                                               
 
 
 
                                                               
      CLEAR FORM
      CALL g_xmii_d.clear() 
      CALL g_xmii2_d.clear()       
      CALL g_xmii3_d.clear()       
 
     
      #CALL axmt175_ui_browser_refresh()  
      CALL axmt175_ui_headershow()  
      CALL axmt175_ui_detailshow()
       
      IF g_browser_cnt > 0 THEN 
         CALL axmt175_browser_fill("")
         CALL axmt175_fetch('P')
         DISPLAY g_browser_cnt TO FORMONLY.h_count   #總筆數的顯示
      ELSE
         LET g_wc = " 1=1"
         CALL axmt175_browser_fill("F")
      END IF
      
      #單頭多語言刪除
      
      
      #單身多語言刪除
      
 
 
   
      #add-point:多語言刪除
      {<point name="delete.lang.delete"/>}
      #end add-point
   
   END IF
 
   CALL s_transaction_end('Y','0')
   
   CLOSE axmt175_cl
 
   #流程通知預埋點-D
   CALL cl_flow_notify(g_xmih_m.xmih001,'D')
    
END FUNCTION
]]>
  </section>
  <section id="axmt175.delete_b" ver="3" status="" src="s">
    <![CDATA[#+ 刪除單身後其他table連動
PRIVATE FUNCTION axmt175_delete_b(ps_table,ps_keys_bak,ps_page)
   DEFINE ps_table    STRING
   DEFINE ps_page     STRING
   DEFINE ps_keys_bak DYNAMIC ARRAY OF VARCHAR(500)
   DEFINE ls_group    STRING
   #add-point:delete_b段define
   {<point name="delete_b.define"/>}
   #end add-point     
 
   #判斷是否是同一群組的table
   LET ls_group = "'1','2','3',"
   IF ls_group.getIndexOf(ps_page,1) > 0 THEN
      #add-point:delete_b段刪除前
      {<point name="delete_b.b_delete" mark="Y"/>}
      #end add-point    
      DELETE FROM xmii_t
       WHERE xmiient = g_enterprise AND
         xmii001 = ps_keys_bak[1] AND xmii002 = ps_keys_bak[2] AND xmii003 = ps_keys_bak[3] AND xmii004 = ps_keys_bak[4] AND xmii006 = ps_keys_bak[5] AND xmii007 = ps_keys_bak[6] AND xmii008 = ps_keys_bak[7] AND xmii009 = ps_keys_bak[8] AND xmii010 = ps_keys_bak[9] AND xmii011 = ps_keys_bak[10] AND xmii012 = ps_keys_bak[11] AND xmii013 = ps_keys_bak[12] AND xmii014 = ps_keys_bak[13] AND xmii017 = ps_keys_bak[14]
      #add-point:delete_b段刪除中
      {<point name="delete_b.m_delete"/>}
      #end add-point    
      IF SQLCA.sqlcode THEN
         CALL cl_err("",SQLCA.sqlcode,0)
      END IF
      #add-point:delete_b段刪除後
      {<point name="delete_b.a_delete"/>}
      #end add-point   
   END IF
   
 
   
 
   
   #add-point:delete_b段other
   {<point name="delete_b.other"/>}
   #end add-point  
   
END FUNCTION
]]>
  </section>
  <section id="axmt175.description" ver="179" status="" src="s">
    <![CDATA[#+ Version..: T100-ERP-1.00.00(SD版次:1,PR版次:1) Build-000228
#+ 
#+ Filename...: axmt175
#+ Description: 集團銷售預測彙總調整作業
#+ Creator....: 01534(2014/04/04)
#+ Modifier...: 01534(2014/04/14)
#+ Buildtype..: 應用 t01 樣板自動產生
#+ 以上段落由子樣板a00產生
]]>
  </section>
  <section id="axmt175.detail_reproduce" ver="2" status="" src="s">
    <![CDATA[#+ 單身自動複製
PRIVATE FUNCTION axmt175_detail_reproduce()
   DEFINE ls_sql      STRING
   DEFINE ld_date     DATETIME YEAR TO SECOND
   DEFINE l_detail    RECORD LIKE xmii_t.*
 
 
   #add-point:delete段define
   {<point name="detail_reproduce.define"/>}
   #end add-point    
   
   CALL s_transaction_begin()
   
   LET ld_date = cl_get_current()
   
   DROP TABLE axmt175_detail
   
   #add-point:單身複製前1
   {<point name="detail_reproduce.body.table1.b_insert" mark="Y"/>}
   #end add-point
   
   #CREATE TEMP TABLE
   LET ls_sql = "CREATE GLOBAL TEMPORARY TABLE axmt175_detail AS ",
                "SELECT * FROM xmii_t "
   PREPARE repro_tbl FROM ls_sql
   EXECUTE repro_tbl
   FREE repro_tbl
                
   #將符合條件的資料丟入TEMP TABLE
   INSERT INTO axmt175_detail SELECT * FROM xmii_t 
                                         WHERE xmiient = g_enterprise AND xmii001 = g_xmih001_t
                                         AND xmii002 = g_xmih002_t
                                         AND xmii003 = g_xmih003_t
                                         AND xmii004 = g_xmih004_t
 
   
   #將key修正為調整後   
   UPDATE axmt175_detail 
      #更新key欄位
      SET xmii001 = g_xmih_m.xmih001
          , xmii002 = g_xmih_m.xmih002
          , xmii003 = g_xmih_m.xmih003
          , xmii004 = g_xmih_m.xmih004
 
      #更新共用欄位
      
                                       
  
   #將資料塞回原table   
   INSERT INTO xmii_t SELECT * FROM axmt175_detail
   
   IF SQLCA.sqlcode THEN
      CALL cl_err("reproduce",SQLCA.sqlcode,1)
      RETURN
   END IF
   
   #add-point:單身複製中1
   {<point name="detail_reproduce.body.table1.m_insert"/>}
   #end add-point
   
   #刪除TEMP TABLE
   DROP TABLE axmt175_detail
   
   #add-point:單身複製後1
   {<point name="detail_reproduce.body.table1.a_insert"/>}
   #end add-point
 
 
   
 
   
   #多語言複製段落
   
   
   CALL s_transaction_end('Y','0')
   
   #已新增完, 調整資料內容(修改時使用)
   LET g_xmih001_t = g_xmih_m.xmih001
   LET g_xmih002_t = g_xmih_m.xmih002
   LET g_xmih003_t = g_xmih_m.xmih003
   LET g_xmih004_t = g_xmih_m.xmih004
 
   
   DROP TABLE axmt175_detail
   
END FUNCTION
]]>
  </section>
  <section id="axmt175.detail_show" ver="2" status="" src="s">
    <![CDATA[#+ 第二階單身reference
PRIVATE FUNCTION axmt175_detail_show()
   #add-point:detail_show段define
   {<point name="detail_show.define"/>}
   #end add-point  
 
   #add-point:detail_show段之前
   {<point name="detail_show.before"/>}
   #end add-point
   
   #add-point:detail_show段之後
   {<point name="detail_show.after"/>}
   #end add-point
   
END FUNCTION
]]>
  </section>
  <section id="axmt175.fetch" ver="7" status="" src="s">
    <![CDATA[#+ 指定PK後抓取單頭其他資料
PRIVATE FUNCTION axmt175_fetch(p_flag)
   DEFINE p_flag     LIKE type_t.chr1
   DEFINE ls_msg     STRING
   #add-point:fetch段define
   {<point name="fetch.define"/>}
   #end add-point    
   
   IF g_browser_cnt = 0 THEN
      RETURN
   END IF
   
   CASE p_flag
      WHEN 'F' LET g_current_idx = 1
      WHEN 'L' LET g_current_idx = g_header_cnt        
      WHEN 'P'
         IF g_current_idx > 1 THEN               
            LET g_current_idx = g_current_idx - 1
         END IF 
      WHEN 'N'
         IF g_current_idx < g_header_cnt THEN
            LET g_current_idx =  g_current_idx + 1
         END IF        
      WHEN '/'
         IF (NOT g_no_ask) THEN    
            CALL cl_set_act_visible("accept,cancel", TRUE)    
            CALL cl_getmsg('fetch',g_lang) RETURNING ls_msg
            LET INT_FLAG = 0
 
            PROMPT ls_msg CLIPPED,':' FOR g_jump
               #交談指令共用ACTION
               &include "common_action.4gl" 
            END PROMPT
 
            CALL cl_set_act_visible("accept,cancel", FALSE)    
            IF INT_FLAG THEN
                LET INT_FLAG = 0
                EXIT CASE  
            END IF           
         END IF
         
         IF g_jump > 0 AND g_jump <= g_browser.getLength() THEN
             LET g_current_idx = g_jump
         END IF
         
         LET g_no_ask = FALSE  
   END CASE 
   
   
   CALL g_curr_diag.setCurrentRow("s_browse", g_current_idx) #設定browse 索引
   
   LET g_detail_cnt = g_header_cnt                  
   
   #單身總筆數顯示
   #LET g_detail_idx = 1
   IF g_detail_cnt > 0 THEN
      #LET g_detail_idx = 1
      DISPLAY g_detail_idx TO FORMONLY.idx  
   ELSE
      LET g_detail_idx = 0
      DISPLAY ' ' TO FORMONLY.idx    
   END IF
   
   #瀏覽頁筆數顯示
   LET g_browser_idx = g_pagestart+g_current_idx-1
   DISPLAY g_browser_idx TO FORMONLY.b_index   #當下筆數
   DISPLAY g_browser_idx TO FORMONLY.h_index   #當下筆數
   
   CALL cl_navigator_setting( g_current_idx, g_browser_cnt )
   
   #代表沒有資料
   IF g_current_idx = 0 OR g_browser.getLength() = 0 THEN
      RETURN
   END IF
   
   #超出範圍
   IF g_current_idx > g_browser.getLength() THEN
      LET g_current_idx = g_browser.getLength()
   END IF
   
   LET g_xmih_m.xmih001 = g_browser[g_current_idx].b_xmih001
   LET g_xmih_m.xmih002 = g_browser[g_current_idx].b_xmih002
   LET g_xmih_m.xmih003 = g_browser[g_current_idx].b_xmih003
   LET g_xmih_m.xmih004 = g_browser[g_current_idx].b_xmih004
 
   
   #重讀DB,因TEMP有不被更新特性
   EXECUTE axmt175_master_referesh USING g_xmih_m.xmih001,g_xmih_m.xmih002,g_xmih_m.xmih003,g_xmih_m.xmih004 INTO g_xmih_m.xmih001, 
       g_xmih_m.xmih004,g_xmih_m.xmih002,g_xmih_m.xmih005,g_xmih_m.xmih003,g_xmih_m.xmihstus,g_xmih_m.xmihownid, 
       g_xmih_m.xmihcrtdp,g_xmih_m.xmihowndp,g_xmih_m.xmihcrtdt,g_xmih_m.xmihcrtid,g_xmih_m.xmihmodid, 
       g_xmih_m.xmihcnfid,g_xmih_m.xmihmoddt,g_xmih_m.xmihcnfdt,g_xmih_m.xmih001_desc,g_xmih_m.xmih004_desc, 
       g_xmih_m.xmih005_desc,g_xmih_m.xmihownid_desc,g_xmih_m.xmihcrtdp_desc,g_xmih_m.xmihowndp_desc, 
       g_xmih_m.xmihcrtid_desc,g_xmih_m.xmihmodid_desc,g_xmih_m.xmihcnfid_desc
   IF SQLCA.sqlcode THEN
      CALL cl_err("xmih_t",SQLCA.sqlcode,1)
      INITIALIZE g_xmih_m.* TO NULL
      RETURN
   END IF
   
   #add-point:fetch段action控制
   {<point name="fetch.action_control"/>}
   #end add-point  
   
   
   
   #add-point:fetch結束前
   {<point name="fetch.after" />}
   #end add-point
   
   #保存單頭舊值
   LET g_xmih_m_t.* = g_xmih_m.*
   LET g_xmih_m_o.* = g_xmih_m.*
   
   #LET g_data_owner =       
   #LET g_data_group =   
   
   #重新顯示   
   CALL axmt175_show()
 
   
 
END FUNCTION
]]>
  </section>
  <section id="axmt175.fill_chk" ver="4" status="" src="s">
    <![CDATA[#+ 單身填充確認
PRIVATE FUNCTION axmt175_fill_chk(ps_idx)
   DEFINE ps_idx        LIKE type_t.chr10
   #add-point:fill_chk段define
   {<point name="fill_chk.define"/>}
   #end add-point
   
   #add-point:fill_chk段before_chk
   {<point name="fill_chk.before_chk"/>}
   #end add-point
   
   #全部為1=1 or null時回傳true
   IF (cl_null(g_wc2_table1) OR g_wc2_table1.trim() = '1=1') THEN
      #add-point:fill_chk段other_chk
      {<point name="fill_chk.other_chk"/>}
      #end add-point
      RETURN TRUE
   END IF
   
   #第一單身
   IF ps_idx = 1 AND
      ((NOT cl_null(g_wc2_table1) AND g_wc2_table1.trim() <> '1=1')) THEN
      RETURN TRUE
   END IF
   
   #根據wc判定是否需要填充
 
 
 
   #add-point:fill_chk段after_chk
   {<point name="fill_chk.after_chk"/>}
   #end add-point
 
   RETURN FALSE
 
END FUNCTION
]]>
  </section>
  <section id="axmt175.filter" ver="3" status="" src="s">
    <![CDATA[#+ 此段落由子樣板a50產生
#+ filter過濾功能
PRIVATE FUNCTION axmt175_filter()
   #add-point:filter段define
   {<point name="filter.define"/>}
   #end add-point   
 
   #切換畫面
   IF NOT g_main_hidden THEN
      CALL gfrm_curr.setElementHidden("mainlayout",1)
      CALL gfrm_curr.setElementHidden("worksheet",0)
      LET g_main_hidden = 1
   END IF   
 
   LET INT_FLAG = 0
 
   LET g_qryparam.state = 'c'
 
   LET g_wc_filter_t = g_wc_filter.trim()
   LET g_wc_t = g_wc
 
   LET g_wc = cl_replace_str(g_wc, g_wc_filter_t, '')
 
   #使用DIALOG包住 單頭CONSTRUCT及單身CONSTRUCT
   DIALOG ATTRIBUTES(UNBUFFERED,FIELD ORDER FORM)
 
      #單頭
      CONSTRUCT g_wc_filter ON xmih001,xmih002,xmih003,xmih004
                          FROM s_browse[1].b_xmih001,s_browse[1].b_xmih002,s_browse[1].b_xmih003,s_browse[1].b_xmih004 

 
         BEFORE CONSTRUCT
               DISPLAY axmt175_filter_parser('xmih001') TO s_browse[1].b_xmih001
            DISPLAY axmt175_filter_parser('xmih002') TO s_browse[1].b_xmih002
            DISPLAY axmt175_filter_parser('xmih003') TO s_browse[1].b_xmih003
            DISPLAY axmt175_filter_parser('xmih004') TO s_browse[1].b_xmih004
      
         #add-point:filter段cs_ctrl
         {<point name="filter.cs_ctrl"/>}
         #end add-point
      
      END CONSTRUCT
 
      #add-point:filter段add_cs
      {<point name="filter.add_cs"/>}
      #end add-point
 
      BEFORE DIALOG
         #add-point:filter段b_dialog
         {<point name="filter.b_dialog"/>}
         #end add-point  
      
      ON ACTION accept
         ACCEPT DIALOG
 
      ON ACTION cancel
         LET INT_FLAG = 1
         EXIT DIALOG 
 
      #交談指令共用ACTION
      &include "common_action.4gl" 
         CONTINUE DIALOG
   
   END DIALOG
 
   IF NOT INT_FLAG THEN
      LET g_wc_filter = "   AND   ", g_wc_filter, "   "
      LET g_wc = g_wc , g_wc_filter
   ELSE
      LET g_wc_filter = g_wc_filter_t
      LET g_wc = g_wc_t
   END IF
 
      CALL axmt175_filter_show('xmih001')
   CALL axmt175_filter_show('xmih002')
   CALL axmt175_filter_show('xmih003')
   CALL axmt175_filter_show('xmih004')
 
END FUNCTION
]]>
  </section>
  <section id="axmt175.filter_parser" ver="1" status="" src="s">
    <![CDATA[#+ filter過濾功能
PRIVATE FUNCTION axmt175_filter_parser(ps_field)
   DEFINE ps_field   STRING
   DEFINE ls_tmp     STRING
   DEFINE li_tmp     LIKE type_t.num5
   DEFINE li_tmp2    LIKE type_t.num5
   DEFINE ls_var     STRING
   #add-point:filter段define
   {<point name="filter_parser.define"/>}
   #end add-point    
 
   #一般條件解析
   LET ls_tmp = ps_field, "='"
   LET li_tmp = g_wc_filter.getIndexOf(ls_tmp,1)
   IF li_tmp > 0 THEN
      LET li_tmp = ls_tmp.getLength() + li_tmp
      LET li_tmp2 = g_wc_filter.getIndexOf("'",li_tmp + 1) - 1
      LET ls_var = g_wc_filter.subString(li_tmp,li_tmp2)
   END IF
 
   #模糊條件解析
   LET ls_tmp = ps_field, " like '"
   LET li_tmp = g_wc_filter.getIndexOf(ls_tmp,1)
   IF li_tmp > 0 THEN
      LET li_tmp = ls_tmp.getLength() + li_tmp
      LET li_tmp2 = g_wc_filter.getIndexOf("'",li_tmp + 1) - 1
      LET ls_var = g_wc_filter.subString(li_tmp,li_tmp2)
      LET ls_var = cl_replace_str(ls_var,'%','*')
   END IF
 
   RETURN ls_var
 
END FUNCTION
]]>
  </section>
  <section id="axmt175.filter_show" ver="1" status="" src="s">
    <![CDATA[#+ 顯示過濾條件
PRIVATE FUNCTION axmt175_filter_show(ps_field)
   DEFINE ps_field         STRING
   DEFINE lnode_item       om.DomNode
   DEFINE ls_title         STRING
   DEFINE ls_name          STRING
   DEFINE ls_condition     STRING
 
   LET ls_name = "formonly.b_", ps_field
   LET lnode_item = gfrm_curr.findNode("TableColumn", ls_name)
   LET ls_title = lnode_item.getAttribute("text")
   IF ls_title.getIndexOf('※',1) > 0 THEN
      LEt ls_title = ls_title.subString(1,ls_title.getIndexOf('※',1)-1)
   END IF
 
   #顯示資料組合
   LET ls_condition = axmt175_filter_parser(ps_field)
   IF NOT cl_null(ls_condition) THEN
      LET ls_title = ls_title, '※', ls_condition, '※'
   END IF
 
   #將資料顯示回去
   CALL lnode_item.setAttribute("text",ls_title)
 
END FUNCTION
]]>
  </section>
  <section id="axmt175.global" ver="26" status="" src="s">
    <![CDATA[{<point name="global.memo" />}
        
IMPORT os
IMPORT util
IMPORT FGL lib_cl_dlg
#add-point:增加匯入項目
{<point name="global.import" />}
#end add-point
 
SCHEMA ds 
 
GLOBALS "../../cfg/top_global.inc"
 
#add-point:增加匯入變數檔
{<point name="global.inc" />}
#end add-point
 
#單頭 type 宣告
PRIVATE type type_g_xmih_m        RECORD
       xmih001 LIKE xmih_t.xmih001, 
   xmih001_desc LIKE type_t.chr80, 
   xmih004 LIKE xmih_t.xmih004, 
   xmih004_desc LIKE type_t.chr80, 
   ooai001 LIKE ooai_t.ooai001, 
   ooai001_desc LIKE type_t.chr80, 
   xmih002 LIKE xmih_t.xmih002, 
   xmih005 LIKE xmih_t.xmih005, 
   xmih005_desc LIKE type_t.chr80, 
   xmih003 LIKE xmih_t.xmih003, 
   xmih005_stus LIKE type_t.chr10, 
   xmihstus LIKE xmih_t.xmihstus, 
   xmihownid LIKE xmih_t.xmihownid, 
   xmihownid_desc LIKE type_t.chr80, 
   xmihcrtdp LIKE xmih_t.xmihcrtdp, 
   xmihcrtdp_desc LIKE type_t.chr80, 
   xmihowndp LIKE xmih_t.xmihowndp, 
   xmihowndp_desc LIKE type_t.chr80, 
   xmihcrtdt DATETIME YEAR TO SECOND, 
   xmihcrtid LIKE xmih_t.xmihcrtid, 
   xmihcrtid_desc LIKE type_t.chr80, 
   xmihmodid LIKE xmih_t.xmihmodid, 
   xmihmodid_desc LIKE type_t.chr80, 
   xmihcnfid LIKE xmih_t.xmihcnfid, 
   xmihcnfid_desc LIKE type_t.chr80, 
   xmihmoddt DATETIME YEAR TO SECOND, 
   xmihcnfdt DATETIME YEAR TO SECOND
       END RECORD
 
#單身 type 宣告
PRIVATE TYPE type_g_xmii_d        RECORD
       xmii005 LIKE xmii_t.xmii005, 
   xmii007 LIKE xmii_t.xmii007, 
   xmii007_desc LIKE type_t.chr500, 
   xmii006 LIKE xmii_t.xmii006, 
   xmii006_desc LIKE type_t.chr500, 
   xmii008 LIKE xmii_t.xmii008, 
   xmii008_desc LIKE type_t.chr500, 
   xmii012 LIKE xmii_t.xmii012, 
   xmii012_desc LIKE type_t.chr500, 
   xmii013 LIKE xmii_t.xmii013, 
   xmii013_desc LIKE type_t.chr500, 
   xmii011 LIKE xmii_t.xmii011, 
   xmii011_desc LIKE type_t.chr500, 
   xmii009 LIKE xmii_t.xmii009, 
   xmii009_desc LIKE type_t.chr500, 
   xmii009_desc1 LIKE type_t.chr500, 
   xmii010 LIKE xmii_t.xmii010, 
   xmii017 LIKE xmii_t.xmii017, 
   xmii017_desc LIKE type_t.chr500, 
   xmii014 LIKE xmii_t.xmii014, 
   l_xmii018_01 LIKE type_t.num20_6, 
   l_xmii019_01 LIKE type_t.num20_6, 
   l_xmii018_02 LIKE type_t.num20_6, 
   l_xmii019_02 LIKE type_t.num20_6, 
   l_xmii018_03 LIKE type_t.num20_6, 
   l_xmii019_03 LIKE type_t.num20_6, 
   l_xmii018_04 LIKE type_t.num20_6, 
   l_xmii019_04 LIKE type_t.num20_6, 
   l_xmii018_05 LIKE type_t.num20_6, 
   l_xmii019_05 LIKE type_t.num20_6, 
   l_xmii018_06 LIKE type_t.num20_6, 
   l_xmii019_06 LIKE type_t.num20_6, 
   l_xmii018_07 LIKE type_t.num20_6, 
   l_xmii019_07 LIKE type_t.num20_6, 
   l_xmii018_08 LIKE type_t.num20_6, 
   l_xmii019_08 LIKE type_t.num20_6, 
   l_xmii018_09 LIKE type_t.num20_6, 
   l_xmii019_09 LIKE type_t.num20_6, 
   l_xmii018_10 LIKE type_t.num20_6, 
   l_xmii019_10 LIKE type_t.num20_6, 
   l_xmii018_11 LIKE type_t.num20_6, 
   l_xmii019_11 LIKE type_t.num20_6, 
   l_xmii018_12 LIKE type_t.num20_6, 
   l_xmii019_12 LIKE type_t.num20_6, 
   l_xmii018_13 LIKE type_t.num20_6, 
   l_xmii019_13 LIKE type_t.num20_6, 
   l_xmii018_14 LIKE type_t.num20_6, 
   l_xmii019_14 LIKE type_t.num20_6, 
   l_xmii018_15 LIKE type_t.num20_6, 
   l_xmii019_15 LIKE type_t.num20_6, 
   l_xmii018_16 LIKE type_t.num20_6, 
   l_xmii019_16 LIKE type_t.num20_6, 
   l_xmii018_17 LIKE type_t.num20_6, 
   l_xmii019_17 LIKE type_t.num20_6, 
   l_xmii018_18 LIKE type_t.num20_6, 
   l_xmii019_18 LIKE type_t.num20_6, 
   l_xmii018_19 LIKE type_t.num20_6, 
   l_xmii019_19 LIKE type_t.num20_6, 
   l_xmii018_20 LIKE type_t.num20_6, 
   l_xmii019_20 LIKE type_t.num20_6, 
   l_xmii018_21 LIKE type_t.num20_6, 
   l_xmii019_21 LIKE type_t.num20_6, 
   l_xmii018_22 LIKE type_t.num20_6, 
   l_xmii019_22 LIKE type_t.num20_6, 
   l_xmii018_23 LIKE type_t.num20_6, 
   l_xmii019_23 LIKE type_t.num20_6, 
   l_xmii018_24 LIKE type_t.num20_6, 
   l_xmii019_24 LIKE type_t.num20_6, 
   l_xmii018_s LIKE type_t.num20_6, 
   l_xmii019_s LIKE type_t.num20_6
       END RECORD
PRIVATE TYPE type_g_xmii2_d RECORD
       xmii005 LIKE xmii_t.xmii005, 
   xmii007 LIKE xmii_t.xmii007, 
   xmii007_2_desc LIKE type_t.chr500, 
   xmii006 LIKE xmii_t.xmii006, 
   xmii006_2_desc LIKE type_t.chr500, 
   xmii008 LIKE xmii_t.xmii008, 
   xmii008_2_desc LIKE type_t.chr500, 
   xmii012 LIKE xmii_t.xmii012, 
   xmii012_2_desc LIKE type_t.chr500, 
   xmii013 LIKE xmii_t.xmii013, 
   xmii013_2_desc LIKE type_t.chr500, 
   xmii011 LIKE xmii_t.xmii011, 
   xmii011_2_desc LIKE type_t.chr500, 
   xmii009 LIKE xmii_t.xmii009, 
   xmii009_2_desc LIKE type_t.chr500, 
   xmii009_2_desc_1 LIKE type_t.chr500, 
   xmii010 LIKE xmii_t.xmii010, 
   xmii017 LIKE xmii_t.xmii017, 
   xmii017_2_desc LIKE type_t.chr500, 
   xmii014 LIKE xmii_t.xmii014, 
   l_xmii022_01 LIKE type_t.num20_6, 
   l_xmii023_01 LIKE type_t.num20_6, 
   l_xmii022_02 LIKE type_t.num20_6, 
   l_xmii023_02 LIKE type_t.num20_6, 
   l_xmii022_03 LIKE type_t.num20_6, 
   l_xmii023_03 LIKE type_t.num20_6, 
   l_xmii022_04 LIKE type_t.num20_6, 
   l_xmii023_04 LIKE type_t.num20_6, 
   l_xmii022_05 LIKE type_t.num20_6, 
   l_xmii023_05 LIKE type_t.num20_6, 
   l_xmii022_06 LIKE type_t.num20_6, 
   l_xmii023_06 LIKE type_t.num20_6, 
   l_xmii022_07 LIKE type_t.num20_6, 
   l_xmii023_07 LIKE type_t.num20_6, 
   l_xmii022_08 LIKE type_t.num20_6, 
   l_xmii023_08 LIKE type_t.num20_6, 
   l_xmii022_09 LIKE type_t.num20_6, 
   l_xmii023_09 LIKE type_t.num20_6, 
   l_xmii022_10 LIKE type_t.num20_6, 
   l_xmii023_10 LIKE type_t.num20_6, 
   l_xmii022_11 LIKE type_t.num20_6, 
   l_xmii023_11 LIKE type_t.num20_6, 
   l_xmii022_12 LIKE type_t.num20_6, 
   l_xmii023_12 LIKE type_t.num20_6, 
   l_xmii022_13 LIKE type_t.num20_6, 
   l_xmii023_13 LIKE type_t.num20_6, 
   l_xmii022_14 LIKE type_t.num20_6, 
   l_xmii023_14 LIKE type_t.num20_6, 
   l_xmii022_15 LIKE type_t.num20_6, 
   l_xmii023_15 LIKE type_t.num20_6, 
   l_xmii022_16 LIKE type_t.num20_6, 
   l_xmii023_16 LIKE type_t.num20_6, 
   l_xmii022_17 LIKE type_t.num20_6, 
   l_xmii023_17 LIKE type_t.num20_6, 
   l_xmii022_18 LIKE type_t.num20_6, 
   l_xmii023_18 LIKE type_t.num20_6, 
   l_xmii022_19 LIKE type_t.num20_6, 
   l_xmii023_19 LIKE type_t.num20_6, 
   l_xmii022_20 LIKE type_t.num20_6, 
   l_xmii023_20 LIKE type_t.num20_6, 
   l_xmii022_21 LIKE type_t.num20_6, 
   l_xmii023_21 LIKE type_t.num20_6, 
   l_xmii022_22 LIKE type_t.num20_6, 
   l_xmii023_22 LIKE type_t.num20_6, 
   l_xmii022_23 LIKE type_t.num20_6, 
   l_xmii023_23 LIKE type_t.num20_6, 
   l_xmii022_24 LIKE type_t.num20_6, 
   l_xmii023_24 LIKE type_t.num20_6, 
   l_xmii022_s LIKE type_t.num20_6, 
   l_xmii023_s LIKE type_t.num20_6
       END RECORD
PRIVATE TYPE type_g_xmii3_d RECORD
       xmii005 LIKE xmii_t.xmii005, 
   xmii007 LIKE xmii_t.xmii007, 
   xmii007_3_desc LIKE type_t.chr500, 
   xmii006 LIKE xmii_t.xmii006, 
   xmii006_3_desc LIKE type_t.chr500, 
   xmii008 LIKE xmii_t.xmii008, 
   xmii008_3_desc LIKE type_t.chr500, 
   xmii012 LIKE xmii_t.xmii012, 
   xmii012_3_desc LIKE type_t.chr500, 
   xmii013 LIKE xmii_t.xmii013, 
   xmii013_3_desc LIKE type_t.chr500, 
   xmii011 LIKE xmii_t.xmii011, 
   xmii011_3_desc LIKE type_t.chr500, 
   xmii009 LIKE xmii_t.xmii009, 
   xmii009_3_desc LIKE type_t.chr500, 
   xmii009_3_desc_1 LIKE type_t.chr500, 
   xmii010 LIKE xmii_t.xmii010, 
   xmii017 LIKE xmii_t.xmii017, 
   xmii017_3_desc LIKE type_t.chr500, 
   xmii014 LIKE xmii_t.xmii014, 
   l_xmii018_3_01 LIKE type_t.num20_6, 
   l_xmii019_3_01 LIKE type_t.num20_6, 
   l_xmii018_3_02 LIKE type_t.num20_6, 
   l_xmii019_3_02 LIKE type_t.num20_6, 
   l_xmii018_3_03 LIKE type_t.num20_6, 
   l_xmii019_3_03 LIKE type_t.num20_6, 
   l_xmii018_3_04 LIKE type_t.num20_6, 
   l_xmii019_3_04 LIKE type_t.num20_6, 
   l_xmii018_3_05 LIKE type_t.num20_6, 
   l_xmii019_3_05 LIKE type_t.num20_6, 
   l_xmii018_3_06 LIKE type_t.num20_6, 
   l_xmii019_3_06 LIKE type_t.num20_6, 
   l_xmii018_3_07 LIKE type_t.num20_6, 
   l_xmii019_3_07 LIKE type_t.num20_6, 
   l_xmii018_3_08 LIKE type_t.num20_6, 
   l_xmii019_3_08 LIKE type_t.num20_6, 
   l_xmii018_3_09 LIKE type_t.num20_6, 
   l_xmii019_3_09 LIKE type_t.num20_6, 
   l_xmii018_3_10 LIKE type_t.num20_6, 
   l_xmii019_3_10 LIKE type_t.num20_6, 
   l_xmii018_3_11 LIKE type_t.num20_6, 
   l_xmii019_3_11 LIKE type_t.num20_6, 
   l_xmii018_3_12 LIKE type_t.num20_6, 
   l_xmii019_3_12 LIKE type_t.num20_6, 
   l_xmii018_3_13 LIKE type_t.num20_6, 
   l_xmii019_3_13 LIKE type_t.num20_6, 
   l_xmii018_3_14 LIKE type_t.num20_6, 
   l_xmii019_3_14 LIKE type_t.num20_6, 
   l_xmii018_3_15 LIKE type_t.num20_6, 
   l_xmii019_3_15 LIKE type_t.num20_6, 
   l_xmii018_3_16 LIKE type_t.num20_6, 
   l_xmii019_3_16 LIKE type_t.num20_6, 
   l_xmii018_3_17 LIKE type_t.num20_6, 
   l_xmii019_3_17 LIKE type_t.num20_6, 
   l_xmii018_3_18 LIKE type_t.num20_6, 
   l_xmii019_3_18 LIKE type_t.num20_6, 
   l_xmii018_3_19 LIKE type_t.num20_6, 
   l_xmii019_3_19 LIKE type_t.num20_6, 
   l_xmii018_3_20 LIKE type_t.num20_6, 
   l_xmii019_3_20 LIKE type_t.num20_6, 
   l_xmii018_3_21 LIKE type_t.num20_6, 
   l_xmii019_3_21 LIKE type_t.num20_6, 
   l_xmii018_3_22 LIKE type_t.num20_6, 
   l_xmii019_3_22 LIKE type_t.num20_6, 
   l_xmii018_3_23 LIKE type_t.num20_6, 
   l_xmii019_3_23 LIKE type_t.num20_6, 
   l_xmii018_3_24 LIKE type_t.num20_6, 
   l_xmii019_3_24 LIKE type_t.num20_6, 
   l_xmii018_3_s LIKE type_t.num20_6, 
   l_xmii019_3_s LIKE type_t.num20_6, 
   l_xmii022_3_01 LIKE type_t.num20_6, 
   l_xmii023_3_01 LIKE type_t.num20_6, 
   l_xmii022_3_02 LIKE type_t.num20_6, 
   l_xmii023_3_02 LIKE type_t.num20_6, 
   l_xmii022_3_03 LIKE type_t.num20_6, 
   l_xmii023_3_03 LIKE type_t.num20_6, 
   l_xmii022_3_04 LIKE type_t.num20_6, 
   l_xmii023_3_04 LIKE type_t.num20_6, 
   l_xmii022_3_05 LIKE type_t.num20_6, 
   l_xmii023_3_05 LIKE type_t.num20_6, 
   l_xmii022_3_06 LIKE type_t.num20_6, 
   l_xmii023_3_06 LIKE type_t.num20_6, 
   l_xmii022_3_07 LIKE type_t.num20_6, 
   l_xmii023_3_07 LIKE type_t.num20_6, 
   l_xmii022_3_08 LIKE type_t.num20_6, 
   l_xmii023_3_08 LIKE type_t.num20_6, 
   l_xmii022_3_09 LIKE type_t.num20_6, 
   l_xmii023_3_09 LIKE type_t.num20_6, 
   l_xmii022_3_10 LIKE type_t.num20_6, 
   l_xmii023_3_10 LIKE type_t.num20_6, 
   l_xmii022_3_11 LIKE type_t.num20_6, 
   l_xmii023_3_11 LIKE type_t.num20_6, 
   l_xmii022_3_12 LIKE type_t.num20_6, 
   l_xmii023_3_12 LIKE type_t.num20_6, 
   l_xmii022_3_13 LIKE type_t.num20_6, 
   l_xmii023_3_13 LIKE type_t.num20_6, 
   l_xmii022_3_14 LIKE type_t.num20_6, 
   l_xmii023_3_14 LIKE type_t.num20_6, 
   l_xmii022_3_15 LIKE type_t.num20_6, 
   l_xmii023_3_15 LIKE type_t.num20_6, 
   l_xmii022_3_16 LIKE type_t.num20_6, 
   l_xmii023_3_16 LIKE type_t.num20_6, 
   l_xmii022_3_17 LIKE type_t.num20_6, 
   l_xmii023_3_17 LIKE type_t.num20_6, 
   l_xmii022_3_18 LIKE type_t.num20_6, 
   l_xmii023_3_18 LIKE type_t.num20_6, 
   l_xmii022_3_19 LIKE type_t.num20_6, 
   l_xmii023_3_19 LIKE type_t.num20_6, 
   l_xmii022_3_20 LIKE type_t.num20_6, 
   l_xmii023_3_20 LIKE type_t.num20_6, 
   l_xmii022_3_21 LIKE type_t.num20_6, 
   l_xmii023_3_21 LIKE type_t.num20_6, 
   l_xmii022_3_22 LIKE type_t.num20_6, 
   l_xmii023_3_22 LIKE type_t.num20_6, 
   l_xmii022_3_23 LIKE type_t.num20_6, 
   l_xmii023_3_23 LIKE type_t.num20_6, 
   l_xmii022_3_24 LIKE type_t.num20_6, 
   l_xmii023_3_24 LIKE type_t.num20_6, 
   l_xmii022_3_s LIKE type_t.num20_6, 
   l_xmii023_3_s LIKE type_t.num20_6
       END RECORD
 
 
#模組變數(Module Variables)
DEFINE g_xmih_m          type_g_xmih_m
DEFINE g_xmih_m_t        type_g_xmih_m
DEFINE g_xmih_m_o        type_g_xmih_m
 
   DEFINE g_xmih001_t LIKE xmih_t.xmih001
DEFINE g_xmih004_t LIKE xmih_t.xmih004
DEFINE g_xmih002_t LIKE xmih_t.xmih002
DEFINE g_xmih003_t LIKE xmih_t.xmih003
 
 
DEFINE g_xmii_d          DYNAMIC ARRAY OF type_g_xmii_d
DEFINE g_xmii_d_t        type_g_xmii_d
DEFINE g_xmii_d_o        type_g_xmii_d
DEFINE g_xmii2_d   DYNAMIC ARRAY OF type_g_xmii2_d
DEFINE g_xmii2_d_t type_g_xmii2_d
DEFINE g_xmii2_d_o type_g_xmii2_d
DEFINE g_xmii3_d   DYNAMIC ARRAY OF type_g_xmii3_d
DEFINE g_xmii3_d_t type_g_xmii3_d
DEFINE g_xmii3_d_o type_g_xmii3_d
 
 
DEFINE g_browser    DYNAMIC ARRAY OF RECORD    #資料瀏覽之欄位 
         b_statepic     LIKE type_t.chr50,
            b_xmih001 LIKE xmih_t.xmih001,
   b_xmih001_desc LIKE type_t.chr80,
      b_xmih002 LIKE xmih_t.xmih002,
      b_xmih003 LIKE xmih_t.xmih003,
      b_xmih004 LIKE xmih_t.xmih004,
   b_xmih004_desc LIKE type_t.chr80
      END RECORD 
      
DEFINE g_browser_f  RECORD    #資料瀏覽之欄位 
         b_statepic     LIKE type_t.chr50,
            b_xmih001 LIKE xmih_t.xmih001,
   b_xmih001_desc LIKE type_t.chr80,
      b_xmih002 LIKE xmih_t.xmih002,
      b_xmih003 LIKE xmih_t.xmih003,
      b_xmih004 LIKE xmih_t.xmih004,
   b_xmih004_desc LIKE type_t.chr80
      END RECORD 
      
 
DEFINE g_wc                  STRING
DEFINE g_wc_t                STRING
DEFINE g_wc2                 STRING                          #單身CONSTRUCT結果
DEFINE g_wc2_table1          STRING
 
 
DEFINE g_wc_filter           STRING
DEFINE g_wc_filter_t         STRING
 
DEFINE g_sql                 STRING
DEFINE g_forupd_sql          STRING
DEFINE g_cnt                 LIKE type_t.num10
DEFINE g_current_idx         LIKE type_t.num10     
DEFINE g_jump                LIKE type_t.num10        
DEFINE g_no_ask              LIKE type_t.num5        
DEFINE g_rec_b               LIKE type_t.num5           
DEFINE l_ac                  LIKE type_t.num5    
DEFINE g_curr_diag           ui.Dialog                     #Current Dialog
    
DEFINE g_pagestart           LIKE type_t.num5           
DEFINE gwin_curr             ui.Window                     #Current Window
DEFINE gfrm_curr             ui.Form                       #Current Form
DEFINE g_page_action         STRING                        #page action
DEFINE g_header_hidden       LIKE type_t.num5              #隱藏單頭
DEFINE g_worksheet_hidden    LIKE type_t.num5              #隱藏工作Panel
DEFINE g_page                STRING                        #第幾頁
DEFINE g_state               STRING       
 
DEFINE g_detail_cnt          LIKE type_t.num5              #單身總筆數
DEFINE g_detail_idx          LIKE type_t.num5              #單身目前所在筆數
DEFINE g_detail_idx2         LIKE type_t.num5              #單身2目前所在筆數
DEFINE g_browser_cnt         LIKE type_t.num5              #Browser總筆數
DEFINE g_browser_idx         LIKE type_t.num5              #Browser目前所在筆數
DEFINE g_temp_idx            LIKE type_t.num5              #Browser目前所在筆數(暫存用)
 
DEFINE g_searchcol           STRING                        #查詢欄位代碼
DEFINE g_searchstr           STRING                        #查詢欄位字串
DEFINE g_order               STRING                        #查詢排序欄位
                                                        
DEFINE g_current_row         LIKE type_t.num5              #Browser所在筆數
DEFINE g_current_sw          BOOLEAN                       #Browser所在筆數用開關
DEFINE g_current_page        LIKE type_t.num5              #目前所在頁數
DEFINE g_insert              LIKE type_t.chr5              #是否導到其他page
 
DEFINE g_ref_fields          DYNAMIC ARRAY OF VARCHAR(500) #ap_ref用陣列
DEFINE g_ref_vars            DYNAMIC ARRAY OF VARCHAR(500) #ap_ref用陣列
DEFINE g_rtn_fields          DYNAMIC ARRAY OF VARCHAR(500) #ap_ref用陣列
DEFINE gs_keys               DYNAMIC ARRAY OF VARCHAR(500) #同步資料用陣列
DEFINE gs_keys_bak           DYNAMIC ARRAY OF VARCHAR(500) #同步資料用陣列
DEFINE g_bfill               LIKE type_t.chr5              #是否刷新單身
DEFINE g_error_show          LIKE type_t.num5              #
 
DEFINE g_wc_frozen           STRING                        #凍結欄位使用
DEFINE g_chk                 BOOLEAN                       #助記碼判斷用
DEFINE g_aw                  STRING                        #確定當下點擊的單身
DEFINE g_default             BOOLEAN                       #是否有外部參數查詢
DEFINE g_log1                STRING                        #log用
DEFINE g_log2                STRING                        #log用
DEFINE g_loc                 LIKE type_t.chr5              #判斷游標所在位置
 
#add-point:自定義模組變數(Module Variable)
{<point name="global.variable"/>}
#end add-point
 
#add-point:傳入參數說明(global.argv)
{<point name="global.argv"/>}
#end add-point
]]>
  </section>
  <section id="axmt175.idx_chk" ver="2" status="" src="s">
    <![CDATA[#+ 單身筆數變更
PRIVATE FUNCTION axmt175_idx_chk()
   #add-point:idx_chk段define
   {<point name="idx_chk.define"/>}
   #end add-point  
   
   IF g_current_page = 1 THEN
      LET g_detail_idx = g_curr_diag.getCurrentRow("s_detail1")
      IF g_detail_idx > g_xmii_d.getLength() THEN
         LET g_detail_idx = g_xmii_d.getLength()
      END IF
      IF g_detail_idx = 0 AND g_xmii_d.getLength() <> 0 THEN
         LET g_detail_idx = 1
      END IF
      DISPLAY g_detail_idx TO FORMONLY.idx
      DISPLAY g_xmii_d.getLength() TO FORMONLY.cnt
   END IF
   
   IF g_current_page = 2 THEN
      LET g_detail_idx = g_curr_diag.getCurrentRow("s_detail2")
      IF g_detail_idx > g_xmii2_d.getLength() THEN
         LET g_detail_idx = g_xmii2_d.getLength()
      END IF
      IF g_detail_idx = 0 AND g_xmii2_d.getLength() <> 0 THEN
         LET g_detail_idx = 1
      END IF
      DISPLAY g_detail_idx TO FORMONLY.idx
      DISPLAY g_xmii2_d.getLength() TO FORMONLY.cnt
   END IF
   IF g_current_page = 3 THEN
      LET g_detail_idx = g_curr_diag.getCurrentRow("s_detail3")
      IF g_detail_idx > g_xmii3_d.getLength() THEN
         LET g_detail_idx = g_xmii3_d.getLength()
      END IF
      IF g_detail_idx = 0 AND g_xmii3_d.getLength() <> 0 THEN
         LET g_detail_idx = 1
      END IF
      DISPLAY g_detail_idx TO FORMONLY.idx
      DISPLAY g_xmii3_d.getLength() TO FORMONLY.cnt
   END IF
 
   
   #add-point:idx_chk段other
   {<point name="idx_chk.other"/>}
   #end add-point  
   
END FUNCTION
]]>
  </section>
  <section id="axmt175.init" ver="9" status="" src="s">
    <![CDATA[#+ 瀏覽頁簽資料初始化
PRIVATE FUNCTION axmt175_init()
   #add-point:init段define
   {<point name="init.define"/>}
   #end add-point    
   
   LET g_bfill       = "Y"
   LET g_detail_idx  = 1
   LET g_detail_idx2 = 1
   LET g_error_show  = 1
   LET l_ac = 1
      CALL cl_set_combo_scc_part('xmih005_stus','','')
   CALL cl_set_combo_scc_part('xmihstus','13','N,Y,C')
 
   
   LET gwin_curr = ui.Window.getCurrent()  #取得現行畫面
   LET gfrm_curr = gwin_curr.getForm()     #取出物件化後的畫面物件
 
   #add-point:畫面資料初始化
   {<point name="init.init"/>}
   #end add-point
   
   CALL axmt175_default_search()
    
END FUNCTION
]]>
  </section>
  <section id="axmt175.input" ver="16" status="" src="s">
    <![CDATA[#+ 資料輸入
PRIVATE FUNCTION axmt175_input(p_cmd)
   DEFINE  p_cmd                 LIKE type_t.chr1
   DEFINE  l_cmd_t               LIKE type_t.chr1
   DEFINE  l_cmd                 LIKE type_t.chr1
   DEFINE  l_n                   LIKE type_t.num5                #檢查重複用  
   DEFINE  l_cnt                 LIKE type_t.num5                #檢查重複用  
   DEFINE  l_lock_sw             LIKE type_t.chr1                #單身鎖住否  
   DEFINE  l_allow_insert        LIKE type_t.num5                #可新增否 
   DEFINE  l_allow_delete        LIKE type_t.num5                #可刪除否  
   DEFINE  l_count               LIKE type_t.num5
   DEFINE  l_i                   LIKE type_t.num5
   DEFINE  l_insert              BOOLEAN
   DEFINE  ls_return             STRING
   DEFINE  l_var_keys            DYNAMIC ARRAY OF STRING
   DEFINE  l_field_keys          DYNAMIC ARRAY OF STRING
   DEFINE  l_vars                DYNAMIC ARRAY OF STRING
   DEFINE  l_fields              DYNAMIC ARRAY OF STRING
   DEFINE  l_var_keys_bak        DYNAMIC ARRAY OF STRING
   DEFINE  lb_reproduce          BOOLEAN
   DEFINE  li_reproduce          LIKE type_t.num5
   DEFINE  li_reproduce_target   LIKE type_t.num5
   #add-point:input段define
   {<point name="input.define"/>}
   #end add-point  
 
   #先做狀態判定
   IF p_cmd = 'r' THEN
      LET l_cmd_t = 'r'
      LET p_cmd   = 'a'
   ELSE
      LET l_cmd_t = p_cmd
   END IF   
   
   #切換畫面
   IF g_main_hidden THEN
      CALL gfrm_curr.setElementHidden("mainlayout",0)
      CALL gfrm_curr.setElementHidden("worksheet",1)
      LET g_main_hidden = 0
   END IF
 
   CALL cl_set_head_visible("","YES")  
 
   LET l_insert = FALSE
   LET g_action_choice = ""
 
   #add-point:input段define_sql
   {<point name="input.define_sql" mark="Y"/>}
   #end add-point 
   LET g_forupd_sql = "SELECT xmii005,xmii007,xmii006,xmii008,xmii012,xmii013,xmii011,xmii009,xmii010, 
       xmii017,xmii014,xmii005,xmii007,xmii006,xmii008,xmii012,xmii013,xmii011,xmii009,xmii010,xmii017, 
       xmii014,xmii005,xmii007,xmii006,xmii008,xmii012,xmii013,xmii011,xmii009,xmii010,xmii017,xmii014  
       FROM xmii_t WHERE xmiient=? AND xmii001=? AND xmii002=? AND xmii003=? AND xmii004=? AND xmii006=?  
       AND xmii007=? AND xmii008=? AND xmii009=? AND xmii010=? AND xmii011=? AND xmii012=? AND xmii013=?  
       AND xmii014=? AND xmii017=? FOR UPDATE"
   #add-point:input段define_sql
   {<point name="input.after_define_sql"/>}
   #end add-point 
   LET g_forupd_sql = cl_sql_forupd(g_forupd_sql)
   LET g_forupd_sql = cl_sql_add_mask(g_forupd_sql)              #遮蔽特定資料
   DECLARE axmt175_bcl CURSOR FROM g_forupd_sql
   
 
   
 
 
   #add-point:input段define_sql
   {<point name="input.other_sql"/>}
   #end add-point 
 
   LET l_allow_insert = cl_auth_detail_input("insert")
   LET l_allow_delete = cl_auth_detail_input("delete")
   LET g_qryparam.state = 'i'
   
   #控制key欄位可否輸入
   CALL axmt175_set_entry(p_cmd)
   #add-point:set_entry後
   {<point name="input.after_set_entry"/>}
   #end add-point
   CALL axmt175_set_no_entry(p_cmd)
 
   DISPLAY BY NAME g_xmih_m.xmih001,g_xmih_m.xmih004,g_xmih_m.ooai001,g_xmih_m.xmih002,g_xmih_m.xmih005, 
       g_xmih_m.xmih003,g_xmih_m.xmih005_stus,g_xmih_m.xmihstus
   
   LET lb_reproduce = FALSE
   
   #add-point:資料輸入前
   {<point name="input.before_input"/>}
   #end add-point
   
   DIALOG ATTRIBUTES(UNBUFFERED,FIELD ORDER FORM)
   
]]>
  </section>
  <section id="axmt175.input.body" ver="24" status="" src="s">
    <![CDATA[   
      #Page1 預設值產生於此處
      INPUT ARRAY g_xmii_d FROM s_detail1.*
          ATTRIBUTE(COUNT = g_rec_b,MAXCOUNT = g_max_rec,WITHOUT DEFAULTS, 
                  INSERT ROW = FALSE, 
                  DELETE ROW = FALSE,
                  APPEND ROW = FALSE)
 
         #自訂ACTION(detail_input,page_1)
         
         
         BEFORE INPUT
            IF g_insert = 'Y' AND NOT cl_null(g_insert) THEN 
              CALL FGL_SET_ARR_CURR(g_xmii_d.getLength()+1) 
              LET g_insert = 'N' 
           END IF 
 
            CALL axmt175_b_fill()
            LET g_rec_b = g_xmii_d.getLength()
            #add-point:資料輸入前
            {<point name="input.d.before_input"/>}
            #end add-point
         
         BEFORE ROW
            #add-point:modify段before row2
            {<point name="input.body.before_row2"/>}
            #end add-point  
            LET l_insert = FALSE
            LET l_cmd = ''
            LET l_ac = ARR_CURR()
            LET g_detail_idx = l_ac
            
            LET l_lock_sw = 'N'            #DEFAULT
            LET l_n = ARR_COUNT()
            DISPLAY l_ac TO FORMONLY.idx
         
            CALL s_transaction_begin()
            OPEN axmt175_cl USING g_enterprise,g_xmih_m.xmih001,g_xmih_m.xmih002,g_xmih_m.xmih003,g_xmih_m.xmih004
            IF STATUS THEN
               CALL cl_err("OPEN axmt175_cl:", STATUS, 1)
               CLOSE axmt175_cl
               CALL s_transaction_end('N','0')
               RETURN
            END IF
            
            LET g_rec_b = g_xmii_d.getLength()
            
            IF g_rec_b >= l_ac 
               AND g_xmii_d[l_ac].xmii006 IS NOT NULL
               AND g_xmii_d[l_ac].xmii007 IS NOT NULL
               AND g_xmii_d[l_ac].xmii008 IS NOT NULL
               AND g_xmii_d[l_ac].xmii009 IS NOT NULL
               AND g_xmii_d[l_ac].xmii010 IS NOT NULL
               AND g_xmii_d[l_ac].xmii011 IS NOT NULL
               AND g_xmii_d[l_ac].xmii012 IS NOT NULL
               AND g_xmii_d[l_ac].xmii013 IS NOT NULL
               AND g_xmii_d[l_ac].xmii014 IS NOT NULL
               AND g_xmii_d[l_ac].xmii017 IS NOT NULL
 
            THEN
               LET l_cmd='u'
               LET g_xmii_d_t.* = g_xmii_d[l_ac].*  #BACKUP
               LET g_xmii_d_o.* = g_xmii_d[l_ac].*  #BACKUP
               CALL axmt175_set_entry_b(l_cmd)
               #add-point:modify段after_set_entry_b
               {<point name="input.body.after_set_entry_b"/>}
               #end add-point  
               CALL axmt175_set_no_entry_b(l_cmd)
               IF NOT axmt175_lock_b("xmii_t","'1'") THEN
                  LET l_lock_sw='Y'
               ELSE
                  FETCH axmt175_bcl INTO g_xmii_d[l_ac].xmii005,g_xmii_d[l_ac].xmii007,g_xmii_d[l_ac].xmii006, 
                      g_xmii_d[l_ac].xmii008,g_xmii_d[l_ac].xmii012,g_xmii_d[l_ac].xmii013,g_xmii_d[l_ac].xmii011, 
                      g_xmii_d[l_ac].xmii009,g_xmii_d[l_ac].xmii010,g_xmii_d[l_ac].xmii017,g_xmii_d[l_ac].xmii014, 
                      g_xmii2_d[l_ac].xmii005,g_xmii2_d[l_ac].xmii007,g_xmii2_d[l_ac].xmii006,g_xmii2_d[l_ac].xmii008, 
                      g_xmii2_d[l_ac].xmii012,g_xmii2_d[l_ac].xmii013,g_xmii2_d[l_ac].xmii011,g_xmii2_d[l_ac].xmii009, 
                      g_xmii2_d[l_ac].xmii010,g_xmii2_d[l_ac].xmii017,g_xmii2_d[l_ac].xmii014,g_xmii3_d[l_ac].xmii005, 
                      g_xmii3_d[l_ac].xmii007,g_xmii3_d[l_ac].xmii006,g_xmii3_d[l_ac].xmii008,g_xmii3_d[l_ac].xmii012, 
                      g_xmii3_d[l_ac].xmii013,g_xmii3_d[l_ac].xmii011,g_xmii3_d[l_ac].xmii009,g_xmii3_d[l_ac].xmii010, 
                      g_xmii3_d[l_ac].xmii017,g_xmii3_d[l_ac].xmii014
                  IF SQLCA.sqlcode THEN
                     CALL cl_err(g_xmii_d_t.xmii006,SQLCA.sqlcode,1)
                     LET l_lock_sw = "Y"
                  END IF
                  
                  LET g_bfill = "N"
                  CALL axmt175_show()
                  LET g_bfill = "Y"
                  
                  CALL cl_show_fld_cont()
               END IF
            ELSE
               LET l_cmd='a'
            END IF
            #add-point:modify段before row
            {<point name="input.body.before_row"/>}
            #end add-point  
            #其他table資料備份(確定是否更改用)
            
            #其他table進行lock
            
        
         BEFORE INSERT
            
            LET l_insert = TRUE
            LET l_n = ARR_COUNT()
            LET l_cmd = 'a'
            INITIALIZE g_xmii_d[l_ac].* TO NULL 
            INITIALIZE g_xmii_d_t.* TO NULL 
            INITIALIZE g_xmii_d_o.* TO NULL 
            
            LET g_xmii_d_t.* = g_xmii_d[l_ac].*     #新輸入資料
            LET g_xmii_d_o.* = g_xmii_d[l_ac].*     #新輸入資料
            CALL cl_show_fld_cont()
            CALL axmt175_set_entry_b(l_cmd)
            #add-point:modify段after_set_entry_b
            {<point name="input.body.insert.after_set_entry_b"/>}
            #end add-point
            CALL axmt175_set_no_entry_b(l_cmd)
            IF lb_reproduce THEN
               LET lb_reproduce = FALSE
               LET g_xmii_d[li_reproduce_target].* = g_xmii_d[li_reproduce].*
               LET g_xmii2_d[li_reproduce_target].* = g_xmii2_d[li_reproduce].*
               LET g_xmii3_d[li_reproduce_target].* = g_xmii3_d[li_reproduce].*
 
               LET g_xmii_d[li_reproduce_target].xmii006 = NULL
               LET g_xmii_d[li_reproduce_target].xmii007 = NULL
               LET g_xmii_d[li_reproduce_target].xmii008 = NULL
               LET g_xmii_d[li_reproduce_target].xmii009 = NULL
               LET g_xmii_d[li_reproduce_target].xmii010 = NULL
               LET g_xmii_d[li_reproduce_target].xmii011 = NULL
               LET g_xmii_d[li_reproduce_target].xmii012 = NULL
               LET g_xmii_d[li_reproduce_target].xmii013 = NULL
               LET g_xmii_d[li_reproduce_target].xmii014 = NULL
               LET g_xmii_d[li_reproduce_target].xmii017 = NULL
 
            END IF
            #公用欄位給值(單身)
            
            
            #add-point:modify段before insert
            {<point name="input.body.before_insert"/>}
            #end add-point  
  
         AFTER INSERT
            LET l_insert = FALSE
            IF INT_FLAG THEN
               CALL cl_err('',9001,0)
               LET INT_FLAG = 0
               CANCEL INSERT
            END IF
               
            #add-point:單身新增
            {<point name="input.body.b_a_insert"/>}
            #end add-point
               
            LET l_count = 1  
            SELECT COUNT(*) INTO l_count FROM xmii_t 
             WHERE xmiient = g_enterprise AND xmii001 = g_xmih_m.xmih001
               AND xmii002 = g_xmih_m.xmih002
               AND xmii003 = g_xmih_m.xmih003
               AND xmii004 = g_xmih_m.xmih004
 
               AND xmii006 = g_xmii_d[l_ac].xmii006
               AND xmii007 = g_xmii_d[l_ac].xmii007
               AND xmii008 = g_xmii_d[l_ac].xmii008
               AND xmii009 = g_xmii_d[l_ac].xmii009
               AND xmii010 = g_xmii_d[l_ac].xmii010
               AND xmii011 = g_xmii_d[l_ac].xmii011
               AND xmii012 = g_xmii_d[l_ac].xmii012
               AND xmii013 = g_xmii_d[l_ac].xmii013
               AND xmii014 = g_xmii_d[l_ac].xmii014
               AND xmii017 = g_xmii_d[l_ac].xmii017
 
                
            #資料未重複, 插入新增資料
            IF l_count = 0 THEN 
               #add-point:單身新增前
               {<point name="input.body.b_insert"/>}
               #end add-point
            
               #同步新增到同層的table
                              INITIALIZE gs_keys TO NULL 
               LET gs_keys[1] = g_xmih_m.xmih001
               LET gs_keys[2] = g_xmih_m.xmih002
               LET gs_keys[3] = g_xmih_m.xmih003
               LET gs_keys[4] = g_xmih_m.xmih004
               LET gs_keys[5] = g_xmii_d[g_detail_idx].xmii006
               LET gs_keys[6] = g_xmii_d[g_detail_idx].xmii007
               LET gs_keys[7] = g_xmii_d[g_detail_idx].xmii008
               LET gs_keys[8] = g_xmii_d[g_detail_idx].xmii009
               LET gs_keys[9] = g_xmii_d[g_detail_idx].xmii010
               LET gs_keys[10] = g_xmii_d[g_detail_idx].xmii011
               LET gs_keys[11] = g_xmii_d[g_detail_idx].xmii012
               LET gs_keys[12] = g_xmii_d[g_detail_idx].xmii013
               LET gs_keys[13] = g_xmii_d[g_detail_idx].xmii014
               LET gs_keys[14] = g_xmii_d[g_detail_idx].xmii017
               CALL axmt175_insert_b('xmii_t',gs_keys,"'1'")
                           
               #add-point:單身新增後
               {<point name="input.body.a_insert"/>}
               #end add-point
            ELSE    
               CALL cl_err('INSERT',"std-00006",1)
               INITIALIZE g_xmii_d[l_ac].* TO NULL
               CALL s_transaction_end('N','0')
               CANCEL INSERT
            END IF
 
            IF SQLCA.SQLcode  THEN
               CALL cl_err("xmii_t",SQLCA.sqlcode,1)  
               CALL s_transaction_end('N','0')                    
               CANCEL INSERT
            ELSE
               #先刷新資料
               #CALL axmt175_b_fill()
               #資料多語言用-增/改
               
               #add-point:input段-after_insert
               {<point name="input.body.a_insert2"/>}
               #end add-point
               CALL s_transaction_end('Y','0')
               ERROR 'INSERT O.K'
               LET g_rec_b = g_rec_b + 1
            END IF
              
         BEFORE DELETE                            #是否取消單身
            IF l_cmd = 'a' AND g_xmii_d.getLength() < l_ac THEN
               CALL FGL_SET_ARR_CURR(l_ac-1)
               CALL g_xmii_d.deleteElement(l_ac)
               NEXT FIELD xmii006
            END IF
         
            IF g_xmii_d[l_ac].xmii006 IS NOT NULL
               AND g_xmii_d_t.xmii007 IS NOT NULL
               AND g_xmii_d_t.xmii008 IS NOT NULL
               AND g_xmii_d_t.xmii009 IS NOT NULL
               AND g_xmii_d_t.xmii010 IS NOT NULL
               AND g_xmii_d_t.xmii011 IS NOT NULL
               AND g_xmii_d_t.xmii012 IS NOT NULL
               AND g_xmii_d_t.xmii013 IS NOT NULL
               AND g_xmii_d_t.xmii014 IS NOT NULL
               AND g_xmii_d_t.xmii017 IS NOT NULL
 
               THEN 
               
               IF NOT cl_ask_del_detail() THEN
                  CANCEL DELETE
               END IF
               IF l_lock_sw = "Y" THEN
                  CALL cl_err("", -263, 1)
                  CANCEL DELETE
               END IF
               
               #add-point:單身刪除前
               {<point name="input.body.b_delete" mark="Y"/>}
               #end add-point 
               
               DELETE FROM xmii_t
                WHERE xmiient = g_enterprise AND xmii001 = g_xmih_m.xmih001 AND
                                          xmii002 = g_xmih_m.xmih002 AND
                                          xmii003 = g_xmih_m.xmih003 AND
                                          xmii004 = g_xmih_m.xmih004 AND
 
                      xmii006 = g_xmii_d_t.xmii006
                  AND xmii007 = g_xmii_d_t.xmii007
                  AND xmii008 = g_xmii_d_t.xmii008
                  AND xmii009 = g_xmii_d_t.xmii009
                  AND xmii010 = g_xmii_d_t.xmii010
                  AND xmii011 = g_xmii_d_t.xmii011
                  AND xmii012 = g_xmii_d_t.xmii012
                  AND xmii013 = g_xmii_d_t.xmii013
                  AND xmii014 = g_xmii_d_t.xmii014
                  AND xmii017 = g_xmii_d_t.xmii017
 
                  
               #add-point:單身刪除中
               {<point name="input.body.m_delete"/>}
               #end add-point 
               
               IF SQLCA.sqlcode THEN
                  CALL cl_err("xmii_t",SQLCA.sqlcode,1)
                  CALL s_transaction_end('N','0')
                  CANCEL DELETE   
               ELSE
                  LET g_rec_b = g_rec_b-1
                  
                  #add-point:單身刪除後
                  {<point name="input.body.a_delete"/>}
                  #end add-point
                  CALL s_transaction_end('Y','0')
               END IF 
               CLOSE axmt175_bcl
               LET l_count = g_xmii_d.getLength()
            END IF 
            
                           INITIALIZE gs_keys TO NULL 
               LET gs_keys[1] = g_xmih_m.xmih001
               LET gs_keys[2] = g_xmih_m.xmih002
               LET gs_keys[3] = g_xmih_m.xmih003
               LET gs_keys[4] = g_xmih_m.xmih004
               LET gs_keys[5] = g_xmii_d[g_detail_idx].xmii006
               LET gs_keys[6] = g_xmii_d[g_detail_idx].xmii007
               LET gs_keys[7] = g_xmii_d[g_detail_idx].xmii008
               LET gs_keys[8] = g_xmii_d[g_detail_idx].xmii009
               LET gs_keys[9] = g_xmii_d[g_detail_idx].xmii010
               LET gs_keys[10] = g_xmii_d[g_detail_idx].xmii011
               LET gs_keys[11] = g_xmii_d[g_detail_idx].xmii012
               LET gs_keys[12] = g_xmii_d[g_detail_idx].xmii013
               LET gs_keys[13] = g_xmii_d[g_detail_idx].xmii014
               LET gs_keys[14] = g_xmii_d[g_detail_idx].xmii017
 
              
         AFTER DELETE 
            #add-point:單身刪除後2
            {<point name="input.body.after_delete"/>}
            #end add-point
                           CALL axmt175_delete_b('xmii_t',gs_keys,"'1'")
 
                  #此段落由子樣板a01產生
         BEFORE FIELD xmii005
            #add-point:BEFORE FIELD xmii005
            {<point name="input.b.page1.xmii005" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmii005
            
            #add-point:AFTER FIELD xmii005
            {<point name="input.a.page1.xmii005" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE xmii005
            #add-point:ON CHANGE xmii005
            {<point name="input.g.page1.xmii005" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmii007
            
            #add-point:AFTER FIELD xmii007
            {<point name="input.a.page1.xmii007" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmii007
            #add-point:BEFORE FIELD xmii007
            {<point name="input.b.page1.xmii007" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE xmii007
            #add-point:ON CHANGE xmii007
            {<point name="input.g.page1.xmii007" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmii006
            
            #add-point:AFTER FIELD xmii006
            {<point name="input.a.page1.xmii006" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmii006
            #add-point:BEFORE FIELD xmii006
            {<point name="input.b.page1.xmii006" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE xmii006
            #add-point:ON CHANGE xmii006
            {<point name="input.g.page1.xmii006" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmii008
            
            #add-point:AFTER FIELD xmii008
            {<point name="input.a.page1.xmii008" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmii008
            #add-point:BEFORE FIELD xmii008
            {<point name="input.b.page1.xmii008" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE xmii008
            #add-point:ON CHANGE xmii008
            {<point name="input.g.page1.xmii008" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmii012
            
            #add-point:AFTER FIELD xmii012
            {<point name="input.a.page1.xmii012" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmii012
            #add-point:BEFORE FIELD xmii012
            {<point name="input.b.page1.xmii012" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE xmii012
            #add-point:ON CHANGE xmii012
            {<point name="input.g.page1.xmii012" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmii013
            
            #add-point:AFTER FIELD xmii013
            {<point name="input.a.page1.xmii013" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmii013
            #add-point:BEFORE FIELD xmii013
            {<point name="input.b.page1.xmii013" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE xmii013
            #add-point:ON CHANGE xmii013
            {<point name="input.g.page1.xmii013" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmii011
            
            #add-point:AFTER FIELD xmii011
            {<point name="input.a.page1.xmii011" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmii011
            #add-point:BEFORE FIELD xmii011
            {<point name="input.b.page1.xmii011" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE xmii011
            #add-point:ON CHANGE xmii011
            {<point name="input.g.page1.xmii011" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmii009
            
            #add-point:AFTER FIELD xmii009
            {<point name="input.a.page1.xmii009" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmii009
            #add-point:BEFORE FIELD xmii009
            {<point name="input.b.page1.xmii009" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE xmii009
            #add-point:ON CHANGE xmii009
            {<point name="input.g.page1.xmii009" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmii010
            #add-point:BEFORE FIELD xmii010
            {<point name="input.b.page1.xmii010" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmii010
            
            #add-point:AFTER FIELD xmii010
            {<point name="input.a.page1.xmii010" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE xmii010
            #add-point:ON CHANGE xmii010
            {<point name="input.g.page1.xmii010" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmii017
            
            #add-point:AFTER FIELD xmii017
            {<point name="input.a.page1.xmii017" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmii017
            #add-point:BEFORE FIELD xmii017
            {<point name="input.b.page1.xmii017" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE xmii017
            #add-point:ON CHANGE xmii017
            {<point name="input.g.page1.xmii017" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmii014
            #add-point:BEFORE FIELD xmii014
            {<point name="input.b.page1.xmii014" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmii014
            
            #add-point:AFTER FIELD xmii014
            {<point name="input.a.page1.xmii014" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE xmii014
            #add-point:ON CHANGE xmii014
            {<point name="input.g.page1.xmii014" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii018_01
            #add-point:BEFORE FIELD l_xmii018_01
            {<point name="input.b.page1.l_xmii018_01" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii018_01
            
            #add-point:AFTER FIELD l_xmii018_01
            {<point name="input.a.page1.l_xmii018_01" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii018_01
            #add-point:ON CHANGE l_xmii018_01
            {<point name="input.g.page1.l_xmii018_01" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii019_01
            #add-point:BEFORE FIELD l_xmii019_01
            {<point name="input.b.page1.l_xmii019_01" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii019_01
            
            #add-point:AFTER FIELD l_xmii019_01
            {<point name="input.a.page1.l_xmii019_01" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii019_01
            #add-point:ON CHANGE l_xmii019_01
            {<point name="input.g.page1.l_xmii019_01" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii018_02
            #add-point:BEFORE FIELD l_xmii018_02
            {<point name="input.b.page1.l_xmii018_02" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii018_02
            
            #add-point:AFTER FIELD l_xmii018_02
            {<point name="input.a.page1.l_xmii018_02" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii018_02
            #add-point:ON CHANGE l_xmii018_02
            {<point name="input.g.page1.l_xmii018_02" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii019_02
            #add-point:BEFORE FIELD l_xmii019_02
            {<point name="input.b.page1.l_xmii019_02" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii019_02
            
            #add-point:AFTER FIELD l_xmii019_02
            {<point name="input.a.page1.l_xmii019_02" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii019_02
            #add-point:ON CHANGE l_xmii019_02
            {<point name="input.g.page1.l_xmii019_02" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii018_03
            #add-point:BEFORE FIELD l_xmii018_03
            {<point name="input.b.page1.l_xmii018_03" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii018_03
            
            #add-point:AFTER FIELD l_xmii018_03
            {<point name="input.a.page1.l_xmii018_03" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii018_03
            #add-point:ON CHANGE l_xmii018_03
            {<point name="input.g.page1.l_xmii018_03" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii019_03
            #add-point:BEFORE FIELD l_xmii019_03
            {<point name="input.b.page1.l_xmii019_03" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii019_03
            
            #add-point:AFTER FIELD l_xmii019_03
            {<point name="input.a.page1.l_xmii019_03" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii019_03
            #add-point:ON CHANGE l_xmii019_03
            {<point name="input.g.page1.l_xmii019_03" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii018_04
            #add-point:BEFORE FIELD l_xmii018_04
            {<point name="input.b.page1.l_xmii018_04" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii018_04
            
            #add-point:AFTER FIELD l_xmii018_04
            {<point name="input.a.page1.l_xmii018_04" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii018_04
            #add-point:ON CHANGE l_xmii018_04
            {<point name="input.g.page1.l_xmii018_04" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii019_04
            #add-point:BEFORE FIELD l_xmii019_04
            {<point name="input.b.page1.l_xmii019_04" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii019_04
            
            #add-point:AFTER FIELD l_xmii019_04
            {<point name="input.a.page1.l_xmii019_04" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii019_04
            #add-point:ON CHANGE l_xmii019_04
            {<point name="input.g.page1.l_xmii019_04" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii018_05
            #add-point:BEFORE FIELD l_xmii018_05
            {<point name="input.b.page1.l_xmii018_05" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii018_05
            
            #add-point:AFTER FIELD l_xmii018_05
            {<point name="input.a.page1.l_xmii018_05" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii018_05
            #add-point:ON CHANGE l_xmii018_05
            {<point name="input.g.page1.l_xmii018_05" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii019_05
            #add-point:BEFORE FIELD l_xmii019_05
            {<point name="input.b.page1.l_xmii019_05" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii019_05
            
            #add-point:AFTER FIELD l_xmii019_05
            {<point name="input.a.page1.l_xmii019_05" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii019_05
            #add-point:ON CHANGE l_xmii019_05
            {<point name="input.g.page1.l_xmii019_05" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii018_06
            #add-point:BEFORE FIELD l_xmii018_06
            {<point name="input.b.page1.l_xmii018_06" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii018_06
            
            #add-point:AFTER FIELD l_xmii018_06
            {<point name="input.a.page1.l_xmii018_06" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii018_06
            #add-point:ON CHANGE l_xmii018_06
            {<point name="input.g.page1.l_xmii018_06" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii019_06
            #add-point:BEFORE FIELD l_xmii019_06
            {<point name="input.b.page1.l_xmii019_06" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii019_06
            
            #add-point:AFTER FIELD l_xmii019_06
            {<point name="input.a.page1.l_xmii019_06" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii019_06
            #add-point:ON CHANGE l_xmii019_06
            {<point name="input.g.page1.l_xmii019_06" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii018_07
            #add-point:BEFORE FIELD l_xmii018_07
            {<point name="input.b.page1.l_xmii018_07" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii018_07
            
            #add-point:AFTER FIELD l_xmii018_07
            {<point name="input.a.page1.l_xmii018_07" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii018_07
            #add-point:ON CHANGE l_xmii018_07
            {<point name="input.g.page1.l_xmii018_07" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii019_07
            #add-point:BEFORE FIELD l_xmii019_07
            {<point name="input.b.page1.l_xmii019_07" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii019_07
            
            #add-point:AFTER FIELD l_xmii019_07
            {<point name="input.a.page1.l_xmii019_07" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii019_07
            #add-point:ON CHANGE l_xmii019_07
            {<point name="input.g.page1.l_xmii019_07" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii018_08
            #add-point:BEFORE FIELD l_xmii018_08
            {<point name="input.b.page1.l_xmii018_08" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii018_08
            
            #add-point:AFTER FIELD l_xmii018_08
            {<point name="input.a.page1.l_xmii018_08" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii018_08
            #add-point:ON CHANGE l_xmii018_08
            {<point name="input.g.page1.l_xmii018_08" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii019_08
            #add-point:BEFORE FIELD l_xmii019_08
            {<point name="input.b.page1.l_xmii019_08" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii019_08
            
            #add-point:AFTER FIELD l_xmii019_08
            {<point name="input.a.page1.l_xmii019_08" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii019_08
            #add-point:ON CHANGE l_xmii019_08
            {<point name="input.g.page1.l_xmii019_08" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii018_09
            #add-point:BEFORE FIELD l_xmii018_09
            {<point name="input.b.page1.l_xmii018_09" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii018_09
            
            #add-point:AFTER FIELD l_xmii018_09
            {<point name="input.a.page1.l_xmii018_09" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii018_09
            #add-point:ON CHANGE l_xmii018_09
            {<point name="input.g.page1.l_xmii018_09" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii019_09
            #add-point:BEFORE FIELD l_xmii019_09
            {<point name="input.b.page1.l_xmii019_09" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii019_09
            
            #add-point:AFTER FIELD l_xmii019_09
            {<point name="input.a.page1.l_xmii019_09" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii019_09
            #add-point:ON CHANGE l_xmii019_09
            {<point name="input.g.page1.l_xmii019_09" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii018_10
            #add-point:BEFORE FIELD l_xmii018_10
            {<point name="input.b.page1.l_xmii018_10" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii018_10
            
            #add-point:AFTER FIELD l_xmii018_10
            {<point name="input.a.page1.l_xmii018_10" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii018_10
            #add-point:ON CHANGE l_xmii018_10
            {<point name="input.g.page1.l_xmii018_10" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii019_10
            #add-point:BEFORE FIELD l_xmii019_10
            {<point name="input.b.page1.l_xmii019_10" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii019_10
            
            #add-point:AFTER FIELD l_xmii019_10
            {<point name="input.a.page1.l_xmii019_10" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii019_10
            #add-point:ON CHANGE l_xmii019_10
            {<point name="input.g.page1.l_xmii019_10" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii018_11
            #add-point:BEFORE FIELD l_xmii018_11
            {<point name="input.b.page1.l_xmii018_11" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii018_11
            
            #add-point:AFTER FIELD l_xmii018_11
            {<point name="input.a.page1.l_xmii018_11" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii018_11
            #add-point:ON CHANGE l_xmii018_11
            {<point name="input.g.page1.l_xmii018_11" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii019_11
            #add-point:BEFORE FIELD l_xmii019_11
            {<point name="input.b.page1.l_xmii019_11" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii019_11
            
            #add-point:AFTER FIELD l_xmii019_11
            {<point name="input.a.page1.l_xmii019_11" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii019_11
            #add-point:ON CHANGE l_xmii019_11
            {<point name="input.g.page1.l_xmii019_11" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii018_12
            #add-point:BEFORE FIELD l_xmii018_12
            {<point name="input.b.page1.l_xmii018_12" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii018_12
            
            #add-point:AFTER FIELD l_xmii018_12
            {<point name="input.a.page1.l_xmii018_12" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii018_12
            #add-point:ON CHANGE l_xmii018_12
            {<point name="input.g.page1.l_xmii018_12" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii019_12
            #add-point:BEFORE FIELD l_xmii019_12
            {<point name="input.b.page1.l_xmii019_12" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii019_12
            
            #add-point:AFTER FIELD l_xmii019_12
            {<point name="input.a.page1.l_xmii019_12" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii019_12
            #add-point:ON CHANGE l_xmii019_12
            {<point name="input.g.page1.l_xmii019_12" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii018_13
            #add-point:BEFORE FIELD l_xmii018_13
            {<point name="input.b.page1.l_xmii018_13" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii018_13
            
            #add-point:AFTER FIELD l_xmii018_13
            {<point name="input.a.page1.l_xmii018_13" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii018_13
            #add-point:ON CHANGE l_xmii018_13
            {<point name="input.g.page1.l_xmii018_13" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii019_13
            #add-point:BEFORE FIELD l_xmii019_13
            {<point name="input.b.page1.l_xmii019_13" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii019_13
            
            #add-point:AFTER FIELD l_xmii019_13
            {<point name="input.a.page1.l_xmii019_13" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii019_13
            #add-point:ON CHANGE l_xmii019_13
            {<point name="input.g.page1.l_xmii019_13" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii018_14
            #add-point:BEFORE FIELD l_xmii018_14
            {<point name="input.b.page1.l_xmii018_14" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii018_14
            
            #add-point:AFTER FIELD l_xmii018_14
            {<point name="input.a.page1.l_xmii018_14" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii018_14
            #add-point:ON CHANGE l_xmii018_14
            {<point name="input.g.page1.l_xmii018_14" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii019_14
            #add-point:BEFORE FIELD l_xmii019_14
            {<point name="input.b.page1.l_xmii019_14" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii019_14
            
            #add-point:AFTER FIELD l_xmii019_14
            {<point name="input.a.page1.l_xmii019_14" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii019_14
            #add-point:ON CHANGE l_xmii019_14
            {<point name="input.g.page1.l_xmii019_14" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii018_15
            #add-point:BEFORE FIELD l_xmii018_15
            {<point name="input.b.page1.l_xmii018_15" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii018_15
            
            #add-point:AFTER FIELD l_xmii018_15
            {<point name="input.a.page1.l_xmii018_15" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii018_15
            #add-point:ON CHANGE l_xmii018_15
            {<point name="input.g.page1.l_xmii018_15" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii019_15
            #add-point:BEFORE FIELD l_xmii019_15
            {<point name="input.b.page1.l_xmii019_15" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii019_15
            
            #add-point:AFTER FIELD l_xmii019_15
            {<point name="input.a.page1.l_xmii019_15" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii019_15
            #add-point:ON CHANGE l_xmii019_15
            {<point name="input.g.page1.l_xmii019_15" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii018_16
            #add-point:BEFORE FIELD l_xmii018_16
            {<point name="input.b.page1.l_xmii018_16" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii018_16
            
            #add-point:AFTER FIELD l_xmii018_16
            {<point name="input.a.page1.l_xmii018_16" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii018_16
            #add-point:ON CHANGE l_xmii018_16
            {<point name="input.g.page1.l_xmii018_16" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii019_16
            #add-point:BEFORE FIELD l_xmii019_16
            {<point name="input.b.page1.l_xmii019_16" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii019_16
            
            #add-point:AFTER FIELD l_xmii019_16
            {<point name="input.a.page1.l_xmii019_16" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii019_16
            #add-point:ON CHANGE l_xmii019_16
            {<point name="input.g.page1.l_xmii019_16" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii018_17
            #add-point:BEFORE FIELD l_xmii018_17
            {<point name="input.b.page1.l_xmii018_17" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii018_17
            
            #add-point:AFTER FIELD l_xmii018_17
            {<point name="input.a.page1.l_xmii018_17" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii018_17
            #add-point:ON CHANGE l_xmii018_17
            {<point name="input.g.page1.l_xmii018_17" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii019_17
            #add-point:BEFORE FIELD l_xmii019_17
            {<point name="input.b.page1.l_xmii019_17" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii019_17
            
            #add-point:AFTER FIELD l_xmii019_17
            {<point name="input.a.page1.l_xmii019_17" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii019_17
            #add-point:ON CHANGE l_xmii019_17
            {<point name="input.g.page1.l_xmii019_17" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii018_18
            #add-point:BEFORE FIELD l_xmii018_18
            {<point name="input.b.page1.l_xmii018_18" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii018_18
            
            #add-point:AFTER FIELD l_xmii018_18
            {<point name="input.a.page1.l_xmii018_18" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii018_18
            #add-point:ON CHANGE l_xmii018_18
            {<point name="input.g.page1.l_xmii018_18" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii019_18
            #add-point:BEFORE FIELD l_xmii019_18
            {<point name="input.b.page1.l_xmii019_18" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii019_18
            
            #add-point:AFTER FIELD l_xmii019_18
            {<point name="input.a.page1.l_xmii019_18" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii019_18
            #add-point:ON CHANGE l_xmii019_18
            {<point name="input.g.page1.l_xmii019_18" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii018_19
            #add-point:BEFORE FIELD l_xmii018_19
            {<point name="input.b.page1.l_xmii018_19" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii018_19
            
            #add-point:AFTER FIELD l_xmii018_19
            {<point name="input.a.page1.l_xmii018_19" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii018_19
            #add-point:ON CHANGE l_xmii018_19
            {<point name="input.g.page1.l_xmii018_19" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii019_19
            #add-point:BEFORE FIELD l_xmii019_19
            {<point name="input.b.page1.l_xmii019_19" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii019_19
            
            #add-point:AFTER FIELD l_xmii019_19
            {<point name="input.a.page1.l_xmii019_19" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii019_19
            #add-point:ON CHANGE l_xmii019_19
            {<point name="input.g.page1.l_xmii019_19" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii018_20
            #add-point:BEFORE FIELD l_xmii018_20
            {<point name="input.b.page1.l_xmii018_20" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii018_20
            
            #add-point:AFTER FIELD l_xmii018_20
            {<point name="input.a.page1.l_xmii018_20" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii018_20
            #add-point:ON CHANGE l_xmii018_20
            {<point name="input.g.page1.l_xmii018_20" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii019_20
            #add-point:BEFORE FIELD l_xmii019_20
            {<point name="input.b.page1.l_xmii019_20" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii019_20
            
            #add-point:AFTER FIELD l_xmii019_20
            {<point name="input.a.page1.l_xmii019_20" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii019_20
            #add-point:ON CHANGE l_xmii019_20
            {<point name="input.g.page1.l_xmii019_20" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii018_21
            #add-point:BEFORE FIELD l_xmii018_21
            {<point name="input.b.page1.l_xmii018_21" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii018_21
            
            #add-point:AFTER FIELD l_xmii018_21
            {<point name="input.a.page1.l_xmii018_21" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii018_21
            #add-point:ON CHANGE l_xmii018_21
            {<point name="input.g.page1.l_xmii018_21" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii019_21
            #add-point:BEFORE FIELD l_xmii019_21
            {<point name="input.b.page1.l_xmii019_21" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii019_21
            
            #add-point:AFTER FIELD l_xmii019_21
            {<point name="input.a.page1.l_xmii019_21" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii019_21
            #add-point:ON CHANGE l_xmii019_21
            {<point name="input.g.page1.l_xmii019_21" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii018_22
            #add-point:BEFORE FIELD l_xmii018_22
            {<point name="input.b.page1.l_xmii018_22" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii018_22
            
            #add-point:AFTER FIELD l_xmii018_22
            {<point name="input.a.page1.l_xmii018_22" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii018_22
            #add-point:ON CHANGE l_xmii018_22
            {<point name="input.g.page1.l_xmii018_22" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii019_22
            #add-point:BEFORE FIELD l_xmii019_22
            {<point name="input.b.page1.l_xmii019_22" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii019_22
            
            #add-point:AFTER FIELD l_xmii019_22
            {<point name="input.a.page1.l_xmii019_22" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii019_22
            #add-point:ON CHANGE l_xmii019_22
            {<point name="input.g.page1.l_xmii019_22" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii018_23
            #add-point:BEFORE FIELD l_xmii018_23
            {<point name="input.b.page1.l_xmii018_23" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii018_23
            
            #add-point:AFTER FIELD l_xmii018_23
            {<point name="input.a.page1.l_xmii018_23" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii018_23
            #add-point:ON CHANGE l_xmii018_23
            {<point name="input.g.page1.l_xmii018_23" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii019_23
            #add-point:BEFORE FIELD l_xmii019_23
            {<point name="input.b.page1.l_xmii019_23" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii019_23
            
            #add-point:AFTER FIELD l_xmii019_23
            {<point name="input.a.page1.l_xmii019_23" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii019_23
            #add-point:ON CHANGE l_xmii019_23
            {<point name="input.g.page1.l_xmii019_23" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii018_24
            #add-point:BEFORE FIELD l_xmii018_24
            {<point name="input.b.page1.l_xmii018_24" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii018_24
            
            #add-point:AFTER FIELD l_xmii018_24
            {<point name="input.a.page1.l_xmii018_24" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii018_24
            #add-point:ON CHANGE l_xmii018_24
            {<point name="input.g.page1.l_xmii018_24" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii019_24
            #add-point:BEFORE FIELD l_xmii019_24
            {<point name="input.b.page1.l_xmii019_24" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii019_24
            
            #add-point:AFTER FIELD l_xmii019_24
            {<point name="input.a.page1.l_xmii019_24" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii019_24
            #add-point:ON CHANGE l_xmii019_24
            {<point name="input.g.page1.l_xmii019_24" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii018_s
            #add-point:BEFORE FIELD l_xmii018_s
            {<point name="input.b.page1.l_xmii018_s" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii018_s
            
            #add-point:AFTER FIELD l_xmii018_s
            {<point name="input.a.page1.l_xmii018_s" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii018_s
            #add-point:ON CHANGE l_xmii018_s
            {<point name="input.g.page1.l_xmii018_s" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii019_s
            #add-point:BEFORE FIELD l_xmii019_s
            {<point name="input.b.page1.l_xmii019_s" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii019_s
            
            #add-point:AFTER FIELD l_xmii019_s
            {<point name="input.a.page1.l_xmii019_s" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii019_s
            #add-point:ON CHANGE l_xmii019_s
            {<point name="input.g.page1.l_xmii019_s" />}
            #END add-point
 
 
                  #Ctrlp:input.c.page1.xmii005
         ON ACTION controlp INFIELD xmii005
            #add-point:ON ACTION controlp INFIELD xmii005
            {<point name="input.c.page1.xmii005" />}
            #END add-point
 
         #Ctrlp:input.c.page1.xmii007
         ON ACTION controlp INFIELD xmii007
            #add-point:ON ACTION controlp INFIELD xmii007
            {<point name="input.c.page1.xmii007" />}
            #END add-point
 
         #Ctrlp:input.c.page1.xmii006
         ON ACTION controlp INFIELD xmii006
            #add-point:ON ACTION controlp INFIELD xmii006
            {<point name="input.c.page1.xmii006" />}
            #END add-point
 
         #Ctrlp:input.c.page1.xmii008
         ON ACTION controlp INFIELD xmii008
            #add-point:ON ACTION controlp INFIELD xmii008
            {<point name="input.c.page1.xmii008" />}
            #END add-point
 
         #Ctrlp:input.c.page1.xmii012
         ON ACTION controlp INFIELD xmii012
            #add-point:ON ACTION controlp INFIELD xmii012
            {<point name="input.c.page1.xmii012" />}
            #END add-point
 
         #Ctrlp:input.c.page1.xmii013
         ON ACTION controlp INFIELD xmii013
            #add-point:ON ACTION controlp INFIELD xmii013
            {<point name="input.c.page1.xmii013" />}
            #END add-point
 
         #Ctrlp:input.c.page1.xmii011
         ON ACTION controlp INFIELD xmii011
            #add-point:ON ACTION controlp INFIELD xmii011
            {<point name="input.c.page1.xmii011" />}
            #END add-point
 
         #Ctrlp:input.c.page1.xmii009
         ON ACTION controlp INFIELD xmii009
            #add-point:ON ACTION controlp INFIELD xmii009
            {<point name="input.c.page1.xmii009" />}
            #END add-point
 
         #Ctrlp:input.c.page1.xmii010
         ON ACTION controlp INFIELD xmii010
            #add-point:ON ACTION controlp INFIELD xmii010
            {<point name="input.c.page1.xmii010" />}
            #END add-point
 
         #Ctrlp:input.c.page1.xmii017
         ON ACTION controlp INFIELD xmii017
            #add-point:ON ACTION controlp INFIELD xmii017
            {<point name="input.c.page1.xmii017" />}
            #END add-point
 
         #Ctrlp:input.c.page1.xmii014
         ON ACTION controlp INFIELD xmii014
            #add-point:ON ACTION controlp INFIELD xmii014
            {<point name="input.c.page1.xmii014" />}
            #END add-point
 
         #Ctrlp:input.c.page1.l_xmii018_01
         ON ACTION controlp INFIELD l_xmii018_01
            #add-point:ON ACTION controlp INFIELD l_xmii018_01
            {<point name="input.c.page1.l_xmii018_01" />}
            #END add-point
 
         #Ctrlp:input.c.page1.l_xmii019_01
         ON ACTION controlp INFIELD l_xmii019_01
            #add-point:ON ACTION controlp INFIELD l_xmii019_01
            {<point name="input.c.page1.l_xmii019_01" />}
            #END add-point
 
         #Ctrlp:input.c.page1.l_xmii018_02
         ON ACTION controlp INFIELD l_xmii018_02
            #add-point:ON ACTION controlp INFIELD l_xmii018_02
            {<point name="input.c.page1.l_xmii018_02" />}
            #END add-point
 
         #Ctrlp:input.c.page1.l_xmii019_02
         ON ACTION controlp INFIELD l_xmii019_02
            #add-point:ON ACTION controlp INFIELD l_xmii019_02
            {<point name="input.c.page1.l_xmii019_02" />}
            #END add-point
 
         #Ctrlp:input.c.page1.l_xmii018_03
         ON ACTION controlp INFIELD l_xmii018_03
            #add-point:ON ACTION controlp INFIELD l_xmii018_03
            {<point name="input.c.page1.l_xmii018_03" />}
            #END add-point
 
         #Ctrlp:input.c.page1.l_xmii019_03
         ON ACTION controlp INFIELD l_xmii019_03
            #add-point:ON ACTION controlp INFIELD l_xmii019_03
            {<point name="input.c.page1.l_xmii019_03" />}
            #END add-point
 
         #Ctrlp:input.c.page1.l_xmii018_04
         ON ACTION controlp INFIELD l_xmii018_04
            #add-point:ON ACTION controlp INFIELD l_xmii018_04
            {<point name="input.c.page1.l_xmii018_04" />}
            #END add-point
 
         #Ctrlp:input.c.page1.l_xmii019_04
         ON ACTION controlp INFIELD l_xmii019_04
            #add-point:ON ACTION controlp INFIELD l_xmii019_04
            {<point name="input.c.page1.l_xmii019_04" />}
            #END add-point
 
         #Ctrlp:input.c.page1.l_xmii018_05
         ON ACTION controlp INFIELD l_xmii018_05
            #add-point:ON ACTION controlp INFIELD l_xmii018_05
            {<point name="input.c.page1.l_xmii018_05" />}
            #END add-point
 
         #Ctrlp:input.c.page1.l_xmii019_05
         ON ACTION controlp INFIELD l_xmii019_05
            #add-point:ON ACTION controlp INFIELD l_xmii019_05
            {<point name="input.c.page1.l_xmii019_05" />}
            #END add-point
 
         #Ctrlp:input.c.page1.l_xmii018_06
         ON ACTION controlp INFIELD l_xmii018_06
            #add-point:ON ACTION controlp INFIELD l_xmii018_06
            {<point name="input.c.page1.l_xmii018_06" />}
            #END add-point
 
         #Ctrlp:input.c.page1.l_xmii019_06
         ON ACTION controlp INFIELD l_xmii019_06
            #add-point:ON ACTION controlp INFIELD l_xmii019_06
            {<point name="input.c.page1.l_xmii019_06" />}
            #END add-point
 
         #Ctrlp:input.c.page1.l_xmii018_07
         ON ACTION controlp INFIELD l_xmii018_07
            #add-point:ON ACTION controlp INFIELD l_xmii018_07
            {<point name="input.c.page1.l_xmii018_07" />}
            #END add-point
 
         #Ctrlp:input.c.page1.l_xmii019_07
         ON ACTION controlp INFIELD l_xmii019_07
            #add-point:ON ACTION controlp INFIELD l_xmii019_07
            {<point name="input.c.page1.l_xmii019_07" />}
            #END add-point
 
         #Ctrlp:input.c.page1.l_xmii018_08
         ON ACTION controlp INFIELD l_xmii018_08
            #add-point:ON ACTION controlp INFIELD l_xmii018_08
            {<point name="input.c.page1.l_xmii018_08" />}
            #END add-point
 
         #Ctrlp:input.c.page1.l_xmii019_08
         ON ACTION controlp INFIELD l_xmii019_08
            #add-point:ON ACTION controlp INFIELD l_xmii019_08
            {<point name="input.c.page1.l_xmii019_08" />}
            #END add-point
 
         #Ctrlp:input.c.page1.l_xmii018_09
         ON ACTION controlp INFIELD l_xmii018_09
            #add-point:ON ACTION controlp INFIELD l_xmii018_09
            {<point name="input.c.page1.l_xmii018_09" />}
            #END add-point
 
         #Ctrlp:input.c.page1.l_xmii019_09
         ON ACTION controlp INFIELD l_xmii019_09
            #add-point:ON ACTION controlp INFIELD l_xmii019_09
            {<point name="input.c.page1.l_xmii019_09" />}
            #END add-point
 
         #Ctrlp:input.c.page1.l_xmii018_10
         ON ACTION controlp INFIELD l_xmii018_10
            #add-point:ON ACTION controlp INFIELD l_xmii018_10
            {<point name="input.c.page1.l_xmii018_10" />}
            #END add-point
 
         #Ctrlp:input.c.page1.l_xmii019_10
         ON ACTION controlp INFIELD l_xmii019_10
            #add-point:ON ACTION controlp INFIELD l_xmii019_10
            {<point name="input.c.page1.l_xmii019_10" />}
            #END add-point
 
         #Ctrlp:input.c.page1.l_xmii018_11
         ON ACTION controlp INFIELD l_xmii018_11
            #add-point:ON ACTION controlp INFIELD l_xmii018_11
            {<point name="input.c.page1.l_xmii018_11" />}
            #END add-point
 
         #Ctrlp:input.c.page1.l_xmii019_11
         ON ACTION controlp INFIELD l_xmii019_11
            #add-point:ON ACTION controlp INFIELD l_xmii019_11
            {<point name="input.c.page1.l_xmii019_11" />}
            #END add-point
 
         #Ctrlp:input.c.page1.l_xmii018_12
         ON ACTION controlp INFIELD l_xmii018_12
            #add-point:ON ACTION controlp INFIELD l_xmii018_12
            {<point name="input.c.page1.l_xmii018_12" />}
            #END add-point
 
         #Ctrlp:input.c.page1.l_xmii019_12
         ON ACTION controlp INFIELD l_xmii019_12
            #add-point:ON ACTION controlp INFIELD l_xmii019_12
            {<point name="input.c.page1.l_xmii019_12" />}
            #END add-point
 
         #Ctrlp:input.c.page1.l_xmii018_13
         ON ACTION controlp INFIELD l_xmii018_13
            #add-point:ON ACTION controlp INFIELD l_xmii018_13
            {<point name="input.c.page1.l_xmii018_13" />}
            #END add-point
 
         #Ctrlp:input.c.page1.l_xmii019_13
         ON ACTION controlp INFIELD l_xmii019_13
            #add-point:ON ACTION controlp INFIELD l_xmii019_13
            {<point name="input.c.page1.l_xmii019_13" />}
            #END add-point
 
         #Ctrlp:input.c.page1.l_xmii018_14
         ON ACTION controlp INFIELD l_xmii018_14
            #add-point:ON ACTION controlp INFIELD l_xmii018_14
            {<point name="input.c.page1.l_xmii018_14" />}
            #END add-point
 
         #Ctrlp:input.c.page1.l_xmii019_14
         ON ACTION controlp INFIELD l_xmii019_14
            #add-point:ON ACTION controlp INFIELD l_xmii019_14
            {<point name="input.c.page1.l_xmii019_14" />}
            #END add-point
 
         #Ctrlp:input.c.page1.l_xmii018_15
         ON ACTION controlp INFIELD l_xmii018_15
            #add-point:ON ACTION controlp INFIELD l_xmii018_15
            {<point name="input.c.page1.l_xmii018_15" />}
            #END add-point
 
         #Ctrlp:input.c.page1.l_xmii019_15
         ON ACTION controlp INFIELD l_xmii019_15
            #add-point:ON ACTION controlp INFIELD l_xmii019_15
            {<point name="input.c.page1.l_xmii019_15" />}
            #END add-point
 
         #Ctrlp:input.c.page1.l_xmii018_16
         ON ACTION controlp INFIELD l_xmii018_16
            #add-point:ON ACTION controlp INFIELD l_xmii018_16
            {<point name="input.c.page1.l_xmii018_16" />}
            #END add-point
 
         #Ctrlp:input.c.page1.l_xmii019_16
         ON ACTION controlp INFIELD l_xmii019_16
            #add-point:ON ACTION controlp INFIELD l_xmii019_16
            {<point name="input.c.page1.l_xmii019_16" />}
            #END add-point
 
         #Ctrlp:input.c.page1.l_xmii018_17
         ON ACTION controlp INFIELD l_xmii018_17
            #add-point:ON ACTION controlp INFIELD l_xmii018_17
            {<point name="input.c.page1.l_xmii018_17" />}
            #END add-point
 
         #Ctrlp:input.c.page1.l_xmii019_17
         ON ACTION controlp INFIELD l_xmii019_17
            #add-point:ON ACTION controlp INFIELD l_xmii019_17
            {<point name="input.c.page1.l_xmii019_17" />}
            #END add-point
 
         #Ctrlp:input.c.page1.l_xmii018_18
         ON ACTION controlp INFIELD l_xmii018_18
            #add-point:ON ACTION controlp INFIELD l_xmii018_18
            {<point name="input.c.page1.l_xmii018_18" />}
            #END add-point
 
         #Ctrlp:input.c.page1.l_xmii019_18
         ON ACTION controlp INFIELD l_xmii019_18
            #add-point:ON ACTION controlp INFIELD l_xmii019_18
            {<point name="input.c.page1.l_xmii019_18" />}
            #END add-point
 
         #Ctrlp:input.c.page1.l_xmii018_19
         ON ACTION controlp INFIELD l_xmii018_19
            #add-point:ON ACTION controlp INFIELD l_xmii018_19
            {<point name="input.c.page1.l_xmii018_19" />}
            #END add-point
 
         #Ctrlp:input.c.page1.l_xmii019_19
         ON ACTION controlp INFIELD l_xmii019_19
            #add-point:ON ACTION controlp INFIELD l_xmii019_19
            {<point name="input.c.page1.l_xmii019_19" />}
            #END add-point
 
         #Ctrlp:input.c.page1.l_xmii018_20
         ON ACTION controlp INFIELD l_xmii018_20
            #add-point:ON ACTION controlp INFIELD l_xmii018_20
            {<point name="input.c.page1.l_xmii018_20" />}
            #END add-point
 
         #Ctrlp:input.c.page1.l_xmii019_20
         ON ACTION controlp INFIELD l_xmii019_20
            #add-point:ON ACTION controlp INFIELD l_xmii019_20
            {<point name="input.c.page1.l_xmii019_20" />}
            #END add-point
 
         #Ctrlp:input.c.page1.l_xmii018_21
         ON ACTION controlp INFIELD l_xmii018_21
            #add-point:ON ACTION controlp INFIELD l_xmii018_21
            {<point name="input.c.page1.l_xmii018_21" />}
            #END add-point
 
         #Ctrlp:input.c.page1.l_xmii019_21
         ON ACTION controlp INFIELD l_xmii019_21
            #add-point:ON ACTION controlp INFIELD l_xmii019_21
            {<point name="input.c.page1.l_xmii019_21" />}
            #END add-point
 
         #Ctrlp:input.c.page1.l_xmii018_22
         ON ACTION controlp INFIELD l_xmii018_22
            #add-point:ON ACTION controlp INFIELD l_xmii018_22
            {<point name="input.c.page1.l_xmii018_22" />}
            #END add-point
 
         #Ctrlp:input.c.page1.l_xmii019_22
         ON ACTION controlp INFIELD l_xmii019_22
            #add-point:ON ACTION controlp INFIELD l_xmii019_22
            {<point name="input.c.page1.l_xmii019_22" />}
            #END add-point
 
         #Ctrlp:input.c.page1.l_xmii018_23
         ON ACTION controlp INFIELD l_xmii018_23
            #add-point:ON ACTION controlp INFIELD l_xmii018_23
            {<point name="input.c.page1.l_xmii018_23" />}
            #END add-point
 
         #Ctrlp:input.c.page1.l_xmii019_23
         ON ACTION controlp INFIELD l_xmii019_23
            #add-point:ON ACTION controlp INFIELD l_xmii019_23
            {<point name="input.c.page1.l_xmii019_23" />}
            #END add-point
 
         #Ctrlp:input.c.page1.l_xmii018_24
         ON ACTION controlp INFIELD l_xmii018_24
            #add-point:ON ACTION controlp INFIELD l_xmii018_24
            {<point name="input.c.page1.l_xmii018_24" />}
            #END add-point
 
         #Ctrlp:input.c.page1.l_xmii019_24
         ON ACTION controlp INFIELD l_xmii019_24
            #add-point:ON ACTION controlp INFIELD l_xmii019_24
            {<point name="input.c.page1.l_xmii019_24" />}
            #END add-point
 
         #Ctrlp:input.c.page1.l_xmii018_s
         ON ACTION controlp INFIELD l_xmii018_s
            #add-point:ON ACTION controlp INFIELD l_xmii018_s
            {<point name="input.c.page1.l_xmii018_s" />}
            #END add-point
 
         #Ctrlp:input.c.page1.l_xmii019_s
         ON ACTION controlp INFIELD l_xmii019_s
            #add-point:ON ACTION controlp INFIELD l_xmii019_s
            {<point name="input.c.page1.l_xmii019_s" />}
            #END add-point
 
 
 
         ON ROW CHANGE
            IF INT_FLAG THEN
               CALL cl_err('',9001,0)
               LET INT_FLAG = 0
               LET g_xmii_d[l_ac].* = g_xmii_d_t.*
               CLOSE axmt175_bcl
               CALL s_transaction_end('N','0')
               EXIT DIALOG 
            END IF
              
            IF l_lock_sw = 'Y' THEN
               CALL cl_err(g_xmii_d[l_ac].xmii006,-263,1)
               LET g_xmii_d[l_ac].* = g_xmii_d_t.*
            ELSE
            
               #add-point:單身修改前
               {<point name="input.body.b_update" mark="Y"/>}
               #end add-point
               
               #寫入修改者/修改日期資訊(單身)
               
      
               UPDATE xmii_t SET (xmii001,xmii002,xmii003,xmii004,xmii005,xmii007,xmii006,xmii008,xmii012, 
                   xmii013,xmii011,xmii009,xmii010,xmii017,xmii014) = (g_xmih_m.xmih001,g_xmih_m.xmih002, 
                   g_xmih_m.xmih003,g_xmih_m.xmih004,g_xmii_d[l_ac].xmii005,g_xmii_d[l_ac].xmii007,g_xmii_d[l_ac].xmii006, 
                   g_xmii_d[l_ac].xmii008,g_xmii_d[l_ac].xmii012,g_xmii_d[l_ac].xmii013,g_xmii_d[l_ac].xmii011, 
                   g_xmii_d[l_ac].xmii009,g_xmii_d[l_ac].xmii010,g_xmii_d[l_ac].xmii017,g_xmii_d[l_ac].xmii014) 

                WHERE xmiient = g_enterprise AND xmii001 = g_xmih_m.xmih001 
                  AND xmii002 = g_xmih_m.xmih002 
                  AND xmii003 = g_xmih_m.xmih003 
                  AND xmii004 = g_xmih_m.xmih004 
 
                  AND xmii006 = g_xmii_d_t.xmii006 #項次   
                  AND xmii007 = g_xmii_d_t.xmii007  
                  AND xmii008 = g_xmii_d_t.xmii008  
                  AND xmii009 = g_xmii_d_t.xmii009  
                  AND xmii010 = g_xmii_d_t.xmii010  
                  AND xmii011 = g_xmii_d_t.xmii011  
                  AND xmii012 = g_xmii_d_t.xmii012  
                  AND xmii013 = g_xmii_d_t.xmii013  
                  AND xmii014 = g_xmii_d_t.xmii014  
                  AND xmii017 = g_xmii_d_t.xmii017  
 
                  
               #add-point:單身修改中
               {<point name="input.body.m_update"/>}
               #end add-point
               CASE
                  WHEN SQLCA.sqlerrd[3] = 0  #更新不到的處理
                     CALL cl_err("xmii_t","std-00009",1)
                     CALL s_transaction_end('N','0')
                     LET g_xmii_d[l_ac].* = g_xmii_d_t.*
                  WHEN SQLCA.sqlcode #其他錯誤
                     CALL cl_err("xmii_t",SQLCA.sqlcode,1)
                     LET g_xmii_d[l_ac].* = g_xmii_d_t.*                     
                     CALL s_transaction_end('N','0')
                  OTHERWISE
                                    INITIALIZE gs_keys TO NULL 
               LET gs_keys[1] = g_xmih_m.xmih001
               LET gs_keys_bak[1] = g_xmih001_t
               LET gs_keys[2] = g_xmih_m.xmih002
               LET gs_keys_bak[2] = g_xmih002_t
               LET gs_keys[3] = g_xmih_m.xmih003
               LET gs_keys_bak[3] = g_xmih003_t
               LET gs_keys[4] = g_xmih_m.xmih004
               LET gs_keys_bak[4] = g_xmih004_t
               LET gs_keys[5] = g_xmii_d[g_detail_idx].xmii006
               LET gs_keys_bak[5] = g_xmii_d_t.xmii006
               LET gs_keys[6] = g_xmii_d[g_detail_idx].xmii007
               LET gs_keys_bak[6] = g_xmii_d_t.xmii007
               LET gs_keys[7] = g_xmii_d[g_detail_idx].xmii008
               LET gs_keys_bak[7] = g_xmii_d_t.xmii008
               LET gs_keys[8] = g_xmii_d[g_detail_idx].xmii009
               LET gs_keys_bak[8] = g_xmii_d_t.xmii009
               LET gs_keys[9] = g_xmii_d[g_detail_idx].xmii010
               LET gs_keys_bak[9] = g_xmii_d_t.xmii010
               LET gs_keys[10] = g_xmii_d[g_detail_idx].xmii011
               LET gs_keys_bak[10] = g_xmii_d_t.xmii011
               LET gs_keys[11] = g_xmii_d[g_detail_idx].xmii012
               LET gs_keys_bak[11] = g_xmii_d_t.xmii012
               LET gs_keys[12] = g_xmii_d[g_detail_idx].xmii013
               LET gs_keys_bak[12] = g_xmii_d_t.xmii013
               LET gs_keys[13] = g_xmii_d[g_detail_idx].xmii014
               LET gs_keys_bak[13] = g_xmii_d_t.xmii014
               LET gs_keys[14] = g_xmii_d[g_detail_idx].xmii017
               LET gs_keys_bak[14] = g_xmii_d_t.xmii017
               CALL axmt175_update_b('xmii_t',gs_keys,gs_keys_bak,"'1'")
                     #資料多語言用-增/改
                     
               END CASE
               
			   #修改歷程記錄
               LET g_log1 = util.JSON.stringify(g_xmih_m),util.JSON.stringify(g_xmii_d_t)
               LET g_log2 = util.JSON.stringify(g_xmih_m),util.JSON.stringify(g_xmii_d[l_ac])
               IF NOT cl_log_modified_record(g_log1,g_log2) THEN 
                  CALL s_transaction_end('N','0')
               END IF
               
               #add-point:單身修改後
               {<point name="input.body.a_update"/>}
               #end add-point
 
            END IF
            
         AFTER ROW
            #add-point:單身after_row
            {<point name="input.body.after_row"/>}
            #end add-point
            CALL axmt175_unlock_b("xmii_t","'1'")
            CALL s_transaction_end('Y','0')
            #其他table進行unlock
            #add-point:單身after_row2
            {<point name="input.body.after_row2"/>}
            #end add-point
              
         AFTER INPUT
            #add-point:input段after input 
            {<point name="input.body.after_input"/>}
            #end add-point 
 
         ON ACTION controlo    
            CALL FGL_SET_ARR_CURR(g_xmii_d.getLength()+1)
            LET lb_reproduce = TRUE
            LET li_reproduce = l_ac
            LET li_reproduce_target = g_xmii_d.getLength()+1
            
         #ON ACTION cancel
         #   LET INT_FLAG = 1
         #   LET g_detail_idx = 1
         #   EXIT DIALOG 
 
      END INPUT
      
      INPUT ARRAY g_xmii2_d FROM s_detail2.*
         ATTRIBUTE(COUNT = g_rec_b,MAXCOUNT = g_max_rec,WITHOUT DEFAULTS, 
                 INSERT ROW = FALSE, #此頁面insert功能由產生器控制, 手動之設定無效! 

                 DELETE ROW = l_allow_delete,
                 APPEND ROW = l_allow_insert)
                 
         #自訂ACTION(detail_input,page_2)
         
         
         BEFORE INPUT
            
            CALL axmt175_b_fill()
            LET g_rec_b = g_xmii2_d.getLength()
            #add-point:資料輸入前
            {<point name="input.body2.before_input"/>}
            #end add-point
            
         BEFORE INSERT
            LET g_insert = 'Y' 
            NEXT FIELD xmii006
 
            LET l_insert = TRUE
            LET l_n = ARR_COUNT()
            LET l_cmd = 'a'
            INITIALIZE g_xmii2_d[l_ac].* TO NULL 
            INITIALIZE g_xmii2_d_t.* TO NULL 
            INITIALIZE g_xmii2_d_o.* TO NULL 
            
            LET g_xmii2_d_t.* = g_xmii2_d[l_ac].*     #新輸入資料
            LET g_xmii2_d_o.* = g_xmii2_d[l_ac].*     #新輸入資料
            CALL cl_show_fld_cont()
            CALL axmt175_set_entry_b(l_cmd)
            #add-point:modify段after_set_entry_b
            {<point name="input.body2.insert.after_set_entry_b"/>}
            #end add-point
            CALL axmt175_set_no_entry_b(l_cmd)
            IF lb_reproduce THEN
               LET lb_reproduce = FALSE
               LET g_xmii_d[li_reproduce_target].* = g_xmii_d[li_reproduce].*
               LET g_xmii2_d[li_reproduce_target].* = g_xmii2_d[li_reproduce].*
               LET g_xmii3_d[li_reproduce_target].* = g_xmii3_d[li_reproduce].*
 
               LET g_xmii2_d[li_reproduce_target].xmii006 = NULL
               LET g_xmii2_d[li_reproduce_target].xmii007 = NULL
               LET g_xmii2_d[li_reproduce_target].xmii008 = NULL
               LET g_xmii2_d[li_reproduce_target].xmii009 = NULL
               LET g_xmii2_d[li_reproduce_target].xmii010 = NULL
               LET g_xmii2_d[li_reproduce_target].xmii011 = NULL
               LET g_xmii2_d[li_reproduce_target].xmii012 = NULL
               LET g_xmii2_d[li_reproduce_target].xmii013 = NULL
               LET g_xmii2_d[li_reproduce_target].xmii014 = NULL
               LET g_xmii2_d[li_reproduce_target].xmii017 = NULL
            END IF
            #公用欄位給值(單身2)
            
            
            #add-point:modify段before insert
            {<point name="input.body2.before_insert"/>}
            #end add-point  
            
         BEFORE ROW     
            #add-point:modify段before row2
            {<point name="input.body2.before_row2"/>}
            #end add-point  
            LET l_insert = FALSE
            LET l_cmd = ''
            LET l_ac = ARR_CURR()
            LET g_detail_idx = l_ac
              
            LET l_lock_sw = 'N'            #DEFAULT
            LET l_n = ARR_COUNT()
            DISPLAY l_ac TO FORMONLY.idx
         
            CALL s_transaction_begin()
            OPEN axmt175_cl USING g_enterprise,g_xmih_m.xmih001,g_xmih_m.xmih002,g_xmih_m.xmih003,g_xmih_m.xmih004
            IF STATUS THEN
               CALL cl_err("OPEN axmt175_cl:", STATUS, 1)
               CLOSE axmt175_cl
               CALL s_transaction_end('N','0')
               RETURN
            END IF
            
            LET g_rec_b = g_xmii2_d.getLength()
            
            IF g_rec_b >= l_ac 
               AND g_xmii2_d[l_ac].xmii006 IS NOT NULL
               AND g_xmii2_d[l_ac].xmii007 IS NOT NULL
               AND g_xmii2_d[l_ac].xmii008 IS NOT NULL
               AND g_xmii2_d[l_ac].xmii009 IS NOT NULL
               AND g_xmii2_d[l_ac].xmii010 IS NOT NULL
               AND g_xmii2_d[l_ac].xmii011 IS NOT NULL
               AND g_xmii2_d[l_ac].xmii012 IS NOT NULL
               AND g_xmii2_d[l_ac].xmii013 IS NOT NULL
               AND g_xmii2_d[l_ac].xmii014 IS NOT NULL
               AND g_xmii2_d[l_ac].xmii017 IS NOT NULL
            THEN 
               LET l_cmd='u'
               LET g_xmii2_d_t.* = g_xmii2_d[l_ac].*  #BACKUP
               LET g_xmii2_d_o.* = g_xmii2_d[l_ac].*  #BACKUP
               CALL axmt175_set_entry_b(l_cmd)
               #add-point:modify段after_set_entry_b
               {<point name="input.body2.after_set_entry_b"/>}
               #end add-point  
               CALL axmt175_set_no_entry_b(l_cmd)
               IF NOT axmt175_lock_b("xmii_t","'2'") THEN
                  LET l_lock_sw='Y'
               ELSE
                  FETCH axmt175_bcl INTO g_xmii_d[l_ac].xmii005,g_xmii_d[l_ac].xmii007,g_xmii_d[l_ac].xmii006, 
                      g_xmii_d[l_ac].xmii008,g_xmii_d[l_ac].xmii012,g_xmii_d[l_ac].xmii013,g_xmii_d[l_ac].xmii011, 
                      g_xmii_d[l_ac].xmii009,g_xmii_d[l_ac].xmii010,g_xmii_d[l_ac].xmii017,g_xmii_d[l_ac].xmii014, 
                      g_xmii2_d[l_ac].xmii005,g_xmii2_d[l_ac].xmii007,g_xmii2_d[l_ac].xmii006,g_xmii2_d[l_ac].xmii008, 
                      g_xmii2_d[l_ac].xmii012,g_xmii2_d[l_ac].xmii013,g_xmii2_d[l_ac].xmii011,g_xmii2_d[l_ac].xmii009, 
                      g_xmii2_d[l_ac].xmii010,g_xmii2_d[l_ac].xmii017,g_xmii2_d[l_ac].xmii014,g_xmii3_d[l_ac].xmii005, 
                      g_xmii3_d[l_ac].xmii007,g_xmii3_d[l_ac].xmii006,g_xmii3_d[l_ac].xmii008,g_xmii3_d[l_ac].xmii012, 
                      g_xmii3_d[l_ac].xmii013,g_xmii3_d[l_ac].xmii011,g_xmii3_d[l_ac].xmii009,g_xmii3_d[l_ac].xmii010, 
                      g_xmii3_d[l_ac].xmii017,g_xmii3_d[l_ac].xmii014
                  IF SQLCA.sqlcode THEN
                     CALL cl_err('',SQLCA.sqlcode,1)
                     LET l_lock_sw = "Y"
                  END IF
                  
                  LET g_bfill = "N"
                  CALL axmt175_show()
                  LET g_bfill = "Y"
                  
                  CALL cl_show_fld_cont()
               END IF
            ELSE
               LET l_cmd='a'
            END IF
            #add-point:modify段before row
            {<point name="input.body2.before_row"/>}
            #end add-point  
            #其他table資料備份(確定是否更改用)
            
            #其他table進行lock
            
            
         BEFORE DELETE                            #是否取消單身
            IF l_cmd = 'a' AND g_xmii2_d.getLength() < l_ac THEN
               CALL FGL_SET_ARR_CURR(l_ac-1)
               CALL g_xmii2_d.deleteElement(l_ac)
               NEXT FIELD xmii006
            END IF
         
            IF g_xmii2_d[l_ac].xmii006 IS NOT NULL
               AND g_xmii2_d_t.xmii007 IS NOT NULL
               AND g_xmii2_d_t.xmii008 IS NOT NULL
               AND g_xmii2_d_t.xmii009 IS NOT NULL
               AND g_xmii2_d_t.xmii010 IS NOT NULL
               AND g_xmii2_d_t.xmii011 IS NOT NULL
               AND g_xmii2_d_t.xmii012 IS NOT NULL
               AND g_xmii2_d_t.xmii013 IS NOT NULL
               AND g_xmii2_d_t.xmii014 IS NOT NULL
               AND g_xmii2_d_t.xmii017 IS NOT NULL
            THEN
               IF NOT cl_ask_del_detail() THEN
                  CANCEL DELETE
               END IF
               IF l_lock_sw = "Y" THEN
                  CALL cl_err("", -263, 1)
                  CANCEL DELETE
               END IF
               
               #add-point:單身2刪除前
               {<point name="input.body2.b_delete" mark="Y"/>}
               #end add-point    
               
               DELETE FROM xmii_t
                WHERE xmiient = g_enterprise AND xmii001 = g_xmih_m.xmih001 AND
                                          xmii002 = g_xmih_m.xmih002 AND
                                          xmii003 = g_xmih_m.xmih003 AND
                                          xmii004 = g_xmih_m.xmih004 AND
                      xmii006 = g_xmii2_d_t.xmii006
                  AND xmii007 = g_xmii2_d_t.xmii007
                  AND xmii008 = g_xmii2_d_t.xmii008
                  AND xmii009 = g_xmii2_d_t.xmii009
                  AND xmii010 = g_xmii2_d_t.xmii010
                  AND xmii011 = g_xmii2_d_t.xmii011
                  AND xmii012 = g_xmii2_d_t.xmii012
                  AND xmii013 = g_xmii2_d_t.xmii013
                  AND xmii014 = g_xmii2_d_t.xmii014
                  AND xmii017 = g_xmii2_d_t.xmii017
                  
               #add-point:單身2刪除中
               {<point name="input.body2.m_delete"/>}
               #end add-point    
                  
               IF SQLCA.sqlcode THEN
                  CALL cl_err("xmii_t",SQLCA.sqlcode,1)
                  CALL s_transaction_end('N','0')
                  CANCEL DELETE   
               ELSE
                  LET g_rec_b = g_rec_b-1
                  
                  #add-point:單身2刪除後
                  {<point name="input.body2.a_delete"/>}
                  #end add-point
                  CALL s_transaction_end('Y','0')
               END IF 
               CLOSE axmt175_bcl
               LET l_count = g_xmii_d.getLength()
            END IF 
            
                           INITIALIZE gs_keys TO NULL 
               LET gs_keys[1] = g_xmih_m.xmih001
               LET gs_keys[2] = g_xmih_m.xmih002
               LET gs_keys[3] = g_xmih_m.xmih003
               LET gs_keys[4] = g_xmih_m.xmih004
               LET gs_keys[5] = g_xmii2_d[g_detail_idx].xmii006
               LET gs_keys[6] = g_xmii2_d[g_detail_idx].xmii007
               LET gs_keys[7] = g_xmii2_d[g_detail_idx].xmii008
               LET gs_keys[8] = g_xmii2_d[g_detail_idx].xmii009
               LET gs_keys[9] = g_xmii2_d[g_detail_idx].xmii010
               LET gs_keys[10] = g_xmii2_d[g_detail_idx].xmii011
               LET gs_keys[11] = g_xmii2_d[g_detail_idx].xmii012
               LET gs_keys[12] = g_xmii2_d[g_detail_idx].xmii013
               LET gs_keys[13] = g_xmii2_d[g_detail_idx].xmii014
               LET gs_keys[14] = g_xmii2_d[g_detail_idx].xmii017
 
            
         AFTER DELETE 
            #add-point:單身AFTER DELETE 
            {<point name="input.body2.after_delete"/>}
            #end add-point
                           CALL axmt175_delete_b('xmii_t',gs_keys,"'2'")
 
         AFTER INSERT    
            LET l_insert = FALSE
            IF INT_FLAG THEN
               CALL cl_err('',9001,0)
               LET INT_FLAG = 0
               CANCEL INSERT
            END IF
               
            #add-point:單身2新增前
            {<point name="input.body2.b_a_insert"/>}
            #end add-point
               
            LET l_count = 1  
            SELECT COUNT(*) INTO l_count FROM xmii_t 
             WHERE xmiient = g_enterprise AND xmii001 = g_xmih_m.xmih001
               AND xmii002 = g_xmih_m.xmih002
               AND xmii003 = g_xmih_m.xmih003
               AND xmii004 = g_xmih_m.xmih004
               AND xmii006 = g_xmii2_d[l_ac].xmii006
               AND xmii007 = g_xmii2_d[l_ac].xmii007
               AND xmii008 = g_xmii2_d[l_ac].xmii008
               AND xmii009 = g_xmii2_d[l_ac].xmii009
               AND xmii010 = g_xmii2_d[l_ac].xmii010
               AND xmii011 = g_xmii2_d[l_ac].xmii011
               AND xmii012 = g_xmii2_d[l_ac].xmii012
               AND xmii013 = g_xmii2_d[l_ac].xmii013
               AND xmii014 = g_xmii2_d[l_ac].xmii014
               AND xmii017 = g_xmii2_d[l_ac].xmii017
                
            #資料未重複, 插入新增資料
            IF l_count = 0 THEN 
               #add-point:單身2新增前
               {<point name="input.body2.b_insert"/>}
               #end add-point
            
                              INITIALIZE gs_keys TO NULL 
               LET gs_keys[1] = g_xmih_m.xmih001
               LET gs_keys[2] = g_xmih_m.xmih002
               LET gs_keys[3] = g_xmih_m.xmih003
               LET gs_keys[4] = g_xmih_m.xmih004
               LET gs_keys[5] = g_xmii2_d[g_detail_idx].xmii006
               LET gs_keys[6] = g_xmii2_d[g_detail_idx].xmii007
               LET gs_keys[7] = g_xmii2_d[g_detail_idx].xmii008
               LET gs_keys[8] = g_xmii2_d[g_detail_idx].xmii009
               LET gs_keys[9] = g_xmii2_d[g_detail_idx].xmii010
               LET gs_keys[10] = g_xmii2_d[g_detail_idx].xmii011
               LET gs_keys[11] = g_xmii2_d[g_detail_idx].xmii012
               LET gs_keys[12] = g_xmii2_d[g_detail_idx].xmii013
               LET gs_keys[13] = g_xmii2_d[g_detail_idx].xmii014
               LET gs_keys[14] = g_xmii2_d[g_detail_idx].xmii017
               CALL axmt175_insert_b('xmii_t',gs_keys,"'2'")
                           
               #add-point:單身新增後2
               {<point name="input.body2.a_insert"/>}
               #end add-point
            ELSE    
               CALL cl_err('INSERT',"std-00006",1)
               INITIALIZE g_xmii_d[l_ac].* TO NULL
               CALL s_transaction_end('N','0')
               CANCEL INSERT
            END IF
 
            IF SQLCA.SQLcode  THEN
               CALL cl_err("xmii_t",SQLCA.sqlcode,1)  
               CALL s_transaction_end('N','0')                    
               CANCEL INSERT
            ELSE
               #先刷新資料
               #CALL axmt175_b_fill()
               #資料多語言用-增/改
               
               #add-point:單身新增後
               {<point name="input.body2.after_insert"/>}
               #end add-point
               CALL s_transaction_end('Y','0')
               ERROR 'INSERT O.K'
               LET g_rec_b = g_rec_b + 1
            END IF
            
         ON ROW CHANGE 
            IF INT_FLAG THEN
               CALL cl_err('',9001,0)
               LET INT_FLAG = 0
               LET g_xmii2_d[l_ac].* = g_xmii2_d_t.*
               CLOSE axmt175_bcl
               CALL s_transaction_end('N','0')
               EXIT DIALOG 
            END IF
            
            IF l_lock_sw = 'Y' THEN
               CALL cl_err('',-263,1)
               LET g_xmii2_d[l_ac].* = g_xmii2_d_t.*
            ELSE
               #add-point:單身page2修改前
               {<point name="input.body2.b_update" mark="Y"/>}
               #end add-point
               
               #寫入修改者/修改日期資訊(單身2)
               
               
               UPDATE xmii_t SET (xmii001,xmii002,xmii003,xmii004,xmii005,xmii007,xmii006,xmii008,xmii012, 
                   xmii013,xmii011,xmii009,xmii010,xmii017,xmii014) = (g_xmih_m.xmih001,g_xmih_m.xmih002, 
                   g_xmih_m.xmih003,g_xmih_m.xmih004,g_xmii_d[l_ac].xmii005,g_xmii_d[l_ac].xmii007,g_xmii_d[l_ac].xmii006, 
                   g_xmii_d[l_ac].xmii008,g_xmii_d[l_ac].xmii012,g_xmii_d[l_ac].xmii013,g_xmii_d[l_ac].xmii011, 
                   g_xmii_d[l_ac].xmii009,g_xmii_d[l_ac].xmii010,g_xmii_d[l_ac].xmii017,g_xmii_d[l_ac].xmii014)  
                   #自訂欄位頁簽
                WHERE xmiient = g_enterprise AND xmii001 = g_xmih_m.xmih001
                  AND xmii002 = g_xmih_m.xmih002
                  AND xmii003 = g_xmih_m.xmih003
                  AND xmii004 = g_xmih_m.xmih004
                  AND xmii006 = g_xmii2_d_t.xmii006 #項次 
                  AND xmii007 = g_xmii2_d_t.xmii007
                  AND xmii008 = g_xmii2_d_t.xmii008
                  AND xmii009 = g_xmii2_d_t.xmii009
                  AND xmii010 = g_xmii2_d_t.xmii010
                  AND xmii011 = g_xmii2_d_t.xmii011
                  AND xmii012 = g_xmii2_d_t.xmii012
                  AND xmii013 = g_xmii2_d_t.xmii013
                  AND xmii014 = g_xmii2_d_t.xmii014
                  AND xmii017 = g_xmii2_d_t.xmii017
                  
               #add-point:單身page2修改中
               {<point name="input.body2.m_update"/>}
               #end add-point
                  
               CASE
                  WHEN SQLCA.sqlerrd[3] = 0  #更新不到的處理
                     CALL cl_err("xmii_t","std-00009",1)
                     CALL s_transaction_end('N','0')
                     LET g_xmii2_d[l_ac].* = g_xmii2_d_t.*
                  WHEN SQLCA.sqlcode #其他錯誤
                     CALL cl_err("xmii_t",SQLCA.sqlcode,1)  
                     CALL s_transaction_end('N','0')
                     LET g_xmii2_d[l_ac].* = g_xmii2_d_t.*
                  OTHERWISE
                                    INITIALIZE gs_keys TO NULL 
               LET gs_keys[1] = g_xmih_m.xmih001
               LET gs_keys_bak[1] = g_xmih001_t
               LET gs_keys[2] = g_xmih_m.xmih002
               LET gs_keys_bak[2] = g_xmih002_t
               LET gs_keys[3] = g_xmih_m.xmih003
               LET gs_keys_bak[3] = g_xmih003_t
               LET gs_keys[4] = g_xmih_m.xmih004
               LET gs_keys_bak[4] = g_xmih004_t
               LET gs_keys[5] = g_xmii2_d[g_detail_idx].xmii006
               LET gs_keys_bak[5] = g_xmii2_d_t.xmii006
               LET gs_keys[6] = g_xmii2_d[g_detail_idx].xmii007
               LET gs_keys_bak[6] = g_xmii2_d_t.xmii007
               LET gs_keys[7] = g_xmii2_d[g_detail_idx].xmii008
               LET gs_keys_bak[7] = g_xmii2_d_t.xmii008
               LET gs_keys[8] = g_xmii2_d[g_detail_idx].xmii009
               LET gs_keys_bak[8] = g_xmii2_d_t.xmii009
               LET gs_keys[9] = g_xmii2_d[g_detail_idx].xmii010
               LET gs_keys_bak[9] = g_xmii2_d_t.xmii010
               LET gs_keys[10] = g_xmii2_d[g_detail_idx].xmii011
               LET gs_keys_bak[10] = g_xmii2_d_t.xmii011
               LET gs_keys[11] = g_xmii2_d[g_detail_idx].xmii012
               LET gs_keys_bak[11] = g_xmii2_d_t.xmii012
               LET gs_keys[12] = g_xmii2_d[g_detail_idx].xmii013
               LET gs_keys_bak[12] = g_xmii2_d_t.xmii013
               LET gs_keys[13] = g_xmii2_d[g_detail_idx].xmii014
               LET gs_keys_bak[13] = g_xmii2_d_t.xmii014
               LET gs_keys[14] = g_xmii2_d[g_detail_idx].xmii017
               LET gs_keys_bak[14] = g_xmii2_d_t.xmii017
               CALL axmt175_update_b('xmii_t',gs_keys,gs_keys_bak,"'2'")
                     #資料多語言用-增/改
                     
               END CASE
			   
               #修改歷程記錄
               LET g_log1 = util.JSON.stringify(g_xmih_m),util.JSON.stringify(g_xmii2_d_t)
               LET g_log2 = util.JSON.stringify(g_xmih_m),util.JSON.stringify(g_xmii2_d[l_ac])
               IF NOT cl_log_modified_record(g_log1,g_log2) THEN 
                  CALL s_transaction_end('N','0')
               END IF
               
               #add-point:單身page2修改後
               {<point name="input.body2.a_update"/>}
               #end add-point
            END IF
         
                  #此段落由子樣板a01產生
         BEFORE FIELD l_xmii023_01
            #add-point:BEFORE FIELD l_xmii023_01
            {<point name="input.b.page2.l_xmii023_01" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii023_01
            
            #add-point:AFTER FIELD l_xmii023_01
            {<point name="input.a.page2.l_xmii023_01" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii023_01
            #add-point:ON CHANGE l_xmii023_01
            {<point name="input.g.page2.l_xmii023_01" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii023_02
            #add-point:BEFORE FIELD l_xmii023_02
            {<point name="input.b.page2.l_xmii023_02" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii023_02
            
            #add-point:AFTER FIELD l_xmii023_02
            {<point name="input.a.page2.l_xmii023_02" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii023_02
            #add-point:ON CHANGE l_xmii023_02
            {<point name="input.g.page2.l_xmii023_02" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii023_03
            #add-point:BEFORE FIELD l_xmii023_03
            {<point name="input.b.page2.l_xmii023_03" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii023_03
            
            #add-point:AFTER FIELD l_xmii023_03
            {<point name="input.a.page2.l_xmii023_03" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii023_03
            #add-point:ON CHANGE l_xmii023_03
            {<point name="input.g.page2.l_xmii023_03" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii023_04
            #add-point:BEFORE FIELD l_xmii023_04
            {<point name="input.b.page2.l_xmii023_04" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii023_04
            
            #add-point:AFTER FIELD l_xmii023_04
            {<point name="input.a.page2.l_xmii023_04" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii023_04
            #add-point:ON CHANGE l_xmii023_04
            {<point name="input.g.page2.l_xmii023_04" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii023_05
            #add-point:BEFORE FIELD l_xmii023_05
            {<point name="input.b.page2.l_xmii023_05" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii023_05
            
            #add-point:AFTER FIELD l_xmii023_05
            {<point name="input.a.page2.l_xmii023_05" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii023_05
            #add-point:ON CHANGE l_xmii023_05
            {<point name="input.g.page2.l_xmii023_05" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii023_06
            #add-point:BEFORE FIELD l_xmii023_06
            {<point name="input.b.page2.l_xmii023_06" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii023_06
            
            #add-point:AFTER FIELD l_xmii023_06
            {<point name="input.a.page2.l_xmii023_06" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii023_06
            #add-point:ON CHANGE l_xmii023_06
            {<point name="input.g.page2.l_xmii023_06" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii023_07
            #add-point:BEFORE FIELD l_xmii023_07
            {<point name="input.b.page2.l_xmii023_07" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii023_07
            
            #add-point:AFTER FIELD l_xmii023_07
            {<point name="input.a.page2.l_xmii023_07" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii023_07
            #add-point:ON CHANGE l_xmii023_07
            {<point name="input.g.page2.l_xmii023_07" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii023_08
            #add-point:BEFORE FIELD l_xmii023_08
            {<point name="input.b.page2.l_xmii023_08" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii023_08
            
            #add-point:AFTER FIELD l_xmii023_08
            {<point name="input.a.page2.l_xmii023_08" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii023_08
            #add-point:ON CHANGE l_xmii023_08
            {<point name="input.g.page2.l_xmii023_08" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii023_09
            #add-point:BEFORE FIELD l_xmii023_09
            {<point name="input.b.page2.l_xmii023_09" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii023_09
            
            #add-point:AFTER FIELD l_xmii023_09
            {<point name="input.a.page2.l_xmii023_09" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii023_09
            #add-point:ON CHANGE l_xmii023_09
            {<point name="input.g.page2.l_xmii023_09" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii023_10
            #add-point:BEFORE FIELD l_xmii023_10
            {<point name="input.b.page2.l_xmii023_10" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii023_10
            
            #add-point:AFTER FIELD l_xmii023_10
            {<point name="input.a.page2.l_xmii023_10" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii023_10
            #add-point:ON CHANGE l_xmii023_10
            {<point name="input.g.page2.l_xmii023_10" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii023_11
            #add-point:BEFORE FIELD l_xmii023_11
            {<point name="input.b.page2.l_xmii023_11" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii023_11
            
            #add-point:AFTER FIELD l_xmii023_11
            {<point name="input.a.page2.l_xmii023_11" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii023_11
            #add-point:ON CHANGE l_xmii023_11
            {<point name="input.g.page2.l_xmii023_11" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii023_12
            #add-point:BEFORE FIELD l_xmii023_12
            {<point name="input.b.page2.l_xmii023_12" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii023_12
            
            #add-point:AFTER FIELD l_xmii023_12
            {<point name="input.a.page2.l_xmii023_12" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii023_12
            #add-point:ON CHANGE l_xmii023_12
            {<point name="input.g.page2.l_xmii023_12" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii023_13
            #add-point:BEFORE FIELD l_xmii023_13
            {<point name="input.b.page2.l_xmii023_13" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii023_13
            
            #add-point:AFTER FIELD l_xmii023_13
            {<point name="input.a.page2.l_xmii023_13" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii023_13
            #add-point:ON CHANGE l_xmii023_13
            {<point name="input.g.page2.l_xmii023_13" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii023_14
            #add-point:BEFORE FIELD l_xmii023_14
            {<point name="input.b.page2.l_xmii023_14" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii023_14
            
            #add-point:AFTER FIELD l_xmii023_14
            {<point name="input.a.page2.l_xmii023_14" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii023_14
            #add-point:ON CHANGE l_xmii023_14
            {<point name="input.g.page2.l_xmii023_14" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii023_15
            #add-point:BEFORE FIELD l_xmii023_15
            {<point name="input.b.page2.l_xmii023_15" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii023_15
            
            #add-point:AFTER FIELD l_xmii023_15
            {<point name="input.a.page2.l_xmii023_15" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii023_15
            #add-point:ON CHANGE l_xmii023_15
            {<point name="input.g.page2.l_xmii023_15" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii023_16
            #add-point:BEFORE FIELD l_xmii023_16
            {<point name="input.b.page2.l_xmii023_16" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii023_16
            
            #add-point:AFTER FIELD l_xmii023_16
            {<point name="input.a.page2.l_xmii023_16" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii023_16
            #add-point:ON CHANGE l_xmii023_16
            {<point name="input.g.page2.l_xmii023_16" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii023_17
            #add-point:BEFORE FIELD l_xmii023_17
            {<point name="input.b.page2.l_xmii023_17" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii023_17
            
            #add-point:AFTER FIELD l_xmii023_17
            {<point name="input.a.page2.l_xmii023_17" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii023_17
            #add-point:ON CHANGE l_xmii023_17
            {<point name="input.g.page2.l_xmii023_17" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii023_18
            #add-point:BEFORE FIELD l_xmii023_18
            {<point name="input.b.page2.l_xmii023_18" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii023_18
            
            #add-point:AFTER FIELD l_xmii023_18
            {<point name="input.a.page2.l_xmii023_18" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii023_18
            #add-point:ON CHANGE l_xmii023_18
            {<point name="input.g.page2.l_xmii023_18" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii023_19
            #add-point:BEFORE FIELD l_xmii023_19
            {<point name="input.b.page2.l_xmii023_19" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii023_19
            
            #add-point:AFTER FIELD l_xmii023_19
            {<point name="input.a.page2.l_xmii023_19" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii023_19
            #add-point:ON CHANGE l_xmii023_19
            {<point name="input.g.page2.l_xmii023_19" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii023_20
            #add-point:BEFORE FIELD l_xmii023_20
            {<point name="input.b.page2.l_xmii023_20" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii023_20
            
            #add-point:AFTER FIELD l_xmii023_20
            {<point name="input.a.page2.l_xmii023_20" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii023_20
            #add-point:ON CHANGE l_xmii023_20
            {<point name="input.g.page2.l_xmii023_20" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii023_21
            #add-point:BEFORE FIELD l_xmii023_21
            {<point name="input.b.page2.l_xmii023_21" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii023_21
            
            #add-point:AFTER FIELD l_xmii023_21
            {<point name="input.a.page2.l_xmii023_21" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii023_21
            #add-point:ON CHANGE l_xmii023_21
            {<point name="input.g.page2.l_xmii023_21" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii023_22
            #add-point:BEFORE FIELD l_xmii023_22
            {<point name="input.b.page2.l_xmii023_22" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii023_22
            
            #add-point:AFTER FIELD l_xmii023_22
            {<point name="input.a.page2.l_xmii023_22" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii023_22
            #add-point:ON CHANGE l_xmii023_22
            {<point name="input.g.page2.l_xmii023_22" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii023_23
            #add-point:BEFORE FIELD l_xmii023_23
            {<point name="input.b.page2.l_xmii023_23" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii023_23
            
            #add-point:AFTER FIELD l_xmii023_23
            {<point name="input.a.page2.l_xmii023_23" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii023_23
            #add-point:ON CHANGE l_xmii023_23
            {<point name="input.g.page2.l_xmii023_23" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii023_24
            #add-point:BEFORE FIELD l_xmii023_24
            {<point name="input.b.page2.l_xmii023_24" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii023_24
            
            #add-point:AFTER FIELD l_xmii023_24
            {<point name="input.a.page2.l_xmii023_24" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii023_24
            #add-point:ON CHANGE l_xmii023_24
            {<point name="input.g.page2.l_xmii023_24" />}
            #END add-point
 
 
                  #Ctrlp:input.c.page2.l_xmii023_01
         ON ACTION controlp INFIELD l_xmii023_01
            #add-point:ON ACTION controlp INFIELD l_xmii023_01
            {<point name="input.c.page2.l_xmii023_01" />}
            #END add-point
 
         #Ctrlp:input.c.page2.l_xmii023_02
         ON ACTION controlp INFIELD l_xmii023_02
            #add-point:ON ACTION controlp INFIELD l_xmii023_02
            {<point name="input.c.page2.l_xmii023_02" />}
            #END add-point
 
         #Ctrlp:input.c.page2.l_xmii023_03
         ON ACTION controlp INFIELD l_xmii023_03
            #add-point:ON ACTION controlp INFIELD l_xmii023_03
            {<point name="input.c.page2.l_xmii023_03" />}
            #END add-point
 
         #Ctrlp:input.c.page2.l_xmii023_04
         ON ACTION controlp INFIELD l_xmii023_04
            #add-point:ON ACTION controlp INFIELD l_xmii023_04
            {<point name="input.c.page2.l_xmii023_04" />}
            #END add-point
 
         #Ctrlp:input.c.page2.l_xmii023_05
         ON ACTION controlp INFIELD l_xmii023_05
            #add-point:ON ACTION controlp INFIELD l_xmii023_05
            {<point name="input.c.page2.l_xmii023_05" />}
            #END add-point
 
         #Ctrlp:input.c.page2.l_xmii023_06
         ON ACTION controlp INFIELD l_xmii023_06
            #add-point:ON ACTION controlp INFIELD l_xmii023_06
            {<point name="input.c.page2.l_xmii023_06" />}
            #END add-point
 
         #Ctrlp:input.c.page2.l_xmii023_07
         ON ACTION controlp INFIELD l_xmii023_07
            #add-point:ON ACTION controlp INFIELD l_xmii023_07
            {<point name="input.c.page2.l_xmii023_07" />}
            #END add-point
 
         #Ctrlp:input.c.page2.l_xmii023_08
         ON ACTION controlp INFIELD l_xmii023_08
            #add-point:ON ACTION controlp INFIELD l_xmii023_08
            {<point name="input.c.page2.l_xmii023_08" />}
            #END add-point
 
         #Ctrlp:input.c.page2.l_xmii023_09
         ON ACTION controlp INFIELD l_xmii023_09
            #add-point:ON ACTION controlp INFIELD l_xmii023_09
            {<point name="input.c.page2.l_xmii023_09" />}
            #END add-point
 
         #Ctrlp:input.c.page2.l_xmii023_10
         ON ACTION controlp INFIELD l_xmii023_10
            #add-point:ON ACTION controlp INFIELD l_xmii023_10
            {<point name="input.c.page2.l_xmii023_10" />}
            #END add-point
 
         #Ctrlp:input.c.page2.l_xmii023_11
         ON ACTION controlp INFIELD l_xmii023_11
            #add-point:ON ACTION controlp INFIELD l_xmii023_11
            {<point name="input.c.page2.l_xmii023_11" />}
            #END add-point
 
         #Ctrlp:input.c.page2.l_xmii023_12
         ON ACTION controlp INFIELD l_xmii023_12
            #add-point:ON ACTION controlp INFIELD l_xmii023_12
            {<point name="input.c.page2.l_xmii023_12" />}
            #END add-point
 
         #Ctrlp:input.c.page2.l_xmii023_13
         ON ACTION controlp INFIELD l_xmii023_13
            #add-point:ON ACTION controlp INFIELD l_xmii023_13
            {<point name="input.c.page2.l_xmii023_13" />}
            #END add-point
 
         #Ctrlp:input.c.page2.l_xmii023_14
         ON ACTION controlp INFIELD l_xmii023_14
            #add-point:ON ACTION controlp INFIELD l_xmii023_14
            {<point name="input.c.page2.l_xmii023_14" />}
            #END add-point
 
         #Ctrlp:input.c.page2.l_xmii023_15
         ON ACTION controlp INFIELD l_xmii023_15
            #add-point:ON ACTION controlp INFIELD l_xmii023_15
            {<point name="input.c.page2.l_xmii023_15" />}
            #END add-point
 
         #Ctrlp:input.c.page2.l_xmii023_16
         ON ACTION controlp INFIELD l_xmii023_16
            #add-point:ON ACTION controlp INFIELD l_xmii023_16
            {<point name="input.c.page2.l_xmii023_16" />}
            #END add-point
 
         #Ctrlp:input.c.page2.l_xmii023_17
         ON ACTION controlp INFIELD l_xmii023_17
            #add-point:ON ACTION controlp INFIELD l_xmii023_17
            {<point name="input.c.page2.l_xmii023_17" />}
            #END add-point
 
         #Ctrlp:input.c.page2.l_xmii023_18
         ON ACTION controlp INFIELD l_xmii023_18
            #add-point:ON ACTION controlp INFIELD l_xmii023_18
            {<point name="input.c.page2.l_xmii023_18" />}
            #END add-point
 
         #Ctrlp:input.c.page2.l_xmii023_19
         ON ACTION controlp INFIELD l_xmii023_19
            #add-point:ON ACTION controlp INFIELD l_xmii023_19
            {<point name="input.c.page2.l_xmii023_19" />}
            #END add-point
 
         #Ctrlp:input.c.page2.l_xmii023_20
         ON ACTION controlp INFIELD l_xmii023_20
            #add-point:ON ACTION controlp INFIELD l_xmii023_20
            {<point name="input.c.page2.l_xmii023_20" />}
            #END add-point
 
         #Ctrlp:input.c.page2.l_xmii023_21
         ON ACTION controlp INFIELD l_xmii023_21
            #add-point:ON ACTION controlp INFIELD l_xmii023_21
            {<point name="input.c.page2.l_xmii023_21" />}
            #END add-point
 
         #Ctrlp:input.c.page2.l_xmii023_22
         ON ACTION controlp INFIELD l_xmii023_22
            #add-point:ON ACTION controlp INFIELD l_xmii023_22
            {<point name="input.c.page2.l_xmii023_22" />}
            #END add-point
 
         #Ctrlp:input.c.page2.l_xmii023_23
         ON ACTION controlp INFIELD l_xmii023_23
            #add-point:ON ACTION controlp INFIELD l_xmii023_23
            {<point name="input.c.page2.l_xmii023_23" />}
            #END add-point
 
         #Ctrlp:input.c.page2.l_xmii023_24
         ON ACTION controlp INFIELD l_xmii023_24
            #add-point:ON ACTION controlp INFIELD l_xmii023_24
            {<point name="input.c.page2.l_xmii023_24" />}
            #END add-point
 
 
 
         AFTER ROW
            #add-point:單身page2 after_row
            {<point name="input.body2.after_row"/>}
            #end add-point
            LET l_ac = ARR_CURR()
            IF INT_FLAG THEN
               CALL cl_err('',9001,0)
               LET INT_FLAG = 0
               IF l_cmd = 'u' THEN
                  LET g_xmii2_d[l_ac].* = g_xmii2_d_t.*
               END IF
               CLOSE axmt175_bcl
               CALL s_transaction_end('N','0')
               EXIT DIALOG 
            END IF
            
            #其他table進行unlock
            
            CALL axmt175_unlock_b("xmii_t","'2'")
            CALL s_transaction_end('Y','0')
            #add-point:單身page2 after_row2
            {<point name="input.body2.after_row2"/>}
            #end add-point
 
         AFTER INPUT
            #add-point:input段after input 
            {<point name="input.body2.after_input"/>}
            #end add-point   
    
         ON ACTION controlo
            CALL FGL_SET_ARR_CURR(g_xmii2_d.getLength()+1)
            LET lb_reproduce = TRUE
            LET li_reproduce = l_ac
            LET li_reproduce_target = g_xmii2_d.getLength()+1
 
      END INPUT
      INPUT ARRAY g_xmii3_d FROM s_detail3.*
         ATTRIBUTE(COUNT = g_rec_b,MAXCOUNT = g_max_rec,WITHOUT DEFAULTS, 
                 INSERT ROW = FALSE, #此頁面insert功能由產生器控制, 手動之設定無效! 

                 DELETE ROW = l_allow_delete,
                 APPEND ROW = l_allow_insert)
                 
         #自訂ACTION(detail_input,page_3)
         
         
         BEFORE INPUT
            
            CALL axmt175_b_fill()
            LET g_rec_b = g_xmii3_d.getLength()
            #add-point:資料輸入前
            {<point name="input.body3.before_input"/>}
            #end add-point
            
         BEFORE INSERT
            LET g_insert = 'Y' 
            NEXT FIELD xmii006
 
            LET l_insert = TRUE
            LET l_n = ARR_COUNT()
            LET l_cmd = 'a'
            INITIALIZE g_xmii3_d[l_ac].* TO NULL 
            INITIALIZE g_xmii3_d_t.* TO NULL 
            INITIALIZE g_xmii3_d_o.* TO NULL 
            
            LET g_xmii3_d_t.* = g_xmii3_d[l_ac].*     #新輸入資料
            LET g_xmii3_d_o.* = g_xmii3_d[l_ac].*     #新輸入資料
            CALL cl_show_fld_cont()
            CALL axmt175_set_entry_b(l_cmd)
            #add-point:modify段after_set_entry_b
            {<point name="input.body3.insert.after_set_entry_b"/>}
            #end add-point
            CALL axmt175_set_no_entry_b(l_cmd)
            IF lb_reproduce THEN
               LET lb_reproduce = FALSE
               LET g_xmii_d[li_reproduce_target].* = g_xmii_d[li_reproduce].*
               LET g_xmii2_d[li_reproduce_target].* = g_xmii2_d[li_reproduce].*
               LET g_xmii3_d[li_reproduce_target].* = g_xmii3_d[li_reproduce].*
 
               LET g_xmii3_d[li_reproduce_target].xmii006 = NULL
               LET g_xmii3_d[li_reproduce_target].xmii007 = NULL
               LET g_xmii3_d[li_reproduce_target].xmii008 = NULL
               LET g_xmii3_d[li_reproduce_target].xmii009 = NULL
               LET g_xmii3_d[li_reproduce_target].xmii010 = NULL
               LET g_xmii3_d[li_reproduce_target].xmii011 = NULL
               LET g_xmii3_d[li_reproduce_target].xmii012 = NULL
               LET g_xmii3_d[li_reproduce_target].xmii013 = NULL
               LET g_xmii3_d[li_reproduce_target].xmii014 = NULL
               LET g_xmii3_d[li_reproduce_target].xmii017 = NULL
            END IF
            #公用欄位給值(單身3)
            
            
            #add-point:modify段before insert
            {<point name="input.body3.before_insert"/>}
            #end add-point  
            
         BEFORE ROW     
            #add-point:modify段before row2
            {<point name="input.body3.before_row2"/>}
            #end add-point  
            LET l_insert = FALSE
            LET l_cmd = ''
            LET l_ac = ARR_CURR()
            LET g_detail_idx = l_ac
              
            LET l_lock_sw = 'N'            #DEFAULT
            LET l_n = ARR_COUNT()
            DISPLAY l_ac TO FORMONLY.idx
         
            CALL s_transaction_begin()
            OPEN axmt175_cl USING g_enterprise,g_xmih_m.xmih001,g_xmih_m.xmih002,g_xmih_m.xmih003,g_xmih_m.xmih004
            IF STATUS THEN
               CALL cl_err("OPEN axmt175_cl:", STATUS, 1)
               CLOSE axmt175_cl
               CALL s_transaction_end('N','0')
               RETURN
            END IF
            
            LET g_rec_b = g_xmii3_d.getLength()
            
            IF g_rec_b >= l_ac 
               AND g_xmii3_d[l_ac].xmii006 IS NOT NULL
               AND g_xmii3_d[l_ac].xmii007 IS NOT NULL
               AND g_xmii3_d[l_ac].xmii008 IS NOT NULL
               AND g_xmii3_d[l_ac].xmii009 IS NOT NULL
               AND g_xmii3_d[l_ac].xmii010 IS NOT NULL
               AND g_xmii3_d[l_ac].xmii011 IS NOT NULL
               AND g_xmii3_d[l_ac].xmii012 IS NOT NULL
               AND g_xmii3_d[l_ac].xmii013 IS NOT NULL
               AND g_xmii3_d[l_ac].xmii014 IS NOT NULL
               AND g_xmii3_d[l_ac].xmii017 IS NOT NULL
            THEN 
               LET l_cmd='u'
               LET g_xmii3_d_t.* = g_xmii3_d[l_ac].*  #BACKUP
               LET g_xmii3_d_o.* = g_xmii3_d[l_ac].*  #BACKUP
               CALL axmt175_set_entry_b(l_cmd)
               #add-point:modify段after_set_entry_b
               {<point name="input.body3.after_set_entry_b"/>}
               #end add-point  
               CALL axmt175_set_no_entry_b(l_cmd)
               IF NOT axmt175_lock_b("xmii_t","'3'") THEN
                  LET l_lock_sw='Y'
               ELSE
                  FETCH axmt175_bcl INTO g_xmii_d[l_ac].xmii005,g_xmii_d[l_ac].xmii007,g_xmii_d[l_ac].xmii006, 
                      g_xmii_d[l_ac].xmii008,g_xmii_d[l_ac].xmii012,g_xmii_d[l_ac].xmii013,g_xmii_d[l_ac].xmii011, 
                      g_xmii_d[l_ac].xmii009,g_xmii_d[l_ac].xmii010,g_xmii_d[l_ac].xmii017,g_xmii_d[l_ac].xmii014, 
                      g_xmii2_d[l_ac].xmii005,g_xmii2_d[l_ac].xmii007,g_xmii2_d[l_ac].xmii006,g_xmii2_d[l_ac].xmii008, 
                      g_xmii2_d[l_ac].xmii012,g_xmii2_d[l_ac].xmii013,g_xmii2_d[l_ac].xmii011,g_xmii2_d[l_ac].xmii009, 
                      g_xmii2_d[l_ac].xmii010,g_xmii2_d[l_ac].xmii017,g_xmii2_d[l_ac].xmii014,g_xmii3_d[l_ac].xmii005, 
                      g_xmii3_d[l_ac].xmii007,g_xmii3_d[l_ac].xmii006,g_xmii3_d[l_ac].xmii008,g_xmii3_d[l_ac].xmii012, 
                      g_xmii3_d[l_ac].xmii013,g_xmii3_d[l_ac].xmii011,g_xmii3_d[l_ac].xmii009,g_xmii3_d[l_ac].xmii010, 
                      g_xmii3_d[l_ac].xmii017,g_xmii3_d[l_ac].xmii014
                  IF SQLCA.sqlcode THEN
                     CALL cl_err('',SQLCA.sqlcode,1)
                     LET l_lock_sw = "Y"
                  END IF
                  
                  LET g_bfill = "N"
                  CALL axmt175_show()
                  LET g_bfill = "Y"
                  
                  CALL cl_show_fld_cont()
               END IF
            ELSE
               LET l_cmd='a'
            END IF
            #add-point:modify段before row
            {<point name="input.body3.before_row"/>}
            #end add-point  
            #其他table資料備份(確定是否更改用)
            
            #其他table進行lock
            
            
         BEFORE DELETE                            #是否取消單身
            IF l_cmd = 'a' AND g_xmii3_d.getLength() < l_ac THEN
               CALL FGL_SET_ARR_CURR(l_ac-1)
               CALL g_xmii3_d.deleteElement(l_ac)
               NEXT FIELD xmii006
            END IF
         
            IF g_xmii3_d[l_ac].xmii006 IS NOT NULL
               AND g_xmii3_d_t.xmii007 IS NOT NULL
               AND g_xmii3_d_t.xmii008 IS NOT NULL
               AND g_xmii3_d_t.xmii009 IS NOT NULL
               AND g_xmii3_d_t.xmii010 IS NOT NULL
               AND g_xmii3_d_t.xmii011 IS NOT NULL
               AND g_xmii3_d_t.xmii012 IS NOT NULL
               AND g_xmii3_d_t.xmii013 IS NOT NULL
               AND g_xmii3_d_t.xmii014 IS NOT NULL
               AND g_xmii3_d_t.xmii017 IS NOT NULL
            THEN
               IF NOT cl_ask_del_detail() THEN
                  CANCEL DELETE
               END IF
               IF l_lock_sw = "Y" THEN
                  CALL cl_err("", -263, 1)
                  CANCEL DELETE
               END IF
               
               #add-point:單身3刪除前
               {<point name="input.body3.b_delete" mark="Y"/>}
               #end add-point    
               
               DELETE FROM xmii_t
                WHERE xmiient = g_enterprise AND xmii001 = g_xmih_m.xmih001 AND
                                          xmii002 = g_xmih_m.xmih002 AND
                                          xmii003 = g_xmih_m.xmih003 AND
                                          xmii004 = g_xmih_m.xmih004 AND
                      xmii006 = g_xmii3_d_t.xmii006
                  AND xmii007 = g_xmii3_d_t.xmii007
                  AND xmii008 = g_xmii3_d_t.xmii008
                  AND xmii009 = g_xmii3_d_t.xmii009
                  AND xmii010 = g_xmii3_d_t.xmii010
                  AND xmii011 = g_xmii3_d_t.xmii011
                  AND xmii012 = g_xmii3_d_t.xmii012
                  AND xmii013 = g_xmii3_d_t.xmii013
                  AND xmii014 = g_xmii3_d_t.xmii014
                  AND xmii017 = g_xmii3_d_t.xmii017
                  
               #add-point:單身3刪除中
               {<point name="input.body3.m_delete"/>}
               #end add-point    
                  
               IF SQLCA.sqlcode THEN
                  CALL cl_err("xmii_t",SQLCA.sqlcode,1)
                  CALL s_transaction_end('N','0')
                  CANCEL DELETE   
               ELSE
                  LET g_rec_b = g_rec_b-1
                  
                  #add-point:單身3刪除後
                  {<point name="input.body3.a_delete"/>}
                  #end add-point
                  CALL s_transaction_end('Y','0')
               END IF 
               CLOSE axmt175_bcl
               LET l_count = g_xmii_d.getLength()
            END IF 
            
                           INITIALIZE gs_keys TO NULL 
               LET gs_keys[1] = g_xmih_m.xmih001
               LET gs_keys[2] = g_xmih_m.xmih002
               LET gs_keys[3] = g_xmih_m.xmih003
               LET gs_keys[4] = g_xmih_m.xmih004
               LET gs_keys[5] = g_xmii3_d[g_detail_idx].xmii006
               LET gs_keys[6] = g_xmii3_d[g_detail_idx].xmii007
               LET gs_keys[7] = g_xmii3_d[g_detail_idx].xmii008
               LET gs_keys[8] = g_xmii3_d[g_detail_idx].xmii009
               LET gs_keys[9] = g_xmii3_d[g_detail_idx].xmii010
               LET gs_keys[10] = g_xmii3_d[g_detail_idx].xmii011
               LET gs_keys[11] = g_xmii3_d[g_detail_idx].xmii012
               LET gs_keys[12] = g_xmii3_d[g_detail_idx].xmii013
               LET gs_keys[13] = g_xmii3_d[g_detail_idx].xmii014
               LET gs_keys[14] = g_xmii3_d[g_detail_idx].xmii017
 
            
         AFTER DELETE 
            #add-point:單身AFTER DELETE 
            {<point name="input.body3.after_delete"/>}
            #end add-point
                           CALL axmt175_delete_b('xmii_t',gs_keys,"'3'")
 
         AFTER INSERT    
            LET l_insert = FALSE
            IF INT_FLAG THEN
               CALL cl_err('',9001,0)
               LET INT_FLAG = 0
               CANCEL INSERT
            END IF
               
            #add-point:單身3新增前
            {<point name="input.body3.b_a_insert"/>}
            #end add-point
               
            LET l_count = 1  
            SELECT COUNT(*) INTO l_count FROM xmii_t 
             WHERE xmiient = g_enterprise AND xmii001 = g_xmih_m.xmih001
               AND xmii002 = g_xmih_m.xmih002
               AND xmii003 = g_xmih_m.xmih003
               AND xmii004 = g_xmih_m.xmih004
               AND xmii006 = g_xmii3_d[l_ac].xmii006
               AND xmii007 = g_xmii3_d[l_ac].xmii007
               AND xmii008 = g_xmii3_d[l_ac].xmii008
               AND xmii009 = g_xmii3_d[l_ac].xmii009
               AND xmii010 = g_xmii3_d[l_ac].xmii010
               AND xmii011 = g_xmii3_d[l_ac].xmii011
               AND xmii012 = g_xmii3_d[l_ac].xmii012
               AND xmii013 = g_xmii3_d[l_ac].xmii013
               AND xmii014 = g_xmii3_d[l_ac].xmii014
               AND xmii017 = g_xmii3_d[l_ac].xmii017
                
            #資料未重複, 插入新增資料
            IF l_count = 0 THEN 
               #add-point:單身3新增前
               {<point name="input.body3.b_insert"/>}
               #end add-point
            
                              INITIALIZE gs_keys TO NULL 
               LET gs_keys[1] = g_xmih_m.xmih001
               LET gs_keys[2] = g_xmih_m.xmih002
               LET gs_keys[3] = g_xmih_m.xmih003
               LET gs_keys[4] = g_xmih_m.xmih004
               LET gs_keys[5] = g_xmii3_d[g_detail_idx].xmii006
               LET gs_keys[6] = g_xmii3_d[g_detail_idx].xmii007
               LET gs_keys[7] = g_xmii3_d[g_detail_idx].xmii008
               LET gs_keys[8] = g_xmii3_d[g_detail_idx].xmii009
               LET gs_keys[9] = g_xmii3_d[g_detail_idx].xmii010
               LET gs_keys[10] = g_xmii3_d[g_detail_idx].xmii011
               LET gs_keys[11] = g_xmii3_d[g_detail_idx].xmii012
               LET gs_keys[12] = g_xmii3_d[g_detail_idx].xmii013
               LET gs_keys[13] = g_xmii3_d[g_detail_idx].xmii014
               LET gs_keys[14] = g_xmii3_d[g_detail_idx].xmii017
               CALL axmt175_insert_b('xmii_t',gs_keys,"'3'")
                           
               #add-point:單身新增後3
               {<point name="input.body3.a_insert"/>}
               #end add-point
            ELSE    
               CALL cl_err('INSERT',"std-00006",1)
               INITIALIZE g_xmii_d[l_ac].* TO NULL
               CALL s_transaction_end('N','0')
               CANCEL INSERT
            END IF
 
            IF SQLCA.SQLcode  THEN
               CALL cl_err("xmii_t",SQLCA.sqlcode,1)  
               CALL s_transaction_end('N','0')                    
               CANCEL INSERT
            ELSE
               #先刷新資料
               #CALL axmt175_b_fill()
               #資料多語言用-增/改
               
               #add-point:單身新增後
               {<point name="input.body3.after_insert"/>}
               #end add-point
               CALL s_transaction_end('Y','0')
               ERROR 'INSERT O.K'
               LET g_rec_b = g_rec_b + 1
            END IF
            
         ON ROW CHANGE 
            IF INT_FLAG THEN
               CALL cl_err('',9001,0)
               LET INT_FLAG = 0
               LET g_xmii3_d[l_ac].* = g_xmii3_d_t.*
               CLOSE axmt175_bcl
               CALL s_transaction_end('N','0')
               EXIT DIALOG 
            END IF
            
            IF l_lock_sw = 'Y' THEN
               CALL cl_err('',-263,1)
               LET g_xmii3_d[l_ac].* = g_xmii3_d_t.*
            ELSE
               #add-point:單身page3修改前
               {<point name="input.body3.b_update" mark="Y"/>}
               #end add-point
               
               #寫入修改者/修改日期資訊(單身3)
               
               
               UPDATE xmii_t SET (xmii001,xmii002,xmii003,xmii004,xmii005,xmii007,xmii006,xmii008,xmii012, 
                   xmii013,xmii011,xmii009,xmii010,xmii017,xmii014) = (g_xmih_m.xmih001,g_xmih_m.xmih002, 
                   g_xmih_m.xmih003,g_xmih_m.xmih004,g_xmii_d[l_ac].xmii005,g_xmii_d[l_ac].xmii007,g_xmii_d[l_ac].xmii006, 
                   g_xmii_d[l_ac].xmii008,g_xmii_d[l_ac].xmii012,g_xmii_d[l_ac].xmii013,g_xmii_d[l_ac].xmii011, 
                   g_xmii_d[l_ac].xmii009,g_xmii_d[l_ac].xmii010,g_xmii_d[l_ac].xmii017,g_xmii_d[l_ac].xmii014)  
                   #自訂欄位頁簽
                WHERE xmiient = g_enterprise AND xmii001 = g_xmih_m.xmih001
                  AND xmii002 = g_xmih_m.xmih002
                  AND xmii003 = g_xmih_m.xmih003
                  AND xmii004 = g_xmih_m.xmih004
                  AND xmii006 = g_xmii3_d_t.xmii006 #項次 
                  AND xmii007 = g_xmii3_d_t.xmii007
                  AND xmii008 = g_xmii3_d_t.xmii008
                  AND xmii009 = g_xmii3_d_t.xmii009
                  AND xmii010 = g_xmii3_d_t.xmii010
                  AND xmii011 = g_xmii3_d_t.xmii011
                  AND xmii012 = g_xmii3_d_t.xmii012
                  AND xmii013 = g_xmii3_d_t.xmii013
                  AND xmii014 = g_xmii3_d_t.xmii014
                  AND xmii017 = g_xmii3_d_t.xmii017
                  
               #add-point:單身page3修改中
               {<point name="input.body3.m_update"/>}
               #end add-point
                  
               CASE
                  WHEN SQLCA.sqlerrd[3] = 0  #更新不到的處理
                     CALL cl_err("xmii_t","std-00009",1)
                     CALL s_transaction_end('N','0')
                     LET g_xmii3_d[l_ac].* = g_xmii3_d_t.*
                  WHEN SQLCA.sqlcode #其他錯誤
                     CALL cl_err("xmii_t",SQLCA.sqlcode,1)  
                     CALL s_transaction_end('N','0')
                     LET g_xmii3_d[l_ac].* = g_xmii3_d_t.*
                  OTHERWISE
                                    INITIALIZE gs_keys TO NULL 
               LET gs_keys[1] = g_xmih_m.xmih001
               LET gs_keys_bak[1] = g_xmih001_t
               LET gs_keys[2] = g_xmih_m.xmih002
               LET gs_keys_bak[2] = g_xmih002_t
               LET gs_keys[3] = g_xmih_m.xmih003
               LET gs_keys_bak[3] = g_xmih003_t
               LET gs_keys[4] = g_xmih_m.xmih004
               LET gs_keys_bak[4] = g_xmih004_t
               LET gs_keys[5] = g_xmii3_d[g_detail_idx].xmii006
               LET gs_keys_bak[5] = g_xmii3_d_t.xmii006
               LET gs_keys[6] = g_xmii3_d[g_detail_idx].xmii007
               LET gs_keys_bak[6] = g_xmii3_d_t.xmii007
               LET gs_keys[7] = g_xmii3_d[g_detail_idx].xmii008
               LET gs_keys_bak[7] = g_xmii3_d_t.xmii008
               LET gs_keys[8] = g_xmii3_d[g_detail_idx].xmii009
               LET gs_keys_bak[8] = g_xmii3_d_t.xmii009
               LET gs_keys[9] = g_xmii3_d[g_detail_idx].xmii010
               LET gs_keys_bak[9] = g_xmii3_d_t.xmii010
               LET gs_keys[10] = g_xmii3_d[g_detail_idx].xmii011
               LET gs_keys_bak[10] = g_xmii3_d_t.xmii011
               LET gs_keys[11] = g_xmii3_d[g_detail_idx].xmii012
               LET gs_keys_bak[11] = g_xmii3_d_t.xmii012
               LET gs_keys[12] = g_xmii3_d[g_detail_idx].xmii013
               LET gs_keys_bak[12] = g_xmii3_d_t.xmii013
               LET gs_keys[13] = g_xmii3_d[g_detail_idx].xmii014
               LET gs_keys_bak[13] = g_xmii3_d_t.xmii014
               LET gs_keys[14] = g_xmii3_d[g_detail_idx].xmii017
               LET gs_keys_bak[14] = g_xmii3_d_t.xmii017
               CALL axmt175_update_b('xmii_t',gs_keys,gs_keys_bak,"'3'")
                     #資料多語言用-增/改
                     
               END CASE
			   
               #修改歷程記錄
               LET g_log1 = util.JSON.stringify(g_xmih_m),util.JSON.stringify(g_xmii3_d_t)
               LET g_log2 = util.JSON.stringify(g_xmih_m),util.JSON.stringify(g_xmii3_d[l_ac])
               IF NOT cl_log_modified_record(g_log1,g_log2) THEN 
                  CALL s_transaction_end('N','0')
               END IF
               
               #add-point:單身page3修改後
               {<point name="input.body3.a_update"/>}
               #end add-point
            END IF
         
                  #此段落由子樣板a01產生
         BEFORE FIELD l_xmii018_3_01
            #add-point:BEFORE FIELD l_xmii018_3_01
            {<point name="input.b.page3.l_xmii018_3_01" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii018_3_01
            
            #add-point:AFTER FIELD l_xmii018_3_01
            {<point name="input.a.page3.l_xmii018_3_01" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii018_3_01
            #add-point:ON CHANGE l_xmii018_3_01
            {<point name="input.g.page3.l_xmii018_3_01" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii019_3_01
            #add-point:BEFORE FIELD l_xmii019_3_01
            {<point name="input.b.page3.l_xmii019_3_01" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii019_3_01
            
            #add-point:AFTER FIELD l_xmii019_3_01
            {<point name="input.a.page3.l_xmii019_3_01" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii019_3_01
            #add-point:ON CHANGE l_xmii019_3_01
            {<point name="input.g.page3.l_xmii019_3_01" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii018_3_02
            #add-point:BEFORE FIELD l_xmii018_3_02
            {<point name="input.b.page3.l_xmii018_3_02" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii018_3_02
            
            #add-point:AFTER FIELD l_xmii018_3_02
            {<point name="input.a.page3.l_xmii018_3_02" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii018_3_02
            #add-point:ON CHANGE l_xmii018_3_02
            {<point name="input.g.page3.l_xmii018_3_02" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii019_3_02
            #add-point:BEFORE FIELD l_xmii019_3_02
            {<point name="input.b.page3.l_xmii019_3_02" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii019_3_02
            
            #add-point:AFTER FIELD l_xmii019_3_02
            {<point name="input.a.page3.l_xmii019_3_02" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii019_3_02
            #add-point:ON CHANGE l_xmii019_3_02
            {<point name="input.g.page3.l_xmii019_3_02" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii018_3_03
            #add-point:BEFORE FIELD l_xmii018_3_03
            {<point name="input.b.page3.l_xmii018_3_03" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii018_3_03
            
            #add-point:AFTER FIELD l_xmii018_3_03
            {<point name="input.a.page3.l_xmii018_3_03" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii018_3_03
            #add-point:ON CHANGE l_xmii018_3_03
            {<point name="input.g.page3.l_xmii018_3_03" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii019_3_03
            #add-point:BEFORE FIELD l_xmii019_3_03
            {<point name="input.b.page3.l_xmii019_3_03" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii019_3_03
            
            #add-point:AFTER FIELD l_xmii019_3_03
            {<point name="input.a.page3.l_xmii019_3_03" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii019_3_03
            #add-point:ON CHANGE l_xmii019_3_03
            {<point name="input.g.page3.l_xmii019_3_03" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii018_3_04
            #add-point:BEFORE FIELD l_xmii018_3_04
            {<point name="input.b.page3.l_xmii018_3_04" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii018_3_04
            
            #add-point:AFTER FIELD l_xmii018_3_04
            {<point name="input.a.page3.l_xmii018_3_04" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii018_3_04
            #add-point:ON CHANGE l_xmii018_3_04
            {<point name="input.g.page3.l_xmii018_3_04" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii019_3_04
            #add-point:BEFORE FIELD l_xmii019_3_04
            {<point name="input.b.page3.l_xmii019_3_04" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii019_3_04
            
            #add-point:AFTER FIELD l_xmii019_3_04
            {<point name="input.a.page3.l_xmii019_3_04" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii019_3_04
            #add-point:ON CHANGE l_xmii019_3_04
            {<point name="input.g.page3.l_xmii019_3_04" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii018_3_05
            #add-point:BEFORE FIELD l_xmii018_3_05
            {<point name="input.b.page3.l_xmii018_3_05" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii018_3_05
            
            #add-point:AFTER FIELD l_xmii018_3_05
            {<point name="input.a.page3.l_xmii018_3_05" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii018_3_05
            #add-point:ON CHANGE l_xmii018_3_05
            {<point name="input.g.page3.l_xmii018_3_05" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii019_3_05
            #add-point:BEFORE FIELD l_xmii019_3_05
            {<point name="input.b.page3.l_xmii019_3_05" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii019_3_05
            
            #add-point:AFTER FIELD l_xmii019_3_05
            {<point name="input.a.page3.l_xmii019_3_05" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii019_3_05
            #add-point:ON CHANGE l_xmii019_3_05
            {<point name="input.g.page3.l_xmii019_3_05" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii018_3_06
            #add-point:BEFORE FIELD l_xmii018_3_06
            {<point name="input.b.page3.l_xmii018_3_06" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii018_3_06
            
            #add-point:AFTER FIELD l_xmii018_3_06
            {<point name="input.a.page3.l_xmii018_3_06" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii018_3_06
            #add-point:ON CHANGE l_xmii018_3_06
            {<point name="input.g.page3.l_xmii018_3_06" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii019_3_06
            #add-point:BEFORE FIELD l_xmii019_3_06
            {<point name="input.b.page3.l_xmii019_3_06" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii019_3_06
            
            #add-point:AFTER FIELD l_xmii019_3_06
            {<point name="input.a.page3.l_xmii019_3_06" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii019_3_06
            #add-point:ON CHANGE l_xmii019_3_06
            {<point name="input.g.page3.l_xmii019_3_06" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii018_3_07
            #add-point:BEFORE FIELD l_xmii018_3_07
            {<point name="input.b.page3.l_xmii018_3_07" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii018_3_07
            
            #add-point:AFTER FIELD l_xmii018_3_07
            {<point name="input.a.page3.l_xmii018_3_07" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii018_3_07
            #add-point:ON CHANGE l_xmii018_3_07
            {<point name="input.g.page3.l_xmii018_3_07" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii019_3_07
            #add-point:BEFORE FIELD l_xmii019_3_07
            {<point name="input.b.page3.l_xmii019_3_07" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii019_3_07
            
            #add-point:AFTER FIELD l_xmii019_3_07
            {<point name="input.a.page3.l_xmii019_3_07" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii019_3_07
            #add-point:ON CHANGE l_xmii019_3_07
            {<point name="input.g.page3.l_xmii019_3_07" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii018_3_08
            #add-point:BEFORE FIELD l_xmii018_3_08
            {<point name="input.b.page3.l_xmii018_3_08" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii018_3_08
            
            #add-point:AFTER FIELD l_xmii018_3_08
            {<point name="input.a.page3.l_xmii018_3_08" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii018_3_08
            #add-point:ON CHANGE l_xmii018_3_08
            {<point name="input.g.page3.l_xmii018_3_08" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii019_3_08
            #add-point:BEFORE FIELD l_xmii019_3_08
            {<point name="input.b.page3.l_xmii019_3_08" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii019_3_08
            
            #add-point:AFTER FIELD l_xmii019_3_08
            {<point name="input.a.page3.l_xmii019_3_08" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii019_3_08
            #add-point:ON CHANGE l_xmii019_3_08
            {<point name="input.g.page3.l_xmii019_3_08" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii018_3_09
            #add-point:BEFORE FIELD l_xmii018_3_09
            {<point name="input.b.page3.l_xmii018_3_09" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii018_3_09
            
            #add-point:AFTER FIELD l_xmii018_3_09
            {<point name="input.a.page3.l_xmii018_3_09" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii018_3_09
            #add-point:ON CHANGE l_xmii018_3_09
            {<point name="input.g.page3.l_xmii018_3_09" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii019_3_09
            #add-point:BEFORE FIELD l_xmii019_3_09
            {<point name="input.b.page3.l_xmii019_3_09" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii019_3_09
            
            #add-point:AFTER FIELD l_xmii019_3_09
            {<point name="input.a.page3.l_xmii019_3_09" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii019_3_09
            #add-point:ON CHANGE l_xmii019_3_09
            {<point name="input.g.page3.l_xmii019_3_09" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii018_3_10
            #add-point:BEFORE FIELD l_xmii018_3_10
            {<point name="input.b.page3.l_xmii018_3_10" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii018_3_10
            
            #add-point:AFTER FIELD l_xmii018_3_10
            {<point name="input.a.page3.l_xmii018_3_10" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii018_3_10
            #add-point:ON CHANGE l_xmii018_3_10
            {<point name="input.g.page3.l_xmii018_3_10" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii019_3_10
            #add-point:BEFORE FIELD l_xmii019_3_10
            {<point name="input.b.page3.l_xmii019_3_10" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii019_3_10
            
            #add-point:AFTER FIELD l_xmii019_3_10
            {<point name="input.a.page3.l_xmii019_3_10" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii019_3_10
            #add-point:ON CHANGE l_xmii019_3_10
            {<point name="input.g.page3.l_xmii019_3_10" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii018_3_11
            #add-point:BEFORE FIELD l_xmii018_3_11
            {<point name="input.b.page3.l_xmii018_3_11" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii018_3_11
            
            #add-point:AFTER FIELD l_xmii018_3_11
            {<point name="input.a.page3.l_xmii018_3_11" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii018_3_11
            #add-point:ON CHANGE l_xmii018_3_11
            {<point name="input.g.page3.l_xmii018_3_11" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii019_3_11
            #add-point:BEFORE FIELD l_xmii019_3_11
            {<point name="input.b.page3.l_xmii019_3_11" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii019_3_11
            
            #add-point:AFTER FIELD l_xmii019_3_11
            {<point name="input.a.page3.l_xmii019_3_11" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii019_3_11
            #add-point:ON CHANGE l_xmii019_3_11
            {<point name="input.g.page3.l_xmii019_3_11" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii018_3_12
            #add-point:BEFORE FIELD l_xmii018_3_12
            {<point name="input.b.page3.l_xmii018_3_12" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii018_3_12
            
            #add-point:AFTER FIELD l_xmii018_3_12
            {<point name="input.a.page3.l_xmii018_3_12" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii018_3_12
            #add-point:ON CHANGE l_xmii018_3_12
            {<point name="input.g.page3.l_xmii018_3_12" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii019_3_12
            #add-point:BEFORE FIELD l_xmii019_3_12
            {<point name="input.b.page3.l_xmii019_3_12" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii019_3_12
            
            #add-point:AFTER FIELD l_xmii019_3_12
            {<point name="input.a.page3.l_xmii019_3_12" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii019_3_12
            #add-point:ON CHANGE l_xmii019_3_12
            {<point name="input.g.page3.l_xmii019_3_12" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii018_3_13
            #add-point:BEFORE FIELD l_xmii018_3_13
            {<point name="input.b.page3.l_xmii018_3_13" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii018_3_13
            
            #add-point:AFTER FIELD l_xmii018_3_13
            {<point name="input.a.page3.l_xmii018_3_13" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii018_3_13
            #add-point:ON CHANGE l_xmii018_3_13
            {<point name="input.g.page3.l_xmii018_3_13" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii019_3_13
            #add-point:BEFORE FIELD l_xmii019_3_13
            {<point name="input.b.page3.l_xmii019_3_13" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii019_3_13
            
            #add-point:AFTER FIELD l_xmii019_3_13
            {<point name="input.a.page3.l_xmii019_3_13" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii019_3_13
            #add-point:ON CHANGE l_xmii019_3_13
            {<point name="input.g.page3.l_xmii019_3_13" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii018_3_14
            #add-point:BEFORE FIELD l_xmii018_3_14
            {<point name="input.b.page3.l_xmii018_3_14" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii018_3_14
            
            #add-point:AFTER FIELD l_xmii018_3_14
            {<point name="input.a.page3.l_xmii018_3_14" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii018_3_14
            #add-point:ON CHANGE l_xmii018_3_14
            {<point name="input.g.page3.l_xmii018_3_14" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii019_3_14
            #add-point:BEFORE FIELD l_xmii019_3_14
            {<point name="input.b.page3.l_xmii019_3_14" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii019_3_14
            
            #add-point:AFTER FIELD l_xmii019_3_14
            {<point name="input.a.page3.l_xmii019_3_14" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii019_3_14
            #add-point:ON CHANGE l_xmii019_3_14
            {<point name="input.g.page3.l_xmii019_3_14" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii018_3_15
            #add-point:BEFORE FIELD l_xmii018_3_15
            {<point name="input.b.page3.l_xmii018_3_15" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii018_3_15
            
            #add-point:AFTER FIELD l_xmii018_3_15
            {<point name="input.a.page3.l_xmii018_3_15" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii018_3_15
            #add-point:ON CHANGE l_xmii018_3_15
            {<point name="input.g.page3.l_xmii018_3_15" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii019_3_15
            #add-point:BEFORE FIELD l_xmii019_3_15
            {<point name="input.b.page3.l_xmii019_3_15" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii019_3_15
            
            #add-point:AFTER FIELD l_xmii019_3_15
            {<point name="input.a.page3.l_xmii019_3_15" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii019_3_15
            #add-point:ON CHANGE l_xmii019_3_15
            {<point name="input.g.page3.l_xmii019_3_15" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii018_3_16
            #add-point:BEFORE FIELD l_xmii018_3_16
            {<point name="input.b.page3.l_xmii018_3_16" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii018_3_16
            
            #add-point:AFTER FIELD l_xmii018_3_16
            {<point name="input.a.page3.l_xmii018_3_16" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii018_3_16
            #add-point:ON CHANGE l_xmii018_3_16
            {<point name="input.g.page3.l_xmii018_3_16" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii019_3_16
            #add-point:BEFORE FIELD l_xmii019_3_16
            {<point name="input.b.page3.l_xmii019_3_16" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii019_3_16
            
            #add-point:AFTER FIELD l_xmii019_3_16
            {<point name="input.a.page3.l_xmii019_3_16" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii019_3_16
            #add-point:ON CHANGE l_xmii019_3_16
            {<point name="input.g.page3.l_xmii019_3_16" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii018_3_17
            #add-point:BEFORE FIELD l_xmii018_3_17
            {<point name="input.b.page3.l_xmii018_3_17" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii018_3_17
            
            #add-point:AFTER FIELD l_xmii018_3_17
            {<point name="input.a.page3.l_xmii018_3_17" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii018_3_17
            #add-point:ON CHANGE l_xmii018_3_17
            {<point name="input.g.page3.l_xmii018_3_17" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii019_3_17
            #add-point:BEFORE FIELD l_xmii019_3_17
            {<point name="input.b.page3.l_xmii019_3_17" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii019_3_17
            
            #add-point:AFTER FIELD l_xmii019_3_17
            {<point name="input.a.page3.l_xmii019_3_17" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii019_3_17
            #add-point:ON CHANGE l_xmii019_3_17
            {<point name="input.g.page3.l_xmii019_3_17" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii018_3_18
            #add-point:BEFORE FIELD l_xmii018_3_18
            {<point name="input.b.page3.l_xmii018_3_18" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii018_3_18
            
            #add-point:AFTER FIELD l_xmii018_3_18
            {<point name="input.a.page3.l_xmii018_3_18" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii018_3_18
            #add-point:ON CHANGE l_xmii018_3_18
            {<point name="input.g.page3.l_xmii018_3_18" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii019_3_18
            #add-point:BEFORE FIELD l_xmii019_3_18
            {<point name="input.b.page3.l_xmii019_3_18" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii019_3_18
            
            #add-point:AFTER FIELD l_xmii019_3_18
            {<point name="input.a.page3.l_xmii019_3_18" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii019_3_18
            #add-point:ON CHANGE l_xmii019_3_18
            {<point name="input.g.page3.l_xmii019_3_18" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii018_3_19
            #add-point:BEFORE FIELD l_xmii018_3_19
            {<point name="input.b.page3.l_xmii018_3_19" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii018_3_19
            
            #add-point:AFTER FIELD l_xmii018_3_19
            {<point name="input.a.page3.l_xmii018_3_19" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii018_3_19
            #add-point:ON CHANGE l_xmii018_3_19
            {<point name="input.g.page3.l_xmii018_3_19" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii019_3_19
            #add-point:BEFORE FIELD l_xmii019_3_19
            {<point name="input.b.page3.l_xmii019_3_19" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii019_3_19
            
            #add-point:AFTER FIELD l_xmii019_3_19
            {<point name="input.a.page3.l_xmii019_3_19" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii019_3_19
            #add-point:ON CHANGE l_xmii019_3_19
            {<point name="input.g.page3.l_xmii019_3_19" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii018_3_20
            #add-point:BEFORE FIELD l_xmii018_3_20
            {<point name="input.b.page3.l_xmii018_3_20" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii018_3_20
            
            #add-point:AFTER FIELD l_xmii018_3_20
            {<point name="input.a.page3.l_xmii018_3_20" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii018_3_20
            #add-point:ON CHANGE l_xmii018_3_20
            {<point name="input.g.page3.l_xmii018_3_20" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii019_3_20
            #add-point:BEFORE FIELD l_xmii019_3_20
            {<point name="input.b.page3.l_xmii019_3_20" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii019_3_20
            
            #add-point:AFTER FIELD l_xmii019_3_20
            {<point name="input.a.page3.l_xmii019_3_20" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii019_3_20
            #add-point:ON CHANGE l_xmii019_3_20
            {<point name="input.g.page3.l_xmii019_3_20" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii018_3_21
            #add-point:BEFORE FIELD l_xmii018_3_21
            {<point name="input.b.page3.l_xmii018_3_21" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii018_3_21
            
            #add-point:AFTER FIELD l_xmii018_3_21
            {<point name="input.a.page3.l_xmii018_3_21" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii018_3_21
            #add-point:ON CHANGE l_xmii018_3_21
            {<point name="input.g.page3.l_xmii018_3_21" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii019_3_21
            #add-point:BEFORE FIELD l_xmii019_3_21
            {<point name="input.b.page3.l_xmii019_3_21" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii019_3_21
            
            #add-point:AFTER FIELD l_xmii019_3_21
            {<point name="input.a.page3.l_xmii019_3_21" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii019_3_21
            #add-point:ON CHANGE l_xmii019_3_21
            {<point name="input.g.page3.l_xmii019_3_21" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii018_3_22
            #add-point:BEFORE FIELD l_xmii018_3_22
            {<point name="input.b.page3.l_xmii018_3_22" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii018_3_22
            
            #add-point:AFTER FIELD l_xmii018_3_22
            {<point name="input.a.page3.l_xmii018_3_22" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii018_3_22
            #add-point:ON CHANGE l_xmii018_3_22
            {<point name="input.g.page3.l_xmii018_3_22" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii019_3_22
            #add-point:BEFORE FIELD l_xmii019_3_22
            {<point name="input.b.page3.l_xmii019_3_22" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii019_3_22
            
            #add-point:AFTER FIELD l_xmii019_3_22
            {<point name="input.a.page3.l_xmii019_3_22" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii019_3_22
            #add-point:ON CHANGE l_xmii019_3_22
            {<point name="input.g.page3.l_xmii019_3_22" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii018_3_23
            #add-point:BEFORE FIELD l_xmii018_3_23
            {<point name="input.b.page3.l_xmii018_3_23" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii018_3_23
            
            #add-point:AFTER FIELD l_xmii018_3_23
            {<point name="input.a.page3.l_xmii018_3_23" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii018_3_23
            #add-point:ON CHANGE l_xmii018_3_23
            {<point name="input.g.page3.l_xmii018_3_23" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii019_3_23
            #add-point:BEFORE FIELD l_xmii019_3_23
            {<point name="input.b.page3.l_xmii019_3_23" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii019_3_23
            
            #add-point:AFTER FIELD l_xmii019_3_23
            {<point name="input.a.page3.l_xmii019_3_23" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii019_3_23
            #add-point:ON CHANGE l_xmii019_3_23
            {<point name="input.g.page3.l_xmii019_3_23" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii018_3_24
            #add-point:BEFORE FIELD l_xmii018_3_24
            {<point name="input.b.page3.l_xmii018_3_24" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii018_3_24
            
            #add-point:AFTER FIELD l_xmii018_3_24
            {<point name="input.a.page3.l_xmii018_3_24" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii018_3_24
            #add-point:ON CHANGE l_xmii018_3_24
            {<point name="input.g.page3.l_xmii018_3_24" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii019_3_24
            #add-point:BEFORE FIELD l_xmii019_3_24
            {<point name="input.b.page3.l_xmii019_3_24" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii019_3_24
            
            #add-point:AFTER FIELD l_xmii019_3_24
            {<point name="input.a.page3.l_xmii019_3_24" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii019_3_24
            #add-point:ON CHANGE l_xmii019_3_24
            {<point name="input.g.page3.l_xmii019_3_24" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii018_3_s
            #add-point:BEFORE FIELD l_xmii018_3_s
            {<point name="input.b.page3.l_xmii018_3_s" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii018_3_s
            
            #add-point:AFTER FIELD l_xmii018_3_s
            {<point name="input.a.page3.l_xmii018_3_s" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii018_3_s
            #add-point:ON CHANGE l_xmii018_3_s
            {<point name="input.g.page3.l_xmii018_3_s" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii019_3_s
            #add-point:BEFORE FIELD l_xmii019_3_s
            {<point name="input.b.page3.l_xmii019_3_s" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii019_3_s
            
            #add-point:AFTER FIELD l_xmii019_3_s
            {<point name="input.a.page3.l_xmii019_3_s" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii019_3_s
            #add-point:ON CHANGE l_xmii019_3_s
            {<point name="input.g.page3.l_xmii019_3_s" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii022_3_01
            #add-point:BEFORE FIELD l_xmii022_3_01
            {<point name="input.b.page3.l_xmii022_3_01" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii022_3_01
            
            #add-point:AFTER FIELD l_xmii022_3_01
            {<point name="input.a.page3.l_xmii022_3_01" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii022_3_01
            #add-point:ON CHANGE l_xmii022_3_01
            {<point name="input.g.page3.l_xmii022_3_01" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii023_3_01
            #add-point:BEFORE FIELD l_xmii023_3_01
            {<point name="input.b.page3.l_xmii023_3_01" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii023_3_01
            
            #add-point:AFTER FIELD l_xmii023_3_01
            {<point name="input.a.page3.l_xmii023_3_01" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii023_3_01
            #add-point:ON CHANGE l_xmii023_3_01
            {<point name="input.g.page3.l_xmii023_3_01" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii022_3_02
            #add-point:BEFORE FIELD l_xmii022_3_02
            {<point name="input.b.page3.l_xmii022_3_02" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii022_3_02
            
            #add-point:AFTER FIELD l_xmii022_3_02
            {<point name="input.a.page3.l_xmii022_3_02" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii022_3_02
            #add-point:ON CHANGE l_xmii022_3_02
            {<point name="input.g.page3.l_xmii022_3_02" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii023_3_02
            #add-point:BEFORE FIELD l_xmii023_3_02
            {<point name="input.b.page3.l_xmii023_3_02" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii023_3_02
            
            #add-point:AFTER FIELD l_xmii023_3_02
            {<point name="input.a.page3.l_xmii023_3_02" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii023_3_02
            #add-point:ON CHANGE l_xmii023_3_02
            {<point name="input.g.page3.l_xmii023_3_02" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii022_3_03
            #add-point:BEFORE FIELD l_xmii022_3_03
            {<point name="input.b.page3.l_xmii022_3_03" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii022_3_03
            
            #add-point:AFTER FIELD l_xmii022_3_03
            {<point name="input.a.page3.l_xmii022_3_03" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii022_3_03
            #add-point:ON CHANGE l_xmii022_3_03
            {<point name="input.g.page3.l_xmii022_3_03" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii023_3_03
            #add-point:BEFORE FIELD l_xmii023_3_03
            {<point name="input.b.page3.l_xmii023_3_03" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii023_3_03
            
            #add-point:AFTER FIELD l_xmii023_3_03
            {<point name="input.a.page3.l_xmii023_3_03" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii023_3_03
            #add-point:ON CHANGE l_xmii023_3_03
            {<point name="input.g.page3.l_xmii023_3_03" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii022_3_04
            #add-point:BEFORE FIELD l_xmii022_3_04
            {<point name="input.b.page3.l_xmii022_3_04" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii022_3_04
            
            #add-point:AFTER FIELD l_xmii022_3_04
            {<point name="input.a.page3.l_xmii022_3_04" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii022_3_04
            #add-point:ON CHANGE l_xmii022_3_04
            {<point name="input.g.page3.l_xmii022_3_04" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii023_3_04
            #add-point:BEFORE FIELD l_xmii023_3_04
            {<point name="input.b.page3.l_xmii023_3_04" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii023_3_04
            
            #add-point:AFTER FIELD l_xmii023_3_04
            {<point name="input.a.page3.l_xmii023_3_04" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii023_3_04
            #add-point:ON CHANGE l_xmii023_3_04
            {<point name="input.g.page3.l_xmii023_3_04" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii022_3_05
            #add-point:BEFORE FIELD l_xmii022_3_05
            {<point name="input.b.page3.l_xmii022_3_05" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii022_3_05
            
            #add-point:AFTER FIELD l_xmii022_3_05
            {<point name="input.a.page3.l_xmii022_3_05" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii022_3_05
            #add-point:ON CHANGE l_xmii022_3_05
            {<point name="input.g.page3.l_xmii022_3_05" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii023_3_05
            #add-point:BEFORE FIELD l_xmii023_3_05
            {<point name="input.b.page3.l_xmii023_3_05" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii023_3_05
            
            #add-point:AFTER FIELD l_xmii023_3_05
            {<point name="input.a.page3.l_xmii023_3_05" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii023_3_05
            #add-point:ON CHANGE l_xmii023_3_05
            {<point name="input.g.page3.l_xmii023_3_05" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii022_3_06
            #add-point:BEFORE FIELD l_xmii022_3_06
            {<point name="input.b.page3.l_xmii022_3_06" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii022_3_06
            
            #add-point:AFTER FIELD l_xmii022_3_06
            {<point name="input.a.page3.l_xmii022_3_06" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii022_3_06
            #add-point:ON CHANGE l_xmii022_3_06
            {<point name="input.g.page3.l_xmii022_3_06" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii023_3_06
            #add-point:BEFORE FIELD l_xmii023_3_06
            {<point name="input.b.page3.l_xmii023_3_06" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii023_3_06
            
            #add-point:AFTER FIELD l_xmii023_3_06
            {<point name="input.a.page3.l_xmii023_3_06" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii023_3_06
            #add-point:ON CHANGE l_xmii023_3_06
            {<point name="input.g.page3.l_xmii023_3_06" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii022_3_07
            #add-point:BEFORE FIELD l_xmii022_3_07
            {<point name="input.b.page3.l_xmii022_3_07" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii022_3_07
            
            #add-point:AFTER FIELD l_xmii022_3_07
            {<point name="input.a.page3.l_xmii022_3_07" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii022_3_07
            #add-point:ON CHANGE l_xmii022_3_07
            {<point name="input.g.page3.l_xmii022_3_07" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii023_3_07
            #add-point:BEFORE FIELD l_xmii023_3_07
            {<point name="input.b.page3.l_xmii023_3_07" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii023_3_07
            
            #add-point:AFTER FIELD l_xmii023_3_07
            {<point name="input.a.page3.l_xmii023_3_07" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii023_3_07
            #add-point:ON CHANGE l_xmii023_3_07
            {<point name="input.g.page3.l_xmii023_3_07" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii022_3_08
            #add-point:BEFORE FIELD l_xmii022_3_08
            {<point name="input.b.page3.l_xmii022_3_08" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii022_3_08
            
            #add-point:AFTER FIELD l_xmii022_3_08
            {<point name="input.a.page3.l_xmii022_3_08" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii022_3_08
            #add-point:ON CHANGE l_xmii022_3_08
            {<point name="input.g.page3.l_xmii022_3_08" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii023_3_08
            #add-point:BEFORE FIELD l_xmii023_3_08
            {<point name="input.b.page3.l_xmii023_3_08" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii023_3_08
            
            #add-point:AFTER FIELD l_xmii023_3_08
            {<point name="input.a.page3.l_xmii023_3_08" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii023_3_08
            #add-point:ON CHANGE l_xmii023_3_08
            {<point name="input.g.page3.l_xmii023_3_08" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii022_3_09
            #add-point:BEFORE FIELD l_xmii022_3_09
            {<point name="input.b.page3.l_xmii022_3_09" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii022_3_09
            
            #add-point:AFTER FIELD l_xmii022_3_09
            {<point name="input.a.page3.l_xmii022_3_09" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii022_3_09
            #add-point:ON CHANGE l_xmii022_3_09
            {<point name="input.g.page3.l_xmii022_3_09" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii023_3_09
            #add-point:BEFORE FIELD l_xmii023_3_09
            {<point name="input.b.page3.l_xmii023_3_09" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii023_3_09
            
            #add-point:AFTER FIELD l_xmii023_3_09
            {<point name="input.a.page3.l_xmii023_3_09" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii023_3_09
            #add-point:ON CHANGE l_xmii023_3_09
            {<point name="input.g.page3.l_xmii023_3_09" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii022_3_10
            #add-point:BEFORE FIELD l_xmii022_3_10
            {<point name="input.b.page3.l_xmii022_3_10" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii022_3_10
            
            #add-point:AFTER FIELD l_xmii022_3_10
            {<point name="input.a.page3.l_xmii022_3_10" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii022_3_10
            #add-point:ON CHANGE l_xmii022_3_10
            {<point name="input.g.page3.l_xmii022_3_10" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii023_3_10
            #add-point:BEFORE FIELD l_xmii023_3_10
            {<point name="input.b.page3.l_xmii023_3_10" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii023_3_10
            
            #add-point:AFTER FIELD l_xmii023_3_10
            {<point name="input.a.page3.l_xmii023_3_10" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii023_3_10
            #add-point:ON CHANGE l_xmii023_3_10
            {<point name="input.g.page3.l_xmii023_3_10" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii022_3_11
            #add-point:BEFORE FIELD l_xmii022_3_11
            {<point name="input.b.page3.l_xmii022_3_11" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii022_3_11
            
            #add-point:AFTER FIELD l_xmii022_3_11
            {<point name="input.a.page3.l_xmii022_3_11" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii022_3_11
            #add-point:ON CHANGE l_xmii022_3_11
            {<point name="input.g.page3.l_xmii022_3_11" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii023_3_11
            #add-point:BEFORE FIELD l_xmii023_3_11
            {<point name="input.b.page3.l_xmii023_3_11" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii023_3_11
            
            #add-point:AFTER FIELD l_xmii023_3_11
            {<point name="input.a.page3.l_xmii023_3_11" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii023_3_11
            #add-point:ON CHANGE l_xmii023_3_11
            {<point name="input.g.page3.l_xmii023_3_11" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii022_3_12
            #add-point:BEFORE FIELD l_xmii022_3_12
            {<point name="input.b.page3.l_xmii022_3_12" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii022_3_12
            
            #add-point:AFTER FIELD l_xmii022_3_12
            {<point name="input.a.page3.l_xmii022_3_12" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii022_3_12
            #add-point:ON CHANGE l_xmii022_3_12
            {<point name="input.g.page3.l_xmii022_3_12" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii023_3_12
            #add-point:BEFORE FIELD l_xmii023_3_12
            {<point name="input.b.page3.l_xmii023_3_12" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii023_3_12
            
            #add-point:AFTER FIELD l_xmii023_3_12
            {<point name="input.a.page3.l_xmii023_3_12" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii023_3_12
            #add-point:ON CHANGE l_xmii023_3_12
            {<point name="input.g.page3.l_xmii023_3_12" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii022_3_13
            #add-point:BEFORE FIELD l_xmii022_3_13
            {<point name="input.b.page3.l_xmii022_3_13" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii022_3_13
            
            #add-point:AFTER FIELD l_xmii022_3_13
            {<point name="input.a.page3.l_xmii022_3_13" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii022_3_13
            #add-point:ON CHANGE l_xmii022_3_13
            {<point name="input.g.page3.l_xmii022_3_13" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii023_3_13
            #add-point:BEFORE FIELD l_xmii023_3_13
            {<point name="input.b.page3.l_xmii023_3_13" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii023_3_13
            
            #add-point:AFTER FIELD l_xmii023_3_13
            {<point name="input.a.page3.l_xmii023_3_13" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii023_3_13
            #add-point:ON CHANGE l_xmii023_3_13
            {<point name="input.g.page3.l_xmii023_3_13" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii022_3_14
            #add-point:BEFORE FIELD l_xmii022_3_14
            {<point name="input.b.page3.l_xmii022_3_14" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii022_3_14
            
            #add-point:AFTER FIELD l_xmii022_3_14
            {<point name="input.a.page3.l_xmii022_3_14" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii022_3_14
            #add-point:ON CHANGE l_xmii022_3_14
            {<point name="input.g.page3.l_xmii022_3_14" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii023_3_14
            #add-point:BEFORE FIELD l_xmii023_3_14
            {<point name="input.b.page3.l_xmii023_3_14" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii023_3_14
            
            #add-point:AFTER FIELD l_xmii023_3_14
            {<point name="input.a.page3.l_xmii023_3_14" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii023_3_14
            #add-point:ON CHANGE l_xmii023_3_14
            {<point name="input.g.page3.l_xmii023_3_14" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii022_3_15
            #add-point:BEFORE FIELD l_xmii022_3_15
            {<point name="input.b.page3.l_xmii022_3_15" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii022_3_15
            
            #add-point:AFTER FIELD l_xmii022_3_15
            {<point name="input.a.page3.l_xmii022_3_15" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii022_3_15
            #add-point:ON CHANGE l_xmii022_3_15
            {<point name="input.g.page3.l_xmii022_3_15" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii023_3_15
            #add-point:BEFORE FIELD l_xmii023_3_15
            {<point name="input.b.page3.l_xmii023_3_15" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii023_3_15
            
            #add-point:AFTER FIELD l_xmii023_3_15
            {<point name="input.a.page3.l_xmii023_3_15" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii023_3_15
            #add-point:ON CHANGE l_xmii023_3_15
            {<point name="input.g.page3.l_xmii023_3_15" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii022_3_16
            #add-point:BEFORE FIELD l_xmii022_3_16
            {<point name="input.b.page3.l_xmii022_3_16" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii022_3_16
            
            #add-point:AFTER FIELD l_xmii022_3_16
            {<point name="input.a.page3.l_xmii022_3_16" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii022_3_16
            #add-point:ON CHANGE l_xmii022_3_16
            {<point name="input.g.page3.l_xmii022_3_16" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii023_3_16
            #add-point:BEFORE FIELD l_xmii023_3_16
            {<point name="input.b.page3.l_xmii023_3_16" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii023_3_16
            
            #add-point:AFTER FIELD l_xmii023_3_16
            {<point name="input.a.page3.l_xmii023_3_16" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii023_3_16
            #add-point:ON CHANGE l_xmii023_3_16
            {<point name="input.g.page3.l_xmii023_3_16" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii022_3_17
            #add-point:BEFORE FIELD l_xmii022_3_17
            {<point name="input.b.page3.l_xmii022_3_17" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii022_3_17
            
            #add-point:AFTER FIELD l_xmii022_3_17
            {<point name="input.a.page3.l_xmii022_3_17" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii022_3_17
            #add-point:ON CHANGE l_xmii022_3_17
            {<point name="input.g.page3.l_xmii022_3_17" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii023_3_17
            #add-point:BEFORE FIELD l_xmii023_3_17
            {<point name="input.b.page3.l_xmii023_3_17" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii023_3_17
            
            #add-point:AFTER FIELD l_xmii023_3_17
            {<point name="input.a.page3.l_xmii023_3_17" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii023_3_17
            #add-point:ON CHANGE l_xmii023_3_17
            {<point name="input.g.page3.l_xmii023_3_17" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii022_3_18
            #add-point:BEFORE FIELD l_xmii022_3_18
            {<point name="input.b.page3.l_xmii022_3_18" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii022_3_18
            
            #add-point:AFTER FIELD l_xmii022_3_18
            {<point name="input.a.page3.l_xmii022_3_18" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii022_3_18
            #add-point:ON CHANGE l_xmii022_3_18
            {<point name="input.g.page3.l_xmii022_3_18" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii023_3_18
            #add-point:BEFORE FIELD l_xmii023_3_18
            {<point name="input.b.page3.l_xmii023_3_18" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii023_3_18
            
            #add-point:AFTER FIELD l_xmii023_3_18
            {<point name="input.a.page3.l_xmii023_3_18" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii023_3_18
            #add-point:ON CHANGE l_xmii023_3_18
            {<point name="input.g.page3.l_xmii023_3_18" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii022_3_19
            #add-point:BEFORE FIELD l_xmii022_3_19
            {<point name="input.b.page3.l_xmii022_3_19" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii022_3_19
            
            #add-point:AFTER FIELD l_xmii022_3_19
            {<point name="input.a.page3.l_xmii022_3_19" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii022_3_19
            #add-point:ON CHANGE l_xmii022_3_19
            {<point name="input.g.page3.l_xmii022_3_19" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii023_3_19
            #add-point:BEFORE FIELD l_xmii023_3_19
            {<point name="input.b.page3.l_xmii023_3_19" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii023_3_19
            
            #add-point:AFTER FIELD l_xmii023_3_19
            {<point name="input.a.page3.l_xmii023_3_19" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii023_3_19
            #add-point:ON CHANGE l_xmii023_3_19
            {<point name="input.g.page3.l_xmii023_3_19" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii022_3_20
            #add-point:BEFORE FIELD l_xmii022_3_20
            {<point name="input.b.page3.l_xmii022_3_20" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii022_3_20
            
            #add-point:AFTER FIELD l_xmii022_3_20
            {<point name="input.a.page3.l_xmii022_3_20" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii022_3_20
            #add-point:ON CHANGE l_xmii022_3_20
            {<point name="input.g.page3.l_xmii022_3_20" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii023_3_20
            #add-point:BEFORE FIELD l_xmii023_3_20
            {<point name="input.b.page3.l_xmii023_3_20" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii023_3_20
            
            #add-point:AFTER FIELD l_xmii023_3_20
            {<point name="input.a.page3.l_xmii023_3_20" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii023_3_20
            #add-point:ON CHANGE l_xmii023_3_20
            {<point name="input.g.page3.l_xmii023_3_20" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii022_3_21
            #add-point:BEFORE FIELD l_xmii022_3_21
            {<point name="input.b.page3.l_xmii022_3_21" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii022_3_21
            
            #add-point:AFTER FIELD l_xmii022_3_21
            {<point name="input.a.page3.l_xmii022_3_21" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii022_3_21
            #add-point:ON CHANGE l_xmii022_3_21
            {<point name="input.g.page3.l_xmii022_3_21" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii023_3_21
            #add-point:BEFORE FIELD l_xmii023_3_21
            {<point name="input.b.page3.l_xmii023_3_21" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii023_3_21
            
            #add-point:AFTER FIELD l_xmii023_3_21
            {<point name="input.a.page3.l_xmii023_3_21" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii023_3_21
            #add-point:ON CHANGE l_xmii023_3_21
            {<point name="input.g.page3.l_xmii023_3_21" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii022_3_22
            #add-point:BEFORE FIELD l_xmii022_3_22
            {<point name="input.b.page3.l_xmii022_3_22" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii022_3_22
            
            #add-point:AFTER FIELD l_xmii022_3_22
            {<point name="input.a.page3.l_xmii022_3_22" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii022_3_22
            #add-point:ON CHANGE l_xmii022_3_22
            {<point name="input.g.page3.l_xmii022_3_22" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii023_3_22
            #add-point:BEFORE FIELD l_xmii023_3_22
            {<point name="input.b.page3.l_xmii023_3_22" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii023_3_22
            
            #add-point:AFTER FIELD l_xmii023_3_22
            {<point name="input.a.page3.l_xmii023_3_22" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii023_3_22
            #add-point:ON CHANGE l_xmii023_3_22
            {<point name="input.g.page3.l_xmii023_3_22" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii022_3_23
            #add-point:BEFORE FIELD l_xmii022_3_23
            {<point name="input.b.page3.l_xmii022_3_23" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii022_3_23
            
            #add-point:AFTER FIELD l_xmii022_3_23
            {<point name="input.a.page3.l_xmii022_3_23" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii022_3_23
            #add-point:ON CHANGE l_xmii022_3_23
            {<point name="input.g.page3.l_xmii022_3_23" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii023_3_23
            #add-point:BEFORE FIELD l_xmii023_3_23
            {<point name="input.b.page3.l_xmii023_3_23" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii023_3_23
            
            #add-point:AFTER FIELD l_xmii023_3_23
            {<point name="input.a.page3.l_xmii023_3_23" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii023_3_23
            #add-point:ON CHANGE l_xmii023_3_23
            {<point name="input.g.page3.l_xmii023_3_23" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii022_3_24
            #add-point:BEFORE FIELD l_xmii022_3_24
            {<point name="input.b.page3.l_xmii022_3_24" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii022_3_24
            
            #add-point:AFTER FIELD l_xmii022_3_24
            {<point name="input.a.page3.l_xmii022_3_24" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii022_3_24
            #add-point:ON CHANGE l_xmii022_3_24
            {<point name="input.g.page3.l_xmii022_3_24" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii023_3_24
            #add-point:BEFORE FIELD l_xmii023_3_24
            {<point name="input.b.page3.l_xmii023_3_24" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii023_3_24
            
            #add-point:AFTER FIELD l_xmii023_3_24
            {<point name="input.a.page3.l_xmii023_3_24" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii023_3_24
            #add-point:ON CHANGE l_xmii023_3_24
            {<point name="input.g.page3.l_xmii023_3_24" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii022_3_s
            #add-point:BEFORE FIELD l_xmii022_3_s
            {<point name="input.b.page3.l_xmii022_3_s" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii022_3_s
            
            #add-point:AFTER FIELD l_xmii022_3_s
            {<point name="input.a.page3.l_xmii022_3_s" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii022_3_s
            #add-point:ON CHANGE l_xmii022_3_s
            {<point name="input.g.page3.l_xmii022_3_s" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD l_xmii023_3_s
            #add-point:BEFORE FIELD l_xmii023_3_s
            {<point name="input.b.page3.l_xmii023_3_s" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD l_xmii023_3_s
            
            #add-point:AFTER FIELD l_xmii023_3_s
            {<point name="input.a.page3.l_xmii023_3_s" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE l_xmii023_3_s
            #add-point:ON CHANGE l_xmii023_3_s
            {<point name="input.g.page3.l_xmii023_3_s" />}
            #END add-point
 
 
                  #Ctrlp:input.c.page3.l_xmii018_3_01
         ON ACTION controlp INFIELD l_xmii018_3_01
            #add-point:ON ACTION controlp INFIELD l_xmii018_3_01
            {<point name="input.c.page3.l_xmii018_3_01" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii019_3_01
         ON ACTION controlp INFIELD l_xmii019_3_01
            #add-point:ON ACTION controlp INFIELD l_xmii019_3_01
            {<point name="input.c.page3.l_xmii019_3_01" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii018_3_02
         ON ACTION controlp INFIELD l_xmii018_3_02
            #add-point:ON ACTION controlp INFIELD l_xmii018_3_02
            {<point name="input.c.page3.l_xmii018_3_02" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii019_3_02
         ON ACTION controlp INFIELD l_xmii019_3_02
            #add-point:ON ACTION controlp INFIELD l_xmii019_3_02
            {<point name="input.c.page3.l_xmii019_3_02" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii018_3_03
         ON ACTION controlp INFIELD l_xmii018_3_03
            #add-point:ON ACTION controlp INFIELD l_xmii018_3_03
            {<point name="input.c.page3.l_xmii018_3_03" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii019_3_03
         ON ACTION controlp INFIELD l_xmii019_3_03
            #add-point:ON ACTION controlp INFIELD l_xmii019_3_03
            {<point name="input.c.page3.l_xmii019_3_03" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii018_3_04
         ON ACTION controlp INFIELD l_xmii018_3_04
            #add-point:ON ACTION controlp INFIELD l_xmii018_3_04
            {<point name="input.c.page3.l_xmii018_3_04" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii019_3_04
         ON ACTION controlp INFIELD l_xmii019_3_04
            #add-point:ON ACTION controlp INFIELD l_xmii019_3_04
            {<point name="input.c.page3.l_xmii019_3_04" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii018_3_05
         ON ACTION controlp INFIELD l_xmii018_3_05
            #add-point:ON ACTION controlp INFIELD l_xmii018_3_05
            {<point name="input.c.page3.l_xmii018_3_05" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii019_3_05
         ON ACTION controlp INFIELD l_xmii019_3_05
            #add-point:ON ACTION controlp INFIELD l_xmii019_3_05
            {<point name="input.c.page3.l_xmii019_3_05" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii018_3_06
         ON ACTION controlp INFIELD l_xmii018_3_06
            #add-point:ON ACTION controlp INFIELD l_xmii018_3_06
            {<point name="input.c.page3.l_xmii018_3_06" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii019_3_06
         ON ACTION controlp INFIELD l_xmii019_3_06
            #add-point:ON ACTION controlp INFIELD l_xmii019_3_06
            {<point name="input.c.page3.l_xmii019_3_06" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii018_3_07
         ON ACTION controlp INFIELD l_xmii018_3_07
            #add-point:ON ACTION controlp INFIELD l_xmii018_3_07
            {<point name="input.c.page3.l_xmii018_3_07" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii019_3_07
         ON ACTION controlp INFIELD l_xmii019_3_07
            #add-point:ON ACTION controlp INFIELD l_xmii019_3_07
            {<point name="input.c.page3.l_xmii019_3_07" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii018_3_08
         ON ACTION controlp INFIELD l_xmii018_3_08
            #add-point:ON ACTION controlp INFIELD l_xmii018_3_08
            {<point name="input.c.page3.l_xmii018_3_08" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii019_3_08
         ON ACTION controlp INFIELD l_xmii019_3_08
            #add-point:ON ACTION controlp INFIELD l_xmii019_3_08
            {<point name="input.c.page3.l_xmii019_3_08" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii018_3_09
         ON ACTION controlp INFIELD l_xmii018_3_09
            #add-point:ON ACTION controlp INFIELD l_xmii018_3_09
            {<point name="input.c.page3.l_xmii018_3_09" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii019_3_09
         ON ACTION controlp INFIELD l_xmii019_3_09
            #add-point:ON ACTION controlp INFIELD l_xmii019_3_09
            {<point name="input.c.page3.l_xmii019_3_09" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii018_3_10
         ON ACTION controlp INFIELD l_xmii018_3_10
            #add-point:ON ACTION controlp INFIELD l_xmii018_3_10
            {<point name="input.c.page3.l_xmii018_3_10" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii019_3_10
         ON ACTION controlp INFIELD l_xmii019_3_10
            #add-point:ON ACTION controlp INFIELD l_xmii019_3_10
            {<point name="input.c.page3.l_xmii019_3_10" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii018_3_11
         ON ACTION controlp INFIELD l_xmii018_3_11
            #add-point:ON ACTION controlp INFIELD l_xmii018_3_11
            {<point name="input.c.page3.l_xmii018_3_11" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii019_3_11
         ON ACTION controlp INFIELD l_xmii019_3_11
            #add-point:ON ACTION controlp INFIELD l_xmii019_3_11
            {<point name="input.c.page3.l_xmii019_3_11" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii018_3_12
         ON ACTION controlp INFIELD l_xmii018_3_12
            #add-point:ON ACTION controlp INFIELD l_xmii018_3_12
            {<point name="input.c.page3.l_xmii018_3_12" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii019_3_12
         ON ACTION controlp INFIELD l_xmii019_3_12
            #add-point:ON ACTION controlp INFIELD l_xmii019_3_12
            {<point name="input.c.page3.l_xmii019_3_12" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii018_3_13
         ON ACTION controlp INFIELD l_xmii018_3_13
            #add-point:ON ACTION controlp INFIELD l_xmii018_3_13
            {<point name="input.c.page3.l_xmii018_3_13" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii019_3_13
         ON ACTION controlp INFIELD l_xmii019_3_13
            #add-point:ON ACTION controlp INFIELD l_xmii019_3_13
            {<point name="input.c.page3.l_xmii019_3_13" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii018_3_14
         ON ACTION controlp INFIELD l_xmii018_3_14
            #add-point:ON ACTION controlp INFIELD l_xmii018_3_14
            {<point name="input.c.page3.l_xmii018_3_14" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii019_3_14
         ON ACTION controlp INFIELD l_xmii019_3_14
            #add-point:ON ACTION controlp INFIELD l_xmii019_3_14
            {<point name="input.c.page3.l_xmii019_3_14" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii018_3_15
         ON ACTION controlp INFIELD l_xmii018_3_15
            #add-point:ON ACTION controlp INFIELD l_xmii018_3_15
            {<point name="input.c.page3.l_xmii018_3_15" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii019_3_15
         ON ACTION controlp INFIELD l_xmii019_3_15
            #add-point:ON ACTION controlp INFIELD l_xmii019_3_15
            {<point name="input.c.page3.l_xmii019_3_15" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii018_3_16
         ON ACTION controlp INFIELD l_xmii018_3_16
            #add-point:ON ACTION controlp INFIELD l_xmii018_3_16
            {<point name="input.c.page3.l_xmii018_3_16" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii019_3_16
         ON ACTION controlp INFIELD l_xmii019_3_16
            #add-point:ON ACTION controlp INFIELD l_xmii019_3_16
            {<point name="input.c.page3.l_xmii019_3_16" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii018_3_17
         ON ACTION controlp INFIELD l_xmii018_3_17
            #add-point:ON ACTION controlp INFIELD l_xmii018_3_17
            {<point name="input.c.page3.l_xmii018_3_17" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii019_3_17
         ON ACTION controlp INFIELD l_xmii019_3_17
            #add-point:ON ACTION controlp INFIELD l_xmii019_3_17
            {<point name="input.c.page3.l_xmii019_3_17" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii018_3_18
         ON ACTION controlp INFIELD l_xmii018_3_18
            #add-point:ON ACTION controlp INFIELD l_xmii018_3_18
            {<point name="input.c.page3.l_xmii018_3_18" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii019_3_18
         ON ACTION controlp INFIELD l_xmii019_3_18
            #add-point:ON ACTION controlp INFIELD l_xmii019_3_18
            {<point name="input.c.page3.l_xmii019_3_18" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii018_3_19
         ON ACTION controlp INFIELD l_xmii018_3_19
            #add-point:ON ACTION controlp INFIELD l_xmii018_3_19
            {<point name="input.c.page3.l_xmii018_3_19" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii019_3_19
         ON ACTION controlp INFIELD l_xmii019_3_19
            #add-point:ON ACTION controlp INFIELD l_xmii019_3_19
            {<point name="input.c.page3.l_xmii019_3_19" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii018_3_20
         ON ACTION controlp INFIELD l_xmii018_3_20
            #add-point:ON ACTION controlp INFIELD l_xmii018_3_20
            {<point name="input.c.page3.l_xmii018_3_20" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii019_3_20
         ON ACTION controlp INFIELD l_xmii019_3_20
            #add-point:ON ACTION controlp INFIELD l_xmii019_3_20
            {<point name="input.c.page3.l_xmii019_3_20" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii018_3_21
         ON ACTION controlp INFIELD l_xmii018_3_21
            #add-point:ON ACTION controlp INFIELD l_xmii018_3_21
            {<point name="input.c.page3.l_xmii018_3_21" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii019_3_21
         ON ACTION controlp INFIELD l_xmii019_3_21
            #add-point:ON ACTION controlp INFIELD l_xmii019_3_21
            {<point name="input.c.page3.l_xmii019_3_21" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii018_3_22
         ON ACTION controlp INFIELD l_xmii018_3_22
            #add-point:ON ACTION controlp INFIELD l_xmii018_3_22
            {<point name="input.c.page3.l_xmii018_3_22" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii019_3_22
         ON ACTION controlp INFIELD l_xmii019_3_22
            #add-point:ON ACTION controlp INFIELD l_xmii019_3_22
            {<point name="input.c.page3.l_xmii019_3_22" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii018_3_23
         ON ACTION controlp INFIELD l_xmii018_3_23
            #add-point:ON ACTION controlp INFIELD l_xmii018_3_23
            {<point name="input.c.page3.l_xmii018_3_23" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii019_3_23
         ON ACTION controlp INFIELD l_xmii019_3_23
            #add-point:ON ACTION controlp INFIELD l_xmii019_3_23
            {<point name="input.c.page3.l_xmii019_3_23" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii018_3_24
         ON ACTION controlp INFIELD l_xmii018_3_24
            #add-point:ON ACTION controlp INFIELD l_xmii018_3_24
            {<point name="input.c.page3.l_xmii018_3_24" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii019_3_24
         ON ACTION controlp INFIELD l_xmii019_3_24
            #add-point:ON ACTION controlp INFIELD l_xmii019_3_24
            {<point name="input.c.page3.l_xmii019_3_24" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii018_3_s
         ON ACTION controlp INFIELD l_xmii018_3_s
            #add-point:ON ACTION controlp INFIELD l_xmii018_3_s
            {<point name="input.c.page3.l_xmii018_3_s" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii019_3_s
         ON ACTION controlp INFIELD l_xmii019_3_s
            #add-point:ON ACTION controlp INFIELD l_xmii019_3_s
            {<point name="input.c.page3.l_xmii019_3_s" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii022_3_01
         ON ACTION controlp INFIELD l_xmii022_3_01
            #add-point:ON ACTION controlp INFIELD l_xmii022_3_01
            {<point name="input.c.page3.l_xmii022_3_01" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii023_3_01
         ON ACTION controlp INFIELD l_xmii023_3_01
            #add-point:ON ACTION controlp INFIELD l_xmii023_3_01
            {<point name="input.c.page3.l_xmii023_3_01" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii022_3_02
         ON ACTION controlp INFIELD l_xmii022_3_02
            #add-point:ON ACTION controlp INFIELD l_xmii022_3_02
            {<point name="input.c.page3.l_xmii022_3_02" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii023_3_02
         ON ACTION controlp INFIELD l_xmii023_3_02
            #add-point:ON ACTION controlp INFIELD l_xmii023_3_02
            {<point name="input.c.page3.l_xmii023_3_02" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii022_3_03
         ON ACTION controlp INFIELD l_xmii022_3_03
            #add-point:ON ACTION controlp INFIELD l_xmii022_3_03
            {<point name="input.c.page3.l_xmii022_3_03" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii023_3_03
         ON ACTION controlp INFIELD l_xmii023_3_03
            #add-point:ON ACTION controlp INFIELD l_xmii023_3_03
            {<point name="input.c.page3.l_xmii023_3_03" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii022_3_04
         ON ACTION controlp INFIELD l_xmii022_3_04
            #add-point:ON ACTION controlp INFIELD l_xmii022_3_04
            {<point name="input.c.page3.l_xmii022_3_04" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii023_3_04
         ON ACTION controlp INFIELD l_xmii023_3_04
            #add-point:ON ACTION controlp INFIELD l_xmii023_3_04
            {<point name="input.c.page3.l_xmii023_3_04" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii022_3_05
         ON ACTION controlp INFIELD l_xmii022_3_05
            #add-point:ON ACTION controlp INFIELD l_xmii022_3_05
            {<point name="input.c.page3.l_xmii022_3_05" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii023_3_05
         ON ACTION controlp INFIELD l_xmii023_3_05
            #add-point:ON ACTION controlp INFIELD l_xmii023_3_05
            {<point name="input.c.page3.l_xmii023_3_05" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii022_3_06
         ON ACTION controlp INFIELD l_xmii022_3_06
            #add-point:ON ACTION controlp INFIELD l_xmii022_3_06
            {<point name="input.c.page3.l_xmii022_3_06" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii023_3_06
         ON ACTION controlp INFIELD l_xmii023_3_06
            #add-point:ON ACTION controlp INFIELD l_xmii023_3_06
            {<point name="input.c.page3.l_xmii023_3_06" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii022_3_07
         ON ACTION controlp INFIELD l_xmii022_3_07
            #add-point:ON ACTION controlp INFIELD l_xmii022_3_07
            {<point name="input.c.page3.l_xmii022_3_07" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii023_3_07
         ON ACTION controlp INFIELD l_xmii023_3_07
            #add-point:ON ACTION controlp INFIELD l_xmii023_3_07
            {<point name="input.c.page3.l_xmii023_3_07" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii022_3_08
         ON ACTION controlp INFIELD l_xmii022_3_08
            #add-point:ON ACTION controlp INFIELD l_xmii022_3_08
            {<point name="input.c.page3.l_xmii022_3_08" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii023_3_08
         ON ACTION controlp INFIELD l_xmii023_3_08
            #add-point:ON ACTION controlp INFIELD l_xmii023_3_08
            {<point name="input.c.page3.l_xmii023_3_08" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii022_3_09
         ON ACTION controlp INFIELD l_xmii022_3_09
            #add-point:ON ACTION controlp INFIELD l_xmii022_3_09
            {<point name="input.c.page3.l_xmii022_3_09" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii023_3_09
         ON ACTION controlp INFIELD l_xmii023_3_09
            #add-point:ON ACTION controlp INFIELD l_xmii023_3_09
            {<point name="input.c.page3.l_xmii023_3_09" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii022_3_10
         ON ACTION controlp INFIELD l_xmii022_3_10
            #add-point:ON ACTION controlp INFIELD l_xmii022_3_10
            {<point name="input.c.page3.l_xmii022_3_10" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii023_3_10
         ON ACTION controlp INFIELD l_xmii023_3_10
            #add-point:ON ACTION controlp INFIELD l_xmii023_3_10
            {<point name="input.c.page3.l_xmii023_3_10" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii022_3_11
         ON ACTION controlp INFIELD l_xmii022_3_11
            #add-point:ON ACTION controlp INFIELD l_xmii022_3_11
            {<point name="input.c.page3.l_xmii022_3_11" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii023_3_11
         ON ACTION controlp INFIELD l_xmii023_3_11
            #add-point:ON ACTION controlp INFIELD l_xmii023_3_11
            {<point name="input.c.page3.l_xmii023_3_11" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii022_3_12
         ON ACTION controlp INFIELD l_xmii022_3_12
            #add-point:ON ACTION controlp INFIELD l_xmii022_3_12
            {<point name="input.c.page3.l_xmii022_3_12" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii023_3_12
         ON ACTION controlp INFIELD l_xmii023_3_12
            #add-point:ON ACTION controlp INFIELD l_xmii023_3_12
            {<point name="input.c.page3.l_xmii023_3_12" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii022_3_13
         ON ACTION controlp INFIELD l_xmii022_3_13
            #add-point:ON ACTION controlp INFIELD l_xmii022_3_13
            {<point name="input.c.page3.l_xmii022_3_13" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii023_3_13
         ON ACTION controlp INFIELD l_xmii023_3_13
            #add-point:ON ACTION controlp INFIELD l_xmii023_3_13
            {<point name="input.c.page3.l_xmii023_3_13" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii022_3_14
         ON ACTION controlp INFIELD l_xmii022_3_14
            #add-point:ON ACTION controlp INFIELD l_xmii022_3_14
            {<point name="input.c.page3.l_xmii022_3_14" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii023_3_14
         ON ACTION controlp INFIELD l_xmii023_3_14
            #add-point:ON ACTION controlp INFIELD l_xmii023_3_14
            {<point name="input.c.page3.l_xmii023_3_14" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii022_3_15
         ON ACTION controlp INFIELD l_xmii022_3_15
            #add-point:ON ACTION controlp INFIELD l_xmii022_3_15
            {<point name="input.c.page3.l_xmii022_3_15" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii023_3_15
         ON ACTION controlp INFIELD l_xmii023_3_15
            #add-point:ON ACTION controlp INFIELD l_xmii023_3_15
            {<point name="input.c.page3.l_xmii023_3_15" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii022_3_16
         ON ACTION controlp INFIELD l_xmii022_3_16
            #add-point:ON ACTION controlp INFIELD l_xmii022_3_16
            {<point name="input.c.page3.l_xmii022_3_16" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii023_3_16
         ON ACTION controlp INFIELD l_xmii023_3_16
            #add-point:ON ACTION controlp INFIELD l_xmii023_3_16
            {<point name="input.c.page3.l_xmii023_3_16" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii022_3_17
         ON ACTION controlp INFIELD l_xmii022_3_17
            #add-point:ON ACTION controlp INFIELD l_xmii022_3_17
            {<point name="input.c.page3.l_xmii022_3_17" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii023_3_17
         ON ACTION controlp INFIELD l_xmii023_3_17
            #add-point:ON ACTION controlp INFIELD l_xmii023_3_17
            {<point name="input.c.page3.l_xmii023_3_17" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii022_3_18
         ON ACTION controlp INFIELD l_xmii022_3_18
            #add-point:ON ACTION controlp INFIELD l_xmii022_3_18
            {<point name="input.c.page3.l_xmii022_3_18" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii023_3_18
         ON ACTION controlp INFIELD l_xmii023_3_18
            #add-point:ON ACTION controlp INFIELD l_xmii023_3_18
            {<point name="input.c.page3.l_xmii023_3_18" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii022_3_19
         ON ACTION controlp INFIELD l_xmii022_3_19
            #add-point:ON ACTION controlp INFIELD l_xmii022_3_19
            {<point name="input.c.page3.l_xmii022_3_19" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii023_3_19
         ON ACTION controlp INFIELD l_xmii023_3_19
            #add-point:ON ACTION controlp INFIELD l_xmii023_3_19
            {<point name="input.c.page3.l_xmii023_3_19" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii022_3_20
         ON ACTION controlp INFIELD l_xmii022_3_20
            #add-point:ON ACTION controlp INFIELD l_xmii022_3_20
            {<point name="input.c.page3.l_xmii022_3_20" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii023_3_20
         ON ACTION controlp INFIELD l_xmii023_3_20
            #add-point:ON ACTION controlp INFIELD l_xmii023_3_20
            {<point name="input.c.page3.l_xmii023_3_20" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii022_3_21
         ON ACTION controlp INFIELD l_xmii022_3_21
            #add-point:ON ACTION controlp INFIELD l_xmii022_3_21
            {<point name="input.c.page3.l_xmii022_3_21" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii023_3_21
         ON ACTION controlp INFIELD l_xmii023_3_21
            #add-point:ON ACTION controlp INFIELD l_xmii023_3_21
            {<point name="input.c.page3.l_xmii023_3_21" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii022_3_22
         ON ACTION controlp INFIELD l_xmii022_3_22
            #add-point:ON ACTION controlp INFIELD l_xmii022_3_22
            {<point name="input.c.page3.l_xmii022_3_22" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii023_3_22
         ON ACTION controlp INFIELD l_xmii023_3_22
            #add-point:ON ACTION controlp INFIELD l_xmii023_3_22
            {<point name="input.c.page3.l_xmii023_3_22" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii022_3_23
         ON ACTION controlp INFIELD l_xmii022_3_23
            #add-point:ON ACTION controlp INFIELD l_xmii022_3_23
            {<point name="input.c.page3.l_xmii022_3_23" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii023_3_23
         ON ACTION controlp INFIELD l_xmii023_3_23
            #add-point:ON ACTION controlp INFIELD l_xmii023_3_23
            {<point name="input.c.page3.l_xmii023_3_23" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii022_3_24
         ON ACTION controlp INFIELD l_xmii022_3_24
            #add-point:ON ACTION controlp INFIELD l_xmii022_3_24
            {<point name="input.c.page3.l_xmii022_3_24" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii023_3_24
         ON ACTION controlp INFIELD l_xmii023_3_24
            #add-point:ON ACTION controlp INFIELD l_xmii023_3_24
            {<point name="input.c.page3.l_xmii023_3_24" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii022_3_s
         ON ACTION controlp INFIELD l_xmii022_3_s
            #add-point:ON ACTION controlp INFIELD l_xmii022_3_s
            {<point name="input.c.page3.l_xmii022_3_s" />}
            #END add-point
 
         #Ctrlp:input.c.page3.l_xmii023_3_s
         ON ACTION controlp INFIELD l_xmii023_3_s
            #add-point:ON ACTION controlp INFIELD l_xmii023_3_s
            {<point name="input.c.page3.l_xmii023_3_s" />}
            #END add-point
 
 
 
         AFTER ROW
            #add-point:單身page3 after_row
            {<point name="input.body3.after_row"/>}
            #end add-point
            LET l_ac = ARR_CURR()
            IF INT_FLAG THEN
               CALL cl_err('',9001,0)
               LET INT_FLAG = 0
               IF l_cmd = 'u' THEN
                  LET g_xmii3_d[l_ac].* = g_xmii3_d_t.*
               END IF
               CLOSE axmt175_bcl
               CALL s_transaction_end('N','0')
               EXIT DIALOG 
            END IF
            
            #其他table進行unlock
            
            CALL axmt175_unlock_b("xmii_t","'3'")
            CALL s_transaction_end('Y','0')
            #add-point:單身page3 after_row2
            {<point name="input.body3.after_row2"/>}
            #end add-point
 
         AFTER INPUT
            #add-point:input段after input 
            {<point name="input.body3.after_input"/>}
            #end add-point   
    
         ON ACTION controlo
            CALL FGL_SET_ARR_CURR(g_xmii3_d.getLength()+1)
            LET lb_reproduce = TRUE
            LET li_reproduce = l_ac
            LET li_reproduce_target = g_xmii3_d.getLength()+1
 
      END INPUT
 
      
 
      
 
      
 
      
]]>
  </section>
  <section id="axmt175.input.head" ver="17" status="" src="s">
    <![CDATA[      #單頭段
      INPUT BY NAME g_xmih_m.xmih001,g_xmih_m.xmih004,g_xmih_m.ooai001,g_xmih_m.xmih002,g_xmih_m.xmih005, 
          g_xmih_m.xmih003,g_xmih_m.xmih005_stus,g_xmih_m.xmihstus 
         ATTRIBUTE(WITHOUT DEFAULTS)
         
         #自訂ACTION(master_input)
         
     
         BEFORE INPUT
            IF s_transaction_chk("N",0) THEN
               CALL s_transaction_begin()
            END IF
            
            IF l_cmd_t = 'r' THEN
               
            END IF
            #add-point:資料輸入前
            {<point name="input.m.before_input"/>}
            #end add-point
 
                  #此段落由子樣板a02產生
         AFTER FIELD xmih001
            
            #add-point:AFTER FIELD xmih001
            {<point name="input.a.xmih001" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmih001
            #add-point:BEFORE FIELD xmih001
            {<point name="input.b.xmih001" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE xmih001
            #add-point:ON CHANGE xmih001
            {<point name="input.g.xmih001" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmih004
            
            #add-point:AFTER FIELD xmih004
            {<point name="input.a.xmih004" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmih004
            #add-point:BEFORE FIELD xmih004
            {<point name="input.b.xmih004" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE xmih004
            #add-point:ON CHANGE xmih004
            {<point name="input.g.xmih004" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD ooai001
            
            #add-point:AFTER FIELD ooai001
            {<point name="input.a.ooai001" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD ooai001
            #add-point:BEFORE FIELD ooai001
            {<point name="input.b.ooai001" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE ooai001
            #add-point:ON CHANGE ooai001
            {<point name="input.g.ooai001" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmih002
            #add-point:BEFORE FIELD xmih002
            {<point name="input.b.xmih002" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmih002
            
            #add-point:AFTER FIELD xmih002
            {<point name="input.a.xmih002" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE xmih002
            #add-point:ON CHANGE xmih002
            {<point name="input.g.xmih002" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmih005
            
            #add-point:AFTER FIELD xmih005
            {<point name="input.a.xmih005" />}
            #END add-point
            
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmih005
            #add-point:BEFORE FIELD xmih005
            {<point name="input.b.xmih005" />}
            #END add-point
 
         #此段落由子樣板a04產生
         ON CHANGE xmih005
            #add-point:ON CHANGE xmih005
            {<point name="input.g.xmih005" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmih003
            #add-point:BEFORE FIELD xmih003
            {<point name="input.b.xmih003" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmih003
            
            #add-point:AFTER FIELD xmih003
            {<point name="input.a.xmih003" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE xmih003
            #add-point:ON CHANGE xmih003
            {<point name="input.g.xmih003" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmih005_stus
            #add-point:BEFORE FIELD xmih005_stus
            {<point name="input.b.xmih005_stus" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmih005_stus
            
            #add-point:AFTER FIELD xmih005_stus
            {<point name="input.a.xmih005_stus" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE xmih005_stus
            #add-point:ON CHANGE xmih005_stus
            {<point name="input.g.xmih005_stus" />}
            #END add-point
 
         #此段落由子樣板a01產生
         BEFORE FIELD xmihstus
            #add-point:BEFORE FIELD xmihstus
            {<point name="input.b.xmihstus" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD xmihstus
            
            #add-point:AFTER FIELD xmihstus
            {<point name="input.a.xmihstus" />}
            #END add-point
            
 
         #此段落由子樣板a04產生
         ON CHANGE xmihstus
            #add-point:ON CHANGE xmihstus
            {<point name="input.g.xmihstus" />}
            #END add-point
 
 #欄位檢查
                  #Ctrlp:input.c.xmih001
         ON ACTION controlp INFIELD xmih001
            #add-point:ON ACTION controlp INFIELD xmih001
            {<point name="input.c.xmih001" />}
            #END add-point
 
         #Ctrlp:input.c.xmih004
         ON ACTION controlp INFIELD xmih004
            #add-point:ON ACTION controlp INFIELD xmih004
            {<point name="input.c.xmih004" />}
            #END add-point
 
         #Ctrlp:input.c.ooai001
         ON ACTION controlp INFIELD ooai001
            #add-point:ON ACTION controlp INFIELD ooai001
            {<point name="input.c.ooai001" />}
            #END add-point
 
         #Ctrlp:input.c.xmih002
         ON ACTION controlp INFIELD xmih002
            #add-point:ON ACTION controlp INFIELD xmih002
            {<point name="input.c.xmih002" />}
            #END add-point
 
         #Ctrlp:input.c.xmih005
         ON ACTION controlp INFIELD xmih005
            #add-point:ON ACTION controlp INFIELD xmih005
            {<point name="input.c.xmih005" />}
            #END add-point
 
         #Ctrlp:input.c.xmih003
         ON ACTION controlp INFIELD xmih003
            #add-point:ON ACTION controlp INFIELD xmih003
            {<point name="input.c.xmih003" />}
            #END add-point
 
         #Ctrlp:input.c.xmih005_stus
         ON ACTION controlp INFIELD xmih005_stus
            #add-point:ON ACTION controlp INFIELD xmih005_stus
            {<point name="input.c.xmih005_stus" />}
            #END add-point
 
         #Ctrlp:input.c.xmihstus
         ON ACTION controlp INFIELD xmihstus
            #add-point:ON ACTION controlp INFIELD xmihstus
            {<point name="input.c.xmihstus" />}
            #END add-point
 
 #欄位開窗
            
         AFTER INPUT
            IF INT_FLAG THEN
               EXIT DIALOG
            END IF
 
            CALL cl_showmsg()      #錯誤訊息統整顯示
            DISPLAY BY NAME g_xmih_m.xmih001,g_xmih_m.xmih002,g_xmih_m.xmih003,g_xmih_m.xmih004
                        
            #add-point:單頭INPUT後
            {<point name="input.head.after_input"/>}
            #end add-point
                        
            IF p_cmd <> 'u' THEN
    
               CALL s_transaction_begin()
               
               #add-point:單頭新增前
               {<point name="input.head.b_insert" mark="Y"/>}
               #end add-point
               
               INSERT INTO xmih_t (xmihent,xmih001,xmih004,xmih002,xmih005,xmih003,xmihstus,xmihownid, 
                   xmihcrtdp,xmihowndp,xmihcrtdt,xmihcrtid,xmihcnfid,xmihcnfdt)
               VALUES (g_enterprise,g_xmih_m.xmih001,g_xmih_m.xmih004,g_xmih_m.xmih002,g_xmih_m.xmih005, 
                   g_xmih_m.xmih003,g_xmih_m.xmihstus,g_xmih_m.xmihownid,g_xmih_m.xmihcrtdp,g_xmih_m.xmihowndp, 
                   g_xmih_m.xmihcrtdt,g_xmih_m.xmihcrtid,g_xmih_m.xmihcnfid,g_xmih_m.xmihcnfdt) 
               IF SQLCA.sqlcode THEN
                  CALL cl_err("g_xmih_m",SQLCA.sqlcode,1)  
                  CALL s_transaction_end('N','0')
                  CONTINUE DIALOG
               END IF
               
               #add-point:單頭新增中
               {<point name="input.head.m_insert"/>}
               #end add-point
               
               
               
               
               #add-point:單頭新增後
               {<point name="input.head.a_insert"/>}
               #end add-point
               CALL s_transaction_end('Y','0') 
               
               IF l_cmd_t = 'r' AND p_cmd = 'a' THEN
                  CALL axmt175_detail_reproduce()
               END IF
               
               LET p_cmd = 'u'
            ELSE
               CALL s_transaction_begin()
            
               #add-point:單頭修改前
               {<point name="input.head.b_update" mark="Y"/>}
               #end add-point
               
               UPDATE xmih_t SET (xmih001,xmih004,xmih002,xmih005,xmih003,xmihstus,xmihownid,xmihcrtdp, 
                   xmihowndp,xmihcrtdt,xmihcrtid,xmihcnfid,xmihcnfdt) = (g_xmih_m.xmih001,g_xmih_m.xmih004, 
                   g_xmih_m.xmih002,g_xmih_m.xmih005,g_xmih_m.xmih003,g_xmih_m.xmihstus,g_xmih_m.xmihownid, 
                   g_xmih_m.xmihcrtdp,g_xmih_m.xmihowndp,g_xmih_m.xmihcrtdt,g_xmih_m.xmihcrtid,g_xmih_m.xmihcnfid, 
                   g_xmih_m.xmihcnfdt)
                WHERE xmihent = g_enterprise AND xmih001 = g_xmih001_t
                  AND xmih002 = g_xmih002_t
                  AND xmih003 = g_xmih003_t
                  AND xmih004 = g_xmih004_t
 
               IF SQLCA.sqlcode THEN
                  CALL cl_err("xmih_t",SQLCA.sqlcode,1)  
                  CALL s_transaction_end('N','0')
                  CONTINUE DIALOG
               END IF
               
               #add-point:單頭修改中
               {<point name="input.head.m_update"/>}
               #end add-point
               
               
               
               
			   #修改歷程記錄
               LET g_log1 = util.JSON.stringify(g_xmih_m_t)
               LET g_log2 = util.JSON.stringify(g_xmih_m)
               IF NOT cl_log_modified_record(g_log1,g_log2) THEN 
                  CALL s_transaction_end('N','0')
               ELSE
                  CALL s_transaction_end('Y','0')
               END IF
               
               #add-point:單頭修改後
               {<point name="input.head.a_update"/>}
               #end add-point
            END IF
            
            LET g_xmih001_t = g_xmih_m.xmih001
            LET g_xmih002_t = g_xmih_m.xmih002
            LET g_xmih003_t = g_xmih_m.xmih003
            LET g_xmih004_t = g_xmih_m.xmih004
 
            #controlp
            
      END INPUT
   
]]>
  </section>
  <section id="axmt175.input.other" ver="7" status="" src="s">
    <![CDATA[      
      #add-point:自定義input
      {<point name="input.more_input"/>}
      #end add-point
      
      BEFORE DIALOG 
         #add-point:input段before dialog
         {<point name="input.before_dialog"/>}
         #end add-point    
         #新增時強制從單頭開始填
         IF p_cmd = 'a' THEN
            NEXT FIELD xmih001
         ELSE
            CASE g_aw
               WHEN "s_detail1"
                  NEXT FIELD xmii005
               WHEN "s_detail2"
                  NEXT FIELD xmii005
               WHEN "s_detail3"
                  NEXT FIELD xmii005
 
            END CASE
         END IF
    
      ON ACTION controlf
         CALL cl_set_focus_form(ui.Interface.getRootNode()) RETURNING g_fld_name,g_frm_name
         CALL cl_fldhelp(g_frm_name,g_fld_name,g_lang)
 
      ON ACTION controlr
         CALL cl_show_req_fields()
 
      ON ACTION controls
         IF g_header_hidden THEN
            CALL gfrm_curr.setElementHidden("vb_master",0)
            CALL gfrm_curr.setElementImage("controls","small/arr-u.png")
            LET g_header_hidden = 0     #visible
         ELSE
            CALL gfrm_curr.setElementHidden("vb_master",1)
            CALL gfrm_curr.setElementImage("controls","small/arr-d.png")
            LET g_header_hidden = 1     #hidden     
         END IF
 
      ON ACTION accept
         #add-point:input段accept 
         {<point name="input.accept"/>}
         #end add-point    
         ACCEPT DIALOG
        
      ON ACTION cancel      #在dialog button (放棄)
         LET INT_FLAG = TRUE 
         LET g_detail_idx  = 1
         LET g_detail_idx2 = 1
         EXIT DIALOG
 
      ON ACTION close       #在dialog 右上角 (X)
         LET INT_FLAG = TRUE 
         EXIT DIALOG
 
      ON ACTION exit        #toolbar 離開
         LET INT_FLAG = TRUE 
         EXIT DIALOG
 
      #交談指令共用ACTION
      &include "common_action.4gl" 
         CONTINUE DIALOG 
         
   END DIALOG
    
   #add-point:input段after input 
   {<point name="input.after_input"/>}
   #end add-point    
 
END FUNCTION
]]>
  </section>
  <section id="axmt175.insert" ver="5" status="" src="s">
    <![CDATA[#+ 資料新增
PRIVATE FUNCTION axmt175_insert()
   #add-point:insert段define
   {<point name="insert.define"/>}
   #end add-point    
   
   #清畫面欄位內容
   CLEAR FORM                    
   CALL g_xmii_d.clear()   
   CALL g_xmii2_d.clear()  
   CALL g_xmii3_d.clear()  
 
 
   INITIALIZE g_xmih_m.* LIKE xmih_t.*             #DEFAULT 設定
   
   LET g_xmih001_t = NULL
   LET g_xmih002_t = NULL
   LET g_xmih003_t = NULL
   LET g_xmih004_t = NULL
 
   
   CALL s_transaction_begin()
   WHILE TRUE
      #公用欄位給值(單頭)
      #此段落由子樣板a14產生    
      LET g_xmih_m.xmihownid = g_user
      LET g_xmih_m.xmihowndp = g_dept
      LET g_xmih_m.xmihcrtid = g_user
      LET g_xmih_m.xmihcrtdp = g_dept 
      LET g_xmih_m.xmihcrtdt = cl_get_current()
      LET g_xmih_m.xmihmodid = ""
      LET g_xmih_m.xmihmoddt = ""
      LET g_xmih_m.xmihstus = "N"
 
 
 
      #append欄位給值
      
     
      #一般欄位給值
      
  
      #add-point:單頭預設值
      {<point name="insert.default"/>}
      #end add-point 
     
      CALL axmt175_input("a")
      
      #add-point:單頭輸入後
      {<point name="insert.after_insert"/>}
      #end add-point
      
      IF INT_FLAG THEN
         LET INT_FLAG = 0
         LET g_xmih_m.* = g_xmih_m_t.*
         CALL axmt175_show()
         CALL cl_err('',9001,0)
         CALL s_transaction_end('N','0')
         EXIT WHILE
      END IF
      
      CALL g_xmii_d.clear()
      CALL g_xmii2_d.clear()
      CALL g_xmii3_d.clear()
 
 
      LET g_rec_b = 0
      CALL s_transaction_end('Y','0')
      EXIT WHILE
        
   END WHILE
   
   #將新增的資料併入搜尋條件中
   LET g_state = "Y"
   LET g_current_idx = 1 
   
   LET g_xmih001_t = g_xmih_m.xmih001
   LET g_xmih002_t = g_xmih_m.xmih002
   LET g_xmih003_t = g_xmih_m.xmih003
   LET g_xmih004_t = g_xmih_m.xmih004
 
   
   LET g_wc = "(",g_wc,  
              " OR ( xmihent = '" ||g_enterprise|| "' AND",
              " xmih001 = '", g_xmih_m.xmih001 CLIPPED, "' "
              ," AND xmih002 = '", g_xmih_m.xmih002 CLIPPED, "' "
              ," AND xmih003 = '", g_xmih_m.xmih003 CLIPPED, "' "
              ," AND xmih004 = '", g_xmih_m.xmih004 CLIPPED, "' "
 
              , ")) "
   
   CLOSE axmt175_cl
   
END FUNCTION
]]>
  </section>
  <section id="axmt175.insert_b" ver="7" status="" src="s">
    <![CDATA[#+ 新增單身後其他table連動
PRIVATE FUNCTION axmt175_insert_b(ps_table,ps_keys,ps_page)
   DEFINE ps_table    STRING
   DEFINE ps_page     STRING
   DEFINE ps_keys     DYNAMIC ARRAY OF VARCHAR(500)
   DEFINE ls_group    STRING
   DEFINE ls_page     STRING
   #add-point:insert_b段define
   {<point name="insert_b.define"/>}
   #end add-point     
   
   #判斷是否是同一群組的table
   LET ls_group = "'1','2','3',"
   IF ls_group.getIndexOf(ps_page,1) > 0 THEN
      #add-point:insert_b段資料新增前
      {<point name="insert_b.before_insert" mark="Y"/>}
      #end add-point 
      INSERT INTO xmii_t
                  (xmiient,
                   xmii001,xmii002,xmii003,xmii004,
                   xmii006,xmii007,xmii008,xmii009,xmii010,xmii011,xmii012,xmii013,xmii014,xmii017
                   ,xmii005,xmii005,xmii005) 
            VALUES(g_enterprise,
                   ps_keys[1],ps_keys[2],ps_keys[3],ps_keys[4],ps_keys[5],ps_keys[6],ps_keys[7],ps_keys[8],ps_keys[9],ps_keys[10],ps_keys[11],ps_keys[12],ps_keys[13],ps_keys[14]
                   ,g_xmii_d[g_detail_idx].xmii005,g_xmii_d[g_detail_idx].xmii005,g_xmii_d[g_detail_idx].xmii005) 

      #add-point:insert_b段資料新增中
      {<point name="insert_b.m_insert"/>}
      #end add-point 
      IF SQLCA.sqlcode THEN
         CALL cl_err("xmii_t",SQLCA.sqlcode,0)
      END IF
      #add-point:insert_b段資料新增後
      {<point name="insert_b.after_insert"/>}
      #end add-point 
   END IF
   
 
   
 
   
   #add-point:insert_b段other
   {<point name="insert_b.other"/>}
   #end add-point     
   
END FUNCTION
]]>
  </section>
  <section id="axmt175.lock_b" ver="4" status="" src="s">
    <![CDATA[#+ 連動lock其他單身table資料
PRIVATE FUNCTION axmt175_lock_b(ps_table,ps_page)
   DEFINE ps_page     STRING
   DEFINE ps_table    STRING
   DEFINE ls_group    STRING
   #add-point:lock_b段define
   {<point name="lock_b.define"/>}
   #end add-point   
   
   #先刷新資料
   #CALL axmt175_b_fill()
   
   #鎖定整組table
   #LET ls_group = "'1','2','3',"
   #僅鎖定自身table
   LET ls_group = "xmii_t"
   
   IF ls_group.getIndexOf(ps_table,1) THEN
      OPEN axmt175_bcl USING g_enterprise,
                                       g_xmih_m.xmih001,g_xmih_m.xmih002,g_xmih_m.xmih003,g_xmih_m.xmih004, 
                                           g_xmii_d[g_detail_idx].xmii006,g_xmii_d[g_detail_idx].xmii007, 
                                           g_xmii_d[g_detail_idx].xmii008,g_xmii_d[g_detail_idx].xmii009, 
                                           g_xmii_d[g_detail_idx].xmii010,g_xmii_d[g_detail_idx].xmii011, 
                                           g_xmii_d[g_detail_idx].xmii012,g_xmii_d[g_detail_idx].xmii013, 
                                           g_xmii_d[g_detail_idx].xmii014,g_xmii_d[g_detail_idx].xmii017  
                                               
      IF SQLCA.sqlcode THEN
         CALL cl_err("axmt175_bcl",SQLCA.sqlcode,1)
         RETURN FALSE
      END IF
   END IF
                                    
 
   
 
   
   #add-point:lock_b段other
   {<point name="lock_b.other"/>}
   #end add-point  
   
   RETURN TRUE
 
END FUNCTION
]]>
  </section>
  <section id="axmt175.main" ver="13" status="" src="s">
    <![CDATA[#+ 此段落由子樣板a26產生
#OPTIONS SHORT CIRCUIT
#+ 作業開始 
MAIN
   #add-point:main段define
   {<point name="main.define"/>}
   #end add-point   
 
   OPTIONS
   INPUT NO WRAP
   DEFER INTERRUPT
   
   #設定SQL錯誤記錄方式 (模組內定義有效)
   WHENEVER ERROR CALL cl_err_msg_log
       
   #依模組進行系統初始化設定(系統設定)
   CALL cl_ap_init("axm","")
 
   #add-point:作業初始化
   {<point name="main.init" />}
   #end add-point
   
   
 
   #LOCK CURSOR (identifier)
   #add-point:SQL_define
   {<point name="main.define_sql" />}
   #end add-point
   LET g_forupd_sql = " SELECT xmih001,'',xmih004,'','','',xmih002,xmih005,'',xmih003,'',xmihstus,xmihownid, 
       '',xmihcrtdp,'',xmihowndp,'',xmihcrtdt,xmihcrtid,'',xmihmodid,'',xmihcnfid,'',xmihmoddt,xmihcnfdt", 
        
                      " FROM xmih_t",
                      " WHERE xmihent= ? AND xmih001=? AND xmih002=? AND xmih003=? AND xmih004=? FOR  
                          UPDATE"
   #add-point:SQL_define
   {<point name="main.after_define_sql"/>}
   #end add-point
   LET g_forupd_sql = cl_sql_forupd(g_forupd_sql)                #轉換不同資料庫語法
   LET g_forupd_sql = cl_sql_add_mask(g_forupd_sql)              #遮蔽特定資料
   DECLARE axmt175_cl CURSOR FROM g_forupd_sql                 # LOCK CURSOR
 
   LET g_sql = " SELECT UNIQUE xmih001,xmih004,xmih002,xmih005,xmih003,xmihstus,xmihownid,xmihcrtdp, 
       xmihowndp,xmihcrtdt,xmihcrtid,xmihmodid,xmihcnfid,xmihmoddt,xmihcnfdt,t1.xmial003 ,t2.ooefl003 , 
       t4.ooefl003 ,t5.ooag011 ,t6.ooefl003 ,t7.ooefl003 ,t8.ooag011 ,t9.ooag011 ,t10.ooag011",
               " FROM xmih_t",
                              " LEFT JOIN xmial_t t1 ON t1.xmialent='"||g_enterprise||"' AND t1.xmial001=xmih001 AND t1.xmial002='"||g_dlang||"' ",
               " LEFT JOIN ooefl_t t2 ON t2.ooeflent='"||g_enterprise||"' AND t2.ooefl001=xmih004 AND t2.ooefl002='"||g_dlang||"' ",
               " LEFT JOIN ooefl_t t4 ON t4.ooeflent='"||g_enterprise||"' AND t4.ooefl001=xmih005 AND t4.ooefl002='"||g_dlang||"' ",
               " LEFT JOIN ooag_t t5 ON t5.ooagent='"||g_enterprise||"' AND t5.ooag001=xmihownid  ",
               " LEFT JOIN ooefl_t t6 ON t6.ooeflent='"||g_enterprise||"' AND t6.ooefl001=xmihcrtdp AND t6.ooefl002='"||g_dlang||"' ",
               " LEFT JOIN ooefl_t t7 ON t7.ooeflent='"||g_enterprise||"' AND t7.ooefl001=xmihowndp AND t7.ooefl002='"||g_dlang||"' ",
               " LEFT JOIN ooag_t t8 ON t8.ooagent='"||g_enterprise||"' AND t8.ooag001=xmihcrtid  ",
               " LEFT JOIN ooag_t t9 ON t9.ooagent='"||g_enterprise||"' AND t9.ooag001=xmihmodid  ",
               " LEFT JOIN ooag_t t10 ON t10.ooagent='"||g_enterprise||"' AND t10.ooag001=xmihcnfid  ",
 
               " WHERE xmihent = '" ||g_enterprise|| "' AND xmih001 = ? AND xmih002 = ? AND xmih003 = ? AND xmih004 = ?"
   LET g_sql = cl_sql_add_mask(g_sql)              #遮蔽特定資料
   #add-point:SQL_define
   {<point name="main.after_refresh_sql"/>}
   #end add-point
   PREPARE axmt175_master_referesh FROM g_sql
 
 
 
   
   IF g_bgjob = "Y" THEN
      #add-point:Service Call
      {<point name="main.servicecall" />}
      #end add-point
   ELSE
      #畫面開啟 (identifier)
      OPEN WINDOW w_axmt175 WITH FORM cl_ap_formpath("axm",g_code)
   
      #瀏覽頁簽資料初始化
      CALL cl_ui_init()
   
      #程式初始化
      CALL axmt175_init()   
 
      #進入選單 Menu (="N")
      CALL axmt175_ui_dialog() 
      
      #add-point:畫面關閉前
      {<point name="main.before_close" />}
      #end add-point
 
      #畫面關閉
      CLOSE WINDOW w_axmt175
      
   END IF 
   
   CLOSE axmt175_cl
   
   
 
   #add-point:作業離開前
   {<point name="main.exit" />}
   #end add-point
 
   #離開作業
   CALL cl_ap_exitprogram("0")
   
END MAIN
 
 
]]>
  </section>
  <section id="axmt175.modify" ver="8" status="" src="s">
    <![CDATA[#+ 資料修改
PRIVATE FUNCTION axmt175_modify()
   DEFINE l_new_key    DYNAMIC ARRAY OF STRING
   DEFINE l_old_key    DYNAMIC ARRAY OF STRING
   DEFINE l_field_key  DYNAMIC ARRAY OF STRING
   #add-point:modify段define
   {<point name="modify.define"/>}
   #end add-point    
   
   IF g_xmih_m.xmih001 IS NULL
   OR g_xmih_m.xmih002 IS NULL
   OR g_xmih_m.xmih003 IS NULL
   OR g_xmih_m.xmih004 IS NULL
 
   THEN
      CALL cl_err("","std-00003",0)
      RETURN
   END IF
 
   ERROR ""
  
   LET g_xmih001_t = g_xmih_m.xmih001
   LET g_xmih002_t = g_xmih_m.xmih002
   LET g_xmih003_t = g_xmih_m.xmih003
   LET g_xmih004_t = g_xmih_m.xmih004
 
   CALL s_transaction_begin()
   
   OPEN axmt175_cl USING g_enterprise,g_xmih_m.xmih001,g_xmih_m.xmih002,g_xmih_m.xmih003,g_xmih_m.xmih004
   IF STATUS THEN
      CALL cl_err("OPEN axmt175_cl:", STATUS, 1)
      CLOSE axmt175_cl
      CALL s_transaction_end('N','0')
      RETURN
   END IF
 
   #顯示最新的資料
   EXECUTE axmt175_master_referesh USING g_xmih_m.xmih001,g_xmih_m.xmih002,g_xmih_m.xmih003,g_xmih_m.xmih004 INTO g_xmih_m.xmih001, 
       g_xmih_m.xmih004,g_xmih_m.xmih002,g_xmih_m.xmih005,g_xmih_m.xmih003,g_xmih_m.xmihstus,g_xmih_m.xmihownid, 
       g_xmih_m.xmihcrtdp,g_xmih_m.xmihowndp,g_xmih_m.xmihcrtdt,g_xmih_m.xmihcrtid,g_xmih_m.xmihmodid, 
       g_xmih_m.xmihcnfid,g_xmih_m.xmihmoddt,g_xmih_m.xmihcnfdt,g_xmih_m.xmih001_desc,g_xmih_m.xmih004_desc, 
       g_xmih_m.xmih005_desc,g_xmih_m.xmihownid_desc,g_xmih_m.xmihcrtdp_desc,g_xmih_m.xmihowndp_desc, 
       g_xmih_m.xmihcrtid_desc,g_xmih_m.xmihmodid_desc,g_xmih_m.xmihcnfid_desc
 
   #資料被他人LOCK, 或是sql執行時出現錯誤
   IF SQLCA.sqlcode THEN
      CALL cl_err(g_xmih_m.xmih001,SQLCA.sqlcode,0)
      CLOSE axmt175_cl
      CALL s_transaction_end('N','0')
      RETURN
   END IF
   
   
   
   #add-point:modify段show之前
   {<point name="modify.before_show"/>}
   #end add-point  
   
   CALL axmt175_show()
   WHILE TRUE
      LET g_xmih001_t = g_xmih_m.xmih001
      LET g_xmih002_t = g_xmih_m.xmih002
      LET g_xmih003_t = g_xmih_m.xmih003
      LET g_xmih004_t = g_xmih_m.xmih004
 
      
      #寫入修改者/修改日期資訊(單頭)
      LET g_xmih_m.xmihmodid = g_user 
LET g_xmih_m.xmihmoddt = cl_get_current()
 
      
      #add-point:modify段修改前
      {<point name="modify.before_input"/>}
      #end add-point
      
      #欄位更改
      CALL axmt175_input("u")
 
      #add-point:modify段修改後
      {<point name="modify.after_input"/>}
      #end add-point
      
      IF INT_FLAG THEN
         LET INT_FLAG = 0
         LET g_xmih_m.* = g_xmih_m_t.*
         CALL axmt175_show()
         CALL cl_err('',9001,0)
         CALL s_transaction_end('N','0')
         EXIT WHILE
      END IF 
      
      #若有modid跟moddt則進行update
      UPDATE xmih_t SET (xmihmodid,xmihmoddt) = (g_xmih_m.xmihmodid,g_xmih_m.xmihmoddt)
       WHERE xmihent = g_enterprise AND xmih001 = g_xmih001_t
         AND xmih002 = g_xmih002_t
         AND xmih003 = g_xmih003_t
         AND xmih004 = g_xmih004_t
 
                  
      #若單頭key欄位有變更
      IF g_xmih_m.xmih001 != g_xmih001_t 
      OR g_xmih_m.xmih002 != g_xmih002_t 
      OR g_xmih_m.xmih003 != g_xmih003_t 
      OR g_xmih_m.xmih004 != g_xmih004_t 
 
      THEN
         CALL s_transaction_begin()
         
         #add-point:單身fk修改前
         {<point name="modify.body.b_fk_update" mark="Y"/>}
         #end add-point
         
         #更新單身key值
         UPDATE xmii_t SET xmii001 = g_xmih_m.xmih001
                                       ,xmii002 = g_xmih_m.xmih002
                                       ,xmii003 = g_xmih_m.xmih003
                                       ,xmii004 = g_xmih_m.xmih004
 
          WHERE xmiient = g_enterprise AND xmii001 = g_xmih001_t
            AND xmii002 = g_xmih002_t
            AND xmii003 = g_xmih003_t
            AND xmii004 = g_xmih004_t
 
            
         #add-point:單身fk修改中
         {<point name="modify.body.m_fk_update"/>}
         #end add-point
 
         CASE
            WHEN SQLCA.sqlerrd[3] = 0  #更新不到的處理
               CALL cl_err("xmii_t","std-00009",1)
               CALL s_transaction_end('N','0')
               CONTINUE WHILE
            WHEN SQLCA.sqlcode #其他錯誤
               CALL cl_err("xmii_t",SQLCA.sqlcode,1)  
               CALL s_transaction_end('N','0')
               CONTINUE WHILE
         END CASE
         
         #add-point:單身fk修改後
         {<point name="modify.body.a_fk_update"/>}
         #end add-point
         
 
         
 
         
         #UPDATE 多語言table key值
         
         
         
 
         CALL s_transaction_end('Y','0')
      END IF
    
      EXIT WHILE
   END WHILE
 
   #修改歷程記錄
   #IF NOT cl_log_modified_record(g_xmih_m.xmih001,g_site) THEN 
   #   CALL s_transaction_end('N','0')
   #END IF
 
   CLOSE axmt175_cl
   CALL s_transaction_end('Y','0')
 
   #流程通知預埋點-U
   CALL cl_flow_notify(g_xmih_m.xmih001,'U')
 
END FUNCTION   
]]>
  </section>
  <section id="axmt175.other_dialog" ver="2" status="" src="s">
    <![CDATA[   
]]>
  </section>
  <section id="axmt175.other_function" ver="1" status="" src="s">
    <![CDATA[{<point name="other.function"/>}
]]>
  </section>
  <section id="axmt175.query" ver="3" status="" src="s">
    <![CDATA[#+ 資料查詢QBE功能準備
PRIVATE FUNCTION axmt175_query()
   DEFINE ls_wc STRING
   #add-point:query段define
   {<point name="query.define"/>}
   #end add-point   
 
   #切換畫面
   IF g_main_hidden THEN
      CALL gfrm_curr.setElementHidden("mainlayout",0)
      CALL gfrm_curr.setElementHidden("worksheet",1)
      LET g_main_hidden = 0
   END IF   
   
   LET ls_wc = g_wc
   
   LET INT_FLAG = 0
   CALL cl_navigator_setting( g_current_idx, g_detail_cnt )
   ERROR ""
   
   #清除畫面及相關資料
   CLEAR FORM
   CALL g_browser.clear()       
   CALL g_xmii_d.clear()
   CALL g_xmii2_d.clear()
   CALL g_xmii3_d.clear()
 
   
   #add-point:query段other
   {<point name="query.other"/>}
   #end add-point   
   
   DISPLAY ' ' TO FORMONLY.idx
   DISPLAY ' ' TO FORMONLY.cnt
   DISPLAY ' ' TO FORMONLY.b_index
   DISPLAY ' ' TO FORMONLY.b_count
   DISPLAY ' ' TO FORMONLY.h_index
   DISPLAY ' ' TO FORMONLY.h_count
   
   CALL axmt175_construct()
 
   IF INT_FLAG THEN
      #取消查詢
      LET INT_FLAG = 0
      LET g_wc = ls_wc
      CALL axmt175_browser_fill("")
      CALL axmt175_fetch("")
      RETURN
   END IF
   
   #儲存WC資訊
   CALL cl_dlg_save_user_latestqry("("||g_wc||") AND ("||g_wc2||")")
   
   #搜尋後資料初始化 
   LET g_detail_cnt  = 0
   LET g_current_idx = 1
   LET g_current_row = 0
   LET g_detail_idx  = 1
   LET g_detail_idx2 = 1
   LET g_error_show  = 1
   LET g_wc_filter   = ""
   LET l_ac = 1
   CALL FGL_SET_ARR_CURR(1)
      CALL axmt175_filter_show('xmih001')
   CALL axmt175_filter_show('xmih002')
   CALL axmt175_filter_show('xmih003')
   CALL axmt175_filter_show('xmih004')
   CALL axmt175_browser_fill("F")
         
   IF g_browser_cnt = 0 THEN
      CALL cl_err("","-100",1)
   ELSE
      CALL axmt175_fetch("F") 
   END IF
 
END FUNCTION
]]>
  </section>
  <section id="axmt175.reproduce" ver="6" status="" src="s">
    <![CDATA[#+ 資料複製
PRIVATE FUNCTION axmt175_reproduce()
   DEFINE l_newno     LIKE xmih_t.xmih001 
   DEFINE l_oldno     LIKE xmih_t.xmih001 
   DEFINE l_newno02     LIKE xmih_t.xmih002 
   DEFINE l_oldno02     LIKE xmih_t.xmih002 
   DEFINE l_newno03     LIKE xmih_t.xmih003 
   DEFINE l_oldno03     LIKE xmih_t.xmih003 
   DEFINE l_newno04     LIKE xmih_t.xmih004 
   DEFINE l_oldno04     LIKE xmih_t.xmih004 
 
   DEFINE l_master    RECORD LIKE xmih_t.*
   DEFINE l_detail    RECORD LIKE xmii_t.*
 
 
   DEFINE l_cnt       LIKE type_t.num5
   #add-point:reproduce段define
   {<point name="reproduce.define"/>}
   #end add-point   
 
   #切換畫面
   IF g_main_hidden THEN
      CALL gfrm_curr.setElementHidden("mainlayout",0)
      CALL gfrm_curr.setElementHidden("worksheet",1)
      LET g_main_hidden = 0
   END IF
   
   IF g_xmih_m.xmih001 IS NULL
   OR g_xmih_m.xmih002 IS NULL
   OR g_xmih_m.xmih003 IS NULL
   OR g_xmih_m.xmih004 IS NULL
 
   THEN
      CALL cl_err("","std-00003",0)
      RETURN
   END IF
    
   LET g_xmih001_t = g_xmih_m.xmih001
   LET g_xmih002_t = g_xmih_m.xmih002
   LET g_xmih003_t = g_xmih_m.xmih003
   LET g_xmih004_t = g_xmih_m.xmih004
 
    
   LET g_xmih_m.xmih001 = ""
   LET g_xmih_m.xmih002 = ""
   LET g_xmih_m.xmih003 = ""
   LET g_xmih_m.xmih004 = ""
 
    
   CALL axmt175_set_entry('a')
   CALL axmt175_set_no_entry('a')
 
   CALL cl_set_head_visible("","YES")
 
   #公用欄位給予預設值
   #此段落由子樣板a14產生    
      LET g_xmih_m.xmihownid = g_user
      LET g_xmih_m.xmihowndp = g_dept
      LET g_xmih_m.xmihcrtid = g_user
      LET g_xmih_m.xmihcrtdp = g_dept 
      LET g_xmih_m.xmihcrtdt = cl_get_current()
      LET g_xmih_m.xmihmodid = ""
      LET g_xmih_m.xmihmoddt = ""
      LET g_xmih_m.xmihstus = "N"
 
 
   
   CALL s_transaction_begin()
   
   #add-point:複製輸入前
   {<point name="reproduce.head.b_input"/>}
   #end add-point
   
   CALL axmt175_input("r")
   
      LET g_xmih_m.xmih001_desc = ''
   DISPLAY BY NAME g_xmih_m.xmih001_desc
   LET g_xmih_m.xmih004_desc = ''
   DISPLAY BY NAME g_xmih_m.xmih004_desc
 
   
   IF INT_FLAG THEN
      LET INT_FLAG = 0
      RETURN
   END IF
   
   #將新增的資料併入搜尋條件中
   LET g_state = "Y"
   LET g_current_idx = 1 
   
   LET g_wc = "(",g_wc,  
              " OR (",
              " xmih001 = '", g_xmih_m.xmih001 CLIPPED, "' "
              ," AND xmih002 = '", g_xmih_m.xmih002 CLIPPED, "' "
              ," AND xmih003 = '", g_xmih_m.xmih003 CLIPPED, "' "
              ," AND xmih004 = '", g_xmih_m.xmih004 CLIPPED, "' "
 
              , ")) "
   
   #add-point:完成複製段落後
   {<point name="reproduce.after_reproduce" />}
   #end add-point
   
END FUNCTION
]]>
  </section>
  <section id="axmt175.set_entry" ver="1" status="" src="s">
    <![CDATA[#+ 單頭欄位開啟設定
PRIVATE FUNCTION axmt175_set_entry(p_cmd)
   DEFINE p_cmd   LIKE type_t.chr1  
   #add-point:set_entry段define
   {<point name="set_entry.define"/>}
   #end add-point       
 
   IF p_cmd = 'a' THEN
      CALL cl_set_comp_entry("xmih001,xmih002,xmih003,xmih004",TRUE)
      #add-point:set_entry段欄位控制
      {<point name="set_entry.field_control"/>}
      #end add-point  
   END IF
   
   #add-point:set_entry段欄位控制後
   {<point name="set_entry.after_control"/>}
   #end add-point 
 
END FUNCTION
]]>
  </section>
  <section id="axmt175.set_entry_b" ver="1" status="" src="s">
    <![CDATA[#+ 單身欄位開啟設定
PRIVATE FUNCTION axmt175_set_entry_b(p_cmd)
   DEFINE p_cmd   LIKE type_t.chr1   
   #add-point:set_entry_b段define
   {<point name="set_entry_b.define"/>}
   #end add-point     
   #add-point:set_entry_b段
   {<point name="set_entry_b.set_entry_b"/>}
   #end add-point  
END FUNCTION
]]>
  </section>
  <section id="axmt175.set_no_entry" ver="2" status="" src="s">
    <![CDATA[#+ 單頭欄位關閉設定
PRIVATE FUNCTION axmt175_set_no_entry(p_cmd)
   DEFINE p_cmd   LIKE type_t.chr1   
   #add-point:set_no_entry段define
   {<point name="set_no_entry.define"/>}
   #end add-point     
 
   IF p_cmd = 'u' AND g_chkey = 'N' THEN
      CALL cl_set_comp_entry("xmih001,xmih002,xmih003,xmih004",FALSE)
      #add-point:set_no_entry段欄位控制
      {<point name="set_no_entry.field_control"/>}
      #end add-point 
   END IF 
   
   #add-point:set_no_entry段欄位控制後
   {<point name="set_no_entry.after_control"/>}
   #end add-point 
 
END FUNCTION
]]>
  </section>
  <section id="axmt175.set_no_entry_b" ver="1" status="" src="s">
    <![CDATA[#+ 單身欄位關閉設定
PRIVATE FUNCTION axmt175_set_no_entry_b(p_cmd)
   DEFINE p_cmd   LIKE type_t.chr1   
   #add-point:set_no_entry_b段define
   {<point name="set_no_entry_b.define"/>}
   #end add-point    
   #add-point:set_no_entry_b段
   {<point name="set_no_entry_b.set_no_entry_b"/>}
   #end add-point     
END FUNCTION
]]>
  </section>
  <section id="axmt175.set_pk_array" ver="1" status="" src="s">
    <![CDATA[   #+ 此段落由子樣板a51產生
#+ 給予pk_array內容
PRIVATE FUNCTION axmt175_set_pk_array()
   #add-point:set_pk_array段define
   {<point name="set_pk_array.define"/>}
   #end add-point
   
   #add-point:set_pk_array段之前
   {<point name="set_pk_array.before"/>}
   #end add-point  
   
   CALL g_pk_array.clear()
   LET g_pk_array[1].values = g_xmih_m.xmih001
   LET g_pk_array[1].column = 'xmih001'
   LET g_pk_array[2].values = g_xmih_m.xmih002
   LET g_pk_array[2].column = 'xmih002'
   LET g_pk_array[3].values = g_xmih_m.xmih003
   LET g_pk_array[3].column = 'xmih003'
   LET g_pk_array[4].values = g_xmih_m.xmih004
   LET g_pk_array[4].column = 'xmih004'
   
   #add-point:set_pk_array段之後
   {<point name="set_pk_array.after"/>}
   #end add-point  
   
END FUNCTION
 
 
]]>
  </section>
  <section id="axmt175.show" ver="8" status="" src="s">
    <![CDATA[#+ 單頭資料重新顯示及單身資料重抓
PRIVATE FUNCTION axmt175_show()
   DEFINE l_ac_t    LIKE type_t.num5
   #add-point:show段define
   {<point name="show.define"/>}
   #end add-point  
 
   #add-point:show段之前
   {<point name="show.before"/>}
   #end add-point
   
   
   
   IF g_bfill = "Y" THEN
      CALL axmt175_b_fill() #單身填充
      CALL axmt175_b_fill2('0') #單身填充
   END IF
     
   #帶出公用欄位reference值
   #此段落由子樣板a12產生
      #LET g_xmih_m.xmihownid_desc = cl_get_username(g_xmih_m.xmihownid)
      #LET g_xmih_m.xmihowndp_desc = cl_get_deptname(g_xmih_m.xmihowndp)
      #LET g_xmih_m.xmihcrtid_desc = cl_get_username(g_xmih_m.xmihcrtid)
      #LET g_xmih_m.xmihcrtdp_desc = cl_get_deptname(g_xmih_m.xmihcrtdp)
      #LET g_xmih_m.xmihmodid_desc = cl_get_username(g_xmih_m.xmihmodid)
      #LET g_xmih_m.xmihcnfid_desc = cl_get_deptname(g_xmih_m.xmihcnfid)
      
 
 
   
   #顯示followup圖示
   #+ 此段落由子樣板a48產生
   CALL axmt175_set_pk_array()
   #add-point:ON ACTION agendum
   {<point name="show.follow_pic"/>}
   #END add-point
   CALL cl_user_overview_set_follow_pic()
 
 
   
   LET l_ac_t = l_ac
   
   #讀入ref值(單頭)
   #add-point:show段reference
   {<point name="show.head.reference"/>}
   #end add-point
   
   #將資料輸出到畫面上
   DISPLAY BY NAME g_xmih_m.xmih001,g_xmih_m.xmih001_desc,g_xmih_m.xmih004,g_xmih_m.xmih004_desc,g_xmih_m.ooai001, 
       g_xmih_m.ooai001_desc,g_xmih_m.xmih002,g_xmih_m.xmih005,g_xmih_m.xmih005_desc,g_xmih_m.xmih003, 
       g_xmih_m.xmih005_stus,g_xmih_m.xmihstus,g_xmih_m.xmihownid,g_xmih_m.xmihownid_desc,g_xmih_m.xmihcrtdp, 
       g_xmih_m.xmihcrtdp_desc,g_xmih_m.xmihowndp,g_xmih_m.xmihowndp_desc,g_xmih_m.xmihcrtdt,g_xmih_m.xmihcrtid, 
       g_xmih_m.xmihcrtid_desc,g_xmih_m.xmihmodid,g_xmih_m.xmihmodid_desc,g_xmih_m.xmihcnfid,g_xmih_m.xmihcnfid_desc, 
       g_xmih_m.xmihmoddt,g_xmih_m.xmihcnfdt
   
   #顯示狀態(stus)圖片
         #此段落由子樣板a21產生
      CASE g_xmih_m.xmihstus
         WHEN "N"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/unconfirmed.png")
         WHEN "Y"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/confirmed.png")
         WHEN "C"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/closed.png")
         
      END CASE
 
 
   
   #讀入ref值(單身)
   FOR l_ac = 1 TO g_xmii_d.getLength()
      #add-point:show段單身reference
      {<point name="show.body.reference"/>}
      #end add-point
   END FOR
   
   FOR l_ac = 1 TO g_xmii2_d.getLength()
      #add-point:show段單身reference
      {<point name="show.body2.reference"/>}
      #end add-point
   END FOR
   FOR l_ac = 1 TO g_xmii3_d.getLength()
      #add-point:show段單身reference
      {<point name="show.body3.reference"/>}
      #end add-point
   END FOR
 
   
    
   
   #add-point:show段other
   {<point name="show.other"/>}
   #end add-point  
   
   LET l_ac = l_ac_t
   
   #移動上下筆可以連動切換資料
   CALL cl_show_fld_cont()     
 
   CALL axmt175_detail_show()
   
   #add-point:show段之後
   {<point name="show.after"/>}
   #end add-point
   
END FUNCTION
]]>
  </section>
  <section id="axmt175.signature" ver="1" status="" src="s">
    <![CDATA[   
]]>
  </section>
  <section id="axmt175.state_change" ver="3" status="" src="s">
    <![CDATA[   #+ 此段落由子樣板a09產生
#+ 確認碼變更
PRIVATE FUNCTION axmt175_statechange()
   DEFINE lc_state LIKE type_t.chr5
   #add-point:statechange段define
   {<point name="statechange.define"/>}
   #end add-point  
   
   #add-point:statechange段開始前
   {<point name="statechange.before"/>}
   #end add-point  
   
   ERROR ""     #清空畫面右下側ERROR區塊
 
   IF g_xmih_m.xmih001 IS NULL
      OR g_xmih_m.xmih002 IS NULL      OR g_xmih_m.xmih003 IS NULL      OR g_xmih_m.xmih004 IS NULL
   THEN
      CALL cl_err("","std-00003",0)
      RETURN
   END IF
 
   MENU "" ATTRIBUTES (STYLE="popup")
      BEFORE MENU
         HIDE OPTION "approved"
         HIDE OPTION "rejection"
         CASE g_xmih_m.xmihstus
            WHEN "N"
               HIDE OPTION "unconfirmed"
            WHEN "Y"
               HIDE OPTION "confirmed"
            WHEN "C"
               HIDE OPTION "closed"
            
         END CASE
     
      #add-point:menu前
      {<point name="statechange.before_menu"/>}
      #end add-point
      
      ON ACTION unconfirmed
         LET lc_state = "N"
         #add-point:action控制
         {<point name="statechange.unconfirmed"/>}
         #end add-point
         EXIT MENU
      ON ACTION confirmed
         LET lc_state = "Y"
         #add-point:action控制
         {<point name="statechange.confirmed"/>}
         #end add-point
         EXIT MENU
      ON ACTION closed
         LET lc_state = "C"
         #add-point:action控制
         {<point name="statechange.closed"/>}
         #end add-point
         EXIT MENU
      
      
      
      #add-point:stus控制
      {<point name="statechange.more_control"/>}
      #end add-point
      
   END MENU
   
   IF (lc_state <> "N" 
      AND lc_state <> "Y"
      AND lc_state <> "C"
      ) OR 
      cl_null(lc_state) THEN
      RETURN
   END IF
   
   #add-point:stus修改前
   {<point name="statechange.b_update"/>}
   #end add-point
      
   UPDATE xmih_t SET xmihstus = lc_state 
    WHERE xmihent = g_enterprise AND xmih001 = g_xmih_m.xmih001
      AND xmih002 = g_xmih_m.xmih002      AND xmih003 = g_xmih_m.xmih003      AND xmih004 = g_xmih_m.xmih004
  
   IF SQLCA.sqlcode THEN
      CALL cl_err("",SQLCA.sqlcode,0)
   ELSE
      CASE lc_state
         WHEN "N"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/unconfirmed.png")
         WHEN "Y"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/confirmed.png")
         WHEN "C"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/closed.png")
         
      END CASE
      LET g_xmih_m.xmihstus = lc_state
      DISPLAY BY NAME g_xmih_m.xmihstus
   END IF
 
   #add-point:stus修改後
   {<point name="statechange.a_update"/>}
   #end add-point
 
   #add-point:statechange段結束前
   {<point name="statechange.after"/>}
   #end add-point  
 
END FUNCTION
 
 
]]>
  </section>
  <section id="axmt175.ui_browser_refresh" ver="3" status="" src="s">
    <![CDATA[#+ 瀏覽頁簽資料重新顯示
PRIVATE FUNCTION axmt175_ui_browser_refresh()
   DEFINE l_i  LIKE type_t.num10
   #add-point:ui_browser_refresh段define
   {<point name="ui_browser_refresh.define"/>}
   #end add-point    
   
   FOR l_i =1 TO g_browser.getLength()
      IF g_browser[l_i].b_xmih001 = g_xmih_m.xmih001 
         AND g_browser[l_i].b_xmih002 = g_xmih_m.xmih002 
         AND g_browser[l_i].b_xmih003 = g_xmih_m.xmih003 
         AND g_browser[l_i].b_xmih004 = g_xmih_m.xmih004 
 
         THEN  
         CALL g_browser.deleteElement(l_i)
         LET g_header_cnt = g_header_cnt - 1
         EXIT FOR
      END IF
   END FOR
 
   LET g_browser_cnt = g_browser_cnt - 1
   IF g_current_row > g_browser_cnt THEN        #確定browse 筆數指在同一筆
      LET g_current_row = g_browser_cnt
   END IF
 
   #DISPLAY g_browser_cnt TO FORMONLY.b_count    #總筆數的顯示
   
END FUNCTION
]]>
  </section>
  <section id="axmt175.ui_detailshow" ver="2" status="" src="s">
    <![CDATA[#+ 單身資料重新顯示
PRIVATE FUNCTION axmt175_ui_detailshow()
   #add-point:ui_detailshow段define
   {<point name="ui_detailshow.define"/>}
   #end add-point    
   
   #add-point:ui_detailshow段before
   {<point name="ui_detailshow.before"/>}
   #end add-point    
   
   IF g_curr_diag IS NOT NULL THEN
      CALL g_curr_diag.setCurrentRow("s_detail1",g_detail_idx)      
      CALL g_curr_diag.setCurrentRow("s_detail2",g_detail_idx)
      CALL g_curr_diag.setCurrentRow("s_detail3",g_detail_idx)
 
   END IF
   
   #add-point:ui_detailshow段after
   {<point name="ui_detailshow.after"/>}
   #end add-point    
   
END FUNCTION
]]>
  </section>
  <section id="axmt175.ui_dialog" ver="45" status="" src="s">
    <![CDATA[#+ 功能選單
PRIVATE FUNCTION axmt175_ui_dialog()
   DEFINE li_idx    LIKE type_t.num5
   DEFINE ls_wc     STRING
   DEFINE lb_first  BOOLEAN
   DEFINE la_param  RECORD
             prog   STRING,
             param  DYNAMIC ARRAY OF STRING
                    END RECORD
   DEFINE ls_js     STRING
   #add-point:ui_dialog段define
   {<point name="ui_dialog.define"/>}
   #end add-point
   
   CALL cl_set_act_visible("accept,cancel", FALSE)
 
   CALL gfrm_curr.setElementImage("logo","logo/applogo.png") 
   IF g_default THEN
      CALL gfrm_curr.setElementHidden("mainlayout",0)
      CALL gfrm_curr.setElementHidden("worksheet",1)
      LET g_main_hidden = 0
   ELSE
      CALL gfrm_curr.setElementHidden("mainlayout",1)
      CALL gfrm_curr.setElementHidden("worksheet",0)
      LET g_main_hidden = 1
   END IF
   
   #action default動作
   #+ 此段落由子樣板a42產生
   CASE g_actdefault
      WHEN "insert"
         LET g_action_choice="insert"
         LET g_actdefault = ""
         IF cl_auth_chk_act("insert") THEN
            CALL axmt175_insert()
            #add-point:ON ACTION insert
            {<point name="menu.default.insert" />}
            #END add-point
         END IF
 
      #add-point:action default自訂
      {<point name="ui_dialog.action_default"/>}
      #end add-point
      OTHERWISE
         
   END CASE
 
 
   
   LET lb_first = TRUE
   
   #add-point:ui_dialog段before dialog 
   {<point name="ui_dialog.before_dialog"/>}
   #end add-point
   
   WHILE TRUE 
   
      CALL axmt175_browser_fill("")
      CALL lib_cl_dlg.cl_dlg_before_display()
      CALL cl_notice()
            
      #判斷前一個動作是否為新增, 若是的話切換到新增的筆數
      IF g_state = "Y" THEN
         FOR li_idx = 1 TO g_browser.getLength()
            IF g_browser[li_idx].b_xmih001 = g_xmih001_t
               AND g_browser[li_idx].b_xmih002 = g_xmih002_t
               AND g_browser[li_idx].b_xmih003 = g_xmih003_t
               AND g_browser[li_idx].b_xmih004 = g_xmih004_t
 
               THEN
               LET g_current_row = li_idx
               LET g_current_idx = li_idx
               EXIT FOR
            END IF
         END FOR
         LET g_state = ""
      END IF
            
      DIALOG ATTRIBUTES(UNBUFFERED,FIELD ORDER FORM)
 
         #左側瀏覽頁簽
         DISPLAY ARRAY g_browser TO s_browse.* ATTRIBUTES(COUNT=g_header_cnt)
 
            BEFORE ROW
               #回歸舊筆數位置 (回到當時異動的筆數)
               LET g_current_idx = DIALOG.getCurrentRow("s_browse")
               IF g_current_row > 1 AND g_current_idx = 1 AND g_current_sw = FALSE THEN
                  CALL DIALOG.setCurrentRow("s_browse",g_current_row)
                  LET g_current_idx = g_current_row
               END IF
               LET g_current_row = g_current_idx #目前指標
               LET g_current_sw = TRUE
 
               IF g_current_idx > g_browser.getLength() THEN
                  LET g_current_idx = g_browser.getLength()
               END IF 
               
               CALL axmt175_fetch('') # reload data
               LET l_ac = 1
               CALL axmt175_ui_detailshow() #Setting the current row 
      
               CALL axmt175_idx_chk()
               #NEXT FIELD xmii006
         
         END DISPLAY
        
         DISPLAY ARRAY g_xmii_d TO s_detail1.* ATTRIBUTES(COUNT=g_rec_b) #page1  
    
            BEFORE ROW
               CALL axmt175_idx_chk()
               LET l_ac = DIALOG.getCurrentRow("s_detail1")
               LET g_detail_idx = l_ac
               
               #add-point:page1, before row動作
               {<point name="ui_dialog.page1.before_row"/>}
               #end add-point
               
            BEFORE DISPLAY
               #如果一直都在單頭則控制筆數位置
               IF g_loc = 'm' THEN
                  CALL FGL_SET_ARR_CURR(g_detail_idx)
               END IF
               LET g_loc = 'm'
               LET l_ac = DIALOG.getCurrentRow("s_detail1")
               LET g_current_page = 1
               CALL axmt175_idx_chk()
               #add-point:page1自定義行為
               {<point name="ui_dialog.page1.before_display"/>}
               #end add-point
               
            #自訂ACTION(detail_show,page_1)
            
               
            #add-point:page1自定義行為
            {<point name="ui_dialog.page1.action"/>}
            #end add-point
               
         END DISPLAY
        
         DISPLAY ARRAY g_xmii2_d TO s_detail2.* ATTRIBUTES(COUNT=g_rec_b)  
    
            BEFORE ROW
               CALL axmt175_idx_chk()
               LET l_ac = DIALOG.getCurrentRow("s_detail2")
               LET g_detail_idx = l_ac
               
               #add-point:page2, before row動作
               {<point name="ui_dialog.body2.before_row"/>}
               #end add-point
               
            BEFORE DISPLAY
               #如果一直都在單頭則控制筆數位置
               IF g_loc = 'm' THEN
                  CALL FGL_SET_ARR_CURR(g_detail_idx)
               END IF
               LET g_loc = 'm'
               LET l_ac = DIALOG.getCurrentRow("s_detail2")
               LET g_current_page = 2
               CALL axmt175_idx_chk()
               #add-point:page2自定義行為
               {<point name="ui_dialog.body2.before_display"/>}
               #end add-point
      
            #自訂ACTION(detail_show,page_2)
            
         
            #add-point:page2自定義行為
            {<point name="ui_dialog.body2.action"/>}
            #end add-point
         
         END DISPLAY
         DISPLAY ARRAY g_xmii3_d TO s_detail3.* ATTRIBUTES(COUNT=g_rec_b)  
    
            BEFORE ROW
               CALL axmt175_idx_chk()
               LET l_ac = DIALOG.getCurrentRow("s_detail3")
               LET g_detail_idx = l_ac
               
               #add-point:page3, before row動作
               {<point name="ui_dialog.body3.before_row"/>}
               #end add-point
               
            BEFORE DISPLAY
               #如果一直都在單頭則控制筆數位置
               IF g_loc = 'm' THEN
                  CALL FGL_SET_ARR_CURR(g_detail_idx)
               END IF
               LET g_loc = 'm'
               LET l_ac = DIALOG.getCurrentRow("s_detail3")
               LET g_current_page = 3
               CALL axmt175_idx_chk()
               #add-point:page3自定義行為
               {<point name="ui_dialog.body3.before_display"/>}
               #end add-point
      
            #自訂ACTION(detail_show,page_3)
            
         
            #add-point:page3自定義行為
            {<point name="ui_dialog.body3.action"/>}
            #end add-point
         
         END DISPLAY
 
         
 
         
         #add-point:ui_dialog段自定義display array
         {<point name="ui_dialog.more_displayarray"/>}
         #end add-point
         
         SUBDIALOG lib_cl_dlg.cl_dlg_qryplan
         SUBDIALOG lib_cl_dlg.cl_dlg_relateapps
      
         BEFORE DIALOG
            CALL cl_navigator_setting(g_current_idx, g_detail_cnt)
            LET g_curr_diag = ui.DIALOG.getCurrent()
            LET g_page = "first"
            LET g_current_sw = FALSE
            #回歸舊筆數位置 (回到當時異動的筆數)
            LET g_current_idx = DIALOG.getCurrentRow("s_browse")
            IF g_current_row > 1 AND g_current_idx = 1 AND g_current_sw = FALSE THEN
               CALL DIALOG.setCurrentRow("s_browse",g_current_row)
               LET g_current_idx = g_current_row
            END IF
            LET g_current_row = g_current_idx #目前指標
            IF g_current_idx = 0 THEN
               LET g_current_idx = 1
            END IF
            LET g_current_sw = TRUE
            
            IF g_current_idx > g_browser.getLength() THEN
               LEt g_current_idx = g_browser.getLength()
            END IF 
            
            #有資料才進行fetch
            IF g_current_idx <> 0 THEN
               CALL axmt175_fetch('') # reload data
            END IF
            #LET g_detail_idx = 1
            CALL axmt175_ui_detailshow() #Setting the current row 
            
            #筆數顯示
            LET g_current_page = 1
            CALL axmt175_idx_chk()
            
            #add-point:ui_dialog段before_dialog2
            {<point name="ui_dialog.before_dialog2"/>}
            #end add-point
        
         ON ACTION statechange
            LET g_action_choice = "statechange"
            CALL axmt175_statechange()
            EXIT DIALOG
      
         
          
         ON ACTION queryplansel
            CALL cl_dlg_qryplan_select() RETURNING ls_wc
            #不是空條件才寫入g_wc跟重新找資料
            IF NOT cl_null(ls_wc) THEN
               LET g_wc = ls_wc
               CALL axmt175_browser_fill("F")   #browser_fill()會將notice區塊清空
               CALL cl_notice()   #重新顯示,此處不可用EXIT DIALOG, SUBDIALOG重讀會導致部分變數消失
            END IF
 
         ON ACTION qbe_select
            CALL cl_qbe_list("m") RETURNING ls_wc
            IF NOT cl_null(ls_wc) THEN
               LET g_wc = ls_wc
               #取得條件後需要重查、跳到結果第一筆資料的功能程式段
               CALL axmt175_browser_fill("F")
               IF g_browser_cnt = 0 THEN
                  CALL cl_err("","-100",1)
                  CLEAR FORM
               ELSE
                  CALL axmt175_fetch("F")
               END IF
            END IF
            #重新搜尋會將notice區塊清空,此處不可用EXIT DIALOG, SUBDIALOG重讀會導致部分變數消失
            CALL cl_notice()
          
         #+ 此段落由子樣板a49產生
            ON ACTION filter
               #add-point:filter action
               {<point name="ui_dialog.action.filter"/>}
               #end add-point
               CALL axmt175_filter()
               EXIT DIALOG
 
 
 
         
         ON ACTION first
            CALL axmt175_fetch('F')
            LET g_current_row = g_current_idx
            LET g_curr_diag = ui.DIALOG.getCurrent()
            CALL axmt175_idx_chk()
            
         ON ACTION previous
            CALL axmt175_fetch('P')
            LET g_current_row = g_current_idx
            LET g_curr_diag = ui.DIALOG.getCurrent()
            CALL axmt175_idx_chk()
            
         ON ACTION jump
            CALL axmt175_fetch('/')
            LET g_current_row = g_current_idx
            LET g_curr_diag = ui.DIALOG.getCurrent()
            CALL axmt175_idx_chk()
            
         ON ACTION next
            CALL axmt175_fetch('N')
            LET g_current_row = g_current_idx
            LET g_curr_diag = ui.DIALOG.getCurrent()
            CALL axmt175_idx_chk()
            
         ON ACTION last
            CALL axmt175_fetch('L')
            LET g_current_row = g_current_idx
            LET g_curr_diag = ui.DIALOG.getCurrent()
            CALL axmt175_idx_chk()
            
         ON ACTION close
            LET INT_FLAG = FALSE
            LET g_action_choice = "exit"
            EXIT DIALOG
          
         ON ACTION exit
            LET g_action_choice = "exit"
            EXIT DIALOG
      
         ON ACTION mainhidden       #主頁摺疊
            IF g_main_hidden THEN
               CALL gfrm_curr.setElementHidden("mainlayout",0)
               CALL gfrm_curr.setElementHidden("worksheet",1)
               LET g_main_hidden = 0
            ELSE
               CALL gfrm_curr.setElementHidden("mainlayout",1)
               CALL gfrm_curr.setElementHidden("worksheet",0)
               LET g_main_hidden = 1
            END IF
            
         ON ACTION worksheethidden   #瀏覽頁折疊
            IF g_main_hidden THEN
               CALL gfrm_curr.setElementHidden("mainlayout",0)
               CALL gfrm_curr.setElementHidden("worksheet",1)
               LET g_main_hidden = 0
            ELSE
               CALL gfrm_curr.setElementHidden("mainlayout",1)
               CALL gfrm_curr.setElementHidden("worksheet",0)
               LET g_main_hidden = 1
            END IF
            IF lb_first THEN
               LET lb_first = FALSE
               NEXT FIELD xmii006
            END IF
       
         ON ACTION controls      #單頭摺疊，可利用hot key "Ctrl-s"開啟/關閉單頭
            IF g_header_hidden THEN
               CALL gfrm_curr.setElementHidden("vb_master",0)
               CALL gfrm_curr.setElementImage("controls","small/arr-u.png")
               LET g_header_hidden = 0     #visible
            ELSE
               CALL gfrm_curr.setElementHidden("vb_master",1)
               CALL gfrm_curr.setElementImage("controls","small/arr-d.png")
               LET g_header_hidden = 1     #hidden     
            END IF
    
         
         #+ 此段落由子樣板a43產生
         ON ACTION modify
            LET g_action_choice="modify"
            IF cl_auth_chk_act("modify") THEN
               LET g_aw = ''
               CALL axmt175_modify()
               #add-point:ON ACTION modify
               {<point name="menu.modify" />}
               #END add-point
               EXIT DIALOG
            END IF
 
 
         #+ 此段落由子樣板a43產生
         ON ACTION modify_detail
            LET g_action_choice="modify_detail"
            IF cl_auth_chk_act("modify") THEN
               LET g_aw = g_curr_diag.getCurrentItem()
               CALL axmt175_modify()
               #add-point:ON ACTION modify_detail
               {<point name="menu.modify_detail" />}
               #END add-point
               EXIT DIALOG
            END IF
 
 
         #+ 此段落由子樣板a43產生
         ON ACTION delete
            LET g_action_choice="delete"
            IF cl_auth_chk_act("delete") THEN
               CALL axmt175_delete()
               #add-point:ON ACTION delete
               {<point name="menu.delete" />}
               #END add-point
               
            END IF
 
 
         #+ 此段落由子樣板a43產生
         ON ACTION insert
            LET g_action_choice="insert"
            IF cl_auth_chk_act("insert") THEN
               CALL axmt175_insert()
               #add-point:ON ACTION insert
               {<point name="menu.insert" />}
               #END add-point
               EXIT DIALOG
            END IF
 
 
         #+ 此段落由子樣板a43產生
         ON ACTION output
            LET g_action_choice="output"
            IF cl_auth_chk_act("output") THEN
               
               #add-point:ON ACTION output
               {<point name="menu.output" />}
               #END add-point
               EXIT DIALOG
            END IF
 
 
         #+ 此段落由子樣板a43產生
         ON ACTION reproduce
            LET g_action_choice="reproduce"
            IF cl_auth_chk_act("reproduce") THEN
               CALL axmt175_reproduce()
               #add-point:ON ACTION reproduce
               {<point name="menu.reproduce" />}
               #END add-point
               EXIT DIALOG
            END IF
 
 
         #+ 此段落由子樣板a43產生
         ON ACTION query
            LET g_action_choice="query"
            IF cl_auth_chk_act("query") THEN
               CALL axmt175_query()
               #add-point:ON ACTION query
               {<point name="menu.query" />}
               #END add-point
               
            END IF
 
 
         
         #+ 此段落由子樣板a46產生
         #新增相關文件
         ON ACTION related_document
            CALL axmt175_set_pk_array()
            IF cl_auth_chk_act("related_document") THEN
               #add-point:ON ACTION related_document
               {<point name="ui_dialog.dialog.related_document"/>}
               #END add-point
               CALL cl_doc()
            END IF
            
         ON ACTION agendum
            CALL axmt175_set_pk_array()
            #add-point:ON ACTION agendum
            {<point name="ui_dialog.dialog.agendum"/>}
            #END add-point
            CALL cl_user_overview()
            CALL cl_user_overview_set_follow_pic()
         
         ON ACTION followup
            CALL axmt175_set_pk_array()
            #add-point:ON ACTION followup
            {<point name="ui_dialog.dialog.followup"/>}
            #END add-point
            CALL cl_user_overview_follow('')
 
 
         
         #主選單用ACTION
         &include "main_menu.4gl"
         &include "relating_action.4gl"
         #交談指令共用ACTION
         &include "common_action.4gl" 
            CONTINUE DIALOG
            
      END DIALOG
    
      IF g_action_choice = "exit" AND NOT cl_null(g_action_choice) THEN
         EXIT WHILE
      END IF
    
   END WHILE    
      
   CALL cl_set_act_visible("accept,cancel", TRUE)
    
END FUNCTION
]]>
  </section>
  <section id="axmt175.ui_headershow" ver="5" status="" src="s">
    <![CDATA[#+ 單頭資料重新顯示
PRIVATE FUNCTION axmt175_ui_headershow()
   #add-point:ui_headershow段define
   {<point name="ui_headershow.define"/>}
   #end add-point    
   
   LET g_xmih_m.xmih001 = g_browser[g_current_idx].b_xmih001   
   LET g_xmih_m.xmih002 = g_browser[g_current_idx].b_xmih002   
   LET g_xmih_m.xmih003 = g_browser[g_current_idx].b_xmih003   
   LET g_xmih_m.xmih004 = g_browser[g_current_idx].b_xmih004   
 
   EXECUTE axmt175_master_referesh USING g_xmih_m.xmih001,g_xmih_m.xmih002,g_xmih_m.xmih003,g_xmih_m.xmih004 INTO g_xmih_m.xmih001, 
       g_xmih_m.xmih004,g_xmih_m.xmih002,g_xmih_m.xmih005,g_xmih_m.xmih003,g_xmih_m.xmihstus,g_xmih_m.xmihownid, 
       g_xmih_m.xmihcrtdp,g_xmih_m.xmihowndp,g_xmih_m.xmihcrtdt,g_xmih_m.xmihcrtid,g_xmih_m.xmihmodid, 
       g_xmih_m.xmihcnfid,g_xmih_m.xmihmoddt,g_xmih_m.xmihcnfdt,g_xmih_m.xmih001_desc,g_xmih_m.xmih004_desc, 
       g_xmih_m.xmih005_desc,g_xmih_m.xmihownid_desc,g_xmih_m.xmihcrtdp_desc,g_xmih_m.xmihowndp_desc, 
       g_xmih_m.xmihcrtid_desc,g_xmih_m.xmihmodid_desc,g_xmih_m.xmihcnfid_desc
   CALL axmt175_show()
   
END FUNCTION
]]>
  </section>
  <section id="axmt175.unlock_b" ver="1" status="" src="s">
    <![CDATA[#+ 連動unlock其他單身table資料
PRIVATE FUNCTION axmt175_unlock_b(ps_table,ps_page)
   DEFINE ps_page     STRING
   DEFINE ps_table    STRING
   DEFINE ls_group    STRING
   #add-point:unlock_b段define
   {<point name="unlock_b.define"/>}
   #end add-point  
   
   LET ls_group = "'1','2','3',"
   
   IF ls_group.getIndexOf(ps_page,1) THEN
      CLOSE axmt175_bcl
   END IF
   
 
   
 
 
   #add-point:unlock_b段other
   {<point name="unlock_b.other"/>}
   #end add-point  
 
END FUNCTION
]]>
  </section>
  <section id="axmt175.update_b" ver="7" status="" src="s">
    <![CDATA[#+ 修改單身後其他table連動
PRIVATE FUNCTION axmt175_update_b(ps_table,ps_keys,ps_keys_bak,ps_page)
   DEFINE ps_table         STRING
   DEFINE ps_page          STRING
   DEFINE ps_keys          DYNAMIC ARRAY OF VARCHAR(500)
   DEFINE ps_keys_bak      DYNAMIC ARRAY OF VARCHAR(500)
   DEFINE ls_group         STRING
   DEFINE li_idx           LIKE type_t.num5 
   DEFINE lb_chk           BOOLEAN
   DEFINE l_new_key        DYNAMIC ARRAY OF STRING
   DEFINE l_old_key        DYNAMIC ARRAY OF STRING
   DEFINE l_field_key      DYNAMIC ARRAY OF STRING
   #add-point:update_b段define
   {<point name="update_b.define"/>}
   #end add-point     
   
   #判斷key是否有改變
   LET lb_chk = TRUE
   FOR li_idx = 1 TO ps_keys.getLength()
      IF ps_keys[li_idx] <> ps_keys_bak[li_idx] THEN
         LET lb_chk = FALSE
         EXIT FOR
      END IF
   END FOR
   
   #不需要做處理
   IF lb_chk THEN
      RETURN
   END IF
   
   #判斷是否是同一群組的table
   LET ls_group = "'1','2','3',"
   IF ls_group.getIndexOf(ps_page,1) > 0 AND ps_table <> "xmii_t" THEN
      #add-point:update_b段修改前
      {<point name="update_b.before_update" mark="Y"/>}
      #end add-point     
      UPDATE xmii_t 
         SET (xmii001,xmii002,xmii003,xmii004,
              xmii006,xmii007,xmii008,xmii009,xmii010,xmii011,xmii012,xmii013,xmii014,xmii017
              ,xmii005,xmii005,xmii005) 
              = 
             (ps_keys[1],ps_keys[2],ps_keys[3],ps_keys[4],ps_keys[5],ps_keys[6],ps_keys[7],ps_keys[8],ps_keys[9],ps_keys[10],ps_keys[11],ps_keys[12],ps_keys[13],ps_keys[14]
              ,g_xmii_d[g_detail_idx].xmii005,g_xmii_d[g_detail_idx].xmii005,g_xmii_d[g_detail_idx].xmii005)  

         WHERE xmiient = g_enterprise AND xmii001 = ps_keys_bak[1] AND xmii002 = ps_keys_bak[2] AND xmii003 = ps_keys_bak[3] AND xmii004 = ps_keys_bak[4] AND xmii006 = ps_keys_bak[5] AND xmii007 = ps_keys_bak[6] AND xmii008 = ps_keys_bak[7] AND xmii009 = ps_keys_bak[8] AND xmii010 = ps_keys_bak[9] AND xmii011 = ps_keys_bak[10] AND xmii012 = ps_keys_bak[11] AND xmii013 = ps_keys_bak[12] AND xmii014 = ps_keys_bak[13] AND xmii017 = ps_keys_bak[14]
      #add-point:update_b段修改中
      {<point name="update_b.m_update"/>}
      #end add-point   
      CASE
         WHEN SQLCA.sqlerrd[3] = 0  #更新不到的處理
            CALL cl_err("xmii_t","std-00009",1)
            CALL s_transaction_end('N','0')
         WHEN SQLCA.sqlcode #其他錯誤
            CALL cl_err("xmii_t",SQLCA.sqlcode,1)  
            CALL s_transaction_end('N','0')
         OTHERWISE
            
      END CASE
      #add-point:update_b段修改後
      {<point name="update_b.after_update"/>}
      #end add-point  
   END IF
   
 
   
 
   
 
   
   #add-point:update_b段other
   {<point name="update_b.other"/>}
   #end add-point  
   
END FUNCTION
]]>
  </section>
</add_points>
