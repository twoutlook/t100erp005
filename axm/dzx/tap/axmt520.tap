<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<add_points prog="axmt520" std_prog="axmt520" erpver="1.0" module="AXM" ver="20" env="s" zone="t10prd" booking="Y" type="M" identity="s" section_flag="N" designer_ver="1.0">
  <other>
    <code_template value="F" status="u"/>
    <free_style value="N" status="u"/>
    <start_arg value="1" status="u"/>
  </other>
  <point name="function.axmt520_gen_xmdh" order="1" ver="18" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 由訂單單號帶出單身明細
# Memo...........:
# Usage..........: CALL axmt520_gen_xmdh()
#                : RETURNING r_success
# Input parameter: no
# Return code....: r_success
# Date & Author..: 140326 By whitney
# Modify.........:
################################################################################
PRIVATE FUNCTION axmt520_gen_xmdh()
DEFINE r_success    LIKE type_t.num5
DEFINE l_xmdh  RECORD
    xmdhunit   LIKE xmdh_t.xmdhunit,
    xmdh002    LIKE xmdh_t.xmdh002,
    xmdh003    LIKE xmdh_t.xmdh003,
    xmdh004    LIKE xmdh_t.xmdh004,
    xmdh005    LIKE xmdh_t.xmdh005,
    xmdh006    LIKE xmdh_t.xmdh006,
    xmdh007    LIKE xmdh_t.xmdh007,
    xmdh008    LIKE xmdh_t.xmdh008,
    xmdh009    LIKE xmdh_t.xmdh009,
    xmdh010    LIKE xmdh_t.xmdh010,
    xmdh011    LIKE xmdh_t.xmdh011,
    xmdh012    LIKE xmdh_t.xmdh012,
    xmdh013    LIKE xmdh_t.xmdh013,
    xmdh014    LIKE xmdh_t.xmdh014,
    xmdh015    LIKE xmdh_t.xmdh015,
    xmdh016    LIKE xmdh_t.xmdh016,
    xmdh017    LIKE xmdh_t.xmdh017,
    xmdh018    LIKE xmdh_t.xmdh018,
    xmdh019    LIKE xmdh_t.xmdh019,
    xmdh020    LIKE xmdh_t.xmdh020,
    xmdh021    LIKE xmdh_t.xmdh021,
    xmdh022    LIKE xmdh_t.xmdh022,
    xmdh023    LIKE xmdh_t.xmdh023,
    xmdh024    LIKE xmdh_t.xmdh024,
    xmdh025    LIKE xmdh_t.xmdh025,
    xmdh026    LIKE xmdh_t.xmdh026,
    xmdh027    LIKE xmdh_t.xmdh027,
    xmdh028    LIKE xmdh_t.xmdh028,
    xmdh029    LIKE xmdh_t.xmdh029,
    xmdh030    LIKE xmdh_t.xmdh030,
    xmdh031    LIKE xmdh_t.xmdh031,
    xmdh032    LIKE xmdh_t.xmdh032,
    xmdh033    LIKE xmdh_t.xmdh033,
    xmdh034    LIKE xmdh_t.xmdh034,
    xmdh035    LIKE xmdh_t.xmdh035,
    xmdh036    LIKE xmdh_t.xmdh036,
    xmdh050    LIKE xmdh_t.xmdh050,
    xmdh051    LIKE xmdh_t.xmdh051,
    xmdh056    LIKE xmdh_t.xmdh056
           END RECORD
DEFINE l_seq        LIKE type_t.num5
DEFINE l_success    LIKE type_t.num5
DEFINE l_date       LIKE type_t.dat
DEFINE l_ask  RECORD
    all       LIKE type_t.chr1,
    assign    LIKE type_t.chr1,
    day       LIKE type_t.num5
          END RECORD


   OPEN WINDOW w_axmt540_s02 WITH FORM cl_ap_formpath("axm",'axmt540_s02')
   
   INITIALIZE l_ask.* TO NULL
   LET l_ask.all = 'Y'
   LET l_ask.assign = 'N'
   LET l_ask.day = 0
   CALL cl_set_comp_entry("day",FALSE)

   INPUT BY NAME l_ask.all,l_ask.assign,l_ask.day WITHOUT DEFAULTS
      BEFORE INPUT
      
      ON CHANGE all
         IF l_ask.all = 'Y' THEN
            LET l_ask.assign = 'N'
            LET l_ask.day = 0
            CALL cl_set_comp_entry("day",FALSE)
         ELSE 
            LET l_ask.assign = 'Y'
            CALL cl_set_comp_entry("day",TRUE)
         END IF
         DISPLAY BY NAME l_ask.all,l_ask.assign,l_ask.day

      ON CHANGE assign
         IF l_ask.assign = 'Y' THEN
            LET l_ask.all = 'N'
            CALL cl_set_comp_entry("day",TRUE)
         ELSE
            LET l_ask.all = 'Y'
            LET l_ask.day = 0
            CALL cl_set_comp_entry("day",FALSE)
         END IF
         DISPLAY BY NAME l_ask.all,l_ask.assign,l_ask.day
                               
      ON ACTION accept
         ACCEPT INPUT
         
      ON ACTION cancel
         LET INT_FLAG = TRUE
         EXIT INPUT

      ON ACTION exit
         LET INT_FLAG = TRUE
         EXIT INPUT
      
      AFTER INPUT
   END INPUT
   
   CLOSE WINDOW w_axmt540_s02
   
   IF INT_FLAG THEN
      LET INT_FLAG = FALSE
      LET r_success = FALSE
      RETURN r_success
   END IF   

   LET g_sql = " SELECT xmddunit,xmddseq,xmddseq1,xmddseq2,xmdd003,xmdd001,xmdd002,xmdc003,xmdc004,xmdc005, ",
               "        xmdc028,xmdc029,xmdc030,xmdd004,(xmdd006-xmdd031+xmdd016),xmdd024,xmdd026,xmdc052, ",
               "        xmdd018,xmdd019,xmdd020,xmdc057,xmdc036,xmdc037,xmdc038,xmdc027,xmdd008,xmdc021, ",
               "        xmdc050,xmda050 ",
               "   FROM xmdd_t,xmdc_t,xmda_t ",
               "  WHERE xmddent = '",g_enterprise,"' AND xmddsite = '",g_site,"' AND xmdddocno = '",g_xmdg_m.xmdg004,"'",
               "    AND xmdcent = xmddent AND xmdcsite = xmddsite AND xmdcdocno = xmdddocno AND xmdcseq = xmddseq AND xmdc045 = '1' ",
               "    AND xmdaent = xmddent AND xmdasite = xmddsite AND xmdadocno = xmdddocno "

   IF l_ask.all = 'N' THEN
      CALL s_date_get_date(g_xmdg_m.xmdgdocdt,0,l_ask.day) RETURNING l_date
      LET g_sql = g_sql CLIPPED," AND xmdd011 <= '",l_date,"' "
   END IF
      
   LET g_sql = g_sql, " ORDER BY xmddseq,xmddseq1,xmddseq2"
      
   PREPARE axmt520_gen_xmdh_pb FROM g_sql
   DECLARE axmt520_gen_xmdh_cs CURSOR FOR axmt520_gen_xmdh_pb
       
   INITIALIZE l_xmdh.* TO NULL
   LET r_success = TRUE
   LET l_seq = 1
   
   FOREACH axmt520_gen_xmdh_cs INTO
      l_xmdh.xmdhunit,l_xmdh.xmdh002,l_xmdh.xmdh003,l_xmdh.xmdh004,l_xmdh.xmdh005,
      l_xmdh.xmdh006,l_xmdh.xmdh007,l_xmdh.xmdh008,l_xmdh.xmdh009,l_xmdh.xmdh010,
      l_xmdh.xmdh012,l_xmdh.xmdh013,l_xmdh.xmdh014,l_xmdh.xmdh015,l_xmdh.xmdh016,
      l_xmdh.xmdh018,l_xmdh.xmdh020,l_xmdh.xmdh022,l_xmdh.xmdh023,l_xmdh.xmdh024,
      l_xmdh.xmdh025,l_xmdh.xmdh029,l_xmdh.xmdh031,l_xmdh.xmdh032,l_xmdh.xmdh033,
      l_xmdh.xmdh034,l_xmdh.xmdh035,l_xmdh.xmdh036,l_xmdh.xmdh050,l_xmdh.xmdh051
      IF SQLCA.SQLCODE THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = "FOREACH:" 
         LET g_errparam.code   = SQLCA.sqlcode 
         LET g_errparam.popup  = TRUE 
         CALL cl_err()
         EXIT FOREACH
      END IF
      #多庫儲批
      LET l_xmdh.xmdh011 = 'N'
      #已轉出貨數量
      LET l_xmdh.xmdh030 = 0
      #檢核不可大於(xmdd006-xmdd014-已登打出貨未確認的出貨量)
      CALL axmt520_xmdd006_chk(g_xmdg_m.xmdg004,l_xmdh.xmdh002,l_xmdh.xmdh003,l_xmdh.xmdh004,l_xmdh.xmdh006,l_xmdh.xmdh016,0)
      IF NOT cl_null(g_errno) THEN
         CONTINUE FOREACH
      END IF

      CALL axmt520_xmdh016_count(l_seq,l_xmdh.xmdh006,l_xmdh.xmdh015,
                                 l_xmdh.xmdh016,l_xmdh.xmdh018,l_xmdh.xmdh020,
                                 l_xmdh.xmdh022,l_xmdh.xmdh023,l_xmdh.xmdh024,
                                 g_xmdg_m.xmdg004)  #150522---earl---add
           RETURNING l_xmdh.xmdh017,l_xmdh.xmdh019,l_xmdh.xmdh021,
                     l_xmdh.xmdh026,l_xmdh.xmdh027,
                     l_xmdh.xmdh028,l_xmdh.xmdh056

      INSERT INTO xmdh_t (xmdhent,xmdhsite,xmdhunit,xmdhdocno,xmdhseq,xmdh001,xmdh002,xmdh003,xmdh004,xmdh005,
                          xmdh006,xmdh007,xmdh008,xmdh009,xmdh010,xmdh011,xmdh012,xmdh013,xmdh014,xmdh015,
                          xmdh016,xmdh017,xmdh018,xmdh019,xmdh020,xmdh021,xmdh022,xmdh023,xmdh024,xmdh025,
                          xmdh026,xmdh027,xmdh028,xmdh029,xmdh030,xmdh031,xmdh032,xmdh033,xmdh034,xmdh035,
                          xmdh036,xmdh050,xmdh051,xmdh056)
           VALUES (g_enterprise,g_site,l_xmdh.xmdhunit,g_xmdg_m.xmdgdocno,l_seq,   
                   g_xmdg_m.xmdg004,l_xmdh.xmdh002,l_xmdh.xmdh003,l_xmdh.xmdh004,l_xmdh.xmdh005,
                   l_xmdh.xmdh006,l_xmdh.xmdh007,l_xmdh.xmdh008,l_xmdh.xmdh009,l_xmdh.xmdh010,
                   l_xmdh.xmdh011,l_xmdh.xmdh012,l_xmdh.xmdh013,l_xmdh.xmdh014,l_xmdh.xmdh015,
                   l_xmdh.xmdh016,l_xmdh.xmdh017,l_xmdh.xmdh018,l_xmdh.xmdh019,l_xmdh.xmdh020,
                   l_xmdh.xmdh021,l_xmdh.xmdh022,l_xmdh.xmdh023,l_xmdh.xmdh024,l_xmdh.xmdh025,
                   l_xmdh.xmdh026,l_xmdh.xmdh027,l_xmdh.xmdh028,l_xmdh.xmdh029,l_xmdh.xmdh030,
                   l_xmdh.xmdh031,l_xmdh.xmdh032,l_xmdh.xmdh033,l_xmdh.xmdh034,l_xmdh.xmdh035,
                   l_xmdh.xmdh036,l_xmdh.xmdh050,l_xmdh.xmdh051,l_xmdh.xmdh056)
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = "ins xmdh" 
         LET g_errparam.code   = SQLCA.sqlcode 
         LET g_errparam.popup  = TRUE 
         CALL cl_err()
         LET r_success = FALSE
         EXIT FOREACH
      END IF

      IF NOT axmt540_01_xmdm_modify('2',l_seq,g_site,g_xmdg_m.xmdgdocno,l_seq,l_xmdh.xmdh006,
                                    l_xmdh.xmdh007,l_xmdh.xmdh009,l_xmdh.xmdh010,l_xmdh.xmdh012,
                                    l_xmdh.xmdh013,l_xmdh.xmdh014,l_xmdh.xmdh029,l_xmdh.xmdh015,
                                    l_xmdh.xmdh016,l_xmdh.xmdh018,l_xmdh.xmdh019,'','') THEN
         LET r_success = FALSE
         EXIT FOREACH
      END IF
      
      IF NOT axmt520_upd_xmdd031(g_xmdg_m.xmdg004,l_xmdh.xmdh002,l_xmdh.xmdh003,
                                 l_xmdh.xmdh004,l_xmdh.xmdh016,0) THEN
         LET r_success = FALSE
         EXIT FOREACH
      END IF
      
      INITIALIZE l_xmdh.* TO NULL
      LET l_seq = l_seq + 1
      
   END FOREACH
   
   IF r_success THEN
      CALL axmt520_total_count()  
   END IF
   
   RETURN r_success
  
END FUNCTION]]>
  </point>
  <point name="function.axmt520_xmdi_del" order="2" ver="13" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 刪除對應的多庫儲批資料
# Memo...........:
# Usage..........: CALL axmt520_xmdi_del()
# Input parameter: no
# Return code....: no
# Date & Author..: 140512 By whitney
# Modify.........:
################################################################################
PRIVATE FUNCTION axmt520_xmdi_del()
DEFINE l_n          LIKE type_t.num5

   LET l_n = 0
   SELECT COUNT(*) INTO l_n
     FROM xmdi_t
    WHERE xmdient = g_enterprise
      AND xmdidocno = g_xmdg_m.xmdgdocno
      AND xmdiseq = g_xmdh_d[l_ac].xmdhseq
   IF cl_null(l_n) THEN LET l_n = 0 END IF
   IF l_n <> 0 THEN
      #是否取消多庫儲批出貨，且刪除對應的出通單多庫儲批出貨明細檔？
      IF cl_ask_confirm('axm-00154') THEN
         DELETE FROM xmdi_t
          WHERE xmdient = g_enterprise
            AND xmdidocno = g_xmdg_m.xmdgdocno
            AND xmdiseq = g_xmdh_d[l_ac].xmdhseq
         LET g_xmdh_d[l_ac].xmdh011 = 'N'
      END IF
   END IF
   
END FUNCTION]]>
  </point>
  <point name="function.axmt520_xmdgdocno_chk" order="3" ver="13" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 單別檢核
# Memo...........:
# Usage..........: CALL axmt520_xmdgdocno_chk()
# Input parameter: no
# Return code....: TRUE OR FALSE
# Date & Author..: 140624 By whitney
# Modify.........:
################################################################################
PRIVATE FUNCTION axmt520_xmdgdocno_chk()
DEFINE l_success    LIKE type_t.num5
DEFINE l_flag       LIKE type_t.num5

   #key值
   IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xmdg_t WHERE "||"xmdgent = '" ||g_enterprise|| "' AND "||"xmdgdocno = '"||g_xmdg_m.xmdgdocno ||"'",'std-00004',0) THEN 
      RETURN FALSE
   END IF
   
   #檢查單別
   IF NOT s_aooi200_chk_slip(g_site,'',g_xmdg_m.xmdgdocno,g_prog) THEN
      RETURN FALSE
   END IF
            
   #檢核輸入的單據別是否可以被key人員對應的控制組使用,'2' 為銷售控制組類型
   CALL s_control_chk_doc('1',g_xmdg_m.xmdgdocno,'2',g_user,g_dept,'','')
        RETURNING l_success,l_flag
   IF l_success THEN
      IF NOT l_flag THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = 'axm-00015'
         LET g_errparam.extend = g_xmdg_m.xmdgdocno
         LET g_errparam.popup = TRUE
         CALL cl_err()
         RETURN FALSE
      END IF
   ELSE
      RETURN FALSE
   END IF

   RETURN TRUE
   
END FUNCTION]]>
  </point>
  <point name="function.axmt520_xmdadocno_chk" order="4" ver="13" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 單頭訂單檢核
# Memo...........:
# Usage..........: CALL axmt520_xmdadocno_chk(p_docno)
# Input parameter: p_docno   訂單單號
# Return code....: TRUE OR FALSE
# Date & Author..: 140307 By whitney
# Modify.........:
################################################################################
PRIVATE FUNCTION axmt520_xmdadocno_chk(p_docno)
DEFINE p_docno      LIKE xmda_t.xmdadocno
DEFINE l_cnt        LIKE type_t.num5
DEFINE l_success    LIKE type_t.num5
DEFINE l_slip       LIKE ooba_t.ooba002
DEFINE l_xmda  RECORD
    xmda005    LIKE xmda_t.xmda005,
    xmda006    LIKE xmda_t.xmda006,
    xmda050    LIKE xmda_t.xmda050
END RECORD

   INITIALIZE g_chkparam.* TO NULL
   LET g_chkparam.arg1 = p_docno
   IF NOT cl_chk_exist("v_xmdadocno_4") THEN
      RETURN FALSE
   END IF

   #單據別參數
   CALL s_aooi200_get_slip(p_docno) RETURNING l_success,l_slip
   IF cl_get_doc_para(g_enterprise,g_site,l_slip,'D-BAS-0077') = 'N' THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = 'axm-00349'
      LET g_errparam.extend = p_docno
      LET g_errparam.popup = TRUE
      CALL cl_err()
      RETURN FALSE
   END IF

   INITIALIZE l_xmda.* TO NULL
   SELECT xmda005,xmda006,xmda050
     INTO l_xmda.xmda005,l_xmda.xmda006,l_xmda.xmda050
     FROM xmda_t
    WHERE xmdaent = g_enterprise
      AND xmdadocno = p_docno
   #借出訂單
   IF g_argv[01] = '8' AND l_xmda.xmda005 <> '8' THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = 'axm-00541'
      LET g_errparam.extend = p_docno
      LET g_errparam.popup = TRUE
      CALL cl_err()
      RETURN FALSE
   END IF
   #多角貿易營運據點檢核
   CALL axmt520_polygon_chk(p_docno,l_xmda.xmda006,l_xmda.xmda050)
   IF NOT cl_null(g_errno) THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = g_errno
      LET g_errparam.extend = p_docno
      LET g_errparam.popup = TRUE
      CALL cl_err()
      RETURN FALSE
   END IF 
   
   RETURN TRUE
   
END FUNCTION]]>
  </point>
  <point name="function.axmt520_xmdg004_default" order="5" ver="20" cite_std="N" new="Y" status="u" src="s" readonly="" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 單頭從訂單單號帶出預設值
# Memo...........:
# Usage..........: CALL axmt520_xmdg004_default()
# Input parameter: no
# Return code....: no
# Date & Author..: 140624 By whitney
# Modify.........:
################################################################################
PRIVATE FUNCTION axmt520_xmdg004_default()
   DEFINE l_xmda031     LIKE xmda_t.xmda031   #150703 earl add
   DEFINE l_xmdg034     LIKE xmdg_t.xmdg034   #150703 earl add
   
   LET l_xmda031 = '' #150703 earl add
   SELECT xmda031,    #150703 earl add
          xmda005,xmda002,xmda003,xmda004,xmda021,xmda022,xmda009,xmda010,xmda011,xmda012,
          xmda013,xmda035,xmda015,xmda016,xmda036,xmda025,xmda020,xmda037,xmda038,xmda044,
          xmda023,xmda024,xmda032,xmda048,xmda049,xmda006,xmda050,xmda203
     INTO l_xmda031,  #150703 earl add
          g_xmdg_m.xmdg001,g_xmdg_m.xmdg002,g_xmdg_m.xmdg003,g_xmdg_m.xmdg005,g_xmdg_m.xmdg006,
          g_xmdg_m.xmdg007,g_xmdg_m.xmdg008,g_xmdg_m.xmdg009,g_xmdg_m.xmdg010,g_xmdg_m.xmdg011,
          g_xmdg_m.xmdg012,g_xmdg_m.xmdg013,g_xmdg_m.xmdg014,g_xmdg_m.xmdg015,g_xmdg_m.xmdg016,
          g_xmdg_m.xmdg017,g_xmdg_m.xmdg018,g_xmdg_m.xmdg019,g_xmdg_m.xmdg020,g_xmdg_m.xmdg023,
          g_xmdg_m.xmdg026,g_xmdg_m.xmdg027,g_xmdg_m.xmdg031,g_xmdg_m.xmdg032,g_xmdg_m.xmdg033,
          g_xmdg_m.xmdg034,g_xmdg_m.xmdg056,g_xmdg_m.xmdg202
     FROM xmda_t
    WHERE xmdaent = g_enterprise
      AND xmdadocno = g_xmdg_m.xmdg004

   #150703 earl mod s
   #多角處理
   IF NOT cl_null(g_xmdg_m.xmdg056) THEN
      #改抓發起站之多角性質
      LET l_xmdg034 = ''
      SELECT xmda006 INTO l_xmdg034
        FROM xmda_t
       WHERE xmdaent = g_enterprise
         AND xmda031 = l_xmda031
         AND xmdasite = (SELECT icab003
                           FROM icab_t
                          WHERE icabent = g_enterprise
                            AND icab001 = g_xmdg_m.xmdg056
                            AND icab002 = 0)
                            
      IF cl_null(l_xmdg034) THEN
         LET l_xmdg034 = '7'   #7:代採購出貨
      END IF
      
      LET g_xmdg_m.xmdg034 = l_xmdg034
   END IF
   #150703 earl mod e
   
   IF NOT cl_null(g_xmdg_m.xmdg002) THEN
      CALL s_desc_get_person_desc(g_xmdg_m.xmdg002)
           RETURNING g_xmdg_m.xmdg002_desc
      DISPLAY BY NAME g_xmdg_m.xmdg002_desc
   END IF

   IF NOT cl_null(g_xmdg_m.xmdg002) AND cl_null(g_xmdg_m.xmdg003) THEN
      SELECT ooag003 INTO g_xmdg_m.xmdg003
        FROM ooag_t
       WHERE ooagent = g_enterprise
         AND ooag001 = g_xmdg_m.xmdg002
   END IF
   IF NOT cl_null(g_xmdg_m.xmdg003) THEN
      CALL s_desc_get_department_desc(g_xmdg_m.xmdg003)
           RETURNING g_xmdg_m.xmdg003_desc
      DISPLAY BY NAME g_xmdg_m.xmdg003_desc
   END IF
   
   IF NOT cl_null(g_xmdg_m.xmdg005) THEN
      IF cl_null(g_xmdg_m.xmdg006) THEN
         CALL s_axmt540_client_partner(g_xmdg_m.xmdgdocno,g_xmdg_m.xmdg005,'1')
              RETURNING g_xmdg_m.xmdg006
      END IF
      IF cl_null(g_xmdg_m.xmdg007) THEN
         CALL s_axmt540_client_partner(g_xmdg_m.xmdgdocno,g_xmdg_m.xmdg005,'2')
              RETURNING g_xmdg_m.xmdg007
      END IF
   END IF

   IF NOT cl_null(g_xmdg_m.xmdg032) AND NOT cl_null(g_xmdg_m.xmdg014) AND g_xmdg_m.xmdg033 <> '1' THEN
      CALL s_axmt540_get_exchange(g_xmdg_m.xmdg032,g_xmdg_m.xmdg014)
           RETURNING g_xmdg_m.xmdg015
   END IF
   
   DISPLAY BY NAME g_xmdg_m.xmdg001,g_xmdg_m.xmdg002,g_xmdg_m.xmdg003,g_xmdg_m.xmdg005,g_xmdg_m.xmdg006,
                   g_xmdg_m.xmdg007,g_xmdg_m.xmdg008,g_xmdg_m.xmdg009,g_xmdg_m.xmdg010,g_xmdg_m.xmdg011,
                   g_xmdg_m.xmdg012,g_xmdg_m.xmdg013,g_xmdg_m.xmdg014,g_xmdg_m.xmdg015,g_xmdg_m.xmdg016,
                   g_xmdg_m.xmdg017,g_xmdg_m.xmdg018,g_xmdg_m.xmdg019,g_xmdg_m.xmdg020,g_xmdg_m.xmdg023,
                   g_xmdg_m.xmdg026,g_xmdg_m.xmdg027,g_xmdg_m.xmdg031,g_xmdg_m.xmdg032,g_xmdg_m.xmdg033,
                   g_xmdg_m.xmdg034,g_xmdg_m.xmdg056,g_xmdg_m.xmdg202
   
   CALL s_desc_get_trading_partner_abbr_desc(g_xmdg_m.xmdg005)
        RETURNING g_xmdg_m.xmdg005_desc
   DISPLAY BY NAME g_xmdg_m.xmdg005_desc

   CALL s_desc_get_trading_partner_abbr_desc(g_xmdg_m.xmdg006)
        RETURNING g_xmdg_m.xmdg006_desc
   DISPLAY BY NAME g_xmdg_m.xmdg006_desc

   CALL s_desc_get_trading_partner_abbr_desc(g_xmdg_m.xmdg007)
        RETURNING g_xmdg_m.xmdg007_desc
   DISPLAY BY NAME g_xmdg_m.xmdg007_desc

   CALL s_desc_get_trading_partner_abbr_desc(g_xmdg_m.xmdg202)
        RETURNING g_xmdg_m.xmdg202_desc
   DISPLAY BY NAME g_xmdg_m.xmdg202_desc

   CALL s_desc_get_acc_desc('275',g_xmdg_m.xmdg026)
        RETURNING g_xmdg_m.xmdg026_desc
   DISPLAY BY NAME g_xmdg_m.xmdg026_desc

   CALL s_desc_get_acc_desc('295',g_xmdg_m.xmdg027)
        RETURNING g_xmdg_m.xmdg027_desc
   DISPLAY BY NAME g_xmdg_m.xmdg027_desc

   CALL s_desc_get_acc_desc('297',g_xmdg_m.xmdg031)
        RETURNING g_xmdg_m.xmdg031_desc
   DISPLAY BY NAME g_xmdg_m.xmdg031_desc

   CALL axmt520_xmdg017_ref()
   CALL axmt520_xmdg023_ref()

   IF NOT cl_null(g_xmdg_m.xmdg018) THEN
      CALL s_desc_get_acc_desc('263',g_xmdg_m.xmdg018)
           RETURNING g_xmdg_m.xmdg018_desc
      DISPLAY BY NAME g_xmdg_m.xmdg018_desc
      CALL s_apmi011_location_ref(g_xmdg_m.xmdg018,g_xmdg_m.xmdg019)
           RETURNING g_xmdg_m.xmdg019_desc
      DISPLAY BY NAME g_xmdg_m.xmdg019_desc
      CALL s_apmi011_location_ref(g_xmdg_m.xmdg018,g_xmdg_m.xmdg020)
           RETURNING g_xmdg_m.xmdg020_desc
      DISPLAY BY NAME g_xmdg_m.xmdg020_desc
   END IF

   CALL s_desc_get_trading_partner_abbr_desc(g_xmdg_m.xmdg016)
        RETURNING g_xmdg_m.xmdg016_desc
   DISPLAY BY NAME g_xmdg_m.xmdg016_desc

   CALL s_desc_get_ooib002_desc(g_xmdg_m.xmdg008)
        RETURNING g_xmdg_m.xmdg008_desc
   DISPLAY BY NAME g_xmdg_m.xmdg008_desc

   CALL s_desc_get_acc_desc('238',g_xmdg_m.xmdg009)
        RETURNING g_xmdg_m.xmdg009_desc
   DISPLAY BY NAME g_xmdg_m.xmdg009_desc

   CALL s_desc_get_tax_desc1(g_site,g_xmdg_m.xmdg010)
        RETURNING g_xmdg_m.xmdg010_desc
   DISPLAY BY NAME g_xmdg_m.xmdg010_desc

   CALL s_desc_get_invoice_type_desc1(g_site,g_xmdg_m.xmdg013)
        RETURNING g_xmdg_m.xmdg013_desc
   DISPLAY BY NAME g_xmdg_m.xmdg013_desc

   CALL s_desc_get_currency_desc(g_xmdg_m.xmdg014)
        RETURNING g_xmdg_m.xmdg014_desc
   DISPLAY BY NAME g_xmdg_m.xmdg014_desc

   CALL s_desc_get_icaa001_desc(g_xmdg_m.xmdg056)
        RETURNING g_xmdg_m.xmdg056_desc
   DISPLAY BY NAME g_xmdg_m.xmdg056_desc

   LET g_xmdg_m_o.* = g_xmdg_m.*
   
END FUNCTION]]>
  </point>
  <point name="function.axmt520_xmdg005_default" order="6" ver="18" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 依客戶編號預設交易條件
# Memo...........:
# Usage..........: CALL axmt520_xmdg005_default()
# Input parameter: no
# Return code....: no
# Date & Author..: 140311 By whitney
# Modify.........:
################################################################################
PRIVATE FUNCTION axmt520_xmdg005_default()
DEFINE l_success    LIKE type_t.num5
DEFINE l_oodb011    LIKE oodb_t.oodb011
DEFINE l_xmdk  RECORD
    xmdk003    LIKE xmdk_t.xmdk003,
    xmdk004    LIKE xmdk_t.xmdk004,
    xmdk010    LIKE xmdk_t.xmdk010,
    xmdk011    LIKE xmdk_t.xmdk011,
    xmdk012    LIKE xmdk_t.xmdk012,
    xmdk015    LIKE xmdk_t.xmdk015,
    xmdk016    LIKE xmdk_t.xmdk016,
    xmdk018    LIKE xmdk_t.xmdk018,
    xmdk022    LIKE xmdk_t.xmdk022,
    xmdk023    LIKE xmdk_t.xmdk023,
    xmdk024    LIKE xmdk_t.xmdk024,
    xmdk030    LIKE xmdk_t.xmdk030,
    xmdk031    LIKE xmdk_t.xmdk031,
    xmdk042    LIKE xmdk_t.xmdk042,
    xmdk043    LIKE xmdk_t.xmdk043
           END RECORD

   CALL s_axmt540_client_default(g_xmdg_m.xmdg005,g_user,g_dept)
        RETURNING l_xmdk.xmdk003,l_xmdk.xmdk004,
                  l_xmdk.xmdk010,l_xmdk.xmdk011,l_xmdk.xmdk012,l_xmdk.xmdk015,l_xmdk.xmdk016,
                  l_xmdk.xmdk018,l_xmdk.xmdk022,l_xmdk.xmdk023,l_xmdk.xmdk024,l_xmdk.xmdk030,
                  l_xmdk.xmdk031,l_xmdk.xmdk042,l_xmdk.xmdk043

   IF NOT s_aooi200_chk_doc_fields(g_site,'1',g_xmdg_m.xmdgdocno,'xmdg002') THEN
      LET g_xmdg_m.xmdg002 = l_xmdk.xmdk003
      CALL s_desc_get_person_desc(g_xmdg_m.xmdg002)
           RETURNING g_xmdg_m.xmdg002_desc
   END IF

   IF NOT s_aooi200_chk_doc_fields(g_site,'1',g_xmdg_m.xmdgdocno,'xmdg003') THEN
      LET g_xmdg_m.xmdg003 = l_xmdk.xmdk004
      IF NOT cl_null(g_xmdg_m.xmdg002) AND cl_null(g_xmdg_m.xmdg003) THEN
         SELECT ooag003 INTO g_xmdg_m.xmdg003
           FROM ooag_t
          WHERE ooagent = g_enterprise
            AND ooag001 = g_xmdg_m.xmdg002
      END IF
      CALL s_desc_get_department_desc(g_xmdg_m.xmdg003)
           RETURNING g_xmdg_m.xmdg003_desc
   END IF

   IF NOT s_aooi200_chk_doc_fields(g_site,'1',g_xmdg_m.xmdgdocno,'xmdg008') THEN
      LET g_xmdg_m.xmdg008 = l_xmdk.xmdk010
      CALL s_desc_get_ooib002_desc(g_xmdg_m.xmdg008)
           RETURNING g_xmdg_m.xmdg008_desc
   END IF

   IF NOT s_aooi200_chk_doc_fields(g_site,'1',g_xmdg_m.xmdgdocno,'xmdg009') THEN
      LET g_xmdg_m.xmdg009 = l_xmdk.xmdk011
      CALL s_desc_get_acc_desc('238',g_xmdg_m.xmdg009)
           RETURNING g_xmdg_m.xmdg009_desc
   END IF

   IF NOT s_aooi200_chk_doc_fields(g_site,'1',g_xmdg_m.xmdgdocno,'xmdg010') THEN
      LET g_xmdg_m.xmdg010 = l_xmdk.xmdk012
      IF NOT cl_null(g_xmdg_m.xmdg010) THEN
         CALL s_tax_chk(g_site,g_xmdg_m.xmdg010)
              RETURNING l_success,g_xmdg_m.xmdg010_desc,g_xmdg_m.xmdg012,g_xmdg_m.xmdg011,l_oodb011
         IF NOT l_success THEN
            LET g_xmdg_m.xmdg010 = g_xmdg_m_o.xmdg010
            LET g_xmdg_m.xmdg011 = g_xmdg_m_o.xmdg011
            LET g_xmdg_m.xmdg012 = g_xmdg_m_o.xmdg012
         END IF
      END IF
      CALL s_desc_get_tax_desc1(g_site,g_xmdg_m.xmdg010)
           RETURNING g_xmdg_m.xmdg010_desc
   END IF

   IF NOT s_aooi200_chk_doc_fields(g_site,'1',g_xmdg_m.xmdgdocno,'xmdg013') THEN
      LET g_xmdg_m.xmdg013 = l_xmdk.xmdk015
      CALL s_desc_get_invoice_type_desc1(g_site,g_xmdg_m.xmdg013)
           RETURNING g_xmdg_m.xmdg013_desc
   END IF

   IF NOT s_aooi200_chk_doc_fields(g_site,'1',g_xmdg_m.xmdgdocno,'xmdg014') THEN
      LET g_xmdg_m.xmdg014 = l_xmdk.xmdk016
      CALL s_desc_get_currency_desc(g_xmdg_m.xmdg014)
           RETURNING g_xmdg_m.xmdg014_desc
   END IF

   IF NOT s_aooi200_chk_doc_fields(g_site,'1',g_xmdg_m.xmdgdocno,'xmdg018') THEN
      LET g_xmdg_m.xmdg018 = l_xmdk.xmdk022
      CALL s_desc_get_acc_desc('263',g_xmdg_m.xmdg018)
           RETURNING g_xmdg_m.xmdg018_desc
   END IF
   IF NOT cl_null(g_xmdg_m.xmdg018) THEN
      IF NOT s_aooi200_chk_doc_fields(g_site,'1',g_xmdg_m.xmdgdocno,'xmdg019') THEN
         LET g_xmdg_m.xmdg019 = l_xmdk.xmdk023
         CALL s_apmi011_location_ref(g_xmdg_m.xmdg018,g_xmdg_m.xmdg019)
              RETURNING g_xmdg_m.xmdg019_desc
      END IF
      IF NOT s_aooi200_chk_doc_fields(g_site,'1',g_xmdg_m.xmdgdocno,'xmdg020') THEN
         LET g_xmdg_m.xmdg020 = l_xmdk.xmdk024
         CALL s_apmi011_location_ref(g_xmdg_m.xmdg018,g_xmdg_m.xmdg020)
              RETURNING g_xmdg_m.xmdg020_desc
      END IF
   END IF

   IF NOT s_aooi200_chk_doc_fields(g_site,'1',g_xmdg_m.xmdgdocno,'xmdg026') THEN
      LET g_xmdg_m.xmdg026 = l_xmdk.xmdk030
      CALL s_desc_get_acc_desc('275',g_xmdg_m.xmdg026)
           RETURNING g_xmdg_m.xmdg026_desc
   END IF

   IF NOT s_aooi200_chk_doc_fields(g_site,'1',g_xmdg_m.xmdgdocno,'xmdg027') THEN
      LET g_xmdg_m.xmdg027 = l_xmdk.xmdk031
      CALL s_desc_get_acc_desc('295',g_xmdg_m.xmdg027)
           RETURNING g_xmdg_m.xmdg027_desc
   END IF

   IF NOT s_aooi200_chk_doc_fields(g_site,'1',g_xmdg_m.xmdgdocno,'xmdg032') THEN
      LET g_xmdg_m.xmdg032 = l_xmdk.xmdk042
   END IF

   IF NOT s_aooi200_chk_doc_fields(g_site,'1',g_xmdg_m.xmdgdocno,'xmdg033') THEN
      LET g_xmdg_m.xmdg033 = l_xmdk.xmdk043
   END IF
   
   IF NOT cl_null(g_xmdg_m.xmdg032) AND NOT cl_null(g_xmdg_m.xmdg014) THEN
      CALL s_axmt540_get_exchange(g_xmdg_m.xmdg032,g_xmdg_m.xmdg014)
           RETURNING g_xmdg_m.xmdg015
   END IF
                   
   #收款客戶
   CALL s_axmt540_client_partner(g_xmdg_m.xmdgdocno,g_xmdg_m.xmdg005,'1')
        RETURNING g_xmdg_m.xmdg006
   CALL s_desc_get_trading_partner_abbr_desc(g_xmdg_m.xmdg006)
        RETURNING g_xmdg_m.xmdg006_desc

   #收貨客戶
   CALL s_axmt540_client_partner(g_xmdg_m.xmdgdocno,g_xmdg_m.xmdg005,'2')
        RETURNING g_xmdg_m.xmdg007
   CALL s_desc_get_trading_partner_abbr_desc(g_xmdg_m.xmdg007)
        RETURNING g_xmdg_m.xmdg007_desc

   #依據客戶抓取夥伴關係檔設置的發票對象(若有多筆時選取主要)預設給發票對象欄位(xmdg202)，若沒有設置則預設客戶編號
   IF cl_null(g_xmdg_m.xmdg202) THEN
      SELECT pmac002 INTO g_xmdg_m.xmdg202
        FROM pmac_t
       WHERE pmacent = g_enterprise
         AND pmac001 = g_xmdg_m.xmdg005
         AND pmac003 = '3'
         AND pmac004 = 'Y'
         AND pmacstus = 'Y'
   END IF
   IF cl_null(g_xmdg_m.xmdg202) THEN
      DECLARE pmac_cur CURSOR FOR
         SELECT pmac002 FROM pmac_t
          WHERE pmacent = g_enterprise
            AND pmac001 = g_xmdg_m.xmdg005
            AND pmac003 = '3'
            AND pmacstus = 'Y'
      FOREACH pmac_cur INTO g_xmdg_m.xmdg202
         IF NOT cl_null(g_xmdg_m.xmdg202) THEN
            EXIT FOREACH
         END IF
      END FOREACH
   END IF
   IF cl_null(g_xmdg_m.xmdg202) THEN
      LET g_xmdg_m.xmdg202 = g_xmdg_m.xmdg005
   END IF
   CALL s_desc_get_trading_partner_abbr_desc(g_xmdg_m.xmdg202) RETURNING g_xmdg_m.xmdg202_desc

   DISPLAY BY NAME g_xmdg_m.xmdg002,g_xmdg_m.xmdg003,g_xmdg_m.xmdg006,g_xmdg_m.xmdg007,g_xmdg_m.xmdg008,
                   g_xmdg_m.xmdg009,g_xmdg_m.xmdg010,g_xmdg_m.xmdg011,g_xmdg_m.xmdg012,g_xmdg_m.xmdg013,
                   g_xmdg_m.xmdg014,g_xmdg_m.xmdg015,g_xmdg_m.xmdg018,g_xmdg_m.xmdg019,g_xmdg_m.xmdg020,
                   g_xmdg_m.xmdg026,g_xmdg_m.xmdg027,g_xmdg_m.xmdg032,g_xmdg_m.xmdg033,
                   g_xmdg_m.xmdg002_desc,g_xmdg_m.xmdg003_desc,g_xmdg_m.xmdg008_desc,
                   g_xmdg_m.xmdg009_desc,g_xmdg_m.xmdg010_desc,g_xmdg_m.xmdg013_desc,
                   g_xmdg_m.xmdg014_desc,g_xmdg_m.xmdg018_desc,g_xmdg_m.xmdg019_desc,
                   g_xmdg_m.xmdg020_desc,g_xmdg_m.xmdg026_desc,g_xmdg_m.xmdg027_desc,
                   g_xmdg_m.xmdg006_desc,g_xmdg_m.xmdg007_desc,g_xmdg_m.xmdg202_desc

   LET g_xmdg_m_o.* = g_xmdg_m.*

END FUNCTION]]>
  </point>
  <point name="function.axmt520_xmdg017_ref" order="7" ver="13" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 帶出送貨地址
# Memo...........:
# Usage..........: CALL axmt520_xmdg017_ref()
# Input parameter: no
# Return code....: no
# Date & Author..: 140310 By whitney
# Modify.........:
################################################################################
PRIVATE FUNCTION axmt520_xmdg017_ref()
DEFINE l_success    LIKE type_t.num5
DEFINE l_address    STRING
DEFINE l_pmaa027    LIKE pmaa_t.pmaa027

   LET g_xmdg_m.xmdg017_desc = ''
   LET g_xmdg_m.textedit1 = ''

   IF cl_null(g_xmdg_m.xmdg017) THEN
      RETURN
   END IF

   IF NOT cl_null(g_xmdg_m.xmdg007) THEN
      CALL s_axmt500_get_pmaa027(g_xmdg_m.xmdg007)
           RETURNING l_pmaa027
      IF NOT cl_null(l_pmaa027) THEN
         SELECT oofb011 INTO g_xmdg_m.xmdg017_desc
           FROM oofb_t
          WHERE oofbent = g_enterprise 
            AND oofb002 = l_pmaa027
            AND oofbstus = 'Y'
            AND oofb019 = g_xmdg_m.xmdg017
         #呼叫地址組合應用元件，將組合好的聯絡地址顯示在下方
         CALL s_aooi350_get_address(l_pmaa027,g_xmdg_m.xmdg017,g_dlang)
              RETURNING l_success,l_address
         IF l_success THEN
            LET g_xmdg_m.textedit1 = l_address
         END IF
      END IF
   END IF
   DISPLAY BY NAME g_xmdg_m.xmdg017_desc,g_xmdg_m.textedit1
   
END FUNCTION]]>
  </point>
  <point name="function.axmt520_polygon_chk" order="8" ver="13" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 多角貿易營運據點檢核
# Memo...........:
# Usage..........: CALL axmt520_polygon_chk(p_xmdadocno,p_xmda006,p_xmda050)
# Input parameter: p_xmdadocno   訂單單號
#                : p_xmda006     多角性質
#                : p_xmda050     多角流程代碼
# Return code....: no
# Date & Author..: 140514 By whitney
# Modify.........:
################################################################################
PRIVATE FUNCTION axmt520_polygon_chk(p_xmdadocno,p_xmda006,p_xmda050)
DEFINE p_xmdadocno  LIKE xmda_t.xmdadocno
DEFINE p_xmda006    LIKE xmda_t.xmda006
DEFINE p_xmda050    LIKE xmda_t.xmda050
DEFINE l_icaa011    LIKE icaa_t.icaa011
DEFINE l_icab003    LIKE icab_t.icab003
DEFINE l_cnt        LIKE type_t.num5

   LET g_errno = ''

   #訂單多角性質=1.一般交易
   IF p_xmda006 = '1' THEN
      LET l_cnt = 0
      SELECT COUNT(*) INTO l_cnt 
        FROM xmdc_t 
       WHERE xmdcent = g_enterprise 
#         AND xmdcsite = g_site
         AND xmdcdocno = p_xmdadocno
         AND xmdcunit = g_site
      IF l_cnt = 0 OR cl_null(l_cnt) THEN
         #訂單無任何一筆項次的出貨據點與當前營運據點一樣，不允許輸入此訂單！
         LET g_errno = 'axm-00097'
         RETURN
      END IF 
   END IF 

   IF NOT cl_null(p_xmda050) THEN
      LET l_icaa011 = ''
      LET l_icab003 = ''
      SELECT icaa011 INTO l_icaa011
        FROM icaa_t
       WHERE icaaent = g_enterprise
         AND icaa001 = p_xmda050
      #aici100之出貨通知單開立點
      CASE l_icaa011
         WHEN '0'  #來源站(正拋)
            SELECT icab003 INTO l_icab003
              FROM icab_t
             WHERE icabent = g_enterprise
               AND icab001 = p_xmda050
               AND icab002 = '1'
         WHEN '2'  #終點站(逆拋)
            SELECT icab003 INTO l_icab003
              FROM icab_t
             WHERE icabent = g_enterprise
               AND icab001 = p_xmda050
               AND icab002 = ( SELECT MAX(icab002) FROM icab_t WHERE icabent = g_enterprise AND icab001 = p_xmda050 )
         OTHERWISE LET l_icab003 = g_site
      END CASE
      IF l_icab003 <> g_site THEN
         #當下的營運據點與多角貿易流程設定的營運據點不符！
         LET g_errno = 'axm-00275'
         RETURN
      END IF
   END IF
   
END FUNCTION]]>
  </point>
  <point name="function.axmt520_xmdh001_chk" order="9" ver="16" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 單身單號檢核
# Memo...........:
# Usage..........: CALL axmt520_xmdh001_chk()
# Input parameter: no
# Return code....: no
# Date & Author..: 140312 By whitney
# Modify.........:
################################################################################
PRIVATE FUNCTION axmt520_xmdh001_chk()
DEFINE l_xmda  RECORD
    xmdastus   LIKE xmda_t.xmdastus,
    xmda004    LIKE xmda_t.xmda004, 
    xmda005    LIKE xmda_t.xmda005, 
    xmda006    LIKE xmda_t.xmda006, 
    xmda009    LIKE xmda_t.xmda009, 
    xmda010    LIKE xmda_t.xmda010, 
    xmda011    LIKE xmda_t.xmda011, 
    xmda015    LIKE xmda_t.xmda015, 
    xmda021    LIKE xmda_t.xmda021, 
    xmda022    LIKE xmda_t.xmda022, 
    xmda035    LIKE xmda_t.xmda035, 
    xmda048    LIKE xmda_t.xmda048, 
    xmda050    LIKE xmda_t.xmda050 
           END RECORD   
DEFINE l_xmdh051    LIKE xmdh_t.xmdh051
DEFINE l_slip       LIKE ooba_t.ooba002
DEFINE l_success    LIKE type_t.num5
DEFINE l_cnt        LIKE type_t.num5

   LET g_errno = ''
   
   INITIALIZE l_xmda.* TO NULL

   SELECT xmdastus,xmda004,xmda005,xmda006,xmda009,
          xmda010,xmda011, xmda015,xmda021,xmda022,
          xmda035,xmda048,xmda050
     INTO l_xmda.xmdastus,l_xmda.xmda004,l_xmda.xmda005,l_xmda.xmda006,l_xmda.xmda009,
          l_xmda.xmda010,l_xmda.xmda011, l_xmda.xmda015,l_xmda.xmda021,l_xmda.xmda022,
          l_xmda.xmda035,l_xmda.xmda048,l_xmda.xmda050
     FROM xmda_t
     WHERE xmdaent = g_enterprise
       AND xmdasite = g_site
       AND xmdadocno = g_xmdh_d[l_ac].xmdh001

   CASE
      #輸入的資料不存在於 訂單單頭檔 中!
      WHEN SQLCA.sqlcode = 100    LET g_errno = 'axm-00041'
      #輸入的資料狀態非"已確認"!
      WHEN l_xmda.xmdastus <> 'Y' LET g_errno = 'axm-00042'
      WHEN l_xmda.xmda004 <> g_xmdg_m.xmdg005 LET g_errno = 'axm-00147' #客戶編號
      WHEN l_xmda.xmda005 <> g_xmdg_m.xmdg001 LET g_errno = 'axm-00506' #訂單性質
      WHEN l_xmda.xmda005 = '5'               LET g_errno = 'axm-00237' #此筆資料的單據性質為預先訂單，不可以出貨！
      WHEN l_xmda.xmda006 <> g_xmdg_m.xmdg034 LET g_errno = 'axm-00156' #多角性質--add xmdg034 by shiun
      WHEN l_xmda.xmda009 <> g_xmdg_m.xmdg008 LET g_errno = 'axm-00153' #收款條件
      WHEN l_xmda.xmda010 <> g_xmdg_m.xmdg009 LET g_errno = 'axm-00152' #交易條件
      WHEN l_xmda.xmda011 <> g_xmdg_m.xmdg010 LET g_errno = 'axm-00150' #稅別
      WHEN l_xmda.xmda015 <> g_xmdg_m.xmdg014 LET g_errno = 'axm-00151' #幣別
      WHEN l_xmda.xmda021 <> g_xmdg_m.xmdg006 LET g_errno = 'axm-00148' #收款客戶
      WHEN l_xmda.xmda022 <> g_xmdg_m.xmdg007 LET g_errno = 'axm-00149' #收貨客戶
      WHEN l_xmda.xmda035 <> g_xmdg_m.xmdg013 LET g_errno = 'axm-00154' #發票類型
      WHEN l_xmda.xmda048 <> g_xmdg_m.xmdg032 LET g_errno = 'axm-00356' #內外銷
      OTHERWISE LET g_errno = SQLCA.sqlcode USING '------'
   END CASE

   IF NOT cl_null(g_errno) THEN
      RETURN
   END IF

   LET l_xmdh051 = ''
   SELECT DISTINCT xmdh051 INTO l_xmdh051 
     FROM xmdh_t 
    WHERE xmdhent = g_enterprise 
      AND xmdhsite = g_site
      AND xmdhdocno = g_xmdg_m.xmdgdocno
      AND ROWNUM = 1
   IF cl_null(l_xmdh051) THEN LET l_xmdh051 = ' ' END IF
   IF cl_null(l_xmda.xmda050) THEN LET l_xmda.xmda050 = ' ' END IF
   IF l_xmdh051 <> l_xmda.xmda050 THEN
      #單身多角流程代碼需一至！
      LET g_errno = 'axm-00272'
      RETURN
   END IF
   
   LET l_cnt = 0
   SELECT COUNT(*) INTO l_cnt
     FROM xmdd_t
    WHERE xmddent = g_enterprise
      AND xmdddocno = g_xmdh_d[l_ac].xmdh001
   IF cl_null(l_cnt) OR l_cnt = 0 THEN
      #輸入的資料在訂單單身明細檔中無對應的資料！
      LET g_errno = 'axm-00158'
      RETURN
   END IF
   #若輸入的訂單號+訂單項次的xmdd_t只有對應一個分批序時，則自動將分批序預設到出通單身[C:分批序]上
   IF l_cnt = 1 THEN
      SELECT xmddseq,xmddseq1,xmddseq2
        INTO g_xmdh_d[l_ac].xmdh002,g_xmdh_d[l_ac].xmdh003,g_xmdh_d[l_ac].xmdh004
        FROM xmdd_t
       WHERE xmddent = g_enterprise
         AND xmdddocno = g_xmdh_d[l_ac].xmdh001
      CALL axmt520_xmdh004_chk()
      IF NOT cl_null(g_errno) THEN
         LET g_xmdh_d[l_ac].xmdh002 = g_xmdh_d_o.xmdh002
         LET g_xmdh_d[l_ac].xmdh003 = g_xmdh_d_o.xmdh003
         LET g_xmdh_d[l_ac].xmdh004 = g_xmdh_d_o.xmdh004
         RETURN
      ELSE
         CALL axmt520_xmdh004_default()
      END IF
   ELSE
      LET g_xmdh_d[l_ac].xmdh002 = ''
      LET g_xmdh_d[l_ac].xmdh003 = ''
      LET g_xmdh_d[l_ac].xmdh004 = ''
   END IF
   
END FUNCTION]]>
  </point>
  <point name="function.axmt520_xmdh002_default" order="10" ver="13" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 若輸入的訂單號+訂單項次的xmdd_t只有對應一個訂單項序時，則自動將訂單項序預設到出通單身[C:訂單項序]上
# Memo...........:
# Usage..........: CALL axmt520_xmdh002_default()
# Input parameter: no
# Return code....: no
# Date & Author..: 140312 By whitney
# Modify.........:
################################################################################
PRIVATE FUNCTION axmt520_xmdh002_default()
DEFINE l_cnt        LIKE type_t.num5

   LET l_cnt = 0
   SELECT count(count(xmddseq1)) INTO l_cnt
     FROM xmdd_t
    WHERE xmddent = g_enterprise
      AND xmddsite = g_site
      AND xmdddocno = g_xmdh_d[l_ac].xmdh001
      AND xmddseq = g_xmdh_d[l_ac].xmdh002
    GROUP BY xmddseq1
   IF l_cnt = 1 THEN
      SELECT DISTINCT xmddseq1 INTO g_xmdh_d[l_ac].xmdh003
        FROM xmdd_t
       WHERE xmddent = g_enterprise
         AND xmddsite = g_site
         AND xmdddocno = g_xmdh_d[l_ac].xmdh001
         AND xmddseq = g_xmdh_d[l_ac].xmdh002
   END IF
   
END FUNCTION]]>
  </point>
  <point name="function.axmt520_xmdh004_chk" order="11" ver="13" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 訂單分批序欄位校驗
# Memo...........:
# Usage..........: CALL axmt520_xmdh004_chk()
# Input parameter: no
# Return code....: no
# Date & Author..: 140312 By whitney
# Modify.........:
################################################################################
PRIVATE FUNCTION axmt520_xmdh004_chk()
DEFINE l_xmdc045    LIKE xmdc_t.xmdc045

   LET g_errno = ''
   
   SELECT xmdc045 INTO l_xmdc045
     FROM xmdd_t LEFT OUTER JOIN xmdc_t ON xmdcent = xmddent
                                       AND xmdcdocno = xmdddocno
                                       AND xmdcseq = xmddseq
    WHERE xmddent = g_enterprise
      AND xmddsite = g_site
      AND xmdddocno = g_xmdh_d[l_ac].xmdh001
      AND xmddseq = g_xmdh_d[l_ac].xmdh002
      AND xmddseq1 = g_xmdh_d[l_ac].xmdh003
      AND xmddseq2 = g_xmdh_d[l_ac].xmdh004
   CASE
      WHEN SQLCA.sqlcode = 100    LET g_errno = 'axm-00158'
      #输入的数据在订单单身明细档中无对应的数据！
      WHEN l_xmdc045 <> '1' LET g_errno = 'axm-00634'
      #訂單已結案，不可輸入!
      OTHERWISE LET g_errno = SQLCA.sqlcode USING '------'
   END CASE
   
   IF cl_null(g_errno) THEN
      CALL axmt520_xmdd006_chk(g_xmdh_d[l_ac].xmdh001,g_xmdh_d[l_ac].xmdh002,g_xmdh_d[l_ac].xmdh003,g_xmdh_d[l_ac].xmdh004,g_xmdh_d[l_ac].xmdh006,0,0)
   END IF
  
END FUNCTION]]>
  </point>
  <point name="function.axmt520_xmdh004_default" order="12" ver="20" cite_std="N" new="Y" status="u" src="s" readonly="" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 若訂單號、項次、項序、分批序均有值時，則需預設出貨單身相關欄位值
# Memo...........:
# Usage..........: CALL axmt520_xmdh004_default()
# Input parameter: no
# Return code....: no
# Date & Author..: 140312 By whitney
# Modify.........:
################################################################################
PRIVATE FUNCTION axmt520_xmdh004_default()
DEFINE l_cnt        LIKE type_t.num5
DEFINE l_success    LIKE type_t.num5

   IF cl_null(g_xmdh_d[l_ac].xmdh001) OR
      cl_null(g_xmdh_d[l_ac].xmdh002) OR
      cl_null(g_xmdh_d[l_ac].xmdh003) OR
      cl_null(g_xmdh_d[l_ac].xmdh004) THEN
      RETURN
   END IF
   
   LET l_cnt = 0
   SELECT COUNT(*) INTO l_cnt
     FROM xmdd_t 
    WHERE xmddent = g_enterprise
      AND xmddsite = g_site
      AND xmdddocno = g_xmdh_d[l_ac].xmdh001
      AND xmddseq = g_xmdh_d[l_ac].xmdh002
      AND xmddseq1 = g_xmdh_d[l_ac].xmdh003
      AND xmddseq2 = g_xmdh_d[l_ac].xmdh004
   IF l_cnt = 0 OR cl_null(l_cnt) THEN
      RETURN
   END IF

   SELECT xmddunit,xmdd003,xmdd001,xmdd002,xmdc003,xmdc004,xmdc005,xmdc028,xmdc029,xmdc030,
          xmdd004,(xmdd006-xmdd031+xmdd016),xmdd024,xmdd026,xmdc052,xmdd018,xmdd019,xmdd020,
          xmdc057,xmdc036,xmdc037,xmdc038,xmdc027,xmdd008,xmdc021,xmdc050,xmda050
     INTO g_xmdh_d[l_ac].xmdhunit,g_xmdh_d[l_ac].xmdh005 ,g_xmdh_d[l_ac].xmdh006 ,g_xmdh_d[l_ac].xmdh007,g_xmdh_d[l_ac].xmdh008,
          g_xmdh_d[l_ac].xmdh009 ,g_xmdh_d[l_ac].xmdh010 ,g_xmdh_d[l_ac].xmdh012 ,g_xmdh_d[l_ac].xmdh013,g_xmdh_d[l_ac].xmdh014,
          g_xmdh_d[l_ac].xmdh015 ,g_xmdh_d[l_ac].xmdh016 ,g_xmdh_d[l_ac].xmdh018 ,g_xmdh_d[l_ac].xmdh020,g_xmdh_d[l_ac].xmdh022,
          g_xmdh4_d[l_ac].xmdh023,g_xmdh4_d[l_ac].xmdh024,g_xmdh4_d[l_ac].xmdh025,g_xmdh_d[l_ac].xmdh029,g_xmdh_d[l_ac].xmdh031,
          g_xmdh_d[l_ac].xmdh032 ,g_xmdh_d[l_ac].xmdh033 ,g_xmdh_d[l_ac].xmdh034 ,g_xmdh_d[l_ac].xmdh035,g_xmdh_d[l_ac].xmdh036,
          g_xmdh_d[l_ac].xmdh050 ,g_xmdh_d[l_ac].xmdh051
     FROM xmdd_t LEFT OUTER JOIN xmdc_t ON xmdcent = xmddent
                                       AND xmdcsite = xmddsite
                                       AND xmdcdocno = xmdddocno
                                       AND xmdcseq = xmddseq
                                       AND xmdc045 = '1'
                 LEFT OUTER JOIN xmda_t ON xmdaent = xmddent
                                       AND xmdasite = xmddsite
                                       AND xmdadocno = xmdddocno
    WHERE xmddent = g_enterprise
      AND xmddsite = g_site
      AND xmdddocno = g_xmdh_d[l_ac].xmdh001
      AND xmddseq = g_xmdh_d[l_ac].xmdh002
      AND xmddseq1 = g_xmdh_d[l_ac].xmdh003
      AND xmddseq2 = g_xmdh_d[l_ac].xmdh004

   #多庫儲批
   LET g_xmdh_d[l_ac].xmdh011 = 'N'
   #已轉出貨數量
   LET g_xmdh_d[l_ac].xmdh030 = 0

   CALL axmt520_xmdh016_count(g_xmdh_d[l_ac].xmdhseq,g_xmdh_d[l_ac].xmdh006,g_xmdh_d[l_ac].xmdh015,
                              g_xmdh_d[l_ac].xmdh016,g_xmdh_d[l_ac].xmdh018,g_xmdh_d[l_ac].xmdh020,
                              g_xmdh_d[l_ac].xmdh022,g_xmdh4_d[l_ac].xmdh023,g_xmdh4_d[l_ac].xmdh024,
                              g_xmdh_d[l_ac].xmdh001)   #150522---earl---add
        RETURNING g_xmdh_d[l_ac].xmdh017,g_xmdh_d[l_ac].xmdh019,g_xmdh_d[l_ac].xmdh021,
                  g_xmdh4_d[l_ac].xmdh026,g_xmdh4_d[l_ac].xmdh027,
                  g_xmdh4_d[l_ac].xmdh028,g_xmdh_d[l_ac].xmdh056

   CALL s_desc_get_item_desc(g_xmdh_d[l_ac].xmdh006)
        RETURNING g_xmdh_d[l_ac].xmdh006_desc,g_xmdh_d[l_ac].xmdh006_desc_desc
   CALL s_desc_get_acc_desc('221',g_xmdh_d[l_ac].xmdh009)
        RETURNING g_xmdh_d[l_ac].xmdh009_desc
   CALL s_desc_get_unit_desc(g_xmdh_d[l_ac].xmdh015)
        RETURNING g_xmdh_d[l_ac].xmdh015_desc
   CALL s_desc_get_unit_desc(g_xmdh_d[l_ac].xmdh018)
        RETURNING g_xmdh_d[l_ac].xmdh018_desc
   CALL s_desc_get_stock_desc(g_site,g_xmdh_d[l_ac].xmdh012)
        RETURNING g_xmdh_d[l_ac].xmdh012_desc
   CALL s_desc_get_locator_desc(g_site,g_xmdh_d[l_ac].xmdh012,g_xmdh_d[l_ac].xmdh013)
        RETURNING g_xmdh_d[l_ac].xmdh013_desc
   CALL s_desc_get_unit_desc(g_xmdh_d[l_ac].xmdh020)
        RETURNING g_xmdh_d[l_ac].xmdh020_desc
        
   #add by lixiang 2015/06/18--s--
   CALL s_desc_get_project_desc(g_xmdh_d[l_ac].xmdh031) RETURNING g_xmdh_d[l_ac].xmdh031_desc
   DISPLAY BY NAME g_xmdh_d[l_ac].xmdh031_desc
   
   CALL s_desc_get_wbs_desc(g_xmdh_d[l_ac].xmdh031,g_xmdh_d[l_ac].xmdh032) RETURNING g_xmdh_d[l_ac].xmdh032_desc
   DISPLAY BY NAME g_xmdh_d[l_ac].xmdh032_desc
   
   CALL s_desc_get_activity_desc(g_xmdh_d[l_ac].xmdh031,g_xmdh_d[l_ac].xmdh033) RETURNING g_xmdh_d[l_ac].xmdh033_desc
   DISPLAY BY NAME g_xmdh_d[l_ac].xmdh033_desc
   #add by lixiang 2015/06/18--e----

   LET g_xmdh_d_o.* = g_xmdh_d[l_ac].*
   
END FUNCTION]]>
  </point>
  <point name="function.axmt520_xmdh006_chk" order="13" ver="13" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 料件編號檢核
# Memo...........:
# Usage..........: CALL axmt520_xmdh006_chk()
# Input parameter: no
# Return code....: no
# Date & Author..: 140313 By whitney
# Modify.........:
################################################################################
PRIVATE FUNCTION axmt520_xmdh006_chk()

   INITIALIZE g_chkparam.* TO NULL
   LET g_chkparam.arg1 = g_xmdh_d[l_ac].xmdh006
   IF g_flag = 'Y' THEN
      LET g_chkparam.arg2 = g_xmdh_d[l_ac].xmdh001
      #單身輸入訂單不存在的項次，料號需存在axmt500的”預估費用”資料中
      IF NOT cl_chk_exist("v_xmds001") THEN
         RETURN FALSE
      END IF
   ELSE
      IF NOT cl_chk_exist("v_imaf001_14") THEN
         RETURN FALSE
      END IF
   END IF
               
   IF NOT s_control_check_item(g_xmdh_d[l_ac].xmdh006,'2',g_site,g_user,g_dept,g_xmdg_m.xmdgdocno) THEN
      RETURN FALSE
   END IF
   
   IF NOT axmt520_xmdh006_xmdh007_chk() THEN
      RETURN FALSE
   END IF

   RETURN TRUE
   
END FUNCTION]]>
  </point>
  <point name="function.axmt520_get_amount" order="14" ver="13" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 取得未稅金額、含稅金額、稅額
# Memo...........:
# Usage..........: CALL axmt520_get_amount(p_xmdhseq,p_xmdh021,p_xmdh023,p_xmdh024)
# Input parameter: p_xmdhseq,p_xmdh021,p_xmdh023,p_xmdh024
# Return code....: r_xmdh026,r_xmdh028,r_xmdh027
# Date & Author..: 140314 By whitney
# Modify.........:
################################################################################
PRIVATE FUNCTION axmt520_get_amount(p_xmdhseq,p_xmdh021,p_xmdh023,p_xmdh024)
DEFINE p_xmdgdocno  LIKE xmdg_t.xmdgdocno
DEFINE p_xmdhseq    LIKE xmdh_t.xmdhseq
DEFINE p_xmdh021    LIKE xmdh_t.xmdh021
DEFINE p_xmdh023    LIKE xmdh_t.xmdh023
DEFINE p_xmdh024    LIKE xmdh_t.xmdh024
DEFINE p_xmdg014    LIKE xmdg_t.xmdg014
DEFINE r_xmdh026    LIKE xmdh_t.xmdh026
DEFINE r_xmdh028    LIKE xmdh_t.xmdh028
DEFINE r_xmdh027    LIKE xmdh_t.xmdh027
DEFINE l_money      LIKE xrcd_t.xrcd113
DEFINE l_xrcd113    LIKE xrcd_t.xrcd113
DEFINE l_xrcd114    LIKE xrcd_t.xrcd114
DEFINE l_xrcd115    LIKE xrcd_t.xrcd115
DEFINE l_xrcd123    LIKE xrcd_t.xrcd113
DEFINE l_xrcd124    LIKE xrcd_t.xrcd114
DEFINE l_xrcd125    LIKE xrcd_t.xrcd115
DEFINE l_xrcd133    LIKE xrcd_t.xrcd113
DEFINE l_xrcd134    LIKE xrcd_t.xrcd114
DEFINE l_xrcd135    LIKE xrcd_t.xrcd115

   LET r_xmdh026 = 0
   LET r_xmdh028 = 0
   LET r_xmdh027 = 0

   IF cl_null(g_xmdg_m.xmdgdocno) OR cl_null(p_xmdhseq) OR 
      cl_null(p_xmdh021) OR cl_null(p_xmdh023) OR 
      cl_null(p_xmdh024) OR cl_null(g_xmdg_m.xmdg014) THEN
      RETURN r_xmdh026,r_xmdh028,r_xmdh027
   END IF
   
   LET l_money = p_xmdh021 * p_xmdh023
   CALL s_tax_ins(g_xmdg_m.xmdgdocno,p_xmdhseq,0,g_site,l_money,
                  p_xmdh024,p_xmdh021,g_xmdg_m.xmdg014,1,'','','' )
        RETURNING r_xmdh026,r_xmdh028,r_xmdh027,l_xrcd113,l_xrcd114,l_xrcd115,
                  l_xrcd123,l_xrcd124,l_xrcd125,l_xrcd133,l_xrcd134,l_xrcd135

   RETURN r_xmdh026,r_xmdh028,r_xmdh027
   
END FUNCTION]]>
  </point>
  <point name="function.axmt520_inan_chk" order="15" ver="13" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 若單據別參數設定需檢核在揀量時，則帳面庫存量-已在揀量小於申請出貨數量時，則不允許輸入此庫位
# Memo...........:
# Usage..........: CALL axmt520_inan_chk()
# Input parameter: no
# Return code....: TRUE OR FALSE
# Date & Author..: 140630 By whitney
# Modify.........:
################################################################################
PRIVATE FUNCTION axmt520_inan_chk()
DEFINE l_success    LIKE type_t.num5
DEFINE l_flag       LIKE type_t.num5

   IF g_flag = 'Y' THEN
      RETURN TRUE
   END IF

   CALL s_inventory_check_inan(g_site,g_xmdh_d[l_ac].xmdh006,g_xmdh_d[l_ac].xmdh007,
                               ' ',g_xmdh_d[l_ac].xmdh012,g_xmdh_d[l_ac].xmdh013,
                               g_xmdh_d[l_ac].xmdh014,g_xmdh_d[l_ac].xmdh015,
                               g_xmdh_d[l_ac].xmdh016,g_xmdg_m.xmdgdocno,
                               g_xmdh_d[l_ac].xmdhseq,'0')
        RETURNING l_success,l_flag
   IF NOT l_success THEN
      RETURN FALSE
      IF l_flag = 0 THEN
         RETURN FALSE
      END IF
   END IF
   
   RETURN TRUE
   
END FUNCTION]]>
  </point>
  <point name="function.axmt520_get_oocq019" order="16" ver="13" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: get oocq019
# Memo...........:
# Usage..........: CALL axmt520_get_oocq019()
#                  RETURNING r_oocq019
# Input parameter: no
# Return code....: r_oocq019
# Date & Author..: 140325 By whitney
# Modify.........:
################################################################################
PRIVATE FUNCTION axmt520_get_oocq019()
DEFINE r_oocq019    LIKE oocq_t.oocq019

   LET r_oocq019 = ''
   SELECT oocq019 INTO r_oocq019
     FROM oocq_t
    WHERE oocq001='263'
      AND oocq002= g_xmdg_m.xmdg018
   RETURN r_oocq019
   
END FUNCTION]]>
  </point>
  <point name="function.axmt520_xmdh_display" order="17" ver="13" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 頁簽4顯示欄位
# Memo...........:
# Usage..........: CALL axmt520_xmdh_display()
# Input parameter: no
# Return code....: no
# Date & Author..: 140701 By whitney
# Modify.........:
################################################################################
PRIVATE FUNCTION axmt520_xmdh_display()
   LET g_xmdh4_d[l_ac].xmdhseq = g_xmdh_d[l_ac].xmdhseq 
   LET g_xmdh4_d[l_ac].xmdh0011 = g_xmdh_d[l_ac].xmdh001 
   LET g_xmdh4_d[l_ac].xmdh0021 = g_xmdh_d[l_ac].xmdh002
   LET g_xmdh4_d[l_ac].xmdh0031 = g_xmdh_d[l_ac].xmdh003
   LET g_xmdh4_d[l_ac].xmdh0041 = g_xmdh_d[l_ac].xmdh004
   LET g_xmdh4_d[l_ac].xmdh0051 = g_xmdh_d[l_ac].xmdh005 
   LET g_xmdh4_d[l_ac].xmdh0061 = g_xmdh_d[l_ac].xmdh006
   LET g_xmdh4_d[l_ac].xmdh0061_desc = g_xmdh_d[l_ac].xmdh006_desc
   LET g_xmdh4_d[l_ac].xmdh0061_desc_desc = g_xmdh_d[l_ac].xmdh006_desc_desc
   LET g_xmdh4_d[l_ac].xmdh0071 = g_xmdh_d[l_ac].xmdh007     
   LET g_xmdh4_d[l_ac].xmdh0071_desc = g_xmdh_d[l_ac].xmdh007_desc     
   LET g_xmdh4_d[l_ac].xmdh0091 = g_xmdh_d[l_ac].xmdh009     
   LET g_xmdh4_d[l_ac].xmdh0091_desc = g_xmdh_d[l_ac].xmdh009_desc 
   LET g_xmdh4_d[l_ac].xmdh0101 = g_xmdh_d[l_ac].xmdh010     
   LET g_xmdh4_d[l_ac].xmdh0151 = g_xmdh_d[l_ac].xmdh015     
   LET g_xmdh4_d[l_ac].xmdh0151_desc = g_xmdh_d[l_ac].xmdh015_desc 
   LET g_xmdh4_d[l_ac].xmdh0161 = g_xmdh_d[l_ac].xmdh016     
   LET g_xmdh4_d[l_ac].xmdh0201 = g_xmdh_d[l_ac].xmdh020     
   LET g_xmdh4_d[l_ac].xmdh0201_desc = g_xmdh_d[l_ac].xmdh020_desc 
   LET g_xmdh4_d[l_ac].xmdh0211 = g_xmdh_d[l_ac].xmdh021
   
END FUNCTION]]>
  </point>
  <point name="function.axmt520_upd_price" order="18" ver="14" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 修改單價
# Memo...........:
# Usage..........: CALL axmt520_upd_price()
# Input parameter: no
# Return code....: no
# Date & Author..: 140411 By whitney
# Modify.........:
################################################################################
PRIVATE FUNCTION axmt520_upd_price()
DEFINE l_lock_sw    LIKE type_t.chr1                #單身鎖住否
DEFINE ls_group     STRING
DEFINE l_flag       LIKE type_t.num5
DEFINE l_errno      LIKE type_t.chr10
DEFINE l_xmda017    LIKE xmda_t.xmda017
DEFINE l_xmdc040    LIKE xmdc_t.xmdc040
DEFINE l_xmah003    LIKE xmah_t.xmah003

   LET l_xmda017 = ''
   LET l_xmdc040 = ''
   LET l_xmah003 = ''
   SELECT xmda017,xmdc040,xmah003
     INTO l_xmda017,l_xmdc040,l_xmah003
     FROM xmda_t,xmdc_t,xmah_t
    WHERE xmdaent = g_enterprise
      AND xmdasite = g_site
      AND xmdadocno = g_xmdh_d[g_detail_idx].xmdh001
      AND xmdaent = xmdcent
      AND xmdadocno = xmdcdocno
      AND xmdcseq = g_xmdh_d[g_detail_idx].xmdh002
      AND xmdaent = xmahent
      AND xmda017 = xmah001
   #若單頭取價方式的基本資料設置不允許修改單價時，則單價欄位不可以維護
   IF l_xmah003 = 'N' THEN   
      INITIALIZE g_errparam TO NULL 
      LET g_errparam.extend = l_xmda017
      LET g_errparam.code   = 'sub-00594'
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      RETURN
   END IF

   LET g_forupd_sql = "SELECT xmdhsite,xmdhseq,xmdh001,xmdh002,xmdh003,xmdh004,xmdh005,xmdh006,xmdh007, 
       xmdh034,xmdh009,xmdh010,xmdh015,xmdh016,xmdh017,xmdh018,xmdh019,xmdh008,xmdh011,xmdh012,xmdh013, 
       xmdh014,xmdh020,xmdh021,xmdh022,xmdh036,xmdh031,xmdh032,xmdh033,xmdh050,xmdh030,xmdh051,xmdh052, 
       xmdhseq,xmdh023,xmdh024,xmdh025,xmdh026,xmdh027,xmdh028 FROM xmdh_t WHERE xmdhent=? AND xmdhdocno=?  
       AND xmdhseq=? FOR UPDATE"
   LET g_forupd_sql = cl_sql_forupd(g_forupd_sql)
   LET g_forupd_sql = cl_sql_add_mask(g_forupd_sql)              #遮蔽特定資料
   DECLARE axmt520_bcl4 CURSOR FROM g_forupd_sql
   
   CALL cl_set_comp_entry("xmdh023",TRUE)
 
   DIALOG ATTRIBUTES(UNBUFFERED,FIELD ORDER FORM)
   
      INPUT ARRAY g_xmdh4_d FROM s_detail4.*
         ATTRIBUTE(COUNT = g_rec_b,WITHOUT DEFAULTS, #MAXCOUNT = g_max_rec,
                   INSERT ROW = FALSE, 
                   DELETE ROW = FALSE,
                   APPEND ROW = FALSE)
                 
         BEFORE INPUT
            CALL axmt520_b_fill()
            LET g_rec_b = g_xmdh4_d.getLength()
            
         BEFORE ROW     
            LET l_ac = ARR_CURR()
            LET g_detail_idx = l_ac
              
            LET l_lock_sw = 'N'            #DEFAULT
            DISPLAY l_ac TO FORMONLY.idx
         
            IF s_transaction_chk("N",0) THEN
               CALL s_transaction_begin()
            END IF
            
            OPEN axmt520_cl USING g_enterprise,g_xmdg_m.xmdgdocno
            IF STATUS THEN
               INITIALIZE g_errparam TO NULL
               LET g_errparam.code =  STATUS
               LET g_errparam.extend = "OPEN axmt520_cl:"
               LET g_errparam.popup = TRUE
               CALL cl_err()
               CLOSE axmt520_cl
               CALL s_transaction_end('N','0')
               RETURN
            END IF
            
            LET g_rec_b = g_xmdh4_d.getLength()
            
            LET g_xmdh_d_t.* = g_xmdh_d[l_ac].*    #BACKUP
            LET g_xmdh4_d_t.* = g_xmdh4_d[l_ac].*  #BACKUP
            LET g_xmdh4_d_o.* = g_xmdh4_d[l_ac].*

            LET ls_group = "xmdh_t"
            IF ls_group.getIndexOf("xmdh_t",1) THEN
               OPEN axmt520_bcl4 USING g_enterprise,g_xmdg_m.xmdgdocno,g_xmdh_d[g_detail_idx].xmdhseq     
               IF SQLCA.sqlcode THEN
                  INITIALIZE g_errparam TO NULL 
                  LET g_errparam.extend = "axmt520_bcl4" 
                  LET g_errparam.code   = SQLCA.sqlcode 
                  LET g_errparam.popup  = TRUE 
                  CALL cl_err()
                  LET l_lock_sw='Y'
               ELSE
                  FETCH axmt520_bcl4 INTO
                      g_xmdh_d[l_ac].xmdhsite,g_xmdh_d[l_ac].xmdhseq,g_xmdh_d[l_ac].xmdh001,g_xmdh_d[l_ac].xmdh002,
                      g_xmdh_d[l_ac].xmdh003,g_xmdh_d[l_ac].xmdh004,g_xmdh_d[l_ac].xmdh005,g_xmdh_d[l_ac].xmdh006,
                      g_xmdh_d[l_ac].xmdh007,g_xmdh_d[l_ac].xmdh034,g_xmdh_d[l_ac].xmdh009,g_xmdh_d[l_ac].xmdh010,
                      g_xmdh_d[l_ac].xmdh015,g_xmdh_d[l_ac].xmdh016,g_xmdh_d[l_ac].xmdh017,g_xmdh_d[l_ac].xmdh018,
                      g_xmdh_d[l_ac].xmdh019,g_xmdh_d[l_ac].xmdh008,g_xmdh_d[l_ac].xmdh011,g_xmdh_d[l_ac].xmdh012,
                      g_xmdh_d[l_ac].xmdh013,g_xmdh_d[l_ac].xmdh014,g_xmdh_d[l_ac].xmdh020,g_xmdh_d[l_ac].xmdh021,
                      g_xmdh_d[l_ac].xmdh022,g_xmdh_d[l_ac].xmdh036,g_xmdh_d[l_ac].xmdh031,g_xmdh_d[l_ac].xmdh032,
                      g_xmdh_d[l_ac].xmdh033,g_xmdh_d[l_ac].xmdh050,g_xmdh_d[l_ac].xmdh030,g_xmdh_d[l_ac].xmdh051,
                      g_xmdh_d[l_ac].xmdh052,g_xmdh4_d[l_ac].xmdhseq,g_xmdh4_d[l_ac].xmdh023,g_xmdh4_d[l_ac].xmdh024,
                      g_xmdh4_d[l_ac].xmdh025,g_xmdh4_d[l_ac].xmdh026,g_xmdh4_d[l_ac].xmdh027,g_xmdh4_d[l_ac].xmdh028
                  IF SQLCA.sqlcode THEN
                     INITIALIZE g_errparam TO NULL 
                     LET g_errparam.extend = g_xmdh_d[g_detail_idx].xmdhseq
                     LET g_errparam.code   = SQLCA.sqlcode 
                     LET g_errparam.popup  = TRUE 
                     CALL cl_err()
                      LET l_lock_sw = "Y"
                  END IF
                  LET g_bfill = "N"
                  CALL axmt520_show()
                  LET g_bfill = "Y"
                  CALL cl_show_fld_cont()
               END IF
            END IF
         
         AFTER FIELD xmdh023
            CALL s_sale_price_check(l_xmda017,g_xmdh4_d[l_ac].xmdh023,g_xmdh4_d_o.xmdh023,l_xmdc040,g_xmdg_m.xmdg014,g_xmdh_d[l_ac].xmdh006,g_xmdh_d[l_ac].xmdh007,g_xmdh_d[l_ac].xmdh020)
                 RETURNING l_flag,l_errno
            IF NOT l_flag THEN
               INITIALIZE g_errparam TO NULL
               LET g_errparam.code = l_errno
               LET g_errparam.popup = TRUE
               CALL cl_err() 
               LET g_xmdh4_d[l_ac].xmdh023 = g_xmdh4_d_o.xmdh023
               NEXT FIELD xmdh023
            END IF                   
            IF NOT cl_null(g_xmdh4_d[l_ac].xmdh023) THEN 
               IF g_xmdh4_d[l_ac].xmdh023 <> g_xmdh4_d_o.xmdh023 OR cl_null(g_xmdh4_d_o.xmdh023) THEN
                  CALL axmt520_get_amount(g_xmdh_d[l_ac].xmdhseq,g_xmdh_d[l_ac].xmdh021,g_xmdh4_d[l_ac].xmdh023,g_xmdh4_d[l_ac].xmdh024)
                       RETURNING g_xmdh4_d[l_ac].xmdh026,g_xmdh4_d[l_ac].xmdh028,g_xmdh4_d[l_ac].xmdh027
               END IF
            END IF 
            LET g_xmdh4_d_o.xmdh023 = g_xmdh4_d[l_ac].xmdh023

         ON ROW CHANGE
            IF INT_FLAG THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = '' 
               LET g_errparam.code   = 9001 
               LET g_errparam.popup  = FALSE 
               CALL cl_err()
               LET INT_FLAG = 0
               LET g_xmdh_d[l_ac].* = g_xmdh_d_t.*
               LET g_xmdh4_d[l_ac].* = g_xmdh4_d_t.*
               CALL s_transaction_end('N','0')
               CLOSE axmt520_bcl4
               EXIT DIALOG 
            END IF
            IF l_lock_sw = 'Y' THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = g_xmdh_d[g_detail_idx].xmdhseq
               LET g_errparam.code   = -263 
               LET g_errparam.popup  = TRUE 
               CALL cl_err()
               LET g_xmdh_d[l_ac].* = g_xmdh_d_t.*
               LET g_xmdh4_d[l_ac].* = g_xmdh4_d_t.*
            ELSE
               UPDATE xmdh_t
                  SET xmdh023 = g_xmdh4_d[l_ac].xmdh023,
                      xmdh026 = g_xmdh4_d[l_ac].xmdh026,
                      xmdh027 = g_xmdh4_d[l_ac].xmdh027,
                      xmdh028 = g_xmdh4_d[l_ac].xmdh028
                WHERE xmdhent = g_enterprise
                  AND xmdhdocno = g_xmdg_m.xmdgdocno 
                  AND xmdhseq = g_xmdh_d[g_detail_idx].xmdhseq
               CASE
                  WHEN SQLCA.sqlerrd[3] = 0  #更新不到的處理
                     INITIALIZE g_errparam TO NULL 
                     LET g_errparam.extend = "xmdh_t" 
                     LET g_errparam.code   = "std-00009" 
                     LET g_errparam.popup  = TRUE 
                     CALL cl_err()
                     CALL s_transaction_end('N','0')
                     LET g_xmdh_d[l_ac].* = g_xmdh_d_t.*
                     LET g_xmdh4_d[l_ac].* = g_xmdh4_d_t.*
                  WHEN SQLCA.sqlcode #其他錯誤
                     INITIALIZE g_errparam TO NULL 
                     LET g_errparam.extend = "xmdh_t" 
                     LET g_errparam.code   = SQLCA.sqlcode 
                     LET g_errparam.popup  = TRUE 
                     CALL cl_err()
                     LET g_xmdh_d[l_ac].* = g_xmdh_d_t.*
                     LET g_xmdh4_d[l_ac].* = g_xmdh4_d_t.*
                     CALL s_transaction_end('N','0')
                  OTHERWISE
                     INITIALIZE gs_keys TO NULL 
                     LET gs_keys[1] = g_xmdg_m.xmdgdocno
                     LET gs_keys_bak[1] = g_xmdgdocno_t
                     LET gs_keys[2] = g_xmdh_d[g_detail_idx].xmdhseq
                     LET gs_keys_bak[2] = g_xmdh4_d_t.xmdhseq
                     CALL axmt520_update_b('xmdh_t',gs_keys,gs_keys_bak,"'1'")
                     #資料多語言用-增/改
               END CASE
               #修改歷程記錄
               LET g_log1 = util.JSON.stringify(g_xmdg_m),util.JSON.stringify(g_xmdh_d_t)
               LET g_log2 = util.JSON.stringify(g_xmdg_m),util.JSON.stringify(g_xmdh_d[l_ac])
               IF NOT cl_log_modified_record(g_log1,g_log2) THEN 
                  CALL s_transaction_end('N','0')
               END IF
            END IF
            
         AFTER ROW
            CLOSE axmt520_bcl4
            CALL s_transaction_end('Y','0')
              
         AFTER INPUT
            IF s_transaction_chk("N",0) THEN
               CALL s_transaction_begin()
            END IF
            CALL axmt520_total_count()

      END INPUT
 
      BEFORE DIALOG 
         NEXT FIELD xmdhseq_4
 
      ON ACTION accept
         ACCEPT DIALOG
        
      ON ACTION cancel      #在dialog button (放棄)
         LET INT_FLAG = TRUE 
         LET g_detail_idx  = 1
         LET g_detail_idx2 = 1
         EXIT DIALOG
 
      ON ACTION close       #在dialog 右上角 (X)
         LET INT_FLAG = TRUE 
         EXIT DIALOG
 
      ON ACTION exit        #toolbar 離開
         LET INT_FLAG = TRUE 
         EXIT DIALOG
 
      #交談指令共用ACTION
      &include "common_action.4gl" 
         CONTINUE DIALOG 
   END DIALOG
   
   CALL cl_set_comp_entry("xmdh023",FALSE)
   
END FUNCTION]]>
  </point>
  <point name="function.axmt520_doc_default" order="19" ver="17" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 單別預設
# Memo...........:
# Usage..........: CALL axmt520_doc_default()
# Input parameter: no
# Return code....: no
# Date & Author..: 140806 By whitney
# Modify.........:
################################################################################
PRIVATE FUNCTION axmt520_doc_default()
DEFINE l_success    LIKE type_t.num5
DEFINE l_oodb011    LIKE oodb_t.oodb011
   
   LET g_errshow = 0
   
   LET g_xmdg_m.xmdg001 = s_aooi200_get_doc_default(g_site,'1',g_xmdg_m.xmdgdocno,'xmdg001',g_xmdg_m.xmdg001)
   LET g_xmdg_m.xmdg002 = s_aooi200_get_doc_default(g_site,'1',g_xmdg_m.xmdgdocno,'xmdg002',g_xmdg_m.xmdg002)
   LET g_xmdg_m.xmdg003 = s_aooi200_get_doc_default(g_site,'1',g_xmdg_m.xmdgdocno,'xmdg003',g_xmdg_m.xmdg003)
   LET g_xmdg_m.xmdg004 = s_aooi200_get_doc_default(g_site,'1',g_xmdg_m.xmdgdocno,'xmdg004',g_xmdg_m.xmdg004)
   LET g_xmdg_m.xmdg005 = s_aooi200_get_doc_default(g_site,'1',g_xmdg_m.xmdgdocno,'xmdg005',g_xmdg_m.xmdg005)
   LET g_xmdg_m.xmdg006 = s_aooi200_get_doc_default(g_site,'1',g_xmdg_m.xmdgdocno,'xmdg006',g_xmdg_m.xmdg006)
   LET g_xmdg_m.xmdg007 = s_aooi200_get_doc_default(g_site,'1',g_xmdg_m.xmdgdocno,'xmdg007',g_xmdg_m.xmdg007)
   LET g_xmdg_m.xmdg008 = s_aooi200_get_doc_default(g_site,'1',g_xmdg_m.xmdgdocno,'xmdg008',g_xmdg_m.xmdg008)
   LET g_xmdg_m.xmdg009 = s_aooi200_get_doc_default(g_site,'1',g_xmdg_m.xmdgdocno,'xmdg009',g_xmdg_m.xmdg009)
   LET g_xmdg_m.xmdg010 = s_aooi200_get_doc_default(g_site,'1',g_xmdg_m.xmdgdocno,'xmdg010',g_xmdg_m.xmdg010)
   LET g_xmdg_m.xmdg011 = s_aooi200_get_doc_default(g_site,'1',g_xmdg_m.xmdgdocno,'xmdg011',g_xmdg_m.xmdg011)
   LET g_xmdg_m.xmdg012 = s_aooi200_get_doc_default(g_site,'1',g_xmdg_m.xmdgdocno,'xmdg012',g_xmdg_m.xmdg012)
   LET g_xmdg_m.xmdg013 = s_aooi200_get_doc_default(g_site,'1',g_xmdg_m.xmdgdocno,'xmdg013',g_xmdg_m.xmdg013)
   LET g_xmdg_m.xmdg014 = s_aooi200_get_doc_default(g_site,'1',g_xmdg_m.xmdgdocno,'xmdg014',g_xmdg_m.xmdg014)
   LET g_xmdg_m.xmdg015 = s_aooi200_get_doc_default(g_site,'1',g_xmdg_m.xmdgdocno,'xmdg015',g_xmdg_m.xmdg015)
   LET g_xmdg_m.xmdg016 = s_aooi200_get_doc_default(g_site,'1',g_xmdg_m.xmdgdocno,'xmdg016',g_xmdg_m.xmdg016)
   LET g_xmdg_m.xmdg017 = s_aooi200_get_doc_default(g_site,'1',g_xmdg_m.xmdgdocno,'xmdg017',g_xmdg_m.xmdg017)
   LET g_xmdg_m.xmdg018 = s_aooi200_get_doc_default(g_site,'1',g_xmdg_m.xmdgdocno,'xmdg018',g_xmdg_m.xmdg018)
   LET g_xmdg_m.xmdg019 = s_aooi200_get_doc_default(g_site,'1',g_xmdg_m.xmdgdocno,'xmdg019',g_xmdg_m.xmdg019)
   LET g_xmdg_m.xmdg020 = s_aooi200_get_doc_default(g_site,'1',g_xmdg_m.xmdgdocno,'xmdg020',g_xmdg_m.xmdg020)
   LET g_xmdg_m.xmdg021 = s_aooi200_get_doc_default(g_site,'1',g_xmdg_m.xmdgdocno,'xmdg021',g_xmdg_m.xmdg021)
   LET g_xmdg_m.xmdg022 = s_aooi200_get_doc_default(g_site,'1',g_xmdg_m.xmdgdocno,'xmdg022',g_xmdg_m.xmdg022)
   LET g_xmdg_m.xmdg023 = s_aooi200_get_doc_default(g_site,'1',g_xmdg_m.xmdgdocno,'xmdg023',g_xmdg_m.xmdg023)
   LET g_xmdg_m.xmdg024 = s_aooi200_get_doc_default(g_site,'1',g_xmdg_m.xmdgdocno,'xmdg024',g_xmdg_m.xmdg024)
   LET g_xmdg_m.xmdg025 = s_aooi200_get_doc_default(g_site,'1',g_xmdg_m.xmdgdocno,'xmdg025',g_xmdg_m.xmdg025)
   LET g_xmdg_m.xmdg026 = s_aooi200_get_doc_default(g_site,'1',g_xmdg_m.xmdgdocno,'xmdg026',g_xmdg_m.xmdg026)
   LET g_xmdg_m.xmdg027 = s_aooi200_get_doc_default(g_site,'1',g_xmdg_m.xmdgdocno,'xmdg027',g_xmdg_m.xmdg027)
   LET g_xmdg_m.xmdg028 = s_aooi200_get_doc_default(g_site,'1',g_xmdg_m.xmdgdocno,'xmdg028',g_xmdg_m.xmdg028)
   LET g_xmdg_m.xmdg030 = s_aooi200_get_doc_default(g_site,'1',g_xmdg_m.xmdgdocno,'xmdg030',g_xmdg_m.xmdg030)
   LET g_xmdg_m.xmdg031 = s_aooi200_get_doc_default(g_site,'1',g_xmdg_m.xmdgdocno,'xmdg031',g_xmdg_m.xmdg031)
   LET g_xmdg_m.xmdg032 = s_aooi200_get_doc_default(g_site,'1',g_xmdg_m.xmdgdocno,'xmdg032',g_xmdg_m.xmdg032)
   LET g_xmdg_m.xmdg033 = s_aooi200_get_doc_default(g_site,'1',g_xmdg_m.xmdgdocno,'xmdg033',g_xmdg_m.xmdg033)
   #add xmdg034 by shiun------------
   LET g_xmdg_m.xmdg034 = s_aooi200_get_doc_default(g_site,'1',g_xmdg_m.xmdgdocno,'xmdg034',g_xmdg_m.xmdg034)
   #LET g_xmdg_m.xmdg050 = s_aooi200_get_doc_default(g_site,'1',g_xmdg_m.xmdgdocno,'xmdg050',g_xmdg_m.xmdg050)
   #LET g_xmdg_m.xmdg051 = s_aooi200_get_doc_default(g_site,'1',g_xmdg_m.xmdgdocno,'xmdg051',g_xmdg_m.xmdg051)
   #LET g_xmdg_m.xmdg052 = s_aooi200_get_doc_default(g_site,'1',g_xmdg_m.xmdgdocno,'xmdg052',g_xmdg_m.xmdg052)
   LET g_xmdg_m.xmdg053 = s_aooi200_get_doc_default(g_site,'1',g_xmdg_m.xmdgdocno,'xmdg053',g_xmdg_m.xmdg053)
   LET g_xmdg_m.xmdg054 = s_aooi200_get_doc_default(g_site,'1',g_xmdg_m.xmdgdocno,'xmdg054',g_xmdg_m.xmdg054)
   LET g_xmdg_m.xmdg055 = s_aooi200_get_doc_default(g_site,'1',g_xmdg_m.xmdgdocno,'xmdg055',g_xmdg_m.xmdg055)
   LET g_xmdg_m.xmdg056 = s_aooi200_get_doc_default(g_site,'1',g_xmdg_m.xmdgdocno,'xmdg056',g_xmdg_m.xmdg056)

   CALL s_desc_get_person_desc(g_xmdg_m.xmdg002)
        RETURNING g_xmdg_m.xmdg002_desc
   DISPLAY BY NAME g_xmdg_m.xmdg002_desc
   
   IF NOT cl_null(g_xmdg_m.xmdg002) AND cl_null(g_xmdg_m.xmdg003) THEN
      SELECT ooag003 INTO g_xmdg_m.xmdg003
        FROM ooag_t
       WHERE ooagent = g_enterprise
         AND ooag001 = g_xmdg_m.xmdg002
   END IF

   CALL s_desc_get_department_desc(g_xmdg_m.xmdg003)
        RETURNING g_xmdg_m.xmdg003_desc
   DISPLAY BY NAME g_xmdg_m.xmdg003_desc

   IF NOT cl_null(g_xmdg_m.xmdg005) THEN
      IF cl_null(g_xmdg_m.xmdg006) THEN
         CALL s_axmt540_client_partner(g_xmdg_m.xmdgdocno,g_xmdg_m.xmdg005,'1')
              RETURNING g_xmdg_m.xmdg006
      END IF
      IF cl_null(g_xmdg_m.xmdg007) THEN
         CALL s_axmt540_client_partner(g_xmdg_m.xmdgdocno,g_xmdg_m.xmdg005,'2')
              RETURNING g_xmdg_m.xmdg007
      END IF
   END IF

   CALL s_desc_get_trading_partner_abbr_desc(g_xmdg_m.xmdg005)
        RETURNING g_xmdg_m.xmdg005_desc
   DISPLAY BY NAME g_xmdg_m.xmdg005_desc

   CALL s_desc_get_trading_partner_abbr_desc(g_xmdg_m.xmdg006)
        RETURNING g_xmdg_m.xmdg006_desc
   DISPLAY BY NAME g_xmdg_m.xmdg006_desc

   CALL s_desc_get_trading_partner_abbr_desc(g_xmdg_m.xmdg007)
        RETURNING g_xmdg_m.xmdg007_desc
   DISPLAY BY NAME g_xmdg_m.xmdg007_desc

   CALL s_desc_get_acc_desc('275',g_xmdg_m.xmdg026)
        RETURNING g_xmdg_m.xmdg026_desc
   DISPLAY BY NAME g_xmdg_m.xmdg026_desc

   CALL s_desc_get_acc_desc('295',g_xmdg_m.xmdg027)
        RETURNING g_xmdg_m.xmdg027_desc
   DISPLAY BY NAME g_xmdg_m.xmdg027_desc

   CALL s_desc_get_acc_desc('209',g_xmdg_m.xmdg030)
        RETURNING g_xmdg_m.xmdg030_desc
   DISPLAY BY NAME g_xmdg_m.xmdg030_desc

   CALL s_desc_get_acc_desc('297',g_xmdg_m.xmdg031)
        RETURNING g_xmdg_m.xmdg031_desc
   DISPLAY BY NAME g_xmdg_m.xmdg031_desc

   CALL axmt520_xmdg017_ref()
   CALL axmt520_xmdg023_ref()

   IF NOT cl_null(g_xmdg_m.xmdg018) THEN
      CALL s_desc_get_acc_desc('263',g_xmdg_m.xmdg018)
           RETURNING g_xmdg_m.xmdg018_desc
      DISPLAY BY NAME g_xmdg_m.xmdg018_desc
      CALL s_apmi011_location_ref(g_xmdg_m.xmdg018,g_xmdg_m.xmdg019)
           RETURNING g_xmdg_m.xmdg019_desc
      DISPLAY BY NAME g_xmdg_m.xmdg019_desc
      CALL s_apmi011_location_ref(g_xmdg_m.xmdg018,g_xmdg_m.xmdg020)
           RETURNING g_xmdg_m.xmdg020_desc
      DISPLAY BY NAME g_xmdg_m.xmdg020_desc
   END IF

   CALL s_desc_get_trading_partner_abbr_desc(g_xmdg_m.xmdg016)
        RETURNING g_xmdg_m.xmdg016_desc
   DISPLAY BY NAME g_xmdg_m.xmdg016_desc

   CALL s_desc_get_ooib002_desc(g_xmdg_m.xmdg008)
        RETURNING g_xmdg_m.xmdg008_desc
   DISPLAY BY NAME g_xmdg_m.xmdg008_desc

   CALL s_desc_get_acc_desc('238',g_xmdg_m.xmdg009)
        RETURNING g_xmdg_m.xmdg009_desc
   DISPLAY BY NAME g_xmdg_m.xmdg009_desc

   IF NOT cl_null(g_xmdg_m.xmdg010) THEN
      CALL s_tax_chk(g_site,g_xmdg_m.xmdg010)
           RETURNING l_success,g_xmdg_m.xmdg010_desc,g_xmdg_m.xmdg012,g_xmdg_m.xmdg011,l_oodb011
      IF NOT l_success THEN
         LET g_xmdg_m.xmdg010 = g_xmdg_m_o.xmdg010
         LET g_xmdg_m.xmdg011 = g_xmdg_m_o.xmdg011
         LET g_xmdg_m.xmdg012 = g_xmdg_m_o.xmdg012
      END IF
   END IF

   CALL s_desc_get_tax_desc1(g_site,g_xmdg_m.xmdg010)
        RETURNING g_xmdg_m.xmdg010_desc
   DISPLAY BY NAME g_xmdg_m.xmdg010_desc

   CALL s_desc_get_invoice_type_desc1(g_site,g_xmdg_m.xmdg013)
        RETURNING g_xmdg_m.xmdg013_desc
   DISPLAY BY NAME g_xmdg_m.xmdg013_desc

   IF NOT cl_null(g_xmdg_m.xmdg032) AND NOT cl_null(g_xmdg_m.xmdg014) THEN
      CALL s_axmt540_get_exchange(g_xmdg_m.xmdg032,g_xmdg_m.xmdg014)
           RETURNING g_xmdg_m.xmdg015
   END IF

   CALL s_desc_get_currency_desc(g_xmdg_m.xmdg014)
        RETURNING g_xmdg_m.xmdg014_desc
   DISPLAY BY NAME g_xmdg_m.xmdg014_desc
   
   #add xmdg034 by shiun------------
   DISPLAY BY NAME g_xmdg_m.xmdg001,g_xmdg_m.xmdg002,g_xmdg_m.xmdg003,g_xmdg_m.xmdg004,g_xmdg_m.xmdg005,
                   g_xmdg_m.xmdg006,g_xmdg_m.xmdg007,g_xmdg_m.xmdg008,g_xmdg_m.xmdg009,g_xmdg_m.xmdg010,
                   g_xmdg_m.xmdg011,g_xmdg_m.xmdg012,g_xmdg_m.xmdg013,g_xmdg_m.xmdg014,g_xmdg_m.xmdg015,
                   g_xmdg_m.xmdg016,g_xmdg_m.xmdg017,g_xmdg_m.xmdg018,g_xmdg_m.xmdg019,g_xmdg_m.xmdg020,
                   g_xmdg_m.xmdg021,g_xmdg_m.xmdg022,g_xmdg_m.xmdg023,g_xmdg_m.xmdg024,g_xmdg_m.xmdg025,
                   g_xmdg_m.xmdg026,g_xmdg_m.xmdg027,g_xmdg_m.xmdg028,g_xmdg_m.xmdg030,g_xmdg_m.xmdg031,
                   g_xmdg_m.xmdg032,g_xmdg_m.xmdg033,#g_xmdg_m.xmdg050,g_xmdg_m.xmdg051,g_xmdg_m.xmdg052,
                   g_xmdg_m.xmdg034,g_xmdg_m.xmdg053,g_xmdg_m.xmdg054,g_xmdg_m.xmdg055,g_xmdg_m.xmdg056

   LET g_xmdg_m_o.* = g_xmdg_m.*
   
END FUNCTION]]>
  </point>
  <point name="function.axmt520_xmdh006_xmdh007_chk" order="20" ver="13" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 當出貨料號與訂單料號不一樣時，必須檢核是否與訂單料號有替代關係，若沒有則不允許修改
# Memo...........:
# Usage..........: CALL axmt520_xmdh006_xmdh007_chk()
# Input parameter: no
# Return code....: TRUE OR FALSE
# Date & Author..: 140808 By whitney
# Modify.........:
################################################################################
PRIVATE FUNCTION axmt520_xmdh006_xmdh007_chk()
DEFINE l_xmdd001    LIKE xmdd_t.xmdd001
DEFINE l_xmdd002    LIKE xmdd_t.xmdd002
   
   IF g_flag = 'Y' THEN
      RETURN TRUE
   END IF
   
   LET l_xmdd001 = ''
   LET l_xmdd002 = ''
   SELECT xmdd001,xmdd002
     INTO l_xmdd001,l_xmdd002
     FROM xmdd_t
    WHERE xmddent = g_enterprise
      AND xmdddocno = g_xmdh_d[l_ac].xmdh001
      AND xmddseq = g_xmdh_d[l_ac].xmdh002
      AND xmddseq1 = g_xmdh_d[l_ac].xmdh003
      AND xmddseq2 = g_xmdh_d[l_ac].xmdh004
   IF l_xmdd001 <> g_xmdh_d[l_ac].xmdh006 OR l_xmdd002 <> g_xmdh_d[l_ac].xmdh007 THEN
      IF NOT s_pmaq_chk_replacement(g_xmdg_m.xmdg005,l_xmdd001,g_xmdh_d[l_ac].xmdh006,'3',l_xmdd002,g_xmdh_d[l_ac].xmdh007) THEN
         RETURN FALSE
      END IF
   END IF

   RETURN TRUE
   
END FUNCTION]]>
  </point>
  <point name="function.axmt520_action_modify" order="21" ver="14" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 執行action修改資料前lock
# Memo...........:
# Usage..........: CALL axmt520_action_modify(p_flag)
# Input parameter: p_flag   'P'單價/'H'留置
# Return code....: TRUE OR FALSE
# Date & Author..: 140811 By whitney
# Modify.........:
################################################################################
PRIVATE FUNCTION axmt520_action_modify(p_flag)
DEFINE p_flag       LIKE type_t.chr1
DEFINE r_success    LIKE type_t.num5

   LET r_success = TRUE

   IF g_xmdg_m.xmdgdocno IS NULL THEN
      INITIALIZE g_errparam TO NULL 
      LET g_errparam.extend = "" 
      LET g_errparam.code   = "std-00003" 
      LET g_errparam.popup  = FALSE 
      CALL cl_err()
      RETURN FALSE
   END IF
 
   ERROR ""
  
   LET g_xmdgdocno_t = g_xmdg_m.xmdgdocno
 
   OPEN axmt520_cl USING g_enterprise,g_xmdg_m.xmdgdocno
   IF STATUS THEN
      INITIALIZE g_errparam TO NULL 
      LET g_errparam.extend = "OPEN axmt520_cl:" 
      LET g_errparam.code   = STATUS 
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      CLOSE axmt520_cl
      LET r_success = FALSE
      RETURN r_success
   END IF
 
#   EXECUTE axmt520_master_referesh USING g_xmdg_m.xmdgdocno INTO g_xmdg_m.xmdgdocno,g_xmdg_m.xmdgdocdt, 
#       g_xmdg_m.xmdg004,g_xmdg_m.xmdgsite,g_xmdg_m.xmdg002,g_xmdg_m.xmdg003,g_xmdg_m.xmdgstus,g_xmdg_m.xmdg001, 
#       g_xmdg_m.xmdg034,g_xmdg_m.xmdg005,g_xmdg_m.xmdg006,g_xmdg_m.xmdg007,g_xmdg_m.xmdg202,g_xmdg_m.xmdg028, 
#       g_xmdg_m.xmdg026,g_xmdg_m.xmdg027,g_xmdg_m.xmdg024,g_xmdg_m.xmdg025,g_xmdg_m.xmdg030,g_xmdg_m.xmdg031, 
#       g_xmdg_m.xmdg053,g_xmdg_m.xmdg054,g_xmdg_m.xmdg055,g_xmdg_m.xmdg017,g_xmdg_m.xmdg018,g_xmdg_m.xmdg019, 
#       g_xmdg_m.xmdg020,g_xmdg_m.xmdg016,g_xmdg_m.xmdg021,g_xmdg_m.xmdg022,g_xmdg_m.xmdg023,g_xmdg_m.xmdg008, 
#       g_xmdg_m.xmdg009,g_xmdg_m.xmdg010,g_xmdg_m.xmdg011,g_xmdg_m.xmdg012,g_xmdg_m.xmdg013,g_xmdg_m.xmdg032, 
#       g_xmdg_m.xmdg033,g_xmdg_m.xmdg014,g_xmdg_m.xmdg015,g_xmdg_m.xmdgownid,g_xmdg_m.xmdgowndp,g_xmdg_m.xmdgcrtid, 
#       g_xmdg_m.xmdgcrtdp,g_xmdg_m.xmdgcrtdt,g_xmdg_m.xmdgmodid,g_xmdg_m.xmdgmoddt,g_xmdg_m.xmdgcnfid, 
#       g_xmdg_m.xmdgcnfdt,g_xmdg_m.xmdg002_desc,g_xmdg_m.xmdg003_desc,g_xmdg_m.xmdg005_desc,g_xmdg_m.xmdg006_desc, 
#       g_xmdg_m.xmdg007_desc,g_xmdg_m.xmdg202_desc,g_xmdg_m.xmdg026_desc,g_xmdg_m.xmdg027_desc,g_xmdg_m.xmdg030_desc, 
#       g_xmdg_m.xmdg031_desc,g_xmdg_m.xmdg017_desc,g_xmdg_m.xmdg018_desc,g_xmdg_m.xmdg016_desc,g_xmdg_m.xmdg008_desc, 
#       g_xmdg_m.xmdg009_desc,g_xmdg_m.xmdg014_desc,g_xmdg_m.xmdgownid_desc,g_xmdg_m.xmdgowndp_desc,g_xmdg_m.xmdgcrtid_desc, 
#       g_xmdg_m.xmdgcrtdp_desc,g_xmdg_m.xmdgmodid_desc,g_xmdg_m.xmdgcnfid_desc
#   IF SQLCA.sqlcode THEN
#      INITIALIZE g_errparam TO NULL 
#      LET g_errparam.extend = g_xmdg_m.xmdgdocno 
#      LET g_errparam.code   = SQLCA.sqlcode 
#      LET g_errparam.popup  = FALSE 
#      CALL cl_err()
#      CLOSE axmt520_cl
#      LET r_success = FALSE
#      RETURN r_success
#   END IF
   
   #切換畫面
   IF g_main_hidden THEN
      CALL gfrm_curr.setElementHidden("mainlayout",0)
      CALL gfrm_curr.setElementHidden("worksheet",1)
      LET g_main_hidden = 0
   END IF
 
   CALL cl_set_head_visible("","YES")  
   
   CALL axmt520_show()

   WHILE TRUE
      LET g_xmdgdocno_t = g_xmdg_m.xmdgdocno
      LET g_xmdg_m.xmdgmodid = g_user 
      LET g_xmdg_m.xmdgmoddt = cl_get_current()
      
      CASE p_flag
         WHEN 'P'  #單價
            CALL axmt520_upd_price()
         WHEN 'H'  #留置
            CALL axmt520_hold()
         OTHERWISE EXIT CASE
      END CASE
      IF INT_FLAG THEN
         LET INT_FLAG = 0
         LET g_xmdg_m.* = g_xmdg_m_t.*
         CALL axmt520_show()
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = '' 
         LET g_errparam.code   = 9001 
         LET g_errparam.popup  = FALSE 
         CALL cl_err()
         LET r_success = FALSE
         EXIT WHILE
      END IF 
      
      UPDATE xmdg_t
         SET xmdgmodid = g_xmdg_m.xmdgmodid,
             xmdgmoddt = g_xmdg_m.xmdgmoddt
       WHERE xmdgent = g_enterprise
         AND xmdgdocno = g_xmdgdocno_t
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = "upd xmdg_t" 
         LET g_errparam.code   = SQLCA.sqlcode 
         LET g_errparam.popup  = TRUE 
         CALL cl_err()
         LET r_success = FALSE
      END IF
   
      EXIT WHILE
   END WHILE
   
   CLOSE axmt520_cl
   
   #流程通知預埋點-U
   CALL cl_flow_notify(g_xmdg_m.xmdgdocno,'U')
   RETURN r_success
   
END FUNCTION]]>
  </point>
  <point name="function.axmt520_hold" order="22" ver="14" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 留置
# Memo...........:
# Usage..........: axmt520_hold()
# Input parameter: no
# Return code....: no
# Date & Author..: 140811 By whitney
# Modify.........:
################################################################################
PRIVATE FUNCTION axmt520_hold()

   CALL cl_set_comp_entry("xmdg031",TRUE)
   
   DIALOG ATTRIBUTES(UNBUFFERED,FIELD ORDER FORM)
   
      INPUT BY NAME g_xmdg_m.xmdg031
         ATTRIBUTE(WITHOUT DEFAULTS)
     
         BEFORE INPUT
            LET g_xmdg_m_t.* = g_xmdg_m.*
            LET g_xmdg_m_o.* = g_xmdg_m.*

         AFTER FIELD xmdg031
            LET g_xmdg_m.xmdg031_desc = ''
            DISPLAY BY NAME g_xmdg_m.xmdg031_desc
            IF NOT cl_null(g_xmdg_m.xmdg031) THEN
               IF (g_xmdg_m.xmdg031 != g_xmdg_m_o.xmdg031 OR g_xmdg_m_o.xmdg031 IS NULL ) THEN
                  IF NOT s_azzi650_chk_exist('297',g_xmdg_m.xmdg031) THEN
                     LET g_xmdg_m.xmdg031 = g_xmdg_m_o.xmdg031
                     CALL s_desc_get_acc_desc('297',g_xmdg_m.xmdg031)
                          RETURNING g_xmdg_m.xmdg031_desc
                     DISPLAY BY NAME g_xmdg_m.xmdg031,g_xmdg_m.xmdg031_desc
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL s_desc_get_acc_desc('297',g_xmdg_m.xmdg031)
                 RETURNING g_xmdg_m.xmdg031_desc
            DISPLAY BY NAME g_xmdg_m.xmdg031_desc
            LET g_xmdg_m_o.xmdg031 = g_xmdg_m.xmdg031

         ON ACTION controlp INFIELD xmdg031
   			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
	   		LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_xmdg_m.xmdg031  #給予default值
            LET g_qryparam.arg1 = "297" 
            CALL q_oocq002()                            #呼叫開窗
            LET g_xmdg_m.xmdg031 = g_qryparam.return1   #將開窗取得的值回傳到變數
            DISPLAY g_xmdg_m.xmdg031 TO xmdg031         #顯示到畫面上
            CALL s_desc_get_acc_desc('297',g_xmdg_m.xmdg031)
                 RETURNING g_xmdg_m.xmdg031_desc
            DISPLAY BY NAME g_xmdg_m.xmdg031_desc
            NEXT FIELD xmdg031                          #返回原欄位

         AFTER INPUT
            IF INT_FLAG THEN
               EXIT DIALOG
            END IF
            DISPLAY BY NAME g_xmdg_m.xmdgdocno
            LET g_xmdg_m.xmdgstus = 'H'
            UPDATE xmdg_t
               SET xmdg031 = g_xmdg_m.xmdg031,
                   xmdgstus = g_xmdg_m.xmdgstus
             WHERE xmdgent = g_enterprise
               AND xmdgdocno = g_xmdgdocno_t
            IF SQLCA.sqlcode THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = "xmdg_t" 
               LET g_errparam.code   = SQLCA.sqlcode 
               LET g_errparam.popup  = TRUE 
               CALL cl_err()
               LET INT_FLAG = TRUE 
               CONTINUE DIALOG
            END IF
            LET g_log1 = util.JSON.stringify(g_xmdg_m_t)
            LET g_log2 = util.JSON.stringify(g_xmdg_m)
            IF NOT cl_log_modified_record(g_log1,g_log2) THEN 
               LET INT_FLAG = TRUE 
            END IF
            LET g_xmdgdocno_t = g_xmdg_m.xmdgdocno
            
      END INPUT
      
      BEFORE DIALOG 
         NEXT FIELD xmdg031
 
      ON ACTION accept
         ACCEPT DIALOG
        
      ON ACTION cancel      #在dialog button (放棄)
         LET INT_FLAG = TRUE 
         EXIT DIALOG
 
      ON ACTION close       #在dialog 右上角 (X)
         LET INT_FLAG = TRUE 
         EXIT DIALOG
 
      ON ACTION exit        #toolbar 離開
         LET INT_FLAG = TRUE 
         EXIT DIALOG
 
      #交談指令共用ACTION
      &include "common_action.4gl" 
         CONTINUE DIALOG 
   END DIALOG
   
   CALL cl_set_comp_entry("xmdg031",FALSE)

END FUNCTION]]>
  </point>
  <point name="function.axmt520_total_count" order="23" ver="14" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 計算總額
# Memo...........:
# Usage..........: CALL axmt520_total_count()
# Input parameter: no
# Return code....: no
# Date & Author..: 140930 By whitney
# Modify.........:
################################################################################
PRIVATE FUNCTION axmt520_total_count()
DEFINE l_xrcd103    LIKE xrcd_t.xrcd103
DEFINE l_xrcd104    LIKE xrcd_t.xrcd104
DEFINE l_xrcd105    LIKE xrcd_t.xrcd105
DEFINE l_xrcd113    LIKE xrcd_t.xrcd113
DEFINE l_xrcd114    LIKE xrcd_t.xrcd114
DEFINE l_xrcd115    LIKE xrcd_t.xrcd115

   CALL s_tax_recount(g_xmdg_m.xmdgdocno)
        RETURNING l_xrcd103,l_xrcd104,l_xrcd105,
                  l_xrcd113,l_xrcd114,l_xrcd115     
   UPDATE xmdg_t
      SET xmdg050 = l_xrcd103,
          xmdg051 = l_xrcd105,
          xmdg052 = l_xrcd104
    WHERE xmdgent = g_enterprise
      AND xmdgdocno = g_xmdg_m.xmdgdocno

END FUNCTION]]>
  </point>
  <point name="function.axmt520_xmdh006_default" order="24" ver="16" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 費用料號預帶欄位
# Memo...........:
# Usage..........: CALL axmt520_xmdh006_default()
# Input parameter:
# Return code....: 
# Date & Author..: 141205 By earl
# Modify.........:
################################################################################
PRIVATE FUNCTION axmt520_xmdh006_default()
DEFINE l_success     LIKE type_t.num5
DEFINE l_controlno   LIKE ooha_t.ooha001
DEFINE l_xmdh  RECORD
    xmdh005    LIKE xmdh_t.xmdh005,  #子件特性
    xmdh008    LIKE xmdh_t.xmdh008,  #包裝容器
    xmdh015    LIKE xmdh_t.xmdh015,  #出貨單位
    xmdh018    LIKE xmdh_t.xmdh018,  #參考單位
    xmdh020    LIKE xmdh_t.xmdh020,  #計價單位
    xmdh012    LIKE xmdh_t.xmdh012,  #出貨庫位
    xmdh013    LIKE xmdh_t.xmdh013   #出貨儲位
           END RECORD
                   
   IF NOT cl_null(g_xmdh_d[l_ac].xmdh006) THEN
      RETURN
   END IF

   #稅別
   LET g_xmdh4_d[l_ac].xmdh024 = g_xmdg_m.xmdg010
   LET g_xmdh4_d[l_ac].xmdh024_desc = g_xmdg_m.xmdg010_desc
   LET g_xmdh4_d[l_ac].xmdh025 = g_xmdg_m.xmdg011
   #產品特徵
   IF cl_null(g_xmdh_d[l_ac].xmdh007) THEN
      LET g_xmdh_d[l_ac].xmdh007 = ' '
   END IF
   #預帶料件預設值
   CALL s_axmt540_materials_search(g_xmdg_m.xmdg002,g_xmdg_m.xmdg003,g_xmdg_m.xmdg005,g_xmdh_d[l_ac].xmdh006,g_xmdh_d[l_ac].xmdh007)
        RETURNING l_xmdh.xmdh005,l_xmdh.xmdh008,l_xmdh.xmdh015,l_xmdh.xmdh018,l_xmdh.xmdh020,l_xmdh.xmdh012,l_xmdh.xmdh013
#   #子件特性
#   LET g_xmdh_d[l_ac].xmdh005 = l_xmdh.xmdh005
#   LET g_xmdh_d_o.xmdh005 = g_xmdh_d[l_ac].xmdh005
   #包裝容器
   LET g_xmdh_d[l_ac].xmdh008 = l_xmdh.xmdh008
   #出貨單位
   LET g_xmdh_d[l_ac].xmdh015 = l_xmdh.xmdh015
   CALL s_desc_get_unit_desc(g_xmdh_d[l_ac].xmdh015)
        RETURNING g_xmdh_d[l_ac].xmdh015_desc
   #營運據點是否使用參考單位(若不使用為'')
   IF cl_get_para(g_enterprise,g_site,'S-BAS-0028') = "N" THEN
      LET g_xmdh_d[l_ac].xmdh018 = ''
   ELSE
      LET g_xmdh_d[l_ac].xmdh018 = l_xmdh.xmdh018
   END IF
   CALL s_desc_get_unit_desc(g_xmdh_d[l_ac].xmdh018)
        RETURNING g_xmdh_d[l_ac].xmdh018_desc
   #計價單位
   LET g_xmdh_d[l_ac].xmdh020 = l_xmdh.xmdh020
   CALL s_desc_get_unit_desc(g_xmdh_d[l_ac].xmdh020)
        RETURNING g_xmdh_d[l_ac].xmdh020_desc
   #出貨庫位
   LET g_xmdh_d[l_ac].xmdh012 = l_xmdh.xmdh012
   CALL s_desc_get_stock_desc(g_site,g_xmdh_d[l_ac].xmdh012)
        RETURNING g_xmdh_d[l_ac].xmdh012_desc
   #出貨儲位
   LET g_xmdh_d[l_ac].xmdh013 = l_xmdh.xmdh013
   CALL s_desc_get_locator_desc(g_site,g_xmdh_d[l_ac].xmdh012,g_xmdh_d[l_ac].xmdh013)
        RETURNING g_xmdh_d[l_ac].xmdh013_desc
   #數量預設為1
   LET g_xmdh_d[l_ac].xmdh016 = 1

   CALL axmt520_xmdh016_count(g_xmdh_d[l_ac].xmdhseq,g_xmdh_d[l_ac].xmdh006,g_xmdh_d[l_ac].xmdh015,
                              g_xmdh_d[l_ac].xmdh016,g_xmdh_d[l_ac].xmdh018,g_xmdh_d[l_ac].xmdh020,
                              g_xmdh_d[l_ac].xmdh022,g_xmdh4_d[l_ac].xmdh023,g_xmdh4_d[l_ac].xmdh024,
                              g_xmdh_d[l_ac].xmdh001)   #150522---earl---add
        RETURNING g_xmdh_d[l_ac].xmdh017,g_xmdh_d[l_ac].xmdh019,g_xmdh_d[l_ac].xmdh021,
                  g_xmdh4_d[l_ac].xmdh026,g_xmdh4_d[l_ac].xmdh027,
                  g_xmdh4_d[l_ac].xmdh028,g_xmdh_d[l_ac].xmdh056

   LET g_xmdh_d_o.* = g_xmdh_d[l_ac].*

END FUNCTION]]>
  </point>
  <point name="function.axmt520_xmdd006_chk" order="25" ver="16" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 檢核該訂單分批續是否還有可轉出通量
# Memo...........:
# Usage..........: CALL axmt520_xmdd006_chk(p_xmdh001,p_xmdh002,p_xmdh003,p_xmdh004,p_xmdh006,p_xmdh016,p_xmdh016_o)
#                : RETURNING
# Input parameter: p_xmdh001   單號
#                : p_xmdh002   項次
#                : p_xmdh003   項序
#                : p_xmdh004   分批序
#                : p_xmdh006   料件編號
#                : p_xmdh016   本次登打出通量
#                : p_xmdh016_o 修改前
# Return code....: 
# Date & Author..: 140312 By whitney
# Modify.........: 141216-00003#1 打出通未確認的量，調整成不可大於訂單量 - 已轉出通量即可
################################################################################
PRIVATE FUNCTION axmt520_xmdd006_chk(p_xmdh001,p_xmdh002,p_xmdh003,p_xmdh004,p_xmdh006,p_xmdh016,p_xmdh016_o)
DEFINE p_xmdh001   LIKE xmdh_t.xmdh001
DEFINE p_xmdh002   LIKE xmdh_t.xmdh002
DEFINE p_xmdh003   LIKE xmdh_t.xmdh003
DEFINE p_xmdh004   LIKE xmdh_t.xmdh004
DEFINE p_xmdh006   LIKE xmdh_t.xmdh006
DEFINE p_xmdh016   LIKE xmdh_t.xmdh016
DEFINE p_xmdh016_o LIKE xmdh_t.xmdh016
DEFINE l_xmdh016   LIKE xmdh_t.xmdh016
DEFINE l_xmdd006   LIKE xmdd_t.xmdd006
DEFINE l_xmdd016   LIKE xmdd_t.xmdd016
DEFINE l_xmdd031   LIKE xmdd_t.xmdd031
DEFINE l_imaf128   LIKE imaf_t.imaf128

   LET g_errno = ''

   #訂單號、項次、項序、分批序且均有值時做檢核
   IF cl_null(p_xmdh001) OR cl_null(p_xmdh002) OR
      cl_null(p_xmdh003) OR cl_null(p_xmdh004) THEN
      RETURN
   END IF

   IF cl_null(p_xmdh016) THEN LET p_xmdh016 = 0 END IF
   IF cl_null(p_xmdh016_o) THEN LET p_xmdh016_o = 0 END IF

   LET l_xmdd006 = 0
   LET l_xmdd016 = 0
   LET l_xmdd031 = 0
   SELECT COALESCE(xmdd006,0),COALESCE(xmdd016,0),COALESCE(xmdd031,0)
     INTO l_xmdd006,l_xmdd016,l_xmdd031
     FROM xmdd_t
    WHERE xmddent = g_enterprise
      AND xmddsite = g_site
      AND xmdddocno = p_xmdh001
      AND xmddseq = p_xmdh002
      AND xmddseq1 = p_xmdh003
      AND xmddseq2 = p_xmdh004

   SELECT imaf128 INTO l_imaf128
     FROM imaf_t
    WHERE imafent = g_enterprise
      AND imafsite = g_site
      AND imaf001 = p_xmdh006
   IF NOT cl_null(l_imaf128) AND l_imaf128 > 0 THEN
      LET l_xmdd006 = l_xmdd006 * (100+l_imaf128) / 100
   END IF

#   SELECT SUM(xmdh016) INTO l_xmdh016
#     FROM xmdh_t,xmdg_t
#    WHERE xmdhent = g_enterprise
#      AND xmdhsite = g_site
#      AND xmdh001 = p_xmdh001
#      AND xmdh002 = p_xmdh002
#      AND xmdh003 = p_xmdh003
#      AND xmdh004 = p_xmdh004
#      AND xmdgent = xmdhent 
#      AND xmdgsite =xmdhsite
#      AND xmdgdocno = xmdhdocno
#      AND xmdgstus = 'N'
#   IF cl_null(l_xmdh016) THEN LET l_xmdh016 = 0 END IF
#   
#   #可轉出通量 = 分批訂購數量 - 已轉出通數量 + 銷退換貨數量 - 該確認單據已登打出通未確認的出通量
#   IF (l_xmdd006 - l_xmdd031 + l_xmdd016 - l_xmdh016) < 0 THEN
#      LET g_errno = 'axm-00157'
#   END IF
   LET l_xmdh016 = l_xmdd006 - l_xmdd031 + l_xmdd016 - p_xmdh016 + p_xmdh016_o
   IF l_xmdh016 < 0 OR (l_xmdh016 = 0 AND p_xmdh016 = 0) THEN
      LET g_errno = 'axm-00157'
   END IF

END FUNCTION]]>
  </point>
  <point name="function.axmt520_upd_xmdd031" order="26" ver="14" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 回寫訂單的已轉出通量
# Memo...........:
# Usage..........: CALL axmt520_upd_xmdd031(p_xmdh001,p_xmdh002,p_xmdh003,p_xmdh004,p_xmdh016,p_xmdh016_o)
#                : RETURNING r_success
# Input parameter: p_xmdh001   單號
#                : p_xmdh002   項次
#                : p_xmdh003   項序
#                : p_xmdh004   分批序
#                : p_xmdh016   本次登打出通量
#                : p_xmdh016_o 修改前
# Return code....: r_success   處理狀態
# Date & Author..: 140408 By whitney
# Modify.........: 
################################################################################
PRIVATE FUNCTION axmt520_upd_xmdd031(p_xmdh001,p_xmdh002,p_xmdh003,p_xmdh004,p_xmdh016,p_xmdh016_o)
DEFINE p_xmdh001   LIKE xmdh_t.xmdh001
DEFINE p_xmdh002   LIKE xmdh_t.xmdh002
DEFINE p_xmdh003   LIKE xmdh_t.xmdh003
DEFINE p_xmdh004   LIKE xmdh_t.xmdh004
DEFINE p_xmdh016   LIKE xmdh_t.xmdh016
DEFINE p_xmdh016_o LIKE xmdh_t.xmdh016
DEFINE r_success   LIKE type_t.num5

   LET r_success = TRUE

   #訂單號、項次、項序、分批序且均有值時做檢核
   IF cl_null(p_xmdh001) OR cl_null(p_xmdh002) OR
      cl_null(p_xmdh003) OR cl_null(p_xmdh004) THEN
      RETURN
   END IF

   IF cl_null(p_xmdh016) THEN LET p_xmdh016 = 0 END IF
   IF cl_null(p_xmdh016_o) THEN LET p_xmdh016_o = 0 END IF

   UPDATE xmdd_t
      SET xmdd031 = COALESCE(xmdd031,0) + p_xmdh016 - p_xmdh016_o
    WHERE xmddent = g_enterprise
      AND xmddsite = g_site
      AND xmdddocno = p_xmdh001
      AND xmddseq = p_xmdh002
      AND xmddseq1 = p_xmdh003
      AND xmddseq2 = p_xmdh004
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL 
      LET g_errparam.extend = "upd xmdd_t" 
      LET g_errparam.code   = SQLCA.sqlcode 
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      LET r_success = FALSE
   END IF

   RETURN r_success
END FUNCTION]]>
  </point>
  <point name="function.axmt520_xmdh016_count" order="27" ver="16" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 數量異動後其他欄位對應的調整
# Memo...........:
# Usage..........: CALL axmt520_xmdh016_count(p_xmdhseq,p_xmdh006,p_xmdh015,p_xmdh016,p_xmdh018,p_xmdh020,p_xmdh022,p_xmdh023,p_xmdh024,p_xmdh001)
#                  RETURNING r_xmdh017,r_xmdh019,r_xmdh021,r_xmdh026,r_xmdh027,r_xmdh028,r_xmdh056
# Input parameter: 
# Return code....: 
# Date & Author..: 150520 By whitney
# Modify.........: 150522 By Earl加上p_xmdh001用來判斷訂單單據別參數
################################################################################
PRIVATE FUNCTION axmt520_xmdh016_count(p_xmdhseq,p_xmdh006,p_xmdh015,p_xmdh016,p_xmdh018,p_xmdh020,p_xmdh022,p_xmdh023,p_xmdh024,p_xmdh001)
DEFINE p_xmdhseq    LIKE xmdh_t.xmdhseq
DEFINE p_xmdh006    LIKE xmdh_t.xmdh006
DEFINE p_xmdh015    LIKE xmdh_t.xmdh015
DEFINE p_xmdh016    LIKE xmdh_t.xmdh016
DEFINE p_xmdh018    LIKE xmdh_t.xmdh018
DEFINE p_xmdh020    LIKE xmdh_t.xmdh020
DEFINE p_xmdh022    LIKE xmdh_t.xmdh022
DEFINE p_xmdh023    LIKE xmdh_t.xmdh023
DEFINE p_xmdh024    LIKE xmdh_t.xmdh024
DEFINE p_xmdh001    LIKE xmdh_t.xmdh001    #150522---earl---add
DEFINE r_xmdh017    LIKE xmdh_t.xmdh017
DEFINE r_xmdh019    LIKE xmdh_t.xmdh019
DEFINE r_xmdh021    LIKE xmdh_t.xmdh021
DEFINE r_xmdh026    LIKE xmdh_t.xmdh026
DEFINE r_xmdh027    LIKE xmdh_t.xmdh027
DEFINE r_xmdh028    LIKE xmdh_t.xmdh028
DEFINE r_xmdh056    LIKE xmdh_t.xmdh056
DEFINE l_success    LIKE type_t.num5
DEFINE l_slip       LIKE ooba_t.ooba002    #150522---earl---add

   LET r_xmdh017 = 0
   LET r_xmdh019 = 0
   LET r_xmdh021 = 0
   LET r_xmdh026 = 0
   LET r_xmdh027 = 0
   LET r_xmdh028 = 0
   LET r_xmdh056 = 0
   
   #對出貨數量進行取位
   IF NOT cl_null(p_xmdh015) THEN
      CALL s_aooi250_take_decimals(p_xmdh015,p_xmdh016)
           RETURNING l_success,p_xmdh016
   END IF
   
   #申請出通數量值預設給實際出通量
   LET r_xmdh017 = p_xmdh016

#150522---earl---mod---s
   #預設檢驗合格量
   IF p_xmdh022 = 'Y' AND NOT cl_null(p_xmdh001) THEN
      #單據別參數
      CALL s_aooi200_get_slip(p_xmdh001) RETURNING l_success,l_slip
      IF cl_get_doc_para(g_enterprise,g_site,l_slip,'D-BAS-0094') = '1' THEN   #OQC檢驗時機為"1出貨通知時檢驗"
         LET r_xmdh056 = 0
      ELSE
         LET r_xmdh056 = p_xmdh016
      END IF
   ELSE
      LET r_xmdh056 = p_xmdh016
   END IF
#150522---earl---mod---e

   IF cl_null(p_xmdh006) THEN
      RETURN r_xmdh017,r_xmdh019,r_xmdh021,r_xmdh026,r_xmdh027,r_xmdh028,r_xmdh056
   END IF
   
   #若料號有設置使用參考單位時且出貨單位與參考單位有設置換算率時，則應自動推算參考數量
   IF NOT cl_null(p_xmdh018) THEN
      CALL s_aooi250_convert_qty(p_xmdh006,p_xmdh015,p_xmdh018,p_xmdh016)
           RETURNING l_success,r_xmdh019
   END IF
   #若料號有使用銷售計價單位時，則輸入[C:出貨數量]時則應自動推算計價數量
   IF NOT cl_null(p_xmdh020) THEN
      CALL s_aooi250_convert_qty(p_xmdh006,p_xmdh015,p_xmdh020,p_xmdh016)
           RETURNING l_success,r_xmdh021
      #重新計算未稅金額、含稅金額、稅額
      CALL axmt520_get_amount(p_xmdhseq,r_xmdh021,p_xmdh023,p_xmdh024)
           RETURNING r_xmdh026,r_xmdh028,r_xmdh027
   END IF

   RETURN r_xmdh017,r_xmdh019,r_xmdh021,r_xmdh026,r_xmdh027,r_xmdh028,r_xmdh056
END FUNCTION]]>
  </point>
  <point name="function.axmt520_xmdg023_ref" order="28" ver="17" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 嘜頭編號说明
# Memo...........:
# Usage..........: CALL axmt520_xmdg023_ref()
# Input parameter: 
# Return code....: 
# Date & Author..: 150609 By whitney
# Modify.........:
################################################################################
PRIVATE FUNCTION axmt520_xmdg023_ref()

   LET g_xmdg_m.xmdg023_desc = ''
   
   IF cl_null(g_xmdg_m.xmdg005) OR cl_null(g_xmdg_m.xmdg023) THEN
      RETURN
   END IF
   
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_xmdg_m.xmdg005
   LET g_ref_fields[2] = g_xmdg_m.xmdg023
   CALL ap_ref_array2(g_ref_fields,"SELECT xmaol004 FROM xmaol_t WHERE xmaolent='"||g_enterprise||"' AND xmaol001=? AND xmaol002=? AND xmaol003='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_xmdg_m.xmdg023_desc = '', g_rtn_fields[1] , ''
   DISPLAY BY NAME g_xmdg_m.xmdg023_desc

END FUNCTION]]>
  </point>
  <point name="b_fill.body.fill_sql" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="b_fill.body2.fill_sql" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[           ]]>
  </point>
  <point name="b_fill.define" order="" ver="13" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   DEFINE l_success  LIKE type_t.num5]]>
  </point>
  <point name="b_fill.fill" order="" ver="20" cite_std="N" new="N" status="u" src="s" readonly="" mark_hard="N">
    <![CDATA[        
         CALL s_feature_description(g_xmdh_d[l_ac].xmdh006,g_xmdh_d[l_ac].xmdh007) RETURNING l_success,g_xmdh_d[l_ac].xmdh007_desc
       
         #150120新增"客戶訂單號碼"  earl(s)
         SELECT xmda033 INTO g_xmdh_d[l_ac].xmda033
           FROM xmda_t
          WHERE xmdaent = g_enterprise
            AND xmdadocno = g_xmdh_d[l_ac].xmdh001
         #150120新增"客戶訂單號碼"  earl(e)         
         
         #add by lixiang 2015/06/18--s--
         CALL s_desc_get_project_desc(g_xmdh_d[l_ac].xmdh031) RETURNING g_xmdh_d[l_ac].xmdh031_desc
         DISPLAY BY NAME g_xmdh_d[l_ac].xmdh031_desc

         CALL s_desc_get_wbs_desc(g_xmdh_d[l_ac].xmdh031,g_xmdh_d[l_ac].xmdh032) RETURNING g_xmdh_d[l_ac].xmdh032_desc
         DISPLAY BY NAME g_xmdh_d[l_ac].xmdh032_desc

         CALL s_desc_get_activity_desc(g_xmdh_d[l_ac].xmdh031,g_xmdh_d[l_ac].xmdh033) RETURNING g_xmdh_d[l_ac].xmdh033_desc
         DISPLAY BY NAME g_xmdh_d[l_ac].xmdh033_desc
         
         #add by lixiang 2015/06/18--e----
         
         CALL axmt520_xmdh_display()

         CALL s_feature_description(g_xmdh4_d[l_ac].xmdh0061,g_xmdh4_d[l_ac].xmdh0071) RETURNING l_success,g_xmdh4_d[l_ac].xmdh0071_desc
      
         CALL s_desc_get_tax_desc1(g_site,g_xmdh4_d[l_ac].xmdh024) RETURNING g_xmdh4_d[l_ac].xmdh024_desc
]]>
  </point>
  <point name="b_fill.sql" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="b_fill.sql2" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[           ]]>
  </point>
  <point name="b_fill.sql_before" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[     ]]>
  </point>
  <point name="b_fill2.after_fill" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="b_fill2.define" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[     ]]>
  </point>
  <point name="b_fill2.fill" order="" ver="13" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[      
         CALL s_feature_description(g_xmdh2_d[l_ac].xmdi001,g_xmdh2_d[l_ac].xmdi002) RETURNING l_success,g_xmdh2_d[l_ac].xmdi002_desc
         
         CALL s_desc_get_item_desc(g_xmdh2_d[l_ac].xmdi001) RETURNING g_xmdh2_d[l_ac].xmdi001_desc,g_xmdh2_d[l_ac].xmdi001_desc_desc
         
         CALL s_desc_get_acc_desc('221',g_xmdh2_d[l_ac].xmdi003) RETURNING g_xmdh2_d[l_ac].xmdi003_desc
         
         CALL s_desc_get_stock_desc(g_site,g_xmdh2_d[l_ac].xmdi005) RETURNING g_xmdh2_d[l_ac].xmdi005
         
         CALL s_desc_get_locator_desc(g_site,g_xmdh2_d[l_ac].xmdi005,g_xmdh2_d[l_ac].xmdi006) RETURNING g_xmdh2_d[l_ac].xmdi006_desc
         
         CALL s_desc_get_unit_desc(g_xmdh2_d[l_ac].xmdi008) RETURNING g_xmdh2_d[l_ac].xmdi008_desc
        
         CALL s_desc_get_unit_desc(g_xmdh2_d[l_ac].xmdi010) RETURNING g_xmdh2_d[l_ac].xmdi010_desc
      ]]>
  </point>
  <point name="browser_fill.after" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[     ]]>
  </point>
  <point name="browser_fill.before_browser_fill" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="browser_fill.before_count" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="browser_fill.before_foreach" order="" ver="16" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   IF cl_null(g_wc) THEN
      LET g_wc = " xmdgsite = '",g_site,"' "
   ELSE
      LET g_wc = g_wc," AND xmdgsite = '",g_site,"' "
   END IF
   
   IF g_argv[01] = '8' THEN
      LET g_wc = g_wc," AND xmdg001 = '", g_argv[01], "' "
   ELSE
      LET g_wc = g_wc," AND xmdg001 <> '8' "
   END IF

   LET l_wc  = g_wc.trim()]]>
  </point>
  <point name="browser_fill.before_prepare" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[     ]]>
  </point>
  <point name="browser_fill.cnt.join.xmdi_t1" order="" ver="13" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                      " AND xmdiseq = xmdhseq ",]]>
  </point>
  <point name="browser_fill.cnt.join.}" order="" ver="13" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                      " LEFT JOIN xmda_t ON xmdaent = xmdgent AND xmdadocno = xmdh001 ",      #150120新增"客戶訂單號碼"  earl]]>
  </point>
  <point name="browser_fill.cnt_sqlwc" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="browser_fill.define" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[     ]]>
  </point>
  <point name="browser_fill.fill_sqlwc" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="browser_fill.join.xmdh_t1" order="" ver="13" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[               "  LEFT JOIN xmda_t ON xmdaent = xmdgent AND xmdadocno = xmdh001 ",      #150120新增"客戶訂單號碼"  earl]]>
  </point>
  <point name="browser_fill.join.xmdi_t1" order="" ver="13" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[               " AND xmdiseq = xmdhseq ",]]>
  </point>
  <point name="browser_fill.open" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[     ]]>
  </point>
  <point name="browser_fill.other_fill" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[     ]]>
  </point>
  <point name="browser_fill.reference" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[           ]]>
  </point>
  <point name="browser_search.define" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[      ]]>
  </point>
  <point name="construct.a.page1.xmdh001" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.a.page1.xmdh002" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.a.page1.xmdh003" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.a.page1.xmdh004" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.a.page1.xmdh005" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.a.page1.xmdh006" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.a.page1.xmdh007" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.a.page1.xmdh008" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.a.page1.xmdh009" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.a.page1.xmdh010" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.a.page1.xmdh011" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.a.page1.xmdh012" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.a.page1.xmdh013" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.a.page1.xmdh014" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.a.page1.xmdh015" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.a.page1.xmdh016" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.a.page1.xmdh017" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.a.page1.xmdh018" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.a.page1.xmdh019" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.a.page1.xmdh020" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.a.page1.xmdh021" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.a.page1.xmdh022" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.a.page1.xmdh029" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="construct.a.page1.xmdh030" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.a.page1.xmdh031" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.a.page1.xmdh032" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.a.page1.xmdh033" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.a.page1.xmdh034" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.a.page1.xmdh036" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.a.page1.xmdh050" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.a.page1.xmdh051" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[ ]]>
  </point>
  <point name="construct.a.page1.xmdh052" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[ ]]>
  </point>
  <point name="construct.a.page1.xmdhseq" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        ]]>
  </point>
  <point name="construct.a.page1.xmdhsite" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="construct.a.page2.xmdi001" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.a.page2.xmdi002" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.a.page2.xmdi003" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.a.page2.xmdi004" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.a.page2.xmdi005" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.a.page2.xmdi006" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.a.page2.xmdi007" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.a.page2.xmdi008" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.a.page2.xmdi009" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.a.page2.xmdi010" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.a.page2.xmdi011" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.a.page2.xmdi012" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.a.page2.xmdi013" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[ ]]>
  </point>
  <point name="construct.a.page2.xmdiseq" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.a.page2.xmdiseq1" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.a.page2.xmdisite" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[ ]]>
  </point>
  <point name="construct.a.page4.xmdh023" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.a.page4.xmdh024" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.a.page4.xmdh025" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.a.page4.xmdh026" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.a.page4.xmdh027" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.a.page4.xmdh028" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.a.xmdg001" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.a.xmdg002" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.a.xmdg003" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.a.xmdg004" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.a.xmdg005" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.a.xmdg006" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.a.xmdg007" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.a.xmdg008" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.a.xmdg009" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.a.xmdg010" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.a.xmdg011" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.a.xmdg012" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.a.xmdg013" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.a.xmdg014" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.a.xmdg015" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.a.xmdg016" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.a.xmdg017" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.a.xmdg018" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.a.xmdg019" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.a.xmdg020" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.a.xmdg021" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.a.xmdg022" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.a.xmdg023" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.a.xmdg024" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.a.xmdg025" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.a.xmdg026" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.a.xmdg027" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.a.xmdg028" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.a.xmdg030" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.a.xmdg031" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.a.xmdg032" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="construct.a.xmdg033" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="construct.a.xmdg053" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.a.xmdg054" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="construct.a.xmdg055" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="construct.a.xmdgcnfid" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.a.xmdgcrtdp" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.a.xmdgcrtid" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.a.xmdgdocdt" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.a.xmdgdocno" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.a.xmdgmodid" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.a.xmdgowndp" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.a.xmdgownid" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.a.xmdgpstid" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        ]]>
  </point>
  <point name="construct.a.xmdgsite" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="construct.a.xmdgstus" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.b.page1.xmdh001" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.b.page1.xmdh002" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.b.page1.xmdh003" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.b.page1.xmdh004" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.b.page1.xmdh005" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.b.page1.xmdh006" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.b.page1.xmdh007" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.b.page1.xmdh008" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.b.page1.xmdh009" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.b.page1.xmdh010" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.b.page1.xmdh011" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.b.page1.xmdh012" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.b.page1.xmdh013" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.b.page1.xmdh014" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.b.page1.xmdh015" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.b.page1.xmdh016" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.b.page1.xmdh017" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.b.page1.xmdh018" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.b.page1.xmdh019" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.b.page1.xmdh020" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.b.page1.xmdh021" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.b.page1.xmdh022" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.b.page1.xmdh029" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="construct.b.page1.xmdh030" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.b.page1.xmdh031" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.b.page1.xmdh032" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.b.page1.xmdh033" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.b.page1.xmdh034" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.b.page1.xmdh036" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.b.page1.xmdh050" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.b.page1.xmdh051" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[ ]]>
  </point>
  <point name="construct.b.page1.xmdh052" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[ ]]>
  </point>
  <point name="construct.b.page1.xmdhseq" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        ]]>
  </point>
  <point name="construct.b.page1.xmdhsite" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="construct.b.page2.xmdi001" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.b.page2.xmdi002" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.b.page2.xmdi003" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.b.page2.xmdi004" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.b.page2.xmdi005" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.b.page2.xmdi006" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.b.page2.xmdi007" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.b.page2.xmdi008" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.b.page2.xmdi009" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.b.page2.xmdi010" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.b.page2.xmdi011" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.b.page2.xmdi012" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.b.page2.xmdi013" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[ ]]>
  </point>
  <point name="construct.b.page2.xmdiseq" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                         ]]>
  </point>
  <point name="construct.b.page2.xmdiseq1" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.b.page2.xmdisite" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[ ]]>
  </point>
  <point name="construct.b.page4.xmdh023" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.b.page4.xmdh024" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.b.page4.xmdh025" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.b.page4.xmdh026" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.b.page4.xmdh027" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.b.page4.xmdh028" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.b.xmdg001" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.b.xmdg002" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.b.xmdg003" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.b.xmdg004" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.b.xmdg005" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.b.xmdg006" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.b.xmdg007" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.b.xmdg008" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.b.xmdg009" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.b.xmdg010" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.b.xmdg011" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.b.xmdg012" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.b.xmdg013" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.b.xmdg014" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.b.xmdg015" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.b.xmdg016" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.b.xmdg017" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.b.xmdg018" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.b.xmdg019" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.b.xmdg020" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.b.xmdg021" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.b.xmdg022" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.b.xmdg023" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.b.xmdg024" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.b.xmdg025" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.b.xmdg026" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.b.xmdg027" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.b.xmdg028" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.b.xmdg030" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.b.xmdg031" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.b.xmdg032" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[ ]]>
  </point>
  <point name="construct.b.xmdg033" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="construct.b.xmdg053" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.b.xmdg054" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="construct.b.xmdg055" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="construct.b.xmdgcnfdt" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.b.xmdgcnfid" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.b.xmdgcrtdp" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.b.xmdgcrtdt" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.b.xmdgcrtid" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.b.xmdgdocdt" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.b.xmdgdocno" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.b.xmdgmoddt" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.b.xmdgmodid" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.b.xmdgowndp" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.b.xmdgownid" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.b.xmdgpstdt" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        ]]>
  </point>
  <point name="construct.b.xmdgpstid" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        ]]>
  </point>
  <point name="construct.b.xmdgsite" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="construct.b.xmdgstus" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.c.page1.xmda033" order="" ver="13" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #應用 a08 樣板自動產生(Version:2)
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c' 
            LET g_qryparam.reqry = FALSE
            CALL q_xmda033()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmda033  #顯示到畫面上
            NEXT FIELD xmda033                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page1.xmdh001" order="" ver="19" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
	   		LET g_qryparam.reqry = FALSE
            IF g_argv[01] = '8' THEN
   	   		LET g_qryparam.where = " xmda005 = '8' "
   	   	ELSE
   	   		LET g_qryparam.where = " xmda005 <> '8' "
            END IF
            CALL q_xmdddocno_3()                   #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdh001  #顯示到畫面上
            NEXT FIELD xmdh001                     #返回原欄位]]>
  </point>
  <point name="construct.c.page1.xmdh002" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.c.page1.xmdh003" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.c.page1.xmdh004" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.c.page1.xmdh005" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.c.page1.xmdh006" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
	   		LET g_qryparam.reqry = FALSE
            CALL q_imaf001_15()                    #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdh006  #顯示到畫面上
            NEXT FIELD xmdh006                     #返回原欄位]]>
  </point>
  <point name="construct.c.page1.xmdh007" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.c.page1.xmdh008" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
	   		LET g_qryparam.reqry = FALSE
            CALL q_imaf001_5()                     #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdh008  #顯示到畫面上
            NEXT FIELD xmdh008                     #返回原欄位]]>
  </point>
  <point name="construct.c.page1.xmdh009" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
	   		LET g_qryparam.reqry = FALSE
            LET g_qryparam.arg1 = "221" 
            CALL q_oocq002()                       #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdh009  #顯示到畫面上
            NEXT FIELD xmdh009                     #返回原欄位]]>
  </point>
  <point name="construct.c.page1.xmdh010" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.c.page1.xmdh011" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.c.page1.xmdh012" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
	   		LET g_qryparam.reqry = FALSE
            CALL q_inag004_1()                     #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdh012  #顯示到畫面上
            NEXT FIELD xmdh012                     #返回原欄位]]>
  </point>
  <point name="construct.c.page1.xmdh013" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
	   		LET g_qryparam.reqry = FALSE
            CALL q_inag005_5()                     #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdh013  #顯示到畫面上
            NEXT FIELD xmdh013                     #返回原欄位]]>
  </point>
  <point name="construct.c.page1.xmdh014" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.c.page1.xmdh015" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
	   		LET g_qryparam.reqry = FALSE
            CALL q_ooca001_1()                     #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdh015  #顯示到畫面上
            NEXT FIELD xmdh015                     #返回原欄位]]>
  </point>
  <point name="construct.c.page1.xmdh016" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.c.page1.xmdh017" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.c.page1.xmdh018" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
	   		LET g_qryparam.reqry = FALSE
            CALL q_ooca001_1()                     #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdh018  #顯示到畫面上
            NEXT FIELD xmdh018                     #返回原欄位]]>
  </point>
  <point name="construct.c.page1.xmdh019" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.c.page1.xmdh020" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
	   		LET g_qryparam.reqry = FALSE
            CALL q_ooca001_1()                     #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdh020  #顯示到畫面上
            NEXT FIELD xmdh020                     #返回原欄位]]>
  </point>
  <point name="construct.c.page1.xmdh021" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.c.page1.xmdh022" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.c.page1.xmdh029" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="construct.c.page1.xmdh030" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.c.page1.xmdh031" order="" ver="20" cite_std="N" new="N" status="u" src="s" readonly="" mark_hard="N">
    <![CDATA[            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c' 
            LET g_qryparam.reqry = FALSE
            CALL q_pjba001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdh031  #顯示到畫面上
            NEXT FIELD xmdh031                     #返回原欄位
    ]]>
  </point>
  <point name="construct.c.page1.xmdh032" order="" ver="20" cite_std="N" new="N" status="u" src="s" readonly="" mark_hard="N">
    <![CDATA[            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c' 
            LET g_qryparam.reqry = FALSE
            CALL q_pjbb002_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdh032  #顯示到畫面上
            NEXT FIELD xmdh032                     #返回原欄位
                           ]]>
  </point>
  <point name="construct.c.page1.xmdh033" order="" ver="20" cite_std="N" new="N" status="u" src="s" readonly="" mark_hard="N">
    <![CDATA[            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c' 
            LET g_qryparam.reqry = FALSE
            CALL q_pjbm002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdh033  #顯示到畫面上
            NEXT FIELD xmdh033                     #返回原欄位
                                                       ]]>
  </point>
  <point name="construct.c.page1.xmdh034" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
	   		LET g_qryparam.reqry = FALSE
            CALL q_pmao004_1()                     #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdh034  #顯示到畫面上
            NEXT FIELD xmdh034                     #返回原欄位]]>
  </point>
  <point name="construct.c.page1.xmdh036" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.c.page1.xmdh050" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.c.page1.xmdh051" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_icaa001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdh051  #顯示到畫面上
            NEXT FIELD xmdh051                     #返回原欄位]]>
  </point>
  <point name="construct.c.page1.xmdh052" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_icab002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdh052  #顯示到畫面上
            NEXT FIELD xmdh052                     #返回原欄位]]>
  </point>
  <point name="construct.c.page1.xmdhseq" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        ]]>
  </point>
  <point name="construct.c.page1.xmdhsite" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="construct.c.page1.xmdhunit" order="" ver="0" cite_std="" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_ooed004()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdhunit  #顯示到畫面上
            NEXT FIELD xmdhunit                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page2.xmdi001" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
	   		LET g_qryparam.reqry = FALSE
            CALL q_imaf001_15()                    #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdi001  #顯示到畫面上
            NEXT FIELD xmdi001                     #返回原欄位]]>
  </point>
  <point name="construct.c.page2.xmdi002" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.c.page2.xmdi003" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
	   		LET g_qryparam.reqry = FALSE
            LET g_qryparam.arg1 = "221" 
            CALL q_oocq002()                       #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdi003  #顯示到畫面上
            NEXT FIELD xmdi003                     #返回原欄位]]>
  </point>
  <point name="construct.c.page2.xmdi004" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.c.page2.xmdi005" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
	   		LET g_qryparam.reqry = FALSE
            CALL q_inag004_1()                     #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdi005  #顯示到畫面上
            NEXT FIELD xmdi005                     #返回原欄位]]>
  </point>
  <point name="construct.c.page2.xmdi006" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
	   		LET g_qryparam.reqry = FALSE
            CALL q_inag005_1()                     #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdi006  #顯示到畫面上
            NEXT FIELD xmdi006                     #返回原欄位]]>
  </point>
  <point name="construct.c.page2.xmdi007" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.c.page2.xmdi008" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
	   		LET g_qryparam.reqry = FALSE
            CALL q_ooca001_1()                     #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdi008  #顯示到畫面上
            NEXT FIELD xmdi008                     #返回原欄位]]>
  </point>
  <point name="construct.c.page2.xmdi009" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.c.page2.xmdi010" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
	   		LET g_qryparam.reqry = FALSE
            CALL q_ooca001_1()                     #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdi010  #顯示到畫面上
            NEXT FIELD xmdi010                     #返回原欄位]]>
  </point>
  <point name="construct.c.page2.xmdi011" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.c.page2.xmdi012" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.c.page2.xmdi013" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[ ]]>
  </point>
  <point name="construct.c.page2.xmdiseq" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.c.page2.xmdiseq1" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.c.page2.xmdisite" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[ ]]>
  </point>
  <point name="construct.c.page4.xmdh0011" order="" ver="1" cite_std="" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_xmdadocno_2()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdh0011  #顯示到畫面上

            NEXT FIELD xmdh0011                     #返回原欄位

]]>
  </point>
  <point name="construct.c.page4.xmdh001_1" order="" ver="1" cite_std="" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_xmdadocno_2()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdh001_1  #顯示到畫面上

            NEXT FIELD xmdh001_1                     #返回原欄位

]]>
  </point>
  <point name="construct.c.page4.xmdh0061" order="" ver="1" cite_std="" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_imaa001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdh0061  #顯示到畫面上

            NEXT FIELD xmdh0061                     #返回原欄位

]]>
  </point>
  <point name="construct.c.page4.xmdh006_1" order="" ver="1" cite_std="" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_imaa001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdh006_1  #顯示到畫面上

            NEXT FIELD xmdh006_1                     #返回原欄位

]]>
  </point>
  <point name="construct.c.page4.xmdh0091" order="" ver="1" cite_std="" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_oocq002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdh0091  #顯示到畫面上

            NEXT FIELD xmdh0091                     #返回原欄位

]]>
  </point>
  <point name="construct.c.page4.xmdh009_1" order="" ver="1" cite_std="" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_oocq002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdh009_1  #顯示到畫面上

            NEXT FIELD xmdh009_1                     #返回原欄位

]]>
  </point>
  <point name="construct.c.page4.xmdh0151" order="" ver="1" cite_std="" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooca001_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdh0151  #顯示到畫面上

            NEXT FIELD xmdh0151                     #返回原欄位

]]>
  </point>
  <point name="construct.c.page4.xmdh015_1" order="" ver="1" cite_std="" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooca001_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdh015_1  #顯示到畫面上

            NEXT FIELD xmdh015_1                     #返回原欄位

]]>
  </point>
  <point name="construct.c.page4.xmdh0201" order="" ver="1" cite_std="" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooca001_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdh0201  #顯示到畫面上

            NEXT FIELD xmdh0201                     #返回原欄位

]]>
  </point>
  <point name="construct.c.page4.xmdh020_1" order="" ver="1" cite_std="" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooca001_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdh020_1  #顯示到畫面上

            NEXT FIELD xmdh020_1                     #返回原欄位

]]>
  </point>
  <point name="construct.c.page4.xmdh023" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.c.page4.xmdh024" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
	   		LET g_qryparam.reqry = FALSE
            CALL q_oodb002_11()                    #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdh024  #顯示到畫面上
            NEXT FIELD xmdh024                     #返回原欄位]]>
  </point>
  <point name="construct.c.page4.xmdh025" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.c.page4.xmdh026" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.c.page4.xmdh027" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.c.page4.xmdh028" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.c.xmdg001" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.c.xmdg002" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
	   		LET g_qryparam.reqry = FALSE
            CALL q_ooag001()                       #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdg002  #顯示到畫面上
            NEXT FIELD xmdg002                     #返回原欄位]]>
  </point>
  <point name="construct.c.xmdg003" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
	   		LET g_qryparam.reqry = FALSE
            CALL q_ooeg001()                       #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdg003  #顯示到畫面上
            NEXT FIELD xmdg003                     #返回原欄位]]>
  </point>
  <point name="construct.c.xmdg004" order="" ver="13" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
	   		LET g_qryparam.reqry = FALSE
            IF g_argv[01] = '8' THEN
   	   		LET g_qryparam.where = " xmda005 = '8' "
   	   	ELSE
   	   		LET g_qryparam.where = " xmda005 <> '8' "
            END IF
            CALL q_xmdadocno_2()                   #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdg004  #顯示到畫面上
            NEXT FIELD xmdg004                     #返回原欄位]]>
  </point>
  <point name="construct.c.xmdg005" order="" ver="11" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
	   		LET g_qryparam.reqry = FALSE
	   		LET g_qryparam.arg1 = g_site
            CALL q_pmaa001_6()                     #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdg005  #顯示到畫面上
            NEXT FIELD xmdg005                     #返回原欄位]]>
  </point>
  <point name="construct.c.xmdg006" order="" ver="11" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
	   		LET g_qryparam.reqry = FALSE
	   		LET g_qryparam.arg2 = g_site
            CALL q_pmac002_5()                     #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdg006  #顯示到畫面上
            NEXT FIELD xmdg006                     #返回原欄位]]>
  </point>
  <point name="construct.c.xmdg007" order="" ver="11" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
	   		LET g_qryparam.reqry = FALSE
	   		LET g_qryparam.arg2 = g_site
            CALL q_pmac002_6()                     #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdg007  #顯示到畫面上
            NEXT FIELD xmdg007                     #返回原欄位]]>
  </point>
  <point name="construct.c.xmdg008" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
	   		LET g_qryparam.reqry = FALSE
            CALL q_pmad002_3()                     #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdg008  #顯示到畫面上
            NEXT FIELD xmdg008                     #返回原欄位]]>
  </point>
  <point name="construct.c.xmdg009" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
	   		LET g_qryparam.reqry = FALSE
            LET g_qryparam.arg1 = '238'
            CALL q_oocq002()                       #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdg009  #顯示到畫面上
            NEXT FIELD xmdg009                     #返回原欄位]]>
  </point>
  <point name="construct.c.xmdg010" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
	   		LET g_qryparam.reqry = FALSE
            CALL q_oodb002_11()                    #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdg010  #顯示到畫面上
            NEXT FIELD xmdg010                     #返回原欄位]]>
  </point>
  <point name="construct.c.xmdg011" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.c.xmdg012" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.c.xmdg013" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
	   		LET g_qryparam.reqry = FALSE
            LET g_qryparam.arg1 = g_ooef019        #稅區編號
            LET g_qryparam.arg2 = "2"              #銷項
            CALL q_isac002_1()                     #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdg013  #顯示到畫面上
            NEXT FIELD xmdg013                     #返回原欄位]]>
  </point>
  <point name="construct.c.xmdg014" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
	   		LET g_qryparam.reqry = FALSE
            LET g_qryparam.arg1 = g_site
            CALL q_ooaj002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdg014  #顯示到畫面上
            NEXT FIELD xmdg014                     #返回原欄位]]>
  </point>
  <point name="construct.c.xmdg015" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.c.xmdg016" order="" ver="11" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
	   		LET g_qryparam.reqry = FALSE
            CALL q_pmaa001_3()                     #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdg016  #顯示到畫面上
            NEXT FIELD xmdg016                     #返回原欄位]]>
  </point>
  <point name="construct.c.xmdg017" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
	   		LET g_qryparam.reqry = FALSE
            CALL q_oofb019_1()                     #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdg017  #顯示到畫面上
            NEXT FIELD xmdg017                     #返回原欄位]]>
  </point>
  <point name="construct.c.xmdg018" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
	   		LET g_qryparam.reqry = FALSE
            LET g_qryparam.arg1 = "263"
            CALL q_oocq002()                       #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdg018  #顯示到畫面上
            NEXT FIELD xmdg018                     #返回原欄位]]>
  </point>
  <point name="construct.c.xmdg019" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
	   		LET g_qryparam.reqry = FALSE
            CALL q_xmdg019()                       #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdg019  #顯示到畫面上
            NEXT FIELD xmdg019                     #返回原欄位]]>
  </point>
  <point name="construct.c.xmdg020" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
	   		LET g_qryparam.reqry = FALSE
            CALL q_xmdg020()                       #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdg020  #顯示到畫面上
            NEXT FIELD xmdg020                     #返回原欄位]]>
  </point>
  <point name="construct.c.xmdg021" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.c.xmdg022" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.c.xmdg023" order="" ver="17" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_xmao002()                       #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdg023  #顯示到畫面上
            NEXT FIELD xmdg023                     #返回原欄位]]>
  </point>
  <point name="construct.c.xmdg024" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.c.xmdg025" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.c.xmdg026" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
	   		LET g_qryparam.reqry = FALSE
            LET g_qryparam.arg1 = "275" 
            CALL q_oocq002()                       #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdg026  #顯示到畫面上
            NEXT FIELD xmdg026                     #返回原欄位]]>
  </point>
  <point name="construct.c.xmdg027" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
	   		LET g_qryparam.reqry = FALSE
            LET g_qryparam.arg1 = "295" 
            CALL q_oocq002()                       #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdg027  #顯示到畫面上
            NEXT FIELD xmdg027                     #返回原欄位]]>
  </point>
  <point name="construct.c.xmdg028" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.c.xmdg030" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
	   		LET g_qryparam.reqry = FALSE
            LET g_qryparam.arg1 = "209" 
            CALL q_oocq002()                       #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdg030  #顯示到畫面上
            NEXT FIELD xmdg030                     #返回原欄位]]>
  </point>
  <point name="construct.c.xmdg031" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
	   		LET g_qryparam.reqry = FALSE
	   		LET g_qryparam.arg1 = "297"
            CALL q_oocq002()                       #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdg031  #顯示到畫面上
            NEXT FIELD xmdg031                     #返回原欄位]]>
  </point>
  <point name="construct.c.xmdg032" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="construct.c.xmdg033" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="construct.c.xmdg053" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.c.xmdg054" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="construct.c.xmdg055" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_xmdg055()                       #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdg055  #顯示到畫面上
            NEXT FIELD xmdg055                     #返回原欄位]]>
  </point>
  <point name="construct.c.xmdg056" order="" ver="13" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c' 
            LET g_qryparam.reqry = FALSE
            CALL q_icaa001_8()                     #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdg056  #顯示到畫面上
            NEXT FIELD xmdg056                     #返回原欄位]]>
  </point>
  <point name="construct.c.xmdg202" order="" ver="11" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
	   		LET g_qryparam.arg2 = g_site
            CALL q_pmac002_6()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdg202  #顯示到畫面上
            NEXT FIELD xmdg202                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.xmdgcnfid" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
	   		LET g_qryparam.reqry = FALSE
            CALL q_ooag001()                         #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdgcnfid  #顯示到畫面上
            NEXT FIELD xmdgcnfid                     #返回原欄位]]>
  </point>
  <point name="construct.c.xmdgcrtdp" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
	   		LET g_qryparam.reqry = FALSE
            CALL q_ooeg001_9()                       #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdgcrtdp  #顯示到畫面上
            NEXT FIELD xmdgcrtdp                     #返回原欄位]]>
  </point>
  <point name="construct.c.xmdgcrtid" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
	   		LET g_qryparam.reqry = FALSE
            CALL q_ooag001()                         #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdgcrtid  #顯示到畫面上
            NEXT FIELD xmdgcrtid                     #返回原欄位]]>
  </point>
  <point name="construct.c.xmdgdocdt" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="construct.c.xmdgdocno" order="" ver="13" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
	   		LET g_qryparam.reqry = FALSE
            IF g_argv[01] = '8' THEN
   	   		LET g_qryparam.where = " xmdg001 = '8' "
   	   	ELSE
   	   		LET g_qryparam.where = " xmdg001 <> '8' "
            END IF
            CALL q_xmdgdocno()                       #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdgdocno  #顯示到畫面上
            NEXT FIELD xmdgdocno                     #返回原欄位]]>
  </point>
  <point name="construct.c.xmdgmodid" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
	   		LET g_qryparam.reqry = FALSE
            CALL q_ooag001()                         #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdgmodid  #顯示到畫面上
            NEXT FIELD xmdgmodid                     #返回原欄位]]>
  </point>
  <point name="construct.c.xmdgowndp" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
	   		LET g_qryparam.reqry = FALSE
            CALL q_ooeg001_9()                       #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdgowndp  #顯示到畫面上
            NEXT FIELD xmdgowndp                     #返回原欄位]]>
  </point>
  <point name="construct.c.xmdgownid" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
	   		LET g_qryparam.reqry = FALSE
            CALL q_ooag001()                         #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdgownid  #顯示到畫面上
            NEXT FIELD xmdgownid                     #返回原欄位]]>
  </point>
  <point name="construct.c.xmdgpstid" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                                    #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooag001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmdgpstid  #顯示到畫面上

            NEXT FIELD xmdgpstid                     #返回原欄位

]]>
  </point>
  <point name="construct.c.xmdgsite" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="construct.c.xmdgstus" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="cs.add_cs" order="" ver="13" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[      #150120新增"客戶訂單號碼"  earl(s)
      CONSTRUCT l_form_wc ON xmda033 FROM s_detail1[1].xmda033
                      
         BEFORE CONSTRUCT
      
         ON ACTION controlp INFIELD xmda033
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
	   		LET g_qryparam.reqry = FALSE
            CALL q_xmda033()                       #呼叫開窗
            DISPLAY g_qryparam.return1 TO xmda033  #顯示到畫面上
            NEXT FIELD xmda033
         
         
      END CONSTRUCT
      #150120新增"客戶訂單號碼"  earl(e)]]>
  </point>
  <point name="cs.after_construct" order="" ver="16" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   #150120新增"客戶訂單號碼"  earl(s)
   IF l_form_wc <> " 1=1" THEN
      LET g_wc2 = g_wc2," AND ",l_form_wc
      LET g_wc2_table1 = g_wc2_table1," AND xmdh001 IN (SELECT xmdadocno",
                                      "                   FROM xmda_t",
                                      "                  WHERE xmdaent = ",g_enterprise,
                                      "                    AND ",l_form_wc,")"
   END IF
   #150120新增"客戶訂單號碼"  earl(e)
   IF g_argv[01] = '8' THEN
      LET g_wc = g_wc , " AND xmdg001 = '", g_argv[01], "' "
   ELSE
      LET g_wc = g_wc , " AND xmdg001 <> '8' "
   END IF

]]>
  </point>
  <point name="cs.b_dialog" order="" ver="12" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[         LET g_xmdh_d[1].xmdhseq = ""
         DISPLAY ARRAY g_xmdh_d TO s_detail1.*
            BEFORE DISPLAY
               EXIT DISPLAY
         END DISPLAY
         LET g_xmdh2_d[1].xmdiseq = ""
         DISPLAY ARRAY g_xmdh2_d TO s_detail2.*
            BEFORE DISPLAY
               EXIT DISPLAY
         END DISPLAY         
         LET g_xmdh4_d[1].xmdhseq = ""
         DISPLAY ARRAY g_xmdh4_d TO s_detail4.*
            BEFORE DISPLAY
               EXIT DISPLAY
         END DISPLAY         ]]>
  </point>
  <point name="cs.before_construct" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[     ]]>
  </point>
  <point name="cs.body.before_construct" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="cs.body2.before_construct" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="cs.define" order="" ver="13" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   DEFINE l_form_wc   STRING    #150120新增"客戶訂單號碼"  earl]]>
  </point>
  <point name="cs.head.before_construct" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="default_search.after" order="" ver="16" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   IF g_argv[01] = '8' THEN
      LET g_wc = g_wc , " AND xmdg001 = '", g_argv[01], "' "
   ELSE
      LET g_wc = g_wc , " AND xmdg001 <> '8' "
   END IF]]>
  </point>
  <point name="default_search.after_sql" order="" ver="13" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="default_search.before" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[     ]]>
  </point>
  <point name="default_search.define" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[     ]]>
  </point>
  <point name="delete.before_ask" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="delete.befroe.related_document_remove" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="delete.body.a_delete" order="" ver="13" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
      DELETE FROM xrcd_t
       WHERE xrcddocno = g_xmdg_m.xmdgdocno
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = "xrcd_t" 
         LET g_errparam.code   = SQLCA.sqlcode 
         LET g_errparam.popup  = FALSE
         CALL cl_err()
         CALL s_transaction_end('N','0')
         RETURN
      END IF    
           ]]>
  </point>
  <point name="delete.body.a_delete2" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[           ]]>
  </point>
  <point name="delete.body.b_delete" order="" ver="13" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
      #依據出貨明細的的實際出貨數量更新對應的訂的交期名細中的已轉出貨量(xmdd031)
      IF NOT s_axmt520_upd_xmdd031(g_xmdg_m.xmdgdocno,'') THEN
         CALL s_transaction_end('N','0')
         RETURN
      END IF
]]>
  </point>
  <point name="delete.body.b_delete2" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[           ]]>
  </point>
  <point name="delete.body.m_delete" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[           ]]>
  </point>
  <point name="delete.body.m_delete2" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[           ]]>
  </point>
  <point name="delete.define" order="" ver="13" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   ]]>
  </point>
  <point name="delete.head.a_delete" order="" ver="13" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[      IF NOT s_aooi200_del_docno(g_xmdg_m.xmdgdocno,g_xmdg_m.xmdgdocdt) THEN
         CALL s_transaction_end('N','0')
         RETURN
      END IF
      IF NOT s_aooi360_del('6',g_prog,g_xmdg_m.xmdgdocno,'','','','','','','','','4') THEN
         CALL s_transaction_end('N','0')
         RETURN
      END IF]]>
  </point>
  <point name="delete.head.b_delete" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[           ]]>
  </point>
  <point name="delete.head.m_delete" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[           ]]>
  </point>
  <point name="delete.lang.before_delete" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="delete.lang.delete" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="delete_b.a_delete" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[           ]]>
  </point>
  <point name="delete_b.a_delete2" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[           ]]>
  </point>
  <point name="delete_b.b_delete" order="" ver="13" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[      ]]>
  </point>
  <point name="delete_b.b_delete2" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[           ]]>
  </point>
  <point name="delete_b.define" order="" ver="13" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   DEFINE l_success   LIKE type_t.num5
     ]]>
  </point>
  <point name="delete_b.m_delete" order="" ver="13" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = "" 
         LET g_errparam.code   = SQLCA.sqlcode 
         LET g_errparam.popup  = FALSE 
         CALL cl_err()
      END IF
      
      CALL axmt540_01_xmdm_delete('2',ps_keys_bak[1],ps_keys_bak[2],'N') RETURNING l_success
      
      DELETE FROM xrcd_t
       WHERE xrcddocno = ps_keys_bak[1] AND xrcdseq = ps_keys_bak[2]
]]>
  </point>
  <point name="delete_b.m_delete2" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[           ]]>
  </point>
  <point name="delete_b.other" order="" ver="13" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="detail_reproduce.body.table1.a_insert" order="" ver="16" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#150522---earl---mod---s
   LET g_sql = "SELECT xmdhdocno,xmdhseq,xmdh001,xmdh016,xmdh022",
               "  FROM xmdh_t",
               " WHERE xmdhent = ",g_enterprise,
               "   AND xmdhdocno = '",g_xmdg_m.xmdgdocno,"'"
   PREPARE axmt520_rep_xmdh_pre FROM g_sql
   DECLARE axmt520_rep_xmdh_cs CURSOR FOR axmt520_rep_xmdh_pre

   LET l_success = TRUE
   LET l_xmdhdocno = ''
   LET l_xmdhseq = ''
   LET l_xmdh001 = ''
   LET l_xmdh016 = ''
   LET l_xmdh022 = ''
   
   FOREACH axmt520_rep_xmdh_cs INTO l_xmdhdocno,l_xmdhseq,l_xmdh001,l_xmdh016,l_xmdh022
      IF SQLCA.sqlcode THEN
        INITIALIZE g_errparam TO NULL 
        LET g_errparam.extend = "FOREACH axmt520_rep_xmdh_cs" 
        LET g_errparam.code   = SQLCA.sqlcode 
        LET g_errparam.popup  = TRUE 
        CALL cl_err()
        
        LET l_success = FALSE
        EXIT FOREACH
      END IF

      #預設檢驗合格量
      IF l_xmdh022 = 'Y' AND NOT cl_null(l_xmdh001) THEN
         #單據別參數
         CALL s_aooi200_get_slip(l_xmdh001) RETURNING l_success,l_slip
         
         IF NOT l_success THEN
            EXIT FOREACH
         END IF

         IF cl_get_doc_para(g_enterprise,g_site,l_slip,'D-BAS-0094') = '1' THEN   #OQC檢驗時機為"1出貨通知時檢驗"
            LET l_xmdh056 = 0
         ELSE
            LET l_xmdh056 = l_xmdh016
         END IF
      ELSE
         LET l_xmdh056 =  l_xmdh016
      END IF

      UPDATE xmdh_t
         SET xmdh030 = '0',        #已轉出貨數量
             xmdh056 = l_xmdh056   #檢驗合格量
       WHERE xmdhent = g_enterprise
         AND xmdhdocno = l_xmdhdocno
         AND xmdhseq = l_xmdhseq
         
      IF SQLCA.sqlcode THEN
        INITIALIZE g_errparam TO NULL 
        LET g_errparam.extend = "UPDATE xmdh_t" 
        LET g_errparam.code   = SQLCA.sqlcode 
        LET g_errparam.popup  = TRUE 
        CALL cl_err()
        
        LET l_success = FALSE
        EXIT FOREACH
      END IF
         
   END FOREACH
   
   IF NOT l_success THEN
      RETURN
   END IF
#150522---earl---mod---e]]>
  </point>
  <point name="detail_reproduce.body.table1.b_insert" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[     ]]>
  </point>
  <point name="detail_reproduce.body.table1.b_update" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="detail_reproduce.body.table1.m_insert" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[     ]]>
  </point>
  <point name="detail_reproduce.body.table2.a_insert" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[     ]]>
  </point>
  <point name="detail_reproduce.body.table2.b_insert" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[     ]]>
  </point>
  <point name="detail_reproduce.body.table2.m_insert" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   UPDATE xmdi_t SET xmdi012 = '0'  #已轉出貨量
    WHERE xmdient = g_enterprise
      AND xmdidocno = g_xmdg_m.xmdgdocno
      ]]>
  </point>
  <point name="detail_reproduce.define" order="" ver="16" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   #150522---earl---add---s
   DEFINE l_success      LIKE type_t.num5
   DEFINE l_xmdhdocno    LIKE xmdh_t.xmdhdocno
   DEFINE l_xmdhseq      LIKE xmdh_t.xmdhseq
   DEFINE l_xmdh001      LIKE xmdh_t.xmdh001
   DEFINE l_xmdh016      LIKE xmdh_t.xmdh016
   DEFINE l_xmdh022      LIKE xmdh_t.xmdh022
   DEFINE l_xmdh056      LIKE xmdh_t.xmdh056
   DEFINE l_slip         LIKE ooba_t.ooba002
   #150522---earl---add---e]]>
  </point>
  <point name="detail_show.after" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[     ]]>
  </point>
  <point name="detail_show.before" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[     ]]>
  </point>
  <point name="detail_show.define" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[     ]]>
  </point>
  <point name="draw.define" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="fetch.action_control" order="" ver="8" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[  ]]>
  </point>
  <point name="fetch.after" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="fetch.define" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[     ]]>
  </point>
  <point name="fill_chk.after_chk" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="fill_chk.before_chk" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="fill_chk.define" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[     ]]>
  </point>
  <point name="fill_chk.other_chk" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[           ]]>
  </point>
  <point name="filter.add_cs" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[           ]]>
  </point>
  <point name="filter.b_dialog" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                ]]>
  </point>
  <point name="filter.cs_ctrl" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="filter.define" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[     ]]>
  </point>
  <point name="filter_parser.define" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[     ]]>
  </point>
  <point name="global.argv" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
]]>
  </point>
  <point name="global.import" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="global.inc" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="global.memo" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="global.variable" order="" ver="15" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[DEFINE g_inam                DYNAMIC ARRAY OF RECORD   #記錄產品特徵
         inam001             LIKE inam_t.inam001,
         inam002             LIKE inam_t.inam002,
         inam004             LIKE inam_t.inam004
                             END RECORD
DEFINE g_ooef004             LIKE ooef_t.ooef004  #參照表號
DEFINE g_ooef016             LIKE ooef_t.ooef016  #主幣別編號 
DEFINE g_ooef019             LIKE ooef_t.ooef019  #所屬稅區
DEFINE g_flag                LIKE type_t.chr1     #預估費用]]>
  </point>
  <point name="idx_chk.define" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[     ]]>
  </point>
  <point name="idx_chk.other" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[     ]]>
  </point>
  <point name="init.define" order="" ver="13" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   DEFINE l_success  LIKE type_t.num5
   DEFINE l_gzze003  LIKE gzze_t.gzze003]]>
  </point>
  <point name="init.init" order="" ver="13" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   CALL cl_set_combo_scc_part('xmdgstus','13','N,X,Y,A,D,R,W,H')
   CALL cl_set_combo_scc('xmdh0051','2055')
   CALL axmt540_01_create_temp_table() RETURNING l_success
   CALL s_tax_recount_tmp()

   #判斷據點參數若不使用參考單位時，則參考單位、數量需隱藏不可以維護(據點參數:S-BAS-0028)
   IF cl_get_para(g_enterprise,g_site,'S-BAS-0028') = 'N' THEN
      CALL cl_set_comp_visible("xmdh018,xmdh018_desc,xmdh019,xmdi010,xmdi010_desc,xmdi011",FALSE)
   END IF

   #判斷據點參數若不使用產品特徵時，則產品特徵需隱藏不可以維護(據點參數:S-BAS-0036)
   IF cl_get_para(g_enterprise,g_site,'S-BAS-0036') = 'N' THEN
      CALL cl_set_comp_visible("xmdh007,xmdh0071,xmdh007_desc,xmdh0071_desc,xmdi002,xmdi002_desc",FALSE)
   END IF

   #整體參數未使用採購計價單位
   IF cl_get_para(g_enterprise,g_site,'S-BAS-0007') = "N" THEN
      CALL cl_set_comp_visible("xmdh020,xmdh020_desc,xmdh021,xmdh0201,xmdh0201_desc,xmdh0211",FALSE)
   END IF

   IF g_argv[01] = '8' THEN
      #借貨訂單單號
      CALL cl_getmsg('axm-00534',g_dlang) RETURNING l_gzze003
      CALL cl_set_comp_att_text('xmdg004',l_gzze003)
      CALL cl_set_comp_att_text('xmdh001',l_gzze003)
   END IF

   LET g_ooef004 = ''
   LET g_ooef016 = ''
   LET g_ooef019 = ''
   SELECT ooef004,ooef016,ooef019
     INTO g_ooef004,g_ooef016,g_ooef019
     FROM ooef_t
    WHERE ooefent = g_enterprise
      AND ooef001 = g_site
]]>
  </point>
  <point name="input.a.page1.xmdh001" order="" ver="13" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xmdh_d[l_ac].xmdh001) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_xmdh_d[l_ac].xmdh001 != g_xmdh_d_o.xmdh001 OR g_xmdh_d_o.xmdh001 IS NULL )) THEN
                  IF NOT axmt520_xmdadocno_chk(g_xmdh_d[l_ac].xmdh001) THEN
                     LET g_xmdh_d[l_ac].xmdh001 = g_xmdh_d_o.xmdh001
                     NEXT FIELD CURRENT
                  END IF
                  CALL axmt520_xmdh001_chk()
                  IF NOT cl_null(g_errno) THEN
                     INITIALIZE g_errparam TO NULL
                     LET g_errparam.code = g_errno
                     LET g_errparam.extend = g_xmdh_d[l_ac].xmdh001
                     LET g_errparam.popup = TRUE
                     CALL cl_err()
                     LET g_xmdh_d[l_ac].xmdh001 = g_xmdh_d_o.xmdh001
                     NEXT FIELD CURRENT
                  END IF
                  IF g_xmdh_d[l_ac].xmdh011 = 'Y' THEN
                     CALL axmt520_xmdi_del()
                  END IF
               END IF
            END IF
            LET g_xmdh_d_o.xmdh001 = g_xmdh_d[l_ac].xmdh001
            LET g_xmdh_d_o.xmdh002 = g_xmdh_d[l_ac].xmdh002
            LET g_xmdh_d_o.xmdh003 = g_xmdh_d[l_ac].xmdh003
            LET g_xmdh_d_o.xmdh004 = g_xmdh_d[l_ac].xmdh004
            CALL axmt520_set_entry_b(p_cmd)
            CALL axmt520_set_no_entry_b(p_cmd)  ]]>
  </point>
  <point name="input.a.page1.xmdh002" order="" ver="13" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF cl_null(g_xmdh_d[l_ac].xmdh002) THEN
               LET g_flag = 'Y'
               LET g_xmdh_d[l_ac].xmdh003 = ''
               LET g_xmdh_d[l_ac].xmdh004 = ''
            ELSE
               LET g_flag = 'N'
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_xmdh_d[l_ac].xmdh002 != g_xmdh_d_o.xmdh002 OR g_xmdh_d_o.xmdh002 IS NULL )) THEN
                  #訂單號+訂單項次必須存在xmdd_t中
                  LET l_cnt = 0
                  SELECT COUNT(*) INTO l_cnt
                    FROM xmdd_t
                   WHERE xmddent = g_enterprise
                     AND xmdddocno = g_xmdh_d[l_ac].xmdh001
                     AND xmddseq = g_xmdh_d[l_ac].xmdh002
                  IF cl_null(l_cnt) OR l_cnt = 0 THEN
                     INITIALIZE g_errparam TO NULL
                     LET g_errparam.code = 'axm-00158'
                     LET g_errparam.extend = g_xmdh_d[l_ac].xmdh002
                     LET g_errparam.popup = TRUE
                     CALL cl_err()
                     LET g_xmdh_d[l_ac].xmdh002 = g_xmdh_d_o.xmdh002
                     NEXT FIELD CURRENT
                  END IF
                  #若輸入的訂單號+訂單項次的xmdd_t只有對應一個分批序時，則自動將分批序預設到出通單身[C:分批序]上
                  IF l_cnt = 1 THEN
                     SELECT xmddseq1,xmddseq2
                       INTO g_xmdh_d[l_ac].xmdh003,g_xmdh_d[l_ac].xmdh004
                       FROM xmdd_t
                      WHERE xmddent = g_enterprise
                        AND xmdddocno = g_xmdh_d[l_ac].xmdh001
                        AND xmddseq = g_xmdh_d[l_ac].xmdh002
                     CALL axmt520_xmdh004_chk()
                     IF NOT cl_null(g_errno) THEN
                        INITIALIZE g_errparam TO NULL
                        LET g_errparam.code = g_errno
                        LET g_errparam.popup = TRUE
                        CALL cl_err()
                        LET g_xmdh_d[l_ac].xmdh002 = g_xmdh_d_o.xmdh002
                        LET g_xmdh_d[l_ac].xmdh003 = g_xmdh_d_o.xmdh003
                        LET g_xmdh_d[l_ac].xmdh004 = g_xmdh_d_o.xmdh004
                        NEXT FIELD CURRENT
                     ELSE
                        CALL axmt520_xmdh004_default()
                     END IF
                  ELSE
                     LET g_xmdh_d[l_ac].xmdh003 = ''
                     LET g_xmdh_d[l_ac].xmdh004 = ''
                     CALL axmt520_xmdh002_default()
                  END IF
                  IF g_xmdh_d[l_ac].xmdh011 = 'Y' THEN
                     CALL axmt520_xmdi_del()
                  END IF
               END IF
            END IF
            LET g_xmdh_d_o.xmdh002 = g_xmdh_d[l_ac].xmdh002
            LET g_xmdh_d_o.xmdh003 = g_xmdh_d[l_ac].xmdh003
            LET g_xmdh_d_o.xmdh004 = g_xmdh_d[l_ac].xmdh004
            CALL axmt520_set_entry_b(p_cmd)
            CALL axmt520_set_no_entry_b(p_cmd)  ]]>
  </point>
  <point name="input.a.page1.xmdh003" order="" ver="13" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xmdh_d[l_ac].xmdh003) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_xmdh_d[l_ac].xmdh003 != g_xmdh_d_o.xmdh003 OR g_xmdh_d_o.xmdh003 IS NULL )) THEN
                  #訂單號+訂單項次必須存在xmdd_t中
                  LET l_cnt = 0
                  SELECT COUNT(*) INTO l_cnt
                    FROM xmdd_t
                   WHERE xmddent = g_enterprise
                     AND xmdddocno = g_xmdh_d[l_ac].xmdh001
                     AND xmddseq = g_xmdh_d[l_ac].xmdh002
                     AND xmddseq1 = g_xmdh_d[l_ac].xmdh003
                  IF cl_null(l_cnt) OR l_cnt = 0 THEN
                     INITIALIZE g_errparam TO NULL
                     LET g_errparam.code = 'axm-00158'
                     LET g_errparam.extend = g_xmdh_d[l_ac].xmdh003
                     LET g_errparam.popup = TRUE
                     CALL cl_err()
                     LET g_xmdh_d[l_ac].xmdh003 = g_xmdh_d_o.xmdh003
                     NEXT FIELD CURRENT
                  END IF
                  #若輸入的訂單號+訂單項次的xmdd_t只有對應一個分批序時，則自動將分批序預設到出通單身[C:分批序]上
                  IF l_cnt = 1 THEN
                     SELECT xmddseq2 INTO g_xmdh_d[l_ac].xmdh004
                       FROM xmdd_t
                      WHERE xmddent = g_enterprise
                        AND xmdddocno = g_xmdh_d[l_ac].xmdh001
                        AND xmddseq = g_xmdh_d[l_ac].xmdh002
                        AND xmddseq1 = g_xmdh_d[l_ac].xmdh003
                     CALL axmt520_xmdh004_chk()
                     IF NOT cl_null(g_errno) THEN
                        INITIALIZE g_errparam TO NULL
                        LET g_errparam.code = g_errno
                        LET g_errparam.popup = TRUE
                        CALL cl_err()
                        LET g_xmdh_d[l_ac].xmdh003 = g_xmdh_d_o.xmdh003
                        LET g_xmdh_d[l_ac].xmdh004 = g_xmdh_d_o.xmdh004
                        NEXT FIELD CURRENT
                     ELSE
                        CALL axmt520_xmdh004_default()
                     END IF
                  ELSE
                     LET g_xmdh_d[l_ac].xmdh004 = ''
                  END IF
                  IF g_xmdh_d[l_ac].xmdh011 = 'Y' THEN
                     CALL axmt520_xmdi_del()
                  END IF
               END IF
            END IF
            LET g_xmdh_d_o.xmdh003 = g_xmdh_d[l_ac].xmdh003
            LET g_xmdh_d_o.xmdh004 = g_xmdh_d[l_ac].xmdh004
            CALL axmt520_set_entry_b(p_cmd)
            CALL axmt520_set_no_entry_b(p_cmd)  ]]>
  </point>
  <point name="input.a.page1.xmdh004" order="" ver="8" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xmdh_d[l_ac].xmdh004) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_xmdh_d[l_ac].xmdh004 != g_xmdh_d_o.xmdh004 OR g_xmdh_d_o.xmdh004 IS NULL )) THEN
                  CALL axmt520_xmdh004_chk()
                  IF NOT cl_null(g_errno) THEN
                     INITIALIZE g_errparam TO NULL
                     LET g_errparam.code = g_errno
                     LET g_errparam.extend = g_xmdh_d[l_ac].xmdh004
                     LET g_errparam.popup = TRUE
                     CALL cl_err()
                     LET g_xmdh_d[l_ac].xmdh004 = g_xmdh_d_o.xmdh004
                     NEXT FIELD CURRENT
                  END IF
                  CALL axmt520_xmdh004_default()
                  IF g_xmdh_d[l_ac].xmdh011 = 'Y' THEN
                     CALL axmt520_xmdi_del()
                  END IF
               END IF
            END IF
            LET g_xmdh_d_o.xmdh004 = g_xmdh_d[l_ac].xmdh004
            CALL axmt520_set_entry_b(p_cmd)
            CALL axmt520_set_no_entry_b(p_cmd)  
           ]]>
  </point>
  <point name="input.a.page1.xmdh005" order="" ver="8" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_xmdh_d_o.xmdh005 = g_xmdh_d[l_ac].xmdh005
                       ]]>
  </point>
  <point name="input.a.page1.xmdh006" order="" ver="12" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_xmdh_d[l_ac].xmdh006_desc = ''
            LET g_xmdh_d[l_ac].xmdh006_desc_desc = ''
            IF NOT cl_null(g_xmdh_d[l_ac].xmdh006) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_xmdh_d[l_ac].xmdh006 != g_xmdh_d_o.xmdh006 OR g_xmdh_d_o.xmdh006 IS NULL )) THEN
                  IF NOT axmt520_xmdh006_chk() THEN
                     LET g_xmdh_d[l_ac].xmdh006 = g_xmdh_d_o.xmdh006
                     CALL s_desc_get_item_desc(g_xmdh_d[l_ac].xmdh006) RETURNING g_xmdh_d[l_ac].xmdh006_desc,g_xmdh_d[l_ac].xmdh006_desc_desc
                     NEXT FIELD CURRENT
                  END IF
                  
                  #呼叫取交易對象料號的應用元件將對應的料號抓出顯示在客戶料號
                  IF NOT cl_null(g_xmdh_d[l_ac].xmdh007) THEN
                     CALL s_apmi070_get_pmao004(g_xmdg_m.xmdg005,g_xmdh_d[l_ac].xmdh006,g_xmdh_d[l_ac].xmdh007)
                          RETURNING l_success,g_xmdh_d[l_ac].xmdh034
                  END IF
                  
                  IF g_flag = 'Y' THEN
                     CALL axmt520_xmdh006_default()
                  ELSE
                     LET l_imaa005 = ''
                     CALL s_axmt500_get_imaa005(g_enterprise,g_xmdh_d[l_ac].xmdh006) RETURNING l_imaa005
                     IF cl_null(l_imaa005) THEN
                        CALL g_inam.clear()            
                        CALL s_feature(l_cmd,g_xmdh_d[l_ac].xmdh006,'','',g_site,g_xmdg_m.xmdgdocno) RETURNING l_success,g_inam
                        LET g_xmdh_d[l_ac].xmdh007 = g_inam[1].inam002
                        LET g_xmdh_d[l_ac].xmdh016 = g_inam[1].inam004
                     END IF
                  END IF
                  
                  IF g_xmdh_d[l_ac].xmdh011 = 'Y' THEN
                     CALL axmt520_xmdi_del()
                  END IF
               END IF
            END IF
            CALL s_desc_get_item_desc(g_xmdh_d[l_ac].xmdh006) RETURNING g_xmdh_d[l_ac].xmdh006_desc,g_xmdh_d[l_ac].xmdh006_desc_desc
            CALL s_feature_description(g_xmdh_d[l_ac].xmdh006,g_xmdh_d[l_ac].xmdh007) RETURNING l_success,g_xmdh_d[l_ac].xmdh007_desc
            LET g_xmdh_d_o.xmdh006 = g_xmdh_d[l_ac].xmdh006
            LET g_xmdh_d_o.xmdh007 = g_xmdh_d[l_ac].xmdh007
            LET g_xmdh_d_o.xmdh016 = g_xmdh_d[l_ac].xmdh016
            LET g_xmdh_d_o.xmdh034 = g_xmdh_d[l_ac].xmdh034
            CALL axmt520_set_entry_b(p_cmd)
            CALL axmt520_set_no_entry_b(p_cmd)]]>
  </point>
  <point name="input.a.page1.xmdh007" order="" ver="8" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_xmdh_d[l_ac].xmdh007_desc = ''
            IF cl_null(g_xmdh_d[l_ac].xmdh007) THEN
               LET g_xmdh_d[l_ac].xmdh007 = ' '
            ELSE
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_xmdh_d[l_ac].xmdh007 != g_xmdh_d_o.xmdh007 OR g_xmdh_d_o.xmdh007 IS NULL )) THEN
                  IF NOT s_feature_check(g_xmdh_d[l_ac].xmdh006,g_xmdh_d[l_ac].xmdh007) THEN
                     LET g_xmdh_d[l_ac].xmdh007 = g_xmdh_d_o.xmdh007
                     CALL s_feature_description(g_xmdh_d[l_ac].xmdh006,g_xmdh_d[l_ac].xmdh007) RETURNING l_success,g_xmdh_d[l_ac].xmdh007_desc
                     NEXT FIELD CURRENT
                  END IF
                  IF NOT axmt520_xmdh006_xmdh007_chk() THEN
                     LET g_xmdh_d[l_ac].xmdh007 = g_xmdh_d_o.xmdh007
                     CALL s_feature_description(g_xmdh_d[l_ac].xmdh006,g_xmdh_d[l_ac].xmdh007) RETURNING l_success,g_xmdh_d[l_ac].xmdh007_desc
                     NEXT FIELD CURRENT
                  END IF
                  CALL s_apmi070_get_pmao004(g_xmdg_m.xmdg005,g_xmdh_d[l_ac].xmdh006,g_xmdh_d[l_ac].xmdh007)
                       RETURNING l_success,g_xmdh_d[l_ac].xmdh034
                  IF g_xmdh_d[l_ac].xmdh011 = 'Y' THEN
                     CALL axmt520_xmdi_del()
                  END IF
               END IF
            END IF
            LET g_xmdh_d_o.xmdh007 = g_xmdh_d[l_ac].xmdh007
            LET g_xmdh_d_o.xmdh016 = g_xmdh_d[l_ac].xmdh016
            LET g_xmdh_d_o.xmdh034 = g_xmdh_d[l_ac].xmdh034
            CALL s_feature_description(g_xmdh_d[l_ac].xmdh006,g_xmdh_d[l_ac].xmdh007) RETURNING l_success,g_xmdh_d[l_ac].xmdh007_desc
            ]]>
  </point>
  <point name="input.a.page1.xmdh008" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xmdh_d[l_ac].xmdh008) THEN 
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_xmdh_d[l_ac].xmdh008 != g_xmdh_d_o.xmdh008 OR g_xmdh_d_o.xmdh008 IS NULL )) THEN
                  INITIALIZE g_chkparam.* TO NULL
                  LET g_chkparam.arg1 = g_xmdh_d[l_ac].xmdh008
                  IF NOT cl_chk_exist("v_imaf001_2") THEN
                     LET g_xmdh_d[l_ac].xmdh008 = g_xmdh_d_o.xmdh008
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF 
            LET g_xmdh_d_o.xmdh008 = g_xmdh_d[l_ac].xmdh008]]>
  </point>
  <point name="input.a.page1.xmdh009" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_xmdh_d[l_ac].xmdh009_desc = ''
            IF NOT cl_null(g_xmdh_d[l_ac].xmdh009) THEN 
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_xmdh_d[l_ac].xmdh009 != g_xmdh_d_o.xmdh009 OR g_xmdh_d_o.xmdh009 IS NULL )) THEN
                  INITIALIZE g_chkparam.* TO NULL
                  LET g_chkparam.arg1 = '221'
                  LET g_chkparam.arg2 = g_xmdh_d[l_ac].xmdh009
                  IF NOT cl_chk_exist("v_oocq002_1") THEN
                     LET g_xmdh_d[l_ac].xmdh009 = g_xmdh_d_o.xmdh009
                     CALL s_desc_get_acc_desc('221',g_xmdh_d[l_ac].xmdh009) RETURNING g_xmdh_d[l_ac].xmdh009_desc
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF 
            CALL s_desc_get_acc_desc('221',g_xmdh_d[l_ac].xmdh009) RETURNING g_xmdh_d[l_ac].xmdh009_desc
            LET g_xmdh_d_o.xmdh009 = g_xmdh_d[l_ac].xmdh009]]>
  </point>
  <point name="input.a.page1.xmdh010" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_xmdh_d_o.xmdh010 = g_xmdh_d[l_ac].xmdh010
                       ]]>
  </point>
  <point name="input.a.page1.xmdh011" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF g_xmdh_d[l_ac].xmdh011 = 'Y' THEN
               LET g_xmdh_d[l_ac].xmdh012 = ''
               LET g_xmdh_d[l_ac].xmdh013 = ''
               LET g_xmdh_d[l_ac].xmdh014 = ''
            ELSE               
               LET g_xmdh_d[l_ac].xmdh012 = g_xmdh_d_o.xmdh012
               LET g_xmdh_d[l_ac].xmdh013 = g_xmdh_d_o.xmdh013
               LET g_xmdh_d[l_ac].xmdh014 = g_xmdh_d_o.xmdh014
            END IF
            CALL s_desc_get_stock_desc(g_site,g_xmdh_d[l_ac].xmdh012) RETURNING g_xmdh_d[l_ac].xmdh012_desc
            CALL s_desc_get_locator_desc(g_site,g_xmdh_d[l_ac].xmdh012,g_xmdh_d[l_ac].xmdh013) RETURNING g_xmdh_d[l_ac].xmdh013_desc
            CALL axmt520_set_entry_b(l_cmd)
            CALL axmt520_set_no_entry_b(l_cmd)]]>
  </point>
  <point name="input.a.page1.xmdh012" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_xmdh_d[l_ac].xmdh012_desc = ''
            IF NOT cl_null(g_xmdh_d[l_ac].xmdh012) THEN 
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_xmdh_d[l_ac].xmdh012 != g_xmdh_d_o.xmdh012 OR g_xmdh_d_o.xmdh012 IS NULL )) THEN
                  INITIALIZE g_chkparam.* TO NULL
                  LET g_chkparam.arg1 = g_site
                  LET g_chkparam.arg2 = g_xmdh_d[l_ac].xmdh006
                  LET g_chkparam.arg3 = g_xmdh_d[l_ac].xmdh007
                  LET g_chkparam.arg4 = g_xmdh_d[l_ac].xmdh012
                  IF NOT cl_chk_exist("v_inag004_1") THEN               
                     LET g_xmdh_d[l_ac].xmdh012 = g_xmdh_d_o.xmdh012
                     CALL s_desc_get_stock_desc(g_site,g_xmdh_d[l_ac].xmdh012) RETURNING g_xmdh_d[l_ac].xmdh012_desc
                     NEXT FIELD CURRENT
                  END IF
                  IF NOT axmt520_inan_chk() THEN
                     LET g_xmdh_d[l_ac].xmdh012 = g_xmdh_d_o.xmdh012
                     CALL s_desc_get_stock_desc(g_site,g_xmdh_d[l_ac].xmdh012) RETURNING g_xmdh_d[l_ac].xmdh012_desc
                     NEXT FIELD CURRENT
                  END IF
                  IF g_xmdh_d[l_ac].xmdh011 = 'Y' THEN
                     CALL axmt520_xmdi_del()
                  END IF
               END IF
            END IF 
            CALL s_desc_get_stock_desc(g_site,g_xmdh_d[l_ac].xmdh012) RETURNING g_xmdh_d[l_ac].xmdh012_desc
            LET g_xmdh_d_o.xmdh012 = g_xmdh_d[l_ac].xmdh012
            LET g_xmdh_d_o.xmdh013 = g_xmdh_d[l_ac].xmdh013
            LET g_xmdh_d_o.xmdh014 = g_xmdh_d[l_ac].xmdh014
            CALL axmt520_set_entry_b(p_cmd)
            CALL axmt520_set_no_entry_b(p_cmd)]]>
  </point>
  <point name="input.a.page1.xmdh013" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_xmdh_d[l_ac].xmdh013_desc = ''
            IF NOT cl_null(g_xmdh_d[l_ac].xmdh013) THEN 
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_xmdh_d[l_ac].xmdh013 != g_xmdh_d_o.xmdh013 OR g_xmdh_d_o.xmdh013 IS NULL )) THEN
                  INITIALIZE g_chkparam.* TO NULL
                  LET g_chkparam.arg1 = g_site
                  LET g_chkparam.arg2 = g_xmdh_d[l_ac].xmdh006
                  LET g_chkparam.arg3 = g_xmdh_d[l_ac].xmdh007
                  LET g_chkparam.arg4 = g_xmdh_d[l_ac].xmdh012
                  LET g_chkparam.arg5 = g_xmdh_d[l_ac].xmdh013
                  IF NOT cl_chk_exist("v_inag005_1") THEN
                     LET g_xmdh_d[l_ac].xmdh013 = g_xmdh_d_o.xmdh013
                     CALL s_desc_get_locator_desc(g_site,g_xmdh_d[l_ac].xmdh012,g_xmdh_d[l_ac].xmdh013) RETURNING g_xmdh_d[l_ac].xmdh013_desc
                     NEXT FIELD CURRENT
                  END IF
                  IF NOT axmt520_inan_chk() THEN
                     LET g_xmdh_d[l_ac].xmdh013 = g_xmdh_d_o.xmdh013
                     CALL s_desc_get_locator_desc(g_site,g_xmdh_d[l_ac].xmdh012,g_xmdh_d[l_ac].xmdh013) RETURNING g_xmdh_d[l_ac].xmdh013_desc
                     NEXT FIELD CURRENT
                  END IF
                  IF g_xmdh_d[l_ac].xmdh011 = 'Y' THEN
                     CALL axmt520_xmdi_del()
                  END IF
               END IF
            END IF 
            CALL s_desc_get_locator_desc(g_site,g_xmdh_d[l_ac].xmdh012,g_xmdh_d[l_ac].xmdh013) RETURNING g_xmdh_d[l_ac].xmdh013_desc
            LET g_xmdh_d_o.xmdh013 = g_xmdh_d[l_ac].xmdh013]]>
  </point>
  <point name="input.a.page1.xmdh014" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xmdh_d[l_ac].xmdh014) THEN 
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_xmdh_d[l_ac].xmdh014 != g_xmdh_d_o.xmdh014 OR g_xmdh_d_o.xmdh014 IS NULL )) THEN
                  INITIALIZE g_chkparam.* TO NULL
                  LET g_chkparam.arg1 = g_site
                  LET g_chkparam.arg2 = g_xmdh_d[l_ac].xmdh006
                  LET g_chkparam.arg3 = g_xmdh_d[l_ac].xmdh007
                  LET g_chkparam.arg4 = g_xmdh_d[l_ac].xmdh012
                  LET g_chkparam.arg5 = g_xmdh_d[l_ac].xmdh013
                  LET g_chkparam.arg6 = g_xmdh_d[l_ac].xmdh014
                  IF not cl_chk_exist("v_inag006_1") THEN
                     LET g_xmdh_d[l_ac].xmdh014 = g_xmdh_d_o.xmdh014
                     NEXT FIELD CURRENT
                  END IF
                  IF NOT axmt520_inan_chk() THEN
                     LET g_xmdh_d[l_ac].xmdh014 = g_xmdh_d_o.xmdh014
                     NEXT FIELD CURRENT
                  END IF
                  IF g_xmdh_d[l_ac].xmdh011 = 'Y' THEN
                     CALL axmt520_xmdi_del()
                  END IF
               END IF
            END IF 
            LET g_xmdh_d_o.xmdh014 = g_xmdh_d[l_ac].xmdh014]]>
  </point>
  <point name="input.a.page1.xmdh015" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_xmdh_d[l_ac].xmdh015_desc = ''
            IF NOT cl_null(g_xmdh_d[l_ac].xmdh015) THEN 
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_xmdh_d[l_ac].xmdh015 != g_xmdh_d_o.xmdh015 OR g_xmdh_d_o.xmdh015 IS NULL )) THEN
                  INITIALIZE g_chkparam.* TO NULL
                  LET g_chkparam.arg1 = g_xmdh_d[l_ac].xmdh006
                  LET g_chkparam.arg2 = g_xmdh_d[l_ac].xmdh015
                  IF NOT cl_chk_exist("v_imao002") THEN
                     LET g_xmdh_d[l_ac].xmdh015 = g_xmdh_d_o.xmdh015
                     CALL s_desc_get_unit_desc(g_xmdh_d[l_ac].xmdh015) RETURNING g_xmdh_d[l_ac].xmdh015_desc
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL s_desc_get_unit_desc(g_xmdh_d[l_ac].xmdh015) RETURNING g_xmdh_d[l_ac].xmdh015_desc
            LET g_xmdh_d_o.xmdh015 = g_xmdh_d[l_ac].xmdh015]]>
  </point>
  <point name="input.a.page1.xmdh016" order="" ver="16" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xmdh_d[l_ac].xmdh016) THEN 
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_xmdh_d[l_ac].xmdh016 != g_xmdh_d_o.xmdh016 OR g_xmdh_d_o.xmdh016 IS NULL )) THEN
                  IF g_flag <> 'Y' THEN
                     #輸入的數量不可大於xmdd006-xmdd031-已轉出通單未確認數量
                     CALL axmt520_xmdd006_chk(g_xmdh_d[l_ac].xmdh001,g_xmdh_d[l_ac].xmdh002,g_xmdh_d[l_ac].xmdh003,g_xmdh_d[l_ac].xmdh004,g_xmdh_d[l_ac].xmdh006,g_xmdh_d[l_ac].xmdh016,g_xmdh_d_t.xmdh016)
                     IF NOT cl_null(g_errno) THEN
                        INITIALIZE g_errparam TO NULL
                        LET g_errparam.code = g_errno
                        LET g_errparam.extend = g_xmdh_d[l_ac].xmdh016
                        LET g_errparam.popup = TRUE
                        CALL cl_err()
                        LET g_xmdh_d[l_ac].xmdh016 = g_xmdh_d_o.xmdh016
                        NEXT FIELD CURRENT
                     END IF
                     #在揀量
                     IF NOT axmt520_inan_chk() THEN
                        LET g_xmdh_d[l_ac].xmdh016 = g_xmdh_d_o.xmdh016
                        NEXT FIELD CURRENT
                     END IF
                  END IF
                  CALL axmt520_xmdh016_count(g_xmdh_d[l_ac].xmdhseq,g_xmdh_d[l_ac].xmdh006,g_xmdh_d[l_ac].xmdh015,
                                             g_xmdh_d[l_ac].xmdh016,g_xmdh_d[l_ac].xmdh018,g_xmdh_d[l_ac].xmdh020,
                                             g_xmdh_d[l_ac].xmdh022,g_xmdh4_d[l_ac].xmdh023,g_xmdh4_d[l_ac].xmdh024,
                                             g_xmdh_d[l_ac].xmdh001)  #150522---earl---add
                       RETURNING g_xmdh_d[l_ac].xmdh017,g_xmdh_d[l_ac].xmdh019,g_xmdh_d[l_ac].xmdh021,
                                 g_xmdh4_d[l_ac].xmdh026,g_xmdh4_d[l_ac].xmdh027,
                                 g_xmdh4_d[l_ac].xmdh028,g_xmdh_d[l_ac].xmdh056
               END IF
            END IF 
            LET g_xmdh_d_o.xmdh016 = g_xmdh_d[l_ac].xmdh016
            LET g_xmdh_d_o.xmdh017 = g_xmdh_d[l_ac].xmdh017
            LET g_xmdh_d_o.xmdh019 = g_xmdh_d[l_ac].xmdh019
            LET g_xmdh_d_o.xmdh021 = g_xmdh_d[l_ac].xmdh021]]>
  </point>
  <point name="input.a.page1.xmdh017" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_xmdh_d_o.xmdh017 = g_xmdh_d[l_ac].xmdh017]]>
  </point>
  <point name="input.a.page1.xmdh018" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_xmdh_d[l_ac].xmdh018_desc = ''
            IF NOT cl_null(g_xmdh_d[l_ac].xmdh018) THEN 
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_xmdh_d[l_ac].xmdh018 != g_xmdh_d_o.xmdh018 OR g_xmdh_d_o.xmdh018 IS NULL )) THEN
                  INITIALIZE g_chkparam.* TO NULL
                  LET g_chkparam.arg1 = g_xmdh_d[l_ac].xmdh006
                  LET g_chkparam.arg2 = g_xmdh_d[l_ac].xmdh018
                  IF NOT cl_chk_exist("v_imao002") THEN
                     LET g_xmdh_d[l_ac].xmdh018 = g_xmdh_d_o.xmdh018
                     CALL s_desc_get_unit_desc(g_xmdh_d[l_ac].xmdh018) RETURNING g_xmdh_d[l_ac].xmdh018_desc
                     NEXT FIELD CURRENT
                  END IF
                  IF NOT cl_null(g_xmdh_d[l_ac].xmdh019) THEN
                     #對數量進行取位
                     CALL s_aooi250_take_decimals(g_xmdh_d[l_ac].xmdh018,g_xmdh_d[l_ac].xmdh019)
                          RETURNING l_success,g_xmdh_d[l_ac].xmdh019
                  END IF
               END IF
            END IF
            CALL s_desc_get_unit_desc(g_xmdh_d[l_ac].xmdh018) RETURNING g_xmdh_d[l_ac].xmdh018_desc
            LET g_xmdh_d_o.xmdh018 = g_xmdh_d[l_ac].xmdh018
            LET g_xmdh_d_o.xmdh019 = g_xmdh_d[l_ac].xmdh019]]>
  </point>
  <point name="input.a.page1.xmdh019" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xmdh_d[l_ac].xmdh019) THEN 
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_xmdh_d[l_ac].xmdh019 != g_xmdh_d_o.xmdh019 OR g_xmdh_d_o.xmdh019 IS NULL )) THEN
                  IF NOT cl_null(g_xmdh_d[l_ac].xmdh018) THEN
                     #對數量進行取位
                     CALL s_aooi250_take_decimals(g_xmdh_d[l_ac].xmdh018,g_xmdh_d[l_ac].xmdh019)
                          RETURNING l_success,g_xmdh_d[l_ac].xmdh019
                  END IF
               END IF
            END IF 
            LET g_xmdh_d_o.xmdh019 = g_xmdh_d[l_ac].xmdh019]]>
  </point>
  <point name="input.a.page1.xmdh020" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_xmdh_d[l_ac].xmdh020_desc = ''
            IF NOT cl_null(g_xmdh_d[l_ac].xmdh020) THEN 
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_xmdh_d[l_ac].xmdh020 != g_xmdh_d_o.xmdh020 OR g_xmdh_d_o.xmdh020 IS NULL )) THEN
                  INITIALIZE g_chkparam.* TO NULL
                  LET g_chkparam.arg1 = g_xmdh_d[l_ac].xmdh006
                  LET g_chkparam.arg2 = g_xmdh_d[l_ac].xmdh020
                  IF NOT cl_chk_exist("v_imao002") THEN
                     LET g_xmdh_d[l_ac].xmdh020 = g_xmdh_d_o.xmdh020
                     CALL s_desc_get_unit_desc(g_xmdh_d[l_ac].xmdh020) RETURNING g_xmdh_d[l_ac].xmdh020_desc
                     NEXT FIELD CURRENT
                  END IF
                  IF NOT cl_null(g_xmdh_d[l_ac].xmdh021) THEN
                     #對出貨進行取位
                     CALL s_aooi250_take_decimals(g_xmdh_d[l_ac].xmdh020,g_xmdh_d[l_ac].xmdh021)
                          RETURNING l_success,g_xmdh_d[l_ac].xmdh021
                     #重新計算未稅金額、含稅金額、稅額
                     CALL axmt520_get_amount(g_xmdh_d[l_ac].xmdhseq,g_xmdh_d[l_ac].xmdh021,g_xmdh4_d[l_ac].xmdh023,g_xmdh4_d[l_ac].xmdh024)
                          RETURNING g_xmdh4_d[l_ac].xmdh026,g_xmdh4_d[l_ac].xmdh028,g_xmdh4_d[l_ac].xmdh027
                  END IF
               END IF
            END IF 
            CALL s_desc_get_unit_desc(g_xmdh_d[l_ac].xmdh020) RETURNING g_xmdh_d[l_ac].xmdh020_desc
            LET g_xmdh_d_o.xmdh020 = g_xmdh_d[l_ac].xmdh020
            LET g_xmdh_d_o.xmdh021 = g_xmdh_d[l_ac].xmdh021]]>
  </point>
  <point name="input.a.page1.xmdh021" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xmdh_d[l_ac].xmdh021) THEN 
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_xmdh_d[l_ac].xmdh021 != g_xmdh_d_o.xmdh021 OR g_xmdh_d_o.xmdh021 IS NULL )) THEN
                  IF NOT cl_null(g_xmdh_d[l_ac].xmdh020) THEN
                     #對出貨進行取位
                     CALL s_aooi250_take_decimals(g_xmdh_d[l_ac].xmdh020,g_xmdh_d[l_ac].xmdh021)
                          RETURNING l_success,g_xmdh_d[l_ac].xmdh021
                  END IF
                  #重新計算未稅金額、含稅金額、稅額
                  CALL axmt520_get_amount(g_xmdh_d[l_ac].xmdhseq,g_xmdh_d[l_ac].xmdh021,g_xmdh4_d[l_ac].xmdh023,g_xmdh4_d[l_ac].xmdh024)
                       RETURNING g_xmdh4_d[l_ac].xmdh026,g_xmdh4_d[l_ac].xmdh028,g_xmdh4_d[l_ac].xmdh027
               END IF
            END IF 
            LET g_xmdh_d_o.xmdh021 = g_xmdh_d[l_ac].xmdh021]]>
  </point>
  <point name="input.a.page1.xmdh022" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_xmdh_d_o.xmdh022= g_xmdh_d[l_ac].xmdh022
                       ]]>
  </point>
  <point name="input.a.page1.xmdh029" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="input.a.page1.xmdh030" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_xmdh_d_o.xmdh030 = g_xmdh_d[l_ac].xmdh030
                       ]]>
  </point>
  <point name="input.a.page1.xmdh031" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_xmdh_d_o.xmdh031 = g_xmdh_d[l_ac].xmdh031
                       ]]>
  </point>
  <point name="input.a.page1.xmdh032" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_xmdh_d_o.xmdh032 = g_xmdh_d[l_ac].xmdh032
                       ]]>
  </point>
  <point name="input.a.page1.xmdh033" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_xmdh_d_o.xmdh033 = g_xmdh_d[l_ac].xmdh033
                       ]]>
  </point>
  <point name="input.a.page1.xmdh034" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xmdh_d[l_ac].xmdh034) THEN 
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_xmdh_d[l_ac].xmdh034 != g_xmdh_d_o.xmdh034 OR g_xmdh_d_o.xmdh034 IS NULL )) THEN
                  INITIALIZE g_chkparam.* TO NULL
                  LET g_chkparam.arg1 = g_xmdg_m.xmdg005       #交易對象編號
                  LET g_chkparam.arg2 = g_xmdh_d[l_ac].xmdh006 #料件編號
                  LET g_chkparam.arg3 = g_xmdh_d[l_ac].xmdh007 #產品特徵
                  LET g_chkparam.arg4 = g_xmdh_d[l_ac].xmdh034
                  IF NOT cl_chk_exist("v_pmao004") THEN
                     LET g_xmdh_d[l_ac].xmdh034 = g_xmdh_d_o.xmdh034
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF 
            LET g_xmdh_d_o.xmdh034 = g_xmdh_d[l_ac].xmdh034]]>
  </point>
  <point name="input.a.page1.xmdh036" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_xmdh_d_o.xmdh036 = g_xmdh_d[l_ac].xmdh036
                       ]]>
  </point>
  <point name="input.a.page1.xmdh050" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_xmdh_d_o.xmdh050 = g_xmdh_d[l_ac].xmdh050
                       ]]>
  </point>
  <point name="input.a.page1.xmdh051" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_xmdh_d_o.xmdh051 = g_xmdh_d[l_ac].xmdh051]]>
  </point>
  <point name="input.a.page1.xmdh052" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_xmdh_d_o.xmdh052 = g_xmdh_d[l_ac].xmdh052
]]>
  </point>
  <point name="input.a.page1.xmdhseq" order="" ver="8" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF  g_xmdg_m.xmdgdocno IS NOT NULL AND g_xmdh_d[g_detail_idx].xmdhseq IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmdg_m.xmdgdocno != g_xmdgdocno_t OR g_xmdh_d[g_detail_idx].xmdhseq != g_xmdh_d_t.xmdhseq)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xmdh_t WHERE "||"xmdhent = '" ||g_enterprise|| "' AND "||"xmdhdocno = '"||g_xmdg_m.xmdgdocno ||"' AND "|| "xmdhseq = '"||g_xmdh_d[g_detail_idx].xmdhseq ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmdh_d[l_ac].xmdhseq != g_xmdh_d_o.xmdhseq OR g_xmdh_d_o.xmdhseq IS NULL)) THEN 
                  CALL axmt520_get_amount(g_xmdh_d[l_ac].xmdhseq,g_xmdh_d[l_ac].xmdh021,g_xmdh4_d[l_ac].xmdh023,g_xmdh4_d[l_ac].xmdh024)
                       RETURNING g_xmdh4_d[l_ac].xmdh026,g_xmdh4_d[l_ac].xmdh028,g_xmdh4_d[l_ac].xmdh027
                  #IF g_xmdh_d[l_ac].xmdh011 = 'Y' THEN
                  #   CALL axmt520_xmdi_del()
                  #END IF
               END IF
            END IF
            LET g_xmdh_d_o.xmdhseq = g_xmdh_d[l_ac].xmdhseq]]>
  </point>
  <point name="input.a.page1.xmdhsite" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="input.a.page2.xmdi001" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            CALL axmt520_xmdi001_ref()
            IF NOT cl_null(g_xmdh2_d[l_ac].xmdi001) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmdh2_d[l_ac].xmdi001

               #呼叫檢查存在的library
               IF NOT cl_chk_exist("v_imaa001_5") THEN
                  #檢查失敗時後續處理
                  LET g_xmdh2_d[l_ac].xmdi001 = g_xmdh2_d_t.xmdi001
                  CALL axmt520_xmdi003_ref()
                  NEXT FIELD CURRENT
               END IF
            END IF 
            CALL axmt520_xmdi001_ref()]]>
  </point>
  <point name="input.a.page2.xmdi002" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        ]]>
  </point>
  <point name="input.a.page2.xmdi003" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            CALL axmt520_xmdi003_ref()
            IF NOT cl_null(g_xmdh2_d[l_ac].xmdi003) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = '221'
               LET g_chkparam.arg2 = g_xmdh2_d[l_ac].xmdi003

               #呼叫檢查存在的library
               IF NOT cl_chk_exist("v_oocq002_1") THEN
                  #檢查失敗時後續處理
                  LET g_xmdh2_d[l_ac].xmdi003 = g_xmdh2_d_t.xmdi003
                  CALL axmt520_xmdi003_ref()
                  NEXT FIELD CURRENT
               END IF
            END IF 
            CALL axmt520_xmdi003_ref()]]>
  </point>
  <point name="input.a.page2.xmdi004" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        ]]>
  </point>
  <point name="input.a.page2.xmdi005" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            CALL axmt520_xmdi005_ref()
            IF NOT cl_null(g_xmdh2_d[l_ac].xmdi005) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_site
               LET g_chkparam.arg2 = g_xmdh2_d[l_ac].xmdi005

               #呼叫檢查存在的library
               IF NOT cl_chk_exist("v_inaa001_1") THEN
                  #檢查失敗時後續處理
                  LET g_xmdh2_d[l_ac].xmdi005 = g_xmdh2_d_t.xmdi005
                  CALL axmt520_xmdi005_ref()
                  NEXT FIELD CURRENT
               END IF
            END IF 
            CALL axmt520_xmdi005_ref()]]>
  </point>
  <point name="input.a.page2.xmdi006" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            CALL axmt520_xmdi006_ref()
            IF NOT cl_null(g_xmdh2_d[l_ac].xmdi006) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_site
               LET g_chkparam.arg2 = g_xmdh2_d[l_ac].xmdi005
               LET g_chkparam.arg3 = g_xmdh2_d[l_ac].xmdi006

               #呼叫檢查存在的library
               IF NOT cl_chk_exist("v_inab002_1") THEN
                  #檢查失敗時後續處理
                  LET g_xmdh2_d[l_ac].xmdi006 = g_xmdh2_d_t.xmdi006
                  CALL axmt520_xmdi006_ref()
                  NEXT FIELD CURRENT
               END IF
            END IF 
            CALL axmt520_xmdi006_ref()]]>
  </point>
  <point name="input.a.page2.xmdi007" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        ]]>
  </point>
  <point name="input.a.page2.xmdi008" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            CALL axmt520_xmdi008_ref()
            IF NOT cl_null(g_xmdh2_d[l_ac].xmdi008) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmdh2_d[l_ac].xmdi008

               #呼叫檢查存在的library
               IF NOT cl_chk_exist("v_ooca001") THEN
                  #檢查失敗時後續處理
                  LET g_xmdh2_d[l_ac].xmdi008 = g_xmdh2_d_t.xmdi008
                  CALL axmt520_xmdi008_ref()
                  NEXT FIELD CURRENT
               END IF
            END IF 
            CALL axmt520_xmdi008_ref()]]>
  </point>
  <point name="input.a.page2.xmdi009" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        
            IF NOT cl_null(g_xmdh2_d[l_ac].xmdi009) THEN 
            END IF 
]]>
  </point>
  <point name="input.a.page2.xmdi010" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            CALL axmt520_xmdi010_ref()
            IF NOT cl_null(g_xmdh2_d[l_ac].xmdi010) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmdh2_d[l_ac].xmdi010

               #呼叫檢查存在的library
               IF NOT cl_chk_exist("v_ooca001") THEN
                  #檢查失敗時後續處理
                  LET g_xmdh2_d[l_ac].xmdi010 = g_xmdh2_d_t.xmdi010
                  CALL axmt520_xmdi010_ref()
                  NEXT FIELD CURRENT
               END IF
            END IF 
            CALL axmt520_xmdi010_ref()]]>
  </point>
  <point name="input.a.page2.xmdi011" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        ]]>
  </point>
  <point name="input.a.page2.xmdi012" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        ]]>
  </point>
  <point name="input.a.page2.xmdiseq" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                                    #此段落由子樣板a05產生
            IF  g_xmdg_m.xmdgdocno IS NOT NULL AND g_xmdh2_d[g_detail_idx].xmdiseq IS NOT NULL AND g_xmdh2_d[g_detail_idx].xmdiseq1 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmdg_m.xmdgdocno != g_xmdgdocno_t OR g_xmdh2_d[g_detail_idx].xmdiseq != g_xmdh2_d_t.xmdiseq OR g_xmdh2_d[g_detail_idx].xmdiseq1 != g_xmdh2_d_t.xmdiseq1)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xmdi_t WHERE "||"xmdient = '" ||g_enterprise|| "' AND "||"xmdidocno = '"||g_xmdg_m.xmdgdocno ||"' AND "|| "xmdiseq = '"||g_xmdh2_d[g_detail_idx].xmdiseq ||"' AND "|| "xmdiseq1 = '"||g_xmdh2_d[g_detail_idx].xmdiseq1 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page2.xmdiseq1" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                                    #此段落由子樣板a05產生
            IF  g_xmdg_m.xmdgdocno IS NOT NULL AND g_xmdh2_d[g_detail_idx].xmdiseq IS NOT NULL AND g_xmdh2_d[g_detail_idx].xmdiseq1 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmdg_m.xmdgdocno != g_xmdgdocno_t OR g_xmdh2_d[g_detail_idx].xmdiseq != g_xmdh2_d_t.xmdiseq OR g_xmdh2_d[g_detail_idx].xmdiseq1 != g_xmdh2_d_t.xmdiseq1)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xmdi_t WHERE "||"xmdient = '" ||g_enterprise|| "' AND "||"xmdidocno = '"||g_xmdg_m.xmdgdocno ||"' AND "|| "xmdiseq = '"||g_xmdh2_d[g_detail_idx].xmdiseq ||"' AND "|| "xmdiseq1 = '"||g_xmdh2_d[g_detail_idx].xmdiseq1 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page3.xmdhseq_3" order="" ver="1" cite_std="" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xmdg_m.xmdgdocno IS NOT NULL AND g_xmdh3_d[g_detail_idx].xmdhseq IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmdg_m.xmdgdocno != g_xmdgdocno_t OR g_xmdh3_d[g_detail_idx].xmdhseq != g_xmdh3_d_t.xmdhseq)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xmdh_t WHERE "||"xmdhent = '" ||g_enterprise|| "' AND "||"xmdhdocno = '"||g_xmdg_m.xmdgdocno ||"' AND "|| "xmdhseq = '"||g_xmdh3_d[g_detail_idx].xmdhseq ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page3.xmdiseq1_3" order="" ver="1" cite_std="" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xmdg_m.xmdgdocno IS NOT NULL AND g_xmdh3_d[g_detail_idx].xmdiseq IS NOT NULL AND g_xmdh3_d[g_detail_idx].xmdiseq1 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmdg_m.xmdgdocno != g_xmdgdocno_t OR g_xmdh3_d[g_detail_idx].xmdiseq != g_xmdh3_d_t.xmdiseq OR g_xmdh3_d[g_detail_idx].xmdiseq1 != g_xmdh3_d_t.xmdiseq1)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xmdi_t WHERE "||"xmdient = '" ||g_enterprise|| "' AND "||"xmdidocno = '"||g_xmdg_m.xmdgdocno ||"' AND "|| "xmdiseq = '"||g_xmdh3_d[g_detail_idx].xmdiseq ||"' AND "|| "xmdiseq1 = '"||g_xmdh3_d[g_detail_idx].xmdiseq1 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page3.xmdiseq_3" order="" ver="1" cite_std="" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xmdg_m.xmdgdocno IS NOT NULL AND g_xmdh3_d[g_detail_idx].xmdiseq IS NOT NULL AND g_xmdh3_d[g_detail_idx].xmdiseq1 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmdg_m.xmdgdocno != g_xmdgdocno_t OR g_xmdh3_d[g_detail_idx].xmdiseq != g_xmdh3_d_t.xmdiseq OR g_xmdh3_d[g_detail_idx].xmdiseq1 != g_xmdh3_d_t.xmdiseq1)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xmdi_t WHERE "||"xmdient = '" ||g_enterprise|| "' AND "||"xmdidocno = '"||g_xmdg_m.xmdgdocno ||"' AND "|| "xmdiseq = '"||g_xmdh3_d[g_detail_idx].xmdiseq ||"' AND "|| "xmdiseq1 = '"||g_xmdh3_d[g_detail_idx].xmdiseq1 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page4.xmdh0011" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xmdh4_d[l_ac].xmdh0011) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmdh4_d[l_ac].xmdh0011

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist_and_ref_val("v_xmdadocno_1") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 

               ELSE
                  #檢查失敗時後續處理
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
]]>
  </point>
  <point name="input.a.page4.xmdh001_1" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xmdh4_d[l_ac].xmdh001_1) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmdh4_d[l_ac].xmdh001_1

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist_and_ref_val("v_xmdadocno_1") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 

               ELSE
                  #檢查失敗時後續處理
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
]]>
  </point>
  <point name="input.a.page4.xmdh0061" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xmdh4_d[l_ac].xmdh0061) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmdh4_d[l_ac].xmdh0061

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist_and_ref_val("v_imaa001_5") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 

               ELSE
                  #檢查失敗時後續處理
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmdh4_d[l_ac].xmdh0061
            CALL ap_ref_array2(g_ref_fields,"SELECT imaal004 FROM imaal_t WHERE imaalent='"||g_enterprise||"' AND imaal001=? AND imaal002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmdh4_d[l_ac].xmdh0061_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmdh4_d[l_ac].xmdh0061_desc
]]>
  </point>
  <point name="input.a.page4.xmdh006_1" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            CALL axmt520_xmdh006_1_ref()
            IF NOT cl_null(g_xmdh4_d[l_ac].xmdh006_1) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmdh4_d[l_ac].xmdh006_1

               #呼叫檢查存在並帶值的library
               IF NOT cl_chk_exist_and_ref_val("v_imaa001_5") THEN
                  #檢查失敗時後續處理
                  LET g_xmdh4_d[l_ac].xmdh006_1 = g_xmdh4_d_t.xmdh006_1
                  CALL axmt520_xmdh006_1_ref()
                  NEXT FIELD CURRENT
               END IF
            END IF 
            CALL axmt520_xmdh006_1_ref()]]>
  </point>
  <point name="input.a.page4.xmdh0091" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xmdh4_d[l_ac].xmdh0091) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmdh4_d[l_ac].xmdh0091
               LET g_chkparam.arg2 = '參數2'

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist_and_ref_val("v_oocq002_1") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 

               ELSE
                  #檢查失敗時後續處理
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmdh4_d[l_ac].xmdh0091
            CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001=? AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmdh4_d[l_ac].xmdh0091_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmdh4_d[l_ac].xmdh0091_desc
]]>
  </point>
  <point name="input.a.page4.xmdh009_1" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            CALL axmt520_xmdh009_1_ref()
            IF NOT cl_null(g_xmdh4_d[l_ac].xmdh009_1) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = '221'
               LET g_chkparam.arg2 = g_xmdh4_d[l_ac].xmdh009_1

               #呼叫檢查存在並帶值的library
               IF NOT cl_chk_exist_and_ref_val("v_oocq002_1") THEN
                  #檢查失敗時後續處理
                  LET g_xmdh4_d[l_ac].xmdh009_1 = g_xmdh4_d_t.xmdh009_1
                  CALL axmt520_xmdh009_1_ref()
                  NEXT FIELD CURRENT
               END IF
            END IF 
            CALL axmt520_xmdh009_1_ref()]]>
  </point>
  <point name="input.a.page4.xmdh0151" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xmdh4_d[l_ac].xmdh0151) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmdh4_d[l_ac].xmdh0151

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist_and_ref_val("v_ooca001") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 

               ELSE
                  #檢查失敗時後續處理
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmdh4_d[l_ac].xmdh0151
            CALL ap_ref_array2(g_ref_fields,"SELECT oocal003 FROM oocal_t WHERE oocalent='"||g_enterprise||"' AND oocal001=? AND oocal002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmdh4_d[l_ac].xmdh0151_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmdh4_d[l_ac].xmdh0151_desc
]]>
  </point>
  <point name="input.a.page4.xmdh015_1" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            CALL axmt520_xmdh015_1_ref()
            IF NOT cl_null(g_xmdh4_d[l_ac].xmdh015_1) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmdh4_d[l_ac].xmdh015_1

               #呼叫檢查存在並帶值的library
               IF NOT cl_chk_exist_and_ref_val("v_ooca001") THEN
                  #檢查失敗時後續處理
                  LET g_xmdh4_d[l_ac].xmdh015_1 = g_xmdh4_d_t.xmdh015_1
                  CALL axmt520_xmdh015_1_ref()
                  NEXT FIELD CURRENT
               END IF
            END IF 
            CALL axmt520_xmdh015_1_ref()]]>
  </point>
  <point name="input.a.page4.xmdh0201" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xmdh4_d[l_ac].xmdh0201) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmdh4_d[l_ac].xmdh0201

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist_and_ref_val("v_ooca001") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 

               ELSE
                  #檢查失敗時後續處理
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xmdh4_d[l_ac].xmdh0201
            CALL ap_ref_array2(g_ref_fields,"SELECT oocal003 FROM oocal_t WHERE oocalent='"||g_enterprise||"' AND oocal001=? AND oocal002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xmdh4_d[l_ac].xmdh0201_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xmdh4_d[l_ac].xmdh0201_desc
]]>
  </point>
  <point name="input.a.page4.xmdh020_1" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            CALL axmt520_xmdh020_1_ref()
            IF NOT cl_null(g_xmdh4_d[l_ac].xmdh020_1) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmdh4_d[l_ac].xmdh020_1

               #呼叫檢查存在並帶值的library
               IF NOT cl_chk_exist_and_ref_val("v_ooca001") THEN
                  #檢查失敗時後續處理
                  LET g_xmdh4_d[l_ac].xmdh020_1 = g_xmdh4_d_t.xmdh020_1
                  CALL axmt520_xmdh020_1_ref()
                  NEXT FIELD CURRENT
               END IF
            END IF 
            CALL axmt520_xmdh020_1_ref()]]>
  </point>
  <point name="input.a.page4.xmdh023" order="" ver="2" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="input.a.page4.xmdh024" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        
            IF NOT cl_null(g_xmdh4_d[l_ac].xmdh024) THEN 
#此段落由子樣板a19產生
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_xmdh4_d[l_ac].xmdh024
               LET g_chkparam.arg2 = '參數2'

                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist_and_ref_val("v_oodb002") THEN
                  #檢查成功時後續處理
                  #LET  = g_chkparam.return1
                  #DISPLAY BY NAME 

               ELSE
                  #檢查失敗時後續處理
                  NEXT FIELD CURRENT
               END IF
            

            END IF 
]]>
  </point>
  <point name="input.a.page4.xmdh025" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        ]]>
  </point>
  <point name="input.a.page4.xmdh026" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        ]]>
  </point>
  <point name="input.a.page4.xmdh027" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        ]]>
  </point>
  <point name="input.a.page4.xmdh028" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        ]]>
  </point>
  <point name="input.a.page4.xmdhseq_4" order="" ver="1" cite_std="" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xmdg_m.xmdgdocno IS NOT NULL AND g_xmdh4_d[g_detail_idx].xmdhseq IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xmdg_m.xmdgdocno != g_xmdgdocno_t OR g_xmdh4_d[g_detail_idx].xmdhseq != g_xmdh4_d_t.xmdhseq)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xmdh_t WHERE "||"xmdhent = '" ||g_enterprise|| "' AND "||"xmdhdocno = '"||g_xmdg_m.xmdgdocno ||"' AND "|| "xmdhseq = '"||g_xmdh4_d[g_detail_idx].xmdhseq ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.xmdg001" order="" ver="12" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #add by shiun--------------------------
            LET g_xmdg_m_o.xmdg001 = g_xmdg_m.xmdg001
                       ]]>
  </point>
  <point name="input.a.xmdg002" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_xmdg_m.xmdg002_desc = ''
            DISPLAY BY NAME g_xmdg_m.xmdg002_desc
            IF NOT cl_null(g_xmdg_m.xmdg002) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_xmdg_m.xmdg002 != g_xmdg_m_o.xmdg002 OR g_xmdg_m_o.xmdg002 IS NULL )) THEN
                  INITIALIZE g_chkparam.* TO NULL
                  LET g_chkparam.arg1 = g_xmdg_m.xmdg002
                  IF cl_chk_exist("v_ooag001") THEN
                     #抓取業務人員對應的部門預設到xmdg003
                     SELECT ooag003 INTO g_xmdg_m.xmdg003 FROM ooag_t
                      WHERE ooagent = g_enterprise AND ooag001 = g_xmdg_m.xmdg002
                     CALL s_desc_get_department_desc(g_xmdg_m.xmdg003) RETURNING g_xmdg_m.xmdg003_desc
                     DISPLAY BY NAME g_xmdg_m.xmdg003,g_xmdg_m.xmdg003_desc
                  ELSE
                     LET g_xmdg_m.xmdg002 = g_xmdg_m_o.xmdg002 
                     CALL s_desc_get_person_desc(g_xmdg_m.xmdg002) RETURNING g_xmdg_m.xmdg002_desc
                     DISPLAY BY NAME g_xmdg_m.xmdg002,g_xmdg_m.xmdg002_desc
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL s_desc_get_person_desc(g_xmdg_m.xmdg002) RETURNING g_xmdg_m.xmdg002_desc
            DISPLAY BY NAME g_xmdg_m.xmdg002_desc
            LET g_xmdg_m_o.xmdg002 = g_xmdg_m.xmdg002]]>
  </point>
  <point name="input.a.xmdg003" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_xmdg_m.xmdg003_desc = ''
            DISPLAY BY NAME g_xmdg_m.xmdg003_desc
            IF NOT cl_null(g_xmdg_m.xmdg003) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_xmdg_m.xmdg003 != g_xmdg_m_o.xmdg003 OR g_xmdg_m_o.xmdg003 IS NULL )) THEN
                  INITIALIZE g_chkparam.* TO NULL
                  LET g_chkparam.arg1 = g_xmdg_m.xmdg003
                  LET g_chkparam.arg2 = g_xmdg_m.xmdgdocdt
                  IF NOT cl_chk_exist("v_ooeg001") THEN
                     LET g_xmdg_m.xmdg003 = g_xmdg_m_o.xmdg003 
                     CALL s_desc_get_department_desc(g_xmdg_m.xmdg003) RETURNING g_xmdg_m.xmdg003_desc
                     DISPLAY BY NAME g_xmdg_m.xmdg003,g_xmdg_m.xmdg003_desc
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL s_desc_get_department_desc(g_xmdg_m.xmdg003) RETURNING g_xmdg_m.xmdg003_desc
            DISPLAY BY NAME g_xmdg_m.xmdg003_desc
            LET g_xmdg_m_o.xmdg003 = g_xmdg_m.xmdg003]]>
  </point>
  <point name="input.a.xmdg004" order="" ver="13" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xmdg_m.xmdg004) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_xmdg_m.xmdg004 != g_xmdg_m_o.xmdg004 OR g_xmdg_m_o.xmdg004 IS NULL )) THEN
                  IF NOT axmt520_xmdadocno_chk(g_xmdg_m.xmdg004) THEN
                     LET g_xmdg_m.xmdg004 = g_xmdg_m_o.xmdg004 
                     DISPLAY BY NAME g_xmdg_m.xmdg004
                     NEXT FIELD CURRENT
                  END IF
                  CALL axmt520_xmdg004_default()
               END IF
            END IF
            CALL axmt520_set_entry(p_cmd)
            CALL axmt520_set_no_entry(p_cmd)
            LET g_xmdg_m_o.xmdg004 = g_xmdg_m.xmdg004]]>
  </point>
  <point name="input.a.xmdg005" order="" ver="16" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_xmdg_m.xmdg005_desc = ''
            DISPLAY BY NAME g_xmdg_m.xmdg005_desc
            IF NOT cl_null(g_xmdg_m.xmdg005) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_xmdg_m.xmdg005 != g_xmdg_m_o.xmdg005 OR g_xmdg_m_o.xmdg005 IS NULL )) THEN
                  INITIALIZE g_chkparam.* TO NULL
                  LET g_chkparam.arg1 = g_xmdg_m.xmdg005
                  LET g_chkparam.arg2 = g_site
                  IF NOT cl_chk_exist("v_pmaa001_3") THEN
                     LET g_xmdg_m.xmdg005 = g_xmdg_m_o.xmdg005 
                     CALL s_desc_get_trading_partner_abbr_desc(g_xmdg_m.xmdg005) RETURNING g_xmdg_m.xmdg005_desc
                     DISPLAY BY NAME g_xmdg_m.xmdg005,g_xmdg_m.xmdg005_desc
                     NEXT FIELD CURRENT
                  END IF
                  IF NOT s_control_check_customer(g_xmdg_m.xmdg005,'2',g_site,g_user,g_dept,g_xmdg_m.xmdgdocno) THEN
                     LET g_xmdg_m.xmdg005 = g_xmdg_m_o.xmdg005 
                     CALL s_desc_get_trading_partner_abbr_desc(g_xmdg_m.xmdg005) RETURNING g_xmdg_m.xmdg005_desc
                     DISPLAY BY NAME g_xmdg_m.xmdg005,g_xmdg_m.xmdg005_desc
                     NEXT FIELD CURRENT
                  END IF
                  #若出通單上的訂單沒有輸入時，在輸入客戶編號後需自動帶預設交易條件
                  IF cl_null(g_xmdg_m.xmdg004) THEN
                     CALL axmt520_xmdg005_default()
                  END IF
               END IF
            END IF
            CALL s_desc_get_trading_partner_abbr_desc(g_xmdg_m.xmdg005) RETURNING g_xmdg_m.xmdg005_desc
            DISPLAY BY NAME g_xmdg_m.xmdg005_desc
            LET g_xmdg_m_o.xmdg005 = g_xmdg_m.xmdg005]]>
  </point>
  <point name="input.a.xmdg006" order="" ver="16" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_xmdg_m.xmdg006_desc = ''
            DISPLAY BY NAME g_xmdg_m.xmdg006_desc
            IF NOT cl_null(g_xmdg_m.xmdg006) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_xmdg_m.xmdg006 != g_xmdg_m_o.xmdg006 OR g_xmdg_m_o.xmdg006 IS NULL )) THEN
                  IF g_xmdg_m.xmdg006 <> g_xmdg_m.xmdg005 THEN
                     INITIALIZE g_chkparam.* TO NULL
                     LET g_chkparam.arg1 = g_xmdg_m.xmdg005
                     LET g_chkparam.arg2 = g_xmdg_m.xmdg006
                     LET g_chkparam.arg3 = g_site
                     IF NOT cl_chk_exist("v_pmac002") THEN
                        LET g_xmdg_m.xmdg006 = g_xmdg_m_o.xmdg006 
                        CALL s_desc_get_trading_partner_abbr_desc(g_xmdg_m.xmdg006) RETURNING g_xmdg_m.xmdg006_desc
                        DISPLAY BY NAME g_xmdg_m.xmdg006,g_xmdg_m.xmdg006_desc
                        NEXT FIELD CURRENT
                     END IF
                  END IF
               END IF
            END IF
            CALL s_desc_get_trading_partner_abbr_desc(g_xmdg_m.xmdg006) RETURNING g_xmdg_m.xmdg006_desc
            DISPLAY BY NAME g_xmdg_m.xmdg006_desc
            LET g_xmdg_m_o.xmdg006 = g_xmdg_m.xmdg006]]>
  </point>
  <point name="input.a.xmdg007" order="" ver="16" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_xmdg_m.xmdg007_desc = ''
            DISPLAY BY NAME g_xmdg_m.xmdg007_desc
            IF NOT cl_null(g_xmdg_m.xmdg007) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_xmdg_m.xmdg007 != g_xmdg_m_o.xmdg007 OR g_xmdg_m_o.xmdg007 IS NULL )) THEN
                  IF g_xmdg_m.xmdg007 <> g_xmdg_m.xmdg005 THEN
                     INITIALIZE g_chkparam.* TO NULL
                     LET g_chkparam.arg1 = g_xmdg_m.xmdg005
                     LET g_chkparam.arg2 = g_xmdg_m.xmdg007
                     LET g_chkparam.arg3 = g_site
                     IF NOT cl_chk_exist("v_pmac002_2") THEN
                        LET g_xmdg_m.xmdg007 = g_xmdg_m_o.xmdg007 
                        CALL s_desc_get_trading_partner_abbr_desc(g_xmdg_m.xmdg007) RETURNING g_xmdg_m.xmdg007_desc
                        DISPLAY BY NAME g_xmdg_m.xmdg007,g_xmdg_m.xmdg007_desc
                        NEXT FIELD CURRENT
                     END IF
                  END IF
               END IF
            END IF
            CALL s_desc_get_trading_partner_abbr_desc(g_xmdg_m.xmdg007) RETURNING g_xmdg_m.xmdg007_desc
            DISPLAY BY NAME g_xmdg_m.xmdg007_desc
            LET g_xmdg_m_o.xmdg007 = g_xmdg_m.xmdg007]]>
  </point>
  <point name="input.a.xmdg008" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_xmdg_m.xmdg008_desc = ''
            DISPLAY BY NAME g_xmdg_m.xmdg008_desc
            IF NOT cl_null(g_xmdg_m.xmdg008) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_xmdg_m.xmdg008 != g_xmdg_m_o.xmdg008 OR g_xmdg_m_o.xmdg008 IS NULL )) THEN
                  INITIALIZE g_chkparam.* TO NULL
                  LET g_chkparam.arg1 = g_xmdg_m.xmdg005
                  LET g_chkparam.arg2 = g_xmdg_m.xmdg008
                  IF NOT cl_chk_exist("v_pmad002_2") THEN
                     LET g_xmdg_m.xmdg008 = g_xmdg_m_o.xmdg008
                     DISPLAY BY NAME g_xmdg_m.xmdg008
                     CALL s_desc_get_ooib002_desc(g_xmdg_m.xmdg008) RETURNING g_xmdg_m.xmdg008_desc
                     DISPLAY BY NAME g_xmdg_m.xmdg008,g_xmdg_m.xmdg008_desc
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL s_desc_get_ooib002_desc(g_xmdg_m.xmdg008) RETURNING g_xmdg_m.xmdg008_desc
            DISPLAY BY NAME g_xmdg_m.xmdg008_desc
            LET g_xmdg_m_o.xmdg008 = g_xmdg_m.xmdg008]]>
  </point>
  <point name="input.a.xmdg009" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_xmdg_m.xmdg009_desc = ''
            DISPLAY BY NAME g_xmdg_m.xmdg009_desc
            IF NOT cl_null(g_xmdg_m.xmdg009) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_xmdg_m.xmdg009 != g_xmdg_m_o.xmdg009 OR g_xmdg_m_o.xmdg009 IS NULL )) THEN
                  INITIALIZE g_chkparam.* TO NULL
                  LET g_chkparam.arg1 = '238'
                  LET g_chkparam.arg2 = g_xmdg_m.xmdg009
                  IF NOT cl_chk_exist("v_oocq002_1") THEN
                     LET g_xmdg_m.xmdg009 = g_xmdg_m_o.xmdg009
                     CALL s_desc_get_acc_desc('238',g_xmdg_m.xmdg009) RETURNING g_xmdg_m.xmdg009_desc
                     DISPLAY BY NAME g_xmdg_m.xmdg009,g_xmdg_m.xmdg009_desc
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL s_desc_get_acc_desc('238',g_xmdg_m.xmdg009) RETURNING g_xmdg_m.xmdg009_desc
            DISPLAY BY NAME g_xmdg_m.xmdg009_desc
            LET g_xmdg_m_o.xmdg009 = g_xmdg_m.xmdg009]]>
  </point>
  <point name="input.a.xmdg010" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_xmdg_m.xmdg010_desc = ''
            DISPLAY BY NAME g_xmdg_m.xmdg010_desc
            IF NOT cl_null(g_xmdg_m.xmdg010) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_xmdg_m.xmdg010 != g_xmdg_m_o.xmdg010 OR g_xmdg_m_o.xmdg010 IS NULL )) THEN
                  CALL s_tax_chk(g_site,g_xmdg_m.xmdg010)
                       RETURNING l_success,g_xmdg_m.xmdg010_desc,g_xmdg_m.xmdg012,g_xmdg_m.xmdg011,l_oodb011
                       DISPLAY BY NAME g_xmdg_m.xmdg010_desc,g_xmdg_m.xmdg012,g_xmdg_m.xmdg011
                  IF NOT l_success THEN
                     LET g_xmdg_m.xmdg010 = g_xmdg_m_o.xmdg010
                     LET g_xmdg_m.xmdg011 = g_xmdg_m_o.xmdg011
                     LET g_xmdg_m.xmdg012 = g_xmdg_m_o.xmdg012
                     CALL s_desc_get_tax_desc1(g_site,g_xmdg_m.xmdg010) RETURNING g_xmdg_m.xmdg010_desc
                     DISPLAY BY NAME g_xmdg_m.xmdg010,g_xmdg_m.xmdg011,g_xmdg_m.xmdg012,g_xmdg_m.xmdg010_desc
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL s_desc_get_tax_desc1(g_site,g_xmdg_m.xmdg010) RETURNING g_xmdg_m.xmdg010_desc
            DISPLAY BY NAME g_xmdg_m.xmdg010_desc
            LET g_xmdg_m_o.xmdg010 = g_xmdg_m.xmdg010
            LET g_xmdg_m_o.xmdg011 = g_xmdg_m.xmdg011
            LET g_xmdg_m_o.xmdg012 = g_xmdg_m.xmdg012]]>
  </point>
  <point name="input.a.xmdg011" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_xmdg_m_o.xmdg011 = g_xmdg_m.xmdg011
                       ]]>
  </point>
  <point name="input.a.xmdg012" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_xmdg_m_o.xmdg012 = g_xmdg_m.xmdg012
                       ]]>
  </point>
  <point name="input.a.xmdg013" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_xmdg_m.xmdg013_desc = ''
            DISPLAY BY NAME g_xmdg_m.xmdg013_desc
            IF NOT cl_null(g_xmdg_m.xmdg013) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_xmdg_m.xmdg013 != g_xmdg_m_o.xmdg013 OR g_xmdg_m_o.xmdg013 IS NULL )) THEN
                  INITIALIZE g_chkparam.* TO NULL
                  LET g_chkparam.arg1 = g_ooef019
                  LET g_chkparam.arg2 = g_xmdg_m.xmdg013
                  IF NOT cl_chk_exist("v_isac002") THEN
                     LET g_xmdg_m.xmdg013 = g_xmdg_m_o.xmdg013
                     CALL s_desc_get_invoice_type_desc1(g_site,g_xmdg_m.xmdg013) RETURNING g_xmdg_m.xmdg013_desc
                     DISPLAY BY NAME g_xmdg_m.xmdg013,g_xmdg_m.xmdg013_desc
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL s_desc_get_invoice_type_desc1(g_site,g_xmdg_m.xmdg013) RETURNING g_xmdg_m.xmdg013_desc
            DISPLAY BY NAME g_xmdg_m.xmdg013_desc
            LET g_xmdg_m_o.xmdg013 = g_xmdg_m.xmdg013]]>
  </point>
  <point name="input.a.xmdg014" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_xmdg_m.xmdg014_desc = ''
            DISPLAY BY NAME g_xmdg_m.xmdg014_desc
            IF NOT cl_null(g_xmdg_m.xmdg014) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_xmdg_m.xmdg014 != g_xmdg_m_o.xmdg014 OR g_xmdg_m_o.xmdg014 IS NULL )) THEN
                  INITIALIZE g_chkparam.* TO NULL
                  LET g_chkparam.arg1 = g_site
                  LET g_chkparam.arg2 = g_xmdg_m.xmdg014
                  IF NOT cl_chk_exist("v_ooaj002") THEN
                     LET g_xmdg_m.xmdg014 = g_xmdg_m_o.xmdg014
                     CALL s_desc_get_currency_desc(g_xmdg_m.xmdg014) RETURNING g_xmdg_m.xmdg014_desc
                     DISPLAY BY NAME g_xmdg_m.xmdg014,g_xmdg_m.xmdg014_desc
                     NEXT FIELD CURRENT
                  END IF
                  IF NOT cl_null(g_xmdg_m.xmdg032) THEN
                     CALL s_axmt540_get_exchange(g_xmdg_m.xmdg032,g_xmdg_m.xmdg014) RETURNING g_xmdg_m.xmdg015
                     DISPLAY BY NAME g_xmdg_m.xmdg015
                  END IF
               END IF
            END IF
            CALL s_desc_get_currency_desc(g_xmdg_m.xmdg014) RETURNING g_xmdg_m.xmdg014_desc
            DISPLAY BY NAME g_xmdg_m.xmdg014_desc
            LET g_xmdg_m_o.xmdg014 = g_xmdg_m.xmdg014
            LET g_xmdg_m_o.xmdg015 = g_xmdg_m.xmdg015]]>
  </point>
  <point name="input.a.xmdg015" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_xmdg_m_o.xmdg015 = g_xmdg_m.xmdg015
                       ]]>
  </point>
  <point name="input.a.xmdg016" order="" ver="16" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_xmdg_m.xmdg016_desc = ''
            DISPLAY BY NAME g_xmdg_m.xmdg016_desc
            IF NOT cl_null(g_xmdg_m.xmdg016) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_xmdg_m.xmdg016 != g_xmdg_m_o.xmdg016 OR g_xmdg_m_o.xmdg016 IS NULL )) THEN
                  INITIALIZE g_chkparam.* TO NULL
                  LET g_chkparam.arg1 = g_xmdg_m.xmdg016
                  IF NOT cl_chk_exist("v_pmaa001_1") THEN
                     LET g_xmdg_m.xmdg016 = g_xmdg_m_o.xmdg016 
                     CALL s_desc_get_trading_partner_abbr_desc(g_xmdg_m.xmdg016) RETURNING g_xmdg_m.xmdg016_desc
                     DISPLAY BY NAME g_xmdg_m.xmdg016,g_xmdg_m.xmdg016_desc
                     NEXT FIELD CURRENT
                  END IF
                  IF NOT s_control_check_supplier(g_xmdg_m.xmdg016,'2',g_site,g_user,g_dept,g_xmdg_m.xmdgdocno) THEN
                     LET g_xmdg_m.xmdg016 = g_xmdg_m_o.xmdg016 
                     CALL s_desc_get_trading_partner_abbr_desc(g_xmdg_m.xmdg016) RETURNING g_xmdg_m.xmdg016_desc
                     DISPLAY BY NAME g_xmdg_m.xmdg016,g_xmdg_m.xmdg016_desc
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL s_desc_get_trading_partner_abbr_desc(g_xmdg_m.xmdg016) RETURNING g_xmdg_m.xmdg016_desc
            DISPLAY BY NAME g_xmdg_m.xmdg016_desc
            LET g_xmdg_m_o.xmdg016 = g_xmdg_m.xmdg016]]>
  </point>
  <point name="input.a.xmdg017" order="" ver="17" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_xmdg_m.xmdg017_desc = ''
            DISPLAY BY NAME g_xmdg_m.xmdg017_desc
            IF NOT cl_null(g_xmdg_m.xmdg017) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_xmdg_m.xmdg017 != g_xmdg_m_o.xmdg017 OR g_xmdg_m_o.xmdg017 IS NULL )) THEN
                  INITIALIZE g_chkparam.* TO NULL
                  CALL s_axmt500_get_pmaa027(g_xmdg_m.xmdg007) RETURNING l_pmaa027
                  LET g_chkparam.arg1 = l_pmaa027
                  LET g_chkparam.arg2 = g_xmdg_m.xmdg017
                  IF NOT cl_chk_exist("v_oofb019") THEN
                     LET g_xmdg_m.xmdg017 = g_xmdg_m_o.xmdg017
                     DISPLAY BY NAME g_xmdg_m.xmdg017
                     CALL axmt520_xmdg017_ref()
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL axmt520_xmdg017_ref()
            LET g_xmdg_m_o.xmdg017 = g_xmdg_m.xmdg017]]>
  </point>
  <point name="input.a.xmdg018" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_xmdg_m.xmdg018_desc = ''
            DISPLAY BY NAME g_xmdg_m.xmdg018_desc
            IF NOT cl_null(g_xmdg_m.xmdg018) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_xmdg_m.xmdg018 != g_xmdg_m_o.xmdg018 OR g_xmdg_m_o.xmdg018 IS NULL )) THEN
                  IF NOT s_azzi650_chk_exist('263',g_xmdg_m.xmdg018) THEN
                     LET g_xmdg_m.xmdg018 = g_xmdg_m_o.xmdg018
                     CALL s_desc_get_acc_desc('263',g_xmdg_m.xmdg018) RETURNING g_xmdg_m.xmdg018_desc
                     DISPLAY BY NAME g_xmdg_m.xmdg018,g_xmdg_m.xmdg018_desc
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL s_desc_get_acc_desc('263',g_xmdg_m.xmdg018) RETURNING g_xmdg_m.xmdg018_desc
            DISPLAY BY NAME g_xmdg_m.xmdg018_desc
            LET g_xmdg_m_o.xmdg018 = g_xmdg_m.xmdg018]]>
  </point>
  <point name="input.a.xmdg019" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_xmdg_m.xmdg019_desc = ''
            DISPLAY BY NAME g_xmdg_m.xmdg019_desc
            IF NOT cl_null(g_xmdg_m.xmdg019) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_xmdg_m.xmdg019 != g_xmdg_m_o.xmdg019 OR g_xmdg_m_o.xmdg019 IS NULL )) THEN
                  CALL s_apmi011_check_location(g_xmdg_m.xmdg018,g_xmdg_m.xmdg019) RETURNING l_success
                  IF NOT l_success THEN
                     LET g_xmdg_m.xmdg019 = g_xmdg_m_o.xmdg019
                     CALL s_apmi011_location_ref(g_xmdg_m.xmdg018,g_xmdg_m.xmdg019) RETURNING g_xmdg_m.xmdg019_desc
                     DISPLAY BY NAME g_xmdg_m.xmdg019,g_xmdg_m.xmdg019_desc
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL s_apmi011_location_ref(g_xmdg_m.xmdg018,g_xmdg_m.xmdg019) RETURNING g_xmdg_m.xmdg019_desc
            DISPLAY BY NAME g_xmdg_m.xmdg019_desc
            LET g_xmdg_m_o.xmdg019 = g_xmdg_m.xmdg019]]>
  </point>
  <point name="input.a.xmdg020" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_xmdg_m.xmdg020_desc = ''
            DISPLAY BY NAME g_xmdg_m.xmdg020_desc
            IF NOT cl_null(g_xmdg_m.xmdg020) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_xmdg_m.xmdg020 != g_xmdg_m_o.xmdg020 OR g_xmdg_m_o.xmdg020 IS NULL )) THEN
                  CALL s_apmi011_check_location(g_xmdg_m.xmdg018,g_xmdg_m.xmdg020) RETURNING l_success
                  IF NOT l_success THEN
                     LET g_xmdg_m.xmdg020 = g_xmdg_m_o.xmdg020
                     CALL s_apmi011_location_ref(g_xmdg_m.xmdg018,g_xmdg_m.xmdg020) RETURNING g_xmdg_m.xmdg020_desc
                     DISPLAY BY NAME g_xmdg_m.xmdg020,g_xmdg_m.xmdg020_desc
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL s_apmi011_location_ref(g_xmdg_m.xmdg018,g_xmdg_m.xmdg020) RETURNING g_xmdg_m.xmdg020_desc
            DISPLAY BY NAME g_xmdg_m.xmdg020_desc
            LET g_xmdg_m_o.xmdg020 = g_xmdg_m.xmdg020]]>
  </point>
  <point name="input.a.xmdg021" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_xmdg_m_o.xmdg021 = g_xmdg_m.xmdg021]]>
  </point>
  <point name="input.a.xmdg022" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_xmdg_m_o.xmdg022 = g_xmdg_m.xmdg022
                      ]]>
  </point>
  <point name="input.a.xmdg023" order="" ver="17" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_xmdg_m.xmdg023_desc = ''
            DISPLAY BY NAME g_xmdg_m.xmdg023_desc
            IF NOT cl_null(g_xmdg_m.xmdg023) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_xmdg_m.xmdg023 != g_xmdg_m_o.xmdg023 OR g_xmdg_m_o.xmdg023 IS NULL )) THEN
                  INITIALIZE g_chkparam.* TO NULL
                  LET g_chkparam.arg1 = g_xmdg_m.xmdg005
                  LET g_chkparam.arg2 = g_xmdg_m.xmdg023
                  IF NOT cl_chk_exist("v_xmao002") THEN
                     LET g_xmdg_m.xmdg023 = g_xmdg_m_o.xmdg023
                     CALL axmt520_xmdg023_ref()
                     DISPLAY BY NAME g_xmdg_m.xmdg023
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL axmt520_xmdg023_ref()
            LET g_xmdg_m_o.xmdg023 = g_xmdg_m.xmdg023]]>
  </point>
  <point name="input.a.xmdg024" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_xmdg_m_o.xmdg024 = g_xmdg_m.xmdg024
                       ]]>
  </point>
  <point name="input.a.xmdg025" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_xmdg_m_o.xmdg025 = g_xmdg_m.xmdg025
                       ]]>
  </point>
  <point name="input.a.xmdg026" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_xmdg_m.xmdg026_desc = ''
            DISPLAY BY NAME g_xmdg_m.xmdg026_desc
            IF NOT cl_null(g_xmdg_m.xmdg026) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_xmdg_m.xmdg026 != g_xmdg_m_o.xmdg026 OR g_xmdg_m_o.xmdg026 IS NULL )) THEN
                  IF NOT s_azzi650_chk_exist('275',g_xmdg_m.xmdg026) THEN
                     LET g_xmdg_m.xmdg026 = g_xmdg_m_o.xmdg026
                     CALL s_desc_get_acc_desc('275',g_xmdg_m.xmdg026) RETURNING g_xmdg_m.xmdg026_desc
                     DISPLAY BY NAME g_xmdg_m.xmdg026,g_xmdg_m.xmdg026_desc
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL s_desc_get_acc_desc('275',g_xmdg_m.xmdg026) RETURNING g_xmdg_m.xmdg026_desc
            DISPLAY BY NAME g_xmdg_m.xmdg026_desc
            LET g_xmdg_m_o.xmdg026 = g_xmdg_m.xmdg026]]>
  </point>
  <point name="input.a.xmdg027" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_xmdg_m.xmdg027_desc = ''
            DISPLAY BY NAME g_xmdg_m.xmdg027_desc
            IF NOT cl_null(g_xmdg_m.xmdg027) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_xmdg_m.xmdg027 != g_xmdg_m_o.xmdg027 OR g_xmdg_m_o.xmdg027 IS NULL )) THEN
                  IF NOT s_azzi650_chk_exist('295',g_xmdg_m.xmdg027) THEN
                     LET g_xmdg_m.xmdg027 = g_xmdg_m_o.xmdg027
                     CALL s_desc_get_acc_desc('295',g_xmdg_m.xmdg027) RETURNING g_xmdg_m.xmdg027_desc
                     DISPLAY BY NAME g_xmdg_m.xmdg027,g_xmdg_m.xmdg027_desc
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL s_desc_get_acc_desc('295',g_xmdg_m.xmdg027) RETURNING g_xmdg_m.xmdg027_desc
            DISPLAY BY NAME g_xmdg_m.xmdg027_desc
            LET g_xmdg_m_o.xmdg027 = g_xmdg_m.xmdg027]]>
  </point>
  <point name="input.a.xmdg028" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xmdg_m.xmdg028) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_xmdg_m.xmdg028 != g_xmdg_m_o.xmdg028 OR g_xmdg_m_o.xmdg028 IS NULL )) THEN
                  IF g_xmdg_m.xmdg028 < g_xmdg_m.xmdgdocdt THEN
                     INITIALIZE g_errparam TO NULL
                     LET g_errparam.code = 'axm-00143'
                     LET g_errparam.extend = g_xmdg_m.xmdg028
                     LET g_errparam.popup = TRUE
                     CALL cl_err()
                     LET g_xmdg_m.xmdg028 = g_xmdg_m_o.xmdg028
                     DISPLAY BY NAME g_xmdg_m.xmdg028
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            LET g_xmdg_m_o.xmdg028 = g_xmdg_m.xmdg028]]>
  </point>
  <point name="input.a.xmdg030" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_xmdg_m.xmdg030_desc = ''
            DISPLAY BY NAME g_xmdg_m.xmdg030_desc
            IF NOT cl_null(g_xmdg_m.xmdg030) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_xmdg_m.xmdg030 != g_xmdg_m_o.xmdg030 OR g_xmdg_m_o.xmdg030 IS NULL )) THEN
                  INITIALIZE g_chkparam.* TO NULL
                  LET g_chkparam.arg1 = '209'
                  LET g_chkparam.arg2 = g_xmdg_m.xmdg030
                  IF NOT cl_chk_exist("v_oocq002_1") THEN
                     LET g_xmdg_m.xmdg030 = g_xmdg_m_o.xmdg030
                     CALL s_desc_get_acc_desc('209',g_xmdg_m.xmdg030) RETURNING g_xmdg_m.xmdg030_desc
                     DISPLAY BY NAME g_xmdg_m.xmdg030,g_xmdg_m.xmdg030_desc
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL s_desc_get_acc_desc('209',g_xmdg_m.xmdg030) RETURNING g_xmdg_m.xmdg030_desc
            DISPLAY BY NAME g_xmdg_m.xmdg030_desc
            LET g_xmdg_m_o.xmdg030 = g_xmdg_m.xmdg030]]>
  </point>
  <point name="input.a.xmdg031" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_xmdg_m.xmdg031_desc = ''
            DISPLAY BY NAME g_xmdg_m.xmdg031_desc
            IF NOT cl_null(g_xmdg_m.xmdg031) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_xmdg_m.xmdg031 != g_xmdg_m_o.xmdg031 OR g_xmdg_m_o.xmdg031 IS NULL )) THEN
                  IF NOT s_azzi650_chk_exist('297',g_xmdg_m.xmdg031) THEN
                     LET g_xmdg_m.xmdg031 = g_xmdg_m_o.xmdg031
                     CALL s_desc_get_acc_desc('297',g_xmdg_m.xmdg031) RETURNING g_xmdg_m.xmdg031_desc
                     DISPLAY BY NAME g_xmdg_m.xmdg031,g_xmdg_m.xmdg031_desc
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL s_desc_get_acc_desc('297',g_xmdg_m.xmdg031) RETURNING g_xmdg_m.xmdg031_desc
            DISPLAY BY NAME g_xmdg_m.xmdg031_desc
            LET g_xmdg_m_o.xmdg031 = g_xmdg_m.xmdg031]]>
  </point>
  <point name="input.a.xmdg032" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xmdg_m.xmdg032) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_xmdg_m.xmdg032 != g_xmdg_m_o.xmdg032 OR g_xmdg_m_o.xmdg032 IS NULL )) THEN
                  IF NOT cl_null(g_xmdg_m.xmdg014) THEN
                     CALL s_axmt540_get_exchange(g_xmdg_m.xmdg032,g_xmdg_m.xmdg014) RETURNING g_xmdg_m.xmdg015
                     DISPLAY BY NAME g_xmdg_m.xmdg015
                  END IF
               END IF
            END IF
            LET g_xmdg_m_o.xmdg032 = g_xmdg_m.xmdg032
            LET g_xmdg_m_o.xmdg015 = g_xmdg_m.xmdg015]]>
  </point>
  <point name="input.a.xmdg033" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_xmdg_m_o.xmdg033 = g_xmdg_m.xmdg033]]>
  </point>
  <point name="input.a.xmdg034" order="" ver="13" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_xmdg_m_o.xmdg034 = g_xmdg_m.xmdg034
            CALL axmt520_set_entry(p_cmd)
            CALL axmt520_set_no_entry(p_cmd)
            ]]>
  </point>
  <point name="input.a.xmdg053" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_xmdg_m_o.xmdg053 = g_xmdg_m.xmdg053
                       ]]>
  </point>
  <point name="input.a.xmdg054" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_xmdg_m_o.xmdg054 = g_xmdg_m.xmdg054]]>
  </point>
  <point name="input.a.xmdg055" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_xmdg_m_o.xmdg054 = g_xmdg_m.xmdg054]]>
  </point>
  <point name="input.a.xmdg056" order="" ver="13" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_xmdg_m.xmdg056_desc = ''
            DISPLAY BY NAME g_xmdg_m.xmdg056_desc
            IF NOT cl_null(g_xmdg_m.xmdg056) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_xmdg_m.xmdg056 != g_xmdg_m_o.xmdg056 OR g_xmdg_m_o.xmdg056 IS NULL )) THEN
                  INITIALIZE g_chkparam.* TO NULL
                  LET g_chkparam.arg1 = g_xmdg_m.xmdg056
                  LET g_chkparam.arg2 = g_site
                  IF NOT cl_chk_exist("v_icaa001_7") THEN
                     LET g_xmdg_m.xmdg056 = g_xmdg_m_o.xmdg056
                     CALL s_desc_get_icaa001_desc(g_xmdg_m.xmdg056) RETURNING g_xmdg_m.xmdg056_desc
                     DISPLAY BY NAME g_xmdg_m.xmdg056,g_xmdg_m.xmdg056_desc
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            CALL s_desc_get_icaa001_desc(g_xmdg_m.xmdg056) RETURNING g_xmdg_m.xmdg056_desc
            DISPLAY BY NAME g_xmdg_m.xmdg056_desc
            LET g_xmdg_m_o.xmdg056 = g_xmdg_m.xmdg056
]]>
  </point>
  <point name="input.a.xmdg202" order="" ver="16" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_xmdg_m.xmdg202_desc = ''
            DISPLAY BY NAME g_xmdg_m.xmdg202_desc
            IF NOT cl_null(g_xmdg_m.xmdg202) THEN
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_xmdg_m.xmdg202 != g_xmdg_m_o.xmdg202 OR g_xmdg_m_o.xmdg202 IS NULL )) THEN
                  IF g_xmdg_m.xmdg202 <> g_xmdg_m.xmdg005 THEN
                     INITIALIZE g_chkparam.* TO NULL
                     LET g_chkparam.arg1 = g_xmdg_m.xmdg005
                     LET g_chkparam.arg2 = g_xmdg_m.xmdg202
                     LET g_chkparam.arg3 = g_site
                     IF NOT cl_chk_exist("v_pmac002_6") THEN
                        LET g_xmdg_m.xmdg202 = g_xmdg_m_o.xmdg202
                        CALL s_desc_get_trading_partner_abbr_desc(g_xmdg_m.xmdg202) RETURNING g_xmdg_m.xmdg202_desc
                        DISPLAY BY NAME g_xmdg_m.xmdg202,g_xmdg_m.xmdg202_desc
                        NEXT FIELD CURRENT
                     END IF
                  END IF
               END IF
            END IF
            CALL s_desc_get_trading_partner_abbr_desc(g_xmdg_m.xmdg202) RETURNING g_xmdg_m.xmdg202_desc
            DISPLAY BY NAME g_xmdg_m.xmdg202_desc
            LET g_xmdg_m_o.xmdg202 = g_xmdg_m.xmdg202]]>
  </point>
  <point name="input.a.xmdgdocdt" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.a.xmdgdocno" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_xmdg_m.xmdgdocno_desc = ''
            DISPLAY BY NAME g_xmdg_m.xmdgdocno_desc
            IF cl_null(g_xmdg_m.xmdgdocno) THEN 
               INITIALIZE g_errparam TO NULL
               LET g_errparam.code = 'apm-00532'
               LET g_errparam.extend = ''
               LET g_errparam.popup = FALSE
               CALL cl_err()
               NEXT FIELD CURRENT
            ELSE
               IF p_cmd = 'a' OR (p_cmd = 'u' AND (g_xmdg_m.xmdgdocno != g_xmdgdocno_t OR g_xmdgdocno_t IS NULL )) THEN
                  IF NOT axmt520_xmdgdocno_chk() THEN
                     LET g_xmdg_m.xmdgdocno = g_xmdgdocno_t
                     CALL s_aooi200_get_slip_desc(g_xmdg_m.xmdgdocno) RETURNING g_xmdg_m.xmdgdocno_desc
                     DISPLAY BY NAME g_xmdg_m.xmdgdocno,g_xmdg_m.xmdgdocno_desc
                     NEXT FIELD CURRENT
                  END IF
                  CALL axmt520_doc_default()
               END IF
            END IF
            CALL s_aooi200_get_slip_desc(g_xmdg_m.xmdgdocno) RETURNING g_xmdg_m.xmdgdocno_desc
            DISPLAY BY NAME g_xmdg_m.xmdgdocno_desc]]>
  </point>
  <point name="input.a.xmdgsite" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="input.a.xmdgstus" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.accept" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="input.after_define_sql" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="input.after_define_sql2" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[     ]]>
  </point>
  <point name="input.after_input" order="" ver="8" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[     ]]>
  </point>
  <point name="input.after_set_entry" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[     ]]>
  </point>
  <point name="input.b.page1.xmdh001" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="input.b.page1.xmdh002" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="input.b.page1.xmdh003" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="input.b.page1.xmdh004" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="input.b.page1.xmdh005" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                         ]]>
  </point>
  <point name="input.b.page1.xmdh006" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.b.page1.xmdh007" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="input.b.page1.xmdh008" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.b.page1.xmdh009" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.b.page1.xmdh010" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.b.page1.xmdh011" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.b.page1.xmdh012" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.b.page1.xmdh013" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.b.page1.xmdh014" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                     ]]>
  </point>
  <point name="input.b.page1.xmdh015" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.b.page1.xmdh016" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.b.page1.xmdh017" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.b.page1.xmdh018" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.b.page1.xmdh019" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.b.page1.xmdh020" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.b.page1.xmdh021" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.b.page1.xmdh022" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.b.page1.xmdh029" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="input.b.page1.xmdh030" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.b.page1.xmdh031" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.b.page1.xmdh032" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.b.page1.xmdh033" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.b.page1.xmdh034" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.b.page1.xmdh036" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.b.page1.xmdh050" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.b.page1.xmdh051" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="input.b.page1.xmdh052" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="input.b.page1.xmdhseq" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        ]]>
  </point>
  <point name="input.b.page1.xmdhsite" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="input.b.page2.xmdi001" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        ]]>
  </point>
  <point name="input.b.page2.xmdi002" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        ]]>
  </point>
  <point name="input.b.page2.xmdi003" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        ]]>
  </point>
  <point name="input.b.page2.xmdi004" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        ]]>
  </point>
  <point name="input.b.page2.xmdi005" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        ]]>
  </point>
  <point name="input.b.page2.xmdi006" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        ]]>
  </point>
  <point name="input.b.page2.xmdi007" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        ]]>
  </point>
  <point name="input.b.page2.xmdi008" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        ]]>
  </point>
  <point name="input.b.page2.xmdi009" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        ]]>
  </point>
  <point name="input.b.page2.xmdi010" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        ]]>
  </point>
  <point name="input.b.page2.xmdi011" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        ]]>
  </point>
  <point name="input.b.page2.xmdi012" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        ]]>
  </point>
  <point name="input.b.page2.xmdiseq" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        ]]>
  </point>
  <point name="input.b.page2.xmdiseq1" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        ]]>
  </point>
  <point name="input.b.page4.xmdh023" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        ]]>
  </point>
  <point name="input.b.page4.xmdh024" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        ]]>
  </point>
  <point name="input.b.page4.xmdh025" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        ]]>
  </point>
  <point name="input.b.page4.xmdh026" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        ]]>
  </point>
  <point name="input.b.page4.xmdh027" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        ]]>
  </point>
  <point name="input.b.page4.xmdh028" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        ]]>
  </point>
  <point name="input.b.xmdg001" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.b.xmdg002" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.b.xmdg003" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.b.xmdg004" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.b.xmdg005" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.b.xmdg006" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF cl_null(g_xmdg_m.xmdg005) THEN
               #請先輸入客戶編號
               INITIALIZE g_errparam TO NULL
               LET g_errparam.code = 'axm-00145'
               LET g_errparam.extend = ''
               LET g_errparam.popup = TRUE
               CALL cl_err()
               NEXT FIELD xmdg005
            END IF]]>
  </point>
  <point name="input.b.xmdg007" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF cl_null(g_xmdg_m.xmdg005) THEN
               #請先輸入客戶編號
               INITIALIZE g_errparam TO NULL
               LET g_errparam.code = 'axm-00145'
               LET g_errparam.extend = ''
               LET g_errparam.popup = TRUE
               CALL cl_err()
               NEXT FIELD xmdg005
            END IF]]>
  </point>
  <point name="input.b.xmdg008" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF cl_null(g_xmdg_m.xmdg005) THEN
               #請先輸入客戶編號
               INITIALIZE g_errparam TO NULL
               LET g_errparam.code = 'axm-00145'
               LET g_errparam.extend = ''
               LET g_errparam.popup = TRUE
               CALL cl_err()
               NEXT FIELD xmdg005
            END IF]]>
  </point>
  <point name="input.b.xmdg009" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.b.xmdg010" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.b.xmdg011" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.b.xmdg012" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.b.xmdg013" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.b.xmdg014" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.b.xmdg015" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.b.xmdg016" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.b.xmdg017" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF cl_null(g_xmdg_m.xmdg007) THEN
               #請先輸入收貨客戶
               INITIALIZE g_errparam TO NULL
               LET g_errparam.code = 'axm-00146'
               LET g_errparam.extend = ''
               LET g_errparam.popup = TRUE
               CALL cl_err()
               NEXT FIELD xmdg007
            END IF]]>
  </point>
  <point name="input.b.xmdg018" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.b.xmdg019" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF cl_null(g_xmdg_m.xmdg018) THEN
               #請先輸入運輸方式
               INITIALIZE g_errparam TO NULL
               LET g_errparam.code = 'axm-00085'
               LET g_errparam.extend = ''
               LET g_errparam.popup = TRUE
               CALL cl_err()
               NEXT FIELD xmdg018
            END IF]]>
  </point>
  <point name="input.b.xmdg020" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF cl_null(g_xmdg_m.xmdg018) THEN
               #請先輸入運輸方式   
               INITIALIZE g_errparam TO NULL
               LET g_errparam.code = 'axm-00085'
               LET g_errparam.extend = ''
               LET g_errparam.popup = TRUE
               CALL cl_err()
               NEXT FIELD xmdg018
            END IF]]>
  </point>
  <point name="input.b.xmdg021" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.b.xmdg022" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.b.xmdg023" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF cl_null(g_xmdg_m.xmdg005) THEN
               #請先輸入客戶編號
               INITIALIZE g_errparam TO NULL
               LET g_errparam.code = 'axm-00145'
               LET g_errparam.extend = ''
               LET g_errparam.popup = TRUE
               CALL cl_err()
               NEXT FIELD xmdg005
            END IF]]>
  </point>
  <point name="input.b.xmdg024" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.b.xmdg025" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.b.xmdg026" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.b.xmdg027" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.b.xmdg028" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.b.xmdg030" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.b.xmdg031" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.b.xmdg032" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="input.b.xmdg033" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="input.b.xmdg053" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.b.xmdg054" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="input.b.xmdg055" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="input.b.xmdg202" order="" ver="12" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF cl_null(g_xmdg_m.xmdg005) THEN
               #請先輸入客戶編號
               INITIALIZE g_errparam TO NULL
               LET g_errparam.code = 'axm-00145'
               LET g_errparam.extend = ''
               LET g_errparam.popup = TRUE
               CALL cl_err()
               NEXT FIELD xmdg005
            END IF]]>
  </point>
  <point name="input.b.xmdgdocdt" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.b.xmdgdocno" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                                            ]]>
  </point>
  <point name="input.b.xmdgsite" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="input.b.xmdgstus" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.before_dialog" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                 ]]>
  </point>
  <point name="input.before_input" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   LET g_errshow = 1]]>
  </point>
  <point name="input.body.a_delete" order="" ver="13" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="input.body.a_insert" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                             ]]>
  </point>
  <point name="input.body.a_insert2" order="" ver="13" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[               IF NOT axmt540_01_xmdm_modify('2',l_xmdhseq_backup,g_site,g_xmdg_m.xmdgdocno,g_xmdh_d[l_ac].xmdhseq,
                                             g_xmdh_d[l_ac].xmdh006,g_xmdh_d[l_ac].xmdh007,g_xmdh_d[l_ac].xmdh009,
                                             g_xmdh_d[l_ac].xmdh010,g_xmdh_d[l_ac].xmdh012,g_xmdh_d[l_ac].xmdh013,
                                             g_xmdh_d[l_ac].xmdh014,g_xmdh_d[l_ac].xmdh029,g_xmdh_d[l_ac].xmdh015,
                                             g_xmdh_d[l_ac].xmdh016,g_xmdh_d[l_ac].xmdh018,g_xmdh_d[l_ac].xmdh019,
                                             '','') THEN
                  CALL s_transaction_end('N','0')
                  CANCEL INSERT
               END IF
               IF NOT axmt520_upd_xmdd031(g_xmdh_d[l_ac].xmdh001,g_xmdh_d[l_ac].xmdh002,g_xmdh_d[l_ac].xmdh003,
                                          g_xmdh_d[l_ac].xmdh004,g_xmdh_d[l_ac].xmdh016,g_xmdh_d_t.xmdh016) THEN
                  CALL s_transaction_end('N','0')
                  CANCEL INSERT
               END IF]]>
  </point>
  <point name="input.body.a_update" order="" ver="13" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[               IF NOT axmt540_01_xmdm_modify('2',l_xmdhseq_backup,g_site,g_xmdg_m.xmdgdocno,g_xmdh_d[l_ac].xmdhseq,
                                             g_xmdh_d[l_ac].xmdh006,g_xmdh_d[l_ac].xmdh007,g_xmdh_d[l_ac].xmdh009,
                                             g_xmdh_d[l_ac].xmdh010,g_xmdh_d[l_ac].xmdh012,g_xmdh_d[l_ac].xmdh013,
                                             g_xmdh_d[l_ac].xmdh014,g_xmdh_d[l_ac].xmdh029,g_xmdh_d[l_ac].xmdh015,
                                             g_xmdh_d[l_ac].xmdh016,g_xmdh_d[l_ac].xmdh018,g_xmdh_d[l_ac].xmdh019,
                                             '','') THEN
                  CALL s_transaction_end('N','0')
               END IF
               IF NOT axmt520_upd_xmdd031(g_xmdh_d[l_ac].xmdh001,g_xmdh_d[l_ac].xmdh002,g_xmdh_d[l_ac].xmdh003,
                                          g_xmdh_d[l_ac].xmdh004,g_xmdh_d[l_ac].xmdh016,g_xmdh_d_t.xmdh016) THEN
                  CALL s_transaction_end('N','0')
               END IF
               ]]>
  </point>
  <point name="input.body.after_delete" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.body.after_input" order="" ver="8" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF s_transaction_chk("N",0) THEN
               CALL s_transaction_begin()
            END IF
            CALL axmt520_total_count()
            CALL s_transaction_end('Y','0')
            CALL axmt520_b_fill()
]]>
  </point>
  <point name="input.body.after_row" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.body.after_row2" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="input.body.after_set_entry_b" order="" ver="13" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[               IF cl_null(g_xmdh_d[l_ac].xmdh002) THEN
                  LET g_flag = 'Y'
               ELSE
                  LET g_flag = 'N'
               END IF
]]>
  </point>
  <point name="input.body.b_a_insert" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.body.b_delete" order="" ver="13" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[               
               #依據出貨明細的的實際出貨數量更新對應的訂的交期名細中的已轉出貨量(xmdd031)
               IF NOT s_axmt520_upd_xmdd031(g_xmdg_m.xmdgdocno,g_xmdh_d_t.xmdhseq) THEN
                  CALL s_transaction_end('N','0')
                  CANCEL DELETE
               END IF
]]>
  </point>
  <point name="input.body.b_insert" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                             ]]>
  </point>
  <point name="input.body.b_update" order="" ver="13" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[               IF cl_null(g_xmdh_d[l_ac].xmdhsite) THEN
                  LET g_xmdh_d[l_ac].xmdhsite = g_site
               END IF]]>
  </point>
  <point name="input.body.before_input2" order="" ver="13" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET l_cnt = 0
            SELECT COUNT(*) INTO l_cnt
              FROM xmdh_t
             WHERE xmdhent = g_enterprise
               AND xmdhdocno = g_xmdg_m.xmdgdocno
            IF cl_null(l_cnt) OR l_cnt = 0 THEN
               IF NOT cl_null(g_xmdg_m.xmdg004) THEN
                  IF g_argv[01] = '8' THEN
                     IF cl_ask_confirm('axm-00566') THEN   #是否由[借貨訂單axmt501]自動產生單身資料？
                        CALL s_transaction_begin()
                        LET l_success = ''
                        CALL axmt520_gen_xmdh()  #自動產生單身
                             RETURNING l_success
                        IF NOT l_success THEN 
                           CALL s_transaction_end('N','0')
                        END IF
                        CALL s_transaction_end('Y','0')
                     END IF
                  ELSE
                     IF cl_ask_confirm('axm-00140') THEN   #是否由[訂單axmt500]自動產生單身資料！
                        CALL s_transaction_begin()
                        LET l_success = ''
                        CALL axmt520_gen_xmdh()  #自動產生單身
                             RETURNING l_success
                        IF NOT l_success THEN 
                           CALL s_transaction_end('N','0')
                        END IF
                        CALL s_transaction_end('Y','0')
                     END IF
                  END IF
               END IF
            END IF]]>
  </point>
  <point name="input.body.before_insert" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            SELECT MAX(xmdhseq)+1 INTO g_xmdh_d[l_ac].xmdhseq
              FROM xmdh_t
             WHERE xmdhent = g_enterprise
               AND xmdhdocno = g_xmdg_m.xmdgdocno
            IF cl_null(g_xmdh_d[l_ac].xmdhseq) OR g_xmdh_d[l_ac].xmdhseq = 0 THEN
               LET g_xmdh_d[l_ac].xmdhseq = 1
            END IF
            #若單頭有輸入訂單號，則單身的訂單號預設單頭的訂單號
            IF NOT cl_null(g_xmdg_m.xmdg004) THEN
               LET g_xmdh_d[l_ac].xmdh001 = g_xmdg_m.xmdg004
            END IF
            LET g_xmdh_d[l_ac].xmdhsite = g_site
            LET g_xmdh_d[l_ac].xmdh007 = ' '
            LET g_xmdh_d[l_ac].xmdh012 = ' '
            LET g_xmdh_d[l_ac].xmdh013 = ' '
            LET g_xmdh_d[l_ac].xmdh014 = ' '
            LET g_xmdh_d_t.* = g_xmdh_d[l_ac].*
            LET g_xmdh_d_o.* = g_xmdh_d[l_ac].*
            
            LET l_xmdhseq_backup = g_xmdh_d[l_ac].xmdhseq   #備份多庫儲批項次]]>
  </point>
  <point name="input.body.before_row" order="" ver="13" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET l_xmdhseq_backup = g_xmdh_d[l_ac].xmdhseq  #備份多庫儲批項次

]]>
  </point>
  <point name="input.body.before_row2" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="input.body.insert.after_set_entry_b" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="input.body.insert.before_bak" order="" ver="12" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="input.body.m_delete" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                             ]]>
  </point>
  <point name="input.body.m_update" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                             ]]>
  </point>
  <point name="input.body2.a_delete" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                                    ]]>
  </point>
  <point name="input.body2.a_insert" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                              ]]>
  </point>
  <point name="input.body2.a_update" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                              ]]>
  </point>
  <point name="input.body2.action" order="" ver="8" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            CALL axmt520_b_fill()]]>
  </point>
  <point name="input.body2.after_delete" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        ]]>
  </point>
  <point name="input.body2.after_input" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        ]]>
  </point>
  <point name="input.body2.after_insert" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                              ]]>
  </point>
  <point name="input.body2.after_row" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        ]]>
  </point>
  <point name="input.body2.after_set_entry_b" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                              ]]>
  </point>
  <point name="input.body2.b_a_insert" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        ]]>
  </point>
  <point name="input.body2.b_delete" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                              ]]>
  </point>
  <point name="input.body2.b_insert" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                              ]]>
  </point>
  <point name="input.body2.b_update" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[               IF cl_null(g_xmdh2_d[l_ac].xmdisite) THEN
                  LET g_xmdh2_d[l_ac].xmdisite = g_site
               END IF]]>
  </point>
  <point name="input.body2.before_input" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        ]]>
  </point>
  <point name="input.body2.before_insert" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        ]]>
  </point>
  <point name="input.body2.before_row" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.body2.insert.after_set_entry_b" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        ]]>
  </point>
  <point name="input.body2.m_delete" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                              ]]>
  </point>
  <point name="input.body2.m_update" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                              ]]>
  </point>
  <point name="input.body3.action" order="" ver="8" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            CALL axmt520_b_fill()
]]>
  </point>
  <point name="input.body3.before_row" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        ]]>
  </point>
  <point name="input.body4.a_delete" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                                    ]]>
  </point>
  <point name="input.body4.a_insert" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                              ]]>
  </point>
  <point name="input.body4.a_update" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                              ]]>
  </point>
  <point name="input.body4.action" order="" ver="8" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            CALL axmt520_b_fill()]]>
  </point>
  <point name="input.body4.after_delete" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        ]]>
  </point>
  <point name="input.body4.after_input" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        ]]>
  </point>
  <point name="input.body4.after_insert" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                              ]]>
  </point>
  <point name="input.body4.after_row" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        ]]>
  </point>
  <point name="input.body4.after_set_entry_b" order="" ver="3" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="input.body4.b_a_insert" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        ]]>
  </point>
  <point name="input.body4.b_delete" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                              ]]>
  </point>
  <point name="input.body4.b_insert" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                              ]]>
  </point>
  <point name="input.body4.b_update" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                              ]]>
  </point>
  <point name="input.body4.before_input" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        ]]>
  </point>
  <point name="input.body4.before_insert" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        ]]>
  </point>
  <point name="input.body4.before_row" order="" ver="8" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            CALL axmt520_b_fill()]]>
  </point>
  <point name="input.body4.insert.after_set_entry_b" order="" ver="3" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="input.body4.m_delete" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                              ]]>
  </point>
  <point name="input.body4.m_update" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                              ]]>
  </point>
  <point name="input.c.page1.xmdh001" order="" ver="19" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
	   		LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_xmdh_d[l_ac].xmdh001  #給予default值
            LET g_qryparam.where = "1=1 "
            IF g_argv[01] = '8' THEN
   	   		LET g_qryparam.where = " xmda005 = '8' "
   	      ELSE
   	   		LET g_qryparam.where = " xmda005 <> '8' "
            END IF
            IF NOT cl_null(g_xmdg_m.xmdg005) THEN
               LET g_qryparam.where = g_qryparam.where ," AND xmda004 = '",g_xmdg_m.xmdg005,"' "
            END IF
            IF NOT cl_null(g_xmdg_m.xmdg001) THEN
               LET g_qryparam.where = g_qryparam.where ," AND xmda005 = '",g_xmdg_m.xmdg001,"' "
            END IF
            #add by shiun------------(S)
            IF NOT cl_null(g_xmdg_m.xmdg034) THEN
               LET g_qryparam.where = g_qryparam.where ," AND xmda006 = '",g_xmdg_m.xmdg034,"' "
            END IF
            #add by shiun------------(E)
            IF NOT cl_null(g_xmdg_m.xmdg008) THEN
               LET g_qryparam.where = g_qryparam.where ," AND xmda009 = '",g_xmdg_m.xmdg008,"' "
            END IF
            IF NOT cl_null(g_xmdg_m.xmdg009) THEN
               LET g_qryparam.where = g_qryparam.where ," AND xmda010 = '",g_xmdg_m.xmdg009,"' "
            END IF
            IF NOT cl_null(g_xmdg_m.xmdg010) THEN
               LET g_qryparam.where = g_qryparam.where ," AND xmda011 = '",g_xmdg_m.xmdg010,"' "
            END IF
            IF NOT cl_null(g_xmdg_m.xmdg014) THEN
               LET g_qryparam.where = g_qryparam.where ," AND xmda015 = '",g_xmdg_m.xmdg014,"' "
            END IF
            IF NOT cl_null(g_xmdg_m.xmdg006) THEN
               LET g_qryparam.where = g_qryparam.where ," AND xmda021 = '",g_xmdg_m.xmdg006,"' "
            END IF
            IF NOT cl_null(g_xmdg_m.xmdg007) THEN
               LET g_qryparam.where = g_qryparam.where ," AND xmda022 = '",g_xmdg_m.xmdg007,"' "
            END IF
            IF NOT cl_null(g_xmdg_m.xmdg013) THEN
               LET g_qryparam.where = g_qryparam.where ," AND xmda035 = '",g_xmdg_m.xmdg013,"' "
            END IF
            CALL q_xmdddocno_3()                             #呼叫開窗
            LET g_xmdh_d[l_ac].xmdh001 = g_qryparam.return1  #將開窗取得的值回傳到變數
            DISPLAY g_xmdh_d[l_ac].xmdh001 TO xmdh001        #顯示到畫面上
            NEXT FIELD xmdh001                               #返回原欄位]]>
  </point>
  <point name="input.c.page1.xmdh002" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.c.page1.xmdh003" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.c.page1.xmdh004" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.c.page1.xmdh005" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.c.page1.xmdh006" order="" ver="12" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
	   		LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_xmdh_d[l_ac].xmdh006  #給予default值
            LET g_qryparam.where = "1=1 "
            CALL s_control_get_item_sql('2',g_site,g_user,g_dept,g_xmdg_m.xmdgdocno) RETURNING l_success,l_where
            IF l_success THEN
               LET g_qryparam.where = g_qryparam.where ," AND ",l_where
            END IF            
            IF g_flag = 'Y' THEN  #訂單費用料號
               LET g_qryparam.where = g_qryparam.where,
                                      " AND imaf001 IN (SELECT xmds001 FROM xmds_t",
                                      "                  WHERE xmdsent = ",g_enterprise,
                                      "                    AND xmdsdocno = '",g_xmdh_d[l_ac].xmdh001,"')"
               CALL q_imaf001_17()
            ELSE
               CALL q_imaf001_15()                            #呼叫開窗
            END IF
            LET g_xmdh_d[l_ac].xmdh006 = g_qryparam.return1   #將開窗取得的值回傳到變數
            DISPLAY g_xmdh_d[l_ac].xmdh006 TO xmdh006         #顯示到畫面上
            CALL s_desc_get_item_desc(g_xmdh_d[l_ac].xmdh006) RETURNING g_xmdh_d[l_ac].xmdh006_desc,g_xmdh_d[l_ac].xmdh006_desc_desc
            NEXT FIELD xmdh006                                #返回原欄位]]>
  </point>
  <point name="input.c.page1.xmdh007" order="" ver="8" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET l_imaa005 = ''
            CALL s_axmt500_get_imaa005(g_enterprise,g_xmdh_d[l_ac].xmdh006) RETURNING l_imaa005
            IF NOT cl_null(l_imaa005) THEN
               CALL s_feature_single(g_xmdh_d[l_ac].xmdh006,g_xmdh_d[l_ac].xmdh007,g_site,g_xmdg_m.xmdgdocno)
                    RETURNING l_success,g_xmdh_d[l_ac].xmdh007
            END IF
            CALL s_feature_description(g_xmdh_d[l_ac].xmdh006,g_xmdh_d[l_ac].xmdh007) RETURNING l_success,g_xmdh_d[l_ac].xmdh007_desc
            ]]>
  </point>
  <point name="input.c.page1.xmdh008" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
	   		LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_xmdh_d[l_ac].xmdh008  #給予default值
            CALL q_imaf001_5()                                #呼叫開窗
            LET g_xmdh_d[l_ac].xmdh008 = g_qryparam.return1   #將開窗取得的值回傳到變數
            DISPLAY g_xmdh_d[l_ac].xmdh008 TO xmdh008         #顯示到畫面上
            NEXT FIELD xmdh008                                #返回原欄位]]>
  </point>
  <point name="input.c.page1.xmdh009" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
	   		LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_xmdh_d[l_ac].xmdh009  #給予default值
            LET g_qryparam.arg1 = "221" 
            CALL q_oocq002()                                  #呼叫開窗
            LET g_xmdh_d[l_ac].xmdh009 = g_qryparam.return1   #將開窗取得的值回傳到變數
            DISPLAY g_xmdh_d[l_ac].xmdh009 TO xmdh009         #顯示到畫面上
            CALL s_desc_get_acc_desc('221',g_xmdh_d[l_ac].xmdh009) RETURNING g_xmdh_d[l_ac].xmdh009_desc
            NEXT FIELD xmdh009                                #返回原欄位]]>
  </point>
  <point name="input.c.page1.xmdh010" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.c.page1.xmdh011" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.c.page1.xmdh012" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
	   		LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_xmdh_d[l_ac].xmdh012  #給予default值
            LET g_qryparam.arg1 = g_xmdh_d[l_ac].xmdh006
            LET g_qryparam.arg2 = g_xmdh_d[l_ac].xmdh007
            CALL q_inag004_1()                                #呼叫開窗
            LET g_xmdh_d[l_ac].xmdh012 = g_qryparam.return1   #將開窗取得的值回傳到變數
            LET g_xmdh_d[l_ac].xmdh013 = g_qryparam.return2 
            LET g_xmdh_d[l_ac].xmdh014 = g_qryparam.return3 
            DISPLAY g_xmdh_d[l_ac].xmdh012 TO xmdh012         #顯示到畫面上
            DISPLAY g_xmdh_d[l_ac].xmdh013 TO xmdh013
            DISPLAY g_xmdh_d[l_ac].xmdh014 TO xmdh014
            CALL s_desc_get_stock_desc(g_site,g_xmdh_d[l_ac].xmdh012) RETURNING g_xmdh_d[l_ac].xmdh012_desc
            CALL s_desc_get_locator_desc(g_site,g_xmdh_d[l_ac].xmdh012,g_xmdh_d[l_ac].xmdh013) RETURNING g_xmdh_d[l_ac].xmdh013_desc
            NEXT FIELD xmdh012                                #返回原欄位]]>
  </point>
  <point name="input.c.page1.xmdh013" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
	   		LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_xmdh_d[l_ac].xmdh013  #給予default值
            LET g_qryparam.arg1 = g_xmdh_d[l_ac].xmdh006
            LET g_qryparam.arg2 = g_xmdh_d[l_ac].xmdh007
            LET g_qryparam.arg3 = g_xmdh_d[l_ac].xmdh012
            CALL q_inag005_5()                                #呼叫開窗
            LET g_xmdh_d[l_ac].xmdh013 = g_qryparam.return1   #將開窗取得的值回傳到變數
            DISPLAY g_xmdh_d[l_ac].xmdh013 TO xmdh013         #顯示到畫面上
            CALL s_desc_get_locator_desc(g_site,g_xmdh_d[l_ac].xmdh012,g_xmdh_d[l_ac].xmdh013) RETURNING g_xmdh_d[l_ac].xmdh013_desc
            NEXT FIELD xmdh013                                #返回原欄位]]>
  </point>
  <point name="input.c.page1.xmdh014" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.c.page1.xmdh015" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
	   		LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_xmdh_d[l_ac].xmdh015  #給予default值
            LET g_qryparam.arg1 = g_xmdh_d[l_ac].xmdh006
            CALL q_imao002()                                  #呼叫開窗
            LET g_xmdh_d[l_ac].xmdh015 = g_qryparam.return1   #將開窗取得的值回傳到變數
            DISPLAY g_xmdh_d[l_ac].xmdh015 TO xmdh015         #顯示到畫面上
            CALL s_desc_get_unit_desc(g_xmdh_d[l_ac].xmdh015) RETURNING g_xmdh_d[l_ac].xmdh015_desc
            NEXT FIELD xmdh015                                #返回原欄位]]>
  </point>
  <point name="input.c.page1.xmdh016" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.c.page1.xmdh017" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.c.page1.xmdh018" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
	   		LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_xmdh_d[l_ac].xmdh018  #給予default值
            LET g_qryparam.arg1 = g_xmdh_d[l_ac].xmdh006
            CALL q_imao002()                                  #呼叫開窗
            LET g_xmdh_d[l_ac].xmdh018 = g_qryparam.return1   #將開窗取得的值回傳到變數
            DISPLAY g_xmdh_d[l_ac].xmdh018 TO xmdh018         #顯示到畫面上
            CALL s_desc_get_unit_desc(g_xmdh_d[l_ac].xmdh018) RETURNING g_xmdh_d[l_ac].xmdh018_desc
            NEXT FIELD xmdh018                                #返回原欄位]]>
  </point>
  <point name="input.c.page1.xmdh019" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.c.page1.xmdh020" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
	   		LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_xmdh_d[l_ac].xmdh020  #給予default值
            LET g_qryparam.arg1 = g_xmdh_d[l_ac].xmdh006
            CALL q_imao002()                                  #呼叫開窗
            LET g_xmdh_d[l_ac].xmdh020 = g_qryparam.return1   #將開窗取得的值回傳到變數
            DISPLAY g_xmdh_d[l_ac].xmdh020 TO xmdh020         #顯示到畫面上
            CALL s_desc_get_unit_desc(g_xmdh_d[l_ac].xmdh020) RETURNING g_xmdh_d[l_ac].xmdh020_desc
            NEXT FIELD xmdh020                                #返回原欄位]]>
  </point>
  <point name="input.c.page1.xmdh021" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.c.page1.xmdh022" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.c.page1.xmdh029" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="input.c.page1.xmdh030" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.c.page1.xmdh031" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.c.page1.xmdh032" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.c.page1.xmdh033" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.c.page1.xmdh034" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
	   		LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_xmdh_d[l_ac].xmdh034  #給予default值
            LET g_qryparam.arg1 = g_xmdg_m.xmdg005            #交易對象編號
            LET g_qryparam.arg2 = g_xmdh_d[l_ac].xmdh006      #料件編號
            LET g_qryparam.arg3 = g_xmdh_d[l_ac].xmdh007      #產品特徵
            CALL q_pmao004_1()                                #呼叫開窗
            LET g_xmdh_d[l_ac].xmdh034 = g_qryparam.return1   #將開窗取得的值回傳到變數
            DISPLAY g_xmdh_d[l_ac].xmdh034 TO xmdh034         #顯示到畫面上
            NEXT FIELD xmdh034                                #返回原欄位]]>
  </point>
  <point name="input.c.page1.xmdh036" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.c.page1.xmdh050" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.c.page1.xmdh051" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="input.c.page1.xmdh052" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="input.c.page1.xmdhseq" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        ]]>
  </point>
  <point name="input.c.page1.xmdhsite" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="input.c.page2.xmdi001" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmdh2_d[l_ac].xmdi001             #給予default值

            #給予arg

            CALL q_imaa001()                                #呼叫開窗

            LET g_xmdh2_d[l_ac].xmdi001 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmdh2_d[l_ac].xmdi001 TO xmdi001              #顯示到畫面上

            NEXT FIELD xmdi001                          #返回原欄位

]]>
  </point>
  <point name="input.c.page2.xmdi002" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        ]]>
  </point>
  <point name="input.c.page2.xmdi003" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmdh2_d[l_ac].xmdi003             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "" #

            CALL q_oocq002()                                #呼叫開窗

            LET g_xmdh2_d[l_ac].xmdi003 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmdh2_d[l_ac].xmdi003 TO xmdi003              #顯示到畫面上

            NEXT FIELD xmdi003                          #返回原欄位

]]>
  </point>
  <point name="input.c.page2.xmdi004" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        ]]>
  </point>
  <point name="input.c.page2.xmdi005" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmdh2_d[l_ac].xmdi005             #給予default值

            #給予arg
            LET g_qryparam.arg1 = g_site

            CALL q_inaa001_4()                                #呼叫開窗

            LET g_xmdh2_d[l_ac].xmdi005 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmdh2_d[l_ac].xmdi005 TO xmdi005              #顯示到畫面上

            NEXT FIELD xmdi005                          #返回原欄位

]]>
  </point>
  <point name="input.c.page2.xmdi006" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmdh2_d[l_ac].xmdi006             #給予default值

            #給予arg
            LET g_qryparam.arg1 = g_site
            LET g_qryparam.arg2 = g_xmdh_d[l_ac].xmdh012

            CALL q_inab002_8()                                #呼叫開窗

            LET g_xmdh2_d[l_ac].xmdi006 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmdh2_d[l_ac].xmdi006 TO xmdi006              #顯示到畫面上

            NEXT FIELD xmdi006                          #返回原欄位

]]>
  </point>
  <point name="input.c.page2.xmdi007" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        ]]>
  </point>
  <point name="input.c.page2.xmdi008" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmdh2_d[l_ac].xmdi008             #給予default值

            #給予arg

            CALL q_ooca001_1()                                #呼叫開窗

            LET g_xmdh2_d[l_ac].xmdi008 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmdh2_d[l_ac].xmdi008 TO xmdi008              #顯示到畫面上

            NEXT FIELD xmdi008                          #返回原欄位

]]>
  </point>
  <point name="input.c.page2.xmdi009" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        ]]>
  </point>
  <point name="input.c.page2.xmdi010" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmdh2_d[l_ac].xmdi010             #給予default值

            #給予arg

            CALL q_ooca001_1()                                #呼叫開窗

            LET g_xmdh2_d[l_ac].xmdi010 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmdh2_d[l_ac].xmdi010 TO xmdi010              #顯示到畫面上

            NEXT FIELD xmdi010                          #返回原欄位

]]>
  </point>
  <point name="input.c.page2.xmdi011" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        ]]>
  </point>
  <point name="input.c.page2.xmdi012" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        ]]>
  </point>
  <point name="input.c.page2.xmdiseq" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        ]]>
  </point>
  <point name="input.c.page2.xmdiseq1" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        ]]>
  </point>
  <point name="input.c.page4.xmdh0011" order="" ver="1" cite_std="" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmdh4_d[l_ac].xmdh0011             #給予default值

            #給予arg

            CALL q_xmdadocno_2()                                #呼叫開窗

            LET g_xmdh4_d[l_ac].xmdh0011 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmdh4_d[l_ac].xmdh0011 TO xmdh0011              #顯示到畫面上

            NEXT FIELD xmdh0011                          #返回原欄位

]]>
  </point>
  <point name="input.c.page4.xmdh001_1" order="" ver="1" cite_std="" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmdh4_d[l_ac].xmdh001_1             #給予default值

            #給予arg

            CALL q_xmdadocno_2()                                #呼叫開窗

            LET g_xmdh4_d[l_ac].xmdh001_1 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmdh4_d[l_ac].xmdh001_1 TO xmdh001_1              #顯示到畫面上

            NEXT FIELD xmdh001_1                          #返回原欄位

]]>
  </point>
  <point name="input.c.page4.xmdh0061" order="" ver="1" cite_std="" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmdh4_d[l_ac].xmdh0061             #給予default值

            #給予arg

            CALL q_imaa001()                                #呼叫開窗

            LET g_xmdh4_d[l_ac].xmdh0061 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmdh4_d[l_ac].xmdh0061 TO xmdh0061              #顯示到畫面上

            NEXT FIELD xmdh0061                          #返回原欄位

]]>
  </point>
  <point name="input.c.page4.xmdh006_1" order="" ver="1" cite_std="" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmdh4_d[l_ac].xmdh006_1             #給予default值

            #給予arg

            CALL q_imaa001()                                #呼叫開窗

            LET g_xmdh4_d[l_ac].xmdh006_1 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmdh4_d[l_ac].xmdh006_1 TO xmdh006_1              #顯示到畫面上

            NEXT FIELD xmdh006_1                          #返回原欄位

]]>
  </point>
  <point name="input.c.page4.xmdh0091" order="" ver="1" cite_std="" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmdh4_d[l_ac].xmdh0091             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "" #

            CALL q_oocq002()                                #呼叫開窗

            LET g_xmdh4_d[l_ac].xmdh0091 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmdh4_d[l_ac].xmdh0091 TO xmdh0091              #顯示到畫面上

            NEXT FIELD xmdh0091                          #返回原欄位

]]>
  </point>
  <point name="input.c.page4.xmdh009_1" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmdh4_d[l_ac].xmdh009_1             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "221" 

            CALL q_oocq002()                                #呼叫開窗

            LET g_xmdh4_d[l_ac].xmdh009_1 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmdh4_d[l_ac].xmdh009_1 TO xmdh009_1              #顯示到畫面上

            NEXT FIELD xmdh009_1                          #返回原欄位

]]>
  </point>
  <point name="input.c.page4.xmdh0151" order="" ver="1" cite_std="" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmdh4_d[l_ac].xmdh0151             #給予default值

            #給予arg

            CALL q_ooca001_1()                                #呼叫開窗

            LET g_xmdh4_d[l_ac].xmdh0151 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmdh4_d[l_ac].xmdh0151 TO xmdh0151              #顯示到畫面上

            NEXT FIELD xmdh0151                          #返回原欄位

]]>
  </point>
  <point name="input.c.page4.xmdh015_1" order="" ver="1" cite_std="" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmdh4_d[l_ac].xmdh015_1             #給予default值

            #給予arg

            CALL q_ooca001_1()                                #呼叫開窗

            LET g_xmdh4_d[l_ac].xmdh015_1 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmdh4_d[l_ac].xmdh015_1 TO xmdh015_1              #顯示到畫面上

            NEXT FIELD xmdh015_1                          #返回原欄位

]]>
  </point>
  <point name="input.c.page4.xmdh0201" order="" ver="1" cite_std="" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmdh4_d[l_ac].xmdh0201             #給予default值

            #給予arg

            CALL q_ooca001_1()                                #呼叫開窗

            LET g_xmdh4_d[l_ac].xmdh0201 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmdh4_d[l_ac].xmdh0201 TO xmdh0201              #顯示到畫面上

            NEXT FIELD xmdh0201                          #返回原欄位

]]>
  </point>
  <point name="input.c.page4.xmdh020_1" order="" ver="1" cite_std="" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmdh4_d[l_ac].xmdh020_1             #給予default值

            #給予arg

            CALL q_ooca001_1()                                #呼叫開窗

            LET g_xmdh4_d[l_ac].xmdh020_1 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmdh4_d[l_ac].xmdh020_1 TO xmdh020_1              #顯示到畫面上

            NEXT FIELD xmdh020_1                          #返回原欄位

]]>
  </point>
  <point name="input.c.page4.xmdh023" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        ]]>
  </point>
  <point name="input.c.page4.xmdh024" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        #此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xmdh4_d[l_ac].xmdh024             #給予default值

            #給予arg

            CALL q_oodb002_2()                                #呼叫開窗

            LET g_xmdh4_d[l_ac].xmdh024 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xmdh4_d[l_ac].xmdh024 TO xmdh024              #顯示到畫面上

            NEXT FIELD xmdh024                          #返回原欄位

]]>
  </point>
  <point name="input.c.page4.xmdh025" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        ]]>
  </point>
  <point name="input.c.page4.xmdh026" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        ]]>
  </point>
  <point name="input.c.page4.xmdh027" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        ]]>
  </point>
  <point name="input.c.page4.xmdh028" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        ]]>
  </point>
  <point name="input.c.xmdg001" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.c.xmdg002" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
	   		LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_xmdg_m.xmdg002  #給予default值
            CALL q_ooag001()                            #呼叫開窗
            LET g_xmdg_m.xmdg002 = g_qryparam.return1   #將開窗取得的值回傳到變數
            DISPLAY g_xmdg_m.xmdg002 TO xmdg002         #顯示到畫面上
            CALL s_desc_get_person_desc(g_xmdg_m.xmdg002) RETURNING g_xmdg_m.xmdg002_desc
            DISPLAY BY NAME g_xmdg_m.xmdg002_desc
            NEXT FIELD xmdg002                          #返回原欄位]]>
  </point>
  <point name="input.c.xmdg003" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
	   		LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_xmdg_m.xmdg003  #給予default值
            LET g_qryparam.arg1 = g_xmdg_m.xmdgdocdt    #日期
            CALL q_ooeg001()                            #呼叫開窗
            LET g_xmdg_m.xmdg003 = g_qryparam.return1   #將開窗取得的值回傳到變數
            DISPLAY g_xmdg_m.xmdg003 TO xmdg003         #顯示到畫面上
            CALL s_desc_get_department_desc(g_xmdg_m.xmdg003) RETURNING g_xmdg_m.xmdg003_desc
            DISPLAY BY NAME g_xmdg_m.xmdg003_desc
            NEXT FIELD xmdg003                          #返回原欄位]]>
  </point>
  <point name="input.c.xmdg004" order="" ver="13" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
	   		LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_xmdg_m.xmdg004  #給予default值
            IF g_argv[01] = '8' THEN
   	   		LET g_qryparam.where = " xmda005 = '8' "
   	   	ELSE
   	   		LET g_qryparam.where = " xmda005 <> '8' "
            END IF
            CALL q_xmdadocno_2()                        #呼叫開窗
            LET g_xmdg_m.xmdg004 = g_qryparam.return1   #將開窗取得的值回傳到變數
            DISPLAY g_xmdg_m.xmdg004 TO xmdg004         #顯示到畫面上
            NEXT FIELD xmdg004                          #返回原欄位]]>
  </point>
  <point name="input.c.xmdg005" order="" ver="16" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
	   		LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_xmdg_m.xmdg005  #給予default值
            LET g_qryparam.where = "1=1 "
            CALL s_control_get_customer_sql('2',g_site,g_user,g_dept,g_xmdg_m.xmdgdocno) RETURNING l_success,l_where
            IF l_success THEN
               LET g_qryparam.where = g_qryparam.where ," AND ",l_where
            END IF
	   		LET g_qryparam.arg1 = g_site
            CALL q_pmaa001_6()                          #呼叫開窗
            LET g_xmdg_m.xmdg005 = g_qryparam.return1   #將開窗取得的值回傳到變數
            DISPLAY g_xmdg_m.xmdg005 TO xmdg005         #顯示到畫面上
            CALL s_desc_get_trading_partner_abbr_desc(g_xmdg_m.xmdg005) RETURNING g_xmdg_m.xmdg005_desc
            DISPLAY BY NAME g_xmdg_m.xmdg005_desc
            NEXT FIELD xmdg005                          #返回原欄位]]>
  </point>
  <point name="input.c.xmdg006" order="" ver="16" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
	   		LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_xmdg_m.xmdg006  #給予default值
	   		LET g_qryparam.arg1 = g_xmdg_m.xmdg005
            LET g_qryparam.arg2 = g_site
            CALL q_pmac002_5()                          #呼叫開窗
            LET g_xmdg_m.xmdg006 = g_qryparam.return1   #將開窗取得的值回傳到變數
            DISPLAY g_xmdg_m.xmdg006 TO xmdg006         #顯示到畫面上
            CALL s_desc_get_trading_partner_abbr_desc(g_xmdg_m.xmdg006) RETURNING g_xmdg_m.xmdg006_desc
            DISPLAY BY NAME g_xmdg_m.xmdg006_desc
            NEXT FIELD xmdg006                          #返回原欄位]]>
  </point>
  <point name="input.c.xmdg007" order="" ver="16" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
	   		LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_xmdg_m.xmdg007  #給予default值
	   		LET g_qryparam.arg1 = g_xmdg_m.xmdg005
            LET g_qryparam.arg2 = g_site
            CALL q_pmac002_6()                          #呼叫開窗
            LET g_xmdg_m.xmdg007 = g_qryparam.return1   #將開窗取得的值回傳到變數
            DISPLAY g_xmdg_m.xmdg007 TO xmdg007         #顯示到畫面上
            CALL s_desc_get_trading_partner_abbr_desc(g_xmdg_m.xmdg007) RETURNING g_xmdg_m.xmdg007_desc
            DISPLAY BY NAME g_xmdg_m.xmdg007_desc
            NEXT FIELD xmdg007                          #返回原欄位]]>
  </point>
  <point name="input.c.xmdg008" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
	   		LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_xmdg_m.xmdg008        #給予default值
            LET g_qryparam.arg1 = g_xmdg_m.xmdg005            #客戶編號
            CALL q_pmad002_3()                                #呼叫開窗
            LET g_xmdg_m.xmdg008 = g_qryparam.return1         #將開窗取得的值回傳到變數
            DISPLAY g_xmdg_m.xmdg008 TO xmdg008               #顯示到畫面上
            CALL s_desc_get_ooib002_desc(g_xmdg_m.xmdg008) RETURNING g_xmdg_m.xmdg008_desc
            DISPLAY BY NAME g_xmdg_m.xmdg008_desc
            NEXT FIELD xmdg008                                #返回原欄位]]>
  </point>
  <point name="input.c.xmdg009" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
	   		LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_xmdg_m.xmdg009  #給予default值
            LET g_qryparam.arg1 = '238'
            CALL q_oocq002()                            #呼叫開窗
            LET g_xmdg_m.xmdg009 = g_qryparam.return1   #將開窗取得的值回傳到變數
            DISPLAY g_xmdg_m.xmdg009 TO xmdg009         #顯示到畫面上
            CALL s_desc_get_acc_desc('238',g_xmdg_m.xmdg009) RETURNING g_xmdg_m.xmdg009_desc
            DISPLAY BY NAME g_xmdg_m.xmdg009_desc
            NEXT FIELD xmdg009                          #返回原欄位]]>
  </point>
  <point name="input.c.xmdg010" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[         	INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			   LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_xmdg_m.xmdg010  #給予default值
            CALL q_oodb002_11()                         #呼叫開窗
            LET g_xmdg_m.xmdg010 = g_qryparam.return1   #將開窗取得的值回傳到變數
            DISPLAY g_xmdg_m.xmdg010 TO xmdg010         #顯示到畫面上
            CALL s_desc_get_tax_desc1(g_site,g_xmdg_m.xmdg010) RETURNING g_xmdg_m.xmdg010_desc
            DISPLAY BY NAME g_xmdg_m.xmdg010_desc
            NEXT FIELD xmdg010                          #返回原欄位]]>
  </point>
  <point name="input.c.xmdg011" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.c.xmdg012" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.c.xmdg013" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
	   		LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_xmdg_m.xmdg013  #給予default值
            LET g_qryparam.arg1 = g_ooef019             #稅區編號
            LET g_qryparam.arg2 = "2"                   #銷項
            CALL q_isac002_1()                          #呼叫開窗
            LET g_xmdg_m.xmdg013 = g_qryparam.return1   #將開窗取得的值回傳到變數
            DISPLAY g_xmdg_m.xmdg013 TO xmdg013         #顯示到畫面上
            CALL s_desc_get_invoice_type_desc1(g_site,g_xmdg_m.xmdg013) RETURNING g_xmdg_m.xmdg013_desc
            DISPLAY BY NAME g_xmdg_m.xmdg013_desc
            NEXT FIELD xmdg013                          #返回原欄位]]>
  </point>
  <point name="input.c.xmdg014" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
	   		LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_xmdg_m.xmdg014  #給予default值
            LET g_qryparam.arg1 = g_site
            CALL q_ooaj002()                            #呼叫開窗
            LET g_xmdg_m.xmdg014 = g_qryparam.return1   #將開窗取得的值回傳到變數
            DISPLAY g_xmdg_m.xmdg014 TO xmdg014         #顯示到畫面上
            CALL s_desc_get_currency_desc(g_xmdg_m.xmdg014) RETURNING g_xmdg_m.xmdg014_desc
            DISPLAY BY NAME g_xmdg_m.xmdg014_desc
            NEXT FIELD xmdg014                          #返回原欄位]]>
  </point>
  <point name="input.c.xmdg015" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.c.xmdg016" order="" ver="16" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
	   		LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_xmdg_m.xmdg016  #給予default值
            LET g_qryparam.where = "1=1 "
            CALL s_control_get_supplier_sql('2',g_site,g_user,g_dept,g_xmdg_m.xmdgdocno) RETURNING l_success,l_where
            IF l_success THEN
               LET g_qryparam.where = g_qryparam.where ," AND ",l_where
            END IF
            CALL q_pmaa001_3()                          #呼叫開窗
            LET g_xmdg_m.xmdg016 = g_qryparam.return1   #將開窗取得的值回傳到變數
            DISPLAY g_xmdg_m.xmdg016 TO xmdg016         #顯示到畫面上
            CALL s_desc_get_trading_partner_abbr_desc(g_xmdg_m.xmdg016) RETURNING g_xmdg_m.xmdg016_desc
            DISPLAY BY NAME g_xmdg_m.xmdg016_desc
            NEXT FIELD xmdg016                          #返回原欄位
]]>
  </point>
  <point name="input.c.xmdg017" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
	   		LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_xmdg_m.xmdg017  #給予default值
            CALL s_axmt500_get_pmaa027(g_xmdg_m.xmdg007) RETURNING l_pmaa027
            LET g_qryparam.arg1 = l_pmaa027
            CALL q_oofb019_1()                          #呼叫開窗
            LET g_xmdg_m.xmdg017 = g_qryparam.return1   #將開窗取得的值回傳到變數
            DISPLAY g_xmdg_m.xmdg017 TO xmdg017         #顯示到畫面上
            CALL axmt520_xmdg017_ref()
            NEXT FIELD xmdg017                          #返回原欄位]]>
  </point>
  <point name="input.c.xmdg018" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
	   		LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_xmdg_m.xmdg018  #給予default值
            LET g_qryparam.arg1 = "263"
            CALL q_oocq002()                            #呼叫開窗
            LET g_xmdg_m.xmdg018 = g_qryparam.return1   #將開窗取得的值回傳到變數
            DISPLAY g_xmdg_m.xmdg018 TO xmdg018         #顯示到畫面上
            CALL s_desc_get_acc_desc('263',g_xmdg_m.xmdg018) RETURNING g_xmdg_m.xmdg018_desc
            DISPLAY BY NAME g_xmdg_m.xmdg018_desc
            NEXT FIELD xmdg018                          #返回原欄位]]>
  </point>
  <point name="input.c.xmdg019" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_xmdg_m.xmdg019
            CALL axmt520_get_oocq019() RETURNING l_oocq019  #運輸類型
            IF NOT cl_null(l_oocq019) THEN
               CASE
                  WHEN l_oocq019 ='1' OR l_oocq019='4'
                     LET g_qryparam.arg1 = "315"
                     CALL q_oocq002()
                  WHEN l_oocq019 ='2'
                     CALL q_oocq002_10()
                  WHEN l_oocq019 ='3'
                     CALL q_oocq002_12()
                  OTHERWISE EXIT CASE
               END CASE
            END IF
            LET g_xmdg_m.xmdg019 = g_qryparam.return1       #將開窗取得的值回傳到變數       
            DISPLAY g_xmdg_m.xmdg019 TO xmdg019
            CALL s_apmi011_location_ref(g_xmdg_m.xmdg018,g_xmdg_m.xmdg019) RETURNING g_xmdg_m.xmdg019_desc
            DISPLAY BY NAME g_xmdg_m.xmdg019_desc
            NEXT FIELD xmdg019                 ]]>
  </point>
  <point name="input.c.xmdg020" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_xmdg_m.xmdg020
            CALL axmt520_get_oocq019() RETURNING l_oocq019  #運輸類型
            IF NOT cl_null(l_oocq019) THEN
               CASE
                  WHEN l_oocq019 ='1' OR l_oocq019='4'
                     LET g_qryparam.arg1 = "315"
                     CALL q_oocq002()
                  WHEN l_oocq019 ='2'
                     CALL q_oocq002_10()
                  WHEN l_oocq019 ='3'
                     CALL q_oocq002_12()
                  OTHERWISE EXIT CASE
               END CASE
            END IF
            LET g_xmdg_m.xmdg020 = g_qryparam.return1       #將開窗取得的值回傳到變數       
            DISPLAY g_xmdg_m.xmdg020 TO xmdg020
            CALL s_apmi011_location_ref(g_xmdg_m.xmdg018,g_xmdg_m.xmdg020) RETURNING g_xmdg_m.xmdg020_desc
            DISPLAY BY NAME g_xmdg_m.xmdg020_desc
            NEXT FIELD xmdg020]]>
  </point>
  <point name="input.c.xmdg021" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.c.xmdg022" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.c.xmdg023" order="" ver="17" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_xmdg_m.xmdg023
            LET g_qryparam.where = " xmao001 = '",g_xmdg_m.xmdg005,"'"
            CALL q_xmao002()
            LET g_xmdg_m.xmdg023 = g_qryparam.return1
            DISPLAY g_xmdg_m.xmdg023 TO xmdg023
            CALL axmt520_xmdg023_ref()
            NEXT FIELD xmdg023]]>
  </point>
  <point name="input.c.xmdg024" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.c.xmdg025" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.c.xmdg026" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
	   		LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_xmdg_m.xmdg026  #給予default值
            LET g_qryparam.arg1 = "275" 
            CALL q_oocq002()                            #呼叫開窗
            LET g_xmdg_m.xmdg026 = g_qryparam.return1   #將開窗取得的值回傳到變數
            DISPLAY g_xmdg_m.xmdg026 TO xmdg026         #顯示到畫面上
            CALL s_desc_get_acc_desc('275',g_xmdg_m.xmdg026) RETURNING g_xmdg_m.xmdg026_desc
            DISPLAY BY NAME g_xmdg_m.xmdg026_desc
            NEXT FIELD xmdg026                          #返回原欄位]]>
  </point>
  <point name="input.c.xmdg027" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
	   		LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_xmdg_m.xmdg027  #給予default值
            LET g_qryparam.arg1 = "295" 
            CALL q_oocq002()                            #呼叫開窗
            LET g_xmdg_m.xmdg027 = g_qryparam.return1   #將開窗取得的值回傳到變數
            DISPLAY g_xmdg_m.xmdg027 TO xmdg027         #顯示到畫面上
            CALL s_desc_get_acc_desc('295',g_xmdg_m.xmdg027) RETURNING g_xmdg_m.xmdg027_desc
            DISPLAY BY NAME g_xmdg_m.xmdg027_desc
            NEXT FIELD xmdg027                          #返回原欄位]]>
  </point>
  <point name="input.c.xmdg028" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.c.xmdg030" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
	   		LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_xmdg_m.xmdg030  #給予default值
            LET g_qryparam.arg1 = "209" 
            CALL q_oocq002()                            #呼叫開窗
            LET g_xmdg_m.xmdg030 = g_qryparam.return1   #將開窗取得的值回傳到變數
            DISPLAY g_xmdg_m.xmdg030 TO xmdg030         #顯示到畫面上
            CALL s_desc_get_acc_desc('209',g_xmdg_m.xmdg030) RETURNING g_xmdg_m.xmdg030_desc
            DISPLAY BY NAME g_xmdg_m.xmdg030_desc
            NEXT FIELD xmdg030                          #返回原欄位]]>
  </point>
  <point name="input.c.xmdg031" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
	   		LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_xmdg_m.xmdg031  #給予default值
            LET g_qryparam.arg1 = "297" 
            CALL q_oocq002()                            #呼叫開窗
            LET g_xmdg_m.xmdg031 = g_qryparam.return1   #將開窗取得的值回傳到變數
            DISPLAY g_xmdg_m.xmdg031 TO xmdg031         #顯示到畫面上
            CALL s_desc_get_acc_desc('297',g_xmdg_m.xmdg031) RETURNING g_xmdg_m.xmdg031_desc
            DISPLAY BY NAME g_xmdg_m.xmdg031_desc
            NEXT FIELD xmdg031                          #返回原欄位]]>
  </point>
  <point name="input.c.xmdg032" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="input.c.xmdg033" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="input.c.xmdg053" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.c.xmdg054" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="input.c.xmdg055" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="input.c.xmdg056" order="" ver="13" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_xmdg_m.xmdg056
            CALL q_icaa001_8()
            LET g_xmdg_m.xmdg056 = g_qryparam.return1
            DISPLAY g_xmdg_m.xmdg056 TO xmdg056
            CALL s_desc_get_icaa001_desc(g_xmdg_m.xmdg056) RETURNING g_xmdg_m.xmdg056_desc
            DISPLAY BY NAME g_xmdg_m.xmdg056_desc
            NEXT FIELD xmdg056
]]>
  </point>
  <point name="input.c.xmdg202" order="" ver="16" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
	   		LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_xmdg_m.xmdg202  #給予default值
	   		LET g_qryparam.arg1 = g_xmdg_m.xmdg005
            LET g_qryparam.arg2 = g_site
            CALL q_pmac002_7()                          #呼叫開窗
            LET g_xmdg_m.xmdg202 = g_qryparam.return1   #將開窗取得的值回傳到變數
            DISPLAY g_xmdg_m.xmdg202 TO xmdg202         #顯示到畫面上
            CALL s_desc_get_trading_partner_abbr_desc(g_xmdg_m.xmdg202) RETURNING g_xmdg_m.xmdg202_desc
            DISPLAY BY NAME g_xmdg_m.xmdg202_desc
            NEXT FIELD xmdg202                          #返回原欄位]]>
  </point>
  <point name="input.c.xmdgdocdt" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.c.xmdgdocno" order="" ver="13" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
	   		LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_xmdg_m.xmdgdocno  #給予default值
            LET g_qryparam.arg1 = g_ooef004
            LET g_qryparam.arg2 = g_prog
            CALL q_ooba002_1()                            #呼叫開窗
            LET g_xmdg_m.xmdgdocno = g_qryparam.return1   #將開窗取得的值回傳到變數
            DISPLAY g_xmdg_m.xmdgdocno TO xmdgdocno       #顯示到畫面上
            CALL s_aooi200_get_slip_desc(g_xmdg_m.xmdgdocno) RETURNING g_xmdg_m.xmdgdocno_desc
            DISPLAY BY NAME g_xmdg_m.xmdgdocno_desc
            NEXT FIELD xmdgdocno                          #返回原欄位]]>
  </point>
  <point name="input.c.xmdgsite" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="input.c.xmdgstus" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.d.before_input" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="input.define" order="" ver="13" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   DEFINE l_success              LIKE type_t.num5
   DEFINE l_rollback             LIKE type_t.num5
   DEFINE l_flag                 LIKE type_t.num5
   DEFINE l_para                 LIKE type_t.chr2
   DEFINE l_where                STRING
   DEFINE l_imaa005              LIKE imaa_t.imaa005  #特徵類別
   DEFINE l_pmaa027              LIKE pmaa_t.pmaa027  #聯絡對象識別碼
   DEFINE l_oocq019              LIKE oocq_t.oocq019
   DEFINE l_oodb011              LIKE oodb_t.oodb011
   DEFINE l_xmdhseq_backup       LIKE xmdh_t.xmdhseq    #紀錄新增多庫儲批時的項次]]>
  </point>
  <point name="input.define_sql" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[     ]]>
  </point>
  <point name="input.define_sql2" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[     ]]>
  </point>
  <point name="input.g.page1.xmdh001" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        ]]>
  </point>
  <point name="input.g.page1.xmdh002" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        ]]>
  </point>
  <point name="input.g.page1.xmdh003" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        ]]>
  </point>
  <point name="input.g.page1.xmdh004" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                         ]]>
  </point>
  <point name="input.g.page1.xmdh005" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.g.page1.xmdh006" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.g.page1.xmdh007" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.g.page1.xmdh008" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.g.page1.xmdh009" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.g.page1.xmdh010" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.g.page1.xmdh011" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF g_xmdh_d[l_ac].xmdh011 = 'N' THEN
               CALL axmt520_xmdi_del()
            END IF
            IF g_xmdh_d[l_ac].xmdh011 = 'Y' THEN
               CALL axmt540_01('2',g_site,'',g_xmdg_m.xmdgdocno,g_xmdh_d[g_detail_idx].xmdhseq,
                               g_xmdh_d[g_detail_idx].xmdh006,g_xmdh_d[g_detail_idx].xmdh007,
                               g_xmdh_d[g_detail_idx].xmdh009,g_xmdh_d[g_detail_idx].xmdh010,
                               g_xmdh_d[g_detail_idx].xmdh015,g_xmdh_d[g_detail_idx].xmdh016,
                               '',g_xmdh_d[g_detail_idx].xmdh018,g_xmdh_d[g_detail_idx].xmdh019,
                               '','','',g_xmdh_d[g_detail_idx].xmdh001,g_xmdh_d[g_detail_idx].xmdh002)
                    RETURNING l_success,l_rollback,g_xmdh_d[g_detail_idx].xmdh012,g_xmdh_d[g_detail_idx].xmdh013,g_xmdh_d[g_detail_idx].xmdh014,g_xmdh_d[g_detail_idx].xmdh029
               IF NOT l_success OR NOT cl_null(g_xmdh_d[g_detail_idx].xmdh012) THEN
                  LET g_xmdh_d[l_ac].xmdh011 = 'N'
               END IF
            END IF
            LET l_xmdhseq_backup = g_xmdh_d[l_ac].xmdhseq #紀錄產生庫儲批所用的項次]]>
  </point>
  <point name="input.g.page1.xmdh012" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.g.page1.xmdh013" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.g.page1.xmdh014" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.g.page1.xmdh015" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.g.page1.xmdh016" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="input.g.page1.xmdh017" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.g.page1.xmdh018" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.g.page1.xmdh019" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.g.page1.xmdh020" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.g.page1.xmdh021" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.g.page1.xmdh022" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.g.page1.xmdh029" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="input.g.page1.xmdh030" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.g.page1.xmdh031" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.g.page1.xmdh032" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.g.page1.xmdh033" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.g.page1.xmdh034" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.g.page1.xmdh036" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.g.page1.xmdh050" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.g.page1.xmdh051" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="input.g.page1.xmdh052" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="input.g.page1.xmdhseq" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.g.page1.xmdhsite" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="input.g.page2.xmdi001" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        ]]>
  </point>
  <point name="input.g.page2.xmdi002" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        ]]>
  </point>
  <point name="input.g.page2.xmdi003" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        ]]>
  </point>
  <point name="input.g.page2.xmdi004" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        ]]>
  </point>
  <point name="input.g.page2.xmdi005" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        ]]>
  </point>
  <point name="input.g.page2.xmdi006" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        ]]>
  </point>
  <point name="input.g.page2.xmdi007" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        ]]>
  </point>
  <point name="input.g.page2.xmdi008" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        ]]>
  </point>
  <point name="input.g.page2.xmdi009" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        ]]>
  </point>
  <point name="input.g.page2.xmdi010" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        ]]>
  </point>
  <point name="input.g.page2.xmdi011" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        ]]>
  </point>
  <point name="input.g.page2.xmdi012" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        ]]>
  </point>
  <point name="input.g.page2.xmdiseq" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        ]]>
  </point>
  <point name="input.g.page2.xmdiseq1" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        ]]>
  </point>
  <point name="input.g.page4.xmdh023" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        ]]>
  </point>
  <point name="input.g.page4.xmdh024" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        ]]>
  </point>
  <point name="input.g.page4.xmdh025" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        ]]>
  </point>
  <point name="input.g.page4.xmdh026" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        ]]>
  </point>
  <point name="input.g.page4.xmdh027" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        ]]>
  </point>
  <point name="input.g.page4.xmdh028" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                        ]]>
  </point>
  <point name="input.g.xmdg001" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.g.xmdg002" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.g.xmdg003" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.g.xmdg004" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.g.xmdg005" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.g.xmdg006" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.g.xmdg007" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.g.xmdg008" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.g.xmdg009" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.g.xmdg010" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.g.xmdg011" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.g.xmdg012" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.g.xmdg013" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.g.xmdg014" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.g.xmdg015" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.g.xmdg016" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.g.xmdg017" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.g.xmdg018" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.g.xmdg019" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.g.xmdg020" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.g.xmdg021" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.g.xmdg022" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.g.xmdg023" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.g.xmdg024" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.g.xmdg025" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.g.xmdg026" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.g.xmdg027" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.g.xmdg028" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.g.xmdg030" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.g.xmdg031" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.g.xmdg032" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="input.g.xmdg033" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="input.g.xmdg053" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.g.xmdg054" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="input.g.xmdg055" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="input.g.xmdgdocdt" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.g.xmdgdocno" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.g.xmdgsite" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="input.g.xmdgstus" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="input.head.a_insert" order="" ver="13" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#            CALL s_transaction_end('Y','0')
#            CALL s_transaction_begin()
#            IF NOT cl_null(g_xmdg_m.xmdg004) THEN
#               IF g_argv[01] = '8' THEN
#                  IF cl_ask_confirm('axm-00566') THEN   #是否由[借貨訂單axmt501]自動產生單身資料？
#                     LET l_success = ''
#                     CALL axmt520_gen_xmdh()  #自動產生單身
#                          RETURNING l_success
#                     IF NOT l_success THEN 
#                        CALL s_transaction_end('N','0')
#                     END IF
#                  END IF
#               ELSE
#                  IF cl_ask_confirm('axm-00140') THEN   #是否由[訂單axmt500]自動產生單身資料！
#                     LET l_success = ''
#                     CALL axmt520_gen_xmdh()  #自動產生單身
#                          RETURNING l_success
#                     IF NOT l_success THEN 
#                        CALL s_transaction_end('N','0')
#                     END IF
#                  END IF
#               END IF
#            END IF]]>
  </point>
  <point name="input.head.a_insert2" order="" ver="10" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[               CALL axmt520_b_fill()
]]>
  </point>
  <point name="input.head.a_update" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                             ]]>
  </point>
  <point name="input.head.after_input" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="input.head.b_insert" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[               CALL s_aooi200_gen_docno(g_site,g_xmdg_m.xmdgdocno,g_xmdg_m.xmdgdocdt,g_prog) RETURNING l_success,g_xmdg_m.xmdgdocno
               IF NOT l_success THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = 'apm-00003'
                  LET g_errparam.extend = g_xmdg_m.xmdgdocno
                  LET g_errparam.popup = TRUE
                  CALL cl_err()
                  NEXT FIELD xmdgdocno
               END IF
               DISPLAY BY NAME g_xmdg_m.xmdgdocno]]>
  </point>
  <point name="input.head.b_update" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                             ]]>
  </point>
  <point name="input.head.m_insert" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                             ]]>
  </point>
  <point name="input.head.m_update" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                             ]]>
  </point>
  <point name="input.m.before_input" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            LET g_xmdg_m_t.* = g_xmdg_m.*
            LET g_xmdg_m_o.* = g_xmdg_m.*
            ]]>
  </point>
  <point name="input.more_input" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[           ]]>
  </point>
  <point name="input.other_sql" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[     ]]>
  </point>
  <point name="insert.after_insert" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[           ]]>
  </point>
  <point name="insert.default" order="" ver="16" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[      LET g_xmdg_m.xmdgsite = g_site
      LET g_xmdg_m.xmdgdocdt = g_today
      LET g_xmdg_m.xmdg002 = g_user
      LET g_xmdg_m.xmdg003 = g_dept
      LET g_xmdg_m.xmdg022 = g_today
      LET g_xmdg_m.xmdg028 = g_today
      CALL s_desc_get_person_desc(g_xmdg_m.xmdg002) RETURNING g_xmdg_m.xmdg002_desc
      CALL s_desc_get_department_desc(g_xmdg_m.xmdg003) RETURNING g_xmdg_m.xmdg003_desc
      DISPLAY BY NAME g_xmdg_m.xmdg002_desc,g_xmdg_m.xmdg003_desc
      
      IF g_argv[01] = '8' THEN
         LET g_xmdg_m.xmdg001 = g_argv[01]
      END IF
      
      LET g_xmdg_m_t.* = g_xmdg_m.*
      LET g_xmdg_m_o.* = g_xmdg_m.*
     ]]>
  </point>
  <point name="insert.define" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[     ]]>
  </point>
  <point name="insert_b.after_insert" order="" ver="13" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="insert_b.after_insert2" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[           ]]>
  </point>
  <point name="insert_b.before_insert" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[      LET g_xmdh_d[g_detail_idx].xmdhsite = g_site
      ]]>
  </point>
  <point name="insert_b.before_insert2" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[      LET g_xmdh2_d[g_detail_idx].xmdisite = g_site
      ]]>
  </point>
  <point name="insert_b.define" order="" ver="13" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   DEFINE l_success   LIKE type_t.num5
     ]]>
  </point>
  <point name="insert_b.m_insert" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[           ]]>
  </point>
  <point name="insert_b.m_insert2" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[           ]]>
  </point>
  <point name="insert_b.other" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[     ]]>
  </point>
  <point name="lock_b.define" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[     ]]>
  </point>
  <point name="lock_b.other" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[     ]]>
  </point>
  <point name="main.after_define_sql" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[     ]]>
  </point>
  <point name="main.after_refresh_sql" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="main.before_close" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[           ]]>
  </point>
  <point name="main.define" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[     ]]>
  </point>
  <point name="main.define_sql" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[     ]]>
  </point>
  <point name="main.exit" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   CALL axmt540_01_drop_temp_table()]]>
  </point>
  <point name="main.init" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[     ]]>
  </point>
  <point name="main.servicecall" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[           ]]>
  </point>
  <point name="menu.axmt520_01" order="" ver="12" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[               IF cl_null(g_detail_idx) OR g_detail_idx = 0 THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = 'abm-00073'
                  LET g_errparam.extend = ""
                  LET g_errparam.popup = TRUE
                  CALL cl_err()
                  EXIT DIALOG
               END IF
               
               IF g_xmdg_m.xmdgstus = 'X' THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = 'sub-00229'
                  LET g_errparam.extend = ""
                  LET g_errparam.popup = TRUE
                  CALL cl_err()
                  EXIT DIALOG
               END IF
               
               IF g_xmdh_d[g_detail_idx].xmdh012 IS NOT NULL THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = 'axm-00162'
                  LET g_errparam.extend = ""
                  LET g_errparam.popup = TRUE
                  CALL cl_err()
                  EXIT DIALOG
               END IF
               
               CALL s_transaction_begin()
			 
               CALL axmt540_01('2',g_site,'',g_xmdg_m.xmdgdocno,g_xmdh_d[g_detail_idx].xmdhseq,
                               g_xmdh_d[g_detail_idx].xmdh006,g_xmdh_d[g_detail_idx].xmdh007,
                               g_xmdh_d[g_detail_idx].xmdh009,g_xmdh_d[g_detail_idx].xmdh010,
                               g_xmdh_d[g_detail_idx].xmdh015,g_xmdh_d[g_detail_idx].xmdh016,
                               '',g_xmdh_d[g_detail_idx].xmdh018,g_xmdh_d[g_detail_idx].xmdh019,
                               '','','',g_xmdh_d[g_detail_idx].xmdh001,g_xmdh_d[g_detail_idx].xmdh002)
                    RETURNING l_success,l_rollback,l_xmdh012,l_xmdh013,l_xmdh014,l_xmdh029
               IF l_rollback OR NOT l_success THEN
                  CALL s_transaction_end('N','0')
                  EXIT DIALOG
               END IF                    
               IF NOT cl_null(l_xmdh012) THEN
                  UPDATE xmdh_t
                     SET xmdh011 = 'N',
                         xmdh012 = l_xmdh012,
                         xmdh013 = l_xmdh013,
                         xmdh014 = l_xmdh014,
                         xmdh029 = l_xmdh029
                   WHERE xmdhent = g_enterprise
                     AND xmdhsite = g_site
                     AND xmdhdocno = g_xmdg_m.xmdgdocno
                     AND xmdhseq = g_xmdh_d[l_ac].xmdhseq
                  IF SQLCA.sqlcode THEN
                     INITIALIZE g_errparam TO NULL
                     LET g_errparam.code = SQLCA.sqlcode
                     LET g_errparam.extend = "UPDATE:"
                     LET g_errparam.popup = TRUE
                     CALL cl_err()
                     CALL s_transaction_end('N','0')
                     EXIT DIALOG
                  END IF
               ELSE
                  UPDATE xmdh_t
                     SET xmdh011 = 'Y',
                         xmdh012 = '',
                         xmdh013 = '',
                         xmdh014 = ''
                   WHERE xmdhent = g_enterprise
                     AND xmdhsite = g_site
                     AND xmdhdocno = g_xmdg_m.xmdgdocno
                     AND xmdhseq = g_xmdh_d[l_ac].xmdhseq
                  IF SQLCA.sqlcode THEN
                     INITIALIZE g_errparam TO NULL
                     LET g_errparam.code = SQLCA.sqlcode
                     LET g_errparam.extend = "UPDATE:"
                     LET g_errparam.popup = TRUE
                     CALL cl_err()
                     CALL s_transaction_end('N','0')
                     EXIT DIALOG
                  END IF
               END IF
               CALL s_transaction_end('Y','0')
]]>
  </point>
  <point name="menu.bpm_status" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="menu.default.insert" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="menu.delete" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="menu.demo" order="" ver="13" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[               CALL aooi360_02('6',g_prog,g_xmdg_m.xmdgdocno,'','','','','','','','','4')]]>
  </point>
  <point name="menu.detail_show.page1_sub.detail_qrystr" order="" ver="14" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                  BEFORE MENU
                     IF cl_null(g_xmdh_d[l_ac].xmdh001) THEN
                        EXIT MENU
                     END IF]]>
  </point>
  <point name="menu.detail_show.page1_sub.prog_axmt500" order="" ver="16" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[               #應用 a41 樣板自動產生(Version:2)
               #使用JSON格式組合參數與作業編號(串查)
               INITIALIZE la_param.* TO NULL
               IF g_argv[01] = '8' THEN
                  LET la_param.prog     = 'axmt501'                  
               ELSE
                  LET la_param.prog     = 'axmt500'
               END IF
               LET la_param.param[1] = g_xmdh_d[l_ac].xmdh001
               LET ls_js = util.JSON.stringify(la_param)
               CALL cl_cmdrun_wait(ls_js)
 

]]>
  </point>
  <point name="menu.detail_show.page4_sub.prog_axmt500" order="" ver="14" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[               #應用 a41 樣板自動產生(Version:2)
               #使用JSON格式組合參數與作業編號(串查)
               INITIALIZE la_param.* TO NULL
               LET la_param.prog     = 'axmt500'
               LET la_param.param[1] = g_xmdh4_d[l_ac].xmdh0011

               LET ls_js = util.JSON.stringify(la_param)
               CALL cl_cmdrun_wait(ls_js)
 

]]>
  </point>
  <point name="menu.insert" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                             ]]>
  </point>
  <point name="menu.modify" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                             ]]>
  </point>
  <point name="menu.modify_detail" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                             ]]>
  </point>
  <point name="menu.on_hold" order="" ver="3" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[               LET g_action_choice="modify"
               LET g_aw = ''
               LET g_hold = '0'
               CALL cl_set_comp_entry("xmdg031",TRUE)
               CALL axmt520_modify()
               LET g_hold = '1'
               CALL cl_set_comp_entry("xmdg031",FALSE)
]]>
  </point>
  <point name="menu.output" order="" ver="9" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[               #CALL axmr520_g01("xmdgent ="|| g_enterprise ||"  AND xmdgdocno ='"|| g_xmdg_m.xmdgdocno||"'",'Y','Y')
               LET g_rep_wc = "xmdgent ="|| g_enterprise ||"  AND xmdgdocno ='"|| g_xmdg_m.xmdgdocno||"'"
              ]]>
  </point>
  <point name="menu.prog_xmdg002" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[               #+ 此段落由子樣板a45產生
               CALL cl_user_contact("aooi130", "ooag_t", "ooag002", "ooag001",g_xmdg_m.xmdg002)]]>
  </point>
  <point name="menu.prog_xmdg004" order="" ver="16" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[               #應用 a41 樣板自動產生(Version:2)
               #使用JSON格式組合參數與作業編號(串查)
               INITIALIZE la_param.* TO NULL
               IF g_argv[01] = '8' THEN
                  LET la_param.prog     = 'axmt501'
               ELSE
                  LET la_param.prog     = 'axmt500'
               END IF
               LET la_param.param[1] = g_xmdg_m.xmdg004
               LET ls_js = util.JSON.stringify(la_param)
               CALL cl_cmdrun_wait(ls_js)
 

]]>
  </point>
  <point name="menu.query" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                             ]]>
  </point>
  <point name="menu.reproduce" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                             ]]>
  </point>
  <point name="menu.upd_price" order="" ver="14" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[               IF cl_null(g_detail_idx) OR g_detail_idx = 0 THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = 'abm-00073'
                  LET g_errparam.extend = ""
                  LET g_errparam.popup = TRUE
                  CALL cl_err()
                  EXIT DIALOG
               END IF
              
               LET g_action_choice= "modify_detail"
               IF cl_auth_chk_act("modify") THEN
                  CALL s_transaction_begin()
                  IF NOT axmt520_action_modify('P') THEN
                     CALL s_transaction_end('N','0')
                  
                  END IF
               END IF]]>
  </point>
  <point name="modify.after_input" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[           ]]>
  </point>
  <point name="modify.before_input" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[     
      #「D抽單 / R已拒絕」狀況碼更改資料後，需還原為「N未確認」
      IF g_xmdg_m.xmdgstus MATCHES "[DR]" THEN 
         LET g_xmdg_m.xmdgstus = "N"
      END IF]]>
  </point>
  <point name="modify.before_show" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="modify.body.a_fk_update" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                 ]]>
  </point>
  <point name="modify.body.a_fk_update2" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                 ]]>
  </point>
  <point name="modify.body.b_fk_update" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                 ]]>
  </point>
  <point name="modify.body.b_fk_update2" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                 ]]>
  </point>
  <point name="modify.body.m_fk_update" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                 ]]>
  </point>
  <point name="modify.body.m_fk_update2" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                 ]]>
  </point>
  <point name="modify.define" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[     ]]>
  </point>
  <point name="query.define" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[     ]]>
  </point>
  <point name="query.other" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[     ]]>
  </point>
  <point name="reproduce.after_reproduce" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[     ]]>
  </point>
  <point name="reproduce.define" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[     ]]>
  </point>
  <point name="reproduce.head.b_input" order="" ver="8" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   LET g_xmdg_m.xmdgcnfid = ""
   LET g_xmdg_m.xmdgcnfdt = ""
   LET g_xmdg_m.xmdgdocdt = g_today
   LET g_xmdg_m.xmdg002   = g_user
   LET g_xmdg_m.xmdg003   = g_dept
   LET g_xmdg_m.xmdg054   = "N"  #多角貿易已拋轉
   LET g_xmdg_m.xmdgownid_desc = cl_get_username(g_xmdg_m.xmdgownid)
   LET g_xmdg_m.xmdgcrtid_desc = cl_get_username(g_xmdg_m.xmdgcrtid)
   LET g_xmdg_m.xmdgmodid_desc = ''
   LET g_xmdg_m.xmdgcnfid_desc = ''
   LET g_xmdg_m.xmdg002_desc = cl_get_username(g_xmdg_m.xmdg002)
   LET g_xmdg_m.xmdgowndp_desc = cl_get_deptname(g_xmdg_m.xmdgowndp)
   LET g_xmdg_m.xmdgcrtdp_desc = cl_get_deptname(g_xmdg_m.xmdgcrtdp)
   LET g_xmdg_m.xmdg003_desc = cl_get_deptname(g_xmdg_m.xmdg003)
]]>
  </point>
  <point name="send.after_send" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="send.before_send" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   #確認前檢核段
   IF NOT s_axmt520_conf_chk(g_xmdg_m.xmdgdocno) THEN
      CLOSE axmt520_cl
      CALL s_transaction_end('N','0')
      RETURN
   END IF
   ]]>
  </point>
  <point name="send.define" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="set_act_no_visible.set_act_no_visible" order="" ver="8" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   IF g_xmdg_m.xmdgstus NOT MATCHES "[NDR]" THEN
      CALL cl_set_act_visible("modify,delete,modify_detail,upd_price,axmt520_01",FALSE)
   END IF
]]>
  </point>
  <point name="set_act_visible.set_act_visible" order="" ver="8" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   CALL cl_set_act_visible("modify,delete,modify_detail,upd_price,axmt520_01",TRUE)
]]>
  </point>
  <point name="set_entry.after_control" order="" ver="13" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   #add xmdg034 by shiun----------------
   CALL cl_set_comp_entry("xmdg001,xmdg034,xmdg005,xmdg006,xmdg007,xmdg008,xmdg009",TRUE)
   CALL cl_set_comp_entry("xmdg010,xmdg013,xmdg014,xmdg016,xmdg017,xmdg018",TRUE)
   CALL cl_set_comp_entry("xmdg019,xmdg020,xmdg023,xmdg026,xmdg027,xmdg032,xmdg033",TRUE)
   CALL cl_set_comp_entry("xmdg001",TRUE)
#   CALL cl_set_comp_entry("xmdg056",TRUE)
   ]]>
  </point>
  <point name="set_entry.define" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[     ]]>
  </point>
  <point name="set_entry.field_control" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[      CALL cl_set_comp_entry("xmdgdocdt,xmdg004",TRUE)
     ]]>
  </point>
  <point name="set_entry_b.define" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[  ]]>
  </point>
  <point name="set_entry_b.field_control" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="set_entry_b.set_entry_b" order="" ver="20" cite_std="N" new="N" status="u" src="s" readonly="" mark_hard="N">
    <![CDATA[   CALL cl_set_comp_entry("xmdh001,xmdh002,xmdh003,xmdh004,xmdh007",TRUE)
   CALL cl_set_comp_entry("xmdh011,xmdh012,xmdh013,xmdh014",TRUE)
   CALL cl_set_comp_entry("xmdh016,xmdh019,xmdh021,xmdh023",TRUE)

   CALL cl_set_comp_entry("xmdi009",TRUE)
   
   CALL cl_set_comp_entry("xmdh031,xmdh032,xmdh033",TRUE)  #add by lixiang 2015/06/18]]>
  </point>
  <point name="set_no_entry.after_control" order="" ver="13" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   IF cl_null(g_xmdg_m.xmdg004) THEN
      #依單據別設定判斷欄位是否需要做輸入控制
      IF NOT cl_null(g_xmdg_m.xmdgdocno) THEN
         LET l_fields = ''
         CALL s_aooi200_get_doc_fields(g_site,'1',g_xmdg_m.xmdgdocno) RETURNING l_fields
         CALL cl_set_comp_entry(l_fields,FALSE)
      END IF
   ELSE
      #將訂單對應的相關欄位預設到出通單上後不能維護
      #add xmdg034 by shiun----------------
      CALL cl_set_comp_entry("xmdg001,xmdg034,xmdg005,xmdg006,xmdg007,xmdg008,xmdg009",FALSE) 
      CALL cl_set_comp_entry("xmdg010,xmdg013,xmdg014,xmdg032",FALSE)
      #新增時若單頭來源有輸入訂單時，且來源訂單的設置的匯率基準是依訂單匯率時，則出通單的匯率預設訂單的匯率且不可以修改
      LET l_xmda049 = ''
      SELECT xmda049 INTO l_xmda049
        FROM xmda_t
       WHERE xmdaent = g_enterprise
         AND xmdadocno = g_xmdg_m.xmdg004
      IF l_xmda049 = '1' THEN
         CALL cl_set_comp_entry("xmdg015",FALSE)
      END IF
   END IF
   IF g_argv[01] = '8' THEN
      CALL cl_set_comp_entry("xmdg001",FALSE)
   END IF
   
#   #多角性質=2.銷售多角，多角流程代號必輸
#   IF g_xmdg_m.xmdg034 <> '2' THEN
#      CALL cl_set_comp_entry("xmdg056",FALSE)
#   END IF]]>
  </point>
  <point name="set_no_entry.define" order="" ver="10" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   DEFINE l_cnt   LIKE type_t.num5
   DEFINE l_fields   STRING 
   DEFINE l_xmda049  LIKE  xmda_t.xmda049]]>
  </point>
  <point name="set_no_entry.field_control" order="" ver="13" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[      CALL cl_set_comp_entry("xmdgdocdt,xmdg004",FALSE)
      LET l_cnt = ''
      SELECT COUNT(*) INTO l_cnt
        FROM xmdh_t
       WHERE xmdhent = g_enterprise
         AND xmdhdocno = g_xmdg_m.xmdgdocno
      IF cl_null(l_cnt) THEN LET l_cnt = 0 END IF
      IF l_cnt <> 0 THEN
         CALL cl_set_comp_entry("xmdg001,xmdg005,xmdg006,xmdg007,xmdg008,xmdg009,xmdg010,xmdg013,xmdg014",FALSE)
      END IF
      #add xmdg034 by shiun----------------
      CALL cl_set_comp_entry("xmdg001,xmdg034,xmdg005,xmdg006,xmdg007,xmdg008,xmdg009",FALSE) 
      CALL cl_set_comp_entry("xmdg010,xmdg013,xmdg014,xmdg032",FALSE) ]]>
  </point>
  <point name="set_no_entry_b.define" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   DEFINE l_imaa005 LIKE imaa_t.imaa005
   DEFINE l_imaf015 LIKE imaf_t.imaf015
   DEFINE l_imaf061 LIKE imaf_t.imaf061
   DEFINE l_imaf113 LIKE imaf_t.imaf113
   DEFINE l_xmdc022 LIKE xmdc_t.xmdc022
   DEFINE l_xmdc028 LIKE xmdc_t.xmdc028
   DEFINE l_xmdc029 LIKE xmdc_t.xmdc029
   DEFINE l_xmdc030 LIKE xmdc_t.xmdc030
   DEFINE l_xmdd006 LIKE xmdd_t.xmdd006
   DEFINE l_inaa007 LIKE inaa_t.inaa007
   DEFINE l_cnt     LIKE type_t.num5
   ]]>
  </point>
  <point name="set_no_entry_b.field_control" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="set_no_entry_b.set_no_entry_b" order="" ver="20" cite_std="N" new="N" status="u" src="s" readonly="" mark_hard="N">
    <![CDATA[
   IF NOT cl_null(g_xmdg_m.xmdg004) THEN
      CALL cl_set_comp_entry("xmdh001",FALSE)
   END IF

   IF cl_null(g_xmdh_d[l_ac].xmdh002) THEN
      CALL cl_set_comp_entry("xmdh011,xmdh012,xmdh013,xmdh014,xmdh016,xmdh019,xmdh021",FALSE)
   END IF

   IF cl_null(g_xmdh_d[l_ac].xmdh006) THEN
      CALL cl_set_comp_entry("xmdh007",FALSE)
   ELSE
      IF g_flag = 'Y' THEN
         CALL cl_set_comp_entry("xmdh002,xmdh003,xmdh004",FALSE)
      END IF
      LET l_imaa005 = ''
      CALL s_axmt500_get_imaa005(g_enterprise,g_xmdh_d[l_ac].xmdh006) RETURNING l_imaa005
      #料件主檔無特徵類別，不能維護產品特徵
      IF cl_null(l_imaa005) THEN
         CALL cl_set_comp_entry("xmdh007",FALSE)
      ELSE
         #若料件有使用產品特徵時，則此欄位不允許空白
         CALL cl_set_comp_required("xmdh007",TRUE)
      END IF
      LET l_imaf015 = ''
      LET l_imaf061 = ''
      LET l_imaf113 = ''
      SELECT imaf015,imaf061,imaf113
        INTO l_imaf015,l_imaf061,l_imaf113
        FROM imaf_t
       WHERE imafent = g_enterprise
         AND imafsite = g_site
         AND imaf001 = g_xmdh_d[l_ac].xmdh006
      #[T:料件據點進銷存檔].[C:批號控管]=1或3時才可輸入
      IF l_imaf061 NOT MATCHES '[13]' THEN
         LET g_xmdh_d[l_ac].xmdh014 = ' '
         CALL cl_set_comp_entry("xmdh014",FALSE)
      END IF
      #[T:料件據點進銷存檔]未設參考單位，參考數量不允許輸入
      IF cl_null(l_imaf015) THEN
         CALL cl_set_comp_entry("xmdh019",FALSE)
      END IF
      #[T:料件據點進銷存檔]未設計價單位，計價數量不允許輸入
      IF cl_null(l_imaf113) THEN
         CALL cl_set_comp_entry("xmdh021",FALSE)
      END IF
   END IF
   
   IF NOT cl_null(g_xmdh_d[l_ac].xmdh001) AND
      NOT cl_null(g_xmdh_d[l_ac].xmdh002) AND
      NOT cl_null(g_xmdh_d[l_ac].xmdh003) AND
      NOT cl_null(g_xmdh_d[l_ac].xmdh004) THEN
      LET l_xmdc022 = ''
      LET l_xmdc028 = ''
      LET l_xmdc029 = ''
      LET l_xmdc030 = ''
      LET l_xmdd006 = ''
      SELECT xmdc022,xmdc028,xmdc029,xmdc030,xmdd006
        INTO l_xmdc022,l_xmdc028,l_xmdc029,l_xmdc030,l_xmdd006
        FROM xmdd_t LEFT OUTER JOIN xmdc_t ON xmdcent = xmddent
                                          AND xmdcsite = xmddsite
                                          AND xmdcdocno = xmdddocno
                                          AND xmdcseq = xmddseq
       WHERE xmddent = g_enterprise
         AND xmddsite = g_site
         AND xmdddocno = g_xmdh_d[l_ac].xmdh001
         AND xmddseq = g_xmdh_d[l_ac].xmdh002
         AND xmddseq1 = g_xmdh_d[l_ac].xmdh003
         AND xmddseq2 = g_xmdh_d[l_ac].xmdh004
      #不允許部分交貨，則不能修改數量
      IF l_xmdc022 = 'N' THEN
         LET g_xmdh_d[l_ac].xmdh016 = l_xmdd006
         CALL cl_set_comp_entry("xmdh016",FALSE)
      END IF
      #訂單是否已有限定庫儲批
      IF NOT cl_null(l_xmdc028) THEN
         CALL cl_set_comp_entry("xmdh011,xmdh012",FALSE)
         IF NOT cl_null(l_xmdc029) THEN
            CALL cl_set_comp_entry("xmdh013",FALSE)
            IF NOT cl_null(l_xmdc030) THEN
               CALL cl_set_comp_entry("xmdh014",FALSE)
            END IF
         END IF
      END IF
   END IF
   
   IF g_xmdh_d[l_ac].xmdh011 = 'Y' THEN
      #若使用多倉儲批，不能限定庫儲批
      CALL cl_set_comp_entry("xmdh0012,xmdh0013,xmdh0014",FALSE)
   END IF

   IF NOT cl_null(g_xmdh_d[l_ac].xmdh012) THEN
      #若有限定庫位，不能再維護多倉儲批
      CALL cl_set_comp_entry("xmdh011",FALSE)
      LET l_inaa007 = ''
      SELECT inaa007 INTO l_inaa007
        FROM inaa_t
       WHERE inaaent = g_enterprise
         AND inaasite = g_site
         AND inaa001 = g_xmdh_d[l_ac].xmdh012
      #儲位控管若為5.不使用儲位控管，則不能維護儲位
      IF l_inaa007 = '5' THEN
         CALL cl_set_comp_entry("xmdh013",FALSE)
      END IF
   END IF

   #ACTION維護單價
   CALL cl_set_comp_entry("xmdh023",FALSE)
   
   #帶入來源單據的專案編號、WBS編號、活動編號，不可修改
   CALL cl_set_comp_entry("xmdh031,xmdh032,xmdh033",FALSE)  #add by lixiang 2015/06/18
   ]]>
  </point>
  <point name="set_pk_array.after" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="set_pk_array.before" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="set_pk_array.define" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="show.after" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[     ]]>
  </point>
  <point name="show.before" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[      ]]>
  </point>
  <point name="show.body.reference" order="" ver="13" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[      
#150123 搬至b_fill段  earl
#      CALL s_feature_description(g_xmdh_d[l_ac].xmdh006,g_xmdh_d[l_ac].xmdh007) RETURNING l_success,g_xmdh_d[l_ac].xmdh007_desc
#
#      #150120新增"客戶訂單號碼"  earl(s)
#      SELECT xmda033 INTO g_xmdh_d[l_ac].xmda033
#        FROM xmda_t
#       WHERE xmdaent = g_enterprise
#         AND xmdadocno = g_xmdh_d[l_ac].xmdh001
#      #150120新增"客戶訂單號碼"  earl(e)
]]>
  </point>
  <point name="show.body2.reference" order="" ver="13" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
#150123 搬至b_fill段  earl
#      CALL s_feature_description(g_xmdh2_d[l_ac].xmdi001,g_xmdh2_d[l_ac].xmdi002) RETURNING l_success,g_xmdh2_d[l_ac].xmdi002_desc
#      
#      CALL s_desc_get_item_desc(g_xmdh2_d[l_ac].xmdi001) RETURNING g_xmdh2_d[l_ac].xmdi001_desc,g_xmdh2_d[l_ac].xmdi001_desc_desc
#      
#      CALL s_desc_get_acc_desc('221',g_xmdh2_d[l_ac].xmdi003) RETURNING g_xmdh2_d[l_ac].xmdi003_desc
#      
#      CALL s_desc_get_stock_desc(g_site,g_xmdh2_d[l_ac].xmdi005) RETURNING g_xmdh2_d[l_ac].xmdi005
#      
#      CALL s_desc_get_locator_desc(g_site,g_xmdh2_d[l_ac].xmdi005,g_xmdh2_d[l_ac].xmdi006) RETURNING g_xmdh2_d[l_ac].xmdi006_desc
#      
#      CALL s_desc_get_unit_desc(g_xmdh2_d[l_ac].xmdi008) RETURNING g_xmdh2_d[l_ac].xmdi008_desc
#     
#      CALL s_desc_get_unit_desc(g_xmdh2_d[l_ac].xmdi010) RETURNING g_xmdh2_d[l_ac].xmdi010_desc
]]>
  </point>
  <point name="show.body3.reference" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[           ]]>
  </point>
  <point name="show.body4.reference" order="" ver="13" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[      
#150123 搬至b_fill段  earl
#      CALL s_feature_description(g_xmdh4_d[l_ac].xmdh0061,g_xmdh4_d[l_ac].xmdh0071) RETURNING l_success,g_xmdh4_d[l_ac].xmdh0071_desc
#      
#      CALL s_desc_get_tax_desc1(g_site,g_xmdh4_d[l_ac].xmdh024) RETURNING g_xmdh4_d[l_ac].xmdh024_desc
      ]]>
  </point>
  <point name="show.define" order="" ver="8" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   DEFINE l_success LIKE type_t.num5]]>
  </point>
  <point name="show.follow_pic" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="show.head.reference" order="" ver="17" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            CALL s_aooi200_get_slip_desc(g_xmdg_m.xmdgdocno) RETURNING g_xmdg_m.xmdgdocno_desc
            
            CALL axmt520_xmdg017_ref()
            CALL axmt520_xmdg023_ref()
            
            CALL s_apmi011_location_ref(g_xmdg_m.xmdg018,g_xmdg_m.xmdg019) RETURNING g_xmdg_m.xmdg019_desc
            
            CALL s_apmi011_location_ref(g_xmdg_m.xmdg018,g_xmdg_m.xmdg020) RETURNING g_xmdg_m.xmdg020_desc
            
            CALL s_desc_get_tax_desc1(g_site,g_xmdg_m.xmdg010) RETURNING g_xmdg_m.xmdg010_desc
           
            CALL s_desc_get_invoice_type_desc1(g_site,g_xmdg_m.xmdg013) RETURNING g_xmdg_m.xmdg013_desc
]]>
  </point>
  <point name="show.other" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[     ]]>
  </point>
  <point name="statechange.a_update" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[     ]]>
  </point>
  <point name="statechange.after" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[     ]]>
  </point>
  <point name="statechange.approved" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="statechange.b_update" order="" ver="20" cite_std="N" new="N" status="u" src="s" readonly="" mark_hard="N">
    <![CDATA[   CALL cl_err_collect_init()
   
   IF lc_state = 'H' THEN
      CALL cl_err_collect_show()
      CALL s_transaction_begin()
      IF NOT axmt520_action_modify('H') THEN
         CALL s_transaction_end('N','0')
         RETURN
      END IF
      CALL s_transaction_end('Y','0')
   END IF
   
   IF lc_state = 'Y' THEN
      IF NOT s_axmt520_conf_chk(g_xmdg_m.xmdgdocno) THEN
         CALL cl_err_collect_show()
         RETURN
      END IF
      IF NOT cl_ask_confirm('aim-00108') THEN
         CALL cl_err_collect_show()
         RETURN
      END IF
      IF s_axmt520_credit_chk(g_xmdg_m.xmdgdocno) = '2' THEN
         LET lc_state = 'H'
      END IF
      CALL s_transaction_begin()
      IF NOT s_axmt520_conf_upd(g_xmdg_m.xmdgdocno) THEN
         CALL s_transaction_end('N','0')
         CALL cl_err_collect_show()
         RETURN
      END IF
      IF lc_state = 'H' THEN
         CALL cl_ask_confirm3("axm-00440","")
         LET g_xmdg_m.xmdgstus = 'H'
         LET g_xmdg_m.xmdg031 = cl_get_para(g_enterprise,g_site,'S-BAS-0047')
         UPDATE xmdg_t
            SET xmdg031 = g_xmdg_m.xmdg031,
                xmdgstus = g_xmdg_m.xmdgstus
          WHERE xmdgent = g_enterprise
            AND xmdgdocno = g_xmdg_m.xmdgdocno
         IF SQLCA.sqlcode THEN
            INITIALIZE g_errparam TO NULL 
            LET g_errparam.extend = "upd xmdg_t" 
            LET g_errparam.code   = SQLCA.sqlcode 
            LET g_errparam.popup  = TRUE 
            CALL cl_err()
            CALL s_transaction_end('N','0')
            CALL cl_err_collect_show()
            RETURN
         END IF
      END IF
      CALL s_transaction_end('Y','0')
      
      #150629---earl---add---s
      #多角自動拋轉
      INITIALIZE la_param.* TO NULL
      LET la_param.prog     = 'aicp300'
      LET la_param.param[1] = g_xmdg_m.xmdgdocno
      LET ls_js = util.JSON.stringify(la_param)
      CALL cl_cmdrun_wait(ls_js)
      #150629---earl---add---e
      
   END IF
   
   IF lc_state = 'X' THEN
      IF NOT s_axmt520_invalid_chk(g_xmdg_m.xmdgdocno) THEN
         CALL cl_err_collect_show()
         RETURN
      END IF
      IF NOT cl_ask_confirm('aim-00109') THEN
         CALL cl_err_collect_show()
         RETURN
      END IF
      CALL s_transaction_begin()
      IF NOT s_axmt520_invalid_upd(g_xmdg_m.xmdgdocno) THEN
         CALL s_transaction_end('N','0')
         CALL cl_err_collect_show()
         RETURN
      END IF
      CALL s_transaction_end('Y','0')
   END IF
   
   IF lc_state = 'N' THEN
      IF NOT s_axmt520_unconf_chk(g_xmdg_m.xmdgdocno) THEN
         CALL cl_err_collect_show()
         RETURN
      END IF
      IF NOT cl_ask_confirm('aim-00110') THEN
         CALL cl_err_collect_show()
         RETURN
      END IF
      
      #150629---earl---add---s
      CALL s_transaction_end('Y','0')
      
      #多角自動拋轉還原
      INITIALIZE la_param.* TO NULL
      LET la_param.prog     = 'aicp310'
      LET la_param.param[1] = g_xmdg_m.xmdgdocno
      LET ls_js = util.JSON.stringify(la_param)
      CALL cl_cmdrun_wait(ls_js)
      
      LET l_xmdg054 = ''
      SELECT xmdg054 INTO l_xmdg054
        FROM xmdg_t
       WHERE xmdgent = g_enterprise
         AND xmdgdocno = g_xmdg_m.xmdg054

      IF l_xmdg054 = 'Y' THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.extend = ""
         LET g_errparam.code   = 'aic-00180'   #多角流程已拋轉之單據不可取消確認！
         LET g_errparam.popup  = TRUE
         CALL cl_err()

         CALL cl_err_collect_show()
         CLOSE axmt520_cl
         RETURN
      END IF
      
      CALL s_transaction_begin()

      OPEN axmt520_cl USING g_enterprise,g_xmdg_m.xmdgdocno
      IF STATUS THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.extend = "OPEN axmt520_cl:"
         LET g_errparam.code   = STATUS
         LET g_errparam.popup  = TRUE
         CALL cl_err()
         CLOSE axmt520_cl
         CALL s_transaction_end('N','0')
         CALL cl_err_collect_show()
         RETURN
      END IF
      #150623---earl---add---e
      
      CALL s_transaction_begin()
      IF NOT s_axmt520_unconf_upd(g_xmdg_m.xmdgdocno) THEN
         CALL s_transaction_end('N','0')
         CALL cl_err_collect_show()
         RETURN
      END IF
      CALL s_transaction_end('Y','0')
   END IF
   
   IF lc_state = 'UH' THEN
      CALL s_transaction_begin()
      LET lc_state = 'Y'
      LET g_xmdg_m.xmdgstus = lc_state
      LET g_xmdg_m.xmdg031 = ''
      LET g_xmdg_m.xmdg031_desc = ''
      LET g_xmdg_m.xmdgmodid = g_user
      LET g_xmdg_m.xmdgmoddt = cl_get_current()
      UPDATE xmdg_t
         SET xmdg031   = g_xmdg_m.xmdg031,
             xmdgstus  = g_xmdg_m.xmdgstus,
             xmdgmodid = g_xmdg_m.xmdgmodid,
             xmdgmoddt = g_xmdg_m.xmdgmoddt
       WHERE xmdgent = g_enterprise AND xmdgdocno = g_xmdg_m.xmdgdocno
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = "upd xmdg_t" 
         LET g_errparam.code   = SQLCA.sqlcode 
         LET g_errparam.popup  = TRUE 
         CALL cl_err()
         CALL s_transaction_end('N','0')
         CALL cl_err_collect_show()
         RETURN
      END IF
      CALL s_transaction_end('Y','0')
   END IF
   
   CALL cl_err_collect_show()]]>
  </point>
  <point name="statechange.before" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[     ]]>
  </point>
  <point name="statechange.before_menu" order="" ver="20" cite_std="N" new="N" status="u" src="s" readonly="" mark_hard="N">
    <![CDATA[      #提交和抽單一開始先無條件關
      #xujing---mark-start
#      CALL cl_set_act_visible("signing,withdraw",FALSE)
#      CALL cl_set_act_visible("confirmed,unconfirmed,invalid,unhold,hold",FALSE)
#      
#      CASE g_xmdg_m.xmdgstus
#         #未確認，需提交至BPM時，則顯示「提交」功能並隱藏「確認」功能
#         WHEN "N"
#            CALL cl_set_act_visible("invalid,confirmed",TRUE)
#            IF cl_bpm_chk() THEN
#               CALL cl_set_act_visible("signing",TRUE)
#               CALL cl_set_act_visible("confirmed",FALSE)
#            END IF  
#         #作廢
#         WHEN "X"
#            RETURN
#         #已確認
#         WHEN "Y"
#            CALL cl_set_act_visible("unconfirmed,hold",TRUE)
#         #已核准只能顯示確認;其餘應用功能皆隱藏
#         WHEN "A"     
#             CALL cl_set_act_visible("confirmed ",TRUE)  
#         #已拒絕，保留修改的功能(如作廢)，隱藏其他應用功能
#         #需提交至BPM時，則顯示「提交」功能並隱藏「確認」功能
#         WHEN "R"
#            CALL cl_set_act_visible("invalid,confirmed",TRUE)
#            IF cl_bpm_chk() THEN
#               CALL cl_set_act_visible("signing",TRUE)
#               CALL cl_set_act_visible("confirmed",FALSE)
#            END IF
#         #抽單，需提交至BPM時，則顯示「提交」功能並隱藏「確認」功能
#         WHEN "D"
#            CALL cl_set_act_visible("invalid,confirmed",TRUE)
#            IF cl_bpm_chk() THEN
#               CALL cl_set_act_visible("signing",TRUE)
#               CALL cl_set_act_visible("confirmed",FALSE)
#            END IF
#         #送簽中只能顯示抽單;其餘應用功能皆隱藏
#         WHEN "W"
#            CALL cl_set_act_visible("withdraw",TRUE)
#         #留置
#         WHEN "H"
#            CALL cl_set_act_visible("unhold",TRUE)
#         END CASE    
 #xujing-mark-end
 #xujing---add-start
      CALL cl_set_act_visible("signing,withdraw",FALSE)
      CALL cl_set_act_visible("unconfirmed,invalid,confirmed,unhold,hold",TRUE)
      CALL cl_set_act_visible("closed",FALSE)

      CASE g_xmdg_m.xmdgstus
         WHEN "N"  
            CALL cl_set_act_visible("unconfirmed,hold,unhold",FALSE)
            #需提交至BPM時，則顯示「提交」功能並隱藏「確認」功能
            IF cl_bpm_chk() THEN
                CALL cl_set_act_visible("signing",TRUE)
                CALL cl_set_act_visible("confirmed",FALSE)
            END IF
 
         WHEN "R"   #保留修改的功能(如作廢)，隱藏其他應用功能(如: 確認、未確認、留置、過帳…)
            CALL cl_set_act_visible("confirmed,unconfirmed,hold,unhold",FALSE)

         WHEN "D"   #保留修改的功能(如作廢)，隱藏其他應用功能(如: 確認、未確認、留置、過帳…)
            CALL cl_set_act_visible("confirmed,unconfirmed,hold,unhold",FALSE) 
          
         WHEN "X"
            RETURN

         WHEN "Y"
            CALL cl_set_act_visible("invalid,confirmed,unhold",FALSE)
         
         WHEN "W"    #只能顯示抽單;其餘應用功能皆隱藏
             CALL cl_set_act_visible("withdraw",TRUE)  
             CALL cl_set_act_visible("unconfirmed,invalid,confirmed,hold,unhold",FALSE)
         
         WHEN "A"     #只能顯示確認; 其餘應用功能皆隱藏
             CALL cl_set_act_visible("confirmed ",TRUE)  
             CALL cl_set_act_visible("unconfirmed,invalid,hold,unhold",FALSE)
         WHEN "H"
            CALL cl_set_act_visible("hold,unconfirmed,invalid,confirmed",FALSE)
      END CASE

 #xujing---add---end]]>
  </point>
  <point name="statechange.confirmed" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="statechange.define" order="" ver="20" cite_std="N" new="N" status="u" src="s" readonly="" mark_hard="N">
    <![CDATA[   DEFINE l_xmaj003_1 LIKE xmaj_t.xmaj003  #出通單確認時超限控管方式(據點)
   DEFINE l_xmaj003_2 LIKE xmaj_t.xmaj003  #出通單確認時超限控管方式(集團)
   
   #150629 earl add start
   DEFINE la_param   RECORD
          prog          STRING,
          actionid      STRING,
          background    LIKE type_t.chr1,
          param         DYNAMIC ARRAY OF STRING
                     END RECORD

   DEFINE ls_js         STRING
   DEFINE l_xmdg054     LIKE xmdg_t.xmdg054
   #150629 earl add end
   ]]>
  </point>
  <point name="statechange.hold" order="" ver="13" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="statechange.invalid" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="statechange.more_control" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[           ]]>
  </point>
  <point name="statechange.open" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                  ]]>
  </point>
  <point name="statechange.rejection" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="statechange.signing" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="statechange.unconfirmed" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="statechange.unhold" order="" ver="13" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ]]>
  </point>
  <point name="statechange.withdraw" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="ui_browser_refresh.define" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[     ]]>
  </point>
  <point name="ui_detailshow.after" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[     ]]>
  </point>
  <point name="ui_detailshow.before" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[     ]]>
  </point>
  <point name="ui_detailshow.define" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[     ]]>
  </point>
  <point name="ui_dialog.action.filter" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="ui_dialog.action_default" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[           ]]>
  </point>
  <point name="ui_dialog.b_exit" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="ui_dialog.before_dialog" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[     ]]>
  </point>
  <point name="ui_dialog.before_dialog2" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="ui_dialog.body2.action" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="ui_dialog.body2.before_display" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                             ]]>
  </point>
  <point name="ui_dialog.body2.before_row" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                             ]]>
  </point>
  <point name="ui_dialog.body3.action" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="ui_dialog.body3.before_display" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                             ]]>
  </point>
  <point name="ui_dialog.body3.before_row" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                             ]]>
  </point>
  <point name="ui_dialog.body4.action" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="ui_dialog.body4.before_display" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                             ]]>
  </point>
  <point name="ui_dialog.body4.before_row" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                             ]]>
  </point>
  <point name="ui_dialog.define" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   DEFINE l_success  LIKE type_t.num5
   DEFINE l_rollback LIKE type_t.num5
   DEFINE l_xmdh012  LIKE xmdh_t.xmdh012
   DEFINE l_xmdh013  LIKE xmdh_t.xmdh013
   DEFINE l_xmdh014  LIKE xmdh_t.xmdh014
   DEFINE l_xmdh029  LIKE xmdh_t.xmdh029
   ]]>
  </point>
  <point name="ui_dialog.dialog.agendum" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="ui_dialog.dialog.followup" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="ui_dialog.dialog.related_document" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="ui_dialog.more_displayarray" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                 ]]>
  </point>
  <point name="ui_dialog.page1.action" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                       ]]>
  </point>
  <point name="ui_dialog.page1.before_display" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                             ]]>
  </point>
  <point name="ui_dialog.page1.before_row" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[                             ]]>
  </point>
  <point name="ui_headershow.define" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[     ]]>
  </point>
  <point name="unlock_b.define" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[     ]]>
  </point>
  <point name="unlock_b.other" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[     ]]>
  </point>
  <point name="update_b.after_update" order="" ver="13" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="update_b.after_update2" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[           ]]>
  </point>
  <point name="update_b.before_update" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[      IF cl_null(g_xmdh_d[g_detail_idx].xmdhsite) THEN
         LET g_xmdh_d[g_detail_idx].xmdhsite = g_site
      END IF
      ]]>
  </point>
  <point name="update_b.before_update2" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[      IF cl_null(g_xmdh2_d[g_detail_idx].xmdisite) THEN
         LET g_xmdh2_d[g_detail_idx].xmdisite = g_site
      END IF
      ]]>
  </point>
  <point name="update_b.define" order="" ver="13" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   DEFINE l_success        LIKE type_t.num5 
     ]]>
  </point>
  <point name="update_b.m_update" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[           ]]>
  </point>
  <point name="update_b.m_update2" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[           ]]>
  </point>
  <point name="update_b.other" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[     ]]>
  </point>
  <section id="axmt520.action_chk" ver="2" status="" src="s" readonly="">
    <![CDATA[#+ 修改/刪除前行為檢查(是否可允許此動作), 若有其他行為須管控也可透過此段落
PRIVATE FUNCTION axmt520_action_chk()
   #add-point:action_chk段define
   {<point name="action_chk.define" edit="s"/>}
   #end add-point
   #add-point:action_chk段define(客製用)
   {<point name="action_chk.define_customerization" edit="c"/>}
   #end add-point
   
   #add-point:action_chk段action_chk
   {<point name="action_chk.action_chk"/>}
   #end add-point
   
   RETURN TRUE
   
END FUNCTION
]]>
  </section>
  <section id="axmt520.b_fill" ver="43" status="" src="s" readonly="">
    <![CDATA[#+ 單身陣列填充
PRIVATE FUNCTION axmt520_b_fill()
   DEFINE p_wc2      STRING
   DEFINE li_idx     LIKE type_t.num10
   #add-point:b_fill段define
   {<point name="b_fill.define" edit="s"/>}
   #end add-point     
   #add-point:b_fill段define(客製用)
   {<point name="b_fill.define_customerization" edit="c"/>}
   #end add-point     
 
   CALL g_xmdh_d.clear()    #g_xmdh_d 單頭及單身 
   CALL g_xmdh2_d.clear()
   CALL g_xmdh3_d.clear()
   CALL g_xmdh4_d.clear()
 
 
   #add-point:b_fill段sql_before
   {<point name="b_fill.sql_before"/>}
   #end add-point
   
   #判斷是否填充
   IF axmt520_fill_chk(1) THEN
      #切換上下筆時不重組SQL
      IF g_action_choice <> 'fetch' OR cl_null(g_action_choice) THEN
         LET g_sql = "SELECT  UNIQUE xmdhsite,xmdhseq,xmdh001,xmdh002,xmdh003,xmdh004,xmdh005,xmdh006, 
             xmdh007,xmdh034,xmdh009,xmdh010,xmdh015,xmdh016,xmdh017,xmdh018,xmdh019,xmdh008,xmdh011, 
             xmdh012,xmdh013,xmdh014,xmdh029,xmdh020,xmdh021,xmdh022,xmdh036,xmdh031,xmdh032,xmdh033, 
             xmdh050,xmdh056,xmdh030,xmdh051,xmdh052,xmdhunit,xmdh035,xmdhseq,xmdh023,xmdh024,xmdh025, 
             xmdh026,xmdh027,xmdh028 ,t1.imaal003 ,t2.imaal004 ,t3.oocql004 ,t4.oocal003 ,t5.oocal003 , 
             t6.inayl003 ,t7.inab003 ,t8.oocal003 ,t16.imaal003 ,t17.imaal004 ,t18.oocql004 ,t19.oocal003 , 
             t20.oocal003 FROM xmdh_t",   
                     " INNER JOIN xmdg_t ON xmdgdocno = xmdhdocno ",
 
                     #"",
                     
                     "",
                                    " LEFT JOIN imaal_t t1 ON t1.imaalent='"||g_enterprise||"' AND t1.imaal001=xmdh006 AND t1.imaal002='"||g_dlang||"' ",
               " LEFT JOIN imaal_t t2 ON t2.imaalent='"||g_enterprise||"' AND t2.imaal001=xmdh006 AND t2.imaal002='"||g_dlang||"' ",
               " LEFT JOIN oocql_t t3 ON t3.oocqlent='"||g_enterprise||"' AND t3.oocql001='221' AND t3.oocql002=xmdh009 AND t3.oocql003='"||g_dlang||"' ",
               " LEFT JOIN oocal_t t4 ON t4.oocalent='"||g_enterprise||"' AND t4.oocal001=xmdh015 AND t4.oocal002='"||g_dlang||"' ",
               " LEFT JOIN oocal_t t5 ON t5.oocalent='"||g_enterprise||"' AND t5.oocal001=xmdh018 AND t5.oocal002='"||g_dlang||"' ",
               " LEFT JOIN inayl_t t6 ON t6.inaylent='"||g_enterprise||"' AND t6.inayl001=xmdh012 AND t6.inayl002='"||g_dlang||"' ",
               " LEFT JOIN inab_t t7 ON t7.inabent='"||g_enterprise||"' AND t7.inabsite=xmdhsite AND t7.inab001=xmdh012 AND t7.inab002=xmdh013  ",
               " LEFT JOIN oocal_t t8 ON t8.oocalent='"||g_enterprise||"' AND t8.oocal001=xmdh020 AND t8.oocal002='"||g_dlang||"' ",
               " LEFT JOIN imaal_t t16 ON t16.imaalent='"||g_enterprise||"' AND t16.imaal001=xmdh006 AND t16.imaal002='"||g_dlang||"' ",
               " LEFT JOIN imaal_t t17 ON t17.imaalent='"||g_enterprise||"' AND t17.imaal001=xmdh006 AND t17.imaal002='"||g_dlang||"' ",
               " LEFT JOIN oocql_t t18 ON t18.oocqlent='"||g_enterprise||"' AND t18.oocql001='221' AND t18.oocql002=xmdh009 AND t18.oocql003='"||g_dlang||"' ",
               " LEFT JOIN oocal_t t19 ON t19.oocalent='"||g_enterprise||"' AND t19.oocal001=xmdh015 AND t19.oocal002='"||g_dlang||"' ",
               " LEFT JOIN oocal_t t20 ON t20.oocalent='"||g_enterprise||"' AND t20.oocal001=xmdh020 AND t20.oocal002='"||g_dlang||"' ",
 
                     " WHERE xmdhent=? AND xmdhdocno=?"
         LET g_sql = cl_sql_add_mask(g_sql)              #遮蔽特定資料
         #add-point:b_fill段sql_before
         {<point name="b_fill.body.fill_sql"/>}
         #end add-point
         IF NOT cl_null(g_wc2_table1) THEN
            LET g_sql = g_sql CLIPPED, " AND ", g_wc2_table1 CLIPPED
         END IF
         
         #子單身的WC
         
         
         LET g_sql = g_sql, " ORDER BY xmdh_t.xmdhseq"
         
         #add-point:單身填充控制
         {<point name="b_fill.sql"/>}
         #end add-point
         
         LET g_sql = cl_sql_add_mask(g_sql)              #遮蔽特定資料
         PREPARE axmt520_pb FROM g_sql
         DECLARE b_fill_cs CURSOR FOR axmt520_pb
      END IF
      
      LET g_cnt = l_ac
      LET l_ac = 1
      
      OPEN b_fill_cs USING g_enterprise,g_xmdg_m.xmdgdocno
                                               
      FOREACH b_fill_cs INTO g_xmdh_d[l_ac].xmdhsite,g_xmdh_d[l_ac].xmdhseq,g_xmdh_d[l_ac].xmdh001,g_xmdh_d[l_ac].xmdh002, 
          g_xmdh_d[l_ac].xmdh003,g_xmdh_d[l_ac].xmdh004,g_xmdh_d[l_ac].xmdh005,g_xmdh_d[l_ac].xmdh006, 
          g_xmdh_d[l_ac].xmdh007,g_xmdh_d[l_ac].xmdh034,g_xmdh_d[l_ac].xmdh009,g_xmdh_d[l_ac].xmdh010, 
          g_xmdh_d[l_ac].xmdh015,g_xmdh_d[l_ac].xmdh016,g_xmdh_d[l_ac].xmdh017,g_xmdh_d[l_ac].xmdh018, 
          g_xmdh_d[l_ac].xmdh019,g_xmdh_d[l_ac].xmdh008,g_xmdh_d[l_ac].xmdh011,g_xmdh_d[l_ac].xmdh012, 
          g_xmdh_d[l_ac].xmdh013,g_xmdh_d[l_ac].xmdh014,g_xmdh_d[l_ac].xmdh029,g_xmdh_d[l_ac].xmdh020, 
          g_xmdh_d[l_ac].xmdh021,g_xmdh_d[l_ac].xmdh022,g_xmdh_d[l_ac].xmdh036,g_xmdh_d[l_ac].xmdh031, 
          g_xmdh_d[l_ac].xmdh032,g_xmdh_d[l_ac].xmdh033,g_xmdh_d[l_ac].xmdh050,g_xmdh_d[l_ac].xmdh056, 
          g_xmdh_d[l_ac].xmdh030,g_xmdh_d[l_ac].xmdh051,g_xmdh_d[l_ac].xmdh052,g_xmdh_d[l_ac].xmdhunit, 
          g_xmdh_d[l_ac].xmdh035,g_xmdh4_d[l_ac].xmdhseq,g_xmdh4_d[l_ac].xmdh023,g_xmdh4_d[l_ac].xmdh024, 
          g_xmdh4_d[l_ac].xmdh025,g_xmdh4_d[l_ac].xmdh026,g_xmdh4_d[l_ac].xmdh027,g_xmdh4_d[l_ac].xmdh028, 
          g_xmdh_d[l_ac].xmdh006_desc,g_xmdh_d[l_ac].xmdh006_desc_desc,g_xmdh_d[l_ac].xmdh009_desc,g_xmdh_d[l_ac].xmdh015_desc, 
          g_xmdh_d[l_ac].xmdh018_desc,g_xmdh_d[l_ac].xmdh012_desc,g_xmdh_d[l_ac].xmdh013_desc,g_xmdh_d[l_ac].xmdh020_desc, 
          g_xmdh4_d[l_ac].xmdh0061_desc,g_xmdh4_d[l_ac].xmdh0061_desc_desc,g_xmdh4_d[l_ac].xmdh0091_desc, 
          g_xmdh4_d[l_ac].xmdh0151_desc,g_xmdh4_d[l_ac].xmdh0201_desc
         IF SQLCA.sqlcode THEN
            INITIALIZE g_errparam TO NULL 
            LET g_errparam.extend = "FOREACH:" 
            LET g_errparam.code   = SQLCA.sqlcode 
            LET g_errparam.popup  = TRUE 
            CALL cl_err()
            EXIT FOREACH
         END IF
        
         #add-point:b_fill段資料填充
         {<point name="b_fill.fill"/>}
         #end add-point
      
         IF l_ac > g_max_rec THEN
            IF g_error_show = 1 THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = l_ac
               LET g_errparam.code   = 9035 
               LET g_errparam.popup  = TRUE 
               CALL cl_err()
            END IF
            EXIT FOREACH
         END IF
         
         LET l_ac = l_ac + 1
      END FOREACH
      LET g_error_show = 0
   
   END IF
   
   #判斷是否填充
   IF axmt520_fill_chk(2) THEN
      IF g_action_choice <> 'fetch' OR cl_null(g_action_choice) THEN
         LET g_sql = "SELECT  UNIQUE xmdisite,xmdiseq,xmdiseq1,xmdi001,xmdi002,xmdi003,xmdi004,xmdi005, 
             xmdi006,xmdi007,xmdi013,xmdi008,xmdi009,xmdi010,xmdi011,xmdi012 ,t9.imaal003 ,t10.imaal004 , 
             t11.oocql004 ,t12.inayl003 ,t13.inab003 ,t14.oocal003 ,t15.oocal003 FROM xmdi_t",   
                     " INNER JOIN xmdg_t ON xmdgdocno = xmdidocno ",
 
                     "",
                     
                                    " LEFT JOIN imaal_t t9 ON t9.imaalent='"||g_enterprise||"' AND t9.imaal001=xmdi001 AND t9.imaal002='"||g_dlang||"' ",
               " LEFT JOIN imaal_t t10 ON t10.imaalent='"||g_enterprise||"' AND t10.imaal001=xmdi001 AND t10.imaal002='"||g_dlang||"' ",
               " LEFT JOIN oocql_t t11 ON t11.oocqlent='"||g_enterprise||"' AND t11.oocql001='221' AND t11.oocql002=xmdi003 AND t11.oocql003='"||g_dlang||"' ",
               " LEFT JOIN inayl_t t12 ON t12.inaylent='"||g_enterprise||"' AND t12.inayl001=xmdi005 AND t12.inayl002='"||g_dlang||"' ",
               " LEFT JOIN inab_t t13 ON t13.inabent='"||g_enterprise||"' AND t13.inabsite=xmdisite AND t13.inab001=xmdi005 AND t13.inab002=xmdi006  ",
               " LEFT JOIN oocal_t t14 ON t14.oocalent='"||g_enterprise||"' AND t14.oocal001=xmdi008 AND t14.oocal002='"||g_dlang||"' ",
               " LEFT JOIN oocal_t t15 ON t15.oocalent='"||g_enterprise||"' AND t15.oocal001=xmdi010 AND t15.oocal002='"||g_dlang||"' ",
 
                     " WHERE xmdient=? AND xmdidocno=?"   
         LET g_sql = cl_sql_add_mask(g_sql)              #遮蔽特定資料
         #add-point:b_fill段sql_before
         {<point name="b_fill.body2.fill_sql"/>}
         #end add-point
         IF NOT cl_null(g_wc2_table2) THEN
            LET g_sql = g_sql CLIPPED," AND ",g_wc2_table2 CLIPPED
         END IF
         
         #子單身的WC
         
         
         LET g_sql = g_sql, " ORDER BY xmdi_t.xmdiseq,xmdi_t.xmdiseq1"
         
         #add-point:單身填充控制
         {<point name="b_fill.sql2"/>}
         #end add-point
         
         LET g_sql = cl_sql_add_mask(g_sql)              #遮蔽特定資料
         PREPARE axmt520_pb2 FROM g_sql
         DECLARE b_fill_cs2 CURSOR FOR axmt520_pb2
      END IF
    
      LET l_ac = 1
      
      OPEN b_fill_cs2 USING g_enterprise,g_xmdg_m.xmdgdocno
                                               
      FOREACH b_fill_cs2 INTO g_xmdh2_d[l_ac].xmdisite,g_xmdh2_d[l_ac].xmdiseq,g_xmdh2_d[l_ac].xmdiseq1, 
          g_xmdh2_d[l_ac].xmdi001,g_xmdh2_d[l_ac].xmdi002,g_xmdh2_d[l_ac].xmdi003,g_xmdh2_d[l_ac].xmdi004, 
          g_xmdh2_d[l_ac].xmdi005,g_xmdh2_d[l_ac].xmdi006,g_xmdh2_d[l_ac].xmdi007,g_xmdh2_d[l_ac].xmdi013, 
          g_xmdh2_d[l_ac].xmdi008,g_xmdh2_d[l_ac].xmdi009,g_xmdh2_d[l_ac].xmdi010,g_xmdh2_d[l_ac].xmdi011, 
          g_xmdh2_d[l_ac].xmdi012,g_xmdh2_d[l_ac].xmdi001_desc,g_xmdh2_d[l_ac].xmdi001_desc_desc,g_xmdh2_d[l_ac].xmdi003_desc, 
          g_xmdh2_d[l_ac].xmdi005_desc,g_xmdh2_d[l_ac].xmdi006_desc,g_xmdh2_d[l_ac].xmdi008_desc,g_xmdh2_d[l_ac].xmdi010_desc 

         IF SQLCA.sqlcode THEN
            INITIALIZE g_errparam TO NULL 
            LET g_errparam.extend = "FOREACH:" 
            LET g_errparam.code   = SQLCA.sqlcode 
            LET g_errparam.popup  = TRUE 
            CALL cl_err()
            EXIT FOREACH
         END IF
        
         #add-point:b_fill段資料填充
         {<point name="b_fill2.fill"/>}
         #end add-point
      
         LET l_ac = l_ac + 1
         IF l_ac > g_max_rec THEN
            INITIALIZE g_errparam TO NULL 
            LET g_errparam.extend = l_ac
            LET g_errparam.code   = 9035 
            LET g_errparam.popup  = TRUE 
            CALL cl_err()
            EXIT FOREACH
         END IF
         
      END FOREACH
   END IF
 
 
   
   #add-point:browser_fill段其他table處理
   {<point name="browser_fill.other_fill"/>}
   #end add-point
   
   CALL g_xmdh_d.deleteElement(g_xmdh_d.getLength())
   CALL g_xmdh2_d.deleteElement(g_xmdh2_d.getLength())
   CALL g_xmdh3_d.deleteElement(g_xmdh3_d.getLength())
   CALL g_xmdh4_d.deleteElement(g_xmdh4_d.getLength())
 
   
 
   LET l_ac = g_cnt
   LET g_cnt = 0  
   
   FREE axmt520_pb
   FREE axmt520_pb2
 
 
   
   LET li_idx = l_ac
   
   #遮罩相關處理
   FOR l_ac = 1 TO g_xmdh_d.getLength()
      LET g_xmdh_d_mask_o[l_ac].* =  g_xmdh_d[l_ac].*
      CALL axmt520_xmdh_t_mask()
      LET g_xmdh_d_mask_n[l_ac].* =  g_xmdh_d[l_ac].*
   END FOR
   
   LET g_xmdh2_d_mask_o.* =  g_xmdh2_d.*
   FOR l_ac = 1 TO g_xmdh2_d.getLength()
      LET g_xmdh2_d_mask_o[l_ac].* =  g_xmdh2_d[l_ac].*
      CALL axmt520_xmdi_t_mask()
      LET g_xmdh2_d_mask_n[l_ac].* =  g_xmdh2_d[l_ac].*
   END FOR
   LET g_xmdh3_d_mask_o.* =  g_xmdh3_d.*
   FOR l_ac = 1 TO g_xmdh3_d.getLength()
      LET g_xmdh3_d_mask_o[l_ac].* =  g_xmdh3_d[l_ac].*
      CALL axmt520_xmdh_t_mask()
      LET g_xmdh3_d_mask_n[l_ac].* =  g_xmdh3_d[l_ac].*
   END FOR
   LET g_xmdh4_d_mask_o.* =  g_xmdh4_d.*
   FOR l_ac = 1 TO g_xmdh4_d.getLength()
      LET g_xmdh4_d_mask_o[l_ac].* =  g_xmdh4_d[l_ac].*
      CALL axmt520_xmdh_t_mask()
      LET g_xmdh4_d_mask_n[l_ac].* =  g_xmdh4_d[l_ac].*
   END FOR
 
   
   LET l_ac = li_idx
   
   CALL cl_ap_performance_next_end()
 
END FUNCTION
]]>
  </section>
  <section id="axmt520.b_fill2" ver="6" status="" src="s" readonly="">
    <![CDATA[#+ 單身陣列填充2
PRIVATE FUNCTION axmt520_b_fill2(pi_idx)
   DEFINE pi_idx          LIKE type_t.num10
   DEFINE li_ac           LIKE type_t.num10
   DEFINE ls_chk          LIKE type_t.chr1
   #add-point:b_fill2段define
   {<point name="b_fill2.define" edit="s"/>}
   #end add-point
   #add-point:b_fill2段define(客製用)
   {<point name="b_fill2.define_customerization" edit="c"/>}
   #end add-point
   
   LET li_ac = l_ac 
   
   IF g_detail_idx <= 0 THEN
      RETURN
   END IF
   
 
      
 
      
   #add-point:單身填充後
   {<point name="b_fill2.after_fill" />}
   #end add-point
    
   LET l_ac = li_ac
   
   CALL axmt520_detail_show()
   
END FUNCTION
]]>
  </section>
  <section id="axmt520.browser_fill" ver="44" status="" src="s" readonly="">
    <![CDATA[#+ 瀏覽頁簽資料填充
PRIVATE FUNCTION axmt520_browser_fill(ps_page_action)
   DEFINE ps_page_action    STRING
   DEFINE l_wc              STRING
   DEFINE l_wc2             STRING
   DEFINE l_sql             STRING
   DEFINE l_sub_sql         STRING
   DEFINE l_sql_rank        STRING
   #add-point:browser_fill段define
   {<point name="browser_fill.define" edit="s"/>}
   #end add-point   
   #add-point:browser_fill段define(客製用)
   {<point name="browser_fill.define_customerization" edit="c"/>}
   #end add-point   
   
   #add-point:browser_fill段動作開始前
   {<point name="browser_fill.before_browser_fill"/>}
   #end add-point
   
   IF cl_null(g_wc) THEN
      LET g_wc = " 1=1"
   END IF
   IF cl_null(g_wc2) THEN
      LET g_wc2 = " 1=1"
   END IF
   LET l_wc  = g_wc.trim() 
   LET l_wc2 = g_wc2.trim()
 
   #add-point:browser_fill,foreach前
   {<point name="browser_fill.before_foreach"/>}
   #end add-point
   
   IF g_wc2 <> " 1=1" THEN
      #單身有輸入搜尋條件                      
      LET l_sub_sql = " SELECT UNIQUE xmdgdocno ",
                      " FROM xmdg_t ",
                      " ",
                      " LEFT JOIN xmdh_t ON xmdhent = xmdgent AND xmdgdocno = xmdhdocno ", "  ",
                      #add-point:browser_fill段sql(xmdh_t1)
                      {<point name="browser_fill.cnt.join.}"/>}
                      #end add-point
                      " LEFT JOIN xmdi_t ON xmdient = xmdgent AND xmdgdocno = xmdidocno", "  ",
                      #add-point:browser_fill段sql(xmdi_t1)
                      {<point name="browser_fill.cnt.join.xmdi_t1"/>}
                      #end add-point
 
 
 
                      " ", 
                      " ", 
                      " WHERE xmdgent = '" ||g_enterprise|| "' AND xmdhent = '" ||g_enterprise|| "' AND ",l_wc, " AND ", l_wc2, cl_sql_add_filter("xmdg_t")
   ELSE
      #單身未輸入搜尋條件
      LET l_sub_sql = " SELECT UNIQUE xmdgdocno ",
                      " FROM xmdg_t ", 
                      "  ",
                      "  ",
                      " WHERE xmdgent = '" ||g_enterprise|| "' AND ",l_wc CLIPPED, cl_sql_add_filter("xmdg_t")
   END IF
   
   #add-point:browser_fill,cnt wc
   {<point name="browser_fill.cnt_sqlwc"/>}
   #end add-point
   
   LET g_sql = " SELECT COUNT(*) FROM (",l_sub_sql,")"
   
   #add-point:browser_fill,count前
   {<point name="browser_fill.before_count"/>}
   #end add-point
   
   PREPARE header_cnt_pre FROM g_sql
   EXECUTE header_cnt_pre INTO g_browser_cnt   #總筆數
   FREE header_cnt_pre
    
   IF g_browser_cnt > g_max_browse THEN
      IF g_error_show = 1 THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = g_browser_cnt
         LET g_errparam.code   = 9035 
         LET g_errparam.popup  = TRUE 
         CALL cl_err()
      END IF
      LET g_browser_cnt = g_max_browse
   END IF
   
   DISPLAY g_browser_cnt TO FORMONLY.b_count   #總筆數的顯示
   DISPLAY g_browser_cnt TO FORMONLY.h_count   #總筆數的顯示
 
   #根據行為確定資料填充位置及WC
   IF cl_null(g_add_browse) THEN
      #清除畫面
      CLEAR FORM                
      INITIALIZE g_xmdg_m.* TO NULL
      CALL g_xmdh_d.clear()        
      CALL g_xmdh2_d.clear() 
      CALL g_xmdh3_d.clear() 
      CALL g_xmdh4_d.clear() 
 
      #add-point:browser_fill g_add_browse段額外處理
      {<point name="browser_fill.add_browse.other"/>}
      #end add-point   
      CALL g_browser.clear()
      LET g_cnt = 1
   ELSE
      LET l_wc  = g_add_browse
      LET l_wc2 = " 1=1" 
      LET g_cnt = g_current_idx
   END IF
 
   #依照t0.xmdgdocno,t0.xmdgdocdt,t0.xmdg002,t0.xmdg003,t0.xmdg004,t0.xmdg005,t0.xmdg006,t0.xmdg007 Browser欄位定義(取代原本bs_sql功能)
   #考量到單身可能下條件, 所以此處需join單身所有table
   #DISTINCT是為了避免在join時出現重複的資料(如果不加DISTINCT則須在程式中過濾)
   LET g_sql = " SELECT DISTINCT t0.xmdgstus,t0.xmdgdocno,t0.xmdgdocdt,t0.xmdg002,t0.xmdg003,t0.xmdg004, 
       t0.xmdg005,t0.xmdg006,t0.xmdg007,t1.ooag011 ,t2.ooefl003 ,t3.pmaal004 ,t4.pmaal004 ,t5.pmaal004 ", 

               " FROM xmdg_t t0",
               "  ",
               "  LEFT JOIN xmdh_t ON xmdhent = xmdgent AND xmdgdocno = xmdhdocno ", "  ", 
               #add-point:browser_fill段sql(xmdh_t1)
               {<point name="browser_fill.join.xmdh_t1"/>}
               #end add-point
               "  LEFT JOIN xmdi_t ON xmdient = xmdgent AND xmdgdocno = xmdidocno", "  ", 
               #add-point:browser_fill段sql(xmdi_t1)
               {<point name="browser_fill.join.xmdi_t1"/>}
               #end add-point
 
 
 
               "  ",
                              " LEFT JOIN ooag_t t1 ON t1.ooagent='"||g_enterprise||"' AND t1.ooag001=t0.xmdg002  ",
               " LEFT JOIN ooefl_t t2 ON t2.ooeflent='"||g_enterprise||"' AND t2.ooefl001=t0.xmdg003 AND t2.ooefl002='"||g_lang||"' ",
               " LEFT JOIN pmaal_t t3 ON t3.pmaalent='"||g_enterprise||"' AND t3.pmaal001=t0.xmdg005 AND t3.pmaal002='"||g_lang||"' ",
               " LEFT JOIN pmaal_t t4 ON t4.pmaalent='"||g_enterprise||"' AND t4.pmaal001=t0.xmdg006 AND t4.pmaal002='"||g_lang||"' ",
               " LEFT JOIN pmaal_t t5 ON t5.pmaalent='"||g_enterprise||"' AND t5.pmaal001=t0.xmdg007 AND t5.pmaal002='"||g_lang||"' ",
 
               " WHERE t0.xmdgent = '" ||g_enterprise|| "' AND ",l_wc," AND ",l_wc2, cl_sql_add_filter("xmdg_t")
   #add-point:browser_fill,sql wc
   {<point name="browser_fill.fill_sqlwc"/>}
   #end add-point
   LET g_sql = g_sql, " ORDER BY xmdgdocno ",g_order
 
   #add-point:browser_fill,before_prepare
   {<point name="browser_fill.before_prepare"/>}
   #end add-point
        
   #LET g_sql = cl_sql_add_tabid(g_sql,"xmdg_t") #WC重組
   LET g_sql = cl_sql_add_mask(g_sql) #遮蔽特定資料
   PREPARE browse_pre FROM g_sql
   DECLARE browse_cur CURSOR FOR browse_pre
   
   #add-point:browser_fill段open cursor
   {<point name="browser_fill.open"/>}
   #end add-point
   
   FOREACH browse_cur INTO g_browser[g_cnt].b_statepic,g_browser[g_cnt].b_xmdgdocno,g_browser[g_cnt].b_xmdgdocdt, 
       g_browser[g_cnt].b_xmdg002,g_browser[g_cnt].b_xmdg003,g_browser[g_cnt].b_xmdg004,g_browser[g_cnt].b_xmdg005, 
       g_browser[g_cnt].b_xmdg006,g_browser[g_cnt].b_xmdg007,g_browser[g_cnt].b_xmdg002_desc,g_browser[g_cnt].b_xmdg003_desc, 
       g_browser[g_cnt].b_xmdg005_desc,g_browser[g_cnt].b_xmdg006_desc,g_browser[g_cnt].b_xmdg007_desc 

      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = 'foreach:' 
         LET g_errparam.code   = SQLCA.sqlcode 
         LET g_errparam.popup  = TRUE 
         CALL cl_err()
         EXIT FOREACH
      END IF
  
      #add-point:browser_fill段reference
      {<point name="browser_fill.reference"/>}
      #end add-point
  
      #遮罩相關處理
      CALL axmt520_browser_mask()
  
            #應用 a24 樣板自動產生(Version:2)
      #browser顯示圖片
      CASE g_browser[g_cnt].b_statepic
         WHEN "N"
            LET g_browser[g_cnt].b_statepic = "stus/16/unconfirmed.png"
         WHEN "Y"
            LET g_browser[g_cnt].b_statepic = "stus/16/confirmed.png"
         WHEN "A"
            LET g_browser[g_cnt].b_statepic = "stus/16/approved.png"
         WHEN "D"
            LET g_browser[g_cnt].b_statepic = "stus/16/withdraw.png"
         WHEN "R"
            LET g_browser[g_cnt].b_statepic = "stus/16/rejection.png"
         WHEN "W"
            LET g_browser[g_cnt].b_statepic = "stus/16/signing.png"
         WHEN "H"
            LET g_browser[g_cnt].b_statepic = "stus/16/hold.png"
         WHEN "UH"
            LET g_browser[g_cnt].b_statepic = "stus/16/unhold.png"
         WHEN "X"
            LET g_browser[g_cnt].b_statepic = "stus/16/invalid.png"
         
      END CASE
 
 
      LET g_cnt = g_cnt + 1
      IF g_cnt > g_max_browse THEN
         EXIT FOREACH
      END IF
      
   END FOREACH
   
   #清空g_add_browse, 並指定指標位置
   IF NOT cl_null(g_add_browse) THEN
      LET g_add_browse = ""
      CALL g_curr_diag.setCurrentRow("s_browse",g_current_idx)
   END IF
   
   IF cl_null(g_browser[g_cnt].b_xmdgdocno) THEN
      CALL g_browser.deleteElement(g_cnt)
   END IF
   
   LET g_header_cnt  = g_browser.getLength()
   LET g_browser_cnt = g_browser.getLength()
   
   #筆數顯示
   IF g_browser_cnt > 0 THEN
      DISPLAY g_browser_idx TO FORMONLY.b_index #當下筆數
      DISPLAY g_browser_cnt TO FORMONLY.b_count #總筆數
      DISPLAY g_browser_idx TO FORMONLY.h_index #當下筆數
      DISPLAY g_browser_cnt TO FORMONLY.h_count #總筆數
      DISPLAY g_detail_idx  TO FORMONLY.idx     #單身當下筆數
      DISPLAY g_detail_cnt  TO FORMONLY.cnt     #單身總筆數
   ELSE
      DISPLAY '' TO FORMONLY.b_index #當下筆數
      DISPLAY '' TO FORMONLY.b_count #總筆數
      DISPLAY '' TO FORMONLY.h_index #當下筆數
      DISPLAY '' TO FORMONLY.h_count #總筆數
      DISPLAY '' TO FORMONLY.idx     #單身當下筆數
      DISPLAY '' TO FORMONLY.cnt     #單身總筆數
   END IF
 
   LET g_rec_b = g_cnt - 1
   LET g_detail_cnt = g_rec_b
   LET g_cnt = 0
   
   FREE browse_pre
   
   #若無資料則關閉相關功能
   IF g_browser_cnt = 0 THEN
      CALL cl_set_act_visible("statechange,modify,modify_detail,delete,reproduce,mainhidden", FALSE)
      CALL cl_navigator_setting(0,0)
   ELSE
      CALL cl_set_act_visible("mainhidden", TRUE)
   END IF
                  
   
   #add-point:browser_fill段結束前
   {<point name="browser_fill.after"/>}
   #end add-point   
 
END FUNCTION
]]>
  </section>
  <section id="axmt520.construct" ver="52" status="" src="s" readonly="">
    <![CDATA[#+ QBE資料查詢
PRIVATE FUNCTION axmt520_construct()
   DEFINE ls_return   STRING
   DEFINE ls_result   STRING 
   DEFINE ls_wc       STRING 
   DEFINE la_wc       DYNAMIC ARRAY OF RECORD
          tableid     STRING,
          wc          STRING
          END RECORD
   DEFINE li_idx      LIKE type_t.num10
   #add-point:cs段define
   {<point name="cs.define" edit="s"/>}
   #end add-point    
   #add-point:cs段define(客製用)
   {<point name="cs.define_customerization" edit="c"/>}
   #end add-point    
    
   #清除畫面
   CLEAR FORM                
   INITIALIZE g_xmdg_m.* TO NULL
   CALL g_xmdh_d.clear()        
   CALL g_xmdh2_d.clear() 
   CALL g_xmdh3_d.clear() 
   CALL g_xmdh4_d.clear() 
 
   
   LET g_action_choice = ""
    
   INITIALIZE g_wc TO NULL
   INITIALIZE g_wc2 TO NULL
   
   INITIALIZE g_wc2_table1 TO NULL
   INITIALIZE g_wc2_table2 TO NULL
 
 
    
   LET g_qryparam.state = 'c'
   
   #add-point:cs段開始前
   {<point name="cs.before_construct"/>}
   #end add-point 
   
   #使用DIALOG包住 單頭CONSTRUCT及單身CONSTRUCT
   DIALOG ATTRIBUTES(UNBUFFERED,FIELD ORDER FORM)
      
      #單頭
      CONSTRUCT BY NAME g_wc ON xmdgdocno,xmdgdocdt,xmdg004,xmdgsite,xmdg002,xmdg003,xmdgstus,xmdg001, 
          xmdg034,xmdg005,xmdg006,xmdg007,xmdg202,xmdg028,xmdg026,xmdg027,xmdg024,xmdg025,xmdg030,xmdg031, 
          xmdg053,xmdg056,xmdg055,xmdg054,xmdg017,xmdg018,xmdg019,xmdg020,xmdg016,xmdg021,xmdg022,xmdg023, 
          xmdg008,xmdg009,xmdg010,xmdg011,xmdg012,xmdg013,xmdg032,xmdg033,xmdg014,xmdg015,xmdgownid, 
          xmdgowndp,xmdgcrtid,xmdgcrtdp,xmdgcrtdt,xmdgmodid,xmdgmoddt,xmdgcnfid,xmdgcnfdt
 
         BEFORE CONSTRUCT
            #add-point:cs段before_construct
            {<point name="cs.head.before_construct"/>}
            #end add-point 
            
         #公用欄位開窗相關處理
         #應用 a11 樣板自動產生(Version:2)
         #共用欄位查詢處理  
         ##----<<xmdgcrtdt>>----
         AFTER FIELD xmdgcrtdt
            CALL FGL_DIALOG_GETBUFFER() RETURNING ls_result
            IF NOT cl_null(ls_result) THEN
               IF NOT cl_chk_date_symbol(ls_result) THEN
                  LET ls_result = cl_add_date_extra_cond(ls_result)
               END IF
            END IF
            CALL FGL_DIALOG_SETBUFFER(ls_result)
 
         #----<<xmdgmoddt>>----
         AFTER FIELD xmdgmoddt
            CALL FGL_DIALOG_GETBUFFER() RETURNING ls_result
            IF NOT cl_null(ls_result) THEN
               IF NOT cl_chk_date_symbol(ls_result) THEN
                  LET ls_result = cl_add_date_extra_cond(ls_result)
               END IF
            END IF
            CALL FGL_DIALOG_SETBUFFER(ls_result)
         
         #----<<xmdgcnfdt>>----
         AFTER FIELD xmdgcnfdt
            CALL FGL_DIALOG_GETBUFFER() RETURNING ls_result
            IF NOT cl_null(ls_result) THEN
               IF NOT cl_chk_date_symbol(ls_result) THEN
                  LET ls_result = cl_add_date_extra_cond(ls_result)
               END IF
            END IF
            CALL FGL_DIALOG_SETBUFFER(ls_result)
         
         #----<<xmdgpstdt>>----
 
 
            
         #一般欄位開窗相關處理    
                  #Ctrlp:construct.c.xmdgdocno
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdgdocno
            #add-point:ON ACTION controlp INFIELD xmdgdocno
            {<point name="construct.c.xmdgdocno" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdgdocno
            #add-point:BEFORE FIELD xmdgdocno
            {<point name="construct.b.xmdgdocno" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdgdocno
            
            #add-point:AFTER FIELD xmdgdocno
            {<point name="construct.a.xmdgdocno" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdgdocdt
            #add-point:BEFORE FIELD xmdgdocdt
            {<point name="construct.b.xmdgdocdt" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdgdocdt
            
            #add-point:AFTER FIELD xmdgdocdt
            {<point name="construct.a.xmdgdocdt" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmdgdocdt
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdgdocdt
            #add-point:ON ACTION controlp INFIELD xmdgdocdt
            {<point name="construct.c.xmdgdocdt" />}
            #END add-point
 
         #Ctrlp:construct.c.xmdg004
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdg004
            #add-point:ON ACTION controlp INFIELD xmdg004
            {<point name="construct.c.xmdg004" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdg004
            #add-point:BEFORE FIELD xmdg004
            {<point name="construct.b.xmdg004" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdg004
            
            #add-point:AFTER FIELD xmdg004
            {<point name="construct.a.xmdg004" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdgsite
            #add-point:BEFORE FIELD xmdgsite
            {<point name="construct.b.xmdgsite" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdgsite
            
            #add-point:AFTER FIELD xmdgsite
            {<point name="construct.a.xmdgsite" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmdgsite
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdgsite
            #add-point:ON ACTION controlp INFIELD xmdgsite
            {<point name="construct.c.xmdgsite" />}
            #END add-point
 
         #Ctrlp:construct.c.xmdg002
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdg002
            #add-point:ON ACTION controlp INFIELD xmdg002
            {<point name="construct.c.xmdg002" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdg002
            #add-point:BEFORE FIELD xmdg002
            {<point name="construct.b.xmdg002" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdg002
            
            #add-point:AFTER FIELD xmdg002
            {<point name="construct.a.xmdg002" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmdg003
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdg003
            #add-point:ON ACTION controlp INFIELD xmdg003
            {<point name="construct.c.xmdg003" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdg003
            #add-point:BEFORE FIELD xmdg003
            {<point name="construct.b.xmdg003" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdg003
            
            #add-point:AFTER FIELD xmdg003
            {<point name="construct.a.xmdg003" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdgstus
            #add-point:BEFORE FIELD xmdgstus
            {<point name="construct.b.xmdgstus" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdgstus
            
            #add-point:AFTER FIELD xmdgstus
            {<point name="construct.a.xmdgstus" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmdgstus
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdgstus
            #add-point:ON ACTION controlp INFIELD xmdgstus
            {<point name="construct.c.xmdgstus" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdg001
            #add-point:BEFORE FIELD xmdg001
            {<point name="construct.b.xmdg001" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdg001
            
            #add-point:AFTER FIELD xmdg001
            {<point name="construct.a.xmdg001" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmdg001
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdg001
            #add-point:ON ACTION controlp INFIELD xmdg001
            {<point name="construct.c.xmdg001" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdg034
            #add-point:BEFORE FIELD xmdg034
            {<point name="construct.b.xmdg034" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdg034
            
            #add-point:AFTER FIELD xmdg034
            {<point name="construct.a.xmdg034" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmdg034
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdg034
            #add-point:ON ACTION controlp INFIELD xmdg034
            {<point name="construct.c.xmdg034" />}
            #END add-point
 
         #Ctrlp:construct.c.xmdg005
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdg005
            #add-point:ON ACTION controlp INFIELD xmdg005
            {<point name="construct.c.xmdg005" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdg005
            #add-point:BEFORE FIELD xmdg005
            {<point name="construct.b.xmdg005" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdg005
            
            #add-point:AFTER FIELD xmdg005
            {<point name="construct.a.xmdg005" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmdg006
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdg006
            #add-point:ON ACTION controlp INFIELD xmdg006
            {<point name="construct.c.xmdg006" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdg006
            #add-point:BEFORE FIELD xmdg006
            {<point name="construct.b.xmdg006" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdg006
            
            #add-point:AFTER FIELD xmdg006
            {<point name="construct.a.xmdg006" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmdg007
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdg007
            #add-point:ON ACTION controlp INFIELD xmdg007
            {<point name="construct.c.xmdg007" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdg007
            #add-point:BEFORE FIELD xmdg007
            {<point name="construct.b.xmdg007" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdg007
            
            #add-point:AFTER FIELD xmdg007
            {<point name="construct.a.xmdg007" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmdg202
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdg202
            #add-point:ON ACTION controlp INFIELD xmdg202
            {<point name="construct.c.xmdg202" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdg202
            #add-point:BEFORE FIELD xmdg202
            {<point name="construct.b.xmdg202" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdg202
            
            #add-point:AFTER FIELD xmdg202
            {<point name="construct.a.xmdg202" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdg028
            #add-point:BEFORE FIELD xmdg028
            {<point name="construct.b.xmdg028" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdg028
            
            #add-point:AFTER FIELD xmdg028
            {<point name="construct.a.xmdg028" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmdg028
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdg028
            #add-point:ON ACTION controlp INFIELD xmdg028
            {<point name="construct.c.xmdg028" />}
            #END add-point
 
         #Ctrlp:construct.c.xmdg026
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdg026
            #add-point:ON ACTION controlp INFIELD xmdg026
            {<point name="construct.c.xmdg026" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdg026
            #add-point:BEFORE FIELD xmdg026
            {<point name="construct.b.xmdg026" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdg026
            
            #add-point:AFTER FIELD xmdg026
            {<point name="construct.a.xmdg026" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmdg027
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdg027
            #add-point:ON ACTION controlp INFIELD xmdg027
            {<point name="construct.c.xmdg027" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdg027
            #add-point:BEFORE FIELD xmdg027
            {<point name="construct.b.xmdg027" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdg027
            
            #add-point:AFTER FIELD xmdg027
            {<point name="construct.a.xmdg027" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdg024
            #add-point:BEFORE FIELD xmdg024
            {<point name="construct.b.xmdg024" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdg024
            
            #add-point:AFTER FIELD xmdg024
            {<point name="construct.a.xmdg024" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmdg024
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdg024
            #add-point:ON ACTION controlp INFIELD xmdg024
            {<point name="construct.c.xmdg024" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdg025
            #add-point:BEFORE FIELD xmdg025
            {<point name="construct.b.xmdg025" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdg025
            
            #add-point:AFTER FIELD xmdg025
            {<point name="construct.a.xmdg025" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmdg025
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdg025
            #add-point:ON ACTION controlp INFIELD xmdg025
            {<point name="construct.c.xmdg025" />}
            #END add-point
 
         #Ctrlp:construct.c.xmdg030
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdg030
            #add-point:ON ACTION controlp INFIELD xmdg030
            {<point name="construct.c.xmdg030" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdg030
            #add-point:BEFORE FIELD xmdg030
            {<point name="construct.b.xmdg030" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdg030
            
            #add-point:AFTER FIELD xmdg030
            {<point name="construct.a.xmdg030" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmdg031
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdg031
            #add-point:ON ACTION controlp INFIELD xmdg031
            {<point name="construct.c.xmdg031" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdg031
            #add-point:BEFORE FIELD xmdg031
            {<point name="construct.b.xmdg031" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdg031
            
            #add-point:AFTER FIELD xmdg031
            {<point name="construct.a.xmdg031" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdg053
            #add-point:BEFORE FIELD xmdg053
            {<point name="construct.b.xmdg053" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdg053
            
            #add-point:AFTER FIELD xmdg053
            {<point name="construct.a.xmdg053" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmdg053
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdg053
            #add-point:ON ACTION controlp INFIELD xmdg053
            {<point name="construct.c.xmdg053" />}
            #END add-point
 
         #Ctrlp:construct.c.xmdg056
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdg056
            #add-point:ON ACTION controlp INFIELD xmdg056
            {<point name="construct.c.xmdg056" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdg056
            #add-point:BEFORE FIELD xmdg056
            {<point name="construct.b.xmdg056" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdg056
            
            #add-point:AFTER FIELD xmdg056
            {<point name="construct.a.xmdg056" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmdg055
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdg055
            #add-point:ON ACTION controlp INFIELD xmdg055
            {<point name="construct.c.xmdg055" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdg055
            #add-point:BEFORE FIELD xmdg055
            {<point name="construct.b.xmdg055" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdg055
            
            #add-point:AFTER FIELD xmdg055
            {<point name="construct.a.xmdg055" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdg054
            #add-point:BEFORE FIELD xmdg054
            {<point name="construct.b.xmdg054" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdg054
            
            #add-point:AFTER FIELD xmdg054
            {<point name="construct.a.xmdg054" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmdg054
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdg054
            #add-point:ON ACTION controlp INFIELD xmdg054
            {<point name="construct.c.xmdg054" />}
            #END add-point
 
         #Ctrlp:construct.c.xmdg017
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdg017
            #add-point:ON ACTION controlp INFIELD xmdg017
            {<point name="construct.c.xmdg017" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdg017
            #add-point:BEFORE FIELD xmdg017
            {<point name="construct.b.xmdg017" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdg017
            
            #add-point:AFTER FIELD xmdg017
            {<point name="construct.a.xmdg017" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmdg018
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdg018
            #add-point:ON ACTION controlp INFIELD xmdg018
            {<point name="construct.c.xmdg018" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdg018
            #add-point:BEFORE FIELD xmdg018
            {<point name="construct.b.xmdg018" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdg018
            
            #add-point:AFTER FIELD xmdg018
            {<point name="construct.a.xmdg018" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmdg019
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdg019
            #add-point:ON ACTION controlp INFIELD xmdg019
            {<point name="construct.c.xmdg019" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdg019
            #add-point:BEFORE FIELD xmdg019
            {<point name="construct.b.xmdg019" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdg019
            
            #add-point:AFTER FIELD xmdg019
            {<point name="construct.a.xmdg019" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmdg020
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdg020
            #add-point:ON ACTION controlp INFIELD xmdg020
            {<point name="construct.c.xmdg020" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdg020
            #add-point:BEFORE FIELD xmdg020
            {<point name="construct.b.xmdg020" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdg020
            
            #add-point:AFTER FIELD xmdg020
            {<point name="construct.a.xmdg020" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmdg016
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdg016
            #add-point:ON ACTION controlp INFIELD xmdg016
            {<point name="construct.c.xmdg016" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdg016
            #add-point:BEFORE FIELD xmdg016
            {<point name="construct.b.xmdg016" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdg016
            
            #add-point:AFTER FIELD xmdg016
            {<point name="construct.a.xmdg016" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdg021
            #add-point:BEFORE FIELD xmdg021
            {<point name="construct.b.xmdg021" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdg021
            
            #add-point:AFTER FIELD xmdg021
            {<point name="construct.a.xmdg021" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmdg021
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdg021
            #add-point:ON ACTION controlp INFIELD xmdg021
            {<point name="construct.c.xmdg021" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdg022
            #add-point:BEFORE FIELD xmdg022
            {<point name="construct.b.xmdg022" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdg022
            
            #add-point:AFTER FIELD xmdg022
            {<point name="construct.a.xmdg022" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmdg022
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdg022
            #add-point:ON ACTION controlp INFIELD xmdg022
            {<point name="construct.c.xmdg022" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdg023
            #add-point:BEFORE FIELD xmdg023
            {<point name="construct.b.xmdg023" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdg023
            
            #add-point:AFTER FIELD xmdg023
            {<point name="construct.a.xmdg023" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmdg023
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdg023
            #add-point:ON ACTION controlp INFIELD xmdg023
            {<point name="construct.c.xmdg023" />}
            #END add-point
 
         #Ctrlp:construct.c.xmdg008
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdg008
            #add-point:ON ACTION controlp INFIELD xmdg008
            {<point name="construct.c.xmdg008" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdg008
            #add-point:BEFORE FIELD xmdg008
            {<point name="construct.b.xmdg008" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdg008
            
            #add-point:AFTER FIELD xmdg008
            {<point name="construct.a.xmdg008" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmdg009
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdg009
            #add-point:ON ACTION controlp INFIELD xmdg009
            {<point name="construct.c.xmdg009" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdg009
            #add-point:BEFORE FIELD xmdg009
            {<point name="construct.b.xmdg009" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdg009
            
            #add-point:AFTER FIELD xmdg009
            {<point name="construct.a.xmdg009" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmdg010
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdg010
            #add-point:ON ACTION controlp INFIELD xmdg010
            {<point name="construct.c.xmdg010" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdg010
            #add-point:BEFORE FIELD xmdg010
            {<point name="construct.b.xmdg010" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdg010
            
            #add-point:AFTER FIELD xmdg010
            {<point name="construct.a.xmdg010" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdg011
            #add-point:BEFORE FIELD xmdg011
            {<point name="construct.b.xmdg011" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdg011
            
            #add-point:AFTER FIELD xmdg011
            {<point name="construct.a.xmdg011" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmdg011
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdg011
            #add-point:ON ACTION controlp INFIELD xmdg011
            {<point name="construct.c.xmdg011" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdg012
            #add-point:BEFORE FIELD xmdg012
            {<point name="construct.b.xmdg012" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdg012
            
            #add-point:AFTER FIELD xmdg012
            {<point name="construct.a.xmdg012" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmdg012
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdg012
            #add-point:ON ACTION controlp INFIELD xmdg012
            {<point name="construct.c.xmdg012" />}
            #END add-point
 
         #Ctrlp:construct.c.xmdg013
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdg013
            #add-point:ON ACTION controlp INFIELD xmdg013
            {<point name="construct.c.xmdg013" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdg013
            #add-point:BEFORE FIELD xmdg013
            {<point name="construct.b.xmdg013" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdg013
            
            #add-point:AFTER FIELD xmdg013
            {<point name="construct.a.xmdg013" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdg032
            #add-point:BEFORE FIELD xmdg032
            {<point name="construct.b.xmdg032" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdg032
            
            #add-point:AFTER FIELD xmdg032
            {<point name="construct.a.xmdg032" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmdg032
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdg032
            #add-point:ON ACTION controlp INFIELD xmdg032
            {<point name="construct.c.xmdg032" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdg033
            #add-point:BEFORE FIELD xmdg033
            {<point name="construct.b.xmdg033" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdg033
            
            #add-point:AFTER FIELD xmdg033
            {<point name="construct.a.xmdg033" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmdg033
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdg033
            #add-point:ON ACTION controlp INFIELD xmdg033
            {<point name="construct.c.xmdg033" />}
            #END add-point
 
         #Ctrlp:construct.c.xmdg014
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdg014
            #add-point:ON ACTION controlp INFIELD xmdg014
            {<point name="construct.c.xmdg014" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdg014
            #add-point:BEFORE FIELD xmdg014
            {<point name="construct.b.xmdg014" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdg014
            
            #add-point:AFTER FIELD xmdg014
            {<point name="construct.a.xmdg014" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdg015
            #add-point:BEFORE FIELD xmdg015
            {<point name="construct.b.xmdg015" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdg015
            
            #add-point:AFTER FIELD xmdg015
            {<point name="construct.a.xmdg015" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmdg015
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdg015
            #add-point:ON ACTION controlp INFIELD xmdg015
            {<point name="construct.c.xmdg015" />}
            #END add-point
 
         #Ctrlp:construct.c.xmdgownid
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdgownid
            #add-point:ON ACTION controlp INFIELD xmdgownid
            {<point name="construct.c.xmdgownid" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdgownid
            #add-point:BEFORE FIELD xmdgownid
            {<point name="construct.b.xmdgownid" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdgownid
            
            #add-point:AFTER FIELD xmdgownid
            {<point name="construct.a.xmdgownid" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmdgowndp
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdgowndp
            #add-point:ON ACTION controlp INFIELD xmdgowndp
            {<point name="construct.c.xmdgowndp" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdgowndp
            #add-point:BEFORE FIELD xmdgowndp
            {<point name="construct.b.xmdgowndp" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdgowndp
            
            #add-point:AFTER FIELD xmdgowndp
            {<point name="construct.a.xmdgowndp" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmdgcrtid
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdgcrtid
            #add-point:ON ACTION controlp INFIELD xmdgcrtid
            {<point name="construct.c.xmdgcrtid" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdgcrtid
            #add-point:BEFORE FIELD xmdgcrtid
            {<point name="construct.b.xmdgcrtid" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdgcrtid
            
            #add-point:AFTER FIELD xmdgcrtid
            {<point name="construct.a.xmdgcrtid" />}
            #END add-point
            
 
         #Ctrlp:construct.c.xmdgcrtdp
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdgcrtdp
            #add-point:ON ACTION controlp INFIELD xmdgcrtdp
            {<point name="construct.c.xmdgcrtdp" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdgcrtdp
            #add-point:BEFORE FIELD xmdgcrtdp
            {<point name="construct.b.xmdgcrtdp" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdgcrtdp
            
            #add-point:AFTER FIELD xmdgcrtdp
            {<point name="construct.a.xmdgcrtdp" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdgcrtdt
            #add-point:BEFORE FIELD xmdgcrtdt
            {<point name="construct.b.xmdgcrtdt" />}
            #END add-point
 
         #Ctrlp:construct.c.xmdgmodid
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdgmodid
            #add-point:ON ACTION controlp INFIELD xmdgmodid
            {<point name="construct.c.xmdgmodid" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdgmodid
            #add-point:BEFORE FIELD xmdgmodid
            {<point name="construct.b.xmdgmodid" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdgmodid
            
            #add-point:AFTER FIELD xmdgmodid
            {<point name="construct.a.xmdgmodid" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdgmoddt
            #add-point:BEFORE FIELD xmdgmoddt
            {<point name="construct.b.xmdgmoddt" />}
            #END add-point
 
         #Ctrlp:construct.c.xmdgcnfid
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdgcnfid
            #add-point:ON ACTION controlp INFIELD xmdgcnfid
            {<point name="construct.c.xmdgcnfid" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdgcnfid
            #add-point:BEFORE FIELD xmdgcnfid
            {<point name="construct.b.xmdgcnfid" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdgcnfid
            
            #add-point:AFTER FIELD xmdgcnfid
            {<point name="construct.a.xmdgcnfid" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdgcnfdt
            #add-point:BEFORE FIELD xmdgcnfdt
            {<point name="construct.b.xmdgcnfdt" />}
            #END add-point
 
 
         
      END CONSTRUCT
 
      #單身根據table分拆construct
      CONSTRUCT g_wc2_table1 ON xmdhsite,xmdhseq,xmdh001,xmdh002,xmdh003,xmdh004,xmdh005,xmdh006,xmdh007, 
          xmdh034,xmdh009,xmdh010,xmdh015,xmdh016,xmdh017,xmdh018,xmdh019,xmdh008,xmdh011,xmdh012,xmdh013, 
          xmdh014,xmdh029,xmdh020,xmdh021,xmdh022,xmdh036,xmdh031,xmdh032,xmdh033,xmdh050,xmdh056,xmdh030, 
          xmdh051,xmdh052,xmdhunit,xmdh035,xmdh023,xmdh024,xmdh025,xmdh026,xmdh027,xmdh028
           FROM s_detail1[1].xmdhsite,s_detail1[1].xmdhseq,s_detail1[1].xmdh001,s_detail1[1].xmdh002, 
               s_detail1[1].xmdh003,s_detail1[1].xmdh004,s_detail1[1].xmdh005,s_detail1[1].xmdh006,s_detail1[1].xmdh007, 
               s_detail1[1].xmdh034,s_detail1[1].xmdh009,s_detail1[1].xmdh010,s_detail1[1].xmdh015,s_detail1[1].xmdh016, 
               s_detail1[1].xmdh017,s_detail1[1].xmdh018,s_detail1[1].xmdh019,s_detail1[1].xmdh008,s_detail1[1].xmdh011, 
               s_detail1[1].xmdh012,s_detail1[1].xmdh013,s_detail1[1].xmdh014,s_detail1[1].xmdh029,s_detail1[1].xmdh020, 
               s_detail1[1].xmdh021,s_detail1[1].xmdh022,s_detail1[1].xmdh036,s_detail1[1].xmdh031,s_detail1[1].xmdh032, 
               s_detail1[1].xmdh033,s_detail1[1].xmdh050,s_detail1[1].xmdh056,s_detail1[1].xmdh030,s_detail1[1].xmdh051, 
               s_detail1[1].xmdh052,s_detail1[1].xmdhunit,s_detail1[1].xmdh035,s_detail4[1].xmdh023, 
               s_detail4[1].xmdh024,s_detail4[1].xmdh025,s_detail4[1].xmdh026,s_detail4[1].xmdh027,s_detail4[1].xmdh028 

                      
         BEFORE CONSTRUCT
            #add-point:cs段before_construct
            {<point name="cs.body.before_construct"/>}
            #end add-point 
            
       #單身公用欄位開窗相關處理
       
         
       #單身一般欄位開窗相關處理
                #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdhsite
            #add-point:BEFORE FIELD xmdhsite
            {<point name="construct.b.page1.xmdhsite" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdhsite
            
            #add-point:AFTER FIELD xmdhsite
            {<point name="construct.a.page1.xmdhsite" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmdhsite
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdhsite
            #add-point:ON ACTION controlp INFIELD xmdhsite
            {<point name="construct.c.page1.xmdhsite" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdhseq
            #add-point:BEFORE FIELD xmdhseq
            {<point name="construct.b.page1.xmdhseq" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdhseq
            
            #add-point:AFTER FIELD xmdhseq
            {<point name="construct.a.page1.xmdhseq" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmdhseq
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdhseq
            #add-point:ON ACTION controlp INFIELD xmdhseq
            {<point name="construct.c.page1.xmdhseq" />}
            #END add-point
 
         #Ctrlp:construct.c.page1.xmdh001
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdh001
            #add-point:ON ACTION controlp INFIELD xmdh001
            {<point name="construct.c.page1.xmdh001" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdh001
            #add-point:BEFORE FIELD xmdh001
            {<point name="construct.b.page1.xmdh001" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdh001
            
            #add-point:AFTER FIELD xmdh001
            {<point name="construct.a.page1.xmdh001" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdh002
            #add-point:BEFORE FIELD xmdh002
            {<point name="construct.b.page1.xmdh002" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdh002
            
            #add-point:AFTER FIELD xmdh002
            {<point name="construct.a.page1.xmdh002" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmdh002
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdh002
            #add-point:ON ACTION controlp INFIELD xmdh002
            {<point name="construct.c.page1.xmdh002" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdh003
            #add-point:BEFORE FIELD xmdh003
            {<point name="construct.b.page1.xmdh003" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdh003
            
            #add-point:AFTER FIELD xmdh003
            {<point name="construct.a.page1.xmdh003" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmdh003
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdh003
            #add-point:ON ACTION controlp INFIELD xmdh003
            {<point name="construct.c.page1.xmdh003" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdh004
            #add-point:BEFORE FIELD xmdh004
            {<point name="construct.b.page1.xmdh004" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdh004
            
            #add-point:AFTER FIELD xmdh004
            {<point name="construct.a.page1.xmdh004" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmdh004
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdh004
            #add-point:ON ACTION controlp INFIELD xmdh004
            {<point name="construct.c.page1.xmdh004" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdh005
            #add-point:BEFORE FIELD xmdh005
            {<point name="construct.b.page1.xmdh005" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdh005
            
            #add-point:AFTER FIELD xmdh005
            {<point name="construct.a.page1.xmdh005" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmdh005
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdh005
            #add-point:ON ACTION controlp INFIELD xmdh005
            {<point name="construct.c.page1.xmdh005" />}
            #END add-point
 
         #Ctrlp:construct.c.page1.xmdh006
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdh006
            #add-point:ON ACTION controlp INFIELD xmdh006
            {<point name="construct.c.page1.xmdh006" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdh006
            #add-point:BEFORE FIELD xmdh006
            {<point name="construct.b.page1.xmdh006" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdh006
            
            #add-point:AFTER FIELD xmdh006
            {<point name="construct.a.page1.xmdh006" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdh007
            #add-point:BEFORE FIELD xmdh007
            {<point name="construct.b.page1.xmdh007" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdh007
            
            #add-point:AFTER FIELD xmdh007
            {<point name="construct.a.page1.xmdh007" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmdh007
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdh007
            #add-point:ON ACTION controlp INFIELD xmdh007
            {<point name="construct.c.page1.xmdh007" />}
            #END add-point
 
         #Ctrlp:construct.c.page1.xmdh034
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdh034
            #add-point:ON ACTION controlp INFIELD xmdh034
            {<point name="construct.c.page1.xmdh034" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdh034
            #add-point:BEFORE FIELD xmdh034
            {<point name="construct.b.page1.xmdh034" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdh034
            
            #add-point:AFTER FIELD xmdh034
            {<point name="construct.a.page1.xmdh034" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmdh009
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdh009
            #add-point:ON ACTION controlp INFIELD xmdh009
            {<point name="construct.c.page1.xmdh009" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdh009
            #add-point:BEFORE FIELD xmdh009
            {<point name="construct.b.page1.xmdh009" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdh009
            
            #add-point:AFTER FIELD xmdh009
            {<point name="construct.a.page1.xmdh009" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdh010
            #add-point:BEFORE FIELD xmdh010
            {<point name="construct.b.page1.xmdh010" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdh010
            
            #add-point:AFTER FIELD xmdh010
            {<point name="construct.a.page1.xmdh010" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmdh010
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdh010
            #add-point:ON ACTION controlp INFIELD xmdh010
            {<point name="construct.c.page1.xmdh010" />}
            #END add-point
 
         #Ctrlp:construct.c.page1.xmdh015
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdh015
            #add-point:ON ACTION controlp INFIELD xmdh015
            {<point name="construct.c.page1.xmdh015" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdh015
            #add-point:BEFORE FIELD xmdh015
            {<point name="construct.b.page1.xmdh015" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdh015
            
            #add-point:AFTER FIELD xmdh015
            {<point name="construct.a.page1.xmdh015" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdh016
            #add-point:BEFORE FIELD xmdh016
            {<point name="construct.b.page1.xmdh016" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdh016
            
            #add-point:AFTER FIELD xmdh016
            {<point name="construct.a.page1.xmdh016" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmdh016
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdh016
            #add-point:ON ACTION controlp INFIELD xmdh016
            {<point name="construct.c.page1.xmdh016" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdh017
            #add-point:BEFORE FIELD xmdh017
            {<point name="construct.b.page1.xmdh017" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdh017
            
            #add-point:AFTER FIELD xmdh017
            {<point name="construct.a.page1.xmdh017" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmdh017
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdh017
            #add-point:ON ACTION controlp INFIELD xmdh017
            {<point name="construct.c.page1.xmdh017" />}
            #END add-point
 
         #Ctrlp:construct.c.page1.xmdh018
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdh018
            #add-point:ON ACTION controlp INFIELD xmdh018
            {<point name="construct.c.page1.xmdh018" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdh018
            #add-point:BEFORE FIELD xmdh018
            {<point name="construct.b.page1.xmdh018" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdh018
            
            #add-point:AFTER FIELD xmdh018
            {<point name="construct.a.page1.xmdh018" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdh019
            #add-point:BEFORE FIELD xmdh019
            {<point name="construct.b.page1.xmdh019" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdh019
            
            #add-point:AFTER FIELD xmdh019
            {<point name="construct.a.page1.xmdh019" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmdh019
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdh019
            #add-point:ON ACTION controlp INFIELD xmdh019
            {<point name="construct.c.page1.xmdh019" />}
            #END add-point
 
         #Ctrlp:construct.c.page1.xmdh008
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdh008
            #add-point:ON ACTION controlp INFIELD xmdh008
            {<point name="construct.c.page1.xmdh008" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdh008
            #add-point:BEFORE FIELD xmdh008
            {<point name="construct.b.page1.xmdh008" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdh008
            
            #add-point:AFTER FIELD xmdh008
            {<point name="construct.a.page1.xmdh008" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdh011
            #add-point:BEFORE FIELD xmdh011
            {<point name="construct.b.page1.xmdh011" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdh011
            
            #add-point:AFTER FIELD xmdh011
            {<point name="construct.a.page1.xmdh011" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmdh011
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdh011
            #add-point:ON ACTION controlp INFIELD xmdh011
            {<point name="construct.c.page1.xmdh011" />}
            #END add-point
 
         #Ctrlp:construct.c.page1.xmdh012
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdh012
            #add-point:ON ACTION controlp INFIELD xmdh012
            {<point name="construct.c.page1.xmdh012" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdh012
            #add-point:BEFORE FIELD xmdh012
            {<point name="construct.b.page1.xmdh012" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdh012
            
            #add-point:AFTER FIELD xmdh012
            {<point name="construct.a.page1.xmdh012" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmdh013
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdh013
            #add-point:ON ACTION controlp INFIELD xmdh013
            {<point name="construct.c.page1.xmdh013" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdh013
            #add-point:BEFORE FIELD xmdh013
            {<point name="construct.b.page1.xmdh013" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdh013
            
            #add-point:AFTER FIELD xmdh013
            {<point name="construct.a.page1.xmdh013" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdh014
            #add-point:BEFORE FIELD xmdh014
            {<point name="construct.b.page1.xmdh014" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdh014
            
            #add-point:AFTER FIELD xmdh014
            {<point name="construct.a.page1.xmdh014" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmdh014
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdh014
            #add-point:ON ACTION controlp INFIELD xmdh014
            {<point name="construct.c.page1.xmdh014" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdh029
            #add-point:BEFORE FIELD xmdh029
            {<point name="construct.b.page1.xmdh029" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdh029
            
            #add-point:AFTER FIELD xmdh029
            {<point name="construct.a.page1.xmdh029" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmdh029
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdh029
            #add-point:ON ACTION controlp INFIELD xmdh029
            {<point name="construct.c.page1.xmdh029" />}
            #END add-point
 
         #Ctrlp:construct.c.page1.xmdh020
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdh020
            #add-point:ON ACTION controlp INFIELD xmdh020
            {<point name="construct.c.page1.xmdh020" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdh020
            #add-point:BEFORE FIELD xmdh020
            {<point name="construct.b.page1.xmdh020" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdh020
            
            #add-point:AFTER FIELD xmdh020
            {<point name="construct.a.page1.xmdh020" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdh021
            #add-point:BEFORE FIELD xmdh021
            {<point name="construct.b.page1.xmdh021" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdh021
            
            #add-point:AFTER FIELD xmdh021
            {<point name="construct.a.page1.xmdh021" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmdh021
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdh021
            #add-point:ON ACTION controlp INFIELD xmdh021
            {<point name="construct.c.page1.xmdh021" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdh022
            #add-point:BEFORE FIELD xmdh022
            {<point name="construct.b.page1.xmdh022" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdh022
            
            #add-point:AFTER FIELD xmdh022
            {<point name="construct.a.page1.xmdh022" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmdh022
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdh022
            #add-point:ON ACTION controlp INFIELD xmdh022
            {<point name="construct.c.page1.xmdh022" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdh036
            #add-point:BEFORE FIELD xmdh036
            {<point name="construct.b.page1.xmdh036" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdh036
            
            #add-point:AFTER FIELD xmdh036
            {<point name="construct.a.page1.xmdh036" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmdh036
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdh036
            #add-point:ON ACTION controlp INFIELD xmdh036
            {<point name="construct.c.page1.xmdh036" />}
            #END add-point
 
         #Ctrlp:construct.c.page1.xmdh031
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdh031
            #add-point:ON ACTION controlp INFIELD xmdh031
            {<point name="construct.c.page1.xmdh031" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdh031
            #add-point:BEFORE FIELD xmdh031
            {<point name="construct.b.page1.xmdh031" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdh031
            
            #add-point:AFTER FIELD xmdh031
            {<point name="construct.a.page1.xmdh031" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmdh032
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdh032
            #add-point:ON ACTION controlp INFIELD xmdh032
            {<point name="construct.c.page1.xmdh032" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdh032
            #add-point:BEFORE FIELD xmdh032
            {<point name="construct.b.page1.xmdh032" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdh032
            
            #add-point:AFTER FIELD xmdh032
            {<point name="construct.a.page1.xmdh032" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmdh033
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdh033
            #add-point:ON ACTION controlp INFIELD xmdh033
            {<point name="construct.c.page1.xmdh033" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdh033
            #add-point:BEFORE FIELD xmdh033
            {<point name="construct.b.page1.xmdh033" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdh033
            
            #add-point:AFTER FIELD xmdh033
            {<point name="construct.a.page1.xmdh033" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdh050
            #add-point:BEFORE FIELD xmdh050
            {<point name="construct.b.page1.xmdh050" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdh050
            
            #add-point:AFTER FIELD xmdh050
            {<point name="construct.a.page1.xmdh050" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmdh050
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdh050
            #add-point:ON ACTION controlp INFIELD xmdh050
            {<point name="construct.c.page1.xmdh050" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdh056
            #add-point:BEFORE FIELD xmdh056
            {<point name="construct.b.page1.xmdh056" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdh056
            
            #add-point:AFTER FIELD xmdh056
            {<point name="construct.a.page1.xmdh056" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmdh056
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdh056
            #add-point:ON ACTION controlp INFIELD xmdh056
            {<point name="construct.c.page1.xmdh056" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdh030
            #add-point:BEFORE FIELD xmdh030
            {<point name="construct.b.page1.xmdh030" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdh030
            
            #add-point:AFTER FIELD xmdh030
            {<point name="construct.a.page1.xmdh030" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmdh030
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdh030
            #add-point:ON ACTION controlp INFIELD xmdh030
            {<point name="construct.c.page1.xmdh030" />}
            #END add-point
 
         #Ctrlp:construct.c.page1.xmdh051
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdh051
            #add-point:ON ACTION controlp INFIELD xmdh051
            {<point name="construct.c.page1.xmdh051" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdh051
            #add-point:BEFORE FIELD xmdh051
            {<point name="construct.b.page1.xmdh051" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdh051
            
            #add-point:AFTER FIELD xmdh051
            {<point name="construct.a.page1.xmdh051" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmdh052
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdh052
            #add-point:ON ACTION controlp INFIELD xmdh052
            {<point name="construct.c.page1.xmdh052" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdh052
            #add-point:BEFORE FIELD xmdh052
            {<point name="construct.b.page1.xmdh052" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdh052
            
            #add-point:AFTER FIELD xmdh052
            {<point name="construct.a.page1.xmdh052" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmdhunit
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdhunit
            #add-point:ON ACTION controlp INFIELD xmdhunit
            {<point name="construct.c.page1.xmdhunit" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdhunit
            #add-point:BEFORE FIELD xmdhunit
            {<point name="construct.b.page1.xmdhunit" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdhunit
            
            #add-point:AFTER FIELD xmdhunit
            {<point name="construct.a.page1.xmdhunit" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdh035
            #add-point:BEFORE FIELD xmdh035
            {<point name="construct.b.page1.xmdh035" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdh035
            
            #add-point:AFTER FIELD xmdh035
            {<point name="construct.a.page1.xmdh035" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xmdh035
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdh035
            #add-point:ON ACTION controlp INFIELD xmdh035
            {<point name="construct.c.page1.xmdh035" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdh023
            #add-point:BEFORE FIELD xmdh023
            {<point name="construct.b.page4.xmdh023" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdh023
            
            #add-point:AFTER FIELD xmdh023
            {<point name="construct.a.page4.xmdh023" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.xmdh023
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdh023
            #add-point:ON ACTION controlp INFIELD xmdh023
            {<point name="construct.c.page4.xmdh023" />}
            #END add-point
 
         #Ctrlp:construct.c.page4.xmdh024
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdh024
            #add-point:ON ACTION controlp INFIELD xmdh024
            {<point name="construct.c.page4.xmdh024" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdh024
            #add-point:BEFORE FIELD xmdh024
            {<point name="construct.b.page4.xmdh024" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdh024
            
            #add-point:AFTER FIELD xmdh024
            {<point name="construct.a.page4.xmdh024" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdh025
            #add-point:BEFORE FIELD xmdh025
            {<point name="construct.b.page4.xmdh025" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdh025
            
            #add-point:AFTER FIELD xmdh025
            {<point name="construct.a.page4.xmdh025" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.xmdh025
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdh025
            #add-point:ON ACTION controlp INFIELD xmdh025
            {<point name="construct.c.page4.xmdh025" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdh026
            #add-point:BEFORE FIELD xmdh026
            {<point name="construct.b.page4.xmdh026" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdh026
            
            #add-point:AFTER FIELD xmdh026
            {<point name="construct.a.page4.xmdh026" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.xmdh026
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdh026
            #add-point:ON ACTION controlp INFIELD xmdh026
            {<point name="construct.c.page4.xmdh026" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdh027
            #add-point:BEFORE FIELD xmdh027
            {<point name="construct.b.page4.xmdh027" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdh027
            
            #add-point:AFTER FIELD xmdh027
            {<point name="construct.a.page4.xmdh027" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.xmdh027
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdh027
            #add-point:ON ACTION controlp INFIELD xmdh027
            {<point name="construct.c.page4.xmdh027" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdh028
            #add-point:BEFORE FIELD xmdh028
            {<point name="construct.b.page4.xmdh028" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdh028
            
            #add-point:AFTER FIELD xmdh028
            {<point name="construct.a.page4.xmdh028" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page4.xmdh028
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdh028
            #add-point:ON ACTION controlp INFIELD xmdh028
            {<point name="construct.c.page4.xmdh028" />}
            #END add-point
 
   
       
      END CONSTRUCT
      
      CONSTRUCT g_wc2_table2 ON xmdisite,xmdiseq,xmdiseq1,xmdi001,xmdi002,xmdi003,xmdi004,xmdi005,xmdi006, 
          xmdi007,xmdi013,xmdi008,xmdi009,xmdi010,xmdi011,xmdi012
           FROM s_detail2[1].xmdisite,s_detail2[1].xmdiseq,s_detail2[1].xmdiseq1,s_detail2[1].xmdi001, 
               s_detail2[1].xmdi002,s_detail2[1].xmdi003,s_detail2[1].xmdi004,s_detail2[1].xmdi005,s_detail2[1].xmdi006, 
               s_detail2[1].xmdi007,s_detail2[1].xmdi013,s_detail2[1].xmdi008,s_detail2[1].xmdi009,s_detail2[1].xmdi010, 
               s_detail2[1].xmdi011,s_detail2[1].xmdi012
                      
         BEFORE CONSTRUCT
            #add-point:cs段before_construct
            {<point name="cs.body2.before_construct"/>}
            #end add-point 
            
       #單身公用欄位開窗相關處理(table 2)
       
       
       #單身一般欄位開窗相關處理       
                #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdisite
            #add-point:BEFORE FIELD xmdisite
            {<point name="construct.b.page2.xmdisite" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdisite
            
            #add-point:AFTER FIELD xmdisite
            {<point name="construct.a.page2.xmdisite" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page2.xmdisite
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdisite
            #add-point:ON ACTION controlp INFIELD xmdisite
            {<point name="construct.c.page2.xmdisite" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdiseq
            #add-point:BEFORE FIELD xmdiseq
            {<point name="construct.b.page2.xmdiseq" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdiseq
            
            #add-point:AFTER FIELD xmdiseq
            {<point name="construct.a.page2.xmdiseq" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page2.xmdiseq
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdiseq
            #add-point:ON ACTION controlp INFIELD xmdiseq
            {<point name="construct.c.page2.xmdiseq" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdiseq1
            #add-point:BEFORE FIELD xmdiseq1
            {<point name="construct.b.page2.xmdiseq1" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdiseq1
            
            #add-point:AFTER FIELD xmdiseq1
            {<point name="construct.a.page2.xmdiseq1" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page2.xmdiseq1
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdiseq1
            #add-point:ON ACTION controlp INFIELD xmdiseq1
            {<point name="construct.c.page2.xmdiseq1" />}
            #END add-point
 
         #Ctrlp:construct.c.page2.xmdi001
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdi001
            #add-point:ON ACTION controlp INFIELD xmdi001
            {<point name="construct.c.page2.xmdi001" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdi001
            #add-point:BEFORE FIELD xmdi001
            {<point name="construct.b.page2.xmdi001" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdi001
            
            #add-point:AFTER FIELD xmdi001
            {<point name="construct.a.page2.xmdi001" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdi002
            #add-point:BEFORE FIELD xmdi002
            {<point name="construct.b.page2.xmdi002" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdi002
            
            #add-point:AFTER FIELD xmdi002
            {<point name="construct.a.page2.xmdi002" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page2.xmdi002
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdi002
            #add-point:ON ACTION controlp INFIELD xmdi002
            {<point name="construct.c.page2.xmdi002" />}
            #END add-point
 
         #Ctrlp:construct.c.page2.xmdi003
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdi003
            #add-point:ON ACTION controlp INFIELD xmdi003
            {<point name="construct.c.page2.xmdi003" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdi003
            #add-point:BEFORE FIELD xmdi003
            {<point name="construct.b.page2.xmdi003" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdi003
            
            #add-point:AFTER FIELD xmdi003
            {<point name="construct.a.page2.xmdi003" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdi004
            #add-point:BEFORE FIELD xmdi004
            {<point name="construct.b.page2.xmdi004" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdi004
            
            #add-point:AFTER FIELD xmdi004
            {<point name="construct.a.page2.xmdi004" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page2.xmdi004
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdi004
            #add-point:ON ACTION controlp INFIELD xmdi004
            {<point name="construct.c.page2.xmdi004" />}
            #END add-point
 
         #Ctrlp:construct.c.page2.xmdi005
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdi005
            #add-point:ON ACTION controlp INFIELD xmdi005
            {<point name="construct.c.page2.xmdi005" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdi005
            #add-point:BEFORE FIELD xmdi005
            {<point name="construct.b.page2.xmdi005" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdi005
            
            #add-point:AFTER FIELD xmdi005
            {<point name="construct.a.page2.xmdi005" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page2.xmdi006
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdi006
            #add-point:ON ACTION controlp INFIELD xmdi006
            {<point name="construct.c.page2.xmdi006" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdi006
            #add-point:BEFORE FIELD xmdi006
            {<point name="construct.b.page2.xmdi006" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdi006
            
            #add-point:AFTER FIELD xmdi006
            {<point name="construct.a.page2.xmdi006" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdi007
            #add-point:BEFORE FIELD xmdi007
            {<point name="construct.b.page2.xmdi007" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdi007
            
            #add-point:AFTER FIELD xmdi007
            {<point name="construct.a.page2.xmdi007" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page2.xmdi007
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdi007
            #add-point:ON ACTION controlp INFIELD xmdi007
            {<point name="construct.c.page2.xmdi007" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdi013
            #add-point:BEFORE FIELD xmdi013
            {<point name="construct.b.page2.xmdi013" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdi013
            
            #add-point:AFTER FIELD xmdi013
            {<point name="construct.a.page2.xmdi013" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page2.xmdi013
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdi013
            #add-point:ON ACTION controlp INFIELD xmdi013
            {<point name="construct.c.page2.xmdi013" />}
            #END add-point
 
         #Ctrlp:construct.c.page2.xmdi008
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdi008
            #add-point:ON ACTION controlp INFIELD xmdi008
            {<point name="construct.c.page2.xmdi008" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdi008
            #add-point:BEFORE FIELD xmdi008
            {<point name="construct.b.page2.xmdi008" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdi008
            
            #add-point:AFTER FIELD xmdi008
            {<point name="construct.a.page2.xmdi008" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdi009
            #add-point:BEFORE FIELD xmdi009
            {<point name="construct.b.page2.xmdi009" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdi009
            
            #add-point:AFTER FIELD xmdi009
            {<point name="construct.a.page2.xmdi009" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page2.xmdi009
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdi009
            #add-point:ON ACTION controlp INFIELD xmdi009
            {<point name="construct.c.page2.xmdi009" />}
            #END add-point
 
         #Ctrlp:construct.c.page2.xmdi010
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdi010
            #add-point:ON ACTION controlp INFIELD xmdi010
            {<point name="construct.c.page2.xmdi010" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdi010
            #add-point:BEFORE FIELD xmdi010
            {<point name="construct.b.page2.xmdi010" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdi010
            
            #add-point:AFTER FIELD xmdi010
            {<point name="construct.a.page2.xmdi010" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdi011
            #add-point:BEFORE FIELD xmdi011
            {<point name="construct.b.page2.xmdi011" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdi011
            
            #add-point:AFTER FIELD xmdi011
            {<point name="construct.a.page2.xmdi011" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page2.xmdi011
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdi011
            #add-point:ON ACTION controlp INFIELD xmdi011
            {<point name="construct.c.page2.xmdi011" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdi012
            #add-point:BEFORE FIELD xmdi012
            {<point name="construct.b.page2.xmdi012" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdi012
            
            #add-point:AFTER FIELD xmdi012
            {<point name="construct.a.page2.xmdi012" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page2.xmdi012
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdi012
            #add-point:ON ACTION controlp INFIELD xmdi012
            {<point name="construct.c.page2.xmdi012" />}
            #END add-point
 
   
       
      END CONSTRUCT
 
 
      
 
      
      #add-point:cs段add_cs(本段內只能出現新的CONSTRUCT指令)
      {<point name="cs.add_cs"/>}
      #end add-point
 
      BEFORE DIALOG
         CALL cl_qbe_init()
         #add-point:cs段b_dialog
         {<point name="cs.b_dialog"/>}
         #end add-point  
 
      #查詢方案列表
      ON ACTION qbe_select
         LET ls_wc = ""
         CALL cl_qbe_list("c") RETURNING ls_wc
         IF NOT cl_null(ls_wc) THEN
            CALL util.JSON.parse(ls_wc, la_wc)
            INITIALIZE g_wc, g_wc2, g_wc2_table1, g_wc2_extend TO NULL
            INITIALIZE g_wc2_table2 TO NULL
 
 
            FOR li_idx = 1 TO la_wc.getLength()
               CASE
                  WHEN la_wc[li_idx].tableid = "xmdg_t" 
                     LET g_wc = la_wc[li_idx].wc
                  WHEN la_wc[li_idx].tableid = "xmdh_t" 
                     LET g_wc2_table1 = la_wc[li_idx].wc
                  WHEN la_wc[li_idx].tableid = "xmdi_t" 
                     LET g_wc2_table2 = la_wc[li_idx].wc
 
 
               END CASE
            END FOR
         END IF
    
      #條件儲存為方案
      ON ACTION qbe_save
         CALL cl_qbe_save()
 
      ON ACTION accept
         ACCEPT DIALOG
 
      ON ACTION cancel
         LET INT_FLAG = 1
         EXIT DIALOG 
 
      #交談指令共用ACTION
      &include "common_action.4gl" 
         CONTINUE DIALOG
   END DIALOG
   
   #組合g_wc2
   LET g_wc2 = g_wc2_table1
   IF g_wc2_table2 <> " 1=1" THEN
      LET g_wc2 = g_wc2 ," AND ", g_wc2_table2
   END IF
 
 
 
 
   
   #add-point:cs段結束前
   {<point name="cs.after_construct"/>}
   #end add-point    
 
   IF INT_FLAG THEN
      RETURN
   END IF
 
END FUNCTION
]]>
  </section>
  <section id="axmt520.default_search" ver="12" status="" src="s" readonly="">
    <![CDATA[#+ 外部參數搜尋
PRIVATE FUNCTION axmt520_default_search()
   DEFINE li_idx     LIKE type_t.num10
   DEFINE li_cnt     LIKE type_t.num10
   DEFINE ls_wc      STRING
   DEFINE la_wc      DYNAMIC ARRAY OF RECORD
          tableid    STRING,
          wc         STRING
          END RECORD
   DEFINE ls_where   STRING
   #add-point:default_search段define
   {<point name="default_search.define" edit="s"/>}
   #end add-point  
   #add-point:default_search段define(客製用)
   {<point name="default_search.define_customerization" edit="c"/>}
   #end add-point  
   
   #add-point:default_search段開始前
   {<point name="default_search.before"/>}
   #end add-point  
   
   LET g_pagestart = 1
   
   IF cl_null(g_order) THEN
      LET g_order = "ASC"
   END IF
   
   IF NOT cl_null(g_argv[02]) THEN
      LET ls_wc = ls_wc, " xmdgdocno = '", g_argv[02], "' AND "
   END IF
   
 
   
   #add-point:default_search段after sql
   {<point name="default_search.after_sql"/>}
   #end add-point  
   
   IF NOT cl_null(ls_wc) THEN
      LET g_wc = ls_wc.subString(1,ls_wc.getLength()-5)
      LET g_default = TRUE
   ELSE
      #若無外部參數則預設為1=2
      LET g_default = FALSE
      
      #預設查詢條件
      CALL cl_qbe_get_default_qryplan() RETURNING ls_where
      IF NOT cl_null(ls_where) THEN
         CALL util.JSON.parse(ls_where, la_wc)
         INITIALIZE g_wc, g_wc2,g_wc2_table1,g_wc2_extend TO NULL
         INITIALIZE g_wc2_table2 TO NULL
 
 
         FOR li_idx = 1 TO la_wc.getLength()
            CASE
               WHEN la_wc[li_idx].tableid = "xmdg_t" 
                  LET g_wc = la_wc[li_idx].wc
               WHEN la_wc[li_idx].tableid = "xmdh_t" 
                  LET g_wc2_table1 = la_wc[li_idx].wc
               WHEN la_wc[li_idx].tableid = "xmdi_t" 
                  LET g_wc2_table2 = la_wc[li_idx].wc
 
 
               WHEN la_wc[li_idx].tableid = "EXTENDWC"
                  LET g_wc2_extend = la_wc[li_idx].wc
            END CASE
         END FOR
         IF NOT cl_null(g_wc) OR NOT cl_null(g_wc2_table1) 
            OR NOT cl_null(g_wc2_table2)
 
 
            OR NOT cl_null(g_wc2_extend)
            THEN
            #組合g_wc2
            IF g_wc2_table1 <> " 1=1" AND NOT cl_null(g_wc2_table1) THEN
               LET g_wc2 = g_wc2_table1
            END IF
            IF g_wc2_table2 <> " 1=1" AND NOT cl_null(g_wc2_table2) THEN
               LET g_wc2 = g_wc2 ," AND ", g_wc2_table2
            END IF
 
 
            IF g_wc2_extend <> " 1=1" AND NOT cl_null(g_wc2_extend) THEN
               LET g_wc2 = g_wc2 ," AND ", g_wc2_extend
            END IF
         
            IF g_wc2.subString(1,5) = " AND " THEN
               LET g_wc2 = g_wc2.subString(6,g_wc2.getLength())
            END IF
         END IF
      END IF
    
      IF cl_null(g_wc) AND cl_null(g_wc2) THEN
         LET g_wc = " 1=2"
      END IF
   END IF
   
   #add-point:default_search段結束前
   {<point name="default_search.after"/>}
   #end add-point  
 
   IF g_wc.getIndexOf(" 1=2", 1) THEN
      LET g_default = TRUE
   END IF
 
 
END FUNCTION
]]>
  </section>
  <section id="axmt520.delete" ver="44" status="" src="s" readonly="">
    <![CDATA[#+ 資料刪除
PRIVATE FUNCTION axmt520_delete()
   DEFINE  l_var_keys      DYNAMIC ARRAY OF STRING
   DEFINE  l_field_keys    DYNAMIC ARRAY OF STRING
   DEFINE  l_vars          DYNAMIC ARRAY OF STRING
   DEFINE  l_fields        DYNAMIC ARRAY OF STRING
   DEFINE  l_var_keys_bak  DYNAMIC ARRAY OF STRING
   #add-point:delete段define
   {<point name="delete.define" edit="s"/>}
   #end add-point     
   #add-point:delete段define(客製用)
   {<point name="delete.define_customerization" edit="c"/>}
   #end add-point     
   
   IF g_xmdg_m.xmdgdocno IS NULL
 
   THEN
      INITIALIZE g_errparam TO NULL 
      LET g_errparam.extend = "" 
      LET g_errparam.code   = "std-00003" 
      LET g_errparam.popup  = FALSE 
      CALL cl_err()
      RETURN
   END IF
   
   
   
   CALL s_transaction_begin()
 
   OPEN axmt520_cl USING g_enterprise,g_xmdg_m.xmdgdocno
   IF STATUS THEN
      INITIALIZE g_errparam TO NULL 
      LET g_errparam.extend = "OPEN axmt520_cl:" 
      LET g_errparam.code   = STATUS 
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      CLOSE axmt520_cl
      CALL s_transaction_end('N','0')
      RETURN
   END IF
 
   #顯示最新的資料
   EXECUTE axmt520_master_referesh USING g_xmdg_m.xmdgdocno INTO g_xmdg_m.xmdgdocno,g_xmdg_m.xmdgdocdt, 
       g_xmdg_m.xmdg004,g_xmdg_m.xmdgsite,g_xmdg_m.xmdg002,g_xmdg_m.xmdg003,g_xmdg_m.xmdgstus,g_xmdg_m.xmdg001, 
       g_xmdg_m.xmdg034,g_xmdg_m.xmdg005,g_xmdg_m.xmdg006,g_xmdg_m.xmdg007,g_xmdg_m.xmdg202,g_xmdg_m.xmdg028, 
       g_xmdg_m.xmdg026,g_xmdg_m.xmdg027,g_xmdg_m.xmdg024,g_xmdg_m.xmdg025,g_xmdg_m.xmdg030,g_xmdg_m.xmdg031, 
       g_xmdg_m.xmdg053,g_xmdg_m.xmdg056,g_xmdg_m.xmdg055,g_xmdg_m.xmdg054,g_xmdg_m.xmdg017,g_xmdg_m.xmdg018, 
       g_xmdg_m.xmdg019,g_xmdg_m.xmdg020,g_xmdg_m.xmdg016,g_xmdg_m.xmdg021,g_xmdg_m.xmdg022,g_xmdg_m.xmdg023, 
       g_xmdg_m.xmdg008,g_xmdg_m.xmdg009,g_xmdg_m.xmdg010,g_xmdg_m.xmdg011,g_xmdg_m.xmdg012,g_xmdg_m.xmdg013, 
       g_xmdg_m.xmdg032,g_xmdg_m.xmdg033,g_xmdg_m.xmdg014,g_xmdg_m.xmdg015,g_xmdg_m.xmdgownid,g_xmdg_m.xmdgowndp, 
       g_xmdg_m.xmdgcrtid,g_xmdg_m.xmdgcrtdp,g_xmdg_m.xmdgcrtdt,g_xmdg_m.xmdgmodid,g_xmdg_m.xmdgmoddt, 
       g_xmdg_m.xmdgcnfid,g_xmdg_m.xmdgcnfdt,g_xmdg_m.xmdg002_desc,g_xmdg_m.xmdg003_desc,g_xmdg_m.xmdg005_desc, 
       g_xmdg_m.xmdg006_desc,g_xmdg_m.xmdg007_desc,g_xmdg_m.xmdg202_desc,g_xmdg_m.xmdg026_desc,g_xmdg_m.xmdg027_desc, 
       g_xmdg_m.xmdg030_desc,g_xmdg_m.xmdg031_desc,g_xmdg_m.xmdg056_desc,g_xmdg_m.xmdg017_desc,g_xmdg_m.xmdg018_desc, 
       g_xmdg_m.xmdg016_desc,g_xmdg_m.xmdg008_desc,g_xmdg_m.xmdg009_desc,g_xmdg_m.xmdg014_desc,g_xmdg_m.xmdgownid_desc, 
       g_xmdg_m.xmdgowndp_desc,g_xmdg_m.xmdgcrtid_desc,g_xmdg_m.xmdgcrtdp_desc,g_xmdg_m.xmdgmodid_desc, 
       g_xmdg_m.xmdgcnfid_desc
   
   #檢查是否允許此動作
   IF NOT axmt520_action_chk() THEN
      RETURN
   END IF
   
   #遮罩相關處理
   LET g_xmdg_m_mask_o.* =  g_xmdg_m.*
   CALL axmt520_xmdg_t_mask()
   LET g_xmdg_m_mask_n.* =  g_xmdg_m.*
   
   CALL axmt520_show()
   
   #add-point:delete段before ask
   {<point name="delete.before_ask"/>}
   #end add-point 
 
   IF cl_ask_del_master() THEN              #確認一下
   
      #add-point:單頭刪除前
      {<point name="delete.head.b_delete" mark="Y"/>}
      #end add-point   
      
      #應用 a47 樣板自動產生(Version:2)
      #刪除相關文件
      CALL axmt520_set_pk_array()
      #add-point:相關文件刪除前
      {<point name="delete.befroe.related_document_remove"/>}
      #end add-point   
      CALL cl_doc_remove()  
 
 
  
  
      #資料備份
      LET g_xmdgdocno_t = g_xmdg_m.xmdgdocno
 
 
      DELETE FROM xmdg_t
       WHERE xmdgent = g_enterprise AND xmdgdocno = g_xmdg_m.xmdgdocno
 
       
      #add-point:單頭刪除中
      {<point name="delete.head.m_delete"/>}
      #end add-point
       
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = g_xmdg_m.xmdgdocno 
         LET g_errparam.code   = SQLCA.sqlcode 
         LET g_errparam.popup  = FALSE 
         CALL cl_err()
         CALL s_transaction_end('N','0')
         RETURN
      END IF
      
      #add-point:單頭刪除後
      {<point name="delete.head.a_delete"/>}
      #end add-point
  
      #add-point:單身刪除前
      {<point name="delete.body.b_delete" mark="Y"/>}
      #end add-point
      
      DELETE FROM xmdh_t
       WHERE xmdhent = g_enterprise AND xmdhdocno = g_xmdg_m.xmdgdocno
 
 
      #add-point:單身刪除中
      {<point name="delete.body.m_delete"/>}
      #end add-point
         
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = "xmdh_t" 
         LET g_errparam.code   = SQLCA.sqlcode 
         LET g_errparam.popup  = FALSE 
         CALL cl_err()
         CALL s_transaction_end('N','0')
         RETURN
      END IF    
 
      #add-point:單身刪除後
      {<point name="delete.body.a_delete"/>}
      #end add-point
      
            
                                                               
      #add-point:單身刪除前
      {<point name="delete.body.b_delete2" mark="Y"/>}
      #end add-point
      DELETE FROM xmdi_t
       WHERE xmdient = g_enterprise AND
             xmdidocno = g_xmdg_m.xmdgdocno
      #add-point:單身刪除中
      {<point name="delete.body.m_delete2"/>}
      #end add-point
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = "xmdi_t" 
         LET g_errparam.code   = SQLCA.sqlcode 
         LET g_errparam.popup  = FALSE 
         CALL cl_err()
         CALL s_transaction_end('N','0')
         RETURN
      END IF      
 
      #add-point:單身刪除後
      {<point name="delete.body.a_delete2"/>}
      #end add-point
 
 
 
 
      
      #修改歷程記錄(刪除)
      IF NOT cl_log_modified_record('','') THEN 
         CLOSE axmt520_cl
         CALL s_transaction_end('N','0')
         RETURN
      END IF
             
      CLEAR FORM
      CALL g_xmdh_d.clear() 
      CALL g_xmdh2_d.clear()       
      CALL g_xmdh3_d.clear()       
      CALL g_xmdh4_d.clear()       
 
     
      CALL axmt520_ui_browser_refresh()  
      #CALL axmt520_ui_headershow()  
      #CALL axmt520_ui_detailshow()
      
      IF g_browser_cnt > 0 THEN 
         #CALL axmt520_browser_fill("")
         CALL axmt520_fetch('P')
         DISPLAY g_browser_cnt TO FORMONLY.h_count   #總筆數的顯示
         DISPLAY g_browser_cnt TO FORMONLY.b_count   #總筆數的顯示
      ELSE
         CLEAR FORM
      END IF
 
      #add-point:多語言刪除
      {<point name="delete.lang.before_delete"/>}
      #end add-point
      
      #單頭多語言刪除
      
      
      #單身多語言刪除
      
      
 
 
 
   
      #add-point:多語言刪除
      {<point name="delete.lang.delete"/>}
      #end add-point
   
   END IF
 
   CALL s_transaction_end('Y','0')
   CLOSE axmt520_cl
 
   #功能已完成,通報訊息中心
   CALL axmt520_msgcentre_notify('delete')
    
END FUNCTION
]]>
  </section>
  <section id="axmt520.delete_b" ver="14" status="" src="s" readonly="">
    <![CDATA[#+ 刪除單身後其他table連動
PRIVATE FUNCTION axmt520_delete_b(ps_table,ps_keys_bak,ps_page)
   DEFINE ps_table    STRING
   DEFINE ps_page     STRING
   DEFINE ps_keys_bak DYNAMIC ARRAY OF VARCHAR(500)
   DEFINE ls_group    STRING
   DEFINE li_idx      LIKE type_t.num10
   #add-point:delete_b段define
   {<point name="delete_b.define" edit="s"/>}
   #end add-point     
   #add-point:delete_b段define(客製用)
   {<point name="delete_b.define_customerization" edit="c"/>}
   #end add-point     
 
   LET g_update = TRUE  
   
   #判斷是否是同一群組的table
   LET ls_group = "'1','3','4',"
   IF ls_group.getIndexOf(ps_page,1) > 0 THEN
      #add-point:delete_b段刪除前
      {<point name="delete_b.b_delete" mark="Y"/>}
      #end add-point    
      DELETE FROM xmdh_t
       WHERE xmdhent = g_enterprise AND
         xmdhdocno = ps_keys_bak[1] AND xmdhseq = ps_keys_bak[2]
      #add-point:delete_b段刪除中
      {<point name="delete_b.m_delete"/>}
      #end add-point    
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = "" 
         LET g_errparam.code   = SQLCA.sqlcode 
         LET g_errparam.popup  = FALSE 
         CALL cl_err()
         RETURN FALSE
      END IF
      LET li_idx = g_detail_idx
      IF ps_page <> "'1'" THEN 
         CALL g_xmdh_d.deleteElement(li_idx) 
      END IF 
      IF ps_page <> "'3'" THEN 
         CALL g_xmdh3_d.deleteElement(li_idx) 
      END IF 
      IF ps_page <> "'4'" THEN 
         CALL g_xmdh4_d.deleteElement(li_idx) 
      END IF 
 
   END IF
   
   LET ls_group = "'2',"
   #判斷是否是同一群組的table
   IF ls_group.getIndexOf(ps_page,1) > 0 THEN
      #add-point:delete_b段刪除前
      {<point name="delete_b.b_delete2" mark="Y"/>}
      #end add-point    
      DELETE FROM xmdi_t
       WHERE xmdient = g_enterprise AND
             xmdidocno = ps_keys_bak[1] AND xmdiseq = ps_keys_bak[2] AND xmdiseq1 = ps_keys_bak[3]
      #add-point:delete_b段刪除中
      {<point name="delete_b.m_delete2"/>}
      #end add-point    
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = "xmdi_t" 
         LET g_errparam.code   = SQLCA.sqlcode 
         LET g_errparam.popup  = FALSE 
         CALL cl_err()
         RETURN FALSE
      END IF
      
      LET li_idx = g_detail_idx
      IF ps_page <> "'2'" THEN 
         CALL g_xmdh2_d.deleteElement(li_idx) 
      END IF 
 
      #add-point:delete_b段刪除後
      {<point name="delete_b.a_delete2"/>}
      #end add-point    
   END IF
 
 
   
 
   
   #add-point:delete_b段other
   {<point name="delete_b.other"/>}
   #end add-point  
   
   RETURN TRUE
   
END FUNCTION
]]>
  </section>
  <section id="axmt520.description" ver="347" status="" src="s" readonly="">
    <![CDATA[#應用 a00 樣板自動產生(Version:1)
#+ Version..: T100-ERP-1.00.00(SD版次:20,PR版次:20) Build-000707
#+ 
#+ Filename...: axmt520
#+ Description: 出貨通知單維護作業
#+ Creator....: 04441(2014-02-26 16:51:19)
#+ Modifier...: 01996(2015-06-18 15:41:52) -SD/PR-
]]>
  </section>
  <section id="axmt520.detail_reproduce" ver="12" status="" src="s" readonly="">
    <![CDATA[#+ 單身自動複製
PRIVATE FUNCTION axmt520_detail_reproduce()
   DEFINE ls_sql      STRING
   DEFINE ld_date     DATETIME YEAR TO SECOND
   DEFINE l_detail    RECORD LIKE xmdh_t.*
   DEFINE l_detail2    RECORD LIKE xmdi_t.*
 
 
 
   #add-point:delete段define
   {<point name="detail_reproduce.define" edit="s"/>}
   #end add-point    
   #add-point:delete段define(客製用)
   {<point name="detail_reproduce.define_customerization" edit="c"/>}
   #end add-point    
   
   CALL s_transaction_begin()
   
   LET ld_date = cl_get_current()
   
   DROP TABLE axmt520_detail
   
   #add-point:單身複製前1
   {<point name="detail_reproduce.body.table1.b_insert" mark="Y"/>}
   #end add-point
   
   #CREATE TEMP TABLE
   LET ls_sql = "CREATE GLOBAL TEMPORARY TABLE axmt520_detail AS ",
                "SELECT * FROM xmdh_t "
   PREPARE repro_tbl FROM ls_sql
   EXECUTE repro_tbl
   FREE repro_tbl
                
   #將符合條件的資料丟入TEMP TABLE
   INSERT INTO axmt520_detail SELECT * FROM xmdh_t 
                                         WHERE xmdhent = g_enterprise AND xmdhdocno = g_xmdgdocno_t
 
   
   #將key修正為調整後   
   UPDATE axmt520_detail 
      #更新key欄位
      SET xmdhdocno = g_xmdg_m.xmdgdocno
 
      #更新共用欄位
      
 
   #add-point:單身修改前
   {<point name="detail_reproduce.body.table1.b_update"/>}
   #end add-point                                       
  
   #將資料塞回原table   
   INSERT INTO xmdh_t SELECT * FROM axmt520_detail
   
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL 
      LET g_errparam.extend = "reproduce" 
      LET g_errparam.code   = SQLCA.sqlcode 
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      RETURN
   END IF
   
   #add-point:單身複製中1
   {<point name="detail_reproduce.body.table1.m_insert"/>}
   #end add-point
   
   #刪除TEMP TABLE
   DROP TABLE axmt520_detail
   
   #add-point:單身複製後1
   {<point name="detail_reproduce.body.table1.a_insert"/>}
   #end add-point
 
   #add-point:單身複製前
   {<point name="detail_reproduce.body.table2.b_insert" mark="Y"/>}
   #end add-point
   
   #CREATE TEMP TABLE
   LET ls_sql = 
      "CREATE GLOBAL TEMPORARY TABLE axmt520_detail AS ",
      "SELECT * FROM xmdi_t "
   PREPARE repro_tbl2 FROM ls_sql
   EXECUTE repro_tbl2
   FREE repro_tbl2
      
   #將符合條件的資料丟入TEMP TABLE
   INSERT INTO axmt520_detail SELECT * FROM xmdi_t
                                         WHERE xmdient = g_enterprise AND xmdidocno = g_xmdgdocno_t
 
 
   #將key修正為調整後   
   UPDATE axmt520_detail SET xmdidocno = g_xmdg_m.xmdgdocno
 
  
   #將資料塞回原table   
   INSERT INTO xmdi_t SELECT * FROM axmt520_detail
   
   #add-point:單身複製中
   {<point name="detail_reproduce.body.table2.m_insert"/>}
   #end add-point
   
   #刪除TEMP TABLE
   DROP TABLE axmt520_detail
   
   #add-point:單身複製後
   {<point name="detail_reproduce.body.table2.a_insert"/>}
   #end add-point
 
 
   
 
   
   #多語言複製段落
   
   
   CALL s_transaction_end('Y','0')
   
   #已新增完, 調整資料內容(修改時使用)
   LET g_xmdgdocno_t = g_xmdg_m.xmdgdocno
 
   
END FUNCTION
]]>
  </section>
  <section id="axmt520.detail_show" ver="6" status="" src="s" readonly="">
    <![CDATA[#+ 第二階單身reference
PRIVATE FUNCTION axmt520_detail_show()
   #add-point:detail_show段define
   {<point name="detail_show.define" edit="s"/>}
   #end add-point  
   #add-point:detail_show段define(客製用)
   {<point name="detail_show.define_customerization" edit="c"/>}
   #end add-point  
   
   #add-point:detail_show段之前
   {<point name="detail_show.before"/>}
   #end add-point
   
   #add-point:detail_show段之後
   {<point name="detail_show.after"/>}
   #end add-point
   
END FUNCTION
]]>
  </section>
  <section id="axmt520.fetch" ver="31" status="" src="s" readonly="">
    <![CDATA[#+ 指定PK後抓取單頭其他資料
PRIVATE FUNCTION axmt520_fetch(p_flag)
   DEFINE p_flag     LIKE type_t.chr1
   DEFINE ls_msg     STRING
   #add-point:fetch段define
   {<point name="fetch.define" edit="s"/>}
   #end add-point    
   #add-point:fetch段define(客製用)
   {<point name="fetch.define_customerization" edit="c"/>}
   #end add-point    
   
   IF g_browser_cnt = 0 THEN
      RETURN
   END IF
 
   CALL cl_ap_performance_next_start()
   CASE p_flag
      WHEN 'F' 
         LET g_current_idx = 1
      WHEN 'L'  
         LET g_current_idx = g_browser.getLength()              
      WHEN 'P'
         IF g_current_idx > 1 THEN               
            LET g_current_idx = g_current_idx - 1
         END IF 
      WHEN 'N'
         IF g_current_idx < g_header_cnt THEN
            LET g_current_idx =  g_current_idx + 1
         END IF        
      WHEN '/'
         IF (NOT g_no_ask) THEN    
            CALL cl_set_act_visible("accept,cancel", TRUE)    
            CALL cl_getmsg('fetch',g_lang) RETURNING ls_msg
            LET INT_FLAG = 0
 
            PROMPT ls_msg CLIPPED,':' FOR g_jump
               #交談指令共用ACTION
               &include "common_action.4gl" 
            END PROMPT
 
            CALL cl_set_act_visible("accept,cancel", FALSE)    
            IF INT_FLAG THEN
                LET INT_FLAG = 0
                EXIT CASE  
            END IF           
         END IF
         
         IF g_jump > 0 AND g_jump <= g_browser.getLength() THEN
             LET g_current_idx = g_jump
         END IF
         LET g_no_ask = FALSE  
   END CASE 
 
   CALL g_curr_diag.setCurrentRow("s_browse", g_current_idx) #設定browse 索引
   
   LET g_current_row = g_current_idx
   LET g_detail_cnt = g_header_cnt                  
   
   #單身總筆數顯示
   IF g_detail_cnt > 0 THEN
      #若單身有資料時, idx至少為1
      IF g_detail_idx <= 0 THEN
         LET g_detail_idx = 1
      END IF
      DISPLAY g_detail_idx TO FORMONLY.idx  
   ELSE
      LET g_detail_idx = 0
      DISPLAY '' TO FORMONLY.idx    
   END IF
   
   #瀏覽頁筆數顯示
   LET g_browser_idx = g_pagestart+g_current_idx-1
   DISPLAY g_browser_idx TO FORMONLY.b_index   #當下筆數
   DISPLAY g_browser_idx TO FORMONLY.h_index   #當下筆數
   
   CALL cl_navigator_setting( g_current_idx, g_browser_cnt )
 
   #代表沒有資料
   IF g_current_idx = 0 OR g_browser.getLength() = 0 THEN
      RETURN
   END IF
   
   #超出範圍
   IF g_current_idx > g_browser.getLength() THEN
      LET g_current_idx = g_browser.getLength()
   END IF
   
   LET g_xmdg_m.xmdgdocno = g_browser[g_current_idx].b_xmdgdocno
 
   
   #重讀DB,因TEMP有不被更新特性
   EXECUTE axmt520_master_referesh USING g_xmdg_m.xmdgdocno INTO g_xmdg_m.xmdgdocno,g_xmdg_m.xmdgdocdt, 
       g_xmdg_m.xmdg004,g_xmdg_m.xmdgsite,g_xmdg_m.xmdg002,g_xmdg_m.xmdg003,g_xmdg_m.xmdgstus,g_xmdg_m.xmdg001, 
       g_xmdg_m.xmdg034,g_xmdg_m.xmdg005,g_xmdg_m.xmdg006,g_xmdg_m.xmdg007,g_xmdg_m.xmdg202,g_xmdg_m.xmdg028, 
       g_xmdg_m.xmdg026,g_xmdg_m.xmdg027,g_xmdg_m.xmdg024,g_xmdg_m.xmdg025,g_xmdg_m.xmdg030,g_xmdg_m.xmdg031, 
       g_xmdg_m.xmdg053,g_xmdg_m.xmdg056,g_xmdg_m.xmdg055,g_xmdg_m.xmdg054,g_xmdg_m.xmdg017,g_xmdg_m.xmdg018, 
       g_xmdg_m.xmdg019,g_xmdg_m.xmdg020,g_xmdg_m.xmdg016,g_xmdg_m.xmdg021,g_xmdg_m.xmdg022,g_xmdg_m.xmdg023, 
       g_xmdg_m.xmdg008,g_xmdg_m.xmdg009,g_xmdg_m.xmdg010,g_xmdg_m.xmdg011,g_xmdg_m.xmdg012,g_xmdg_m.xmdg013, 
       g_xmdg_m.xmdg032,g_xmdg_m.xmdg033,g_xmdg_m.xmdg014,g_xmdg_m.xmdg015,g_xmdg_m.xmdgownid,g_xmdg_m.xmdgowndp, 
       g_xmdg_m.xmdgcrtid,g_xmdg_m.xmdgcrtdp,g_xmdg_m.xmdgcrtdt,g_xmdg_m.xmdgmodid,g_xmdg_m.xmdgmoddt, 
       g_xmdg_m.xmdgcnfid,g_xmdg_m.xmdgcnfdt,g_xmdg_m.xmdg002_desc,g_xmdg_m.xmdg003_desc,g_xmdg_m.xmdg005_desc, 
       g_xmdg_m.xmdg006_desc,g_xmdg_m.xmdg007_desc,g_xmdg_m.xmdg202_desc,g_xmdg_m.xmdg026_desc,g_xmdg_m.xmdg027_desc, 
       g_xmdg_m.xmdg030_desc,g_xmdg_m.xmdg031_desc,g_xmdg_m.xmdg056_desc,g_xmdg_m.xmdg017_desc,g_xmdg_m.xmdg018_desc, 
       g_xmdg_m.xmdg016_desc,g_xmdg_m.xmdg008_desc,g_xmdg_m.xmdg009_desc,g_xmdg_m.xmdg014_desc,g_xmdg_m.xmdgownid_desc, 
       g_xmdg_m.xmdgowndp_desc,g_xmdg_m.xmdgcrtid_desc,g_xmdg_m.xmdgcrtdp_desc,g_xmdg_m.xmdgmodid_desc, 
       g_xmdg_m.xmdgcnfid_desc
   
   #遮罩相關處理
   LET g_xmdg_m_mask_o.* =  g_xmdg_m.*
   CALL axmt520_xmdg_t_mask()
   LET g_xmdg_m_mask_n.* =  g_xmdg_m.*
   
   #根據資料狀態切換action狀態
   CALL cl_set_act_visible("statechange,modify,modify_detail,delete,reproduce", TRUE)
   CALL axmt520_set_act_visible()   
   CALL axmt520_set_act_no_visible()
   
   #add-point:fetch段action控制
   {<point name="fetch.action_control"/>}
   #end add-point  
   
   
   
   #add-point:fetch結束前
   {<point name="fetch.after" />}
   #end add-point
   
   #保存單頭舊值
   LET g_xmdg_m_t.* = g_xmdg_m.*
   LET g_xmdg_m_o.* = g_xmdg_m.*
   
   LET g_data_owner = g_xmdg_m.xmdgownid      
   LET g_data_dept  = g_xmdg_m.xmdgowndp
   
   #重新顯示   
   CALL axmt520_show()
 
   #應用 a56 樣板自動產生(Version:2)
   #檢查此單據是否需顯示BPM簽核狀況按鈕 
   IF cl_bpm_chk() THEN
      CALL cl_set_act_visible("bpm_status",TRUE)
   ELSE
      CALL cl_set_act_visible("bpm_status",FALSE)
   END IF
 
 
 
 
END FUNCTION
]]>
  </section>
  <section id="axmt520.fill_chk" ver="9" status="" src="s" readonly="">
    <![CDATA[#+ 單身填充確認
PRIVATE FUNCTION axmt520_fill_chk(ps_idx)
   DEFINE ps_idx        LIKE type_t.chr10
   #add-point:fill_chk段define
   {<point name="fill_chk.define" edit="s"/>}
   #end add-point
   #add-point:fill_chk段define(客製用)
   {<point name="fill_chk.define_customerization" edit="c"/>}
   #end add-point
   
   #add-point:fill_chk段before_chk
   {<point name="fill_chk.before_chk"/>}
   #end add-point
   
   #此funtion功能暫時停用(2015/1/12)
   #無論傳入值為何皆回傳true(代表要填充該單身)
 
   #全部為1=1 or null時回傳true
   IF (cl_null(g_wc2_table1) OR g_wc2_table1.trim() = '1=1')  AND 
      (cl_null(g_wc2_table2) OR g_wc2_table2.trim() = '1=1') THEN
      #add-point:fill_chk段other_chk
      {<point name="fill_chk.other_chk"/>}
      #end add-point
      RETURN TRUE
   END IF
   
   #add-point:fill_chk段after_chk
   {<point name="fill_chk.after_chk"/>}
   #end add-point
   
   RETURN TRUE
 
END FUNCTION
]]>
  </section>
  <section id="axmt520.filter" ver="10" status="" src="s" readonly="">
    <![CDATA[#應用 a50 樣板自動產生(Version:5)
#+ filter過濾功能
PRIVATE FUNCTION axmt520_filter()
   #add-point:filter段define
   {<point name="filter.define" edit="s"/>}
   #end add-point   
   #add-point:filter段define
   {<point name="filter.define_customerization" edit="c"/>}
   #end add-point   
   
   #切換畫面
   IF NOT g_main_hidden THEN
      CALL gfrm_curr.setElementHidden("mainlayout",1)
      CALL gfrm_curr.setElementHidden("worksheet",0)
      LET g_main_hidden = 1
   END IF   
 
   LET INT_FLAG = 0
 
   LET g_qryparam.state = 'c'
 
   LET g_wc_filter_t = g_wc_filter.trim()
   LET g_wc_t = g_wc
 
   LET g_wc = cl_replace_str(g_wc, g_wc_filter_t, '')
 
   #使用DIALOG包住 單頭CONSTRUCT及單身CONSTRUCT
   DIALOG ATTRIBUTES(UNBUFFERED,FIELD ORDER FORM)
 
      #單頭
      CONSTRUCT g_wc_filter ON xmdgdocno,xmdgdocdt,xmdg002,xmdg003,xmdg004,xmdg005,xmdg006,xmdg007
                          FROM s_browse[1].b_xmdgdocno,s_browse[1].b_xmdgdocdt,s_browse[1].b_xmdg002, 
                              s_browse[1].b_xmdg003,s_browse[1].b_xmdg004,s_browse[1].b_xmdg005,s_browse[1].b_xmdg006, 
                              s_browse[1].b_xmdg007
 
         BEFORE CONSTRUCT
               DISPLAY axmt520_filter_parser('xmdgdocno') TO s_browse[1].b_xmdgdocno
            DISPLAY axmt520_filter_parser('xmdgdocdt') TO s_browse[1].b_xmdgdocdt
            DISPLAY axmt520_filter_parser('xmdg002') TO s_browse[1].b_xmdg002
            DISPLAY axmt520_filter_parser('xmdg003') TO s_browse[1].b_xmdg003
            DISPLAY axmt520_filter_parser('xmdg004') TO s_browse[1].b_xmdg004
            DISPLAY axmt520_filter_parser('xmdg005') TO s_browse[1].b_xmdg005
            DISPLAY axmt520_filter_parser('xmdg006') TO s_browse[1].b_xmdg006
            DISPLAY axmt520_filter_parser('xmdg007') TO s_browse[1].b_xmdg007
      
         #add-point:filter段cs_ctrl
         {<point name="filter.cs_ctrl"/>}
         #end add-point
      
      END CONSTRUCT
 
      #add-point:filter段add_cs
      {<point name="filter.add_cs"/>}
      #end add-point
 
      BEFORE DIALOG
         #add-point:filter段b_dialog
         {<point name="filter.b_dialog"/>}
         #end add-point  
      
      ON ACTION accept
         ACCEPT DIALOG
 
      ON ACTION cancel
         LET INT_FLAG = 1
         EXIT DIALOG 
 
      #交談指令共用ACTION
      &include "common_action.4gl" 
         CONTINUE DIALOG
   
   END DIALOG
 
   IF NOT INT_FLAG THEN
      LET g_wc_filter = "   AND   ", g_wc_filter, "   "
      LET g_wc = g_wc , g_wc_filter
   ELSE
      LET g_wc_filter = g_wc_filter_t
      LET g_wc = g_wc_t
   END IF
 
      CALL axmt520_filter_show('xmdgdocno')
   CALL axmt520_filter_show('xmdgdocdt')
   CALL axmt520_filter_show('xmdg002')
   CALL axmt520_filter_show('xmdg003')
   CALL axmt520_filter_show('xmdg004')
   CALL axmt520_filter_show('xmdg005')
   CALL axmt520_filter_show('xmdg006')
   CALL axmt520_filter_show('xmdg007')
 
END FUNCTION
]]>
  </section>
  <section id="axmt520.filter_parser" ver="4" status="" src="s" readonly="">
    <![CDATA[#+ filter過濾功能
PRIVATE FUNCTION axmt520_filter_parser(ps_field)
   DEFINE ps_field   STRING
   DEFINE ls_tmp     STRING
   DEFINE li_tmp     LIKE type_t.num10
   DEFINE li_tmp2    LIKE type_t.num10
   DEFINE ls_var     STRING
   #add-point:filter段define
   {<point name="filter_parser.define" edit="s"/>}
   #end add-point    
   #add-point:filter段define
   {<point name="filter_parser.define_customerization" edit="s"/>}
   #end add-point    
 
   #一般條件解析
   LET ls_tmp = ps_field, "='"
   LET li_tmp = g_wc_filter.getIndexOf(ls_tmp,1)
   IF li_tmp > 0 THEN
      LET li_tmp = ls_tmp.getLength() + li_tmp
      LET li_tmp2 = g_wc_filter.getIndexOf("'",li_tmp + 1) - 1
      LET ls_var = g_wc_filter.subString(li_tmp,li_tmp2)
   END IF
 
   #模糊條件解析
   LET ls_tmp = ps_field, " like '"
   LET li_tmp = g_wc_filter.getIndexOf(ls_tmp,1)
   IF li_tmp > 0 THEN
      LET li_tmp = ls_tmp.getLength() + li_tmp
      LET li_tmp2 = g_wc_filter.getIndexOf("'",li_tmp + 1) - 1
      LET ls_var = g_wc_filter.subString(li_tmp,li_tmp2)
      LET ls_var = cl_replace_str(ls_var,'%','*')
   END IF
 
   RETURN ls_var
 
END FUNCTION
]]>
  </section>
  <section id="axmt520.filter_show" ver="1" status="" src="s" readonly="">
    <![CDATA[#+ 顯示過濾條件
PRIVATE FUNCTION axmt520_filter_show(ps_field)
   DEFINE ps_field         STRING
   DEFINE lnode_item       om.DomNode
   DEFINE ls_title         STRING
   DEFINE ls_name          STRING
   DEFINE ls_condition     STRING
 
   LET ls_name = "formonly.b_", ps_field
   LET lnode_item = gfrm_curr.findNode("TableColumn", ls_name)
   LET ls_title = lnode_item.getAttribute("text")
   IF ls_title.getIndexOf('※',1) > 0 THEN
      LEt ls_title = ls_title.subString(1,ls_title.getIndexOf('※',1)-1)
   END IF
 
   #顯示資料組合
   LET ls_condition = axmt520_filter_parser(ps_field)
   IF NOT cl_null(ls_condition) THEN
      LET ls_title = ls_title, '※', ls_condition, '※'
   END IF
 
   #將資料顯示回去
   CALL lnode_item.setAttribute("text",ls_title)
 
END FUNCTION
]]>
  </section>
  <section id="axmt520.global" ver="87" status="" src="s" readonly="">
    <![CDATA[#應用 t01 樣板自動產生(Version:39)
{<point name="global.memo" />}
        
IMPORT os
IMPORT util
IMPORT FGL lib_cl_dlg
#add-point:增加匯入項目
{<point name="global.import" />}
#end add-point
 
SCHEMA ds 
 
GLOBALS "../../cfg/top_global.inc"
 
#add-point:增加匯入變數檔
{<point name="global.inc" />}
#end add-point
 
#單頭 type 宣告
PRIVATE type type_g_xmdg_m        RECORD
       xmdgdocno LIKE xmdg_t.xmdgdocno, 
   xmdgdocno_desc LIKE type_t.chr80, 
   xmdgdocdt LIKE xmdg_t.xmdgdocdt, 
   xmdg004 LIKE xmdg_t.xmdg004, 
   xmdgsite LIKE xmdg_t.xmdgsite, 
   xmdg002 LIKE xmdg_t.xmdg002, 
   xmdg002_desc LIKE type_t.chr80, 
   xmdg003 LIKE xmdg_t.xmdg003, 
   xmdg003_desc LIKE type_t.chr80, 
   xmdgstus LIKE xmdg_t.xmdgstus, 
   xmdg001 LIKE xmdg_t.xmdg001, 
   xmdg034 LIKE xmdg_t.xmdg034, 
   xmdg005 LIKE xmdg_t.xmdg005, 
   xmdg005_desc LIKE type_t.chr80, 
   xmdg006 LIKE xmdg_t.xmdg006, 
   xmdg006_desc LIKE type_t.chr80, 
   xmdg007 LIKE xmdg_t.xmdg007, 
   xmdg007_desc LIKE type_t.chr80, 
   xmdg202 LIKE xmdg_t.xmdg202, 
   xmdg202_desc LIKE type_t.chr80, 
   xmdg028 LIKE xmdg_t.xmdg028, 
   xmdg026 LIKE xmdg_t.xmdg026, 
   xmdg026_desc LIKE type_t.chr80, 
   xmdg027 LIKE xmdg_t.xmdg027, 
   xmdg027_desc LIKE type_t.chr80, 
   xmdg024 LIKE xmdg_t.xmdg024, 
   xmdg025 LIKE xmdg_t.xmdg025, 
   xmdg030 LIKE xmdg_t.xmdg030, 
   xmdg030_desc LIKE type_t.chr80, 
   xmdg031 LIKE xmdg_t.xmdg031, 
   xmdg031_desc LIKE type_t.chr80, 
   xmdg053 LIKE xmdg_t.xmdg053, 
   xmdg056 LIKE xmdg_t.xmdg056, 
   xmdg056_desc LIKE type_t.chr80, 
   xmdg055 LIKE xmdg_t.xmdg055, 
   xmdg054 LIKE xmdg_t.xmdg054, 
   xmdg017 LIKE xmdg_t.xmdg017, 
   xmdg017_desc LIKE type_t.chr80, 
   textedit1 LIKE type_t.chr500, 
   xmdg018 LIKE xmdg_t.xmdg018, 
   xmdg018_desc LIKE type_t.chr80, 
   xmdg019 LIKE xmdg_t.xmdg019, 
   xmdg019_desc LIKE type_t.chr80, 
   xmdg020 LIKE xmdg_t.xmdg020, 
   xmdg020_desc LIKE type_t.chr80, 
   xmdg016 LIKE xmdg_t.xmdg016, 
   xmdg016_desc LIKE type_t.chr80, 
   xmdg021 LIKE xmdg_t.xmdg021, 
   xmdg022 LIKE xmdg_t.xmdg022, 
   xmdg023 LIKE xmdg_t.xmdg023, 
   xmdg023_desc LIKE type_t.chr80, 
   xmdg008 LIKE xmdg_t.xmdg008, 
   xmdg008_desc LIKE type_t.chr80, 
   xmdg009 LIKE xmdg_t.xmdg009, 
   xmdg009_desc LIKE type_t.chr80, 
   xmdg010 LIKE xmdg_t.xmdg010, 
   xmdg010_desc LIKE type_t.chr80, 
   xmdg011 LIKE xmdg_t.xmdg011, 
   xmdg012 LIKE xmdg_t.xmdg012, 
   xmdg013 LIKE xmdg_t.xmdg013, 
   xmdg013_desc LIKE type_t.chr80, 
   xmdg032 LIKE xmdg_t.xmdg032, 
   xmdg033 LIKE xmdg_t.xmdg033, 
   xmdg014 LIKE xmdg_t.xmdg014, 
   xmdg014_desc LIKE type_t.chr80, 
   xmdg015 LIKE xmdg_t.xmdg015, 
   xmdgownid LIKE xmdg_t.xmdgownid, 
   xmdgownid_desc LIKE type_t.chr80, 
   xmdgowndp LIKE xmdg_t.xmdgowndp, 
   xmdgowndp_desc LIKE type_t.chr80, 
   xmdgcrtid LIKE xmdg_t.xmdgcrtid, 
   xmdgcrtid_desc LIKE type_t.chr80, 
   xmdgcrtdp LIKE xmdg_t.xmdgcrtdp, 
   xmdgcrtdp_desc LIKE type_t.chr80, 
   xmdgcrtdt LIKE xmdg_t.xmdgcrtdt, 
   xmdgmodid LIKE xmdg_t.xmdgmodid, 
   xmdgmodid_desc LIKE type_t.chr80, 
   xmdgmoddt LIKE xmdg_t.xmdgmoddt, 
   xmdgcnfid LIKE xmdg_t.xmdgcnfid, 
   xmdgcnfid_desc LIKE type_t.chr80, 
   xmdgcnfdt LIKE xmdg_t.xmdgcnfdt
       END RECORD
 
#單身 type 宣告
PRIVATE TYPE type_g_xmdh_d        RECORD
       xmdhsite LIKE type_t.chr10, 
   xmdhseq LIKE xmdh_t.xmdhseq, 
   xmdh001 LIKE xmdh_t.xmdh001, 
   xmdh002 LIKE xmdh_t.xmdh002, 
   xmdh003 LIKE xmdh_t.xmdh003, 
   xmdh004 LIKE xmdh_t.xmdh004, 
   xmda033 LIKE type_t.chr500, 
   xmdh005 LIKE xmdh_t.xmdh005, 
   xmdh006 LIKE xmdh_t.xmdh006, 
   xmdh006_desc LIKE type_t.chr500, 
   xmdh006_desc_desc LIKE type_t.chr500, 
   xmdh007 LIKE xmdh_t.xmdh007, 
   xmdh007_desc LIKE type_t.chr500, 
   xmdh034 LIKE xmdh_t.xmdh034, 
   xmdh009 LIKE xmdh_t.xmdh009, 
   xmdh009_desc LIKE type_t.chr500, 
   xmdh010 LIKE xmdh_t.xmdh010, 
   xmdh015 LIKE xmdh_t.xmdh015, 
   xmdh015_desc LIKE type_t.chr500, 
   xmdh016 LIKE xmdh_t.xmdh016, 
   xmdh017 LIKE xmdh_t.xmdh017, 
   xmdh018 LIKE xmdh_t.xmdh018, 
   xmdh018_desc LIKE type_t.chr500, 
   xmdh019 LIKE xmdh_t.xmdh019, 
   xmdh008 LIKE xmdh_t.xmdh008, 
   xmdh011 LIKE xmdh_t.xmdh011, 
   xmdh012 LIKE xmdh_t.xmdh012, 
   xmdh012_desc LIKE type_t.chr500, 
   xmdh013 LIKE xmdh_t.xmdh013, 
   xmdh013_desc LIKE type_t.chr500, 
   xmdh014 LIKE xmdh_t.xmdh014, 
   xmdh029 LIKE xmdh_t.xmdh029, 
   xmdh020 LIKE xmdh_t.xmdh020, 
   xmdh020_desc LIKE type_t.chr500, 
   xmdh021 LIKE xmdh_t.xmdh021, 
   xmdh022 LIKE xmdh_t.xmdh022, 
   xmdh036 LIKE xmdh_t.xmdh036, 
   xmdh031 LIKE xmdh_t.xmdh031, 
   xmdh031_desc LIKE type_t.chr500, 
   xmdh032 LIKE xmdh_t.xmdh032, 
   xmdh032_desc LIKE type_t.chr500, 
   xmdh033 LIKE xmdh_t.xmdh033, 
   xmdh033_desc LIKE type_t.chr500, 
   xmdh050 LIKE xmdh_t.xmdh050, 
   xmdh056 LIKE xmdh_t.xmdh056, 
   xmdh030 LIKE xmdh_t.xmdh030, 
   xmdh051 LIKE xmdh_t.xmdh051, 
   xmdh052 LIKE xmdh_t.xmdh052, 
   xmdhunit LIKE xmdh_t.xmdhunit, 
   xmdh035 LIKE xmdh_t.xmdh035
       END RECORD
PRIVATE TYPE type_g_xmdh2_d RECORD
       xmdisite LIKE xmdi_t.xmdisite, 
   xmdiseq LIKE xmdi_t.xmdiseq, 
   xmdiseq1 LIKE xmdi_t.xmdiseq1, 
   xmdi001 LIKE xmdi_t.xmdi001, 
   xmdi001_desc LIKE type_t.chr500, 
   xmdi001_desc_desc LIKE type_t.chr500, 
   xmdi002 LIKE xmdi_t.xmdi002, 
   xmdi002_desc LIKE type_t.chr500, 
   xmdi003 LIKE xmdi_t.xmdi003, 
   xmdi003_desc LIKE type_t.chr500, 
   xmdi004 LIKE xmdi_t.xmdi004, 
   xmdi005 LIKE xmdi_t.xmdi005, 
   xmdi005_desc LIKE type_t.chr500, 
   xmdi006 LIKE xmdi_t.xmdi006, 
   xmdi006_desc LIKE type_t.chr500, 
   xmdi007 LIKE xmdi_t.xmdi007, 
   xmdi013 LIKE xmdi_t.xmdi013, 
   xmdi008 LIKE xmdi_t.xmdi008, 
   xmdi008_desc LIKE type_t.chr500, 
   xmdi009 LIKE xmdi_t.xmdi009, 
   xmdi010 LIKE xmdi_t.xmdi010, 
   xmdi010_desc LIKE type_t.chr500, 
   xmdi011 LIKE xmdi_t.xmdi011, 
   xmdi012 LIKE xmdi_t.xmdi012
       END RECORD
PRIVATE TYPE type_g_xmdh3_d RECORD
       edit1 LIKE type_t.chr500
       END RECORD
PRIVATE TYPE type_g_xmdh4_d RECORD
       xmdhseq LIKE xmdh_t.xmdhseq, 
   xmdh0011 LIKE type_t.chr20, 
   xmdh0021 LIKE type_t.num10, 
   xmdh0031 LIKE type_t.num10, 
   xmdh0041 LIKE type_t.num10, 
   xmdh0051 LIKE type_t.chr10, 
   xmdh0061 LIKE type_t.chr500, 
   xmdh0061_desc LIKE type_t.chr500, 
   xmdh0061_desc_desc LIKE type_t.chr500, 
   xmdh0071 LIKE type_t.chr500, 
   xmdh0071_desc LIKE type_t.chr500, 
   xmdh0091 LIKE type_t.chr10, 
   xmdh0091_desc LIKE type_t.chr500, 
   xmdh0101 LIKE type_t.chr10, 
   xmdh0151 LIKE type_t.chr10, 
   xmdh0151_desc LIKE type_t.chr500, 
   xmdh0161 LIKE type_t.num20_6, 
   xmdh0201 LIKE type_t.chr10, 
   xmdh0201_desc LIKE type_t.chr500, 
   xmdh0211 LIKE type_t.num20_6, 
   xmdh023 LIKE xmdh_t.xmdh023, 
   xmdh024 LIKE xmdh_t.xmdh024, 
   xmdh024_desc LIKE type_t.chr500, 
   xmdh025 LIKE xmdh_t.xmdh025, 
   xmdh026 LIKE xmdh_t.xmdh026, 
   xmdh027 LIKE xmdh_t.xmdh027, 
   xmdh028 LIKE xmdh_t.xmdh028
       END RECORD
 
 
PRIVATE TYPE type_browser RECORD
         b_statepic     LIKE type_t.chr50,
            b_xmdgdocno LIKE xmdg_t.xmdgdocno,
      b_xmdgdocdt LIKE xmdg_t.xmdgdocdt,
      b_xmdg002 LIKE xmdg_t.xmdg002,
   b_xmdg002_desc LIKE type_t.chr80,
      b_xmdg003 LIKE xmdg_t.xmdg003,
   b_xmdg003_desc LIKE type_t.chr80,
      b_xmdg004 LIKE xmdg_t.xmdg004,
      b_xmdg005 LIKE xmdg_t.xmdg005,
   b_xmdg005_desc LIKE type_t.chr80,
      b_xmdg006 LIKE xmdg_t.xmdg006,
   b_xmdg006_desc LIKE type_t.chr80,
      b_xmdg007 LIKE xmdg_t.xmdg007,
   b_xmdg007_desc LIKE type_t.chr80
       END RECORD
       
#模組變數(Module Variables)
DEFINE g_xmdg_m          type_g_xmdg_m
DEFINE g_xmdg_m_t        type_g_xmdg_m
DEFINE g_xmdg_m_o        type_g_xmdg_m
DEFINE g_xmdg_m_mask_o   type_g_xmdg_m #轉換遮罩前資料
DEFINE g_xmdg_m_mask_n   type_g_xmdg_m #轉換遮罩後資料
 
   DEFINE g_xmdgdocno_t LIKE xmdg_t.xmdgdocno
 
 
DEFINE g_xmdh_d          DYNAMIC ARRAY OF type_g_xmdh_d
DEFINE g_xmdh_d_t        type_g_xmdh_d
DEFINE g_xmdh_d_o        type_g_xmdh_d
DEFINE g_xmdh_d_mask_o   DYNAMIC ARRAY OF type_g_xmdh_d #轉換遮罩前資料
DEFINE g_xmdh_d_mask_n   DYNAMIC ARRAY OF type_g_xmdh_d #轉換遮罩後資料
DEFINE g_xmdh2_d          DYNAMIC ARRAY OF type_g_xmdh2_d
DEFINE g_xmdh2_d_t        type_g_xmdh2_d
DEFINE g_xmdh2_d_o        type_g_xmdh2_d
DEFINE g_xmdh2_d_mask_o   DYNAMIC ARRAY OF type_g_xmdh2_d #轉換遮罩前資料
DEFINE g_xmdh2_d_mask_n   DYNAMIC ARRAY OF type_g_xmdh2_d #轉換遮罩後資料
DEFINE g_xmdh3_d          DYNAMIC ARRAY OF type_g_xmdh3_d
DEFINE g_xmdh3_d_t        type_g_xmdh3_d
DEFINE g_xmdh3_d_o        type_g_xmdh3_d
DEFINE g_xmdh3_d_mask_o   DYNAMIC ARRAY OF type_g_xmdh3_d #轉換遮罩前資料
DEFINE g_xmdh3_d_mask_n   DYNAMIC ARRAY OF type_g_xmdh3_d #轉換遮罩後資料
DEFINE g_xmdh4_d          DYNAMIC ARRAY OF type_g_xmdh4_d
DEFINE g_xmdh4_d_t        type_g_xmdh4_d
DEFINE g_xmdh4_d_o        type_g_xmdh4_d
DEFINE g_xmdh4_d_mask_o   DYNAMIC ARRAY OF type_g_xmdh4_d #轉換遮罩前資料
DEFINE g_xmdh4_d_mask_n   DYNAMIC ARRAY OF type_g_xmdh4_d #轉換遮罩後資料
 
 
DEFINE g_browser         DYNAMIC ARRAY OF type_browser
DEFINE g_browser_f       DYNAMIC ARRAY OF type_browser
 
 
DEFINE g_wc                  STRING
DEFINE g_wc_t                STRING
DEFINE g_wc2                 STRING                          #單身CONSTRUCT結果
DEFINE g_wc2_table1          STRING
DEFINE g_wc2_table2   STRING
 
 
 
DEFINE g_wc2_extend          STRING
DEFINE g_wc_filter           STRING
DEFINE g_wc_filter_t         STRING
 
DEFINE g_sql                 STRING
DEFINE g_forupd_sql          STRING
DEFINE g_cnt                 LIKE type_t.num10
DEFINE g_current_idx         LIKE type_t.num10     
DEFINE g_jump                LIKE type_t.num10        
DEFINE g_no_ask              LIKE type_t.num5        
DEFINE g_rec_b               LIKE type_t.num10           
DEFINE l_ac                  LIKE type_t.num10    
DEFINE g_curr_diag           ui.Dialog                     #Current Dialog
    
DEFINE g_pagestart           LIKE type_t.num10           
DEFINE gwin_curr             ui.Window                     #Current Window
DEFINE gfrm_curr             ui.Form                       #Current Form
DEFINE g_page_action         STRING                        #page action
DEFINE g_header_hidden       LIKE type_t.num5              #隱藏單頭
DEFINE g_worksheet_hidden    LIKE type_t.num5              #隱藏工作Panel
DEFINE g_page                STRING                        #第幾頁
DEFINE g_state               STRING       
DEFINE g_header_cnt          LIKE type_t.num10
DEFINE g_detail_cnt          LIKE type_t.num10              #單身總筆數
DEFINE g_detail_idx          LIKE type_t.num10              #單身目前所在筆數
DEFINE g_detail_idx2         LIKE type_t.num10              #單身2目前所在筆數
DEFINE g_browser_cnt         LIKE type_t.num10              #Browser總筆數
DEFINE g_browser_idx         LIKE type_t.num10              #Browser目前所在筆數
DEFINE g_temp_idx            LIKE type_t.num10              #Browser目前所在筆數(暫存用)
DEFINE g_order               STRING                        #查詢排序欄位
                                                        
DEFINE g_current_row         LIKE type_t.num10              #Browser所在筆數
DEFINE g_current_sw          BOOLEAN                       #Browser所在筆數用開關
DEFINE g_current_page        LIKE type_t.num10              #目前所在頁數
DEFINE g_insert              LIKE type_t.chr5              #是否導到其他page
 
DEFINE g_ref_fields          DYNAMIC ARRAY OF VARCHAR(500) #ap_ref用陣列
DEFINE g_ref_vars            DYNAMIC ARRAY OF VARCHAR(500) #ap_ref用陣列
DEFINE g_rtn_fields          DYNAMIC ARRAY OF VARCHAR(500) #ap_ref用陣列
DEFINE gs_keys               DYNAMIC ARRAY OF VARCHAR(500) #同步資料用陣列
DEFINE gs_keys_bak           DYNAMIC ARRAY OF VARCHAR(500) #同步資料用陣列
DEFINE g_bfill               LIKE type_t.chr5              #是否刷新單身
DEFINE g_error_show          LIKE type_t.num5              #是否顯示筆數提示訊息
DEFINE g_master_insert       BOOLEAN                       #確認單頭資料是否寫入
 
DEFINE g_wc_frozen           STRING                        #凍結欄位使用
DEFINE g_chk                 BOOLEAN                       #助記碼判斷用
DEFINE g_aw                  STRING                        #確定當下點擊的單身
DEFINE g_default             BOOLEAN                       #是否有外部參數查詢
DEFINE g_log1                STRING                        #log用
DEFINE g_log2                STRING                        #log用
DEFINE g_loc                 LIKE type_t.chr5              #判斷游標所在位置
DEFINE g_add_browse          STRING                        #新增填充用WC
DEFINE g_update              BOOLEAN                       #確定單頭/身是否異動過
 
#add-point:自定義模組變數(Module Variable)
{<point name="global.variable" edit="s"/>}
#end add-point
 
#add-point:自定義客戶專用模組變數(Module Variable)
{<point name="global.variable_customerization" edit="c"/>}
#end add-point
 
#add-point:傳入參數說明(global.argv)
{<point name="global.argv"/>}
#end add-point
]]>
  </section>
  <section id="axmt520.idx_chk" ver="5" status="" src="s" readonly="">
    <![CDATA[#+ 顯示正確的單身資料筆數
PRIVATE FUNCTION axmt520_idx_chk()
   #add-point:idx_chk段define
   {<point name="idx_chk.define" edit="s"/>}
   #end add-point  
   #add-point:idx_chk段define(客製用)
   {<point name="idx_chk.define_customerization" edit="c"/>}
   #end add-point  
   
   IF g_current_page = 1 THEN
      LET g_detail_idx = g_curr_diag.getCurrentRow("s_detail1")
      IF g_detail_idx > g_xmdh_d.getLength() THEN
         LET g_detail_idx = g_xmdh_d.getLength()
      END IF
      IF g_detail_idx = 0 AND g_xmdh_d.getLength() <> 0 THEN
         LET g_detail_idx = 1
      END IF
      DISPLAY g_detail_idx TO FORMONLY.idx
      DISPLAY g_xmdh_d.getLength() TO FORMONLY.cnt
   END IF
   
   IF g_current_page = 2 THEN
      LET g_detail_idx = g_curr_diag.getCurrentRow("s_detail2")
      IF g_detail_idx > g_xmdh2_d.getLength() THEN
         LET g_detail_idx = g_xmdh2_d.getLength()
      END IF
      IF g_detail_idx = 0 AND g_xmdh2_d.getLength() <> 0 THEN
         LET g_detail_idx = 1
      END IF
      DISPLAY g_detail_idx TO FORMONLY.idx
      DISPLAY g_xmdh2_d.getLength() TO FORMONLY.cnt
   END IF
   IF g_current_page = 3 THEN
      LET g_detail_idx = g_curr_diag.getCurrentRow("s_detail3")
      IF g_detail_idx > g_xmdh3_d.getLength() THEN
         LET g_detail_idx = g_xmdh3_d.getLength()
      END IF
      IF g_detail_idx = 0 AND g_xmdh3_d.getLength() <> 0 THEN
         LET g_detail_idx = 1
      END IF
      DISPLAY g_detail_idx TO FORMONLY.idx
      DISPLAY g_xmdh3_d.getLength() TO FORMONLY.cnt
   END IF
   IF g_current_page = 4 THEN
      LET g_detail_idx = g_curr_diag.getCurrentRow("s_detail4")
      IF g_detail_idx > g_xmdh4_d.getLength() THEN
         LET g_detail_idx = g_xmdh4_d.getLength()
      END IF
      IF g_detail_idx = 0 AND g_xmdh4_d.getLength() <> 0 THEN
         LET g_detail_idx = 1
      END IF
      DISPLAY g_detail_idx TO FORMONLY.idx
      DISPLAY g_xmdh4_d.getLength() TO FORMONLY.cnt
   END IF
 
   
   #add-point:idx_chk段other
   {<point name="idx_chk.other"/>}
   #end add-point  
   
END FUNCTION
]]>
  </section>
  <section id="axmt520.init" ver="13" status="" src="s" readonly="">
    <![CDATA[#+ 瀏覽頁簽資料初始化
PRIVATE FUNCTION axmt520_init()
   #add-point:init段define
   {<point name="init.define" edit="s"/>}
   #end add-point    
   #add-point:init段define(客製用)
   {<point name="init.define_customerization" edit="c"/>}
   #end add-point    
 
   LET g_bfill       = "Y"
   LET g_detail_idx  = 1 #第一層單身指標
   LET g_detail_idx2 = 1 #第二層單身指標
   LET g_error_show  = 1
   LET l_ac = 1 #單身指標
      CALL cl_set_combo_scc_part('xmdgstus','13','N,Y,A,D,R,W,H,UH,X')
 
      CALL cl_set_combo_scc('xmdg001','2063') 
   CALL cl_set_combo_scc('xmdg034','2064') 
   CALL cl_set_combo_scc('xmdg032','2085') 
   CALL cl_set_combo_scc('xmdg033','2084') 
   CALL cl_set_combo_scc('xmdh005','2055') 
 
   LET gwin_curr = ui.Window.getCurrent()  #取得現行畫面
   LET gfrm_curr = gwin_curr.getForm()     #取出物件化後的畫面物件
 
   #add-point:畫面資料初始化
   {<point name="init.init"/>}
   #end add-point
   
   #初始化搜尋條件
   CALL axmt520_default_search()
    
END FUNCTION
]]>
  </section>
  <section id="axmt520.input" ver="34" status="" src="s" readonly="">
    <![CDATA[#+ 資料輸入
PRIVATE FUNCTION axmt520_input(p_cmd)
   DEFINE  p_cmd                 LIKE type_t.chr1
   DEFINE  l_cmd_t               LIKE type_t.chr1
   DEFINE  l_cmd                 LIKE type_t.chr1
   DEFINE  l_n                   LIKE type_t.num10                #檢查重複用  
   DEFINE  l_cnt                 LIKE type_t.num10                #檢查重複用  
   DEFINE  l_lock_sw             LIKE type_t.chr1                #單身鎖住否  
   DEFINE  l_allow_insert        LIKE type_t.num5                #可新增否 
   DEFINE  l_allow_delete        LIKE type_t.num5                #可刪除否  
   DEFINE  l_count               LIKE type_t.num10
   DEFINE  l_i                   LIKE type_t.num10
   DEFINE  l_insert              BOOLEAN
   DEFINE  ls_return             STRING
   DEFINE  l_var_keys            DYNAMIC ARRAY OF STRING
   DEFINE  l_field_keys          DYNAMIC ARRAY OF STRING
   DEFINE  l_vars                DYNAMIC ARRAY OF STRING
   DEFINE  l_fields              DYNAMIC ARRAY OF STRING
   DEFINE  l_var_keys_bak        DYNAMIC ARRAY OF STRING
   DEFINE  lb_reproduce          BOOLEAN
   DEFINE  li_reproduce          LIKE type_t.num10
   DEFINE  li_reproduce_target   LIKE type_t.num10
   DEFINE  ls_keys               DYNAMIC ARRAY OF VARCHAR(500)
   #add-point:input段define
   {<point name="input.define" edit="s"/>}
   #end add-point  
   #add-point:input段define(客製用)
   {<point name="input.define_customerization" edit="c"/>}
   #end add-point  
   
   #先做狀態判定
   IF p_cmd = 'r' THEN
      LET l_cmd_t = 'r'
      LET p_cmd   = 'a'
   ELSE
      LET l_cmd_t = p_cmd
   END IF   
   
   #將資料輸出到畫面上
   DISPLAY BY NAME g_xmdg_m.xmdgdocno,g_xmdg_m.xmdgdocno_desc,g_xmdg_m.xmdgdocdt,g_xmdg_m.xmdg004,g_xmdg_m.xmdgsite, 
       g_xmdg_m.xmdg002,g_xmdg_m.xmdg002_desc,g_xmdg_m.xmdg003,g_xmdg_m.xmdg003_desc,g_xmdg_m.xmdgstus, 
       g_xmdg_m.xmdg001,g_xmdg_m.xmdg034,g_xmdg_m.xmdg005,g_xmdg_m.xmdg005_desc,g_xmdg_m.xmdg006,g_xmdg_m.xmdg006_desc, 
       g_xmdg_m.xmdg007,g_xmdg_m.xmdg007_desc,g_xmdg_m.xmdg202,g_xmdg_m.xmdg202_desc,g_xmdg_m.xmdg028, 
       g_xmdg_m.xmdg026,g_xmdg_m.xmdg026_desc,g_xmdg_m.xmdg027,g_xmdg_m.xmdg027_desc,g_xmdg_m.xmdg024, 
       g_xmdg_m.xmdg025,g_xmdg_m.xmdg030,g_xmdg_m.xmdg030_desc,g_xmdg_m.xmdg031,g_xmdg_m.xmdg031_desc, 
       g_xmdg_m.xmdg053,g_xmdg_m.xmdg056,g_xmdg_m.xmdg056_desc,g_xmdg_m.xmdg055,g_xmdg_m.xmdg054,g_xmdg_m.xmdg017, 
       g_xmdg_m.xmdg017_desc,g_xmdg_m.textedit1,g_xmdg_m.xmdg018,g_xmdg_m.xmdg018_desc,g_xmdg_m.xmdg019, 
       g_xmdg_m.xmdg019_desc,g_xmdg_m.xmdg020,g_xmdg_m.xmdg020_desc,g_xmdg_m.xmdg016,g_xmdg_m.xmdg016_desc, 
       g_xmdg_m.xmdg021,g_xmdg_m.xmdg022,g_xmdg_m.xmdg023,g_xmdg_m.xmdg023_desc,g_xmdg_m.xmdg008,g_xmdg_m.xmdg008_desc, 
       g_xmdg_m.xmdg009,g_xmdg_m.xmdg009_desc,g_xmdg_m.xmdg010,g_xmdg_m.xmdg010_desc,g_xmdg_m.xmdg011, 
       g_xmdg_m.xmdg012,g_xmdg_m.xmdg013,g_xmdg_m.xmdg013_desc,g_xmdg_m.xmdg032,g_xmdg_m.xmdg033,g_xmdg_m.xmdg014, 
       g_xmdg_m.xmdg014_desc,g_xmdg_m.xmdg015,g_xmdg_m.xmdgownid,g_xmdg_m.xmdgownid_desc,g_xmdg_m.xmdgowndp, 
       g_xmdg_m.xmdgowndp_desc,g_xmdg_m.xmdgcrtid,g_xmdg_m.xmdgcrtid_desc,g_xmdg_m.xmdgcrtdp,g_xmdg_m.xmdgcrtdp_desc, 
       g_xmdg_m.xmdgcrtdt,g_xmdg_m.xmdgmodid,g_xmdg_m.xmdgmodid_desc,g_xmdg_m.xmdgmoddt,g_xmdg_m.xmdgcnfid, 
       g_xmdg_m.xmdgcnfid_desc,g_xmdg_m.xmdgcnfdt
   
   #切換畫面
   IF g_main_hidden THEN
      CALL gfrm_curr.setElementHidden("mainlayout",0)
      CALL gfrm_curr.setElementHidden("worksheet",1)
      LET g_main_hidden = 0
   END IF
 
   CALL cl_set_head_visible("","YES")  
 
   LET l_insert = FALSE
   LET g_action_choice = ""
 
   #add-point:input段define_sql
   {<point name="input.define_sql" mark="Y"/>}
   #end add-point 
   LET g_forupd_sql = "SELECT xmdhsite,xmdhseq,xmdh001,xmdh002,xmdh003,xmdh004,xmdh005,xmdh006,xmdh007, 
       xmdh034,xmdh009,xmdh010,xmdh015,xmdh016,xmdh017,xmdh018,xmdh019,xmdh008,xmdh011,xmdh012,xmdh013, 
       xmdh014,xmdh029,xmdh020,xmdh021,xmdh022,xmdh036,xmdh031,xmdh032,xmdh033,xmdh050,xmdh056,xmdh030, 
       xmdh051,xmdh052,xmdhunit,xmdh035,xmdhseq,xmdh023,xmdh024,xmdh025,xmdh026,xmdh027,xmdh028 FROM  
       xmdh_t WHERE xmdhent=? AND xmdhdocno=? AND xmdhseq=? FOR UPDATE"
   #add-point:input段define_sql
   {<point name="input.after_define_sql"/>}
   #end add-point 
   LET g_forupd_sql = cl_sql_forupd(g_forupd_sql)
   LET g_forupd_sql = cl_sql_add_mask(g_forupd_sql)              #遮蔽特定資料
   DECLARE axmt520_bcl CURSOR FROM g_forupd_sql
   
   #add-point:input段define_sql
   {<point name="input.define_sql2" mark="Y"/>}
   #end add-point    
   LET g_forupd_sql = "SELECT xmdisite,xmdiseq,xmdiseq1,xmdi001,xmdi002,xmdi003,xmdi004,xmdi005,xmdi006, 
       xmdi007,xmdi013,xmdi008,xmdi009,xmdi010,xmdi011,xmdi012 FROM xmdi_t WHERE xmdient=? AND xmdidocno=?  
       AND xmdiseq=? AND xmdiseq1=? FOR UPDATE"
   #add-point:input段define_sql
   {<point name="input.after_define_sql2"/>}
   #end add-point
   LET g_forupd_sql = cl_sql_forupd(g_forupd_sql)
   LET g_forupd_sql = cl_sql_add_mask(g_forupd_sql)              #遮蔽特定資料
   DECLARE axmt520_bcl2 CURSOR FROM g_forupd_sql
 
 
   
 
 
   #add-point:input段define_sql
   {<point name="input.other_sql"/>}
   #end add-point 
 
   LET l_allow_insert = cl_auth_detail_input("insert")
   LET l_allow_delete = cl_auth_detail_input("delete")
   LET g_qryparam.state = 'i'
   
   #控制key欄位可否輸入
   CALL axmt520_set_entry(p_cmd)
   #add-point:set_entry後
   {<point name="input.after_set_entry"/>}
   #end add-point
   CALL axmt520_set_no_entry(p_cmd)
 
   DISPLAY BY NAME g_xmdg_m.xmdgdocno,g_xmdg_m.xmdgdocdt,g_xmdg_m.xmdg004,g_xmdg_m.xmdgsite,g_xmdg_m.xmdg002, 
       g_xmdg_m.xmdg003,g_xmdg_m.xmdgstus,g_xmdg_m.xmdg001,g_xmdg_m.xmdg034,g_xmdg_m.xmdg005,g_xmdg_m.xmdg006, 
       g_xmdg_m.xmdg007,g_xmdg_m.xmdg202,g_xmdg_m.xmdg028,g_xmdg_m.xmdg026,g_xmdg_m.xmdg027,g_xmdg_m.xmdg024, 
       g_xmdg_m.xmdg025,g_xmdg_m.xmdg030,g_xmdg_m.xmdg031,g_xmdg_m.xmdg053,g_xmdg_m.xmdg056,g_xmdg_m.xmdg017, 
       g_xmdg_m.xmdg018,g_xmdg_m.xmdg019,g_xmdg_m.xmdg020,g_xmdg_m.xmdg016,g_xmdg_m.xmdg021,g_xmdg_m.xmdg022, 
       g_xmdg_m.xmdg023,g_xmdg_m.xmdg008,g_xmdg_m.xmdg009,g_xmdg_m.xmdg010,g_xmdg_m.xmdg011,g_xmdg_m.xmdg012, 
       g_xmdg_m.xmdg013,g_xmdg_m.xmdg032,g_xmdg_m.xmdg033,g_xmdg_m.xmdg014,g_xmdg_m.xmdg015
   
   LET lb_reproduce = FALSE
   
   #關閉被遮罩相關欄位輸入, 無法確定USER是否會需要輸入此欄位
   #因此先行關閉, 若有需要可於下方add-point中自行開啟
   CALL cl_mask_set_no_entry()
   
   #add-point:資料輸入前
   {<point name="input.before_input"/>}
   #end add-point
   
   DIALOG ATTRIBUTES(UNBUFFERED,FIELD ORDER FORM)
]]>
  </section>
  <section id="axmt520.input.body" ver="74" status="" src="s" readonly="">
    <![CDATA[   
      #Page1 預設值產生於此處
      INPUT ARRAY g_xmdh_d FROM s_detail1.*
          ATTRIBUTE(COUNT = g_rec_b,WITHOUT DEFAULTS, #MAXCOUNT = g_max_rec,
                  INSERT ROW = l_allow_insert, 
                  DELETE ROW = l_allow_delete,
                  APPEND ROW = l_allow_insert)
 
         #自訂ACTION(detail_input,page_1)
         
         
         BEFORE INPUT
            #add-point:資料輸入前
            {<point name="input.body.before_input2"/>}
            #end add-point
            IF g_insert = 'Y' AND NOT cl_null(g_insert) THEN 
              CALL FGL_SET_ARR_CURR(g_xmdh_d.getLength()+1) 
              LET g_insert = 'N' 
           END IF 
 
            CALL axmt520_b_fill()
            #如果一直都在單身1則控制筆數位置
            IF g_loc = 'm' AND g_rec_b != 0 THEN
               CALL FGL_SET_ARR_CURR(g_detail_idx)
            END IF
            LET g_loc = 'm'
            LET g_rec_b = g_xmdh_d.getLength()
            #add-point:資料輸入前
            {<point name="input.d.before_input"/>}
            #end add-point
         
         BEFORE ROW
            #add-point:modify段before row2
            {<point name="input.body.before_row2"/>}
            #end add-point  
            LET l_insert = FALSE
            LET l_cmd = ''
            LET l_ac = ARR_CURR()
            LET g_detail_idx = l_ac
            LET g_current_page = 1
            
            LET l_lock_sw = 'N'            #DEFAULT
            LET l_n = ARR_COUNT()
            DISPLAY l_ac TO FORMONLY.idx
         
            CALL s_transaction_begin()
            OPEN axmt520_cl USING g_enterprise,g_xmdg_m.xmdgdocno
            IF STATUS THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = "OPEN axmt520_cl:" 
               LET g_errparam.code   = STATUS 
               LET g_errparam.popup  = TRUE 
               CALL cl_err()
               CLOSE axmt520_cl
               CALL s_transaction_end('N','0')
               RETURN
            END IF
            
            LET g_rec_b = g_xmdh_d.getLength()
            
            IF g_rec_b >= l_ac 
               AND g_xmdh_d[l_ac].xmdhseq IS NOT NULL
 
            THEN
               LET l_cmd='u'
               LET g_xmdh_d_t.* = g_xmdh_d[l_ac].*  #BACKUP
               LET g_xmdh_d_o.* = g_xmdh_d[l_ac].*  #BACKUP
               CALL axmt520_set_entry_b(l_cmd)
               #add-point:modify段after_set_entry_b
               {<point name="input.body.after_set_entry_b"/>}
               #end add-point  
               CALL axmt520_set_no_entry_b(l_cmd)
               IF NOT axmt520_lock_b("xmdh_t","'1'") THEN
                  LET l_lock_sw='Y'
               ELSE
                  FETCH axmt520_bcl INTO g_xmdh_d[l_ac].xmdhsite,g_xmdh_d[l_ac].xmdhseq,g_xmdh_d[l_ac].xmdh001, 
                      g_xmdh_d[l_ac].xmdh002,g_xmdh_d[l_ac].xmdh003,g_xmdh_d[l_ac].xmdh004,g_xmdh_d[l_ac].xmdh005, 
                      g_xmdh_d[l_ac].xmdh006,g_xmdh_d[l_ac].xmdh007,g_xmdh_d[l_ac].xmdh034,g_xmdh_d[l_ac].xmdh009, 
                      g_xmdh_d[l_ac].xmdh010,g_xmdh_d[l_ac].xmdh015,g_xmdh_d[l_ac].xmdh016,g_xmdh_d[l_ac].xmdh017, 
                      g_xmdh_d[l_ac].xmdh018,g_xmdh_d[l_ac].xmdh019,g_xmdh_d[l_ac].xmdh008,g_xmdh_d[l_ac].xmdh011, 
                      g_xmdh_d[l_ac].xmdh012,g_xmdh_d[l_ac].xmdh013,g_xmdh_d[l_ac].xmdh014,g_xmdh_d[l_ac].xmdh029, 
                      g_xmdh_d[l_ac].xmdh020,g_xmdh_d[l_ac].xmdh021,g_xmdh_d[l_ac].xmdh022,g_xmdh_d[l_ac].xmdh036, 
                      g_xmdh_d[l_ac].xmdh031,g_xmdh_d[l_ac].xmdh032,g_xmdh_d[l_ac].xmdh033,g_xmdh_d[l_ac].xmdh050, 
                      g_xmdh_d[l_ac].xmdh056,g_xmdh_d[l_ac].xmdh030,g_xmdh_d[l_ac].xmdh051,g_xmdh_d[l_ac].xmdh052, 
                      g_xmdh_d[l_ac].xmdhunit,g_xmdh_d[l_ac].xmdh035,g_xmdh4_d[l_ac].xmdhseq,g_xmdh4_d[l_ac].xmdh023, 
                      g_xmdh4_d[l_ac].xmdh024,g_xmdh4_d[l_ac].xmdh025,g_xmdh4_d[l_ac].xmdh026,g_xmdh4_d[l_ac].xmdh027, 
                      g_xmdh4_d[l_ac].xmdh028
                  IF SQLCA.sqlcode THEN
                     INITIALIZE g_errparam TO NULL 
                     LET g_errparam.extend = g_xmdh_d_t.xmdhseq 
                     LET g_errparam.code   = SQLCA.sqlcode 
                     LET g_errparam.popup  = TRUE 
                     CALL cl_err()
                     LET l_lock_sw = "Y"
                  END IF
                  
                  #遮罩相關處理
                  LET g_xmdh_d_mask_o[l_ac].* =  g_xmdh_d[l_ac].*
                  CALL axmt520_xmdh_t_mask()
                  LET g_xmdh_d_mask_n[l_ac].* =  g_xmdh_d[l_ac].*
                  
                  LET g_bfill = "N"
                  CALL axmt520_show()
                  LET g_bfill = "Y"
                  
                  CALL cl_show_fld_cont()
               END IF
            ELSE
               LET l_cmd='a'
            END IF
            #add-point:modify段before row
            {<point name="input.body.before_row"/>}
            #end add-point  
            #其他table資料備份(確定是否更改用)
            
            #其他table進行lock
            
        
         BEFORE INSERT
            
            LET l_insert = TRUE
            LET l_n = ARR_COUNT()
            LET l_cmd = 'a'
            INITIALIZE g_xmdh_d[l_ac].* TO NULL 
            INITIALIZE g_xmdh_d_t.* TO NULL 
            INITIALIZE g_xmdh_d_o.* TO NULL 
            #公用欄位給值(單身)
            
            #自定義預設值
                  LET g_xmdh_d[l_ac].xmdh005 = "1"
      LET g_xmdh_d[l_ac].xmdh011 = "N"
      LET g_xmdh_d[l_ac].xmdh022 = "Y"
      LET g_xmdh_d[l_ac].xmdh036 = "N"
      LET g_xmdh_d[l_ac].xmdh056 = "0"
      LET g_xmdh_d[l_ac].xmdh030 = "0"
 
            #add-point:modify段before備份
            {<point name="input.body.insert.before_bak"/>}
            #end add-point
            LET g_xmdh_d_t.* = g_xmdh_d[l_ac].*     #新輸入資料
            LET g_xmdh_d_o.* = g_xmdh_d[l_ac].*     #新輸入資料
            CALL cl_show_fld_cont()
            CALL axmt520_set_entry_b(l_cmd)
            #add-point:modify段after_set_entry_b
            {<point name="input.body.insert.after_set_entry_b"/>}
            #end add-point
            CALL axmt520_set_no_entry_b(l_cmd)
            IF lb_reproduce THEN
               LET lb_reproduce = FALSE
               LET g_xmdh_d[li_reproduce_target].* = g_xmdh_d[li_reproduce].*
               LET g_xmdh3_d[li_reproduce_target].* = g_xmdh3_d[li_reproduce].*
               LET g_xmdh4_d[li_reproduce_target].* = g_xmdh4_d[li_reproduce].*
 
               LET g_xmdh_d[li_reproduce_target].xmdhseq = NULL
 
            END IF
            
            #add-point:modify段before insert
            {<point name="input.body.before_insert"/>}
            #end add-point  
  
         AFTER INSERT
            LET l_insert = FALSE
            IF INT_FLAG THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = '' 
               LET g_errparam.code   = 9001 
               LET g_errparam.popup  = FALSE 
               CALL cl_err()
               LET INT_FLAG = 0
               CANCEL INSERT
            END IF
               
            #add-point:單身新增
            {<point name="input.body.b_a_insert"/>}
            #end add-point
               
            LET l_count = 1  
            SELECT COUNT(*) INTO l_count FROM xmdh_t 
             WHERE xmdhent = g_enterprise AND xmdhdocno = g_xmdg_m.xmdgdocno
 
               AND xmdhseq = g_xmdh_d[l_ac].xmdhseq
 
                
            #資料未重複, 插入新增資料
            IF l_count = 0 THEN 
               #add-point:單身新增前
               {<point name="input.body.b_insert"/>}
               #end add-point
            
               #同步新增到同層的table
                              INITIALIZE gs_keys TO NULL 
               LET gs_keys[1] = g_xmdg_m.xmdgdocno
               LET gs_keys[2] = g_xmdh_d[g_detail_idx].xmdhseq
               CALL axmt520_insert_b('xmdh_t',gs_keys,"'1'")
                           
               #add-point:單身新增後
               {<point name="input.body.a_insert"/>}
               #end add-point
            ELSE    
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = 'INSERT' 
               LET g_errparam.code   = "std-00006" 
               LET g_errparam.popup  = TRUE 
               CALL cl_err()
               INITIALIZE g_xmdh_d[l_ac].* TO NULL
               CALL s_transaction_end('N','0')
               CANCEL INSERT
            END IF
 
            IF SQLCA.SQLcode  THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = "xmdh_t" 
               LET g_errparam.code   = SQLCA.sqlcode 
               LET g_errparam.popup  = TRUE 
               CALL cl_err()
               CALL s_transaction_end('N','0')                    
               CANCEL INSERT
            ELSE
               #先刷新資料
               #CALL axmt520_b_fill()
               #資料多語言用-增/改
               
               #add-point:input段-after_insert
               {<point name="input.body.a_insert2"/>}
               #end add-point
               CALL s_transaction_end('Y','0')
               #ERROR 'INSERT O.K'
               LET g_rec_b = g_rec_b + 1
            END IF
              
         BEFORE DELETE                            #是否取消單身
            IF l_cmd = 'a' THEN
               LET l_cmd='d'
               #add-point:單身刪除後(=d)
               {<point name="input.body.after_delete_d"/>}
               #end add-point
            ELSE
               IF NOT cl_ask_del_detail() THEN
                  CANCEL DELETE
               END IF
               IF l_lock_sw = "Y" THEN
                  INITIALIZE g_errparam TO NULL 
                  LET g_errparam.extend = "" 
                  LET g_errparam.code   = -263 
                  LET g_errparam.popup  = TRUE 
                  CALL cl_err()
                  CANCEL DELETE
               END IF
               
               #add-point:單身刪除前
               {<point name="input.body.b_delete" mark="Y"/>}
               #end add-point 
               
               #取得該筆資料key值
               INITIALIZE gs_keys TO NULL
               LET gs_keys[01] = g_xmdg_m.xmdgdocno
 
               LET gs_keys[gs_keys.getLength()+1] = g_xmdh_d_t.xmdhseq
 
            
               #刪除同層單身
               IF NOT axmt520_delete_b('xmdh_t',gs_keys,"'1'") THEN
                  CALL s_transaction_end('N','0')
                  CLOSE axmt520_bcl
                  CANCEL DELETE
               END IF
    
               #刪除下層單身
               IF NOT axmt520_key_delete_b(gs_keys,'xmdh_t') THEN
                  CALL s_transaction_end('N','0')
                  CLOSE axmt520_bcl
                  CANCEL DELETE
               END IF
               
               #刪除多語言
               
               
               #add-point:單身刪除中
               {<point name="input.body.m_delete"/>}
               #end add-point 
               
               CALL s_transaction_end('Y','0')
               CLOSE axmt520_bcl
            
               LET g_rec_b = g_rec_b-1
               #add-point:單身刪除後
               {<point name="input.body.a_delete"/>}
               #end add-point
               LET l_count = g_xmdh_d.getLength()
               
               #add-point:單身刪除後(<>d)
               {<point name="input.body.after_delete"/>}
               #end add-point
            END IF
 
         AFTER DELETE
            #如果是最後一筆
            IF l_ac = (g_xmdh_d.getLength() + 1) THEN
               CALL FGL_SET_ARR_CURR(l_ac-1)
            END IF
 
                  #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdhsite
            #add-point:BEFORE FIELD xmdhsite
            {<point name="input.b.page1.xmdhsite" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdhsite
            
            #add-point:AFTER FIELD xmdhsite
            {<point name="input.a.page1.xmdhsite" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xmdhsite
            #add-point:ON CHANGE xmdhsite
            {<point name="input.g.page1.xmdhsite" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdhseq
            #add-point:BEFORE FIELD xmdhseq
            {<point name="input.b.page1.xmdhseq" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdhseq
            
            #add-point:AFTER FIELD xmdhseq
            {<point name="input.a.page1.xmdhseq" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xmdhseq
            #add-point:ON CHANGE xmdhseq
            {<point name="input.g.page1.xmdhseq" />}
            #END add-point 
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdh001
            
            #add-point:AFTER FIELD xmdh001
            {<point name="input.a.page1.xmdh001" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdh001
            #add-point:BEFORE FIELD xmdh001
            {<point name="input.b.page1.xmdh001" />}
            #END add-point
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xmdh001
            #add-point:ON CHANGE xmdh001
            {<point name="input.g.page1.xmdh001" />}
            #END add-point 
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdh002
            #應用 a15 樣板自動產生(Version:2)
            #確認欄位值在特定區間內
            IF NOT cl_ap_chk_range(g_xmdh_d[l_ac].xmdh002,"0.000","0","","","azz-00079",1) THEN
               NEXT FIELD xmdh002
            END IF 
 
 
            #add-point:AFTER FIELD xmdh002
            {<point name="input.a.page1.xmdh002" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdh002
            #add-point:BEFORE FIELD xmdh002
            {<point name="input.b.page1.xmdh002" />}
            #END add-point
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xmdh002
            #add-point:ON CHANGE xmdh002
            {<point name="input.g.page1.xmdh002" />}
            #END add-point 
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdh003
            #應用 a15 樣板自動產生(Version:2)
            #確認欄位值在特定區間內
            IF NOT cl_ap_chk_range(g_xmdh_d[l_ac].xmdh003,"0.000","0","","","azz-00079",1) THEN
               NEXT FIELD xmdh003
            END IF 
 
 
            #add-point:AFTER FIELD xmdh003
            {<point name="input.a.page1.xmdh003" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdh003
            #add-point:BEFORE FIELD xmdh003
            {<point name="input.b.page1.xmdh003" />}
            #END add-point
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xmdh003
            #add-point:ON CHANGE xmdh003
            {<point name="input.g.page1.xmdh003" />}
            #END add-point 
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdh004
            #應用 a15 樣板自動產生(Version:2)
            #確認欄位值在特定區間內
            IF NOT cl_ap_chk_range(g_xmdh_d[l_ac].xmdh004,"0.000","0","","","azz-00079",1) THEN
               NEXT FIELD xmdh004
            END IF 
 
 
            #add-point:AFTER FIELD xmdh004
            {<point name="input.a.page1.xmdh004" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdh004
            #add-point:BEFORE FIELD xmdh004
            {<point name="input.b.page1.xmdh004" />}
            #END add-point
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xmdh004
            #add-point:ON CHANGE xmdh004
            {<point name="input.g.page1.xmdh004" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdh005
            #add-point:BEFORE FIELD xmdh005
            {<point name="input.b.page1.xmdh005" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdh005
            
            #add-point:AFTER FIELD xmdh005
            {<point name="input.a.page1.xmdh005" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xmdh005
            #add-point:ON CHANGE xmdh005
            {<point name="input.g.page1.xmdh005" />}
            #END add-point 
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdh006
            
            #add-point:AFTER FIELD xmdh006
            {<point name="input.a.page1.xmdh006" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdh006
            #add-point:BEFORE FIELD xmdh006
            {<point name="input.b.page1.xmdh006" />}
            #END add-point
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xmdh006
            #add-point:ON CHANGE xmdh006
            {<point name="input.g.page1.xmdh006" />}
            #END add-point 
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdh007
            
            #add-point:AFTER FIELD xmdh007
            {<point name="input.a.page1.xmdh007" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdh007
            #add-point:BEFORE FIELD xmdh007
            {<point name="input.b.page1.xmdh007" />}
            #END add-point
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xmdh007
            #add-point:ON CHANGE xmdh007
            {<point name="input.g.page1.xmdh007" />}
            #END add-point 
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdh034
            
            #add-point:AFTER FIELD xmdh034
            {<point name="input.a.page1.xmdh034" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdh034
            #add-point:BEFORE FIELD xmdh034
            {<point name="input.b.page1.xmdh034" />}
            #END add-point
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xmdh034
            #add-point:ON CHANGE xmdh034
            {<point name="input.g.page1.xmdh034" />}
            #END add-point 
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdh009
            
            #add-point:AFTER FIELD xmdh009
            {<point name="input.a.page1.xmdh009" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdh009
            #add-point:BEFORE FIELD xmdh009
            {<point name="input.b.page1.xmdh009" />}
            #END add-point
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xmdh009
            #add-point:ON CHANGE xmdh009
            {<point name="input.g.page1.xmdh009" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdh010
            #add-point:BEFORE FIELD xmdh010
            {<point name="input.b.page1.xmdh010" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdh010
            
            #add-point:AFTER FIELD xmdh010
            {<point name="input.a.page1.xmdh010" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xmdh010
            #add-point:ON CHANGE xmdh010
            {<point name="input.g.page1.xmdh010" />}
            #END add-point 
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdh015
            
            #add-point:AFTER FIELD xmdh015
            {<point name="input.a.page1.xmdh015" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdh015
            #add-point:BEFORE FIELD xmdh015
            {<point name="input.b.page1.xmdh015" />}
            #END add-point
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xmdh015
            #add-point:ON CHANGE xmdh015
            {<point name="input.g.page1.xmdh015" />}
            #END add-point 
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdh016
            #應用 a15 樣板自動產生(Version:2)
            #確認欄位值在特定區間內
            IF NOT cl_ap_chk_range(g_xmdh_d[l_ac].xmdh016,"0.000","0","","","azz-00079",1) THEN
               NEXT FIELD xmdh016
            END IF 
 
 
            #add-point:AFTER FIELD xmdh016
            {<point name="input.a.page1.xmdh016" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdh016
            #add-point:BEFORE FIELD xmdh016
            {<point name="input.b.page1.xmdh016" />}
            #END add-point
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xmdh016
            #add-point:ON CHANGE xmdh016
            {<point name="input.g.page1.xmdh016" />}
            #END add-point 
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdh017
            #應用 a15 樣板自動產生(Version:2)
            #確認欄位值在特定區間內
            IF NOT cl_ap_chk_range(g_xmdh_d[l_ac].xmdh017,"0.000","0","","","azz-00079",1) THEN
               NEXT FIELD xmdh017
            END IF 
 
 
            #add-point:AFTER FIELD xmdh017
            {<point name="input.a.page1.xmdh017" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdh017
            #add-point:BEFORE FIELD xmdh017
            {<point name="input.b.page1.xmdh017" />}
            #END add-point
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xmdh017
            #add-point:ON CHANGE xmdh017
            {<point name="input.g.page1.xmdh017" />}
            #END add-point 
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdh018
            
            #add-point:AFTER FIELD xmdh018
            {<point name="input.a.page1.xmdh018" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdh018
            #add-point:BEFORE FIELD xmdh018
            {<point name="input.b.page1.xmdh018" />}
            #END add-point
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xmdh018
            #add-point:ON CHANGE xmdh018
            {<point name="input.g.page1.xmdh018" />}
            #END add-point 
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdh019
            #應用 a15 樣板自動產生(Version:2)
            #確認欄位值在特定區間內
            IF NOT cl_ap_chk_range(g_xmdh_d[l_ac].xmdh019,"0.000","0","","","azz-00079",1) THEN
               NEXT FIELD xmdh019
            END IF 
 
 
            #add-point:AFTER FIELD xmdh019
            {<point name="input.a.page1.xmdh019" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdh019
            #add-point:BEFORE FIELD xmdh019
            {<point name="input.b.page1.xmdh019" />}
            #END add-point
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xmdh019
            #add-point:ON CHANGE xmdh019
            {<point name="input.g.page1.xmdh019" />}
            #END add-point 
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdh008
            
            #add-point:AFTER FIELD xmdh008
            {<point name="input.a.page1.xmdh008" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdh008
            #add-point:BEFORE FIELD xmdh008
            {<point name="input.b.page1.xmdh008" />}
            #END add-point
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xmdh008
            #add-point:ON CHANGE xmdh008
            {<point name="input.g.page1.xmdh008" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdh011
            #add-point:BEFORE FIELD xmdh011
            {<point name="input.b.page1.xmdh011" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdh011
            
            #add-point:AFTER FIELD xmdh011
            {<point name="input.a.page1.xmdh011" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xmdh011
            #add-point:ON CHANGE xmdh011
            {<point name="input.g.page1.xmdh011" />}
            #END add-point 
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdh012
            
            #add-point:AFTER FIELD xmdh012
            {<point name="input.a.page1.xmdh012" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdh012
            #add-point:BEFORE FIELD xmdh012
            {<point name="input.b.page1.xmdh012" />}
            #END add-point
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xmdh012
            #add-point:ON CHANGE xmdh012
            {<point name="input.g.page1.xmdh012" />}
            #END add-point 
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdh013
            
            #add-point:AFTER FIELD xmdh013
            {<point name="input.a.page1.xmdh013" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdh013
            #add-point:BEFORE FIELD xmdh013
            {<point name="input.b.page1.xmdh013" />}
            #END add-point
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xmdh013
            #add-point:ON CHANGE xmdh013
            {<point name="input.g.page1.xmdh013" />}
            #END add-point 
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdh014
            
            #add-point:AFTER FIELD xmdh014
            {<point name="input.a.page1.xmdh014" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdh014
            #add-point:BEFORE FIELD xmdh014
            {<point name="input.b.page1.xmdh014" />}
            #END add-point
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xmdh014
            #add-point:ON CHANGE xmdh014
            {<point name="input.g.page1.xmdh014" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdh029
            #add-point:BEFORE FIELD xmdh029
            {<point name="input.b.page1.xmdh029" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdh029
            
            #add-point:AFTER FIELD xmdh029
            {<point name="input.a.page1.xmdh029" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xmdh029
            #add-point:ON CHANGE xmdh029
            {<point name="input.g.page1.xmdh029" />}
            #END add-point 
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdh020
            
            #add-point:AFTER FIELD xmdh020
            {<point name="input.a.page1.xmdh020" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdh020
            #add-point:BEFORE FIELD xmdh020
            {<point name="input.b.page1.xmdh020" />}
            #END add-point
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xmdh020
            #add-point:ON CHANGE xmdh020
            {<point name="input.g.page1.xmdh020" />}
            #END add-point 
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdh021
            #應用 a15 樣板自動產生(Version:2)
            #確認欄位值在特定區間內
            IF NOT cl_ap_chk_range(g_xmdh_d[l_ac].xmdh021,"0.000","0","","","azz-00079",1) THEN
               NEXT FIELD xmdh021
            END IF 
 
 
            #add-point:AFTER FIELD xmdh021
            {<point name="input.a.page1.xmdh021" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdh021
            #add-point:BEFORE FIELD xmdh021
            {<point name="input.b.page1.xmdh021" />}
            #END add-point
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xmdh021
            #add-point:ON CHANGE xmdh021
            {<point name="input.g.page1.xmdh021" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdh022
            #add-point:BEFORE FIELD xmdh022
            {<point name="input.b.page1.xmdh022" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdh022
            
            #add-point:AFTER FIELD xmdh022
            {<point name="input.a.page1.xmdh022" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xmdh022
            #add-point:ON CHANGE xmdh022
            {<point name="input.g.page1.xmdh022" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdh036
            #add-point:BEFORE FIELD xmdh036
            {<point name="input.b.page1.xmdh036" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdh036
            
            #add-point:AFTER FIELD xmdh036
            {<point name="input.a.page1.xmdh036" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xmdh036
            #add-point:ON CHANGE xmdh036
            {<point name="input.g.page1.xmdh036" />}
            #END add-point 
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdh031
            
            #add-point:AFTER FIELD xmdh031
            {<point name="input.a.page1.xmdh031" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdh031
            #add-point:BEFORE FIELD xmdh031
            {<point name="input.b.page1.xmdh031" />}
            #END add-point
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xmdh031
            #add-point:ON CHANGE xmdh031
            {<point name="input.g.page1.xmdh031" />}
            #END add-point 
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdh032
            
            #add-point:AFTER FIELD xmdh032
            {<point name="input.a.page1.xmdh032" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdh032
            #add-point:BEFORE FIELD xmdh032
            {<point name="input.b.page1.xmdh032" />}
            #END add-point
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xmdh032
            #add-point:ON CHANGE xmdh032
            {<point name="input.g.page1.xmdh032" />}
            #END add-point 
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdh033
            
            #add-point:AFTER FIELD xmdh033
            {<point name="input.a.page1.xmdh033" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdh033
            #add-point:BEFORE FIELD xmdh033
            {<point name="input.b.page1.xmdh033" />}
            #END add-point
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xmdh033
            #add-point:ON CHANGE xmdh033
            {<point name="input.g.page1.xmdh033" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdh050
            #add-point:BEFORE FIELD xmdh050
            {<point name="input.b.page1.xmdh050" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdh050
            
            #add-point:AFTER FIELD xmdh050
            {<point name="input.a.page1.xmdh050" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xmdh050
            #add-point:ON CHANGE xmdh050
            {<point name="input.g.page1.xmdh050" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdh030
            #add-point:BEFORE FIELD xmdh030
            {<point name="input.b.page1.xmdh030" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdh030
            
            #add-point:AFTER FIELD xmdh030
            {<point name="input.a.page1.xmdh030" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xmdh030
            #add-point:ON CHANGE xmdh030
            {<point name="input.g.page1.xmdh030" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdh051
            #add-point:BEFORE FIELD xmdh051
            {<point name="input.b.page1.xmdh051" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdh051
            
            #add-point:AFTER FIELD xmdh051
            {<point name="input.a.page1.xmdh051" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xmdh051
            #add-point:ON CHANGE xmdh051
            {<point name="input.g.page1.xmdh051" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdh052
            #add-point:BEFORE FIELD xmdh052
            {<point name="input.b.page1.xmdh052" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdh052
            
            #add-point:AFTER FIELD xmdh052
            {<point name="input.a.page1.xmdh052" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xmdh052
            #add-point:ON CHANGE xmdh052
            {<point name="input.g.page1.xmdh052" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdhunit
            #add-point:BEFORE FIELD xmdhunit
            {<point name="input.b.page1.xmdhunit" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdhunit
            
            #add-point:AFTER FIELD xmdhunit
            {<point name="input.a.page1.xmdhunit" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xmdhunit
            #add-point:ON CHANGE xmdhunit
            {<point name="input.g.page1.xmdhunit" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdh035
            #add-point:BEFORE FIELD xmdh035
            {<point name="input.b.page1.xmdh035" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdh035
            
            #add-point:AFTER FIELD xmdh035
            {<point name="input.a.page1.xmdh035" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xmdh035
            #add-point:ON CHANGE xmdh035
            {<point name="input.g.page1.xmdh035" />}
            #END add-point 
 
 
                  #Ctrlp:input.c.page1.xmdhsite
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdhsite
            #add-point:ON ACTION controlp INFIELD xmdhsite
            {<point name="input.c.page1.xmdhsite" />}
            #END add-point
 
         #Ctrlp:input.c.page1.xmdhseq
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdhseq
            #add-point:ON ACTION controlp INFIELD xmdhseq
            {<point name="input.c.page1.xmdhseq" />}
            #END add-point
 
         #Ctrlp:input.c.page1.xmdh001
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdh001
            #add-point:ON ACTION controlp INFIELD xmdh001
            {<point name="input.c.page1.xmdh001" />}
            #END add-point
 
         #Ctrlp:input.c.page1.xmdh002
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdh002
            #add-point:ON ACTION controlp INFIELD xmdh002
            {<point name="input.c.page1.xmdh002" />}
            #END add-point
 
         #Ctrlp:input.c.page1.xmdh003
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdh003
            #add-point:ON ACTION controlp INFIELD xmdh003
            {<point name="input.c.page1.xmdh003" />}
            #END add-point
 
         #Ctrlp:input.c.page1.xmdh004
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdh004
            #add-point:ON ACTION controlp INFIELD xmdh004
            {<point name="input.c.page1.xmdh004" />}
            #END add-point
 
         #Ctrlp:input.c.page1.xmdh005
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdh005
            #add-point:ON ACTION controlp INFIELD xmdh005
            {<point name="input.c.page1.xmdh005" />}
            #END add-point
 
         #Ctrlp:input.c.page1.xmdh006
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdh006
            #add-point:ON ACTION controlp INFIELD xmdh006
            {<point name="input.c.page1.xmdh006" />}
            #END add-point
 
         #Ctrlp:input.c.page1.xmdh007
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdh007
            #add-point:ON ACTION controlp INFIELD xmdh007
            {<point name="input.c.page1.xmdh007" />}
            #END add-point
 
         #Ctrlp:input.c.page1.xmdh034
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdh034
            #add-point:ON ACTION controlp INFIELD xmdh034
            {<point name="input.c.page1.xmdh034" />}
            #END add-point
 
         #Ctrlp:input.c.page1.xmdh009
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdh009
            #add-point:ON ACTION controlp INFIELD xmdh009
            {<point name="input.c.page1.xmdh009" />}
            #END add-point
 
         #Ctrlp:input.c.page1.xmdh010
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdh010
            #add-point:ON ACTION controlp INFIELD xmdh010
            {<point name="input.c.page1.xmdh010" />}
            #END add-point
 
         #Ctrlp:input.c.page1.xmdh015
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdh015
            #add-point:ON ACTION controlp INFIELD xmdh015
            {<point name="input.c.page1.xmdh015" />}
            #END add-point
 
         #Ctrlp:input.c.page1.xmdh016
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdh016
            #add-point:ON ACTION controlp INFIELD xmdh016
            {<point name="input.c.page1.xmdh016" />}
            #END add-point
 
         #Ctrlp:input.c.page1.xmdh017
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdh017
            #add-point:ON ACTION controlp INFIELD xmdh017
            {<point name="input.c.page1.xmdh017" />}
            #END add-point
 
         #Ctrlp:input.c.page1.xmdh018
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdh018
            #add-point:ON ACTION controlp INFIELD xmdh018
            {<point name="input.c.page1.xmdh018" />}
            #END add-point
 
         #Ctrlp:input.c.page1.xmdh019
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdh019
            #add-point:ON ACTION controlp INFIELD xmdh019
            {<point name="input.c.page1.xmdh019" />}
            #END add-point
 
         #Ctrlp:input.c.page1.xmdh008
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdh008
            #add-point:ON ACTION controlp INFIELD xmdh008
            {<point name="input.c.page1.xmdh008" />}
            #END add-point
 
         #Ctrlp:input.c.page1.xmdh011
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdh011
            #add-point:ON ACTION controlp INFIELD xmdh011
            {<point name="input.c.page1.xmdh011" />}
            #END add-point
 
         #Ctrlp:input.c.page1.xmdh012
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdh012
            #add-point:ON ACTION controlp INFIELD xmdh012
            {<point name="input.c.page1.xmdh012" />}
            #END add-point
 
         #Ctrlp:input.c.page1.xmdh013
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdh013
            #add-point:ON ACTION controlp INFIELD xmdh013
            {<point name="input.c.page1.xmdh013" />}
            #END add-point
 
         #Ctrlp:input.c.page1.xmdh014
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdh014
            #add-point:ON ACTION controlp INFIELD xmdh014
            {<point name="input.c.page1.xmdh014" />}
            #END add-point
 
         #Ctrlp:input.c.page1.xmdh029
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdh029
            #add-point:ON ACTION controlp INFIELD xmdh029
            {<point name="input.c.page1.xmdh029" />}
            #END add-point
 
         #Ctrlp:input.c.page1.xmdh020
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdh020
            #add-point:ON ACTION controlp INFIELD xmdh020
            {<point name="input.c.page1.xmdh020" />}
            #END add-point
 
         #Ctrlp:input.c.page1.xmdh021
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdh021
            #add-point:ON ACTION controlp INFIELD xmdh021
            {<point name="input.c.page1.xmdh021" />}
            #END add-point
 
         #Ctrlp:input.c.page1.xmdh022
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdh022
            #add-point:ON ACTION controlp INFIELD xmdh022
            {<point name="input.c.page1.xmdh022" />}
            #END add-point
 
         #Ctrlp:input.c.page1.xmdh036
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdh036
            #add-point:ON ACTION controlp INFIELD xmdh036
            {<point name="input.c.page1.xmdh036" />}
            #END add-point
 
         #Ctrlp:input.c.page1.xmdh031
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdh031
            #add-point:ON ACTION controlp INFIELD xmdh031
            {<point name="input.c.page1.xmdh031" />}
            #END add-point
 
         #Ctrlp:input.c.page1.xmdh032
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdh032
            #add-point:ON ACTION controlp INFIELD xmdh032
            {<point name="input.c.page1.xmdh032" />}
            #END add-point
 
         #Ctrlp:input.c.page1.xmdh033
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdh033
            #add-point:ON ACTION controlp INFIELD xmdh033
            {<point name="input.c.page1.xmdh033" />}
            #END add-point
 
         #Ctrlp:input.c.page1.xmdh050
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdh050
            #add-point:ON ACTION controlp INFIELD xmdh050
            {<point name="input.c.page1.xmdh050" />}
            #END add-point
 
         #Ctrlp:input.c.page1.xmdh030
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdh030
            #add-point:ON ACTION controlp INFIELD xmdh030
            {<point name="input.c.page1.xmdh030" />}
            #END add-point
 
         #Ctrlp:input.c.page1.xmdh051
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdh051
            #add-point:ON ACTION controlp INFIELD xmdh051
            {<point name="input.c.page1.xmdh051" />}
            #END add-point
 
         #Ctrlp:input.c.page1.xmdh052
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdh052
            #add-point:ON ACTION controlp INFIELD xmdh052
            {<point name="input.c.page1.xmdh052" />}
            #END add-point
 
         #Ctrlp:input.c.page1.xmdhunit
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdhunit
            #add-point:ON ACTION controlp INFIELD xmdhunit
            {<point name="input.c.page1.xmdhunit" />}
            #END add-point
 
         #Ctrlp:input.c.page1.xmdh035
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdh035
            #add-point:ON ACTION controlp INFIELD xmdh035
            {<point name="input.c.page1.xmdh035" />}
            #END add-point
 
 
 
         ON ROW CHANGE
            IF INT_FLAG THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = '' 
               LET g_errparam.code   = 9001 
               LET g_errparam.popup  = FALSE 
               CALL cl_err()
               LET INT_FLAG = 0
               LET g_xmdh_d[l_ac].* = g_xmdh_d_t.*
               CLOSE axmt520_bcl
               CALL s_transaction_end('N','0')
               EXIT DIALOG 
            END IF
              
            IF l_lock_sw = 'Y' THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = g_xmdh_d[l_ac].xmdhseq 
               LET g_errparam.code   = -263 
               LET g_errparam.popup  = TRUE 
               CALL cl_err()
               LET g_xmdh_d[l_ac].* = g_xmdh_d_t.*
            ELSE
            
               #add-point:單身修改前
               {<point name="input.body.b_update" mark="Y"/>}
               #end add-point
               
               #寫入修改者/修改日期資訊(單身)
               
      
               #將遮罩欄位還原
               CALL axmt520_xmdh_t_mask_restore('restore_mask_o')
      
               UPDATE xmdh_t SET (xmdhdocno,xmdhsite,xmdhseq,xmdh001,xmdh002,xmdh003,xmdh004,xmdh005, 
                   xmdh006,xmdh007,xmdh034,xmdh009,xmdh010,xmdh015,xmdh016,xmdh017,xmdh018,xmdh019,xmdh008, 
                   xmdh011,xmdh012,xmdh013,xmdh014,xmdh029,xmdh020,xmdh021,xmdh022,xmdh036,xmdh031,xmdh032, 
                   xmdh033,xmdh050,xmdh056,xmdh030,xmdh051,xmdh052,xmdhunit,xmdh035,xmdh023,xmdh024, 
                   xmdh025,xmdh026,xmdh027,xmdh028) = (g_xmdg_m.xmdgdocno,g_xmdh_d[l_ac].xmdhsite,g_xmdh_d[l_ac].xmdhseq, 
                   g_xmdh_d[l_ac].xmdh001,g_xmdh_d[l_ac].xmdh002,g_xmdh_d[l_ac].xmdh003,g_xmdh_d[l_ac].xmdh004, 
                   g_xmdh_d[l_ac].xmdh005,g_xmdh_d[l_ac].xmdh006,g_xmdh_d[l_ac].xmdh007,g_xmdh_d[l_ac].xmdh034, 
                   g_xmdh_d[l_ac].xmdh009,g_xmdh_d[l_ac].xmdh010,g_xmdh_d[l_ac].xmdh015,g_xmdh_d[l_ac].xmdh016, 
                   g_xmdh_d[l_ac].xmdh017,g_xmdh_d[l_ac].xmdh018,g_xmdh_d[l_ac].xmdh019,g_xmdh_d[l_ac].xmdh008, 
                   g_xmdh_d[l_ac].xmdh011,g_xmdh_d[l_ac].xmdh012,g_xmdh_d[l_ac].xmdh013,g_xmdh_d[l_ac].xmdh014, 
                   g_xmdh_d[l_ac].xmdh029,g_xmdh_d[l_ac].xmdh020,g_xmdh_d[l_ac].xmdh021,g_xmdh_d[l_ac].xmdh022, 
                   g_xmdh_d[l_ac].xmdh036,g_xmdh_d[l_ac].xmdh031,g_xmdh_d[l_ac].xmdh032,g_xmdh_d[l_ac].xmdh033, 
                   g_xmdh_d[l_ac].xmdh050,g_xmdh_d[l_ac].xmdh056,g_xmdh_d[l_ac].xmdh030,g_xmdh_d[l_ac].xmdh051, 
                   g_xmdh_d[l_ac].xmdh052,g_xmdh_d[l_ac].xmdhunit,g_xmdh_d[l_ac].xmdh035,g_xmdh4_d[l_ac].xmdh023, 
                   g_xmdh4_d[l_ac].xmdh024,g_xmdh4_d[l_ac].xmdh025,g_xmdh4_d[l_ac].xmdh026,g_xmdh4_d[l_ac].xmdh027, 
                   g_xmdh4_d[l_ac].xmdh028)
                WHERE xmdhent = g_enterprise AND xmdhdocno = g_xmdg_m.xmdgdocno 
 
                  AND xmdhseq = g_xmdh_d_t.xmdhseq #項次   
 
                  
               #add-point:單身修改中
               {<point name="input.body.m_update"/>}
               #end add-point
               CASE
                  WHEN SQLCA.sqlerrd[3] = 0  #更新不到的處理
                     INITIALIZE g_errparam TO NULL 
                     LET g_errparam.extend = "xmdh_t" 
                     LET g_errparam.code   = "std-00009" 
                     LET g_errparam.popup  = TRUE 
                     CALL cl_err()
                     CALL s_transaction_end('N','0')
                     LET g_xmdh_d[l_ac].* = g_xmdh_d_t.*
                  WHEN SQLCA.sqlcode #其他錯誤
                     INITIALIZE g_errparam TO NULL 
                     LET g_errparam.extend = "xmdh_t" 
                     LET g_errparam.code   = SQLCA.sqlcode 
                     LET g_errparam.popup  = TRUE 
                     CALL cl_err()                   
                     CALL s_transaction_end('N','0')
                     LET g_xmdh_d[l_ac].* = g_xmdh_d_t.*  
                  OTHERWISE
                                    INITIALIZE gs_keys TO NULL 
               LET gs_keys[1] = g_xmdg_m.xmdgdocno
               LET gs_keys_bak[1] = g_xmdgdocno_t
               LET gs_keys[2] = g_xmdh_d[g_detail_idx].xmdhseq
               LET gs_keys_bak[2] = g_xmdh_d_t.xmdhseq
               CALL axmt520_update_b('xmdh_t',gs_keys,gs_keys_bak,"'1'")
                     #資料多語言用-增/改
                     
               END CASE
 
               #將遮罩欄位進行遮蔽
               CALL axmt520_xmdh_t_mask_restore('restore_mask_n')
               
               #判斷key是否有改變
               INITIALIZE gs_keys TO NULL
               IF NOT(g_xmdh_d[g_detail_idx].xmdhseq = g_xmdh_d_t.xmdhseq 
 
                  ) THEN
                  LET gs_keys[01] = g_xmdg_m.xmdgdocno
 
                  LET gs_keys[gs_keys.getLength()+1] = g_xmdh_d_t.xmdhseq
 
                  CALL axmt520_key_update_b(gs_keys,'xmdh_t')
               END IF
               
               #修改歷程記錄(單身修改)
               LET g_log1 = util.JSON.stringify(g_xmdg_m),util.JSON.stringify(g_xmdh_d_t)
               LET g_log2 = util.JSON.stringify(g_xmdg_m),util.JSON.stringify(g_xmdh_d[l_ac])
               IF NOT cl_log_modified_record_d(g_log1,g_log2) THEN 
                  CALL s_transaction_end('N','0')
               END IF
               
               #add-point:單身修改後
               {<point name="input.body.a_update"/>}
               #end add-point
 
            END IF
            
         AFTER ROW
            #add-point:單身after_row
            {<point name="input.body.after_row"/>}
            #end add-point
            CALL axmt520_unlock_b("xmdh_t","'1'")
            CALL s_transaction_end('Y','0')
            #其他table進行unlock
            #add-point:單身after_row2
            {<point name="input.body.after_row2"/>}
            #end add-point
              
         AFTER INPUT
            #add-point:input段after input 
            {<point name="input.body.after_input"/>}
            #end add-point 
 
         ON ACTION controlo    
            CALL FGL_SET_ARR_CURR(g_xmdh_d.getLength()+1)
            LET lb_reproduce = TRUE
            LET li_reproduce = l_ac
            LET li_reproduce_target = g_xmdh_d.getLength()+1
            
         #ON ACTION cancel
         #   LET INT_FLAG = 1
         #   LET g_detail_idx = 1
         #   EXIT DIALOG 
 
      END INPUT
      
 
      
 
      DISPLAY ARRAY g_xmdh2_d TO s_detail2.* ATTRIBUTES(COUNT=g_rec_b)  
    
         BEFORE ROW
            CALL axmt520_idx_chk()
            LET l_ac = DIALOG.getCurrentRow("s_detail2")
            LET g_detail_idx = l_ac
            
            #add-point:page2, before row動作
            {<point name="input.body2.before_row"/>}
            #end add-point
            
         BEFORE DISPLAY
            #如果一直都在單身1則控制筆數位置
            IF g_loc = 'm' THEN
               CALL FGL_SET_ARR_CURR(g_detail_idx)
            END IF
            LET g_loc = 'm'
            LET l_ac = DIALOG.getCurrentRow("s_detail2")
            CALL axmt520_idx_chk()
            LET g_current_page = 2
      
         #add-point:page2自定義行為
         {<point name="input.body2.action"/>}
         #end add-point
      
      END DISPLAY
      DISPLAY ARRAY g_xmdh3_d TO s_detail3.* ATTRIBUTES(COUNT=g_rec_b)  
    
         BEFORE ROW
            CALL axmt520_idx_chk()
            LET l_ac = DIALOG.getCurrentRow("s_detail3")
            LET g_detail_idx = l_ac
            
            #add-point:page3, before row動作
            {<point name="input.body3.before_row"/>}
            #end add-point
            
         BEFORE DISPLAY
            #如果一直都在單身1則控制筆數位置
            IF g_loc = 'm' THEN
               CALL FGL_SET_ARR_CURR(g_detail_idx)
            END IF
            LET g_loc = 'm'
            LET l_ac = DIALOG.getCurrentRow("s_detail3")
            CALL axmt520_idx_chk()
            LET g_current_page = 3
      
         #add-point:page3自定義行為
         {<point name="input.body3.action"/>}
         #end add-point
      
      END DISPLAY
      DISPLAY ARRAY g_xmdh4_d TO s_detail4.* ATTRIBUTES(COUNT=g_rec_b)  
    
         BEFORE ROW
            CALL axmt520_idx_chk()
            LET l_ac = DIALOG.getCurrentRow("s_detail4")
            LET g_detail_idx = l_ac
            
            #add-point:page4, before row動作
            {<point name="input.body4.before_row"/>}
            #end add-point
            
         BEFORE DISPLAY
            #如果一直都在單身1則控制筆數位置
            IF g_loc = 'm' THEN
               CALL FGL_SET_ARR_CURR(g_detail_idx)
            END IF
            LET g_loc = 'm'
            LET l_ac = DIALOG.getCurrentRow("s_detail4")
            CALL axmt520_idx_chk()
            LET g_current_page = 4
      
         #add-point:page4自定義行為
         {<point name="input.body4.action"/>}
         #end add-point
      
      END DISPLAY
 
 
]]>
  </section>
  <section id="axmt520.input.head" ver="45" status="" src="s" readonly="">
    <![CDATA[      #單頭段
      INPUT BY NAME g_xmdg_m.xmdgdocno,g_xmdg_m.xmdgdocdt,g_xmdg_m.xmdg004,g_xmdg_m.xmdgsite,g_xmdg_m.xmdg002, 
          g_xmdg_m.xmdg003,g_xmdg_m.xmdgstus,g_xmdg_m.xmdg001,g_xmdg_m.xmdg034,g_xmdg_m.xmdg005,g_xmdg_m.xmdg006, 
          g_xmdg_m.xmdg007,g_xmdg_m.xmdg202,g_xmdg_m.xmdg028,g_xmdg_m.xmdg026,g_xmdg_m.xmdg027,g_xmdg_m.xmdg024, 
          g_xmdg_m.xmdg025,g_xmdg_m.xmdg030,g_xmdg_m.xmdg031,g_xmdg_m.xmdg053,g_xmdg_m.xmdg056,g_xmdg_m.xmdg017, 
          g_xmdg_m.xmdg018,g_xmdg_m.xmdg019,g_xmdg_m.xmdg020,g_xmdg_m.xmdg016,g_xmdg_m.xmdg021,g_xmdg_m.xmdg022, 
          g_xmdg_m.xmdg023,g_xmdg_m.xmdg008,g_xmdg_m.xmdg009,g_xmdg_m.xmdg010,g_xmdg_m.xmdg011,g_xmdg_m.xmdg012, 
          g_xmdg_m.xmdg013,g_xmdg_m.xmdg032,g_xmdg_m.xmdg033,g_xmdg_m.xmdg014,g_xmdg_m.xmdg015 
         ATTRIBUTE(WITHOUT DEFAULTS)
         
         #自訂ACTION(master_input)
         
     
         BEFORE INPUT
            IF s_transaction_chk("N",0) THEN
               CALL s_transaction_begin()
            END IF
            OPEN axmt520_cl USING g_enterprise,g_xmdg_m.xmdgdocno
            IF STATUS THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = "OPEN axmt520_cl:" 
               LET g_errparam.code   = STATUS 
               LET g_errparam.popup  = TRUE 
               CALL cl_err()
               CLOSE axmt520_cl
               CALL s_transaction_end('N','0')
               RETURN
            END IF
            
            IF l_cmd_t = 'r' THEN
               
            END IF
            #因應離開單頭後已寫入資料庫, 若重新回到單頭則視為修改
            #因此需於此處開啟/關閉欄位
            CALL axmt520_set_entry(p_cmd)
            #add-point:資料輸入前
            {<point name="input.m.before_input"/>}
            #end add-point
            CALL axmt520_set_no_entry(p_cmd)
    
                  #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdgdocno
            
            #add-point:AFTER FIELD xmdgdocno
            {<point name="input.a.xmdgdocno" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdgdocno
            #add-point:BEFORE FIELD xmdgdocno
            {<point name="input.b.xmdgdocno" />}
            #END add-point
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xmdgdocno
            #add-point:ON CHANGE xmdgdocno
            {<point name="input.g.xmdgdocno" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdgdocdt
            #add-point:BEFORE FIELD xmdgdocdt
            {<point name="input.b.xmdgdocdt" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdgdocdt
            
            #add-point:AFTER FIELD xmdgdocdt
            {<point name="input.a.xmdgdocdt" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xmdgdocdt
            #add-point:ON CHANGE xmdgdocdt
            {<point name="input.g.xmdgdocdt" />}
            #END add-point 
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdg004
            
            #add-point:AFTER FIELD xmdg004
            {<point name="input.a.xmdg004" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdg004
            #add-point:BEFORE FIELD xmdg004
            {<point name="input.b.xmdg004" />}
            #END add-point
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xmdg004
            #add-point:ON CHANGE xmdg004
            {<point name="input.g.xmdg004" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdgsite
            #add-point:BEFORE FIELD xmdgsite
            {<point name="input.b.xmdgsite" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdgsite
            
            #add-point:AFTER FIELD xmdgsite
            {<point name="input.a.xmdgsite" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xmdgsite
            #add-point:ON CHANGE xmdgsite
            {<point name="input.g.xmdgsite" />}
            #END add-point 
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdg002
            
            #add-point:AFTER FIELD xmdg002
            {<point name="input.a.xmdg002" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdg002
            #add-point:BEFORE FIELD xmdg002
            {<point name="input.b.xmdg002" />}
            #END add-point
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xmdg002
            #add-point:ON CHANGE xmdg002
            {<point name="input.g.xmdg002" />}
            #END add-point 
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdg003
            
            #add-point:AFTER FIELD xmdg003
            {<point name="input.a.xmdg003" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdg003
            #add-point:BEFORE FIELD xmdg003
            {<point name="input.b.xmdg003" />}
            #END add-point
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xmdg003
            #add-point:ON CHANGE xmdg003
            {<point name="input.g.xmdg003" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdgstus
            #add-point:BEFORE FIELD xmdgstus
            {<point name="input.b.xmdgstus" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdgstus
            
            #add-point:AFTER FIELD xmdgstus
            {<point name="input.a.xmdgstus" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xmdgstus
            #add-point:ON CHANGE xmdgstus
            {<point name="input.g.xmdgstus" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdg001
            #add-point:BEFORE FIELD xmdg001
            {<point name="input.b.xmdg001" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdg001
            
            #add-point:AFTER FIELD xmdg001
            {<point name="input.a.xmdg001" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xmdg001
            #add-point:ON CHANGE xmdg001
            {<point name="input.g.xmdg001" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdg034
            #add-point:BEFORE FIELD xmdg034
            {<point name="input.b.xmdg034" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdg034
            
            #add-point:AFTER FIELD xmdg034
            {<point name="input.a.xmdg034" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xmdg034
            #add-point:ON CHANGE xmdg034
            {<point name="input.g.xmdg034" />}
            #END add-point 
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdg005
            
            #add-point:AFTER FIELD xmdg005
            {<point name="input.a.xmdg005" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdg005
            #add-point:BEFORE FIELD xmdg005
            {<point name="input.b.xmdg005" />}
            #END add-point
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xmdg005
            #add-point:ON CHANGE xmdg005
            {<point name="input.g.xmdg005" />}
            #END add-point 
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdg006
            
            #add-point:AFTER FIELD xmdg006
            {<point name="input.a.xmdg006" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdg006
            #add-point:BEFORE FIELD xmdg006
            {<point name="input.b.xmdg006" />}
            #END add-point
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xmdg006
            #add-point:ON CHANGE xmdg006
            {<point name="input.g.xmdg006" />}
            #END add-point 
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdg007
            
            #add-point:AFTER FIELD xmdg007
            {<point name="input.a.xmdg007" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdg007
            #add-point:BEFORE FIELD xmdg007
            {<point name="input.b.xmdg007" />}
            #END add-point
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xmdg007
            #add-point:ON CHANGE xmdg007
            {<point name="input.g.xmdg007" />}
            #END add-point 
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdg202
            
            #add-point:AFTER FIELD xmdg202
            {<point name="input.a.xmdg202" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdg202
            #add-point:BEFORE FIELD xmdg202
            {<point name="input.b.xmdg202" />}
            #END add-point
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xmdg202
            #add-point:ON CHANGE xmdg202
            {<point name="input.g.xmdg202" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdg028
            #add-point:BEFORE FIELD xmdg028
            {<point name="input.b.xmdg028" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdg028
            
            #add-point:AFTER FIELD xmdg028
            {<point name="input.a.xmdg028" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xmdg028
            #add-point:ON CHANGE xmdg028
            {<point name="input.g.xmdg028" />}
            #END add-point 
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdg026
            
            #add-point:AFTER FIELD xmdg026
            {<point name="input.a.xmdg026" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdg026
            #add-point:BEFORE FIELD xmdg026
            {<point name="input.b.xmdg026" />}
            #END add-point
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xmdg026
            #add-point:ON CHANGE xmdg026
            {<point name="input.g.xmdg026" />}
            #END add-point 
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdg027
            
            #add-point:AFTER FIELD xmdg027
            {<point name="input.a.xmdg027" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdg027
            #add-point:BEFORE FIELD xmdg027
            {<point name="input.b.xmdg027" />}
            #END add-point
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xmdg027
            #add-point:ON CHANGE xmdg027
            {<point name="input.g.xmdg027" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdg024
            #add-point:BEFORE FIELD xmdg024
            {<point name="input.b.xmdg024" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdg024
            
            #add-point:AFTER FIELD xmdg024
            {<point name="input.a.xmdg024" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xmdg024
            #add-point:ON CHANGE xmdg024
            {<point name="input.g.xmdg024" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdg025
            #add-point:BEFORE FIELD xmdg025
            {<point name="input.b.xmdg025" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdg025
            
            #add-point:AFTER FIELD xmdg025
            {<point name="input.a.xmdg025" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xmdg025
            #add-point:ON CHANGE xmdg025
            {<point name="input.g.xmdg025" />}
            #END add-point 
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdg030
            
            #add-point:AFTER FIELD xmdg030
            {<point name="input.a.xmdg030" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdg030
            #add-point:BEFORE FIELD xmdg030
            {<point name="input.b.xmdg030" />}
            #END add-point
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xmdg030
            #add-point:ON CHANGE xmdg030
            {<point name="input.g.xmdg030" />}
            #END add-point 
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdg031
            
            #add-point:AFTER FIELD xmdg031
            {<point name="input.a.xmdg031" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdg031
            #add-point:BEFORE FIELD xmdg031
            {<point name="input.b.xmdg031" />}
            #END add-point
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xmdg031
            #add-point:ON CHANGE xmdg031
            {<point name="input.g.xmdg031" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdg053
            #add-point:BEFORE FIELD xmdg053
            {<point name="input.b.xmdg053" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdg053
            
            #add-point:AFTER FIELD xmdg053
            {<point name="input.a.xmdg053" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xmdg053
            #add-point:ON CHANGE xmdg053
            {<point name="input.g.xmdg053" />}
            #END add-point 
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdg056
            
            #add-point:AFTER FIELD xmdg056
            {<point name="input.a.xmdg056" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdg056
            #add-point:BEFORE FIELD xmdg056
            {<point name="input.b.xmdg056" />}
            #END add-point
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xmdg056
            #add-point:ON CHANGE xmdg056
            {<point name="input.g.xmdg056" />}
            #END add-point 
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdg017
            
            #add-point:AFTER FIELD xmdg017
            {<point name="input.a.xmdg017" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdg017
            #add-point:BEFORE FIELD xmdg017
            {<point name="input.b.xmdg017" />}
            #END add-point
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xmdg017
            #add-point:ON CHANGE xmdg017
            {<point name="input.g.xmdg017" />}
            #END add-point 
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdg018
            
            #add-point:AFTER FIELD xmdg018
            {<point name="input.a.xmdg018" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdg018
            #add-point:BEFORE FIELD xmdg018
            {<point name="input.b.xmdg018" />}
            #END add-point
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xmdg018
            #add-point:ON CHANGE xmdg018
            {<point name="input.g.xmdg018" />}
            #END add-point 
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdg019
            
            #add-point:AFTER FIELD xmdg019
            {<point name="input.a.xmdg019" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdg019
            #add-point:BEFORE FIELD xmdg019
            {<point name="input.b.xmdg019" />}
            #END add-point
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xmdg019
            #add-point:ON CHANGE xmdg019
            {<point name="input.g.xmdg019" />}
            #END add-point 
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdg020
            
            #add-point:AFTER FIELD xmdg020
            {<point name="input.a.xmdg020" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdg020
            #add-point:BEFORE FIELD xmdg020
            {<point name="input.b.xmdg020" />}
            #END add-point
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xmdg020
            #add-point:ON CHANGE xmdg020
            {<point name="input.g.xmdg020" />}
            #END add-point 
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdg016
            
            #add-point:AFTER FIELD xmdg016
            {<point name="input.a.xmdg016" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdg016
            #add-point:BEFORE FIELD xmdg016
            {<point name="input.b.xmdg016" />}
            #END add-point
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xmdg016
            #add-point:ON CHANGE xmdg016
            {<point name="input.g.xmdg016" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdg021
            #add-point:BEFORE FIELD xmdg021
            {<point name="input.b.xmdg021" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdg021
            
            #add-point:AFTER FIELD xmdg021
            {<point name="input.a.xmdg021" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xmdg021
            #add-point:ON CHANGE xmdg021
            {<point name="input.g.xmdg021" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdg022
            #add-point:BEFORE FIELD xmdg022
            {<point name="input.b.xmdg022" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdg022
            
            #add-point:AFTER FIELD xmdg022
            {<point name="input.a.xmdg022" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xmdg022
            #add-point:ON CHANGE xmdg022
            {<point name="input.g.xmdg022" />}
            #END add-point 
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdg023
            
            #add-point:AFTER FIELD xmdg023
            {<point name="input.a.xmdg023" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdg023
            #add-point:BEFORE FIELD xmdg023
            {<point name="input.b.xmdg023" />}
            #END add-point
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xmdg023
            #add-point:ON CHANGE xmdg023
            {<point name="input.g.xmdg023" />}
            #END add-point 
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdg008
            
            #add-point:AFTER FIELD xmdg008
            {<point name="input.a.xmdg008" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdg008
            #add-point:BEFORE FIELD xmdg008
            {<point name="input.b.xmdg008" />}
            #END add-point
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xmdg008
            #add-point:ON CHANGE xmdg008
            {<point name="input.g.xmdg008" />}
            #END add-point 
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdg009
            
            #add-point:AFTER FIELD xmdg009
            {<point name="input.a.xmdg009" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdg009
            #add-point:BEFORE FIELD xmdg009
            {<point name="input.b.xmdg009" />}
            #END add-point
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xmdg009
            #add-point:ON CHANGE xmdg009
            {<point name="input.g.xmdg009" />}
            #END add-point 
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdg010
            
            #add-point:AFTER FIELD xmdg010
            {<point name="input.a.xmdg010" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdg010
            #add-point:BEFORE FIELD xmdg010
            {<point name="input.b.xmdg010" />}
            #END add-point
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xmdg010
            #add-point:ON CHANGE xmdg010
            {<point name="input.g.xmdg010" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdg011
            #add-point:BEFORE FIELD xmdg011
            {<point name="input.b.xmdg011" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdg011
            
            #add-point:AFTER FIELD xmdg011
            {<point name="input.a.xmdg011" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xmdg011
            #add-point:ON CHANGE xmdg011
            {<point name="input.g.xmdg011" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdg012
            #add-point:BEFORE FIELD xmdg012
            {<point name="input.b.xmdg012" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdg012
            
            #add-point:AFTER FIELD xmdg012
            {<point name="input.a.xmdg012" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xmdg012
            #add-point:ON CHANGE xmdg012
            {<point name="input.g.xmdg012" />}
            #END add-point 
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdg013
            
            #add-point:AFTER FIELD xmdg013
            {<point name="input.a.xmdg013" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdg013
            #add-point:BEFORE FIELD xmdg013
            {<point name="input.b.xmdg013" />}
            #END add-point
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xmdg013
            #add-point:ON CHANGE xmdg013
            {<point name="input.g.xmdg013" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdg032
            #add-point:BEFORE FIELD xmdg032
            {<point name="input.b.xmdg032" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdg032
            
            #add-point:AFTER FIELD xmdg032
            {<point name="input.a.xmdg032" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xmdg032
            #add-point:ON CHANGE xmdg032
            {<point name="input.g.xmdg032" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdg033
            #add-point:BEFORE FIELD xmdg033
            {<point name="input.b.xmdg033" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdg033
            
            #add-point:AFTER FIELD xmdg033
            {<point name="input.a.xmdg033" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xmdg033
            #add-point:ON CHANGE xmdg033
            {<point name="input.g.xmdg033" />}
            #END add-point 
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdg014
            
            #add-point:AFTER FIELD xmdg014
            {<point name="input.a.xmdg014" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdg014
            #add-point:BEFORE FIELD xmdg014
            {<point name="input.b.xmdg014" />}
            #END add-point
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xmdg014
            #add-point:ON CHANGE xmdg014
            {<point name="input.g.xmdg014" />}
            #END add-point 
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xmdg015
            #應用 a15 樣板自動產生(Version:2)
            #確認欄位值在特定區間內
            IF NOT cl_ap_chk_range(g_xmdg_m.xmdg015,"0.000","0","","","azz-00079",1) THEN
               NEXT FIELD xmdg015
            END IF 
 
 
            #add-point:AFTER FIELD xmdg015
            {<point name="input.a.xmdg015" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xmdg015
            #add-point:BEFORE FIELD xmdg015
            {<point name="input.b.xmdg015" />}
            #END add-point
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xmdg015
            #add-point:ON CHANGE xmdg015
            {<point name="input.g.xmdg015" />}
            #END add-point 
 
 #欄位檢查
                  #Ctrlp:input.c.xmdgdocno
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdgdocno
            #add-point:ON ACTION controlp INFIELD xmdgdocno
            {<point name="input.c.xmdgdocno" />}
            #END add-point
 
         #Ctrlp:input.c.xmdgdocdt
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdgdocdt
            #add-point:ON ACTION controlp INFIELD xmdgdocdt
            {<point name="input.c.xmdgdocdt" />}
            #END add-point
 
         #Ctrlp:input.c.xmdg004
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdg004
            #add-point:ON ACTION controlp INFIELD xmdg004
            {<point name="input.c.xmdg004" />}
            #END add-point
 
         #Ctrlp:input.c.xmdgsite
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdgsite
            #add-point:ON ACTION controlp INFIELD xmdgsite
            {<point name="input.c.xmdgsite" />}
            #END add-point
 
         #Ctrlp:input.c.xmdg002
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdg002
            #add-point:ON ACTION controlp INFIELD xmdg002
            {<point name="input.c.xmdg002" />}
            #END add-point
 
         #Ctrlp:input.c.xmdg003
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdg003
            #add-point:ON ACTION controlp INFIELD xmdg003
            {<point name="input.c.xmdg003" />}
            #END add-point
 
         #Ctrlp:input.c.xmdgstus
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdgstus
            #add-point:ON ACTION controlp INFIELD xmdgstus
            {<point name="input.c.xmdgstus" />}
            #END add-point
 
         #Ctrlp:input.c.xmdg001
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdg001
            #add-point:ON ACTION controlp INFIELD xmdg001
            {<point name="input.c.xmdg001" />}
            #END add-point
 
         #Ctrlp:input.c.xmdg034
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdg034
            #add-point:ON ACTION controlp INFIELD xmdg034
            {<point name="input.c.xmdg034" />}
            #END add-point
 
         #Ctrlp:input.c.xmdg005
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdg005
            #add-point:ON ACTION controlp INFIELD xmdg005
            {<point name="input.c.xmdg005" />}
            #END add-point
 
         #Ctrlp:input.c.xmdg006
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdg006
            #add-point:ON ACTION controlp INFIELD xmdg006
            {<point name="input.c.xmdg006" />}
            #END add-point
 
         #Ctrlp:input.c.xmdg007
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdg007
            #add-point:ON ACTION controlp INFIELD xmdg007
            {<point name="input.c.xmdg007" />}
            #END add-point
 
         #Ctrlp:input.c.xmdg202
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdg202
            #add-point:ON ACTION controlp INFIELD xmdg202
            {<point name="input.c.xmdg202" />}
            #END add-point
 
         #Ctrlp:input.c.xmdg028
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdg028
            #add-point:ON ACTION controlp INFIELD xmdg028
            {<point name="input.c.xmdg028" />}
            #END add-point
 
         #Ctrlp:input.c.xmdg026
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdg026
            #add-point:ON ACTION controlp INFIELD xmdg026
            {<point name="input.c.xmdg026" />}
            #END add-point
 
         #Ctrlp:input.c.xmdg027
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdg027
            #add-point:ON ACTION controlp INFIELD xmdg027
            {<point name="input.c.xmdg027" />}
            #END add-point
 
         #Ctrlp:input.c.xmdg024
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdg024
            #add-point:ON ACTION controlp INFIELD xmdg024
            {<point name="input.c.xmdg024" />}
            #END add-point
 
         #Ctrlp:input.c.xmdg025
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdg025
            #add-point:ON ACTION controlp INFIELD xmdg025
            {<point name="input.c.xmdg025" />}
            #END add-point
 
         #Ctrlp:input.c.xmdg030
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdg030
            #add-point:ON ACTION controlp INFIELD xmdg030
            {<point name="input.c.xmdg030" />}
            #END add-point
 
         #Ctrlp:input.c.xmdg031
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdg031
            #add-point:ON ACTION controlp INFIELD xmdg031
            {<point name="input.c.xmdg031" />}
            #END add-point
 
         #Ctrlp:input.c.xmdg053
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdg053
            #add-point:ON ACTION controlp INFIELD xmdg053
            {<point name="input.c.xmdg053" />}
            #END add-point
 
         #Ctrlp:input.c.xmdg056
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdg056
            #add-point:ON ACTION controlp INFIELD xmdg056
            {<point name="input.c.xmdg056" />}
            #END add-point
 
         #Ctrlp:input.c.xmdg017
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdg017
            #add-point:ON ACTION controlp INFIELD xmdg017
            {<point name="input.c.xmdg017" />}
            #END add-point
 
         #Ctrlp:input.c.xmdg018
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdg018
            #add-point:ON ACTION controlp INFIELD xmdg018
            {<point name="input.c.xmdg018" />}
            #END add-point
 
         #Ctrlp:input.c.xmdg019
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdg019
            #add-point:ON ACTION controlp INFIELD xmdg019
            {<point name="input.c.xmdg019" />}
            #END add-point
 
         #Ctrlp:input.c.xmdg020
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdg020
            #add-point:ON ACTION controlp INFIELD xmdg020
            {<point name="input.c.xmdg020" />}
            #END add-point
 
         #Ctrlp:input.c.xmdg016
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdg016
            #add-point:ON ACTION controlp INFIELD xmdg016
            {<point name="input.c.xmdg016" />}
            #END add-point
 
         #Ctrlp:input.c.xmdg021
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdg021
            #add-point:ON ACTION controlp INFIELD xmdg021
            {<point name="input.c.xmdg021" />}
            #END add-point
 
         #Ctrlp:input.c.xmdg022
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdg022
            #add-point:ON ACTION controlp INFIELD xmdg022
            {<point name="input.c.xmdg022" />}
            #END add-point
 
         #Ctrlp:input.c.xmdg023
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdg023
            #add-point:ON ACTION controlp INFIELD xmdg023
            {<point name="input.c.xmdg023" />}
            #END add-point
 
         #Ctrlp:input.c.xmdg008
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdg008
            #add-point:ON ACTION controlp INFIELD xmdg008
            {<point name="input.c.xmdg008" />}
            #END add-point
 
         #Ctrlp:input.c.xmdg009
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdg009
            #add-point:ON ACTION controlp INFIELD xmdg009
            {<point name="input.c.xmdg009" />}
            #END add-point
 
         #Ctrlp:input.c.xmdg010
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdg010
            #add-point:ON ACTION controlp INFIELD xmdg010
            {<point name="input.c.xmdg010" />}
            #END add-point
 
         #Ctrlp:input.c.xmdg011
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdg011
            #add-point:ON ACTION controlp INFIELD xmdg011
            {<point name="input.c.xmdg011" />}
            #END add-point
 
         #Ctrlp:input.c.xmdg012
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdg012
            #add-point:ON ACTION controlp INFIELD xmdg012
            {<point name="input.c.xmdg012" />}
            #END add-point
 
         #Ctrlp:input.c.xmdg013
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdg013
            #add-point:ON ACTION controlp INFIELD xmdg013
            {<point name="input.c.xmdg013" />}
            #END add-point
 
         #Ctrlp:input.c.xmdg032
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdg032
            #add-point:ON ACTION controlp INFIELD xmdg032
            {<point name="input.c.xmdg032" />}
            #END add-point
 
         #Ctrlp:input.c.xmdg033
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdg033
            #add-point:ON ACTION controlp INFIELD xmdg033
            {<point name="input.c.xmdg033" />}
            #END add-point
 
         #Ctrlp:input.c.xmdg014
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdg014
            #add-point:ON ACTION controlp INFIELD xmdg014
            {<point name="input.c.xmdg014" />}
            #END add-point
 
         #Ctrlp:input.c.xmdg015
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xmdg015
            #add-point:ON ACTION controlp INFIELD xmdg015
            {<point name="input.c.xmdg015" />}
            #END add-point
 
 #欄位開窗
            
         AFTER INPUT
            IF INT_FLAG THEN
               EXIT DIALOG
            END IF
 
            #CALL cl_err_collect_show()      #錯誤訊息統整顯示
            #CALL cl_showmsg()
            DISPLAY BY NAME g_xmdg_m.xmdgdocno
                        
            #add-point:單頭INPUT後
            {<point name="input.head.after_input"/>}
            #end add-point
                        
            IF p_cmd <> 'u' THEN
    
               CALL s_transaction_begin()
               
               #add-point:單頭新增前
               {<point name="input.head.b_insert" mark="Y"/>}
               #end add-point
               
               INSERT INTO xmdg_t (xmdgent,xmdgdocno,xmdgdocdt,xmdg004,xmdgsite,xmdg002,xmdg003,xmdgstus, 
                   xmdg001,xmdg034,xmdg005,xmdg006,xmdg007,xmdg202,xmdg028,xmdg026,xmdg027,xmdg024,xmdg025, 
                   xmdg030,xmdg031,xmdg053,xmdg056,xmdg055,xmdg054,xmdg017,xmdg018,xmdg019,xmdg020,xmdg016, 
                   xmdg021,xmdg022,xmdg023,xmdg008,xmdg009,xmdg010,xmdg011,xmdg012,xmdg013,xmdg032,xmdg033, 
                   xmdg014,xmdg015,xmdgownid,xmdgowndp,xmdgcrtid,xmdgcrtdp,xmdgcrtdt,xmdgmodid,xmdgmoddt, 
                   xmdgcnfid,xmdgcnfdt)
               VALUES (g_enterprise,g_xmdg_m.xmdgdocno,g_xmdg_m.xmdgdocdt,g_xmdg_m.xmdg004,g_xmdg_m.xmdgsite, 
                   g_xmdg_m.xmdg002,g_xmdg_m.xmdg003,g_xmdg_m.xmdgstus,g_xmdg_m.xmdg001,g_xmdg_m.xmdg034, 
                   g_xmdg_m.xmdg005,g_xmdg_m.xmdg006,g_xmdg_m.xmdg007,g_xmdg_m.xmdg202,g_xmdg_m.xmdg028, 
                   g_xmdg_m.xmdg026,g_xmdg_m.xmdg027,g_xmdg_m.xmdg024,g_xmdg_m.xmdg025,g_xmdg_m.xmdg030, 
                   g_xmdg_m.xmdg031,g_xmdg_m.xmdg053,g_xmdg_m.xmdg056,g_xmdg_m.xmdg055,g_xmdg_m.xmdg054, 
                   g_xmdg_m.xmdg017,g_xmdg_m.xmdg018,g_xmdg_m.xmdg019,g_xmdg_m.xmdg020,g_xmdg_m.xmdg016, 
                   g_xmdg_m.xmdg021,g_xmdg_m.xmdg022,g_xmdg_m.xmdg023,g_xmdg_m.xmdg008,g_xmdg_m.xmdg009, 
                   g_xmdg_m.xmdg010,g_xmdg_m.xmdg011,g_xmdg_m.xmdg012,g_xmdg_m.xmdg013,g_xmdg_m.xmdg032, 
                   g_xmdg_m.xmdg033,g_xmdg_m.xmdg014,g_xmdg_m.xmdg015,g_xmdg_m.xmdgownid,g_xmdg_m.xmdgowndp, 
                   g_xmdg_m.xmdgcrtid,g_xmdg_m.xmdgcrtdp,g_xmdg_m.xmdgcrtdt,g_xmdg_m.xmdgmodid,g_xmdg_m.xmdgmoddt, 
                   g_xmdg_m.xmdgcnfid,g_xmdg_m.xmdgcnfdt) 
               IF SQLCA.sqlcode THEN
                  INITIALIZE g_errparam TO NULL 
                  LET g_errparam.extend = "g_xmdg_m" 
                  LET g_errparam.code   = SQLCA.sqlcode 
                  LET g_errparam.popup  = TRUE 
                  CALL cl_err()
                  CALL s_transaction_end('N','0')
                  NEXT FIELD CURRENT
               END IF
               
               #add-point:單頭新增中
               {<point name="input.head.m_insert"/>}
               #end add-point
               
               
               
               
               #add-point:單頭新增後
               {<point name="input.head.a_insert"/>}
               #end add-point
               CALL s_transaction_end('Y','0') 
               
               IF l_cmd_t = 'r' AND p_cmd = 'a' THEN
                  CALL axmt520_detail_reproduce()
                  #因應特定程式需求, 重新刷新單身資料
                  CALL axmt520_b_fill()
                  CALL axmt520_b_fill2('0')
               END IF
               
               #add-point:單頭新增後
               {<point name="input.head.a_insert2"/>}
               #end add-point
               
               LET g_master_insert = TRUE
               
               LET p_cmd = 'u'
            ELSE
               CALL s_transaction_begin()
            
               #add-point:單頭修改前
               {<point name="input.head.b_update" mark="Y"/>}
               #end add-point
               
               #將遮罩欄位還原
               CALL axmt520_xmdg_t_mask_restore('restore_mask_o')
               
               UPDATE xmdg_t SET (xmdgdocno,xmdgdocdt,xmdg004,xmdgsite,xmdg002,xmdg003,xmdgstus,xmdg001, 
                   xmdg034,xmdg005,xmdg006,xmdg007,xmdg202,xmdg028,xmdg026,xmdg027,xmdg024,xmdg025,xmdg030, 
                   xmdg031,xmdg053,xmdg056,xmdg055,xmdg054,xmdg017,xmdg018,xmdg019,xmdg020,xmdg016,xmdg021, 
                   xmdg022,xmdg023,xmdg008,xmdg009,xmdg010,xmdg011,xmdg012,xmdg013,xmdg032,xmdg033,xmdg014, 
                   xmdg015,xmdgownid,xmdgowndp,xmdgcrtid,xmdgcrtdp,xmdgcrtdt,xmdgmodid,xmdgmoddt,xmdgcnfid, 
                   xmdgcnfdt) = (g_xmdg_m.xmdgdocno,g_xmdg_m.xmdgdocdt,g_xmdg_m.xmdg004,g_xmdg_m.xmdgsite, 
                   g_xmdg_m.xmdg002,g_xmdg_m.xmdg003,g_xmdg_m.xmdgstus,g_xmdg_m.xmdg001,g_xmdg_m.xmdg034, 
                   g_xmdg_m.xmdg005,g_xmdg_m.xmdg006,g_xmdg_m.xmdg007,g_xmdg_m.xmdg202,g_xmdg_m.xmdg028, 
                   g_xmdg_m.xmdg026,g_xmdg_m.xmdg027,g_xmdg_m.xmdg024,g_xmdg_m.xmdg025,g_xmdg_m.xmdg030, 
                   g_xmdg_m.xmdg031,g_xmdg_m.xmdg053,g_xmdg_m.xmdg056,g_xmdg_m.xmdg055,g_xmdg_m.xmdg054, 
                   g_xmdg_m.xmdg017,g_xmdg_m.xmdg018,g_xmdg_m.xmdg019,g_xmdg_m.xmdg020,g_xmdg_m.xmdg016, 
                   g_xmdg_m.xmdg021,g_xmdg_m.xmdg022,g_xmdg_m.xmdg023,g_xmdg_m.xmdg008,g_xmdg_m.xmdg009, 
                   g_xmdg_m.xmdg010,g_xmdg_m.xmdg011,g_xmdg_m.xmdg012,g_xmdg_m.xmdg013,g_xmdg_m.xmdg032, 
                   g_xmdg_m.xmdg033,g_xmdg_m.xmdg014,g_xmdg_m.xmdg015,g_xmdg_m.xmdgownid,g_xmdg_m.xmdgowndp, 
                   g_xmdg_m.xmdgcrtid,g_xmdg_m.xmdgcrtdp,g_xmdg_m.xmdgcrtdt,g_xmdg_m.xmdgmodid,g_xmdg_m.xmdgmoddt, 
                   g_xmdg_m.xmdgcnfid,g_xmdg_m.xmdgcnfdt)
                WHERE xmdgent = g_enterprise AND xmdgdocno = g_xmdgdocno_t
 
               IF SQLCA.sqlcode THEN
                  INITIALIZE g_errparam TO NULL 
                  LET g_errparam.extend = "xmdg_t" 
                  LET g_errparam.code   = SQLCA.sqlcode 
                  LET g_errparam.popup  = TRUE 
                  CALL cl_err()
                  CALL s_transaction_end('N','0')
                  NEXT FIELD CURRENT
               END IF
               
               #add-point:單頭修改中
               {<point name="input.head.m_update"/>}
               #end add-point
               
               
               
               
               #將遮罩欄位進行遮蔽
               CALL axmt520_xmdg_t_mask_restore('restore_mask_n')
               
               #修改歷程記錄(單頭修改)
               LET g_log1 = util.JSON.stringify(g_xmdg_m_t)
               LET g_log2 = util.JSON.stringify(g_xmdg_m)
               IF NOT cl_log_modified_record(g_log1,g_log2) THEN 
                  CALL s_transaction_end('N','0')
               ELSE
                  CALL s_transaction_end('Y','0')
               END IF
               
               #add-point:單頭修改後
               {<point name="input.head.a_update"/>}
               #end add-point
            END IF
            
            LET g_xmdgdocno_t = g_xmdg_m.xmdgdocno
 
            
      END INPUT
   
]]>
  </section>
  <section id="axmt520.input.other" ver="20" status="" src="s" readonly="">
    <![CDATA[      
      #add-point:自定義input
      {<point name="input.more_input"/>}
      #end add-point
    
      BEFORE DIALOG 
         #CALL cl_err_collect_init()    
         #add-point:input段before dialog
         {<point name="input.before_dialog"/>}
         #end add-point    
         #重新導回資料到正確位置上
         CALL DIALOG.setCurrentRow("s_detail1",g_detail_idx)      
         CALL DIALOG.setCurrentRow("s_detail2",g_detail_idx)
         CALL DIALOG.setCurrentRow("s_detail3",g_detail_idx)
         CALL DIALOG.setCurrentRow("s_detail4",g_detail_idx)
 
         #新增時強制從單頭開始填
         IF p_cmd = 'a' THEN
            #add-point:input段next_field
            {<point name="input.next_field"/>}
            #end add-point  
            NEXT FIELD xmdgdocno
         ELSE
            CASE g_aw
               WHEN "s_detail1"
                  NEXT FIELD xmdhsite
               WHEN "s_detail2"
                  NEXT FIELD xmdisite
               WHEN "s_detail3"
                  NEXT FIELD edit1
               WHEN "s_detail4"
                  NEXT FIELD xmdhseq_4
 
               #add-point:input段modify_detail 
               {<point name="input.modify_detail.other"/>}
               #end add-point  
            END CASE
         END IF
      
      AFTER DIALOG
         #add-point:input段after_dialog
         {<point name="input.after_dialog"/>}
         #end add-point    
         
      ON ACTION controlf
         CALL cl_set_focus_form(ui.Interface.getRootNode()) RETURNING g_fld_name,g_frm_name
         CALL cl_fldhelp(g_frm_name,g_fld_name,g_lang)
 
      ON ACTION controlr
         CALL cl_show_req_fields()
 
      ON ACTION controls
         IF g_header_hidden THEN
            CALL gfrm_curr.setElementHidden("vb_master",0)
            CALL gfrm_curr.setElementImage("controls","small/arr-u.png")
            LET g_header_hidden = 0     #visible
         ELSE
            CALL gfrm_curr.setElementHidden("vb_master",1)
            CALL gfrm_curr.setElementImage("controls","small/arr-d.png")
            LET g_header_hidden = 1     #hidden     
         END IF
 
      ON ACTION accept
         #add-point:input段accept 
         {<point name="input.accept"/>}
         #end add-point    
         ACCEPT DIALOG
        
      ON ACTION cancel      #在dialog button (放棄)
         #add-point:input段cancel
         {<point name="input.cancel"/>}
         #end add-point  
         LET INT_FLAG = TRUE 
         LET g_detail_idx  = 1
         LET g_detail_idx2 = 1
         EXIT DIALOG
 
      ON ACTION close       #在dialog 右上角 (X)
         #add-point:input段close
         {<point name="input.close"/>}
         #end add-point  
         LET INT_FLAG = TRUE 
         EXIT DIALOG
 
      ON ACTION exit        #toolbar 離開
         #add-point:input段exit
         {<point name="input.exit"/>}
         #end add-point
         LET INT_FLAG = TRUE 
         EXIT DIALOG
 
      #交談指令共用ACTION
      &include "common_action.4gl" 
         CONTINUE DIALOG 
   END DIALOG
    
   #add-point:input段after input 
   {<point name="input.after_input"/>}
   #end add-point    
 
END FUNCTION
]]>
  </section>
  <section id="axmt520.insert" ver="35" status="" src="s" readonly="">
    <![CDATA[#+ 資料新增
PRIVATE FUNCTION axmt520_insert()
   #add-point:insert段define
   {<point name="insert.define" edit="s"/>}
   #end add-point    
   #add-point:insert段define(客製用)
   {<point name="insert.define_customerization" edit="c"/>}
   #end add-point    
   
   #清畫面欄位內容
   CLEAR FORM                    
   CALL g_xmdh_d.clear()   
   CALL g_xmdh2_d.clear()  
   CALL g_xmdh3_d.clear()  
   CALL g_xmdh4_d.clear()  
 
 
   INITIALIZE g_xmdg_m.* LIKE xmdg_t.*             #DEFAULT 設定
   
   LET g_xmdgdocno_t = NULL
 
   
   LET g_master_insert = FALSE
   
   #add-point:insert段before
   {<point name="insert.before"/>}
   #end add-point    
   
   CALL s_transaction_begin()
   WHILE TRUE
      #公用欄位給值(單頭)
      #應用 a14 樣板自動產生(Version:4)    
      #公用欄位新增給值  
      LET g_xmdg_m.xmdgownid = g_user
      LET g_xmdg_m.xmdgowndp = g_dept
      LET g_xmdg_m.xmdgcrtid = g_user
      LET g_xmdg_m.xmdgcrtdp = g_dept 
      LET g_xmdg_m.xmdgcrtdt = cl_get_current()
      LET g_xmdg_m.xmdgmodid = g_user
      LET g_xmdg_m.xmdgmoddt = cl_get_current()
      LET g_xmdg_m.xmdgstus = 'N'
 
 
 
      #append欄位給值
      
     
      #一般欄位給值
            LET g_xmdg_m.xmdg001 = "1"
      LET g_xmdg_m.xmdg034 = "1"
      LET g_xmdg_m.xmdg024 = "N"
      LET g_xmdg_m.xmdg025 = "N"
      LET g_xmdg_m.xmdg054 = "N"
      LET g_xmdg_m.xmdg012 = "N"
 
  
      #add-point:單頭預設值
      {<point name="insert.default"/>}
      #end add-point 
      
      #保存單頭舊值(用於資料輸入錯誤還原預設值時使用)
      LET g_xmdg_m_t.* = g_xmdg_m.*
      LET g_xmdg_m_o.* = g_xmdg_m.*
      
      #顯示狀態(stus)圖片
            #應用 a21 樣板自動產生(Version:2)
	  #根據當下狀態碼顯示圖片
      CASE g_xmdg_m.xmdgstus 
         WHEN "N"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/unconfirmed.png")
         WHEN "Y"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/confirmed.png")
         WHEN "A"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/approved.png")
         WHEN "D"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/withdraw.png")
         WHEN "R"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/rejection.png")
         WHEN "W"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/signing.png")
         WHEN "H"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/hold.png")
         WHEN "UH"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/unhold.png")
         WHEN "X"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/invalid.png")
         
      END CASE
 
 
    
      CALL axmt520_input("a")
      
      #add-point:單頭輸入後
      {<point name="insert.after_insert"/>}
      #end add-point
      
      IF INT_FLAG THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = '' 
         LET g_errparam.code   = 9001 
         LET g_errparam.popup  = FALSE 
         CALL cl_err()
         CALL s_transaction_end('N','0')
         LET INT_FLAG = 0
      END IF
      
      IF NOT g_master_insert THEN
         DISPLAY g_detail_cnt  TO FORMONLY.h_count    #總筆數
         DISPLAY g_current_idx TO FORMONLY.h_index    #當下筆數
         INITIALIZE g_xmdg_m.* TO NULL
         INITIALIZE g_xmdh_d TO NULL
         INITIALIZE g_xmdh2_d TO NULL
         INITIALIZE g_xmdh3_d TO NULL
         INITIALIZE g_xmdh4_d TO NULL
 
         #add-point:取消新增後
         {<point name="insert.cancel"/>}
         #end add-point 
         CALL axmt520_show()
         RETURN
      END IF
      
      LET INT_FLAG = 0
      #CALL g_xmdh_d.clear()
      #CALL g_xmdh2_d.clear()
      #CALL g_xmdh3_d.clear()
      #CALL g_xmdh4_d.clear()
 
 
      LET g_rec_b = 0
      CALL s_transaction_end('Y','0')
      EXIT WHILE
        
   END WHILE
   
   #根據資料狀態切換action狀態
   CALL cl_set_act_visible("statechange,modify,modify_detail,delete,reproduce", TRUE)
   CALL axmt520_set_act_visible()   
   CALL axmt520_set_act_no_visible()
   
   #將新增的資料併入搜尋條件中
   LET g_xmdgdocno_t = g_xmdg_m.xmdgdocno
 
   
   #組合新增資料的條件
   LET g_add_browse = " xmdgent = '" ||g_enterprise|| "' AND",
                      " xmdgdocno = '", g_xmdg_m.xmdgdocno, "' "
 
                      
   #add-point:組合新增資料的條件後
   {<point name="insert.after.add_browse"/>}
   #end add-point
      
   #填到最後面
   LET g_current_idx = g_browser.getLength() + 1
   CALL axmt520_browser_fill("")
   
   DISPLAY g_browser_cnt TO FORMONLY.h_count    #總筆數
   DISPLAY g_current_idx TO FORMONLY.h_index    #當下筆數
   CALL cl_navigator_setting(g_current_idx, g_browser_cnt)
   
   CLOSE axmt520_cl
   
   CALL axmt520_idx_chk()
   
   #撈取異動後的資料(主要是帶出reference)
   EXECUTE axmt520_master_referesh USING g_xmdg_m.xmdgdocno INTO g_xmdg_m.xmdgdocno,g_xmdg_m.xmdgdocdt, 
       g_xmdg_m.xmdg004,g_xmdg_m.xmdgsite,g_xmdg_m.xmdg002,g_xmdg_m.xmdg003,g_xmdg_m.xmdgstus,g_xmdg_m.xmdg001, 
       g_xmdg_m.xmdg034,g_xmdg_m.xmdg005,g_xmdg_m.xmdg006,g_xmdg_m.xmdg007,g_xmdg_m.xmdg202,g_xmdg_m.xmdg028, 
       g_xmdg_m.xmdg026,g_xmdg_m.xmdg027,g_xmdg_m.xmdg024,g_xmdg_m.xmdg025,g_xmdg_m.xmdg030,g_xmdg_m.xmdg031, 
       g_xmdg_m.xmdg053,g_xmdg_m.xmdg056,g_xmdg_m.xmdg055,g_xmdg_m.xmdg054,g_xmdg_m.xmdg017,g_xmdg_m.xmdg018, 
       g_xmdg_m.xmdg019,g_xmdg_m.xmdg020,g_xmdg_m.xmdg016,g_xmdg_m.xmdg021,g_xmdg_m.xmdg022,g_xmdg_m.xmdg023, 
       g_xmdg_m.xmdg008,g_xmdg_m.xmdg009,g_xmdg_m.xmdg010,g_xmdg_m.xmdg011,g_xmdg_m.xmdg012,g_xmdg_m.xmdg013, 
       g_xmdg_m.xmdg032,g_xmdg_m.xmdg033,g_xmdg_m.xmdg014,g_xmdg_m.xmdg015,g_xmdg_m.xmdgownid,g_xmdg_m.xmdgowndp, 
       g_xmdg_m.xmdgcrtid,g_xmdg_m.xmdgcrtdp,g_xmdg_m.xmdgcrtdt,g_xmdg_m.xmdgmodid,g_xmdg_m.xmdgmoddt, 
       g_xmdg_m.xmdgcnfid,g_xmdg_m.xmdgcnfdt,g_xmdg_m.xmdg002_desc,g_xmdg_m.xmdg003_desc,g_xmdg_m.xmdg005_desc, 
       g_xmdg_m.xmdg006_desc,g_xmdg_m.xmdg007_desc,g_xmdg_m.xmdg202_desc,g_xmdg_m.xmdg026_desc,g_xmdg_m.xmdg027_desc, 
       g_xmdg_m.xmdg030_desc,g_xmdg_m.xmdg031_desc,g_xmdg_m.xmdg056_desc,g_xmdg_m.xmdg017_desc,g_xmdg_m.xmdg018_desc, 
       g_xmdg_m.xmdg016_desc,g_xmdg_m.xmdg008_desc,g_xmdg_m.xmdg009_desc,g_xmdg_m.xmdg014_desc,g_xmdg_m.xmdgownid_desc, 
       g_xmdg_m.xmdgowndp_desc,g_xmdg_m.xmdgcrtid_desc,g_xmdg_m.xmdgcrtdp_desc,g_xmdg_m.xmdgmodid_desc, 
       g_xmdg_m.xmdgcnfid_desc
   
   #遮罩相關處理
   LET g_xmdg_m_mask_o.* =  g_xmdg_m.*
   CALL axmt520_xmdg_t_mask()
   LET g_xmdg_m_mask_n.* =  g_xmdg_m.*
   
   #將資料顯示到畫面上
   DISPLAY BY NAME g_xmdg_m.xmdgdocno,g_xmdg_m.xmdgdocno_desc,g_xmdg_m.xmdgdocdt,g_xmdg_m.xmdg004,g_xmdg_m.xmdgsite, 
       g_xmdg_m.xmdg002,g_xmdg_m.xmdg002_desc,g_xmdg_m.xmdg003,g_xmdg_m.xmdg003_desc,g_xmdg_m.xmdgstus, 
       g_xmdg_m.xmdg001,g_xmdg_m.xmdg034,g_xmdg_m.xmdg005,g_xmdg_m.xmdg005_desc,g_xmdg_m.xmdg006,g_xmdg_m.xmdg006_desc, 
       g_xmdg_m.xmdg007,g_xmdg_m.xmdg007_desc,g_xmdg_m.xmdg202,g_xmdg_m.xmdg202_desc,g_xmdg_m.xmdg028, 
       g_xmdg_m.xmdg026,g_xmdg_m.xmdg026_desc,g_xmdg_m.xmdg027,g_xmdg_m.xmdg027_desc,g_xmdg_m.xmdg024, 
       g_xmdg_m.xmdg025,g_xmdg_m.xmdg030,g_xmdg_m.xmdg030_desc,g_xmdg_m.xmdg031,g_xmdg_m.xmdg031_desc, 
       g_xmdg_m.xmdg053,g_xmdg_m.xmdg056,g_xmdg_m.xmdg056_desc,g_xmdg_m.xmdg055,g_xmdg_m.xmdg054,g_xmdg_m.xmdg017, 
       g_xmdg_m.xmdg017_desc,g_xmdg_m.textedit1,g_xmdg_m.xmdg018,g_xmdg_m.xmdg018_desc,g_xmdg_m.xmdg019, 
       g_xmdg_m.xmdg019_desc,g_xmdg_m.xmdg020,g_xmdg_m.xmdg020_desc,g_xmdg_m.xmdg016,g_xmdg_m.xmdg016_desc, 
       g_xmdg_m.xmdg021,g_xmdg_m.xmdg022,g_xmdg_m.xmdg023,g_xmdg_m.xmdg023_desc,g_xmdg_m.xmdg008,g_xmdg_m.xmdg008_desc, 
       g_xmdg_m.xmdg009,g_xmdg_m.xmdg009_desc,g_xmdg_m.xmdg010,g_xmdg_m.xmdg010_desc,g_xmdg_m.xmdg011, 
       g_xmdg_m.xmdg012,g_xmdg_m.xmdg013,g_xmdg_m.xmdg013_desc,g_xmdg_m.xmdg032,g_xmdg_m.xmdg033,g_xmdg_m.xmdg014, 
       g_xmdg_m.xmdg014_desc,g_xmdg_m.xmdg015,g_xmdg_m.xmdgownid,g_xmdg_m.xmdgownid_desc,g_xmdg_m.xmdgowndp, 
       g_xmdg_m.xmdgowndp_desc,g_xmdg_m.xmdgcrtid,g_xmdg_m.xmdgcrtid_desc,g_xmdg_m.xmdgcrtdp,g_xmdg_m.xmdgcrtdp_desc, 
       g_xmdg_m.xmdgcrtdt,g_xmdg_m.xmdgmodid,g_xmdg_m.xmdgmodid_desc,g_xmdg_m.xmdgmoddt,g_xmdg_m.xmdgcnfid, 
       g_xmdg_m.xmdgcnfid_desc,g_xmdg_m.xmdgcnfdt
   
   #add-point:新增結束後
   {<point name="insert.after"/>}
   #end add-point 
   
   #功能已完成,通報訊息中心
   CALL axmt520_msgcentre_notify('insert')
   
END FUNCTION
]]>
  </section>
  <section id="axmt520.insert_b" ver="22" status="" src="s" readonly="">
    <![CDATA[#+ 新增單身後其他table連動
PRIVATE FUNCTION axmt520_insert_b(ps_table,ps_keys,ps_page)
   DEFINE ps_table    STRING
   DEFINE ps_page     STRING
   DEFINE ps_keys     DYNAMIC ARRAY OF VARCHAR(500)
   DEFINE ls_group    STRING
   DEFINE ls_page     STRING
   DEFINE li_idx      LIKE type_t.num10
   #add-point:insert_b段define
   {<point name="insert_b.define" edit="s"/>}
   #end add-point     
   #add-point:insert_b段define(客製用)
   {<point name="insert_b.define_customerization" edit="c"/>}
   #end add-point     
   
   LET g_update = TRUE  
   
   #判斷是否是同一群組的table
   LET ls_group = "'1','3','4',"
   IF ls_group.getIndexOf(ps_page,1) > 0 THEN
      #add-point:insert_b段資料新增前
      {<point name="insert_b.before_insert" mark="Y"/>}
      #end add-point 
      INSERT INTO xmdh_t
                  (xmdhent,
                   xmdhdocno,
                   xmdhseq
                   ,xmdhsite,xmdh001,xmdh002,xmdh003,xmdh004,xmdh005,xmdh006,xmdh007,xmdh034,xmdh009,xmdh010,xmdh015,xmdh016,xmdh017,xmdh018,xmdh019,xmdh008,xmdh011,xmdh012,xmdh013,xmdh014,xmdh029,xmdh020,xmdh021,xmdh022,xmdh036,xmdh031,xmdh032,xmdh033,xmdh050,xmdh056,xmdh030,xmdh051,xmdh052,xmdhunit,xmdh035,xmdh023,xmdh024,xmdh025,xmdh026,xmdh027,xmdh028) 
            VALUES(g_enterprise,
                   ps_keys[1],ps_keys[2]
                   ,g_xmdh_d[g_detail_idx].xmdhsite,g_xmdh_d[g_detail_idx].xmdh001,g_xmdh_d[g_detail_idx].xmdh002, 
                       g_xmdh_d[g_detail_idx].xmdh003,g_xmdh_d[g_detail_idx].xmdh004,g_xmdh_d[g_detail_idx].xmdh005, 
                       g_xmdh_d[g_detail_idx].xmdh006,g_xmdh_d[g_detail_idx].xmdh007,g_xmdh_d[g_detail_idx].xmdh034, 
                       g_xmdh_d[g_detail_idx].xmdh009,g_xmdh_d[g_detail_idx].xmdh010,g_xmdh_d[g_detail_idx].xmdh015, 
                       g_xmdh_d[g_detail_idx].xmdh016,g_xmdh_d[g_detail_idx].xmdh017,g_xmdh_d[g_detail_idx].xmdh018, 
                       g_xmdh_d[g_detail_idx].xmdh019,g_xmdh_d[g_detail_idx].xmdh008,g_xmdh_d[g_detail_idx].xmdh011, 
                       g_xmdh_d[g_detail_idx].xmdh012,g_xmdh_d[g_detail_idx].xmdh013,g_xmdh_d[g_detail_idx].xmdh014, 
                       g_xmdh_d[g_detail_idx].xmdh029,g_xmdh_d[g_detail_idx].xmdh020,g_xmdh_d[g_detail_idx].xmdh021, 
                       g_xmdh_d[g_detail_idx].xmdh022,g_xmdh_d[g_detail_idx].xmdh036,g_xmdh_d[g_detail_idx].xmdh031, 
                       g_xmdh_d[g_detail_idx].xmdh032,g_xmdh_d[g_detail_idx].xmdh033,g_xmdh_d[g_detail_idx].xmdh050, 
                       g_xmdh_d[g_detail_idx].xmdh056,g_xmdh_d[g_detail_idx].xmdh030,g_xmdh_d[g_detail_idx].xmdh051, 
                       g_xmdh_d[g_detail_idx].xmdh052,g_xmdh_d[g_detail_idx].xmdhunit,g_xmdh_d[g_detail_idx].xmdh035, 
                       g_xmdh4_d[g_detail_idx].xmdh023,g_xmdh4_d[g_detail_idx].xmdh024,g_xmdh4_d[g_detail_idx].xmdh025, 
                       g_xmdh4_d[g_detail_idx].xmdh026,g_xmdh4_d[g_detail_idx].xmdh027,g_xmdh4_d[g_detail_idx].xmdh028) 

      #add-point:insert_b段資料新增中
      {<point name="insert_b.m_insert"/>}
      #end add-point 
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = "xmdh_t" 
         LET g_errparam.code   = SQLCA.sqlcode 
         LET g_errparam.popup  = FALSE 
         CALL cl_err()
      END IF
      
      LET li_idx = g_detail_idx
      IF ps_page <> "'1'" THEN 
         CALL g_xmdh_d.insertElement(li_idx) 
      END IF 
      IF ps_page <> "'3'" THEN 
         CALL g_xmdh3_d.insertElement(li_idx) 
      END IF 
      IF ps_page <> "'4'" THEN 
         CALL g_xmdh4_d.insertElement(li_idx) 
      END IF 
 
      #add-point:insert_b段資料新增後
      {<point name="insert_b.after_insert"/>}
      #end add-point 
   END IF
   
   LET ls_group = "'2',"
   #判斷是否是同一群組的table
   IF ls_group.getIndexOf(ps_page,1) > 0 THEN
      #add-point:insert_b段資料新增前
      {<point name="insert_b.before_insert2" mark="Y"/>}
      #end add-point 
      INSERT INTO xmdi_t
                  (xmdient,
                   xmdidocno,
                   xmdiseq,xmdiseq1
                   ,xmdisite,xmdi001,xmdi002,xmdi003,xmdi004,xmdi005,xmdi006,xmdi007,xmdi013,xmdi008,xmdi009,xmdi010,xmdi011,xmdi012) 
            VALUES(g_enterprise,
                   ps_keys[1],ps_keys[2],ps_keys[3]
                   ,g_xmdh2_d[g_detail_idx].xmdisite,g_xmdh2_d[g_detail_idx].xmdi001,g_xmdh2_d[g_detail_idx].xmdi002, 
                       g_xmdh2_d[g_detail_idx].xmdi003,g_xmdh2_d[g_detail_idx].xmdi004,g_xmdh2_d[g_detail_idx].xmdi005, 
                       g_xmdh2_d[g_detail_idx].xmdi006,g_xmdh2_d[g_detail_idx].xmdi007,g_xmdh2_d[g_detail_idx].xmdi013, 
                       g_xmdh2_d[g_detail_idx].xmdi008,g_xmdh2_d[g_detail_idx].xmdi009,g_xmdh2_d[g_detail_idx].xmdi010, 
                       g_xmdh2_d[g_detail_idx].xmdi011,g_xmdh2_d[g_detail_idx].xmdi012)
      #add-point:insert_b段資料新增中
      {<point name="insert_b.m_insert2"/>}
      #end add-point
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = "xmdi_t" 
         LET g_errparam.code   = SQLCA.sqlcode 
         LET g_errparam.popup  = FALSE 
         CALL cl_err()
      END IF
      
      LET li_idx = g_detail_idx
      IF ps_page <> "'2'" THEN 
         CALL g_xmdh2_d.insertElement(li_idx) 
      END IF 
 
      #add-point:insert_b段資料新增後
      {<point name="insert_b.after_insert2"/>}
      #end add-point
   END IF
 
 
   
 
   
   #add-point:insert_b段other
   {<point name="insert_b.other"/>}
   #end add-point     
   
END FUNCTION
]]>
  </section>
  <section id="axmt520.key_delete_b" ver="4" status="" src="s" readonly="">
    <![CDATA[#+ 上層單身刪除後, 連帶刪除下層單身key欄位
PRIVATE FUNCTION axmt520_key_delete_b(ps_keys_bak,ps_table)
   DEFINE ps_keys_bak DYNAMIC ARRAY OF VARCHAR(500)
   DEFINE ps_table    STRING
   #add-point:delete_b段define
   {<point name="key_delete_b.define" edit="s"/>}
   #end add-point
   #add-point:delete_b段define(客製用)
   {<point name="key_delete_b.define_customerization" edit="c"/>}
   #end add-point
   
 
   
   RETURN TRUE
   
END FUNCTION
]]>
  </section>
  <section id="axmt520.key_update_b" ver="3" status="" src="s" readonly="">
    <![CDATA[#+ 上層單身key欄位變動後, 連帶修正下層單身key欄位
PRIVATE FUNCTION axmt520_key_update_b(ps_keys_bak,ps_table)
   DEFINE ps_keys_bak DYNAMIC ARRAY OF VARCHAR(500)
   DEFINE ps_table    STRING
   #add-point:update_b段define
   {<point name="key_update_b.define" edit="s"/>}
   #end add-point
   #add-point:update_b段define(客製用)
   {<point name="key_update_b.define_customerization" edit="c"/>}
   #end add-point
   
 
   
END FUNCTION
]]>
  </section>
  <section id="axmt520.lock_b" ver="8" status="" src="s" readonly="">
    <![CDATA[#+ 連動lock其他單身table資料
PRIVATE FUNCTION axmt520_lock_b(ps_table,ps_page)
   DEFINE ps_page     STRING
   DEFINE ps_table    STRING
   DEFINE ls_group    STRING
   #add-point:lock_b段define
   {<point name="lock_b.define" edit="s"/>}
   #end add-point   
   #add-point:lock_b段define(客製用)
   {<point name="lock_b.define_customerization" edit="c"/>}
   #end add-point   
    
   #先刷新資料
   #CALL axmt520_b_fill()
   
   #鎖定整組table
   #LET ls_group = "'1','3','4',"
   #僅鎖定自身table
   LET ls_group = "xmdh_t"
   
   IF ls_group.getIndexOf(ps_table,1) THEN
      OPEN axmt520_bcl USING g_enterprise,
                                       g_xmdg_m.xmdgdocno,g_xmdh_d[g_detail_idx].xmdhseq     
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = "axmt520_bcl" 
         LET g_errparam.code   = SQLCA.sqlcode 
         LET g_errparam.popup  = TRUE 
         CALL cl_err()
         RETURN FALSE
      END IF
   END IF
                                    
   #鎖定整組table
   #LET ls_group = "'2',"
   #僅鎖定自身table
   LET ls_group = "xmdi_t"
   IF ls_group.getIndexOf(ps_table,1) THEN
   
      OPEN axmt520_bcl2 USING g_enterprise,
                                             g_xmdg_m.xmdgdocno,g_xmdh2_d[g_detail_idx].xmdiseq,g_xmdh2_d[g_detail_idx].xmdiseq1 

      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = "axmt520_bcl2" 
         LET g_errparam.code   = SQLCA.sqlcode 
         LET g_errparam.popup  = TRUE 
         CALL cl_err()
         RETURN FALSE
      END IF
   END IF
 
 
   
 
   
   #add-point:lock_b段other
   {<point name="lock_b.other"/>}
   #end add-point  
   
   RETURN TRUE
 
END FUNCTION
]]>
  </section>
  <section id="axmt520.main" ver="38" status="" src="s" readonly="">
    <![CDATA[#應用 a26 樣板自動產生(Version:4)
#+ 作業開始(主程式類型)
MAIN
   #add-point:main段define
   {<point name="main.define" edit="s"/>}
   #end add-point   
   #add-point:main段define(客製用)
   {<point name="main.define_customerization" edit="c"/>}
   #end add-point   
 
   OPTIONS
   INPUT NO WRAP
   DEFER INTERRUPT
   
   #設定SQL錯誤記錄方式 (模組內定義有效)
   WHENEVER ERROR CALL cl_err_msg_log
       
   #依模組進行系統初始化設定(系統設定)
   CALL cl_ap_init("axm","")
 
   #add-point:作業初始化
   {<point name="main.init" />}
   #end add-point
   
   
 
   #LOCK CURSOR (identifier)
   #add-point:SQL_define
   {<point name="main.define_sql" />}
   #end add-point
   LET g_forupd_sql = " SELECT xmdgdocno,'',xmdgdocdt,xmdg004,xmdgsite,xmdg002,'',xmdg003,'',xmdgstus, 
       xmdg001,xmdg034,xmdg005,'',xmdg006,'',xmdg007,'',xmdg202,'',xmdg028,xmdg026,'',xmdg027,'',xmdg024, 
       xmdg025,xmdg030,'',xmdg031,'',xmdg053,xmdg056,'',xmdg055,xmdg054,xmdg017,'','',xmdg018,'',xmdg019, 
       '',xmdg020,'',xmdg016,'',xmdg021,xmdg022,xmdg023,'',xmdg008,'',xmdg009,'',xmdg010,'',xmdg011, 
       xmdg012,xmdg013,'',xmdg032,xmdg033,xmdg014,'',xmdg015,xmdgownid,'',xmdgowndp,'',xmdgcrtid,'', 
       xmdgcrtdp,'',xmdgcrtdt,xmdgmodid,'',xmdgmoddt,xmdgcnfid,'',xmdgcnfdt", 
                      " FROM xmdg_t",
                      " WHERE xmdgent= ? AND xmdgdocno=? FOR UPDATE"
   #add-point:SQL_define
   {<point name="main.after_define_sql"/>}
   #end add-point
   LET g_forupd_sql = cl_sql_forupd(g_forupd_sql)                #轉換不同資料庫語法
   LET g_forupd_sql = cl_sql_add_mask(g_forupd_sql)              #遮蔽特定資料
   DECLARE axmt520_cl CURSOR FROM g_forupd_sql                 # LOCK CURSOR
 
   LET g_sql = " SELECT UNIQUE t0.xmdgdocno,t0.xmdgdocdt,t0.xmdg004,t0.xmdgsite,t0.xmdg002,t0.xmdg003, 
       t0.xmdgstus,t0.xmdg001,t0.xmdg034,t0.xmdg005,t0.xmdg006,t0.xmdg007,t0.xmdg202,t0.xmdg028,t0.xmdg026, 
       t0.xmdg027,t0.xmdg024,t0.xmdg025,t0.xmdg030,t0.xmdg031,t0.xmdg053,t0.xmdg056,t0.xmdg055,t0.xmdg054, 
       t0.xmdg017,t0.xmdg018,t0.xmdg019,t0.xmdg020,t0.xmdg016,t0.xmdg021,t0.xmdg022,t0.xmdg023,t0.xmdg008, 
       t0.xmdg009,t0.xmdg010,t0.xmdg011,t0.xmdg012,t0.xmdg013,t0.xmdg032,t0.xmdg033,t0.xmdg014,t0.xmdg015, 
       t0.xmdgownid,t0.xmdgowndp,t0.xmdgcrtid,t0.xmdgcrtdp,t0.xmdgcrtdt,t0.xmdgmodid,t0.xmdgmoddt,t0.xmdgcnfid, 
       t0.xmdgcnfdt,t1.ooag011 ,t2.ooefl003 ,t3.pmaal004 ,t4.pmaal004 ,t5.pmaal004 ,t6.pmaal004 ,t7.oocql004 , 
       t8.oocql004 ,t9.oocql004 ,t10.oocql004 ,t11.icaal003 ,t12.oofb011 ,t13.oocql004 ,t14.pmaal004 , 
       t15.ooibl004 ,t16.oocql004 ,t17.ooail003 ,t18.ooag011 ,t19.ooefl003 ,t20.ooag011 ,t21.ooefl003 , 
       t22.ooag011 ,t23.ooag011",
               " FROM xmdg_t t0",
                              " LEFT JOIN ooag_t t1 ON t1.ooagent='"||g_enterprise||"' AND t1.ooag001=t0.xmdg002  ",
               " LEFT JOIN ooefl_t t2 ON t2.ooeflent='"||g_enterprise||"' AND t2.ooefl001=t0.xmdg003 AND t2.ooefl002='"||g_dlang||"' ",
               " LEFT JOIN pmaal_t t3 ON t3.pmaalent='"||g_enterprise||"' AND t3.pmaal001=t0.xmdg005 AND t3.pmaal002='"||g_dlang||"' ",
               " LEFT JOIN pmaal_t t4 ON t4.pmaalent='"||g_enterprise||"' AND t4.pmaal001=t0.xmdg006 AND t4.pmaal002='"||g_dlang||"' ",
               " LEFT JOIN pmaal_t t5 ON t5.pmaalent='"||g_enterprise||"' AND t5.pmaal001=t0.xmdg007 AND t5.pmaal002='"||g_dlang||"' ",
               " LEFT JOIN pmaal_t t6 ON t6.pmaalent='"||g_enterprise||"' AND t6.pmaal001=t0.xmdg202 AND t6.pmaal002='"||g_dlang||"' ",
               " LEFT JOIN oocql_t t7 ON t7.oocqlent='"||g_enterprise||"' AND t7.oocql001='275' AND t7.oocql002=t0.xmdg026 AND t7.oocql003='"||g_dlang||"' ",
               " LEFT JOIN oocql_t t8 ON t8.oocqlent='"||g_enterprise||"' AND t8.oocql001='295' AND t8.oocql002=t0.xmdg027 AND t8.oocql003='"||g_dlang||"' ",
               " LEFT JOIN oocql_t t9 ON t9.oocqlent='"||g_enterprise||"' AND t9.oocql001='209' AND t9.oocql002=t0.xmdg030 AND t9.oocql003='"||g_dlang||"' ",
               " LEFT JOIN oocql_t t10 ON t10.oocqlent='"||g_enterprise||"' AND t10.oocql001='297' AND t10.oocql002=t0.xmdg031 AND t10.oocql003='"||g_dlang||"' ",
               " LEFT JOIN icaal_t t11 ON t11.icaalent='"||g_enterprise||"' AND t11.icaal001=t0.xmdg056 AND t11.icaal002='"||g_dlang||"' ",
               " LEFT JOIN oofb_t t12 ON t12.oofbent='"||g_enterprise||"' AND t12.oofb001=t0.xmdg017  ",
               " LEFT JOIN oocql_t t13 ON t13.oocqlent='"||g_enterprise||"' AND t13.oocql001='263' AND t13.oocql002=t0.xmdg018 AND t13.oocql003='"||g_dlang||"' ",
               " LEFT JOIN pmaal_t t14 ON t14.pmaalent='"||g_enterprise||"' AND t14.pmaal001=t0.xmdg016 AND t14.pmaal002='"||g_dlang||"' ",
               " LEFT JOIN ooibl_t t15 ON t15.ooiblent='"||g_enterprise||"' AND t15.ooibl002=t0.xmdg008 AND t15.ooibl003='"||g_dlang||"' ",
               " LEFT JOIN oocql_t t16 ON t16.oocqlent='"||g_enterprise||"' AND t16.oocql001='238' AND t16.oocql002=t0.xmdg009 AND t16.oocql003='"||g_dlang||"' ",
               " LEFT JOIN ooail_t t17 ON t17.ooailent='"||g_enterprise||"' AND t17.ooail001=t0.xmdg014 AND t17.ooail002='"||g_dlang||"' ",
               " LEFT JOIN ooag_t t18 ON t18.ooagent='"||g_enterprise||"' AND t18.ooag001=t0.xmdgownid  ",
               " LEFT JOIN ooefl_t t19 ON t19.ooeflent='"||g_enterprise||"' AND t19.ooefl001=t0.xmdgowndp AND t19.ooefl002='"||g_dlang||"' ",
               " LEFT JOIN ooag_t t20 ON t20.ooagent='"||g_enterprise||"' AND t20.ooag001=t0.xmdgcrtid  ",
               " LEFT JOIN ooefl_t t21 ON t21.ooeflent='"||g_enterprise||"' AND t21.ooefl001=t0.xmdgcrtdp AND t21.ooefl002='"||g_dlang||"' ",
               " LEFT JOIN ooag_t t22 ON t22.ooagent='"||g_enterprise||"' AND t22.ooag001=t0.xmdgmodid  ",
               " LEFT JOIN ooag_t t23 ON t23.ooagent='"||g_enterprise||"' AND t23.ooag001=t0.xmdgcnfid  ",
 
               " WHERE t0.xmdgent = '" ||g_enterprise|| "' AND t0.xmdgdocno = ?"
   LET g_sql = cl_sql_add_mask(g_sql)              #遮蔽特定資料
   #add-point:SQL_define
   {<point name="main.after_refresh_sql"/>}
   #end add-point
   PREPARE axmt520_master_referesh FROM g_sql
 
    
 
   
   IF g_bgjob = "Y" THEN
      #add-point:Service Call
      {<point name="main.servicecall" />}
      #end add-point
   ELSE
      #畫面開啟 (identifier)
      OPEN WINDOW w_axmt520 WITH FORM cl_ap_formpath("axm",g_code)
   
      #瀏覽頁簽資料初始化
      CALL cl_ui_init()
   
      #程式初始化
      CALL axmt520_init()   
 
      #進入選單 Menu (="N")
      CALL axmt520_ui_dialog() 
      
      #add-point:畫面關閉前
      {<point name="main.before_close" />}
      #end add-point
 
      #畫面關閉
      CLOSE WINDOW w_axmt520
      
   END IF 
   
   CLOSE axmt520_cl
   
   
 
   #add-point:作業離開前
   {<point name="main.exit" />}
   #end add-point
 
   #離開作業
   CALL cl_ap_exitprogram("0")
END MAIN
 
 
]]>
  </section>
  <section id="axmt520.mask_functions" ver="1" status="" src="s" readonly="">
    <![CDATA[&include "erp/axm/axmt520_mask.4gl"
]]>
  </section>
  <section id="axmt520.modify" ver="38" status="" src="s" readonly="">
    <![CDATA[#+ 資料修改
PRIVATE FUNCTION axmt520_modify()
   DEFINE l_new_key    DYNAMIC ARRAY OF STRING
   DEFINE l_old_key    DYNAMIC ARRAY OF STRING
   DEFINE l_field_key  DYNAMIC ARRAY OF STRING
   DEFINE l_wc2_table1          STRING
   DEFINE l_wc2_table2   STRING
 
 
 
   #add-point:modify段define
   {<point name="modify.define" edit="s"/>}
   #end add-point    
   #add-point:modify段define(客製用)
   {<point name="modify.define_customerization" edit="c"/>}
   #end add-point    
   
   #保存單頭舊值
   LET g_xmdg_m_t.* = g_xmdg_m.*
   LET g_xmdg_m_o.* = g_xmdg_m.*
   
   IF g_xmdg_m.xmdgdocno IS NULL
 
   THEN
      INITIALIZE g_errparam TO NULL 
      LET g_errparam.extend = "" 
      LET g_errparam.code   = "std-00003" 
      LET g_errparam.popup  = FALSE 
      CALL cl_err()
      RETURN
   END IF
 
   ERROR ""
  
   LET g_xmdgdocno_t = g_xmdg_m.xmdgdocno
 
   CALL s_transaction_begin()
   
   OPEN axmt520_cl USING g_enterprise,g_xmdg_m.xmdgdocno
   IF STATUS THEN
      INITIALIZE g_errparam TO NULL 
      LET g_errparam.extend = "OPEN axmt520_cl:" 
      LET g_errparam.code   = STATUS 
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      CLOSE axmt520_cl
      CALL s_transaction_end('N','0')
      RETURN
   END IF
 
   #顯示最新的資料
   EXECUTE axmt520_master_referesh USING g_xmdg_m.xmdgdocno INTO g_xmdg_m.xmdgdocno,g_xmdg_m.xmdgdocdt, 
       g_xmdg_m.xmdg004,g_xmdg_m.xmdgsite,g_xmdg_m.xmdg002,g_xmdg_m.xmdg003,g_xmdg_m.xmdgstus,g_xmdg_m.xmdg001, 
       g_xmdg_m.xmdg034,g_xmdg_m.xmdg005,g_xmdg_m.xmdg006,g_xmdg_m.xmdg007,g_xmdg_m.xmdg202,g_xmdg_m.xmdg028, 
       g_xmdg_m.xmdg026,g_xmdg_m.xmdg027,g_xmdg_m.xmdg024,g_xmdg_m.xmdg025,g_xmdg_m.xmdg030,g_xmdg_m.xmdg031, 
       g_xmdg_m.xmdg053,g_xmdg_m.xmdg056,g_xmdg_m.xmdg055,g_xmdg_m.xmdg054,g_xmdg_m.xmdg017,g_xmdg_m.xmdg018, 
       g_xmdg_m.xmdg019,g_xmdg_m.xmdg020,g_xmdg_m.xmdg016,g_xmdg_m.xmdg021,g_xmdg_m.xmdg022,g_xmdg_m.xmdg023, 
       g_xmdg_m.xmdg008,g_xmdg_m.xmdg009,g_xmdg_m.xmdg010,g_xmdg_m.xmdg011,g_xmdg_m.xmdg012,g_xmdg_m.xmdg013, 
       g_xmdg_m.xmdg032,g_xmdg_m.xmdg033,g_xmdg_m.xmdg014,g_xmdg_m.xmdg015,g_xmdg_m.xmdgownid,g_xmdg_m.xmdgowndp, 
       g_xmdg_m.xmdgcrtid,g_xmdg_m.xmdgcrtdp,g_xmdg_m.xmdgcrtdt,g_xmdg_m.xmdgmodid,g_xmdg_m.xmdgmoddt, 
       g_xmdg_m.xmdgcnfid,g_xmdg_m.xmdgcnfdt,g_xmdg_m.xmdg002_desc,g_xmdg_m.xmdg003_desc,g_xmdg_m.xmdg005_desc, 
       g_xmdg_m.xmdg006_desc,g_xmdg_m.xmdg007_desc,g_xmdg_m.xmdg202_desc,g_xmdg_m.xmdg026_desc,g_xmdg_m.xmdg027_desc, 
       g_xmdg_m.xmdg030_desc,g_xmdg_m.xmdg031_desc,g_xmdg_m.xmdg056_desc,g_xmdg_m.xmdg017_desc,g_xmdg_m.xmdg018_desc, 
       g_xmdg_m.xmdg016_desc,g_xmdg_m.xmdg008_desc,g_xmdg_m.xmdg009_desc,g_xmdg_m.xmdg014_desc,g_xmdg_m.xmdgownid_desc, 
       g_xmdg_m.xmdgowndp_desc,g_xmdg_m.xmdgcrtid_desc,g_xmdg_m.xmdgcrtdp_desc,g_xmdg_m.xmdgmodid_desc, 
       g_xmdg_m.xmdgcnfid_desc
   
   #檢查是否允許此動作
   IF NOT axmt520_action_chk() THEN
      RETURN
   END IF
   
   #遮罩相關處理
   LET g_xmdg_m_mask_o.* =  g_xmdg_m.*
   CALL axmt520_xmdg_t_mask()
   LET g_xmdg_m_mask_n.* =  g_xmdg_m.*
   
   
   
   #add-point:modify段show之前
   {<point name="modify.before_show"/>}
   #end add-point  
   
   #LET l_wc2_table1 = g_wc2_table1
   #LET g_wc2_table1 = " 1=1"
   #LET l_wc2_table2 = g_wc2_table2
   #LET l_wc2_table2 = " 1=1"
 
 
 
   
   CALL axmt520_show()
   #add-point:modify段show之後
   {<point name="modify.after_show"/>}
   #end add-point
   
   #LET g_wc2_table1 = l_wc2_table1
   #LET  g_wc2_table2 = l_wc2_table2 
 
 
 
    
   WHILE TRUE
      LET g_xmdgdocno_t = g_xmdg_m.xmdgdocno
 
      
      #寫入修改者/修改日期資訊(單頭)
      LET g_xmdg_m.xmdgmodid = g_user 
LET g_xmdg_m.xmdgmoddt = cl_get_current()
LET g_xmdg_m.xmdgmodid_desc = cl_get_username(g_xmdg_m.xmdgmodid)
      
      #add-point:modify段修改前
      {<point name="modify.before_input"/>}
      #end add-point
      
      #欄位更改
      LET g_loc = 'n'
      LET g_update = FALSE
      CALL axmt520_input("u")
      LET g_loc = 'n'
 
      #add-point:modify段修改後
      {<point name="modify.after_input"/>}
      #end add-point
      
      IF g_update OR NOT INT_FLAG THEN
         #若有modid跟moddt則進行update
         UPDATE xmdg_t SET (xmdgmodid,xmdgmoddt) = (g_xmdg_m.xmdgmodid,g_xmdg_m.xmdgmoddt)
          WHERE xmdgent = g_enterprise AND xmdgdocno = g_xmdgdocno_t
 
      END IF
    
      IF INT_FLAG THEN
         LET INT_FLAG = 0
         LET g_xmdg_m.* = g_xmdg_m_t.*
         CALL axmt520_show()
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = '' 
         LET g_errparam.code   = 9001 
         LET g_errparam.popup  = FALSE 
         CALL cl_err()
         CALL s_transaction_end('N','0')
         RETURN
      END IF 
                  
      #若單頭key欄位有變更
      IF g_xmdg_m.xmdgdocno != g_xmdgdocno_t 
 
      THEN
         CALL s_transaction_begin()
         
         #add-point:單身fk修改前
         {<point name="modify.body.b_fk_update" mark="Y"/>}
         #end add-point
         
         #更新單身key值
         UPDATE xmdh_t SET xmdhdocno = g_xmdg_m.xmdgdocno
 
          WHERE xmdhent = g_enterprise AND xmdhdocno = g_xmdgdocno_t
 
            
         #add-point:單身fk修改中
         {<point name="modify.body.m_fk_update"/>}
         #end add-point
 
         CASE
            WHEN SQLCA.sqlerrd[3] = 0  #更新不到的處理
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = "xmdh_t" 
               LET g_errparam.code   = "std-00009" 
               LET g_errparam.popup  = TRUE 
               CALL cl_err()
               CALL s_transaction_end('N','0')
               CONTINUE WHILE
            WHEN SQLCA.sqlcode #其他錯誤
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = "xmdh_t" 
               LET g_errparam.code   = SQLCA.sqlcode 
               LET g_errparam.popup  = TRUE 
               CALL cl_err()
               CALL s_transaction_end('N','0')
               CONTINUE WHILE
         END CASE
         
         #add-point:單身fk修改後
         {<point name="modify.body.a_fk_update"/>}
         #end add-point
         
         #更新單身key值
         #add-point:單身fk修改前
         {<point name="modify.body.b_fk_update2" mark="Y"/>}
         #end add-point
         
         UPDATE xmdi_t
            SET xmdidocno = g_xmdg_m.xmdgdocno
 
          WHERE xmdient = g_enterprise AND
                xmdidocno = g_xmdgdocno_t
 
         #add-point:單身fk修改中
         {<point name="modify.body.m_fk_update2"/>}
         #end add-point
         CASE
            WHEN SQLCA.sqlerrd[3] = 0  #更新不到的處理
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = "xmdi_t" 
               LET g_errparam.code   = "std-00009" 
               LET g_errparam.popup  = TRUE 
               CALL cl_err()
               CALL s_transaction_end('N','0')
               CONTINUE WHILE
            WHEN SQLCA.sqlcode #其他錯誤
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = "xmdi_t" 
               LET g_errparam.code   = SQLCA.sqlcode 
               LET g_errparam.popup  = TRUE 
               CALL cl_err()
               CALL s_transaction_end('N','0')
               CONTINUE WHILE
         END CASE
         #add-point:單身fk修改後
         {<point name="modify.body.a_fk_update2"/>}
         #end add-point
 
 
         
 
         
         #UPDATE 多語言table key值
         
         
         
         
 
         CALL s_transaction_end('Y','0')
      END IF
    
      EXIT WHILE
   END WHILE
 
   #根據資料狀態切換action狀態
   CALL cl_set_act_visible("statechange,modify,modify_detail,delete,reproduce", TRUE)
   CALL axmt520_set_act_visible()   
   CALL axmt520_set_act_no_visible()
 
   #組合新增資料的條件
   LET g_add_browse = " xmdgent = '" ||g_enterprise|| "' AND",
                      " xmdgdocno = '", g_xmdg_m.xmdgdocno, "' "
 
   #填到對應位置
   CALL axmt520_browser_fill("")
 
   CLOSE axmt520_cl
   
   CALL s_transaction_end('Y','0')
 
   #功能已完成,通報訊息中心
   CALL axmt520_msgcentre_notify('modify')
 
END FUNCTION   
]]>
  </section>
  <section id="axmt520.msgcentre_notify" ver="5" status="" src="s" readonly="">
    <![CDATA[#應用 a66 樣板自動產生(Version:3)
PRIVATE FUNCTION axmt520_msgcentre_notify(lc_state)
   DEFINE lc_state LIKE type_t.chr80
   #add-point:msgcentre_notify段define
   {<point name="msgcentre_notify.define" edit="s"/>}
   #end add-point
   #add-point:msgcentre_notify段define
   {<point name="msgcentre_notify.define_customerization" edit="c"/>}
   #end add-point   
   
   INITIALIZE g_msgparam TO NULL
 
   #action-id與狀態填寫
   LET g_msgparam.state = lc_state
 
   #PK資料填寫
   CALL axmt520_set_pk_array()
   #單頭資料填寫
   LET g_msgparam.data[1] = util.JSON.stringify(g_xmdg_m)
 
   #add-point:msgcentre其他通知
   {<point name="msgcentre_notify.process"/>}
   #end add-point
 
   #呼叫訊息中心傳遞本關完成訊息
   CALL cl_msgcentre_notify()
 
END FUNCTION
 
 
]]>
  </section>
  <section id="axmt520.other_dialog" ver="2" status="" src="s" readonly="">
    <![CDATA[   
]]>
  </section>
  <section id="axmt520.other_function" ver="2" status="" src="s" readonly="">
    <![CDATA[{<point name="other.function"/>}
]]>
  </section>
  <section id="axmt520.query" ver="10" status="" src="s" readonly="">
    <![CDATA[#+ 資料查詢QBE功能準備
PRIVATE FUNCTION axmt520_query()
   DEFINE ls_wc STRING
   #add-point:query段define
   {<point name="query.define" edit="s"/>}
   #end add-point   
   #add-point:query段define(客製用)
   {<point name="query.define_customerization" edit="c"/>}
   #end add-point   
   
   #切換畫面
   IF g_main_hidden THEN
      CALL gfrm_curr.setElementHidden("mainlayout",0)
      CALL gfrm_curr.setElementHidden("worksheet",1)
      LET g_main_hidden = 0
   END IF   
   
   LET ls_wc = g_wc
   
   LET INT_FLAG = 0
   CALL cl_navigator_setting( g_current_idx, g_detail_cnt )
   ERROR ""
   
   #清除畫面及相關資料
   CLEAR FORM
   CALL g_browser.clear()       
   CALL g_xmdh_d.clear()
   CALL g_xmdh2_d.clear()
   CALL g_xmdh3_d.clear()
   CALL g_xmdh4_d.clear()
 
   
   #add-point:query段other
   {<point name="query.other"/>}
   #end add-point   
   
   DISPLAY '' TO FORMONLY.idx
   DISPLAY '' TO FORMONLY.cnt
   DISPLAY '' TO FORMONLY.b_index
   DISPLAY '' TO FORMONLY.b_count
   DISPLAY '' TO FORMONLY.h_index
   DISPLAY '' TO FORMONLY.h_count
   
   CALL axmt520_construct()
 
   IF INT_FLAG THEN
      #取消查詢
      LET INT_FLAG = 0
      LET g_wc = ls_wc
      CALL axmt520_browser_fill("")
      CALL axmt520_fetch("")
      RETURN
   END IF
   
   #儲存WC資訊
   CALL cl_dlg_save_user_latestqry("("||g_wc||") AND ("||g_wc2||")")
   
   #搜尋後資料初始化 
   LET g_detail_cnt  = 0
   LET g_current_idx = 1
   LET g_current_row = 0
   LET g_detail_idx  = 1
   LET g_detail_idx2 = 1
   LET g_error_show  = 1
   LET g_wc_filter   = ""
   LET l_ac = 1
   CALL FGL_SET_ARR_CURR(1)
      CALL axmt520_filter_show('xmdgdocno')
   CALL axmt520_filter_show('xmdgdocdt')
   CALL axmt520_filter_show('xmdg002')
   CALL axmt520_filter_show('xmdg003')
   CALL axmt520_filter_show('xmdg004')
   CALL axmt520_filter_show('xmdg005')
   CALL axmt520_filter_show('xmdg006')
   CALL axmt520_filter_show('xmdg007')
   CALL axmt520_browser_fill("F")
         
   IF g_browser_cnt = 0 THEN
      INITIALIZE g_errparam TO NULL 
      LET g_errparam.extend = "" 
      LET g_errparam.code   = "-100" 
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
   ELSE
      CALL axmt520_fetch("F") 
      #顯示單身筆數
      CALL axmt520_idx_chk()
   END IF
 
END FUNCTION
]]>
  </section>
  <section id="axmt520.reproduce" ver="32" status="" src="s" readonly="">
    <![CDATA[#+ 資料複製
PRIVATE FUNCTION axmt520_reproduce()
   DEFINE l_newno     LIKE xmdg_t.xmdgdocno 
   DEFINE l_oldno     LIKE xmdg_t.xmdgdocno 
 
   DEFINE l_master    RECORD LIKE xmdg_t.*
   DEFINE l_detail    RECORD LIKE xmdh_t.*
   DEFINE l_detail2    RECORD LIKE xmdi_t.*
 
 
 
   DEFINE l_cnt       LIKE type_t.num10
   #add-point:reproduce段define
   {<point name="reproduce.define" edit="s"/>}
   #end add-point   
   #add-point:reproduce段define(客製用)
   {<point name="reproduce.define_customerization" edit="c"/>}
   #end add-point   
   
   #切換畫面
   IF g_main_hidden THEN
      CALL gfrm_curr.setElementHidden("mainlayout",0)
      CALL gfrm_curr.setElementHidden("worksheet",1)
      LET g_main_hidden = 0
   END IF
   
   LET g_master_insert = FALSE
   
   IF g_xmdg_m.xmdgdocno IS NULL
 
   THEN
      INITIALIZE g_errparam TO NULL 
      LET g_errparam.extend = "" 
      LET g_errparam.code   = "std-00003" 
      LET g_errparam.popup  = FALSE 
      CALL cl_err()
      RETURN
   END IF
    
   LET g_xmdgdocno_t = g_xmdg_m.xmdgdocno
 
    
   LET g_xmdg_m.xmdgdocno = ""
 
 
   CALL cl_set_head_visible("","YES")
 
   #公用欄位給予預設值
   #應用 a14 樣板自動產生(Version:4)    
      #公用欄位新增給值  
      LET g_xmdg_m.xmdgownid = g_user
      LET g_xmdg_m.xmdgowndp = g_dept
      LET g_xmdg_m.xmdgcrtid = g_user
      LET g_xmdg_m.xmdgcrtdp = g_dept 
      LET g_xmdg_m.xmdgcrtdt = cl_get_current()
      LET g_xmdg_m.xmdgmodid = g_user
      LET g_xmdg_m.xmdgmoddt = cl_get_current()
      LET g_xmdg_m.xmdgstus = 'N'
 
 
   
   CALL s_transaction_begin()
   
   #add-point:複製輸入前
   {<point name="reproduce.head.b_input"/>}
   #end add-point
   
   #顯示狀態(stus)圖片
         #應用 a21 樣板自動產生(Version:2)
	  #根據當下狀態碼顯示圖片
      CASE g_xmdg_m.xmdgstus 
         WHEN "N"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/unconfirmed.png")
         WHEN "Y"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/confirmed.png")
         WHEN "A"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/approved.png")
         WHEN "D"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/withdraw.png")
         WHEN "R"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/rejection.png")
         WHEN "W"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/signing.png")
         WHEN "H"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/hold.png")
         WHEN "UH"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/unhold.png")
         WHEN "X"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/invalid.png")
         
      END CASE
 
 
   
   #清空key欄位的desc
      LET g_xmdg_m.xmdgdocno_desc = ''
   DISPLAY BY NAME g_xmdg_m.xmdgdocno_desc
 
   
   CALL axmt520_input("r")
   
   IF INT_FLAG AND NOT g_master_insert THEN
      INITIALIZE g_errparam TO NULL 
      LET g_errparam.extend = '' 
      LET g_errparam.code   = 9001 
      LET g_errparam.popup  = FALSE 
      CALL cl_err()
      CALL s_transaction_end('N','0')
      LET INT_FLAG = 0
      DISPLAY g_detail_cnt  TO FORMONLY.h_count    #總筆數
      DISPLAY g_current_idx TO FORMONLY.h_index    #當下筆數
      LET INT_FLAG = 0
      INITIALIZE g_xmdg_m.* TO NULL
      INITIALIZE g_xmdh_d TO NULL
      INITIALIZE g_xmdh2_d TO NULL
      INITIALIZE g_xmdh3_d TO NULL
      INITIALIZE g_xmdh4_d TO NULL
 
      #add-point:複製取消後
      {<point name="reproduce.cancel" />}
      #end add-point
      CALL axmt520_show()
      RETURN
   END IF
   
   #根據資料狀態切換action狀態
   CALL cl_set_act_visible("statechange,modify,modify_detail,delete,reproduce", TRUE)
   CALL axmt520_set_act_visible()   
   CALL axmt520_set_act_no_visible()
   
   #將新增的資料併入搜尋條件中
   LET g_xmdgdocno_t = g_xmdg_m.xmdgdocno
 
   
   #組合新增資料的條件
   LET g_add_browse = " xmdgent = '" ||g_enterprise|| "' AND",
                      " xmdgdocno = '", g_xmdg_m.xmdgdocno, "' "
 
   #填到最後面
   LET g_current_idx = g_browser.getLength() + 1
   CALL axmt520_browser_fill("")
   
   DISPLAY g_browser_cnt TO FORMONLY.h_count    #總筆數
   DISPLAY g_current_idx TO FORMONLY.h_index    #當下筆數
   CALL cl_navigator_setting(g_current_idx, g_browser_cnt)
   
   #add-point:完成複製段落後
   {<point name="reproduce.after_reproduce" />}
   #end add-point
   
   CALL axmt520_idx_chk()
   
   #功能已完成,通報訊息中心
   CALL axmt520_msgcentre_notify('reproduce')
 
END FUNCTION
]]>
  </section>
  <section id="axmt520.set_act_no_visible" ver="3" status="" src="s" readonly="">
    <![CDATA[#+ 單頭權限關閉
PRIVATE FUNCTION axmt520_set_act_no_visible()
   #add-point:set_act_no_visible段define
   {<point name="set_act_no_visible.define" edit="s"/>}
   #end add-point   
   #add-point:set_act_no_visible段define(客製用)
   {<point name="set_act_no_visible.define_customerization" edit="c"/>}
   #end add-point   
   #add-point:set_act_no_visible段
   {<point name="set_act_no_visible.set_act_no_visible"/>}
   #end add-point   
END FUNCTION
]]>
  </section>
  <section id="axmt520.set_act_no_visible_b" ver="3" status="" src="s" readonly="">
    <![CDATA[#+ 單身權限關閉
PRIVATE FUNCTION axmt520_set_act_no_visible_b()
   #add-point:set_act_no_visible_b段define
   {<point name="set_act_no_visible_b.define" edit="s"/>}
   #end add-point   
   #add-point:set_act_no_visible_b段define(客製用)
   {<point name="set_act_no_visible_b.define_customerization" edit="c"/>}
   #end add-point   
   #add-point:set_act_no_visible_b段
   {<point name="set_act_no_visible_b.set_act_no_visible_b"/>}
   #end add-point   
END FUNCTION
]]>
  </section>
  <section id="axmt520.set_act_visible" ver="3" status="" src="s" readonly="">
    <![CDATA[#+ 單頭權限開啟
PRIVATE FUNCTION axmt520_set_act_visible()
   #add-point:set_act_visible段define
   {<point name="set_act_visible.define" edit="s"/>}
   #end add-point   
   #add-point:set_act_visible段define(客製用)
   {<point name="set_act_visible.define_customerization" edit="c"/>}
   #end add-point   
   #add-point:set_act_visible段
   {<point name="set_act_visible.set_act_visible"/>}
   #end add-point   
END FUNCTION
]]>
  </section>
  <section id="axmt520.set_act_visible_b" ver="3" status="" src="s" readonly="">
    <![CDATA[#+ 單身權限開啟
PRIVATE FUNCTION axmt520_set_act_visible_b()
   #add-point:set_act_visible_b段define
   {<point name="set_act_visible_b.define" edit="s"/>}
   #end add-point   
   #add-point:set_act_visible_b段define(客製用)
   {<point name="set_act_visible_b.define_customerization" edit="c"/>}
   #end add-point   
   #add-point:set_act_visible_b段
   {<point name="set_act_visible_b.set_act_visible_b"/>}
   #end add-point   
END FUNCTION
]]>
  </section>
  <section id="axmt520.set_entry" ver="6" status="" src="s" readonly="">
    <![CDATA[#+ 單頭欄位開啟設定
PRIVATE FUNCTION axmt520_set_entry(p_cmd)
   DEFINE p_cmd   LIKE type_t.chr1  
   #add-point:set_entry段define
   {<point name="set_entry.define" edit="s"/>}
   #end add-point       
   #add-point:set_entry段define(客製用)
   {<point name="set_entry.define_customerization" edit="c"/>}
   #end add-point       
   
   CALL cl_set_comp_entry("xmdgdocno,xmdgdocdt",TRUE)
   
   IF p_cmd = 'a' THEN
      CALL cl_set_comp_entry("xmdgdocno",TRUE)
      #根據azzi850使用者身分開關特定欄位
      IF NOT cl_null(g_no_entry) THEN
         CALL cl_set_comp_entry(g_no_entry,TRUE)
      END IF
      #add-point:set_entry段欄位控制
      {<point name="set_entry.field_control"/>}
      #end add-point  
   END IF
   
   #add-point:set_entry段欄位控制後
   {<point name="set_entry.after_control"/>}
   #end add-point 
 
END FUNCTION
]]>
  </section>
  <section id="axmt520.set_entry_b" ver="5" status="" src="s" readonly="">
    <![CDATA[#+ 單身欄位開啟設定
PRIVATE FUNCTION axmt520_set_entry_b(p_cmd)
   DEFINE p_cmd   LIKE type_t.chr1   
   #add-point:set_entry_b段define
   {<point name="set_entry_b.define" edit="s"/>}
   #end add-point     
   #add-point:set_entry_b段define(客製用)
   {<point name="set_entry_b.define_customerization" edit="c"/>}
   #end add-point     
    
   IF p_cmd = 'a' THEN
      CALL cl_set_comp_entry("",TRUE)
      #add-point:set_entry段欄位控制
      {<point name="set_entry_b.field_control"/>}
      #end add-point  
   END IF
   
   #add-point:set_entry_b段
   {<point name="set_entry_b.set_entry_b"/>}
   #end add-point  
END FUNCTION
]]>
  </section>
  <section id="axmt520.set_no_entry" ver="7" status="" src="s" readonly="">
    <![CDATA[#+ 單頭欄位關閉設定
PRIVATE FUNCTION axmt520_set_no_entry(p_cmd)
   DEFINE p_cmd   LIKE type_t.chr1   
   #add-point:set_no_entry段define
   {<point name="set_no_entry.define" edit="s"/>}
   #end add-point     
   #add-point:set_no_entry段define(客製用)
   {<point name="set_no_entry.define_customerization" edit="c"/>}
   #end add-point     
   
   IF p_cmd = 'u' AND g_chkey = 'N' THEN
      CALL cl_set_comp_entry("xmdgdocno",FALSE)
      #根據azzi850使用者身分開關特定欄位
      IF NOT cl_null(g_no_entry) THEN
         CALL cl_set_comp_entry(g_no_entry,FALSE)
      END IF
      #add-point:set_no_entry段欄位控制
      {<point name="set_no_entry.field_control"/>}
      #end add-point 
   END IF 
   
   IF p_cmd = 'u' THEN
      CALL cl_set_comp_entry("xmdgdocno,xmdgdocdt",FALSE)
   END IF 
   
   #add-point:set_no_entry段欄位控制後
   {<point name="set_no_entry.after_control"/>}
   #end add-point 
 
END FUNCTION
]]>
  </section>
  <section id="axmt520.set_no_entry_b" ver="5" status="" src="s" readonly="">
    <![CDATA[#+ 單身欄位關閉設定
PRIVATE FUNCTION axmt520_set_no_entry_b(p_cmd)
   DEFINE p_cmd   LIKE type_t.chr1   
   #add-point:set_no_entry_b段define
   {<point name="set_no_entry_b.define" edit="s"/>}
   #end add-point    
   #add-point:set_no_entry_b段define(客製用)
   {<point name="set_no_entry_b.define_customerization" edit="c"/>}
   #end add-point    
   
   IF p_cmd = 'u' AND g_chkey = 'N' THEN
      CALL cl_set_comp_entry("",FALSE)
      #add-point:set_no_entry_b段欄位控制
      {<point name="set_no_entry_b.field_control"/>}
      #end add-point 
   END IF 
   
   #add-point:set_no_entry_b段
   {<point name="set_no_entry_b.set_no_entry_b"/>}
   #end add-point     
END FUNCTION
]]>
  </section>
  <section id="axmt520.set_pk_array" ver="6" status="" src="s" readonly="">
    <![CDATA[   #應用 a51 樣板自動產生(Version:5)
#+ 給予pk_array內容
PRIVATE FUNCTION axmt520_set_pk_array()
   #add-point:set_pk_array段define
   {<point name="set_pk_array.define" edit="s"/>}
   #end add-point
   #add-point:set_pk_array段define
   {<point name="set_pk_array.define_customerization" edit="c"/>}
   #end add-point
   
   #add-point:set_pk_array段之前
   {<point name="set_pk_array.before"/>}
   #end add-point  
   
   #若l_ac<=0代表沒有資料
   IF l_ac <= 0 THEN
      RETURN
   END IF
   
   CALL g_pk_array.clear()
   LET g_pk_array[1].values = g_xmdg_m.xmdgdocno
   LET g_pk_array[1].column = 'xmdgdocno'
 
   
   #add-point:set_pk_array段之後
   {<point name="set_pk_array.after"/>}
   #end add-point  
   
END FUNCTION
 
 
]]>
  </section>
  <section id="axmt520.show" ver="34" status="" src="s" readonly="">
    <![CDATA[#+ 單頭資料重新顯示及單身資料重抓
PRIVATE FUNCTION axmt520_show()
   DEFINE l_ac_t    LIKE type_t.num10
   #add-point:show段define
   {<point name="show.define" edit="s"/>}
   #end add-point  
   #add-point:show段define(客製用)
   {<point name="show.define_customerization" edit="c"/>}
   #end add-point  
   
   #add-point:show段之前
   {<point name="show.before"/>}
   #end add-point
   
   
   
   IF g_bfill = "Y" THEN
      CALL axmt520_b_fill() #單身填充
      CALL axmt520_b_fill2('0') #單身填充
   END IF
     
   #帶出公用欄位reference值
   #應用 a12 樣板自動產生(Version:3)
 
 
   
   #顯示followup圖示
   #應用 a48 樣板自動產生(Version:2)
   CALL axmt520_set_pk_array()
   #add-point:ON ACTION agendum
   {<point name="show.follow_pic"/>}
   #END add-point
   CALL cl_user_overview_set_follow_pic()
  
 
 
   
   LET l_ac_t = l_ac
   
   #讀入ref值(單頭)
   #add-point:show段reference
   {<point name="show.head.reference"/>}
   #end add-point
   
   #遮罩相關處理
   LET g_xmdg_m_mask_o.* =  g_xmdg_m.*
   CALL axmt520_xmdg_t_mask()
   LET g_xmdg_m_mask_n.* =  g_xmdg_m.*
   
   #將資料輸出到畫面上
   DISPLAY BY NAME g_xmdg_m.xmdgdocno,g_xmdg_m.xmdgdocno_desc,g_xmdg_m.xmdgdocdt,g_xmdg_m.xmdg004,g_xmdg_m.xmdgsite, 
       g_xmdg_m.xmdg002,g_xmdg_m.xmdg002_desc,g_xmdg_m.xmdg003,g_xmdg_m.xmdg003_desc,g_xmdg_m.xmdgstus, 
       g_xmdg_m.xmdg001,g_xmdg_m.xmdg034,g_xmdg_m.xmdg005,g_xmdg_m.xmdg005_desc,g_xmdg_m.xmdg006,g_xmdg_m.xmdg006_desc, 
       g_xmdg_m.xmdg007,g_xmdg_m.xmdg007_desc,g_xmdg_m.xmdg202,g_xmdg_m.xmdg202_desc,g_xmdg_m.xmdg028, 
       g_xmdg_m.xmdg026,g_xmdg_m.xmdg026_desc,g_xmdg_m.xmdg027,g_xmdg_m.xmdg027_desc,g_xmdg_m.xmdg024, 
       g_xmdg_m.xmdg025,g_xmdg_m.xmdg030,g_xmdg_m.xmdg030_desc,g_xmdg_m.xmdg031,g_xmdg_m.xmdg031_desc, 
       g_xmdg_m.xmdg053,g_xmdg_m.xmdg056,g_xmdg_m.xmdg056_desc,g_xmdg_m.xmdg055,g_xmdg_m.xmdg054,g_xmdg_m.xmdg017, 
       g_xmdg_m.xmdg017_desc,g_xmdg_m.textedit1,g_xmdg_m.xmdg018,g_xmdg_m.xmdg018_desc,g_xmdg_m.xmdg019, 
       g_xmdg_m.xmdg019_desc,g_xmdg_m.xmdg020,g_xmdg_m.xmdg020_desc,g_xmdg_m.xmdg016,g_xmdg_m.xmdg016_desc, 
       g_xmdg_m.xmdg021,g_xmdg_m.xmdg022,g_xmdg_m.xmdg023,g_xmdg_m.xmdg023_desc,g_xmdg_m.xmdg008,g_xmdg_m.xmdg008_desc, 
       g_xmdg_m.xmdg009,g_xmdg_m.xmdg009_desc,g_xmdg_m.xmdg010,g_xmdg_m.xmdg010_desc,g_xmdg_m.xmdg011, 
       g_xmdg_m.xmdg012,g_xmdg_m.xmdg013,g_xmdg_m.xmdg013_desc,g_xmdg_m.xmdg032,g_xmdg_m.xmdg033,g_xmdg_m.xmdg014, 
       g_xmdg_m.xmdg014_desc,g_xmdg_m.xmdg015,g_xmdg_m.xmdgownid,g_xmdg_m.xmdgownid_desc,g_xmdg_m.xmdgowndp, 
       g_xmdg_m.xmdgowndp_desc,g_xmdg_m.xmdgcrtid,g_xmdg_m.xmdgcrtid_desc,g_xmdg_m.xmdgcrtdp,g_xmdg_m.xmdgcrtdp_desc, 
       g_xmdg_m.xmdgcrtdt,g_xmdg_m.xmdgmodid,g_xmdg_m.xmdgmodid_desc,g_xmdg_m.xmdgmoddt,g_xmdg_m.xmdgcnfid, 
       g_xmdg_m.xmdgcnfid_desc,g_xmdg_m.xmdgcnfdt
   
   #顯示狀態(stus)圖片
         #應用 a21 樣板自動產生(Version:2)
	  #根據當下狀態碼顯示圖片
      CASE g_xmdg_m.xmdgstus 
         WHEN "N"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/unconfirmed.png")
         WHEN "Y"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/confirmed.png")
         WHEN "A"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/approved.png")
         WHEN "D"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/withdraw.png")
         WHEN "R"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/rejection.png")
         WHEN "W"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/signing.png")
         WHEN "H"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/hold.png")
         WHEN "UH"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/unhold.png")
         WHEN "X"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/invalid.png")
         
      END CASE
 
 
   
   #讀入ref值(單身)
   FOR l_ac = 1 TO g_xmdh_d.getLength()
      #add-point:show段單身reference
      {<point name="show.body.reference"/>}
      #end add-point
   END FOR
   
   FOR l_ac = 1 TO g_xmdh2_d.getLength()
      #add-point:show段單身reference
      {<point name="show.body2.reference"/>}
      #end add-point
   END FOR
   FOR l_ac = 1 TO g_xmdh3_d.getLength()
      #add-point:show段單身reference
      {<point name="show.body3.reference"/>}
      #end add-point
   END FOR
   FOR l_ac = 1 TO g_xmdh4_d.getLength()
      #add-point:show段單身reference
      {<point name="show.body4.reference"/>}
      #end add-point
   END FOR
 
   
    
   
   #add-point:show段other
   {<point name="show.other"/>}
   #end add-point  
   
   LET l_ac = l_ac_t
   
   #移動上下筆可以連動切換資料
   CALL cl_show_fld_cont()     
 
   CALL axmt520_detail_show()
 
   #add-point:show段之後
   {<point name="show.after"/>}
   #end add-point
   
END FUNCTION
]]>
  </section>
  <section id="axmt520.signature" ver="22" status="" src="s" readonly="">
    <![CDATA[   #應用 a39 樣板自動產生(Version:7)
#+ BPM提交
PRIVATE FUNCTION axmt520_send()
   #add-point:send段define
   {<point name="send.define" edit="s"/>}
   #end add-point 
   #add-point:send段define(客製用)
   {<point name="send.define_customerization" edit="c"/>}
   #end add-point 
 
   #依據單據個數，需要指定所有單身條件為" 1=1"  (單身有幾個就要設幾個)
   LET g_wc2_table1 = " 1=1"
   LET g_wc2_table2 = " 1=1"
 
 
   CALL axmt520_show()
   CALL axmt520_set_pk_array()
   
   #add-point: 初始化的ADP
   {<point name="send.before_send" />}
   #end add-point
   
   #公用變數初始化
   CALL cl_bpm_data_init()
                  
   #依照主檔/單身個數產生 CALL cl_bpm_set_master_data() / cl_bpm_set_detail_data() 
   #單頭固定為 CALL cl_bpm_set_master_data(util.JSONObject.fromFGL(xxxx)) 傳入參數: (1)單頭陣列  ; 回傳值: 無
   CALL cl_bpm_set_master_data(util.JSONObject.fromFGL(g_xmdg_m))
                              
   #單身固定為 CALL cl_bpm_set_detail_data(s_detailX, util.JSONArray.fromFGL(xxxx)) 傳入參數: (1)單身SR名稱  (2)單身陣列  ; 回傳值: 無
   CALL cl_bpm_set_detail_data("s_detail1", util.JSONArray.fromFGL(g_xmdh_d))
   CALL cl_bpm_set_detail_data("s_detail2", util.JSONArray.fromFGL(g_xmdh2_d))
   CALL cl_bpm_set_detail_data("s_detail3", util.JSONArray.fromFGL(g_xmdh3_d))
   CALL cl_bpm_set_detail_data("s_detail4", util.JSONArray.fromFGL(g_xmdh4_d))
 
 
   # cl_bpm_cli() 裡有包含以前的aws_condition()=>送簽資料檢核和更新單據狀況碼為'W'
   # cl_bpm_cli() 傳入參數:無  ;  回傳值: 0 開單失敗; 1 開單成功
 
   #add-point: 提交前的ADP
   {<point name="send.before_cli" />}
   #end add-point
 
   #開單失敗
   IF NOT cl_bpm_cli() THEN 
      RETURN FALSE
   END IF
 
   #add-point: 提交後的ADP
   {<point name="send.after_send" />}
   #end add-point
 
   #此段落不需要刪除資料,但是否需要refresh圖片樣式???
   #CALL axmt520_ui_browser_refresh()
 
   #重新指定此筆單據資料狀態圖片=>送簽中
   LET g_browser[g_current_idx].b_statepic = "stus/16/signing.png"
 
   #重新取得單頭/單身資料,DISPLAY在畫面上
   CALL axmt520_ui_headershow()
   CALL axmt520_ui_detailshow()
 
   RETURN TRUE
   
END FUNCTION
 
 
#應用 a40 樣板自動產生(Version:4)
#+ BPM抽單
PRIVATE FUNCTION axmt520_draw_out()
   #add-point:draw段define
   {<point name="draw.define" edit="s"/>}
   #end add-point
   #add-point:draw段define
   {<point name="draw.define_customerization" edit="c"/>}
   #end add-point
 
   #抽單失敗
   IF NOT cl_bpm_draw_out() THEN 
      RETURN FALSE
   END IF    
          
   #重新指定此筆單據資料狀態圖片=>抽單
   LET g_browser[g_current_row].b_statepic = "stus/16/draw_out.png"
 
   #重新取得單頭/單身資料,DISPLAY在畫面上
   CALL axmt520_ui_headershow()  
   CALL axmt520_ui_detailshow()
 
   RETURN TRUE
   
END FUNCTION
 
 
 
]]>
  </section>
  <section id="axmt520.state_change" ver="31" status="" src="s" readonly="">
    <![CDATA[   #應用 a09 樣板自動產生(Version:12)
#+ 確認碼變更 
PRIVATE FUNCTION axmt520_statechange()
   DEFINE lc_state LIKE type_t.chr5
   #add-point:statechange段define
   {<point name="statechange.define" edit="s"/>}
   #end add-point  
   #add-point:statechange段define(客製用)
   {<point name="statechange.define_customerization" edit="c"/>}
   #end add-point  
   
   #add-point:statechange段開始前
   {<point name="statechange.before"/>}
   #end add-point  
   
   ERROR ""     #清空畫面右下側ERROR區塊
 
   IF g_xmdg_m.xmdgdocno IS NULL
 
   THEN
      INITIALIZE g_errparam TO NULL 
      LET g_errparam.extend = "" 
      LET g_errparam.code   = "std-00003" 
      LET g_errparam.popup  = FALSE 
      CALL cl_err()
      RETURN
   END IF
 
   CALL s_transaction_begin()
   
   OPEN axmt520_cl USING g_enterprise,g_xmdg_m.xmdgdocno
   IF STATUS THEN
      INITIALIZE g_errparam TO NULL 
      LET g_errparam.extend = "OPEN axmt520_cl:" 
      LET g_errparam.code   = STATUS 
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
      CLOSE axmt520_cl
      CALL s_transaction_end('N','0')
      RETURN
   END IF
   
   #顯示最新的資料
   EXECUTE axmt520_master_referesh USING g_xmdg_m.xmdgdocno INTO g_xmdg_m.xmdgdocno,g_xmdg_m.xmdgdocdt, 
       g_xmdg_m.xmdg004,g_xmdg_m.xmdgsite,g_xmdg_m.xmdg002,g_xmdg_m.xmdg003,g_xmdg_m.xmdgstus,g_xmdg_m.xmdg001, 
       g_xmdg_m.xmdg034,g_xmdg_m.xmdg005,g_xmdg_m.xmdg006,g_xmdg_m.xmdg007,g_xmdg_m.xmdg202,g_xmdg_m.xmdg028, 
       g_xmdg_m.xmdg026,g_xmdg_m.xmdg027,g_xmdg_m.xmdg024,g_xmdg_m.xmdg025,g_xmdg_m.xmdg030,g_xmdg_m.xmdg031, 
       g_xmdg_m.xmdg053,g_xmdg_m.xmdg056,g_xmdg_m.xmdg055,g_xmdg_m.xmdg054,g_xmdg_m.xmdg017,g_xmdg_m.xmdg018, 
       g_xmdg_m.xmdg019,g_xmdg_m.xmdg020,g_xmdg_m.xmdg016,g_xmdg_m.xmdg021,g_xmdg_m.xmdg022,g_xmdg_m.xmdg023, 
       g_xmdg_m.xmdg008,g_xmdg_m.xmdg009,g_xmdg_m.xmdg010,g_xmdg_m.xmdg011,g_xmdg_m.xmdg012,g_xmdg_m.xmdg013, 
       g_xmdg_m.xmdg032,g_xmdg_m.xmdg033,g_xmdg_m.xmdg014,g_xmdg_m.xmdg015,g_xmdg_m.xmdgownid,g_xmdg_m.xmdgowndp, 
       g_xmdg_m.xmdgcrtid,g_xmdg_m.xmdgcrtdp,g_xmdg_m.xmdgcrtdt,g_xmdg_m.xmdgmodid,g_xmdg_m.xmdgmoddt, 
       g_xmdg_m.xmdgcnfid,g_xmdg_m.xmdgcnfdt,g_xmdg_m.xmdg002_desc,g_xmdg_m.xmdg003_desc,g_xmdg_m.xmdg005_desc, 
       g_xmdg_m.xmdg006_desc,g_xmdg_m.xmdg007_desc,g_xmdg_m.xmdg202_desc,g_xmdg_m.xmdg026_desc,g_xmdg_m.xmdg027_desc, 
       g_xmdg_m.xmdg030_desc,g_xmdg_m.xmdg031_desc,g_xmdg_m.xmdg056_desc,g_xmdg_m.xmdg017_desc,g_xmdg_m.xmdg018_desc, 
       g_xmdg_m.xmdg016_desc,g_xmdg_m.xmdg008_desc,g_xmdg_m.xmdg009_desc,g_xmdg_m.xmdg014_desc,g_xmdg_m.xmdgownid_desc, 
       g_xmdg_m.xmdgowndp_desc,g_xmdg_m.xmdgcrtid_desc,g_xmdg_m.xmdgcrtdp_desc,g_xmdg_m.xmdgmodid_desc, 
       g_xmdg_m.xmdgcnfid_desc
 
   #檢查是否允許此動作
   IF NOT axmt520_action_chk() THEN
      CLOSE axmt520_cl
      CALL s_transaction_end('N','0')
      RETURN
   END IF
 
   #將資料顯示到畫面上
   DISPLAY BY NAME g_xmdg_m.xmdgdocno,g_xmdg_m.xmdgdocno_desc,g_xmdg_m.xmdgdocdt,g_xmdg_m.xmdg004,g_xmdg_m.xmdgsite, 
       g_xmdg_m.xmdg002,g_xmdg_m.xmdg002_desc,g_xmdg_m.xmdg003,g_xmdg_m.xmdg003_desc,g_xmdg_m.xmdgstus, 
       g_xmdg_m.xmdg001,g_xmdg_m.xmdg034,g_xmdg_m.xmdg005,g_xmdg_m.xmdg005_desc,g_xmdg_m.xmdg006,g_xmdg_m.xmdg006_desc, 
       g_xmdg_m.xmdg007,g_xmdg_m.xmdg007_desc,g_xmdg_m.xmdg202,g_xmdg_m.xmdg202_desc,g_xmdg_m.xmdg028, 
       g_xmdg_m.xmdg026,g_xmdg_m.xmdg026_desc,g_xmdg_m.xmdg027,g_xmdg_m.xmdg027_desc,g_xmdg_m.xmdg024, 
       g_xmdg_m.xmdg025,g_xmdg_m.xmdg030,g_xmdg_m.xmdg030_desc,g_xmdg_m.xmdg031,g_xmdg_m.xmdg031_desc, 
       g_xmdg_m.xmdg053,g_xmdg_m.xmdg056,g_xmdg_m.xmdg056_desc,g_xmdg_m.xmdg055,g_xmdg_m.xmdg054,g_xmdg_m.xmdg017, 
       g_xmdg_m.xmdg017_desc,g_xmdg_m.textedit1,g_xmdg_m.xmdg018,g_xmdg_m.xmdg018_desc,g_xmdg_m.xmdg019, 
       g_xmdg_m.xmdg019_desc,g_xmdg_m.xmdg020,g_xmdg_m.xmdg020_desc,g_xmdg_m.xmdg016,g_xmdg_m.xmdg016_desc, 
       g_xmdg_m.xmdg021,g_xmdg_m.xmdg022,g_xmdg_m.xmdg023,g_xmdg_m.xmdg023_desc,g_xmdg_m.xmdg008,g_xmdg_m.xmdg008_desc, 
       g_xmdg_m.xmdg009,g_xmdg_m.xmdg009_desc,g_xmdg_m.xmdg010,g_xmdg_m.xmdg010_desc,g_xmdg_m.xmdg011, 
       g_xmdg_m.xmdg012,g_xmdg_m.xmdg013,g_xmdg_m.xmdg013_desc,g_xmdg_m.xmdg032,g_xmdg_m.xmdg033,g_xmdg_m.xmdg014, 
       g_xmdg_m.xmdg014_desc,g_xmdg_m.xmdg015,g_xmdg_m.xmdgownid,g_xmdg_m.xmdgownid_desc,g_xmdg_m.xmdgowndp, 
       g_xmdg_m.xmdgowndp_desc,g_xmdg_m.xmdgcrtid,g_xmdg_m.xmdgcrtid_desc,g_xmdg_m.xmdgcrtdp,g_xmdg_m.xmdgcrtdp_desc, 
       g_xmdg_m.xmdgcrtdt,g_xmdg_m.xmdgmodid,g_xmdg_m.xmdgmodid_desc,g_xmdg_m.xmdgmoddt,g_xmdg_m.xmdgcnfid, 
       g_xmdg_m.xmdgcnfid_desc,g_xmdg_m.xmdgcnfdt
 
   CASE g_xmdg_m.xmdgstus
      WHEN "N"
         CALL gfrm_curr.setElementImage("statechange", "stus/32/unconfirmed.png")
      WHEN "Y"
         CALL gfrm_curr.setElementImage("statechange", "stus/32/confirmed.png")
      WHEN "A"
         CALL gfrm_curr.setElementImage("statechange", "stus/32/approved.png")
      WHEN "D"
         CALL gfrm_curr.setElementImage("statechange", "stus/32/withdraw.png")
      WHEN "R"
         CALL gfrm_curr.setElementImage("statechange", "stus/32/rejection.png")
      WHEN "W"
         CALL gfrm_curr.setElementImage("statechange", "stus/32/signing.png")
      WHEN "H"
         CALL gfrm_curr.setElementImage("statechange", "stus/32/hold.png")
      WHEN "UH"
         CALL gfrm_curr.setElementImage("statechange", "stus/32/unhold.png")
      WHEN "X"
         CALL gfrm_curr.setElementImage("statechange", "stus/32/invalid.png")
      
   END CASE
 
   #add-point:資料刷新後
   {<point name="statechange.after_refresh"/>}
   #end add-point
 
   MENU "" ATTRIBUTES (STYLE="popup")
      BEFORE MENU
         HIDE OPTION "approved"
         HIDE OPTION "rejection"
         CASE g_xmdg_m.xmdgstus
            
            WHEN "N"
               HIDE OPTION "unconfirmed"
            WHEN "Y"
               HIDE OPTION "confirmed"
            WHEN "A"
               HIDE OPTION "approved"
            WHEN "D"
               HIDE OPTION "withdraw"
            WHEN "R"
               HIDE OPTION "rejection"
            WHEN "W"
               HIDE OPTION "signing"
            WHEN "H"
               HIDE OPTION "hold"
            WHEN "UH"
               HIDE OPTION "unhold"
            WHEN "X"
               HIDE OPTION "invalid"
         END CASE
     
      #add-point:menu前
      {<point name="statechange.before_menu"/>}
      #end add-point
      
      #應用 a36 樣板自動產生(Version:4)
      #提交
      ON ACTION signing
         IF cl_auth_chk_act("signing") THEN
            IF NOT axmt520_send() THEN
               CALL s_transaction_end('N','0')
            ELSE
               CALL s_transaction_end('Y','0')
            END IF
            #因應簽核行為, 該動作完成後不再進行後續處理
            #於此處直接返回
            CLOSE axmt520_cl
            RETURN
         END IF
    
      #抽單
      ON ACTION withdraw
         IF cl_auth_chk_act("withdraw") THEN
            IF NOT axmt520_draw_out() THEN
               CALL s_transaction_end('N','0')
            ELSE
               CALL s_transaction_end('Y','0')
            END IF
            #因應簽核行為, 該動作完成後不再進行後續處理
            #於此處直接返回
            CLOSE axmt520_cl
            RETURN
         END IF
 
 
	  
      ON ACTION unconfirmed
         IF cl_auth_chk_act("unconfirmed") THEN
            LET lc_state = "N"
            #add-point:action控制
            {<point name="statechange.unconfirmed"/>}
            #end add-point
         END IF
         EXIT MENU
      ON ACTION confirmed
         IF cl_auth_chk_act("confirmed") THEN
            LET lc_state = "Y"
            #add-point:action控制
            {<point name="statechange.confirmed"/>}
            #end add-point
         END IF
         EXIT MENU
      ON ACTION approved
         IF cl_auth_chk_act("approved") THEN
            LET lc_state = "A"
            #add-point:action控制
            {<point name="statechange.approved"/>}
            #end add-point
         END IF
         EXIT MENU
      #ON ACTION withdraw
      #   IF cl_auth_chk_act("withdraw") THEN
      #      LET lc_state = "D"
      #      #add-point:action控制
      #      {<point name="statechange.withdraw"/>}
      #      #end add-point
      #   END IF
      #   EXIT MENU
      ON ACTION rejection
         IF cl_auth_chk_act("rejection") THEN
            LET lc_state = "R"
            #add-point:action控制
            {<point name="statechange.rejection"/>}
            #end add-point
         END IF
         EXIT MENU
      #ON ACTION signing
      #   IF cl_auth_chk_act("signing") THEN
      #      LET lc_state = "W"
      #      #add-point:action控制
      #      {<point name="statechange.signing"/>}
      #      #end add-point
      #   END IF
      #   EXIT MENU
      ON ACTION hold
         IF cl_auth_chk_act("hold") THEN
            LET lc_state = "H"
            #add-point:action控制
            {<point name="statechange.hold"/>}
            #end add-point
         END IF
         EXIT MENU
      ON ACTION unhold
         IF cl_auth_chk_act("unhold") THEN
            LET lc_state = "UH"
            #add-point:action控制
            {<point name="statechange.unhold"/>}
            #end add-point
         END IF
         EXIT MENU
      ON ACTION invalid
         IF cl_auth_chk_act("invalid") THEN
            LET lc_state = "X"
            #add-point:action控制
            {<point name="statechange.invalid"/>}
            #end add-point
         END IF
         EXIT MENU
 
      #add-point:stus控制
      {<point name="statechange.more_control"/>}
      #end add-point
      
   END MENU
   
   #確認被選取的狀態碼在清單中
   IF (lc_state <> "N" 
      AND lc_state <> "Y"
      AND lc_state <> "A"
      AND lc_state <> "D"
      AND lc_state <> "R"
      AND lc_state <> "W"
      AND lc_state <> "H"
      AND lc_state <> "UH"
      AND lc_state <> "X"
      ) OR 
      g_xmdg_m.xmdgstus = lc_state OR cl_null(lc_state) THEN
      CLOSE axmt520_cl
      CALL s_transaction_end('N','0')
      RETURN
   END IF
   
   #add-point:stus修改前
   {<point name="statechange.b_update"/>}
   #end add-point
   
   LET g_xmdg_m.xmdgmodid = g_user
   LET g_xmdg_m.xmdgmoddt = cl_get_current()
   LET g_xmdg_m.xmdgstus = lc_state
   
   #異動狀態碼欄位/修改人/修改日期
   UPDATE xmdg_t 
      SET (xmdgstus,xmdgmodid,xmdgmoddt) 
        = (g_xmdg_m.xmdgstus,g_xmdg_m.xmdgmodid,g_xmdg_m.xmdgmoddt)     
    WHERE xmdgent = g_enterprise AND xmdgdocno = g_xmdg_m.xmdgdocno
 
    
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL 
      LET g_errparam.extend = "" 
      LET g_errparam.code   = SQLCA.sqlcode 
      LET g_errparam.popup  = FALSE 
      CALL cl_err()
   ELSE
      CASE lc_state
         WHEN "N"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/unconfirmed.png")
         WHEN "Y"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/confirmed.png")
         WHEN "A"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/approved.png")
         WHEN "D"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/withdraw.png")
         WHEN "R"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/rejection.png")
         WHEN "W"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/signing.png")
         WHEN "H"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/hold.png")
         WHEN "UH"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/unhold.png")
         WHEN "X"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/invalid.png")
         
      END CASE
    
      #撈取異動後的資料
      EXECUTE axmt520_master_referesh USING g_xmdg_m.xmdgdocno INTO g_xmdg_m.xmdgdocno,g_xmdg_m.xmdgdocdt, 
          g_xmdg_m.xmdg004,g_xmdg_m.xmdgsite,g_xmdg_m.xmdg002,g_xmdg_m.xmdg003,g_xmdg_m.xmdgstus,g_xmdg_m.xmdg001, 
          g_xmdg_m.xmdg034,g_xmdg_m.xmdg005,g_xmdg_m.xmdg006,g_xmdg_m.xmdg007,g_xmdg_m.xmdg202,g_xmdg_m.xmdg028, 
          g_xmdg_m.xmdg026,g_xmdg_m.xmdg027,g_xmdg_m.xmdg024,g_xmdg_m.xmdg025,g_xmdg_m.xmdg030,g_xmdg_m.xmdg031, 
          g_xmdg_m.xmdg053,g_xmdg_m.xmdg056,g_xmdg_m.xmdg055,g_xmdg_m.xmdg054,g_xmdg_m.xmdg017,g_xmdg_m.xmdg018, 
          g_xmdg_m.xmdg019,g_xmdg_m.xmdg020,g_xmdg_m.xmdg016,g_xmdg_m.xmdg021,g_xmdg_m.xmdg022,g_xmdg_m.xmdg023, 
          g_xmdg_m.xmdg008,g_xmdg_m.xmdg009,g_xmdg_m.xmdg010,g_xmdg_m.xmdg011,g_xmdg_m.xmdg012,g_xmdg_m.xmdg013, 
          g_xmdg_m.xmdg032,g_xmdg_m.xmdg033,g_xmdg_m.xmdg014,g_xmdg_m.xmdg015,g_xmdg_m.xmdgownid,g_xmdg_m.xmdgowndp, 
          g_xmdg_m.xmdgcrtid,g_xmdg_m.xmdgcrtdp,g_xmdg_m.xmdgcrtdt,g_xmdg_m.xmdgmodid,g_xmdg_m.xmdgmoddt, 
          g_xmdg_m.xmdgcnfid,g_xmdg_m.xmdgcnfdt,g_xmdg_m.xmdg002_desc,g_xmdg_m.xmdg003_desc,g_xmdg_m.xmdg005_desc, 
          g_xmdg_m.xmdg006_desc,g_xmdg_m.xmdg007_desc,g_xmdg_m.xmdg202_desc,g_xmdg_m.xmdg026_desc,g_xmdg_m.xmdg027_desc, 
          g_xmdg_m.xmdg030_desc,g_xmdg_m.xmdg031_desc,g_xmdg_m.xmdg056_desc,g_xmdg_m.xmdg017_desc,g_xmdg_m.xmdg018_desc, 
          g_xmdg_m.xmdg016_desc,g_xmdg_m.xmdg008_desc,g_xmdg_m.xmdg009_desc,g_xmdg_m.xmdg014_desc,g_xmdg_m.xmdgownid_desc, 
          g_xmdg_m.xmdgowndp_desc,g_xmdg_m.xmdgcrtid_desc,g_xmdg_m.xmdgcrtdp_desc,g_xmdg_m.xmdgmodid_desc, 
          g_xmdg_m.xmdgcnfid_desc
      
      #將資料顯示到畫面上
      DISPLAY BY NAME g_xmdg_m.xmdgdocno,g_xmdg_m.xmdgdocno_desc,g_xmdg_m.xmdgdocdt,g_xmdg_m.xmdg004, 
          g_xmdg_m.xmdgsite,g_xmdg_m.xmdg002,g_xmdg_m.xmdg002_desc,g_xmdg_m.xmdg003,g_xmdg_m.xmdg003_desc, 
          g_xmdg_m.xmdgstus,g_xmdg_m.xmdg001,g_xmdg_m.xmdg034,g_xmdg_m.xmdg005,g_xmdg_m.xmdg005_desc, 
          g_xmdg_m.xmdg006,g_xmdg_m.xmdg006_desc,g_xmdg_m.xmdg007,g_xmdg_m.xmdg007_desc,g_xmdg_m.xmdg202, 
          g_xmdg_m.xmdg202_desc,g_xmdg_m.xmdg028,g_xmdg_m.xmdg026,g_xmdg_m.xmdg026_desc,g_xmdg_m.xmdg027, 
          g_xmdg_m.xmdg027_desc,g_xmdg_m.xmdg024,g_xmdg_m.xmdg025,g_xmdg_m.xmdg030,g_xmdg_m.xmdg030_desc, 
          g_xmdg_m.xmdg031,g_xmdg_m.xmdg031_desc,g_xmdg_m.xmdg053,g_xmdg_m.xmdg056,g_xmdg_m.xmdg056_desc, 
          g_xmdg_m.xmdg055,g_xmdg_m.xmdg054,g_xmdg_m.xmdg017,g_xmdg_m.xmdg017_desc,g_xmdg_m.textedit1, 
          g_xmdg_m.xmdg018,g_xmdg_m.xmdg018_desc,g_xmdg_m.xmdg019,g_xmdg_m.xmdg019_desc,g_xmdg_m.xmdg020, 
          g_xmdg_m.xmdg020_desc,g_xmdg_m.xmdg016,g_xmdg_m.xmdg016_desc,g_xmdg_m.xmdg021,g_xmdg_m.xmdg022, 
          g_xmdg_m.xmdg023,g_xmdg_m.xmdg023_desc,g_xmdg_m.xmdg008,g_xmdg_m.xmdg008_desc,g_xmdg_m.xmdg009, 
          g_xmdg_m.xmdg009_desc,g_xmdg_m.xmdg010,g_xmdg_m.xmdg010_desc,g_xmdg_m.xmdg011,g_xmdg_m.xmdg012, 
          g_xmdg_m.xmdg013,g_xmdg_m.xmdg013_desc,g_xmdg_m.xmdg032,g_xmdg_m.xmdg033,g_xmdg_m.xmdg014, 
          g_xmdg_m.xmdg014_desc,g_xmdg_m.xmdg015,g_xmdg_m.xmdgownid,g_xmdg_m.xmdgownid_desc,g_xmdg_m.xmdgowndp, 
          g_xmdg_m.xmdgowndp_desc,g_xmdg_m.xmdgcrtid,g_xmdg_m.xmdgcrtid_desc,g_xmdg_m.xmdgcrtdp,g_xmdg_m.xmdgcrtdp_desc, 
          g_xmdg_m.xmdgcrtdt,g_xmdg_m.xmdgmodid,g_xmdg_m.xmdgmodid_desc,g_xmdg_m.xmdgmoddt,g_xmdg_m.xmdgcnfid, 
          g_xmdg_m.xmdgcnfid_desc,g_xmdg_m.xmdgcnfdt
   END IF
 
   #add-point:stus修改後
   {<point name="statechange.a_update"/>}
   #end add-point
 
   #add-point:statechange段結束前
   {<point name="statechange.after"/>}
   #end add-point  
 
   CLOSE axmt520_cl
   CALL s_transaction_end('Y','0')
 
   #功能已完成,通報訊息中心
   CALL axmt520_msgcentre_notify('statechange:'||lc_state)
   
END FUNCTION
 
 
]]>
  </section>
  <section id="axmt520.status_show" ver="1" status="" src="s" readonly="">
    <![CDATA[PRIVATE FUNCTION axmt520_status_show()
   #add-point:status_show段define
   {<point name="status_show.define" edit="s"/>}
   #end add-point
   #add-point:status_show段define(客製用)
   {<point name="status_show.define_customerization" edit="c"/>}
   #end add-point
   
   #add-point:status_show段status_show
   {<point name="status_show.status_show"/>}
   #end add-point
END FUNCTION
]]>
  </section>
  <section id="axmt520.ui_browser_refresh" ver="10" status="" src="s" readonly="">
    <![CDATA[#+ 瀏覽頁簽資料重新顯示
PRIVATE FUNCTION axmt520_ui_browser_refresh()
   DEFINE l_i  LIKE type_t.num10
   #add-point:ui_browser_refresh段define
   {<point name="ui_browser_refresh.define" edit="s"/>}
   #end add-point    
   #add-point:ui_browser_refresh段define(客製用)
   {<point name="ui_browser_refresh.define_customerization" edit="c"/>}
   #end add-point    
   
   LET g_browser_cnt = g_browser.getLength()
   LET g_header_cnt  = g_browser.getLength()
   FOR l_i =1 TO g_browser.getLength()
      IF g_browser[l_i].b_xmdgdocno = g_xmdg_m.xmdgdocno 
 
         THEN
         CALL g_browser.deleteElement(l_i)
         EXIT FOR
      END IF
   END FOR
   LET g_browser_cnt = g_browser_cnt - 1
   LET g_header_cnt = g_header_cnt - 1
    
   #若無資料則關閉相關功能
   IF g_browser_cnt = 0 THEN
      CALL cl_set_act_visible("statechange,modify,modify_detail,delete,reproduce,mainhidden", FALSE)
      CALL cl_navigator_setting(0,0)
      CLEAR FORM
   ELSE
      CALL cl_set_act_visible("mainhidden", TRUE)
   END IF
   
   #add-point:ui_browser_refresh段after
   {<point name="ui_browser_refresh.after"/>}
   #end add-point    
   
END FUNCTION
]]>
  </section>
  <section id="axmt520.ui_detailshow" ver="4" status="" src="s" readonly="">
    <![CDATA[#+ 單身資料重新顯示
PRIVATE FUNCTION axmt520_ui_detailshow()
   #add-point:ui_detailshow段define
   {<point name="ui_detailshow.define" edit="s"/>}
   #end add-point    
   #add-point:ui_detailshow段define(客製用)
   {<point name="ui_detailshow.define_customerization" edit="c"/>}
   #end add-point    
   
   #add-point:ui_detailshow段before
   {<point name="ui_detailshow.before"/>}
   #end add-point    
   
   IF g_curr_diag IS NOT NULL THEN
      CALL g_curr_diag.setCurrentRow("s_detail1",g_detail_idx)      
      CALL g_curr_diag.setCurrentRow("s_detail2",g_detail_idx)
      CALL g_curr_diag.setCurrentRow("s_detail3",g_detail_idx)
      CALL g_curr_diag.setCurrentRow("s_detail4",g_detail_idx)
 
   END IF
   
   #add-point:ui_detailshow段after
   {<point name="ui_detailshow.after"/>}
   #end add-point    
   
END FUNCTION
]]>
  </section>
  <section id="axmt520.ui_dialog" ver="80" status="" src="s" readonly="">
    <![CDATA[#+ 功能選單
PRIVATE FUNCTION axmt520_ui_dialog()
   DEFINE li_idx     LIKE type_t.num10
   DEFINE ls_wc      STRING
   DEFINE lb_first   BOOLEAN
   DEFINE la_wc      DYNAMIC ARRAY OF RECORD
          tableid    STRING,
          wc         STRING
          END RECORD
   DEFINE la_param   RECORD
          prog       STRING,
          actionid   STRING,
          background LIKE type_t.chr1,
          param      DYNAMIC ARRAY OF STRING
          END RECORD
   DEFINE ls_js      STRING
   DEFINE la_output  DYNAMIC ARRAY OF STRING   #報表元件鬆耦合使用
   #add-point:ui_dialog段define
   {<point name="ui_dialog.define" edit="s"/>}
   #end add-point
   #add-point:ui_dialog段define(客製用)
   {<point name="ui_dialog.define_customerization" edit="c"/>}
   #end add-point
   
   CALL cl_set_act_visible("accept,cancel", FALSE)
 
   #因應查詢方案進行處理
   IF g_default THEN
      CALL gfrm_curr.setElementHidden("mainlayout",0)
      CALL gfrm_curr.setElementHidden("worksheet",1)
      LET g_main_hidden = 0
   ELSE
      CALL gfrm_curr.setElementHidden("mainlayout",1)
      CALL gfrm_curr.setElementHidden("worksheet",0)
      LET g_main_hidden = 1
   END IF
   
   #action default動作
   #應用 a42 樣板自動產生(Version:2)
   #進入程式時預設執行的動作
   CASE g_actdefault
      WHEN "insert"
         LET g_action_choice="insert"
         LET g_actdefault = ""
         IF cl_auth_chk_act("insert") THEN
            CALL axmt520_insert()
            #add-point:ON ACTION insert
            {<point name="menu.default.insert" />}
            #END add-point
         END IF
 
      #add-point:action default自訂
      {<point name="ui_dialog.action_default"/>}
      #end add-point
      OTHERWISE
   END CASE
 
 
   
   LET lb_first = TRUE
   
   #add-point:ui_dialog段before dialog 
   {<point name="ui_dialog.before_dialog"/>}
   #end add-point
   
   WHILE TRUE 
   
      IF g_action_choice = "logistics" THEN
         #清除畫面及相關資料
         CLEAR FORM
         CALL g_browser.clear()       
         INITIALIZE g_xmdg_m.* TO NULL
         CALL g_xmdh_d.clear()
         CALL g_xmdh2_d.clear()
         CALL g_xmdh3_d.clear()
         CALL g_xmdh4_d.clear()
 
         LET g_wc  = ' 1=2'
         LET g_wc2 = ' 1=1'
         LET g_action_choice = ""
         CALL axmt520_init()
      END IF
   
      CALL lib_cl_dlg.cl_dlg_before_display()
            
      DIALOG ATTRIBUTES(UNBUFFERED,FIELD ORDER FORM)
 
         #左側瀏覽頁簽
         DISPLAY ARRAY g_browser TO s_browse.* ATTRIBUTES(COUNT=g_header_cnt)
            BEFORE ROW
               #回歸舊筆數位置 (回到當時異動的筆數)
               LET g_current_idx = DIALOG.getCurrentRow("s_browse")
               IF g_current_row > 1 AND g_current_idx = 1 AND g_current_sw = FALSE THEN
                  CALL DIALOG.setCurrentRow("s_browse",g_current_row)
                  LET g_current_idx = g_current_row
               END IF
               LET g_current_row = g_current_idx #目前指標
               LET g_current_sw = TRUE
         
               IF g_current_idx > g_browser.getLength() THEN
                  LET g_current_idx = g_browser.getLength()
               END IF 
               
               CALL axmt520_fetch('') # reload data
               LET l_ac = 1
               CALL axmt520_ui_detailshow() #Setting the current row 
         
               CALL axmt520_idx_chk()
               #NEXT FIELD xmdhseq
         
               ON ACTION qbefield_user   #欄位隱藏設定 
                  LET g_action_choice="qbefield_user"
                  CALL cl_ui_qbefield_user()
         END DISPLAY
    
         DISPLAY ARRAY g_xmdh_d TO s_detail1.* ATTRIBUTES(COUNT=g_rec_b) #page1  
    
            BEFORE ROW
               #顯示單身筆數
               CALL axmt520_idx_chk()
               #確定當下選擇的筆數
               LET l_ac = DIALOG.getCurrentRow("s_detail1")
               LET g_detail_idx = l_ac
               
               #add-point:page1, before row動作
               {<point name="ui_dialog.page1.before_row"/>}
               #end add-point
               
            BEFORE DISPLAY
               #如果一直都在單身1則控制筆數位置
               IF g_loc = 'm' THEN
                  CALL FGL_SET_ARR_CURR(g_detail_idx)
               END IF
               LET g_loc = 'm'
               LET l_ac = DIALOG.getCurrentRow("s_detail1")
               LET g_current_page = 1
               #顯示單身筆數
               CALL axmt520_idx_chk()
               #add-point:page1自定義行為
               {<point name="ui_dialog.page1.before_display"/>}
               #end add-point
               
            #自訂ACTION(detail_show,page_1)
            
 
         #應用 a43 樣板自動產生(Version:2)
         ON ACTION detail_qrystr
               MENU "" ATTRIBUTE(STYLE="popup")
                  #add-point:ON ACTION detail_qrystr相關動作
                  {<point name="menu.detail_show.page1_sub.detail_qrystr" />}
                  #END add-point
                                 #應用 a43 樣板自動產生(Version:2)
               ON ACTION prog_axmt500
                  LET g_action_choice="prog_axmt500"
                  IF cl_auth_chk_act("prog_axmt500") THEN
                     
                     #add-point:ON ACTION prog_axmt500
                     {<point name="menu.detail_show.page1_sub.prog_axmt500" />}
                     #END add-point
                     
                  END IF
 
 
 
               END MENU
 
 
               #add-point:ON ACTION detail_qrystr
               {<point name="menu.detail_show.page1.detail_qrystr" />}
               #END add-point
 
 
 
               
            #add-point:page1自定義行為
            {<point name="ui_dialog.page1.action"/>}
            #end add-point
               
         END DISPLAY
        
         #第一階單身段落
         DISPLAY ARRAY g_xmdh2_d TO s_detail2.* ATTRIBUTES(COUNT=g_rec_b)  
    
            BEFORE ROW
               #顯示單身筆數
               CALL axmt520_idx_chk()
               LET l_ac = DIALOG.getCurrentRow("s_detail2")
               LET g_detail_idx = l_ac
               
               #add-point:page2, before row動作
               {<point name="ui_dialog.body2.before_row"/>}
               #end add-point
               
            BEFORE DISPLAY
               #如果一直都在單身1則控制筆數位置
               IF g_loc = 'm' THEN
                  CALL FGL_SET_ARR_CURR(g_detail_idx)
               END IF
               LET g_loc = 'm'
               LET l_ac = DIALOG.getCurrentRow("s_detail2")
               LET g_current_page = 2
               #顯示單身筆數
               CALL axmt520_idx_chk()
               #add-point:page2自定義行為
               {<point name="ui_dialog.body2.before_display"/>}
               #end add-point
      
            #自訂ACTION(detail_show,page_2)
            
         
            #add-point:page2自定義行為
            {<point name="ui_dialog.body2.action"/>}
            #end add-point
         
         END DISPLAY
         #第一階單身段落
         DISPLAY ARRAY g_xmdh3_d TO s_detail3.* ATTRIBUTES(COUNT=g_rec_b)  
    
            BEFORE ROW
               #顯示單身筆數
               CALL axmt520_idx_chk()
               LET l_ac = DIALOG.getCurrentRow("s_detail3")
               LET g_detail_idx = l_ac
               
               #add-point:page3, before row動作
               {<point name="ui_dialog.body3.before_row"/>}
               #end add-point
               
            BEFORE DISPLAY
               #如果一直都在單身1則控制筆數位置
               IF g_loc = 'm' THEN
                  CALL FGL_SET_ARR_CURR(g_detail_idx)
               END IF
               LET g_loc = 'm'
               LET l_ac = DIALOG.getCurrentRow("s_detail3")
               LET g_current_page = 3
               #顯示單身筆數
               CALL axmt520_idx_chk()
               #add-point:page3自定義行為
               {<point name="ui_dialog.body3.before_display"/>}
               #end add-point
      
            #自訂ACTION(detail_show,page_3)
            
         
            #add-point:page3自定義行為
            {<point name="ui_dialog.body3.action"/>}
            #end add-point
         
         END DISPLAY
         #第一階單身段落
         DISPLAY ARRAY g_xmdh4_d TO s_detail4.* ATTRIBUTES(COUNT=g_rec_b)  
    
            BEFORE ROW
               #顯示單身筆數
               CALL axmt520_idx_chk()
               LET l_ac = DIALOG.getCurrentRow("s_detail4")
               LET g_detail_idx = l_ac
               
               #add-point:page4, before row動作
               {<point name="ui_dialog.body4.before_row"/>}
               #end add-point
               
            BEFORE DISPLAY
               #如果一直都在單身1則控制筆數位置
               IF g_loc = 'm' THEN
                  CALL FGL_SET_ARR_CURR(g_detail_idx)
               END IF
               LET g_loc = 'm'
               LET l_ac = DIALOG.getCurrentRow("s_detail4")
               LET g_current_page = 4
               #顯示單身筆數
               CALL axmt520_idx_chk()
               #add-point:page4自定義行為
               {<point name="ui_dialog.body4.before_display"/>}
               #end add-point
      
            #自訂ACTION(detail_show,page_4)
            
         
            #add-point:page4自定義行為
            {<point name="ui_dialog.body4.action"/>}
            #end add-point
         
         END DISPLAY
 
         
 
         
         #add-point:ui_dialog段自定義display array
         {<point name="ui_dialog.more_displayarray"/>}
         #end add-point
         
         SUBDIALOG lib_cl_dlg.cl_dlg_qryplan
         SUBDIALOG lib_cl_dlg.cl_dlg_relateapps
      
         BEFORE DIALOG
            #先填充browser資料
            CALL axmt520_browser_fill("")
            CALL cl_notice()
            CALL cl_navigator_setting(g_current_idx, g_detail_cnt)
            LET g_curr_diag = ui.DIALOG.getCurrent()
            LET g_current_sw = FALSE
            #回歸舊筆數位置 (回到當時異動的筆數)
            LET g_current_idx = DIALOG.getCurrentRow("s_browse")
            IF g_current_row > 1 AND g_current_idx = 1 AND g_current_sw = FALSE THEN
               CALL DIALOG.setCurrentRow("s_browse",g_current_row)
               LET g_current_idx = g_current_row
            END IF
            
            #確保g_current_idx位於正常區間內
            #小於,等於0則指到第1筆
            IF g_current_idx <= 0 THEN
               LET g_current_idx = 1
            END IF
            #超過最大筆數則指到最後1筆
            IF g_current_idx > g_browser.getLength() THEN
               LEt g_current_idx = g_browser.getLength()
            END IF 
            
            LET g_current_sw = TRUE
            LET g_current_row = g_current_idx #目前指標
            
            #有資料才進行fetch
            IF g_current_idx <> 0 THEN
               CALL axmt520_fetch('') # reload data
            END IF
            #LET g_detail_idx = 1
            CALL axmt520_ui_detailshow() #Setting the current row 
            
            #筆數顯示
            LET g_current_page = 1
            CALL axmt520_idx_chk()
            CALL cl_ap_performance_cal()
            #add-point:ui_dialog段before_dialog2
            {<point name="ui_dialog.before_dialog2"/>}
            #end add-point
 
         #狀態碼切換
         ON ACTION statechange
            LET g_action_choice = "statechange"
            CALL axmt520_statechange()
            #根據資料狀態切換action狀態
            CALL cl_set_act_visible("statechange,modify,modify_detail,delete,reproduce", TRUE)
            CALL axmt520_set_act_visible()   
            CALL axmt520_set_act_no_visible()
            IF NOT (g_xmdg_m.xmdgdocno IS NULL
 
              ) THEN
               #組合條件
               LET g_add_browse = " xmdgent = '" ||g_enterprise|| "' AND",
                                  " xmdgdocno = '", g_xmdg_m.xmdgdocno, "' "
 
               #填到對應位置
               CALL axmt520_browser_fill("")
            END IF
         #應用 a32 樣板自動產生(Version:2)
         #簽核狀況
         ON ACTION bpm_status
            #查詢簽核狀況, 統一建立HyperLink
            CALL cl_bpm_status()
            #add-point:ON ACTION bpm_status
            {<point name="menu.bpm_status" />}
            #END add-point
 
 
          
         #查詢方案選擇 
         ON ACTION queryplansel
            CALL cl_dlg_qryplan_select() RETURNING ls_wc
            #不是空條件才寫入g_wc跟重新找資料
            IF NOT cl_null(ls_wc) THEN
               CALL util.JSON.parse(ls_wc, la_wc)
               INITIALIZE g_wc, g_wc2,g_wc2_table1,g_wc2_extend TO NULL
               INITIALIZE g_wc2_table2 TO NULL
 
 
               FOR li_idx = 1 TO la_wc.getLength()
                  CASE
                     WHEN la_wc[li_idx].tableid = "xmdg_t" 
                        LET g_wc = la_wc[li_idx].wc
                     WHEN la_wc[li_idx].tableid = "xmdh_t" 
                        LET g_wc2_table1 = la_wc[li_idx].wc
                     WHEN la_wc[li_idx].tableid = "xmdi_t" 
                        LET g_wc2_table2 = la_wc[li_idx].wc
 
 
                     WHEN la_wc[li_idx].tableid = "EXTENDWC"
                        LET g_wc2_extend = la_wc[li_idx].wc
                  END CASE
               END FOR
               IF NOT cl_null(g_wc) OR NOT cl_null(g_wc2_table1) 
                  OR NOT cl_null(g_wc2_table2)
 
 
                  OR NOT cl_null(g_wc2_extend)
                  THEN
                  #組合g_wc2
                  IF g_wc2_table1 <> " 1=1" AND NOT cl_null(g_wc2_table1) THEN
                     LET g_wc2 = g_wc2_table1
                  END IF
                  IF g_wc2_table2 <> " 1=1" AND NOT cl_null(g_wc2_table2) THEN
                     LET g_wc2 = g_wc2 ," AND ", g_wc2_table2
                  END IF
 
 
                  IF g_wc2_extend <> " 1=1" AND NOT cl_null(g_wc2_extend) THEN
                     LET g_wc2 = g_wc2 ," AND ", g_wc2_extend
                  END IF
 
                  IF g_wc2.subString(1,5) = " AND " THEN
                     LET g_wc2 = g_wc2.subString(6,g_wc2.getLength())
                  END IF
               END IF
               CALL axmt520_browser_fill("F")   #browser_fill()會將notice區塊清空
               CALL cl_notice()   #重新顯示,此處不可用EXIT DIALOG, SUBDIALOG重讀會導致部分變數消失
            END IF
         
         #查詢方案選擇
         ON ACTION qbe_select
            CALL cl_qbe_list("m") RETURNING ls_wc
            IF NOT cl_null(ls_wc) THEN
               CALL util.JSON.parse(ls_wc, la_wc)
               INITIALIZE g_wc, g_wc2,g_wc2_table1,g_wc2_extend TO NULL
               INITIALIZE g_wc2_table2 TO NULL
 
 
               FOR li_idx = 1 TO la_wc.getLength()
                  CASE
                     WHEN la_wc[li_idx].tableid = "xmdg_t" 
                        LET g_wc = la_wc[li_idx].wc
                     WHEN la_wc[li_idx].tableid = "xmdh_t" 
                        LET g_wc2_table1 = la_wc[li_idx].wc
                     WHEN la_wc[li_idx].tableid = "xmdi_t" 
                        LET g_wc2_table2 = la_wc[li_idx].wc
 
 
                     WHEN la_wc[li_idx].tableid = "EXTENDWC"
                        LET g_wc2_extend = la_wc[li_idx].wc
                  END CASE
               END FOR
               IF NOT cl_null(g_wc) OR NOT cl_null(g_wc2_table1)
                  OR NOT cl_null(g_wc2_table2)
 
 
                  OR NOT cl_null(g_wc2_extend)
                  THEN
                  IF g_wc2_table1 <> " 1=1" AND NOT cl_null(g_wc2_table1) THEN
                     LET g_wc2 = g_wc2_table1
                  END IF
                  IF g_wc2_table2 <> " 1=1" AND NOT cl_null(g_wc2_table2) THEN
                     LET g_wc2 = g_wc2 ," AND ", g_wc2_table2
                  END IF
 
 
                  IF g_wc2_extend <> " 1=1" AND NOT cl_null(g_wc2_extend) THEN
                     LET g_wc2 = g_wc2 ," AND ", g_wc2_extend
                  END IF
                  IF g_wc2.subString(1,5) = " AND " THEN
                     LET g_wc2 = g_wc2.subString(6,g_wc2.getLength())
                  END IF
                  #取得條件後需要重查、跳到結果第一筆資料的功能程式段
                  CALL axmt520_browser_fill("F")
                  IF g_browser_cnt = 0 THEN
                     INITIALIZE g_errparam TO NULL 
                     LET g_errparam.extend = "" 
                     LET g_errparam.code   = "-100" 
                     LET g_errparam.popup  = TRUE 
                     CALL cl_err()
                     CLEAR FORM
                  ELSE
                     CALL axmt520_fetch("F")
                  END IF
               END IF
            END IF
            #重新搜尋會將notice區塊清空,此處不可用EXIT DIALOG, SUBDIALOG重讀會導致部分變數消失
            CALL cl_notice()
          
         #應用 a49 樣板自動產生(Version:2)
            #過濾瀏覽頁資料
            ON ACTION filter
               #add-point:filter action
               {<point name="ui_dialog.action.filter"/>}
               #end add-point
               CALL axmt520_filter()
               EXIT DIALOG
 
 
         
         ON ACTION first
            LET g_action_choice = "fetch"
            CALL axmt520_fetch('F')
            LET g_current_row = g_current_idx
            LET g_curr_diag = ui.DIALOG.getCurrent()
            CALL axmt520_idx_chk()
            
         ON ACTION previous
            LET g_action_choice = "fetch"
            CALL axmt520_fetch('P')
            LET g_current_row = g_current_idx
            LET g_curr_diag = ui.DIALOG.getCurrent()
            CALL axmt520_idx_chk()
            
         ON ACTION jump
            LET g_action_choice = "fetch"
            CALL axmt520_fetch('/')
            LET g_current_row = g_current_idx
            LET g_curr_diag = ui.DIALOG.getCurrent()
            CALL axmt520_idx_chk()
            
         ON ACTION next
            LET g_action_choice = "fetch"
            CALL axmt520_fetch('N')
            LET g_current_row = g_current_idx
            LET g_curr_diag = ui.DIALOG.getCurrent()
            CALL axmt520_idx_chk()
            
         ON ACTION last
            LET g_action_choice = "fetch"
            CALL axmt520_fetch('L')
            LET g_current_row = g_current_idx
            LET g_curr_diag = ui.DIALOG.getCurrent()
            CALL axmt520_idx_chk()
          
         #excel匯出功能          
         ON ACTION exporttoexcel
            LET g_action_choice="exporttoexcel"
            IF cl_auth_chk_act("exporttoexcel") THEN
               #browser
               CALL g_export_node.clear()
               IF g_main_hidden = 1 THEN
                  LET g_export_node[1] = base.typeInfo.create(g_browser)
                  LET g_export_id[1]   = "s_browse"
                  CALL cl_export_to_excel()
               #非browser
               ELSE
                  LET g_export_node[1] = base.typeInfo.create(g_xmdh_d)
                  LET g_export_id[1]   = "s_detail1"
                  LET g_export_node[2] = base.typeInfo.create(g_xmdh2_d)
                  LET g_export_id[2]   = "s_detail2"
                  LET g_export_node[3] = base.typeInfo.create(g_xmdh3_d)
                  LET g_export_id[3]   = "s_detail3"
                  LET g_export_node[4] = base.typeInfo.create(g_xmdh4_d)
                  LET g_export_id[4]   = "s_detail4"
 
                  #add-point:ON ACTION exporttoexcel
                  {<point name="menu.exporttoexcel" />}
                  #END add-point
                  CALL cl_export_to_excel_getpage()
                  CALL cl_export_to_excel()
               END IF
            END IF
        
         ON ACTION close
            LET INT_FLAG = FALSE
            LET g_action_choice = "exit"
            EXIT DIALOG
          
         ON ACTION exit
            LET g_action_choice = "exit"
            EXIT DIALOG
    
         #主頁摺疊
         ON ACTION mainhidden       
            IF g_main_hidden THEN
               CALL gfrm_curr.setElementHidden("mainlayout",0)
               CALL gfrm_curr.setElementHidden("worksheet",1)
               LET g_main_hidden = 0
            ELSE
               CALL gfrm_curr.setElementHidden("mainlayout",1)
               CALL gfrm_curr.setElementHidden("worksheet",0)
               LET g_main_hidden = 1
               CALL cl_notice()
            END IF
            
         #瀏覽頁折疊
         ON ACTION worksheethidden   
            IF g_main_hidden THEN
               CALL gfrm_curr.setElementHidden("mainlayout",0)
               CALL gfrm_curr.setElementHidden("worksheet",1)
               LET g_main_hidden = 0
            ELSE
               CALL gfrm_curr.setElementHidden("mainlayout",1)
               CALL gfrm_curr.setElementHidden("worksheet",0)
               LET g_main_hidden = 1
            END IF
            IF lb_first THEN
               LET lb_first = FALSE
               NEXT FIELD xmdhseq
            END IF
       
         #單頭摺疊，可利用hot key "Alt-s"開啟/關閉單頭
         ON ACTION controls     
            IF g_header_hidden THEN
               CALL gfrm_curr.setElementHidden("vb_master",0)
               CALL gfrm_curr.setElementImage("controls","small/arr-u.png")
               LET g_header_hidden = 0     #visible
            ELSE
               CALL gfrm_curr.setElementHidden("vb_master",1)
               CALL gfrm_curr.setElementImage("controls","small/arr-d.png")
               LET g_header_hidden = 1     #hidden     
            END IF
    
         
         #應用 a43 樣板自動產生(Version:2)
         ON ACTION modify
            LET g_action_choice="modify"
            IF cl_auth_chk_act("modify") THEN
               LET g_aw = ''
               CALL axmt520_modify()
               #add-point:ON ACTION modify
               {<point name="menu.modify" />}
               #END add-point
               
            END IF
 
 
 
         #應用 a43 樣板自動產生(Version:2)
         ON ACTION modify_detail
            LET g_action_choice="modify_detail"
            IF cl_auth_chk_act("modify") THEN
               LET g_aw = g_curr_diag.getCurrentItem()
               CALL axmt520_modify()
               #add-point:ON ACTION modify_detail
               {<point name="menu.modify_detail" />}
               #END add-point
               
            END IF
 
 
 
         #應用 a43 樣板自動產生(Version:2)
         ON ACTION demo
            LET g_action_choice="demo"
            IF cl_auth_chk_act("demo") THEN
               
               #add-point:ON ACTION demo
               {<point name="menu.demo" />}
               #END add-point
               
            END IF
 
 
 
         #應用 a43 樣板自動產生(Version:2)
         ON ACTION delete
            LET g_action_choice="delete"
            IF cl_auth_chk_act("delete") THEN
               CALL axmt520_delete()
               #add-point:ON ACTION delete
               {<point name="menu.delete" />}
               #END add-point
               
            END IF
 
 
 
         #應用 a43 樣板自動產生(Version:2)
         ON ACTION insert
            LET g_action_choice="insert"
            IF cl_auth_chk_act("insert") THEN
               CALL axmt520_insert()
               #add-point:ON ACTION insert
               {<point name="menu.insert" />}
               #END add-point
               
            END IF
 
 
 
         #應用 a43 樣板自動產生(Version:2)
         ON ACTION output
            LET g_action_choice="output"
            IF cl_auth_chk_act("output") THEN
               
               #add-point:ON ACTION output
               {<point name="menu.output" />}
               #END add-point
               &include "erp/axm/axmt520_rep.4gl"
               
            END IF
 
 
 
         #應用 a43 樣板自動產生(Version:2)
         ON ACTION reproduce
            LET g_action_choice="reproduce"
            IF cl_auth_chk_act("reproduce") THEN
               CALL axmt520_reproduce()
               #add-point:ON ACTION reproduce
               {<point name="menu.reproduce" />}
               #END add-point
               
            END IF
 
 
 
         #應用 a43 樣板自動產生(Version:2)
         ON ACTION axmt520_01
            LET g_action_choice="axmt520_01"
            IF cl_auth_chk_act("axmt520_01") THEN
               
               #add-point:ON ACTION axmt520_01
               {<point name="menu.axmt520_01" />}
               #END add-point
               
            END IF
 
 
 
         #應用 a43 樣板自動產生(Version:2)
         ON ACTION query
            LET g_action_choice="query"
            IF cl_auth_chk_act("query") THEN
               CALL axmt520_query()
               #add-point:ON ACTION query
               {<point name="menu.query" />}
               #END add-point
               #應用 a59 樣板自動產生(Version:2)  
               CALL g_curr_diag.setCurrentRow("s_detail1",1)
               CALL g_curr_diag.setCurrentRow("s_detail2",1)
               CALL g_curr_diag.setCurrentRow("s_detail3",1)
               CALL g_curr_diag.setCurrentRow("s_detail4",1)
 
 
 
            END IF
 
 
 
         #應用 a43 樣板自動產生(Version:2)
         ON ACTION upd_price
            LET g_action_choice="upd_price"
            IF cl_auth_chk_act("upd_price") THEN
               
               #add-point:ON ACTION upd_price
               {<point name="menu.upd_price" />}
               #END add-point
               
            END IF
 
 
 
         #應用 a43 樣板自動產生(Version:2)
         ON ACTION prog_xmdg004
            LET g_action_choice="prog_xmdg004"
            IF cl_auth_chk_act("prog_xmdg004") THEN
               
               #add-point:ON ACTION prog_xmdg004
               {<point name="menu.prog_xmdg004" />}
               #END add-point
               
            END IF
 
 
 
         #應用 a43 樣板自動產生(Version:2)
         ON ACTION prog_xmdg002
            LET g_action_choice="prog_xmdg002"
            IF cl_auth_chk_act("prog_xmdg002") THEN
               
               #add-point:ON ACTION prog_xmdg002
               {<point name="menu.prog_xmdg002" />}
               #END add-point
               
            END IF
 
 
 
         
         #應用 a46 樣板自動產生(Version:2)
         #新增相關文件
         ON ACTION related_document
            CALL axmt520_set_pk_array()
            IF cl_auth_chk_act("related_document") THEN
               #add-point:ON ACTION related_document
               {<point name="ui_dialog.dialog.related_document"/>}
               #END add-point
               CALL cl_doc()
            END IF
            
         ON ACTION agendum
            CALL axmt520_set_pk_array()
            #add-point:ON ACTION agendum
            {<point name="ui_dialog.dialog.agendum"/>}
            #END add-point
            CALL cl_user_overview()
            CALL cl_user_overview_set_follow_pic()
         
         ON ACTION followup
            CALL axmt520_set_pk_array()
            #add-point:ON ACTION followup
            {<point name="ui_dialog.dialog.followup"/>}
            #END add-point
            CALL cl_user_overview_follow(g_xmdg_m.xmdgdocdt)
 
 
         
         #主選單用ACTION
         &include "main_menu_exit_dialog.4gl"
         &include "relating_action.4gl"
    
         #交談指令共用ACTION
         &include "common_action.4gl" 
            CONTINUE DIALOG
      END DIALOG
    
      IF g_action_choice = "exit" AND NOT cl_null(g_action_choice) THEN
         #add-point:ui_dialog段離開dialog前
         {<point name="ui_dialog.b_exit"/>}
         #end add-point
         EXIT WHILE
      END IF
    
   END WHILE    
      
   CALL cl_set_act_visible("accept,cancel", TRUE)
    
END FUNCTION
]]>
  </section>
  <section id="axmt520.ui_headershow" ver="18" status="" src="s" readonly="">
    <![CDATA[#+ 單頭資料重新顯示
PRIVATE FUNCTION axmt520_ui_headershow()
   #add-point:ui_headershow段define
   {<point name="ui_headershow.define" edit="s"/>}
   #end add-point    
   #add-point:ui_headershow段define(客製用)
   {<point name="ui_headershow.define_customerization" edit="c"/>}
   #end add-point    
   
   LET g_xmdg_m.xmdgdocno = g_browser[g_current_idx].b_xmdgdocno   
 
   EXECUTE axmt520_master_referesh USING g_xmdg_m.xmdgdocno INTO g_xmdg_m.xmdgdocno,g_xmdg_m.xmdgdocdt, 
       g_xmdg_m.xmdg004,g_xmdg_m.xmdgsite,g_xmdg_m.xmdg002,g_xmdg_m.xmdg003,g_xmdg_m.xmdgstus,g_xmdg_m.xmdg001, 
       g_xmdg_m.xmdg034,g_xmdg_m.xmdg005,g_xmdg_m.xmdg006,g_xmdg_m.xmdg007,g_xmdg_m.xmdg202,g_xmdg_m.xmdg028, 
       g_xmdg_m.xmdg026,g_xmdg_m.xmdg027,g_xmdg_m.xmdg024,g_xmdg_m.xmdg025,g_xmdg_m.xmdg030,g_xmdg_m.xmdg031, 
       g_xmdg_m.xmdg053,g_xmdg_m.xmdg056,g_xmdg_m.xmdg055,g_xmdg_m.xmdg054,g_xmdg_m.xmdg017,g_xmdg_m.xmdg018, 
       g_xmdg_m.xmdg019,g_xmdg_m.xmdg020,g_xmdg_m.xmdg016,g_xmdg_m.xmdg021,g_xmdg_m.xmdg022,g_xmdg_m.xmdg023, 
       g_xmdg_m.xmdg008,g_xmdg_m.xmdg009,g_xmdg_m.xmdg010,g_xmdg_m.xmdg011,g_xmdg_m.xmdg012,g_xmdg_m.xmdg013, 
       g_xmdg_m.xmdg032,g_xmdg_m.xmdg033,g_xmdg_m.xmdg014,g_xmdg_m.xmdg015,g_xmdg_m.xmdgownid,g_xmdg_m.xmdgowndp, 
       g_xmdg_m.xmdgcrtid,g_xmdg_m.xmdgcrtdp,g_xmdg_m.xmdgcrtdt,g_xmdg_m.xmdgmodid,g_xmdg_m.xmdgmoddt, 
       g_xmdg_m.xmdgcnfid,g_xmdg_m.xmdgcnfdt,g_xmdg_m.xmdg002_desc,g_xmdg_m.xmdg003_desc,g_xmdg_m.xmdg005_desc, 
       g_xmdg_m.xmdg006_desc,g_xmdg_m.xmdg007_desc,g_xmdg_m.xmdg202_desc,g_xmdg_m.xmdg026_desc,g_xmdg_m.xmdg027_desc, 
       g_xmdg_m.xmdg030_desc,g_xmdg_m.xmdg031_desc,g_xmdg_m.xmdg056_desc,g_xmdg_m.xmdg017_desc,g_xmdg_m.xmdg018_desc, 
       g_xmdg_m.xmdg016_desc,g_xmdg_m.xmdg008_desc,g_xmdg_m.xmdg009_desc,g_xmdg_m.xmdg014_desc,g_xmdg_m.xmdgownid_desc, 
       g_xmdg_m.xmdgowndp_desc,g_xmdg_m.xmdgcrtid_desc,g_xmdg_m.xmdgcrtdp_desc,g_xmdg_m.xmdgmodid_desc, 
       g_xmdg_m.xmdgcnfid_desc
   CALL axmt520_xmdg_t_mask()
   CALL axmt520_show()
      
END FUNCTION
]]>
  </section>
  <section id="axmt520.unlock_b" ver="5" status="" src="s" readonly="">
    <![CDATA[#+ 連動unlock其他單身table資料
PRIVATE FUNCTION axmt520_unlock_b(ps_table,ps_page)
   DEFINE ps_page     STRING
   DEFINE ps_table    STRING
   DEFINE ls_group    STRING
   #add-point:unlock_b段define
   {<point name="unlock_b.define" edit="s"/>}
   #end add-point  
   #add-point:unlock_b段define(客製用)
   {<point name="unlock_b.define_customerization" edit="c"/>}
   #end add-point  
    
   LET ls_group = "'1','3','4',"
   
   IF ls_group.getIndexOf(ps_page,1) THEN
      CLOSE axmt520_bcl
   END IF
   
   LET ls_group = "'2',"
   
   IF ls_group.getIndexOf(ps_page,1) THEN
      CLOSE axmt520_bcl2
   END IF
 
 
   
 
 
   #add-point:unlock_b段other
   {<point name="unlock_b.other"/>}
   #end add-point  
 
END FUNCTION
]]>
  </section>
  <section id="axmt520.update_b" ver="25" status="" src="s" readonly="">
    <![CDATA[#+ 修改單身後其他table連動
PRIVATE FUNCTION axmt520_update_b(ps_table,ps_keys,ps_keys_bak,ps_page)
   DEFINE ps_table         STRING
   DEFINE ps_page          STRING
   DEFINE ps_keys          DYNAMIC ARRAY OF VARCHAR(500)
   DEFINE ps_keys_bak      DYNAMIC ARRAY OF VARCHAR(500)
   DEFINE ls_group         STRING
   DEFINE li_idx           LIKE type_t.num10 
   DEFINE lb_chk           BOOLEAN
   DEFINE l_new_key        DYNAMIC ARRAY OF STRING
   DEFINE l_old_key        DYNAMIC ARRAY OF STRING
   DEFINE l_field_key      DYNAMIC ARRAY OF STRING
   #add-point:update_b段define
   {<point name="update_b.define" edit="s"/>}
   #end add-point   
   #add-point:update_b段define(客製用)
   {<point name="update_b.define_customerization" edit="c"/>}
   #end add-point   
   
   LET g_update = TRUE   
   
   #判斷key是否有改變
   LET lb_chk = TRUE
   FOR li_idx = 1 TO ps_keys.getLength()
      IF ps_keys[li_idx] <> ps_keys_bak[li_idx] THEN
         LET lb_chk = FALSE
         EXIT FOR
      END IF
   END FOR
   
   #不需要做處理
   IF lb_chk THEN
      RETURN
   END IF
   
   #判斷是否是同一群組的table
   LET ls_group = "'1','3','4',"
   IF ls_group.getIndexOf(ps_page,1) > 0 AND ps_table <> "xmdh_t" THEN
      #add-point:update_b段修改前
      {<point name="update_b.before_update" mark="Y"/>}
      #end add-point 
      
      #將遮罩欄位還原
      CALL axmt520_xmdh_t_mask_restore('restore_mask_o')
               
      UPDATE xmdh_t 
         SET (xmdhdocno,
              xmdhseq
              ,xmdhsite,xmdh001,xmdh002,xmdh003,xmdh004,xmdh005,xmdh006,xmdh007,xmdh034,xmdh009,xmdh010,xmdh015,xmdh016,xmdh017,xmdh018,xmdh019,xmdh008,xmdh011,xmdh012,xmdh013,xmdh014,xmdh029,xmdh020,xmdh021,xmdh022,xmdh036,xmdh031,xmdh032,xmdh033,xmdh050,xmdh056,xmdh030,xmdh051,xmdh052,xmdhunit,xmdh035,xmdh023,xmdh024,xmdh025,xmdh026,xmdh027,xmdh028) 
              = 
             (ps_keys[1],ps_keys[2]
              ,g_xmdh_d[g_detail_idx].xmdhsite,g_xmdh_d[g_detail_idx].xmdh001,g_xmdh_d[g_detail_idx].xmdh002, 
                  g_xmdh_d[g_detail_idx].xmdh003,g_xmdh_d[g_detail_idx].xmdh004,g_xmdh_d[g_detail_idx].xmdh005, 
                  g_xmdh_d[g_detail_idx].xmdh006,g_xmdh_d[g_detail_idx].xmdh007,g_xmdh_d[g_detail_idx].xmdh034, 
                  g_xmdh_d[g_detail_idx].xmdh009,g_xmdh_d[g_detail_idx].xmdh010,g_xmdh_d[g_detail_idx].xmdh015, 
                  g_xmdh_d[g_detail_idx].xmdh016,g_xmdh_d[g_detail_idx].xmdh017,g_xmdh_d[g_detail_idx].xmdh018, 
                  g_xmdh_d[g_detail_idx].xmdh019,g_xmdh_d[g_detail_idx].xmdh008,g_xmdh_d[g_detail_idx].xmdh011, 
                  g_xmdh_d[g_detail_idx].xmdh012,g_xmdh_d[g_detail_idx].xmdh013,g_xmdh_d[g_detail_idx].xmdh014, 
                  g_xmdh_d[g_detail_idx].xmdh029,g_xmdh_d[g_detail_idx].xmdh020,g_xmdh_d[g_detail_idx].xmdh021, 
                  g_xmdh_d[g_detail_idx].xmdh022,g_xmdh_d[g_detail_idx].xmdh036,g_xmdh_d[g_detail_idx].xmdh031, 
                  g_xmdh_d[g_detail_idx].xmdh032,g_xmdh_d[g_detail_idx].xmdh033,g_xmdh_d[g_detail_idx].xmdh050, 
                  g_xmdh_d[g_detail_idx].xmdh056,g_xmdh_d[g_detail_idx].xmdh030,g_xmdh_d[g_detail_idx].xmdh051, 
                  g_xmdh_d[g_detail_idx].xmdh052,g_xmdh_d[g_detail_idx].xmdhunit,g_xmdh_d[g_detail_idx].xmdh035, 
                  g_xmdh4_d[g_detail_idx].xmdh023,g_xmdh4_d[g_detail_idx].xmdh024,g_xmdh4_d[g_detail_idx].xmdh025, 
                  g_xmdh4_d[g_detail_idx].xmdh026,g_xmdh4_d[g_detail_idx].xmdh027,g_xmdh4_d[g_detail_idx].xmdh028)  

         WHERE xmdhent = g_enterprise AND xmdhdocno = ps_keys_bak[1] AND xmdhseq = ps_keys_bak[2]
      #add-point:update_b段修改中
      {<point name="update_b.m_update"/>}
      #end add-point   
      CASE
         WHEN SQLCA.sqlerrd[3] = 0  #更新不到的處理
            INITIALIZE g_errparam TO NULL 
            LET g_errparam.extend = "xmdh_t" 
            LET g_errparam.code   = "std-00009" 
            LET g_errparam.popup  = TRUE 
            CALL cl_err()
            CALL s_transaction_end('N','0')
         WHEN SQLCA.sqlcode #其他錯誤
            INITIALIZE g_errparam TO NULL 
            LET g_errparam.extend = "xmdh_t" 
            LET g_errparam.code   = SQLCA.sqlcode 
            LET g_errparam.popup  = TRUE 
            CALL cl_err()
            CALL s_transaction_end('N','0')
         OTHERWISE
            
      END CASE
      
      #將遮罩欄位進行遮蔽
      CALL axmt520_xmdh_t_mask_restore('restore_mask_n')
               
      #add-point:update_b段修改後
      {<point name="update_b.after_update"/>}
      #end add-point  
   END IF
   
   LET ls_group = "'2',"
   #判斷是否是同一群組的table
   IF ls_group.getIndexOf(ps_page,1) > 0 AND ps_table <> "xmdi_t" THEN
      #add-point:update_b段修改前
      {<point name="update_b.before_update2" mark="Y"/>}
      #end add-point  
      
      #將遮罩欄位還原
      CALL axmt520_xmdi_t_mask_restore('restore_mask_o')
               
      UPDATE xmdi_t 
         SET (xmdidocno,
              xmdiseq,xmdiseq1
              ,xmdisite,xmdi001,xmdi002,xmdi003,xmdi004,xmdi005,xmdi006,xmdi007,xmdi013,xmdi008,xmdi009,xmdi010,xmdi011,xmdi012) 
              = 
             (ps_keys[1],ps_keys[2],ps_keys[3]
              ,g_xmdh2_d[g_detail_idx].xmdisite,g_xmdh2_d[g_detail_idx].xmdi001,g_xmdh2_d[g_detail_idx].xmdi002, 
                  g_xmdh2_d[g_detail_idx].xmdi003,g_xmdh2_d[g_detail_idx].xmdi004,g_xmdh2_d[g_detail_idx].xmdi005, 
                  g_xmdh2_d[g_detail_idx].xmdi006,g_xmdh2_d[g_detail_idx].xmdi007,g_xmdh2_d[g_detail_idx].xmdi013, 
                  g_xmdh2_d[g_detail_idx].xmdi008,g_xmdh2_d[g_detail_idx].xmdi009,g_xmdh2_d[g_detail_idx].xmdi010, 
                  g_xmdh2_d[g_detail_idx].xmdi011,g_xmdh2_d[g_detail_idx].xmdi012) 
         WHERE xmdient = g_enterprise AND xmdidocno = ps_keys_bak[1] AND xmdiseq = ps_keys_bak[2] AND xmdiseq1 = ps_keys_bak[3]
      #add-point:update_b段修改中
      {<point name="update_b.m_update2"/>}
      #end add-point  
      CASE
         WHEN SQLCA.sqlerrd[3] = 0  #更新不到的處理
            INITIALIZE g_errparam TO NULL 
            LET g_errparam.extend = "xmdi_t" 
            LET g_errparam.code   = "std-00009" 
            LET g_errparam.popup  = TRUE 
            CALL cl_err()
            CALL s_transaction_end('N','0')
         WHEN SQLCA.sqlcode #其他錯誤
            INITIALIZE g_errparam TO NULL 
            LET g_errparam.extend = "xmdi_t" 
            LET g_errparam.code   = SQLCA.sqlcode 
            LET g_errparam.popup  = TRUE 
            CALL cl_err()
            CALL s_transaction_end('N','0')
         OTHERWISE
            
      END CASE
      
      #將遮罩欄位進行遮蔽
      CALL axmt520_xmdi_t_mask_restore('restore_mask_n')
 
      #add-point:update_b段修改後
      {<point name="update_b.after_update2"/>}
      #end add-point  
   END IF
 
 
   
 
   
   #add-point:update_b段other
   {<point name="update_b.other"/>}
   #end add-point  
   
END FUNCTION
]]>
  </section>
</add_points>
