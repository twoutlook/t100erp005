#該程式未解開Section, 採用最新樣板產出!
{<section id="axrt300_07.description" >}
#應用 a00 樣板自動產生(Version:3)
#+ Standard Version.....: SD版次:0011(2016-05-31 12:11:29), PR版次:0011(2017-02-15 18:06:12)
#+ Customerized Version.: SD版次:0000(1900-01-01 00:00:00), PR版次:0000(1900-01-01 00:00:00)
#+ Build......: 000070
#+ Filename...: axrt300_07
#+ Description: 其他訊息
#+ Creator....: 01727(2015-03-16 09:33:39)
#+ Modifier...: 02114 -SD/PR- 01531
 
{</section>}
 
{<section id="axrt300_07.global" >}
#應用 c02b 樣板自動產生(Version:10)
#add-point:填寫註解說明 name="global.memo"
#150828-00001#7   150911      By Jessy  將業務部門欄位設定不能維護f移至帳款明細頁籤維護)
#160321-00016#52  160401      By Hans   將重複內容的錯誤訊息置換為公用錯誤訊息
#160129-00015#6   2016/04/19  By 01531  固定核算项取用显示效能优化 
#160509-00004#37  2016/05/31  By 02114  單身增加帳款客戶 收款客戶
#151008-00009#8   2016/06/28  By 03538  其他訊息有改動時,應更新遞延檔
#160913-00017#7   2016/09/22  By 07900  AXR模组调整交易客商开窗
#161128-00061#4   2016/12/02  by 02481  标准程式定义采用宣告模式,弃用.*写法
#161221-00054#2   2017/02/15  By 01531  核算项开窗检核增加agli060相关联判断，当agli060中有维护核算项资料时，
#                                       如果是正向(允许)，核算项只可以抓取agli060中维护的值；如果是反向(拒绝)，核算项不可以抓取agli060中维护的值；
#                                       如果没有维护agli060中的值，就按照原逻辑
#end add-point
#add-point:填寫註解說明(客製用) name="global.memo_customerization"

#end add-point
 
IMPORT os
IMPORT FGL lib_cl_dlg
#add-point:增加匯入項目 name="global.import"

#end add-point
 
SCHEMA ds
 
GLOBALS "../../cfg/top_global.inc"
 
#add-point:增加匯入變數檔 name="global.inc"

#end add-point
 
#單身 type 宣告
PRIVATE TYPE type_g_xrcb_d        RECORD
       xrcbdocno LIKE xrcb_t.xrcbdocno, 
   xrcbld LIKE xrcb_t.xrcbld, 
   xrcbseq LIKE xrcb_t.xrcbseq, 
   xrcb047 LIKE xrcb_t.xrcb047, 
   xrcb029 LIKE xrcb_t.xrcb029, 
   xrcb029_desc LIKE type_t.chr500, 
   xrcb021 LIKE xrcb_t.xrcb021, 
   xrcb021_desc LIKE type_t.chr500, 
   xrcb051 LIKE xrcb_t.xrcb051, 
   xrcb051_desc LIKE type_t.chr500, 
   xrcb010 LIKE xrcb_t.xrcb010, 
   xrcb010_desc LIKE type_t.chr500, 
   xrcb011 LIKE xrcb_t.xrcb011, 
   xrcb011_desc LIKE type_t.chr500, 
   xrcb024 LIKE xrcb_t.xrcb024, 
   xrcb024_desc LIKE type_t.chr500, 
   xrcb036 LIKE xrcb_t.xrcb036, 
   xrcb036_desc LIKE type_t.chr500, 
   xrcb012 LIKE xrcb_t.xrcb012, 
   xrcb012_desc LIKE type_t.chr500, 
   xrcb015 LIKE xrcb_t.xrcb015, 
   xrcb015_desc LIKE type_t.chr500, 
   xrcb016 LIKE xrcb_t.xrcb016, 
   xrcb016_desc LIKE type_t.chr500, 
   xrcb033 LIKE xrcb_t.xrcb033, 
   xrcb034 LIKE xrcb_t.xrcb034, 
   xrcb034_desc LIKE type_t.chr500, 
   xrcb035 LIKE xrcb_t.xrcb035, 
   xrcb035_desc LIKE type_t.chr500, 
   xrcb053 LIKE xrcb_t.xrcb053, 
   xrcb053_desc LIKE type_t.chr500, 
   xrcb054 LIKE xrcb_t.xrcb054, 
   xrcb054_desc LIKE type_t.chr500, 
   xrcb037 LIKE xrcb_t.xrcb037, 
   xrcb037_desc LIKE type_t.chr500, 
   xrcb038 LIKE xrcb_t.xrcb038, 
   xrcb038_desc LIKE type_t.chr500, 
   xrcb039 LIKE xrcb_t.xrcb039, 
   xrcb039_desc LIKE type_t.chr500, 
   xrcb040 LIKE xrcb_t.xrcb040, 
   xrcb040_desc LIKE type_t.chr500, 
   xrcb041 LIKE xrcb_t.xrcb041, 
   xrcb041_desc LIKE type_t.chr500, 
   xrcb042 LIKE xrcb_t.xrcb042, 
   xrcb042_desc LIKE type_t.chr500, 
   xrcb043 LIKE xrcb_t.xrcb043, 
   xrcb043_desc LIKE type_t.chr500, 
   xrcb044 LIKE xrcb_t.xrcb044, 
   xrcb044_desc LIKE type_t.chr500, 
   xrcb045 LIKE xrcb_t.xrcb045, 
   xrcb045_desc LIKE type_t.chr500, 
   xrcb046 LIKE xrcb_t.xrcb046, 
   xrcb046_desc LIKE type_t.chr500
       END RECORD
 
 
#add-point:自定義模組變數(Module Variable)(請盡量不要在客製環境修改此段落內容, 否則將後續patch的調整需人工處理) name="global.variable"
DEFINE g_rec_b04              LIKE type_t.num5
GLOBALS
   DEFINE g_xrcb_d4              DYNAMIC ARRAY OF type_g_xrcb_d
END GLOBALS
#end add-point
 
DEFINE g_xrcb_d          DYNAMIC ARRAY OF type_g_xrcb_d
DEFINE g_xrcb_d_t        type_g_xrcb_d
 
 
DEFINE g_xrcbld_t   LIKE xrcb_t.xrcbld    #Key值備份
DEFINE g_xrcbdocno_t      LIKE xrcb_t.xrcbdocno    #Key值備份
DEFINE g_xrcbseq_t      LIKE xrcb_t.xrcbseq    #Key值備份
 
 
DEFINE l_ac                  LIKE type_t.num10
DEFINE g_ref_fields          DYNAMIC ARRAY OF VARCHAR(500) #ap_ref用陣列
DEFINE g_rtn_fields          DYNAMIC ARRAY OF VARCHAR(500) #ap_ref用陣列
DEFINE g_ref_vars            DYNAMIC ARRAY OF VARCHAR(500) #ap_ref用陣列
DEFINE g_rec_b               LIKE type_t.num10 
DEFINE g_detail_idx          LIKE type_t.num10
 
#add-point:自定義客戶專用模組變數(Module Variable) name="global.variable_customerization"

#end add-point
    
#add-point:傳入參數說明(global.argv) name="global.argv"

#end add-point    
 
{</section>}
 
{<section id="axrt300_07.input" >}
#+ 資料輸入
PUBLIC FUNCTION axrt300_07(--)
   #add-point:input段變數傳入 name="input.get_var"
   
   #end add-point
   )
   #add-point:input段define name="input.define_customerization"
   
   #end add-point
   DEFINE l_ac_t          LIKE type_t.num10       #未取消的ARRAY CNT 
   DEFINE l_allow_insert  LIKE type_t.num5        #可新增否 
   DEFINE l_allow_delete  LIKE type_t.num5        #可刪除否  
   DEFINE l_count         LIKE type_t.num10
   DEFINE l_insert        LIKE type_t.num5
   DEFINE l_cmd           LIKE type_t.chr5
   #add-point:input段define(請盡量不要在客製環境修改此段落內容, 否則將後續patch的調整需人工處理) name="input.define"
   
   #end add-point
 
   #畫面開啟 (identifier)
   OPEN WINDOW w_axrt300_07 WITH FORM cl_ap_formpath("axr","axrt300_07")
 
   #瀏覽頁簽資料初始化
   CALL cl_ui_init()
   
   LET g_qryparam.state = "i"
   
   LET l_allow_insert = cl_auth_detail_input("insert")
   LET l_allow_delete = cl_auth_detail_input("delete")
   
   #輸入前處理
   #add-point:單身前置處理 name="input.pre_input"
{
   #end add-point
  
   DIALOG ATTRIBUTES(UNBUFFERED,FIELD ORDER FORM)
   
      #輸入開始
      INPUT ARRAY g_xrcb_d FROM s_detail1_axrt300_07.*
          ATTRIBUTE(COUNT = g_rec_b,MAXCOUNT = g_max_rec,WITHOUT DEFAULTS, 
                  INSERT ROW = l_allow_insert,
                  DELETE ROW = l_allow_delete,
                  APPEND ROW = l_allow_insert)
         
         #自訂ACTION
         #add-point:單身前置處理 name="input.action"
         
         #end add-point
         
         #自訂ACTION(detail_input)
         
         
         BEFORE INPUT
            #add-point:單身輸入前處理 name="input.before_input"
            
            #end add-point
          
                  #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD xrcbdocno_4
            #add-point:BEFORE FIELD xrcbdocno_4 name="input.b.page1_axrt300_07.xrcbdocno_4"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD xrcbdocno_4
            
            #add-point:AFTER FIELD xrcbdocno_4 name="input.a.page1_axrt300_07.xrcbdocno_4"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE xrcbdocno_4
            #add-point:ON CHANGE xrcbdocno_4 name="input.g.page1_axrt300_07.xrcbdocno_4"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD xrcbld_4
            #add-point:BEFORE FIELD xrcbld_4 name="input.b.page1_axrt300_07.xrcbld_4"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD xrcbld_4
            
            #add-point:AFTER FIELD xrcbld_4 name="input.a.page1_axrt300_07.xrcbld_4"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE xrcbld_4
            #add-point:ON CHANGE xrcbld_4 name="input.g.page1_axrt300_07.xrcbld_4"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD xrcbseq_4
            #add-point:BEFORE FIELD xrcbseq_4 name="input.b.page1_axrt300_07.xrcbseq_4"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD xrcbseq_4
            
            #add-point:AFTER FIELD xrcbseq_4 name="input.a.page1_axrt300_07.xrcbseq_4"
            IF NOT cl_null(g_xrcb_d[l_ac].xrcbseq_4) THEN 
            END IF 


            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE xrcbseq_4
            #add-point:ON CHANGE xrcbseq_4 name="input.g.page1_axrt300_07.xrcbseq_4"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD xrcb047
            #add-point:BEFORE FIELD xrcb047 name="input.b.page1_axrt300_07.xrcb047"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD xrcb047
            
            #add-point:AFTER FIELD xrcb047 name="input.a.page1_axrt300_07.xrcb047"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE xrcb047
            #add-point:ON CHANGE xrcb047 name="input.g.page1_axrt300_07.xrcb047"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD xrcb029
            #add-point:BEFORE FIELD xrcb029 name="input.b.page1_axrt300_07.xrcb029"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD xrcb029
            
            #add-point:AFTER FIELD xrcb029 name="input.a.page1_axrt300_07.xrcb029"


            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE xrcb029
            #add-point:ON CHANGE xrcb029 name="input.g.page1_axrt300_07.xrcb029"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD xrcb029_desc
            #add-point:BEFORE FIELD xrcb029_desc name="input.b.page1_axrt300_07.xrcb029_desc"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD xrcb029_desc
            
            #add-point:AFTER FIELD xrcb029_desc name="input.a.page1_axrt300_07.xrcb029_desc"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE xrcb029_desc
            #add-point:ON CHANGE xrcb029_desc name="input.g.page1_axrt300_07.xrcb029_desc"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD xrcb021
            #add-point:BEFORE FIELD xrcb021 name="input.b.page1_axrt300_07.xrcb021"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD xrcb021
            
            #add-point:AFTER FIELD xrcb021 name="input.a.page1_axrt300_07.xrcb021"


            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE xrcb021
            #add-point:ON CHANGE xrcb021 name="input.g.page1_axrt300_07.xrcb021"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD xrcb021_desc
            #add-point:BEFORE FIELD xrcb021_desc name="input.b.page1_axrt300_07.xrcb021_desc"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD xrcb021_desc
            
            #add-point:AFTER FIELD xrcb021_desc name="input.a.page1_axrt300_07.xrcb021_desc"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE xrcb021_desc
            #add-point:ON CHANGE xrcb021_desc name="input.g.page1_axrt300_07.xrcb021_desc"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD xrcb051
            #add-point:BEFORE FIELD xrcb051 name="input.b.page1_axrt300_07.xrcb051"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD xrcb051
            
            #add-point:AFTER FIELD xrcb051 name="input.a.page1_axrt300_07.xrcb051"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE xrcb051
            #add-point:ON CHANGE xrcb051 name="input.g.page1_axrt300_07.xrcb051"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD xrcb051_desc
            #add-point:BEFORE FIELD xrcb051_desc name="input.b.page1_axrt300_07.xrcb051_desc"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD xrcb051_desc
            
            #add-point:AFTER FIELD xrcb051_desc name="input.a.page1_axrt300_07.xrcb051_desc"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE xrcb051_desc
            #add-point:ON CHANGE xrcb051_desc name="input.g.page1_axrt300_07.xrcb051_desc"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD xrcb010
            #add-point:BEFORE FIELD xrcb010 name="input.b.page1_axrt300_07.xrcb010"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD xrcb010
            
            #add-point:AFTER FIELD xrcb010 name="input.a.page1_axrt300_07.xrcb010"


            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE xrcb010
            #add-point:ON CHANGE xrcb010 name="input.g.page1_axrt300_07.xrcb010"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD xrcb010_desc
            #add-point:BEFORE FIELD xrcb010_desc name="input.b.page1_axrt300_07.xrcb010_desc"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD xrcb010_desc
            
            #add-point:AFTER FIELD xrcb010_desc name="input.a.page1_axrt300_07.xrcb010_desc"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE xrcb010_desc
            #add-point:ON CHANGE xrcb010_desc name="input.g.page1_axrt300_07.xrcb010_desc"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD xrcb011
            #add-point:BEFORE FIELD xrcb011 name="input.b.page1_axrt300_07.xrcb011"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD xrcb011
            
            #add-point:AFTER FIELD xrcb011 name="input.a.page1_axrt300_07.xrcb011"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE xrcb011
            #add-point:ON CHANGE xrcb011 name="input.g.page1_axrt300_07.xrcb011"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD xrcb011_desc
            #add-point:BEFORE FIELD xrcb011_desc name="input.b.page1_axrt300_07.xrcb011_desc"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD xrcb011_desc
            
            #add-point:AFTER FIELD xrcb011_desc name="input.a.page1_axrt300_07.xrcb011_desc"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE xrcb011_desc
            #add-point:ON CHANGE xrcb011_desc name="input.g.page1_axrt300_07.xrcb011_desc"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD xrcb024
            #add-point:BEFORE FIELD xrcb024 name="input.b.page1_axrt300_07.xrcb024"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD xrcb024
            
            #add-point:AFTER FIELD xrcb024 name="input.a.page1_axrt300_07.xrcb024"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE xrcb024
            #add-point:ON CHANGE xrcb024 name="input.g.page1_axrt300_07.xrcb024"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD xrcb024_desc
            #add-point:BEFORE FIELD xrcb024_desc name="input.b.page1_axrt300_07.xrcb024_desc"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD xrcb024_desc
            
            #add-point:AFTER FIELD xrcb024_desc name="input.a.page1_axrt300_07.xrcb024_desc"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE xrcb024_desc
            #add-point:ON CHANGE xrcb024_desc name="input.g.page1_axrt300_07.xrcb024_desc"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD xrcb036
            #add-point:BEFORE FIELD xrcb036 name="input.b.page1_axrt300_07.xrcb036"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD xrcb036
            
            #add-point:AFTER FIELD xrcb036 name="input.a.page1_axrt300_07.xrcb036"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE xrcb036
            #add-point:ON CHANGE xrcb036 name="input.g.page1_axrt300_07.xrcb036"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD xrcb036_desc
            #add-point:BEFORE FIELD xrcb036_desc name="input.b.page1_axrt300_07.xrcb036_desc"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD xrcb036_desc
            
            #add-point:AFTER FIELD xrcb036_desc name="input.a.page1_axrt300_07.xrcb036_desc"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE xrcb036_desc
            #add-point:ON CHANGE xrcb036_desc name="input.g.page1_axrt300_07.xrcb036_desc"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD xrcb012
            #add-point:BEFORE FIELD xrcb012 name="input.b.page1_axrt300_07.xrcb012"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD xrcb012
            
            #add-point:AFTER FIELD xrcb012 name="input.a.page1_axrt300_07.xrcb012"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE xrcb012
            #add-point:ON CHANGE xrcb012 name="input.g.page1_axrt300_07.xrcb012"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD xrcb012_desc
            #add-point:BEFORE FIELD xrcb012_desc name="input.b.page1_axrt300_07.xrcb012_desc"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD xrcb012_desc
            
            #add-point:AFTER FIELD xrcb012_desc name="input.a.page1_axrt300_07.xrcb012_desc"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE xrcb012_desc
            #add-point:ON CHANGE xrcb012_desc name="input.g.page1_axrt300_07.xrcb012_desc"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD xrcb015
            #add-point:BEFORE FIELD xrcb015 name="input.b.page1_axrt300_07.xrcb015"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD xrcb015
            
            #add-point:AFTER FIELD xrcb015 name="input.a.page1_axrt300_07.xrcb015"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE xrcb015
            #add-point:ON CHANGE xrcb015 name="input.g.page1_axrt300_07.xrcb015"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD xrcb015_desc
            #add-point:BEFORE FIELD xrcb015_desc name="input.b.page1_axrt300_07.xrcb015_desc"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD xrcb015_desc
            
            #add-point:AFTER FIELD xrcb015_desc name="input.a.page1_axrt300_07.xrcb015_desc"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE xrcb015_desc
            #add-point:ON CHANGE xrcb015_desc name="input.g.page1_axrt300_07.xrcb015_desc"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD xrcb016
            #add-point:BEFORE FIELD xrcb016 name="input.b.page1_axrt300_07.xrcb016"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD xrcb016
            
            #add-point:AFTER FIELD xrcb016 name="input.a.page1_axrt300_07.xrcb016"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE xrcb016
            #add-point:ON CHANGE xrcb016 name="input.g.page1_axrt300_07.xrcb016"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD xrcb016_desc
            #add-point:BEFORE FIELD xrcb016_desc name="input.b.page1_axrt300_07.xrcb016_desc"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD xrcb016_desc
            
            #add-point:AFTER FIELD xrcb016_desc name="input.a.page1_axrt300_07.xrcb016_desc"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE xrcb016_desc
            #add-point:ON CHANGE xrcb016_desc name="input.g.page1_axrt300_07.xrcb016_desc"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD xrcb033
            #add-point:BEFORE FIELD xrcb033 name="input.b.page1_axrt300_07.xrcb033"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD xrcb033
            
            #add-point:AFTER FIELD xrcb033 name="input.a.page1_axrt300_07.xrcb033"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE xrcb033
            #add-point:ON CHANGE xrcb033 name="input.g.page1_axrt300_07.xrcb033"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD xrcb034
            #add-point:BEFORE FIELD xrcb034 name="input.b.page1_axrt300_07.xrcb034"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD xrcb034
            
            #add-point:AFTER FIELD xrcb034 name="input.a.page1_axrt300_07.xrcb034"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE xrcb034
            #add-point:ON CHANGE xrcb034 name="input.g.page1_axrt300_07.xrcb034"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD xrcb034_desc
            #add-point:BEFORE FIELD xrcb034_desc name="input.b.page1_axrt300_07.xrcb034_desc"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD xrcb034_desc
            
            #add-point:AFTER FIELD xrcb034_desc name="input.a.page1_axrt300_07.xrcb034_desc"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE xrcb034_desc
            #add-point:ON CHANGE xrcb034_desc name="input.g.page1_axrt300_07.xrcb034_desc"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD xrcb035
            #add-point:BEFORE FIELD xrcb035 name="input.b.page1_axrt300_07.xrcb035"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD xrcb035
            
            #add-point:AFTER FIELD xrcb035 name="input.a.page1_axrt300_07.xrcb035"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE xrcb035
            #add-point:ON CHANGE xrcb035 name="input.g.page1_axrt300_07.xrcb035"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD xrcb035_desc
            #add-point:BEFORE FIELD xrcb035_desc name="input.b.page1_axrt300_07.xrcb035_desc"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD xrcb035_desc
            
            #add-point:AFTER FIELD xrcb035_desc name="input.a.page1_axrt300_07.xrcb035_desc"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE xrcb035_desc
            #add-point:ON CHANGE xrcb035_desc name="input.g.page1_axrt300_07.xrcb035_desc"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD xrcb053
            #add-point:BEFORE FIELD xrcb053 name="input.b.page1_axrt300_07.xrcb053"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD xrcb053
            
            #add-point:AFTER FIELD xrcb053 name="input.a.page1_axrt300_07.xrcb053"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE xrcb053
            #add-point:ON CHANGE xrcb053 name="input.g.page1_axrt300_07.xrcb053"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD xrcb053_desc
            #add-point:BEFORE FIELD xrcb053_desc name="input.b.page1_axrt300_07.xrcb053_desc"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD xrcb053_desc
            
            #add-point:AFTER FIELD xrcb053_desc name="input.a.page1_axrt300_07.xrcb053_desc"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE xrcb053_desc
            #add-point:ON CHANGE xrcb053_desc name="input.g.page1_axrt300_07.xrcb053_desc"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD xrcb054
            #add-point:BEFORE FIELD xrcb054 name="input.b.page1_axrt300_07.xrcb054"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD xrcb054
            
            #add-point:AFTER FIELD xrcb054 name="input.a.page1_axrt300_07.xrcb054"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE xrcb054
            #add-point:ON CHANGE xrcb054 name="input.g.page1_axrt300_07.xrcb054"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD xrcb054_desc
            #add-point:BEFORE FIELD xrcb054_desc name="input.b.page1_axrt300_07.xrcb054_desc"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD xrcb054_desc
            
            #add-point:AFTER FIELD xrcb054_desc name="input.a.page1_axrt300_07.xrcb054_desc"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE xrcb054_desc
            #add-point:ON CHANGE xrcb054_desc name="input.g.page1_axrt300_07.xrcb054_desc"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD xrcb037
            #add-point:BEFORE FIELD xrcb037 name="input.b.page1_axrt300_07.xrcb037"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD xrcb037
            
            #add-point:AFTER FIELD xrcb037 name="input.a.page1_axrt300_07.xrcb037"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE xrcb037
            #add-point:ON CHANGE xrcb037 name="input.g.page1_axrt300_07.xrcb037"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD xrcb037_desc
            #add-point:BEFORE FIELD xrcb037_desc name="input.b.page1_axrt300_07.xrcb037_desc"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD xrcb037_desc
            
            #add-point:AFTER FIELD xrcb037_desc name="input.a.page1_axrt300_07.xrcb037_desc"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE xrcb037_desc
            #add-point:ON CHANGE xrcb037_desc name="input.g.page1_axrt300_07.xrcb037_desc"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD xrcb038
            #add-point:BEFORE FIELD xrcb038 name="input.b.page1_axrt300_07.xrcb038"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD xrcb038
            
            #add-point:AFTER FIELD xrcb038 name="input.a.page1_axrt300_07.xrcb038"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE xrcb038
            #add-point:ON CHANGE xrcb038 name="input.g.page1_axrt300_07.xrcb038"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD xrcb038_desc
            #add-point:BEFORE FIELD xrcb038_desc name="input.b.page1_axrt300_07.xrcb038_desc"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD xrcb038_desc
            
            #add-point:AFTER FIELD xrcb038_desc name="input.a.page1_axrt300_07.xrcb038_desc"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE xrcb038_desc
            #add-point:ON CHANGE xrcb038_desc name="input.g.page1_axrt300_07.xrcb038_desc"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD xrcb039
            #add-point:BEFORE FIELD xrcb039 name="input.b.page1_axrt300_07.xrcb039"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD xrcb039
            
            #add-point:AFTER FIELD xrcb039 name="input.a.page1_axrt300_07.xrcb039"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE xrcb039
            #add-point:ON CHANGE xrcb039 name="input.g.page1_axrt300_07.xrcb039"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD xrcb039_desc
            #add-point:BEFORE FIELD xrcb039_desc name="input.b.page1_axrt300_07.xrcb039_desc"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD xrcb039_desc
            
            #add-point:AFTER FIELD xrcb039_desc name="input.a.page1_axrt300_07.xrcb039_desc"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE xrcb039_desc
            #add-point:ON CHANGE xrcb039_desc name="input.g.page1_axrt300_07.xrcb039_desc"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD xrcb040
            #add-point:BEFORE FIELD xrcb040 name="input.b.page1_axrt300_07.xrcb040"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD xrcb040
            
            #add-point:AFTER FIELD xrcb040 name="input.a.page1_axrt300_07.xrcb040"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE xrcb040
            #add-point:ON CHANGE xrcb040 name="input.g.page1_axrt300_07.xrcb040"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD xrcb040_desc
            #add-point:BEFORE FIELD xrcb040_desc name="input.b.page1_axrt300_07.xrcb040_desc"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD xrcb040_desc
            
            #add-point:AFTER FIELD xrcb040_desc name="input.a.page1_axrt300_07.xrcb040_desc"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE xrcb040_desc
            #add-point:ON CHANGE xrcb040_desc name="input.g.page1_axrt300_07.xrcb040_desc"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD xrcb041
            #add-point:BEFORE FIELD xrcb041 name="input.b.page1_axrt300_07.xrcb041"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD xrcb041
            
            #add-point:AFTER FIELD xrcb041 name="input.a.page1_axrt300_07.xrcb041"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE xrcb041
            #add-point:ON CHANGE xrcb041 name="input.g.page1_axrt300_07.xrcb041"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD xrcb041_desc
            #add-point:BEFORE FIELD xrcb041_desc name="input.b.page1_axrt300_07.xrcb041_desc"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD xrcb041_desc
            
            #add-point:AFTER FIELD xrcb041_desc name="input.a.page1_axrt300_07.xrcb041_desc"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE xrcb041_desc
            #add-point:ON CHANGE xrcb041_desc name="input.g.page1_axrt300_07.xrcb041_desc"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD xrcb042
            #add-point:BEFORE FIELD xrcb042 name="input.b.page1_axrt300_07.xrcb042"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD xrcb042
            
            #add-point:AFTER FIELD xrcb042 name="input.a.page1_axrt300_07.xrcb042"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE xrcb042
            #add-point:ON CHANGE xrcb042 name="input.g.page1_axrt300_07.xrcb042"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD xrcb042_desc
            #add-point:BEFORE FIELD xrcb042_desc name="input.b.page1_axrt300_07.xrcb042_desc"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD xrcb042_desc
            
            #add-point:AFTER FIELD xrcb042_desc name="input.a.page1_axrt300_07.xrcb042_desc"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE xrcb042_desc
            #add-point:ON CHANGE xrcb042_desc name="input.g.page1_axrt300_07.xrcb042_desc"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD xrcb043
            #add-point:BEFORE FIELD xrcb043 name="input.b.page1_axrt300_07.xrcb043"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD xrcb043
            
            #add-point:AFTER FIELD xrcb043 name="input.a.page1_axrt300_07.xrcb043"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE xrcb043
            #add-point:ON CHANGE xrcb043 name="input.g.page1_axrt300_07.xrcb043"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD xrcb043_desc
            #add-point:BEFORE FIELD xrcb043_desc name="input.b.page1_axrt300_07.xrcb043_desc"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD xrcb043_desc
            
            #add-point:AFTER FIELD xrcb043_desc name="input.a.page1_axrt300_07.xrcb043_desc"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE xrcb043_desc
            #add-point:ON CHANGE xrcb043_desc name="input.g.page1_axrt300_07.xrcb043_desc"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD xrcb044
            #add-point:BEFORE FIELD xrcb044 name="input.b.page1_axrt300_07.xrcb044"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD xrcb044
            
            #add-point:AFTER FIELD xrcb044 name="input.a.page1_axrt300_07.xrcb044"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE xrcb044
            #add-point:ON CHANGE xrcb044 name="input.g.page1_axrt300_07.xrcb044"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD xrcb044_desc
            #add-point:BEFORE FIELD xrcb044_desc name="input.b.page1_axrt300_07.xrcb044_desc"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD xrcb044_desc
            
            #add-point:AFTER FIELD xrcb044_desc name="input.a.page1_axrt300_07.xrcb044_desc"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE xrcb044_desc
            #add-point:ON CHANGE xrcb044_desc name="input.g.page1_axrt300_07.xrcb044_desc"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD xrcb045
            #add-point:BEFORE FIELD xrcb045 name="input.b.page1_axrt300_07.xrcb045"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD xrcb045
            
            #add-point:AFTER FIELD xrcb045 name="input.a.page1_axrt300_07.xrcb045"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE xrcb045
            #add-point:ON CHANGE xrcb045 name="input.g.page1_axrt300_07.xrcb045"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD xrcb045_desc
            #add-point:BEFORE FIELD xrcb045_desc name="input.b.page1_axrt300_07.xrcb045_desc"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD xrcb045_desc
            
            #add-point:AFTER FIELD xrcb045_desc name="input.a.page1_axrt300_07.xrcb045_desc"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE xrcb045_desc
            #add-point:ON CHANGE xrcb045_desc name="input.g.page1_axrt300_07.xrcb045_desc"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD xrcb046
            #add-point:BEFORE FIELD xrcb046 name="input.b.page1_axrt300_07.xrcb046"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD xrcb046
            
            #add-point:AFTER FIELD xrcb046 name="input.a.page1_axrt300_07.xrcb046"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE xrcb046
            #add-point:ON CHANGE xrcb046 name="input.g.page1_axrt300_07.xrcb046"
            
            #END add-point 
 
 
         #應用 a01 樣板自動產生(Version:2)
         BEFORE FIELD xrcb046_desc
            #add-point:BEFORE FIELD xrcb046_desc name="input.b.page1_axrt300_07.xrcb046_desc"
            
            #END add-point
 
 
         #應用 a02 樣板自動產生(Version:2)
         AFTER FIELD xrcb046_desc
            
            #add-point:AFTER FIELD xrcb046_desc name="input.a.page1_axrt300_07.xrcb046_desc"
            
            #END add-point
            
 
 
         #應用 a04 樣板自動產生(Version:3)
         ON CHANGE xrcb046_desc
            #add-point:ON CHANGE xrcb046_desc name="input.g.page1_axrt300_07.xrcb046_desc"
            
            #END add-point 
 
 
 
                  #Ctrlp:input.c.page1_axrt300_07.xrcbdocno_4
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD xrcbdocno_4
            #add-point:ON ACTION controlp INFIELD xrcbdocno_4 name="input.c.page1_axrt300_07.xrcbdocno_4"
            
            #END add-point
 
 
         #Ctrlp:input.c.page1_axrt300_07.xrcbld_4
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD xrcbld_4
            #add-point:ON ACTION controlp INFIELD xrcbld_4 name="input.c.page1_axrt300_07.xrcbld_4"
            
            #END add-point
 
 
         #Ctrlp:input.c.page1_axrt300_07.xrcbseq_4
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD xrcbseq_4
            #add-point:ON ACTION controlp INFIELD xrcbseq_4 name="input.c.page1_axrt300_07.xrcbseq_4"
            
            #END add-point
 
 
         #Ctrlp:input.c.page1_axrt300_07.xrcb047
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD xrcb047
            #add-point:ON ACTION controlp INFIELD xrcb047 name="input.c.page1_axrt300_07.xrcb047"
            
            #END add-point
 
 
         #Ctrlp:input.c.page1_axrt300_07.xrcb029
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD xrcb029
            #add-point:ON ACTION controlp INFIELD xrcb029 name="input.c.page1_axrt300_07.xrcb029"
            
            #END add-point
 
 
         #Ctrlp:input.c.page1_axrt300_07.xrcb029_desc
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD xrcb029_desc
            #add-point:ON ACTION controlp INFIELD xrcb029_desc name="input.c.page1_axrt300_07.xrcb029_desc"
            
            #END add-point
 
 
         #Ctrlp:input.c.page1_axrt300_07.xrcb021
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD xrcb021
            #add-point:ON ACTION controlp INFIELD xrcb021 name="input.c.page1_axrt300_07.xrcb021"
            #應用 a07 樣板自動產生(Version:2)   
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xrcb_d[l_ac].xrcb021             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "" #


            CALL aglt310_04()                                #呼叫開窗

            LET g_xrcb_d[l_ac].xrcb021 = g_qryparam.return1              

            DISPLAY g_xrcb_d[l_ac].xrcb021 TO xrcb021              #

            NEXT FIELD xrcb021                          #返回原欄位


            #END add-point
 
 
         #Ctrlp:input.c.page1_axrt300_07.xrcb021_desc
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD xrcb021_desc
            #add-point:ON ACTION controlp INFIELD xrcb021_desc name="input.c.page1_axrt300_07.xrcb021_desc"
            
            #END add-point
 
 
         #Ctrlp:input.c.page1_axrt300_07.xrcb051
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD xrcb051
            #add-point:ON ACTION controlp INFIELD xrcb051 name="input.c.page1_axrt300_07.xrcb051"
            
            #END add-point
 
 
         #Ctrlp:input.c.page1_axrt300_07.xrcb051_desc
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD xrcb051_desc
            #add-point:ON ACTION controlp INFIELD xrcb051_desc name="input.c.page1_axrt300_07.xrcb051_desc"
            
            #END add-point
 
 
         #Ctrlp:input.c.page1_axrt300_07.xrcb010
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD xrcb010
            #add-point:ON ACTION controlp INFIELD xrcb010 name="input.c.page1_axrt300_07.xrcb010"
            
            #END add-point
 
 
         #Ctrlp:input.c.page1_axrt300_07.xrcb010_desc
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD xrcb010_desc
            #add-point:ON ACTION controlp INFIELD xrcb010_desc name="input.c.page1_axrt300_07.xrcb010_desc"
            
            #END add-point
 
 
         #Ctrlp:input.c.page1_axrt300_07.xrcb011
         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD xrcb011
            #add-point:ON ACTION controlp INFIELD xrcb011 name="input.c.page1_axrt300_07.xrcb011"
            #應用 a07 樣板自動產生(Version:2)   
           ##開窗i段
           #INITIALIZE g_qryparam.* TO NULL
           #LET g_qryparam.state = 'i'
           #LET g_qryparam.reqry = FALSE
           #
           #LET g_qryparam.default1 = g_xrcb_d[l_ac].xrcb011             #給予default值
           #
           ##給予arg
           #LET g_qryparam.arg1 = "" #
           #
           #
           #CALL axrt300_11()                                #呼叫開窗
           #
           #LET g_xrcb_d[l_ac].xrcb011 = g_qryparam.return1              
           #
           #DISPLAY g_xrcb_d[l_ac].xrcb011 TO xrcb011              #
           #
           #NEXT FIELD xrcb011                          #返回原欄位


            #END add-point
 
 
         #Ctrlp:input.c.page1_axrt300_07.xrcb011_desc
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD xrcb011_desc
            #add-point:ON ACTION controlp INFIELD xrcb011_desc name="input.c.page1_axrt300_07.xrcb011_desc"
            
            #END add-point
 
 
         #Ctrlp:input.c.page1_axrt300_07.xrcb024
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD xrcb024
            #add-point:ON ACTION controlp INFIELD xrcb024 name="input.c.page1_axrt300_07.xrcb024"
            
            #END add-point
 
 
         #Ctrlp:input.c.page1_axrt300_07.xrcb024_desc
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD xrcb024_desc
            #add-point:ON ACTION controlp INFIELD xrcb024_desc name="input.c.page1_axrt300_07.xrcb024_desc"
            
            #END add-point
 
 
         #Ctrlp:input.c.page1_axrt300_07.xrcb036
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD xrcb036
            #add-point:ON ACTION controlp INFIELD xrcb036 name="input.c.page1_axrt300_07.xrcb036"
            
            #END add-point
 
 
         #Ctrlp:input.c.page1_axrt300_07.xrcb036_desc
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD xrcb036_desc
            #add-point:ON ACTION controlp INFIELD xrcb036_desc name="input.c.page1_axrt300_07.xrcb036_desc"
            
            #END add-point
 
 
         #Ctrlp:input.c.page1_axrt300_07.xrcb012
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD xrcb012
            #add-point:ON ACTION controlp INFIELD xrcb012 name="input.c.page1_axrt300_07.xrcb012"
            
            #END add-point
 
 
         #Ctrlp:input.c.page1_axrt300_07.xrcb012_desc
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD xrcb012_desc
            #add-point:ON ACTION controlp INFIELD xrcb012_desc name="input.c.page1_axrt300_07.xrcb012_desc"
            
            #END add-point
 
 
         #Ctrlp:input.c.page1_axrt300_07.xrcb015
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD xrcb015
            #add-point:ON ACTION controlp INFIELD xrcb015 name="input.c.page1_axrt300_07.xrcb015"
            
            #END add-point
 
 
         #Ctrlp:input.c.page1_axrt300_07.xrcb015_desc
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD xrcb015_desc
            #add-point:ON ACTION controlp INFIELD xrcb015_desc name="input.c.page1_axrt300_07.xrcb015_desc"
            
            #END add-point
 
 
         #Ctrlp:input.c.page1_axrt300_07.xrcb016
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD xrcb016
            #add-point:ON ACTION controlp INFIELD xrcb016 name="input.c.page1_axrt300_07.xrcb016"
            
            #END add-point
 
 
         #Ctrlp:input.c.page1_axrt300_07.xrcb016_desc
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD xrcb016_desc
            #add-point:ON ACTION controlp INFIELD xrcb016_desc name="input.c.page1_axrt300_07.xrcb016_desc"
            
            #END add-point
 
 
         #Ctrlp:input.c.page1_axrt300_07.xrcb033
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD xrcb033
            #add-point:ON ACTION controlp INFIELD xrcb033 name="input.c.page1_axrt300_07.xrcb033"
            
            #END add-point
 
 
         #Ctrlp:input.c.page1_axrt300_07.xrcb034
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD xrcb034
            #add-point:ON ACTION controlp INFIELD xrcb034 name="input.c.page1_axrt300_07.xrcb034"
            
            #END add-point
 
 
         #Ctrlp:input.c.page1_axrt300_07.xrcb034_desc
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD xrcb034_desc
            #add-point:ON ACTION controlp INFIELD xrcb034_desc name="input.c.page1_axrt300_07.xrcb034_desc"
            
            #END add-point
 
 
         #Ctrlp:input.c.page1_axrt300_07.xrcb035
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD xrcb035
            #add-point:ON ACTION controlp INFIELD xrcb035 name="input.c.page1_axrt300_07.xrcb035"
            
            #END add-point
 
 
         #Ctrlp:input.c.page1_axrt300_07.xrcb035_desc
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD xrcb035_desc
            #add-point:ON ACTION controlp INFIELD xrcb035_desc name="input.c.page1_axrt300_07.xrcb035_desc"
            
            #END add-point
 
 
         #Ctrlp:input.c.page1_axrt300_07.xrcb053
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD xrcb053
            #add-point:ON ACTION controlp INFIELD xrcb053 name="input.c.page1_axrt300_07.xrcb053"
            
            #END add-point
 
 
         #Ctrlp:input.c.page1_axrt300_07.xrcb053_desc
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD xrcb053_desc
            #add-point:ON ACTION controlp INFIELD xrcb053_desc name="input.c.page1_axrt300_07.xrcb053_desc"
            
            #END add-point
 
 
         #Ctrlp:input.c.page1_axrt300_07.xrcb054
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD xrcb054
            #add-point:ON ACTION controlp INFIELD xrcb054 name="input.c.page1_axrt300_07.xrcb054"
            
            #END add-point
 
 
         #Ctrlp:input.c.page1_axrt300_07.xrcb054_desc
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD xrcb054_desc
            #add-point:ON ACTION controlp INFIELD xrcb054_desc name="input.c.page1_axrt300_07.xrcb054_desc"
            
            #END add-point
 
 
         #Ctrlp:input.c.page1_axrt300_07.xrcb037
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD xrcb037
            #add-point:ON ACTION controlp INFIELD xrcb037 name="input.c.page1_axrt300_07.xrcb037"
            
            #END add-point
 
 
         #Ctrlp:input.c.page1_axrt300_07.xrcb037_desc
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD xrcb037_desc
            #add-point:ON ACTION controlp INFIELD xrcb037_desc name="input.c.page1_axrt300_07.xrcb037_desc"
            
            #END add-point
 
 
         #Ctrlp:input.c.page1_axrt300_07.xrcb038
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD xrcb038
            #add-point:ON ACTION controlp INFIELD xrcb038 name="input.c.page1_axrt300_07.xrcb038"
            
            #END add-point
 
 
         #Ctrlp:input.c.page1_axrt300_07.xrcb038_desc
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD xrcb038_desc
            #add-point:ON ACTION controlp INFIELD xrcb038_desc name="input.c.page1_axrt300_07.xrcb038_desc"
            
            #END add-point
 
 
         #Ctrlp:input.c.page1_axrt300_07.xrcb039
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD xrcb039
            #add-point:ON ACTION controlp INFIELD xrcb039 name="input.c.page1_axrt300_07.xrcb039"
            
            #END add-point
 
 
         #Ctrlp:input.c.page1_axrt300_07.xrcb039_desc
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD xrcb039_desc
            #add-point:ON ACTION controlp INFIELD xrcb039_desc name="input.c.page1_axrt300_07.xrcb039_desc"
            
            #END add-point
 
 
         #Ctrlp:input.c.page1_axrt300_07.xrcb040
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD xrcb040
            #add-point:ON ACTION controlp INFIELD xrcb040 name="input.c.page1_axrt300_07.xrcb040"
            
            #END add-point
 
 
         #Ctrlp:input.c.page1_axrt300_07.xrcb040_desc
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD xrcb040_desc
            #add-point:ON ACTION controlp INFIELD xrcb040_desc name="input.c.page1_axrt300_07.xrcb040_desc"
            
            #END add-point
 
 
         #Ctrlp:input.c.page1_axrt300_07.xrcb041
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD xrcb041
            #add-point:ON ACTION controlp INFIELD xrcb041 name="input.c.page1_axrt300_07.xrcb041"
            
            #END add-point
 
 
         #Ctrlp:input.c.page1_axrt300_07.xrcb041_desc
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD xrcb041_desc
            #add-point:ON ACTION controlp INFIELD xrcb041_desc name="input.c.page1_axrt300_07.xrcb041_desc"
            
            #END add-point
 
 
         #Ctrlp:input.c.page1_axrt300_07.xrcb042
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD xrcb042
            #add-point:ON ACTION controlp INFIELD xrcb042 name="input.c.page1_axrt300_07.xrcb042"
            
            #END add-point
 
 
         #Ctrlp:input.c.page1_axrt300_07.xrcb042_desc
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD xrcb042_desc
            #add-point:ON ACTION controlp INFIELD xrcb042_desc name="input.c.page1_axrt300_07.xrcb042_desc"
            
            #END add-point
 
 
         #Ctrlp:input.c.page1_axrt300_07.xrcb043
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD xrcb043
            #add-point:ON ACTION controlp INFIELD xrcb043 name="input.c.page1_axrt300_07.xrcb043"
            
            #END add-point
 
 
         #Ctrlp:input.c.page1_axrt300_07.xrcb043_desc
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD xrcb043_desc
            #add-point:ON ACTION controlp INFIELD xrcb043_desc name="input.c.page1_axrt300_07.xrcb043_desc"
            
            #END add-point
 
 
         #Ctrlp:input.c.page1_axrt300_07.xrcb044
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD xrcb044
            #add-point:ON ACTION controlp INFIELD xrcb044 name="input.c.page1_axrt300_07.xrcb044"
            
            #END add-point
 
 
         #Ctrlp:input.c.page1_axrt300_07.xrcb044_desc
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD xrcb044_desc
            #add-point:ON ACTION controlp INFIELD xrcb044_desc name="input.c.page1_axrt300_07.xrcb044_desc"
            
            #END add-point
 
 
         #Ctrlp:input.c.page1_axrt300_07.xrcb045
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD xrcb045
            #add-point:ON ACTION controlp INFIELD xrcb045 name="input.c.page1_axrt300_07.xrcb045"
            
            #END add-point
 
 
         #Ctrlp:input.c.page1_axrt300_07.xrcb045_desc
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD xrcb045_desc
            #add-point:ON ACTION controlp INFIELD xrcb045_desc name="input.c.page1_axrt300_07.xrcb045_desc"
            
            #END add-point
 
 
         #Ctrlp:input.c.page1_axrt300_07.xrcb046
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD xrcb046
            #add-point:ON ACTION controlp INFIELD xrcb046 name="input.c.page1_axrt300_07.xrcb046"
            
            #END add-point
 
 
         #Ctrlp:input.c.page1_axrt300_07.xrcb046_desc
#         #應用 a03 樣板自動產生(Version:3)
         ON ACTION controlp INFIELD xrcb046_desc
            #add-point:ON ACTION controlp INFIELD xrcb046_desc name="input.c.page1_axrt300_07.xrcb046_desc"
            
            #END add-point
 
 
 
 
         #自訂ACTION
         #add-point:單身其他段落處理(EX:on row change, etc...) name="input.other"
         
         #end add-point
 
         AFTER INPUT
            #add-point:單身輸入後處理 name="input.after_input"
            
            #end add-point
            
      END INPUT
      
 
      
      #add-point:自定義input name="input.more_input"
      
      #end add-point
    
      #公用action
      ON ACTION accept
         ACCEPT DIALOG
        
      ON ACTION cancel
         #add-point:cancel name="input.cancel"
         
         #end add-point
         LET INT_FLAG = TRUE 
         EXIT DIALOG
 
      ON ACTION close
         LET INT_FLAG = TRUE 
         EXIT DIALOG
 
      ON ACTION exit
         LET INT_FLAG = TRUE 
         EXIT DIALOG
   
      #交談指令共用ACTION
      &include "common_action.4gl" 
         CONTINUE DIALOG 
   END DIALOG
 
   #add-point:畫面關閉前 name="input.before_close"
}
   #end add-point
   
   #畫面關閉
   CLOSE WINDOW w_axrt300_07 
   
   #add-point:input段after input name="input.post_input"
   
   #end add-point    
   
END FUNCTION
 
{</section>}
 
{<section id="axrt300_07.other_dialog" readonly="Y" >}
################################################################################
# Descriptions...: 單身其他訊息
# Memo...........:
# Usage..........: axrt300_07_display()
# Date & Author..: 2015/03/16 By 01727
# Modify.........:
################################################################################
DIALOG axrt300_07_display()

   DISPLAY ARRAY g_xrcb_d TO s_detail1_axrt300_07.* ATTRIBUTES(COUNT=g_rec_b04) 
   
      BEFORE DISPLAY
         CALL FGL_SET_ARR_CURR(g_detail_idx)
      
      AFTER DISPLAY
         LET g_xrcb_d4.* = g_xrcb_d.*
   END DISPLAY
   
END DIALOG
################################################################################
# Descriptions...: 
# Memo...........:
# Usage..........: axrt300_07_input()
# Date & Author..: 2015/03/16 By 01727
# Modify.........:
################################################################################
DIALOG axrt300_07_input()
#DEFINE xrcb         RECORD LIKE xrcb_t.* #161128-00061#4--mark
DEFINE l_forupd_sql   STRING
DEFINE l_lock_sw      LIKE type_t.chr1 
DEFINE l_xrcadocdt    LIKE xrca_t.xrcadocdt
DEFINE l_xrcald       LIKE xrca_t.xrcald
DEFINE l_xrcadocno    LIKE xrca_t.xrcadocno
DEFINE l_glaa004      LIKE glaa_t.glaa004   
DEFINE l_glaa121      LIKE glaa_t.glaa121  
DEFINE l_glaacomp     LIKE glaa_t.glaacomp
DEFINE l_glaa139      LIKE glaa_t.glaa139   #151008-00009#8
DEFINE l_n            LIKE type_t.num5
DEFINE l_dfin0030     LIKE type_t.chr1
DEFINE l_ap_slip      LIKE xrca_t.xrcadocno
DEFINE l_cmd          LIKE type_t.chr5
DEFINE l_glae009      LIKE glae_t.glae009
DEFINE l_glad         RECORD
                      glad0171    LIKE  glad_t.glad0171, 
                      glad0172    LIKE  glad_t.glad0172,
                      glad0181    LIKE  glad_t.glad0181,
                      glad0182    LIKE  glad_t.glad0182,
                      glad0191    LIKE  glad_t.glad0191,
                      glad0192    LIKE  glad_t.glad0192,
                      glad0201    LIKE  glad_t.glad0201,
                      glad0202    LIKE  glad_t.glad0202,
                      glad0211    LIKE  glad_t.glad0211,
                      glad0212    LIKE  glad_t.glad0212,
                      glad0221    LIKE  glad_t.glad0221,
                      glad0222    LIKE  glad_t.glad0222,
                      glad0231    LIKE  glad_t.glad0231,
                      glad0232    LIKE  glad_t.glad0232,
                      glad0241    LIKE  glad_t.glad0241,
                      glad0242    LIKE  glad_t.glad0242,
                      glad0251    LIKE  glad_t.glad0251,
                      glad0252    LIKE  glad_t.glad0252,
                      glad0261    LIKE  glad_t.glad0261,
                      glad0262    LIKE  glad_t.glad0262
                  END RECORD
#161221-00054#2 add ------
DEFINE l_wc          STRING
DEFINE l_glak_sql    STRING
DEFINE l_ooaa002     LIKE ooaa_t.ooaa002
#161221-00054#2 add end---                  
   
   INPUT ARRAY g_xrcb_d FROM s_detail1_axrt300_07.*
      ATTRIBUTE(COUNT = g_rec_b04,MAXCOUNT = g_rec_b04,WITHOUT DEFAULTS, 
                INSERT ROW = FALSE,
                DELETE ROW = FALSE,
                APPEND ROW = FALSE)
         
      BEFORE INPUT 
         SELECT xrcadocdt INTO l_xrcadocdt
           FROM xrca_t
          WHERE xrcaent = g_enterprise
            AND xrcald  = g_xrcb_d[1].xrcbld AND xrcadocno =  g_xrcb_d[1].xrcbdocno
        #CALL s_ld_sel_glaa(g_xrcb_d[1].xrcbld,'glaa004|glaa121|glaacomp') RETURNING g_sub_success,l_glaa004,l_glaa121,l_glaacomp   #151008-00009#8 mark
         CALL s_ld_sel_glaa(g_xrcb_d[1].xrcbld,'glaa004|glaa121|glaacomp|glaa139')    #151008-00009#8 
          RETURNING g_sub_success,l_glaa004,l_glaa121,l_glaacomp,l_glaa139            #151008-00009#8 
         CALL cl_set_combo_scc('xrcb033','6013')
         LET l_forupd_sql = " SELECT xrcbdocno,xrcbld,xrcbseq,xrcb047,  ",
                            "        xrcb029,'',xrcb021,'',xrcb051,'',xrcb010,'',xrcb011,'',xrcb024,'',",
                            "        xrcb036,'',xrcb012,'',xrcb015,'',xrcb016,'',xrcb033,   xrcb034,'',",
                            "        xrcb035,'',",
                            "        xrcb037,'',xrcb038,'',xrcb039,'',xrcb040,'',xrcb041,'',",
                            "        xrcb042,'',xrcb043,'',xrcb044,'',xrcb045,'',xrcb046,'' ",
                            "   FROM xrcb_t ",
                            "  WHERE xrcbent = ",g_enterprise," AND xrcbld = ? AND xrcbdocno = ? AND xrcbseq = ?",
                            "    FOR UPDATE"
         LET l_forupd_sql = cl_sql_forupd(l_forupd_sql)  
         PREPARE axrt300_07_input_p FROM l_forupd_sql
         DECLARE axrt300_07_input_c CURSOR FOR axrt300_07_input_p

            
      BEFORE ROW
         LET l_cmd = ''
         LET l_ac = ARR_CURR()
         LET l_lock_sw = 'N'            #DEFAULT
         DISPLAY l_ac TO FORMONLY.idx
      
         CALL s_transaction_begin()
         LET g_rec_b = g_xrcb_d.getLength()
         
         LET l_cmd='u'
         SELECT xrcadocdt INTO l_xrcadocdt
           FROM xrca_t
          WHERE xrcaent = g_enterprise  
            AND xrcald  = g_xrcb_d[l_ac].xrcbld AND xrcadocno = g_xrcb_d[l_ac].xrcbdocno
         LET l_xrcald   = g_xrcb_d[l_ac].xrcbld
         LET l_xrcadocno= g_xrcb_d[l_ac].xrcbdocno
         LET g_xrcb_d_t.* = g_xrcb_d[l_ac].*  
         CALL s_transaction_begin()
         
         OPEN axrt300_07_input_c USING g_xrcb_d[l_ac].xrcbld,g_xrcb_d[l_ac].xrcbdocno,g_xrcb_d[l_ac].xrcbseq 
         IF SQLCA.sqlcode THEN
            LET l_lock_sw='Y'
         ELSE
            FETCH axrt300_07_input_c INTO g_xrcb_d[l_ac].*
            IF SQLCA.sqlcode THEN
               LET l_lock_sw = "Y"
            END IF
            CALL cl_show_fld_cont()
            
            #一定要寫在這個位置，避免觸發SQLCA.sqlcode導致l_lock_sw = "Y"
            CALL s_fin_sel_glad(g_xrcb_d[l_ac].xrcbld,g_xrcb_d[l_ac].xrcb021,'glad0171|glad0172|glad0181|glad0182|glad0191|glad0192|glad0201|glad0202|glad0211|glad0212|glad0221|glad0222|glad0231|glad0232|glad0241|glad0242|glad0251|glad0252|glad0261|glad0262') 
                 RETURNING g_errno,l_glad.*
            LET g_xrcb_d[l_ac].xrcb051_desc = s_desc_show1(g_xrcb_d[l_ac].xrcb051,s_desc_get_person_desc(g_xrcb_d[l_ac].xrcb051))
            LET g_xrcb_d[l_ac].xrcb010_desc = s_desc_show1(g_xrcb_d[l_ac].xrcb010,s_desc_get_department_desc(g_xrcb_d[l_ac].xrcb010))
            LET g_xrcb_d[l_ac].xrcb011_desc = s_desc_show1(g_xrcb_d[l_ac].xrcb011,s_desc_get_department_desc(g_xrcb_d[l_ac].xrcb011))
            LET g_xrcb_d[l_ac].xrcb012_desc = s_desc_show1(g_xrcb_d[l_ac].xrcb012,s_desc_get_rtaxl003_desc(g_xrcb_d[l_ac].xrcb012))
            LET g_xrcb_d[l_ac].xrcb015_desc = s_desc_show1(g_xrcb_d[l_ac].xrcb015,s_desc_get_project_desc(g_xrcb_d[l_ac].xrcb015))
            LET g_xrcb_d[l_ac].xrcb021_desc = s_desc_show1(g_xrcb_d[l_ac].xrcb021 ,s_desc_get_account_desc(g_xrcb_d[l_ac].xrcbld,g_xrcb_d[l_ac].xrcb021))
            LET g_xrcb_d[l_ac].xrcb024_desc = s_desc_show1(g_xrcb_d[l_ac].xrcb024,s_desc_get_acc_desc('287',g_xrcb_d[l_ac].xrcb024))
            
            LET g_xrcb_d[l_ac].xrcb029_desc = s_desc_show1(g_xrcb_d[l_ac].xrcb029 ,s_desc_get_account_desc(g_xrcb_d[l_ac].xrcbld,g_xrcb_d[l_ac].xrcb029))
            LET g_xrcb_d[l_ac].xrcb034_desc = s_desc_show1(g_xrcb_d[l_ac].xrcb034, s_desc_get_oojdl003_desc(g_xrcb_d[l_ac].xrcb034))
            LET g_xrcb_d[l_ac].xrcb035_desc = s_desc_show1(g_xrcb_d[l_ac].xrcb035,s_desc_get_acc_desc('2002',g_xrcb_d[l_ac].xrcb035))
            LET g_xrcb_d[l_ac].xrcb036_desc = s_desc_show1(g_xrcb_d[l_ac].xrcb036,s_desc_get_acc_desc('281',g_xrcb_d[l_ac].xrcb036))
            IF NOT cl_null(g_xrcb_d[l_ac].xrcb037_desc) THEN
               LET g_xrcb_d[l_ac].xrcb037_desc = s_desc_show1(g_xrcb_d[l_ac].xrcb037,s_fin_get_accting_desc(l_glad.glad0171,g_xrcb_d[l_ac].xrcb037))
            END IF
            IF NOT cl_null(g_xrcb_d[l_ac].xrcb038_desc) THEN
               LET g_xrcb_d[l_ac].xrcb038_desc = s_desc_show1(g_xrcb_d[l_ac].xrcb038,s_fin_get_accting_desc(l_glad.glad0181,g_xrcb_d[l_ac].xrcb038))
            END IF
            IF NOT cl_null(g_xrcb_d[l_ac].xrcb039_desc) THEN
               LET g_xrcb_d[l_ac].xrcb039_desc = s_desc_show1(g_xrcb_d[l_ac].xrcb039,s_fin_get_accting_desc(l_glad.glad0191,g_xrcb_d[l_ac].xrcb039))
            END IF
            IF NOT cl_null(g_xrcb_d[l_ac].xrcb040_desc) THEN
               LET g_xrcb_d[l_ac].xrcb040_desc = s_desc_show1(g_xrcb_d[l_ac].xrcb040,s_fin_get_accting_desc(l_glad.glad0201,g_xrcb_d[l_ac].xrcb040))
            END IF
            IF NOT cl_null(g_xrcb_d[l_ac].xrcb041_desc) THEN
               LET g_xrcb_d[l_ac].xrcb041_desc = s_desc_show1(g_xrcb_d[l_ac].xrcb041,s_fin_get_accting_desc(l_glad.glad0211,g_xrcb_d[l_ac].xrcb041))
            END IF
            IF NOT cl_null(g_xrcb_d[l_ac].xrcb042_desc) THEN
               LET g_xrcb_d[l_ac].xrcb042_desc = s_desc_show1(g_xrcb_d[l_ac].xrcb042,s_fin_get_accting_desc(l_glad.glad0221,g_xrcb_d[l_ac].xrcb042))
            END IF
            IF NOT cl_null(g_xrcb_d[l_ac].xrcb043_desc) THEN
               LET g_xrcb_d[l_ac].xrcb043_desc = s_desc_show1(g_xrcb_d[l_ac].xrcb043,s_fin_get_accting_desc(l_glad.glad0231,g_xrcb_d[l_ac].xrcb043))
            END IF
            IF NOT cl_null(g_xrcb_d[l_ac].xrcb044_desc) THEN
               LET g_xrcb_d[l_ac].xrcb044_desc = s_desc_show1(g_xrcb_d[l_ac].xrcb044,s_fin_get_accting_desc(l_glad.glad0241,g_xrcb_d[l_ac].xrcb044))
            END IF
            IF NOT cl_null(g_xrcb_d[l_ac].xrcb045_desc) THEN
               LET g_xrcb_d[l_ac].xrcb045_desc = s_desc_show1(g_xrcb_d[l_ac].xrcb045,s_fin_get_accting_desc(l_glad.glad0251,g_xrcb_d[l_ac].xrcb045))
            END IF
            IF NOT cl_null(g_xrcb_d[l_ac].xrcb046_desc) THEN
               LET g_xrcb_d[l_ac].xrcb046_desc = s_desc_show1(g_xrcb_d[l_ac].xrcb046,s_fin_get_accting_desc(l_glad.glad0261,g_xrcb_d[l_ac].xrcb046))
            END IF
            #161221-00054#2 add ------
            LET l_wc = g_xrcb_d[l_ac].xrcb021,",",g_xrcb_d[l_ac].xrcb029
            CALL s_fin_get_wc_str(l_wc) RETURNING l_wc
            #161221-00054#2 add end---      
         END IF

      ON ROW CHANGE
         IF INT_FLAG THEN
            INITIALIZE g_errparam TO NULL
            LET g_errparam.code = 9001
            LET g_errparam.extend = ''
            LET g_errparam.popup = TRUE
            CALL cl_err()
            LET INT_FLAG = 0
            LET g_xrcb_d[l_ac].* = g_xrcb_d_t.*
            CLOSE axrt300_07_input_c
            CALL s_transaction_end('N',0)
            EXIT DIALOG 
         END IF
            
            
         IF l_lock_sw = 'Y' THEN
            INITIALIZE g_errparam TO NULL
            LET g_errparam.code = -263
            LET g_errparam.extend = g_xrcb_d[l_ac].xrcbseq                
            LET g_errparam.popup = TRUE
            CALL cl_err()
            LET g_xrcb_d[l_ac].* = g_xrcb_d_t.*
         ELSE
            #151008-00009#8--s
            IF l_glaa139 = 'Y' THEN
               UPDATE xreq_t SET xreq013 = g_xrcb_d[l_ac].xrcb021, xreq023 = g_xrcb_d[l_ac].xrcb051, 
                                 xreq018 = g_xrcb_d[l_ac].xrcb010, xreq019 = g_xrcb_d[l_ac].xrcb011,
                                 xreq020 = g_xrcb_d[l_ac].xrcb024, xreq022 = g_xrcb_d[l_ac].xrcb012,
                                 xreq024 = g_xrcb_d[l_ac].xrcb015, xreq025 = g_xrcb_d[l_ac].xrcb016,
                                 xreq026 = g_xrcb_d[l_ac].xrcb033, xreq027 = g_xrcb_d[l_ac].xrcb034,
                                 xreq028 = g_xrcb_d[l_ac].xrcb035, xreq021 = g_xrcb_d[l_ac].xrcb036,
                                 xreq029 = g_xrcb_d[l_ac].xrcb037, xreq030 = g_xrcb_d[l_ac].xrcb038,
                                 xreq031 = g_xrcb_d[l_ac].xrcb039, xreq032 = g_xrcb_d[l_ac].xrcb040,
                                 xreq033 = g_xrcb_d[l_ac].xrcb041, xreq034 = g_xrcb_d[l_ac].xrcb042,
                                 xreq035 = g_xrcb_d[l_ac].xrcb043, xreq036 = g_xrcb_d[l_ac].xrcb044,
                                 xreq037 = g_xrcb_d[l_ac].xrcb045, xreq038 = g_xrcb_d[l_ac].xrcb046,
                                 xreq039 = g_xrcb_d[l_ac].xrcb047
                WHERE xreqent = g_enterprise AND xreqld = g_xrcb_d[l_ac].xrcbld
                  AND xreqdocno = g_xrcb_d[l_ac].xrcbdocno AND xreq046 = g_xrcb_d[l_ac].xrcbseq  
            END IF                                                                                               
            #151008-00009#8--e
            UPDATE xrcb_t SET xrcb021 = g_xrcb_d[l_ac].xrcb021, xrcb029 = g_xrcb_d[l_ac].xrcb029,
                              xrcb051 = g_xrcb_d[l_ac].xrcb051, 
                              xrcb010 = g_xrcb_d[l_ac].xrcb010, xrcb011 = g_xrcb_d[l_ac].xrcb011,
                              xrcb024 = g_xrcb_d[l_ac].xrcb024, xrcb012 = g_xrcb_d[l_ac].xrcb012,
                              xrcb015 = g_xrcb_d[l_ac].xrcb015, xrcb016 = g_xrcb_d[l_ac].xrcb016,
                              xrcb033 = g_xrcb_d[l_ac].xrcb033, xrcb034 = g_xrcb_d[l_ac].xrcb034,
                              xrcb035 = g_xrcb_d[l_ac].xrcb035, xrcb036 = g_xrcb_d[l_ac].xrcb036,
                              xrcb037 = g_xrcb_d[l_ac].xrcb037, xrcb038 = g_xrcb_d[l_ac].xrcb038,
                              xrcb039 = g_xrcb_d[l_ac].xrcb039, xrcb040 = g_xrcb_d[l_ac].xrcb040,
                              xrcb041 = g_xrcb_d[l_ac].xrcb041, xrcb042 = g_xrcb_d[l_ac].xrcb042,
                              xrcb043 = g_xrcb_d[l_ac].xrcb043, xrcb044 = g_xrcb_d[l_ac].xrcb044,
                              xrcb045 = g_xrcb_d[l_ac].xrcb045, xrcb046 = g_xrcb_d[l_ac].xrcb046,
                              xrcb047 = g_xrcb_d[l_ac].xrcb047,
                              xrcb053 = g_xrcb_d[l_ac].xrcb053,xrcb054 = g_xrcb_d[l_ac].xrcb054    #160509-00004#37 add lujh
             WHERE xrcbent = g_enterprise AND xrcbld = g_xrcb_d[l_ac].xrcbld
               AND xrcbdocno = g_xrcb_d[l_ac].xrcbdocno AND xrcbseq = g_xrcb_d[l_ac].xrcbseq  

            IF SQLCA.sqlcode THEN
               INITIALIZE g_errparam TO NULL
               LET g_errparam.code = SQLCA.sqlcode
               LET g_errparam.extend = "xrcb_t"
               LET g_errparam.popup = TRUE
               CALL cl_err()

               LET g_xrcb_d[l_ac].* = g_xrcb_d_t.*
               CALL s_transaction_end('N',0) 
            ELSE
               CALL s_transaction_end('Y',0)                
            END IF

         END IF
            
         AFTER ROW
            CLOSE axrt300_07_input_c
  
         BEFORE FIELD xrcb021_desc                                    #150205-00012#1
            LET g_xrcb_d[l_ac].xrcb021_desc = g_xrcb_d[l_ac].xrcb021  #150205-00012#1  
         
         #費用會計科目     
         AFTER FIELD xrcb021_desc
            IF NOT cl_null(g_xrcb_d[l_ac].xrcb021_desc) THEN
               IF g_xrcb_d[l_ac].xrcb021_desc != g_xrcb_d_t.xrcb021_desc OR g_xrcb_d_t.xrcb021_desc IS NULL THEN
                  LET g_xrcb_d[l_ac].xrcb021 = g_xrcb_d[l_ac].xrcb021_desc
                  IF (g_xrcb_d[l_ac].xrcb021 != g_xrcb_d_t.xrcb021 OR g_xrcb_d_t.xrcb021 IS NULL) THEN
                     CALL s_aap_glac002_chk(g_xrcb_d[l_ac].xrcb021,g_xrcb_d[l_ac].xrcbld) RETURNING g_sub_success,g_errno
                     IF NOT g_sub_success THEN
                        INITIALIZE g_errparam TO NULL
                        LET g_errparam.code = g_errno
                        LET g_errparam.extend = ''
                        LET g_errparam.popup = TRUE
                        #160321-00016#52 --s add
                        LET g_errparam.replace[1] = 'agli020'
                        LET g_errparam.replace[2] = cl_get_progname('agli020',g_lang,"2")
                        LET g_errparam.exeprog = 'agli020'
                        #160321-00016#52 --e add  
                        CALL cl_err()
                        LET g_xrcb_d[l_ac].xrcb021        = g_xrcb_d_t.xrcb021
                        LET g_xrcb_d[l_ac].xrcb021_desc = g_xrcb_d_t.xrcb021_desc
                        DISPLAY BY NAME g_xrcb_d[l_ac].xrcb021,g_xrcb_d[l_ac].xrcb021_desc
                        NEXT FIELD CURRENT
                     END IF
                  END IF
               END IF
            ELSE
               LET g_xrcb_d[l_ac].xrcb021 = ''
            END IF
            LET g_xrcb_d[l_ac].xrcb021_desc = s_desc_show1(g_xrcb_d[l_ac].xrcb021 ,s_desc_get_account_desc(g_xrcb_d[l_ac].xrcbld,g_xrcb_d[l_ac].xrcb021))
            LET g_xrcb_d_t.xrcb021_desc = g_xrcb_d[l_ac].xrcb021_desc            
            DISPLAY BY NAME g_xrcb_d[l_ac].xrcb021,g_xrcb_d[l_ac].xrcb021_desc
            #161221-00054#2 add ------
            LET l_wc = g_xrcb_d[l_ac].xrcb021,",",g_xrcb_d[l_ac].xrcb029
            CALL s_fin_get_wc_str(l_wc) RETURNING l_wc
            #161221-00054#2 add end---                
            
         ON ACTION controlp INFIELD xrcb021_desc
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_xrcb_d[l_ac].xrcb021    
            LET g_qryparam.where = "glac001 = '",l_glaa004,"' AND  glac003 <>'1' "  #glac001(會計科目參照表)/glac003(科目類型)
            CALL aglt310_04()                               
            LET g_xrcb_d[l_ac].xrcb021       = g_qryparam.return1
            LET g_xrcb_d[l_ac].xrcb021_desc= g_xrcb_d[l_ac].xrcb021
            DISPLAY BY NAME g_xrcb_d[l_ac].xrcb021,g_xrcb_d[l_ac].xrcb021_desc
            NEXT FIELD xrcb021_desc     
         
         BEFORE FIELD xrcb029_desc                                    #150205-00012#1
            LET g_xrcb_d[l_ac].xrcb029_desc = g_xrcb_d[l_ac].xrcb029  #150205-00012#1
            
         #應付帳款科目               
         AFTER FIELD xrcb029_desc
            IF NOT cl_null(g_xrcb_d[l_ac].xrcb029_desc) THEN
               IF g_xrcb_d[l_ac].xrcb029_desc != g_xrcb_d_t.xrcb029_desc OR g_xrcb_d_t.xrcb029_desc IS NULL THEN
                  LET g_xrcb_d[l_ac].xrcb029 = g_xrcb_d[l_ac].xrcb029_desc
                  IF (g_xrcb_d[l_ac].xrcb029 != g_xrcb_d_t.xrcb029 OR g_xrcb_d_t.xrcb029 IS NULL) THEN
                     CALL s_aap_glac002_chk(g_xrcb_d[l_ac].xrcb029,g_xrcb_d[l_ac].xrcbld) RETURNING g_sub_success,g_errno
                     IF NOT g_sub_success THEN
                        INITIALIZE g_errparam TO NULL
                        LET g_errparam.code = g_errno
                        LET g_errparam.extend = ''
                        LET g_errparam.popup = TRUE
                        #160321-00016#52 --s add
                        LET g_errparam.replace[1] = 'agli020'
                        LET g_errparam.replace[2] = cl_get_progname('agli020',g_lang,"2")
                        LET g_errparam.exeprog = 'agli020'
                        #160321-00016#52 --e add  
                        CALL cl_err()
                        LET g_xrcb_d[l_ac].xrcb029        = g_xrcb_d_t.xrcb029
                        LET g_xrcb_d[l_ac].xrcb029_desc = g_xrcb_d_t.xrcb029_desc
                        DISPLAY BY NAME g_xrcb_d[l_ac].xrcb029,g_xrcb_d[l_ac].xrcb029_desc
                        NEXT FIELD CURRENT
                     END IF
                  END IF
               END IF
            ELSE
               LET g_xrcb_d[l_ac].xrcb029 = ''
            END IF
            LET g_xrcb_d[l_ac].xrcb029_desc = s_desc_show1(g_xrcb_d[l_ac].xrcb029 ,s_desc_get_account_desc(g_xrcb_d[l_ac].xrcbld,g_xrcb_d[l_ac].xrcb029))
            LET g_xrcb_d_t.xrcb029_desc = g_xrcb_d[l_ac].xrcb029_desc
            DISPLAY BY NAME g_xrcb_d[l_ac].xrcb029,g_xrcb_d[l_ac].xrcb029_desc
            #161221-00054#2 add ------
            LET l_wc = g_xrcb_d[l_ac].xrcb021,",",g_xrcb_d[l_ac].xrcb029
            CALL s_fin_get_wc_str(l_wc) RETURNING l_wc
            #161221-00054#2 add end---    
            
         ON ACTION controlp INFIELD xrcb029_desc
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_xrcb_d[l_ac].xrcb029
            LET g_qryparam.where = "glac001 = '",l_glaa004,"' AND  glac003 <>'1' "  #glac001(會計科目參照表)/glac003(科目類型)
            CALL aglt310_04()                               
            LET g_xrcb_d[l_ac].xrcb029       = g_qryparam.return1
            LET g_xrcb_d[l_ac].xrcb029_desc= g_xrcb_d[l_ac].xrcb029
            DISPLAY BY NAME g_xrcb_d[l_ac].xrcb029,g_xrcb_d[l_ac].xrcb029_desc
            NEXT FIELD xrcb029_desc     
          
         BEFORE FIELD xrcb051_desc                                    #150205-00012#1
            LET g_xrcb_d[l_ac].xrcb051_desc = g_xrcb_d[l_ac].xrcb051  #150205-00012#1
         
         #業務人員
         AFTER FIELD xrcb051_desc
            IF NOT cl_null(g_xrcb_d[l_ac].xrcb051_desc) THEN
               IF ( g_xrcb_d[l_ac].xrcb051_desc != g_xrcb_d_t.xrcb051_desc OR g_xrcb_d_t.xrcb051_desc IS NULL ) THEN
                  LET g_xrcb_d[l_ac].xrcb051 = g_xrcb_d[l_ac].xrcb051_desc
                  IF l_glaa121 = 'N' THEN     #141218-00011#6
                     IF (g_xrcb_d[l_ac].xrcb051 != g_xrcb_d_t.xrcb051 OR g_xrcb_d_t.xrcb051 IS NULL) THEN
                        CALL s_employee_chk(g_xrcb_d[l_ac].xrcb051) RETURNING g_sub_success
                        IF NOT g_sub_success THEN
                           LET g_xrcb_d[l_ac].xrcb051        = g_xrcb_d_t.xrcb051
                           LET g_xrcb_d[l_ac].xrcb051_desc = g_xrcb_d_t.xrcb051_desc
                           DISPLAY BY NAME g_xrcb_d[l_ac].xrcb051,g_xrcb_d[l_ac].xrcb051_desc
                           NEXT FIELD CURRENT
                        END IF
                        #161221-00054#2 add ------
                        #判断agli060是否设置限制核算项资料，如果设置，判断是否满足agli060条件
                        CALL s_voucher_hsx_glak_chk(g_xrcb_d[1].xrcbld,'12',g_xrcb_d[l_ac].xrcb021,g_xrcb_d[l_ac].xrcb051) RETURNING g_sub_success
                        IF NOT g_sub_success THEN
                           LET g_xrcb_d[l_ac].xrcb051        = g_xrcb_d_t.xrcb051
                           LET g_xrcb_d[l_ac].xrcb051_desc = g_xrcb_d_t.xrcb051_desc
                           DISPLAY BY NAME g_xrcb_d[l_ac].xrcb051,g_xrcb_d[l_ac].xrcb051_desc
                           NEXT FIELD CURRENT
                        END IF
                        CALL s_voucher_hsx_glak_chk(g_xrcb_d[1].xrcbld,'12',g_xrcb_d[l_ac].xrcb029,g_xrcb_d[l_ac].xrcb051) RETURNING g_sub_success
                        IF NOT g_sub_success THEN
                           LET g_xrcb_d[l_ac].xrcb051        = g_xrcb_d_t.xrcb051
                           LET g_xrcb_d[l_ac].xrcb051_desc = g_xrcb_d_t.xrcb051_desc
                           DISPLAY BY NAME g_xrcb_d[l_ac].xrcb051,g_xrcb_d[l_ac].xrcb051_desc
                           NEXT FIELD CURRENT
                        END IF
                        #161221-00054#2 add end---                        
                     END IF
                  END IF
               END IF
            ELSE
               LET g_xrcb_d[l_ac].xrcb051 = ''
            END IF
            LET g_xrcb_d[l_ac].xrcb051_desc = s_desc_show1(g_xrcb_d[l_ac].xrcb051,s_desc_get_person_desc(g_xrcb_d[l_ac].xrcb051))
            LET g_xrcb_d_t.xrcb051_desc = g_xrcb_d[l_ac].xrcb051_desc
            DISPLAY BY NAME g_xrcb_d[l_ac].xrcb051,g_xrcb_d[l_ac].xrcb051_desc
            
         ON ACTION controlp INFIELD xrcb051_desc
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_xrcb_d[l_ac].xrcb051
            #161221-00054#2 add ------
            #agli060设置的人員限制条件
            CALL s_voucher_get_glak_sql(g_xrcb_d[1].xrcbld,'12',l_wc) RETURNING l_glak_sql
            LET g_qryparam.where = l_glak_sql
            #161221-00054#2 add end---            
            CALL q_ooag001_8()                               
            LET g_xrcb_d[l_ac].xrcb051 = g_qryparam.return1    
            LET g_xrcb_d[l_ac].xrcb051_desc= g_xrcb_d[l_ac].xrcb051
            DISPLAY BY NAME g_xrcb_d[l_ac].xrcb051,g_xrcb_d[l_ac].xrcb051_desc
            NEXT FIELD xrcb051_desc   
            
         BEFORE FIELD xrcb010_desc                                    #150205-00012#1
            LET g_xrcb_d[l_ac].xrcb010_desc = g_xrcb_d[l_ac].xrcb010  #150205-00012#1
            
         #業務部門
         AFTER FIELD xrcb010_desc
            IF NOT cl_null(g_xrcb_d[l_ac].xrcb010_desc)  THEN
               IF ( g_xrcb_d[l_ac].xrcb010_desc != g_xrcb_d_t.xrcb010_desc OR g_xrcb_d_t.xrcb010_desc IS NULL ) THEN
                  LET g_xrcb_d[l_ac].xrcb010 = g_xrcb_d[l_ac].xrcb010_desc
                  IF l_glaa121 = 'N' THEN     #141218-00011#6
                     IF (g_xrcb_d[l_ac].xrcb010 != g_xrcb_d_t.xrcb010 OR g_xrcb_d_t.xrcb010 IS NULL) THEN
                        CALL s_department_chk(g_xrcb_d[l_ac].xrcb010,l_xrcadocdt) RETURNING g_sub_success
                        IF NOT g_sub_success THEN
                           LET g_xrcb_d[l_ac].xrcb010        = g_xrcb_d_t.xrcb010
                           LET g_xrcb_d[l_ac].xrcb010_desc = g_xrcb_d_t.xrcb010_desc
                           DISPLAY BY NAME g_xrcb_d[l_ac].xrcb010,g_xrcb_d[l_ac].xrcb010_desc
                           NEXT FIELD CURRENT
                        END IF
                        #161221-00054#2 add ------
                        #判断agli060是否设置限制核算项资料，如果设置，判断是否满足agli060条件
                        CALL s_voucher_hsx_glak_chk(g_xrcb_d[1].xrcbld,'02',g_xrcb_d[l_ac].xrcb021,g_xrcb_d[l_ac].xrcb010) RETURNING g_sub_success
                        IF NOT g_sub_success THEN
                           LET g_xrcb_d[l_ac].xrcb010        = g_xrcb_d_t.xrcb010
                           LET g_xrcb_d[l_ac].xrcb010_desc = g_xrcb_d_t.xrcb010_desc
                           DISPLAY BY NAME g_xrcb_d[l_ac].xrcb010,g_xrcb_d[l_ac].xrcb010_desc
                           NEXT FIELD CURRENT
                        END IF
                        CALL s_voucher_hsx_glak_chk(g_xrcb_d[1].xrcbld,'02',g_xrcb_d[l_ac].xrcb029,g_xrcb_d[l_ac].xrcb010) RETURNING g_sub_success
                        IF NOT g_sub_success THEN
                           LET g_xrcb_d[l_ac].xrcb010        = g_xrcb_d_t.xrcb010
                           LET g_xrcb_d[l_ac].xrcb010_desc = g_xrcb_d_t.xrcb010_desc
                           DISPLAY BY NAME g_xrcb_d[l_ac].xrcb010,g_xrcb_d[l_ac].xrcb010_desc
                           NEXT FIELD CURRENT
                        END IF
                        #161221-00054#2 add end---                        
                     END IF
                  END IF
                  #141114-00010#20--(S)
                  CALL s_department_get_respon_center(g_xrcb_d[l_ac].xrcb010,l_xrcadocdt)
                       RETURNING g_sub_success,g_errno,g_xrcb_d[l_ac].xrcb011,g_xrcb_d[l_ac].xrcb011_desc
                  LET g_xrcb_d[l_ac].xrcb011_desc = s_desc_show1(g_xrcb_d[l_ac].xrcb011,g_xrcb_d[l_ac].xrcb011_desc)
                  LET g_xrcb_d_t.xrcb011_desc = g_xrcb_d[l_ac].xrcb011_desc
                  DISPLAY BY NAME g_xrcb_d[l_ac].xrcb011,g_xrcb_d[l_ac].xrcb011_desc
                  #141114-00010#20--(E)
               END IF
            ELSE
               LET g_xrcb_d[l_ac].xrcb010 = ''
            END IF
            LET g_xrcb_d[l_ac].xrcb010_desc = s_desc_show1(g_xrcb_d[l_ac].xrcb010,s_desc_get_department_desc(g_xrcb_d[l_ac].xrcb010))
            LET g_xrcb_d_t.xrcb010_desc = g_xrcb_d[l_ac].xrcb010_desc
            DISPLAY BY NAME g_xrcb_d[l_ac].xrcb010,g_xrcb_d[l_ac].xrcb010_desc
            
         ON ACTION controlp INFIELD xrcb010_desc
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_xrcb_d[l_ac].xrcb010
            LET g_qryparam.arg1 = l_xrcadocdt
            #161221-00054#2 add ------
            #agli060设置的部門限制条件
            CALL s_voucher_get_glak_sql(g_xrcb_d[1].xrcbld,'02',l_wc) RETURNING l_glak_sql
            LET g_qryparam.where = l_glak_sql
            #161221-00054#2 add end---            
            CALL q_ooeg001_4()                             
            LET g_xrcb_d[l_ac].xrcb010 = g_qryparam.return1    
            LET g_xrcb_d[l_ac].xrcb010_desc= g_xrcb_d[l_ac].xrcb010
            DISPLAY BY NAME g_xrcb_d[l_ac].xrcb010,g_xrcb_d[l_ac].xrcb010_desc
            NEXT FIELD xrcb010_desc               
            
         BEFORE FIELD xrcb011_desc                                    #150205-00012#1
            LET g_xrcb_d[l_ac].xrcb011_desc = g_xrcb_d[l_ac].xrcb011  #150205-00012#1   
            
         #責任中心
         AFTER FIELD xrcb011_desc
            IF NOT cl_null(g_xrcb_d[l_ac].xrcb011_desc) THEN
               IF ( g_xrcb_d[l_ac].xrcb011_desc != g_xrcb_d_t.xrcb011_desc OR g_xrcb_d_t.xrcb011_desc IS NULL ) THEN
                  LET g_xrcb_d[l_ac].xrcb011 = g_xrcb_d[l_ac].xrcb011_desc
                  IF l_glaa121 = 'N' THEN     #141218-00011#6
                     IF (g_xrcb_d[l_ac].xrcb011 != g_xrcb_d_t.xrcb011 OR g_xrcb_d_t.xrcb011 IS NULL) THEN
                        CALL s_voucher_glaq019_chk(g_xrcb_d[l_ac].xrcb011_desc,l_xrcadocdt)
                        IF NOT cl_null(g_errno) THEN
                            #160321-00016#52 --s add
                           LET g_errparam.replace[1] = 'aooi125'
                           LET g_errparam.replace[2] = cl_get_progname('aooi125',g_lang,"2")
                           LET g_errparam.exeprog = 'aooi125'
                           #160321-00016#52 --e add  
                           LET g_xrcb_d[l_ac].xrcb011        = g_xrcb_d_t.xrcb011
                           LET g_xrcb_d[l_ac].xrcb011_desc = g_xrcb_d_t.xrcb011_desc
                           DISPLAY BY NAME g_xrcb_d[l_ac].xrcb011,g_xrcb_d[l_ac].xrcb011_desc
                           NEXT FIELD CURRENT                           
                        END IF
                        #161221-00054#2 add ------
                        #判断agli060是否设置限制核算项资料，如果设置，判断是否满足agli060条件
                        CALL s_voucher_hsx_glak_chk(g_xrcb_d[1].xrcbld,'03',g_xrcb_d[l_ac].xrcb021,g_xrcb_d[l_ac].xrcb011) RETURNING g_sub_success
                        IF NOT g_sub_success THEN
                           LET g_xrcb_d[l_ac].xrcb011        = g_xrcb_d_t.xrcb011
                           LET g_xrcb_d[l_ac].xrcb011_desc = g_xrcb_d_t.xrcb011_desc
                           DISPLAY BY NAME g_xrcb_d[l_ac].xrcb011,g_xrcb_d[l_ac].xrcb011_desc
                           NEXT FIELD CURRENT
                        END IF
                        CALL s_voucher_hsx_glak_chk(g_xrcb_d[1].xrcbld,'03',g_xrcb_d[l_ac].xrcb029,g_xrcb_d[l_ac].xrcb011) RETURNING g_sub_success
                        IF NOT g_sub_success THEN
                           LET g_xrcb_d[l_ac].xrcb011        = g_xrcb_d_t.xrcb011
                           LET g_xrcb_d[l_ac].xrcb011_desc = g_xrcb_d_t.xrcb011_desc
                           DISPLAY BY NAME g_xrcb_d[l_ac].xrcb011,g_xrcb_d[l_ac].xrcb011_desc
                           NEXT FIELD CURRENT
                        END IF
                        #161221-00054#2 add end---                        
                     END IF
                  END IF
               END IF
            ELSE
               LET g_xrcb_d[l_ac].xrcb011 = ''
            END IF
            LET g_xrcb_d[l_ac].xrcb011_desc = s_desc_show1(g_xrcb_d[l_ac].xrcb011,s_desc_get_department_desc(g_xrcb_d[l_ac].xrcb011))
            LET g_xrcb_d_t.xrcb011_desc = g_xrcb_d[l_ac].xrcb011_desc
            DISPLAY BY NAME g_xrcb_d[l_ac].xrcb011,g_xrcb_d[l_ac].xrcb011_desc

         ON ACTION controlp INFIELD xrcb011_desc
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_xrcb_d[l_ac].xrcb011_desc
            LET g_qryparam.arg1 = l_xrcadocdt
            LET g_qryparam.where = " ooeg003 IN ('1','2','3')"
            #161221-00054#2 add ------
            #agli060设置的責任中心限制条件
            CALL s_voucher_get_glak_sql(g_xrcb_d[1].xrcbld,'03',l_wc) RETURNING l_glak_sql
            LET g_qryparam.where = g_qryparam.where," AND ",l_glak_sql
            #161221-00054#2 add end---           
            CALL q_ooeg001_5()    
            LET g_xrcb_d[l_ac].xrcb011        = g_qryparam.return1
            LET g_xrcb_d[l_ac].xrcb011_desc = g_xrcb_d[l_ac].xrcb011
            DISPLAY BY NAME g_xrcb_d[l_ac].xrcb011 ,g_xrcb_d[l_ac].xrcb011_desc
            NEXT FIELD xrcb011_desc
            
         BEFORE FIELD xrcb024_desc                                    #150205-00012#1
            LET g_xrcb_d[l_ac].xrcb024_desc = g_xrcb_d[l_ac].xrcb024  #150205-00012#1      
         
         #區域 
         AFTER FIELD xrcb024_desc
            IF NOT cl_null(g_xrcb_d[l_ac].xrcb024_desc) THEN
               IF ( g_xrcb_d[l_ac].xrcb024_desc != g_xrcb_d_t.xrcb024_desc OR g_xrcb_d_t.xrcb024_desc IS NULL ) THEN
                  LET g_xrcb_d[l_ac].xrcb024 = g_xrcb_d[l_ac].xrcb024_desc
                  IF l_glaa121 = 'N' THEN     #141218-00011#6
                     IF (g_xrcb_d[l_ac].xrcb024 != g_xrcb_d_t.xrcb024 OR g_xrcb_d_t.xrcb024 IS NULL) THEN
                        IF NOT s_azzi650_chk_exist('287',g_xrcb_d[l_ac].xrcb024_desc) THEN
                           LET g_xrcb_d[l_ac].xrcb024        = g_xrcb_d_t.xrcb024
                           LET g_xrcb_d[l_ac].xrcb024_desc = g_xrcb_d_t.xrcb024_desc
                           DISPLAY BY NAME g_xrcb_d[l_ac].xrcb024,g_xrcb_d[l_ac].xrcb024_desc
                           NEXT FIELD CURRENT
                        END IF
                        #161221-00054#2 add ------
                        #判断agli060是否设置限制核算项资料，如果设置，判断是否满足agli060条件
                        CALL s_voucher_hsx_glak_chk(g_xrcb_d[1].xrcbld,'04',g_xrcb_d[l_ac].xrcb021,g_xrcb_d[l_ac].xrcb024) RETURNING g_sub_success
                        IF NOT g_sub_success THEN
                           LET g_xrcb_d[l_ac].xrcb024        = g_xrcb_d_t.xrcb024
                           LET g_xrcb_d[l_ac].xrcb024_desc = g_xrcb_d_t.xrcb024_desc
                           DISPLAY BY NAME g_xrcb_d[l_ac].xrcb024,g_xrcb_d[l_ac].xrcb024_desc
                           NEXT FIELD CURRENT
                        END IF
                        CALL s_voucher_hsx_glak_chk(g_xrcb_d[1].xrcbld,'04',g_xrcb_d[l_ac].xrcb029,g_xrcb_d[l_ac].xrcb024) RETURNING g_sub_success
                        IF NOT g_sub_success THEN
                           LET g_xrcb_d[l_ac].xrcb024        = g_xrcb_d_t.xrcb024
                           LET g_xrcb_d[l_ac].xrcb024_desc = g_xrcb_d_t.xrcb024_desc
                           DISPLAY BY NAME g_xrcb_d[l_ac].xrcb024,g_xrcb_d[l_ac].xrcb024_desc
                           NEXT FIELD CURRENT
                        END IF
                        #161221-00054#2 add end---                        
                     END IF
                  END IF
               END IF
            ELSE
               LET g_xrcb_d[l_ac].xrcb024 = ''
            END IF
            LET g_xrcb_d[l_ac].xrcb024_desc = s_desc_show1(g_xrcb_d[l_ac].xrcb024,s_desc_get_acc_desc('287',g_xrcb_d[l_ac].xrcb024))
            LET g_xrcb_d_t.xrcb024_desc = g_xrcb_d[l_ac].xrcb024_desc
            DISPLAY BY NAME g_xrcb_d[l_ac].xrcb024,g_xrcb_d[l_ac].xrcb024_desc

         ON ACTION controlp INFIELD xrcb024_desc
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_xrcb_d[l_ac].xrcb024_desc
            #161221-00054#2 add ------
            #agli060设置的區域限制条件
            CALL s_voucher_get_glak_sql(g_xrcb_d[1].xrcbld,'04',l_wc) RETURNING l_glak_sql
            LET g_qryparam.where = l_glak_sql
            #161221-00054#2 add end---         
            CALL q_oocq002_287()
            LET g_xrcb_d[l_ac].xrcb024        = g_qryparam.return1
            LET g_xrcb_d[l_ac].xrcb024_desc = g_xrcb_d[l_ac].xrcb024
            DISPLAY BY NAME g_xrcb_d[l_ac].xrcb024 ,g_xrcb_d[l_ac].xrcb024_desc
            NEXT FIELD xrcb024_desc
            
         BEFORE FIELD xrcb012_desc                                    #150205-00012#1
            LET g_xrcb_d[l_ac].xrcb012_desc = g_xrcb_d[l_ac].xrcb012  #150205-00012#1   
            
         #產品類別 
         AFTER FIELD xrcb012_desc
            IF NOT cl_null(g_xrcb_d[l_ac].xrcb012_desc) THEN
               IF ( g_xrcb_d[l_ac].xrcb012_desc != g_xrcb_d_t.xrcb012_desc OR g_xrcb_d_t.xrcb012_desc IS NULL ) THEN
                  LET g_xrcb_d[l_ac].xrcb012 = g_xrcb_d[l_ac].xrcb012_desc
                  IF l_glaa121 = 'N' THEN     #141218-00011#6
                     IF (g_xrcb_d[l_ac].xrcb012 != g_xrcb_d_t.xrcb012 OR g_xrcb_d_t.xrcb012 IS NULL) THEN
                        CALL s_voucher_glaq024_chk(g_xrcb_d[l_ac].xrcb012_desc)
                        IF NOT cl_null(g_errno) THEN
                           #160321-00016#52 --s add
                           LET g_errparam.replace[1] = 'arti202'
                           LET g_errparam.replace[2] = cl_get_progname('arti202',g_lang,"2")
                           LET g_errparam.exeprog = 'arti202'
                           #160321-00016#52 --e add  
                           LET g_xrcb_d[l_ac].xrcb012        = g_xrcb_d_t.xrcb012
                           LET g_xrcb_d[l_ac].xrcb012_desc = g_xrcb_d_t.xrcb012_desc
                           DISPLAY BY NAME g_xrcb_d[l_ac].xrcb012,g_xrcb_d[l_ac].xrcb012_desc
                           NEXT FIELD CURRENT
                        END IF
                        #161221-00054#2 add ------
                        #判断agli060是否设置限制核算项资料，如果设置，判断是否满足agli060条件
                        CALL s_voucher_hsx_glak_chk(g_xrcb_d[1].xrcbld,'08',g_xrcb_d[l_ac].xrcb021,g_xrcb_d[l_ac].xrcb012) RETURNING g_sub_success
                        IF NOT g_sub_success THEN
                           LET g_xrcb_d[l_ac].xrcb012        = g_xrcb_d_t.xrcb012
                           LET g_xrcb_d[l_ac].xrcb012_desc = g_xrcb_d_t.xrcb012_desc
                           DISPLAY BY NAME g_xrcb_d[l_ac].xrcb012,g_xrcb_d[l_ac].xrcb012_desc
                           NEXT FIELD CURRENT
                        END IF
                        CALL s_voucher_hsx_glak_chk(g_xrcb_d[1].xrcbld,'08',g_xrcb_d[l_ac].xrcb029,g_xrcb_d[l_ac].xrcb012) RETURNING g_sub_success
                        IF NOT g_sub_success THEN
                           LET g_xrcb_d[l_ac].xrcb012        = g_xrcb_d_t.xrcb012
                           LET g_xrcb_d[l_ac].xrcb012_desc = g_xrcb_d_t.xrcb012_desc
                           DISPLAY BY NAME g_xrcb_d[l_ac].xrcb012,g_xrcb_d[l_ac].xrcb012_desc
                           NEXT FIELD CURRENT
                        END IF
                        #161221-00054#2 add end---                        
                     END IF
                  END IF
               END IF
            ELSE
               LET g_xrcb_d[l_ac].xrcb012 = ''
            END IF
            LET g_xrcb_d[l_ac].xrcb012_desc = s_desc_show1(g_xrcb_d[l_ac].xrcb012,s_desc_get_rtaxl003_desc(g_xrcb_d[l_ac].xrcb012))
            LET g_xrcb_d_t.xrcb012_desc = g_xrcb_d[l_ac].xrcb012_desc
            DISPLAY BY NAME g_xrcb_d[l_ac].xrcb012,g_xrcb_d[l_ac].xrcb012_desc

         ON ACTION controlp INFIELD xrcb012_desc
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_xrcb_d[l_ac].xrcb012_desc
            #161221-00054#2 add ------
            #agli060设置的產品類別限制条件
            CALL s_voucher_get_glak_sql(g_xrcb_d[1].xrcbld,'08',l_wc) RETURNING l_glak_sql
            LET g_qryparam.where =l_glak_sql
            #161221-00054#2 add end---            
            CALL q_rtax001()                          
            LET g_xrcb_d[l_ac].xrcb012        = g_qryparam.return1
            LET g_xrcb_d[l_ac].xrcb012_desc = g_xrcb_d[l_ac].xrcb012
            DISPLAY BY NAME g_xrcb_d[l_ac].xrcb012 ,g_xrcb_d[l_ac].xrcb012_desc
            NEXT FIELD xrcb012_desc   
      
         BEFORE FIELD xrcb016_desc                                    #150205-00012#1
            LET g_xrcb_d[l_ac].xrcb016_desc = g_xrcb_d[l_ac].xrcb016  #150205-00012#1
            
         #WBS
         AFTER FIELD xrcb016_desc
            IF NOT cl_null(g_xrcb_d[l_ac].xrcb016_desc)  THEN
               IF ( g_xrcb_d[l_ac].xrcb016_desc != g_xrcb_d_t.xrcb016_desc OR g_xrcb_d_t.xrcb016_desc IS NULL ) THEN
                  LET g_xrcb_d[l_ac].xrcb016 = g_xrcb_d[l_ac].xrcb016_desc
                  IF l_glaa121 = 'N' THEN     #141218-00011#6
                     IF (g_xrcb_d[l_ac].xrcb016 != g_xrcb_d_t.xrcb016 OR g_xrcb_d_t.xrcb016 IS NULL) THEN
                        CALL s_voucher_glaq028_chk(g_xrcb_d[l_ac].xrcb015,g_xrcb_d[l_ac].xrcb016) 
                       #CALL s_aap_project_chk( g_xrcb_d[l_ac].xrcb016) RETURNING g_sub_success,g_errno
                        IF NOT cl_null(g_errno) THEN
                           LET g_xrcb_d[l_ac].xrcb016        = g_xrcb_d_t.xrcb016
                           LET g_xrcb_d[l_ac].xrcb016_desc = g_xrcb_d_t.xrcb016_desc
                           DISPLAY BY NAME g_xrcb_d[l_ac].xrcb016,g_xrcb_d[l_ac].xrcb016_desc
                           NEXT FIELD CURRENT
                        END IF
                        #161221-00054#2 add ------
                        #判断agli060是否设置限制核算项资料，如果设置，判断是否满足agli060条件
                        CALL s_voucher_hsx_glak_chk(g_xrcb_d[1].xrcbld,'14',g_xrcb_d[l_ac].xrcb021,g_xrcb_d[l_ac].xrcb016) RETURNING g_sub_success
                        IF NOT g_sub_success THEN
                           LET g_xrcb_d[l_ac].xrcb016        = g_xrcb_d_t.xrcb016
                           LET g_xrcb_d[l_ac].xrcb016_desc = g_xrcb_d_t.xrcb016_desc
                           DISPLAY BY NAME g_xrcb_d[l_ac].xrcb016,g_xrcb_d[l_ac].xrcb016_desc
                           NEXT FIELD CURRENT
                        END IF
                        CALL s_voucher_hsx_glak_chk(g_xrcb_d[1].xrcbld,'14',g_xrcb_d[l_ac].xrcb029,g_xrcb_d[l_ac].xrcb016) RETURNING g_sub_success
                        IF NOT g_sub_success THEN
                           LET g_xrcb_d[l_ac].xrcb016        = g_xrcb_d_t.xrcb016
                           LET g_xrcb_d[l_ac].xrcb016_desc = g_xrcb_d_t.xrcb016_desc
                           DISPLAY BY NAME g_xrcb_d[l_ac].xrcb016,g_xrcb_d[l_ac].xrcb016_desc
                           NEXT FIELD CURRENT
                        END IF
                        #161221-00054#2 add end---                        
                     END IF
                  END IF
               END IF
            ELSE
               LET g_xrcb_d[l_ac].xrcb016 = ''
            END IF
            LET g_xrcb_d[l_ac].xrcb016_desc = s_desc_show1(g_xrcb_d[l_ac].xrcb016,s_desc_get_pjbbl004_desc(g_xrcb_d[l_ac].xrcb015,g_xrcb_d[l_ac].xrcb016))
            LET g_xrcb_d_t.xrcb016_desc = g_xrcb_d[l_ac].xrcb016_desc
            DISPLAY BY NAME g_xrcb_d[l_ac].xrcb011,g_xrcb_d[l_ac].xrcb016_desc
            
         ON ACTION controlp INFIELD xrcb016_desc
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_xrcb_d[l_ac].xrcb016
            IF NOT cl_null(g_xrcb_d[l_ac].xrcb015) THEN
               LET g_qryparam.where = "pjbb012='1' AND pjbb001='",g_xrcb_d[l_ac].xrcb015,"'"
            ELSE
               LET g_qryparam.where = "pjbb012='1'"
            END IF  
            #161221-00054#2 add ------
            #agli060设置的WBS限制条件
            CALL s_voucher_get_glak_sql(g_xrcb_d[1].xrcbld,'14',l_wc) RETURNING l_glak_sql
            LET g_qryparam.where = g_qryparam.where," AND ",l_glak_sql
            #161221-00054#2 add end---
            CALL q_pjbb002()
            LET g_xrcb_d[l_ac].xrcb016        = g_qryparam.return1
            LET g_xrcb_d[l_ac].xrcb016_desc = g_xrcb_d[l_ac].xrcb016
            DISPLAY BY NAME g_xrcb_d[l_ac].xrcb016,g_xrcb_d[l_ac].xrcb016_desc
            NEXT FIELD xrcb016_desc
            
         BEFORE FIELD xrcb015_desc                                    #150205-00012#1
            LET g_xrcb_d[l_ac].xrcb015_desc = g_xrcb_d[l_ac].xrcb015  #150205-00012#1   
            
         #專案代號
         AFTER FIELD xrcb015_desc
            IF NOT cl_null(g_xrcb_d[l_ac].xrcb015_desc) THEN
               IF ( g_xrcb_d[l_ac].xrcb015_desc != g_xrcb_d_t.xrcb015_desc OR g_xrcb_d_t.xrcb015_desc IS NULL ) THEN
                  LET g_xrcb_d[l_ac].xrcb015 = g_xrcb_d[l_ac].xrcb015_desc
                  IF l_glaa121 = 'N' THEN     #141218-00011#6
                     IF (g_xrcb_d[l_ac].xrcb015 != g_xrcb_d_t.xrcb015 OR g_xrcb_d_t.xrcb015 IS NULL) THEN
                        CALL s_aap_project_chk( g_xrcb_d[l_ac].xrcb015) RETURNING g_sub_success,g_errno
                        IF NOT g_sub_success THEN
                           INITIALIZE g_errparam TO NULL
                           LET g_errparam.code = g_errno
                           LET g_errparam.extend = ''
                           LET g_errparam.popup = TRUE
                           #160321-00016#52 --s add
                           LET g_errparam.replace[1] = 'apjm200'
                           LET g_errparam.replace[2] = cl_get_progname('apjm200',g_lang,"2")
                           LET g_errparam.exeprog = 'apjm200'
                           #160321-00016#52 --e add
                           CALL cl_err()
                           LET g_xrcb_d[l_ac].xrcb015        = g_xrcb_d_t.xrcb015
                           LET g_xrcb_d[l_ac].xrcb015_desc = g_xrcb_d_t.xrcb015_desc
                           DISPLAY BY NAME g_xrcb_d[l_ac].xrcb015,g_xrcb_d[l_ac].xrcb015_desc
                           NEXT FIELD CURRENT
                        END IF
                        #161221-00054#2 add ------
                        #判断agli060是否设置限制核算项资料，如果设置，判断是否满足agli060条件
                        CALL s_voucher_hsx_glak_chk(g_xrcb_d[1].xrcbld,'13',g_xrcb_d[l_ac].xrcb021,g_xrcb_d[l_ac].xrcb015) RETURNING g_sub_success
                        IF NOT g_sub_success THEN
                           LET g_xrcb_d[l_ac].xrcb015        = g_xrcb_d_t.xrcb015
                           LET g_xrcb_d[l_ac].xrcb015_desc = g_xrcb_d_t.xrcb015_desc
                           DISPLAY BY NAME g_xrcb_d[l_ac].xrcb015,g_xrcb_d[l_ac].xrcb015_desc
                           NEXT FIELD CURRENT
                        END IF
                        CALL s_voucher_hsx_glak_chk(g_xrcb_d[1].xrcbld,'13',g_xrcb_d[l_ac].xrcb029,g_xrcb_d[l_ac].xrcb015) RETURNING g_sub_success
                        IF NOT g_sub_success THEN
                           LET g_xrcb_d[l_ac].xrcb015        = g_xrcb_d_t.xrcb015
                           LET g_xrcb_d[l_ac].xrcb015_desc = g_xrcb_d_t.xrcb015_desc
                           DISPLAY BY NAME g_xrcb_d[l_ac].xrcb015,g_xrcb_d[l_ac].xrcb015_desc
                           NEXT FIELD CURRENT
                        END IF
                        #161221-00054#2 add end---                   
                     END IF
                  END IF
               END IF
            ELSE
               LET g_xrcb_d[l_ac].xrcb015 = ''
            END IF
            LET g_xrcb_d[l_ac].xrcb015_desc = s_desc_show1(g_xrcb_d[l_ac].xrcb015,s_desc_get_project_desc(g_xrcb_d[l_ac].xrcb015))
            LET g_xrcb_d_t.xrcb015_desc = g_xrcb_d[l_ac].xrcb015_desc
            DISPLAY BY NAME g_xrcb_d[l_ac].xrcb011,g_xrcb_d[l_ac].xrcb015_desc
            
         ON ACTION controlp INFIELD xrcb015_desc
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_xrcb_d[l_ac].xrcb015
            #161221-00054#2 add ------
            #agli060设置的專案代號限制条件
            CALL s_voucher_get_glak_sql(g_xrcb_d[1].xrcbld,'13',l_wc) RETURNING l_glak_sql
            LET g_qryparam.where = l_glak_sql
            #161221-00054#2 add end---          
            CALL q_pjba001()
            LET g_xrcb_d[l_ac].xrcb015        = g_qryparam.return1
            LET g_xrcb_d[l_ac].xrcb015_desc = g_xrcb_d[l_ac].xrcb015
            DISPLAY BY NAME g_xrcb_d[l_ac].xrcb015,g_xrcb_d[l_ac].xrcb015_desc
            NEXT FIELD xrcb015_desc
         
         BEFORE FIELD xrcb036_desc                                    #150205-00012#1
            LET g_xrcb_d[l_ac].xrcb036_desc = g_xrcb_d[l_ac].xrcb036  #150205-00012#1
            
         #客群
         AFTER FIELD xrcb036_desc
            IF NOT cl_null(g_xrcb_d[l_ac].xrcb036_desc) THEN
               IF ( g_xrcb_d[l_ac].xrcb036_desc != g_xrcb_d_t.xrcb036_desc OR g_xrcb_d_t.xrcb036_desc IS NULL ) THEN
                  LET g_xrcb_d[l_ac].xrcb036 = g_xrcb_d[l_ac].xrcb036_desc
                  IF l_glaa121 = 'N' THEN     #141218-00011#6
                     IF (g_xrcb_d[l_ac].xrcb036 != g_xrcb_d_t.xrcb036 OR g_xrcb_d_t.xrcb036 IS NULL) THEN
                        IF NOT s_azzi650_chk_exist('281',g_xrcb_d[l_ac].xrcb036_desc) THEN
                           LET g_xrcb_d[l_ac].xrcb036        = g_xrcb_d_t.xrcb036
                           LET g_xrcb_d[l_ac].xrcb036_desc = g_xrcb_d_t.xrcb036_desc
                           DISPLAY BY NAME g_xrcb_d[l_ac].xrcb036,g_xrcb_d[l_ac].xrcb036_desc
                           NEXT FIELD CURRENT
                        END IF
                        #161221-00054#2 add ------
                        #判断agli060是否设置限制核算项资料，如果设置，判断是否满足agli060条件
                        CALL s_voucher_hsx_glak_chk(g_xrcb_d[1].xrcbld,'07',g_xrcb_d[l_ac].xrcb021,g_xrcb_d[l_ac].xrcb036) RETURNING g_sub_success
                        IF NOT g_sub_success THEN
                           LET g_xrcb_d[l_ac].xrcb036        = g_xrcb_d_t.xrcb036
                           LET g_xrcb_d[l_ac].xrcb036_desc = g_xrcb_d_t.xrcb036_desc
                           DISPLAY BY NAME g_xrcb_d[l_ac].xrcb036,g_xrcb_d[l_ac].xrcb036_desc
                           NEXT FIELD CURRENT
                        END IF
                        CALL s_voucher_hsx_glak_chk(g_xrcb_d[1].xrcbld,'07',g_xrcb_d[l_ac].xrcb029,g_xrcb_d[l_ac].xrcb036) RETURNING g_sub_success
                        IF NOT g_sub_success THEN
                           LET g_xrcb_d[l_ac].xrcb036        = g_xrcb_d_t.xrcb036
                           LET g_xrcb_d[l_ac].xrcb036_desc = g_xrcb_d_t.xrcb036_desc
                           DISPLAY BY NAME g_xrcb_d[l_ac].xrcb036,g_xrcb_d[l_ac].xrcb036_desc
                           NEXT FIELD CURRENT
                        END IF
                        #161221-00054#2 add end---                        
                     END IF
                  END IF
               END IF
            ELSE
               LET g_xrcb_d[l_ac].xrcb036 = ''
            END IF
            LET g_xrcb_d[l_ac].xrcb036_desc = s_desc_show1(g_xrcb_d[l_ac].xrcb036,s_desc_get_acc_desc('281',g_xrcb_d[l_ac].xrcb036))
            LET g_xrcb_d_t.xrcb036_desc = g_xrcb_d[l_ac].xrcb036_desc
            DISPLAY BY NAME g_xrcb_d[l_ac].xrcb036,g_xrcb_d[l_ac].xrcb036_desc

         ON ACTION controlp INFIELD xrcb036_desc
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_xrcb_d[l_ac].xrcb036_desc
            #161221-00054#2 add ------
            #agli060设置的客群限制条件
            CALL s_voucher_get_glak_sql(g_xrcb_d[1].xrcbld,'07',l_wc) RETURNING l_glak_sql
            LET g_qryparam.where = l_glak_sql
            #161221-00054#2 add end---            
            CALL q_oocq002_281()
            LET g_xrcb_d[l_ac].xrcb036        = g_qryparam.return1
            LET g_xrcb_d[l_ac].xrcb036_desc = g_xrcb_d[l_ac].xrcb036
            DISPLAY BY NAME g_xrcb_d[l_ac].xrcb036 ,g_xrcb_d[l_ac].xrcb036_desc
            NEXT FIELD xrcb036_desc         
            
         #經營方式
         AFTER FIELD xrcb033
            IF NOT cl_null(g_xrcb_d[l_ac].xrcb033) THEN
               IF ( g_xrcb_d[l_ac].xrcb033 != g_xrcb_d_t.xrcb033 OR g_xrcb_d_t.xrcb033 IS NULL ) THEN
                  IF l_glaa121 = 'N' THEN     #141218-00011#6
                     IF (g_xrcb_d[l_ac].xrcb033 != g_xrcb_d_t.xrcb033 OR g_xrcb_d_t.xrcb033 IS NULL) THEN
                        CALL s_voucher_glaq051_chk(g_xrcb_d[l_ac].xrcb033)
                        IF NOT cl_null(g_errno) THEN
                           LET g_xrcb_d[l_ac].xrcb033        = g_xrcb_d_t.xrcb033
                           LET g_xrcb_d[l_ac].xrcb033 = g_xrcb_d_t.xrcb033
                           DISPLAY BY NAME g_xrcb_d[l_ac].xrcb033,g_xrcb_d[l_ac].xrcb033
                           NEXT FIELD CURRENT
                        END IF
                        #161221-00054#2 add ------
                        #判断agli060是否设置限制核算项资料，如果设置，判断是否满足agli060条件
                        CALL s_voucher_hsx_glak_chk(g_xrcb_d[1].xrcbld,'09',g_xrcb_d[l_ac].xrcb021,g_xrcb_d[l_ac].xrcb033) RETURNING g_sub_success
                        IF NOT g_sub_success THEN
                           LET g_xrcb_d[l_ac].xrcb033 = g_xrcb_d_t.xrcb033
                           DISPLAY BY NAME g_xrcb_d[l_ac].xrcb033,g_xrcb_d[l_ac].xrcb033
                           NEXT FIELD CURRENT
                        END IF
                        CALL s_voucher_hsx_glak_chk(g_xrcb_d[1].xrcbld,'09',g_xrcb_d[l_ac].xrcb029,g_xrcb_d[l_ac].xrcb033) RETURNING g_sub_success
                        IF NOT g_sub_success THEN
                           LET g_xrcb_d[l_ac].xrcb033 = g_xrcb_d_t.xrcb033
                           DISPLAY BY NAME g_xrcb_d[l_ac].xrcb033,g_xrcb_d[l_ac].xrcb033
                           NEXT FIELD CURRENT
                        END IF
                        #161221-00054#2 add end---                        
                     END IF
                  END IF
               END IF
            END IF
            DISPLAY BY NAME g_xrcb_d[l_ac].xrcb033
         
         BEFORE FIELD xrcb034_desc                                    #150205-00012#1
            LET g_xrcb_d[l_ac].xrcb034_desc = g_xrcb_d[l_ac].xrcb034  #150205-00012#1
         #渠道
         AFTER FIELD xrcb034_desc
            IF NOT cl_null(g_xrcb_d[l_ac].xrcb034_desc) THEN
               IF ( g_xrcb_d[l_ac].xrcb034_desc != g_xrcb_d_t.xrcb034_desc OR g_xrcb_d_t.xrcb034_desc IS NULL ) THEN
                  LET g_xrcb_d[l_ac].xrcb034 = g_xrcb_d[l_ac].xrcb034_desc
                  IF l_glaa121 = 'N' THEN     #141218-00011#6
                     IF (g_xrcb_d[l_ac].xrcb034 != g_xrcb_d_t.xrcb034 OR g_xrcb_d_t.xrcb034 IS NULL) THEN
                        CALL s_voucher_glaq052_chk(g_xrcb_d[l_ac].xrcb034_desc)
                        IF NOT cl_null(g_errno) THEN
                           LET g_xrcb_d[l_ac].xrcb034        = g_xrcb_d_t.xrcb034
                           LET g_xrcb_d[l_ac].xrcb034_desc = g_xrcb_d_t.xrcb034_desc
                           DISPLAY BY NAME g_xrcb_d[l_ac].xrcb034,g_xrcb_d[l_ac].xrcb034_desc
                           NEXT FIELD CURRENT
                        END IF
                        #161221-00054#2 add ------
                        #判断agli060是否设置限制核算项资料，如果设置，判断是否满足agli060条件
                        CALL s_voucher_hsx_glak_chk(g_xrcb_d[1].xrcbld,'10',g_xrcb_d[l_ac].xrcb021,g_xrcb_d[l_ac].xrcb034) RETURNING g_sub_success
                        IF NOT g_sub_success THEN
                           LET g_xrcb_d[l_ac].xrcb034        = g_xrcb_d_t.xrcb034
                           LET g_xrcb_d[l_ac].xrcb034_desc = g_xrcb_d_t.xrcb034_desc
                           DISPLAY BY NAME g_xrcb_d[l_ac].xrcb034,g_xrcb_d[l_ac].xrcb034_desc
                           NEXT FIELD CURRENT
                        END IF
                        CALL s_voucher_hsx_glak_chk(g_xrcb_d[1].xrcbld,'10',g_xrcb_d[l_ac].xrcb029,g_xrcb_d[l_ac].xrcb034) RETURNING g_sub_success
                        IF NOT g_sub_success THEN
                           LET g_xrcb_d[l_ac].xrcb034        = g_xrcb_d_t.xrcb034
                           LET g_xrcb_d[l_ac].xrcb034_desc = g_xrcb_d_t.xrcb034_desc
                           DISPLAY BY NAME g_xrcb_d[l_ac].xrcb034,g_xrcb_d[l_ac].xrcb034_desc
                           NEXT FIELD CURRENT
                        END IF
                        #161221-00054#2 add end---                        
                     END IF
                  END IF
               END IF
            ELSE
               LET g_xrcb_d[l_ac].xrcb034 = ''
            END IF
            LET g_xrcb_d[l_ac].xrcb034_desc = s_desc_show1(g_xrcb_d[l_ac].xrcb034,s_desc_get_oojdl003_desc(g_xrcb_d[l_ac].xrcb034))
            LET g_xrcb_d_t.xrcb034_desc = g_xrcb_d[l_ac].xrcb034_desc
            DISPLAY BY NAME g_xrcb_d[l_ac].xrcb034,g_xrcb_d[l_ac].xrcb034_desc

         ON ACTION controlp INFIELD xrcb034_desc
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_xrcb_d[l_ac].xrcb034_desc
            #161221-00054#2 add ------
            #agli060设置的渠道限制条件
            CALL s_voucher_get_glak_sql(g_xrcb_d[1].xrcbld,'10',l_wc) RETURNING l_glak_sql
            LET g_qryparam.where = " oojdstus='Y' AND ",l_glak_sql
            #161221-00054#2 add end---            
            CALL q_oojd001_2()
            LET g_xrcb_d[l_ac].xrcb034        = g_qryparam.return1
            LET g_xrcb_d[l_ac].xrcb034_desc = g_xrcb_d[l_ac].xrcb034
            DISPLAY BY NAME g_xrcb_d[l_ac].xrcb034 ,g_xrcb_d[l_ac].xrcb034_desc
            NEXT FIELD xrcb034_desc
            
         BEFORE FIELD xrcb035_desc                                    #150205-00012#1
            LET g_xrcb_d[l_ac].xrcb035_desc = g_xrcb_d[l_ac].xrcb035  #150205-00012#1   
         #品牌
         AFTER FIELD xrcb035_desc
            IF NOT cl_null(g_xrcb_d[l_ac].xrcb035_desc) THEN
               IF ( g_xrcb_d[l_ac].xrcb035_desc != g_xrcb_d_t.xrcb035_desc OR g_xrcb_d_t.xrcb035_desc IS NULL ) THEN
                  LET g_xrcb_d[l_ac].xrcb035 = g_xrcb_d[l_ac].xrcb035_desc
                  IF l_glaa121 = 'N' THEN     #141218-00011#6
                     IF (g_xrcb_d[l_ac].xrcb035 != g_xrcb_d_t.xrcb035 OR g_xrcb_d_t.xrcb035 IS NULL) THEN
                        IF NOT s_azzi650_chk_exist('2002',g_xrcb_d[l_ac].xrcb035_desc) THEN
                           LET g_xrcb_d[l_ac].xrcb035        = g_xrcb_d_t.xrcb035
                           LET g_xrcb_d[l_ac].xrcb035_desc = g_xrcb_d_t.xrcb035_desc
                           DISPLAY BY NAME g_xrcb_d[l_ac].xrcb035,g_xrcb_d[l_ac].xrcb035_desc
                           NEXT FIELD CURRENT
                        END IF
                        #161221-00054#2 add ------
                        #判断agli060是否设置限制核算项资料，如果设置，判断是否满足agli060条件
                        CALL s_voucher_hsx_glak_chk(g_xrcb_d[1].xrcbld,'11',g_xrcb_d[l_ac].xrcb021,g_xrcb_d[l_ac].xrcb035) RETURNING g_sub_success
                        IF NOT g_sub_success THEN
                           LET g_xrcb_d[l_ac].xrcb035        = g_xrcb_d_t.xrcb035
                           LET g_xrcb_d[l_ac].xrcb035_desc = g_xrcb_d_t.xrcb035_desc
                           DISPLAY BY NAME g_xrcb_d[l_ac].xrcb035,g_xrcb_d[l_ac].xrcb035_desc
                           NEXT FIELD CURRENT
                        END IF
                        CALL s_voucher_hsx_glak_chk(g_xrcb_d[1].xrcbld,'11',g_xrcb_d[l_ac].xrcb029,g_xrcb_d[l_ac].xrcb035) RETURNING g_sub_success
                        IF NOT g_sub_success THEN
                           LET g_xrcb_d[l_ac].xrcb035        = g_xrcb_d_t.xrcb035
                           LET g_xrcb_d[l_ac].xrcb035_desc = g_xrcb_d_t.xrcb035_desc
                           DISPLAY BY NAME g_xrcb_d[l_ac].xrcb035,g_xrcb_d[l_ac].xrcb035_desc
                           NEXT FIELD CURRENT
                        END IF
                        #161221-00054#2 add end---                       
                     END IF
                  END IF
               END IF
            ELSE
               LET g_xrcb_d[l_ac].xrcb035 = ''
            END IF
            LET g_xrcb_d[l_ac].xrcb035_desc = s_desc_show1(g_xrcb_d[l_ac].xrcb035,s_desc_get_acc_desc('2002',g_xrcb_d[l_ac].xrcb035))
            LET g_xrcb_d_t.xrcb035_desc = g_xrcb_d[l_ac].xrcb035_desc
            DISPLAY BY NAME g_xrcb_d[l_ac].xrcb035,g_xrcb_d[l_ac].xrcb035_desc

         ON ACTION controlp INFIELD xrcb035_desc
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_xrcb_d[l_ac].xrcb035_desc
            #161221-00054#2 add ------
            #agli060设置的渠道限制条件
            CALL s_voucher_get_glak_sql(g_xrcb_d[1].xrcbld,'11',l_wc) RETURNING l_glak_sql
            LET g_qryparam.where = l_glak_sql
            #161221-00054#2 add end---            
            CALL q_oocq002_2002()
            LET g_xrcb_d[l_ac].xrcb035        = g_qryparam.return1
            LET g_xrcb_d[l_ac].xrcb035_desc = g_xrcb_d[l_ac].xrcb035
            DISPLAY BY NAME g_xrcb_d[l_ac].xrcb035 ,g_xrcb_d[l_ac].xrcb035_desc
            NEXT FIELD xrcb035_desc
            
         #160509-00004#37--add--str--lujh   
         BEFORE FIELD xrcb053_desc                                    
            LET g_xrcb_d[l_ac].xrcb053_desc = g_xrcb_d[l_ac].xrcb053   
         #帳款客戶
         AFTER FIELD xrcb053_desc
            IF NOT cl_null(g_xrcb_d[l_ac].xrcb053_desc) THEN
               IF ( g_xrcb_d[l_ac].xrcb053_desc != g_xrcb_d_t.xrcb053_desc OR g_xrcb_d_t.xrcb053_desc IS NULL ) THEN
                  LET g_xrcb_d[l_ac].xrcb053 = g_xrcb_d[l_ac].xrcb053_desc
                  IF l_glaa121 = 'N' THEN     
                     IF (g_xrcb_d[l_ac].xrcb053 != g_xrcb_d_t.xrcb053 OR g_xrcb_d_t.xrcb053 IS NULL) THEN
                        CALL s_voucher_glaq021_chk(g_xrcb_d[l_ac].xrcb053_desc) 
                        IF NOT cl_null(g_errno) THEN
                           LET g_xrcb_d[l_ac].xrcb053        = g_xrcb_d_t.xrcb053
                           LET g_xrcb_d[l_ac].xrcb053_desc = g_xrcb_d_t.xrcb053_desc
                           DISPLAY BY NAME g_xrcb_d[l_ac].xrcb053,g_xrcb_d[l_ac].xrcb053_desc
                           NEXT FIELD CURRENT
                        END IF
                        #160913-00017#7--ADD(S)--
                        LET l_n =0 
                        SELECT COUNT(1) INTO l_n 
                          FROM pmaa_t
                         WHERE pmaa001 = g_xrcb_d[l_ac].xrcb053_desc 
                           AND pmaaent = g_enterprise AND (pmaa002 = '2' OR pmaa002 ='3')
                         IF cl_null(l_n) THEN LET l_n = 0 END IF  
                         IF l_n = 0 THEN
                            INITIALIZE g_errparam TO NULL
                            LET g_errparam.code = 'apm-00026'
                            LET g_errparam.extend = g_xrcb_d[l_ac].xrcb053_desc 
                            LET g_errparam.popup = TRUE
                            CALL cl_err()
                            LET g_xrcb_d[l_ac].xrcb053        = g_xrcb_d_t.xrcb053
                            LET g_xrcb_d[l_ac].xrcb053_desc = g_xrcb_d_t.xrcb053_desc
                            DISPLAY BY NAME g_xrcb_d[l_ac].xrcb053,g_xrcb_d[l_ac].xrcb053_desc
                            NEXT FIELD CURRENT
                         END IF
                        #160913-00017#7--ADD(E)--   
                     END IF
                  END IF
               END IF
            ELSE
               LET g_xrcb_d[l_ac].xrcb053 = ''
            END IF
            LET g_xrcb_d[l_ac].xrcb053_desc = s_desc_show1(g_xrcb_d[l_ac].xrcb053,s_desc_get_acc_desc('2002',g_xrcb_d[l_ac].xrcb053))
            LET g_xrcb_d_t.xrcb053_desc = g_xrcb_d[l_ac].xrcb053_desc
            DISPLAY BY NAME g_xrcb_d[l_ac].xrcb053,g_xrcb_d[l_ac].xrcb053_desc
         
         ON ACTION controlp INFIELD xrcb053_desc
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_xrcb_d[l_ac].xrcb053_desc
            #LET g_qryparam.where = "pmaa002 IN ('2','3')"  #160913-00017#7  mark
            # CALL q_pmaa001()   #160913-00017#7  mark                  #呼叫開窗
            #160913-00017#7--ADD(S)--
            LET g_qryparam.arg1="('2','3')"
            CALL q_pmaa001_1()
            #160913-00017#7--ADD(E)--
            LET g_xrcb_d[l_ac].xrcb053        = g_qryparam.return1
            LET g_xrcb_d[l_ac].xrcb053_desc = g_xrcb_d[l_ac].xrcb053
            DISPLAY BY NAME g_xrcb_d[l_ac].xrcb053 ,g_xrcb_d[l_ac].xrcb053_desc
            NEXT FIELD xrcb053_desc         
            
         BEFORE FIELD xrcb054_desc                                    
            LET g_xrcb_d[l_ac].xrcb054_desc = g_xrcb_d[l_ac].xrcb054   
         #帳款客戶
         AFTER FIELD xrcb054_desc
            IF NOT cl_null(g_xrcb_d[l_ac].xrcb054_desc) THEN
               IF ( g_xrcb_d[l_ac].xrcb054_desc != g_xrcb_d_t.xrcb054_desc OR g_xrcb_d_t.xrcb054_desc IS NULL ) THEN
                  LET g_xrcb_d[l_ac].xrcb054 = g_xrcb_d[l_ac].xrcb054_desc
                  IF l_glaa121 = 'N' THEN     
                     IF (g_xrcb_d[l_ac].xrcb054 != g_xrcb_d_t.xrcb054 OR g_xrcb_d_t.xrcb054 IS NULL) THEN
                        CALL s_voucher_glaq021_chk(g_xrcb_d[l_ac].xrcb054_desc)
                        IF NOT cl_null(g_errno) THEN
                           LET g_xrcb_d[l_ac].xrcb054        = g_xrcb_d_t.xrcb054
                           LET g_xrcb_d[l_ac].xrcb054_desc = g_xrcb_d_t.xrcb054_desc
                           DISPLAY BY NAME g_xrcb_d[l_ac].xrcb054,g_xrcb_d[l_ac].xrcb054_desc
                           NEXT FIELD CURRENT
                        END IF
                         #160913-00017#7--ADD(S)--
                        LET l_n =0 
                        SELECT COUNT(1) INTO l_n 
                          FROM pmaa_t
                         WHERE pmaa001 = g_xrcb_d[l_ac].xrcb054_desc
                           AND pmaaent = g_enterprise AND (pmaa002 = '2' OR pmaa002 ='3')
                         IF cl_null(l_n) THEN LET l_n = 0 END IF  
                         IF l_n = 0 THEN
                            INITIALIZE g_errparam TO NULL
                            LET g_errparam.code = 'apm-00026'
                            LET g_errparam.extend = g_xrcb_d[l_ac].xrcb053_desc 
                            LET g_errparam.popup = TRUE
                            CALL cl_err()
                            LET g_xrcb_d[l_ac].xrcb054        = g_xrcb_d_t.xrcb054
                            LET g_xrcb_d[l_ac].xrcb054_desc = g_xrcb_d_t.xrcb054_desc
                            DISPLAY BY NAME g_xrcb_d[l_ac].xrcb054,g_xrcb_d[l_ac].xrcb054_desc
                            NEXT FIELD CURRENT
                         END IF
                        #160913-00017#7--ADD(E)--   
                     END IF
                  END IF
               END IF
            ELSE
               LET g_xrcb_d[l_ac].xrcb054 = ''
            END IF
            LET g_xrcb_d[l_ac].xrcb054_desc = s_desc_show1(g_xrcb_d[l_ac].xrcb054,s_desc_get_acc_desc('2002',g_xrcb_d[l_ac].xrcb054))
            LET g_xrcb_d_t.xrcb054_desc = g_xrcb_d[l_ac].xrcb054_desc
            DISPLAY BY NAME g_xrcb_d[l_ac].xrcb054,g_xrcb_d[l_ac].xrcb054_desc
         
         ON ACTION controlp INFIELD xrcb054_desc
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_xrcb_d[l_ac].xrcb054_desc
            #LET g_qryparam.where = "pmaa002 IN ('2','3')"  #160913-00017#7  mark
            # CALL q_pmaa001()   #160913-00017#7  mark                  #呼叫開窗
            #160913-00017#7--ADD(S)--
            LET g_qryparam.arg1="('2','3')"
            CALL q_pmaa001_1()
            #160913-00017#7--ADD(E)--
            LET g_xrcb_d[l_ac].xrcb054        = g_qryparam.return1
            LET g_xrcb_d[l_ac].xrcb054_desc = g_xrcb_d[l_ac].xrcb054
            DISPLAY BY NAME g_xrcb_d[l_ac].xrcb054 ,g_xrcb_d[l_ac].xrcb054_desc
            NEXT FIELD xrcb054_desc     
         #160509-00004#37--add--str--lujh  
            
         #自由核算項一
         BEFORE FIELD xrcb037_desc
            CALL s_fin_get_glae009(l_glad.glad0171) RETURNING l_glae009
            LET g_xrcb_d[l_ac].xrcb037_desc = g_xrcb_d[l_ac].xrcb037  #150205-00012#1
            
         AFTER FIELD xrcb037_desc
            IF NOT cl_null(g_xrcb_d[l_ac].xrcb037_desc) THEN
               IF ( g_xrcb_d[l_ac].xrcb037_desc != g_xrcb_d_t.xrcb037_desc OR g_xrcb_d_t.xrcb037_desc IS NULL ) THEN
                  LET g_xrcb_d[l_ac].xrcb037 = g_xrcb_d[l_ac].xrcb037_desc
                  IF l_glaa121 = 'N' THEN     #141218-00011#6
                     IF (g_xrcb_d[l_ac].xrcb037 != g_xrcb_d_t.xrcb037 OR g_xrcb_d_t.xrcb037 IS NULL) THEN
                        CALL s_voucher_free_account_chk(l_glad.glad0171,g_xrcb_d[l_ac].xrcb037_desc,l_glad.glad0172) RETURNING g_errno
                        IF NOT cl_null(g_errno) THEN
                           #160321-00016#52 --s add
                           LET g_errparam.replace[1] = 'agli041'
                           LET g_errparam.replace[2] = cl_get_progname('agli041',g_lang,"2")
                           LET g_errparam.exeprog = 'agli041'
                           #160321-00016#52 --e add
                           LET g_xrcb_d[l_ac].xrcb037        = g_xrcb_d_t.xrcb037
                           LET g_xrcb_d[l_ac].xrcb037_desc = g_xrcb_d_t.xrcb037_desc
                           DISPLAY BY NAME g_xrcb_d[l_ac].xrcb037,g_xrcb_d[l_ac].xrcb037_desc
                           NEXT FIELD CURRENT
                        END IF
                     END IF
                  END IF
               END IF
            ELSE
               LET g_xrcb_d[l_ac].xrcb037 = ''
            END IF
            LET g_xrcb_d[l_ac].xrcb037_desc = s_desc_show1(g_xrcb_d[l_ac].xrcb037,s_fin_get_accting_desc(l_glad.glad0171,g_xrcb_d[l_ac].xrcb037))
            LET g_xrcb_d_t.xrcb037_desc = g_xrcb_d[l_ac].xrcb037_desc
            DISPLAY BY NAME g_xrcb_d[l_ac].xrcb037,g_xrcb_d[l_ac].xrcb037_desc

         ON ACTION controlp INFIELD xrcb037_desc
            IF NOT cl_null(l_glae009) THEN
               INITIALIZE g_qryparam.* TO NULL
               LET g_qryparam.state = 'i'
               LET g_qryparam.reqry = FALSE
               LET g_qryparam.default1 = g_xrcb_d[l_ac].xrcb037_desc
               IF l_glae009 = 'q_glaf002' THEN    
                  LET g_qryparam.where = "glaf001 = '",l_glad.glad0171,"'" #自由核算項類型
               END IF 
               CALL q_agli041(l_glae009) 
               LET g_xrcb_d[l_ac].xrcb037        = g_qryparam.return1
               LET g_xrcb_d[l_ac].xrcb037_desc = g_xrcb_d[l_ac].xrcb037
               DISPLAY BY NAME g_xrcb_d[l_ac].xrcb037 ,g_xrcb_d[l_ac].xrcb037_desc
               NEXT FIELD xrcb037_desc
            END IF
         
         #自由核算項二
         BEFORE FIELD xrcb038_desc
            CALL s_fin_get_glae009(l_glad.glad0181) RETURNING l_glae009
            LET g_xrcb_d[l_ac].xrcb038_desc = g_xrcb_d[l_ac].xrcb038  #150205-00012#1
         
         AFTER FIELD xrcb038_desc
            IF NOT cl_null(g_xrcb_d[l_ac].xrcb038_desc) THEN
               IF ( g_xrcb_d[l_ac].xrcb038_desc != g_xrcb_d_t.xrcb038_desc OR g_xrcb_d_t.xrcb038_desc IS NULL ) THEN
                  LET g_xrcb_d[l_ac].xrcb038 = g_xrcb_d[l_ac].xrcb038_desc
                  IF l_glaa121 = 'N' THEN     #141218-00011#6
                     IF (g_xrcb_d[l_ac].xrcb038 != g_xrcb_d_t.xrcb038 OR g_xrcb_d_t.xrcb038 IS NULL) THEN
                        CALL s_voucher_free_account_chk(l_glad.glad0181,g_xrcb_d[l_ac].xrcb038_desc,l_glad.glad0182) RETURNING g_errno
                        IF NOT cl_null(g_errno) THEN
                           #160321-00016#52 --s add
                           LET g_errparam.replace[1] = 'agli041'
                           LET g_errparam.replace[2] = cl_get_progname('agli041',g_lang,"2")
                           LET g_errparam.exeprog = 'agli041'
                           #160321-00016#52 --e add
                           LET g_xrcb_d[l_ac].xrcb038        = g_xrcb_d_t.xrcb038
                           LET g_xrcb_d[l_ac].xrcb038_desc = g_xrcb_d_t.xrcb038_desc
                           DISPLAY BY NAME g_xrcb_d[l_ac].xrcb038,g_xrcb_d[l_ac].xrcb038_desc
                           NEXT FIELD CURRENT
                        END IF
                     END IF
                  END IF
               END IF
            ELSE
               LET g_xrcb_d[l_ac].xrcb038 = ''
            END IF
            LET g_xrcb_d[l_ac].xrcb038_desc = s_desc_show1(g_xrcb_d[l_ac].xrcb038,s_fin_get_accting_desc(l_glad.glad0181,g_xrcb_d[l_ac].xrcb038))
            LET g_xrcb_d_t.xrcb038_desc = g_xrcb_d[l_ac].xrcb038_desc
            DISPLAY BY NAME g_xrcb_d[l_ac].xrcb038,g_xrcb_d[l_ac].xrcb038_desc

         ON ACTION controlp INFIELD xrcb038_desc
            IF NOT cl_null(l_glae009) THEN
               INITIALIZE g_qryparam.* TO NULL
               LET g_qryparam.state = 'i'
               LET g_qryparam.reqry = FALSE
               LET g_qryparam.default1 = g_xrcb_d[l_ac].xrcb038_desc
               IF l_glae009 = 'q_glaf002' THEN    
                  LET g_qryparam.where = "glaf001 = '",l_glad.glad0181,"'" #自由核算項類型
               END IF 
               CALL q_agli041(l_glae009) 
               LET g_xrcb_d[l_ac].xrcb038        = g_qryparam.return1
               LET g_xrcb_d[l_ac].xrcb038_desc = g_xrcb_d[l_ac].xrcb038
               DISPLAY BY NAME g_xrcb_d[l_ac].xrcb038 ,g_xrcb_d[l_ac].xrcb038_desc
               NEXT FIELD xrcb038_desc
            END IF    
         
         #自由核算項三
         BEFORE FIELD xrcb039_desc
            CALL s_fin_get_glae009(l_glad.glad0191) RETURNING l_glae009
            LET g_xrcb_d[l_ac].xrcb039_desc = g_xrcb_d[l_ac].xrcb039  #150205-00012#1
         
         AFTER FIELD xrcb039_desc
            IF NOT cl_null(g_xrcb_d[l_ac].xrcb039_desc)  THEN
               IF ( g_xrcb_d[l_ac].xrcb039_desc != g_xrcb_d_t.xrcb039_desc OR g_xrcb_d_t.xrcb039_desc IS NULL ) THEN
                  LET g_xrcb_d[l_ac].xrcb039 = g_xrcb_d[l_ac].xrcb039_desc
                  IF l_glaa121 = 'N' THEN     #141218-00011#6
                     IF (g_xrcb_d[l_ac].xrcb039 != g_xrcb_d_t.xrcb039 OR g_xrcb_d_t.xrcb039 IS NULL) THEN
                        CALL s_voucher_free_account_chk(l_glad.glad0191,g_xrcb_d[l_ac].xrcb039_desc,l_glad.glad0192) RETURNING g_errno
                        IF NOT cl_null(g_errno) THEN
                           #160321-00016#52 --s add
                           LET g_errparam.replace[1] = 'agli041'
                           LET g_errparam.replace[2] = cl_get_progname('agli041',g_lang,"2")
                           LET g_errparam.exeprog = 'agli041'
                           #160321-00016#52 --e add
                           LET g_xrcb_d[l_ac].xrcb039        = g_xrcb_d_t.xrcb039
                           LET g_xrcb_d[l_ac].xrcb039_desc = g_xrcb_d_t.xrcb039_desc
                           DISPLAY BY NAME g_xrcb_d[l_ac].xrcb039,g_xrcb_d[l_ac].xrcb039_desc
                           NEXT FIELD CURRENT
                        END IF
                     END IF
                  END IF
               END IF
            ELSE
               LET g_xrcb_d[l_ac].xrcb039 = ''
            END IF
            LET g_xrcb_d[l_ac].xrcb039_desc = s_desc_show1(g_xrcb_d[l_ac].xrcb039,s_fin_get_accting_desc(l_glad.glad0191,g_xrcb_d[l_ac].xrcb039))
            LET g_xrcb_d_t.xrcb039_desc = g_xrcb_d[l_ac].xrcb039_desc
            DISPLAY BY NAME g_xrcb_d[l_ac].xrcb039,g_xrcb_d[l_ac].xrcb039_desc

         ON ACTION controlp INFIELD xrcb039_desc
            IF NOT cl_null(l_glae009) THEN
               INITIALIZE g_qryparam.* TO NULL
               LET g_qryparam.state = 'i'
               LET g_qryparam.reqry = FALSE
               LET g_qryparam.default1 = g_xrcb_d[l_ac].xrcb039_desc
               IF l_glae009 = 'q_glaf002' THEN    
                  LET g_qryparam.where = "glaf001 = '",l_glad.glad0191,"'" #自由核算項類型
               END IF 
               CALL q_agli041(l_glae009) 
               LET g_xrcb_d[l_ac].xrcb039        = g_qryparam.return1
               LET g_xrcb_d[l_ac].xrcb039_desc = g_xrcb_d[l_ac].xrcb039
               DISPLAY BY NAME g_xrcb_d[l_ac].xrcb039 ,g_xrcb_d[l_ac].xrcb039_desc
               NEXT FIELD xrcb039_desc
            END IF
            
         #自由核算項四
         BEFORE FIELD xrcb040_desc
            CALL s_fin_get_glae009(l_glad.glad0201) RETURNING l_glae009
            LET g_xrcb_d[l_ac].xrcb040_desc = g_xrcb_d[l_ac].xrcb040  #150205-00012#1
         
         AFTER FIELD xrcb040_desc
            IF NOT cl_null(g_xrcb_d[l_ac].xrcb040_desc) THEN
               IF ( g_xrcb_d[l_ac].xrcb040_desc != g_xrcb_d_t.xrcb040_desc OR g_xrcb_d_t.xrcb040_desc IS NULL ) THEN
                  LET g_xrcb_d[l_ac].xrcb040 = g_xrcb_d[l_ac].xrcb040_desc
                  IF l_glaa121 = 'N' THEN     #141218-00011#6
                     IF (g_xrcb_d[l_ac].xrcb040 != g_xrcb_d_t.xrcb040 OR g_xrcb_d_t.xrcb040 IS NULL) THEN
                        CALL s_voucher_free_account_chk(l_glad.glad0201,g_xrcb_d[l_ac].xrcb040_desc,l_glad.glad0202) RETURNING g_errno
                        IF NOT cl_null(g_errno) THEN
                           #160321-00016#52 --s add
                           LET g_errparam.replace[1] = 'agli041'
                           LET g_errparam.replace[2] = cl_get_progname('agli041',g_lang,"2")
                           LET g_errparam.exeprog = 'agli041'
                           #160321-00016#52 --e add
                           LET g_xrcb_d[l_ac].xrcb040        = g_xrcb_d_t.xrcb040
                           LET g_xrcb_d[l_ac].xrcb040_desc = g_xrcb_d_t.xrcb040_desc
                           DISPLAY BY NAME g_xrcb_d[l_ac].xrcb040,g_xrcb_d[l_ac].xrcb040_desc
                           NEXT FIELD CURRENT
                        END IF
                     END IF
                  END IF
               END IF
            ELSE
               LET g_xrcb_d[l_ac].xrcb040 = ''
            END IF
            LET g_xrcb_d[l_ac].xrcb040_desc = s_desc_show1(g_xrcb_d[l_ac].xrcb040,s_fin_get_accting_desc(l_glad.glad0201,g_xrcb_d[l_ac].xrcb040))
            LET g_xrcb_d_t.xrcb040_desc = g_xrcb_d[l_ac].xrcb040_desc
            DISPLAY BY NAME g_xrcb_d[l_ac].xrcb040,g_xrcb_d[l_ac].xrcb040_desc

         ON ACTION controlp INFIELD xrcb040_desc
            IF NOT cl_null(l_glae009) THEN
               INITIALIZE g_qryparam.* TO NULL
               LET g_qryparam.state = 'i'
               LET g_qryparam.reqry = FALSE
               LET g_qryparam.default1 = g_xrcb_d[l_ac].xrcb040_desc
               IF l_glae009 = 'q_glaf002' THEN    
                  LET g_qryparam.where = "glaf001 = '",l_glad.glad0201,"'" #自由核算項類型
               END IF 
               CALL q_agli041(l_glae009) 
               LET g_xrcb_d[l_ac].xrcb040        = g_qryparam.return1
               LET g_xrcb_d[l_ac].xrcb040_desc = g_xrcb_d[l_ac].xrcb040
               DISPLAY BY NAME g_xrcb_d[l_ac].xrcb040 ,g_xrcb_d[l_ac].xrcb040_desc
               NEXT FIELD xrcb040_desc
            END IF    
         
         #自由核算項五
         BEFORE FIELD xrcb041_desc
            CALL s_fin_get_glae009(l_glad.glad0211) RETURNING l_glae009
            LET g_xrcb_d[l_ac].xrcb041_desc = g_xrcb_d[l_ac].xrcb041  #150205-00012#1
         
         AFTER FIELD xrcb041_desc 
            IF NOT cl_null(g_xrcb_d[l_ac].xrcb041_desc) THEN
               IF ( g_xrcb_d[l_ac].xrcb041_desc != g_xrcb_d_t.xrcb041_desc OR g_xrcb_d_t.xrcb041_desc IS NULL ) THEN
                  LET g_xrcb_d[l_ac].xrcb041 = g_xrcb_d[l_ac].xrcb041_desc
                  IF l_glaa121 = 'N' THEN     #141218-00011#6
                     IF (g_xrcb_d[l_ac].xrcb041 != g_xrcb_d_t.xrcb041 OR g_xrcb_d_t.xrcb041 IS NULL) THEN
                        CALL s_voucher_free_account_chk(l_glad.glad0211,g_xrcb_d[l_ac].xrcb041_desc,l_glad.glad0212) RETURNING g_errno
                        IF NOT cl_null(g_errno) THEN
                           #160321-00016#52 --s add
                           LET g_errparam.replace[1] = 'agli041'
                           LET g_errparam.replace[2] = cl_get_progname('agli041',g_lang,"2")
                           LET g_errparam.exeprog = 'agli041'
                           #160321-00016#52 --e add
                           LET g_xrcb_d[l_ac].xrcb041        = g_xrcb_d_t.xrcb041
                           LET g_xrcb_d[l_ac].xrcb041_desc = g_xrcb_d_t.xrcb041_desc
                           DISPLAY BY NAME g_xrcb_d[l_ac].xrcb041,g_xrcb_d[l_ac].xrcb041_desc
                           NEXT FIELD CURRENT
                        END IF
                     END IF
                  END IF
               END IF
            ELSE
               LET g_xrcb_d[l_ac].xrcb041 = ''
            END IF
            LET g_xrcb_d[l_ac].xrcb041_desc = s_desc_show1(g_xrcb_d[l_ac].xrcb041,s_fin_get_accting_desc(l_glad.glad0211,g_xrcb_d[l_ac].xrcb041))
            LET g_xrcb_d_t.xrcb041_desc = g_xrcb_d[l_ac].xrcb041_desc
            DISPLAY BY NAME g_xrcb_d[l_ac].xrcb041,g_xrcb_d[l_ac].xrcb041_desc

         ON ACTION controlp INFIELD xrcb041_desc
            IF NOT cl_null(l_glae009) THEN
               INITIALIZE g_qryparam.* TO NULL
               LET g_qryparam.state = 'i'
               LET g_qryparam.reqry = FALSE
               LET g_qryparam.default1 = g_xrcb_d[l_ac].xrcb041_desc
               IF l_glae009 = 'q_glaf002' THEN    
                  LET g_qryparam.where = "glaf001 = '",l_glad.glad0211,"'" #自由核算項類型
               END IF 
               CALL q_agli041(l_glae009) 
               LET g_xrcb_d[l_ac].xrcb041        = g_qryparam.return1
               LET g_xrcb_d[l_ac].xrcb041_desc = g_xrcb_d[l_ac].xrcb041
               DISPLAY BY NAME g_xrcb_d[l_ac].xrcb041 ,g_xrcb_d[l_ac].xrcb041_desc
               NEXT FIELD xrcb041_desc
            END IF             

         #自由核算項六
         BEFORE FIELD xrcb042_desc
            CALL s_fin_get_glae009(l_glad.glad0221) RETURNING l_glae009
            LET g_xrcb_d[l_ac].xrcb042_desc = g_xrcb_d[l_ac].xrcb042  #150205-00012#1
         
         AFTER FIELD xrcb042_desc
            IF NOT cl_null(g_xrcb_d[l_ac].xrcb042_desc) THEN
               IF ( g_xrcb_d[l_ac].xrcb042_desc != g_xrcb_d_t.xrcb042_desc OR g_xrcb_d_t.xrcb042_desc IS NULL ) THEN
                  LET g_xrcb_d[l_ac].xrcb042 = g_xrcb_d[l_ac].xrcb042_desc
                  IF l_glaa121 = 'N' THEN     #141218-00011#6
                     IF (g_xrcb_d[l_ac].xrcb042 != g_xrcb_d_t.xrcb042 OR g_xrcb_d_t.xrcb042 IS NULL) THEN
                        CALL s_voucher_free_account_chk(l_glad.glad0221,g_xrcb_d[l_ac].xrcb042_desc,l_glad.glad0222) RETURNING g_errno
                        IF NOT cl_null(g_errno) THEN
                           #160321-00016#52 --s add
                           LET g_errparam.replace[1] = 'agli041'
                           LET g_errparam.replace[2] = cl_get_progname('agli041',g_lang,"2")
                           LET g_errparam.exeprog = 'agli041'
                           #160321-00016#52 --e add
                           LET g_xrcb_d[l_ac].xrcb042        = g_xrcb_d_t.xrcb042
                           LET g_xrcb_d[l_ac].xrcb042_desc = g_xrcb_d_t.xrcb042_desc
                           DISPLAY BY NAME g_xrcb_d[l_ac].xrcb042,g_xrcb_d[l_ac].xrcb042_desc
                           NEXT FIELD CURRENT
                        END IF
                     END IF
                  END IF
               END IF
            ELSE
               LET g_xrcb_d[l_ac].xrcb042 = ''
            END IF
            LET g_xrcb_d[l_ac].xrcb042_desc = s_desc_show1(g_xrcb_d[l_ac].xrcb042,s_fin_get_accting_desc(l_glad.glad0221,g_xrcb_d[l_ac].xrcb042))
            LET g_xrcb_d_t.xrcb042_desc = g_xrcb_d[l_ac].xrcb042_desc
            DISPLAY BY NAME g_xrcb_d[l_ac].xrcb042,g_xrcb_d[l_ac].xrcb042_desc

         ON ACTION controlp INFIELD xrcb042_desc
            IF NOT cl_null(l_glae009) THEN
               INITIALIZE g_qryparam.* TO NULL
               LET g_qryparam.state = 'i'
               LET g_qryparam.reqry = FALSE
               LET g_qryparam.default1 = g_xrcb_d[l_ac].xrcb042_desc
               IF l_glae009 = 'q_glaf002' THEN    
                  LET g_qryparam.where = "glaf001 = '",l_glad.glad0221,"'" #自由核算項類型
               END IF 
               CALL q_agli041(l_glae009) 
               LET g_xrcb_d[l_ac].xrcb042        = g_qryparam.return1
               LET g_xrcb_d[l_ac].xrcb042_desc = g_xrcb_d[l_ac].xrcb042
               DISPLAY BY NAME g_xrcb_d[l_ac].xrcb042 ,g_xrcb_d[l_ac].xrcb042_desc
               NEXT FIELD xrcb042_desc
            END IF
         
         #自由核算項七
         BEFORE FIELD xrcb043_desc
            CALL s_fin_get_glae009(l_glad.glad0231) RETURNING l_glae009
            LET g_xrcb_d[l_ac].xrcb043_desc = g_xrcb_d[l_ac].xrcb043  #150205-00012#1
         
         AFTER FIELD xrcb043_desc
            IF NOT cl_null(g_xrcb_d[l_ac].xrcb043_desc) THEN
               IF ( g_xrcb_d[l_ac].xrcb043_desc != g_xrcb_d_t.xrcb043_desc OR g_xrcb_d_t.xrcb043_desc IS NULL ) THEN
                  LET g_xrcb_d[l_ac].xrcb043 = g_xrcb_d[l_ac].xrcb043_desc
                  IF l_glaa121 = 'N' THEN     #141218-00011#6
                     IF (g_xrcb_d[l_ac].xrcb043 != g_xrcb_d_t.xrcb043 OR g_xrcb_d_t.xrcb043 IS NULL) THEN
                        CALL s_voucher_free_account_chk(l_glad.glad0231,g_xrcb_d[l_ac].xrcb043_desc,l_glad.glad0232) RETURNING g_errno
                        IF NOT cl_null(g_errno) THEN
                           #160321-00016#52 --s add
                           LET g_errparam.replace[1] = 'agli041'
                           LET g_errparam.replace[2] = cl_get_progname('agli041',g_lang,"2")
                           LET g_errparam.exeprog = 'agli041'
                           #160321-00016#52 --e add
                           LET g_xrcb_d[l_ac].xrcb043        = g_xrcb_d_t.xrcb043
                           LET g_xrcb_d[l_ac].xrcb043_desc = g_xrcb_d_t.xrcb043_desc
                           DISPLAY BY NAME g_xrcb_d[l_ac].xrcb043,g_xrcb_d[l_ac].xrcb043_desc
                           NEXT FIELD CURRENT
                        END IF
                     END IF
                  END IF
               END IF
            ELSE
               LET g_xrcb_d[l_ac].xrcb043 = ''
            END IF
            LET g_xrcb_d[l_ac].xrcb043_desc = s_desc_show1(g_xrcb_d[l_ac].xrcb043,s_fin_get_accting_desc(l_glad.glad0231,g_xrcb_d[l_ac].xrcb043))
            LET g_xrcb_d_t.xrcb043_desc = g_xrcb_d[l_ac].xrcb043_desc
            DISPLAY BY NAME g_xrcb_d[l_ac].xrcb043,g_xrcb_d[l_ac].xrcb043_desc

         ON ACTION controlp INFIELD xrcb043_desc
            IF NOT cl_null(l_glae009) THEN
               INITIALIZE g_qryparam.* TO NULL
               LET g_qryparam.state = 'i'
               LET g_qryparam.reqry = FALSE
               LET g_qryparam.default1 = g_xrcb_d[l_ac].xrcb043_desc
               IF l_glae009 = 'q_glaf002' THEN    
                  LET g_qryparam.where = "glaf001 = '",l_glad.glad0231,"'" #自由核算項類型
               END IF 
               CALL q_agli041(l_glae009) 
               LET g_xrcb_d[l_ac].xrcb043        = g_qryparam.return1
               LET g_xrcb_d[l_ac].xrcb043_desc = g_xrcb_d[l_ac].xrcb043
               DISPLAY BY NAME g_xrcb_d[l_ac].xrcb043 ,g_xrcb_d[l_ac].xrcb043_desc
               NEXT FIELD xrcb043_desc
            END IF    
         
         #自由核算項八
         BEFORE FIELD xrcb044_desc
            CALL s_fin_get_glae009(l_glad.glad0241) RETURNING l_glae009
            LET g_xrcb_d[l_ac].xrcb044_desc = g_xrcb_d[l_ac].xrcb044  #150205-00012#1
         
         AFTER FIELD xrcb044_desc
            IF NOT cl_null(g_xrcb_d[l_ac].xrcb044_desc) THEN
               IF ( g_xrcb_d[l_ac].xrcb044_desc != g_xrcb_d_t.xrcb044_desc OR g_xrcb_d_t.xrcb044_desc IS NULL ) THEN
                  LET g_xrcb_d[l_ac].xrcb044 = g_xrcb_d[l_ac].xrcb044_desc
                  IF l_glaa121 = 'N' THEN     #141218-00011#6
                     IF (g_xrcb_d[l_ac].xrcb044 != g_xrcb_d_t.xrcb044 OR g_xrcb_d_t.xrcb044 IS NULL) THEN
                        CALL s_voucher_free_account_chk(l_glad.glad0241,g_xrcb_d[l_ac].xrcb044_desc,l_glad.glad0242) RETURNING g_errno
                        IF NOT cl_null(g_errno) THEN
                           #160321-00016#52 --s add
                           LET g_errparam.replace[1] = 'agli041'
                           LET g_errparam.replace[2] = cl_get_progname('agli041',g_lang,"2")
                           LET g_errparam.exeprog = 'agli041'
                           #160321-00016#52 --e add
                           LET g_xrcb_d[l_ac].xrcb044        = g_xrcb_d_t.xrcb044
                           LET g_xrcb_d[l_ac].xrcb044_desc = g_xrcb_d_t.xrcb044_desc
                           DISPLAY BY NAME g_xrcb_d[l_ac].xrcb044,g_xrcb_d[l_ac].xrcb044_desc
                           NEXT FIELD CURRENT
                        END IF
                     END IF
                  END IF
               END IF
            ELSE
               LET g_xrcb_d[l_ac].xrcb044 = ''
            END IF
            LET g_xrcb_d[l_ac].xrcb044_desc = s_desc_show1(g_xrcb_d[l_ac].xrcb044,s_fin_get_accting_desc(l_glad.glad0241,g_xrcb_d[l_ac].xrcb044))
            LET g_xrcb_d_t.xrcb044_desc = g_xrcb_d[l_ac].xrcb044_desc
            DISPLAY BY NAME g_xrcb_d[l_ac].xrcb044,g_xrcb_d[l_ac].xrcb044_desc

         ON ACTION controlp INFIELD xrcb044_desc
            IF NOT cl_null(l_glae009) THEN
               INITIALIZE g_qryparam.* TO NULL
               LET g_qryparam.state = 'i'
               LET g_qryparam.reqry = FALSE
               LET g_qryparam.default1 = g_xrcb_d[l_ac].xrcb044_desc
               IF l_glae009 = 'q_glaf002' THEN    
                  LET g_qryparam.where = "glaf001 = '",l_glad.glad0241,"'" #自由核算項類型
               END IF 
               CALL q_agli041(l_glae009) 
               LET g_xrcb_d[l_ac].xrcb044        = g_qryparam.return1
               LET g_xrcb_d[l_ac].xrcb044_desc = g_xrcb_d[l_ac].xrcb044
               DISPLAY BY NAME g_xrcb_d[l_ac].xrcb044 ,g_xrcb_d[l_ac].xrcb044_desc
               NEXT FIELD xrcb044_desc
            END IF
            
         #自由核算項九
         BEFORE FIELD xrcb045_desc
            CALL s_fin_get_glae009(l_glad.glad0251) RETURNING l_glae009
            LET g_xrcb_d[l_ac].xrcb045_desc = g_xrcb_d[l_ac].xrcb045  #150205-00012#1
         
         AFTER FIELD xrcb045_desc
            IF NOT cl_null(g_xrcb_d[l_ac].xrcb045_desc) THEN
               IF ( g_xrcb_d[l_ac].xrcb045_desc != g_xrcb_d_t.xrcb045_desc OR g_xrcb_d_t.xrcb045_desc IS NULL ) THEN
                  LET g_xrcb_d[l_ac].xrcb045 = g_xrcb_d[l_ac].xrcb045_desc
                  IF l_glaa121 = 'N' THEN     #141218-00011#6
                     IF (g_xrcb_d[l_ac].xrcb045 != g_xrcb_d_t.xrcb045 OR g_xrcb_d_t.xrcb045 IS NULL) THEN
                        CALL s_voucher_free_account_chk(l_glad.glad0251,g_xrcb_d[l_ac].xrcb045_desc,l_glad.glad0252) RETURNING g_errno
                        IF NOT cl_null(g_errno) THEN
                           #160321-00016#52 --s add
                           LET g_errparam.replace[1] = 'agli041'
                           LET g_errparam.replace[2] = cl_get_progname('agli041',g_lang,"2")
                           LET g_errparam.exeprog = 'agli041'
                           #160321-00016#52 --e add  
                           LET g_xrcb_d[l_ac].xrcb045        = g_xrcb_d_t.xrcb045
                           LET g_xrcb_d[l_ac].xrcb045_desc = g_xrcb_d_t.xrcb045_desc
                           DISPLAY BY NAME g_xrcb_d[l_ac].xrcb045,g_xrcb_d[l_ac].xrcb045_desc
                           NEXT FIELD CURRENT
                        END IF
                     END IF
                  END IF
               END IF
            ELSE
               LET g_xrcb_d[l_ac].xrcb045 = ''
            END IF
            LET g_xrcb_d[l_ac].xrcb045_desc = s_desc_show1(g_xrcb_d[l_ac].xrcb045,s_fin_get_accting_desc(l_glad.glad0251,g_xrcb_d[l_ac].xrcb045))
            LET g_xrcb_d_t.xrcb045_desc = g_xrcb_d[l_ac].xrcb045_desc
            DISPLAY BY NAME g_xrcb_d[l_ac].xrcb045,g_xrcb_d[l_ac].xrcb045_desc

         ON ACTION controlp INFIELD xrcb045_desc
            IF NOT cl_null(l_glae009) THEN
               INITIALIZE g_qryparam.* TO NULL
               LET g_qryparam.state = 'i'
               LET g_qryparam.reqry = FALSE
               LET g_qryparam.default1 = g_xrcb_d[l_ac].xrcb045_desc
               IF l_glae009 = 'q_glaf002' THEN    
                  LET g_qryparam.where = "glaf001 = '",l_glad.glad0251,"'" #自由核算項類型
               END IF 
               CALL q_agli041(l_glae009) 
               LET g_xrcb_d[l_ac].xrcb045        = g_qryparam.return1
               LET g_xrcb_d[l_ac].xrcb045_desc = g_xrcb_d[l_ac].xrcb045
               DISPLAY BY NAME g_xrcb_d[l_ac].xrcb045 ,g_xrcb_d[l_ac].xrcb045_desc
               NEXT FIELD xrcb045_desc
            END IF    
         
         #自由核算項十
         BEFORE FIELD xrcb046_desc
            CALL s_fin_get_glae009(l_glad.glad0261) RETURNING l_glae009
            LET g_xrcb_d[l_ac].xrcb046_desc = g_xrcb_d[l_ac].xrcb046  #150205-00012#1
         
         AFTER FIELD xrcb046_desc
            IF NOT cl_null(g_xrcb_d[l_ac].xrcb046_desc)  THEN
               IF ( g_xrcb_d[l_ac].xrcb046_desc != g_xrcb_d_t.xrcb046_desc OR g_xrcb_d_t.xrcb046_desc IS NULL ) THEN
                  LET g_xrcb_d[l_ac].xrcb046 = g_xrcb_d[l_ac].xrcb046_desc
                  IF l_glaa121 = 'N' THEN     #141218-00011#6
                     IF (g_xrcb_d[l_ac].xrcb046 != g_xrcb_d_t.xrcb046 OR g_xrcb_d_t.xrcb046 IS NULL) THEN
                        CALL s_voucher_free_account_chk(l_glad.glad0261,g_xrcb_d[l_ac].xrcb046_desc,l_glad.glad0262) RETURNING g_errno
                        IF NOT cl_null(g_errno) THEN
                           #160321-00016#52 --s add
                           LET g_errparam.replace[1] = 'agli041'
                           LET g_errparam.replace[2] = cl_get_progname('agli041',g_lang,"2")
                           LET g_errparam.exeprog = 'agli041'
                           #160321-00016#52 --e add  
                           LET g_xrcb_d[l_ac].xrcb046        = g_xrcb_d_t.xrcb046
                           LET g_xrcb_d[l_ac].xrcb046_desc = g_xrcb_d_t.xrcb046_desc
                           DISPLAY BY NAME g_xrcb_d[l_ac].xrcb046,g_xrcb_d[l_ac].xrcb046_desc
                           NEXT FIELD CURRENT
                        END IF
                     END IF
                  END IF
               END IF
            ELSE
               LET g_xrcb_d[l_ac].xrcb046 = ''
            END IF
            LET g_xrcb_d[l_ac].xrcb046_desc = s_desc_show1(g_xrcb_d[l_ac].xrcb046,s_fin_get_accting_desc(l_glad.glad0261,g_xrcb_d[l_ac].xrcb046))
            LET g_xrcb_d_t.xrcb046_desc = g_xrcb_d[l_ac].xrcb046_desc
            DISPLAY BY NAME g_xrcb_d[l_ac].xrcb046,g_xrcb_d[l_ac].xrcb046_desc

         ON ACTION controlp INFIELD xrcb046_desc
            IF NOT cl_null(l_glae009) THEN
               INITIALIZE g_qryparam.* TO NULL
               LET g_qryparam.state = 'i'
               LET g_qryparam.reqry = FALSE
               LET g_qryparam.default1 = g_xrcb_d[l_ac].xrcb046_desc
               IF l_glae009 = 'q_glaf002' THEN    
                  LET g_qryparam.where = "glaf001 = '",l_glad.glad0261,"'" #自由核算項類型
               END IF 
               CALL q_agli041(l_glae009) 
               LET g_xrcb_d[l_ac].xrcb046        = g_qryparam.return1
               LET g_xrcb_d[l_ac].xrcb046_desc = g_xrcb_d[l_ac].xrcb046
               DISPLAY BY NAME g_xrcb_d[l_ac].xrcb046 ,g_xrcb_d[l_ac].xrcb046_desc
               NEXT FIELD xrcb046_desc
            END IF
       
       ON ACTION accept   #150206-00013#3  
          ACCEPT DIALOG   #150206-00013#3  
                  
       AFTER INPUT
           ##150210-00009#1--Mark
           ##141202-00061-15--(S)
           #CALL s_aooi200_get_slip(l_xrcadocno) RETURNING g_sub_success,l_ap_slip               
           #CALL s_fin_get_doc_para(l_xrcald,l_glaacomp,l_ap_slip,'D-FIN-0030') RETURNING l_dfin0030
           #IF l_glaa121 = 'Y' AND l_dfin0030 = 'Y'THEN
           #   CALL s_transaction_begin()
           #   CALL s_pre_voucher_ins('AP','P10',g_xrcb_d[l_ac].xrcbld , g_xrcb_d[l_ac].xrcbdocno,l_xrcadocdt,'1')
           #        RETURNING g_sub_success
           #   IF g_sub_success THEN 
           #      CALL s_transaction_end('Y','0')
           #   ELSE
           #      CALL s_transaction_end('N','0')
           #   END IF
           #END IF
           ##141202-00061-15--(E)  
           #150210-00009#1--Mark
            LET g_xrcb_d4.* = g_xrcb_d.*      
            
   END INPUT
   
END DIALOG
################################################################################
# Descriptions...: 
# Usage..........: CALL axrt300_07_construct()
# Date & Author..: 2015/03/16 By 01727
# Modify.........:
################################################################################
DIALOG axrt300_07_construct()
DEFINE g_wc_axrt300_07  STRING

   CONSTRUCT g_wc_axrt300_07 ON xrcb010,xrcb011,xrcb024,xrcb036,xrcb012,xrcb015,
                                xrcb016,xrcb034,xrcb035
       
        FROM s_detail1_axrt300_07[1].xrcb010_desc,s_detail1_axrt300_07[1].xrcb011_desc,
             s_detail1_axrt300_07[1].xrcb024_desc,s_detail1_axrt300_07[1].xrcb036_desc,s_detail1_axrt300_07[1].xrcb012_desc,s_detail1_axrt300_07[1].xrcb015_desc,
             s_detail1_axrt300_07[1].xrcb016_desc,s_detail1_axrt300_07[1].xrcb034_desc,s_detail1_axrt300_07[1].xrcb035_desc

        ##業務人員
        #ON ACTION controlp INFIELD xrcb051_desc
        #   INITIALIZE g_qryparam.* TO NULL
        #   LET g_qryparam.state = 'c'
        #   LET g_qryparam.reqry = FALSE
        #   LET g_qryparam.default1 = g_xrcb_d[l_ac].xrcb051
        #   CALL q_ooag001_8()                               
        #   LET g_xrcb_d[l_ac].xrcb051 = g_qryparam.return1    
        #   LET g_xrcb_d[l_ac].xrcb051_desc= g_xrcb_d[l_ac].xrcb051
        #   DISPLAY BY NAME g_xrcb_d[l_ac].xrcb051,g_xrcb_d[l_ac].xrcb051_desc
        #   NEXT FIELD xrcb051_desc   
            
         #業務部門
         ON ACTION controlp INFIELD xrcb010_desc
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.arg1 = g_today
            CALL q_ooeg001_4()                             
            DISPLAY g_qryparam.return1 TO xrcb010
            DISPLAY g_qryparam.return1 TO xrcb010_desc
            NEXT FIELD xrcb010_desc   
            
         #責任中心
         ON ACTION controlp INFIELD xrcb011_desc
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.arg1 = g_today
            LET g_qryparam.where = " ooeg003 IN ('1','2','3')"
            CALL q_ooeg001_4()    
            DISPLAY g_qryparam.return1 TO xrcb011
            DISPLAY g_qryparam.return1 TO xrcb011_desc
            NEXT FIELD xrcb011_desc
         
         #區域 
         ON ACTION controlp INFIELD xrcb024_desc
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_oocq002_287()
            DISPLAY g_qryparam.return1 TO xrcb024
            DISPLAY g_qryparam.return1 TO xrcb024_desc
            NEXT FIELD xrcb024_desc
            
         #產品類別 
         ON ACTION controlp INFIELD xrcb012_desc
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_rtax001()                          
            DISPLAY g_qryparam.return1 TO xrcb012
            DISPLAY g_qryparam.return1 TO xrcb012_desc
            NEXT FIELD xrcb012_desc   
      
      
         #WBS
         ON ACTION controlp INFIELD xrcb016_desc
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.where = "pjbb012='1'"
            CALL q_pjbb002()
            DISPLAY g_qryparam.return1 TO xrcb016
            DISPLAY g_qryparam.return1 TO xrcb016_desc
            NEXT FIELD xrcb016_desc
            
         #專案代號
         ON ACTION controlp INFIELD xrcb015_desc
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_pjba001()
            DISPLAY g_qryparam.return1 TO xrcb015
            DISPLAY g_qryparam.return1 TO xrcb015_desc
            NEXT FIELD xrcb015_desc
         
         #客群
         ON ACTION controlp INFIELD xrcb036_desc
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_oocq002_281()
            DISPLAY g_qryparam.return1 TO xrcb036
            DISPLAY g_qryparam.return1 TO xrcb036_desc
            NEXT FIELD xrcb036_desc
         
         #渠道
         ON ACTION controlp INFIELD xrcb034_desc
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
            CALL q_oojd001_2()
            DISPLAY g_qryparam.return1 TO xrcb034
            DISPLAY g_qryparam.return1 TO xrcb034_desc
            NEXT FIELD xrcb034_desc
            
         #品牌
         ON ACTION controlp INFIELD xrcb035_desc
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_oocq002_2002()
            DISPLAY g_qryparam.return1 TO xrcb035
            DISPLAY g_qryparam.return1 TO xrcb035_desc
            NEXT FIELD xrcb035_desc
            
   END CONSTRUCT

END DIALOG

 
{</section>}
 
{<section id="axrt300_07.other_function" readonly="Y" >}
################################################################################
# Descriptions...: 單身填充
# Usage..........: CALL axrt300_07_b_fill(p_ent,p_ld,p_docno)
# Date & Author..: 2015/03/16 By 01727
# Modify.........:
################################################################################
PUBLIC FUNCTION axrt300_07_b_fill(p_ent,p_ld,p_docno)
DEFINE p_ent          LIKE xrca_t.xrcaent     
DEFINE p_ld           LIKE xrca_t.xrcald      #帳套
DEFINE p_docno        LIKE xrca_t.xrcadocno   #單據編號
DEFINE l_sql          STRING
DEFINE l_glad         RECORD
                      glad0171    LIKE  glad_t.glad0171, 
                      glad0172    LIKE  glad_t.glad0172,
                      glad0181    LIKE  glad_t.glad0181,
                      glad0182    LIKE  glad_t.glad0182,
                      glad0191    LIKE  glad_t.glad0191,
                      glad0192    LIKE  glad_t.glad0192,
                      glad0201    LIKE  glad_t.glad0201,
                      glad0202    LIKE  glad_t.glad0202,
                      glad0211    LIKE  glad_t.glad0211,
                      glad0212    LIKE  glad_t.glad0212,
                      glad0221    LIKE  glad_t.glad0221,
                      glad0222    LIKE  glad_t.glad0222,
                      glad0231    LIKE  glad_t.glad0231,
                      glad0232    LIKE  glad_t.glad0232,
                      glad0241    LIKE  glad_t.glad0241,
                      glad0242    LIKE  glad_t.glad0242,
                      glad0251    LIKE  glad_t.glad0251,
                      glad0252    LIKE  glad_t.glad0252,
                      glad0261    LIKE  glad_t.glad0261,
                      glad0262    LIKE  glad_t.glad0262
                  END RECORD

   #160129-00015#6 add--str--
   #多語言SQL
   DEFINE l_get_sql   RECORD
          xrcb010     STRING,  #部门
          xrcb011     STRING,  #责任中心
          xrcb024     STRING,  #区域
          xrcb036     STRING,  #客群
          xrcb012     STRING,  #产品类别
          xrcb051     STRING,  #人员
          xrcb015     STRING,  #专案代号
          xrcb016     STRING,  #WBS编号
          xrcb029     STRING,  #应收科目
          xrcb033     STRING,  #经营方式
          xrcb034     STRING,  #渠道
          xrcb035     STRING,  #品牌
          #160509-00004#37--add--str--lujh
          xrcb053     STRING,
          xrcb054     STRING,
          #160509-00004#37--add--end--lujh
          xrcb021      STRING  #收入会计科目     
                      END RECORD   
   #160129-00015#6 add--str--  

   CALL axrt300_07_clear_detail()

   LET l_ac = 1   

   #160129-00015#6 add--str--- 
   INITIALIZE l_get_sql.* TO NULL

   #應收科目
   CALL s_fin_get_account_sql('ta2','ta3','xrcbent','xrcbld','xrcb029') RETURNING l_get_sql.xrcb029
   #收入會科
   CALL s_fin_get_account_sql('ta4','ta5','xrcbent','xrcbld','xrcb021') RETURNING l_get_sql.xrcb021
   #人員 xrcb051
   CALL s_fin_get_person_sql('ta6','xrcbent','xrcb051') RETURNING l_get_sql.xrcb051
   #部門 xrcb010
   CALL s_fin_get_department_sql('ta7','xrcbent','xrcb010') RETURNING l_get_sql.xrcb010
   #責任中心 xrcb011
   CALL s_fin_get_department_sql('ta8','xrcbent','xrcb011') RETURNING l_get_sql.xrcb011
   #區域 xrcb024
   CALL s_fin_get_acc_sql('ta9','xrcbent','287','xrcb024') RETURNING l_get_sql.xrcb024
   #客群 xrcb036
   CALL s_fin_get_acc_sql('ta10','xrcbent','281','xrcb036') RETURNING l_get_sql.xrcb036
   #產品類別 xrcb012
   CALL s_fin_get_rtaxl003_sql('ta11','xrcbent','xrcb012') RETURNING l_get_sql.xrcb012
   #專案代號  xrcb015
   CALL s_fin_get_project_sql('ta12','xrcbent','xrcb015') RETURNING l_get_sql.xrcb015
   #WBS編號   xrcb016
   CALL s_fin_get_wbs_sql('ta13','xrcbent','xrcb015','xrcb016') RETURNING l_get_sql.xrcb016
   #渠道 xrcb034
   CALL s_fin_get_oojdl003_sql('ta14','xrcbent','xrcb034') RETURNING l_get_sql.xrcb034
   #品牌 xrcb035
   CALL s_fin_get_acc_sql('ta15','xrcbent','2002','xrcb035') RETURNING l_get_sql.xrcb035   
   #160129-00015#6 add--end--- 
   
   #160509-00004#37--add--str--lujh
   LET l_get_sql.xrcb053 = "(SELECT pmaal004 FROM pmaal_t WHERE pmaalent = '",g_enterprise,"' AND pmaal001 = xrcb053 AND pmaal002 = '",g_dlang,"')"
   LET l_get_sql.xrcb054 = "(SELECT pmaal004 FROM pmaal_t WHERE pmaalent = '",g_enterprise,"' AND pmaal001 = xrcb054 AND pmaal002 = '",g_dlang,"')"
   #160509-00004#37--add--end--lujh
 
#160129-00015#6 mod--str--- 
#   LET l_sql= " SELECT xrcbdocno,xrcbld,xrcbseq,xrcb047,  ",
#              "        xrcb029,'',xrcb021,'',xrcb051,'',xrcb010,'',xrcb011,'',xrcb024,'',",
#              "        xrcb036,'',xrcb012,'',xrcb015,'',xrcb016,'',xrcb033,   xrcb034,'',",
#              "        xrcb035,'',",
#              "        xrcb037,'',xrcb038,'',xrcb039,'',xrcb040,'',xrcb041,'',",
#              "        xrcb042,'',xrcb043,'',xrcb044,'',xrcb045,'',xrcb046,'' ",
#              "   FROM xrcb_t ",
#              "  WHERE xrcbent = ? AND xrcbld = ? AND xrcbdocno = ?",
#              "  ORDER BY xrcbseq"
   LET l_sql= " SELECT xrcbdocno,xrcbld,xrcbseq,xrcb047,  ",
              "        xrcb029,",l_get_sql.xrcb029,",xrcb021,",l_get_sql.xrcb021,",xrcb051,",l_get_sql.xrcb051,",",
              "        xrcb010,",l_get_sql.xrcb010,",xrcb011,",l_get_sql.xrcb011,",xrcb024,",l_get_sql.xrcb024,",",
              "        xrcb036,",l_get_sql.xrcb036,",xrcb012,",l_get_sql.xrcb012,",xrcb015,",l_get_sql.xrcb015,",",
              "        xrcb016,",l_get_sql.xrcb016,",xrcb033,xrcb034,",l_get_sql.xrcb034,",",
              "        xrcb035,",l_get_sql.xrcb035,",",
              #160509-00004#37--add--str--lujh
              "        xrcb053,",l_get_sql.xrcb053,",",
              "        xrcb054,",l_get_sql.xrcb054,",",
              #160509-00004#37--add--end--lujh
              "        xrcb037,'',xrcb038,'',xrcb039,'',xrcb040,'',xrcb041,'',",
              "        xrcb042,'',xrcb043,'',xrcb044,'',xrcb045,'',xrcb046,'' ",
              "   FROM xrcb_t ",
              "  WHERE xrcbent = ? AND xrcbld = ? AND xrcbdocno = ?",
              "  ORDER BY xrcbseq" 
#160129-00015#6 mod--end---              
   PREPARE xrcb_pre_1 FROM l_sql
   DECLARE xrcb_cur_1 CURSOR FOR xrcb_pre_1
   FOREACH xrcb_cur_1 USING p_ent,p_ld,p_docno INTO g_xrcb_d[l_ac].*     
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = SQLCA.sqlcode
         LET g_errparam.extend = "foreach:"
         LET g_errparam.popup = TRUE
         CALL cl_err()
         EXIT FOREACH
      END IF
     
      CALL s_fin_sel_glad(g_xrcb_d[l_ac].xrcbld,g_xrcb_d[l_ac].xrcb021,'glad0171|glad0172|glad0181|glad0182|glad0191|glad0192|glad0201|glad0202|glad0211|glad0212|glad0221|glad0222|glad0231|glad0232|glad0241|glad0242|glad0251|glad0252|glad0261|glad0262') 
           RETURNING g_errno,l_glad.*
      
      ##160129-00015#6 mod--str--
      ##業務人員
      #LET g_xrcb_d[l_ac].xrcb051_desc = s_desc_show1(g_xrcb_d[l_ac].xrcb051,s_desc_get_person_desc(g_xrcb_d[l_ac].xrcb051))
      ##業務部門
      #LET g_xrcb_d[l_ac].xrcb010_desc = s_desc_show1(g_xrcb_d[l_ac].xrcb010,s_desc_get_department_desc(g_xrcb_d[l_ac].xrcb010))
      ##責任中心
      #LET g_xrcb_d[l_ac].xrcb011_desc = s_desc_show1(g_xrcb_d[l_ac].xrcb011,s_desc_get_department_desc(g_xrcb_d[l_ac].xrcb011))
      ##產品類型
      #LET g_xrcb_d[l_ac].xrcb012_desc = s_desc_show1(g_xrcb_d[l_ac].xrcb012,s_desc_get_rtaxl003_desc(g_xrcb_d[l_ac].xrcb012))
      ##專案代號
      #LET g_xrcb_d[l_ac].xrcb015_desc = s_desc_show1(g_xrcb_d[l_ac].xrcb015,s_desc_get_project_desc(g_xrcb_d[l_ac].xrcb015))
      #
      #LET g_xrcb_d[l_ac].xrcb024_desc = s_desc_show1(g_xrcb_d[l_ac].xrcb024,s_desc_get_acc_desc('287',g_xrcb_d[l_ac].xrcb024))
      #LET g_xrcb_d[l_ac].xrcb034_desc = s_desc_show1(g_xrcb_d[l_ac].xrcb034, s_desc_get_oojdl003_desc(g_xrcb_d[l_ac].xrcb034))
      #LET g_xrcb_d[l_ac].xrcb035_desc = s_desc_show1(g_xrcb_d[l_ac].xrcb035,s_desc_get_acc_desc('2002',g_xrcb_d[l_ac].xrcb035))
      #LET g_xrcb_d[l_ac].xrcb036_desc = s_desc_show1(g_xrcb_d[l_ac].xrcb036,s_desc_get_acc_desc('281',g_xrcb_d[l_ac].xrcb036))
      #
      ##費用會計科目
      #LET g_xrcb_d[l_ac].xrcb021_desc = s_desc_show1(g_xrcb_d[l_ac].xrcb021,s_desc_get_account_desc(g_xrcb_d[l_ac].xrcbld,g_xrcb_d[l_ac].xrcb021))
      ##應付帳款科目
      #LET g_xrcb_d[l_ac].xrcb029_desc = s_desc_show1(g_xrcb_d[l_ac].xrcb029,s_desc_get_account_desc(g_xrcb_d[l_ac].xrcbld,g_xrcb_d[l_ac].xrcb029))
      

      #業務人員
      LET g_xrcb_d[l_ac].xrcb051_desc = s_desc_show1(g_xrcb_d[l_ac].xrcb051,g_xrcb_d[l_ac].xrcb051_desc)
      #業務部門
      LET g_xrcb_d[l_ac].xrcb010_desc = s_desc_show1(g_xrcb_d[l_ac].xrcb010,g_xrcb_d[l_ac].xrcb010_desc)
      #責任中心
      LET g_xrcb_d[l_ac].xrcb011_desc = s_desc_show1(g_xrcb_d[l_ac].xrcb011,g_xrcb_d[l_ac].xrcb011_desc)
      #產品類型
      LET g_xrcb_d[l_ac].xrcb012_desc = s_desc_show1(g_xrcb_d[l_ac].xrcb012,g_xrcb_d[l_ac].xrcb012_desc)
      #專案代號
      LET g_xrcb_d[l_ac].xrcb015_desc = s_desc_show1(g_xrcb_d[l_ac].xrcb015,g_xrcb_d[l_ac].xrcb015_desc)
      
      LET g_xrcb_d[l_ac].xrcb024_desc = s_desc_show1(g_xrcb_d[l_ac].xrcb024,g_xrcb_d[l_ac].xrcb024_desc)
      LET g_xrcb_d[l_ac].xrcb034_desc = s_desc_show1(g_xrcb_d[l_ac].xrcb034,g_xrcb_d[l_ac].xrcb034_desc)
      LET g_xrcb_d[l_ac].xrcb035_desc = s_desc_show1(g_xrcb_d[l_ac].xrcb035,g_xrcb_d[l_ac].xrcb035_desc)
      LET g_xrcb_d[l_ac].xrcb036_desc = s_desc_show1(g_xrcb_d[l_ac].xrcb036,g_xrcb_d[l_ac].xrcb036_desc)
      
      #費用會計科目
      LET g_xrcb_d[l_ac].xrcb021_desc = s_desc_show1(g_xrcb_d[l_ac].xrcb021,g_xrcb_d[l_ac].xrcb021_desc)
      #應付帳款科目
      LET g_xrcb_d[l_ac].xrcb029_desc = s_desc_show1(g_xrcb_d[l_ac].xrcb029,g_xrcb_d[l_ac].xrcb029_desc)
      ##160129-00015#6 mod--end--
      
      #160509-00004#37--add--str--lujh
      IF NOT cl_null(g_xrcb_d[l_ac].xrcb053) THEN 
         LET g_xrcb_d[l_ac].xrcb053_desc = s_desc_show1(g_xrcb_d[l_ac].xrcb053,g_xrcb_d[l_ac].xrcb053_desc)
      END IF
      
      IF NOT cl_null(g_xrcb_d[l_ac].xrcb054) THEN 
         LET g_xrcb_d[l_ac].xrcb054_desc = s_desc_show1(g_xrcb_d[l_ac].xrcb054,g_xrcb_d[l_ac].xrcb054_desc)
      END IF
      #160509-00004#37--add--end--lujh
      
      IF NOT cl_null(g_xrcb_d[l_ac].xrcb037) THEN
         LET g_xrcb_d[l_ac].xrcb037_desc = s_desc_show1(g_xrcb_d[l_ac].xrcb037,s_fin_get_accting_desc(l_glad.glad0171,g_xrcb_d[l_ac].xrcb037))
      END IF
      IF NOT cl_null(g_xrcb_d[l_ac].xrcb038) THEN
         LET g_xrcb_d[l_ac].xrcb038_desc = s_desc_show1(g_xrcb_d[l_ac].xrcb038,s_fin_get_accting_desc(l_glad.glad0181,g_xrcb_d[l_ac].xrcb038))
      END IF
      IF NOT cl_null(g_xrcb_d[l_ac].xrcb039) THEN
         LET g_xrcb_d[l_ac].xrcb039_desc = s_desc_show1(g_xrcb_d[l_ac].xrcb039,s_fin_get_accting_desc(l_glad.glad0191,g_xrcb_d[l_ac].xrcb039))
      END IF
      IF NOT cl_null(g_xrcb_d[l_ac].xrcb040) THEN
         LET g_xrcb_d[l_ac].xrcb040_desc = s_desc_show1(g_xrcb_d[l_ac].xrcb040,s_fin_get_accting_desc(l_glad.glad0201,g_xrcb_d[l_ac].xrcb040))
      END IF
      IF NOT cl_null(g_xrcb_d[l_ac].xrcb041) THEN
         LET g_xrcb_d[l_ac].xrcb041_desc = s_desc_show1(g_xrcb_d[l_ac].xrcb041,s_fin_get_accting_desc(l_glad.glad0211,g_xrcb_d[l_ac].xrcb041))
      END IF
      IF NOT cl_null(g_xrcb_d[l_ac].xrcb042) THEN   
         LET g_xrcb_d[l_ac].xrcb042_desc = s_desc_show1(g_xrcb_d[l_ac].xrcb042,s_fin_get_accting_desc(l_glad.glad0221,g_xrcb_d[l_ac].xrcb042))
      END IF
      IF NOT cl_null(g_xrcb_d[l_ac].xrcb043) THEN
         LET g_xrcb_d[l_ac].xrcb043_desc = s_desc_show1(g_xrcb_d[l_ac].xrcb043,s_fin_get_accting_desc(l_glad.glad0231,g_xrcb_d[l_ac].xrcb043))
      END IF
      IF NOT cl_null(g_xrcb_d[l_ac].xrcb044) THEN   
         LET g_xrcb_d[l_ac].xrcb044_desc = s_desc_show1(g_xrcb_d[l_ac].xrcb044,s_fin_get_accting_desc(l_glad.glad0241,g_xrcb_d[l_ac].xrcb044))
      END IF
      IF NOT cl_null(g_xrcb_d[l_ac].xrcb045) THEN   
         LET g_xrcb_d[l_ac].xrcb045_desc = s_desc_show1(g_xrcb_d[l_ac].xrcb045,s_fin_get_accting_desc(l_glad.glad0251,g_xrcb_d[l_ac].xrcb045))
      END IF
      IF NOT cl_null(g_xrcb_d[l_ac].xrcb046) THEN   
         LET g_xrcb_d[l_ac].xrcb046_desc = s_desc_show1(g_xrcb_d[l_ac].xrcb046,s_fin_get_accting_desc(l_glad.glad0261,g_xrcb_d[l_ac].xrcb046))
      END IF
     
      LET l_ac = l_ac + 1
      
   END FOREACH
   CALL g_xrcb_d.deleteElement(l_ac)
   
   LET g_rec_b04 = l_ac - 1
   LET g_xrcb_d4.* = g_xrcb_d.*
   FREE xrcb_pre_1

END FUNCTION

################################################################################
# Descriptions...: 清除畫面資料
# Memo...........:
# Usage..........: CALL axrt300_07_clear_detail()
#                  RETURNING ---
# Input parameter: 
# Return code....: 
# Date & Author..: 2015/03/16 By 01727
# Modify.........:
################################################################################
PUBLIC FUNCTION axrt300_07_clear_detail()
   CALL g_xrcb_d.clear()
END FUNCTION

 
{</section>}
 
