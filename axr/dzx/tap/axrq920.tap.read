<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<add_points prog="axrq920" std_prog="axrq920" erpver="1.0" module="AXR" ver="1" env="s" zone="t10dev" booking="N" type="M" identity="s">
  <other>
    <code_template value="Q" status=""/>
    <free_style value="N" status=""/>
  </other>
  <point name="function.axrq920_query_1" order="1" ver="1" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
#+ 資料查詢
PRIVATE FUNCTION axrq920_query_1()
   DEFINE ls_wc      LIKE type_t.chr500
   DEFINE ls_return  STRING
   DEFINE ls_result  STRING 
   DEFINE l_pass     LIKE type_t.num5
   DEFINE l_success  LIKE type_t.num5
   
   LET INT_FLAG = 0
   CLEAR FORM
   CALL g_xreb_d.clear()
   LET g_wc_filter = " 1=1"
   
   CALL gfrm_curr.setFieldHidden("formonly.sel", TRUE)
   CALL gfrm_curr.setFieldHidden("formonly.statepic", TRUE)
   
   LET g_qryparam.state = "c"
   LET g_detail_idx  = 1
   LET g_detail_idx2 = 1
   
   #wc備份
   LET ls_wc = g_wc
   LET g_master_idx = l_ac
 
   
 
   DIALOG ATTRIBUTES(UNBUFFERED,FIELD ORDER FORM)
 
      #單身根據table分拆construct
      CONSTRUCT g_wc_table ON xrec005,xrec006 FROM xrec005,xrec006
         BEFORE CONSTRUCT
         ON ACTION controlp INFIELD xrec005
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_pmaa001_5()                         #呼叫開窗
            DISPLAY g_qryparam.return1 TO xrec005  #顯示到畫面上
            NEXT FIELD xrec005                     #返回原欄位   
         ON ACTION controlp INFIELD xrec006
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_imaa001()                         #呼叫開窗
            DISPLAY g_qryparam.return1 TO xrec006  #顯示到畫面上
            NEXT FIELD xrec006                     #返回原欄位  
         
      END CONSTRUCT
      
      INPUT BY NAME tm.xreb001,tm.xreb002,tm.xrebld
         ATTRIBUTE(WITHOUT DEFAULTS)
         BEFORE INPUT
            LET tm.xreb001=YEAR(g_today)
            LET tm.xreb002=MONTH(g_today)
            CALL s_ld_bookno()  RETURNING l_success,tm.xrebld
            IF l_success = FALSE THEN
               LET tm.xrebld=""
            END IF 
            CALL s_ld_chk_authorization(g_user,tm.xrebld) RETURNING l_pass
            IF l_pass = FALSE THEN
               LET tm.xrebld=""
            END IF
            CALL axrq920_xrebld_desc()
            DISPLAY tm.xrebld_desc,tm.xrebcomp,tm.xrebcomp_desc TO xrebld_desc,xrebcomp,xrebcomp_desc
            
         AFTER FIELD xreb001
            IF NOT cl_null(tm.xreb001) AND NOT cl_null(tm.xreb002) AND NOT cl_null(tm.xrebld) THEN
               CALL axrq920_get_xref()
            END IF
         AFTER FIELD xreb002
            IF NOT cl_null(tm.xreb001) AND NOT cl_null(tm.xreb002) AND NOT cl_null(tm.xrebld) THEN
               CALL axrq920_get_xref()
            END IF
         AFTER FIELD xrebld
            IF NOT cl_null(tm.xrebld) THEN
               CALL axrq920_xrebld_chk()
               IF NOT cl_null(g_errno) THEN
                  CALL cl_err(tm.xrebld,g_errno,0)
                  LET tm.xrebld = ''
                  DISPLAY '','','' TO xrebld_desc,xrebcomp,xrebcomp_desc
                  NEXT FIELD xrebld
               END IF
               #检查使用者是否有权限使用当前账别
               CALL s_ld_chk_authorization(g_user,tm.xrebld) RETURNING l_pass
               IF l_pass = FALSE THEN
                  CALL cl_err(tm.xrebld,'axr-00022',0)
                  LET tm.xrebld = ''
                  DISPLAY '','','' TO xrebld_desc,xrebcomp,xrebcomp_desc
                  NEXT FIELD xrebld
               END IF
               IF NOT cl_null(tm.xreb001) AND NOT cl_null(tm.xreb002)  THEN
                  CALL axrq920_get_xref()
               END IF
            END IF 
            CALL axrq920_xrebld_desc()
            DISPLAY tm.xrebld,tm.xrebld_desc,tm.xrebcomp,tm.xrebcomp_desc
                 TO xrebld,xrebld_desc,xrebcomp,xrebcomp_desc
            
         ON ACTION controlp INFIELD xrebld
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = tm.xrebld             #給予default值

            #給予arg
            LET g_qryparam.arg1 = g_user
            LET g_qryparam.arg2 = g_dept
            
            CALL q_authorised_ld()                                #呼叫開窗

            LET tm.xrebld = g_qryparam.return1              
            CALL axrq920_xrebld_desc()
            DISPLAY tm.xrebld,tm.xrebld_desc,tm.xrebcomp,tm.xrebcomp_desc
                 TO xrebld,xrebld_desc,xrebcomp,xrebcomp_desc
            
            NEXT FIELD xrebld                          #返回原欄位
            
      END INPUT
      ON ACTION accept
         ACCEPT DIALOG
         
      ON ACTION cancel
         LET INT_FLAG = 1
         EXIT DIALOG
      
      #交談指令共用ACTION
      &include "common_action.4gl"
         CONTINUE DIALOG 
   END DIALOG
 
   
 
   IF INT_FLAG THEN
      LET INT_FLAG = 0
      #還原
      LET g_wc = ls_wc
   ELSE
      LET g_master_idx = 1
   END IF
   
   LET g_wc = g_wc_table 
 
 
        
   LET g_wc2 = " 1=1"
 
        
   LET g_error_show = 1
   CALL axrq920_set_page()
   CALL axrq920_fetch1('F')
   LET l_ac = g_master_idx
   IF g_detail_cnt = 0 AND NOT INT_FLAG THEN
      CALL cl_err("",-100,1)
   END IF
   
   CALL gfrm_curr.setFieldHidden("formonly.sel", FALSE)
   CALL gfrm_curr.setFieldHidden("formonly.statepic", FALSE)
END FUNCTION]]>
  </point>
  <point name="function.axrq920_xrebld_desc" order="2" ver="1" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 抓取帳套說明及法人資料
# Memo...........:
# Usage..........: CALL axrq920_xrebld_desc()
# Modify.........:
################################################################################
PRIVATE FUNCTION axrq920_xrebld_desc()
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = tm.xrebld
   CALL ap_ref_array2(g_ref_fields,"SELECT glaal002 FROM glaal_t WHERE glaalent='"||g_enterprise||"' AND glaalld=? AND glaal001='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET tm.xrebld_desc=g_rtn_fields[1]
   SELECT glaacomp INTO tm.xrebcomp FROM glaa_t
   WHERE glaaent=g_enterprise AND glaald=tm.xrebld
   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = tm.xrebcomp
   CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET tm.xrebcomp_desc= g_rtn_fields[1]
END FUNCTION]]>
  </point>
  <point name="function.axrq920_xrebld_chk" order="3" ver="1" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 檢查錄入的帳套是否正確
# Memo...........:
# Usage..........: CALL axrq920_xrebld_chk()
# Modify.........:
################################################################################
PRIVATE FUNCTION axrq920_xrebld_chk()
   DEFINE l_glaastus  LIKE glaa_t.glaastus
   
   LET g_errno = ''
   SELECT glaastus INTO l_glaastus FROM glaa_t
    WHERE glaaent = g_enterprise
      AND glaald = tm.xrebld
   CASE
      WHEN SQLCA.SQLCODE = 100   LET g_errno = 'agl-00016'
      WHEN l_glaastus = 'N'      LET g_errno = 'agl-00051'
   END CASE
END FUNCTION]]>
  </point>
  <point name="function.axrq920_b_fill1" order="4" ver="1" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 单身一查询
# Memo...........:
# Usage..........: CALL axrq920_b_fill1()
################################################################################
PRIVATE FUNCTION axrq920_b_fill1()
   DEFINE ls_wc           LIKE type_t.chr500
   DEFINE l_xrec005       LIKE xrec_t.xrec005
   DEFINE l_xrec011       LIKE xrec_t.xrec011
   DEFINE l_pmaal004      LIKE pmaal_t.pmaal004
   DEFINE l_year          LIKE xrec_t.xrec001
   DEFINE l_month         LIKE xrec_t.xrec002
   
   LET g_sql = "SELECT  UNIQUE xrec005,xrec006,imaal003,SUM(xrec007),SUM(xrec009),SUM(xrec008),-1*SUM(xrec010),SUM(xrec011) FROM xrec_t", 
               " LEFT JOIN imaal_t ON imaalent='"||g_enterprise||"' AND imaal001=xrec006 AND imaal002='"||g_dlang||"' ",
               " WHERE xrecent=",g_enterprise," AND xrecld='",tm.xrebld,"' AND xrec001=",tm.xreb001,
               "   AND xrec002=",tm.xreb002," AND xrec003='AR' AND xrec004='1' AND xrec005='",g_xrec005,"'",
               "   AND xrec006='",g_xrec006,"' ",
               " GROUP BY xrec005,xrec006,imaal003 ",
               " ORDER BY xrec005,xrec006,imaal003 "
               
   PREPARE axrq920_pb1 FROM g_sql
   DECLARE b_fill1_curs1 CURSOR FOR axrq920_pb1
   
   FOREACH b_fill1_curs1 INTO l_xrec005,g_xrec_d[l_ac].xrec006,g_xrec_d[l_ac].xrec006_desc, 
                              g_xrec_d[l_ac].xrec007,g_xrec_d[l_ac].xrec009,g_xrec_d[l_ac].xrec008, 
                              g_xrec_d[l_ac].xrec010,g_xrec_d[l_ac].xrec011
      IF SQLCA.sqlcode THEN
         CALL cl_err("FOREACH:",SQLCA.sqlcode,1)
         EXIT FOREACH
      END IF  
      LET g_xrec_d[l_ac].sel = "N"
      
      #交易說明
      LET l_pmaal004=''
      SELECT pmaal004 INTO l_pmaal004 FROM pmaal_t 
      WHERE pmaalent=g_enterprise AND pmaal001=l_xrce005 AND pmaal002=g_lang
      LET g_xrec_d[l_ac].xrec005=l_xrec005,l_pmaal004
      #上期未沖暫估累計金額
      IF tm.xreb002=1 THEN
         LET l_year=tm.xreb001-1
         LET l_month=12
      ELSE
         LET l_year=tm.xreb001
         LET l_month=tm.xreb002-1
      END IF
      SELECT SUM(xrec011) INTO g_xrec_d[l_ac].xrec011 FROM xrec_t
       WHERE xrecent=g_enterprise AND xrecld=tm.xrebld
         AND xrec001=l_year AND xrec002=l_month AND xrec003='AR'
         AND xrec005=l_xrec005 AND xrec006=g_xrec_d[l_ac].xrec006
         
      LET l_ac = l_ac + 1
      IF l_ac > g_max_rec THEN
         IF g_error_show = 1 THEN
            CALL cl_err( "", 9035, 1 )
         END IF
         EXIT FOREACH
      END IF
   END FOREACH
   LET g_error_show = 0
   LET l_ac = l_ac - 1
   CALL g_xrec_d.deleteElement(g_xrec_d.getLength())
   LET g_detail_cnt = l_ac 
   DISPLAY g_detail_cnt TO FORMONLY.cnt
   
   #單身二、單身三資料
   LET g_sql = "SELECT UNIQUE xreb004,xreb005,xreb006,xreb007,xreb020,xreb022,xreb008,xreb100,xreb103,", 
               "       xreb107,xreb113,xreb117,xreb101,xreb114,xreb123,xreb127,",
               "       xreb121,xreb124,xreb133,xreb137,xreb131,xreb134 ",
               "  FROM xreb_t,xrcb_t",
               " WHERE xrebent=xrcbent AND xrebld=xrcbld AND xreb005=xrcbdocno AND xreb006=xrcbseq ",
               "   AND xrebent=",g_enterprise," AND xrebcomp='",tm.xrebcomp,"' AND xrebld='",tm.xrebld,"'",
               "   AND xreb001=",tm.xreb001," AND xreb002=",tm.xreb002," AND xreb003='AR' ",
               "   AND xrcb005='",g_xrec006,"' AND xreb009='",g_xrec005,"'",
               " ORDER BY xreb004,xreb005,xreb006,xreb007 "
   PREPARE axrq920_pb2 FROM g_sql
   DECLARE b_fill_curs2 CURSOR FOR axrq920_pb2
   
   OPEN b_fill_curs USING g_enterprise
 
   CALL g_xreb_d.clear()
   CALL g_xreb3_d.clear()   
 
   LET g_cnt = l_ac
   LET l_ac = 1   
   ERROR "Searching!" 
 
   FOREACH b_fill_curs2 INTO g_xreb_d[l_ac].xreb004,g_xreb_d[l_ac].xreb005,g_xreb_d[l_ac].xreb006,g_xreb_d[l_ac].xreb007, 
       g_xreb_d[l_ac].xreb020,g_xreb_d[l_ac].xreb022,g_xreb_d[l_ac].xreb008,g_xreb_d[l_ac].xreb100,g_xreb_d[l_ac].xreb103, 
       g_xreb_d[l_ac].xreb107,g_xreb_d[l_ac].xreb113,g_xreb_d[l_ac].xreb117,g_xreb_d[l_ac].xreb101,g_xreb_d[l_ac].xreb114, 
       g_xreb3_d[l_ac].xreb123,g_xreb3_d[l_ac].xreb127,g_xreb3_d[l_ac].xreb121,g_xreb3_d[l_ac].xreb124, 
       g_xreb3_d[l_ac].xreb133,g_xreb3_d[l_ac].xreb137,g_xreb3_d[l_ac].xreb131,g_xreb3_d[l_ac].xreb134 

      IF SQLCA.sqlcode THEN
         CALL cl_err("FOREACH:",SQLCA.sqlcode,1)
         EXIT FOREACH
      END IF
      
      LET g_xreb3_d[l_ac].xreb004 = g_xreb_d[l_ac].xreb004
      LET g_xreb3_d[l_ac].xreb005 = g_xreb_d[l_ac].xreb005
      LET g_xreb3_d[l_ac].xreb006 = g_xreb_d[l_ac].xreb006
      LET g_xreb3_d[l_ac].xreb007 = g_xreb_d[l_ac].xreb007
      LET g_xreb3_d[l_ac].xreb020 = g_xreb_d[l_ac].xreb020
      LET g_xreb3_d[l_ac].xreb022 = g_xreb_d[l_ac].xreb022
      LET g_xreb3_d[l_ac].xreb008 = g_xreb_d[l_ac].xreb008
      LET g_xreb3_d[l_ac].xreb100 = g_xreb_d[l_ac].xreb100
 
      LET l_ac = l_ac + 1
      IF l_ac > g_max_rec THEN
         IF g_error_show = 1 THEN
            CALL cl_err( "", 9035, 1 )
         END IF
         EXIT FOREACH
      END IF
      
   END FOREACH
   LET g_error_show = 0
   
   CALL g_xreb_d.deleteElement(g_xreb_d.getLength())   
   CALL g_xreb3_d.deleteElement(g_xreb3_d.getLength()) 
END FUNCTION]]>
  </point>
  <point name="function.axrq920_get_xref" order="5" ver="1" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 抓取暫估月結傳票資料
# Memo...........:
# Usage..........: CALL axrq920_get_xref()
# Modify.........:
################################################################################
PRIVATE FUNCTION axrq920_get_xref()
   
   LET tm.xref007=''
   LET tm.xref008=''
   SELECT xref007,xref008 INTO tm.xref007,tm.xref008 FROM xref_t
   WHERE xrefent=g_enterprise AND xrefcomp=tm.xrebcomp AND xrefld=tm.xrebld
   AND xref001=tm.xreb001 AND xref002=tm.xreb002 AND xref003='AR' 
   
   DISPLAY tm.xref007,tm.xref008 TO xref007,xref008
END FUNCTION]]>
  </point>
  <point name="function.axrq920_set_page" order="6" ver="1" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 查詢該期別條件下所有交易對象+科目資料
# Memo...........:
# Usage..........: CALL axrq920_set_page()
# Modify.........:
################################################################################
PRIVATE FUNCTION axrq920_set_page()
   DEFINE l_sql    STRING
   DEFINE l_idx    LIKE type_t.num5
   
   CALL g_xrec_p.clear()
   LET l_sql="SELECT DISTINCT xrec005,xrec006 FROM xrec_t",
             " WHERE xrecent=",g_enterprise," AND xrec001=",tm.xreb001," AND xrec002=",tm.xreb002,
             "   AND xrecld='",tm.xrebld,"' AND xrec003='AR' AND xrec004='1' AND ",g_wc,
             " ORDER BY xrec005,xrec006 "
   PREPARE axrq920_sel_p_pr FROM l_sql
   DECLARE axrq920_sel_p_cr CURSOR FOR axrq920_sel_p_pr
   LET l_idx=1
   FOREACH axrq920_sel_p_cr INTO g_xrec_p[l_idx].xrec005,g_xrec_p[l_idx].xrec006
      IF SQLCA.sqlcode THEN
         CALL cl_err('FOREACH axrq920_sel_p_cr',SQLCA.sqlcode,0)
         EXIT FOREACH
      END IF
      LET l_idx=l_idx+1
      IF l_idx > g_max_rec THEN
         CALL cl_err('',9035,0)
         EXIT FOREACH
      END IF
   END FOREACH
   LET l_idx=l_idx-1
   CALL g_xrec_p.deleteElement(g_xrec_p.getLength())
   LET g_header_cnt = l_idx
   LET g_rec_b = l_idx
   DISPLAY g_header_cnt TO FORMONLY.h_count
END FUNCTION]]>
  </point>
  <point name="function.axrq920_fetch1" order="7" ver="1" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 描述说明
# Memo...........:
# Usage..........: CALL axrq920_fetch1(p_flag)
# Input parameter: p_flag   传入参数变量说明1執行操作
# Modify.........:
################################################################################
PRIVATE FUNCTION axrq920_fetch1(p_flag)
   DEFINE p_flag   LIKE type_t.chr1
   DEFINE ls_msg     STRING
   
   IF g_header_cnt = 0 THEN
      RETURN
   END IF
   
   CASE p_flag
      WHEN 'F' LET g_current_idx = 1
      WHEN 'L' LET g_current_idx = g_header_cnt        
      WHEN 'P'
         IF g_current_idx > 1 THEN               
            LET g_current_idx = g_current_idx - 1
         END IF 
      WHEN 'N'
         IF g_current_idx < g_header_cnt THEN
            LET g_current_idx =  g_current_idx + 1
         END IF        
      WHEN '/'
         IF (NOT g_no_ask) THEN    
            CALL cl_set_act_visible("accept,cancel", TRUE)    
            CALL cl_getmsg('fetch',g_lang) RETURNING ls_msg
            LET INT_FLAG = 0
 
            PROMPT ls_msg CLIPPED,':' FOR g_jump
               #交談指令共用ACTION
               &include "common_action.4gl" 
            END PROMPT
 
            CALL cl_set_act_visible("accept,cancel", FALSE)    
            IF INT_FLAG THEN
                LET INT_FLAG = 0
                EXIT CASE  
            END IF           
         END IF
         
         IF g_jump > 0 AND g_jump <= g_xrec_p.getLength() THEN
             LET g_current_idx = g_jump
         END IF
         
         LET g_no_ask = FALSE  
   END CASE 
   
   #代表沒有資料
   IF g_current_idx = 0 OR g_xrec_p.getLength() = 0 THEN
      RETURN
   END IF
   
   #超出範圍
   IF g_current_idx > g_xrec_p.getLength() THEN
      LET g_current_idx = g_xrec_p.getLength()
   END IF
   
   DISPLAY g_current_idx TO FORMONLY.h_index
   LET g_xrec005 = g_xrec_p[g_current_idx].xrec005
   LET g_xrec006 = g_xrec_p[g_current_idx].xrec006
   CALL axrq920_b_fill1() 
END FUNCTION]]>
  </point>
  <point name="function.axrq920_show" order="8" ver="1" cite_std="N" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 顯示單頭資料
# Memo...........:
# Usage..........: CALL axrq920_show()
# Modify.........:
################################################################################
PRIVATE FUNCTION axrq920_show()
   
   DISPLAY tm.xreb001,tm.xreb002,tm.xrebld,tm.xrebld_desc,tm.xrebcomp,tm.xrebcomp_desc,
           tm.xref007,tm.xref008,g_xrec005,g_xrec006
        TO xreb001,xreb002,xrebld,xrebld_desc,xrebcomp,xrebcomp_desc,xref007,xref008,xrec005,xrec006
END FUNCTION]]>
  </point>
  <point name="b_fill.define" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[   ]]>
  </point>
  <point name="b_fill.others.fill" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[   ]]>
  </point>
  <point name="b_fill.sql_after" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[   ]]>
  </point>
  <point name="b_fill.sql_before" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[   ]]>
  </point>
  <point name="detail_show.body.reference" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xrec_d[l_ac].xrec006
            CALL ap_ref_array2(g_ref_fields,"SELECT imaal003 FROM imaal_t WHERE imaalent='"||g_enterprise||"' AND imaal001=? AND imaal002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xrec_d[l_ac].xrec006_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xrec_d[l_ac].xrec006_desc
]]>
  </point>
  <point name="fetch.define" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="global.variable" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[ TYPE type_g_xrec_d RECORD
       sel            LIKE type_t.chr1,
       xrec005 LIKE type_t.chr500, 
   xrec006 LIKE xrec_t.xrec006, 
   xrec006_desc LIKE type_t.chr500, 
   xrec011_1 LIKE xrec_t.xrec011, 
   xrec007 LIKE xrec_t.xrec007, 
   xrec009 LIKE xrec_t.xrec009, 
   xrec008 LIKE xrec_t.xrec008, 
   xrec010 LIKE xrec_t.xrec010, 
   xrec011 LIKE xrec_t.xrec011 
       END RECORD
DEFINE g_xrec_d          DYNAMIC ARRAY OF type_g_xrec_d

DEFINE tm                RECORD
   xreb001               LIKE xreb_t.xreb001,
   xreb002               LIKE xreb_t.xreb002,
   xrebld                LIKE xreb_t.xrebld,
   xrebld_desc           LIKE glaal_t.glaal002,
   xrebcomp              LIKE xreb_t.xrebcomp,
   xrebcomp_desc         LIKE ooefl_t.ooefl003,
   xref007               LIKE xref_t.xref007,
   xref008               LIKE xref_t.xref008
      END RECORD  
DEFINE g_xrec_p          DYNAMIC ARRAY OF RECORD    #資料瀏覽之欄位 
       xrec005           LIKE xrec_t.xrec005,
       xrec006           LIKE xrec_t.xrec006
      END RECORD 
DEFINE g_xrec005         LIKE xrec_t.xrec005
DEFINE g_xrec006         LIKE xrec_t.xrec006
DEFINE g_current_row   LIKE type_t.num5
DEFINE g_current_idx   LIKE type_t.num10     
DEFINE g_jump          LIKE type_t.num10        
DEFINE g_no_ask        LIKE type_t.num5  
DEFINE g_rec_b         LIKE type_t.num5]]>
  </point>
  <point name="init.define" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[   DEFINE l_sql         STRING
   DEFINE l_str         STRING 
   DEFINE l_gzcb002     LIKE gzcb_t.gzcb002]]>
  </point>
  <point name="init.init" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[   CALL cl_set_combo_scc('xreb001','43')
#   CALL cl_set_combo_scc('xreb002','39')
   LET l_sql = "SELECT gzcb002 FROM gzcb_t WHERE gzcb001 = '8302' AND gzcb005 ='axrt320' "
   PREPARE axrq920_xrcb004_prep FROM l_sql
   DECLARE axrq920_xrcb004_curs CURSOR FOR axrq920_xrcb004_prep
   LET l_str = NULL
   LET l_gzcb002 = NULL
   FOREACH axrq920_xrcb004_curs INTO l_gzcb002
      IF cl_null(l_str) THEN 
         LET l_str = l_gzcb002 
         CONTINUE FOREACH 
      END IF
      LET l_str = l_str,",",l_gzcb002
   END FOREACH
   CALL cl_set_combo_scc_part('xreb004','8302',l_str)
   CALL cl_set_combo_scc_part('xreb004_1','8302',l_str)]]>
  </point>
  <point name="input.a.page1.xreb001" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xreb_d[g_detail_idx].xrebld IS NOT NULL AND g_xreb_d[g_detail_idx].xreb001 IS NOT NULL AND g_xreb_d[g_detail_idx].xreb002 IS NOT NULL AND g_xreb_d[g_detail_idx].xreb005 IS NOT NULL AND g_xreb_d[g_detail_idx].xreb006 IS NOT NULL AND g_xreb_d[g_detail_idx].xreb007 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xreb_d[g_detail_idx].xrebld != g_xreb_d_t.xrebld OR g_xreb_d[g_detail_idx].xreb001 != g_xreb_d_t.xreb001 OR g_xreb_d[g_detail_idx].xreb002 != g_xreb_d_t.xreb002 OR g_xreb_d[g_detail_idx].xreb005 != g_xreb_d_t.xreb005 OR g_xreb_d[g_detail_idx].xreb006 != g_xreb_d_t.xreb006 OR g_xreb_d[g_detail_idx].xreb007 != g_xreb_d_t.xreb007)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xreb_t WHERE "||"xrebent = '" ||g_enterprise|| "' AND "||"xrebld = '"||g_xreb_d[g_detail_idx].xrebld ||"' AND "|| "xreb001 = '"||g_xreb_d[g_detail_idx].xreb001 ||"' AND "|| "xreb002 = '"||g_xreb_d[g_detail_idx].xreb002 ||"' AND "|| "xreb005 = '"||g_xreb_d[g_detail_idx].xreb005 ||"' AND "|| "xreb006 = '"||g_xreb_d[g_detail_idx].xreb006 ||"' AND "|| "xreb007 = '"||g_xreb_d[g_detail_idx].xreb007 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page1.xreb002" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xreb_d[g_detail_idx].xrebld IS NOT NULL AND g_xreb_d[g_detail_idx].xreb001 IS NOT NULL AND g_xreb_d[g_detail_idx].xreb002 IS NOT NULL AND g_xreb_d[g_detail_idx].xreb005 IS NOT NULL AND g_xreb_d[g_detail_idx].xreb006 IS NOT NULL AND g_xreb_d[g_detail_idx].xreb007 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xreb_d[g_detail_idx].xrebld != g_xreb_d_t.xrebld OR g_xreb_d[g_detail_idx].xreb001 != g_xreb_d_t.xreb001 OR g_xreb_d[g_detail_idx].xreb002 != g_xreb_d_t.xreb002 OR g_xreb_d[g_detail_idx].xreb005 != g_xreb_d_t.xreb005 OR g_xreb_d[g_detail_idx].xreb006 != g_xreb_d_t.xreb006 OR g_xreb_d[g_detail_idx].xreb007 != g_xreb_d_t.xreb007)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xreb_t WHERE "||"xrebent = '" ||g_enterprise|| "' AND "||"xrebld = '"||g_xreb_d[g_detail_idx].xrebld ||"' AND "|| "xreb001 = '"||g_xreb_d[g_detail_idx].xreb001 ||"' AND "|| "xreb002 = '"||g_xreb_d[g_detail_idx].xreb002 ||"' AND "|| "xreb005 = '"||g_xreb_d[g_detail_idx].xreb005 ||"' AND "|| "xreb006 = '"||g_xreb_d[g_detail_idx].xreb006 ||"' AND "|| "xreb007 = '"||g_xreb_d[g_detail_idx].xreb007 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page1.xreb005" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xreb_d[g_detail_idx].xrebld IS NOT NULL AND g_xreb_d[g_detail_idx].xreb001 IS NOT NULL AND g_xreb_d[g_detail_idx].xreb002 IS NOT NULL AND g_xreb_d[g_detail_idx].xreb005 IS NOT NULL AND g_xreb_d[g_detail_idx].xreb006 IS NOT NULL AND g_xreb_d[g_detail_idx].xreb007 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xreb_d[g_detail_idx].xrebld != g_xreb_d_t.xrebld OR g_xreb_d[g_detail_idx].xreb001 != g_xreb_d_t.xreb001 OR g_xreb_d[g_detail_idx].xreb002 != g_xreb_d_t.xreb002 OR g_xreb_d[g_detail_idx].xreb005 != g_xreb_d_t.xreb005 OR g_xreb_d[g_detail_idx].xreb006 != g_xreb_d_t.xreb006 OR g_xreb_d[g_detail_idx].xreb007 != g_xreb_d_t.xreb007)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xreb_t WHERE "||"xrebent = '" ||g_enterprise|| "' AND "||"xrebld = '"||g_xreb_d[g_detail_idx].xrebld ||"' AND "|| "xreb001 = '"||g_xreb_d[g_detail_idx].xreb001 ||"' AND "|| "xreb002 = '"||g_xreb_d[g_detail_idx].xreb002 ||"' AND "|| "xreb005 = '"||g_xreb_d[g_detail_idx].xreb005 ||"' AND "|| "xreb006 = '"||g_xreb_d[g_detail_idx].xreb006 ||"' AND "|| "xreb007 = '"||g_xreb_d[g_detail_idx].xreb007 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page1.xreb006" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xreb_d[g_detail_idx].xrebld IS NOT NULL AND g_xreb_d[g_detail_idx].xreb001 IS NOT NULL AND g_xreb_d[g_detail_idx].xreb002 IS NOT NULL AND g_xreb_d[g_detail_idx].xreb005 IS NOT NULL AND g_xreb_d[g_detail_idx].xreb006 IS NOT NULL AND g_xreb_d[g_detail_idx].xreb007 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xreb_d[g_detail_idx].xrebld != g_xreb_d_t.xrebld OR g_xreb_d[g_detail_idx].xreb001 != g_xreb_d_t.xreb001 OR g_xreb_d[g_detail_idx].xreb002 != g_xreb_d_t.xreb002 OR g_xreb_d[g_detail_idx].xreb005 != g_xreb_d_t.xreb005 OR g_xreb_d[g_detail_idx].xreb006 != g_xreb_d_t.xreb006 OR g_xreb_d[g_detail_idx].xreb007 != g_xreb_d_t.xreb007)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xreb_t WHERE "||"xrebent = '" ||g_enterprise|| "' AND "||"xrebld = '"||g_xreb_d[g_detail_idx].xrebld ||"' AND "|| "xreb001 = '"||g_xreb_d[g_detail_idx].xreb001 ||"' AND "|| "xreb002 = '"||g_xreb_d[g_detail_idx].xreb002 ||"' AND "|| "xreb005 = '"||g_xreb_d[g_detail_idx].xreb005 ||"' AND "|| "xreb006 = '"||g_xreb_d[g_detail_idx].xreb006 ||"' AND "|| "xreb007 = '"||g_xreb_d[g_detail_idx].xreb007 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page1.xreb007" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xreb_d[g_detail_idx].xrebld IS NOT NULL AND g_xreb_d[g_detail_idx].xreb001 IS NOT NULL AND g_xreb_d[g_detail_idx].xreb002 IS NOT NULL AND g_xreb_d[g_detail_idx].xreb005 IS NOT NULL AND g_xreb_d[g_detail_idx].xreb006 IS NOT NULL AND g_xreb_d[g_detail_idx].xreb007 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xreb_d[g_detail_idx].xrebld != g_xreb_d_t.xrebld OR g_xreb_d[g_detail_idx].xreb001 != g_xreb_d_t.xreb001 OR g_xreb_d[g_detail_idx].xreb002 != g_xreb_d_t.xreb002 OR g_xreb_d[g_detail_idx].xreb005 != g_xreb_d_t.xreb005 OR g_xreb_d[g_detail_idx].xreb006 != g_xreb_d_t.xreb006 OR g_xreb_d[g_detail_idx].xreb007 != g_xreb_d_t.xreb007)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xreb_t WHERE "||"xrebent = '" ||g_enterprise|| "' AND "||"xrebld = '"||g_xreb_d[g_detail_idx].xrebld ||"' AND "|| "xreb001 = '"||g_xreb_d[g_detail_idx].xreb001 ||"' AND "|| "xreb002 = '"||g_xreb_d[g_detail_idx].xreb002 ||"' AND "|| "xreb005 = '"||g_xreb_d[g_detail_idx].xreb005 ||"' AND "|| "xreb006 = '"||g_xreb_d[g_detail_idx].xreb006 ||"' AND "|| "xreb007 = '"||g_xreb_d[g_detail_idx].xreb007 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page1.xrebld" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xreb_d[g_detail_idx].xrebld IS NOT NULL AND g_xreb_d[g_detail_idx].xreb001 IS NOT NULL AND g_xreb_d[g_detail_idx].xreb002 IS NOT NULL AND g_xreb_d[g_detail_idx].xreb005 IS NOT NULL AND g_xreb_d[g_detail_idx].xreb006 IS NOT NULL AND g_xreb_d[g_detail_idx].xreb007 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xreb_d[g_detail_idx].xrebld != g_xreb_d_t.xrebld OR g_xreb_d[g_detail_idx].xreb001 != g_xreb_d_t.xreb001 OR g_xreb_d[g_detail_idx].xreb002 != g_xreb_d_t.xreb002 OR g_xreb_d[g_detail_idx].xreb005 != g_xreb_d_t.xreb005 OR g_xreb_d[g_detail_idx].xreb006 != g_xreb_d_t.xreb006 OR g_xreb_d[g_detail_idx].xreb007 != g_xreb_d_t.xreb007)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xreb_t WHERE "||"xrebent = '" ||g_enterprise|| "' AND "||"xrebld = '"||g_xreb_d[g_detail_idx].xrebld ||"' AND "|| "xreb001 = '"||g_xreb_d[g_detail_idx].xreb001 ||"' AND "|| "xreb002 = '"||g_xreb_d[g_detail_idx].xreb002 ||"' AND "|| "xreb005 = '"||g_xreb_d[g_detail_idx].xreb005 ||"' AND "|| "xreb006 = '"||g_xreb_d[g_detail_idx].xreb006 ||"' AND "|| "xreb007 = '"||g_xreb_d[g_detail_idx].xreb007 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page1.xrec001" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xrec_d[g_detail_idx2].xrecld IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec001 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec002 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec003 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec004 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec005 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec006 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec012 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec100 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrecld IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec001 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec002 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec003 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec004 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec005 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec006 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec012 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec100 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xrec_d[g_detail_idx2].xrecld != g_xrec_d_t.xrecld OR g_xrec_d[g_detail_idx2].xrec001 != g_xrec_d_t.xrec001 OR g_xrec_d[g_detail_idx2].xrec002 != g_xrec_d_t.xrec002 OR g_xrec_d[g_detail_idx2].xrec003 != g_xrec_d_t.xrec003 OR g_xrec_d[g_detail_idx2].xrec004 != g_xrec_d_t.xrec004 OR g_xrec_d[g_detail_idx2].xrec005 != g_xrec_d_t.xrec005 OR g_xrec_d[g_detail_idx2].xrec006 != g_xrec_d_t.xrec006 OR g_xrec_d[g_detail_idx2].xrec012 != g_xrec_d_t.xrec012 OR g_xrec_d[g_detail_idx2].xrec100 != g_xrec_d_t.xrec100)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xrec_t WHERE "||"xrecent = '" ||g_enterprise|| "' AND "||"xrecld = '"||g_xrec_d[g_detail_idx2].xrecld ||"' AND "|| "xrec001 = '"||g_xrec_d[g_detail_idx2].xrec001 ||"' AND "|| "xrec002 = '"||g_xrec_d[g_detail_idx2].xrec002 ||"' AND "|| "xrec003 = '"||g_xrec_d[g_detail_idx2].xrec003 ||"' AND "|| "xrec004 = '"||g_xrec_d[g_detail_idx2].xrec004 ||"' AND "|| "xrec005 = '"||g_xrec_d[g_detail_idx2].xrec005 ||"' AND "|| "xrec006 = '"||g_xrec_d[g_detail_idx2].xrec006 ||"' AND "|| "xrec012 = '"||g_xrec_d[g_detail_idx2].xrec012 ||"' AND "|| "xrec100 = '"||g_xrec_d[g_detail_idx2].xrec100 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page1.xrec002" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xrec_d[g_detail_idx2].xrecld IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec001 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec002 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec003 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec004 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec005 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec006 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec012 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec100 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrecld IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec001 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec002 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec003 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec004 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec005 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec006 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec012 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec100 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xrec_d[g_detail_idx2].xrecld != g_xrec_d_t.xrecld OR g_xrec_d[g_detail_idx2].xrec001 != g_xrec_d_t.xrec001 OR g_xrec_d[g_detail_idx2].xrec002 != g_xrec_d_t.xrec002 OR g_xrec_d[g_detail_idx2].xrec003 != g_xrec_d_t.xrec003 OR g_xrec_d[g_detail_idx2].xrec004 != g_xrec_d_t.xrec004 OR g_xrec_d[g_detail_idx2].xrec005 != g_xrec_d_t.xrec005 OR g_xrec_d[g_detail_idx2].xrec006 != g_xrec_d_t.xrec006 OR g_xrec_d[g_detail_idx2].xrec012 != g_xrec_d_t.xrec012 OR g_xrec_d[g_detail_idx2].xrec100 != g_xrec_d_t.xrec100)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xrec_t WHERE "||"xrecent = '" ||g_enterprise|| "' AND "||"xrecld = '"||g_xrec_d[g_detail_idx2].xrecld ||"' AND "|| "xrec001 = '"||g_xrec_d[g_detail_idx2].xrec001 ||"' AND "|| "xrec002 = '"||g_xrec_d[g_detail_idx2].xrec002 ||"' AND "|| "xrec003 = '"||g_xrec_d[g_detail_idx2].xrec003 ||"' AND "|| "xrec004 = '"||g_xrec_d[g_detail_idx2].xrec004 ||"' AND "|| "xrec005 = '"||g_xrec_d[g_detail_idx2].xrec005 ||"' AND "|| "xrec006 = '"||g_xrec_d[g_detail_idx2].xrec006 ||"' AND "|| "xrec012 = '"||g_xrec_d[g_detail_idx2].xrec012 ||"' AND "|| "xrec100 = '"||g_xrec_d[g_detail_idx2].xrec100 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page1.xrec003" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xrec_d[g_detail_idx2].xrecld IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec001 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec002 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec003 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec004 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec005 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec006 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec012 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec100 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrecld IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec001 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec002 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec003 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec004 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec005 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec006 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec012 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec100 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xrec_d[g_detail_idx2].xrecld != g_xrec_d_t.xrecld OR g_xrec_d[g_detail_idx2].xrec001 != g_xrec_d_t.xrec001 OR g_xrec_d[g_detail_idx2].xrec002 != g_xrec_d_t.xrec002 OR g_xrec_d[g_detail_idx2].xrec003 != g_xrec_d_t.xrec003 OR g_xrec_d[g_detail_idx2].xrec004 != g_xrec_d_t.xrec004 OR g_xrec_d[g_detail_idx2].xrec005 != g_xrec_d_t.xrec005 OR g_xrec_d[g_detail_idx2].xrec006 != g_xrec_d_t.xrec006 OR g_xrec_d[g_detail_idx2].xrec012 != g_xrec_d_t.xrec012 OR g_xrec_d[g_detail_idx2].xrec100 != g_xrec_d_t.xrec100)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xrec_t WHERE "||"xrecent = '" ||g_enterprise|| "' AND "||"xrecld = '"||g_xrec_d[g_detail_idx2].xrecld ||"' AND "|| "xrec001 = '"||g_xrec_d[g_detail_idx2].xrec001 ||"' AND "|| "xrec002 = '"||g_xrec_d[g_detail_idx2].xrec002 ||"' AND "|| "xrec003 = '"||g_xrec_d[g_detail_idx2].xrec003 ||"' AND "|| "xrec004 = '"||g_xrec_d[g_detail_idx2].xrec004 ||"' AND "|| "xrec005 = '"||g_xrec_d[g_detail_idx2].xrec005 ||"' AND "|| "xrec006 = '"||g_xrec_d[g_detail_idx2].xrec006 ||"' AND "|| "xrec012 = '"||g_xrec_d[g_detail_idx2].xrec012 ||"' AND "|| "xrec100 = '"||g_xrec_d[g_detail_idx2].xrec100 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page1.xrec004" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xrec_d[g_detail_idx2].xrecld IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec001 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec002 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec003 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec004 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec005 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec006 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec012 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec100 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrecld IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec001 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec002 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec003 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec004 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec005 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec006 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec012 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec100 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xrec_d[g_detail_idx2].xrecld != g_xrec_d_t.xrecld OR g_xrec_d[g_detail_idx2].xrec001 != g_xrec_d_t.xrec001 OR g_xrec_d[g_detail_idx2].xrec002 != g_xrec_d_t.xrec002 OR g_xrec_d[g_detail_idx2].xrec003 != g_xrec_d_t.xrec003 OR g_xrec_d[g_detail_idx2].xrec004 != g_xrec_d_t.xrec004 OR g_xrec_d[g_detail_idx2].xrec005 != g_xrec_d_t.xrec005 OR g_xrec_d[g_detail_idx2].xrec006 != g_xrec_d_t.xrec006 OR g_xrec_d[g_detail_idx2].xrec012 != g_xrec_d_t.xrec012 OR g_xrec_d[g_detail_idx2].xrec100 != g_xrec_d_t.xrec100)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xrec_t WHERE "||"xrecent = '" ||g_enterprise|| "' AND "||"xrecld = '"||g_xrec_d[g_detail_idx2].xrecld ||"' AND "|| "xrec001 = '"||g_xrec_d[g_detail_idx2].xrec001 ||"' AND "|| "xrec002 = '"||g_xrec_d[g_detail_idx2].xrec002 ||"' AND "|| "xrec003 = '"||g_xrec_d[g_detail_idx2].xrec003 ||"' AND "|| "xrec004 = '"||g_xrec_d[g_detail_idx2].xrec004 ||"' AND "|| "xrec005 = '"||g_xrec_d[g_detail_idx2].xrec005 ||"' AND "|| "xrec006 = '"||g_xrec_d[g_detail_idx2].xrec006 ||"' AND "|| "xrec012 = '"||g_xrec_d[g_detail_idx2].xrec012 ||"' AND "|| "xrec100 = '"||g_xrec_d[g_detail_idx2].xrec100 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page1.xrec005" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xrec_d[g_detail_idx2].xrecld IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec001 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec002 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec003 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec004 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec005 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec006 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec012 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec100 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrecld IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec001 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec002 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec003 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec004 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec005 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec006 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec012 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec100 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xrec_d[g_detail_idx2].xrecld != g_xrec_d_t.xrecld OR g_xrec_d[g_detail_idx2].xrec001 != g_xrec_d_t.xrec001 OR g_xrec_d[g_detail_idx2].xrec002 != g_xrec_d_t.xrec002 OR g_xrec_d[g_detail_idx2].xrec003 != g_xrec_d_t.xrec003 OR g_xrec_d[g_detail_idx2].xrec004 != g_xrec_d_t.xrec004 OR g_xrec_d[g_detail_idx2].xrec005 != g_xrec_d_t.xrec005 OR g_xrec_d[g_detail_idx2].xrec006 != g_xrec_d_t.xrec006 OR g_xrec_d[g_detail_idx2].xrec012 != g_xrec_d_t.xrec012 OR g_xrec_d[g_detail_idx2].xrec100 != g_xrec_d_t.xrec100)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xrec_t WHERE "||"xrecent = '" ||g_enterprise|| "' AND "||"xrecld = '"||g_xrec_d[g_detail_idx2].xrecld ||"' AND "|| "xrec001 = '"||g_xrec_d[g_detail_idx2].xrec001 ||"' AND "|| "xrec002 = '"||g_xrec_d[g_detail_idx2].xrec002 ||"' AND "|| "xrec003 = '"||g_xrec_d[g_detail_idx2].xrec003 ||"' AND "|| "xrec004 = '"||g_xrec_d[g_detail_idx2].xrec004 ||"' AND "|| "xrec005 = '"||g_xrec_d[g_detail_idx2].xrec005 ||"' AND "|| "xrec006 = '"||g_xrec_d[g_detail_idx2].xrec006 ||"' AND "|| "xrec012 = '"||g_xrec_d[g_detail_idx2].xrec012 ||"' AND "|| "xrec100 = '"||g_xrec_d[g_detail_idx2].xrec100 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page1.xrec006" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xrec_d[g_detail_idx2].xrecld IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec001 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec002 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec003 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec004 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec005 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec006 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec012 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec100 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrecld IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec001 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec002 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec003 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec004 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec005 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec006 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec012 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec100 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xrec_d[g_detail_idx2].xrecld != g_xrec_d_t.xrecld OR g_xrec_d[g_detail_idx2].xrec001 != g_xrec_d_t.xrec001 OR g_xrec_d[g_detail_idx2].xrec002 != g_xrec_d_t.xrec002 OR g_xrec_d[g_detail_idx2].xrec003 != g_xrec_d_t.xrec003 OR g_xrec_d[g_detail_idx2].xrec004 != g_xrec_d_t.xrec004 OR g_xrec_d[g_detail_idx2].xrec005 != g_xrec_d_t.xrec005 OR g_xrec_d[g_detail_idx2].xrec006 != g_xrec_d_t.xrec006 OR g_xrec_d[g_detail_idx2].xrec012 != g_xrec_d_t.xrec012 OR g_xrec_d[g_detail_idx2].xrec100 != g_xrec_d_t.xrec100)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xrec_t WHERE "||"xrecent = '" ||g_enterprise|| "' AND "||"xrecld = '"||g_xrec_d[g_detail_idx2].xrecld ||"' AND "|| "xrec001 = '"||g_xrec_d[g_detail_idx2].xrec001 ||"' AND "|| "xrec002 = '"||g_xrec_d[g_detail_idx2].xrec002 ||"' AND "|| "xrec003 = '"||g_xrec_d[g_detail_idx2].xrec003 ||"' AND "|| "xrec004 = '"||g_xrec_d[g_detail_idx2].xrec004 ||"' AND "|| "xrec005 = '"||g_xrec_d[g_detail_idx2].xrec005 ||"' AND "|| "xrec006 = '"||g_xrec_d[g_detail_idx2].xrec006 ||"' AND "|| "xrec012 = '"||g_xrec_d[g_detail_idx2].xrec012 ||"' AND "|| "xrec100 = '"||g_xrec_d[g_detail_idx2].xrec100 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page1.xrec012" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xrec_d[g_detail_idx2].xrecld IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec001 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec002 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec003 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec004 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec005 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec006 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec012 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec100 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrecld IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec001 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec002 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec003 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec004 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec005 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec006 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec012 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec100 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xrec_d[g_detail_idx2].xrecld != g_xrec_d_t.xrecld OR g_xrec_d[g_detail_idx2].xrec001 != g_xrec_d_t.xrec001 OR g_xrec_d[g_detail_idx2].xrec002 != g_xrec_d_t.xrec002 OR g_xrec_d[g_detail_idx2].xrec003 != g_xrec_d_t.xrec003 OR g_xrec_d[g_detail_idx2].xrec004 != g_xrec_d_t.xrec004 OR g_xrec_d[g_detail_idx2].xrec005 != g_xrec_d_t.xrec005 OR g_xrec_d[g_detail_idx2].xrec006 != g_xrec_d_t.xrec006 OR g_xrec_d[g_detail_idx2].xrec012 != g_xrec_d_t.xrec012 OR g_xrec_d[g_detail_idx2].xrec100 != g_xrec_d_t.xrec100)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xrec_t WHERE "||"xrecent = '" ||g_enterprise|| "' AND "||"xrecld = '"||g_xrec_d[g_detail_idx2].xrecld ||"' AND "|| "xrec001 = '"||g_xrec_d[g_detail_idx2].xrec001 ||"' AND "|| "xrec002 = '"||g_xrec_d[g_detail_idx2].xrec002 ||"' AND "|| "xrec003 = '"||g_xrec_d[g_detail_idx2].xrec003 ||"' AND "|| "xrec004 = '"||g_xrec_d[g_detail_idx2].xrec004 ||"' AND "|| "xrec005 = '"||g_xrec_d[g_detail_idx2].xrec005 ||"' AND "|| "xrec006 = '"||g_xrec_d[g_detail_idx2].xrec006 ||"' AND "|| "xrec012 = '"||g_xrec_d[g_detail_idx2].xrec012 ||"' AND "|| "xrec100 = '"||g_xrec_d[g_detail_idx2].xrec100 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page1.xrec100" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xrec_d[g_detail_idx2].xrecld IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec001 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec002 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec003 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec004 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec005 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec006 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec012 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec100 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrecld IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec001 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec002 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec003 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec004 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec005 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec006 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec012 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec100 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xrec_d[g_detail_idx2].xrecld != g_xrec_d_t.xrecld OR g_xrec_d[g_detail_idx2].xrec001 != g_xrec_d_t.xrec001 OR g_xrec_d[g_detail_idx2].xrec002 != g_xrec_d_t.xrec002 OR g_xrec_d[g_detail_idx2].xrec003 != g_xrec_d_t.xrec003 OR g_xrec_d[g_detail_idx2].xrec004 != g_xrec_d_t.xrec004 OR g_xrec_d[g_detail_idx2].xrec005 != g_xrec_d_t.xrec005 OR g_xrec_d[g_detail_idx2].xrec006 != g_xrec_d_t.xrec006 OR g_xrec_d[g_detail_idx2].xrec012 != g_xrec_d_t.xrec012 OR g_xrec_d[g_detail_idx2].xrec100 != g_xrec_d_t.xrec100)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xrec_t WHERE "||"xrecent = '" ||g_enterprise|| "' AND "||"xrecld = '"||g_xrec_d[g_detail_idx2].xrecld ||"' AND "|| "xrec001 = '"||g_xrec_d[g_detail_idx2].xrec001 ||"' AND "|| "xrec002 = '"||g_xrec_d[g_detail_idx2].xrec002 ||"' AND "|| "xrec003 = '"||g_xrec_d[g_detail_idx2].xrec003 ||"' AND "|| "xrec004 = '"||g_xrec_d[g_detail_idx2].xrec004 ||"' AND "|| "xrec005 = '"||g_xrec_d[g_detail_idx2].xrec005 ||"' AND "|| "xrec006 = '"||g_xrec_d[g_detail_idx2].xrec006 ||"' AND "|| "xrec012 = '"||g_xrec_d[g_detail_idx2].xrec012 ||"' AND "|| "xrec100 = '"||g_xrec_d[g_detail_idx2].xrec100 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page1.xrecld" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xrec_d[g_detail_idx2].xrecld IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec001 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec002 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec003 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec004 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec005 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec006 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec012 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec100 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrecld IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec001 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec002 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec003 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec004 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec005 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec006 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec012 IS NOT NULL AND g_xrec_d[g_detail_idx2].xrec100 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xrec_d[g_detail_idx2].xrecld != g_xrec_d_t.xrecld OR g_xrec_d[g_detail_idx2].xrec001 != g_xrec_d_t.xrec001 OR g_xrec_d[g_detail_idx2].xrec002 != g_xrec_d_t.xrec002 OR g_xrec_d[g_detail_idx2].xrec003 != g_xrec_d_t.xrec003 OR g_xrec_d[g_detail_idx2].xrec004 != g_xrec_d_t.xrec004 OR g_xrec_d[g_detail_idx2].xrec005 != g_xrec_d_t.xrec005 OR g_xrec_d[g_detail_idx2].xrec006 != g_xrec_d_t.xrec006 OR g_xrec_d[g_detail_idx2].xrec012 != g_xrec_d_t.xrec012 OR g_xrec_d[g_detail_idx2].xrec100 != g_xrec_d_t.xrec100)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xrec_t WHERE "||"xrecent = '" ||g_enterprise|| "' AND "||"xrecld = '"||g_xrec_d[g_detail_idx2].xrecld ||"' AND "|| "xrec001 = '"||g_xrec_d[g_detail_idx2].xrec001 ||"' AND "|| "xrec002 = '"||g_xrec_d[g_detail_idx2].xrec002 ||"' AND "|| "xrec003 = '"||g_xrec_d[g_detail_idx2].xrec003 ||"' AND "|| "xrec004 = '"||g_xrec_d[g_detail_idx2].xrec004 ||"' AND "|| "xrec005 = '"||g_xrec_d[g_detail_idx2].xrec005 ||"' AND "|| "xrec006 = '"||g_xrec_d[g_detail_idx2].xrec006 ||"' AND "|| "xrec012 = '"||g_xrec_d[g_detail_idx2].xrec012 ||"' AND "|| "xrec100 = '"||g_xrec_d[g_detail_idx2].xrec100 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page2.xreb001" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  .xrecld IS NOT NULL AND .xrec001 IS NOT NULL AND .xrec002 IS NOT NULL AND .xrec003 IS NOT NULL AND .xrec004 IS NOT NULL AND .xrec005 IS NOT NULL AND .xrec006 IS NOT NULL AND .xrec012 IS NOT NULL AND .xrec100 IS NOT NULL AND g_xrec2_d[g_detail_idx].xrebld IS NOT NULL AND g_xrec2_d[g_detail_idx].xreb001 IS NOT NULL AND g_xrec2_d[g_detail_idx].xreb002 IS NOT NULL AND g_xrec2_d[g_detail_idx].xreb005 IS NOT NULL AND g_xrec2_d[g_detail_idx].xreb006 IS NOT NULL AND g_xrec2_d[g_detail_idx].xreb007 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (.xrecld != g_xrecld_t OR .xrec001 != g_xrec001_t OR .xrec002 != g_xrec002_t OR .xrec003 != g_xrec003_t OR .xrec004 != g_xrec004_t OR .xrec005 != g_xrec005_t OR .xrec006 != g_xrec006_t OR .xrec012 != g_xrec012_t OR .xrec100 != g_xrec100_t OR g_xrec2_d[g_detail_idx].xrebld != g_xrec2_d_t.xrebld OR g_xrec2_d[g_detail_idx].xreb001 != g_xrec2_d_t.xreb001 OR g_xrec2_d[g_detail_idx].xreb002 != g_xrec2_d_t.xreb002 OR g_xrec2_d[g_detail_idx].xreb005 != g_xrec2_d_t.xreb005 OR g_xrec2_d[g_detail_idx].xreb006 != g_xrec2_d_t.xreb006 OR g_xrec2_d[g_detail_idx].xreb007 != g_xrec2_d_t.xreb007)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xreb_t WHERE "||"xrebent = '" ||g_enterprise|| "' AND "||"xrebld = '"||.xrecld ||"' AND "|| "xreb001 = '"||.xrec001 ||"' AND "|| "xreb002 = '"||.xrec002 ||"' AND "|| "xreb005 = '"||.xrec003 ||"' AND "|| "xreb006 = '"||.xrec004 ||"' AND "|| "xreb007 = '"||.xrec005 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page2.xreb001_2" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xreb2_d[g_detail_idx].xrebld IS NOT NULL AND g_xreb2_d[g_detail_idx].xreb001 IS NOT NULL AND g_xreb2_d[g_detail_idx].xreb002 IS NOT NULL AND g_xreb2_d[g_detail_idx].xreb005 IS NOT NULL AND g_xreb2_d[g_detail_idx].xreb006 IS NOT NULL AND g_xreb2_d[g_detail_idx].xreb007 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xreb2_d[g_detail_idx].xrebld != g_xreb2_d_t.xrebld OR g_xreb2_d[g_detail_idx].xreb001 != g_xreb2_d_t.xreb001 OR g_xreb2_d[g_detail_idx].xreb002 != g_xreb2_d_t.xreb002 OR g_xreb2_d[g_detail_idx].xreb005 != g_xreb2_d_t.xreb005 OR g_xreb2_d[g_detail_idx].xreb006 != g_xreb2_d_t.xreb006 OR g_xreb2_d[g_detail_idx].xreb007 != g_xreb2_d_t.xreb007)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xreb_t WHERE "||"xrebent = '" ||g_enterprise|| "' AND "||"xrebld = '"||g_xreb2_d[g_detail_idx].xrebld ||"' AND "|| "xreb001 = '"||g_xreb2_d[g_detail_idx].xreb001 ||"' AND "|| "xreb002 = '"||g_xreb2_d[g_detail_idx].xreb002 ||"' AND "|| "xreb005 = '"||g_xreb2_d[g_detail_idx].xreb005 ||"' AND "|| "xreb006 = '"||g_xreb2_d[g_detail_idx].xreb006 ||"' AND "|| "xreb007 = '"||g_xreb2_d[g_detail_idx].xreb007 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page2.xreb002" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  .xrecld IS NOT NULL AND .xrec001 IS NOT NULL AND .xrec002 IS NOT NULL AND .xrec003 IS NOT NULL AND .xrec004 IS NOT NULL AND .xrec005 IS NOT NULL AND .xrec006 IS NOT NULL AND .xrec012 IS NOT NULL AND .xrec100 IS NOT NULL AND g_xrec2_d[g_detail_idx].xrebld IS NOT NULL AND g_xrec2_d[g_detail_idx].xreb001 IS NOT NULL AND g_xrec2_d[g_detail_idx].xreb002 IS NOT NULL AND g_xrec2_d[g_detail_idx].xreb005 IS NOT NULL AND g_xrec2_d[g_detail_idx].xreb006 IS NOT NULL AND g_xrec2_d[g_detail_idx].xreb007 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (.xrecld != g_xrecld_t OR .xrec001 != g_xrec001_t OR .xrec002 != g_xrec002_t OR .xrec003 != g_xrec003_t OR .xrec004 != g_xrec004_t OR .xrec005 != g_xrec005_t OR .xrec006 != g_xrec006_t OR .xrec012 != g_xrec012_t OR .xrec100 != g_xrec100_t OR g_xrec2_d[g_detail_idx].xrebld != g_xrec2_d_t.xrebld OR g_xrec2_d[g_detail_idx].xreb001 != g_xrec2_d_t.xreb001 OR g_xrec2_d[g_detail_idx].xreb002 != g_xrec2_d_t.xreb002 OR g_xrec2_d[g_detail_idx].xreb005 != g_xrec2_d_t.xreb005 OR g_xrec2_d[g_detail_idx].xreb006 != g_xrec2_d_t.xreb006 OR g_xrec2_d[g_detail_idx].xreb007 != g_xrec2_d_t.xreb007)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xreb_t WHERE "||"xrebent = '" ||g_enterprise|| "' AND "||"xrebld = '"||.xrecld ||"' AND "|| "xreb001 = '"||.xrec001 ||"' AND "|| "xreb002 = '"||.xrec002 ||"' AND "|| "xreb005 = '"||.xrec003 ||"' AND "|| "xreb006 = '"||.xrec004 ||"' AND "|| "xreb007 = '"||.xrec005 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page2.xreb002_2" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xreb2_d[g_detail_idx].xrebld IS NOT NULL AND g_xreb2_d[g_detail_idx].xreb001 IS NOT NULL AND g_xreb2_d[g_detail_idx].xreb002 IS NOT NULL AND g_xreb2_d[g_detail_idx].xreb005 IS NOT NULL AND g_xreb2_d[g_detail_idx].xreb006 IS NOT NULL AND g_xreb2_d[g_detail_idx].xreb007 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xreb2_d[g_detail_idx].xrebld != g_xreb2_d_t.xrebld OR g_xreb2_d[g_detail_idx].xreb001 != g_xreb2_d_t.xreb001 OR g_xreb2_d[g_detail_idx].xreb002 != g_xreb2_d_t.xreb002 OR g_xreb2_d[g_detail_idx].xreb005 != g_xreb2_d_t.xreb005 OR g_xreb2_d[g_detail_idx].xreb006 != g_xreb2_d_t.xreb006 OR g_xreb2_d[g_detail_idx].xreb007 != g_xreb2_d_t.xreb007)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xreb_t WHERE "||"xrebent = '" ||g_enterprise|| "' AND "||"xrebld = '"||g_xreb2_d[g_detail_idx].xrebld ||"' AND "|| "xreb001 = '"||g_xreb2_d[g_detail_idx].xreb001 ||"' AND "|| "xreb002 = '"||g_xreb2_d[g_detail_idx].xreb002 ||"' AND "|| "xreb005 = '"||g_xreb2_d[g_detail_idx].xreb005 ||"' AND "|| "xreb006 = '"||g_xreb2_d[g_detail_idx].xreb006 ||"' AND "|| "xreb007 = '"||g_xreb2_d[g_detail_idx].xreb007 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page2.xreb005" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  .xrecld IS NOT NULL AND .xrec001 IS NOT NULL AND .xrec002 IS NOT NULL AND .xrec003 IS NOT NULL AND .xrec004 IS NOT NULL AND .xrec005 IS NOT NULL AND .xrec006 IS NOT NULL AND .xrec012 IS NOT NULL AND .xrec100 IS NOT NULL AND g_xrec2_d[g_detail_idx].xrebld IS NOT NULL AND g_xrec2_d[g_detail_idx].xreb001 IS NOT NULL AND g_xrec2_d[g_detail_idx].xreb002 IS NOT NULL AND g_xrec2_d[g_detail_idx].xreb005 IS NOT NULL AND g_xrec2_d[g_detail_idx].xreb006 IS NOT NULL AND g_xrec2_d[g_detail_idx].xreb007 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (.xrecld != g_xrecld_t OR .xrec001 != g_xrec001_t OR .xrec002 != g_xrec002_t OR .xrec003 != g_xrec003_t OR .xrec004 != g_xrec004_t OR .xrec005 != g_xrec005_t OR .xrec006 != g_xrec006_t OR .xrec012 != g_xrec012_t OR .xrec100 != g_xrec100_t OR g_xrec2_d[g_detail_idx].xrebld != g_xrec2_d_t.xrebld OR g_xrec2_d[g_detail_idx].xreb001 != g_xrec2_d_t.xreb001 OR g_xrec2_d[g_detail_idx].xreb002 != g_xrec2_d_t.xreb002 OR g_xrec2_d[g_detail_idx].xreb005 != g_xrec2_d_t.xreb005 OR g_xrec2_d[g_detail_idx].xreb006 != g_xrec2_d_t.xreb006 OR g_xrec2_d[g_detail_idx].xreb007 != g_xrec2_d_t.xreb007)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xreb_t WHERE "||"xrebent = '" ||g_enterprise|| "' AND "||"xrebld = '"||.xrecld ||"' AND "|| "xreb001 = '"||.xrec001 ||"' AND "|| "xreb002 = '"||.xrec002 ||"' AND "|| "xreb005 = '"||.xrec003 ||"' AND "|| "xreb006 = '"||.xrec004 ||"' AND "|| "xreb007 = '"||.xrec005 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page2.xreb005_2" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xreb2_d[g_detail_idx].xrebld IS NOT NULL AND g_xreb2_d[g_detail_idx].xreb001 IS NOT NULL AND g_xreb2_d[g_detail_idx].xreb002 IS NOT NULL AND g_xreb2_d[g_detail_idx].xreb005 IS NOT NULL AND g_xreb2_d[g_detail_idx].xreb006 IS NOT NULL AND g_xreb2_d[g_detail_idx].xreb007 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xreb2_d[g_detail_idx].xrebld != g_xreb2_d_t.xrebld OR g_xreb2_d[g_detail_idx].xreb001 != g_xreb2_d_t.xreb001 OR g_xreb2_d[g_detail_idx].xreb002 != g_xreb2_d_t.xreb002 OR g_xreb2_d[g_detail_idx].xreb005 != g_xreb2_d_t.xreb005 OR g_xreb2_d[g_detail_idx].xreb006 != g_xreb2_d_t.xreb006 OR g_xreb2_d[g_detail_idx].xreb007 != g_xreb2_d_t.xreb007)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xreb_t WHERE "||"xrebent = '" ||g_enterprise|| "' AND "||"xrebld = '"||g_xreb2_d[g_detail_idx].xrebld ||"' AND "|| "xreb001 = '"||g_xreb2_d[g_detail_idx].xreb001 ||"' AND "|| "xreb002 = '"||g_xreb2_d[g_detail_idx].xreb002 ||"' AND "|| "xreb005 = '"||g_xreb2_d[g_detail_idx].xreb005 ||"' AND "|| "xreb006 = '"||g_xreb2_d[g_detail_idx].xreb006 ||"' AND "|| "xreb007 = '"||g_xreb2_d[g_detail_idx].xreb007 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page2.xreb006" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  .xrecld IS NOT NULL AND .xrec001 IS NOT NULL AND .xrec002 IS NOT NULL AND .xrec003 IS NOT NULL AND .xrec004 IS NOT NULL AND .xrec005 IS NOT NULL AND .xrec006 IS NOT NULL AND .xrec012 IS NOT NULL AND .xrec100 IS NOT NULL AND g_xrec2_d[g_detail_idx].xrebld IS NOT NULL AND g_xrec2_d[g_detail_idx].xreb001 IS NOT NULL AND g_xrec2_d[g_detail_idx].xreb002 IS NOT NULL AND g_xrec2_d[g_detail_idx].xreb005 IS NOT NULL AND g_xrec2_d[g_detail_idx].xreb006 IS NOT NULL AND g_xrec2_d[g_detail_idx].xreb007 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (.xrecld != g_xrecld_t OR .xrec001 != g_xrec001_t OR .xrec002 != g_xrec002_t OR .xrec003 != g_xrec003_t OR .xrec004 != g_xrec004_t OR .xrec005 != g_xrec005_t OR .xrec006 != g_xrec006_t OR .xrec012 != g_xrec012_t OR .xrec100 != g_xrec100_t OR g_xrec2_d[g_detail_idx].xrebld != g_xrec2_d_t.xrebld OR g_xrec2_d[g_detail_idx].xreb001 != g_xrec2_d_t.xreb001 OR g_xrec2_d[g_detail_idx].xreb002 != g_xrec2_d_t.xreb002 OR g_xrec2_d[g_detail_idx].xreb005 != g_xrec2_d_t.xreb005 OR g_xrec2_d[g_detail_idx].xreb006 != g_xrec2_d_t.xreb006 OR g_xrec2_d[g_detail_idx].xreb007 != g_xrec2_d_t.xreb007)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xreb_t WHERE "||"xrebent = '" ||g_enterprise|| "' AND "||"xrebld = '"||.xrecld ||"' AND "|| "xreb001 = '"||.xrec001 ||"' AND "|| "xreb002 = '"||.xrec002 ||"' AND "|| "xreb005 = '"||.xrec003 ||"' AND "|| "xreb006 = '"||.xrec004 ||"' AND "|| "xreb007 = '"||.xrec005 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page2.xreb006_2" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xreb2_d[g_detail_idx].xrebld IS NOT NULL AND g_xreb2_d[g_detail_idx].xreb001 IS NOT NULL AND g_xreb2_d[g_detail_idx].xreb002 IS NOT NULL AND g_xreb2_d[g_detail_idx].xreb005 IS NOT NULL AND g_xreb2_d[g_detail_idx].xreb006 IS NOT NULL AND g_xreb2_d[g_detail_idx].xreb007 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xreb2_d[g_detail_idx].xrebld != g_xreb2_d_t.xrebld OR g_xreb2_d[g_detail_idx].xreb001 != g_xreb2_d_t.xreb001 OR g_xreb2_d[g_detail_idx].xreb002 != g_xreb2_d_t.xreb002 OR g_xreb2_d[g_detail_idx].xreb005 != g_xreb2_d_t.xreb005 OR g_xreb2_d[g_detail_idx].xreb006 != g_xreb2_d_t.xreb006 OR g_xreb2_d[g_detail_idx].xreb007 != g_xreb2_d_t.xreb007)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xreb_t WHERE "||"xrebent = '" ||g_enterprise|| "' AND "||"xrebld = '"||g_xreb2_d[g_detail_idx].xrebld ||"' AND "|| "xreb001 = '"||g_xreb2_d[g_detail_idx].xreb001 ||"' AND "|| "xreb002 = '"||g_xreb2_d[g_detail_idx].xreb002 ||"' AND "|| "xreb005 = '"||g_xreb2_d[g_detail_idx].xreb005 ||"' AND "|| "xreb006 = '"||g_xreb2_d[g_detail_idx].xreb006 ||"' AND "|| "xreb007 = '"||g_xreb2_d[g_detail_idx].xreb007 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page2.xreb007" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  .xrecld IS NOT NULL AND .xrec001 IS NOT NULL AND .xrec002 IS NOT NULL AND .xrec003 IS NOT NULL AND .xrec004 IS NOT NULL AND .xrec005 IS NOT NULL AND .xrec006 IS NOT NULL AND .xrec012 IS NOT NULL AND .xrec100 IS NOT NULL AND g_xrec2_d[g_detail_idx].xrebld IS NOT NULL AND g_xrec2_d[g_detail_idx].xreb001 IS NOT NULL AND g_xrec2_d[g_detail_idx].xreb002 IS NOT NULL AND g_xrec2_d[g_detail_idx].xreb005 IS NOT NULL AND g_xrec2_d[g_detail_idx].xreb006 IS NOT NULL AND g_xrec2_d[g_detail_idx].xreb007 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (.xrecld != g_xrecld_t OR .xrec001 != g_xrec001_t OR .xrec002 != g_xrec002_t OR .xrec003 != g_xrec003_t OR .xrec004 != g_xrec004_t OR .xrec005 != g_xrec005_t OR .xrec006 != g_xrec006_t OR .xrec012 != g_xrec012_t OR .xrec100 != g_xrec100_t OR g_xrec2_d[g_detail_idx].xrebld != g_xrec2_d_t.xrebld OR g_xrec2_d[g_detail_idx].xreb001 != g_xrec2_d_t.xreb001 OR g_xrec2_d[g_detail_idx].xreb002 != g_xrec2_d_t.xreb002 OR g_xrec2_d[g_detail_idx].xreb005 != g_xrec2_d_t.xreb005 OR g_xrec2_d[g_detail_idx].xreb006 != g_xrec2_d_t.xreb006 OR g_xrec2_d[g_detail_idx].xreb007 != g_xrec2_d_t.xreb007)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xreb_t WHERE "||"xrebent = '" ||g_enterprise|| "' AND "||"xrebld = '"||.xrecld ||"' AND "|| "xreb001 = '"||.xrec001 ||"' AND "|| "xreb002 = '"||.xrec002 ||"' AND "|| "xreb005 = '"||.xrec003 ||"' AND "|| "xreb006 = '"||.xrec004 ||"' AND "|| "xreb007 = '"||.xrec005 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page2.xreb007_2" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xreb2_d[g_detail_idx].xrebld IS NOT NULL AND g_xreb2_d[g_detail_idx].xreb001 IS NOT NULL AND g_xreb2_d[g_detail_idx].xreb002 IS NOT NULL AND g_xreb2_d[g_detail_idx].xreb005 IS NOT NULL AND g_xreb2_d[g_detail_idx].xreb006 IS NOT NULL AND g_xreb2_d[g_detail_idx].xreb007 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xreb2_d[g_detail_idx].xrebld != g_xreb2_d_t.xrebld OR g_xreb2_d[g_detail_idx].xreb001 != g_xreb2_d_t.xreb001 OR g_xreb2_d[g_detail_idx].xreb002 != g_xreb2_d_t.xreb002 OR g_xreb2_d[g_detail_idx].xreb005 != g_xreb2_d_t.xreb005 OR g_xreb2_d[g_detail_idx].xreb006 != g_xreb2_d_t.xreb006 OR g_xreb2_d[g_detail_idx].xreb007 != g_xreb2_d_t.xreb007)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xreb_t WHERE "||"xrebent = '" ||g_enterprise|| "' AND "||"xrebld = '"||g_xreb2_d[g_detail_idx].xrebld ||"' AND "|| "xreb001 = '"||g_xreb2_d[g_detail_idx].xreb001 ||"' AND "|| "xreb002 = '"||g_xreb2_d[g_detail_idx].xreb002 ||"' AND "|| "xreb005 = '"||g_xreb2_d[g_detail_idx].xreb005 ||"' AND "|| "xreb006 = '"||g_xreb2_d[g_detail_idx].xreb006 ||"' AND "|| "xreb007 = '"||g_xreb2_d[g_detail_idx].xreb007 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page2.xrebld" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  .xrecld IS NOT NULL AND .xrec001 IS NOT NULL AND .xrec002 IS NOT NULL AND .xrec003 IS NOT NULL AND .xrec004 IS NOT NULL AND .xrec005 IS NOT NULL AND .xrec006 IS NOT NULL AND .xrec012 IS NOT NULL AND .xrec100 IS NOT NULL AND g_xrec2_d[g_detail_idx].xrebld IS NOT NULL AND g_xrec2_d[g_detail_idx].xreb001 IS NOT NULL AND g_xrec2_d[g_detail_idx].xreb002 IS NOT NULL AND g_xrec2_d[g_detail_idx].xreb005 IS NOT NULL AND g_xrec2_d[g_detail_idx].xreb006 IS NOT NULL AND g_xrec2_d[g_detail_idx].xreb007 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (.xrecld != g_xrecld_t OR .xrec001 != g_xrec001_t OR .xrec002 != g_xrec002_t OR .xrec003 != g_xrec003_t OR .xrec004 != g_xrec004_t OR .xrec005 != g_xrec005_t OR .xrec006 != g_xrec006_t OR .xrec012 != g_xrec012_t OR .xrec100 != g_xrec100_t OR g_xrec2_d[g_detail_idx].xrebld != g_xrec2_d_t.xrebld OR g_xrec2_d[g_detail_idx].xreb001 != g_xrec2_d_t.xreb001 OR g_xrec2_d[g_detail_idx].xreb002 != g_xrec2_d_t.xreb002 OR g_xrec2_d[g_detail_idx].xreb005 != g_xrec2_d_t.xreb005 OR g_xrec2_d[g_detail_idx].xreb006 != g_xrec2_d_t.xreb006 OR g_xrec2_d[g_detail_idx].xreb007 != g_xrec2_d_t.xreb007)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xreb_t WHERE "||"xrebent = '" ||g_enterprise|| "' AND "||"xrebld = '"||.xrecld ||"' AND "|| "xreb001 = '"||.xrec001 ||"' AND "|| "xreb002 = '"||.xrec002 ||"' AND "|| "xreb005 = '"||.xrec003 ||"' AND "|| "xreb006 = '"||.xrec004 ||"' AND "|| "xreb007 = '"||.xrec005 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page2.xrebld_2" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xreb2_d[g_detail_idx].xrebld IS NOT NULL AND g_xreb2_d[g_detail_idx].xreb001 IS NOT NULL AND g_xreb2_d[g_detail_idx].xreb002 IS NOT NULL AND g_xreb2_d[g_detail_idx].xreb005 IS NOT NULL AND g_xreb2_d[g_detail_idx].xreb006 IS NOT NULL AND g_xreb2_d[g_detail_idx].xreb007 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xreb2_d[g_detail_idx].xrebld != g_xreb2_d_t.xrebld OR g_xreb2_d[g_detail_idx].xreb001 != g_xreb2_d_t.xreb001 OR g_xreb2_d[g_detail_idx].xreb002 != g_xreb2_d_t.xreb002 OR g_xreb2_d[g_detail_idx].xreb005 != g_xreb2_d_t.xreb005 OR g_xreb2_d[g_detail_idx].xreb006 != g_xreb2_d_t.xreb006 OR g_xreb2_d[g_detail_idx].xreb007 != g_xreb2_d_t.xreb007)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xreb_t WHERE "||"xrebent = '" ||g_enterprise|| "' AND "||"xrebld = '"||g_xreb2_d[g_detail_idx].xrebld ||"' AND "|| "xreb001 = '"||g_xreb2_d[g_detail_idx].xreb001 ||"' AND "|| "xreb002 = '"||g_xreb2_d[g_detail_idx].xreb002 ||"' AND "|| "xreb005 = '"||g_xreb2_d[g_detail_idx].xreb005 ||"' AND "|| "xreb006 = '"||g_xreb2_d[g_detail_idx].xreb006 ||"' AND "|| "xreb007 = '"||g_xreb2_d[g_detail_idx].xreb007 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page3.xreb001_2" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  .xrecld IS NOT NULL AND .xrec001 IS NOT NULL AND .xrec002 IS NOT NULL AND .xrec003 IS NOT NULL AND .xrec004 IS NOT NULL AND .xrec005 IS NOT NULL AND .xrec006 IS NOT NULL AND .xrec012 IS NOT NULL AND .xrec100 IS NOT NULL AND g_xreb3_d[g_detail_idx].xrebld IS NOT NULL AND g_xreb3_d[g_detail_idx].xreb001 IS NOT NULL AND g_xreb3_d[g_detail_idx].xreb002 IS NOT NULL AND g_xreb3_d[g_detail_idx].xreb005 IS NOT NULL AND g_xreb3_d[g_detail_idx].xreb006 IS NOT NULL AND g_xreb3_d[g_detail_idx].xreb007 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (.xrecld != g_xrecld_t OR .xrec001 != g_xrec001_t OR .xrec002 != g_xrec002_t OR .xrec003 != g_xrec003_t OR .xrec004 != g_xrec004_t OR .xrec005 != g_xrec005_t OR .xrec006 != g_xrec006_t OR .xrec012 != g_xrec012_t OR .xrec100 != g_xrec100_t OR g_xreb3_d[g_detail_idx].xrebld != g_xreb3_d_t.xrebld OR g_xreb3_d[g_detail_idx].xreb001 != g_xreb3_d_t.xreb001 OR g_xreb3_d[g_detail_idx].xreb002 != g_xreb3_d_t.xreb002 OR g_xreb3_d[g_detail_idx].xreb005 != g_xreb3_d_t.xreb005 OR g_xreb3_d[g_detail_idx].xreb006 != g_xreb3_d_t.xreb006 OR g_xreb3_d[g_detail_idx].xreb007 != g_xreb3_d_t.xreb007)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xreb_t WHERE "||"xrebent = '" ||g_enterprise|| "' AND "||"xrebld = '"||.xrecld ||"' AND "|| "xreb001 = '"||.xrec001 ||"' AND "|| "xreb002 = '"||.xrec002 ||"' AND "|| "xreb005 = '"||.xrec003 ||"' AND "|| "xreb006 = '"||.xrec004 ||"' AND "|| "xreb007 = '"||.xrec005 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page3.xreb001_3" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xreb3_d[g_detail_idx].xrebld IS NOT NULL AND g_xreb3_d[g_detail_idx].xreb001 IS NOT NULL AND g_xreb3_d[g_detail_idx].xreb002 IS NOT NULL AND g_xreb3_d[g_detail_idx].xreb005 IS NOT NULL AND g_xreb3_d[g_detail_idx].xreb006 IS NOT NULL AND g_xreb3_d[g_detail_idx].xreb007 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xreb3_d[g_detail_idx].xrebld != g_xreb3_d_t.xrebld OR g_xreb3_d[g_detail_idx].xreb001 != g_xreb3_d_t.xreb001 OR g_xreb3_d[g_detail_idx].xreb002 != g_xreb3_d_t.xreb002 OR g_xreb3_d[g_detail_idx].xreb005 != g_xreb3_d_t.xreb005 OR g_xreb3_d[g_detail_idx].xreb006 != g_xreb3_d_t.xreb006 OR g_xreb3_d[g_detail_idx].xreb007 != g_xreb3_d_t.xreb007)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xreb_t WHERE "||"xrebent = '" ||g_enterprise|| "' AND "||"xrebld = '"||g_xreb3_d[g_detail_idx].xrebld ||"' AND "|| "xreb001 = '"||g_xreb3_d[g_detail_idx].xreb001 ||"' AND "|| "xreb002 = '"||g_xreb3_d[g_detail_idx].xreb002 ||"' AND "|| "xreb005 = '"||g_xreb3_d[g_detail_idx].xreb005 ||"' AND "|| "xreb006 = '"||g_xreb3_d[g_detail_idx].xreb006 ||"' AND "|| "xreb007 = '"||g_xreb3_d[g_detail_idx].xreb007 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page3.xreb002_2" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  .xrecld IS NOT NULL AND .xrec001 IS NOT NULL AND .xrec002 IS NOT NULL AND .xrec003 IS NOT NULL AND .xrec004 IS NOT NULL AND .xrec005 IS NOT NULL AND .xrec006 IS NOT NULL AND .xrec012 IS NOT NULL AND .xrec100 IS NOT NULL AND g_xreb3_d[g_detail_idx].xrebld IS NOT NULL AND g_xreb3_d[g_detail_idx].xreb001 IS NOT NULL AND g_xreb3_d[g_detail_idx].xreb002 IS NOT NULL AND g_xreb3_d[g_detail_idx].xreb005 IS NOT NULL AND g_xreb3_d[g_detail_idx].xreb006 IS NOT NULL AND g_xreb3_d[g_detail_idx].xreb007 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (.xrecld != g_xrecld_t OR .xrec001 != g_xrec001_t OR .xrec002 != g_xrec002_t OR .xrec003 != g_xrec003_t OR .xrec004 != g_xrec004_t OR .xrec005 != g_xrec005_t OR .xrec006 != g_xrec006_t OR .xrec012 != g_xrec012_t OR .xrec100 != g_xrec100_t OR g_xreb3_d[g_detail_idx].xrebld != g_xreb3_d_t.xrebld OR g_xreb3_d[g_detail_idx].xreb001 != g_xreb3_d_t.xreb001 OR g_xreb3_d[g_detail_idx].xreb002 != g_xreb3_d_t.xreb002 OR g_xreb3_d[g_detail_idx].xreb005 != g_xreb3_d_t.xreb005 OR g_xreb3_d[g_detail_idx].xreb006 != g_xreb3_d_t.xreb006 OR g_xreb3_d[g_detail_idx].xreb007 != g_xreb3_d_t.xreb007)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xreb_t WHERE "||"xrebent = '" ||g_enterprise|| "' AND "||"xrebld = '"||.xrecld ||"' AND "|| "xreb001 = '"||.xrec001 ||"' AND "|| "xreb002 = '"||.xrec002 ||"' AND "|| "xreb005 = '"||.xrec003 ||"' AND "|| "xreb006 = '"||.xrec004 ||"' AND "|| "xreb007 = '"||.xrec005 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page3.xreb002_3" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xreb3_d[g_detail_idx].xrebld IS NOT NULL AND g_xreb3_d[g_detail_idx].xreb001 IS NOT NULL AND g_xreb3_d[g_detail_idx].xreb002 IS NOT NULL AND g_xreb3_d[g_detail_idx].xreb005 IS NOT NULL AND g_xreb3_d[g_detail_idx].xreb006 IS NOT NULL AND g_xreb3_d[g_detail_idx].xreb007 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xreb3_d[g_detail_idx].xrebld != g_xreb3_d_t.xrebld OR g_xreb3_d[g_detail_idx].xreb001 != g_xreb3_d_t.xreb001 OR g_xreb3_d[g_detail_idx].xreb002 != g_xreb3_d_t.xreb002 OR g_xreb3_d[g_detail_idx].xreb005 != g_xreb3_d_t.xreb005 OR g_xreb3_d[g_detail_idx].xreb006 != g_xreb3_d_t.xreb006 OR g_xreb3_d[g_detail_idx].xreb007 != g_xreb3_d_t.xreb007)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xreb_t WHERE "||"xrebent = '" ||g_enterprise|| "' AND "||"xrebld = '"||g_xreb3_d[g_detail_idx].xrebld ||"' AND "|| "xreb001 = '"||g_xreb3_d[g_detail_idx].xreb001 ||"' AND "|| "xreb002 = '"||g_xreb3_d[g_detail_idx].xreb002 ||"' AND "|| "xreb005 = '"||g_xreb3_d[g_detail_idx].xreb005 ||"' AND "|| "xreb006 = '"||g_xreb3_d[g_detail_idx].xreb006 ||"' AND "|| "xreb007 = '"||g_xreb3_d[g_detail_idx].xreb007 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page3.xreb005_2" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  .xrecld IS NOT NULL AND .xrec001 IS NOT NULL AND .xrec002 IS NOT NULL AND .xrec003 IS NOT NULL AND .xrec004 IS NOT NULL AND .xrec005 IS NOT NULL AND .xrec006 IS NOT NULL AND .xrec012 IS NOT NULL AND .xrec100 IS NOT NULL AND g_xreb3_d[g_detail_idx].xrebld IS NOT NULL AND g_xreb3_d[g_detail_idx].xreb001 IS NOT NULL AND g_xreb3_d[g_detail_idx].xreb002 IS NOT NULL AND g_xreb3_d[g_detail_idx].xreb005 IS NOT NULL AND g_xreb3_d[g_detail_idx].xreb006 IS NOT NULL AND g_xreb3_d[g_detail_idx].xreb007 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (.xrecld != g_xrecld_t OR .xrec001 != g_xrec001_t OR .xrec002 != g_xrec002_t OR .xrec003 != g_xrec003_t OR .xrec004 != g_xrec004_t OR .xrec005 != g_xrec005_t OR .xrec006 != g_xrec006_t OR .xrec012 != g_xrec012_t OR .xrec100 != g_xrec100_t OR g_xreb3_d[g_detail_idx].xrebld != g_xreb3_d_t.xrebld OR g_xreb3_d[g_detail_idx].xreb001 != g_xreb3_d_t.xreb001 OR g_xreb3_d[g_detail_idx].xreb002 != g_xreb3_d_t.xreb002 OR g_xreb3_d[g_detail_idx].xreb005 != g_xreb3_d_t.xreb005 OR g_xreb3_d[g_detail_idx].xreb006 != g_xreb3_d_t.xreb006 OR g_xreb3_d[g_detail_idx].xreb007 != g_xreb3_d_t.xreb007)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xreb_t WHERE "||"xrebent = '" ||g_enterprise|| "' AND "||"xrebld = '"||.xrecld ||"' AND "|| "xreb001 = '"||.xrec001 ||"' AND "|| "xreb002 = '"||.xrec002 ||"' AND "|| "xreb005 = '"||.xrec003 ||"' AND "|| "xreb006 = '"||.xrec004 ||"' AND "|| "xreb007 = '"||.xrec005 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page3.xreb005_3" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xreb3_d[g_detail_idx].xrebld IS NOT NULL AND g_xreb3_d[g_detail_idx].xreb001 IS NOT NULL AND g_xreb3_d[g_detail_idx].xreb002 IS NOT NULL AND g_xreb3_d[g_detail_idx].xreb005 IS NOT NULL AND g_xreb3_d[g_detail_idx].xreb006 IS NOT NULL AND g_xreb3_d[g_detail_idx].xreb007 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xreb3_d[g_detail_idx].xrebld != g_xreb3_d_t.xrebld OR g_xreb3_d[g_detail_idx].xreb001 != g_xreb3_d_t.xreb001 OR g_xreb3_d[g_detail_idx].xreb002 != g_xreb3_d_t.xreb002 OR g_xreb3_d[g_detail_idx].xreb005 != g_xreb3_d_t.xreb005 OR g_xreb3_d[g_detail_idx].xreb006 != g_xreb3_d_t.xreb006 OR g_xreb3_d[g_detail_idx].xreb007 != g_xreb3_d_t.xreb007)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xreb_t WHERE "||"xrebent = '" ||g_enterprise|| "' AND "||"xrebld = '"||g_xreb3_d[g_detail_idx].xrebld ||"' AND "|| "xreb001 = '"||g_xreb3_d[g_detail_idx].xreb001 ||"' AND "|| "xreb002 = '"||g_xreb3_d[g_detail_idx].xreb002 ||"' AND "|| "xreb005 = '"||g_xreb3_d[g_detail_idx].xreb005 ||"' AND "|| "xreb006 = '"||g_xreb3_d[g_detail_idx].xreb006 ||"' AND "|| "xreb007 = '"||g_xreb3_d[g_detail_idx].xreb007 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page3.xreb006_2" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  .xrecld IS NOT NULL AND .xrec001 IS NOT NULL AND .xrec002 IS NOT NULL AND .xrec003 IS NOT NULL AND .xrec004 IS NOT NULL AND .xrec005 IS NOT NULL AND .xrec006 IS NOT NULL AND .xrec012 IS NOT NULL AND .xrec100 IS NOT NULL AND g_xreb3_d[g_detail_idx].xrebld IS NOT NULL AND g_xreb3_d[g_detail_idx].xreb001 IS NOT NULL AND g_xreb3_d[g_detail_idx].xreb002 IS NOT NULL AND g_xreb3_d[g_detail_idx].xreb005 IS NOT NULL AND g_xreb3_d[g_detail_idx].xreb006 IS NOT NULL AND g_xreb3_d[g_detail_idx].xreb007 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (.xrecld != g_xrecld_t OR .xrec001 != g_xrec001_t OR .xrec002 != g_xrec002_t OR .xrec003 != g_xrec003_t OR .xrec004 != g_xrec004_t OR .xrec005 != g_xrec005_t OR .xrec006 != g_xrec006_t OR .xrec012 != g_xrec012_t OR .xrec100 != g_xrec100_t OR g_xreb3_d[g_detail_idx].xrebld != g_xreb3_d_t.xrebld OR g_xreb3_d[g_detail_idx].xreb001 != g_xreb3_d_t.xreb001 OR g_xreb3_d[g_detail_idx].xreb002 != g_xreb3_d_t.xreb002 OR g_xreb3_d[g_detail_idx].xreb005 != g_xreb3_d_t.xreb005 OR g_xreb3_d[g_detail_idx].xreb006 != g_xreb3_d_t.xreb006 OR g_xreb3_d[g_detail_idx].xreb007 != g_xreb3_d_t.xreb007)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xreb_t WHERE "||"xrebent = '" ||g_enterprise|| "' AND "||"xrebld = '"||.xrecld ||"' AND "|| "xreb001 = '"||.xrec001 ||"' AND "|| "xreb002 = '"||.xrec002 ||"' AND "|| "xreb005 = '"||.xrec003 ||"' AND "|| "xreb006 = '"||.xrec004 ||"' AND "|| "xreb007 = '"||.xrec005 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page3.xreb006_3" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xreb3_d[g_detail_idx].xrebld IS NOT NULL AND g_xreb3_d[g_detail_idx].xreb001 IS NOT NULL AND g_xreb3_d[g_detail_idx].xreb002 IS NOT NULL AND g_xreb3_d[g_detail_idx].xreb005 IS NOT NULL AND g_xreb3_d[g_detail_idx].xreb006 IS NOT NULL AND g_xreb3_d[g_detail_idx].xreb007 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xreb3_d[g_detail_idx].xrebld != g_xreb3_d_t.xrebld OR g_xreb3_d[g_detail_idx].xreb001 != g_xreb3_d_t.xreb001 OR g_xreb3_d[g_detail_idx].xreb002 != g_xreb3_d_t.xreb002 OR g_xreb3_d[g_detail_idx].xreb005 != g_xreb3_d_t.xreb005 OR g_xreb3_d[g_detail_idx].xreb006 != g_xreb3_d_t.xreb006 OR g_xreb3_d[g_detail_idx].xreb007 != g_xreb3_d_t.xreb007)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xreb_t WHERE "||"xrebent = '" ||g_enterprise|| "' AND "||"xrebld = '"||g_xreb3_d[g_detail_idx].xrebld ||"' AND "|| "xreb001 = '"||g_xreb3_d[g_detail_idx].xreb001 ||"' AND "|| "xreb002 = '"||g_xreb3_d[g_detail_idx].xreb002 ||"' AND "|| "xreb005 = '"||g_xreb3_d[g_detail_idx].xreb005 ||"' AND "|| "xreb006 = '"||g_xreb3_d[g_detail_idx].xreb006 ||"' AND "|| "xreb007 = '"||g_xreb3_d[g_detail_idx].xreb007 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page3.xreb007_2" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  .xrecld IS NOT NULL AND .xrec001 IS NOT NULL AND .xrec002 IS NOT NULL AND .xrec003 IS NOT NULL AND .xrec004 IS NOT NULL AND .xrec005 IS NOT NULL AND .xrec006 IS NOT NULL AND .xrec012 IS NOT NULL AND .xrec100 IS NOT NULL AND g_xreb3_d[g_detail_idx].xrebld IS NOT NULL AND g_xreb3_d[g_detail_idx].xreb001 IS NOT NULL AND g_xreb3_d[g_detail_idx].xreb002 IS NOT NULL AND g_xreb3_d[g_detail_idx].xreb005 IS NOT NULL AND g_xreb3_d[g_detail_idx].xreb006 IS NOT NULL AND g_xreb3_d[g_detail_idx].xreb007 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (.xrecld != g_xrecld_t OR .xrec001 != g_xrec001_t OR .xrec002 != g_xrec002_t OR .xrec003 != g_xrec003_t OR .xrec004 != g_xrec004_t OR .xrec005 != g_xrec005_t OR .xrec006 != g_xrec006_t OR .xrec012 != g_xrec012_t OR .xrec100 != g_xrec100_t OR g_xreb3_d[g_detail_idx].xrebld != g_xreb3_d_t.xrebld OR g_xreb3_d[g_detail_idx].xreb001 != g_xreb3_d_t.xreb001 OR g_xreb3_d[g_detail_idx].xreb002 != g_xreb3_d_t.xreb002 OR g_xreb3_d[g_detail_idx].xreb005 != g_xreb3_d_t.xreb005 OR g_xreb3_d[g_detail_idx].xreb006 != g_xreb3_d_t.xreb006 OR g_xreb3_d[g_detail_idx].xreb007 != g_xreb3_d_t.xreb007)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xreb_t WHERE "||"xrebent = '" ||g_enterprise|| "' AND "||"xrebld = '"||.xrecld ||"' AND "|| "xreb001 = '"||.xrec001 ||"' AND "|| "xreb002 = '"||.xrec002 ||"' AND "|| "xreb005 = '"||.xrec003 ||"' AND "|| "xreb006 = '"||.xrec004 ||"' AND "|| "xreb007 = '"||.xrec005 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page3.xreb007_3" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xreb3_d[g_detail_idx].xrebld IS NOT NULL AND g_xreb3_d[g_detail_idx].xreb001 IS NOT NULL AND g_xreb3_d[g_detail_idx].xreb002 IS NOT NULL AND g_xreb3_d[g_detail_idx].xreb005 IS NOT NULL AND g_xreb3_d[g_detail_idx].xreb006 IS NOT NULL AND g_xreb3_d[g_detail_idx].xreb007 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xreb3_d[g_detail_idx].xrebld != g_xreb3_d_t.xrebld OR g_xreb3_d[g_detail_idx].xreb001 != g_xreb3_d_t.xreb001 OR g_xreb3_d[g_detail_idx].xreb002 != g_xreb3_d_t.xreb002 OR g_xreb3_d[g_detail_idx].xreb005 != g_xreb3_d_t.xreb005 OR g_xreb3_d[g_detail_idx].xreb006 != g_xreb3_d_t.xreb006 OR g_xreb3_d[g_detail_idx].xreb007 != g_xreb3_d_t.xreb007)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xreb_t WHERE "||"xrebent = '" ||g_enterprise|| "' AND "||"xrebld = '"||g_xreb3_d[g_detail_idx].xrebld ||"' AND "|| "xreb001 = '"||g_xreb3_d[g_detail_idx].xreb001 ||"' AND "|| "xreb002 = '"||g_xreb3_d[g_detail_idx].xreb002 ||"' AND "|| "xreb005 = '"||g_xreb3_d[g_detail_idx].xreb005 ||"' AND "|| "xreb006 = '"||g_xreb3_d[g_detail_idx].xreb006 ||"' AND "|| "xreb007 = '"||g_xreb3_d[g_detail_idx].xreb007 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page3.xrebld_2" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  .xrecld IS NOT NULL AND .xrec001 IS NOT NULL AND .xrec002 IS NOT NULL AND .xrec003 IS NOT NULL AND .xrec004 IS NOT NULL AND .xrec005 IS NOT NULL AND .xrec006 IS NOT NULL AND .xrec012 IS NOT NULL AND .xrec100 IS NOT NULL AND g_xreb3_d[g_detail_idx].xrebld IS NOT NULL AND g_xreb3_d[g_detail_idx].xreb001 IS NOT NULL AND g_xreb3_d[g_detail_idx].xreb002 IS NOT NULL AND g_xreb3_d[g_detail_idx].xreb005 IS NOT NULL AND g_xreb3_d[g_detail_idx].xreb006 IS NOT NULL AND g_xreb3_d[g_detail_idx].xreb007 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (.xrecld != g_xrecld_t OR .xrec001 != g_xrec001_t OR .xrec002 != g_xrec002_t OR .xrec003 != g_xrec003_t OR .xrec004 != g_xrec004_t OR .xrec005 != g_xrec005_t OR .xrec006 != g_xrec006_t OR .xrec012 != g_xrec012_t OR .xrec100 != g_xrec100_t OR g_xreb3_d[g_detail_idx].xrebld != g_xreb3_d_t.xrebld OR g_xreb3_d[g_detail_idx].xreb001 != g_xreb3_d_t.xreb001 OR g_xreb3_d[g_detail_idx].xreb002 != g_xreb3_d_t.xreb002 OR g_xreb3_d[g_detail_idx].xreb005 != g_xreb3_d_t.xreb005 OR g_xreb3_d[g_detail_idx].xreb006 != g_xreb3_d_t.xreb006 OR g_xreb3_d[g_detail_idx].xreb007 != g_xreb3_d_t.xreb007)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xreb_t WHERE "||"xrebent = '" ||g_enterprise|| "' AND "||"xrebld = '"||.xrecld ||"' AND "|| "xreb001 = '"||.xrec001 ||"' AND "|| "xreb002 = '"||.xrec002 ||"' AND "|| "xreb005 = '"||.xrec003 ||"' AND "|| "xreb006 = '"||.xrec004 ||"' AND "|| "xreb007 = '"||.xrec005 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page3.xrebld_3" order="" ver="1" cite_std="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xreb3_d[g_detail_idx].xrebld IS NOT NULL AND g_xreb3_d[g_detail_idx].xreb001 IS NOT NULL AND g_xreb3_d[g_detail_idx].xreb002 IS NOT NULL AND g_xreb3_d[g_detail_idx].xreb005 IS NOT NULL AND g_xreb3_d[g_detail_idx].xreb006 IS NOT NULL AND g_xreb3_d[g_detail_idx].xreb007 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xreb3_d[g_detail_idx].xrebld != g_xreb3_d_t.xrebld OR g_xreb3_d[g_detail_idx].xreb001 != g_xreb3_d_t.xreb001 OR g_xreb3_d[g_detail_idx].xreb002 != g_xreb3_d_t.xreb002 OR g_xreb3_d[g_detail_idx].xreb005 != g_xreb3_d_t.xreb005 OR g_xreb3_d[g_detail_idx].xreb006 != g_xreb3_d_t.xreb006 OR g_xreb3_d[g_detail_idx].xreb007 != g_xreb3_d_t.xreb007)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xreb_t WHERE "||"xrebent = '" ||g_enterprise|| "' AND "||"xrebld = '"||g_xreb3_d[g_detail_idx].xrebld ||"' AND "|| "xreb001 = '"||g_xreb3_d[g_detail_idx].xreb001 ||"' AND "|| "xreb002 = '"||g_xreb3_d[g_detail_idx].xreb002 ||"' AND "|| "xreb005 = '"||g_xreb3_d[g_detail_idx].xreb005 ||"' AND "|| "xreb006 = '"||g_xreb3_d[g_detail_idx].xreb006 ||"' AND "|| "xreb007 = '"||g_xreb3_d[g_detail_idx].xreb007 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="query.define" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[   CALL axrq920_query_1()
   RETURN]]>
  </point>
  <point name="ui_dialog.bef_dialog" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #上下筆按鈕顯示否設置
            IF g_header_cnt=1 THEN
               CALL cl_set_act_visible("first,previous,jump,next,last",FALSE) 
            ELSE
               IF g_current_idx=1 THEN
                  CALL cl_set_act_visible("first,previous", FALSE) 
                  CALL cl_set_act_visible("jump,next,last", TRUE) 
               ELSE
                  IF g_current_idx<>g_header_cnt THEN
                     CALL cl_set_act_visible("first,previous,jump,next,last",TRUE) 
                  ELSE
                     CALL cl_set_act_visible("first,previous,jump",TRUE) 
                     CALL cl_set_act_visible("next,last", FALSE) 
                  END IF
               END IF
            END IF
            CALL gfrm_curr.setFieldHidden("formonly.sel", TRUE)]]>
  </point>
  <point name="ui_dialog.more_action" order="" ver="1" cite_std="N" new="N" status="" src="s" mark_hard="N">
    <![CDATA[         ON ACTION first
            LET g_action_choice="first"
            IF cl_auth_chk_act("first") THEN 
               CALL axrq920_fetch1('F')
               LET g_current_row = g_current_idx
               LET g_curr_diag = ui.DIALOG.getCurrent()
               EXIT DIALOG
            END IF
         ON ACTION previous
            LET g_action_choice="previous"
            IF cl_auth_chk_act("previous") THEN 
               CALL axrq920_fetch1('P')
               LET g_current_row = g_current_idx
               LET g_curr_diag = ui.DIALOG.getCurrent()
               EXIT DIALOG
            END IF
         ON ACTION jump
            LET g_action_choice="jump"
            IF cl_auth_chk_act("jump") THEN 
               CALL axrq920_fetch1('/')
               LET g_current_row = g_current_idx
               LET g_curr_diag = ui.DIALOG.getCurrent()
               EXIT DIALOG
            END IF
         ON ACTION next
            LET g_action_choice="next"
            IF cl_auth_chk_act("next") THEN 
               CALL axrq920_fetch1('N')
               LET g_current_row = g_current_idx
               LET g_curr_diag = ui.DIALOG.getCurrent()
               EXIT DIALOG
            END IF
         ON ACTION last
            LET g_action_choice="last"
            IF cl_auth_chk_act("last") THEN 
               CALL axrq920_fetch1('L')
               LET g_current_row = g_current_idx
               LET g_curr_diag = ui.DIALOG.getCurrent()
               EXIT DIALOG
            END IF]]>
  </point>
  <section id="axrq920.b_fill" ver="8" status="" src="s">
    <![CDATA[#+ 單身陣列填充
PRIVATE FUNCTION axrq920_b_fill()
   {<Local define>}
   DEFINE ls_wc           STRING
   {</Local define>}
   #add-point:b_fill段define
   {<point name="b_fill.define"/>}
   #end add-point
 
   #add-point:b_fill段sql_before
   {<point name="b_fill.sql_before"/>}
   #end add-point
   
   IF cl_null(g_wc_filter) THEN
      LET g_wc_filter = " 1=1"
   END IF
   IF cl_null(g_wc) THEN
      LET g_wc = " 1=1"
   END IF
   IF cl_null(g_wc2) THEN
      LET g_wc2 = " 1=1"
   END IF
   
   LET ls_wc = g_wc, " AND ", g_wc2, " AND ", g_wc_filter
   
   LET g_sql = "SELECT  UNIQUE xreb004,xreb005,xreb006,xreb007,xreb020,xreb022,xreb008,xreb100,xreb103, 
       xreb107,xreb113,xreb117,xreb101,xreb114,'','','','','','','','',xreb123,xreb127,xreb121,xreb124, 
       xreb133,xreb137,xreb131,xreb134 FROM xreb_t",
 
 
               "",
               " WHERE xrebent= ? AND 1=1 AND ", ls_wc,cl_sql_add_filter("xreb_t")
    
   LET g_sql = g_sql, cl_sql_add_filter("xreb_t"),
                      " ORDER BY xreb_t.xrebld,xreb_t.xreb001,xreb_t.xreb002,xreb_t.xreb005,xreb_t.xreb006,xreb_t.xreb007"
  
   #add-point:b_fill段sql_after
   {<point name="b_fill.sql_after"/>}
   #end add-point
  
   PREPARE axrq920_pb FROM g_sql
   DECLARE b_fill_curs CURSOR FOR axrq920_pb
   
   OPEN b_fill_curs USING g_enterprise
 
   CALL g_xreb_d.clear()
   CALL g_xreb3_d.clear()   
 
 
   #add-point:陣列清空
   {<point name="b_fill.array_clear" />}
   #end add-point
 
   LET g_cnt = l_ac
   LET l_ac = 1   
   ERROR "Searching!" 
 
   FOREACH b_fill_curs INTO g_xreb_d[l_ac].xreb004,g_xreb_d[l_ac].xreb005,g_xreb_d[l_ac].xreb006,g_xreb_d[l_ac].xreb007, 
       g_xreb_d[l_ac].xreb020,g_xreb_d[l_ac].xreb022,g_xreb_d[l_ac].xreb008,g_xreb_d[l_ac].xreb100,g_xreb_d[l_ac].xreb103, 
       g_xreb_d[l_ac].xreb107,g_xreb_d[l_ac].xreb113,g_xreb_d[l_ac].xreb117,g_xreb_d[l_ac].xreb101,g_xreb_d[l_ac].xreb114, 
       g_xreb3_d[l_ac].xreb004,g_xreb3_d[l_ac].xreb005,g_xreb3_d[l_ac].xreb006,g_xreb3_d[l_ac].xreb007, 
       g_xreb3_d[l_ac].xreb020,g_xreb3_d[l_ac].xreb022,g_xreb3_d[l_ac].xreb008,g_xreb3_d[l_ac].xreb100, 
       g_xreb3_d[l_ac].xreb123,g_xreb3_d[l_ac].xreb127,g_xreb3_d[l_ac].xreb121,g_xreb3_d[l_ac].xreb124, 
       g_xreb3_d[l_ac].xreb133,g_xreb3_d[l_ac].xreb137,g_xreb3_d[l_ac].xreb131,g_xreb3_d[l_ac].xreb134 

      IF SQLCA.sqlcode THEN
         CALL cl_err("FOREACH:",SQLCA.sqlcode,1)
         EXIT FOREACH
      END IF
      
      #LET g_xreb_d[l_ac].statepic = cl_get_actipic(g_xreb_d[l_ac].statepic)
 
      
 
      #add-point:b_fill段資料填充
      {<point name="b_fill.fill"/>}
      #end add-point
      
      CALL axrq920_detail_show("'1'")      
 
      LET l_ac = l_ac + 1
      IF l_ac > g_max_rec THEN
         IF g_error_show = 1 THEN
            CALL cl_err( "", 9035, 1 )
         END IF
         EXIT FOREACH
      END IF
      
   END FOREACH
   LET g_error_show = 0
   
 
   
   CALL g_xreb_d.deleteElement(g_xreb_d.getLength())   
   CALL g_xreb3_d.deleteElement(g_xreb3_d.getLength())
 
 
   #add-point:陣列長度調整
   {<point name="b_fill.array_deleteElement" />}
   #end add-point
   
   #add-point:b_fill段資料填充(其他單身)
   {<point name="b_fill.others.fill"/>}
   #end add-point
    
   LET g_detail_cnt = l_ac - 1 
   DISPLAY g_detail_cnt TO FORMONLY.h_count
   LET l_ac = g_cnt
   LET g_cnt = 0
   
   CLOSE b_fill_curs
   FREE axrq920_pb
   
   LET l_ac = 1
   CALL axrq920_fetch()
   
      CALL axrq920_filter_show('xreb004','b_xreb004')
   CALL axrq920_filter_show('xreb005','b_xreb005')
   CALL axrq920_filter_show('xreb006','b_xreb006')
   CALL axrq920_filter_show('xreb007','b_xreb007')
   CALL axrq920_filter_show('xreb020','b_xreb020')
   CALL axrq920_filter_show('xreb022','b_xreb022')
   CALL axrq920_filter_show('xreb008','b_xreb008')
   CALL axrq920_filter_show('xreb100','b_xreb100')
   CALL axrq920_filter_show('xreb103','b_xreb103')
   CALL axrq920_filter_show('xreb107','b_xreb107')
   CALL axrq920_filter_show('xreb113','b_xreb113')
   CALL axrq920_filter_show('xreb117','b_xreb117')
   CALL axrq920_filter_show('xreb101','b_xreb101')
   CALL axrq920_filter_show('xreb114','b_xreb114')
   CALL axrq920_filter_show('xreb123','b_xreb123')
   CALL axrq920_filter_show('xreb127','b_xreb127')
   CALL axrq920_filter_show('xreb121','b_xreb121')
   CALL axrq920_filter_show('xreb124','b_xreb124')
   CALL axrq920_filter_show('xreb133','b_xreb133')
   CALL axrq920_filter_show('xreb137','b_xreb137')
   CALL axrq920_filter_show('xreb131','b_xreb131')
   CALL axrq920_filter_show('xreb134','b_xreb134')
 
   
END FUNCTION
]]>
  </section>
  <section id="axrq920.delete" ver="1" status="" src="s">
    <![CDATA[#+ delete
PRIVATE FUNCTION axrq920_delete()
   #add-point:delete段define
   {<point name="delete.define"/>}
   #end add-point
 
   #add-point:delete段control
   {<point name="delete.control"/>}
   #end add-point 
END FUNCTION
]]>
  </section>
  <section id="axrq920.description" ver="1" status="" src="s">
    <![CDATA[#+ Version..: T100-ERP-1.00.00(SD版次:1,PR版次:1) Build-000056
#+ 
#+ Filename...: axrq920
#+ Description: 應收暫估月結查詢
#+ Creator....: 02599(2014/07/08)
#+ Modifier...: 02599(2014/07/10)
#+ Buildtype..: 應用 q02 樣板自動產生
#+ 以上段落由子樣板a00產生
]]>
  </section>
  <section id="axrq920.detail_show" ver="5" status="" src="s">
    <![CDATA[#+ 顯示相關資料
PRIVATE FUNCTION axrq920_detail_show(ps_page)
   DEFINE ps_page    STRING
   DEFINE ls_sql     STRING
   #add-point:show段define
   {<point name="detail_show.define"/>}
   #end add-point
 
   #add-point:detail_show段之前
   {<point name="detail_show.before"/>}
   #end add-point
   
   
 
   #讀入ref值
   IF ps_page.getIndexOf("'1'",1) > 0 THEN
      #帶出公用欄位reference值page1
      
 
      #add-point:show段單身reference
      {<point name="detail_show.body.reference"/>}
      #end add-point
   END IF
   
   IF ps_page.getIndexOf("'2'",1) > 0 THEN
      #帶出公用欄位reference值page2
      
      #add-point:show段單身reference
      {<point name="detail_show.body3.reference"/>}
      #end add-point
   END IF
 
 
 
   #add-point:detail_show段之後
   {<point name="detail_show.after"/>}
   #end add-point
 
END FUNCTION
]]>
  </section>
  <section id="axrq920.fetch" ver="1" status="" src="s">
    <![CDATA[#+ 單身陣列填充2
PRIVATE FUNCTION axrq920_fetch()
   {<Local define>}
   DEFINE li_ac           LIKE type_t.num5
   {</Local define>}
   #add-point:fetch段define
   {<point name="fetch.define"/>}
   #end add-point
   
 
   #add-point:陣列清空
   {<point name="fetch.array_clear" />}
   #end add-point
   
   LET li_ac = l_ac 
   
 
   
   #DISPLAY g_detail_cnt TO FORMONLY.cnt
 
   #add-point:單身填充後
   {<point name="fetch.after_fill" />}
   #end add-point 
   
 
   #add-point:陣列筆數調整
   {<point name="fetch.array_deleteElement" />}
   #end add-point
 
   LET l_ac = li_ac
   
END FUNCTION
]]>
  </section>
  <section id="axrq920.filter" ver="7" status="" src="s">
    <![CDATA[#+ filter過濾功能
PRIVATE FUNCTION axrq920_filter()
   {<Local define>}
   {</Local define>}
   #add-point:filter段define
   {<point name="filter.define"/>}
   #end add-point    
   
   LET l_ac = 1
   LET g_detail_idx = 1
   LET g_detail_idx2 = 1
 
   LET INT_FLAG = 0
 
   LET g_qryparam.state = 'c'
 
   LET g_wc_filter_t = g_wc_filter
   LET g_wc_t = g_wc
   
   CALL gfrm_curr.setFieldHidden("formonly.sel", TRUE)
   CALL gfrm_curr.setFieldHidden("formonly.statepic", TRUE)
 
   LET g_wc = cl_replace_str(g_wc, g_wc_filter, '')
 
   #使用DIALOG包住 單頭CONSTRUCT及單身CONSTRUCT
   DIALOG ATTRIBUTES(UNBUFFERED,FIELD ORDER FORM)
 
      #單頭
      CONSTRUCT g_wc_filter ON xreb004,xreb005,xreb006,xreb007,xreb020,xreb022,xreb008,xreb100,xreb103, 
          xreb107,xreb113,xreb117,xreb101,xreb114,xreb123,xreb127,xreb121,xreb124,xreb133,xreb137,xreb131, 
          xreb134
                          FROM s_detail2[1].b_xreb004,s_detail2[1].b_xreb005,s_detail2[1].b_xreb006, 
                              s_detail2[1].b_xreb007,s_detail2[1].b_xreb020,s_detail2[1].b_xreb022,s_detail2[1].b_xreb008, 
                              s_detail2[1].b_xreb100,s_detail2[1].b_xreb103,s_detail2[1].b_xreb107,s_detail2[1].b_xreb113, 
                              s_detail2[1].b_xreb117,s_detail2[1].b_xreb101,s_detail2[1].b_xreb114,s_detail3[1].b_xreb123, 
                              s_detail3[1].b_xreb127,s_detail3[1].b_xreb121,s_detail3[1].b_xreb124,s_detail3[1].b_xreb133, 
                              s_detail3[1].b_xreb137,s_detail3[1].b_xreb131,s_detail3[1].b_xreb134
 
         BEFORE CONSTRUCT
#saki       CALL cl_qbe_init()
                     DISPLAY axrq920_filter_parser('xreb004') TO s_detail2[1].b_xreb004
            DISPLAY axrq920_filter_parser('xreb005') TO s_detail2[1].b_xreb005
            DISPLAY axrq920_filter_parser('xreb006') TO s_detail2[1].b_xreb006
            DISPLAY axrq920_filter_parser('xreb007') TO s_detail2[1].b_xreb007
            DISPLAY axrq920_filter_parser('xreb020') TO s_detail2[1].b_xreb020
            DISPLAY axrq920_filter_parser('xreb022') TO s_detail2[1].b_xreb022
            DISPLAY axrq920_filter_parser('xreb008') TO s_detail2[1].b_xreb008
            DISPLAY axrq920_filter_parser('xreb100') TO s_detail2[1].b_xreb100
            DISPLAY axrq920_filter_parser('xreb103') TO s_detail2[1].b_xreb103
            DISPLAY axrq920_filter_parser('xreb107') TO s_detail2[1].b_xreb107
            DISPLAY axrq920_filter_parser('xreb113') TO s_detail2[1].b_xreb113
            DISPLAY axrq920_filter_parser('xreb117') TO s_detail2[1].b_xreb117
            DISPLAY axrq920_filter_parser('xreb101') TO s_detail2[1].b_xreb101
            DISPLAY axrq920_filter_parser('xreb114') TO s_detail2[1].b_xreb114
            DISPLAY axrq920_filter_parser('xreb123') TO s_detail3[1].b_xreb123
            DISPLAY axrq920_filter_parser('xreb127') TO s_detail3[1].b_xreb127
            DISPLAY axrq920_filter_parser('xreb121') TO s_detail3[1].b_xreb121
            DISPLAY axrq920_filter_parser('xreb124') TO s_detail3[1].b_xreb124
            DISPLAY axrq920_filter_parser('xreb133') TO s_detail3[1].b_xreb133
            DISPLAY axrq920_filter_parser('xreb137') TO s_detail3[1].b_xreb137
            DISPLAY axrq920_filter_parser('xreb131') TO s_detail3[1].b_xreb131
            DISPLAY axrq920_filter_parser('xreb134') TO s_detail3[1].b_xreb134
 
 
      END CONSTRUCT
 
      #add-point:filter段add_cs
      {<point name="filter.add_cs"/>}
      #end add-point
 
      BEFORE DIALOG
         #add-point:filter段b_dialog
         {<point name="filter.b_dialog"/>}
         #end add-point  
 
      ON ACTION accept
         ACCEPT DIALOG 
 
      ON ACTION cancel
         LET INT_FLAG = 1
         EXIT DIALOG 
 
      #交談指令共用ACTION
      &include "common_action.4gl" 
         CONTINUE DIALOG
 
   END DIALOG
 
   IF NOT INT_FLAG THEN
      LET g_wc_filter = g_wc_filter, " "
   ELSE
      LET g_wc_filter = g_wc_filter_t
   END IF
   
      CALL axrq920_filter_show('xreb004','b_xreb004')
   CALL axrq920_filter_show('xreb005','b_xreb005')
   CALL axrq920_filter_show('xreb006','b_xreb006')
   CALL axrq920_filter_show('xreb007','b_xreb007')
   CALL axrq920_filter_show('xreb020','b_xreb020')
   CALL axrq920_filter_show('xreb022','b_xreb022')
   CALL axrq920_filter_show('xreb008','b_xreb008')
   CALL axrq920_filter_show('xreb100','b_xreb100')
   CALL axrq920_filter_show('xreb103','b_xreb103')
   CALL axrq920_filter_show('xreb107','b_xreb107')
   CALL axrq920_filter_show('xreb113','b_xreb113')
   CALL axrq920_filter_show('xreb117','b_xreb117')
   CALL axrq920_filter_show('xreb101','b_xreb101')
   CALL axrq920_filter_show('xreb114','b_xreb114')
   CALL axrq920_filter_show('xreb123','b_xreb123')
   CALL axrq920_filter_show('xreb127','b_xreb127')
   CALL axrq920_filter_show('xreb121','b_xreb121')
   CALL axrq920_filter_show('xreb124','b_xreb124')
   CALL axrq920_filter_show('xreb133','b_xreb133')
   CALL axrq920_filter_show('xreb137','b_xreb137')
   CALL axrq920_filter_show('xreb131','b_xreb131')
   CALL axrq920_filter_show('xreb134','b_xreb134')
 
    
   CALL axrq920_b_fill()
   
   CALL gfrm_curr.setFieldHidden("formonly.sel", FALSE)
   CALL gfrm_curr.setFieldHidden("formonly.statepic", FALSE)
 
END FUNCTION
]]>
  </section>
  <section id="axrq920.filter_parser" ver="1" status="" src="s">
    <![CDATA[#+ filter欄位解析
PRIVATE FUNCTION axrq920_filter_parser(ps_field)
   {<Local define>}
   DEFINE ps_field   STRING
   DEFINE ls_tmp     STRING
   DEFINE li_tmp     LIKE type_t.num5
   DEFINE li_tmp2    LIKE type_t.num5
   DEFINE ls_var     STRING
   {</Local define>}
   #add-point:filter段define
   {<point name="filter_parser.define"/>}
   #end add-point    
 
   #一般條件解析
   LET ls_tmp = ps_field, "='"
   LET li_tmp = g_wc_filter.getIndexOf(ls_tmp,1)
   IF li_tmp > 0 THEN
      LET li_tmp = ls_tmp.getLength() + li_tmp
      LET li_tmp2 = g_wc_filter.getIndexOf("'",li_tmp + 1) - 1
      LET ls_var = g_wc_filter.subString(li_tmp,li_tmp2)
   END IF
 
   #模糊條件解析
   LET ls_tmp = ps_field, " like '"
   LET li_tmp = g_wc_filter.getIndexOf(ls_tmp,1)
   IF li_tmp > 0 THEN
      LET li_tmp = ls_tmp.getLength() + li_tmp
      LET li_tmp2 = g_wc_filter.getIndexOf("'",li_tmp + 1) - 1
      LET ls_var = g_wc_filter.subString(li_tmp,li_tmp2)
      LET ls_var = cl_replace_str(ls_var,'%','*')
   END IF
 
   RETURN ls_var
 
END FUNCTION
]]>
  </section>
  <section id="axrq920.filter_show" ver="1" status="" src="s">
    <![CDATA[#+ Browser標題欄位顯示搜尋條件
PRIVATE FUNCTION axrq920_filter_show(ps_field,ps_object)
   DEFINE ps_field         STRING
   DEFINE ps_object        STRING
   DEFINE lnode_item       om.DomNode
   DEFINE ls_title         STRING
   DEFINE ls_name          STRING
   DEFINE ls_condition     STRING
 
   LET ls_name = "formonly.", ps_object
 
   LET lnode_item = gfrm_curr.findNode("TableColumn", ls_name)
   LET ls_title = lnode_item.getAttribute("text")
   IF ls_title.getIndexOf('※',1) > 0 THEN
      LEt ls_title = ls_title.subString(1,ls_title.getIndexOf('※',1)-1)
   END IF
 
   #顯示資料組合
   LET ls_condition = axrq920_filter_parser(ps_field)
   IF NOT cl_null(ls_condition) THEN
      LET ls_title = ls_title, '※', ls_condition, '※'
   END IF
 
   #將資料顯示回去
   CALL lnode_item.setAttribute("text",ls_title)
 
END FUNCTION
]]>
  </section>
  <section id="axrq920.global" ver="8" status="" src="s">
    <![CDATA[{<point name="global.memo" />}
 
IMPORT os
IMPORT util
#add-point:增加匯入項目
{<point name="global.import" />}
#end add-point
 
SCHEMA ds
 
GLOBALS "../../cfg/top_global.inc"
 
#add-point:增加匯入變數檔
{<point name="global.inc" />}
#end add-point
 
#單身 type 宣告
PRIVATE TYPE type_g_xreb_d RECORD
       #statepic       LIKE type_t.chr1,
       
       xreb004 LIKE xreb_t.xreb004, 
   xreb005 LIKE xreb_t.xreb005, 
   xreb006 LIKE xreb_t.xreb006, 
   xreb007 LIKE xreb_t.xreb007, 
   xreb020 LIKE xreb_t.xreb020, 
   xreb022 LIKE xreb_t.xreb022, 
   xreb008 LIKE xreb_t.xreb008, 
   xreb100 LIKE xreb_t.xreb100, 
   xreb103 LIKE xreb_t.xreb103, 
   xreb107 LIKE xreb_t.xreb107, 
   xreb113 LIKE xreb_t.xreb113, 
   xreb117 LIKE xreb_t.xreb117, 
   xreb101 LIKE xreb_t.xreb101, 
   xreb114 LIKE xreb_t.xreb114 
       END RECORD
PRIVATE TYPE type_g_xreb3_d RECORD
       xreb004 LIKE xreb_t.xreb004, 
   xreb005 LIKE xreb_t.xreb005, 
   xreb006 LIKE xreb_t.xreb006, 
   xreb007 LIKE xreb_t.xreb007, 
   xreb020 LIKE xreb_t.xreb020, 
   xreb022 LIKE xreb_t.xreb022, 
   xreb008 LIKE xreb_t.xreb008, 
   xreb100 LIKE xreb_t.xreb100, 
   xreb123 LIKE xreb_t.xreb123, 
   xreb127 LIKE xreb_t.xreb127, 
   xreb121 LIKE xreb_t.xreb121, 
   xreb124 LIKE xreb_t.xreb124, 
   xreb133 LIKE xreb_t.xreb133, 
   xreb137 LIKE xreb_t.xreb137, 
   xreb131 LIKE xreb_t.xreb131, 
   xreb134 LIKE xreb_t.xreb134
       END RECORD
 
 
 
#模組變數(Module Variables)
DEFINE g_master                     type_g_xreb_d
DEFINE g_master_t                   type_g_xreb_d
DEFINE g_xreb_d          DYNAMIC ARRAY OF type_g_xreb_d
DEFINE g_xreb_d_t        type_g_xreb_d
DEFINE g_xreb3_d   DYNAMIC ARRAY OF type_g_xreb3_d
DEFINE g_xreb3_d_t type_g_xreb3_d
 
 
      
DEFINE g_wc                 STRING
DEFINE g_wc_t               STRING                        #儲存 user 的查詢條件
DEFINE g_wc2                STRING
DEFINE g_wc_filter          STRING
DEFINE g_wc_filter_t        STRING
DEFINE g_sql                STRING
DEFINE g_forupd_sql         STRING                        #SELECT ... FOR UPDATE SQL
DEFINE g_before_input_done  LIKE type_t.num5
DEFINE g_cnt                LIKE type_t.num10    
DEFINE l_ac                 LIKE type_t.num5              
DEFINE l_ac_d               LIKE type_t.num5              #單身idx 
DEFINE g_curr_diag          ui.Dialog                     #Current Dialog
DEFINE gwin_curr            ui.Window                     #Current Window
DEFINE gfrm_curr            ui.Form                       #Current Form
DEFINE g_current_page       LIKE type_t.num5              #目前所在頁數
DEFINE g_detail_cnt         LIKE type_t.num5              #單身 總筆數(所有資料)
DEFINE g_ref_fields         DYNAMIC ARRAY OF VARCHAR(500) #ap_ref用陣列
DEFINE g_rtn_fields         DYNAMIC ARRAY OF VARCHAR(500) #ap_ref用陣列
DEFINE g_ref_vars           DYNAMIC ARRAY OF VARCHAR(500) #ap_ref用陣列
DEFINE gs_keys              DYNAMIC ARRAY OF VARCHAR(500) #同步資料用陣列
DEFINE gs_keys_bak          DYNAMIC ARRAY OF VARCHAR(500) #同步資料用陣列
DEFINE g_insert             LIKE type_t.chr5              #是否導到其他page
DEFINE g_error_show         LIKE type_t.num5
DEFINE g_master_idx         LIKE type_t.num5
DEFINE g_detail_idx         LIKE type_t.num5
DEFINE g_detail_idx2        LIKE type_t.num5
DEFINE g_hyper_url          STRING                        #hyperlink的主要網址
 
 
#多table用wc
DEFINE g_wc_table           STRING
 
 
 
DEFINE g_wc_filter_table           STRING
 
 
 
 
#add-point:自定義模組變數(Module Variable)
{<point name="global.variable"/>}
#end add-point
 
#add-point:傳入參數說明
{<point name="global.argv"/>}
#end add-point
]]>
  </section>
  <section id="axrq920.init" ver="1" status="" src="s">
    <![CDATA[#+ 畫面資料初始化
PRIVATE FUNCTION axrq920_init()
   #add-point:init段define
   {<point name="init.define"/>}
   #end add-point   
   
   LET g_error_show  = 1
   LET g_wc_filter   = " 1=1"
   LET g_wc_filter_t = " 1=1"
   
   
   
   #add-point:畫面資料初始化
   {<point name="init.init" />}
   #end add-point
   
END FUNCTION
]]>
  </section>
  <section id="axrq920.insert" ver="1" status="" src="s">
    <![CDATA[#+ insert
PRIVATE FUNCTION axrq920_insert()
   #add-point:insert段define
   {<point name="insert.define"/>}
   #end add-point
 
   #add-point:insert段control
   {<point name="insert.control"/>}
   #end add-point    
   
END FUNCTION
]]>
  </section>
  <section id="axrq920.main" ver="5" status="" src="s">
    <![CDATA[#+ 此段落由子樣板a26產生
#OPTIONS SHORT CIRCUIT
#+ 作業開始 
MAIN
   #add-point:main段define
   {<point name="main.define"/>}
   #end add-point   
 
   OPTIONS
   INPUT NO WRAP
   DEFER INTERRUPT
   
   #設定SQL錯誤記錄方式 (模組內定義有效)
   WHENEVER ERROR CALL cl_err_msg_log
       
   #依模組進行系統初始化設定(系統設定)
   CALL cl_ap_init("axr","")
 
   #add-point:作業初始化
   {<point name="main.init" />}
   #end add-point
   
   
 
   #LOCK CURSOR (identifier)
   #add-point:SQL_define
   {<point name="main.define_sql" />}
   #end add-point
   LET g_forupd_sql = " ", 
                      " FROM ",
                      " "
   #add-point:SQL_define
   {<point name="main.after_define_sql"/>}
   #end add-point
   LET g_forupd_sql = cl_sql_forupd(g_forupd_sql)                #轉換不同資料庫語法
   LET g_forupd_sql = cl_sql_add_mask(g_forupd_sql)              #遮蔽特定資料
   DECLARE axrq920_cl CURSOR FROM g_forupd_sql                 # LOCK CURSOR
 
   LET g_sql = " SELECT UNIQUE ",
               " FROM ",
               
               " WHERE  "
   LET g_sql = cl_sql_add_mask(g_sql)              #遮蔽特定資料
   #add-point:SQL_define
   {<point name="main.after_refresh_sql"/>}
   #end add-point
   PREPARE axrq920_master_referesh FROM g_sql
 
   #add-point:main段define_sql
   {<point name="main.body.define_sql" mark="Y"/>}
   #end add-point 
   LET g_forupd_sql = ""
   #add-point:main段define_sql
   {<point name="main.body.after_define_sql"/>}
   #end add-point 
   LET g_forupd_sql = cl_sql_forupd(g_forupd_sql)
   LET g_forupd_sql = cl_sql_add_mask(g_forupd_sql)              #遮蔽特定資料
   DECLARE axrq920_bcl CURSOR FROM g_forupd_sql
 
 
   
   IF g_bgjob = "Y" THEN
      #add-point:Service Call
      {<point name="main.servicecall" />}
      #end add-point
   ELSE
      #畫面開啟 (identifier)
      OPEN WINDOW w_axrq920 WITH FORM cl_ap_formpath("axr",g_code)
   
      #瀏覽頁簽資料初始化
      CALL cl_ui_init()
   
      #程式初始化
      CALL axrq920_init()   
 
      #進入選單 Menu (="N")
      CALL axrq920_ui_dialog() 
      
      #add-point:畫面關閉前
      {<point name="main.before_close" />}
      #end add-point
 
      #畫面關閉
      CLOSE WINDOW w_axrq920
      
   END IF 
   
   CLOSE axrq920_cl
   
   
 
   #add-point:作業離開前
   {<point name="main.exit" />}
   #end add-point
 
   #離開作業
   CALL cl_ap_exitprogram("0")
   
END MAIN
 
 
]]>
  </section>
  <section id="axrq920.modify" ver="1" status="" src="s">
    <![CDATA[#+ modify
PRIVATE FUNCTION axrq920_modify()
   #add-point:modify段define
   {<point name="modify.define"/>}
   #end add-point
 
   #add-point:modify段control
   {<point name="modify.control"/>}
   #end add-point 
END FUNCTION
]]>
  </section>
  <section id="axrq920.other_function" ver="1" status="" src="s">
    <![CDATA[{<point name="other.function"/>}
]]>
  </section>
  <section id="axrq920.query" ver="7" status="" src="s">
    <![CDATA[#+ QBE資料查詢
PRIVATE FUNCTION axrq920_query()
   {<Local define>}
   DEFINE ls_wc      LIKE type_t.chr500
   DEFINE ls_return  STRING
   DEFINE ls_result  STRING 
   {</Local define>}
   #add-point:query段define
   {<point name="query.define"/>}
   #end add-point 
   
   LET INT_FLAG = 0
   CLEAR FORM
   CALL g_xreb_d.clear()
   LET g_wc_filter = " 1=1"
   
   CALL gfrm_curr.setFieldHidden("formonly.sel", TRUE)
   CALL gfrm_curr.setFieldHidden("formonly.statepic", TRUE)
   
   LET g_qryparam.state = "c"
   LET g_detail_idx  = 1
   LET g_detail_idx2 = 1
   
   #wc備份
   LET ls_wc = g_wc
   LET g_master_idx = l_ac
 
   
 
   DIALOG ATTRIBUTES(UNBUFFERED,FIELD ORDER FORM)
 
      #單身根據table分拆construct
      CONSTRUCT g_wc_table ON xreb004,xreb005,xreb006,xreb007,xreb020,xreb022,xreb008,xreb100,xreb103, 
          xreb107,xreb113,xreb117,xreb101,xreb114,xreb123,xreb127,xreb121,xreb124,xreb133,xreb137,xreb131, 
          xreb134
           FROM s_detail2[1].b_xreb004,s_detail2[1].b_xreb005,s_detail2[1].b_xreb006,s_detail2[1].b_xreb007, 
               s_detail2[1].b_xreb020,s_detail2[1].b_xreb022,s_detail2[1].b_xreb008,s_detail2[1].b_xreb100, 
               s_detail2[1].b_xreb103,s_detail2[1].b_xreb107,s_detail2[1].b_xreb113,s_detail2[1].b_xreb117, 
               s_detail2[1].b_xreb101,s_detail2[1].b_xreb114,s_detail3[1].b_xreb123,s_detail3[1].b_xreb127, 
               s_detail3[1].b_xreb121,s_detail3[1].b_xreb124,s_detail3[1].b_xreb133,s_detail3[1].b_xreb137, 
               s_detail3[1].b_xreb131,s_detail3[1].b_xreb134
                      
         BEFORE CONSTRUCT
            #add-point:cs段more_construct
            {<point name="cs.head.before_construct"/>}
            #end add-point 
            
       #單身公用欄位開窗相關處理
       
         
       #單身一般欄位開窗相關處理
                #----<<b_xreb004>>----
         #此段落由子樣板a01產生
         BEFORE FIELD b_xreb004
            #add-point:BEFORE FIELD b_xreb004
            {<point name="construct.b.page2.b_xreb004" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD b_xreb004
            
            #add-point:AFTER FIELD b_xreb004
            {<point name="construct.a.page2.b_xreb004" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page2.b_xreb004
         ON ACTION controlp INFIELD b_xreb004
            #add-point:ON ACTION controlp INFIELD b_xreb004
            {<point name="construct.c.page2.b_xreb004" />}
            #END add-point
 
         #----<<b_xreb005>>----
         #此段落由子樣板a01產生
         BEFORE FIELD b_xreb005
            #add-point:BEFORE FIELD b_xreb005
            {<point name="construct.b.page2.b_xreb005" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD b_xreb005
            
            #add-point:AFTER FIELD b_xreb005
            {<point name="construct.a.page2.b_xreb005" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page2.b_xreb005
         ON ACTION controlp INFIELD b_xreb005
            #add-point:ON ACTION controlp INFIELD b_xreb005
            {<point name="construct.c.page2.b_xreb005" />}
            #END add-point
 
         #----<<b_xreb006>>----
         #此段落由子樣板a01產生
         BEFORE FIELD b_xreb006
            #add-point:BEFORE FIELD b_xreb006
            {<point name="construct.b.page2.b_xreb006" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD b_xreb006
            
            #add-point:AFTER FIELD b_xreb006
            {<point name="construct.a.page2.b_xreb006" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page2.b_xreb006
         ON ACTION controlp INFIELD b_xreb006
            #add-point:ON ACTION controlp INFIELD b_xreb006
            {<point name="construct.c.page2.b_xreb006" />}
            #END add-point
 
         #----<<b_xreb007>>----
         #此段落由子樣板a01產生
         BEFORE FIELD b_xreb007
            #add-point:BEFORE FIELD b_xreb007
            {<point name="construct.b.page2.b_xreb007" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD b_xreb007
            
            #add-point:AFTER FIELD b_xreb007
            {<point name="construct.a.page2.b_xreb007" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page2.b_xreb007
         ON ACTION controlp INFIELD b_xreb007
            #add-point:ON ACTION controlp INFIELD b_xreb007
            {<point name="construct.c.page2.b_xreb007" />}
            #END add-point
 
         #----<<b_xreb020>>----
         #此段落由子樣板a01產生
         BEFORE FIELD b_xreb020
            #add-point:BEFORE FIELD b_xreb020
            {<point name="construct.b.page2.b_xreb020" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD b_xreb020
            
            #add-point:AFTER FIELD b_xreb020
            {<point name="construct.a.page2.b_xreb020" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page2.b_xreb020
         ON ACTION controlp INFIELD b_xreb020
            #add-point:ON ACTION controlp INFIELD b_xreb020
            {<point name="construct.c.page2.b_xreb020" />}
            #END add-point
 
         #----<<b_xreb022>>----
         #此段落由子樣板a01產生
         BEFORE FIELD b_xreb022
            #add-point:BEFORE FIELD b_xreb022
            {<point name="construct.b.page2.b_xreb022" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD b_xreb022
            
            #add-point:AFTER FIELD b_xreb022
            {<point name="construct.a.page2.b_xreb022" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page2.b_xreb022
         ON ACTION controlp INFIELD b_xreb022
            #add-point:ON ACTION controlp INFIELD b_xreb022
            {<point name="construct.c.page2.b_xreb022" />}
            #END add-point
 
         #----<<b_xreb008>>----
         #此段落由子樣板a01產生
         BEFORE FIELD b_xreb008
            #add-point:BEFORE FIELD b_xreb008
            {<point name="construct.b.page2.b_xreb008" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD b_xreb008
            
            #add-point:AFTER FIELD b_xreb008
            {<point name="construct.a.page2.b_xreb008" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page2.b_xreb008
         ON ACTION controlp INFIELD b_xreb008
            #add-point:ON ACTION controlp INFIELD b_xreb008
            {<point name="construct.c.page2.b_xreb008" />}
            #END add-point
 
         #----<<b_xreb100>>----
         #此段落由子樣板a01產生
         BEFORE FIELD b_xreb100
            #add-point:BEFORE FIELD b_xreb100
            {<point name="construct.b.page2.b_xreb100" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD b_xreb100
            
            #add-point:AFTER FIELD b_xreb100
            {<point name="construct.a.page2.b_xreb100" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page2.b_xreb100
         ON ACTION controlp INFIELD b_xreb100
            #add-point:ON ACTION controlp INFIELD b_xreb100
            {<point name="construct.c.page2.b_xreb100" />}
            #END add-point
 
         #----<<b_xreb103>>----
         #此段落由子樣板a01產生
         BEFORE FIELD b_xreb103
            #add-point:BEFORE FIELD b_xreb103
            {<point name="construct.b.page2.b_xreb103" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD b_xreb103
            
            #add-point:AFTER FIELD b_xreb103
            {<point name="construct.a.page2.b_xreb103" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page2.b_xreb103
         ON ACTION controlp INFIELD b_xreb103
            #add-point:ON ACTION controlp INFIELD b_xreb103
            {<point name="construct.c.page2.b_xreb103" />}
            #END add-point
 
         #----<<b_xreb107>>----
         #此段落由子樣板a01產生
         BEFORE FIELD b_xreb107
            #add-point:BEFORE FIELD b_xreb107
            {<point name="construct.b.page2.b_xreb107" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD b_xreb107
            
            #add-point:AFTER FIELD b_xreb107
            {<point name="construct.a.page2.b_xreb107" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page2.b_xreb107
         ON ACTION controlp INFIELD b_xreb107
            #add-point:ON ACTION controlp INFIELD b_xreb107
            {<point name="construct.c.page2.b_xreb107" />}
            #END add-point
 
         #----<<b_xreb113>>----
         #此段落由子樣板a01產生
         BEFORE FIELD b_xreb113
            #add-point:BEFORE FIELD b_xreb113
            {<point name="construct.b.page2.b_xreb113" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD b_xreb113
            
            #add-point:AFTER FIELD b_xreb113
            {<point name="construct.a.page2.b_xreb113" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page2.b_xreb113
         ON ACTION controlp INFIELD b_xreb113
            #add-point:ON ACTION controlp INFIELD b_xreb113
            {<point name="construct.c.page2.b_xreb113" />}
            #END add-point
 
         #----<<b_xreb117>>----
         #此段落由子樣板a01產生
         BEFORE FIELD b_xreb117
            #add-point:BEFORE FIELD b_xreb117
            {<point name="construct.b.page2.b_xreb117" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD b_xreb117
            
            #add-point:AFTER FIELD b_xreb117
            {<point name="construct.a.page2.b_xreb117" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page2.b_xreb117
         ON ACTION controlp INFIELD b_xreb117
            #add-point:ON ACTION controlp INFIELD b_xreb117
            {<point name="construct.c.page2.b_xreb117" />}
            #END add-point
 
         #----<<b_xreb101>>----
         #此段落由子樣板a01產生
         BEFORE FIELD b_xreb101
            #add-point:BEFORE FIELD b_xreb101
            {<point name="construct.b.page2.b_xreb101" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD b_xreb101
            
            #add-point:AFTER FIELD b_xreb101
            {<point name="construct.a.page2.b_xreb101" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page2.b_xreb101
         ON ACTION controlp INFIELD b_xreb101
            #add-point:ON ACTION controlp INFIELD b_xreb101
            {<point name="construct.c.page2.b_xreb101" />}
            #END add-point
 
         #----<<b_xreb114>>----
         #此段落由子樣板a01產生
         BEFORE FIELD b_xreb114
            #add-point:BEFORE FIELD b_xreb114
            {<point name="construct.b.page2.b_xreb114" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD b_xreb114
            
            #add-point:AFTER FIELD b_xreb114
            {<point name="construct.a.page2.b_xreb114" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page2.b_xreb114
         ON ACTION controlp INFIELD b_xreb114
            #add-point:ON ACTION controlp INFIELD b_xreb114
            {<point name="construct.c.page2.b_xreb114" />}
            #END add-point
 
         #----<<xreb004_1>>----
         #----<<xreb005_1>>----
         #----<<xreb006_1>>----
         #----<<xreb007_1>>----
         #----<<xreb020_1>>----
         #----<<xreb022_1>>----
         #----<<xreb008_1>>----
         #----<<xreb100_1>>----
         #----<<b_xreb123>>----
         #此段落由子樣板a01產生
         BEFORE FIELD b_xreb123
            #add-point:BEFORE FIELD b_xreb123
            {<point name="construct.b.page3.b_xreb123" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD b_xreb123
            
            #add-point:AFTER FIELD b_xreb123
            {<point name="construct.a.page3.b_xreb123" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.b_xreb123
         ON ACTION controlp INFIELD b_xreb123
            #add-point:ON ACTION controlp INFIELD b_xreb123
            {<point name="construct.c.page3.b_xreb123" />}
            #END add-point
 
         #----<<b_xreb127>>----
         #此段落由子樣板a01產生
         BEFORE FIELD b_xreb127
            #add-point:BEFORE FIELD b_xreb127
            {<point name="construct.b.page3.b_xreb127" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD b_xreb127
            
            #add-point:AFTER FIELD b_xreb127
            {<point name="construct.a.page3.b_xreb127" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.b_xreb127
         ON ACTION controlp INFIELD b_xreb127
            #add-point:ON ACTION controlp INFIELD b_xreb127
            {<point name="construct.c.page3.b_xreb127" />}
            #END add-point
 
         #----<<b_xreb121>>----
         #此段落由子樣板a01產生
         BEFORE FIELD b_xreb121
            #add-point:BEFORE FIELD b_xreb121
            {<point name="construct.b.page3.b_xreb121" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD b_xreb121
            
            #add-point:AFTER FIELD b_xreb121
            {<point name="construct.a.page3.b_xreb121" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.b_xreb121
         ON ACTION controlp INFIELD b_xreb121
            #add-point:ON ACTION controlp INFIELD b_xreb121
            {<point name="construct.c.page3.b_xreb121" />}
            #END add-point
 
         #----<<b_xreb124>>----
         #此段落由子樣板a01產生
         BEFORE FIELD b_xreb124
            #add-point:BEFORE FIELD b_xreb124
            {<point name="construct.b.page3.b_xreb124" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD b_xreb124
            
            #add-point:AFTER FIELD b_xreb124
            {<point name="construct.a.page3.b_xreb124" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.b_xreb124
         ON ACTION controlp INFIELD b_xreb124
            #add-point:ON ACTION controlp INFIELD b_xreb124
            {<point name="construct.c.page3.b_xreb124" />}
            #END add-point
 
         #----<<b_xreb133>>----
         #此段落由子樣板a01產生
         BEFORE FIELD b_xreb133
            #add-point:BEFORE FIELD b_xreb133
            {<point name="construct.b.page3.b_xreb133" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD b_xreb133
            
            #add-point:AFTER FIELD b_xreb133
            {<point name="construct.a.page3.b_xreb133" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.b_xreb133
         ON ACTION controlp INFIELD b_xreb133
            #add-point:ON ACTION controlp INFIELD b_xreb133
            {<point name="construct.c.page3.b_xreb133" />}
            #END add-point
 
         #----<<b_xreb137>>----
         #此段落由子樣板a01產生
         BEFORE FIELD b_xreb137
            #add-point:BEFORE FIELD b_xreb137
            {<point name="construct.b.page3.b_xreb137" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD b_xreb137
            
            #add-point:AFTER FIELD b_xreb137
            {<point name="construct.a.page3.b_xreb137" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.b_xreb137
         ON ACTION controlp INFIELD b_xreb137
            #add-point:ON ACTION controlp INFIELD b_xreb137
            {<point name="construct.c.page3.b_xreb137" />}
            #END add-point
 
         #----<<b_xreb131>>----
         #此段落由子樣板a01產生
         BEFORE FIELD b_xreb131
            #add-point:BEFORE FIELD b_xreb131
            {<point name="construct.b.page3.b_xreb131" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD b_xreb131
            
            #add-point:AFTER FIELD b_xreb131
            {<point name="construct.a.page3.b_xreb131" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.b_xreb131
         ON ACTION controlp INFIELD b_xreb131
            #add-point:ON ACTION controlp INFIELD b_xreb131
            {<point name="construct.c.page3.b_xreb131" />}
            #END add-point
 
         #----<<b_xreb134>>----
         #此段落由子樣板a01產生
         BEFORE FIELD b_xreb134
            #add-point:BEFORE FIELD b_xreb134
            {<point name="construct.b.page3.b_xreb134" />}
            #END add-point
 
         #此段落由子樣板a02產生
         AFTER FIELD b_xreb134
            
            #add-point:AFTER FIELD b_xreb134
            {<point name="construct.a.page3.b_xreb134" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.b_xreb134
         ON ACTION controlp INFIELD b_xreb134
            #add-point:ON ACTION controlp INFIELD b_xreb134
            {<point name="construct.c.page3.b_xreb134" />}
            #END add-point
 
   
       
      END CONSTRUCT
      
 
      
 
  
      #add-point:query段more_construct
      {<point name="query.more_construct"/>}
      #end add-point 
      
      ON ACTION accept
         ACCEPT DIALOG
         
      ON ACTION cancel
         LET INT_FLAG = 1
         EXIT DIALOG
      
      #交談指令共用ACTION
      &include "common_action.4gl"
         CONTINUE DIALOG 
   END DIALOG
 
   
 
   IF INT_FLAG THEN
      LET INT_FLAG = 0
      #還原
      LET g_wc = ls_wc
   ELSE
      LET g_master_idx = 1
   END IF
   
   LET g_wc = g_wc_table 
 
 
        
   LET g_wc2 = " 1=1"
 
        
   #add-point:cs段after_construct
   {<point name="cs.after_construct"/>}
   #end add-point
        
   LET g_error_show = 1
   CALL axrq920_b_fill()
   LET l_ac = g_master_idx
   IF g_detail_cnt = 0 AND NOT INT_FLAG THEN
      CALL cl_err("",-100,1)
   END IF
   
   CALL gfrm_curr.setFieldHidden("formonly.sel", FALSE)
   CALL gfrm_curr.setFieldHidden("formonly.statepic", FALSE)
   
END FUNCTION
]]>
  </section>
  <section id="axrq920.reproduce" ver="1" status="" src="s">
    <![CDATA[#+ reproduce
PRIVATE FUNCTION axrq920_reproduce()
   #add-point:reproduce段define
   {<point name="reproduce.define"/>}
   #end add-point
 
   #add-point:reproduce段control
   {<point name="reproduce.control"/>}
   #end add-point 
END FUNCTION
]]>
  </section>
  <section id="axrq920.ui_dialog" ver="8" status="" src="s">
    <![CDATA[#+ 功能選單 
PRIVATE FUNCTION axrq920_ui_dialog()
   {<Local define>}
   DEFINE li_idx   LIKE type_t.num5
   {</Local define>}
   #add-point:ui_dialog段define
   {<point name="ui_dialog.define"/>}
   #end add-point 
 
   LET gwin_curr = ui.Window.getCurrent()
   LET gfrm_curr = gwin_curr.getForm()   
   
   LET g_action_choice = " "  
   CALL cl_set_act_visible("accept,cancel", FALSE)
         
   #add-point:ui_dialog段before dialog 
   {<point name="ui_dialog.before_dialog"/>}
   #end add-point
   
   CALL axrq920_query()
   
   WHILE TRUE
   
      DIALOG ATTRIBUTES(UNBUFFERED,FIELD ORDER FORM)
         DISPLAY ARRAY g_xreb_d TO s_detail2.* ATTRIBUTE(COUNT=g_detail_cnt) 
      
            BEFORE DISPLAY 
               LET g_current_page = 1
 
            BEFORE ROW
               LET g_detail_idx = DIALOG.getCurrentRow("s_detail2")
               LET l_ac = g_detail_idx
               DISPLAY g_detail_idx TO FORMONLY.h_index
               DISPLAY g_xreb_d.getLength() TO FORMONLY.h_count
               CALL axrq920_fetch()
               LET g_master_idx = l_ac
               #add-point:input段before row
               {<point name="input.body.before_row"/>}
               #end add-point  
            
            #自訂ACTION(detail_show,page_1)
            
               
         END DISPLAY
      
         DISPLAY ARRAY g_xreb3_d TO s_detail3.*
            ATTRIBUTES(COUNT=g_detail_cnt)  
         
            BEFORE DISPLAY 
               LET g_current_page = 2
            
            BEFORE ROW
               LET g_detail_idx = DIALOG.getCurrentRow("s_detail3")
               LET l_ac = g_detail_idx
               DISPLAY g_detail_idx TO FORMONLY.h_index
               DISPLAY g_xreb3_d.getLength() TO FORMONLY.h_count
               CALL axrq920_fetch()
               LET g_master_idx = l_ac
               #add-point:input段before row
               {<point name="input.body3.before_row"/>}
               #end add-point  
            #自訂ACTION(detail_show,page_2)
            
               
         END DISPLAY
 
 
         
 
      
         #add-point:ui_dialog段自定義display array
         {<point name="ui_dialog.more_displayarray"/>}
         #end add-point
         
         BEFORE DIALOG      
            CALL DIALOG.setSelectionMode("s_detail2", 1)
 
            #add-point:ui_dialog段before dialog
            {<point name="ui_dialog.bef_dialog"/>}
            #end add-point
 
         
         #+ 此段落由子樣板a43產生
         ON ACTION output
            LET g_action_choice="output"
            IF cl_auth_chk_act("output") THEN
               
               #add-point:ON ACTION output
               {<point name="menu.output" />}
               #END add-point
               EXIT DIALOG
            END IF
 
 
         #+ 此段落由子樣板a43產生
         ON ACTION query
            LET g_action_choice="query"
            IF cl_auth_chk_act("query") THEN
               CALL axrq920_query()
               #add-point:ON ACTION query
               {<point name="menu.query" />}
               #END add-point
               
            END IF
 
 
         #+ 此段落由子樣板a43產生
         ON ACTION datainfo
            LET g_action_choice="datainfo"
            IF cl_auth_chk_act("datainfo") THEN
               
               #add-point:ON ACTION datainfo
               {<point name="menu.datainfo" />}
               #END add-point
               EXIT DIALOG
            END IF
 
 
      
         ON ACTION filter
            LET g_action_choice="filter"
            CALL axrq920_filter()
            #add-point:ON ACTION filter
            {<point name="menu.filter" />}
            #END add-point
            EXIT DIALOG
      
         ON ACTION close
            LET INT_FLAG=FALSE         
            LET g_action_choice = "exit"
            EXIT DIALOG
      
         ON ACTION exit
            LET g_action_choice="exit"
            EXIT DIALOG
 
         ON ACTION qbeclear   # 條件清除
            CLEAR FORM
 
         ON ACTION datarefresh   # 重新整理
            LET g_error_show = 1
            CALL axrq920_b_fill()
 
         ON ACTION agendum   # 待辦事項
            #add-point:ON ACTION agendum
            {<point name="ui_dialog.agendum"/>}
            #END add-point
            CALL cl_user_overview()
 
         
         
 
         #add-point:ui_dialog段自定義action
         {<point name="ui_dialog.more_action"/>}
         #end add-point
      
         #主選單用ACTION
         &include "main_menu.4gl"
         &include "relating_action.4gl"
         #交談指令共用ACTION
         &include "common_action.4gl"
            CONTINUE DIALOG
      END DIALOG
      
      IF g_action_choice = "exit" AND NOT cl_null(g_action_choice) THEN
         EXIT WHILE
      END IF
      
   END WHILE
 
   CALL cl_set_act_visible("accept,cancel", TRUE)
 
END FUNCTION
]]>
  </section>
</add_points>
