<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<add_points prog="axrt300_02" std_prog="axrt300_02" erpver="1.0" module="AXR" ver="9" env="s" zone="t10prd" booking="Y" type="S" identity="s" section_flag="N" designer_ver="1.0">
  <other>
    <code_template value="F" status="u"/>
    <free_style value="N" status="u"/>
    <start_arg value="" status="u"/>
  </other>
  <point name="construct.c.page1.xrce010" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_oocq002_2()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xrce010  #顯示到畫面上

            NEXT FIELD xrce010                     #返回原欄位

]]>
  </point>
  <point name="input.c.page3.xrce021" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xrce3_d[l_ac].xrce021             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "" #

            CALL q_bgae001_1()                                #呼叫開窗

            LET g_xrce3_d[l_ac].xrce021 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xrce3_d[l_ac].xrce021 TO xrce021              #顯示到畫面上

            NEXT FIELD xrce021                          #返回原欄位

]]>
  </point>
  <point name="input.c.page3.xrce011" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xrce3_d[l_ac].xrce011             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "" #

            CALL q_nmad002()                                #呼叫開窗

            LET g_xrce3_d[l_ac].xrce011 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xrce3_d[l_ac].xrce011 TO xrce011              #顯示到畫面上

            NEXT FIELD xrce011                          #返回原欄位

]]>
  </point>
  <point name="input.c.page1.xrce100" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xrce_d[l_ac].xrce100             #給予default值

            #給予arg

            CALL q_aooi001_1()                                #呼叫開窗

            LET g_xrce_d[l_ac].xrce100 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xrce_d[l_ac].xrce100 TO xrce100              #顯示到畫面上

            NEXT FIELD xrce100                          #返回原欄位

]]>
  </point>
  <point name="input.a.page3.xrcesite_3" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xrce3_d[g_detail_idx].xrceld IS NOT NULL AND g_xrce3_d[g_detail_idx].xrcedocno IS NOT NULL AND g_xrce3_d[g_detail_idx].xrceseq IS NOT NULL AND g_xrce3_d[g_detail_idx].xrcesite IS NOT NULL AND g_xrce3_d[g_detail_idx].xrce001 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xrce3_d[g_detail_idx].xrceld != g_xrce3_d_t.xrceld OR g_xrce3_d[g_detail_idx].xrcedocno != g_xrce3_d_t.xrcedocno OR g_xrce3_d[g_detail_idx].xrceseq != g_xrce3_d_t.xrceseq OR g_xrce3_d[g_detail_idx].xrcesite != g_xrce3_d_t.xrcesite OR g_xrce3_d[g_detail_idx].xrce001 != g_xrce3_d_t.xrce001)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xrce_t WHERE "||"xrceent = '" ||g_enterprise|| "' AND "||"xrceld = '"||g_xrce3_d[g_detail_idx].xrceld ||"' AND "|| "xrcedocno = '"||g_xrce3_d[g_detail_idx].xrcedocno ||"' AND "|| "xrceseq = '"||g_xrce3_d[g_detail_idx].xrceseq ||"' AND "|| "xrcesite = '"||g_xrce3_d[g_detail_idx].xrcesite ||"' AND "|| "xrce001 = '"||g_xrce3_d[g_detail_idx].xrce001 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page3.xrceseq_3" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xrce3_d[g_detail_idx].xrceld IS NOT NULL AND g_xrce3_d[g_detail_idx].xrcedocno IS NOT NULL AND g_xrce3_d[g_detail_idx].xrceseq IS NOT NULL AND g_xrce3_d[g_detail_idx].xrcesite IS NOT NULL AND g_xrce3_d[g_detail_idx].xrce001 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xrce3_d[g_detail_idx].xrceld != g_xrce3_d_t.xrceld OR g_xrce3_d[g_detail_idx].xrcedocno != g_xrce3_d_t.xrcedocno OR g_xrce3_d[g_detail_idx].xrceseq != g_xrce3_d_t.xrceseq OR g_xrce3_d[g_detail_idx].xrcesite != g_xrce3_d_t.xrcesite OR g_xrce3_d[g_detail_idx].xrce001 != g_xrce3_d_t.xrce001)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xrce_t WHERE "||"xrceent = '" ||g_enterprise|| "' AND "||"xrceld = '"||g_xrce3_d[g_detail_idx].xrceld ||"' AND "|| "xrcedocno = '"||g_xrce3_d[g_detail_idx].xrcedocno ||"' AND "|| "xrceseq = '"||g_xrce3_d[g_detail_idx].xrceseq ||"' AND "|| "xrcesite = '"||g_xrce3_d[g_detail_idx].xrcesite ||"' AND "|| "xrce001 = '"||g_xrce3_d[g_detail_idx].xrce001 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page3.xrceld_3" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xrce3_d[g_detail_idx].xrceld IS NOT NULL AND g_xrce3_d[g_detail_idx].xrcedocno IS NOT NULL AND g_xrce3_d[g_detail_idx].xrceseq IS NOT NULL AND g_xrce3_d[g_detail_idx].xrcesite IS NOT NULL AND g_xrce3_d[g_detail_idx].xrce001 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xrce3_d[g_detail_idx].xrceld != g_xrce3_d_t.xrceld OR g_xrce3_d[g_detail_idx].xrcedocno != g_xrce3_d_t.xrcedocno OR g_xrce3_d[g_detail_idx].xrceseq != g_xrce3_d_t.xrceseq OR g_xrce3_d[g_detail_idx].xrcesite != g_xrce3_d_t.xrcesite OR g_xrce3_d[g_detail_idx].xrce001 != g_xrce3_d_t.xrce001)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xrce_t WHERE "||"xrceent = '" ||g_enterprise|| "' AND "||"xrceld = '"||g_xrce3_d[g_detail_idx].xrceld ||"' AND "|| "xrcedocno = '"||g_xrce3_d[g_detail_idx].xrcedocno ||"' AND "|| "xrceseq = '"||g_xrce3_d[g_detail_idx].xrceseq ||"' AND "|| "xrcesite = '"||g_xrce3_d[g_detail_idx].xrcesite ||"' AND "|| "xrce001 = '"||g_xrce3_d[g_detail_idx].xrce001 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page3.xrcedocno_3" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xrce3_d[g_detail_idx].xrceld IS NOT NULL AND g_xrce3_d[g_detail_idx].xrcedocno IS NOT NULL AND g_xrce3_d[g_detail_idx].xrceseq IS NOT NULL AND g_xrce3_d[g_detail_idx].xrcesite IS NOT NULL AND g_xrce3_d[g_detail_idx].xrce001 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xrce3_d[g_detail_idx].xrceld != g_xrce3_d_t.xrceld OR g_xrce3_d[g_detail_idx].xrcedocno != g_xrce3_d_t.xrcedocno OR g_xrce3_d[g_detail_idx].xrceseq != g_xrce3_d_t.xrceseq OR g_xrce3_d[g_detail_idx].xrcesite != g_xrce3_d_t.xrcesite OR g_xrce3_d[g_detail_idx].xrce001 != g_xrce3_d_t.xrce001)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xrce_t WHERE "||"xrceent = '" ||g_enterprise|| "' AND "||"xrceld = '"||g_xrce3_d[g_detail_idx].xrceld ||"' AND "|| "xrcedocno = '"||g_xrce3_d[g_detail_idx].xrcedocno ||"' AND "|| "xrceseq = '"||g_xrce3_d[g_detail_idx].xrceseq ||"' AND "|| "xrcesite = '"||g_xrce3_d[g_detail_idx].xrcesite ||"' AND "|| "xrce001 = '"||g_xrce3_d[g_detail_idx].xrce001 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page3.xrce021_u" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xrce3_d[l_ac].xrce021
            CALL ap_ref_array2(g_ref_fields,"SELECT glacl004 FROM glacl_t WHERE glaclent='"||g_enterprise||"' AND glacl001='1' AND glacl002=? AND glacl003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xrce3_d[l_ac].xrce021_u_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xrce3_d[l_ac].xrce021_u_desc
]]>
  </point>
  <point name="input.a.page3.xrce020_u" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xrce3_d[l_ac].xrce020
            CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='200' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xrce3_d[l_ac].xrce020_u_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xrce3_d[l_ac].xrce020_u_desc
]]>
  </point>
  <point name="input.a.page3.xrce019_u" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xrce3_d[l_ac].xrce019
            CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xrce3_d[l_ac].xrce019_u_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xrce3_d[l_ac].xrce019_u_desc
]]>
  </point>
  <point name="input.a.page3.xrce017_u" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xrce3_d[l_ac].xrce017
            CALL ap_ref_array2(g_ref_fields,"SELECT ooag011 FROM ooag_t WHERE ooagent='"||g_enterprise||"' AND ooag001=? ","") RETURNING g_rtn_fields
            LET g_xrce3_d[l_ac].xrce017_u_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xrce3_d[l_ac].xrce017_u_desc
]]>
  </point>
  <point name="input.a.page3.xrce001_3" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xrce3_d[g_detail_idx].xrceld IS NOT NULL AND g_xrce3_d[g_detail_idx].xrcedocno IS NOT NULL AND g_xrce3_d[g_detail_idx].xrceseq IS NOT NULL AND g_xrce3_d[g_detail_idx].xrcesite IS NOT NULL AND g_xrce3_d[g_detail_idx].xrce001 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xrce3_d[g_detail_idx].xrceld != g_xrce3_d_t.xrceld OR g_xrce3_d[g_detail_idx].xrcedocno != g_xrce3_d_t.xrcedocno OR g_xrce3_d[g_detail_idx].xrceseq != g_xrce3_d_t.xrceseq OR g_xrce3_d[g_detail_idx].xrcesite != g_xrce3_d_t.xrcesite OR g_xrce3_d[g_detail_idx].xrce001 != g_xrce3_d_t.xrce001)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xrce_t WHERE "||"xrceent = '" ||g_enterprise|| "' AND "||"xrceld = '"||g_xrce3_d[g_detail_idx].xrceld ||"' AND "|| "xrcedocno = '"||g_xrce3_d[g_detail_idx].xrcedocno ||"' AND "|| "xrceseq = '"||g_xrce3_d[g_detail_idx].xrceseq ||"' AND "|| "xrcesite = '"||g_xrce3_d[g_detail_idx].xrcesite ||"' AND "|| "xrce001 = '"||g_xrce3_d[g_detail_idx].xrce001 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page2.xrcesite_2" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xrce2_d[g_detail_idx].xrceld IS NOT NULL AND g_xrce2_d[g_detail_idx].xrcedocno IS NOT NULL AND g_xrce2_d[g_detail_idx].xrceseq IS NOT NULL AND g_xrce2_d[g_detail_idx].xrcesite IS NOT NULL AND g_xrce2_d[g_detail_idx].xrce001 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xrce2_d[g_detail_idx].xrceld != g_xrce2_d_t.xrceld OR g_xrce2_d[g_detail_idx].xrcedocno != g_xrce2_d_t.xrcedocno OR g_xrce2_d[g_detail_idx].xrceseq != g_xrce2_d_t.xrceseq OR g_xrce2_d[g_detail_idx].xrcesite != g_xrce2_d_t.xrcesite OR g_xrce2_d[g_detail_idx].xrce001 != g_xrce2_d_t.xrce001)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xrce_t WHERE "||"xrceent = '" ||g_enterprise|| "' AND "||"xrceld = '"||g_xrce2_d[g_detail_idx].xrceld ||"' AND "|| "xrcedocno = '"||g_xrce2_d[g_detail_idx].xrcedocno ||"' AND "|| "xrceseq = '"||g_xrce2_d[g_detail_idx].xrceseq ||"' AND "|| "xrcesite = '"||g_xrce2_d[g_detail_idx].xrcesite ||"' AND "|| "xrce001 = '"||g_xrce2_d[g_detail_idx].xrce001 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page2.xrceseq_2" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xrce2_d[g_detail_idx].xrceld IS NOT NULL AND g_xrce2_d[g_detail_idx].xrcedocno IS NOT NULL AND g_xrce2_d[g_detail_idx].xrceseq IS NOT NULL AND g_xrce2_d[g_detail_idx].xrcesite IS NOT NULL AND g_xrce2_d[g_detail_idx].xrce001 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xrce2_d[g_detail_idx].xrceld != g_xrce2_d_t.xrceld OR g_xrce2_d[g_detail_idx].xrcedocno != g_xrce2_d_t.xrcedocno OR g_xrce2_d[g_detail_idx].xrceseq != g_xrce2_d_t.xrceseq OR g_xrce2_d[g_detail_idx].xrcesite != g_xrce2_d_t.xrcesite OR g_xrce2_d[g_detail_idx].xrce001 != g_xrce2_d_t.xrce001)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xrce_t WHERE "||"xrceent = '" ||g_enterprise|| "' AND "||"xrceld = '"||g_xrce2_d[g_detail_idx].xrceld ||"' AND "|| "xrcedocno = '"||g_xrce2_d[g_detail_idx].xrcedocno ||"' AND "|| "xrceseq = '"||g_xrce2_d[g_detail_idx].xrceseq ||"' AND "|| "xrcesite = '"||g_xrce2_d[g_detail_idx].xrcesite ||"' AND "|| "xrce001 = '"||g_xrce2_d[g_detail_idx].xrce001 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page2.xrceld_2" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xrce2_d[g_detail_idx].xrceld IS NOT NULL AND g_xrce2_d[g_detail_idx].xrcedocno IS NOT NULL AND g_xrce2_d[g_detail_idx].xrceseq IS NOT NULL AND g_xrce2_d[g_detail_idx].xrcesite IS NOT NULL AND g_xrce2_d[g_detail_idx].xrce001 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xrce2_d[g_detail_idx].xrceld != g_xrce2_d_t.xrceld OR g_xrce2_d[g_detail_idx].xrcedocno != g_xrce2_d_t.xrcedocno OR g_xrce2_d[g_detail_idx].xrceseq != g_xrce2_d_t.xrceseq OR g_xrce2_d[g_detail_idx].xrcesite != g_xrce2_d_t.xrcesite OR g_xrce2_d[g_detail_idx].xrce001 != g_xrce2_d_t.xrce001)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xrce_t WHERE "||"xrceent = '" ||g_enterprise|| "' AND "||"xrceld = '"||g_xrce2_d[g_detail_idx].xrceld ||"' AND "|| "xrcedocno = '"||g_xrce2_d[g_detail_idx].xrcedocno ||"' AND "|| "xrceseq = '"||g_xrce2_d[g_detail_idx].xrceseq ||"' AND "|| "xrcesite = '"||g_xrce2_d[g_detail_idx].xrcesite ||"' AND "|| "xrce001 = '"||g_xrce2_d[g_detail_idx].xrce001 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page2.xrcedocno_2" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xrce2_d[g_detail_idx].xrceld IS NOT NULL AND g_xrce2_d[g_detail_idx].xrcedocno IS NOT NULL AND g_xrce2_d[g_detail_idx].xrceseq IS NOT NULL AND g_xrce2_d[g_detail_idx].xrcesite IS NOT NULL AND g_xrce2_d[g_detail_idx].xrce001 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xrce2_d[g_detail_idx].xrceld != g_xrce2_d_t.xrceld OR g_xrce2_d[g_detail_idx].xrcedocno != g_xrce2_d_t.xrcedocno OR g_xrce2_d[g_detail_idx].xrceseq != g_xrce2_d_t.xrceseq OR g_xrce2_d[g_detail_idx].xrcesite != g_xrce2_d_t.xrcesite OR g_xrce2_d[g_detail_idx].xrce001 != g_xrce2_d_t.xrce001)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xrce_t WHERE "||"xrceent = '" ||g_enterprise|| "' AND "||"xrceld = '"||g_xrce2_d[g_detail_idx].xrceld ||"' AND "|| "xrcedocno = '"||g_xrce2_d[g_detail_idx].xrcedocno ||"' AND "|| "xrceseq = '"||g_xrce2_d[g_detail_idx].xrceseq ||"' AND "|| "xrcesite = '"||g_xrce2_d[g_detail_idx].xrcesite ||"' AND "|| "xrce001 = '"||g_xrce2_d[g_detail_idx].xrce001 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page2.xrce001_2" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xrce2_d[g_detail_idx].xrceld IS NOT NULL AND g_xrce2_d[g_detail_idx].xrcedocno IS NOT NULL AND g_xrce2_d[g_detail_idx].xrceseq IS NOT NULL AND g_xrce2_d[g_detail_idx].xrcesite IS NOT NULL AND g_xrce2_d[g_detail_idx].xrce001 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xrce2_d[g_detail_idx].xrceld != g_xrce2_d_t.xrceld OR g_xrce2_d[g_detail_idx].xrcedocno != g_xrce2_d_t.xrcedocno OR g_xrce2_d[g_detail_idx].xrceseq != g_xrce2_d_t.xrceseq OR g_xrce2_d[g_detail_idx].xrcesite != g_xrce2_d_t.xrcesite OR g_xrce2_d[g_detail_idx].xrce001 != g_xrce2_d_t.xrce001)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xrce_t WHERE "||"xrceent = '" ||g_enterprise|| "' AND "||"xrceld = '"||g_xrce2_d[g_detail_idx].xrceld ||"' AND "|| "xrcedocno = '"||g_xrce2_d[g_detail_idx].xrcedocno ||"' AND "|| "xrceseq = '"||g_xrce2_d[g_detail_idx].xrceseq ||"' AND "|| "xrcesite = '"||g_xrce2_d[g_detail_idx].xrcesite ||"' AND "|| "xrce001 = '"||g_xrce2_d[g_detail_idx].xrce001 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page1.xrcesite" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xrce_d[g_detail_idx].xrceld IS NOT NULL AND g_xrce_d[g_detail_idx].xrcedocno IS NOT NULL AND g_xrce_d[g_detail_idx].xrceseq IS NOT NULL AND g_xrce_d[g_detail_idx].xrcesite IS NOT NULL AND g_xrce_d[g_detail_idx].xrce001 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xrce_d[g_detail_idx].xrceld != g_xrce_d_t.xrceld OR g_xrce_d[g_detail_idx].xrcedocno != g_xrce_d_t.xrcedocno OR g_xrce_d[g_detail_idx].xrceseq != g_xrce_d_t.xrceseq OR g_xrce_d[g_detail_idx].xrcesite != g_xrce_d_t.xrcesite OR g_xrce_d[g_detail_idx].xrce001 != g_xrce_d_t.xrce001)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xrce_t WHERE "||"xrceent = '" ||g_enterprise|| "' AND "||"xrceld = '"||g_xrce_d[g_detail_idx].xrceld ||"' AND "|| "xrcedocno = '"||g_xrce_d[g_detail_idx].xrcedocno ||"' AND "|| "xrceseq = '"||g_xrce_d[g_detail_idx].xrceseq ||"' AND "|| "xrcesite = '"||g_xrce_d[g_detail_idx].xrcesite ||"' AND "|| "xrce001 = '"||g_xrce_d[g_detail_idx].xrce001 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page1.xrceseq" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xrce_d[g_detail_idx].xrceld IS NOT NULL AND g_xrce_d[g_detail_idx].xrcedocno IS NOT NULL AND g_xrce_d[g_detail_idx].xrceseq IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xrce_d[g_detail_idx].xrceld != g_xrce_d_t.xrceld OR g_xrce_d[g_detail_idx].xrcedocno != g_xrce_d_t.xrcedocno OR g_xrce_d[g_detail_idx].xrceseq != g_xrce_d_t.xrceseq)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xrce_t WHERE "||"xrceent = '" ||g_enterprise|| "' AND "||"xrceld = '"||g_xrce_d[g_detail_idx].xrceld ||"' AND "|| "xrcedocno = '"||g_xrce_d[g_detail_idx].xrcedocno ||"' AND "|| "xrceseq = '"||g_xrce_d[g_detail_idx].xrceseq ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page1.xrceld" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xrce_d[g_detail_idx].xrceld IS NOT NULL AND g_xrce_d[g_detail_idx].xrcedocno IS NOT NULL AND g_xrce_d[g_detail_idx].xrceseq IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xrce_d[g_detail_idx].xrceld != g_xrce_d_t.xrceld OR g_xrce_d[g_detail_idx].xrcedocno != g_xrce_d_t.xrcedocno OR g_xrce_d[g_detail_idx].xrceseq != g_xrce_d_t.xrceseq)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xrce_t WHERE "||"xrceent = '" ||g_enterprise|| "' AND "||"xrceld = '"||g_xrce_d[g_detail_idx].xrceld ||"' AND "|| "xrcedocno = '"||g_xrce_d[g_detail_idx].xrcedocno ||"' AND "|| "xrceseq = '"||g_xrce_d[g_detail_idx].xrceseq ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page1.xrcedocno" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xrce_d[g_detail_idx].xrceld IS NOT NULL AND g_xrce_d[g_detail_idx].xrcedocno IS NOT NULL AND g_xrce_d[g_detail_idx].xrceseq IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xrce_d[g_detail_idx].xrceld != g_xrce_d_t.xrceld OR g_xrce_d[g_detail_idx].xrcedocno != g_xrce_d_t.xrcedocno OR g_xrce_d[g_detail_idx].xrceseq != g_xrce_d_t.xrceseq)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xrce_t WHERE "||"xrceent = '" ||g_enterprise|| "' AND "||"xrceld = '"||g_xrce_d[g_detail_idx].xrceld ||"' AND "|| "xrcedocno = '"||g_xrce_d[g_detail_idx].xrcedocno ||"' AND "|| "xrceseq = '"||g_xrce_d[g_detail_idx].xrceseq ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page1.xrce001" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  g_xrce_d[g_detail_idx].xrceld IS NOT NULL AND g_xrce_d[g_detail_idx].xrcedocno IS NOT NULL AND g_xrce_d[g_detail_idx].xrceseq IS NOT NULL AND g_xrce_d[g_detail_idx].xrcesite IS NOT NULL AND g_xrce_d[g_detail_idx].xrce001 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xrce_d[g_detail_idx].xrceld != g_xrce_d_t.xrceld OR g_xrce_d[g_detail_idx].xrcedocno != g_xrce_d_t.xrcedocno OR g_xrce_d[g_detail_idx].xrceseq != g_xrce_d_t.xrceseq OR g_xrce_d[g_detail_idx].xrcesite != g_xrce_d_t.xrcesite OR g_xrce_d[g_detail_idx].xrce001 != g_xrce_d_t.xrce001)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM xrce_t WHERE "||"xrceent = '" ||g_enterprise|| "' AND "||"xrceld = '"||g_xrce_d[g_detail_idx].xrceld ||"' AND "|| "xrcedocno = '"||g_xrce_d[g_detail_idx].xrcedocno ||"' AND "|| "xrceseq = '"||g_xrce_d[g_detail_idx].xrceseq ||"' AND "|| "xrcesite = '"||g_xrce_d[g_detail_idx].xrcesite ||"' AND "|| "xrce001 = '"||g_xrce_d[g_detail_idx].xrce001 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="construct.c.page3.xrce021" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_bgae001_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xrce021  #顯示到畫面上

            NEXT FIELD xrce021                     #返回原欄位

]]>
  </point>
  <point name="construct.c.page3.xrce020" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_oocq002_5()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xrce020  #顯示到畫面上

            NEXT FIELD xrce020                     #返回原欄位

]]>
  </point>
  <point name="construct.c.page3.xrce017" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooag001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xrce017  #顯示到畫面上

            NEXT FIELD xrce017                     #返回原欄位

]]>
  </point>
  <point name="construct.c.page3.xrce016" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL aglt310_04()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xrce016  #顯示到畫面上

            NEXT FIELD xrce016                     #返回原欄位

]]>
  </point>
  <point name="construct.c.page3.xrce011" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_nmad002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xrce011  #顯示到畫面上

            NEXT FIELD xrce011                     #返回原欄位

]]>
  </point>
  <point name="construct.c.page1.xrce100" order="0" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_aooi001_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xrce100  #顯示到畫面上

            NEXT FIELD xrce100                     #返回原欄位

]]>
  </point>
  <point name="function.axrt300_02_chk_xrce003" order="1" ver="4" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[################################################################################
# Descriptions...: 根據類型、款別檢查來源單號+項次
# Memo...........:
# Usage..........: CALL axrt300_02_chk_xrce003(p_cmd)
#                  RETURNING 
# Input parameter: p_cmd          新增/修改
#                : 
# Return code....: 
#                : 
# Date & Author..: 2014/01/15 By zhangweib
# Modify.........:
################################################################################
PRIVATE FUNCTION axrt300_02_chk_xrce003()
   DEFINE l_ooab002      LIKE ooab_t.ooab002
   DEFINE l_count        LIKE type_t.num5
   DEFINE l_xrcc108      LIKE xrcc_t.xrcc108
   DEFINE l_xrcc118      LIKE xrcc_t.xrcc118
   DEFINE l_xrcc128      LIKE xrcc_t.xrcc128
   DEFINE l_xrcc138      LIKE xrcc_t.xrcc138
   DEFINE l_apcc108      LIKE apcc_t.apcc108
   DEFINE l_apcc118      LIKE apcc_t.apcc118
   DEFINE l_apcc128      LIKE apcc_t.apcc128
   DEFINE l_apcc138      LIKE apcc_t.apcc138

   LET l_ooab002 = ''
   LET g_errno = ''
   SELECT ooab002 INTO l_ooab002 FROM ooab_t
    WHERE ooabent = g_enterprise
      AND ooab001 = 'S-FIN-1002'
      AND ooabsite= g_xrca_t.xrcasite
      
   IF cl_null(g_xrce_d[l_ac].xrce004) THEN RETURN END IF
   
   IF cl_null(g_xrce_d[l_ac].xrce005) THEN RETURN END IF

   IF g_xrce_d[l_ac].xrce002 = '31' OR g_xrce_d[l_ac].xrce002 = '32' THEN
      #檢查資料1:存在性;2.可沖金額大於0
      SELECT COUNT(*) INTO l_count FROM xrca_t,xrcc_t
       WHERE xrcaent = g_enterprise
         AND xrcaent = xrccent
         AND xrcadocno = xrccdocno
         AND xrcald = xrccld
         AND xrccld = g_xrca_t.xrcald
         AND xrccdocno = g_xrce_d[l_ac].xrce003
         AND xrccseq = g_xrce_d[l_ac].xrce004
         AND xrcc001 = g_xrce_d[l_ac].xrce005
      SELECT SUM(xrcc108 - xrcc109),SUM(xrcc118 - xrcc119 + xrcc113),SUM(xrcc128 - xrcc129 + xrcc123),SUM(xrcc138 - xrcc139 + xrcc133) 
        INTO l_xrcc108,l_xrcc118,l_xrcc128,l_xrcc138
        FROM xrcc_t
       WHERE xrccent = g_enterprise
         AND xrccld = g_xrca_t.xrcald
         AND xrccdocno = g_xrce_d[l_ac].xrce003
         AND xrccseq = g_xrce_d[l_ac].xrce004
         AND xrcc001 = g_xrce_d[l_ac].xrce005

      IF cl_null(l_xrcc108) THEN LET l_xrcc108 = 0 END IF
      IF cl_null(l_xrcc118) THEN LET l_xrcc118 = 0 END IF
      IF cl_null(l_xrcc128) THEN LET l_xrcc128 = 0 END IF
      IF cl_null(l_xrcc138) THEN LET l_xrcc138 = 0 END IF
      CASE
         WHEN l_count = 0
         LET g_errno = 'axr-00067'   RETURN
         WHEN l_xrcc108 = 0 OR l_xrcc118 = 0
         LET g_errno = 'axr-00058'   RETURN
      END CASE
   END IF

END FUNCTION]]>
  </point>
  <point name="function.axrt300_02_def_xrce" order="2" ver="4" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[################################################################################
# Descriptions...: 根絕單身沖銷類型、款別類型以及來源單號給單身其他字段默認值
# Memo...........:
# Usage..........: CALL axrt300_02_def_xrce(p_xrce002,p_xrce003,p_xrce004,p_xrce005,p_xrce006,p_xrce024)
#                  RETURNING 
# Input parameter: p_xrce002      沖銷類型
#                : p_xrce003      沖銷帳款單號
#                : p_xrce004      沖銷帳款單項次
#                : p_xrce005      期別
#                : p_xrce006      款別類型
#                : p_xrce024      第二參考單號
# Return code....: 
# Date & Author..: 2014/01/15 By zhangweib
# Modify.........:
################################################################################
PRIVATE FUNCTION axrt300_02_def_xrce(p_xrce002,p_xrce003,p_xrce004,p_xrce005,p_xrce006,p_xrce024)
   DEFINE p_xrce002      LIKE xrce_t.xrce002
   DEFINE p_xrce005      LIKE xrce_t.xrce005
   DEFINE p_xrce006      LIKE xrce_t.xrce006
   DEFINE p_xrce003      LIKE xrce_t.xrce003
   DEFINE p_xrce004      LIKE xrce_t.xrce004
   DEFINE p_xrce024      LIKE xrce_t.xrce024

   INITIALIZE g_xrce_t.* TO Null

   #IF p_xrce002 = '10' AND (p_xrce006 = '10' OR p_xrce006 = '20') THEN
   #   CALL axrt300_02_def_nmbb(p_xrce003,p_xrce004)
   #END IF
   #
   #IF p_xrce002 = '30' THEN
   #   CALL axrt300_02_def_xrcc(p_xrce003,p_xrce004,p_xrce005,p_xrce024)
   #END IF
   #
   #IF p_xrce002 = '31' THEN
   #   CALL axrt300_02_def_xrcc(p_xrce003,p_xrce004,p_xrce005,p_xrce003)
   #END IF
   
END FUNCTION]]>
  </point>
  <point name="function.axrt300_02_xrce024" order="3" ver="4" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[################################################################################
# Descriptions...: 根據類型檢查第二來源單號
# Memo...........:
# Usage..........: CALL axrt300_02_xrce024(p_cmd)
#                  RETURNING 
# Input parameter: p_cmd          新增/修改
#                : 
# Return code....: 
#                : 
# Date & Author..: 2014/01/15 By zhangweib
# Modify.........:
################################################################################
PRIVATE FUNCTION axrt300_02_xrce024(p_cmd)
   DEFINE p_cmd          LIKE type_t.chr1
   DEFINE l_ooab002      LIKE ooab_t.ooab002
   DEFINE l_count        LIKE type_t.num5
   DEFINE l_xrcc108      LIKE xrcc_t.xrcc108
   DEFINE l_xrcc118      LIKE xrcc_t.xrcc118
   DEFINE l_xrcc128      LIKE xrcc_t.xrcc128
   DEFINE l_xrcc138      LIKE xrcc_t.xrcc138

   LET l_ooab002 = ''
   SELECT ooab002 INTO l_ooab002 FROM ooab_t
    WHERE ooabent = g_enterprise
      AND ooab001 = 'S-FIN-1002'
      AND ooabsite= g_xrca_t.xrcasite

   LET g_errno = " "

   IF cl_null(g_xrce_d[l_ac].xrce024) THEN RETURN END IF

   IF cl_null(g_xrce3_d[l_ac].xrce003) THEN RETURN END IF
   
   IF cl_null(g_xrce3_d[l_ac].xrce005) THEN RETURN END IF
   
   IF l_ooab002 = 'Y' AND (cl_null(g_xrce_d[l_ac].xrce025) OR cl_null(g_xrce3_d[l_ac].xrce004)) THEN RETURN END IF
   
   IF l_ooab002 = 'Y' AND (g_xrce_d[l_ac].xrce025 = 0 OR g_xrce3_d[l_ac].xrce004 = 0) THEN RETURN END IF

   IF g_xrce3_d[l_ac].xrce002 = '30' THEN
      #檢查資料1:存在性;2.可沖金額大於0
      IF l_ooab002 = 'Y' THEN
         SELECT COUNT(*) INTO l_count FROM xrca_t,xrcb_t,xrcc_t
          WHERE xrcaent = g_enterprise
            AND xrcaent = xrcbent
            AND xrcaent = xrccent
            AND xrcadocno = xrcbdocno
            AND xrcadocno = xrccdocno
            AND xrcbseq = xrccseq
            AND xrcb002 = g_xrce_d[l_ac].xrce024
            AND xrcb003 = g_xrce_d[l_ac].xrce025
            AND xrcbdocno = g_xrce3_d[l_ac].xrce003
            AND xrcbseq = g_xrce3_d[l_ac].xrce004
            AND xrcc001 = g_xrce3_d[l_ac].xrce005
         SELECT SUM(xrcc108 - xrcc109),SUM(xrcc118 - xrcc119),SUM(xrcc128 - xrcc129),SUM(xrcc138 - xrcc139) 
           INTO l_xrcc108,l_xrcc118,l_xrcc128,l_xrcc138
           FROM xrcc_t,xrcb_t
          WHERE xrcbent = g_enterprise
            AND xrccent = xrcbent
            AND xrccdocno = xrcbdocno
            AND xrcbseq = xrccseq
            AND xrcb002 = g_xrce_d[l_ac].xrce024
            AND xrcb003 = g_xrce_d[l_ac].xrce025
            AND xrcbdocno = g_xrce3_d[l_ac].xrce003
            AND xrcbseq = g_xrce3_d[l_ac].xrce004
            AND xrcc001 = g_xrce3_d[l_ac].xrce005
         
      ELSE
         SELECT COUNT(*) INTO l_count FROM xrca_t,xrcb_t,xrcc_t
          WHERE xrcaent = g_enterprise
            AND xrcaent = xrcbent
            AND xrcaent = xrccent
            AND xrcadocno = xrcbdocno
            AND xrcadocno = xrccdocno
            AND xrcbseq = xrccseq
            AND xrcb002 = g_xrce_d[l_ac].xrce024
            AND xrcbdocno = g_xrce3_d[l_ac].xrce003
            AND xrcc001 = g_xrce3_d[l_ac].xrce005
         SELECT SUM(xrcc108 - xrcc109),SUM(xrcc118 - xrcc119),SUM(xrcc128 - xrcc129),SUM(xrcc138 - xrcc139) 
           INTO l_xrcc108,l_xrcc118,l_xrcc128,l_xrcc138
           FROM xrcc_t,xrcb_t
          WHERE xrcbent = g_enterprise
            AND xrccent = xrcbent
            AND xrccdocno = xrcbdocno
            AND xrcbseq = xrccseq
            AND xrcb002 = g_xrce_d[l_ac].xrce024
            AND xrcbdocno = g_xrce3_d[l_ac].xrce003
            AND xrcc001 = g_xrce3_d[l_ac].xrce005
       END IF
       IF cl_null(l_xrcc108) THEN LET l_xrcc108 = 0 END IF
       IF cl_null(l_xrcc118) THEN LET l_xrcc118 = 0 END IF
       IF cl_null(l_xrcc128) THEN LET l_xrcc128 = 0 END IF
       IF cl_null(l_xrcc138) THEN LET l_xrcc138 = 0 END IF
       CASE
          WHEN l_count = 0
          LET g_errno = 'axr-00067'   RETURN
          WHEN l_xrcc108 = 0 OR l_xrcc118 = 0 OR l_xrcc128 = 0 OR l_xrcc138 = 0
          LET g_errno = 'axr-00058'   RETURN
       END CASE
   END IF

   IF g_xrce3_d[l_ac].xrce002 = '31' THEN       #暫無規格
   END IF
END FUNCTION]]>
  </point>
  <point name="function.axrt300_02_chk_xrce109" order="4" ver="7" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[################################################################################
# Descriptions...: 根據來源單號計算原幣金額
# Memo...........:
# Usage..........: CALL axrt300_02_chk_xrce109()
#                  RETURNING
# Input parameter: 传入参数变量1   传入参数变量说明1
#                : 传入参数变量2   传入参数变量说明2
# Return code....: 回传参数变量1   回传参数变量说明1
#                : 回传参数变量2   回传参数变量说明2
# Date & Author..: 2014/01/15     By zhangweib
# Modify.........:
################################################################################
PRIVATE FUNCTION axrt300_02_chk_xrce109()
   DEFINE l_tot1         LIKE nmbb_t.nmbb006   #原幣金額
   DEFINE l_tot2         LIKE nmbb_t.nmbb007   #本幣金額
   DEFINE l_errno1       LIKE gzze_t.gzze001
   DEFINE l_count        LIKE type_t.num5
   DEFINE l_ld_s         LIKE type_t.num5
   DEFINE l_ooab002      LIKE ooab_t.ooab002
   DEFINE l_xrcc108      LIKE xrcc_t.xrcc108
   DEFINE l_xrcc118      LIKE xrcc_t.xrcc118
   DEFINE l_xrce109      LIKE xrce_t.xrce109
   DEFINE l_xrce119      LIKE xrce_t.xrce119

   LET g_errno = ' '

   LET l_ooab002 = ''
   SELECT ooab002 INTO l_ooab002 FROM ooab_t
    WHERE ooabent = g_enterprise
      AND ooab001 = 'S-FIN-1002'
      AND ooabsite= g_xrca_t.xrcasite
                    
   IF cl_null(g_xrce_d[l_ac].xrce003) THEN RETURN END IF

   IF g_xrce_d[l_ac].xrce002 = '31' OR g_xrce_d[l_ac].xrce002 = '32' THEN
      SELECT SUM(xrcc108),SUM(xrcc118 + xrcc113) INTO l_xrcc108,l_xrcc118 FROM xrcc_t
       WHERE xrccent = g_enterprise
         AND xrccld = g_xrca_t.xrcald
         AND xrccdocno = g_xrce_d[l_ac].xrce003
         AND xrccseq = g_xrce_d[l_ac].xrce004
         AND xrcc001 = g_xrce_d[l_ac].xrce005
   END IF
      
   LET l_xrcc108 = s_curr_round(g_xrca_t.xrcasite,g_glaa_t.glaa001,l_xrcc108,2)
   LET l_xrcc118 = s_curr_round(g_xrca_t.xrcasite,g_glaa_t.glaa001,l_xrcc118,2)
      
   SELECT SUM(xrce109),SUM(xrce119) INTO l_xrce109,l_xrce119 FROM xrce_t
    WHERE xrceent = g_enterprise
      AND xrceld = g_xrca_t.xrcald
      AND xrce003 = g_xrce_d[l_ac].xrce003
      AND xrce004 = g_xrce_d[l_ac].xrce004
      AND xrce005 = g_xrce_d[l_ac].xrce005

   IF cl_null(l_xrcc108) THEN LET l_xrcc108 = 0 END IF
   IF cl_null(l_xrcc118) THEN LET l_xrcc118 = 0 END IF
   IF cl_null(l_xrce109) THEN LET l_xrce109 = 0 END IF
   IF cl_null(l_xrce119) THEN LET l_xrce119 = 0 END IF

   IF NOT cl_null(g_xrce_d_t.xrce003) AND NOT cl_null(g_xrce_d_t.xrce005) AND NOT cl_null(g_xrce_d_t.xrce005) THEN
      IF g_xrce_d[l_ac].xrce003 = g_xrce_d_t.xrce003 AND g_xrce_d[l_ac].xrce004 = g_xrce_d_t.xrce004 AND g_xrce_d[l_ac].xrce005 = g_xrce_d_t.xrce005 THEN
         LET l_xrce109 = l_xrce109 - g_xrce_d_t.xrce109
         LET l_xrce119 = l_xrce119 - g_xrce_d_t.xrce119
      END IF
   END IF

   IF l_xrcc108 - l_xrce109 < g_xrce_d[l_ac].xrce109 OR l_xrcc118 - l_xrce119 < g_xrce_d[l_ac].xrce119 THEN
      LET g_errno = 'axr-00054'
   END IF
   
END FUNCTION]]>
  </point>
  <point name="function.axrt300_02_chk_xrce109_1" order="5" ver="4" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[################################################################################
# Descriptions...: 根據來源單號計算原幣金額
# Memo...........:
# Usage..........: CALL axrt300_02_chk_xrce109_1()
#                  RETURNING
# Input parameter: 传入参数变量1   传入参数变量说明1
#                : 传入参数变量2   传入参数变量说明2
# Return code....: 回传参数变量1   回传参数变量说明1
#                : 回传参数变量2   回传参数变量说明2
# Date & Author..: 2014/01/15 By zhangweib
# Modify.........:
################################################################################
PRIVATE FUNCTION axrt300_02_chk_xrce109_1()
   DEFINE l_tot1         LIKE nmbb_t.nmbb006   #原幣金額
   DEFINE l_tot2         LIKE nmbb_t.nmbb007   #本幣金額
   DEFINE l_errno1       LIKE gzze_t.gzze001
   DEFINE l_count        LIKE type_t.num5
   DEFINE l_ld_s         LIKE type_t.num5
   DEFINE l_ooab002      LIKE ooab_t.ooab002
   DEFINE l_xrcc108      LIKE xrcc_t.xrcc108
   DEFINE l_xrcc118      LIKE xrcc_t.xrcc118
   DEFINE l_xrce109      LIKE xrce_t.xrce109
   DEFINE l_xrce119      LIKE xrce_t.xrce119

   LET l_ooab002 = ''
   SELECT ooab002 INTO l_ooab002 FROM ooab_t
    WHERE ooabent = g_enterprise
      AND ooab001 = 'S-FIN-1002'
      AND ooabsite= g_xrca_t.xrcasite
                     
   IF cl_null(g_xrce_d[l_ac].xrce024) THEN RETURN END IF

   IF cl_null(g_xrce3_d[l_ac].xrce003) THEN RETURN END IF
   
   IF l_ooab002 = 'Y' AND (cl_null(g_xrce_d[l_ac].xrce025) OR cl_null(g_xrce3_d[l_ac].xrce004)) THEN RETURN END IF
   
   IF l_ooab002 = 'Y' AND (g_xrce_d[l_ac].xrce025 = 0 OR g_xrce3_d[l_ac].xrce004 = 0) THEN RETURN END IF

   IF l_ooab002 = 'Y' THEN
      SELECT SUM(xrcc108 - xrcc109),SUM(xrcc118 - xrcc119) INTO l_xrcc108,l_xrcc118 FROM xrcc_t,xrcb_t
       WHERE xrccent = g_enterprise
         AND xrccent = xrcbent
         AND xrccdocno = xrcbdocno
         AND xrccseq = xrcbseq
         AND xrccseq = g_xrce3_d[l_ac].xrce004
         AND xrccdocno = g_xrce3_d[l_ac].xrce003
         AND xrcc001 = g_xrce3_d[l_ac].xrce005
         AND xrcb002 = g_xrce_d[l_ac].xrce024
         AND xrcb003 = g_xrce_d[l_ac].xrce025
         	
      SELECT SUM(xrce109),SUM(xrce119) INTO l_xrce109,l_xrce119 FROM xrce_t
       WHERE xrceent = g_enterprise
         AND xrcedocno = g_xrca_t.xrcadocno
         AND xrceseq <> g_xrce3_d[l_ac].xrceseq
         AND xrce003 = g_xrce3_d[l_ac].xrce003
         AND xrce004 = g_xrce3_d[l_ac].xrce004
         AND xrce005 = g_xrce3_d[l_ac].xrce005
   ELSE
      SELECT SUM(xrcc108 - xrcc109),SUM(xrcc118 - xrcc119) INTO l_xrcc108,l_xrcc118 FROM xrcc_t,xrcb_t
       WHERE xrccent = g_enterprise
         AND xrccent = xrcbent
         AND xrccdocno = xrcbdocno
         AND xrccseq = xrcbseq
         AND xrccdocno = g_xrce3_d[l_ac].xrce003
         AND xrcc001 = g_xrce3_d[l_ac].xrce005
         AND xrcb002 = g_xrce_d[l_ac].xrce024
         
      SELECT SUM(xrce109),SUM(xrce119) INTO l_xrce109,l_xrce119 FROM xrce_t
       WHERE xrceent = g_enterprise
         AND xrcedocno = g_xrca_t.xrcadocno
         AND xrceseq <> g_xrce3_d[l_ac].xrceseq
         AND xrce003 = g_xrce3_d[l_ac].xrce003
         AND xrce005 = g_xrce3_d[l_ac].xrce005
   END IF
   IF cl_null(l_xrcc108) THEN LET l_xrcc108 = 0 END IF
   IF cl_null(l_xrcc118) THEN LET l_xrcc118 = 0 END IF
   IF cl_null(l_xrce109) THEN LET l_xrce109 = 0 END IF
   IF cl_null(l_xrce119) THEN LET l_xrce119 = 0 END IF
   IF (l_xrcc108 = 0 OR l_xrcc118 = 0) OR (l_xrcc108 - l_xrce109 < g_xrce_d[l_ac].xrce109 OR l_xrcc118 - l_xrce119 < g_xrce3_d[l_ac].xrce119) THEN
      LET g_errno = 'axr-00054'
   END IF
   
END FUNCTION]]>
  </point>
  <point name="function.axrt300_02_ins_xrce" order="6" ver="4" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[################################################################################
# Descriptions...: 根據回傳值,批次新增單身資料
# Memo...........:
# Usage..........: CALL axrt300_02_ins_xrce(p_xrce002,p_xrce006)
#                  RETURNING 回传参数
# Input parameter: 传入参数变量1   传入参数变量说明1
#                : 传入参数变量2   传入参数变量说明2
# Return code....: 回传参数变量1   回传参数变量说明1
#                : 回传参数变量2   回传参数变量说明2
# Date & Author..: 日期 By 作者
# Modify.........:
################################################################################
PRIVATE FUNCTION axrt300_02_ins_xrce(p_xrce002,p_xrce006)
   DEFINE p_xrce002      LIKE xrce_t.xrce002
   DEFINE p_xrce006      LIKE xrce_t.xrce006

   CALL s_transaction_end('N',0)

   CALL s_transaction_begin()
   LET g_success = 'Y'

   IF p_xrce002 = '10' THEN
      CALL axrt300_02_ins_xrce_07(p_xrce006)
   END IF

   IF p_xrce002 = '31' OR p_xrce002 = '32' THEN
      CALL axrt300_02_ins_xrce_04(p_xrce002)
   END IF

   IF g_success = 'Y' THEN
      CALL s_transaction_end('Y',0)
   ELSE
      CALL s_transaction_end('N',0)
   END IF

   CALL axrt300_02_b_fill(g_wc2)
END FUNCTION]]>
  </point>
  <point name="function.axrt300_02_def_nmbb" order="7" ver="6" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[################################################################################
# Descriptions...: 根據單號、項次抓取銀存收支明細檔默認資料
# Memo...........:
# Usage..........: CALL axrt300_02_def_nmbb(p_xrce003,p_xrce004)
#                  RETURNING 
# Input parameter: p_xrce003      沖銷帳款單號
#                : p_xrce004      沖銷帳款單項次
# Return code....: 
# Date & Author..: 2014/01/15 By zhangweib
# Modify.........:
################################################################################
PRIVATE FUNCTION axrt300_02_def_nmbb(p_xrce003,p_xrce004)
   DEFINE p_xrce003      LIKE xrce_t.xrce003
   DEFINE p_xrce004      LIKE xrce_t.xrce004
   DEFINE l_nmbb_t       RECORD LIKE nmbb_t.*
   DEFINE l_gzcb005      LIKE gzcb_t.gzcb005
   DEFINE l_ld_s         LIKE type_t.num5
   DEFINE l_count        LIKE type_t.num5
   DEFINE l_xrce109      LIKE xrce_t.xrce109
   DEFINE l_xrce119      LIKE xrce_t.xrce119
   DEFINE l_xrce129      LIKE xrce_t.xrce129
   DEFINE l_xrce139      LIKE xrce_t.xrce139
   
   #檢查是否是主帳套
   LET l_count = 0
   SELECT COUNT(*) INTO l_count FROM glaa_t
    WHERE glaaent = g_enterprise
      AND glaald  = g_xrca_t.xrcald
      AND glaa014 = 'Y'
   IF l_count > 0 THEN
     LET l_ld_s = 1
   ELSE
      #次帳套一
      LET l_count = 0
      SELECT COUNT(*) INTO l_count FROM ooab_t WHERE ooab001 = 'S-FIN-0001' AND ooab002 = g_xrca_t.xrcald 
                  AND ooabsite= g_xrca_t.xrcasite
      IF l_count > 0 THEN
         LET l_ld_s = 2
      END IF
      #次帳套二
      LET l_count = 0
      SELECT COUNT(*) INTO l_count FROM ooab_t WHERE ooab001 = 'S-FIN-0002' AND ooab002 = g_xrca_t.xrcald
                  AND ooabsite= g_xrca_t.xrcasite
      IF l_count > 0 THEN
         LET l_ld_s = 3
      END IF
   END IF
   
   SELECT SUM(xrce109),SUM(xrce119),SUM(xrce129),SUM(xrce139)
     INTO l_xrce109,l_xrce119,l_xrce129,l_xrce139
     FROM xrce_t,xrda_t
    WHERE xrceent = g_enterprise
      AND xrceent = xrdaent
      AND xrcedocno = xrdadocno
      AND xrceld = xrdald
      AND xrdastus = 'N'
      AND xrce003 = p_xrce003
      AND xrce004 = p_xrce004
      AND xrcedocno <> g_xrca_t.xrcadocno
   IF cl_null(l_xrce109) THEN LET l_xrce109 = 0 END IF
   IF cl_null(l_xrce119) THEN LET l_xrce119 = 0 END IF
   IF cl_null(l_xrce129) THEN LET l_xrce129 = 0 END IF
   IF cl_null(l_xrce139) THEN LET l_xrce139 = 0 END IF
   
   SELECT * INTO l_nmbb_t.* FROM nmbb_t
    WHERE nmbbent = g_enterprise
      AND nmbbdocno = p_xrce003
      AND nmbbseq = p_xrce004

   SELECT gzcb005 INTO l_gzcb005 FROM gzcb_t
    WHERE gzcb001 = '8306'
      AND gzcb002 = '10'

   LET g_xrce_d[l_ac].xrcecomp  = g_xrca_t.xrcacomp
   LET g_xrce_d[l_ac].xrceseq   = g_xrce_d[l_ac].xrceseq
   LET g_xrce_d[l_ac].xrcesite  = g_xrca_t.xrcasite
   LET g_xrce_d[l_ac].xrceorga  = g_xrca_t.xrcacomp
   LET g_xrce_d[l_ac].xrce001   = 'axrt300'
   LET g_xrce_d[l_ac].xrce002   = '10'
   LET g_xrce_d[l_ac].xrce003   = l_nmbb_t.nmbbdocno
   LET g_xrce_d[l_ac].xrce004   = l_nmbb_t.nmbbseq
   LET g_xrce_d[l_ac].xrce005   = 0
   LET g_xrce_d[l_ac].xrce006   = g_xrce_d[l_ac].xrce006
   LET g_xrce_d[l_ac].xrce008   = l_nmbb_t.nmbb003
   LET g_xrce3_d[l_ac].xrce010   = ''
   LET g_xrce_d[l_ac].xrce015   = l_gzcb005

   IF g_xrce_d[l_ac].xrce006 = '10' OR g_xrce_d[l_ac].xrce006 = '20' THEN 
      #借方科目: 依 anmi121  設定 
      SELECT DISTINCT glab005 INTO g_xrce3_d[l_ac].xrce016
        FROM glab_t
       WHERE glabent = g_enterprise 
         AND glabld  = g_xrce_d[l_ac].xrceld
         AND glab001 = '40'
         AND glab002 = '40'     
         AND glab003 = l_nmbb_t.nmbb003  #交易帳戶編號
   END IF
      
   IF g_xrce_d[l_ac].xrce006 = '30' THEN 
      #借方科目: 依 agli191 設定 
      SELECT DISTINCT glab005 INTO g_xrce3_d[l_ac].xrce016
        FROM glab_t
       WHERE glabent = g_enterprise 
         AND glabld  = g_xrce_d[l_ac].xrceld
         AND glab001 = '42'
         AND glab002 = l_nmbb_t.nmbb029   
         AND glab003 = l_nmbb_t.nmbb028
   END IF

   LET g_xrce3_d[l_ac].xrce017  = ''
   LET g_xrce3_d[l_ac].xrce018   = ''
   LET g_xrce3_d[l_ac].xrce019   = ''
   LET g_xrce3_d[l_ac].xrce020   = ''
   LET g_xrce3_d[l_ac].xrce022   = ''
   LET g_xrce3_d[l_ac].xrce023   = ''
   LET g_xrce_d[l_ac].xrce024   = l_nmbb_t.nmbbdocno
   LET g_xrce_d[l_ac].xrce025   = l_nmbb_t.nmbbseq
   LET g_xrce_d[l_ac].xrce027   = 'N'
   LET g_xrce_d[l_ac].xrce100   = l_nmbb_t.nmbb004
   LET g_xrce_d[l_ac].xrce101   = l_nmbb_t.nmbb005
   LET g_xrce2_d[l_ac].xrce120   = l_nmbb_t.nmbb011
   LET g_xrce2_d[l_ac].xrce121   = l_nmbb_t.nmbb012
   LET g_xrce2_d[l_ac].xrce129   = l_nmbb_t.nmbb013 - l_nmbb_t.nmbb014
   LET g_xrce2_d[l_ac].xrce130   = l_nmbb_t.nmbb015
   LET g_xrce2_d[l_ac].xrce131   = l_nmbb_t.nmbb016
   LET g_xrce2_d[l_ac].xrce139   = l_nmbb_t.nmbb017 - l_nmbb_t.nmbb018

   CASE
      WHEN l_ld_s = 1
         LET g_xrce_d[l_ac].xrce109 = l_nmbb_t.nmbb006 - l_nmbb_t.nmbb008
         LET g_xrce_d[l_ac].xrce119 = l_nmbb_t.nmbb007 - l_nmbb_t.nmbb009
      WHEN l_ld_s = 2
         LET g_xrce_d[l_ac].xrce109 = l_nmbb_t.nmbb006 - l_nmbb_t.nmbb020
         LET g_xrce_d[l_ac].xrce119 = l_nmbb_t.nmbb007 - l_nmbb_t.nmbb021
      WHEN l_ld_s = 3
         LET g_xrce_d[l_ac].xrce109 = l_nmbb_t.nmbb006 - l_nmbb_t.nmbb023
         LET g_xrce_d[l_ac].xrce119 = l_nmbb_t.nmbb007 - l_nmbb_t.nmbb024
   END CASE

   LET g_xrce_d[l_ac].xrce109 = g_xrce_d[l_ac].xrce109 - l_xrce109
   LET g_xrce_d[l_ac].xrce119 = g_xrce_d[l_ac].xrce119 - l_xrce119
   LET g_xrce2_d[l_ac].xrce129 = g_xrce2_d[l_ac].xrce129 - l_xrce129
   LET g_xrce2_d[l_ac].xrce139 = g_xrce2_d[l_ac].xrce139 - l_xrce139
   
   DISPLAY g_xrce_d[l_ac].xrce008,g_xrce_d[l_ac].xrce100,g_xrce_d[l_ac].xrce101,g_xrce_d[l_ac].xrce109,
           g_xrce_d[l_ac].xrce119,g_xrce3_d[l_ac].xrce019
        TO s_detail1[l_ac].xrce008,s_detail1[l_ac].xrce100,s_detail1[l_ac].xrce101,s_detail1[l_ac].xrce109,
           s_detail1[l_ac].xrce119,s_detail1[l_ac].xrce019

   LET g_xrce_t.xrceent = g_enterprise
   LET g_xrce_t.xrcecomp = g_xrce_d[l_ac].xrcecomp
   LET g_xrce_t.xrcedocno = g_xrca_t.xrcadocno
   LET g_xrce_t.xrceseq = g_xrce_d[l_ac].xrceseq
   LET g_xrce_t.xrceld = g_xrca_t.xrcald
   LET g_xrce_t.xrcesite = g_xrce_d[l_ac].xrcesite
   LET g_xrce_t.xrceorga = g_xrce_d[l_ac].xrceorga
   LET g_xrce_t.xrce001 = g_xrce_d[l_ac].xrce001
   LET g_xrce_t.xrce002 = g_xrce_d[l_ac].xrce002
   LET g_xrce_t.xrce003 = g_xrce_d[l_ac].xrce003
   LET g_xrce_t.xrce004 = g_xrce_d[l_ac].xrce004
   LET g_xrce_t.xrce005 = g_xrce_d[l_ac].xrce005
   LET g_xrce_t.xrce006 = g_xrce_d[l_ac].xrce006
   LET g_xrce_t.xrce008 = g_xrce_d[l_ac].xrce008
   LET g_xrce_t.xrce010 = g_xrce3_d[l_ac].xrce010
   LET g_xrce_t.xrce015 = g_xrce_d[l_ac].xrce015
   LET g_xrce_t.xrce016 = g_xrce3_d[l_ac].xrce016
   LET g_xrce_t.xrce017 = g_xrce3_d[l_ac].xrce017
   LET g_xrce_t.xrce018 = g_xrce3_d[l_ac].xrce018
   LET g_xrce_t.xrce019 = g_xrce3_d[l_ac].xrce019
   LET g_xrce_t.xrce020 = g_xrce3_d[l_ac].xrce020
   LET g_xrce_t.xrce022 = g_xrce3_d[l_ac].xrce022
   LET g_xrce_t.xrce023 = g_xrce3_d[l_ac].xrce023
   LET g_xrce_t.xrce024 = g_xrce_d[l_ac].xrce024
   LET g_xrce_t.xrce025 = g_xrce_d[l_ac].xrce025
   LET g_xrce_t.xrce100 = g_xrce_d[l_ac].xrce100
   LET g_xrce_t.xrce101 = g_xrce_d[l_ac].xrce101
   LET g_xrce_t.xrce109 = g_xrce_d[l_ac].xrce109
   LET g_xrce_t.xrce119 = g_xrce_d[l_ac].xrce119
   LET g_xrce_t.xrce120 = g_xrce2_d[l_ac].xrce120
   LET g_xrce_t.xrce121 = g_xrce2_d[l_ac].xrce121
   LET g_xrce_t.xrce129 = g_xrce2_d[l_ac].xrce129
   LET g_xrce_t.xrce130 = g_xrce2_d[l_ac].xrce130
   LET g_xrce_t.xrce131 = g_xrce2_d[l_ac].xrce131
   LET g_xrce_t.xrce139 = g_xrce2_d[l_ac].xrce139
   LET g_xrce_t.xrce027 = g_xrce_d[l_ac].xrce027
END FUNCTION]]>
  </point>
  <point name="function.axrt300_02_def_xrcc" order="8" ver="6" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[################################################################################
# Descriptions...: 根據單號、項次、參考項次二抓取多帳期明細默認資料
# Memo...........:
# Usage..........: CALL axrt300_02_def_xrcc(p_xrce003,p_xrce004,p_xrce005)
#                  RETURNING 
# Input parameter: p_xrce003      沖銷帳款單號
#                : p_xrce004      沖銷帳款單項次
#                : p_xrce005      期别
#                : p_xrce024      第二參考單號
# Return code....: 
# Date & Author..: 2014/01/15 By zhangweib
# Modify.........:
################################################################################
PRIVATE FUNCTION axrt300_02_def_xrcc(p_xrce003,p_xrce004,p_xrce005)
   DEFINE p_xrce003      LIKE xrce_t.xrce003
   DEFINE p_xrce004      LIKE xrce_t.xrce004
   DEFINE p_xrce024      LIKE xrce_t.xrce024
   DEFINE p_xrce005      LIKE xrce_t.xrce005
   DEFINE l_xrce109      LIKE xrce_t.xrce109
   DEFINE l_xrce119      LIKE xrce_t.xrce119
   DEFINE l_xrce129      LIKE xrce_t.xrce129
   DEFINE l_xrce139      LIKE xrce_t.xrce139
   DEFINE l_gzcb005      LIKE gzcb_t.gzcb005
   DEFINE l_ooab002      LIKE ooab_t.ooab002
   DEFINE l_sql          STRING
   DEFINE l_xrcc_t       RECORD LIKE xrcc_t.*
   DEFINE l_xrcb_t       RECORD LIKE xrcb_t.*
   DEFINE l_xrca_t       RECORD LIKE xrca_t.*

   SELECT gzcb005 INTO l_gzcb005 FROM gzcb_t
    WHERE gzcb001 = '8306'
      AND gzcb002 = g_xrce_d[l_ac].xrce002

   IF cl_null(p_xrce003) OR cl_null(p_xrce004) OR cl_null(p_xrce005) THEN
      RETURN
   END IF

   #LET l_ooab002 = ''
   #SELECT ooab002 INTO l_ooab002 FROM ooab_t
   # WHERE ooabent = g_enterprise
   #   AND ooab001 = 'S-FIN-1002'
   #   AND ooabsite= g_xrca_t.xrcasite  
   #
   #IF l_ooab002 = 'Y' AND cl_null(p_xrce004) THEN
   #   RETURN
   #END IF

#   IF p_xrce004 != 0 THEN
#      LET l_sql = "SELECT * FROM xrcc_t,xrcb_t,xrca_t",
#                  " WHERE xrcaent = xrcbent",
#                  "   AND xrcbent = xrccent",
#                  "   AND xrcadocno = xrcbdocno",
#                  "   AND xrcbdocno = xrccdocno",
#                  "   AND xrcbseq = xrccseq",
#                  "   AND xrcald = xrcbld",
#                  "   AND xrcald = xrccld",
#                  "   AND (xrcb002 = '",p_xrce024,"' OR xrcb002 IS NULL)",
#                  "   AND xrcc001 = '",p_xrce005,"'",
#                  "   AND xrcbdocno = '",p_xrce003,"'",
#                  "   AND xrcbseq = '",p_xrce004,"'",
#                  "   AND xrccld = '",g_xrca_t.xrcald,"'"
#   ELSE
#      LET l_sql = "SELECT * FROM xrcc_t,xrcb_t,xrca_t",
#                  " WHERE xrcaent = xrcbent",
#                  "   AND xrcbent = xrccent",
#                  "   AND xrcadocno = xrcbdocno",
#                  "   AND xrcbdocno = xrccdocno",
#                  "   AND xrcbseq = xrccseq",
#                  "   AND xrcald = xrcbld",
#                  "   AND xrcald = xrccld",
#                  "   AND (xrcb002 = '",p_xrce024,"' OR xrcb002 IS NULL)",
#                  "   AND xrcc001 = '",p_xrce005,"'",
#                  "   AND xrcbdocno = '",p_xrce003,"'",
#                  "   AND xrccld = '",g_xrca_t.xrcald,"'"
#   END IF

   SELECT * INTO l_xrcc_t.*,l_xrca_t.*
     FROM xrcc_t,xrca_t
    WHERE xrcaent = g_enterprise
      AND xrcaent = xrccent
      AND xrcadocno = xrccdocno
      AND xrcald = xrccld
      AND xrccld = g_xrda_m.xrdald
      AND xrccdocno = p_xrce003
      AND xrccseq = p_xrce004
      AND xrcc001 = p_xrce005
   
   LET g_xrce_t.xrcecomp  = l_xrcc_t.xrcccomp
   LET g_xrce_t.xrcesite  = l_xrcc_t.xrccsite
   LET g_xrce_t.xrceorga  = g_xrca_t.xrcacomp
   LET g_xrce_t.xrce001   = 'axrt300'
   LET g_xrce_t.xrce002   = g_xrce_d[l_ac].xrce002
   LET g_xrce_t.xrce003   = l_xrcc_t.xrccdocno
   LET g_xrce_t.xrce004   = l_xrcc_t.xrccseq
   LET g_xrce_t.xrce005   = l_xrcc_t.xrcc001
   LET g_xrce_t.xrce006   = ''
   LET g_xrce_t.xrce008   = l_xrcc_t.xrccdocno
   LET g_xrce_t.xrce010   = ''
   LET g_xrce_t.xrce015   = l_gzcb005
   LET g_xrce_t.xrce016   = l_xrca_t.xrca035
   LET g_xrce_t.xrce017   = l_xrca_t.xrca014
   LET g_xrce_t.xrce018   = l_xrcb_t.xrcb010
   LET g_xrce_t.xrce019   = l_xrcb_t.xrcb011
   LET g_xrce_t.xrce020   = l_xrcb_t.xrcb012
   LET g_xrce_t.xrce022   = l_xrcb_t.xrcb015
   LET g_xrce_t.xrce023   = l_xrcb_t.xrcb016
   LET g_xrce_t.xrce024   = l_xrcb_t.xrcb002
   LET g_xrce_t.xrce025   = l_xrcb_t.xrcb003
   LET g_xrce_t.xrce027   = 'N'
   LET g_xrce_t.xrce100   = l_xrcc_t.xrcc100
   LET g_xrce_t.xrce101   = l_xrcc_t.xrcc102    #20150313  xrcc101 ---->xrcc102
   LET g_xrce_t.xrce119   = l_xrcc_t.xrcc118 - l_xrcc_t.xrcc119
   LET g_xrce_t.xrce120   = l_xrcc_t.xrcc120
   LET g_xrce_t.xrce121   = l_xrcc_t.xrcc122
   LET g_xrce_t.xrce129   = l_xrcc_t.xrcc128 - l_xrcc_t.xrcc129
   LET g_xrce_t.xrce130   = l_xrcc_t.xrcc130
   LET g_xrce_t.xrce131   = l_xrcc_t.xrcc132
   LET g_xrce_t.xrce139   = l_xrcc_t.xrcc138 - l_xrcc_t.xrcc139

   SELECT SUM(xrce109),SUM(xrce119),SUM(xrce129),SUM(xrce139)
     INTO l_xrce109,l_xrce119,l_xrce129,l_xrce139
     FROM xrce_t,xrda_t
    WHERE xeceent = g_enterprise
      AND xrdald = xrceld
      AND xrdadocno = xrcedocno
      AND xrdaent = xrceent
      AND xrceld = g_xrca_t.xrcald
      AND xrce003 = g_xrce_t.xrce003
      AND xrce004 = g_xrce_t.xrce004
      AND xrce005 = g_xrce_t.xrce005
      AND xrcedocno <> g_xrca_t.xrcadocno
   IF cl_null(l_xrce109) THEN LET l_xrce109 = 0 END IF
   IF cl_null(l_xrce119) THEN LET l_xrce119 = 0 END IF
   IF cl_null(l_xrce129) THEN LET l_xrce129 = 0 END IF
   IF cl_null(l_xrce139) THEN LET l_xrce139 = 0 END IF
   
   LET g_xrce_t.xrce109 = g_xrce_t.xrce109 - l_xrce109
   LET g_xrce_t.xrce119 = g_xrce_t.xrce119 - l_xrce119
   LET g_xrce_t.xrce129 = g_xrce_t.xrce129 - l_xrce129
   LET g_xrce_t.xrce139 = g_xrce_t.xrce139 - l_xrce139
   
   LET g_xrce_d[l_ac].xrceorga = g_xrce_t.xrceorga
   LET g_xrce_d[l_ac].xrce024 = g_xrce_t.xrce024
   LET g_xrce_d[l_ac].xrce025 = g_xrce_t.xrce025
   LET g_xrce3_d[l_ac].xrce008 = g_xrce_t.xrce008
   LET g_xrce3_d[l_ac].xrce003 = g_xrce_t.xrce003
   LET g_xrce3_d[l_ac].xrce004 = g_xrce_t.xrce004
   LET g_xrce3_d[l_ac].xrce005 = g_xrce_t.xrce005
   LET g_xrce3_d[l_ac].xrce100 = g_xrce_t.xrce100
   LET g_xrce_d[l_ac].xrce101 = g_xrce_t.xrce101
   LET g_xrce_d[l_ac].xrce109 = g_xrce_t.xrce109
   LET g_xrce3_d[l_ac].xrce109 = g_xrce_t.xrce109
   LET g_xrce_d[l_ac].xrce119 = g_xrce_t.xrce119
   LET g_xrce2_d[l_ac].xrce119 = g_xrce_t.xrce119
   LET g_xrce3_d[l_ac].xrce119 = g_xrce_t.xrce119
   LET g_xrce3_d[l_ac].xrce010 = g_xrce_t.xrce010
   LET g_xrce3_d[l_ac].xrce018  = g_xrce_t.xrce018
   LET g_xrce_d[l_ac].xrce109 = g_xrce_t.xrce109
   LET g_xrce2_d[l_ac].xrce101 = g_xrce_t.xrce101
   LET g_xrce2_d[l_ac].xrce121 = g_xrce_t.xrce121
   LET g_xrce2_d[l_ac].xrce129 = g_xrce_t.xrce129
   LET g_xrce2_d[l_ac].xrce131 = g_xrce_t.xrce131
   LET g_xrce2_d[l_ac].xrce139 = g_xrce_t.xrce139
   
   DISPLAY g_xrce_d[l_ac].xrce024,g_xrce_d[l_ac].xrce025,g_xrce3_d[l_ac].xrce008,g_xrce3_d[l_ac].xrce003,
           g_xrce3_d[l_ac].xrce004,g_xrce3_d[l_ac].xrce005,g_xrce3_d[l_ac].xrce100,g_xrce3_d[l_ac].xrce101,
           g_xrce_d[l_ac].xrce109,g_xrce3_d[l_ac].xrce119,g_xrce3_d[l_ac].xrce010,g_xrce3_d[l_ac].xrce018,
           g_xrce_d[l_ac].xrce109,g_xrce_d[l_ac].xrceorga
        TO s_detail3[l_ac].xrce024_1,s_detail3[l_ac].xrce025_1,s_detail3[l_ac].xrce008_1,s_detail3[l_ac].xrce003_1,
           s_detail3[l_ac].xrce004_1,s_detail3[l_ac].xrce005_1,s_detail3[l_ac].xrce100_1,s_detail3[l_ac].xrce101_1,
           s_detail3[l_ac].xrce109_1,s_detail3[l_ac].xrce119_1,s_detail3[l_ac].xrce010_1,s_detail3[l_ac].xrce018_1,
           s_detail3[l_ac].xrce109_1,s_detail3[l_ac].xrceorga_1
END FUNCTION]]>
  </point>
  <point name="function.axrt300_02_ins_xrce_07" order="9" ver="8" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[################################################################################
# Descriptions...: 銀存收支新增进xrce_t
# Memo...........:
# Usage..........: CALL axrt300_02_ins_xrce_07()
#                  RETURNING 回传参数
# Input parameter: 传入参数变量1   传入参数变量说明1
#                : 传入参数变量2   传入参数变量说明2
# Return code....: 回传参数变量1   回传参数变量说明1
#                : 回传参数变量2   回传参数变量说明2
# Date & Author..: 日期 By 作者
# Modify.........:
################################################################################
PRIVATE FUNCTION axrt300_02_ins_xrce_07(p_xrce006)
   DEFINE p_xrce006    LIKE xrce_t.xrce006
   DEFINE l_sql        STRING
   DEFINE l_nmbb_t     RECORD LIKE nmbb_t.*
   DEFINE l_xrde_t     RECORD LIKE xrde_t.*
   DEFINE l_count      LIKE type_t.num5
   DEFINE l_xrde109    LIKE xrde_t.xrde109
   DEFINE l_xrde119    LIKE xrde_t.xrde119
   DEFINE l_xrde129    LIKE xrde_t.xrde129
   DEFINE l_xrde139    LIKE xrde_t.xrde139
   DEFINE l_gzcb003    LIKE gzcb_t.gzcb003
   DEFINE l_ld_s       LIKE type_t.num5      #帳套   1:主帳套;2:次帳套一;3:次帳套二
   
   DELETE FROM xrde_t 
    WHERE xrdeent = g_enterprise
      AND xrdeld = g_xrca_t.xrcald
      AND xrdedocno = g_xrca_t.xrcadocno
      AND xrdeseq = g_xrce_d[l_ac].xrceseq
      AND xrde003 = g_xrce_d[l_ac].xrce003
   
   IF cl_null(g_xrce_d_t.xrce003) THEN 
      SELECT MAX(xrdeseq) INTO l_xrde_t.xrdeseq
        FROM xrde_t
       WHERE xrdeent = g_enterprise 
         AND xrdeld = g_xrca_t.xrcald
         AND xrdedocno = g_xrca_t.xrcadocno
      IF cl_null(l_xrde_t.xrdeseq) THEN
         LET l_xrde_t.xrdeseq = 1
      ELSE
         LET l_xrde_t.xrdeseq = l_xrde_t.xrdeseq + 1
      END IF
   ELSE
      LET l_xrde_t.xrdeseq = g_xrce_d_t.xrceseq
   END IF
   
   LET l_count = 0
   SELECT COUNT(*) INTO l_count FROM glaa_t
    WHERE glaaent = g_enterprise
      AND glaald  = g_xrca_t.xrcald
      AND glaa014 = 'Y'
   IF l_count > 0 THEN
     LET l_ld_s = 1
   ELSE
      #次帳套一
      LET l_count = 0
      SELECT COUNT(*) INTO l_count FROM ooab_t WHERE ooab001 = 'S-FIN-0001' AND ooab002 = g_xrca_t.xrcald
                  AND ooabsite= g_xrca_t.xrcasite
      IF l_count > 0 THEN
         LET l_ld_s = 2
      END IF
      #次帳套二
      LET l_count = 0
      SELECT COUNT(*) INTO l_count FROM ooab_t WHERE ooab001 = 'S-FIN-0002' AND ooab002 = g_xrca_t.xrcald
                  AND ooabsite= g_xrca_t.xrcasite
      IF l_count > 0 THEN
         LET l_ld_s = 3
      END IF
   END IF
   

   LET l_sql = "SELECT * FROM nmbb_t WHERE ",g_qryparam.return1
   PREPARE axrt300_02_sel_nmbb_prep FROM l_sql
   DECLARE axrt300_02_sel_nmbb_curs CURSOR FOR axrt300_02_sel_nmbb_prep
   
   INITIALIZE l_nmbb_t.* TO Null
   
   SELECT gzcb003 INTO l_gzcb003 FROM gzcb_t
    WHERE gzcb001 = '8306'
      AND gzcb002 = g_xrce_d[l_ac].xrce002
   
   FOREACH axrt300_02_sel_nmbb_curs INTO l_nmbb_t.*
      #計算預沖金額
      LET l_xrde109 = 0   LET l_xrde119 = 0
      LET l_xrde129 = 0   LET l_xrde139 = 0
      SELECT SUM(xrde109),SUM(xrde119),SUM(xrde129),SUM(xrde139) INTO l_xrde109,l_xrde129,l_xrde129,l_xrde139 FROM xrde_t,xrda_t
       WHERE xrdaent   = xrdeent
         AND xrdald    = xrdeld
         AND xrdsdocno = xrdedocno
         AND xrde003   = l_nmbb_t.nmbbdocno
         AND xrde004   = l_nmbb_t.nmbbseq
         AND xrdastus  = 'N'
      IF cl_null(l_xrde109) THEN LET l_xrde109 = 0 END IF
      IF cl_null(l_xrde119) THEN LET l_xrde119 = 0 END IF
      IF cl_null(l_xrde129) THEN LET l_xrde129 = 0 END IF
      IF cl_null(l_xrde139) THEN LET l_xrde139 = 0 END IF
      
      LET l_xrde_t.xrdeent  = l_nmbb_t.nmbbent   
      LET l_xrde_t.xrdecomp = l_nmbb_t.nmbbcomp
      LET l_xrde_t.xrdeld   = g_xrca_t.xrcald
      LET l_xrde_t.xrdedocno= g_xrca_t.xrcadocno
      LET l_xrde_t.xrdesite = g_xrca_t.xrcasite
      LET l_xrde_t.xrdeorga = g_xrca_t.xrcacomp
      LET l_xrde_t.xrde001  = g_prog   #'axrt400'   20150520 Mod
      LET l_xrde_t.xrde002  = g_xrce_d[l_ac].xrce002
      LET l_xrde_t.xrde003  = l_nmbb_t.nmbbdocno
      LET l_xrde_t.xrde004  = l_nmbb_t.nmbbseq
      LET l_xrde_t.xrde006  = g_xrce_d[l_ac].xrce006
      LET l_xrde_t.xrde008  = l_nmbb_t.nmbb003
      LET l_xrde_t.xrde011  = l_nmbb_t.nmbb002
      LET l_xrde_t.xrde012  = l_nmbb_t.nmbb010
      LET l_xrde_t.xrde013  = ''
      LET l_xrde_t.xrde014  = ''
      IF l_gzcb003 = 'D'THEN
         LET l_xrde_t.xrde015   = 'D'
      ELSE
         LET l_xrde_t.xrde015   = 'C'
      END IF
      LET l_xrde_t.xrde017  = ''
      LET l_xrde_t.xrde018  = ''
      LET l_xrde_t.xrde019  = ''
      LET l_xrde_t.xrde020  = ''
      LET l_xrde_t.xrde022  = ''
      LET l_xrde_t.xrde023  = ''
      LET l_xrde_t.xrde100  = l_nmbb_t.nmbb004
      LET l_xrde_t.xrde101  = l_nmbb_t.nmbb005
      LET l_xrde_t.xrde120  = l_nmbb_t.nmbb011
      LET l_xrde_t.xrde121  = l_nmbb_t.nmbb012
      LET l_xrde_t.xrde130  = l_nmbb_t.nmbb015
      LET l_xrde_t.xrde131  = l_nmbb_t.nmbb016
      
      #抓取科目
      IF p_xrce006 = '10' OR p_xrce006 = '20' THEN 
         #借方科目: 依 anmi121  設定 
         SELECT DISTINCT glab005 INTO l_xrde_t.xrde016
           FROM glab_t
          WHERE glabent = g_enterprise 
            AND glabld  = g_xrca_t.xrcald
            AND glab001 = '40'
            AND glab002 = '40'     
            AND glab003 = l_nmbb_t.nmbb003  #交易帳戶編號
      END IF
      
      IF p_xrce006 = '30' THEN 
         #借方科目: 依 agli191 設定 
         SELECT DISTINCT glab005 INTO l_xrde_t.xrde016
           FROM glab_t
          WHERE glabent = g_enterprise 
            AND glabld  = g_xrca_t.xrcald
            AND glab001 = '42'
            AND glab002 = l_nmbb_t.nmbb029   
            AND glab003 = l_nmbb_t.nmbb028
      END IF
      
      CASE
         WHEN l_ld_s = 1
            LET l_xrde_t.xrde109  = l_nmbb_t.nmbb006 - l_nmbb_t.nmbb008 - l_xrde109
            LET l_xrde_t.xrde119  = l_nmbb_t.nmbb007 - l_nmbb_t.nmbb009 - l_xrde119
         WHEN l_ld_s = 2
            LET l_xrde_t.xrde109  = l_nmbb_t.nmbb006 - l_nmbb_t.nmbb020 - l_xrde109
            LET l_xrde_t.xrde119  = l_nmbb_t.nmbb007 - l_nmbb_t.nmbb021 - l_xrde119
         WHEN l_ld_s = 3
            LET l_xrde_t.xrde109  = l_nmbb_t.nmbb006 - l_nmbb_t.nmbb023 - l_xrde109
            LET l_xrde_t.xrde119  = l_nmbb_t.nmbb007 - l_nmbb_t.nmbb024 - l_xrde119
      END CASE
      LET l_xrde_t.xrde129  = l_nmbb_t.nmbb013 - l_nmbb_t.nmbb014 - l_xrde129
      LET l_xrde_t.xrde139  = l_nmbb_t.nmbb017 - l_nmbb_t.nmbb018 - l_xrde139

      #INSERT INTO xrde_t VALUES(l_xrde_t.*)
      INSERT INTO xrde_t(xrdeent,xrdecomp,xrdeld,xrdesite,xrdeorga,xrdedocno,xrdeseq,xrde001,
                         xrde002,xrde003,xrde004,xrde006,xrde008,xrde010,xrde011,xrde012,xrde013,
                         xrde014,xrde015,xrde016,xrde017,xrde018,xrde019,xrde020,xrde022,xrde023,
                         xrde100,xrde101,xrde109,xrde119,xrde120,xrde121,xrde129,xrde130,xrde131,xrde139)
                  VALUES(l_xrde_t.xrdeent ,l_xrde_t.xrdecomp ,l_xrde_t.xrdeld ,l_xrde_t.xrdesite,
                         l_xrde_t.xrdeorga,l_xrde_t.xrdedocno,l_xrde_t.xrdeseq,l_xrde_t.xrde001,
                         l_xrde_t.xrde002 ,l_xrde_t.xrde003  ,l_xrde_t.xrde004,l_xrde_t.xrde006,
                         l_xrde_t.xrde008 ,l_xrde_t.xrde010  ,l_xrde_t.xrde011,l_xrde_t.xrde012,
                         l_xrde_t.xrde013 ,l_xrde_t.xrde014  ,l_xrde_t.xrde015,l_xrde_t.xrde016,
                         l_xrde_t.xrde017 ,l_xrde_t.xrde018  ,l_xrde_t.xrde019,l_xrde_t.xrde020,
                         l_xrde_t.xrde022 ,l_xrde_t.xrde023  ,l_xrde_t.xrde100,l_xrde_t.xrde101,
                         l_xrde_t.xrde109 ,l_xrde_t.xrde119  ,l_xrde_t.xrde120,l_xrde_t.xrde121,
                         l_xrde_t.xrde129 ,l_xrde_t.xrde130  ,l_xrde_t.xrde131,l_xrde_t.xrde139
                         )
      IF SQLCA.sqlcode THEN
         LET g_success = 'N'
      END IF
      
      LET l_xrde_t.xrdeseq = l_xrde_t.xrdeseq + 1

   END FOREACH

END FUNCTION]]>
  </point>
  <point name="function.axrt300_02_ins_xrce_04" order="10" ver="8" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[################################################################################
# Descriptions...: 多帳期明細新增进xrcc_t
# Memo...........:
# Usage..........: CALL axrt300_02_ins_xrce_04()
#                  RETURNING 回传参数
# Input parameter: 传入参数变量1   传入参数变量说明1
#                : 传入参数变量2   传入参数变量说明2
# Return code....: 回传参数变量1   回传参数变量说明1
#                : 回传参数变量2   回传参数变量说明2
# Date & Author..: 日期 By 作者
# Modify.........:
################################################################################
PRIVATE FUNCTION axrt300_02_ins_xrce_04(p_xrce002)
   DEFINE p_xrce002      LIKE xrce_t.xrce002
   DEFINE l_xrce109      LIKE xrce_t.xrce109
   DEFINE l_xrce119      LIKE xrce_t.xrce119
   DEFINE l_xrce129      LIKE xrce_t.xrce129
   DEFINE l_xrce139      LIKE xrce_t.xrce139
   DEFINE l_gzcb003      LIKE gzcb_t.gzcb003
   DEFINE l_count        LIKE type_t.num5
   DEFINE l_ls_s         LIKE type_t.num5
   DEFINE l_sql          STRING
   DEFINE l_xrca_t       RECORD LIKE xrca_t.*
   DEFINE l_xrcc_t       RECORD LIKE xrcc_t.*
   DEFINE l_xrce_t       RECORD LIKE xrce_t.*
   DEFINE l_ooab002      LIKE ooab_t.ooab002
   DEFINE l_xrca060      LIKE xrca_t.xrca060


   DELETE FROM xrce_t 
    WHERE xrceent = g_enterprise
      AND xrceld = g_xrca_t.xrcald
      AND xrcedocno = g_xrca_t.xrcadocno
      AND xrceseq = g_xrce_d[l_ac].xrceseq
      AND xrce003 = g_xrce_d[l_ac].xrce003

   LET l_ooab002 = ''
   SELECT ooab002 INTO l_ooab002 FROM ooab_t
    WHERE ooabent = g_enterprise
      AND ooabsite= g_xrca_t.xrcasite
      AND ooab001 = 'S-FIN-1002'

   IF cl_null(g_xrce_d_t.xrce003) THEN 
      SELECT MAX(xrceseq) INTO l_xrce_t.xrceseq
        FROM xrce_t
       WHERE xrceent = g_enterprise 
         AND xrceld = g_xrca_t.xrcald
         AND xrcedocno = g_xrca_t.xrcadocno
      IF cl_null(l_xrce_t.xrceseq) THEN
         LET l_xrce_t.xrceseq = 1
      ELSE
         LET l_xrce_t.xrceseq = l_xrce_t.xrceseq + 1
      END IF
   ELSE
      LET l_xrce_t.xrceseq = g_xrce_d_t.xrceseq
   END IF

   #計算帳款部分
   LET l_sql ="SELECT * FROM xrcc_t,xrca_t,gzcb_t",
              " WHERE xrccent = '",g_enterprise,"'",
              "   AND xrccld = xrcald",
              "   AND xrccdocno = xrcadocno",
              "   AND xrccent = xrcaent ",
              "   AND xrcastus = 'Y'",
              "   AND xrca001 = gzcb002",
              "   AND gzcb003 = '1'",
              "   AND gzcb001 = '8302'",
              "   AND xrcc108 - xrcc109 > 0",
              "   AND xrca005 = '",g_xrca_t.xrca005,"'",
              "   AND (",g_qryparam.return1,")"
   
   PREPARE axrt300_02_sel_xrcc_prep FROM l_sql
   DECLARE axrt300_02_sel_xrcc_curs CURSOR FOR axrt300_02_sel_xrcc_prep

    
   SELECT gzcb003 INTO l_gzcb003 FROM gzcb_t
    WHERE gzcb002 = p_xrce002
      AND gzcb001 = '8306'
   LET l_xrce_t.xrceent = g_enterprise
   LET l_xrce_t.xrceld = g_xrca_t.xrcald
   LET l_xrce_t.xrcedocno = g_xrca_t.xrcadocno
   LET l_xrce_t.xrcesite  = g_xrca_t.xrcasite
   LET l_xrce_t.xrce002   = p_xrce002
   LET l_xrce_t.xrce010   = ''
   IF l_gzcb003 = 'D' THEN
      LET l_xrce_t.xrce015   =  'D'
   ELSE
      LET l_xrce_t.xrce015   =  'C'
   END IF
   

   FOREACH axrt300_02_sel_xrcc_curs INTO l_xrcc_t.*,l_xrca_t.*
      #計算預沖金額
      LET l_xrce109 = 0   LET l_xrce119 = 0
      LET l_xrce129 = 0   LET l_xrce139 = 0
      SELECT SUM(xrce109),SUM(xrce119),SUM(xrce129),SUM(xrce139) INTO l_xrce109,l_xrce129,l_xrce129,l_xrce139
        FROM xrce_t,xrda_t
       WHERE xrdaent   = xrceent
         AND xrdald    = xrceld
         AND xrdadocno = xrcedocno
         AND xrce003   = l_xrcc_t.xrccdocno
         AND xrce004   = l_xrcc_t.xrccseq
         AND xrce005   = l_xrcc_t.xrcc001
         AND xrdastus  = 'N'
      IF cl_null(l_xrce109) THEN LET l_xrce109 = 0 END IF
      IF cl_null(l_xrce119) THEN LET l_xrce119 = 0 END IF
      IF cl_null(l_xrce129) THEN LET l_xrce129 = 0 END IF
      IF cl_null(l_xrce139) THEN LET l_xrce139 = 0 END IF
      
      LET l_xrce_t.xrcecomp = l_xrcc_t.xrcccomp
      LET l_xrce_t.xrceorga = g_xrca_t.xrcacomp
      LET l_xrce_t.xrce001  = g_prog   #'axrt400'   20150520 Mod
      LET l_xrce_t.xrce003  = l_xrcc_t.xrccdocno
      LET l_xrce_t.xrce004  = l_xrcc_t.xrccseq
      LET l_xrce_t.xrce005  = l_xrcc_t.xrcc001
      LET l_xrce_t.xrce016  = l_xrca_t.xrca035
      LET l_xrce_t.xrce017  = l_xrca_t.xrca014
      LET l_xrce_t.xrce018  = l_xrca_t.xrca015
     #LET l_xrce_t.xrce027	 = 'N'
     #150316-00013#1 By 01727 Add  ---(S)---
      SELECT xrca060 INTO l_xrca060 FROM xrca_t
       WHERE xrcald = l_xrce_t.xrceld
         AND xrcadocno = l_xrce_t.xrce003
         AND xrcaent = g_enterprise
      IF l_xrca060 = '2' THEN
         LET l_xrce_t.xrce027 = 'Y'
      ELSE
         LET l_xrce_t.xrce027 = 'N'
      END IF
     #150316-00013#1 By 01727 Add  ---(S)---
      LET l_xrce_t.xrce028	 = 0
      LET l_xrce_t.xrce036	 = l_xrca_t.xrca006
      LET l_xrce_t.xrce053  = l_xrcc_t.xrcc008
      LET l_xrce_t.xrce054  = l_xrcc_t.xrcc009
      LET l_xrce_t.xrce100  = l_xrcc_t.xrcc100
      LET l_xrce_t.xrce101  = l_xrcc_t.xrcc102   #20150313  xrcc101 ---->xrcc102
      LET l_xrce_t.xrce104	 = 0
      LET l_xrce_t.xrce114	 = 0
      LET l_xrce_t.xrce120  = l_xrcc_t.xrcc120
      LET l_xrce_t.xrce121  = l_xrcc_t.xrcc122
      LET l_xrce_t.xrce130  = l_xrcc_t.xrcc130
      LET l_xrce_t.xrce131  = l_xrcc_t.xrcc132
      
      LET l_xrce_t.xrce109  = l_xrcc_t.xrcc108 - l_xrcc_t.xrcc109 - l_xrce109
      LET l_xrce_t.xrce119  = l_xrcc_t.xrcc118 - l_xrcc_t.xrcc119 + l_xrcc_t.xrcc113 - l_xrce119
      IF l_xrce_t.xrce109 <= 0 THEN CONTINUE FOREACH END IF
      LET l_xrce_t.xrce129  = l_xrcc_t.xrcc128 - l_xrcc_t.xrcc129 + l_xrcc_t.xrcc123 - l_xrce129
      LET l_xrce_t.xrce139  = l_xrcc_t.xrcc138 - l_xrcc_t.xrcc139 + l_xrcc_t.xrcc133 - l_xrce139

      IF g_glaa_t.glaa015 = 'N' THEN
         LET l_xrce_t.xrce120 = ''
         LET l_xrce_t.xrce121 = 0
         LET l_xrce_t.xrce129 = 0
      END IF
      
      IF g_glaa_t.glaa019 = 'N' THEN
         LET l_xrce_t.xrce130 = ''
         LET l_xrce_t.xrce131 = 0
         LET l_xrce_t.xrce139 = 0
      END IF


      #INSERT INTO xrce_t VALUES(l_xrce_t.*)
      INSERT INTO xrce_t(xrceent,xrcecomp,xrceorga,xrcesite,xrceld,xrcedocno,xrceseq,xrce001,xrce002,xrce003,
                         xrce004,xrce005,xrce010,xrce015,xrce016,xrce017,xrce018,xrce027,xrce028,xrce036,
                         xrce053,xrce054,xrce100,xrce101,xrce104,xrce114,xrce109,
                         xrce119,xrce120,xrce121,xrce129,xrce130,xrce131,xrce139)
                  VALUES(l_xrce_t.xrceent,l_xrce_t.xrcecomp ,l_xrce_t.xrceorga,l_xrce_t.xrcesite,
                         l_xrce_t.xrceld ,l_xrce_t.xrcedocno,l_xrce_t.xrceseq ,l_xrce_t.xrce001 ,
                         l_xrce_t.xrce002,l_xrce_t.xrce003  ,l_xrce_t.xrce004 ,l_xrce_t.xrce005 ,
                         l_xrce_t.xrce010,l_xrce_t.xrce015  ,l_xrce_t.xrce016 ,l_xrce_t.xrce017 ,
                         l_xrce_t.xrce018,l_xrce_t.xrce027  ,l_xrce_t.xrce028 ,l_xrce_t.xrce036 ,
                         l_xrce_t.xrce053,l_xrce_t.xrce054  ,l_xrce_t.xrce100 ,l_xrce_t.xrce101 ,
                         l_xrce_t.xrce104,l_xrce_t.xrce114  ,l_xrce_t.xrce109 ,l_xrce_t.xrce119 ,
                         l_xrce_t.xrce120,l_xrce_t.xrce121  ,l_xrce_t.xrce129 ,l_xrce_t.xrce130 ,
                         l_xrce_t.xrce131,l_xrce_t.xrce139
                        )
      IF SQLCA.sqlcode THEN
         LET g_success = 'N' RETURN
      END IF

      LET l_xrce_t.xrceseq = l_xrce_t.xrceseq + 1

   END FOREACH
   
END FUNCTION]]>
  </point>
  <point name="function.axrt300_02_ref_amt" order="11" ver="8" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[################################################################################
# Descriptions...: 刷新合計金額顯示
# Memo...........:
# Usage..........: CALL axrt300_02_ref_amt()
#                  RETURNING 回传参数
# Input parameter: 传入参数变量1   传入参数变量说明1
#                : 传入参数变量2   传入参数变量说明2
# Return code....: 回传参数变量1   回传参数变量说明1
#                : 回传参数变量2   回传参数变量说明2
# Date & Author..: 日期 By 作者
# Modify.........:
################################################################################
PRIVATE FUNCTION axrt300_02_ref_amt()
   DEFINE l_amt1,l_amt2,l_amt3,l_amt4          LIKE xrce_t.xrce109     #收款金額
   DEFINE l_amt5,l_amt6,l_amt7,l_amt8          LIKE xrce_t.xrce109     #帳款金額
   DEFINE l_amt9,l_amt10,l_amt11,l_amt12       LIKE xrce_t.xrce109     #匯差及調整金額
   DEFINE l_amt13,l_amt14,l_amt15,l_amt16      LIKE xrce_t.xrce109     #差異金額
   DEFINE l_amt17,l_amt18,l_amt19,l_amt20      LIKE xrce_t.xrce109     #差異金額
   DEFINE l_xrce109 LIKE xrce_t.xrce109
   DEFINE l_xrce119 LIKE xrce_t.xrce119
   DEFINE l_xrce129 LIKE xrce_t.xrce129
   DEFINE l_xrce139 LIKE xrce_t.xrce139
   DEFINE l_xrde109 LIKE xrde_t.xrde109
   DEFINE l_xrde119 LIKE xrde_t.xrde119
   DEFINE l_xrde129 LIKE xrde_t.xrde129
   DEFINE l_xrde139 LIKE xrde_t.xrde139
   DEFINE l_sum1    LIKE xrce_t.xrce109
   DEFINE l_sum2    LIKE xrce_t.xrce109
   DEFINE l_sum3    LIKE xrce_t.xrce109
   DEFINE l_sum4    LIKE xrce_t.xrce109
   DEFINE l_amt5_1,l_amt6_1,l_amt7_1,l_amt8_1          LIKE xrce_t.xrce109     #帳款金額  #20150323 add
   
   DISPLAY g_xrca_t.xrca100 TO xrca100
   DISPLAY g_glaa_t.glaa001,g_glaa_t.glaa016,g_glaa_t.glaa020 TO glaa001,glaa016,glaa020
   
   LET l_amt1 = g_xrca_t.xrca103 + g_xrca_t.xrca104
   LET l_amt2 = g_xrca_t.xrca113 + g_xrca_t.xrca114
   LET l_amt3 = g_xrca_t.xrca123 + g_xrca_t.xrca124
   LET l_amt4 = g_xrca_t.xrca133 + g_xrca_t.xrca134
   IF cl_null(l_amt1) THEN LET l_amt1 = 0 END IF
   IF cl_null(l_amt2) THEN LET l_amt2 = 0 END IF
   IF cl_null(l_amt3) THEN LET l_amt3 = 0 END IF
   IF cl_null(l_amt4) THEN LET l_amt4 = 0 END IF
   
   #稅前折抵金額
   SELECT SUM(xrce109),SUM(xrce119),SUM(xrce129),SUM(xrce139) INTO l_amt5,l_amt6,l_amt7,l_amt8 FROM xrce_t
    WHERE xrceent = g_enterprise
      AND xrceld  = g_xrca_t.xrcald
      AND xrcedocno = g_xrca_t.xrcadocno
      AND xrce027 = 'Y'
   IF cl_null(l_amt5) THEN LET l_amt5 = 0 END IF
   IF cl_null(l_amt6) THEN LET l_amt6 = 0 END IF
   IF cl_null(l_amt7) THEN LET l_amt7 = 0 END IF
   IF cl_null(l_amt8) THEN LET l_amt8 = 0 END IF
   
   #20150323--add--str--
   SELECT SUM(xrce109),SUM(xrce119),SUM(xrce129),SUM(xrce139) INTO l_amt5_1,l_amt6_1,l_amt7_1,l_amt8_1 FROM xrce_t
    WHERE xrceent = g_enterprise
      AND xrceld  = g_xrca_t.xrcald
      AND xrcedocno = g_xrca_t.xrcadocno
      AND xrce027 = 'N'
   
   IF cl_null(l_amt5_1) THEN LET l_amt5_1 = 0 END IF
   IF cl_null(l_amt6_1) THEN LET l_amt6_1 = 0 END IF
   IF cl_null(l_amt7_1) THEN LET l_amt7_1 = 0 END IF
   IF cl_null(l_amt8_1) THEN LET l_amt8_1 = 0 END IF
   #20150323--add--end--
   
   #直接繳款金額
   SELECT SUM(xrde109 * CASE WHEN xrde015 = 'D' THEN 1 ELSE -1 END),SUM(xrde119 * CASE WHEN xrde015 = 'D' THEN 1 ELSE -1 END),
          SUM(xrde129 * CASE WHEN xrde015 = 'D' THEN 1 ELSE -1 END),SUM(xrde139 * CASE WHEN xrde015 = 'D' THEN 1 ELSE -1 END)
     INTO l_amt9,l_amt10,l_amt11,l_amt12 FROM xrde_t,gzcb_t
    WHERE xrdeent = g_enterprise
      AND xrdeld  = g_xrca_t.xrcald
      AND xrdedocno = g_xrca_t.xrcadocno
      AND xrde002 = gzcb002
      AND gzcb001 = '8306'
      AND gzcb004 = '1'
      AND xrde002 = '10'
   
  #LET l_amt9 = l_amt10 / g_xrca_t.xrca101   #220150520 Mark By 01727
      
   IF cl_null(l_amt9)  THEN LET l_amt9  = 0 END IF
   IF cl_null(l_amt10) THEN LET l_amt10 = 0 END IF
   IF cl_null(l_amt11) THEN LET l_amt11 = 0 END IF
   IF cl_null(l_amt12) THEN LET l_amt12 = 0 END IF
   
   #直接沖銷帳金額
   #SELECT SUM(xrce109),SUM(xrce119),SUM(xrce129),SUM(xrce139) INTO l_amt13,l_amt14,l_amt15,l_amt16 FROM xrce_t,gzcb_t
   # WHERE xrceent = g_enterprise
   #   AND xrceld  = g_xrca_t.xrcald
   #   AND xrcedocno = g_xrca_t.xrcadocno
   #   AND xrce002 = gzcb002
   #   AND gzcb001 = '8306'
   #   AND gzcb004 = '1'
   #   AND xrce002 <> '10'
      
   #計算帳款
   SELECT SUM(xrce109 * CASE WHEN gzcb003 = 'D' THEN 1 ELSE -1 END),SUM(xrce119 * CASE WHEN gzcb003 = 'D' THEN 1 ELSE -1 END),
          SUM(xrce129 * CASE WHEN gzcb003 = 'D' THEN 1 ELSE -1 END),SUM(xrce139 * CASE WHEN gzcb003 = 'D' THEN 1 ELSE -1 END)
     INTO l_xrce109,l_xrce119,l_xrce129,l_xrce139
     FROM xrce_t,gzcb_t
    WHERE xrceent = g_enterprise
      AND xrceld  = g_xrca_t.xrcald
      AND xrcedocno = g_xrca_t.xrcadocno
      AND gzcb001 = '8306'
      AND gzcb004 = '2'
      AND gzcb002 = xrce002
   IF cl_null(l_xrce109) THEN LET l_xrce109 = 0 END IF
   IF cl_null(l_xrce119) THEN LET l_xrce119 = 0 END IF
   IF cl_null(l_xrce129) THEN LET l_xrce129 = 0 END IF
   IF cl_null(l_xrce139) THEN LET l_xrce139 = 0 END IF
   
   #計算匯差及調整帳款
   SELECT SUM(xrde109 * CASE WHEN gzcb003 = 'D' THEN 1 ELSE -1 END),SUM(xrde119 * CASE WHEN gzcb003 = 'D' THEN 1 ELSE -1 END),
          SUM(xrde129 * CASE WHEN gzcb003 = 'D' THEN 1 ELSE -1 END),SUM(xrde139 * CASE WHEN gzcb003 = 'D' THEN 1 ELSE -1 END)
     INTO l_xrde109,l_xrde119,l_xrde129,l_xrde139
     FROM xrde_t,gzcb_t
    WHERE xrdeent = g_enterprise
      AND xrdeld  = g_xrca_t.xrcald
      AND xrdedocno = g_xrca_t.xrcadocno
      AND xrde002 = gzcb002
      AND gzcb001 = '8306'
      AND xrde002 <> 10
      AND gzcb004 = '1'  

   IF cl_null(l_xrde109) THEN LET l_xrde109 = 0 END IF
   IF cl_null(l_xrde119) THEN LET l_xrde119 = 0 END IF
   IF cl_null(l_xrde129) THEN LET l_xrde129 = 0 END IF
   IF cl_null(l_xrde139) THEN LET l_xrde139 = 0 END IF
   
   LET l_amt13 = l_xrde109 + l_xrce109
   LET l_amt14 = l_xrde119 + l_xrce119
   LET l_amt15 = l_xrde129 + l_xrce129
   LET l_amt16 = l_xrde139 + l_xrce139
   
  #LET l_amt13 = l_amt14 / g_xrca_t.xrca101   #220150520 Mark By 01727

   IF cl_null(l_amt13) THEN LET l_amt13 = 0 END IF
   IF cl_null(l_amt14) THEN LET l_amt14 = 0 END IF
   IF cl_null(l_amt15) THEN LET l_amt15 = 0 END IF
   IF cl_null(l_amt16) THEN LET l_amt16 = 0 END IF
   
   #20150324 这里计算l_amt13和l_amt5_1有重复的地方
   LET l_sum1 = l_amt9  + l_amt13 + l_amt5_1   #20150323 add l_amt5_1
   LET l_sum2 = l_amt10 + l_amt14 + l_amt6_1   #20150323 add l_amt6_1
   LET l_sum3 = l_amt11 + l_amt15 + l_amt7_1   #20150323 add l_amt7_1
   LET l_sum4 = l_amt12 + l_amt16 + l_amt8_1   #20150323 add l_amt8_1
   
   IF l_sum1 < 0 THEN LET l_sum1 = l_sum1 * -1 END IF
   IF l_sum2 < 0 THEN LET l_sum2 = l_sum2 * -1 END IF
   IF l_sum3 < 0 THEN LET l_sum3 = l_sum3 * -1 END IF
   IF l_sum4 < 0 THEN LET l_sum4 = l_sum4 * -1 END IF
   
   LET l_amt17 = l_amt1 - l_sum1
   LET l_amt18 = l_amt2 - l_sum2
   LET l_amt19 = l_amt3 - l_sum3
   LET l_amt20 = l_amt4 - l_sum4

   IF g_glaa_t.glaa015 = 'N' THEN
      CALL cl_set_comp_visible('glaa016',FALSE)
      CALL cl_set_comp_visible('amt3,amt7,amt11,amt15,amt19',FALSE)
   ELSE
      CALL cl_set_comp_visible('glaa016',TRUE)
      CALL cl_set_comp_visible('amt3,amt7,amt11,amt15,amt19',TRUE)
   END IF
   IF g_glaa_t.glaa019 = 'N' THEN
      CALL cl_set_comp_visible('glaa020',FALSE)
      CALL cl_set_comp_visible('amt4,amt8,amt12,amt16,amt20',FALSE)
   ELSE
      CALL cl_set_comp_visible('glaa020',TRUE)
      CALL cl_set_comp_visible('amt4,amt8,amt12,amt16,amt20',TRUE)
   END IF

   DISPLAY l_amt1,l_amt5,l_amt9, l_amt13,l_amt17 TO amt1,amt5,amt9, amt13,amt17
   DISPLAY l_amt2,l_amt6,l_amt10,l_amt14,l_amt18 TO amt2,amt6,amt10,amt14,amt18
   DISPLAY l_amt3,l_amt7,l_amt11,l_amt15,l_amt19 TO amt3,amt7,amt11,amt15,amt19
   DISPLAY l_amt4,l_amt8,l_amt12,l_amt16,l_amt20 TO amt4,amt8,amt12,amt16,amt20
   
   LET g_amt1 = l_sum1
   LET g_amt2 = l_sum2
   LET g_amt3 = l_sum3
   LET g_amt4 = l_sum4
   #20150323--add--str--
   LET g_amt5 = l_amt5
   LET g_amt6 = l_amt6
   LET g_amt7 = l_amt7
   LET g_amt8 = l_amt8
   #20150323--add--end--
   
   LET g_amt_1 = l_amt1
   LET g_amt_9 = l_amt9
   LET g_xrca118 = l_amt2
   LET g_amt = g_amt2 - g_xrca118
END FUNCTION]]>
  </point>
  <point name="function.axrt300_02_chk_xrde109" order="12" ver="4" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[# 10:收款时金额检查
PRIVATE FUNCTION axrt300_02_chk_xrde109()
   DEFINE l_tot1         LIKE nmbb_t.nmbb006   #原幣金額
   DEFINE l_tot2         LIKE nmbb_t.nmbb007   #本幣金額
   DEFINE l_amt1         LIKE nmbb_t.nmbb008   #已沖原幣金額  主帳套
   DEFINE l_amt2         LIKE nmbb_t.nmbb009   #已沖本幣金額  主帳套
   DEFINE l_amt3         LIKE nmbb_t.nmbb020   #已沖原幣金額  次帳套一
   DEFINE l_amt4         LIKE nmbb_t.nmbb021   #已沖本幣金額  次帳套一
   DEFINE l_amt5         LIKE nmbb_t.nmbb023   #已沖原幣金額  次帳套二
   DEFINE l_amt6         LIKE nmbb_t.nmbb024   #已沖本幣金額  次帳套二
   DEFINE l_errno1       LIKE gzze_t.gzze001
   DEFINE l_count        LIKE type_t.num5
   DEFINE l_ld_s         LIKE type_t.num5
 
   LET g_errno = ' '
 
   #檢查是否是主帳套
   LET l_count = 0
   SELECT COUNT(*) INTO l_count FROM glaa_t
    WHERE glaaent = g_enterprise
      AND glaald  = g_xrca_t.xrcald
      AND glaa014 = 'Y'
   IF l_count > 0 THEN
     LET l_ld_s = 1
   ELSE
      #次帳套一
      LET l_count = 0
      SELECT COUNT(*) INTO l_count FROM ooab_t WHERE ooab001 = 'S-FIN-0001' AND ooab002 = g_xrca_t.xrcald
                  AND ooabsite= g_xrca_t.xrcasite
      IF l_count > 0 THEN
         LET l_ld_s = 2
      END IF
      #次帳套二
      LET l_count = 0
      SELECT COUNT(*) INTO l_count FROM ooab_t WHERE ooab001 = 'S-FIN-0002' AND ooab002 = g_xrda_m.xrdald
                  AND ooabsite= g_xrca_t.xrcasite
      IF l_count > 0 THEN
         LET l_ld_s = 3
      END IF
   END IF
   
   CASE
      WHEN g_xrce_d[l_ac].xrce006 = '10' OR g_xrce_d[l_ac].xrce006 = '20' OR g_xrce_d[l_ac].xrce006 = '30'
         #檢查銀存收支明細檔(nmbb_t)
         SELECT nmbb006,nmbb007,nmbb008,nmbb009,nmbb020,nmbb021,nmbb023,nmbb024
           INTO l_tot1,l_tot2,l_amt1,l_amt2,l_amt3,l_amt4,l_amt5,l_amt6
           FROM nmbb_t
          WHERE nmbbent  = g_enterprise
            AND nmbbdocno= g_xrce_d[l_ac].xrce003
            AND nmbbseq  = g_xrce_d[l_ac].xrce004
         LET l_errno1 = 'axr-00054'
   END CASE
   
   IF l_ld_s = 1 THEN
      LET l_tot1 = l_tot1 - l_amt1
      LET l_tot2 = l_tot2 - l_amt2
   ELSE
      IF l_ld_s = 2 THEN
        LET l_tot1 = l_tot1 - l_amt3
        LET l_tot2 = l_tot2 - l_amt4
      ELSE
        LET l_tot1 = l_tot1 - l_amt5
        LET l_tot2 = l_tot2 - l_amt6
      END IF
   END IF
   IF l_tot1 < g_xrce_d[l_ac].xrce109 OR l_tot2 < g_xrce_d[l_ac].xrce119 THEN
      LET g_errno = l_errno1 RETURN
   END IF
END FUNCTION]]>
  </point>
  <point name="function.axrt300_02_chk_xrde003" order="13" ver="4" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[# 10:收款单号检查
PRIVATE FUNCTION axrt300_02_chk_xrde003()
   DEFINE l_SQLCODE      LIKE type_t.chr20
   DEFINE l_stus         LIKE nmba_t.nmbastus
   DEFINE l_errno1       LIKE gzze_t.gzze001
   DEFINE l_errno2       LIKE gzze_t.gzze001
   DEFINE l_errno3       LIKE gzze_t.gzze001
   DEFINE l_errno4       LIKE gzze_t.gzze001
   DEFINE l_errno5       LIKE gzze_t.gzze001
   DEFINE l_count        LIKE type_t.num5
   DEFINE l_ld_s         LIKE type_t.num5      #帳套   1:主帳套;2:次帳套一;3:次帳套二
   DEFINE l_tot1         LIKE nmbb_t.nmbb006   #原幣金額
   DEFINE l_tot2         LIKE nmbb_t.nmbb007   #本幣金額
   DEFINE l_amt1         LIKE nmbb_t.nmbb008   #已沖原幣金額  主帳套
   DEFINE l_amt2         LIKE nmbb_t.nmbb009   #已沖本幣金額  主帳套
   DEFINE l_amt3         LIKE nmbb_t.nmbb020   #已沖原幣金額  次帳套一
   DEFINE l_amt4         LIKE nmbb_t.nmbb021   #已沖本幣金額  次帳套一
   DEFINE l_amt5         LIKE nmbb_t.nmbb023   #已沖原幣金額  次帳套二
   DEFINE l_amt6         LIKE nmbb_t.nmbb024   #已沖本幣金額  次帳套二
   DEFINE l_nmcnstus     LIKE nmcn_t.nmcnstus
   DEFINE l_nmba004      LIKE nmba_t.nmba004
   DEFINE l_pmaa069      LIKE pmaa_t.pmaa069
   DEFINE l_pmaa006      LIKE pmaa_t.pmaa006
   DEFINE l_pmaa006_1    LIKE pmaa_t.pmaa006
   DEFINE l_flag         LIKE type_t.chr2
   DEFINE l_cnt          LIKE type_t.num5

   #檢查是否是主帳套
   LET l_count = 0
   SELECT COUNT(*) INTO l_count FROM glaa_t
    WHERE glaaent = g_enterprise
      AND glaald  = g_xrca_t.xrcald
      AND glaa014 = 'Y'
   IF l_count > 0 THEN
     LET l_ld_s = 1
   ELSE
      #次帳套一
      LET l_count = 0
      SELECT COUNT(*) INTO l_count FROM ooab_t WHERE ooab001 = 'S-FIN-0001' AND ooab002 = g_xrca_t.xrcald 
         AND ooabsite= g_xrca_t.xrcasite
      IF l_count > 0 THEN
         LET l_ld_s = 2
      END IF
      #次帳套二
      LET l_count = 0
      SELECT COUNT(*) INTO l_count FROM ooab_t WHERE ooab001 = 'S-FIN-0002' AND ooab002 = g_xrca_t.xrcald
         AND ooabsite= g_xrca_t.xrcasite
      IF l_count > 0 THEN
         LET l_ld_s = 3
      END IF
   END IF
   
   LET g_errno = ' '
   IF g_xrce_d[l_ac].xrce002 = '10' THEN
      CASE
         WHEN g_xrce_d[l_ac].xrce006 = '10' OR  g_xrce_d[l_ac].xrce006 = '20' OR  g_xrce_d[l_ac].xrce006 = '30'   #現金類型 OR #銀行電匯款
            #檢查資料1:存在性、有效性;2.已確認;3.可沖金額大於0
            SELECT nmbastus,nmba004 INTO l_stus,l_nmba004 FROM nmba_t
             WHERE nmbaent  = g_enterprise
               AND nmbadocno= g_xrce_d[l_ac].xrce003
            LET l_SQLCODE = SQLCA.SQLCODE
            IF NOT SQLCA.SQLCODE AND NOT cl_null(g_xrce_d[l_ac].xrce004) THEN
               SELECT nmbb006,nmbb007,nmbb008,nmbb009,nmbb020,nmbb021,nmbb023,nmbb024
                 INTO l_tot1,l_tot2,l_amt1,l_amt2,l_amt3,l_amt4,l_amt5,l_amt6
                 FROM nmbb_t
                WHERE nmbbent  = g_enterprise
                  AND nmbbdocno= g_xrce_d[l_ac].xrce003
                  AND nmbbseq  = g_xrce_d[l_ac].xrce004
               IF SQLCA.SQLCODE = 100 THEN LET l_SQLCODE = SQLCA.SQLCODE END IF
            END IF
            #對象合理性判斷
            SELECT nmbb026 INTO l_nmba004 FROM nmbb_t WHERE nmbbent  = g_enterprise
               AND nmbbdocno= g_xrce_d[l_ac].xrce003
               AND nmbbseq  = g_xrce_d[l_ac].xrce004
            IF l_nmba004 <> g_xrca_t.xrca005 THEN
               SELECT pmaa069 INTO l_pmaa069 FROM pmaa_t
                WHERE pmaaent = g_enterprise
                  AND pmaa001 = l_nmba004
               IF l_pmaa069 = 'N' OR cl_null(l_pmaa069) THEN
                  LET l_errno5 = 'axr-00070'   #該交易單據非帳款核銷客戶!
               ELSE
                  #收款客戶、核銷客戶是否屬於同一集團
                  SELECT pmaa006 INTO l_pmaa006   FROM pmaa_t WHERE pmaaent = g_enterprise
                     AND pmaa001 = g_xrca_t.xrca005
                  SELECT pmaa006 INTO l_pmaa006_1 FROM pmaa_t WHERE pmaaent = g_enterprise
                     AND pmaa001 = g_xrca_t.xrca004
                  IF NOT cl_null(l_pmaa006_1) AND NOT cl_null(l_pmaa006) AND l_pmaa006_1 != l_pmaa006 THEN LET l_flag = 'N' END IF
                  IF (cl_null(l_pmaa006_1) AND NOT cl_null(l_pmaa006)) OR (NOT cl_null(l_pmaa006_1) AND cl_null(l_pmaa006)) THEN LET l_flag = 'N' END IF
            
                  #檢核夥伙關係(pmac_t)中,有無設定
                  LET l_cnt = 0
                  SELECT COUNT(*) INTO l_cnt FROM pmac_t WHERE pmacent = g_enterprise AND pmac001 = g_xrca_t.xrca005
                     AND pmacstus = 'Y' AND pmac003 = '1' AND pmac002 = g_xrca_t.xrca004
                  IF l_cnt < 1 THEN LET l_flag = l_flag,'N' END IF
            
                  IF l_flag = 'NN' THEN
                     LET l_errno5 = 'agl-00153'
                  ELSE
                     LET l_errno5 = 'agl-00154'
                  END IF
               END IF
            END IF
            LET l_errno1 = 'axr-00051'
            LET l_errno2 = 'axr-00052'
            LET l_errno3 = 'axr-00053'
            LET l_errno4 = 'axr-00054'
      END CASE
      IF l_ld_s = 1 THEN
         LET l_tot1 = l_tot1 - l_amt1
         LET l_tot2 = l_tot2 - l_amt2
      ELSE
         IF l_ld_s = 2 THEN
           LET l_tot1 = l_tot1 - l_amt3
           LET l_tot2 = l_tot2 - l_amt4
         ELSE
           LET l_tot1 = l_tot1 - l_amt5
           LET l_tot2 = l_tot2 - l_amt6
         END IF
      END IF
      CASE
         WHEN l_SQLCODE = '100'
            LET g_errno = l_errno1 RETURN
         WHEN l_stus = 'X'
            LET g_errno = l_errno2 RETURN
         WHEN l_stus = 'N'
            LET g_errno = l_errno3 RETURN
         WHEN l_tot1 = 0 OR l_tot2 = 0
            LET g_errno = l_errno4 RETURN
      END CASE
      IF cl_null(g_errno) AND NOT cl_null(l_errno5) THEN
         LET g_errno = l_errno5
      END IF
   END IF
END FUNCTION]]>
  </point>
  <point name="function.axrt300_02_acc_def" order="14" ver="7" cite_std="N" new="Y" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
################################################################################
# Descriptions...: 科目是否啟用現金變動碼、默認值
# Memo...........:
# Usage..........: CALL s_aooi150_ins (传入参数)
#                  RETURNING 回传参数
# Input parameter: 传入参数变量1   传入参数变量说明1
#                : 传入参数变量2   传入参数变量说明2
# Return code....: 回传参数变量1   回传参数变量说明1
#                : 回传参数变量2   回传参数变量说明2
# Date & Author..: 日期 By 作者
# Modify.........:
################################################################################
PRIVATE FUNCTION axrt300_02_acc_def()
   DEFINE l_glaa004         LIKE glaa_t.glaa004
   DEFINE l_glaa005         LIKE glaa_t.glaa005
   DEFINE l_glac016         LIKE glac_t.glac016

   SELECT glaa004,glaa005 INTO l_glaa004,l_glaa005 FROM glaa_t
    WHERE glaaent = g_enterprise AND glaald  = g_xrca_t.xrcald

   SELECT glac016 INTO l_glac016 FROM glac_t
    WHERE glacent = g_enterprise AND glac001 = l_glaa004 AND glac002 = g_xrce_d[l_ac].xrce016

   IF cl_null(l_glac016) OR l_glac016 = 'N' THEN
      LET g_xrce_d[l_ac].xrde012 = ''
   ELSE
      SELECT glad006 INTO g_xrce_d[l_ac].xrde012 FROM glad_t WHERE gladent = g_enterprise
         AND gladld = g_xrca_t.xrcald
         AND glad001= g_xrce_d[l_ac].xrce016
   END IF

   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = l_glaa005
   LET g_ref_fields[2] = g_xrce_d[l_ac].xrde012
   CALL ap_ref_array2(g_ref_fields,"SELECT nmail004 FROM nmail_t WHERE nmailent='"||g_enterprise||"' AND nmail001=? AND nmail002=? AND nmail003='"||g_dlang||"'","")
      RETURNING g_rtn_fields
   LET g_xrce_d[l_ac].xrde012_u_desc = '', g_rtn_fields[1] , ''

END FUNCTION]]>
  </point>
  <point name="b_fill.define" order="" ver="7" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   DEFINE l_gzcb004      LIKE gzcb_t.gzcb004
   DEFINE l_glaa004         LIKE glaa_t.glaa004
   DEFINE l_glaa005         LIKE glaa_t.glaa005]]>
  </point>
  <point name="b_fill.fill" order="" ver="9" cite_std="N" new="N" status="u" src="s" readonly="" mark_hard="N">
    <![CDATA[      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_xrce_d[l_ac].xrce016
      CALL ap_ref_array2(g_ref_fields,"SELECT glacl004 FROM glacl_t WHERE glaclent='"||g_enterprise||"' AND glacl001='"||g_glaa_t.glaa004||"' AND glacl002=? AND glacl003='"||g_lang||"'","") RETURNING g_rtn_fields
      LET g_xrce_d[l_ac].xrce016_desc_1 = '', g_rtn_fields[1] , ''

      LET g_xrce3_d[l_ac].xrce016 = g_xrce_d[l_ac].xrce016
      LET g_xrce3_d[l_ac].xrce016_u_desc = g_xrce_d[l_ac].xrce016_desc_1

      LET g_xrce3_d[l_ac].xrce010 = g_xrce_d[l_ac].xrce010

      SELECT gzcb004 INTO l_gzcb004
        FROM gzcb_t
       WHERE gzcb001 = '8306'
         AND gzcb002 = g_xrce_d[l_ac].xrce002
      IF l_gzcb004 = '1' THEN
         SELECT xrde012 INTO g_xrce_d[l_ac].xrde012 FROM xrde_t
          WHERE xrdeent = g_enterprise
            AND xrdedocno = g_xrce_d[l_ac].xrcedocno
            AND xrdeld   = g_xrce_d[l_ac].xrceld
      END IF

      SELECT xrde012 INTO g_xrce_d[l_ac].xrde012 FROM xrde_t WHERE xrdeent = g_enterprise
         AND xrdeld = g_xrca_t.xrcald
         AND xrdedocno = g_xrca_t.xrcadocno
         AND xrdeseq = g_xrce_d[l_ac].xrceseq
       INITIALIZE g_ref_fields TO NULL
       LET g_ref_fields[1] = l_glaa005
       LET g_ref_fields[2] = g_xrce_d[l_ac].xrde012
       CALL ap_ref_array2(g_ref_fields,"SELECT nmail004 FROM nmail_t WHERE nmailent='"||g_enterprise||"' AND nmail001=? AND nmail002=? AND nmail003='"||g_dlang||"'","")
          RETURNING g_rtn_fields
       LET g_xrce_d[l_ac].xrde012_u_desc = '', g_rtn_fields[1] , ''

       SELECT xrde007 INTO g_xrce_d[l_ac].xrde007 FROM xrde_t WHERE xrdeent = g_enterprise
         AND xrdeld = g_xrca_t.xrcald
         AND xrdedocno = g_xrca_t.xrcadocno
         AND xrdeseq = g_xrce_d[l_ac].xrceseq

       INITIALIZE g_ref_fields TO NULL
       LET g_ref_fields[1] = g_xrce_d[l_ac].xrde007
       CALL ap_ref_array2(g_ref_fields,"SELECT ooial003 FROM ooial_t WHERE ooialent='"||g_enterprise||"' AND ooial001=? AND ooial002='"||g_dlang||"'","") RETURNING g_rtn_fields
       LET g_xrce_d[l_ac].xrde007_desc = '', g_rtn_fields[1] , ''


#      INITIALIZE g_ref_fields TO NULL
#      LET g_ref_fields[1] = g_xrce3_d[l_ac].xrce017
#      CALL ap_ref_array2(g_ref_fields,"SELECT ooag011 FROM ooag_t WHERE ooagent='"||g_enterprise||"' AND ooag001=? ","") RETURNING g_rtn_fields
#      LET g_xrce3_d[l_ac].xrce017_desc = '', g_rtn_fields[1] , ''
#      DISPLAY BY NAME g_xrce3_d[l_ac].xrce017_desc
#            
#      INITIALIZE g_ref_fields TO NULL
#      LET g_ref_fields[1] = g_xrce3_d[l_ac].xrce019
#      CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_lang||"'","") RETURNING g_rtn_fields
#      LET g_xrce3_d[l_ac].xrce019_desc = '', g_rtn_fields[1] , ''
#      DISPLAY BY NAME g_xrce3_d[l_ac].xrce019_desc
#      
#      
#      INITIALIZE g_ref_fields TO NULL
#      LET g_ref_fields[1] = g_xrce3_d[l_ac].xrce020
#      CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='200' AND oocql002=? AND oocql003='"||g_lang||"'","") RETURNING g_rtn_fields
#      LET g_xrce3_d[l_ac].xrce020_desc = '', g_rtn_fields[1] , ''
#      DISPLAY BY NAME g_xrce3_d[l_ac].xrce020_desc]]>
  </point>
  <point name="b_fill.others.fill" order="" ver="4" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   FOR l_ac = 1 TO g_xrce_d.getLength()
      #page2
      LET g_xrce2_d[l_ac].xrce002 = g_xrce_d[l_ac].xrce002
      LET g_xrce2_d[l_ac].xrce006 = g_xrce_d[l_ac].xrce006
      LET g_xrce2_d[l_ac].xrce003 = g_xrce_d[l_ac].xrce003
      LET g_xrce2_d[l_ac].xrce004 = g_xrce_d[l_ac].xrce004
      LET g_xrce2_d[l_ac].xrce100 = g_xrce_d[l_ac].xrce100
      LET g_xrce2_d[l_ac].xrce109 = g_xrce_d[l_ac].xrce109
      LET g_xrce2_d[l_ac].xrce101 = g_xrce_d[l_ac].xrce101
      LET g_xrce2_d[l_ac].xrce119 = g_xrce_d[l_ac].xrce119
      
      #page3
      LET g_xrce3_d[l_ac].xrce002 = g_xrce_d[l_ac].xrce002
      LET g_xrce3_d[l_ac].xrce006 = g_xrce_d[l_ac].xrce006
      LET g_xrce3_d[l_ac].xrce003 = g_xrce_d[l_ac].xrce003
      LET g_xrce3_d[l_ac].xrce004 = g_xrce_d[l_ac].xrce004
      LET g_xrce3_d[l_ac].xrce005 = g_xrce_d[l_ac].xrce005
      LET g_xrce3_d[l_ac].xrce008 = g_xrce_d[l_ac].xrce008
      LET g_xrce3_d[l_ac].xrce100 = g_xrce_d[l_ac].xrce100
      LET g_xrce_d[l_ac].xrce109 = g_xrce_d[l_ac].xrce109
      LET g_xrce3_d[l_ac].xrce101 = g_xrce_d[l_ac].xrce101
      LET g_xrce3_d[l_ac].xrce119 = g_xrce_d[l_ac].xrce119
      LET g_xrce3_d[l_ac].xrce027 = g_xrce_d[l_ac].xrce027
      
   END FOR]]>
  </point>
  <point name="b_fill.sql_after" order="" ver="7" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   LET g_sql = "SELECT  UNIQUE t0.xrce001,t0.xrcedocno,t0.xrceld,t0.xrcesite,t0.xrceseq,t0.xrce002,t0.xrce006,                ",
               "        t0.xrce003,t0.xrce004,t0.xrce005,t0.xrce024,t0.xrce025,t0.xrce008,t0.xrce015,t0.xrce100,t0.xrce101,   ",
               "        t0.xrce109,t0.xrce119,t0.xrce027,t0.xrce028,t0.xrce104,t0.xrce114,t0.xrce124,t0.xrce134,t0.xrcecomp,  ",
               "        t0.xrceorga,t0.xrce010,t0.xrce016,t0.xrce001,t0.xrcedocno,t0.xrceld,t0.xrcesite,t0.xrceseq,t0.xrce002,", 
               "        t0.xrce006,t0.xrce003,t0.xrce004,t0.xrce008,t0.xrce100,t0.xrce109,t0.xrce101,t0.xrce119,t0.xrce120,   ",
               "        t0.xrce121,t0.xrce129,t0.xrce130,t0.xrce131,t0.xrce139,t0.xrce001,t0.xrcedocno,t0.xrceld,t0.xrcesite, ",
               "        t0.xrceseq,t0.xrce002,t0.xrce006,t0.xrce003,t0.xrce004,t0.xrce005,t0.xrce008,t0.xrce100,t0.xrce109,   ",
               "        t0.xrce101,t0.xrce119,t0.xrce027,t0.xrce010,t0.xrce016,t0.xrce017,t0.xrce018,t0.xrce019,t0.xrce020,   ",
               "        t0.xrce022,t0.xrce023 ,t1.ooag011 ,t2.ooefl003 ,t3.ooefl003 ,t4.rtaxl003 FROM xrce_t t0",             
               " LEFT JOIN ooag_t t1 ON t1.ooagent='"||g_enterprise||"' AND t1.ooag001=t0.xrce017  ",
               " LEFT JOIN ooefl_t t2 ON t2.ooeflent='"||g_enterprise||"' AND t2.ooefl001=t0.xrce018 AND t2.ooefl002='"||g_dlang||"' ",
               " LEFT JOIN ooefl_t t3 ON t3.ooeflent='"||g_enterprise||"' AND t3.ooefl001=t0.xrce019 AND t3.ooefl002='"||g_dlang||"' ",
               " LEFT JOIN rtaxl_t t4 ON t4.rtaxlent='"||g_enterprise||"' AND t4.rtaxl001=t0.xrce020 AND t4.rtaxl002='"||g_dlang||"' ",
 
               " WHERE t0.xrceent= ?  AND  1=1 AND (", p_wc2, ") " 
   
   LET p_wc2 = cl_replace_str(p_wc2,'xrcedocno','xrdedocno')
   LET p_wc2 = cl_replace_str(p_wc2,'xrceld','xrdeld')
   LET p_wc2 = cl_replace_str(p_wc2,'xrceseq','xrdeseq')
   LET g_sql = g_sql," UNION ",
               "SELECT  UNIQUE t5.xrde001,t5.xrdedocno,t5.xrdeld,t5.xrdesite,t5.xrdeseq,t5.xrde002,t5.xrde006, 
                t5.xrde003,t5.xrde004,0,'',0,t5.xrde008,t5.xrde015,t5.xrde100,t5.xrde101,t5.xrde109, 
                t5.xrde119,'N',t5.xrde028,0,0,0, 
                0,t5.xrdecomp,t5.xrdeorga,t5.xrde010,t5.xrde016,t5.xrde001,t5.xrdedocno,t5.xrdeld,t5.xrdesite,t5.xrdeseq,t5.xrde002, 
                t5.xrde006,t5.xrde003,t5.xrde004,t5.xrde008,t5.xrde100,t5.xrde109,t5.xrde101,t5.xrde119,t5.xrde120, 
                t5.xrde121,t5.xrde129,t5.xrde130,t5.xrde131,t5.xrde139,t5.xrde001,t5.xrdedocno,t5.xrdeld,t5.xrdesite, 
                t5.xrdeseq,t5.xrde002,t5.xrde006,t5.xrde003,t5.xrde004,0,t5.xrde008,t5.xrde100,t5.xrde109, 
                t5.xrde101,t5.xrde119,'',t5.xrde010,t5.xrde016,t5.xrde017,t5.xrde018,t5.xrde019,t5.xrde020, 
                t5.xrde022,t5.xrde023,t6.ooag011 ,t7.ooefl003 ,t8.ooefl003 ,t9.rtaxl003 FROM xrde_t t5", 
               " LEFT JOIN ooag_t t6 ON t6.ooagent='"||g_enterprise||"' AND t6.ooag001=t5.xrde017  ",
               " LEFT JOIN ooefl_t t7 ON t7.ooeflent='"||g_enterprise||"' AND t7.ooefl001=t5.xrde018 AND t7.ooefl002='"||g_dlang||"' ",
               " LEFT JOIN ooefl_t t8 ON t8.ooeflent='"||g_enterprise||"' AND t8.ooefl001=t5.xrde019 AND t8.ooefl002='"||g_dlang||"' ",
               " LEFT JOIN rtaxl_t t9 ON t9.rtaxlent='"||g_enterprise||"' AND t9.rtaxl001=t5.xrde020 AND t9.rtaxl002='"||g_dlang||"' ",
 
               " WHERE t5.xrdeent= '",g_enterprise,"' AND  1=1 AND (", p_wc2, ") " 
]]>
  </point>
  <point name="b_fill.sql_before" order="" ver="7" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
   SELECT glaa004,glaa005 INTO l_glaa004,l_glaa005 FROM glaa_t
    WHERE glaaent = g_enterprise AND glaald  = g_xrca_t.xrcald
]]>
  </point>
  <point name="construct.c.page1.xrce016" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #應用 a08 樣板自動產生(Version:2)
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c' 
            LET g_qryparam.reqry = FALSE
            CALL aglt310_04()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xrce016  #顯示到畫面上
            NEXT FIELD xrce016                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page3.xrce010_u" order="" ver="2" cite_std="" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_oocq002_2()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xrce010_u  #顯示到畫面上
            NEXT FIELD xrce010_u                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page3.xrce016_u" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #應用 a08 樣板自動產生(Version:2)
            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c' 
            LET g_qryparam.reqry = FALSE
            CALL aglt310_04()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xrce016_u  #顯示到畫面上
            NEXT FIELD xrce016_u                     #返回原欄位
    

]]>
  </point>
  <point name="construct.c.page3.xrce018_u" order="" ver="4" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooef001_13()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xrce018_u  #顯示到畫面上

            NEXT FIELD xrce018_u                     #返回原欄位

]]>
  </point>
  <point name="construct.c.page3.xrce019" order="" ver="4" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooef001_13()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xrce019  #顯示到畫面上

            NEXT FIELD xrce019                     #返回原欄位

]]>
  </point>
  <point name="delete.body.b_delete" order="" ver="4" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[         SELECT gzcb004 INTO l_gzcb004
           FROM gzcb_t
          WHERE gzcb001 = '8306'
            AND gzcb002 = g_xrce_d[li_idx].xrce002
         IF l_gzcb004 = '2' THEN ]]>
  </point>
  <point name="delete.body.before_delete" order="" ver="5" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="delete.body.m_delete" order="" ver="4" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[         ELSE
            DELETE FROM xrde_t
             WHERE xrdeent = g_enterprise 
               AND xrdeld = g_xrce_d[li_idx].xrceld
               AND xrdedocno = g_xrce_d[li_idx].xrcedocno
               AND xrdeseq = g_xrce_d[li_idx].xrceseq
         END IF]]>
  </point>
  <point name="delete.define" order="" ver="4" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   DEFINE l_gzcb004       LIKE gzcb_t.gzcb004]]>
  </point>
  <point name="delete_b.b_delete" order="" ver="4" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[      SELECT gzcb004 INTO l_gzcb004
        FROM gzcb_t
       WHERE gzcb001 = '8306'
         AND gzcb002 = g_xrce_d[l_ac].xrce002
      IF l_gzcb004 = '2' THEN ]]>
  </point>
  <point name="delete_b.define" order="" ver="4" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   DEFINE l_gzcb004   LIKE gzcb_t.gzcb004]]>
  </point>
  <point name="delete_b.m_delete" order="" ver="4" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[      ELSE
         DELETE FROM xrde_t
          WHERE xrdeent = g_enterprise 
            AND xrdeld = ps_keys_bak[1] AND xrdedocno = ps_keys_bak[2] AND xrdeseq = ps_keys_bak[3]
      END IF]]>
  </point>
  <point name="detail_show.before" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   CALL axrt300_02_set_entry_b("a")
   CALL axrt300_02_set_no_entry_b("a")]]>
  </point>
  <point name="detail_show.body2.reference" order="" ver="7" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   #150311-00003#2 By   01727 Add  ---(S)---
   IF g_xrce_d[l_ac].xrce006 = '90' THEN 
      CALL cl_set_comp_required('xrce003,xrce004',FALSE)
   ELSE
      CALL cl_set_comp_required('xrce003,xrce004',TRUE)
   END IF

   IF NOT cl_null(g_xrce_d[l_ac].xrce003) AND g_xrce_d[l_ac].xrce002 = '10' THEN
      CALL cl_set_comp_entry('xrce100',FALSE)
   ELSE
      CALL cl_set_comp_entry('xrce100',TRUE)
   END IF
   SELECT gzcb004 INTO l_gzcb004 FROM gzcb_t WHERE gzcb001 = '8306' AND gzcb002 = g_xrce_d[l_ac].xrce002
   IF l_gzcb004 <> '1' THEN
      CALL cl_set_comp_entry('xrde012_u',FALSE)
   ELSE
      CALL cl_set_comp_entry('xrde012_u',TRUE)
   END IF
   #150311-00003#2 By   01727 Add  ---(E)---]]>
  </point>
  <point name="detail_show.body3.reference" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   FOR l_i = 1 TO g_detail_cnt
      LET g_xrce2_d[l_ac].xrceld = g_xrce_d[l_ac].xrceld 
      LET g_xrce2_d[l_ac].xrcedocno = g_xrce_d[l_ac].xrcedocno 
      LET g_xrce2_d[l_ac].xrceseq = g_xrce_d[l_ac].xrceseq 
  
      LET g_xrce3_d[l_ac].xrceld = g_xrce_d[l_ac].xrceld 
      LET g_xrce3_d[l_ac].xrcedocno = g_xrce_d[l_ac].xrcedocno 
      LET g_xrce3_d[l_ac].xrceseq = g_xrce_d[l_ac].xrceseq 
    
       #page2
      LET g_xrce2_d[l_ac].xrce002 = g_xrce_d[l_ac].xrce002
      LET g_xrce2_d[l_ac].xrce006 = g_xrce_d[l_ac].xrce006
      LET g_xrce2_d[l_ac].xrce003 = g_xrce_d[l_ac].xrce003
      LET g_xrce2_d[l_ac].xrce004 = g_xrce_d[l_ac].xrce004
      LET g_xrce2_d[l_ac].xrce100 = g_xrce_d[l_ac].xrce100
      LET g_xrce2_d[l_ac].xrce109 = g_xrce_d[l_ac].xrce109
      LET g_xrce2_d[l_ac].xrce101 = g_xrce_d[l_ac].xrce101
      LET g_xrce2_d[l_ac].xrce119 = g_xrce_d[l_ac].xrce119
       
       #page3
      LET g_xrce3_d[l_ac].xrce002 = g_xrce_d[l_ac].xrce002
      LET g_xrce3_d[l_ac].xrce006 = g_xrce_d[l_ac].xrce006
      LET g_xrce3_d[l_ac].xrce003 = g_xrce_d[l_ac].xrce003
      LET g_xrce3_d[l_ac].xrce004 = g_xrce_d[l_ac].xrce004
      LET g_xrce3_d[l_ac].xrce005 = g_xrce_d[l_ac].xrce005
      LET g_xrce3_d[l_ac].xrce008 = g_xrce_d[l_ac].xrce008
      LET g_xrce3_d[l_ac].xrce100 = g_xrce_d[l_ac].xrce100
      LET g_xrce3_d[l_ac].xrce109 = g_xrce_d[l_ac].xrce109
      LET g_xrce3_d[l_ac].xrce101 = g_xrce_d[l_ac].xrce101
      LET g_xrce3_d[l_ac].xrce119 = g_xrce_d[l_ac].xrce119
      LET g_xrce3_d[l_ac].xrce027 = g_xrce_d[l_ac].xrce027

      INITIALIZE g_ref_fields TO NULL
      LET g_ref_fields[1] = g_xrce3_d[l_ac].xrce016
      CALL ap_ref_array2(g_ref_fields,"SELECT glacl004 FROM glacl_t WHERE glaclent='"||g_enterprise||"' AND glacl001='"||g_glaa_t.glaa004||"' AND glacl002=? AND glacl003='"||g_lang||"'","") RETURNING g_rtn_fields
      LET g_xrce_d[l_ac].xrce016_desc_1 = '', g_rtn_fields[1] , ''
      
#      INITIALIZE g_ref_fields TO NULL
#      LET g_ref_fields[1] = g_xrce3_d[l_ac].xrce017
#      CALL ap_ref_array2(g_ref_fields,"SELECT ooag011 FROM ooag_t WHERE ooagent='"||g_enterprise||"' AND ooag001=? ","") RETURNING g_rtn_fields
#      LET g_xrce3_d[l_ac].xrce017_desc = '', g_rtn_fields[1] , ''
#      DISPLAY BY NAME g_xrce3_d[l_ac].xrce017_desc
#            
#      INITIALIZE g_ref_fields TO NULL
#      LET g_ref_fields[1] = g_xrce3_d[l_ac].xrce019
#      CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_lang||"'","") RETURNING g_rtn_fields
#      LET g_xrce3_d[l_ac].xrce019_desc = '', g_rtn_fields[1] , ''
#      DISPLAY BY NAME g_xrce3_d[l_ac].xrce019_desc
#      
#      INITIALIZE g_ref_fields TO NULL
#      LET g_ref_fields[1] = g_xrce3_d[l_ac].xrce020
#      CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='200' AND oocql002=? AND oocql003='"||g_lang||"'","") RETURNING g_rtn_fields
#      LET g_xrce3_d[l_ac].xrce020_desc = '', g_rtn_fields[1] , ''
#      DISPLAY BY NAME g_xrce3_d[l_ac].xrce020_desc
   END FOR]]>
  </point>
  <point name="detail_show.define" order="" ver="7" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   DEFINE l_i     LIKE type_t.num5
   DEFINE l_gzcb004   LIKE gzcb_t.gzcb004]]>
  </point>
  <point name="global.memo" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#150311-00003#2 By   01727 xrce027 = 'Y'的資料寫入xrca106其他資料寫入xrca107]]>
  </point>
  <point name="global.variable" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[DEFINE g_xrca_t              RECORD LIKE xrca_t.*
DEFINE g_glaa_t              RECORD LIKE glaa_t.*
DEFINE g_xrce_t              RECORD LIKE xrce_t.*
DEFINE g_msg                 LIKE type_t.chr80
DEFINE g_amt                 LIKE xrde_t.xrde109
DEFINE g_amt1                LIKE xrde_t.xrde109
DEFINE g_amt2                LIKE xrde_t.xrde109
DEFINE g_amt3                LIKE xrde_t.xrde109
DEFINE g_amt4                LIKE xrde_t.xrde109
#20150323--add--str--
DEFINE g_amt5                LIKE xrde_t.xrde109
DEFINE g_amt6                LIKE xrde_t.xrde109
DEFINE g_amt7                LIKE xrde_t.xrde109
DEFINE g_amt8                LIKE xrde_t.xrde109
#20150323--add--end--
DEFINE g_xrca118             LIKE xrca_t.xrca108
DEFINE g_amt_1               LIKE xrde_t.xrde109
DEFINE g_amt_2               LIKE xrde_t.xrde109
DEFINE g_amt_9               LIKE xrde_t.xrde109
DEFINE g_amt_10              LIKE xrde_t.xrde109]]>
  </point>
  <point name="init.define" order="" ver="9" cite_std="N" new="N" status="u" src="s" readonly="" mark_hard="N">
    <![CDATA[   DEFINE l_sql      STRING
   DEFINE l_str      STRING
   DEFINE l_str1     STRING
   DEFINE l_gzcb002  LIKE gzcb_t.gzcb002
   DEFINE l_ooab002  LIKE ooab_t.ooab002]]>
  </point>
  <point name="init.init" order="" ver="9" cite_std="N" new="N" status="u" src="s" readonly="" mark_hard="N">
    <![CDATA[   #CALL cl_set_combo_scc('xrce006_t','8310')
   #CALL cl_set_combo_scc('xrce006_u','8310')
   
   #xrce006下拉菜單取值,SCC_8310 AND gzcb002<>'ZZ'
   LET l_str = Null
   LET l_gzcb002 = Null
   LET l_str1 = " AND gzcb002 <> 'ZZ'"
   LET l_sql = "SELECT gzcb002 FROM gzcb_t WHERE gzcb001 = '8310' "
   IF g_prog <> 'axrt350'  THEN
      LET l_sql = l_sql,l_str1
   END IF
   PREPARE axrt300_02_xrce006_prep FROM l_sql
   DECLARE axrt300_02_xrce006_curs CURSOR FOR axrt300_02_xrce006_prep
   LET l_str = Null
   LET l_gzcb002 = Null
   FOREACH axrt300_02_xrce006_curs INTO l_gzcb002
      IF cl_null(l_str) THEN LET l_str = l_gzcb002 CONTINUE FOREACH END IF
      LET l_str = l_str,",",l_gzcb002
   END FOREACH
   CALL cl_set_combo_scc_part('xrce006','8310',l_str)
   CALL cl_set_combo_scc_part('xrce006_t','8310',l_str)
   CALL cl_set_combo_scc_part('xrce006_u','8310',l_str)
      
   #xrce002下拉菜單取值,SCC_8306 AND gzcb005 NOT Null
   LET l_sql = "SELECT gzcb002 FROM gzcb_t WHERE gzcb001 = '8306' AND gzcb005 Is Not Null"
   PREPARE axrt300_02_xrce002_prep FROM l_sql
   DECLARE axrt300_02_xrce002_curs CURSOR FOR axrt300_02_xrce002_prep
   LET l_str = Null
   LET l_gzcb002 = Null
   FOREACH axrt300_02_xrce002_curs INTO l_gzcb002
      IF cl_null(l_str) THEN LET l_str = l_gzcb002 CONTINUE FOREACH END IF
      LET l_str = l_str,",",l_gzcb002
   END FOREACH
   CALL cl_set_combo_scc_part('xrce002','8306',l_str)
   CALL cl_set_combo_scc_part('xrce002_t','8306',l_str)
   CALL cl_set_combo_scc_part('xrce002_u','8306',l_str)

   IF g_glaa_t.glaa015 = 'N' AND g_glaa_t.glaa019 = 'N' THEN
      CALL cl_set_comp_visible('bpage_2',FALSE)
   ELSE
      CALL cl_set_comp_visible('bpage_2',TRUE)
   END IF

   IF g_glaa_t.glaa015 = 'N' THEN
      CALL cl_set_comp_visible('xrce120,xrce121,xrce129',FALSE)
   ELSE
      CALL cl_set_comp_visible('xrce120,xrce121,xrce129',TRUE)
   END IF

   IF g_glaa_t.glaa019 = 'N' THEN
      CALL cl_set_comp_visible('xrce130,xrce131,xrce139',FALSE)
   ELSE
      CALL cl_set_comp_visible('xrce130,xrce131,xrce139',TRUE)
   END IF

   CALL axrt300_02_ref_amt()

   IF g_prog = 'axrt350' THEN
      CALL cl_set_comp_visible('xrce002,xrce003,xrce004,xrce005',FALSE)
      CALL cl_set_comp_visible('xrde007,xrde007_desc',TRUE)
   ELSE
      CALL cl_set_comp_visible('xrce002,xrce003,xrce004,xrce005',TRUE)
      CALL cl_set_comp_visible('xrde007,xrde007_desc',FALSE)
   END IF

   #LET l_ooab002 = ''
   #SELECT ooab002 INTO l_ooab002 FROM ooab_t
   # WHERE ooabent = g_enterprise
   #   AND ooab001 = 'S-FIN-1002'
   #   AND ooabsite= g_xrca_t.xrcasite
   #IF l_ooab002 = 'N' THEN
   #   CALL cl_set_comp_visible('xrce004,xrce025',FALSE)
   #   CALL cl_set_comp_visible('xrce004_t,xrce004_u',FALSE)
   #ELSE
   #   CALL cl_set_comp_visible('xrce004,xrce025',TRUE)
   #   CALL cl_set_comp_visible('xrce004_t,xrce004_u',TRUE)
   #END IF]]>
  </point>
  <point name="input.a.page1.xrce002" order="" ver="4" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="input.a.page1.xrce003" order="" ver="4" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xrce_d[l_ac].xrce003) AND g_xrce_d[l_ac].xrce002 = '10' THEN
               CALL axrt300_02_chk_xrde003()
               IF NOT cl_null(g_errno) AND g_errno != 'agl-00154' THEN
                  LET l_xrce003 = g_xrce_d[l_ac].xrce003
                  IF l_cmd = 'a' THEN
                     LET g_xrce_d[l_ac].xrce003 = ''
                     LET g_xrce_d[l_ac].xrce004 = ''
                  ELSE
                     LET g_xrce_d[l_ac].xrce003 = g_xrce_d_t.xrce003
                     LET g_xrce_d[l_ac].xrce004 = g_xrce_d_t.xrce004
                  END IF
                  DISPLAY g_xrce_d[l_ac].xrce003,g_xrce_d[l_ac].xrce004 TO s_detail1[l_ac].xrce003,s_detail1[l_ac].xrce004
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = g_errno
                  LET g_errparam.extend = l_xrce003
                  LET g_errparam.popup = TRUE
                  CALL cl_err()

                  NEXT FIELD xrce003
               ELSE
                  IF g_errno = 'agl-00154' THEN
                     INITIALIZE g_errparam TO NULL
                     LET g_errparam.code = g_errno
                     LET g_errparam.extend = g_xrce_d[l_ac].xrce003
                     LET g_errparam.popup = FALSE
                     CALL cl_err()

                  END IF
                  IF (l_cmd = 'a' OR (l_cmd = 'u' AND g_xrce_d[l_ac].xrce003 != g_xrce_d_t.xrce003 AND NOT cl_null(g_xrce_d_t.xrce003))) AND NOT cl_null(g_xrce_d[l_ac].xrce004) THEN
                     CALL axrt300_02_def_nmbb(g_xrce_d[l_ac].xrce003,g_xrce_d[l_ac].xrce004)
                  END IF
               END IF
               CALL cl_set_comp_entry('xrce100',FALSE)
            ELSE
               CALL cl_set_comp_entry('xrce100',TRUE)
            END IF
            
            IF NOT cl_null(g_xrce_d[l_ac].xrce003) AND (g_xrce_d[l_ac].xrce002 = '31' OR g_xrce_d[l_ac].xrce002 = '32') THEN
               SELECT xrcastus INTO l_xrcastus FROM xrca_t
                WHERE xrcaent = g_enterprise
                  AND xrcald = g_xrca_t.xrcald
                  AND xrcadocno = g_xrce_d[l_ac].xrce003
               LET g_errno = " "
               CASE
                  WHEN SQLCA.SQLCODE = 100
                     LET g_errno = 'axr-00064'
                  WHEN l_xrcastus != 'Y'
                     LET g_errno = 'axr-00065'
               END CASE
               IF NOT cl_null(g_errno) THEN
                  LET l_xrce003 = g_xrce_d[l_ac].xrce003
                  IF l_cmd = 'a' THEN
                     LET g_xrce_d[l_ac].xrce003 = ''
                  ELSE
                     LET g_xrce_d[l_ac].xrce003 = g_xrce_d_t.xrce003
                  END IF
                  DISPLAY g_xrce_d[l_ac].xrce003 TO s_detail1[l_ac].xrce003
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = g_errno
                  LET g_errparam.extend = l_xrce003
                  LET g_errparam.popup = TRUE
                  CALL cl_err()

                  NEXT FIELD xrce003
               END IF
               CALL axrt300_02_chk_xrce003()
               IF NOT cl_null(g_errno) THEN
                  LET l_xrce003 = g_xrce_d[l_ac].xrce003
                  IF l_cmd = 'a' THEN
                     LET g_xrce_d[l_ac].xrce003 = ''
                  ELSE
                     LET g_xrce_d[l_ac].xrce003 = g_xrce_d_t.xrce003
                  END IF
                  DISPLAY g_xrce_d[l_ac].xrce003 TO s_detail1[l_ac].xrce003
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = g_errno
                  LET g_errparam.extend = l_xrce003
                  LET g_errparam.popup = TRUE
                  CALL cl_err()

                  NEXT FIELD xrce003
               END IF
               
               IF (l_cmd = 'a' OR (l_cmd = 'u' AND (g_xrce_d[l_ac].xrce003 != g_xrce_d_t.xrce003 OR cl_null(g_xrce_d_t.xrce003)))) 
                   AND NOT cl_null(g_xrce_d[l_ac].xrce002)
                   AND NOT cl_null(g_xrce_d[l_ac].xrce004) 
                   AND NOT cl_null(g_xrce_d[l_ac].xrce005) THEN
                  CALL axrt300_02_def_xrcc(g_xrce_d[l_ac].xrce003,g_xrce_d[l_ac].xrce004,g_xrce_d[l_ac].xrce005)
               END IF
            END IF
            
#            IF NOT cl_null(g_xrce_d[l_ac].xrce002) THEN
#               IF g_xrce_d[l_ac].xrce002 = '10' THEN
#                  IF NOT cl_null(g_xrce_d[l_ac].xrce003) THEN
#                     CALL axrt300_02_chk_xrce003(l_cmd)
#                     IF NOT cl_null(g_errno) AND g_errno != 'agl-00154' THEN
#                        IF l_cmd = 'a' THEN
#                           DISPLAY '','' TO s_detail1[l_ac].xrce003,s_detail1[l_ac].xrce004
#                        ELSE
#                           DISPLAY g_xrce_d_t.xrce003,g_xrce_d_t.xrce004 TO s_detail1[l_ac].xrce003,s_detail1[l_ac].xrce004
#                        END IF
#                        INITIALIZE g_errparam TO NULL
#                        LET g_errparam.code = g_errno
#                        LET g_errparam.extend = g_xrce_d[l_ac].xrce003
#                        LET g_errparam.popup = TRUE
#                        CALL cl_err()
#
#                        IF l_cmd = 'a' THEN
#                           LET g_xrce_d[l_ac].xrce003 = ''
#                           LET g_xrce_d[l_ac].xrce004 = ''
#                        ELSE
#                           LET g_xrce_d[l_ac].xrce003 = g_xrce_d_t.xrce003
#                           LET g_xrce_d[l_ac].xrce004 = g_xrce_d_t.xrce004
#                        END IF
#                        DISPLAY g_xrce_d[l_ac].xrce003,g_xrce_d[l_ac].xrce004 TO s_detail1[l_ac].xrce003,s_detail1[l_ac].xrce004
#                        NEXT FIELD xrce003
#                     ELSE
#                        IF g_errno = 'agl-00154' THEN
#                           INITIALIZE g_errparam TO NULL
#                           LET g_errparam.code = g_errno
#                           LET g_errparam.extend = g_xrce_d[l_ac].xrce003
#                           LET g_errparam.popup = FALSE
#                           CALL cl_err()
#
#                        END IF
#                        IF (l_cmd = 'a' OR (l_cmd = 'u' AND g_xrce_d[l_ac].xrce003 != g_xrce_d_t.xrce003 AND NOT cl_null(g_xrce_d_t.xrce003))) AND NOT cl_null(g_xrce_d[l_ac].xrce004) THEN
#                           CALL axrt300_02_def_xrce(g_xrce_d[l_ac].xrce002,g_xrce_d[l_ac].xrce003,g_xrce_d[l_ac].xrce004,0,g_xrce_d[l_ac].xrce006,g_xrce_d[l_ac].xrce003)
#                        END IF
#                     END IF
#                     CALL cl_set_comp_entry('xrce100',FALSE)
#                  ELSE
#                     CALL cl_set_comp_entry('xrce100',TRUE)
#                  END IF
#               END IF
#               IF g_xrce_d[l_ac].xrce002 = '31' THEN
#                  IF NOT cl_null(g_xrce_d[l_ac].xrce003) THEN
#      
#                     SELECT xrcastus INTO l_xrcastus FROM xrca_t
#                      WHERE xrcaent = g_enterprise
#                        AND xrcald = g_xrca_t.xrcald
#                        AND xrcadocno = g_xrce_d[l_ac].xrce003
#                     LET g_errno = " "
#                     CASE
#                        WHEN SQLCA.SQLCODE = 100
#                           LET g_errno = 'axr-00064'
#                        WHEN l_xrcastus != 'Y'
#                           LET g_errno = 'axr-00065'
#                     END CASE
#                     IF NOT cl_null(g_errno) THEN
#                        IF l_cmd = 'a' THEN
#                           DISPLAY '' TO s_detail3[l_ac].xrce003
#                        ELSE
#                           DISPLAY g_xrce_d_t.xrce003 TO s_detail3[l_ac].xrce003
#                        END IF
#                        INITIALIZE g_errparam TO NULL
#                        LET g_errparam.code = g_errno
#                        LET g_errparam.extend = g_xrce_d[l_ac].xrce003
#                        LET g_errparam.popup = TRUE
#                        CALL cl_err()
#
#                        IF l_cmd = 'a' THEN
#                           LET g_xrce_d[l_ac].xrce003 = ''
#                        ELSE
#                           LET g_xrce_d[l_ac].xrce003 = g_xrce_d_t.xrce003
#                        END IF
#                        DISPLAY g_xrce_d[l_ac].xrce003 TO s_detail3[l_ac].xrce003
#                        NEXT FIELD xrce003
#                     END IF
#                     CALL axrt300_02_xrce024(l_cmd)
#                     IF NOT cl_null(g_errno) THEN
#                        IF l_cmd = 'a' THEN
#                           DISPLAY '' TO s_detail3[l_ac].xrce003
#                        ELSE
#                           DISPLAY g_xrce_d_t.xrce003 TO s_detail3[l_ac].xrce003
#                        END IF
#                        INITIALIZE g_errparam TO NULL
#                        LET g_errparam.code = g_errno
#                        LET g_errparam.extend = g_xrce_d[l_ac].xrce003
#                        LET g_errparam.popup = TRUE
#                        CALL cl_err()
#
#                        IF l_cmd = 'a' THEN
#                           LET g_xrce_d[l_ac].xrce003 = ''
#                        ELSE
#                           LET g_xrce_d[l_ac].xrce003 = g_xrce_d_t.xrce003
#                        END IF
#                        DISPLAY g_xrce_d[l_ac].xrce003 TO s_detail3[l_ac].xrce003
#                        NEXT FIELD xrce003
#                     END IF
#                     SELECT xrca060 INTO l_xrca060 FROM xrca_t
#                      WHERE xrcald = g_xrca_t.xrcald
#                        AND xrca019 = g_xrce_d[l_ac].xrce003
#                     IF l_xrca060 = '2' THEN
#                        LET g_xrce_d[l_ac].xrce027 = 'Y'
#                     ELSE
#                        LET g_xrce_d[l_ac].xrce027 = 'N'
#                     END IF
#                     IF (l_cmd = 'a' OR (l_cmd = 'u' AND (g_xrce_d[l_ac].xrce003 != g_xrce_d_t.xrce003 OR cl_null(g_xrce_d_t.xrce003)))) AND NOT cl_null(g_xrce_d[l_ac].xrce002) THEN
#                        CALL axrt300_02_def_xrce(g_xrce_d[l_ac].xrce002,g_xrce_d[l_ac].xrce003,g_xrce_d[l_ac].xrce004,g_xrce_d[l_ac].xrce005,'',g_xrce_d[l_ac].xrce024)
#                     END IF
#                  END IF
#               END IF
#            END IF]]>
  </point>
  <point name="input.a.page1.xrce004" order="" ver="4" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xrce_d[l_ac].xrce003) AND NOT cl_null(g_xrce_d[l_ac].xrce004) AND g_xrce_d[l_ac].xrce002 = '10' THEN
               CALL axrt300_02_chk_xrde003()
               IF NOT cl_null(g_errno) AND g_errno != 'agl-00154' THEN
                  LET l_xrce004 = g_xrce_d[l_ac].xrce004
                  IF l_cmd = 'a' THEN
                     LET g_xrce_d[l_ac].xrce003 = ''
                     LET g_xrce_d[l_ac].xrce004 = ''
                  ELSE
                     LET g_xrce_d[l_ac].xrce003 = g_xrce_d_t.xrce003
                     LET g_xrce_d[l_ac].xrce004 = g_xrce_d_t.xrce004
                  END IF
                  DISPLAY g_xrce_d[l_ac].xrce003,g_xrce_d[l_ac].xrce004 TO s_detail1[l_ac].xrce003,s_detail1[l_ac].xrce004
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = g_errno
                  LET g_errparam.extend = l_xrce004
                  LET g_errparam.popup = TRUE
                  CALL cl_err()

                  NEXT FIELD xrce004
               ELSE
                  IF g_errno = 'agl-00154' THEN
                     INITIALIZE g_errparam TO NULL
                     LET g_errparam.code = g_errno
                     LET g_errparam.extend = g_xrce_d[l_ac].xrce004
                     LET g_errparam.popup = FALSE
                     CALL cl_err()

                  END IF
                  IF (l_cmd = 'a' OR (l_cmd = 'u' AND g_xrce_d[l_ac].xrce004 != g_xrce_d_t.xrce004 AND NOT cl_null(g_xrce_d_t.xrce004))) AND NOT cl_null(g_xrce_d[l_ac].xrce003) THEN
                     CALL axrt300_02_def_nmbb(g_xrce_d[l_ac].xrce003,g_xrce_d[l_ac].xrce004)
                  END IF
               END IF
            END IF
            
            IF NOT cl_null(g_xrce_d[l_ac].xrce003) AND NOT cl_null(g_xrce_d[l_ac].xrce004) AND (g_xrce_d[l_ac].xrce002 = '31' OR g_xrce_d[l_ac].xrce002 = '32') THEN
               CALL axrt300_02_chk_xrce003()
               IF NOT cl_null(g_errno) THEN
                  LET l_xrce004 = g_xrce_d[l_ac].xrce004
                  IF l_cmd = 'a' THEN
                     LET g_xrce_d[l_ac].xrce004 = ''
                  ELSE
                     LET g_xrce_d[l_ac].xrce004 = g_xrce_d_t.xrce004
                  END IF
                  DISPLAY g_xrce_d[l_ac].xrce004 TO s_detail1[l_ac].xrce004
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = g_errno
                  LET g_errparam.extend = l_xrce004
                  LET g_errparam.popup = TRUE
                  CALL cl_err()

                  NEXT FIELD xrce004
               END IF
               
               IF (l_cmd = 'a' OR (l_cmd = 'u' AND (g_xrce_d[l_ac].xrce004 != g_xrce_d_t.xrce004 OR cl_null(g_xrce_d_t.xrce004)))) 
                  AND NOT cl_null(g_xrce_d[l_ac].xrce002) 
                  AND NOT cl_null(g_xrce_d[l_ac].xrce004) 
                  AND NOT cl_null(g_xrce_d[l_ac].xrce005) THEN
                  CALL axrt300_02_def_xrcc(g_xrce_d[l_ac].xrce003,g_xrce_d[l_ac].xrce004,g_xrce_d[l_ac].xrce005)
               END IF
            END IF

#            IF NOT cl_null(g_xrce_d[l_ac].xrce003) AND NOT cl_null(g_xrce_d[l_ac].xrce004) AND g_xrce_d[l_ac].xrce002 = '10' THEN
#               CALL axrt300_02_chk_xrce003()
#               IF NOT cl_null(g_errno) AND g_errno != 'agl-00154' THEN
#                  IF l_cmd = 'a' THEN
#                     DISPLAY '','' TO s_detail1[l_ac].xrce003,s_detail1[l_ac].xrce004
#                  ELSE
#                     DISPLAY g_xrce_d_t.xrce003,g_xrce_d_t.xrce004 TO s_detail1[l_ac].xrce003,s_detail1[l_ac].xrce004
#                  END IF
#                  INITIALIZE g_errparam TO NULL
#                  LET g_errparam.code = g_errno
#                  LET g_errparam.extend = g_xrce_d[l_ac].xrce004
#                  LET g_errparam.popup = TRUE
#                  CALL cl_err()
#
#                  IF l_cmd = 'a' THEN
#                     LET g_xrce_d[l_ac].xrce003 = ''
#                     LET g_xrce_d[l_ac].xrce004 = ''
#                  ELSE
#                     LET g_xrce_d[l_ac].xrce003 = g_xrce_d_t.xrce003
#                     LET g_xrce_d[l_ac].xrce004 = g_xrce_d_t.xrce004
#                  END IF
#                  DISPLAY g_xrce_d[l_ac].xrce003,g_xrce_d[l_ac].xrce004 TO s_detail1[l_ac].xrce003,s_detail1[l_ac].xrce004
#                  NEXT FIELD xrce004
#               ELSE
#                  IF g_errno = 'agl-00154' THEN
#                     INITIALIZE g_errparam TO NULL
#                     LET g_errparam.code = g_errno
#                     LET g_errparam.extend = g_xrce_d[l_ac].xrce003
#                     LET g_errparam.popup = FALSE
#                     CALL cl_err()
#
#                  END IF
#                  IF (l_cmd = 'a' OR (l_cmd = 'u' AND g_xrce_d[l_ac].xrce004 != g_xrce_d_t.xrce004 AND NOT cl_null(g_xrce_d_t.xrce004))) AND NOT cl_null(g_xrce_d[l_ac].xrce003) THEN
#                     CALL axrt300_02_def_xrce(g_xrce_d[l_ac].xrce002,g_xrce_d[l_ac].xrce003,g_xrce_d[l_ac].xrce004,0,g_xrce_d[l_ac].xrce006,g_xrce_d[l_ac].xrce003)
#                  END IF
#               END IF
#            END IF
#            IF NOT cl_null(g_xrce_d[l_ac].xrce003) AND NOT cl_null(g_xrce_d[l_ac].xrce004) AND g_xrce_d[l_ac].xrce002 = '31' THEN
#               SELECT COUNT(*) INTO l_count FROM xrcb_t
#                WHERE xrcbent = g_enterprise
#                  AND xrcbld = g_xrca_t.xrcald
#                  AND xrcbdocno = g_xrce_d[l_ac].xrce003
#                  AND xrcbseq   = g_xrce_d[l_ac].xrce004
#               IF l_count = 0 THEN
#                  IF l_cmd = 'a' THEN
#                     DISPLAY '' TO s_detail3[l_ac].xrce003
#                  ELSE
#                     DISPLAY g_xrce_d_t.xrce003 TO s_detail3[l_ac].xrce003
#                  END IF
#                  INITIALIZE g_errparam TO NULL
#                  LET g_errparam.code = 'axr-00064'
#                  LET g_errparam.extend = g_xrce_d[l_ac].xrce003
#                  LET g_errparam.popup = TRUE
#                  CALL cl_err()
#
#                  IF l_cmd = 'a' THEN
#                     LET g_xrce_d[l_ac].xrce003 = ''
#                  ELSE
#                     LET g_xrce_d[l_ac].xrce003 = g_xrce_d_t.xrce003
#                  END IF
#                  DISPLAY g_xrce_d[l_ac].xrce003 TO s_detail3[l_ac].xrce003
#                  NEXT FIELD xrce003
#               END IF
#               CALL axrt300_02_xrce024(l_cmd)
#               IF NOT cl_null(g_errno) THEN
#                  IF l_cmd = 'a' THEN
#                     DISPLAY '' TO s_detail3[l_ac].xrce003
#                  ELSE
#                     DISPLAY g_xrce_d_t.xrce003 TO s_detail3[l_ac].xrce003
#                  END IF
#                  INITIALIZE g_errparam TO NULL
#                  LET g_errparam.code = 'axr-00064'
#                  LET g_errparam.extend = g_xrce_d[l_ac].xrce003
#                  LET g_errparam.popup = TRUE
#                  CALL cl_err()
#
#                  IF l_cmd = 'a' THEN
#                     LET g_xrce_d[l_ac].xrce003 = ''
#                  ELSE
#                     LET g_xrce_d[l_ac].xrce003 = g_xrce_d_t.xrce003
#                  END IF
#                  DISPLAY g_xrce_d[l_ac].xrce003 TO s_detail3[l_ac].xrce003
#                  NEXT FIELD xrce003
#               END IF
#               
#               IF (l_cmd = 'a' OR (l_cmd = 'u' AND (g_xrce_d[l_ac].xrce004 != g_xrce_d_t.xrce004 OR cl_null(g_xrce_d_t.xrce004)))) AND NOT cl_null(g_xrce_d[l_ac].xrce002) THEN
#                  CALL axrt300_02_def_xrce(g_xrce_d[l_ac].xrce002,g_xrce_d[l_ac].xrce003,g_xrce_d[l_ac].xrce004,g_xrce_d[l_ac].xrce005,'',g_xrce_d[l_ac].xrce024)
#               END IF
#            END IF]]>
  </point>
  <point name="input.a.page1.xrce005" order="" ver="4" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xrce_d[l_ac].xrce005) AND NOT cl_null(g_xrce_d[l_ac].xrce003) AND NOT cl_null(g_xrce_d[l_ac].xrce004) AND (g_xrce_d[l_ac].xrce002 = '31' OR g_xrce_d[l_ac].xrce002 = '32') THEN
               CALL axrt300_02_chk_xrce003()
               IF NOT cl_null(g_errno) THEN
                  LET l_xrce005 = g_xrce_d[l_ac].xrce005
                  IF l_cmd = 'a' THEN
                     LET g_xrce_d[l_ac].xrce005 = ''
                  ELSE
                     LET g_xrce_d[l_ac].xrce005 = g_xrce_d_t.xrce005
                  END IF
                  DISPLAY g_xrce_d[l_ac].xrce005 TO s_detail1[l_ac].xrce005
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = g_errno
                  LET g_errparam.extend = l_xrce005
                  LET g_errparam.popup = TRUE
                  CALL cl_err()

                  NEXT FIELD xrce005
               END IF
               
               IF (l_cmd = 'a' OR (l_cmd = 'u' AND (g_xrce_d[l_ac].xrce005 != g_xrce_d_t.xrce005 OR cl_null(g_xrce_d_t.xrce005)))) 
                  AND NOT cl_null(g_xrce_d[l_ac].xrce002) 
                  AND NOT cl_null(g_xrce_d[l_ac].xrce004) 
                  AND NOT cl_null(g_xrce_d[l_ac].xrce005) THEN
                  CALL axrt300_02_def_xrcc(g_xrce_d[l_ac].xrce003,g_xrce_d[l_ac].xrce004,g_xrce_d[l_ac].xrce005)
               END IF
            END IF

#            IF NOT cl_null(g_xrce_d[l_ac].xrce005) AND NOT cl_null(g_xrce_d[l_ac].xrce002) AND g_xrce_d[l_ac].xrce002 = '31' THEN
#               IF NOT cl_null(g_xrce_d[l_ac].xrce003) THEN
#                  LET l_count = 0
#                  SELECT COUNT(*) INTO l_count FROM xrcc_t
#                   WHERE xrccent = g_enterprise
#                     AND xrccdocno = g_xrce_d[l_ac].xrce003
#                     AND xrcc001 = g_xrce_d[l_ac].xrce005
#                  IF l_count = 0 THEN
#                     IF l_cmd = 'a' THEN
#                        DISPLAY '' TO s_detail1[l_ac].xrce005
#                     ELSE
#                        DISPLAY g_xrce_d_t.xrce005 TO s_detail1[l_ac].xrce005
#                     END IF
#                     INITIALIZE g_errparam TO NULL
#                     LET g_errparam.code = 'axr-00066'
#                     LET g_errparam.extend = g_xrce_d[l_ac].xrce005
#                     LET g_errparam.popup = TRUE
#                     CALL cl_err()
#
#                     IF l_cmd = 'a' THEN
#                        LET g_xrce_d[l_ac].xrce005 = ''
#                     ELSE
#                        LET g_xrce_d[l_ac].xrce005 = g_xrce_d_t.xrce005
#                     END IF
#                     DISPLAY g_xrce_d[l_ac].xrce005 TO s_detail1[l_ac].xrce005
#                     NEXT FIELD xrce005
#                  END IF
#               END IF
#               CALL axrt300_02_xrce024(l_cmd)
#               IF NOT cl_null(g_errno) THEN
#                  IF l_cmd = 'a' THEN
#                     DISPLAY '' TO s_detail1[l_ac].xrce005
#                  ELSE
#                     DISPLAY g_xrce_d_t.xrce005 TO s_detail1[l_ac].xrce005
#                  END IF
#                  INITIALIZE g_errparam TO NULL
#                     LET g_errparam.code = 'axr-00066'
#                     LET g_errparam.extend = g_xrce_d[l_ac].xrce005
#                     LET g_errparam.popup = TRUE
#                     CALL cl_err()
#
#                  IF l_cmd = 'a' THEN
#                     LET g_xrce_d[l_ac].xrce005 = ''
#                  ELSE
#                     LET g_xrce_d[l_ac].xrce005 = g_xrce_d_t.xrce005
#                  END IF
#                  DISPLAY g_xrce_d[l_ac].xrce005 TO s_detail1[l_ac].xrce005
#                  NEXT FIELD xrce005
#               END IF
#               
#               IF (l_cmd = 'a' OR (l_cmd = 'u' AND (g_xrce_d[l_ac].xrce005 != g_xrce_d_t.xrce005 OR cl_null(g_xrce_d_t.xrce005)))) AND NOT cl_null(g_xrce_d[l_ac].xrce002) THEN
#                  CALL axrt300_02_def_xrce(g_xrce_d[l_ac].xrce002,g_xrce_d[l_ac].xrce003,g_xrce_d[l_ac].xrce004,g_xrce_d[l_ac].xrce005,'',g_xrce_d[l_ac].xrce024)
#               END IF
#            END IF]]>
  </point>
  <point name="input.a.page1.xrce010" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xrce_d[l_ac].xrce010) THEN
              LET g_msg = g_xrce_d[l_ac].xrce010
              IF g_msg[1,1] = '.' THEN
                 LET g_msg = g_msg[2,10]
                 SELECT oocql004 INTO g_xrce_d[l_ac].xrce010 FROM oocql_t
                  WHERE oocqlent = g_enterprise
                    AND oocql001 = '3005'
                    AND oocql002 = g_msg
                    AND oocql003 = g_lang
                 DISPLAY g_xrce_d[l_ac].xrce010 TO s_detail1[l_ac].xrce010
              END IF
           END IF]]>
  </point>
  <point name="input.a.page1.xrce016" order="" ver="7" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xrce_d[l_ac].xrce016) THEN
               IF l_cmd = 'a' OR (l_cmd = 'u' AND (g_xrce_d[l_ac].xrce016 != g_xrce_d_t.xrce016 OR g_xrce_d_t.xrce016 IS NULL )) THEN
               SELECT glacstus INTO l_glacstus FROM glac_t
                WHERE glacent = g_enterprise
                  AND glac001 = g_glaa_t.glaa004
                  AND glac002 = g_xrce_d[l_ac].xrce016
               LET g_errno = ' '
               CASE
                  WHEN SQLCA.SQLCODE = 100
                     LET g_errno = 'agl-00011'
                  WHEN l_glacstus = 'N'
                     LET g_errno = 'agl-00012'
               END CASE
               IF NOT cl_null(g_errno) THEN
                  IF l_cmd = 'a' THEN
                     LET g_xrce_d[l_ac].xrce016_desc_1 = ''
                     DISPLAY '','' TO s_detail3[l_ac].xrce016,s_detail3[l_ac].xrce016_desc_1
                  ELSE
                     INITIALIZE g_ref_fields TO NULL
                     LET g_ref_fields[1] = g_xrce_d_t.xrce016
                     CALL ap_ref_array2(g_ref_fields,"SELECT glacl004 FROM glacl_t WHERE glaclent='"||g_enterprise||"' AND glacl001='"||g_glaa_t.glaa004||"' AND glacl002=? AND glacl003='"||g_lang||"'","") RETURNING g_rtn_fields
                     LET g_xrce_d[l_ac].xrce016_desc_1 = '', g_rtn_fields[1] , ''
                     DISPLAY g_xrce_d_t.xrce016,g_xrce_d[l_ac].xrce016_desc_1 TO s_detail3[l_ac].xrce016,s_detail3[l_ac].xrce016_desc
                  END IF
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = g_errno
                  LET g_errparam.extend = g_xrce_d[l_ac].xrce016
                  LET g_errparam.popup = TRUE
                  CALL cl_err()

                  IF l_cmd = 'a' THEN
                     LET g_xrce_d[l_ac].xrce016 = ''
                  ELSE
                     LET g_xrce_d[l_ac].xrce016 = g_xrce_d_t.xrce016
                  END IF
                  DISPLAY g_xrce_d[l_ac].xrce016 TO s_detail3[l_ac].xrce016
                  NEXT FIELD xrce016
               END IF
               CALL axrt300_02_acc_def()
               END IF
            END IF
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xrce_d[l_ac].xrce016
            CALL ap_ref_array2(g_ref_fields,"SELECT glacl004 FROM glacl_t WHERE glaclent='"||g_enterprise||"' AND glacl001='"||g_glaa_t.glaa004||"' AND glacl002=? AND glacl003='"||g_lang||"'","") RETURNING g_rtn_fields
            LET g_xrce_d[l_ac].xrce016_desc_1 = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xrce_d[l_ac].xrce016_desc_1
            LET g_xrce3_d[l_ac].xrce016 = g_xrce_d[l_ac].xrce016
            LET g_xrce3_d[l_ac].xrce016_u_desc = g_xrce_d[l_ac].xrce016_desc_1]]>
  </point>
  <point name="input.a.page1.xrce024" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xrce_d[l_ac].xrce024) THEN
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xrce_d[l_ac].xrce024 != g_xrce_d_t.xrce024 AND NOT cl_null(g_xrce_d_t.xrce024))) THEN 

                  LET l_ooab002 = ''
                  SELECT ooab002 INTO l_ooab002 FROM ooab_t
                   WHERE ooabent = g_enterprise
                     AND ooab001 = 'S-FIN-1002'
                     AND ooabsite= g_xrca_t.xrcasite

                  #檢查交易單據存在性、有效性
                  IF l_ooab002 = 'N' THEN
                     SELECT COUNT(*) INTO l_count FROM xrcb_t,xrca_t
                      WHERE xrcbent = g_enterprise
                        AND xrcaent = xrcbent
                        AND xrcadocno = xrcbdocno
                        AND xrcb002 = g_xrce_d[l_ac].xrce024
                        AND xrcastus = 'Y'
                     IF l_count = 0 THEN
                        SELECT COUNT(*) INTO l_count FROM xrcb_t,xrca_t
                         WHERE xrcbent = g_enterprise
                           AND xrcaent = xrcbent
                           AND xrcadocno = xrcbdocno
                           AND xrcb002 = g_xrce_d[l_ac].xrce024
                        IF l_count = 0 THEN
                           LET g_errno = 'axr-00062'
                        ELSE
                           LET g_errno = 'axr-00063'
                        END IF
                     END IF
                  ELSE
                     IF NOT cl_null(g_xrce_d[l_ac].xrce025) THEN
                        SELECT COUNT(*) INTO l_count FROM xrcb_t,xrca_t
                         WHERE xrcbent = g_enterprise
                           AND xrcaent = xrcbent
                           AND xrcadocno = xrcbdocno
                           AND xrcb002 = g_xrce_d[l_ac].xrce024
                           AND xrcb003 = g_xrce_d[l_ac].xrce025
                           AND xrcastus = 'Y'
                        IF l_count = 0 THEN
                           SELECT COUNT(*) INTO l_count FROM xrcb_t,xrca_t
                            WHERE xrcbent = g_enterprise
                              AND xrcaent = xrcbent
                              AND xrcadocno = xrcbdocno
                              AND xrcb002 = g_xrce_d[l_ac].xrce024
                              AND xrcb003 = g_xrce_d[l_ac].xrce025
                           IF l_count = 0 THEN
                              LET g_errno = 'axr-00062'
                           ELSE
                              LET g_errno = 'axr-00063'
                           END IF
                        END IF
                     END IF
                  END IF
                  IF NOT cl_null(g_errno) THEN
                     IF l_cmd = 'a'THEN
                        DISPLAY '' TO s_detail3[l_ac].xrce024
                     ELSE
                        DISPLAY g_xrce_d_t.xrce024 TO s_detail3[l_ac].xrce024
                     END IF
                     INITIALIZE g_errparam TO NULL
                     LET g_errparam.code = g_errno
                     LET g_errparam.extend = g_xrce_d[l_ac].xrce024
                     LET g_errparam.popup = TRUE
                     CALL cl_err()

                     IF l_cmd = 'a'THEN
                        LET g_xrce_d[l_ac].xrce024 = ''
                     ELSE
                        LET g_xrce_d[l_ac].xrce024 = g_xrce_d_t.xrce024
                     END IF
                     DISPLAY g_xrce_d[l_ac].xrce024 TO s_detail3[l_ac].xrce024
                     NEXT FIELD xrce024
                  END IF
                  CALL axrt300_02_xrce024(l_cmd)
                  IF NOT cl_null(g_errno) THEN
                     IF l_cmd = 'a'THEN
                        DISPLAY '' TO s_detail3[l_ac].xrce024
                     ELSE
                        DISPLAY g_xrce_d_t.xrce024 TO s_detail3[l_ac].xrce024
                     END IF
                     INITIALIZE g_errparam TO NULL
                     LET g_errparam.code = g_errno
                     LET g_errparam.extend = g_xrce_d[l_ac].xrce024
                     LET g_errparam.popup = TRUE
                     CALL cl_err()

                     IF l_cmd = 'a'THEN
                        LET g_xrce_d[l_ac].xrce024 = ''
                     ELSE
                        LET g_xrce_d[l_ac].xrce024 = g_xrce_d_t.xrce024
                     END IF
                     DISPLAY g_xrce_d[l_ac].xrce024 TO s_detail3[l_ac].xrce024
                     NEXT FIELD xrce024
                  END IF
               END IF
               
               IF (l_cmd = 'a' OR (l_cmd = 'u' AND (g_xrce_d[l_ac].xrce024 != g_xrce_d_t.xrce024 OR cl_null(g_xrce_d_t.xrce024)))) AND NOT cl_null(g_xrce3_d[l_ac].xrce002) THEN
                  CALL axrt300_02_def_xrce(g_xrce3_d[l_ac].xrce002,g_xrce3_d[l_ac].xrce003,g_xrce3_d[l_ac].xrce004,g_xrce3_d[l_ac].xrce005,'',g_xrce_d[l_ac].xrce024)
               END IF
            END IF]]>
  </point>
  <point name="input.a.page1.xrce025" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xrce_d[l_ac].xrce025) THEN
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_xrce_d[l_ac].xrce025 != g_xrce_d_t.xrce025)) THEN 
                  #檢查交易單據存在性、有效性
                  SELECT COUNT(*) INTO l_count FROM xrcb_t,xrca_t
                   WHERE xrcbent = g_enterprise
                     AND xrcaent = xrcbent
                     AND xrcadocno = xrcbdocno
                     AND xrcb002 = g_xrce_d[l_ac].xrce024
                     AND xrcb003 = g_xrce_d[l_ac].xrce025
                     AND xrcastus = 'Y'
                  IF l_count = 0 THEN
                     SELECT COUNT(*) INTO l_count FROM xrcb_t,xrca_t
                      WHERE xrcbent = g_enterprise
                        AND xrcaent = xrcbent
                        AND xrcadocno = xrcbdocno
                        AND xrcb002 = g_xrce_d[l_ac].xrce024
                        AND xrcb003 = g_xrce_d[l_ac].xrce025
                     IF l_count = 0 THEN
                        LET g_errno = 'axr-00062'
                     ELSE
                        LET g_errno = 'axr-00063'
                     END IF
                  END IF
                  IF NOT cl_null(g_errno) THEN
                     IF l_cmd = 'a'THEN 
                        DISPLAY '' TO s_detail1[l_ac].xrce025
                     ELSE
                        DISPLAY g_xrce_d_t.xrce025 TO s_detail1[l_ac].xrce025
                     END IF
                     INITIALIZE g_errparam TO NULL
                     LET g_errparam.code = g_errno
                     LET g_errparam.extend = g_xrce_d[l_ac].xrce025
                     LET g_errparam.popup = TRUE
                     CALL cl_err()

                     IF l_cmd = 'a'THEN
                        LET g_xrce_d[l_ac].xrce025 = ''
                     ELSE
                        LET g_xrce_d[l_ac].xrce025 = g_xrce_d_t.xrce025
                     END IF
                     DISPLAY g_xrce_d[l_ac].xrce025 TO s_detail1[l_ac].xrce025
                     NEXT FIELD xrce025
                  END IF
                  CALL axrt300_02_xrce024(l_cmd)
                  IF NOT cl_null(g_errno) THEN
                     IF l_cmd = 'a'THEN 
                        DISPLAY '' TO s_detail1[l_ac].xrce025
                     ELSE
                        DISPLAY g_xrce_d_t.xrce025 TO s_detail1[l_ac].xrce025
                     END IF
                     INITIALIZE g_errparam TO NULL
                     LET g_errparam.code = g_errno
                     LET g_errparam.extend = g_xrce_d[l_ac].xrce025
                     LET g_errparam.popup = TRUE
                     CALL cl_err()

                     IF l_cmd = 'a'THEN
                        LET g_xrce_d[l_ac].xrce025 = ''
                     ELSE
                        LET g_xrce_d[l_ac].xrce025 = g_xrce_d_t.xrce025
                     END IF
                     DISPLAY g_xrce_d[l_ac].xrce025 TO s_detail1[l_ac].xrce025
                     NEXT FIELD xrce025
                  END IF
               END IF
                  
               IF (l_cmd = 'a' OR (l_cmd = 'u' AND (g_xrce_d[l_ac].xrce025 != g_xrce_d_t.xrce025 OR cl_null(g_xrce_d_t.xrce025)))) AND NOT cl_null(g_xrce_d[l_ac].xrce002) THEN
                  CALL axrt300_02_def_xrce(g_xrce_d[l_ac].xrce002,g_xrce_d[l_ac].xrce003,g_xrce_d[l_ac].xrce004,g_xrce_d[l_ac].xrce005,'',g_xrce_d[l_ac].xrce024)
               END IF
            END IF]]>
  </point>
  <point name="input.a.page1.xrce100" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xrce_d[l_ac].xrce100) THEN
               LET l_ooaistus = Null
               SELECT ooaistus INTO l_ooaistus FROM ooai_t
                WHERE ooai001 = g_xrce_d[l_ac].xrce100
               LET g_errno = ''
               CASE
                  WHEN SQLCA.SQLCODE = 100
                     LET g_errno = 'aoo-00028'
                  WHEN l_ooaistus = 'N'
                     LET g_errno = 'aoo-00011'
               END CASE
               IF NOT cl_null(g_errno) THEN
                  IF l_cmd = 'a' THEN
                     DISPLAY '' TO s_detail1[l_ac].xrce100
                  ELSE
                     DISPLAY g_xrce_d_t.xrce100 TO s_detail1[l_ac].xrce100
                  END IF
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = g_errno
                  LET g_errparam.extend = g_xrce_d[l_ac].xrce100
                  LET g_errparam.popup = TRUE
                  CALL cl_err()

                  IF l_cmd = 'a' THEN
                     LET g_xrce_d[l_ac].xrce100 = ''
                  ELSE
                     LET g_xrce_d[l_ac].xrce100 = g_xrce_d_t.xrce100
                  END IF
                  DISPLAY g_xrce_d[l_ac].xrce100 TO s_detail1[l_ac].xrce100
                  NEXT FIELD xrce100
               END IF
            END IF
                               #匯率參照表;帳套;           日期;          來源幣別
            CALL s_aooi160_get_exrate('2',g_glaa_t.glaald,g_xrca_t.xrcadocdt,g_xrce_d[l_ac].xrce100,
                                     #目的幣別;   交易金額;              匯類類型
                                      g_glaa_t.glaa001,0,g_glaa_t.glaa025)
            RETURNING g_xrce_d[l_ac].xrce101
            DISPLAY g_xrce_d[l_ac].xrce101 TO s_detail1[l_ac].xrce101]]>
  </point>
  <point name="input.a.page1.xrce101" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF cl_null(g_xrce_d[l_ac].xrce003) AND cl_null(g_xrce_d[l_ac].xrce101) 
               AND NOT cl_null(g_xrce_d[l_ac].xrce109) AND NOT cl_null(g_xrce_d[l_ac].xrce100) THEN
               SELECT ooab002 INTO l_ooab002 FROM ooab_t
                WHERE ooabent = g_enterprise
                  AND ooabsite= g_xrca_t.xrcasite
                  AND ooab001 = 'S-BAS-0010'
                                        #匯率參照表;帳套;           日期;               來源幣別
               CALL s_aooi160_get_exrate('2',g_xrca_t.xrcald,g_xrca_t.xrcadocdt,g_xrce_d[l_ac].xrce100,
                                        #目的幣別;  交易金額;              匯類類型
                                         g_glaa_t.glaa001,0,l_ooab002)
                  RETURNING g_xrce_d[l_ac].xrce101
               DISPLAY g_xrce_d[l_ac].xrce101 TO s_detail1[l_ac].xrce101
            END IF
            IF NOT cl_null(g_xrce_d[l_ac].xrce101) AND NOT cl_null(g_xrce_d[l_ac].xrce109) THEN
               LET g_xrce_d[l_ac].xrce119 = g_xrce_d[l_ac].xrce109 * g_xrce_d[l_ac].xrce101
               DISPLAY g_xrce_d[l_ac].xrce119 TO s_detail1[l_ac].xrce119
            END IF
            IF cl_null(g_xrce_d[l_ac].xrce024) AND cl_null(g_xrce_d[l_ac].xrce101) 
               AND NOT cl_null(g_xrce_d[l_ac].xrce109) AND NOT cl_null(g_xrce_d[l_ac].xrce100) THEN
               SELECT ooab002 INTO l_ooab002 FROM ooab_t
                WHERE ooabent = g_enterprise
                  AND ooabsite= g_xrca_t.xrcasite
                  AND ooab001 = 'S-BAS-0010'
                                        #匯率參照表;帳套;           日期;               來源幣別
               CALL s_aooi160_get_exrate('2',g_xrca_t.xrcald,g_xrca_t.xrcadocdt,g_xrce_d[l_ac].xrce100,
                                        #目的幣別;  交易金額;              匯類類型
                                         g_glaa_t.glaa001,g_xrce_d[l_ac].xrce109,l_ooab002)
                  RETURNING g_xrce_d[l_ac].xrce101
               DISPLAY g_xrce_d[l_ac].xrce101 TO s_detail3[l_ac].xrce101
            END IF
            IF NOT cl_null(g_xrce_d[l_ac].xrce101) AND NOT cl_null(g_xrce_d[l_ac].xrce109) THEN
               LET g_xrce_d[l_ac].xrce119 = g_xrce_d[l_ac].xrce109* g_xrce_d[l_ac].xrce101
               DISPLAY g_xrce_d[l_ac].xrce119 TO s_detail3[l_ac].xrce119
            END IF]]>
  </point>
  <point name="input.a.page1.xrce109" order="" ver="4" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xrce_d[l_ac].xrce101) AND NOT cl_null(g_xrce_d[l_ac].xrce109) THEN
               LET g_xrce_d[l_ac].xrce119 = g_xrce_d[l_ac].xrce109 * g_xrce_d[l_ac].xrce101
               LET g_xrce_d[l_ac].xrce119 = s_curr_round(g_glaa_t.glaacomp,g_glaa_t.glaa001,g_xrce_d[l_ac].xrce119,2)
               DISPLAY g_xrce_d[l_ac].xrce119 TO s_detail1[l_ac].xrce119
               IF g_glaa_t.glaa015 = 'Y' THEN
               LET g_xrce2_d[l_ac].xrce129 = g_xrce_d[l_ac].xrce109 * g_xrce2_d[l_ac].xrce121
               LET g_xrce2_d[l_ac].xrce129 = s_curr_round(g_glaa_t.glaacomp,g_xrce2_d[l_ac].xrce120,g_xrce2_d[l_ac].xrce121,2)
               END IF
               IF g_glaa_t.glaa015 = 'Y' THEN
               LET g_xrce2_d[l_ac].xrce139 = g_xrce_d[l_ac].xrce109 * g_xrce2_d[l_ac].xrce131
               LET g_xrce2_d[l_ac].xrce139 = s_curr_round(g_glaa_t.glaacomp,g_xrce2_d[l_ac].xrce130,g_xrce2_d[l_ac].xrce131,2)
               END IF
            END IF
            
            IF NOT cl_null(g_xrce_d[l_ac].xrce109) AND NOT cl_null(g_xrce_d[l_ac].xrce003) AND g_xrce_d[l_ac].xrce002 = '10' THEN
               CALL axrt300_02_chk_xrde109()
               IF NOT cl_null(g_errno) THEN
                  LET l_xrce109 = g_xrce_d[l_ac].xrce109
                  IF l_cmd = 'a' THEN
                     LET g_xrce_d[l_ac].xrce109 = 0
                  ELSE
                     LET g_xrce_d[l_ac].xrce109 = g_xrce_d_t.xrce109
                  END IF
                  DISPLAY g_xrce_d[l_ac].xrce109 TO s_detail1[l_ac].xrce109
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = g_errno
                  LET g_errparam.extend = l_xrce109
                  LET g_errparam.popup = TRUE
                  CALL cl_err()

                  NEXT FIELD xrce109
               END IF
            END IF 
            
            IF NOT cl_null(g_xrce_d[l_ac].xrce109) AND NOT cl_null(g_xrce_d[l_ac].xrce003)  
               AND (g_xrce_d[l_ac].xrce002 = '31' OR g_xrce_d[l_ac].xrce002 = '32') THEN
               CALL axrt300_02_chk_xrce109()
               IF NOT cl_null(g_errno) THEN
                  LET l_xrce109 = g_xrce_d[l_ac].xrce109
                  IF l_cmd = 'a' THEN
                     LET g_xrce_d[l_ac].xrce109 = 0
                  ELSE
                     LET g_xrce_d[l_ac].xrce109 = g_xrce_d_t.xrce109
                  END IF
                  DISPLAY g_xrce_d[l_ac].xrce109 TO s_detail1[l_ac].xrce109
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = g_errno
                  LET g_errparam.extend = l_xrce109
                  LET g_errparam.popup = TRUE
                  CALL cl_err()

                  NEXT FIELD xrce109
               END IF
            END IF
            
            #------------------------------
#            IF NOT cl_null(g_xrce_d[l_ac].xrce109) AND NOT cl_null(g_xrce_d[l_ac].xrce003) AND g_xrce_d[l_ac].xrce002 = '10' THEN
#               CALL axrt300_02_chk_xrce109()
#               IF NOT cl_null(g_errno) THEN
#                  IF l_cmd = 'a' THEN
#                     DISPLAY 0 TO s_detail1[l_ac].xrce109
#                  ELSE
#                     DISPLAY g_xrce_t.xrce109 TO s_detail1[l_ac].xrce109
#                  END IF
#                  INITIALIZE g_errparam TO NULL
#                  LET g_errparam.code = g_errno
#                  LET g_errparam.extend = g_xrce_d[l_ac].xrce109
#                  LET g_errparam.popup = TRUE
#                  CALL cl_err()
#
#                  IF l_cmd = 'a' THEN
#                     LET g_xrce_d[l_ac].xrce109 = 0
#                  ELSE
#                     LET g_xrce_d[l_ac].xrce109 = g_xrce_t.xrce109
#                  END IF
#                  DISPLAY g_xrce_d[l_ac].xrce109 TO s_detail1[l_ac].xrce109
#                  NEXT FIELD xrce109
#               END IF
#            END IF
#            IF NOT cl_null(g_xrce_d[l_ac].xrce101) AND NOT cl_null(g_xrce_d[l_ac].xrce109) THEN
#               LET g_xrce_d[l_ac].xrce119 = g_xrce_d[l_ac].xrce109 * g_xrce_d[l_ac].xrce101
#               LET g_xrce_d[l_ac].xrce119 = s_curr_round(g_glaa_t.glaacomp,g_glaa_t.glaa001,g_xrce_d[l_ac].xrce119,2)
#               DISPLAY g_xrce_d[l_ac].xrce119 TO s_detail1[l_ac].xrce119
#               IF g_glaa_t.glaa015 = 'Y' THEN
#               LET g_xrce2_d[l_ac].xrce129 = g_xrce_d[l_ac].xrce109 * g_xrce2_d[l_ac].xrce121
#               LET g_xrce2_d[l_ac].xrce129 = s_curr_round(g_glaa_t.glaacomp,g_xrce2_d[l_ac].xrce120,g_xrce2_d[l_ac].xrce121,2)
#               END IF
#               IF g_glaa_t.glaa015 = 'Y' THEN
#               LET g_xrce2_d[l_ac].xrce139 = g_xrce_d[l_ac].xrce109 * g_xrce2_d[l_ac].xrce131
#               LET g_xrce2_d[l_ac].xrce139 = s_curr_round(g_glaa_t.glaacomp,g_xrce2_d[l_ac].xrce130,g_xrce2_d[l_ac].xrce131,2)
#               END IF
#            END IF
#            IF NOT cl_null(g_xrce_d[l_ac].xrce109) AND NOT cl_null(g_xrce_d[l_ac].xrce024) AND g_xrce_d[l_ac].xrce002 = '31' THEN
#               CALL axrt300_02_chk_xrce109_1()
#               IF NOT cl_null(g_errno) THEN
#                  IF l_cmd = 'a' THEN
#                     DISPLAY 0 TO s_detail1[l_ac].xrce109
#                  ELSE
#                     DISPLAY g_xrce_t.xrce109 TO s_detail1[l_ac].xrce109
#                  END IF
#                  INITIALIZE g_errparam TO NULL
#                  LET g_errparam.code = g_errno
#                  LET g_errparam.extend = g_xrce_d[l_ac].xrce109
#                  LET g_errparam.popup = TRUE
#                  CALL cl_err()
#
#                  IF l_cmd = 'a' THEN
#                     LET g_xrce_d[l_ac].xrce109 = 0
#                  ELSE
#                     LET g_xrce_d[l_ac].xrce109 = g_xrce_t.xrce109
#                  END IF
#                  DISPLAY g_xrce_d[l_ac].xrce109 TO s_detail1[l_ac].xrce109
#                  NEXT FIELD xrce109
#               END IF
#            END IF
#            IF NOT cl_null(g_xrce3_d[l_ac].xrce101) AND NOT cl_null(g_xrce_d[l_ac].xrce109) THEN
#               LET g_xrce3_d[l_ac].xrce119 = g_xrce_d[l_ac].xrce109 * g_xrce3_d[l_ac].xrce101
#               DISPLAY g_xrce3_d[l_ac].xrce119 TO s_detail3[l_ac].xrce119_1
#            END IF
#            LET g_xrce_t.xrce109 = g_xrce_d[l_ac].xrce109]]>
  </point>
  <point name="input.a.page1.xrce119" order="" ver="4" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xrce_d[l_ac].xrce109) AND NOT cl_null(g_xrce_d[l_ac].xrce003) AND g_xrce_d[l_ac].xrce002 = '10' THEN
               CALL axrt300_02_chk_xrde109()
               IF NOT cl_null(g_errno) THEN
                  LET l_xrce119 = g_xrce_d[l_ac].xrce119
                  IF l_cmd = 'a' THEN
                     LET g_xrce_d[l_ac].xrce119 = 0
                  ELSE
                     LET g_xrce_d[l_ac].xrce119 = g_xrce_d_t.xrce119
                  END IF
                  DISPLAY g_xrce_d[l_ac].xrce119 TO s_detail1[l_ac].xrce119
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = g_errno
                  LET g_errparam.extend = l_xrce119
                  LET g_errparam.popup = TRUE
                  CALL cl_err()

                  NEXT FIELD xrce119
               END IF
            END IF 
            
            IF NOT cl_null(g_xrce_d[l_ac].xrce109) AND NOT cl_null(g_xrce_d[l_ac].xrce003)  
               AND (g_xrce_d[l_ac].xrce002 = '31' OR g_xrce_d[l_ac].xrce002 = '32') THEN
               CALL axrt300_02_chk_xrce109()
               IF NOT cl_null(g_errno) THEN
                  LET l_xrce119 = g_xrce_d[l_ac].xrce119
                  IF l_cmd = 'a' THEN
                     LET g_xrce_d[l_ac].xrce119 = 0
                  ELSE
                     LET g_xrce_d[l_ac].xrce119 = g_xrce_d_t.xrce119
                  END IF
                  DISPLAY g_xrce_d[l_ac].xrce119 TO s_detail1[l_ac].xrce119
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = g_errno
                  LET g_errparam.extend = l_xrce119
                  LET g_errparam.popup = TRUE
                  CALL cl_err()

                  NEXT FIELD xrce119
               END IF
            END IF



#            IF NOT cl_null(g_xrce_d[l_ac].xrce119) AND NOT cl_null(g_xrce_d[l_ac].xrce003) AND g_xrce_d[l_ac].xrce002 = '10' THEN
#               CALL axrt300_02_chk_xrce109()
#               IF NOT cl_null(g_errno) THEN
#                  IF l_cmd = 'a' THEN
#                     DISPLAY 0 TO s_detail1[l_ac].xrce119
#                  ELSE
#                     DISPLAY g_xrce_t.xrce119 TO s_detail1[l_ac].xrce119
#                  END IF
#                  INITIALIZE g_errparam TO NULL
#                  LET g_errparam.code = g_errno
#                  LET g_errparam.extend = g_xrce_d[l_ac].xrce119
#                  LET g_errparam.popup = TRUE
#                  CALL cl_err()
#
#                  IF l_cmd = 'a' THEN
#                     LET g_xrce_d[l_ac].xrce119 = 0
#                  ELSE
#                     LET g_xrce_d[l_ac].xrce119 = g_xrce_t.xrce119
#                  END IF
#                  DISPLAY g_xrce_d[l_ac].xrce119 TO s_detail1[l_ac].xrce119
#                  NEXT FIELD xrce119
#               END IF
#            END IF
#            IF NOT cl_null(g_xrce_d[l_ac].xrce119) AND NOT cl_null(g_xrce_d[l_ac].xrce101) THEN
#               LET g_xrce_d[l_ac].xrce109 = g_xrce_d[l_ac].xrce119 / g_xrce_d[l_ac].xrce101
#               LET g_xrce_d[l_ac].xrce109 = s_curr_round(g_glaa_t.glaacomp,g_xrce_d[l_ac].xrce100,g_xrce_d[l_ac].xrce109,2)
#               DISPLAY g_xrce_d[l_ac].xrce109 TO s_detail1[l_ac].xrce109
#               IF g_glaa_t.glaa015 = 'Y' THEN
#               LET g_xrce2_d[l_ac].xrce129 = g_xrce_d[l_ac].xrce109 * g_xrce2_d[l_ac].xrce121
#               LET g_xrce2_d[l_ac].xrce129 = s_curr_round(g_glaa_t.glaacomp,g_xrce2_d[l_ac].xrce120,g_xrce2_d[l_ac].xrce121,2)
#               END IF 
#               IF g_glaa_t.glaa019 = 'Y' THEN
#               LET g_xrce2_d[l_ac].xrce139 = g_xrce_d[l_ac].xrce109 * g_xrce2_d[l_ac].xrce131
#               LET g_xrce2_d[l_ac].xrce139 = s_curr_round(g_glaa_t.glaacomp,g_xrce2_d[l_ac].xrce130,g_xrce2_d[l_ac].xrce131,2)
#               END IF
#            END IF
#            IF NOT cl_null(g_xrce3_d[l_ac].xrce119) AND NOT cl_null(g_xrce_d[l_ac].xrce024) AND g_xrce_d[l_ac].xrce002 = '31' THEN
#               CALL axrt300_02_chk_xrce109_1()
#               IF NOT cl_null(g_errno) THEN
#                  IF l_cmd = 'a' THEN
#                     DISPLAY 0 TO s_detail1[l_ac].xrce119
#                  ELSE
#                     DISPLAY g_xrce_t.xrce119 TO s_detail1[l_ac].xrce119
#                  END IF
#                  INITIALIZE g_errparam TO NULL
#                  LET g_errparam.code = g_errno
#                  LET g_errparam.extend = g_xrce_d[l_ac].xrce119
#                  LET g_errparam.popup = TRUE
#                  CALL cl_err()
#
#                  IF l_cmd = 'a' THEN
#                     LET g_xrce_d[l_ac].xrce119 = 0
#                  ELSE
#                     LET g_xrce_d[l_ac].xrce119 = g_xrce_t.xrce119
#                  END IF
#                  DISPLAY g_xrce_d[l_ac].xrce119 TO s_detail1[l_ac].xrce119
#                  NEXT FIELD xrce119
#               END IF
#            END IF
#            IF NOT cl_null(g_xrce3_d[l_ac].xrce119) AND NOT cl_null(g_xrce_d[l_ac].xrce109) THEN
#               LET g_xrce3_d[l_ac].xrce101 = g_xrce3_d[l_ac].xrce119 / g_xrce_d[l_ac].xrce109
#               DISPLAY g_xrce3_d[l_ac].xrce119 TO s_detail3[l_ac].xrce119_1
#            END IF
#            LET g_xrce_t.xrce119 = g_xrce3_d[l_ac].xrce119]]>
  </point>
  <point name="input.a.page1.xrde012_u" order="" ver="7" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[             IF NOT cl_null(g_xrce_d[l_ac].xrde012) THEN
                SELECT glaa005 INTO l_glaa005 FROM glaa_t WHERE glaaent = g_enterprise AND glaald = g_xrca_t.xrcald
                IF NOT ap_chk_isExist(g_xrce_d[l_ac].xrde012,"SELECT COUNT(*) FROM nmai_t WHERE nmaient = '"
                   ||g_enterprise||"'  AND nmai001 = '"||l_glaa005||"' AND nmai002 = ? ",'anm-00008',0 ) THEN
                   NEXT FIELD CURRENT
                END IF
                IF NOT ap_chk_isExist(g_xrce_d[l_ac].xrde012,"SELECT COUNT(*) FROM nmai_t WHERE nmaient = '"
                   ||g_enterprise||"'  AND nmai001 = '"||l_glaa005||"' AND nmai002 = ? AND nmaistus = 'Y'",'anm-00021',0 ) THEN
                   NEXT FIELD CURRENT
                END IF
             END IF

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = l_glaa005
            LET g_ref_fields[2] = g_xrce_d[l_ac].xrde012
            CALL ap_ref_array2(g_ref_fields,"SELECT nmail004 FROM nmail_t WHERE nmailent='"||g_enterprise||"' AND nmail001=? AND nmail002=? AND nmail003='"||g_dlang||"'","")
               RETURNING g_rtn_fields
            LET g_xrce_d[l_ac].xrde012_u_desc = '', g_rtn_fields[1] , ''
]]>
  </point>
  <point name="input.a.page2.xrce101_t" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF cl_null(g_xrce2_d[l_ac].xrce003) AND cl_null(g_xrce2_d[l_ac].xrce101) 
               AND NOT cl_null(g_xrce2_d[l_ac].xrce109) AND NOT cl_null(g_xrce2_d[l_ac].xrce100) THEN
               SELECT ooab002 INTO l_ooab002 FROM ooab_t
                WHERE ooabent = g_enterprise
                  AND ooabsite= g_xrca_t.xrcasite
                  AND ooab001 = 'S-BAS-0010'
                                        #匯率參照表;帳套;           日期;               來源幣別
               CALL s_aooi160_get_exrate('2',g_xrca_t.xrcald,g_xrca_t.xrcadocdt,g_xrce2_d[l_ac].xrce100,
                                        #目的幣別;  交易金額;              匯類類型
                                         g_glaa_t.glaa001,0,l_ooab002)
                  RETURNING g_xrce2_d[l_ac].xrce101
               DISPLAY g_xrce2_d[l_ac].xrce101 TO s_detail2[l_ac].xrce101
            END IF
            IF NOT cl_null(g_xrce2_d[l_ac].xrce101) AND NOT cl_null(g_xrce2_d[l_ac].xrce109) THEN
               LET g_xrce2_d[l_ac].xrce119 = g_xrce2_d[l_ac].xrce109 * g_xrce2_d[l_ac].xrce101
               DISPLAY g_xrce2_d[l_ac].xrce119 TO s_detail2[l_ac].xrce119
            END IF
            IF cl_null(g_xrce_d[l_ac].xrce024) AND cl_null(g_xrce2_d[l_ac].xrce101) 
               AND NOT cl_null(g_xrce2_d[l_ac].xrce109) AND NOT cl_null(g_xrce2_d[l_ac].xrce100) THEN
               SELECT ooab002 INTO l_ooab002 FROM ooab_t
                WHERE ooabent = g_enterprise
                  AND ooabsite= g_xrca_t.xrcasite
                  AND ooab001 = 'S-BAS-0010'
                                        #匯率參照表;帳套;           日期;               來源幣別
               CALL s_aooi160_get_exrate('2',g_xrca_t.xrcald,g_xrca_t.xrcadocdt,g_xrce2_d[l_ac].xrce100,
                                        #目的幣別;  交易金額;              匯類類型
                                         g_glaa_t.glaa001,g_xrce2_d[l_ac].xrce109,l_ooab002)
                  RETURNING g_xrce2_d[l_ac].xrce101
               DISPLAY g_xrce2_d[l_ac].xrce101 TO s_detail3[l_ac].xrce101
            END IF
            IF NOT cl_null(g_xrce2_d[l_ac].xrce101) AND NOT cl_null(g_xrce2_d[l_ac].xrce109) THEN
               LET g_xrce2_d[l_ac].xrce119 = g_xrce2_d[l_ac].xrce109* g_xrce2_d[l_ac].xrce101
               DISPLAY g_xrce2_d[l_ac].xrce119 TO s_detail3[l_ac].xrce119
            END IF
            LET g_xrce_d[l_ac].xrce109 = g_xrce2_d[l_ac].xrce109
            LET g_xrce_d[l_ac].xrce101 = g_xrce2_d[l_ac].xrce101
            LET g_xrce_d[l_ac].xrce119 = g_xrce2_d[l_ac].xrce119]]>
  </point>
  <point name="input.a.page2.xrce109_t" order="" ver="4" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xrce2_d[l_ac].xrce109) AND NOT cl_null(g_xrce2_d[l_ac].xrce003) AND g_xrce2_d[l_ac].xrce002 = '10' THEN
               LET g_xrce_d[l_ac].xrce109 = g_xrce2_d[l_ac].xrce109
               LET g_xrce_d[l_ac].xrce101 = g_xrce2_d[l_ac].xrce101
               LET g_xrce_d[l_ac].xrce119 = g_xrce2_d[l_ac].xrce119
               CALL axrt300_02_chk_xrce109()
               IF NOT cl_null(g_errno) THEN
                  IF l_cmd = 'a' THEN
                     DISPLAY 0 TO s_detail2[l_ac].xrce109
                  ELSE
                     DISPLAY g_xrce_t.xrce109 TO s_detail2[l_ac].xrce109
                  END IF
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = g_errno
                  LET g_errparam.extend = g_xrce2_d[l_ac].xrce109
                  LET g_errparam.popup = TRUE
                  CALL cl_err()

                  IF l_cmd = 'a' THEN
                     LET g_xrce2_d[l_ac].xrce109 = 0
                  ELSE
                     LET g_xrce2_d[l_ac].xrce109 = g_xrce_t.xrce109
                  END IF
                  DISPLAY g_xrce2_d[l_ac].xrce109 TO s_detail2[l_ac].xrce109
                  NEXT FIELD xrce109_t
               END IF
            END IF
            IF NOT cl_null(g_xrce2_d[l_ac].xrce101) AND NOT cl_null(g_xrce2_d[l_ac].xrce109) THEN
               LET g_xrce2_d[l_ac].xrce119 = g_xrce2_d[l_ac].xrce109 * g_xrce2_d[l_ac].xrce101
               LET g_xrce2_d[l_ac].xrce119 = s_curr_round(g_glaa_t.glaacomp,g_glaa_t.glaa001,g_xrce2_d[l_ac].xrce119,2)
               DISPLAY g_xrce2_d[l_ac].xrce119 TO s_detail2[l_ac].xrce119
               IF g_glaa_t.glaa015 = 'Y' THEN
                  LET g_xrce2_d[l_ac].xrce129 = g_xrce2_d[l_ac].xrce109 * g_xrce2_d[l_ac].xrce121
                  LET g_xrce2_d[l_ac].xrce129 = s_curr_round(g_glaa_t.glaacomp,g_xrce2_d[l_ac].xrce120,g_xrce2_d[l_ac].xrce121,2)
               END IF
               IF g_glaa_t.glaa019 = 'Y' THEN
                  LET g_xrce2_d[l_ac].xrce139 = g_xrce2_d[l_ac].xrce109 * g_xrce2_d[l_ac].xrce131
                  LET g_xrce2_d[l_ac].xrce139 = s_curr_round(g_glaa_t.glaacomp,g_xrce2_d[l_ac].xrce130,g_xrce2_d[l_ac].xrce131,2)
               END IF
            END IF
            IF NOT cl_null(g_xrce2_d[l_ac].xrce109) AND NOT cl_null(g_xrce_d[l_ac].xrce024) AND g_xrce2_d[l_ac].xrce002 = '31' THEN
               LET g_xrce_d[l_ac].xrce109 = g_xrce2_d[l_ac].xrce109
               LET g_xrce_d[l_ac].xrce101 = g_xrce2_d[l_ac].xrce101
               LET g_xrce_d[l_ac].xrce119 = g_xrce2_d[l_ac].xrce119
               CALL axrt300_02_chk_xrce109_1()
               IF NOT cl_null(g_errno) THEN
                  IF l_cmd = 'a' THEN
                     DISPLAY 0 TO s_detail2[l_ac].xrce109
                  ELSE
                     DISPLAY g_xrce_t.xrce109 TO s_detail2[l_ac].xrce109
                  END IF
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = g_errno
                  LET g_errparam.extend = g_xrce2_d[l_ac].xrce109
                  LET g_errparam.popup = TRUE
                  CALL cl_err()

                  IF l_cmd = 'a' THEN
                     LET g_xrce2_d[l_ac].xrce109 = 0
                  ELSE
                     LET g_xrce2_d[l_ac].xrce109 = g_xrce_t.xrce109
                  END IF
                  DISPLAY g_xrce2_d[l_ac].xrce109 TO s_detail2[l_ac].xrce109
                  NEXT FIELD xrce109_t
               END IF
            END IF
            IF NOT cl_null(g_xrce2_d[l_ac].xrce101) AND NOT cl_null(g_xrce2_d[l_ac].xrce109) THEN
               LET g_xrce2_d[l_ac].xrce119 = g_xrce2_d[l_ac].xrce109 * g_xrce2_d[l_ac].xrce101
               DISPLAY g_xrce3_d[l_ac].xrce119 TO s_detail2[l_ac].xrce119
            END IF
            LET g_xrce_t.xrce109 = g_xrce2_d[l_ac].xrce109
            LET g_xrce_d[l_ac].xrce109 = g_xrce2_d[l_ac].xrce109]]>
  </point>
  <point name="input.a.page2.xrce119_t" order="" ver="4" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xrce2_d[l_ac].xrce119) AND NOT cl_null(g_xrce2_d[l_ac].xrce003) AND g_xrce2_d[l_ac].xrce002 = '10' THEN
               CALL axrt300_02_chk_xrce109()
               IF NOT cl_null(g_errno) THEN
                  IF l_cmd = 'a' THEN
                     DISPLAY 0 TO s_detail2[l_ac].xrce119
                  ELSE
                     DISPLAY g_xrce_t.xrce119 TO s_detail2[l_ac].xrce119
                  END IF
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = g_errno
                  LET g_errparam.extend = g_xrce2_d[l_ac].xrce119
                  LET g_errparam.popup = TRUE
                  CALL cl_err()

                  IF l_cmd = 'a' THEN
                     LET g_xrce2_d[l_ac].xrce119 = 0
                  ELSE
                     LET g_xrce2_d[l_ac].xrce119 = g_xrce_t.xrce119
                  END IF
                  DISPLAY g_xrce2_d[l_ac].xrce119 TO s_detail2[l_ac].xrce119
                  NEXT FIELD xrce119_t
               END IF
            END IF
            IF NOT cl_null(g_xrce2_d[l_ac].xrce119) AND NOT cl_null(g_xrce2_d[l_ac].xrce101) THEN
               LET g_xrce2_d[l_ac].xrce109 = g_xrce2_d[l_ac].xrce119 / g_xrce2_d[l_ac].xrce101
               LET g_xrce2_d[l_ac].xrce109 = s_curr_round(g_glaa_t.glaacomp,g_xrce2_d[l_ac].xrce100,g_xrce2_d[l_ac].xrce109,2)
               DISPLAY g_xrce2_d[l_ac].xrce109 TO s_detail2[l_ac].xrce109
               IF g_glaa_t.glaa015 = 'Y' THEN
                  LET g_xrce2_d[l_ac].xrce129 = g_xrce2_d[l_ac].xrce109 * g_xrce2_d[l_ac].xrce121
                  LET g_xrce2_d[l_ac].xrce129 = s_curr_round(g_glaa_t.glaacomp,g_xrce2_d[l_ac].xrce120,g_xrce2_d[l_ac].xrce121,2)
               END IF
               IF g_glaa_t.glaa019 = 'Y' THEN
                  LET g_xrce2_d[l_ac].xrce139 = g_xrce2_d[l_ac].xrce109 * g_xrce2_d[l_ac].xrce131
                  LET g_xrce2_d[l_ac].xrce139 = s_curr_round(g_glaa_t.glaacomp,g_xrce2_d[l_ac].xrce130,g_xrce2_d[l_ac].xrce131,2)
               END IF
            END IF
            IF NOT cl_null(g_xrce2_d[l_ac].xrce119) AND NOT cl_null(g_xrce_d[l_ac].xrce024) AND g_xrce2_d[l_ac].xrce002 = '31' THEN
               CALL axrt300_02_chk_xrce109_1()
               IF NOT cl_null(g_errno) THEN
                  IF l_cmd = 'a' THEN
                     DISPLAY 0 TO s_detail2[l_ac].xrce119
                  ELSE
                     DISPLAY g_xrce_t.xrce119 TO s_detail2[l_ac].xrce119
                  END IF
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = g_errno
                  LET g_errparam.extend = g_xrce2_d[l_ac].xrce119
                  LET g_errparam.popup = TRUE
                  CALL cl_err()

                  IF l_cmd = 'a' THEN
                     LET g_xrce2_d[l_ac].xrce119 = 0
                  ELSE
                     LET g_xrce2_d[l_ac].xrce119 = g_xrce_t.xrce119
                  END IF
                  DISPLAY g_xrce2_d[l_ac].xrce119 TO s_detail2[l_ac].xrce119
                  NEXT FIELD xrce119_t
               END IF
            END IF
            IF NOT cl_null(g_xrce2_d[l_ac].xrce119) AND NOT cl_null(g_xrce2_d[l_ac].xrce109) THEN
               LET g_xrce2_d[l_ac].xrce101 = g_xrce2_d[l_ac].xrce119 / g_xrce2_d[l_ac].xrce109
               DISPLAY g_xrce2_d[l_ac].xrce119 TO s_detail2[l_ac].xrce119
            END IF
            LET g_xrce_t.xrce119 = g_xrce2_d[l_ac].xrce119
            LET g_xrce_d[l_ac].xrce109 = g_xrce2_d[l_ac].xrce109
            LET g_xrce_d[l_ac].xrce101 = g_xrce2_d[l_ac].xrce101
            LET g_xrce_d[l_ac].xrce119 = g_xrce2_d[l_ac].xrce119]]>
  </point>
  <point name="input.a.page2.xrce121" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF g_glaa_t.glaa017 = '1' THEN
               LET l_glaa001 = g_xrce2_d[l_ac].xrce100
               LET l_amt     = g_xrce2_d[l_ac].xrce109
            ELSE
               LET l_glaa001 = g_glaa_t.glaa001
               LET l_amt     = g_xrce2_d[l_ac].xrce119
            END IF
            IF cl_null(g_xrce2_d[l_ac].xrce003) AND cl_null(g_xrce2_d[l_ac].xrce121) AND NOT cl_null(g_xrce2_d[l_ac].xrce100) THEN
                                        #匯率參照表;       帳套;           日期;               來源幣別
               CALL s_aooi160_get_exrate('2',g_xrca_t.xrcald,g_xrca_t.xrcadocdt,l_glaa001,
                                        #目的幣別;         交易金額; 匯類類型
                                         g_glaa_t.glaa016,l_amt,l_ooab002)
                  RETURNING g_xrce2_d[l_ac].xrce121
               DISPLAY g_xrce2_d[l_ac].xrce121 TO s_detail2[l_ac].xrce121
            END IF
            IF NOT cl_null(g_xrce2_d[l_ac].xrce121) AND NOT cl_null(l_amt) THEN
               LET g_xrce2_d[l_ac].xrce129 = l_amt * g_xrce2_d[l_ac].xrce121
               DISPLAY g_xrce2_d[l_ac].xrce129 TO s_detail2[l_ac].xrce129
            END IF]]>
  </point>
  <point name="input.a.page2.xrce129" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF g_glaa_t.glaa017 = '1' THEN
               LET l_amt = g_xrce2_d[l_ac].xrce109
            ELSE
               LET l_amt = g_xrce2_d[l_ac].xrce119
            END IF
            IF cl_null(g_xrce2_d[l_ac].xrce129) AND NOT cl_null(g_xrce2_d[l_ac].xrce121) THEN
                  LET g_xrce2_d[l_ac].xrce129 = l_amt * g_xrce2_d[l_ac].xrce121
            END IF
            IF NOT cl_null(g_xrce2_d[l_ac].xrce129) AND NOT cl_null(l_amt) THEN
               LET g_xrce2_d[l_ac].xrce121 = g_xrce2_d[l_ac].xrce129 / l_amt
               DISPLAY g_xrce2_d[l_ac].xrce121 TO s_detail2[l_ac].xrce121
            END IF]]>
  </point>
  <point name="input.a.page2.xrce131" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF g_glaa_t.glaa021 = '1' THEN
               LET l_glaa001 = g_xrce2_d[l_ac].xrce100
               LET l_amt     = g_xrce2_d[l_ac].xrce109
            ELSE
               LET l_glaa001 = g_glaa_t.glaa001
               LET l_amt     = g_xrce2_d[l_ac].xrce119
            END IF
            IF cl_null(g_xrce_d[l_ac].xrce024) AND cl_null(g_xrce2_d[l_ac].xrce131) AND NOT cl_null(g_xrce2_d[l_ac].xrce100) THEN
                                        #匯率參照表;帳套;           日期;               來源幣別
               CALL s_aooi160_get_exrate('2',g_xrca_t.xrcald,g_xrca_t.xrcadocdt,g_glaa_t.glaa001,
                                        #目的幣別;  交易金額;              匯類類型
                                         g_glaa_t.glaa016,l_amt,l_ooab002)
                  RETURNING g_xrce2_d[l_ac].xrce131
               DISPLAY g_xrce2_d[l_ac].xrce131 TO s_detail2[l_ac].xrce131
            END IF
            IF NOT cl_null(g_xrce2_d[l_ac].xrce131) AND NOT cl_null(l_amt) THEN
               LET g_xrce2_d[l_ac].xrce139 = l_amt * g_xrce2_d[l_ac].xrce131
               DISPLAY g_xrce2_d[l_ac].xrce139 TO s_detail2[l_ac].xrce139
            END IF]]>
  </point>
  <point name="input.a.page2.xrce139" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF g_glaa_t.glaa021 = '1' THEN
               LET l_amt = g_xrce2_d[l_ac].xrce109
            ELSE
               LET l_amt = g_xrce2_d[l_ac].xrce119
            END IF
            IF cl_null(g_xrce2_d[l_ac].xrce139) AND NOT cl_null(g_xrce2_d[l_ac].xrce131) THEN
               LET g_xrce2_d[l_ac].xrce139 = l_amt * g_xrce2_d[l_ac].xrce131
            END IF
            IF NOT cl_null(g_xrce2_d[l_ac].xrce139) AND NOT cl_null(l_amt) THEN
               LET g_xrce2_d[l_ac].xrce131 = g_xrce2_d[l_ac].xrce139 / l_amt
               DISPLAY g_xrce2_d[l_ac].xrce131 TO s_detail2[l_ac].xrce131
            END IF]]>
  </point>
  <point name="input.a.page3.xrce010_u" order="" ver="4" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xrce3_d[l_ac].xrce010) THEN
              LET g_msg = g_xrce3_d[l_ac].xrce010
              IF g_msg[1,1] = '.' THEN
                 LET g_msg = g_msg[2,10]
                 SELECT oocql004 INTO g_xrce3_d[l_ac].xrce010 FROM oocql_t
                  WHERE oocqlent = g_enterprise
                    AND oocql001 = '3005'
                    AND oocql002 = g_msg
                    AND oocql003 = g_lang
                 DISPLAY g_xrce3_d[l_ac].xrce010 TO s_detail3[l_ac].xrce010
              END IF
           END IF]]>
  </point>
  <point name="input.a.page3.xrce016" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xrce3_d[l_ac].xrce016) THEN
               SELECT glacstus INTO l_glacstus FROM glac_t
                WHERE glacent = g_enterprise
                  AND glac001 = g_glaa_t.glaa004
                  AND glac002 = g_xrce3_d[l_ac].xrce016
               LET g_errno = ' '
               CASE
                  WHEN SQLCA.SQLCODE = 100
                     LET g_errno = 'agl-00011'
                  WHEN l_glacstus = 'N'
                     LET g_errno = 'agl-00012'
               END CASE
               IF NOT cl_null(g_errno) THEN
                  IF l_cmd = 'a' THEN
                     LET g_xrce3_d[l_ac].xrce016_desc = ''
                     DISPLAY '','' TO s_detail3[l_ac].xrce016,s_detail3[l_ac].xrce016_desc
                  ELSE
                     INITIALIZE g_ref_fields TO NULL
                     LET g_ref_fields[1] = g_xrce3_d_t.xrce016
                     CALL ap_ref_array2(g_ref_fields,"SELECT glacl004 FROM glacl_t WHERE glaclent='"||g_enterprise||"' AND glacl001='"||g_glaa_t.glaa004||"' AND glacl002=? AND glacl003='"||g_lang||"'","") RETURNING g_rtn_fields
                     LET g_xrce3_d[l_ac].xrce016_desc = '', g_rtn_fields[1] , ''
                     DISPLAY g_xrce3_d_t.xrce016,g_xrce3_d[l_ac].xrce016_desc TO s_detail3[l_ac].xrce016,s_detail3[l_ac].xrce016_desc
                  END IF
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = g_errno
                  LET g_errparam.extend = g_xrce3_d[l_ac].xrce016
                  LET g_errparam.popup = TRUE
                  CALL cl_err()

                  IF l_cmd = 'a' THEN
                     LET g_xrce3_d[l_ac].xrce016 = ''
                  ELSE
                     LET g_xrce3_d[l_ac].xrce016 = g_xrce3_d_t.xrce016
                  END IF
                  DISPLAY g_xrce3_d[l_ac].xrce016 TO s_detail3[l_ac].xrce016
                  NEXT FIELD xrce016
               END IF
            END IF
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xrce3_d[l_ac].xrce016
            CALL ap_ref_array2(g_ref_fields,"SELECT glacl004 FROM glacl_t WHERE glaclent='"||g_enterprise||"' AND glacl001='"||g_glaa_t.glaa004||"' AND glacl002=? AND glacl003='"||g_lang||"'","") RETURNING g_rtn_fields
            LET g_xrce3_d[l_ac].xrce016_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xrce3_d[l_ac].xrce016_desc
            ]]>
  </point>
  <point name="input.a.page3.xrce016_u" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
]]>
  </point>
  <point name="input.a.page3.xrce017" order="" ver="2" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xrce3_d[l_ac].xrce017) THEN
               SELECT ooagstus INTO l_ooagstus FROM ooag_t
                WHERE ooag001 = g_xrce3_d[l_ac].xrce017
               LET g_errno = ' '
               CASE
                  WHEN SQLCA.SQLCODE = 100              #存在性
                     LET g_errno = 'aim-00069' RETURN
                  WHEN l_ooagstus = 'N'                 #有效性
                     LET g_errno = 'aim-00070' RETURN
               END CASE
               IF NOT cl_null(g_errno) THEN
                  IF l_cmd = 'a' THEN
                     DISPLAY '','' TO s_detail3[l_ac].xrce017,s_detail3[l_ac].xrce017_desc
                  ELSE
                     DISPLAY g_xrce3_d_t.xrce017 TO s_detail3[l_ac].xrce017
                     LET g_ref_fields[1] = g_xrce3_d_t.xrce017
                     CALL ap_ref_array2(g_ref_fields,"SELECT ooag011 FROM ooag_t WHERE ooagent='"||g_enterprise||"' AND ooag001=? ","") RETURNING g_rtn_fields
                     LET g_xrce3_d[l_ac].xrce017_desc = '', g_rtn_fields[1] , ''
                     DISPLAY BY NAME g_xrce3_d[l_ac].xrce017_desc
                  END IF
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = g_errno
                  LET g_errparam.extend = g_xrce3_d[l_ac].xrce017
                  LET g_errparam.popup = TRUE
                  CALL cl_err()

                  IF l_cmd = 'a' THEN
                     LET g_xrce3_d[l_ac].xrce017 = ''
                  ELSE
                     LET g_xrce3_d[l_ac].xrce017 =  g_xrce3_d_t.xrce017
                  END IF
                  DISPLAY g_xrce3_d[l_ac].xrce017 TO s_detail3[l_ac].xrce017
                  NEXT FIELD xrce017
               END IF
            END IF
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xrce3_d[l_ac].xrce017
            CALL ap_ref_array2(g_ref_fields,"SELECT ooag011 FROM ooag_t WHERE ooagent='"||g_enterprise||"' AND ooag001=? ","") RETURNING g_rtn_fields
            LET g_xrce3_d[l_ac].xrce017_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xrce3_d[l_ac].xrce017_desc]]>
  </point>
  <point name="input.a.page3.xrce018_u" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF NOT ap_chk_isExist(g_xrce3_d[l_ac].xrce018,"SELECT COUNT(*) FROM ooea_t WHERE "||"ooeaent = '" ||g_enterprise|| "' AND "||"ooea001 = ? ",'aoo-00094',1) THEN 
               LET g_xrce3_d[l_ac].xrce018 = g_xrce3_d_t.xrce018
               NEXT FIELD CURRENT
            END IF
            IF NOT ap_chk_isExist(g_xrce3_d[l_ac].xrce018,"SELECT COUNT(*) FROM ooea_t WHERE "||"ooeaent = '" ||g_enterprise|| "' AND "||"ooea001 = ? AND ooeastus = 'Y' ",'aoo-00095',1) THEN 
               LET g_xrce3_d[l_ac].xrce018 = g_xrce3_d_t.xrce018
               NEXT FIELD CURRENT
            END IF  
            IF NOT ap_chk_isExist(g_xrce3_d[l_ac].xrce018,"SELECT COUNT(*) FROM ooea_t WHERE "||"ooeaent = '" ||g_enterprise|| "' AND "||"ooea001 = ? AND ooeastus = 'Y' AND ooea016 = 'Y' ",'aoo-00092',1) THEN 
               LET g_xrce3_d[l_ac].xrce018 = g_xrce3_d_t.xrce018
               NEXT FIELD CURRENT
            END IF
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xrce3_d[l_ac].xrce018
            CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_xrce3_d[l_ac].xrce018_u_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xrce3_d[l_ac].xrce018_u_desc
]]>
  </point>
  <point name="input.a.page3.xrce019" order="" ver="2" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xrce3_d[l_ac].xrce019) THEN
               IF NOT ap_chk_isExist(g_xrce3_d[l_ac].xrce019,"SELECT COUNT(*) FROM ooea_t WHERE "||"ooeaent = '" ||g_enterprise|| "' AND "||"ooea001 = ? ",'aoo-00094',1) THEN 
                  LET g_xrce3_d[l_ac].xrce019 = g_xrce3_d_t.xrce019
                  NEXT FIELD CURRENT
               END IF
               IF NOT ap_chk_isExist(g_xrce3_d[l_ac].xrce019,"SELECT COUNT(*) FROM ooea_t WHERE "||"ooeaent = '" ||g_enterprise|| "' AND "||"ooea001 = ? AND ooeastus = 'Y' ",'aoo-00095',1) THEN 
                  LET g_xrce3_d[l_ac].xrce019 = g_xrce3_d_t.xrce019
                  NEXT FIELD CURRENT
               END IF
            END IF
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xrce3_d[l_ac].xrce019
            CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_lang||"'","") RETURNING g_rtn_fields
            LET g_xrce3_d[l_ac].xrce019_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xrce3_d[l_ac].xrce019_desc]]>
  </point>
  <point name="input.a.page3.xrce020" order="" ver="1" cite_std="" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[
]]>
  </point>
  <point name="input.b.page1.xrceseq" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF cl_null(g_xrce_d[l_ac].xrceseq) THEN
               SELECT MAX(xrceseq) INTO g_xrce_d[l_ac].xrceseq
                 FROM xrce_t
                WHERE xrceent = g_enterprise AND xrceld = g_xrce_d[l_ac].xrceld
                  AND xrcedocno = g_xrce_d[l_ac].xrcedocno
               IF cl_null(g_xrce_d[l_ac].xrceseq) THEN
                  LET g_xrce_d[l_ac].xrceseq = 1
               ELSE
                  LET g_xrce_d[l_ac].xrceseq = g_xrce_d[l_ac].xrceseq +1
               END IF
            END IF]]>
  </point>
  <point name="input.body.a_input" order="" ver="4" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            CALL axrt300_02_ref_amt()]]>
  </point>
  <point name="input.body.a_insert2" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[               CALL axrt300_02_ref_amt()]]>
  </point>
  <point name="input.body.a_update" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[               CALL axrt300_02_ref_amt()]]>
  </point>
  <point name="input.body.after_delete" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            CALL axrt300_02_ref_amt()]]>
  </point>
  <point name="input.body.b_delete" order="" ver="4" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[               SELECT gzcb004 INTO l_gzcb004
                 FROM gzcb_t
                WHERE gzcb001 = '8306'
                  AND gzcb002 = g_xrce_d[l_ac].xrce002
               IF l_gzcb004 = '2' THEN ]]>
  </point>
  <point name="input.body.b_update" order="" ver="4" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[               SELECT gzcb004 INTO l_gzcb004
                 FROM gzcb_t
                WHERE gzcb001 = '8306'
                  AND gzcb002 = g_xrce_d[l_ac].xrce002
               IF l_gzcb004 = '2' THEN ]]>
  </point>
  <point name="input.body.before_insert" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #帳別、單號賦值
            LET g_xrce_d[l_ac].xrceld = g_xrca_t.xrcald
            LET g_xrce_d[l_ac].xrcedocno = g_xrca_t.xrcadocno
            LET g_xrce_d[l_ac].xrce015 = 'C'
            LET g_xrce_d[l_ac].xrcesite = g_xrca_t.xrcasite
            IF cl_null(g_xrce_d[l_ac].xrceorga) THEN 
               LET g_xrce_d[l_ac].xrceorga = g_xrca_t.xrcacomp
            END IF
            
            #項次給默認值
            IF cl_null(g_xrce_d[l_ac].xrceseq) THEN
               SELECT MAX(xrceseq) INTO g_xrce_d[l_ac].xrceseq
                 FROM xrce_t
                WHERE xrceent = g_enterprise AND xrceld = g_xrce_d[l_ac].xrceld
                  AND xrcedocno = g_xrce_d[l_ac].xrcedocno
               IF cl_null(g_xrce_d[l_ac].xrceseq) THEN
                  LET g_xrce_d[l_ac].xrceseq = 1
               ELSE
                  LET g_xrce_d[l_ac].xrceseq = g_xrce_d[l_ac].xrceseq +1
               END IF
               SELECT MAX(xrdeseq) INTO g_xrce_d[l_ac].xrceseq
                 FROM xrde_t
                WHERE xrdeent = g_enterprise AND xrdeld = g_xrce_d[l_ac].xrceld
                  AND xrdedocno = g_xrce_d[l_ac].xrcedocno
               IF cl_null(g_xrce_d[l_ac].xrceseq) THEN
                  LET g_xrce_d[l_ac].xrceseq = 1
               ELSE
                  LET g_xrce_d[l_ac].xrceseq = g_xrce_d[l_ac].xrceseq +1
               END IF
            END IF]]>
  </point>
  <point name="input.body.before_row" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ELSE
               LET g_detail_idx = DIALOG.getCurrentRow("s_detail1")
               LET l_cmd = ''
               LET l_ac = g_detail_idx
               LET l_lock_sw = 'N'            #DEFAULT
               LET l_n = ARR_COUNT()
               DISPLAY l_ac TO FORMONLY.idx
               DISPLAY g_xrce_d.getLength() TO FORMONLY.cnt
               
               CALL s_transaction_begin()
               LET g_detail_cnt = g_xrce_d.getLength()
               
               IF g_detail_cnt >= l_ac 
                  AND g_xrce_d[l_ac].xrceld IS NOT NULL
                  AND g_xrce_d[l_ac].xrcedocno IS NOT NULL
                  AND g_xrce_d[l_ac].xrceseq IS NOT NULL
               
               THEN
                  LET l_cmd='u'
                  LET g_xrce_d_t.* = g_xrce_d[l_ac].*  #BACKUP
                  LET g_xrce_d_o.* = g_xrce_d[l_ac].*  #BACKUP
                  IF NOT axrt300_02_lock_b("xrce_t") THEN
                     LET l_lock_sw='Y'
                  ELSE
                     SELECT gzcb004 INTO l_gzcb004
                       FROM gzcb_t
                      WHERE gzcb001 = '8306'
                        AND gzcb002 = g_xrce_d[l_ac].xrce002
                     IF l_gzcb004 = '2' THEN 
                        FETCH axrt300_02_bcl INTO g_xrce_d[l_ac].xrce001,g_xrce_d[l_ac].xrcedocno,g_xrce_d[l_ac].xrceld, 
                            g_xrce_d[l_ac].xrcesite,g_xrce_d[l_ac].xrceseq,g_xrce_d[l_ac].xrce002,g_xrce_d[l_ac].xrce006, 
                            g_xrce_d[l_ac].xrce003,g_xrce_d[l_ac].xrce004,g_xrce_d[l_ac].xrce005,g_xrce_d[l_ac].xrce024, 
                            g_xrce_d[l_ac].xrce025,g_xrce_d[l_ac].xrce008,g_xrce_d[l_ac].xrce015,g_xrce_d[l_ac].xrce100, 
                            g_xrce_d[l_ac].xrce101,g_xrce_d[l_ac].xrce109,g_xrce_d[l_ac].xrce119,g_xrce_d[l_ac].xrce027, 
                            g_xrce_d[l_ac].xrce028,g_xrce_d[l_ac].xrce104,g_xrce_d[l_ac].xrce114,g_xrce_d[l_ac].xrce124, 
                            g_xrce_d[l_ac].xrce134,g_xrce_d[l_ac].xrcecomp,g_xrce_d[l_ac].xrceorga,g_xrce_d[l_ac].xrce010, 
                            g_xrce_d[l_ac].xrce016,g_xrce2_d[l_ac].xrce001,g_xrce2_d[l_ac].xrcedocno,g_xrce2_d[l_ac].xrceld, 
                            g_xrce2_d[l_ac].xrcesite,g_xrce2_d[l_ac].xrceseq,g_xrce2_d[l_ac].xrce002,g_xrce2_d[l_ac].xrce006, 
                            g_xrce2_d[l_ac].xrce003,g_xrce2_d[l_ac].xrce004,g_xrce2_d[l_ac].xrce008,g_xrce2_d[l_ac].xrce100, 
                            g_xrce2_d[l_ac].xrce109,g_xrce2_d[l_ac].xrce101,g_xrce2_d[l_ac].xrce119,g_xrce2_d[l_ac].xrce120, 
                            g_xrce2_d[l_ac].xrce121,g_xrce2_d[l_ac].xrce129,g_xrce2_d[l_ac].xrce130,g_xrce2_d[l_ac].xrce131, 
                            g_xrce2_d[l_ac].xrce139,g_xrce3_d[l_ac].xrce001,g_xrce3_d[l_ac].xrcedocno,g_xrce3_d[l_ac].xrceld, 
                            g_xrce3_d[l_ac].xrcesite,g_xrce3_d[l_ac].xrceseq,g_xrce3_d[l_ac].xrce002,g_xrce3_d[l_ac].xrce006, 
                            g_xrce3_d[l_ac].xrce003,g_xrce3_d[l_ac].xrce004,g_xrce3_d[l_ac].xrce005,g_xrce3_d[l_ac].xrce008, 
                            g_xrce3_d[l_ac].xrce100,g_xrce3_d[l_ac].xrce109,g_xrce3_d[l_ac].xrce101,g_xrce3_d[l_ac].xrce119, 
                            g_xrce3_d[l_ac].xrce027,g_xrce3_d[l_ac].xrce010,g_xrce3_d[l_ac].xrce016,g_xrce3_d[l_ac].xrce017, 
                            g_xrce3_d[l_ac].xrce018,g_xrce3_d[l_ac].xrce019,g_xrce3_d[l_ac].xrce020,g_xrce3_d[l_ac].xrce022, 
                            g_xrce3_d[l_ac].xrce023
                     ELSE
                        FETCH axrt300_02_bcl1 INTO g_xrce_d[l_ac].xrce001,g_xrce_d[l_ac].xrcedocno,g_xrce_d[l_ac].xrceld,
                            g_xrce_d[l_ac].xrcesite,g_xrce_d[l_ac].xrceseq,g_xrce_d[l_ac].xrce002,g_xrce_d[l_ac].xrce006,
                            g_xrce_d[l_ac].xrce003,g_xrce_d[l_ac].xrce004,g_xrce_d[l_ac].xrce008,g_xrce_d[l_ac].xrce100,
                            g_xrce_d[l_ac].xrce109,g_xrce_d[l_ac].xrce101,g_xrce_d[l_ac].xrce119,
                            g_xrce_d[l_ac].xrce015,g_xrce_d[l_ac].xrce028,g_xrce_d[l_ac].xrcecomp,
                            g_xrce_d[l_ac].xrceorga,g_xrce_d[l_ac].xrce010,g_xrce_d[l_ac].xrce016,g_xrce_d[l_ac].xrde012,
                            g_xrce2_d[l_ac].xrce001,g_xrce2_d[l_ac].xrcedocno,g_xrce2_d[l_ac].xrceld,
                            g_xrce2_d[l_ac].xrcesite,g_xrce2_d[l_ac].xrceseq,g_xrce2_d[l_ac].xrce002,g_xrce2_d[l_ac].xrce006,
                            g_xrce2_d[l_ac].xrce003,g_xrce2_d[l_ac].xrce004,g_xrce2_d[l_ac].xrce008,g_xrce2_d[l_ac].xrce100,
                            g_xrce2_d[l_ac].xrce109,g_xrce2_d[l_ac].xrce101,g_xrce2_d[l_ac].xrce119,g_xrce2_d[l_ac].xrce120,
                            g_xrce2_d[l_ac].xrce121,g_xrce2_d[l_ac].xrce129,g_xrce2_d[l_ac].xrce130,g_xrce2_d[l_ac].xrce131,
                            g_xrce2_d[l_ac].xrce139,g_xrce3_d[l_ac].xrce001,g_xrce3_d[l_ac].xrcedocno,g_xrce3_d[l_ac].xrceld,
                            g_xrce3_d[l_ac].xrcesite,g_xrce3_d[l_ac].xrceseq,g_xrce3_d[l_ac].xrce002,g_xrce3_d[l_ac].xrce006,
                            g_xrce3_d[l_ac].xrce003,g_xrce3_d[l_ac].xrce004,g_xrce3_d[l_ac].xrce008,
                            g_xrce3_d[l_ac].xrce100,g_xrce3_d[l_ac].xrce109,g_xrce3_d[l_ac].xrce101,g_xrce3_d[l_ac].xrce119,
                            g_xrce3_d[l_ac].xrce010,g_xrce3_d[l_ac].xrce016,g_xrce3_d[l_ac].xrce017,
                            g_xrce3_d[l_ac].xrce018,g_xrce3_d[l_ac].xrce019,g_xrce3_d[l_ac].xrce020,g_xrce3_d[l_ac].xrce022,
                            g_xrce3_d[l_ac].xrce023
                     END IF
                     IF SQLCA.sqlcode THEN
                        INITIALIZE g_errparam TO NULL 
                        LET g_errparam.extend = g_xrce_d_t.xrceld 
                        LET g_errparam.code   = SQLCA.sqlcode 
                        LET g_errparam.popup  = TRUE 
                        CALL cl_err()
               
                        LET l_lock_sw = "Y"
                     END IF
                     
                     CALL axrt300_02_detail_show()
                     CALL cl_show_fld_cont()
                  END IF
               ELSE
                  LET l_cmd='a'
               END IF
            END IF
            LET g_xrce_t.xrceent = g_enterprise
            LET g_xrce_t.xrcecomp = g_xrce_d[l_ac].xrcecomp
            LET g_xrce_t.xrcedocno = g_xrca_t.xrcadocno
            LET g_xrce_t.xrceseq = g_xrce_d[l_ac].xrceseq
            LET g_xrce_t.xrceld = g_xrca_t.xrcald
            LET g_xrce_t.xrcesite = g_xrce_d[l_ac].xrcesite
            LET g_xrce_t.xrceorga = g_xrce_d[l_ac].xrceorga
            LET g_xrce_t.xrce001 = g_xrce_d[l_ac].xrce001
            LET g_xrce_t.xrce002 = g_xrce_d[l_ac].xrce002
            LET g_xrce_t.xrce003 = g_xrce_d[l_ac].xrce003
            LET g_xrce_t.xrce004 = g_xrce_d[l_ac].xrce004
            LET g_xrce_t.xrce005 = g_xrce_d[l_ac].xrce005
            LET g_xrce_t.xrce006 = g_xrce_d[l_ac].xrce006
            LET g_xrce_t.xrce008 = g_xrce_d[l_ac].xrce008
            LET g_xrce_t.xrce010 = g_xrce3_d[l_ac].xrce010
            LET g_xrce_t.xrce015 = g_xrce_d[l_ac].xrce015
            LET g_xrce_t.xrce016 = g_xrce3_d[l_ac].xrce016
            LET g_xrce_t.xrce017 = g_xrce3_d[l_ac].xrce017
            LET g_xrce_t.xrce018 = g_xrce3_d[l_ac].xrce018
            LET g_xrce_t.xrce019 = g_xrce3_d[l_ac].xrce019
            LET g_xrce_t.xrce020 = g_xrce3_d[l_ac].xrce020
            LET g_xrce_t.xrce022 = g_xrce3_d[l_ac].xrce022
            LET g_xrce_t.xrce023 = g_xrce3_d[l_ac].xrce023
            LET g_xrce_t.xrce024 = g_xrce_d[l_ac].xrce024
            LET g_xrce_t.xrce025 = g_xrce_d[l_ac].xrce025
            LET g_xrce_t.xrce100 = g_xrce_d[l_ac].xrce100
            LET g_xrce_t.xrce101 = g_xrce_d[l_ac].xrce101
            LET g_xrce_t.xrce109 = g_xrce_d[l_ac].xrce109
            LET g_xrce_t.xrce119 = g_xrce_d[l_ac].xrce119
            LET g_xrce_t.xrce120 = g_xrce2_d[l_ac].xrce120
            LET g_xrce_t.xrce121 = g_xrce2_d[l_ac].xrce121
            LET g_xrce_t.xrce129 = g_xrce2_d[l_ac].xrce129
            LET g_xrce_t.xrce130 = g_xrce2_d[l_ac].xrce130
            LET g_xrce_t.xrce131 = g_xrce2_d[l_ac].xrce131
            LET g_xrce_t.xrce139 = g_xrce2_d[l_ac].xrce139
            LET g_xrce_t.xrce027 = g_xrce_d[l_ac].xrce027

            CALL axrt300_02_set_entry_b("a")
            CALL axrt300_02_set_no_entry_b("a")]]>
  </point>
  <point name="input.body.before_row2" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF 1 = 0 THEN ]]>
  </point>
  <point name="input.body.cancel" order="" ver="4" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[               CLOSE axrt300_02_bcl1]]>
  </point>
  <point name="input.body.close" order="" ver="4" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[               CLOSE axrt300_02_bcl1]]>
  </point>
  <point name="input.body.m_delete" order="" ver="4" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[               ELSE
                  DELETE FROM xrde_t
                   WHERE xrdeent = g_enterprise 
                     AND xrdeld = g_xrce_d_t.xrceld
                     AND xrdedocno = g_xrce_d_t.xrcedocno
                     AND xrdeseq = g_xrce_d_t.xrceseq
               END IF]]>
  </point>
  <point name="input.body.m_update" order="" ver="7" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[               ELSE
                  UPDATE xrde_t SET (xrde001,xrdedocno,xrdeld,xrdesite,xrdeseq,xrde002,xrde006,xrde003, 
                                     xrde004,xrde008,xrde100,xrde109,xrde101,xrde119,xrde010, 
                                     xrde018,xrde015,xrde028,xrdecomp,xrdeorga,xrde120, 
                                     xrde121,xrde129,xrde130,xrde131,xrde139,xrde016,xrde017,xrde019,xrde020,xrde022,xrde023,xrde012) = (g_xrce_d[l_ac].xrce001, 
                                     g_xrce_d[l_ac].xrcedocno,g_xrce_d[l_ac].xrceld,g_xrce_d[l_ac].xrcesite,g_xrce_d[l_ac].xrceseq, 
                                     g_xrce_d[l_ac].xrce002,g_xrce_d[l_ac].xrce006,g_xrce_d[l_ac].xrce003,g_xrce_d[l_ac].xrce004, 
                                     g_xrce_d[l_ac].xrce008, 
                                     g_xrce_d[l_ac].xrce100,g_xrce_d[l_ac].xrce109,g_xrce_d[l_ac].xrce101,g_xrce_d[l_ac].xrce119, 
                                     g_xrce_d[l_ac].xrce010,g_xrce3_d[l_ac].xrce018,g_xrce_d[l_ac].xrce015, 
                                     g_xrce_d[l_ac].xrce028, 
                                     g_xrce_d[l_ac].xrcecomp,g_xrce_d[l_ac].xrceorga,g_xrce2_d[l_ac].xrce120, 
                                     g_xrce2_d[l_ac].xrce121,g_xrce2_d[l_ac].xrce129,g_xrce2_d[l_ac].xrce130,g_xrce2_d[l_ac].xrce131, 
                                     g_xrce2_d[l_ac].xrce139,g_xrce_d[l_ac].xrce016,g_xrce3_d[l_ac].xrce017,g_xrce3_d[l_ac].xrce019, 
                                     g_xrce3_d[l_ac].xrce020,g_xrce3_d[l_ac].xrce022,g_xrce3_d[l_ac].xrce023,g_xrce_d[l_ac].xrde012)
                WHERE xrdeent = g_enterprise 
                  AND xrdeld = g_xrce_d_t.xrceld #項次   
                  AND xrdedocno = g_xrce_d_t.xrcedocno  
                  AND xrdeseq = g_xrce_d_t.xrceseq  
               END IF]]>
  </point>
  <point name="input.body2.a_close" order="" ver="4" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[               CLOSE axrt300_02_bcl1]]>
  </point>
  <point name="input.body2.a_update" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[               CALL axrt300_02_ref_amt()]]>
  </point>
  <point name="input.body2.b_delete" order="" ver="4" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[               SELECT gzcb004 INTO l_gzcb004
                 FROM gzcb_t
                WHERE gzcb001 = '8306'
                  AND gzcb002 = g_xrce_d[l_ac].xrce002
               IF l_gzcb004 = '2' THEN ]]>
  </point>
  <point name="input.body2.b_update" order="" ver="4" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[               SELECT gzcb004 INTO l_gzcb004
                 FROM gzcb_t
                WHERE gzcb001 = '8306'
                  AND gzcb002 = g_xrce_d[l_ac].xrce002
               IF l_gzcb004 = '2' THEN ]]>
  </point>
  <point name="input.body2.before_insert" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="input.body2.before_row" order="" ver="7" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ELSE
               LET g_detail_idx = DIALOG.getCurrentRow("s_detail2")
               LET l_cmd = ''
               LET l_ac = ARR_CURR()
               LET l_lock_sw = 'N'            #DEFAULT
               LET l_n = ARR_COUNT()
               DISPLAY l_ac TO FORMONLY.idx
               DISPLAY g_xrce2_d.getLength() TO FORMONLY.cnt
            
               CALL s_transaction_begin()
               
               LET g_detail_cnt = g_xrce2_d.getLength()
               
               IF g_detail_cnt >= l_ac 
                  AND g_xrce2_d[l_ac].xrceld IS NOT NULL
                  AND g_xrce2_d[l_ac].xrcedocno IS NOT NULL
    
                  AND g_xrce2_d[l_ac].xrceseq IS NOT NULL
    
               THEN 
                  LET l_cmd='u'
                  LET g_xrce2_d_t.* = g_xrce2_d[l_ac].*  #BACKUP
                  IF NOT axrt300_02_lock_b("xrce_t") THEN
                     LET l_lock_sw='Y'
                  ELSE
                     SELECT gzcb004 INTO l_gzcb004
                       FROM gzcb_t
                      WHERE gzcb001 = '8306'
                        AND gzcb002 = g_xrce_d[l_ac].xrce002
                     IF l_gzcb004 = '2' THEN 
                        FETCH axrt300_02_bcl INTO g_xrce_d[l_ac].xrce001,g_xrce_d[l_ac].xrcedocno,g_xrce_d[l_ac].xrceld, 
                            g_xrce_d[l_ac].xrcesite,g_xrce_d[l_ac].xrceseq,g_xrce_d[l_ac].xrce002,g_xrce_d[l_ac].xrce006, 
                            g_xrce_d[l_ac].xrce003,g_xrce_d[l_ac].xrce004,g_xrce_d[l_ac].xrce005,g_xrce_d[l_ac].xrce024, 
                            g_xrce_d[l_ac].xrce025,g_xrce_d[l_ac].xrce008,g_xrce_d[l_ac].xrce015,g_xrce_d[l_ac].xrce100, 
                            g_xrce_d[l_ac].xrce101,g_xrce_d[l_ac].xrce109,g_xrce_d[l_ac].xrce119,g_xrce_d[l_ac].xrce027, 
                            g_xrce_d[l_ac].xrce028,g_xrce_d[l_ac].xrce104,g_xrce_d[l_ac].xrce114,g_xrce_d[l_ac].xrce124, 
                            g_xrce_d[l_ac].xrce134,g_xrce_d[l_ac].xrcecomp,g_xrce_d[l_ac].xrceorga,g_xrce_d[l_ac].xrce010, 
                            g_xrce_d[l_ac].xrce016,g_xrce2_d[l_ac].xrce001,g_xrce2_d[l_ac].xrcedocno,g_xrce2_d[l_ac].xrceld, 
                            g_xrce2_d[l_ac].xrcesite,g_xrce2_d[l_ac].xrceseq,g_xrce2_d[l_ac].xrce002,g_xrce2_d[l_ac].xrce006, 
                            g_xrce2_d[l_ac].xrce003,g_xrce2_d[l_ac].xrce004,g_xrce2_d[l_ac].xrce008,g_xrce2_d[l_ac].xrce100, 
                            g_xrce2_d[l_ac].xrce109,g_xrce2_d[l_ac].xrce101,g_xrce2_d[l_ac].xrce119,g_xrce2_d[l_ac].xrce120, 
                            g_xrce2_d[l_ac].xrce121,g_xrce2_d[l_ac].xrce129,g_xrce2_d[l_ac].xrce130,g_xrce2_d[l_ac].xrce131, 
                            g_xrce2_d[l_ac].xrce139,g_xrce3_d[l_ac].xrce001,g_xrce3_d[l_ac].xrcedocno,g_xrce3_d[l_ac].xrceld, 
                            g_xrce3_d[l_ac].xrcesite,g_xrce3_d[l_ac].xrceseq,g_xrce3_d[l_ac].xrce002,g_xrce3_d[l_ac].xrce006, 
                            g_xrce3_d[l_ac].xrce003,g_xrce3_d[l_ac].xrce004,g_xrce3_d[l_ac].xrce005,g_xrce3_d[l_ac].xrce008, 
                            g_xrce3_d[l_ac].xrce100,g_xrce3_d[l_ac].xrce109,g_xrce3_d[l_ac].xrce101,g_xrce3_d[l_ac].xrce119, 
                            g_xrce3_d[l_ac].xrce027,g_xrce3_d[l_ac].xrce010,g_xrce3_d[l_ac].xrce016,g_xrce3_d[l_ac].xrce017, 
                            g_xrce3_d[l_ac].xrce018,g_xrce3_d[l_ac].xrce019,g_xrce3_d[l_ac].xrce020,g_xrce3_d[l_ac].xrce022, 
                            g_xrce3_d[l_ac].xrce023
                     ELSE
                        FETCH axrt300_02_bcl1 INTO g_xrce_d[l_ac].xrce001,g_xrce_d[l_ac].xrcedocno,g_xrce_d[l_ac].xrceld,
                            g_xrce_d[l_ac].xrcesite,g_xrce_d[l_ac].xrceseq,g_xrce_d[l_ac].xrce002,g_xrce_d[l_ac].xrce006,
                            g_xrce_d[l_ac].xrce003,g_xrce_d[l_ac].xrce004,g_xrce_d[l_ac].xrce008,g_xrce_d[l_ac].xrce100,
                            g_xrce_d[l_ac].xrce109,g_xrce_d[l_ac].xrce101,g_xrce_d[l_ac].xrce119,
                            g_xrce_d[l_ac].xrce015,g_xrce_d[l_ac].xrce028,g_xrce_d[l_ac].xrcecomp,
                            g_xrce_d[l_ac].xrceorga,g_xrce_d[l_ac].xrce010,g_xrce_d[l_ac].xrce016,g_xrce_d[l_ac].xrde012,
                            g_xrce2_d[l_ac].xrce001,g_xrce2_d[l_ac].xrcedocno,g_xrce2_d[l_ac].xrceld,
                            g_xrce2_d[l_ac].xrcesite,g_xrce2_d[l_ac].xrceseq,g_xrce2_d[l_ac].xrce002,g_xrce2_d[l_ac].xrce006,
                            g_xrce2_d[l_ac].xrce003,g_xrce2_d[l_ac].xrce004,g_xrce2_d[l_ac].xrce008,g_xrce2_d[l_ac].xrce100,
                            g_xrce2_d[l_ac].xrce109,g_xrce2_d[l_ac].xrce101,g_xrce2_d[l_ac].xrce119,g_xrce2_d[l_ac].xrce120,
                            g_xrce2_d[l_ac].xrce121,g_xrce2_d[l_ac].xrce129,g_xrce2_d[l_ac].xrce130,g_xrce2_d[l_ac].xrce131,
                            g_xrce2_d[l_ac].xrce139,g_xrce3_d[l_ac].xrce001,g_xrce3_d[l_ac].xrcedocno,g_xrce3_d[l_ac].xrceld,
                            g_xrce3_d[l_ac].xrcesite,g_xrce3_d[l_ac].xrceseq,g_xrce3_d[l_ac].xrce002,g_xrce3_d[l_ac].xrce006,
                            g_xrce3_d[l_ac].xrce003,g_xrce3_d[l_ac].xrce004,g_xrce3_d[l_ac].xrce008,
                            g_xrce3_d[l_ac].xrce100,g_xrce3_d[l_ac].xrce109,g_xrce3_d[l_ac].xrce101,g_xrce3_d[l_ac].xrce119,
                            g_xrce3_d[l_ac].xrce010,g_xrce3_d[l_ac].xrce016,g_xrce3_d[l_ac].xrce017,
                            g_xrce3_d[l_ac].xrce018,g_xrce3_d[l_ac].xrce019,g_xrce3_d[l_ac].xrce020,g_xrce3_d[l_ac].xrce022,
                            g_xrce3_d[l_ac].xrce023
                     END IF
                     IF SQLCA.sqlcode THEN
                        INITIALIZE g_errparam TO NULL
                        LET g_errparam.code = SQLCA.sqlcode
                        LET g_errparam.extend = ''
                        LET g_errparam.popup = TRUE
                        CALL cl_err()

                        LET l_lock_sw = "Y"
                     END IF
                     
                     CALL cl_show_fld_cont()
                     CALL axrt300_02_detail_show()
                  END IF
               ELSE
                  LET l_cmd='a'
               END IF
            END IF]]>
  </point>
  <point name="input.body2.before_row2" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF 1 = 0 THEN]]>
  </point>
  <point name="input.body2.cancel" order="" ver="4" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[               CLOSE axrt300_02_bcl1]]>
  </point>
  <point name="input.body2.close" order="" ver="4" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[               CLOSE axrt300_02_bcl1]]>
  </point>
  <point name="input.body2.m_delete" order="" ver="4" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[               ELSE
                  DELETE FROM xrde_t
                   WHERE xrdeent = g_enterprise 
                     AND xrdeld = g_xrce2_d_t.xrceld
                     AND xrdedocno = g_xrce2_d_t.xrcedocno
                     AND xrdeseq = g_xrce2_d_t.xrceseq
               END IF]]>
  </point>
  <point name="input.body2.m_update" order="" ver="4" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[               ELSE
                  UPDATE xrde_t SET (xrde001,xrdedocno,xrdeld,xrdesite,xrdeseq,xrde002,xrde006,xrde003, 
                                     xrde004,xrde008,xrde100,xrde109,xrde101,xrde119,xrde010, 
                                     xrde018,xrde015,xrde028,xrdecomp,xrdeorga,xrde120, 
                                     xrde121,xrde129,xrde130,xrde131,xrde139,xrde016,xrde017,xrde019,xrde020,xrde022,xrde023) = (g_xrce_d[l_ac].xrce001, 
                                     g_xrce_d[l_ac].xrcedocno,g_xrce_d[l_ac].xrceld,g_xrce_d[l_ac].xrcesite,g_xrce_d[l_ac].xrceseq, 
                                     g_xrce_d[l_ac].xrce002,g_xrce_d[l_ac].xrce006,g_xrce_d[l_ac].xrce003,g_xrce_d[l_ac].xrce004, 
                                     g_xrce_d[l_ac].xrce008, 
                                     g_xrce_d[l_ac].xrce100,g_xrce_d[l_ac].xrce109,g_xrce_d[l_ac].xrce101,g_xrce_d[l_ac].xrce119, 
                                     g_xrce3_d[l_ac].xrce010,g_xrce3_d[l_ac].xrce018,g_xrce_d[l_ac].xrce015, 
                                     g_xrce_d[l_ac].xrce028, 
                                     g_xrce_d[l_ac].xrcecomp,g_xrce_d[l_ac].xrceorga,g_xrce2_d[l_ac].xrce120, 
                                     g_xrce2_d[l_ac].xrce121,g_xrce2_d[l_ac].xrce129,g_xrce2_d[l_ac].xrce130,g_xrce2_d[l_ac].xrce131, 
                                     g_xrce2_d[l_ac].xrce139,g_xrce3_d[l_ac].xrce016,g_xrce3_d[l_ac].xrce017,g_xrce3_d[l_ac].xrce019, 
                                     g_xrce3_d[l_ac].xrce020,g_xrce3_d[l_ac].xrce022,g_xrce3_d[l_ac].xrce023)
                WHERE xrdeent = g_enterprise 
                  AND xrdeld = g_xrce2_d_t.xrceld #項次 
                  AND xrdedocno = g_xrce2_d_t.xrcedocno
                  AND xrdeseq = g_xrce2_d_t.xrceseq
               END IF]]>
  </point>
  <point name="input.body3.a_close" order="" ver="4" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[               CLOSE axrt300_02_bcl1]]>
  </point>
  <point name="input.body3.b_delete" order="" ver="4" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[               SELECT gzcb004 INTO l_gzcb004
                 FROM gzcb_t
                WHERE gzcb001 = '8306'
                  AND gzcb002 = g_xrce_d[l_ac].xrce002
               IF l_gzcb004 = '2' THEN ]]>
  </point>
  <point name="input.body3.b_update" order="" ver="4" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[               SELECT gzcb004 INTO l_gzcb004
                 FROM gzcb_t
                WHERE gzcb001 = '8306'
                  AND gzcb002 = g_xrce_d[l_ac].xrce002
               IF l_gzcb004 = '2' THEN ]]>
  </point>
  <point name="input.body3.before_row" order="" ver="7" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            ELSE
               LET g_detail_idx = DIALOG.getCurrentRow("s_detail3")
               LET l_cmd = ''
               LET l_ac = ARR_CURR()
               LET l_lock_sw = 'N'            #DEFAULT
               LET l_n = ARR_COUNT()
               DISPLAY l_ac TO FORMONLY.idx
               DISPLAY g_xrce3_d.getLength() TO FORMONLY.cnt
            
               CALL s_transaction_begin()
               
               LET g_detail_cnt = g_xrce3_d.getLength()
               
               IF g_detail_cnt >= l_ac 
                  AND g_xrce3_d[l_ac].xrceld IS NOT NULL
                  AND g_xrce3_d[l_ac].xrcedocno IS NOT NULL
    
                  AND g_xrce3_d[l_ac].xrceseq IS NOT NULL
    
               THEN 
                  LET l_cmd='u'
                  LET g_xrce3_d_t.* = g_xrce3_d[l_ac].*  #BACKUP
                  IF NOT axrt300_02_lock_b("xrce_t") THEN
                     LET l_lock_sw='Y'
                  ELSE
                     SELECT gzcb004 INTO l_gzcb004
                       FROM gzcb_t
                      WHERE gzcb001 = '8306'
                        AND gzcb002 = g_xrce_d[l_ac].xrce002
                     IF l_gzcb004 = '2' THEN 
                        FETCH axrt300_02_bcl INTO g_xrce_d[l_ac].xrce001,g_xrce_d[l_ac].xrcedocno,g_xrce_d[l_ac].xrceld, 
                            g_xrce_d[l_ac].xrcesite,g_xrce_d[l_ac].xrceseq,g_xrce_d[l_ac].xrce002,g_xrce_d[l_ac].xrce006, 
                            g_xrce_d[l_ac].xrce003,g_xrce_d[l_ac].xrce004,g_xrce_d[l_ac].xrce005,g_xrce_d[l_ac].xrce024, 
                            g_xrce_d[l_ac].xrce025,g_xrce_d[l_ac].xrce008,g_xrce_d[l_ac].xrce015,g_xrce_d[l_ac].xrce100, 
                            g_xrce_d[l_ac].xrce101,g_xrce_d[l_ac].xrce109,g_xrce_d[l_ac].xrce119,g_xrce_d[l_ac].xrce027, 
                            g_xrce_d[l_ac].xrce028,g_xrce_d[l_ac].xrce104,g_xrce_d[l_ac].xrce114,g_xrce_d[l_ac].xrce124, 
                            g_xrce_d[l_ac].xrce134,g_xrce_d[l_ac].xrcecomp,g_xrce_d[l_ac].xrceorga,g_xrce_d[l_ac].xrce010, 
                            g_xrce_d[l_ac].xrce016,g_xrce2_d[l_ac].xrce001,g_xrce2_d[l_ac].xrcedocno,g_xrce2_d[l_ac].xrceld, 
                            g_xrce2_d[l_ac].xrcesite,g_xrce2_d[l_ac].xrceseq,g_xrce2_d[l_ac].xrce002,g_xrce2_d[l_ac].xrce006, 
                            g_xrce2_d[l_ac].xrce003,g_xrce2_d[l_ac].xrce004,g_xrce2_d[l_ac].xrce008,g_xrce2_d[l_ac].xrce100, 
                            g_xrce2_d[l_ac].xrce109,g_xrce2_d[l_ac].xrce101,g_xrce2_d[l_ac].xrce119,g_xrce2_d[l_ac].xrce120, 
                            g_xrce2_d[l_ac].xrce121,g_xrce2_d[l_ac].xrce129,g_xrce2_d[l_ac].xrce130,g_xrce2_d[l_ac].xrce131, 
                            g_xrce2_d[l_ac].xrce139,g_xrce3_d[l_ac].xrce001,g_xrce3_d[l_ac].xrcedocno,g_xrce3_d[l_ac].xrceld, 
                            g_xrce3_d[l_ac].xrcesite,g_xrce3_d[l_ac].xrceseq,g_xrce3_d[l_ac].xrce002,g_xrce3_d[l_ac].xrce006, 
                            g_xrce3_d[l_ac].xrce003,g_xrce3_d[l_ac].xrce004,g_xrce3_d[l_ac].xrce005,g_xrce3_d[l_ac].xrce008, 
                            g_xrce3_d[l_ac].xrce100,g_xrce3_d[l_ac].xrce109,g_xrce3_d[l_ac].xrce101,g_xrce3_d[l_ac].xrce119, 
                            g_xrce3_d[l_ac].xrce027,g_xrce3_d[l_ac].xrce010,g_xrce3_d[l_ac].xrce016,g_xrce3_d[l_ac].xrce017, 
                            g_xrce3_d[l_ac].xrce018,g_xrce3_d[l_ac].xrce019,g_xrce3_d[l_ac].xrce020,g_xrce3_d[l_ac].xrce022, 
                            g_xrce3_d[l_ac].xrce023
                     ELSE
                        FETCH axrt300_02_bcl1 INTO g_xrce_d[l_ac].xrce001,g_xrce_d[l_ac].xrcedocno,g_xrce_d[l_ac].xrceld,
                            g_xrce_d[l_ac].xrcesite,g_xrce_d[l_ac].xrceseq,g_xrce_d[l_ac].xrce002,g_xrce_d[l_ac].xrce006,
                            g_xrce_d[l_ac].xrce003,g_xrce_d[l_ac].xrce004,g_xrce_d[l_ac].xrce008,g_xrce_d[l_ac].xrce100,
                            g_xrce_d[l_ac].xrce109,g_xrce_d[l_ac].xrce101,g_xrce_d[l_ac].xrce119,
                            g_xrce_d[l_ac].xrce015,g_xrce_d[l_ac].xrce028,g_xrce_d[l_ac].xrcecomp,
                            g_xrce_d[l_ac].xrceorga,g_xrce_d[l_ac].xrce010,g_xrce_d[l_ac].xrce016,g_xrce_d[l_ac].xrde012,
                            g_xrce2_d[l_ac].xrce001,g_xrce2_d[l_ac].xrcedocno,g_xrce2_d[l_ac].xrceld,
                            g_xrce2_d[l_ac].xrcesite,g_xrce2_d[l_ac].xrceseq,g_xrce2_d[l_ac].xrce002,g_xrce2_d[l_ac].xrce006,
                            g_xrce2_d[l_ac].xrce003,g_xrce2_d[l_ac].xrce004,g_xrce2_d[l_ac].xrce008,g_xrce2_d[l_ac].xrce100,
                            g_xrce2_d[l_ac].xrce109,g_xrce2_d[l_ac].xrce101,g_xrce2_d[l_ac].xrce119,g_xrce2_d[l_ac].xrce120,
                            g_xrce2_d[l_ac].xrce121,g_xrce2_d[l_ac].xrce129,g_xrce2_d[l_ac].xrce130,g_xrce2_d[l_ac].xrce131,
                            g_xrce2_d[l_ac].xrce139,g_xrce3_d[l_ac].xrce001,g_xrce3_d[l_ac].xrcedocno,g_xrce3_d[l_ac].xrceld,
                            g_xrce3_d[l_ac].xrcesite,g_xrce3_d[l_ac].xrceseq,g_xrce3_d[l_ac].xrce002,g_xrce3_d[l_ac].xrce006,
                            g_xrce3_d[l_ac].xrce003,g_xrce3_d[l_ac].xrce004,g_xrce3_d[l_ac].xrce008,
                            g_xrce3_d[l_ac].xrce100,g_xrce3_d[l_ac].xrce109,g_xrce3_d[l_ac].xrce101,g_xrce3_d[l_ac].xrce119,
                            g_xrce3_d[l_ac].xrce010,g_xrce3_d[l_ac].xrce016,g_xrce3_d[l_ac].xrce017,
                            g_xrce3_d[l_ac].xrce018,g_xrce3_d[l_ac].xrce019,g_xrce3_d[l_ac].xrce020,g_xrce3_d[l_ac].xrce022,
                            g_xrce3_d[l_ac].xrce023
                     END IF
                     IF SQLCA.sqlcode THEN
                        INITIALIZE g_errparam TO NULL
                        LET g_errparam.code = SQLCA.sqlcode
                        LET g_errparam.extend = ''
                        LET g_errparam.popup = TRUE
                        CALL cl_err()

                        LET l_lock_sw = "Y"
                     END IF
                     
                     CALL cl_show_fld_cont()
                     CALL axrt300_02_detail_show()
                  END IF
               ELSE
                  LET l_cmd='a'
               END IF
            END IF]]>
  </point>
  <point name="input.body3.before_row2" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF 1 = 0 THEN]]>
  </point>
  <point name="input.body3.cancel" order="" ver="4" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[               CLOSE axrt300_02_bcl1]]>
  </point>
  <point name="input.body3.close" order="" ver="4" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[               CLOSE axrt300_02_bcl1]]>
  </point>
  <point name="input.body3.m_delete" order="" ver="4" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[               ELSE
                  DELETE FROM xrde_t
                   WHERE xrdeent = g_enterprise
                     AND xrdeld = g_xrce3_d_t.xrceld
                     AND xrdedocno = g_xrce3_d_t.xrcedocno
                     AND xrdeseq = g_xrce3_d_t.xrceseq
               END IF]]>
  </point>
  <point name="input.body3.m_update" order="" ver="4" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[               ELSE
                  UPDATE xrde_t SET (xrde001,xrdedocno,xrdeld,xrdesite,xrdeseq,xrde002,xrde006,xrde003, 
                                     xrde004,xrde008,xrde100,xrde109,xrde101,xrde119,xrde010, 
                                     xrde018,xrde015,xrde028,xrdecomp,xrdeorga,xrde120, 
                                     xrde121,xrde129,xrde130,xrde131,xrde139,xrde016,xrde017,xrde019,xrde020,xrde022,xrde023) = (g_xrce_d[l_ac].xrce001, 
                                     g_xrce_d[l_ac].xrcedocno,g_xrce_d[l_ac].xrceld,g_xrce_d[l_ac].xrcesite,g_xrce_d[l_ac].xrceseq, 
                                     g_xrce_d[l_ac].xrce002,g_xrce_d[l_ac].xrce006,g_xrce_d[l_ac].xrce003,g_xrce_d[l_ac].xrce004, 
                                     g_xrce_d[l_ac].xrce008, 
                                     g_xrce_d[l_ac].xrce100,g_xrce_d[l_ac].xrce109,g_xrce_d[l_ac].xrce101,g_xrce_d[l_ac].xrce119, 
                                     g_xrce3_d[l_ac].xrce010,g_xrce3_d[l_ac].xrce018,g_xrce_d[l_ac].xrce015, 
                                     g_xrce_d[l_ac].xrce028, 
                                     g_xrce_d[l_ac].xrcecomp,g_xrce_d[l_ac].xrceorga,g_xrce2_d[l_ac].xrce120, 
                                     g_xrce2_d[l_ac].xrce121,g_xrce2_d[l_ac].xrce129,g_xrce2_d[l_ac].xrce130,g_xrce2_d[l_ac].xrce131, 
                                     g_xrce2_d[l_ac].xrce139,g_xrce3_d[l_ac].xrce016,g_xrce3_d[l_ac].xrce017,g_xrce3_d[l_ac].xrce019, 
                                     g_xrce3_d[l_ac].xrce020,g_xrce3_d[l_ac].xrce022,g_xrce3_d[l_ac].xrce023)
                WHERE xrdeent = g_enterprise 
                  AND xrdeld = g_xrce3_d_t.xrceld #項次 
                  AND xrdedocno = g_xrce3_d_t.xrcedocno
                  AND xrdeseq = g_xrce3_d_t.xrceseq 
               END IF]]>
  </point>
  <point name="input.c.page1.xrce003" order="" ver="4" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #開窗i段
            IF g_xrce_d[l_ac].xrce002 = '10' THEN
			      INITIALIZE g_qryparam.* TO NULL
			      LET g_qryparam.state = 'c'
			      LET g_qryparam.reqry = FALSE
               LET g_qryparam.default1 = g_xrce_d[l_ac].xrce024   #給予default值
               LET g_qryparam.default2 = g_xrce_d[l_ac].xrce025   #給予default值
               #呼叫開窗
               CASE
                  WHEN g_xrce_d[l_ac].xrce002 = '10'
                     CASE
                        WHEN g_xrce_d[l_ac].xrce006 = '10'           #現金類型
                           #給予arg
                           LET g_qryparam.arg1 = g_xrca_t.xrcasite   #帳務中心(接收,暫不處理)
                           LET g_qryparam.arg2 = g_xrca_t.xrca004    #核銷客戶
                           LET g_qryparam.arg3 = g_xrca_t.xrca005    #收款客戶
                           LET g_qryparam.arg4 = g_xrca_t.xrcacomp   #來源組織(接收,暫不處理)
                           LET g_qryparam.arg5 = g_xrca_t.xrcald     #帳套
                           #LET g_qryparam.arg6 = '10'     #帳套
                           
                           LET g_qryparam.where= "     nmbadocdt <= '",g_xrca_t.xrcadocdt,"'",
                                                 " AND nmbastus = 'V'",
                                                 " AND nmbb029 = '10'"
                           
                           CALL axrt400_07()                         #銀存收支資料沖帳挑選(子作業)
                           CALL axrt300_02_ins_xrce(g_xrce_d[l_ac].xrce002,g_xrce_d[l_ac].xrce006)
                           LET l_flag = 'Y'
                           #CALL axrt300_02_b_fill("1=1")
                           CALL axrt300_02_ref_amt()
                           EXIT DIALOG
                  
                        WHEN g_xrce_d[l_ac].xrce006 = '20'           #銀行電匯款
                           #給予arg
                           LET g_qryparam.arg1 = g_xrca_t.xrcasite   #帳務中心(接收,暫不處理)
                           LET g_qryparam.arg2 = g_xrca_t.xrca004    #核銷客戶
                           LET g_qryparam.arg3 = g_xrca_t.xrca005    #收款客戶
                           LET g_qryparam.arg4 = g_xrca_t.xrcacomp   #來源組織(接收,暫不處理)
                           LET g_qryparam.arg5 = g_xrca_t.xrcald     #帳套
                           #LET g_qryparam.arg6 = '20'     #帳套
                           
                           LET g_qryparam.where= "     nmbadocdt <= '",g_xrca_t.xrcadocdt,"'",
                                                 " AND nmbastus = 'V'",
                                                 " AND nmbb029 = '20'"
                           
                           CALL axrt400_07()                         #銀存收支資料沖帳挑選(子作業)
                           CALL axrt300_02_ins_xrce(g_xrce_d[l_ac].xrce002,g_xrce_d[l_ac].xrce006)
                           LET l_flag = 'Y'
                           #CALL axrt300_02_b_fill("1=1")
                           CALL axrt300_02_ref_amt()
                           EXIT DIALOG
                  
                        WHEN g_xrce_d[l_ac].xrce006 = '30'           #票據類型
                           #給予arg
                           LET g_qryparam.arg1 = g_xrca_t.xrcasite   #帳務中心(接收,暫不處理)
                           LET g_qryparam.arg2 = g_xrca_t.xrca004    #核銷客戶
                           LET g_qryparam.arg3 = g_xrca_t.xrca005    #收款客戶
                           LET g_qryparam.arg4 = g_xrca_t.xrcacomp   #來源組織(接收,暫不處理)
                           LET g_qryparam.arg5 = g_xrca_t.xrcald     #帳套
                           #LET g_qryparam.arg6 = '30'     #帳套
                           
                           LET g_qryparam.where= "     nmbadocdt <= '",g_xrca_t.xrcadocdt,"'",
                                                 " AND nmbastus = 'Y'",
                                                 " AND nmbb029 = '30'"
                           
                           CALL axrt400_07()                         #應收票據資料沖帳挑選(子作業)
                           CALL axrt300_02_ins_xrce(g_xrce_d[l_ac].xrce002,g_xrce_d[l_ac].xrce006)
                           LET l_flag = 'Y'
                           #CALL axrt300_02_b_fill("1=1")
                           CALL axrt300_02_ref_amt()
                           EXIT DIALOG
                  
                        WHEN g_xrce_d[l_ac].xrce006 = '40'           #暫無規格
                        WHEN g_xrce_d[l_ac].xrce006 = '50'           #暫無規格
                        WHEN g_xrce_d[l_ac].xrce006 = '60'           #暫無規格
                        WHEN g_xrce_d[l_ac].xrce006 = '70'           #暫無規格
                        WHEN g_xrce_d[l_ac].xrce006 = '90'           #暫無規格
                     END CASE
               END CASE
            END IF
            IF g_xrce_d[l_ac].xrce002 = '31' THEN
			      INITIALIZE g_qryparam.* TO NULL
               LET g_qryparam.state = 'c'
			      LET g_qryparam.reqry = FALSE
			      LET g_qryparam.default1 = g_xrce_d[l_ac].xrce003
			      
			      LET g_qryparam.arg1 = g_xrca_t.xrca005
               LET g_qryparam.arg2 = g_xrca_t.xrcald
               LET g_qryparam.arg3 = g_xrca_t.xrcasite

               LET g_qryparam.where= "      xrcadocdt <= '",g_xrca_t.xrcadocdt,"'",
                                     "  AND SUBSTR(xrca001,1,1) = '2' ",
                                     "  AND xrca001 <> '25'"
               
               CALL axrt400_04()                         #銀存收支資料沖帳挑選(子作業)

               CALL axrt300_02_ins_xrce(g_xrce_d[l_ac].xrce002,0)
               LET l_flag = 'Y'
               #CALL axrt300_02_b_fill("1=1")
               CALL axrt300_02_ref_amt()
               EXIT DIALOG

            END IF
            IF g_xrce_d[l_ac].xrce002 = '32' THEN
			      INITIALIZE g_qryparam.* TO NULL
               LET g_qryparam.state = 'c'
			      LET g_qryparam.reqry = FALSE
			      LET g_qryparam.default1 = g_xrce_d[l_ac].xrce003
			      
			      LET g_qryparam.arg1 = g_xrca_t.xrca005
               LET g_qryparam.arg2 = g_xrca_t.xrcald
               LET g_qryparam.arg3 = g_xrca_t.xrcasite

               LET g_qryparam.where= "      xrcadocdt <= '",g_xrca_t.xrcadocdt,"'",
                                     "  AND xrca001 = '25'"
               
               CALL axrt400_04()                         #銀存收支資料沖帳挑選(子作業)

               CALL axrt300_02_ins_xrce(g_xrce_d[l_ac].xrce002,0)
               LET l_flag = 'Y'
               #CALL axrt300_02_b_fill("1=1")
               CALL axrt300_02_ref_amt()
               EXIT DIALOG

            END IF
            
            CALL axrt300_02_ref_amt()
            NEXT FIELD xrce003                                 #返回原欄位]]>
  </point>
  <point name="input.c.page1.xrce010" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xrce_d[l_ac].xrce010             #給予default值

            #給予arg

            CALL q_oocq002_2()                                #呼叫開窗

            LET g_xrce_d[l_ac].xrce010 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xrce_d[l_ac].xrce010 TO xrce010              #顯示到畫面上
            LET g_xrce3_d[l_ac].xrce010 = g_xrce_d[l_ac].xrce010

            NEXT FIELD xrce010                          #返回原欄位

]]>
  </point>
  <point name="input.c.page1.xrce016" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #應用 a07 樣板自動產生(Version:2)   
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xrce_d[l_ac].xrce016             #給予default值
            LET g_qryparam.where = " glac001 = '",g_glaa_t.glaa004,"' AND glac006 = '1'"


            #給予arg
            LET g_qryparam.arg1 = "" #


            CALL aglt310_04()                                #呼叫開窗

            LET g_xrce_d[l_ac].xrce016 = g_qryparam.return1              

            DISPLAY g_xrce_d[l_ac].xrce016 TO xrce016              #
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xrce_d[l_ac].xrce016
            CALL ap_ref_array2(g_ref_fields,"SELECT glacl004 FROM glacl_t WHERE glaclent='"||g_enterprise||"' AND glacl001='"||g_glaa_t.glaa004||"' AND glacl002=? AND glacl003='"||g_lang||"'","") RETURNING g_rtn_fields
            LET g_xrce_d[l_ac].xrce016_desc_1 = '', g_rtn_fields[1] , ''
            LET g_xrce3_d[l_ac].xrce016 = g_xrce_d[l_ac].xrce016
            LET g_xrce3_d[l_ac].xrce016_u_desc = g_xrce_d[l_ac].xrce016_desc_1 

            NEXT FIELD xrce016                          #返回原欄位

]]>
  </point>
  <point name="input.c.page1.xrce018" order="" ver="4" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[]]>
  </point>
  <point name="input.c.page1.xrce024" order="" ver="4" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
			IF cl_null(g_xrce_d_t.xrce024) THEN
               LET g_qryparam.state = 'c'
            ELSE
               LET g_qryparam.state = 'i'
            END IF
			LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_xrce_d[l_ac].xrce024   #給予default值
            LET g_qryparam.default2 = g_xrce_d[l_ac].xrce025   #給予default值
            #呼叫開窗
            CASE
               WHEN g_xrce_d[l_ac].xrce002 = '31'           #銀行電匯款
                  #給予arg
                  LET g_qryparam.arg1 = g_xrca_t.xrcasite   #帳務中心
                  LET g_qryparam.arg2 = g_xrca_t.xrca004    #核銷客戶
                  LET g_qryparam.arg3 = g_xrca_t.xrca005    #收款客戶
                  LET g_qryparam.arg4 = g_xrca_t.xrcacomp   #來源組織
                  LET g_qryparam.arg5 = g_xrca_t.xrcald     #帳套
                 #LET g_qryparam.arg6 =                     #來源類型
                 #LET g_qryparam.arg7 = '-1'                #表單性質
                  LET g_qryparam.arg8 = l_ooab002           #沖帳至項次否   -Y 是   -N 否

                  LET g_qryparam.where= "xrcadocdt <= '",g_xrca_t.xrcadocdt,"'"
                  
                  CALL axrt400_04()                         #銀存收支資料沖帳挑選(子作業)
                  IF NOT cl_null(g_xrce_d_t.xrce024) THEN
                     LET g_xrce_d[l_ac].xrce024 = g_qryparam.return1    #將開窗取得的值回傳到變數
                     LET g_xrce_d[l_ac].xrce025 = g_qryparam.return2
                     LET g_xrce_d[l_ac].xrce003 = g_qryparam.return3
                     LET g_xrce_d[l_ac].xrce004 = g_qryparam.return4
                  
                     DISPLAY g_xrce_d[l_ac].xrce024,g_xrce_d[l_ac].xrce005 TO s_detail1[l_ac].xrce024_1,s_detail1[l_ac].xrce005_1          #顯示到畫面上
                     DISPLAY g_xrce_d[l_ac].xrce003,g_xrce_d[l_ac].xrce004 TO s_detail1[l_ac].xrce003_1,s_detail1[l_ac].xrce004_1          #顯示到畫面上
                  ELSE
                     CALL axrt300_02_ins_xrce(g_xrce_d[l_ac].xrce002,0)
                     LET l_flag = 'Y'
                     CALL axrt300_02_ref_amt()
                     EXIT DIALOG
                  END IF
            
               WHEN g_xrce_d[l_ac].xrce002 = '32'           #暫無規格
               WHEN g_xrce_d[l_ac].xrce002 = '40'           #暫無規格
               WHEN g_xrce_d[l_ac].xrce002 = '41'           #暫無規格
               WHEN g_xrce_d[l_ac].xrce002 = '42'           #暫無規格
            END CASE
            CALL axrt300_02_ref_amt()

            NEXT FIELD xrce024                                 #返回原欄位]]>
  </point>
  <point name="input.c.page1.xrde012_u" order="" ver="7" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xrce_d[l_ac].xrde012             #給予default值
            LET l_glaa005 = ''
            SELECT glaa005 INTO l_glaa005 FROM glaa_t
             WHERE glaaent = g_enterprise AND glaald = g_xrca_t.xrcald
            LET g_qryparam.where = " nmai001 = '",l_glaa005,"'"
            #給予arg

            CALL q_nmai002()                                #呼叫開窗

            LET g_xrce_d[l_ac].xrde012 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xrce_d[l_ac].xrde012 TO xrde012_u              #顯示到畫面上
            
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = l_glaa005
            LET g_ref_fields[2] = g_xrce_d[l_ac].xrde012
            CALL ap_ref_array2(g_ref_fields,"SELECT nmail004 FROM nmail_t WHERE nmailent='"||g_enterprise||"' AND nmail001=? AND nmail002=? AND nmail003='"||g_dlang||"'","")
               RETURNING g_rtn_fields
            LET g_xrce_d[l_ac].xrde012_u_desc = '', g_rtn_fields[1] , ''

            DISPLAY g_xrce_d[l_ac].xrde012_u_desc TO xrde012_u_desc
            NEXT FIELD xrde012_u                          #返回原欄位
]]>
  </point>
  <point name="input.c.page3.xrce010_u" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xrce3_d[l_ac].xrce010             #給予default值

            #給予arg

            CALL q_oocq002_2()                                #呼叫開窗

            LET g_xrce3_d[l_ac].xrce010 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xrce3_d[l_ac].xrce010 TO xrce010_u              #顯示到畫面上

            NEXT FIELD xrce010_u                          #返回原欄位]]>
  </point>
  <point name="input.c.page3.xrce016" order="" ver="3" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xrce3_d[l_ac].xrce016             #給予default值
            LET g_qryparam.where = " glac001 = '",g_glaa_t.glaa004,"' AND glac006 = '1'"

            #給予arg

            CALL aglt310_04()                                #呼叫開窗

            LET g_xrce3_d[l_ac].xrce016 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xrce3_d[l_ac].xrce016 TO xrce016              #顯示到畫面上
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xrce3_d[l_ac].xrce016
            CALL ap_ref_array2(g_ref_fields,"SELECT glacl004 FROM glacl_t WHERE glaclent='"||g_enterprise||"' AND glacl001='"||g_glaa_t.glaa004||"' AND glacl002=? AND glacl003='"||g_lang||"'","") RETURNING g_rtn_fields
            LET g_xrce3_d[l_ac].xrce016_desc = '', g_rtn_fields[1] , ''
      
            NEXT FIELD xrce016                          #返回原欄位

]]>
  </point>
  <point name="input.c.page3.xrce016_u" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #應用 a07 樣板自動產生(Version:2)   
            #開窗i段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xrce3_d[l_ac].xrce016             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "" #


            CALL aglt310_04()                                #呼叫開窗

            LET g_xrce3_d[l_ac].xrce016 = g_qryparam.return1              

            DISPLAY g_xrce3_d[l_ac].xrce016 TO xrce016_u              #

            NEXT FIELD xrce016_u                          #返回原欄位

]]>
  </point>
  <point name="input.c.page3.xrce017" order="" ver="2" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xrce3_d[l_ac].xrce017             #給予default值

            #給予arg

            CALL q_ooag001()                                #呼叫開窗

            LET g_xrce3_d[l_ac].xrce017 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xrce3_d[l_ac].xrce017 TO xrce017              #顯示到畫面上
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xrce3_d[l_ac].xrce017
            CALL ap_ref_array2(g_ref_fields,"SELECT ooag011 FROM ooag_t WHERE ooagent='"||g_enterprise||"' AND ooag001=? ","") RETURNING g_rtn_fields
            LET g_xrce3_d[l_ac].xrce017_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xrce3_d[l_ac].xrce017_desc
            
            NEXT FIELD xrce017                          #返回原欄位

]]>
  </point>
  <point name="input.c.page3.xrce018_u" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xrce3_d[l_ac].xrce018             #給予default值

            #給予arg

            CALL q_ooea001_1()                                #呼叫開窗

            LET g_xrce3_d[l_ac].xrce018 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xrce3_d[l_ac].xrce018 TO xrce018_u              #顯示到畫面上

            NEXT FIELD xrce018_u                          #返回原欄位

]]>
  </point>
  <point name="input.c.page3.xrce019" order="" ver="2" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xrce3_d[l_ac].xrce019             #給予default值

            #給予arg

            CALL q_ooea001_10()                                #呼叫開窗

            LET g_xrce3_d[l_ac].xrce019 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xrce3_d[l_ac].xrce019 TO xrce019              #顯示到畫面上
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xrce3_d[l_ac].xrce019
            CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent='"||g_enterprise||"' AND ooefl001=? AND ooefl002='"||g_lang||"'","") RETURNING g_rtn_fields
            LET g_xrce3_d[l_ac].xrce019_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xrce3_d[l_ac].xrce019_desc
            
            NEXT FIELD xrce019                          #返回原欄位

]]>
  </point>
  <point name="input.c.page3.xrce020" order="" ver="4" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xrce3_d[l_ac].xrce020             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "" #

            CALL q_rtax001_1()                                #呼叫開窗

            LET g_xrce3_d[l_ac].xrce020 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_xrce3_d[l_ac].xrce020 TO xrce020              #顯示到畫面上
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_xrce3_d[l_ac].xrce020
            CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='200' AND oocql002=? AND oocql003='"||g_lang||"'","") RETURNING g_rtn_fields
            LET g_xrce3_d[l_ac].xrce020_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_xrce3_d[l_ac].xrce020_desc
      
            NEXT FIELD xrce020                          #返回原欄位

]]>
  </point>
  <point name="input.define" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   DEFINE p_docno         LIKE xrca_t.xrcadocno
   DEFINE p_seq           LIKE xrcb_t.xrcbseq]]>
  </point>
  <point name="input.g.page1.xrce002" order="" ver="7" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_xrce_d[l_ac].xrce002) THEN
               IF (g_xrce_d[l_ac].xrce002 = '20' OR g_xrce_d[l_ac].xrce002 = '21') THEN
                  DISPLAY '10' TO s_detail1[l_ac].xrce002
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = 'axr-00072'
                  LET g_errparam.extend = g_xrce_d[l_ac].xrce002
                  LET g_errparam.popup = TRUE
                  CALL cl_err()

                  LET g_xrce_d[l_ac].xrce002 = '10'
                  DISPLAY g_xrce_d[l_ac].xrce002 TO s_detail1[l_ac].xrce002
                  NEXT FIELD CURRENT
               END IF
               CALL axrt300_02_set_entry_b(l_cmd)
               CALL axrt300_02_set_no_entry_b(l_cmd)
               IF l_cmd = 'a' OR (l_cmd = 'u' AND g_xrce_d[l_ac].xrce002 != g_xrce_d_t.xrce002) THEN
                  LET g_xrce_d[l_ac].xrce003 = ''
                  LET g_xrce_d[l_ac].xrce004 = ''
                  LET g_xrce_d[l_ac].xrce005 = 0
                  LET g_xrce_d[l_ac].xrce024 = ''
                  LET g_xrce_d[l_ac].xrce025 = ''
                  LET g_xrce_d[l_ac].xrce008 = ''
                  LET g_xrce_d[l_ac].xrce100 = ''
                  LET g_xrce_d[l_ac].xrce109 = ''
                  LET g_xrce_d[l_ac].xrce101 = ''
                  LET g_xrce_d[l_ac].xrce119 = ''
                  LET g_xrce_d[l_ac].xrce027 = 'N'
                  CASE
                     WHEN g_xrce_d[l_ac].xrce002 = '10'
                        LET g_xrce_d[l_ac].xrce006 = '10'
                     OTHERWISE
                        LET g_xrce_d[l_ac].xrce006 = ''
                  END CASE
                  
                  IF g_xrce_d[l_ac].xrce002 <> '10' THEN 
                     LET g_xrce_d[l_ac].xrce100 = g_glaa_t.glaa001
                     LET g_xrce_d[l_ac].xrce101 = 1
                  ELSE
                     LET g_xrce_d[l_ac].xrce100 = ''
                     LET g_xrce_d[l_ac].xrce101 = ''
                  END IF
                  
                  CALL s_subject_get(g_xrce_d[l_ac].xrce002,g_xrca_t.xrcald,g_xrca_t.xrcacomp,g_xrca_t.xrca004) RETURNING l_success,g_xrce3_d[l_ac].xrce016,l_xrde011 
                  
                  DISPLAY g_xrce_d[l_ac].xrce003,g_xrce_d[l_ac].xrce004,g_xrce_d[l_ac].xrce008,g_xrce_d[l_ac].xrce100,
                          g_xrce_d[l_ac].xrce109,g_xrce_d[l_ac].xrce101,g_xrce_d[l_ac].xrce119,
                          g_xrce_d[l_ac].xrce006,g_xrce_d[l_ac].xrce027,
                          g_xrce_d[l_ac].xrce005
                       TO s_detail1[l_ac].xrce003,s_detail1[l_ac].xrce004,s_detail1[l_ac].xrce008,s_detail1[l_ac].xrce100,
                          s_detail1[l_ac].xrce109,s_detail1[l_ac].xrce101,s_detail1[l_ac].xrce119,
                          s_detail1[l_ac].xrce006,s_detail1[l_ac].xrce027,
                          s_detail1[l_ac].xrce005
               END IF
               SELECT gzcb005 INTO g_xrce_d[l_ac].xrce015 FROM gzcb_t
                WHERE gzcb001 = '8306' AND gzcb002 = g_xrce_d[l_ac].xrce002
            END IF 
            SELECT gzcb004 INTO l_gzcb004 FROM gzcb_t WHERE gzcb001 = '8306' AND gzcb002 = g_xrce_d[l_ac].xrce002
            IF l_gzcb004 <> '1' THEN
               CALL cl_set_comp_entry('xrde012_u',FALSE)
            ELSE
               CALL cl_set_comp_entry('xrde012_u',TRUE)
            END IF]]>
  </point>
  <point name="input.g.page1.xrce006" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF g_xrce_d[l_ac].xrce006 = '90' THEN 
               LET g_xrce_d[l_ac].xrce100 = g_glaa_t.glaa001
               LET g_xrce_d[l_ac].xrce101 = 1
               CALL cl_set_comp_required('xrce003,xrce004',FALSE)
            ELSE
               LET g_xrce_d[l_ac].xrce100 = ''
               LET g_xrce_d[l_ac].xrce101 = ''
               CALL cl_set_comp_required('xrce003,xrce004',TRUE)
            END IF]]>
  </point>
  <point name="input.get_var" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   p_docno,p_seq]]>
  </point>
  <point name="insert_b.b_insert" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[      IF 1=0 THEN]]>
  </point>
  <point name="insert_b.define" order="" ver="4" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   DEFINE l_gzcb004   LIKE gzcb_t.gzcb004]]>
  </point>
  <point name="insert_b.m_insert" order="" ver="7" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[      ELSE
         SELECT gzcb004 INTO l_gzcb004
           FROM gzcb_t
          WHERE gzcb001 = '8306'
            AND gzcb002 = g_xrce_d[l_ac].xrce002
      
         IF l_gzcb004 = '1' THEN
            INSERT INTO xrde_t
                        (xrdeent,
                         xrdeld,xrdedocno,xrdeseq,
                         xrde001,xrdesite,xrde002,xrde006,xrde003,xrde004,xrde008,xrde100,xrde109,xrde101,xrde119,xrde010,
                         xrde018,xrde015,xrde028,xrdecomp,xrdeorga,
                         xrde120,xrde121,xrde129,xrde130,xrde131,xrde139,xrde016,xrde017,xrde019,xrde020,xrde022,xrde023,xrde012)  
                  VALUES(g_enterprise,
                         ps_keys[1],ps_keys[2],ps_keys[3],
                         g_xrce_d[l_ac].xrce001, g_xrce_d[l_ac].xrcesite,g_xrce_d[l_ac].xrce002, g_xrce_d[l_ac].xrce006, 
                         g_xrce_d[l_ac].xrce003, g_xrce_d[l_ac].xrce004,  
                         g_xrce_d[l_ac].xrce008, g_xrce_d[l_ac].xrce100, g_xrce_d[l_ac].xrce109, 
                         g_xrce_d[l_ac].xrce101, g_xrce_d[l_ac].xrce119, g_xrce3_d[l_ac].xrce010, 
                         g_xrce3_d[l_ac].xrce018, g_xrce_d[l_ac].xrce015, g_xrce_d[l_ac].xrce028, 
                         g_xrce_d[l_ac].xrcecomp,g_xrce_d[l_ac].xrceorga,g_xrce2_d[l_ac].xrce120,g_xrce2_d[l_ac].xrce121, 
                         g_xrce2_d[l_ac].xrce129,g_xrce2_d[l_ac].xrce130,g_xrce2_d[l_ac].xrce131,g_xrce2_d[l_ac].xrce139, 
                         g_xrce3_d[l_ac].xrce016,g_xrce3_d[l_ac].xrce017,
                         g_xrce3_d[l_ac].xrce019,g_xrce3_d[l_ac].xrce020,g_xrce3_d[l_ac].xrce022,g_xrce3_d[l_ac].xrce023,g_xrce_d[l_ac].xrde012)
         ELSE
            INSERT INTO xrce_t
                        (xrceent,
                         xrceld,xrcedocno,xrceseq,
                         xrce001,xrcesite,xrce002,xrce006,xrce003,xrce004,xrce005,xrce024,xrce025,xrce008,xrce100,xrce109,xrce101,xrce119,xrce027,xrce010,
                         xrce018,xrce015,xrce028,xrce104,xrce114,xrce124,xrce134,xrcecomp,xrceorga,
                         xrce120,xrce121,xrce129,xrce130,xrce131,xrce139,xrce016,xrce017,xrce019,xrce020,xrce022,xrce023)  
                  VALUES(g_enterprise,
                         ps_keys[1],ps_keys[2],ps_keys[3],
                         g_xrce_d[l_ac].xrce001, g_xrce_d[l_ac].xrcesite,g_xrce_d[l_ac].xrce002, g_xrce_d[l_ac].xrce006, 
                         g_xrce_d[l_ac].xrce003, g_xrce_d[l_ac].xrce004, g_xrce_d[l_ac].xrce005, g_xrce_d[l_ac].xrce024, 
                         g_xrce_d[l_ac].xrce025, g_xrce_d[l_ac].xrce008, g_xrce_d[l_ac].xrce100, g_xrce_d[l_ac].xrce109, 
                         g_xrce_d[l_ac].xrce101, g_xrce_d[l_ac].xrce119, g_xrce_d[l_ac].xrce027, g_xrce3_d[l_ac].xrce010, 
                         g_xrce3_d[l_ac].xrce018, g_xrce_d[l_ac].xrce015, g_xrce_d[l_ac].xrce028, 
                         g_xrce_d[l_ac].xrce104, g_xrce_d[l_ac].xrce114, g_xrce_d[l_ac].xrce124, g_xrce_d[l_ac].xrce134, 
                         g_xrce_d[l_ac].xrcecomp,g_xrce_d[l_ac].xrceorga,g_xrce2_d[l_ac].xrce120,g_xrce2_d[l_ac].xrce121, 
                         g_xrce2_d[l_ac].xrce129,g_xrce2_d[l_ac].xrce130,g_xrce2_d[l_ac].xrce131,g_xrce2_d[l_ac].xrce139, 
                         g_xrce3_d[l_ac].xrce016,g_xrce3_d[l_ac].xrce017,
                         g_xrce3_d[l_ac].xrce019,g_xrce3_d[l_ac].xrce020,g_xrce3_d[l_ac].xrce022,g_xrce3_d[l_ac].xrce023)
         END IF                
      END IF]]>
  </point>
  <point name="lock_b.define" order="" ver="4" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   LET ls_group = "xrce_t"
   
   IF ls_group.getIndexOf(ps_table,1) THEN
   
      OPEN axrt300_02_bcl1 USING g_enterprise,
                                       g_xrce_d[g_detail_idx].xrceld,g_xrce_d[g_detail_idx].xrcedocno, 
                                           g_xrce_d[g_detail_idx].xrceseq
                                       
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = "axrt300_02_bcl1" 
         LET g_errparam.code   = SQLCA.sqlcode 
         LET g_errparam.popup  = TRUE 
         CALL cl_err()
         RETURN FALSE
      END IF
   
   END IF]]>
  </point>
  <point name="main.body.after_define_sql" order="" ver="4" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   ]]>
  </point>
  <point name="main.body.define_sql" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   LET g_forupd_sql = "SELECT xrde001,xrdedocno,xrdeld,xrdesite,xrdeseq,xrde002,xrde006,xrde003,xrde004,
       xrde008,xrde100,xrde109,xrde101,xrde119,xrde015,
       xrde028,xrdecomp,xrdeorga,xrde010,xrde016,xrde012,xrde001,xrdedocno,xrdeld,xrdesite,xrdeseq,
       xrde002,xrde006,xrde003,xrde004,xrde008,xrde100,xrde109,xrde101,xrde119,xrde120,xrde121,xrde129,
       xrde130,xrde131,xrde139,xrde001,xrdedocno,xrdeld,xrdesite,xrdeseq,xrde002,xrde006,xrde003,xrde004,
       xrde008,xrde100,xrde109,xrde101,xrde119,xrde010,xrde016,xrde017,xrde018,xrde019,
       xrde020,xrde022,xrde023 FROM xrde_t WHERE xrdeent=? AND xrdeld=? AND xrdedocno=? AND xrdeseq=?
       FOR UPDATE"
   LET g_forupd_sql = cl_sql_forupd(g_forupd_sql)
   LET g_forupd_sql = cl_sql_add_mask(g_forupd_sql)              #遮蔽特定資料
   DECLARE axrt300_02_bcl1 CURSOR FROM g_forupd_sql]]>
  </point>
  <point name="main.define" order="" ver="7" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   DEFINE p_doc       LIKE xrce_t.xrcedocno
   DEFINE p_ld        LIKE xrce_t.xrceld
   DEFINE l_success   LIKE type_t.chr1
   DEFINE l_xrce109   LIKE xrce_t.xrce109
   DEFINE l_xrce119   LIKE xrce_t.xrce119
   DEFINE l_xrce129   LIKE xrce_t.xrce129
   DEFINE l_xrce139   LIKE xrce_t.xrce139
   #150311-00003#2 By 01727 Add  ---(S)---
   DEFINE l_xrca106   LIKE xrca_t.xrca106
   DEFINE l_xrca107   LIKE xrca_t.xrca107
   DEFINE l_xrca116   LIKE xrca_t.xrca116
   DEFINE l_xrca117   LIKE xrca_t.xrca117
   DEFINE l_xrca126   LIKE xrca_t.xrca126
   DEFINE l_xrca127   LIKE xrca_t.xrca127
   DEFINE l_xrca136   LIKE xrca_t.xrca136
   DEFINE l_xrca137   LIKE xrca_t.xrca137
   DEFINE l_errno     LIKE type_t.chr10
   #150311-00003#2 By 01727 Add  ---(E)---]]>
  </point>
  <point name="main.exit" order="" ver="8" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   LET g_action_choice = ''
   IF g_xrca_t.xrcastus <> 'Y' THEN
      CALL s_transaction_begin()

     #150311-00003#2 By 01727 Mark ---(S)---
     #SELECT xrce109,xrce119,xrce129,xrce139 INTO l_xrce109,l_xrce119,l_xrce129,l_xrce139
     #  FROM xrce_t
     # WHERE xrceent   = g_enterprise
     #   AND xrceld    = p_ld
     #   AND xrcedocno = p_doc
     #IF cl_null(l_xrce109) THEN LET l_xrce109 = 0 END IF
     #IF cl_null(l_xrce119) THEN LET l_xrce119 = 0 END IF
     #IF cl_null(l_xrce129) THEN LET l_xrce129 = 0 END IF
     #IF cl_null(l_xrce139) THEN LET l_xrce139 = 0 END IF
     #
     ##UPDATE xrca_t SET xrca107 = l_xrce109,
     ##                  xrca117 = l_xrce119,
     ##                  xrca127 = l_xrce129,
     ##                  xrca137 = l_xrce139
     ## WHERE xrcaent   = g_enterprise
     ##   AND xrcadocno = p_doc
     ##   AND xrcald    = p_ld
     #
     #UPDATE xrca_t SET xrca107 = g_amt1,
     #                  xrca117 = g_amt2,
     #                  xrca127 = g_amt3,
     #                  xrca137 = g_amt4,
     #                  #20150323--add--str--
     #                  xrca106 = g_amt5,
     #                  xrca116 = g_amt6,
     #                  xrca126 = g_amt7,
     #                  xrca136 = g_amt8
     #                  #20150323--add--end--
     # WHERE xrcaent   = g_enterprise
     #   AND xrcadocno = p_doc
     #   AND xrcald    = p_ld
     #150311-00003#2 By 01727 Mark ---(E)---
     #150311-00003#2 By 01727 Add  ---(S)---
     #應稅折抵者回寫xrca106
      LET l_xrca106 = 0   LET l_xrca116 = 0
      LET l_xrca126 = 0   LET l_xrca136 = 0
      SELECT SUM(xrce109 * CASE WHEN xrce015 = 'D' THEN 1 ELSE -1 END),SUM(xrce119 * CASE WHEN xrce015 = 'D' THEN 1 ELSE -1 END)
        INTO l_xrca106,l_xrca116
        FROM xrce_t
       WHERE xrceent = g_enterprise   AND xrcedocno = p_doc
         AND xrceld  = p_ld           AND xrce027   = 'Y'
      IF cl_null(l_xrca106) THEN LET l_xrca106 = 0 END IF
      IF cl_null(l_xrca116) THEN LET l_xrca116 = 0 END IF
      IF g_glaa_t.glaa015 = 'Y' THEN
         IF g_glaa_t.glaa017 = '1' THEN
            LET l_xrca126 = l_xrca106 * g_xrca_t.xrca121
         ELSE
            LET l_xrca126 = l_xrca116 * g_xrca_t.xrca121
         END IF
      END IF
      IF g_glaa_t.glaa019 = 'Y' THEN
         IF g_glaa_t.glaa021 = '1' THEN
            LET l_xrca136 = l_xrca106 * g_xrca_t.xrca131
         ELSE
            LET l_xrca136 = l_xrca116 * g_xrca_t.xrca131
         END IF
      END IF
      IF cl_null(l_xrca106) THEN LET l_xrca106 = 0 END IF IF cl_null(l_xrca116) THEN LET l_xrca116 = 0 END IF
      IF cl_null(l_xrca126) THEN LET l_xrca126 = 0 END IF IF cl_null(l_xrca136) THEN LET l_xrca136 = 0 END IF
      UPDATE xrca_t SET xrca106 = l_xrca106,
                        xrca116 = l_xrca116,
                        xrca126 = l_xrca126,
                        xrca136 = l_xrca136
       WHERE xrcaent   = g_enterprise
         AND xrcadocno = p_doc
         AND xrcald    = p_ld
     #非應稅折抵者及直接收款者寫入xrca107
      LET l_xrca106 = 0   LET l_xrca116 = 0
      LET l_xrca126 = 0   LET l_xrca136 = 0
      SELECT SUM(xrce109 * CASE WHEN xrce015 = 'D' THEN 1 ELSE -1 END),SUM(xrce119 * CASE WHEN xrce015 = 'D' THEN 1 ELSE -1 END)
        INTO l_xrca106,l_xrca116
        FROM xrce_t
       WHERE xrceent = g_enterprise   AND xrcedocno = p_doc
         AND xrceld  = p_ld           AND xrce027   = 'N'
      IF cl_null(l_xrca106) THEN LET l_xrca106 = 0 END IF
      IF cl_null(l_xrca116) THEN LET l_xrca116 = 0 END IF
      IF g_glaa_t.glaa015 = 'Y' THEN
         IF g_glaa_t.glaa017 = '1' THEN
            LET l_xrca126 = l_xrca106 * g_xrca_t.xrca121
         ELSE
            LET l_xrca126 = l_xrca116 * g_xrca_t.xrca121
         END IF
      END IF
      IF g_glaa_t.glaa019 = 'Y' THEN
         IF g_glaa_t.glaa021 = '1' THEN
            LET l_xrca136 = l_xrca106 * g_xrca_t.xrca131
         ELSE
            LET l_xrca136 = l_xrca116 * g_xrca_t.xrca131
         END IF
      END IF
      IF cl_null(l_xrca106) THEN LET l_xrca106 = 0 END IF IF cl_null(l_xrca116) THEN LET l_xrca116 = 0 END IF
      IF cl_null(l_xrca126) THEN LET l_xrca126 = 0 END IF IF cl_null(l_xrca136) THEN LET l_xrca136 = 0 END IF
      LET l_xrca107 = 0   LET l_xrca117 = 0
      LET l_xrca127 = 0   LET l_xrca137 = 0
      SELECT SUM(xrde109 * CASE WHEN xrde015 = 'D' THEN 1 ELSE -1 END),SUM(xrde119 * CASE WHEN xrde015 = 'D' THEN 1 ELSE -1 END)
        INTO l_xrca107,l_xrca117
        FROM xrde_t
       WHERE xrdeent = g_enterprise   AND xrdedocno = p_doc
         AND xrdeld  = p_ld
      IF cl_null(l_xrca107) THEN LET l_xrca107 = 0 END IF
      IF cl_null(l_xrca117) THEN LET l_xrca117 = 0 END IF
      IF g_glaa_t.glaa015 = 'Y' THEN
         IF g_glaa_t.glaa017 = '1' THEN
            LET l_xrca127 = l_xrca107 * g_xrca_t.xrca121
         ELSE
            LET l_xrca127 = l_xrca117 * g_xrca_t.xrca121
         END IF
      END IF
      IF g_glaa_t.glaa019 = 'Y' THEN
         IF g_glaa_t.glaa021 = '1' THEN
            LET l_xrca137 = l_xrca107 * g_xrca_t.xrca131
         ELSE
            LET l_xrca137 = l_xrca117 * g_xrca_t.xrca131
         END IF
      END IF
      IF cl_null(l_xrca107) THEN LET l_xrca107 = 0 END IF IF cl_null(l_xrca117) THEN LET l_xrca117 = 0 END IF
      IF cl_null(l_xrca127) THEN LET l_xrca127 = 0 END IF IF cl_null(l_xrca137) THEN LET l_xrca137 = 0 END IF
      UPDATE xrca_t SET xrca107 = l_xrca106 + l_xrca107,
                        xrca117 = l_xrca116 + l_xrca117,
                        xrca127 = l_xrca126 + l_xrca127,
                        xrca137 = l_xrca136 + l_xrca137
       WHERE xrcaent   = g_enterprise
         AND xrcadocno = p_doc
         AND xrcald    = p_ld
     #150311-00003#2 By 01727 Add  ---(E)---

      CALL s_axrt300_installments(g_xrca_t.xrcald,g_xrca_t.xrcadocno) RETURNING l_success
      IF l_success THEN
         CALL s_transaction_end('Y',0)
      ELSE
         CALL s_transaction_end('N',0)
      END IF
   END IF]]>
  </point>
  <point name="main.get_var" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   p_doc,p_ld]]>
  </point>
  <point name="main.init" order="" ver="4" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   SELECT * INTO g_xrca_t.* FROM xrca_t WHERE xrcaent = g_enterprise
      AND xrcadocno = p_doc
      AND xrcald    = p_ld
      
   SELECT * INTO g_glaa_t.* FROM glaa_t WHERE glaaent = g_enterprise
      AND glaald = p_ld
]]>
  </point>
  <point name="modify.after_input" order="" ver="8" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   IF l_flag = 'Y' THEN
      CONTINUE WHILE
   ELSE
      EXIT WHILE
   END IF
   END WHILE
   CLOSE axrt300_02_bcl1
   
   CALL axrt300_02_ref_amt()
  #SELECT COUNT(*) INTO l_cnt 
  #  FROM xrde_t
  # WHERE xrdeent = g_enterprise
  #   AND xrdedocno = g_xrca_t.xrcadocno
  #   AND xrdeld = g_xrca_t.xrcald
  #   AND xrde002 = '10'
  #   
  #IF l_cnt = 1 THEN
      SELECT DISTINCT xrde100 INTO l_xrde100
        FROM xrde_t
       WHERE xrdeent = g_enterprise
         AND xrdedocno = g_xrca_t.xrcadocno
         AND xrdeld = g_xrca_t.xrcald
         AND xrde002 = '10'  
         
      IF g_amt_9 > g_amt_1 THEN 
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = '' 
         LET g_errparam.code   = 'axr-00248' 
         LET g_errparam.popup  = TRUE 
         CALL cl_err()
         
         RETURN
      END IF
     
      IF g_xrca_t.xrca100 <> g_glaa_t.glaa001 AND l_xrde100 = g_xrca_t.xrca100 AND g_amt_1 = g_amt1 AND g_amt <> 0  THEN 
         IF g_amt > 0 THEN 
            CALL axrt400_09('1',g_xrca_t.xrcasite,g_xrca_t.xrcacomp,g_xrca_t.xrca003,g_xrca_t.xrca004,g_xrca_t.xrcadocno,g_xrca_t.xrcadocdt,g_xrca_t.xrcald,g_amt)
         ELSE
            CALL axrt400_09('2',g_xrca_t.xrcasite,g_xrca_t.xrcacomp,g_xrca_t.xrca003,g_xrca_t.xrca004,g_xrca_t.xrcadocno,g_xrca_t.xrcadocdt,g_xrca_t.xrcald,g_amt)
         END IF
      END IF
      CALL axrt300_02_b_fill(g_wc2)
      CALL axrt300_02_ref_amt()
  #END IF]]>
  </point>
  <point name="modify.before_input" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   WHILE TRUE
      LET l_flag = 'N']]>
  </point>
  <point name="modify.define" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   DEFINE  l_flag          LIKE type_t.chr1
   DEFINE  l_ooab002       LIKE ooab_t.ooab002
   DEFINE  l_ooaistus      LIKE ooai_t.ooaistus
   DEFINE  l_xrcastus      LIKE xrca_t.xrcastus
   DEFINE  l_glacstus      LIKE glac_t.glacstus
   DEFINE  l_amt           LIKE xrce_t.xrce109
   DEFINE  l_glaa001       LIKE glaa_t.glaa001
   DEFINE  l_ooagstus      LIKE ooag_t.ooagstus
   DEFINE  l_xrca060       LIKE xrca_t.xrca060
   DEFINE  l_gzcb004       LIKE gzcb_t.gzcb004
   DEFINE  l_xrce109       LIKE xrce_t.xrce109
   DEFINE  l_xrce119       LIKE xrce_t.xrce119
   DEFINE  l_xrce003       LIKE xrce_t.xrce003
   DEFINE  l_xrce004       LIKE xrce_t.xrce004
   DEFINE  l_xrce005       LIKE xrce_t.xrce005
   DEFINE  l_xrde100       LIKE xrde_t.xrde100
   DEFINE  l_xrde011       LIKE xrde_t.xrde011
   DEFINE  l_success       LIKE type_t.num5
   DEFINE  l_glaa005       LIKE glaa_t.glaa005]]>
  </point>
  <point name="modify.define_sql" order="" ver="8" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   IF g_prog = 'axrt350' THEN
      LET l_allow_insert = FALSE
      LET l_allow_delete = FALSE
   END IF]]>
  </point>
  <point name="query.c.page1.xrde012_u" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #開窗c段
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_xrce_d[l_ac].xrde012             #給予default值
            LET l_glaa005 = ''
            SELECT glaa005 INTO l_glaa005 FROM glaa_t
             WHERE glaaent = g_enterprise AND glaald = g_xrca_t.xrcald
            LET g_qryparam.where = " nmai001 = '",l_glaa005,"'"
            #給予arg

            CALL q_nmai002()                                #呼叫開窗
            DISPLAY g_qryparam.return1 TO xrde012_u  #顯示到畫面上
            NEXT FIELD xrde012_u                          #返回原欄位
]]>
  </point>
  <point name="query.c.page3.xrce010_u" order="" ver="1" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_oocq002_2()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO xrce010_u  #顯示到畫面上

            NEXT FIELD xrce010_u                     #返回原欄位]]>
  </point>
  <point name="query.define" order="" ver="6" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   DEFINE l_glaa005  LIKE glaa_t.glaa005]]>
  </point>
  <point name="set_entry_b.set_entry_b" order="" ver="4" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   CALL cl_set_comp_entry('xrce100,xrce101',TRUE)
   CALL cl_set_comp_entry('xrce100_t,xrce101_t',TRUE)
   CALL cl_set_comp_entry('xrce006,xrce003,xrce004,xrce100,xrce109',TRUE)
   CALL cl_set_comp_entry('xrce101,xrce119,xrce010,xrce019',TRUE)
   CALL cl_set_comp_entry('xrce004',TRUE)]]>
  </point>
  <point name="set_no_entry_b.set_no_entry_b" order="" ver="8" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   CASE
      WHEN g_xrce_d[l_ac].xrce002 = '10'
         CALL cl_set_comp_entry('xrce100,xrce101',FALSE)
         CALL cl_set_comp_entry('xrce100_t,xrce101_t',FALSE)
      WHEN g_xrce_d[l_ac].xrce002 = '11'
         CALL cl_set_comp_entry('xrce006,xrce003,xrce004,xrce005',FALSE)
      WHEN g_xrce_d[l_ac].xrce002 = '12'
         CALL cl_set_comp_entry('xrce006,xrce003,xrce004,xrce005',FALSE)
      WHEN g_xrce_d[l_ac].xrce002 = '13'
         CALL cl_set_comp_entry('xrce006,xrce003,xrce004,xrce005',FALSE)
      WHEN g_xrce_d[l_ac].xrce002 = '14'
         CALL cl_set_comp_entry('xrce006,xrce003,xrce004,xrce005',FALSE)
      WHEN g_xrce_d[l_ac].xrce002 = '15'
         CALL cl_set_comp_entry('xrce006,xrce003,xrce004,xrce005',FALSE)
      WHEN g_xrce_d[l_ac].xrce002 = '20'
         CALL cl_set_comp_entry('xrce006,xrce003,xrce004,xrce005',FALSE)
      WHEN g_xrce_d[l_ac].xrce002 = '21'
         CALL cl_set_comp_entry('xrce006,xrce003,xrce004,xrce005',FALSE)
      WHEN g_xrce_d[l_ac].xrce002 = '31'
         CALL cl_set_comp_entry('xrce006,xrce100,xrce101',FALSE)
      WHEN g_xrce_d[l_ac].xrce002 = '32'
         CALL cl_set_comp_entry('xrce006,xrce100,xrce101',FALSE)
      WHEN g_xrce_d[l_ac].xrce002 = '91'
         CALL cl_set_comp_entry('xrce006,xrce003,xrce004,xrce005',FALSE)
      WHEN g_xrce_d[l_ac].xrce002 = '92'
         CALL cl_set_comp_entry('xrce006,xrce003,xrce004,xrce005',FALSE)
         
   END CASE
   
   IF g_prog = "axrt350" THEN
      CALL cl_set_comp_entry('xrceseq,xrce002,xrce006,xrce003,xrce004,xrce005,xrce100,xrce109,xrce119',FALSE)
   END IF]]>
  </point>
  <point name="ui_dialog.b_dialog" order="" ver="5" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[            IF g_xrca_t.xrcastus <> 'N' THEN 
               CALL cl_set_act_visible("insert,modify,delete,modify_detail", FALSE)  
            ELSE
               CALL cl_set_act_visible("insert,modify,delete,modify_detail", TRUE)  
            END IF
            CALL cl_set_act_visible("logistics", FALSE) ]]>
  </point>
  <point name="ui_dialog.before_dialog" order="" ver="5" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   LET g_wc2 = " xrcedocno = '",g_xrca_t.xrcadocno,"' AND xrceld = '",g_xrca_t.xrcald,"'"]]>
  </point>
  <point name="ui_dialog.body.before_display" order="" ver="9" cite_std="N" new="N" status="u" src="s" readonly="" mark_hard="N">
    <![CDATA[
               IF g_prog = 'axrt350' THEN
                  CALL cl_set_comp_visible('xrce002,xrce003,xrce004,xrce005',FALSE)
                  CALL cl_set_comp_visible('xrde007,xrde007_desc',TRUE)
               ELSE
                  CALL cl_set_comp_visible('xrce002,xrce003,xrce004,xrce005',TRUE)
                  CALL cl_set_comp_visible('xrde007,xrde007_desc',FALSE)
               END IF
]]>
  </point>
  <point name="ui_dialog.define" order="" ver="5" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   ]]>
  </point>
  <point name="unlock_b.define" order="" ver="4" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   LET ls_group = ""
   CLOSE axrt300_02_bcl1]]>
  </point>
  <point name="update_b.b_update" order="" ver="4" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[      SELECT gzcb004 INTO l_gzcb004
        FROM gzcb_t
       WHERE gzcb001 = '8306'
         AND gzcb002 = g_xrce_d[l_ac].xrce002
      IF l_gzcb004 = '2' THEN ]]>
  </point>
  <point name="update_b.define" order="" ver="4" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[   DEFINE l_gzcb004        LIKE gzcb_t.gzcb004]]>
  </point>
  <point name="update_b.m_update" order="" ver="4" cite_std="N" new="N" status="" src="s" readonly="" mark_hard="N">
    <![CDATA[      ELSE
         UPDATE xrde_t 
            SET (xrdeld,xrdedocno,xrdeseq
                 ,xrde001,xrdesite,xrde002,xrde006,xrde003,xrde004,xrde008,xrde100,
                  xrde109,xrde101,xrde119,xrde010,xrde018,xrde015,xrde028,
                  xrdecomp,xrdeorga,xrde001,xrdesite,xrde002,xrde006,xrde003,xrde004,xrde008,xrde100,xrde109,
                  xrde101,xrde119,xrde120,xrde121,xrde129,xrde130,xrde131,xrde139,xrde001,xrdesite,xrde002,
                  xrde006,xrde003,xrde004,xrde008,xrde100,xrde109,xrde101,xrde119,xrde010,
                  xrde016,xrde017,xrde018,xrde019,xrde020,xrde022,xrde023) 
                 = 
                (ps_keys[1],ps_keys[2],ps_keys[3]
                 ,g_xrce_d[l_ac].xrce001,g_xrce_d[l_ac].xrcesite,g_xrce_d[l_ac].xrce002,g_xrce_d[l_ac].xrce006, 
                     g_xrce_d[l_ac].xrce003,g_xrce_d[l_ac].xrce004,
                     g_xrce_d[l_ac].xrce008,g_xrce_d[l_ac].xrce100,g_xrce_d[l_ac].xrce109, 
                     g_xrce_d[l_ac].xrce101,g_xrce_d[l_ac].xrce119,g_xrce3_d[l_ac].xrce010, 
                     g_xrce3_d[l_ac].xrce018,g_xrce_d[l_ac].xrce015,g_xrce_d[l_ac].xrce028,g_xrce_d[l_ac].xrcecomp, 
                     g_xrce_d[l_ac].xrceorga,g_xrce_d[l_ac].xrce001,g_xrce_d[l_ac].xrcesite,g_xrce_d[l_ac].xrce002, 
                     g_xrce_d[l_ac].xrce006,g_xrce_d[l_ac].xrce003,g_xrce_d[l_ac].xrce004,g_xrce_d[l_ac].xrce008, 
                     g_xrce_d[l_ac].xrce100,g_xrce_d[l_ac].xrce109,g_xrce_d[l_ac].xrce101,g_xrce_d[l_ac].xrce119, 
                     g_xrce2_d[l_ac].xrce120,g_xrce2_d[l_ac].xrce121,g_xrce2_d[l_ac].xrce129,g_xrce2_d[l_ac].xrce130, 
                     g_xrce2_d[l_ac].xrce131,g_xrce2_d[l_ac].xrce139,g_xrce_d[l_ac].xrce001,g_xrce_d[l_ac].xrcesite, 
                     g_xrce_d[l_ac].xrce002,g_xrce_d[l_ac].xrce006,g_xrce_d[l_ac].xrce003,g_xrce_d[l_ac].xrce004, 
                     g_xrce_d[l_ac].xrce008,g_xrce_d[l_ac].xrce100,g_xrce_d[l_ac].xrce109, 
                     g_xrce_d[l_ac].xrce101,g_xrce_d[l_ac].xrce119,g_xrce3_d[l_ac].xrce010, 
                     g_xrce3_d[l_ac].xrce016,g_xrce3_d[l_ac].xrce017,g_xrce3_d[l_ac].xrce018,g_xrce3_d[l_ac].xrce019, 
                     g_xrce3_d[l_ac].xrce020,g_xrce3_d[l_ac].xrce022,g_xrce3_d[l_ac].xrce023) 
            WHERE xrdeld = ps_keys_bak[1] AND xrdedocno = ps_keys_bak[2] AND xrdeseq = ps_keys_bak[3]
      END IF]]>
  </point>
  <section id="axrt300_02.b_fill" ver="28" status="" src="s" readonly="">
    <![CDATA[#+ 單身陣列填充
PRIVATE FUNCTION axrt300_02_b_fill(p_wc2)              #BODY FILL UP
   DEFINE p_wc2    STRING
   #add-point:b_fill段define
   {<point name="b_fill.define" edit="s"/>}
   #end add-point
   #add-point:b_fill段define(客製用)
   {<point name="b_fill.define_customerization" edit="c"/>}
   #end add-point
   
   IF cl_null(p_wc2) THEN
      LET p_wc2 = " 1=1"
   END IF
   
   #add-point:b_fill段sql之前
   {<point name="b_fill.sql_before"/>}
   #end add-point
 
   LET g_sql = "SELECT  UNIQUE t0.xrce001,t0.xrcedocno,t0.xrceld,t0.xrcesite,t0.xrceseq,t0.xrce002,t0.xrce006, 
       t0.xrce003,t0.xrce004,t0.xrce005,t0.xrce024,t0.xrce025,t0.xrce008,t0.xrce015,t0.xrce100,t0.xrce101, 
       t0.xrce109,t0.xrce119,t0.xrce027,t0.xrce028,t0.xrce104,t0.xrce114,t0.xrce124,t0.xrce134,t0.xrcecomp, 
       t0.xrceorga,t0.xrce010,t0.xrce016,t0.xrce001,t0.xrcedocno,t0.xrceld,t0.xrcesite,t0.xrceseq,t0.xrce002, 
       t0.xrce006,t0.xrce003,t0.xrce004,t0.xrce008,t0.xrce100,t0.xrce109,t0.xrce101,t0.xrce119,t0.xrce120, 
       t0.xrce121,t0.xrce129,t0.xrce130,t0.xrce131,t0.xrce139,t0.xrce001,t0.xrcedocno,t0.xrceld,t0.xrcesite, 
       t0.xrceseq,t0.xrce002,t0.xrce006,t0.xrce003,t0.xrce004,t0.xrce005,t0.xrce008,t0.xrce100,t0.xrce109, 
       t0.xrce101,t0.xrce119,t0.xrce027,t0.xrce010,t0.xrce016,t0.xrce017,t0.xrce018,t0.xrce019,t0.xrce020, 
       t0.xrce022,t0.xrce023 ,t1.ooag011 ,t2.ooefl003 ,t3.ooefl003 ,t4.rtaxl003 FROM xrce_t t0",
               "",
                              " LEFT JOIN ooag_t t1 ON t1.ooagent='"||g_enterprise||"' AND t1.ooag001=t0.xrce017  ",
               " LEFT JOIN ooefl_t t2 ON t2.ooeflent='"||g_enterprise||"' AND t2.ooefl001=t0.xrce018 AND t2.ooefl002='"||g_dlang||"' ",
               " LEFT JOIN ooefl_t t3 ON t3.ooeflent='"||g_enterprise||"' AND t3.ooefl001=t0.xrce019 AND t3.ooefl002='"||g_dlang||"' ",
               " LEFT JOIN rtaxl_t t4 ON t4.rtaxlent='"||g_enterprise||"' AND t4.rtaxl001=t0.xrce020 AND t4.rtaxl002='"||g_dlang||"' ",
 
               " WHERE t0.xrceent= ?  AND  1=1 AND (", p_wc2, ") " 
   #add-point:b_fill段sql wc
   {<point name="b_fill.sql_wc"/>}
   #end add-point
   LET g_sql = g_sql, cl_sql_add_filter("xrce_t"),
                      " ORDER BY t0.xrceld,t0.xrcedocno,t0.xrceseq"
   
   #add-point:b_fill段sql之後
   {<point name="b_fill.sql_after"/>}
   #end add-point
   
   #LET g_sql = cl_sql_add_tabid(g_sql,"xrce_t")            #WC重組
   LET g_sql = cl_sql_add_mask(g_sql)              #遮蔽特定資料
   PREPARE axrt300_02_pb FROM g_sql
   DECLARE b_fill_curs CURSOR FOR axrt300_02_pb
   
   OPEN b_fill_curs USING g_enterprise
 
   CALL g_xrce_d.clear()
   CALL g_xrce2_d.clear()   
   CALL g_xrce3_d.clear()   
 
 
   LET g_cnt = l_ac
   LET l_ac = 1   
   ERROR "Searching!" 
 
   FOREACH b_fill_curs INTO g_xrce_d[l_ac].xrce001,g_xrce_d[l_ac].xrcedocno,g_xrce_d[l_ac].xrceld,g_xrce_d[l_ac].xrcesite, 
       g_xrce_d[l_ac].xrceseq,g_xrce_d[l_ac].xrce002,g_xrce_d[l_ac].xrce006,g_xrce_d[l_ac].xrce003,g_xrce_d[l_ac].xrce004, 
       g_xrce_d[l_ac].xrce005,g_xrce_d[l_ac].xrce024,g_xrce_d[l_ac].xrce025,g_xrce_d[l_ac].xrce008,g_xrce_d[l_ac].xrce015, 
       g_xrce_d[l_ac].xrce100,g_xrce_d[l_ac].xrce101,g_xrce_d[l_ac].xrce109,g_xrce_d[l_ac].xrce119,g_xrce_d[l_ac].xrce027, 
       g_xrce_d[l_ac].xrce028,g_xrce_d[l_ac].xrce104,g_xrce_d[l_ac].xrce114,g_xrce_d[l_ac].xrce124,g_xrce_d[l_ac].xrce134, 
       g_xrce_d[l_ac].xrcecomp,g_xrce_d[l_ac].xrceorga,g_xrce_d[l_ac].xrce010,g_xrce_d[l_ac].xrce016, 
       g_xrce2_d[l_ac].xrce001,g_xrce2_d[l_ac].xrcedocno,g_xrce2_d[l_ac].xrceld,g_xrce2_d[l_ac].xrcesite, 
       g_xrce2_d[l_ac].xrceseq,g_xrce2_d[l_ac].xrce002,g_xrce2_d[l_ac].xrce006,g_xrce2_d[l_ac].xrce003, 
       g_xrce2_d[l_ac].xrce004,g_xrce2_d[l_ac].xrce008,g_xrce2_d[l_ac].xrce100,g_xrce2_d[l_ac].xrce109, 
       g_xrce2_d[l_ac].xrce101,g_xrce2_d[l_ac].xrce119,g_xrce2_d[l_ac].xrce120,g_xrce2_d[l_ac].xrce121, 
       g_xrce2_d[l_ac].xrce129,g_xrce2_d[l_ac].xrce130,g_xrce2_d[l_ac].xrce131,g_xrce2_d[l_ac].xrce139, 
       g_xrce3_d[l_ac].xrce001,g_xrce3_d[l_ac].xrcedocno,g_xrce3_d[l_ac].xrceld,g_xrce3_d[l_ac].xrcesite, 
       g_xrce3_d[l_ac].xrceseq,g_xrce3_d[l_ac].xrce002,g_xrce3_d[l_ac].xrce006,g_xrce3_d[l_ac].xrce003, 
       g_xrce3_d[l_ac].xrce004,g_xrce3_d[l_ac].xrce005,g_xrce3_d[l_ac].xrce008,g_xrce3_d[l_ac].xrce100, 
       g_xrce3_d[l_ac].xrce109,g_xrce3_d[l_ac].xrce101,g_xrce3_d[l_ac].xrce119,g_xrce3_d[l_ac].xrce027, 
       g_xrce3_d[l_ac].xrce010,g_xrce3_d[l_ac].xrce016,g_xrce3_d[l_ac].xrce017,g_xrce3_d[l_ac].xrce018, 
       g_xrce3_d[l_ac].xrce019,g_xrce3_d[l_ac].xrce020,g_xrce3_d[l_ac].xrce022,g_xrce3_d[l_ac].xrce023, 
       g_xrce3_d[l_ac].xrce017_desc,g_xrce3_d[l_ac].xrce018_u_desc,g_xrce3_d[l_ac].xrce019_desc,g_xrce3_d[l_ac].xrce020_desc 

      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = "FOREACH:" 
         LET g_errparam.code   = SQLCA.sqlcode 
         LET g_errparam.popup  = TRUE 
         CALL cl_err()
         EXIT FOREACH
      END IF
  
      #add-point:b_fill段資料填充
      {<point name="b_fill.fill"/>}
      #end add-point
      
      CALL axrt300_02_detail_show()      
 
      IF l_ac > g_max_rec THEN
         IF g_error_show = 1 THEN
            INITIALIZE g_errparam TO NULL 
            LET g_errparam.extend = l_ac
            LET g_errparam.code   = 9035 
            LET g_errparam.popup  = TRUE 
            CALL cl_err()
         END IF
         EXIT FOREACH
      END IF
 
      LET l_ac = l_ac + 1
      
   END FOREACH
 
   LET g_error_show = 0
   
 
   
   CALL g_xrce_d.deleteElement(g_xrce_d.getLength())   
   CALL g_xrce2_d.deleteElement(g_xrce2_d.getLength())
   CALL g_xrce3_d.deleteElement(g_xrce3_d.getLength())
 
   
   #將key欄位填到每個page
   FOR l_ac = 1 TO g_xrce_d.getLength()
      LET g_xrce2_d[l_ac].xrceld = g_xrce_d[l_ac].xrceld 
      LET g_xrce2_d[l_ac].xrcedocno = g_xrce_d[l_ac].xrcedocno 
      LET g_xrce2_d[l_ac].xrceseq = g_xrce_d[l_ac].xrceseq 
      LET g_xrce3_d[l_ac].xrceld = g_xrce_d[l_ac].xrceld 
      LET g_xrce3_d[l_ac].xrcedocno = g_xrce_d[l_ac].xrcedocno 
      LET g_xrce3_d[l_ac].xrceseq = g_xrce_d[l_ac].xrceseq 
 
      #add-point:b_fill段key值相關欄位
      {<point name="b_fill.keys.fill"/>}
      #end add-point
   END FOR
   
   IF g_cnt > g_xrce_d.getLength() THEN
      LET l_ac = g_xrce_d.getLength()
   ELSE
      LET l_ac = g_cnt
   END IF
   LET g_cnt = l_ac
 
   #遮罩相關處理
   FOR l_ac = 1 TO g_xrce_d.getLength()
      LET g_xrce_d_mask_o[l_ac].* =  g_xrce_d[l_ac].*
      CALL axrt300_02_xrce_t_mask()
      LET g_xrce_d_mask_n[l_ac].* =  g_xrce_d[l_ac].*
   END FOR
   
   LET g_xrce2_d_mask_o.* =  g_xrce2_d.*
   FOR l_ac = 1 TO g_xrce2_d.getLength()
      LET g_xrce2_d_mask_o[l_ac].* =  g_xrce2_d[l_ac].*
      CALL axrt300_02_xrce_t_mask()
      LET g_xrce2_d_mask_n[l_ac].* =  g_xrce2_d[l_ac].*
   END FOR
   LET g_xrce3_d_mask_o.* =  g_xrce3_d.*
   FOR l_ac = 1 TO g_xrce3_d.getLength()
      LET g_xrce3_d_mask_o[l_ac].* =  g_xrce3_d[l_ac].*
      CALL axrt300_02_xrce_t_mask()
      LET g_xrce3_d_mask_n[l_ac].* =  g_xrce3_d[l_ac].*
   END FOR
 
 
   #add-point:b_fill段資料填充(其他單身)
   {<point name="b_fill.others.fill"/>}
   #end add-point
   
   ERROR "" 
 
   LET g_detail_cnt = g_xrce_d.getLength()
   DISPLAY g_detail_idx TO FORMONLY.idx
   DISPLAY g_detail_cnt TO FORMONLY.cnt
   
   CLOSE b_fill_curs
   FREE axrt300_02_pb
   
END FUNCTION
]]>
  </section>
  <section id="axrt300_02.default_search" ver="12" status="" src="s" readonly="">
    <![CDATA[#+ 外部參數搜尋
PRIVATE FUNCTION axrt300_02_default_search()
   DEFINE li_idx  LIKE type_t.num10
   DEFINE li_cnt  LIKE type_t.num10
   DEFINE ls_wc   STRING
   #add-point:default_search段define
   {<point name="default_search.define" edit="s"/>}
   #end add-point  
   #add-point:default_search段define(客製用)
   {<point name="default_search.define_customerization" edit="c"/>}
   #end add-point
   
   #add-point:default_search段開始前
   {<point name="default_search.before"/>}
   #end add-point  
   
   IF NOT cl_null(g_argv[01]) THEN
      LET ls_wc = ls_wc, " xrceld = '", g_argv[01], "' AND "
   END IF
   
   IF NOT cl_null(g_argv[02]) THEN
      LET ls_wc = ls_wc, " xrcedocno = '", g_argv[02], "' AND "
   END IF
   IF NOT cl_null(g_argv[03]) THEN
      LET ls_wc = ls_wc, " xrceseq = '", g_argv[03], "' AND "
   END IF
 
   
   #add-point:default_search段after sql
   {<point name="default_search.after_sql"/>}
   #end add-point  
   
   IF NOT cl_null(ls_wc) THEN
      LET ls_wc = ls_wc.subString(1,ls_wc.getLength()-5)
      LET g_wc2 = ls_wc
   ELSE
      LET g_wc2 = " 1=1"
      #預設查詢條件
      LET g_wc2 = cl_qbe_get_default_qryplan()
      IF cl_null(g_wc2) THEN
         LET g_wc2 = " 1=1"
      END IF
   END IF
 
   #add-point:default_search段結束前
   {<point name="default_search.after"/>}
   #end add-point  
 
END FUNCTION
]]>
  </section>
  <section id="axrt300_02.delete" ver="12" status="" src="s" readonly="">
    <![CDATA[#+ 資料刪除
PRIVATE FUNCTION axrt300_02_delete()
   DEFINE li_idx          LIKE type_t.num10
   DEFINE li_ac_t         LIKE type_t.num10
   DEFINE li_detail_tmp   LIKE type_t.num10
   DEFINE l_var_keys      DYNAMIC ARRAY OF STRING
   DEFINE l_var_keys_bak  DYNAMIC ARRAY OF STRING
   DEFINE l_field_keys    DYNAMIC ARRAY OF STRING
   DEFINE l_vars          DYNAMIC ARRAY OF STRING
   DEFINE l_fields        DYNAMIC ARRAY OF STRING
   #add-point:delete段define
   {<point name="delete.define" edit="s"/>}
   #end add-point 
   #add-point:delete段define(客製用)
   {<point name="delete.define_customerization" edit="c"/>}
   #end add-point
   
   #add-point:單身刪除前
   {<point name="delete.body.before_delete"/>}
   #end add-point
   
   CALL s_transaction_begin()
   
   LET li_ac_t = l_ac
   
   LET li_detail_tmp = g_detail_idx
    
   #lock所有所選資料
   FOR li_idx = 1 TO g_xrce_d.getLength()
      LET g_detail_idx = li_idx
      #已選擇的資料
      IF g_curr_diag.isRowSelected(g_curr_diag.getCurrentItem(), li_idx) THEN 
         #確定是否有被鎖定
         IF NOT axrt300_02_lock_b("xrce_t") THEN
            #已被他人鎖定
            RETURN
         END IF
      END IF
   END FOR
   
   #add-point:單身刪除詢問前
   {<point name="delete.body.b_delete_ask"/>}
   #end add-point  
   
   #詢問是否確定刪除所選資料
   IF NOT cl_ask_del_detail() THEN
      RETURN
   END IF
   
   FOR li_idx = 1 TO g_xrce_d.getLength()
      IF g_xrce_d[li_idx].xrceld IS NOT NULL
         AND g_xrce_d[li_idx].xrcedocno IS NOT NULL
         AND g_xrce_d[li_idx].xrceseq IS NOT NULL
 
         AND g_curr_diag.isRowSelected(g_curr_diag.getCurrentItem(), li_idx) THEN 
         
         #add-point:單身刪除前
         {<point name="delete.body.b_delete" mark="Y"/>}
         #end add-point   
         
         DELETE FROM xrce_t
          WHERE xrceent = g_enterprise AND 
                xrceld = g_xrce_d[li_idx].xrceld
                AND xrcedocno = g_xrce_d[li_idx].xrcedocno
                AND xrceseq = g_xrce_d[li_idx].xrceseq
 
         #add-point:單身刪除中
         {<point name="delete.body.m_delete"/>}
         #end add-point  
                
         IF SQLCA.sqlcode THEN
            INITIALIZE g_errparam TO NULL 
            LET g_errparam.extend = "xrce_t" 
            LET g_errparam.code   = SQLCA.sqlcode 
            LET g_errparam.popup  = TRUE 
            CALL cl_err()
            RETURN
         ELSE
            LET g_detail_cnt = g_detail_cnt-1
            LET l_ac = li_idx
            
            
            
 
            
            
            
 
            #add-point:單身同步刪除前(同層table)
            {<point name="delete.body.a_delete"/>}
            #end add-point
            LET g_detail_idx = li_idx
                           INITIALIZE gs_keys TO NULL 
               LET gs_keys[1] = g_xrce_d_t.xrceld
               LET gs_keys[2] = g_xrce_d_t.xrcedocno
               LET gs_keys[3] = g_xrce_d_t.xrceseq
 
            #add-point:單身同步刪除中(同層table)
            {<point name="delete.body.a_delete2"/>}
            #end add-point
                           CALL axrt300_02_delete_b('xrce_t',gs_keys,"'1'")
            #add-point:單身同步刪除後(同層table)
            {<point name="delete.body.a_delete3"/>}
            #end add-point
         END IF 
      END IF 
    
   END FOR
   
   LET g_detail_idx = li_detail_tmp
            
   #add-point:單身刪除後
   {<point name="delete.after"/>}
   #end add-point  
   
   LET l_ac = li_ac_t
   
   #刷新資料
   CALL axrt300_02_b_fill(g_wc2)
            
END FUNCTION
]]>
  </section>
  <section id="axrt300_02.delete_b" ver="7" status="" src="s" readonly="">
    <![CDATA[#+ 刪除單身後其他table連動
PRIVATE FUNCTION axrt300_02_delete_b(ps_table,ps_keys_bak,ps_page)
   DEFINE ps_table    STRING
   DEFINE ps_page     STRING
   DEFINE ps_keys_bak DYNAMIC ARRAY OF VARCHAR(500)
   DEFINE ls_group    STRING
   DEFINE li_idx      LIKE type_t.num10
   #add-point:delete_b段define
   {<point name="delete_b.define" edit="s"/>}
   #end add-point     
   #add-point:delete_b段define(客製用)
   {<point name="delete_b.define_customerization" edit="c"/>}
   #end add-point
   
   #判斷是否是同一群組的table
   LET ls_group = "xrce_t,"
   IF ls_group.getIndexOf(ps_table,1) > 0 THEN
      IF ps_table <> 'xrce_t' THEN
         #add-point:delete_b段刪除前
         {<point name="delete_b.b_delete" mark="Y"/>}
         #end add-point     
         
         DELETE FROM xrce_t
          WHERE xrceent = g_enterprise AND
            xrceld = ps_keys_bak[1] AND xrcedocno = ps_keys_bak[2] AND xrceseq = ps_keys_bak[3]
         
         #add-point:delete_b段刪除中
         {<point name="delete_b.m_delete"/>}
         #end add-point  
            
         IF SQLCA.sqlcode THEN
            INITIALIZE g_errparam TO NULL 
            LET g_errparam.extend = "" 
            LET g_errparam.code   = SQLCA.sqlcode 
            LET g_errparam.popup  = FALSE 
            CALL cl_err()
         END IF
      END IF
      
      LET li_idx = g_detail_idx
      IF ps_page <> "'1'" THEN 
         CALL g_xrce_d.deleteElement(li_idx) 
      END IF 
      IF ps_page <> "'2'" THEN 
         CALL g_xrce2_d.deleteElement(li_idx) 
      END IF 
      IF ps_page <> "'3'" THEN 
         CALL g_xrce3_d.deleteElement(li_idx) 
      END IF 
 
      
      #add-point:delete_b段刪除後
      {<point name="delete_b.a_delete"/>}
      #end add-point
      
      RETURN
   END IF
   
 
   
END FUNCTION
]]>
  </section>
  <section id="axrt300_02.description" ver="11" status="" src="s" readonly="">
    <![CDATA[#應用 a00 樣板自動產生(Version:1)
#+ Version..: T100-ERP-1.00.00(SD版次:9,PR版次:9) Build-000409
#+ 
#+ Filename...: axrt300_02
#+ Description: 直接沖帳
#+ Creator....: 01727(2013-10-22 00:00:00)
#+ Modifier...: 01727(2015-06-17 17:27:03) -SD/PR-
]]>
  </section>
  <section id="axrt300_02.detail_show" ver="4" status="" src="s" readonly="">
    <![CDATA[#+ 顯示相關資料
PRIVATE FUNCTION axrt300_02_detail_show()
   #add-point:show段define
   {<point name="detail_show.define" edit="s"/>}
   #end add-point
   #add-point:detail_show段define(客製用)
   {<point name="detail_show.define_customerization" edit="c"/>}
   #end add-point
   
   #add-point:detail_show段之前
   {<point name="detail_show.before"/>}
   #end add-point
   
   
   
   #帶出公用欄位reference值page1
   
    
   #帶出公用欄位reference值page2
   
   #帶出公用欄位reference值page3
   
 
   
   #讀入ref值
   #add-point:show段單身reference
   {<point name="detail_show.reference"/>}
   #end add-point
   
   #add-point:show段單身reference
   {<point name="detail_show.body2.reference"/>}
   #end add-point
   #add-point:show段單身reference
   {<point name="detail_show.body3.reference"/>}
   #end add-point
 
   #add-point:detail_show段之後
   {<point name="detail_show.after"/>}
   #end add-point
 
END FUNCTION
]]>
  </section>
  <section id="axrt300_02.global" ver="28" status="" src="s" readonly="">
    <![CDATA[#應用 i02 樣板自動產生(Version:13)
{<point name="global.memo" />}
 
IMPORT os
IMPORT util
#add-point:增加匯入項目
{<point name="global.import" />}
#end add-point
 
SCHEMA ds
 
GLOBALS "../../cfg/top_global.inc"
 
#add-point:增加匯入變數檔
{<point name="global.inc" />}
#end add-point
 
#單身 type 宣告
PRIVATE TYPE type_g_xrce_d RECORD
       xrce001 LIKE xrce_t.xrce001, 
   xrcedocno LIKE xrce_t.xrcedocno, 
   xrceld LIKE xrce_t.xrceld, 
   xrcesite LIKE xrce_t.xrcesite, 
   xrceseq LIKE xrce_t.xrceseq, 
   xrce002 LIKE xrce_t.xrce002, 
   xrce006 LIKE xrce_t.xrce006, 
   xrde007 LIKE type_t.chr500, 
   xrde007_desc LIKE type_t.chr500, 
   xrce003 LIKE xrce_t.xrce003, 
   xrce004 LIKE xrce_t.xrce004, 
   xrce005 LIKE xrce_t.xrce005, 
   xrce024 LIKE xrce_t.xrce024, 
   xrce025 LIKE xrce_t.xrce025, 
   xrce008 LIKE xrce_t.xrce008, 
   xrce015 LIKE xrce_t.xrce015, 
   xrce100 LIKE xrce_t.xrce100, 
   xrce101 LIKE xrce_t.xrce101, 
   xrce109 LIKE xrce_t.xrce109, 
   xrce119 LIKE xrce_t.xrce119, 
   xrce027 LIKE xrce_t.xrce027, 
   xrce028 LIKE xrce_t.xrce028, 
   xrce104 LIKE xrce_t.xrce104, 
   xrce114 LIKE xrce_t.xrce114, 
   xrce124 LIKE xrce_t.xrce124, 
   xrce134 LIKE xrce_t.xrce134, 
   xrcecomp LIKE xrce_t.xrcecomp, 
   xrceorga LIKE xrce_t.xrceorga, 
   xrce010 LIKE xrce_t.xrce010, 
   xrce016 LIKE xrce_t.xrce016, 
   xrce016_desc_1 LIKE type_t.chr500, 
   xrde012 LIKE xrde_t.xrde012, 
   xrde012_u_desc LIKE type_t.chr500
       END RECORD
PRIVATE TYPE type_g_xrce2_d RECORD
       xrce001 LIKE xrce_t.xrce001, 
   xrcedocno LIKE xrce_t.xrcedocno, 
   xrceld LIKE xrce_t.xrceld, 
   xrcesite LIKE xrce_t.xrcesite, 
   xrceseq LIKE xrce_t.xrceseq, 
   xrce002 LIKE xrce_t.xrce002, 
   xrce006 LIKE xrce_t.xrce006, 
   xrce003 LIKE xrce_t.xrce003, 
   xrce004 LIKE xrce_t.xrce004, 
   xrce008 LIKE xrce_t.xrce008, 
   xrce100 LIKE xrce_t.xrce100, 
   xrce109 LIKE xrce_t.xrce109, 
   xrce101 LIKE xrce_t.xrce101, 
   xrce119 LIKE xrce_t.xrce119, 
   xrce120 LIKE xrce_t.xrce120, 
   xrce121 LIKE xrce_t.xrce121, 
   xrce129 LIKE xrce_t.xrce129, 
   xrce130 LIKE xrce_t.xrce130, 
   xrce131 LIKE xrce_t.xrce131, 
   xrce139 LIKE xrce_t.xrce139
       END RECORD
PRIVATE TYPE type_g_xrce3_d RECORD
       xrce001 LIKE xrce_t.xrce001, 
   xrcedocno LIKE xrce_t.xrcedocno, 
   xrceld LIKE xrce_t.xrceld, 
   xrcesite LIKE xrce_t.xrcesite, 
   xrceseq LIKE xrce_t.xrceseq, 
   xrce002 LIKE xrce_t.xrce002, 
   xrce006 LIKE xrce_t.xrce006, 
   xrce003 LIKE xrce_t.xrce003, 
   xrce004 LIKE xrce_t.xrce004, 
   xrce005 LIKE xrce_t.xrce005, 
   xrce008 LIKE xrce_t.xrce008, 
   xrce100 LIKE xrce_t.xrce100, 
   xrce109 LIKE xrce_t.xrce109, 
   xrce101 LIKE xrce_t.xrce101, 
   xrce119 LIKE xrce_t.xrce119, 
   xrce027 LIKE xrce_t.xrce027, 
   xrce010 LIKE xrce_t.xrce010, 
   xrce016 LIKE xrce_t.xrce016, 
   xrce016_u_desc LIKE type_t.chr500, 
   xrce017 LIKE xrce_t.xrce017, 
   xrce017_desc LIKE type_t.chr500, 
   xrce018 LIKE xrce_t.xrce018, 
   xrce018_u_desc LIKE type_t.chr500, 
   xrce019 LIKE xrce_t.xrce019, 
   xrce019_desc LIKE type_t.chr500, 
   xrce020 LIKE xrce_t.xrce020, 
   xrce020_desc LIKE type_t.chr500, 
   xrce022 LIKE xrce_t.xrce022, 
   xrce023 LIKE xrce_t.xrce023
       END RECORD
 
 
 
#模組變數(Module Variables)
DEFINE g_xrce_d          DYNAMIC ARRAY OF type_g_xrce_d #單身變數
DEFINE g_xrce_d_t        type_g_xrce_d                  #單身備份
DEFINE g_xrce_d_o        type_g_xrce_d                  #單身備份
DEFINE g_xrce_d_mask_o   DYNAMIC ARRAY OF type_g_xrce_d #單身變數
DEFINE g_xrce_d_mask_n   DYNAMIC ARRAY OF type_g_xrce_d #單身變數
DEFINE g_xrce2_d   DYNAMIC ARRAY OF type_g_xrce2_d
DEFINE g_xrce2_d_t type_g_xrce2_d
DEFINE g_xrce2_d_o type_g_xrce2_d
DEFINE g_xrce2_d_mask_o DYNAMIC ARRAY OF type_g_xrce2_d
DEFINE g_xrce2_d_mask_n DYNAMIC ARRAY OF type_g_xrce2_d
DEFINE g_xrce3_d   DYNAMIC ARRAY OF type_g_xrce3_d
DEFINE g_xrce3_d_t type_g_xrce3_d
DEFINE g_xrce3_d_o type_g_xrce3_d
DEFINE g_xrce3_d_mask_o DYNAMIC ARRAY OF type_g_xrce3_d
DEFINE g_xrce3_d_mask_n DYNAMIC ARRAY OF type_g_xrce3_d
 
      
DEFINE g_wc2                STRING
DEFINE g_sql                STRING
DEFINE g_forupd_sql         STRING                        #SELECT ... FOR UPDATE SQL
DEFINE g_before_input_done  LIKE type_t.num5
DEFINE g_cnt                LIKE type_t.num10    
DEFINE l_ac                 LIKE type_t.num10             #目前處理的ARRAY CNT 
DEFINE g_curr_diag          ui.Dialog                     #Current Dialog
DEFINE gwin_curr            ui.Window                     #Current Window
DEFINE gfrm_curr            ui.Form                       #Current Form
DEFINE g_temp_idx           LIKE type_t.num10             #單身 所在筆數(暫存用)
DEFINE g_detail_idx         LIKE type_t.num10             #單身 所在筆數(所有資料)
DEFINE g_detail_cnt         LIKE type_t.num10             #單身 總筆數(所有資料)
DEFINE g_ref_fields         DYNAMIC ARRAY OF VARCHAR(500) #ap_ref用陣列
DEFINE g_rtn_fields         DYNAMIC ARRAY OF VARCHAR(500) #ap_ref用陣列
DEFINE g_ref_vars           DYNAMIC ARRAY OF VARCHAR(500) #ap_ref用陣列
DEFINE gs_keys              DYNAMIC ARRAY OF VARCHAR(500) #同步資料用陣列
DEFINE gs_keys_bak          DYNAMIC ARRAY OF VARCHAR(500) #同步資料用陣列
DEFINE g_insert             LIKE type_t.chr5              #是否導到其他page
DEFINE g_error_show         LIKE type_t.num5
DEFINE g_chk                BOOLEAN
DEFINE g_aw                 STRING                        #確定當下點擊的單身
DEFINE g_log1               STRING                        #log用
DEFINE g_log2               STRING                        #log用
 
#多table用wc
DEFINE g_wc_table           STRING
 
 
#add-point:自定義模組變數(Module Variable)
{<point name="global.variable" edit="s"/>}
#end add-point
 
#add-point:自定義客戶專用模組變數(Module Variable)
{<point name="global.variable_customerization" edit="c"/>}
#end add-point
 
#add-point:傳入參數說明(global.argv)
{<point name="global.argv"/>}
#end add-point
]]>
  </section>
  <section id="axrt300_02.init" ver="3" status="" src="s" readonly="">
    <![CDATA[#+ 畫面資料初始化
PRIVATE FUNCTION axrt300_02_init()
   #add-point:init段define
   {<point name="init.define" edit="s"/>}
   #end add-point   
   #add-point:init段define(客製用)
   {<point name="init.define_customerization" edit="c"/>}
   #end add-point
   
   
      CALL cl_set_combo_scc('xrce006','8310') 
 
   LET g_error_show = 1
   
   #add-point:畫面資料初始化
   {<point name="init.init" />}
   #end add-point
   
   CALL axrt300_02_default_search()
   
END FUNCTION
]]>
  </section>
  <section id="axrt300_02.insert" ver="7" status="" src="s" readonly="">
    <![CDATA[#+ 資料新增
PRIVATE FUNCTION axrt300_02_insert()
   #add-point:delete段define
   {<point name="insert.define" edit="s"/>}
   #end add-point                
   #add-point:insert段define(客製用)
   {<point name="insert.define_customerization" edit="c"/>}
   #end add-point
   
   #add-point:單身新增前
   {<point name="insert.b_insert"/>}
   #end add-point
   
   LET g_insert = 'Y'
   CALL axrt300_02_modify()
            
   #add-point:單身新增後
   {<point name="insert.a_insert"/>}
   #end add-point
 
END FUNCTION
]]>
  </section>
  <section id="axrt300_02.insert_b" ver="11" status="" src="s" readonly="">
    <![CDATA[#+ 新增單身後其他table連動
PRIVATE FUNCTION axrt300_02_insert_b(ps_table,ps_keys,ps_page)
   DEFINE ps_table    STRING
   DEFINE ps_page     STRING
   DEFINE ps_keys     DYNAMIC ARRAY OF VARCHAR(500)
   DEFINE ls_group    STRING
   #add-point:insert_b段define
   {<point name="insert_b.define" edit="s"/>}
   #end add-point     
   #add-point:insert_b段define(客製用)
   {<point name="insert_b.define_customerization" edit="c"/>}
   #end add-point
   
   #判斷是否是同一群組的table
   LET ls_group = "xrce_t,"
   #IF ls_group.getIndexOf(ps_table,1) > 0 THEN
      
      #add-point:insert_b段新增前
      {<point name="insert_b.b_insert" mark="Y"/>}
      #end add-point    
      INSERT INTO xrce_t
                  (xrceent,
                   xrceld,xrcedocno,xrceseq
                   ,xrce001,xrcesite,xrce002,xrce006,xrce003,xrce004,xrce005,xrce024,xrce025,xrce008,xrce015,xrce100,xrce101,xrce109,xrce119,xrce027,xrce028,xrce104,xrce114,xrce124,xrce134,xrcecomp,xrceorga,xrce010,xrce016,xrce001,xrcesite,xrce002,xrce006,xrce003,xrce004,xrce008,xrce100,xrce109,xrce101,xrce119,xrce120,xrce121,xrce129,xrce130,xrce131,xrce139,xrce001,xrcesite,xrce002,xrce006,xrce003,xrce004,xrce005,xrce008,xrce100,xrce109,xrce101,xrce119,xrce027,xrce010,xrce016,xrce017,xrce018,xrce019,xrce020,xrce022,xrce023) 
            VALUES(g_enterprise,
                   ps_keys[1],ps_keys[2],ps_keys[3]
                   ,g_xrce_d[l_ac].xrce001,g_xrce_d[l_ac].xrcesite,g_xrce_d[l_ac].xrce002,g_xrce_d[l_ac].xrce006, 
                       g_xrce_d[l_ac].xrce003,g_xrce_d[l_ac].xrce004,g_xrce_d[l_ac].xrce005,g_xrce_d[l_ac].xrce024, 
                       g_xrce_d[l_ac].xrce025,g_xrce_d[l_ac].xrce008,g_xrce_d[l_ac].xrce015,g_xrce_d[l_ac].xrce100, 
                       g_xrce_d[l_ac].xrce101,g_xrce_d[l_ac].xrce109,g_xrce_d[l_ac].xrce119,g_xrce_d[l_ac].xrce027, 
                       g_xrce_d[l_ac].xrce028,g_xrce_d[l_ac].xrce104,g_xrce_d[l_ac].xrce114,g_xrce_d[l_ac].xrce124, 
                       g_xrce_d[l_ac].xrce134,g_xrce_d[l_ac].xrcecomp,g_xrce_d[l_ac].xrceorga,g_xrce_d[l_ac].xrce010, 
                       g_xrce_d[l_ac].xrce016,g_xrce_d[l_ac].xrce001,g_xrce_d[l_ac].xrcesite,g_xrce_d[l_ac].xrce002, 
                       g_xrce_d[l_ac].xrce006,g_xrce_d[l_ac].xrce003,g_xrce_d[l_ac].xrce004,g_xrce_d[l_ac].xrce008, 
                       g_xrce_d[l_ac].xrce100,g_xrce_d[l_ac].xrce109,g_xrce_d[l_ac].xrce101,g_xrce_d[l_ac].xrce119, 
                       g_xrce2_d[l_ac].xrce120,g_xrce2_d[l_ac].xrce121,g_xrce2_d[l_ac].xrce129,g_xrce2_d[l_ac].xrce130, 
                       g_xrce2_d[l_ac].xrce131,g_xrce2_d[l_ac].xrce139,g_xrce_d[l_ac].xrce001,g_xrce_d[l_ac].xrcesite, 
                       g_xrce_d[l_ac].xrce002,g_xrce_d[l_ac].xrce006,g_xrce_d[l_ac].xrce003,g_xrce_d[l_ac].xrce004, 
                       g_xrce_d[l_ac].xrce005,g_xrce_d[l_ac].xrce008,g_xrce_d[l_ac].xrce100,g_xrce_d[l_ac].xrce109, 
                       g_xrce_d[l_ac].xrce101,g_xrce_d[l_ac].xrce119,g_xrce_d[l_ac].xrce027,g_xrce_d[l_ac].xrce010, 
                       g_xrce_d[l_ac].xrce016,g_xrce3_d[l_ac].xrce017,g_xrce3_d[l_ac].xrce018,g_xrce3_d[l_ac].xrce019, 
                       g_xrce3_d[l_ac].xrce020,g_xrce3_d[l_ac].xrce022,g_xrce3_d[l_ac].xrce023)
      #add-point:insert_b段新增中
      {<point name="insert_b.m_insert"/>}
      #end add-point    
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = "xrce_t" 
         LET g_errparam.code   = SQLCA.sqlcode 
         LET g_errparam.popup  = FALSE 
         CALL cl_err()
      END IF
      #add-point:insert_b段新增後
      {<point name="insert_b.a_insert"/>}
      #end add-point    
   #END IF
   
 
   
END FUNCTION
]]>
  </section>
  <section id="axrt300_02.lock_b" ver="6" status="" src="s" readonly="">
    <![CDATA[#+ 連動lock其他單身table資料
PRIVATE FUNCTION axrt300_02_lock_b(ps_table)
   DEFINE ps_table STRING
   DEFINE ls_group STRING
   #add-point:lock_b段define
   {<point name="lock_b.define" edit="s"/>}
   #end add-point   
   #add-point:lock_b段define(客製用)
   {<point name="lock_b.define_customerization" edit="c"/>}
   #end add-point
   
   #先刷新資料
   #CALL axrt300_02_b_fill(g_wc2)
   
   #鎖定整組table
   #LET ls_group = ""
   #僅鎖定自身table
   LET ls_group = "xrce_t"
   
   IF ls_group.getIndexOf(ps_table,1) THEN
   
      OPEN axrt300_02_bcl USING g_enterprise,
                                       g_xrce_d[g_detail_idx].xrceld,g_xrce_d[g_detail_idx].xrcedocno, 
                                           g_xrce_d[g_detail_idx].xrceseq
                                       
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = "axrt300_02_bcl" 
         LET g_errparam.code   = SQLCA.sqlcode 
         LET g_errparam.popup  = TRUE 
         CALL cl_err()
         RETURN FALSE
      END IF
   
   END IF
                                    
 
   
   RETURN TRUE
 
END FUNCTION
]]>
  </section>
  <section id="axrt300_02.main" ver="15" status="" src="s" readonly="">
    <![CDATA[#應用 a27 樣板自動產生(Version:4)
#+ 作業開始(子程式類型)
PUBLIC FUNCTION axrt300_02(--)
   #add-point:main段變數傳入
   {<point name="main.get_var"/>}
   #end add-point
   )
   #add-point:main段define
   {<point name="main.define" edit="s"/>}
   #end add-point   
   #add-point:main段define(客製用)
   {<point name="main.define_customerization" edit="c"/>}
   #end add-point   
   
   #設定SQL錯誤記錄方式 (模組內定義有效)
   WHENEVER ERROR CALL cl_err_msg_log
 
   #add-point:作業初始化
   {<point name="main.init" />}
   #end add-point
   
   
 
   #LOCK CURSOR (identifier)
 
   
   #add-point:main段define_sql
   {<point name="main.body.define_sql" mark="Y"/>}
   #end add-point 
   LET g_forupd_sql = "SELECT xrce001,xrcedocno,xrceld,xrcesite,xrceseq,xrce002,xrce006,xrce003,xrce004, 
       xrce005,xrce024,xrce025,xrce008,xrce015,xrce100,xrce101,xrce109,xrce119,xrce027,xrce028,xrce104, 
       xrce114,xrce124,xrce134,xrcecomp,xrceorga,xrce010,xrce016,xrce001,xrcedocno,xrceld,xrcesite,xrceseq, 
       xrce002,xrce006,xrce003,xrce004,xrce008,xrce100,xrce109,xrce101,xrce119,xrce120,xrce121,xrce129, 
       xrce130,xrce131,xrce139,xrce001,xrcedocno,xrceld,xrcesite,xrceseq,xrce002,xrce006,xrce003,xrce004, 
       xrce005,xrce008,xrce100,xrce109,xrce101,xrce119,xrce027,xrce010,xrce016,xrce017,xrce018,xrce019, 
       xrce020,xrce022,xrce023 FROM xrce_t WHERE xrceent=? AND xrceld=? AND xrcedocno=? AND xrceseq=?  
       FOR UPDATE"
   #add-point:main段define_sql
   {<point name="main.body.after_define_sql"/>}
   #end add-point 
   LET g_forupd_sql = cl_sql_forupd(g_forupd_sql)
   LET g_forupd_sql = cl_sql_add_mask(g_forupd_sql)              #遮蔽特定資料
   DECLARE axrt300_02_bcl CURSOR FROM g_forupd_sql
 
 
   
   #畫面開啟 (identifier)
   OPEN WINDOW w_axrt300_02 WITH FORM cl_ap_formpath("axr","axrt300_02")
   
   #瀏覽頁簽資料初始化
   CALL cl_ui_init()
   
   #程式初始化
   CALL axrt300_02_init()   
 
   #進入選單 Menu (="N")
   CALL axrt300_02_ui_dialog() 
 
   #畫面關閉
   CLOSE WINDOW w_axrt300_02
 
   
   
 
   #add-point:離開前
   {<point name="main.exit" />}
   #end add-point
END FUNCTION
 
 
]]>
  </section>
  <section id="axrt300_02.mask_functions" ver="1" status="" src="s" readonly="">
    <![CDATA[&include "erp/axr/axrt300_02_mask.4gl"
]]>
  </section>
  <section id="axrt300_02.modify" ver="42" status="" src="s" readonly="">
    <![CDATA[#+ 資料修改
PRIVATE FUNCTION axrt300_02_modify()
   DEFINE  l_cmd                  LIKE type_t.chr1
   DEFINE  l_ac_t                 LIKE type_t.num10               #未取消的ARRAY CNT 
   DEFINE  l_n                    LIKE type_t.num10               #檢查重複用  
   DEFINE  l_cnt                  LIKE type_t.num10               #檢查重複用  
   DEFINE  l_lock_sw              LIKE type_t.chr1                #單身鎖住否  
   DEFINE  l_allow_insert         LIKE type_t.num5                #可新增否 
   DEFINE  l_allow_delete         LIKE type_t.num5                #可刪除否  
   DEFINE  l_count                LIKE type_t.num10
   DEFINE  l_i                    LIKE type_t.num10
   DEFINE  ls_return              STRING
   DEFINE  l_var_keys             DYNAMIC ARRAY OF STRING
   DEFINE  l_field_keys           DYNAMIC ARRAY OF STRING
   DEFINE  l_vars                 DYNAMIC ARRAY OF STRING
   DEFINE  l_fields               DYNAMIC ARRAY OF STRING
   DEFINE  l_var_keys_bak         DYNAMIC ARRAY OF STRING
   DEFINE  li_reproduce           LIKE type_t.num10
   DEFINE  li_reproduce_target    LIKE type_t.num10
   DEFINE  lb_reproduce           BOOLEAN
   #add-point:modify段define
   {<point name="modify.define" edit="s"/>}
   #end add-point 
   #add-point:modify段define(客製用)
   {<point name="modify.define_customerization" edit="c"/>}
   #end add-point
   LET g_action_choice = ""
   
   LET g_qryparam.state = "i"
 
   LET l_allow_insert = cl_auth_detail_input("insert")
   LET l_allow_delete = cl_auth_detail_input("delete")
   
   #add-point:modify開始前
   {<point name="modify.define_sql" mark="Y"/>}
   #end add-point
   
   LET INT_FLAG = FALSE
   LET lb_reproduce = FALSE
 
   #關閉被遮罩相關欄位輸入, 無法確定USER是否會需要輸入此欄位
   #因此先行關閉, 若有需要可於下方add-point中自行開啟
   CALL cl_mask_set_no_entry()
 
   #add-point:modify段修改前
   {<point name="modify.before_input"/>}
   #end add-point
 
   DIALOG ATTRIBUTES(UNBUFFERED,FIELD ORDER FORM)
 
      #Page1 預設值產生於此處
      INPUT ARRAY g_xrce_d FROM s_detail1.*
          ATTRIBUTE(COUNT = g_detail_cnt,WITHOUT DEFAULTS, #MAXCOUNT = g_max_rec,
                  INSERT ROW = l_allow_insert, 
                  DELETE ROW = l_allow_delete,
                  APPEND ROW = l_allow_insert)
 
         #自訂ACTION(detail_input,page_1)
         
         
         BEFORE INPUT
            IF g_insert = 'Y' AND NOT cl_null(g_insert) THEN 
              CALL FGL_SET_ARR_CURR(g_xrce_d.getLength()+1) 
              LET g_insert = 'N' 
           END IF 
 
            CALL axrt300_02_b_fill(g_wc2)
            LET g_detail_cnt = g_xrce_d.getLength()
         
         BEFORE ROW
            #add-point:modify段before row
            {<point name="input.body.before_row2"/>}
            #end add-point  
            LET g_detail_idx = DIALOG.getCurrentRow("s_detail1")
            LET l_cmd = ''
            LET l_ac = g_detail_idx
            LET l_lock_sw = 'N'            #DEFAULT
            LET l_n = ARR_COUNT()
            DISPLAY l_ac TO FORMONLY.idx
            DISPLAY g_xrce_d.getLength() TO FORMONLY.cnt
         
            CALL s_transaction_begin()
            LET g_detail_cnt = g_xrce_d.getLength()
            
            IF g_detail_cnt >= l_ac 
               AND g_xrce_d[l_ac].xrceld IS NOT NULL
               AND g_xrce_d[l_ac].xrcedocno IS NOT NULL
               AND g_xrce_d[l_ac].xrceseq IS NOT NULL
 
            THEN
               LET l_cmd='u'
               LET g_xrce_d_t.* = g_xrce_d[l_ac].*  #BACKUP
               LET g_xrce_d_o.* = g_xrce_d[l_ac].*  #BACKUP
               IF NOT axrt300_02_lock_b("xrce_t") THEN
                  LET l_lock_sw='Y'
               ELSE
                  FETCH axrt300_02_bcl INTO g_xrce_d[l_ac].xrce001,g_xrce_d[l_ac].xrcedocno,g_xrce_d[l_ac].xrceld, 
                      g_xrce_d[l_ac].xrcesite,g_xrce_d[l_ac].xrceseq,g_xrce_d[l_ac].xrce002,g_xrce_d[l_ac].xrce006, 
                      g_xrce_d[l_ac].xrce003,g_xrce_d[l_ac].xrce004,g_xrce_d[l_ac].xrce005,g_xrce_d[l_ac].xrce024, 
                      g_xrce_d[l_ac].xrce025,g_xrce_d[l_ac].xrce008,g_xrce_d[l_ac].xrce015,g_xrce_d[l_ac].xrce100, 
                      g_xrce_d[l_ac].xrce101,g_xrce_d[l_ac].xrce109,g_xrce_d[l_ac].xrce119,g_xrce_d[l_ac].xrce027, 
                      g_xrce_d[l_ac].xrce028,g_xrce_d[l_ac].xrce104,g_xrce_d[l_ac].xrce114,g_xrce_d[l_ac].xrce124, 
                      g_xrce_d[l_ac].xrce134,g_xrce_d[l_ac].xrcecomp,g_xrce_d[l_ac].xrceorga,g_xrce_d[l_ac].xrce010, 
                      g_xrce_d[l_ac].xrce016,g_xrce2_d[l_ac].xrce001,g_xrce2_d[l_ac].xrcedocno,g_xrce2_d[l_ac].xrceld, 
                      g_xrce2_d[l_ac].xrcesite,g_xrce2_d[l_ac].xrceseq,g_xrce2_d[l_ac].xrce002,g_xrce2_d[l_ac].xrce006, 
                      g_xrce2_d[l_ac].xrce003,g_xrce2_d[l_ac].xrce004,g_xrce2_d[l_ac].xrce008,g_xrce2_d[l_ac].xrce100, 
                      g_xrce2_d[l_ac].xrce109,g_xrce2_d[l_ac].xrce101,g_xrce2_d[l_ac].xrce119,g_xrce2_d[l_ac].xrce120, 
                      g_xrce2_d[l_ac].xrce121,g_xrce2_d[l_ac].xrce129,g_xrce2_d[l_ac].xrce130,g_xrce2_d[l_ac].xrce131, 
                      g_xrce2_d[l_ac].xrce139,g_xrce3_d[l_ac].xrce001,g_xrce3_d[l_ac].xrcedocno,g_xrce3_d[l_ac].xrceld, 
                      g_xrce3_d[l_ac].xrcesite,g_xrce3_d[l_ac].xrceseq,g_xrce3_d[l_ac].xrce002,g_xrce3_d[l_ac].xrce006, 
                      g_xrce3_d[l_ac].xrce003,g_xrce3_d[l_ac].xrce004,g_xrce3_d[l_ac].xrce005,g_xrce3_d[l_ac].xrce008, 
                      g_xrce3_d[l_ac].xrce100,g_xrce3_d[l_ac].xrce109,g_xrce3_d[l_ac].xrce101,g_xrce3_d[l_ac].xrce119, 
                      g_xrce3_d[l_ac].xrce027,g_xrce3_d[l_ac].xrce010,g_xrce3_d[l_ac].xrce016,g_xrce3_d[l_ac].xrce017, 
                      g_xrce3_d[l_ac].xrce018,g_xrce3_d[l_ac].xrce019,g_xrce3_d[l_ac].xrce020,g_xrce3_d[l_ac].xrce022, 
                      g_xrce3_d[l_ac].xrce023
                  IF SQLCA.sqlcode THEN
                     INITIALIZE g_errparam TO NULL 
                     LET g_errparam.extend = g_xrce_d_t.xrceld 
                     LET g_errparam.code   = SQLCA.sqlcode 
                     LET g_errparam.popup  = TRUE 
                     CALL cl_err()
                     LET l_lock_sw = "Y"
                  END IF
                  
                  #遮罩相關處理
                  LET g_xrce_d_mask_o[l_ac].* =  g_xrce_d[l_ac].*
                  CALL axrt300_02_xrce_t_mask()
                  LET g_xrce_d_mask_n[l_ac].* =  g_xrce_d[l_ac].*
                  
                  CALL axrt300_02_detail_show()
                  CALL cl_show_fld_cont()
               END IF
            ELSE
               LET l_cmd='a'
            END IF
            #add-point:modify段before row
            {<point name="input.body.before_row"/>}
            #end add-point  
            #其他table資料備份(確定是否更改用)
            
            #其他table進行lock
            
        
         BEFORE INSERT
            
            CALL s_transaction_begin()
            LET l_n = ARR_COUNT()
            LET l_cmd = 'a'
            INITIALIZE g_xrce_d_t.* TO NULL
            INITIALIZE g_xrce_d_o.* TO NULL
            INITIALIZE g_xrce_d[l_ac].* TO NULL 
            #公用欄位給值(單身)
            
            #自定義預設值(單身3)
                  LET g_xrce_d[l_ac].xrce027 = "N"
 
            #add-point:modify段before備份
            {<point name="input.body.before_bak"/>}
            #end add-point
            LET g_xrce_d_t.* = g_xrce_d[l_ac].*     #新輸入資料
            LET g_xrce_d_o.* = g_xrce_d[l_ac].*     #新輸入資料
            CALL cl_show_fld_cont()
            CALL axrt300_02_set_entry_b("a")
            CALL axrt300_02_set_no_entry_b("a")
            IF lb_reproduce THEN
               LET lb_reproduce = FALSE
               LET g_xrce_d[li_reproduce_target].* = g_xrce_d[li_reproduce].*
               LET g_xrce2_d[li_reproduce_target].* = g_xrce2_d[li_reproduce].*
               LET g_xrce3_d[li_reproduce_target].* = g_xrce3_d[li_reproduce].*
 
               LET g_xrce_d[g_xrce_d.getLength()].xrceld = NULL
               LET g_xrce_d[g_xrce_d.getLength()].xrcedocno = NULL
               LET g_xrce_d[g_xrce_d.getLength()].xrceseq = NULL
 
            END IF
            
            #add-point:modify段before insert
            {<point name="input.body.before_insert"/>}
            #end add-point  
  
         AFTER INSERT
            IF INT_FLAG THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = '' 
               LET g_errparam.code   = 9001 
               LET g_errparam.popup  = FALSE 
               CALL cl_err()
               LET INT_FLAG = 0
               CANCEL INSERT
            END IF
               
            LET l_count = 1  
            SELECT COUNT(*) INTO l_count FROM xrce_t 
             WHERE xrceent = g_enterprise AND xrceld = g_xrce_d[l_ac].xrceld
                                       AND xrcedocno = g_xrce_d[l_ac].xrcedocno
                                       AND xrceseq = g_xrce_d[l_ac].xrceseq
 
                
            #資料未重複, 插入新增資料
            IF l_count = 0 THEN 
               #add-point:單身新增前
               {<point name="input.body.b_insert"/>}
               #end add-point
            
                              INITIALIZE gs_keys TO NULL 
               LET gs_keys[1] = g_xrce_d[g_detail_idx].xrceld
               LET gs_keys[2] = g_xrce_d[g_detail_idx].xrcedocno
               LET gs_keys[3] = g_xrce_d[g_detail_idx].xrceseq
               CALL axrt300_02_insert_b('xrce_t',gs_keys,"'1'")
                           
               #add-point:單身新增後
               {<point name="input.body.a_insert"/>}
               #end add-point
            ELSE    
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = 'INSERT' 
               LET g_errparam.code   = "std-00006" 
               LET g_errparam.popup  = TRUE 
               CALL cl_err()
               INITIALIZE g_xrce_d[l_ac].* TO NULL
               CANCEL INSERT
            END IF
 
            IF SQLCA.SQLcode  THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = "xrce_t" 
               LET g_errparam.code   = SQLCA.sqlcode 
               LET g_errparam.popup  = TRUE 
               CALL cl_err()
               CANCEL INSERT
            ELSE
               #先刷新資料
               #CALL axrt300_02_b_fill(g_wc2)
               #資料多語言用-增/改
               
               #add-point:input段-after_insert
               {<point name="input.body.a_insert2"/>}
               #end add-point
               ##ERROR 'INSERT O.K'
               LET g_detail_cnt = g_detail_cnt + 1
               
               LET g_wc2 = g_wc2, " OR (xrceld = '", g_xrce_d[l_ac].xrceld, "' "
                                  ," AND xrcedocno = '", g_xrce_d[l_ac].xrcedocno, "' "
                                  ," AND xrceseq = '", g_xrce_d[l_ac].xrceseq, "' "
 
                                  ,")"
            END IF                
              
         BEFORE DELETE                            #是否取消單身
            IF l_cmd = 'a' THEN
               LET l_cmd='d'
            ELSE
               #add-point:單身刪除ask前
               {<point name="input.body.b_delete_ask"/>}
               #end add-point   
               
               IF NOT cl_ask_del_detail() THEN
                  CANCEL DELETE
               END IF
               IF l_lock_sw = "Y" THEN
                  INITIALIZE g_errparam TO NULL 
                  LET g_errparam.extend = "" 
                  LET g_errparam.code   = -263 
                  LET g_errparam.popup  = TRUE 
                  CALL cl_err()
                  CANCEL DELETE
               END IF
               
               #add-point:單身刪除前
               {<point name="input.body.b_delete" mark="Y"/>}
               #end add-point   
               
               DELETE FROM xrce_t
                WHERE xrceent = g_enterprise AND 
                      xrceld = g_xrce_d_t.xrceld
                      AND xrcedocno = g_xrce_d_t.xrcedocno
                      AND xrceseq = g_xrce_d_t.xrceseq
 
                      
               #add-point:單身刪除中
               {<point name="input.body.m_delete"/>}
               #end add-point  
                      
               IF SQLCA.sqlcode THEN
                  INITIALIZE g_errparam TO NULL 
                  LET g_errparam.extend = "xrce_t" 
                  LET g_errparam.code   = SQLCA.sqlcode 
                  LET g_errparam.popup  = TRUE 
                  CALL cl_err()
                  CANCEL DELETE   
               ELSE
                  LET g_detail_cnt = g_detail_cnt-1
                  
                  #add-point:單身刪除後
                  {<point name="input.body.a_delete"/>}
                  #end add-point
                  #修改歷程記錄(刪除)
                  CALL axrt300_02_set_pk_array()
                  IF NOT cl_log_modified_record('','') THEN 
                  ELSE
                  END IF
               END IF 
               CLOSE axrt300_02_bcl
               #add-point:單身關閉bcl
               {<point name="input.body.close"/>}
               #end add-point
               LET l_count = g_xrce_d.getLength()
                              INITIALIZE gs_keys TO NULL 
               LET gs_keys[1] = g_xrce_d_t.xrceld
               LET gs_keys[2] = g_xrce_d_t.xrcedocno
               LET gs_keys[3] = g_xrce_d_t.xrceseq
 
               #應用 a47 樣板自動產生(Version:2)
      #刪除相關文件
      CALL axrt300_02_set_pk_array()
      #add-point:相關文件刪除前
      {<point name="delete.befroe.related_document_remove"/>}
      #end add-point   
      CALL cl_doc_remove()  
 
 
 
            END IF 
              
         AFTER DELETE 
            IF l_cmd <> 'd' THEN
               #add-point:單身刪除後2
               {<point name="input.body.after_delete"/>}
               #end add-point
                              CALL axrt300_02_delete_b('xrce_t',gs_keys,"'1'")
            END IF
            #如果是最後一筆
            IF l_ac = (g_xrce_d.getLength() + 1) THEN
               CALL FGL_SET_ARR_CURR(l_ac-1)
            END IF
 
                  #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce001
            #add-point:BEFORE FIELD xrce001
            {<point name="input.b.page1.xrce001" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce001
            
            #add-point:AFTER FIELD xrce001
            {<point name="input.a.page1.xrce001" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xrce001
            #add-point:ON CHANGE xrce001
            {<point name="input.g.page1.xrce001" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrcedocno
            #add-point:BEFORE FIELD xrcedocno
            {<point name="input.b.page1.xrcedocno" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrcedocno
            
            #add-point:AFTER FIELD xrcedocno
            {<point name="input.a.page1.xrcedocno" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xrcedocno
            #add-point:ON CHANGE xrcedocno
            {<point name="input.g.page1.xrcedocno" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrceld
            #add-point:BEFORE FIELD xrceld
            {<point name="input.b.page1.xrceld" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrceld
            
            #add-point:AFTER FIELD xrceld
            {<point name="input.a.page1.xrceld" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xrceld
            #add-point:ON CHANGE xrceld
            {<point name="input.g.page1.xrceld" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrcesite
            #add-point:BEFORE FIELD xrcesite
            {<point name="input.b.page1.xrcesite" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrcesite
            
            #add-point:AFTER FIELD xrcesite
            {<point name="input.a.page1.xrcesite" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xrcesite
            #add-point:ON CHANGE xrcesite
            {<point name="input.g.page1.xrcesite" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrceseq
            #add-point:BEFORE FIELD xrceseq
            {<point name="input.b.page1.xrceseq" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrceseq
            
            #add-point:AFTER FIELD xrceseq
            {<point name="input.a.page1.xrceseq" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xrceseq
            #add-point:ON CHANGE xrceseq
            {<point name="input.g.page1.xrceseq" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce002
            #add-point:BEFORE FIELD xrce002
            {<point name="input.b.page1.xrce002" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce002
            
            #add-point:AFTER FIELD xrce002
            {<point name="input.a.page1.xrce002" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xrce002
            #add-point:ON CHANGE xrce002
            {<point name="input.g.page1.xrce002" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce006
            #add-point:BEFORE FIELD xrce006
            {<point name="input.b.page1.xrce006" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce006
            
            #add-point:AFTER FIELD xrce006
            {<point name="input.a.page1.xrce006" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xrce006
            #add-point:ON CHANGE xrce006
            {<point name="input.g.page1.xrce006" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce003
            #add-point:BEFORE FIELD xrce003
            {<point name="input.b.page1.xrce003" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce003
            
            #add-point:AFTER FIELD xrce003
            {<point name="input.a.page1.xrce003" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xrce003
            #add-point:ON CHANGE xrce003
            {<point name="input.g.page1.xrce003" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce004
            #add-point:BEFORE FIELD xrce004
            {<point name="input.b.page1.xrce004" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce004
            
            #add-point:AFTER FIELD xrce004
            {<point name="input.a.page1.xrce004" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xrce004
            #add-point:ON CHANGE xrce004
            {<point name="input.g.page1.xrce004" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce005
            #add-point:BEFORE FIELD xrce005
            {<point name="input.b.page1.xrce005" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce005
            
            #add-point:AFTER FIELD xrce005
            {<point name="input.a.page1.xrce005" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xrce005
            #add-point:ON CHANGE xrce005
            {<point name="input.g.page1.xrce005" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce024
            #add-point:BEFORE FIELD xrce024
            {<point name="input.b.page1.xrce024" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce024
            
            #add-point:AFTER FIELD xrce024
            {<point name="input.a.page1.xrce024" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xrce024
            #add-point:ON CHANGE xrce024
            {<point name="input.g.page1.xrce024" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce025
            #add-point:BEFORE FIELD xrce025
            {<point name="input.b.page1.xrce025" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce025
            
            #add-point:AFTER FIELD xrce025
            {<point name="input.a.page1.xrce025" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xrce025
            #add-point:ON CHANGE xrce025
            {<point name="input.g.page1.xrce025" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce008
            #add-point:BEFORE FIELD xrce008
            {<point name="input.b.page1.xrce008" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce008
            
            #add-point:AFTER FIELD xrce008
            {<point name="input.a.page1.xrce008" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xrce008
            #add-point:ON CHANGE xrce008
            {<point name="input.g.page1.xrce008" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce015
            #add-point:BEFORE FIELD xrce015
            {<point name="input.b.page1.xrce015" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce015
            
            #add-point:AFTER FIELD xrce015
            {<point name="input.a.page1.xrce015" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xrce015
            #add-point:ON CHANGE xrce015
            {<point name="input.g.page1.xrce015" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce100
            #add-point:BEFORE FIELD xrce100
            {<point name="input.b.page1.xrce100" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce100
            
            #add-point:AFTER FIELD xrce100
            {<point name="input.a.page1.xrce100" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xrce100
            #add-point:ON CHANGE xrce100
            {<point name="input.g.page1.xrce100" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce101
            #add-point:BEFORE FIELD xrce101
            {<point name="input.b.page1.xrce101" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce101
            
            #add-point:AFTER FIELD xrce101
            {<point name="input.a.page1.xrce101" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xrce101
            #add-point:ON CHANGE xrce101
            {<point name="input.g.page1.xrce101" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce109
            #add-point:BEFORE FIELD xrce109
            {<point name="input.b.page1.xrce109" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce109
            
            #add-point:AFTER FIELD xrce109
            {<point name="input.a.page1.xrce109" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xrce109
            #add-point:ON CHANGE xrce109
            {<point name="input.g.page1.xrce109" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce119
            #add-point:BEFORE FIELD xrce119
            {<point name="input.b.page1.xrce119" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce119
            
            #add-point:AFTER FIELD xrce119
            {<point name="input.a.page1.xrce119" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xrce119
            #add-point:ON CHANGE xrce119
            {<point name="input.g.page1.xrce119" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce027
            #add-point:BEFORE FIELD xrce027
            {<point name="input.b.page1.xrce027" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce027
            
            #add-point:AFTER FIELD xrce027
            {<point name="input.a.page1.xrce027" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xrce027
            #add-point:ON CHANGE xrce027
            {<point name="input.g.page1.xrce027" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce028
            #add-point:BEFORE FIELD xrce028
            {<point name="input.b.page1.xrce028" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce028
            
            #add-point:AFTER FIELD xrce028
            {<point name="input.a.page1.xrce028" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xrce028
            #add-point:ON CHANGE xrce028
            {<point name="input.g.page1.xrce028" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce104
            #add-point:BEFORE FIELD xrce104
            {<point name="input.b.page1.xrce104" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce104
            
            #add-point:AFTER FIELD xrce104
            {<point name="input.a.page1.xrce104" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xrce104
            #add-point:ON CHANGE xrce104
            {<point name="input.g.page1.xrce104" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce114
            #add-point:BEFORE FIELD xrce114
            {<point name="input.b.page1.xrce114" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce114
            
            #add-point:AFTER FIELD xrce114
            {<point name="input.a.page1.xrce114" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xrce114
            #add-point:ON CHANGE xrce114
            {<point name="input.g.page1.xrce114" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce124
            #add-point:BEFORE FIELD xrce124
            {<point name="input.b.page1.xrce124" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce124
            
            #add-point:AFTER FIELD xrce124
            {<point name="input.a.page1.xrce124" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xrce124
            #add-point:ON CHANGE xrce124
            {<point name="input.g.page1.xrce124" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce134
            #add-point:BEFORE FIELD xrce134
            {<point name="input.b.page1.xrce134" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce134
            
            #add-point:AFTER FIELD xrce134
            {<point name="input.a.page1.xrce134" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xrce134
            #add-point:ON CHANGE xrce134
            {<point name="input.g.page1.xrce134" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrcecomp
            #add-point:BEFORE FIELD xrcecomp
            {<point name="input.b.page1.xrcecomp" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrcecomp
            
            #add-point:AFTER FIELD xrcecomp
            {<point name="input.a.page1.xrcecomp" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xrcecomp
            #add-point:ON CHANGE xrcecomp
            {<point name="input.g.page1.xrcecomp" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrceorga
            #add-point:BEFORE FIELD xrceorga
            {<point name="input.b.page1.xrceorga" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrceorga
            
            #add-point:AFTER FIELD xrceorga
            {<point name="input.a.page1.xrceorga" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xrceorga
            #add-point:ON CHANGE xrceorga
            {<point name="input.g.page1.xrceorga" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce010
            #add-point:BEFORE FIELD xrce010
            {<point name="input.b.page1.xrce010" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce010
            
            #add-point:AFTER FIELD xrce010
            {<point name="input.a.page1.xrce010" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xrce010
            #add-point:ON CHANGE xrce010
            {<point name="input.g.page1.xrce010" />}
            #END add-point 
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce016
            
            #add-point:AFTER FIELD xrce016
            {<point name="input.a.page1.xrce016" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce016
            #add-point:BEFORE FIELD xrce016
            {<point name="input.b.page1.xrce016" />}
            #END add-point
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xrce016
            #add-point:ON CHANGE xrce016
            {<point name="input.g.page1.xrce016" />}
            #END add-point 
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrde012_u
            
            #add-point:AFTER FIELD xrde012_u
            {<point name="input.a.page1.xrde012_u" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrde012_u
            #add-point:BEFORE FIELD xrde012_u
            {<point name="input.b.page1.xrde012_u" />}
            #END add-point
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xrde012_u
            #add-point:ON CHANGE xrde012_u
            {<point name="input.g.page1.xrde012_u" />}
            #END add-point 
 
 
                  #Ctrlp:input.c.page1.xrce001
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce001
            #add-point:ON ACTION controlp INFIELD xrce001
            {<point name="input.c.page1.xrce001" />}
            #END add-point
 
         #Ctrlp:input.c.page1.xrcedocno
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrcedocno
            #add-point:ON ACTION controlp INFIELD xrcedocno
            {<point name="input.c.page1.xrcedocno" />}
            #END add-point
 
         #Ctrlp:input.c.page1.xrceld
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrceld
            #add-point:ON ACTION controlp INFIELD xrceld
            {<point name="input.c.page1.xrceld" />}
            #END add-point
 
         #Ctrlp:input.c.page1.xrcesite
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrcesite
            #add-point:ON ACTION controlp INFIELD xrcesite
            {<point name="input.c.page1.xrcesite" />}
            #END add-point
 
         #Ctrlp:input.c.page1.xrceseq
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrceseq
            #add-point:ON ACTION controlp INFIELD xrceseq
            {<point name="input.c.page1.xrceseq" />}
            #END add-point
 
         #Ctrlp:input.c.page1.xrce002
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce002
            #add-point:ON ACTION controlp INFIELD xrce002
            {<point name="input.c.page1.xrce002" />}
            #END add-point
 
         #Ctrlp:input.c.page1.xrce006
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce006
            #add-point:ON ACTION controlp INFIELD xrce006
            {<point name="input.c.page1.xrce006" />}
            #END add-point
 
         #Ctrlp:input.c.page1.xrce003
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce003
            #add-point:ON ACTION controlp INFIELD xrce003
            {<point name="input.c.page1.xrce003" />}
            #END add-point
 
         #Ctrlp:input.c.page1.xrce004
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce004
            #add-point:ON ACTION controlp INFIELD xrce004
            {<point name="input.c.page1.xrce004" />}
            #END add-point
 
         #Ctrlp:input.c.page1.xrce005
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce005
            #add-point:ON ACTION controlp INFIELD xrce005
            {<point name="input.c.page1.xrce005" />}
            #END add-point
 
         #Ctrlp:input.c.page1.xrce024
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce024
            #add-point:ON ACTION controlp INFIELD xrce024
            {<point name="input.c.page1.xrce024" />}
            #END add-point
 
         #Ctrlp:input.c.page1.xrce025
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce025
            #add-point:ON ACTION controlp INFIELD xrce025
            {<point name="input.c.page1.xrce025" />}
            #END add-point
 
         #Ctrlp:input.c.page1.xrce008
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce008
            #add-point:ON ACTION controlp INFIELD xrce008
            {<point name="input.c.page1.xrce008" />}
            #END add-point
 
         #Ctrlp:input.c.page1.xrce015
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce015
            #add-point:ON ACTION controlp INFIELD xrce015
            {<point name="input.c.page1.xrce015" />}
            #END add-point
 
         #Ctrlp:input.c.page1.xrce100
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce100
            #add-point:ON ACTION controlp INFIELD xrce100
            {<point name="input.c.page1.xrce100" />}
            #END add-point
 
         #Ctrlp:input.c.page1.xrce101
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce101
            #add-point:ON ACTION controlp INFIELD xrce101
            {<point name="input.c.page1.xrce101" />}
            #END add-point
 
         #Ctrlp:input.c.page1.xrce109
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce109
            #add-point:ON ACTION controlp INFIELD xrce109
            {<point name="input.c.page1.xrce109" />}
            #END add-point
 
         #Ctrlp:input.c.page1.xrce119
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce119
            #add-point:ON ACTION controlp INFIELD xrce119
            {<point name="input.c.page1.xrce119" />}
            #END add-point
 
         #Ctrlp:input.c.page1.xrce027
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce027
            #add-point:ON ACTION controlp INFIELD xrce027
            {<point name="input.c.page1.xrce027" />}
            #END add-point
 
         #Ctrlp:input.c.page1.xrce028
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce028
            #add-point:ON ACTION controlp INFIELD xrce028
            {<point name="input.c.page1.xrce028" />}
            #END add-point
 
         #Ctrlp:input.c.page1.xrce104
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce104
            #add-point:ON ACTION controlp INFIELD xrce104
            {<point name="input.c.page1.xrce104" />}
            #END add-point
 
         #Ctrlp:input.c.page1.xrce114
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce114
            #add-point:ON ACTION controlp INFIELD xrce114
            {<point name="input.c.page1.xrce114" />}
            #END add-point
 
         #Ctrlp:input.c.page1.xrce124
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce124
            #add-point:ON ACTION controlp INFIELD xrce124
            {<point name="input.c.page1.xrce124" />}
            #END add-point
 
         #Ctrlp:input.c.page1.xrce134
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce134
            #add-point:ON ACTION controlp INFIELD xrce134
            {<point name="input.c.page1.xrce134" />}
            #END add-point
 
         #Ctrlp:input.c.page1.xrcecomp
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrcecomp
            #add-point:ON ACTION controlp INFIELD xrcecomp
            {<point name="input.c.page1.xrcecomp" />}
            #END add-point
 
         #Ctrlp:input.c.page1.xrceorga
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrceorga
            #add-point:ON ACTION controlp INFIELD xrceorga
            {<point name="input.c.page1.xrceorga" />}
            #END add-point
 
         #Ctrlp:input.c.page1.xrce010
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce010
            #add-point:ON ACTION controlp INFIELD xrce010
            {<point name="input.c.page1.xrce010" />}
            #END add-point
 
         #Ctrlp:input.c.page1.xrce016
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce016
            #add-point:ON ACTION controlp INFIELD xrce016
            {<point name="input.c.page1.xrce016" />}
            #END add-point
 
         #Ctrlp:input.c.page1.xrde012_u
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrde012_u
            #add-point:ON ACTION controlp INFIELD xrde012_u
            {<point name="input.c.page1.xrde012_u" />}
            #END add-point
 
 
 
         ON ROW CHANGE
            IF INT_FLAG THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = '' 
               LET g_errparam.code   = 9001 
               LET g_errparam.popup  = FALSE 
               CALL cl_err()
               LET INT_FLAG = 0
               LET g_xrce_d[l_ac].* = g_xrce_d_t.*
               CLOSE axrt300_02_bcl
               #add-point:單身取消時
               {<point name="input.body.cancel"/>}
               #end add-point
               EXIT DIALOG 
            END IF
              
            IF l_lock_sw = 'Y' THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = g_xrce_d[l_ac].xrceld 
               LET g_errparam.code   = -263 
               LET g_errparam.popup  = TRUE 
               CALL cl_err()
               LET g_xrce_d[l_ac].* = g_xrce_d_t.*
            ELSE
               #寫入修改者/修改日期資訊(單身)
               
            
               #add-point:單身修改前
               {<point name="input.body.b_update" mark="Y"/>}
               #end add-point
               
               #將遮罩欄位還原
               CALL axrt300_02_xrce_t_mask_restore('restore_mask_o')
 
               UPDATE xrce_t SET (xrce001,xrcedocno,xrceld,xrcesite,xrceseq,xrce002,xrce006,xrce003, 
                   xrce004,xrce005,xrce024,xrce025,xrce008,xrce015,xrce100,xrce101,xrce109,xrce119,xrce027, 
                   xrce028,xrce104,xrce114,xrce124,xrce134,xrcecomp,xrceorga,xrce010,xrce016,xrce120, 
                   xrce121,xrce129,xrce130,xrce131,xrce139,xrce017,xrce018,xrce019,xrce020,xrce022,xrce023) = (g_xrce_d[l_ac].xrce001, 
                   g_xrce_d[l_ac].xrcedocno,g_xrce_d[l_ac].xrceld,g_xrce_d[l_ac].xrcesite,g_xrce_d[l_ac].xrceseq, 
                   g_xrce_d[l_ac].xrce002,g_xrce_d[l_ac].xrce006,g_xrce_d[l_ac].xrce003,g_xrce_d[l_ac].xrce004, 
                   g_xrce_d[l_ac].xrce005,g_xrce_d[l_ac].xrce024,g_xrce_d[l_ac].xrce025,g_xrce_d[l_ac].xrce008, 
                   g_xrce_d[l_ac].xrce015,g_xrce_d[l_ac].xrce100,g_xrce_d[l_ac].xrce101,g_xrce_d[l_ac].xrce109, 
                   g_xrce_d[l_ac].xrce119,g_xrce_d[l_ac].xrce027,g_xrce_d[l_ac].xrce028,g_xrce_d[l_ac].xrce104, 
                   g_xrce_d[l_ac].xrce114,g_xrce_d[l_ac].xrce124,g_xrce_d[l_ac].xrce134,g_xrce_d[l_ac].xrcecomp, 
                   g_xrce_d[l_ac].xrceorga,g_xrce_d[l_ac].xrce010,g_xrce_d[l_ac].xrce016,g_xrce2_d[l_ac].xrce120, 
                   g_xrce2_d[l_ac].xrce121,g_xrce2_d[l_ac].xrce129,g_xrce2_d[l_ac].xrce130,g_xrce2_d[l_ac].xrce131, 
                   g_xrce2_d[l_ac].xrce139,g_xrce3_d[l_ac].xrce017,g_xrce3_d[l_ac].xrce018,g_xrce3_d[l_ac].xrce019, 
                   g_xrce3_d[l_ac].xrce020,g_xrce3_d[l_ac].xrce022,g_xrce3_d[l_ac].xrce023)
                WHERE xrceent = g_enterprise AND
                  xrceld = g_xrce_d_t.xrceld #項次   
                  AND xrcedocno = g_xrce_d_t.xrcedocno  
                  AND xrceseq = g_xrce_d_t.xrceseq  
 
                  
               #add-point:單身修改中
               {<point name="input.body.m_update"/>}
               #end add-point
                  
               CASE
                  WHEN SQLCA.sqlerrd[3] = 0  #更新不到的處理
                     INITIALIZE g_errparam TO NULL 
                     LET g_errparam.extend = "xrce_t" 
                     LET g_errparam.code   = "std-00009" 
                     LET g_errparam.popup  = TRUE 
                     CALL cl_err()
                    WHEN SQLCA.sqlcode #其他錯誤
                     INITIALIZE g_errparam TO NULL 
                     LET g_errparam.extend = "xrce_t" 
                     LET g_errparam.code   = SQLCA.sqlcode 
                     LET g_errparam.popup  = TRUE 
                     CALL cl_err()
                  OTHERWISE
                                    INITIALIZE gs_keys TO NULL 
               LET gs_keys[1] = g_xrce_d[g_detail_idx].xrceld
               LET gs_keys_bak[1] = g_xrce_d_t.xrceld
               LET gs_keys[2] = g_xrce_d[g_detail_idx].xrcedocno
               LET gs_keys_bak[2] = g_xrce_d_t.xrcedocno
               LET gs_keys[3] = g_xrce_d[g_detail_idx].xrceseq
               LET gs_keys_bak[3] = g_xrce_d_t.xrceseq
               CALL axrt300_02_update_b('xrce_t',gs_keys,gs_keys_bak,"'1'")
                     #資料多語言用-增/改
                     
                     #修改歷程記錄(修改)
                     LET g_log1 = util.JSON.stringify(g_xrce_d_t)
                     LET g_log2 = util.JSON.stringify(g_xrce_d[l_ac])
                     IF NOT cl_log_modified_record(g_log1,g_log2) THEN 
                     END IF
               END CASE
               
               #將遮罩欄位進行遮蔽
               CALL axrt300_02_xrce_t_mask_restore('restore_mask_n')
               
               #add-point:單身修改後
               {<point name="input.body.a_update"/>}
               #end add-point
 
            END IF
            
         AFTER ROW
            CALL axrt300_02_unlock_b("xrce_t")
            #其他table進行unlock
            
             #add-point:單身after row
            {<point name="input.body.a_row"/>}
            #end add-point
            
         AFTER INPUT
            #add-point:單身input後
            {<point name="input.body.a_input"/>}
            #end add-point
            #錯誤訊息統整顯示
            #CALL cl_err_collect_show()
            #CALL cl_showmsg()
            
         ON ACTION controlo   
            CALL FGL_SET_ARR_CURR(g_xrce_d.getLength()+1)
            LET lb_reproduce = TRUE
            LET li_reproduce = l_ac
            LET li_reproduce_target = g_xrce_d.getLength()+1
            
      END INPUT
      
      INPUT ARRAY g_xrce2_d FROM s_detail2.*
         ATTRIBUTE(COUNT = g_detail_cnt,WITHOUT DEFAULTS, #MAXCOUNT = g_max_rec,
                 INSERT ROW = FALSE, #此頁面insert功能由產生器控制, 手動之設定無效! 

                 DELETE ROW = l_allow_delete,
                 APPEND ROW = l_allow_insert)
                 
         #自訂ACTION(detail_input,page_2)
         
         
         BEFORE INPUT
          CALL FGL_SET_ARR_CURR(g_detail_idx)
            
            CALL axrt300_02_b_fill(g_wc2)
            LET g_detail_cnt = g_xrce2_d.getLength()
 
         BEFORE INSERT
            LET g_insert = 'Y' 
            NEXT FIELD xrceld
 
            LET l_n = ARR_COUNT()
            LET l_cmd = 'a'
            INITIALIZE g_xrce2_d[l_ac].* TO NULL 
            INITIALIZE g_xrce2_d_t.* TO NULL
            INITIALIZE g_xrce2_d_o.* TO NULL
            #公用欄位給值(單身2)
            
            #自定義預設值(單身2)
            
            #add-point:modify段before備份
            {<point name="input.body2.before_bak"/>}
            #end add-point
            LET g_xrce2_d_t.* = g_xrce2_d[l_ac].*     #新輸入資料
            LET g_xrce2_d_o.* = g_xrce2_d[l_ac].*     #新輸入資料
            CALL cl_show_fld_cont()
            CALL axrt300_02_set_entry_b("a")
            CALL axrt300_02_set_no_entry_b("a")
            IF lb_reproduce THEN
               LET lb_reproduce = FALSE
               LET g_xrce_d[li_reproduce_target].* = g_xrce_d[li_reproduce].*
               LET g_xrce2_d[li_reproduce_target].* = g_xrce2_d[li_reproduce].*
               LET g_xrce3_d[li_reproduce_target].* = g_xrce3_d[li_reproduce].*
 
               LET g_xrce2_d[li_reproduce_target].xrceld = NULL
               LET g_xrce2_d[li_reproduce_target].xrcedocno = NULL
               LET g_xrce2_d[li_reproduce_target].xrceseq = NULL
            END IF
            
            #add-point:modify段before insert
            {<point name="input.body2.before_insert"/>}
            #end add-point  
            
         BEFORE ROW 
            #add-point:modify段before row
            {<point name="input.body2.before_row2"/>}
            #end add-point  
            LET g_detail_idx = DIALOG.getCurrentRow("s_detail2")
            LET l_cmd = ''
            LET l_ac = g_detail_idx
            LET l_lock_sw = 'N'            #DEFAULT
            LET l_n = ARR_COUNT()
            DISPLAY l_ac TO FORMONLY.idx
            DISPLAY g_xrce2_d.getLength() TO FORMONLY.cnt
         
            CALL s_transaction_begin()
            
            LET g_detail_cnt = g_xrce2_d.getLength()
            
            IF g_detail_cnt >= l_ac 
               AND g_xrce2_d[l_ac].xrceld IS NOT NULL
               AND g_xrce2_d[l_ac].xrcedocno IS NOT NULL
               AND g_xrce2_d[l_ac].xrceseq IS NOT NULL
            THEN 
               LET l_cmd='u'
               LET g_xrce2_d_t.* = g_xrce2_d[l_ac].*  #BACKUP
               LET g_xrce2_d_o.* = g_xrce2_d[l_ac].*  #BACKUP
               IF NOT axrt300_02_lock_b("xrce_t") THEN
                  LET l_lock_sw='Y'
               ELSE
                  FETCH axrt300_02_bcl INTO g_xrce_d[l_ac].xrce001,g_xrce_d[l_ac].xrcedocno,g_xrce_d[l_ac].xrceld, 
                      g_xrce_d[l_ac].xrcesite,g_xrce_d[l_ac].xrceseq,g_xrce_d[l_ac].xrce002,g_xrce_d[l_ac].xrce006, 
                      g_xrce_d[l_ac].xrce003,g_xrce_d[l_ac].xrce004,g_xrce_d[l_ac].xrce005,g_xrce_d[l_ac].xrce024, 
                      g_xrce_d[l_ac].xrce025,g_xrce_d[l_ac].xrce008,g_xrce_d[l_ac].xrce015,g_xrce_d[l_ac].xrce100, 
                      g_xrce_d[l_ac].xrce101,g_xrce_d[l_ac].xrce109,g_xrce_d[l_ac].xrce119,g_xrce_d[l_ac].xrce027, 
                      g_xrce_d[l_ac].xrce028,g_xrce_d[l_ac].xrce104,g_xrce_d[l_ac].xrce114,g_xrce_d[l_ac].xrce124, 
                      g_xrce_d[l_ac].xrce134,g_xrce_d[l_ac].xrcecomp,g_xrce_d[l_ac].xrceorga,g_xrce_d[l_ac].xrce010, 
                      g_xrce_d[l_ac].xrce016,g_xrce2_d[l_ac].xrce001,g_xrce2_d[l_ac].xrcedocno,g_xrce2_d[l_ac].xrceld, 
                      g_xrce2_d[l_ac].xrcesite,g_xrce2_d[l_ac].xrceseq,g_xrce2_d[l_ac].xrce002,g_xrce2_d[l_ac].xrce006, 
                      g_xrce2_d[l_ac].xrce003,g_xrce2_d[l_ac].xrce004,g_xrce2_d[l_ac].xrce008,g_xrce2_d[l_ac].xrce100, 
                      g_xrce2_d[l_ac].xrce109,g_xrce2_d[l_ac].xrce101,g_xrce2_d[l_ac].xrce119,g_xrce2_d[l_ac].xrce120, 
                      g_xrce2_d[l_ac].xrce121,g_xrce2_d[l_ac].xrce129,g_xrce2_d[l_ac].xrce130,g_xrce2_d[l_ac].xrce131, 
                      g_xrce2_d[l_ac].xrce139,g_xrce3_d[l_ac].xrce001,g_xrce3_d[l_ac].xrcedocno,g_xrce3_d[l_ac].xrceld, 
                      g_xrce3_d[l_ac].xrcesite,g_xrce3_d[l_ac].xrceseq,g_xrce3_d[l_ac].xrce002,g_xrce3_d[l_ac].xrce006, 
                      g_xrce3_d[l_ac].xrce003,g_xrce3_d[l_ac].xrce004,g_xrce3_d[l_ac].xrce005,g_xrce3_d[l_ac].xrce008, 
                      g_xrce3_d[l_ac].xrce100,g_xrce3_d[l_ac].xrce109,g_xrce3_d[l_ac].xrce101,g_xrce3_d[l_ac].xrce119, 
                      g_xrce3_d[l_ac].xrce027,g_xrce3_d[l_ac].xrce010,g_xrce3_d[l_ac].xrce016,g_xrce3_d[l_ac].xrce017, 
                      g_xrce3_d[l_ac].xrce018,g_xrce3_d[l_ac].xrce019,g_xrce3_d[l_ac].xrce020,g_xrce3_d[l_ac].xrce022, 
                      g_xrce3_d[l_ac].xrce023
                  IF SQLCA.sqlcode THEN
                     INITIALIZE g_errparam TO NULL 
                     LET g_errparam.extend = '' 
                     LET g_errparam.code   = SQLCA.sqlcode 
                     LET g_errparam.popup  = TRUE 
                     CALL cl_err()
                     LET l_lock_sw = "Y"
                  END IF
                  
                  #遮罩相關處理
                  LET g_xrce2_d_mask_o[l_ac].* =  g_xrce2_d[l_ac].*
                  CALL axrt300_02_xrce_t_mask()
                  LET g_xrce2_d_mask_n[l_ac].* =  g_xrce2_d[l_ac].*
                  
                  CALL cl_show_fld_cont()
                  CALL axrt300_02_detail_show()
               END IF
            ELSE
               LET l_cmd='a'
            END IF
            #add-point:modify段before row
            {<point name="input.body2.before_row"/>}
            #end add-point  
            #其他table資料備份(確定是否更改用)
            
            #其他table進行lock
            
            
         BEFORE DELETE                            #是否取消單身
            IF l_cmd = 'a' THEN
               LET l_cmd='d'
            ELSE
               #add-point:單身2ask刪除前
               {<point name="input.body2.b_delete_ask">}
               #end add-point 
            
               IF NOT cl_ask_del_detail() THEN
                  CANCEL DELETE
               END IF
               IF l_lock_sw = "Y" THEN
                  INITIALIZE g_errparam TO NULL 
                  LET g_errparam.extend = "" 
                  LET g_errparam.code   = -263 
                  LET g_errparam.popup  = TRUE 
                  CALL cl_err()
                  CANCEL DELETE
               END IF
               
               #add-point:單身2刪除前
               {<point name="input.body2.b_delete" mark="Y"/>}
               #end add-point 
               
               DELETE FROM xrce_t
                WHERE xrceent = g_enterprise AND
                  xrceld = g_xrce2_d_t.xrceld
                  AND xrcedocno = g_xrce2_d_t.xrcedocno
                  AND xrceseq = g_xrce2_d_t.xrceseq
                  
               #add-point:單身2刪除中
               {<point name="input.body2.m_delete"/>}
               #end add-point 
                  
               IF SQLCA.sqlcode THEN
                  INITIALIZE g_errparam TO NULL 
                  LET g_errparam.extend = "xrce_t" 
                  LET g_errparam.code   = SQLCA.sqlcode 
                  LET g_errparam.popup  = TRUE 
                  CALL cl_err()
                  CANCEL DELETE   
               ELSE
                  LET g_detail_cnt = g_detail_cnt-1
                  
                  #add-point:單身2刪除後
                  {<point name="input.body2.a_delete"/>}
                  #end add-point
                  #修改歷程記錄(刪除)
                  CALL axrt300_02_set_pk_array()
                  IF NOT cl_log_modified_record('','') THEN 
                  ELSE
                  END IF
               END IF 
               CLOSE axrt300_02_bcl
               #add-point:單身2刪除關閉bcl
               {<point name="input.body2.close"/>}
               #end add-point
               LET l_count = g_xrce_d.getLength()
                              INITIALIZE gs_keys TO NULL 
               LET gs_keys[1] = g_xrce2_d_t.xrceld
               LET gs_keys[2] = g_xrce2_d_t.xrcedocno
               LET gs_keys[3] = g_xrce2_d_t.xrceseq
 
               #應用 a47 樣板自動產生(Version:2)
      #刪除相關文件
      CALL axrt300_02_set_pk_array()
      #add-point:相關文件刪除前
      {<point name="delete.befroe.related_document_remove"/>}
      #end add-point   
      CALL cl_doc_remove()  
 
 
 
            END IF 
            
         AFTER DELETE 
            IF l_cmd <> 'd' THEN
               #add-point:單身刪除後2
               {<point name="input.body2.after_delete"/>}
               #end add-point
                              CALL axrt300_02_delete_b('xrce_t',gs_keys,"'2'")
            END IF
            #如果是最後一筆
            IF l_ac = (g_xrce2_d.getLength() + 1) THEN
               CALL FGL_SET_ARR_CURR(l_ac-1)
            END IF
 
         AFTER INSERT    
            IF INT_FLAG THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = '' 
               LET g_errparam.code   = 9001 
               LET g_errparam.popup  = FALSE 
               CALL cl_err()
               LET INT_FLAG = 0
               CANCEL INSERT
            END IF
               
            LET l_count = 1  
            SELECT COUNT(*) INTO l_count FROM xrce_t 
             WHERE xrceent = g_enterprise AND
                   xrceld = g_xrce2_d[l_ac].xrceld
                   AND xrcedocno = g_xrce2_d[l_ac].xrcedocno
                   AND xrceseq = g_xrce2_d[l_ac].xrceseq
                
            #資料未重複, 插入新增資料
            IF l_count = 0 THEN 
               #add-point:單身2新增前
               {<point name="input.body2.b_insert"/>}
               #end add-point
            
                              INITIALIZE gs_keys TO NULL 
               LET gs_keys[1] = g_xrce2_d[g_detail_idx].xrceld
               LET gs_keys[2] = g_xrce2_d[g_detail_idx].xrcedocno
               LET gs_keys[3] = g_xrce2_d[g_detail_idx].xrceseq
               CALL axrt300_02_insert_b('xrce_t',gs_keys,"'2'")
                           
               #add-point:單身新增後2
               {<point name="input.body2.a_insert"/>}
               #end add-point
            ELSE    
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = 'INSERT' 
               LET g_errparam.code   = "std-00006" 
               LET g_errparam.popup  = TRUE 
               CALL cl_err()
               INITIALIZE g_xrce_d[l_ac].* TO NULL
               CANCEL INSERT
            END IF
 
            IF SQLCA.SQLcode  THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = "xrce_t" 
               LET g_errparam.code   = SQLCA.sqlcode 
               LET g_errparam.popup  = TRUE 
               CALL cl_err()
               CANCEL INSERT
            ELSE
               #先刷新資料
               #CALL axrt300_02_b_fill(g_wc2)
               #資料多語言用-增/改
               
               #add-point:單身新增後
               {<point name="input.body2.after_insert"/>}
               #end add-point
               ##ERROR 'INSERT O.K'
               LET g_detail_cnt = g_detail_cnt + 1
               LET g_wc2 = g_wc2, " OR (xrceld = '", g_xrce2_d[l_ac].xrceld, "' "
                                  ," AND xrcedocno = '", g_xrce2_d[l_ac].xrcedocno, "' "
                                  ," AND xrceseq = '", g_xrce2_d[l_ac].xrceseq, "' "
                                  ,")"
            END IF
            
         ON ROW CHANGE 
            IF INT_FLAG THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = '' 
               LET g_errparam.code   = 9001 
               LET g_errparam.popup  = FALSE 
               CALL cl_err()
               LET INT_FLAG = 0
               LET g_xrce2_d[l_ac].* = g_xrce2_d_t.*
               CLOSE axrt300_02_bcl
               #add-point:單身page2取消後
               {<point name="input.body2.cancel"/>}
               #end add-point
               EXIT DIALOG 
            END IF
            
            IF l_lock_sw = 'Y' THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = '' 
               LET g_errparam.code   = -263 
               LET g_errparam.popup  = TRUE 
               CALL cl_err()
               LET g_xrce2_d[l_ac].* = g_xrce2_d_t.*
            ELSE
               
               #寫入修改者/修改日期資訊(單身2)
               
               
               #add-point:單身page2修改前
               {<point name="input.body2.b_update" mark="Y"/>}
               #end add-point
               
               #將遮罩欄位還原
               CALL axrt300_02_xrce_t_mask_restore('restore_mask_o')
               
               UPDATE xrce_t SET (xrce001,xrcedocno,xrceld,xrcesite,xrceseq,xrce002,xrce006,xrce003, 
                   xrce004,xrce005,xrce024,xrce025,xrce008,xrce015,xrce100,xrce101,xrce109,xrce119,xrce027, 
                   xrce028,xrce104,xrce114,xrce124,xrce134,xrcecomp,xrceorga,xrce010,xrce016,xrce120, 
                   xrce121,xrce129,xrce130,xrce131,xrce139,xrce017,xrce018,xrce019,xrce020,xrce022,xrce023) = (g_xrce_d[l_ac].xrce001, 
                   g_xrce_d[l_ac].xrcedocno,g_xrce_d[l_ac].xrceld,g_xrce_d[l_ac].xrcesite,g_xrce_d[l_ac].xrceseq, 
                   g_xrce_d[l_ac].xrce002,g_xrce_d[l_ac].xrce006,g_xrce_d[l_ac].xrce003,g_xrce_d[l_ac].xrce004, 
                   g_xrce_d[l_ac].xrce005,g_xrce_d[l_ac].xrce024,g_xrce_d[l_ac].xrce025,g_xrce_d[l_ac].xrce008, 
                   g_xrce_d[l_ac].xrce015,g_xrce_d[l_ac].xrce100,g_xrce_d[l_ac].xrce101,g_xrce_d[l_ac].xrce109, 
                   g_xrce_d[l_ac].xrce119,g_xrce_d[l_ac].xrce027,g_xrce_d[l_ac].xrce028,g_xrce_d[l_ac].xrce104, 
                   g_xrce_d[l_ac].xrce114,g_xrce_d[l_ac].xrce124,g_xrce_d[l_ac].xrce134,g_xrce_d[l_ac].xrcecomp, 
                   g_xrce_d[l_ac].xrceorga,g_xrce_d[l_ac].xrce010,g_xrce_d[l_ac].xrce016,g_xrce2_d[l_ac].xrce120, 
                   g_xrce2_d[l_ac].xrce121,g_xrce2_d[l_ac].xrce129,g_xrce2_d[l_ac].xrce130,g_xrce2_d[l_ac].xrce131, 
                   g_xrce2_d[l_ac].xrce139,g_xrce3_d[l_ac].xrce017,g_xrce3_d[l_ac].xrce018,g_xrce3_d[l_ac].xrce019, 
                   g_xrce3_d[l_ac].xrce020,g_xrce3_d[l_ac].xrce022,g_xrce3_d[l_ac].xrce023) #自訂欄位頁簽 

                WHERE xrceent = g_enterprise AND
                  xrceld = g_xrce2_d_t.xrceld #項次 
                  AND xrcedocno = g_xrce2_d_t.xrcedocno
                  AND xrceseq = g_xrce2_d_t.xrceseq
                  
               #add-point:單身page2修改中
               {<point name="input.body2.m_update"/>}
               #end add-point
                  
               CASE
                  WHEN SQLCA.sqlerrd[3] = 0  #更新不到的處理
                     INITIALIZE g_errparam TO NULL 
                     LET g_errparam.extend = "xrce_t" 
                     LET g_errparam.code   = "std-00009" 
                     LET g_errparam.popup  = TRUE 
                     CALL cl_err()
                  WHEN SQLCA.sqlcode #其他錯誤
                     INITIALIZE g_errparam TO NULL 
                     LET g_errparam.extend = "xrce_t" 
                     LET g_errparam.code   = SQLCA.sqlcode 
                     LET g_errparam.popup  = TRUE 
                     CALL cl_err()
                  OTHERWISE
                                    INITIALIZE gs_keys TO NULL 
               LET gs_keys[1] = g_xrce2_d[g_detail_idx].xrceld
               LET gs_keys_bak[1] = g_xrce2_d_t.xrceld
               LET gs_keys[2] = g_xrce2_d[g_detail_idx].xrcedocno
               LET gs_keys_bak[2] = g_xrce2_d_t.xrcedocno
               LET gs_keys[3] = g_xrce2_d[g_detail_idx].xrceseq
               LET gs_keys_bak[3] = g_xrce2_d_t.xrceseq
               CALL axrt300_02_update_b('xrce_t',gs_keys,gs_keys_bak,"'2'")
                     #資料多語言用-增/改
                     
                     
                     #修改歷程記錄(修改)
                     LET g_log1 = util.JSON.stringify(g_xrce2_d_t)
                     LET g_log2 = util.JSON.stringify(g_xrce2_d[l_ac])
                     IF NOT cl_log_modified_record(g_log1,g_log2) THEN 
                     END IF
               END CASE
               
               #將遮罩欄位進行遮蔽
               CALL axrt300_02_xrce_t_mask_restore('restore_mask_n')
               
               #add-point:單身page2修改後
               {<point name="input.body2.a_update"/>}
               #end add-point
            END IF
         
                  #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce001_t
            #add-point:BEFORE FIELD xrce001_t
            {<point name="input.b.page2.xrce001_t" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce001_t
            
            #add-point:AFTER FIELD xrce001_t
            {<point name="input.a.page2.xrce001_t" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xrce001_t
            #add-point:ON CHANGE xrce001_t
            {<point name="input.g.page2.xrce001_t" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrcedocno_t
            #add-point:BEFORE FIELD xrcedocno_t
            {<point name="input.b.page2.xrcedocno_t" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrcedocno_t
            
            #add-point:AFTER FIELD xrcedocno_t
            {<point name="input.a.page2.xrcedocno_t" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xrcedocno_t
            #add-point:ON CHANGE xrcedocno_t
            {<point name="input.g.page2.xrcedocno_t" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrceld_t
            #add-point:BEFORE FIELD xrceld_t
            {<point name="input.b.page2.xrceld_t" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrceld_t
            
            #add-point:AFTER FIELD xrceld_t
            {<point name="input.a.page2.xrceld_t" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xrceld_t
            #add-point:ON CHANGE xrceld_t
            {<point name="input.g.page2.xrceld_t" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrcesite_t
            #add-point:BEFORE FIELD xrcesite_t
            {<point name="input.b.page2.xrcesite_t" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrcesite_t
            
            #add-point:AFTER FIELD xrcesite_t
            {<point name="input.a.page2.xrcesite_t" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xrcesite_t
            #add-point:ON CHANGE xrcesite_t
            {<point name="input.g.page2.xrcesite_t" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrceseq_t
            #add-point:BEFORE FIELD xrceseq_t
            {<point name="input.b.page2.xrceseq_t" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrceseq_t
            
            #add-point:AFTER FIELD xrceseq_t
            {<point name="input.a.page2.xrceseq_t" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xrceseq_t
            #add-point:ON CHANGE xrceseq_t
            {<point name="input.g.page2.xrceseq_t" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce002_t
            #add-point:BEFORE FIELD xrce002_t
            {<point name="input.b.page2.xrce002_t" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce002_t
            
            #add-point:AFTER FIELD xrce002_t
            {<point name="input.a.page2.xrce002_t" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xrce002_t
            #add-point:ON CHANGE xrce002_t
            {<point name="input.g.page2.xrce002_t" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce006_t
            #add-point:BEFORE FIELD xrce006_t
            {<point name="input.b.page2.xrce006_t" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce006_t
            
            #add-point:AFTER FIELD xrce006_t
            {<point name="input.a.page2.xrce006_t" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xrce006_t
            #add-point:ON CHANGE xrce006_t
            {<point name="input.g.page2.xrce006_t" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce003_t
            #add-point:BEFORE FIELD xrce003_t
            {<point name="input.b.page2.xrce003_t" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce003_t
            
            #add-point:AFTER FIELD xrce003_t
            {<point name="input.a.page2.xrce003_t" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xrce003_t
            #add-point:ON CHANGE xrce003_t
            {<point name="input.g.page2.xrce003_t" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce004_t
            #add-point:BEFORE FIELD xrce004_t
            {<point name="input.b.page2.xrce004_t" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce004_t
            
            #add-point:AFTER FIELD xrce004_t
            {<point name="input.a.page2.xrce004_t" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xrce004_t
            #add-point:ON CHANGE xrce004_t
            {<point name="input.g.page2.xrce004_t" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce008_t
            #add-point:BEFORE FIELD xrce008_t
            {<point name="input.b.page2.xrce008_t" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce008_t
            
            #add-point:AFTER FIELD xrce008_t
            {<point name="input.a.page2.xrce008_t" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xrce008_t
            #add-point:ON CHANGE xrce008_t
            {<point name="input.g.page2.xrce008_t" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce100_t
            #add-point:BEFORE FIELD xrce100_t
            {<point name="input.b.page2.xrce100_t" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce100_t
            
            #add-point:AFTER FIELD xrce100_t
            {<point name="input.a.page2.xrce100_t" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xrce100_t
            #add-point:ON CHANGE xrce100_t
            {<point name="input.g.page2.xrce100_t" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce109_t
            #add-point:BEFORE FIELD xrce109_t
            {<point name="input.b.page2.xrce109_t" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce109_t
            
            #add-point:AFTER FIELD xrce109_t
            {<point name="input.a.page2.xrce109_t" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xrce109_t
            #add-point:ON CHANGE xrce109_t
            {<point name="input.g.page2.xrce109_t" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce101_t
            #add-point:BEFORE FIELD xrce101_t
            {<point name="input.b.page2.xrce101_t" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce101_t
            
            #add-point:AFTER FIELD xrce101_t
            {<point name="input.a.page2.xrce101_t" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xrce101_t
            #add-point:ON CHANGE xrce101_t
            {<point name="input.g.page2.xrce101_t" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce119_t
            #add-point:BEFORE FIELD xrce119_t
            {<point name="input.b.page2.xrce119_t" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce119_t
            
            #add-point:AFTER FIELD xrce119_t
            {<point name="input.a.page2.xrce119_t" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xrce119_t
            #add-point:ON CHANGE xrce119_t
            {<point name="input.g.page2.xrce119_t" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce120
            #add-point:BEFORE FIELD xrce120
            {<point name="input.b.page2.xrce120" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce120
            
            #add-point:AFTER FIELD xrce120
            {<point name="input.a.page2.xrce120" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xrce120
            #add-point:ON CHANGE xrce120
            {<point name="input.g.page2.xrce120" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce121
            #add-point:BEFORE FIELD xrce121
            {<point name="input.b.page2.xrce121" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce121
            
            #add-point:AFTER FIELD xrce121
            {<point name="input.a.page2.xrce121" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xrce121
            #add-point:ON CHANGE xrce121
            {<point name="input.g.page2.xrce121" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce129
            #add-point:BEFORE FIELD xrce129
            {<point name="input.b.page2.xrce129" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce129
            
            #add-point:AFTER FIELD xrce129
            {<point name="input.a.page2.xrce129" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xrce129
            #add-point:ON CHANGE xrce129
            {<point name="input.g.page2.xrce129" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce130
            #add-point:BEFORE FIELD xrce130
            {<point name="input.b.page2.xrce130" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce130
            
            #add-point:AFTER FIELD xrce130
            {<point name="input.a.page2.xrce130" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xrce130
            #add-point:ON CHANGE xrce130
            {<point name="input.g.page2.xrce130" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce131
            #add-point:BEFORE FIELD xrce131
            {<point name="input.b.page2.xrce131" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce131
            
            #add-point:AFTER FIELD xrce131
            {<point name="input.a.page2.xrce131" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xrce131
            #add-point:ON CHANGE xrce131
            {<point name="input.g.page2.xrce131" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce139
            #add-point:BEFORE FIELD xrce139
            {<point name="input.b.page2.xrce139" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce139
            
            #add-point:AFTER FIELD xrce139
            {<point name="input.a.page2.xrce139" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xrce139
            #add-point:ON CHANGE xrce139
            {<point name="input.g.page2.xrce139" />}
            #END add-point 
 
 
                  #Ctrlp:input.c.page2.xrce001_t
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce001_t
            #add-point:ON ACTION controlp INFIELD xrce001_t
            {<point name="input.c.page2.xrce001_t" />}
            #END add-point
 
         #Ctrlp:input.c.page2.xrcedocno_t
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrcedocno_t
            #add-point:ON ACTION controlp INFIELD xrcedocno_t
            {<point name="input.c.page2.xrcedocno_t" />}
            #END add-point
 
         #Ctrlp:input.c.page2.xrceld_t
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrceld_t
            #add-point:ON ACTION controlp INFIELD xrceld_t
            {<point name="input.c.page2.xrceld_t" />}
            #END add-point
 
         #Ctrlp:input.c.page2.xrcesite_t
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrcesite_t
            #add-point:ON ACTION controlp INFIELD xrcesite_t
            {<point name="input.c.page2.xrcesite_t" />}
            #END add-point
 
         #Ctrlp:input.c.page2.xrceseq_t
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrceseq_t
            #add-point:ON ACTION controlp INFIELD xrceseq_t
            {<point name="input.c.page2.xrceseq_t" />}
            #END add-point
 
         #Ctrlp:input.c.page2.xrce002_t
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce002_t
            #add-point:ON ACTION controlp INFIELD xrce002_t
            {<point name="input.c.page2.xrce002_t" />}
            #END add-point
 
         #Ctrlp:input.c.page2.xrce006_t
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce006_t
            #add-point:ON ACTION controlp INFIELD xrce006_t
            {<point name="input.c.page2.xrce006_t" />}
            #END add-point
 
         #Ctrlp:input.c.page2.xrce003_t
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce003_t
            #add-point:ON ACTION controlp INFIELD xrce003_t
            {<point name="input.c.page2.xrce003_t" />}
            #END add-point
 
         #Ctrlp:input.c.page2.xrce004_t
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce004_t
            #add-point:ON ACTION controlp INFIELD xrce004_t
            {<point name="input.c.page2.xrce004_t" />}
            #END add-point
 
         #Ctrlp:input.c.page2.xrce008_t
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce008_t
            #add-point:ON ACTION controlp INFIELD xrce008_t
            {<point name="input.c.page2.xrce008_t" />}
            #END add-point
 
         #Ctrlp:input.c.page2.xrce100_t
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce100_t
            #add-point:ON ACTION controlp INFIELD xrce100_t
            {<point name="input.c.page2.xrce100_t" />}
            #END add-point
 
         #Ctrlp:input.c.page2.xrce109_t
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce109_t
            #add-point:ON ACTION controlp INFIELD xrce109_t
            {<point name="input.c.page2.xrce109_t" />}
            #END add-point
 
         #Ctrlp:input.c.page2.xrce101_t
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce101_t
            #add-point:ON ACTION controlp INFIELD xrce101_t
            {<point name="input.c.page2.xrce101_t" />}
            #END add-point
 
         #Ctrlp:input.c.page2.xrce119_t
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce119_t
            #add-point:ON ACTION controlp INFIELD xrce119_t
            {<point name="input.c.page2.xrce119_t" />}
            #END add-point
 
         #Ctrlp:input.c.page2.xrce120
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce120
            #add-point:ON ACTION controlp INFIELD xrce120
            {<point name="input.c.page2.xrce120" />}
            #END add-point
 
         #Ctrlp:input.c.page2.xrce121
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce121
            #add-point:ON ACTION controlp INFIELD xrce121
            {<point name="input.c.page2.xrce121" />}
            #END add-point
 
         #Ctrlp:input.c.page2.xrce129
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce129
            #add-point:ON ACTION controlp INFIELD xrce129
            {<point name="input.c.page2.xrce129" />}
            #END add-point
 
         #Ctrlp:input.c.page2.xrce130
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce130
            #add-point:ON ACTION controlp INFIELD xrce130
            {<point name="input.c.page2.xrce130" />}
            #END add-point
 
         #Ctrlp:input.c.page2.xrce131
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce131
            #add-point:ON ACTION controlp INFIELD xrce131
            {<point name="input.c.page2.xrce131" />}
            #END add-point
 
         #Ctrlp:input.c.page2.xrce139
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce139
            #add-point:ON ACTION controlp INFIELD xrce139
            {<point name="input.c.page2.xrce139" />}
            #END add-point
 
 
 
         AFTER ROW
            LET l_ac = ARR_CURR()
            LET l_ac_t = l_ac
            IF INT_FLAG THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = '' 
               LET g_errparam.code   = 9001 
               LET g_errparam.popup  = FALSE 
               CALL cl_err()
               LET INT_FLAG = 0
               IF l_cmd = 'u' THEN
                  LET g_xrce2_d[l_ac].* = g_xrce2_d_t.*
               END IF
               CLOSE axrt300_02_bcl
               #add-point:單身after row
               {<point name="input.body2.a_close"/>}
               #end add-point
               EXIT DIALOG 
            END IF
            
            #其他table進行unlock
            
 
            CALL axrt300_02_unlock_b("xrce_t")
            #add-point:單身after row
            {<point name="input.body2.a_row"/>}
            #end add-point
            
         AFTER INPUT
            #add-point:單身2input後
            {<point name="input.body2.a_input"/>}
            #end add-point
         
         #複製上一次指定的單身資料至最下方
         ON ACTION controlo   
            CALL FGL_SET_ARR_CURR(g_xrce2_d.getLength()+1)
            LET lb_reproduce = TRUE
            LET li_reproduce = l_ac
            LET li_reproduce_target = g_xrce2_d.getLength()+1
 
      END INPUT
      INPUT ARRAY g_xrce3_d FROM s_detail3.*
         ATTRIBUTE(COUNT = g_detail_cnt,WITHOUT DEFAULTS, #MAXCOUNT = g_max_rec,
                 INSERT ROW = FALSE, #此頁面insert功能由產生器控制, 手動之設定無效! 

                 DELETE ROW = l_allow_delete,
                 APPEND ROW = l_allow_insert)
                 
         #自訂ACTION(detail_input,page_3)
         
         
         BEFORE INPUT
          CALL FGL_SET_ARR_CURR(g_detail_idx)
            
            CALL axrt300_02_b_fill(g_wc2)
            LET g_detail_cnt = g_xrce3_d.getLength()
 
         BEFORE INSERT
            LET g_insert = 'Y' 
            NEXT FIELD xrceld
 
            LET l_n = ARR_COUNT()
            LET l_cmd = 'a'
            INITIALIZE g_xrce3_d[l_ac].* TO NULL 
            INITIALIZE g_xrce3_d_t.* TO NULL
            INITIALIZE g_xrce3_d_o.* TO NULL
            #公用欄位給值(單身3)
            
            #自定義預設值(單身3)
            
            #add-point:modify段before備份
            {<point name="input.body3.before_bak"/>}
            #end add-point
            LET g_xrce3_d_t.* = g_xrce3_d[l_ac].*     #新輸入資料
            LET g_xrce3_d_o.* = g_xrce3_d[l_ac].*     #新輸入資料
            CALL cl_show_fld_cont()
            CALL axrt300_02_set_entry_b("a")
            CALL axrt300_02_set_no_entry_b("a")
            IF lb_reproduce THEN
               LET lb_reproduce = FALSE
               LET g_xrce_d[li_reproduce_target].* = g_xrce_d[li_reproduce].*
               LET g_xrce2_d[li_reproduce_target].* = g_xrce2_d[li_reproduce].*
               LET g_xrce3_d[li_reproduce_target].* = g_xrce3_d[li_reproduce].*
 
               LET g_xrce3_d[li_reproduce_target].xrceld = NULL
               LET g_xrce3_d[li_reproduce_target].xrcedocno = NULL
               LET g_xrce3_d[li_reproduce_target].xrceseq = NULL
            END IF
            
            #add-point:modify段before insert
            {<point name="input.body3.before_insert"/>}
            #end add-point  
            
         BEFORE ROW 
            #add-point:modify段before row
            {<point name="input.body3.before_row2"/>}
            #end add-point  
            LET g_detail_idx = DIALOG.getCurrentRow("s_detail3")
            LET l_cmd = ''
            LET l_ac = g_detail_idx
            LET l_lock_sw = 'N'            #DEFAULT
            LET l_n = ARR_COUNT()
            DISPLAY l_ac TO FORMONLY.idx
            DISPLAY g_xrce3_d.getLength() TO FORMONLY.cnt
         
            CALL s_transaction_begin()
            
            LET g_detail_cnt = g_xrce3_d.getLength()
            
            IF g_detail_cnt >= l_ac 
               AND g_xrce3_d[l_ac].xrceld IS NOT NULL
               AND g_xrce3_d[l_ac].xrcedocno IS NOT NULL
               AND g_xrce3_d[l_ac].xrceseq IS NOT NULL
            THEN 
               LET l_cmd='u'
               LET g_xrce3_d_t.* = g_xrce3_d[l_ac].*  #BACKUP
               LET g_xrce3_d_o.* = g_xrce3_d[l_ac].*  #BACKUP
               IF NOT axrt300_02_lock_b("xrce_t") THEN
                  LET l_lock_sw='Y'
               ELSE
                  FETCH axrt300_02_bcl INTO g_xrce_d[l_ac].xrce001,g_xrce_d[l_ac].xrcedocno,g_xrce_d[l_ac].xrceld, 
                      g_xrce_d[l_ac].xrcesite,g_xrce_d[l_ac].xrceseq,g_xrce_d[l_ac].xrce002,g_xrce_d[l_ac].xrce006, 
                      g_xrce_d[l_ac].xrce003,g_xrce_d[l_ac].xrce004,g_xrce_d[l_ac].xrce005,g_xrce_d[l_ac].xrce024, 
                      g_xrce_d[l_ac].xrce025,g_xrce_d[l_ac].xrce008,g_xrce_d[l_ac].xrce015,g_xrce_d[l_ac].xrce100, 
                      g_xrce_d[l_ac].xrce101,g_xrce_d[l_ac].xrce109,g_xrce_d[l_ac].xrce119,g_xrce_d[l_ac].xrce027, 
                      g_xrce_d[l_ac].xrce028,g_xrce_d[l_ac].xrce104,g_xrce_d[l_ac].xrce114,g_xrce_d[l_ac].xrce124, 
                      g_xrce_d[l_ac].xrce134,g_xrce_d[l_ac].xrcecomp,g_xrce_d[l_ac].xrceorga,g_xrce_d[l_ac].xrce010, 
                      g_xrce_d[l_ac].xrce016,g_xrce2_d[l_ac].xrce001,g_xrce2_d[l_ac].xrcedocno,g_xrce2_d[l_ac].xrceld, 
                      g_xrce2_d[l_ac].xrcesite,g_xrce2_d[l_ac].xrceseq,g_xrce2_d[l_ac].xrce002,g_xrce2_d[l_ac].xrce006, 
                      g_xrce2_d[l_ac].xrce003,g_xrce2_d[l_ac].xrce004,g_xrce2_d[l_ac].xrce008,g_xrce2_d[l_ac].xrce100, 
                      g_xrce2_d[l_ac].xrce109,g_xrce2_d[l_ac].xrce101,g_xrce2_d[l_ac].xrce119,g_xrce2_d[l_ac].xrce120, 
                      g_xrce2_d[l_ac].xrce121,g_xrce2_d[l_ac].xrce129,g_xrce2_d[l_ac].xrce130,g_xrce2_d[l_ac].xrce131, 
                      g_xrce2_d[l_ac].xrce139,g_xrce3_d[l_ac].xrce001,g_xrce3_d[l_ac].xrcedocno,g_xrce3_d[l_ac].xrceld, 
                      g_xrce3_d[l_ac].xrcesite,g_xrce3_d[l_ac].xrceseq,g_xrce3_d[l_ac].xrce002,g_xrce3_d[l_ac].xrce006, 
                      g_xrce3_d[l_ac].xrce003,g_xrce3_d[l_ac].xrce004,g_xrce3_d[l_ac].xrce005,g_xrce3_d[l_ac].xrce008, 
                      g_xrce3_d[l_ac].xrce100,g_xrce3_d[l_ac].xrce109,g_xrce3_d[l_ac].xrce101,g_xrce3_d[l_ac].xrce119, 
                      g_xrce3_d[l_ac].xrce027,g_xrce3_d[l_ac].xrce010,g_xrce3_d[l_ac].xrce016,g_xrce3_d[l_ac].xrce017, 
                      g_xrce3_d[l_ac].xrce018,g_xrce3_d[l_ac].xrce019,g_xrce3_d[l_ac].xrce020,g_xrce3_d[l_ac].xrce022, 
                      g_xrce3_d[l_ac].xrce023
                  IF SQLCA.sqlcode THEN
                     INITIALIZE g_errparam TO NULL 
                     LET g_errparam.extend = '' 
                     LET g_errparam.code   = SQLCA.sqlcode 
                     LET g_errparam.popup  = TRUE 
                     CALL cl_err()
                     LET l_lock_sw = "Y"
                  END IF
                  
                  #遮罩相關處理
                  LET g_xrce3_d_mask_o[l_ac].* =  g_xrce3_d[l_ac].*
                  CALL axrt300_02_xrce_t_mask()
                  LET g_xrce3_d_mask_n[l_ac].* =  g_xrce3_d[l_ac].*
                  
                  CALL cl_show_fld_cont()
                  CALL axrt300_02_detail_show()
               END IF
            ELSE
               LET l_cmd='a'
            END IF
            #add-point:modify段before row
            {<point name="input.body3.before_row"/>}
            #end add-point  
            #其他table資料備份(確定是否更改用)
            
            #其他table進行lock
            
            
         BEFORE DELETE                            #是否取消單身
            IF l_cmd = 'a' THEN
               LET l_cmd='d'
            ELSE
               #add-point:單身3ask刪除前
               {<point name="input.body3.b_delete_ask">}
               #end add-point 
            
               IF NOT cl_ask_del_detail() THEN
                  CANCEL DELETE
               END IF
               IF l_lock_sw = "Y" THEN
                  INITIALIZE g_errparam TO NULL 
                  LET g_errparam.extend = "" 
                  LET g_errparam.code   = -263 
                  LET g_errparam.popup  = TRUE 
                  CALL cl_err()
                  CANCEL DELETE
               END IF
               
               #add-point:單身3刪除前
               {<point name="input.body3.b_delete" mark="Y"/>}
               #end add-point 
               
               DELETE FROM xrce_t
                WHERE xrceent = g_enterprise AND
                  xrceld = g_xrce3_d_t.xrceld
                  AND xrcedocno = g_xrce3_d_t.xrcedocno
                  AND xrceseq = g_xrce3_d_t.xrceseq
                  
               #add-point:單身3刪除中
               {<point name="input.body3.m_delete"/>}
               #end add-point 
                  
               IF SQLCA.sqlcode THEN
                  INITIALIZE g_errparam TO NULL 
                  LET g_errparam.extend = "xrce_t" 
                  LET g_errparam.code   = SQLCA.sqlcode 
                  LET g_errparam.popup  = TRUE 
                  CALL cl_err()
                  CANCEL DELETE   
               ELSE
                  LET g_detail_cnt = g_detail_cnt-1
                  
                  #add-point:單身3刪除後
                  {<point name="input.body3.a_delete"/>}
                  #end add-point
                  #修改歷程記錄(刪除)
                  CALL axrt300_02_set_pk_array()
                  IF NOT cl_log_modified_record('','') THEN 
                  ELSE
                  END IF
               END IF 
               CLOSE axrt300_02_bcl
               #add-point:單身3刪除關閉bcl
               {<point name="input.body3.close"/>}
               #end add-point
               LET l_count = g_xrce_d.getLength()
                              INITIALIZE gs_keys TO NULL 
               LET gs_keys[1] = g_xrce3_d_t.xrceld
               LET gs_keys[2] = g_xrce3_d_t.xrcedocno
               LET gs_keys[3] = g_xrce3_d_t.xrceseq
 
               #應用 a47 樣板自動產生(Version:2)
      #刪除相關文件
      CALL axrt300_02_set_pk_array()
      #add-point:相關文件刪除前
      {<point name="delete.befroe.related_document_remove"/>}
      #end add-point   
      CALL cl_doc_remove()  
 
 
 
            END IF 
            
         AFTER DELETE 
            IF l_cmd <> 'd' THEN
               #add-point:單身刪除後2
               {<point name="input.body3.after_delete"/>}
               #end add-point
                              CALL axrt300_02_delete_b('xrce_t',gs_keys,"'3'")
            END IF
            #如果是最後一筆
            IF l_ac = (g_xrce3_d.getLength() + 1) THEN
               CALL FGL_SET_ARR_CURR(l_ac-1)
            END IF
 
         AFTER INSERT    
            IF INT_FLAG THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = '' 
               LET g_errparam.code   = 9001 
               LET g_errparam.popup  = FALSE 
               CALL cl_err()
               LET INT_FLAG = 0
               CANCEL INSERT
            END IF
               
            LET l_count = 1  
            SELECT COUNT(*) INTO l_count FROM xrce_t 
             WHERE xrceent = g_enterprise AND
                   xrceld = g_xrce3_d[l_ac].xrceld
                   AND xrcedocno = g_xrce3_d[l_ac].xrcedocno
                   AND xrceseq = g_xrce3_d[l_ac].xrceseq
                
            #資料未重複, 插入新增資料
            IF l_count = 0 THEN 
               #add-point:單身3新增前
               {<point name="input.body3.b_insert"/>}
               #end add-point
            
                              INITIALIZE gs_keys TO NULL 
               LET gs_keys[1] = g_xrce3_d[g_detail_idx].xrceld
               LET gs_keys[2] = g_xrce3_d[g_detail_idx].xrcedocno
               LET gs_keys[3] = g_xrce3_d[g_detail_idx].xrceseq
               CALL axrt300_02_insert_b('xrce_t',gs_keys,"'3'")
                           
               #add-point:單身新增後3
               {<point name="input.body3.a_insert"/>}
               #end add-point
            ELSE    
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = 'INSERT' 
               LET g_errparam.code   = "std-00006" 
               LET g_errparam.popup  = TRUE 
               CALL cl_err()
               INITIALIZE g_xrce_d[l_ac].* TO NULL
               CANCEL INSERT
            END IF
 
            IF SQLCA.SQLcode  THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = "xrce_t" 
               LET g_errparam.code   = SQLCA.sqlcode 
               LET g_errparam.popup  = TRUE 
               CALL cl_err()
               CANCEL INSERT
            ELSE
               #先刷新資料
               #CALL axrt300_02_b_fill(g_wc2)
               #資料多語言用-增/改
               
               #add-point:單身新增後
               {<point name="input.body3.after_insert"/>}
               #end add-point
               ##ERROR 'INSERT O.K'
               LET g_detail_cnt = g_detail_cnt + 1
               LET g_wc2 = g_wc2, " OR (xrceld = '", g_xrce3_d[l_ac].xrceld, "' "
                                  ," AND xrcedocno = '", g_xrce3_d[l_ac].xrcedocno, "' "
                                  ," AND xrceseq = '", g_xrce3_d[l_ac].xrceseq, "' "
                                  ,")"
            END IF
            
         ON ROW CHANGE 
            IF INT_FLAG THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = '' 
               LET g_errparam.code   = 9001 
               LET g_errparam.popup  = FALSE 
               CALL cl_err()
               LET INT_FLAG = 0
               LET g_xrce3_d[l_ac].* = g_xrce3_d_t.*
               CLOSE axrt300_02_bcl
               #add-point:單身page3取消後
               {<point name="input.body3.cancel"/>}
               #end add-point
               EXIT DIALOG 
            END IF
            
            IF l_lock_sw = 'Y' THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = '' 
               LET g_errparam.code   = -263 
               LET g_errparam.popup  = TRUE 
               CALL cl_err()
               LET g_xrce3_d[l_ac].* = g_xrce3_d_t.*
            ELSE
               
               #寫入修改者/修改日期資訊(單身3)
               
               
               #add-point:單身page3修改前
               {<point name="input.body3.b_update" mark="Y"/>}
               #end add-point
               
               #將遮罩欄位還原
               CALL axrt300_02_xrce_t_mask_restore('restore_mask_o')
               
               UPDATE xrce_t SET (xrce001,xrcedocno,xrceld,xrcesite,xrceseq,xrce002,xrce006,xrce003, 
                   xrce004,xrce005,xrce024,xrce025,xrce008,xrce015,xrce100,xrce101,xrce109,xrce119,xrce027, 
                   xrce028,xrce104,xrce114,xrce124,xrce134,xrcecomp,xrceorga,xrce010,xrce016,xrce120, 
                   xrce121,xrce129,xrce130,xrce131,xrce139,xrce017,xrce018,xrce019,xrce020,xrce022,xrce023) = (g_xrce_d[l_ac].xrce001, 
                   g_xrce_d[l_ac].xrcedocno,g_xrce_d[l_ac].xrceld,g_xrce_d[l_ac].xrcesite,g_xrce_d[l_ac].xrceseq, 
                   g_xrce_d[l_ac].xrce002,g_xrce_d[l_ac].xrce006,g_xrce_d[l_ac].xrce003,g_xrce_d[l_ac].xrce004, 
                   g_xrce_d[l_ac].xrce005,g_xrce_d[l_ac].xrce024,g_xrce_d[l_ac].xrce025,g_xrce_d[l_ac].xrce008, 
                   g_xrce_d[l_ac].xrce015,g_xrce_d[l_ac].xrce100,g_xrce_d[l_ac].xrce101,g_xrce_d[l_ac].xrce109, 
                   g_xrce_d[l_ac].xrce119,g_xrce_d[l_ac].xrce027,g_xrce_d[l_ac].xrce028,g_xrce_d[l_ac].xrce104, 
                   g_xrce_d[l_ac].xrce114,g_xrce_d[l_ac].xrce124,g_xrce_d[l_ac].xrce134,g_xrce_d[l_ac].xrcecomp, 
                   g_xrce_d[l_ac].xrceorga,g_xrce_d[l_ac].xrce010,g_xrce_d[l_ac].xrce016,g_xrce2_d[l_ac].xrce120, 
                   g_xrce2_d[l_ac].xrce121,g_xrce2_d[l_ac].xrce129,g_xrce2_d[l_ac].xrce130,g_xrce2_d[l_ac].xrce131, 
                   g_xrce2_d[l_ac].xrce139,g_xrce3_d[l_ac].xrce017,g_xrce3_d[l_ac].xrce018,g_xrce3_d[l_ac].xrce019, 
                   g_xrce3_d[l_ac].xrce020,g_xrce3_d[l_ac].xrce022,g_xrce3_d[l_ac].xrce023) #自訂欄位頁簽 

                WHERE xrceent = g_enterprise AND
                  xrceld = g_xrce3_d_t.xrceld #項次 
                  AND xrcedocno = g_xrce3_d_t.xrcedocno
                  AND xrceseq = g_xrce3_d_t.xrceseq
                  
               #add-point:單身page3修改中
               {<point name="input.body3.m_update"/>}
               #end add-point
                  
               CASE
                  WHEN SQLCA.sqlerrd[3] = 0  #更新不到的處理
                     INITIALIZE g_errparam TO NULL 
                     LET g_errparam.extend = "xrce_t" 
                     LET g_errparam.code   = "std-00009" 
                     LET g_errparam.popup  = TRUE 
                     CALL cl_err()
                  WHEN SQLCA.sqlcode #其他錯誤
                     INITIALIZE g_errparam TO NULL 
                     LET g_errparam.extend = "xrce_t" 
                     LET g_errparam.code   = SQLCA.sqlcode 
                     LET g_errparam.popup  = TRUE 
                     CALL cl_err()
                  OTHERWISE
                                    INITIALIZE gs_keys TO NULL 
               LET gs_keys[1] = g_xrce3_d[g_detail_idx].xrceld
               LET gs_keys_bak[1] = g_xrce3_d_t.xrceld
               LET gs_keys[2] = g_xrce3_d[g_detail_idx].xrcedocno
               LET gs_keys_bak[2] = g_xrce3_d_t.xrcedocno
               LET gs_keys[3] = g_xrce3_d[g_detail_idx].xrceseq
               LET gs_keys_bak[3] = g_xrce3_d_t.xrceseq
               CALL axrt300_02_update_b('xrce_t',gs_keys,gs_keys_bak,"'3'")
                     #資料多語言用-增/改
                     
                     
                     #修改歷程記錄(修改)
                     LET g_log1 = util.JSON.stringify(g_xrce3_d_t)
                     LET g_log2 = util.JSON.stringify(g_xrce3_d[l_ac])
                     IF NOT cl_log_modified_record(g_log1,g_log2) THEN 
                     END IF
               END CASE
               
               #將遮罩欄位進行遮蔽
               CALL axrt300_02_xrce_t_mask_restore('restore_mask_n')
               
               #add-point:單身page3修改後
               {<point name="input.body3.a_update"/>}
               #end add-point
            END IF
         
                  #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce001_u
            #add-point:BEFORE FIELD xrce001_u
            {<point name="input.b.page3.xrce001_u" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce001_u
            
            #add-point:AFTER FIELD xrce001_u
            {<point name="input.a.page3.xrce001_u" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xrce001_u
            #add-point:ON CHANGE xrce001_u
            {<point name="input.g.page3.xrce001_u" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrcedocno_u
            #add-point:BEFORE FIELD xrcedocno_u
            {<point name="input.b.page3.xrcedocno_u" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrcedocno_u
            
            #add-point:AFTER FIELD xrcedocno_u
            {<point name="input.a.page3.xrcedocno_u" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xrcedocno_u
            #add-point:ON CHANGE xrcedocno_u
            {<point name="input.g.page3.xrcedocno_u" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrceld_u
            #add-point:BEFORE FIELD xrceld_u
            {<point name="input.b.page3.xrceld_u" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrceld_u
            
            #add-point:AFTER FIELD xrceld_u
            {<point name="input.a.page3.xrceld_u" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xrceld_u
            #add-point:ON CHANGE xrceld_u
            {<point name="input.g.page3.xrceld_u" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrcesite_u
            #add-point:BEFORE FIELD xrcesite_u
            {<point name="input.b.page3.xrcesite_u" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrcesite_u
            
            #add-point:AFTER FIELD xrcesite_u
            {<point name="input.a.page3.xrcesite_u" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xrcesite_u
            #add-point:ON CHANGE xrcesite_u
            {<point name="input.g.page3.xrcesite_u" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrceseq_u
            #add-point:BEFORE FIELD xrceseq_u
            {<point name="input.b.page3.xrceseq_u" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrceseq_u
            
            #add-point:AFTER FIELD xrceseq_u
            {<point name="input.a.page3.xrceseq_u" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xrceseq_u
            #add-point:ON CHANGE xrceseq_u
            {<point name="input.g.page3.xrceseq_u" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce002_u
            #add-point:BEFORE FIELD xrce002_u
            {<point name="input.b.page3.xrce002_u" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce002_u
            
            #add-point:AFTER FIELD xrce002_u
            {<point name="input.a.page3.xrce002_u" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xrce002_u
            #add-point:ON CHANGE xrce002_u
            {<point name="input.g.page3.xrce002_u" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce006_u
            #add-point:BEFORE FIELD xrce006_u
            {<point name="input.b.page3.xrce006_u" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce006_u
            
            #add-point:AFTER FIELD xrce006_u
            {<point name="input.a.page3.xrce006_u" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xrce006_u
            #add-point:ON CHANGE xrce006_u
            {<point name="input.g.page3.xrce006_u" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce003_u
            #add-point:BEFORE FIELD xrce003_u
            {<point name="input.b.page3.xrce003_u" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce003_u
            
            #add-point:AFTER FIELD xrce003_u
            {<point name="input.a.page3.xrce003_u" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xrce003_u
            #add-point:ON CHANGE xrce003_u
            {<point name="input.g.page3.xrce003_u" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce004_u
            #add-point:BEFORE FIELD xrce004_u
            {<point name="input.b.page3.xrce004_u" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce004_u
            
            #add-point:AFTER FIELD xrce004_u
            {<point name="input.a.page3.xrce004_u" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xrce004_u
            #add-point:ON CHANGE xrce004_u
            {<point name="input.g.page3.xrce004_u" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce005_u
            #add-point:BEFORE FIELD xrce005_u
            {<point name="input.b.page3.xrce005_u" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce005_u
            
            #add-point:AFTER FIELD xrce005_u
            {<point name="input.a.page3.xrce005_u" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xrce005_u
            #add-point:ON CHANGE xrce005_u
            {<point name="input.g.page3.xrce005_u" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce008_u
            #add-point:BEFORE FIELD xrce008_u
            {<point name="input.b.page3.xrce008_u" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce008_u
            
            #add-point:AFTER FIELD xrce008_u
            {<point name="input.a.page3.xrce008_u" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xrce008_u
            #add-point:ON CHANGE xrce008_u
            {<point name="input.g.page3.xrce008_u" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce100_u
            #add-point:BEFORE FIELD xrce100_u
            {<point name="input.b.page3.xrce100_u" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce100_u
            
            #add-point:AFTER FIELD xrce100_u
            {<point name="input.a.page3.xrce100_u" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xrce100_u
            #add-point:ON CHANGE xrce100_u
            {<point name="input.g.page3.xrce100_u" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce109_u
            #add-point:BEFORE FIELD xrce109_u
            {<point name="input.b.page3.xrce109_u" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce109_u
            
            #add-point:AFTER FIELD xrce109_u
            {<point name="input.a.page3.xrce109_u" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xrce109_u
            #add-point:ON CHANGE xrce109_u
            {<point name="input.g.page3.xrce109_u" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce101_u
            #add-point:BEFORE FIELD xrce101_u
            {<point name="input.b.page3.xrce101_u" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce101_u
            
            #add-point:AFTER FIELD xrce101_u
            {<point name="input.a.page3.xrce101_u" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xrce101_u
            #add-point:ON CHANGE xrce101_u
            {<point name="input.g.page3.xrce101_u" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce119_u
            #add-point:BEFORE FIELD xrce119_u
            {<point name="input.b.page3.xrce119_u" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce119_u
            
            #add-point:AFTER FIELD xrce119_u
            {<point name="input.a.page3.xrce119_u" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xrce119_u
            #add-point:ON CHANGE xrce119_u
            {<point name="input.g.page3.xrce119_u" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce027_u
            #add-point:BEFORE FIELD xrce027_u
            {<point name="input.b.page3.xrce027_u" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce027_u
            
            #add-point:AFTER FIELD xrce027_u
            {<point name="input.a.page3.xrce027_u" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xrce027_u
            #add-point:ON CHANGE xrce027_u
            {<point name="input.g.page3.xrce027_u" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce010_u
            #add-point:BEFORE FIELD xrce010_u
            {<point name="input.b.page3.xrce010_u" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce010_u
            
            #add-point:AFTER FIELD xrce010_u
            {<point name="input.a.page3.xrce010_u" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xrce010_u
            #add-point:ON CHANGE xrce010_u
            {<point name="input.g.page3.xrce010_u" />}
            #END add-point 
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce016_u
            
            #add-point:AFTER FIELD xrce016_u
            {<point name="input.a.page3.xrce016_u" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce016_u
            #add-point:BEFORE FIELD xrce016_u
            {<point name="input.b.page3.xrce016_u" />}
            #END add-point
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xrce016_u
            #add-point:ON CHANGE xrce016_u
            {<point name="input.g.page3.xrce016_u" />}
            #END add-point 
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce017
            
            #add-point:AFTER FIELD xrce017
            {<point name="input.a.page3.xrce017" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce017
            #add-point:BEFORE FIELD xrce017
            {<point name="input.b.page3.xrce017" />}
            #END add-point
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xrce017
            #add-point:ON CHANGE xrce017
            {<point name="input.g.page3.xrce017" />}
            #END add-point 
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce018_u
            
            #add-point:AFTER FIELD xrce018_u
            {<point name="input.a.page3.xrce018_u" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce018_u
            #add-point:BEFORE FIELD xrce018_u
            {<point name="input.b.page3.xrce018_u" />}
            #END add-point
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xrce018_u
            #add-point:ON CHANGE xrce018_u
            {<point name="input.g.page3.xrce018_u" />}
            #END add-point 
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce019
            
            #add-point:AFTER FIELD xrce019
            {<point name="input.a.page3.xrce019" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce019
            #add-point:BEFORE FIELD xrce019
            {<point name="input.b.page3.xrce019" />}
            #END add-point
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xrce019
            #add-point:ON CHANGE xrce019
            {<point name="input.g.page3.xrce019" />}
            #END add-point 
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce020
            
            #add-point:AFTER FIELD xrce020
            {<point name="input.a.page3.xrce020" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce020
            #add-point:BEFORE FIELD xrce020
            {<point name="input.b.page3.xrce020" />}
            #END add-point
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xrce020
            #add-point:ON CHANGE xrce020
            {<point name="input.g.page3.xrce020" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce022
            #add-point:BEFORE FIELD xrce022
            {<point name="input.b.page3.xrce022" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce022
            
            #add-point:AFTER FIELD xrce022
            {<point name="input.a.page3.xrce022" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xrce022
            #add-point:ON CHANGE xrce022
            {<point name="input.g.page3.xrce022" />}
            #END add-point 
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce023
            #add-point:BEFORE FIELD xrce023
            {<point name="input.b.page3.xrce023" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce023
            
            #add-point:AFTER FIELD xrce023
            {<point name="input.a.page3.xrce023" />}
            #END add-point
            
 
         #應用 a04 樣板自動產生(Version:2)
         ON CHANGE xrce023
            #add-point:ON CHANGE xrce023
            {<point name="input.g.page3.xrce023" />}
            #END add-point 
 
 
                  #Ctrlp:input.c.page3.xrce001_u
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce001_u
            #add-point:ON ACTION controlp INFIELD xrce001_u
            {<point name="input.c.page3.xrce001_u" />}
            #END add-point
 
         #Ctrlp:input.c.page3.xrcedocno_u
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrcedocno_u
            #add-point:ON ACTION controlp INFIELD xrcedocno_u
            {<point name="input.c.page3.xrcedocno_u" />}
            #END add-point
 
         #Ctrlp:input.c.page3.xrceld_u
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrceld_u
            #add-point:ON ACTION controlp INFIELD xrceld_u
            {<point name="input.c.page3.xrceld_u" />}
            #END add-point
 
         #Ctrlp:input.c.page3.xrcesite_u
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrcesite_u
            #add-point:ON ACTION controlp INFIELD xrcesite_u
            {<point name="input.c.page3.xrcesite_u" />}
            #END add-point
 
         #Ctrlp:input.c.page3.xrceseq_u
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrceseq_u
            #add-point:ON ACTION controlp INFIELD xrceseq_u
            {<point name="input.c.page3.xrceseq_u" />}
            #END add-point
 
         #Ctrlp:input.c.page3.xrce002_u
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce002_u
            #add-point:ON ACTION controlp INFIELD xrce002_u
            {<point name="input.c.page3.xrce002_u" />}
            #END add-point
 
         #Ctrlp:input.c.page3.xrce006_u
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce006_u
            #add-point:ON ACTION controlp INFIELD xrce006_u
            {<point name="input.c.page3.xrce006_u" />}
            #END add-point
 
         #Ctrlp:input.c.page3.xrce003_u
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce003_u
            #add-point:ON ACTION controlp INFIELD xrce003_u
            {<point name="input.c.page3.xrce003_u" />}
            #END add-point
 
         #Ctrlp:input.c.page3.xrce004_u
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce004_u
            #add-point:ON ACTION controlp INFIELD xrce004_u
            {<point name="input.c.page3.xrce004_u" />}
            #END add-point
 
         #Ctrlp:input.c.page3.xrce005_u
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce005_u
            #add-point:ON ACTION controlp INFIELD xrce005_u
            {<point name="input.c.page3.xrce005_u" />}
            #END add-point
 
         #Ctrlp:input.c.page3.xrce008_u
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce008_u
            #add-point:ON ACTION controlp INFIELD xrce008_u
            {<point name="input.c.page3.xrce008_u" />}
            #END add-point
 
         #Ctrlp:input.c.page3.xrce100_u
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce100_u
            #add-point:ON ACTION controlp INFIELD xrce100_u
            {<point name="input.c.page3.xrce100_u" />}
            #END add-point
 
         #Ctrlp:input.c.page3.xrce109_u
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce109_u
            #add-point:ON ACTION controlp INFIELD xrce109_u
            {<point name="input.c.page3.xrce109_u" />}
            #END add-point
 
         #Ctrlp:input.c.page3.xrce101_u
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce101_u
            #add-point:ON ACTION controlp INFIELD xrce101_u
            {<point name="input.c.page3.xrce101_u" />}
            #END add-point
 
         #Ctrlp:input.c.page3.xrce119_u
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce119_u
            #add-point:ON ACTION controlp INFIELD xrce119_u
            {<point name="input.c.page3.xrce119_u" />}
            #END add-point
 
         #Ctrlp:input.c.page3.xrce027_u
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce027_u
            #add-point:ON ACTION controlp INFIELD xrce027_u
            {<point name="input.c.page3.xrce027_u" />}
            #END add-point
 
         #Ctrlp:input.c.page3.xrce010_u
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce010_u
            #add-point:ON ACTION controlp INFIELD xrce010_u
            {<point name="input.c.page3.xrce010_u" />}
            #END add-point
 
         #Ctrlp:input.c.page3.xrce016_u
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce016_u
            #add-point:ON ACTION controlp INFIELD xrce016_u
            {<point name="input.c.page3.xrce016_u" />}
            #END add-point
 
         #Ctrlp:input.c.page3.xrce017
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce017
            #add-point:ON ACTION controlp INFIELD xrce017
            {<point name="input.c.page3.xrce017" />}
            #END add-point
 
         #Ctrlp:input.c.page3.xrce018_u
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce018_u
            #add-point:ON ACTION controlp INFIELD xrce018_u
            {<point name="input.c.page3.xrce018_u" />}
            #END add-point
 
         #Ctrlp:input.c.page3.xrce019
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce019
            #add-point:ON ACTION controlp INFIELD xrce019
            {<point name="input.c.page3.xrce019" />}
            #END add-point
 
         #Ctrlp:input.c.page3.xrce020
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce020
            #add-point:ON ACTION controlp INFIELD xrce020
            {<point name="input.c.page3.xrce020" />}
            #END add-point
 
         #Ctrlp:input.c.page3.xrce022
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce022
            #add-point:ON ACTION controlp INFIELD xrce022
            {<point name="input.c.page3.xrce022" />}
            #END add-point
 
         #Ctrlp:input.c.page3.xrce023
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce023
            #add-point:ON ACTION controlp INFIELD xrce023
            {<point name="input.c.page3.xrce023" />}
            #END add-point
 
 
 
         AFTER ROW
            LET l_ac = ARR_CURR()
            LET l_ac_t = l_ac
            IF INT_FLAG THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = '' 
               LET g_errparam.code   = 9001 
               LET g_errparam.popup  = FALSE 
               CALL cl_err()
               LET INT_FLAG = 0
               IF l_cmd = 'u' THEN
                  LET g_xrce3_d[l_ac].* = g_xrce3_d_t.*
               END IF
               CLOSE axrt300_02_bcl
               #add-point:單身after row
               {<point name="input.body3.a_close"/>}
               #end add-point
               EXIT DIALOG 
            END IF
            
            #其他table進行unlock
            
 
            CALL axrt300_02_unlock_b("xrce_t")
            #add-point:單身after row
            {<point name="input.body3.a_row"/>}
            #end add-point
            
         AFTER INPUT
            #add-point:單身3input後
            {<point name="input.body3.a_input"/>}
            #end add-point
         
         #複製上一次指定的單身資料至最下方
         ON ACTION controlo   
            CALL FGL_SET_ARR_CURR(g_xrce3_d.getLength()+1)
            LET lb_reproduce = TRUE
            LET li_reproduce = l_ac
            LET li_reproduce_target = g_xrce3_d.getLength()+1
 
      END INPUT
 
      
 
      
      #add-point:before_more_input
      {<point name="input.more_input"/>}
      #end add-point
      
      BEFORE DIALOG
         #CALL cl_err_collect_init()      
         IF g_temp_idx > 0 THEN
            LET l_ac = g_temp_idx
            CALL DIALOG.setCurrentRow("s_detail1",l_ac)
            LET g_temp_idx = 1
         END IF
         #LET g_curr_diag = ui.DIALOG.getCurrent()
         #add-point:before_dialog
         {<point name="input.before_dialog"/>}
         #end add-point
         CASE g_aw
            WHEN "s_detail1"
               NEXT FIELD xrce001
            WHEN "s_detail2"
               NEXT FIELD xrce001
            WHEN "s_detail3"
               NEXT FIELD xrce001
 
         END CASE
   
      ON ACTION accept
         ACCEPT DIALOG
      
      ON ACTION cancel
         LET INT_FLAG = TRUE 
         CANCEL DIALOG
 
      ON ACTION controlr
         CALL cl_show_req_fields()
 
      ON ACTION controlf
         CALL cl_set_focus_form(ui.Interface.getRootNode()) 
              RETURNING g_fld_name,g_frm_name 
         CALL cl_fldhelp(g_frm_name,g_fld_name,g_lang) 
           
      #交談指令共用ACTION
      &include "common_action.4gl"
         CONTINUE DIALOG
   
   END DIALOG 
    
   #新增後取消
   IF l_cmd = 'a' THEN
      #當取消或無輸入資料按確定時刪除對應資料
      IF INT_FLAG OR cl_null(g_xrce_d[g_detail_idx].xrceld) THEN
         CALL g_xrce_d.deleteElement(g_detail_idx)
         CALL g_xrce2_d.deleteElement(g_detail_idx)
         CALL g_xrce3_d.deleteElement(g_detail_idx)
 
      END IF
   END IF
   
   #修改後取消
   IF l_cmd = 'u' AND INT_FLAG THEN
      LET g_xrce_d[g_detail_idx].* = g_xrce_d_t.*
   END IF
   
   #add-point:modify段修改後
   {<point name="modify.after_input"/>}
   #end add-point
 
   CLOSE axrt300_02_bcl
   
END FUNCTION
]]>
  </section>
  <section id="axrt300_02.modify_detail_chk" ver="6" status="" src="s" readonly="">
    <![CDATA[#+ 單身輸入判定(因應modify_detail)
PRIVATE FUNCTION axrt300_02_modify_detail_chk(ps_record)
   DEFINE ps_record STRING
   DEFINE ls_return STRING
   #add-point:modify_detail_chk段define
   {<point name="modify_detail_chk.define" edit="s"/>}
   #end add-point
   #add-point:modify_detail_chk段define(客製用)
   {<point name="modify_detail_chk.define_customerization" edit="c"/>}
   #end add-point
   
   #add-point:modify_detail_chk段開始前
   {<point name="modify_detail_chk.before"/>}
   #end add-point
   
   #根據sr名稱確定該page第一個欄位的名稱
   CASE ps_record
      WHEN "s_detail1" 
         LET ls_return = "xrce001"
      WHEN "s_detail2"
         LET ls_return = "xrce001"
      WHEN "s_detail3"
         LET ls_return = "xrce001"
 
      #add-point:modify_detail_chk段自訂page控制
      {<point name="modify_detail_chk.page_control"/>}
      #end add-point
   END CASE
    
   #add-point:modify_detail_chk段結束前
   {<point name="modify_detail_chk.after"/>}
   #end add-point
   
   RETURN ls_return
   
END FUNCTION
]]>
  </section>
  <section id="axrt300_02.other_dialog" ver="1" status="" src="s" readonly="">
    <![CDATA[{<point name="other.dialog"/>}
]]>
  </section>
  <section id="axrt300_02.other_function" ver="2" status="" src="s" readonly="">
    <![CDATA[{<point name="other.function"/>}
]]>
  </section>
  <section id="axrt300_02.query" ver="25" status="" src="s" readonly="">
    <![CDATA[#+ QBE資料查詢
PRIVATE FUNCTION axrt300_02_query()
   DEFINE ls_wc      LIKE type_t.chr500
   DEFINE ls_return  STRING
   DEFINE ls_result  STRING 
   #add-point:query段define
   {<point name="query.define" edit="s"/>}
   #end add-point 
   #add-point:query段define(客製用)
   {<point name="query.define_customerization" edit="c"/>}
   #end add-point
   
   LET INT_FLAG = 0
   CLEAR FORM
   CALL g_xrce_d.clear()
   
   LET g_qryparam.state = "c"
   
   #wc備份
   LET ls_wc = g_wc2
   
   DIALOG ATTRIBUTES(UNBUFFERED,FIELD ORDER FORM)
 
      CONSTRUCT g_wc2 ON xrce001,xrcedocno,xrceld,xrcesite,xrceseq,xrce002,xrce006,xrde007,xrde007_desc, 
          xrce003,xrce004,xrce005,xrce024,xrce025,xrce008,xrce015,xrce100,xrce101,xrce109,xrce119,xrce027, 
          xrce028,xrce104,xrce114,xrce124,xrce134,xrcecomp,xrceorga,xrce010,xrce016,xrce016_desc_1,xrde012_u, 
          xrde012_u_desc,xrce001_t,xrcedocno_t,xrceld_t,xrcesite_t,xrceseq_t,xrce002_t,xrce006_t,xrce003_t, 
          xrce004_t,xrce008_t,xrce100_t,xrce109_t,xrce101_t,xrce119_t,xrce120,xrce121,xrce129,xrce130, 
          xrce131,xrce139,xrce001_u,xrcedocno_u,xrceld_u,xrcesite_u,xrceseq_u,xrce002_u,xrce006_u,xrce003_u, 
          xrce004_u,xrce005_u,xrce008_u,xrce100_u,xrce109_u,xrce101_u,xrce119_u,xrce027_u,xrce010_u, 
          xrce016_u,xrce016_u_desc,xrce017,xrce018_u,xrce019,xrce020,xrce022,xrce023 
 
         FROM s_detail1[1].xrce001,s_detail1[1].xrcedocno,s_detail1[1].xrceld,s_detail1[1].xrcesite, 
             s_detail1[1].xrceseq,s_detail1[1].xrce002,s_detail1[1].xrce006,s_detail1[1].xrde007,s_detail1[1].xrde007_desc, 
             s_detail1[1].xrce003,s_detail1[1].xrce004,s_detail1[1].xrce005,s_detail1[1].xrce024,s_detail1[1].xrce025, 
             s_detail1[1].xrce008,s_detail1[1].xrce015,s_detail1[1].xrce100,s_detail1[1].xrce101,s_detail1[1].xrce109, 
             s_detail1[1].xrce119,s_detail1[1].xrce027,s_detail1[1].xrce028,s_detail1[1].xrce104,s_detail1[1].xrce114, 
             s_detail1[1].xrce124,s_detail1[1].xrce134,s_detail1[1].xrcecomp,s_detail1[1].xrceorga,s_detail1[1].xrce010, 
             s_detail1[1].xrce016,s_detail1[1].xrce016_desc_1,s_detail1[1].xrde012_u,s_detail1[1].xrde012_u_desc, 
             s_detail2[1].xrce001_t,s_detail2[1].xrcedocno_t,s_detail2[1].xrceld_t,s_detail2[1].xrcesite_t, 
             s_detail2[1].xrceseq_t,s_detail2[1].xrce002_t,s_detail2[1].xrce006_t,s_detail2[1].xrce003_t, 
             s_detail2[1].xrce004_t,s_detail2[1].xrce008_t,s_detail2[1].xrce100_t,s_detail2[1].xrce109_t, 
             s_detail2[1].xrce101_t,s_detail2[1].xrce119_t,s_detail2[1].xrce120,s_detail2[1].xrce121, 
             s_detail2[1].xrce129,s_detail2[1].xrce130,s_detail2[1].xrce131,s_detail2[1].xrce139,s_detail3[1].xrce001_u, 
             s_detail3[1].xrcedocno_u,s_detail3[1].xrceld_u,s_detail3[1].xrcesite_u,s_detail3[1].xrceseq_u, 
             s_detail3[1].xrce002_u,s_detail3[1].xrce006_u,s_detail3[1].xrce003_u,s_detail3[1].xrce004_u, 
             s_detail3[1].xrce005_u,s_detail3[1].xrce008_u,s_detail3[1].xrce100_u,s_detail3[1].xrce109_u, 
             s_detail3[1].xrce101_u,s_detail3[1].xrce119_u,s_detail3[1].xrce027_u,s_detail3[1].xrce010_u, 
             s_detail3[1].xrce016_u,s_detail3[1].xrce016_u_desc,s_detail3[1].xrce017,s_detail3[1].xrce018_u, 
             s_detail3[1].xrce019,s_detail3[1].xrce020,s_detail3[1].xrce022,s_detail3[1].xrce023 
      
         
      
                  #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce001
            #add-point:BEFORE FIELD xrce001
            {<point name="query.b.page1.xrce001" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce001
            
            #add-point:AFTER FIELD xrce001
            {<point name="query.a.page1.xrce001" />}
            #END add-point
            
 
         #Ctrlp:query.c.page1.xrce001
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce001
            #add-point:ON ACTION controlp INFIELD xrce001
            {<point name="query.c.page1.xrce001" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrcedocno
            #add-point:BEFORE FIELD xrcedocno
            {<point name="query.b.page1.xrcedocno" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrcedocno
            
            #add-point:AFTER FIELD xrcedocno
            {<point name="query.a.page1.xrcedocno" />}
            #END add-point
            
 
         #Ctrlp:query.c.page1.xrcedocno
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrcedocno
            #add-point:ON ACTION controlp INFIELD xrcedocno
            {<point name="query.c.page1.xrcedocno" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrceld
            #add-point:BEFORE FIELD xrceld
            {<point name="query.b.page1.xrceld" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrceld
            
            #add-point:AFTER FIELD xrceld
            {<point name="query.a.page1.xrceld" />}
            #END add-point
            
 
         #Ctrlp:query.c.page1.xrceld
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrceld
            #add-point:ON ACTION controlp INFIELD xrceld
            {<point name="query.c.page1.xrceld" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrcesite
            #add-point:BEFORE FIELD xrcesite
            {<point name="query.b.page1.xrcesite" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrcesite
            
            #add-point:AFTER FIELD xrcesite
            {<point name="query.a.page1.xrcesite" />}
            #END add-point
            
 
         #Ctrlp:query.c.page1.xrcesite
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrcesite
            #add-point:ON ACTION controlp INFIELD xrcesite
            {<point name="query.c.page1.xrcesite" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrceseq
            #add-point:BEFORE FIELD xrceseq
            {<point name="query.b.page1.xrceseq" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrceseq
            
            #add-point:AFTER FIELD xrceseq
            {<point name="query.a.page1.xrceseq" />}
            #END add-point
            
 
         #Ctrlp:query.c.page1.xrceseq
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrceseq
            #add-point:ON ACTION controlp INFIELD xrceseq
            {<point name="query.c.page1.xrceseq" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce002
            #add-point:BEFORE FIELD xrce002
            {<point name="query.b.page1.xrce002" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce002
            
            #add-point:AFTER FIELD xrce002
            {<point name="query.a.page1.xrce002" />}
            #END add-point
            
 
         #Ctrlp:query.c.page1.xrce002
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce002
            #add-point:ON ACTION controlp INFIELD xrce002
            {<point name="query.c.page1.xrce002" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce006
            #add-point:BEFORE FIELD xrce006
            {<point name="query.b.page1.xrce006" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce006
            
            #add-point:AFTER FIELD xrce006
            {<point name="query.a.page1.xrce006" />}
            #END add-point
            
 
         #Ctrlp:query.c.page1.xrce006
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce006
            #add-point:ON ACTION controlp INFIELD xrce006
            {<point name="query.c.page1.xrce006" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrde007
            #add-point:BEFORE FIELD xrde007
            {<point name="query.b.page1.xrde007" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrde007
            
            #add-point:AFTER FIELD xrde007
            {<point name="query.a.page1.xrde007" />}
            #END add-point
            
 
         #Ctrlp:query.c.page1.xrde007
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrde007
            #add-point:ON ACTION controlp INFIELD xrde007
            {<point name="query.c.page1.xrde007" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrde007_desc
            #add-point:BEFORE FIELD xrde007_desc
            {<point name="query.b.page1.xrde007_desc" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrde007_desc
            
            #add-point:AFTER FIELD xrde007_desc
            {<point name="query.a.page1.xrde007_desc" />}
            #END add-point
            
 
         #Ctrlp:query.c.page1.xrde007_desc
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrde007_desc
            #add-point:ON ACTION controlp INFIELD xrde007_desc
            {<point name="query.c.page1.xrde007_desc" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce003
            #add-point:BEFORE FIELD xrce003
            {<point name="query.b.page1.xrce003" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce003
            
            #add-point:AFTER FIELD xrce003
            {<point name="query.a.page1.xrce003" />}
            #END add-point
            
 
         #Ctrlp:query.c.page1.xrce003
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce003
            #add-point:ON ACTION controlp INFIELD xrce003
            {<point name="query.c.page1.xrce003" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce004
            #add-point:BEFORE FIELD xrce004
            {<point name="query.b.page1.xrce004" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce004
            
            #add-point:AFTER FIELD xrce004
            {<point name="query.a.page1.xrce004" />}
            #END add-point
            
 
         #Ctrlp:query.c.page1.xrce004
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce004
            #add-point:ON ACTION controlp INFIELD xrce004
            {<point name="query.c.page1.xrce004" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce005
            #add-point:BEFORE FIELD xrce005
            {<point name="query.b.page1.xrce005" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce005
            
            #add-point:AFTER FIELD xrce005
            {<point name="query.a.page1.xrce005" />}
            #END add-point
            
 
         #Ctrlp:query.c.page1.xrce005
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce005
            #add-point:ON ACTION controlp INFIELD xrce005
            {<point name="query.c.page1.xrce005" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce024
            #add-point:BEFORE FIELD xrce024
            {<point name="query.b.page1.xrce024" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce024
            
            #add-point:AFTER FIELD xrce024
            {<point name="query.a.page1.xrce024" />}
            #END add-point
            
 
         #Ctrlp:query.c.page1.xrce024
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce024
            #add-point:ON ACTION controlp INFIELD xrce024
            {<point name="query.c.page1.xrce024" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce025
            #add-point:BEFORE FIELD xrce025
            {<point name="query.b.page1.xrce025" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce025
            
            #add-point:AFTER FIELD xrce025
            {<point name="query.a.page1.xrce025" />}
            #END add-point
            
 
         #Ctrlp:query.c.page1.xrce025
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce025
            #add-point:ON ACTION controlp INFIELD xrce025
            {<point name="query.c.page1.xrce025" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce008
            #add-point:BEFORE FIELD xrce008
            {<point name="query.b.page1.xrce008" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce008
            
            #add-point:AFTER FIELD xrce008
            {<point name="query.a.page1.xrce008" />}
            #END add-point
            
 
         #Ctrlp:query.c.page1.xrce008
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce008
            #add-point:ON ACTION controlp INFIELD xrce008
            {<point name="query.c.page1.xrce008" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce015
            #add-point:BEFORE FIELD xrce015
            {<point name="query.b.page1.xrce015" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce015
            
            #add-point:AFTER FIELD xrce015
            {<point name="query.a.page1.xrce015" />}
            #END add-point
            
 
         #Ctrlp:query.c.page1.xrce015
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce015
            #add-point:ON ACTION controlp INFIELD xrce015
            {<point name="query.c.page1.xrce015" />}
            #END add-point
 
         #Ctrlp:construct.c.page1.xrce100
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce100
            #add-point:ON ACTION controlp INFIELD xrce100
            {<point name="construct.c.page1.xrce100" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce100
            #add-point:BEFORE FIELD xrce100
            {<point name="query.b.page1.xrce100" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce100
            
            #add-point:AFTER FIELD xrce100
            {<point name="query.a.page1.xrce100" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce101
            #add-point:BEFORE FIELD xrce101
            {<point name="query.b.page1.xrce101" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce101
            
            #add-point:AFTER FIELD xrce101
            {<point name="query.a.page1.xrce101" />}
            #END add-point
            
 
         #Ctrlp:query.c.page1.xrce101
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce101
            #add-point:ON ACTION controlp INFIELD xrce101
            {<point name="query.c.page1.xrce101" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce109
            #add-point:BEFORE FIELD xrce109
            {<point name="query.b.page1.xrce109" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce109
            
            #add-point:AFTER FIELD xrce109
            {<point name="query.a.page1.xrce109" />}
            #END add-point
            
 
         #Ctrlp:query.c.page1.xrce109
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce109
            #add-point:ON ACTION controlp INFIELD xrce109
            {<point name="query.c.page1.xrce109" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce119
            #add-point:BEFORE FIELD xrce119
            {<point name="query.b.page1.xrce119" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce119
            
            #add-point:AFTER FIELD xrce119
            {<point name="query.a.page1.xrce119" />}
            #END add-point
            
 
         #Ctrlp:query.c.page1.xrce119
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce119
            #add-point:ON ACTION controlp INFIELD xrce119
            {<point name="query.c.page1.xrce119" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce027
            #add-point:BEFORE FIELD xrce027
            {<point name="query.b.page1.xrce027" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce027
            
            #add-point:AFTER FIELD xrce027
            {<point name="query.a.page1.xrce027" />}
            #END add-point
            
 
         #Ctrlp:query.c.page1.xrce027
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce027
            #add-point:ON ACTION controlp INFIELD xrce027
            {<point name="query.c.page1.xrce027" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce028
            #add-point:BEFORE FIELD xrce028
            {<point name="query.b.page1.xrce028" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce028
            
            #add-point:AFTER FIELD xrce028
            {<point name="query.a.page1.xrce028" />}
            #END add-point
            
 
         #Ctrlp:query.c.page1.xrce028
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce028
            #add-point:ON ACTION controlp INFIELD xrce028
            {<point name="query.c.page1.xrce028" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce104
            #add-point:BEFORE FIELD xrce104
            {<point name="query.b.page1.xrce104" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce104
            
            #add-point:AFTER FIELD xrce104
            {<point name="query.a.page1.xrce104" />}
            #END add-point
            
 
         #Ctrlp:query.c.page1.xrce104
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce104
            #add-point:ON ACTION controlp INFIELD xrce104
            {<point name="query.c.page1.xrce104" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce114
            #add-point:BEFORE FIELD xrce114
            {<point name="query.b.page1.xrce114" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce114
            
            #add-point:AFTER FIELD xrce114
            {<point name="query.a.page1.xrce114" />}
            #END add-point
            
 
         #Ctrlp:query.c.page1.xrce114
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce114
            #add-point:ON ACTION controlp INFIELD xrce114
            {<point name="query.c.page1.xrce114" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce124
            #add-point:BEFORE FIELD xrce124
            {<point name="query.b.page1.xrce124" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce124
            
            #add-point:AFTER FIELD xrce124
            {<point name="query.a.page1.xrce124" />}
            #END add-point
            
 
         #Ctrlp:query.c.page1.xrce124
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce124
            #add-point:ON ACTION controlp INFIELD xrce124
            {<point name="query.c.page1.xrce124" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce134
            #add-point:BEFORE FIELD xrce134
            {<point name="query.b.page1.xrce134" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce134
            
            #add-point:AFTER FIELD xrce134
            {<point name="query.a.page1.xrce134" />}
            #END add-point
            
 
         #Ctrlp:query.c.page1.xrce134
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce134
            #add-point:ON ACTION controlp INFIELD xrce134
            {<point name="query.c.page1.xrce134" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrcecomp
            #add-point:BEFORE FIELD xrcecomp
            {<point name="query.b.page1.xrcecomp" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrcecomp
            
            #add-point:AFTER FIELD xrcecomp
            {<point name="query.a.page1.xrcecomp" />}
            #END add-point
            
 
         #Ctrlp:query.c.page1.xrcecomp
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrcecomp
            #add-point:ON ACTION controlp INFIELD xrcecomp
            {<point name="query.c.page1.xrcecomp" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrceorga
            #add-point:BEFORE FIELD xrceorga
            {<point name="query.b.page1.xrceorga" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrceorga
            
            #add-point:AFTER FIELD xrceorga
            {<point name="query.a.page1.xrceorga" />}
            #END add-point
            
 
         #Ctrlp:query.c.page1.xrceorga
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrceorga
            #add-point:ON ACTION controlp INFIELD xrceorga
            {<point name="query.c.page1.xrceorga" />}
            #END add-point
 
         #Ctrlp:construct.c.page1.xrce010
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce010
            #add-point:ON ACTION controlp INFIELD xrce010
            {<point name="construct.c.page1.xrce010" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce010
            #add-point:BEFORE FIELD xrce010
            {<point name="query.b.page1.xrce010" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce010
            
            #add-point:AFTER FIELD xrce010
            {<point name="query.a.page1.xrce010" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page1.xrce016
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce016
            #add-point:ON ACTION controlp INFIELD xrce016
            {<point name="construct.c.page1.xrce016" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce016
            #add-point:BEFORE FIELD xrce016
            {<point name="query.b.page1.xrce016" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce016
            
            #add-point:AFTER FIELD xrce016
            {<point name="query.a.page1.xrce016" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce016_desc_1
            #add-point:BEFORE FIELD xrce016_desc_1
            {<point name="query.b.page1.xrce016_desc_1" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce016_desc_1
            
            #add-point:AFTER FIELD xrce016_desc_1
            {<point name="query.a.page1.xrce016_desc_1" />}
            #END add-point
            
 
         #Ctrlp:query.c.page1.xrce016_desc_1
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce016_desc_1
            #add-point:ON ACTION controlp INFIELD xrce016_desc_1
            {<point name="query.c.page1.xrce016_desc_1" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrde012_u
            #add-point:BEFORE FIELD xrde012_u
            {<point name="query.b.page1.xrde012_u" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrde012_u
            
            #add-point:AFTER FIELD xrde012_u
            {<point name="query.a.page1.xrde012_u" />}
            #END add-point
            
 
         #Ctrlp:query.c.page1.xrde012_u
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrde012_u
            #add-point:ON ACTION controlp INFIELD xrde012_u
            {<point name="query.c.page1.xrde012_u" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrde012_u_desc
            #add-point:BEFORE FIELD xrde012_u_desc
            {<point name="query.b.page1.xrde012_u_desc" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrde012_u_desc
            
            #add-point:AFTER FIELD xrde012_u_desc
            {<point name="query.a.page1.xrde012_u_desc" />}
            #END add-point
            
 
         #Ctrlp:query.c.page1.xrde012_u_desc
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrde012_u_desc
            #add-point:ON ACTION controlp INFIELD xrde012_u_desc
            {<point name="query.c.page1.xrde012_u_desc" />}
            #END add-point
 
  
         
                  #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce001_t
            #add-point:BEFORE FIELD xrce001_t
            {<point name="query.b.page2.xrce001_t" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce001_t
            
            #add-point:AFTER FIELD xrce001_t
            {<point name="query.a.page2.xrce001_t" />}
            #END add-point
            
 
         #Ctrlp:query.c.page2.xrce001_t
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce001_t
            #add-point:ON ACTION controlp INFIELD xrce001_t
            {<point name="query.c.page2.xrce001_t" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrcedocno_t
            #add-point:BEFORE FIELD xrcedocno_t
            {<point name="query.b.page2.xrcedocno_t" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrcedocno_t
            
            #add-point:AFTER FIELD xrcedocno_t
            {<point name="query.a.page2.xrcedocno_t" />}
            #END add-point
            
 
         #Ctrlp:query.c.page2.xrcedocno_t
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrcedocno_t
            #add-point:ON ACTION controlp INFIELD xrcedocno_t
            {<point name="query.c.page2.xrcedocno_t" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrceld_t
            #add-point:BEFORE FIELD xrceld_t
            {<point name="query.b.page2.xrceld_t" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrceld_t
            
            #add-point:AFTER FIELD xrceld_t
            {<point name="query.a.page2.xrceld_t" />}
            #END add-point
            
 
         #Ctrlp:query.c.page2.xrceld_t
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrceld_t
            #add-point:ON ACTION controlp INFIELD xrceld_t
            {<point name="query.c.page2.xrceld_t" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrcesite_t
            #add-point:BEFORE FIELD xrcesite_t
            {<point name="query.b.page2.xrcesite_t" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrcesite_t
            
            #add-point:AFTER FIELD xrcesite_t
            {<point name="query.a.page2.xrcesite_t" />}
            #END add-point
            
 
         #Ctrlp:query.c.page2.xrcesite_t
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrcesite_t
            #add-point:ON ACTION controlp INFIELD xrcesite_t
            {<point name="query.c.page2.xrcesite_t" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrceseq_t
            #add-point:BEFORE FIELD xrceseq_t
            {<point name="query.b.page2.xrceseq_t" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrceseq_t
            
            #add-point:AFTER FIELD xrceseq_t
            {<point name="query.a.page2.xrceseq_t" />}
            #END add-point
            
 
         #Ctrlp:query.c.page2.xrceseq_t
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrceseq_t
            #add-point:ON ACTION controlp INFIELD xrceseq_t
            {<point name="query.c.page2.xrceseq_t" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce002_t
            #add-point:BEFORE FIELD xrce002_t
            {<point name="query.b.page2.xrce002_t" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce002_t
            
            #add-point:AFTER FIELD xrce002_t
            {<point name="query.a.page2.xrce002_t" />}
            #END add-point
            
 
         #Ctrlp:query.c.page2.xrce002_t
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce002_t
            #add-point:ON ACTION controlp INFIELD xrce002_t
            {<point name="query.c.page2.xrce002_t" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce006_t
            #add-point:BEFORE FIELD xrce006_t
            {<point name="query.b.page2.xrce006_t" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce006_t
            
            #add-point:AFTER FIELD xrce006_t
            {<point name="query.a.page2.xrce006_t" />}
            #END add-point
            
 
         #Ctrlp:query.c.page2.xrce006_t
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce006_t
            #add-point:ON ACTION controlp INFIELD xrce006_t
            {<point name="query.c.page2.xrce006_t" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce003_t
            #add-point:BEFORE FIELD xrce003_t
            {<point name="query.b.page2.xrce003_t" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce003_t
            
            #add-point:AFTER FIELD xrce003_t
            {<point name="query.a.page2.xrce003_t" />}
            #END add-point
            
 
         #Ctrlp:query.c.page2.xrce003_t
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce003_t
            #add-point:ON ACTION controlp INFIELD xrce003_t
            {<point name="query.c.page2.xrce003_t" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce004_t
            #add-point:BEFORE FIELD xrce004_t
            {<point name="query.b.page2.xrce004_t" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce004_t
            
            #add-point:AFTER FIELD xrce004_t
            {<point name="query.a.page2.xrce004_t" />}
            #END add-point
            
 
         #Ctrlp:query.c.page2.xrce004_t
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce004_t
            #add-point:ON ACTION controlp INFIELD xrce004_t
            {<point name="query.c.page2.xrce004_t" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce008_t
            #add-point:BEFORE FIELD xrce008_t
            {<point name="query.b.page2.xrce008_t" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce008_t
            
            #add-point:AFTER FIELD xrce008_t
            {<point name="query.a.page2.xrce008_t" />}
            #END add-point
            
 
         #Ctrlp:query.c.page2.xrce008_t
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce008_t
            #add-point:ON ACTION controlp INFIELD xrce008_t
            {<point name="query.c.page2.xrce008_t" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce100_t
            #add-point:BEFORE FIELD xrce100_t
            {<point name="query.b.page2.xrce100_t" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce100_t
            
            #add-point:AFTER FIELD xrce100_t
            {<point name="query.a.page2.xrce100_t" />}
            #END add-point
            
 
         #Ctrlp:query.c.page2.xrce100_t
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce100_t
            #add-point:ON ACTION controlp INFIELD xrce100_t
            {<point name="query.c.page2.xrce100_t" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce109_t
            #add-point:BEFORE FIELD xrce109_t
            {<point name="query.b.page2.xrce109_t" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce109_t
            
            #add-point:AFTER FIELD xrce109_t
            {<point name="query.a.page2.xrce109_t" />}
            #END add-point
            
 
         #Ctrlp:query.c.page2.xrce109_t
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce109_t
            #add-point:ON ACTION controlp INFIELD xrce109_t
            {<point name="query.c.page2.xrce109_t" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce101_t
            #add-point:BEFORE FIELD xrce101_t
            {<point name="query.b.page2.xrce101_t" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce101_t
            
            #add-point:AFTER FIELD xrce101_t
            {<point name="query.a.page2.xrce101_t" />}
            #END add-point
            
 
         #Ctrlp:query.c.page2.xrce101_t
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce101_t
            #add-point:ON ACTION controlp INFIELD xrce101_t
            {<point name="query.c.page2.xrce101_t" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce119_t
            #add-point:BEFORE FIELD xrce119_t
            {<point name="query.b.page2.xrce119_t" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce119_t
            
            #add-point:AFTER FIELD xrce119_t
            {<point name="query.a.page2.xrce119_t" />}
            #END add-point
            
 
         #Ctrlp:query.c.page2.xrce119_t
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce119_t
            #add-point:ON ACTION controlp INFIELD xrce119_t
            {<point name="query.c.page2.xrce119_t" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce120
            #add-point:BEFORE FIELD xrce120
            {<point name="query.b.page2.xrce120" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce120
            
            #add-point:AFTER FIELD xrce120
            {<point name="query.a.page2.xrce120" />}
            #END add-point
            
 
         #Ctrlp:query.c.page2.xrce120
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce120
            #add-point:ON ACTION controlp INFIELD xrce120
            {<point name="query.c.page2.xrce120" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce121
            #add-point:BEFORE FIELD xrce121
            {<point name="query.b.page2.xrce121" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce121
            
            #add-point:AFTER FIELD xrce121
            {<point name="query.a.page2.xrce121" />}
            #END add-point
            
 
         #Ctrlp:query.c.page2.xrce121
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce121
            #add-point:ON ACTION controlp INFIELD xrce121
            {<point name="query.c.page2.xrce121" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce129
            #add-point:BEFORE FIELD xrce129
            {<point name="query.b.page2.xrce129" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce129
            
            #add-point:AFTER FIELD xrce129
            {<point name="query.a.page2.xrce129" />}
            #END add-point
            
 
         #Ctrlp:query.c.page2.xrce129
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce129
            #add-point:ON ACTION controlp INFIELD xrce129
            {<point name="query.c.page2.xrce129" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce130
            #add-point:BEFORE FIELD xrce130
            {<point name="query.b.page2.xrce130" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce130
            
            #add-point:AFTER FIELD xrce130
            {<point name="query.a.page2.xrce130" />}
            #END add-point
            
 
         #Ctrlp:query.c.page2.xrce130
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce130
            #add-point:ON ACTION controlp INFIELD xrce130
            {<point name="query.c.page2.xrce130" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce131
            #add-point:BEFORE FIELD xrce131
            {<point name="query.b.page2.xrce131" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce131
            
            #add-point:AFTER FIELD xrce131
            {<point name="query.a.page2.xrce131" />}
            #END add-point
            
 
         #Ctrlp:query.c.page2.xrce131
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce131
            #add-point:ON ACTION controlp INFIELD xrce131
            {<point name="query.c.page2.xrce131" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce139
            #add-point:BEFORE FIELD xrce139
            {<point name="query.b.page2.xrce139" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce139
            
            #add-point:AFTER FIELD xrce139
            {<point name="query.a.page2.xrce139" />}
            #END add-point
            
 
         #Ctrlp:query.c.page2.xrce139
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce139
            #add-point:ON ACTION controlp INFIELD xrce139
            {<point name="query.c.page2.xrce139" />}
            #END add-point
 
  
                  #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce001_u
            #add-point:BEFORE FIELD xrce001_u
            {<point name="query.b.page3.xrce001_u" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce001_u
            
            #add-point:AFTER FIELD xrce001_u
            {<point name="query.a.page3.xrce001_u" />}
            #END add-point
            
 
         #Ctrlp:query.c.page3.xrce001_u
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce001_u
            #add-point:ON ACTION controlp INFIELD xrce001_u
            {<point name="query.c.page3.xrce001_u" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrcedocno_u
            #add-point:BEFORE FIELD xrcedocno_u
            {<point name="query.b.page3.xrcedocno_u" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrcedocno_u
            
            #add-point:AFTER FIELD xrcedocno_u
            {<point name="query.a.page3.xrcedocno_u" />}
            #END add-point
            
 
         #Ctrlp:query.c.page3.xrcedocno_u
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrcedocno_u
            #add-point:ON ACTION controlp INFIELD xrcedocno_u
            {<point name="query.c.page3.xrcedocno_u" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrceld_u
            #add-point:BEFORE FIELD xrceld_u
            {<point name="query.b.page3.xrceld_u" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrceld_u
            
            #add-point:AFTER FIELD xrceld_u
            {<point name="query.a.page3.xrceld_u" />}
            #END add-point
            
 
         #Ctrlp:query.c.page3.xrceld_u
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrceld_u
            #add-point:ON ACTION controlp INFIELD xrceld_u
            {<point name="query.c.page3.xrceld_u" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrcesite_u
            #add-point:BEFORE FIELD xrcesite_u
            {<point name="query.b.page3.xrcesite_u" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrcesite_u
            
            #add-point:AFTER FIELD xrcesite_u
            {<point name="query.a.page3.xrcesite_u" />}
            #END add-point
            
 
         #Ctrlp:query.c.page3.xrcesite_u
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrcesite_u
            #add-point:ON ACTION controlp INFIELD xrcesite_u
            {<point name="query.c.page3.xrcesite_u" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrceseq_u
            #add-point:BEFORE FIELD xrceseq_u
            {<point name="query.b.page3.xrceseq_u" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrceseq_u
            
            #add-point:AFTER FIELD xrceseq_u
            {<point name="query.a.page3.xrceseq_u" />}
            #END add-point
            
 
         #Ctrlp:query.c.page3.xrceseq_u
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrceseq_u
            #add-point:ON ACTION controlp INFIELD xrceseq_u
            {<point name="query.c.page3.xrceseq_u" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce002_u
            #add-point:BEFORE FIELD xrce002_u
            {<point name="query.b.page3.xrce002_u" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce002_u
            
            #add-point:AFTER FIELD xrce002_u
            {<point name="query.a.page3.xrce002_u" />}
            #END add-point
            
 
         #Ctrlp:query.c.page3.xrce002_u
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce002_u
            #add-point:ON ACTION controlp INFIELD xrce002_u
            {<point name="query.c.page3.xrce002_u" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce006_u
            #add-point:BEFORE FIELD xrce006_u
            {<point name="query.b.page3.xrce006_u" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce006_u
            
            #add-point:AFTER FIELD xrce006_u
            {<point name="query.a.page3.xrce006_u" />}
            #END add-point
            
 
         #Ctrlp:query.c.page3.xrce006_u
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce006_u
            #add-point:ON ACTION controlp INFIELD xrce006_u
            {<point name="query.c.page3.xrce006_u" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce003_u
            #add-point:BEFORE FIELD xrce003_u
            {<point name="query.b.page3.xrce003_u" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce003_u
            
            #add-point:AFTER FIELD xrce003_u
            {<point name="query.a.page3.xrce003_u" />}
            #END add-point
            
 
         #Ctrlp:query.c.page3.xrce003_u
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce003_u
            #add-point:ON ACTION controlp INFIELD xrce003_u
            {<point name="query.c.page3.xrce003_u" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce004_u
            #add-point:BEFORE FIELD xrce004_u
            {<point name="query.b.page3.xrce004_u" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce004_u
            
            #add-point:AFTER FIELD xrce004_u
            {<point name="query.a.page3.xrce004_u" />}
            #END add-point
            
 
         #Ctrlp:query.c.page3.xrce004_u
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce004_u
            #add-point:ON ACTION controlp INFIELD xrce004_u
            {<point name="query.c.page3.xrce004_u" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce005_u
            #add-point:BEFORE FIELD xrce005_u
            {<point name="query.b.page3.xrce005_u" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce005_u
            
            #add-point:AFTER FIELD xrce005_u
            {<point name="query.a.page3.xrce005_u" />}
            #END add-point
            
 
         #Ctrlp:query.c.page3.xrce005_u
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce005_u
            #add-point:ON ACTION controlp INFIELD xrce005_u
            {<point name="query.c.page3.xrce005_u" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce008_u
            #add-point:BEFORE FIELD xrce008_u
            {<point name="query.b.page3.xrce008_u" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce008_u
            
            #add-point:AFTER FIELD xrce008_u
            {<point name="query.a.page3.xrce008_u" />}
            #END add-point
            
 
         #Ctrlp:query.c.page3.xrce008_u
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce008_u
            #add-point:ON ACTION controlp INFIELD xrce008_u
            {<point name="query.c.page3.xrce008_u" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce100_u
            #add-point:BEFORE FIELD xrce100_u
            {<point name="query.b.page3.xrce100_u" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce100_u
            
            #add-point:AFTER FIELD xrce100_u
            {<point name="query.a.page3.xrce100_u" />}
            #END add-point
            
 
         #Ctrlp:query.c.page3.xrce100_u
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce100_u
            #add-point:ON ACTION controlp INFIELD xrce100_u
            {<point name="query.c.page3.xrce100_u" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce109_u
            #add-point:BEFORE FIELD xrce109_u
            {<point name="query.b.page3.xrce109_u" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce109_u
            
            #add-point:AFTER FIELD xrce109_u
            {<point name="query.a.page3.xrce109_u" />}
            #END add-point
            
 
         #Ctrlp:query.c.page3.xrce109_u
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce109_u
            #add-point:ON ACTION controlp INFIELD xrce109_u
            {<point name="query.c.page3.xrce109_u" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce101_u
            #add-point:BEFORE FIELD xrce101_u
            {<point name="query.b.page3.xrce101_u" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce101_u
            
            #add-point:AFTER FIELD xrce101_u
            {<point name="query.a.page3.xrce101_u" />}
            #END add-point
            
 
         #Ctrlp:query.c.page3.xrce101_u
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce101_u
            #add-point:ON ACTION controlp INFIELD xrce101_u
            {<point name="query.c.page3.xrce101_u" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce119_u
            #add-point:BEFORE FIELD xrce119_u
            {<point name="query.b.page3.xrce119_u" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce119_u
            
            #add-point:AFTER FIELD xrce119_u
            {<point name="query.a.page3.xrce119_u" />}
            #END add-point
            
 
         #Ctrlp:query.c.page3.xrce119_u
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce119_u
            #add-point:ON ACTION controlp INFIELD xrce119_u
            {<point name="query.c.page3.xrce119_u" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce027_u
            #add-point:BEFORE FIELD xrce027_u
            {<point name="query.b.page3.xrce027_u" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce027_u
            
            #add-point:AFTER FIELD xrce027_u
            {<point name="query.a.page3.xrce027_u" />}
            #END add-point
            
 
         #Ctrlp:query.c.page3.xrce027_u
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce027_u
            #add-point:ON ACTION controlp INFIELD xrce027_u
            {<point name="query.c.page3.xrce027_u" />}
            #END add-point
 
         #Ctrlp:construct.c.page3.xrce010_u
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce010_u
            #add-point:ON ACTION controlp INFIELD xrce010_u
            {<point name="construct.c.page3.xrce010_u" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce010_u
            #add-point:BEFORE FIELD xrce010_u
            {<point name="query.b.page3.xrce010_u" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce010_u
            
            #add-point:AFTER FIELD xrce010_u
            {<point name="query.a.page3.xrce010_u" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xrce016_u
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce016_u
            #add-point:ON ACTION controlp INFIELD xrce016_u
            {<point name="construct.c.page3.xrce016_u" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce016_u
            #add-point:BEFORE FIELD xrce016_u
            {<point name="query.b.page3.xrce016_u" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce016_u
            
            #add-point:AFTER FIELD xrce016_u
            {<point name="query.a.page3.xrce016_u" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce016_u_desc
            #add-point:BEFORE FIELD xrce016_u_desc
            {<point name="query.b.page3.xrce016_u_desc" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce016_u_desc
            
            #add-point:AFTER FIELD xrce016_u_desc
            {<point name="query.a.page3.xrce016_u_desc" />}
            #END add-point
            
 
         #Ctrlp:query.c.page3.xrce016_u_desc
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce016_u_desc
            #add-point:ON ACTION controlp INFIELD xrce016_u_desc
            {<point name="query.c.page3.xrce016_u_desc" />}
            #END add-point
 
         #Ctrlp:construct.c.page3.xrce017
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce017
            #add-point:ON ACTION controlp INFIELD xrce017
            {<point name="construct.c.page3.xrce017" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce017
            #add-point:BEFORE FIELD xrce017
            {<point name="query.b.page3.xrce017" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce017
            
            #add-point:AFTER FIELD xrce017
            {<point name="query.a.page3.xrce017" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xrce018_u
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce018_u
            #add-point:ON ACTION controlp INFIELD xrce018_u
            {<point name="construct.c.page3.xrce018_u" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce018_u
            #add-point:BEFORE FIELD xrce018_u
            {<point name="query.b.page3.xrce018_u" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce018_u
            
            #add-point:AFTER FIELD xrce018_u
            {<point name="query.a.page3.xrce018_u" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xrce019
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce019
            #add-point:ON ACTION controlp INFIELD xrce019
            {<point name="construct.c.page3.xrce019" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce019
            #add-point:BEFORE FIELD xrce019
            {<point name="query.b.page3.xrce019" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce019
            
            #add-point:AFTER FIELD xrce019
            {<point name="query.a.page3.xrce019" />}
            #END add-point
            
 
         #Ctrlp:construct.c.page3.xrce020
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce020
            #add-point:ON ACTION controlp INFIELD xrce020
            {<point name="construct.c.page3.xrce020" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce020
            #add-point:BEFORE FIELD xrce020
            {<point name="query.b.page3.xrce020" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce020
            
            #add-point:AFTER FIELD xrce020
            {<point name="query.a.page3.xrce020" />}
            #END add-point
            
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce022
            #add-point:BEFORE FIELD xrce022
            {<point name="query.b.page3.xrce022" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce022
            
            #add-point:AFTER FIELD xrce022
            {<point name="query.a.page3.xrce022" />}
            #END add-point
            
 
         #Ctrlp:query.c.page3.xrce022
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce022
            #add-point:ON ACTION controlp INFIELD xrce022
            {<point name="query.c.page3.xrce022" />}
            #END add-point
 
         #應用 a01 樣板自動產生(Version:1)
         BEFORE FIELD xrce023
            #add-point:BEFORE FIELD xrce023
            {<point name="query.b.page3.xrce023" />}
            #END add-point
 
         #應用 a02 樣板自動產生(Version:1)
         AFTER FIELD xrce023
            
            #add-point:AFTER FIELD xrce023
            {<point name="query.a.page3.xrce023" />}
            #END add-point
            
 
         #Ctrlp:query.c.page3.xrce023
         #應用 a03 樣板自動產生(Version:2)
         ON ACTION controlp INFIELD xrce023
            #add-point:ON ACTION controlp INFIELD xrce023
            {<point name="query.c.page3.xrce023" />}
            #END add-point
 
  
 
      
         BEFORE CONSTRUCT
            #add-point:cs段more_construct
            {<point name="cs.before_construct"/>}
            #end add-point 
      
      END CONSTRUCT
  
      #add-point:query段more_construct
      {<point name="query.more_construct"/>}
      #end add-point 
  
      BEFORE DIALOG 
         CALL cl_qbe_init()
         #add-point:query段before_dialog
         {<point name="query.before_dialog"/>}
         #end add-point 
      
      ON ACTION qbe_select
         LET ls_wc = ""
         CALL cl_qbe_list("c") RETURNING ls_wc
      
      ON ACTION qbe_save
         CALL cl_qbe_save()
      
      ON ACTION accept
         ACCEPT DIALOG
         
      ON ACTION cancel
         LET INT_FLAG = 1
         CANCEL DIALOG
      
      #交談指令共用ACTION
      &include "common_action.4gl"
      CONTINUE DIALOG 
   END DIALOG
 
   #add-point:query段after_construct
   {<point name="query.after_construct"/>}
   #end add-point
 
   IF INT_FLAG THEN
      LET INT_FLAG = 0
      #還原
      LET g_wc2 = ls_wc
   ELSE
      LET g_error_show = 1
      LET g_detail_idx = 1
   END IF
    
   CALL axrt300_02_b_fill(g_wc2)
   
   IF g_detail_cnt = 0 AND NOT INT_FLAG THEN
      INITIALIZE g_errparam TO NULL 
      LET g_errparam.extend = "" 
      LET g_errparam.code   = -100 
      LET g_errparam.popup  = TRUE 
      CALL cl_err()
   END IF
   
   LET INT_FLAG = FALSE
   
END FUNCTION
]]>
  </section>
  <section id="axrt300_02.set_entry_b" ver="4" status="" src="s" readonly="">
    <![CDATA[#+ 單身欄位開啟設定
PRIVATE FUNCTION axrt300_02_set_entry_b(p_cmd)                                                  
   DEFINE p_cmd   LIKE type_t.chr1         
   #add-point:set_entry_b段define
   {<point name="set_entry_b.define" edit="s"/>}
   #end add-point     
   #add-point:set_entry_b段define(客製用)
   {<point name="set_entry_b.define_customerization" edit="c"/>}
   #end add-point
   
   #add-point:set_entry_b段control
   {<point name="set_entry_b.set_entry_b"/>}
   #end add-point                                                                   
                                                                                
END FUNCTION                                                                    
]]>
  </section>
  <section id="axrt300_02.set_no_entry_b" ver="4" status="" src="s" readonly="">
    <![CDATA[#+ 單身欄位關閉設定
PRIVATE FUNCTION axrt300_02_set_no_entry_b(p_cmd)                                               
   DEFINE p_cmd   LIKE type_t.chr1           
   #add-point:set_no_entry_b段define
   {<point name="set_no_entry_b.define" edit="s"/>}
   #end add-point
   #add-point:set_no_entry_b段define(客製用)
   {<point name="set_no_entry_b.define_customerization" edit="c"/>}
   #end add-point   
 
   #add-point:set_no_entry_b段control
   {<point name="set_no_entry_b.set_no_entry_b"/>}
   #end add-point       
                                                                                
END FUNCTION  
]]>
  </section>
  <section id="axrt300_02.set_pk_array" ver="5" status="" src="s" readonly="">
    <![CDATA[   #應用 a51 樣板自動產生(Version:5)
#+ 給予pk_array內容
PRIVATE FUNCTION axrt300_02_set_pk_array()
   #add-point:set_pk_array段define
   {<point name="set_pk_array.define" edit="s"/>}
   #end add-point
   #add-point:set_pk_array段define
   {<point name="set_pk_array.define_customerization" edit="c"/>}
   #end add-point
   
   #add-point:set_pk_array段之前
   {<point name="set_pk_array.before"/>}
   #end add-point  
   
   #若l_ac<=0代表沒有資料
   IF l_ac <= 0 THEN
      RETURN
   END IF
   
   CALL g_pk_array.clear()
   LET g_pk_array[1].values = g_xrce_d[l_ac].xrceld
   LET g_pk_array[1].column = 'xrceld'
   LET g_pk_array[2].values = g_xrce_d[l_ac].xrcedocno
   LET g_pk_array[2].column = 'xrcedocno'
   LET g_pk_array[3].values = g_xrce_d[l_ac].xrceseq
   LET g_pk_array[3].column = 'xrceseq'
   
   #add-point:set_pk_array段之後
   {<point name="set_pk_array.after"/>}
   #end add-point  
   
END FUNCTION
 
 
]]>
  </section>
  <section id="axrt300_02.state_change" ver="1" status="" src="s" readonly="">
    <![CDATA[   
]]>
  </section>
  <section id="axrt300_02.ui_dialog" ver="22" status="" src="s" readonly="">
    <![CDATA[#+ 功能選單 
PRIVATE FUNCTION axrt300_02_ui_dialog()
   DEFINE li_idx   LIKE type_t.num10
   DEFINE la_param  RECORD #串查用
             prog   STRING,
             param  DYNAMIC ARRAY OF STRING
                    END RECORD
   DEFINE ls_js     STRING
   #add-point:ui_dialog段define
   {<point name="ui_dialog.define" edit="s"/>}
   #end add-point 
   #add-point:ui_dialog段define(客製用)
   {<point name="ui_dialog.define_customerization" edit="c"/>}
   #end add-point
   
   LET g_action_choice = " "  
   LET gwin_curr = ui.Window.getCurrent()
   LET gfrm_curr = gwin_curr.getForm()      
 
   CALL cl_set_act_visible("accept,cancel", FALSE)
   
   LET g_detail_idx = 1
   
   #add-point:ui_dialog段before dialog 
   {<point name="ui_dialog.before_dialog"/>}
   #end add-point
   
   WHILE TRUE
   
      IF g_action_choice = "logistics" THEN
         #清除畫面及相關資料
         CLEAR FORM
         CALL g_xrce_d.clear()
         CALL g_xrce2_d.clear()
         CALL g_xrce3_d.clear()
 
         LET g_wc2 = ' 1=2'
         LET g_action_choice = ""
         CALL axrt300_02_init()
      END IF
   
      CALL axrt300_02_b_fill(g_wc2)
   
      DIALOG ATTRIBUTES(UNBUFFERED,FIELD ORDER FORM)
         DISPLAY ARRAY g_xrce_d TO s_detail1.* ATTRIBUTE(COUNT=g_detail_cnt) 
      
            BEFORE DISPLAY 
               #add-point:ui_dialog段before display 
               {<point name="ui_dialog.body.before_display" mark="Y"/>}
               #end add-point
               #讓各頁籤能夠同步指到特定資料
               CALL FGL_SET_ARR_CURR(g_detail_idx)
               #add-point:ui_dialog段before display2
               {<point name="ui_dialog.body.before_display2"/>}
               #end add-point
               
            BEFORE ROW
               LET g_detail_idx = DIALOG.getCurrentRow("s_detail1")
               LET l_ac = g_detail_idx
               LET g_temp_idx = l_ac
               DISPLAY g_detail_idx TO FORMONLY.idx
               CALL cl_show_fld_cont() 
               #顯示followup圖示
               #應用 a48 樣板自動產生(Version:2)
   CALL axrt300_02_set_pk_array()
   #add-point:ON ACTION agendum
   {<point name="show.follow_pic"/>}
   #END add-point
   CALL cl_user_overview_set_follow_pic()
  
 
 
               #add-point:display array-before row
               {<point name="ui_dialog.before_row"/>}
               #end add-point
         
            #自訂ACTION(detail_show,page_1)
            
               
         END DISPLAY
      
         DISPLAY ARRAY g_xrce2_d TO s_detail2.*
            ATTRIBUTES(COUNT=g_detail_cnt)  
         
            BEFORE DISPLAY 
               #add-point:ui_dialog段before display 
               {<point name="ui_dialog.body2.before_display" mark="Y"/>}
               #end add-point
               CALL FGL_SET_ARR_CURR(g_detail_idx)
               #add-point:ui_dialog段before display2
               {<point name="ui_dialog.body2.before_display2"/>}
               #end add-point
         
            BEFORE ROW
               LET g_detail_idx = DIALOG.getCurrentRow("s_detail2")
               LET l_ac = g_detail_idx
               LET g_temp_idx = l_ac
               DISPLAY g_detail_idx TO FORMONLY.idx
               CALL cl_show_fld_cont() 
               #顯示followup圖示
               #應用 a48 樣板自動產生(Version:2)
   CALL axrt300_02_set_pk_array()
   #add-point:ON ACTION agendum
   {<point name="show.follow_pic"/>}
   #END add-point
   CALL cl_user_overview_set_follow_pic()
  
 
 
               #add-point:display array-before row
               {<point name="ui_dialog.before_row2"/>}
               #end add-point
               
            #自訂ACTION(detail_show,page_2)
            
               
         END DISPLAY
         DISPLAY ARRAY g_xrce3_d TO s_detail3.*
            ATTRIBUTES(COUNT=g_detail_cnt)  
         
            BEFORE DISPLAY 
               #add-point:ui_dialog段before display 
               {<point name="ui_dialog.body3.before_display" mark="Y"/>}
               #end add-point
               CALL FGL_SET_ARR_CURR(g_detail_idx)
               #add-point:ui_dialog段before display2
               {<point name="ui_dialog.body3.before_display2"/>}
               #end add-point
         
            BEFORE ROW
               LET g_detail_idx = DIALOG.getCurrentRow("s_detail3")
               LET l_ac = g_detail_idx
               LET g_temp_idx = l_ac
               DISPLAY g_detail_idx TO FORMONLY.idx
               CALL cl_show_fld_cont() 
               #顯示followup圖示
               #應用 a48 樣板自動產生(Version:2)
   CALL axrt300_02_set_pk_array()
   #add-point:ON ACTION agendum
   {<point name="show.follow_pic"/>}
   #END add-point
   CALL cl_user_overview_set_follow_pic()
  
 
 
               #add-point:display array-before row
               {<point name="ui_dialog.before_row3"/>}
               #end add-point
               
            #自訂ACTION(detail_show,page_3)
            
               
         END DISPLAY
 
      
         #add-point:ui_dialog段自定義display array
         {<point name="ui_dialog.more_displayarray"/>}
         #end add-point
    
         BEFORE DIALOG
            IF g_temp_idx > 0 THEN
               LET l_ac = g_temp_idx
               CALL DIALOG.setCurrentRow("s_detail1",l_ac)
               LET g_temp_idx = 1
            END IF
            LET g_curr_diag = ui.DIALOG.getCurrent()         
            CALL DIALOG.setSelectionMode("s_detail1", 1)
            CALL DIALOG.setSelectionMode("s_detail2", 1)
            CALL DIALOG.setSelectionMode("s_detail3", 1)
 
            #add-point:ui_dialog段before
            {<point name="ui_dialog.b_dialog"/>}
            #end add-point
            NEXT FIELD CURRENT
      
         
         #應用 a43 樣板自動產生(Version:2)
         ON ACTION modify
            LET g_action_choice="modify"
            IF cl_auth_chk_act("modify") THEN
               LET g_aw = ''
               CALL axrt300_02_modify()
               #add-point:ON ACTION modify
               {<point name="menu.modify" />}
               #END add-point
               
            END IF
 
 
 
         #應用 a43 樣板自動產生(Version:2)
         ON ACTION modify_detail
            LET g_action_choice="modify_detail"
            IF cl_auth_chk_act("modify") THEN
               LET g_aw = g_curr_diag.getCurrentItem()
               CALL axrt300_02_modify()
               #add-point:ON ACTION modify_detail
               {<point name="menu.modify_detail" />}
               #END add-point
               
            END IF
 
 
 
         #應用 a43 樣板自動產生(Version:2)
         ON ACTION delete
            LET g_action_choice="delete"
            IF cl_auth_chk_act("delete") THEN
               CALL axrt300_02_delete()
               #add-point:ON ACTION delete
               {<point name="menu.delete" />}
               #END add-point
               
            END IF
 
 
 
         #應用 a43 樣板自動產生(Version:2)
         ON ACTION insert
            LET g_action_choice="insert"
            IF cl_auth_chk_act("insert") THEN
               CALL axrt300_02_insert()
               #add-point:ON ACTION insert
               {<point name="menu.insert" />}
               #END add-point
               
            END IF
 
 
 
         #應用 a43 樣板自動產生(Version:2)
         ON ACTION output
            LET g_action_choice="output"
            IF cl_auth_chk_act("output") THEN
               
               #add-point:ON ACTION output
               {<point name="menu.output" />}
               #END add-point
               
            END IF
 
 
 
      
         ON ACTION exporttoexcel
            LET g_action_choice="exporttoexcel"
            IF cl_auth_chk_act("exporttoexcel") THEN
               CALL g_export_node.clear()
               LET g_export_node[1] = base.typeInfo.create(g_xrce_d)
               LET g_export_id[1]   = "s_detail1"
               LET g_export_node[2] = base.typeInfo.create(g_xrce2_d)
               LET g_export_id[2]   = "s_detail2"
               LET g_export_node[3] = base.typeInfo.create(g_xrce3_d)
               LET g_export_id[3]   = "s_detail3"
 
               #add-point:ON ACTION exporttoexcel
               {<point name="menu.exporttoexcel" />}
               #END add-point
               CALL cl_export_to_excel_getpage()
               CALL cl_export_to_excel()
            END IF
            
         ON ACTION close
            LET INT_FLAG=FALSE         
            LET g_action_choice="exit"
            CANCEL DIALOG
      
         ON ACTION exit
            LET g_action_choice="exit"
            CANCEL DIALOG
            
         
         
         #應用 a46 樣板自動產生(Version:2)
         #新增相關文件
         ON ACTION related_document
            CALL axrt300_02_set_pk_array()
            IF cl_auth_chk_act("related_document") THEN
               #add-point:ON ACTION related_document
               {<point name="ui_dialog.dialog.related_document"/>}
               #END add-point
               CALL cl_doc()
            END IF
            
         ON ACTION agendum
            CALL axrt300_02_set_pk_array()
            #add-point:ON ACTION agendum
            {<point name="ui_dialog.dialog.agendum"/>}
            #END add-point
            CALL cl_user_overview()
            CALL cl_user_overview_set_follow_pic()
         
         ON ACTION followup
            CALL axrt300_02_set_pk_array()
            #add-point:ON ACTION followup
            {<point name="ui_dialog.dialog.followup"/>}
            #END add-point
            CALL cl_user_overview_follow('')
 
 
         
         #主選單用ACTION
         &include "main_menu_exit_dialog.4gl"
         &include "relating_action.4gl"
         #交談指令共用ACTION
         &include "common_action.4gl"
            CONTINUE DIALOG
      END DIALOG
      
      IF g_action_choice = "exit" AND NOT cl_null(g_action_choice) THEN
         #add-point:ui_dialog段離開dialog前
         {<point name="ui_dialog.b_exit"/>}
         #end add-point
         EXIT WHILE
      END IF
      
   END WHILE
 
   CALL cl_set_act_visible("accept,cancel", TRUE)
 
END FUNCTION
]]>
  </section>
  <section id="axrt300_02.unlock_b" ver="4" status="" src="s" readonly="">
    <![CDATA[#+ 連動unlock其他單身table資料
PRIVATE FUNCTION axrt300_02_unlock_b(ps_table)
   DEFINE ps_table STRING
   DEFINE ls_group STRING
   #add-point:unlock_b段define
   {<point name="unlock_b.define" edit="s"/>}
   #end add-point  
   #add-point:unlock_b段define(客製用)
   {<point name="unlock_b.define_customerization" edit="c"/>}
   #end add-point
   
   LET ls_group = ""
   
   #IF ls_group.getIndexOf(ps_table,1) THEN
      CLOSE axrt300_02_bcl
   #END IF
   
 
   
   #add-point:unlock_b段結束前
   {<point name="unlock_b.after"/>}
   #end add-point 
 
END FUNCTION
]]>
  </section>
  <section id="axrt300_02.update_b" ver="14" status="" src="s" readonly="">
    <![CDATA[#+ 修改單身後其他table連動
PRIVATE FUNCTION axrt300_02_update_b(ps_table,ps_keys,ps_keys_bak,ps_page)
   DEFINE ps_page          STRING
   DEFINE ps_table         STRING
   DEFINE ps_keys          DYNAMIC ARRAY OF VARCHAR(500)
   DEFINE ps_keys_bak      DYNAMIC ARRAY OF VARCHAR(500)
   DEFINE ls_group         STRING
   DEFINE li_idx           LIKE type_t.num10
   DEFINE lb_chk           BOOLEAN
   DEFINE l_new_key        DYNAMIC ARRAY OF STRING
   DEFINE l_old_key        DYNAMIC ARRAY OF STRING
   DEFINE l_field_key      DYNAMIC ARRAY OF STRING
   #add-point:update_b段define
   {<point name="update_b.define" edit="s"/>}
   #end add-point     
   #add-point:update_b段define(客製用)
   {<point name="update_b.define_customerization" edit="c"/>}
   #end add-point
   
   #比對新舊值, 判斷key是否有改變
   LET lb_chk = TRUE
   FOR li_idx = 1 TO ps_keys.getLength()
      IF ps_keys[li_idx] <> ps_keys_bak[li_idx] THEN
         LET lb_chk = FALSE
         EXIT FOR
      END IF
   END FOR
   
   #若key無變動, 不需要做處理
   IF lb_chk THEN
      RETURN
   END IF
    
   #若key有變動, 則連動其他table的資料   
   #判斷是否是同一群組的table
   LET ls_group = "xrce_t,"
   IF ls_group.getIndexOf(ps_table,1) > 0 AND ps_table <> "xrce_t" THEN
      #add-point:update_b段修改前
      {<point name="update_b.b_update" mark="Y"/>}
      #end add-point     
      UPDATE xrce_t 
         SET (xrceld,xrcedocno,xrceseq
              ,xrce001,xrcesite,xrce002,xrce006,xrce003,xrce004,xrce005,xrce024,xrce025,xrce008,xrce015,xrce100,xrce101,xrce109,xrce119,xrce027,xrce028,xrce104,xrce114,xrce124,xrce134,xrcecomp,xrceorga,xrce010,xrce016,xrce001,xrcesite,xrce002,xrce006,xrce003,xrce004,xrce008,xrce100,xrce109,xrce101,xrce119,xrce120,xrce121,xrce129,xrce130,xrce131,xrce139,xrce001,xrcesite,xrce002,xrce006,xrce003,xrce004,xrce005,xrce008,xrce100,xrce109,xrce101,xrce119,xrce027,xrce010,xrce016,xrce017,xrce018,xrce019,xrce020,xrce022,xrce023) 
              = 
             (ps_keys[1],ps_keys[2],ps_keys[3]
              ,g_xrce_d[l_ac].xrce001,g_xrce_d[l_ac].xrcesite,g_xrce_d[l_ac].xrce002,g_xrce_d[l_ac].xrce006, 
                  g_xrce_d[l_ac].xrce003,g_xrce_d[l_ac].xrce004,g_xrce_d[l_ac].xrce005,g_xrce_d[l_ac].xrce024, 
                  g_xrce_d[l_ac].xrce025,g_xrce_d[l_ac].xrce008,g_xrce_d[l_ac].xrce015,g_xrce_d[l_ac].xrce100, 
                  g_xrce_d[l_ac].xrce101,g_xrce_d[l_ac].xrce109,g_xrce_d[l_ac].xrce119,g_xrce_d[l_ac].xrce027, 
                  g_xrce_d[l_ac].xrce028,g_xrce_d[l_ac].xrce104,g_xrce_d[l_ac].xrce114,g_xrce_d[l_ac].xrce124, 
                  g_xrce_d[l_ac].xrce134,g_xrce_d[l_ac].xrcecomp,g_xrce_d[l_ac].xrceorga,g_xrce_d[l_ac].xrce010, 
                  g_xrce_d[l_ac].xrce016,g_xrce_d[l_ac].xrce001,g_xrce_d[l_ac].xrcesite,g_xrce_d[l_ac].xrce002, 
                  g_xrce_d[l_ac].xrce006,g_xrce_d[l_ac].xrce003,g_xrce_d[l_ac].xrce004,g_xrce_d[l_ac].xrce008, 
                  g_xrce_d[l_ac].xrce100,g_xrce_d[l_ac].xrce109,g_xrce_d[l_ac].xrce101,g_xrce_d[l_ac].xrce119, 
                  g_xrce2_d[l_ac].xrce120,g_xrce2_d[l_ac].xrce121,g_xrce2_d[l_ac].xrce129,g_xrce2_d[l_ac].xrce130, 
                  g_xrce2_d[l_ac].xrce131,g_xrce2_d[l_ac].xrce139,g_xrce_d[l_ac].xrce001,g_xrce_d[l_ac].xrcesite, 
                  g_xrce_d[l_ac].xrce002,g_xrce_d[l_ac].xrce006,g_xrce_d[l_ac].xrce003,g_xrce_d[l_ac].xrce004, 
                  g_xrce_d[l_ac].xrce005,g_xrce_d[l_ac].xrce008,g_xrce_d[l_ac].xrce100,g_xrce_d[l_ac].xrce109, 
                  g_xrce_d[l_ac].xrce101,g_xrce_d[l_ac].xrce119,g_xrce_d[l_ac].xrce027,g_xrce_d[l_ac].xrce010, 
                  g_xrce_d[l_ac].xrce016,g_xrce3_d[l_ac].xrce017,g_xrce3_d[l_ac].xrce018,g_xrce3_d[l_ac].xrce019, 
                  g_xrce3_d[l_ac].xrce020,g_xrce3_d[l_ac].xrce022,g_xrce3_d[l_ac].xrce023) 
         WHERE xrceld = ps_keys_bak[1] AND xrcedocno = ps_keys_bak[2] AND xrceseq = ps_keys_bak[3]
      #add-point:update_b段修改中
      {<point name="update_b.m_update"/>}
      #end add-point 
      CASE
         WHEN SQLCA.sqlerrd[3] = 0  #更新不到的處理
            INITIALIZE g_errparam TO NULL 
            LET g_errparam.extend = "xrce_t" 
            LET g_errparam.code   = "std-00009" 
            LET g_errparam.popup  = TRUE 
            CALL cl_err()
         WHEN SQLCA.sqlcode #其他錯誤
            INITIALIZE g_errparam TO NULL 
            LET g_errparam.extend = "xrce_t" 
            LET g_errparam.code   = SQLCA.sqlcode 
            LET g_errparam.popup  = TRUE 
            CALL cl_err()
         OTHERWISE
            
      END CASE
      #add-point:update_b段修改後
      {<point name="update_b.a_update"/>}
      #end add-point 
      RETURN
   END IF
   
 
   
END FUNCTION
]]>
  </section>
</add_points>
