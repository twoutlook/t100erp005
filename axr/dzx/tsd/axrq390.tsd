<spec prog="axrq390" std_prog="axrq390" erpver="1.0" ver="1" module="AXR" type="M" booking="Y" class="q" env="s" zone="t10dev" identity="s">
  <other>
    <code_template value="Q" status="" />
    <free_style value="N" status="" />
  </other>
  <toolbar items="datainfo,insert,output,query" />
  <prog_rel />
  <ref_field>
    <rfield cite_std="N" ver="1" name="b_xrcadocno_desc" src="s" depend_field="b_xrcadocno" correspon_key="xrcaent,xrcadocno" ref_table="oobxl_t" ref_fk="oobxlent,oobxl001" ref_dlang="oobxl002" ref_rtn="oobxl003" status="d" />
    <rfield cite_std="N" ver="1" name="b_xrcald_desc" src="s" depend_field="b_xrcald" correspon_key="xrcaent,xrcald" ref_table="glaal_t" ref_fk="glaalent,glaalld" ref_dlang="glaal001" ref_rtn="glaal002" status="" />
  </ref_field>
  <multi_lang />
  <help_code>
    <hfield cite_std="N" ver="1" name="b_xrcadocno" src="s" help_table="" help_find="" help_dlang="" help_field="" help_wc="" mapping_widget="" status="d" />
    <hfield cite_std="N" ver="1" name="b_xrcborga" src="s" help_table="" help_find="" help_dlang="" help_field="" help_wc="" mapping_widget="" status="" />
    <hfield cite_std="N" ver="1" name="b_xrcc108" src="s" help_table="" help_find="" help_dlang="" help_field="" help_wc="" mapping_widget="" status="" />
    <hfield cite_std="N" ver="1" name="xrca014_1" src="s" help_table="" help_find="" help_dlang="" help_field="" help_wc="" mapping_widget="" status="" />
    <hfield cite_std="N" ver="1" name="xrca004_1" src="s" help_table="" help_find="" help_dlang="" help_field="" help_wc="" mapping_widget="" status="" />
    <hfield src="s" ver="1" name="xrca004" help_table="" help_find="" help_dlang="" help_field="" mapping_widget="" help_wc="" cite_std="N" status="u" />
    <hfield cite_std="N" ver="1" name="b_xrcc118" src="s" help_table="" help_find="" help_dlang="" help_field="" help_wc="" mapping_widget="" status="" />
    <hfield src="s" ver="1" name="xrcb002" help_table="" help_find="" help_dlang="" help_field="" mapping_widget="" help_wc="" cite_std="N" status="u" />
    <hfield src="s" ver="1" name="xrca014" help_table="" help_find="" help_dlang="" help_field="" mapping_widget="" help_wc="" cite_std="N" status="u" />
    <hfield src="s" ver="1" name="xrca100" help_table="" help_find="" help_dlang="" help_field="" mapping_widget="" help_wc="" cite_std="N" status="u" />
    <hfield src="s" ver="1" name="xrca007" help_table="" help_find="" help_dlang="" help_field="" mapping_widget="" help_wc="" cite_std="N" status="u" />
    <hfield cite_std="N" ver="1" name="b_xrcb028" src="s" help_table="" help_find="" help_dlang="" help_field="" help_wc="" mapping_widget="" status="" />
    <hfield src="s" ver="1" name="xrcborga" help_table="" help_find="" help_dlang="" help_field="" mapping_widget="" help_wc="" cite_std="N" status="u" />
    <hfield src="s" ver="1" name="xrcc001" help_table="" help_find="" help_dlang="" help_field="" mapping_widget="" help_wc="" cite_std="N" status="u" />
    <hfield cite_std="N" ver="1" name="b_xrcald" src="s" help_table="" help_find="" help_dlang="" help_field="" help_wc="" mapping_widget="" status="" />
    <hfield src="s" ver="1" name="xrccseq" help_table="" help_find="" help_dlang="" help_field="" mapping_widget="" help_wc="" cite_std="N" status="u" />
    <hfield cite_std="N" ver="1" name="b_xrcb002" src="s" help_table="" help_find="" help_dlang="" help_field="" help_wc="" mapping_widget="" status="" />
    <hfield cite_std="N" ver="1" name="b_xrcb027" src="s" help_table="" help_find="" help_dlang="" help_field="" help_wc="" mapping_widget="" status="" />
    <hfield src="s" ver="1" name="xrca100_1" help_table="" help_find="" help_dlang="" help_field="" mapping_widget="" help_wc="" cite_std="N" status="u" />
    <hfield src="s" ver="1" name="xrca001" help_table="" help_find="" help_dlang="" help_field="" mapping_widget="" help_wc="" cite_std="N" status="u" />
    <hfield src="s" ver="1" name="xrcc118_1" help_table="" help_find="" help_dlang="" help_field="" mapping_widget="" help_wc="" cite_std="N" status="u" />
    <hfield src="s" ver="1" name="xrcb028" help_table="" help_find="" help_dlang="" help_field="" mapping_widget="" help_wc="" cite_std="N" status="u" />
    <hfield src="s" ver="1" name="xrcadocno" help_table="" help_find="" help_dlang="" help_field="" mapping_widget="" help_wc="" cite_std="N" status="u" />
    <hfield src="s" ver="1" name="xrcc108_1" help_table="" help_find="" help_dlang="" help_field="" mapping_widget="" help_wc="" cite_std="N" status="u" />
    <hfield src="s" ver="1" name="xrcc002" help_table="" help_find="" help_dlang="" help_field="" mapping_widget="" help_wc="" cite_std="N" status="u" />
  </help_code>
  <strings>
    <sfield name="page_1" text="基本查詢" lstr="u" />
    <sfield name="lbl_xrcadocno" text="帳款單號" lstr="u" />
    <sfield name="lbl_xrcald" text="帳別" lstr="" />
    <sfield name="bpage_1" text="帳款資訊" lstr="u" />
    <sfield name="lbl_sel" text="選取項目" lstr="" />
    <sfield name="lbl_xrcc001" text="期別" lstr="" />
    <sfield name="lbl_xrccseq" text="項次" lstr="" />
    <sfield name="lbl_xrcc108" text="原幣餘額" lstr="u" />
    <sfield name="lbl_xrcc118" text="本幣餘額" lstr="u" />
    <sfield name="lbl_xrcbseq" text="項次" lstr="" />
    <sfield name="lbl_xrcb001" text="來源類型" lstr="" />
    <sfield name="lbl_xrcb002" text="來源單號" lstr="u" />
    <sfield name="lbl_xrcb027" text="發票代碼" lstr="" />
    <sfield name="lbl_xrcb028" text="發票號碼" lstr="" />
    <sfield name="lbl_xrcborga" text="來源組織" lstr="u" />
    <sfield name="lbl_hbegin" text="第" lstr="" />
    <sfield name="lbl_hsep" text="筆(共" lstr="" />
    <sfield name="lbl_hend" text="筆)" lstr="" />
    <sfield name="lbl_dbegin" text="第" lstr="" />
    <sfield name="lbl_dsep" text="項(共" lstr="" />
    <sfield name="lbl_dend" text="項)" lstr="" />
    <sfield name="axrq390.group_1" text="基本資料" lstr="u" />
    <sfield name="axrq390.group_2" text="QBE" lstr="u" />
    <sfield name="lbl_dateend" text="資料截至日期" comment="" lstr="u" />
    <sfield name="lbl_check" text="待抵顯示否" comment="" lstr="u" />
    <sfield name="axrq390.group_3" text="彙總查詢" lstr="u" />
    <sfield name="cmt_type" text="" comment="" lstr="u" />
    <sfield name="賬款對象" text="" lstr="u" />
    <sfield name="業務人員＋帳款對象" text="" lstr="u" />
    <sfield name="cmt_xrca004" text="cmt_xrca004" comment="" lstr="d" />
    <sfield name="lbl_xrca004" text="帳款對象" comment="" lstr="u" />
    <sfield name="lbl_xrca007" text="帳款類別" comment="" lstr="u" />
    <sfield name="cmt_xrca007" text="cmt_xrca007" comment="" lstr="d" />
    <sfield name="cmt_xrca014" text="cmt_xrca014" comment="" lstr="d" />
    <sfield name="lbl_xrca014" text="業務人員" comment="" lstr="u" />
    <sfield name="cmt_xrca100" text="cmt_xrca100" comment="" lstr="d" />
    <sfield name="lbl_xrca100" text="幣別" comment="" lstr="u" />
    <sfield name="cmt_xrcborga" text="cmt_xrcborga" comment="" lstr="d" />
    <sfield name="cmt_xrcb002" text="cmt_xrcb002" comment="" lstr="d" />
    <sfield name="cmt_xrcb028" text="cmt_xrcb028" comment="" lstr="d" />
    <sfield name="lbl_xrca004_1" text="客戶編號 /名稱" comment="" lstr="u" />
    <sfield name="page_4.axrq390" text="多帳期資料" lstr="u" />
    <sfield name="lbl_xrcc003" text="應收款日" comment="" lstr="u" />
    <sfield name="lbl_xrcc002" text="期別" comment="" lstr="u" />
    <sfield name="lbl_xrcc108_1" text="原幣未沖銷餘額" comment="" lstr="u" />
    <sfield name="lbl_xrcc118_1" text="本幣未沖銷餘額" comment="" lstr="u" />
    <sfield name="lbl_xrcborga_1" text="來源組織" comment="" lstr="u" />
    <sfield name="lbl_xrca001" text="帳款單性質" comment="" lstr="u" />
  </strings>
  <sa_spec />
  <table ver="1" cite_std="N">
    <tbl name="xrca_t" main="Y" head="Y" pk="" fk_detail="" parent="" fk_master="" src="s" status="" def_pk="" def_fk_master="" def_fk_detail="" />
    <tbl name="xrcb_t" main="N" head="N" pk="" fk_detail="" parent="xrca_t" fk_master="" src="s" status="" def_pk="" def_fk_master="" def_fk_detail="">
      <sr name="s_detail3" src="s" insert="Y" delete="Y" append="Y" cascade="Y" kind="Table" status="" />
    </tbl>
    <tbl name="xrcc_t" main="N" head="N" pk="" fk_detail="" parent="xrca_t" fk_master="" src="s" status="" def_pk="" def_fk_master="" def_fk_detail="">
      <sr name="s_detail1" src="s" insert="Y" delete="Y" append="Y" cascade="Y" kind="Table" status="" />
    </tbl>
  </table>
  <all cite_std="N" ver="" src="" status="u">
<![CDATA[程式說明及目的： 應收餘額明細查詢
標準作業功能：單選/單選取消/多選/多選取消/報表/詳細資料/查詢/篩選/條件查詢/條件儲存/說明/離開/重新整理
作業類型：查詢作業
輸入模式：列表模式-Q001_00
作業資料來源(Detail)：
 資料來源表：xrca_t (應收憑單單頭)
                        xrcb_t (應收憑單單身)
                        xrcc_t (多帳期明細) 


補充說明：
   依截止日期推算各單據的餘額
   多帳期頁籤隨著帳款資訊游標而連動

處理邏輯;
1.帳款訊息頁籤
   彙總查詢條件
   1.1.依帳款對象
       xrca004, xrca100 為group
       隱藏欄位: 業務人員

   1.2.依業務人員 + 帳款對象 
       xrca014, xrca004, xrca100 為group

   1.3.金額計算由 xrcc (多帳期資料）合計而來
   1.4 客戶為一次性交易對象時, 顯示一次性交易對象名稱 


2.多帳期資訊頁籤
  2.1 xrcadocdt <= 條件截止日期 and  xrcc108-xrcc109 > 0 
  2.2 取出xrdadocdt > 條件截止日期的沖帳資料加回來
      2.2.1  暫估單時必須取出沖暫估日期 xrcadocdt  > 條件截止日期的單據將金額加回來
             沖暫估檔取的是 xrcf 
              select sum(xrcf103), sum(xrcf113)... from xrcf_t  ,xrca_t 
               where  xrcadocno = xrcfdocno 
                 and xrcfseq = xrccseq
                 and xrcf008 = 原始單據
                 and xrcf009 = 原始單據項次
                 and xrcf010 = xrcc001   #期別 
                 and xrcadocdt >  條件截止日期
                 
      ex: 條件截止日: 4/30 目前資料 xcc108-xrcc109 餘額  = 0 
          5/1 沖帳 100 元
          則本程式呈現的餘額為 100元

  2.3 上述彙總查詢條件 +xrcb001,+xrcadocno, xrca001,xrcaorga,xrcb002,xrcb027,xrcb028,xrcc002, xrcc003 為 group條件   

  2.4 按單身帳款單可超連結至該支程式  

3.帳款單性質為 2* 表示待抵類, 以負數呈現

4. 帳款單性質:21 溢(預)收待抵單 檢核原來源 axr  單是否為已沖帳(已收款才表示帳款成立)
　 xrca019 為來源單據 ,串回來源單據
   若有未沖餘額, 則待抵單不應顯示 否則一正一負就沖完了
]]>
</all>
  <field src="s" ver="1" column="" name="b_xrccseq" table="" attribute="" type="" req="" i_zoom="" c_zoom="" chk_ref="" items="" default="" max="" min="" can_edit="Y" can_query="Y" widget="Edit" cite_std="N" status="d">
<![CDATA[]]>
</field>
  <field src="s" ver="1" column="" name="b_xrcc001" table="" attribute="" type="" req="" i_zoom="" c_zoom="" chk_ref="" items="" default="" max="" min="" can_edit="Y" can_query="Y" widget="Edit" cite_std="N" status="d">
<![CDATA[]]>
</field>
  <field src="s" ver="1" column="" name="xrccse1" table="" attribute="" type="" req="" i_zoom="" c_zoom="" chk_ref="" items="" default="" max="" min="" can_edit="Y" can_query="Y" widget="Edit" cite_std="N" status="d">
<![CDATA[]]>
</field>
  <field src="s" ver="1" column="" name="xrccsea" table="" attribute="" type="" req="" i_zoom="" c_zoom="" chk_ref="" items="" default="" max="" min="" can_edit="Y" can_query="Y" widget="Edit" cite_std="N" status="d">
<![CDATA[]]>
</field>
  <field src="s" ver="1" column="" name="xrcddocno" table="" attribute="" type="" req="" i_zoom="" c_zoom="" chk_ref="" items="" default="" max="" min="" can_edit="Y" can_query="Y" widget="Edit" cite_std="N" status="d">
<![CDATA[]]>
</field>
  <field src="s" ver="1" column="" name="b_xrcbseq" table="" attribute="" type="" req="" i_zoom="" c_zoom="" chk_ref="" items="" default="" max="" min="" can_edit="Y" can_query="Y" widget="Edit" cite_std="N" status="d">
<![CDATA[]]>
</field>
  <field cite_std="N" name="b_xrcadocno" ver="1" src="s" column="xrcadocno" table="xrca_t" attribute="C203" type="varchar2(20)" req="Y" i_zoom="" c_zoom="q_xrcadocno" chk_ref="" items="" default="" max="" min="" can_edit="Y" can_query="Y" widget="Edit" status="d">
<![CDATA[]]>
</field>
  <field cite_std="N" name="b_xrcb002" ver="1" src="s" column="xrcb002" table="xrcb_t" attribute="C203" type="varchar2(20)" req="N" i_zoom="" c_zoom="q_isafdocno" chk_ref="" items="" default="" max="" min="" can_edit="Y" can_query="Y" widget="Edit" status="">
<![CDATA[]]>
</field>
  <field cite_std="N" name="b_xrcb027" ver="1" src="s" column="xrcb027" table="xrcb_t" attribute="C552" type="varchar2(20)" req="N" i_zoom="" c_zoom="" chk_ref="" items="" default="" max="" min="" can_edit="Y" can_query="Y" widget="Edit" status="">
<![CDATA[]]>
</field>
  <field cite_std="N" name="b_xrcb001" ver="1" src="s" column="xrcb001" table="xrcb_t" attribute="C002" type="varchar2(10)" req="N" i_zoom="" c_zoom="" chk_ref="" items="24" default="" max="" min="" can_edit="Y" can_query="Y" widget="ComboBox" status="">
<![CDATA[]]>
</field>
  <field src="s" ver="1" column="" name="xrca100_1" table="" attribute="" type="" req="" i_zoom="" c_zoom="" chk_ref="" items="" default="" max="" min="" can_edit="Y" can_query="Y" widget="Edit" cite_std="N" status="u">
<![CDATA[]]>
</field>
  <field src="s" ver="1" column="" name="type" table="" attribute="" type="" req="" i_zoom="" c_zoom="" chk_ref="" items="" default="" max="" min="" can_edit="Y" can_query="Y" widget="RadioGroup" cite_std="N" status="u">
<![CDATA[]]>
</field>
  <field src="s" ver="1" column="" name="dateedit_1" table="" attribute="" type="" req="" i_zoom="" c_zoom="" chk_ref="" items="" default="" max="" min="" can_edit="Y" can_query="Y" widget="DateEdit" cite_std="N" status="u">
<![CDATA[預設值 = today 
]]>
</field>
  <field src="s" ver="1" column="" name="check" table="" attribute="" type="" req="Y" i_zoom="" c_zoom="" chk_ref="" items="" default="Y" max="" min="" can_edit="Y" can_query="Y" widget="CheckBox" cite_std="N" status="u">
<![CDATA[未勾選待抵呈現時則條件要過濾 xrca001[1,1] <> '2' 

待抵性質以負數呈現
]]>
</field>
  <field src="s" ver="1" column="" name="xrcc001" table="" attribute="" type="" req="" i_zoom="" c_zoom="" chk_ref="" items="" default="" max="" min="" can_edit="Y" can_query="Y" widget="Edit" cite_std="N" status="u">
<![CDATA[]]>
</field>
  <field cite_std="N" name="b_xrcald" ver="1" src="s" column="xrcald" table="xrca_t" attribute="C501" type="varchar2(5)" req="Y" i_zoom="" c_zoom="q_authorised_ld" chk_ref="" items="" default="" max="" min="" can_edit="Y" can_query="Y" widget="ButtonEdit" status="u">
<![CDATA[不可空白
]]>
</field>
  <field src="s" ver="1" column="" name="xrccseq" table="" attribute="" type="" req="" i_zoom="" c_zoom="" chk_ref="" items="" default="" max="" min="" can_edit="Y" can_query="Y" widget="Edit" cite_std="N" status="u">
<![CDATA[]]>
</field>
  <field src="s" ver="1" column="" name="xrcadocno" table="" attribute="" type="" req="" i_zoom="" c_zoom="" chk_ref="" items="" default="" max="" min="" can_edit="Y" can_query="Y" widget="Edit" cite_std="N" status="u">
<![CDATA[]]>
</field>
  <field src="s" ver="1" column="" name="xrcc108_1" table="" attribute="" type="" req="" i_zoom="" c_zoom="" chk_ref="" items="" default="" max="" min="" can_edit="Y" can_query="Y" widget="Edit" cite_std="N" status="u">
<![CDATA[]]>
</field>
  <field src="s" ver="1" column="" name="xrcc002" table="" attribute="" type="" req="" i_zoom="" c_zoom="" chk_ref="" items="" default="" max="" min="" can_edit="Y" can_query="Y" widget="Edit" cite_std="N" status="u">
<![CDATA[]]>
</field>
  <field src="s" ver="1" column="" name="xrca001" table="" attribute="" type="" req="" i_zoom="" c_zoom="" chk_ref="" items="" default="" max="" min="" can_edit="Y" can_query="Y" widget="Edit" cite_std="N" status="u">
<![CDATA[]]>
</field>
  <field src="s" ver="1" column="" name="xrcc118_1" table="" attribute="" type="" req="" i_zoom="" c_zoom="" chk_ref="" items="" default="" max="" min="" can_edit="Y" can_query="Y" widget="Edit" cite_std="N" status="u">
<![CDATA[]]>
</field>
  <field src="s" ver="1" column="" name="xrcb028" table="" attribute="" type="" req="" i_zoom="" c_zoom="" chk_ref="" items="" default="" max="" min="" can_edit="Y" can_query="Y" widget="Edit" cite_std="N" status="u">
<![CDATA[]]>
</field>
  <field cite_std="N" name="xrca004_1" ver="1" src="s" column="" table="" attribute="" type="number(10,0)" req="N" i_zoom="" c_zoom="" chk_ref="" items="" default="" max="" min="" can_edit="Y" can_query="Y" widget="Edit" status="u">
<![CDATA[]]>
</field>
  <field src="s" ver="1" column="" name="xrca004" table="" attribute="" type="" req="" i_zoom="" c_zoom="q_pmaa001" chk_ref="" items="" default="" max="" min="" can_edit="Y" can_query="Y" widget="ButtonEdit" cite_std="N" status="u">
<![CDATA[]]>
</field>
  <field cite_std="N" name="b_xrcc118" ver="1" src="s" column="xrcc118" table="xrcc_t" attribute="N202" type="number(20,6)" req="N" i_zoom="" c_zoom="" chk_ref="" items="" default="0" max="" min="" can_edit="Y" can_query="Y" widget="Edit" status="">
<![CDATA[]]>
</field>
  <field cite_std="N" name="xrcc003" ver="1" src="s" column="" table="" attribute="" type="number(10,0)" req="N" i_zoom="" c_zoom="" chk_ref="" items="" default="" max="" min="" can_edit="Y" can_query="Y" widget="DateEdit" status="u">
<![CDATA[]]>
</field>
  <field cite_std="N" name="b_xrcborga" ver="1" src="s" column="xrcborga" table="xrcb_t" attribute="C007" type="varchar2(10)" req="N" i_zoom="" c_zoom="q_ooef001" chk_ref="" items="" default="" max="" min="" can_edit="Y" can_query="Y" widget="ButtonEdit" status="">
<![CDATA[]]>
</field>
  <field cite_std="N" name="b_xrcc108" ver="1" src="s" column="xrcc108" table="xrcc_t" attribute="N202" type="number(20,6)" req="N" i_zoom="" c_zoom="" chk_ref="" items="" default="0" max="" min="" can_edit="Y" can_query="Y" widget="Edit" status="">
<![CDATA[]]>
</field>
  <field cite_std="N" name="xrca014_1" ver="1" src="s" column="" table="" attribute="N004" type="number(10,0)" req="N" i_zoom="" c_zoom="" chk_ref="" items="" default="" max="" min="" can_edit="Y" can_query="Y" widget="Edit" status="u">
<![CDATA[]]>
</field>
  <field src="s" ver="1" column="" name="xrca007" table="" attribute="" type="" req="" i_zoom="" c_zoom="q_oocq002" chk_ref="" items="" default="" max="" min="" can_edit="Y" can_query="Y" widget="ButtonEdit" cite_std="N" status="u">
<![CDATA[]]>
</field>
  <field cite_std="N" name="b_xrcb028" ver="1" src="s" column="xrcb028" table="xrcb_t" attribute="C552" type="varchar2(20)" req="N" i_zoom="" c_zoom="" chk_ref="" items="" default="" max="" min="" can_edit="Y" can_query="Y" widget="Edit" status="">
<![CDATA[]]>
</field>
  <field src="s" ver="1" column="" name="xrcborga" table="" attribute="" type="" req="" i_zoom="" c_zoom="" chk_ref="" items="" default="" max="" min="" can_edit="Y" can_query="Y" widget="ButtonEdit" cite_std="N" status="u">
<![CDATA[]]>
</field>
  <field src="s" ver="1" column="" name="xrcb002" table="" attribute="" type="" req="" i_zoom="" c_zoom="" chk_ref="" items="" default="" max="" min="" can_edit="Y" can_query="Y" widget="Edit" cite_std="N" status="u">
<![CDATA[]]>
</field>
  <field src="s" ver="1" column="" name="xrca014" table="" attribute="" type="" req="" i_zoom="" c_zoom="" chk_ref="" items="" default="" max="" min="" can_edit="Y" can_query="Y" widget="ButtonEdit" cite_std="N" status="u">
<![CDATA[]]>
</field>
  <field src="s" ver="1" column="" name="xrca100" table="" attribute="" type="" req="" i_zoom="" c_zoom="" chk_ref="" items="" default="" max="" min="" can_edit="Y" can_query="Y" widget="ButtonEdit" cite_std="N" status="u">
<![CDATA[]]>
</field>
  <act cite_std="N" id="output" ver="1" src="s" type="all" gen_code="Y" status="">
<![CDATA[]]>
</act>
  <act cite_std="N" id="query" ver="1" src="s" type="all" gen_code="Y" status="">
<![CDATA[]]>
</act>
  <act cite_std="N" id="datainfo" ver="1" src="s" type="all" gen_code="Y" status="">
<![CDATA[]]>
</act>
  <act cite_std="N" id="insert" ver="1" src="s" type="all" gen_code="Y" status="">
<![CDATA[]]>
</act>
  <exclude ver="" cite_std="N" src="">
    <widget name="lbl_b_xrcadocno" src="" status="d" />
  </exclude>
</spec>