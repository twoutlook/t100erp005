<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<spec prog="apmp490_02" std_prog="apmp490_02" erpver="1.0" ver="2" module="APM" type="S" booking="N" designer_ver="1.0" class="P" env="s" zone="t10prd" identity="s">
  <other>
    <code_template value="F" status="u"/>
    <free_style value="Y" status="u"/>
    <start_arg value="" status="u"/>
  </other>
  <toolbar items=""/>
  <table ver="1" cite_std="N">
    <tbl name="apaa_t" main="Y" head="Y" pk="" fk_detail="" parent="" fk_master="" src="s" upper_table="" upper_key="" this_key="" status=""/>
  </table>
  <all cite_std="N" ver="" src="" status=""/>
  <field cite_std="N" name="bt01" ver="1" src="s" column="chr10" table="type_t" attribute="" type="" req="N" i_zoom="" c_zoom="" chk_ref="" items=" " default="" max_compare="" max="" min_compare="" min="" can_edit="Y" can_query="Y" widget="ButtonEdit" status="">
    <![CDATA[供應商：
1.選擇"依料件主檔設定"或"指定單一供應商"時，才可維護
2."指定單一供應商"時，為必輸

開窗：q_pmaa001_3() 
             參考apmt500加入s_control_get_sql、s_control_get_doc_sql的條件 

校驗：參考apmt500的開窗v_pmaa001_1 
            將檢查拉出來，以利匯總檢查  
            需做s_control_check_customer()的檢查 ]]>
  </field>
  <field cite_std="N" name="diff_day_02_03" ver="1" src="s" column="num10" table="type_t" attribute="" type="" req="N" i_zoom="" c_zoom="" chk_ref="" items=" " default="" max_compare="" max="" min_compare="" min="" can_edit="Y" can_query="Y" widget="Edit" status="">
    <![CDATA[差異天數：
   ●欄位控管：
     資料欄位: FORMONLY/Display Only
     校驗: 無
     帶值:無
     計算或處理:差異天數 = 收貨日期 - 採購交貨日期
]]>
  </field>
  <field cite_std="N" name="ed01" ver="1" src="s" column="num5" table="type_t" attribute="" type="" req="Y" i_zoom="" c_zoom="" chk_ref="" items=" " default="" max_compare="" max="" min_compare="" min="" can_edit="Y" can_query="Y" widget="Edit" status="">
    <![CDATA[供應商：
1.選擇"主要供應商分配優先，餘量分配"時，才可維護，必輸不可空白，數量需>0

]]>
  </field>
  <field cite_std="N" name="imaal003_02_01_1" ver="1" src="s" column="imaal003" table="imaal_t" attribute="" type="" req="N" i_zoom="" c_zoom="" chk_ref="" items="" default="" max_compare="" max="" min_compare="" min="" can_edit="Y" can_query="Y" widget="Edit" status="">
    <![CDATA[]]>
  </field>
  <field cite_std="N" name="imaal003_02_01_2" ver="1" src="s" column="imaal003" table="imaal_t" attribute="" type="" req="N" i_zoom="" c_zoom="" chk_ref="" items="" default="" max_compare="" max="" min_compare="" min="" can_edit="Y" can_query="Y" widget="Edit" status="">
    <![CDATA[]]>
  </field>
  <field cite_std="N" name="imaal004_02_01_1" ver="1" src="s" column="imaal004" table="imaal_t" attribute="" type="" req="N" i_zoom="" c_zoom="" chk_ref="" items="" default="" max_compare="" max="" min_compare="" min="" can_edit="Y" can_query="Y" widget="Edit" status="">
    <![CDATA[]]>
  </field>
  <field cite_std="N" name="imaal004_02_01_2" ver="1" src="s" column="imaal004" table="imaal_t" attribute="" type="" req="N" i_zoom="" c_zoom="" chk_ref="" items="" default="" max_compare="" max="" min_compare="" min="" can_edit="Y" can_query="Y" widget="Edit" status="">
    <![CDATA[]]>
  </field>
  <field cite_std="N" name="imae116_02_04" ver="1" src="s" column="imae116" table="imae_t" attribute="" type="" req="N" i_zoom="" c_zoom="" chk_ref="" items="5052" default="&apos;1&apos;" max_compare="" max="" min_compare="" min="" can_edit="Y" can_query="Y" widget="ComboBox" status="">
    <![CDATA[]]>
  </field>
  <field cite_std="N" name="pmaal004_02_01" ver="1" src="s" column="pmaal004" table="pmaal_t" attribute="" type="" req="N" i_zoom="" c_zoom="" chk_ref="" items="" default="" max_compare="" max="" min_compare="" min="" can_edit="Y" can_query="Y" widget="Edit" status="">
    <![CDATA[]]>
  </field>
  <field cite_std="N" name="pmaal004_02_02" ver="1" src="s" column="pmaal004" table="pmaal_t" attribute="" type="" req="N" i_zoom="" c_zoom="" chk_ref="" items="" default="" max_compare="" max="" min_compare="" min="" can_edit="Y" can_query="Y" widget="Edit" status="">
    <![CDATA[]]>
  </field>
  <field cite_std="N" name="pmaal004_02_03" ver="1" src="s" column="pmaal004" table="pmaal_t" attribute="" type="" req="N" i_zoom="" c_zoom="" chk_ref="" items="" default="" max_compare="" max="" min_compare="" min="" can_edit="Y" can_query="Y" widget="Edit" status="">
    <![CDATA[]]>
  </field>
  <field cite_std="N" name="pmaal004_02_04" ver="1" src="s" column="pmaal004" table="pmaal_t" attribute="" type="" req="N" i_zoom="" c_zoom="" chk_ref="" items="" default="" max_compare="" max="" min_compare="" min="" can_edit="Y" can_query="Y" widget="Edit" status="">
    <![CDATA[]]>
  </field>
  <field cite_std="N" name="pmdb004_02_01" ver="1" src="s" column="pmdb004" table="pmdb_t" attribute="" type="" req="N" i_zoom="q_imaa001" c_zoom="q_imaa001" chk_ref="v_imaa001" items="" default="" max_compare="" max="" min_compare="" min="" can_edit="Y" can_query="Y" widget="ButtonEdit" status="">
    <![CDATA[]]>
  </field>
  <field cite_std="N" name="pmdb005_02_01" ver="1" src="s" column="pmdb005" table="pmdb_t" attribute="" type="" req="N" i_zoom="" c_zoom="" chk_ref="" items="" default="" max_compare="" max="" min_compare="" min="" can_edit="Y" can_query="Y" widget="ButtonEdit" status="">
    <![CDATA[]]>
  </field>
  <field cite_std="N" name="pmdb005_02_01_desc" ver="1" src="s" column="" table="" attribute="" type="" req="N" i_zoom="" c_zoom="" chk_ref="" items="" default="" max_compare="" max="" min_compare="" min="" can_edit="Y" can_query="Y" widget="Edit" status="">
    <![CDATA[]]>
  </field>
  <field cite_std="N" name="pmdb007_02_01" ver="1" src="s" column="pmdb007" table="pmdb_t" attribute="" type="" req="N" i_zoom="q_ooca001_1" c_zoom="q_ooca001_1" chk_ref="v_ooca001" items="" default="" max_compare="" max="" min_compare="" min="" can_edit="Y" can_query="Y" widget="ButtonEdit" status="">
    <![CDATA[]]>
  </field>
  <field cite_std="N" name="pmdb007_02_01_desc" ver="1" src="s" column="" table="" attribute="" type="" req="N" i_zoom="" c_zoom="" chk_ref="" items="" default="" max_compare="" max="" min_compare="" min="" can_edit="Y" can_query="Y" widget="Edit" status="">
    <![CDATA[]]>
  </field>
  <field cite_std="N" name="pmdb014_02_01" ver="1" src="s" column="pmdb014" table="pmdb_t" attribute="" type="" req="N" i_zoom="" c_zoom="" chk_ref="" items="2037" default="1" max_compare="" max="" min_compare="" min="" can_edit="Y" can_query="Y" widget="ComboBox" status="">
    <![CDATA[1.此單身不可以新增刪除，只能修改供應商、採購料號、採購產品特徵、採購單位、採購數量、計價單位、計價數量等欄位
2.顯示分配後之採購底稿資料

]]>
  </field>
  <field cite_std="N" name="pmdbent_02_01" ver="1" src="s" column="pmdbent" table="pmdb_t" attribute="" type="" req="Y" i_zoom="" c_zoom="" chk_ref="" items="" default="" max_compare="" max="" min_compare="" min="" can_edit="Y" can_query="Y" widget="Edit" status="">
    <![CDATA[]]>
  </field>
  <field cite_std="N" name="pmdbsite_02_01" ver="1" src="s" column="pmdbsite" table="pmdb_t" attribute="" type="" req="N" i_zoom="q_ooed004" c_zoom="q_ooef001_4" chk_ref="" items="" default="" max_compare="" max="" min_compare="" min="" can_edit="Y" can_query="Y" widget="Edit" status="">
    <![CDATA[]]>
  </field>
  <field cite_std="N" name="pmdl004_02_01" ver="1" src="s" column="pmdl004" table="pmdl_t" attribute="" type="" req="Y" i_zoom="q_pmaa001_3" c_zoom="q_pmaa001_3" chk_ref="v_pmaa001_1" items="" default="" max_compare="" max="" min_compare="" min="" can_edit="Y" can_query="Y" widget="ButtonEdit" status="">
    <![CDATA[開窗：where條件需加入 s_control_get_supplier_sql 

校驗：使用s_control_check_supplier檢查]]>
  </field>
  <field cite_std="N" name="pmdl004_02_02" ver="1" src="s" column="pmdl004" table="pmdl_t" attribute="" type="" req="N" i_zoom="q_pmaa001_3" c_zoom="q_pmaa001_3" chk_ref="v_pmaa001_1" items="" default="" max_compare="" max="" min_compare="" min="" can_edit="Y" can_query="Y" widget="ButtonEdit" status="">
    <![CDATA[1.此單身僅顯示不可維護
2.抓取採購單符合料號 = 單頭遊標所在的採購料號 且 採購日期 >= 今天 - 參考資料期間 之相關資料顯示
3.增加串查：供應商、採購單
]]>
  </field>
  <field cite_std="N" name="pmdl009_02_02" ver="1" src="s" column="pmdl009" table="pmdl_t" attribute="" type="" req="N" i_zoom="q_pmad002_2" c_zoom="q_ooib002_1" chk_ref="v_pmad002_1" items="" default="" max_compare="" max="" min_compare="" min="" can_edit="Y" can_query="Y" widget="Edit" status="">
    <![CDATA[]]>
  </field>
  <field cite_std="N" name="pmdl010_02_02" ver="1" src="s" column="pmdl010" table="pmdl_t" attribute="" type="" req="N" i_zoom="q_oocq002" c_zoom="q_oocq002" chk_ref="v_oocq002_238" items="" default="" max_compare="" max="" min_compare="" min="" can_edit="Y" can_query="Y" widget="Edit" status="">
    <![CDATA[]]>
  </field>
  <field cite_std="N" name="pmdl011_02_02" ver="1" src="s" column="pmdl011" table="pmdl_t" attribute="" type="" req="N" i_zoom="q_oodb002_2" c_zoom="q_oodb002_2" chk_ref="v_oodb002" items="" default="" max_compare="" max="" min_compare="" min="" can_edit="Y" can_query="Y" widget="Edit" status="">
    <![CDATA[]]>
  </field>
  <field cite_std="N" name="pmdl012_02_02" ver="1" src="s" column="pmdl012" table="pmdl_t" attribute="" type="" req="N" i_zoom="" c_zoom="" chk_ref="" items="" default="" max_compare="" max="" min_compare="" min="" can_edit="Y" can_query="Y" widget="Edit" status="">
    <![CDATA[]]>
  </field>
  <field cite_std="N" name="pmdl013_02_02" ver="1" src="s" column="pmdl013" table="pmdl_t" attribute="" type="" req="Y" i_zoom="" c_zoom="" chk_ref="" items="" default="N" max_compare="" max="" min_compare="" min="" can_edit="Y" can_query="Y" widget="CheckBox" status="">
    <![CDATA[]]>
  </field>
  <field cite_std="N" name="pmdl015_02_02" ver="1" src="s" column="pmdl015" table="pmdl_t" attribute="" type="" req="N" i_zoom="q_ooaj002_1" c_zoom="q_ooaj002_1" chk_ref="v_ooaj002" items="" default="" max_compare="" max="" min_compare="" min="" can_edit="Y" can_query="Y" widget="Edit" status="">
    <![CDATA[]]>
  </field>
  <field cite_std="N" name="pmdl016_02_02" ver="1" src="s" column="pmdl016" table="pmdl_t" attribute="" type="" req="N" i_zoom="" c_zoom="" chk_ref="" items="" default="" max_compare="" max="" min_compare="" min="" can_edit="Y" can_query="Y" widget="Edit" status="">
    <![CDATA[]]>
  </field>
  <field cite_std="N" name="pmdldocdt_02_02" ver="1" src="s" column="pmdldocdt" table="pmdl_t" attribute="" type="" req="Y" i_zoom="" c_zoom="" chk_ref="" items="" default="" max_compare="" max="" min_compare="" min="" can_edit="Y" can_query="Y" widget="DateEdit" status="">
    <![CDATA[]]>
  </field>
  <field cite_std="N" name="pmdldocno_02_02" ver="1" src="s" column="pmdldocno" table="pmdl_t" attribute="" type="" req="Y" i_zoom="q_ooba002_1" c_zoom="q_pmdldocno" chk_ref="" items="" default="" max_compare="" max="" min_compare="" min="" can_edit="Y" can_query="Y" widget="Edit" status="">
    <![CDATA[]]>
  </field>
  <field cite_std="N" name="pmdn001_02_01" ver="1" src="s" column="pmdn001" table="pmdn_t" attribute="" type="" req="Y" i_zoom="q_imaf001_15" c_zoom="" chk_ref="v_imaf001_14" items="" default="" max_compare="" max="" min_compare="" min="" can_edit="Y" can_query="Y" widget="ButtonEdit" status="">
    <![CDATA[輸入的料號需與請購料號有設置採購替代關係  

開窗：where需加入s_control_get_item_sql 

校驗：參考v_imaf001_14，拉到程式中處理，以利檢查  
            使用s_control_check_item檢查料號 
]]>
  </field>
  <field cite_std="N" name="pmdn002_02_01" ver="1" src="s" column="pmdn002" table="pmdn_t" attribute="" type="" req="Y" i_zoom="" c_zoom="" chk_ref="" items="" default="" max_compare="" max="" min_compare="" min="" can_edit="Y" can_query="Y" widget="ButtonEdit" status="">
    <![CDATA[產品特徵:
  資料欄位:FORMONLY/可Display可Input
  預設值:無
  校驗:
    1.若料件有使用產品特徵時，則此欄位不允許空白
    2.呼叫產品特徵檢核應用元件，檢核輸入的產品特徵值是否合理
    3.當請採勾稽時，採購料號+採購產品特徵與請購料號+請購產品特徵不一樣時，必須檢核是否與請購料號+
      請購產品特徵有替代關係，若沒有則不允許修改
  帶值:無
  計算或處理:
    1.當料件有使用產品特徵功能時此欄位才可輸入
 
]]>
  </field>
  <field cite_std="N" name="pmdn002_02_01_desc" ver="1" src="s" column="" table="" attribute="" type="" req="N" i_zoom="" c_zoom="" chk_ref="" items="" default="" max_compare="" max="" min_compare="" min="" can_edit="Y" can_query="Y" widget="Edit" status="">
    <![CDATA[]]>
  </field>
  <field cite_std="N" name="pmdn006_02_01" ver="1" src="s" column="pmdn006" table="pmdn_t" attribute="" type="" req="Y" i_zoom="q_ooca001_1" c_zoom="q_ooca001_1" chk_ref="v_ooca001" items="" default="" max_compare="" max="" min_compare="" min="" can_edit="Y" can_query="Y" widget="ButtonEdit" status="">
    <![CDATA[採購單位：
   ●欄位控管：
     資料欄位: Formonly/可Display 可Input
     預設值:無
     校驗:1.不允許空白
          2.輸入值需存在[T:單位基本資料檔].[C:單位編號]，且[T:單位基本資料檔].[C:資料狀態]為有效
     帶值:無
     計算或處理:1.若有修改採購單位時，需判斷採購數量*(採購單位與請購單位)換算率，
                  是否大於(需求數量*可超交率-已轉採購量)
                2.若修改採購單位需自動推算計價單位數量
                  
   ●開窗處理:
    1.依單位標準開窗

]]>
  </field>
  <field cite_std="N" name="pmdn006_02_01_desc" ver="1" src="s" column="" table="" attribute="" type="" req="N" i_zoom="" c_zoom="" chk_ref="" items="" default="" max_compare="" max="" min_compare="" min="" can_edit="Y" can_query="Y" widget="Edit" status="">
    <![CDATA[]]>
  </field>
  <field cite_std="N" name="pmdn007_02_01" ver="1" src="s" column="pmdn007" table="pmdn_t" attribute="" type="" req="Y" i_zoom="" c_zoom="" chk_ref="" items="" default="0" max_compare="" max="" min_compare="&gt;" min="0.000" can_edit="Y" can_query="Y" widget="Edit" status="">
    <![CDATA[採購數量：
   ●欄位控管：
     資料欄位: Formonly/可Display 可Input
     預設值:無
     校驗:1.不允許空白
          2.不可小於等於0
     帶值:無
     計算或處理:1.若有修改採購數量時，需判斷採購數量*(採購單位與請購單位)換算率，
                  是否大於未轉採購量
                2.若修改採購數量時需自動推算計價數量                  
]]>
  </field>
  <field cite_std="N" name="pmdn007_2_02_02" ver="1" src="s" column="pmdn007" table="pmdn_t" attribute="" type="" req="Y" i_zoom="" c_zoom="" chk_ref="" items="" default="0" max_compare="" max="" min_compare="&gt;" min="0.000" can_edit="Y" can_query="Y" widget="Edit" status="">
    <![CDATA[]]>
  </field>
  <field cite_std="N" name="pmdn008_02_01" ver="2" src="s" column="pmdn008" table="pmdn_t" attribute="" type="" req="Y" i_zoom="q_ooca001_1" c_zoom="" chk_ref="v_ooca001" items="" default="" max_compare="" max="" min_compare="" min="" can_edit="Y" can_query="Y" widget="ButtonEdit" status="u">
    <![CDATA[採購料號主檔的參考單位(imaf015)，若不使用參考單位時則此欄位為NULL 

2015/01/20 此欄位不可輸入]]>
  </field>
  <field cite_std="N" name="pmdn008_02_01_desc" ver="1" src="s" column="" table="" attribute="" type="" req="N" i_zoom="" c_zoom="" chk_ref="" items="" default="" max_compare="" max="" min_compare="" min="" can_edit="Y" can_query="Y" widget="Edit" status="">
    <![CDATA[]]>
  </field>
  <field cite_std="N" name="pmdn009_02_01" ver="2" src="s" column="pmdn009" table="pmdn_t" attribute="" type="" req="Y" i_zoom="" c_zoom="" chk_ref="" items="" default="0" max_compare="" max="" min_compare="&gt;" min="0.000" can_edit="Y" can_query="Y" widget="Edit" status="u">
    <![CDATA[採購數量*(採購單位與參考單位換算率)，若不使用參考單位時則此欄位為NULL 

2015/01/20 此欄位不可輸入 ]]>
  </field>
  <field cite_std="N" name="pmdn010_02_01" ver="1" src="s" column="pmdn010" table="pmdn_t" attribute="" type="" req="Y" i_zoom="q_ooca001_1" c_zoom="q_ooca001_1" chk_ref="v_ooca001" items="" default="" max_compare="" max="" min_compare="" min="" can_edit="Y" can_query="Y" widget="ButtonEdit" status="">
    <![CDATA[計價單位：
   ●欄位控管：
     資料欄位: Formonly/可Display 可Input
     預設值:無
     校驗:1.不允許空白
          2.輸入值需存在[T:單位基本資料檔].[C:單位編號]，且[T:單位基本資料檔].[C:資料狀態]為有效
     帶值:無
     計算或處理:1.若有修改計價單位時，需自動推算計價數量
                2.若採購料建設置不使用採購計價單位時，則此欄位不可維護，計價單位預設採購單位，計價數量預設採購數量
                  
   ●開窗處理:
    1.依單位標準開窗

]]>
  </field>
  <field cite_std="N" name="pmdn010_02_01_desc" ver="1" src="s" column="" table="" attribute="" type="" req="N" i_zoom="" c_zoom="" chk_ref="" items="" default="" max_compare="" max="" min_compare="" min="" can_edit="Y" can_query="Y" widget="Edit" status="">
    <![CDATA[]]>
  </field>
  <field cite_std="N" name="pmdn011_02_01" ver="1" src="s" column="pmdn011" table="pmdn_t" attribute="" type="" req="Y" i_zoom="" c_zoom="" chk_ref="" items="" default="0" max_compare="" max="" min_compare="&gt;" min="0.000" can_edit="Y" can_query="Y" widget="Edit" status="">
    <![CDATA[計價數量：
   ●欄位控管：
     資料欄位: Formonly/可Display 可Input
     預設值:無
     校驗:1.不允許空白
          2.不可小於0
     帶值:無
     計算或處理:1.無            
]]>
  </field>
  <field cite_std="N" name="pmdn014_02_01" ver="1" src="s" column="pmdn014" table="pmdn_t" attribute="" type="" req="Y" i_zoom="" c_zoom="" chk_ref="" items="" default="" max_compare="" max="" min_compare="" min="" can_edit="Y" can_query="Y" widget="DateEdit" status="">
    <![CDATA[]]>
  </field>
  <field cite_std="N" name="pmdn015_02_02" ver="1" src="s" column="pmdn015" table="pmdn_t" attribute="" type="" req="Y" i_zoom="" c_zoom="" chk_ref="" items="" default="0" max_compare="" max="" min_compare="&gt;=" min="0.000" can_edit="Y" can_query="Y" widget="Edit" status="">
    <![CDATA[]]>
  </field>
  <field cite_std="N" name="pmdn040_02_02" ver="1" src="s" column="" table="pmdn_t" attribute="" type="" req="N" i_zoom="" c_zoom="" chk_ref="" items="" default="" max_compare="" max="" min_compare="" min="" can_edit="Y" can_query="Y" widget="ComboBox" status="">
    <![CDATA[]]>
  </field>
  <field cite_std="N" name="pmdn050_02_01" ver="1" src="s" column="pmdn050" table="pmdn_t" attribute="" type="" req="N" i_zoom="" c_zoom="" chk_ref="" items="" default="" max_compare="" max="" min_compare="" min="" can_edit="Y" can_query="Y" widget="Edit" status="">
    <![CDATA[2015/01/07 增加備註]]>
  </field>
  <field cite_std="N" name="pmdo013_02_03" ver="1" src="s" column="pmdo013" table="pmdo_t" attribute="" type="" req="N" i_zoom="" c_zoom="" chk_ref="" items="" default="" max_compare="" max="" min_compare="" min="" can_edit="Y" can_query="Y" widget="DateEdit" status="">
    <![CDATA[]]>
  </field>
  <field cite_std="N" name="pmds009_02_03" ver="1" src="s" column="pmds009" table="pmds_t" attribute="" type="" req="N" i_zoom="q_pmaa001_3" c_zoom="q_pmaa001_3" chk_ref="v_pmaa001_1" items="" default="" max_compare="" max="" min_compare="" min="" can_edit="Y" can_query="Y" widget="ButtonEdit" status="">
    <![CDATA[1.此單身僅顯示不可維護
2.抓取收貨單符合料號 = 單頭遊標所在的採購料號 且 收貨日期 >= 今天 - 參考資料期間 之相關資料顯示
3.增加串查：供應商、收貨單

]]>
  </field>
  <field cite_std="N" name="pmdsdocdt_02_03" ver="1" src="s" column="pmdsdocdt" table="pmds_t" attribute="" type="" req="N" i_zoom="" c_zoom="" chk_ref="" items="" default="" max_compare="" max="" min_compare="" min="" can_edit="Y" can_query="Y" widget="DateEdit" status="">
    <![CDATA[]]>
  </field>
  <field cite_std="N" name="pmdsdocno_02_03" ver="1" src="s" column="pmdsdocno" table="pmds_t" attribute="" type="" req="Y" i_zoom="q_ooba002_1" c_zoom="q_pmdsdocno" chk_ref="" items="" default="" max_compare="" max="" min_compare="" min="" can_edit="Y" can_query="Y" widget="ButtonEdit" status="">
    <![CDATA[]]>
  </field>
  <field cite_std="N" name="qcba005_02_04" ver="1" src="s" column="qcba005" table="qcba_t" attribute="" type="" req="N" i_zoom="q_pmaa001_1" c_zoom="q_pmaa001_1" chk_ref="v_pmaa001_2" items="" default="" max_compare="" max="" min_compare="" min="" can_edit="Y" can_query="Y" widget="ButtonEdit" status="">
    <![CDATA[1.此單身僅顯示不可維護
2.抓取檢驗單符合料號 = 單頭遊標所在的採購料號 且 檢驗日期 >= 今天 - 參考資料期間 之相關資料顯示
3.增加串查：供應商、檢驗單
]]>
  </field>
  <field cite_std="N" name="qcba014_02_04" ver="1" src="s" column="qcba014" table="qcba_t" attribute="" type="" req="Y" i_zoom="" c_zoom="" chk_ref="" items="" default="" max_compare="" max="" min_compare="" min="" can_edit="Y" can_query="Y" widget="DateEdit" status="">
    <![CDATA[]]>
  </field>
  <field cite_std="N" name="qcba017_02_04" ver="1" src="s" column="qcba017" table="qcba_t" attribute="" type="" req="Y" i_zoom="" c_zoom="" chk_ref="" items="" default="0" max_compare="" max="" min_compare="&gt;" min="0.000" can_edit="Y" can_query="Y" widget="Edit" status="">
    <![CDATA[]]>
  </field>
  <field cite_std="N" name="qcba018_02_04" ver="1" src="s" column="qcba018" table="qcba_t" attribute="" type="" req="N" i_zoom="" c_zoom="" chk_ref="" items="5051" default="" max_compare="" max="" min_compare="" min="" can_edit="Y" can_query="Y" widget="ComboBox" status="">
    <![CDATA[]]>
  </field>
  <field cite_std="N" name="qcba019_02_04" ver="1" src="s" column="qcba019" table="qcba_t" attribute="" type="" req="N" i_zoom="" c_zoom="" chk_ref="" items="5053" default="" max_compare="" max="" min_compare="" min="" can_edit="Y" can_query="Y" widget="ComboBox" status="">
    <![CDATA[]]>
  </field>
  <field cite_std="N" name="qcba022_02_04" ver="1" src="s" column="qcba022" table="qcba_t" attribute="" type="" req="Y" i_zoom="" c_zoom="" chk_ref="" items="5072" default="0" max_compare="" max="" min_compare="" min="" can_edit="Y" can_query="Y" widget="ComboBox" status="">
    <![CDATA[]]>
  </field>
  <field cite_std="N" name="qcba023_02_04" ver="1" src="s" column="qcba023" table="qcba_t" attribute="" type="" req="N" i_zoom="" c_zoom="" chk_ref="" items="" default="0" max_compare="" max="" min_compare="" min="" can_edit="Y" can_query="Y" widget="Edit" status="">
    <![CDATA[]]>
  </field>
  <field cite_std="N" name="qcbadocno_02_04" ver="1" src="s" column="qcbadocno" table="qcba_t" attribute="" type="" req="Y" i_zoom="q_ooba002_1" c_zoom="q_ooba002_1" chk_ref="" items="" default="" max_compare="" max="" min_compare="" min="" can_edit="Y" can_query="Y" widget="ButtonEdit" status="">
    <![CDATA[]]>
  </field>
  <field cite_std="N" name="qty_02_01" ver="1" src="s" column="pmdb006" table="pmdb_t" attribute="" type="" req="N" i_zoom="" c_zoom="" chk_ref="" items="" default="0" max_compare="" max="" min_compare="&gt;" min="0.000" can_edit="Y" can_query="Y" widget="Edit" status="">
    <![CDATA[]]>
  </field>
  <field cite_std="N" name="scb01" ver="1" src="s" column="chr10" table="type_t" attribute="" type="" req="Y" i_zoom="" c_zoom="" chk_ref="" items=" " default="" max_compare="" max="" min_compare="" min="" can_edit="Y" can_query="Y" widget="ComboBox" status="">
    <![CDATA[預設值: 1(依料件主檔設定)
選項只有此程式使用，故不建SCC 

LET l_msg = cl_getmsg("apm-00469",g_lang),",",         #1.依料件主檔設定   
                       cl_getmsg("apm-00470",g_lang),",",         #2.主要供應商，無限量  
                       cl_getmsg("apm-00471",g_lang),",",         #3.依廠商分配  
                       cl_getmsg("apm-00472",g_lang),",",         #4.主要供應商分配優先，餘量分配  
                       cl_getmsg("apm-00473",g_lang)               #5.指定單一供應商  
 CALL cl_set_combo_items("scb01","1,2,3,4,5",l_msg)]]>
  </field>
  <field cite_std="N" name="scb02" ver="1" src="s" column="chr10" table="type_t" attribute="" type="" req="Y" i_zoom="" c_zoom="" chk_ref="" items=" " default="" max_compare="" max="" min_compare="" min="" can_edit="Y" can_query="Y" widget="ComboBox" status="">
    <![CDATA[預設值: 1(依料件進行匯總)
選項只有此程式使用，故不建SCC  

LET l_msg = cl_getmsg("apm-00474",g_lang),",",         #1.依料件進行匯總  
                       cl_getmsg("apm-00475",g_lang)                #2.依料件+需求日期進行匯總  
CALL cl_set_combo_items("scb02","1,2",l_msg)]]>
  </field>
  <field cite_std="N" name="scb03" ver="1" src="s" column="chr10" table="type_t" attribute="" type="" req="Y" i_zoom="" c_zoom="" chk_ref="" items=" " default="" max_compare="" max="" min_compare="" min="" can_edit="Y" can_query="Y" widget="ComboBox" status="">
    <![CDATA[預設值: 3(六個月)
計算或處理:資料異動後，即時更新相關單身資料

選項只有此程式使用，故不建SCC   
LET l_msg = cl_getmsg("apm-00476",g_lang),",",         #一個月  
                       cl_getmsg("apm-00477",g_lang),",",         #二個月  
                       cl_getmsg("apm-00478",g_lang),",",         #三個月  
                       cl_getmsg("apm-00479",g_lang),",",         #六個月  
                       cl_getmsg("apm-00480",g_lang)               #一年  
CALL cl_set_combo_items("scb03","0,1,2,3,4",l_msg)]]>
  </field>
  <field cite_std="N" name="stus_02_03" ver="1" src="s" column="chr20" table="type_t" attribute="" type="" req="N" i_zoom="" c_zoom="" chk_ref="" items=" " default="" max_compare="" max="" min_compare="" min="" can_edit="Y" can_query="Y" widget="Edit" status="">
    <![CDATA[交期狀況：
   ●欄位控管：
     資料欄位: FORMONLY/Display Only
     校驗: 無
     帶值:無
     計算或處理:採購交貨日期 > 收貨日期，交期狀況="提前交貨"
                採購交貨日期 = 收貨日期，交期狀況="正常交貨"
                採購交貨日期 < 收貨日期，交期狀況="延誤交貨"
]]>
  </field>
  <prog_rel/>
  <ref_field/>
  <multi_lang/>
  <help_code>
    <hfield cite_std="N" ver="1" name="bt01" src="s" help_table="" help_find="" help_dlang="" help_field="" help_wc="" mapping_widget="" status=""/>
    <hfield cite_std="N" ver="1" name="diff_day_02_03" src="s" help_table="" help_find="" help_dlang="" help_field="" help_wc="" mapping_widget="" status=""/>
    <hfield cite_std="N" ver="1" name="ed01" src="s" help_table="" help_find="" help_dlang="" help_field="" help_wc="" mapping_widget="" status=""/>
    <hfield cite_std="N" ver="1" name="imaal003_02_01_1" src="s" help_table="" help_find="" help_dlang="" help_field="" help_wc="" mapping_widget="" status=""/>
    <hfield cite_std="N" ver="1" name="imaal003_02_01_2" src="s" help_table="" help_find="" help_dlang="" help_field="" help_wc="" mapping_widget="" status=""/>
    <hfield cite_std="N" ver="1" name="imaal004_02_01_1" src="s" help_table="" help_find="" help_dlang="" help_field="" help_wc="" mapping_widget="" status=""/>
    <hfield cite_std="N" ver="1" name="imaal004_02_01_2" src="s" help_table="" help_find="" help_dlang="" help_field="" help_wc="" mapping_widget="" status=""/>
    <hfield cite_std="N" ver="1" name="imae116_02_04" src="s" help_table="" help_find="" help_dlang="" help_field="" help_wc="" mapping_widget="" status=""/>
    <hfield cite_std="N" ver="1" name="pmaal004_02_01" src="s" help_table="" help_find="" help_dlang="" help_field="" help_wc="" mapping_widget="" status=""/>
    <hfield cite_std="N" ver="1" name="pmaal004_02_02" src="s" help_table="" help_find="" help_dlang="" help_field="" help_wc="" mapping_widget="" status=""/>
    <hfield cite_std="N" ver="1" name="pmaal004_02_03" src="s" help_table="" help_find="" help_dlang="" help_field="" help_wc="" mapping_widget="" status=""/>
    <hfield cite_std="N" ver="1" name="pmaal004_02_04" src="s" help_table="" help_find="" help_dlang="" help_field="" help_wc="" mapping_widget="" status=""/>
    <hfield cite_std="N" ver="1" name="pmdb004_02_01" src="s" help_table="" help_find="" help_dlang="" help_field="" help_wc="" mapping_widget="" status=""/>
    <hfield cite_std="N" ver="1" name="pmdb005_02_01" src="s" help_table="" help_find="" help_dlang="" help_field="" help_wc="" mapping_widget="" status=""/>
    <hfield cite_std="N" ver="1" name="pmdb005_02_01_desc" src="s" help_table="" help_find="" help_dlang="" help_field="" help_wc="" mapping_widget="" status=""/>
    <hfield cite_std="N" ver="1" name="pmdb007_02_01" src="s" help_table="" help_find="" help_dlang="" help_field="" help_wc="" mapping_widget="" status=""/>
    <hfield cite_std="N" ver="1" name="pmdb007_02_01_desc" src="s" help_table="" help_find="" help_dlang="" help_field="" help_wc="" mapping_widget="" status=""/>
    <hfield cite_std="N" ver="1" name="pmdb014_02_01" src="s" help_table="" help_find="" help_dlang="" help_field="" help_wc="" mapping_widget="" status=""/>
    <hfield cite_std="N" ver="1" name="pmdbent_02_01" src="s" help_table="" help_find="" help_dlang="" help_field="" help_wc="" mapping_widget="" status=""/>
    <hfield cite_std="N" ver="1" name="pmdbsite_02_01" src="s" help_table="" help_find="" help_dlang="" help_field="" help_wc="" mapping_widget="" status=""/>
    <hfield cite_std="N" ver="1" name="pmdl004_02_01" src="s" help_table="" help_find="" help_dlang="" help_field="" help_wc="" mapping_widget="" status=""/>
    <hfield cite_std="N" ver="1" name="pmdl004_02_02" src="s" help_table="" help_find="" help_dlang="" help_field="" help_wc="" mapping_widget="" status=""/>
    <hfield cite_std="N" ver="1" name="pmdl009_02_02" src="s" help_table="" help_find="" help_dlang="" help_field="" help_wc="" mapping_widget="" status=""/>
    <hfield cite_std="N" ver="1" name="pmdl010_02_02" src="s" help_table="" help_find="" help_dlang="" help_field="" help_wc="" mapping_widget="" status=""/>
    <hfield cite_std="N" ver="1" name="pmdl011_02_02" src="s" help_table="" help_find="" help_dlang="" help_field="" help_wc="" mapping_widget="" status=""/>
    <hfield cite_std="N" ver="1" name="pmdl012_02_02" src="s" help_table="" help_find="" help_dlang="" help_field="" help_wc="" mapping_widget="" status=""/>
    <hfield cite_std="N" ver="1" name="pmdl013_02_02" src="s" help_table="" help_find="" help_dlang="" help_field="" help_wc="" mapping_widget="" status=""/>
    <hfield cite_std="N" ver="1" name="pmdl015_02_02" src="s" help_table="" help_find="" help_dlang="" help_field="" help_wc="" mapping_widget="" status=""/>
    <hfield cite_std="N" ver="1" name="pmdl016_02_02" src="s" help_table="" help_find="" help_dlang="" help_field="" help_wc="" mapping_widget="" status=""/>
    <hfield cite_std="N" ver="1" name="pmdldocdt_02_02" src="s" help_table="" help_find="" help_dlang="" help_field="" help_wc="" mapping_widget="" status=""/>
    <hfield cite_std="N" ver="1" name="pmdldocno_02_02" src="s" help_table="" help_find="" help_dlang="" help_field="" help_wc="" mapping_widget="" status=""/>
    <hfield cite_std="N" ver="1" name="pmdn001_02_01" src="s" help_table="" help_find="" help_dlang="" help_field="" help_wc="" mapping_widget="" status=""/>
    <hfield cite_std="N" ver="1" name="pmdn002_02_01" src="s" help_table="" help_find="" help_dlang="" help_field="" help_wc="" mapping_widget="" status=""/>
    <hfield cite_std="N" ver="1" name="pmdn002_02_01_desc" src="s" help_table="" help_find="" help_dlang="" help_field="" help_wc="" mapping_widget="" status=""/>
    <hfield cite_std="N" ver="1" name="pmdn006_02_01" src="s" help_table="" help_find="" help_dlang="" help_field="" help_wc="" mapping_widget="" status=""/>
    <hfield cite_std="N" ver="1" name="pmdn006_02_01_desc" src="s" help_table="" help_find="" help_dlang="" help_field="" help_wc="" mapping_widget="" status=""/>
    <hfield cite_std="N" ver="1" name="pmdn007_02_01" src="s" help_table="" help_find="" help_dlang="" help_field="" help_wc="" mapping_widget="" status=""/>
    <hfield cite_std="N" ver="1" name="pmdn007_2_02_02" src="s" help_table="" help_find="" help_dlang="" help_field="" help_wc="" mapping_widget="" status=""/>
    <hfield cite_std="N" ver="2" name="pmdn008_02_01" src="s" help_table="" help_find="" help_dlang="" help_field="" help_wc="" mapping_widget="" status="u"/>
    <hfield cite_std="N" ver="1" name="pmdn008_02_01_desc" src="s" help_table="" help_find="" help_dlang="" help_field="" help_wc="" mapping_widget="" status=""/>
    <hfield cite_std="N" ver="2" name="pmdn009_02_01" src="s" help_table="" help_find="" help_dlang="" help_field="" help_wc="" mapping_widget="" status="u"/>
    <hfield cite_std="N" ver="1" name="pmdn010_02_01" src="s" help_table="" help_find="" help_dlang="" help_field="" help_wc="" mapping_widget="" status=""/>
    <hfield cite_std="N" ver="1" name="pmdn010_02_01_desc" src="s" help_table="" help_find="" help_dlang="" help_field="" help_wc="" mapping_widget="" status=""/>
    <hfield cite_std="N" ver="1" name="pmdn011_02_01" src="s" help_table="" help_find="" help_dlang="" help_field="" help_wc="" mapping_widget="" status=""/>
    <hfield cite_std="N" ver="1" name="pmdn014_02_01" src="s" help_table="" help_find="" help_dlang="" help_field="" help_wc="" mapping_widget="" status=""/>
    <hfield cite_std="N" ver="1" name="pmdn015_02_02" src="s" help_table="" help_find="" help_dlang="" help_field="" help_wc="" mapping_widget="" status=""/>
    <hfield cite_std="N" ver="1" name="pmdn040_02_02" src="s" help_table="" help_find="" help_dlang="" help_field="" help_wc="" mapping_widget="" status=""/>
    <hfield cite_std="N" ver="1" name="pmdn050_02_01" src="s" help_table="" help_find="" help_dlang="" help_field="" help_wc="" mapping_widget="" status=""/>
    <hfield cite_std="N" ver="1" name="pmdo013_02_03" src="s" help_table="" help_find="" help_dlang="" help_field="" help_wc="" mapping_widget="" status=""/>
    <hfield cite_std="N" ver="1" name="pmds009_02_03" src="s" help_table="" help_find="" help_dlang="" help_field="" help_wc="" mapping_widget="" status=""/>
    <hfield cite_std="N" ver="1" name="pmdsdocdt_02_03" src="s" help_table="" help_find="" help_dlang="" help_field="" help_wc="" mapping_widget="" status=""/>
    <hfield cite_std="N" ver="1" name="pmdsdocno_02_03" src="s" help_table="" help_find="" help_dlang="" help_field="" help_wc="" mapping_widget="" status=""/>
    <hfield cite_std="N" ver="1" name="qcba005_02_04" src="s" help_table="" help_find="" help_dlang="" help_field="" help_wc="" mapping_widget="" status=""/>
    <hfield cite_std="N" ver="1" name="qcba014_02_04" src="s" help_table="" help_find="" help_dlang="" help_field="" help_wc="" mapping_widget="" status=""/>
    <hfield cite_std="N" ver="1" name="qcba017_02_04" src="s" help_table="" help_find="" help_dlang="" help_field="" help_wc="" mapping_widget="" status=""/>
    <hfield cite_std="N" ver="1" name="qcba018_02_04" src="s" help_table="" help_find="" help_dlang="" help_field="" help_wc="" mapping_widget="" status=""/>
    <hfield cite_std="N" ver="1" name="qcba019_02_04" src="s" help_table="" help_find="" help_dlang="" help_field="" help_wc="" mapping_widget="" status=""/>
    <hfield cite_std="N" ver="1" name="qcba022_02_04" src="s" help_table="" help_find="" help_dlang="" help_field="" help_wc="" mapping_widget="" status=""/>
    <hfield cite_std="N" ver="1" name="qcba023_02_04" src="s" help_table="" help_find="" help_dlang="" help_field="" help_wc="" mapping_widget="" status=""/>
    <hfield cite_std="N" ver="1" name="qcbadocno_02_04" src="s" help_table="" help_find="" help_dlang="" help_field="" help_wc="" mapping_widget="" status=""/>
    <hfield cite_std="N" ver="1" name="qty_02_01" src="s" help_table="" help_find="" help_dlang="" help_field="" help_wc="" mapping_widget="" status=""/>
    <hfield cite_std="N" ver="1" name="scb01" src="s" help_table="" help_find="" help_dlang="" help_field="" help_wc="" mapping_widget="" status=""/>
    <hfield cite_std="N" ver="1" name="scb02" src="s" help_table="" help_find="" help_dlang="" help_field="" help_wc="" mapping_widget="" status=""/>
    <hfield cite_std="N" ver="1" name="scb03" src="s" help_table="" help_find="" help_dlang="" help_field="" help_wc="" mapping_widget="" status=""/>
    <hfield cite_std="N" ver="1" name="stus_02_03" src="s" help_table="" help_find="" help_dlang="" help_field="" help_wc="" mapping_widget="" status=""/>
  </help_code>
  <act cite_std="N" id="output" ver="1" src="s" type="all" gen_code="Y" status="">
    <![CDATA[]]>
  </act>
  <act cite_std="N" id="show_data" ver="1" src="s" type="all" gen_code="Y" status="">
    <![CDATA[1.檢查採購底稿是否已有資料，有的話先刪除
2.將請購底稿清單資料匯總產生成採購明細資料
  2-1.若分配匯總方式選擇"1.依料件進行匯總"的話則將請購底稿資料依據供應商、採購料號、
      採購產品特徵、採購單位、計價單位做Group匯總產生採購項次明細資料，請參考下面案例1:
         案例1:請購底稿有4筆請購資料如下:
          序號 請購單號 請購項次 需求日期  採購料號  採購產品特徵  採購單位 採購數量 計價單位 計價數量
           1    PR001       1    2013/11/1   A001                    PSC      100       PCS        100
           2    PR001       2    2013/11/20  A001                    PCS      500       PCS        500
           3    PR002       1    2013/11/5   B001                    SET      20        PCS        100
           4    PR003       1    2013/11/5   B001                    PCS      200       PCS        200

         依上述的例子會將請購底稿資料合併產生成3筆採購明細資料，分別為序號1與2的資料合併成一筆
         採購項次， 而序號3與序號4各自產生一筆對應的採購資料，所以會變成下面結果:
           採購項次    採購料號    採購產品特徵   採購單位  採購數量  計價單位  計價數量    到庫日期
              1         A001                         PCS      600        PCS       600      2013/11/1
              2         B001                         SET      20         PCS       100      2013/11/5
              3         B001                         PCS      200        PCS       200      2013/11/5

  2-2.若分配匯總方式選擇"2.依料件+需求日期進行匯總"的話則將請購底稿資料依據供應商、採購料號、採購產品特徵、
      採購單位、計價單位、需求日期做Group匯總產生採購項次明細資料，請參考下面案例2:
         案例2:請購底稿有5筆請購資料如下:
          序號 請購單號 請購項次 需求日期  採購料號  採購產品特徵  採購單位 採購數量 計價單位 計價數量
            1    PR001     1     2013/11/1   A001                     PSC      100      PCS        100
            2    PR001     2     2013/11/20  A001                     PCS      500      PCS        500
            3    PR002     1     2013/11/5   B001                     SET      20       PCS        100
            4    PR003     1     2013/11/5   B001                     PCS      200      PCS        200
            5    PR004     3     2013/11/20  A001                     PCS      300      PCS        300 

         依上述的例子會將請購底稿資料合併產生成4筆採購明細資料，分別為序號2與5的資料合併成一筆
         採購項次，而序號1、3、4各自產生一筆對應的採購資料，所以會變成下面結果:
          採購項次    採購料號    採購產品特徵   採購單位  採購數量  計價單位  計價數量   到庫日期
             1         A001                         PCS      100        PCS       100     2013/11/1
             2         A001                         PCS      800        PCS       800     2013/11/20
             3         B001                         SET      20         PCS       100     2013/11/5
             4         B001                         PCS      200        PCS       200     2013/11/5

   2-3.新增採購明細時重要欄位的預設值如下:
        [C:料件編號] = 請購底稿的採購料號
        [C:產品特徵] = 請購底稿的採購產品特徵
        [C:採購單位] = 採購料號主檔所預設的採購單位
        [C:採購數量] = 依據2-1或2-2匯總後的採購數量(需考慮請購單位與採購單位換算率)
        [C:計價單位] = 採購料號主檔的預設採購計價單位，若不使用採購計價單位時則此欄位為NULL
        [C:計價數量] = 採購數量*(採購單位與計價單位換算率)，若不使用採購計價單位時則此欄位為NULL
        [C:需求日期] = 若採構匯總策略選擇"1:不同交期匯總取價"時，則取匯總資料中需求日期最早的那一筆，
                       若採構匯總策略選擇"2:不同交期拆解"，則等於匯總的需求日期 
        [參考單位]=採購料號主檔的參考單位(imaf015)，若不使用參考單位時則此欄位為NULL
        [參考數量]=採購數量*(採購單位與參考單位換算率)，若不使用參考單位時則此欄位為NULL
        [C:計價單位] = 採購料號主檔的預設採購計價單位，若不使用採購計價單位時則此欄位=採購單位
        [C:計價數量] = 採購數量*(採購單位與計價單位換算率)，若不使用採購計價單位時則此欄位=採購數量
3.依步驟2匯總資料進行分配
  3-1.如供應商設定為"依料件主檔設定"
      3-1-1.如[T.料件據點進銷存檔].[C.廠商選擇方式]="0.主要供應商，無限量"，
              採購單底稿.供應商 = [T.料件據點進銷存檔].[C.主要供應商]
              採購單底稿.未轉採購數量,採購單底稿.採購數量 = 步驟2.採購數量
      3-1-2.如[T.料件據點進銷存檔].[C.廠商選擇方式]="1.依廠商分配"
              抓取[T.交易對象料號對應檔].[C.公司料件編號],[C.產品特徵]符合的資料
                  採購單底稿.供應商 = [T.交易對象料號對應檔].[C.交易對象編號]
                  採購單底稿.未轉採購數量,採購單底稿.採購數量 = 步驟2.採購數量 * [T.交易對象料號對應檔].[C.分配比率] / SUM(符合資料的分配比率)
      3-1-3.如[T.料件據點進銷存檔].[C.廠商選擇方式]="2.主要供應商分配優先，餘量分配"
              採購單底稿.供應商 = [T.料件據點進銷存檔].[C.主要供應商]
              採購單底稿.未轉採購數量,採購單底稿.採購數量 = 步驟2.採購數量(不可大於[T.料件據點進銷存檔].[C.主供應商分配限量])
              如有餘量，抓取[T.交易對象料號對應檔].[C.公司料件編號],[C.產品特徵]且[T.交易對象料號對應檔].[C.交易對象編號] <> [T.料件據點進銷存檔].[C.主要供應商]符合的資料
                  採購單底稿.供應商 = [T.交易對象料號對應檔].[C.交易對象編號]
                  採購單底稿.未轉採購數量,採購單底稿.採購數量 = 步驟2.採購數量 * [T.交易對象料號對應檔].[C.分配比率] / SUM(符合資料的分配比率)
      3-1-4.如[T.料件據點進銷存檔].[C.廠商選擇方式]="3.人工選擇"，
              採購單底稿.供應商 = 單頭.供應商
              採購單底稿.未轉採購數量,採購單底稿.採購數量 = 步驟2.採購數量
  3-2.如供應商設定為"主要供應商，無限量"，同3-1-1處理方式
  3-3.如供應商設定為"依廠商分配"，同3-1-2處理方式
  3-4.如供應商設定為"主要供應商分配優先，餘量分配"，同3-1-3處理方式，但主供應商分配限量依畫面設定
  3-5.如採購單供應商設定為"指定單一供應商"
        採購單底稿.供應商 = 單頭.供應商
        採購單底稿.未轉採購數量,採購單底稿.採購數量 = 步驟2.採購數量

]]>
  </act>
  <strings>
    <sfield name="lbl_scb01" text="供應商設定" lstr=""/>
    <sfield name="lbl_scb02" text="分配匯總方式" lstr=""/>
    <sfield name="lbl_bt01" text="供應商" lstr=""/>
    <sfield name="lbl_pmaal004" text="交易對象簡稱" lstr=""/>
    <sfield name="lbl_ed01" text="主供應商分配限量" lstr=""/>
    <sfield name="lbl_show_data" text="產生分配資料" lstr=""/>
    <sfield name="lbl_pmdb014" text="供應商選擇" lstr=""/>
    <sfield name="lbl_pmdl004" text="供應商編號" lstr=""/>
    <sfield name="lbl_pmaal004_02_01" text="供應商名稱" lstr=""/>
    <sfield name="lbl_pmdb004_02_01" text="請購料號" lstr=""/>
    <sfield name="lbl_imaal003" text="品名" lstr=""/>
    <sfield name="lbl_imaal004" text="規格" lstr=""/>
    <sfield name="lbl_pmdb005_02_01" text="請購產品特徵" lstr=""/>
    <sfield name="lbl_pmdb005_02_01_desc" text="特徵值說明" lstr=""/>
    <sfield name="lbl_pmdb007_02_01" text="請購單位" lstr=""/>
    <sfield name="lbl_pmdb007_02_01_desc" text="單位說明" lstr=""/>
    <sfield name="lbl_qty" text="未轉採購量" lstr=""/>
    <sfield name="lbl_pmdn014" text="到庫日期" lstr=""/>
    <sfield name="lbl_pmdn001_02_01" text="採購料號" lstr=""/>
    <sfield name="lbl_pmdn002_02_01" text="採購產品特徵" lstr=""/>
    <sfield name="lbl_pmdn002_02_01_desc" text="特徵值說明" lstr=""/>
    <sfield name="lbl_pmdn006" text="採購單位" lstr=""/>
    <sfield name="lbl_pmdn006_02_01_desc" text="單位說明" lstr=""/>
    <sfield name="lbl_pmdn007" text="採購數量" lstr=""/>
    <sfield name="lbl_pmdn008_02_01" text="參考單位" lstr=""/>
    <sfield name="lbl_pmdn008_02_01_desc" text="單位說明" lstr=""/>
    <sfield name="lbl_pmdn009_02_01" text="參考數量" lstr=""/>
    <sfield name="lbl_pmdn010" text="計價單位" lstr=""/>
    <sfield name="lbl_pmdn010_02_01_desc" text="單位說明" lstr=""/>
    <sfield name="lbl_pmdn011" text="計價數量" lstr=""/>
    <sfield name="lbl_pmdn050_02_01" text="備註" lstr=""/>
    <sfield name="lbl_pmdbent" text="企業編號" lstr=""/>
    <sfield name="lbl_pmdbsite" text="營運據點" lstr=""/>
    <sfield name="lbl_scb03" text="參考期間資料" lstr=""/>
    <sfield name="apmp490_02.page" text="最近採購資料" lstr=""/>
    <sfield name="lbl_pmaal004_02_02" text="供應商名稱" lstr=""/>
    <sfield name="lbl_pmdldocno" text="採購單號" lstr=""/>
    <sfield name="lbl_pmdldocdt" text="採購日期" lstr=""/>
    <sfield name="lbl_pmdl009" text="付款條件" lstr=""/>
    <sfield name="lbl_pmdl010" text="交易條件" lstr=""/>
    <sfield name="lbl_pmdl011" text="稅別" lstr=""/>
    <sfield name="lbl_pmdl012" text="稅率" lstr=""/>
    <sfield name="lbl_pmdl013" text="單價含稅否" lstr=""/>
    <sfield name="lbl_pmdl015" text="幣別" lstr=""/>
    <sfield name="lbl_pmdl016" text="匯率" lstr=""/>
    <sfield name="lbl_pmdn015" text="單價" lstr=""/>
    <sfield name="lbl_pmdn040" text="取價來源" lstr=""/>
    <sfield name="apmp490_01.page_1" text="最近收貨資料" lstr=""/>
    <sfield name="lbl_pmds009_02_03" text="供應商" lstr=""/>
    <sfield name="lbl_pmaal004_02_03" text="供應商名稱" lstr=""/>
    <sfield name="lbl_pmdsdocno_02_03" text="收貨單號" lstr=""/>
    <sfield name="lbl_pmdo013_02_03" text="採購交貨日期" lstr=""/>
    <sfield name="lbl_pmdsdocdt_02_03" text="收貨日期" lstr=""/>
    <sfield name="lbl_stus_02_03" text="交期狀況" lstr=""/>
    <sfield name="lbl_diff_day_02_03" text="差異天數" lstr=""/>
    <sfield name="apmp490_02.page_1" text="最近檢驗資料" lstr=""/>
    <sfield name="lbl_qcba005_02_04" text="供應商" lstr=""/>
    <sfield name="lbl_pmaal004_02_04" text="供應商名稱" lstr=""/>
    <sfield name="lbl_qcbadocno_02_04" text="檢驗單號" lstr=""/>
    <sfield name="lbl_qcba014" text="檢驗日期" lstr=""/>
    <sfield name="lbl_imae116" text="檢驗水準" lstr=""/>
    <sfield name="lbl_qcba018_02_04" text="程度" lstr=""/>
    <sfield name="lbl_qcba019_02_04" text="級數" lstr=""/>
    <sfield name="lbl_qcba017" text="送驗量" lstr=""/>
    <sfield name="lbl_qcba022" text="判定結果" lstr=""/>
    <sfield name="lbl_qcba023" text="合格量" lstr=""/>
    <sfield name="lbl_hbegin" text="第" lstr=""/>
    <sfield name="lbl_hsep" text="筆(共" lstr=""/>
    <sfield name="lbl_hend" text="筆)" lstr=""/>
    <sact name="output" text="列印" lstr=""/>
    <sact name="show_data" text="" lstr=""/>
  </strings>
  <sa_spec/>
  <exclude ver="" cite_std="N" src=""/>
</spec>
