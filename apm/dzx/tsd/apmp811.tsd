<spec prog="apmp811" std_prog="apmp811" erpver="1.0" ver="2" module="APM" type="M" booking="Y" class="p" env="s" zone="t10dev" identity="s">
  <other>
    <code_template value="P" status="" />
    <free_style value="N" status="" />
  </other>
  <toolbar items="output" />
  <prog_rel />
  <ref_field />
  <multi_lang />
  <help_code>
    <hfield cite_std="N" ver="1" name="pmcc_t.pmcc001" src="s" help_table="" help_find="" help_dlang="" help_field="" help_wc="" mapping_widget="" status="" />
    <hfield cite_std="N" ver="1" name="pmce004" src="s" help_table="" help_find="" help_dlang="" help_field="" help_wc="" mapping_widget="" status="" />
    <hfield cite_std="N" ver="1" name="pmch_t.pmchdocno" src="s" help_table="" help_find="" help_dlang="" help_field="" help_wc="" mapping_widget="" status="" />
    <hfield cite_std="N" ver="1" name="pmcc002" src="s" help_table="" help_find="" help_dlang="" help_field="" help_wc="" mapping_widget="" status="" />
  </help_code>
  <strings>
    <sfield name="condition_page" text="條件輸入" lstr="" />
    <sfield name="group_qbe" text="QBE條件" lstr="" />
    <sfield name="lbl_pmcc001" text="評核期別" lstr="" />
    <sfield name="lbl_pmcc002" text="評核品類" lstr="" />
    <sfield name="lbl_pmce004" text="評分部門" lstr="" />
    <sfield name="apmp811.group_input" text="條件選項" lstr="" />
    <sfield name="lbl_pmchdocno" text="單別" lstr="" />
    <sfield name="lbl_pmchdocdt" text="單據日期" lstr="" />
    <sfield name="lbl_select" text="評分資料排序" lstr="" />
    <sfield name="group_progress" text="處理進度" lstr="" />
    <sfield name="lbl_stagenow" text="目前處理階段:" lstr="" />
    <sfield name="lbl_stagecomplete" text="整體完成進度:" lstr="" />
    <sfield name="scheduling_page" text="排程設定" lstr="" />
    <sfield name="history_page" text="執行歷程" lstr="" />
    <sfield name="lbl_collect_gzze001" text="訊息代碼" lstr="" />
    <sfield name="lbl_collect_gzze003" text="訊息內容" lstr="" />
    <sfield name="lbl_collect_gzze006" text="進階訊息" lstr="" />
    <sfield name="lbl_cl_err_s02_accept" text="確定" lstr="" />
    <sfield name="lbl_err_detail" text="進階訊息" lstr="" />
    <sfield name="lbl_suggest_exe" text="建議執行" lstr="" />
    <sfield name="lbl_err_contact" text="反應問題" lstr="" />
    <sfield name="lbl_cl_err_s01_Sure" text="確定" lstr="" />
    <sfield name="lbl_group_cl_err_s01" text="進階訊息" lstr="" />
    <sfield name="lbl_gzze001" text="訊息代碼:" lstr="" />
    <sfield name="lbl_gzze006" text="訊息內容:" lstr="" />
    <sfield name="lbl_sqlerrd2" text="SQL錯誤碼:" lstr="" />
    <sfield name="lbl_gzpd001" text="排程執行序號" lstr="" />
    <sfield name="lbl_gzpd002" text="排程編號" lstr="" />
    <sfield name="lbl_gzpd003" text="序號" lstr="" />
    <sfield name="lbl_gzpd004" text="執行作業" lstr="" />
    <sfield name="lbl_gzpd005" text="傳入參數" lstr="" />
    <sfield name="lbl_gzpc006" text="執行結束時間" lstr="" />
    <sfield name="lbl_gzpd007" text="作業執行狀態" lstr="" />
    <sfield name="lbl_gzpd008" text="作業執行時間" lstr="" />
    <sfield name="lbl_gzpd009" text="執行使用者編號" lstr="" />
    <sfield name="lbl_gzpd010" text="作業完成時間" lstr="" />
    <sfield name="btn_schedule_reexec" text="重新執行" lstr="" />
    <sfield name="btn_view" text="重新查看" lstr="" />
    <sfield name="btn_schedule_adv" text="進階查詢" lstr="" />
    <sfield name="lbl_gzpa003" text="執行類型" lstr="" />
    <sfield name="lbl_gzpa002" text="排程說明" lstr="" />
    <sfield name="lbl_asign" text="指定時間執行" lstr="" />
    <sfield name="lbl_gzpa007" text="預定執行時間" lstr="" />
    <sfield name="lbl_exec" text="執行時間設定" lstr="" />
    <sfield name="lbl_wk1" text="第一週" lstr="" />
    <sfield name="lbl_wk2" text="第二週" lstr="" />
    <sfield name="lbl_wk3" text="第三週" lstr="" />
    <sfield name="lbl_wk4" text="第四週" lstr="" />
    <sfield name="lbl_wk5" text="第五週" lstr="" />
    <sfield name="lbl_wd0" text="週日" lstr="" />
    <sfield name="lbl_wd1" text="週一" lstr="" />
    <sfield name="lbl_wd2" text="週二" lstr="" />
    <sfield name="lbl_wd3" text="週三" lstr="" />
    <sfield name="lbl_wd4" text="週四" lstr="" />
    <sfield name="lbl_wd5" text="週五" lstr="" />
    <sfield name="lbl_wd6" text="週六" lstr="" />
    <sfield name="lbl_dayend" text="月底" lstr="" />
    <sfield name="lbl_sc1" text="時段一" lstr="" />
    <sfield name="lbl_to" text="至" lstr="" />
    <sfield name="lbl_per" text="每" lstr="" />
    <sfield name="lbl_times" text="執行一次" lstr="" />
    <sfield name="lbl_sc2" text="時段二" lstr="" />
    <sfield name="lbl_sc3" text="時段三" lstr="" />
    <sfield name="lbl_spec" text="特殊指定" lstr="" />
    <sfield name="lbl_gzpa029" text="執行日遇到假日" lstr="" />
    <sfield name="lbl_gzpa031" text="前一程序未完成時不執行新程序" lstr="" />
    <sfield name="lbl_end_call" text="執行結束通知人員" lstr="" />
    <sfield name="lbl_gzpe003" text="執行狀況" lstr="" />
    <sfield name="lbl_gzpe004" text="收件人員工編號" lstr="" />
    <sfield name="lbl_gzpe004_desc" text="員工姓名" lstr="" />
    <sfield name="lbl_addr" text="收件人信件位址" lstr="" />
    <sfield name="lbl_gzpe005" text="信件主旨" lstr="" />
    <sfield name="lbl_check" text="多選" lstr="" />
    <sfield name="lbl_ooba002" text="單據別編號" lstr="" />
    <sfield name="lbl_oobxl003" text="說明" lstr="" />
    <sfield name="lbl_oobxl004" text="助記碼" lstr="" />
    <sfield name="lbl_rtaxl003" text="說明" lstr="" />
    <sfield name="lbl_rtax001" text="品類編號" lstr="" />
    <sfield name="lbl_ooea001" text="組織編號" lstr="" />
    <sfield name="lbl_ooeal003" text="說明(簡稱)" lstr="" />
    <sfield name="lbl_gzxm001" text="QBE編號" lstr="" />
    <sfield name="cl_qbe_s02.lbl_gzxm005" text="設為首頁-自動查詢方案" lstr="" />
    <sfield name="lbl_gzxm002" text="作業編號" lstr="" />
    <sfield name="lbl_gzxm003" text="員工編號" lstr="" />
    <sfield name="cl_qbe_s02.lbl_gzxm004" text="設為預設查詢條件" lstr="" />
    <sfield name="cl_qbe_s02.bpage_1" text="條件組合內容" lstr="" />
    <sfield name="cl_qbe_s02.lbl_gzxn005" text="欄位說明" lstr="" />
    <sfield name="cl_qbe_s02.lbl_gzxn006" text="運算子" lstr="" />
    <sfield name="cl_qbe_s02.lbl_gzxn007" text="條件值" lstr="" />
    <sfield name="cl_qbe_s02_Accept" text="確認" lstr="" />
    <sfield name="cl_qbe_s02_Cancel" text="取消" lstr="" />
    <sfield name="lbl_funid" text="函式代碼" lstr="" />
    <sfield name="lbl_fundesc" text="函式說明" lstr="" />
    <sfield name="cl_qbe_s01_Accept" text="確認" lstr="" />
    <sfield name="cl_qbe_s01_Cancel" text="取消" lstr="" />
    <sfield name="cl_qbe_s03.bpage_1" text="查詢方案列表" lstr="" />
    <sfield name="cl_qbe_s03.lbl_gzxmstus" text="有效" lstr="" />
    <sfield name="cl_qbe_s03.lbl_gzxm004" text="預設" lstr="" />
    <sfield name="cl_qbe_s03.lbl_gzxm005" text="顯示於首頁" lstr="" />
    <sfield name="cl_qbe_s03.lbl_gzxm009" text="順序" lstr="" />
    <sfield name="cl_qbe_s03.lbl_gzxml005" text="查詢方案說明" lstr="" />
    <sfield name="cl_qbe_s03.lbl_gzxm007" text="自設SQL條件" lstr="" />
    <sfield name="cl_qbe_s03.page_2" text="條件組合內容" lstr="" />
    <sfield name="cl_qbe_s03.lbl_gzxn004" text="序號" lstr="" />
    <sfield name="cl_qbe_s03.lbl_gzxn005" text="條件欄位" lstr="" />
    <sfield name="cl_qbe_s03.lbl_gzxn006" text="運算子" lstr="" />
    <sfield name="cl_qbe_s03.lbl_gzxn007" text="條件值" lstr="" />
    <sfield name="lbl_hbegin" text="第" lstr="" />
    <sfield name="lbl_hsep" text="筆(共" lstr="" />
    <sfield name="lbl_hend" text="筆)" lstr="" />
    <sfield name="lbl_dbegin" text="第" lstr="" />
    <sfield name="lbl_dsep" text="項(共" lstr="" />
    <sfield name="lbl_dend" text="項)" lstr="" />
    <sfield name="add_favorite_catalog" text="新增目錄" lstr="" />
    <sfield name="modify_favorite_desc" text="修改" lstr="" />
    <sfield name="favorite_del" text="移除" lstr="" />
    <sfield name="add_catalog" text="" lstr="" />
    <sfield name="accept" text="確定" lstr="" />
    <sfield name="cancel" text="取消" lstr="" />
    <sfield name="cl_about_s02_StackMesg" text="訊息" lstr="" />
    <sfield name="cl_about_s02_YesISee" text="是的，我瞭解了！" lstr="" />
    <sfield name="cl_cmdask_s01_Run" text="請輸入執行作業編號" lstr="" />
    <sfield name="cl_ask_s04_OK" text="OK" lstr="" />
    <sfield name="cl_ask_s03_Test" text="測試" lstr="" />
    <sfield name="cl_ask_s03_OK" text="OK" lstr="" />
    <sfield name="cl_ask_s01_Choice" text="選擇" lstr="" />
    <sfield name="lbl_gzzz001" text="作業編號" lstr="" />
    <sfield name="lbl_gzzal003" text="程式名稱" lstr="" />
    <sfield name="lbl_gzxml001" text="QBE編號" lstr="" />
    <sfield name="lbl_gzxml002" text="作業編號" lstr="" />
    <sfield name="lbl_gzxml003" text="員工編號" lstr="" />
    <sfield name="lbl_gzxml004" text="語言別" lstr="" />
    <sfield name="lbl_gzxml005" text="說明" lstr="" />
    <sfield name="lbl_gzxml006" text="註記碼" lstr="" />
    <sfield name="lbl_ooag001" text="員工編號" lstr="" />
    <sfield name="lbl_oofa011" text="全名" lstr="" />
  </strings>
  <sa_spec>
    <sa_field name="FrameRole1">
<![CDATA[程式說明及目的： 利用此作業整批產生供應商評核定性評分單據，供使用者依評核期別/評核品類及評核部門將單據查出直接評分，不需再新增單據。
作業功能：說明/離開
作業類型：批次作業
輸入模式： 
作業資料來源(Master)：
	資料來源表：pmcc_t(供應商評核項目設定檔)
	            pmce_t(供應商評核定性項目設定檔)
            資料目的表：pmch_t(供應商評核定性評分單頭檔)
	            pmci_t(供應商評核定性評分明細檔)
                  
 

]]>
</sa_field>
    <sa_field name="pmcc001">
<![CDATA[評核期別：
   ●欄位控管：
     資料欄位:[T:供應商評核項目設定檔].[C:評核期別]
     預設值:無 
     校驗:1.不允許空白
     帶值:無
     計算或處理:無
 
   ●開窗處理：
          參考函式：依標準查詢視窗
          查詢欄位：[T:供應商評核項目設定檔].[C:評核期別],[T:供應商評核項目設定檔].[C:評核品類]
          回值類型：多重回值
]]>
</sa_field>
    <sa_field name="pmcc002">
<![CDATA[評核品類：
   ●欄位控管：
     資料欄位:[T:供應商評核項目設定檔].[C:評核品類]/Input Only
     預設值:無
     校驗:1.允許空白   
     帶值:無
     計算或處理:無

   ●開窗處理：
          參考函式：依標準查詢視窗
          查詢欄位：[T:供應商評核項目設定檔].[C:評核期別],[T:供應商評核項目設定檔].[C:評核品類]
          回值類型：多重回值
]]>
</sa_field>
    <sa_field name="pmce004">
<![CDATA[評分部門：
   ●欄位控管：
     資料欄位:[T:供應商評核定性項目設定檔].[C:評分部門]/Input Only
     預設值:無
     校驗:1.允許空白
     帶值:無
     計算或處理:無

   ●開窗處理：
     參考函式：依標準查詢視窗
     查詢欄位：[T:營運據點檔].[C:營運據點],[T:經營單位多語言檔].[C:說明(簡稱)]
     過濾條件：[C:部門]='Y' 
     回值類型： 多重回值
]]>
</sa_field>
    <sa_field name="pmchdocdt">
<![CDATA[評核期別：
   ●欄位控管：
     資料欄位:[T:供應商評核項目設定檔].[C:評核期別]
     預設值:無 
     校驗:1.不允許空白
     帶值:無
     計算或處理:無
]]>
</sa_field>
    <sa_field name="pmchdocno">
<![CDATA[單據編號：
   ●欄位控管：
     資料欄位:[T:供應商評核定性評份單頭檔].[C:單據編號] / Input Only
     預設值:無
     校驗:1.不允許空白
          2.輸入值須存在[T:單據別檔].[C:單據別]，
            且[T:單據別檔].[C:參照表號]=g_site在ooef_t(營運據點檔)裡設定的ooef004(單據別使用參照表)
     帶值:無
     計算或處理:無

   ●開窗處理：
     參考函式：依標準查詢視窗
     查詢欄位：[T:單據別檔].[C:單據別],[T:單據別檔].[C:說明]
     查詢條件：[T:單據別檔].[C:參照表號] = 當前登入組織設定的單據別使用參照表
                 AND [T:單據別檔].[C:對應程式代號] ='apmt811'
                 AND [T:單據別檔].[C:資料狀態碼] = 'Y'
     回值類型：單一傳回

]]>
</sa_field>
    <sa_field name="資料處理">
<![CDATA[資料處理：


條件輸入完執行批次產生時，處理如下：
檢核：
  (1)評核期別不可空白
  (2)單別不可空白
  (3)單據日期不可空白

批次處理：
(1)依QBE條件，至 [T:供應商評核項目設定檔]，[T:供應商評核定性項目設定檔]中抓取符合條件資料
(2)產生的單據依 [C:評核期別]+[C:評核品類]+[C:評核部門]拆單，產生至[T:供應商評核定性評分單頭檔]及[T:供應商評核定性評分明細檔]中
   [C:單據編號]依畫面輸入的單別，CALL s_aooi200_gen_doc應用元件取單號
   [C:單據日期]=畫面輸入的單據日期
   [C:狀態]='N' (未確認)
(3)產生單據前，應先檢核[C:評核期別]+[C:評核品類]+[C:評核部門]不可重複(單據已存在，且非作廢狀態)，
   於產生時如遇資料重複，於批次執行完畢後，應顯示錯誤清單
(4)單身資料產生：CALL s_apmt811_ins_pmci() 應用元件產生單身資料



]]>
</sa_field>
  </sa_spec>
  <table ver="" cite_std="N" />
  <all cite_std="N" ver="1" src="s" status="">
<![CDATA[程式說明及目的： 利用此作業整批產生供應商評核定性評分單據，供使用者依評核期別/評核品類及評核部門將單據查出直接評分，不需再新增單據。
作業功能：說明/離開
作業類型：批次作業
輸入模式： 
作業資料來源(Master)：
資料來源表：pmcc_t(供應商評核項目設定檔)
                        pmce_t(供應商評核定性項目設定檔)
資料目的表：pmch_t(供應商評核定性評分單頭檔)
                        pmci_t(供應商評核定性評分明細檔)

資料處理：


條件輸入完執行批次產生時，處理如下：
檢核：
  (1)評核期別不可空白
  (2)單別不可空白
  (3)單據日期不可空白

批次處理：
(1)依QBE條件，至 [T:供應商評核項目設定檔]，[T:供應商評核定性項目設定檔]中抓取符合條件資料
(2)產生的單據依 [C:評核期別]+[C:評核品類]+[C:評核部門]拆單，產生至[T:供應商評核定性評分單頭檔]及[T:供應商評核定性評分明細檔]中
   [C:單據編號]依畫面輸入的單別，CALL s_aooi200_gen_doc應用元件取單號
   [C:單據日期]=畫面輸入的單據日期
   [C:狀態]='N' (未確認)
(3)產生單據前，應先檢核[C:評核期別]+[C:評核品類]+[C:評核部門]不可重複(單據已存在，且非作廢狀態)，
   於產生時如遇資料重複，於批次執行完畢後，應顯示錯誤清單
(4)單身資料產生：CALL s_apmt811_ins_pmci() 應用元件產生單身資料]]>
</all>
  <field cite_std="N" name="pmch_t.pmchdocdt" ver="1" src="s" column="pmchdocdt" table="pmch_t" attribute="D001" type="date()" req="Y" i_zoom="" c_zoom="" chk_ref="" items="" default="" max="" min="" can_edit="Y" can_query="N" widget="DateEdit" status="u">
<![CDATA[]]>
</field>
  <field cite_std="N" name="pmch_t.pmchdocno" ver="1" src="s" column="pmchdocno" table="pmch_t" attribute="C203" type="varchar2(20)" req="Y" i_zoom="q_ooba002_1" c_zoom="" chk_ref="" items="" default="" max="" min="" can_edit="Y" can_query="N" widget="ButtonEdit" status="u">
<![CDATA[]]>
</field>
  <field cite_std="N" name="select" ver="1" src="s" column="chr1" table="type_t" attribute="T001" type="varchar2(1)" req="Y" i_zoom="" c_zoom="" chk_ref="" items=" " default="" max="" min="" can_edit="Y" can_query="N" widget="RadioGroup" status="u">
<![CDATA[]]>
</field>
  <field cite_std="N" name="pmcc002" ver="1" src="s" column="chr10" table="type_t" attribute="T010" type="varchar2(10)" req="N" i_zoom="" c_zoom=" q_rtax001_1" chk_ref="" items=" " default="" max="" min="" can_edit="Y" can_query="N" widget="ButtonEdit" status="u">
<![CDATA[]]>
</field>
  <field cite_std="N" name="pmcc_t.pmcc001" ver="1" src="s" column="pmcc001" table="pmcc_t" attribute="C002" type="varchar2(10)" req="Y" i_zoom="" c_zoom="q_pmcc001" chk_ref="" items="" default="" max="" min="" can_edit="Y" can_query="N" widget="ButtonEdit" status="u">
<![CDATA[]]>
</field>
  <field cite_std="N" name="pmce004" ver="1" src="s" column="pmce004" table="pmce_t" attribute="C002" type="varchar2(10)" req="N" i_zoom="q_ooea001" c_zoom="q_ooea001" chk_ref="" items="" default="" max="" min="" can_edit="Y" can_query="N" widget="ButtonEdit" status="u">
<![CDATA[]]>
</field>
  <exclude ver="" cite_std="N" src="" />
</spec>