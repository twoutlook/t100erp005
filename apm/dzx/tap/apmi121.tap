<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<add_points prog="apmi121" std_prog="apmi121" erpver="1.0" module="APM" ver="1" env="s" zone="t10dev" booking="Y">
  <point name="construct.c.page1.pmap003" order="0" ver="1" cite_std="" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_imaf001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmap003  #顯示到畫面上

            NEXT FIELD pmap003                     #返回原欄位

]]>
  </point>
  <point name="construct.c.page1.pmap005" order="0" ver="1" cite_std="" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_imaf001_5()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmap005  #顯示到畫面上
               #DISPLAY g_qryparam.return2 TO imaal003 #品名 

            NEXT FIELD pmap005                     #返回原欄位

]]>
  </point>
  <point name="construct.c.page1.pmap006" order="0" ver="1" cite_std="N" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooca001_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmap006  #顯示到畫面上

            NEXT FIELD pmap006                     #返回原欄位

]]>
  </point>
  <point name="construct.c.page1.pmap007" order="0" ver="1" cite_std="N" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooca001_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmap007  #顯示到畫面上

            NEXT FIELD pmap007                     #返回原欄位

]]>
  </point>
  <point name="construct.c.page1.pmap008" order="0" ver="1" cite_std="N" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooca001_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmap008  #顯示到畫面上

            NEXT FIELD pmap008                     #返回原欄位

]]>
  </point>
  <point name="construct.c.page1.pmap009" order="0" ver="1" cite_std="N" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooef001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmap009  #顯示到畫面上

            NEXT FIELD pmap009                     #返回原欄位

]]>
  </point>
  <point name="construct.c.page1.pmap010" order="0" ver="1" cite_std="N" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_inaa001_6()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmap010  #顯示到畫面上

            NEXT FIELD pmap010                     #返回原欄位

]]>
  </point>
  <point name="construct.c.page1.pmap011" order="0" ver="1" cite_std="N" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_inab002_6()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmap011  #顯示到畫面上

            NEXT FIELD pmap011                     #返回原欄位

]]>
  </point>
  <point name="construct.c.page1.pmap012" order="0" ver="1" cite_std="N" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_oofb019()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmap012  #顯示到畫面上

            NEXT FIELD pmap012                     #返回原欄位

]]>
  </point>
  <point name="construct.c.page1.pmap014" order="0" ver="1" cite_std="N" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
			LET g_qryparam.arg1 = "263" #
            CALL q_oocq002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmap014  #顯示到畫面上

            NEXT FIELD pmap014                     #返回原欄位

]]>
  </point>
  <point name="construct.c.page2.pmapcrtdp" order="0" ver="1" cite_std="N" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooea001_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmapcrtdp  #顯示到畫面上

            NEXT FIELD pmapcrtdp                     #返回原欄位

]]>
  </point>
  <point name="construct.c.page2.pmapcrtid" order="0" ver="1" cite_std="N" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooag001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmapcrtid  #顯示到畫面上

            NEXT FIELD pmapcrtid                     #返回原欄位

]]>
  </point>
  <point name="construct.c.page2.pmapmodid" order="0" ver="1" cite_std="N" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooag001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmapmodid  #顯示到畫面上

            NEXT FIELD pmapmodid                     #返回原欄位

]]>
  </point>
  <point name="construct.c.page2.pmapowndp" order="0" ver="1" cite_std="N" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooea001_1()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmapowndp  #顯示到畫面上

            NEXT FIELD pmapowndp                     #返回原欄位

]]>
  </point>
  <point name="construct.c.page2.pmapownid" order="0" ver="1" cite_std="N" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_ooag001()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmapownid  #顯示到畫面上

            NEXT FIELD pmapownid                     #返回原欄位

]]>
  </point>
  <point name="construct.c.pmap001" order="0" ver="1" cite_std="N" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_pmaa001_3()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmap001  #顯示到畫面上

            NEXT FIELD pmap001                     #返回原欄位

]]>
  </point>
  <point name="construct.c.pmap002" order="0" ver="1" cite_std="N" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a08產生
            #開窗c段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			LET g_qryparam.reqry = FALSE
            CALL q_pmap002()                           #呼叫開窗
            DISPLAY g_qryparam.return1 TO pmap002  #顯示到畫面上

            NEXT FIELD pmap002                     #返回原欄位

]]>
  </point>
  <point name="input.a.page1.pmap003" order="0" ver="1" cite_std="" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            CALL apmi121_pmap003_ref(g_pmap_d[l_ac].pmap003) RETURNING g_pmap_d[l_ac].pmap003_desc,g_pmap_d[l_ac].imaal004
            DISPLAY BY NAME g_pmap_d[l_ac].pmap003_desc,g_pmap_d[l_ac].imaal004
            IF NOT cl_null(g_pmap_d[l_ac].pmap003) THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_pmap_d[l_ac].pmap003 != g_pmap_d_t.pmap003)) THEN
                  #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
                  INITIALIZE g_chkparam.* TO NULL
                  
                  #設定g_chkparam.*的參數
                  LET g_chkparam.arg1 = g_pmap_d[l_ac].pmap003
   
                     
                  #呼叫檢查存在並帶值的library
                  IF cl_chk_exist("v_imaa001") THEN
                     IF cl_chk_exist("v_imaf001_1") THEN 
                        #檢查成功時後續處理                 
                        SELECT imaf157,imaf143,imaf015,imaf144 INTO g_pmap_d[l_ac].pmap005,g_pmap_d[l_ac].pmap006,g_pmap_d[l_ac].pmap007,g_pmap_d[l_ac].pmap008
                          FROM imaf_t WHERE imafent = g_enterprise AND imafsite = g_site AND imaf001 = g_pmap_d[l_ac].pmap003
                        CALL apmi121_pmap005_ref(g_pmap_d[l_ac].pmap005) RETURNING g_pmap_d[l_ac].pmap005_desc
                        DISPLAY BY NAME g_pmap_d[l_ac].pmap005_desc
                        CALL apmi121_pmap006_ref(g_pmap_d[l_ac].pmap006) RETURNING g_pmap_d[l_ac].pmap006_desc
                        DISPLAY BY NAME g_pmap_d[l_ac].pmap006_desc
                        CALL apmi121_pmap006_ref(g_pmap_d[l_ac].pmap007) RETURNING g_pmap_d[l_ac].pmap007_desc
                        DISPLAY BY NAME g_pmap_d[l_ac].pmap007_desc
                        CALL apmi121_pmap006_ref(g_pmap_d[l_ac].pmap008) RETURNING g_pmap_d[l_ac].pmap008_desc
                        DISPLAY BY NAME g_pmap_d[l_ac].pmap008_desc
                     ELSE
                        #檢查失敗時後續處理
                        LET g_pmap_d[l_ac].pmap003 = g_pmap_d_t.pmap003
                        CALL apmi121_pmap003_ref(g_pmap_d[l_ac].pmap003) RETURNING g_pmap_d[l_ac].pmap003_desc,g_pmap_d[l_ac].imaal004
                        DISPLAY BY NAME g_pmap_d[l_ac].pmap003_desc,g_pmap_d[l_ac].imaal004
                        NEXT FIELD CURRENT
                     END IF
                  ELSE
                     #檢查失敗時後續處理
                     LET g_pmap_d[l_ac].pmap003 = g_pmap_d_t.pmap003
                     CALL apmi121_pmap003_ref(g_pmap_d[l_ac].pmap003) RETURNING g_pmap_d[l_ac].pmap003_desc,g_pmap_d[l_ac].imaal004
                     DISPLAY BY NAME g_pmap_d[l_ac].pmap003_desc,g_pmap_d[l_ac].imaal004
                     NEXT FIELD CURRENT
                  END IF
                  #此段落由子樣板a05產生
                  IF  NOT cl_null(g_pmap_m.pmap001) AND NOT cl_null(g_pmap_m.pmap002) AND NOT cl_null(g_pmap_d[l_ac].pmap003) AND g_pmap_d[l_ac].pmap004 IS NOT NULL THEN 
                     IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_pmap_m.pmap001 != g_pmap001_t OR g_pmap_m.pmap002 != g_pmap002_t OR g_pmap_d[l_ac].pmap003 != g_pmap_d_t.pmap003 OR g_pmap_d[l_ac].pmap004 != g_pmap_d_t.pmap004)) THEN 
                        IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM pmap_t WHERE "||"pmapent = '" ||g_enterprise|| "' AND pmapsite = '" ||g_site|| "' AND "||"pmap001 = '"||g_pmap_m.pmap001 ||"' AND "|| "pmap002 = '"||g_pmap_m.pmap002 ||"' AND "|| "pmap003 = '"||g_pmap_d[l_ac].pmap003 ||"' AND "|| "pmap004 = '"||g_pmap_d[l_ac].pmap004 ||"'",'std-00004',0) THEN 
                           LET g_pmap_d[l_ac].pmap003 = g_pmap_d_t.pmap003
                           CALL apmi121_pmap003_ref(g_pmap_d[l_ac].pmap003) RETURNING g_pmap_d[l_ac].pmap003_desc,g_pmap_d[l_ac].imaal004
                           DISPLAY BY NAME g_pmap_d[l_ac].pmap003_desc,g_pmap_d[l_ac].imaal004
                           NEXT FIELD CURRENT
                        END IF
                     END IF
                  END IF
               END IF 
            END IF

            
            CALL apmi121_set_entry_b(l_cmd)
            CALL apmi121_set_no_entry_b(l_cmd)
]]>
  </point>
  <point name="input.a.page1.pmap004" order="0" ver="1" cite_std="N" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  NOT cl_null(g_pmap_m.pmap001) AND NOT cl_null(g_pmap_m.pmap002) AND NOT cl_null(g_pmap_d[l_ac].pmap003) AND NOT cl_null(g_pmap_d[l_ac].pmap004) THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_pmap_m.pmap001 != g_pmap001_t OR g_pmap_m.pmap002 != g_pmap002_t OR g_pmap_d[l_ac].pmap003 != g_pmap_d_t.pmap003 OR g_pmap_d[l_ac].pmap004 != g_pmap_d_t.pmap004)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM pmap_t WHERE "||"pmapent = '" ||g_enterprise|| "' AND pmapsite = '" ||g_site|| "' AND "||"pmap001 = '"||g_pmap_m.pmap001 ||"' AND "|| "pmap002 = '"||g_pmap_m.pmap002 ||"' AND "|| "pmap003 = '"||g_pmap_d[l_ac].pmap003 ||"' AND "|| "pmap004 = '"||g_pmap_d[l_ac].pmap004 ||"'",'std-00004',0) THEN 
                     LET g_pmap_d[l_ac].pmap004 = g_pmap_d_t.pmap004
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page1.pmap005" order="0" ver="1" cite_std="" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            CALL apmi121_pmap005_ref(g_pmap_d[l_ac].pmap005) RETURNING g_pmap_d[l_ac].pmap005_desc
            DISPLAY BY NAME g_pmap_d[l_ac].pmap005_desc
            IF NOT cl_null(g_pmap_d[l_ac].pmap005) THEN 
               #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
               INITIALIZE g_chkparam.* TO NULL
               
               #設定g_chkparam.*的參數
               LET g_chkparam.arg1 = g_pmap_d[l_ac].pmap005
                  
               #呼叫檢查存在並帶值的library
               IF cl_chk_exist("v_imaa001_3") THEN
                  IF cl_chk_exist("v_imaf001_2") THEN 
                 
                  ELSE
                     #檢查失敗時後續處理
                     LET g_pmap_d[l_ac].pmap005 = g_pmap_d_t.pmap005
                     CALL apmi121_pmap005_ref(g_pmap_d[l_ac].pmap005) RETURNING g_pmap_d[l_ac].pmap005_desc
                     DISPLAY BY NAME g_pmap_d[l_ac].pmap005_desc
                     NEXT FIELD CURRENT
                  END IF
               ELSE
                  #檢查失敗時後續處理
                  LET g_pmap_d[l_ac].pmap005 = g_pmap_d_t.pmap005
                  CALL apmi121_pmap005_ref(g_pmap_d[l_ac].pmap005) RETURNING g_pmap_d[l_ac].pmap005_desc
                  DISPLAY BY NAME g_pmap_d[l_ac].pmap005_desc
                  NEXT FIELD CURRENT
               END IF         
            END IF 
]]>
  </point>
  <point name="input.a.page1.pmap006" order="0" ver="1" cite_std="N" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            CALL apmi121_pmap006_ref(g_pmap_d[l_ac].pmap006) RETURNING g_pmap_d[l_ac].pmap006_desc
            DISPLAY BY NAME g_pmap_d[l_ac].pmap006_desc
            IF NOT cl_null(g_pmap_d[l_ac].pmap006) THEN 
               IF NOT apmi121_pmap006_chk(g_pmap_d[l_ac].pmap006) THEN
                  LET g_pmap_d[l_ac].pmap006 = g_pmap_d_t.pmap006
                  CALL apmi121_pmap006_ref(g_pmap_d[l_ac].pmap006) RETURNING g_pmap_d[l_ac].pmap006_desc
                  DISPLAY BY NAME g_pmap_d[l_ac].pmap006_desc
                  NEXT FIELD CURRENT
               END IF
            END IF 
]]>
  </point>
  <point name="input.a.page1.pmap007" order="0" ver="1" cite_std="N" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            CALL apmi121_pmap006_ref(g_pmap_d[l_ac].pmap007) RETURNING g_pmap_d[l_ac].pmap007_desc
            DISPLAY BY NAME g_pmap_d[l_ac].pmap007_desc
            IF NOT cl_null(g_pmap_d[l_ac].pmap007) THEN 
               IF NOT apmi121_pmap006_chk(g_pmap_d[l_ac].pmap007) THEN
                  LET g_pmap_d[l_ac].pmap007 = g_pmap_d_t.pmap007
                  CALL apmi121_pmap006_ref(g_pmap_d[l_ac].pmap007) RETURNING g_pmap_d[l_ac].pmap007_desc
                  DISPLAY BY NAME g_pmap_d[l_ac].pmap007_desc
                  NEXT FIELD CURRENT
               END IF
            END IF 
]]>
  </point>
  <point name="input.a.page1.pmap008" order="0" ver="1" cite_std="N" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            CALL apmi121_pmap006_ref(g_pmap_d[l_ac].pmap008) RETURNING g_pmap_d[l_ac].pmap008_desc
            DISPLAY BY NAME g_pmap_d[l_ac].pmap008_desc
            IF NOT cl_null(g_pmap_d[l_ac].pmap008) THEN 
               IF NOT apmi121_pmap006_chk(g_pmap_d[l_ac].pmap008) THEN
                  LET g_pmap_d[l_ac].pmap008 = g_pmap_d_t.pmap008
                  CALL apmi121_pmap006_ref(g_pmap_d[l_ac].pmap008) RETURNING g_pmap_d[l_ac].pmap008_desc
                  DISPLAY BY NAME g_pmap_d[l_ac].pmap008_desc
                  NEXT FIELD CURRENT
               END IF
            END IF ]]>
  </point>
  <point name="input.a.page1.pmap009" order="0" ver="1" cite_std="N" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            CALL apmi121_pmap009_ref(g_pmap_d[l_ac].pmap009) RETURNING g_pmap_d[l_ac].pmap009_desc
            DISPLAY BY NAME g_pmap_d[l_ac].pmap009_desc
            IF NOT cl_null(g_pmap_d[l_ac].pmap009) THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_pmap_d[l_ac].pmap009 != g_pmap_d_t.pmap009)) THEN 
                  #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
                  INITIALIZE g_chkparam.* TO NULL
                  
                  #設定g_chkparam.*的參數
                  LET g_chkparam.arg1 = g_pmap_d[l_ac].pmap009
                     
                  #呼叫檢查存在並帶值的library
                  IF cl_chk_exist("v_ooef001") THEN
                     #檢查成功時後續處理
                     #帶出該營運據點的聯絡地址代碼
                     LET l_ooef012 = ''
                     SELECT ooef012 INTO l_ooef012 FROM ooef_t WHERE ooefent = g_enterprise AND ooef001 = g_pmap_d[l_ac].pmap009
                     SELECT oofb019 INTO g_pmap_d[l_ac].pmap012 FROM oofb_t WHERE oofbent = g_enterprise AND oofb002 = l_ooef012 AND oofb010 = 'Y'
                     #若不存在主要聯絡地址，抓取第一筆資料
                     IF cl_null(g_pmap_d[l_ac].pmap012) THEN
                        LET l_oofb001 = ''
                        SELECT MIN(oofb001) INTO l_oofb001 FROM oofb_t WHERE oofbent = g_enterprise AND oofb002 = l_ooef012
                        SELECT oofb019 INTO g_pmap_d[l_ac].pmap012 FROM oofb_t WHERE oofbent = g_enterprise AND oofb001 = l_oofb001
                        CALL apmi121_pmap012_ref(g_pmap_d[l_ac].pmap012) RETURNING g_pmap_d[l_ac].pmap012_desc
                        DISPLAY BY NAME g_pmap_d[l_ac].pmap012_desc
                     END IF
                     #檢查庫位、儲位是否在該營運據點下 
                     IF NOT cl_null(g_pmap_d[l_ac].pmap010) THEN
                        IF NOT apmi121_pmap010_chk() THEN
                           NEXT FIELD pmap010
                        ELSE
                           IF NOT cl_null(g_pmap_d[l_ac].pmap011) THEN
                              IF NOT apmi121_pmap011_chk() THEN
                                 NEXT FIELD pmap011
                              END IF
                            END IF
                        END IF
                     END IF
                     #檢查收貨地址是否在對應的收貨營運據點或收貨庫位範圍內
                     IF NOT cl_null(g_pmap_d[l_ac].pmap012) THEN
                        IF NOT apmi121_pmap012_chk() THEN
                            NEXT FIELD pmap012
                        END IF
                     END IF
                  ELSE
                     #檢查失敗時後續處理
                     LET g_pmap_d[l_ac].pmap009 = g_pmap_d_t.pmap009
                     CALL apmi121_pmap009_ref(g_pmap_d[l_ac].pmap009) RETURNING g_pmap_d[l_ac].pmap009_desc
                     DISPLAY BY NAME g_pmap_d[l_ac].pmap009_desc
                     NEXT FIELD CURRENT
                  END IF
               END IF
            ELSE
               LET g_pmap_d[l_ac].pmap009 = g_site
               CALL apmi121_pmap009_ref(g_pmap_d[l_ac].pmap009) RETURNING g_pmap_d[l_ac].pmap009_desc
               DISPLAY BY NAME g_pmap_d[l_ac].pmap009_desc
            END IF ]]>
  </point>
  <point name="input.a.page1.pmap010" order="0" ver="1" cite_std="N" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            CALL apmi121_pmap010_ref(g_pmap_d[l_ac].pmap009,g_pmap_d[l_ac].pmap010) RETURNING g_pmap_d[l_ac].pmap010_desc
            DISPLAY BY NAME g_pmap_d[l_ac].pmap010_desc
            
            IF NOT cl_null(g_pmap_d[l_ac].pmap010) THEN 
               #IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_pmap_d[l_ac].pmap010 != g_pmap_d_t.pmap010 OR cl_null(g_pmap_d_t.pmap010))) THEN 
                  IF NOT apmi121_pmap010_chk() THEN
                     LET g_pmap_d[l_ac].pmap010 = g_pmap_d_t.pmap010
                     CALL apmi121_pmap010_ref(g_pmap_d[l_ac].pmap009,g_pmap_d[l_ac].pmap010) RETURNING g_pmap_d[l_ac].pmap010_desc
                     DISPLAY BY NAME g_pmap_d[l_ac].pmap010_desc
                     NEXT FIELD pmap010
                  ELSE
                     #帶出該庫位編號的聯絡地址代碼
                     LET l_ooef012 = ''
                     LET l_oofb019 = ''
                     SELECT inaa004 INTO l_ooef012 FROM inaa_t WHERE inaaent = g_enterprise AND inaasite = g_pmap_d[l_ac].pmap009 AND inaa001 = g_pmap_d[l_ac].pmap010
                     SELECT oofb019 INTO l_oofb019 FROM oofb_t WHERE oofbent = g_enterprise AND oofb002 = l_ooef012 AND oofb010 = 'Y'
                     #若不存在主要聯絡地址，抓取第一筆資料
                     IF cl_null(l_oofb019) THEN
                        LET l_oofb001 = ''
                        SELECT MIN(oofb001) INTO l_oofb001 FROM oofb_t WHERE oofbent = g_enterprise AND oofb002 = l_ooef012
                        SELECT oofb019 INTO l_oofb019 FROM oofb_t WHERE oofbent = g_enterprise AND oofb001 = l_oofb001
                        CALL apmi121_pmap012_ref(g_pmap_d[l_ac].pmap012) RETURNING g_pmap_d[l_ac].pmap012_desc
                        DISPLAY BY NAME g_pmap_d[l_ac].pmap012_desc
                     END IF
                     IF NOT cl_null(l_oofb019) THEN
                        LET g_pmap_d[l_ac].pmap012 = l_oofb019
                     END IF
                     
                  END IF
               #END IF
            END IF
            #判斷當前儲位是否在該庫位編號下
            IF NOT cl_null(g_pmap_d[l_ac].pmap011) THEN
               IF NOT apmi121_pmap011_chk() THEN
                  LET g_pmap_d[l_ac].pmap010 = g_pmap_d_t.pmap010
                  CALL apmi121_pmap010_ref(g_pmap_d[l_ac].pmap009,g_pmap_d[l_ac].pmap010) RETURNING g_pmap_d[l_ac].pmap010_desc
                  DISPLAY BY NAME g_pmap_d[l_ac].pmap010_desc
                  NEXT FIELD pmap010
               END IF
            END IF
            #檢查收貨地址是否在對應的收貨營運據點或收貨庫位範圍內
            IF NOT cl_null(g_pmap_d[l_ac].pmap012) THEN
               IF NOT apmi121_pmap012_chk() THEN
                  LET g_pmap_d[l_ac].pmap010 = g_pmap_d_t.pmap010
                  CALL apmi121_pmap010_ref(g_pmap_d[l_ac].pmap009,g_pmap_d[l_ac].pmap010) RETURNING g_pmap_d[l_ac].pmap010_desc
                  DISPLAY BY NAME g_pmap_d[l_ac].pmap010_desc
                  NEXT FIELD pmap010
               END IF
            END IF            ]]>
  </point>
  <point name="input.a.page1.pmap011" order="0" ver="1" cite_std="N" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            CALL apmi121_pmap011_ref(g_pmap_d[l_ac].pmap009,g_pmap_d[l_ac].pmap010,g_pmap_d[l_ac].pmap011) RETURNING g_pmap_d[l_ac].pmap011_desc
            DISPLAY BY NAME g_pmap_d[l_ac].pmap011_desc
            
            IF NOT cl_null(g_pmap_d[l_ac].pmap011) THEN 
               #IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_pmap_d[l_ac].pmap011 != g_pmap_d_t.pmap011 OR cl_null(g_pmap_d_t.pmap011))) THEN 
                  IF NOT apmi121_pmap011_chk() THEN
                     LET g_pmap_d[l_ac].pmap011 = g_pmap_d_t.pmap011
                     CALL apmi121_pmap011_ref(g_pmap_d[l_ac].pmap009,g_pmap_d[l_ac].pmap010,g_pmap_d[l_ac].pmap011) RETURNING g_pmap_d[l_ac].pmap011_desc
                     DISPLAY BY NAME g_pmap_d[l_ac].pmap011_desc
                     NEXT FIELD pmap011
                  END IF
               #END IF
            END IF]]>
  </point>
  <point name="input.a.page1.pmap012" order="0" ver="1" cite_std="N" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            CALL apmi121_pmap012_ref(g_pmap_d[l_ac].pmap012) RETURNING g_pmap_d[l_ac].pmap012_desc
            DISPLAY BY NAME g_pmap_d[l_ac].pmap012_desc
            IF NOT cl_null(g_pmap_d[l_ac].pmap012) THEN 
               #IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_pmap_d[l_ac].pmap012 != g_pmap_d_t.pmap012 OR cl_null(g_pmap_d_t.pmap012))) THEN 
                  #檢查收貨地址是否在對應的收貨營運據點或收貨庫位範圍內
                  IF NOT apmi121_pmap012_chk() THEN
                     LET g_pmap_d[l_ac].pmap012 = g_pmap_d_t.pmap012
                     CALL apmi121_pmap012_ref(g_pmap_d[l_ac].pmap012) RETURNING g_pmap_d[l_ac].pmap012_desc
                     DISPLAY BY NAME g_pmap_d[l_ac].pmap012_desc
                     NEXT FIELD CURRENT
                  END IF
               #END IF
            END IF ]]>
  </point>
  <point name="input.a.page1.pmap013" order="0" ver="1" cite_std="N" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            IF NOT cl_null(g_pmap_d[l_ac].pmap013) THEN 
            END IF 
]]>
  </point>
  <point name="input.a.page1.pmap014" order="0" ver="1" cite_std="N" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            CALL apmi121_pmap014_ref(g_pmap_d[l_ac].pmap014) RETURNING g_pmap_d[l_ac].pmap014_desc
            DISPLAY BY NAME g_pmap_d[l_ac].pmap014_desc
            IF NOT cl_null(g_pmap_d[l_ac].pmap014) THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_pmap_d[l_ac].pmap014 != g_pmap_d_t.pmap014 OR cl_null(g_pmap_d_t.pmap014))) THEN 
                  #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
                  INITIALIZE g_chkparam.* TO NULL
                  
                  #設定g_chkparam.*的參數
                  LET g_chkparam.arg1 = g_pmap_d[l_ac].pmap014 
                     
                  #呼叫檢查存在並帶值的library
                  IF cl_chk_exist("v_oocq002_263") THEN
                     #檢查成功時後續處理
                  ELSE
                     #檢查失敗時後續處理
                     LET g_pmap_d[l_ac].pmap014 = g_pmap_d_t.pmap014
                     CALL apmi121_pmap014_ref(g_pmap_d[l_ac].pmap014) RETURNING g_pmap_d[l_ac].pmap014_desc
                     DISPLAY BY NAME g_pmap_d[l_ac].pmap014_desc
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF ]]>
  </point>
  <point name="input.a.page2.pmap003_2" order="0" ver="1" cite_std="" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  NOT cl_null(g_pmap_m.pmap001) AND NOT cl_null(g_pmap_m.pmap002) AND NOT cl_null(g_pmap2_d[g_detail_idx].pmap003) AND NOT cl_null(g_pmap2_d[g_detail_idx].pmap004) THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_pmap_m.pmap001 != g_pmap001_t OR g_pmap_m.pmap002 != g_pmap002_t OR g_pmap2_d[g_detail_idx].pmap003 != g_pmap2_d_t.pmap003 OR g_pmap2_d[g_detail_idx].pmap004 != g_pmap2_d_t.pmap004)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM pmap_t WHERE "||"pmapent = '" ||g_enterprise|| "' AND pmapsite = '" ||g_site|| "' AND "||"pmap001 = '"||g_pmap_m.pmap001 ||"' AND "|| "pmap002 = '"||g_pmap_m.pmap002 ||"' AND "|| "pmap003 = '"||g_pmap2_d[g_detail_idx].pmap003 ||"' AND "|| "pmap004 = '"||g_pmap2_d[g_detail_idx].pmap004 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.page2.pmap004_2" order="0" ver="1" cite_std="" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            IF  NOT cl_null(g_pmap_m.pmap001) AND NOT cl_null(g_pmap_m.pmap002) AND NOT cl_null(g_pmap2_d[g_detail_idx].pmap003) AND NOT cl_null(g_pmap2_d[g_detail_idx].pmap004) THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_pmap_m.pmap001 != g_pmap001_t OR g_pmap_m.pmap002 != g_pmap002_t OR g_pmap2_d[g_detail_idx].pmap003 != g_pmap2_d_t.pmap003 OR g_pmap2_d[g_detail_idx].pmap004 != g_pmap2_d_t.pmap004)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM pmap_t WHERE "||"pmapent = '" ||g_enterprise|| "' AND pmapsite = '" ||g_site|| "' AND "||"pmap001 = '"||g_pmap_m.pmap001 ||"' AND "|| "pmap002 = '"||g_pmap_m.pmap002 ||"' AND "|| "pmap003 = '"||g_pmap2_d[g_detail_idx].pmap003 ||"' AND "|| "pmap004 = '"||g_pmap2_d[g_detail_idx].pmap004 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

]]>
  </point>
  <point name="input.a.pmap001" order="0" ver="1" cite_std="N" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            CALL apmi121_pmap001_ref(g_pmap_m.pmap001) RETURNING g_pmap_m.pmaal004
            DISPLAY BY NAME g_pmap_m.pmaal004
            IF  NOT cl_null(g_pmap_m.pmap001) AND NOT cl_null(g_pmap_m.pmap002) THEN 
               IF p_cmd = 'a' OR ( p_cmd = 'u' AND (g_pmap_m.pmap001 != g_pmap001_t  OR g_pmap_m.pmap002 != g_pmap002_t )) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM pmap_t WHERE "||"pmapent = '" ||g_enterprise|| "' AND pmapsite = '" ||g_site|| "' AND "||"pmap001 = '"||g_pmap_m.pmap001 ||"' AND "|| "pmap002 = '"||g_pmap_m.pmap002 ||"'",'std-00004',0) THEN 
                     LET g_pmap_m.pmap001 = g_pmap_m_t.pmap001
                     CALL apmi121_pmap001_ref(g_pmap_m.pmap001) RETURNING g_pmap_m.pmaal004
                     DISPLAY BY NAME g_pmap_m.pmaal004
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF


            IF NOT cl_null(g_pmap_m.pmap001) THEN 
               IF NOT apmi121_pmap001_chk(g_pmap_m.pmap001) THEN
                  LET g_pmap_m.pmap001 = g_pmap_m_t.pmap001
                  CALL apmi121_pmap001_ref(g_pmap_m.pmap001) RETURNING g_pmap_m.pmaal004
                  DISPLAY BY NAME g_pmap_m.pmaal004
                  NEXT FIELD CURRENT
               END IF
            END IF 
]]>
  </point>
  <point name="input.a.pmap002" order="0" ver="1" cite_std="N" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            #此段落由子樣板a05產生
            CALL apmi121_pmap002_ref(g_pmap_m.pmap002) RETURNING g_pmap_m.oohal003
            DISPLAY BY NAME g_pmap_m.oohal003
            IF  NOT cl_null(g_pmap_m.pmap001) AND NOT cl_null(g_pmap_m.pmap002) THEN 
               IF p_cmd = 'a' OR ( p_cmd = 'u' AND (g_pmap_m.pmap001 != g_pmap001_t  OR g_pmap_m.pmap002 != g_pmap002_t )) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM pmap_t WHERE "||"pmapent = '" ||g_enterprise|| "' AND pmapsite = '" ||g_site|| "' AND "||"pmap001 = '"||g_pmap_m.pmap001 ||"' AND "|| "pmap002 = '"||g_pmap_m.pmap002 ||"'",'std-00004',0) THEN 
                     LET g_pmap_m.pmap002 = g_pmap_m_t.pmap002
                     CALL apmi121_pmap002_ref(g_pmap_m.pmap002) RETURNING g_pmap_m.oohal003
                     DISPLAY BY NAME g_pmap_m.oohal003
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

            #允許輸入'ALL'的值，當輸入'ALL'時代表所有控制組均滿足此預設條件
            IF NOT cl_null(g_pmap_m.pmap002) AND g_pmap_m.pmap002 <> 'ALL' THEN 
               IF NOT apmi121_pmap002_chk(g_pmap_m.pmap002) THEN
                  LET g_pmap_m.pmap002 = g_pmap_m_t.pmap002
                  CALL apmi121_pmap002_ref(g_pmap_m.pmap002) RETURNING g_pmap_m.oohal003
                  DISPLAY BY NAME g_pmap_m.oohal003
                  NEXT FIELD CURRENT
               END IF
            END IF 
]]>
  </point>
  <point name="input.c.page1.pmap003" order="0" ver="1" cite_std="" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_pmap_d[l_ac].pmap003             #給予default值

            #給予arg

            CALL q_imaf001()                                #呼叫開窗

            LET g_pmap_d[l_ac].pmap003 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_pmap_d[l_ac].pmap003 TO pmap003              #顯示到畫面上
            CALL apmi121_pmap003_ref(g_pmap_d[l_ac].pmap003) RETURNING g_pmap_d[l_ac].pmap003_desc,g_pmap_d[l_ac].imaal004
            DISPLAY BY NAME g_pmap_d[l_ac].pmap003_desc,g_pmap_d[l_ac].imaal004

            NEXT FIELD pmap003                          #返回原欄位

]]>
  </point>
  <point name="input.c.page1.pmap005" order="0" ver="1" cite_std="" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_pmap_d[l_ac].pmap005             #給予default值

            #給予arg

            CALL q_imaf001_5()                                #呼叫開窗

            LET g_pmap_d[l_ac].pmap005 = g_qryparam.return1              #將開窗取得的值回傳到變數
            CALL apmi121_pmap005_ref(g_pmap_d[l_ac].pmap005) RETURNING g_pmap_d[l_ac].pmap005_desc
            DISPLAY BY NAME g_pmap_d[l_ac].pmap005_desc

            DISPLAY g_pmap_d[l_ac].pmap005 TO pmap005              #顯示到畫面上

            NEXT FIELD pmap005                          #返回原欄位

]]>
  </point>
  <point name="input.c.page1.pmap006" order="0" ver="1" cite_std="N" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_pmap_d[l_ac].pmap006             #給予default值

            #給予arg

            CALL q_ooca001_1()                                #呼叫開窗

            LET g_pmap_d[l_ac].pmap006 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_pmap_d[l_ac].pmap006 TO pmap006              #顯示到畫面上
            CALL apmi121_pmap006_ref(g_pmap_d[l_ac].pmap006) RETURNING g_pmap_d[l_ac].pmap006_desc
            DISPLAY BY NAME g_pmap_d[l_ac].pmap006_desc

            NEXT FIELD pmap006                          #返回原欄位

]]>
  </point>
  <point name="input.c.page1.pmap007" order="0" ver="1" cite_std="N" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_pmap_d[l_ac].pmap007             #給予default值

            #給予arg

            CALL q_ooca001_1()                                #呼叫開窗

            LET g_pmap_d[l_ac].pmap007 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_pmap_d[l_ac].pmap007 TO pmap007              #顯示到畫面上
            CALL apmi121_pmap006_ref(g_pmap_d[l_ac].pmap007) RETURNING g_pmap_d[l_ac].pmap007_desc
            DISPLAY BY NAME g_pmap_d[l_ac].pmap007_desc

            NEXT FIELD pmap007                          #返回原欄位

]]>
  </point>
  <point name="input.c.page1.pmap008" order="0" ver="1" cite_std="N" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_pmap_d[l_ac].pmap008             #給予default值

            #給予arg

            CALL q_ooca001_1()                                #呼叫開窗

            LET g_pmap_d[l_ac].pmap008 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_pmap_d[l_ac].pmap008 TO pmap008              #顯示到畫面上
            CALL apmi121_pmap006_ref(g_pmap_d[l_ac].pmap008) RETURNING g_pmap_d[l_ac].pmap008_desc
            DISPLAY BY NAME g_pmap_d[l_ac].pmap008_desc
            
            NEXT FIELD pmap008                          #返回原欄位

]]>
  </point>
  <point name="input.c.page1.pmap009" order="0" ver="1" cite_std="N" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_pmap_d[l_ac].pmap009             #給予default值

            #給予arg

            CALL q_ooef001()                                #呼叫開窗

            LET g_pmap_d[l_ac].pmap009 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_pmap_d[l_ac].pmap009 TO pmap009              #顯示到畫面上
            CALL apmi121_pmap009_ref(g_pmap_d[l_ac].pmap009) RETURNING g_pmap_d[l_ac].pmap009_desc
            DISPLAY BY NAME g_pmap_d[l_ac].pmap009_desc

            NEXT FIELD pmap009                          #返回原欄位

]]>
  </point>
  <point name="input.c.page1.pmap010" order="0" ver="1" cite_std="N" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE
			LET g_qryparam.arg1 = g_pmap_d[l_ac].pmap009
            LET g_qryparam.default1 = g_pmap_d[l_ac].pmap010             #給予default值

            #給予arg

            CALL q_inaa001_6()                                #呼叫開窗

            LET g_pmap_d[l_ac].pmap010 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_pmap_d[l_ac].pmap010 TO pmap010              #顯示到畫面上
            CALL apmi121_pmap010_ref(g_pmap_d[l_ac].pmap009,g_pmap_d[l_ac].pmap010) RETURNING g_pmap_d[l_ac].pmap010_desc
            DISPLAY BY NAME g_pmap_d[l_ac].pmap010_desc

            NEXT FIELD pmap010                          #返回原欄位

]]>
  </point>
  <point name="input.c.page1.pmap011" order="0" ver="1" cite_std="N" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE
			LET g_qryparam.arg1 = g_pmap_d[l_ac].pmap009
			LET g_qryparam.arg2 = g_pmap_d[l_ac].pmap010
            LET g_qryparam.default1 = g_pmap_d[l_ac].pmap011             #給予default值

            #給予arg

            CALL q_inab002_6()                                #呼叫開窗

            LET g_pmap_d[l_ac].pmap011 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_pmap_d[l_ac].pmap011 TO pmap011              #顯示到畫面上
            
            CALL apmi121_pmap011_ref(g_pmap_d[l_ac].pmap009,g_pmap_d[l_ac].pmap010,g_pmap_d[l_ac].pmap011) RETURNING g_pmap_d[l_ac].pmap011_desc
            DISPLAY BY NAME g_pmap_d[l_ac].pmap011_desc

            NEXT FIELD pmap011                          #返回原欄位

]]>
  </point>
  <point name="input.c.page1.pmap012" order="0" ver="1" cite_std="N" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            MENU "" ATTRIBUTE (STYLE="popup", IMAGE="question")
               ON ACTION open_ooef   #營運據點
                  LET g_bgjob = '1'
                  EXIT MENU

               ON ACTION open_inaa   #庫位
                  LET g_bgjob = '2'
                  EXIT MENU
            END MENU
                           
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_pmap_d[l_ac].pmap012             #給予default值

            #給予arg
            LET l_ooef012 = ''
            IF g_bgjob = '1' THEN  
               SELECT ooef012 INTO l_ooef012 FROM ooef_t WHERE ooefent = g_enterprise AND ooef001 = g_pmap_d[l_ac].pmap009 
            ELSE
               SELECT inaa004 INTO l_ooef012 FROM inaa_t WHERE inaaent = g_enterprise AND inaasite = g_pmap_d[l_ac].pmap009 AND inaa001 = g_pmap_d[l_ac].pmap010 
            END IF               
            LET g_qryparam.arg1 = l_ooef012

            CALL q_oofb019()                                #呼叫開窗

            LET g_pmap_d[l_ac].pmap012 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_pmap_d[l_ac].pmap012 TO pmap012              #顯示到畫面上
            
            CALL apmi121_pmap012_ref(g_pmap_d[l_ac].pmap012) RETURNING g_pmap_d[l_ac].pmap012_desc
            DISPLAY BY NAME g_pmap_d[l_ac].pmap012_desc

            NEXT FIELD pmap012                          #返回原欄位

]]>
  </point>
  <point name="input.c.page1.pmap014" order="0" ver="1" cite_std="N" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_pmap_d[l_ac].pmap014             #給予default值

            #給予arg
            LET g_qryparam.arg1 = "263" #

            CALL q_oocq002()                                #呼叫開窗

            LET g_pmap_d[l_ac].pmap014 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_pmap_d[l_ac].pmap014 TO pmap014              #顯示到畫面上
            CALL apmi121_pmap014_ref(g_pmap_d[l_ac].pmap014) RETURNING g_pmap_d[l_ac].pmap014_desc
            DISPLAY BY NAME g_pmap_d[l_ac].pmap014_desc

            NEXT FIELD pmap014                          #返回原欄位

]]>
  </point>
  <point name="input.c.pmap001" order="0" ver="1" cite_std="N" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_pmap_m.pmap001             #給予default值

            #給予arg

            CALL q_pmaa001_3()                                #呼叫開窗

            LET g_pmap_m.pmap001 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_pmap_m.pmap001 TO pmap001              #顯示到畫面上
            CALL apmi121_pmap001_ref(g_pmap_m.pmap001) RETURNING g_pmap_m.pmaal004
            DISPLAY BY NAME g_pmap_m.pmaal004

            NEXT FIELD pmap001                          #返回原欄位

]]>
  </point>
  <point name="input.c.pmap002" order="0" ver="1" cite_std="N" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_pmap_m.pmap002             #給予default值

            #給予arg

            CALL q_ooha001_4()                                #呼叫開窗

            LET g_pmap_m.pmap002 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY g_pmap_m.pmap002 TO pmap002              #顯示到畫面上
               
            CALL apmi121_pmap002_ref(g_pmap_m.pmap002) RETURNING g_pmap_m.oohal003
            DISPLAY BY NAME g_pmap_m.oohal003

            NEXT FIELD pmap002                          #返回原欄位

]]>
  </point>
  <point name="ref_show.body.reference" order="0" ver="1" cite_std="N" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            CALL apmi121_pmap003_ref(g_pmap_d[l_ac].pmap003) RETURNING g_pmap_d[l_ac].pmap003_desc,g_pmap_d[l_ac].imaal004
            DISPLAY BY NAME g_pmap_d[l_ac].pmap003_desc,g_pmap_d[l_ac].imaal004
            
            CALL apmi121_pmap005_ref(g_pmap_d[l_ac].pmap005) RETURNING g_pmap_d[l_ac].pmap005_desc
            DISPLAY BY NAME g_pmap_d[l_ac].pmap005_desc

            CALL apmi121_pmap006_ref(g_pmap_d[l_ac].pmap006) RETURNING g_pmap_d[l_ac].pmap006_desc
            DISPLAY BY NAME g_pmap_d[l_ac].pmap006_desc
            
            CALL apmi121_pmap006_ref(g_pmap_d[l_ac].pmap007) RETURNING g_pmap_d[l_ac].pmap007_desc
            DISPLAY BY NAME g_pmap_d[l_ac].pmap007_desc
            
            CALL apmi121_pmap006_ref(g_pmap_d[l_ac].pmap008) RETURNING g_pmap_d[l_ac].pmap008_desc
            DISPLAY BY NAME g_pmap_d[l_ac].pmap008_desc

            CALL apmi121_pmap009_ref(g_pmap_d[l_ac].pmap009) RETURNING g_pmap_d[l_ac].pmap009_desc
            DISPLAY BY NAME g_pmap_d[l_ac].pmap009_desc

            CALL apmi121_pmap010_ref(g_pmap_d[l_ac].pmap009,g_pmap_d[l_ac].pmap010) RETURNING g_pmap_d[l_ac].pmap010_desc
            DISPLAY BY NAME g_pmap_d[l_ac].pmap010_desc

            CALL apmi121_pmap011_ref(g_pmap_d[l_ac].pmap009,g_pmap_d[l_ac].pmap010,g_pmap_d[l_ac].pmap011) RETURNING g_pmap_d[l_ac].pmap011_desc
            DISPLAY BY NAME g_pmap_d[l_ac].pmap011_desc

            CALL apmi121_pmap012_ref(g_pmap_d[l_ac].pmap012) RETURNING g_pmap_d[l_ac].pmap012_desc
            DISPLAY BY NAME g_pmap_d[l_ac].pmap012_desc
           
            CALL apmi121_pmap014_ref(g_pmap_d[l_ac].pmap014) RETURNING g_pmap_d[l_ac].pmap014_desc
            DISPLAY BY NAME g_pmap_d[l_ac].pmap014_desc
]]>
  </point>
  <point name="ref_show.body2.reference" order="0" ver="1" cite_std="N" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_pmap2_d[l_ac].pmapownid
            CALL ap_ref_array2(g_ref_fields,"SELECT oofa011 FROM oofa_t WHERE oofaent='"||g_enterprise||"' AND oofa002='2' AND oofa003=? ","") RETURNING g_rtn_fields
            LET g_pmap2_d[l_ac].pmapownid_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_pmap2_d[l_ac].pmapownid_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_pmap2_d[l_ac].pmapowndp
            CALL ap_ref_array2(g_ref_fields,"SELECT ooeal003 FROM ooeal_t WHERE ooealent='"||g_enterprise||"' AND ooeal001=? AND ooeal002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_pmap2_d[l_ac].pmapowndp_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_pmap2_d[l_ac].pmapowndp_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_pmap2_d[l_ac].pmapcrtid
            CALL ap_ref_array2(g_ref_fields,"SELECT oofa011 FROM oofa_t WHERE oofaent='"||g_enterprise||"' AND oofa002='2' AND oofa003=? ","") RETURNING g_rtn_fields
            LET g_pmap2_d[l_ac].pmapcrtid_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_pmap2_d[l_ac].pmapcrtid_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_pmap2_d[l_ac].pmapcrtdp
            CALL ap_ref_array2(g_ref_fields,"SELECT ooeal003 FROM ooeal_t WHERE ooealent='"||g_enterprise||"' AND ooeal001=? AND ooeal002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_pmap2_d[l_ac].pmapcrtdp_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_pmap2_d[l_ac].pmapcrtdp_desc

            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_pmap2_d[l_ac].pmapmodid
            CALL ap_ref_array2(g_ref_fields,"SELECT oofa011 FROM oofa_t WHERE oofaent='"||g_enterprise||"' AND oofa002='2' AND oofa003=? ","") RETURNING g_rtn_fields
            LET g_pmap2_d[l_ac].pmapmodid_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_pmap2_d[l_ac].pmapmodid_desc
]]>
  </point>
  <point name="function.apmi121_pmap001_chk" order="1" ver="1" cite_std="N" cite_ver="" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION apmi121_pmap001_chk(p_pmap001)
DEFINE p_pmap001     LIKE pmap_t.pmap001
DEFINE r_success     LIKE type_t.num5

       LET r_success = TRUE 
       IF NOT cl_null(p_pmap001) THEN 
          #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
          INITIALIZE g_chkparam.* TO NULL
          
          #設定g_chkparam.*的參數
          LET g_chkparam.arg1 = p_pmap001

             
          #呼叫檢查存在並帶值的library
          IF cl_chk_exist("v_pmaa001_1") THEN
             #檢查成功時後續處理             
          ELSE
             #檢查失敗時後續處理
             LET r_success = FALSE
             RETURN r_success
          END IF
       END IF 
       RETURN r_success
       
END FUNCTION]]>
  </point>
  <point name="function.apmi121_pmap001_ref" order="2" ver="1" cite_std="N" cite_ver="" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION apmi121_pmap001_ref(p_pmap001)
DEFINE p_pmap001     LIKE pmap_t.pmap001
DEFINE r_pmaal004    LIKE pmaal_t.pmaal004

       INITIALIZE g_ref_fields TO NULL
       LET g_ref_fields[1] = p_pmap001
       CALL ap_ref_array2(g_ref_fields,"SELECT pmaal004 FROM pmaal_t WHERE pmaalent='"||g_enterprise||"' AND pmaal001=? AND pmaal002='"||g_dlang||"'","") RETURNING g_rtn_fields
       LET r_pmaal004 = '', g_rtn_fields[1] , ''

       RETURN r_pmaal004
END FUNCTION]]>
  </point>
  <point name="function.apmi121_pmap002_chk" order="3" ver="1" cite_std="N" cite_ver="" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION apmi121_pmap002_chk(p_pmap002)
DEFINE p_pmap002     LIKE pmap_t.pmap002
DEFINE r_success     LIKE type_t.num5

       LET r_success = TRUE 
       
       IF NOT cl_null(g_pmap_m.pmap002) THEN 
          #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
          INITIALIZE g_chkparam.* TO NULL
          
          #設定g_chkparam.*的參數
          LET g_chkparam.arg1 = p_pmap002
             
          #呼叫檢查存在並帶值的library
          IF cl_chk_exist("v_ooha001_4") THEN
             #檢查成功時後續處理 

          ELSE
             #檢查失敗時後續處理
             LET r_success = FALSE
             RETURN r_success
          END IF
       END IF 
       RETURN r_success

END FUNCTION]]>
  </point>
  <point name="function.apmi121_pmap003_ref" order="4" ver="1" cite_std="N" cite_ver="" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION apmi121_pmap003_ref(p_pmap003)
DEFINE p_pmap003      LIKE pmap_t.pmap003
DEFINE r_imaal003     LIKE imaal_t.imaal003
DEFINE r_imaal004     LIKE imaal_t.imaal004

       INITIALIZE g_ref_fields TO NULL
       LET g_ref_fields[1] = p_pmap003
       CALL ap_ref_array2(g_ref_fields,"SELECT imaal003,imaal004 FROM imaal_t WHERE imaalent='"||g_enterprise||"' AND imaal001=? AND imaal002='"||g_dlang||"'","") RETURNING g_rtn_fields
       LET r_imaal003 = '', g_rtn_fields[1] , ''
       LET r_imaal004 = '', g_rtn_fields[2] , ''
       RETURN r_imaal003,r_imaal004
       
END FUNCTION]]>
  </point>
  <point name="function.apmi121_pmap005_ref" order="5" ver="1" cite_std="N" cite_ver="" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION apmi121_pmap005_ref(p_pmap005)
DEFINE p_pmap005      LIKE pmap_t.pmap005
DEFINE r_imaal003     LIKE imaal_t.imaal003

       INITIALIZE g_ref_fields TO NULL
       LET g_ref_fields[1] = p_pmap005
       CALL ap_ref_array2(g_ref_fields,"SELECT imaal003 FROM imaal_t WHERE imaalent='"||g_enterprise||"' AND imaal001=? AND imaal002='"||g_dlang||"'","") RETURNING g_rtn_fields
       LET r_imaal003 = '', g_rtn_fields[1] , ''
       RETURN r_imaal003

END FUNCTION]]>
  </point>
  <point name="function.apmi121_pmap006_ref" order="6" ver="1" cite_std="N" cite_ver="" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION apmi121_pmap006_ref(p_pmap006)
DEFINE p_pmap006      LIKE pmap_t.pmap006
DEFINE r_oocal003     LIKE oocal_t.oocal003

        INITIALIZE g_ref_fields TO NULL
        LET g_ref_fields[1] = p_pmap006
        CALL ap_ref_array2(g_ref_fields,"SELECT oocal003 FROM oocal_t WHERE oocalent='"||g_enterprise||"' AND oocal001=? AND oocal002='"||g_dlang||"'","") RETURNING g_rtn_fields
        LET r_oocal003= '', g_rtn_fields[1] , ''
        RETURN r_oocal003
        
END FUNCTION]]>
  </point>
  <point name="function.apmi121_pmap006_chk" order="7" ver="1" cite_std="N" cite_ver="" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION apmi121_pmap006_chk(p_pmap006)
DEFINE p_pmap006      LIKE pmap_t.pmap006
DEFINE r_success      LIKE type_t.num5

       LET r_success = TRUE
       
       IF NOT cl_null(p_pmap006) THEN 
          #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
          INITIALIZE g_chkparam.* TO NULL
          
          #設定g_chkparam.*的參數
          LET g_chkparam.arg1 = p_pmap006

          #呼叫檢查存在並帶值的library
          IF cl_chk_exist("v_ooca001") THEN
             #檢查成功時後續處理

          ELSE
             #檢查失敗時後續處理
             LET r_success = FALSE
             RETURN r_success
          END IF
       END IF 
       RETURN r_success
       
END FUNCTION]]>
  </point>
  <point name="function.apmi121_pmap002_ref" order="8" ver="1" cite_std="N" cite_ver="" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION apmi121_pmap002_ref(p_pmap002)
DEFINE p_pmap002     LIKE pmap_t.pmap002
DEFINE r_oohal003    LIKE oohal_t.oohal003

       INITIALIZE g_ref_fields TO NULL
       LET g_ref_fields[1] = p_pmap002
       CALL ap_ref_array2(g_ref_fields,"SELECT oohal003 FROM oohal_t WHERE oohalent='"||g_enterprise||"' AND oohal001=? AND oohal002='"||g_dlang||"'","") RETURNING g_rtn_fields
       LET r_oohal003 = '', g_rtn_fields[1] , ''
       RETURN r_oohal003
       
END FUNCTION]]>
  </point>
  <point name="function.apmi121_pmap009_ref" order="9" ver="1" cite_std="N" cite_ver="" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION apmi121_pmap009_ref(p_pmap009)
DEFINE p_pmap009      LIKE pmap_t.pmap009
DEFINE r_ooeal003     LIKE ooeal_t.ooeal003

       INITIALIZE g_ref_fields TO NULL
       LET g_ref_fields[1] = p_pmap009
       CALL ap_ref_array2(g_ref_fields,"SELECT ooeal003 FROM ooeal_t WHERE ooealent='"||g_enterprise||"' AND ooeal001=? AND ooeal002='"||g_dlang||"'","") RETURNING g_rtn_fields
       LET r_ooeal003 = '', g_rtn_fields[1] , ''
       RETURN r_ooeal003
       
END FUNCTION]]>
  </point>
  <point name="function.apmi121_pmap010_chk" order="10" ver="1" cite_std="N" cite_ver="" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[#檢查當前庫位是否在當前錄入的收貨營運據點中
PRIVATE FUNCTION apmi121_pmap010_chk()
DEFINE r_success  LIKE type_t.num5
       
       LET r_success = TRUE
       
       IF NOT cl_null(g_pmap_d[l_ac].pmap010) THEN 
          #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
          INITIALIZE g_chkparam.* TO NULL
          
          #設定g_chkparam.*的參數
          #IF NOT cl_null(g_pmap_d[l_ac].pmap009) THEN
             LET g_chkparam.arg1 = g_pmap_d[l_ac].pmap009
          #ELSE
          #   LET g_chkparam.arg1 = g_site
          #END IF
          LET g_chkparam.arg2 = g_pmap_d[l_ac].pmap010
             
          #呼叫檢查存在並帶值的library
          IF cl_chk_exist("v_inaa001_1") THEN
             #檢查成功時後續處理
          ELSE
             #檢查失敗時後續處理
             LET r_success = FALSE
             RETURN r_success
          END IF
       END IF 
       RETURN r_success
       
END FUNCTION]]>
  </point>
  <point name="function.apmi121_pmap010_ref" order="11" ver="1" cite_std="N" cite_ver="" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION apmi121_pmap010_ref(p_pmap009,p_pmap010)
DEFINE p_pmap010    LIKE pmap_t.pmap010
DEFINE p_pmap009    LIKE pmap_t.pmap009
DEFINE r_inaa002    LIKE inaa_t.inaa002
            
       INITIALIZE g_ref_fields TO NULL
       LET g_ref_fields[1] = p_pmap010
       CALL ap_ref_array2(g_ref_fields,"SELECT inaa002 FROM inaa_t WHERE inaaent='"||g_enterprise||"' AND inaasite='"||p_pmap009||"' AND inaa001=? ","") RETURNING g_rtn_fields
       LET r_inaa002 = '', g_rtn_fields[1] , ''
       RETURN r_inaa002
       
END FUNCTION]]>
  </point>
  <point name="function.apmi121_pmap011_chk" order="12" ver="1" cite_std="N" cite_ver="" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[#檢查當前儲位是否在收貨營運據點資料中
PRIVATE FUNCTION apmi121_pmap011_chk()
DEFINE r_success  LIKE type_t.num5
       
       LET r_success = TRUE
       
       IF NOT cl_null(g_pmap_d[l_ac].pmap011) THEN 
          #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
          INITIALIZE g_chkparam.* TO NULL
          
          #設定g_chkparam.*的參數
          #IF NOT cl_null(g_pmap_d[l_ac].pmap009) THEN
             LET g_chkparam.arg1 = g_pmap_d[l_ac].pmap009
          #ELSE
          #   LET g_chkparam.arg1 = g_site
          #END IF
          LET g_chkparam.arg2 = g_pmap_d[l_ac].pmap010
          LET g_chkparam.arg3 = g_pmap_d[l_ac].pmap011
             
          #呼叫檢查存在並帶值的library
          IF cl_chk_exist("v_inab002_1") THEN
             #檢查成功時後續處理

          ELSE
             #檢查失敗時後續處理
             LET r_success = FALSE
             RETURN r_success
          END IF
       END IF 
       RETURN r_success
       
END FUNCTION]]>
  </point>
  <point name="function.apmi121_pmap011_ref" order="13" ver="1" cite_std="N" cite_ver="" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION apmi121_pmap011_ref(p_pmap009,p_pmap010,p_pmap011)
DEFINE p_pmap009    LIKE pmap_t.pmap009
DEFINE p_pmap010    LIKE pmap_t.pmap010
DEFINE p_pmap011    LIKE pmap_t.pmap011
DEFINE r_inab002    LIKE inab_t.inab002


       INITIALIZE g_ref_fields TO NULL
       LET g_ref_fields[1] = p_pmap011
       CALL ap_ref_array2(g_ref_fields,"SELECT inab003 FROM inab_t WHERE inabent='"||g_enterprise||"' AND inabsite='"||p_pmap009||"' AND inab001='"||p_pmap010||"' AND inab002=? ","") RETURNING g_rtn_fields
       LET r_inab002 = '', g_rtn_fields[1] , ''
       RETURN r_inab002

END FUNCTION]]>
  </point>
  <point name="function.apmi121_pmap012_ref" order="14" ver="1" cite_std="N" cite_ver="" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION apmi121_pmap012_ref(p_pmap012)
DEFINE p_pmap012    LIKE pmap_t.pmap012  
DEFINE r_oofb011    LIKE oofb_t.oofb011

       INITIALIZE g_ref_fields TO NULL
       LET g_ref_fields[1] = p_pmap012
       CALL ap_ref_array2(g_ref_fields,"SELECT oofb011 FROM oofb_t WHERE oofbent='"||g_enterprise||"' AND oofb019=? ","") RETURNING g_rtn_fields
       LET r_oofb011 = '', g_rtn_fields[1] , ''
       RETURN r_oofb011
       
END FUNCTION]]>
  </point>
  <point name="function.apmi121_pmap014_ref" order="15" ver="1" cite_std="N" cite_ver="" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION apmi121_pmap014_ref(p_pmap014)
DEFINE p_pmap014     LIKE pmap_t.pmap014
DEFINE r_oocql004    LIKE oocql_t.oocql004

       INITIALIZE g_ref_fields TO NULL
       LET g_ref_fields[1] = p_pmap014
       CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent='"||g_enterprise||"' AND oocql001='263' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
       LET r_oocql004 = '', g_rtn_fields[1] , ''
       RETURN r_oocql004

END FUNCTION]]>
  </point>
  <point name="function.apmi121_pmap012_chk" order="16" ver="1" cite_std="N" cite_ver="" new="Y" status="" src="s" mark_hard="N">
    <![CDATA[
PRIVATE FUNCTION apmi121_pmap012_chk()
DEFINE l_ooef012   LIKE ooef_t.ooef012
DEFINE l_n         LIKE type_t.num5
DEFINE r_success   LIKE type_t.num5

       LET r_success = TRUE
       
       IF NOT cl_null(g_pmap_d[l_ac].pmap012) THEN 
          #設定g_chkparam.*的參數前，先將其初始化，避免之前設定遺留的參數值造成影響。
          INITIALIZE g_chkparam.* TO NULL
          
          #設定g_chkparam.*的參數
          #先判斷是否存在與對應庫位的聯絡地址檔中
          LET l_n = 0
          LET l_ooef012 = ''
          IF (NOT cl_null(g_pmap_d[l_ac].pmap009)) AND (NOT cl_null(g_pmap_d[l_ac].pmap010)) THEN
             SELECT inaa004 INTO l_ooef012 FROM inaa_t WHERE inaaent = g_enterprise AND inaasite = g_pmap_d[l_ac].pmap009 AND inaa001 = g_pmap_d[l_ac].pmap010
           
             SELECT COUNT(*) INTO l_n FROM oofb_t WHERE oofbent = g_enterprise AND oofb002 = l_ooef012 AND oofb019 = g_pmap_d[l_ac].pmap012 AND oofbstus = 'Y' AND oofb008 = '3'
          END IF
          IF l_n = 0 THEN
             #若不存在與對應庫位的聯絡地址檔中，在判斷是否存在與對應營運據點聯絡地址檔中，若都不存在，則報錯
             LET l_ooef012 = ''
             IF NOT cl_null(g_pmap_d[l_ac].pmap009) THEN
                SELECT ooef012 INTO l_ooef012 FROM ooef_t WHERE ooefent = g_enterprise AND ooef001 = g_pmap_d[l_ac].pmap009
                SELECT COUNT(*) INTO l_n FROM oofb_t WHERE oofbent = g_enterprise AND oofb002 = l_ooef012 AND oofb019 = g_pmap_d[l_ac].pmap012 AND oofbstus = 'Y' AND oofb008 = '3'
                IF l_n = 0 THEN
                   CALL cl_err(g_pmap_d[l_ac].pmap012,'apm-00216',1)
                   LET r_success = FALSE
                   RETURN r_success
                END IF
             END IF
          END IF
       END IF 
       RETURN r_success
       
END FUNCTION]]>
  </point>
  <point name="b_fill.fill" order="" ver="1" cite_std="N" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[         LET g_pmap2_d[l_ac].pmap003 = g_pmap_d[l_ac].pmap003
         LET g_pmap2_d[l_ac].pmap004 = g_pmap_d[l_ac].pmap004]]>
  </point>
  <point name="input.before_input" order="" ver="1" cite_std="N" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[   LET g_errshow = 1]]>
  </point>
  <point name="input.body.b_delete" order="" ver="1" cite_std="N" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[ ]]>
  </point>
  <point name="input.body.before_insert" order="" ver="1" cite_std="N" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            LET g_pmap_d[l_ac].pmap004 = ' '
            LET g_pmap_d[l_ac].pmap009 = g_site
            CALL apmi121_pmap009_ref(g_pmap_d[l_ac].pmap009) RETURNING g_pmap_d[l_ac].pmap009_desc
            DISPLAY BY NAME g_pmap_d[l_ac].pmap009_desc]]>
  </point>
  <point name="input.body.before_row" order="" ver="1" cite_std="N" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            CALL apmi121_set_entry_b(l_cmd)
            CALL apmi121_set_no_entry_b(l_cmd)]]>
  </point>
  <point name="input.define" order="" ver="1" cite_std="N" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[   DEFINE  l_ooef012       LIKE ooef_t.ooef012
   DEFINE  l_oofb001       LIKE oofb_t.oofb001
   DEFINE  l_oofb019       LIKE oofb_t.oofb019]]>
  </point>
  <point name="input.head.b_input" order="" ver="1" cite_std="N" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            IF l_cmd_t = 'r' THEN
               LET g_pmap_m.pmap001 = ''
               LET g_pmap_m.pmaal004 = ''
               LET g_pmap_m.pmap002 = ''
               LET g_pmap_m.oohal003 = ''
               DISPLAY BY NAME g_pmap_m.pmap001,g_pmap_m.pmaal004,g_pmap_m.pmap002,g_pmap_m.oohal003
            END IF]]>
  </point>
  <point name="insert.default" order="" ver="1" cite_std="N" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[      INITIALIZE g_pmap_m_t.* TO NULL
      LET g_pmap_m_t.* = g_pmap_m.*]]>
  </point>
  <point name="ref_show.head.reference" order="" ver="1" cite_std="N" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[   CALL apmi121_pmap001_ref(g_pmap_m.pmap001) RETURNING g_pmap_m.pmaal004
   DISPLAY BY NAME g_pmap_m.pmaal004
   
   CALL apmi121_pmap002_ref(g_pmap_m.pmap002) RETURNING g_pmap_m.oohal003
   DISPLAY BY NAME g_pmap_m.oohal003]]>
  </point>
  <point name="reproduce.before_input" order="" ver="1" cite_std="N" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[         LET g_errshow = 1
         LET g_pmap_m.pmaal004 = ''
         LET g_pmap_m.oohal003 = ''
         DISPLAY BY NAME g_pmap_m.pmaal004,g_pmap_m.oohal003
         ]]>
  </point>
  <point name="reproduce.pmap001" order="" ver="1" cite_std="N" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            CALL apmi121_pmap001_ref(l_newno) RETURNING g_pmap_m.pmaal004
            DISPLAY BY NAME g_pmap_m.pmaal004
            IF NOT cl_null(l_newno) AND NOT cl_null(l_newno02) THEN 
               IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM pmap_t WHERE "||"pmapent = '" ||g_enterprise|| "' AND pmapsite = '" ||g_site|| "' AND "||"pmap001 = '"||l_newno||"' AND "|| "pmap002 = '"||l_newno02 ||"'",'std-00004',0) THEN 
                  LET l_newno = ''
                  LET g_pmap_m.pmaal004 = ''
                  DISPLAY BY NAME g_pmap_m.pmaal004
                  NEXT FIELD CURRENT
               END IF
            END IF


            IF NOT cl_null(l_newno) THEN 
               IF NOT apmi121_pmap001_chk(l_newno) THEN
                  LET l_newno = ''
                  LET g_pmap_m.pmaal004 = ''
                  DISPLAY BY NAME g_pmap_m.pmaal004
                  NEXT FIELD CURRENT
               END IF
            END IF 
]]>
  </point>
  <point name="reproduce.pmap002" order="" ver="1" cite_std="N" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[            CALL apmi121_pmap002_ref(l_newno02) RETURNING g_pmap_m.oohal003
            DISPLAY BY NAME g_pmap_m.oohal003
            IF NOT cl_null(l_newno) AND NOT cl_null(l_newno02) THEN 
               IF NOT ap_chk_notDup("","SELECT COUNT(*) FROM pmap_t WHERE "||"pmapent = '" ||g_enterprise|| "' AND pmapsite = '" ||g_site|| "' AND "||"pmap001 = '"||l_newno ||"' AND "|| "pmap002 = '"||l_newno02 ||"'",'std-00004',0) THEN 
                  LET l_newno02 = ''
                  LET g_pmap_m.oohal003 = ''
                  DISPLAY BY NAME g_pmap_m.oohal003
                  NEXT FIELD CURRENT
               END IF
            END IF

            #允許輸入'ALL'的值，當輸入'ALL'時代表所有控制組均滿足此預設條件
            IF NOT cl_null(l_newno02) AND l_newno02 <> 'ALL' THEN 
               IF NOT apmi121_pmap002_chk(l_newno02) THEN
                  LET g_pmap_m.pmap002 = g_pmap_m_t.pmap002
                  LET g_pmap_m.oohal003 = ''
                  DISPLAY BY NAME g_pmap_m.oohal003
                  NEXT FIELD CURRENT
               END IF
            END IF
            
         ON ACTION controlp INFIELD pmap001
            #add-point:ON ACTION controlp INFIELD pmap001
#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = l_newno             #給予default值

            #給予arg

            CALL q_pmaa001_3()                                #呼叫開窗

            LET l_newno = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY l_newno TO pmap001              #顯示到畫面上
            CALL apmi121_pmap001_ref(l_newno) RETURNING g_pmap_m.pmaal004
            DISPLAY BY NAME g_pmap_m.pmaal004

            NEXT FIELD pmap001                          #返回原欄位

         #----<<pmap002>>----
         #Ctrlp:input.c.pmap002
         ON ACTION controlp INFIELD pmap002
            #add-point:ON ACTION controlp INFIELD pmap002
#此段落由子樣板a07產生            
            #開窗i段
			INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
			LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = l_newno02             #給予default值

            #給予arg

            CALL q_ooha001_4()                                #呼叫開窗

            LET l_newno02 = g_qryparam.return1              #將開窗取得的值回傳到變數

            DISPLAY l_newno02 TO pmap002              #顯示到畫面上
               
            CALL apmi121_pmap002_ref(l_newno02) RETURNING g_pmap_m.oohal003
            DISPLAY BY NAME g_pmap_m.oohal003

            NEXT FIELD pmap002                          #返回原欄位
]]>
  </point>
  <point name="set_entry_b.set_entry_b" order="" ver="1" cite_std="N" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[   CALL cl_set_comp_entry("pmap004,pmap007,pmap008",TRUE)]]>
  </point>
  <point name="set_no_entry_b.define" order="" ver="1" cite_std="N" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[   DEFINE l_imaf015   LIKE imaf_t.imaf015
   DEFINE l_imaf144   LIKE imaf_t.imaf144
   DEFINE l_imaa005   LIKE imaa_t.imaa005]]>
  </point>
  <point name="set_no_entry_b.set_no_entry_b段" order="" ver="1" cite_std="N" cite_ver="" new="N" status="" src="s" mark_hard="N">
    <![CDATA[   #料件不使用產品特徵時，產品特徵欄位不可錄入
   LET l_imaa005 = ''
   SELECT imaa005 INTO l_imaa005 FROM imaa_t WHERE imaaent = g_enterprise AND imaa001 = g_pmap_d[l_ac].pmap003
   IF cl_null(l_imaa005) THEN
      CALL cl_set_comp_entry("pmap004",FALSE)
      LET g_pmap_d[l_ac].pmap004 = ' '
   ELSE
      IF cl_null(g_pmap_d[l_ac].pmap004) THEN
         LET g_pmap_d[l_ac].pmap004 = ''
      END IF
   END IF
   
   LET l_imaf015 = ''
   SELECT imaf015 INTO l_imaf015 FROM imaf_t WHERE imafent = g_enterprise AND imafsite = g_site AND imaf001 = g_pmap_d[l_ac].pmap003
   IF cl_null(l_imaf015) THEN
      CALL cl_set_comp_entry("pmap007",FALSE)
   END IF
   LET l_imaf144 = ''
   SELECT imaf144 INTO l_imaf144 FROM imaf_t WHERE imafent = g_enterprise AND imafsite = g_site AND imaf001 = g_pmap_d[l_ac].pmap003
   IF cl_null(l_imaf144) THEN
      CALL cl_set_comp_entry("pmap008",FALSE)
   END IF]]>
  </point>
</add_points>
